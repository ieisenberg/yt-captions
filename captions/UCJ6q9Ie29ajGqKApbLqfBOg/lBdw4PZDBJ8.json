[
  {
    "start": "0",
    "end": "130000"
  },
  {
    "text": "our nightmares of data breaches and the apts keeping you and your CISOs up at",
    "start": "0",
    "end": "7890"
  },
  {
    "text": "night you probably know by now you should be hunting but what should you be",
    "start": "7890",
    "end": "14849"
  },
  {
    "text": "hunting for and when and how rob and I",
    "start": "14849",
    "end": "19980"
  },
  {
    "text": "have a definition of threat hunting we've been using for a little while that says threat hunting is the collective",
    "start": "19980",
    "end": "27330"
  },
  {
    "text": "name for the set of manual or semi-automated processes that you do to",
    "start": "27330",
    "end": "32969"
  },
  {
    "text": "find the bad guys the security incidents in your network probably the ones that",
    "start": "32969",
    "end": "40680"
  },
  {
    "text": "were missed by your automated detection systems that you already have in place and there are there's a lot of interest",
    "start": "40680",
    "end": "49140"
  },
  {
    "text": "in this topic right now but weirdly there's maybe not so much good guidance",
    "start": "49140",
    "end": "56910"
  },
  {
    "text": "on how to figure out what you should be hunting for everybody yeah you should go",
    "start": "56910",
    "end": "61920"
  },
  {
    "text": "hunting if you go into the vendor area you'll see lots of threat hunting messaging going on but how do they how",
    "start": "61920",
    "end": "69119"
  },
  {
    "text": "do you know what you should be hunting for what are the priorities you should be setting for the things you're hunting",
    "start": "69119",
    "end": "74970"
  },
  {
    "text": "for how do you create from how do you create from that to going to coming up",
    "start": "74970",
    "end": "82200"
  },
  {
    "text": "with a finished hunt plan that you can turn over to your hunters and let them start hunting well we've thought this",
    "start": "82200",
    "end": "88590"
  },
  {
    "text": "was kind of a big problem and we wanted to do something about it and have a little bit of fun at the same time so",
    "start": "88590",
    "end": "96409"
  },
  {
    "text": "Rob and I are gonna tell you a bedtime story about how you can solve these",
    "start": "96409",
    "end": "107790"
  },
  {
    "text": "problems in your enterprise and come out with an actionable hunt plan so snuggle",
    "start": "107790",
    "end": "113700"
  },
  {
    "text": "in relax and enjoy go to hunt then sleep",
    "start": "113700",
    "end": "121398"
  },
  {
    "text": "if my mic works okay a lot of suspense",
    "start": "122970",
    "end": "130630"
  },
  {
    "text": "there we go there we go the bad guys are inside your network today from finance to HR they creep if",
    "start": "130630",
    "end": "139750"
  },
  {
    "text": "you expect to ever rest well go to hunt",
    "start": "139750",
    "end": "144810"
  },
  {
    "text": "then sleep so thanks for joining us my",
    "start": "144810",
    "end": "150430"
  },
  {
    "start": "148000",
    "end": "305000"
  },
  {
    "text": "name is David Bianco and I'm here on stage with Rob Lee I'm I'm a malware",
    "start": "150430",
    "end": "156100"
  },
  {
    "text": "researcher I'm sorry I'm a security researcher but a little bit different than the kind that you will see here",
    "start": "156100",
    "end": "161530"
  },
  {
    "text": "mostly at blackhat because most of the people who describe themselves I think says security researcher here are like",
    "start": "161530",
    "end": "167380"
  },
  {
    "text": "malware researchers or offensive exploit researchers or you know I I don't really",
    "start": "167380",
    "end": "172990"
  },
  {
    "text": "do that my whole career is focused more on protecting networks by doing incident",
    "start": "172990",
    "end": "179320"
  },
  {
    "text": "detection and it's in a response and kind of sharing what I've learned with the rest of the community and so I'm a",
    "start": "179320",
    "end": "187110"
  },
  {
    "text": "my research mostly focuses on better ways to do incident detection including",
    "start": "187110",
    "end": "192370"
  },
  {
    "text": "threat hunting I'm also the main instigator behind the threat hunting",
    "start": "192370",
    "end": "197800"
  },
  {
    "text": "project that threat hunting net and I will turn this over to Rob and he can say a few words about himself",
    "start": "197800",
    "end": "203709"
  },
  {
    "text": "sure hey so I'm Rob Lee I run a company called Drago's which is ICS focused and",
    "start": "203709",
    "end": "209080"
  },
  {
    "text": "basically my whole career focuses on things that blow up and can hurt people is we try to keep it from happening I",
    "start": "209080",
    "end": "216220"
  },
  {
    "text": "teach at Sands Institute as well I've seen a bunch of you out here from my previous classes either on the threat intelligence side or the ICS Incident",
    "start": "216220",
    "end": "223239"
  },
  {
    "text": "Response course but most people actually know me for writing the little Bobby comic I like to pretend I'm technical",
    "start": "223239",
    "end": "229570"
  },
  {
    "text": "and know things but everybody always comes out to being goes I read your stuff I'm like oh my latest paper no no no the comic book I'm like oh okay",
    "start": "229570",
    "end": "235300"
  },
  {
    "text": "that's cool so Jeff Hoffs obviously can't be with us today but Jeff Haas is the illustrator for a lot of the stuff",
    "start": "235300",
    "end": "241720"
  },
  {
    "text": "you saw on the screen today we'll see I'm he's the the illustrator for little Bobby and we are know samuel l.jackson",
    "start": "241720",
    "end": "249160"
  },
  {
    "text": "but we will try to narrate the story for you the best that we can we also are not doing a hunting 101",
    "start": "249160",
    "end": "255200"
  },
  {
    "text": "type talk so a lot of the stuff we want to deliver to you is actionable and things you can go back and use however",
    "start": "255200",
    "end": "261109"
  },
  {
    "text": "if you're interested in some of the 101 type material on what is threat hunting how to get started before sort of the",
    "start": "261109",
    "end": "266690"
  },
  {
    "text": "planning discussion we did include some links up on the slide these are resources that David and I have worked",
    "start": "266690",
    "end": "272690"
  },
  {
    "text": "on it before obviously he runs the threat hunting project but we also have the hypothesis generation for successful",
    "start": "272690",
    "end": "279290"
  },
  {
    "text": "hunting paper and that really details the three ways you can generate hypotheses to get started because",
    "start": "279290",
    "end": "284870"
  },
  {
    "text": "realistically because it's a human driven process a lot of your challenges will be around generating good",
    "start": "284870",
    "end": "291260"
  },
  {
    "text": "hypotheses to go out and test in your environment so then get you started with that we're actually going to go through",
    "start": "291260",
    "end": "296330"
  },
  {
    "text": "though read you the story and get you your first five hunts and that you can leverage in your own environment we were",
    "start": "296330",
    "end": "307639"
  },
  {
    "start": "305000",
    "end": "434000"
  },
  {
    "text": "serious chapter two a song of Intel and planning",
    "start": "307639",
    "end": "316630"
  },
  {
    "text": "know what you're doing before you start hunting prepare for success my sweet",
    "start": "316630",
    "end": "323770"
  },
  {
    "text": "take the time to think things through so you can go to hunt then sleep good",
    "start": "323770",
    "end": "331700"
  },
  {
    "text": "hunting requires successful planning a lot of planning you can't just take some",
    "start": "331700",
    "end": "338419"
  },
  {
    "text": "ill-formed ideas and pass them on to some thread hunters and be like okay go",
    "start": "338419",
    "end": "343610"
  },
  {
    "text": "do this they might produce something but how do you know it's going to be the most useful use of their time right is it",
    "start": "343610",
    "end": "350600"
  },
  {
    "text": "gonna be something that is really important to your company or not that's",
    "start": "350600",
    "end": "357080"
  },
  {
    "text": "part of the planning process so we're gonna talk about in this section the three phases of good hunt planning the",
    "start": "357080",
    "end": "365360"
  },
  {
    "text": "first is how to identify the adversary tactics and techniques that your",
    "start": "365360",
    "end": "371560"
  },
  {
    "text": "organization more specific most specifically should be concerned about there are obviously commonalities across",
    "start": "371560",
    "end": "378470"
  },
  {
    "text": "different organizations that are you know you can leverage but in my experience many of the organizations",
    "start": "378470",
    "end": "384800"
  },
  {
    "text": "because of either their industry or the way they do business or even just the technologies they have",
    "start": "384800",
    "end": "390289"
  },
  {
    "text": "in use the specific tactics and techniques vary a little bit so we're",
    "start": "390289",
    "end": "396349"
  },
  {
    "text": "gonna talk about what tactics and techniques you should be to figure out what you should be concerned with and",
    "start": "396349",
    "end": "401419"
  },
  {
    "text": "then we're gonna talk about how you prioritize that big list so that you can",
    "start": "401419",
    "end": "406580"
  },
  {
    "text": "come with a picklist you know the most the most important things on the top and then how you take each one of those",
    "start": "406580",
    "end": "414770"
  },
  {
    "text": "individual things and turn them into a fleshed out plan for the individual hunt",
    "start": "414770",
    "end": "419840"
  },
  {
    "text": "so we'll have a hunt plan at the macro level that shows that what you want to hunt for and and in what priority order",
    "start": "419840",
    "end": "427220"
  },
  {
    "text": "and then we'll have a hunt plan at the kind of a micro level for an individual hunt so the first thing is to identify",
    "start": "427220",
    "end": "437300"
  },
  {
    "start": "434000",
    "end": "550000"
  },
  {
    "text": "your hunt targets the first step is to",
    "start": "437300",
    "end": "443840"
  },
  {
    "text": "kind of look at the friendly Intel that you have about your own environment",
    "start": "443840",
    "end": "450250"
  },
  {
    "text": "things like the core business processes that you have the the assets that are",
    "start": "450250",
    "end": "458539"
  },
  {
    "text": "directly supporting those a lot of times you refer this kind of analysis as like",
    "start": "458539",
    "end": "464150"
  },
  {
    "text": "a crown jewels analysis but you're maybe not only specifically concerned with",
    "start": "464150",
    "end": "469219"
  },
  {
    "text": "things like oh let's identify the mail servers and the Active Directory servers you also want to look at the business",
    "start": "469219",
    "end": "475310"
  },
  {
    "text": "side and say well what are the most important things that are going on in my IT environment that are actually making",
    "start": "475310",
    "end": "480889"
  },
  {
    "text": "my business work and it could be manufacturing it could be intellectual",
    "start": "480889",
    "end": "487909"
  },
  {
    "text": "property generation depending on what your business is but figure out what the most important things that are going on that make your business run as the",
    "start": "487909",
    "end": "497509"
  },
  {
    "text": "unique kind of business it is the other thing is take a look at the kind of flip",
    "start": "497509",
    "end": "502699"
  },
  {
    "text": "side of that and what are the things that are going on in your environment that if someone were to cause disruption",
    "start": "502699",
    "end": "509719"
  },
  {
    "text": "in them would most impact your business so that's where you do get into some kind of IT pieces like yeah if they take",
    "start": "509719",
    "end": "516979"
  },
  {
    "text": "down the Active Directory servers you're probably not going to be able to log in and have a bad day",
    "start": "516979",
    "end": "523419"
  },
  {
    "text": "but there may be some other things that are specific to you so if you're in one",
    "start": "523420",
    "end": "529010"
  },
  {
    "text": "industry maybe you're very concerned with data breaches of customer info if",
    "start": "529010",
    "end": "535190"
  },
  {
    "text": "you're in a different industry maybe you're concerned more with I don't know like if you're in the medical industry you might be concerned more with the",
    "start": "535190",
    "end": "542020"
  },
  {
    "text": "security of the medical devices that you're working with things like that the",
    "start": "542020",
    "end": "552050"
  },
  {
    "start": "550000",
    "end": "642000"
  },
  {
    "text": "next thing to do is I'm going to make the whole slide here actually the next",
    "start": "552050",
    "end": "557360"
  },
  {
    "text": "thing to do is figure out what those tactics and techniques are for your",
    "start": "557360",
    "end": "563029"
  },
  {
    "text": "environment and then go to something I like to use the mitre attack framework",
    "start": "563029",
    "end": "568430"
  },
  {
    "text": "for this to find the tactics tactics and techniques that you've already",
    "start": "568430",
    "end": "573589"
  },
  {
    "text": "identified in the mitre attack framework and look at the other things that are near to them on the matrix because those",
    "start": "573589",
    "end": "579890"
  },
  {
    "text": "are the related things it's not so much that you're going to have to cover",
    "start": "579890",
    "end": "586070"
  },
  {
    "text": "everything in them in the miter attack matrix but think of this as more of a",
    "start": "586070",
    "end": "591410"
  },
  {
    "text": "well I think of it as like the pirate code it's kind of a guideline more than a rule there are some things in here",
    "start": "591410",
    "end": "597680"
  },
  {
    "text": "that you cannot detect for example I think one of the entries and the command part is something like use of",
    "start": "597680",
    "end": "604400"
  },
  {
    "text": "multi-layer encryption like encrypted and then encrypted and then encrypt it on top of that that is a thing that",
    "start": "604400",
    "end": "610730"
  },
  {
    "text": "attackers might do but it's not something that you're going to be expected to have to develop detections",
    "start": "610730",
    "end": "616160"
  },
  {
    "text": "for so don't think of every one of these things as something that you have to detect but think of them as kind of like",
    "start": "616160",
    "end": "624290"
  },
  {
    "text": "security conversation starters like to spark other ideas about other tactics and techniques that might be related to",
    "start": "624290",
    "end": "631100"
  },
  {
    "text": "what you already know you want to look for and it's a little bit of weights of getting a little bit of breath right",
    "start": "631100",
    "end": "639759"
  },
  {
    "start": "642000",
    "end": "712000"
  },
  {
    "text": "so now you have a list of things that",
    "start": "643170",
    "end": "649029"
  },
  {
    "text": "you're interested in and it's probably unordered and kind of looks random ish",
    "start": "649029",
    "end": "654339"
  },
  {
    "text": "the next idea is to map them to an attacker lifecycle model and there are a",
    "start": "654339",
    "end": "662170"
  },
  {
    "text": "lot of choices probably everyone here is familiar with if I can get this to work the Lockheed",
    "start": "662170",
    "end": "668589"
  },
  {
    "text": "Martin cyber kill chain mandiant also has its own and again since we're using",
    "start": "668589",
    "end": "675970"
  },
  {
    "text": "the mitre attack framework just for purposes of this presentation we're going to go with the mitre attack",
    "start": "675970",
    "end": "682529"
  },
  {
    "text": "attacker lifecycle but it doesn't really matter which one you use and you may even have your own and there's other",
    "start": "682529",
    "end": "688660"
  },
  {
    "text": "ones out there as long as you find one that you're comfortable with so what you",
    "start": "688660",
    "end": "694269"
  },
  {
    "text": "do then is you take the individual things that you identified the tactics",
    "start": "694269",
    "end": "700839"
  },
  {
    "text": "and techniques and you match them up to where they fall on the attacker",
    "start": "700839",
    "end": "706769"
  },
  {
    "text": "lifecycle model that you've chosen so",
    "start": "706769",
    "end": "713529"
  },
  {
    "start": "712000",
    "end": "849000"
  },
  {
    "text": "you can see here I've kind of done this a sample it's a very small sample yours will probably be a lot more detailed and",
    "start": "713529",
    "end": "720689"
  },
  {
    "text": "on the x-axis I've got all of the attack",
    "start": "720689",
    "end": "725949"
  },
  {
    "text": "lifecycle phases and on the y-axis I",
    "start": "725949",
    "end": "731470"
  },
  {
    "text": "have my gut feel of relative priority I can't say that there's an",
    "start": "731470",
    "end": "737019"
  },
  {
    "text": "industry-standard scoring for priority of these things right but the idea here",
    "start": "737019",
    "end": "743230"
  },
  {
    "text": "is that in most the attacker lifecycle models the things that are closer to the end of the chain or the model are",
    "start": "743230",
    "end": "750129"
  },
  {
    "text": "usually higher priority because it means the adversary has gone farther into",
    "start": "750129",
    "end": "755170"
  },
  {
    "text": "their attack and they're executing things that are more impactful to your organization and so if you align these",
    "start": "755170",
    "end": "763449"
  },
  {
    "text": "things you've matched these these tactics and techniques up and you place them on the grid in their proper life",
    "start": "763449",
    "end": "770199"
  },
  {
    "text": "cycle and sort them rank order them with what your rough priorities are then",
    "start": "770199",
    "end": "775930"
  },
  {
    "text": "you end up with a graph here that basically shows the it's kind of like",
    "start": "775930",
    "end": "781210"
  },
  {
    "text": "the Magic Quadrant for threat hunting and it's in detection these are the things up in the right-hand corner upper",
    "start": "781210",
    "end": "787270"
  },
  {
    "text": "right that you need to probably think of as your priorities now what you're gonna",
    "start": "787270",
    "end": "792670"
  },
  {
    "text": "have to do next is you have a still kind of a matrix of those and you will end up",
    "start": "792670",
    "end": "798700"
  },
  {
    "text": "then taking those and collapsing them down into a single column fully ranked and there again this is one of those",
    "start": "798700",
    "end": "805930"
  },
  {
    "text": "situations where there's not exactly a correct one correct way to do it but if",
    "start": "805930",
    "end": "811089"
  },
  {
    "text": "you think of things like the whatever is at the most corner part of it the upper",
    "start": "811089",
    "end": "818589"
  },
  {
    "text": "right corner that's probably the first thing if you look at the bottom of that",
    "start": "818589",
    "end": "823839"
  },
  {
    "text": "column though the bottom of that column may in fact be a little bit less of a",
    "start": "823839",
    "end": "829510"
  },
  {
    "text": "priority than the top of the previous column so you'll have to collapse them in a way that makes sense again there's",
    "start": "829510",
    "end": "836290"
  },
  {
    "text": "no one way to do it but just take these as a guide and and merge them into a single list and that is what you should",
    "start": "836290",
    "end": "845500"
  },
  {
    "text": "be hunting for and in what order now the",
    "start": "845500",
    "end": "850870"
  },
  {
    "start": "849000",
    "end": "1068000"
  },
  {
    "text": "next part of that though is we want to take each of those individual pieces and",
    "start": "850870",
    "end": "858550"
  },
  {
    "text": "flesh them out to be a hunting plan that you could give to a threat hunter and",
    "start": "858550",
    "end": "865450"
  },
  {
    "text": "get them started right right now you're not really ready to start hunting on these things because you don't really",
    "start": "865450",
    "end": "871600"
  },
  {
    "text": "have a lot of details other than a title for the hunt so you're gonna have to",
    "start": "871600",
    "end": "879130"
  },
  {
    "text": "start with doing a little research and depending on the way your organization's",
    "start": "879130",
    "end": "884230"
  },
  {
    "text": "hunt program is structured you might do this before you send it to the hunt team or the hunt team could actually do these",
    "start": "884230",
    "end": "890320"
  },
  {
    "text": "before they actually start hunting somebody has to do this but it doesn't necessarily always have to be you and",
    "start": "890320",
    "end": "896430"
  },
  {
    "text": "you'll take each one of these and do some research to see okay what does this actually mean match it up to what you",
    "start": "896430",
    "end": "904029"
  },
  {
    "text": "know about your technologies that you have it in place and say well if I did see this",
    "start": "904029",
    "end": "909670"
  },
  {
    "text": "what would it look like in my environment in my specific environment not somebody else's environment with a",
    "start": "909670",
    "end": "914950"
  },
  {
    "text": "different kind of data set right and we want to get basically three things there",
    "start": "914950",
    "end": "921700"
  },
  {
    "text": "are four things out of this the first thing is we want to get some kind of research summary of background",
    "start": "921700",
    "end": "927700"
  },
  {
    "text": "information that the hunters are going to get in reality not everything that",
    "start": "927700",
    "end": "933610"
  },
  {
    "text": "you're gonna hunt for is gonna be like your hunt teams built already built expertise I mean you're going to give",
    "start": "933610",
    "end": "940330"
  },
  {
    "text": "them things that they don't really know that much about occasionally and so this summary of the technics tactics and",
    "start": "940330",
    "end": "947680"
  },
  {
    "text": "techniques and how they operate and what the purposes of them are and things like that it's gonna be very useful for getting the hunt team up to speed based",
    "start": "947680",
    "end": "955030"
  },
  {
    "text": "on that and then based on what you know about your own technology is in place in your own IT infrastructure",
    "start": "955030",
    "end": "960460"
  },
  {
    "text": "you're gonna then create a hunting hypothesis this is what Rob was",
    "start": "960460",
    "end": "965590"
  },
  {
    "text": "referring to in the intro when we talked about they talked about that paper that we wrote together about how to frame",
    "start": "965590",
    "end": "971410"
  },
  {
    "text": "your hunting questions like I have my hypothesis is this kind of activity may",
    "start": "971410",
    "end": "976870"
  },
  {
    "text": "be going on in my environment if so this is what it you know might look like once",
    "start": "976870",
    "end": "983380"
  },
  {
    "text": "you have the hunting hypothesis then you can start looking for things like okay",
    "start": "983380",
    "end": "989700"
  },
  {
    "text": "that's the hypothesis now in my data set specifically what type of side effects",
    "start": "989700",
    "end": "996370"
  },
  {
    "text": "or artifacts would I expect to find if my hypothesis were true and these could",
    "start": "996370",
    "end": "1004560"
  },
  {
    "text": "be things like and we're gonna see some concrete examples of these as we go through our hunt plan for the specific",
    "start": "1004560",
    "end": "1010920"
  },
  {
    "text": "organization that we chose a little bit later but these could be things like I should see a spike in this or I should",
    "start": "1010920",
    "end": "1016950"
  },
  {
    "text": "see a dip in this or I should see a combination of these events in a short amount of time I should see something visual that would",
    "start": "1016950",
    "end": "1024959"
  },
  {
    "text": "look like this depending on what you're hunting for it could be a lot different so this is one of the reasons that you have to do this",
    "start": "1024960",
    "end": "1030360"
  },
  {
    "text": "kind of planning so that you can know what to what to expect when you're actually hunting and know what a",
    "start": "1030360",
    "end": "1035819"
  },
  {
    "text": "successful find might look like and finally once you know what you need to find then you can decide on some",
    "start": "1035820",
    "end": "1042390"
  },
  {
    "text": "analytic nooks that might help you find that information so it could be stacked",
    "start": "1042390",
    "end": "1048510"
  },
  {
    "text": "counting or it could be a least frequency of occurrence analysis it could be visualizations or machine",
    "start": "1048510",
    "end": "1053580"
  },
  {
    "text": "learning or anytime it's all kinds of things so you kind of make a rough plan and that may change as they get into the",
    "start": "1053580",
    "end": "1059490"
  },
  {
    "text": "hunt and that's okay but you're going in with a plan and the",
    "start": "1059490",
    "end": "1070250"
  },
  {
    "start": "1068000",
    "end": "1392000"
  },
  {
    "text": "last thing I just want to mention it's not technically part of the hunt planning but I think it's in a very",
    "start": "1070250",
    "end": "1076380"
  },
  {
    "text": "important part of the hunting process overall is we need to be able to take the",
    "start": "1076380",
    "end": "1083700"
  },
  {
    "text": "successes that we have in our hunt program and automate those so that we",
    "start": "1083700",
    "end": "1090240"
  },
  {
    "text": "don't have to keep doing the same hunt over and over again because we want to have our time free to do new hunts so",
    "start": "1090240",
    "end": "1097350"
  },
  {
    "text": "even though you may have to revisit occasionally just to make sure technology and processes didn't drift",
    "start": "1097350",
    "end": "1102419"
  },
  {
    "text": "too far and and invalidate the successful hunt we really should be",
    "start": "1102419",
    "end": "1107730"
  },
  {
    "text": "considering that the end goal is to try to automate it as fully as possible so that you can go off and do something",
    "start": "1107730",
    "end": "1113970"
  },
  {
    "text": "more productive than just doing the same analysis over and over again so don't forget when you have a successful hunt",
    "start": "1113970",
    "end": "1121080"
  },
  {
    "text": "even if you didn't find anything in that hunt but if you know that your hunt is working and it would have found it automated all right chapter three the",
    "start": "1121080",
    "end": "1136169"
  },
  {
    "text": "jungle incorporated book your product plans and manufacturing deeds are the things that you'd like most to keep",
    "start": "1136169",
    "end": "1143090"
  },
  {
    "text": "rivals could still these not just the Chinese so go to hunt then sleep in this",
    "start": "1143090",
    "end": "1149820"
  },
  {
    "text": "section I want to tell you about the company that we're going to be hunting in so the next course the slides we're",
    "start": "1149820",
    "end": "1155490"
  },
  {
    "text": "going to be giving you concrete examples of hunts that would be like your five first hunts and we are structuring it",
    "start": "1155490",
    "end": "1162419"
  },
  {
    "text": "based off of this manufacturing organization one of the reasons that we chose a manufacturing organization is I",
    "start": "1162419",
    "end": "1169080"
  },
  {
    "text": "think it's very important to understand that all sorts of environments are different and have different priorities",
    "start": "1169080",
    "end": "1174300"
  },
  {
    "text": "and the way that you hunt in them is be driven just as much by those business processes that David talked about as the",
    "start": "1174300",
    "end": "1180530"
  },
  {
    "text": "type of intelligence that you're actually gathering so in a manufacturing organization as an example you would",
    "start": "1180530",
    "end": "1186650"
  },
  {
    "text": "typically have a business network where your normal IT systems your Active Directory and domain control email",
    "start": "1186650",
    "end": "1192679"
  },
  {
    "text": "servers but you would also have your industrial control system networks and these would be actually where you're",
    "start": "1192679",
    "end": "1197960"
  },
  {
    "text": "making the manufacturing gear in this case jungle Incorporated is a leading",
    "start": "1197960",
    "end": "1203480"
  },
  {
    "text": "provider of jungle themed fidgets spinners so this is what the intellectual property that they're",
    "start": "1203480",
    "end": "1208909"
  },
  {
    "text": "trying to protect is it's not exactly differentiated but it's pretty special and then they go for a high rate so we",
    "start": "1208909",
    "end": "1214880"
  },
  {
    "text": "really want to keep that and we're gonna try to structure our hunts to not only include the type of activity that would",
    "start": "1214880",
    "end": "1221419"
  },
  {
    "text": "be in a business network type intrusion but also the ways that your adversaries would pivot into your industrial",
    "start": "1221419",
    "end": "1227330"
  },
  {
    "text": "environment and then take advantage of this again one of the reasons I really like this is we will often find those",
    "start": "1227330",
    "end": "1234169"
  },
  {
    "text": "cultural divides inside of organizations where you might have IT security and operational technology security and they",
    "start": "1234169",
    "end": "1241220"
  },
  {
    "text": "just never talk or if you're a big company take any of the major airlines as an example they have just as much",
    "start": "1241220",
    "end": "1247220"
  },
  {
    "text": "financial data and credit card processing as they have intellectual property as they have maintenance and",
    "start": "1247220",
    "end": "1252770"
  },
  {
    "text": "manufacturing lines with industrial Internet of Things and all sorts of crazy stuff a lot of times we see siloed",
    "start": "1252770",
    "end": "1258919"
  },
  {
    "text": "teams that form and a lot of your hunting should help to bring together those teams and make sure that you're",
    "start": "1258919",
    "end": "1265159"
  },
  {
    "text": "looking for the gaps in the security that they're doing in those little silos I mean it's perfectly fine not to find a",
    "start": "1265159",
    "end": "1271070"
  },
  {
    "text": "threat when you're actually hunting I think we talked to the CTI some of this year and s√©rgio I gave a presentation on",
    "start": "1271070",
    "end": "1278240"
  },
  {
    "text": "this as well noting that if you're only metric for success is finding threats you will be a very unsuccessful threat",
    "start": "1278240",
    "end": "1284539"
  },
  {
    "text": "hunting team and that is obviously what we want to look for but the byproduct of it is really supposed to be driving",
    "start": "1284539",
    "end": "1290809"
  },
  {
    "text": "value to your overall organization and identifying where your collection and detection doesn't match up correctly so",
    "start": "1290809",
    "end": "1296390"
  },
  {
    "text": "let's go through our first five hunts here so your plans have real merit don't",
    "start": "1296390",
    "end": "1304669"
  },
  {
    "text": "just cover your rear your priorities are spelled out so neat these are things that you'll be look",
    "start": "1304669",
    "end": "1310400"
  },
  {
    "text": "for deer now go to hunt then sleep in these first five hunts what we really",
    "start": "1310400",
    "end": "1316220"
  },
  {
    "text": "want to identify are building off of the plan that we started with so David you want to cover the first couple and then",
    "start": "1316220",
    "end": "1321980"
  },
  {
    "text": "I'll hit the ICS absolutely related ones just to give you a little bit of a preview we took those that piece of",
    "start": "1321980",
    "end": "1330320"
  },
  {
    "text": "information off of the slide that we just saw where Rob was talking about what this company really needs to",
    "start": "1330320",
    "end": "1336020"
  },
  {
    "text": "protect they need to protect the plans for their products but they also need to protect the unique manufacturing details",
    "start": "1336020",
    "end": "1342590"
  },
  {
    "text": "the plans don't tell you how to make it entirely right they just tell you the",
    "start": "1342590",
    "end": "1348980"
  },
  {
    "text": "specifications of what needs to go there but maybe there's some unique materials that it they're unusual to work with and",
    "start": "1348980",
    "end": "1355460"
  },
  {
    "text": "so in order to fully replicate this product you would need some information from the corporate side the plans and",
    "start": "1355460",
    "end": "1361820"
  },
  {
    "text": "some information from the ICS side the manufacturing details so based on that",
    "start": "1361820",
    "end": "1368690"
  },
  {
    "text": "we've come up with the first five hunts that this company probably should do they some of these may be in your first",
    "start": "1368690",
    "end": "1376610"
  },
  {
    "text": "five as well some of them probably won't be but consider this to be a like a",
    "start": "1376610",
    "end": "1384320"
  },
  {
    "text": "concrete instantiation of the planning that we went through in the previous sections so we're going to do a little",
    "start": "1384320",
    "end": "1391670"
  },
  {
    "text": "few things here first of all their main",
    "start": "1391670",
    "end": "1397180"
  },
  {
    "start": "1392000",
    "end": "1727000"
  },
  {
    "text": "concern is their adversaries they're their potential rivals stealing their",
    "start": "1397180",
    "end": "1404150"
  },
  {
    "text": "things right so most likely that will happen through one of their border",
    "start": "1404150",
    "end": "1410690"
  },
  {
    "text": "connections to either the internet or it could be through a partner VPN or something like that but wherever it is",
    "start": "1410690",
    "end": "1416710"
  },
  {
    "text": "we want to look for data exfiltration going out of the network there are many",
    "start": "1416710",
    "end": "1424070"
  },
  {
    "text": "ways to do data exfiltration and so in your real hunt you'll probably have your",
    "start": "1424070",
    "end": "1430820"
  },
  {
    "text": "hunt plan you'll probably have multiple hypotheses around data exfiltration but",
    "start": "1430820",
    "end": "1436790"
  },
  {
    "text": "the first one here is kind of straightforward even though it looks a little bit mathy at first we're using we're using",
    "start": "1436790",
    "end": "1444680"
  },
  {
    "text": "something called the producer-consumer ratio and you can see more about this at the URL on the threat hunting project on",
    "start": "1444680",
    "end": "1451910"
  },
  {
    "text": "the bottom of the slide but basically it's a measure of what I call the the",
    "start": "1451910",
    "end": "1457130"
  },
  {
    "text": "shape of the individual systems interaction with the network it's a",
    "start": "1457130",
    "end": "1463220"
  },
  {
    "text": "ratio of the bytes produced to the bytes consumed so that is bytes sent out onto",
    "start": "1463220",
    "end": "1468710"
  },
  {
    "text": "the network and versus the bytes downloaded from the network and in this case quote the network is a little bit",
    "start": "1468710",
    "end": "1475100"
  },
  {
    "text": "different depending on what type of activity you're looking for one thing that I find interesting about that",
    "start": "1475100",
    "end": "1480290"
  },
  {
    "text": "producer-consumer ratio hunt is that you can use it to look for two different things with the same exact process first",
    "start": "1480290",
    "end": "1487880"
  },
  {
    "text": "of all we can use it to look for data exfiltration that is information leaving our networks the idea is if a computer's",
    "start": "1487880",
    "end": "1496780"
  },
  {
    "text": "individual PCR number is let's say it's",
    "start": "1496780",
    "end": "1504530"
  },
  {
    "text": "you know starts out at zero which is the midline it exactly it doesn't really do",
    "start": "1504530",
    "end": "1512240"
  },
  {
    "text": "that much maybe it starts out at one I don't know wherever it is it's there",
    "start": "1512240",
    "end": "1517490"
  },
  {
    "text": "because of what that computer is typically used for so like a person a desktop a person browsing the web on",
    "start": "1517490",
    "end": "1524510"
  },
  {
    "text": "their desktop probably downloads much more information than they send they",
    "start": "1524510",
    "end": "1530690"
  },
  {
    "text": "send small HTTP requests they get giant gif files and streaming videos and things like that file servers might look",
    "start": "1530690",
    "end": "1537710"
  },
  {
    "text": "the exact opposite a file server might say you know I get very small requests",
    "start": "1537710",
    "end": "1543800"
  },
  {
    "text": "but I send lots of data out to the network and that's okay because the the",
    "start": "1543800",
    "end": "1549200"
  },
  {
    "text": "PC are number by itself doesn't really tell you that much about whether it's",
    "start": "1549200",
    "end": "1554510"
  },
  {
    "text": "being misused what you do is you look for the shift the change in the PC RS",
    "start": "1554510",
    "end": "1559880"
  },
  {
    "text": "over time so I did a simple analysis in in our testbed environment where I had a",
    "start": "1559880",
    "end": "1566960"
  },
  {
    "text": "number of hosts that I then proceeded to compromise and do a data exfiltration",
    "start": "1566960",
    "end": "1573930"
  },
  {
    "text": "and I collected the information from the test bed and computed the PCR for like",
    "start": "1573930",
    "end": "1579750"
  },
  {
    "text": "the the previous month and you see that on one axis and then the PCR for the",
    "start": "1579750",
    "end": "1585840"
  },
  {
    "text": "time period of the week that had the malicious activity in it on the other axis in many cases things didn't really",
    "start": "1585840",
    "end": "1596340"
  },
  {
    "text": "change like that system was not compromised or touched in its role didn't change so it basically stayed the",
    "start": "1596340",
    "end": "1603360"
  },
  {
    "text": "same and that's where this line comes in that line is the reference point for",
    "start": "1603360",
    "end": "1609090"
  },
  {
    "text": "there was no change anything on that line is by definition fine anything off",
    "start": "1609090",
    "end": "1615300"
  },
  {
    "text": "that line in in the direction starts to be a little bit weird maybe not too far",
    "start": "1615300",
    "end": "1621929"
  },
  {
    "text": "off the line not too far weird so we've color-coded it so that when the PCR",
    "start": "1621929",
    "end": "1627080"
  },
  {
    "text": "shifted positively that is they started to send more data than normal we color",
    "start": "1627080",
    "end": "1634500"
  },
  {
    "text": "coded that more red and when they shifted negatively they started to consume more data we color-coded it blue",
    "start": "1634500",
    "end": "1640080"
  },
  {
    "text": "so obviously the red can be data exfiltration and in fact in in our sample it actually turned out really",
    "start": "1640080",
    "end": "1646050"
  },
  {
    "text": "well because even though we had kind of a priori knowledge about which network",
    "start": "1646050",
    "end": "1651360"
  },
  {
    "text": "node was doing the exfiltration we we just did the math and came up and we",
    "start": "1651360",
    "end": "1657570"
  },
  {
    "text": "found yeah actually that was the highest PCR shift it was the most red dot on the",
    "start": "1657570",
    "end": "1663150"
  },
  {
    "text": "on the graft but the other thing is you can look at the blue dots as well depending on where you collect your data",
    "start": "1663150",
    "end": "1670590"
  },
  {
    "text": "the blue dots may indicate things like data collection and data staging prior",
    "start": "1670590",
    "end": "1676500"
  },
  {
    "text": "to X filtration as the attacker sits on a computer and copies things into the",
    "start": "1676500",
    "end": "1681929"
  },
  {
    "text": "computer that they're going to later send out you have to basically have your",
    "start": "1681929",
    "end": "1688620"
  },
  {
    "text": "data from a different collection point but it's the exact same data the exact same analysis process if you're looking",
    "start": "1688620",
    "end": "1695100"
  },
  {
    "text": "for data exfiltration you'll do this at the network perimeter and if you're looking for data staging in collection you're more likely to do it at your core",
    "start": "1695100",
    "end": "1701309"
  },
  {
    "text": "networks so you need Network session data you need like net flows or",
    "start": "1701309",
    "end": "1706700"
  },
  {
    "text": "Kahn logs or anything similar to that and our analysis was straight up",
    "start": "1706700",
    "end": "1712120"
  },
  {
    "text": "visualization was our technique and what we were looking for as you can see the the artifacts that we expect to find are",
    "start": "1712120",
    "end": "1718580"
  },
  {
    "text": "things that don't fall on the line and they're probably pretty far off the line",
    "start": "1718580",
    "end": "1725470"
  },
  {
    "start": "1727000",
    "end": "1980000"
  },
  {
    "text": "so for the next hunt we chose to merge",
    "start": "1728980",
    "end": "1734300"
  },
  {
    "text": "two different hunts into one because they kind of are looking for the same things and they're looking through the",
    "start": "1734300",
    "end": "1740390"
  },
  {
    "text": "same kind of data so it made a lot of sense we're looking for evidence of lateral movement because going you know",
    "start": "1740390",
    "end": "1750050"
  },
  {
    "text": "before you can ex rel trait things you're probably going to have to find things that you want around the network",
    "start": "1750050",
    "end": "1755870"
  },
  {
    "text": "you're unlikely that your initial access point is going to be the place where they have the product plans and it's",
    "start": "1755870",
    "end": "1762500"
  },
  {
    "text": "almost certainly not going to plead the place where they have the manufacturing details because you're probably not",
    "start": "1762500",
    "end": "1767900"
  },
  {
    "text": "going to get in through the ICS network at first so you will have to have an attacker move laterally to accomplish",
    "start": "1767900",
    "end": "1774200"
  },
  {
    "text": "either of those two goals so let's let's talk about how we we find this again",
    "start": "1774200",
    "end": "1780100"
  },
  {
    "text": "these are both documented more fully at the URLs that you see there I'm a threat",
    "start": "1780100",
    "end": "1786440"
  },
  {
    "text": "hunting project but the idea here is basically two things our our hypothesis",
    "start": "1786440",
    "end": "1792230"
  },
  {
    "text": "is that the commanding of sorry the lateral movement that might be happening in our network is probably going to",
    "start": "1792230",
    "end": "1798710"
  },
  {
    "text": "happen from the command line that's not always the way it happens but it is a very common way for attackers to get in",
    "start": "1798710",
    "end": "1805310"
  },
  {
    "text": "just drop a shell or a shell like program and and start running often with",
    "start": "1805310",
    "end": "1814100"
  },
  {
    "text": "native commands so we have two things that we want to look for we're going to look for shells or shell like things",
    "start": "1814100",
    "end": "1820940"
  },
  {
    "text": "like WMI services or whatever that are being started by parents that don't",
    "start": "1820940",
    "end": "1826610"
  },
  {
    "text": "usually start them so documents Word documents Excel whatever web browsers",
    "start": "1826610",
    "end": "1832690"
  },
  {
    "text": "even system services I mean this kind of basic things right and but this will all be in your process creation logs well",
    "start": "1832690",
    "end": "1839090"
  },
  {
    "text": "you'll have the information about what was started and what its parent process was and for that",
    "start": "1839090",
    "end": "1845530"
  },
  {
    "text": "hunt mostly we want to do lease frequency of analysis or stat counting",
    "start": "1845530",
    "end": "1850570"
  },
  {
    "text": "so we actually just count all the unique pairs of parent and command shell and we",
    "start": "1850570",
    "end": "1856390"
  },
  {
    "text": "find how many times that pair occurred in the dataset across our enterprise",
    "start": "1856390",
    "end": "1862050"
  },
  {
    "text": "without exception the very common things are going to have high counts and usually you can just like ignore those",
    "start": "1862050",
    "end": "1870640"
  },
  {
    "text": "so we'd usually start with like a reverse sort and we look for the most uncommon things first and this seems",
    "start": "1870640",
    "end": "1877000"
  },
  {
    "text": "like why are you talking about this a black hat it's very simple but actually",
    "start": "1877000",
    "end": "1882370"
  },
  {
    "text": "it's very effective because they're I guarantee you they're not that many times that you're your individual users",
    "start": "1882370",
    "end": "1891309"
  },
  {
    "text": "browsing around accidentally start up a PowerShell from within Microsoft Office",
    "start": "1891309",
    "end": "1898350"
  },
  {
    "text": "right the other thing that we want to hunt for through this same data is the",
    "start": "1898350",
    "end": "1904120"
  },
  {
    "text": "kind of the next phase they get a shell somewhere what's the first thing that they have to think about they want to",
    "start": "1904120",
    "end": "1909580"
  },
  {
    "text": "know where they got their shell what what kind of computer that is where it is in the network maybe what domain it's",
    "start": "1909580",
    "end": "1915490"
  },
  {
    "text": "in who the users are maybe what what can it see in its network neighborhood so they can maybe decide if that's the",
    "start": "1915490",
    "end": "1921460"
  },
  {
    "text": "place that they need to be to gather their information or if they want to make another hop somewhere else",
    "start": "1921460",
    "end": "1926650"
  },
  {
    "text": "and again there's many ways that they could attackers can get this information but a lot of times they just get it from",
    "start": "1926650",
    "end": "1933190"
  },
  {
    "text": "straight up from the commands that are already installed on the computer so we're gonna look for unusual spikes of a",
    "start": "1933190",
    "end": "1941920"
  },
  {
    "text": "cluster of these commands usually like anything in system 32 like IP config and",
    "start": "1941920",
    "end": "1949150"
  },
  {
    "text": "and all these all these ones in their queue user and things like that and we",
    "start": "1949150",
    "end": "1954790"
  },
  {
    "text": "want to look for spikes of those occurring on a single system in a short amount of time relatively short amount",
    "start": "1954790",
    "end": "1960130"
  },
  {
    "text": "of time it could be a kind of large amount of time like a one hour bucket even because they just don't get called",
    "start": "1960130",
    "end": "1965679"
  },
  {
    "text": "that often and so whenever they have a spike it's probably pretty obvious",
    "start": "1965679",
    "end": "1971100"
  },
  {
    "text": "and our analytic technique there is is basically just straight-up counting and",
    "start": "1971100",
    "end": "1976390"
  },
  {
    "text": "a little bit of visualization with the timeline and at this point I'm going to",
    "start": "1976390",
    "end": "1981820"
  },
  {
    "start": "1980000",
    "end": "2189000"
  },
  {
    "text": "turn it over to Rob here he's going to talk about the next couple hunts perfect so once our adversary moves from the IT",
    "start": "1981820",
    "end": "1988360"
  },
  {
    "text": "networks into the industrial control system networks things get a little weird and when you look at industrial",
    "start": "1988360",
    "end": "1993760"
  },
  {
    "text": "control system environments they're obviously not typical IT like environments even though you might have",
    "start": "1993760",
    "end": "1999070"
  },
  {
    "text": "a Window System in that network it's doing entirely different things with entirely different purposes and we have",
    "start": "1999070",
    "end": "2005280"
  },
  {
    "text": "to appreciate what those purposes are to fully understand what adversaries might need to get and how we're gonna find",
    "start": "2005280",
    "end": "2010590"
  },
  {
    "text": "them as an example a lot of the different instant response cases and hunting I've done before in ICS",
    "start": "2010590",
    "end": "2016200"
  },
  {
    "text": "environments it's actually pretty typical to find adversaries positioning themselves on places like human-machine",
    "start": "2016200",
    "end": "2021270"
  },
  {
    "text": "interfaces the human machine interface which I gave a sample little graphic up there yes",
    "start": "2021270",
    "end": "2026550"
  },
  {
    "text": "they all do kind of look like Windows 95 paint but the human machine err faces",
    "start": "2026550",
    "end": "2031560"
  },
  {
    "text": "are the way that the operators interact with the physical equipments sending commands to open up valves or spinning a",
    "start": "2031560",
    "end": "2038220"
  },
  {
    "text": "turbine faster or getting a different rate of fidget spinners off the line so",
    "start": "2038220",
    "end": "2043640"
  },
  {
    "text": "adversaries tend to position they're one of the one of the reasons I thought this before is it feels like common territory",
    "start": "2043640",
    "end": "2051090"
  },
  {
    "text": "usually again Linux or Windows environments hosting these systems but also in that HMI you will get a",
    "start": "2051090",
    "end": "2056450"
  },
  {
    "text": "representation of what the physical process is it's not going to give you everything you need to know but it's",
    "start": "2056450",
    "end": "2062220"
  },
  {
    "text": "gonna give you an understanding that oh there is a valve on the network there is a conveyor belt and here's the type of",
    "start": "2062220",
    "end": "2068070"
  },
  {
    "text": "systems I can expect to pair up off of what my logical discovery on the network is to an actual representation of it a",
    "start": "2068070",
    "end": "2074669"
  },
  {
    "text": "lot of the difficulty for adversaries and industrial control system environments is not things like",
    "start": "2074669",
    "end": "2079800"
  },
  {
    "text": "vulnerabilities and exploits it's an understanding the actual systems themselves I often push back on a little",
    "start": "2079800",
    "end": "2086669"
  },
  {
    "text": "bit of the hype in the community where we hear things like oh my gosh an energy company had an adversary access the",
    "start": "2086669",
    "end": "2092398"
  },
  {
    "text": "system and it's like yes now make the lights blink it's a little harder than it sounds so for our adversaries they've",
    "start": "2092399",
    "end": "2098610"
  },
  {
    "text": "got to get to that HMI to understand a lot about what's going on with our manufacturing process some of the things that we can look for",
    "start": "2098610",
    "end": "2105100"
  },
  {
    "text": "some of them seem pretty trivial but a lot of times the biggest problem is actually getting data collection off of",
    "start": "2105100",
    "end": "2110660"
  },
  {
    "text": "those environments but as an example we might see new processes spin up on an HMI these are not environments that we",
    "start": "2110660",
    "end": "2117410"
  },
  {
    "text": "should have a lot of new software applications installed on or new process is spinning up especially not outside of",
    "start": "2117410",
    "end": "2122720"
  },
  {
    "text": "maintenance periods so there's a temporal nature to a lot of industrial control system environments about what",
    "start": "2122720",
    "end": "2127910"
  },
  {
    "text": "it's supposed to be doing and then given course of time we shouldn't see updates to systems or new processes spawning or",
    "start": "2127910",
    "end": "2135370"
  },
  {
    "text": "systems rebooting outside of things like maintenance periods that they're going in to maintain the equipment so that",
    "start": "2135370",
    "end": "2141200"
  },
  {
    "text": "would be exactly what we're looking for in this environment you could do some sort of exfiltrate off of this as well",
    "start": "2141200",
    "end": "2146390"
  },
  {
    "text": "and apply some that previous hunt knowledge as well but realistically what we're looking for is new connections maybe even VPN session lengths in one",
    "start": "2146390",
    "end": "2154880"
  },
  {
    "text": "environment we were looking at VPNs into the environment from the maintenance personnel and they would come in on a",
    "start": "2154880",
    "end": "2161150"
  },
  {
    "text": "fairly regular basis they were logging into the network about once every two weeks and they would be the VPN itself",
    "start": "2161150",
    "end": "2167600"
  },
  {
    "text": "up for about thirty minutes to an hour as they did their small maintenance but in the same network we saw a compromise",
    "start": "2167600",
    "end": "2173750"
  },
  {
    "text": "one time that the adversary was using the VPN but now they were coming in every day and they were doing it for five to fifteen minutes at a time",
    "start": "2173750",
    "end": "2180170"
  },
  {
    "text": "grabbing data and leaving so the session length and duration would be entirely different and how they're accessing",
    "start": "2180170",
    "end": "2185570"
  },
  {
    "text": "things like HMIS and then of course is things that we want to look for but HMIS alone won't give you the",
    "start": "2185570",
    "end": "2192050"
  },
  {
    "start": "2189000",
    "end": "2314000"
  },
  {
    "text": "manufacturing details we will want a lot more information sometimes that information can be stored in places like",
    "start": "2192050",
    "end": "2197270"
  },
  {
    "text": "data historians a data historian at times is really just sort of a sequel database but it gives you an",
    "start": "2197270",
    "end": "2202940"
  },
  {
    "text": "understanding of exactly what's going on in the industrial process itself how fast the turbines spinning how how far",
    "start": "2202940",
    "end": "2209180"
  },
  {
    "text": "did you slow it down and in a given point it's kind of the brain and memory of what's going on in the physical",
    "start": "2209180",
    "end": "2214400"
  },
  {
    "text": "process so even if I had a specification for what the fidgets spinner was if I",
    "start": "2214400",
    "end": "2219620"
  },
  {
    "text": "wanted to know exactly how to make it there's a lot of timing and interesting details around how much mixture in terms",
    "start": "2219620",
    "end": "2225680"
  },
  {
    "text": "of the recipes or or exactly when did it leave one section of the conveyor belt and go to the next and again all that",
    "start": "2225680",
    "end": "2231770"
  },
  {
    "text": "information would be in somewhere like a data historian in this location sometimes we can get a couple different",
    "start": "2231770",
    "end": "2237140"
  },
  {
    "text": "types of artifacts one might simply be more alarms or additional inputs than",
    "start": "2237140",
    "end": "2242299"
  },
  {
    "text": "normal especially if somebody was actually doing an attack in our environment so that type of distribution would look very different in a lot of",
    "start": "2242299",
    "end": "2249019"
  },
  {
    "text": "visualization analysis taking place there but in the same way we might see exfiltration again coming off of these",
    "start": "2249019",
    "end": "2254990"
  },
  {
    "text": "types of environments especially for ready to espionage and intellectual property theft so looking for these",
    "start": "2254990",
    "end": "2260150"
  },
  {
    "text": "systems and and I think again from a hunter perspective you might be misguided to look at and go oh it's a",
    "start": "2260150",
    "end": "2265910"
  },
  {
    "text": "Window System I'm gonna do the normal things there's a lot of different data on that system that we can start pulling",
    "start": "2265910",
    "end": "2271490"
  },
  {
    "text": "off to identify the type of activity that an adversary would be doing one of the things I want to note about that as",
    "start": "2271490",
    "end": "2277010"
  },
  {
    "text": "well is again if you're if you are in an ICS organization and you're looking to go do these hunts you'll find that over",
    "start": "2277010",
    "end": "2283309"
  },
  {
    "text": "the years we have prioritized a lot of network data which is really good because a lot of information flows over",
    "start": "2283309",
    "end": "2288740"
  },
  {
    "text": "the network for us but a lot of the host based data has typically not been collected out of these environments and so our hunting can actually drive our",
    "start": "2288740",
    "end": "2295279"
  },
  {
    "text": "collection process as well because we can come up with a hypothesis that I need that type of host data and realize",
    "start": "2295279",
    "end": "2300559"
  },
  {
    "text": "that I have no ability to collect it so even though my hunt wasn't successful in actually doing the hunt I then drive",
    "start": "2300559",
    "end": "2307099"
  },
  {
    "text": "future processes and how to actually position the organization better in the future and that some of that seemed sort of bridging that we talked about earlier",
    "start": "2307099",
    "end": "2314230"
  },
  {
    "start": "2314000",
    "end": "2716000"
  },
  {
    "text": "what David how far off our final hunt",
    "start": "2314230",
    "end": "2319369"
  },
  {
    "text": "I'm gonna invoke a buzzword machine learning so one of the things that we",
    "start": "2319369",
    "end": "2331069"
  },
  {
    "text": "had in our priority plan was we wanted to look for okay we already did data",
    "start": "2331069",
    "end": "2336230"
  },
  {
    "text": "exfiltration and lateral movements we did some stuff inside the ICS environment and then the next thing in",
    "start": "2336230",
    "end": "2344450"
  },
  {
    "text": "our priority list is we want to look for evidence of possible command and control activities or malware activities in our",
    "start": "2344450",
    "end": "2351829"
  },
  {
    "text": "network there again this is a situation where there are many different ways this",
    "start": "2351829",
    "end": "2357589"
  },
  {
    "text": "could be accomplished so you kind of have to break them down and do the individual hunts for each one of those",
    "start": "2357589",
    "end": "2364190"
  },
  {
    "text": "different ways that you've identified would work in your area the most common probably that",
    "start": "2364190",
    "end": "2370370"
  },
  {
    "text": "I would venture to say Oh probably everyone in the room probably has is",
    "start": "2370370",
    "end": "2376390"
  },
  {
    "text": "HTTP communications out to the Internet",
    "start": "2376390",
    "end": "2383049"
  },
  {
    "text": "that's particularly hard to find things that are unusual in there just because",
    "start": "2383260",
    "end": "2388610"
  },
  {
    "text": "of the volume and velocity of that data that is and in many cases truly a big data problem just just figuring out how",
    "start": "2388610",
    "end": "2395600"
  },
  {
    "text": "to store all that information about your outgoing HTTP information coming off your proxies or your network monitoring",
    "start": "2395600",
    "end": "2401720"
  },
  {
    "text": "sensors or anything like that but our hypothesis is that if you can figure out",
    "start": "2401720",
    "end": "2407720"
  },
  {
    "text": "how to look for that some things in",
    "start": "2407720",
    "end": "2412870"
  },
  {
    "text": "malware command and control or attacker command control are a little bit",
    "start": "2412870",
    "end": "2417980"
  },
  {
    "text": "different than regular HTTP transactions and it could be a combination of many",
    "start": "2417980",
    "end": "2424730"
  },
  {
    "text": "factors that are different such as the length of the session the the order of",
    "start": "2424730",
    "end": "2430940"
  },
  {
    "text": "the headers that they've provided in their requests the URLs that they're",
    "start": "2430940",
    "end": "2435950"
  },
  {
    "text": "going to even the domains etc there's many things to look for so this actually",
    "start": "2435950",
    "end": "2441650"
  },
  {
    "text": "makes it a really good candidate for doing some machine learning to help you",
    "start": "2441650",
    "end": "2446930"
  },
  {
    "text": "this is a kind of a situation where I said earlier at the beginning where some of these processes are semi automated",
    "start": "2446930",
    "end": "2453670"
  },
  {
    "text": "well a friend of mine Chris McCubbin and I released a tool I think early last",
    "start": "2453670",
    "end": "2459620"
  },
  {
    "text": "year it's available on github called clear-cut clear-cut is our proof of",
    "start": "2459620",
    "end": "2466910"
  },
  {
    "text": "concept to show that you could actually get some value just by applying a simple machine learning model to your own HTTP",
    "start": "2466910",
    "end": "2474050"
  },
  {
    "text": "logs to find the things that are a little bit different or odd and I'm not",
    "start": "2474050",
    "end": "2481340"
  },
  {
    "text": "going to go into exactly how machine learning works in my last eight minutes of the presentation because I am NOT a",
    "start": "2481340",
    "end": "2489050"
  },
  {
    "text": "trained auctioneer and I cannot talk that quickly however I will say please",
    "start": "2489050",
    "end": "2494420"
  },
  {
    "text": "if you're interested in in mutt in more details you can find more on the the",
    "start": "2494420",
    "end": "2499700"
  },
  {
    "text": "link here on the slide and there's even some YouTube videos but I will tell you our our clear-cut tool has two different",
    "start": "2499700",
    "end": "2506570"
  },
  {
    "text": "modes of operation one of them is it uses a kind of traditional random forest",
    "start": "2506570",
    "end": "2513710"
  },
  {
    "text": "model to learn these things have been labeled as malware transactions we had",
    "start": "2513710",
    "end": "2520220"
  },
  {
    "text": "to provide a bunch of malware transactions and these things have been labeled as totally legitimate",
    "start": "2520220",
    "end": "2526870"
  },
  {
    "text": "transactions we do what's called feature ization that is we break down the text",
    "start": "2526870",
    "end": "2532940"
  },
  {
    "text": "of the HTTP logs into basically a set of numbers that we can do computations with",
    "start": "2532940",
    "end": "2539180"
  },
  {
    "text": "and all this code is available in there and documented so that you can use it and mess with it to feature eyes your",
    "start": "2539180",
    "end": "2546140"
  },
  {
    "text": "own logs the way you like them and and then we train them through this algorithm called random forests that",
    "start": "2546140",
    "end": "2552620"
  },
  {
    "text": "basically says it creates a bunch of individual decision trees and says if",
    "start": "2552620",
    "end": "2558470"
  },
  {
    "text": "this random feature that I took out of the data set for an individual line this random feature splits the data this",
    "start": "2558470",
    "end": "2568010"
  },
  {
    "text": "other random feature splits the data it makes a tree until you get to the end and they and you have a yes or a No with",
    "start": "2568010",
    "end": "2574160"
  },
  {
    "text": "this malicious or was this benign and it's a random forest because it creates",
    "start": "2574160",
    "end": "2580550"
  },
  {
    "text": "a bunch of these random decision trees many of these decision trees and each",
    "start": "2580550",
    "end": "2586070"
  },
  {
    "text": "time basically it goes through and computes all the trees and and basically averages them out at the end and then",
    "start": "2586070",
    "end": "2591860"
  },
  {
    "text": "you get the average answer yes or no it's very effective it's very pretty quick I won't say it's",
    "start": "2591860",
    "end": "2598370"
  },
  {
    "text": "super quick but it's pretty quick and it does a great job of cutting down the",
    "start": "2598370",
    "end": "2604580"
  },
  {
    "text": "logs that you have to look at I think in our tests we found that we were only",
    "start": "2604580",
    "end": "2609920"
  },
  {
    "text": "reviewing something like point oh one percent of our logs manually after clearcut ran and the random forests so",
    "start": "2609920",
    "end": "2617990"
  },
  {
    "text": "it still is a role for a human but not quite at the scale that it would be",
    "start": "2617990",
    "end": "2625340"
  },
  {
    "text": "impossible to do anymore the other mechanism that clearcut has is it has this unsupervised machine learning where",
    "start": "2625340",
    "end": "2632690"
  },
  {
    "text": "they do a little bit of clustering with a kind of I don't know unusual out called isolation forests in the",
    "start": "2632690",
    "end": "2640100"
  },
  {
    "text": "isolation forests take the same features that the random forest does but we don't",
    "start": "2640100",
    "end": "2645320"
  },
  {
    "text": "have to tell it these are bad and these are good and train that model that way what with what they do is they plot kind",
    "start": "2645320",
    "end": "2654200"
  },
  {
    "text": "of a it sounds like this is gonna sound like Doctor Who but they say plot like a 104 dimension matrix and it's all timing",
    "start": "2654200",
    "end": "2665750"
  },
  {
    "text": "why me wibbly-wobbly stuff but they and then they look in that hundred and four",
    "start": "2665750",
    "end": "2671390"
  },
  {
    "text": "dimension matrix to see which points are closest to the other points and which",
    "start": "2671390",
    "end": "2678260"
  },
  {
    "text": "ones are farther away and they do this by making a series of random cuts and they say the number of cuts that you",
    "start": "2678260",
    "end": "2685820"
  },
  {
    "text": "have to do to isolate that individual data point is a measure of how far from",
    "start": "2685820",
    "end": "2692450"
  },
  {
    "text": "normal that data point is so if you can then do a relatively few cuts it's very far from normal",
    "start": "2692450",
    "end": "2697790"
  },
  {
    "text": "if you have to do a lot of cuts it's close into one of these dense compact things again I don't really have time to",
    "start": "2697790",
    "end": "2703670"
  },
  {
    "text": "explain that in detail even if I did understand it entirely but definitely if",
    "start": "2703670",
    "end": "2711320"
  },
  {
    "text": "you're interested go check out the tool watch the YouTube video and you'll see Rob you want to bring it home bring it",
    "start": "2711320",
    "end": "2718010"
  },
  {
    "start": "2716000",
    "end": "2739000"
  },
  {
    "text": "on home all right our story is done you know what to do when you're back in the office next week",
    "start": "2718010",
    "end": "2724640"
  },
  {
    "text": "make a good plan aligned with your needs then go to hunt and oh you're asleep",
    "start": "2724640",
    "end": "2730840"
  },
  {
    "text": "thank you everybody for attending our presentation I hope you found it enjoyable and educational",
    "start": "2730840",
    "end": "2738160"
  },
  {
    "text": "[Applause]",
    "start": "2739400",
    "end": "2741819"
  }
]