[
  {
    "start": "0",
    "end": "18000"
  },
  {
    "text": "so welcome to they're coming for your",
    "start": "30",
    "end": "1439"
  },
  {
    "text": "tools exploiting design flaws for active",
    "start": "1439",
    "end": "3510"
  },
  {
    "text": "intrusion prevention I am John Ventura",
    "start": "3510",
    "end": "5580"
  },
  {
    "text": "and I am part of opt-ins research",
    "start": "5580",
    "end": "7799"
  },
  {
    "text": "practice I was also a member of Isis",
    "start": "7799",
    "end": "10500"
  },
  {
    "text": "x-force back in the day and along the",
    "start": "10500",
    "end": "13139"
  },
  {
    "text": "way I've done some malware research and",
    "start": "13139",
    "end": "14790"
  },
  {
    "text": "I think that's informed a certain",
    "start": "14790",
    "end": "15839"
  },
  {
    "text": "perspective that you'll see on display",
    "start": "15839",
    "end": "18150"
  },
  {
    "start": "18000",
    "end": "60000"
  },
  {
    "text": "here so we are targeting design flaws in",
    "start": "18150",
    "end": "21029"
  },
  {
    "text": "popular attack tools and method and",
    "start": "21029",
    "end": "23189"
  },
  {
    "text": "methodologies we're doing this as a",
    "start": "23189",
    "end": "25170"
  },
  {
    "text": "means of intrusion prevention sometimes",
    "start": "25170",
    "end": "27720"
  },
  {
    "text": "people break into computers attackers",
    "start": "27720",
    "end": "29760"
  },
  {
    "text": "pen testers people I can't even imagine",
    "start": "29760",
    "end": "31380"
  },
  {
    "text": "and this set of people they face common",
    "start": "31380",
    "end": "36270"
  },
  {
    "text": "problems and sometimes people solve",
    "start": "36270",
    "end": "37890"
  },
  {
    "text": "those problems by creating software and",
    "start": "37890",
    "end": "39989"
  },
  {
    "text": "when they do that well when those",
    "start": "39989",
    "end": "41579"
  },
  {
    "text": "solutions are effective those software",
    "start": "41579",
    "end": "44460"
  },
  {
    "text": "packages often become popular and just",
    "start": "44460",
    "end": "46950"
  },
  {
    "text": "like any other software out there those",
    "start": "46950",
    "end": "48539"
  },
  {
    "text": "software packages exhibit",
    "start": "48539",
    "end": "49829"
  },
  {
    "text": "vulnerabilities and it's the",
    "start": "49829",
    "end": "52199"
  },
  {
    "text": "exploitation of those vulnerabilities",
    "start": "52199",
    "end": "53550"
  },
  {
    "text": "which is a path towards improved",
    "start": "53550",
    "end": "57300"
  },
  {
    "text": "intrusion prevention and you can do this",
    "start": "57300",
    "end": "59850"
  },
  {
    "text": "with little cost so this is a talk for",
    "start": "59850",
    "end": "62489"
  },
  {
    "start": "60000",
    "end": "122000"
  },
  {
    "text": "both blue teens and red team's so if",
    "start": "62489",
    "end": "64768"
  },
  {
    "text": "you're part of a blue team and it's your",
    "start": "64769",
    "end": "66210"
  },
  {
    "text": "job to defend networks to defend",
    "start": "66210",
    "end": "67860"
  },
  {
    "text": "computers I'm talking to you you need to",
    "start": "67860",
    "end": "70409"
  },
  {
    "text": "know that you can exploit these design",
    "start": "70409",
    "end": "71850"
  },
  {
    "text": "flaws as a means of intrusion prevention",
    "start": "71850",
    "end": "73140"
  },
  {
    "text": "you can turn the tables on the bad guys",
    "start": "73140",
    "end": "75299"
  },
  {
    "text": "you can exploit vulnerabilities in their",
    "start": "75299",
    "end": "77640"
  },
  {
    "text": "software for a change you can do",
    "start": "77640",
    "end": "79350"
  },
  {
    "text": "proactive responses and we'll show you",
    "start": "79350",
    "end": "80759"
  },
  {
    "text": "how to do that here if you're a red",
    "start": "80759",
    "end": "83009"
  },
  {
    "text": "teamer like these guys and you break",
    "start": "83009",
    "end": "85049"
  },
  {
    "text": "into computers for whatever reason you",
    "start": "85049",
    "end": "87299"
  },
  {
    "text": "have to know that just like any other",
    "start": "87299",
    "end": "89159"
  },
  {
    "text": "piece of software that you introduce",
    "start": "89159",
    "end": "90420"
  },
  {
    "text": "into a network environment your tools",
    "start": "90420",
    "end": "92310"
  },
  {
    "text": "bring with them a certain set of",
    "start": "92310",
    "end": "93780"
  },
  {
    "text": "vulnerabilities you cannot treat your",
    "start": "93780",
    "end": "96060"
  },
  {
    "text": "tools as a magic black box you really",
    "start": "96060",
    "end": "99930"
  },
  {
    "text": "need to be careful with how you do these",
    "start": "99930",
    "end": "101130"
  },
  {
    "text": "things especially if you're a pen tester",
    "start": "101130",
    "end": "103020"
  },
  {
    "text": "if you are not careful you could",
    "start": "103020",
    "end": "104790"
  },
  {
    "text": "potentially get your clients compromised",
    "start": "104790",
    "end": "106560"
  },
  {
    "text": "due to euro actions this is a some",
    "start": "106560",
    "end": "109829"
  },
  {
    "text": "pretty serious stuff and on the other",
    "start": "109829",
    "end": "111570"
  },
  {
    "text": "side of that coin if if you're so",
    "start": "111570",
    "end": "114149"
  },
  {
    "text": "inclined you can target other attackers",
    "start": "114149",
    "end": "116310"
  },
  {
    "text": "you can steal their shells make them do",
    "start": "116310",
    "end": "118229"
  },
  {
    "text": "do your hacking for you and I think",
    "start": "118229",
    "end": "121049"
  },
  {
    "text": "there's some walls there so we're gonna",
    "start": "121049",
    "end": "124079"
  },
  {
    "start": "122000",
    "end": "153000"
  },
  {
    "text": "be talking about two different",
    "start": "124079",
    "end": "124969"
  },
  {
    "text": "strategies for this today the first of",
    "start": "124969",
    "end": "127500"
  },
  {
    "text": "which is going to be man-in-the-middle",
    "start": "127500",
    "end": "128629"
  },
  {
    "text": "counter-attacks against insecure command",
    "start": "128629",
    "end": "130739"
  },
  {
    "text": "and control channels",
    "start": "130739",
    "end": "132250"
  },
  {
    "text": "specifically we'll be touching on",
    "start": "132250",
    "end": "133810"
  },
  {
    "text": "meterpreter and partial Empire and we'll",
    "start": "133810",
    "end": "136030"
  },
  {
    "text": "talk about a few others and after that",
    "start": "136030",
    "end": "138100"
  },
  {
    "text": "we will discuss some countermeasures",
    "start": "138100",
    "end": "140050"
  },
  {
    "text": "against brute force password recovery so",
    "start": "140050",
    "end": "142510"
  },
  {
    "text": "if you are using in DNS or LM in our",
    "start": "142510",
    "end": "144670"
  },
  {
    "text": "spoofing to steal people's hashes we're",
    "start": "144670",
    "end": "146590"
  },
  {
    "text": "gonna make that harder and if you are",
    "start": "146590",
    "end": "148420"
  },
  {
    "text": "trying to steal somebody's pre shared",
    "start": "148420",
    "end": "149590"
  },
  {
    "text": "key on a wireless network we're gonna",
    "start": "149590",
    "end": "151990"
  },
  {
    "text": "make that harder to so this isn't just",
    "start": "151990",
    "end": "155709"
  },
  {
    "start": "153000",
    "end": "200000"
  },
  {
    "text": "theory we are releasing proof of concept",
    "start": "155709",
    "end": "157930"
  },
  {
    "text": "tools to demonstrate these techniques",
    "start": "157930",
    "end": "159550"
  },
  {
    "text": "you can download them use them at home",
    "start": "159550",
    "end": "161610"
  },
  {
    "text": "we wrote these in C we wrote these to be",
    "start": "161610",
    "end": "164080"
  },
  {
    "text": "really compact and small and if you ran",
    "start": "164080",
    "end": "165970"
  },
  {
    "text": "them all together at once even the ones",
    "start": "165970",
    "end": "168280"
  },
  {
    "text": "that we aren't showing here they would",
    "start": "168280",
    "end": "169989"
  },
  {
    "text": "take up less than 200 K of memory so if",
    "start": "169989",
    "end": "173620"
  },
  {
    "text": "for some reason you're still using a",
    "start": "173620",
    "end": "174820"
  },
  {
    "text": "Commodore 64 it might be time to upgrade",
    "start": "174820",
    "end": "177040"
  },
  {
    "text": "or consider maybe running them one at a",
    "start": "177040",
    "end": "179440"
  },
  {
    "text": "time",
    "start": "179440",
    "end": "180610"
  },
  {
    "text": "that was upgrades they don't necessarily",
    "start": "180610",
    "end": "182560"
  },
  {
    "text": "have to be expensive the whole point",
    "start": "182560",
    "end": "185620"
  },
  {
    "text": "there being you can use so called",
    "start": "185620",
    "end": "187060"
  },
  {
    "text": "next-gen security solutions you can do",
    "start": "187060",
    "end": "189670"
  },
  {
    "text": "that on the cheap it doesn't necessarily",
    "start": "189670",
    "end": "191080"
  },
  {
    "text": "have to come in a multi-thousand dollar",
    "start": "191080",
    "end": "192730"
  },
  {
    "text": "a magic box",
    "start": "192730",
    "end": "195040"
  },
  {
    "text": "you can do this cheaply but don't don't",
    "start": "195040",
    "end": "196870"
  },
  {
    "text": "tell the guys in the vendor hall I just",
    "start": "196870",
    "end": "198160"
  },
  {
    "text": "said that because because they're great",
    "start": "198160",
    "end": "200730"
  },
  {
    "text": "so let's talk about those command and",
    "start": "200730",
    "end": "202810"
  },
  {
    "text": "control channels if you want two",
    "start": "202810",
    "end": "205390"
  },
  {
    "text": "computers to talk to each other in a",
    "start": "205390",
    "end": "206950"
  },
  {
    "text": "secure way and they've never talked to",
    "start": "206950",
    "end": "208840"
  },
  {
    "text": "each other before this is a surprisingly",
    "start": "208840",
    "end": "210910"
  },
  {
    "text": "difficult challenge and if you want to",
    "start": "210910",
    "end": "212739"
  },
  {
    "text": "get an idea of what I mean consider",
    "start": "212739",
    "end": "214450"
  },
  {
    "text": "tls/ssl or open ssl in particular some",
    "start": "214450",
    "end": "218049"
  },
  {
    "text": "really smart people have been working on",
    "start": "218049",
    "end": "220030"
  },
  {
    "text": "that I'm working on those efforts now",
    "start": "220030",
    "end": "221950"
  },
  {
    "text": "for decades and occasionally significant",
    "start": "221950",
    "end": "225700"
  },
  {
    "text": "vulnerabilities still show up and a lot",
    "start": "225700",
    "end": "227320"
  },
  {
    "text": "of them even have catchy names so if you",
    "start": "227320",
    "end": "229959"
  },
  {
    "text": "consider you know the the scope and",
    "start": "229959",
    "end": "232090"
  },
  {
    "text": "breadth of that community and all the",
    "start": "232090",
    "end": "233860"
  },
  {
    "text": "effort that's gone in into that that is",
    "start": "233860",
    "end": "235720"
  },
  {
    "text": "a tremendous head start on any",
    "start": "235720",
    "end": "237070"
  },
  {
    "text": "communication channel you are likely to",
    "start": "237070",
    "end": "239110"
  },
  {
    "text": "develop yourself so if you still want to",
    "start": "239110",
    "end": "241269"
  },
  {
    "text": "take that on best of luck to you but in",
    "start": "241269",
    "end": "243970"
  },
  {
    "text": "the real world there are almost always",
    "start": "243970",
    "end": "245590"
  },
  {
    "text": "men in the middle attacks and let's talk",
    "start": "245590",
    "end": "247120"
  },
  {
    "text": "about some of those right now the first",
    "start": "247120",
    "end": "249340"
  },
  {
    "start": "248000",
    "end": "351000"
  },
  {
    "text": "of these software packages that we",
    "start": "249340",
    "end": "251470"
  },
  {
    "text": "looked at was meterpreter which is part",
    "start": "251470",
    "end": "253840"
  },
  {
    "text": "of the Metasploit framework and this",
    "start": "253840",
    "end": "255640"
  },
  {
    "text": "diagram that you see in front of you is",
    "start": "255640",
    "end": "257260"
  },
  {
    "text": "a representation of the typical staging",
    "start": "257260",
    "end": "261039"
  },
  {
    "text": "scenario for meterpreter I say typical",
    "start": "261039",
    "end": "263260"
  },
  {
    "text": "because there is a so called paranoid",
    "start": "263260",
    "end": "266199"
  },
  {
    "text": "that uses tls/ssl and certificate",
    "start": "266199",
    "end": "268720"
  },
  {
    "text": "pinning and it is not necessarily the",
    "start": "268720",
    "end": "271540"
  },
  {
    "text": "easiest thing in the world it takes",
    "start": "271540",
    "end": "273130"
  },
  {
    "text": "extra configuration steps you need to",
    "start": "273130",
    "end": "275260"
  },
  {
    "text": "use third-party binaries the OpenSSL",
    "start": "275260",
    "end": "277570"
  },
  {
    "text": "command line in particular it is not",
    "start": "277570",
    "end": "279639"
  },
  {
    "text": "necessarily intuitive for a lot of",
    "start": "279639",
    "end": "281139"
  },
  {
    "text": "people and you won't even see it",
    "start": "281139",
    "end": "282820"
  },
  {
    "text": "documented in a lot of how-to or getting",
    "start": "282820",
    "end": "284560"
  },
  {
    "text": "started guides and I'm not even sure it",
    "start": "284560",
    "end": "286840"
  },
  {
    "text": "works in some real-world situations like",
    "start": "286840",
    "end": "288850"
  },
  {
    "text": "if you're gonna go through someone",
    "start": "288850",
    "end": "289780"
  },
  {
    "text": "else's proxy or if you're gonna embed",
    "start": "289780",
    "end": "292240"
  },
  {
    "text": "meterpreter within an exploit like MSO",
    "start": "292240",
    "end": "293949"
  },
  {
    "text": "eight oh six seven it's not the easiest",
    "start": "293949",
    "end": "295690"
  },
  {
    "text": "thing to do so most people are gonna opt",
    "start": "295690",
    "end": "298120"
  },
  {
    "text": "for this what you see here and in this",
    "start": "298120",
    "end": "301780"
  },
  {
    "text": "diagram meterpreter or Metasploit is",
    "start": "301780",
    "end": "303669"
  },
  {
    "text": "represented by the Metasploit logo and",
    "start": "303669",
    "end": "305830"
  },
  {
    "text": "the machine being compromised today is",
    "start": "305830",
    "end": "307539"
  },
  {
    "text": "the Hal 9000 these arrows in between",
    "start": "307539",
    "end": "310840"
  },
  {
    "text": "them are a TCP connection and the first",
    "start": "310840",
    "end": "313090"
  },
  {
    "text": "thing that gets transmitted across that",
    "start": "313090",
    "end": "314949"
  },
  {
    "text": "TCP connection is a TCP segment that has",
    "start": "314949",
    "end": "317620"
  },
  {
    "text": "a 32 bit or 4 byte payload length field",
    "start": "317620",
    "end": "320639"
  },
  {
    "text": "following that there's a slight pause",
    "start": "320639",
    "end": "322690"
  },
  {
    "text": "and then the actual payload itself gets",
    "start": "322690",
    "end": "325360"
  },
  {
    "text": "transmitted and that payload is the",
    "start": "325360",
    "end": "326620"
  },
  {
    "text": "meterpreter client when Hal gets that",
    "start": "326620",
    "end": "328780"
  },
  {
    "text": "payload length field he allocates a",
    "start": "328780",
    "end": "331419"
  },
  {
    "text": "certain chunk of memory that is going to",
    "start": "331419",
    "end": "333580"
  },
  {
    "text": "be equal to or greater than that payload",
    "start": "333580",
    "end": "334960"
  },
  {
    "text": "length and then he waits for that",
    "start": "334960",
    "end": "336250"
  },
  {
    "text": "payload to come across when he gets the",
    "start": "336250",
    "end": "338590"
  },
  {
    "text": "payload he copies it into that chunk of",
    "start": "338590",
    "end": "340479"
  },
  {
    "text": "memory that he just allocated and then",
    "start": "340479",
    "end": "342340"
  },
  {
    "text": "switches execution there there by",
    "start": "342340",
    "end": "344050"
  },
  {
    "text": "running the meterpreter client and the",
    "start": "344050",
    "end": "345970"
  },
  {
    "text": "meterpreter control channel gets",
    "start": "345970",
    "end": "347110"
  },
  {
    "text": "established and that bottom arrow exists",
    "start": "347110",
    "end": "348970"
  },
  {
    "text": "and this is what we can do about it in",
    "start": "348970",
    "end": "352120"
  },
  {
    "start": "351000",
    "end": "450000"
  },
  {
    "text": "this diagram this is our response and",
    "start": "352120",
    "end": "354520"
  },
  {
    "text": "you get to be dave bowman the star child",
    "start": "354520",
    "end": "356380"
  },
  {
    "text": "himself and dave is running a",
    "start": "356380",
    "end": "358750"
  },
  {
    "text": "proof-of-concept sniffer that we",
    "start": "358750",
    "end": "360130"
  },
  {
    "text": "developed to demonstrate this",
    "start": "360130",
    "end": "361870"
  },
  {
    "text": "man-in-the-middle counter attack and",
    "start": "361870",
    "end": "363310"
  },
  {
    "text": "that proof-of-concept sniffer looks at",
    "start": "363310",
    "end": "365380"
  },
  {
    "text": "all the TCP segments it can and it looks",
    "start": "365380",
    "end": "367810"
  },
  {
    "text": "for payload links segments that it",
    "start": "367810",
    "end": "369340"
  },
  {
    "text": "recognizes and what's nice about those",
    "start": "369340",
    "end": "370990"
  },
  {
    "text": "payload link segments is that they are",
    "start": "370990",
    "end": "372669"
  },
  {
    "text": "relatively static so if you are staging",
    "start": "372669",
    "end": "376570"
  },
  {
    "text": "with a Microsoft Windows 64 bit machine",
    "start": "376570",
    "end": "378580"
  },
  {
    "text": "for example that payload linked field is",
    "start": "378580",
    "end": "381220"
  },
  {
    "text": "likely to be a certain value and the",
    "start": "381220",
    "end": "384370"
  },
  {
    "text": "sniffer knows about many of those values",
    "start": "384370",
    "end": "386500"
  },
  {
    "text": "and when it sees a payload links TCP",
    "start": "386500",
    "end": "389229"
  },
  {
    "text": "segment that it recognizes it takes",
    "start": "389229",
    "end": "391210"
  },
  {
    "text": "these sequence numbers from that",
    "start": "391210",
    "end": "393250"
  },
  {
    "text": "from that segment and it anticipates",
    "start": "393250",
    "end": "395590"
  },
  {
    "text": "what the sequence numbers will be for",
    "start": "395590",
    "end": "397180"
  },
  {
    "text": "the payload and then it uses packet",
    "start": "397180",
    "end": "400420"
  },
  {
    "text": "spoofing to inject a custom payload with",
    "start": "400420",
    "end": "402930"
  },
  {
    "text": "friendlier software so because there is",
    "start": "402930",
    "end": "406030"
  },
  {
    "text": "that nice pause between the transmission",
    "start": "406030",
    "end": "409030"
  },
  {
    "text": "of the payload length and the",
    "start": "409030",
    "end": "409870"
  },
  {
    "text": "transmission of the payload Dave",
    "start": "409870",
    "end": "412090"
  },
  {
    "text": "Bowman's packets are gonna get there",
    "start": "412090",
    "end": "413620"
  },
  {
    "text": "first and Hal 9000 looks at those",
    "start": "413620",
    "end": "415960"
  },
  {
    "text": "packets see the sequence numbers are in",
    "start": "415960",
    "end": "417430"
  },
  {
    "text": "order this source and destination data",
    "start": "417430",
    "end": "419980"
  },
  {
    "text": "is in order",
    "start": "419980",
    "end": "420610"
  },
  {
    "text": "Hal just assumes that's probably part of",
    "start": "420610",
    "end": "422740"
  },
  {
    "text": "the TCP connection and when those actual",
    "start": "422740",
    "end": "425610"
  },
  {
    "text": "meterpreter payload packets come across",
    "start": "425610",
    "end": "427870"
  },
  {
    "text": "well those sequence numbers appear to be",
    "start": "427870",
    "end": "430590"
  },
  {
    "text": "retransmissions and that that software",
    "start": "430590",
    "end": "432610"
  },
  {
    "text": "gets ignored so when it comes time to",
    "start": "432610",
    "end": "434680"
  },
  {
    "text": "copy that data from the line over to the",
    "start": "434680",
    "end": "437080"
  },
  {
    "text": "chunk of memory for future execution its",
    "start": "437080",
    "end": "439480"
  },
  {
    "text": "dave software that gets run and not",
    "start": "439480",
    "end": "441490"
  },
  {
    "text": "meterpreter and by default the software",
    "start": "441490",
    "end": "444550"
  },
  {
    "text": "that we include is a simple reverse",
    "start": "444550",
    "end": "446470"
  },
  {
    "text": "shell so when it comes time to run that",
    "start": "446470",
    "end": "449290"
  },
  {
    "text": "client dave bowman gets a reverse shell",
    "start": "449290",
    "end": "451450"
  },
  {
    "start": "450000",
    "end": "489000"
  },
  {
    "text": "to further illustrate what we mean",
    "start": "451450",
    "end": "453130"
  },
  {
    "text": "here's a snippet of the configuration",
    "start": "453130",
    "end": "455080"
  },
  {
    "text": "file that we distribute by default and",
    "start": "455080",
    "end": "457240"
  },
  {
    "text": "you can see these trigger tags those",
    "start": "457240",
    "end": "459550"
  },
  {
    "text": "define the contents of that payload",
    "start": "459550",
    "end": "460990"
  },
  {
    "text": "length field the first four bytes are",
    "start": "460990",
    "end": "462880"
  },
  {
    "text": "the payload length now you might note",
    "start": "462880",
    "end": "464410"
  },
  {
    "text": "two trailing null bytes there those",
    "start": "464410",
    "end": "466720"
  },
  {
    "text": "exist because Windows sometimes does",
    "start": "466720",
    "end": "470400"
  },
  {
    "text": "padding because alignment is important",
    "start": "470400",
    "end": "472510"
  },
  {
    "text": "and we account for that here and the",
    "start": "472510",
    "end": "475060"
  },
  {
    "text": "response that's the data that we're",
    "start": "475060",
    "end": "476530"
  },
  {
    "text": "injecting into the tcp stream this is",
    "start": "476530",
    "end": "478870"
  },
  {
    "text": "shellcode its position independent code",
    "start": "478870",
    "end": "480520"
  },
  {
    "text": "it is a simple run-of-the-mill connect",
    "start": "480520",
    "end": "484180"
  },
  {
    "text": "back shell and the next slide is going",
    "start": "484180",
    "end": "487419"
  },
  {
    "text": "to show us what Dave Bowman is gonna see",
    "start": "487419",
    "end": "488770"
  },
  {
    "text": "and we crept out the console tags from",
    "start": "488770",
    "end": "491590"
  },
  {
    "start": "489000",
    "end": "512000"
  },
  {
    "text": "that configuration file that's Dave's IP",
    "start": "491590",
    "end": "493120"
  },
  {
    "text": "that's where that command and control",
    "start": "493120",
    "end": "495070"
  },
  {
    "text": "channel is going to be redirected and",
    "start": "495070",
    "end": "496450"
  },
  {
    "text": "Dave is running the sniffer in the",
    "start": "496450",
    "end": "497890"
  },
  {
    "text": "background and that netcat listener is",
    "start": "497890",
    "end": "500140"
  },
  {
    "text": "waiting for staging to occur Dave is",
    "start": "500140",
    "end": "502270"
  },
  {
    "text": "gonna get a shell as soon as staging",
    "start": "502270",
    "end": "503830"
  },
  {
    "text": "occurs and there it is Dave Bowman has a",
    "start": "503830",
    "end": "507340"
  },
  {
    "text": "shell on the Hal 9000 and the",
    "start": "507340",
    "end": "509500"
  },
  {
    "text": "meterpreter user has nothing and here is",
    "start": "509500",
    "end": "513940"
  },
  {
    "start": "512000",
    "end": "565000"
  },
  {
    "text": "what it looks like from the meterpreter",
    "start": "513940",
    "end": "514960"
  },
  {
    "text": "users point of view this is a Metasploit",
    "start": "514960",
    "end": "519450"
  },
  {
    "text": "console and just a simple Handler and",
    "start": "519450",
    "end": "522370"
  },
  {
    "text": "I'm gonna redirect your attention to the",
    "start": "522370",
    "end": "524770"
  },
  {
    "text": "last two lines of this of this terminal",
    "start": "524770",
    "end": "527920"
  },
  {
    "text": "and the second to last line is what the",
    "start": "527920",
    "end": "529810"
  },
  {
    "text": "user sees what the meterpreter user sees",
    "start": "529810",
    "end": "532060"
  },
  {
    "text": "when that payload length segment gets",
    "start": "532060",
    "end": "534130"
  },
  {
    "text": "transmitted and you can see the payload",
    "start": "534130",
    "end": "535420"
  },
  {
    "text": "length segment up there it's in base 10",
    "start": "535420",
    "end": "537280"
  },
  {
    "text": "and right after that you should note an",
    "start": "537280",
    "end": "539410"
  },
  {
    "text": "error message when we did our magic with",
    "start": "539410",
    "end": "541720"
  },
  {
    "text": "the packet spoofing in the sequence",
    "start": "541720",
    "end": "542950"
  },
  {
    "text": "numbers we kind of messed up that TCP",
    "start": "542950",
    "end": "545620"
  },
  {
    "text": "connection between the two nodes I like",
    "start": "545620",
    "end": "547990"
  },
  {
    "text": "that we could have written in Samaras",
    "start": "547990",
    "end": "549400"
  },
  {
    "text": "teaster we set that we set that TCP",
    "start": "549400",
    "end": "551709"
  },
  {
    "text": "connection but you know what I would",
    "start": "551709",
    "end": "553000"
  },
  {
    "text": "rather have our adversary here have an",
    "start": "553000",
    "end": "556030"
  },
  {
    "text": "error message have a broken TCP",
    "start": "556030",
    "end": "557440"
  },
  {
    "text": "connection instead of the meterpreter",
    "start": "557440",
    "end": "559510"
  },
  {
    "text": "prompt that presumably he wants but we",
    "start": "559510",
    "end": "563530"
  },
  {
    "text": "didn't stop there when you tell people",
    "start": "563530",
    "end": "566530"
  },
  {
    "start": "565000",
    "end": "592000"
  },
  {
    "text": "that you are targeting meterpreter for",
    "start": "566530",
    "end": "568360"
  },
  {
    "text": "men in the middle attacks a lot of",
    "start": "568360",
    "end": "569530"
  },
  {
    "text": "people will tell you that they have",
    "start": "569530",
    "end": "570790"
  },
  {
    "text": "moved on to PowerShell Empire PowerShell",
    "start": "570790",
    "end": "573070"
  },
  {
    "text": "Empire is really well designed it's it's",
    "start": "573070",
    "end": "578050"
  },
  {
    "text": "earned its fan base this is this is some",
    "start": "578050",
    "end": "579970"
  },
  {
    "text": "feature-rich software and there are two",
    "start": "579970",
    "end": "582100"
  },
  {
    "text": "currently supported branches of",
    "start": "582100",
    "end": "584050"
  },
  {
    "text": "PowerShell Empire there's version 1.6",
    "start": "584050",
    "end": "585790"
  },
  {
    "text": "and there was a version 2.0",
    "start": "585790",
    "end": "587110"
  },
  {
    "text": "they both do payload encryption or",
    "start": "587110",
    "end": "588760"
  },
  {
    "text": "obfuscation somewhat differently and",
    "start": "588760",
    "end": "590950"
  },
  {
    "text": "they're both vulnerable so when we did",
    "start": "590950",
    "end": "594339"
  },
  {
    "start": "592000",
    "end": "614000"
  },
  {
    "text": "the man-in-the-middle counter attack we",
    "start": "594339",
    "end": "596080"
  },
  {
    "text": "targeted the initial portions of staging",
    "start": "596080",
    "end": "597970"
  },
  {
    "text": "and you can see that here in this",
    "start": "597970",
    "end": "599320"
  },
  {
    "text": "graphic that we borrowed from PowerShell",
    "start": "599320",
    "end": "601690"
  },
  {
    "text": "empires website later on you can see",
    "start": "601690",
    "end": "604000"
  },
  {
    "text": "some really nice cryptographic features",
    "start": "604000",
    "end": "605500"
  },
  {
    "text": "there's public keys and private keys",
    "start": "605500",
    "end": "607000"
  },
  {
    "text": "there's diffie-hellman and AES and some",
    "start": "607000",
    "end": "610270"
  },
  {
    "text": "some really good stuff but we don't mess",
    "start": "610270",
    "end": "611890"
  },
  {
    "text": "with any of that we just hit him right",
    "start": "611890",
    "end": "613720"
  },
  {
    "text": "at the beginning and we broke down this",
    "start": "613720",
    "end": "615940"
  },
  {
    "start": "614000",
    "end": "832000"
  },
  {
    "text": "man in the middle counter attack into a",
    "start": "615940",
    "end": "618600"
  },
  {
    "text": "three step process and that first step",
    "start": "618600",
    "end": "621040"
  },
  {
    "text": "cross that first step happens right when",
    "start": "621040",
    "end": "624370"
  },
  {
    "text": "the Empire user tries to introduce the",
    "start": "624370",
    "end": "627339"
  },
  {
    "text": "PowerShell Empire software into a",
    "start": "627339",
    "end": "628959"
  },
  {
    "text": "compromised machine and if you've done",
    "start": "628959",
    "end": "630700"
  },
  {
    "text": "this in the real world you know that you",
    "start": "630700",
    "end": "632740"
  },
  {
    "text": "have to submit a command line that",
    "start": "632740",
    "end": "634600"
  },
  {
    "text": "starts with Power Cell that Xen includes",
    "start": "634600",
    "end": "636640"
  },
  {
    "text": "this crazy base64 blob of PowerShell",
    "start": "636640",
    "end": "640720"
  },
  {
    "text": "code and that code gets executed and",
    "start": "640720",
    "end": "642850"
  },
  {
    "text": "what that that script is one job what it",
    "start": "642850",
    "end": "645580"
  },
  {
    "text": "does is it goes out to the staging",
    "start": "645580",
    "end": "647500"
  },
  {
    "text": "server via via HTTP",
    "start": "647500",
    "end": "649990"
  },
  {
    "text": "downloads and encrypted or obfuscated",
    "start": "649990",
    "end": "652480"
  },
  {
    "text": "payload then decrypted or D off escapes",
    "start": "652480",
    "end": "655180"
  },
  {
    "text": "it using a shared secret using a",
    "start": "655180",
    "end": "658030"
  },
  {
    "text": "symmetric key and if is little and then",
    "start": "658030",
    "end": "661870"
  },
  {
    "text": "executes whatever it gets back there are",
    "start": "661870",
    "end": "664030"
  },
  {
    "text": "no check sums there's no integrity",
    "start": "664030",
    "end": "666820"
  },
  {
    "text": "checks no signatures and we take",
    "start": "666820",
    "end": "668590"
  },
  {
    "text": "advantage of that in step two so because",
    "start": "668590",
    "end": "671350"
  },
  {
    "text": "what 1.6 and 2.0 both handle their",
    "start": "671350",
    "end": "674260"
  },
  {
    "text": "payloads a little bit differently",
    "start": "674260",
    "end": "675340"
  },
  {
    "text": "we had to handle the payloads a little",
    "start": "675340",
    "end": "677500"
  },
  {
    "text": "bit differently in both cases we take a",
    "start": "677500",
    "end": "679510"
  },
  {
    "text": "live payload from the staging server and",
    "start": "679510",
    "end": "681760"
  },
  {
    "text": "then repackage it with our own software",
    "start": "681760",
    "end": "683260"
  },
  {
    "text": "for version 1.6 that payload is",
    "start": "683260",
    "end": "686470"
  },
  {
    "text": "obfuscated with zoar and the key is an",
    "start": "686470",
    "end": "691000"
  },
  {
    "text": "ASCII representation of a large",
    "start": "691000",
    "end": "692320"
  },
  {
    "text": "hexadecimal number and because the text",
    "start": "692320",
    "end": "694330"
  },
  {
    "text": "for any given offset within that key",
    "start": "694330",
    "end": "695890"
  },
  {
    "text": "there's only 16 possibilities there 0",
    "start": "695890",
    "end": "697900"
  },
  {
    "text": "through 9 and there's a through F kind",
    "start": "697900",
    "end": "699820"
  },
  {
    "text": "of limited and the payload itself is a",
    "start": "699820",
    "end": "703540"
  },
  {
    "text": "little predictable and by that I mean we",
    "start": "703540",
    "end": "707050"
  },
  {
    "text": "know it's a PowerShell script and with a",
    "start": "707050",
    "end": "708310"
  },
  {
    "text": "little bit of analysis we know what",
    "start": "708310",
    "end": "709540"
  },
  {
    "text": "characters are going to occur and we",
    "start": "709540",
    "end": "711250"
  },
  {
    "text": "know round about what the frequencies of",
    "start": "711250",
    "end": "712750"
  },
  {
    "text": "occurrence of those characters are so we",
    "start": "712750",
    "end": "714760"
  },
  {
    "text": "take that knowledge the the frequencies",
    "start": "714760",
    "end": "716680"
  },
  {
    "text": "of the characters and the limited key",
    "start": "716680",
    "end": "717970"
  },
  {
    "text": "space for the for the key and we do a",
    "start": "717970",
    "end": "720580"
  },
  {
    "text": "little bit of statistical analysis and",
    "start": "720580",
    "end": "722080"
  },
  {
    "text": "we extract the key from that obfuscated",
    "start": "722080",
    "end": "724600"
  },
  {
    "text": "payload a little bit counterintuitive",
    "start": "724600",
    "end": "726130"
  },
  {
    "text": "but it works really well once we have",
    "start": "726130",
    "end": "728140"
  },
  {
    "text": "that key we repackage it with our own",
    "start": "728140",
    "end": "730030"
  },
  {
    "text": "payload for version 2.0 the story's a",
    "start": "730030",
    "end": "732340"
  },
  {
    "text": "little bit more complicated because 2.0",
    "start": "732340",
    "end": "734530"
  },
  {
    "text": "uses rc4 for encryption and the nice",
    "start": "734530",
    "end": "737530"
  },
  {
    "text": "thing about RC 4 or the horrible thing",
    "start": "737530",
    "end": "739180"
  },
  {
    "text": "about RC 4 depending on your perspective",
    "start": "739180",
    "end": "740470"
  },
  {
    "text": "is that it is vulnerable to man in the",
    "start": "740470",
    "end": "742780"
  },
  {
    "text": "middle attacks specifically if you know",
    "start": "742780",
    "end": "745150"
  },
  {
    "text": "the contents of that plaintext you can",
    "start": "745150",
    "end": "747550"
  },
  {
    "text": "make that encrypted message say anything",
    "start": "747550",
    "end": "749230"
  },
  {
    "text": "you want it to say you can see and the",
    "start": "749230",
    "end": "752350"
  },
  {
    "text": "bullet points you can see how that",
    "start": "752350",
    "end": "753310"
  },
  {
    "text": "attack works this is a classic crypto",
    "start": "753310",
    "end": "756010"
  },
  {
    "text": "attack I wish I was the guy that",
    "start": "756010",
    "end": "757120"
  },
  {
    "text": "discovered it i wish i was showing you",
    "start": "757120",
    "end": "758380"
  },
  {
    "text": "something new but this classic attack",
    "start": "758380",
    "end": "759790"
  },
  {
    "text": "still works and that's a known that",
    "start": "759790",
    "end": "762670"
  },
  {
    "text": "plaintext is a known payload because",
    "start": "762670",
    "end": "764110"
  },
  {
    "text": "powershell Empire is open source",
    "start": "764110",
    "end": "765700"
  },
  {
    "text": "everybody has the source that's source",
    "start": "765700",
    "end": "767320"
  },
  {
    "text": "code in there we all have it and for for",
    "start": "767320",
    "end": "770740"
  },
  {
    "text": "either version weari package that we",
    "start": "770740",
    "end": "772540"
  },
  {
    "text": "repackage the software that the user",
    "start": "772540",
    "end": "774280"
  },
  {
    "text": "wants stage 2 to be and we repackage it",
    "start": "774280",
    "end": "777040"
  },
  {
    "text": "as our own and then we use a",
    "start": "777040",
    "end": "778450"
  },
  {
    "text": "man-in-the-middle",
    "start": "778450",
    "end": "779980"
  },
  {
    "text": "Paquette spoofing attack like what you",
    "start": "779980",
    "end": "781450"
  },
  {
    "text": "saw earlier with Dave Bowen and the Hal",
    "start": "781450",
    "end": "782830"
  },
  {
    "text": "9000 to overwrite their responses from",
    "start": "782830",
    "end": "785260"
  },
  {
    "text": "the server so when that basic ste four",
    "start": "785260",
    "end": "788050"
  },
  {
    "text": "encoded script reaches out to the",
    "start": "788050",
    "end": "789490"
  },
  {
    "text": "staging server to try to get the next",
    "start": "789490",
    "end": "791950"
  },
  {
    "text": "stage script it will end up getting our",
    "start": "791950",
    "end": "794170"
  },
  {
    "text": "software because we override it on the",
    "start": "794170",
    "end": "795730"
  },
  {
    "text": "line and this is what it looks like from",
    "start": "795730",
    "end": "798790"
  },
  {
    "text": "our point of view the software is",
    "start": "798790",
    "end": "801160"
  },
  {
    "text": "somewhat flexible and it lets you define",
    "start": "801160",
    "end": "803200"
  },
  {
    "text": "what software you want to run on the",
    "start": "803200",
    "end": "804640"
  },
  {
    "text": "compromised machine today because it's a",
    "start": "804640",
    "end": "807100"
  },
  {
    "text": "proof of concept we're gonna launch Cal",
    "start": "807100",
    "end": "808810"
  },
  {
    "text": "that XE because that's what proof of",
    "start": "808810",
    "end": "810070"
  },
  {
    "text": "concepts do by default the software that",
    "start": "810070",
    "end": "814120"
  },
  {
    "text": "that it stems along is a reverse shell",
    "start": "814120",
    "end": "815980"
  },
  {
    "text": "but you know calc that actually it's a",
    "start": "815980",
    "end": "818350"
  },
  {
    "text": "proof of concept so in the command line",
    "start": "818350",
    "end": "820990"
  },
  {
    "text": "here you see that we are reaching out to",
    "start": "820990",
    "end": "822490"
  },
  {
    "text": "the staging server via HTTP there's",
    "start": "822490",
    "end": "825880"
  },
  {
    "text": "other ways you could do this you could",
    "start": "825880",
    "end": "826870"
  },
  {
    "text": "sniff that payload you could get it",
    "start": "826870",
    "end": "828490"
  },
  {
    "text": "through your proxy logs we chose HTTP",
    "start": "828490",
    "end": "830080"
  },
  {
    "text": "there's other ways to do it and here's",
    "start": "830080",
    "end": "832990"
  },
  {
    "start": "832000",
    "end": "856000"
  },
  {
    "text": "what it looks like from the attackers",
    "start": "832990",
    "end": "834520"
  },
  {
    "text": "point of view this attacker sends the",
    "start": "834520",
    "end": "837040"
  },
  {
    "text": "PowerShell staging command and",
    "start": "837040",
    "end": "838390"
  },
  {
    "text": "PowerShell does not staged this this",
    "start": "838390",
    "end": "840730"
  },
  {
    "text": "user gets cal that XE we should note at",
    "start": "840730",
    "end": "842830"
  },
  {
    "text": "this point that it is a little bit",
    "start": "842830",
    "end": "844960"
  },
  {
    "text": "abnormal in practice to launch a",
    "start": "844960",
    "end": "847830"
  },
  {
    "text": "PowerShell Empire from a GUI you don't",
    "start": "847830",
    "end": "850450"
  },
  {
    "text": "normally get to do that but you know",
    "start": "850450",
    "end": "852430"
  },
  {
    "text": "what I wanted to show you guys calcloud",
    "start": "852430",
    "end": "853780"
  },
  {
    "text": "XE we didn't stop there though there",
    "start": "853780",
    "end": "857110"
  },
  {
    "start": "856000",
    "end": "914000"
  },
  {
    "text": "were a couple other software packages",
    "start": "857110",
    "end": "858610"
  },
  {
    "text": "that I think deserve a mention in",
    "start": "858610",
    "end": "859810"
  },
  {
    "text": "particular of fuzz bunch which is which",
    "start": "859810",
    "end": "863320"
  },
  {
    "text": "includes the double pulsar module this",
    "start": "863320",
    "end": "865720"
  },
  {
    "text": "is part of the shadow brokers dump the",
    "start": "865720",
    "end": "867430"
  },
  {
    "text": "shadow brokers leaked some software that",
    "start": "867430",
    "end": "870460"
  },
  {
    "text": "was developed to buy and/or for one of",
    "start": "870460",
    "end": "872260"
  },
  {
    "text": "these three government agencies and I'm",
    "start": "872260",
    "end": "873580"
  },
  {
    "text": "not going to speculate which one and the",
    "start": "873580",
    "end": "876910"
  },
  {
    "text": "people covers up to really some really",
    "start": "876910",
    "end": "878140"
  },
  {
    "text": "in-depth analysis of that software and",
    "start": "878140",
    "end": "880360"
  },
  {
    "text": "as it turns out double pulsar is very",
    "start": "880360",
    "end": "882820"
  },
  {
    "text": "easy to detect on the line there are",
    "start": "882820",
    "end": "886200"
  },
  {
    "text": "snort rules that can detect it it uses",
    "start": "886200",
    "end": "889210"
  },
  {
    "text": "or for encryption exposes the key in",
    "start": "889210",
    "end": "891520"
  },
  {
    "text": "plaintext and to make matters worse",
    "start": "891520",
    "end": "894490"
  },
  {
    "text": "double parse that pulsar does not really",
    "start": "894490",
    "end": "895960"
  },
  {
    "text": "have adequate authentication once you've",
    "start": "895960",
    "end": "897420"
  },
  {
    "text": "introduced it on to somebody's computer",
    "start": "897420",
    "end": "899530"
  },
  {
    "text": "so if you ever detect double pulsar",
    "start": "899530",
    "end": "901360"
  },
  {
    "text": "running feel free to pull fire up your",
    "start": "901360",
    "end": "903880"
  },
  {
    "text": "own double pulse our client and follow",
    "start": "903880",
    "end": "905410"
  },
  {
    "text": "that guy in because there's nothing",
    "start": "905410",
    "end": "906520"
  },
  {
    "text": "gonna stop you even if you don't have",
    "start": "906520",
    "end": "908650"
  },
  {
    "text": "the exploit",
    "start": "908650",
    "end": "910790"
  },
  {
    "text": "this is not safe don't use it especially",
    "start": "910790",
    "end": "913370"
  },
  {
    "text": "if you're a pen tester just say no on",
    "start": "913370",
    "end": "915590"
  },
  {
    "start": "914000",
    "end": "935000"
  },
  {
    "text": "the other under other end of that",
    "start": "915590",
    "end": "917330"
  },
  {
    "text": "spectrum is cobalt strike which has",
    "start": "917330",
    "end": "919220"
  },
  {
    "text": "several staging and even some stages",
    "start": "919220",
    "end": "921200"
  },
  {
    "text": "options there are data integrity checks",
    "start": "921200",
    "end": "923690"
  },
  {
    "text": "and to their credit Rafael much put out",
    "start": "923690",
    "end": "925700"
  },
  {
    "text": "a blog post that talks about these",
    "start": "925700",
    "end": "927710"
  },
  {
    "text": "issues in depth and we don't have time",
    "start": "927710",
    "end": "930140"
  },
  {
    "text": "to go into it today but if you're cold",
    "start": "930140",
    "end": "931580"
  },
  {
    "text": "strike user I strongly recommend you",
    "start": "931580",
    "end": "933790"
  },
  {
    "text": "RTFM in the meantime let's talk about",
    "start": "933790",
    "end": "936680"
  },
  {
    "start": "935000",
    "end": "964000"
  },
  {
    "text": "the switch gears and let's talk about",
    "start": "936680",
    "end": "938320"
  },
  {
    "text": "password cracking and what you can do",
    "start": "938320",
    "end": "940160"
  },
  {
    "text": "about it so password cracking is",
    "start": "940160",
    "end": "942290"
  },
  {
    "text": "computationally intensive and you can",
    "start": "942290",
    "end": "944000"
  },
  {
    "text": "see a really nice password cracking",
    "start": "944000",
    "end": "946160"
  },
  {
    "text": "array that this picture was donated by",
    "start": "946160",
    "end": "948770"
  },
  {
    "text": "my colleague Matt wagon Connect and Matt",
    "start": "948770",
    "end": "950510"
  },
  {
    "text": "wants to crack passwords he throws his",
    "start": "950510",
    "end": "952520"
  },
  {
    "text": "password hashes into this array of high",
    "start": "952520",
    "end": "955610"
  },
  {
    "text": "end GPU enabled graphics cars and they",
    "start": "955610",
    "end": "958130"
  },
  {
    "text": "crunch on these passwords this is",
    "start": "958130",
    "end": "959390"
  },
  {
    "text": "computationally intensive even the power",
    "start": "959390",
    "end": "961220"
  },
  {
    "text": "consumption if you're doing this",
    "start": "961220",
    "end": "962210"
  },
  {
    "text": "seriously is noteworthy and we're gonna",
    "start": "962210",
    "end": "963890"
  },
  {
    "text": "make it harder today so we took on",
    "start": "963890",
    "end": "966350"
  },
  {
    "start": "964000",
    "end": "990000"
  },
  {
    "text": "element RNN being a spoofing attacks",
    "start": "966350",
    "end": "968090"
  },
  {
    "text": "these attacks are really effective and",
    "start": "968090",
    "end": "970160"
  },
  {
    "text": "really popular this is what pen testers",
    "start": "970160",
    "end": "972140"
  },
  {
    "text": "typically do on a Monday morning when",
    "start": "972140",
    "end": "973460"
  },
  {
    "text": "they show up on site these attacks are",
    "start": "973460",
    "end": "977270"
  },
  {
    "text": "really effective with a little bit of",
    "start": "977270",
    "end": "979430"
  },
  {
    "text": "luck not even that much luck the pen",
    "start": "979430",
    "end": "980600"
  },
  {
    "text": "tester might even have domain admin by",
    "start": "980600",
    "end": "982370"
  },
  {
    "text": "lunchtime lurid caffee's responder",
    "start": "982370",
    "end": "984290"
  },
  {
    "text": "script made this attack popular we can",
    "start": "984290",
    "end": "987020"
  },
  {
    "text": "detect it we can disrupt it responder is",
    "start": "987020",
    "end": "989690"
  },
  {
    "text": "a great piece of software but here we go",
    "start": "989690",
    "end": "992450"
  },
  {
    "start": "990000",
    "end": "1044000"
  },
  {
    "text": "in order to understand what we're doing",
    "start": "992450",
    "end": "993710"
  },
  {
    "text": "here is a diagram that explains how the",
    "start": "993710",
    "end": "995330"
  },
  {
    "text": "attack works this sad machine here in",
    "start": "995330",
    "end": "997700"
  },
  {
    "text": "the in the center of all these blue",
    "start": "997700",
    "end": "999230"
  },
  {
    "text": "arrows is a typically misconfigured",
    "start": "999230",
    "end": "1000700"
  },
  {
    "text": "Microsoft Windows machine and when it",
    "start": "1000700",
    "end": "1003130"
  },
  {
    "text": "wants to do name resolution the first",
    "start": "1003130",
    "end": "1004360"
  },
  {
    "text": "thing it does is DNS and if DNS fails it",
    "start": "1004360",
    "end": "1007060"
  },
  {
    "text": "sends out these broadcast UDP packets",
    "start": "1007060",
    "end": "1009040"
  },
  {
    "text": "via NBN s and an element R and it asks",
    "start": "1009040",
    "end": "1011440"
  },
  {
    "text": "everyone on and on the network hey are",
    "start": "1011440",
    "end": "1012820"
  },
  {
    "text": "you this machine and the evil guy here",
    "start": "1012820",
    "end": "1016660"
  },
  {
    "text": "when he gets these queries he responds",
    "start": "1016660",
    "end": "1020080"
  },
  {
    "text": "back universally and says yes I am that",
    "start": "1020080",
    "end": "1023050"
  },
  {
    "text": "user and the bad guy is hoping the other",
    "start": "1023050",
    "end": "1025209"
  },
  {
    "text": "side of this diagram happens the bad guy",
    "start": "1025210",
    "end": "1026650"
  },
  {
    "text": "hopes that the misconfigured Microsoft",
    "start": "1026650",
    "end": "1028240"
  },
  {
    "text": "Windows machine will connect to it on",
    "start": "1028240",
    "end": "1031660"
  },
  {
    "text": "some supported protocol and with a",
    "start": "1031660",
    "end": "1033819"
  },
  {
    "text": "little bit of luck exposed a plaintext",
    "start": "1033820",
    "end": "1035140"
  },
  {
    "text": "password with slightly less luck the bad",
    "start": "1035140",
    "end": "1037510"
  },
  {
    "text": "guy is hoping to use the ntlm to induce",
    "start": "1037510",
    "end": "1040030"
  },
  {
    "text": "that misconfigured machine to send",
    "start": "1040030",
    "end": "1042390"
  },
  {
    "text": "password hash and this is our response",
    "start": "1042390",
    "end": "1045240"
  },
  {
    "start": "1044000",
    "end": "1077000"
  },
  {
    "text": "so just with just as with the the",
    "start": "1045240",
    "end": "1049679"
  },
  {
    "text": "typically misconfigured Microsoft",
    "start": "1049679",
    "end": "1050820"
  },
  {
    "text": "Windows machine we also send out and DNS",
    "start": "1050820",
    "end": "1052620"
  },
  {
    "text": "in the element our queries the",
    "start": "1052620",
    "end": "1054240"
  },
  {
    "text": "difference being we're not actually",
    "start": "1054240",
    "end": "1055559"
  },
  {
    "text": "looking for another machine our queries",
    "start": "1055559",
    "end": "1057660"
  },
  {
    "text": "are from machine names that are sixteen",
    "start": "1057660",
    "end": "1059070"
  },
  {
    "text": "to twenty bytes in length of random",
    "start": "1059070",
    "end": "1060600"
  },
  {
    "text": "characters and anybody responds to that",
    "start": "1060600",
    "end": "1062640"
  },
  {
    "text": "and says yes that pile of garbage is in",
    "start": "1062640",
    "end": "1064950"
  },
  {
    "text": "fact my machine name we consider that we",
    "start": "1064950",
    "end": "1066660"
  },
  {
    "text": "consider that entity to be hostile and",
    "start": "1066660",
    "end": "1068760"
  },
  {
    "text": "because that entity is looking for",
    "start": "1068760",
    "end": "1070920"
  },
  {
    "text": "password hashes we sent password hashes",
    "start": "1070920",
    "end": "1073380"
  },
  {
    "text": "we also log the alert so we go beyond",
    "start": "1073380",
    "end": "1075480"
  },
  {
    "text": "logging we actually do something about",
    "start": "1075480",
    "end": "1076710"
  },
  {
    "text": "the attack and here's what it looks like",
    "start": "1076710",
    "end": "1079110"
  },
  {
    "start": "1077000",
    "end": "1109000"
  },
  {
    "text": "from the defenders point of view this",
    "start": "1079110",
    "end": "1081390"
  },
  {
    "text": "command line it takes users usernames",
    "start": "1081390",
    "end": "1084870"
  },
  {
    "text": "and passwords from that username text",
    "start": "1084870",
    "end": "1086429"
  },
  {
    "text": "file presumably these are fake usernames",
    "start": "1086429",
    "end": "1088410"
  },
  {
    "text": "and passwords however people talk to me",
    "start": "1088410",
    "end": "1090720"
  },
  {
    "text": "about canary accounts and using that as",
    "start": "1090720",
    "end": "1092520"
  },
  {
    "text": "a means of detecting relay attacks if",
    "start": "1092520",
    "end": "1094080"
  },
  {
    "text": "you're worried about that and we send",
    "start": "1094080",
    "end": "1097309"
  },
  {
    "text": "credentials hashed credentials from that",
    "start": "1097309",
    "end": "1099809"
  },
  {
    "text": "from that list and we logged the alert",
    "start": "1099809",
    "end": "1102059"
  },
  {
    "text": "and we look for these bad guys every ten",
    "start": "1102059",
    "end": "1104010"
  },
  {
    "text": "seconds and it's a little bit more",
    "start": "1104010",
    "end": "1105809"
  },
  {
    "text": "exciting from the responder users point",
    "start": "1105809",
    "end": "1107760"
  },
  {
    "text": "of view here's responder and there we go",
    "start": "1107760",
    "end": "1112650"
  },
  {
    "start": "1109000",
    "end": "1139000"
  },
  {
    "text": "the bad guy just got a password hash",
    "start": "1112650",
    "end": "1114540"
  },
  {
    "text": "from Dennis Ritchie earlier the bad guy",
    "start": "1114540",
    "end": "1116190"
  },
  {
    "text": "get a password hash from Grace Hopper if",
    "start": "1116190",
    "end": "1117870"
  },
  {
    "text": "we wait long enough we'll see a network",
    "start": "1117870",
    "end": "1119580"
  },
  {
    "text": "guy perhaps that's Jon Postel",
    "start": "1119580",
    "end": "1121340"
  },
  {
    "text": "sadly everybody have this name checked",
    "start": "1121340",
    "end": "1123570"
  },
  {
    "text": "right there is passed has passed away so",
    "start": "1123570",
    "end": "1126330"
  },
  {
    "text": "it is unlikely that any of them are",
    "start": "1126330",
    "end": "1127559"
  },
  {
    "text": "going to be using ntlm or any network",
    "start": "1127559",
    "end": "1129840"
  },
  {
    "text": "based services at all again these are",
    "start": "1129840",
    "end": "1131640"
  },
  {
    "text": "these are fake accounts and we are",
    "start": "1131640",
    "end": "1133500"
  },
  {
    "text": "hoping that the attacker jumps on to the",
    "start": "1133500",
    "end": "1136340"
  },
  {
    "text": "hamster wheel that we've just",
    "start": "1136340",
    "end": "1137880"
  },
  {
    "text": "constructed and again the software is",
    "start": "1137880",
    "end": "1140580"
  },
  {
    "start": "1139000",
    "end": "1165000"
  },
  {
    "text": "designed to work around your strategies",
    "start": "1140580",
    "end": "1142470"
  },
  {
    "text": "so if you want to be a little bit more",
    "start": "1142470",
    "end": "1143549"
  },
  {
    "text": "aggressive we include a resource",
    "start": "1143549",
    "end": "1146130"
  },
  {
    "text": "exhaustion attack so this bad guy want",
    "start": "1146130",
    "end": "1148440"
  },
  {
    "text": "some hashes let's send them some hashes",
    "start": "1148440",
    "end": "1150000"
  },
  {
    "text": "if the bad guy walks away from the",
    "start": "1150000",
    "end": "1151679"
  },
  {
    "text": "console yeah the bad guy walks away from",
    "start": "1151679",
    "end": "1155610"
  },
  {
    "text": "the console the bad guy comes back that",
    "start": "1155610",
    "end": "1157290"
  },
  {
    "text": "hard drives filled up that database of",
    "start": "1157290",
    "end": "1160350"
  },
  {
    "text": "hashes is somewhat corrupt it's a bad",
    "start": "1160350",
    "end": "1162570"
  },
  {
    "text": "day for the bad guy and we also took on",
    "start": "1162570",
    "end": "1166549"
  },
  {
    "start": "1165000",
    "end": "1173000"
  },
  {
    "text": "wpa2 attacks designed to steal that",
    "start": "1166549",
    "end": "1169110"
  },
  {
    "text": "appreciated key that where this password",
    "start": "1169110",
    "end": "1170669"
  },
  {
    "text": "and in order to understand how that",
    "start": "1170669",
    "end": "1172860"
  },
  {
    "text": "attack works we need a little bit of it",
    "start": "1172860",
    "end": "1174690"
  },
  {
    "start": "1173000",
    "end": "1232000"
  },
  {
    "text": "of the handshaking process that happens",
    "start": "1174690",
    "end": "1178020"
  },
  {
    "text": "when you want to join a wireless network",
    "start": "1178020",
    "end": "1179220"
  },
  {
    "text": "the STA in this diagram is the node that",
    "start": "1179220",
    "end": "1182070"
  },
  {
    "text": "wants to join the network so if you",
    "start": "1182070",
    "end": "1183330"
  },
  {
    "text": "imagine a cell phone or a laptop that",
    "start": "1183330",
    "end": "1188070"
  },
  {
    "text": "wants to join the network the AP is the",
    "start": "1188070",
    "end": "1190050"
  },
  {
    "text": "access point where this router or",
    "start": "1190050",
    "end": "1191220"
  },
  {
    "text": "whatever controls that wireless network",
    "start": "1191220",
    "end": "1192270"
  },
  {
    "text": "and you can see in between them there is",
    "start": "1192270",
    "end": "1194190"
  },
  {
    "text": "a four-way handshake that happens and",
    "start": "1194190",
    "end": "1196500"
  },
  {
    "text": "that four Way handshake involves both",
    "start": "1196500",
    "end": "1198090"
  },
  {
    "text": "ends generating a nonce and those nonces",
    "start": "1198090",
    "end": "1200340"
  },
  {
    "text": "are used together with the actual",
    "start": "1200340",
    "end": "1201750"
  },
  {
    "text": "pre-shared key to construct a message",
    "start": "1201750",
    "end": "1203790"
  },
  {
    "text": "identification code or Mik which is",
    "start": "1203790",
    "end": "1205650"
  },
  {
    "text": "ostensibly a hash of that pre shared key",
    "start": "1205650",
    "end": "1207420"
  },
  {
    "text": "and the attacker software real world",
    "start": "1207420",
    "end": "1210480"
  },
  {
    "text": "when they're doing this the attacker is",
    "start": "1210480",
    "end": "1212460"
  },
  {
    "text": "going to sniff packets from a lot of",
    "start": "1212460",
    "end": "1214440"
  },
  {
    "text": "different networks and they're all",
    "start": "1214440",
    "end": "1215220"
  },
  {
    "text": "differentiated by looking at the bssid",
    "start": "1215220",
    "end": "1217650"
  },
  {
    "text": "or MAC address of those APs so what we",
    "start": "1217650",
    "end": "1220050"
  },
  {
    "text": "do is we mimic this authentication",
    "start": "1220050",
    "end": "1222450"
  },
  {
    "text": "process we do packet spoofing to send",
    "start": "1222450",
    "end": "1225630"
  },
  {
    "text": "out fake handshakes with the same MAC",
    "start": "1225630",
    "end": "1228540"
  },
  {
    "text": "address of that ap and fake passwords so",
    "start": "1228540",
    "end": "1231720"
  },
  {
    "text": "we frustrated password cracking from",
    "start": "1231720",
    "end": "1233820"
  },
  {
    "start": "1232000",
    "end": "1267000"
  },
  {
    "text": "that perspective and I know a lot of",
    "start": "1233820",
    "end": "1237120"
  },
  {
    "text": "people test out where else security",
    "start": "1237120",
    "end": "1238470"
  },
  {
    "text": "tools on their on their neighbors",
    "start": "1238470",
    "end": "1240000"
  },
  {
    "text": "networks and I'm not naming names but",
    "start": "1240000",
    "end": "1243090"
  },
  {
    "text": "today we are going I do this at home and",
    "start": "1243090",
    "end": "1245490"
  },
  {
    "text": "we're going to defend my neighbors",
    "start": "1245490",
    "end": "1247110"
  },
  {
    "text": "network I don't know mr. Garcia if you",
    "start": "1247110",
    "end": "1249420"
  },
  {
    "text": "ever see this mr. Garcia thank you for",
    "start": "1249420",
    "end": "1250890"
  },
  {
    "text": "allowing me to defend your network and",
    "start": "1250890",
    "end": "1254330"
  },
  {
    "text": "this defense is actually really really",
    "start": "1254330",
    "end": "1256530"
  },
  {
    "text": "passive so mr. Garcia can go ahead and",
    "start": "1256530",
    "end": "1258330"
  },
  {
    "text": "watch this videos on on YouTube he never",
    "start": "1258330",
    "end": "1260310"
  },
  {
    "text": "knew where this happened and I don't",
    "start": "1260310",
    "end": "1262320"
  },
  {
    "text": "know mr. Garcia's password so we're",
    "start": "1262320",
    "end": "1263550"
  },
  {
    "text": "gonna use a fake password a fake",
    "start": "1263550",
    "end": "1264720"
  },
  {
    "text": "password and this bad guy is going to",
    "start": "1264720",
    "end": "1266820"
  },
  {
    "text": "use arrow dump a pretty common tool for",
    "start": "1266820",
    "end": "1268620"
  },
  {
    "start": "1267000",
    "end": "1290000"
  },
  {
    "text": "this and he's gonna topic it mr. Garcia",
    "start": "1268620",
    "end": "1271020"
  },
  {
    "text": "and anybody who's done this attack real",
    "start": "1271020",
    "end": "1273900"
  },
  {
    "text": "world knows that there's a lot of",
    "start": "1273900",
    "end": "1274950"
  },
  {
    "text": "waiting there are deaaath attacks if",
    "start": "1274950",
    "end": "1276630"
  },
  {
    "text": "these handshakes don't happen on your on",
    "start": "1276630",
    "end": "1278700"
  },
  {
    "text": "your schedule but uh even then those do",
    "start": "1278700",
    "end": "1281340"
  },
  {
    "text": "auth attacks aren't necessarily easy now",
    "start": "1281340",
    "end": "1283440"
  },
  {
    "text": "we just got a we got a handshake and the",
    "start": "1283440",
    "end": "1287520"
  },
  {
    "text": "bad guys gonna try to crack that",
    "start": "1287520",
    "end": "1288630"
  },
  {
    "text": "password you see there we go the bad guy",
    "start": "1288630",
    "end": "1292620"
  },
  {
    "text": "got the fake password a fake password",
    "start": "1292620",
    "end": "1294180"
  },
  {
    "text": "whatever mr. Garcia's real password is",
    "start": "1294180",
    "end": "1296310"
  },
  {
    "text": "the bad guy's gonna have to go back to",
    "start": "1296310",
    "end": "1298080"
  },
  {
    "text": "square one and try to get it again the",
    "start": "1298080",
    "end": "1301380"
  },
  {
    "text": "bad guy just have to do a lot more",
    "start": "1301380",
    "end": "1302340"
  },
  {
    "text": "waiting and if you imagine you put in",
    "start": "1302340",
    "end": "1304260"
  },
  {
    "text": "for fake handshakes and the bad guy gets",
    "start": "1304260",
    "end": "1306690"
  },
  {
    "text": "lucky gets one real handshake",
    "start": "1306690",
    "end": "1308850"
  },
  {
    "text": "the bad guy either has to figure out how",
    "start": "1308850",
    "end": "1310440"
  },
  {
    "text": "to tell the difference between the",
    "start": "1310440",
    "end": "1311730"
  },
  {
    "text": "handshakes or crack them all and if the",
    "start": "1311730",
    "end": "1314610"
  },
  {
    "text": "bad guys uses to correct them all you've",
    "start": "1314610",
    "end": "1316050"
  },
  {
    "text": "just degraded their cracking",
    "start": "1316050",
    "end": "1317540"
  },
  {
    "text": "capabilities by about 80% and as you can",
    "start": "1317540",
    "end": "1320850"
  },
  {
    "text": "see I was only able to crack about ass",
    "start": "1320850",
    "end": "1322380"
  },
  {
    "text": "out I was only able to crack it about a",
    "start": "1322380",
    "end": "1324930"
  },
  {
    "text": "thousand guesses per second that is",
    "start": "1324930",
    "end": "1326250"
  },
  {
    "text": "really slow so we've made it harder to",
    "start": "1326250",
    "end": "1328440"
  },
  {
    "text": "steal Wi-Fi passwords and we did it on",
    "start": "1328440",
    "end": "1330780"
  },
  {
    "text": "the cheap without really disturbing mr.",
    "start": "1330780",
    "end": "1333570"
  },
  {
    "start": "1333000",
    "end": "1364000"
  },
  {
    "text": "Garcia so we intend to continue this",
    "start": "1333570",
    "end": "1335550"
  },
  {
    "text": "project into the future there's areas we",
    "start": "1335550",
    "end": "1337740"
  },
  {
    "text": "can we can keep going we can integrate",
    "start": "1337740",
    "end": "1340440"
  },
  {
    "text": "the wireless defenses with open wrt or",
    "start": "1340440",
    "end": "1343110"
  },
  {
    "text": "other available access point software",
    "start": "1343110",
    "end": "1345320"
  },
  {
    "text": "existing security technologies",
    "start": "1345320",
    "end": "1347160"
  },
  {
    "text": "especially IDs as an IPS as you can",
    "start": "1347160",
    "end": "1348840"
  },
  {
    "text": "definitely put this in there it was",
    "start": "1348840",
    "end": "1351450"
  },
  {
    "text": "designed for that proxies if you have a",
    "start": "1351450",
    "end": "1353160"
  },
  {
    "text": "smart proxy we can make it smarter in",
    "start": "1353160",
    "end": "1355500"
  },
  {
    "text": "the future of the future tools we want",
    "start": "1355500",
    "end": "1357660"
  },
  {
    "text": "to target whatever the cool new tool is",
    "start": "1357660",
    "end": "1359400"
  },
  {
    "text": "the people are using to break into into",
    "start": "1359400",
    "end": "1361050"
  },
  {
    "text": "computers that's what we want to go",
    "start": "1361050",
    "end": "1363000"
  },
  {
    "text": "after so if you want these tools at home",
    "start": "1363000",
    "end": "1366270"
  },
  {
    "start": "1364000",
    "end": "1388000"
  },
  {
    "text": "if you want to try this at home there's",
    "start": "1366270",
    "end": "1367890"
  },
  {
    "text": "a there's the github for the shallot",
    "start": "1367890",
    "end": "1369390"
  },
  {
    "text": "project so this is the C cloak 8 destroy",
    "start": "1369390",
    "end": "1371430"
  },
  {
    "text": "tool kit otherwise known as the salad",
    "start": "1371430",
    "end": "1372840"
  },
  {
    "text": "project if you want to reach out to me",
    "start": "1372840",
    "end": "1374970"
  },
  {
    "text": "if you're curious or if you don't want",
    "start": "1374970",
    "end": "1377220"
  },
  {
    "text": "to see how this is going here's my",
    "start": "1377220",
    "end": "1379260"
  },
  {
    "text": "Twitter handle Johnny Ventura and thank",
    "start": "1379260",
    "end": "1381720"
  },
  {
    "text": "you for your time today",
    "start": "1381720",
    "end": "1384289"
  }
]