[
  {
    "text": "hello so today we are going to be talking about obtaining data from locked iOS devices through monitoring input and",
    "start": "2919",
    "end": "10280"
  },
  {
    "text": "output along with CIS log so I am Nicholas duah I am a digital",
    "start": "10280",
    "end": "16278"
  },
  {
    "text": "forensics examiner and researcher at hex sordia previously I've spoken at a few conferences about various forensics and",
    "start": "16279",
    "end": "23320"
  },
  {
    "text": "malware research along with cyber security in schools hi I'm Jessica uh I'm the owner",
    "start": "23320",
    "end": "29480"
  },
  {
    "text": "and founder of tordia we kind of do a lot of digital forensics Research",
    "start": "29480",
    "end": "34520"
  },
  {
    "text": "Services training uh before this I worked in a variety of labs both on the commercial side the intelligence",
    "start": "34520",
    "end": "41120"
  },
  {
    "text": "Community uh as a contractor as well as some Le adjacent stuff I also teach",
    "start": "41120",
    "end": "46879"
  },
  {
    "text": "mobile device forensics at George Mason University and I volunteer with a couple of different organizations for the",
    "start": "46879",
    "end": "53399"
  },
  {
    "text": "community so let's get into it so the current state of iOS forensics is really",
    "start": "53399",
    "end": "59600"
  },
  {
    "text": "going to be about what kind of Acquisitions you can get can you get the full file system or can you just get a",
    "start": "59600",
    "end": "66479"
  },
  {
    "text": "logical acquisition the full file system Acquisitions currently are going to require an exploit either you're going",
    "start": "66479",
    "end": "74040"
  },
  {
    "text": "to have a device that you've been able to jailbreak and hopefully not reset and get rid of all the data or you're going",
    "start": "74040",
    "end": "80200"
  },
  {
    "text": "to have a device where you're using a commercial exploit many of those commercial exploits that allow you to access these devices without pins are",
    "start": "80200",
    "end": "87200"
  },
  {
    "text": "only available to law enforcement and only in certain countries uh and there are some commercial solutions that are",
    "start": "87200",
    "end": "93720"
  },
  {
    "text": "limited in scope providing you know the password without an exploit you're",
    "start": "93720",
    "end": "99159"
  },
  {
    "text": "really going to be limited to some kind of logical acquisition that may be very",
    "start": "99159",
    "end": "104280"
  },
  {
    "text": "similar to an iTunes backup uh and if you have no passcode uh and the PC even",
    "start": "104280",
    "end": "110920"
  },
  {
    "text": "if it's paired you're still going to have a limited amount of data so full",
    "start": "110920",
    "end": "116119"
  },
  {
    "text": "file system Acquisitions are like the gold standard right now for iOS forensics thanks to a lot of the advents",
    "start": "116119",
    "end": "123680"
  },
  {
    "text": "of jailbreaks and the jailbreak Community as well as some of the commercial Solutions we're really seeing a lot of that but there is a mix match",
    "start": "123680",
    "end": "131840"
  },
  {
    "text": "between what is supported based on hardware and operating system version meaning if you get a newer device you",
    "start": "131840",
    "end": "137879"
  },
  {
    "text": "may not be able to exploit it depending on that mix from a jail pre perspective",
    "start": "137879",
    "end": "143319"
  },
  {
    "text": "there's a dramatic difference between if you're dealing with the a12 and up chip in the iPhone XR and newer or or if",
    "start": "143319",
    "end": "150040"
  },
  {
    "text": "you're dealing with the older devices that are iPhone x and Below basically if you have a vulnerable iOS version",
    "start": "150040",
    "end": "157360"
  },
  {
    "text": "because of the version matters too and a vulnerable Hardware chip to some of those exploits you can get that data but",
    "start": "157360",
    "end": "163440"
  },
  {
    "text": "without it you're pretty limited and to be honest if you don't have a passcode you're very limited because even on a",
    "start": "163440",
    "end": "170440"
  },
  {
    "text": "logical acquisition side you really need that trusted PC and you're still going",
    "start": "170440",
    "end": "175519"
  },
  {
    "text": "to be limited to iTunes but if you don't have trust uh trust is established either by having the passcode or having",
    "start": "175519",
    "end": "181959"
  },
  {
    "text": "a pairing record and we'll talk about that more you're going to be limited to querying Siri which by the way may or",
    "start": "181959",
    "end": "188080"
  },
  {
    "text": "may not work sometimes Siri actually learns its user and no longer will result to other people but actually",
    "start": "188080",
    "end": "193879"
  },
  {
    "text": "sending queries to Siri to get somebody's calendar and contacts actually can be fun on a lock device but",
    "start": "193879",
    "end": "200920"
  },
  {
    "text": "that's okay and screen widgets so you really get little and we'd like to change that for you so let's get into",
    "start": "200920",
    "end": "206040"
  },
  {
    "text": "States so before actually getting into what data we are going to look at collecting we're going to talk about",
    "start": "206040",
    "end": "211280"
  },
  {
    "text": "each device state so first off we have before first unlock or bfu mode so this",
    "start": "211280",
    "end": "217799"
  },
  {
    "text": "is a state after you restart a device but before you actually type your pin in for the first time and in this case a",
    "start": "217799",
    "end": "225000"
  },
  {
    "text": "lot of the features are going to be limited for example the device will not connect to Wi-Fi by default and a lot of",
    "start": "225000",
    "end": "231319"
  },
  {
    "text": "other settings are going to be limited until you do unlock that first time so we have AFU mode which is just going to",
    "start": "231319",
    "end": "238079"
  },
  {
    "text": "be after you unlock for the first time time with all of these restrictions",
    "start": "238079",
    "end": "243360"
  },
  {
    "text": "lifted next we have recovery mode and this is just a mode which is typically used to fix boot Loops if you're stuck",
    "start": "243799",
    "end": "250439"
  },
  {
    "text": "in that Apple Loop or to restore or factory reset your device dfu mode device firmware upgrade",
    "start": "250439",
    "end": "257720"
  },
  {
    "text": "is a very lowlevel mode used for flashing essentially and that's about it",
    "start": "257720",
    "end": "263000"
  },
  {
    "text": "and it looks like the device is powered off however it is actually not now those of you who've done a lot of jailbreaks",
    "start": "263000",
    "end": "268199"
  },
  {
    "text": "if you've goofed on them you might have up in this mode and then dfu stands for done fed",
    "start": "268199",
    "end": "273240"
  },
  {
    "text": "up so we have Diagnostics mode which a lot of people do not know much about and",
    "start": "273240",
    "end": "279360"
  },
  {
    "text": "essentially this is used by Apple for apple and to get in here you would start",
    "start": "279360",
    "end": "284919"
  },
  {
    "text": "with your device fully shut off hold both volume buttons and then plug it into a PC and after Apple logo pops up",
    "start": "284919",
    "end": "291759"
  },
  {
    "text": "you can stop holding buttons and you'll show up in this mode and in this mode",
    "start": "291759",
    "end": "296800"
  },
  {
    "text": "you can't do too much if you click Start Diagnostics ask you to connect to a Wi-Fi network and at that point you get",
    "start": "296800",
    "end": "302840"
  },
  {
    "text": "a white screen which says hand it over to the Apple rep and let them handle the rest and we can't do much from here",
    "start": "302840",
    "end": "309440"
  },
  {
    "text": "however something that is nice is if we click on this little informational icon in the corner we do get a few",
    "start": "309440",
    "end": "314919"
  },
  {
    "text": "identifiers which are off the bat very useful for examiners such as IMEI meid and the serial",
    "start": "314919",
    "end": "321680"
  },
  {
    "text": "number now we have trusted impaired so the device will be very limited in terms",
    "start": "321680",
    "end": "327840"
  },
  {
    "text": "of logical acquisition unless we do trust it with the PC the trust will",
    "start": "327840",
    "end": "332880"
  },
  {
    "text": "require us to type the passcode in and enter the home screen and then plug our PC in and click on this little trust",
    "start": "332880",
    "end": "338280"
  },
  {
    "text": "icon that pops up USB restricted mode however is uh",
    "start": "338280",
    "end": "345800"
  },
  {
    "text": "it's going to essentially cancel any USB input or output going to in from the",
    "start": "345800",
    "end": "351400"
  },
  {
    "text": "device and this is what happens after you fully reboot the device enter SOS mode or you just do not unlock the",
    "start": "351400",
    "end": "359199"
  },
  {
    "text": "device device for a certain period of time the period of time has changed recently it is now about 1 hour of time",
    "start": "359199",
    "end": "366280"
  },
  {
    "text": "if you do not unlock your device it will enter USB RM and even plugging it into a PC you would not even be able to",
    "start": "366280",
    "end": "373919"
  },
  {
    "text": "charge but so uh one way to prolong this actually is if you plug a dongle into",
    "start": "373919",
    "end": "381400"
  },
  {
    "text": "the device so say the device has been unlocked 30 minutes ago and you need it to not reach that hour but you don't",
    "start": "381400",
    "end": "388199"
  },
  {
    "text": "know the passcode certain dongles you could plug into the device and it will actually prolong this activation and we",
    "start": "388199",
    "end": "397639"
  },
  {
    "text": "found through testing that usually the dongles that work are the ones with both lightning and USB and essentially you",
    "start": "397639",
    "end": "404560"
  },
  {
    "text": "just plug this in and it's nice because you could charge the device as well and then it will make sure USB RM does not",
    "start": "404560",
    "end": "410960"
  },
  {
    "text": "activate yeah this is really critical because the amount of data we're going to have access to in usbm is limited but",
    "start": "410960",
    "end": "418639"
  },
  {
    "text": "we'll talk about that so let's jump into a little bit about the data sources so really there's a couple of different",
    "start": "418639",
    "end": "424000"
  },
  {
    "text": "Acquisitions or recoveries you might get back and the main thing I want to take you to take away from all these words",
    "start": "424000",
    "end": "429960"
  },
  {
    "text": "that I don't expect you to read is that no matter what you're dealing with volatile data even if you're in our",
    "start": "429960",
    "end": "435360"
  },
  {
    "text": "somewhat volatile category where you've used an acquisition method to get a full file system image your data is dropping",
    "start": "435360",
    "end": "442479"
  },
  {
    "text": "day by day if you're looking at something like significant locations or the location cache that data is only",
    "start": "442479",
    "end": "448840"
  },
  {
    "text": "held for seven days but each day it drops a day so on day six you're only getting five days worth of data so after",
    "start": "448840",
    "end": "454479"
  },
  {
    "text": "a week there's none that is the least volatile type of data of what we're",
    "start": "454479",
    "end": "459680"
  },
  {
    "text": "talking about here when you get into some of the methods that we're going to be going through which is data through",
    "start": "459680",
    "end": "464919"
  },
  {
    "text": "wired interfaces like USB peripheral data data through networks that data is",
    "start": "464919",
    "end": "470639"
  },
  {
    "text": "even more volatile but incredibly important so we do want to take a moment",
    "start": "470639",
    "end": "476919"
  },
  {
    "text": "to talk about Cy diagnos logs there's been some really cool research on CIS diagnos logs we've been doing our own expanding it quite a bit uh and what",
    "start": "476919",
    "end": "484879"
  },
  {
    "text": "these are are these are logs that are meant for when a crash happens to help",
    "start": "484879",
    "end": "490360"
  },
  {
    "text": "Apple work through that data so they can either be existed because a device",
    "start": "490360",
    "end": "495479"
  },
  {
    "text": "crashed and crashed crashed and they are self-created or they can be actually",
    "start": "495479",
    "end": "500919"
  },
  {
    "text": "created by you so for those of you with an iPhone you could go ahead right now and hold down the power button as well",
    "start": "500919",
    "end": "506720"
  },
  {
    "text": "as the up and down button at the same time and if you hold it for an out minute and a minute a second and a half",
    "start": "506720",
    "end": "512279"
  },
  {
    "text": "you just felt your phone vibrate Tada you created a a crash log a CIS diagnose log and we appreciate it because if we",
    "start": "512279",
    "end": "518640"
  },
  {
    "text": "happen to read your phones later we're going to get more data so thank you um you can do this without doing it through",
    "start": "518640",
    "end": "524120"
  },
  {
    "text": "that buttonology you can do it directly through navigating through the screens",
    "start": "524120",
    "end": "529320"
  },
  {
    "text": "and you can also do it via the terminal so in this case we actually just jailbroke a device and then sshed in and",
    "start": "529320",
    "end": "536240"
  },
  {
    "text": "you can see you can just run the Cy diagnosed command and if we run Tac H we can see we have all of these options and",
    "start": "536240",
    "end": "543120"
  },
  {
    "text": "we could just gather the log this way as well and we do see in the description a",
    "start": "543120",
    "end": "548720"
  },
  {
    "text": "few interesting things first off is that cyst diagnose needs to be run as root so",
    "start": "548720",
    "end": "554600"
  },
  {
    "text": "if we are able to leverage this process to do anything unended it's important to note that we are able to interact with a",
    "start": "554600",
    "end": "561760"
  },
  {
    "text": "root process and at the same time we see here that it says we can hit this key",
    "start": "561760",
    "end": "567040"
  },
  {
    "text": "chord to actually do Cy diagnose as well and it turns out you can uh if you do",
    "start": "567040",
    "end": "573800"
  },
  {
    "text": "plug a USB keyboard into the dongle you are able to hit that key chord and the",
    "start": "573800",
    "end": "578839"
  },
  {
    "text": "device will vibrate and it will gather a log so this is essentially just a Mac OS program ported over to",
    "start": "578839",
    "end": "585360"
  },
  {
    "text": "iOS so as for the contents of this log the Cy diagnose does provide this tasks",
    "start": "585360",
    "end": "590760"
  },
  {
    "text": "summary. CSV file and this file will tell you a list of commands that were run however it does not give us the",
    "start": "590760",
    "end": "598079"
  },
  {
    "text": "higher level command and we wanted to actually take a look at everything that was run so what we did",
    "start": "598079",
    "end": "603760"
  },
  {
    "text": "is we just made a little oneliner and then we ran that and it would output all of our PS into a single text document",
    "start": "603760",
    "end": "610800"
  },
  {
    "text": "and then we could filter it out and see all the commands that were actually run so when we do that we get about 60",
    "start": "610800",
    "end": "616920"
  },
  {
    "text": "something commands that were run and we can see that it starts off with the Cy diagnose command and then it goes to the",
    "start": "616920",
    "end": "623160"
  },
  {
    "text": "helper and the helper runs all of these sub commands and pushes them all to the single folder",
    "start": "623160",
    "end": "629720"
  },
  {
    "text": "so to actually export these logs we have a few different methods the first way is if we actually are able to get onto the",
    "start": "629720",
    "end": "636120"
  },
  {
    "text": "device you could just head to privacy and then analytics and then we could click on the log and then you can either",
    "start": "636120",
    "end": "641519"
  },
  {
    "text": "email it or airdrop it or whatnot alternatively we do have this",
    "start": "641519",
    "end": "646639"
  },
  {
    "text": "tool that we actually put out a few months ago and it does use one of the tools from I device extraction and",
    "start": "646639",
    "end": "654000"
  },
  {
    "text": "essentially you would just pair your device and then you can choose whether you want to keep or delete the logs on",
    "start": "654000",
    "end": "660279"
  },
  {
    "text": "the device as you export and then you could just export your logs this is just a quick easy little thing we put out a",
    "start": "660279",
    "end": "665639"
  },
  {
    "text": "couple six months ago this isn't what you're here for just to get that there so you could also export via iTunes now",
    "start": "665639",
    "end": "673519"
  },
  {
    "text": "forensically we would not use iTunes to export however it's very important to note because if anybody has ever plugged",
    "start": "673519",
    "end": "680720"
  },
  {
    "text": "their device into a computer running iTunes it's very likely that they have",
    "start": "680720",
    "end": "686200"
  },
  {
    "text": "grabbed a lot of logs without actually knowing they've grabbed a lot of logs so if you are examining a PC if you head",
    "start": "686200",
    "end": "692079"
  },
  {
    "text": "over to the app data you know the folder for Apple uh there's a very high chance",
    "start": "692079",
    "end": "698160"
  },
  {
    "text": "that there will be just hundreds of logs in here that nobody knows about and they could contain very good forensic",
    "start": "698160",
    "end": "703240"
  },
  {
    "text": "information what's great about these logs as they can go back years I know when Nick threw this on his machine it was a newer computer and he had logs",
    "start": "703240",
    "end": "709399"
  },
  {
    "text": "back to 2017 on a variety of iOS devices and the data on these are rich now I",
    "start": "709399",
    "end": "715959"
  },
  {
    "text": "know what you care about is can we get Cy diagnosed from locked devices that are USB RM",
    "start": "715959",
    "end": "723399"
  },
  {
    "text": "devices it is definitely theoretically possible based off of some of the other",
    "start": "723399",
    "end": "728560"
  },
  {
    "text": "information we're going to give you so what we've really care about like I said CIS diagnos logs have been looked at for",
    "start": "728560",
    "end": "733760"
  },
  {
    "text": "a while we've been spending a lot of time on CIS logs themselves and what these are these are actually the",
    "start": "733760",
    "end": "739240"
  },
  {
    "text": "realtime logs that are being produced by your device as things are happening now in order to get these logs we do need",
    "start": "739240",
    "end": "746519"
  },
  {
    "text": "trust so for this example we use the lib IM mobile device toolkit and we use the I device CIS log tool and essentially",
    "start": "746519",
    "end": "753760"
  },
  {
    "text": "all you do is you'd plug a paired device in and then you would run this tool and it would start outputting your CIS",
    "start": "753760",
    "end": "759399"
  },
  {
    "text": "log so we also are releasing a new tool today the io plus s toolkit and with",
    "start": "759399",
    "end": "765959"
  },
  {
    "text": "some new upcoming features we do also have capturing and parsing CIS logs so here we have an example we see",
    "start": "765959",
    "end": "773839"
  },
  {
    "text": "on the right all of the identifiers are null and that's because I have no device plugged in yet we see when I do plug the",
    "start": "773839",
    "end": "779480"
  },
  {
    "text": "device in all of this populates so we just have a nice output of all of these different",
    "start": "779480",
    "end": "785480"
  },
  {
    "text": "identifiers we could then pair or unpair our device manually and head over to the application log section and that will",
    "start": "785480",
    "end": "791480"
  },
  {
    "text": "tell us if we need to you know unlock enter our passcode and then we could hit on pair again and once we are paired we",
    "start": "791480",
    "end": "797720"
  },
  {
    "text": "could just click on start Monitor and it will start monitoring our log this is not sped",
    "start": "797720",
    "end": "803279"
  },
  {
    "text": "up this is how quick this is running yeah so it the log does push out",
    "start": "803279",
    "end": "810560"
  },
  {
    "text": "hundreds to thousands of lines sometimes and the big issue with that is sometimes",
    "start": "810560",
    "end": "816440"
  },
  {
    "text": "if we're looking for an identifier um we have to run this for like several minutes and at that point we're dealing",
    "start": "816440",
    "end": "822560"
  },
  {
    "text": "with millions of lines and nobody wants to deal with millions of lines by hand so in the CIS log analysis tab we",
    "start": "822560",
    "end": "830639"
  },
  {
    "text": "actually parse all of this in real time so after we click monitor we are",
    "start": "830639",
    "end": "835680"
  },
  {
    "text": "automatically checking every line for keywords and if we find anything interesting we'll push it here so we can",
    "start": "835680",
    "end": "841920"
  },
  {
    "text": "see we have some simple stuff such as the um device size the gigabytes and",
    "start": "841920",
    "end": "847279"
  },
  {
    "text": "then but we also have bssids and ssids of networks that we've connected to but",
    "start": "847279",
    "end": "853440"
  },
  {
    "text": "we also have them for networks that we have previously connected to even though we're not seeing them now in some cases",
    "start": "853440",
    "end": "860240"
  },
  {
    "text": "we were even able to get the latitude and longitude location of networks if we have Auto join enabled and we can get",
    "start": "860240",
    "end": "867320"
  },
  {
    "text": "the last join time in first join time of these networks so just to be clear you",
    "start": "867320",
    "end": "872560"
  },
  {
    "text": "can do this on any version of iOS that you're seeing so if you've got something",
    "start": "872560",
    "end": "878399"
  },
  {
    "text": "new and it's not yet supported by your tools or a jailbreak regardless of Hardware or iOS version you can look at",
    "start": "878399",
    "end": "885120"
  },
  {
    "text": "the live CIS logs and be able to get information such as timestamped",
    "start": "885120",
    "end": "890920"
  },
  {
    "text": "geolocations based on ssids and BSS IDs that were Auto",
    "start": "890920",
    "end": "896120"
  },
  {
    "text": "joined so next we took a look at USB endpoints for the following example we",
    "start": "896120",
    "end": "903320"
  },
  {
    "text": "gathered all of this data from an iPhone x running iOS",
    "start": "903320",
    "end": "908240"
  },
  {
    "text": "16.03 so these are all the end points when your device is in a normal State um",
    "start": "908519",
    "end": "914040"
  },
  {
    "text": "there was a total of about 19 endpoints so when you plug your device into a PC",
    "start": "914040",
    "end": "919360"
  },
  {
    "text": "there is actually 19 different endpoints that your PC could talk to your device through normally we would only think",
    "start": "919360",
    "end": "925720"
  },
  {
    "text": "about one or two of these however there's a lot of really weird ones like charging is now an endpoint because as",
    "start": "925720",
    "end": "933000"
  },
  {
    "text": "stated earlier if you plug your device in and it's in USB RM your device will not actually charge and that's because",
    "start": "933000",
    "end": "940279"
  },
  {
    "text": "it actually needs to authenticate before charging now so that's a weird endpoint",
    "start": "940279",
    "end": "945440"
  },
  {
    "text": "we also have firewire is still an endpoint on iPhone x's and there's a lot of really strange endpoints that we",
    "start": "945440",
    "end": "952160"
  },
  {
    "text": "should really look into so in recovery mode we see we have a few end points not as many there's",
    "start": "952160",
    "end": "958959"
  },
  {
    "text": "it's really just one for flashing and then one for General talking to the device and for dfu mode we only have one",
    "start": "958959",
    "end": "967240"
  },
  {
    "text": "end point and that's because dfu mode is very straightforward and it's just for flashing told you it was done Fed",
    "start": "967240",
    "end": "973360"
  },
  {
    "text": "Up So for Diagnostics mode um the actual end points are the same it use the same",
    "start": "973360",
    "end": "979199"
  },
  {
    "text": "driver and everything the only thing is these end points do not work the same if we send specific commands to the device",
    "start": "979199",
    "end": "985839"
  },
  {
    "text": "in the back end it will not always function exactly the same same but so when a trust is established",
    "start": "985839",
    "end": "994600"
  },
  {
    "text": "everything is encapsulated within a SSL session so when we do need to",
    "start": "994600",
    "end": "1001800"
  },
  {
    "text": "trust then um in some cases yeah so in some cases um when we establish a trust",
    "start": "1001800",
    "end": "1009040"
  },
  {
    "text": "everything is pushed through an SSL session and this is required in some cases it is",
    "start": "1009040",
    "end": "1014639"
  },
  {
    "text": "not so for some example considering a windows program if we run some windows",
    "start": "1014639",
    "end": "1021440"
  },
  {
    "text": "program it will prompt the device for an SSL session and if we can get one it",
    "start": "1021440",
    "end": "1027199"
  },
  {
    "text": "will make a query and if we can't get one it will attempt to make the query still the device will tell us it won't",
    "start": "1027199",
    "end": "1033360"
  },
  {
    "text": "give us anything and then we'll quit alternatively some programs we would",
    "start": "1033360",
    "end": "1038880"
  },
  {
    "text": "attempt to make the query and then if we can get SSL it would make the query and",
    "start": "1038880",
    "end": "1044079"
  },
  {
    "text": "if we canot it would exit however SSL is not actually required so so in some",
    "start": "1044079",
    "end": "1049120"
  },
  {
    "text": "cases we are able to either modify binaries or just make raw commands to a",
    "start": "1049120",
    "end": "1054640"
  },
  {
    "text": "device and just force the query without asking for SSL and we're still able to obtain all of the",
    "start": "1054640",
    "end": "1060600"
  },
  {
    "text": "data so for working with USB endpoints it's really just input and output we",
    "start": "1060600",
    "end": "1066120"
  },
  {
    "text": "could either capture and examine traffic or we could send our own traffic and then examine the",
    "start": "1066120",
    "end": "1071600"
  },
  {
    "text": "response so for capturing traffic we used a tool called usbpcap and you could find that at this link and essentially",
    "start": "1071600",
    "end": "1079559"
  },
  {
    "text": "all you would do is you'd run the program you'd see what Hub is on the iOS",
    "start": "1079559",
    "end": "1084799"
  },
  {
    "text": "device you'd select that Hub and then you can start monitoring to a file once we have captured it",
    "start": "1084799",
    "end": "1091600"
  },
  {
    "text": "essentially everything going to and from a device is going to be within this little pist so you could just search for",
    "start": "1091600",
    "end": "1097840"
  },
  {
    "text": "the word pist in some cases it's not actually wrapped in the pist however most of the sensitive or forensic data",
    "start": "1097840",
    "end": "1104240"
  },
  {
    "text": "will be within one of these pists so something that's very interesting is that tokens and",
    "start": "1104240",
    "end": "1110840"
  },
  {
    "text": "certificates which are required to create a pairing record show up in this",
    "start": "1110840",
    "end": "1116400"
  },
  {
    "text": "traffic um some of it will show up only on a trusted device however some of this",
    "start": "1116400",
    "end": "1121679"
  },
  {
    "text": "will actually show up on an untrusted device granted you do not have USB",
    "start": "1121679",
    "end": "1126720"
  },
  {
    "text": "RM it's also important to note that devices within setup mode or deactivated",
    "start": "1126720",
    "end": "1134200"
  },
  {
    "text": "mode are automatically trusted by a PC so this means if you have a device which",
    "start": "1134200",
    "end": "1140120"
  },
  {
    "text": "is in that welcome to iOS State before you actually set up and enter your email or anything it is automatically trusted",
    "start": "1140120",
    "end": "1146400"
  },
  {
    "text": "when you plug it in and you can get this data and devices which are deactivated are automatically forced to trust to the",
    "start": "1146400",
    "end": "1152720"
  },
  {
    "text": "PC which means when you get one of those devices that somebody has factory reset intentionally to obfuscate their",
    "start": "1152720",
    "end": "1159320"
  },
  {
    "text": "evidence we're actually able to get back the time of that reset and they that in itself may be valuable to your",
    "start": "1159320",
    "end": "1165679"
  },
  {
    "text": "investigation as well as some of the identifi buers associated with that device which if you're on the Le side",
    "start": "1165679",
    "end": "1172360"
  },
  {
    "text": "you may be able to get back more information uh from the carrier or from Apple regarding that",
    "start": "1172360",
    "end": "1178000"
  },
  {
    "text": "device but usbm USB um restricted mode ruins it",
    "start": "1178000",
    "end": "1185000"
  },
  {
    "text": "USB restricted mode is kind of the bane of our existence in our research we can get past some things with pairing",
    "start": "1185000",
    "end": "1191760"
  },
  {
    "text": "records but if it's usbm we can't so we mentioned a couple of times these pairing records so you need trust and",
    "start": "1191760",
    "end": "1199280"
  },
  {
    "text": "how do you get trust if you don't know the passcode well you can if you have access to the pairing records so the",
    "start": "1199280",
    "end": "1205679"
  },
  {
    "text": "pairing records a lot of times will exist on a PC where somebody had established trust so you can get them",
    "start": "1205679",
    "end": "1211559"
  },
  {
    "text": "either from Windows or Mac at those locations uh what you'll see is the guid for the device is there so you can",
    "start": "1211559",
    "end": "1218280"
  },
  {
    "text": "actually get that guid just by plugging into iTunes and selecting to so that you can get that hash value um once you have",
    "start": "1218280",
    "end": "1226720"
  },
  {
    "text": "that you can pull pull this lockdown record off the user's device and bring",
    "start": "1226720",
    "end": "1233600"
  },
  {
    "text": "that over onto your exploitation machine wherever you're doing your acquisition and now you have trust and can continue",
    "start": "1233600",
    "end": "1240080"
  },
  {
    "text": "through your methodology so Diagnostics mode somewhat bypasses USB restricted mode so",
    "start": "1240080",
    "end": "1247880"
  },
  {
    "text": "essentially a device in Diagnostics mode does not know what USB RM is so if you",
    "start": "1247880",
    "end": "1254240"
  },
  {
    "text": "do put the device into this mode it will not be USB restricted however at the same time it is not going to be trusted",
    "start": "1254240",
    "end": "1261679"
  },
  {
    "text": "so we are put in this untrusted device state where we can attempt to gain data",
    "start": "1261679",
    "end": "1267240"
  },
  {
    "text": "however it is considered passcode protected so we would not be able to get a full logical acquisition as we",
    "start": "1267240",
    "end": "1273320"
  },
  {
    "text": "normally would but you can send specific queries and get results so we see in this example if we",
    "start": "1273320",
    "end": "1280799"
  },
  {
    "text": "do open up iTunes on a PC and we let the iTunes driver talk to the device if we just plug the device in and out several",
    "start": "1280799",
    "end": "1287640"
  },
  {
    "text": "times while we are in Diagnostics mode so even if the device was in usbm we",
    "start": "1287640",
    "end": "1292760"
  },
  {
    "text": "could put it in this mode and attempt to do this and in this case we see the header for the photos. sqlite file now",
    "start": "1292760",
    "end": "1300520"
  },
  {
    "text": "this contains a lot of very important information we have the names of photos we have locations of where photos were",
    "start": "1300520",
    "end": "1306960"
  },
  {
    "text": "taken we have dates of when photos were taken and we're able to get all of this information with a fully 100% locked",
    "start": "1306960",
    "end": "1314000"
  },
  {
    "text": "down USB RM untrusted device USB RM un trusted and we're getting you names of",
    "start": "1314000",
    "end": "1319720"
  },
  {
    "text": "metadata of photos that's freaking awesome I think it is maybe so we have highlighted some of the",
    "start": "1319720",
    "end": "1327880"
  },
  {
    "text": "CIS log stuff and in the future our tool is going to also parse out a lot of USB",
    "start": "1327880",
    "end": "1336080"
  },
  {
    "text": "traffic fair enough yeah so uh we also have taken a look at querying recovery",
    "start": "1336080",
    "end": "1342480"
  },
  {
    "text": "mode through these commands we used a tool called I device recovery and for",
    "start": "1342480",
    "end": "1348200"
  },
  {
    "text": "these we just queried the get EnV and essentially this would just give us the Envy EnV Ram variables and we ran this",
    "start": "1348200",
    "end": "1356760"
  },
  {
    "text": "and this is what we're able to find so we have the iboot which could be important in determining if exploits",
    "start": "1356760",
    "end": "1362520"
  },
  {
    "text": "work we have a few very simple variables and then luckily down here we have",
    "start": "1362520",
    "end": "1368960"
  },
  {
    "text": "something interesting which is partial iCloud account email and we are able to",
    "start": "1368960",
    "end": "1374080"
  },
  {
    "text": "also tell if the device is iCloud locked or not so to actually determine what",
    "start": "1374080",
    "end": "1379720"
  },
  {
    "text": "variables would work we just made a little python script which would fuzz recovery mode and essentially we got",
    "start": "1379720",
    "end": "1385520"
  },
  {
    "text": "different identifiers from actually a full file system and we put all of these",
    "start": "1385520",
    "end": "1390919"
  },
  {
    "text": "into a text document and we ran this little Loop to run commands and we did",
    "start": "1390919",
    "end": "1396760"
  },
  {
    "text": "get EnV set EnV and just ran raw commands so set EnV is very locked down",
    "start": "1396760",
    "end": "1402559"
  },
  {
    "text": "and we weren't able to do too much however get EnV as you saw there's a few things that we could get but sending raw",
    "start": "1402559",
    "end": "1409080"
  },
  {
    "text": "commands is very interesting as well because although we did not get a text",
    "start": "1409080",
    "end": "1414400"
  },
  {
    "text": "response per se there are several commands that could be sent which will force the device to",
    "start": "1414400",
    "end": "1420400"
  },
  {
    "text": "crash and we know what crash has create so what can we recover from Lock",
    "start": "1420400",
    "end": "1427279"
  },
  {
    "text": "devices right that's that's what you're here to find believe it or not quite a lot now there's two states we need to worry about we need to worry about is",
    "start": "1427279",
    "end": "1433600"
  },
  {
    "text": "the device paired or is it not paired now obviously you're going to get some more in paired I expect you to know that",
    "start": "1433600",
    "end": "1438760"
  },
  {
    "text": "right based on what we said so we're going to get those cyst diagnos logs uh Super Rich data source we're going to go",
    "start": "1438760",
    "end": "1444559"
  },
  {
    "text": "through some of this data we're going to get the live CIS logs that we were talking about that we can monitor uh with the with the tool we showed",
    "start": "1444559",
    "end": "1451520"
  },
  {
    "text": "obviously iTunes backups and Siri stuff we talked about that earlier at a lock screen but now the additional things we",
    "start": "1451520",
    "end": "1457480"
  },
  {
    "text": "want you to pay attention to are the raw USB traffic data that we're getting back and then the data in each one of those",
    "start": "1457480",
    "end": "1463480"
  },
  {
    "text": "modes which is unique and has different valuable V uh value as well as some dat we're getting back via apis we're going",
    "start": "1463480",
    "end": "1469360"
  },
  {
    "text": "to go through like some specifics when the device is unpaired we do lose some",
    "start": "1469360",
    "end": "1474880"
  },
  {
    "text": "of those sources but I want you to pay attention to the bottom right we're still getting all of this USB traffic",
    "start": "1474880",
    "end": "1480640"
  },
  {
    "text": "through these different modes that we're doing via the input output of IO pluss",
    "start": "1480640",
    "end": "1485919"
  },
  {
    "text": "but we're also able to get remote system diis diagnosed logs that might be of interest uh and some",
    "start": "1485919",
    "end": "1494279"
  },
  {
    "text": "apis so we're about to show you the types of data that we were able to pull",
    "start": "1494279",
    "end": "1499799"
  },
  {
    "text": "from a device in this state and we're talking about a modern device an iPhone 12 Pro we're talking about the device",
    "start": "1499799",
    "end": "1506159"
  },
  {
    "text": "being in USB restricted mode untrusted no pairing record whatsoever we do have",
    "start": "1506159",
    "end": "1512520"
  },
  {
    "text": "it after first unlock so the only thing we're giving ourselves as an advantage is that the battery hasn't died okay is",
    "start": "1512520",
    "end": "1518600"
  },
  {
    "text": "that fair us being AFU we're trying to give ourselves the hardest thing we do needed AFU so so cut us some slack it's",
    "start": "1518600",
    "end": "1524919"
  },
  {
    "text": "not magic uh but we are running iOS 16 .2 in the list of data we're about to show you that we could recover so from",
    "start": "1524919",
    "end": "1532120"
  },
  {
    "text": "the Diagnostics mode right because we have to do each one of these individual we're getting a lot of the identifiers",
    "start": "1532120",
    "end": "1537760"
  },
  {
    "text": "the meid the IMI uh but we're also getting Wi-Fi and Mac addresses for the",
    "start": "1537760",
    "end": "1543120"
  },
  {
    "text": "device uh and we're getting the names of photos and that photo metadata that's",
    "start": "1543120",
    "end": "1548200"
  },
  {
    "text": "huge if I can get photo metadata off a locked unpaired",
    "start": "1548200",
    "end": "1555279"
  },
  {
    "text": "untrusted iOS 12 I iPhone 12 Pro running iOS version 16 I think that's pretty",
    "start": "1555279",
    "end": "1561960"
  },
  {
    "text": "freaking fascinating we're also getting data from the apis including the iTunes account",
    "start": "1561960",
    "end": "1568399"
  },
  {
    "text": "email address first and last name some again of your basic identifiers in recovery mode we're going to get more of",
    "start": "1568399",
    "end": "1574640"
  },
  {
    "text": "that iCloud related information that partial iCloud email address the device is iCloud locked or not you're starting",
    "start": "1574640",
    "end": "1581360"
  },
  {
    "text": "to see that each one of these modes is getting us different access to different parts of data so as for actually going",
    "start": "1581360",
    "end": "1587919"
  },
  {
    "text": "into the CIS diagnos log we can get some device information such as just the",
    "start": "1587919",
    "end": "1593960"
  },
  {
    "text": "device name iOS version some unique identifiers we could also get some specific things such as the language",
    "start": "1593960",
    "end": "1600480"
  },
  {
    "text": "that the user installed on the device the time zones and different keyboards uh we could also get things such as when",
    "start": "1600480",
    "end": "1606880"
  },
  {
    "text": "the device was powered on when applications were run and when screenshots were taken and I find this",
    "start": "1606880",
    "end": "1613000"
  },
  {
    "text": "one very important is every time the device was plugged into USB and the little trust buson button was clicked we",
    "start": "1613000",
    "end": "1620279"
  },
  {
    "text": "can see the date time of when the trust was established we can see the battery device orientation charging State screen",
    "start": "1620279",
    "end": "1627320"
  },
  {
    "text": "status brightness and Motion state of the device as you click that trust button man did we have a pattern of life",
    "start": "1627320",
    "end": "1634559"
  },
  {
    "text": "right there we're also able to obtain some additional application information",
    "start": "1634559",
    "end": "1639679"
  },
  {
    "text": "such as installed apps through different databases the application versions and",
    "start": "1639679",
    "end": "1645320"
  },
  {
    "text": "permissions of the applications we could also see what applications are currently running or processes because it actually",
    "start": "1645320",
    "end": "1651960"
  },
  {
    "text": "does a full ps- a dump and we're able to get application run times like",
    "start": "1651960",
    "end": "1657240"
  },
  {
    "text": "historical application run times so we know when the user used what apps and we",
    "start": "1657240",
    "end": "1663919"
  },
  {
    "text": "can show that the device was on that it was back lit that the orientation changed like this is amazing this is on",
    "start": "1663919",
    "end": "1671080"
  },
  {
    "text": "this locked untrusted device I'm sorry I get too excited about this Nick we're also able to find some identif fires",
    "start": "1671080",
    "end": "1677919"
  },
  {
    "text": "specifically for Wi-Fi and Bluetooth so as stated earlier we could get the MAC address we could also get private",
    "start": "1677919",
    "end": "1684000"
  },
  {
    "text": "rotating Mac addresses for each Network we could see the connected SSID bssid",
    "start": "1684000",
    "end": "1689600"
  },
  {
    "text": "additional information for each Network along with the first and last join times",
    "start": "1689600",
    "end": "1694919"
  },
  {
    "text": "and latitude longitude locations for each previously connected Network we could also sometimes get the external IP",
    "start": "1694919",
    "end": "1704039"
  },
  {
    "text": "addresses and domains which come from Safari or applications in the back end",
    "start": "1704039",
    "end": "1709200"
  },
  {
    "text": "when something fails to resolve and it will put it in one of these error logs man do you know how cool it is that we",
    "start": "1709200",
    "end": "1715000"
  },
  {
    "text": "can get those private rotating Mac addresses because now if you've got data from other systems that were connected",
    "start": "1715000",
    "end": "1720799"
  },
  {
    "text": "we can actually say that they were connected to this device now here's some crazy ones so the Cy diagnos log has",
    "start": "1720799",
    "end": "1726679"
  },
  {
    "text": "like a nested log so now we're talking about the cyst diagnos log logs and we are getting the data from the tccb which",
    "start": "1726679",
    "end": "1733200"
  },
  {
    "text": "is the transparency consent and control that's where all the permissions are housed so we're getting all the permissions that each app has when you",
    "start": "1733200",
    "end": "1739640"
  },
  {
    "text": "make the decision as to if an app can access your camera all the time or just when you're using it or never that",
    "start": "1739640",
    "end": "1745200"
  },
  {
    "text": "information is there we're getting the Power log we're getting the application usage log so now we actually have a",
    "start": "1745200",
    "end": "1750600"
  },
  {
    "text": "second area of data to confirm all that application usage as well as consumption we're getting when what applications",
    "start": "1750600",
    "end": "1757200"
  },
  {
    "text": "were installed and the Mobile Installation log has all apps that have been installed so if you take your",
    "start": "1757200",
    "end": "1764320"
  },
  {
    "text": "Mobile Installation log and you Delta that with your transparency consent and control active applications what do you",
    "start": "1764320",
    "end": "1770519"
  },
  {
    "text": "get all the names of the deleted apps uh you're getting calendar email address and contents you're getting the",
    "start": "1770519",
    "end": "1776200"
  },
  {
    "text": "installed profiles that the user has Mobile activation logs the lock down D logs the update and restore logs Siri",
    "start": "1776200",
    "end": "1782960"
  },
  {
    "text": "analytics and then the CIS diagnos log logs they have a log archive so great",
    "start": "1782960",
    "end": "1788880"
  },
  {
    "text": "more data but this one's magic guess what's in here now we're three layers deep we get Safari history you just got Safari history off",
    "start": "1788880",
    "end": "1797120"
  },
  {
    "text": "of a lock device untrusted it's AFU okay give us the",
    "start": "1797120",
    "end": "1805080"
  },
  {
    "text": "AFU we can't do much with the bfu but some other really cool stuff airdrop",
    "start": "1805080",
    "end": "1811240"
  },
  {
    "text": "logs and those airdrop logs in the clear we're getting the phone number as well",
    "start": "1811240",
    "end": "1817360"
  },
  {
    "text": "as the email address by the way uh if you're really interested in airdrop data",
    "start": "1817360",
    "end": "1823080"
  },
  {
    "text": "check out the presentations and work from Brandon Epstein awesome stuff air tag logs you're getting everything",
    "start": "1823080",
    "end": "1829440"
  },
  {
    "text": "pertaining to air tag logs you're going to note that in your logs by looking for hashtag Duran uh as well as contacts now",
    "start": "1829440",
    "end": "1836080"
  },
  {
    "text": "some of this is weird because these contacts what you're going to see there it's not like all your contacts like you would get in an ffs it's really going to",
    "start": "1836080",
    "end": "1842200"
  },
  {
    "text": "depend on what the user had been doing recently so I would say the key",
    "start": "1842200",
    "end": "1847360"
  },
  {
    "text": "takeaways for iOS researchers is just to find more endpoints so when I started",
    "start": "1847360",
    "end": "1853600"
  },
  {
    "text": "this off we were really looking at lowlevel exploits such as dfu mode",
    "start": "1853600",
    "end": "1858880"
  },
  {
    "text": "exploits binary exploitation but the more we dug into it it turned out that",
    "start": "1858880",
    "end": "1863919"
  },
  {
    "text": "there's just a lot of endpoints that nobody's looking at and if we look into these end points we can do easier",
    "start": "1863919",
    "end": "1870320"
  },
  {
    "text": "exploits and actually get just as much or more data so along with that uh we",
    "start": "1870320",
    "end": "1876240"
  },
  {
    "text": "used ffs to find endpoints so like we did with a recovery mode and in the future with dfu mode um",
    "start": "1876240",
    "end": "1885480"
  },
  {
    "text": "we would fuzz these modes using commands that we actually got from a full file",
    "start": "1885480",
    "end": "1891039"
  },
  {
    "text": "system so if we found maybe the NV Ram",
    "start": "1891039",
    "end": "1897320"
  },
  {
    "text": "variable within a full file system we should look around what other variables are sitting within that same file and",
    "start": "1897320",
    "end": "1904440"
  },
  {
    "text": "then we could put all of these in a file and use them to fuzz and lastly we just have Diagnostics mode because most",
    "start": "1904440",
    "end": "1910679"
  },
  {
    "text": "people do not know that Diagnostics mode is even a thing and there is a lot of work to be done here because we we know",
    "start": "1910679",
    "end": "1917480"
  },
  {
    "text": "the amount of data that Apple can get from this mode is very important and it",
    "start": "1917480",
    "end": "1923799"
  },
  {
    "text": "is very possible that other people could get this data in this mode as",
    "start": "1923799",
    "end": "1929440"
  },
  {
    "text": "well so for future work we would like to fuzz both recovery and dfu mode more",
    "start": "1929440",
    "end": "1936600"
  },
  {
    "text": "like we said there was a few very interesting errors where the device would do funky things or fully crash and",
    "start": "1936600",
    "end": "1944880"
  },
  {
    "text": "um we would like to analyze exactly what these errors can do and how we could",
    "start": "1944880",
    "end": "1950840"
  },
  {
    "text": "take advantage of them uh we would also like to examine the Diagnostics mode API",
    "start": "1950840",
    "end": "1956080"
  },
  {
    "text": "and figure out what apple is doing in the back end so in summary what we really want",
    "start": "1956080",
    "end": "1962320"
  },
  {
    "text": "you to take away here is just because you have a device that is not supported",
    "start": "1962320",
    "end": "1967960"
  },
  {
    "text": "by your tools you should not just be plugging it in and sitting it on the shelf and going I'm going to wait until",
    "start": "1967960",
    "end": "1974480"
  },
  {
    "text": "my commercial tool supports this no there's data you can get right now there is Safari history you can get right now",
    "start": "1974480",
    "end": "1980960"
  },
  {
    "text": "there is I don't care if it's locked I don't care if it's untrusted we didn't get into it we don't",
    "start": "1980960",
    "end": "1986200"
  },
  {
    "text": "even care if it's usbm we didn't explain it but that's okay what we're saying is that there is",
    "start": "1986200",
    "end": "1991919"
  },
  {
    "text": "still a ton of data you can get so we are putting out um our IO plus s tool",
    "start": "1991919",
    "end": "1998919"
  },
  {
    "text": "that actually just got released four minutes and 22 seconds ago uh and you can get that from that QR code or bit. L",
    "start": "1998919",
    "end": "2006639"
  },
  {
    "text": "Plus s it's free for the community to use you're going to notice a couple of things in that tool number one the CIS",
    "start": "2006639",
    "end": "2013360"
  },
  {
    "text": "log monitoring and the CIS log analysis instantaneous you don't have to do anything you just run it live on the",
    "start": "2013360",
    "end": "2019039"
  },
  {
    "text": "device it's going to pull it out the second thing you're going to notice is that there are going to be buttons after that that do nothing we",
    "start": "2019039",
    "end": "2025760"
  },
  {
    "text": "are giving you hints about what is in future development we've actually shown you some screenshots of it so the USB",
    "start": "2025760",
    "end": "2031840"
  },
  {
    "text": "stuff that's not in there uh the API stuff is not in there uh but we already",
    "start": "2031840",
    "end": "2039080"
  },
  {
    "text": "have it functioning we just aren't releasing that yet today so we'd like for you to download the tool and just",
    "start": "2039080",
    "end": "2044679"
  },
  {
    "text": "keep going with the update so this is version 1.0 we've got a lot of stuff coming we really appreciate your time we",
    "start": "2044679",
    "end": "2051919"
  },
  {
    "text": "hope that you now realize how much data you can get from a locked unpaired",
    "start": "2051919",
    "end": "2057158"
  },
  {
    "text": "untrusted usbm device and if you have questions we're going to be available in",
    "start": "2057159",
    "end": "2063158"
  },
  {
    "text": "the wrap-up room we'd love to talk to you so just thank thank you very much and you can also just email us stuff",
    "start": "2063159",
    "end": "2069480"
  },
  {
    "text": "there's there's our handles on the thing that we don't know what to call it anymore but you can use those same",
    "start": "2069480",
    "end": "2074599"
  },
  {
    "text": "handles to find us everywhere else we're we're pretty we're pretty open about that uh so yeah if you want our cards or",
    "start": "2074599",
    "end": "2080960"
  },
  {
    "text": "some stickers we'll see you in a wrapup room thank you so [Applause]",
    "start": "2080960",
    "end": "2087158"
  },
  {
    "text": "much",
    "start": "2087159",
    "end": "2090158"
  }
]