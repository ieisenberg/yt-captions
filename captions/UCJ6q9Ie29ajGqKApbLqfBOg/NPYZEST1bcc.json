[
  {
    "start": "0",
    "end": "141000"
  },
  {
    "text": "[Music]",
    "start": "860",
    "end": "9679"
  },
  {
    "text": "in a normal life you do not expect unexpected",
    "start": "9679",
    "end": "14920"
  },
  {
    "text": "situations especially if those are negatively impacting",
    "start": "14920",
    "end": "21039"
  },
  {
    "text": "your life however from time to time there are situations that we are looking",
    "start": "21039",
    "end": "27760"
  },
  {
    "text": "for to be ordinary unexpected",
    "start": "27760",
    "end": "33840"
  },
  {
    "text": "unforeseen or unpredicted especially in our job profile we are",
    "start": "33840",
    "end": "39680"
  },
  {
    "text": "looking for those quirks corner cases which eventually",
    "start": "39680",
    "end": "45760"
  },
  {
    "text": "could be shared with a broader audience thank you for choosing my presentation",
    "start": "45760",
    "end": "53280"
  },
  {
    "text": "i hope you will enjoy it who am i uh my name is promise of duda the short",
    "start": "54239",
    "end": "61280"
  },
  {
    "text": "name is pramek but everybody calls me duda",
    "start": "61280",
    "end": "66479"
  },
  {
    "text": "i am one of the originator of not so bad ctf team down here at intel",
    "start": "66479",
    "end": "73920"
  },
  {
    "text": "and above and beyond i'm a husband and a father of two kids",
    "start": "73920",
    "end": "81438"
  },
  {
    "text": "throughout this lecture i want to",
    "start": "83520",
    "end": "88880"
  },
  {
    "text": "show you or introduce the history of",
    "start": "88880",
    "end": "94400"
  },
  {
    "text": "my security consideration which was done in one of our",
    "start": "94400",
    "end": "102640"
  },
  {
    "text": "products at intel to describe this",
    "start": "102640",
    "end": "109040"
  },
  {
    "text": "in depth i will have to introduce you uh",
    "start": "109040",
    "end": "114560"
  },
  {
    "text": "knowledge about the hsm we will work on it from outside and",
    "start": "114560",
    "end": "120159"
  },
  {
    "text": "from inside um then i will try to",
    "start": "120159",
    "end": "125600"
  },
  {
    "text": "discuss about the disclosure process we will finish",
    "start": "125600",
    "end": "132000"
  },
  {
    "text": "this lecture with some thoughts and hopefully",
    "start": "132000",
    "end": "137120"
  },
  {
    "text": "questions and answers so let me start",
    "start": "137120",
    "end": "142400"
  },
  {
    "start": "141000",
    "end": "141000"
  },
  {
    "text": "hsm is a hardware security module it comes with",
    "start": "142400",
    "end": "148319"
  },
  {
    "text": "very different flavors it may be as small as a usb stick and it",
    "start": "148319",
    "end": "155040"
  },
  {
    "text": "may cost around about a few tens of bucks",
    "start": "155040",
    "end": "161760"
  },
  {
    "text": "it may be also server scaled solution which is",
    "start": "161760",
    "end": "167280"
  },
  {
    "text": "costly meaning it can cost like 20 000 of us dollars",
    "start": "167280",
    "end": "174560"
  },
  {
    "text": "and for sub technical support for the products you could pay as much",
    "start": "174560",
    "end": "181280"
  },
  {
    "text": "as one quarter of that sum",
    "start": "181280",
    "end": "186159"
  },
  {
    "start": "186000",
    "end": "186000"
  },
  {
    "text": "these are the k aspects of the hsm",
    "start": "187440",
    "end": "193280"
  },
  {
    "text": "first of all this is a physical device meaning it has",
    "start": "193280",
    "end": "199280"
  },
  {
    "text": "or should have hardware adversaries in",
    "start": "199280",
    "end": "204560"
  },
  {
    "text": "scope in the threat models of course the hardware is either defined",
    "start": "204560",
    "end": "211920"
  },
  {
    "text": "via hdl by software but um even your secure card in the wallet runs",
    "start": "211920",
    "end": "219360"
  },
  {
    "text": "java nowadays main concept of the hsm",
    "start": "219360",
    "end": "226560"
  },
  {
    "text": "is that it is used for crypto think of a device which can securely",
    "start": "226560",
    "end": "234000"
  },
  {
    "text": "generate or erase your secret say private key or symmetric key",
    "start": "234000",
    "end": "242319"
  },
  {
    "text": "which could be used then in a business for standard script operations like",
    "start": "242400",
    "end": "249439"
  },
  {
    "text": "encryption decryption etc uh worth to note",
    "start": "249439",
    "end": "255519"
  },
  {
    "text": "that there are two certifications programs",
    "start": "255519",
    "end": "262639"
  },
  {
    "text": "which are called fips and common criteria the fifth certification will be",
    "start": "262639",
    "end": "268960"
  },
  {
    "text": "described in the next slide um briefly",
    "start": "268960",
    "end": "275600"
  },
  {
    "text": "but um the key point here is that the usage of the hsm",
    "start": "275600",
    "end": "282160"
  },
  {
    "text": "the server-scaled hsm should be used in critical security operations such as",
    "start": "282160",
    "end": "291199"
  },
  {
    "text": "signing firmware update once compromised the key or the sign",
    "start": "291199",
    "end": "297360"
  },
  {
    "text": "operation would also impact the",
    "start": "297360",
    "end": "302639"
  },
  {
    "text": "solution which you are trying to update that's why you should",
    "start": "302639",
    "end": "308720"
  },
  {
    "text": "use the hsm because of its security properties",
    "start": "308720",
    "end": "315199"
  },
  {
    "text": "let's see speaking of let's see how the certification could look like",
    "start": "315199",
    "end": "321520"
  },
  {
    "start": "318000",
    "end": "318000"
  },
  {
    "text": "the fips certification 100",
    "start": "321520",
    "end": "327720"
  },
  {
    "text": "140-2 has up to four levels of certification",
    "start": "327720",
    "end": "333759"
  },
  {
    "text": "the higher number means the higher security and of course",
    "start": "334080",
    "end": "340800"
  },
  {
    "text": "increased amount of money you have to spend in the design and manufacturing phase of your hsm",
    "start": "341199",
    "end": "347919"
  },
  {
    "text": "and for instance the level 1 certification is about using only approved crypto algorithms",
    "start": "347919",
    "end": "357039"
  },
  {
    "text": "but um level three for instance is about",
    "start": "357360",
    "end": "362400"
  },
  {
    "text": "the fact that once you will open that device the secure material should be",
    "start": "362400",
    "end": "368400"
  },
  {
    "text": "erased instantly level 4 of certification includes",
    "start": "368400",
    "end": "375199"
  },
  {
    "text": "advanced hardware adversaries think of secure cards with active",
    "start": "375199",
    "end": "382319"
  },
  {
    "text": "shielding on the microchip which should prevent",
    "start": "382319",
    "end": "389360"
  },
  {
    "text": "the hackers with simple focus on being devices",
    "start": "389360",
    "end": "395280"
  },
  {
    "text": "from compromising the key asset which",
    "start": "395280",
    "end": "400319"
  },
  {
    "text": "quite often is a cryptographic key we have to mention that",
    "start": "400319",
    "end": "407520"
  },
  {
    "text": "there are dozens of nice approved",
    "start": "407520",
    "end": "414240"
  },
  {
    "text": "laboratories which actually perform the certification",
    "start": "414240",
    "end": "420720"
  },
  {
    "text": "the evaluation could last for one year and may cost significant amount of time",
    "start": "420720",
    "end": "428319"
  },
  {
    "text": "of money let's see how possibly hsm could",
    "start": "428319",
    "end": "436400"
  },
  {
    "start": "431000",
    "end": "431000"
  },
  {
    "text": "look alike from outside view this picture shows you a sample hsm",
    "start": "436400",
    "end": "444960"
  },
  {
    "text": "without top covering um",
    "start": "444960",
    "end": "450039"
  },
  {
    "text": "so this is the picture from the top view",
    "start": "454960",
    "end": "460080"
  },
  {
    "text": "as you can see it's quite old technology as the hsm itself",
    "start": "460479",
    "end": "466479"
  },
  {
    "text": "is quite old worth to note here that",
    "start": "466479",
    "end": "472160"
  },
  {
    "text": "i haven't found a single particle of dust in it once i have opened it",
    "start": "472160",
    "end": "479840"
  },
  {
    "text": "other fact is that it doesn't come with",
    "start": "480400",
    "end": "485919"
  },
  {
    "text": "single screws so you cannot use screwdriver to open it",
    "start": "485919",
    "end": "491280"
  },
  {
    "text": "um the next interesting fact is shown in this picture",
    "start": "491280",
    "end": "499039"
  },
  {
    "text": "this is a switch which i call the kill switch which",
    "start": "499039",
    "end": "504319"
  },
  {
    "text": "actually satisfies the level three uh pip certification",
    "start": "504319",
    "end": "510960"
  },
  {
    "text": "because as you can see here you have two wires which are",
    "start": "510960",
    "end": "516800"
  },
  {
    "text": "directly connected to a device which i will show you on the next slide",
    "start": "516800",
    "end": "523039"
  },
  {
    "text": "and this is called introduction intrusion detection mechanism so",
    "start": "523039",
    "end": "529120"
  },
  {
    "text": "as you can see it's it could be quite easily by possible",
    "start": "529120",
    "end": "535610"
  },
  {
    "text": "[Music] the true hsm",
    "start": "535610",
    "end": "542000"
  },
  {
    "start": "537000",
    "end": "537000"
  },
  {
    "text": "is here this is the system on chip embedded on the pci express card",
    "start": "542000",
    "end": "550640"
  },
  {
    "text": "one can see that we do have a battery",
    "start": "550640",
    "end": "556959"
  },
  {
    "text": "here for servicing the kill switch so even though you",
    "start": "556959",
    "end": "563279"
  },
  {
    "text": "unplug the device uh from the current",
    "start": "563279",
    "end": "569680"
  },
  {
    "text": "the kill switch will eventually trigger the",
    "start": "569680",
    "end": "574720"
  },
  {
    "text": "key array procedure what else could be",
    "start": "575040",
    "end": "580640"
  },
  {
    "text": "directly seen here is that we have this metal cover",
    "start": "580640",
    "end": "586320"
  },
  {
    "text": "which effectively removes",
    "start": "586320",
    "end": "592320"
  },
  {
    "text": "a basic skill set adversaries from the plate because",
    "start": "592320",
    "end": "598880"
  },
  {
    "text": "in order to hack into that you would have to remove this metal cover",
    "start": "598880",
    "end": "604399"
  },
  {
    "text": "first now let's see",
    "start": "604399",
    "end": "610320"
  },
  {
    "start": "608000",
    "end": "608000"
  },
  {
    "text": "which hsm we will be referring to during this presentation",
    "start": "610320",
    "end": "617640"
  },
  {
    "text": "in our solution we were using um",
    "start": "618480",
    "end": "623680"
  },
  {
    "text": "hsm which was i think designed by the safenet company",
    "start": "623680",
    "end": "630959"
  },
  {
    "text": "which were bought by um",
    "start": "630959",
    "end": "637360"
  },
  {
    "text": "gemalto and then as it occurred dallas group owned gemalto",
    "start": "637360",
    "end": "642959"
  },
  {
    "text": "the name of the hsm is a luna sp",
    "start": "642959",
    "end": "648320"
  },
  {
    "text": "it's a flip certified device with level three",
    "start": "648320",
    "end": "654399"
  },
  {
    "text": "what odd so to speak in that hsm is that it runs",
    "start": "654480",
    "end": "662240"
  },
  {
    "text": "java it has the tomcat web server web server",
    "start": "662240",
    "end": "668079"
  },
  {
    "text": "and to which you can actually [Music] deploy your application",
    "start": "668079",
    "end": "675120"
  },
  {
    "text": "which implements the business logic you want to run on the hsm",
    "start": "675120",
    "end": "680880"
  },
  {
    "text": "so let me describe",
    "start": "680880",
    "end": "685920"
  },
  {
    "start": "682000",
    "end": "682000"
  },
  {
    "text": "my research objectives in the historical view",
    "start": "685920",
    "end": "691519"
  },
  {
    "text": "first of all my first duty was to create a threat model",
    "start": "691519",
    "end": "697360"
  },
  {
    "text": "for our own usage having this document helps a lot",
    "start": "697360",
    "end": "703680"
  },
  {
    "text": "um soon after that i wanted to",
    "start": "703680",
    "end": "709360"
  },
  {
    "text": "invalidate either existing or new security objectives since i'm",
    "start": "709360",
    "end": "714880"
  },
  {
    "text": "security person and",
    "start": "714880",
    "end": "720240"
  },
  {
    "text": "last but not least i wanted to have a fun and profit whereas",
    "start": "720240",
    "end": "726160"
  },
  {
    "text": "the profit is that i can speak up to you at this very moment",
    "start": "726160",
    "end": "732800"
  },
  {
    "text": "during my research i was trying to poke around the technology first",
    "start": "737040",
    "end": "745760"
  },
  {
    "text": "so i tried to see what could be possible found in the",
    "start": "745760",
    "end": "751399"
  },
  {
    "text": "administrative tools which are used by so-called security officer in a highly",
    "start": "751399",
    "end": "759440"
  },
  {
    "text": "trusted environment so you can see the dashed",
    "start": "759440",
    "end": "765360"
  },
  {
    "text": "box is for the trust boundary",
    "start": "765360",
    "end": "769519"
  },
  {
    "text": "even though if we would find any kind of weakness here we could not eventually",
    "start": "770639",
    "end": "777920"
  },
  {
    "text": "say this is a security vulnerability because of this trust boundary right",
    "start": "777920",
    "end": "783370"
  },
  {
    "text": "[Music] during this topic i wasn't",
    "start": "783370",
    "end": "789440"
  },
  {
    "text": "uh pursuing for any kind of vulnerability especially i",
    "start": "789440",
    "end": "794480"
  },
  {
    "text": "was not searching for this path which crosses the trust boundary",
    "start": "794480",
    "end": "800560"
  },
  {
    "text": "the main goal of this part of research was to poke around and see what are the",
    "start": "800560",
    "end": "806959"
  },
  {
    "text": "properties of the administrative tools as i believe was a",
    "start": "806959",
    "end": "812839"
  },
  {
    "text": "part of the whole package so having knowledge about",
    "start": "812839",
    "end": "820320"
  },
  {
    "text": "security level of administrative tools i could reason about the",
    "start": "820320",
    "end": "826480"
  },
  {
    "text": "security level of the whole package so i started with standard procedures so",
    "start": "826480",
    "end": "835279"
  },
  {
    "start": "830000",
    "end": "830000"
  },
  {
    "text": "i [Music] looked in the into the",
    "start": "835279",
    "end": "840720"
  },
  {
    "text": "binary security of the tool itself",
    "start": "840720",
    "end": "846879"
  },
  {
    "text": "i discovered that standard procedure is that",
    "start": "849199",
    "end": "855040"
  },
  {
    "text": "uh you list those uh security features and you can find that",
    "start": "855040",
    "end": "862000"
  },
  {
    "text": "there was uh the read only relocation protection was not",
    "start": "862000",
    "end": "867440"
  },
  {
    "text": "enabled meaning after successful weakness abusing you could override the",
    "start": "867440",
    "end": "874959"
  },
  {
    "text": "global offset table and then i",
    "start": "874959",
    "end": "880079"
  },
  {
    "text": "found that okay the code is not position independent so it doesn't have the benefit of",
    "start": "880079",
    "end": "887519"
  },
  {
    "text": "the aslr and next what was",
    "start": "887519",
    "end": "892800"
  },
  {
    "text": "kind of weird to me that there was not a single one canary protecting the stack",
    "start": "892800",
    "end": "900879"
  },
  {
    "text": "and also you can see that the non-executable bit is enabled",
    "start": "902560",
    "end": "908639"
  },
  {
    "text": "meaning you cannot push directly the shell code on the stack either on the",
    "start": "908639",
    "end": "914079"
  },
  {
    "text": "data section or on the hip then what you could do and what i doubt did",
    "start": "914079",
    "end": "922240"
  },
  {
    "text": "i listed the relocation table of",
    "start": "922240",
    "end": "928399"
  },
  {
    "text": "that tool and discovered that the tool uses",
    "start": "928399",
    "end": "934000"
  },
  {
    "text": "unsafe functions from the standard library",
    "start": "934000",
    "end": "939040"
  },
  {
    "text": "and what was weird to me is the fact that string copy usages",
    "start": "939040",
    "end": "947360"
  },
  {
    "text": "were okay meaning the length of source was compared with",
    "start": "947360",
    "end": "953920"
  },
  {
    "text": "the length of destination in all cases i'm not sure why haven't they used safe",
    "start": "953920",
    "end": "961440"
  },
  {
    "text": "string n copy function then you have this",
    "start": "961440",
    "end": "966839"
  },
  {
    "text": "system function which is kind of unsafe due to a couple",
    "start": "966839",
    "end": "972800"
  },
  {
    "text": "of reasons and i was focused on that",
    "start": "972800",
    "end": "978480"
  },
  {
    "text": "during the reverse engineering i was following the bottom up procedure",
    "start": "978480",
    "end": "986320"
  },
  {
    "start": "979000",
    "end": "979000"
  },
  {
    "text": "so as i looked when and how uh the system",
    "start": "986320",
    "end": "992639"
  },
  {
    "text": "function call is executed and discovered that",
    "start": "992639",
    "end": "997759"
  },
  {
    "text": "a weird situation in which the developers of that tool",
    "start": "997759",
    "end": "1004959"
  },
  {
    "text": "built the string at runtime and then execute",
    "start": "1004959",
    "end": "1013440"
  },
  {
    "text": "the command which looks like following",
    "start": "1013600",
    "end": "1019920"
  },
  {
    "text": "so if you would find the",
    "start": "1020880",
    "end": "1026640"
  },
  {
    "text": "part of the string marked here mark marked here as in the red color",
    "start": "1026640",
    "end": "1033678"
  },
  {
    "text": "if you could control this you would eventually own this process",
    "start": "1033679",
    "end": "1039918"
  },
  {
    "text": "and and that's what this is what happened actually there",
    "start": "1039919",
    "end": "1045678"
  },
  {
    "text": "but again since this is in the trust boundary",
    "start": "1045679",
    "end": "1050799"
  },
  {
    "text": "it doesn't say you that this is the security vulnerability anyway it gives me uh",
    "start": "1050799",
    "end": "1057200"
  },
  {
    "text": "knowledge about possibly on how the whole package is implemented",
    "start": "1057200",
    "end": "1064400"
  },
  {
    "start": "1063000",
    "end": "1063000"
  },
  {
    "text": "so in here i want to show you a threat model which we were using",
    "start": "1064400",
    "end": "1072880"
  },
  {
    "text": "in our solution at intel",
    "start": "1072880",
    "end": "1078559"
  },
  {
    "text": "we had this product which was cloud-based",
    "start": "1078640",
    "end": "1085120"
  },
  {
    "text": "and the main security objective was that we were not trusting",
    "start": "1085120",
    "end": "1093360"
  },
  {
    "text": "the cloud service provider and to implement that threat model we",
    "start": "1093360",
    "end": "1099919"
  },
  {
    "text": "have used this particular hsm so",
    "start": "1099919",
    "end": "1106640"
  },
  {
    "text": "the threat model is as follows on the left hand side we do have",
    "start": "1106640",
    "end": "1112320"
  },
  {
    "text": "a trusted boundary in which we do develop our business logic code and then",
    "start": "1112320",
    "end": "1120080"
  },
  {
    "text": "we deploy this to the hsm on the right hand side you you can see",
    "start": "1120080",
    "end": "1126799"
  },
  {
    "text": "how it works upon the java archive",
    "start": "1126799",
    "end": "1133200"
  },
  {
    "text": "is deployed on the file system it is verified",
    "start": "1133200",
    "end": "1139039"
  },
  {
    "text": "cryptographically and if it's not the jar is rejected or removed",
    "start": "1139039",
    "end": "1144960"
  },
  {
    "text": "but if it satisfies the crypto then the the java archive is placed in",
    "start": "1144960",
    "end": "1152720"
  },
  {
    "text": "the either app storage or in the meta files",
    "start": "1152720",
    "end": "1158960"
  },
  {
    "text": "there are two separate deployment paths which we will be",
    "start": "1158960",
    "end": "1165360"
  },
  {
    "text": "abusing during this lecture",
    "start": "1165360",
    "end": "1170400"
  },
  {
    "text": "so any kind of modification done by the untrusted environment",
    "start": "1170480",
    "end": "1178480"
  },
  {
    "text": "in this scenario it would be the cloud service provider should be catched by",
    "start": "1178480",
    "end": "1185360"
  },
  {
    "text": "the digital signature scheme verification",
    "start": "1185360",
    "end": "1192440"
  },
  {
    "start": "1194000",
    "end": "1194000"
  },
  {
    "text": "let's see then what is the java archive and how",
    "start": "1194080",
    "end": "1199280"
  },
  {
    "text": "the signature is implemented in it the java archive is",
    "start": "1199280",
    "end": "1204880"
  },
  {
    "text": "a simple zip file it has",
    "start": "1204880",
    "end": "1210799"
  },
  {
    "text": "interesting properties because of that zip archive doesn't have metadata for",
    "start": "1210799",
    "end": "1217200"
  },
  {
    "text": "any kind of crypto so the crypto is embedded into that archive",
    "start": "1217200",
    "end": "1224720"
  },
  {
    "text": "other interesting fact is that it the technology allows you to have multiple",
    "start": "1225760",
    "end": "1231120"
  },
  {
    "text": "signatures done by separate organizations or developers",
    "start": "1231120",
    "end": "1238480"
  },
  {
    "text": "um and what's the weirdest is that for me",
    "start": "1238640",
    "end": "1244080"
  },
  {
    "text": "is that the this technology allows you to have partially signed",
    "start": "1244080",
    "end": "1250559"
  },
  {
    "text": "archive let's see what could be possibly done",
    "start": "1250559",
    "end": "1257919"
  },
  {
    "text": "with that the jar signature",
    "start": "1257919",
    "end": "1264159"
  },
  {
    "start": "1259000",
    "end": "1259000"
  },
  {
    "text": "is depicted down here on this slide",
    "start": "1264159",
    "end": "1270000"
  },
  {
    "text": "on the left hand side we have unsigned java archive which has two",
    "start": "1270000",
    "end": "1278559"
  },
  {
    "text": "java classes java byte codes full and bar classes which are described in the manifest file",
    "start": "1279440",
    "end": "1287520"
  },
  {
    "text": "the segment java archive has additional two files embedded into",
    "start": "1287520",
    "end": "1294559"
  },
  {
    "text": "the archive let's see what these contain",
    "start": "1294559",
    "end": "1300640"
  },
  {
    "start": "1299000",
    "end": "1299000"
  },
  {
    "text": "so the manifest contains along the things that i will describe",
    "start": "1301200",
    "end": "1308320"
  },
  {
    "text": "the manifest attributes the then they have",
    "start": "1308320",
    "end": "1314480"
  },
  {
    "text": "um these entries for each",
    "start": "1314480",
    "end": "1320400"
  },
  {
    "text": "file so the entry is composed of the dictionary in which",
    "start": "1320400",
    "end": "1325520"
  },
  {
    "text": "you define the path to the java class and",
    "start": "1325520",
    "end": "1330880"
  },
  {
    "text": "the hash of the content of that file",
    "start": "1330880",
    "end": "1336400"
  },
  {
    "text": "the signature file on the other hand looks very similar to the manifest and has",
    "start": "1336400",
    "end": "1345200"
  },
  {
    "text": "a hash of the entire entry",
    "start": "1345200",
    "end": "1350799"
  },
  {
    "text": "this procedure is repeated for all files and the signature block is the actual",
    "start": "1351520",
    "end": "1358840"
  },
  {
    "text": "signature raw bytes from the signature file",
    "start": "1358840",
    "end": "1364320"
  },
  {
    "text": "so it means if you will modify either manifest or",
    "start": "1364320",
    "end": "1371520"
  },
  {
    "text": "java file or signature file then",
    "start": "1371760",
    "end": "1376880"
  },
  {
    "text": "this should be cached by the",
    "start": "1376880",
    "end": "1381679"
  },
  {
    "text": "digital signature scheme of jvm",
    "start": "1382159",
    "end": "1389320"
  },
  {
    "text": "let's see how the signature is verified",
    "start": "1389440",
    "end": "1395520"
  },
  {
    "text": "by using the jar signer jar signer is a tool",
    "start": "1395520",
    "end": "1400720"
  },
  {
    "text": "which could be used in this purpose you can see that",
    "start": "1400720",
    "end": "1406640"
  },
  {
    "text": "the rigid mat sign jar is verified though it contains some warning",
    "start": "1406799",
    "end": "1413760"
  },
  {
    "text": "describing wrong usage of certificates which are not relevant here the relevant",
    "start": "1414159",
    "end": "1420000"
  },
  {
    "text": "the relevancy starts at this time at this point",
    "start": "1420000",
    "end": "1425840"
  },
  {
    "start": "1422000",
    "end": "1422000"
  },
  {
    "text": "um the very first line updates sign the jar with the",
    "start": "1425840",
    "end": "1432799"
  },
  {
    "text": "random file and the jar sign verifies the signature",
    "start": "1432799",
    "end": "1439919"
  },
  {
    "text": "the weird thing is that the jar signer claims that the jar is",
    "start": "1439919",
    "end": "1445039"
  },
  {
    "text": "verified and it's chosen warning that",
    "start": "1445039",
    "end": "1451039"
  },
  {
    "text": "say that you have unsigned portion of the",
    "start": "1451039",
    "end": "1456840"
  },
  {
    "text": "archive so i was wondering how",
    "start": "1456840",
    "end": "1463279"
  },
  {
    "start": "1461000",
    "end": "1461000"
  },
  {
    "text": "the hsm treats this warning so i updated the legitimate signed",
    "start": "1463279",
    "end": "1469679"
  },
  {
    "text": "legitimate signed a java archive with static content",
    "start": "1469679",
    "end": "1475520"
  },
  {
    "text": "and hsn executed the the code",
    "start": "1475520",
    "end": "1480799"
  },
  {
    "text": "so at that time i was sure that they could possibly not treat this warning as",
    "start": "1480799",
    "end": "1486000"
  },
  {
    "text": "an error but from static content you cannot execute code right",
    "start": "1486000",
    "end": "1493840"
  },
  {
    "text": "so i have decomposed the java archive in terms of the java byte",
    "start": "1493840",
    "end": "1500880"
  },
  {
    "text": "code and found that they have",
    "start": "1500880",
    "end": "1505600"
  },
  {
    "text": "business logic code hsmrp access layer and fired by the code which",
    "start": "1506080",
    "end": "1511630"
  },
  {
    "text": "[Music] the spring boot spring boot is a framework for developing",
    "start": "1511630",
    "end": "1519200"
  },
  {
    "text": "web services in java let's see what could be done",
    "start": "1519200",
    "end": "1525520"
  },
  {
    "text": "if you have the spring boot so the spring boot has the phenomena",
    "start": "1525520",
    "end": "1530880"
  },
  {
    "text": "called annotations these are here for",
    "start": "1530880",
    "end": "1536400"
  },
  {
    "text": "rapidly for the rapid defining of new http endpoints",
    "start": "1536400",
    "end": "1543520"
  },
  {
    "text": "by having just a new file",
    "start": "1543520",
    "end": "1548799"
  },
  {
    "text": "embedded to the java archive so the equation is",
    "start": "1548799",
    "end": "1554840"
  },
  {
    "text": "that this could work and yeah it it worked so",
    "start": "1554840",
    "end": "1563759"
  },
  {
    "text": "the first attack was to inject a springboard class in a proper place and this allowed",
    "start": "1565120",
    "end": "1572640"
  },
  {
    "text": "for a code execution which actually invalidated",
    "start": "1572640",
    "end": "1578000"
  },
  {
    "text": "my threat model in the first place we have contacted the vendor at that",
    "start": "1578000",
    "end": "1586080"
  },
  {
    "text": "time but mean in the meanwhile we were thinking about",
    "start": "1586080",
    "end": "1593039"
  },
  {
    "text": "the mitigations so one can disable spring annotations but",
    "start": "1593039",
    "end": "1600320"
  },
  {
    "text": "as you can this as you will discover this is not sufficient um",
    "start": "1600320",
    "end": "1605440"
  },
  {
    "text": "one can also propose a safe self examining java archive",
    "start": "1605440",
    "end": "1612640"
  },
  {
    "text": "executed in spring context but it's also not sufficient",
    "start": "1612640",
    "end": "1620080"
  },
  {
    "text": "let's see why so on the left hand side we have this",
    "start": "1620720",
    "end": "1626559"
  },
  {
    "start": "1622000",
    "end": "1622000"
  },
  {
    "text": "sign jar archive legitimate java archive",
    "start": "1626559",
    "end": "1632000"
  },
  {
    "text": "since it's a zip file you can do this trick you can duplicate the spring",
    "start": "1632000",
    "end": "1639679"
  },
  {
    "text": "the entire springbook in your application and test this against the hsm so",
    "start": "1639679",
    "end": "1648559"
  },
  {
    "text": "during the deployment phase there are two stages the first is the for the storage and",
    "start": "1648559",
    "end": "1655440"
  },
  {
    "text": "this is where the java uh actually verifies the signature",
    "start": "1655440",
    "end": "1663039"
  },
  {
    "text": "and at this time you can you have partially signed java archive",
    "start": "1663039",
    "end": "1668960"
  },
  {
    "text": "which hsm happily approve then we have this execution and during",
    "start": "1668960",
    "end": "1674640"
  },
  {
    "text": "that execution the java archive is extracted in the memory",
    "start": "1674640",
    "end": "1681200"
  },
  {
    "text": "and sadly for us at that time the",
    "start": "1681200",
    "end": "1687120"
  },
  {
    "text": "adversarial springboot override the legitimate ones so",
    "start": "1687120",
    "end": "1694640"
  },
  {
    "text": "the self-examining jar archive from the in the springboot context is not sufficient",
    "start": "1694640",
    "end": "1701600"
  },
  {
    "text": "at all",
    "start": "1701600",
    "end": "1704080"
  },
  {
    "start": "1704000",
    "end": "1704000"
  },
  {
    "text": "so what i have just described was the attack with",
    "start": "1706799",
    "end": "1714480"
  },
  {
    "text": "with patching the zip archive with duplicated entries",
    "start": "1714480",
    "end": "1719600"
  },
  {
    "text": "and so the mitigation we discovered during the considerations was that",
    "start": "1719600",
    "end": "1727039"
  },
  {
    "text": "we cannot override the main class of the java archive with that",
    "start": "1727039",
    "end": "1734720"
  },
  {
    "text": "view main class so we propose to have the main class which",
    "start": "1734720",
    "end": "1742000"
  },
  {
    "text": "actually verifies the java archive with if it has unsigned",
    "start": "1742000",
    "end": "1748960"
  },
  {
    "text": "code in it and then if it doesn't have such anomalies then the",
    "start": "1748960",
    "end": "1755200"
  },
  {
    "text": "code executes there was",
    "start": "1755200",
    "end": "1761039"
  },
  {
    "text": "also this threat when",
    "start": "1761039",
    "end": "1767120"
  },
  {
    "text": "the cloud service provider could do this right so if they would have the ability to",
    "start": "1767120",
    "end": "1773520"
  },
  {
    "text": "execute the arbitrary code in the hsm",
    "start": "1773520",
    "end": "1778799"
  },
  {
    "text": "they could perform a signing oracle attack or disclose any",
    "start": "1778799",
    "end": "1785360"
  },
  {
    "text": "kind of information perhaps perform the denial of service attack",
    "start": "1785360",
    "end": "1791120"
  },
  {
    "text": "also but there was also",
    "start": "1791120",
    "end": "1796799"
  },
  {
    "start": "1792000",
    "end": "1792000"
  },
  {
    "text": "the other deployment path for the metadata only",
    "start": "1796799",
    "end": "1803919"
  },
  {
    "text": "it came with the similar technology and similar problem the",
    "start": "1803919",
    "end": "1809840"
  },
  {
    "text": "feature the security feature they had is the antipath travel cell",
    "start": "1809840",
    "end": "1815279"
  },
  {
    "text": "which was here to prevent the adversarial movements",
    "start": "1815279",
    "end": "1820559"
  },
  {
    "text": "by having flattening the archive upon extraction",
    "start": "1820880",
    "end": "1826799"
  },
  {
    "text": "so in order to override the legitimate config file",
    "start": "1826799",
    "end": "1832480"
  },
  {
    "text": "which was deployed through this path you simply",
    "start": "1832480",
    "end": "1838000"
  },
  {
    "text": "follow the zip archive let's say hack by",
    "start": "1838000",
    "end": "1844240"
  },
  {
    "text": "putting the evil app config file above the legitimate one",
    "start": "1844240",
    "end": "1851120"
  },
  {
    "text": "so the mitigation was of course to make those files flat always",
    "start": "1851120",
    "end": "1856799"
  },
  {
    "start": "1856000",
    "end": "1856000"
  },
  {
    "text": "we've we have also a failed attempt",
    "start": "1856799",
    "end": "1862799"
  },
  {
    "text": "uh mostly with i was trying with manifest overwrite and also we tried",
    "start": "1862840",
    "end": "1870880"
  },
  {
    "text": "um so-called self-signed java archive and as i told you before the main class",
    "start": "1870880",
    "end": "1876880"
  },
  {
    "text": "override doesn't work either we have contacted jamalto in 2019",
    "start": "1876880",
    "end": "1888039"
  },
  {
    "start": "1880000",
    "end": "1880000"
  },
  {
    "text": "and oracle as well gemalto had",
    "start": "1888240",
    "end": "1893760"
  },
  {
    "text": "following comment for us i will let you read",
    "start": "1893760",
    "end": "1900880"
  },
  {
    "text": "this comment so you could have your own feeling about this",
    "start": "1901760",
    "end": "1908080"
  },
  {
    "text": "after i have described this",
    "start": "1910240",
    "end": "1915279"
  },
  {
    "text": "situation to my teammates uh i remember this because",
    "start": "1915279",
    "end": "1921919"
  },
  {
    "text": "um this was funny we uh one of us was sitting and",
    "start": "1921919",
    "end": "1927760"
  },
  {
    "text": "it was like hey this is java problem no it's the amount of problem",
    "start": "1927760",
    "end": "1936240"
  },
  {
    "text": "no it's spring and our problem no it's java problem",
    "start": "1936240",
    "end": "1941290"
  },
  {
    "text": "[Music] at that time we were not sure by now i think",
    "start": "1941290",
    "end": "1947039"
  },
  {
    "text": "that none of those",
    "start": "1947039",
    "end": "1952320"
  },
  {
    "text": "parties made mistake the problem here is that",
    "start": "1952320",
    "end": "1958000"
  },
  {
    "text": "the security of that solution is an opt in",
    "start": "1958000",
    "end": "1965360"
  },
  {
    "text": "and this will eventually explode everywhere as long as we do",
    "start": "1965360",
    "end": "1972000"
  },
  {
    "text": "security as an opt-in the security should be",
    "start": "1972000",
    "end": "1977519"
  },
  {
    "text": "sorry the insecurity should be an opt out if you",
    "start": "1977519",
    "end": "1982880"
  },
  {
    "text": "are willing to that will be",
    "start": "1982880",
    "end": "1988320"
  },
  {
    "text": "all from my site if you have any questions please",
    "start": "1988320",
    "end": "1994080"
  },
  {
    "text": "have a time for that [Music]",
    "start": "1994080",
    "end": "2002110"
  },
  {
    "text": "[Applause]",
    "start": "2002110",
    "end": "2005250"
  },
  {
    "text": "you",
    "start": "2007360",
    "end": "2009440"
  }
]