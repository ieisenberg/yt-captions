[
  {
    "text": "thanks very much for coming uh my name is david litchfield i currently work for ngs software uh that's about to end in",
    "start": "240",
    "end": "7040"
  },
  {
    "text": "about an hour's time though so this is my last gig as uh ngs software",
    "start": "7040",
    "end": "12400"
  },
  {
    "text": "um today we're clearly going to be speaking about hacking oracle 11g we're going to be looking at a couple of",
    "start": "12400",
    "end": "18640"
  },
  {
    "text": "new attacks that unfortunately haven't been patched yet but oracle have been informed i was hoping they were going to be patched in",
    "start": "18640",
    "end": "25760"
  },
  {
    "text": "the july cpu but we'll talk about that more in a minute so",
    "start": "25760",
    "end": "31840"
  },
  {
    "text": "the fundamental point behind this presentation is to ask the question has oracle's security posture changed over",
    "start": "32399",
    "end": "37520"
  },
  {
    "text": "the past few years and you know where does it stand today",
    "start": "37520",
    "end": "42718"
  },
  {
    "text": "so how easy is it to hack oracle 11g well we'll see in a minute it's quite easy but it's harder as we'll see in",
    "start": "42840",
    "end": "50640"
  },
  {
    "text": "conclusion than hacking say oracle 10g release two so we'll look at some comparisons we'll also look at um",
    "start": "50640",
    "end": "57440"
  },
  {
    "text": "oracle versus sql server 2005 and 2008 and see if there's any",
    "start": "57440",
    "end": "63280"
  },
  {
    "text": "conclusions that can be drawn as to security posture from there and we'll talk about the flaws do a",
    "start": "63280",
    "end": "69119"
  },
  {
    "text": "couple of demos exploiting these flaws showing you know what can happen in terms of ramifications as stated their complete",
    "start": "69119",
    "end": "75520"
  },
  {
    "text": "earnage and discuss risk mitigation because obviously giving you the problem without the solution is not ideal so we'll talk",
    "start": "75520",
    "end": "82479"
  },
  {
    "text": "about that at the end and then finally answer the question has oracle security posture actually changed",
    "start": "82479",
    "end": "90000"
  },
  {
    "text": "i take it um well just quick show of hands does anybody not know about my sort of fight",
    "start": "90479",
    "end": "97439"
  },
  {
    "text": "with oracle over the past few years any show of hands okay that's quite right so",
    "start": "97439",
    "end": "102560"
  },
  {
    "text": "oracle and i have been bashing heads against each other for crumbs since larry allison said his product was",
    "start": "102560",
    "end": "109200"
  },
  {
    "text": "unbreakable and i i yeah took a bit of umbrage with that and decided to to take",
    "start": "109200",
    "end": "115200"
  },
  {
    "text": "a look at oracle previous to that my work had been more in sql server and so",
    "start": "115200",
    "end": "120320"
  },
  {
    "text": "yeah it's like waving a red flag to a bill i guess saying your product's unbreakable so",
    "start": "120320",
    "end": "125840"
  },
  {
    "text": "yeah my relationship with oracle publicly has not been uh the best let's say uh at one",
    "start": "125840",
    "end": "132480"
  },
  {
    "text": "point i actually called for the cso's resignation uh on bugtrack because i think at the time there were massive",
    "start": "132480",
    "end": "139360"
  },
  {
    "text": "failures within oracle their patching was atrocious um they would",
    "start": "139360",
    "end": "145280"
  },
  {
    "text": "patch one thing um and miss a bug two lines under the patch you know to in",
    "start": "145280",
    "end": "150720"
  },
  {
    "text": "in the code or alternatively they their patch would prevent the exploit but not",
    "start": "150720",
    "end": "155760"
  },
  {
    "text": "actually address the problem so for example one of the proof of concepts i sent them had a space in it you know the",
    "start": "155760",
    "end": "162080"
  },
  {
    "text": "sequel had a space in it and so they checked the input to see if there was a space in the input and denied uh you",
    "start": "162080",
    "end": "169360"
  },
  {
    "text": "know the request if there was a space but if there wasn't a space it went through well we don't need a space we just go angle bracket star star angle",
    "start": "169360",
    "end": "176080"
  },
  {
    "text": "bracket no angle bracket uh slash rather you know and make a comment so we don't actually need a space in in the exploit",
    "start": "176080",
    "end": "182400"
  },
  {
    "text": "so with a simple modification of the exploit you know that the patch is broken sometimes",
    "start": "182400",
    "end": "187760"
  },
  {
    "text": "oracle would take five years and 15 patches to attempt to fix one single",
    "start": "187760",
    "end": "193519"
  },
  {
    "text": "issue well that's a small exaggeration not 15 patches it was actually five patches but still it's a",
    "start": "193519",
    "end": "198800"
  },
  {
    "text": "significant number um you know to fix one small thing it took five patches in five years and i think that's",
    "start": "198800",
    "end": "204959"
  },
  {
    "text": "that was atrocious you know so i'm going to reserve my judgment on whether oracle has actually made any improvements",
    "start": "204959",
    "end": "210319"
  },
  {
    "text": "obviously because that's the basis of this talk so since oracle 11 g um",
    "start": "210319",
    "end": "218319"
  },
  {
    "text": "has has been released uh release two has since come out um and there are no um security flaws in",
    "start": "218319",
    "end": "226000"
  },
  {
    "text": "uh 11g release two which have been patched yet there are flaws obviously because i'm waiting on some being fixed",
    "start": "226000",
    "end": "231519"
  },
  {
    "text": "and the flaws we'll be speaking about today affect oracle 11g release too but the only stats we have available in",
    "start": "231519",
    "end": "237200"
  },
  {
    "text": "stats or everything in this business are for 11g release one so it was released basically um at the beginning of 2008",
    "start": "237200",
    "end": "244400"
  },
  {
    "text": "end of 2007. i can't remember which but the first set of patches came out in july",
    "start": "244400",
    "end": "249840"
  },
  {
    "text": "in january 2008 and it patched one floor the next cpu came out in april and you",
    "start": "249840",
    "end": "256560"
  },
  {
    "text": "can see five floors were patched in 11g release one and then so on and up and down and up and down so since then 48",
    "start": "256560",
    "end": "263600"
  },
  {
    "text": "have been acknowledged in oracle's critical patches patch updates some of these are critical like the last one",
    "start": "263600",
    "end": "270240"
  },
  {
    "text": "uh there uh you know january 2010 on a cbss score that scored a whopping",
    "start": "270240",
    "end": "276960"
  },
  {
    "text": "10 in other words complete compromise of the server that's on a windows system on a linux",
    "start": "276960",
    "end": "282960"
  },
  {
    "text": "system obviously because oracle does not run as uh super as the super user it runs as the oracle user it's not a",
    "start": "282960",
    "end": "288400"
  },
  {
    "text": "complete compromise uh but it you know as far as the database and the data is concerned it it you know it's definitely",
    "start": "288400",
    "end": "294400"
  },
  {
    "text": "a an epic fail some of these are for minor trivial",
    "start": "294400",
    "end": "299440"
  },
  {
    "text": "issues you know barely warranting a score on cvss so for example one of them",
    "start": "299440",
    "end": "304479"
  },
  {
    "text": "was because the with 11g basically you can change the",
    "start": "304479",
    "end": "310639"
  },
  {
    "text": "old traditional password uh mechanism to the new super duper one using um sha-1",
    "start": "310639",
    "end": "316479"
  },
  {
    "text": "hashes but if you do that it's impossible to track password history so",
    "start": "316479",
    "end": "322080"
  },
  {
    "text": "for things like pci compliance when you know one of the the points is to to track password history because they're",
    "start": "322080",
    "end": "327919"
  },
  {
    "text": "using new uh hashes you can't track password history so they've had to modify the code to actually to fix that",
    "start": "327919",
    "end": "333759"
  },
  {
    "text": "so that barely warrants one of these squares but the point is it's in the cpu so it has to go in the square there are",
    "start": "333759",
    "end": "339199"
  },
  {
    "text": "a couple of missing boxes um because it affected oracle enterprise manager so whilst you know enterprise manager is",
    "start": "339199",
    "end": "345680"
  },
  {
    "text": "installed with the oracle database server i didn't include them there because i just wanted to actually look at the rdbms itself",
    "start": "345680",
    "end": "353199"
  },
  {
    "text": "so how does that compare oh sorry yeah before we go on um there's a big question as to whether oracle silently",
    "start": "353199",
    "end": "359759"
  },
  {
    "text": "flick flicks fix flaws or not and they do okay bottom line is they do because i",
    "start": "359759",
    "end": "365360"
  },
  {
    "text": "found them they say they don't i've found them other people have found them so let's get over this whole argument yes oracle silently fixed flaws and big",
    "start": "365360",
    "end": "372479"
  },
  {
    "text": "deal so what you know if they if if they didn't silently fix floors uh fixed",
    "start": "372479",
    "end": "378000"
  },
  {
    "text": "floors these grass would be through the roof you know and the my slides aren't big enough to hold that you know it'd be",
    "start": "378000",
    "end": "383360"
  },
  {
    "text": "like al gore when he gets on his weak crane and goes up and shows the uh the temperature differences with uh carbon",
    "start": "383360",
    "end": "389680"
  },
  {
    "text": "dioxide in the air and everything you know it literally would be through the roof so i don't care if if oracle",
    "start": "389680",
    "end": "394800"
  },
  {
    "text": "silently flick fix floors i can't say that flicks floors fix floors um",
    "start": "394800",
    "end": "400400"
  },
  {
    "text": "so for example there is a buffer overflow in dbms java test which",
    "start": "400400",
    "end": "406960"
  },
  {
    "text": "tenji affected two and released one and that was fixed in july 2007 but it also affected god",
    "start": "406960",
    "end": "412400"
  },
  {
    "text": "knows how it got into the code but also affected 11g release one but their first patch basically fixed it",
    "start": "412400",
    "end": "418880"
  },
  {
    "text": "you know but they didn't announce that you know this was being patched but it's not a big deal as far as i'm",
    "start": "418880",
    "end": "424160"
  },
  {
    "text": "concerned so if we look at oracle 10g release 2",
    "start": "424160",
    "end": "429919"
  },
  {
    "text": "this is how many bugs have been fixed in their cpus you know publicly acknowledged bugs",
    "start": "429919",
    "end": "435520"
  },
  {
    "text": "if we look at the first two years 2006 2007 for a comparison we can see there's a vast improvement in",
    "start": "435520",
    "end": "441199"
  },
  {
    "text": "11g release one over there so in the first nine quarters um",
    "start": "441199",
    "end": "447280"
  },
  {
    "text": "since 10g release two uh was released 73 floors were fixed and acknowledged um with 11g 48 have been you know fixed",
    "start": "447280",
    "end": "456160"
  },
  {
    "text": "in the first nine quarters that represents um you know a drop of 35 percent which is",
    "start": "456160",
    "end": "461919"
  },
  {
    "text": "actually really you know well done when microsoft turned around and compared bugs found in the first quarter or or",
    "start": "461919",
    "end": "469199"
  },
  {
    "text": "first year of xp versus vista i think the drop was about 35 as well so that's",
    "start": "469199",
    "end": "474639"
  },
  {
    "text": "within you know if you know industry norm when when we look at the world and ask the question is you",
    "start": "474639",
    "end": "481520"
  },
  {
    "text": "know is software getting more secure is it is its robustness you know improving",
    "start": "481520",
    "end": "486560"
  },
  {
    "text": "uh a drop of 35 between major revisions i think is is a good good hit basically",
    "start": "486560",
    "end": "492160"
  },
  {
    "text": "so they've done really well on that i also spoke about some of those flaws",
    "start": "492160",
    "end": "497280"
  },
  {
    "text": "in you know that graph for oracle 11g some of them being for such pants issues as you know like password history",
    "start": "497280",
    "end": "503520"
  },
  {
    "text": "tracking it's not going to allow someone to own your system but it's still on there so the severity are also down for",
    "start": "503520",
    "end": "508800"
  },
  {
    "text": "these things there are far fewer sql injection floors in 11g release one they've done superbly well they've that",
    "start": "508800",
    "end": "514959"
  },
  {
    "text": "their tool their flow analysis tool has done a great job of finding",
    "start": "514959",
    "end": "521039"
  },
  {
    "text": "probably 99 of um all sql injection floors in in 11g release one and i think that's really",
    "start": "521039",
    "end": "527279"
  },
  {
    "text": "great but for overflows not so great there's there's still a couple kicking around but i tell you what's a damn sight",
    "start": "527279",
    "end": "533360"
  },
  {
    "text": "better than previous versions of oracle especially like back in the oracle nine days and so on you just had to look at",
    "start": "533360",
    "end": "539279"
  },
  {
    "text": "oracle to exploit a buffer overflow uh in those days um",
    "start": "539279",
    "end": "545519"
  },
  {
    "text": "the fact that there are fewer high risk critical flaws begs the question is",
    "start": "545519",
    "end": "550800"
  },
  {
    "text": "there toolkit is there tool chest actually doing you know what's expected of it",
    "start": "550800",
    "end": "556399"
  },
  {
    "text": "there are still some areas where they need to improve and we'll obviously uh talk about that and why these flaws are",
    "start": "556399",
    "end": "562640"
  },
  {
    "text": "actually in there this graph is for sql server 2005.",
    "start": "562640",
    "end": "570640"
  },
  {
    "text": "that's been around for as long as 10g release 2 and that's how many flaws have been fixed and found",
    "start": "570640",
    "end": "577040"
  },
  {
    "text": "in microsoft sql server 2005. just want to compare that with a product that's been around for",
    "start": "577040",
    "end": "583839"
  },
  {
    "text": "a shorter amount of time so we can see sql server has done really really well",
    "start": "583839",
    "end": "590160"
  },
  {
    "text": "the sql team have done really really well there now people will say ah but you know no one's obviously looking this",
    "start": "590160",
    "end": "596640"
  },
  {
    "text": "microsoft we're talking about you know we had an argument about this at the you know the beers last night you know one",
    "start": "596640",
    "end": "602480"
  },
  {
    "text": "of the chaps was like yeah but it just says that people aren't actually looking for bugs well it's nonsense this is microsoft find a no day in sql server",
    "start": "602480",
    "end": "609680"
  },
  {
    "text": "2005 and you'll be able to sell it to our defense for a hundred thousand pounds probably you know so people are",
    "start": "609680",
    "end": "615200"
  },
  {
    "text": "looking um for floors in micro microsoft sql server um it's just that they are so few and far between and sql server 2008",
    "start": "615200",
    "end": "623440"
  },
  {
    "text": "been around for as long as oracle 11g released one zero security flaws so again i think microsoft have to be",
    "start": "623440",
    "end": "630320"
  },
  {
    "text": "applauded on that score not so great on ie i guess at the moment",
    "start": "630320",
    "end": "636399"
  },
  {
    "text": "but um definitely definitely brilliant uh work done with the sql team",
    "start": "636399",
    "end": "642880"
  },
  {
    "text": "so context established you know giving oracle their pat on the back and saying um well done oracle you have made vast",
    "start": "644160",
    "end": "651279"
  },
  {
    "text": "improvements there is still obviously a bit of a way to go um so let's look at uh some of these new flaws and ask the",
    "start": "651279",
    "end": "658320"
  },
  {
    "text": "question why are these flaws in the code and what can be done to improve their",
    "start": "658320",
    "end": "663440"
  },
  {
    "text": "processes to make sure oracle alert 11h or whatever it happens to be when that comes out has again 35 fewer",
    "start": "663440",
    "end": "671440"
  },
  {
    "text": "than 11g release one so within oracle there is a virtual machine",
    "start": "671440",
    "end": "678560"
  },
  {
    "text": "a java virtual machine and oracle termit aurora and um",
    "start": "678560",
    "end": "684959"
  },
  {
    "text": "this the surrounding infrastructure behind the way they implement that virtual machine i've spent the past few",
    "start": "684959",
    "end": "691040"
  },
  {
    "text": "months looking at basically to find holes in there and have a good poke around in there",
    "start": "691040",
    "end": "696959"
  },
  {
    "text": "now as part of an upgrade if you're upgrading you know one database server",
    "start": "696959",
    "end": "703279"
  },
  {
    "text": "to another version there are some tools available to allow you to do that part of the data",
    "start": "703279",
    "end": "709440"
  },
  {
    "text": "pump suite of tools and it's installed by default and one of these packages is known as dbms jvm ex",
    "start": "709440",
    "end": "717360"
  },
  {
    "text": "experiments export permissions and that has a procedure called import jvm perms now what that does basically",
    "start": "717360",
    "end": "724560"
  },
  {
    "text": "is we provide it a list of permissions and it basically updates the java policy",
    "start": "724560",
    "end": "730399"
  },
  {
    "text": "table i the policy table is where you know the security permissions for for",
    "start": "730399",
    "end": "735839"
  },
  {
    "text": "certain java actions are stored basically so if we want to read and write to the os you know files and so on",
    "start": "735839",
    "end": "742079"
  },
  {
    "text": "we need um an entry in this policy table to allow us to do that or if we want to execute arbitrary os commands",
    "start": "742079",
    "end": "748800"
  },
  {
    "text": "we you know have to have an entry in in this policy table now",
    "start": "748800",
    "end": "753839"
  },
  {
    "text": "the the thing is obviously being able to execute ice commands or um read and write to files that's a bad",
    "start": "753839",
    "end": "761120"
  },
  {
    "text": "thing so by default oracle doesn't allow users low privileges to do that kind of",
    "start": "761120",
    "end": "766480"
  },
  {
    "text": "stuff as as i should that's that's expected but there's there's a flaw there when they ship this package",
    "start": "766480",
    "end": "772480"
  },
  {
    "text": "basically they've given public the execute permissions on it uh execute permission on it so that means execute",
    "start": "772480",
    "end": "778959"
  },
  {
    "text": "can a public can execute this package provide their own you know",
    "start": "778959",
    "end": "784000"
  },
  {
    "text": "permissions and have the the java policy table updated and uh",
    "start": "784000",
    "end": "789519"
  },
  {
    "text": "yeah i'll show you this rather than whittle on about it i'll",
    "start": "789519",
    "end": "795199"
  },
  {
    "text": "do the demo so",
    "start": "796480",
    "end": "803519"
  },
  {
    "text": "the user we're going to be um attacking from is called gremlin",
    "start": "803519",
    "end": "809760"
  },
  {
    "text": "and i hope if i could spell",
    "start": "809760",
    "end": "816720"
  },
  {
    "text": "and if i show you what they've got can people see what i'm typing on on this screen back",
    "start": "816720",
    "end": "821760"
  },
  {
    "text": "here is the font big enough yeah select star from session privs",
    "start": "821760",
    "end": "829079"
  },
  {
    "text": "as you can see i've only got create session privileges i can't create procedures can't create tables can't do anything other than simply connect to",
    "start": "829839",
    "end": "836160"
  },
  {
    "text": "the database server session roles",
    "start": "836160",
    "end": "841360"
  },
  {
    "text": "no resected i gremlin has not been aside membership of any any roles so they're as as lonely as",
    "start": "841360",
    "end": "847120"
  },
  {
    "text": "they can possibly get basically this is um a user with pretty much zip missions",
    "start": "847120",
    "end": "853199"
  },
  {
    "text": "so i'm now going to log in as cis and show you that",
    "start": "853199",
    "end": "858240"
  },
  {
    "text": "gremlin has no java permissions specifically for him on",
    "start": "858240",
    "end": "864160"
  },
  {
    "text": "the dba java policy view that view basically just points to a table called java dollar policy dollar",
    "start": "864160",
    "end": "871040"
  },
  {
    "text": "if you're you know interested here we go java dollar policy",
    "start": "871040",
    "end": "876480"
  },
  {
    "text": "dollar so this here is where this is the table where the actual information is stored and the view",
    "start": "876480",
    "end": "882800"
  },
  {
    "text": "that accesses that as dba java policy now i'm going to log in as",
    "start": "882800",
    "end": "888399"
  },
  {
    "text": "um gremlin and grant myself these permissions",
    "start": "888399",
    "end": "894240"
  },
  {
    "text": "to the permissions to execute an arbitrary os command using this dbms java perms export perms",
    "start": "894240",
    "end": "902079"
  },
  {
    "text": "package so i'll quickly cut and paste it and describe what i'm doing",
    "start": "902079",
    "end": "908880"
  },
  {
    "text": "is there a laser pointer let me see",
    "start": "908880",
    "end": "913480"
  },
  {
    "text": "right excellent so um here we're basically",
    "start": "919040",
    "end": "925279"
  },
  {
    "text": "um creating a cursor for ourselves and selecting the entries what uh that that we need basically to",
    "start": "925279",
    "end": "931920"
  },
  {
    "text": "go into the policy table so we want the i o uh file commission on all files and",
    "start": "931920",
    "end": "937600"
  },
  {
    "text": "we want the execute okay because we're basically setting up so that we can",
    "start": "937600",
    "end": "942959"
  },
  {
    "text": "execute at some point uh an arbitrary ios command um and once we've done that we uh",
    "start": "942959",
    "end": "950800"
  },
  {
    "text": "execute the query fetch it into um the uh",
    "start": "950800",
    "end": "955839"
  },
  {
    "text": "this policy here and uh import the policy executing here dms java export perms",
    "start": "955839",
    "end": "962160"
  },
  {
    "text": "import the java permissions that we've just set up here once that's done obviously it says pl sql procedure",
    "start": "962160",
    "end": "968800"
  },
  {
    "text": "successfully completed so now let's log back in assist and actually see if we've",
    "start": "968800",
    "end": "974160"
  },
  {
    "text": "got those java permissions",
    "start": "974160",
    "end": "981480"
  },
  {
    "text": "okay so you can see now that previously we didn't have the you know gremlin didn't have the permission but now he",
    "start": "984079",
    "end": "990079"
  },
  {
    "text": "does he can execute uh any file he wants on the uh on the file system",
    "start": "990079",
    "end": "997040"
  },
  {
    "text": "that is if he can find a way of course to break out of the database server and execute commands because remember he's",
    "start": "997040",
    "end": "1003040"
  },
  {
    "text": "only got the create session privilege well is there a way rhetorical question of course there's a",
    "start": "1003040",
    "end": "1009360"
  },
  {
    "text": "way because it's oracle they always provide us the way",
    "start": "1009360",
    "end": "1015120"
  },
  {
    "text": "um running arbitrary os commands so he has the relevant permissions now uh but he",
    "start": "1015120",
    "end": "1020800"
  },
  {
    "text": "doesn't have the correct procedure privilege so if he did they could just simply you know do a create a java source named",
    "start": "1020800",
    "end": "1027760"
  },
  {
    "text": "whatever and and write java directly into you know the into the database uh",
    "start": "1027760",
    "end": "1033120"
  },
  {
    "text": "wrap it around the pl sql procedure and execute the os command that way but he doesn't have great uh procedure",
    "start": "1033120",
    "end": "1038880"
  },
  {
    "text": "privileges so he's stuck um but is there an excellent java class that will allow",
    "start": "1038880",
    "end": "1044240"
  },
  {
    "text": "um the a given user to to execute arbitrary commands so",
    "start": "1044240",
    "end": "1049520"
  },
  {
    "text": "the aurora basically is a one big zip file and it all gets unzipped and there's a whole load of jar classes who's heard of",
    "start": "1049520",
    "end": "1056240"
  },
  {
    "text": "uh jad at all it's like a java okay so using jad basically you can get the clear source code back out",
    "start": "1056240",
    "end": "1063280"
  },
  {
    "text": "from that and there's a class called wrapper where if we look through it here there's a",
    "start": "1063280",
    "end": "1069600"
  },
  {
    "text": "method main that takes string arguments and passes the arguments to this pass",
    "start": "1069600",
    "end": "1077600"
  },
  {
    "text": "args launcher and down here we get this runtime.gettime.exec.cmd so this",
    "start": "1077600",
    "end": "1084320"
  },
  {
    "text": "basically when we execute the main method we'll take the user's argument pass it to",
    "start": "1084320",
    "end": "1089760"
  },
  {
    "text": "this launcher and execute this os command basically so",
    "start": "1089760",
    "end": "1094799"
  },
  {
    "text": "let's reconnect as gremlin",
    "start": "1094799",
    "end": "1099120"
  },
  {
    "text": "and execute a command",
    "start": "1102480",
    "end": "1107799"
  },
  {
    "text": "before i execute it let's show there's drr out dot lst",
    "start": "1108640",
    "end": "1115600"
  },
  {
    "text": "there's no file called out.lst what i'm going to do here is this package this package here",
    "start": "1115600",
    "end": "1124400"
  },
  {
    "text": "uh dbms java has a a function called run java and what run",
    "start": "1124400",
    "end": "1130640"
  },
  {
    "text": "java does best it takes the name of a java class and executes its main",
    "start": "1130640",
    "end": "1137520"
  },
  {
    "text": "function and passes it whatever you know input you you pass it",
    "start": "1137520",
    "end": "1142559"
  },
  {
    "text": "and the specifics are it has to be the main function you know in other words if the",
    "start": "1142559",
    "end": "1148080"
  },
  {
    "text": "the java class doesn't have a main method then this run java would fail um",
    "start": "1148080",
    "end": "1155600"
  },
  {
    "text": "and uh it also has to have a specific uh you know method prototype and so on but",
    "start": "1155600",
    "end": "1160799"
  },
  {
    "text": "luckily enough well unl lucky enough for oracle uh this wrapper class has exactly",
    "start": "1160799",
    "end": "1166160"
  },
  {
    "text": "the you know what we need to to actually pass it to this run java so this basically is uh our attacker using this",
    "start": "1166160",
    "end": "1172799"
  },
  {
    "text": "dbms java package as a harness to get through to run an os command so hit enter looks like nothing has happened",
    "start": "1172799",
    "end": "1179600"
  },
  {
    "text": "but you know the file has now been created what we've done there is basically uh launched um",
    "start": "1179600",
    "end": "1187280"
  },
  {
    "text": "the command interpreter cmd.exe passed it the slash c argument that means basically run the single command dir",
    "start": "1187280",
    "end": "1193360"
  },
  {
    "text": "redirect the output to this file out.lst we could do whatever we want so if i go",
    "start": "1193360",
    "end": "1199120"
  },
  {
    "text": "net user gremlin we can see there's no user called",
    "start": "1199120",
    "end": "1205360"
  },
  {
    "text": "gremlin so let's go and create ourself obviously this is all going local on my",
    "start": "1205360",
    "end": "1212240"
  },
  {
    "text": "machine and everything but this is actually a remote attacker this is as if i was connected you know remotely to",
    "start": "1212240",
    "end": "1218720"
  },
  {
    "text": "an oracle server so i'm going to go",
    "start": "1218720",
    "end": "1222480"
  },
  {
    "text": "back down here no",
    "start": "1224240",
    "end": "1230000"
  },
  {
    "text": "user gremlin pass word",
    "start": "1230000",
    "end": "1235600"
  },
  {
    "text": "forward slash add see if this works so we've now created um",
    "start": "1235600",
    "end": "1242240"
  },
  {
    "text": "an operating system user by exploiting this floor so coming from zero privileges other than create session we",
    "start": "1242240",
    "end": "1247679"
  },
  {
    "text": "now can obviously add this to the local administrators group",
    "start": "1247679",
    "end": "1253200"
  },
  {
    "text": "net local group administrators",
    "start": "1253200",
    "end": "1261000"
  },
  {
    "text": "gremlin slash ad",
    "start": "1263120",
    "end": "1268400"
  },
  {
    "text": "and we can see now uh he's an administrator gremlins an administrator so we've just created an",
    "start": "1269520",
    "end": "1276080"
  },
  {
    "text": "operating system account and made him a local administrator so you can see um it's not very good",
    "start": "1276080",
    "end": "1283200"
  },
  {
    "text": "right what i'm looking for there we go so suffice it to say that i can run",
    "start": "1284400",
    "end": "1291440"
  },
  {
    "text": "arbitrarios command using this i cannot obviously do exactly the same thing to create you know uh files delete files",
    "start": "1291440",
    "end": "1297840"
  },
  {
    "text": "and and so on but i'm not gonna waste time doing that because there's much more exciting things to do okay",
    "start": "1297840",
    "end": "1304559"
  },
  {
    "text": "again hacking around the whole aurora place um great we own the operating system and everything like that but as",
    "start": "1304559",
    "end": "1310480"
  },
  {
    "text": "far as the database server is concerned we still only have create session privileges yeah",
    "start": "1310480",
    "end": "1315520"
  },
  {
    "text": "we're still that lowly little user what we want is to gain cis privileges or dba privileges so",
    "start": "1315520",
    "end": "1321919"
  },
  {
    "text": "here's how you do that this dbms java package the one that had the the",
    "start": "1321919",
    "end": "1327840"
  },
  {
    "text": "you know the run java function on it has a procedure called set output to java",
    "start": "1327840",
    "end": "1333440"
  },
  {
    "text": "now what this does basically is any output uh from you know to system.error and and so",
    "start": "1333440",
    "end": "1340080"
  },
  {
    "text": "on we can redirect that output uh to either another java session to sql or or",
    "start": "1340080",
    "end": "1346159"
  },
  {
    "text": "whatever now if we set it the output to another java session what happens is",
    "start": "1346159",
    "end": "1352240"
  },
  {
    "text": "the oracle database server kicks off another a java session with a new session state and so on but it does so",
    "start": "1352240",
    "end": "1359360"
  },
  {
    "text": "with the privileges of the cis user and that because this owns this dbms java package",
    "start": "1359360",
    "end": "1365039"
  },
  {
    "text": "so when this vm executes it's owned by cis so anything that happens in that new",
    "start": "1365039",
    "end": "1370799"
  },
  {
    "text": "vm session basically executes with cis privileges and as part of the um specification for",
    "start": "1370799",
    "end": "1378880"
  },
  {
    "text": "output to java it can take arbitrary sql to execute either before",
    "start": "1378880",
    "end": "1383919"
  },
  {
    "text": "or after you know the new vm receives the the uh the output so what we can do basically is inject",
    "start": "1383919",
    "end": "1390880"
  },
  {
    "text": "our well it's not really inject because we're not inserting anything into um",
    "start": "1390880",
    "end": "1396159"
  },
  {
    "text": "uh extant code what we're doing is just supplying lock stock and barrel full uh",
    "start": "1396159",
    "end": "1401840"
  },
  {
    "text": "sql to execute so let's um do this oh and that that sql will of course execute",
    "start": "1401840",
    "end": "1407600"
  },
  {
    "text": "with cis privileges so",
    "start": "1407600",
    "end": "1412158"
  },
  {
    "text": "just connectors gremlin",
    "start": "1413919",
    "end": "1419679"
  },
  {
    "text": "what i'm doing there basically is you know because we want to see output and stuff like that it's part of the hack we",
    "start": "1425120",
    "end": "1431280"
  },
  {
    "text": "need to set the output so then again",
    "start": "1431280",
    "end": "1437200"
  },
  {
    "text": "no roles awarded to us and there are no privileges other than the correct",
    "start": "1438159",
    "end": "1443600"
  },
  {
    "text": "session that's all about to change",
    "start": "1443600",
    "end": "1447440"
  },
  {
    "text": "so what what i'm about to do here is",
    "start": "1448880",
    "end": "1454000"
  },
  {
    "text": "this is the set output to java function we're about to execute this is irrelevant really we just need",
    "start": "1455039",
    "end": "1461279"
  },
  {
    "text": "something some class to execute and here is",
    "start": "1461279",
    "end": "1467679"
  },
  {
    "text": "the arbitrary sql we're executing declare pragma autonomous transaction that's a way of the tech",
    "start": "1467679",
    "end": "1474159"
  },
  {
    "text": "tricking the pl sql compiler into doing stuff it shouldn't be doing because it's transaction based what we're saying is",
    "start": "1474159",
    "end": "1480799"
  },
  {
    "text": "it's okay to do this stuff because there aren't any transactions but nudge nudge there actually are but don't worry about",
    "start": "1480799",
    "end": "1486320"
  },
  {
    "text": "it it's all safe and everything like that and what we're actually going to do is grant dba privileges to to gremlin",
    "start": "1486320",
    "end": "1495200"
  },
  {
    "text": "so hit enter so that's as primed now this is already in waiting as soon as the new java",
    "start": "1495200",
    "end": "1502320"
  },
  {
    "text": "session uh gets some some output it will execute that sql so what we need to do",
    "start": "1502320",
    "end": "1508559"
  },
  {
    "text": "now is cause some output some output from java to be written we",
    "start": "1508559",
    "end": "1515520"
  },
  {
    "text": "do that using any number of methods the one i'm using here is executing dmscdci",
    "start": "1515520",
    "end": "1520720"
  },
  {
    "text": "subscribe executing the internal purge window uh procedure as i said it can be",
    "start": "1520720",
    "end": "1526880"
  },
  {
    "text": "anything but by doing this an error is going to be kicked off and that error will write java output and that output",
    "start": "1526880",
    "end": "1532960"
  },
  {
    "text": "will kick off the sql in our other java virtual session that's sat waiting basically so hitting that",
    "start": "1532960",
    "end": "1539039"
  },
  {
    "text": "there's our error as expected and now if we go set role",
    "start": "1539039",
    "end": "1544640"
  },
  {
    "text": "dba we're now dba and if we do select star",
    "start": "1544640",
    "end": "1549840"
  },
  {
    "text": "from session privileges",
    "start": "1549840",
    "end": "1553559"
  },
  {
    "text": "sorry that's why so you can see now we've got all the",
    "start": "1579840",
    "end": "1586480"
  },
  {
    "text": "privileges under the sun basically um so from lowly gremlin user who only",
    "start": "1586480",
    "end": "1592159"
  },
  {
    "text": "had create session they now have complete control over the ass they now have complete control over the database server as well because they can do",
    "start": "1592159",
    "end": "1598400"
  },
  {
    "text": "anything they want what does that practically mean to",
    "start": "1598400",
    "end": "1603919"
  },
  {
    "text": "government guys i'm sure",
    "start": "1603919",
    "end": "1609039"
  },
  {
    "text": "a lot of you are probably using things like oracle label security so i'll show you how we can do some neat hacks to",
    "start": "1609039",
    "end": "1616480"
  },
  {
    "text": "defeat oracle label security so what we could do is use that sql injection floor um",
    "start": "1616480",
    "end": "1623200"
  },
  {
    "text": "well technically it's not really sql injection flora it's um it's just dumb that's what it is it's a",
    "start": "1623200",
    "end": "1630159"
  },
  {
    "text": "dumb flaw really you'll see in the slides later it's like",
    "start": "1630159",
    "end": "1637279"
  },
  {
    "text": "when people sat down and were thinking about programming this which idiot thought of it which plonker actually",
    "start": "1637279",
    "end": "1643120"
  },
  {
    "text": "turned around said hey this is a good idea let's do this execute this as cis you know it's crazy",
    "start": "1643120",
    "end": "1648720"
  },
  {
    "text": "um but we'll get back to that um so yeah bypassing oracle label security",
    "start": "1648720",
    "end": "1656080"
  },
  {
    "text": "uh oracle label security basically is um oracle's super",
    "start": "1656080",
    "end": "1662799"
  },
  {
    "text": "way of basically uh managing uh you know information at um different levels of",
    "start": "1662799",
    "end": "1669520"
  },
  {
    "text": "security so for example confidential secret top secret and so on um mandatory access control basically uh",
    "start": "1669520",
    "end": "1676320"
  },
  {
    "text": "this has been evaluated uh to eal4 under the common criteria and uh there",
    "start": "1676320",
    "end": "1683279"
  },
  {
    "text": "are amongst other ways of bypassing it that i'm showing you here there are other uh interesting things actually let's",
    "start": "1683279",
    "end": "1689760"
  },
  {
    "text": "talk about that it's not actually my slides but um this is from",
    "start": "1689760",
    "end": "1695120"
  },
  {
    "text": "uh cds",
    "start": "1695120",
    "end": "1698600"
  },
  {
    "text": "and this is the security target i think",
    "start": "1711840",
    "end": "1717039"
  },
  {
    "text": "yep um toe summary",
    "start": "1723039",
    "end": "1728320"
  },
  {
    "text": "protection profile claims actually is it in that one dr star.pdf",
    "start": "1728720",
    "end": "1734760"
  },
  {
    "text": "this is the evaluated configuration that's right oh",
    "start": "1740960",
    "end": "1747360"
  },
  {
    "text": "display drivers stop responding but we're still good right excellent um profile a script listing",
    "start": "1749600",
    "end": "1757600"
  },
  {
    "text": "there's a couple for a product which has been evaluated to eal4 there's some worrying things in",
    "start": "1758080",
    "end": "1763760"
  },
  {
    "text": "here like the security functions that enable you know assist as part of the um",
    "start": "1763760",
    "end": "1770399"
  },
  {
    "text": "you know the the target of evaluation have flaws in it you know it's like there's a second",
    "start": "1770399",
    "end": "1776559"
  },
  {
    "text": "order sql injection floor they create a user with the default password and don't do anything about it later on and so",
    "start": "1776559",
    "end": "1782960"
  },
  {
    "text": "people who have actually followed the evaluated configuration are at risk because of the configuration you know",
    "start": "1782960",
    "end": "1789360"
  },
  {
    "text": "um sorry give us two secs actually i'll find that at the end",
    "start": "1789360",
    "end": "1794799"
  },
  {
    "text": "because we're interrupting the flow of um the actual presentation itself so one",
    "start": "1794799",
    "end": "1799919"
  },
  {
    "text": "one of the ways um in which oracle themselves acknowledge um that",
    "start": "1799919",
    "end": "1805120"
  },
  {
    "text": "oracle label security could be bypassed would be if a user could arbitrarily load a random well not necessarily",
    "start": "1805120",
    "end": "1812159"
  },
  {
    "text": "random a bad dll into the address space of the oracle process a dll is a dynamic",
    "start": "1812159",
    "end": "1818399"
  },
  {
    "text": "link library it's like a shared object on on unix systems and so on now if an attacker can do that and load their own",
    "start": "1818399",
    "end": "1824640"
  },
  {
    "text": "code into the uh address space of the oracle process then they can obviously start doing things like bypassing oracle",
    "start": "1824640",
    "end": "1830960"
  },
  {
    "text": "label security and that's specifically mentioned in in their ols documents",
    "start": "1830960",
    "end": "1836880"
  },
  {
    "text": "now um because um loading a library is is so",
    "start": "1836880",
    "end": "1842720"
  },
  {
    "text": "dangerous not even for oracle label security oracle actually disallow even assist user from loading a library into",
    "start": "1842720",
    "end": "1850000"
  },
  {
    "text": "the address space of the oracle process but by using this java hack that we already spoke about this permissions",
    "start": "1850000",
    "end": "1855039"
  },
  {
    "text": "hack we can actually bypass all that stuff load the library into the address space so let's do that",
    "start": "1855039",
    "end": "1862840"
  },
  {
    "text": "uh so there's a library here called my dll",
    "start": "1862840",
    "end": "1871398"
  },
  {
    "text": "uh on my live it's called sorry my lib.dml so we're gonna load this library the",
    "start": "1879360",
    "end": "1885919"
  },
  {
    "text": "source for it is quite simple um type uh my",
    "start": "1885919",
    "end": "1892960"
  },
  {
    "text": "so that's the code um all we do is create a a file called oracle ols lib test",
    "start": "1892960",
    "end": "1901360"
  },
  {
    "text": "that's probably cd um app cd david",
    "start": "1901360",
    "end": "1908960"
  },
  {
    "text": "c dir for success hopefully it doesn't exist whilst that's",
    "start": "1908960",
    "end": "1915679"
  },
  {
    "text": "going on i'm gonna load the library",
    "start": "1915679",
    "end": "1922399"
  },
  {
    "text": "okay now remember gremlin has awarded themselves all the privileges under the sun so things like create procedure they",
    "start": "1922399",
    "end": "1929440"
  },
  {
    "text": "now have so what he's going to do is create a some java source named my load lib test",
    "start": "1929440",
    "end": "1936720"
  },
  {
    "text": "that basically loads a library takes an arbitrary name and loads a library",
    "start": "1936720",
    "end": "1942000"
  },
  {
    "text": "it loads that library so here goes",
    "start": "1942000",
    "end": "1947639"
  },
  {
    "text": "let me go with that so we've just created that um java we're now going to",
    "start": "1950480",
    "end": "1955519"
  },
  {
    "text": "pass that to give ourselves sorry the",
    "start": "1955519",
    "end": "1961679"
  },
  {
    "text": "load library permissions",
    "start": "1961679",
    "end": "1964720"
  },
  {
    "text": "so again we've used the dbms jvm export permissions package to import",
    "start": "1966960",
    "end": "1973840"
  },
  {
    "text": "the runtime permission load library on any library we want to see that dot star at the end that basically says we can load",
    "start": "1973840",
    "end": "1980399"
  },
  {
    "text": "any library we want now and we use our good old friend java test func all",
    "start": "1980399",
    "end": "1988720"
  },
  {
    "text": "to do that now what this does basically is takes the name of a method",
    "start": "1988720",
    "end": "1995440"
  },
  {
    "text": "and uh takes the name of a class its method to execute but again it has to be of a set type and",
    "start": "1995440",
    "end": "2002480"
  },
  {
    "text": "then uh passes it any parameter and the parameter we're passing it here is uh mylib.dll but remember we have to do dot",
    "start": "2002480",
    "end": "2009600"
  },
  {
    "text": "dot dot and uh dot dot dot slash to because it will look in the current working directory which is",
    "start": "2009600",
    "end": "2016480"
  },
  {
    "text": "uh somewhere in here um cd product cd",
    "start": "2016480",
    "end": "2023679"
  },
  {
    "text": "cd db 2. i think this is going to be the um somewhere in here is the current working",
    "start": "2024960",
    "end": "2030480"
  },
  {
    "text": "directory so using the dot dot basically that's going to allow us to load the library from",
    "start": "2030480",
    "end": "2036000"
  },
  {
    "text": "a different part of the file system so if we start capturing this here this tool here is process monitor it shows what's going",
    "start": "2036000",
    "end": "2042240"
  },
  {
    "text": "on in the background it's just a dll i've created",
    "start": "2042240",
    "end": "2047840"
  },
  {
    "text": "um you know my attack basically i would create the dll and upload that uh in onto the",
    "start": "2047840",
    "end": "2054878"
  },
  {
    "text": "server um using this java hack basically to you know load it into a table export it at",
    "start": "2054879",
    "end": "2061040"
  },
  {
    "text": "fro as from as a load it into a table as a blob export that to the file system so i've now got",
    "start": "2061040",
    "end": "2066560"
  },
  {
    "text": "a file called mydl mylab.dll which contains my trojan nefarious code which",
    "start": "2066560",
    "end": "2072720"
  },
  {
    "text": "i'm then going to load into the address space and that the dll main function",
    "start": "2072720",
    "end": "2078398"
  },
  {
    "text": "where are we um",
    "start": "2078399",
    "end": "2082398"
  },
  {
    "text": "you see the backslash type um my",
    "start": "2084720",
    "end": "2090960"
  },
  {
    "text": "dot c always it does basically the dll main function here the code it's going to execute when it loads into oracle is",
    "start": "2090960",
    "end": "2097440"
  },
  {
    "text": "create a file called oracle ols lib test uh close it and then but if i wanted to",
    "start": "2097440",
    "end": "2102960"
  },
  {
    "text": "do something really nefarious in there i could you know but it's not nefarious but it's just for demo purposes",
    "start": "2102960",
    "end": "2108640"
  },
  {
    "text": "um yeah so if i was wanting to do a bypass ols with this i would basically write",
    "start": "2108640",
    "end": "2114400"
  },
  {
    "text": "code to bypass ols and put it in here in the dll main function so if i hit enter",
    "start": "2114400",
    "end": "2121680"
  },
  {
    "text": "and we go back here we can see",
    "start": "2121680",
    "end": "2125359"
  },
  {
    "text": "oracle has loaded the library into this is my lib for those that can't read",
    "start": "2126960",
    "end": "2132720"
  },
  {
    "text": "at the back that says my lib.dll on the root the c drive so it's loaded the library and when a process loads a new",
    "start": "2132720",
    "end": "2139599"
  },
  {
    "text": "library it executes the dlr main function so any code which is in there will execute so now",
    "start": "2139599",
    "end": "2144960"
  },
  {
    "text": "that um file should exist and there it is okay so",
    "start": "2144960",
    "end": "2151119"
  },
  {
    "text": "we we've seen that we've loaded um arbitrary code into machine code into the address space",
    "start": "2151119",
    "end": "2158160"
  },
  {
    "text": "now we've done that we not only own all the data we own everything we can bypass everything do anything we want basically",
    "start": "2158160",
    "end": "2164480"
  },
  {
    "text": "to the oracle database server uh back here",
    "start": "2164480",
    "end": "2169920"
  },
  {
    "text": "what are we doing for time if you don't want to go to all that trouble",
    "start": "2169920",
    "end": "2175839"
  },
  {
    "text": "as i said we could just use the sql injection floor to bypass ols and grant ourselves um exempt policy access so",
    "start": "2175839",
    "end": "2181280"
  },
  {
    "text": "that way when we log on because we've got this privilege um olas policies will not apply to us same",
    "start": "2181280",
    "end": "2188720"
  },
  {
    "text": "with virtual private databases vpds we can basically get all the data we want so if we're",
    "start": "2188720",
    "end": "2194480"
  },
  {
    "text": "if we are cleared to say for access to secret data um in a an ols policy to",
    "start": "2194480",
    "end": "2200480"
  },
  {
    "text": "table we can now get access to top secret and everything all media access and not media access all mandatory",
    "start": "2200480",
    "end": "2206240"
  },
  {
    "text": "access control is is is gone um this dbms java function is really",
    "start": "2206240",
    "end": "2214480"
  },
  {
    "text": "useful when it comes to auxiliary inject functions now quickly explain what that",
    "start": "2214480",
    "end": "2219520"
  },
  {
    "text": "is if you have a say an arbitrary sql injection floor on in oracle",
    "start": "2219520",
    "end": "2225040"
  },
  {
    "text": "sometimes it's difficult to execute arbitrary code so what i mean by that is",
    "start": "2225040",
    "end": "2231040"
  },
  {
    "text": "if we're in the middle of a select statement let's say there's a a sql injection flaw in a procedure",
    "start": "2231040",
    "end": "2236400"
  },
  {
    "text": "owned by cis that does an arbitrary select on some table um we can't",
    "start": "2236400",
    "end": "2242480"
  },
  {
    "text": "just like in say sql server go semicolon grant dba to whoever and do this you",
    "start": "2242480",
    "end": "2248640"
  },
  {
    "text": "know you can't batch statements and stuff so sometimes um if you're limited by the actual floor",
    "start": "2248640",
    "end": "2255119"
  },
  {
    "text": "itself you need to inject an auxiliary helper function essentially that allows",
    "start": "2255119",
    "end": "2260400"
  },
  {
    "text": "us to do what we want you know so in this case we would say grant dba to public and and so on but we inject that",
    "start": "2260400",
    "end": "2267200"
  },
  {
    "text": "see that vol proc um that's you know the vulnerable procedure you know it's obviously fake",
    "start": "2267200",
    "end": "2272320"
  },
  {
    "text": "it doesn't exist on the system in real in in the real world just for demonstration purposes um",
    "start": "2272320",
    "end": "2277680"
  },
  {
    "text": "and that's because sql injection problems are so few and far between on 11g i had to make my own",
    "start": "2277680",
    "end": "2283040"
  },
  {
    "text": "one up it was quicker to do that than than find one 10g release one or two it",
    "start": "2283040",
    "end": "2288240"
  },
  {
    "text": "would have been quicker finding a new one than writing a vulnerable procedure funnily enough",
    "start": "2288240",
    "end": "2293280"
  },
  {
    "text": "which is quite ironic and so what we can do there is use this set output to sql which is a different",
    "start": "2293280",
    "end": "2300960"
  },
  {
    "text": "uh function uh this does not execute as cis but because we're executing uh",
    "start": "2300960",
    "end": "2307520"
  },
  {
    "text": "injecting it into a system procedure it will then assume their privileges and execute",
    "start": "2307520",
    "end": "2313599"
  },
  {
    "text": "as cis therefore so once we've set up we then uh run something like",
    "start": "2313599",
    "end": "2319280"
  },
  {
    "text": "the oracle aurora util test class and the you know the the sequel will then",
    "start": "2319280",
    "end": "2325760"
  },
  {
    "text": "execute if however we were injecting this via a",
    "start": "2325760",
    "end": "2331119"
  },
  {
    "text": "web-based attack we need to uh concatenate the two and put the attack in one single request simply because the",
    "start": "2331119",
    "end": "2338000"
  },
  {
    "text": "session may be torn down between two web requests and our session state and everything will change so basically all",
    "start": "2338000",
    "end": "2344000"
  },
  {
    "text": "we do is embed um our output to sql statement inside the run",
    "start": "2344000",
    "end": "2351200"
  },
  {
    "text": "java statement so this executes first sets up our attack then when this",
    "start": "2351200",
    "end": "2358480"
  },
  {
    "text": "one executes you know an output is is generated to to system.our system.era",
    "start": "2358480",
    "end": "2366160"
  },
  {
    "text": "then this the the sequel is triggered and and and so on so",
    "start": "2366160",
    "end": "2372400"
  },
  {
    "text": "uh just to show you this can be used as a dbms java can be used as a great auxiliary inject function um and even",
    "start": "2372400",
    "end": "2379200"
  },
  {
    "text": "used over the web as well",
    "start": "2379200",
    "end": "2382320"
  },
  {
    "text": "so preventing attacks clearly the easiest method to",
    "start": "2384480",
    "end": "2389839"
  },
  {
    "text": "stop people from exploiting this is revoke public permissions on dbms java java test and dbms jvm export",
    "start": "2389839",
    "end": "2397440"
  },
  {
    "text": "permissions when the patch becomes available from oracle obviously you should install",
    "start": "2397440",
    "end": "2403680"
  },
  {
    "text": "those as well everyone in source patches here right",
    "start": "2403680",
    "end": "2409440"
  },
  {
    "text": "within the first six months um",
    "start": "2409440",
    "end": "2414560"
  },
  {
    "text": "yeah i reported this back to oracle um last year and i was hoping that it was going to be patched um",
    "start": "2414560",
    "end": "2421680"
  },
  {
    "text": "in the cpu but since we're a limited audience i've decided to to go ahead with the talk there is going to be a",
    "start": "2421680",
    "end": "2427040"
  },
  {
    "text": "white paper that will be released to the general public at a much later date when oracle have actually released",
    "start": "2427040",
    "end": "2433280"
  },
  {
    "text": "um you know fixes for this um but until such time the actual paper will will not",
    "start": "2433280",
    "end": "2439040"
  },
  {
    "text": "be made public so you're getting a sneak preview so shh",
    "start": "2439040",
    "end": "2444240"
  },
  {
    "text": "okay so has oracle security posture improved",
    "start": "2444240",
    "end": "2450078"
  },
  {
    "text": "yes it has it's improved a great deal and uh as much as it pains me to say it",
    "start": "2450720",
    "end": "2455839"
  },
  {
    "text": "well done oracle you know um i'm not so sure however that their sdl",
    "start": "2455839",
    "end": "2462480"
  },
  {
    "text": "processes sdl is the security development life cycle that you know sort of was uh",
    "start": "2462480",
    "end": "2468560"
  },
  {
    "text": "i i'm not going to say invented by microsoft because there was security development life cycles out there before",
    "start": "2468560",
    "end": "2474240"
  },
  {
    "text": "but certainly made famous by by microsoft mike howard great uh great guy did a lot",
    "start": "2474240",
    "end": "2481280"
  },
  {
    "text": "of excellent work there um steve lipner and so on now what sdl does basically it goes",
    "start": "2481280",
    "end": "2486800"
  },
  {
    "text": "through every single stage of your development process right from the drawing board stage all the way through",
    "start": "2486800",
    "end": "2492160"
  },
  {
    "text": "to the very end and it's a continuing process so even when the product has been released you're constantly you know",
    "start": "2492160",
    "end": "2497680"
  },
  {
    "text": "trying to improve on on that code to ensure that there's there's nothing wrong now",
    "start": "2497680",
    "end": "2503760"
  },
  {
    "text": "why are these bugs in there they're not you know your typical sql injection bugs they they're not your typical um buffer",
    "start": "2503760",
    "end": "2510480"
  },
  {
    "text": "overflows but they are still bugs but they're they're interesting it's slipped through the net somehow now as far as",
    "start": "2510480",
    "end": "2515760"
  },
  {
    "text": "i'm concerned i want to know which plonker thought that was a good idea at the development stage you know prior to",
    "start": "2515760",
    "end": "2521280"
  },
  {
    "text": "the development stage they actually um someone should have said that should have been caught there and then and said actually this is dangerous this is not a",
    "start": "2521280",
    "end": "2528000"
  },
  {
    "text": "good idea um so if they'd done that at the requirements or the design phases",
    "start": "2528000",
    "end": "2533040"
  },
  {
    "text": "this it wouldn't have gotten any further and as you can see because they're so subtle in the in the way they work",
    "start": "2533040",
    "end": "2539680"
  },
  {
    "text": "unless you know what like um the dbms import java export java permissions does",
    "start": "2539680",
    "end": "2547680"
  },
  {
    "text": "you're not going to really look at the permission to see where the public has execute on it and and so on so",
    "start": "2547680",
    "end": "2552800"
  },
  {
    "text": "that slipped through the net simply because um actually reverse that",
    "start": "2552800",
    "end": "2558720"
  },
  {
    "text": "a later code review or pen test would not have found that as easier as finding",
    "start": "2558720",
    "end": "2564000"
  },
  {
    "text": "it in in the design stages because there's a lot of code to go through and and so on there's the second one which",
    "start": "2564000",
    "end": "2570800"
  },
  {
    "text": "is the um the executing arbitrary sql through the dbms java",
    "start": "2570800",
    "end": "2576800"
  },
  {
    "text": "set output to java uh function unless you actually read the",
    "start": "2576800",
    "end": "2582079"
  },
  {
    "text": "documentation you don't know that it's actually kicking off a a new",
    "start": "2582079",
    "end": "2587359"
  },
  {
    "text": "jvm with a new session state and so on so these things are very subtle in the way they've slipped through so it's",
    "start": "2587359",
    "end": "2592880"
  },
  {
    "text": "oracle really can't be blamed for these getting in the well they can sorry let me rephrase that they should have been caught at stage one but once they got",
    "start": "2592880",
    "end": "2599040"
  },
  {
    "text": "past that stage once they entered the code it would be really really difficult to find these flaws as far as i'm",
    "start": "2599040",
    "end": "2604240"
  },
  {
    "text": "concerned um unless you're a super uber hacker like me of course you know what um that that was me being on ironic by",
    "start": "2604240",
    "end": "2610960"
  },
  {
    "text": "the way or attempting to be or making a joke uh i'm not that conceited well maybe i am",
    "start": "2610960",
    "end": "2616400"
  },
  {
    "text": "um so the question is why won't they call it the late late stages i think it's",
    "start": "2616400",
    "end": "2621680"
  },
  {
    "text": "really difficult to spots to have to have had spot these things at the latest age",
    "start": "2621680",
    "end": "2628079"
  },
  {
    "text": "i think oracle rely too heavily on their security tools they're using them as the goalkeeper actually you guys don't watch",
    "start": "2628079",
    "end": "2634240"
  },
  {
    "text": "something in britain we play football which actually we use our feet for you guys could play football and use your",
    "start": "2634240",
    "end": "2640400"
  },
  {
    "text": "hands right it's um soccer what we call football in the uk",
    "start": "2640400",
    "end": "2645839"
  },
  {
    "text": "we have goalkeepers you know to prevent people from scoring goals the goal is that we square thing at the end and boot",
    "start": "2645839",
    "end": "2651520"
  },
  {
    "text": "into the net and stuff okay um they're using their tools too much as",
    "start": "2651520",
    "end": "2656960"
  },
  {
    "text": "goalkeepers as far as i'm concerned they're thinking we can code the way we normally do we can develop and think of",
    "start": "2656960",
    "end": "2662560"
  },
  {
    "text": "our ideas the way we normally do because our code will save our our security tools will save us and they don't and",
    "start": "2662560",
    "end": "2669119"
  },
  {
    "text": "whilst they do in a lot of cases and we've seen that there are very few sql injection flaws in in 11g release one",
    "start": "2669119",
    "end": "2674800"
  },
  {
    "text": "now and even 10g release two is vastly better than tendril release one because of these tools and everything",
    "start": "2674800",
    "end": "2680079"
  },
  {
    "text": "like that um i think there's still too much reliance on these tools um",
    "start": "2680079",
    "end": "2686079"
  },
  {
    "text": "so in conclusion they don't have to go all the way back to the drawing board um",
    "start": "2686079",
    "end": "2691280"
  },
  {
    "text": "they just need to tweak it tweak it a little so if if i was a teacher and i was giving",
    "start": "2691280",
    "end": "2697040"
  },
  {
    "text": "oracle a grade i'll give them a b plus um and yeah with a wee bit more work",
    "start": "2697040",
    "end": "2702960"
  },
  {
    "text": "they would definitely get an a minus still not there but vastly vastly vastly more superior to",
    "start": "2702960",
    "end": "2709839"
  },
  {
    "text": "where they were even two years ago you know so um round of applause oracle you know",
    "start": "2709839",
    "end": "2716240"
  },
  {
    "text": "you know and that ladies and gentlemen is the end of the talk so i'll",
    "start": "2716240",
    "end": "2722079"
  },
  {
    "text": "see if there's any questions yep sure gentlemen",
    "start": "2722079",
    "end": "2728920"
  },
  {
    "text": "well yeah um the the easiest way is doing in in dll main um",
    "start": "2733359",
    "end": "2739200"
  },
  {
    "text": "if if we don't put it in dl main dll main what happens is that",
    "start": "2739200",
    "end": "2744560"
  },
  {
    "text": "nothing will ever call the code so let's say we had a function called fubar nothing or the oracle process would never call foobar so it would just",
    "start": "2744560",
    "end": "2751280"
  },
  {
    "text": "remain the code would remain there and and do nothing you know so that's why we put in dll",
    "start": "2751280",
    "end": "2756880"
  },
  {
    "text": "maine oh no well no once from dll main we can",
    "start": "2756880",
    "end": "2762720"
  },
  {
    "text": "kick off threads we can do what we want and you know we can put more functions in there and call them but i'm just saying if if we have a function",
    "start": "2762720",
    "end": "2770000"
  },
  {
    "text": "uh called fubar and you know upload that foobar will never be called so we need a way of",
    "start": "2770000",
    "end": "2775359"
  },
  {
    "text": "triggering that and that's through dll main correct",
    "start": "2775359",
    "end": "2781280"
  },
  {
    "text": "yeah any other questions",
    "start": "2781280",
    "end": "2786640"
  },
  {
    "text": "is there a question there yeah the jpm is running inside the oracle process correct that's running on windows",
    "start": "2786640",
    "end": "2794400"
  },
  {
    "text": "service yeah the oracle process is is running as a system service and the jvm is inside",
    "start": "2794400",
    "end": "2801680"
  },
  {
    "text": "that oracle process basically it's within the address space of the oracle process and on linux as well the",
    "start": "2801680",
    "end": "2807839"
  },
  {
    "text": "processes are divided amongst you know like shadow process and the the database",
    "start": "2807839",
    "end": "2813040"
  },
  {
    "text": "log writer reader and everything like that they're all in different processes but it's still within the main oracle process it's not like kicking off a java",
    "start": "2813040",
    "end": "2819520"
  },
  {
    "text": "process any other questions",
    "start": "2819520",
    "end": "2825838"
  },
  {
    "text": "we've got um 10 minutes so you get an extra wee break i'd like to thank everybody for coming to the talk i hope",
    "start": "2826240",
    "end": "2831760"
  },
  {
    "text": "it's been useful for you and yeah thank you",
    "start": "2831760",
    "end": "2837559"
  }
]