[
  {
    "start": "0",
    "end": "25000"
  },
  {
    "text": "[Music]",
    "start": "860",
    "end": "8960"
  },
  {
    "text": "good morning everybody i'm dario nizi",
    "start": "8960",
    "end": "11440"
  },
  {
    "text": "and today i'm going to talk about my",
    "start": "11440",
    "end": "13040"
  },
  {
    "text": "latest work lost in the loader the many",
    "start": "13040",
    "end": "15120"
  },
  {
    "text": "phases of the pe file format a work that",
    "start": "15120",
    "end": "17680"
  },
  {
    "text": "i conducted with mariano graziano and",
    "start": "17680",
    "end": "19520"
  },
  {
    "text": "janik fradantoni from cisco dallas and",
    "start": "19520",
    "end": "21600"
  },
  {
    "text": "david balzarotti from eurekom which is",
    "start": "21600",
    "end": "23600"
  },
  {
    "text": "also my home institution",
    "start": "23600",
    "end": "25920"
  },
  {
    "start": "25000",
    "end": "25000"
  },
  {
    "text": "as the title may suggest today we are",
    "start": "25920",
    "end": "27920"
  },
  {
    "text": "going to talk extensively about the pdf",
    "start": "27920",
    "end": "29840"
  },
  {
    "text": "file format so i think it's worth to",
    "start": "29840",
    "end": "31679"
  },
  {
    "text": "give a little bit of background about it",
    "start": "31679",
    "end": "34559"
  },
  {
    "text": "the p-file format is this de facto",
    "start": "34559",
    "end": "36880"
  },
  {
    "text": "standard for programs in windows and it",
    "start": "36880",
    "end": "39040"
  },
  {
    "text": "is based on the old microsoft dos mz and",
    "start": "39040",
    "end": "42719"
  },
  {
    "text": "the coff file formats",
    "start": "42719",
    "end": "45520"
  },
  {
    "text": "the p5 format defines the headers which",
    "start": "45520",
    "end": "48480"
  },
  {
    "text": "are data structure the two data",
    "start": "48480",
    "end": "50480"
  },
  {
    "text": "structures that we find at the beginning",
    "start": "50480",
    "end": "52640"
  },
  {
    "text": "of each program for windows",
    "start": "52640",
    "end": "54559"
  },
  {
    "start": "54000",
    "end": "54000"
  },
  {
    "text": "in fact each program starts with the mz",
    "start": "54559",
    "end": "56960"
  },
  {
    "text": "header which is there only for",
    "start": "56960",
    "end": "58800"
  },
  {
    "text": "compatibility reasons nowadays it's only",
    "start": "58800",
    "end": "61199"
  },
  {
    "text": "used to locate in memory the starting",
    "start": "61199",
    "end": "63120"
  },
  {
    "text": "offset of the cff header this other",
    "start": "63120",
    "end": "66080"
  },
  {
    "text": "header contains generic informations",
    "start": "66080",
    "end": "68320"
  },
  {
    "text": "about",
    "start": "68320",
    "end": "69280"
  },
  {
    "text": "the program itself such as the",
    "start": "69280",
    "end": "70880"
  },
  {
    "text": "instruction set for which it is compiled",
    "start": "70880",
    "end": "73920"
  },
  {
    "text": "and the file whether it is a standalone",
    "start": "73920",
    "end": "76479"
  },
  {
    "text": "executables",
    "start": "76479",
    "end": "77920"
  },
  {
    "text": "or",
    "start": "77920",
    "end": "78960"
  },
  {
    "text": "dynamically linked",
    "start": "78960",
    "end": "80720"
  },
  {
    "text": "library",
    "start": "80720",
    "end": "82159"
  },
  {
    "text": "after this uff header we find the",
    "start": "82159",
    "end": "84320"
  },
  {
    "text": "optional header whose name may actually",
    "start": "84320",
    "end": "86640"
  },
  {
    "text": "sound a little bit misleading because",
    "start": "86640",
    "end": "88560"
  },
  {
    "text": "this header actually contains vital",
    "start": "88560",
    "end": "90400"
  },
  {
    "text": "information without which the operating",
    "start": "90400",
    "end": "92799"
  },
  {
    "text": "system would not know how to load the",
    "start": "92799",
    "end": "94799"
  },
  {
    "text": "program in memory correctly",
    "start": "94799",
    "end": "97119"
  },
  {
    "text": "such information are for example the",
    "start": "97119",
    "end": "99280"
  },
  {
    "text": "entry point which is the address of the",
    "start": "99280",
    "end": "102079"
  },
  {
    "text": "first instruction in the program",
    "start": "102079",
    "end": "104159"
  },
  {
    "text": "the section and file alignment the base",
    "start": "104159",
    "end": "106640"
  },
  {
    "text": "address at which the program prefers to",
    "start": "106640",
    "end": "109040"
  },
  {
    "text": "be loaded and the data directories which",
    "start": "109040",
    "end": "111680"
  },
  {
    "text": "have specific rules roles",
    "start": "111680",
    "end": "113920"
  },
  {
    "text": "which play specific roles in loading the",
    "start": "113920",
    "end": "116880"
  },
  {
    "text": "file in memory such as the import table",
    "start": "116880",
    "end": "119759"
  },
  {
    "text": "the export table relocations and",
    "start": "119759",
    "end": "121680"
  },
  {
    "text": "certificate table",
    "start": "121680",
    "end": "123600"
  },
  {
    "text": "after the optional header we find the",
    "start": "123600",
    "end": "125360"
  },
  {
    "start": "125000",
    "end": "125000"
  },
  {
    "text": "section table",
    "start": "125360",
    "end": "126719"
  },
  {
    "text": "which defines the program's memory image",
    "start": "126719",
    "end": "129280"
  },
  {
    "text": "which means which",
    "start": "129280",
    "end": "131120"
  },
  {
    "text": "represents how the program looks like",
    "start": "131120",
    "end": "133200"
  },
  {
    "text": "once it's loaded in memory each entry in",
    "start": "133200",
    "end": "135280"
  },
  {
    "text": "the section table defines a section",
    "start": "135280",
    "end": "137840"
  },
  {
    "text": "which is a contiguous and homogeneous",
    "start": "137840",
    "end": "140080"
  },
  {
    "text": "portion of memory that shares the same",
    "start": "140080",
    "end": "141760"
  },
  {
    "text": "permission level in terms of read write",
    "start": "141760",
    "end": "144640"
  },
  {
    "text": "and execution",
    "start": "144640",
    "end": "146560"
  },
  {
    "text": "each section has its own starting",
    "start": "146560",
    "end": "148640"
  },
  {
    "text": "address and size in memory its own",
    "start": "148640",
    "end": "151760"
  },
  {
    "text": "offset and size within the file",
    "start": "151760",
    "end": "154480"
  },
  {
    "text": "the p5 format supports up to 2 to the",
    "start": "154480",
    "end": "156879"
  },
  {
    "text": "16th power sections because 16 is the",
    "start": "156879",
    "end": "159280"
  },
  {
    "text": "number of bits in the number of sections",
    "start": "159280",
    "end": "161680"
  },
  {
    "text": "field in the coff header",
    "start": "161680",
    "end": "165599"
  },
  {
    "start": "165000",
    "end": "165000"
  },
  {
    "text": "now while we were studying the p",
    "start": "165599",
    "end": "167840"
  },
  {
    "text": "ecosystem we found",
    "start": "167840",
    "end": "169680"
  },
  {
    "text": "two interesting things",
    "start": "169680",
    "end": "171599"
  },
  {
    "text": "the first is that there is not really a",
    "start": "171599",
    "end": "173280"
  },
  {
    "text": "reference implementation for how to",
    "start": "173280",
    "end": "175200"
  },
  {
    "text": "parse correctly the pe file format and",
    "start": "175200",
    "end": "178000"
  },
  {
    "text": "the second observation that we made was",
    "start": "178000",
    "end": "179840"
  },
  {
    "text": "that the specifications or do they make",
    "start": "179840",
    "end": "182560"
  },
  {
    "text": "a very good job in defining the headers",
    "start": "182560",
    "end": "185360"
  },
  {
    "text": "and their their structure",
    "start": "185360",
    "end": "187360"
  },
  {
    "text": "and their field and their possible",
    "start": "187360",
    "end": "188800"
  },
  {
    "text": "values for each field they are not",
    "start": "188800",
    "end": "190720"
  },
  {
    "text": "really comprehensive they do not tell",
    "start": "190720",
    "end": "193280"
  },
  {
    "text": "what it is to be considered a valid p",
    "start": "193280",
    "end": "195680"
  },
  {
    "text": "file or an embodied one",
    "start": "195680",
    "end": "197840"
  },
  {
    "text": "or at least they don't do it in all the",
    "start": "197840",
    "end": "199680"
  },
  {
    "text": "possible circumstances",
    "start": "199680",
    "end": "202000"
  },
  {
    "text": "now when you take these two things",
    "start": "202000",
    "end": "203280"
  },
  {
    "text": "together some problems may start arising",
    "start": "203280",
    "end": "205760"
  },
  {
    "text": "for example the fact that there is no",
    "start": "205760",
    "end": "207280"
  },
  {
    "text": "really a reference implementation means",
    "start": "207280",
    "end": "209120"
  },
  {
    "text": "that",
    "start": "209120",
    "end": "210319"
  },
  {
    "text": "we're implementing the same logic over",
    "start": "210319",
    "end": "212080"
  },
  {
    "text": "and over again is the de facto rule for",
    "start": "212080",
    "end": "214159"
  },
  {
    "text": "the pe ecosystem",
    "start": "214159",
    "end": "215760"
  },
  {
    "text": "while the fact that these specifications",
    "start": "215760",
    "end": "217680"
  },
  {
    "text": "are not comprehensive enough",
    "start": "217680",
    "end": "219840"
  },
  {
    "text": "means that a lot of room is left for",
    "start": "219840",
    "end": "221920"
  },
  {
    "text": "implementation choices",
    "start": "221920",
    "end": "223680"
  },
  {
    "text": "when you combine these two things",
    "start": "223680",
    "end": "224959"
  },
  {
    "text": "together you end up with discrepancies",
    "start": "224959",
    "end": "227120"
  },
  {
    "text": "which are slight differences in how two",
    "start": "227120",
    "end": "229920"
  },
  {
    "text": "pieces of software handle the same file",
    "start": "229920",
    "end": "232879"
  },
  {
    "text": "as given as an input",
    "start": "232879",
    "end": "236080"
  },
  {
    "start": "235000",
    "end": "235000"
  },
  {
    "text": "but are these discrepancies really a",
    "start": "236080",
    "end": "238080"
  },
  {
    "text": "problem what are the implications of p",
    "start": "238080",
    "end": "240959"
  },
  {
    "text": "discrepancies well let's try let's try",
    "start": "240959",
    "end": "243280"
  },
  {
    "text": "to make a case for the severity of this",
    "start": "243280",
    "end": "245680"
  },
  {
    "text": "problem by means of two examples",
    "start": "245680",
    "end": "248400"
  },
  {
    "text": "first",
    "start": "248400",
    "end": "249920"
  },
  {
    "text": "imagine that you have a program that",
    "start": "249920",
    "end": "251680"
  },
  {
    "text": "runs under windows 7 but not under",
    "start": "251680",
    "end": "254000"
  },
  {
    "text": "windows 10.",
    "start": "254000",
    "end": "255280"
  },
  {
    "text": "well these of course already break",
    "start": "255280",
    "end": "257280"
  },
  {
    "text": "backward compatibility which is",
    "start": "257280",
    "end": "258880"
  },
  {
    "text": "something for which microsoft has spent",
    "start": "258880",
    "end": "261120"
  },
  {
    "text": "a lot of development efforts to maintain",
    "start": "261120",
    "end": "263040"
  },
  {
    "text": "throughout the versions",
    "start": "263040",
    "end": "265120"
  },
  {
    "text": "but it's even worse if you have a",
    "start": "265120",
    "end": "267199"
  },
  {
    "text": "dynamic analysis sandbox which runs",
    "start": "267199",
    "end": "269759"
  },
  {
    "text": "windows 10",
    "start": "269759",
    "end": "271040"
  },
  {
    "text": "well suppose that you want to analyze",
    "start": "271040",
    "end": "272800"
  },
  {
    "text": "this program because you suspect it's",
    "start": "272800",
    "end": "274479"
  },
  {
    "text": "malicious well your analysis sandbox",
    "start": "274479",
    "end": "277199"
  },
  {
    "text": "simply cannot run it cannot analyze this",
    "start": "277199",
    "end": "280560"
  },
  {
    "text": "program because it's only only runs",
    "start": "280560",
    "end": "282560"
  },
  {
    "text": "under windows 7.",
    "start": "282560",
    "end": "284880"
  },
  {
    "text": "another example take your favorite",
    "start": "284880",
    "end": "286800"
  },
  {
    "text": "reverse engineering tool and imagine",
    "start": "286800",
    "end": "288880"
  },
  {
    "text": "that for this program it gives you the",
    "start": "288880",
    "end": "290720"
  },
  {
    "text": "wrong mapping",
    "start": "290720",
    "end": "291919"
  },
  {
    "text": "now imagine that you are already working",
    "start": "291919",
    "end": "294320"
  },
  {
    "text": "on reverse engineering this this",
    "start": "294320",
    "end": "296720"
  },
  {
    "text": "program",
    "start": "296720",
    "end": "297759"
  },
  {
    "text": "only to find out six hours later that",
    "start": "297759",
    "end": "300560"
  },
  {
    "text": "your",
    "start": "300560",
    "end": "301759"
  },
  {
    "text": "the mapping was wrong basically you for",
    "start": "301759",
    "end": "304639"
  },
  {
    "text": "six hours of your day",
    "start": "304639",
    "end": "306479"
  },
  {
    "text": "you were just staring at ghosts",
    "start": "306479",
    "end": "309360"
  },
  {
    "text": "this is even worse if the reverse",
    "start": "309360",
    "end": "311120"
  },
  {
    "text": "engineering tool is used as a",
    "start": "311120",
    "end": "313440"
  },
  {
    "text": "part of a steadicam static analysis",
    "start": "313440",
    "end": "315680"
  },
  {
    "text": "pipeline basically each other analysis",
    "start": "315680",
    "end": "318320"
  },
  {
    "text": "which rely on the wrong on this wrong",
    "start": "318320",
    "end": "320639"
  },
  {
    "text": "mapping may be biased as a result as you",
    "start": "320639",
    "end": "324560"
  },
  {
    "text": "consider as you can already see",
    "start": "324560",
    "end": "327520"
  },
  {
    "text": "the p discrepancies are",
    "start": "327520",
    "end": "329440"
  },
  {
    "text": "problematic especially in adversarial",
    "start": "329440",
    "end": "331840"
  },
  {
    "text": "settings like malware analysis and",
    "start": "331840",
    "end": "333840"
  },
  {
    "text": "malware detection both static and",
    "start": "333840",
    "end": "336080"
  },
  {
    "text": "dynamic approaches can be evaded using p",
    "start": "336080",
    "end": "339680"
  },
  {
    "text": "discrepancies and even",
    "start": "339680",
    "end": "341680"
  },
  {
    "text": "endpoint protection software can be",
    "start": "341680",
    "end": "343360"
  },
  {
    "text": "bypassed you know through p",
    "start": "343360",
    "end": "345759"
  },
  {
    "text": "discrepancies",
    "start": "345759",
    "end": "347520"
  },
  {
    "text": "for example",
    "start": "347520",
    "end": "348880"
  },
  {
    "text": "just a few weeks ago the google threat",
    "start": "348880",
    "end": "350880"
  },
  {
    "text": "analysis group discovered malware",
    "start": "350880",
    "end": "352880"
  },
  {
    "text": "families that were exploiting exactly",
    "start": "352880",
    "end": "355680"
  },
  {
    "text": "something like this",
    "start": "355680",
    "end": "358479"
  },
  {
    "text": "in particular they were exploiting how",
    "start": "358479",
    "end": "360639"
  },
  {
    "text": "the operating system and openssl",
    "start": "360639",
    "end": "363600"
  },
  {
    "text": "parse the certificate table in a pe file",
    "start": "363600",
    "end": "368080"
  },
  {
    "text": "since openssl is used in a lot of",
    "start": "368080",
    "end": "370800"
  },
  {
    "text": "detection tools",
    "start": "370800",
    "end": "372319"
  },
  {
    "text": "this malware family was able to",
    "start": "372319",
    "end": "375440"
  },
  {
    "text": "completely bypass the detection by these",
    "start": "375440",
    "end": "378160"
  },
  {
    "text": "tools",
    "start": "378160",
    "end": "379199"
  },
  {
    "text": "while still being able to run",
    "start": "379199",
    "end": "381360"
  },
  {
    "text": "under windows",
    "start": "381360",
    "end": "384000"
  },
  {
    "text": "now our work is by no means the first",
    "start": "384000",
    "end": "386400"
  },
  {
    "text": "one to take of the problem of p",
    "start": "386400",
    "end": "388800"
  },
  {
    "text": "discrepancies but all these other works",
    "start": "388800",
    "end": "391120"
  },
  {
    "text": "that when published or have been",
    "start": "391120",
    "end": "392479"
  },
  {
    "text": "conducted before only scratched the",
    "start": "392479",
    "end": "394720"
  },
  {
    "text": "surface of the problem in our opinion",
    "start": "394720",
    "end": "396880"
  },
  {
    "text": "they only documented single-edge cases",
    "start": "396880",
    "end": "398800"
  },
  {
    "text": "and nobody really did a systematic study",
    "start": "398800",
    "end": "401280"
  },
  {
    "text": "of this problem",
    "start": "401280",
    "end": "402490"
  },
  {
    "text": "[Music]",
    "start": "402490",
    "end": "403759"
  },
  {
    "text": "and that's exactly what we did in our",
    "start": "403759",
    "end": "406160"
  },
  {
    "text": "work we provide a systematic approach to",
    "start": "406160",
    "end": "408720"
  },
  {
    "text": "find discrepancies in the pe54 in the pa",
    "start": "408720",
    "end": "411680"
  },
  {
    "text": "system",
    "start": "411680",
    "end": "412960"
  },
  {
    "start": "412000",
    "end": "412000"
  },
  {
    "text": "let's have a look to the big picture of",
    "start": "412960",
    "end": "414800"
  },
  {
    "text": "our work",
    "start": "414800",
    "end": "416319"
  },
  {
    "text": "we start with some software that we want",
    "start": "416319",
    "end": "418319"
  },
  {
    "text": "to compare",
    "start": "418319",
    "end": "420080"
  },
  {
    "text": "we reverse engineer it to",
    "start": "420080",
    "end": "422479"
  },
  {
    "text": "model their behavior especially how they",
    "start": "422479",
    "end": "425520"
  },
  {
    "text": "parse the pe file format",
    "start": "425520",
    "end": "428080"
  },
  {
    "text": "and then we feed these models to our",
    "start": "428080",
    "end": "430400"
  },
  {
    "text": "analysis framework which can operate in",
    "start": "430400",
    "end": "433120"
  },
  {
    "text": "two modes",
    "start": "433120",
    "end": "435039"
  },
  {
    "text": "the first one is validation mode which",
    "start": "435039",
    "end": "437199"
  },
  {
    "text": "given an unknown p file and the model is",
    "start": "437199",
    "end": "440639"
  },
  {
    "text": "able to tell us whether this unknown p",
    "start": "440639",
    "end": "443280"
  },
  {
    "text": "file is valid or not according to the",
    "start": "443280",
    "end": "446000"
  },
  {
    "text": "original software without running the",
    "start": "446000",
    "end": "447919"
  },
  {
    "text": "software itself",
    "start": "447919",
    "end": "450560"
  },
  {
    "text": "the second mode of operation of our",
    "start": "450560",
    "end": "452400"
  },
  {
    "text": "analysis framework is generation mode",
    "start": "452400",
    "end": "454560"
  },
  {
    "text": "which given the models can create",
    "start": "454560",
    "end": "457280"
  },
  {
    "text": "automatically valid test cases which are",
    "start": "457280",
    "end": "459919"
  },
  {
    "text": "files that the original software would",
    "start": "459919",
    "end": "462080"
  },
  {
    "text": "consider as valid the generation mode is",
    "start": "462080",
    "end": "464960"
  },
  {
    "text": "actually more powerful than that it can",
    "start": "464960",
    "end": "466879"
  },
  {
    "text": "also create differential test cases",
    "start": "466879",
    "end": "469599"
  },
  {
    "text": "which are files that are valid according",
    "start": "469599",
    "end": "472319"
  },
  {
    "text": "to one of the",
    "start": "472319",
    "end": "473759"
  },
  {
    "text": "original software but invalid for",
    "start": "473759",
    "end": "475840"
  },
  {
    "text": "another one",
    "start": "475840",
    "end": "478639"
  },
  {
    "start": "477000",
    "end": "477000"
  },
  {
    "text": "all right let's now give a",
    "start": "478639",
    "end": "480720"
  },
  {
    "text": "more in-depth look of the constraints",
    "start": "480720",
    "end": "482800"
  },
  {
    "text": "modeling phase of our work",
    "start": "482800",
    "end": "485680"
  },
  {
    "start": "485000",
    "end": "485000"
  },
  {
    "text": "in this phase we want to collect as much",
    "start": "485680",
    "end": "488560"
  },
  {
    "text": "knowledge as possible about the",
    "start": "488560",
    "end": "490080"
  },
  {
    "text": "operations that the original software",
    "start": "490080",
    "end": "492160"
  },
  {
    "text": "performs on p files given as an input",
    "start": "492160",
    "end": "495440"
  },
  {
    "text": "through their parsing routines",
    "start": "495440",
    "end": "497919"
  },
  {
    "text": "while we were performing this phase we",
    "start": "497919",
    "end": "500400"
  },
  {
    "text": "realized that there are three types of",
    "start": "500400",
    "end": "501919"
  },
  {
    "text": "operations that software usually perform",
    "start": "501919",
    "end": "504400"
  },
  {
    "text": "on the input files and those are",
    "start": "504400",
    "end": "506240"
  },
  {
    "text": "structural checks in which the software",
    "start": "506240",
    "end": "508240"
  },
  {
    "text": "validates the file from a structural",
    "start": "508240",
    "end": "510319"
  },
  {
    "text": "point of view",
    "start": "510319",
    "end": "512080"
  },
  {
    "text": "for example they check that all the",
    "start": "512080",
    "end": "513760"
  },
  {
    "text": "mandatory headers are within the file",
    "start": "513760",
    "end": "515839"
  },
  {
    "text": "that the magic numbers match and",
    "start": "515839",
    "end": "518320"
  },
  {
    "text": "everything on this line then we have",
    "start": "518320",
    "end": "520880"
  },
  {
    "text": "compliance checks operations in which",
    "start": "520880",
    "end": "522800"
  },
  {
    "text": "the software validate the program from",
    "start": "522800",
    "end": "525279"
  },
  {
    "text": "an operational point of view for example",
    "start": "525279",
    "end": "527760"
  },
  {
    "text": "the operating system may want to check",
    "start": "527760",
    "end": "529680"
  },
  {
    "text": "that the instruction set architecture",
    "start": "529680",
    "end": "532000"
  },
  {
    "text": "of the program matches the one of the",
    "start": "532000",
    "end": "534080"
  },
  {
    "text": "machine onto which is about to run",
    "start": "534080",
    "end": "536800"
  },
  {
    "text": "the third type of operation are memory",
    "start": "536800",
    "end": "538640"
  },
  {
    "text": "mapping in which either the program is",
    "start": "538640",
    "end": "540640"
  },
  {
    "text": "loaded in memory as in the case of the",
    "start": "540640",
    "end": "542640"
  },
  {
    "text": "windows program router",
    "start": "542640",
    "end": "544320"
  },
  {
    "text": "or the tool create an abstract",
    "start": "544320",
    "end": "546959"
  },
  {
    "text": "representation of how the program looks",
    "start": "546959",
    "end": "548959"
  },
  {
    "text": "like when it's loaded in memory such as",
    "start": "548959",
    "end": "550880"
  },
  {
    "text": "in the case of reverse engineering tools",
    "start": "550880",
    "end": "553440"
  },
  {
    "text": "now it's important to highlight that all",
    "start": "553440",
    "end": "555440"
  },
  {
    "text": "these three types of operation can be",
    "start": "555440",
    "end": "558160"
  },
  {
    "text": "somehow deconstructed in a set of",
    "start": "558160",
    "end": "559839"
  },
  {
    "text": "constraints on the original input",
    "start": "559839",
    "end": "562959"
  },
  {
    "text": "in order to",
    "start": "562959",
    "end": "565040"
  },
  {
    "start": "564000",
    "end": "564000"
  },
  {
    "text": "easily",
    "start": "565040",
    "end": "566480"
  },
  {
    "text": "encode these constraints we created a",
    "start": "566480",
    "end": "569360"
  },
  {
    "text": "language a custom language",
    "start": "569360",
    "end": "572240"
  },
  {
    "text": "we have different type of statements in",
    "start": "572240",
    "end": "574560"
  },
  {
    "text": "this language and each of them try to",
    "start": "574560",
    "end": "576560"
  },
  {
    "text": "solve one problem that may arise during",
    "start": "576560",
    "end": "578959"
  },
  {
    "text": "the reverse engineering phase",
    "start": "578959",
    "end": "581040"
  },
  {
    "text": "the first type of statement is input",
    "start": "581040",
    "end": "583040"
  },
  {
    "text": "declaration statement",
    "start": "583040",
    "end": "585680"
  },
  {
    "start": "585000",
    "end": "585000"
  },
  {
    "text": "let's have a look to what we try to",
    "start": "585680",
    "end": "587760"
  },
  {
    "text": "solve with input declaration statements",
    "start": "587760",
    "end": "590560"
  },
  {
    "text": "here we have the original program that",
    "start": "590560",
    "end": "593279"
  },
  {
    "text": "reads the input file from an external",
    "start": "593279",
    "end": "596080"
  },
  {
    "text": "source",
    "start": "596080",
    "end": "597200"
  },
  {
    "text": "in our language we model this with an",
    "start": "597200",
    "end": "599360"
  },
  {
    "text": "input declaration statement in which we",
    "start": "599360",
    "end": "601360"
  },
  {
    "text": "create a",
    "start": "601360",
    "end": "603440"
  },
  {
    "text": "symbol of a symbolic variable in this",
    "start": "603440",
    "end": "605600"
  },
  {
    "text": "case we call it input file that we then",
    "start": "605600",
    "end": "608079"
  },
  {
    "text": "can use in our model",
    "start": "608079",
    "end": "611200"
  },
  {
    "text": "the second type of statement is symbol",
    "start": "611200",
    "end": "613040"
  },
  {
    "text": "definition statement",
    "start": "613040",
    "end": "614800"
  },
  {
    "text": "with which we create new variables with",
    "start": "614800",
    "end": "617519"
  },
  {
    "text": "mnemonic names whose values are",
    "start": "617519",
    "end": "621360"
  },
  {
    "text": "asset are given by a set of mathematical",
    "start": "621360",
    "end": "623920"
  },
  {
    "text": "operations on the input file",
    "start": "623920",
    "end": "627120"
  },
  {
    "start": "626000",
    "end": "626000"
  },
  {
    "text": "in the original program for example we",
    "start": "627120",
    "end": "628880"
  },
  {
    "text": "have that the original program we is",
    "start": "628880",
    "end": "631519"
  },
  {
    "text": "creating a new uh variable called mz",
    "start": "631519",
    "end": "634800"
  },
  {
    "text": "header",
    "start": "634800",
    "end": "636079"
  },
  {
    "text": "that is taken directly from the input",
    "start": "636079",
    "end": "638399"
  },
  {
    "text": "file we model this in our language by",
    "start": "638399",
    "end": "641279"
  },
  {
    "text": "introducing a symbol declaration",
    "start": "641279",
    "end": "643040"
  },
  {
    "text": "statement you see we have the mz header",
    "start": "643040",
    "end": "646079"
  },
  {
    "text": "to which we assign the um a value which",
    "start": "646079",
    "end": "649200"
  },
  {
    "text": "is computed",
    "start": "649200",
    "end": "650640"
  },
  {
    "text": "using the original input file as an",
    "start": "650640",
    "end": "653360"
  },
  {
    "text": "input",
    "start": "653360",
    "end": "655760"
  },
  {
    "text": "the third type of statement is our",
    "start": "656160",
    "end": "658480"
  },
  {
    "text": "predicates predicates are boolean",
    "start": "658480",
    "end": "660480"
  },
  {
    "text": "formulas that can evaluate either to",
    "start": "660480",
    "end": "662480"
  },
  {
    "text": "true or false and these predicates can",
    "start": "662480",
    "end": "665440"
  },
  {
    "text": "either be",
    "start": "665440",
    "end": "666720"
  },
  {
    "text": "terminal or non-terminal",
    "start": "666720",
    "end": "669440"
  },
  {
    "text": "terminal statements",
    "start": "669440",
    "end": "671600"
  },
  {
    "start": "670000",
    "end": "670000"
  },
  {
    "text": "try to model those constraints that must",
    "start": "671600",
    "end": "674720"
  },
  {
    "text": "be met by the original file in order to",
    "start": "674720",
    "end": "676880"
  },
  {
    "text": "be considered",
    "start": "676880",
    "end": "678160"
  },
  {
    "text": "valid",
    "start": "678160",
    "end": "679600"
  },
  {
    "text": "for example in the original program here",
    "start": "679600",
    "end": "681839"
  },
  {
    "text": "we see that it's it is trying it is",
    "start": "681839",
    "end": "684160"
  },
  {
    "text": "checking that the magic number in the mz",
    "start": "684160",
    "end": "686160"
  },
  {
    "text": "header is exactly m that",
    "start": "686160",
    "end": "689040"
  },
  {
    "text": "we can model this in our language by",
    "start": "689040",
    "end": "691200"
  },
  {
    "text": "introducing two terminal constraints you",
    "start": "691200",
    "end": "693600"
  },
  {
    "text": "see the term keyword at the end of the",
    "start": "693600",
    "end": "695760"
  },
  {
    "text": "statements is what",
    "start": "695760",
    "end": "697760"
  },
  {
    "text": "is what defined a predicate as terminal",
    "start": "697760",
    "end": "703079"
  },
  {
    "text": "then we have non-terminal predicates in",
    "start": "704160",
    "end": "706399"
  },
  {
    "text": "our language and these are very useful",
    "start": "706399",
    "end": "709279"
  },
  {
    "text": "as preconditions for conditional",
    "start": "709279",
    "end": "711120"
  },
  {
    "text": "statements any type of statements in our",
    "start": "711120",
    "end": "713200"
  },
  {
    "text": "language can be conditional and the",
    "start": "713200",
    "end": "715440"
  },
  {
    "text": "peculiarity of conditional statements is",
    "start": "715440",
    "end": "717760"
  },
  {
    "text": "that they are only executed if their",
    "start": "717760",
    "end": "719760"
  },
  {
    "text": "precondition is true",
    "start": "719760",
    "end": "722800"
  },
  {
    "start": "722000",
    "end": "722000"
  },
  {
    "text": "for example in the original program here",
    "start": "722800",
    "end": "725040"
  },
  {
    "text": "we have that",
    "start": "725040",
    "end": "726320"
  },
  {
    "text": "the software is checking that the",
    "start": "726320",
    "end": "727839"
  },
  {
    "text": "section alignment",
    "start": "727839",
    "end": "729360"
  },
  {
    "text": "is greater than a certain value if this",
    "start": "729360",
    "end": "732240"
  },
  {
    "text": "is the case it will perform some",
    "start": "732240",
    "end": "733760"
  },
  {
    "text": "operation operations and at a certain",
    "start": "733760",
    "end": "736160"
  },
  {
    "text": "point it will check that the number of",
    "start": "736160",
    "end": "737680"
  },
  {
    "text": "section",
    "start": "737680",
    "end": "738560"
  },
  {
    "text": "is equal to zero if that's the case the",
    "start": "738560",
    "end": "741360"
  },
  {
    "text": "file is considered invalid we can model",
    "start": "741360",
    "end": "743760"
  },
  {
    "text": "this in our language by first",
    "start": "743760",
    "end": "745600"
  },
  {
    "text": "introducing a non-terminal",
    "start": "745600",
    "end": "748240"
  },
  {
    "text": "predicate",
    "start": "748240",
    "end": "749360"
  },
  {
    "text": "see that there is no term keyword at the",
    "start": "749360",
    "end": "752000"
  },
  {
    "text": "end of the statement",
    "start": "752000",
    "end": "753519"
  },
  {
    "text": "and then a terminal statement which is",
    "start": "753519",
    "end": "756399"
  },
  {
    "text": "also conditional",
    "start": "756399",
    "end": "758160"
  },
  {
    "text": "in which we check that the number of",
    "start": "758160",
    "end": "759839"
  },
  {
    "text": "section is not equal to zero",
    "start": "759839",
    "end": "763680"
  },
  {
    "text": "in our language we also model we also",
    "start": "763680",
    "end": "766240"
  },
  {
    "text": "support loops which came really handy to",
    "start": "766240",
    "end": "768880"
  },
  {
    "text": "handle those constraints that the",
    "start": "768880",
    "end": "771120"
  },
  {
    "text": "original software",
    "start": "771120",
    "end": "772880"
  },
  {
    "text": "enforce on",
    "start": "772880",
    "end": "774399"
  },
  {
    "text": "each entry of a table like structure",
    "start": "774399",
    "end": "777120"
  },
  {
    "text": "such as the section table",
    "start": "777120",
    "end": "779680"
  },
  {
    "text": "we also support structured types and",
    "start": "779680",
    "end": "783200"
  },
  {
    "text": "the cool thing of our",
    "start": "783200",
    "end": "784800"
  },
  {
    "text": "language is that you can define your",
    "start": "784800",
    "end": "786720"
  },
  {
    "text": "structure types using c like",
    "start": "786720",
    "end": "789680"
  },
  {
    "text": "syntax",
    "start": "789680",
    "end": "791839"
  },
  {
    "start": "791000",
    "end": "791000"
  },
  {
    "text": "all right let's now give a look to our",
    "start": "791839",
    "end": "793680"
  },
  {
    "text": "analysis framework starting from the",
    "start": "793680",
    "end": "795360"
  },
  {
    "text": "validation mode",
    "start": "795360",
    "end": "797360"
  },
  {
    "start": "797000",
    "end": "797000"
  },
  {
    "text": "in validation mode we want to determine",
    "start": "797360",
    "end": "799200"
  },
  {
    "text": "whether an input file is valid according",
    "start": "799200",
    "end": "801839"
  },
  {
    "text": "to a model or not",
    "start": "801839",
    "end": "803440"
  },
  {
    "text": "and we can do that by means of the",
    "start": "803440",
    "end": "805440"
  },
  {
    "text": "procedural interpretation",
    "start": "805440",
    "end": "807440"
  },
  {
    "text": "technique",
    "start": "807440",
    "end": "808480"
  },
  {
    "text": "that consists in evaluating each",
    "start": "808480",
    "end": "810079"
  },
  {
    "text": "statement of the model using the data",
    "start": "810079",
    "end": "812880"
  },
  {
    "text": "from the input file",
    "start": "812880",
    "end": "814120"
  },
  {
    "text": "[Music]",
    "start": "814120",
    "end": "815519"
  },
  {
    "text": "the file is then considered",
    "start": "815519",
    "end": "817600"
  },
  {
    "text": "valid if all the terminal statements in",
    "start": "817600",
    "end": "819600"
  },
  {
    "text": "the model are true and invalid if even",
    "start": "819600",
    "end": "822160"
  },
  {
    "text": "one of those is evaluated to be false",
    "start": "822160",
    "end": "826720"
  },
  {
    "start": "825000",
    "end": "825000"
  },
  {
    "text": "now let's move on to the generation mode",
    "start": "826720",
    "end": "829040"
  },
  {
    "text": "generation mode is more complex than the",
    "start": "829040",
    "end": "831199"
  },
  {
    "text": "validation mode in fact we start from",
    "start": "831199",
    "end": "833519"
  },
  {
    "text": "some models but we cannot really",
    "start": "833519",
    "end": "835199"
  },
  {
    "text": "generate files directly from our model",
    "start": "835199",
    "end": "837519"
  },
  {
    "text": "so we first need to translate them into",
    "start": "837519",
    "end": "839680"
  },
  {
    "text": "something onto which we can work",
    "start": "839680",
    "end": "841360"
  },
  {
    "text": "mathematically and we do that by",
    "start": "841360",
    "end": "843519"
  },
  {
    "text": "translating models into smt problems",
    "start": "843519",
    "end": "846639"
  },
  {
    "text": "the smt problems are then fed to the z3",
    "start": "846639",
    "end": "849760"
  },
  {
    "text": "backend which is based on the sm1d z3",
    "start": "849760",
    "end": "853839"
  },
  {
    "text": "smt",
    "start": "853839",
    "end": "854839"
  },
  {
    "text": "solver that the tip that the three",
    "start": "854839",
    "end": "857680"
  },
  {
    "text": "backend can perform a lot of tasks for",
    "start": "857680",
    "end": "860399"
  },
  {
    "text": "example test case generation",
    "start": "860399",
    "end": "862320"
  },
  {
    "text": "differential analysis differences",
    "start": "862320",
    "end": "864399"
  },
  {
    "text": "enumeration and corner case generation",
    "start": "864399",
    "end": "866720"
  },
  {
    "text": "let's have a look to them but first",
    "start": "866720",
    "end": "868800"
  },
  {
    "text": "let's have a look to the translation",
    "start": "868800",
    "end": "870959"
  },
  {
    "start": "869000",
    "end": "869000"
  },
  {
    "text": "phase between models and smt problems",
    "start": "870959",
    "end": "874959"
  },
  {
    "text": "translation phase is based on the",
    "start": "874959",
    "end": "876720"
  },
  {
    "text": "equivalence between each type of",
    "start": "876720",
    "end": "878560"
  },
  {
    "text": "statement in our language and smt",
    "start": "878560",
    "end": "881440"
  },
  {
    "text": "problems",
    "start": "881440",
    "end": "883120"
  },
  {
    "text": "and",
    "start": "883120",
    "end": "884880"
  },
  {
    "text": "statements in an smt uh problem",
    "start": "884880",
    "end": "887920"
  },
  {
    "text": "input degradation statements are",
    "start": "887920",
    "end": "889680"
  },
  {
    "text": "translated into new and constraints bit",
    "start": "889680",
    "end": "892000"
  },
  {
    "text": "vector",
    "start": "892000",
    "end": "893440"
  },
  {
    "text": "symbol and predicates become new",
    "start": "893440",
    "end": "895279"
  },
  {
    "text": "mathematical formulas to which we give",
    "start": "895279",
    "end": "897279"
  },
  {
    "text": "mnemonic names",
    "start": "897279",
    "end": "899199"
  },
  {
    "text": "we handle loops by unrolling them up to",
    "start": "899199",
    "end": "901760"
  },
  {
    "text": "a certain number of iterations",
    "start": "901760",
    "end": "904160"
  },
  {
    "text": "and we translate structured types",
    "start": "904160",
    "end": "906800"
  },
  {
    "text": "into offsets and slices in the original",
    "start": "906800",
    "end": "909680"
  },
  {
    "text": "bit bit vector",
    "start": "909680",
    "end": "911519"
  },
  {
    "text": "once the translation is",
    "start": "911519",
    "end": "913279"
  },
  {
    "text": "finished we take all the",
    "start": "913279",
    "end": "915360"
  },
  {
    "text": "terminal predicates and we combine them",
    "start": "915360",
    "end": "917279"
  },
  {
    "text": "together in logic conjunction this",
    "start": "917279",
    "end": "919839"
  },
  {
    "text": "creates the statement that the smt",
    "start": "919839",
    "end": "922720"
  },
  {
    "text": "solver needs to assert in order to solve",
    "start": "922720",
    "end": "924959"
  },
  {
    "text": "the problem now it's important to",
    "start": "924959",
    "end": "927040"
  },
  {
    "text": "highlight that the solutions of an smt",
    "start": "927040",
    "end": "929600"
  },
  {
    "text": "problem",
    "start": "929600",
    "end": "931120"
  },
  {
    "text": "created in this way are p files that are",
    "start": "931120",
    "end": "933839"
  },
  {
    "text": "valid according to the model so they",
    "start": "933839",
    "end": "935759"
  },
  {
    "text": "respect all the terminal predicates",
    "start": "935759",
    "end": "939279"
  },
  {
    "start": "939000",
    "end": "939000"
  },
  {
    "text": "all right but how can we use these smt",
    "start": "939279",
    "end": "941680"
  },
  {
    "text": "problems for creating differential test",
    "start": "941680",
    "end": "944320"
  },
  {
    "text": "cases suppose that we have two models",
    "start": "944320",
    "end": "947120"
  },
  {
    "text": "that for which we want to create",
    "start": "947120",
    "end": "948959"
  },
  {
    "text": "differential test cases we take the",
    "start": "948959",
    "end": "951040"
  },
  {
    "text": "first one we translate it into its",
    "start": "951040",
    "end": "953120"
  },
  {
    "text": "formula we do the same for the second",
    "start": "953120",
    "end": "955680"
  },
  {
    "text": "model",
    "start": "955680",
    "end": "956800"
  },
  {
    "text": "then we take the two formulas and we",
    "start": "956800",
    "end": "958240"
  },
  {
    "text": "apply this um",
    "start": "958240",
    "end": "960079"
  },
  {
    "text": "logic operation take the first we do a",
    "start": "960079",
    "end": "962560"
  },
  {
    "text": "logic and with the negated version of",
    "start": "962560",
    "end": "964560"
  },
  {
    "text": "the second formula",
    "start": "964560",
    "end": "966079"
  },
  {
    "text": "this gives us a second smt problem",
    "start": "966079",
    "end": "968720"
  },
  {
    "text": "which solutions are",
    "start": "968720",
    "end": "970959"
  },
  {
    "text": "files that respect all the terminal",
    "start": "970959",
    "end": "972720"
  },
  {
    "text": "constraints of the first problem but",
    "start": "972720",
    "end": "975600"
  },
  {
    "text": "they break at least one of the",
    "start": "975600",
    "end": "977199"
  },
  {
    "text": "constraints of the second problem",
    "start": "977199",
    "end": "979600"
  },
  {
    "text": "actually our analysis framework is also",
    "start": "979600",
    "end": "981680"
  },
  {
    "text": "able to tell us automatically which are",
    "start": "981680",
    "end": "984240"
  },
  {
    "text": "the broken constraints in the second",
    "start": "984240",
    "end": "986160"
  },
  {
    "text": "model",
    "start": "986160",
    "end": "988240"
  },
  {
    "start": "987000",
    "end": "987000"
  },
  {
    "text": "this came really handy for",
    "start": "988240",
    "end": "990399"
  },
  {
    "text": "when we were implementing the",
    "start": "990399",
    "end": "991680"
  },
  {
    "text": "differences in enumeration technique",
    "start": "991680",
    "end": "993120"
  },
  {
    "text": "with which we want to find all the",
    "start": "993120",
    "end": "995040"
  },
  {
    "text": "differences between two models",
    "start": "995040",
    "end": "997360"
  },
  {
    "text": "this is a heuristic iterative approach",
    "start": "997360",
    "end": "999759"
  },
  {
    "text": "in which for each iteration we solve an",
    "start": "999759",
    "end": "1001759"
  },
  {
    "text": "smt problem that asserts some of the",
    "start": "1001759",
    "end": "1003920"
  },
  {
    "text": "previously negated constraints in the",
    "start": "1003920",
    "end": "1005680"
  },
  {
    "text": "second model this drives the smt solver",
    "start": "1005680",
    "end": "1009199"
  },
  {
    "text": "to find new ways",
    "start": "1009199",
    "end": "1010800"
  },
  {
    "text": "and new discrepancies between the two",
    "start": "1010800",
    "end": "1012639"
  },
  {
    "text": "models",
    "start": "1012639",
    "end": "1015120"
  },
  {
    "start": "1014000",
    "end": "1014000"
  },
  {
    "text": "in our analysis framework we also",
    "start": "1015360",
    "end": "1016959"
  },
  {
    "text": "implemented the corner case generation",
    "start": "1016959",
    "end": "1018800"
  },
  {
    "text": "technique",
    "start": "1018800",
    "end": "1019839"
  },
  {
    "text": "by which we create as many samples as",
    "start": "1019839",
    "end": "1022160"
  },
  {
    "text": "possible that are actually also",
    "start": "1022160",
    "end": "1024319"
  },
  {
    "text": "structurally different",
    "start": "1024319",
    "end": "1026160"
  },
  {
    "text": "to achieve that we leverage the",
    "start": "1026160",
    "end": "1028798"
  },
  {
    "text": "non-trivial statements in our models",
    "start": "1028799",
    "end": "1031678"
  },
  {
    "text": "for each iteration in fact we try to",
    "start": "1031679",
    "end": "1033678"
  },
  {
    "text": "assert different combinations of",
    "start": "1033679",
    "end": "1036240"
  },
  {
    "text": "non-terminal statements these result in",
    "start": "1036240",
    "end": "1040319"
  },
  {
    "text": "files that are structurally different",
    "start": "1040319",
    "end": "1042000"
  },
  {
    "text": "because the",
    "start": "1042000",
    "end": "1043360"
  },
  {
    "text": "original software would would use",
    "start": "1043360",
    "end": "1045520"
  },
  {
    "text": "different path in the in its code in",
    "start": "1045520",
    "end": "1048000"
  },
  {
    "text": "order to validate them",
    "start": "1048000",
    "end": "1051120"
  },
  {
    "text": "our analysis framework is also able to",
    "start": "1051440",
    "end": "1053360"
  },
  {
    "text": "generate samples that have customized um",
    "start": "1053360",
    "end": "1058240"
  },
  {
    "text": "customize the code",
    "start": "1058240",
    "end": "1060000"
  },
  {
    "text": "in um once it's loaded in memory",
    "start": "1060000",
    "end": "1063120"
  },
  {
    "text": "we do so by adding constraints to the",
    "start": "1063120",
    "end": "1065520"
  },
  {
    "text": "section content",
    "start": "1065520",
    "end": "1066960"
  },
  {
    "text": "of the original sample",
    "start": "1066960",
    "end": "1069440"
  },
  {
    "text": "and we're actually able to create",
    "start": "1069440",
    "end": "1071600"
  },
  {
    "text": "samples that execute valid code with",
    "start": "1071600",
    "end": "1073919"
  },
  {
    "text": "this technique even an hello world",
    "start": "1073919",
    "end": "1076640"
  },
  {
    "text": "sample",
    "start": "1076640",
    "end": "1077480"
  },
  {
    "text": "[Music]",
    "start": "1077480",
    "end": "1078799"
  },
  {
    "text": "all right let's have a look to some",
    "start": "1078799",
    "end": "1080960"
  },
  {
    "text": "results and findings of our work",
    "start": "1080960",
    "end": "1084160"
  },
  {
    "start": "1083000",
    "end": "1083000"
  },
  {
    "text": "to begin with we modeled this software",
    "start": "1084160",
    "end": "1086960"
  },
  {
    "text": "and we compared these these uh software",
    "start": "1086960",
    "end": "1090160"
  },
  {
    "text": "artifacts",
    "start": "1090160",
    "end": "1091520"
  },
  {
    "text": "the windows program loader versions xp 7",
    "start": "1091520",
    "end": "1094559"
  },
  {
    "text": "and 10 both the kernel space and the",
    "start": "1094559",
    "end": "1096640"
  },
  {
    "text": "user space component",
    "start": "1096640",
    "end": "1098480"
  },
  {
    "text": "we modeled claim of v specifically its p",
    "start": "1098480",
    "end": "1101679"
  },
  {
    "text": "parsing format specific signature engine",
    "start": "1101679",
    "end": "1105200"
  },
  {
    "text": "vardari 2 specifically how it handled",
    "start": "1105200",
    "end": "1108000"
  },
  {
    "text": "the memory mapping operations and yara",
    "start": "1108000",
    "end": "1110799"
  },
  {
    "text": "in particular its p module",
    "start": "1110799",
    "end": "1112810"
  },
  {
    "text": "[Music]",
    "start": "1112810",
    "end": "1114320"
  },
  {
    "start": "1113000",
    "end": "1113000"
  },
  {
    "text": "our tool actually found discrepancies",
    "start": "1114320",
    "end": "1116160"
  },
  {
    "text": "even between different versions of",
    "start": "1116160",
    "end": "1117679"
  },
  {
    "text": "windows",
    "start": "1117679",
    "end": "1119200"
  },
  {
    "text": "we found five of them in particular now",
    "start": "1119200",
    "end": "1121520"
  },
  {
    "text": "i don't have the time to go into details",
    "start": "1121520",
    "end": "1123440"
  },
  {
    "text": "of all of them or just mention one",
    "start": "1123440",
    "end": "1125520"
  },
  {
    "text": "briefly which i like the most and it's",
    "start": "1125520",
    "end": "1128480"
  },
  {
    "text": "uh the one about the relocations so",
    "start": "1128480",
    "end": "1130320"
  },
  {
    "text": "basically windows xp and 7 allows",
    "start": "1130320",
    "end": "1133039"
  },
  {
    "text": "executables to use any type of",
    "start": "1133039",
    "end": "1136720"
  },
  {
    "text": "um",
    "start": "1136720",
    "end": "1137520"
  },
  {
    "text": "architecture specific relocations even",
    "start": "1137520",
    "end": "1140799"
  },
  {
    "text": "though even if these are not actually",
    "start": "1140799",
    "end": "1143280"
  },
  {
    "text": "supported by the",
    "start": "1143280",
    "end": "1144799"
  },
  {
    "text": "architecture on which the program is",
    "start": "1144799",
    "end": "1146240"
  },
  {
    "text": "about to run for example in windows xp",
    "start": "1146240",
    "end": "1148240"
  },
  {
    "text": "and n7 you can use mip-specific",
    "start": "1148240",
    "end": "1151039"
  },
  {
    "text": "relocations even if you are running",
    "start": "1151039",
    "end": "1152720"
  },
  {
    "text": "under intel",
    "start": "1152720",
    "end": "1153919"
  },
  {
    "text": "executables that do this are discarded",
    "start": "1153919",
    "end": "1156240"
  },
  {
    "text": "by windows 10 as invalid",
    "start": "1156240",
    "end": "1159679"
  },
  {
    "start": "1159000",
    "end": "1159000"
  },
  {
    "text": "our tool also found discrepancies",
    "start": "1159679",
    "end": "1161520"
  },
  {
    "text": "between windows and claim of b",
    "start": "1161520",
    "end": "1163520"
  },
  {
    "text": "we found three of them in particular",
    "start": "1163520",
    "end": "1165520"
  },
  {
    "text": "again i don't have the time to explain",
    "start": "1165520",
    "end": "1167679"
  },
  {
    "text": "all of them uh we'll just mention one",
    "start": "1167679",
    "end": "1169840"
  },
  {
    "text": "which is we will see it's important in",
    "start": "1169840",
    "end": "1172799"
  },
  {
    "text": "uh in a moment it's about the number of",
    "start": "1172799",
    "end": "1175120"
  },
  {
    "text": "sections claim of the expects the file",
    "start": "1175120",
    "end": "1177440"
  },
  {
    "text": "to have at most 96 sections while",
    "start": "1177440",
    "end": "1179600"
  },
  {
    "text": "windows does not really have this",
    "start": "1179600",
    "end": "1181280"
  },
  {
    "text": "constraint",
    "start": "1181280",
    "end": "1182480"
  },
  {
    "text": "all these three discrepancies were",
    "start": "1182480",
    "end": "1184320"
  },
  {
    "text": "acknowledged by the developers of claim",
    "start": "1184320",
    "end": "1186000"
  },
  {
    "text": "of vs bugs and they are working on some",
    "start": "1186000",
    "end": "1188240"
  },
  {
    "text": "fixes",
    "start": "1188240",
    "end": "1190160"
  },
  {
    "start": "1189000",
    "end": "1189000"
  },
  {
    "text": "we also run a differential analysis",
    "start": "1190160",
    "end": "1192240"
  },
  {
    "text": "between the memory mapping operations of",
    "start": "1192240",
    "end": "1194320"
  },
  {
    "text": "all this software and we found one edge",
    "start": "1194320",
    "end": "1196559"
  },
  {
    "text": "case that all the tools we analyzed",
    "start": "1196559",
    "end": "1198799"
  },
  {
    "text": "handled",
    "start": "1198799",
    "end": "1200080"
  },
  {
    "text": "incorrectly in particular when the",
    "start": "1200080",
    "end": "1202080"
  },
  {
    "text": "section alignment is smaller than the",
    "start": "1202080",
    "end": "1204080"
  },
  {
    "text": "page size",
    "start": "1204080",
    "end": "1205440"
  },
  {
    "text": "executables with these characteristics",
    "start": "1205440",
    "end": "1207600"
  },
  {
    "text": "are mapped by windows directly in memory",
    "start": "1207600",
    "end": "1209760"
  },
  {
    "text": "as they are completely disregarding",
    "start": "1209760",
    "end": "1211840"
  },
  {
    "text": "their section table",
    "start": "1211840",
    "end": "1213840"
  },
  {
    "text": "radari guarantee nfv on the other hand",
    "start": "1213840",
    "end": "1216559"
  },
  {
    "text": "still infer the mapping of these",
    "start": "1216559",
    "end": "1218559"
  },
  {
    "text": "programs using the section table",
    "start": "1218559",
    "end": "1222000"
  },
  {
    "text": "we could not find any documentation",
    "start": "1222000",
    "end": "1223600"
  },
  {
    "text": "about this behavior so we were not",
    "start": "1223600",
    "end": "1225360"
  },
  {
    "text": "really surprised that the tools got this",
    "start": "1225360",
    "end": "1228159"
  },
  {
    "text": "wrong",
    "start": "1228159",
    "end": "1229760"
  },
  {
    "start": "1229000",
    "end": "1229000"
  },
  {
    "text": "so i've looked to one notable test case",
    "start": "1229760",
    "end": "1232159"
  },
  {
    "text": "that was created by comparing the memory",
    "start": "1232159",
    "end": "1234720"
  },
  {
    "text": "mapping operations of windows and radar",
    "start": "1234720",
    "end": "1236960"
  },
  {
    "text": "in particular",
    "start": "1236960",
    "end": "1239120"
  },
  {
    "text": "this is the optional letter of this test",
    "start": "1239120",
    "end": "1241120"
  },
  {
    "text": "case as you can see the section",
    "start": "1241120",
    "end": "1242960"
  },
  {
    "text": "alignment is four so it's smaller than",
    "start": "1242960",
    "end": "1245919"
  },
  {
    "text": "the the",
    "start": "1245919",
    "end": "1247679"
  },
  {
    "text": "the page size",
    "start": "1247679",
    "end": "1249600"
  },
  {
    "text": "the entry point is at this address which",
    "start": "1249600",
    "end": "1252159"
  },
  {
    "text": "means that the test case will execute",
    "start": "1252159",
    "end": "1254799"
  },
  {
    "text": "these two instructions which are",
    "start": "1254799",
    "end": "1257280"
  },
  {
    "text": "basically just return 0 in in c",
    "start": "1257280",
    "end": "1262080"
  },
  {
    "text": "this test case also have a one section",
    "start": "1262080",
    "end": "1265360"
  },
  {
    "text": "which start at this address",
    "start": "1265360",
    "end": "1267600"
  },
  {
    "text": "now you can notice that the section",
    "start": "1267600",
    "end": "1269760"
  },
  {
    "text": "table and the optional letter overlaps",
    "start": "1269760",
    "end": "1272400"
  },
  {
    "text": "our analysis framework actually",
    "start": "1272400",
    "end": "1275039"
  },
  {
    "text": "loves to do",
    "start": "1275039",
    "end": "1276720"
  },
  {
    "text": "things like this that you don't really",
    "start": "1276720",
    "end": "1278480"
  },
  {
    "text": "find in normal executables",
    "start": "1278480",
    "end": "1281600"
  },
  {
    "text": "now when you run this test case in",
    "start": "1281600",
    "end": "1283600"
  },
  {
    "text": "windows",
    "start": "1283600",
    "end": "1284799"
  },
  {
    "text": "you have something like this so as you",
    "start": "1284799",
    "end": "1286720"
  },
  {
    "text": "can see these are the very same bytes",
    "start": "1286720",
    "end": "1288880"
  },
  {
    "text": "that we saw before because the pro the",
    "start": "1288880",
    "end": "1290720"
  },
  {
    "text": "program is mapped in memory as it is and",
    "start": "1290720",
    "end": "1292960"
  },
  {
    "text": "in the last line we can see that it's",
    "start": "1292960",
    "end": "1294799"
  },
  {
    "text": "already executing the instruction the",
    "start": "1294799",
    "end": "1297039"
  },
  {
    "text": "first instruction that we um with which",
    "start": "1297039",
    "end": "1299679"
  },
  {
    "text": "we",
    "start": "1299679",
    "end": "1301039"
  },
  {
    "text": "customized the",
    "start": "1301039",
    "end": "1303200"
  },
  {
    "text": "text code",
    "start": "1303200",
    "end": "1305039"
  },
  {
    "text": "when you open this in radari on the",
    "start": "1305039",
    "end": "1306960"
  },
  {
    "text": "other hand you find this",
    "start": "1306960",
    "end": "1309200"
  },
  {
    "text": "so radar is not able at all",
    "start": "1309200",
    "end": "1311200"
  },
  {
    "text": "to find anything once the program is",
    "start": "1311200",
    "end": "1313440"
  },
  {
    "text": "loaded in memory",
    "start": "1313440",
    "end": "1314240"
  },
  {
    "text": "[Music]",
    "start": "1314240",
    "end": "1316320"
  },
  {
    "text": "all right we found these discrepancies",
    "start": "1316320",
    "end": "1318080"
  },
  {
    "text": "and we asked ourselves is it is there",
    "start": "1318080",
    "end": "1320400"
  },
  {
    "text": "any",
    "start": "1320400",
    "end": "1321280"
  },
  {
    "text": "way to find out whether malware outdoors",
    "start": "1321280",
    "end": "1324159"
  },
  {
    "text": "are already knowledgeable about them and",
    "start": "1324159",
    "end": "1326000"
  },
  {
    "text": "if they are already um",
    "start": "1326000",
    "end": "1328240"
  },
  {
    "text": "exploiting them in the wild to answer",
    "start": "1328240",
    "end": "1330400"
  },
  {
    "text": "this question we run a",
    "start": "1330400",
    "end": "1333120"
  },
  {
    "text": "virustotal live hunt",
    "start": "1333120",
    "end": "1334960"
  },
  {
    "text": "for which we created yara rules that",
    "start": "1334960",
    "end": "1336720"
  },
  {
    "text": "match all the discrepancies we",
    "start": "1336720",
    "end": "1338720"
  },
  {
    "text": "discovered",
    "start": "1338720",
    "end": "1339840"
  },
  {
    "text": "in our work except one of the",
    "start": "1339840",
    "end": "1341520"
  },
  {
    "text": "relocations due to technical limitations",
    "start": "1341520",
    "end": "1344080"
  },
  {
    "text": "of vr",
    "start": "1344080",
    "end": "1345120"
  },
  {
    "text": "we run this campaign from the 7th to the",
    "start": "1345120",
    "end": "1347760"
  },
  {
    "text": "19th of october and we estimate to have",
    "start": "1347760",
    "end": "1349840"
  },
  {
    "text": "scanned something around 5 million",
    "start": "1349840",
    "end": "1351919"
  },
  {
    "text": "samples during this period",
    "start": "1351919",
    "end": "1355279"
  },
  {
    "start": "1354000",
    "end": "1354000"
  },
  {
    "text": "now we were reported with we were",
    "start": "1355360",
    "end": "1357919"
  },
  {
    "text": "prompted with 467 samples that match at",
    "start": "1357919",
    "end": "1361200"
  },
  {
    "text": "least one of the yara roots we provided",
    "start": "1361200",
    "end": "1364640"
  },
  {
    "text": "and it's important to highlight that",
    "start": "1364640",
    "end": "1366960"
  },
  {
    "text": "all the rules that we provided measure",
    "start": "1366960",
    "end": "1368799"
  },
  {
    "text": "at least one sample",
    "start": "1368799",
    "end": "1371280"
  },
  {
    "text": "the most prominent about the",
    "start": "1371280",
    "end": "1374080"
  },
  {
    "text": "discrepancy seems to be the one about",
    "start": "1374080",
    "end": "1376000"
  },
  {
    "text": "the section alignment with 301 samples",
    "start": "1376000",
    "end": "1379039"
  },
  {
    "text": "matching this may trigger different",
    "start": "1379039",
    "end": "1380799"
  },
  {
    "text": "mappings in the software",
    "start": "1380799",
    "end": "1383679"
  },
  {
    "text": "the second most prominent discrepancy",
    "start": "1383679",
    "end": "1386159"
  },
  {
    "text": "seems to be the one about the 96 96",
    "start": "1386159",
    "end": "1389520"
  },
  {
    "text": "sections for claim of v with 77 samples",
    "start": "1389520",
    "end": "1392880"
  },
  {
    "text": "matching the corresponding error rule",
    "start": "1392880",
    "end": "1396720"
  },
  {
    "text": "we actually analyzed some of them",
    "start": "1396720",
    "end": "1398720"
  },
  {
    "text": "manually",
    "start": "1398720",
    "end": "1399760"
  },
  {
    "text": "and we discovered that they had 97",
    "start": "1399760",
    "end": "1402240"
  },
  {
    "text": "sections exactly which you know",
    "start": "1402240",
    "end": "1405360"
  },
  {
    "text": "to us seems that it was probably done on",
    "start": "1405360",
    "end": "1407440"
  },
  {
    "text": "purpose",
    "start": "1407440",
    "end": "1410000"
  },
  {
    "text": "all right let's now give a few more",
    "start": "1410080",
    "end": "1412480"
  },
  {
    "text": "words and a few takeaways from our work",
    "start": "1412480",
    "end": "1416080"
  },
  {
    "start": "1415000",
    "end": "1415000"
  },
  {
    "text": "so i believe that",
    "start": "1416080",
    "end": "1417679"
  },
  {
    "text": "the most important lesson that we",
    "start": "1417679",
    "end": "1419440"
  },
  {
    "text": "learned during our work is that there is",
    "start": "1419440",
    "end": "1421200"
  },
  {
    "text": "not really one way to enter the vp file",
    "start": "1421200",
    "end": "1423679"
  },
  {
    "text": "format and even if you want to consider",
    "start": "1423679",
    "end": "1425440"
  },
  {
    "text": "windows as the reference implementation",
    "start": "1425440",
    "end": "1428000"
  },
  {
    "text": "of how to parse the pa file format then",
    "start": "1428000",
    "end": "1430080"
  },
  {
    "text": "you should also specify which version of",
    "start": "1430080",
    "end": "1432159"
  },
  {
    "text": "windows you take as a",
    "start": "1432159",
    "end": "1434480"
  },
  {
    "text": "reference implementation because as we",
    "start": "1434480",
    "end": "1436240"
  },
  {
    "text": "saw all of them have small quirks and",
    "start": "1436240",
    "end": "1438640"
  },
  {
    "text": "small edge cases that they handle",
    "start": "1438640",
    "end": "1440799"
  },
  {
    "text": "differently",
    "start": "1440799",
    "end": "1443120"
  },
  {
    "text": "we believe that we need more clear and",
    "start": "1443120",
    "end": "1445200"
  },
  {
    "text": "more formal specification for the pe",
    "start": "1445200",
    "end": "1447200"
  },
  {
    "text": "file format and we also need a publicly",
    "start": "1447200",
    "end": "1449840"
  },
  {
    "text": "available reference implementation but",
    "start": "1449840",
    "end": "1451679"
  },
  {
    "text": "this of course takes time so in the",
    "start": "1451679",
    "end": "1453679"
  },
  {
    "text": "meantime we advise developers of",
    "start": "1453679",
    "end": "1456320"
  },
  {
    "text": "security tools to model more than one",
    "start": "1456320",
    "end": "1458640"
  },
  {
    "text": "version of the windows loader possibly",
    "start": "1458640",
    "end": "1460880"
  },
  {
    "text": "asking the user",
    "start": "1460880",
    "end": "1462880"
  },
  {
    "text": "which one to employ for their analysis",
    "start": "1462880",
    "end": "1465440"
  },
  {
    "text": "for their analysis",
    "start": "1465440",
    "end": "1466490"
  },
  {
    "text": "[Music]",
    "start": "1466490",
    "end": "1468000"
  },
  {
    "text": "we believe that our language and",
    "start": "1468000",
    "end": "1469360"
  },
  {
    "text": "framework is the reverse engineering",
    "start": "1469360",
    "end": "1471600"
  },
  {
    "text": "effort to build these models and that's",
    "start": "1471600",
    "end": "1473760"
  },
  {
    "text": "the reason for which we um release",
    "start": "1473760",
    "end": "1476159"
  },
  {
    "text": "everything as open source both the",
    "start": "1476159",
    "end": "1478080"
  },
  {
    "text": "framework and the models you can check",
    "start": "1478080",
    "end": "1480159"
  },
  {
    "text": "it out our github repository",
    "start": "1480159",
    "end": "1482880"
  },
  {
    "text": "all right with that being said my talk",
    "start": "1482880",
    "end": "1485279"
  },
  {
    "text": "is concluded so i",
    "start": "1485279",
    "end": "1486799"
  },
  {
    "text": "will gladly answer your questions if you",
    "start": "1486799",
    "end": "1489440"
  },
  {
    "text": "happen to have any",
    "start": "1489440",
    "end": "1491460"
  },
  {
    "text": "[Music]",
    "start": "1491460",
    "end": "1501089"
  },
  {
    "text": "you",
    "start": "1501600",
    "end": "1503679"
  }
]