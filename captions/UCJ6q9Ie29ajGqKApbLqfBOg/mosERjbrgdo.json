[
  {
    "text": "do you guys hear me yep I guess for the fall I would like to thank you all for being here I know it was a really long",
    "start": "30",
    "end": "6359"
  },
  {
    "text": "walk all the way to this room in the end of the bed so thank you for that",
    "start": "6359",
    "end": "12090"
  },
  {
    "text": "so this talk this is a presentation has multiple presentations inside there is",
    "start": "12090",
    "end": "19170"
  },
  {
    "text": "like many layers of things that you will learn that you can do with VMC's and I",
    "start": "19170",
    "end": "26189"
  },
  {
    "text": "don't want you to get out the talk which has the idea of of exploits exploits to be honest is the less important thing on",
    "start": "26189",
    "end": "32758"
  },
  {
    "text": "this presentation so if there's something that you know I want to",
    "start": "32759",
    "end": "38040"
  },
  {
    "text": "transmit on this presentation is that um yeah don't don't don't don't concentrate",
    "start": "38040",
    "end": "43440"
  },
  {
    "text": "on the actual even though they're like remote code execution uneducated you know all the cool things that's not important of the presentation but rather",
    "start": "43440",
    "end": "49620"
  },
  {
    "text": "the mobile things that you will be able to see and do with BMC anyways I guess",
    "start": "49620",
    "end": "56250"
  },
  {
    "text": "everyone works computer here and if you ever want a computer and you have an",
    "start": "56250",
    "end": "62010"
  },
  {
    "text": "elder your family I'm sure they will at some point contact you and ask you for",
    "start": "62010",
    "end": "68070"
  },
  {
    "text": "help for one of your problems that they have in a computer so I mean I want to",
    "start": "68070",
    "end": "73080"
  },
  {
    "text": "do this a little bit interactive so what would be the one and only solution for pretty much all the problems and",
    "start": "73080",
    "end": "78840"
  },
  {
    "text": "computers raise your hand what you said restart exactly so obviously restart is",
    "start": "78840",
    "end": "86369"
  },
  {
    "text": "mainly made the resolution to 99.99% of all the problems on computers so what",
    "start": "86369",
    "end": "93689"
  },
  {
    "text": "happened when those problems happen on data centers right as you can see in the",
    "start": "93689",
    "end": "100259"
  },
  {
    "text": "screen there's a lot of service there some of them are screaming to being rebooted and obviously someone has to go",
    "start": "100259",
    "end": "106740"
  },
  {
    "text": "and you know actually press that button and I don't know if you have ever been in a colocation I have been on each one",
    "start": "106740",
    "end": "116310"
  },
  {
    "text": "because I don't know if you know but um we wasn't bought by a coalition company so now we really love collocations but",
    "start": "116310",
    "end": "123869"
  },
  {
    "text": "we don't love to be there and I'm sure everyone has had been here hate to go to Colossians and I mean you love to have",
    "start": "123869",
    "end": "131340"
  },
  {
    "text": "your servers there but you hate to go personally there and there are many reasons for that and the main reason you",
    "start": "131340",
    "end": "137850"
  },
  {
    "text": "can see in this picture you see a chair there I don't and that's one of the",
    "start": "137850",
    "end": "142920"
  },
  {
    "text": "problems collocation you end up working standing probably the only person that can or not a person but the animal that",
    "start": "142920",
    "end": "150000"
  },
  {
    "text": "can be sitting down would be a dog or your animal I don't know what kind of colocation allow dogs in but I would",
    "start": "150000",
    "end": "156390"
  },
  {
    "text": "really want you know definitely not ours so the other problem with colocation is",
    "start": "156390",
    "end": "162930"
  },
  {
    "text": "a super call so everyone really wouldn't go to Caucasians like you know wearing",
    "start": "162930",
    "end": "170490"
  },
  {
    "text": "multiple layers of clothes and everyone's unhappy in collocations because you have to drive like 45",
    "start": "170490",
    "end": "175830"
  },
  {
    "text": "minutes to your next collocation and you'll be looking at this picture and be like well this little actually look",
    "start": "175830",
    "end": "181830"
  },
  {
    "text": "happy and the reason they look happy is because they already fix opponents and they know that we're going back home but",
    "start": "181830",
    "end": "187380"
  },
  {
    "text": "there's only one dude that is not happy and you know why he's not happy he's not happy because he's the one that lives",
    "start": "187380",
    "end": "193200"
  },
  {
    "text": "closer to the collocation so he knows that as soon everyone returns it's gonna be back and and then once I was gonna",
    "start": "193200",
    "end": "199650"
  },
  {
    "text": "crash and he's gonna be the only one going back to the collocation and and this will have to go all the way from my",
    "start": "199650",
    "end": "205709"
  },
  {
    "text": "wedding to the collocation because that's how it works when you work in Aichi and you're on alert anyways most important slide of this",
    "start": "205709",
    "end": "213090"
  },
  {
    "text": "presentation who we are my name is Nico Wiseman I'm a VP at immunity also work",
    "start": "213090",
    "end": "219510"
  },
  {
    "text": "at immunity as a security researcher bmc's I hope I will be able to say",
    "start": "219510",
    "end": "227520"
  },
  {
    "text": "exactly what it means it's base van management control is that correct yep may be MCS bmc's are this interesting",
    "start": "227520",
    "end": "236250"
  },
  {
    "text": "device that works completely independent from the US and you will find it in like",
    "start": "236250",
    "end": "241500"
  },
  {
    "text": "big servers and they're interesting we can allow you to remote control the",
    "start": "241500",
    "end": "247650"
  },
  {
    "text": "server and they're kind of isolated self from the server they can connect and do many things but there are completely",
    "start": "247650",
    "end": "254760"
  },
  {
    "text": "different device from the server itself and it's super interesting because basically the VM sirs are the answer to",
    "start": "254760",
    "end": "263530"
  },
  {
    "text": "I pee people being like I don't want to drive to the collocation so if they turn up they come up with a idea to allow",
    "start": "263530",
    "end": "270340"
  },
  {
    "text": "them to monitor the temperature the bolt is the fans and as you can see in this graph from one of the many Bender's that",
    "start": "270340",
    "end": "279250"
  },
  {
    "text": "put together be MCS you there's a lot of really interesting informations you can",
    "start": "279250",
    "end": "284260"
  },
  {
    "text": "pinpoint exactly the temperature and different parts of the chasis of a",
    "start": "284260",
    "end": "289360"
  },
  {
    "text": "server so in reality they are super interesting however as I explained they're basically a machine inside a",
    "start": "289360",
    "end": "296620"
  },
  {
    "text": "machine so you know it has a lot of different really cool features like has",
    "start": "296620",
    "end": "302800"
  },
  {
    "text": "a full network stack inside the little device it has KVM so it's keyboard video",
    "start": "302800",
    "end": "309220"
  },
  {
    "text": "and mouse it has a direct serial console to the server and obviously you can do",
    "start": "309220",
    "end": "315970"
  },
  {
    "text": "power manners basically you can revert but obviously you want that because you know you don't want to be other",
    "start": "315970",
    "end": "321580"
  },
  {
    "text": "collocations you want to remotely connect to the BMC and from that point manage the server when the server crash",
    "start": "321580",
    "end": "328720"
  },
  {
    "text": "and there is no way to remotely connect to your server however if you think about it it's kind of like the perfect backdoor",
    "start": "328720",
    "end": "335140"
  },
  {
    "text": "right it's like you can remotely connect to the Machine you can reboot it you can",
    "start": "335140",
    "end": "340870"
  },
  {
    "text": "you know manage the keyboard the video the mouse but there's always always someone the crowd will be like this is",
    "start": "340870",
    "end": "346960"
  },
  {
    "text": "not the perfect backdoor because if the server is down the back there is down",
    "start": "346960",
    "end": "352600"
  },
  {
    "text": "however let me tell you something the interesting thing about BMC's is that no",
    "start": "352600",
    "end": "358210"
  },
  {
    "text": "matter if there's electricity go into the server the B and C will be on which",
    "start": "358210",
    "end": "363250"
  },
  {
    "text": "makes sense though but if the server is down the BMC can still be on and keep that in mind because as we continue",
    "start": "363250",
    "end": "369910"
  },
  {
    "text": "talking about the different things you will be able to do with BMC once you compromise it this feature is quite",
    "start": "369910",
    "end": "375970"
  },
  {
    "text": "interesting so IPMI stands for intelligent platform",
    "start": "375970",
    "end": "381160"
  },
  {
    "text": "management interface for all but it is basically a set of standards and conventions that were put together in",
    "start": "381160",
    "end": "386530"
  },
  {
    "text": "order to define how this with mode management devices should work and how",
    "start": "386530",
    "end": "391960"
  },
  {
    "text": "the different components should work together so the the main component here is the",
    "start": "391960",
    "end": "397539"
  },
  {
    "text": "BMC the Nico was talking about which is in the end just a small computer in there has some microprocessor memory",
    "start": "397539",
    "end": "403769"
  },
  {
    "text": "storage space and it is actually running an operative ship thing in there this device has multiple connections to",
    "start": "403769",
    "end": "412179"
  },
  {
    "text": "different ports and if I were to access different devices on the chassis some on the server so for example it will have",
    "start": "412179",
    "end": "418629"
  },
  {
    "text": "access via port which is called IP mb i pmed sub-grant of i square c be at least",
    "start": "418629",
    "end": "426939"
  },
  {
    "text": "this port you will be able to access the Defense Fund sensors to get a speed and",
    "start": "426939",
    "end": "432459"
  },
  {
    "text": "temperature sensors and all sorts of stuff to be able to monitor the server but these devices also have an Ethernet",
    "start": "432459",
    "end": "439239"
  },
  {
    "text": "card usually they have a standalone curve for this for themselves so that you can actually access them or get to",
    "start": "439239",
    "end": "445209"
  },
  {
    "text": "the welkins or whatever some other times instead of that what they have is we",
    "start": "445209",
    "end": "451689"
  },
  {
    "text": "have what is called side channel access to the main network interface from the",
    "start": "451689",
    "end": "457029"
  },
  {
    "text": "host so they are able to tell that that interface hey these packets please send",
    "start": "457029",
    "end": "463479"
  },
  {
    "text": "them to me basically it come you can configure a couple of filters to see what packages go to the house and which",
    "start": "463479",
    "end": "469029"
  },
  {
    "text": "ones go to the IBM see these devices the DBM see also have connections to the",
    "start": "469029",
    "end": "475089"
  },
  {
    "text": "power supply unit on the server so it can power on or off the server or monitored the the power consumption and",
    "start": "475089",
    "end": "480989"
  },
  {
    "text": "most interesting is that they usually are connected to one of the main buses",
    "start": "480989",
    "end": "486099"
  },
  {
    "text": "of the server such as PCI or PCI Express for example so each of the main vendors",
    "start": "486099",
    "end": "492909"
  },
  {
    "text": "on the market have they or their own implementation of this their own variant they all offer similar features to you",
    "start": "492909",
    "end": "501759"
  },
  {
    "text": "beyond these writers but they have some differences so for example you have Dell with idrac HP has I know in",
    "start": "501759",
    "end": "509739"
  },
  {
    "text": "different versions two four and one also and lenovo has IMM so let's see a little bit the",
    "start": "509739",
    "end": "516879"
  },
  {
    "text": "differences between each other when you go to HP ila - this is built around a",
    "start": "516879",
    "end": "524439"
  },
  {
    "text": "microprocessor which is called Nagbe 850 so this is a very processor that was originally used in",
    "start": "524439",
    "end": "531190"
  },
  {
    "text": "optical drives and hard disks so you can imagine that having that processor",
    "start": "531190",
    "end": "536200"
  },
  {
    "text": "running a real OS is kind of slow right speaking of the u.s. these things run an",
    "start": "536200",
    "end": "543130"
  },
  {
    "text": "operating system called thread X apparently this this OS was this is a",
    "start": "543130",
    "end": "548380"
  },
  {
    "text": "real-time OS and it was pretty well known on the MIDI device world back back in the times but honestly the first time",
    "start": "548380",
    "end": "555010"
  },
  {
    "text": "I saw it so it was when we did this research from the Roberson's time point",
    "start": "555010",
    "end": "560890"
  },
  {
    "text": "of view when you unpack the binary when what you end up with is just one huge",
    "start": "560890",
    "end": "565990"
  },
  {
    "text": "binary one huge thing that you can load into IRA whatever but in there you have like all the functions that handle",
    "start": "565990",
    "end": "572560"
  },
  {
    "text": "everything like all the fault for the handle a big web server the IP mi server the ssh server like everything is one",
    "start": "572560",
    "end": "578590"
  },
  {
    "text": "big thing on the right side the the assembly for this processor is very nice",
    "start": "578590",
    "end": "584980"
  },
  {
    "text": "so after a couple of hours you are working with it you get used to to the syntax and it's very very easy to",
    "start": "584980",
    "end": "591010"
  },
  {
    "text": "understand this is a 32-bit bit risk we heard rumors that there's some source code in the internet but we were not",
    "start": "591010",
    "end": "598210"
  },
  {
    "text": "able to access it but we heard that there's some Chinese website at somewhere so yeah although a lot of",
    "start": "598210",
    "end": "605410"
  },
  {
    "text": "these sources are closed source when we move to a low four so we were working a",
    "start": "605410",
    "end": "610750"
  },
  {
    "text": "couple of weeks we file achieve and then we move to idle for we have to do what we were expecting to be able to reuse",
    "start": "610750",
    "end": "617260"
  },
  {
    "text": "like everything I have learned the previous week's we're working with these devices but the truth is that didn't",
    "start": "617260",
    "end": "623230"
  },
  {
    "text": "work very well because HP decided to redesign the whole thing when they move 1204 so they are now now using arm which",
    "start": "623230",
    "end": "630190"
  },
  {
    "text": "is good because no arm is pretty cool well-known processor yeah there's a lot of information examples in the internet",
    "start": "630190",
    "end": "635470"
  },
  {
    "text": "or whatever tools everybody supports it but it's arm like you have to read arm",
    "start": "635470",
    "end": "640630"
  },
  {
    "text": "assembly and that's like really really bad during the u.s. they are using one that",
    "start": "640630",
    "end": "647050"
  },
  {
    "text": "is called GHS integrity source for real-time OS built by the same companies before so things that are similar",
    "start": "647050",
    "end": "655120"
  },
  {
    "text": "what's good is that when we move to I drug from Dell in this case while they",
    "start": "655120",
    "end": "660940"
  },
  {
    "text": "are using a processor it's called super 8 if does it ring a bell for anybody here",
    "start": "660940",
    "end": "666280"
  },
  {
    "text": "super H yeah I bet you are gamers right no I was used in the console called Sega",
    "start": "666280",
    "end": "674830"
  },
  {
    "text": "Saturn the Sega Saturn console back in the nineties angry days but the good thing about Iraq is that it's Linux base",
    "start": "674830",
    "end": "681610"
  },
  {
    "text": "so for us trying to understand how this thing works it's really good because you",
    "start": "681610",
    "end": "687130"
  },
  {
    "text": "end up analyzing unknown file system known tools known services configuration files if you want to reverse or analyze",
    "start": "687130",
    "end": "694960"
  },
  {
    "text": "a specific service you can grab that binary by itself and loaded into iodine",
    "start": "694960",
    "end": "700030"
  },
  {
    "text": "you don't have to deal with the whole thing so this one is much more easier to work with so we did Richard we were like",
    "start": "700030",
    "end": "708850"
  },
  {
    "text": "very limited scope and we have a lot of different things to cover so what we",
    "start": "708850",
    "end": "714910"
  },
  {
    "text": "decide to do is to concentrate on the most fruitful vulnerabilities so we",
    "start": "714910",
    "end": "720580"
  },
  {
    "text": "decided to go for it's not release attacks of course but you go for like pre authentication if possible remote",
    "start": "720580",
    "end": "726760"
  },
  {
    "text": "code execution kind of vulnerabilities there are like multiple things you can do like Matt in the middle post out",
    "start": "726760",
    "end": "733480"
  },
  {
    "text": "things which are it sounds like it's not but they are useful as we learn later on",
    "start": "733480",
    "end": "738700"
  },
  {
    "text": "the research however for example most of these devices run on an out-of-band network and you know my man in the",
    "start": "738700",
    "end": "746140"
  },
  {
    "text": "middle might be helpful but not really to be honest you have to already being",
    "start": "746140",
    "end": "751150"
  },
  {
    "text": "that never and that's like a big step so we decide to go three off and and when",
    "start": "751150",
    "end": "758050"
  },
  {
    "text": "we start out eating this thing one of the things we realize is that it's very",
    "start": "758050",
    "end": "763500"
  },
  {
    "text": "exciting to do it I don't think I don't think Zod we're gonna work and I'm gonna",
    "start": "763500",
    "end": "769360"
  },
  {
    "text": "try no it sounds like and that's like four hours and hours because I don't",
    "start": "769360",
    "end": "775120"
  },
  {
    "text": "know if you ever out in anything you spend like hours and hours trying things and and the other thing is some of these",
    "start": "775120",
    "end": "782710"
  },
  {
    "text": "things are super all like we start out it in I love you you have to install",
    "start": "782710",
    "end": "788320"
  },
  {
    "text": "like very old Firefox just to be able to deal with the all certificate",
    "start": "788320",
    "end": "795160"
  },
  {
    "text": "yeah the ssl was slowly broken and you couldn't use anymore and browsers to access like a pain you Hudgins a lobby",
    "start": "795160",
    "end": "801490"
  },
  {
    "text": "em just to able to accident yeah so he's like super flow it was horrible so the",
    "start": "801490",
    "end": "810400"
  },
  {
    "text": "attack surfing so as I say before we have three or actually four different targets and we only have a certain",
    "start": "810400",
    "end": "817390"
  },
  {
    "text": "amount of time so what we thought we will do is try to decide which will be",
    "start": "817390",
    "end": "822730"
  },
  {
    "text": "the better protocols that we killed ears and then translate that into the",
    "start": "822730",
    "end": "828580"
  },
  {
    "text": "different the different devices that we can use so we thought you know let's put",
    "start": "828580",
    "end": "835000"
  },
  {
    "text": "together at least and then you know and right fasters and out it and understand",
    "start": "835000",
    "end": "840130"
  },
  {
    "text": "the protocol so then we will move from one on the other will be super easy to do one of the things you start learning",
    "start": "840130",
    "end": "845320"
  },
  {
    "text": "is that even though it sounds that they share a lot of different protocols in",
    "start": "845320",
    "end": "851350"
  },
  {
    "text": "reality when you start looking at them everyone that's what they want like they will they look like the other similar",
    "start": "851350",
    "end": "857350"
  },
  {
    "text": "protocols but will start like digging a little bit more like some of these stuff are really really different form on each",
    "start": "857350",
    "end": "863380"
  },
  {
    "text": "other and it and it's kind of weird because like this is a thing that you eventually want to automatize you want",
    "start": "863380",
    "end": "869860"
  },
  {
    "text": "to be able to control multiple servers at the same time so if they're from different brands some of the protocol",
    "start": "869860",
    "end": "875110"
  },
  {
    "text": "will really really make your life miserable so the first one we look at it",
    "start": "875110",
    "end": "880300"
  },
  {
    "text": "was the smash which is basically a common line standarized but this",
    "start": "880300",
    "end": "886980"
  },
  {
    "text": "organization called D TMS which has nothing to do with phones and and this",
    "start": "886980",
    "end": "894340"
  },
  {
    "text": "is basically a common line that runs over SSH so we were thinking you know if",
    "start": "894340",
    "end": "899950"
  },
  {
    "text": "you attack this the the main problem is that you have to go sucess SH and we know that it has a lot of",
    "start": "899950",
    "end": "905830"
  },
  {
    "text": "vulnerabilities however that was a long time ago and the problem with that is that do we want to spend that amount of",
    "start": "905830",
    "end": "912340"
  },
  {
    "text": "time finding new things or probably auditing open source library which is",
    "start": "912340",
    "end": "918370"
  },
  {
    "text": "what most people do and then so we decided a little bit against it however",
    "start": "918370",
    "end": "923740"
  },
  {
    "text": "later during the research we find out that smash could be a really good",
    "start": "923740",
    "end": "929020"
  },
  {
    "text": "to start find like logic common injection marks to obtain both out",
    "start": "929020",
    "end": "937089"
  },
  {
    "text": "access to the operating system so the command this is a common line that doesn't give you a shell or allow you to",
    "start": "937089",
    "end": "943690"
  },
  {
    "text": "execute anything at all it's just like their own implementation of like",
    "start": "943690",
    "end": "949209"
  },
  {
    "text": "monitoring through SSH so if you're able to access that and get to the opposite this operating system then if I will",
    "start": "949209",
    "end": "955899"
  },
  {
    "text": "allow you to the back better vulnerabilities that I'm sure you will find remotely so I mean it's a good type",
    "start": "955899",
    "end": "962110"
  },
  {
    "text": "of post out but pre out which is what we're looking for it didn't work is the interesting thing",
    "start": "962110",
    "end": "968470"
  },
  {
    "text": "is that as anything and you will see all the monitor and different monitors protocol everything allows you to do a",
    "start": "968470",
    "end": "974649"
  },
  {
    "text": "remote console serial as you can see or as a sage you can access the bias and do",
    "start": "974649",
    "end": "980290"
  },
  {
    "text": "them like many things remotely so it's kind of useful once you gather count and the people from rapid7 in a couple of",
    "start": "980290",
    "end": "988810"
  },
  {
    "text": "years ago put together a list of different default username and password",
    "start": "988810",
    "end": "995170"
  },
  {
    "text": "and that can be useful especially because if you are looking or an",
    "start": "995170",
    "end": "1000930"
  },
  {
    "text": "internal network external network like the main two things that will be open will be SSH and AD on these on these",
    "start": "1000930",
    "end": "1008250"
  },
  {
    "text": "devices so you know and you will see a lot of default username and password",
    "start": "1008250",
    "end": "1014610"
  },
  {
    "text": "code people really don't care about BMC's then you have SNMP I guess you",
    "start": "1014610",
    "end": "1022560"
  },
  {
    "text": "don't need too much interaction SNMP if you scan you will find a lot of devices with default public community but that",
    "start": "1022560",
    "end": "1031230"
  },
  {
    "text": "not really very important well we found that it's quite interesting is that if",
    "start": "1031230",
    "end": "1036808"
  },
  {
    "text": "you unpack the Fillmore you can get the AMA be files so then if you use a tool such as assembly walk or something like",
    "start": "1036809",
    "end": "1042900"
  },
  {
    "text": "that you can query the devices for which you already know some how the community string even if the device is yours and",
    "start": "1042900",
    "end": "1049200"
  },
  {
    "text": "you can gain a lot of information and some of the information in this case the",
    "start": "1049200",
    "end": "1054240"
  },
  {
    "text": "one on the screen I think it's a it's a Dell and I track what you're seeing",
    "start": "1054240",
    "end": "1059370"
  },
  {
    "text": "there is a process listing with all the processes running on the system and the arguments you might think this is",
    "start": "1059370",
    "end": "1064900"
  },
  {
    "text": "not a big deal but actually even if you own the device even if you have paid for it the vendors won't give you a shell in",
    "start": "1064900",
    "end": "1071140"
  },
  {
    "text": "there to be able to analyze or to do a PS or something that so just for us at least to be able to analyze and see",
    "start": "1071140",
    "end": "1077800"
  },
  {
    "text": "what's going on this is very very useful and also the last time we checked on the",
    "start": "1077800",
    "end": "1083770"
  },
  {
    "text": "devices that we were analyzing they were all vulnerable to CB from 2015 this is",
    "start": "1083770",
    "end": "1089440"
  },
  {
    "text": "an initialized pointer issue so it's not easy to explore you will have to deal with the eligibility with the heap and",
    "start": "1089440",
    "end": "1095170"
  },
  {
    "text": "play but it's not impossible to exploit it's just waiting there for somebody to",
    "start": "1095170",
    "end": "1100390"
  },
  {
    "text": "just write it but we want our own thing yeah so e PMI here allow a PMI aside",
    "start": "1100390",
    "end": "1109030"
  },
  {
    "text": "from these slide and Matias use so it's it's really confusing because there is a",
    "start": "1109030",
    "end": "1114340"
  },
  {
    "text": "ipmi protocol but some people call BMC's ipmi and and they're like many things",
    "start": "1114340",
    "end": "1119530"
  },
  {
    "text": "call a PMI which was a mess when we were like researching this but there's a",
    "start": "1119530",
    "end": "1124990"
  },
  {
    "text": "famous protocol that all of the BMC's support luckily not by default anymore",
    "start": "1124990",
    "end": "1132670"
  },
  {
    "text": "however you still see a lot of them online and this protocol is UDP and",
    "start": "1132670",
    "end": "1138040"
  },
  {
    "text": "ransom port 623 it's basically used like every other protocol on BMC's allow you",
    "start": "1138040",
    "end": "1143890"
  },
  {
    "text": "to manage the BMC remotely over UDP so you can get like a serial saw or UDP which is useful somehow the same with",
    "start": "1143890",
    "end": "1153040"
  },
  {
    "text": "UDP is that it was call in 213 one of",
    "start": "1153040",
    "end": "1158260"
  },
  {
    "text": "the most danger posed on the war and that's a bold statement because they're like really crappy protocols and I'm",
    "start": "1158260",
    "end": "1164620"
  },
  {
    "text": "sure you guys experienced some of those crappy protocols which I'm not gonna mention but some of them were written by",
    "start": "1164620",
    "end": "1169630"
  },
  {
    "text": "Microsoft so so there was a really",
    "start": "1169630",
    "end": "1175300"
  },
  {
    "text": "amazing research and if you can just google that it was done but damn former on a PMI and and again if you're doing a",
    "start": "1175300",
    "end": "1183610"
  },
  {
    "text": "pen test and you see that port you know you should be really happy of what's gonna happen to you so the first thing",
    "start": "1183610",
    "end": "1188890"
  },
  {
    "text": "that a PMI did one of the earliest versions is they came out with this different method to authenticate",
    "start": "1188890",
    "end": "1196450"
  },
  {
    "text": "one of them was called cypher zero so when you see that man you're like ah something's wrong here so basically if",
    "start": "1196450",
    "end": "1203590"
  },
  {
    "text": "the API allows I pursue that means that did require no user me no password so",
    "start": "1203590",
    "end": "1209260"
  },
  {
    "text": "you know that pretty much and the the research however no one supports ciphers",
    "start": "1209260",
    "end": "1216580"
  },
  {
    "text": "here nowadays thanks to Dan farmer however Dan found a really more very",
    "start": "1216580",
    "end": "1221860"
  },
  {
    "text": "interesting variety which is the famous rock P alpha decay shoe debacle and there's a lot to talk about this but I'm",
    "start": "1221860",
    "end": "1229030"
  },
  {
    "text": "gonna try to be brief basically what there was there was a 1.5",
    "start": "1229030",
    "end": "1234790"
  },
  {
    "text": "version of this application mechanism that was using md5 so I guess that",
    "start": "1234790",
    "end": "1241660"
  },
  {
    "text": "that's my own interpretation of the thing I guess they were like how many 5s warm oh so let's move into something",
    "start": "1241660",
    "end": "1246940"
  },
  {
    "text": "like H mark like a more complex krippchamp harsh sorry and and so they",
    "start": "1246940",
    "end": "1252730"
  },
  {
    "text": "put together the version 2.0 which does the really interesting handshake ever",
    "start": "1252730",
    "end": "1259210"
  },
  {
    "text": "heard about this pyramid team yeah so basically what they did is like this",
    "start": "1259210",
    "end": "1265030"
  },
  {
    "text": "handshake like sending autopsies I think we have to take four six a package to do",
    "start": "1265030",
    "end": "1270700"
  },
  {
    "text": "the handshake between the server and client if you at some point you send the username you want to login and they",
    "start": "1270700",
    "end": "1277180"
  },
  {
    "text": "return the hash of the password like the server you said like I want to log in as",
    "start": "1277180",
    "end": "1282280"
  },
  {
    "text": "an admin and the server is like this is the hash of the password and you're like why it will do that and you know what",
    "start": "1282280",
    "end": "1289210"
  },
  {
    "text": "the more interesting thing is that that was part of the design so they're not able to fix it because there is no fix",
    "start": "1289210",
    "end": "1295450"
  },
  {
    "text": "this is how the protocol work and so nowadays if you see an APM I'm this is",
    "start": "1295450",
    "end": "1302980"
  },
  {
    "text": "the last like modern application mechanics on rock P so you see an APM I online or internal network that means",
    "start": "1302980",
    "end": "1310420"
  },
  {
    "text": "that you were able to obtain the hash of any username so kind of like the username is a password you have to put",
    "start": "1310420",
    "end": "1315430"
  },
  {
    "text": "like a really complex password so like people doesn't guess it I guess anyways",
    "start": "1315430",
    "end": "1322030"
  },
  {
    "text": "then finally another bullet II that the guys from MWR did was they find out that decision ID",
    "start": "1322030",
    "end": "1330220"
  },
  {
    "text": "using our after authentication remember this is UDP it was kind of predictable",
    "start": "1330220",
    "end": "1335830"
  },
  {
    "text": "there's like out of the four bytes or choose our fix it and then the other ones easy to predict so obviously you",
    "start": "1335830",
    "end": "1342280"
  },
  {
    "text": "can inject packets in the middle if you're like in a position to inject packets it's easy to guess it so",
    "start": "1342280",
    "end": "1347530"
  },
  {
    "text": "remember this is UDP you can have a serial console with EDP so it's kind of like bad we look at it I was like this",
    "start": "1347530",
    "end": "1355240"
  },
  {
    "text": "is almost done but you know we want to look at it anyway and enterin stupid",
    "start": "1355240",
    "end": "1362049"
  },
  {
    "text": "back so this kind of like integer underflow it's super easy to see it obviously this is Zelda code",
    "start": "1362049",
    "end": "1369130"
  },
  {
    "text": "so basically there was maths Len on the the main header of the a PMI package so",
    "start": "1369130",
    "end": "1376600"
  },
  {
    "text": "that's like the the one encapsulate all the other things so there is no even like authentication on this point and if",
    "start": "1376600",
    "end": "1383559"
  },
  {
    "text": "you make it less than six bytes on the allah - this is gonna became a negative",
    "start": "1383559",
    "end": "1389320"
  },
  {
    "text": "number so then when then there's gonna be an overflow on the pool that's been",
    "start": "1389320",
    "end": "1394870"
  },
  {
    "text": "allocated which is a fixed set side and this is the trigger you want to try it",
    "start": "1394870",
    "end": "1400750"
  },
  {
    "text": "at home it's not easy to exploit but it's it's",
    "start": "1400750",
    "end": "1405850"
  },
  {
    "text": "doable but again there's gonna be better things so all of TDD targets that we",
    "start": "1405850",
    "end": "1414970"
  },
  {
    "text": "were looking at or web servers right because web servers are always really interesting and in at least in the case",
    "start": "1414970",
    "end": "1423159"
  },
  {
    "text": "of EMC is also interesting because on our experience every time we we were",
    "start": "1423159",
    "end": "1429039"
  },
  {
    "text": "working on like big networks for clients we always even if these devices were like in isolated Network separately from",
    "start": "1429039",
    "end": "1435970"
  },
  {
    "text": "the rest port 443 or 22 for SSH was always open I don't know why maybe",
    "start": "1435970",
    "end": "1441370"
  },
  {
    "text": "because odd means to use this part to get the BMC's or whatever so that makes it actually are more realistic scenario",
    "start": "1441370",
    "end": "1448570"
  },
  {
    "text": "for an attacker to be able to reach that port that may be some other weird thing",
    "start": "1448570",
    "end": "1454530"
  },
  {
    "text": "most of the devices that we analyzed were using a web server which is called a PP well this is pretty popular on the",
    "start": "1454530",
    "end": "1461770"
  },
  {
    "text": "embedded world and is very secure without it is very solid so",
    "start": "1461770",
    "end": "1467649"
  },
  {
    "text": "finding an abiding the can be done but it would have been a challenge but the",
    "start": "1467649",
    "end": "1472749"
  },
  {
    "text": "thing is that sometimes vendors decide to not use the proven solution that they",
    "start": "1472749",
    "end": "1478690"
  },
  {
    "text": "know that works and it is secure and everything because they can't just be the wrong thing you know because why not",
    "start": "1478690",
    "end": "1483970"
  },
  {
    "text": "so some of them decide to build their own web servers and that's when things",
    "start": "1483970",
    "end": "1489549"
  },
  {
    "text": "get really interesting but also speaking out web servers is not",
    "start": "1489549",
    "end": "1494950"
  },
  {
    "text": "only about the web server themselves but also about what web servers give you access to what kind of things are built",
    "start": "1494950",
    "end": "1502299"
  },
  {
    "text": "on top of web servers so what you see on the screen for example in the case of HP",
    "start": "1502299",
    "end": "1508929"
  },
  {
    "text": "ILO - sorry HP ILO in general we have an endpoint that is called XML data that is",
    "start": "1508929",
    "end": "1516519"
  },
  {
    "text": "reachable authenticated so if you just point your browser there the device will spit out at you a lot of information in",
    "start": "1516519",
    "end": "1523869"
  },
  {
    "text": "XML I mean that information you will see for example the IP addresses and MAC addresses but also you will find the",
    "start": "1523869",
    "end": "1531070"
  },
  {
    "text": "exact fillmore version and if you have ever been working or trying to exploit Vice or having to develop an expert or",
    "start": "1531070",
    "end": "1538480"
  },
  {
    "text": "sampler you know that knowing the exact version of the system that you're targeting is very very useful it's",
    "start": "1538480",
    "end": "1544869"
  },
  {
    "text": "actually invaluable in the case of Iraq it has something similar just with a different name both of these features",
    "start": "1544869",
    "end": "1551919"
  },
  {
    "text": "can be disabled but at least again in the in the cases that we have seen in companies administrators don't want to",
    "start": "1551919",
    "end": "1558700"
  },
  {
    "text": "disable this because they actually use it and there is no way to enable authentication you either have it there",
    "start": "1558700",
    "end": "1564489"
  },
  {
    "text": "like accessible to everybody or you don't you okay so continuing with web",
    "start": "1564489",
    "end": "1573309"
  },
  {
    "text": "servers there's a very very interesting bug that the French guys let me read",
    "start": "1573309",
    "end": "1578529"
  },
  {
    "text": "their names properly five MP regard Alexandre Cosette and Jeffrey's attorney there's a very very amazing by what they",
    "start": "1578529",
    "end": "1585850"
  },
  {
    "text": "found it's actually and so the idea for web server when it parses the an HTTP",
    "start": "1585850",
    "end": "1593499"
  },
  {
    "text": "request it checks for the different heaters and when he finds the connection here he",
    "start": "1593499",
    "end": "1599460"
  },
  {
    "text": "will use SSKIN F without any kind of size validation at all to read the content of that heater and the D value",
    "start": "1599460",
    "end": "1607740"
  },
  {
    "text": "is actually stored on the stack on a buffer I do was I have 14 16 bytes around those numbers small s so this is",
    "start": "1607740",
    "end": "1614670"
  },
  {
    "text": "just a plain stack overflow you can just like that with we sending just one",
    "start": "1614670",
    "end": "1620910"
  },
  {
    "text": "request you can crush the server but it was what is much more interesting is the the italic exploit that they come up",
    "start": "1620910",
    "end": "1627960"
  },
  {
    "text": "with what is very very clever instead of doing the classic shackle thing and",
    "start": "1627960",
    "end": "1633270"
  },
  {
    "text": "trying to get God execution what they found was that there was a variable in this stack a little bit below the one",
    "start": "1633270",
    "end": "1640530"
  },
  {
    "text": "that was being overflowed and that variable was actually a flag that indicated if the connection was remote",
    "start": "1640530",
    "end": "1648000"
  },
  {
    "text": "or local so local is from the same web from from the server where the BMC is",
    "start": "1648000",
    "end": "1653250"
  },
  {
    "text": "attached to a remote is from the network and whenever a connection is remote a local sorry",
    "start": "1653250",
    "end": "1658470"
  },
  {
    "text": "it doesn't need authentication so in the end what you can do is just send a",
    "start": "1658470",
    "end": "1663690"
  },
  {
    "text": "request an HTTP POST for example with this specific here with our size of 29",
    "start": "1663690",
    "end": "1669330"
  },
  {
    "text": "with whatever value you want and that will trick the web server into thinking",
    "start": "1669330",
    "end": "1675090"
  },
  {
    "text": "that the connection is local so it doesn't need salt indication so that request will just go through and what",
    "start": "1675090",
    "end": "1681090"
  },
  {
    "text": "you see on screen is the request that you need to send to create a new user on the system when we analyze I drag eight",
    "start": "1681090",
    "end": "1690110"
  },
  {
    "text": "we also found an ability that reminders to the 90s again because this is like",
    "start": "1690110",
    "end": "1695880"
  },
  {
    "text": "the kind of thing that it doesn't should happen anymore and in this case it was a",
    "start": "1695880",
    "end": "1703820"
  },
  {
    "text": "remote environment parallel injection so basically the problem here is that the",
    "start": "1703820",
    "end": "1709320"
  },
  {
    "text": "DI drug eight web server what it does when it gets a request that is directed",
    "start": "1709320",
    "end": "1715020"
  },
  {
    "text": "to the slash cgi-bin path you will call a handler and this can do we do",
    "start": "1715020",
    "end": "1720240"
  },
  {
    "text": "basically three steps first it will try to find the binary that needs to be",
    "start": "1720240",
    "end": "1725910"
  },
  {
    "text": "executed then as a second trap it will pass the URI and use all",
    "start": "1725910",
    "end": "1731409"
  },
  {
    "text": "all of that parameters in order to build environment for that binary and then it will finally execute it and there are a",
    "start": "1731409",
    "end": "1738730"
  },
  {
    "text": "couple of binaries that are available unauthenticated such as for example logging that needs to be available and indicated right so what you can do is",
    "start": "1738730",
    "end": "1745659"
  },
  {
    "text": "just send a request in there and for that binary that is being executed you",
    "start": "1745659",
    "end": "1750669"
  },
  {
    "text": "can control all of the environment variables how will exploit that is there anyone from the 90s that you just like",
    "start": "1750669",
    "end": "1756700"
  },
  {
    "text": "to see this kind of backs you remember how you exploit that so you can accept tell conserve all the environment",
    "start": "1756700",
    "end": "1762999"
  },
  {
    "text": "variables for a binary that you are executing no there's no one trick that we used to do people long time ago yes",
    "start": "1762999",
    "end": "1769779"
  },
  {
    "text": "when you find this kind of wine no no Apple is always like for sure but",
    "start": "1769779",
    "end": "1774789"
  },
  {
    "text": "I mean like how do you like which DLL will used like load so basically if you",
    "start": "1774789",
    "end": "1784059"
  },
  {
    "text": "send any environment wherever and they own the URI and we will be sent to d2 diviner is executed so if you send LG",
    "start": "1784059",
    "end": "1791230"
  },
  {
    "text": "debug the web server will throw at you all the debug the linker will send you the all the debug information for the",
    "start": "1791230",
    "end": "1796600"
  },
  {
    "text": "libraries loaded if you send you can all send LD preload as you as you well sir and that will instruct the linker to",
    "start": "1796600",
    "end": "1802720"
  },
  {
    "text": "load binary but that binary that we can somehow try to put something up that we",
    "start": "1802720",
    "end": "1808720"
  },
  {
    "text": "can control should be on the same device where this web server is running and that's the baby MC and we can't read",
    "start": "1808720",
    "end": "1813759"
  },
  {
    "text": "white files to the BMC at least not yet so the the old trick that was done before and done like a million times",
    "start": "1813759",
    "end": "1820480"
  },
  {
    "text": "before to exploit these kind of things was to point LD preload to the standard",
    "start": "1820480",
    "end": "1827019"
  },
  {
    "text": "input file from for the for the self process so if you did that you can send",
    "start": "1827019",
    "end": "1833080"
  },
  {
    "text": "the your payload your share library with your code on the same request that you",
    "start": "1833080",
    "end": "1838749"
  },
  {
    "text": "were doing - what - web server but unfortunately this didn't work very well for us because somehow the linker on",
    "start": "1838749",
    "end": "1845859"
  },
  {
    "text": "this device didn't like non regular files so this act leading work em map",
    "start": "1845859",
    "end": "1850869"
  },
  {
    "text": "was was filing there so we kept looking - trying to find different charity",
    "start": "1850869",
    "end": "1857109"
  },
  {
    "text": "freidy's and what was we found was a different primitive that's also Tullius CGI that we let you write to a",
    "start": "1857109",
    "end": "1866200"
  },
  {
    "text": "specific file word that you don't control the names that is fixed /t airspeed TMP / something but you can",
    "start": "1866200",
    "end": "1873249"
  },
  {
    "text": "control the whole data in the file so then it's game over right because what you can do is first use these primitive",
    "start": "1873249",
    "end": "1880629"
  },
  {
    "text": "to upload some contents to a file on the BMC where you will upload your connect",
    "start": "1880629",
    "end": "1888759"
  },
  {
    "text": "back for example as a share library then at the second step you will use the you will do at the trigger with the LD",
    "start": "1888759",
    "end": "1895479"
  },
  {
    "text": "preload thing and finally get your connect back so let's see a quick demo of this in action again this is remote",
    "start": "1895479",
    "end": "1902619"
  },
  {
    "text": "this is a logic bag this is a notification mu times back from the nineties like who",
    "start": "1902619",
    "end": "1908440"
  },
  {
    "text": "does who use GGI being and allows environmental parables okay so can you",
    "start": "1908440",
    "end": "1924609"
  },
  {
    "text": "sit there yeah that's good for this demo we are using cameras that",
    "start": "1924609",
    "end": "1931089"
  },
  {
    "text": "is our exploitation framework for penetration testing the exploit actually",
    "start": "1931089",
    "end": "1936549"
  },
  {
    "text": "very easy to use you just need to know the IP address and the port where the BMC web server is running and just click",
    "start": "1936549",
    "end": "1943179"
  },
  {
    "text": "OK so this will actually do this the two steps that we tell you before first we will do this trigger to blow some",
    "start": "1943179",
    "end": "1950409"
  },
  {
    "text": "content to a known file then as a second step you will actually do the trigger with the LDP low to low to force the",
    "start": "1950409",
    "end": "1957489"
  },
  {
    "text": "linker in to loading that code so in canvas we have the concept of nodes so each of those are circles that you see",
    "start": "1957489",
    "end": "1964239"
  },
  {
    "text": "in there represent a host where we control we can execute commands basically the first one that was already",
    "start": "1964239",
    "end": "1970929"
  },
  {
    "text": "there when we start the demo represents the machine where we are running the software and the second one and then",
    "start": "1970929",
    "end": "1976960"
  },
  {
    "text": "pop-up that represents the the device that we have just compromised in this case is the GI tract so that we know",
    "start": "1976960",
    "end": "1986499"
  },
  {
    "text": "that lets you interact with a node so as you can see once the actual works basically what we end up with is with a",
    "start": "1986499",
    "end": "1993009"
  },
  {
    "text": "shell in there where you can execute commands get like the last time or whatever and as expected always guess with what",
    "start": "1993009",
    "end": "2001410"
  },
  {
    "text": "username the web server is running because why not right okay so just in case you notice we were",
    "start": "2001410",
    "end": "2009360"
  },
  {
    "text": "attacking localhost that's not because the BMC was in the localhost but rather we have a tunnel to our labs which was",
    "start": "2009360",
    "end": "2017520"
  },
  {
    "text": "in a different office so that's why we were talking localhost okay I don't know why it went again to the beginning",
    "start": "2017520",
    "end": "2023640"
  },
  {
    "text": "oh sorry okay sure Bob will be happy",
    "start": "2023640",
    "end": "2029720"
  },
  {
    "text": "that's you all right so I think I'm missing some slice so",
    "start": "2032120",
    "end": "2041850"
  },
  {
    "text": "here we go okay double yes man this is a",
    "start": "2041850",
    "end": "2051450"
  },
  {
    "text": "protocol that definitely we're missing slice yeah it's weird yeah yeah that's",
    "start": "2051450",
    "end": "2057179"
  },
  {
    "text": "cuz that's you're in the wrong slice yes yes sorry about that",
    "start": "2057179",
    "end": "2068840"
  },
  {
    "text": "there we go yeah yes you're using Google slice grace",
    "start": "2069139",
    "end": "2077460"
  },
  {
    "text": "right it actually works really well there we go so ws man it's protocol called web",
    "start": "2077460",
    "end": "2088618"
  },
  {
    "text": "service management has nothing to do with my last name and Microsoft support",
    "start": "2088619",
    "end": "2095340"
  },
  {
    "text": "these Natalie through Weiner am so it's kind of you use it quite a lot because every windows IT person can easily use",
    "start": "2095340",
    "end": "2104970"
  },
  {
    "text": "it it's supported by PowerShell so that makes scripting super easy to do and",
    "start": "2104970",
    "end": "2111390"
  },
  {
    "text": "it's kind of a protocol that looks like XML kind of product syntax based on so",
    "start": "2111390",
    "end": "2120470"
  },
  {
    "text": "how do you access it in generally it's a it's another endpoint on a GPS",
    "start": "2120470",
    "end": "2127460"
  },
  {
    "text": "it goes on the WS man /ws man endpoint but also can be found stand alone",
    "start": "2127460",
    "end": "2134059"
  },
  {
    "text": "running on the port 5985 and in general induce ossification basically she's out",
    "start": "2134059",
    "end": "2140720"
  },
  {
    "text": "whatever application you had on the web server however in this case qu access at",
    "start": "2140720",
    "end": "2148250"
  },
  {
    "text": "least the parser there is no education at all and the reason we put that picture even though we already spoil the",
    "start": "2148250",
    "end": "2155059"
  },
  {
    "text": "backs through that slice error is that when we start researching thing you kind",
    "start": "2155059",
    "end": "2160910"
  },
  {
    "text": "of like feel like using a fanny pack because like everyone Mathilde looks like the 90s so weird so the first black we found was bug will",
    "start": "2160910",
    "end": "2170990"
  },
  {
    "text": "parse him the XML tag super easy to find and and again it's really similar to the",
    "start": "2170990",
    "end": "2179359"
  },
  {
    "text": "warranty that the guys the French guys find on a love for which is basically a",
    "start": "2179359",
    "end": "2184400"
  },
  {
    "text": "scanf and on a stock buffer a fix extract buffer super easy and again this",
    "start": "2184400",
    "end": "2193880"
  },
  {
    "text": "is remote this sound I know dedicated and it's there in order to exploit it it's super simple we put",
    "start": "2193880",
    "end": "2201289"
  },
  {
    "text": "the power in case you want to test it but again this is sending some beasts on the XML and you just crash it the other",
    "start": "2201289",
    "end": "2209150"
  },
  {
    "text": "one that we found was kind of similar but in a different place it's the what",
    "start": "2209150",
    "end": "2214460"
  },
  {
    "text": "is called the name XML namespace and again and the same kind of thing as can",
    "start": "2214460",
    "end": "2219559"
  },
  {
    "text": "F stackoverflow uneducated yeah same",
    "start": "2219559",
    "end": "2226130"
  },
  {
    "text": "thing easy to exploit again so but so",
    "start": "2226130",
    "end": "2231140"
  },
  {
    "text": "everything so so far it's quite nice we have like I don't five different ways which you can compromise a BMC but when",
    "start": "2231140",
    "end": "2238640"
  },
  {
    "text": "you start thinking about real-life scenarios things are not so easy right because while sometimes BMC are",
    "start": "2238640",
    "end": "2246039"
  },
  {
    "text": "advertised as if you could just connect them to the Internet and I will make",
    "start": "2246039",
    "end": "2251089"
  },
  {
    "text": "your life super easy because you can't just reboot the server for from wherever you are the truth is that this is not what",
    "start": "2251089",
    "end": "2258950"
  },
  {
    "text": "happens actually on at least some big companies many when you go to some kind of big corporation",
    "start": "2258950",
    "end": "2265580"
  },
  {
    "text": "you won't find the BMC connected to the internet directly in fact what you will find is like one DM seat where they will",
    "start": "2265580",
    "end": "2272990"
  },
  {
    "text": "have the servers with exposed services to the internet or multiple DM seats",
    "start": "2272990",
    "end": "2278060"
  },
  {
    "text": "then you will see a lot of different networks for internal services or back-end services and most of them will",
    "start": "2278060",
    "end": "2285080"
  },
  {
    "text": "be totally isolated with each other or heavily restricted with what connects can be accessed from the other and then",
    "start": "2285080",
    "end": "2291980"
  },
  {
    "text": "you will very likely see some kind of totally different network on a different level which is usually called the",
    "start": "2291980",
    "end": "2298520"
  },
  {
    "text": "out-of-band network or management network this is kind of the perfect scenario however like in the last free",
    "start": "2298520",
    "end": "2303650"
  },
  {
    "text": "pen test that we did we compromised I choose domain controllers BMC being",
    "start": "2303650",
    "end": "2308810"
  },
  {
    "text": "accessible in this Israel I look like supposed to look like but when you",
    "start": "2308810",
    "end": "2314600"
  },
  {
    "text": "actually go to real companies not really like that but in the best scenario like what you should find in theory should be",
    "start": "2314600",
    "end": "2321380"
  },
  {
    "text": "this and the problem is that how do you use whatever you have been seeing so far",
    "start": "2321380",
    "end": "2328160"
  },
  {
    "text": "in that scenario right it's like you can't reach the BMC from there from internet so then it's not dangerous",
    "start": "2328160",
    "end": "2335740"
  },
  {
    "text": "we like to you we immediately like to talk about dimensions instead of networks because",
    "start": "2335740",
    "end": "2341390"
  },
  {
    "text": "it's just a little bit broader of a concept so think of a sub network as a",
    "start": "2341390",
    "end": "2347960"
  },
  {
    "text": "dimension but also a thumb drive that is moving data from one computer to the are like us snack stack Stuxnet did that",
    "start": "2347960",
    "end": "2355730"
  },
  {
    "text": "could be also considered I mentioned so what we will see next is how to abuse",
    "start": "2355730",
    "end": "2361160"
  },
  {
    "text": "the things that we have already seen and the inner trust that exists between the",
    "start": "2361160",
    "end": "2366200"
  },
  {
    "text": "BMC and B host where this BMC is attached you in order to move between",
    "start": "2366200",
    "end": "2371300"
  },
  {
    "text": "different dimensions of corporate networks so let's start with what is",
    "start": "2371300",
    "end": "2376820"
  },
  {
    "text": "already very known let's say that we'd somehow have access to the out of our",
    "start": "2376820",
    "end": "2382910"
  },
  {
    "text": "network but we are already there right like on the hacker movies that they put a Raspberry Pi whatever in that scenario",
    "start": "2382910",
    "end": "2390970"
  },
  {
    "text": "we know that we can compromise the BMC and we found a couple of amenities the front",
    "start": "2390970",
    "end": "2396020"
  },
  {
    "text": "guys found a bunch of own abilities and I bet that anyone who spends some time in there will already find a lot more",
    "start": "2396020",
    "end": "2402350"
  },
  {
    "text": "and from there we can easily jump to this server that is already kind of a",
    "start": "2402350",
    "end": "2408710"
  },
  {
    "text": "known fact because if you think about it once you have compromised a PMC it's",
    "start": "2408710",
    "end": "2414290"
  },
  {
    "text": "almost as being as having physical access to a server because you can control many things of the server you",
    "start": "2414290",
    "end": "2420950"
  },
  {
    "text": "can access the serial console you can try to mount a remote device or remote",
    "start": "2420950",
    "end": "2426050"
  },
  {
    "text": "optical drive for example you can upload an ISO to the BMC and this will emulate an optical drive to the server you have",
    "start": "2426050",
    "end": "2433220"
  },
  {
    "text": "also KVM so can manage the keyboard and see what's going on the screen so you can reboot to the BIOS for example and",
    "start": "2433220",
    "end": "2439940"
  },
  {
    "text": "there's also DMA I recommend seeing the talk for the franchise from recon on",
    "start": "2439940",
    "end": "2446750"
  },
  {
    "text": "this topic so if it has DMA you can basically access the the main server",
    "start": "2446750",
    "end": "2452360"
  },
  {
    "text": "memory directly from the BMC so let's see a quick demo of one of the simplest",
    "start": "2452360",
    "end": "2457940"
  },
  {
    "text": "ways to do this we decided here to go to the via the easy way just to show you",
    "start": "2457940",
    "end": "2464780"
  },
  {
    "text": "that it's possible so we start by the assumption that we already have access",
    "start": "2464780",
    "end": "2470960"
  },
  {
    "text": "to a BMC that actually there is the the web console for an eye track sorry so",
    "start": "2470960",
    "end": "2479030"
  },
  {
    "text": "what we just launched is the feature that's called remote console what runs",
    "start": "2479030",
    "end": "2484550"
  },
  {
    "text": "using java that gives you basically a remote KVM right with some other features so the one of the easiest ways",
    "start": "2484550",
    "end": "2492110"
  },
  {
    "text": "to compromise this is I bet that you have done this at least a couple at least two times in your life whatever",
    "start": "2492110",
    "end": "2498830"
  },
  {
    "text": "you forgot the password for your Linens what did you did how do you recover it you put your boot to the bootloader",
    "start": "2498830",
    "end": "2506000"
  },
  {
    "text": "right if you don't have this encryption you just boot to the border so the same exact thing can be done here you can",
    "start": "2506000",
    "end": "2512060"
  },
  {
    "text": "reboot the bootloader I use the init equals to your shell and",
    "start": "2512060",
    "end": "2517070"
  },
  {
    "text": "you get root access to a server this is a very very naive example we know that but it works unless there is some that",
    "start": "2517070",
    "end": "2524390"
  },
  {
    "text": "kind of disk encryption or bios password whatever but this is the easy way you can always",
    "start": "2524390",
    "end": "2530059"
  },
  {
    "text": "use DMA to try to compromise the server and be much more resilient and make less",
    "start": "2530059",
    "end": "2537079"
  },
  {
    "text": "noise because this will likely throw a lot of alerts if this always being monitored",
    "start": "2537079",
    "end": "2544088"
  },
  {
    "text": "okay you could also try to mount for example a live CD image for any any",
    "start": "2544539",
    "end": "2551990"
  },
  {
    "text": "linux thing if this was a Windows the host and then you think that you can reboot to add live CD and mom to disks",
    "start": "2551990",
    "end": "2559250"
  },
  {
    "text": "so if you saw at the end of the video we actually ended with root there yeah okay",
    "start": "2559250",
    "end": "2566210"
  },
  {
    "text": "so but that's that just to prove the point that this can be done okay so but",
    "start": "2566210",
    "end": "2575299"
  },
  {
    "text": "the thing is that and this is not very well known the problem is that the other",
    "start": "2575299",
    "end": "2580640"
  },
  {
    "text": "way around is also true let's say that you have a server on a DM seat exposed to the Internet that's pretty usual and",
    "start": "2580640",
    "end": "2587450"
  },
  {
    "text": "that server gets compromised the attacker can from that server jump to",
    "start": "2587450",
    "end": "2593390"
  },
  {
    "text": "the VM C and then we have a problem right because as you have already",
    "start": "2593390",
    "end": "2598730"
  },
  {
    "text": "guessed or hear the last half an hour device is connected to these networks",
    "start": "2598730",
    "end": "2604069"
  },
  {
    "text": "are very insecure they are not built with the same security measures that any",
    "start": "2604069",
    "end": "2609740"
  },
  {
    "text": "kind of thing that is being thought to be connected to the Internet in fact if you read the documentation from all of",
    "start": "2609740",
    "end": "2616039"
  },
  {
    "text": "the main vendors they tell you that you can connect this device is too risky networks you have to have them in",
    "start": "2616039",
    "end": "2621859"
  },
  {
    "text": "control environments but if this is true if we can jump from the server to the BMC then we have a problem here because",
    "start": "2621859",
    "end": "2630020"
  },
  {
    "text": "now I can access the out of a network via company so let's think how is this",
    "start": "2630020",
    "end": "2635270"
  },
  {
    "text": "even possible there are a couple of things that make this possible vendors",
    "start": "2635270",
    "end": "2640880"
  },
  {
    "text": "provide administrators with a lot of tools to be able to administer this VMC's and many of these tools can be",
    "start": "2640880",
    "end": "2647299"
  },
  {
    "text": "used either remotely from the network VIP for example or locally from the same server where the BMC s attached you and",
    "start": "2647299",
    "end": "2654730"
  },
  {
    "text": "some of the things that you can do with those tools is for example create new",
    "start": "2654730",
    "end": "2660049"
  },
  {
    "text": "users in the system or flush a new few more and some others",
    "start": "2660049",
    "end": "2665269"
  },
  {
    "text": "have for example features to enable some kind of networking between the BMC and the server",
    "start": "2665269",
    "end": "2671049"
  },
  {
    "text": "no no definitely my fault because I want to really show how important this lies",
    "start": "2671049",
    "end": "2676880"
  },
  {
    "text": "soap like nothing shows importance I kept dancing banana but these are all",
    "start": "2676880",
    "end": "2682970"
  },
  {
    "text": "really important because this is a game changer this is the by design benders",
    "start": "2682970",
    "end": "2688099"
  },
  {
    "text": "decide that the server should be able to do whatever they want on a BMC so whenever you use these commands these",
    "start": "2688099",
    "end": "2693859"
  },
  {
    "text": "tools from the server there's no authentication and this is what this is",
    "start": "2693859",
    "end": "2698989"
  },
  {
    "text": "a trick that the French guys did on the ILO that mighty has explained the reason",
    "start": "2698989",
    "end": "2704180"
  },
  {
    "text": "why there was a plan flag that mentioned local or remote was that because local for them is like no access so they",
    "start": "2704180",
    "end": "2712339"
  },
  {
    "text": "assumed I'd by default that it do you have a minute of Rights from the server then you should be able to have a list",
    "start": "2712339",
    "end": "2717710"
  },
  {
    "text": "of these rights on the BMC but no one thought about the security implications that is this hub so let's see a quick",
    "start": "2717710",
    "end": "2725239"
  },
  {
    "text": "demo not so quick on how this works five minutes quick ok so what we will do",
    "start": "2725239",
    "end": "2734119"
  },
  {
    "text": "is let me go to slides we will start under the assumption that we have",
    "start": "2734119",
    "end": "2740539"
  },
  {
    "text": "already compromised a server on the DMC right we have compromised at PHP oh",
    "start": "2740539",
    "end": "2745759"
  },
  {
    "text": "right whatever we go to code execution there and then we were able to elevate privileges to root so that is in the",
    "start": "2745759",
    "end": "2752450"
  },
  {
    "text": "initial position where we are let's say that we are the attacker one of the third first thing that you can do is try",
    "start": "2752450",
    "end": "2760489"
  },
  {
    "text": "to see if that server has a BNC attached to it and if you remember from the first light that that ugly diagram from my VM",
    "start": "2760489",
    "end": "2767900"
  },
  {
    "text": "I whatever we talked about that bmc's usually have connection to the one of the main buses via PCI or PCI Express",
    "start": "2767900",
    "end": "2774319"
  },
  {
    "text": "when well here's how can you detect if that server has a BMC you can also use",
    "start": "2774319",
    "end": "2781609"
  },
  {
    "text": "for example a LS mode because you won't will detect the despised and that they support the ugly by default you don't",
    "start": "2781609",
    "end": "2787640"
  },
  {
    "text": "need to install anything and you will see the current modules for to be able to use is to interact be IPMI through",
    "start": "2787640",
    "end": "2794569"
  },
  {
    "text": "the PCI or PCI Express port and Dana suhaka what you can do is use these tools that the",
    "start": "2794569",
    "end": "2801869"
  },
  {
    "text": "bender gives us gives you to interact with the BMC one of the things that you",
    "start": "2801869",
    "end": "2808260"
  },
  {
    "text": "can do just to show you that it works is use this tool to play the users on the BMC and you consider it's even giving us",
    "start": "2808260",
    "end": "2815430"
  },
  {
    "text": "the only hashes for the this user password in the same way we do this we",
    "start": "2815430",
    "end": "2820680"
  },
  {
    "text": "could have created a new user on the system and check that the in the common line there's no password no kind of an authentication you are just using the",
    "start": "2820680",
    "end": "2827309"
  },
  {
    "text": "tool the only thing that you need is access yep so the next thing that we are",
    "start": "2827309",
    "end": "2835440"
  },
  {
    "text": "going to do here is use a feature from the I drug but it's called shared",
    "start": "2835440",
    "end": "2841619"
  },
  {
    "text": "network or something that are big see basically what it does is uses USB emulation to set up an int an Ethernet",
    "start": "2841619",
    "end": "2849210"
  },
  {
    "text": "card emulated on the server so you will have IP communication between the server",
    "start": "2849210",
    "end": "2854430"
  },
  {
    "text": "and ABMC we will just keep this part of the demo quite fast yeah so basically",
    "start": "2854430",
    "end": "2862319"
  },
  {
    "text": "what I did there was using this feature",
    "start": "2862319",
    "end": "2868890"
  },
  {
    "text": "using this tool called rockin that Dell gives us that tool there's nothing there very fancy",
    "start": "2868890",
    "end": "2875010"
  },
  {
    "text": "and what we know was a network connectivity between ABMC under server",
    "start": "2875010",
    "end": "2880200"
  },
  {
    "text": "so once we have network connectivity we can actually reuse the same exploit that we talked about before the one day trip",
    "start": "2880200",
    "end": "2886140"
  },
  {
    "text": "of the algebra load and what we did here in the video that we just skipped was user typed code in order to gain a shell",
    "start": "2886140",
    "end": "2892980"
  },
  {
    "text": "on that device so right now what we are is here right we have we have from this",
    "start": "2892980",
    "end": "2900059"
  },
  {
    "text": "server we have compromised ABMC we were able to jump there and at this point you might be thinking well I don't care too",
    "start": "2900059",
    "end": "2906540"
  },
  {
    "text": "much because my company has everything patched so everything is up-to-date but",
    "start": "2906540",
    "end": "2911700"
  },
  {
    "text": "even if you have everything up-to-date this affect you because using the same tool you can downgrade the idrac to a",
    "start": "2911700",
    "end": "2919260"
  },
  {
    "text": "boon L version and once you tank ready then you can use this at the exact same exploit",
    "start": "2919260",
    "end": "2925760"
  },
  {
    "text": "so what we did next was we didn't wanted to stop there so we had in our lab",
    "start": "2927400",
    "end": "2933920"
  },
  {
    "text": "another server on an isolated Network yeah he was an HP in this case and that",
    "start": "2933920",
    "end": "2941000"
  },
  {
    "text": "server the only thing that shared with this other Dell server what they were both connected to the same management",
    "start": "2941000",
    "end": "2947390"
  },
  {
    "text": "network so what we did was we use we did an SSH tunnel on the on the I'd lock in",
    "start": "2947390",
    "end": "2954050"
  },
  {
    "text": "order to be able to reach the other they are managed BMC in this case was an I know so in the end what we were able to",
    "start": "2954050",
    "end": "2962059"
  },
  {
    "text": "do was from the internet doing a series of SSH tunnels and using being having",
    "start": "2962059",
    "end": "2967970"
  },
  {
    "text": "compromised this I love this I'd work sorry we were able to reach this BMC",
    "start": "2967970",
    "end": "2973040"
  },
  {
    "text": "that was in a management network totally unreachable otherwise all right sorry",
    "start": "2973040",
    "end": "2978619"
  },
  {
    "text": "only one minutes and we're almost done I want to say one a couple things one of them is persistence we were able to",
    "start": "2978619",
    "end": "2984410"
  },
  {
    "text": "persist this super easy there was there was many ways we can do that one of them was to try to mess with a firmware but",
    "start": "2984410",
    "end": "2993140"
  },
  {
    "text": "they decide to do easy way so we only have access as Matthias show a shell on the idrac we figure out like what what",
    "start": "2993140",
    "end": "2999410"
  },
  {
    "text": "things are mounted and we figure out that the flash was mounted readable and writeable so and we start looking at",
    "start": "2999410",
    "end": "3006010"
  },
  {
    "text": "well around the flash there was a cron folder so basically we just create a Chrome file there and you were like",
    "start": "3006010",
    "end": "3012339"
  },
  {
    "text": "every time like you say that the cron can connect back to you or upload a binary the interesting thing about that",
    "start": "3012339",
    "end": "3018369"
  },
  {
    "text": "is that it allows you like no matter if you flash the machine the the itraq the",
    "start": "3018369",
    "end": "3026230"
  },
  {
    "text": "cron will continue like that because they don't play in the flash yeah it survives few more updates basically so",
    "start": "3026230",
    "end": "3031390"
  },
  {
    "text": "no matter how you fix it your back that will be there so like it's not it's only interesting from the point we're not",
    "start": "3031390",
    "end": "3037599"
  },
  {
    "text": "gonna show the video there demo and no to do either so the point of this is that it's a it's not just like an attack",
    "start": "3037599",
    "end": "3044920"
  },
  {
    "text": "remotely internally you can move direction between the BMC and the on the server but also you can just use it as a",
    "start": "3044920",
    "end": "3052750"
  },
  {
    "text": "great backdoor or a run somewhere like the possibilities to do it as a run somewhere compromise the iraq and creep",
    "start": "3052750",
    "end": "3058809"
  },
  {
    "text": "the disk and you just keep there just change the website and like no matter how much you flash up in world you will not be",
    "start": "3058809",
    "end": "3065800"
  },
  {
    "text": "able to get us out of that because you don't have access you have shell access to that not even like there have access",
    "start": "3065800",
    "end": "3072310"
  },
  {
    "text": "to that anyways that was the conclusion in like zero seconds",
    "start": "3072310",
    "end": "3079770"
  },
  {
    "text": "black I probably hate us by now so there's no time for questions we know we",
    "start": "3079770",
    "end": "3086380"
  },
  {
    "text": "will not I mean no time for questions but it might be there in the other room there's a room somewhere that will be around if you have any questions and bad",
    "start": "3086380",
    "end": "3094119"
  },
  {
    "text": "we just want to thanks this was an effort not just by us but by the team like we were working together with",
    "start": "3094119",
    "end": "3100810"
  },
  {
    "text": "multiple targets at the same time so it was not just the two of us anyways thanks a lot for attending thank you",
    "start": "3100810",
    "end": "3108480"
  },
  {
    "text": "[Applause]",
    "start": "3108480",
    "end": "3111050"
  }
]