[
  {
    "start": "0",
    "end": "240000"
  },
  {
    "text": "so hi everyone today we're going to talk about blue born thank you so blue born",
    "start": "30",
    "end": "10280"
  },
  {
    "text": "it's a new attack vector we are discovered in the last era it's an",
    "start": "10280",
    "end": "15480"
  },
  {
    "text": "airborne attack vector because it's wireless it uses bluetooth today our talk",
    "start": "15480",
    "end": "21029"
  },
  {
    "text": "specifically is going to be focused on Linux devices and I RT Linux devices and",
    "start": "21029",
    "end": "26300"
  },
  {
    "text": "availabilities in the Bluetooth that we found in the implementation in Linux so",
    "start": "26300",
    "end": "34309"
  },
  {
    "text": "my name is Ben Surrey and the head of research at Army's today with me is we",
    "start": "34309",
    "end": "42899"
  },
  {
    "text": "both work in Norma's which is a nice kitty company that is focused on the",
    "start": "42899",
    "end": "50360"
  },
  {
    "text": "unmanaged devices in each corporate music organization discovering these",
    "start": "50360",
    "end": "56850"
  },
  {
    "text": "devices profiling them and sanctioning them and for that reason we came across",
    "start": "56850",
    "end": "63229"
  },
  {
    "text": "searching researching bluetooth to understand how some of these devices communicate and through underselling",
    "start": "63229",
    "end": "70590"
  },
  {
    "text": "bluetooth we found a magnitude of 8 vulnerabilities in different operating",
    "start": "70590",
    "end": "77790"
  },
  {
    "text": "systems so today I want to talk a bit about other airborne attacks that have",
    "start": "77790",
    "end": "85229"
  },
  {
    "text": "been discovered and the last ear wireless attacks a bit of Buddhist background that is necessary to",
    "start": "85229",
    "end": "91680"
  },
  {
    "text": "understand the vulnerabilities and how they can be exploited we're going to",
    "start": "91680",
    "end": "96720"
  },
  {
    "text": "talk about specifically the Bluetooth stack in in Linux which is called lose and then a remote but a exploitation and",
    "start": "96720",
    "end": "105680"
  },
  {
    "text": "how we did the remote exploitation of these world realities in the RC",
    "start": "105680",
    "end": "111270"
  },
  {
    "text": "vulnerability we found in the Linux kernel on two devices we are going to show this on the Amazon echo in the",
    "start": "111270",
    "end": "117810"
  },
  {
    "text": "Samsung gear SmartWatch and hopefully if",
    "start": "117810",
    "end": "123990"
  },
  {
    "text": "all those were the set up we're going to do a live demo of this at the end of our tapas but so in the",
    "start": "123990",
    "end": "131930"
  },
  {
    "text": "last year there have been a lot of research in wireless security really",
    "start": "131930",
    "end": "137510"
  },
  {
    "text": "groundbreaking research and in Broadcom chips two major research was done one by",
    "start": "137510",
    "end": "145150"
  },
  {
    "text": "Exodus it's called broad pond and the other by project is eros researcher both",
    "start": "145150",
    "end": "151160"
  },
  {
    "text": "found our sieve on abilities in Broadcom Wi-Fi chips which already prevalent in a",
    "start": "151160",
    "end": "157010"
  },
  {
    "text": "lot of devices which allows you to take over devices over Wi-Fi which use broad",
    "start": "157010",
    "end": "164630"
  },
  {
    "text": "common devices that use balkan chips another Wi-Fi research was a crack is",
    "start": "164630",
    "end": "170330"
  },
  {
    "text": "going to be here tomorrow and the researcher you've probably heard of it it's protocol flaws in Wi-Fi that enable",
    "start": "170330",
    "end": "179150"
  },
  {
    "text": "attacker to either decrypt or even inject in some cases in Wi-Fi packets in",
    "start": "179150",
    "end": "184220"
  },
  {
    "text": "secure networks and lastly our own research group Warren was also found this ear on Bluetooth vulnerabilities so",
    "start": "184220",
    "end": "191959"
  },
  {
    "text": "this is a field in which a lot of research is being done and although we",
    "start": "191959",
    "end": "198230"
  },
  {
    "text": "feel they have there been previous research it seems that more working is",
    "start": "198230",
    "end": "203570"
  },
  {
    "text": "needed to secure wireless communications so bloodborne is an attack vector",
    "start": "203570",
    "end": "210650"
  },
  {
    "text": "the targets a lot of devices that used bluetooth in which of one of the five",
    "start": "210650",
    "end": "219320"
  },
  {
    "text": "operating systems in that we found one billion so it's Android Windows Linux and iOS and it's really a very powerful",
    "start": "219320",
    "end": "229160"
  },
  {
    "text": "attack vector since it may hit some so many devices 5.3 billion devices were at",
    "start": "229160",
    "end": "234860"
  },
  {
    "text": "risk from the from these vulnerabilities it is actually a subset of eight volatilities which affect each operating",
    "start": "234860",
    "end": "242660"
  },
  {
    "text": "system a bit differently and there are the most severe because of all abilities that we know of today and this is",
    "start": "242660",
    "end": "249500"
  },
  {
    "text": "because this ball is enable an attacker either to gain remote for execution to",
    "start": "249500",
    "end": "255049"
  },
  {
    "text": "get coding to the kitchen on devices to do man-in-the-middle attacks so we'll inject or sniff packets Network",
    "start": "255049",
    "end": "264520"
  },
  {
    "text": "packets from the from without authentication and informational equal abilities that enable attacker either to",
    "start": "264520",
    "end": "271270"
  },
  {
    "text": "bypass mitigations or just to leak crucial data from devices the reason these villages are so severe",
    "start": "271270",
    "end": "278470"
  },
  {
    "text": "because they do not require any user interaction or any authentication and an",
    "start": "278470",
    "end": "283990"
  },
  {
    "text": "attacker can just bypass and attack a device and remotely without anyone",
    "start": "283990",
    "end": "289330"
  },
  {
    "text": "knowing that happened that it happened in the diagram here you can just see the",
    "start": "289330",
    "end": "295389"
  },
  {
    "start": "291000",
    "end": "343000"
  },
  {
    "text": "Bluetooth stack or a part of a typical Bluetooth stack and all the different age long abilities that we found and",
    "start": "295389",
    "end": "301810"
  },
  {
    "text": "we're out in their location in the stack and you can see the values are not in",
    "start": "301810",
    "end": "309610"
  },
  {
    "text": "one specific area in the stack they are actually all across the stack each",
    "start": "309610",
    "end": "314650"
  },
  {
    "text": "vulnerability affecting another a different operating system and so either",
    "start": "314650",
    "end": "320620"
  },
  {
    "text": "there are C vulnerabilities or the mandrill abilities or the information they come in because each or across the",
    "start": "320620",
    "end": "326979"
  },
  {
    "text": "stack and this is just a testament to the fact that no specific part is",
    "start": "326979",
    "end": "332889"
  },
  {
    "text": "vulnerable but it's a general feeling that the stack has the butiful implementations have not been audited",
    "start": "332889",
    "end": "339130"
  },
  {
    "text": "enough and so for that reason we found so many vulnerabilities and now Greg is",
    "start": "339130",
    "end": "344260"
  },
  {
    "start": "343000",
    "end": "489000"
  },
  {
    "text": "going to talk about discoverability which is a main concept in new tooth and it is the first step the thing is needed",
    "start": "344260",
    "end": "351130"
  },
  {
    "text": "to for an attacker to bypass in order to attack Bluetooth devices okay so there",
    "start": "351130",
    "end": "360430"
  },
  {
    "text": "is a common misconception in Bluetooth that two devices in order to communicate",
    "start": "360430",
    "end": "366849"
  },
  {
    "text": "need to pair with each other and in the case of in the general case of normal",
    "start": "366849",
    "end": "373150"
  },
  {
    "text": "devices that is true and when they don't know each other yet during this pairing",
    "start": "373150",
    "end": "378849"
  },
  {
    "text": "they exchange identifiers and the main of which is their Bluetooth address it's",
    "start": "378849",
    "end": "385000"
  },
  {
    "text": "just a MAC address it's a six byte address however once a device or an",
    "start": "385000",
    "end": "390700"
  },
  {
    "text": "attacker knows these six by two this address here she can communicate with the device even",
    "start": "390700",
    "end": "396839"
  },
  {
    "text": "when it's not discoverable so on most operating systems a Bluetooth devices",
    "start": "396839",
    "end": "402719"
  },
  {
    "text": "are always listening to incoming connections they're not always discoverable but they're always listening for incoming connections",
    "start": "402719",
    "end": "408409"
  },
  {
    "text": "almost in all cases when bluetooth is turned on and it is turned on by default on most machines that have bluetooth",
    "start": "408409",
    "end": "415169"
  },
  {
    "text": "hardware so again a device does not need to be discoverable in order for an",
    "start": "415169",
    "end": "420240"
  },
  {
    "text": "attacker to use bluetooth as a vector in addition to this mess identifying a",
    "start": "420240",
    "end": "427889"
  },
  {
    "text": "device it's also part of it a significant part of it is also transmitted plaintext over-the-air in",
    "start": "427889",
    "end": "433889"
  },
  {
    "text": "every Bluetooth packet and so that means if two devices are communicated via bluetooth and attacker that is nearby",
    "start": "433889",
    "end": "441629"
  },
  {
    "text": "and can sniff the radio can get basically 80% of that address out of the",
    "start": "441629",
    "end": "448229"
  },
  {
    "text": "air from a single packet and then brute force the rest which is on the 32 options or so and is able to communicate",
    "start": "448229",
    "end": "454830"
  },
  {
    "text": "with one of the devices now this isn't new open source tools hardware tools",
    "start": "454830",
    "end": "461339"
  },
  {
    "text": "have existed for a long time doing this here we're showing the uber tooth tool it costs about 100 bucks it's been",
    "start": "461339",
    "end": "468029"
  },
  {
    "text": "available for some years now and basically what it does is that an attacker puts it on some Bluetooth",
    "start": "468029",
    "end": "473819"
  },
  {
    "text": "Channel and it's it's just listening for packets from any device to any device",
    "start": "473819",
    "end": "480029"
  },
  {
    "text": "and fix them up and basically it shows the addresses of communicating devices",
    "start": "480029",
    "end": "485249"
  },
  {
    "text": "in the air even when they're not discoverable the only thing they need to do is to actually communicate now this",
    "start": "485249",
    "end": "491339"
  },
  {
    "start": "489000",
    "end": "594000"
  },
  {
    "text": "was a hardware solution that cost 100 bucks a software purely software solutions do exist and for that it's",
    "start": "491339",
    "end": "498749"
  },
  {
    "text": "possible to modify the firmware of existing a Bluetooth adapters or Bluetooth chips it's pretty difficult",
    "start": "498749",
    "end": "506339"
  },
  {
    "text": "and but work on this has been done in the past and we've seen examples the do that and we actually found something",
    "start": "506339",
    "end": "512909"
  },
  {
    "text": "both cheaper and simple a sub $1",
    "start": "512909",
    "end": "518099"
  },
  {
    "text": "solution if you will and this is using this NRF 24a chipset or module that you",
    "start": "518099",
    "end": "526940"
  },
  {
    "text": "can buy on Alibaba for less than a dollar it's based on this NRF 24 chipset which is used for wireless keyboards and",
    "start": "526940",
    "end": "533480"
  },
  {
    "text": "mice which actually the Microsoft and Logitech and a few other companies they",
    "start": "533480",
    "end": "539000"
  },
  {
    "text": "don't use bluetooth further keyboards and mice they use something that's called a proprietary protocol over 2.4",
    "start": "539000",
    "end": "544910"
  },
  {
    "text": "gigahertz and which just so happens to be on the same channels frequencies and modulated exactly the same as Bluetooth",
    "start": "544910",
    "end": "551509"
  },
  {
    "text": "but it's not blue tube so we found the trick will trick simply to configure",
    "start": "551509",
    "end": "557720"
  },
  {
    "text": "this device in a way that will sniff glue to and additionally there has been research done in the past of how to",
    "start": "557720",
    "end": "563600"
  },
  {
    "text": "promiscuous sniffs max of keyboards and mice from these adapters by researcher",
    "start": "563600",
    "end": "569750"
  },
  {
    "text": "called the Travis go speed you might have heard of him and so we combined these two tricks in order to get",
    "start": "569750",
    "end": "576910"
  },
  {
    "text": "basically the same functionality as the SD over tools and be able to sniff out",
    "start": "576910",
    "end": "583279"
  },
  {
    "text": "Bluetooth addresses from where have the code for this is on our github and it's",
    "start": "583279",
    "end": "589040"
  },
  {
    "text": "a Python script just after the talk it's going to play on the github okay okay",
    "start": "589040",
    "end": "595639"
  },
  {
    "text": "now in addition to to do the things I've shown before it's also pretty common for",
    "start": "595639",
    "end": "602779"
  },
  {
    "text": "equipment manufacturers OEMs to to set either the same or adjacent MAC",
    "start": "602779",
    "end": "609470"
  },
  {
    "text": "addresses to the Wi-Fi and Bluetooth chip sites so basically lots of existing",
    "start": "609470",
    "end": "617449"
  },
  {
    "text": "hardware is on the market that can sniff Wi-Fi in one mode so if you just sniff Wi-Fi packets of a device and it has",
    "start": "617449",
    "end": "624050"
  },
  {
    "text": "Bluetooth enabled and it's one of the majority I suppose of devices where the Bluetooth address is adjacent then you",
    "start": "624050",
    "end": "630199"
  },
  {
    "text": "also know the Bluetooth address basically so that's also a and even a step further if the attacker is both in",
    "start": "630199",
    "end": "637339"
  },
  {
    "text": "proximity physically and on the same network then they can know the MAC address the Wi-Fi MAC address and the",
    "start": "637339",
    "end": "643550"
  },
  {
    "text": "Bluetooth address just from doing looking at its ARP cache",
    "start": "643550",
    "end": "649959"
  },
  {
    "start": "649000",
    "end": "713000"
  },
  {
    "text": "okay so now we can communicate with the Bluetooth device and how do we attack it",
    "start": "649959",
    "end": "656270"
  },
  {
    "text": "Bluetooth is a has a very large attack surface and what you see here yeah the",
    "start": "656270",
    "end": "663529"
  },
  {
    "text": "boxes above are the profiles and services of look these are the higher level things that you know afleck",
    "start": "663529",
    "end": "671920"
  },
  {
    "text": "Ethernet tethering or sound or stuff like that hid and there are lots of",
    "start": "671920",
    "end": "679310"
  },
  {
    "text": "those and one of them is called the SDP it's the service discovery protocol it's a protocol that allows you to discover",
    "start": "679310",
    "end": "685610"
  },
  {
    "text": "what other protocols are available on the device and below that is the l2 cap",
    "start": "685610",
    "end": "690920"
  },
  {
    "text": "player if the alto cap layer is basically the transport layer and the reliable transport layer it's like TCP",
    "start": "690920",
    "end": "696740"
  },
  {
    "text": "for Bluetooth in many ways and below that are the hardware communication with with the Bluetooth adapter and the",
    "start": "696740",
    "end": "702830"
  },
  {
    "text": "packet layers HDL and such a lot of these services they do not require syndication to connect for instance LDP",
    "start": "702830",
    "end": "709910"
  },
  {
    "text": "obviously by design and except for the huge attack surface it's all extremely",
    "start": "709910",
    "end": "716930"
  },
  {
    "start": "713000",
    "end": "751000"
  },
  {
    "text": "complicated the spec that defines most of this stuff which is seen here is very",
    "start": "716930",
    "end": "723770"
  },
  {
    "text": "long some pages look like this one and this one's particularly what it shows is",
    "start": "723770",
    "end": "729080"
  },
  {
    "text": "a what's called a packet fragmentation and that's implemented in four different",
    "start": "729080",
    "end": "735050"
  },
  {
    "text": "layers up to an including l2 cap why would you need that I don't know but it exists now every time a packet",
    "start": "735050",
    "end": "741860"
  },
  {
    "text": "fragmentation is something that's pretty bug prone in implementation so every implementation has four chances of",
    "start": "741860",
    "end": "747920"
  },
  {
    "text": "getting it wrong and they do and now in this talk we're",
    "start": "747920",
    "end": "754190"
  },
  {
    "text": "going to talk about the Blues implementation which is the Linux implementation of Bluetooth it's been around since 2001 and you may know that",
    "start": "754190",
    "end": "761029"
  },
  {
    "text": "Bluetooth has been around from 1998 it's actually the first native OS Bluetooth",
    "start": "761029",
    "end": "766520"
  },
  {
    "text": "stack that exists inside the relaxed and what it does is talk to lots of",
    "start": "766520",
    "end": "771560"
  },
  {
    "text": "controllers to the hardware devices it has a kernel side implementation of the",
    "start": "771560",
    "end": "777350"
  },
  {
    "text": "lower quarter calls the HCI is the communication with the hardware a sells the packet protocol and lt cap is the",
    "start": "777350",
    "end": "783940"
  },
  {
    "text": "tcp transport protocol besides that there is the userland implementation in the",
    "start": "783940",
    "end": "789760"
  },
  {
    "text": "Bluetooth D it does pairing and authentication the higher level stuff it provides those services including SDP",
    "start": "789760",
    "end": "796690"
  },
  {
    "text": "and it runs its route so interestingly all these huge attack surface all of it runs at least as route and some of it in",
    "start": "796690",
    "end": "803620"
  },
  {
    "text": "kernel and now Ben is gonna talk to you particularly about the vulnerability",
    "start": "803620",
    "end": "808690"
  },
  {
    "start": "804000",
    "end": "876000"
  },
  {
    "text": "that we found in the l2 cap layer inlets yes so as Greg was saying L to cap his",
    "start": "808690",
    "end": "816340"
  },
  {
    "text": "debrief equivalent of TCP it is a trial transport layer so it is like TCP it",
    "start": "816340",
    "end": "824830"
  },
  {
    "text": "does connection it does the connection to the servers to the services and it",
    "start": "824830",
    "end": "831940"
  },
  {
    "text": "offers some quality of service features so if it can have you can have a reliable connection over the non",
    "start": "831940",
    "end": "838630"
  },
  {
    "text": "reliable ACL packets so basically like TCP you can have your service listening",
    "start": "838630",
    "end": "845920"
  },
  {
    "text": "for incoming connections and you have a bit of line connecting to it and l2 cap",
    "start": "845920",
    "end": "851590"
  },
  {
    "text": "will be that transfer would Clara that would allow that connection to take place since it offers a lot of quality",
    "start": "851590",
    "end": "857770"
  },
  {
    "text": "of surface features there is a lot of code and to implement those features so",
    "start": "857770",
    "end": "863380"
  },
  {
    "text": "there was an wide attack surface in l2 cap and as Greg mentioned before LT",
    "start": "863380",
    "end": "868570"
  },
  {
    "text": "capping Blues specifically is implemented inside the kernel so an ability there might be very vulnerable",
    "start": "868570",
    "end": "874690"
  },
  {
    "text": "very good to an attacker so there is a",
    "start": "874690",
    "end": "880630"
  },
  {
    "start": "876000",
    "end": "969000"
  },
  {
    "text": "concept in the cab that's called mutual configuration it helps do the quality of service",
    "start": "880630",
    "end": "891240"
  },
  {
    "text": "negotiation in the start of the connection the connection parameters are",
    "start": "891240",
    "end": "896680"
  },
  {
    "text": "negotiated in this process and the way it works is that device a in this",
    "start": "896680",
    "end": "903850"
  },
  {
    "text": "diagram will send a configuration request message which will basically have plenty of options",
    "start": "903850",
    "end": "909580"
  },
  {
    "text": "plenty of configuration elements in it like the MTU of the connection like what",
    "start": "909580",
    "end": "915070"
  },
  {
    "text": "quality of service features you want to implement in that connection and so on and if you will send that message",
    "start": "915070",
    "end": "921139"
  },
  {
    "text": "device B device we will then either accept that configuration or we reject it with a configuration response message",
    "start": "921139",
    "end": "927529"
  },
  {
    "text": "and if you chooses to reject it you can offer an alternative configuration parameters so it can change the MTU or",
    "start": "927529",
    "end": "935389"
  },
  {
    "text": "other connection parameters and send and send them in that configuration response",
    "start": "935389",
    "end": "940910"
  },
  {
    "text": "message if it rejects them device a you will then offer another configuration with another configuration request and",
    "start": "940910",
    "end": "947869"
  },
  {
    "text": "so on and they wouldn't go negotiate until they reach an agreement on the parameters this process it's called new",
    "start": "947869",
    "end": "954079"
  },
  {
    "text": "chip configuration because it happens in both ways so each device will negotiate",
    "start": "954079",
    "end": "960189"
  },
  {
    "text": "its sides of the connection parameters sending the correct configuration request and the same will happen twice",
    "start": "960189",
    "end": "967309"
  },
  {
    "text": "person on the other end so here we can see an example of this process device a",
    "start": "967309",
    "end": "973009"
  },
  {
    "start": "969000",
    "end": "1004000"
  },
  {
    "text": "on the Left we send the configuration request with an out number of options in",
    "start": "973009",
    "end": "978470"
  },
  {
    "text": "the message of the correct equation parameters and device being on the right will send a configuration response in",
    "start": "978470",
    "end": "984980"
  },
  {
    "text": "this instance the result is failure so he unaccepted the parameters and he",
    "start": "984980",
    "end": "991459"
  },
  {
    "text": "offered to change some parameter in some way the like I said before and device a",
    "start": "991459",
    "end": "996799"
  },
  {
    "text": "when he receives this configuration response message will then need to build another configuration request message",
    "start": "996799",
    "end": "1001929"
  },
  {
    "text": "and continue the negotiation process and this is exactly the mechanism the",
    "start": "1001929",
    "end": "1007869"
  },
  {
    "start": "1004000",
    "end": "1099000"
  },
  {
    "text": "negotiation process here in which we found our Sivan ability in the kernel so",
    "start": "1007869",
    "end": "1013929"
  },
  {
    "text": "this function parses the configuration response so the messages that are being returned to the country configuration we",
    "start": "1013929",
    "end": "1020679"
  },
  {
    "text": "request and then it needs to build an output configuration request message",
    "start": "1020679",
    "end": "1025740"
  },
  {
    "text": "that we returned so the congressional process will continue and looking at the prototype of",
    "start": "1025740",
    "end": "1032380"
  },
  {
    "text": "the function we noticed that something is missing the highlighted the arguments there or the RSP variable is the input",
    "start": "1032380",
    "end": "1039819"
  },
  {
    "text": "configuration response message pointer the LAN is that length of that message and then data pointer is the out",
    "start": "1039819",
    "end": "1046899"
  },
  {
    "text": "parameter it's the configuration request message that will be built in the process of parsing this in",
    "start": "1046899",
    "end": "1052410"
  },
  {
    "text": "put message and returned to the to the other pier and the data argument doesn't",
    "start": "1052410",
    "end": "1057840"
  },
  {
    "text": "have a length attached to it so this function doesn't know what all the bounds what is the size of this data",
    "start": "1057840",
    "end": "1063540"
  },
  {
    "text": "pointer and it's just copies and the input configuration elements from one",
    "start": "1063540",
    "end": "1068550"
  },
  {
    "text": "and from from the response message to the new request message that is being built and there is no validation of the",
    "start": "1068550",
    "end": "1074550"
  },
  {
    "text": "bounds of the same memory pointer of the data pointer here in the while loop",
    "start": "1074550",
    "end": "1080340"
  },
  {
    "text": "there just goes and gets all the configuration elements forms a message",
    "start": "1080340",
    "end": "1086730"
  },
  {
    "text": "from the input message and copies them or change them changes them depending on the data into the out into the data",
    "start": "1086730",
    "end": "1094560"
  },
  {
    "text": "pointer that is pointed with PTR them so",
    "start": "1094560",
    "end": "1100620"
  },
  {
    "text": "this function this advocate parts are still function is vulnerable it can write out of bounds to the data",
    "start": "1100620",
    "end": "1107760"
  },
  {
    "text": "particularly to receive what is that pointer so in this context it is the",
    "start": "1107760",
    "end": "1113340"
  },
  {
    "text": "Buffs pointer that is being passed attached to it this is this function is the function that receives the",
    "start": "1113340",
    "end": "1119820"
  },
  {
    "text": "configuration response messages so buff here is just a 64 byte buffer on the",
    "start": "1119820",
    "end": "1125310"
  },
  {
    "text": "stack so obviously a stack overflow can be abused in this flow the only caveat",
    "start": "1125310",
    "end": "1130530"
  },
  {
    "text": "here is that the device needs to be in the pending state which actually is a",
    "start": "1130530",
    "end": "1135960"
  },
  {
    "text": "stage that the attacker has a lot of control over so prior to sending this",
    "start": "1135960",
    "end": "1141120"
  },
  {
    "text": "overflow message he can send another message that will put the device in the pending state and then the overflow can",
    "start": "1141120",
    "end": "1147600"
  },
  {
    "text": "be triggered so what what is the strategy for this exploit it is a",
    "start": "1147600",
    "end": "1153390"
  },
  {
    "start": "1149000",
    "end": "1273000"
  },
  {
    "text": "classic stack overflow like the 90s like the good old days so it shouldn't be too hard but there are some limitations we",
    "start": "1153390",
    "end": "1160680"
  },
  {
    "text": "need the ability to send whatever configuration response messages we'd like because it is not usually that the",
    "start": "1160680",
    "end": "1169110"
  },
  {
    "text": "way it works usually you have your stack and it will do the negotiation it will send whatever configuration response",
    "start": "1169110",
    "end": "1174720"
  },
  {
    "text": "messages it like so so we developed a small testing framework for us to send",
    "start": "1174720",
    "end": "1179850"
  },
  {
    "text": "our configuration response messages we're going to do a stack overflow but want to know what what",
    "start": "1179850",
    "end": "1185970"
  },
  {
    "text": "going to overflow we want to choose our very specifically so we need to find either pointers or the return address of",
    "start": "1185970",
    "end": "1192900"
  },
  {
    "text": "the function to overflow and simultaneously the buffer that we are going to use to overflow also needs to",
    "start": "1192900",
    "end": "1198720"
  },
  {
    "text": "be a valid configuration response message because in the loop here in the",
    "start": "1198720",
    "end": "1204720"
  },
  {
    "text": "while loop here if we send an invalid configuration response miss configuration element the while loop would break and our overflow would stop",
    "start": "1204720",
    "end": "1211260"
  },
  {
    "text": "so it also has to be a valid response message if there are any mitigations in",
    "start": "1211260",
    "end": "1216450"
  },
  {
    "text": "the device that we are attacking we need to bypass them before we trigger the overflow either creates a lower or stack",
    "start": "1216450",
    "end": "1224040"
  },
  {
    "text": "enemies and once we do over for what we want is to develop develop a rightward",
    "start": "1224040",
    "end": "1229530"
  },
  {
    "text": "primitive so we have the control to write some data in some address in the",
    "start": "1229530",
    "end": "1235260"
  },
  {
    "text": "memory and that would allow us either to to insert a web chain or do a simple",
    "start": "1235260",
    "end": "1242850"
  },
  {
    "text": "shell code that would be one inside the camera once we have definitive we want a",
    "start": "1242850",
    "end": "1248820"
  },
  {
    "text": "way to get out of the car no to user space that would be simpler to do post",
    "start": "1248820",
    "end": "1255210"
  },
  {
    "text": "exploitation so we're going to use user mode helpers which will not later to do",
    "start": "1255210",
    "end": "1260490"
  },
  {
    "text": "this process and lastly if there are any at the same module Linux security models",
    "start": "1260490",
    "end": "1265560"
  },
  {
    "text": "like SELinux or others we want to disable them before going at user space because we are in",
    "start": "1265560",
    "end": "1270690"
  },
  {
    "text": "kernel we have that ability so it'd be nice to do that so what are the expected",
    "start": "1270690",
    "end": "1276120"
  },
  {
    "start": "1273000",
    "end": "1337000"
  },
  {
    "text": "mitigations in 2017 in any linux device what we expect to find in devices a SLR",
    "start": "1276120",
    "end": "1283020"
  },
  {
    "text": "is address outer space randomization it would be hard for an attacker to know",
    "start": "1283020",
    "end": "1288420"
  },
  {
    "text": "the addresses we need to do the stack overflow so that is to be expected stack",
    "start": "1288420",
    "end": "1293940"
  },
  {
    "text": "calories are very basic very good",
    "start": "1293940",
    "end": "1299010"
  },
  {
    "text": "mitigation to prevent stack overflows 45 source is a feature of reduce before",
    "start": "1299010",
    "end": "1306320"
  },
  {
    "text": "even hardening stack our enemies calories even more so to put the stack buffer is adjacent to the calories so if",
    "start": "1306320",
    "end": "1313170"
  },
  {
    "text": "an attacker could overflow that buffer it would go into the cannery and he has to know which cannery",
    "start": "1313170",
    "end": "1318690"
  },
  {
    "text": "to exploit this and AMEX beat is a very basic feature in a lot of devices that",
    "start": "1318690",
    "end": "1326130"
  },
  {
    "text": "is used to prevent data from being executed and code from being writable so",
    "start": "1326130",
    "end": "1331410"
  },
  {
    "text": "the attacker cannot simply jump to its shellcode and either on the stack or in a different form in the memory what are",
    "start": "1331410",
    "end": "1338250"
  },
  {
    "start": "1337000",
    "end": "1428000"
  },
  {
    "text": "the real world cannot configuration that we actually find K cell are the a seller of the kernel is not really enabled in",
    "start": "1338250",
    "end": "1345240"
  },
  {
    "text": "any devices it was only added to the current to the default configuration of the kernel in very recent versions and",
    "start": "1345240",
    "end": "1352290"
  },
  {
    "text": "it is a hassle for a lot of devices to use it so it's actually not being",
    "start": "1352290",
    "end": "1358080"
  },
  {
    "text": "enabled at all at least in devices that have blue topaz like the case stack",
    "start": "1358080",
    "end": "1366270"
  },
  {
    "text": "Canaries are only enabled in the major Linux distributions they are not in the default configuration of the kernel for",
    "start": "1366270",
    "end": "1371580"
  },
  {
    "text": "some reason so any device device that uses mainline kernel just with a",
    "start": "1371580",
    "end": "1376980"
  },
  {
    "text": "different configuration we're not necessarily enable them we actually haven't been able to find any IOT",
    "start": "1376980",
    "end": "1382890"
  },
  {
    "text": "devices that use that Canaries although they are very basic litigation there is",
    "start": "1382890",
    "end": "1387960"
  },
  {
    "text": "a funny case of fortify source being enabled but stack Canaries disabled this",
    "start": "1387960",
    "end": "1393030"
  },
  {
    "text": "is not a good combination because if you have enabled 45 source the stack buffer will be placed on the",
    "start": "1393030",
    "end": "1400050"
  },
  {
    "text": "bottom of the stack and then the first of a three will be of a frame pointer or the return address so you instantly have",
    "start": "1400050",
    "end": "1406800"
  },
  {
    "text": "control over something that's very significant and this is actually the case of the samsung smart virtual that",
    "start": "1406800",
    "end": "1411870"
  },
  {
    "text": "we have exploited noetic sweet we were really surprised to find out that the Amazon echo doesn't know does not use",
    "start": "1411870",
    "end": "1418320"
  },
  {
    "text": "the NX bit or visited poorly we are not really sure so we can do it like the 90s",
    "start": "1418320",
    "end": "1423840"
  },
  {
    "text": "we can just dump jump to our shell code in the stack so we have tested two",
    "start": "1423840",
    "end": "1430530"
  },
  {
    "start": "1428000",
    "end": "1464000"
  },
  {
    "text": "devices for this RC phone ability one is the Samsung Smart Watch",
    "start": "1430530",
    "end": "1436260"
  },
  {
    "text": "it was a pretty new kernel not that all the Canada 3.18 each one's an ARM",
    "start": "1436260",
    "end": "1443490"
  },
  {
    "text": "processor 64 beat it has very few integrations no case a la nostra can erase it has the funny coming",
    "start": "1443490",
    "end": "1449720"
  },
  {
    "text": "or fortify source enabled sixth a Canary's disabled it also has smack",
    "start": "1449720",
    "end": "1455090"
  },
  {
    "text": "which isn't some alternative to sa linux but we can mitigate we can bypass that",
    "start": "1455090",
    "end": "1461990"
  },
  {
    "text": "once we have a code execution in the camera and the second case study is damos an echo which is based on a very",
    "start": "1461990",
    "end": "1469010"
  },
  {
    "start": "1464000",
    "end": "1510000"
  },
  {
    "text": "old camera for some reason it's 2.6 kernel it runs on our 32-bit and it has",
    "start": "1469010",
    "end": "1476210"
  },
  {
    "text": "virtually no mitigation at all no case alone or stack Canaries no fortify",
    "start": "1476210",
    "end": "1481400"
  },
  {
    "text": "source nor an XP no access controls in that case there is no 45 source but it",
    "start": "1481400",
    "end": "1487670"
  },
  {
    "text": "actually works in our benefit we're going to show that because we can overflow something that is not the stack",
    "start": "1487670",
    "end": "1493910"
  },
  {
    "text": "pointer or the frame pointer and we that point the the fact is that there's a very very nice and valuable pointer for",
    "start": "1493910",
    "end": "1500870"
  },
  {
    "text": "that a current that you pretty adjacent to the overflowing buffer alison has",
    "start": "1500870",
    "end": "1506030"
  },
  {
    "text": "provided a patch for this just two weeks ago so now Greg is going to talk about",
    "start": "1506030",
    "end": "1512000"
  },
  {
    "start": "1510000",
    "end": "1571000"
  },
  {
    "text": "the delimited RC so we have in the old colonel that's one of on the echo okay",
    "start": "1512000",
    "end": "1517970"
  },
  {
    "text": "so initially when we looked at the echo and the synthesis has such an old kernel and actually didn't find that",
    "start": "1517970",
    "end": "1524330"
  },
  {
    "text": "vulnerability that Ben has shown previously in this version because it's existed in its form from Linux 3.3 and",
    "start": "1524330",
    "end": "1531020"
  },
  {
    "text": "up however what we did find is that it does exist a from kernel to 632 enough",
    "start": "1531020",
    "end": "1537830"
  },
  {
    "text": "in a more limited scenario as you can see the state that that case needs to be",
    "start": "1537830",
    "end": "1544100"
  },
  {
    "text": "in there is an exception this case previously it was in the pending state again doesn't really matter this is attacker control more or less",
    "start": "1544100",
    "end": "1550520"
  },
  {
    "text": "however the limitation here is this if above there and what it does is it checks that the size of the input a",
    "start": "1550520",
    "end": "1557990"
  },
  {
    "text": "configuration response message is 60 bytes and if you remember the buffer",
    "start": "1557990",
    "end": "1563900"
  },
  {
    "text": "we're overflowing is 64 bytes so that should be a problem right well it turns out that it it really isn't what happens",
    "start": "1563900",
    "end": "1572630"
  },
  {
    "start": "1571000",
    "end": "1635000"
  },
  {
    "text": "is that the configuration parameters coming elements and",
    "start": "1572630",
    "end": "1578620"
  },
  {
    "text": "these elements are built like TLC's third length value structures and so",
    "start": "1578620",
    "end": "1585880"
  },
  {
    "text": "basically there is one by four type in this case type number four is that case",
    "start": "1585880",
    "end": "1592390"
  },
  {
    "text": "down there called the conf RFC and the length can be zero for example so the",
    "start": "1592390",
    "end": "1598270"
  },
  {
    "text": "only two bytes are required to define a single element but what this function does this code is out of the same",
    "start": "1598270",
    "end": "1603700"
  },
  {
    "text": "function that has the vulnerabilities original vulnerability in it and what it does is that the loop goes over all the",
    "start": "1603700",
    "end": "1610570"
  },
  {
    "text": "input elements and then it does something with them and it writes out elements into the output however in this",
    "start": "1610570",
    "end": "1617260"
  },
  {
    "text": "case as you can see the element is written out there is not of the of the",
    "start": "1617260",
    "end": "1622390"
  },
  {
    "text": "zero size that we've set but of the actual real size for that element which is that size of down there which happens",
    "start": "1622390",
    "end": "1627970"
  },
  {
    "text": "to be more than just these two bytes so this means we can amplify the size of",
    "start": "1627970",
    "end": "1633070"
  },
  {
    "text": "our elements inside the output buffer and what we are showing here this is",
    "start": "1633070",
    "end": "1638410"
  },
  {
    "text": "actually the actual stack frame from the echo on the previous version before it's patched and on the left there is a r2 by",
    "start": "1638410",
    "end": "1648190"
  },
  {
    "text": "what we call the zero land RFC element and on the right what's written to this",
    "start": "1648190",
    "end": "1653710"
  },
  {
    "text": "to the stack frame was written to the output buffer is an 11 by 2 element because it has it's supposed to be 11 by",
    "start": "1653710",
    "end": "1660910"
  },
  {
    "text": "its low so for every 2 bytes we can write 11 bytes and if we do the message in the message shows that for the 60",
    "start": "1660910",
    "end": "1667360"
  },
  {
    "text": "bytes that we can input we get 330 bytes of output which is a lot more than 64",
    "start": "1667360",
    "end": "1672760"
  },
  {
    "text": "bytes that we should have an and one thing that is uncomfortable here is that the data is uncontrolled this is",
    "start": "1672760",
    "end": "1680050"
  },
  {
    "text": "uninitialized what is right in there in that element okay so we looked at the",
    "start": "1680050",
    "end": "1687520"
  },
  {
    "start": "1683000",
    "end": "1732000"
  },
  {
    "text": "stack of the stack frame itself on the echo and as Ben said it has no 45 source",
    "start": "1687520",
    "end": "1694200"
  },
  {
    "text": "and therefore it is not adjacent to the return address or the save registers",
    "start": "1694200",
    "end": "1699880"
  },
  {
    "text": "however there's something more interesting there the buffer is slightly above on the stack from a pointer called",
    "start": "1699880",
    "end": "1705910"
  },
  {
    "text": "PTR which you can see here this is actually the pointer of where the next element is written to so",
    "start": "1705910",
    "end": "1712160"
  },
  {
    "text": "an element is sparse or Canaries updated to the next element in the output button so if we overflow that with an element",
    "start": "1712160",
    "end": "1718400"
  },
  {
    "text": "and we control what was written then we control where the next element will be",
    "start": "1718400",
    "end": "1723770"
  },
  {
    "text": "written and this gives us our right what we're primitive it's a sort of what",
    "start": "1723770",
    "end": "1729320"
  },
  {
    "text": "we're going to do and however there's an annoying limitation simply writing those",
    "start": "1729320",
    "end": "1737480"
  },
  {
    "text": "24 zero and four C's it will not allow us to control the pointer it will overflow it but the data will be",
    "start": "1737480",
    "end": "1743360"
  },
  {
    "text": "uncontrolled so we need to to massage it in some way to find a solution so that's",
    "start": "1743360",
    "end": "1749690"
  },
  {
    "text": "so basically there are other elements except for RFC they have different sizes in this case it's the flush and MTU",
    "start": "1749690",
    "end": "1755690"
  },
  {
    "text": "elements so we build our input buffer in such a way that what what happens is",
    "start": "1755690",
    "end": "1762650"
  },
  {
    "text": "that there are 22 empty RFC's that will bring us further away in on the stack",
    "start": "1762650",
    "end": "1767930"
  },
  {
    "text": "frame then we use other elements in this case flush elements to align ourselves to all right and lastly we can write two",
    "start": "1767930",
    "end": "1775490"
  },
  {
    "text": "controlled bytes anywhere we want there well basically where we are lying to the",
    "start": "1775490",
    "end": "1783440"
  },
  {
    "text": "place where line con is on to this pointer this pointer again controls where the next element will be written",
    "start": "1783440",
    "end": "1789620"
  },
  {
    "text": "and particularly here we overflow the first two bytes of that pointer and this is a little endian our machine the first",
    "start": "1789620",
    "end": "1796730"
  },
  {
    "text": "two bytes are the two least significant bits of the address and this pointer is an address to the stack so overflowing",
    "start": "1796730",
    "end": "1804740"
  },
  {
    "text": "the two least significant byte of an address on the stack lets us then write anywhere basically on",
    "start": "1804740",
    "end": "1812030"
  },
  {
    "text": "the stack and this is what we do what you can see here is that at first we",
    "start": "1812030",
    "end": "1818540"
  },
  {
    "start": "1815000",
    "end": "1908000"
  },
  {
    "text": "send all our elements that overflow PTR and we write the two least significant",
    "start": "1818540",
    "end": "1824690"
  },
  {
    "text": "bikes of where the next element will be written and on the right to see where we write those bytes and we overflow the",
    "start": "1824690",
    "end": "1830420"
  },
  {
    "text": "ELA register on the same register which is the return address of the function we overflow two bytes here because that's",
    "start": "1830420",
    "end": "1836240"
  },
  {
    "text": "kind of our limitation and we can do that with a single alt okay",
    "start": "1836240",
    "end": "1841900"
  },
  {
    "text": "conf response a command so it's kind of",
    "start": "1841900",
    "end": "1847450"
  },
  {
    "text": "a problem writing just to buy it but it turns out that Bluetooth being so complicated is good for us again",
    "start": "1847450",
    "end": "1855090"
  },
  {
    "text": "basically it's possible in l2 cap to put multiple commands into one packet and in",
    "start": "1855090",
    "end": "1861490"
  },
  {
    "text": "addition to that there is a fragmentation layer below LT up at NaCl which allows us to now build really",
    "start": "1861490",
    "end": "1867730"
  },
  {
    "text": "large l2 cache packets so basically we can pack together lots and lots of these commands and and then in a single packet",
    "start": "1867730",
    "end": "1875290"
  },
  {
    "text": "right however many bytes we want on the step so what we'll do with that is at",
    "start": "1875290",
    "end": "1881620"
  },
  {
    "text": "first write a shellcode somewhere on the stack again there is no NX bit on this device so we can just write a shellcode",
    "start": "1881620",
    "end": "1887110"
  },
  {
    "text": "and then overflow the overflow with two",
    "start": "1887110",
    "end": "1892630"
  },
  {
    "text": "times two bytes the return address there is a small caveat here you may see that",
    "start": "1892630",
    "end": "1897640"
  },
  {
    "text": "there are uncontrolled two bytes written in addition to our control two bytes so we need to write them in reverse a lot",
    "start": "1897640",
    "end": "1904630"
  },
  {
    "text": "of problem and then our shell code will be executed as you can see here if you",
    "start": "1904630",
    "end": "1910510"
  },
  {
    "text": "can see on the left there is that huge packet it contains many it's over a CL",
    "start": "1910510",
    "end": "1918040"
  },
  {
    "text": "fragmentation is pretty large and it contains many LT cap commands which are the configured sponsors and on the right",
    "start": "1918040",
    "end": "1924460"
  },
  {
    "text": "is a particular single configuration response that has many of these empty RFC elements these are the empty options",
    "start": "1924460",
    "end": "1930220"
  },
  {
    "text": "that you see there Wireshark and parsing and lastly there are the two flash elements that are used to actually write",
    "start": "1930220",
    "end": "1936520"
  },
  {
    "text": "data okay so now Ben is gonna explain what you actually do with this oh it's",
    "start": "1936520",
    "end": "1941650"
  },
  {
    "start": "1937000",
    "end": "2008000"
  },
  {
    "text": "post exploitation yes so I have as we said we now have a kind of remote code",
    "start": "1941650",
    "end": "1948460"
  },
  {
    "text": "execution but we want something more convenient for us we want to have a word shell and for that we use a very nice",
    "start": "1948460",
    "end": "1955270"
  },
  {
    "text": "concept that exists inside the Linux kernel which is called user mode helpers it actually exists inside the kernel to",
    "start": "1955270",
    "end": "1962140"
  },
  {
    "text": "allow it to run some commands user space in different scenarios for example if a",
    "start": "1962140",
    "end": "1969520"
  },
  {
    "text": "device wants to power off he wants to do that gracefully so he wants to run some of commands in userspace to shut down",
    "start": "1969520",
    "end": "1977020"
  },
  {
    "text": "the services nicely before actually firing off the machine so the orderly power function does exact",
    "start": "1977020",
    "end": "1983770"
  },
  {
    "text": "exactly that and it takes the power of command which is a global which is a writable spring inside the kernel and",
    "start": "1983770",
    "end": "1989410"
  },
  {
    "text": "once that command uses a space it also eventually power of the machine but it",
    "start": "1989410",
    "end": "1995230"
  },
  {
    "text": "has a factor that allows you to prevent it from doing that so our circle will basically right over",
    "start": "1995230",
    "end": "2001680"
  },
  {
    "text": "that power of command whatever commands we're going to run in user space and call the orderly power function so it's",
    "start": "2001680",
    "end": "2007500"
  },
  {
    "text": "very simple so just to recap on the exploit process what we do is we begin in early cap connection with a high end",
    "start": "2007500",
    "end": "2013770"
  },
  {
    "start": "2008000",
    "end": "2051000"
  },
  {
    "text": "for you that will allow us to send the large packet but take it Greg showed you",
    "start": "2013770",
    "end": "2018960"
  },
  {
    "text": "before containing all of these multiple configuration response commands they",
    "start": "2018960",
    "end": "2023970"
  },
  {
    "text": "will write our shell code to the stack in an unused everyone on the stack and then also overwrite the return address",
    "start": "2023970",
    "end": "2032190"
  },
  {
    "text": "of the function so we're all caught with one the pair will simply arrive whatever",
    "start": "2032190",
    "end": "2037380"
  },
  {
    "text": "commands we want to run in userspace on the power of command and execute the order the power function and finally it",
    "start": "2037380",
    "end": "2044190"
  },
  {
    "text": "will restore execution and the device device will be unharmed so it will continue to run in the",
    "start": "2044190",
    "end": "2052980"
  },
  {
    "text": "SmartWatch you had to have a different exploit a bit difficult guys but it uses",
    "start": "2052980",
    "end": "2059370"
  },
  {
    "text": "the same principles but it does have to do something and be different the expert",
    "start": "2059370",
    "end": "2064500"
  },
  {
    "text": "was develop / co-worker force alone listener and it has to bypass the NX bit",
    "start": "2064500",
    "end": "2072440"
  },
  {
    "text": "limitation so they the stack cannot be executed in this case but and we can do",
    "start": "2072440",
    "end": "2081090"
  },
  {
    "text": "a basic wife chain that gives us the right work where Matthias and then we",
    "start": "2081090",
    "end": "2087120"
  },
  {
    "text": "just do the same thing we write our power of command with whatever the",
    "start": "2087120",
    "end": "2094290"
  },
  {
    "text": "command we want and then we're on the orderly power function and that's that's",
    "start": "2094290",
    "end": "2099300"
  },
  {
    "text": "it okay so we wanted to to take take a",
    "start": "2099300",
    "end": "2105900"
  },
  {
    "start": "2100000",
    "end": "2216000"
  },
  {
    "text": "look at devices that do have like these specific devices that have stack areas okay Solara and this is like",
    "start": "2105900",
    "end": "2112900"
  },
  {
    "text": "really really new we found this a week ago and it's actually been it's a new phone ability that we found it's a ninth",
    "start": "2112900",
    "end": "2118960"
  },
  {
    "text": "Bluetooth vulnerability so it's an information leak vulnerability from the Linux kernel in the same beloved",
    "start": "2118960",
    "end": "2125290"
  },
  {
    "text": "function as we kept our conf RSP so this",
    "start": "2125290",
    "end": "2130420"
  },
  {
    "text": "information it can it can allow attackers to bypass mitigation such a case of our stack Canaries by leaking",
    "start": "2130420",
    "end": "2136960"
  },
  {
    "text": "the pointers or by linking the stack Canaries we have a bit of connection so",
    "start": "2136960",
    "end": "2144270"
  },
  {
    "text": "what we can see here is the EFS viable is uninitialized on the stack and there",
    "start": "2144270",
    "end": "2150430"
  },
  {
    "text": "is a flow in the code that allows us to send it back to you this up to the attacker uninitialized in its",
    "start": "2150430",
    "end": "2155860"
  },
  {
    "text": "uninitialized state the OL and you can see there is the input configuration",
    "start": "2155860",
    "end": "2161530"
  },
  {
    "text": "element that is but he's been parsed so the attacker has the control of this",
    "start": "2161530",
    "end": "2166930"
  },
  {
    "text": "length so it can avoid the mem copy call by sending an EFS element which is not",
    "start": "2166930",
    "end": "2173680"
  },
  {
    "text": "the size of EFS and then the main cannot occur but still the ESS level will be",
    "start": "2173680",
    "end": "2180280"
  },
  {
    "text": "returned to the attacker in the Alcott's opt function so these are 16 bytes from",
    "start": "2180280",
    "end": "2186070"
  },
  {
    "text": "the stack uninitialized and they will have somewhat of a random value but the",
    "start": "2186070",
    "end": "2191440"
  },
  {
    "text": "attacker can control what value would be on that uninitialized stacked by doing prior calls to other functions before",
    "start": "2191440",
    "end": "2198250"
  },
  {
    "text": "calling this function so we can analyze the stack of this device with targeting",
    "start": "2198250",
    "end": "2203830"
  },
  {
    "text": "and you can make sure that in that uninitialized space the stack memory or other pointers",
    "start": "2203830",
    "end": "2210580"
  },
  {
    "text": "will be placed so that way he can leak there was less depth data and here you",
    "start": "2210580",
    "end": "2216940"
  },
  {
    "start": "2216000",
    "end": "2241000"
  },
  {
    "text": "can see an example of this being done specifically on the SmartWatch when we",
    "start": "2216940",
    "end": "2222520"
  },
  {
    "text": "send the configuration response messages that will cause the return of constriction request with the ESS",
    "start": "2222520",
    "end": "2229210"
  },
  {
    "text": "variable with its uninitialized stack travel in those last eight bytes and in",
    "start": "2229210",
    "end": "2234460"
  },
  {
    "text": "that hex dump is actually a pointer from the stack it's the point of the code in the watch okay so we're really close to to",
    "start": "2234460",
    "end": "2243880"
  },
  {
    "start": "2241000",
    "end": "2328000"
  },
  {
    "text": "an end here we're going to do the demo in a second I wanted to just recap on our takeaways from from this presentation Bluetooth implementations",
    "start": "2243880",
    "end": "2253060"
  },
  {
    "text": "are really complex this is like number one I think we said that a bunch of times and it's true there was a lot of",
    "start": "2253060",
    "end": "2259599"
  },
  {
    "text": "code and what we found is that it is not examined enough there are a lot of potential vulnerabilities still there",
    "start": "2259599",
    "end": "2267040"
  },
  {
    "text": "and this should be we thought and we audited mitigations emitted devices not",
    "start": "2267040",
    "end": "2273579"
  },
  {
    "text": "or not not actually always implemented in IOT this is very extreme case but I",
    "start": "2273579",
    "end": "2279010"
  },
  {
    "text": "think that's also to other devices so unlike PCs and Linux devices some time",
    "start": "2279010",
    "end": "2285760"
  },
  {
    "text": "do not use all the mitigations and this needs to be fixed there was no reason for the differed chemical figuration to",
    "start": "2285760",
    "end": "2292240"
  },
  {
    "text": "be so light on litigations and lastly what we also think that should be taken",
    "start": "2292240",
    "end": "2300040"
  },
  {
    "text": "from this is that no device no security mechanisms today actually are looking at",
    "start": "2300040",
    "end": "2306520"
  },
  {
    "text": "bit of communications or other non why not Wi-Fi wireless protocols so any",
    "start": "2306520",
    "end": "2313060"
  },
  {
    "text": "attack that will check in be taking place on these protocols will be completely under the radar for these",
    "start": "2313060",
    "end": "2318280"
  },
  {
    "text": "mechanisms some so the new solutions needs to be put in place to monitor this",
    "start": "2318280",
    "end": "2323560"
  },
  {
    "text": "one these potentially vulnerable protocols as well okay so we also have",
    "start": "2323560",
    "end": "2330099"
  },
  {
    "text": "going to upload just now after the talk the exploit codes for both the echo and the gear and the white paper on the",
    "start": "2330099",
    "end": "2337329"
  },
  {
    "text": "exploits and there was also the previous technical parquetry we already published that covers all the vulnerabilities in",
    "start": "2337329",
    "end": "2344020"
  },
  {
    "text": "good one okay so we're going to attempt today ten were just now I hope that's",
    "start": "2344020",
    "end": "2349329"
  },
  {
    "text": "that works basically we'll want to start with one",
    "start": "2349329",
    "end": "2354730"
  },
  {
    "text": "of the echos not sure which what you're going to see in a minute so we're going to establish a Bluetooth connection to",
    "start": "2354730",
    "end": "2360099"
  },
  {
    "start": "2357000",
    "end": "2378000"
  },
  {
    "text": "it and then once we want our shellcode and we do we do a connect back shell",
    "start": "2360099",
    "end": "2366490"
  },
  {
    "text": "just over the Wi-Fi here so once the attack has is finished bluetooth is Nolan Nolan",
    "start": "2366490",
    "end": "2372510"
  },
  {
    "text": "you need and just over the internet this device can be controlled remotely so I",
    "start": "2372510",
    "end": "2379980"
  },
  {
    "start": "2378000",
    "end": "2464000"
  },
  {
    "text": "hope you can see there so on the left it's going to run the exploit script I'm holding my fingers you should do that",
    "start": "2379980",
    "end": "2385860"
  },
  {
    "text": "too so it sends a bunch of these commands",
    "start": "2385860",
    "end": "2391830"
  },
  {
    "text": "and now we have we have a shell so you",
    "start": "2391830",
    "end": "2397170"
  },
  {
    "text": "upload some scripts to run on the echo and we can see that we are running in",
    "start": "2397170",
    "end": "2402900"
  },
  {
    "text": "which this is the configuration of the",
    "start": "2402900",
    "end": "2408900"
  },
  {
    "text": "Bluetooth on the specific with an echo we can do a bunch of things with it",
    "start": "2408900",
    "end": "2416450"
  },
  {
    "text": "of course it's it's a Linux device and we can control its led those now it's",
    "start": "2416450",
    "end": "2425670"
  },
  {
    "text": "green anyone can see that yeah it's a",
    "start": "2425670",
    "end": "2435990"
  },
  {
    "text": "nigga's the assistant so we can make it say things also it's just for fun so I can say Alexa Alexa my",
    "start": "2435990",
    "end": "2451590"
  },
  {
    "text": "name is Alexa I have been own take me to your leader okay I will try to take you to your",
    "start": "2451590",
    "end": "2458610"
  },
  {
    "text": "leader and now we can also take this attack a step further so what if we want to",
    "start": "2458610",
    "end": "2466230"
  },
  {
    "start": "2464000",
    "end": "2503000"
  },
  {
    "text": "create some of a botnet of a Bluetooth controller did or do born and controlled",
    "start": "2466230",
    "end": "2472850"
  },
  {
    "text": "devices we can take over the Bluetooth Connect device controller of this Amazon",
    "start": "2472850",
    "end": "2478590"
  },
  {
    "text": "echo and use it to attack another Amazon echo the next one over there and then",
    "start": "2478590",
    "end": "2484260"
  },
  {
    "text": "connect them all to our botnet of control devices so the first one will connect back and then the next one will",
    "start": "2484260",
    "end": "2491130"
  },
  {
    "text": "connect back if we are the Internet and so forth and each advice can then attack another one so this we just waited this",
    "start": "2491130",
    "end": "2498000"
  },
  {
    "text": "for our fun but the health an area for this kind of",
    "start": "2498000",
    "end": "2503070"
  },
  {
    "start": "2503000",
    "end": "2575000"
  },
  {
    "text": "attack this is really just something put in you and I'm not sure it's going to",
    "start": "2503070",
    "end": "2509070"
  },
  {
    "text": "work but we're going to attempt it so on the right we can see they connect back shell for the second device if it will",
    "start": "2509070",
    "end": "2515220"
  },
  {
    "text": "actually connect okay so it has so now",
    "start": "2515220",
    "end": "2522480"
  },
  {
    "text": "we have control of the second echo on the right on the left to the first echo",
    "start": "2522480",
    "end": "2528590"
  },
  {
    "text": "so we have upload or scripts to it as well and we can see this is a different",
    "start": "2528590",
    "end": "2533940"
  },
  {
    "text": "device it has like the different MAC address we can also make it with",
    "start": "2533940",
    "end": "2541200"
  },
  {
    "text": "Christmas lights here those and they all",
    "start": "2541200",
    "end": "2549450"
  },
  {
    "text": "all together sing our Christmas Carol",
    "start": "2549450",
    "end": "2554150"
  },
  {
    "text": "[Applause] [Music]",
    "start": "2565540",
    "end": "2570610"
  },
  {
    "text": "and just to wrap it up we can also attack the gear a samsung gear it's",
    "start": "2570610",
    "end": "2577640"
  },
  {
    "start": "2575000",
    "end": "2673000"
  },
  {
    "text": "pretty small and I don't think we will actually see it from the back but it's",
    "start": "2577640",
    "end": "2582950"
  },
  {
    "text": "already here so the second actually is supposed to be here because of the",
    "start": "2582950",
    "end": "2589340"
  },
  {
    "text": "second echo will then attack the gear as well and like I said each one of them",
    "start": "2589340",
    "end": "2597560"
  },
  {
    "text": "once we won the exploit connects back via Wi-Fi to to ground laptop over here",
    "start": "2597560",
    "end": "2604240"
  },
  {
    "text": "so they don't have really to be over here once they are controlled so anybody",
    "start": "2604240",
    "end": "2610700"
  },
  {
    "text": "can just attack one device and that device can go around attacking other device and all of them connect back to",
    "start": "2610700",
    "end": "2616820"
  },
  {
    "text": "the to the button so on the right is the not use another shell okay so okay two",
    "start": "2616820",
    "end": "2625970"
  },
  {
    "text": "out of three but I can try gonna watch a tour started actually that's a poly bug",
    "start": "2625970",
    "end": "2643060"
  },
  {
    "text": "if you can see what the Gregg is trying to show is that this device has the",
    "start": "2665480",
    "end": "2670930"
  },
  {
    "text": "Wi-Fi the Wi-Fi MAC address that are adjacent so to find the MAC address is",
    "start": "2670930",
    "end": "2677780"
  },
  {
    "start": "2673000",
    "end": "2769000"
  },
  {
    "text": "pretty simple just by pinging the IP of the device we can have the hour per its",
    "start": "2677780",
    "end": "2683030"
  },
  {
    "text": "MAC address in the ARP cache so that to the 2492 0e not that one that's the MAC address",
    "start": "2683030",
    "end": "2689420"
  },
  {
    "text": "of the Wi-Fi and the Bluetooth they actually just one adjacent to it let's",
    "start": "2689420",
    "end": "2694579"
  },
  {
    "text": "try again check it I hope that works",
    "start": "2694579",
    "end": "2698380"
  },
  {
    "text": "number course",
    "start": "2711010",
    "end": "2714480"
  },
  {
    "text": "oh yes okay so we would not have any leads here or any audio so you need to",
    "start": "2720760",
    "end": "2729340"
  },
  {
    "text": "trust me this is actually being pawned right now but we can reboot it just to show it controlled without my hands",
    "start": "2729340",
    "end": "2737460"
  },
  {
    "text": "okay okay I think we have time for Q&A",
    "start": "2739920",
    "end": "2751890"
  },
  {
    "text": "if anyone wants to ask anything okay",
    "start": "2751890",
    "end": "2768930"
  },
  {
    "text": "hello thank you for a really good talk I just wanted to ask if there is any CVE",
    "start": "2768930",
    "end": "2774130"
  },
  {
    "start": "2769000",
    "end": "2808000"
  },
  {
    "text": "assigned already for those who Nura bilities and if it's being fixed if it's already fixed in the most recent kernel",
    "start": "2774130",
    "end": "2781030"
  },
  {
    "text": "version so um the RC vulnerability is already fixed in September this new",
    "start": "2781030",
    "end": "2787990"
  },
  {
    "text": "vulnerability of the information leak is actually just being fixed today like sir",
    "start": "2787990",
    "end": "2793900"
  },
  {
    "text": "in the city there was a CV it's about also going to be published on our website so it's really new the information like one",
    "start": "2793900",
    "end": "2801450"
  },
  {
    "text": "a great presentation I have a question about Android devices where the stack is",
    "start": "2807089",
    "end": "2815849"
  },
  {
    "start": "2808000",
    "end": "2910000"
  },
  {
    "text": "pushed a lot into user space and what your guys's thoughts are on that research so we we did of course the",
    "start": "2815849",
    "end": "2823890"
  },
  {
    "text": "expectation in Android as well for the blue born abilities and it does have a",
    "start": "2823890",
    "end": "2828960"
  },
  {
    "text": "better it doesn't one boot in Android devices but it also has a lot of a lot",
    "start": "2828960",
    "end": "2835079"
  },
  {
    "text": "of privileges able to stack in any advice but on Android as well it has a lot of features it needs to implement so",
    "start": "2835079",
    "end": "2841950"
  },
  {
    "text": "you have file sharing and you have the abilities connected mouse or a keyboard via bluetooth so all of these features",
    "start": "2841950",
    "end": "2849450"
  },
  {
    "text": "have privileges inside a stack so for an example we just showed and Andre the",
    "start": "2849450",
    "end": "2854969"
  },
  {
    "text": "ability to connect a mouse or a keyboard and then you can actually control the UI that's one having you to go but there",
    "start": "2854969",
    "end": "2861599"
  },
  {
    "text": "are also the file you have a lot of access to the file system so you do need another step to get huge in Android but",
    "start": "2861599",
    "end": "2869400"
  },
  {
    "text": "the attack surface is very very wide since you have all the privileges there as well so doing basic no no just",
    "start": "2869400",
    "end": "2877710"
  },
  {
    "text": "getting the images of the phone or something that's like from the start that's if isn't that you have but to",
    "start": "2877710",
    "end": "2884099"
  },
  {
    "text": "reach that actually you need to do not have step again and just to clarify it's",
    "start": "2884099",
    "end": "2889349"
  },
  {
    "text": "a different roller ability on Android it's not in the Altec a player it's in a different point on the protocol stack",
    "start": "2889349",
    "end": "2896539"
  },
  {
    "text": "however it's still a privilege process not route but still privileged enough to",
    "start": "2896539",
    "end": "2902400"
  },
  {
    "text": "to do lots of damage yeah anyone else so",
    "start": "2902400",
    "end": "2911849"
  },
  {
    "start": "2910000",
    "end": "3035000"
  },
  {
    "text": "thanks for a great talk for yourself I'd like to talk some more after the talk because I've got a lot of more questions",
    "start": "2911849",
    "end": "2917819"
  },
  {
    "text": "that I can answer right now I do a lot of industrial control systems I'm what",
    "start": "2917819",
    "end": "2923549"
  },
  {
    "text": "the author behind our scenario the attack on the power grid via solar",
    "start": "2923549",
    "end": "2928589"
  },
  {
    "text": "panels and those things work here over Ethernet or over Bluetooth do you have",
    "start": "2928589",
    "end": "2934799"
  },
  {
    "text": "any idea whether this will work on those devices well if if they are based on Linux if",
    "start": "2934799",
    "end": "2941690"
  },
  {
    "text": "they are running Linux and using the native little stack blues yes this will",
    "start": "2941690",
    "end": "2946850"
  },
  {
    "text": "affect them as I said in that start - there are 8-1 believes that we found in the affected Android Windows iOS and had",
    "start": "2946850",
    "end": "2953990"
  },
  {
    "text": "annexed X so but there are other stacks other than these not not such a",
    "start": "2953990",
    "end": "2960470"
  },
  {
    "text": "widespread but industrial devices might have four try this text I'm not sure but if they are based on one of these",
    "start": "2960470",
    "end": "2967880"
  },
  {
    "text": "systems they they will be affected other than that like I said the overall",
    "start": "2967880",
    "end": "2974090"
  },
  {
    "text": "feeling is that all implementations can be affected by similar vulnerabilities",
    "start": "2974090",
    "end": "2979540"
  },
  {
    "text": "because the stacks has not been audited and quite quite a long time and what",
    "start": "2979540",
    "end": "2986180"
  },
  {
    "text": "does affect every device that gives us a lot of is the complexity of the Bluetooth Park oh yeah so every stack",
    "start": "2986180",
    "end": "2991910"
  },
  {
    "text": "can be a valuable yeah because it's pretty complicated however you should",
    "start": "2991910",
    "end": "2998360"
  },
  {
    "text": "also know that there is a difference between a full Bluetooth stack and a stack that that only does Bluetooth",
    "start": "2998360",
    "end": "3003940"
  },
  {
    "text": "low-energy it's a pretty different protocol from the ground up and it has less features and thus is",
    "start": "3003940",
    "end": "3010750"
  },
  {
    "text": "more secure so if your device has only Bluetooth Low Energy it's probably okay",
    "start": "3010750",
    "end": "3016980"
  },
  {
    "text": "anyone",
    "start": "3022110",
    "end": "3025110"
  },
  {
    "start": "3035000",
    "end": "3123000"
  },
  {
    "text": "okay so you guys have got a limited window to explore the undocumented communication between the echo and the",
    "start": "3035540",
    "end": "3042140"
  },
  {
    "text": "mothership which a lot of people would like to understand because it's locked down to an Amazon certificate people",
    "start": "3042140",
    "end": "3048950"
  },
  {
    "text": "can't just kind of put a wire shark intercept or anything in there but with your exploit you could actually do that",
    "start": "3048950",
    "end": "3054440"
  },
  {
    "text": "have you got any plans to kind of look at that area can you come anyone the best part of the",
    "start": "3054440",
    "end": "3060050"
  },
  {
    "text": "kristin well because the all the communication that the echo makes back to Amazon is over SSL and it uses a cert",
    "start": "3060050",
    "end": "3066170"
  },
  {
    "text": "that's signed by Amazon so you can't just basically kind of intercept that a terrific but you guys could now that",
    "start": "3066170",
    "end": "3072620"
  },
  {
    "text": "you've got root on that device you could use that to figure it out a lot of people would like to know how that how",
    "start": "3072620",
    "end": "3078920"
  },
  {
    "text": "that works so exploit so you working to take it out and do with it but you",
    "start": "3078920",
    "end": "3085700"
  },
  {
    "text": "should know that Amazon echo it receives automatic updates and it's Albany Rob being updated I think that probably you",
    "start": "3085700",
    "end": "3093500"
  },
  {
    "text": "can and just buy a new echo that hasn't been updated yet and then you can use",
    "start": "3093500",
    "end": "3098510"
  },
  {
    "text": "this to get route in order to research it further yeah well this vol 4 which I",
    "start": "3098510",
    "end": "3104690"
  },
  {
    "text": "work at the expert that is gonna be on our github will work on the previous",
    "start": "3104690",
    "end": "3110120"
  },
  {
    "text": "version of the echo the previous software version so if you can somehow revert that or you'll get fruit on the",
    "start": "3110120",
    "end": "3117170"
  },
  {
    "text": "Iraq",
    "start": "3117170",
    "end": "3119380"
  },
  {
    "start": "3123000",
    "end": "3241000"
  },
  {
    "text": "so can I ask a your solution for preventing for the for the problems like this from British imitation I mean for",
    "start": "3123329",
    "end": "3130569"
  },
  {
    "text": "example we can make a better implication for British tax or like on the",
    "start": "3130569",
    "end": "3136210"
  },
  {
    "text": "presentation adding a some kind of a special secure mechanism on Terry Mike Rinder",
    "start": "3136210",
    "end": "3141730"
  },
  {
    "text": "British tax right on British stack on like a as like a specific SELinux for",
    "start": "3141730",
    "end": "3148480"
  },
  {
    "text": "purchase this name but for example so what is your solution",
    "start": "3148480",
    "end": "3153630"
  },
  {
    "text": "basically there are two things first of which is um just deals barely unless you",
    "start": "3153660",
    "end": "3161800"
  },
  {
    "text": "need the full second it's the concept of lowest privilege okay say it showed",
    "start": "3161800",
    "end": "3168400"
  },
  {
    "text": "really well on Android and here on Linux as well but on Android there is a single demon that has all the privileges of",
    "start": "3168400",
    "end": "3174040"
  },
  {
    "text": "everything Lotus death so the same demon can be an HID keyboard it can look at",
    "start": "3174040",
    "end": "3179319"
  },
  {
    "text": "your pictures it can do like attach network interfaces crazy stuff right but",
    "start": "3179319",
    "end": "3184960"
  },
  {
    "text": "there is no reason that a vulnerability only one of these things will allow you to control all of these privileges so it",
    "start": "3184960",
    "end": "3191050"
  },
  {
    "text": "shouldn't be one demon it shouldn't be in the kernel it should be many separated low privileged processes and",
    "start": "3191050",
    "end": "3197680"
  },
  {
    "text": "the only there particular thing I would add to that is that we are very",
    "start": "3197680",
    "end": "3204390"
  },
  {
    "text": "accustomed to concept of firewalls in TCP connections in the IP connections",
    "start": "3204390",
    "end": "3209710"
  },
  {
    "text": "but there are no such firewalls in Bluetooth connections so the services",
    "start": "3209710",
    "end": "3214930"
  },
  {
    "text": "are always listening and there is no way to stop them from listening or to limit their connections and also I think",
    "start": "3214930",
    "end": "3222660"
  },
  {
    "text": "solutions that are looking at the protocols on the side just analyzing the data can also find very variable and can",
    "start": "3222660",
    "end": "3231430"
  },
  {
    "text": "also potentially block and threats there from from not not inside your device but",
    "start": "3231430",
    "end": "3236470"
  },
  {
    "text": "outside of the devices as well questions",
    "start": "3236470",
    "end": "3242319"
  },
  {
    "start": "3241000",
    "end": "3315000"
  },
  {
    "text": "please would you say that your the way you build your exploit with the fact all you CPU architectures equally",
    "start": "3242319",
    "end": "3250859"
  },
  {
    "text": "I think each exploit usually needs to be adjusted adapted a little bit it won't",
    "start": "3252910",
    "end": "3260050"
  },
  {
    "text": "be automatically even the Amazon echo if you go to a different humor version you",
    "start": "3260050",
    "end": "3265570"
  },
  {
    "text": "need to adjust some of the variables but our our job was not to make this a",
    "start": "3265570",
    "end": "3270700"
  },
  {
    "text": "weaponized nation grades an exploit although sometimes II love that but more",
    "start": "3270700",
    "end": "3279460"
  },
  {
    "text": "like to show the proof concept of that so any actor that wishes to take",
    "start": "3279460",
    "end": "3285880"
  },
  {
    "text": "advantage of the small abilities in the in the highest manner and then you can",
    "start": "3285880",
    "end": "3292390"
  },
  {
    "text": "do that you can mix exploit generic or just customize it to a very wide variety",
    "start": "3292390",
    "end": "3299950"
  },
  {
    "text": "of devices it's possible it just needs to be customized yeah and the second",
    "start": "3299950",
    "end": "3306190"
  },
  {
    "text": "question you mentioned monitoring would you have any suggestion how you monitor",
    "start": "3306190",
    "end": "3311590"
  },
  {
    "text": "mobile devices at all times I'm thinking",
    "start": "3311590",
    "end": "3317320"
  },
  {
    "start": "3315000",
    "end": "3447000"
  },
  {
    "text": "thank you you know your your phone is essentially a mobile device you carry it around how would you monitor that and so",
    "start": "3317320",
    "end": "3325540"
  },
  {
    "text": "there's a number of ways there is the the way that probably think about it",
    "start": "3325540",
    "end": "3330820"
  },
  {
    "text": "just spread hardware around the organization that monitors Wi-Fi and Bluetooth such things exist for Wi-Fi",
    "start": "3330820",
    "end": "3337960"
  },
  {
    "text": "thing they're called they're wireless safe yes right mmm so they do kind of this thing and so if you monitor all",
    "start": "3337960",
    "end": "3346780"
  },
  {
    "text": "these protocols that your devices exposed to the air then you'll have at",
    "start": "3346780",
    "end": "3354550"
  },
  {
    "text": "least a window into seeing what's actually going on and be able to control",
    "start": "3354550",
    "end": "3360450"
  },
  {
    "text": "but our company also does specifically monitors those communications as well",
    "start": "3360450",
    "end": "3367980"
  },
  {
    "text": "either via specific hardware that we deploy or with some integration to",
    "start": "3367980",
    "end": "3374380"
  },
  {
    "text": "existing infrastructure in you know patronization",
    "start": "3374380",
    "end": "3378390"
  },
  {
    "text": "hi thanks very much absolutely fascinating presentation um I don't suppose I can ask a favor would you be",
    "start": "3383999",
    "end": "3389950"
  },
  {
    "text": "able to put the URLs for your white paper back up because I didn't get them down in time which one I am so not okay",
    "start": "3389950",
    "end": "3404940"
  },
  {
    "text": "yeah also here there was also a white paper and a presentation video in",
    "start": "3404940",
    "end": "3411999"
  },
  {
    "text": "another venue about Android a white paper also exists if you go to our",
    "start": "3411999",
    "end": "3419049"
  },
  {
    "text": "github you'll find all of this there next tomorrow or so yeah oh it's",
    "start": "3419049",
    "end": "3426220"
  },
  {
    "text": "stupidly blackhat back that will come later",
    "start": "3426220",
    "end": "3430979"
  },
  {
    "text": "okay well thank you very much",
    "start": "3438519",
    "end": "3443680"
  },
  {
    "text": "[Music] [Applause]",
    "start": "3443680",
    "end": "3449170"
  }
]