[
  {
    "text": "um I'm just going to go ahead and get right into it there's this great debate that's been",
    "start": "480",
    "end": "6520"
  },
  {
    "text": "going on for maybe 40 years now about the nature of privacy and surveillance",
    "start": "6520",
    "end": "13679"
  },
  {
    "text": "in the Telecommunications infrastructure of the future uh and really whether we should build facilities for privacy or",
    "start": "13679",
    "end": "20320"
  },
  {
    "text": "facilities for surveillance into that infrastructure and how those things should work it's a political debate to",
    "start": "20320",
    "end": "26359"
  },
  {
    "text": "be sure but it's also to some respect a technical debate um in that people bring",
    "start": "26359",
    "end": "32238"
  },
  {
    "text": "certain technical assumptions to their policy views on the issue and it's for us uh as technical professionals to",
    "start": "32239",
    "end": "39559"
  },
  {
    "text": "evaluate the validity of those assumptions like any good debate there",
    "start": "39559",
    "end": "46440"
  },
  {
    "text": "are two sides and so as an example of one side of the debate I present the ietf policy on wiretapping was published",
    "start": "46440",
    "end": "54280"
  },
  {
    "text": "in the year 2000 in an RFC it says that the ietf will not",
    "start": "54280",
    "end": "59320"
  },
  {
    "text": "design uh wiretapping requirements into their protocols there are a couple different reasons for this one reason is",
    "start": "59320",
    "end": "66119"
  },
  {
    "text": "that the ITF is an international body and it can't sort of be responsive to the rules of every single country on the",
    "start": "66119",
    "end": "71479"
  },
  {
    "text": "planet uh another reason is that the ITF thinks that wire tapping is either easy",
    "start": "71479",
    "end": "77439"
  },
  {
    "text": "or it's impossible because you're either using encryption or you're not and they refer to RFC 1984 which is sort of",
    "start": "77439",
    "end": "84880"
  },
  {
    "text": "ironically numbered uh in which they argue that everything ought to be encrypted and so therefore why typing",
    "start": "84880",
    "end": "90280"
  },
  {
    "text": "ought to be impossible uh they also say that the internet should be free from security loopholes and they express the concern",
    "start": "90280",
    "end": "97759"
  },
  {
    "text": "that interfaces which could be used for wiretapping might be might fall into the wrong hands might be subject to",
    "start": "97759",
    "end": "103759"
  },
  {
    "text": "unauthorized use uh on the other hand they say that if",
    "start": "103759",
    "end": "109560"
  },
  {
    "text": "you're going to make an internet wiretapping infrastructure you ought to publish it and that I think this um",
    "start": "109560",
    "end": "116079"
  },
  {
    "text": "comment will resonate very well with this community uh thef believes that the publication of lawful intercept",
    "start": "116079",
    "end": "122240"
  },
  {
    "text": "mechanisms and the publication of known weaknesses in those mechanisms is a good thing we need to have an open dialogue",
    "start": "122240",
    "end": "129239"
  },
  {
    "text": "and peer rview uh and in keeping with this uh policy Cisco uh published an RFC",
    "start": "129239",
    "end": "135519"
  },
  {
    "text": "which describes their architecture for lawful Intercept in the internet uh as far as I know Cisco is the only company",
    "start": "135519",
    "end": "142160"
  },
  {
    "text": "that's ever actually published their architecture in an ITF",
    "start": "142160",
    "end": "146920"
  },
  {
    "text": "RFC so why did Cisco make uh an architecture for lawful Intercept in the internet",
    "start": "147440",
    "end": "153680"
  },
  {
    "text": "um so so as an example of the other side of the debate I present the communications assistance for Law",
    "start": "153680",
    "end": "159239"
  },
  {
    "text": "Enforcement Act it was passed uh in 1994 uh and it requires",
    "start": "159239",
    "end": "164440"
  },
  {
    "text": "telecommunications companies to provide interfaces that law enforcement can use to access content on their networks uh",
    "start": "164440",
    "end": "171640"
  },
  {
    "text": "originally there was an exception in this law that was built for Information Services and people believed that that",
    "start": "171640",
    "end": "177760"
  },
  {
    "text": "Exempted the internet from the law and the law only only applied to voice Communications however in 2005 the FCC",
    "start": "177760",
    "end": "184640"
  },
  {
    "text": "ruled that broadband internet providers are covered by Kia and so they have to provide",
    "start": "184640",
    "end": "189879"
  },
  {
    "text": "access the Cisco architecture for lawful intercept predated that ruling uh but there are other motivators uh there were",
    "start": "189879",
    "end": "196560"
  },
  {
    "text": "laws in Europe that were similar to Kalia that applied to the internet before 2005 um but also service",
    "start": "196560",
    "end": "203799"
  },
  {
    "text": "providers have law enforcement people coming into their their office they want access to the network they've got to",
    "start": "203799",
    "end": "209480"
  },
  {
    "text": "provide the access somehow um and they want to do it in a way that is not disruptive to their Network operation so",
    "start": "209480",
    "end": "214799"
  },
  {
    "text": "having some sort of standard interface for it is something that service providers might deploy even if they're not required",
    "start": "214799",
    "end": "220959"
  },
  {
    "text": "to uh so let's talk about this this Cisco architecture for lawful intercept",
    "start": "220959",
    "end": "226840"
  },
  {
    "text": "because they were nice enough to publish it and were able to uh to peer review it uh I first found these rfc's uh back in",
    "start": "226840",
    "end": "235239"
  },
  {
    "text": "2006 like in the winter time and uh I I read them and I said my first reaction",
    "start": "235239",
    "end": "240680"
  },
  {
    "text": "was wow I can't believe I'm actually allowed to read this stuff I can't believe they published this you know I I",
    "start": "240680",
    "end": "245799"
  },
  {
    "text": "it was it was kind of like you know I was seeing the other side or something uh and so I I after I got over my",
    "start": "245799",
    "end": "251360"
  },
  {
    "text": "initial excitement about having found it um you know I said I I have a problems with this design I don't think that this",
    "start": "251360",
    "end": "257840"
  },
  {
    "text": "um enforces its security uh requirements the way that I would want them enforced uh but at the time I kind of felt like",
    "start": "257840",
    "end": "263800"
  },
  {
    "text": "no one would listen to me about it so I put it on a shelf I should have gone and audited SNMP code",
    "start": "263800",
    "end": "270240"
  },
  {
    "text": "um and I didn't but there was there was a significant implementation flaw in SNMP uh that affected this",
    "start": "270240",
    "end": "277680"
  },
  {
    "text": "infrastructure uh and that was found by somebody else was disclosed in the summer of 2008 um and it allows uh",
    "start": "277680",
    "end": "284759"
  },
  {
    "text": "someone to access an snmpv3 interface without a password uh so given that",
    "start": "284759",
    "end": "290639"
  },
  {
    "text": "these uh I'll get into the details but this lawful intercept architecture is based on snmpv3 that vulnerability has a",
    "start": "290639",
    "end": "297000"
  },
  {
    "text": "big impact uh you know to to uh to people who are running this this architecture uh I wrote all this stuff",
    "start": "297000",
    "end": "303639"
  },
  {
    "text": "up in in so when I saw that bug I said this is it I've got to I've got to put these two things together and I wrote up",
    "start": "303639",
    "end": "309360"
  },
  {
    "text": "a a discussion about this this architecture and that vulnerability and I sent it to Cisco uh maybe in December",
    "start": "309360",
    "end": "315039"
  },
  {
    "text": "of 2018 and then I got promoted and I got really busy at work uh and I I just",
    "start": "315039",
    "end": "320720"
  },
  {
    "text": "did not have time to do any interesting technical things anymore and so um I submitted this thing as a black hat talk",
    "start": "320720",
    "end": "327280"
  },
  {
    "text": "because I knew that if I had a hard deadline I would have force myself to get everything publication ready and actually come and and discuss it so U I",
    "start": "327280",
    "end": "334560"
  },
  {
    "text": "want to thank black hat for accepting this talk and letting me come here and discuss this because I think it's important and I think if this talk",
    "start": "334560",
    "end": "340479"
  },
  {
    "text": "hadn't been accepted a lot of this material would never have seen the light of day so thank you black hat um this uh",
    "start": "340479",
    "end": "347240"
  },
  {
    "text": "is a the basic overview of the Cisco architecture for lawful intercept this leite ASI chart comes from the RFC",
    "start": "347240",
    "end": "354199"
  },
  {
    "text": "itself uh there's a couple of important things to understand about this architecture the first is that um so so",
    "start": "354199",
    "end": "362919"
  },
  {
    "text": "this is all based on uh stuff that was published by the European technical standards Institute Etsy uh that they",
    "start": "362919",
    "end": "369440"
  },
  {
    "text": "sort of Define this General overall architecture for lawful intercept and the Cisco architecture fits in that",
    "start": "369440",
    "end": "374560"
  },
  {
    "text": "overall model so they Define a lot of these interfaces and the like uh I don't know if you're supposed to be able to",
    "start": "374560",
    "end": "379840"
  },
  {
    "text": "read the Etsy documentation but it's on cryptome me.org or Cryptor depending on how you like to pronounce that uh the um",
    "start": "379840",
    "end": "388639"
  },
  {
    "text": "the other thing that's so so what's important there is that first of all there's there's a bunch of companies",
    "start": "388639",
    "end": "394000"
  },
  {
    "text": "that that support this Cisco architecture not just Cisco but in addition there's this whole there's these whole other groups of other",
    "start": "394000",
    "end": "400520"
  },
  {
    "text": "architectures for lawful intercept that are implmented by other companies using other technology that doesn't it's not",
    "start": "400520",
    "end": "406720"
  },
  {
    "text": "interoperable with the Cisco architecture but it has the same overall uh uh it has the same overall",
    "start": "406720",
    "end": "412479"
  },
  {
    "text": "operational architecture so um this this is sort of generally how lawful intercept Works in all kinds of",
    "start": "412479",
    "end": "418280"
  },
  {
    "text": "different contexts um the um the other thing to uh uh the",
    "start": "418280",
    "end": "423440"
  },
  {
    "text": "other thing to say about this is that it's not just a computer architecture some of these things in this diagram are computers and some of them are groups of",
    "start": "423440",
    "end": "429680"
  },
  {
    "text": "people uh it starts with the law enforcement agency which is a group of people uh and they decide that they want",
    "start": "429680",
    "end": "435000"
  },
  {
    "text": "to uh wiretap a network uh and so they they get authorization to do that and they go talk to this lawful intercept",
    "start": "435000",
    "end": "441319"
  },
  {
    "text": "Administration function that is a group of people in the ISP uh who um you know",
    "start": "441319",
    "end": "446879"
  },
  {
    "text": "have there's some lawyers there and there's some technical people uh and they they validate that the law the law",
    "start": "446879",
    "end": "452800"
  },
  {
    "text": "enforcement agency has the authority to access the content they're asking for and then they use this computer called a",
    "start": "452800",
    "end": "458560"
  },
  {
    "text": "mediation device to provision the wir tap according to the authorization that the lawful the law enforcement agency",
    "start": "458560",
    "end": "465120"
  },
  {
    "text": "has uh if you're an ISP you can Outsource this lawful intercept",
    "start": "465120",
    "end": "470360"
  },
  {
    "text": "Administration function to a a consulting company uh and they'll bring in their lawyers that vet uh the lawful",
    "start": "470360",
    "end": "477000"
  },
  {
    "text": "authorization that the law enforcement agencies have and they have technical professionals that understand how to operate all this equipment and get it",
    "start": "477000",
    "end": "483039"
  },
  {
    "text": "running on your network and they'll just take care of it for you uh and so this is just a collage of marketing material",
    "start": "483039",
    "end": "488840"
  },
  {
    "text": "from different companies that offer that um so back to this architecture the uh",
    "start": "488840",
    "end": "497720"
  },
  {
    "text": "the mediation device is sort of the heart of this lawful intercept system uh it's a computer that is used by the",
    "start": "497720",
    "end": "504280"
  },
  {
    "text": "administration to provision the tap and it sends interception requests out to the devices on the network that actually",
    "start": "504280",
    "end": "510840"
  },
  {
    "text": "perform the surveillance those devices are called intercept access points uh and there's two in this diagram I'll",
    "start": "510840",
    "end": "516479"
  },
  {
    "text": "talk about them a little bit more later uh but an intercept access point will get this interception request it'll",
    "start": "516479",
    "end": "521839"
  },
  {
    "text": "perform the surveillance and take the content that was asked to collect and send it back to the mediation device",
    "start": "521839",
    "end": "527600"
  },
  {
    "text": "once the mediation device gets the content it reformats it maybe and sends it on to the law enforcement",
    "start": "527600",
    "end": "534320"
  },
  {
    "text": "agency so there are a bunch of different companies that make mediation devices that interoperate with syst routers so",
    "start": "534320",
    "end": "540519"
  },
  {
    "text": "like I said this is there's this inner Galaxy of different companies that all support this same protocol",
    "start": "540519",
    "end": "547120"
  },
  {
    "text": "uh some of the marketing material on these companies websites is interesting to look at if you're if you're",
    "start": "547120",
    "end": "552320"
  },
  {
    "text": "interested in the subject matter uh this thing uh this picture here comes from var's website uh in addition to the",
    "start": "552320",
    "end": "559320"
  },
  {
    "text": "products that varant makes for lawful intercept which is what we're talking about today they also have a different product group called mass communication",
    "start": "559320",
    "end": "566279"
  },
  {
    "text": "surveillance Solutions which has its own set of marketing material and I found it very interesting so uh maybe you would",
    "start": "566279",
    "end": "572320"
  },
  {
    "text": "as well um but what's important to understand is that Cisco isn't the only company that supports this",
    "start": "572320",
    "end": "577680"
  },
  {
    "text": "architecture uh so there's two kinds of iaps in this network diagram one's",
    "start": "577680",
    "end": "583040"
  },
  {
    "text": "called an II AP and the other one's called a content iip and this uh relates",
    "start": "583040",
    "end": "588399"
  },
  {
    "text": "to the structure of uh at least in the United States how the law Works uh around wiretapping um traditionally the",
    "start": "588399",
    "end": "596240"
  },
  {
    "text": "kind of communications infrastructure people had was the postal Serv and in the Postal Service you have a",
    "start": "596240",
    "end": "601959"
  },
  {
    "text": "letter and it's in an envelope and there's an address on the outside and the way that the law traditionally dealt",
    "start": "601959",
    "end": "607920"
  },
  {
    "text": "with this is uh uh the police if they wanted to steam open your letter and read the read the content of it they",
    "start": "607920",
    "end": "614560"
  },
  {
    "text": "would have to get a warrant uh but if they wanted to see the addresses that were printed on the outside of your letter they don't necessarily need a",
    "start": "614560",
    "end": "620560"
  },
  {
    "text": "warrant uh because your post your uh Postman knows who you're sending and receiving mail from so it's not as",
    "start": "620560",
    "end": "626240"
  },
  {
    "text": "private it's not considered as private as the contents inside inside the envelope and because you know Postal",
    "start": "626240",
    "end": "632760"
  },
  {
    "text": "Services have been around for a long time and our law our legal system was sort of built up around that dichotomy",
    "start": "632760",
    "end": "638000"
  },
  {
    "text": "um there's been an attempt both by the court system and the legislatures to maintain that dichotomy and new",
    "start": "638000",
    "end": "643320"
  },
  {
    "text": "technologies even if it doesn't necessarily make as much sense as it used to so an iri AP is is designed for",
    "start": "643320",
    "end": "651399"
  },
  {
    "text": "situations where they don't have a warrant uh maybe they have ad administrative subpoena uh and they're",
    "start": "651399",
    "end": "657240"
  },
  {
    "text": "they're looking to just access outing information to addresses from addresses",
    "start": "657240",
    "end": "662320"
  },
  {
    "text": "uh uh SMTP headers stuff like that stuff that is equivalent to the outside of the envelope um a Content IAP is a device",
    "start": "662320",
    "end": "670240"
  },
  {
    "text": "that that can collect the contents of the envelope all of the communications information uh Cisco routers are content",
    "start": "670240",
    "end": "677600"
  },
  {
    "text": "iaps I don't believe that Cisco routers have an iri IAP interface so the way that uh the way",
    "start": "677600",
    "end": "685440"
  },
  {
    "text": "that the mediation device Provisions uh the Cisco router to collect content is",
    "start": "685440",
    "end": "690920"
  },
  {
    "text": "with this interception request it's an snmpv3 request uh and it's one single",
    "start": "690920",
    "end": "697279"
  },
  {
    "text": "UDP packet which is a pretty important fact uh and it specifies you know what",
    "start": "697279",
    "end": "702600"
  },
  {
    "text": "information uh the the law enforcement agency would like to collect from the network you can specify ranges of source",
    "start": "702600",
    "end": "708720"
  },
  {
    "text": "and destination addresses source and destination port numbers um you can include uh uh other things like MLS tags",
    "start": "708720",
    "end": "716760"
  },
  {
    "text": "or Mac addresses um you know whatever specific information relates to what you want to collect uh and you also tell the",
    "start": "716760",
    "end": "723800"
  },
  {
    "text": "router where to send the stuff once it's collected uh you can you set the destination address and the port uh and",
    "start": "723800",
    "end": "730839"
  },
  {
    "text": "what transport you want to use to send the the content there and I'll talk more about that too",
    "start": "730839",
    "end": "736519"
  },
  {
    "text": "so that's the uh basic overview of how this lawful intercept architecture Works",
    "start": "736519",
    "end": "742120"
  },
  {
    "text": "let's stop and consider what the security concerns are associated with building something like this",
    "start": "742120",
    "end": "749519"
  },
  {
    "text": "the first thing that we need to think about is preventing the subject from discovering the surveillance and if you",
    "start": "749800",
    "end": "755279"
  },
  {
    "text": "read Cisco's RFC they talk about how they don't want to have a device that shows up in a trace route so that you",
    "start": "755279",
    "end": "760800"
  },
  {
    "text": "know that you're getting surveilled right they think about that um another thing you want to do is prevent the",
    "start": "760800",
    "end": "766279"
  },
  {
    "text": "subject from manipulating the surveillance either by evading it transmitting content that wasn't",
    "start": "766279",
    "end": "771360"
  },
  {
    "text": "collected That was supposed to be or by confusing it by inducing the collection",
    "start": "771360",
    "end": "776800"
  },
  {
    "text": "of information that was not transmitted uh and and so Matt Blaze has been doing",
    "start": "776800",
    "end": "782440"
  },
  {
    "text": "some interesting research in this area u based on some work that Thomas pachek uh contributed to in the late 90s um and",
    "start": "782440",
    "end": "789360"
  },
  {
    "text": "Matt Blaise calls this the eavesdroppers dilemma what do you do with a packet that has a bad check sum either you",
    "start": "789360",
    "end": "794920"
  },
  {
    "text": "collect it and you give it to the law enforcement agency and then it you know so the the attacker can inject all kinds",
    "start": "794920",
    "end": "801079"
  },
  {
    "text": "of bad check sum packets that are confused the law enforcement agency in terms of what they're seeing uh but are not actually received at the other end",
    "start": "801079",
    "end": "807839"
  },
  {
    "text": "or you ignore it and you don't show it to the law enforcement agency in which case the bad guy can reconfigure his",
    "start": "807839",
    "end": "813839"
  },
  {
    "text": "computer on the other end to accept packets with bad check sums and he can communicate without getting surveilled and it turns out that this problem is",
    "start": "813839",
    "end": "820040"
  },
  {
    "text": "actually pretty complicated in practice and there's a bunch of research that you can go read about it I don't talk about it any further in this talk uh the other",
    "start": "820040",
    "end": "827920"
  },
  {
    "text": "security concern that you have to consider is protecting the interface from unauthorized use there are two",
    "start": "827920",
    "end": "834000"
  },
  {
    "text": "kinds of unauthorized use that you need to protect against one is preventing the provision of unauthorized wire Taps",
    "start": "834000",
    "end": "839839"
  },
  {
    "text": "preventing people who don't have any lawful authority to perform wire Taps from using the thing the other uh thing",
    "start": "839839",
    "end": "845880"
  },
  {
    "text": "you need to do is prevent authorized wire Taps from collecting information that they weren't authorized to collect",
    "start": "845880",
    "end": "851839"
  },
  {
    "text": "this is called minimization uh basically the idea is that we only collect what we were supposed to collect um and I'm",
    "start": "851839",
    "end": "858680"
  },
  {
    "text": "going to get back to minimization later but I want to put a question in your mind and that is where should",
    "start": "858680",
    "end": "864040"
  },
  {
    "text": "minimization happen in this infrastructure should it happen in the router um or should the router just",
    "start": "864040",
    "end": "869839"
  },
  {
    "text": "collect all the content that's going across and send it all to the mediation device and the mediation device can sort",
    "start": "869839",
    "end": "875320"
  },
  {
    "text": "it out or maybe the router should take all the content on the internet and or on the network and send it to the law",
    "start": "875320",
    "end": "881680"
  },
  {
    "text": "enforcement agency and let the law enforcement agency sort out what they want and what they don't want um that",
    "start": "881680",
    "end": "886839"
  },
  {
    "text": "architectural question is uh at the heart of some of the uh technical debate that's going on about how to do this",
    "start": "886839",
    "end": "892680"
  },
  {
    "text": "properly and we'll come back to it so a friend of mine said that I needed to have more Network diagrams",
    "start": "892680",
    "end": "899360"
  },
  {
    "text": "talk so I I fired up Vio and I made a few um this is a typical service",
    "start": "899360",
    "end": "904600"
  },
  {
    "text": "provider Network this service provider cloud is going to have a bunch of core routers in it it's going to have Edge routers I brought out one Edge router uh",
    "start": "904600",
    "end": "912160"
  },
  {
    "text": "on the side there at the bottom and he's providing internet access to a couple of customers down there one of whom is our",
    "start": "912160",
    "end": "917560"
  },
  {
    "text": "suspected drug dealer or something um somewhere in the service provider Network there is a uh there's a service",
    "start": "917560",
    "end": "924759"
  },
  {
    "text": "provider management Network which is where all the computers that the service provider uses to run the Network reside",
    "start": "924759",
    "end": "930079"
  },
  {
    "text": "hopefully it's firewalled um and in there probably is your mediation device uh which is where these wire Taps are",
    "start": "930079",
    "end": "936199"
  },
  {
    "text": "provisioned from so this is how the traffic flows in or this is how the",
    "start": "936199",
    "end": "941399"
  },
  {
    "text": "traffic is supposed to flow when things are working properly uh the mediation device sends this one single packet",
    "start": "941399",
    "end": "947160"
  },
  {
    "text": "intercept request through the network to the router and the router sends the content back to the mediation",
    "start": "947160",
    "end": "953920"
  },
  {
    "text": "device this is um the attack that I'm I'm proposing if you will uh in this",
    "start": "953920",
    "end": "959560"
  },
  {
    "text": "talk uh an attacker out on the internet sends an intercept request to the router and the router sends the content he",
    "start": "959560",
    "end": "966639"
  },
  {
    "text": "asked for back over the internet to to the attacker this is an idealistic situation and I'll give you a more",
    "start": "966639",
    "end": "971920"
  },
  {
    "text": "realistic Network map later so what the attacker has to do to",
    "start": "971920",
    "end": "977240"
  },
  {
    "text": "pull that off is send an unauthorized interception request it's a single UDP packet but in order to generate it he",
    "start": "977240",
    "end": "983920"
  },
  {
    "text": "has to have a few pieces of information first of all he has to know the correct user name and password for the snmpv3",
    "start": "983920",
    "end": "991440"
  },
  {
    "text": "interface on the router of course if he's exploiting that vulnerability that was disclosed last summer he doesn't",
    "start": "991440",
    "end": "997040"
  },
  {
    "text": "need to know the password he just needs the username uh he also needs to know the correct engine ID engine boots and",
    "start": "997040",
    "end": "1003920"
  },
  {
    "text": "engine time values these are values that are used in snmpv3 to prevent the replay",
    "start": "1003920",
    "end": "1010399"
  },
  {
    "text": "of authenticated transactions um basically you you're you use this hmac",
    "start": "1010399",
    "end": "1016079"
  },
  {
    "text": "which I'll talk about a little bit more this message digest and and pv3 to authenticate messages um and and they",
    "start": "1016079",
    "end": "1022000"
  },
  {
    "text": "want to prevent someone who's surveilling the network from replaying messages that were sent that were properly authenticated uh so they they",
    "start": "1022000",
    "end": "1028520"
  },
  {
    "text": "make sure that each transaction is unique uh using some numbers that the router passes out and they're not secret",
    "start": "1028520",
    "end": "1035120"
  },
  {
    "text": "numbers you can get them from the router without an username or password it will hand them out to anybody um and their",
    "start": "1035120",
    "end": "1041160"
  },
  {
    "text": "only purpose is to prevent the replay of of of transactions that were authenticated so it's easy to get them",
    "start": "1041160",
    "end": "1047959"
  },
  {
    "text": "uh once the attacker has gotten the router to accept an unauthorized intercept request",
    "start": "1047959",
    "end": "1054600"
  },
  {
    "text": "the router he can send the traffic that he's collecting anywhere on the global internet um one of the things people say",
    "start": "1054600",
    "end": "1061520"
  },
  {
    "text": "is well what if they have an access list the um Cisco routers do not enforce access lists on content that emanates",
    "start": "1061520",
    "end": "1068840"
  },
  {
    "text": "from the router itself try it doesn't work uh so you can't specify an access",
    "start": "1068840",
    "end": "1074480"
  },
  {
    "text": "list that filters outbound traffic from the router currently the way it's implemented",
    "start": "1074480",
    "end": "1079720"
  },
  {
    "text": "so there are six uh vulnerabilities um that or weaknesses in the design of this",
    "start": "1079720",
    "end": "1086039"
  },
  {
    "text": "protocol or in the implementation of the protocol uh that I think uh contribute to the reality that this attack that I'm",
    "start": "1086039",
    "end": "1093640"
  },
  {
    "text": "talking about could be could be practical on a real world Network today um and I'm going to go through each one",
    "start": "1093640",
    "end": "1099960"
  },
  {
    "text": "of these vulnerabilities and talk about it and they you know each one individually probably isn't a big deal",
    "start": "1099960",
    "end": "1105520"
  },
  {
    "text": "but when you add them all up together uh the situation uh you know is is fairly weak in practice um depending upon how",
    "start": "1105520",
    "end": "1112080"
  },
  {
    "text": "the service provider deployed the stuff um so the first thing is that it's really easy to Brute Force SNMP V3",
    "start": "1112080",
    "end": "1119320"
  },
  {
    "text": "usernames and passwords because SNMP V3 is very helpful to you if you're trying to do that um if you send it a packet",
    "start": "1119320",
    "end": "1125760"
  },
  {
    "text": "and it rejects it because it wasn't properly authenticated it tells you why you used a bad username you had the",
    "start": "1125760",
    "end": "1132039"
  },
  {
    "text": "wrong password you Ed the wrong engine time or your thing didn't decrypt right um you get all this verbose information",
    "start": "1132039",
    "end": "1139320"
  },
  {
    "text": "this is a classic security mistake that has been made in all kinds of different protocols um and it's actually built",
    "start": "1139320",
    "end": "1144760"
  },
  {
    "text": "into the snmpv3 standard uh so the attacker can try different usernames until he gets a good one and it will",
    "start": "1144760",
    "end": "1151080"
  },
  {
    "text": "tell him when he got one and then he can try different passwords for that username until he gets a good one um and",
    "start": "1151080",
    "end": "1156400"
  },
  {
    "text": "so the amount of guessing that he has to do is constrain but you don't have to brute",
    "start": "1156400",
    "end": "1161600"
  },
  {
    "text": "Forest passwords as I've mentioned a couple times so far in this talk uh if your router is vulnerable to this",
    "start": "1161600",
    "end": "1166880"
  },
  {
    "text": "particular vulnerability uh so as I mentioned these snmpv3 messages are authenticated with a message digest and",
    "start": "1166880",
    "end": "1174240"
  },
  {
    "text": "I'm oversimplifying here a little bit but the message digest is essentially a cryptographic hash of the content of the",
    "start": "1174240",
    "end": "1180280"
  },
  {
    "text": "message combined with a secret uh and so the way that standard is specified you",
    "start": "1180280",
    "end": "1185400"
  },
  {
    "text": "take the first the client takes the first 12 bytes of this cryptographic hash it puts it in the snmpv3 request",
    "start": "1185400",
    "end": "1191799"
  },
  {
    "text": "and sends it on to the router the router gets the request and then it performs its own cryptographic has calculation",
    "start": "1191799",
    "end": "1198200"
  },
  {
    "text": "and then it Compares that result with what was sent in the packet the router is supposed to throw the packet away if",
    "start": "1198200",
    "end": "1204720"
  },
  {
    "text": "it doesn't have exactly a 12 byte hash in it but for some reason a lot of people didn't Implement that and uh uh",
    "start": "1204720",
    "end": "1211799"
  },
  {
    "text": "you know because your your actual hash calculation is going to have a result that's longer than 12 bytes uh the memory comparison operation has to be",
    "start": "1211799",
    "end": "1218320"
  },
  {
    "text": "constrained by something and a lot of people constrained it by the length of the hash in the packet which is another",
    "start": "1218320",
    "end": "1223840"
  },
  {
    "text": "classic security mistake don't trust lengths in packets uh so you know the",
    "start": "1223840",
    "end": "1229080"
  },
  {
    "text": "consequence of this is that the attacker need only send one bite and if that bite is the same as the first valid bite of",
    "start": "1229080",
    "end": "1236320"
  },
  {
    "text": "the valid message digest the me the packet is considered authenticated and he gets in um in practice this means he",
    "start": "1236320",
    "end": "1243240"
  },
  {
    "text": "sends 256 interception requests with different uh all different values of that first bite and one of them will be",
    "start": "1243240",
    "end": "1250799"
  },
  {
    "text": "accepted this vulnerability was disclosed in June of 2008 it impacted a lot of people a lot of SNMP",
    "start": "1250799",
    "end": "1257080"
  },
  {
    "text": "implementations not just this go um some implementations were vulnerable for over 6 years what's interesting is",
    "start": "1257080",
    "end": "1264840"
  },
  {
    "text": "most of the Cisco router uh most of the iOS versions that support this lawful intercept so capability were not",
    "start": "1264840",
    "end": "1272080"
  },
  {
    "text": "actually vulnerable to this bug and that's weird because lawful intercept has been a part of Cisco routers for",
    "start": "1272080",
    "end": "1278240"
  },
  {
    "text": "many years now and so there were many years when some Cisco S&P implementations had this bug and others",
    "start": "1278240",
    "end": "1284400"
  },
  {
    "text": "did not um I found one that that had both the feature and the bug uh and",
    "start": "1284400",
    "end": "1291400"
  },
  {
    "text": "it supports it runs on these Cisco 1000 or 10,000 series routers these are Edge routers for broadband service providers",
    "start": "1291400",
    "end": "1298320"
  },
  {
    "text": "like DSL or cable modem companies uh so there's a lot of people's home internet access might be provided through a router like this",
    "start": "1298320",
    "end": "1304880"
  },
  {
    "text": "uh one of the things that this router does that I have a personal uh ax to grind about is it supports service",
    "start": "1304880",
    "end": "1311200"
  },
  {
    "text": "provider vpns uh so in the security industry when we sell vpns um we're selling an",
    "start": "1311200",
    "end": "1318919"
  },
  {
    "text": "encrypted tunnel between two points so that a a company can build a secure connection between remote offices and I",
    "start": "1318919",
    "end": "1325960"
  },
  {
    "text": "think that people have this built-in expectation that when you say VPN you mean encryption but there are a lot of",
    "start": "1325960",
    "end": "1331960"
  },
  {
    "text": "service providers that sell service provider vpns that don't have encryption and I I personally feel like it's a",
    "start": "1331960",
    "end": "1338279"
  },
  {
    "text": "confusing thing to use the same word to refer to something that doesn't involve cryptography when you push service",
    "start": "1338279",
    "end": "1344039"
  },
  {
    "text": "providers about this what they tell you is you don't have to worry about that because service provider networks are",
    "start": "1344039",
    "end": "1349679"
  },
  {
    "text": "not subject to unauthorized surveillance well guess what yes they are and um this",
    "start": "1349679",
    "end": "1355320"
  },
  {
    "text": "uh you can actually specify a VPN in the uh in the interception request uh so you",
    "start": "1355320",
    "end": "1361080"
  },
  {
    "text": "can you can specify any of the vpns that is configured on the on the router so in addition um this is the",
    "start": "1361080",
    "end": "1369360"
  },
  {
    "text": "third uh issue uh there's lack of audit Trails here um first of all uh attacks",
    "start": "1369360",
    "end": "1375679"
  },
  {
    "text": "on SN pv3 authentication are very noisy if you're brute forcing usernames and passwords you're sending a lot of stuff",
    "start": "1375679",
    "end": "1380960"
  },
  {
    "text": "that's getting rejected um even this uh even this password attack involves sting 256 requests one of which is going to",
    "start": "1380960",
    "end": "1387120"
  },
  {
    "text": "get tossed out right um so you would think that a service provider would be able to notice that uh Cisco's lawful",
    "start": "1387120",
    "end": "1393440"
  },
  {
    "text": "intercept documentation advises you to configure SNMP traps and the",
    "start": "1393440",
    "end": "1398480"
  },
  {
    "text": "documentation strongly implies that snmpv3 authentication failures or at least it used to imply that snmpv3",
    "start": "1398480",
    "end": "1404840"
  },
  {
    "text": "authentication failures would produce traps so I tested this on all of the iOS",
    "start": "1404840",
    "end": "1411400"
  },
  {
    "text": "versions that I had in my lab and it didn't work um no no authentication failure traps were were were issued for",
    "start": "1411400",
    "end": "1418240"
  },
  {
    "text": "any out of whacks and and pv3 messages so I sent this to Cisco I thought it was an authentic I thought it was an",
    "start": "1418240",
    "end": "1423960"
  },
  {
    "text": "implementation bug and I said no this doesn't work what's the story I don't know why they I was not privy to the",
    "start": "1423960",
    "end": "1430799"
  },
  {
    "text": "debate that incurred internally in Cisco when I sent them this but they decided that the implementation was right and",
    "start": "1430799",
    "end": "1436360"
  },
  {
    "text": "the documentation was wrong and they apparently changed the documentation so that it no longer says that traps are",
    "start": "1436360",
    "end": "1442440"
  },
  {
    "text": "generated when snmpv3 authentication failures occur so um to me I I think",
    "start": "1442440",
    "end": "1448080"
  },
  {
    "text": "that um a network administrator would want to know that his network was under attack and so it would be a good idea to fix this but I'm going to talk about how",
    "start": "1448080",
    "end": "1454480"
  },
  {
    "text": "I what I recommend be done about all this at the end of the talk um so this",
    "start": "1454480",
    "end": "1460960"
  },
  {
    "text": "there's another problem in the audit Trail space and this is the sort of key architectural flaw that I think exists",
    "start": "1460960",
    "end": "1467360"
  },
  {
    "text": "in a lot of this lawful intercept technology um the the the user can turn the logs off uh the control so that you",
    "start": "1467360",
    "end": "1476039"
  },
  {
    "text": "can the the router will generate SNMP traps that tell you that a wire tap is taking place but the you can specify in",
    "start": "1476039",
    "end": "1483200"
  },
  {
    "text": "the interception request that you don't want those traps to be generated and and the router won't generate them so the",
    "start": "1483200",
    "end": "1488320"
  },
  {
    "text": "attacker can just say don't don't log this don't create an AIT Trail please um there's actually a reason that they",
    "start": "1488320",
    "end": "1493840"
  },
  {
    "text": "design this this way in um in the service provider the",
    "start": "1493840",
    "end": "1499640"
  },
  {
    "text": "people who are responsible for provisioning wir Taps are not the same people that run the network and they",
    "start": "1499640",
    "end": "1506399"
  },
  {
    "text": "don't want the people who run the network to find out what the police are doing you know they don't want the",
    "start": "1506399",
    "end": "1511720"
  },
  {
    "text": "router if if if the router administrator could specify any destination address for traps related to lawful intercept he",
    "start": "1511720",
    "end": "1518320"
  },
  {
    "text": "could add in an IP address of his computer at home and anytime a lawful intercept uh you know the lawful",
    "start": "1518320",
    "end": "1523960"
  },
  {
    "text": "intercept interface was was used he would get notified and he could call his friends up and say hey Louie you need to",
    "start": "1523960",
    "end": "1529559"
  },
  {
    "text": "stop going to those websites they have a warrant this time so that's a problem right um so so",
    "start": "1529559",
    "end": "1538080"
  },
  {
    "text": "basically they've decided to implement this stuff in in many cases without an audit trail and I I I I'm going to I'm",
    "start": "1538080",
    "end": "1544480"
  },
  {
    "text": "going to discuss I I think there's actually a better way to do this so that there would be an audit Trail but the but the router administrator is not able",
    "start": "1544480",
    "end": "1550720"
  },
  {
    "text": "to play games like that and I'll I'll talk about that later um another issue was the",
    "start": "1550720",
    "end": "1555880"
  },
  {
    "text": "flexibility of the output stream this is the fourth problem uh you can send once",
    "start": "1555880",
    "end": "1562399"
  },
  {
    "text": "you've gotten an interception request accepted by the router you can send the traffic anywhere on the global network",
    "start": "1562399",
    "end": "1568200"
  },
  {
    "text": "over any port or any service you can send it as a UDP uh formatted this",
    "start": "1568200",
    "end": "1574200"
  },
  {
    "text": "packet cable UDP format you can send it as a bunch of RTP traffic which is also a UDP stream uh you can send it as a TCP",
    "start": "1574200",
    "end": "1581279"
  },
  {
    "text": "session and you could also send it as sctp so you can send the the uh the tap",
    "start": "1581279",
    "end": "1588679"
  },
  {
    "text": "uh over Port 53 as a bunch of UDP packets so all the packet filters in the network think it's DNS traffic no one",
    "start": "1588679",
    "end": "1595640"
  },
  {
    "text": "filters DNS ask ask Dan Kaminsky um the fifth problem is that this",
    "start": "1595640",
    "end": "1602520"
  },
  {
    "text": "interface is highly susceptible to packet spoofing because it's just a single UDP packet that you need to to",
    "start": "1602520",
    "end": "1609000"
  },
  {
    "text": "issue an interception request uh now there are a couple access lists that people might have specified and they're",
    "start": "1609000",
    "end": "1614520"
  },
  {
    "text": "not useless um usually a service provider will specify an access list",
    "start": "1614520",
    "end": "1619799"
  },
  {
    "text": "that says that routers will only take SNMP traffic from devices on the network",
    "start": "1619799",
    "end": "1625159"
  },
  {
    "text": "that are part of the service providers management land uh and this is this is useful because you have to get these",
    "start": "1625159",
    "end": "1631080"
  },
  {
    "text": "engine values um it's theoretically possible to get the engine values without actually requesting them from",
    "start": "1631080",
    "end": "1636880"
  },
  {
    "text": "the router uh the engine ID defaults to the MAC address of the router uh which you might be able to get from the",
    "start": "1636880",
    "end": "1642360"
  },
  {
    "text": "network possibly um the uh the uh uh the other values start counting from zero",
    "start": "1642360",
    "end": "1648679"
  },
  {
    "text": "and so they have a bias toward low numbers which might make them easy to predict uh so yeah it's it's it's it's",
    "start": "1648679",
    "end": "1655240"
  },
  {
    "text": "sort of in this gray area between it's not impossible but it might be impractical and so I think that a a",
    "start": "1655240",
    "end": "1662120"
  },
  {
    "text": "service provider infrastructure access list probably uh mitigates this a little bit and so this is what I think is a",
    "start": "1662120",
    "end": "1668360"
  },
  {
    "text": "realistic attack scenario um in this case the attacker has owned a computer",
    "start": "1668360",
    "end": "1673880"
  },
  {
    "text": "that's in the service provider management network uh that's not far-fetched at all uh although many of those computers",
    "start": "1673880",
    "end": "1681039"
  },
  {
    "text": "would not be as protected as carefully as the mediation device uh and he generates this interception request",
    "start": "1681039",
    "end": "1686640"
  },
  {
    "text": "which he sends from that Network to the router and then the router sends the intercepted traffic out to the internet",
    "start": "1686640",
    "end": "1692799"
  },
  {
    "text": "to his box out there um there is another access list that you can specify and it",
    "start": "1692799",
    "end": "1698240"
  },
  {
    "text": "ends up being useful but not by itself um it's also something that I don't think anyone does because it's not well",
    "start": "1698240",
    "end": "1704279"
  },
  {
    "text": "documented you can specify an access list for an SNMP User Group group so uh",
    "start": "1704279",
    "end": "1709760"
  },
  {
    "text": "the SNMP user group that has access to perform intercepts could be constrained to come only from the IP address of the",
    "start": "1709760",
    "end": "1715480"
  },
  {
    "text": "mediation device uh so the the the thing about that is that it's the attacker can",
    "start": "1715480",
    "end": "1721799"
  },
  {
    "text": "use the fact that he's on the service provider Network to get the engine values from the router and then he when",
    "start": "1721799",
    "end": "1727440"
  },
  {
    "text": "he forms his interception request he can just spoof that from the mediation device's address and it will get accepted so that doesn't fix the problem",
    "start": "1727440",
    "end": "1734240"
  },
  {
    "text": "I also don't think anyone's doing it because it's not in the SNMP hardening guides it's not in the lawful intercept",
    "start": "1734240",
    "end": "1739799"
  },
  {
    "text": "guide you really probably don't know about it unless you like playing around with the question mark on the iOS",
    "start": "1739799",
    "end": "1745519"
  },
  {
    "text": "console so um another problem is that there's no requirement for encryption",
    "start": "1745519",
    "end": "1750679"
  },
  {
    "text": "and I don't think you can actually do this safely unless you're encrypting it but I know that there are a lot of",
    "start": "1750679",
    "end": "1755880"
  },
  {
    "text": "providers out there that do not encrypt this um Cisco says although encryption is not necessarily a requirement it is",
    "start": "1755880",
    "end": "1763080"
  },
  {
    "text": "highly recommended um there are two kinds of encryption which you could potentially use and they have different security",
    "start": "1763080",
    "end": "1769840"
  },
  {
    "text": "properties one thing you could do is snmpv3 has its own built-in encryption",
    "start": "1769840",
    "end": "1774880"
  },
  {
    "text": "uh and you could use it and it's not a bad idea because it protects you from that password guessing vulnerability that I talked about because there's a",
    "start": "1774880",
    "end": "1780960"
  },
  {
    "text": "different key that's used for the encryption uh and so the attacker would also have to get that key um however",
    "start": "1780960",
    "end": "1786960"
  },
  {
    "text": "even if you did that I I'm still concerned about the security of this interface particularly from insiders uh",
    "start": "1786960",
    "end": "1792519"
  },
  {
    "text": "because there's no audit Trail you can still spoof the packets and the output string goes anywhere on the internet uh",
    "start": "1792519",
    "end": "1798640"
  },
  {
    "text": "so so I you know this is still kind of an issue um IPC is a better solution you",
    "start": "1798640",
    "end": "1805120"
  },
  {
    "text": "can build an IP secc tunnel from the mediation device to the router uh and",
    "start": "1805120",
    "end": "1810360"
  },
  {
    "text": "that will encrypt not only your interception request going out but all of the content coming back now here's",
    "start": "1810360",
    "end": "1816480"
  },
  {
    "text": "the problem if you look at this network diagram the interception request isn't coming from the mediation device it's",
    "start": "1816480",
    "end": "1822159"
  },
  {
    "text": "coming from another address and so the router is not going to expect it to be encrypted and the output stream is not going back to the mediation device it's",
    "start": "1822159",
    "end": "1828399"
  },
  {
    "text": "going to another destination on the internet so the router is not going to encrypt that either the only way that IPC really protects you is if you couple",
    "start": "1828399",
    "end": "1835519"
  },
  {
    "text": "it with that SNMP User Group access list that I talked about uh so that you only accept interception requests from the",
    "start": "1835519",
    "end": "1842000"
  },
  {
    "text": "mediation devices IP and you only accept traffic from that IP if it's IP SEC encrypted if you do both those things",
    "start": "1842000",
    "end": "1848240"
  },
  {
    "text": "this interface is pretty safe so um how practical is this attack",
    "start": "1848240",
    "end": "1853919"
  },
  {
    "text": "uh in the real world what are people doing I I I think that people are using that infrastructure access list that I",
    "start": "1853919",
    "end": "1859760"
  },
  {
    "text": "talked about um I think some service providers might still be vulnerable to this bug from last summer because people",
    "start": "1859760",
    "end": "1865320"
  },
  {
    "text": "don't upgrade their routers it's just an operational risk and so often people don't do it uh there are many service",
    "start": "1865320",
    "end": "1873039"
  },
  {
    "text": "providers that are not using encryption and I don't think you can protect this interface adequately if you're not using encryption uh so I and I don't think",
    "start": "1873039",
    "end": "1880360"
  },
  {
    "text": "anyone's using that User Group access list that I talked about so in practice um this attack scenario you know is is",
    "start": "1880360",
    "end": "1887360"
  },
  {
    "text": "is fairly PR practical and I I want to talk about um another so so has has anyone ever",
    "start": "1887360",
    "end": "1894120"
  },
  {
    "text": "attacked lawful intercept is a valid question to ask yeah this is a yeah this stuff never happens right so there's",
    "start": "1894120",
    "end": "1899600"
  },
  {
    "text": "only one case that I know about where it's confirmed it's not a rumor that this really hurt this really happened uh",
    "start": "1899600",
    "end": "1905519"
  },
  {
    "text": "it happened in Greece during the during the summer olympics that were there a few years ago uh um someone installed",
    "start": "1905519",
    "end": "1911399"
  },
  {
    "text": "some malware this did not involve Cisco equipment it involved an Ericson cellular telephone switch somebody",
    "start": "1911399",
    "end": "1916799"
  },
  {
    "text": "installed some malware root kit in the phone switch uh and and these Ericson",
    "start": "1916799",
    "end": "1921919"
  },
  {
    "text": "Engineers actually found this thing because they were auditing C dumps in order to troubleshoot of vulnerability",
    "start": "1921919",
    "end": "1927679"
  },
  {
    "text": "and they found assembly code in the binary that they didn't write can you imagine and it and it turned out it was",
    "start": "1927679",
    "end": "1933480"
  },
  {
    "text": "spying on people this is like the technical support escalation nightmare from Hell uh but",
    "start": "1933480",
    "end": "1939639"
  },
  {
    "text": "they the the um it turns out they were spying on like a hundred senior members of the Greek government they were spying",
    "start": "1939639",
    "end": "1945720"
  },
  {
    "text": "on the Greek Prime Minister um and uh what What's really interesting about this well there's two things I want to",
    "start": "1945720",
    "end": "1950840"
  },
  {
    "text": "say the first is that these guys wrote malware that runs on a phone switch this is really complicated um this is much",
    "start": "1950840",
    "end": "1957440"
  },
  {
    "text": "more sophisticated than what I'm talking about which is just generating an SNP V3 request most of the people in this room",
    "start": "1957440",
    "end": "1962799"
  },
  {
    "text": "could write software that generates an snmpv3 request before this talk is over uh so this is much more complicated the",
    "start": "1962799",
    "end": "1969639"
  },
  {
    "text": "second thing I want to point out about this is that if you read if you go read this i e Spectrum article that discussed",
    "start": "1969639",
    "end": "1975679"
  },
  {
    "text": "this and you read between the lines you see some of the same architectural uh components that exist in the Cisco",
    "start": "1975679",
    "end": "1981600"
  },
  {
    "text": "architecture where you've got this thing called the IMs which is The Intercept management system uh where Taps are",
    "start": "1981600",
    "end": "1988120"
  },
  {
    "text": "provisioned and that's where the audit Trail is and then on the other side you have this thing called the reses which",
    "start": "1988120",
    "end": "1993600"
  },
  {
    "text": "is in the phone switch which actually performs the intercepts and what this malware did is it attached to the Rees",
    "start": "1993600",
    "end": "1999639"
  },
  {
    "text": "and got it to intercept um and they didn't mess with the IMs so no audit Trail was generated uh so they've really",
    "start": "1999639",
    "end": "2005279"
  },
  {
    "text": "used the exact same architecture and they've they' they've removed the audit trails from the actual thing that",
    "start": "2005279",
    "end": "2010440"
  },
  {
    "text": "performs the surveillance and I think that that is a fundamental architectural flaw that affects a lot of lawful intercept implementations using",
    "start": "2010440",
    "end": "2016760"
  },
  {
    "text": "different technology because it all flows from that Etsy standard um so what should we do about",
    "start": "2016760",
    "end": "2023799"
  },
  {
    "text": "all this how should we address these vulnerabilities I have recommendations",
    "start": "2023799",
    "end": "2029399"
  },
  {
    "text": "uh for changes to the SNMP V3 standard that need to be made at the ITF level I have recommendations for Cisco for how",
    "start": "2029399",
    "end": "2036679"
  },
  {
    "text": "they can change their specific implementation and I I also have recommendations for isps that are using",
    "start": "2036679",
    "end": "2043200"
  },
  {
    "text": "this today that need to deploy it safely and so one of the questions that gets asked is you know if this can be",
    "start": "2043200",
    "end": "2048560"
  },
  {
    "text": "deployed safely by an ISP today why change the protocol um and I I had a",
    "start": "2048560",
    "end": "2054000"
  },
  {
    "text": "bunch of slides that are in the that are on the CD that relate to this and and I decided to pull them for timing reasons",
    "start": "2054000",
    "end": "2059960"
  },
  {
    "text": "and because in this room I'm kind of preaching to the choir you guys get this but a lot of people that design protocols don't get it um I I think that",
    "start": "2059960",
    "end": "2067878"
  },
  {
    "text": "protocols ought to be designed uh with the with the anticipation that we people will not deploy them in an optimal way",
    "start": "2067879",
    "end": "2074440"
  },
  {
    "text": "we we know we could deploy it in a secure way but some people won't do that and so we should design protocols that",
    "start": "2074440",
    "end": "2079599"
  },
  {
    "text": "fail gracefully when they are not deployed properly uh and and so I I think that changes are warranted here to",
    "start": "2079599",
    "end": "2085638"
  },
  {
    "text": "to make the things a little bit more secure if the provider didn't do all the right things um so what are my recommendations",
    "start": "2085639",
    "end": "2093200"
  },
  {
    "text": "for snmpv3 I I think that we should make authentication errors less helpful to attack don't tell them why something",
    "start": "2093200",
    "end": "2099400"
  },
  {
    "text": "failed to authenticate just tell them to go away uh at the same time I think we need to make authentication failures",
    "start": "2099400",
    "end": "2104640"
  },
  {
    "text": "more helpful to network administrators instead of telling the the attacker why we we threw his packet out we should",
    "start": "2104640",
    "end": "2110440"
  },
  {
    "text": "tell the network administrator that the router's under attack um furthermore I think that the",
    "start": "2110440",
    "end": "2115720"
  },
  {
    "text": "engine values should be more difficult to predict than share this isn't really a flaw it's just an unanticipated uh",
    "start": "2115720",
    "end": "2121480"
  },
  {
    "text": "possibility that they didn't consider uh they they designed these engine values to to prevent replay and they prevent",
    "start": "2121480",
    "end": "2127720"
  },
  {
    "text": "replay well uh but they almost prevent spoofing and if they were improved by",
    "start": "2127720",
    "end": "2132800"
  },
  {
    "text": "making them more similar to uh sin cookies they would effectively prevent spoofing um what you want to do is",
    "start": "2132800",
    "end": "2138400"
  },
  {
    "text": "include the source address uh that the request came from and a secret uh and and produce a number that's unpredictable and send it back and then",
    "start": "2138400",
    "end": "2144839"
  },
  {
    "text": "the and then they can't share it I can't go collect that number and then use it in a request that I'm spoofing from",
    "start": "2144839",
    "end": "2150079"
  },
  {
    "text": "another address uh I think that that change could be made without a flag day for snmpv3 I think that routers could",
    "start": "2150079",
    "end": "2157040"
  },
  {
    "text": "simply start sending out more complicated engine times and uh everything would just",
    "start": "2157040",
    "end": "2163160"
  },
  {
    "text": "work recommendations for lawful intercept um so one of my recommendations is is to use a different",
    "start": "2163160",
    "end": "2169160"
  },
  {
    "text": "port and and actually I I should have said I should have clarified something earlier I'm all these recommendations",
    "start": "2169160",
    "end": "2174440"
  },
  {
    "text": "I'm making are from my perspective as a security researcher I acknowledge that I don't know everything that goes on in the world I don't know all of the design",
    "start": "2174440",
    "end": "2181400"
  },
  {
    "text": "criteria that were used in designing some of this stuff and all the reasons why it's designed the way it's designed",
    "start": "2181400",
    "end": "2186720"
  },
  {
    "text": "and so I accept that some of my recommendations might not be um uh recommendations that can be taken uh I'm",
    "start": "2186720",
    "end": "2193280"
  },
  {
    "text": "providing a number of different options and some of them will work and some of them won't uh in anyway use a different",
    "start": "2193280",
    "end": "2198680"
  },
  {
    "text": "port um there's a lot of SNMP traffic going on on a provider's network that's used for all kinds of different purposes",
    "start": "2198680",
    "end": "2205599"
  },
  {
    "text": "um if you move lawful intercept to a different port it's easy to make access lists that filter it specifically instead of General access list that say",
    "start": "2205599",
    "end": "2212480"
  },
  {
    "text": "everyone who does SNMP can come in and talk to this service uh uh they router",
    "start": "2212480",
    "end": "2218160"
  },
  {
    "text": "should administrator should be able to limit the destinations for the output stream you should not be able to send",
    "start": "2218160",
    "end": "2223440"
  },
  {
    "text": "your content to Botswana over Port 53 um that you should the router administrator",
    "start": "2223440",
    "end": "2228839"
  },
  {
    "text": "should be able to specify an access list that says this is where you can send content um we should all they should",
    "start": "2228839",
    "end": "2234640"
  },
  {
    "text": "also move notification control into the router configuration and this goes back to that fundamental architectural flaw",
    "start": "2234640",
    "end": "2241200"
  },
  {
    "text": "that I was talking about where um that they don't want the router administrator to be able to to notify his buddies when",
    "start": "2241200",
    "end": "2248200"
  },
  {
    "text": "the wire tapping is being performed so um the way to deal with that is to is to",
    "start": "2248200",
    "end": "2254160"
  },
  {
    "text": "design this so that you get agreement between the router configuration and the interception request so the router can",
    "start": "2254160",
    "end": "2260960"
  },
  {
    "text": "the router administrator specifies a list of addresses that traps can be sent to okay and then and then the the um",
    "start": "2260960",
    "end": "2268760"
  },
  {
    "text": "when the mediation device generates the interception request it specifies an address to send traps to the router",
    "start": "2268760",
    "end": "2275680"
  },
  {
    "text": "enforces that the the reception request specified an address and then that address is one of the addresses that the",
    "start": "2275680",
    "end": "2282720"
  },
  {
    "text": "router administrator also specified so in this case um the the person",
    "start": "2282720",
    "end": "2288280"
  },
  {
    "text": "generating the interception request must include an address for notification and that not address must be one that the",
    "start": "2288280",
    "end": "2294400"
  },
  {
    "text": "network administrator has agreed to but conversely uh the person who configured the router you know cannot send",
    "start": "2294400",
    "end": "2301319"
  },
  {
    "text": "intercept notifications anywhere that the people who run the mediation device haven't agreed to nobody can fool around",
    "start": "2301319",
    "end": "2307760"
  },
  {
    "text": "I think that effectively solves the security concerns involved in in um in the audit Trail without eliminating the",
    "start": "2307760",
    "end": "2314440"
  },
  {
    "text": "audit Trail entirely which is what what has been done in a lot of these systems uh I also have recommendations",
    "start": "2314440",
    "end": "2321920"
  },
  {
    "text": "for proper deployment that came out of this research um first of all make sure you've patched that SNMP bug I know it's",
    "start": "2321920",
    "end": "2327680"
  },
  {
    "text": "a pain to patch a router but you you know it's important when there's a serious security issue uh um use",
    "start": "2327680",
    "end": "2333599"
  },
  {
    "text": "encryption specifically ipack if you're not encrypting then you know you're not you're not",
    "start": "2333599",
    "end": "2339760"
  },
  {
    "text": "there's no way that you can protect the content coming back um it's and really there's no way that you can prevent this interface from being used without",
    "start": "2339760",
    "end": "2346240"
  },
  {
    "text": "authorization um use the user group IP Access Control list that I talked about",
    "start": "2346240",
    "end": "2351440"
  },
  {
    "text": "to lock the SNMP user for lawful intercept down to the IP address of the mediation device if you do those three",
    "start": "2351440",
    "end": "2358680"
  },
  {
    "text": "things this interface is pretty safe uh if you're not doing them then there is a risk that it could be used without",
    "start": "2358680",
    "end": "2365359"
  },
  {
    "text": "authorization uh furthermore there's all kinds of other things you need to do to run a secure router Network and that",
    "start": "2365359",
    "end": "2371040"
  },
  {
    "text": "discussion is way outside the scope of this talk obviously uh but one of the things you might consider is building outof band management networks um so",
    "start": "2371040",
    "end": "2378280"
  },
  {
    "text": "that your uh your your management traffic is is going over a different interface into these routers than the",
    "start": "2378280",
    "end": "2383520"
  },
  {
    "text": "traffic that is that is used for that is part of the network itself um some it's expensive to do that some providers Do",
    "start": "2383520",
    "end": "2390319"
  },
  {
    "text": "It um I think it makes a lot of sense from a security perspective although the other thing you need to ask yourself is",
    "start": "2390319",
    "end": "2395680"
  },
  {
    "text": "how isolated is my out of management Network really is it really totally isolated from the Internet or are there",
    "start": "2395680",
    "end": "2402040"
  },
  {
    "text": "people in the knock who can get there who are browsing the web at 3: in the morning because they're bored and getting malware on their PCS you got to",
    "start": "2402040",
    "end": "2408480"
  },
  {
    "text": "think about these things so all of this uh discussion",
    "start": "2408480",
    "end": "2413800"
  },
  {
    "text": "leads me to to a few conclusions um I think the most important conclusion is",
    "start": "2413800",
    "end": "2419359"
  },
  {
    "text": "that peerreview matters I think that Cisco did the right thing when they published this interface in in an RFC so",
    "start": "2419359",
    "end": "2425800"
  },
  {
    "text": "that we can read it and we can understand and how this works and we can provide technical feedback uh there's a",
    "start": "2425800",
    "end": "2432520"
  },
  {
    "text": "lot of of other technology out there all kinds of different lawful intercept vendors and and they have not published",
    "start": "2432520",
    "end": "2438880"
  },
  {
    "text": "their architectures we can't read them we don't know how they work they haven't been subject to auditing and so although",
    "start": "2438880",
    "end": "2444560"
  },
  {
    "text": "I found some uh security weaknesses in this design at least we know what they are and what we can do to mitigate them",
    "start": "2444560",
    "end": "2450680"
  },
  {
    "text": "there are other there are all kinds of other architectures out there that we haven't been subject to any peer review",
    "start": "2450680",
    "end": "2455839"
  },
  {
    "text": "and we can't be confident at all about their security properties as a result uh and you know we know that nobody ever",
    "start": "2455839",
    "end": "2461920"
  },
  {
    "text": "builds anything perfectly you know that's why they've been having black hat conferences for years because there's always new vulnerabilities and so the",
    "start": "2461920",
    "end": "2469400"
  },
  {
    "text": "the reality is that um you know it's it's not appropriate to expect somebody to go out the gate with an architecture",
    "start": "2469400",
    "end": "2476040"
  },
  {
    "text": "and for it to be free from security risk what's appropriate is for them to uh to to subject that secur that system to",
    "start": "2476040",
    "end": "2482720"
  },
  {
    "text": "peer review and Analysis and over time we can improve its security to the point where it is actually reasonable um and I",
    "start": "2482720",
    "end": "2488440"
  },
  {
    "text": "think that's what we're trying to do in this case so I think it I think this is how this should work uh the um the other",
    "start": "2488440",
    "end": "2495640"
  },
  {
    "text": "thing is that that um it's interesting so so in in US law uh the way that um",
    "start": "2495640",
    "end": "2502119"
  },
  {
    "text": "the the the Judiciary and executive uh um uh the way that the checks and balances work there regarding um",
    "start": "2502119",
    "end": "2509000"
  },
  {
    "text": "unauthorized surveillance is that if the police go collect information that they weren't authorized to collect and they",
    "start": "2509000",
    "end": "2514119"
  },
  {
    "text": "show up in court with it it gets thrown out it's called the exclusionary rule they can only use information that they",
    "start": "2514119",
    "end": "2520200"
  },
  {
    "text": "obtained lawfully um and so that's so at the the the thing that that that creates",
    "start": "2520200",
    "end": "2526079"
  },
  {
    "text": "a negative incentive for unauthorized surveillance by the executive branch is the way that the court system operates",
    "start": "2526079",
    "end": "2531440"
  },
  {
    "text": "trials um this piece of software actually pushes the interface between",
    "start": "2531440",
    "end": "2537839"
  },
  {
    "text": "the executive and judicial branch to a different place um and it actually prevents the Executive Branch from",
    "start": "2537839",
    "end": "2544680"
  },
  {
    "text": "collecting information they weren't authorized to collect in the first place and that's interesting to me um and it",
    "start": "2544680",
    "end": "2552040"
  },
  {
    "text": "and if we're going to have software that's actually forming an interface between two branches of our government",
    "start": "2552040",
    "end": "2557960"
  },
  {
    "text": "it's it perform it's it's important that that the the nature of that interface be publicly described and that we all have",
    "start": "2557960",
    "end": "2564480"
  },
  {
    "text": "the ability to understand how it works uh because it's not just the router vendor and the ISP who have interests at",
    "start": "2564480",
    "end": "2570800"
  },
  {
    "text": "stake in the nature of that interface we all do so um there are a lot of",
    "start": "2570800",
    "end": "2577599"
  },
  {
    "text": "architectures out there that have not been subject to peer review and I want to provide an example of one um there's",
    "start": "2577599",
    "end": "2582839"
  },
  {
    "text": "this thing called the Klein declaration there's this guy named Mark kleene who used to work for AT&T and he retired uh",
    "start": "2582839",
    "end": "2589640"
  },
  {
    "text": "and he went to the eff and he told them that uh his employer had asked him to",
    "start": "2589640",
    "end": "2595040"
  },
  {
    "text": "install a fiber optic splitter in their Network and send the traffic on the",
    "start": "2595040",
    "end": "2600319"
  },
  {
    "text": "network off to some room that allegedly is operated by the NSA uh and so there's",
    "start": "2600319",
    "end": "2606119"
  },
  {
    "text": "there's a bunch of documentation on the internet that that he provided um you know that relates to what he is alleging",
    "start": "2606119",
    "end": "2613319"
  },
  {
    "text": "occurred uh Assuming he's not crazy um or this is",
    "start": "2613319",
    "end": "2620280"
  },
  {
    "text": "a lawful intercept architecture that has not been subject to peer rreview and we wouldn't know about it unless this guy was willing to take a risk and and and",
    "start": "2620280",
    "end": "2627040"
  },
  {
    "text": "uh and talk about it publicly uh and um it has different security properties than the one we've just discussed um in",
    "start": "2627040",
    "end": "2633960"
  },
  {
    "text": "some respects uh maybe it's harder I we don't know for sure because it really hasn't been subject to to a lot of",
    "start": "2633960",
    "end": "2639400"
  },
  {
    "text": "analysis but it might be harder to use without authorization uh because you know it's harder to generate a packet",
    "start": "2639400",
    "end": "2646000"
  },
  {
    "text": "that that manipulates a physical fiber optic splutter uh but on the other hand all of the minimization is occurring in",
    "start": "2646000",
    "end": "2652880"
  },
  {
    "text": "the law in the law enforcement organization or the intelligence agency there isn't um minimization occurring in",
    "start": "2652880",
    "end": "2658800"
  },
  {
    "text": "the ISP and so it might not um be as effective at preventing the collection of information that the organization was",
    "start": "2658800",
    "end": "2665440"
  },
  {
    "text": "not authorized to collect and that's an important security property too so um this leads me to some personal",
    "start": "2665440",
    "end": "2672880"
  },
  {
    "text": "thoughts about this great debate that's been going on um and I want to I want to tell you I I think some of this uh you",
    "start": "2672880",
    "end": "2679040"
  },
  {
    "text": "know is is heresy in in this room and and I I I I I'm not like a a zealot uh",
    "start": "2679040",
    "end": "2685400"
  },
  {
    "text": "and I'm I'm not trying to uh tell you that I'm convinced that these answers are right what I'm I'm saying is that",
    "start": "2685400",
    "end": "2690800"
  },
  {
    "text": "I've been thinking about this and these are some thoughts that I had and and I want to present them to you so you can think about it too and let's talk about",
    "start": "2690800",
    "end": "2696880"
  },
  {
    "text": "it and and we'll see maybe you can prove me wrong about some of this stuff uh but um it used to be uh really easy to wir",
    "start": "2696880",
    "end": "2705559"
  },
  {
    "text": "tap with you know illegal wire tapping used to be really easy right um you could open a junction box and hook up",
    "start": "2705559",
    "end": "2711839"
  },
  {
    "text": "some alligator clips and listen to anyone's phone calls um with a with a portable scanner you could listen to",
    "start": "2711839",
    "end": "2717079"
  },
  {
    "text": "cellular phones or cordless phones it was it was open uh and it it actually seems like in the last 20 years it's",
    "start": "2717079",
    "end": "2723359"
  },
  {
    "text": "getting harder to do illegal Sur legal wiretapping there are encryption standards in play in these cell phones",
    "start": "2723359",
    "end": "2730040"
  },
  {
    "text": "uh so you can't just listen with the scanner anymore you you um you your cordless phone is probably digital",
    "start": "2730040",
    "end": "2735599"
  },
  {
    "text": "spread Spectrum so it's a little bit harder to tap uh a lot of the landline traffic is actually um uh encoded it's",
    "start": "2735599",
    "end": "2742520"
  },
  {
    "text": "DSL traffic it's data traffic and so you need an expensive protocol analyzer in order to listen to it you can't just",
    "start": "2742520",
    "end": "2747599"
  },
  {
    "text": "like use alligator clips in a phone uh so it's it's getting complicated I think that it might get a little cheaper in",
    "start": "2747599",
    "end": "2753680"
  },
  {
    "text": "the future because I think people will use software defined radios as prot analyzers to listen to DSL and cable",
    "start": "2753680",
    "end": "2759599"
  },
  {
    "text": "modem traffic uh but um generally speaking it's much harder than than it was 20 years ago and it's going to",
    "start": "2759599",
    "end": "2765359"
  },
  {
    "text": "remain harder and so what that tells me is that wiretapping is neither easy nor",
    "start": "2765359",
    "end": "2771000"
  },
  {
    "text": "impossible uh we're it's it's not black and white uh we have not had the broad",
    "start": "2771000",
    "end": "2777119"
  },
  {
    "text": "adoption of endtoend cryptography that thef argued for in RFC 1984 we people",
    "start": "2777119",
    "end": "2784400"
  },
  {
    "text": "use cryptography but they use it if it's baked into what they're doing uh they they use uh link layer encryption with",
    "start": "2784400",
    "end": "2790240"
  },
  {
    "text": "their cell phone or they use application layer encryption with SSL but if they've got to think about Keys forget it um and",
    "start": "2790240",
    "end": "2796960"
  },
  {
    "text": "so one observation that we could make is that link layer encryption helps prevent illegal wire tapping um it it we we've",
    "start": "2796960",
    "end": "2804760"
  },
  {
    "text": "hardened cell phones effectively we might want to consider hardening other protocols even land protocols effect",
    "start": "2804760",
    "end": "2810480"
  },
  {
    "text": "more effectively using link layer encryption I think that will reduce the amount of illegal wire tapping that goes on um sometimes",
    "start": "2810480",
    "end": "2817599"
  },
  {
    "text": "uh law enforcement resists uh link layer encryption when it interferes with how they perform intercepts uh and we saw",
    "start": "2817599",
    "end": "2824400"
  },
  {
    "text": "this happen with GSM where there there apparently were some weaknesses that were introduced in order to make it easier for someone with expensive",
    "start": "2824400",
    "end": "2829960"
  },
  {
    "text": "equipment to listen so um we we have to ask this question given that wiretapping",
    "start": "2829960",
    "end": "2836520"
  },
  {
    "text": "is neither easy nor it's impossible um there's going to be wiretapping performed and we have to ask how is that",
    "start": "2836520",
    "end": "2842280"
  },
  {
    "text": "wiretapping going to work uh and there are a couple different ways it could work uh it could work with temporary or",
    "start": "2842280",
    "end": "2848359"
  },
  {
    "text": "permanent devices a temporary device like a protocol analyzer that somebody you know checks out of the store room",
    "start": "2848359",
    "end": "2853559"
  },
  {
    "text": "and they go hook it up to the network uh or a permanent infrastructure that's built into the to the network um it is",
    "start": "2853559",
    "end": "2860640"
  },
  {
    "text": "the consensus view of a lot of computer security researchers that the permanent infrastructure is a bad idea and we",
    "start": "2860640",
    "end": "2867160"
  },
  {
    "text": "should stick with temp we should stick with temporary devices there are a lot of August names who have assigned",
    "start": "2867160",
    "end": "2872720"
  },
  {
    "text": "themselves up to that view including people like Whitfield Diffy and and Steven Elan who have contri I can't hold",
    "start": "2872720",
    "end": "2878440"
  },
  {
    "text": "a candle to everything that those guys have contributed over the years uh so I I I'm really stepping out on a limb here",
    "start": "2878440",
    "end": "2884880"
  },
  {
    "text": "by by potentially disagreeing with them but I I I developed another perspective on this while looking at this stuff um",
    "start": "2884880",
    "end": "2890400"
  },
  {
    "text": "and and that is that if you have a permanent infrastructure you have to have an access control facility to get",
    "start": "2890400",
    "end": "2897240"
  },
  {
    "text": "to that permanent infrastructure and that access control facility can validate that the people that are using",
    "start": "2897240",
    "end": "2903359"
  },
  {
    "text": "the infrastructure actually have the lawful authorization to do so if you have temporary protocol analyzers you",
    "start": "2903359",
    "end": "2909720"
  },
  {
    "text": "can't control them the guys come in they check it out they go do some tapping um you know they do minimization in the",
    "start": "2909720",
    "end": "2916280"
  },
  {
    "text": "device itself maybe they maybe they collected some additional information maybe they didn't unless you have some sort of tamperproof audit Trail that's",
    "start": "2916280",
    "end": "2923440"
  },
  {
    "text": "built into the device um you know there's there's really no way to tell what happened with it until you know",
    "start": "2923440",
    "end": "2928559"
  },
  {
    "text": "while it was checked out so um there's there's potentially a value to having a permanent infrastructure with an access",
    "start": "2928559",
    "end": "2935040"
  },
  {
    "text": "control mechanism uh as long is that access control mechanism actually controls access and so there's a bunch",
    "start": "2935040",
    "end": "2941480"
  },
  {
    "text": "of assumptions built into that one is that we can we can close off other means of getting access to the content we can",
    "start": "2941480",
    "end": "2946880"
  },
  {
    "text": "encrypt the link layers uh so that the only real way to perform wiretapping is to go through this funnel uh another is",
    "start": "2946880",
    "end": "2953160"
  },
  {
    "text": "is that we we need to be able to see how the architecture works so that we know it's actually doing what we think um and",
    "start": "2953160",
    "end": "2958920"
  },
  {
    "text": "and uh furthermore the the people who are validating and providing access to that that infrastructure need to",
    "start": "2958920",
    "end": "2964559"
  },
  {
    "text": "actually provide a check there are a lot of people out there who think that the service providers should simply be a",
    "start": "2964559",
    "end": "2969960"
  },
  {
    "text": "rubber stamp and they should cooperate and assist law enforcement regardless of whether or not this that they really",
    "start": "2969960",
    "end": "2975960"
  },
  {
    "text": "have lawful authorization or you know that they're under exting circumstances they should just give them access and",
    "start": "2975960",
    "end": "2983240"
  },
  {
    "text": "and um that that perspective undermines the validity of this technical argument",
    "start": "2983240",
    "end": "2989240"
  },
  {
    "text": "uh because if the if the access control doesn't actually control access then it doesn't provide any value um uh that",
    "start": "2989240",
    "end": "2995960"
  },
  {
    "text": "you're Trading for the risk associated with having an interface that could come under attack uh so basically what I'm",
    "start": "2995960",
    "end": "3003000"
  },
  {
    "text": "I'm I'm saying here is that is that by taking a couple steps we might be able to move toward an infrastructure that",
    "start": "3003000",
    "end": "3009000"
  },
  {
    "text": "that where illegal wire tapping is very difficult uh but we also have mechanisms in place that help uphold our system of",
    "start": "3009000",
    "end": "3014480"
  },
  {
    "text": "checks and balances and that might ultimately be the best sort of lawful intercept architecture that we could we",
    "start": "3014480",
    "end": "3019880"
  },
  {
    "text": "could get so um that's my talk uh thank you very much for uh for listening to me",
    "start": "3019880",
    "end": "3025839"
  },
  {
    "text": "and uh I'm I'm sure that some of you will have questions so um now was a good time for",
    "start": "3025839",
    "end": "3031119"
  },
  {
    "text": "that maybe you don't everyone's very quiet really no",
    "start": "3031119",
    "end": "3040520"
  },
  {
    "text": "questions all",
    "start": "3040520",
    "end": "3043680"
  },
  {
    "text": "right thank you",
    "start": "3045720",
    "end": "3049640"
  }
]