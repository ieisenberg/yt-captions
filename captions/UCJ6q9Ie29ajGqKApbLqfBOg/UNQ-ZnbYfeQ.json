[
  {
    "start": "0",
    "end": "25000"
  },
  {
    "text": "[Music]",
    "start": "1130",
    "end": "14690"
  },
  {
    "text": "hello everyone i am ali davanian a fourth year phd candidate joining me is",
    "start": "14799",
    "end": "20320"
  },
  {
    "text": "ahmad we are very thrilled to present our work cnc hunter",
    "start": "20320",
    "end": "26720"
  },
  {
    "start": "25000",
    "end": "75000"
  },
  {
    "text": "iot malware is on the rise and you probably all already know about this",
    "start": "26720",
    "end": "33040"
  },
  {
    "text": "the question is how can we defend against iot malware and a",
    "start": "33040",
    "end": "39040"
  },
  {
    "text": "key piece of the puzzle here is the command and control server or the cnc",
    "start": "39040",
    "end": "45360"
  },
  {
    "text": "uh if we knew where the command and control servers are located then the defense would be easy we can",
    "start": "45360",
    "end": "52399"
  },
  {
    "text": "easily take down the botnet or we can blacklist them at our network perimeter",
    "start": "52399",
    "end": "58640"
  },
  {
    "text": "and our iot devices within the network would be safe and this is essentially important for iot devices because of",
    "start": "58640",
    "end": "65760"
  },
  {
    "text": "their limited computing resource we cannot afford more expensive solutions",
    "start": "65760",
    "end": "71600"
  },
  {
    "text": "like antivirus on the device uh so our goal in this work is finding",
    "start": "71600",
    "end": "78080"
  },
  {
    "start": "75000",
    "end": "125000"
  },
  {
    "text": "all the live cnc servers i want you to picture this for a second right imagine",
    "start": "78080",
    "end": "83680"
  },
  {
    "text": "that we knew we're only live cnc servers are located right this is very exciting",
    "start": "83680",
    "end": "91040"
  },
  {
    "text": "i've been thinking about this uh gets me excited uh if we had this information then",
    "start": "91040",
    "end": "97280"
  },
  {
    "text": "taking down a botnet or defending against them would be easy",
    "start": "97280",
    "end": "102799"
  },
  {
    "text": "so what do we have to start with as independent security researchers we have",
    "start": "102799",
    "end": "108159"
  },
  {
    "text": "malware binaries we have access to some ip blacklist and we have partial",
    "start": "108159",
    "end": "113200"
  },
  {
    "text": "information about malware communication protocols what we don't have is access to the",
    "start": "113200",
    "end": "119280"
  },
  {
    "text": "network traffic and also access to antivirus companies sensors right",
    "start": "119280",
    "end": "125280"
  },
  {
    "start": "125000",
    "end": "210000"
  },
  {
    "text": "given that let's review the previous approaches so one method to identify cnc server is",
    "start": "125280",
    "end": "132640"
  },
  {
    "text": "to statically analyze the binary and find the ip addresses that it might contact",
    "start": "132640",
    "end": "138160"
  },
  {
    "text": "the limitation with this approach is when the binary is obfuscated right so it sometimes wouldn't work",
    "start": "138160",
    "end": "144959"
  },
  {
    "text": "the second approach is to execute and activate the binary let it generate traffic and then watch",
    "start": "144959",
    "end": "152800"
  },
  {
    "text": "what eyepiece it tries to contact again the limitation with this approach is that the ip address might not be live",
    "start": "152800",
    "end": "160640"
  },
  {
    "text": "the third approach is to infer the network protocol right the protocol that the iot malware tries to use",
    "start": "160640",
    "end": "167840"
  },
  {
    "text": "and then scan the internet you look for finger prints based on the protocol",
    "start": "167840",
    "end": "172879"
  },
  {
    "text": "inference and then find the cnc servers the limitation with this approach is",
    "start": "172879",
    "end": "178159"
  },
  {
    "text": "that iot malware proto communication protocols are too complex these days",
    "start": "178159",
    "end": "183440"
  },
  {
    "text": "uh and you cannot have a generic solution and uh encryption also adds to the problem",
    "start": "183440",
    "end": "189519"
  },
  {
    "text": "finally we could passively monitor the internet look at the malware traffic",
    "start": "189519",
    "end": "194959"
  },
  {
    "text": "and then find the uh cnc addresses that the malware might contact the limitation",
    "start": "194959",
    "end": "201440"
  },
  {
    "text": "with this approach again is the size of the traffic and the diversity in the number of iot malware communication",
    "start": "201440",
    "end": "209200"
  },
  {
    "text": "protocols so what do we propose we propose cnc hunter and our solution is a novel solution",
    "start": "209200",
    "end": "217360"
  },
  {
    "start": "210000",
    "end": "277000"
  },
  {
    "text": "that allows you to probe do the probing and cnc discovery using the real malware",
    "start": "217360",
    "end": "223840"
  },
  {
    "text": "right so for the probing we don't want to understand the communication protocol",
    "start": "223840",
    "end": "229120"
  },
  {
    "text": "but we want to use the real malware to uh communicate with the",
    "start": "229120",
    "end": "234640"
  },
  {
    "text": "uh potential addresses that we might think uh are hosting cnc servers right",
    "start": "234640",
    "end": "241599"
  },
  {
    "text": "uh as far as we know we are the first open source tool uh and we are specifically designing",
    "start": "241599",
    "end": "248080"
  },
  {
    "text": "this tool for finding iot malware cncs uh the way we do this is by activating",
    "start": "248080",
    "end": "254159"
  },
  {
    "text": "the iot malware meaning that we actually execute the malware we let it communicate with the outside world",
    "start": "254159",
    "end": "261040"
  },
  {
    "text": "and uh we use many-in-the-middle techniques to redirect the cnc traffic to some uh",
    "start": "261040",
    "end": "268800"
  },
  {
    "text": "candidate addresses these addresses are inputs we suspect that they might host",
    "start": "268800",
    "end": "273919"
  },
  {
    "text": "uh cnc servers right uh with that uh this is the overview of",
    "start": "273919",
    "end": "279520"
  },
  {
    "start": "277000",
    "end": "330000"
  },
  {
    "text": "the talk we are gonna cover some basics and then we are going to spend the rest of the talk uh",
    "start": "279520",
    "end": "285280"
  },
  {
    "text": "discussing cnc hunter design and implementation okay so let's start with iot communication",
    "start": "285280",
    "end": "292240"
  },
  {
    "text": "protocols now i don't want you to read over the text and learn every bit of uh",
    "start": "292240",
    "end": "297919"
  },
  {
    "text": "detail about the iot malware communication protocols what i want you to see though is that the",
    "start": "297919",
    "end": "305039"
  },
  {
    "text": "communication protocols are kind of diverse here right so we have custom",
    "start": "305039",
    "end": "310240"
  },
  {
    "text": "application layer protocols that are binary based some are text-based we have",
    "start": "310240",
    "end": "315520"
  },
  {
    "text": "sometimes encryption and this really makes generic probing very hard right if we were dealing with",
    "start": "315520",
    "end": "322160"
  },
  {
    "text": "only one application layer protocol then probably we could design a probing technique and scandinavia right and",
    "start": "322160",
    "end": "330000"
  },
  {
    "start": "330000",
    "end": "447000"
  },
  {
    "text": "scanning and you know actively probing is very important here",
    "start": "330000",
    "end": "336000"
  },
  {
    "text": "uh if you look at the communication protocols then uh within a single family what we",
    "start": "336000",
    "end": "343280"
  },
  {
    "text": "find is that they barely change right so what i'm going to show you in this slide is",
    "start": "343280",
    "end": "349039"
  },
  {
    "text": "a generic irc say server communication with a gasket malware sample",
    "start": "349039",
    "end": "356080"
  },
  {
    "text": "uh this is not the cnc server for the sample right",
    "start": "356080",
    "end": "361199"
  },
  {
    "text": "but uh we made the sample talk to this generic irc server and it actually",
    "start": "361199",
    "end": "366400"
  },
  {
    "text": "successfully communicated with it right the reason we chose gaffit is because it's textbit so it's easier for you to",
    "start": "366400",
    "end": "373600"
  },
  {
    "text": "follow so the communication starts with the tcp handshake and after the tcp handshake",
    "start": "373600",
    "end": "379680"
  },
  {
    "text": "the malware sends the irc nic command right the server",
    "start": "379680",
    "end": "385280"
  },
  {
    "text": "responds and after that the malware sends a mode request right this is again",
    "start": "385280",
    "end": "391360"
  },
  {
    "text": "an irc command the server responds and again uh the malware communicates it at",
    "start": "391360",
    "end": "397520"
  },
  {
    "text": "this time it sends a join command says i want to join this irc channel the server again responds and then the malware",
    "start": "397520",
    "end": "404319"
  },
  {
    "text": "finishes with a who request right to which again the server responds now here's the",
    "start": "404319",
    "end": "410800"
  },
  {
    "text": "interesting fact using the same irc uh server it's a it's a generic server again it's",
    "start": "410800",
    "end": "417840"
  },
  {
    "text": "not a cnc server we could communicate with 99.5 percent of the gasket samples right",
    "start": "417840",
    "end": "425599"
  },
  {
    "text": "and this is very exciting because this provides an opportunity for us right",
    "start": "425599",
    "end": "431039"
  },
  {
    "text": "only with one gasket sample possibly old right uh years uh four years old malware samples",
    "start": "431039",
    "end": "439440"
  },
  {
    "text": "we can search go and search for the cnc servers that are live right for the",
    "start": "439440",
    "end": "444800"
  },
  {
    "text": "entire family and we need to do this because uh probably we are not aware of most of the",
    "start": "444800",
    "end": "451759"
  },
  {
    "start": "447000",
    "end": "527000"
  },
  {
    "text": "cnc servers that are live and we didn't know they exist so what we did we manually",
    "start": "451759",
    "end": "458479"
  },
  {
    "text": "analyzed 100 iot samples and we found their cnc servers right we started with",
    "start": "458479",
    "end": "464319"
  },
  {
    "text": "the samples that were four years old and what we found is that only 3.5 of",
    "start": "464319",
    "end": "470800"
  },
  {
    "text": "the samples have a live cnc server right so we reduce the age of the malware",
    "start": "470800",
    "end": "477039"
  },
  {
    "text": "and this time we analyzed samples that were 142 days old in this case uh none of the",
    "start": "477039",
    "end": "485199"
  },
  {
    "text": "samples had a live cnc server we continued we again reduced the age of",
    "start": "485199",
    "end": "491039"
  },
  {
    "text": "the malware by one order of magnitude and this times this time we analyze samples that",
    "start": "491039",
    "end": "498400"
  },
  {
    "text": "were two weeks old and in this case 14 of the samples had a live cnc server the",
    "start": "498400",
    "end": "504400"
  },
  {
    "text": "the best we could do or you could do is analyzing samples that are one day old",
    "start": "504400",
    "end": "510160"
  },
  {
    "text": "and in this case uh roughly half of the samples had a live cnc server what this means is",
    "start": "510160",
    "end": "517200"
  },
  {
    "text": "that half of the other samples have a cnc seller that already moved to a new",
    "start": "517200",
    "end": "523518"
  },
  {
    "text": "location right uh so these samples are hidden and we",
    "start": "523519",
    "end": "529279"
  },
  {
    "start": "527000",
    "end": "840000"
  },
  {
    "text": "need to actually actively probe the internet and find them and with this i'm going to",
    "start": "529279",
    "end": "534800"
  },
  {
    "text": "give the floor to my friend ahmad turkey thank you ali",
    "start": "534800",
    "end": "540399"
  },
  {
    "text": "so in this part we're going to look into what are the active research or whatever has been",
    "start": "540399",
    "end": "546240"
  },
  {
    "text": "done previously in identifying live cnc servers so there is this concept of",
    "start": "546240",
    "end": "552320"
  },
  {
    "text": "active probing you send out certain traffic to the internet and doing scanning and then when there is a",
    "start": "552320",
    "end": "558720"
  },
  {
    "text": "successful connection or there's a successful uh communication in general",
    "start": "558720",
    "end": "563920"
  },
  {
    "text": "you deem uh the endpoint as a potential cnc server now we're gonna look into this from an",
    "start": "563920",
    "end": "570720"
  },
  {
    "text": "iot uh malware perspective we're gonna look into mirai malware mirai had been",
    "start": "570720",
    "end": "577360"
  },
  {
    "text": "uh notoriously famous for their uh the volumetric uh ddos attack that they",
    "start": "577360",
    "end": "583440"
  },
  {
    "text": "carried out in both september 2016 on kryptonsecurity.com",
    "start": "583440",
    "end": "588880"
  },
  {
    "text": "and october 2016 when they carried out the biggest ddos attack on dying dns and",
    "start": "588880",
    "end": "595680"
  },
  {
    "text": "resulted in disrupting github twitter and some of the major uh you know services like spotify shopify and all of",
    "start": "595680",
    "end": "603360"
  },
  {
    "text": "those and the source code was released and that led to a lot more",
    "start": "603360",
    "end": "608640"
  },
  {
    "text": "malware samples coming from this malware family that you can see it in any",
    "start": "608640",
    "end": "615440"
  },
  {
    "text": "malware repositories that the malware family with the highest number of samples is something like",
    "start": "615440",
    "end": "623040"
  },
  {
    "text": "exactly mirai so we're going to look into how does the communication look like when a malware",
    "start": "623040",
    "end": "630560"
  },
  {
    "text": "like mirai infects a an iot device and how does an active probing would look",
    "start": "630560",
    "end": "635760"
  },
  {
    "text": "like so for an active probing say an infection has happened and",
    "start": "635760",
    "end": "640880"
  },
  {
    "text": "malware will send out after initiating a scene the tcp connection with the cnc server it will",
    "start": "640880",
    "end": "647920"
  },
  {
    "text": "send out a byte pattern uh for in this example it's it could be",
    "start": "647920",
    "end": "653519"
  },
  {
    "text": "zero zero zeros and the one at the end and then the server acts the whatever",
    "start": "653519",
    "end": "658720"
  },
  {
    "text": "packet it receives and then uh it uh the bot would proceed with authenticating",
    "start": "658720",
    "end": "664079"
  },
  {
    "text": "itself sort of like sending certain patterns so that the cnc server would know this is a button",
    "start": "664079",
    "end": "669600"
  },
  {
    "text": "um a botnet instance and then uh it will continue the connection and they will uh",
    "start": "669600",
    "end": "676560"
  },
  {
    "text": "maintain the connection like going back and forth like something like a ping pong and after that when there is a successful uh recruitment of the butt",
    "start": "676560",
    "end": "683839"
  },
  {
    "text": "the cnc will command the uh bob to for instance start doing a dos attack or or",
    "start": "683839",
    "end": "690240"
  },
  {
    "text": "something like that on crimson security for instance on certain port so this is how the active probing would",
    "start": "690240",
    "end": "696720"
  },
  {
    "text": "look like on the other hand we do things a little bit differently we look into",
    "start": "696720",
    "end": "702320"
  },
  {
    "text": "actually using a malware malwarebinder and sets of ip address uh and then port numbers",
    "start": "702320",
    "end": "709440"
  },
  {
    "text": "to do the probing for us and the way we are doing it we pro uh we",
    "start": "709440",
    "end": "715040"
  },
  {
    "text": "look into the malware using some static analysis uh information to create an",
    "start": "715040",
    "end": "720320"
  },
  {
    "text": "effective emulation mechanism so that we can have the malware start executing properly and then we do the recording on",
    "start": "720320",
    "end": "727600"
  },
  {
    "text": "this traffic and we uh identify what is what is the cnc server is trying to communicate with and then we redirect",
    "start": "727600",
    "end": "733839"
  },
  {
    "text": "that to the input ip addresses that uh we have",
    "start": "733839",
    "end": "738959"
  },
  {
    "text": "so going a little bit into details of how the sandbox and the profile module would look like so in this project we're using",
    "start": "738959",
    "end": "746720"
  },
  {
    "text": "kmu kmu enables emulating",
    "start": "746720",
    "end": "752240"
  },
  {
    "text": "some of the not common cpu architectures like mips power pc or mips cell",
    "start": "752240",
    "end": "758800"
  },
  {
    "text": "so this is something that we chose to go with um and then we are uh we are attaching kernel to it so that",
    "start": "758800",
    "end": "765600"
  },
  {
    "text": "we will have the kenya running and then we will also attach file system to it this will allow us to have",
    "start": "765600",
    "end": "772560"
  },
  {
    "text": "some sort of a recording and snapshotting of whatever uh the",
    "start": "772560",
    "end": "777680"
  },
  {
    "text": "malware is doing in the recording it's you know a system called traces um and",
    "start": "777680",
    "end": "783600"
  },
  {
    "text": "so on and so forth we also attach a tap device to",
    "start": "783600",
    "end": "789040"
  },
  {
    "text": "the 2k mute so that we can redirect the traffic to the proxy that",
    "start": "789040",
    "end": "795279"
  },
  {
    "text": "later we will get into and tap device would also allow us to",
    "start": "795279",
    "end": "801279"
  },
  {
    "text": "do a recording of network traffic and later we will what we call it up",
    "start": "801279",
    "end": "806800"
  },
  {
    "text": "implanting the malware into the uh emulation so that uh so that we can uh",
    "start": "806800",
    "end": "814399"
  },
  {
    "text": "realistically execute the malware collected and then recorded system called traces",
    "start": "814399",
    "end": "821519"
  },
  {
    "text": "and have everything uh collected like execution uh is entirely collected via",
    "start": "821519",
    "end": "827920"
  },
  {
    "text": "the profiler which will later on will be fed into other",
    "start": "827920",
    "end": "832959"
  },
  {
    "text": "parts of the cnc hunter with that i will yield back to ali",
    "start": "832959",
    "end": "838639"
  },
  {
    "text": "please ali take it away thank you ahmed uh so",
    "start": "838639",
    "end": "843839"
  },
  {
    "start": "840000",
    "end": "1130000"
  },
  {
    "text": "for the rest of the talk i'm gonna uh discuss the details of the mitm",
    "start": "843839",
    "end": "848880"
  },
  {
    "text": "component and already covered the sandbox component of cnc hunter",
    "start": "848880",
    "end": "854320"
  },
  {
    "text": "uh the goal of uh demanding the middle component mitm component is to redirect",
    "start": "854320",
    "end": "859600"
  },
  {
    "text": "the cnc traffic to candidate addresses as we mentioned a few times these candidate addresses are inputs right we",
    "start": "859600",
    "end": "867279"
  },
  {
    "text": "suspect that they are hosting cnc uh servers the man in the middle",
    "start": "867279",
    "end": "873519"
  },
  {
    "text": "is ip based here and uh we are gonna tap the traffic and",
    "start": "873519",
    "end": "880480"
  },
  {
    "text": "also provide internet from the sammers right uh so we are actually men in the middling the real traffic that goes to",
    "start": "880480",
    "end": "887279"
  },
  {
    "text": "internet all right so let's start with uh the design alternatives that we have",
    "start": "887279",
    "end": "893519"
  },
  {
    "text": "uh for placing the mitm module right where should we place this mitm module we have",
    "start": "893519",
    "end": "900320"
  },
  {
    "text": "the sandbox module right the maverick executes there you also have the network perimeter and that uh as i said proxies",
    "start": "900320",
    "end": "909600"
  },
  {
    "text": "the traffic to the internet right zooming in uh the sandbox component",
    "start": "909600",
    "end": "916079"
  },
  {
    "text": "there are different parts there is the qmu component that runs the an operating system with the malware that malware",
    "start": "916079",
    "end": "923519"
  },
  {
    "text": "executes in the user space and for every network request it sends the request to",
    "start": "923519",
    "end": "929279"
  },
  {
    "text": "the network driver which resides in the os kernel and this network driver driver",
    "start": "929279",
    "end": "935440"
  },
  {
    "text": "closely communicates with the sandbox driver handler right three of the design alternatives that we",
    "start": "935440",
    "end": "942160"
  },
  {
    "text": "have uh would be placing the mitm module",
    "start": "942160",
    "end": "947680"
  },
  {
    "text": "uh at this sandbox component different parts of the sandbox component they",
    "start": "947680",
    "end": "954079"
  },
  {
    "text": "suffer all from the same problem and the problem is that if we wanted to",
    "start": "954079",
    "end": "960000"
  },
  {
    "text": "go for a solution like this we had to provide an implementation for every",
    "start": "960000",
    "end": "967440"
  },
  {
    "text": "different you know implementation that there is for the layer for instance different",
    "start": "967440",
    "end": "973279"
  },
  {
    "text": "operating systems uh on the other hand we can you know place the mi atm module",
    "start": "973279",
    "end": "980639"
  },
  {
    "text": "at the network perimeter and this is our choice it doesn't have the previous problems",
    "start": "980639",
    "end": "985839"
  },
  {
    "text": "right so uh we would place the mitm module at the network perimeter and",
    "start": "985839",
    "end": "992880"
  },
  {
    "text": "our goal is to replace the original cnc address that the malware tries to",
    "start": "992880",
    "end": "998160"
  },
  {
    "text": "communicate with with the candidate address right and this candidate address is an input",
    "start": "998160",
    "end": "1004320"
  },
  {
    "text": "so if we were to write the rule for ip tables it would look like this right we would simply tell iptables to",
    "start": "1004320",
    "end": "1011920"
  },
  {
    "text": "replace the uh original rp address with the input ip address that we want right",
    "start": "1011920",
    "end": "1018480"
  },
  {
    "text": "however this wouldn't work right uh we spent quite some time trying to",
    "start": "1018480",
    "end": "1023600"
  },
  {
    "text": "figure out how we can you know make iptel ip tables work and do this by default ip",
    "start": "1023600",
    "end": "1029678"
  },
  {
    "text": "tables wouldn't allow this so we are stuck right what should we do",
    "start": "1029679",
    "end": "1034880"
  },
  {
    "text": "and uh after you know some time and kind of banging our head we",
    "start": "1034880",
    "end": "1041438"
  },
  {
    "text": "came up with a creative solution the solution is to move the iep tables from the network perimeter to the sandbox and",
    "start": "1041439",
    "end": "1048799"
  },
  {
    "text": "if we do so then we can change the rule to from the post routing chain to the",
    "start": "1048799",
    "end": "1055440"
  },
  {
    "text": "output chain and then this works right this allows us to uh replace the ip address with something",
    "start": "1055440",
    "end": "1062080"
  },
  {
    "text": "that we want great now we have the man in the middle functionality we can",
    "start": "1062080",
    "end": "1067360"
  },
  {
    "text": "redirect the traffic but how about the dns based cnc addresses right as i said",
    "start": "1067360",
    "end": "1073200"
  },
  {
    "text": "iptables is ip based we don't know anything about dns in iep tables how can",
    "start": "1073200",
    "end": "1078720"
  },
  {
    "text": "we handle dns based cnc addresses and the answer is we need to manipulate the",
    "start": "1078720",
    "end": "1084799"
  },
  {
    "text": "local dns resolution process we actually need to resolve the cnc dns address the",
    "start": "1084799",
    "end": "1091360"
  },
  {
    "text": "original uh address dns address that the malware tries to communicate with",
    "start": "1091360",
    "end": "1096720"
  },
  {
    "text": "uh with the candidate address right that we provide uh how do we do that so it turns out",
    "start": "1096720",
    "end": "1104160"
  },
  {
    "text": "there's a uh we tried different things the clean and easy solution is to change the",
    "start": "1104160",
    "end": "1111200"
  },
  {
    "text": "uh host file uh on the guest operating system and add",
    "start": "1111200",
    "end": "1116559"
  },
  {
    "text": "a line that says in the host file that says translate resolve this dns address",
    "start": "1116559",
    "end": "1123039"
  },
  {
    "text": "to the candidate ip address again the candidate address is suspected to host the cnc server",
    "start": "1123039",
    "end": "1129440"
  },
  {
    "text": "great okay so we have the mitm function already the next question is what traffic should be redirected right",
    "start": "1129440",
    "end": "1136880"
  },
  {
    "text": "uh probably you know it by now only the traffic to the cnc but is it the only",
    "start": "1136880",
    "end": "1142000"
  },
  {
    "text": "traffic that the malware generates the answer is no right so there are other types of traffic that the matter would",
    "start": "1142000",
    "end": "1147919"
  },
  {
    "text": "generate there's the traffic for scanning the malware goes and scan different ports to find vulnerable hosts",
    "start": "1147919",
    "end": "1154480"
  },
  {
    "text": "and you know infect them as well there's the background traffic that comes from the virtual machine and every now and",
    "start": "1154480",
    "end": "1160240"
  },
  {
    "text": "then the malware some malware uh generated random traffic to for instance",
    "start": "1160240",
    "end": "1165520"
  },
  {
    "text": "google or other addresses so fun finding the traffic is to the cnc is actually",
    "start": "1165520",
    "end": "1171600"
  },
  {
    "text": "not trivial uh here you can see a snapshot of the new",
    "start": "1171600",
    "end": "1177120"
  },
  {
    "text": "uh traffic you know this is just a portion of the traffic that mirai generates there is the cnc address in",
    "start": "1177120",
    "end": "1184240"
  },
  {
    "text": "this traffic and what we are going to do we are going to start uh from some observations right",
    "start": "1184240",
    "end": "1190880"
  },
  {
    "text": "something some observations that we have about the cnc traffic cnc address",
    "start": "1190880",
    "end": "1196799"
  },
  {
    "text": "uh so the logic here is that the cnc address is",
    "start": "1196799",
    "end": "1202480"
  },
  {
    "text": "going to be contacted quite uh frequently by the malware and the port that the",
    "start": "1202480",
    "end": "1208960"
  },
  {
    "text": "cnc address has right the cnc server has is kind of unique now if you take all",
    "start": "1208960",
    "end": "1214400"
  },
  {
    "text": "the ports that the malware tries to communicate with the one that belongs to the cnc server is kind of unique there",
    "start": "1214400",
    "end": "1221120"
  },
  {
    "text": "are the details i'm not going to cover them now but let's go to the you know the main",
    "start": "1221120",
    "end": "1227280"
  },
  {
    "text": "part that is the frequency of the connection to the cnc address and the port",
    "start": "1227280",
    "end": "1234640"
  },
  {
    "text": "so what we are going to use is the parshark for the traffic analysis and we would have an algorithm that",
    "start": "1234640",
    "end": "1241600"
  },
  {
    "start": "1235000",
    "end": "1285000"
  },
  {
    "text": "helps us identify the cnc address so what we are going to do we are going to assign a score to each iv address in the",
    "start": "1241600",
    "end": "1248559"
  },
  {
    "text": "malware traffic and the s core is based on the observations that i just mentioned right we know that this score",
    "start": "1248559",
    "end": "1255440"
  },
  {
    "text": "is proportionally related to the connection frequency and it's inversely",
    "start": "1255440",
    "end": "1260799"
  },
  {
    "text": "proportional to the port frequency right so we can uh write this simple formula",
    "start": "1260799",
    "end": "1266080"
  },
  {
    "text": "that the score uh is a connection frequency over port frequency times a coefficient right and",
    "start": "1266080",
    "end": "1273679"
  },
  {
    "text": "the cnc address is the one that has the highest score",
    "start": "1273679",
    "end": "1279039"
  },
  {
    "text": "right great so now we have this formula how do we calculate connection frequency",
    "start": "1279039",
    "end": "1284559"
  },
  {
    "text": "and port frequency we have two data structures uh we store the connection frequency and port",
    "start": "1284559",
    "end": "1291039"
  },
  {
    "start": "1285000",
    "end": "1342000"
  },
  {
    "text": "frequency in these data structures so the first data structure stores the data about the connection frequency uh we",
    "start": "1291039",
    "end": "1298559"
  },
  {
    "text": "would have the ip port cards and also the dns addresses that the malware tries",
    "start": "1298559",
    "end": "1304000"
  },
  {
    "text": "to communicate with for each of these addresses we keep track of the number of",
    "start": "1304000",
    "end": "1309039"
  },
  {
    "text": "times that the rst flag the syn flag and the act flag were on and also the number",
    "start": "1309039",
    "end": "1314080"
  },
  {
    "text": "of times that the dns address could not be found right this gives us the connection",
    "start": "1314080",
    "end": "1320559"
  },
  {
    "text": "frequency for the port frequency we have another uh hash table",
    "start": "1320559",
    "end": "1325600"
  },
  {
    "text": "it maps port numbers to the number of times that they were seen in the malware traffic right",
    "start": "1325600",
    "end": "1332400"
  },
  {
    "text": "using these two uh parameters we can calculate the score for each address and you know find the",
    "start": "1332400",
    "end": "1339039"
  },
  {
    "text": "one that has the highest score that one is the cnc there are other details based",
    "start": "1339039",
    "end": "1344240"
  },
  {
    "start": "1342000",
    "end": "1357000"
  },
  {
    "text": "on other observations that i mentioned i'm not covering them here but our source code is uh open source so",
    "start": "1344240",
    "end": "1351520"
  },
  {
    "text": "you can go check it out you have the port filtering and the reputation filtering functionalities",
    "start": "1351520",
    "end": "1357760"
  },
  {
    "start": "1357000",
    "end": "1397000"
  },
  {
    "text": "okay great so now cnc hunter can redirect the cnc traffic to some candidate addresses right",
    "start": "1357760",
    "end": "1365280"
  },
  {
    "text": "but which of these candidate addresses is a cnc right again this is not a trivial",
    "start": "1365280",
    "end": "1372320"
  },
  {
    "text": "uh problem uh because not only the cnc server uh would",
    "start": "1372320",
    "end": "1378799"
  },
  {
    "text": "communicate back right would respond to our request as a matter of fact every",
    "start": "1378799",
    "end": "1384400"
  },
  {
    "text": "address that is live every ip address that is live listens to our target port and is not filtered",
    "start": "1384400",
    "end": "1390880"
  },
  {
    "text": "will respond right so which one is the cnc server",
    "start": "1390880",
    "end": "1398158"
  },
  {
    "start": "1397000",
    "end": "1456000"
  },
  {
    "text": "the criteria that i just mentioned could be uh simply filtered based on the you",
    "start": "1398320",
    "end": "1403679"
  },
  {
    "text": "know tcp communication the tcp layer if there is a response of course we can see",
    "start": "1403679",
    "end": "1408960"
  },
  {
    "text": "that the ip address is live uh listens we can check whether the tcp handshake",
    "start": "1408960",
    "end": "1414080"
  },
  {
    "text": "is successful and for being not filtered we can check the rc flag but rd is enough",
    "start": "1414080",
    "end": "1421039"
  },
  {
    "text": "uh no right uh for instance in this example we have two addresses that listen on port",
    "start": "1421039",
    "end": "1428080"
  },
  {
    "text": "443 right the first one is a cnc server but the second one uh happens to",
    "start": "1428080",
    "end": "1434480"
  },
  {
    "text": "randomly you know listen on the port that you're interested in 443 and in this case probably it's a",
    "start": "1434480",
    "end": "1441200"
  },
  {
    "text": "https web server but anyway it would respond it would respond to our requests right",
    "start": "1441200",
    "end": "1448159"
  },
  {
    "text": "so how can we distinguish the first one from the second one we are on we are",
    "start": "1448159",
    "end": "1453360"
  },
  {
    "text": "only interested in the first address right what we found what we observed is that",
    "start": "1453360",
    "end": "1458960"
  },
  {
    "start": "1456000",
    "end": "1515000"
  },
  {
    "text": "the cnc's respond with significantly lower uh number of times that the sim",
    "start": "1458960",
    "end": "1465120"
  },
  {
    "text": "flag is set right and in order to understand this think about the human",
    "start": "1465120",
    "end": "1470320"
  },
  {
    "text": "communication right if two individuals are chatting and they don't understand each other what would they do right they",
    "start": "1470320",
    "end": "1477080"
  },
  {
    "text": "restart they repeat themselves and the way that this pattern appears in network",
    "start": "1477080",
    "end": "1483039"
  },
  {
    "text": "communication is by resetting the syn flag right uh setting it again and",
    "start": "1483039",
    "end": "1488640"
  },
  {
    "text": "sending the packet uh out uh so we are finding the uh",
    "start": "1488640",
    "end": "1494720"
  },
  {
    "text": "communications with lower number of uh times that the sim flag is on the way we",
    "start": "1494720",
    "end": "1500240"
  },
  {
    "text": "do that is by doing outlier detection based on a standard deviation it's a",
    "start": "1500240",
    "end": "1505919"
  },
  {
    "text": "very simple formula we just calculate the standard deviation and we find those that you know are on the lower back okay",
    "start": "1505919",
    "end": "1515919"
  },
  {
    "start": "1515000",
    "end": "1563000"
  },
  {
    "text": "we evaluated cnc hunter on a set of 100 samples we evaluated the",
    "start": "1515919",
    "end": "1521679"
  },
  {
    "text": "cnc finding functionality we could activate 90 of the samples that",
    "start": "1521679",
    "end": "1527600"
  },
  {
    "text": "be analyzed and out of this uh we could achieve a precision of 92 percent right",
    "start": "1527600",
    "end": "1533600"
  },
  {
    "text": "this is pretty much very accurate right uh and i'm glad to say that",
    "start": "1533600",
    "end": "1539760"
  },
  {
    "text": "18 of the live cnc servers that we found were exclusively found by us right the",
    "start": "1539760",
    "end": "1547200"
  },
  {
    "text": "other 82 percent also via solo reports as malicious but uh these",
    "start": "1547200",
    "end": "1553039"
  },
  {
    "text": "18 percent were only found by us if you check them on virustotal uh",
    "start": "1553039",
    "end": "1558559"
  },
  {
    "text": "they are not reported malicious okay great so uh",
    "start": "1558559",
    "end": "1564480"
  },
  {
    "start": "1563000",
    "end": "1960000"
  },
  {
    "text": "i'm gonna start the demos now we are gonna have two demos the first demo uh is for finding the cnc server of",
    "start": "1564480",
    "end": "1572960"
  },
  {
    "text": "the sample right so we provide an iot malware binary we know nothing about this malware binder right we don't know",
    "start": "1572960",
    "end": "1579840"
  },
  {
    "text": "the architecture we don't know the malware family we don't know anything about the traffic that it generates you",
    "start": "1579840",
    "end": "1585760"
  },
  {
    "text": "know the ports that it tries to scan and then exploit nothing and uh we don't provide any",
    "start": "1585760",
    "end": "1592960"
  },
  {
    "text": "configuration for cnc hunter we just run this script and it reports the cnc server",
    "start": "1592960",
    "end": "1598799"
  },
  {
    "text": "uh for the second demo we go one step further and what we do is",
    "start": "1598799",
    "end": "1604960"
  },
  {
    "text": "provide uh some ip addresses that that we suspect are hosting a cnc server",
    "start": "1604960",
    "end": "1613760"
  },
  {
    "text": "and we are using old samples you are using four years old gasket samples we",
    "start": "1613760",
    "end": "1619200"
  },
  {
    "text": "expect these gasket samples to communicate with the addresses that are",
    "start": "1619200",
    "end": "1624480"
  },
  {
    "text": "hosting a cnc server right and this is very exciting right the they they have a",
    "start": "1624480",
    "end": "1629840"
  },
  {
    "text": "dead cnc server they would not communicate generate any traffic but we met in the middle and we want to see",
    "start": "1629840",
    "end": "1636080"
  },
  {
    "text": "whether they can successfully communicate these addresses if they do these addresses are hosting cnc server",
    "start": "1636080",
    "end": "1643200"
  },
  {
    "text": "okay so let's start from the uh first demo so here i'm placing the",
    "start": "1643200",
    "end": "1650399"
  },
  {
    "text": "binary in the malware malware folder this is a mirai sample i'm telling you",
    "start": "1650399",
    "end": "1655440"
  },
  {
    "text": "that it's memorized samples so you know but i'm not providing this information to cnc hunter uh the command is just",
    "start": "1655440",
    "end": "1663039"
  },
  {
    "text": "running this script around that py i'm using the p option this is for filtering",
    "start": "1663039",
    "end": "1669760"
  },
  {
    "text": "the ports that we are not interested in right i'm just showing you that we have this",
    "start": "1669760",
    "end": "1675919"
  },
  {
    "text": "option but even without providing these options since your hunter is able to",
    "start": "1675919",
    "end": "1681039"
  },
  {
    "text": "find the cnc address for you right so what cnc hunter does is analyzing the",
    "start": "1681039",
    "end": "1687360"
  },
  {
    "text": "executing the matter and analyzing the traffic that it generates so let's take a look at the traffic that",
    "start": "1687360",
    "end": "1694080"
  },
  {
    "text": "is generated uh i'm gonna fire wireshark and take a look at the p-cap",
    "start": "1694080",
    "end": "1700640"
  },
  {
    "text": "traffic that is generated this is the traffic that the mirai malware generates right and as you can see by yourself",
    "start": "1700640",
    "end": "1707039"
  },
  {
    "text": "there are lots of ip addresses right these are the scanning activities that the malware has",
    "start": "1707039",
    "end": "1713039"
  },
  {
    "text": "there is the cnc communication uh the analysis is going to take time by",
    "start": "1713039",
    "end": "1718480"
  },
  {
    "text": "default uh by default we spent five minutes but here i'm gonna fast forward",
    "start": "1718480",
    "end": "1724000"
  },
  {
    "text": "boom we found the cnc address and here in this case it's a dns based address",
    "start": "1724000",
    "end": "1729679"
  },
  {
    "text": "it's a live cnc server because the malware was recent and we are going to check the dns",
    "start": "1729679",
    "end": "1737120"
  },
  {
    "text": "address in virustotal and the virustotal reports that it's not malicious right we",
    "start": "1737120",
    "end": "1742559"
  },
  {
    "text": "are aware that this is not like the ultimate uh oracle but we are just saying that uh",
    "start": "1742559",
    "end": "1749919"
  },
  {
    "text": "this is what we see on virustotal all right uh the address is also",
    "start": "1749919",
    "end": "1755520"
  },
  {
    "text": "reported in the in a csv format this is very useful if you have you know",
    "start": "1755520",
    "end": "1760799"
  },
  {
    "text": "uh a bunch of binaries not only one you can see the report at the end in the",
    "start": "1760799",
    "end": "1766159"
  },
  {
    "text": "cnc's that csv file we also have an analysis folder under the result uh directory with the",
    "start": "1766159",
    "end": "1773679"
  },
  {
    "text": "name of the malware and there you have the pcap traffic and also the system",
    "start": "1773679",
    "end": "1778960"
  },
  {
    "text": "call trace for the malware execution uh i'm gonna move to the second demo now",
    "start": "1778960",
    "end": "1786159"
  },
  {
    "text": "and in this demo as i mentioned we are using the uh man in the middle functionality right so in addition to",
    "start": "1786159",
    "end": "1793120"
  },
  {
    "text": "the malware that we provide these are the matter that we use for the mitm attack these are two",
    "start": "1793120",
    "end": "1799120"
  },
  {
    "text": "four years old gasket samples and we are also uh providing an ip atlas in",
    "start": "1799120",
    "end": "1804799"
  },
  {
    "text": "practice it would be a wrench but since you know we don't have enough time i'm going to just show you",
    "start": "1804799",
    "end": "1810159"
  },
  {
    "text": "uh the communication with the you know candidate address that is hosting the cnc cnc server",
    "start": "1810159",
    "end": "1816240"
  },
  {
    "text": "again the analysis starts by uh finding the cnc address of these two samples",
    "start": "1816240",
    "end": "1823200"
  },
  {
    "text": "it's going to take time but here we are going to fast forward uh boom we found the cnc address of the",
    "start": "1823200",
    "end": "1831120"
  },
  {
    "text": "uh these samples now in the next step what we are gonna do we are gonna redirect the uh cnc",
    "start": "1831120",
    "end": "1839679"
  },
  {
    "text": "traffic right it would go to these addresses by default but we are gonna redirect this traffic man in the middle",
    "start": "1839679",
    "end": "1846240"
  },
  {
    "text": "and send the traffic to uh the candidate address right if you",
    "start": "1846240",
    "end": "1852240"
  },
  {
    "text": "provide a range in each iteration one of these addresses would be tried but here it's only a single address",
    "start": "1852240",
    "end": "1859120"
  },
  {
    "text": "uh so the malware tries to communicate with this hyper atlas and you're gonna",
    "start": "1859120",
    "end": "1865039"
  },
  {
    "text": "analyze their traffic again it's gonna take time but you're gonna hear fast forward",
    "start": "1865039",
    "end": "1870159"
  },
  {
    "text": "uh great perfect we found the successful communication",
    "start": "1870159",
    "end": "1876159"
  },
  {
    "text": "it still gives me goosebumps this is really exciting right so we found a live cnc server",
    "start": "1876159",
    "end": "1882799"
  },
  {
    "text": "right by using a four years old gasket sample right the malware would have talked to a",
    "start": "1882799",
    "end": "1888640"
  },
  {
    "text": "different cnc server it would have been that but here no we used it to find a",
    "start": "1888640",
    "end": "1893679"
  },
  {
    "text": "real cnc server and now i'm gonna show you the traffic if you see the traffic",
    "start": "1893679",
    "end": "1898799"
  },
  {
    "text": "since it's text based you would find by yourself that it's actually a successful communication",
    "start": "1898799",
    "end": "1906159"
  },
  {
    "text": "so let's take a look at the pcap traffic",
    "start": "1906159",
    "end": "1911039"
  },
  {
    "text": "this is the traffic that is generated the malware starts by doing the tcp handshake",
    "start": "1911600",
    "end": "1918399"
  },
  {
    "text": "and uh after the tcp handshake uh there's this command that the malware",
    "start": "1918399",
    "end": "1924640"
  },
  {
    "text": "sends sorry for the language builddonk and the server responds with an act says i",
    "start": "1924640",
    "end": "1931519"
  },
  {
    "text": "got it and then here's the interesting part the server sends the pin command right to",
    "start": "1931519",
    "end": "1938320"
  },
  {
    "text": "the malware and the malware response with the punch great so this shows the successful",
    "start": "1938320",
    "end": "1943679"
  },
  {
    "text": "exploitation of the malware and the mitm attack and with that we actually found a live",
    "start": "1943679",
    "end": "1950159"
  },
  {
    "text": "cnc server using four years old gasket samples it's very exciting",
    "start": "1950159",
    "end": "1955360"
  },
  {
    "text": "uh okay so this is the demo that we had we would be really happy to collaborate",
    "start": "1955360",
    "end": "1962799"
  },
  {
    "start": "1960000",
    "end": "2067000"
  },
  {
    "text": "if you're interested in if you have an active honeypot uh or have you know iot devices file systems",
    "start": "1962799",
    "end": "1970880"
  },
  {
    "text": "for different architectures if you have intelligence on iot malware cnc is we would really appreciate it we could use",
    "start": "1970880",
    "end": "1977360"
  },
  {
    "text": "that in for for evaluating our system or if you just use our tool and you have feedback for us",
    "start": "1977360",
    "end": "1983600"
  },
  {
    "text": "we would be very happy to talk to you and if you have insight also on iot",
    "start": "1983600",
    "end": "1988880"
  },
  {
    "text": "madwear antivirus evasion that's something that we want to you know support in future please talk to us",
    "start": "1988880",
    "end": "1995919"
  },
  {
    "text": "uh a shout out to martina lindelofer she's collaborating with us",
    "start": "1995919",
    "end": "2001440"
  },
  {
    "text": "uh also to virustotal for providing us the samples i am ali davanian i will be in the job",
    "start": "2001440",
    "end": "2008000"
  },
  {
    "text": "market in six months if you're looking for additions to your team please talk to me",
    "start": "2008000",
    "end": "2013120"
  },
  {
    "text": "and with that i'm gonna conclude the uh presentation uh so in short we need to proactively",
    "start": "2013120",
    "end": "2019679"
  },
  {
    "text": "scan the internet and find the cnc servers and that's because cnc servers are very short-lived they are hidden",
    "start": "2019679",
    "end": "2026799"
  },
  {
    "text": "from us just by analyzing the samples we cannot find all of them and since iot",
    "start": "2026799",
    "end": "2032880"
  },
  {
    "text": "communication protocols are diverse and complex we need to use their real malware right to have a generic solution",
    "start": "2032880",
    "end": "2039679"
  },
  {
    "text": "and that's what cnc hunter does for you right we do cnc discovery using the man in the middling and i i'm happy to tell",
    "start": "2039679",
    "end": "2048320"
  },
  {
    "text": "you that cnc hunter is fully automated as i showed you you don't need to provide any configuration just the",
    "start": "2048320",
    "end": "2054240"
  },
  {
    "text": "malware and your ip address branch and it's open source uh please use it use it and give us",
    "start": "2054240",
    "end": "2061440"
  },
  {
    "text": "feedback thank you very much and with that we are gonna take the questions",
    "start": "2061440",
    "end": "2069240"
  }
]