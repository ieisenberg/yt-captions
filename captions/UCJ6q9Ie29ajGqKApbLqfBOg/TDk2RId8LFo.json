[
  {
    "start": "0",
    "end": "29000"
  },
  {
    "text": "so we're going to be talking about how to remotely exploit ios and android",
    "start": "30",
    "end": "6000"
  },
  {
    "text": "devices via bug that we have named broadband there's been quite a lot of",
    "start": "6000",
    "end": "11670"
  },
  {
    "text": "buzz about broadband recently so we want to tell you why we think it's a very",
    "start": "11670",
    "end": "17730"
  },
  {
    "text": "special interesting and powerful bug and also tell you a bit about the process",
    "start": "17730",
    "end": "23789"
  },
  {
    "text": "that led us to this barber but first of",
    "start": "23789",
    "end": "30420"
  },
  {
    "text": "all let me just introduce myself my name is Nita Orenstein I've been doing",
    "start": "30420",
    "end": "36570"
  },
  {
    "text": "reverse engineering and vulnerability research for about as long as I remember I'm mostly interested in Android and",
    "start": "36570",
    "end": "45600"
  },
  {
    "text": "some low level systems such as baseband Wi-Fi chips boot loaders and I've been",
    "start": "45600",
    "end": "51840"
  },
  {
    "text": "doing that for approximately the last five years so we're going to be talking",
    "start": "51840",
    "end": "58770"
  },
  {
    "text": "about broad bonus our remote exploit the for the first remote exploit in quite",
    "start": "58770",
    "end": "65070"
  },
  {
    "text": "some time to be public and first of all we're going to be defining what a remote",
    "start": "65070",
    "end": "70680"
  },
  {
    "text": "exploit actually is so in our opinion a remote exploit is not a browser exploit",
    "start": "70680",
    "end": "80040"
  },
  {
    "text": "and we're going to be explaining exactly why and we're going to be discussing how",
    "start": "80040",
    "end": "89939"
  },
  {
    "text": "we found this particular exploit in in a specific and interesting attack surface",
    "start": "89939",
    "end": "96829"
  },
  {
    "text": "that was almost unexplored until now and we'll be concluding with how we leverage",
    "start": "96829",
    "end": "106229"
  },
  {
    "text": "this bug that we found into the first fully functional remote exploit to be",
    "start": "106229",
    "end": "111270"
  },
  {
    "text": "public and in recent years so first of",
    "start": "111270",
    "end": "117630"
  },
  {
    "start": "116000",
    "end": "362000"
  },
  {
    "text": "all what a remote exploit isn't we've all been hearing the news about various",
    "start": "117630",
    "end": "124860"
  },
  {
    "text": "government agencies in some countries attacking dissidents",
    "start": "124860",
    "end": "130619"
  },
  {
    "text": "and other people with browser bugs sending the message messes with",
    "start": "130619",
    "end": "136680"
  },
  {
    "text": "malicious links now we believe that if you need the victim to click a link and",
    "start": "136680",
    "end": "144260"
  },
  {
    "text": "to actually interact with with any",
    "start": "144260",
    "end": "150269"
  },
  {
    "text": "particular link or whatever you sending him then that's not a remote a remote is",
    "start": "150269",
    "end": "157709"
  },
  {
    "text": "something totally different it does not require social engineering so let's",
    "start": "157709",
    "end": "162989"
  },
  {
    "text": "define what the remote actually is so these are the three laws three laws of",
    "start": "162989",
    "end": "169049"
  },
  {
    "text": "remote exploits I suggest you take a picture because there's going to be a quiz later on sorry yeah so memorize",
    "start": "169049",
    "end": "183780"
  },
  {
    "text": "these three this wee laws first of all a remote may not require any human interaction to trigger that means you",
    "start": "183780",
    "end": "191040"
  },
  {
    "text": "can't click on an SMS a link you can't open an email that's not a remote that's",
    "start": "191040",
    "end": "197630"
  },
  {
    "text": "actually we consider it to be a local exploit then a remote may not make",
    "start": "197630",
    "end": "206510"
  },
  {
    "text": "assumptions about the system that it's attacking and there's a very simple",
    "start": "206510",
    "end": "212880"
  },
  {
    "text": "reason for that when you attack a target remotely your attack surface is much",
    "start": "212880",
    "end": "220680"
  },
  {
    "text": "more limited you have a much more limited interaction with the target so supposing you're attacking a kernel or a",
    "start": "220680",
    "end": "227220"
  },
  {
    "text": "browser you normally have some kind of interface to get feedback to get some kind of data about the state of the",
    "start": "227220",
    "end": "232620"
  },
  {
    "text": "system it helps you with assumptions you need to make about the exploit you can't make these kinds of assumptions in a",
    "start": "232620",
    "end": "238620"
  },
  {
    "text": "remote and the third important rule is a remote must leave the system in a stable",
    "start": "238620",
    "end": "246120"
  },
  {
    "text": "state that's because you want to be persistent you want to keep a stable presence and you don't want to alert the",
    "start": "246120",
    "end": "254010"
  },
  {
    "text": "target that you're attacking so this class of bugs have been very very",
    "start": "254010",
    "end": "261440"
  },
  {
    "text": "prominent early two-thousands we all remember various worms and malware in Windows",
    "start": "261440",
    "end": "270640"
  },
  {
    "text": "during those years you really didn't need to do much other than connect to the internet and your computer was",
    "start": "270640",
    "end": "275960"
  },
  {
    "text": "already owned and you didn't know anything about that happening and these",
    "start": "275960",
    "end": "282800"
  },
  {
    "text": "days are long gone so why well there's been a lot of",
    "start": "282800",
    "end": "290140"
  },
  {
    "text": "mitigations and awareness about remotes and if we look at the Three Laws they're",
    "start": "290140",
    "end": "298970"
  },
  {
    "text": "difficult to keep up because to find remotely exploitable bug that doesn't",
    "start": "298970",
    "end": "306260"
  },
  {
    "text": "require any interaction from the user is almost impossible because the attack",
    "start": "306260",
    "end": "312050"
  },
  {
    "text": "surface is much more limited when you're attacking a target remotely it's also difficult because you need to make",
    "start": "312050",
    "end": "320570"
  },
  {
    "text": "assumptions about the system because you have a SLR SLR randomizes the address space so you never actually know for",
    "start": "320570",
    "end": "328910"
  },
  {
    "text": "certain where any addresses are you need some kind of a leak to know that and that's a problem because you have a",
    "start": "328910",
    "end": "334370"
  },
  {
    "text": "limited interaction with a remote target and another issue is that you cannot",
    "start": "334370",
    "end": "342080"
  },
  {
    "text": "make any mistakes against remote targets because normally if suppose you're",
    "start": "342080",
    "end": "347660"
  },
  {
    "text": "attacking a kernel if you crash it there's a panic and you're done so so",
    "start": "347660",
    "end": "353890"
  },
  {
    "text": "you're in a difficult position where you cannot make any assumptions and yet you cannot crush the system so obviously",
    "start": "353890",
    "end": "363650"
  },
  {
    "start": "362000",
    "end": "389000"
  },
  {
    "text": "this is a very difficult goal and late last year Google project zero have",
    "start": "363650",
    "end": "370370"
  },
  {
    "text": "announced a special bounty for remote exploits for Android whose $350,000 if I",
    "start": "370370",
    "end": "375470"
  },
  {
    "text": "remember correctly there was not a single submission so apparently either",
    "start": "375470",
    "end": "380600"
  },
  {
    "text": "this is too low for that kind of for that kind of exploit or it really is as",
    "start": "380600",
    "end": "386420"
  },
  {
    "text": "hard as we think so in attempting to",
    "start": "386420",
    "end": "391940"
  },
  {
    "start": "389000",
    "end": "456000"
  },
  {
    "text": "resolve this problem about how can we get a remote exploit against fully hardened mobile",
    "start": "391940",
    "end": "399830"
  },
  {
    "text": "phones such as Android and iOS we started looking at the system from a higher level so we have the main",
    "start": "399830",
    "end": "407389"
  },
  {
    "text": "application processor both in Android and iOS and as a lot mitigations going on they're out of hardening first we",
    "start": "407389",
    "end": "415850"
  },
  {
    "text": "have d'Epinay SLR which prevent which both prevent code running from arbitrary",
    "start": "415850",
    "end": "423410"
  },
  {
    "text": "places in memory and prevent us from making assumptions about the memory space and there's various new",
    "start": "423410",
    "end": "429740"
  },
  {
    "text": "medications such as span in pxn which prevent us from jumping to user and from the kernel or accessing data that we're",
    "start": "429740",
    "end": "436910"
  },
  {
    "text": "not supposed to from userland or from the kernel so that's really hard work",
    "start": "436910",
    "end": "442910"
  },
  {
    "text": "for us to develop an expert in such conditions especially a remote one so",
    "start": "442910",
    "end": "448340"
  },
  {
    "text": "we've started looking around the neighborhood looking at a mobile phone but not at the main application",
    "start": "448340",
    "end": "454700"
  },
  {
    "text": "processor and we've come up with kind of",
    "start": "454700",
    "end": "460250"
  },
  {
    "start": "456000",
    "end": "501000"
  },
  {
    "text": "two alternatives to other chips that exist both on iOS and Android that have",
    "start": "460250",
    "end": "465350"
  },
  {
    "text": "a very very extensive interaction with the application processor so one of them",
    "start": "465350",
    "end": "472100"
  },
  {
    "text": "is the baseband which handles 3G and 4G communication along with many other tasks and another is the Wi-Fi chip both",
    "start": "472100",
    "end": "480500"
  },
  {
    "text": "of them have connection via various interfaces such as PCIe to the",
    "start": "480500",
    "end": "487220"
  },
  {
    "text": "application processor so they're in a much more convenient position to attack",
    "start": "487220",
    "end": "493210"
  },
  {
    "text": "the kernel the main system so we started having a look at those two subsystems",
    "start": "493210",
    "end": "500260"
  },
  {
    "text": "and first of all we've considered based bands briefly now basements are a",
    "start": "500260",
    "end": "507830"
  },
  {
    "start": "501000",
    "end": "566000"
  },
  {
    "text": "fascinating attack surface very interesting very fruitful ground for bugs but there's a problem of",
    "start": "507830",
    "end": "514729"
  },
  {
    "text": "fragmentation especially recently up until a few years ago Qualcomm or the market leader they were dominate",
    "start": "514729",
    "end": "520849"
  },
  {
    "text": "dominate in this field but recently there's been quite a few new competitors",
    "start": "520849",
    "end": "526959"
  },
  {
    "text": "grabbing popular devices have moved to to enter into Intel chips",
    "start": "526959",
    "end": "535350"
  },
  {
    "text": "Samsung have moved to the Shanon based bands though the Nexus of still with",
    "start": "535350",
    "end": "541030"
  },
  {
    "text": "Qualcomm but other lower end LG and HTC have moved to mediatek so really if you",
    "start": "541030",
    "end": "550090"
  },
  {
    "text": "develop any sort of exploit or find a bug in a base band that would not get you very far in terms of the percentage",
    "start": "550090",
    "end": "557920"
  },
  {
    "text": "of devices you would be able to attack so we've looked at the Wi-Fi chip and there the picture was very different",
    "start": "557920",
    "end": "566310"
  },
  {
    "start": "566000",
    "end": "610000"
  },
  {
    "text": "Broadcom are a clear market leader there have been in all the iPhones since the",
    "start": "566310",
    "end": "573430"
  },
  {
    "text": "iPhone 5 almost all Samsung galaxys and notes all of them that we've checked",
    "start": "573430",
    "end": "580030"
  },
  {
    "text": "that's the s3 all the way through s8 and all the notes most Google Nexus S since",
    "start": "580030",
    "end": "586930"
  },
  {
    "text": "Google Nexus 5 and there's been some various ages and HTC's that use them",
    "start": "586930",
    "end": "592780"
  },
  {
    "text": "although not universally so obviously this is a much more interesting attack",
    "start": "592780",
    "end": "601240"
  },
  {
    "text": "surface because you don't have to repeat your work if you find one bug you can",
    "start": "601240",
    "end": "607480"
  },
  {
    "text": "use it in plenty of places so and there's a bonus here we've discussed how",
    "start": "607480",
    "end": "614650"
  },
  {
    "start": "610000",
    "end": "643000"
  },
  {
    "text": "a seller makes remote exploits almost experiments are impossible without some",
    "start": "614650",
    "end": "619720"
  },
  {
    "text": "kind of an info leak or an ability to to brute force the address space to find",
    "start": "619720",
    "end": "624850"
  },
  {
    "text": "addresses and in this case that's not a problem because on the Wi-Fi chip or",
    "start": "624850",
    "end": "630400"
  },
  {
    "text": "memory is read/write/execute there is no depth and nor SLR it's",
    "start": "630400",
    "end": "636460"
  },
  {
    "text": "basically a 90s party",
    "start": "636460",
    "end": "639810"
  },
  {
    "text": "so let's start diving into the Wi-Fi system and chip and see what makes it",
    "start": "643509",
    "end": "650779"
  },
  {
    "text": "interesting so first of all there's been a lot of work about this particular",
    "start": "650779",
    "end": "657649"
  },
  {
    "start": "652000",
    "end": "728000"
  },
  {
    "text": "system in the past and we've learned a lot from what other security researchers",
    "start": "657649",
    "end": "663079"
  },
  {
    "text": "have done so the most recent work is gardenia meaning of project zero always",
    "start": "663079",
    "end": "668899"
  },
  {
    "text": "done some amazing research about this particular Broadcom chipset his office",
    "start": "668899",
    "end": "674689"
  },
  {
    "text": "also found some few very nice but then there was the next month project by the",
    "start": "674689",
    "end": "680600"
  },
  {
    "text": "semo group if I'm pronouncing correctly and they've developed a very nice tool",
    "start": "680600",
    "end": "685790"
  },
  {
    "text": "set for hooking and debugging Broadcom chipsets and that's also been extremely",
    "start": "685790",
    "end": "692420"
  },
  {
    "text": "helpful for us to debug and to develop the exploit there was a bunch of Israeli",
    "start": "692420",
    "end": "700399"
  },
  {
    "text": "researchers in recon so we're kind of the pioneers in this field they've",
    "start": "700399",
    "end": "706120"
  },
  {
    "text": "believed the first tranche together with Andres Blanco to actually work on patching the quality the basement",
    "start": "706120",
    "end": "713199"
  },
  {
    "text": "Broadcom chipset and making it do various things that it's not supposed to so I'd like to say thank you to all",
    "start": "713199",
    "end": "721310"
  },
  {
    "text": "these researchers and this is an example of how we all help each other with this",
    "start": "721310",
    "end": "726410"
  },
  {
    "text": "with the research we do so another helpful thing about about those Broadcom",
    "start": "726410",
    "end": "732589"
  },
  {
    "text": "chips is that broad comms Wi-Fi division was recently purchased by Cyprus who",
    "start": "732589",
    "end": "738649"
  },
  {
    "text": "open sourced a lot of the specs this is uh this is the diagram for the Broadcom",
    "start": "738649",
    "end": "744680"
  },
  {
    "text": "four three five four which powers the iPhone 6 and I've simplified it for you",
    "start": "744680",
    "end": "750519"
  },
  {
    "text": "so our basic architecture of a bit of Broadcom chip is so we have an X I",
    "start": "750519",
    "end": "759350"
  },
  {
    "text": "backplane which connects the various parts then we have the main the main",
    "start": "759350",
    "end": "766360"
  },
  {
    "text": "microcontroller which is an ARM Cortex of four then we have d11 fight ship which",
    "start": "766360",
    "end": "774279"
  },
  {
    "text": "handles which handles RF and actually processing packets from over-the-air",
    "start": "774279",
    "end": "780810"
  },
  {
    "text": "then we have PCIe or SDIO which connect",
    "start": "780810",
    "end": "786040"
  },
  {
    "text": "this whole system to the main to the main ship to the main processor via PCIe",
    "start": "786040",
    "end": "794620"
  },
  {
    "text": "works by a DMA stas the arrow is a proprietary Broadcom interface which is",
    "start": "794620",
    "end": "800079"
  },
  {
    "text": "I believe slowly being phased out and then we have about 900 care from in ROM",
    "start": "800079",
    "end": "807579"
  },
  {
    "text": "or neuro chips ROM actually holds most of the instructions most of the code rom",
    "start": "807579",
    "end": "816100"
  },
  {
    "text": "was most of the code rom is mainly for patches for for bug fixes so basically",
    "start": "816100",
    "end": "824440"
  },
  {
    "text": "every once in a while there's a jump to a function table and there it is and that's where they brought the function",
    "start": "824440",
    "end": "830259"
  },
  {
    "text": "table is in ROM and that's where the rod come people can put any jumps to newark code that they want to do patch so to",
    "start": "830259",
    "end": "843190"
  },
  {
    "start": "840000",
    "end": "871000"
  },
  {
    "text": "reverse this firmware was pretty extensive project it uses a proprietary",
    "start": "843190",
    "end": "852750"
  },
  {
    "text": "real-time operating system known as a gen DRTV it was kind of a pain to",
    "start": "852750",
    "end": "860769"
  },
  {
    "text": "reverse it the code is pretty complicated and there's a lot of functionality which you need to reverse",
    "start": "860769",
    "end": "867760"
  },
  {
    "text": "from scratch but fortunately the source is leaked at a very at about five years",
    "start": "867760",
    "end": "876519"
  },
  {
    "start": "871000",
    "end": "905000"
  },
  {
    "text": "ago and digging through Google with various function names led us to these",
    "start": "876519",
    "end": "882040"
  },
  {
    "text": "proprietary Broadcom sources which were included with a project known as vm g",
    "start": "882040",
    "end": "888579"
  },
  {
    "text": "once we want to apparently the Broadcom drivers were compiled rather than supply this in",
    "start": "888579",
    "end": "894819"
  },
  {
    "text": "binary form which means that a lot of the source code is available so this really helped us",
    "start": "894819",
    "end": "901180"
  },
  {
    "text": "gain some perspective into the system so",
    "start": "901180",
    "end": "905670"
  },
  {
    "start": "905000",
    "end": "979000"
  },
  {
    "text": "after getting a perspective about the basic functionality of the system and",
    "start": "907620",
    "end": "914050"
  },
  {
    "text": "what it does we wanted to dig in and look at the right attack surface to",
    "start": "914050",
    "end": "920980"
  },
  {
    "text": "actually find a place that could give us a remote bug a remote a remotely",
    "start": "920980",
    "end": "926140"
  },
  {
    "text": "exploitable bug because this was the purpose of the whole project so now's the time for a first quiz who remembers",
    "start": "926140",
    "end": "932920"
  },
  {
    "text": "the first law of remotes you can just shut it out yeah",
    "start": "932920",
    "end": "940450"
  },
  {
    "text": "you can't interact with humans so what",
    "start": "940450",
    "end": "946180"
  },
  {
    "text": "we needed in in security terms is an",
    "start": "946180",
    "end": "952000"
  },
  {
    "text": "exploit a bug that doesn't require authentication in order to trigger which",
    "start": "952000",
    "end": "958240"
  },
  {
    "text": "means that the user actually doesn't need to actively connect or log in to",
    "start": "958240",
    "end": "966070"
  },
  {
    "text": "any specific place or connect to an access point so that's a rather tall",
    "start": "966070",
    "end": "973600"
  },
  {
    "text": "order and let's see how we approached it",
    "start": "973600",
    "end": "978810"
  },
  {
    "text": "so here's some basics about the Wi-Fi",
    "start": "978810",
    "end": "984300"
  },
  {
    "start": "979000",
    "end": "1160000"
  },
  {
    "text": "Association process before you actually reach wpa2 and any of these encryption",
    "start": "984300",
    "end": "992620"
  },
  {
    "text": "matters which are supposed to to protect you traffic there's a very simple packet",
    "start": "992620",
    "end": "998170"
  },
  {
    "text": "exchange between the station between the client and the access point and that's",
    "start": "998170",
    "end": "1004680"
  },
  {
    "text": "the association process it begins with our probe request on behalf of the",
    "start": "1004680",
    "end": "1010920"
  },
  {
    "text": "station the client the client basically is looking for access points to connect",
    "start": "1010920",
    "end": "1016770"
  },
  {
    "text": "to if an access point is nearby and it's",
    "start": "1016770",
    "end": "1022260"
  },
  {
    "text": "configured to allow anybody to if it's configured to advertise its presence",
    "start": "1022260",
    "end": "1027470"
  },
  {
    "text": "then it sends out a probe response then there's an exchange of",
    "start": "1027470",
    "end": "1034050"
  },
  {
    "text": "the an obsolete set of packets known as open sequence which is to be there to",
    "start": "1034050",
    "end": "1042480"
  },
  {
    "text": "implement WEP which is now obsolete and then if the client actually wants to",
    "start": "1042480",
    "end": "1051390"
  },
  {
    "text": "connect to this access point it issues an association Association request then",
    "start": "1051390",
    "end": "1057660"
  },
  {
    "text": "the access point if it wants read the can't connect issues a response and then they start to exchange data now the",
    "start": "1057660",
    "end": "1064920"
  },
  {
    "text": "authentication process is only inside this last phase within data wpa2 is",
    "start": "1064920",
    "end": "1072150"
  },
  {
    "text": "implemented on top of this association process it's not a part of it which means that there is no authentication in",
    "start": "1072150",
    "end": "1079700"
  },
  {
    "text": "all of these phases in phases that we've described now I know you're asking a",
    "start": "1079700",
    "end": "1087510"
  },
  {
    "text": "question there's a catch here right anybody wants to like shout out what's",
    "start": "1087510",
    "end": "1095430"
  },
  {
    "text": "the catch because probably somebody must be thinking about it sorry",
    "start": "1095430",
    "end": "1103700"
  },
  {
    "text": "yeah okay one issue here is that you must be",
    "start": "1103940",
    "end": "1110100"
  },
  {
    "text": "thinking the client actually needs to choose to connect to an access point to",
    "start": "1110100",
    "end": "1115650"
  },
  {
    "text": "in to initiate this process of association and that's basically true",
    "start": "1115650",
    "end": "1122780"
  },
  {
    "text": "except for a mechanism built into probe probe requests in Wi-Fi which is that a",
    "start": "1122780",
    "end": "1130710"
  },
  {
    "text": "client actually advertises the SSID is the access point names that it's looking",
    "start": "1130710",
    "end": "1136530"
  },
  {
    "text": "for so for instance if you are Bob and you've connected to an access point called Bob home every once in a while",
    "start": "1136530",
    "end": "1144600"
  },
  {
    "text": "you send out probe requests if you're not associated with this name of that",
    "start": "1144600",
    "end": "1152250"
  },
  {
    "text": "particular access point so so let's let's see an example from their real",
    "start": "1152250",
    "end": "1158490"
  },
  {
    "text": "world I was sitting in one of the halls just now with arrow dump",
    "start": "1158490",
    "end": "1165929"
  },
  {
    "start": "1160000",
    "end": "1176000"
  },
  {
    "text": "look at unassociated glands looking for for their home access points let's have a look at what I saw yeah so the hole",
    "start": "1165929",
    "end": "1180059"
  },
  {
    "start": "1176000",
    "end": "1243000"
  },
  {
    "text": "was actually almost empty but look at all these names I'm seeing look at all these on Associated clients sending out",
    "start": "1180059",
    "end": "1186690"
  },
  {
    "text": "names of SS IDs of access points that they're looking for by the way there's",
    "start": "1186690",
    "end": "1193019"
  },
  {
    "text": "quite a few interesting names here if you look carefully you'll see an access point and you think it was just here",
    "start": "1193019",
    "end": "1198269"
  },
  {
    "text": "a query for an access point called Stuxnet and every once in a while it's",
    "start": "1198269",
    "end": "1204450"
  },
  {
    "text": "pretty interesting to just open air a dump and look at what people around you are looking for it might tell you a lot more about them than you think so",
    "start": "1204450",
    "end": "1212628"
  },
  {
    "text": "so this thing actually lets you treat",
    "start": "1214070",
    "end": "1221700"
  },
  {
    "text": "the association process as if it doesn't require any interaction so long as as a",
    "start": "1221700",
    "end": "1229499"
  },
  {
    "text": "victim has connected to an access point in the past and if you stay around them",
    "start": "1229499",
    "end": "1235080"
  },
  {
    "text": "for let's say a minute or two you should be seeing one of these and the beauty of",
    "start": "1235080",
    "end": "1240450"
  },
  {
    "text": "this thing is that there's no authentication involved in this process",
    "start": "1240450",
    "end": "1246299"
  },
  {
    "start": "1243000",
    "end": "1267000"
  },
  {
    "text": "so even if it's a wpa2 or a radius access point with the maximum possible",
    "start": "1246299",
    "end": "1252230"
  },
  {
    "text": "provisions for authentication and security you still don't reach that phase so long as you find a bug in this",
    "start": "1252230",
    "end": "1258539"
  },
  {
    "text": "particular protocol because any authentication is done only after this",
    "start": "1258539",
    "end": "1263730"
  },
  {
    "text": "initial exchange of packets so we've",
    "start": "1263730",
    "end": "1270529"
  },
  {
    "start": "1267000",
    "end": "1335000"
  },
  {
    "text": "convinced ourselves so this is an interesting attack surface sorry yeah so",
    "start": "1270529",
    "end": "1277559"
  },
  {
    "text": "this is an interesting attack surface and now we'd like to begin to examine",
    "start": "1277559",
    "end": "1282940"
  },
  {
    "text": "[Music] how to actually attack it what do we look for so basic Wi-Fi 8:02",
    "start": "1282940",
    "end": "1295249"
  },
  {
    "text": "basic header it's pretty small it only includes addresses and some bits denoting the",
    "start": "1296119",
    "end": "1303310"
  },
  {
    "text": "frame type and other info there's not much potential for bugs there but the",
    "start": "1303310",
    "end": "1311470"
  },
  {
    "text": "real info the real meat carried in the packet and we're talking about packets for the association process the real",
    "start": "1311470",
    "end": "1317320"
  },
  {
    "text": "meat comes in a variable length addition to the packet it's known as an",
    "start": "1317320",
    "end": "1323650"
  },
  {
    "text": "information element it's appended to the end of the packet and you can have as many information you",
    "start": "1323650",
    "end": "1329230"
  },
  {
    "text": "want in a packet that's the way that access points and clients exchange information between them and the way that they're are constructed",
    "start": "1329230",
    "end": "1337360"
  },
  {
    "text": "is that it's basically just a simple TLV one byte for type one byte for length",
    "start": "1337360",
    "end": "1342610"
  },
  {
    "text": "and then a variable length data area and",
    "start": "1342610",
    "end": "1349800"
  },
  {
    "text": "you can have five ten even more of these II's in a packet depending on the",
    "start": "1349800",
    "end": "1357550"
  },
  {
    "text": "capabilities of the access point and the client what they want to tell each other so this is an interesting place to look",
    "start": "1357550",
    "end": "1366520"
  },
  {
    "text": "for bugs because in old and insecure software it's a known minefield that",
    "start": "1366520",
    "end": "1374550"
  },
  {
    "text": "sometimes programmers don't particularly look at the length field they don't they don't remember to check whether the I",
    "start": "1374550",
    "end": "1381520"
  },
  {
    "text": "look at the buffers they've allocated are big enough to hold the info that they're copying from the packet so",
    "start": "1381520",
    "end": "1386650"
  },
  {
    "text": "naturally that was an interesting place to look for bugs so we wanted to to",
    "start": "1386650",
    "end": "1395760"
  },
  {
    "start": "1395000",
    "end": "1442000"
  },
  {
    "text": "narrow down our reverse engineering process to those specific places where",
    "start": "1395760",
    "end": "1402760"
  },
  {
    "text": "we think that such bubs could be found to places that actually handle that",
    "start": "1402760",
    "end": "1410140"
  },
  {
    "text": "parsing of those particular information",
    "start": "1410140",
    "end": "1415600"
  },
  {
    "text": "elements so that that was made easy by the art byte by the design of the femur",
    "start": "1415600",
    "end": "1424570"
  },
  {
    "text": "of the code it's very modular you can see that it's divided into particular modules which are being loaded",
    "start": "1424570",
    "end": "1430550"
  },
  {
    "text": "attached when when the chip boots up so that made it very easy to start having a",
    "start": "1430550",
    "end": "1436970"
  },
  {
    "text": "look and pinpoint particular protocols that were interested in and we found",
    "start": "1436970",
    "end": "1443720"
  },
  {
    "start": "1442000",
    "end": "1505000"
  },
  {
    "text": "this function which helped us a lot this is a function which it's called I am at",
    "start": "1443720",
    "end": "1451790"
  },
  {
    "text": "powers function and this handles this",
    "start": "1451790",
    "end": "1457090"
  },
  {
    "text": "basically registers a callback to handle i'ii teii ease of specific type and you",
    "start": "1457090",
    "end": "1464810"
  },
  {
    "text": "can see there's a field I am type which denotes the ie that the function is supposed to handle the callback and then",
    "start": "1464810",
    "end": "1472160"
  },
  {
    "text": "there is the subtype field which tells you which kind of a packet it is which which means whether it's an association",
    "start": "1472160",
    "end": "1479710"
  },
  {
    "text": "response a request or probe request which packet is it in the association",
    "start": "1479710",
    "end": "1485150"
  },
  {
    "text": "process so it was very convenient to narrow down the protocols which we",
    "start": "1485150",
    "end": "1490520"
  },
  {
    "text": "thought would be particularly complicated or difficult to handle correctly the data being transferred in",
    "start": "1490520",
    "end": "1500600"
  },
  {
    "text": "the packets of the Association process and we've mapped xrefs for four",
    "start": "1500600",
    "end": "1511880"
  },
  {
    "start": "1505000",
    "end": "1543000"
  },
  {
    "text": "particular modules handling protocols which seemed interesting now this was",
    "start": "1511880",
    "end": "1517370"
  },
  {
    "text": "also a tricky part because for instance you can see some references here to c c",
    "start": "1517370",
    "end": "1524690"
  },
  {
    "text": "xt d LS which are protocols which which are not handled before authentication so",
    "start": "1524690",
    "end": "1532610"
  },
  {
    "text": "that was not really relevant for us we are looking for that small specific subset of protocols which are handled",
    "start": "1532610",
    "end": "1540530"
  },
  {
    "text": "during your association process and that's how we reached our barb",
    "start": "1540530",
    "end": "1547780"
  },
  {
    "text": "eventually",
    "start": "1547780",
    "end": "1550780"
  },
  {
    "start": "1553000",
    "end": "1604000"
  },
  {
    "text": "so there's a protocol in in Wi-Fi known as the wireless media extensions we",
    "start": "1553830",
    "end": "1562289"
  },
  {
    "text": "don't need to really go into too much depth about what this protocol does it's designed to let the access point know",
    "start": "1562289",
    "end": "1568759"
  },
  {
    "text": "about our quality of service requirements for instance if the client",
    "start": "1568759",
    "end": "1574980"
  },
  {
    "text": "is our handling video or a voice over IP then the access point can give priority",
    "start": "1574980",
    "end": "1580080"
  },
  {
    "text": "to the packets which are handle which",
    "start": "1580080",
    "end": "1585419"
  },
  {
    "text": "handle traffic which requires good performance so there's a field which in which the client specifies what are the",
    "start": "1585419",
    "end": "1594710"
  },
  {
    "text": "what are its requirements whether it supports WME or not and this is being",
    "start": "1594710",
    "end": "1600179"
  },
  {
    "text": "parsed as part of the association process and we've come across this",
    "start": "1600179",
    "end": "1606989"
  },
  {
    "start": "1604000",
    "end": "1655000"
  },
  {
    "text": "function if you look at it for a second it basically shouts out Bob and again",
    "start": "1606989",
    "end": "1615869"
  },
  {
    "text": "this happens a lot when you deal with embedded systems you find bugs just like they used to look in the good old days",
    "start": "1615869",
    "end": "1621419"
  },
  {
    "text": "so when I was starting out you basically just had to grab 4mm copy in a source",
    "start": "1621419",
    "end": "1627119"
  },
  {
    "text": "code and that's how you found most of your bugs in this case we couldn't",
    "start": "1627119",
    "end": "1632279"
  },
  {
    "text": "couldn't use this technique because we were looking for bugs in a very specific attack surface but once we narrowed down",
    "start": "1632279",
    "end": "1640559"
  },
  {
    "text": "the attack surface to two to a place",
    "start": "1640559",
    "end": "1645690"
  },
  {
    "text": "which can be code which can be reached without any prior authentication that's",
    "start": "1645690",
    "end": "1651299"
  },
  {
    "text": "when we found this bar this this bar but",
    "start": "1651299",
    "end": "1656369"
  },
  {
    "start": "1655000",
    "end": "1728000"
  },
  {
    "text": "before we actually could confirm that it's a bug we wanted to check that the",
    "start": "1656369",
    "end": "1662070"
  },
  {
    "text": "buffer being copied into was actually too small to hold the data if we look at",
    "start": "1662070",
    "end": "1669929"
  },
  {
    "text": "the bug you can see that there's a mem copy here and we don't see any size check at all anywhere and that means",
    "start": "1669929",
    "end": "1678269"
  },
  {
    "text": "that we can specify an iln as big as we want and when we look at the function",
    "start": "1678269",
    "end": "1686220"
  },
  {
    "text": "which allocates this buffer we see that it's size is only 44",
    "start": "1686220",
    "end": "1691740"
  },
  {
    "text": "bytes while we have one bytes to in the in the length field which means we can",
    "start": "1691740",
    "end": "1697860"
  },
  {
    "text": "make a maximum of a maximum length of 255 so 255 minus 44 gives us 211 bytes",
    "start": "1697860",
    "end": "1706169"
  },
  {
    "text": "of overflow which is actually very nice",
    "start": "1706169",
    "end": "1711210"
  },
  {
    "text": "because it gives us a lot a lot of leeway often other flows are small they",
    "start": "1711210",
    "end": "1716520"
  },
  {
    "text": "can be 8 bytes 4 bytes and then they're much harder to exploit this actually",
    "start": "1716520",
    "end": "1722100"
  },
  {
    "text": "gave us a lot more flexibility and we",
    "start": "1722100",
    "end": "1730559"
  },
  {
    "start": "1728000",
    "end": "1828000"
  },
  {
    "text": "started triggering this bug on various devices so this is how it looked on my",
    "start": "1730559",
    "end": "1735690"
  },
  {
    "text": "samsung this is an s7 now this is pretty",
    "start": "1735690",
    "end": "1742860"
  },
  {
    "text": "interesting look at what happens when I trigger the bug",
    "start": "1742860",
    "end": "1748190"
  },
  {
    "text": "so we see that the Wi-Fi system turns off there is some indication to the user",
    "start": "1755820",
    "end": "1763070"
  },
  {
    "text": "but you should probably keep in mind that given that probe request is being",
    "start": "1763070",
    "end": "1770580"
  },
  {
    "text": "sent out without the users interaction it's enough for the phone to be in your pocket and not touch then still it with",
    "start": "1770580",
    "end": "1776820"
  },
  {
    "text": "some aerobic quest and it will associate with an access point if it's if it",
    "start": "1776820",
    "end": "1783509"
  },
  {
    "text": "already recognizes it and just the way you know like you walk you walk home and",
    "start": "1783509",
    "end": "1790999"
  },
  {
    "text": "you take the phone out from your pocket and it's already connected and that's because of this this provision that's",
    "start": "1790999",
    "end": "1797849"
  },
  {
    "text": "because it looks for access points without any interaction from you so in case you do trigger a crash when the",
    "start": "1797849",
    "end": "1804749"
  },
  {
    "text": "phone is doing that when it's automatically looking for access points you will not see any user we will not",
    "start": "1804749",
    "end": "1812070"
  },
  {
    "text": "see any indication to the user at all and after about 5 seconds if you press",
    "start": "1812070",
    "end": "1817349"
  },
  {
    "text": "the chip it comes back up so rather than a disruption of a few seconds for Wi-Fi",
    "start": "1817349",
    "end": "1824820"
  },
  {
    "text": "connectivity there's no indication the story was different on my Mac which was",
    "start": "1824820",
    "end": "1831570"
  },
  {
    "start": "1828000",
    "end": "1910000"
  },
  {
    "text": "also vulnerable it also had a broad term chip let's look at what happens so I'm",
    "start": "1831570",
    "end": "1839399"
  },
  {
    "text": "connecting to to an access point which sends out the exploit",
    "start": "1839399",
    "end": "1845989"
  },
  {
    "text": "and boom kernel panic so this is a good time to mention that there's a",
    "start": "1850660",
    "end": "1857410"
  },
  {
    "text": "difference in implementation between mobile devices and laptops so in mobile",
    "start": "1857410",
    "end": "1863260"
  },
  {
    "text": "devices Wi-Fi chip sets are used in a",
    "start": "1863260",
    "end": "1868330"
  },
  {
    "text": "setting known as half-full Mac which means that they handle a lot of the work",
    "start": "1868330",
    "end": "1875470"
  },
  {
    "text": "and an association and processing it's",
    "start": "1875470",
    "end": "1880720"
  },
  {
    "text": "basically in layer three stuff it's known as MLM II and in laptops in",
    "start": "1880720",
    "end": "1887830"
  },
  {
    "text": "desktops and laptops it's the kernel which handles it so what we're seeing here is that the",
    "start": "1887830",
    "end": "1894250"
  },
  {
    "text": "Association process is being handled by the kernel and it's choking on our bug in crashing now this is not that good",
    "start": "1894250",
    "end": "1902920"
  },
  {
    "text": "for exploitation and we can talk about it later in the meantime we stay with mobile phones because that was our focus",
    "start": "1902920",
    "end": "1908230"
  },
  {
    "text": "for this research so now let's continue",
    "start": "1908230",
    "end": "1915970"
  },
  {
    "start": "1910000",
    "end": "1999000"
  },
  {
    "text": "it's time for another quiz who remembers the second law of remotes",
    "start": "1915970",
    "end": "1921300"
  },
  {
    "text": "[Music] no assumptions you cannot make any",
    "start": "1921300",
    "end": "1929200"
  },
  {
    "text": "assumptions about the system and again the reason is that when you're attacking a remote target you have very little",
    "start": "1929200",
    "end": "1936010"
  },
  {
    "text": "indication of the state it's currently in you don't know about its heap you don't know about which files are open",
    "start": "1936010",
    "end": "1943840"
  },
  {
    "text": "you have a much smaller interface than you do for instance when you're",
    "start": "1943840",
    "end": "1949270"
  },
  {
    "text": "attacking a browser and you have JavaScript or you're attacking the kernel and you have Cisco's remotes are",
    "start": "1949270",
    "end": "1957040"
  },
  {
    "text": "completely different you normally have very limited protocols such as the association process which is what we",
    "start": "1957040",
    "end": "1962110"
  },
  {
    "text": "have in this case and that's the only thing you have you cannot make any assumptions so many remote bugs met an",
    "start": "1962110",
    "end": "1971170"
  },
  {
    "text": "untimely death because they couldn't meet this rule because they had to make assumptions who can tell me one word the",
    "start": "1971170",
    "end": "1978550"
  },
  {
    "text": "main killer of remote bugs that requires you to make assumptions start with name",
    "start": "1978550",
    "end": "1984930"
  },
  {
    "text": "ASLR right so with a said are you have to make assumptions about the system and",
    "start": "1984930",
    "end": "1990400"
  },
  {
    "text": "in this case we don't have a cell R so that's already one advantage so let's see if this bug lets us meet the second",
    "start": "1990400",
    "end": "1997150"
  },
  {
    "text": "law so we don't want something very",
    "start": "1997150",
    "end": "2004380"
  },
  {
    "start": "1999000",
    "end": "2074000"
  },
  {
    "text": "simple we want to avoid a situation where our overflows are overflow puts us",
    "start": "2004380",
    "end": "2011550"
  },
  {
    "text": "on inside dynamic memory memory that means we are in the heap and the",
    "start": "2011550",
    "end": "2017460"
  },
  {
    "text": "locations are changing around us and we have no clear indication of what what we",
    "start": "2017460",
    "end": "2023130"
  },
  {
    "text": "are referring into because it could change from one one from one execution",
    "start": "2023130",
    "end": "2028830"
  },
  {
    "text": "to the other what we do want is to be",
    "start": "2028830",
    "end": "2034890"
  },
  {
    "text": "able to flow into our consistent address and others we can predict we want to be able to predict what's in that address",
    "start": "2034890",
    "end": "2042000"
  },
  {
    "text": "we want it to be as static as consistent with memory as possible we wanted to",
    "start": "2042000",
    "end": "2047100"
  },
  {
    "text": "just sit down and behave nicely not move it must not move so and the third the",
    "start": "2047100",
    "end": "2055500"
  },
  {
    "text": "third thing we want is that data that we're overflowing into needs to be doing",
    "start": "2055500",
    "end": "2061440"
  },
  {
    "text": "something interesting it needs to have pointers which then are triggered in an interesting way so let's see if this bug",
    "start": "2061440",
    "end": "2068899"
  },
  {
    "text": "actually meets what we need so the",
    "start": "2068900",
    "end": "2077280"
  },
  {
    "start": "2074000",
    "end": "2128000"
  },
  {
    "text": "overflow is into a structure known as PS",
    "start": "2077280",
    "end": "2082590"
  },
  {
    "text": "it's a structure for a structure for handling power saving mode our structure",
    "start": "2082590",
    "end": "2087870"
  },
  {
    "text": "is tight is noise described as current W a memory and the sources that's the name",
    "start": "2087870",
    "end": "2094409"
  },
  {
    "text": "and both of them are static in terms of fabric space they are allocated on",
    "start": "2094410",
    "end": "2099510"
  },
  {
    "text": "startup on boot and given the deterministic allocations that the agent",
    "start": "2099510",
    "end": "2107730"
  },
  {
    "text": "agent DRTV allocator makes we can predict we can consistently predict",
    "start": "2107730",
    "end": "2113190"
  },
  {
    "text": "their locations on on a given system on a given firmware",
    "start": "2113190",
    "end": "2119350"
  },
  {
    "text": "and it it stays consistent across reboots even if you put the phone a hundred times of the addresses remain",
    "start": "2119350",
    "end": "2125830"
  },
  {
    "text": "the same and once we confirm that there",
    "start": "2125830",
    "end": "2133810"
  },
  {
    "start": "2128000",
    "end": "2182000"
  },
  {
    "text": "was a good lucky point we wanted to check maybe with we want to check if our",
    "start": "2133810",
    "end": "2140050"
  },
  {
    "text": "lock remains consistent so we had to look at the PS struct and we looked for",
    "start": "2140050",
    "end": "2148450"
  },
  {
    "text": "interesting pointers data which is handle in an interesting way which helps",
    "start": "2148450",
    "end": "2153460"
  },
  {
    "text": "us in an exploit and what we found are all these timers and timers are very",
    "start": "2153460",
    "end": "2158890"
  },
  {
    "text": "good news when you're preparing an exploit because timers are called regularly they do something every once",
    "start": "2158890",
    "end": "2167050"
  },
  {
    "text": "in a while and they not only trigger other call other code for instances callbacks so of course that that",
    "start": "2167050",
    "end": "2174460"
  },
  {
    "text": "immediately seemed interesting and we started digging around at what these timers do and when they're called and we",
    "start": "2174460",
    "end": "2183370"
  },
  {
    "start": "2182000",
    "end": "2243000"
  },
  {
    "text": "reach this function as you can see throughout this process we were extremely lucky first in finding a bug",
    "start": "2183370",
    "end": "2189670"
  },
  {
    "text": "in an association in the association process which doesn't require any authentication then in finding a bug",
    "start": "2189670",
    "end": "2196540"
  },
  {
    "text": "which overflows into static memory and now in this so if you look at this code",
    "start": "2196540",
    "end": "2204060"
  },
  {
    "text": "towards the end you can see a very clear",
    "start": "2204060",
    "end": "2209280"
  },
  {
    "text": "write primitive it takes an address from",
    "start": "2209280",
    "end": "2214330"
  },
  {
    "text": "the overflowed object it takes a specific offset from this address of 14",
    "start": "2214330",
    "end": "2219730"
  },
  {
    "text": "in hex and it tries to that offset so",
    "start": "2219730",
    "end": "2224790"
  },
  {
    "text": "again this is very simple",
    "start": "2224790",
    "end": "2230700"
  },
  {
    "text": "very clear and we just you know it was our lucky day now we have a right time",
    "start": "2231180",
    "end": "2239550"
  },
  {
    "text": "ative where do we write to so as we",
    "start": "2239550",
    "end": "2245670"
  },
  {
    "start": "2243000",
    "end": "2309000"
  },
  {
    "text": "briefly mentioned there's a table of functions in RAM which is used as a way",
    "start": "2245670",
    "end": "2251400"
  },
  {
    "text": "to patch functionality and add security security fixes what Broadcom do is",
    "start": "2251400",
    "end": "2260820"
  },
  {
    "text": "whenever there is a fix whenever there is a patch they change this function table to point to the patch and the code",
    "start": "2260820",
    "end": "2268350"
  },
  {
    "text": "in the ROM at specific intervals at specific points in the code jumps to this table and you know there's",
    "start": "2268350",
    "end": "2275760"
  },
  {
    "text": "basically hooks which we direct the code the code can check whether there's a there's any change and then it comes",
    "start": "2275760",
    "end": "2281970"
  },
  {
    "text": "back to the ROM so this was a good place to overwrite because because this table",
    "start": "2281970",
    "end": "2289970"
  },
  {
    "text": "can stay relatively consistent across different ephemeral versions and it's",
    "start": "2289970",
    "end": "2297750"
  },
  {
    "text": "possible to predict what the particular offset will which function will be in a particular offset so we decided to write",
    "start": "2297750",
    "end": "2306120"
  },
  {
    "text": "to that table and then we had another",
    "start": "2306120",
    "end": "2312960"
  },
  {
    "start": "2309000",
    "end": "2421000"
  },
  {
    "text": "problem in the exploit which is that we only had 24 bytes for shellcode so you",
    "start": "2312960",
    "end": "2321720"
  },
  {
    "text": "can't do much with 24 bytes that's not a place where you can put a a payload",
    "start": "2321720",
    "end": "2327360"
  },
  {
    "text": "which does anything useful and that led us to consider where's a good place we",
    "start": "2327360",
    "end": "2335520"
  },
  {
    "text": "can put our payload now the way you normally solve these problems in expert",
    "start": "2335520",
    "end": "2340950"
  },
  {
    "text": "development is that you look for some kind of a stray primitive a way to write to large areas of the heap with your",
    "start": "2340950",
    "end": "2348150"
  },
  {
    "text": "code so you can predict where this code is we didn't really see this option in",
    "start": "2348150",
    "end": "2354470"
  },
  {
    "text": "in the broad confirmer there's the we didn't find any good location primitives in the limited protocols we had access",
    "start": "2354470",
    "end": "2361170"
  },
  {
    "text": "to as part of the Association process so be given that this is a Wi-Fi chipset",
    "start": "2361170",
    "end": "2368290"
  },
  {
    "text": "that this is a code which handles packet can anybody make a guess about where we could write large large quantities of",
    "start": "2368290",
    "end": "2377170"
  },
  {
    "text": "data pretty freely can you like make a guess so there's a concept known as a",
    "start": "2377170",
    "end": "2387790"
  },
  {
    "text": "ring buffer in network implementations which is a circular buffer which holds packets as they come in and then it",
    "start": "2387790",
    "end": "2395650"
  },
  {
    "text": "overrides the beginning of the buffer as the buffer gets filled up and this is where packets are are copied into after",
    "start": "2395650",
    "end": "2404080"
  },
  {
    "text": "they're handled by the layer 1 chip and this looked like a perfect place for us",
    "start": "2404080",
    "end": "2410890"
  },
  {
    "text": "to put to put our to put our payload now",
    "start": "2410890",
    "end": "2417630"
  },
  {
    "text": "the only thing we needed to do now is to write some egg hunting code again just",
    "start": "2417630",
    "end": "2424720"
  },
  {
    "start": "2421000",
    "end": "2453000"
  },
  {
    "text": "like in the good days which 24 bytes was just enough for that it runs through the",
    "start": "2424720",
    "end": "2430870"
  },
  {
    "text": "fluid memory looks for a particular header and when it finds it it jumps to it and in this case our header was in",
    "start": "2430870",
    "end": "2438700"
  },
  {
    "text": "the ring buffer now a nice thing about the ring buffer is that it's all RW eeks so you can basically run code from",
    "start": "2438700",
    "end": "2444550"
  },
  {
    "text": "anywhere you want also in the ring buffer so we jump to the ring buffer",
    "start": "2444550",
    "end": "2450820"
  },
  {
    "text": "after finding our code and and this is",
    "start": "2450820",
    "end": "2457240"
  },
  {
    "start": "2453000",
    "end": "2487000"
  },
  {
    "text": "the layout of the exploit buffer that we've eventually ended up with you can",
    "start": "2457240",
    "end": "2464980"
  },
  {
    "text": "see we were able to use the overflow to to put our fake timer object at the",
    "start": "2464980",
    "end": "2471520"
  },
  {
    "text": "beginning it jumps to a shell code stub then it jumps to the to the egg hunting",
    "start": "2471520",
    "end": "2480130"
  },
  {
    "text": "code and eventually it jumps to the to",
    "start": "2480130",
    "end": "2485140"
  },
  {
    "text": "the ring buffer now do you remember the",
    "start": "2485140",
    "end": "2492430"
  },
  {
    "start": "2487000",
    "end": "2537000"
  },
  {
    "text": "third law of remotes you must leave the system in a",
    "start": "2492430",
    "end": "2497880"
  },
  {
    "text": "consistent state oh so we had to clean",
    "start": "2497880",
    "end": "2505980"
  },
  {
    "text": "up a bit we had to restore the buffer that we've overflowed and we had to restore the",
    "start": "2505980",
    "end": "2513930"
  },
  {
    "text": "pointers and make sure that we left the system in our consistent state just the",
    "start": "2513930",
    "end": "2518970"
  },
  {
    "text": "way we found it and with broad porn right now there is no indication or any",
    "start": "2518970",
    "end": "2523980"
  },
  {
    "text": "crash after you run the code so you just run your payload you install your hooks",
    "start": "2523980",
    "end": "2529580"
  },
  {
    "text": "when the system stays stable and consistent and this brought us to their",
    "start": "2529580",
    "end": "2543150"
  },
  {
    "start": "2537000",
    "end": "2625000"
  },
  {
    "text": "really interesting phase so when I was",
    "start": "2543150",
    "end": "2549690"
  },
  {
    "text": "starting work in this field we had we had worms we had this self-propagating",
    "start": "2549690",
    "end": "2557990"
  },
  {
    "text": "propagating malware which could basically run wild over the network could anybody like remember any",
    "start": "2557990",
    "end": "2564630"
  },
  {
    "text": "particular worms which were famous like just toss out some names yeah yeah and",
    "start": "2564630",
    "end": "2573890"
  },
  {
    "text": "Stuxnet - yep so there are quite a few",
    "start": "2573890",
    "end": "2580170"
  },
  {
    "text": "in the good days and they died out together with remote exploits remote",
    "start": "2580170",
    "end": "2587790"
  },
  {
    "text": "exploits became no longer possible so worms",
    "start": "2587790",
    "end": "2593310"
  },
  {
    "text": "pretty much needed them to propagate but broadband is a perfect bug for that kind",
    "start": "2593310",
    "end": "2602580"
  },
  {
    "text": "of thing so we thought this is a pretty good occasion to make the first Wi-Fi",
    "start": "2602580",
    "end": "2608700"
  },
  {
    "text": "warm and the first network home in a few years so what the way this is",
    "start": "2608700",
    "end": "2615869"
  },
  {
    "text": "implemented is after you after you run your payload in the chip you put some",
    "start": "2615869",
    "end": "2623550"
  },
  {
    "text": "hoops yeah you put some hooks in functions which handle packets and",
    "start": "2623550",
    "end": "2629469"
  },
  {
    "start": "2625000",
    "end": "2698000"
  },
  {
    "text": "you basically we implement the code which triggers the bug but from within",
    "start": "2629469",
    "end": "2634630"
  },
  {
    "text": "the chip so luckily the bug is pretty",
    "start": "2634630",
    "end": "2639969"
  },
  {
    "text": "simple to implement so the limitations are not that big a deal and we were able",
    "start": "2639969",
    "end": "2647199"
  },
  {
    "text": "to to implement some basic infecting code from within the femur you and still",
    "start": "2647199",
    "end": "2657579"
  },
  {
    "text": "kind of were able to work within the space requirements like the space limitations and that's it what the way",
    "start": "2657579",
    "end": "2665559"
  },
  {
    "text": "the way this works now is a phone gets infected it starts looking for probe",
    "start": "2665559",
    "end": "2671140"
  },
  {
    "text": "requests it sends out whenever it sees a name an SSID it sends out a response",
    "start": "2671140",
    "end": "2676859"
  },
  {
    "text": "starts the initiation process and starts infection now the way it works now is we",
    "start": "2676859",
    "end": "2683499"
  },
  {
    "text": "don't do much other than send out send out a probe request from an infected",
    "start": "2683499",
    "end": "2689799"
  },
  {
    "text": "system saying I am owned that's the only indication we give out so what we're",
    "start": "2689799",
    "end": "2695349"
  },
  {
    "text": "going to do is we're going to show a demo of initial infection and then we're",
    "start": "2695349",
    "end": "2703180"
  },
  {
    "start": "2698000",
    "end": "3195000"
  },
  {
    "text": "going to show how it skips from phone to phone and oops yeah and then we will",
    "start": "2703180",
    "end": "2712479"
  },
  {
    "text": "actually see the packets being sent over the earth so now I'll switch laptops",
    "start": "2712479",
    "end": "2721769"
  },
  {
    "text": "[Music]",
    "start": "2725260",
    "end": "2728379"
  },
  {
    "text": "okay I hope there's nothing embarrassing on my laptop yeah is this good enough",
    "start": "2735950",
    "end": "2745990"
  },
  {
    "text": "okay so I'm going to turn on broadband",
    "start": "2745990",
    "end": "2752390"
  },
  {
    "text": "wait let's see everything is connected yeah my phone's let's start with this",
    "start": "2752390",
    "end": "2759710"
  },
  {
    "text": "one so I've not offered any given any",
    "start": "2759710",
    "end": "2766370"
  },
  {
    "text": "offering to the demo gods and this demo is kind of complicated because well it",
    "start": "2766370",
    "end": "2774950"
  },
  {
    "text": "requires us to spray a large number of packets into the ring buffer and given",
    "start": "2774950",
    "end": "2780050"
  },
  {
    "text": "that there's all these guys here with them their mobile phones it might be a bit tough you might need to do a few",
    "start": "2780050",
    "end": "2785300"
  },
  {
    "text": "retries but we'll give it a shot so first of all we're going to run broad",
    "start": "2785300",
    "end": "2790760"
  },
  {
    "text": "broad pond there's going to be an access point now it's going to be the name is",
    "start": "2790760",
    "end": "2795830"
  },
  {
    "text": "broad pond test you're welcome to connect and try to crush your phone's",
    "start": "2795830",
    "end": "2802450"
  },
  {
    "text": "yeah okay fine what we're going to do now is we're going to run a spray of",
    "start": "2806800",
    "end": "2817790"
  },
  {
    "text": "beacons you're going to see an access point ap 0 to 4 using using something",
    "start": "2817790",
    "end": "2825170"
  },
  {
    "text": "we're using a tool called take ap the only thing is it does is send out as our payload in a spray over the air so it",
    "start": "2825170",
    "end": "2833060"
  },
  {
    "text": "fills up the ring buffer the ring buffer of the first phone right so we're going",
    "start": "2833060",
    "end": "2840680"
  },
  {
    "text": "to run it now ok it's running now by now",
    "start": "2840680",
    "end": "2847880"
  },
  {
    "text": "actually my phone might be infected because it's supposed to send out set",
    "start": "2847880",
    "end": "2853850"
  },
  {
    "text": "out a probe request let's look at the log I hope it's not infected yet yeah",
    "start": "2853850",
    "end": "2866440"
  },
  {
    "text": "we need to parse the lobs because we're using a special tool called the HD util which extracts them from the chip",
    "start": "2873330",
    "end": "2879090"
  },
  {
    "text": "they're not on the kernel they're on the chip okay has it been infected yet not",
    "start": "2879090",
    "end": "2888090"
  },
  {
    "text": "yet okay I'm just like give it a rub to",
    "start": "2888090",
    "end": "2897570"
  },
  {
    "text": "start scanning okay yeah sorry it wasn't",
    "start": "2897570",
    "end": "2907440"
  },
  {
    "text": "now so you can see that it's it's okay",
    "start": "2907440",
    "end": "2913890"
  },
  {
    "text": "yeah can you see payload triggered so what it does here is it it starts the so",
    "start": "2913890",
    "end": "2923940"
  },
  {
    "text": "it's so the payload needs to restore the CPA star because you know an armed CPS R",
    "start": "2923940",
    "end": "2929670"
  },
  {
    "text": "holds the state for interrupts and everything and the code which basically there's a reason we need to restore it",
    "start": "2929670",
    "end": "2936750"
  },
  {
    "text": "otherwise the chip crashes then we restore destruct the power saving struct",
    "start": "2936750",
    "end": "2943740"
  },
  {
    "text": "it's called WL CPM st and then what we're doing is we're just sending probes",
    "start": "2943740",
    "end": "2949320"
  },
  {
    "text": "which say I am on and waiting for probe",
    "start": "2949320",
    "end": "2954770"
  },
  {
    "text": "requests so now let's look at the other",
    "start": "2954770",
    "end": "2960150"
  },
  {
    "text": "phone which might also already be infected so about s probe requests get",
    "start": "2960150",
    "end": "2967410"
  },
  {
    "text": "sent out about once a minute now the infection is a tricky part it might not",
    "start": "2967410",
    "end": "2973290"
  },
  {
    "text": "work it didn't consistently work but I'm hoping I'm gonna get lucky because you",
    "start": "2973290",
    "end": "2978690"
  },
  {
    "text": "notice that on this project we got pretty lucky a lot of the time right so",
    "start": "2978690",
    "end": "2984600"
  },
  {
    "text": "let's hope this lock stays all the way through I'm going to check the log it might be already infected I don't think",
    "start": "2984600",
    "end": "2992520"
  },
  {
    "text": "it's infected now you can see the hooks but if yeah okay so as you can see the",
    "start": "2992520",
    "end": "3002150"
  },
  {
    "text": "infection process is pretty fast it's just an exchange of four packets and it's already sending probes yeah and",
    "start": "3002150",
    "end": "3012750"
  },
  {
    "text": "here the same thing brought pound payload figured and all that stuff now",
    "start": "3012750",
    "end": "3018150"
  },
  {
    "text": "what we're going to do is to have a look at to see if we can see these just to",
    "start": "3018150",
    "end": "3025230"
  },
  {
    "text": "prove that these phones have been owned we're going to snap using arrow dump to",
    "start": "3025230",
    "end": "3031830"
  },
  {
    "text": "see the I am owned packets to see if they're on the air now I'll first try to work with arrow dump just like that",
    "start": "3031830",
    "end": "3041180"
  },
  {
    "text": "although there's no chance we're going to see anything because there's all a few guys here and it's just going to get swamped so we're going to run some code",
    "start": "3041180",
    "end": "3047160"
  },
  {
    "text": "to filter particular MAC addresses which I know are the MAC addresses of these",
    "start": "3047160",
    "end": "3053250"
  },
  {
    "text": "phones but first you know just for entertainment entertainment let's have a look at what's going on here oh so these",
    "start": "3053250",
    "end": "3060300"
  },
  {
    "text": "are these are it's pretty interesting just to see like who's here these are these are access points but if we move",
    "start": "3060300",
    "end": "3066900"
  },
  {
    "text": "to like different channel you'll see that MGM Resorts which is like the open Wi-Fi that they would have put in here",
    "start": "3066900",
    "end": "3073080"
  },
  {
    "text": "is on channel 11 so if we switch to some channel 2 and put like encryption open",
    "start": "3073080",
    "end": "3080030"
  },
  {
    "text": "it's a way to try to trick arrow dump into showing us just clients so let's just look at clients which are here and",
    "start": "3080030",
    "end": "3090600"
  },
  {
    "text": "unassociated just repeat like that entertainment we had before let's look at like the names being sent out here",
    "start": "3090600",
    "end": "3098630"
  },
  {
    "text": "let's look yeah so here is Alisa is",
    "start": "3099050",
    "end": "3105780"
  },
  {
    "text": "anybody named ELISA here somebody's been to Bissell did you see it y5b so here's",
    "start": "3105780",
    "end": "3114360"
  },
  {
    "text": "a laser again this is very interesting right okay somebody from China cool so",
    "start": "3114360",
    "end": "3122850"
  },
  {
    "text": "now I'm just going to run",
    "start": "3122850",
    "end": "3130130"
  },
  {
    "text": "TCP dump from this script looking specifically for probe requests coming",
    "start": "3130130",
    "end": "3137220"
  },
  {
    "text": "out from these two MAC addresses so I'm just running it letting it capture now",
    "start": "3137220",
    "end": "3145050"
  },
  {
    "text": "the hooks I put are in the function which handles are receiving packets so",
    "start": "3145050",
    "end": "3150360"
  },
  {
    "text": "whenever it receives a packet it sends out a public quest so that's what I need to like to play with the phone a bit",
    "start": "3150360",
    "end": "3155490"
  },
  {
    "text": "that it scans so it receives lots of packets to make sure that that we catch",
    "start": "3155490",
    "end": "3161070"
  },
  {
    "text": "the probe requests on the right channel so I'm playing with it a bit yeah I",
    "start": "3161070",
    "end": "3166440"
  },
  {
    "text": "think that should do the trick ok and show probe ok yeah so you see we have",
    "start": "3166440",
    "end": "3176250"
  },
  {
    "text": "two stations sending out requests I am",
    "start": "3176250",
    "end": "3182130"
  },
  {
    "text": "on and that's it basically game over [Applause]",
    "start": "3182130",
    "end": "3188100"
  },
  {
    "text": "[Music]",
    "start": "3188100",
    "end": "3193710"
  },
  {
    "text": "[Applause]",
    "start": "3193710",
    "end": "3197389"
  }
]