[
  {
    "text": "good morning everybody um thanks for joining us in the the wi-fi hacking talk",
    "start": "80",
    "end": "6359"
  },
  {
    "text": "um my name is Daniel cber um I am the CEO of a company called sens poost and",
    "start": "6359",
    "end": "13360"
  },
  {
    "text": "for the best part we perform offensive security assessments and we look at",
    "start": "13360",
    "end": "18400"
  },
  {
    "text": "tearing and breaking things apart on the internet and we've been doing it for 15 years now um prior to that I helped",
    "start": "18400",
    "end": "25119"
  },
  {
    "text": "start a a little organization called oasp so I've been involved in the the security assessments seen for a while",
    "start": "25119",
    "end": "31519"
  },
  {
    "text": "and for the last 3 years my area of research has been looking at tracking",
    "start": "31519",
    "end": "36920"
  },
  {
    "text": "and profiling people on the internet and that's anything from extremists using social media to generally messing around",
    "start": "36920",
    "end": "44280"
  },
  {
    "text": "with Wi-Fi and there basics of this talk is a piece of research that um my two colleagues Dominic and Ian have put",
    "start": "44280",
    "end": "50680"
  },
  {
    "text": "together and I've helped with and it's about helping us own the airwaves a lot",
    "start": "50680",
    "end": "56120"
  },
  {
    "text": "easier so the slides have to start the obligatory uh legal note uh there is a",
    "start": "56120",
    "end": "62960"
  },
  {
    "text": "legal disclaimer um I am going to be doing some Wi-Fi tests in this room so",
    "start": "62960",
    "end": "68159"
  },
  {
    "text": "if you really don't want to be involved please turn your Wi-Fi off there is a very fine line that's to be crossed um",
    "start": "68159",
    "end": "73520"
  },
  {
    "text": "unfortunately when it comes to interception and modification of anything it's kind of illegal um I will",
    "start": "73520",
    "end": "79400"
  },
  {
    "text": "not be doing that in this talk um but I am going to be proving to you how and what we've done works so it's currently",
    "start": "79400",
    "end": "85360"
  },
  {
    "text": "rning in the background all it's doing is going through some very basic stuff so if you're not not interested in being",
    "start": "85360",
    "end": "90640"
  },
  {
    "text": "involved please turn your Wi-Fi off now thank you so a lot of people today ask me why",
    "start": "90640",
    "end": "98280"
  },
  {
    "text": "WI-Fi like Wi-Fi is such a an old subject to talk about right it's easy to",
    "start": "98280",
    "end": "103880"
  },
  {
    "text": "hack everybody knows how to own Wi-Fi why the big interest and for us it's it",
    "start": "103880",
    "end": "109520"
  },
  {
    "text": "might might have been easy to attack a long time ago but if you look at how many devices today have Wi-Fi right",
    "start": "109520",
    "end": "115680"
  },
  {
    "text": "there's 800 million new devices every year deployed with some form of Wi-Fi capability you have Smart cities such as",
    "start": "115680",
    "end": "122200"
  },
  {
    "text": "the one Singapore and London Etc so the world of Wi-Fi is getting quite exciting when it comes to owning stuff and if you",
    "start": "122200",
    "end": "128840"
  },
  {
    "text": "look at modern devices now um we gave training over the last two days nobody has ethernet anymore right so everything",
    "start": "128840",
    "end": "135920"
  },
  {
    "text": "connects and communicates using Wi-Fi and everybody has got one of these um",
    "start": "135920",
    "end": "141519"
  },
  {
    "text": "and more so in Asia where you'll have more than one device so the lure of owning and targeting a human being who",
    "start": "141519",
    "end": "147800"
  },
  {
    "text": "uses a device that communicates buying WI Wii is actually quite appealing and",
    "start": "147800",
    "end": "153440"
  },
  {
    "text": "you know this is the promise of wi-fi hacking right there should be vones at every single layer of the OSI stack from",
    "start": "153440",
    "end": "159560"
  },
  {
    "text": "the RF signal to passwords to credentials to getting access and doing",
    "start": "159560",
    "end": "164760"
  },
  {
    "text": "man INE middle it should be really easy and if you talk to a lot of people it's like yeah wi-fi hacking that's really",
    "start": "164760",
    "end": "170239"
  },
  {
    "text": "easy you know you get creds falling from the sky and that's kind of where we came up with the idea from this talk Mana you",
    "start": "170239",
    "end": "175760"
  },
  {
    "text": "know Mana from heaven right for the last 13 years the security industry has been",
    "start": "175760",
    "end": "181159"
  },
  {
    "text": "looking at researching and trying to find ways to break Wi-Fi right but the thing is you don't have credits falling",
    "start": "181159",
    "end": "187480"
  },
  {
    "text": "from the sky right as of a couple of months ago before we released Mana at Defcon you know it was actually quite",
    "start": "187480",
    "end": "194120"
  },
  {
    "text": "hard to do full interception of modern Wi-Fi networks and to pone a device and",
    "start": "194120",
    "end": "199560"
  },
  {
    "text": "gain access to credentials right and we thought well that's that's pretty rubbish we need to change that so if we look at all the",
    "start": "199560",
    "end": "206840"
  },
  {
    "text": "vulnerabilities and all the tools that been around right starting right at the beginning connect okay Dino and sha in",
    "start": "206840",
    "end": "212920"
  },
  {
    "text": "2004 so that was 11 years ago released Karma and back then Karma was quite cool",
    "start": "212920",
    "end": "218239"
  },
  {
    "text": "because we didn't have the proliferation of mobile devices like we do currently we had laptops so it was quite easy to",
    "start": "218239",
    "end": "223920"
  },
  {
    "text": "go around with the Pringle can like I did back in the day and drive past gchq and MI5 and MI6 and do War driving",
    "start": "223920",
    "end": "231239"
  },
  {
    "text": "because it's it's normal it's what you did back then you might have got a lot of weird glances but there was a vague hope you could do some War driving and",
    "start": "231239",
    "end": "237360"
  },
  {
    "text": "catch somebody and own them if they were using something like weap or no security back like it was then on the crack side",
    "start": "237360",
    "end": "244200"
  },
  {
    "text": "you had Josh White who made a sleep in 2003 Josh and Brad wrote free radius wpe",
    "start": "244200",
    "end": "251120"
  },
  {
    "text": "in 2008 and then Moxy in 2013 gave us Cloud cracker and then on the interception",
    "start": "251120",
    "end": "258239"
  },
  {
    "text": "side you had Doug song's D sniff now I remember when Doug released it and D Sniff was amazing at the time back in",
    "start": "258239",
    "end": "264280"
  },
  {
    "text": "2000 if you gain access to a network you launched D Sniff and there were creds reigning in Left Right Center",
    "start": "264280",
    "end": "270240"
  },
  {
    "text": "okay and it was a great tool but that was in 2000 that was 15 years ago and then fast forward to 2007 Rob and U Rob",
    "start": "270240",
    "end": "278720"
  },
  {
    "text": "Graham released hamster and ferret which worked really well and then Moxy came back with a Smacker and gave us SS strip",
    "start": "278720",
    "end": "285960"
  },
  {
    "text": "and SSL sniff so we finally started to see all these creds falling from heaven but if you notice they were all in the",
    "start": "285960",
    "end": "292320"
  },
  {
    "text": "early 2000s right since then nothing's really worked except in 2010 Eric Butler",
    "start": "292320",
    "end": "298240"
  },
  {
    "text": "gave us fire sheep and there was a brief moment in time when when you were board at the airport like myself you'd launch",
    "start": "298240",
    "end": "303880"
  },
  {
    "text": "up fire sheep and you start collecting Facebook profile cookies and indeed everything else and it was cute for a",
    "start": "303880",
    "end": "309560"
  },
  {
    "text": "couple of months but then the application security World got wind of it and shut that down rightly so so if",
    "start": "309560",
    "end": "317240"
  },
  {
    "text": "nearly every single layer of the stack is vulnerable right why are we not getting credentials falling in our feet",
    "start": "317240",
    "end": "323520"
  },
  {
    "text": "left R Center all of you use Wi-Fi here I've been doing my testing over the last",
    "start": "323520",
    "end": "328880"
  },
  {
    "text": "four hours and there are a lot of access points being called out for right so why have I not collected a massive database",
    "start": "328880",
    "end": "335000"
  },
  {
    "text": "of credentials simply put because the industry got better at protecting your details so the expectations versus",
    "start": "335000",
    "end": "342120"
  },
  {
    "text": "reality are pretty you know different so if we look at why it failed",
    "start": "342120",
    "end": "347919"
  },
  {
    "text": "right if we look at Karma okay it's old code and devices proess I'm going to go into detail why devices do this and how",
    "start": "347919",
    "end": "354479"
  },
  {
    "text": "we've come about fixing that if we look at free radius WPA it's very old called",
    "start": "354479",
    "end": "359800"
  },
  {
    "text": "and anybody who's ever deployed it knows how hard it is to set it up right it's not a quick and easy thing to get up and",
    "start": "359800",
    "end": "365280"
  },
  {
    "text": "running D sniff well D sniff says it all if you want to go and sniff MSN Messenger creds that's really cool but I",
    "start": "365280",
    "end": "372280"
  },
  {
    "text": "doubt you'll find anybody using MSN Messenger anymore same goes for hamston fet and same goes for fire sheep right",
    "start": "372280",
    "end": "378440"
  },
  {
    "text": "they barely work and they're not updated and then finally if we look at SSL strip and S self sniff two very very cool",
    "start": "378440",
    "end": "385759"
  },
  {
    "text": "tools but the problem is the industry got better they were defeated by hsts and certificate pinning and it becomes",
    "start": "385759",
    "end": "393160"
  },
  {
    "text": "very hard now when you're on a network or you're on a mobile network or an access point to successfully intercept",
    "start": "393160",
    "end": "399120"
  },
  {
    "text": "SSL Communications so at sense boost Ian and Dominic and myself we decided right we",
    "start": "399120",
    "end": "405800"
  },
  {
    "text": "need to put some effort into this and we're going to fix Karma we're going to fix the interception part and we created",
    "start": "405800",
    "end": "412759"
  },
  {
    "text": "this toolkit called mana and basically Mana is based off a lot of code modifications we did to host APD which",
    "start": "412759",
    "end": "419360"
  },
  {
    "text": "is version 2.3 hostapd is the the software access point and the toet been",
    "start": "419360",
    "end": "425440"
  },
  {
    "text": "released for a couple of months and last night we post a whole lot of updates into our GitHub page so you can pull it",
    "start": "425440",
    "end": "430720"
  },
  {
    "text": "down now and start playing with it there is Dominic and there's Ian so I'm going to teach a lot of",
    "start": "430720",
    "end": "436919"
  },
  {
    "text": "people here I'm sure to suck eggs um how many Wi-Fi hackers in the room there's not one there's one Wi-Fi",
    "start": "436919",
    "end": "443360"
  },
  {
    "text": "hacker all right cool so we're going to be talking about Wi-Fi yeah I'm not talking about 3G I'm not talking about",
    "start": "443360",
    "end": "449160"
  },
  {
    "text": "RF C I'm not talking about Bluetooth or anything else I'm literally talking about 0211 AB GN AC Etc in the 2.4 GHz",
    "start": "449160",
    "end": "457199"
  },
  {
    "text": "range right all 5 GHz so as a primer it's really important to understand",
    "start": "457199",
    "end": "463039"
  },
  {
    "text": "there's three types of packets when it comes to wi-fi hacking right just three as a blonde that's really helpful the",
    "start": "463039",
    "end": "469159"
  },
  {
    "text": "first one is data that's kind of does what it says on the tin that's the stuff that carries your data across the",
    "start": "469159",
    "end": "474280"
  },
  {
    "text": "airwaves right the next one is control now that stops collisions happening so",
    "start": "474280",
    "end": "479800"
  },
  {
    "text": "if any of you were in the keynote and you would have noticed there was last count 600 and something access points",
    "start": "479800",
    "end": "485639"
  },
  {
    "text": "being probed for at least in my research and when you have a big room like that it's really important to make sure",
    "start": "485639",
    "end": "491159"
  },
  {
    "text": "there's no collisions that happen right it's just general netiquette the one we're interested in is management and",
    "start": "491159",
    "end": "496960"
  },
  {
    "text": "that's probes and beacons and this is really important so if we look at the current",
    "start": "496960",
    "end": "502840"
  },
  {
    "text": "um way of doing it when you pull out your mobile phone and you turn your Wi-Fi on because nobody has it turned on",
    "start": "502840",
    "end": "508000"
  },
  {
    "text": "all the time right when you turn your Wi-Fi on your phone does a couple of things first out it sends out a",
    "start": "508000",
    "end": "514240"
  },
  {
    "text": "broadcast request right and it says Hey home network are you there right and it",
    "start": "514240",
    "end": "519440"
  },
  {
    "text": "sends out and any access point out there that actually belongs to that goes yep yep that's me and then you get a probe",
    "start": "519440",
    "end": "525680"
  },
  {
    "text": "request that goes out okay if you then look at what happens your phone then sends out a directed",
    "start": "525680",
    "end": "531880"
  },
  {
    "text": "probe request right and the access point it wants to connect to sends out a directed probe response and this is",
    "start": "531880",
    "end": "538320"
  },
  {
    "text": "really important this is how mod mod Wi-Fi works and then the association request and response happens now the problem with Karma right",
    "start": "538320",
    "end": "547519"
  },
  {
    "text": "is that a lot of the time devices will probe for a preferred network list and effectively what that is is that every",
    "start": "547519",
    "end": "554240"
  },
  {
    "text": "single Network you've connected to get stored on your phone and in 2012 uh a",
    "start": "554240",
    "end": "559600"
  },
  {
    "text": "colleague of mine Glenn and I built a snooping framework called Snoopy which we presented at black hat and Defcon it",
    "start": "559600",
    "end": "565959"
  },
  {
    "text": "was on CNN and quite a few other channels and we exploited this preferred network list but the problem is is that",
    "start": "565959",
    "end": "574040"
  },
  {
    "text": "modern devices no longer send out directed probe requests right for",
    "start": "574040",
    "end": "579480"
  },
  {
    "text": "obvious reasons but the older Karma attack would say listen phone would go hey home network are you out there and",
    "start": "579480",
    "end": "586320"
  },
  {
    "text": "I'd go yeah I'm home network let's let's party right and that's how the old K attack worked it was great in 2006 and",
    "start": "586320",
    "end": "593839"
  },
  {
    "text": "it worked up to like 2009 2010 but then things started changing so it became a lot harder to start owning Wi-Fi",
    "start": "593839",
    "end": "600079"
  },
  {
    "text": "networks which is a bit disappointing because hacking Wi-Fi should be fun right there are so many different areas",
    "start": "600079",
    "end": "605880"
  },
  {
    "text": "actually owning an organization or human being when it comes to Wi-Fi so then um",
    "start": "605880",
    "end": "611560"
  },
  {
    "text": "Thomas wrote air crack so he's that gentleman there and then Robinwood Digi",
    "start": "611560",
    "end": "617000"
  },
  {
    "text": "ninja decided Well he was going to fix a few of these things and he patched the first um bit of karma to make it work a",
    "start": "617000",
    "end": "624320"
  },
  {
    "text": "little bit better but it just it wasn't working that right problem with karma is that that it looks like a fake access",
    "start": "624320",
    "end": "630720"
  },
  {
    "text": "point right it also doesn't respond to Broad requests so it's a bit like that gingerhead or the ginger person at a",
    "start": "630720",
    "end": "636880"
  },
  {
    "text": "nightclub who use S tan you know they're fake you know it's not real right modern mobile devices won't listen to directed",
    "start": "636880",
    "end": "644120"
  },
  {
    "text": "probes for open non-hidden access points right they first got to respond to a broadcast probe so that makes it a",
    "start": "644120",
    "end": "650320"
  },
  {
    "text": "little bit harder so what we did with Mana right is we built this framework and our access point our evil access",
    "start": "650320",
    "end": "657560"
  },
  {
    "text": "point which is currently running here right needs to do two things it needs to",
    "start": "657560",
    "end": "662920"
  },
  {
    "text": "respond to the broadcast probe as well as the directed probe right and then",
    "start": "662920",
    "end": "668399"
  },
  {
    "text": "when we were playing around with Mana and broadcast probes and everything else",
    "start": "668399",
    "end": "673839"
  },
  {
    "text": "we figured out well we could send out different probe responses for different",
    "start": "673839",
    "end": "679480"
  },
  {
    "text": "networks ESS IDs right because that's how let's say the blackout network works there is the BH U BH AP and there's",
    "start": "679480",
    "end": "687720"
  },
  {
    "text": "probably 1020 access points out there all sending out that ESS ID which is great so let's pretend to do that then",
    "start": "687720",
    "end": "694680"
  },
  {
    "text": "we decided well let's get a little bit more clever about this so we patched host APD and Ian went through a very",
    "start": "694680",
    "end": "701399"
  },
  {
    "text": "horrible period because for anybody who's ever looked at the host APD code the developers obviously went through",
    "start": "701399",
    "end": "707160"
  },
  {
    "text": "the same process where if it's really hard to write the code I'm going to make downwell sure that it's impossible to read the code there's no comments or",
    "start": "707160",
    "end": "713880"
  },
  {
    "text": "anything else so Ian went through a very horrible period of lots of swearing and alcohol and cigarettes but he found out",
    "start": "713880",
    "end": "719720"
  },
  {
    "text": "a way and he patched it and we do two things our evil access point watches out",
    "start": "719720",
    "end": "725519"
  },
  {
    "text": "for directed probes but it doesn't just stop there we then decided let's collect",
    "start": "725519",
    "end": "731399"
  },
  {
    "text": "all those directed probes and store them in a hash right a per MAAC hash because",
    "start": "731399",
    "end": "738279"
  },
  {
    "text": "we want to use that later right then we build up our own version of your preferred network list in our access",
    "start": "738279",
    "end": "744600"
  },
  {
    "text": "point so right now whoever's left their mobile phones turned on you are currently having all your preferred",
    "start": "744600",
    "end": "750320"
  },
  {
    "text": "network lists that you've ever connected to stored in our little database and we're using that against you so right",
    "start": "750320",
    "end": "756920"
  },
  {
    "text": "now your phone is probably going Hey listen home network you're there right directed and our Karma access point is",
    "start": "756920",
    "end": "763079"
  },
  {
    "text": "going yep that's me and we then that user against you so that's pretty cool",
    "start": "763079",
    "end": "768120"
  },
  {
    "text": "and um I've got a video to show how this works so this is a modern Android device right in an emulator because there's one",
    "start": "768120",
    "end": "774360"
  },
  {
    "text": "thing I've learned in presenting of the last nearly 20 years you never do live demos ever",
    "start": "774360",
    "end": "780240"
  },
  {
    "text": "so on the left on the right you can see a device and you can see a network that we've connected to before called s poost",
    "start": "780240",
    "end": "786000"
  },
  {
    "text": "Mana so we're going to start at mana and sense post Mana is not in range okay and",
    "start": "786000",
    "end": "792040"
  },
  {
    "text": "we search for Wi-Fi networks um on the left hand side you",
    "start": "792040",
    "end": "798040"
  },
  {
    "text": "can see the p&l that we're now storing the network database and you can see sense post Mana has connected okay so",
    "start": "798040",
    "end": "804839"
  },
  {
    "text": "that's the first important that's the first important thing okay",
    "start": "804839",
    "end": "811120"
  },
  {
    "text": "sorry it's going to start again so we can now we fix Karma right so karma now",
    "start": "812360",
    "end": "818120"
  },
  {
    "text": "works with modern devices and just to prove that the old style Karma works so",
    "start": "818120",
    "end": "823360"
  },
  {
    "text": "it's going to associate you'll see in the the left hand side Associates Karma successful thank",
    "start": "823360",
    "end": "828839"
  },
  {
    "text": "you very much we're going to create a network that we've never ever connected to before",
    "start": "828839",
    "end": "835720"
  },
  {
    "text": "okay we're going to call this Mana sense post again it's not in my preferred",
    "start": "836519",
    "end": "842360"
  },
  {
    "text": "network list so I know that effectively there should never be an access point out",
    "start": "842360",
    "end": "848320"
  },
  {
    "text": "there and you'll see in a second pretty much instantly I get Associated I'm connected",
    "start": "849320",
    "end": "854759"
  },
  {
    "text": "I get given an IP address so we worked we fixed Karma it's really good you can",
    "start": "854759",
    "end": "860720"
  },
  {
    "text": "go forth and do that get the patches and start doing basic Wi-Fi ponage so in 2012 Glenn and I gave a",
    "start": "860720",
    "end": "869120"
  },
  {
    "text": "talk called terrorism tracking and privacy and human interactions at 44 con and we became quite obsessed with how",
    "start": "869120",
    "end": "876360"
  },
  {
    "text": "people were using mobile phones this was 2011 when we started in truth we wanted",
    "start": "876360",
    "end": "881839"
  },
  {
    "text": "to build a lowcost version of paler um palente got billions of you know Venture",
    "start": "881839",
    "end": "888079"
  },
  {
    "text": "Capital funds we had a couple of thousands so what we did was we built a series of drones so we wanted to take",
    "start": "888079",
    "end": "894560"
  },
  {
    "text": "wi-fi hacking from a singular laptop and make use of drones and then send that to London and we went out to London in rush",
    "start": "894560",
    "end": "902040"
  },
  {
    "text": "hour between 8:00 a.m. and 9:00 a.m. at Key stations and you know Sor was one of the people that sat there for an hour",
    "start": "902040",
    "end": "908120"
  },
  {
    "text": "with little drone and we caught nearly 880,000 people in our net right and and what we could do with Snoop Snoopy was",
    "start": "908120",
    "end": "915240"
  },
  {
    "text": "we decided Well let's start getting clever how can we start spying on people right this was PRI Snowden and Glenn",
    "start": "915240",
    "end": "921079"
  },
  {
    "text": "buil a drone that had a Snoopy drone on underneath and you could fly over large groups of people like he did um at",
    "start": "921079",
    "end": "927040"
  },
  {
    "text": "concerts and you could start mapping people out and how it worked was so this is the m multigo interface is that we",
    "start": "927040",
    "end": "933880"
  },
  {
    "text": "could write a single command and control center that allowed us to put drones anywhere and the idea behind the drones",
    "start": "933880",
    "end": "940199"
  },
  {
    "text": "was they were cheap less than1 they were throw away we made sure they were secure they connected over VPN and effectively",
    "start": "940199",
    "end": "947440"
  },
  {
    "text": "they become a dumb client so what we did was we put them everywhere right and then I go into my multile interface and",
    "start": "947440",
    "end": "953000"
  },
  {
    "text": "I say right show me all the drones you've got in a certain location and it goes out pulls them off and then I start",
    "start": "953000",
    "end": "959319"
  },
  {
    "text": "doing my mining I saying right show me which clients have Associated show me which clients I'm giving internet access",
    "start": "959319",
    "end": "964399"
  },
  {
    "text": "and there were two parts to Snoopy which is quite interesting the first was the passive side bear in mind we did this in London and I don't really like getting",
    "start": "964399",
    "end": "970959"
  },
  {
    "text": "arrested it's it's quite annoying so we made sure that was legal but then the evil part of us thought well what's the",
    "start": "970959",
    "end": "976600"
  },
  {
    "text": "worst we could do so we thought let's make it completely nasty let's give that",
    "start": "976600",
    "end": "981800"
  },
  {
    "text": "person full internet access let's pretend to be one of the networks they're probing for you know the",
    "start": "981800",
    "end": "987000"
  },
  {
    "text": "modified Karma attack let's give them internet access and at the same time let's intercept all the traffic and we",
    "start": "987000",
    "end": "992160"
  },
  {
    "text": "did that we used you know basic SSL strip we injected um all the JavaScript coming across the wire we would inject",
    "start": "992160",
    "end": "998399"
  },
  {
    "text": "malicious JavaScript in there and let the user browse and and it worked really well and the nice thing about that is",
    "start": "998399",
    "end": "1005639"
  },
  {
    "text": "that we could start to map out people like where they were we could figure out in large groups of people who are those",
    "start": "1005639",
    "end": "1013440"
  },
  {
    "text": "thousands of people had connected to a single access point so we decided to",
    "start": "1013440",
    "end": "1018600"
  },
  {
    "text": "talk Target um the the organizers of the 44 conference without them knowing and",
    "start": "1018600",
    "end": "1024640"
  },
  {
    "text": "we decided you know what we're going to see where you guys are doing so I think it's fair if you run a security conference and you use Wi-Fi on it's",
    "start": "1024640",
    "end": "1031839"
  },
  {
    "text": "fair that you're going to get owned um so we did we we owned a lot of them and",
    "start": "1031839",
    "end": "1036918"
  },
  {
    "text": "we looked at their Facebook profiles and went through there this is all through our little drones and it was an",
    "start": "1036919",
    "end": "1042319"
  },
  {
    "text": "interesting story I managed to social engineer my drone to the front of the registration desk by going up to of the",
    "start": "1042319",
    "end": "1049120"
  },
  {
    "text": "ladies and saying listen my phone really needs a charge can you just plug it in for me because it was right at the hall of everybody walking in and it worked a",
    "start": "1049120",
    "end": "1056440"
  },
  {
    "text": "treat and then you know going through this with the power of multi ego I could start to blow up and see where people",
    "start": "1056440",
    "end": "1062919"
  },
  {
    "text": "were interacting and who they're interacting with and their friends now if you take this to the next level if I start targeting you as an organization I",
    "start": "1062919",
    "end": "1070520"
  },
  {
    "text": "can see who the weak spots are I can pretend to be Bob's friend because I can see it there but this changed a lot of things",
    "start": "1070520",
    "end": "1078280"
  },
  {
    "text": "right so Sno newy came out we were in talks with Apple and Google about it and then I think 18 months ago there were a",
    "start": "1078280",
    "end": "1085240"
  },
  {
    "text": "series of bins in London that decided to start tracking your movements by a mobile phone just down the road from the",
    "start": "1085240",
    "end": "1091640"
  },
  {
    "text": "office and that's when we realized wow stuff is going to start changing and it did iOS 7 came and apple made bold",
    "start": "1091640",
    "end": "1098080"
  },
  {
    "text": "claims saying that listen we're going to make it more secure and you're going to get MAC address randomization and everything else which to be honest is",
    "start": "1098080",
    "end": "1103720"
  },
  {
    "text": "out of we've just not seen that happen but Apple did one weird thing that confused us all right Apple did not",
    "start": "1103720",
    "end": "1111880"
  },
  {
    "text": "probe for hidden networks which if you understand a lot about how hidden networks work is that",
    "start": "1111880",
    "end": "1118280"
  },
  {
    "text": "hidden networks devices will not send out a broadcast request with the essid",
    "start": "1118280",
    "end": "1123760"
  },
  {
    "text": "or anything else in there right but there has to be a way to connect to it",
    "start": "1123760",
    "end": "1128799"
  },
  {
    "text": "and what we noticed was is that Apple was not doing this so Dominic went into",
    "start": "1128799",
    "end": "1134080"
  },
  {
    "text": "a little bit of a funny phase where he tried to build a faraday cage so he went to the hardware shop and bought a rather",
    "start": "1134080",
    "end": "1140480"
  },
  {
    "text": "large amount of chicken wire and he's building this Faraday cage on his desk and it's not working then he realized he",
    "start": "1140480",
    "end": "1146360"
  },
  {
    "text": "was pretty crap at maths and he had like a whole lot of Faraday chicken wire on his desk and he got confused and then he",
    "start": "1146360",
    "end": "1153200"
  },
  {
    "text": "thought maybe they were doing it by a location right but then he noticed in his house he had an old boiler water",
    "start": "1153200",
    "end": "1159960"
  },
  {
    "text": "boiler and when he walked behind the water boiler the Network signal was dropped so he was thinking wow I've got",
    "start": "1159960",
    "end": "1165799"
  },
  {
    "text": "my perfect Faraday cage so there he is busy doing this stepping up stepping back and his wife walked in and thought",
    "start": "1165799",
    "end": "1171480"
  },
  {
    "text": "what the hell are you doing and then he realized Apple got around us by not",
    "start": "1171480",
    "end": "1176840"
  },
  {
    "text": "sending out direct probes for hidden networks unless there was at least one",
    "start": "1176840",
    "end": "1182960"
  },
  {
    "text": "hidden network being broadcasted by an access point right so that was quite",
    "start": "1182960",
    "end": "1188600"
  },
  {
    "text": "easy right so all we did to Mana was we patched hose BD to run a hidden network",
    "start": "1188600",
    "end": "1194760"
  },
  {
    "text": "at any given time what this means is that iOS devices even 8.2 and 8.3 once",
    "start": "1194760",
    "end": "1200880"
  },
  {
    "text": "they see a frame for a hidden network they happily give up the preferred network list and go from there now the",
    "start": "1200880",
    "end": "1206480"
  },
  {
    "text": "other interesting thing that we noticed with preferred network lists is that there didn't seem to be any specification as to how long networks",
    "start": "1206480",
    "end": "1213679"
  },
  {
    "text": "were stored in these lists when we were doing Snoopy we noticed that access points I connected to four years ago on",
    "start": "1213679",
    "end": "1220720"
  },
  {
    "text": "completely different devices were being probe for these were access points in China in Thailand where had not been in",
    "start": "1220720",
    "end": "1227679"
  },
  {
    "text": "a very long time so we got in touch with apple and said listen how do you fix this and their response was you don't",
    "start": "1227679",
    "end": "1234440"
  },
  {
    "text": "the only way we could do it is that if we pretended to be each Network and go forget this network because when you go",
    "start": "1234440",
    "end": "1239600"
  },
  {
    "text": "to clear network settings it doesn't delete your preferred network list which is a bit annoying then we thought well",
    "start": "1239600",
    "end": "1246520"
  },
  {
    "text": "how else we can fix the the hidden network thing and then Ian went into a thing where he thought well what happens",
    "start": "1246520",
    "end": "1252120"
  },
  {
    "text": "if we just deal off all the users which is technically possible but it's not the best neut type thing remember we're",
    "start": "1252120",
    "end": "1257559"
  },
  {
    "text": "talking about Stealth here we don't want people to know that there's somebody messing with the Wi-Fi then we did one",
    "start": "1257559",
    "end": "1263320"
  },
  {
    "text": "last thing so remember we talked about the fact that we store our every single Mac address that we see we store the p&l",
    "start": "1263320",
    "end": "1270360"
  },
  {
    "text": "into a little table hash well we thought wouldn't it be pretty cool if at least",
    "start": "1270360",
    "end": "1276840"
  },
  {
    "text": "in a large room like this which is currently running we take everybody's preferred network list and Brass it to",
    "start": "1276840",
    "end": "1283640"
  },
  {
    "text": "everybody and and this is a a a video and it's quite easy to enable it's a simple flag in the karma",
    "start": "1283640",
    "end": "1293039"
  },
  {
    "text": "option so I enable it there and I start it up again and you'll see on the right",
    "start": "1297200",
    "end": "1302279"
  },
  {
    "text": "hand side the Android device so there's a whole lot of devices stored in its p&l and the problem with loud mode is",
    "start": "1302279",
    "end": "1309480"
  },
  {
    "text": "that when you're in a large room um I was doing it during the keyote and I was sending out nearly a th000 access points",
    "start": "1309480",
    "end": "1316799"
  },
  {
    "text": "every minute so it does start to break and unfortunately this little device cannot send out that many frames but it",
    "start": "1316799",
    "end": "1324080"
  },
  {
    "text": "but it works and you can start to see you can't really see it on this one but um I'm sure if a lot of you have turned on your access or your Wi-Fi at the",
    "start": "1324080",
    "end": "1330480"
  },
  {
    "text": "moment you'll notice a hell of lot of access points popping up so that's quite cute and it works and it also increases",
    "start": "1330480",
    "end": "1336440"
  },
  {
    "text": "your attack surface then the next one we wanted to look at was and this was an interesting",
    "start": "1336440",
    "end": "1341919"
  },
  {
    "text": "story um I was in the office and I needed to get some images I like minimal slides so we have an intern and my idea",
    "start": "1341919",
    "end": "1349600"
  },
  {
    "text": "was if I could get an image that portrays securing Wi-Fi cards I thought",
    "start": "1349600",
    "end": "1355200"
  },
  {
    "text": "I know I'm going to put it in a condom all right I didn't have any condoms in the office I'm married I don't need condoms so I said to the young intern",
    "start": "1355200",
    "end": "1362400"
  },
  {
    "text": "who's only 20 21 I was like Jonathan go to the shop and get me some condoms so he's like all right then",
    "start": "1362400",
    "end": "1368880"
  },
  {
    "text": "you're the bus off you go then you know there's my idea like put it in a condom because that's really cool it like it",
    "start": "1368880",
    "end": "1375200"
  },
  {
    "text": "works really well clip arts you know it's like hackers and hoodies then I get a text",
    "start": "1375200",
    "end": "1380240"
  },
  {
    "text": "message from Jonathan saying Tesco only have JX of",
    "start": "1380240",
    "end": "1385840"
  },
  {
    "text": "525 I gave them4 I don't really buy condoms I don't know how much they cost I didn't bring in any more money no",
    "start": "1385840",
    "end": "1391480"
  },
  {
    "text": "anybody that do them or should I come back for more money this is a weird text to send to my",
    "start": "1391480",
    "end": "1396640"
  },
  {
    "text": "boss so it just shows that interns can do stuff when you really make him do so",
    "start": "1396640",
    "end": "1402480"
  },
  {
    "text": "with loud mode and the p&l we fixed Karma right um last year was this 10",
    "start": "1402480",
    "end": "1407679"
  },
  {
    "text": "year anniversary and you know we said to din know listen great tool it's really cool but we fixed",
    "start": "1407679",
    "end": "1413520"
  },
  {
    "text": "it so now karma works for all modern devices um I've not talked a lot about laptops because laptops and other",
    "start": "1413520",
    "end": "1420240"
  },
  {
    "text": "devices really don't do any of the cool stuff that mobiles Do attacking laptops is never been easier right so comma",
    "start": "1420240",
    "end": "1426400"
  },
  {
    "text": "works you can go ahead and enjoy that pull that down now but we didn't want to stop there so",
    "start": "1426400",
    "end": "1432279"
  },
  {
    "text": "we thought okay we're doing the connect part that's easily we we've owned that we've intercepted that but modern",
    "start": "1432279",
    "end": "1437799"
  },
  {
    "text": "devices don't use open networks anymore right unless they're cons like this and",
    "start": "1437799",
    "end": "1442960"
  },
  {
    "text": "they don't use web because let's be honest who uses web they make use of secure networks so I'm talking psk e",
    "start": "1442960",
    "end": "1450080"
  },
  {
    "text": "networks Etc right and the problem with karma is that Karma doesn't work with",
    "start": "1450080",
    "end": "1455640"
  },
  {
    "text": "modern secure networks right because what mobiles do is they know that I",
    "start": "1455640",
    "end": "1460720"
  },
  {
    "text": "connected to sense poost in London and we use uh WPA psk and that it does a",
    "start": "1460720",
    "end": "1466720"
  },
  {
    "text": "compare against the name saying the ific saying this all cool and it gets something back from K and says I'm not going to connect you sorry so there's no",
    "start": "1466720",
    "end": "1473240"
  },
  {
    "text": "Auto join and we thought well that that's pretty sad because that's the modern Wi-Fi world so how do we fix this",
    "start": "1473240",
    "end": "1479960"
  },
  {
    "text": "so we decided in Mana let's build a bit of a more autop ponent own option so we",
    "start": "1479960",
    "end": "1486240"
  },
  {
    "text": "decided let's use some of the cracking tools out there you know we talked about asleep and everything else the problem",
    "start": "1486240",
    "end": "1491480"
  },
  {
    "text": "with those tools is that they didn't move forward in our ability now to crack stuff you know if you look at using",
    "start": "1491480",
    "end": "1497240"
  },
  {
    "text": "Amazon dc2 to crack stuff moxy's Cloud crack which is an amazing resource for smashing Peep and Ms champ right $17",
    "start": "1497240",
    "end": "1505720"
  },
  {
    "text": "you'll pretty much get it back let's use these right so what we decided was the next phase of karma was that we're going",
    "start": "1505720",
    "end": "1512480"
  },
  {
    "text": "to catch any e patch right the nice thing is the device will fail initially",
    "start": "1512480",
    "end": "1517919"
  },
  {
    "text": "but it will always reconnect right and then what most people do is they use",
    "start": "1517919",
    "end": "1523200"
  },
  {
    "text": "free radius WPA right but we thought this is weird because hostapd has its own radio server so why don't we pull it",
    "start": "1523200",
    "end": "1529559"
  },
  {
    "text": "all in house yeah so let's do our cracking let's capture the hash and this could be WPA WPA2 EP Etc Pull It in",
    "start": "1529559",
    "end": "1537200"
  },
  {
    "text": "crack it and then reuse it okay so this video I'm going to show you a modern",
    "start": "1537200",
    "end": "1542880"
  },
  {
    "text": "secure implementation so on the right hand side we've got the device and you can see the always onse secure which is",
    "start": "1542880",
    "end": "1549240"
  },
  {
    "text": "a secured Network and I'm going to show you the details it's Peep and Ms chat V2 and it's got a user and the password is",
    "start": "1549240",
    "end": "1555799"
  },
  {
    "text": "unchanged right on the left hand side I'm going to start or I'm going to tell the um host APD e user you can see it's",
    "start": "1555799",
    "end": "1563919"
  },
  {
    "text": "an empty file at the moment and then I'm going to start Mana but I'm going to this time tell it to Auto crack and AD",
    "start": "1563919",
    "end": "1570679"
  },
  {
    "text": "so what it does is the user tries to connect using a modified Karma it",
    "start": "1570679",
    "end": "1575960"
  },
  {
    "text": "captures the hash then what it does it puts it in it does it really faster it",
    "start": "1575960",
    "end": "1581799"
  },
  {
    "text": "puts it in it tries to crack the hash once it's cracked the hash it puts it into the eat file and then it tries to",
    "start": "1581799",
    "end": "1588360"
  },
  {
    "text": "associate back to that Network and you can see there the user has connected always on secure happy days now we've",
    "start": "1588360",
    "end": "1595200"
  },
  {
    "text": "decided to modify this so that we can push it out to um Cloud cracker or any one of your password you know hacking",
    "start": "1595200",
    "end": "1602080"
  },
  {
    "text": "crashing rigs right and it does it automatically and obviously it requires a a relatively good you know password",
    "start": "1602080",
    "end": "1608880"
  },
  {
    "text": "file to use but what we found in testing is that most people when it comes to mobile phones and I'm sure a lot of you",
    "start": "1608880",
    "end": "1614360"
  },
  {
    "text": "here will slightly agree in your head you don't ever choose really really long strong password when it comes to a",
    "start": "1614360",
    "end": "1619720"
  },
  {
    "text": "mobile phone we all did probably right at the start because it was quite cool but it gets really boring after a while",
    "start": "1619720",
    "end": "1625279"
  },
  {
    "text": "when you're having to type a 27 character password in with different characters it doesn't happen so generally people will choose a less",
    "start": "1625279",
    "end": "1632000"
  },
  {
    "text": "secure password so then the next problem is right so we we've got the connect thing",
    "start": "1632000",
    "end": "1638039"
  },
  {
    "text": "okay we've smashed that we can do quite well with secure networks but let's be",
    "start": "1638039",
    "end": "1643720"
  },
  {
    "text": "honest now how many of you here have got work based mobile phones",
    "start": "1643720",
    "end": "1649480"
  },
  {
    "text": "you can put your hands up how many of you take your personal mobile phone into the office and plug it into a laptop or",
    "start": "1649480",
    "end": "1657080"
  },
  {
    "text": "something to charge up sweet I want to own all of you right",
    "start": "1657080",
    "end": "1662480"
  },
  {
    "text": "because that's what I want to do when it comes to hacking Wi-Fi right so I want to Madden the middle right so I've",
    "start": "1662480",
    "end": "1667960"
  },
  {
    "text": "already connected your phone I've got it to connect to me I've already got your pre-shared key but the m in the middle part has become really really hard right",
    "start": "1667960",
    "end": "1675240"
  },
  {
    "text": "because modern devices now check to see if a connection is legit right so the",
    "start": "1675240",
    "end": "1681039"
  },
  {
    "text": "tools like d sniff Fire Ship Etc don't work right caret sploit only gives us a",
    "start": "1681039",
    "end": "1686320"
  },
  {
    "text": "handful of creds right and you're probably only going to do it if some idiot is connecting to their pop three",
    "start": "1686320",
    "end": "1691559"
  },
  {
    "text": "or something else um incidentally when we did Snoopy testing three years ago at black hat um we asked black hat guys",
    "start": "1691559",
    "end": "1699120"
  },
  {
    "text": "kindly listen can we run it on the network we thought if you're coming to a conference called black hat and you want to do something normal you're a bit",
    "start": "1699120",
    "end": "1705279"
  },
  {
    "text": "special in the head so we ran it and in true fashion you had people buying stuff on Amazon and there was pop three",
    "start": "1705279",
    "end": "1711440"
  },
  {
    "text": "credentials for an insurance company it was like Wow people still do this so that's great old school attacks might",
    "start": "1711440",
    "end": "1717440"
  },
  {
    "text": "still do this but we're after model implementations right and hsts defeats",
    "start": "1717440",
    "end": "1722559"
  },
  {
    "text": "SSL strip and I thought well this is really annoying because we want to start doing this so how do we fix this so a",
    "start": "1722559",
    "end": "1729679"
  },
  {
    "text": "guy called um Thomas rothberger um developed a tool called",
    "start": "1729679",
    "end": "1736399"
  },
  {
    "text": "SSL split and that's why the a hamburger there so just I could remember his name and SSL split is an amazing amazing tool",
    "start": "1736399",
    "end": "1743559"
  },
  {
    "text": "and we thought we need this inside Mana right because we want to start doing interception and the nice thing about",
    "start": "1743559",
    "end": "1748840"
  },
  {
    "text": "SSL split is it does it for non httv ports too so for most modern devices",
    "start": "1748840",
    "end": "1754840"
  },
  {
    "text": "that use SSL for all the connections SSL split works with that so what we decided",
    "start": "1754840",
    "end": "1761039"
  },
  {
    "text": "was we need to somehow get it so that the user is actually connecting to us",
    "start": "1761039",
    "end": "1767240"
  },
  {
    "text": "right so we need to create a man- in the-middle proxy with no Upstream all right so a known fact when you connect",
    "start": "1767240",
    "end": "1774640"
  },
  {
    "text": "to a Wi-Fi network what's the wor first thing your device will do it yeah it tries to bust out it's a",
    "start": "1774640",
    "end": "1782200"
  },
  {
    "text": "bit like Skype skype's the best backdoor tool out there because if there's a way out of the network Skype will find the",
    "start": "1782200",
    "end": "1787320"
  },
  {
    "text": "way same thing with these right so they call out to see if the internet connection is legit if there's a captive",
    "start": "1787320",
    "end": "1793120"
  },
  {
    "text": "portal so for Blackberry Android windows they're quite easy um for the those that",
    "start": "1793120",
    "end": "1798360"
  },
  {
    "text": "still use Blackberry they connect to one site so it was quite easy to that iOS on the other hand you got to give Apple",
    "start": "1798360",
    "end": "1804679"
  },
  {
    "text": "they're pretty good um they hit one over 200 random sites we know this because we",
    "start": "1804679",
    "end": "1812159"
  },
  {
    "text": "try to map out every single site that Apple could do and then they make different things for every two or three",
    "start": "1812159",
    "end": "1818320"
  },
  {
    "text": "attempts they randomly change the user agent so it took us a very long time to work out how to get around this and we",
    "start": "1818320",
    "end": "1824919"
  },
  {
    "text": "did that so inside Mana when you run the no Upstream option we've got our own captive portal right so we've got an",
    "start": "1824919",
    "end": "1831880"
  },
  {
    "text": "Apache V host with all the ones for Blackberry Google um Etc and Android",
    "start": "1831880",
    "end": "1837360"
  },
  {
    "text": "Apple and basically it will connect to that and our Manor captive portal says yep I'm here there's internet access",
    "start": "1837360",
    "end": "1843440"
  },
  {
    "text": "thank you very much so your phone goes sweet I've got internet access right but",
    "start": "1843440",
    "end": "1848960"
  },
  {
    "text": "we want credentials we want to man in the middle you right so we thought how do we do this well let's create a fake",
    "start": "1848960",
    "end": "1855279"
  },
  {
    "text": "captive portal right and we're going to go down the old social engineering thing right we don't want to interfere with",
    "start": "1855279",
    "end": "1860519"
  },
  {
    "text": "any normal coms right we need to Auto um man- INE middle interactions right so we",
    "start": "1860519",
    "end": "1866159"
  },
  {
    "text": "use whisper to open the browser early and we present them with our own captive portal which is not that because that",
    "start": "1866159",
    "end": "1871919"
  },
  {
    "text": "looks like a really well-designed one and we definitely didn't do that and then we thought well okay so if",
    "start": "1871919",
    "end": "1878279"
  },
  {
    "text": "we've got credentials what's the next thing we want to do right and we noticed some weird interactions the way that mobile devices",
    "start": "1878279",
    "end": "1885880"
  },
  {
    "text": "handle root casa so we thought the best way of doing full interception is that we can push in a",
    "start": "1885880",
    "end": "1892639"
  },
  {
    "text": "rogue CA into a device well then we're winning and it's game over you know Happy Days and we thought well this",
    "start": "1892639",
    "end": "1899320"
  },
  {
    "text": "should be quite hard to do right you know everybody wants to be the NSA and do that but to be honest that's actually",
    "start": "1899320",
    "end": "1904679"
  },
  {
    "text": "quite hard well what we found was something completely different um and",
    "start": "1904679",
    "end": "1909960"
  },
  {
    "text": "look everybody knows Android is not a secure mobile operating system that that's a given when Google Engineers are",
    "start": "1909960",
    "end": "1915279"
  },
  {
    "text": "emitting them and have built it for security we kind of expected installing a root CA should be a little bit harder",
    "start": "1915279",
    "end": "1921799"
  },
  {
    "text": "but alas it's not so we have a captive portal that's got a malicious root CA",
    "start": "1921799",
    "end": "1928000"
  },
  {
    "text": "and we can push that in so here's where it starts to get cool all right on a",
    "start": "1928000",
    "end": "1933200"
  },
  {
    "text": "mobile device uh SSL strip works because it's got but SSL strip doesn't work",
    "start": "1933200",
    "end": "1939799"
  },
  {
    "text": "because of htb strict transport policy right so what hsts does and I'm sure a",
    "start": "1939799",
    "end": "1945240"
  },
  {
    "text": "lot of you have seen this is that it tells the browser connecting to it that",
    "start": "1945240",
    "end": "1950679"
  },
  {
    "text": "this site should only ever be connected to on Port 443 right and so the old Moxy",
    "start": "1950679",
    "end": "1957200"
  },
  {
    "text": "tool worked by let's say me going to accounts.google.com right I type in",
    "start": "1957200",
    "end": "1963679"
  },
  {
    "text": "https.com SSL strip would take it back down to http and then I could do",
    "start": "1963679",
    "end": "1968840"
  },
  {
    "text": "interception that way right that was cool but the browser manufacturers got better and stopped that well hsts tells",
    "start": "1968840",
    "end": "1976240"
  },
  {
    "text": "the browser to always access this via SSL so at blackout Asia last year a",
    "start": "1976240",
    "end": "1981279"
  },
  {
    "text": "gentleman came up with a really cool way of doing this right and we thought well we need to put this into mana and",
    "start": "1981279",
    "end": "1987960"
  },
  {
    "text": "generally this is what would happen if you use old SSL man- INE middle tools",
    "start": "1987960",
    "end": "1993320"
  },
  {
    "text": "against a modern intercept a modern device right and we thought that's pointless because if we want to intercept credentials we need to have",
    "start": "1993320",
    "end": "2000240"
  },
  {
    "text": "not have this happen so we lonardo MBA last year at black Asia um wrote a very",
    "start": "2000240",
    "end": "2006639"
  },
  {
    "text": "cool uh tool called um um it sorry I forgot the name of the tool actually uh",
    "start": "2006639",
    "end": "2011760"
  },
  {
    "text": "but one of the things is DNS proxy and how it works is this so you have a browser on your device or on your laptop",
    "start": "2011760",
    "end": "2018960"
  },
  {
    "text": "and it want wants to connect to google.com right no is the H https how DNS proxy and SSL strip works",
    "start": "2018960",
    "end": "2027039"
  },
  {
    "text": "is that SSL strip gets in and it redirects it back to http triple ww.google.com so do you",
    "start": "2027039",
    "end": "2036120"
  },
  {
    "text": "notice the xrw there right there is no hsts for that right so the browser goes",
    "start": "2036120",
    "end": "2043760"
  },
  {
    "text": "well I've not been told about this so that's cool so I'm going to let them do that then DNS proxy handles all the DNS",
    "start": "2043760",
    "end": "2050000"
  },
  {
    "text": "requests so that's HTTP www.google.com gets redirected to our",
    "start": "2050000",
    "end": "2055358"
  },
  {
    "text": "own malicious version right and then we can do interception there okay and it gets responded back to the browser right",
    "start": "2055359",
    "end": "2062280"
  },
  {
    "text": "so we can now do interception and this works really well so here's a video showing how it does it",
    "start": "2062280",
    "end": "2069720"
  },
  {
    "text": "so here in this one I'm I'm going to a site I've never been to before and here's our captive portal and basically",
    "start": "2074919",
    "end": "2080960"
  },
  {
    "text": "the premise is here we need to get credentials right so you can log in with oor options or you can just add your",
    "start": "2080960",
    "end": "2086358"
  },
  {
    "text": "username and password and so we do that and we add in ah haacker gmail.com",
    "start": "2086359",
    "end": "2093440"
  },
  {
    "text": "we put the password in I mean it looks legit it's it's got a nice logo and as everything in Security",
    "start": "2093440",
    "end": "2099680"
  },
  {
    "text": "today if you don't have a logo it's not proper research and we go through our access log and there's the username and",
    "start": "2099680",
    "end": "2105920"
  },
  {
    "text": "password right so that that's pretty cool that should catch a few people right but we want more okay so then what",
    "start": "2105920",
    "end": "2113960"
  },
  {
    "text": "we do is we decide all right let's go to google.com let's bypass H hsts so you",
    "start": "2113960",
    "end": "2121400"
  },
  {
    "text": "already noticed that the proxy changed it to wwww.com and I'm going to try and sign",
    "start": "2121400",
    "end": "2126680"
  },
  {
    "text": "in again w ww.google.com right this is actually the Google page it's just on",
    "start": "2126680",
    "end": "2132640"
  },
  {
    "text": "HTTP so I enter my details a hacker and a really cool secure password click sign",
    "start": "2132640",
    "end": "2140520"
  },
  {
    "text": "in go through my logs and there's my username and password cool so we've got pass hsts",
    "start": "2141720",
    "end": "2149880"
  },
  {
    "text": "which works really well but like I said we want to go one",
    "start": "2149880",
    "end": "2156160"
  },
  {
    "text": "step further so let's go to back to.com and we like",
    "start": "2156160",
    "end": "2161720"
  },
  {
    "text": "being helpful at sense poost we thought well let's autoconfigure the thing for for the user because we think that's a",
    "start": "2161720",
    "end": "2167839"
  },
  {
    "text": "nice thing to do so now here's the question Android does one weird thing",
    "start": "2167839",
    "end": "2173599"
  },
  {
    "text": "all Android wants from you for installing a malicious Rogue CA is for you to give it a name and it gets",
    "start": "2173599",
    "end": "2179200"
  },
  {
    "text": "installed it does tell you that this network be may be monitored but my rogue CA has just been put in your certificate",
    "start": "2179200",
    "end": "2185480"
  },
  {
    "text": "store okay which is a bit special um iOS just asks for your PIN code and again",
    "start": "2185480",
    "end": "2191079"
  },
  {
    "text": "happily installs it so we think this is a bit bit backward way of doing things right devices should not just willingly",
    "start": "2191079",
    "end": "2198040"
  },
  {
    "text": "accept any CER that's pushed over the wire to them and saying it looks legit I'll put that in what's your PIN number",
    "start": "2198040",
    "end": "2204240"
  },
  {
    "text": "by the way so we found it was really easy obviously once you've got a rogue sier in there well then you know",
    "start": "2204240",
    "end": "2209680"
  },
  {
    "text": "everything's happy so then the next thing is fire Lam",
    "start": "2209680",
    "end": "2216200"
  },
  {
    "text": "and fire sheep right how do we get around this so we've now got them to connect we've broken the you know",
    "start": "2216200",
    "end": "2223000"
  },
  {
    "text": "pre-shared key we're going through the Y and getting all their passwords we've gained access to say the corporate land we're down doing man in the middle",
    "start": "2223000",
    "end": "2229800"
  },
  {
    "text": "problem is we now want to look at everything going across the wire now fire sheep doesn't work anymore which is",
    "start": "2229800",
    "end": "2235839"
  },
  {
    "text": "a bit annoying so we thought well we need to rewrite this and we called it fire L right now the cool thing about",
    "start": "2235839",
    "end": "2241400"
  },
  {
    "text": "fire Lam is that it does what fire sheep used to do right but we decided to change it a little bit so we wrote fire",
    "start": "2241400",
    "end": "2247720"
  },
  {
    "text": "Lam to go through and use net creds and all the other password scraping tools you can on the wire and we will build it",
    "start": "2247720",
    "end": "2255160"
  },
  {
    "text": "into a per user Firefox profile for you right so every single time you're on a",
    "start": "2255160",
    "end": "2261000"
  },
  {
    "text": "network if it's on a busy Network we don't want to have loads of different credentials stored everywhere we thought it'd be quite nice if we could just make",
    "start": "2261000",
    "end": "2267240"
  },
  {
    "text": "one Firefox profile for Bob one Firefox profile for Alice and go from there and that worked out really well so I've got",
    "start": "2267240",
    "end": "2274599"
  },
  {
    "text": "a video of fireand working",
    "start": "2274599",
    "end": "2278560"
  },
  {
    "text": "so again there's all my broadcast requests I'm already on the network I'm doing full man in the middle you can see everything going on the left hand side",
    "start": "2283200",
    "end": "2289760"
  },
  {
    "text": "so my rug Rogue CA is also installed so I'm going to go to accounts.google.com",
    "start": "2289760",
    "end": "2297480"
  },
  {
    "text": "it's funny even when you're doing videos people type slowly",
    "start": "2299560",
    "end": "2305440"
  },
  {
    "text": "and it save my username and password click sign",
    "start": "2308319",
    "end": "2313119"
  },
  {
    "text": "in notice it's https so I'm still doing man in the middle I now got a",
    "start": "2317720",
    "end": "2325560"
  },
  {
    "text": "facebook.com notice hsts bypass",
    "start": "2326839",
    "end": "2332000"
  },
  {
    "text": "on the left hand side you can still see other sites that we're intercepting pulling down so we log into",
    "start": "2354079",
    "end": "2361680"
  },
  {
    "text": "Facebook and one of the biggest problems we noticed is that when we had firi um Mana running in our our test cases and",
    "start": "2364640",
    "end": "2371079"
  },
  {
    "text": "we had lots of people being intercepted storing this data was really hard because if you look in the left hand side there's so much information going",
    "start": "2371079",
    "end": "2377640"
  },
  {
    "text": "on the past we're like how do we deal with this we're now getting credentials raining down but we don't have an umbrella we don't know what to do with",
    "start": "2377640",
    "end": "2383359"
  },
  {
    "text": "it and this was one of the premises for fireand we want it to make a lot better so I'm good I've got these certificates",
    "start": "2383359",
    "end": "2390400"
  },
  {
    "text": "what can I do next go through and use Facebook do what",
    "start": "2390400",
    "end": "2396240"
  },
  {
    "text": "you have to do in Facebook",
    "start": "2396240",
    "end": "2399319"
  },
  {
    "text": "write a post this is just to show that this is a legitimate Facebook connection going over",
    "start": "2404000",
    "end": "2411279"
  },
  {
    "text": "https because that's something you always ask your mother",
    "start": "2417720",
    "end": "2423040"
  },
  {
    "text": "I've now gone into Google Mail anybody here use Google mail and Android so I'm going to compose a",
    "start": "2438119",
    "end": "2444440"
  },
  {
    "text": "message again this should all be protected by certificate pinning",
    "start": "2444440",
    "end": "2450040"
  },
  {
    "text": "hsts for",
    "start": "2456240",
    "end": "2460280"
  },
  {
    "text": "all right so I'm going to go back to the machine that's running mana and I'm going to go into the fire fire Lem",
    "start": "2490520",
    "end": "2498480"
  },
  {
    "text": "option and you'll see here it creates a series of profiles so it found seven cookie folders and it does it on a Mac",
    "start": "2501319",
    "end": "2507280"
  },
  {
    "text": "address or IP address so I said well which one want to open up and it pre-populates it into a nice Firefox",
    "start": "2507280",
    "end": "2513200"
  },
  {
    "text": "profile and then I can go there click on Google and it logs me in as that person",
    "start": "2513200",
    "end": "2519240"
  },
  {
    "text": "details and it does this on a you know per user basis we do need to clean up that page a little bit there's no CSS so",
    "start": "2523079",
    "end": "2529720"
  },
  {
    "text": "it doesn't look sexy but it's it's one of the things that we need to do soon so we finally have it we now have",
    "start": "2529720",
    "end": "2536640"
  },
  {
    "text": "credentials raining from the sky and and we spent about four months testing this like I said we did the initial proof of",
    "start": "2536640",
    "end": "2542200"
  },
  {
    "text": "con Defcon last year and there were a lot of big bug fixes um and we found if it worked Defcon when it came to the",
    "start": "2542200",
    "end": "2548440"
  },
  {
    "text": "volume of devices it would work anywhere else in the world and Dominic Ian and myself spend a large chunk of time",
    "start": "2548440",
    "end": "2553880"
  },
  {
    "text": "fixing the stuff and it kind of works now um so that's it it's it's available",
    "start": "2553880",
    "end": "2559440"
  },
  {
    "text": "from our GitHub sense poost account um or and there's more details on our sense post blog and then the cool thing was is",
    "start": "2559440",
    "end": "2566319"
  },
  {
    "text": "that we had a really nice um Kudos from uh the Cali guys and that they released",
    "start": "2566319",
    "end": "2571760"
  },
  {
    "text": "a device called net Hunter anybody here got net Hunter cool so the nice thing is is that",
    "start": "2571760",
    "end": "2577720"
  },
  {
    "text": "nent Hunter comes with oneclick Mana evil access point so it was quite a cool Kudos from the offensive security",
    "start": "2577720",
    "end": "2585440"
  },
  {
    "text": "guys thank [Applause]",
    "start": "2585440",
    "end": "2594040"
  },
  {
    "text": "you and just to show you here is loud loud mode working if it's not fallen over no it's",
    "start": "2594040",
    "end": "2600079"
  },
  {
    "text": "fallen over sorry but I mean you can see these are all the responses that I'm going through the room",
    "start": "2600079",
    "end": "2607480"
  },
  {
    "text": "oh it's not come up okay sorry why is that not",
    "start": "2607480",
    "end": "2611920"
  },
  {
    "text": "working so these are every single response in the",
    "start": "2612880",
    "end": "2618319"
  },
  {
    "text": "room I'm not going to slow it down because you probably will see some of your devices in there cool thank you",
    "start": "2618319",
    "end": "2624079"
  },
  {
    "text": "very much any",
    "start": "2624079",
    "end": "2629960"
  },
  {
    "text": "questions cool thanks yeah you can turn your wife now",
    "start": "2631520",
    "end": "2640440"
  }
]