[
  {
    "text": "[Music]",
    "start": "1130",
    "end": "14690"
  },
  {
    "text": "hi everyone welcome to our talk dabbing",
    "start": "15280",
    "end": "18000"
  },
  {
    "text": "into supporter discovery discovering lp",
    "start": "18000",
    "end": "21119"
  },
  {
    "text": "and rc vulnerabilities in windows",
    "start": "21119",
    "end": "22960"
  },
  {
    "text": "printer",
    "start": "22960",
    "end": "24400"
  },
  {
    "text": "this is sherfoni i'm a security",
    "start": "24400",
    "end": "26400"
  },
  {
    "text": "researcher of sample force research team",
    "start": "26400",
    "end": "29119"
  },
  {
    "text": "this research is a joint work with dr",
    "start": "29119",
    "end": "31439"
  },
  {
    "text": "jin lampong and luis lee",
    "start": "31439",
    "end": "33520"
  },
  {
    "text": "dr jinpong is a principal security",
    "start": "33520",
    "end": "35600"
  },
  {
    "text": "researcher of sample force",
    "start": "35600",
    "end": "38079"
  },
  {
    "text": "lewis lee is a security researcher of",
    "start": "38079",
    "end": "40719"
  },
  {
    "text": "sample force research team",
    "start": "40719",
    "end": "43040"
  },
  {
    "text": "it's our pleasure to hear to share",
    "start": "43040",
    "end": "45360"
  },
  {
    "text": "research",
    "start": "45360",
    "end": "47039"
  },
  {
    "text": "in the past year we have found the most",
    "start": "47039",
    "end": "48960"
  },
  {
    "text": "fun several lp and rc bugs in windows",
    "start": "48960",
    "end": "52480"
  },
  {
    "text": "printer",
    "start": "52480",
    "end": "53520"
  },
  {
    "text": "in this presentation we'll disclosure",
    "start": "53520",
    "end": "55440"
  },
  {
    "text": "the sparks and our exploring approach",
    "start": "55440",
    "end": "58000"
  },
  {
    "text": "for them",
    "start": "58000",
    "end": "59520"
  },
  {
    "text": "here is our agenda in the past year we",
    "start": "59520",
    "end": "61760"
  },
  {
    "text": "have conducted some research on the",
    "start": "61760",
    "end": "63760"
  },
  {
    "text": "printer's pool",
    "start": "63760",
    "end": "65360"
  },
  {
    "text": "in this talk",
    "start": "65360",
    "end": "66560"
  },
  {
    "text": "we will introduce some lp and rc",
    "start": "66560",
    "end": "69439"
  },
  {
    "text": "vulnerabilities our printer's puller and",
    "start": "69439",
    "end": "71680"
  },
  {
    "text": "the shell and the share always is",
    "start": "71680",
    "end": "73920"
  },
  {
    "text": "deployed approach for them",
    "start": "73920",
    "end": "76640"
  },
  {
    "text": "and",
    "start": "76640",
    "end": "77439"
  },
  {
    "text": "now how could we bypass the patch or",
    "start": "77439",
    "end": "79680"
  },
  {
    "text": "microsoft choose to explore this box",
    "start": "79680",
    "end": "82080"
  },
  {
    "text": "again",
    "start": "82080",
    "end": "84400"
  },
  {
    "text": "the primary component of printing",
    "start": "85520",
    "end": "88560"
  },
  {
    "text": "interface is a princess product the",
    "start": "88560",
    "end": "91280"
  },
  {
    "text": "print scroller is an",
    "start": "91280",
    "end": "93119"
  },
  {
    "text": "executable file that manages the",
    "start": "93119",
    "end": "95280"
  },
  {
    "text": "printing process",
    "start": "95280",
    "end": "97119"
  },
  {
    "text": "it is exposed the functionality for add",
    "start": "97119",
    "end": "100720"
  },
  {
    "text": "or remove a new printer",
    "start": "100720",
    "end": "103680"
  },
  {
    "text": "and allow user to configure the new",
    "start": "103680",
    "end": "105759"
  },
  {
    "text": "printer",
    "start": "105759",
    "end": "106960"
  },
  {
    "text": "support high level function course into",
    "start": "106960",
    "end": "109360"
  },
  {
    "text": "your print job",
    "start": "109360",
    "end": "111920"
  },
  {
    "text": "receive printer jobs and schedule the",
    "start": "111920",
    "end": "114000"
  },
  {
    "text": "printer job for printing",
    "start": "114000",
    "end": "116159"
  },
  {
    "text": "as we know",
    "start": "116159",
    "end": "117680"
  },
  {
    "text": "window printer is based on our pc model",
    "start": "117680",
    "end": "121280"
  },
  {
    "text": "by using the xposed rpc interface we can",
    "start": "121280",
    "end": "124159"
  },
  {
    "text": "add a new printer and we will fully",
    "start": "124159",
    "end": "126479"
  },
  {
    "text": "control the printer then we can",
    "start": "126479",
    "end": "128640"
  },
  {
    "text": "configure this printer create some",
    "start": "128640",
    "end": "131039"
  },
  {
    "text": "printer jobs print bring the jobs to",
    "start": "131039",
    "end": "133360"
  },
  {
    "text": "print the port and manage these printer",
    "start": "133360",
    "end": "135680"
  },
  {
    "text": "jobs",
    "start": "135680",
    "end": "137440"
  },
  {
    "text": "all of the bombs are accompanied by the",
    "start": "137440",
    "end": "139840"
  },
  {
    "text": "high level privilege privilege process",
    "start": "139840",
    "end": "143360"
  },
  {
    "text": "support sv esc",
    "start": "143360",
    "end": "146239"
  },
  {
    "text": "the main component of the rpc core is",
    "start": "146239",
    "end": "149680"
  },
  {
    "text": "its local spl",
    "start": "149680",
    "end": "151519"
  },
  {
    "text": "dell",
    "start": "151519",
    "end": "152560"
  },
  {
    "text": "the client can choose to interact with",
    "start": "152560",
    "end": "154879"
  },
  {
    "text": "the school locally or mostly",
    "start": "154879",
    "end": "157680"
  },
  {
    "text": "which provides us with a local and",
    "start": "157680",
    "end": "160400"
  },
  {
    "text": "remote attempt service",
    "start": "160400",
    "end": "163599"
  },
  {
    "text": "we are not going to talk tomorrow too",
    "start": "163599",
    "end": "165599"
  },
  {
    "text": "much about the basics of school",
    "start": "165599",
    "end": "168480"
  },
  {
    "text": "there have been a lot of public research",
    "start": "168480",
    "end": "170800"
  },
  {
    "text": "about this",
    "start": "170800",
    "end": "172080"
  },
  {
    "text": "you can read them by yourself",
    "start": "172080",
    "end": "175599"
  },
  {
    "text": "so let's go straight for the",
    "start": "175920",
    "end": "177360"
  },
  {
    "text": "vulnerabilities",
    "start": "177360",
    "end": "179440"
  },
  {
    "text": "our journey of poland security research",
    "start": "179440",
    "end": "181920"
  },
  {
    "text": "begins with",
    "start": "181920",
    "end": "183120"
  },
  {
    "text": "cve",
    "start": "183120",
    "end": "184640"
  },
  {
    "text": "2020 10 48",
    "start": "184640",
    "end": "187680"
  },
  {
    "text": "also called the printer daemon",
    "start": "187680",
    "end": "189680"
  },
  {
    "text": "it's a logical bug",
    "start": "189680",
    "end": "191519"
  },
  {
    "text": "you can inspire this spark to white",
    "start": "191519",
    "end": "194239"
  },
  {
    "text": "to write arbitrary",
    "start": "194239",
    "end": "196080"
  },
  {
    "text": "content into arbitrary files",
    "start": "196080",
    "end": "198400"
  },
  {
    "text": "the vulnerability is in the printing",
    "start": "198400",
    "end": "200560"
  },
  {
    "text": "process",
    "start": "200560",
    "end": "201840"
  },
  {
    "text": "let's quickly review the exporting",
    "start": "201840",
    "end": "203920"
  },
  {
    "text": "process of the",
    "start": "203920",
    "end": "205760"
  },
  {
    "text": "vulnerability",
    "start": "205760",
    "end": "207280"
  },
  {
    "text": "the first thing you should add a printed",
    "start": "207280",
    "end": "209440"
  },
  {
    "text": "job to pin the driver the driver must be",
    "start": "209440",
    "end": "212080"
  },
  {
    "text": "a known printed driver in your computer",
    "start": "212080",
    "end": "214560"
  },
  {
    "text": "such as",
    "start": "214560",
    "end": "216560"
  },
  {
    "text": "generic",
    "start": "216560",
    "end": "217920"
  },
  {
    "text": "slash text only",
    "start": "217920",
    "end": "220080"
  },
  {
    "text": "then you should add a new printed port",
    "start": "220080",
    "end": "223120"
  },
  {
    "text": "a printer port can be a file port the",
    "start": "223120",
    "end": "225680"
  },
  {
    "text": "file pass",
    "start": "225680",
    "end": "226959"
  },
  {
    "text": "can be a protected protected position",
    "start": "226959",
    "end": "230159"
  },
  {
    "text": "for median user such as",
    "start": "230159",
    "end": "232640"
  },
  {
    "text": "c",
    "start": "232640",
    "end": "233360"
  },
  {
    "text": "band slash windows backslash season 32",
    "start": "233360",
    "end": "236319"
  },
  {
    "text": "backslash one dose txt",
    "start": "236319",
    "end": "239760"
  },
  {
    "text": "your printer will then output the",
    "start": "239760",
    "end": "242080"
  },
  {
    "text": "contents of the printer job to this port",
    "start": "242080",
    "end": "245360"
  },
  {
    "text": "after you have added the printer driver",
    "start": "245360",
    "end": "247599"
  },
  {
    "text": "and the printer port you can add a new",
    "start": "247599",
    "end": "249439"
  },
  {
    "text": "printer called printer dma in your",
    "start": "249439",
    "end": "251120"
  },
  {
    "text": "computer and specify the printer driver",
    "start": "251120",
    "end": "253760"
  },
  {
    "text": "and the printer port for your printer",
    "start": "253760",
    "end": "256000"
  },
  {
    "text": "then you can either add a printer job to",
    "start": "256000",
    "end": "258560"
  },
  {
    "text": "your printer and specify what need will",
    "start": "258560",
    "end": "260799"
  },
  {
    "text": "need to be printed",
    "start": "260799",
    "end": "262960"
  },
  {
    "text": "the key step of the exploitation is",
    "start": "262960",
    "end": "265600"
  },
  {
    "text": "starting smaller while starting your",
    "start": "265600",
    "end": "267440"
  },
  {
    "text": "computer",
    "start": "267440",
    "end": "268560"
  },
  {
    "text": "this state lead to the logical bug after",
    "start": "268560",
    "end": "271280"
  },
  {
    "text": "you force the supporter service to start",
    "start": "271280",
    "end": "273840"
  },
  {
    "text": "to restart you can resume the printer",
    "start": "273840",
    "end": "276320"
  },
  {
    "text": "job and then",
    "start": "276320",
    "end": "277840"
  },
  {
    "text": "the content of the printer job will be",
    "start": "277840",
    "end": "280800"
  },
  {
    "text": "written to the printer port you specify",
    "start": "280800",
    "end": "284320"
  },
  {
    "text": "here is",
    "start": "284320",
    "end": "285440"
  },
  {
    "text": "see back slash windows backslash",
    "start": "285440",
    "end": "287680"
  },
  {
    "text": "system32 backslash one",
    "start": "287680",
    "end": "290479"
  },
  {
    "text": "dot tst",
    "start": "290479",
    "end": "293120"
  },
  {
    "text": "so what's why the spark happens when",
    "start": "293120",
    "end": "296479"
  },
  {
    "text": "user add printer drops to local printer",
    "start": "296479",
    "end": "298880"
  },
  {
    "text": "queue",
    "start": "298880",
    "end": "299680"
  },
  {
    "text": "spooler will save the information of the",
    "start": "299680",
    "end": "301680"
  },
  {
    "text": "printer jobs to lock disk",
    "start": "301680",
    "end": "303840"
  },
  {
    "text": "and those silver printer jobs are called",
    "start": "303840",
    "end": "305759"
  },
  {
    "text": "shadow jobs",
    "start": "305759",
    "end": "307120"
  },
  {
    "text": "usually user will start this printer job",
    "start": "307120",
    "end": "310000"
  },
  {
    "text": "immediately and this puller will",
    "start": "310000",
    "end": "312320"
  },
  {
    "text": "impersonate the user and",
    "start": "312320",
    "end": "314479"
  },
  {
    "text": "write the printer job to printer port",
    "start": "314479",
    "end": "317120"
  },
  {
    "text": "so even if media users have specified",
    "start": "317120",
    "end": "320080"
  },
  {
    "text": "the printer port to a protected position",
    "start": "320080",
    "end": "322479"
  },
  {
    "text": "such as",
    "start": "322479",
    "end": "323600"
  },
  {
    "text": "c by slash windows slash system32 and",
    "start": "323600",
    "end": "326960"
  },
  {
    "text": "slash one dot l",
    "start": "326960",
    "end": "329759"
  },
  {
    "text": "median user can still cannot abuse",
    "start": "329759",
    "end": "331680"
  },
  {
    "text": "spooler to output to output",
    "start": "331680",
    "end": "334400"
  },
  {
    "text": "output output printer job to the",
    "start": "334400",
    "end": "336800"
  },
  {
    "text": "protected position",
    "start": "336800",
    "end": "338800"
  },
  {
    "text": "this is a normal printing process",
    "start": "338800",
    "end": "342560"
  },
  {
    "text": "but something terrible would happen when",
    "start": "342560",
    "end": "344880"
  },
  {
    "text": "people do not follow the normal process",
    "start": "344880",
    "end": "349440"
  },
  {
    "text": "when user added add adder printer job to",
    "start": "349680",
    "end": "352080"
  },
  {
    "text": "print the queue but he forgot to zoom",
    "start": "352080",
    "end": "354479"
  },
  {
    "text": "the printer job and then restart his",
    "start": "354479",
    "end": "356400"
  },
  {
    "text": "computer the shutter job in the printer",
    "start": "356400",
    "end": "358800"
  },
  {
    "text": "queue won't be deleted",
    "start": "358800",
    "end": "360720"
  },
  {
    "text": "if a user resumes this print this",
    "start": "360720",
    "end": "362800"
  },
  {
    "text": "printer job support service cannot fund",
    "start": "362800",
    "end": "365280"
  },
  {
    "text": "the credit user to killing personnel",
    "start": "365280",
    "end": "368960"
  },
  {
    "text": "by imposing himself the system user",
    "start": "368960",
    "end": "372240"
  },
  {
    "text": "and then output the printer job to user",
    "start": "372240",
    "end": "374880"
  },
  {
    "text": "controllable printer port with system",
    "start": "374880",
    "end": "376720"
  },
  {
    "text": "privilege",
    "start": "376720",
    "end": "378000"
  },
  {
    "text": "this will cause an arbitrary file",
    "start": "378000",
    "end": "380639"
  },
  {
    "text": "writing issue and a little lpe",
    "start": "380639",
    "end": "384960"
  },
  {
    "text": "so how did microsoft fix this spark as",
    "start": "384960",
    "end": "388080"
  },
  {
    "text": "we know to support this part you need to",
    "start": "388080",
    "end": "390400"
  },
  {
    "text": "specify the printer port to the",
    "start": "390400",
    "end": "392479"
  },
  {
    "text": "protected position because there is no",
    "start": "392479",
    "end": "395360"
  },
  {
    "text": "check on the printer port you can",
    "start": "395360",
    "end": "397360"
  },
  {
    "text": "specify the printer port to any position",
    "start": "397360",
    "end": "400000"
  },
  {
    "text": "so microsoft adder function called port",
    "start": "400000",
    "end": "402240"
  },
  {
    "text": "is valid to check if the user",
    "start": "402240",
    "end": "404639"
  },
  {
    "text": "has",
    "start": "404639",
    "end": "405440"
  },
  {
    "text": "right permission to the printer port",
    "start": "405440",
    "end": "408000"
  },
  {
    "text": "what print what product is valid and",
    "start": "408000",
    "end": "409919"
  },
  {
    "text": "that is to call create a file while",
    "start": "409919",
    "end": "412960"
  },
  {
    "text": "impersonating the user to check if the",
    "start": "412960",
    "end": "415840"
  },
  {
    "text": "printer port is user controllable",
    "start": "415840",
    "end": "418960"
  },
  {
    "text": "if media users specify a protected",
    "start": "418960",
    "end": "421440"
  },
  {
    "text": "position this function must return fail",
    "start": "421440",
    "end": "424240"
  },
  {
    "text": "but if you are format for many of",
    "start": "424240",
    "end": "426960"
  },
  {
    "text": "familiar with",
    "start": "426960",
    "end": "428240"
  },
  {
    "text": "pass redirection attack in windows",
    "start": "428240",
    "end": "430240"
  },
  {
    "text": "system",
    "start": "430240",
    "end": "431440"
  },
  {
    "text": "you should realize this patch is an",
    "start": "431440",
    "end": "433280"
  },
  {
    "text": "incomplete fix",
    "start": "433280",
    "end": "435680"
  },
  {
    "text": "here we provide to you an approach to",
    "start": "435680",
    "end": "438479"
  },
  {
    "text": "bypass the patch firstly let's focus on",
    "start": "438479",
    "end": "441120"
  },
  {
    "text": "the case one of the case one our main",
    "start": "441120",
    "end": "443680"
  },
  {
    "text": "idea is to use device symbol links here",
    "start": "443680",
    "end": "446400"
  },
  {
    "text": "we can use file test to do it let's look",
    "start": "446400",
    "end": "449039"
  },
  {
    "text": "at the picture what we need to do is to",
    "start": "449039",
    "end": "451840"
  },
  {
    "text": "fill the links source and the target",
    "start": "451840",
    "end": "454639"
  },
  {
    "text": "the source is the empty path of state",
    "start": "454639",
    "end": "456720"
  },
  {
    "text": "driver and the target in the device path",
    "start": "456720",
    "end": "459840"
  },
  {
    "text": "of d driver",
    "start": "459840",
    "end": "461680"
  },
  {
    "text": "after clicking the button to create",
    "start": "461680",
    "end": "463599"
  },
  {
    "text": "simulink",
    "start": "463599",
    "end": "464400"
  },
  {
    "text": "our c driver will be redirect to d",
    "start": "464400",
    "end": "467280"
  },
  {
    "text": "driver",
    "start": "467280",
    "end": "469360"
  },
  {
    "text": "but it was nothing that this symbolic is",
    "start": "469360",
    "end": "471919"
  },
  {
    "text": "only valid for the current user after",
    "start": "471919",
    "end": "474639"
  },
  {
    "text": "creating the device symbolic",
    "start": "474639",
    "end": "477680"
  },
  {
    "text": "for the server running with system",
    "start": "477680",
    "end": "479680"
  },
  {
    "text": "privilege if the server impersonates the",
    "start": "479680",
    "end": "482400"
  },
  {
    "text": "client",
    "start": "482400",
    "end": "483599"
  },
  {
    "text": "c backslash windows backslash oneplus",
    "start": "483599",
    "end": "487039"
  },
  {
    "text": "tft will be reduced redirected to",
    "start": "487039",
    "end": "491039"
  },
  {
    "text": "d backslash windows bank slash one dose",
    "start": "491039",
    "end": "494560"
  },
  {
    "text": "tst otherwise if server runs in system",
    "start": "494560",
    "end": "499280"
  },
  {
    "text": "privilege and open this file the pass",
    "start": "499280",
    "end": "502160"
  },
  {
    "text": "reduction won't occur",
    "start": "502160",
    "end": "505120"
  },
  {
    "text": "so how to respond this spark first",
    "start": "505120",
    "end": "507759"
  },
  {
    "text": "create a device simulink from",
    "start": "507759",
    "end": "510400"
  },
  {
    "text": "c driver to d driver and then excuse the",
    "start": "510400",
    "end": "513440"
  },
  {
    "text": "powershell command to create the printer",
    "start": "513440",
    "end": "515360"
  },
  {
    "text": "ports in a protected protected location",
    "start": "515360",
    "end": "518800"
  },
  {
    "text": "which will trigger the server",
    "start": "518800",
    "end": "520560"
  },
  {
    "text": "impersonator client and then cross the",
    "start": "520560",
    "end": "522479"
  },
  {
    "text": "positive body the function to check",
    "start": "522479",
    "end": "524480"
  },
  {
    "text": "whether the port is body due to the",
    "start": "524480",
    "end": "526640"
  },
  {
    "text": "device simulink",
    "start": "526640",
    "end": "528399"
  },
  {
    "text": "the actual check pass will be directly",
    "start": "528399",
    "end": "531440"
  },
  {
    "text": "directed to the backslash windows",
    "start": "531440",
    "end": "533920"
  },
  {
    "text": "backslash system 32 backslash one dose",
    "start": "533920",
    "end": "537519"
  },
  {
    "text": "tst and z pass is user controllable then",
    "start": "537519",
    "end": "541279"
  },
  {
    "text": "the check is passed",
    "start": "541279",
    "end": "544320"
  },
  {
    "text": "then let's talk about",
    "start": "545040",
    "end": "547440"
  },
  {
    "text": "the other",
    "start": "547440",
    "end": "548880"
  },
  {
    "text": "approach using junction we first excuse",
    "start": "548880",
    "end": "551760"
  },
  {
    "text": "the portion command on the client side",
    "start": "551760",
    "end": "554320"
  },
  {
    "text": "and specified a user controllable path",
    "start": "554320",
    "end": "556640"
  },
  {
    "text": "as a port",
    "start": "556640",
    "end": "557760"
  },
  {
    "text": "such as c backslash 1 backslash",
    "start": "557760",
    "end": "561279"
  },
  {
    "text": "tst obviously this path can bypass the",
    "start": "561279",
    "end": "564399"
  },
  {
    "text": "server process is a valid check after",
    "start": "564399",
    "end": "566959"
  },
  {
    "text": "passing the check",
    "start": "566959",
    "end": "568800"
  },
  {
    "text": "we create",
    "start": "568800",
    "end": "570240"
  },
  {
    "text": "c and slash one link to",
    "start": "570240",
    "end": "573200"
  },
  {
    "text": "c backslash windows",
    "start": "573200",
    "end": "575519"
  },
  {
    "text": "slash system32",
    "start": "575519",
    "end": "577600"
  },
  {
    "text": "then when using the port to audible to",
    "start": "577600",
    "end": "580160"
  },
  {
    "text": "output multiple printed jobs",
    "start": "580160",
    "end": "582560"
  },
  {
    "text": "the pass actually used will be redirect",
    "start": "582560",
    "end": "586000"
  },
  {
    "text": "redirected to the",
    "start": "586000",
    "end": "588160"
  },
  {
    "text": "save slash windows backslash system32",
    "start": "588160",
    "end": "591519"
  },
  {
    "text": "this can still lead to arbitrary failed",
    "start": "591519",
    "end": "594560"
  },
  {
    "text": "writing",
    "start": "594560",
    "end": "596720"
  },
  {
    "text": "unfilled after we report reported this",
    "start": "596720",
    "end": "599920"
  },
  {
    "text": "vulnerability to",
    "start": "599920",
    "end": "601680"
  },
  {
    "text": "microsoft the reason they released a new",
    "start": "601680",
    "end": "604480"
  },
  {
    "text": "patch but unfortunately the past deal",
    "start": "604480",
    "end": "607040"
  },
  {
    "text": "cannot completely",
    "start": "607040",
    "end": "608880"
  },
  {
    "text": "fix this vulnerability",
    "start": "608880",
    "end": "610959"
  },
  {
    "text": "in the patch microsoft made two changes",
    "start": "610959",
    "end": "614399"
  },
  {
    "text": "the first is either a check for passive",
    "start": "614399",
    "end": "617040"
  },
  {
    "text": "direction attack when checking the port",
    "start": "617040",
    "end": "619839"
  },
  {
    "text": "the key point is the pos",
    "start": "619839",
    "end": "622320"
  },
  {
    "text": "is a link function this function is",
    "start": "622320",
    "end": "625040"
  },
  {
    "text": "added to the positive valid function and",
    "start": "625040",
    "end": "627760"
  },
  {
    "text": "it takes the fair handle returned by",
    "start": "627760",
    "end": "630480"
  },
  {
    "text": "create file and the source path",
    "start": "630480",
    "end": "633600"
  },
  {
    "text": "as the parameter",
    "start": "633600",
    "end": "635680"
  },
  {
    "text": "in this function the file path",
    "start": "635680",
    "end": "637600"
  },
  {
    "text": "corresponding to the handle is",
    "start": "637600",
    "end": "640240"
  },
  {
    "text": "obtained through the git final pass name",
    "start": "640240",
    "end": "642640"
  },
  {
    "text": "handle",
    "start": "642640",
    "end": "644240"
  },
  {
    "text": "and the source pass",
    "start": "644240",
    "end": "647120"
  },
  {
    "text": "and the",
    "start": "647120",
    "end": "648399"
  },
  {
    "text": "actual fail pass can be compiled to",
    "start": "648399",
    "end": "651040"
  },
  {
    "text": "check",
    "start": "651040",
    "end": "652079"
  },
  {
    "text": "whether a",
    "start": "652079",
    "end": "653440"
  },
  {
    "text": "pass reduction attack has occurred",
    "start": "653440",
    "end": "657120"
  },
  {
    "text": "and the other change is adding a passive",
    "start": "657120",
    "end": "659360"
  },
  {
    "text": "reduction check when using the printer",
    "start": "659360",
    "end": "661360"
  },
  {
    "text": "port the newly added function is still",
    "start": "661360",
    "end": "664959"
  },
  {
    "text": "is porter link differently this function",
    "start": "664959",
    "end": "667120"
  },
  {
    "text": "is added into",
    "start": "667120",
    "end": "668880"
  },
  {
    "text": "lcm start",
    "start": "668880",
    "end": "670480"
  },
  {
    "text": "dlc port to check whether the printer",
    "start": "670480",
    "end": "672800"
  },
  {
    "text": "post is valid",
    "start": "672800",
    "end": "675839"
  },
  {
    "text": "unfortunately well the patch fix",
    "start": "675839",
    "end": "679360"
  },
  {
    "text": "fits fixed the cv 2020",
    "start": "679360",
    "end": "683440"
  },
  {
    "text": "or 1337",
    "start": "683440",
    "end": "686640"
  },
  {
    "text": "it brings the new bug we found the",
    "start": "686640",
    "end": "688959"
  },
  {
    "text": "arbitrary file deletion back the problem",
    "start": "688959",
    "end": "691360"
  },
  {
    "text": "occurs in lcm",
    "start": "691360",
    "end": "693120"
  },
  {
    "text": "dlc port",
    "start": "693120",
    "end": "695120"
  },
  {
    "text": "after the is puzzling function is",
    "start": "695120",
    "end": "697519"
  },
  {
    "text": "execute executed",
    "start": "697519",
    "end": "699680"
  },
  {
    "text": "if the printer port is checked to be",
    "start": "699680",
    "end": "701680"
  },
  {
    "text": "illegal so this this file function will",
    "start": "701680",
    "end": "704079"
  },
  {
    "text": "be called to try to delete the printer",
    "start": "704079",
    "end": "706560"
  },
  {
    "text": "port due to the passive redirection the",
    "start": "706560",
    "end": "709120"
  },
  {
    "text": "finally deletion deleted file is the",
    "start": "709120",
    "end": "712240"
  },
  {
    "text": "junction target see",
    "start": "712240",
    "end": "714800"
  },
  {
    "text": "slash windows backslash system32",
    "start": "714800",
    "end": "717279"
  },
  {
    "text": "backslash one dot txt",
    "start": "717279",
    "end": "721519"
  },
  {
    "text": "we notice",
    "start": "721600",
    "end": "722560"
  },
  {
    "text": "we noticed that james first shell",
    "start": "722560",
    "end": "724959"
  },
  {
    "text": "provides another trick to bypass the",
    "start": "724959",
    "end": "727120"
  },
  {
    "text": "check of of",
    "start": "727120",
    "end": "728639"
  },
  {
    "text": "his puzzle possibling function and",
    "start": "728639",
    "end": "730480"
  },
  {
    "text": "finally is point printer daemon again",
    "start": "730480",
    "end": "733600"
  },
  {
    "text": "let's have a look let's look at the",
    "start": "733600",
    "end": "735279"
  },
  {
    "text": "implementation of its puzzle link again",
    "start": "735279",
    "end": "738000"
  },
  {
    "text": "the call of the function is get final",
    "start": "738000",
    "end": "739760"
  },
  {
    "text": "pass name by handle which receives file",
    "start": "739760",
    "end": "742639"
  },
  {
    "text": "handle as a parameter and retest the",
    "start": "742639",
    "end": "744880"
  },
  {
    "text": "path of the fair handle in the past year",
    "start": "744880",
    "end": "747760"
  },
  {
    "text": "attacks",
    "start": "747760",
    "end": "748959"
  },
  {
    "text": "using symbol links are very common and",
    "start": "748959",
    "end": "751760"
  },
  {
    "text": "microsoft has widely used",
    "start": "751760",
    "end": "754000"
  },
  {
    "text": "get final personal handle to mitigate",
    "start": "754000",
    "end": "757040"
  },
  {
    "text": "symbolic attackers",
    "start": "757040",
    "end": "760560"
  },
  {
    "text": "so what's the behavior of get final",
    "start": "761120",
    "end": "763760"
  },
  {
    "text": "possible handle",
    "start": "763760",
    "end": "765519"
  },
  {
    "text": "in different situations first sibling",
    "start": "765519",
    "end": "768000"
  },
  {
    "text": "from c band slash one by slash one dose",
    "start": "768000",
    "end": "773040"
  },
  {
    "text": "system 32 backslash",
    "start": "774480",
    "end": "776639"
  },
  {
    "text": "one dot tnt we use create a file to get",
    "start": "776639",
    "end": "780160"
  },
  {
    "text": "the file handle of the source path",
    "start": "780160",
    "end": "784560"
  },
  {
    "text": "c by slash one backslash one dot t and",
    "start": "784959",
    "end": "789120"
  },
  {
    "text": "then use the handle and the parameter or",
    "start": "789120",
    "end": "791600"
  },
  {
    "text": "forget the final possibility by handle",
    "start": "791600",
    "end": "793440"
  },
  {
    "text": "to get the real fair pass we can follow",
    "start": "793440",
    "end": "795760"
  },
  {
    "text": "the",
    "start": "795760",
    "end": "796639"
  },
  {
    "text": "initial path must be different with the",
    "start": "796639",
    "end": "798800"
  },
  {
    "text": "final pass but for the hard link",
    "start": "798800",
    "end": "802160"
  },
  {
    "text": "the two mark to the two parts must be",
    "start": "802160",
    "end": "804399"
  },
  {
    "text": "the same obviously how link can be used",
    "start": "804399",
    "end": "807519"
  },
  {
    "text": "used to bypass get phenomenal personally",
    "start": "807519",
    "end": "809760"
  },
  {
    "text": "by handle but unfortunately ma",
    "start": "809760",
    "end": "812720"
  },
  {
    "text": "microsoft has released a mitigation for",
    "start": "812720",
    "end": "815760"
  },
  {
    "text": "hiring almost two years ago you must",
    "start": "815760",
    "end": "818720"
  },
  {
    "text": "have write permission for your hiring",
    "start": "818720",
    "end": "821120"
  },
  {
    "text": "target",
    "start": "821120",
    "end": "823519"
  },
  {
    "text": "then let's look at the handling of the",
    "start": "823519",
    "end": "826160"
  },
  {
    "text": "unc pass when we talk about the unc pass",
    "start": "826160",
    "end": "829920"
  },
  {
    "text": "we have to measure",
    "start": "829920",
    "end": "832399"
  },
  {
    "text": "the administrative sales",
    "start": "832399",
    "end": "834480"
  },
  {
    "text": "in windows 10 there are three default",
    "start": "834480",
    "end": "836639"
  },
  {
    "text": "shares c dollar",
    "start": "836639",
    "end": "838639"
  },
  {
    "text": "ipc dollar or the mean dollar",
    "start": "838639",
    "end": "841440"
  },
  {
    "text": "they represent special resource on",
    "start": "841440",
    "end": "843760"
  },
  {
    "text": "windows system usually usually you",
    "start": "843760",
    "end": "846240"
  },
  {
    "text": "usually used in remote access",
    "start": "846240",
    "end": "849040"
  },
  {
    "text": "whereas the dollar represents c",
    "start": "849040",
    "end": "852079"
  },
  {
    "text": "driver",
    "start": "852079",
    "end": "853440"
  },
  {
    "text": "ipc dollar is used in nato pipe other",
    "start": "853440",
    "end": "856639"
  },
  {
    "text": "mean",
    "start": "856639",
    "end": "858480"
  },
  {
    "text": "dollar represents system rules directory",
    "start": "858480",
    "end": "863199"
  },
  {
    "text": "let's again consider the case of",
    "start": "863199",
    "end": "865600"
  },
  {
    "text": "simulink from c backslash",
    "start": "865600",
    "end": "868720"
  },
  {
    "text": "test backslash one dot tst to c",
    "start": "868720",
    "end": "872880"
  },
  {
    "text": "backslash windows slash system 32",
    "start": "872880",
    "end": "876000"
  },
  {
    "text": "backslash 1.10 this time we use the unc",
    "start": "876000",
    "end": "879680"
  },
  {
    "text": "pass",
    "start": "879680",
    "end": "880880"
  },
  {
    "text": "unc backslash localhost backslash c",
    "start": "880880",
    "end": "884560"
  },
  {
    "text": "dollar backslash test one both tft and",
    "start": "884560",
    "end": "888240"
  },
  {
    "text": "the input as the input parameter of",
    "start": "888240",
    "end": "890720"
  },
  {
    "text": "cruise file",
    "start": "890720",
    "end": "892639"
  },
  {
    "text": "unc backslash localhost backslash c",
    "start": "892639",
    "end": "896079"
  },
  {
    "text": "dollar slash",
    "start": "896079",
    "end": "899199"
  },
  {
    "text": "tst is a unc",
    "start": "899440",
    "end": "901279"
  },
  {
    "text": "represent",
    "start": "901279",
    "end": "902639"
  },
  {
    "text": "representative for representation of the",
    "start": "902639",
    "end": "905519"
  },
  {
    "text": "plus",
    "start": "905519",
    "end": "906880"
  },
  {
    "text": "c backslash test backslash 1.10",
    "start": "906880",
    "end": "912160"
  },
  {
    "text": "when then we when we use the retainer",
    "start": "912160",
    "end": "914639"
  },
  {
    "text": "file handle as the parameter of get",
    "start": "914639",
    "end": "916480"
  },
  {
    "text": "final plus neighbor handle we will also",
    "start": "916480",
    "end": "918959"
  },
  {
    "text": "be surprised to find that the retainer",
    "start": "918959",
    "end": "921120"
  },
  {
    "text": "pass is consistent with the",
    "start": "921120",
    "end": "924160"
  },
  {
    "text": "simulink source but different from the",
    "start": "924160",
    "end": "926399"
  },
  {
    "text": "simulink target which means with the unc",
    "start": "926399",
    "end": "929519"
  },
  {
    "text": "path we can easily bypass again final",
    "start": "929519",
    "end": "931519"
  },
  {
    "text": "pass name and handle the print demon can",
    "start": "931519",
    "end": "934000"
  },
  {
    "text": "be supported again",
    "start": "934000",
    "end": "937120"
  },
  {
    "text": "at the end of the story microsoft",
    "start": "937759",
    "end": "939920"
  },
  {
    "text": "finally decided to fix the root cause of",
    "start": "939920",
    "end": "942959"
  },
  {
    "text": "the vulnerability by adding the function",
    "start": "942959",
    "end": "944720"
  },
  {
    "text": "is polar impersonating to check various",
    "start": "944720",
    "end": "946959"
  },
  {
    "text": "polar is is impersonating itself there",
    "start": "946959",
    "end": "950720"
  },
  {
    "text": "by mitigating the vulnerability",
    "start": "950720",
    "end": "954079"
  },
  {
    "text": "next we will introduce another",
    "start": "954079",
    "end": "955920"
  },
  {
    "text": "vulnerability",
    "start": "955920",
    "end": "957199"
  },
  {
    "text": "another vulnerability we found in polar",
    "start": "957199",
    "end": "959360"
  },
  {
    "text": "service this vulnerability is easier to",
    "start": "959360",
    "end": "961920"
  },
  {
    "text": "use to respond than print dna and do not",
    "start": "961920",
    "end": "964959"
  },
  {
    "text": "require restarting the scroller or",
    "start": "964959",
    "end": "966959"
  },
  {
    "text": "computer because it's vulnerability evil",
    "start": "966959",
    "end": "969440"
  },
  {
    "text": "copy file event",
    "start": "969440",
    "end": "971040"
  },
  {
    "text": "the vulnerability occurs in the process",
    "start": "971040",
    "end": "973040"
  },
  {
    "text": "of configuring printers normal user can",
    "start": "973040",
    "end": "976160"
  },
  {
    "text": "create a printer of their own so the",
    "start": "976160",
    "end": "978560"
  },
  {
    "text": "partial command and the printer by",
    "start": "978560",
    "end": "980720"
  },
  {
    "text": "checking the security",
    "start": "980720",
    "end": "982560"
  },
  {
    "text": "attributes of the printer we created we",
    "start": "982560",
    "end": "985040"
  },
  {
    "text": "can find that we have or the mini",
    "start": "985040",
    "end": "987279"
  },
  {
    "text": "strategy privilege for the",
    "start": "987279",
    "end": "990800"
  },
  {
    "text": "printer which means we can configure our",
    "start": "990800",
    "end": "993440"
  },
  {
    "text": "printer",
    "start": "993440",
    "end": "995199"
  },
  {
    "text": "to configure our printer you can use the",
    "start": "995199",
    "end": "997279"
  },
  {
    "text": "printer api seed printer data x which is",
    "start": "997279",
    "end": "1000240"
  },
  {
    "text": "exposed by microsoft",
    "start": "1000240",
    "end": "1002720"
  },
  {
    "text": "the implementation of this api can be",
    "start": "1002720",
    "end": "1005440"
  },
  {
    "text": "found as a local spl.",
    "start": "1005440",
    "end": "1008480"
  },
  {
    "text": "spl set printer data x",
    "start": "1008480",
    "end": "1012480"
  },
  {
    "text": "through",
    "start": "1013040",
    "end": "1014079"
  },
  {
    "text": "zero sets printer data x you can set the",
    "start": "1014079",
    "end": "1016880"
  },
  {
    "text": "attributes of your printer for different",
    "start": "1016880",
    "end": "1019360"
  },
  {
    "text": "attributes the smaller has a",
    "start": "1019360",
    "end": "1020959"
  },
  {
    "text": "corresponding handler to handle the",
    "start": "1020959",
    "end": "1022800"
  },
  {
    "text": "attributes content",
    "start": "1022800",
    "end": "1024959"
  },
  {
    "text": "those handles will take the user",
    "start": "1024959",
    "end": "1026798"
  },
  {
    "text": "controllable content and parameter which",
    "start": "1026799",
    "end": "1029438"
  },
  {
    "text": "means this handler provides the test",
    "start": "1029439",
    "end": "1031438"
  },
  {
    "text": "service for us to hunt for bugs",
    "start": "1031439",
    "end": "1034959"
  },
  {
    "text": "after some reverse engineering work we",
    "start": "1034959",
    "end": "1037038"
  },
  {
    "text": "found an interesting handler called",
    "start": "1037039",
    "end": "1039678"
  },
  {
    "text": "spl copy file event",
    "start": "1039679",
    "end": "1042000"
  },
  {
    "text": "by observing the implementation of the",
    "start": "1042000",
    "end": "1043678"
  },
  {
    "text": "function we found that there is a",
    "start": "1043679",
    "end": "1045600"
  },
  {
    "text": "function called",
    "start": "1045600",
    "end": "1046798"
  },
  {
    "text": "spl load library the copy file model",
    "start": "1046799",
    "end": "1050000"
  },
  {
    "text": "this function take a user controllable",
    "start": "1050000",
    "end": "1051840"
  },
  {
    "text": "string and parameter and it looks like",
    "start": "1051840",
    "end": "1054480"
  },
  {
    "text": "we will load the library and then call",
    "start": "1054480",
    "end": "1056080"
  },
  {
    "text": "the exposure function support copy file",
    "start": "1056080",
    "end": "1058880"
  },
  {
    "text": "event",
    "start": "1058880",
    "end": "1061120"
  },
  {
    "text": "let's take a look at the implementation",
    "start": "1061120",
    "end": "1062880"
  },
  {
    "text": "of spl load library the copy file model",
    "start": "1062880",
    "end": "1066320"
  },
  {
    "text": "the core",
    "start": "1066320",
    "end": "1067360"
  },
  {
    "text": "pseudocode can be shown as below",
    "start": "1067360",
    "end": "1069840"
  },
  {
    "text": "this function will firstly",
    "start": "1069840",
    "end": "1071760"
  },
  {
    "text": "call maker",
    "start": "1071760",
    "end": "1073200"
  },
  {
    "text": "connect",
    "start": "1073200",
    "end": "1074480"
  },
  {
    "text": "connect nicole pass to normalize your",
    "start": "1074480",
    "end": "1076880"
  },
  {
    "text": "file path stream by calling the friend",
    "start": "1076880",
    "end": "1079200"
  },
  {
    "text": "personally by handle and then it will",
    "start": "1079200",
    "end": "1081440"
  },
  {
    "text": "call is model file path loaded with your",
    "start": "1081440",
    "end": "1084400"
  },
  {
    "text": "pass and parameter if this function",
    "start": "1084400",
    "end": "1086799"
  },
  {
    "text": "returns true it will load the library",
    "start": "1086799",
    "end": "1088640"
  },
  {
    "text": "from the password specified so if we can",
    "start": "1088640",
    "end": "1091200"
  },
  {
    "text": "bypass the check of reason model file",
    "start": "1091200",
    "end": "1093600"
  },
  {
    "text": "pass loaded we cannot upload arbitrary",
    "start": "1093600",
    "end": "1096320"
  },
  {
    "text": "library with system privilege",
    "start": "1096320",
    "end": "1099919"
  },
  {
    "text": "after the risk engineering of his model",
    "start": "1100240",
    "end": "1102799"
  },
  {
    "text": "file path loading i made a summary of",
    "start": "1102799",
    "end": "1105280"
  },
  {
    "text": "the path loaded by the function and",
    "start": "1105280",
    "end": "1107919"
  },
  {
    "text": "divided them into two into two types the",
    "start": "1107919",
    "end": "1111039"
  },
  {
    "text": "case one sd file path is under the c",
    "start": "1111039",
    "end": "1113679"
  },
  {
    "text": "backslash windows backslash c732",
    "start": "1113679",
    "end": "1116320"
  },
  {
    "text": "backslash support backslash drivers",
    "start": "1116320",
    "end": "1119520"
  },
  {
    "text": "which means sd file path can be in the",
    "start": "1119520",
    "end": "1121840"
  },
  {
    "text": "root directory of this path",
    "start": "1121840",
    "end": "1124400"
  },
  {
    "text": "or in the subdirectory of the",
    "start": "1124400",
    "end": "1127200"
  },
  {
    "text": "of this directory",
    "start": "1127200",
    "end": "1129520"
  },
  {
    "text": "and for the case 2 sd file path is under",
    "start": "1129520",
    "end": "1132559"
  },
  {
    "text": "the root directory of c",
    "start": "1132559",
    "end": "1134799"
  },
  {
    "text": "backslash windows bank slash system32",
    "start": "1134799",
    "end": "1137760"
  },
  {
    "text": "which means as the file pass can be in",
    "start": "1137760",
    "end": "1139840"
  },
  {
    "text": "the root directory of c backslash",
    "start": "1139840",
    "end": "1142400"
  },
  {
    "text": "windows c slash system 32 directory but",
    "start": "1142400",
    "end": "1146000"
  },
  {
    "text": "not in the subdirectories of the",
    "start": "1146000",
    "end": "1149360"
  },
  {
    "text": "c backslash windows backslash system32",
    "start": "1149360",
    "end": "1152160"
  },
  {
    "text": "directory",
    "start": "1152160",
    "end": "1154000"
  },
  {
    "text": "so how after figuring out the legal file",
    "start": "1154000",
    "end": "1156559"
  },
  {
    "text": "path for its model fair pass unloading",
    "start": "1156559",
    "end": "1159039"
  },
  {
    "text": "let's talk about the exploitation for",
    "start": "1159039",
    "end": "1161200"
  },
  {
    "text": "the case one both c bar windows system32",
    "start": "1161200",
    "end": "1165280"
  },
  {
    "text": "supporter driver",
    "start": "1165280",
    "end": "1167280"
  },
  {
    "text": "of support backslash driver and its",
    "start": "1167280",
    "end": "1169520"
  },
  {
    "text": "subdirectory",
    "start": "1169520",
    "end": "1171120"
  },
  {
    "text": "they are",
    "start": "1171120",
    "end": "1172799"
  },
  {
    "text": "they are not medial user writable",
    "start": "1172799",
    "end": "1175039"
  },
  {
    "text": "relatable so we cannot put our dell into",
    "start": "1175039",
    "end": "1178080"
  },
  {
    "text": "this directory and the first product to",
    "start": "1178080",
    "end": "1179840"
  },
  {
    "text": "load it",
    "start": "1179840",
    "end": "1180799"
  },
  {
    "text": "the case 2 will now pass but under the",
    "start": "1180799",
    "end": "1182799"
  },
  {
    "text": "root directory of c band slash windows",
    "start": "1182799",
    "end": "1185600"
  },
  {
    "text": "president season 32 and this directory",
    "start": "1185600",
    "end": "1188000"
  },
  {
    "text": "must be",
    "start": "1188000",
    "end": "1189120"
  },
  {
    "text": "unrelatable by median user we know that",
    "start": "1189120",
    "end": "1192240"
  },
  {
    "text": "c backslash windows backslash",
    "start": "1192240",
    "end": "1194960"
  },
  {
    "text": "season 32 backslash task are writtable",
    "start": "1194960",
    "end": "1198480"
  },
  {
    "text": "by median user but is illegal here",
    "start": "1198480",
    "end": "1200880"
  },
  {
    "text": "judging from the existing condition we",
    "start": "1200880",
    "end": "1203039"
  },
  {
    "text": "seem",
    "start": "1203039",
    "end": "1204159"
  },
  {
    "text": "to be unable to exploit this",
    "start": "1204159",
    "end": "1207039"
  },
  {
    "text": "vulnerability but we must focus",
    "start": "1207039",
    "end": "1209360"
  },
  {
    "text": "something",
    "start": "1209360",
    "end": "1211600"
  },
  {
    "text": "windows use ntfs as a default default",
    "start": "1211600",
    "end": "1215039"
  },
  {
    "text": "file system and the ntfs supports a",
    "start": "1215039",
    "end": "1217520"
  },
  {
    "text": "special feature called ntfs auto",
    "start": "1217520",
    "end": "1220559"
  },
  {
    "text": "alternate data stream also called nads",
    "start": "1220559",
    "end": "1223919"
  },
  {
    "text": "ads is a file attribute only found in",
    "start": "1223919",
    "end": "1226880"
  },
  {
    "text": "ntfs file system",
    "start": "1226880",
    "end": "1228880"
  },
  {
    "text": "adfs allows user to create substring for",
    "start": "1228880",
    "end": "1232840"
  },
  {
    "text": "file or directory by using separator",
    "start": "1232840",
    "end": "1237919"
  },
  {
    "text": "colon",
    "start": "1237919",
    "end": "1239039"
  },
  {
    "text": "because the data server in the file or",
    "start": "1239039",
    "end": "1241520"
  },
  {
    "text": "directory ads cannot be read directly by",
    "start": "1241520",
    "end": "1244880"
  },
  {
    "text": "user so it's rather use abuse abuse to",
    "start": "1244880",
    "end": "1248400"
  },
  {
    "text": "write hiding data from malware",
    "start": "1248400",
    "end": "1251360"
  },
  {
    "text": "files",
    "start": "1251360",
    "end": "1252400"
  },
  {
    "text": "or in",
    "start": "1252400",
    "end": "1253600"
  },
  {
    "text": "an example can be shown as below",
    "start": "1253600",
    "end": "1256320"
  },
  {
    "text": "for the file c backslash one backslash",
    "start": "1256320",
    "end": "1259360"
  },
  {
    "text": "aaa",
    "start": "1259360",
    "end": "1260840"
  },
  {
    "text": "clone bbb aaa is a file or the directory",
    "start": "1260840",
    "end": "1265120"
  },
  {
    "text": "name",
    "start": "1265120",
    "end": "1265919"
  },
  {
    "text": "bbb is an ads on aaa",
    "start": "1265919",
    "end": "1270240"
  },
  {
    "text": "back to the vulnerability",
    "start": "1270880",
    "end": "1272960"
  },
  {
    "text": "we are currently discussing because c",
    "start": "1272960",
    "end": "1275679"
  },
  {
    "text": "slash windows backslash",
    "start": "1275679",
    "end": "1278080"
  },
  {
    "text": "system32 psls task is writable by medium",
    "start": "1278080",
    "end": "1281840"
  },
  {
    "text": "user so we can also add ada ads to this",
    "start": "1281840",
    "end": "1285600"
  },
  {
    "text": "directory such as",
    "start": "1285600",
    "end": "1288000"
  },
  {
    "text": "see backslash windows slash system 32",
    "start": "1288000",
    "end": "1291200"
  },
  {
    "text": "backslash task",
    "start": "1291200",
    "end": "1294559"
  },
  {
    "text": "colon",
    "start": "1294960",
    "end": "1296240"
  },
  {
    "text": "esp dot dell and this file plus must",
    "start": "1296240",
    "end": "1299679"
  },
  {
    "text": "meet the condition of case 1",
    "start": "1299679",
    "end": "1302240"
  },
  {
    "text": "so",
    "start": "1302240",
    "end": "1303120"
  },
  {
    "text": "we can force puller to load arbitrary",
    "start": "1303120",
    "end": "1305280"
  },
  {
    "text": "down with the special file path",
    "start": "1305280",
    "end": "1309280"
  },
  {
    "text": "exploiting this part is very simple we",
    "start": "1309280",
    "end": "1312080"
  },
  {
    "text": "only need to call set printer data x",
    "start": "1312080",
    "end": "1314880"
  },
  {
    "text": "twice with the evo coffee attributes and",
    "start": "1314880",
    "end": "1317679"
  },
  {
    "text": "put all their parts into it",
    "start": "1317679",
    "end": "1319840"
  },
  {
    "text": "observing the process monitor log file",
    "start": "1319840",
    "end": "1322240"
  },
  {
    "text": "we can see that odell our dev was",
    "start": "1322240",
    "end": "1324720"
  },
  {
    "text": "successfully loaded",
    "start": "1324720",
    "end": "1326320"
  },
  {
    "text": "that part is rc box we found in spool",
    "start": "1326320",
    "end": "1329200"
  },
  {
    "text": "let's hand over to luis",
    "start": "1329200",
    "end": "1332080"
  },
  {
    "text": "okay thank you stephanie for your",
    "start": "1332080",
    "end": "1334000"
  },
  {
    "text": "speaking this is luis i'm going to talk",
    "start": "1334000",
    "end": "1336480"
  },
  {
    "text": "about the rce vulnerabilities reflect",
    "start": "1336480",
    "end": "1340000"
  },
  {
    "text": "besides logic box shifung just talked we",
    "start": "1340000",
    "end": "1343360"
  },
  {
    "text": "also found three memory corruption box",
    "start": "1343360",
    "end": "1346240"
  },
  {
    "text": "here i will focus on the cve 221 2408 of",
    "start": "1346240",
    "end": "1350400"
  },
  {
    "text": "spooler the other two vulnerabilities in",
    "start": "1350400",
    "end": "1352720"
  },
  {
    "text": "facts are similar",
    "start": "1352720",
    "end": "1354960"
  },
  {
    "text": "spooler provides api enum jobs to",
    "start": "1354960",
    "end": "1358000"
  },
  {
    "text": "retrieve print jobs stored in a specific",
    "start": "1358000",
    "end": "1360960"
  },
  {
    "text": "printer",
    "start": "1360960",
    "end": "1362320"
  },
  {
    "text": "it will copy a set of jobs into a user",
    "start": "1362320",
    "end": "1364880"
  },
  {
    "text": "supply buffer the buffer and its size is",
    "start": "1364880",
    "end": "1367840"
  },
  {
    "text": "specified by the parameter p drop and cb",
    "start": "1367840",
    "end": "1370480"
  },
  {
    "text": "buff",
    "start": "1370480",
    "end": "1371280"
  },
  {
    "text": "the root cause of this vulnerability is",
    "start": "1371280",
    "end": "1373600"
  },
  {
    "text": "in the function enum jobs in local queue",
    "start": "1373600",
    "end": "1376720"
  },
  {
    "text": "before copying the job into the date",
    "start": "1376720",
    "end": "1378880"
  },
  {
    "text": "into the buffer smoother will check if",
    "start": "1378880",
    "end": "1381360"
  },
  {
    "text": "total job size is smaller than the user",
    "start": "1381360",
    "end": "1384400"
  },
  {
    "text": "supply buffer size and when counting the",
    "start": "1384400",
    "end": "1386880"
  },
  {
    "text": "total job size the function uses a",
    "start": "1386880",
    "end": "1388799"
  },
  {
    "text": "dewalt variable without overflow check",
    "start": "1388799",
    "end": "1391760"
  },
  {
    "text": "which leads to an integer overflow",
    "start": "1391760",
    "end": "1394799"
  },
  {
    "text": "dance puller will copy the jobs into the",
    "start": "1394799",
    "end": "1397679"
  },
  {
    "text": "user supply buffer p job",
    "start": "1397679",
    "end": "1399840"
  },
  {
    "text": "the job structure member can be simply",
    "start": "1399840",
    "end": "1402080"
  },
  {
    "text": "divided into two types data and string",
    "start": "1402080",
    "end": "1404640"
  },
  {
    "text": "pointers",
    "start": "1404640",
    "end": "1406080"
  },
  {
    "text": "since it is an rpc call the function",
    "start": "1406080",
    "end": "1408640"
  },
  {
    "text": "needs to copy not only the job structure",
    "start": "1408640",
    "end": "1411280"
  },
  {
    "text": "but also the string pointed by the",
    "start": "1411280",
    "end": "1413520"
  },
  {
    "text": "string pointer",
    "start": "1413520",
    "end": "1414960"
  },
  {
    "text": "into the buffer",
    "start": "1414960",
    "end": "1416880"
  },
  {
    "text": "there are two pointers",
    "start": "1416880",
    "end": "1418559"
  },
  {
    "text": "stop and end which points to the start",
    "start": "1418559",
    "end": "1421039"
  },
  {
    "text": "and end of the buffer",
    "start": "1421039",
    "end": "1422799"
  },
  {
    "text": "then scooter will copy jump structure to",
    "start": "1422799",
    "end": "1425600"
  },
  {
    "text": "the start of the buffer",
    "start": "1425600",
    "end": "1427440"
  },
  {
    "text": "when you encounter a string it will copy",
    "start": "1427440",
    "end": "1429919"
  },
  {
    "text": "the string data into the end of the",
    "start": "1429919",
    "end": "1432159"
  },
  {
    "text": "buffer and make string pointer pointer",
    "start": "1432159",
    "end": "1434720"
  },
  {
    "text": "while copying the drops",
    "start": "1434720",
    "end": "1437039"
  },
  {
    "text": "the start pointer will increase and the",
    "start": "1437039",
    "end": "1439279"
  },
  {
    "text": "end pointer will decrease",
    "start": "1439279",
    "end": "1441840"
  },
  {
    "text": "when finish the copy the",
    "start": "1441840",
    "end": "1444880"
  },
  {
    "text": "function will mushroom the buffer and",
    "start": "1444880",
    "end": "1446880"
  },
  {
    "text": "send it back to the client",
    "start": "1446880",
    "end": "1448960"
  },
  {
    "text": "but here because of the integer overflow",
    "start": "1448960",
    "end": "1451760"
  },
  {
    "text": "the strings will underflow and override",
    "start": "1451760",
    "end": "1454320"
  },
  {
    "text": "the job data pointers and even memories",
    "start": "1454320",
    "end": "1457200"
  },
  {
    "text": "above the date the buffer",
    "start": "1457200",
    "end": "1460000"
  },
  {
    "text": "meanwhile when we create a job structure",
    "start": "1460000",
    "end": "1463200"
  },
  {
    "text": "there's a job member doc name we can",
    "start": "1463200",
    "end": "1465600"
  },
  {
    "text": "control",
    "start": "1465600",
    "end": "1466880"
  },
  {
    "text": "so the job size and",
    "start": "1466880",
    "end": "1468960"
  },
  {
    "text": "the content is under our control but",
    "start": "1468960",
    "end": "1472000"
  },
  {
    "text": "here's a problem",
    "start": "1472000",
    "end": "1473840"
  },
  {
    "text": "as we need to overflow a dwarf arrival",
    "start": "1473840",
    "end": "1477279"
  },
  {
    "text": "so the total",
    "start": "1477279",
    "end": "1478720"
  },
  {
    "text": "size of the job will be larger than 4",
    "start": "1478720",
    "end": "1481120"
  },
  {
    "text": "gigabytes normally it will trigger a",
    "start": "1481120",
    "end": "1483360"
  },
  {
    "text": "crash",
    "start": "1483360",
    "end": "1484960"
  },
  {
    "text": "but thanks to the overvolt check in the",
    "start": "1484960",
    "end": "1487919"
  },
  {
    "text": "pack strings function",
    "start": "1487919",
    "end": "1489600"
  },
  {
    "text": "if the start pointer surpasses the end",
    "start": "1489600",
    "end": "1491679"
  },
  {
    "text": "pointer the pack strings function will",
    "start": "1491679",
    "end": "1494240"
  },
  {
    "text": "return 0 and set the end pointer to none",
    "start": "1494240",
    "end": "1499200"
  },
  {
    "text": "this will prevent the spooler to copy",
    "start": "1499200",
    "end": "1502240"
  },
  {
    "text": "the remaining jobs",
    "start": "1502240",
    "end": "1503919"
  },
  {
    "text": "so we can abuse this to control the size",
    "start": "1503919",
    "end": "1506640"
  },
  {
    "text": "up and content of an underflow in the",
    "start": "1506640",
    "end": "1509279"
  },
  {
    "text": "heap",
    "start": "1509279",
    "end": "1511600"
  },
  {
    "text": "so we have a hip overflow underflow",
    "start": "1511679",
    "end": "1514640"
  },
  {
    "text": "with controlled size and control content",
    "start": "1514640",
    "end": "1517919"
  },
  {
    "text": "i'm sure it is not hard to fully exploit",
    "start": "1517919",
    "end": "1520960"
  },
  {
    "text": "this vulnerability if we have a stable",
    "start": "1520960",
    "end": "1523520"
  },
  {
    "text": "involved",
    "start": "1523520",
    "end": "1525120"
  },
  {
    "text": "here we are now going to further discuss",
    "start": "1525120",
    "end": "1528240"
  },
  {
    "text": "the exploit and",
    "start": "1528240",
    "end": "1530000"
  },
  {
    "text": "the other similar",
    "start": "1530000",
    "end": "1531600"
  },
  {
    "text": "to vulnerabilities in facts",
    "start": "1531600",
    "end": "1535440"
  },
  {
    "text": "and then we will talk about the print",
    "start": "1535440",
    "end": "1537679"
  },
  {
    "text": "nightmare",
    "start": "1537679",
    "end": "1540320"
  },
  {
    "text": "prince nightmare is a very hot",
    "start": "1540799",
    "end": "1542720"
  },
  {
    "text": "vulnerability recently",
    "start": "1542720",
    "end": "1544720"
  },
  {
    "text": "but there is no patch for you when we're",
    "start": "1544720",
    "end": "1546799"
  },
  {
    "text": "recording this video so we will not dive",
    "start": "1546799",
    "end": "1549279"
  },
  {
    "text": "into the technical details here but we",
    "start": "1549279",
    "end": "1552000"
  },
  {
    "text": "can talk about the story",
    "start": "1552000",
    "end": "1553919"
  },
  {
    "text": "we found prince nightmare earlier this",
    "start": "1553919",
    "end": "1555919"
  },
  {
    "text": "year and want to save it for future",
    "start": "1555919",
    "end": "1557840"
  },
  {
    "text": "security contest but in june microsoft",
    "start": "1557840",
    "end": "1560720"
  },
  {
    "text": "released a patch for spooler cbe211675",
    "start": "1560720",
    "end": "1565400"
  },
  {
    "text": "which was classified as being only lp by",
    "start": "1565600",
    "end": "1568080"
  },
  {
    "text": "microsoft however it's been changed into",
    "start": "1568080",
    "end": "1571440"
  },
  {
    "text": "rc on 21st june after analysis and",
    "start": "1571440",
    "end": "1574559"
  },
  {
    "text": "testing we believe that print nightmare",
    "start": "1574559",
    "end": "1577039"
  },
  {
    "text": "was fixed by the patch for cbe211675",
    "start": "1577039",
    "end": "1580960"
  },
  {
    "text": "one of the credit reporter of cve",
    "start": "1580960",
    "end": "1583720"
  },
  {
    "text": "cve121675 notified us that he's right up",
    "start": "1583720",
    "end": "1586559"
  },
  {
    "text": "about this vulnerability and is",
    "start": "1586559",
    "end": "1588960"
  },
  {
    "text": "different with print nightmare",
    "start": "1588960",
    "end": "1591360"
  },
  {
    "text": "since peter madory and jeep hall report",
    "start": "1591360",
    "end": "1594240"
  },
  {
    "text": "an lp",
    "start": "1594240",
    "end": "1595919"
  },
  {
    "text": "and",
    "start": "1595919",
    "end": "1596960"
  },
  {
    "text": "hai zhang report and rc",
    "start": "1596960",
    "end": "1599600"
  },
  {
    "text": "but microsoft merged them all in cve 12",
    "start": "1599600",
    "end": "1602320"
  },
  {
    "text": "1 1 6 7 5.",
    "start": "1602320",
    "end": "1604159"
  },
  {
    "text": "this creates a misunderstanding as it",
    "start": "1604159",
    "end": "1607760"
  },
  {
    "text": "actually affects print nightmare only in",
    "start": "1607760",
    "end": "1609919"
  },
  {
    "text": "some version of windows but not all of",
    "start": "1609919",
    "end": "1612720"
  },
  {
    "text": "them including the latest windows dc",
    "start": "1612720",
    "end": "1615919"
  },
  {
    "text": "unfortunately we did not fully test our",
    "start": "1615919",
    "end": "1618640"
  },
  {
    "text": "plc against some environments before",
    "start": "1618640",
    "end": "1620880"
  },
  {
    "text": "publishing it",
    "start": "1620880",
    "end": "1622400"
  },
  {
    "text": "after that microsoft assigned cve 121",
    "start": "1622400",
    "end": "1624320"
  },
  {
    "text": "cv12134527",
    "start": "1624320",
    "end": "1627320"
  },
  {
    "text": "for prince nightmare",
    "start": "1627360",
    "end": "1630559"
  },
  {
    "text": "it was never our intention to disclosure",
    "start": "1630799",
    "end": "1633600"
  },
  {
    "text": "a zero-day vulnerability vulnerability",
    "start": "1633600",
    "end": "1636400"
  },
  {
    "text": "we should have done more to verify that",
    "start": "1636400",
    "end": "1639520"
  },
  {
    "text": "the patch completely mitigated the",
    "start": "1639520",
    "end": "1642720"
  },
  {
    "text": "vulnerability",
    "start": "1642720",
    "end": "1644399"
  },
  {
    "text": "we are extremely sorry",
    "start": "1644399",
    "end": "1646559"
  },
  {
    "text": "we recommend that users should disable",
    "start": "1646559",
    "end": "1649279"
  },
  {
    "text": "print spooler service in your domain",
    "start": "1649279",
    "end": "1651440"
  },
  {
    "text": "controller",
    "start": "1651440",
    "end": "1652559"
  },
  {
    "text": "until a new patch is released to prevent",
    "start": "1652559",
    "end": "1655919"
  },
  {
    "text": "print nightmare from being exploited",
    "start": "1655919",
    "end": "1659120"
  },
  {
    "text": "again",
    "start": "1659120",
    "end": "1660320"
  },
  {
    "text": "we are truly sorry for our error and any",
    "start": "1660320",
    "end": "1663039"
  },
  {
    "text": "impact it may have caused",
    "start": "1663039",
    "end": "1666639"
  },
  {
    "text": "in this talk we introduced several",
    "start": "1666799",
    "end": "1668960"
  },
  {
    "text": "vulnerabilities in spooler both logic",
    "start": "1668960",
    "end": "1671760"
  },
  {
    "text": "and memory corruption bugs it turned out",
    "start": "1671760",
    "end": "1674080"
  },
  {
    "text": "that spooler is a really dangerous",
    "start": "1674080",
    "end": "1676240"
  },
  {
    "text": "surface aldo's blood has been through",
    "start": "1676240",
    "end": "1678799"
  },
  {
    "text": "years of vulnerabilities disclosure it's",
    "start": "1678799",
    "end": "1681600"
  },
  {
    "text": "still a good attack surface",
    "start": "1681600",
    "end": "1684640"
  },
  {
    "text": "disable your spooler if you don't need",
    "start": "1684640",
    "end": "1687039"
  },
  {
    "text": "it",
    "start": "1687039",
    "end": "1689120"
  },
  {
    "text": "thanks for your listening this is our",
    "start": "1689440",
    "end": "1691200"
  },
  {
    "text": "talk and then is the qa section",
    "start": "1691200",
    "end": "1695919"
  }
]