[
  {
    "text": "welcome everybody you're in lagoon kay our next talk is the remote Butler did",
    "start": "30",
    "end": "5460"
  },
  {
    "text": "it with tall battery and hi I'm Hulk I've got a couple of quick announcements",
    "start": "5460",
    "end": "10650"
  },
  {
    "text": "if you haven't already stopped by the business hall on the first level in Bayside a be a lot of lot of great",
    "start": "10650",
    "end": "17160"
  },
  {
    "text": "vendors in there and love to talk to you the black hat Arsenal is on the third level if you haven't made it up there",
    "start": "17160",
    "end": "22560"
  },
  {
    "text": "it's just past the escalators a lot of neat stuff in the arsenal and it'll also",
    "start": "22560",
    "end": "27689"
  },
  {
    "text": "be a reception up there at 1700 and then if you haven't picked up your merchandise in the black hat schwag",
    "start": "27689",
    "end": "34050"
  },
  {
    "text": "store or the bookstore that's also today's the last day for that that's on",
    "start": "34050",
    "end": "39180"
  },
  {
    "text": "level 2 here as well if you haven't put your phone on silent yet please do that so you don't interrupt the presentation",
    "start": "39180",
    "end": "45450"
  },
  {
    "text": "and I'll leave it to these guys so thank",
    "start": "45450",
    "end": "54420"
  },
  {
    "text": "you funded the introduction our talk today the remote butler did it I'm Todd",
    "start": "54420",
    "end": "59820"
  },
  {
    "text": "berry I lead the research team of the Microsoft advanced threat analytics product and I'm Hawk researcher in the",
    "start": "59820",
    "end": "67140"
  },
  {
    "text": "team and let's start with a quick warm-up question so what is missing in",
    "start": "67140",
    "end": "72869"
  },
  {
    "text": "this painting anyone knows kind of obvious well obviously they didn't take",
    "start": "72869",
    "end": "80850"
  },
  {
    "text": "the laptop to breakfast and which is quite unfortunate because an even made",
    "start": "80850",
    "end": "87420"
  },
  {
    "text": "may enter to their hotel room and get access to their computer but you say",
    "start": "87420",
    "end": "94200"
  },
  {
    "text": "this is a bunch of they look at tech savvy they probably have passwords for",
    "start": "94200",
    "end": "100200"
  },
  {
    "text": "their computers and they understand the threat and they may also have a hardware",
    "start": "100200",
    "end": "107250"
  },
  {
    "text": "encrypted the hard drive so the attacker cannot simply just take the hard drive",
    "start": "107250",
    "end": "113070"
  },
  {
    "text": "and mounted it in another computer so so they're good they can enjoy the",
    "start": "113070",
    "end": "119280"
  },
  {
    "text": "breakfast right or aren't they and let's",
    "start": "119280",
    "end": "124619"
  },
  {
    "text": "see this video and we will understand it afterwards and this is an attack",
    "start": "124619",
    "end": "130520"
  },
  {
    "text": "demonstrated by in hacking last year on cat Europe and let's see so let's see",
    "start": "130520",
    "end": "138990"
  },
  {
    "text": "the video just a sec okay so we have here as some",
    "start": "138990",
    "end": "146340"
  },
  {
    "text": "device a Raspberry Pi we don't know what it is and there's a laptop here and",
    "start": "146340",
    "end": "154170"
  },
  {
    "text": "we'll show he doesn't know the password you enter a and get password is wrong",
    "start": "154170",
    "end": "159630"
  },
  {
    "text": "and then Ian connects that device into",
    "start": "159630",
    "end": "165000"
  },
  {
    "text": "the network interface and to say again but now it's prompted to change his",
    "start": "165000",
    "end": "171360"
  },
  {
    "text": "password so it changes from A to B that's what is being changed this",
    "start": "171360",
    "end": "178400"
  },
  {
    "text": "connects the device press enter and wait",
    "start": "178400",
    "end": "185370"
  },
  {
    "text": "wait wait wait wait wait wait wait wait Anna is in so very clever attack and I",
    "start": "185370",
    "end": "192600"
  },
  {
    "text": "think Ian is here in the crowd so yeah I am so I think he deserve a round of",
    "start": "192600",
    "end": "197940"
  },
  {
    "text": "applause for that attack thank you again",
    "start": "197940",
    "end": "203360"
  },
  {
    "text": "and so what are we going to talk today time we'll start by analyzing they even",
    "start": "203360",
    "end": "210660"
  },
  {
    "text": "made attack and telling you all the technical details behind it also there",
    "start": "210660",
    "end": "215820"
  },
  {
    "text": "are some general lessons here about the logon mechanics in the windows how does",
    "start": "215820",
    "end": "221730"
  },
  {
    "text": "it behave in in the presence of domain controller with Kerberos the cache production mechanism for when a domain",
    "start": "221730",
    "end": "229980"
  },
  {
    "text": "controller is not accessible and the change password mechanism then we will present a new contribution the remote",
    "start": "229980",
    "end": "236070"
  },
  {
    "text": "malicious Butler attack which even mate is very cool but it requires physical",
    "start": "236070",
    "end": "241650"
  },
  {
    "text": "access of the attacker as we seen it would be so much more useful for the",
    "start": "241650",
    "end": "248730"
  },
  {
    "text": "attacker if they can launch that attack from a network access and not physical",
    "start": "248730",
    "end": "254370"
  },
  {
    "text": "access and we will show this is a possible and how it fits into a Tucker's",
    "start": "254370",
    "end": "260070"
  },
  {
    "text": "cyber kill chain model and hopefully if the demo gods permit will do a lot like",
    "start": "260070",
    "end": "265919"
  },
  {
    "text": "them of it and we would conclude with some solutions to both our attack and the",
    "start": "265919",
    "end": "272270"
  },
  {
    "text": "original even made attack of patching hardening and defense in depth so with that I pass to time thank you very much",
    "start": "272270",
    "end": "281020"
  },
  {
    "text": "here okay so we'll be talking about the evil",
    "start": "281020",
    "end": "286879"
  },
  {
    "text": "male attack the term was first coined by John of comb sky 2009 the same scenario",
    "start": "286879",
    "end": "293120"
  },
  {
    "text": "that I'll talked about you leave your laptop in a hotel room and go to breakfast and meanwhile an evil maid enters your room has physical access to",
    "start": "293120",
    "end": "301490"
  },
  {
    "text": "your computer and can do whatever she wants so there are two doors to the to",
    "start": "301490",
    "end": "308870"
  },
  {
    "text": "the machine the first one is the password if there's no password you can just log on into whatever you want and",
    "start": "308870",
    "end": "314949"
  },
  {
    "text": "back there with the hard drive if the hard drive is not encrypted you can just mount it on another computer copy all",
    "start": "314949",
    "end": "322400"
  },
  {
    "text": "the data and you're good so the original attack was getting the encrypted key for",
    "start": "322400",
    "end": "328490"
  },
  {
    "text": "the encrypted hard drive and decrypting it and ian's attack was to bypass the",
    "start": "328490",
    "end": "334699"
  },
  {
    "text": "password it was a tile that was presented last year in blackhat Europe and we'll go into that attack so to",
    "start": "334699",
    "end": "341900"
  },
  {
    "text": "understand the attack we have to understand Kerberos and Windows authentication all right so first of all",
    "start": "341900",
    "end": "347779"
  },
  {
    "text": "thanks to benjamin topi for the graphics and now we'll talk about covers all",
    "start": "347779",
    "end": "353419"
  },
  {
    "text": "right so covers is a network protocol which does affect occation and authorization in a network a domain",
    "start": "353419",
    "end": "359810"
  },
  {
    "text": "controller is the main source of trust in the Kerberos environment there are three different types of entities the",
    "start": "359810",
    "end": "366830"
  },
  {
    "text": "domain controller users and servers or services each one has its own set set of",
    "start": "366830",
    "end": "373490"
  },
  {
    "text": "keys will discuss the users keys and the server keys so how does it work a user",
    "start": "373490",
    "end": "380029"
  },
  {
    "text": "when he wants to log on he enters his password into the computer this password is then hashed into different keys from",
    "start": "380029",
    "end": "387770"
  },
  {
    "text": "different encryption suits such as a yes rc4 and so forth he then requests something that's called",
    "start": "387770",
    "end": "394599"
  },
  {
    "text": "TGT from the domain controller this is done by encrypting time a timestamp with",
    "start": "394599",
    "end": "400669"
  },
  {
    "text": "his the DC then gets the request which is called a s request and tries to decrypt",
    "start": "400669",
    "end": "407540"
  },
  {
    "text": "it with the keys the DC has the keys for all the users and for all the servers so",
    "start": "407540",
    "end": "412700"
  },
  {
    "text": "if the key is correct he will successfully successfully decrypt the time step and if it matches",
    "start": "412700",
    "end": "418610"
  },
  {
    "text": "then he will give the TGT the ticket granting ticket to the user whenever a",
    "start": "418610",
    "end": "426950"
  },
  {
    "text": "user wants to gain access to a service in the network he'll pass this TGT to",
    "start": "426950",
    "end": "434660"
  },
  {
    "text": "the domain controller and ask for a specific service the domain controller will then create a service ticket to",
    "start": "434660",
    "end": "441470"
  },
  {
    "text": "that requested service which will be encrypted with the services key he will",
    "start": "441470",
    "end": "447260"
  },
  {
    "text": "then give that service key to the user since it's encrypted with the services key the user will not be able to",
    "start": "447260",
    "end": "454250"
  },
  {
    "text": "manipulate it and the user will pass this service key to to the server who",
    "start": "454250",
    "end": "460880"
  },
  {
    "text": "will then be able to decrypt it and give the service to the user all right so",
    "start": "460880",
    "end": "467690"
  },
  {
    "text": "domain logon is a special case of a resource axis in our case the resource",
    "start": "467690",
    "end": "473900"
  },
  {
    "text": "is the target computer and the service name is host slash the Machine name as",
    "start": "473900",
    "end": "480500"
  },
  {
    "text": "you can see on the right there is an ace request from our outer server and the",
    "start": "480500",
    "end": "486770"
  },
  {
    "text": "service that it looks for is that it wants is host and our outer server so it's the same name since we said that",
    "start": "486770",
    "end": "494030"
  },
  {
    "text": "every service has its own ticket this means that our host computer the computer itself has a tick has a",
    "start": "494030",
    "end": "501320"
  },
  {
    "text": "password as well so this is called the machine key or the computer account key computer password they're all the same",
    "start": "501320",
    "end": "509330"
  },
  {
    "text": "once the the user has the the computer",
    "start": "509330",
    "end": "515419"
  },
  {
    "text": "key or the computer key is validated this creates something that we call a domain trust relationship this means",
    "start": "515419",
    "end": "521690"
  },
  {
    "text": "that the domain controller knows the correct computer key alright so we've",
    "start": "521690",
    "end": "528500"
  },
  {
    "text": "talked about we've talked about authentication in the network environment what happens if a user takes his computer home",
    "start": "528500",
    "end": "535010"
  },
  {
    "text": "and isn't connected anymore to the main controller so in this case we have something that's called cash credentials",
    "start": "535010",
    "end": "540230"
  },
  {
    "text": "when a user initially logs on his password is hashed into a cash credential entry this cash credential",
    "start": "540230",
    "end": "545870"
  },
  {
    "text": "cash credential entry is stored in the registry on the hard drive and is stored",
    "start": "545870",
    "end": "553400"
  },
  {
    "text": "in the format that's called Ms cash to which you can see here is a pbkdf2 of",
    "start": "553400",
    "end": "559720"
  },
  {
    "text": "the password and the user there the iteration number is ten thousand to ten",
    "start": "559720",
    "end": "566450"
  },
  {
    "text": "thousand two hundred forty and this is stored in the register now and this is",
    "start": "566450",
    "end": "573140"
  },
  {
    "text": "hard to crack also because of the number of iterations and the salt of the user",
    "start": "573140",
    "end": "578420"
  },
  {
    "text": "and it isn't reusable you can't steal these cash credentials transfer them to another computer and use them so",
    "start": "578420",
    "end": "587360"
  },
  {
    "text": "whenever a user logs on and he's not in the domain environment the cache cache",
    "start": "587360",
    "end": "594200"
  },
  {
    "text": "credential is is calculated and is checked against what what is stored in",
    "start": "594200",
    "end": "600110"
  },
  {
    "text": "the registry if they are matched then the user gains access to the computer the last thing that we'll need to know",
    "start": "600110",
    "end": "607370"
  },
  {
    "text": "about is what happens when a password is expired so if a user is connected to a",
    "start": "607370",
    "end": "614690"
  },
  {
    "text": "domain controller and he tries to gain access to the to the machine by asking",
    "start": "614690",
    "end": "619820"
  },
  {
    "text": "for our a s request if the password has been expired the domain controller will then reply with Kerberos error of kerb",
    "start": "619820",
    "end": "630230"
  },
  {
    "text": "five KDC or key expired you can see it right here on the right and will then prompt the",
    "start": "630230",
    "end": "636530"
  },
  {
    "text": "change password process the user will enter the old password which will then",
    "start": "636530",
    "end": "641900"
  },
  {
    "text": "then be used to transfer the new password to the domain controller once the new password has gone to the domain",
    "start": "641900",
    "end": "649220"
  },
  {
    "text": "controller he will update his keys and will let the user log on in this in this",
    "start": "649220",
    "end": "656930"
  },
  {
    "text": "process the new password will be updated in the cache credentials entry which we saw last slide something interesting to",
    "start": "656930",
    "end": "664310"
  },
  {
    "text": "note about this procedure and it's actually crucial for our attack is that this process does",
    "start": "664310",
    "end": "672980"
  },
  {
    "text": "not require the computer account key it only requires the user key all right so",
    "start": "672980",
    "end": "680660"
  },
  {
    "text": "we've learned about network authentication and local authentication so what an attacker might do he can take",
    "start": "680660",
    "end": "689770"
  },
  {
    "text": "may set up his own DC a rogue DC with the same domain name this domain can be",
    "start": "689770",
    "end": "695120"
  },
  {
    "text": "easily found by looking in the UI of the computer on the DC he'll create a new",
    "start": "695120",
    "end": "702350"
  },
  {
    "text": "user account whatever account he wants and set password so attacker chosen",
    "start": "702350",
    "end": "708110"
  },
  {
    "text": "password he'll then physically connect the computer the rogue DC to the",
    "start": "708110",
    "end": "714500"
  },
  {
    "text": "computer and the attacker will then login using the rogue password but this",
    "start": "714500",
    "end": "724040"
  },
  {
    "text": "doesn't work this doesn't work because there isn't a trust relationship between the new rogue the rogue DC and the",
    "start": "724040",
    "end": "731210"
  },
  {
    "text": "victim machine recall that accessing a host is actually",
    "start": "731210",
    "end": "737030"
  },
  {
    "text": "accessing a service in Kerberos in our case the target the target machine since",
    "start": "737030",
    "end": "742880"
  },
  {
    "text": "the rogue DC does not have the computer account key he cannot the ticket cannot be validated and now that's the reason",
    "start": "742880",
    "end": "749990"
  },
  {
    "text": "that this naive attack does not work so Ian's attack is sort of a revision in",
    "start": "749990",
    "end": "756860"
  },
  {
    "text": "this attack what he did was set up a new",
    "start": "756860",
    "end": "762020"
  },
  {
    "text": "rogue DC the password is chosen by the attacker but the user is the same user",
    "start": "762020",
    "end": "768200"
  },
  {
    "text": "as as the user that is currently logged on the password for this user is then",
    "start": "768200",
    "end": "773720"
  },
  {
    "text": "marked as expired the attacker will then connect the DC to the rogue DC to the",
    "start": "773720",
    "end": "781430"
  },
  {
    "text": "target machine and enter his chosen password since the the password is",
    "start": "781430",
    "end": "788690"
  },
  {
    "text": "marked as expired on the DC this will prompt the password change which will then lead to the cache credentials being",
    "start": "788690",
    "end": "798110"
  },
  {
    "text": "poisoned with the new password he that tacker will then disconnect the",
    "start": "798110",
    "end": "804800"
  },
  {
    "text": "DC and now he'll enter his new attacker chosen password which will then be",
    "start": "804800",
    "end": "811129"
  },
  {
    "text": "calculated to a cash credential entry checked against the cash potential entry that was poisoned and he'll gain access",
    "start": "811129",
    "end": "818060"
  },
  {
    "text": "to the computer alright so now let's",
    "start": "818060",
    "end": "830689"
  },
  {
    "text": "look at the video again now that we know what's going on so there as very pie is our rogue DC and we have the target",
    "start": "830689",
    "end": "837620"
  },
  {
    "text": "computer on the left and now the in",
    "start": "837620",
    "end": "843170"
  },
  {
    "text": "ultra doc logon but it doesn't work now",
    "start": "843170",
    "end": "849500"
  },
  {
    "text": "the rogue DC already has the user in it and it's marked as password expired so",
    "start": "849500",
    "end": "856430"
  },
  {
    "text": "we'll enter is chosen attack chosen password and we'll be prompt for our change password choose a different",
    "start": "856430",
    "end": "862430"
  },
  {
    "text": "password and change it cache credentials have been poisoned we'll now disconnect",
    "start": "862430",
    "end": "868069"
  },
  {
    "text": "the rogue DC and log on with the new password which will then be checked",
    "start": "868069",
    "end": "873350"
  },
  {
    "text": "against the catch credentials and laga",
    "start": "873350",
    "end": "879399"
  },
  {
    "text": "all right so to sum up this is our evil made this is the target computer and the",
    "start": "879550",
    "end": "889220"
  },
  {
    "text": "real DC no now the target machine has",
    "start": "889220",
    "end": "894920"
  },
  {
    "text": "been disconnected from the real DC and dis and connected to rogue DC the attacker changes the password on the",
    "start": "894920",
    "end": "902990"
  },
  {
    "text": "computer and gains control of the computer alright so the main issue here",
    "start": "902990",
    "end": "909170"
  },
  {
    "text": "is that the cache credentials get poisoned without trust being validated so the fix was to ask for ticket to the",
    "start": "909170",
    "end": "917000"
  },
  {
    "text": "computer fix their work quite right and only a ticket was asked another fix for",
    "start": "917000",
    "end": "924889"
  },
  {
    "text": "that was to actually validate the trust and this was found by Nabil Ahmed and Tom Jones those couple then looked at",
    "start": "924889",
    "end": "932269"
  },
  {
    "text": "other different parts of of Kerberos that don't involve the computer trust or",
    "start": "932269",
    "end": "938809"
  },
  {
    "text": "actually they look for processes not just Kerberos that don't involve computer trust and they found that group",
    "start": "938809",
    "end": "946879"
  },
  {
    "text": "policy that the user group policy doesn't check for computer trust for the",
    "start": "946879",
    "end": "953029"
  },
  {
    "text": "doesn't require the computer account key now group policy has system privileges",
    "start": "953029",
    "end": "959600"
  },
  {
    "text": "so what they did was using the exact same techniques as before spawn a shell",
    "start": "959600",
    "end": "966079"
  },
  {
    "text": "as a test scheduled task on the on detect machine and as I said since group",
    "start": "966079",
    "end": "973639"
  },
  {
    "text": "policy runs a system they have had a shell and system privileges on that tech machine as you can see on the right all",
    "start": "973639",
    "end": "982429"
  },
  {
    "text": "right so now I'm gonna hand it over to Todd to talk about art-deco thank you crime now we're ready for the",
    "start": "982429",
    "end": "989689"
  },
  {
    "text": "new stuff or the remote Butler attack when the evil may met the cyber kill",
    "start": "989689",
    "end": "994939"
  },
  {
    "text": "chain so very cool attack evil made yet it requires physical access and the",
    "start": "994939",
    "end": "1002589"
  },
  {
    "text": "harsh reality for the attackers they often don't have physical access but what they do often have is network",
    "start": "1002589",
    "end": "1009790"
  },
  {
    "text": "access and if we are able to take the even made attack and transform it into",
    "start": "1009790",
    "end": "1015699"
  },
  {
    "text": "the remote Butler attack which it's the same just don't require physical access",
    "start": "1015699",
    "end": "1021339"
  },
  {
    "text": "can be learnt from afar from a from the network it would be very beneficial for",
    "start": "1021339",
    "end": "1026918"
  },
  {
    "text": "them and let's take a look of what advanced attackers are doing on their victims network so we had divided it",
    "start": "1026919",
    "end": "1034688"
  },
  {
    "text": "into three main phases the initial phase of just getting in the attacker just",
    "start": "1034689",
    "end": "1040209"
  },
  {
    "text": "getting into the network so it starts with the network infiltration hacking an",
    "start": "1040209",
    "end": "1045240"
  },
  {
    "text": "arbitrary machine that the attacker are able to get into and then they want to",
    "start": "1045240",
    "end": "1050380"
  },
  {
    "text": "get a single set of domain credentials why because we domain credential they can do a lateral movement which is a big",
    "start": "1050380",
    "end": "1059080"
  },
  {
    "text": "words for abusing the access that this credential domain credentials unable and",
    "start": "1059080",
    "end": "1066809"
  },
  {
    "text": "use the use it to other computers have a smoke potential on this computer and goes like that so",
    "start": "1066809",
    "end": "1076600"
  },
  {
    "text": "on and so forth until they grab more and more credentialed and finally get some",
    "start": "1076600",
    "end": "1083020"
  },
  {
    "text": "day of the highly privileged a user credential domain admin when they have",
    "start": "1083020",
    "end": "1088210"
  },
  {
    "text": "domain and range credential they basically have access to every machine in the domain they can further use it to",
    "start": "1088210",
    "end": "1096400"
  },
  {
    "text": "gain access to the domain controller and download using DC sync or functionality",
    "start": "1096400",
    "end": "1102760"
  },
  {
    "text": "like that all of the keys to all the users in the domain and now the attacker",
    "start": "1102760",
    "end": "1108850"
  },
  {
    "text": "in the end of the second stage have all keys to all door in the domain but they",
    "start": "1108850",
    "end": "1114580"
  },
  {
    "text": "are not winning yet because they still have to get into the data and this is the final stage so they make the way",
    "start": "1114580",
    "end": "1121720"
  },
  {
    "text": "into the data they have all the access they need but they still need to find the data and exfiltrate it to the server",
    "start": "1121720",
    "end": "1128890"
  },
  {
    "text": "and then attackers win and this is where",
    "start": "1128890",
    "end": "1134160"
  },
  {
    "text": "this attack meets us because in Microsoft and vajradhara lytx ATA that's",
    "start": "1134160",
    "end": "1140230"
  },
  {
    "text": "what we do we research the attackers kill chant try to detect as many parts",
    "start": "1140230",
    "end": "1145930"
  },
  {
    "text": "of it as soon as we can and this got us thinking with so in stock I thought what",
    "start": "1145930",
    "end": "1153010"
  },
  {
    "text": "are a attackers the attack is the two research attackers and transit actors to",
    "start": "1153010",
    "end": "1158620"
  },
  {
    "text": "do network-based attacks are they able to use it and most specifically the most",
    "start": "1158620",
    "end": "1166200"
  },
  {
    "text": "the attackers biggest motivation would be the initial state because in the initial state attacker has access to a",
    "start": "1166200",
    "end": "1173740"
  },
  {
    "text": "non domain John machine and they would like to jump into a machine that stores",
    "start": "1173740",
    "end": "1179050"
  },
  {
    "text": "the main credential but how would they do that so if they are able to use that",
    "start": "1179050",
    "end": "1185110"
  },
  {
    "text": "even made black magic to get into the domain machine it would be great so how",
    "start": "1185110",
    "end": "1191830"
  },
  {
    "text": "does it happen that attacker has access to the network but don't have domain credential so in many cases attacker a",
    "start": "1191830",
    "end": "1199180"
  },
  {
    "text": "hacks internet-facing yet not domain join machine for example",
    "start": "1199180",
    "end": "1204570"
  },
  {
    "text": "exploiting a web server using some kind of web application vulnerability sequel ejection or RFI LFO you name it and",
    "start": "1204570",
    "end": "1213160"
  },
  {
    "text": "gaining access to that the web server using a web show but still are this",
    "start": "1213160",
    "end": "1219940"
  },
  {
    "text": "machine is not part of the domain so this is just one opt an opportunity for the attacker to have that kind of",
    "start": "1219940",
    "end": "1226450"
  },
  {
    "text": "situation and just to make sure and show you that it's not a theoretical tech but",
    "start": "1226450",
    "end": "1232660"
  },
  {
    "text": "it's a valid scenario let's take a deeper look at the hacking team breach which is not really interesting from",
    "start": "1232660",
    "end": "1240820"
  },
  {
    "text": "technical point of view but what is different about it is that the attacker had published a detailed account of his",
    "start": "1240820",
    "end": "1248440"
  },
  {
    "text": "doing on the network so we know what is done and we are able to learn from it so",
    "start": "1248440",
    "end": "1253990"
  },
  {
    "text": "the attacker infiltrated the network by using some zero-day vulnerability in a",
    "start": "1253990",
    "end": "1260260"
  },
  {
    "text": "network device then they did internal reconnaissance passively monitored",
    "start": "1260260",
    "end": "1266380"
  },
  {
    "text": "traffic of a nearby machine and also actively scanning the internal network",
    "start": "1266380",
    "end": "1272410"
  },
  {
    "text": "and found out a varible network storage device and that stored device which",
    "start": "1272410",
    "end": "1277930"
  },
  {
    "text": "required no authentication also halt store the images of certain virtual",
    "start": "1277930",
    "end": "1285370"
  },
  {
    "text": "machine of domain machine and the attacker was able to analyze the hard drive of these VMs and extract domain",
    "start": "1285370",
    "end": "1292600"
  },
  {
    "text": "credential and then really reach the goal of this initial phase and able to",
    "start": "1292600",
    "end": "1300910"
  },
  {
    "text": "do lateral movement in the second phase so it's time to pimp our exploit from",
    "start": "1300910",
    "end": "1308020"
  },
  {
    "text": "the evil made to the remote Butler so we under original attack we had logon",
    "start": "1308020",
    "end": "1313720"
  },
  {
    "text": "uiview and access that required physical access we will translate it to RDP Remote Desktop Protocol access the ROK",
    "start": "1313720",
    "end": "1320740"
  },
  {
    "text": "DC was brought in with the Raspberry Pi we will have it as the payload of the malware on the breach machine we will",
    "start": "1320740",
    "end": "1327940"
  },
  {
    "text": "replace the replace of the original DC with rock this was done with the physical network cable we would have to",
    "start": "1327940",
    "end": "1334360"
  },
  {
    "text": "use some routing manipulation network appellation for that and there is an additional problem which is not strictly",
    "start": "1334360",
    "end": "1340210"
  },
  {
    "text": "technical but in the evil made it could be that the this is the final stage of",
    "start": "1340210",
    "end": "1345370"
  },
  {
    "text": "the attack of the attack the attacker is able to dump afterwards the computer maybe secrecy is not so important but in",
    "start": "1345370",
    "end": "1353260"
  },
  {
    "text": "our case in the dress attacker case it's very important because this is just the beginning of the attackers campaign even",
    "start": "1353260",
    "end": "1360010"
  },
  {
    "text": "if if this attack is successful by itself yet leads to discovery of the",
    "start": "1360010",
    "end": "1366070"
  },
  {
    "text": "campaign the attacker lose because it's very initial stage they didn't get the data they wanted and they got discovered",
    "start": "1366070",
    "end": "1372310"
  },
  {
    "text": "so it's very important for a vast attacker to remain stealthy with this attack and we'll discuss it so let's get",
    "start": "1372310",
    "end": "1381310"
  },
  {
    "text": "to the details and attacker is start by breaching an on demand join the Machine",
    "start": "1381310",
    "end": "1386380"
  },
  {
    "text": "on the internal network just as it happened in the hacking team case attack aristos",
    "start": "1386380",
    "end": "1391780"
  },
  {
    "text": "they needed to Rock DC functionality on the breach machine it doesn't have to be a phone fully blown domain controller it",
    "start": "1391780",
    "end": "1398860"
  },
  {
    "text": "just need to support certain functionality to change password and",
    "start": "1398860",
    "end": "1404020"
  },
  {
    "text": "Kerberos authentication for example attacker may use a ins blue box project",
    "start": "1404020",
    "end": "1410230"
  },
  {
    "text": "on github check this out and then the attacker need to scan for potentially",
    "start": "1410230",
    "end": "1417880"
  },
  {
    "text": "victims so what are the attackers potential victims they need to have RDP",
    "start": "1417880",
    "end": "1424300"
  },
  {
    "text": "access and attackers can check for refusing a map scan on the reven 4 3 3 8",
    "start": "1424300",
    "end": "1429340"
  },
  {
    "text": "9 and also they need to find machines they see the traffic so they can",
    "start": "1429340",
    "end": "1434800"
  },
  {
    "text": "manipulate it and answer a query to the DC on behalf of the DC with the rogue DC",
    "start": "1434800",
    "end": "1442260"
  },
  {
    "text": "so they scan the network actively and possibly and find such target it's also",
    "start": "1442260",
    "end": "1448360"
  },
  {
    "text": "helpful to make sure that the user is not currently active on the machine as",
    "start": "1448360",
    "end": "1453850"
  },
  {
    "text": "accessing RDP concurrently with the user may cause one of one of the session not",
    "start": "1453850",
    "end": "1460570"
  },
  {
    "text": "to succeed so to succeed and kick the other user so again not something that",
    "start": "1460570",
    "end": "1468970"
  },
  {
    "text": "the attacker want but they can so they can check for it from traffic or just wait till it's very",
    "start": "1468970",
    "end": "1476450"
  },
  {
    "text": "late at night or very early in the morning okay so attackers have everything they",
    "start": "1476450",
    "end": "1484280"
  },
  {
    "text": "did all the setup it's time to attack attackers hijack the victim machine traffic to the DC this can be done we've",
    "start": "1484280",
    "end": "1491480"
  },
  {
    "text": "done it with our poisoning up spoofing which is hackers 101 but there might be",
    "start": "1491480",
    "end": "1498830"
  },
  {
    "text": "a lot of other ways to do it using this poisoning ll M&R and Bienes or just",
    "start": "1498830",
    "end": "1505610"
  },
  {
    "text": "answering before the original DC with no man in the middle just men on the side and if someone wants to explore it and",
    "start": "1505610",
    "end": "1512930"
  },
  {
    "text": "tell me the results I'll be happy to hear and then once the attacker has a",
    "start": "1512930",
    "end": "1518990"
  },
  {
    "text": "connectivity with the rock DC to their target machine they connect via RDP to",
    "start": "1518990",
    "end": "1524000"
  },
  {
    "text": "that machine configure the rock DC accordingly to the UI or based on the",
    "start": "1524000",
    "end": "1529310"
  },
  {
    "text": "traffic on the correct domain name and also the username needed for the evil med perform the evil maid attack trigger",
    "start": "1529310",
    "end": "1536320"
  },
  {
    "text": "password change and using that and",
    "start": "1536320",
    "end": "1542080"
  },
  {
    "text": "causes the cache credential to be poisoned then stop answering from the rock DC",
    "start": "1542080",
    "end": "1548530"
  },
  {
    "text": "coding game local a cache credential",
    "start": "1548530",
    "end": "1554090"
  },
  {
    "text": "logon with their with the attacker control password the attackers gets in takes over if needed now the attacker",
    "start": "1554090",
    "end": "1561740"
  },
  {
    "text": "can escalate to local administrative administrator using the rogue group policy attack that I made shown then the",
    "start": "1561740",
    "end": "1569900"
  },
  {
    "text": "attacker is able to dump the domain credential for memory of the original user and we'll talk about that because",
    "start": "1569900",
    "end": "1575210"
  },
  {
    "text": "it's a little bit surprising we changed the original user password how come his keys are still in memory and now the",
    "start": "1575210",
    "end": "1583220"
  },
  {
    "text": "attacker can return whenever they want to this computer because they have already the domain credentials and",
    "start": "1583220",
    "end": "1589610"
  },
  {
    "text": "without having any read any remote access tool the attacker are able to",
    "start": "1589610",
    "end": "1595910"
  },
  {
    "text": "return to that computer and also they had achieved a domain credential which",
    "start": "1595910",
    "end": "1601070"
  },
  {
    "text": "was their goal for this stage so talk about extracting the attacker",
    "start": "1601070",
    "end": "1606320"
  },
  {
    "text": "extracting keys from memory and it appears that even this is the regular",
    "start": "1606320",
    "end": "1612380"
  },
  {
    "text": "behavior of password change when you change password you can test it in your",
    "start": "1612380",
    "end": "1617780"
  },
  {
    "text": "own environment using a mimic ads and the old password keys remains in LS SS",
    "start": "1617780",
    "end": "1623630"
  },
  {
    "text": "memory and I hope you can see that in the screenshot on the left hand side you",
    "start": "1623630",
    "end": "1629210"
  },
  {
    "text": "can see that for the same session there are two ntlm keys exist for the same",
    "start": "1629210",
    "end": "1634429"
  },
  {
    "text": "session one corresponds to the older password which was abc123 ABC and the",
    "start": "1634429",
    "end": "1640610"
  },
  {
    "text": "second it corresponds to the attackers new password which is B okay now let's",
    "start": "1640610",
    "end": "1647660"
  },
  {
    "text": "discuss cleanup because we said it's very important for the attacker to remain stealthy so for most cases",
    "start": "1647660",
    "end": "1654500"
  },
  {
    "text": "attackers doesn't have to do don't have to do anything they just reroute back",
    "start": "1654500",
    "end": "1660140"
  },
  {
    "text": "the target computer into the original DC and as we said it happened very late at",
    "start": "1660140",
    "end": "1665690"
  },
  {
    "text": "night in the morning when the user comes in this doesn't know that something had happened so they would input their",
    "start": "1665690",
    "end": "1672410"
  },
  {
    "text": "normal password and the DC original DC again doesn't know something bad has",
    "start": "1672410",
    "end": "1678290"
  },
  {
    "text": "happened nothing changed there so it sees that original password compares it",
    "start": "1678290",
    "end": "1683570"
  },
  {
    "text": "to the password that the DC has and authenticate the user and one day so the",
    "start": "1683570",
    "end": "1690559"
  },
  {
    "text": "application is successful and the cash credential gets updated because the cash code analysis oh this is a hash this is",
    "start": "1690559",
    "end": "1697490"
  },
  {
    "text": "different at what I have in my cash credential store so it update the cache credential store and everything goes",
    "start": "1697490",
    "end": "1705080"
  },
  {
    "text": "back to normal but it's not good enough the attacker because there is a possibility maybe a remote possibility",
    "start": "1705080",
    "end": "1711080"
  },
  {
    "text": "that the user will come in the morning and instead of logging in to the machine",
    "start": "1711080",
    "end": "1717400"
  },
  {
    "text": "they would take the machine to some meetings that they have and they don't",
    "start": "1717400",
    "end": "1723260"
  },
  {
    "text": "have a DC connectivity there so cash credentials logon would be performed and",
    "start": "1723260",
    "end": "1728450"
  },
  {
    "text": "user won't be able to access their computer because the cash credential was",
    "start": "1728450",
    "end": "1734000"
  },
  {
    "text": "poisoned with the attacker control password that the user doesn't know and then the user might go to a high tea",
    "start": "1734000",
    "end": "1740690"
  },
  {
    "text": "and said there's something wrong with my computer and which might lead to the discovery of the attacker",
    "start": "1740690",
    "end": "1747110"
  },
  {
    "text": "so attacker needs to take care of it and to take care of it let's recall the",
    "start": "1747110",
    "end": "1752120"
  },
  {
    "text": "cache credential the only secret ingredient in the cache credential hash is the MD 4 of the password and let's",
    "start": "1752120",
    "end": "1759620"
  },
  {
    "text": "recall that MD for the password is actually empty hash wait a minute nt",
    "start": "1759620",
    "end": "1764750"
  },
  {
    "text": "hash we just extracted it from memory the attacker just extracted it so attackers have all the ingredients most",
    "start": "1764750",
    "end": "1772669"
  },
  {
    "text": "importantly than before hash which is the antonym hash but also the username",
    "start": "1772669",
    "end": "1778490"
  },
  {
    "text": "of course which is not a secret and they also don't need to code because this",
    "start": "1778490",
    "end": "1783769"
  },
  {
    "text": "functionality is already present in the mimic ads tool so just input the ntlm",
    "start": "1783769",
    "end": "1789799"
  },
  {
    "text": "hash and the username and mimic cat we'll take care of it and update the cache credential store for the attacker",
    "start": "1789799",
    "end": "1796720"
  },
  {
    "text": "so I think this is a good time to see that live so time to stage is yours all",
    "start": "1796720",
    "end": "1805340"
  },
  {
    "text": "right thank you don't eat this all right so let's do a demo all right so our",
    "start": "1805340",
    "end": "1815179"
  },
  {
    "text": "scenario is that we have a victim machine in our case this V lab win 10",
    "start": "1815179",
    "end": "1821419"
  },
  {
    "text": "and it has a real DC and we'll set up a",
    "start": "1821419",
    "end": "1827330"
  },
  {
    "text": "rogue DC and an attacker our attacker will be a Kali Linux machine now I just",
    "start": "1827330",
    "end": "1833539"
  },
  {
    "text": "want to login here and make sure that everything works so this is the original",
    "start": "1833539",
    "end": "1839480"
  },
  {
    "text": "password abc123 ABC and he loves that all right so he locks the computer and",
    "start": "1839480",
    "end": "1847519"
  },
  {
    "text": "goes home so in our case where is our",
    "start": "1847519",
    "end": "1856240"
  },
  {
    "text": "machine all right so I hope you can see this is the attacker so the attacker",
    "start": "1856240",
    "end": "1861799"
  },
  {
    "text": "will first scan for all RTP ports on the",
    "start": "1861799",
    "end": "1867350"
  },
  {
    "text": "network and he found one machine this machine",
    "start": "1867350",
    "end": "1875170"
  },
  {
    "text": "with an or open RDP port and he can remote desktop to it to see the username",
    "start": "1875170",
    "end": "1886720"
  },
  {
    "text": "and the domain name so in the in this",
    "start": "1886720",
    "end": "1891940"
  },
  {
    "text": "situation he has everything that he needs in order to set up a rope DC meets the domain name and he needs to use the",
    "start": "1891940",
    "end": "1898420"
  },
  {
    "text": "username to set up the user so for this demonstration we'll do the routing",
    "start": "1898420",
    "end": "1904720"
  },
  {
    "text": "manipulation by enabling and disabling adapters because it demonstrates better",
    "start": "1904720",
    "end": "1910390"
  },
  {
    "text": "what's going on so this is our DC and will perform the",
    "start": "1910390",
    "end": "1915640"
  },
  {
    "text": "routing manipulation will just disable this adapter and enable it on our rogue DC so now all traffic is routed to the",
    "start": "1915640",
    "end": "1923830"
  },
  {
    "text": "road DC in our case this DC is just a regular domain controller but it can be",
    "start": "1923830",
    "end": "1931080"
  },
  {
    "text": "something smaller alright so we'll create a new user it's user to and user",
    "start": "1931080",
    "end": "1940660"
  },
  {
    "text": "to and the password will be a and must change password at next logon alright",
    "start": "1940660",
    "end": "1948850"
  },
  {
    "text": "now going back to our attacker so we'll",
    "start": "1948850",
    "end": "1955830"
  },
  {
    "text": "connect to the user with our password",
    "start": "1955830",
    "end": "1962920"
  },
  {
    "text": "and we're prompted to change the password so we'll change it to B and the",
    "start": "1962920",
    "end": "1973900"
  },
  {
    "text": "password has been changed and at this stage we want to simulate the disconnection of the DC or the stopping",
    "start": "1973900",
    "end": "1979930"
  },
  {
    "text": "of all traffic so we'll just disable the adapter not this one onto our DC and",
    "start": "1979930",
    "end": "1989700"
  },
  {
    "text": "perform the password change now this",
    "start": "1990090",
    "end": "1995590"
  },
  {
    "text": "takes a while because the machine will try and connect to a DC it will timeout",
    "start": "1995590",
    "end": "2002910"
  },
  {
    "text": "it will track and timeouts might take a while it's important to note that this",
    "start": "2002910",
    "end": "2008580"
  },
  {
    "text": "vulnerability has been patched in the end of 2015 but up until the patch it",
    "start": "2008580",
    "end": "2016619"
  },
  {
    "text": "worked on all versions of Windows maybe it's a good time to take some question",
    "start": "2016619",
    "end": "2023669"
  },
  {
    "text": "if they're armed while awaiting it it will take a minute but we try to keep it real and doing a",
    "start": "2023669",
    "end": "2029969"
  },
  {
    "text": "real demo so yeah so meanwhile we log on",
    "start": "2029969",
    "end": "2056520"
  },
  {
    "text": "I'm going to answer the question let's take the question so it really changed",
    "start": "2056520",
    "end": "2061529"
  },
  {
    "text": "what the root cause of all this problem is that the domain Trust is not",
    "start": "2061529",
    "end": "2068220"
  },
  {
    "text": "validated it's not validated that the computer is the computer does not",
    "start": "2068220",
    "end": "2074490"
  },
  {
    "text": "mutually authenticate that this is a real DC talking to it and by changing",
    "start": "2074490",
    "end": "2081839"
  },
  {
    "text": "the way that group policy is now done from the computer context and not from",
    "start": "2081839",
    "end": "2087510"
  },
  {
    "text": "the user context it it requires the trust to be validated so",
    "start": "2087510",
    "end": "2094710"
  },
  {
    "text": "now the trust is validated and this attack no longer works so great question so let's proceed",
    "start": "2094710",
    "end": "2099960"
  },
  {
    "text": "alright so now the attacker have gained control on the machine now just to demonstrate that first the original",
    "start": "2099960",
    "end": "2108960"
  },
  {
    "text": "password doesn't work I'm gonna log off and try and log on with the original password alright so I'll walk off and",
    "start": "2108960",
    "end": "2116779"
  },
  {
    "text": "log on again",
    "start": "2116779",
    "end": "2120079"
  },
  {
    "text": "so recall that the original password was abc123 ABC and this shouldn't work to",
    "start": "2125160",
    "end": "2135700"
  },
  {
    "text": "wait a while so it might be this time for another question yeah why shouldn't",
    "start": "2135700",
    "end": "2141310"
  },
  {
    "text": "it so and it didn't work like right so entering the attacker chosen one which",
    "start": "2141310",
    "end": "2148150"
  },
  {
    "text": "was be lobs on alright so the cash credentials have been poisoned and the",
    "start": "2148150",
    "end": "2153340"
  },
  {
    "text": "user can't connect with his original password now what we'll do is we'll the",
    "start": "2153340",
    "end": "2159850"
  },
  {
    "text": "attackers world we're at the credentials so we'll reconnect our DC and I already",
    "start": "2159850",
    "end": "2167710"
  },
  {
    "text": "opened the share there for here it is rogue DC share which conveniently",
    "start": "2167710",
    "end": "2174550"
  },
  {
    "text": "conveniently has mimicked ads on it and we'll run it as administrator so in the",
    "start": "2174550",
    "end": "2183670"
  },
  {
    "text": "demo the user is an administrator but as we've seen before we can just do privilege escalation to get to system",
    "start": "2183670",
    "end": "2190480"
  },
  {
    "text": "all right so all right so now we'll grab",
    "start": "2190480",
    "end": "2198750"
  },
  {
    "text": "the hashes and this is our users and as",
    "start": "2198750",
    "end": "2206050"
  },
  {
    "text": "you can see this is the new ntlm hash and this is the old one so we'll grab",
    "start": "2206050",
    "end": "2212350"
  },
  {
    "text": "the old hash just mark it",
    "start": "2212350",
    "end": "2217260"
  },
  {
    "text": "all right and now we'll replace the cash credentials we'll do the cleanup so in",
    "start": "2219730",
    "end": "2227200"
  },
  {
    "text": "order to do that we have to have system privileges all right and now let's just",
    "start": "2227200",
    "end": "2236980"
  },
  {
    "text": "let's just take a look at the cache alright so this is our MS cache v2 and",
    "start": "2236980",
    "end": "2243570"
  },
  {
    "text": "now we'll just enter our ingredients",
    "start": "2243570",
    "end": "2250540"
  },
  {
    "text": "which is the user and then TLM which we just grabbed and the cache has been",
    "start": "2250540",
    "end": "2261540"
  },
  {
    "text": "replaced all right so the attacker cleaned up he has the user credentials",
    "start": "2261540",
    "end": "2267280"
  },
  {
    "text": "you'll delete MCATs and log off and now",
    "start": "2267280",
    "end": "2274390"
  },
  {
    "text": "I want to demonstrate the scenario where the user comes into the office and takes",
    "start": "2274390",
    "end": "2280119"
  },
  {
    "text": "his laptop but isn't connected to the domain controller so this is so we'll",
    "start": "2280119",
    "end": "2286960"
  },
  {
    "text": "just disconnect a rogue DC so now the",
    "start": "2286960",
    "end": "2292619"
  },
  {
    "text": "the machine is not connected to anything where is it it is and this is the user trying to",
    "start": "2292619",
    "end": "2300730"
  },
  {
    "text": "enter his original password not connected to any DC again it will try to",
    "start": "2300730",
    "end": "2307329"
  },
  {
    "text": "look for a DC will timeout and will",
    "start": "2307329",
    "end": "2312660"
  },
  {
    "text": "eventually go to the cache credentials which we just cleaned up and voila we",
    "start": "2312660",
    "end": "2320380"
  },
  {
    "text": "cleaned up now just just to show you",
    "start": "2320380",
    "end": "2326020"
  },
  {
    "text": "that if we connect it to the due back to the domain controller it still works I'll enable the domain controller enter",
    "start": "2326020",
    "end": "2339240"
  },
  {
    "text": "the original password and we're connected and the final stage is that",
    "start": "2339240",
    "end": "2345599"
  },
  {
    "text": "since we grab the hashes we can now perform for example to pass the hash attack so it's just",
    "start": "2345599",
    "end": "2353060"
  },
  {
    "text": "this and let's do Who am I",
    "start": "2353060",
    "end": "2361820"
  },
  {
    "text": "user to running a real app one and attacker can do whatever you want from",
    "start": "2361820",
    "end": "2366860"
  },
  {
    "text": "Carol all right well it's exciting for me to see it every time and and thank",
    "start": "2366860",
    "end": "2380270"
  },
  {
    "text": "you for the demo gods for allowing all this to happen yeah it's very stressful you know having a live demo and so I",
    "start": "2380270",
    "end": "2387260"
  },
  {
    "text": "appreciate you coming from doing it so let's sum up so we had the evil mind attack which required some physical",
    "start": "2387260",
    "end": "2393890"
  },
  {
    "text": "access the attacker steps up to the attack computer brings a rock this he",
    "start": "2393890",
    "end": "2399320"
  },
  {
    "text": "connected to the computer trick is a change password poisoning the cash credential and gets in in the evil",
    "start": "2399320",
    "end": "2406850"
  },
  {
    "text": "remote Butler the attacker penetrates the network installs rugged easy on the",
    "start": "2406850",
    "end": "2413300"
  },
  {
    "text": "bridge machine manipulate traffic so this traffic it comes to its machine and",
    "start": "2413300",
    "end": "2419170"
  },
  {
    "text": "then triggers change password poison Turkish credential gets in extract",
    "start": "2419170",
    "end": "2425660"
  },
  {
    "text": "ntlm hashes restores everything to be normal so we had seen that this remote",
    "start": "2425660",
    "end": "2433070"
  },
  {
    "text": "butter attack is very much relevant for the first phase of the attacker initial phase to go from network connectivity to",
    "start": "2433070",
    "end": "2440900"
  },
  {
    "text": "domain credentials but it's also relevant for the second state now that the attacker has domain credentials they",
    "start": "2440900",
    "end": "2447140"
  },
  {
    "text": "are able to do further reconnaissance reconnaissance attack to find out where",
    "start": "2447140",
    "end": "2452180"
  },
  {
    "text": "the a privileged user reside where the",
    "start": "2452180",
    "end": "2457370"
  },
  {
    "text": "log on and we understand realized that as a byproduct of the our attack well",
    "start": "2457370",
    "end": "2463640"
  },
  {
    "text": "that the attacker can use our DP reconnaissance for the adjust our DP",
    "start": "2463640",
    "end": "2469040"
  },
  {
    "text": "connect to any machine to every machine and see which user are currently logged",
    "start": "2469040",
    "end": "2474200"
  },
  {
    "text": "on specifically where are the admins bailed on so in fact the whole cycle of",
    "start": "2474200",
    "end": "2480770"
  },
  {
    "text": "the lateral movement can be realized just using a remote Butler for admin",
    "start": "2480770",
    "end": "2486410"
  },
  {
    "text": "recurrence since the attacker might use our DP reconnaissance for remote code execution the remote Butler is there to ask you",
    "start": "2486410",
    "end": "2493970"
  },
  {
    "text": "let local privileges rod group policy update and to compromise credential",
    "start": "2493970",
    "end": "2499040"
  },
  {
    "text": "mimic ads from memory and of course it can be mix-and-match with existing lateral movement techniques so let's",
    "start": "2499040",
    "end": "2506839"
  },
  {
    "text": "talk about defense so first of all install patches this is a partial list of meet men in the middle related attack",
    "start": "2506839",
    "end": "2515059"
  },
  {
    "text": "and patches in Windows men in the middle DC domain controller men in the middle are general man in the middle attack so",
    "start": "2515059",
    "end": "2521710"
  },
  {
    "text": "at least six patches related to either mate 1 2 are related to the jazz bug",
    "start": "2521710",
    "end": "2527599"
  },
  {
    "text": "which is another man in the middle attack against rapport policy if you attend and Sean Matt Koff and talk the",
    "start": "2527599",
    "end": "2534589"
  },
  {
    "text": "other day it talked about it so you might want to see it afterwards in the video and also the padlock the infamous",
    "start": "2534589",
    "end": "2542119"
  },
  {
    "text": "butler ok which is a man-in-the-middle attack against a RPC so pitch pitch",
    "start": "2542119",
    "end": "2548390"
  },
  {
    "text": "pitch especially if you thought that maybe you thought element is not so",
    "start": "2548390",
    "end": "2553490"
  },
  {
    "text": "important to pet because it required physical access now it can be done also from a remote access so if you haven't",
    "start": "2553490",
    "end": "2560599"
  },
  {
    "text": "touched that if you deep prioritized it go back home and patch let's talk about",
    "start": "2560599",
    "end": "2566210"
  },
  {
    "text": "hardening there are two protocols in this attack are dipping cables and both can be hardened to mitigate this attack",
    "start": "2566210",
    "end": "2572119"
  },
  {
    "text": "so RDP hardening can be done with an L a network level authentication which really moves the changes the order of",
    "start": "2572119",
    "end": "2578839"
  },
  {
    "text": "things and move authentication upfront so it usually needs to pay their",
    "start": "2578839",
    "end": "2585140"
  },
  {
    "text": "authentication upfront and prove that they are able to authenticate and this way the attack is mitigated because the",
    "start": "2585140",
    "end": "2592130"
  },
  {
    "text": "attacker cannot prove he is able to they are able to access the machine because",
    "start": "2592130",
    "end": "2597349"
  },
  {
    "text": "they can't that's why they're doing that and cabers armoring covers armoring just the",
    "start": "2597349",
    "end": "2603770"
  },
  {
    "text": "quiz it relates to the question to the previous question from the crowd the",
    "start": "2603770",
    "end": "2609200"
  },
  {
    "text": "root cause about the of this problem is that someone forgot to check for a",
    "start": "2609200",
    "end": "2615079"
  },
  {
    "text": "domain trust and capo stammering makes trust in to cover us",
    "start": "2615079",
    "end": "2620510"
  },
  {
    "text": "in fact everything all the user authentication is now depends on the",
    "start": "2620510",
    "end": "2625520"
  },
  {
    "text": "computer previous attenti keishon so specifically covers errors get signed",
    "start": "2625520",
    "end": "2632720"
  },
  {
    "text": "with the computer session key and so the attacker Cana can no longer fake errors such as to",
    "start": "2632720",
    "end": "2640640"
  },
  {
    "text": "trigger a Kerberos password change and because the attacker don't have the",
    "start": "2640640",
    "end": "2646520"
  },
  {
    "text": "computer key in unable to properly sign it and even if they were able to sign it",
    "start": "2646520",
    "end": "2651890"
  },
  {
    "text": "they would fail in the next phase because they a Kerberos eh-eh-eh",
    "start": "2651890",
    "end": "2659260"
  },
  {
    "text": "authentication to change the password would fail because it depends on the knowing the computer key to so if you",
    "start": "2659260",
    "end": "2667070"
  },
  {
    "text": "can please apply Kerberos armoring and you can see in the screenshot on the",
    "start": "2667070",
    "end": "2672140"
  },
  {
    "text": "bottom there is highlighted the encrypted part in the caboose error and the rake Alvers a armoring and this is a",
    "start": "2672140",
    "end": "2680930"
  },
  {
    "text": "feature this available since Windows 8 Service Server 2012 and also backward",
    "start": "2680930",
    "end": "2686780"
  },
  {
    "text": "compatible so you can also work with it with Windows 7 in doesn't break windows",
    "start": "2686780",
    "end": "2692030"
  },
  {
    "text": "7 or at least allegedly and finally defense in death and so this is kind of",
    "start": "2692030",
    "end": "2700100"
  },
  {
    "text": "more philosophical advice because you might say ok this is for the specific",
    "start": "2700100",
    "end": "2706010"
  },
  {
    "text": "attack you you have all kinds of patches and hardening how I'm going to defend",
    "start": "2706010",
    "end": "2711500"
  },
  {
    "text": "against all that in advance where I'm not aware of such attack so we've seen",
    "start": "2711500",
    "end": "2716750"
  },
  {
    "text": "that the river model for the attacker is the cyber kill chain so it's skill it's",
    "start": "2716750",
    "end": "2722960"
  },
  {
    "text": "kind of scary but it's chain and chain assaults is only as strong as its weakest link so if we as defenders",
    "start": "2722960",
    "end": "2731270"
  },
  {
    "text": "deploy solution that detects all the different steps so even if the attacker",
    "start": "2731270",
    "end": "2737540"
  },
  {
    "text": "is able to bypass our defenses and come up with new new attack that we are not",
    "start": "2737540",
    "end": "2743480"
  },
  {
    "text": "aware of we will catch it on the other steps so do that so let's conclude what our was our new contribution we seen",
    "start": "2743480",
    "end": "2751040"
  },
  {
    "text": "within a in hacking original it but made it fit to advance a Tucker",
    "start": "2751040",
    "end": "2757040"
  },
  {
    "text": "scenario buttressing access of RDP Rock this is a mellow payload Rock DC",
    "start": "2757040",
    "end": "2762140"
  },
  {
    "text": "connection with rock manipulation the compromising domain credential with mimic at and still free clean up there",
    "start": "2762140",
    "end": "2769190"
  },
  {
    "text": "to restore the cache credential additional contribution that can be used outside of the context of the remote",
    "start": "2769190",
    "end": "2775010"
  },
  {
    "text": "Butler is the RDP reconnaissance attack vector and the defense of applying caboose armoring which defeat also the",
    "start": "2775010",
    "end": "2781580"
  },
  {
    "text": "original Iraq this even made attack take aways so local even made is very cool",
    "start": "2781580",
    "end": "2788720"
  },
  {
    "text": "but remote Butler is also cool but very practical Rock DC as we seen there many",
    "start": "2788720",
    "end": "2796910"
  },
  {
    "text": "patches for that are vast and relevant so you should be afraid of it and solutions are patching hardening the",
    "start": "2796910",
    "end": "2802760"
  },
  {
    "text": "fattened death and final slide some thank yous to in hacking for the inspiration and contribution to this",
    "start": "2802760",
    "end": "2809600"
  },
  {
    "text": "work medium is DP mimic at offer from mimic cut and also for a useful comment",
    "start": "2809600",
    "end": "2816260"
  },
  {
    "text": "and Tom jealous and one of the researcher mentioned here for he did a",
    "start": "2816260",
    "end": "2821690"
  },
  {
    "text": "review on our talk to to Microsoft ata researcher they are not here today",
    "start": "2821690",
    "end": "2827120"
  },
  {
    "text": "attack radiates amo which completely contributed to this research and family to our designer turn at the mall with",
    "start": "2827120",
    "end": "2834920"
  },
  {
    "text": "the nice infographics so with that questions yeah please well no because",
    "start": "2834920",
    "end": "2850250"
  },
  {
    "text": "even though the question was would BitLocker help and BitLocker does not",
    "start": "2850250",
    "end": "2857960"
  },
  {
    "text": "help and this is was in fact the motivation for in original attack to",
    "start": "2857960",
    "end": "2863660"
  },
  {
    "text": "bypass bit-bit lockers because you are able to log on you not taking the",
    "start": "2863660",
    "end": "2869300"
  },
  {
    "text": "computer out of the taking the hard drive out of the computer and mounting",
    "start": "2869300",
    "end": "2875930"
  },
  {
    "text": "it in our place what would work it's the boot if the attacker if the machine",
    "start": "2875930",
    "end": "2884690"
  },
  {
    "text": "needs has a BitLocker password on before in how can attack wouldn't work but our",
    "start": "2884690",
    "end": "2890900"
  },
  {
    "text": "attack would work because in most cases computer remains online let's say this",
    "start": "2890900",
    "end": "2897200"
  },
  {
    "text": "is a server and remains online so it has only windows logon to it and not a",
    "start": "2897200",
    "end": "2903530"
  },
  {
    "text": "BitLocker logon to it we are not restarting we are not powering up and",
    "start": "2903530",
    "end": "2909049"
  },
  {
    "text": "down the computer so we won't be prompted for a bit Locker so it doesn't",
    "start": "2909049",
    "end": "2915319"
  },
  {
    "text": "help to our attack any more questions yes please",
    "start": "2915319",
    "end": "2922480"
  },
  {
    "text": "so there's another comment may be referred to meme to say the other",
    "start": "2936030",
    "end": "2943270"
  },
  {
    "text": "mitigations any more questions so thank",
    "start": "2943270",
    "end": "2948640"
  },
  {
    "text": "you all for coming here today we appreciate your time thank you",
    "start": "2948640",
    "end": "2953309"
  }
]