[
  {
    "start": "0",
    "end": "57000"
  },
  {
    "text": "hello everyone uh welcome my uh my name is Joel St John and this is my colleague",
    "start": "40",
    "end": "5520"
  },
  {
    "text": "uh Nicholas gigle and uh we're Security Consultants with a company called ISC Partners B out based out of the uh the",
    "start": "5520",
    "end": "11920"
  },
  {
    "text": "United States in their Seattle office and we're here today to talk all about cheating in online",
    "start": "11920",
    "end": "18439"
  },
  {
    "text": "games so a bit of an agenda uh we're going to go into some of the the history of uh cheating in games and how it's",
    "start": "18439",
    "end": "25119"
  },
  {
    "text": "developed over the years uh we're going to talk a little bit about the the current state of uh the arms race",
    "start": "25119",
    "end": "30560"
  },
  {
    "text": "between cheaters and the the anti-che software that's uh designed to prevent it uh we're going to talk a little bit",
    "start": "30560",
    "end": "36879"
  },
  {
    "text": "about where we see the uh the future of cheating going uh from there we're",
    "start": "36879",
    "end": "42000"
  },
  {
    "text": "actually going to talk about some uh vulnerabilities that we've found in uh anti-che software and then finally we're",
    "start": "42000",
    "end": "48199"
  },
  {
    "text": "going to talk about some potential solutions to these problems and how to uh maybe prevent them going",
    "start": "48199",
    "end": "53960"
  },
  {
    "text": "forward uh all right but first uh let's talk a little bit about uh money so as",
    "start": "53960",
    "end": "60320"
  },
  {
    "start": "57000",
    "end": "57000"
  },
  {
    "text": "the gaming industry has has developed it's turned into a a multi-billion dollar industry over the past few",
    "start": "60320",
    "end": "66159"
  },
  {
    "text": "decades uh developers in the space make uh money in in several different ways uh",
    "start": "66159",
    "end": "71479"
  },
  {
    "text": "one of the most popular being uh the monthly subscription model that you see in some of the the massively multiplayer online games um in addition to this we",
    "start": "71479",
    "end": "79960"
  },
  {
    "text": "actually have professional Gamers uh that are making a considerable amount of money now uh through International",
    "start": "79960",
    "end": "86520"
  },
  {
    "text": "tournaments through uh streaming on sites like YouTube and twitch uh and it that's generally through",
    "start": "86520",
    "end": "92840"
  },
  {
    "text": "through advertisement and uh corporate sponsorship uh finally in in some of these games we've actually seen a rise",
    "start": "92840",
    "end": "98799"
  },
  {
    "text": "of a of a kind of a gray Market where virtual items currency account anything",
    "start": "98799",
    "end": "104280"
  },
  {
    "text": "uh can be sold for for real world money um this has actually become a pretty",
    "start": "104280",
    "end": "109680"
  },
  {
    "text": "profitable space in some of the more popular games uh all right so that's really uh you know one of the big",
    "start": "109680",
    "end": "115799"
  },
  {
    "text": "reasons why some of this stuff actually matters uh but let's take a look at how uh how cheating has is going to affect",
    "start": "115799",
    "end": "121520"
  },
  {
    "text": "it so first uh just to S get some common ground uh what do we Define as cheating",
    "start": "121520",
    "end": "127119"
  },
  {
    "start": "123000",
    "end": "123000"
  },
  {
    "text": "so uh we generally think of this as you know somehow gaining an unfair advantage against the other players in the game uh",
    "start": "127119",
    "end": "133400"
  },
  {
    "text": "and this can take a few a few different forms uh the first one here uh so abusing uh game logic in in one way or",
    "start": "133400",
    "end": "141080"
  },
  {
    "text": "another uh for instance you could use uh multiple accounts to play the game at the same time and get an advantage that",
    "start": "141080",
    "end": "146280"
  },
  {
    "text": "way uh you can actually uh create Bots or scripts that will automate some of the more uh repetitive Parts in a game",
    "start": "146280",
    "end": "153400"
  },
  {
    "text": "uh or you can actually take advantage of some of the extra client side data that is that is present in some uh different",
    "start": "153400",
    "end": "159080"
  },
  {
    "text": "genres such as first-person shooters uh it's also possible to uh to find bugs or",
    "start": "159080",
    "end": "164319"
  },
  {
    "text": "glitches in the system uh to actually let you you know exploit the client server maybe other players uh but for",
    "start": "164319",
    "end": "170239"
  },
  {
    "text": "the purposes of this talk we're really focusing on on the first category here uh so so the abusing of game logic um",
    "start": "170239",
    "end": "178239"
  },
  {
    "start": "178000",
    "end": "178000"
  },
  {
    "text": "all right uh so bit of a brief history of cheating uh in in early single player computer games uh cheating you know as",
    "start": "178239",
    "end": "185319"
  },
  {
    "text": "simple as as actually patching the the code or the source uh or the application uh and it's actually pretty similar with",
    "start": "185319",
    "end": "191280"
  },
  {
    "text": "modern games because I mean at the end of the day who really cares if you cheat in a single player game right a lot of",
    "start": "191280",
    "end": "196760"
  },
  {
    "text": "De developers have actually uh created cheat codes in their games that basically allows a player to to go ahead",
    "start": "196760",
    "end": "202879"
  },
  {
    "text": "and cheat you know at their own discretion uh as as multiplayer games began to emerge however uh cheating",
    "start": "202879",
    "end": "209280"
  },
  {
    "text": "really became a large issue uh but as as time has gone on uh they've actually learned to to cope to the point where uh",
    "start": "209280",
    "end": "216400"
  },
  {
    "text": "while Cheaters still exist they're they're at least uh not as rampant as they were uh you know about a decade or",
    "start": "216400",
    "end": "221640"
  },
  {
    "text": "two ago uh as we were talking about the the money aspect of things you know this cheating can actually have real",
    "start": "221640",
    "end": "227439"
  },
  {
    "text": "consequences in these games uh due to yeah due to the large amount of money involved uh a successful cheat can",
    "start": "227439",
    "end": "232799"
  },
  {
    "text": "actually be sold to different players uh and it can also uh impact the The Gamers",
    "start": "232799",
    "end": "238159"
  },
  {
    "text": "that are making a a living off of uh you know playing the game at the professional level um all right so so",
    "start": "238159",
    "end": "244280"
  },
  {
    "text": "why don't we talk a little bit about some some real world examples uh so one of the most common or popular ways to to",
    "start": "244280",
    "end": "250599"
  },
  {
    "start": "248000",
    "end": "248000"
  },
  {
    "text": "cheat in different games are uh what we consider speed or movement hacks and so these are uh sort of broadly defined as",
    "start": "250599",
    "end": "257560"
  },
  {
    "text": "moving outside how the game uh intends you to so this could be moving faster than normal uh it could be teleporting",
    "start": "257560",
    "end": "263520"
  },
  {
    "text": "around maybe flying through the sky uh can take a lot of different forms in different genres of games uh in other",
    "start": "263520",
    "end": "269720"
  },
  {
    "text": "games we see uh what we I guess broadly call scripting here that uh you can use",
    "start": "269720",
    "end": "274759"
  },
  {
    "text": "to uh I guess script specific actions in the game so that you can actually play it at a higher skill level than you",
    "start": "274759",
    "end": "280919"
  },
  {
    "text": "might uh normally be able to so so combining several actions at once so that you have to play press one key for",
    "start": "280919",
    "end": "287560"
  },
  {
    "text": "instance uh also we actually from from the beginning we've seen a big problem with botting so in a lot of these games",
    "start": "287560",
    "end": "293720"
  },
  {
    "text": "you uh can actually uh collect resources or currency through some some really",
    "start": "293720",
    "end": "299680"
  },
  {
    "text": "competitive uh ways and Bots allow you to automate that process you can leave them running for hours at a time and",
    "start": "299680",
    "end": "305479"
  },
  {
    "text": "they will just accumulate that for you uh oh man that's kind of dark but uh",
    "start": "305479",
    "end": "311639"
  },
  {
    "text": "some of you might recognize that game so so a botter might uh for instance uh",
    "start": "311639",
    "end": "316680"
  },
  {
    "text": "travel around a map and go to these different ore spawns to uh to gather ore",
    "start": "316680",
    "end": "321800"
  },
  {
    "text": "they'll just do that for hours on end uh collect as much as they can then they'll go and they'll sell that for the in-game",
    "start": "321800",
    "end": "326840"
  },
  {
    "text": "currency and then that in turn can actually uh be sold through those virtual gray markets and turned into",
    "start": "326840",
    "end": "332280"
  },
  {
    "text": "real world money uh so definitely you know a big issue undermines the the players that actually want to play the",
    "start": "332280",
    "end": "338800"
  },
  {
    "text": "game uh from there we also have uh player or item finding hacks that uh are",
    "start": "338800",
    "end": "344919"
  },
  {
    "text": "I think most common in some first-person shooters so uh the next one we have here is a uh a survival horror game and this",
    "start": "344919",
    "end": "351400"
  },
  {
    "text": "one uh if you if you die in this game it's permanent death uh items are very hard to come by you're constantly trying",
    "start": "351400",
    "end": "357919"
  },
  {
    "text": "to stay alive uh and this this hack actually will uh find all of the items",
    "start": "357919",
    "end": "362960"
  },
  {
    "text": "that uh have been uh sent to your client so your client has the data on where these are and this just highlights them",
    "start": "362960",
    "end": "369680"
  },
  {
    "text": "so you know exactly where they are it's not pictured in in in here but it actually works for for other players as",
    "start": "369680",
    "end": "374840"
  },
  {
    "text": "well and so uh you can use that to to sneak up on other people and you know kill them and take their",
    "start": "374840",
    "end": "381000"
  },
  {
    "text": "stuff uh in in addition this we also have some things uh like wall hacks or x-ray mods uh and these uh let you in",
    "start": "381000",
    "end": "389800"
  },
  {
    "text": "some I guess see-through Terrain in in general that's a a way to to describe it so it's it's kind of similar to the one",
    "start": "389800",
    "end": "395800"
  },
  {
    "text": "we were just talking about uh but here for an example uh if some of you are familiar with with Minecraft uh this is",
    "start": "395800",
    "end": "402840"
  },
  {
    "text": "what the game typically looks like so we've got uh player in a cave here there's there's Stone there's ore you",
    "start": "402840",
    "end": "409039"
  },
  {
    "text": "know all that great and good uh but once you install one of these x-ray hacks uh we've got a player here on the surface",
    "start": "409039",
    "end": "415199"
  },
  {
    "text": "and they've just wiped away everything that's not interesting to them so in this case you know maybe they want to know where the or is uh in some",
    "start": "415199",
    "end": "421759"
  },
  {
    "text": "different modes you know maybe they're trying to find chests that belong to other players to raid their bases or something like that so uh all of this",
    "start": "421759",
    "end": "427680"
  },
  {
    "text": "information is being sent to the client and so we can you know leverage it as at our discretion",
    "start": "427680",
    "end": "432960"
  },
  {
    "text": "right all right uh over the years uh to help combat against the people cheating",
    "start": "432960",
    "end": "438400"
  },
  {
    "text": "in these games we've actually seen the rise of a lot of different anti-che Suites so uh one of the the more popular",
    "start": "438400",
    "end": "443720"
  },
  {
    "text": "ones with the blizzard series of games I think it started with World of Warcraft but it's it's I think in most of their",
    "start": "443720",
    "end": "448879"
  },
  {
    "text": "games now it's called the warden uh developed in 2004 in several of the the valve series",
    "start": "448879",
    "end": "455759"
  },
  {
    "text": "of games we have the valve anti-che or vac and that's used in uh for instance the Counter-Strike series uh Team",
    "start": "455759",
    "end": "461520"
  },
  {
    "text": "Fortress 2 among others uh we'd actually see some completely third-party uh",
    "start": "461520",
    "end": "467080"
  },
  {
    "text": "anti-che engines so uh for instance battle eye is one of the ones that uh can be integrated with whatever game you",
    "start": "467080",
    "end": "473000"
  },
  {
    "text": "want but I think it's most uh commonly known for uh the the Arma series and uh",
    "start": "473000",
    "end": "478479"
  },
  {
    "text": "the daisy mod for that and the the Standalone now and these all have some some similar uh qualities so for one",
    "start": "478479",
    "end": "486400"
  },
  {
    "text": "they they all tend to run in userland so there's not a a kernel uh component in there though some of the anti-cheats do",
    "start": "486400",
    "end": "493319"
  },
  {
    "text": "uh do leverage uh things in kernel space they tend to be very reactive so uh they'll find out about a cheat they'll",
    "start": "493319",
    "end": "500000"
  },
  {
    "text": "uh you know figure out how to detect it and then they'll push that detect detection mechanism out to their clients",
    "start": "500000",
    "end": "505400"
  },
  {
    "text": "clients get detected they get banned uh they're also all really only you know meant to be a mitigation they they want",
    "start": "505400",
    "end": "511240"
  },
  {
    "text": "to stop as many cheaters as possible but comprehensively stopping them is is not really uh something that they consider",
    "start": "511240",
    "end": "517518"
  },
  {
    "text": "you know possible in this model all right uh so going to talk a",
    "start": "517519",
    "end": "522919"
  },
  {
    "text": "little bit about where the the current uh state of cheating in games is and I'm actually gonna pass it over to to Nico",
    "start": "522919",
    "end": "528480"
  },
  {
    "start": "523000",
    "end": "523000"
  },
  {
    "text": "here to talk about it a little bit can you can you guys hear me okay yeah cool so uh now that Joel has shown you what",
    "start": "528480",
    "end": "533720"
  },
  {
    "text": "the uh the cheats currently look like we're going to take a look at how they're actually implemented and uh then",
    "start": "533720",
    "end": "538920"
  },
  {
    "text": "we'll look into to how anti-cheats catch them and then we will take it just one step further and look at how we can you",
    "start": "538920",
    "end": "546240"
  },
  {
    "text": "know prevent the anti-che from figuring out that somebody's cheating so um the cheats usually uh you know they fall",
    "start": "546240",
    "end": "553079"
  },
  {
    "text": "into one of three categories uh you have the internal cheats the external cheats and the network ones so uh the most",
    "start": "553079",
    "end": "558839"
  },
  {
    "text": "common one is probably the uh the One leveraging D injection so I'm sure you guys are familiar with DL injection on",
    "start": "558839",
    "end": "563959"
  },
  {
    "text": "Windows it's the usual you know map some memory create remote thread load the dll and everything so these come in two",
    "start": "563959",
    "end": "569920"
  },
  {
    "text": "parts you have a loader and the cheat itself the cheat logic is implemented in the dll so uh you know the loader loads",
    "start": "569920",
    "end": "577440"
  },
  {
    "text": "the cheat DL into the game and then of course you know the cheat logic then has full access for read and write to the",
    "start": "577440",
    "end": "583720"
  },
  {
    "text": "entire you know game address space so pretty much anything goes um in order to display uh usually like a little menu uh",
    "start": "583720",
    "end": "591480"
  },
  {
    "text": "a lot of these you know cheats actually have menu so you can select what you want to do um uh you they hook direct",
    "start": "591480",
    "end": "597839"
  },
  {
    "text": "direct 3D calls and um uh that's pretty much it really um so",
    "start": "597839",
    "end": "604480"
  },
  {
    "text": "um another thing is the network packet manipulation so these ones um actually a little less common um one thing that",
    "start": "604480",
    "end": "611120"
  },
  {
    "text": "they do for instance they can introduce artificial lag so if you're playing an FPS you know things are just you know really quick um so if uh the cheat uh",
    "start": "611120",
    "end": "619320"
  },
  {
    "text": "delays or you know blocks or just drops the packet that sends your position from the client that the client is",
    "start": "619320",
    "end": "624480"
  },
  {
    "text": "legitimately trying to send to the server then all of a sudden to your openin your C like it's teleporting if",
    "start": "624480",
    "end": "630519"
  },
  {
    "text": "it's displaying at all um uh repeat packets so you grab a packet let's say you know depending on the Integrity",
    "start": "630519",
    "end": "636519"
  },
  {
    "text": "level the Integrity checking that's done at the server level you know these might might be might or might not be possible",
    "start": "636519",
    "end": "641920"
  },
  {
    "text": "uh but uh let's say that there is um um I don't know damage packet you're sending you know 10 damage to whatever",
    "start": "641920",
    "end": "648279"
  },
  {
    "text": "player while you repeat that packet you get you know a lot of damage uh or directly modify the packets directly and",
    "start": "648279",
    "end": "654320"
  },
  {
    "text": "change whatever you can it um finally there's external cheating um it is beli",
    "start": "654320",
    "end": "659519"
  },
  {
    "text": "that external cheats uh have been developed in an attempt to hide from early anti-cheats uh because well as the",
    "start": "659519",
    "end": "667120"
  },
  {
    "text": "name suggests uh they're not doing they're not you know uh in process they're not in the game process it's",
    "start": "667120",
    "end": "672440"
  },
  {
    "text": "actually a separate process um and so they access the game memory by using",
    "start": "672440",
    "end": "677560"
  },
  {
    "text": "read process memory write process memory which is ends up you know generating a system call on Windows uh which is",
    "start": "677560",
    "end": "682639"
  },
  {
    "text": "actually terrible for performance but uh we're assuming that at some point it was",
    "start": "682639",
    "end": "687720"
  },
  {
    "text": "able to uh go unnotice by uh you know the anti cheets at the time now not so",
    "start": "687720",
    "end": "693079"
  },
  {
    "text": "much as we'll see in the next slide um and in order to uh to render things to the to the player um they usually create",
    "start": "693079",
    "end": "699800"
  },
  {
    "text": "a transparent window on top of the game window so that you can see uh remember the little ESB like extra sensory or",
    "start": "699800",
    "end": "706040"
  },
  {
    "text": "exess sensorial perception you know remember the uh the the shooter that we were showing showing you guys so you",
    "start": "706040",
    "end": "711160"
  },
  {
    "text": "know they do that via transparent window instead of directly hooking the 3D the direct 3D calls as in the uh internal",
    "start": "711160",
    "end": "717880"
  },
  {
    "text": "cheats um so that's that's pretty much it for the uh the cheating in games uh",
    "start": "717880",
    "end": "723120"
  },
  {
    "text": "the current set of the cheats is generally like they they generally fall in one of these three categories um so",
    "start": "723120",
    "end": "729240"
  },
  {
    "start": "729000",
    "end": "729000"
  },
  {
    "text": "anti-cheats well what do they do so uh well they kind of follow an antivirus uh",
    "start": "729240",
    "end": "735079"
  },
  {
    "text": "uh model and sometimes U they they have components that are loaded directly into the game process often they have a",
    "start": "735079",
    "end": "740800"
  },
  {
    "text": "service running a system uh but essentially what they will do is um scan",
    "start": "740800",
    "end": "746959"
  },
  {
    "text": "game process uh and and you know uh game process uh first and foremost in order to find uh you know known signatures for",
    "start": "746959",
    "end": "754320"
  },
  {
    "text": "cheats again just like an antivirus would um and then they have some game specific checks for instance when you",
    "start": "754320",
    "end": "759959"
  },
  {
    "text": "have a games a lot of games have like a like a little scripting engine within so they can scan for you know cheats that",
    "start": "759959",
    "end": "766120"
  },
  {
    "text": "are related to that um hook detection so now this gets a little bit interesting",
    "start": "766120",
    "end": "771240"
  },
  {
    "text": "um because the current um arm race between cheats and anti-che is remember like the internal cheats the most common",
    "start": "771240",
    "end": "777040"
  },
  {
    "text": "ones they hook direct ex calls right so um so let's say that usually the the way",
    "start": "777040",
    "end": "783440"
  },
  {
    "text": "that the pointer chain looks like is that you have you know a C++ object and you have a member that is also a C++ object and so on and so forth with v",
    "start": "783440",
    "end": "790000"
  },
  {
    "text": "tables all over the place so the way they hook it is they replace one of the V tables and to point to a v table that",
    "start": "790000",
    "end": "796000"
  },
  {
    "text": "will call their stuff so you hook at a certain level and then uh and then the anti sheet comes in and expects you know",
    "start": "796000",
    "end": "802800"
  },
  {
    "text": "this this this V table this pointer to be modified and then they detect it so then what do the cheats you know do well",
    "start": "802800",
    "end": "808360"
  },
  {
    "text": "they say okay let's hook a little bit earlier let's hook a little bit later so that's kind of like the arm race going on um so what the anti- cheets do now is",
    "start": "808360",
    "end": "815079"
  },
  {
    "text": "they actually pick up you know kind of a sort of as early as possible in the in the game code and then they just you know parse the whole pointer chain to",
    "start": "815079",
    "end": "821320"
  },
  {
    "text": "try to find uh a modification uh it's similar to uh the windows mitigation known as SE hop uh for structured",
    "start": "821320",
    "end": "828959"
  },
  {
    "text": "exception handling if you guys are familiar with that um then also another one that's interesting is the C tax uh",
    "start": "828959",
    "end": "835040"
  },
  {
    "text": "periodic checks so what this does is um so the uh the anti cheet uh well the",
    "start": "835040",
    "end": "841000"
  },
  {
    "text": "antiche will wait for uh one of the game threads to be uh either sleeping or otherwise non-active uh maybe got",
    "start": "841000",
    "end": "848160"
  },
  {
    "text": "preempted and whatnot but it will basically go through the stack and try to find a malicious stack well a cheat",
    "start": "848160",
    "end": "853240"
  },
  {
    "text": "stack a known cheat stack so that's also something that's you know pretty Advanced uh compared to just you know",
    "start": "853240",
    "end": "858519"
  },
  {
    "text": "blunt uh signature checking um so that's pretty nice then there's like debug related detections right some cheats",
    "start": "858519",
    "end": "864839"
  },
  {
    "text": "have been known to kind of hide their marks by uh leveraging you know C you know interrupt three like debug debug",
    "start": "864839",
    "end": "871600"
  },
  {
    "text": "mechanisms and things like that um so uh so actually these these debug related detections are you know their purpose is",
    "start": "871600",
    "end": "877800"
  },
  {
    "text": "twofold one is to prevent this kind of things and two is to hinder the development of cheats uh because if you",
    "start": "877800",
    "end": "883199"
  },
  {
    "text": "have the game process running and you know you put your break point it doesn't get hit you know it's annoying um so",
    "start": "883199",
    "end": "888440"
  },
  {
    "text": "that's that's something um and then out of process well uh well actually it's like all the processes so in order to",
    "start": "888440",
    "end": "894720"
  },
  {
    "text": "detect external cheats uh then they uh they scan you know but all the processes and and try to find interesting things U",
    "start": "894720",
    "end": "900880"
  },
  {
    "text": "same thing signature detection uh some will go as far as actually checking uh memory sections that are not mapped as",
    "start": "900880",
    "end": "906639"
  },
  {
    "text": "DLS um you know because that's how they hide um uh other things they might be",
    "start": "906639",
    "end": "913320"
  },
  {
    "text": "scanning for in other processes is handles right remember the external sheets uh they're calling read process memory WR process memory all the time uh",
    "start": "913320",
    "end": "920160"
  },
  {
    "text": "to update you know whatever data structure they're interested in and everything so um for that you need a",
    "start": "920160",
    "end": "926279"
  },
  {
    "text": "handle to the process so that's something they scan for uh that's uh that's it oh and a couple of things that",
    "start": "926279",
    "end": "933120"
  },
  {
    "text": "we're listing here this is not an exhaustive list I mean there's a lot of things but this is this covers you know most most of it um things that have been",
    "start": "933120",
    "end": "939920"
  },
  {
    "text": "kind of controversial due to privacy issues um some anti-cheats will actually scan files on your dis and um you know",
    "start": "939920",
    "end": "946720"
  },
  {
    "text": "then they will send it uh to their servers for further analysis uh most of it's probably um automated but I'm sure",
    "start": "946720",
    "end": "953079"
  },
  {
    "text": "at some point it probably becomes manual anyway uh that's kind of creepy um then",
    "start": "953079",
    "end": "958519"
  },
  {
    "text": "um check DN accessory for cheat updates oh yeah so because there's like a constant arm R between the cheats and the anti-cheats um well anti-che sellers",
    "start": "958519",
    "end": "968199"
  },
  {
    "text": "I'm sorry cheat sellers you know cheat people who just you know make and sell cheats um constantly have to update",
    "start": "968199",
    "end": "974240"
  },
  {
    "text": "their software and they do that uh by using you know update servers because",
    "start": "974240",
    "end": "979759"
  },
  {
    "text": "one of the cheats gets detected then they go and you know make a new one uh so for that uh you know the anticheats",
    "start": "979759",
    "end": "985800"
  },
  {
    "text": "you know have picked up on that and so they're saying okay let's check out the let's check the DNS history to see the requests have been made and oh this is a",
    "start": "985800",
    "end": "991800"
  },
  {
    "text": "known cheat server ban that player or cheat update server let's ban that player um so that's it for the uh for",
    "start": "991800",
    "end": "999319"
  },
  {
    "text": "the anti-cheats so as you've noticed um most of these techniques if not all all these techniques actually uh kind of",
    "start": "999319",
    "end": "1006000"
  },
  {
    "text": "start with the idea that the anti sheet has the ability to open up any process see what's in",
    "start": "1006000",
    "end": "1013480"
  },
  {
    "text": "there uh open up files and everything which uh actually uh is",
    "start": "1013480",
    "end": "1019360"
  },
  {
    "text": "an assumption that just could not should not be made uh when you're a user mode component and the and and the U the uh",
    "start": "1019360",
    "end": "1027240"
  },
  {
    "text": "the user actually has control over his machine so um what we're proposing is",
    "start": "1027240",
    "end": "1033959"
  },
  {
    "start": "1030000",
    "end": "1030000"
  },
  {
    "text": "something that will be a lot harder to pick up for anti-cheats which is a rootkit like functionality to hide a",
    "start": "1033959",
    "end": "1039480"
  },
  {
    "text": "cheat activity so how does this work well um two parts a kernel driver and a",
    "start": "1039480",
    "end": "1045760"
  },
  {
    "text": "user mode executable um writing cheat completely in chronal that's possible um",
    "start": "1045760",
    "end": "1051919"
  },
  {
    "text": "it's just well if not annoying it's probably uh you know well yeah it just",
    "start": "1051919",
    "end": "1057480"
  },
  {
    "text": "be that it be annoying I mean it's doable uh but so uh there's no need for that um so basically the uh the",
    "start": "1057480",
    "end": "1062640"
  },
  {
    "text": "interesting the the the actual cheat logic will be Implement in user mode just like a regular cheat and the driver",
    "start": "1062640",
    "end": "1067679"
  },
  {
    "text": "will do a few things and will provide a few services to the user mode uh portion of the cheat to um to to hide it",
    "start": "1067679",
    "end": "1074120"
  },
  {
    "text": "completely from the U uh the the techniques we mentioned before so the",
    "start": "1074120",
    "end": "1079480"
  },
  {
    "text": "kernel driver what does it do so the first thing it'll do is that it will make uh the user mode portion a protected process now protected",
    "start": "1079480",
    "end": "1085640"
  },
  {
    "text": "processes are this feature in Windows that was introduced in Vista I believe uh in order to uh help DRM enforcement u",
    "start": "1085640",
    "end": "1093159"
  },
  {
    "text": "i mean there are other ways that you could how to process I mean you know rootkits you know have been doing that for decades right you could remove uh",
    "start": "1093159",
    "end": "1099000"
  },
  {
    "text": "you know NT keeps a list of all the processes you could just remove it from the dou link list you could have",
    "start": "1099000",
    "end": "1104039"
  },
  {
    "text": "callbacks that are used by antiviruses but we figured you know this only takes flipping one bit on the process block so",
    "start": "1104039",
    "end": "1109840"
  },
  {
    "text": "that sounded simple enough so we went that way um so uh flip the bit and uh all of a sudden the process is protected",
    "start": "1109840",
    "end": "1116760"
  },
  {
    "text": "so uh even if you have an anti-che running a system and it tries to open up the process it gets access",
    "start": "1116760",
    "end": "1122080"
  },
  {
    "text": "denied um so now the interesting part of the driver what it will do is that uh the",
    "start": "1122080",
    "end": "1127720"
  },
  {
    "text": "user mode executable will actually be right it's not a dll It's actually an executable so it'll run as a separate process so in order to access the game",
    "start": "1127720",
    "end": "1135200"
  },
  {
    "text": "memory in a covered way um so the driver will provide this uh mapping mechanism",
    "start": "1135200",
    "end": "1140480"
  },
  {
    "text": "well it will actually uh you know get a request from the user mode portion of the cheat and it will map uh directly",
    "start": "1140480",
    "end": "1146559"
  },
  {
    "text": "page frames of I mean it will map it will map memory from the game process into the cheat process the driver will",
    "start": "1146559",
    "end": "1153159"
  },
  {
    "text": "do that um and so uh another thing that would do is that actually we haven't",
    "start": "1153159",
    "end": "1158520"
  },
  {
    "text": "actually merged that in uh but uh essentially to prevent the uh you know having a um file uh basically the anti",
    "start": "1158520",
    "end": "1165640"
  },
  {
    "text": "sheet you know pick up files from your hard drive and this you could and send it to to a server you could uh just",
    "start": "1165640",
    "end": "1170720"
  },
  {
    "text": "install that filter driver that we have that will put um a filter device on the file system stack and return file not",
    "start": "1170720",
    "end": "1176720"
  },
  {
    "text": "found when uh it's getting request we actually haven't had a need to implement that uh but it's it's uh that's work fur",
    "start": "1176720",
    "end": "1183880"
  },
  {
    "text": "the work I guess um so the user mode executable like I said before implements a cheat logic and uh it keeps track of",
    "start": "1183880",
    "end": "1190880"
  },
  {
    "text": "the game cheat mappings right uh this is actually not completely necessary but it's just a performance Improvement",
    "start": "1190880",
    "end": "1196760"
  },
  {
    "text": "because uh once the uh member is mapped into the cheat process you don't want to have to there's no need to call the",
    "start": "1196760",
    "end": "1202600"
  },
  {
    "text": "driver again to say remap this memory remap this memory right because every time it's a system call so for performance uh you just keep track of it",
    "start": "1202600",
    "end": "1209039"
  },
  {
    "text": "you can just Implement that logic in user mode as we have so um here's the way it looks so this is how you're uh so",
    "start": "1209039",
    "end": "1215840"
  },
  {
    "text": "this is how you know when your CPU is executing the game uh and basically this memory uh Ox 42,000 I'm not sure you",
    "start": "1215840",
    "end": "1223480"
  },
  {
    "text": "guys can read um so this is like game data that let's say the cheat is interested in right so when the CPU is",
    "start": "1223480",
    "end": "1228880"
  },
  {
    "text": "running uh the page tables they're abstracted this is not what page tables look like but U this basically shows",
    "start": "1228880",
    "end": "1234360"
  },
  {
    "text": "that they provide the translation between virtual memory and physical memory so you see that when the game is",
    "start": "1234360",
    "end": "1240480"
  },
  {
    "text": "uh trying to access this virtual memory up there then uh the mmu will do the translation based on the page tables",
    "start": "1240480",
    "end": "1246440"
  },
  {
    "text": "before uh the uh the read or write request is sent on the bus and uh it will actually map to let's say a",
    "start": "1246440",
    "end": "1252440"
  },
  {
    "text": "pageframe FDF right so what will happen once the cheat uh calls into the driver",
    "start": "1252440",
    "end": "1258360"
  },
  {
    "text": "is this so the Gat virtual memory will be",
    "start": "1258360",
    "end": "1263679"
  },
  {
    "text": "mapping to the exact same physical memory so this is completely transparent uh it will be very fast because the",
    "start": "1263679",
    "end": "1270320"
  },
  {
    "text": "hardware does the work so basically it's accessing uh game memory as if it were um if F were its own so it's very fast",
    "start": "1270320",
    "end": "1278720"
  },
  {
    "text": "and uh pre cover it so how this done so we'll show you guys the uh brief code",
    "start": "1278720",
    "end": "1284279"
  },
  {
    "start": "1284000",
    "end": "1284000"
  },
  {
    "text": "snippet I'm not going to bore you with that too much but the idea is that um these apis are documented and they're",
    "start": "1284279",
    "end": "1291320"
  },
  {
    "text": "public so there's nothing there's nothing like too crazy here uh the first thing the first thing that you'll notice the first line PS look up process by",
    "start": "1291320",
    "end": "1298520"
  },
  {
    "text": "process ID so uh this will basically find uh the the game process uh the",
    "start": "1298520",
    "end": "1303600"
  },
  {
    "text": "second thing is allocate mdl so an mdl if you guys are not familiar with this is this partially opaque uh structure uh",
    "start": "1303600",
    "end": "1311279"
  },
  {
    "text": "you can find the full description on msdn and what it does is is it basically is a um think of it as a list of page",
    "start": "1311279",
    "end": "1317320"
  },
  {
    "text": "frames it's a describes like a range of physical memory that's essentially what it is so now the interesting system",
    "start": "1317320",
    "end": "1323880"
  },
  {
    "text": "calls I mean not system calls we're in kernal here this is what running in the driver uh the interesting calls here are",
    "start": "1323880",
    "end": "1329039"
  },
  {
    "text": "K stack attach process because what this will do is will actually grab your thread so we're talking about the driver",
    "start": "1329039",
    "end": "1334799"
  },
  {
    "text": "thread you know that's handling the Out tool send from the from the uh from the cheat client um and it will jump This",
    "start": "1334799",
    "end": "1341640"
  },
  {
    "text": "Thread into the address space of the uh of the of the game and so once uh once",
    "start": "1341640",
    "end": "1348200"
  },
  {
    "text": "uh this this has Su succeeded then the mm for memory management initialized mdl",
    "start": "1348200",
    "end": "1355520"
  },
  {
    "text": "will take us parameter you'll see the Base address the second parameter is the actually the virtual address in the game",
    "start": "1355520",
    "end": "1361279"
  },
  {
    "text": "that we're interested in and it will it will basically fill the mdl with the page frames that are actually mapped",
    "start": "1361279",
    "end": "1367840"
  },
  {
    "text": "there so remember the uh the FDF that that's identifies this then when you call K and stack detach process then you",
    "start": "1367840",
    "end": "1374600"
  },
  {
    "text": "come back into the cheat process and then you call um mm map block page specify cache which will map and then",
    "start": "1374600",
    "end": "1381200"
  },
  {
    "text": "you get uh basically that um so uh and then basically unlock",
    "start": "1381200",
    "end": "1387039"
  },
  {
    "text": "the pages uh freeze some memory and do some reference counting so the driver doesn't you know blue screen on you and",
    "start": "1387039",
    "end": "1392720"
  },
  {
    "text": "you're good to go uh that's now your memory so we have a little demo uh",
    "start": "1392720",
    "end": "1397760"
  },
  {
    "text": "really briefly uh to demonstrate this and hopefully it works so we're going to uh we're going",
    "start": "1397760",
    "end": "1404880"
  },
  {
    "text": "to map memory of this awesome game called not Notepad um so this is notepad",
    "start": "1404880",
    "end": "1410720"
  },
  {
    "text": "right here I can't where's my mouse okay so this is notepad right here and",
    "start": "1410720",
    "end": "1418360"
  },
  {
    "text": "um all right so you see here so",
    "start": "1427880",
    "end": "1434400"
  },
  {
    "text": "um I can't really see can you guys tell me when I hit notepad. demo is that it",
    "start": "1435000",
    "end": "1440240"
  },
  {
    "text": "that's it okay thank you is that handles I can't see all right so as you can see there's there's no",
    "start": "1440240",
    "end": "1447760"
  },
  {
    "text": "handle I mean there's no handle to uh to the notepad process and then when you type",
    "start": "1447760",
    "end": "1453200"
  },
  {
    "text": "here hello then it shows up down there",
    "start": "1453200",
    "end": "1459240"
  },
  {
    "text": "without anything like so basically the memory is dual mapped and you can see it in here and just to show that you can",
    "start": "1459240",
    "end": "1464799"
  },
  {
    "text": "also write to it um what was it again let let me",
    "start": "1464799",
    "end": "1470440"
  },
  {
    "text": "see your tell me if there's a type one I needs to be capitalized oh yes it",
    "start": "1470440",
    "end": "1479120"
  },
  {
    "text": "does whoops okay so you can also write to the memory and you know from under the game's feet and it won't notice a",
    "start": "1481720",
    "end": "1488559"
  },
  {
    "text": "difference it just override it completely so um thank",
    "start": "1488559",
    "end": "1496120"
  },
  {
    "text": "you um so that's the oh yeah hang on I got to get out of the",
    "start": "1496840",
    "end": "1504039"
  },
  {
    "text": "VM okay so that's done so pros and cons so",
    "start": "1505200",
    "end": "1510320"
  },
  {
    "text": "the strength of this method is that it's completely generic right you can do it to any game because it provides you know",
    "start": "1510320",
    "end": "1515520"
  },
  {
    "text": "unlimited access to the game in a complete covered way to the game memory read write it's fast so you can apply to",
    "start": "1515520",
    "end": "1521760"
  },
  {
    "text": "just anything uh any type of game it will not matter this is not specific um it's virtually indetectable from user",
    "start": "1521760",
    "end": "1527399"
  },
  {
    "text": "mode um as you guys can imagine you just you know have a process talking to a driver this process protected the file",
    "start": "1527399",
    "end": "1533200"
  },
  {
    "text": "you cannot access it's not going to happen I mean anti-cheats are going to have a hard time um so one thing about",
    "start": "1533200",
    "end": "1539679"
  },
  {
    "text": "this method that is you know interesting is that there's actually a bunch of uh publicly available uh cheat sources",
    "start": "1539679",
    "end": "1546039"
  },
  {
    "text": "online the problem with these public sources is that obviously they're public so anti-cheats know of them and they can",
    "start": "1546039",
    "end": "1551960"
  },
  {
    "text": "detect them so um with this what you can do is simply grab a public source",
    "start": "1551960",
    "end": "1558559"
  },
  {
    "text": "modify the calls to let's say an external cheat modify the source to to change uh from using read process memory",
    "start": "1558559",
    "end": "1564840"
  },
  {
    "text": "WR process memory you change them by calling the driver or calling whatever memory little memory management you have going in user mode and that's it you get",
    "start": "1564840",
    "end": "1572399"
  },
  {
    "text": "an undetectable cheat um so that's pretty and as I mentioned before it's got pretty good performance because simply there's",
    "start": "1572399",
    "end": "1579960"
  },
  {
    "text": "there's nothing I mean there's no there's no system call there's there's nothing to do it's your memory have fun",
    "start": "1579960",
    "end": "1585559"
  },
  {
    "text": "um so weaknesses well um it's in colal mode so it is as strong or as weak as",
    "start": "1585559",
    "end": "1590640"
  },
  {
    "text": "anything else running in kernel mode um so if you have a cheat an anti-che that makes its way to to Kernel then U you",
    "start": "1590640",
    "end": "1596640"
  },
  {
    "text": "have a problem um now as we've seen with antiviruses uh until the machine got logged down with um various mechanisms",
    "start": "1596640",
    "end": "1604679"
  },
  {
    "text": "uh kernel mode battles usually end up with the winner being whoever loads",
    "start": "1604679",
    "end": "1610840"
  },
  {
    "text": "first so but at least you know at least they have a shot at it um another thing that",
    "start": "1610840",
    "end": "1616840"
  },
  {
    "text": "would be a minor inconvenience would be that of course you have to run a debug mode or you have to get your driver signed which is actually not a big deal",
    "start": "1616840",
    "end": "1623760"
  },
  {
    "text": "but um it's not as easy as just you know just running some",
    "start": "1623760",
    "end": "1628799"
  },
  {
    "text": "executable um okay so um so this is it for the uh the cheating",
    "start": "1628799",
    "end": "1635200"
  },
  {
    "start": "1631000",
    "end": "1631000"
  },
  {
    "text": "framework um now we are going to take it just one step be you know beyond that",
    "start": "1635200",
    "end": "1640279"
  },
  {
    "text": "and we're going to I mean we're going to show you guys that we actually attacked the anti- sheet software itself um so",
    "start": "1640279",
    "end": "1646960"
  },
  {
    "text": "anti- sheet libraries actually interesting because uh they provide an an an additional attack surface the",
    "start": "1646960",
    "end": "1653000"
  },
  {
    "text": "interesting thing about this attack surface is that it's going to be running on the client it's going to be running on the server and it's going to be running across multiple games so if I",
    "start": "1653000",
    "end": "1659880"
  },
  {
    "text": "were an exploit developer business-wise this looks like a good Target because if you if you pop a vul in a in a game then",
    "start": "1659880",
    "end": "1667360"
  },
  {
    "text": "you can just attack that game if you have a vulnerability in a anti-che software you can use it",
    "start": "1667360",
    "end": "1673640"
  },
  {
    "text": "across a bunch of games so you just have you know immediately a broader audience um um so what happens when there's a",
    "start": "1673640",
    "end": "1679960"
  },
  {
    "text": "problem well let's take a look at Battle ey so battle ey is um as we discussed",
    "start": "1679960",
    "end": "1685360"
  },
  {
    "text": "before an anti-che so the the way it works is that you have a battle a global server uh that is used to keep track of",
    "start": "1685360",
    "end": "1691840"
  },
  {
    "text": "bands and things like that and then you have and then you have uh you know",
    "start": "1691840",
    "end": "1697279"
  },
  {
    "text": "server DL that's running in the game server and then you have a client dll that's running in the game client so far it's expected right uh now",
    "start": "1697279",
    "end": "1705640"
  },
  {
    "text": "one thing interesting about it is that it actually hooks uh who the way the way that they communicate is they piggyback",
    "start": "1705640",
    "end": "1710799"
  },
  {
    "text": "on the already established uh communication between the game client and the game server",
    "start": "1710799",
    "end": "1715880"
  },
  {
    "text": "uh which is usually UDP uh and so they hook receive or receive from you know",
    "start": "1715880",
    "end": "1721159"
  },
  {
    "text": "type of call and then they basically parse the packets to figure out whether they're intended for the game itself or",
    "start": "1721159",
    "end": "1726559"
  },
  {
    "text": "they intended for the battle ey uh logic um so uh the way they",
    "start": "1726559",
    "end": "1732600"
  },
  {
    "start": "1732000",
    "end": "1732000"
  },
  {
    "text": "differentiate the packets is uh is based off the packet structure right so the",
    "start": "1732600",
    "end": "1737640"
  },
  {
    "text": "first the first two bytes are just b and e as a signature and then you have like",
    "start": "1737640",
    "end": "1743600"
  },
  {
    "text": "a hash and then a length that is also occasionally use as a code and then uh that's that's it for the metadata and",
    "start": "1743600",
    "end": "1749200"
  },
  {
    "text": "the rest is basically data for uh the the server to process the metalite server to process so um here's the first",
    "start": "1749200",
    "end": "1756399"
  },
  {
    "text": "thing that we noticed uh also just one thing i' like to specify we did not do like a full pen test on this it's just",
    "start": "1756399",
    "end": "1761760"
  },
  {
    "text": "that as we were researching you know cheats and anti- cheets we just we just happen to like look a little bit into how this works and we just noticed so",
    "start": "1761760",
    "end": "1768440"
  },
  {
    "text": "this is not extensive we didn't do fuding we didn't do anything like that these are just a couple of bugs that",
    "start": "1768440",
    "end": "1773919"
  },
  {
    "text": "just happened um so uh this this part is",
    "start": "1773919",
    "end": "1779480"
  },
  {
    "start": "1776000",
    "end": "1776000"
  },
  {
    "text": "uh actually the uh it's the uh part of the packet parsing so the you see if you",
    "start": "1779480",
    "end": "1786440"
  },
  {
    "text": "see in the first in the first box uh the call to sub one01 5430 is actually the",
    "start": "1786440",
    "end": "1792760"
  },
  {
    "text": "hash check so we actually had to reverse the hash function to get this code to accept our package",
    "start": "1792760",
    "end": "1798960"
  },
  {
    "text": "um but if since we got it right then it makes it down to uh the box to the left",
    "start": "1798960",
    "end": "1804200"
  },
  {
    "text": "and then to the other box to the left and then you'll see that ESI contains the head of the packet it contains the",
    "start": "1804200",
    "end": "1809559"
  },
  {
    "text": "start of the packet and then you end up in the last box to the left all the way down here um I think it might be cut a",
    "start": "1809559",
    "end": "1816279"
  },
  {
    "text": "little bit but hopefully you guys can see it and if you can see it then you'll notice that there's a move S6 instruction uh the problem with this is",
    "start": "1816279",
    "end": "1823640"
  },
  {
    "text": "that uh well there's an error in the code where this is uh this character is a sign value and uh when uh when they do",
    "start": "1823640",
    "end": "1830840"
  },
  {
    "text": "the comparison they basically do a move SX which will sign extend it all the way into the 32-bit register ESI so the",
    "start": "1830840",
    "end": "1837640"
  },
  {
    "text": "magic value here is FC which the last bit is a signed bit is set but then you",
    "start": "1837640",
    "end": "1842679"
  },
  {
    "text": "end up with FFF f f f FFC which is if you look at it as an unsigned value it's a really big number if you look at it as",
    "start": "1842679",
    "end": "1848360"
  },
  {
    "text": "a signed value it's just a negative number small negative number but the problem then is a jge jge is a sign",
    "start": "1848360",
    "end": "1854440"
  },
  {
    "text": "comparison so what they're trying to do here is they're trying to do an upper bound check except they're trying to do an upper bound check on a sign value so",
    "start": "1854440",
    "end": "1862000"
  },
  {
    "text": "our big unsigned value which happens to be a small negative value if you look at as an as assigned which is what they're",
    "start": "1862000",
    "end": "1867559"
  },
  {
    "text": "doing you will pass the check so um pass the check and then you",
    "start": "1867559",
    "end": "1873639"
  },
  {
    "text": "end up a couple of function calls later down here so our bogus value our bogus f",
    "start": "1873639",
    "end": "1878799"
  },
  {
    "text": "f f f FFC value ends up in uh in EDI so EDI plus 4 you end up with zero and then",
    "start": "1878799",
    "end": "1885279"
  },
  {
    "text": "you call the C++ new operator which in turns will call a maloc call maloc with zero you get a really small allocation",
    "start": "1885279",
    "end": "1891760"
  },
  {
    "text": "once you have a really small allocation then well which succeeds then you make your way",
    "start": "1891760",
    "end": "1897000"
  },
  {
    "text": "to uh to uh to the left well actually that's the only box there is so you make your your way to the other box and um",
    "start": "1897000",
    "end": "1905120"
  },
  {
    "text": "and then they add to our zero value which was stored in ABP plus 4 if you can see it's the third line in the top",
    "start": "1905120",
    "end": "1911080"
  },
  {
    "text": "box so then they pick it up again which is interesting the compiler would do that but whatever so you end up with EBP",
    "start": "1911080",
    "end": "1916399"
  },
  {
    "text": "plus 4 and um in ECX and then they they remove seven and the problem is you end up with that",
    "start": "1916399",
    "end": "1922679"
  },
  {
    "text": "seven you end up with again a really big value FFF F FF you know minus 6 um and",
    "start": "1922679",
    "end": "1929120"
  },
  {
    "text": "then that's what they use to do the M Copy so the result of this bug is that you get a really small allocation on",
    "start": "1929120",
    "end": "1934679"
  },
  {
    "text": "Heap and then you get basically a 4 gig copy as you can imagine this crashes um",
    "start": "1934679",
    "end": "1941440"
  },
  {
    "text": "so exploitability of this uh denal of service is Trivial obviously uh just s FC and a valid hash and it'll blow up",
    "start": "1941440",
    "end": "1948919"
  },
  {
    "start": "1942000",
    "end": "1942000"
  },
  {
    "text": "the server uh this actually is already a problem because we're talking about gaming here right so let's say you have a game with perade death and you find",
    "start": "1948919",
    "end": "1955880"
  },
  {
    "text": "yourself in a quarter uh in a in a in a corner out of ammo zombies and players",
    "start": "1955880",
    "end": "1960919"
  },
  {
    "text": "and everybody hates you well magic packet kill the server that's convenient",
    "start": "1960919",
    "end": "1966080"
  },
  {
    "text": "um so uh now for the more juicy part remote code execution well uh it's",
    "start": "1966080",
    "end": "1972840"
  },
  {
    "text": "possible it'd be very tricky uh I mean nowadays you know uh exploits take I",
    "start": "1972840",
    "end": "1978360"
  },
  {
    "text": "don't know two three bugs to get anything reliable which we don't have for this but this would be a good start",
    "start": "1978360",
    "end": "1983880"
  },
  {
    "text": "because you're overwriting Heap data and uh you oh I forgot one thing the thing that we're overriding the data with is",
    "start": "1983880",
    "end": "1990200"
  },
  {
    "text": "actually attacker controlled so that's also convenient now it'd be very difficult uh few reasons for this uh the",
    "start": "1990200",
    "end": "1997519"
  },
  {
    "text": "first one is that the uh while the anti-che is actually we're rolling up the uh the anti-che Heap right they're",
    "start": "1997519",
    "end": "2003440"
  },
  {
    "text": "creating their own private heap if they're not using the process Heap um so uh Heap was actually pretty anorexic I",
    "start": "2003440",
    "end": "2009279"
  },
  {
    "text": "mean there was there's not much on it like no V tables no function pointers nothing really juicy so we actually wrote this little um pykd script which",
    "start": "2009279",
    "end": "2015760"
  },
  {
    "text": "is very convenient it'll just hook free and every time you know a free happens in your process then it will actually",
    "start": "2015760",
    "end": "2020799"
  },
  {
    "text": "check to see if there's a v table or anything interesting here so uh that that would be it uh we found a couple of things we",
    "start": "2020799",
    "end": "2026799"
  },
  {
    "text": "found um what else did we find well we found a couple of pointers but anyway another",
    "start": "2026799",
    "end": "2033320"
  },
  {
    "text": "thing that would make uh this remote cation very difficult is that you would actually have to race the thread that's",
    "start": "2033320",
    "end": "2038760"
  },
  {
    "text": "performing The Copy before it crashes the process difficult not",
    "start": "2038760",
    "end": "2044320"
  },
  {
    "text": "impossible um now uh there's a second vulnerability uh do you guys remember",
    "start": "2044320",
    "end": "2049960"
  },
  {
    "text": "the little FF uh you know at the very beginning maybe not I don't know I've been looking at this code too much maybe",
    "start": "2049960",
    "end": "2055040"
  },
  {
    "text": "um so uh well if that little code happens to be an FF in the packet that means you're trying to log into the",
    "start": "2055040",
    "end": "2061200"
  },
  {
    "text": "admin console and that leads to the second bug which is in the admin console login I'll leave it up to Joel",
    "start": "2061200",
    "end": "2069280"
  },
  {
    "text": "all right so the the next bug here is actually a timing attack on the remote console login for battle ey so uh it's",
    "start": "2069919",
    "end": "2076679"
  },
  {
    "start": "2070000",
    "end": "2070000"
  },
  {
    "text": "sort of two- part uh in the first box we've got the the disassembly here for uh for the login and the first thing",
    "start": "2076679",
    "end": "2082200"
  },
  {
    "text": "they do is actually check the length of the provided password uh against the the length of the actual password and if it",
    "start": "2082200",
    "end": "2089040"
  },
  {
    "text": "uh if it doesn't match up it just immediately uh bailes out and so as you can imagine that's a uh pretty differing",
    "start": "2089040",
    "end": "2096040"
  },
  {
    "text": "uh sort of you know function and so uh we feed enough requests to that with different lengths and then we can",
    "start": "2096040",
    "end": "2101160"
  },
  {
    "text": "eventually uh figure out the the length for the password uh from that point uh",
    "start": "2101160",
    "end": "2106320"
  },
  {
    "text": "once we once we actually have the length we get into uh a string comparison against the password uh as you can see",
    "start": "2106320",
    "end": "2112079"
  },
  {
    "text": "down here uh what eventually happens is we get a call to to string copy uh and that's actually not a uh a constant time",
    "start": "2112079",
    "end": "2119839"
  },
  {
    "text": "operation so uh we end up passing something like half a million uh attempts for each character that's",
    "start": "2119839",
    "end": "2126200"
  },
  {
    "text": "that's possible in the password uh and there's definitely a noticeable uh difference in the timing um and for this",
    "start": "2126200",
    "end": "2132400"
  },
  {
    "text": "one we actually have a a demo as well though it's it's just a",
    "start": "2132400",
    "end": "2138040"
  },
  {
    "start": "2133000",
    "end": "2133000"
  },
  {
    "text": "video where is there it is and I think it might be a little hard",
    "start": "2138040",
    "end": "2144400"
  },
  {
    "text": "to see so I'm I'm sorry about that but all right so what we've got going",
    "start": "2144400",
    "end": "2151760"
  },
  {
    "text": "here is up in the the left we actually have the the configuration file for the remote console login uh we're using",
    "start": "2151760",
    "end": "2158400"
  },
  {
    "text": "password save to generate just a random 24 character password uh and then we",
    "start": "2158400",
    "end": "2163480"
  },
  {
    "text": "save it in the the configuration file here and then once we're done with that",
    "start": "2163480",
    "end": "2169400"
  },
  {
    "text": "uh we actually just launched the uh the the server using that password that'll take just a",
    "start": "2169400",
    "end": "2178318"
  },
  {
    "text": "moment this is actually against uh ARMA 2 but it it would really apply to any of",
    "start": "2179200",
    "end": "2184240"
  },
  {
    "text": "the the battle eye enabled uh games so once that that's going it's it's been enabled using that password uh then we",
    "start": "2184240",
    "end": "2191160"
  },
  {
    "text": "uh start our our attack here which is just a python script and so we've uh We've sped this up quite a bit I think",
    "start": "2191160",
    "end": "2197560"
  },
  {
    "text": "about oh I don't know 1500% or something so that we can uh actually present it here in good time but uh it's it's a",
    "start": "2197560",
    "end": "2204839"
  },
  {
    "text": "little bit hard to see but it's just going through uh each character it's it's uh again like a half a million",
    "start": "2204839",
    "end": "2209960"
  },
  {
    "text": "iterations for the any any character that can be used in a password uh and we",
    "start": "2209960",
    "end": "2215160"
  },
  {
    "text": "don't have the numbers up here but there's there's a a gap between the correct character uh and any of the",
    "start": "2215160",
    "end": "2220319"
  },
  {
    "text": "other characters and so you can see it's just slowly W working its way through uh",
    "start": "2220319",
    "end": "2225839"
  },
  {
    "text": "I wish I could zoom that in but uh yeah I don't know so we're at about",
    "start": "2225839",
    "end": "2232760"
  },
  {
    "text": "14 it'll take a few uh few minutes here but uh how long did it take total it it",
    "start": "2232760",
    "end": "2238720"
  },
  {
    "text": "so the the attack uh from from beginning to completion it takes all of uh 17 minutes so uh this is this is locally uh",
    "start": "2238720",
    "end": "2246200"
  },
  {
    "text": "but it could be pretty easily modified to work over the network uh it was just this was for for just a proof of concept",
    "start": "2246200",
    "end": "2251880"
  },
  {
    "text": "the easiest way to do it uh once you start doing it over the network it's going to take significantly more uh attempts and so uh it would take a",
    "start": "2251880",
    "end": "2258599"
  },
  {
    "text": "little bit longer but it's definitely still possible all right so we've actually slowed down here we we've guessed 23 of the characters uh and the",
    "start": "2258599",
    "end": "2265440"
  },
  {
    "text": "actual uh battley server up there uh you see a new line so once it found the right password uh you can see the admin",
    "start": "2265440",
    "end": "2271560"
  },
  {
    "text": "logged into the console and now we got the password yeah like I said took all of 17 minutes so um you can start",
    "start": "2271560",
    "end": "2279160"
  },
  {
    "text": "kicking people and B yeah once you're into uh into the in the console yeah you can you can kick people from the server",
    "start": "2279160",
    "end": "2284760"
  },
  {
    "text": "you can do all sorts of of fun things from from in there but yeah that's that's all for",
    "start": "2284760",
    "end": "2291280"
  },
  {
    "text": "that one so for for both of these bugs uh we we found them in uh August of this",
    "start": "2291280",
    "end": "2296599"
  },
  {
    "text": "year and and reported them to the vendor uh in in the same month uh the the first of the bugs has actually been been fixed",
    "start": "2296599",
    "end": "2303440"
  },
  {
    "text": "and the patches been released and which is which is great uh and they're still working on on patching the the the",
    "start": "2303440",
    "end": "2308960"
  },
  {
    "text": "timing attack but they definitely have that coming out soon uh hopefully",
    "start": "2308960",
    "end": "2315359"
  },
  {
    "text": "so all right so uh what do we what do we think to be the you know the future of",
    "start": "2315359",
    "end": "2321000"
  },
  {
    "start": "2316000",
    "end": "2316000"
  },
  {
    "text": "anti-che so uh one option here is actually to to move that that arms race that we're talking about into into",
    "start": "2321000",
    "end": "2327079"
  },
  {
    "text": "kernel space uh problem is this is it's going to be uh incredibly tricky uh and it's it's most definitely again not a",
    "start": "2327079",
    "end": "2333440"
  },
  {
    "text": "not a comprehensive solution and once you're working in that space uh any problems there can you know instead of",
    "start": "2333440",
    "end": "2339160"
  },
  {
    "text": "getting an application bug you end up you know with a with blue screen of death so uh might be worth it uh a",
    "start": "2339160",
    "end": "2345920"
  },
  {
    "text": "second way is actually to get more of uh human factor so so players policing other players uh giving them the the",
    "start": "2345920",
    "end": "2352520"
  },
  {
    "text": "option to actually report players in other in in their games uh and we're seeing more and more of that as uh newer",
    "start": "2352520",
    "end": "2358520"
  },
  {
    "text": "games are released uh and it's it's it's great because it gives the the the players sort of a means of",
    "start": "2358520",
    "end": "2364319"
  },
  {
    "text": "self-regulation uh and it turns out that that you know people tend to be much better at catching cheaters than than",
    "start": "2364319",
    "end": "2369839"
  },
  {
    "text": "some of the automated processes um as far as uh as full solution goes there there are a couple",
    "start": "2369839",
    "end": "2375960"
  },
  {
    "text": "different uh ways that the I guess the model in some of these genres can be changed to uh help prevent against these",
    "start": "2375960",
    "end": "2381960"
  },
  {
    "text": "sort of attacks uh one of these is actually the the full streaming of games uh not quite quite there yet but what we",
    "start": "2381960",
    "end": "2388640"
  },
  {
    "text": "could do is we could have all of the the game logic and everything going on on a server so on a trusted server that we",
    "start": "2388640",
    "end": "2394240"
  },
  {
    "text": "have and then basically feed a video stream to to our player uh the problem",
    "start": "2394240",
    "end": "2399400"
  },
  {
    "text": "is with this is that it would take an incredible amount of of bandwidth and uh we're just really not not there yet uh",
    "start": "2399400",
    "end": "2406280"
  },
  {
    "text": "one other way is actually to to move the the platform uh to some sort of closed solution so you can think of uh maybe",
    "start": "2406280",
    "end": "2413119"
  },
  {
    "text": "something a little more like a like a gaming console where uh the underlying Hardware I don't necessarily control",
    "start": "2413119",
    "end": "2418680"
  },
  {
    "text": "unless you know I open up that that box and find some some interesting uh bugs in there but uh the problem with with",
    "start": "2418680",
    "end": "2425480"
  },
  {
    "text": "the open platform is that you know at the end of the day it's it's my hardware and you know I can I can do with it with",
    "start": "2425480",
    "end": "2430880"
  },
  {
    "text": "do with it what I will um but yeah just potential Solutions not sure if uh you",
    "start": "2430880",
    "end": "2436839"
  },
  {
    "text": "know where all of that that's going but so uh I guess to to conclude uh you know",
    "start": "2436839",
    "end": "2443839"
  },
  {
    "start": "2439000",
    "end": "2439000"
  },
  {
    "text": "at the end what does this all mean so uh we we sort of established that you know anti-che is is definitely a mitigation",
    "start": "2443839",
    "end": "2450599"
  },
  {
    "text": "at at best it's not going to stop all of the cheaters it was never really intended to uh we we've established that",
    "start": "2450599",
    "end": "2456599"
  },
  {
    "text": "that anti-che actually creates additional tax surface not just for you know the the game server but actually for the people playing the game um in",
    "start": "2456599",
    "end": "2464839"
  },
  {
    "text": "addition to this the since the anti-che tends to run with escalated privileges you know uh some something running a",
    "start": "2464839",
    "end": "2470760"
  },
  {
    "text": "system a service uh if you do find an exploit in there uh the impact can be you know pretty severe uh to to the to",
    "start": "2470760",
    "end": "2477359"
  },
  {
    "text": "the players in particular or I guess you know to the server um also what what one thing that crossed our you know our mind",
    "start": "2477359",
    "end": "2483119"
  },
  {
    "text": "obviously is once you pop the server then you can turn around and attack the clients uh I'll take more bugs but you",
    "start": "2483119",
    "end": "2488960"
  },
  {
    "text": "can get a pretty instant Bonet that way yeah um we've also talked about you know",
    "start": "2488960",
    "end": "2494599"
  },
  {
    "text": "how the the current anti-che it's it's actually possible to bypass it completely by by taking it all to to Kernel space it it doesn't take that",
    "start": "2494599",
    "end": "2501560"
  },
  {
    "text": "much code it's all out there and it's it's really just a matter of time before people start doing it um finally we we",
    "start": "2501560",
    "end": "2508960"
  },
  {
    "text": "think some you know real fundamental changes need to happen to the system because as we talked about before money",
    "start": "2508960",
    "end": "2514160"
  },
  {
    "text": "is becoming more and more of a a part of these online games and as that incentive you know increases we're going to get",
    "start": "2514160",
    "end": "2520520"
  },
  {
    "text": "not only you know more cheaters but definitely more sophisticated cheaters when uh they can move into this space",
    "start": "2520520",
    "end": "2526160"
  },
  {
    "text": "and make you know quite a bit of money um all right uh so that's that's about",
    "start": "2526160",
    "end": "2532200"
  },
  {
    "text": "it uh wanted to say thank you to uh a couple people from from our office uh",
    "start": "2532200",
    "end": "2537319"
  },
  {
    "text": "Rachel and Jason for for helping us you know uh through all of this and then uh",
    "start": "2537319",
    "end": "2542400"
  },
  {
    "text": "the the two interns we have pictured here definitely wanted to get them and they they actually helped us write the timing attack and uh you know and turns",
    "start": "2542400",
    "end": "2549319"
  },
  {
    "text": "are people too uh despite what some people say uh and then yeah just just too many uh co-workers to list back in",
    "start": "2549319",
    "end": "2555440"
  },
  {
    "text": "our Seattle office that have you know helped uh helped us build this talk into to to what it is today but um yeah",
    "start": "2555440",
    "end": "2563440"
  },
  {
    "text": "that's that's it uh any any questions for us about how any of any of this works uh yeah you talked uh I saw that",
    "start": "2563440",
    "end": "2572040"
  },
  {
    "text": "you reversed the so you had the source of the server",
    "start": "2572040",
    "end": "2578200"
  },
  {
    "text": "uh no it's close Source no it's close Source oh no it's public oh I know what",
    "start": "2578200",
    "end": "2585880"
  },
  {
    "text": "you're asking it's public you go to the website you can download the server and the client it comes as a little dll uh",
    "start": "2585880",
    "end": "2591000"
  },
  {
    "text": "it's actually pretty convenient you know you have a game server you just put the d on there and it's that's there so we figured we' take a",
    "start": "2591000",
    "end": "2598480"
  },
  {
    "text": "look question you talk about hiding your cheating program like",
    "start": "2598760",
    "end": "2607440"
  },
  {
    "text": "but what about the antich mechanisms that use the Kel to hide or to protect",
    "start": "2607440",
    "end": "2614400"
  },
  {
    "text": "the memory of of the game itself so at",
    "start": "2614400",
    "end": "2619520"
  },
  {
    "text": "that point like like we were talking before it becomes a game uh sort of similar to the antivirus space where you",
    "start": "2619520",
    "end": "2624760"
  },
  {
    "text": "know it's who loaded first and when you're a cheater uh you can you can basically always ensure that your kernel",
    "start": "2624760",
    "end": "2630800"
  },
  {
    "text": "driver loads first and so uh it's definitely trickier uh to do something like that but think of it as antivirus",
    "start": "2630800",
    "end": "2636720"
  },
  {
    "text": "race except the user is on the virus side yeah that's what it boils down to",
    "start": "2636720",
    "end": "2642839"
  },
  {
    "text": "in the back",
    "start": "2642839",
    "end": "2645319"
  },
  {
    "text": "there yeah you can do that problem there is Graphics yeah performance",
    "start": "2648640",
    "end": "2654680"
  },
  {
    "text": "really but once once you know this gets solved yeah you it'll open up like a whole new area U exactly like rot kits",
    "start": "2654680",
    "end": "2661400"
  },
  {
    "text": "and viruses before it follows really the same pattern but yes that's that would definitely do the trick if you get if",
    "start": "2661400",
    "end": "2666559"
  },
  {
    "text": "you can run your game more than 10 frame per second",
    "start": "2666559",
    "end": "2670720"
  },
  {
    "text": "yes uh so I mean in terms of of anti-che most of the ones that we've actually looked at aren't uh really in the kernel",
    "start": "2677400",
    "end": "2684000"
  },
  {
    "text": "space at all we didn't have a chance to I guess comprehensively look at all of them uh but I guess again getting back",
    "start": "2684000",
    "end": "2691760"
  },
  {
    "text": "to you know the fact that uh end of the day even if they're in working in in kernel space you know with with enough",
    "start": "2691760",
    "end": "2697880"
  },
  {
    "text": "work we could still bypass them so uh as far soorry what was the other the other half to your",
    "start": "2697880",
    "end": "2705000"
  },
  {
    "text": "question okay sorry sorry anybody",
    "start": "2705000",
    "end": "2710760"
  },
  {
    "text": "else yes when you moved your code into the C I'm sorry your Cod is in the C",
    "start": "2710960",
    "end": "2718880"
  },
  {
    "text": "correct what stops my Che just say not demo I don't like that",
    "start": "2718880",
    "end": "2725839"
  },
  {
    "text": "cheating uh so it can hide it entirely it as far as the antiche goes it doesn't exist in the first place if you're",
    "start": "2725839",
    "end": "2732079"
  },
  {
    "text": "operating in the kernel or you can hide it does that make sense well the the way",
    "start": "2732079",
    "end": "2739440"
  },
  {
    "text": "the way we did it originally and and is is to uh make the process protected uh",
    "start": "2739440",
    "end": "2745079"
  },
  {
    "text": "you know with a DRM feature of of modern Windows uh we basically flip a bit on on the on the um on the data structure that",
    "start": "2745079",
    "end": "2752040"
  },
  {
    "text": "represents the process in in Windows kernel and NT and and then that process is not protected and you just can't open",
    "start": "2752040",
    "end": "2757359"
  },
  {
    "text": "it even if your system on the machine but that that's just one method I mean it it's been done many times with uh",
    "start": "2757359",
    "end": "2764000"
  },
  {
    "text": "either uh removing the process completely from the double link list or I mean think of uh think of the anti-che",
    "start": "2764000",
    "end": "2770520"
  },
  {
    "text": "really as being the virus and uh the driver as being the anti virus you know that has kind of control over it you can",
    "start": "2770520",
    "end": "2777000"
  },
  {
    "text": "just completely blind it you can contain it you can do anything you want there two different priv privilege levels",
    "start": "2777000",
    "end": "2784920"
  },
  {
    "text": "so any other any other questions all right well great thanks",
    "start": "2785359",
    "end": "2791160"
  },
  {
    "text": "everyone for coming hope you enjoy [Applause]",
    "start": "2791160",
    "end": "2800400"
  }
]