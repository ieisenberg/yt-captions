[
  {
    "text": "foreign",
    "start": "1979",
    "end": "4159"
  },
  {
    "text": "good afternoon oh quite quite busy room uh if you need more seats I have some",
    "start": "9840",
    "end": "17039"
  },
  {
    "text": "extras here uh yeah so but don't be here just just",
    "start": "17039",
    "end": "23160"
  },
  {
    "text": "you miss it all right so let's get started so in this session",
    "start": "23160",
    "end": "29820"
  },
  {
    "text": "in this session we going to cover Microsoft Defender for office anyone",
    "start": "29820",
    "end": "35700"
  },
  {
    "text": "work with Defender for office for upstairs cool because",
    "start": "35700",
    "end": "41780"
  },
  {
    "text": "when I asked that Microsoft Microsoft conferences everyone raised their hands but if I ask them do you know what a",
    "start": "41780",
    "end": "48600"
  },
  {
    "text": "virtual is they're like uh what shell so Defender for office",
    "start": "48600",
    "end": "55440"
  },
  {
    "text": "the defender first is 365. um evasion that was the session after my uh",
    "start": "55440",
    "end": "63300"
  },
  {
    "text": "discovered vulnerability in that service and I'm going to show you how it was",
    "start": "63300",
    "end": "69780"
  },
  {
    "text": "um how I did that how Mike has to fix it maybe they didn't fix it let's we'll see",
    "start": "69780",
    "end": "75720"
  },
  {
    "text": "we'll see few words about myself my name is Sergey",
    "start": "75720",
    "end": "83340"
  },
  {
    "text": "I'm a security consultant instructor conference speaker",
    "start": "83340",
    "end": "89600"
  },
  {
    "text": "um if you by the way most common question do you have a Twitter no I don't I don't I prefer LinkedIn so I'm",
    "start": "92640",
    "end": "100079"
  },
  {
    "text": "too lazy to write something down LinkedIn I'm a Microsoft MVP in security and many many other certifications",
    "start": "100079",
    "end": "108000"
  },
  {
    "text": "uh just try to guess where I'm from Netherlands oh",
    "start": "108000",
    "end": "116000"
  },
  {
    "text": "oh okay uh so yeah I do have Armenian passport",
    "start": "116040",
    "end": "123540"
  },
  {
    "text": "as well but I identify myself as a Russian so and I say that everywhere and",
    "start": "123540",
    "end": "129000"
  },
  {
    "text": "when I go to the conference sometimes I get feedback you know they send feedback to me with commentaries",
    "start": "129000",
    "end": "134879"
  },
  {
    "text": "and so that was my favorite commentary I ever got thank you",
    "start": "134879",
    "end": "142160"
  },
  {
    "text": "uh here at black hat they will also send me commentaries so",
    "start": "145020",
    "end": "150300"
  },
  {
    "text": "please you can do it even better don't make me sad uh all right so uh I what what I'm going",
    "start": "150300",
    "end": "158819"
  },
  {
    "text": "to do in this session not going to just hack something and show you slides about this I'm going to give you many demos I",
    "start": "158819",
    "end": "165959"
  },
  {
    "text": "prefer live demos and so you may expect many many demos if something goes wrong with demo you know it might happen I",
    "start": "165959",
    "end": "172739"
  },
  {
    "text": "have a recording just in case so let's take a look at the agenda agenda first of all I'm going to show",
    "start": "172739",
    "end": "179700"
  },
  {
    "text": "you what Defender for Office 365 is and the feature that I'm going to show you is called safe attachments really",
    "start": "179700",
    "end": "186239"
  },
  {
    "text": "quickly because I believe most of you know what it is but I want to make sure we will build on the same page",
    "start": "186239",
    "end": "192360"
  },
  {
    "text": "next I'm going to show you something that Microsoft doesn't tell you about",
    "start": "192360",
    "end": "197700"
  },
  {
    "text": "this sandbox so that's a Sandbox but they don't tell you what it is what exactly how exactly the sandbox work",
    "start": "197700",
    "end": "204900"
  },
  {
    "text": "I'm going to show you after that how I buy attackers or me whatever how",
    "start": "204900",
    "end": "213360"
  },
  {
    "text": "attackers can bypass this safe attachments and how Microsoft respond to my",
    "start": "213360",
    "end": "219900"
  },
  {
    "text": "submission uh after after that we're going to work with safe links pretty quickly so that",
    "start": "219900",
    "end": "227099"
  },
  {
    "text": "will not be the main part so safe links and how we can also bypass safe links",
    "start": "227099",
    "end": "233159"
  },
  {
    "text": "protection all right good to go so very quickly to make sure that",
    "start": "233159",
    "end": "240299"
  },
  {
    "text": "everyone knows what it is if you haven't worked with Microsoft Services before or haven't worked with this service",
    "start": "240299",
    "end": "245519"
  },
  {
    "text": "Defender foreign specify that's the number of features to protect your collaboration and email and",
    "start": "245519",
    "end": "253620"
  },
  {
    "text": "Communications so it can protect when you send an email oh by the way I should",
    "start": "253620",
    "end": "258840"
  },
  {
    "text": "have that note oh it's working so if you send an email to office65 or you send",
    "start": "258840",
    "end": "265740"
  },
  {
    "text": "the teams attachment attachment in teams or you open Excel or documents or upload files to SharePoint what will happen in",
    "start": "265740",
    "end": "273419"
  },
  {
    "text": "parallel um this document will be opened in a",
    "start": "273419",
    "end": "280199"
  },
  {
    "text": "special sandbox and this sandbox",
    "start": "280199",
    "end": "285479"
  },
  {
    "text": "don't have doesn't have any protection no protection just a sandbox",
    "start": "285479",
    "end": "292259"
  },
  {
    "text": "and some kind of tools based on machine learning will analyze what this",
    "start": "292259",
    "end": "298139"
  },
  {
    "text": "attachment does in this sandbox so example if attachments start to",
    "start": "298139",
    "end": "304259"
  },
  {
    "text": "encrypt files documents on the sandbox hmm it is not very good right or Depends for",
    "start": "304259",
    "end": "311699"
  },
  {
    "text": "whom um but anyway so we opened that",
    "start": "311699",
    "end": "318180"
  },
  {
    "text": "micasa opens that in a special sandbox let me quickly show you how it looks like on a Microsoft webs on a Microsoft",
    "start": "318180",
    "end": "326039"
  },
  {
    "text": "security in micro security Center so if I go to to one moment",
    "start": "326039",
    "end": "334500"
  },
  {
    "text": "here um let me Zoom it a bit",
    "start": "334500",
    "end": "339780"
  },
  {
    "text": "and scroll down to save attachments",
    "start": "339780",
    "end": "345419"
  },
  {
    "text": "I have a policy let me see create new call that BH ick next oh I see I can see it here type",
    "start": "345419",
    "end": "353699"
  },
  {
    "text": "username I want to protect it doesn't really matter and",
    "start": "353699",
    "end": "359400"
  },
  {
    "text": "here I can choose Behavior so Behavior will be just monitor",
    "start": "359400",
    "end": "366180"
  },
  {
    "text": "or block means block attachment and an email itself another one replace so block only",
    "start": "366180",
    "end": "372960"
  },
  {
    "text": "attachment but keep the email and dynamic delivery which is like block attachment but delivers email",
    "start": "372960",
    "end": "379979"
  },
  {
    "text": "immediately without so email will be delivered immediately attachment will be reattached",
    "start": "379979",
    "end": "385979"
  },
  {
    "text": "so that's it that's all that Microsoft says to us about safe attachment just",
    "start": "385979",
    "end": "391560"
  },
  {
    "text": "use it and you'll be safe that's it and quite often many people that work",
    "start": "391560",
    "end": "398039"
  },
  {
    "text": "with Defender for office even those who work for Microsoft anyone here from Microsoft no all right",
    "start": "398039",
    "end": "404419"
  },
  {
    "text": "so even those who work for Microsoft they really think that this attachment is something something something special",
    "start": "404419",
    "end": "411360"
  },
  {
    "text": "that something that micro Secrets but especially for this service",
    "start": "411360",
    "end": "418199"
  },
  {
    "text": "um let's take a look what what it really is",
    "start": "418199",
    "end": "423360"
  },
  {
    "text": "let's think about one moment if attachment will be opened in the sandbox",
    "start": "423360",
    "end": "428940"
  },
  {
    "text": "what if what if we send something to the sandbox to enumerate",
    "start": "428940",
    "end": "436759"
  },
  {
    "text": "one example very stupid reversial",
    "start": "438180",
    "end": "443479"
  },
  {
    "text": "so I mean of course it's more document so if I send something like this",
    "start": "445080",
    "end": "451620"
  },
  {
    "text": "um oh this button something like this to the sandbox",
    "start": "451620",
    "end": "458039"
  },
  {
    "text": "and that will be my reverse shell maybe I can get a shell",
    "start": "458039",
    "end": "463860"
  },
  {
    "text": "we'll see or another example what if I if I send if I send Powershell",
    "start": "463860",
    "end": "469319"
  },
  {
    "text": "script files and partial script and this partial script using using wmi enumerate",
    "start": "469319",
    "end": "475319"
  },
  {
    "text": "the sandbox and then um so Powershell must be zipped and then",
    "start": "475319",
    "end": "482039"
  },
  {
    "text": "send me an email to one of my mailboxes",
    "start": "482039",
    "end": "487919"
  },
  {
    "text": "in this case I can gather some information about the sandbox",
    "start": "487919",
    "end": "493220"
  },
  {
    "text": "wanna try let's try um",
    "start": "494099",
    "end": "499580"
  },
  {
    "text": "so so so I have a listener",
    "start": "499580",
    "end": "506900"
  },
  {
    "text": "and now I need to send email I do you want to see one funny thing when",
    "start": "510440",
    "end": "517560"
  },
  {
    "text": "I try to send an email from here look what happened",
    "start": "517560",
    "end": "523339"
  },
  {
    "text": "so I'm going to send an email from my remote machine if you don't mind",
    "start": "530880",
    "end": "537019"
  },
  {
    "text": "who did it that wasn't me so I'm gonna",
    "start": "537600",
    "end": "544160"
  },
  {
    "text": "um use my remote machine let me say send a new email that will be",
    "start": "544440",
    "end": "550560"
  },
  {
    "text": "M Smith and subject will be whatever BH",
    "start": "550560",
    "end": "557399"
  },
  {
    "text": "and the most important I must add attachment so attachment should be",
    "start": "557399",
    "end": "563459"
  },
  {
    "text": "somewhere on my desktop BH and the first will be strick one",
    "start": "563459",
    "end": "571519"
  },
  {
    "text": "all right so now this email oh by the way let me show you first show you what it is",
    "start": "578580",
    "end": "584600"
  },
  {
    "text": "that whole big cell Excel Excel and if I go to developer",
    "start": "584880",
    "end": "590459"
  },
  {
    "text": "mode I will find this very simple reverse",
    "start": "590459",
    "end": "595980"
  },
  {
    "text": "shell so let me first test it I'm gonna",
    "start": "595980",
    "end": "604560"
  },
  {
    "text": "say um I want to ah",
    "start": "604560",
    "end": "610019"
  },
  {
    "text": "let me say in oh let me round again let me open that again",
    "start": "610019",
    "end": "617420"
  },
  {
    "text": "enable content and now I should get a show so a",
    "start": "617519",
    "end": "624600"
  },
  {
    "text": "document is working now I want to break the show and this time I would like to send it to the sandbox",
    "start": "624600",
    "end": "632040"
  },
  {
    "text": "uh so open it up compose that was sent",
    "start": "632040",
    "end": "639920"
  },
  {
    "text": "and here is my mailbox",
    "start": "642060",
    "end": "647300"
  },
  {
    "text": "come on can you accept it here at least",
    "start": "648060",
    "end": "652760"
  },
  {
    "text": "uh let me check which address I used maybe it was the wrong address",
    "start": "656760",
    "end": "662720"
  },
  {
    "text": "compose no that was right that was correct",
    "start": "663660",
    "end": "670100"
  },
  {
    "text": "hey come on",
    "start": "675660",
    "end": "678500"
  },
  {
    "text": "which corner other screen uh no that's a different one that's a",
    "start": "684360",
    "end": "690660"
  },
  {
    "text": "different one uh all right so if you don't want to do",
    "start": "690660",
    "end": "695760"
  },
  {
    "text": "it here I'm going to send it to different address because I have some spam policy",
    "start": "695760",
    "end": "702360"
  },
  {
    "text": "oh wait a second and oops",
    "start": "702360",
    "end": "708240"
  },
  {
    "text": "uh where's my yeah I have two screens here correct uh this one",
    "start": "708240",
    "end": "714839"
  },
  {
    "text": "let me say try again this time I'm gonna come on yep",
    "start": "714839",
    "end": "721459"
  },
  {
    "text": "and remove that all right so let's try again this time different different address",
    "start": "721620",
    "end": "728880"
  },
  {
    "text": "and that will be the same file",
    "start": "728880",
    "end": "734399"
  },
  {
    "text": "strike one and click Send",
    "start": "735600",
    "end": "742399"
  },
  {
    "text": "and let's take a look I hope this time it should be fine",
    "start": "743700",
    "end": "750720"
  },
  {
    "text": "because I already used that email address for the previous one for to send",
    "start": "750720",
    "end": "755760"
  },
  {
    "text": "emails maybe it now blocked me in that tenant how about now",
    "start": "755760",
    "end": "763160"
  },
  {
    "text": "not again",
    "start": "769560",
    "end": "772220"
  },
  {
    "text": "that's funny so those email addresses did not work anymore",
    "start": "778740",
    "end": "784380"
  },
  {
    "text": "all right so what we do in this case if it doesn't work in live demo",
    "start": "784380",
    "end": "790560"
  },
  {
    "text": "of course show video so it looks like I will show you many videos today uh if I cannot just",
    "start": "790560",
    "end": "796200"
  },
  {
    "text": "simply send an email so it looks like I'm gonna send you I'm gonna show you many videos",
    "start": "796200",
    "end": "801420"
  },
  {
    "text": "all right then um let's chh",
    "start": "801420",
    "end": "807440"
  },
  {
    "text": "let me find this moment um",
    "start": "809459",
    "end": "815579"
  },
  {
    "text": "and let's take a look um now I'm saying something there",
    "start": "815579",
    "end": "823019"
  },
  {
    "text": "uh probably and now when I send an email it's hap it just scanned in progress",
    "start": "823019",
    "end": "829200"
  },
  {
    "text": "right so scan progress now if I go back to to my",
    "start": "829200",
    "end": "835560"
  },
  {
    "text": "oh that someone tried to connect to me in parallel and in a way",
    "start": "835560",
    "end": "841139"
  },
  {
    "text": "um and now what we should we should have",
    "start": "841139",
    "end": "845540"
  },
  {
    "text": "I should have should have",
    "start": "846600",
    "end": "851480"
  },
  {
    "text": "do you have higher speed the speed oh here we go",
    "start": "853440",
    "end": "859620"
  },
  {
    "text": "so look at this now I just want to make a pose so that is the sandbox",
    "start": "859620",
    "end": "866540"
  },
  {
    "text": "what it is it's just Windows 10 machine",
    "start": "871620",
    "end": "879420"
  },
  {
    "text": "it's just windows 10. so it's not something unique and super",
    "start": "879420",
    "end": "885899"
  },
  {
    "text": "special it's just a Windows 10 machine let's take a look",
    "start": "885899",
    "end": "893300"
  },
  {
    "text": "um how this machine uh how how this machine look from inside",
    "start": "894360",
    "end": "899880"
  },
  {
    "text": "so from inside it's just Windows 10 machine it works on hyper-v",
    "start": "899880",
    "end": "905959"
  },
  {
    "text": "and not it's not really in Azure because Azure has limitations to deploy those templates so it just machine and hyper-v",
    "start": "906120",
    "end": "914220"
  },
  {
    "text": "and it's only one gig of memory it used to be one core then they also",
    "start": "914220",
    "end": "920880"
  },
  {
    "text": "create fake user and decoy content why decoy content I guess for to test run somewhere",
    "start": "920880",
    "end": "927959"
  },
  {
    "text": "because they will analyze if those files will be encrypted so they will see that those it was encrypted so it also has a",
    "start": "927959",
    "end": "935519"
  },
  {
    "text": "number of applications like office Adobe Reader on the next slide I'm going to show you a bit more uh and number of",
    "start": "935519",
    "end": "941699"
  },
  {
    "text": "custom tools so and every time every time when we see",
    "start": "941699",
    "end": "946740"
  },
  {
    "text": "this instance by the way test that from the hotel yesterday it used it used to work used",
    "start": "946740",
    "end": "952019"
  },
  {
    "text": "to deliver the email at least so um every time instance is the same",
    "start": "952019",
    "end": "958320"
  },
  {
    "text": "the same so they don't don't change the operating system version they don't change any software they don't change",
    "start": "958320",
    "end": "963540"
  },
  {
    "text": "anything it's just a new template with like fresh template but this but from",
    "start": "963540",
    "end": "968760"
  },
  {
    "text": "this they deploy instance from the same template every time so we have software",
    "start": "968760",
    "end": "976160"
  },
  {
    "text": "um Google Chrome Firefox um basic edge browser office",
    "start": "976560",
    "end": "982139"
  },
  {
    "text": "applications even project and video and number of C plus plus and so on",
    "start": "982139",
    "end": "987360"
  },
  {
    "text": "distributables so different code may run there",
    "start": "987360",
    "end": "993380"
  },
  {
    "text": "um and we have number of custom tools those custom tools",
    "start": "993600",
    "end": "1001839"
  },
  {
    "text": "it's just a bunch of dlls um don't ask me to reverse Engineers on them because it's like terrible",
    "start": "1002000",
    "end": "1008360"
  },
  {
    "text": "gigabytes of data uh just number of number of tools that Microsoft create or",
    "start": "1008360",
    "end": "1013459"
  },
  {
    "text": "maybe Fiddler is not Microsoft but most of them are by Microsoft at least I I don't know them about them I haven't",
    "start": "1013459",
    "end": "1019639"
  },
  {
    "text": "seen them on the market so so",
    "start": "1019639",
    "end": "1025459"
  },
  {
    "text": "uh now do you think um if we know about this if we know",
    "start": "1025459",
    "end": "1032000"
  },
  {
    "text": "about um what what what's inside if you know about what's inside we know about",
    "start": "1032000",
    "end": "1037938"
  },
  {
    "text": "software we know about other tools how can we bypass the sandbox",
    "start": "1037939",
    "end": "1042980"
  },
  {
    "text": "yep fingerprinting all right and after that",
    "start": "1042980",
    "end": "1050419"
  },
  {
    "text": "wait so the first commentary was I know to to make it to record that I need to repeat",
    "start": "1050419",
    "end": "1056419"
  },
  {
    "text": "that so just to add a sleep instruction like wait uh it will not work they if if",
    "start": "1056419",
    "end": "1062419"
  },
  {
    "text": "they cannot if they see sleep instruction they mark this file as not trusted so I tried did not work and that",
    "start": "1062419",
    "end": "1069440"
  },
  {
    "text": "was that that's not the most obvious for sandboxes but this one didn't work um what is the most common bypass",
    "start": "1069440",
    "end": "1076220"
  },
  {
    "text": "evasion technique after sleep um so to know the configuration of",
    "start": "1076220",
    "end": "1081320"
  },
  {
    "text": "sandbox to find the difference between sandbox and the normal workstation and do not execute in this sandbox",
    "start": "1081320",
    "end": "1089179"
  },
  {
    "text": "configuration if we know that machine virtual machine has some specific build of windows",
    "start": "1089179",
    "end": "1097640"
  },
  {
    "text": "and then number and amount of memory and number of processor cores what you can do we can create our script I mean I",
    "start": "1097640",
    "end": "1105860"
  },
  {
    "text": "mean our payload with this condition and do not execute in the in the sandbox so",
    "start": "1105860",
    "end": "1112820"
  },
  {
    "text": "look at this uh by known configuration attacking generate script macro that will not be",
    "start": "1112820",
    "end": "1118760"
  },
  {
    "text": "executed in in the sandbox",
    "start": "1118760",
    "end": "1124039"
  },
  {
    "text": "and so in this case what I did for uh what what what we can do execute oh",
    "start": "1124039",
    "end": "1129799"
  },
  {
    "text": "sorry um we can execute code only if amount of memory for example larger than two",
    "start": "1129799",
    "end": "1134840"
  },
  {
    "text": "gigabytes and here is um example of old macro",
    "start": "1134840",
    "end": "1141919"
  },
  {
    "text": "old macro here is the macro with evasion",
    "start": "1141919",
    "end": "1147820"
  },
  {
    "text": "so we use using wmi we find out number amount of memory",
    "start": "1148400",
    "end": "1155200"
  },
  {
    "text": "and not and and just any stupid condition but I just say here if amount",
    "start": "1156080",
    "end": "1161299"
  },
  {
    "text": "of memory is larger than two execute my script I mean reverse shell",
    "start": "1161299",
    "end": "1166760"
  },
  {
    "text": "if smaller I just want to say not enough RAM",
    "start": "1166760",
    "end": "1173000"
  },
  {
    "text": "make sense so and I submit that to Microsoft",
    "start": "1173000",
    "end": "1180860"
  },
  {
    "text": "I submit to Microsoft and that's what I got from them",
    "start": "1180860",
    "end": "1186759"
  },
  {
    "text": "so it was very funny email because the email said",
    "start": "1186919",
    "end": "1192140"
  },
  {
    "text": "email said uh so where is that",
    "start": "1192140",
    "end": "1198980"
  },
  {
    "text": "the issue was by Design let me just go there",
    "start": "1198980",
    "end": "1205640"
  },
  {
    "text": "It Is by Design so sandbox uh vulnerable by Design is vulnerable by",
    "start": "1205640",
    "end": "1213500"
  },
  {
    "text": "Design Center is vulnerable by Design so",
    "start": "1213500",
    "end": "1220100"
  },
  {
    "text": "um it means that and the most funny there it was by Design but",
    "start": "1220100",
    "end": "1227320"
  },
  {
    "text": "we're going to take action to improve security of sandbox",
    "start": "1227539",
    "end": "1233140"
  },
  {
    "text": "it's like we're not going to pay you but we accept your report",
    "start": "1233539",
    "end": "1239720"
  },
  {
    "text": "and we will do something to fix it and your reward is",
    "start": "1239720",
    "end": "1246020"
  },
  {
    "text": "your reward is uh recognition on the portal",
    "start": "1246020",
    "end": "1252799"
  },
  {
    "text": "cool at least I don't need to pay taxes from that",
    "start": "1252799",
    "end": "1258200"
  },
  {
    "text": "um I hope",
    "start": "1258200",
    "end": "1262600"
  },
  {
    "text": "look at this it's very old version",
    "start": "1364159",
    "end": "1369559"
  },
  {
    "text": "anyone has this version of Windows",
    "start": "1369559",
    "end": "1373360"
  },
  {
    "text": "just let me know so that's very very old so probably not",
    "start": "1374659",
    "end": "1382640"
  },
  {
    "text": "none of the users will have this uh this version now what we can do instead",
    "start": "1382640",
    "end": "1389840"
  },
  {
    "text": "what they can do let me find the video this time again uh where I made those",
    "start": "1389840",
    "end": "1396020"
  },
  {
    "text": "fixes so uh where is that",
    "start": "1396020",
    "end": "1401860"
  },
  {
    "text": "so Windows build",
    "start": "1402799",
    "end": "1408559"
  },
  {
    "text": "oh by the way when we run System Info it just shows most of versions of Windows and what we can do",
    "start": "1408559",
    "end": "1414500"
  },
  {
    "text": "look just a different wmi uh www my class",
    "start": "1414500",
    "end": "1420919"
  },
  {
    "text": "and here I can say so first in first script on this one I can I can run by the way I didn't need the email I didn't",
    "start": "1420919",
    "end": "1426620"
  },
  {
    "text": "need to email that so first I can do first first first what I can do uh where's my strike to",
    "start": "1426620",
    "end": "1435519"
  },
  {
    "text": "uh developer mode",
    "start": "1436820",
    "end": "1441460"
  },
  {
    "text": "look at this so this this will just detect the version of operating system",
    "start": "1446360",
    "end": "1451760"
  },
  {
    "text": "and and just show me the message box let's try if I say like that macros",
    "start": "1451760",
    "end": "1458419"
  },
  {
    "text": "disabled thank you one moment I'm gonna do it again this time enabled",
    "start": "1458419",
    "end": "1466299"
  },
  {
    "text": "enable content and look at this so that is my build my build",
    "start": "1466940",
    "end": "1473720"
  },
  {
    "text": "22 621 if I do the same on my remote machine",
    "start": "1473720",
    "end": "1479780"
  },
  {
    "text": "on my remote machine then it will be something old I guess",
    "start": "1479780",
    "end": "1487520"
  },
  {
    "text": "at least older",
    "start": "1487520",
    "end": "1490480"
  },
  {
    "text": "so that is 19 something something so now the the new new script will look",
    "start": "1498440",
    "end": "1505280"
  },
  {
    "text": "like this um",
    "start": "1505280",
    "end": "1509500"
  },
  {
    "text": "is that a new one",
    "start": "1511340",
    "end": "1514179"
  },
  {
    "text": "uh so now let's say if if um the windows build is smaller than",
    "start": "1516500",
    "end": "1524720"
  },
  {
    "text": "lower than number lower than 20 thousands uh then give the message box",
    "start": "1524720",
    "end": "1529880"
  },
  {
    "text": "the build is too old all right so let's try I need to enable",
    "start": "1529880",
    "end": "1535340"
  },
  {
    "text": "macro of course",
    "start": "1535340",
    "end": "1538000"
  },
  {
    "text": "so no no complaints here up to date and if I do the same on my remote",
    "start": "1540860",
    "end": "1546740"
  },
  {
    "text": "machine where build is a bit older",
    "start": "1546740",
    "end": "1552100"
  },
  {
    "text": "is too old now the last step instead of this message box oh no",
    "start": "1563600",
    "end": "1570500"
  },
  {
    "text": "instead of the previous message box we just add our reverse shell",
    "start": "1570500",
    "end": "1577480"
  },
  {
    "text": "um again will not be oh let me let me show it to you",
    "start": "1577820",
    "end": "1583100"
  },
  {
    "text": "here so if I have what it was",
    "start": "1583100",
    "end": "1590860"
  },
  {
    "text": "I got an email really to which mailbox and here",
    "start": "1594380",
    "end": "1599900"
  },
  {
    "text": "uh uh I don't see the email but I got a",
    "start": "1599900",
    "end": "1605360"
  },
  {
    "text": "reverse show at least",
    "start": "1605360",
    "end": "1608200"
  },
  {
    "text": "so it's working so all the things I showed in the video still still works I didn't know where me oh oh I I know I",
    "start": "1610880",
    "end": "1616760"
  },
  {
    "text": "know yeah I know why there's no email uh the reason why it's no email we have uh quarantine policies and if it detects",
    "start": "1616760",
    "end": "1623360"
  },
  {
    "text": "malware it removes that right right after delivery uh I'm not sure which what was the mailbox and why we haven't",
    "start": "1623360",
    "end": "1629179"
  },
  {
    "text": "seen it during the delivery but at least we see that it it used to work so we get",
    "start": "1629179",
    "end": "1634279"
  },
  {
    "text": "a reverse shell and that was yeah it's not video look it's my Kali machine that's me so now if I send an email",
    "start": "1634279",
    "end": "1642620"
  },
  {
    "text": "and this time I will have a",
    "start": "1642620",
    "end": "1647779"
  },
  {
    "text": "windows up to date so uh windows up to date",
    "start": "1647779",
    "end": "1655600"
  },
  {
    "text": "and if but file I want to send is the last one as developer",
    "start": "1655820",
    "end": "1662799"
  },
  {
    "text": "now so if the version of if quite is quite new like larger than 20 thousands then",
    "start": "1663740",
    "end": "1671059"
  },
  {
    "text": "we execute the shell and if else MSG box for ss28 so guess what in a sandbox in a",
    "start": "1671059",
    "end": "1679100"
  },
  {
    "text": "sandbox it will see message box is message box something dangerous",
    "start": "1679100",
    "end": "1685700"
  },
  {
    "text": "shouldn't be of course it depends what they say but but it shouldn't be",
    "start": "1685700",
    "end": "1692600"
  },
  {
    "text": "but on the on most operating systems it should be executed normally and",
    "start": "1692600",
    "end": "1699620"
  },
  {
    "text": "that should bypass protection so let's try again I don't know which what was",
    "start": "1699620",
    "end": "1704779"
  },
  {
    "text": "the mailbox let me send two emails I don't know which which one was accepted let me try to send them if not again I",
    "start": "1704779",
    "end": "1711500"
  },
  {
    "text": "have a video you know so uh let's just send that to",
    "start": "1711500",
    "end": "1717980"
  },
  {
    "text": "here and say BH again",
    "start": "1717980",
    "end": "1723100"
  },
  {
    "text": "and home run and send that",
    "start": "1725059",
    "end": "1732100"
  },
  {
    "text": "and come one more email and BH again",
    "start": "1732620",
    "end": "1741260"
  },
  {
    "text": "and home run",
    "start": "1741260",
    "end": "1744760"
  },
  {
    "text": "send so somewhere I should have I should get delivery um and for the sake of time for the sake",
    "start": "1746419",
    "end": "1753200"
  },
  {
    "text": "of time let me oh yeah what",
    "start": "1753200",
    "end": "1758799"
  },
  {
    "text": "One Moment One Moment nothing here",
    "start": "1759500",
    "end": "1766840"
  },
  {
    "text": "so look at this scam progress by the way while wait for the scan",
    "start": "1773299",
    "end": "1778940"
  },
  {
    "text": "I can give you one offering how about uh",
    "start": "1778940",
    "end": "1785120"
  },
  {
    "text": "horse bit no dug bit so anyone",
    "start": "1785120",
    "end": "1790340"
  },
  {
    "text": "100 on that number one or you prefer British ducks",
    "start": "1790340",
    "end": "1798380"
  },
  {
    "text": "uh by the way uh this duck number one is Donald Duck",
    "start": "1798380",
    "end": "1803419"
  },
  {
    "text": "so uh 10 seconds 10 seconds now",
    "start": "1803419",
    "end": "1809120"
  },
  {
    "text": "eight any 100 no",
    "start": "1809120",
    "end": "1815380"
  },
  {
    "text": "oh look at this anyone hear from you asked no one oh one",
    "start": "1816260",
    "end": "1822740"
  },
  {
    "text": "sorry about that uh all right so let's take a look what we have with steel scan progress",
    "start": "1822740",
    "end": "1831440"
  },
  {
    "text": "uh so don't you mind if I just move on and get back to it slightly later and",
    "start": "1831440",
    "end": "1836539"
  },
  {
    "text": "you'll see like a new email in the mailbox because we have we have just a",
    "start": "1836539",
    "end": "1843260"
  },
  {
    "text": "um just one more demo so was it clear about sandbox more or less",
    "start": "1843260",
    "end": "1848600"
  },
  {
    "text": "how can we bypass it's still work uh oh that the most important",
    "start": "1848600",
    "end": "1855520"
  },
  {
    "text": "no way and and don't submit that as well so they don't pay I know",
    "start": "1857899",
    "end": "1864620"
  },
  {
    "text": "uh so uh one more thing that we can also test while we wait for oh we also have",
    "start": "1864620",
    "end": "1871100"
  },
  {
    "text": "here uh the email skill student progress what we also have we also have one more",
    "start": "1871100",
    "end": "1878480"
  },
  {
    "text": "one more feature is what is called safe links so let me show you what safe links is I send an",
    "start": "1878480",
    "end": "1885799"
  },
  {
    "text": "email to myself uh I just want to find the right window",
    "start": "1885799",
    "end": "1890840"
  },
  {
    "text": "send an email to myself with a link so Microsoft has another feature called safe links when you click on the link in",
    "start": "1890840",
    "end": "1897679"
  },
  {
    "text": "the email what what must happen look",
    "start": "1897679",
    "end": "1903620"
  },
  {
    "text": "come on it used to work just right is it the",
    "start": "1903620",
    "end": "1909140"
  },
  {
    "text": "right one no that's not the right one sorry um",
    "start": "1909140",
    "end": "1914500"
  },
  {
    "text": "the right one should be somewhere um",
    "start": "1914779",
    "end": "1920659"
  },
  {
    "text": "somewhere somewhere somewhere here yeah",
    "start": "1920659",
    "end": "1925960"
  },
  {
    "text": "oh yeah so they say hey don't go to this website because this website is malicious and just",
    "start": "1927799",
    "end": "1935000"
  },
  {
    "text": "we don't allow you to go there and yeah when you just start to click on",
    "start": "1935000",
    "end": "1940520"
  },
  {
    "text": "the link from teams from email it doesn't allow it doesn't allow them to do it",
    "start": "1940520",
    "end": "1945679"
  },
  {
    "text": "how can we bypass that very easily to be fair we need to take",
    "start": "1945679",
    "end": "1950779"
  },
  {
    "text": "that link outside of the vendor for office system the easiest way to do it",
    "start": "1950779",
    "end": "1956240"
  },
  {
    "text": "is to create middle tier so let me show a few examples",
    "start": "1956240",
    "end": "1962559"
  },
  {
    "text": "um for the sake of time I already sent those emails if you don't mind I'm going to use existing emails",
    "start": "1963980",
    "end": "1969860"
  },
  {
    "text": "uh so first what I can do I can create the meet my own website that will",
    "start": "1969860",
    "end": "1976520"
  },
  {
    "text": "automatically redirect to malicious website so my mine's fine",
    "start": "1976520",
    "end": "1981679"
  },
  {
    "text": "but it will just redirect and now look at this yeah it's still",
    "start": "1981679",
    "end": "1986840"
  },
  {
    "text": "browser that blocks me browser but not the previous that but not the fender system so not not this one but the",
    "start": "1986840",
    "end": "1993320"
  },
  {
    "text": "browser so now we bypass one of the layers and if you if we use third-party browser like",
    "start": "1993320",
    "end": "1998960"
  },
  {
    "text": "any other browser they may not block it because they have different protection that's one of the way another one maybe",
    "start": "1998960",
    "end": "2005980"
  },
  {
    "text": "uh so it may redirect or we can create middle tier and ask user to click so choose whatever",
    "start": "2005980",
    "end": "2013659"
  },
  {
    "text": "you want it will forward it to the same website so that's the way to bypass safe",
    "start": "2013659",
    "end": "2018760"
  },
  {
    "text": "links as well all right let's take a look what do we have in my mailbox",
    "start": "2018760",
    "end": "2026759"
  },
  {
    "text": "when I check that this it contains the my my favorite show I'm not lying",
    "start": "2031179",
    "end": "2036580"
  },
  {
    "text": "let me download that uh home run documents",
    "start": "2036580",
    "end": "2045759"
  },
  {
    "text": "let me close all of the Excel Windows first",
    "start": "2046299",
    "end": "2051398"
  },
  {
    "text": "Excel where are you all right and",
    "start": "2051399",
    "end": "2058440"
  },
  {
    "text": "so just in case showing you that it's like my documents not any other folder",
    "start": "2062580",
    "end": "2070060"
  },
  {
    "text": "and developer mode visual oh thank you",
    "start": "2070060",
    "end": "2075398"
  },
  {
    "text": "so let's try again",
    "start": "2075399",
    "end": "2081598"
  },
  {
    "text": "oh it's here enable editing",
    "start": "2085119",
    "end": "2092378"
  },
  {
    "text": "oh thank you Excel you're not you're not that you're smart so but from the email I was able to",
    "start": "2092379",
    "end": "2099520"
  },
  {
    "text": "deliver I was I was able to bypass Defender Defender for office I mean and",
    "start": "2099520",
    "end": "2106900"
  },
  {
    "text": "that's it so that's the file with reversial",
    "start": "2106900",
    "end": "2112740"
  },
  {
    "text": "all right now quite common question well we have four",
    "start": "2113560",
    "end": "2118660"
  },
  {
    "text": "minute and 43 to one second uh quite common question what should we",
    "start": "2118660",
    "end": "2125560"
  },
  {
    "text": "do how can we mitigate that and I would say for this specific",
    "start": "2125560",
    "end": "2132660"
  },
  {
    "text": "vulnerabilities I don't know how to mitigate this specifically",
    "start": "2132660",
    "end": "2138099"
  },
  {
    "text": "so um the only thing you can do is to",
    "start": "2138099",
    "end": "2143980"
  },
  {
    "text": "have have more layers of protection I guess you heard the defense and death",
    "start": "2143980",
    "end": "2149440"
  },
  {
    "text": "so you saw that I bypass the email protection but Excel said no way I'm not",
    "start": "2149440",
    "end": "2155619"
  },
  {
    "text": "gonna I'm not going to run it so when you have those multiple layers that may help but this specific",
    "start": "2155619",
    "end": "2161619"
  },
  {
    "text": "vulnerability is I don't know maybe submit it again to Microsoft and don't get paid again",
    "start": "2161619",
    "end": "2167339"
  },
  {
    "text": "and maybe after a few iterations they finally do something",
    "start": "2167339",
    "end": "2172560"
  },
  {
    "text": "but they will they will they will they will update their sandbox for example",
    "start": "2172560",
    "end": "2179140"
  },
  {
    "text": "and you will not be able to use operating system build then made then they add more processor cores so we're",
    "start": "2179140",
    "end": "2184839"
  },
  {
    "text": "going to rubber them all right so so so so so",
    "start": "2184839",
    "end": "2190359"
  },
  {
    "text": "um we have three and a half minutes any questions",
    "start": "2190359",
    "end": "2197190"
  },
  {
    "text": "[Music]",
    "start": "2197190",
    "end": "2200300"
  },
  {
    "text": "[Music]",
    "start": "2204140",
    "end": "2207250"
  }
]