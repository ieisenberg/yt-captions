[
  {
    "text": "uh you are in current you're currently in the Jasmine room for internet scale malware analysis with Zachary hanf",
    "start": "240",
    "end": "7040"
  },
  {
    "text": "Thomas lingale and J George [Applause]",
    "start": "7040",
    "end": "15408"
  },
  {
    "text": "Webster hi guys we'll be discussing internet scale malware analysis so",
    "start": "16000",
    "end": "21240"
  },
  {
    "text": "during the talk we're going to briefly discuss who we are kind of the motivation the problem as we see it and",
    "start": "21240",
    "end": "26720"
  },
  {
    "text": "we're going to discuss the framework which we believe will help solve this problem in mediate it we'll then be discussing uh two different",
    "start": "26720",
    "end": "33120"
  },
  {
    "text": "implementations and discuss what we're going to be trying to do with this in the future so up here we have Zachary hanif",
    "start": "33120",
    "end": "40520"
  },
  {
    "text": "he's the director of Applied data Sciences at novetta he's also a co-author of binary Pig which is a",
    "start": "40520",
    "end": "46520"
  },
  {
    "text": "feature extraction for large scale uh static analysis we also have Thomas",
    "start": "46520",
    "end": "51920"
  },
  {
    "text": "lingo he's a PhD student at the University of Connecticut he's a senior security researcher at Netta and he's",
    "start": "51920",
    "end": "58760"
  },
  {
    "text": "the creator of drau which is uh pretty much for large scale Dynamic analysis",
    "start": "58760",
    "end": "63800"
  },
  {
    "text": "through virtual machine introspection and then you have me I'm George Webster I'm a PhD student at the technicia",
    "start": "63800",
    "end": "69799"
  },
  {
    "text": "University T of Munich and I'm researching the cognitive bias on Cyber",
    "start": "69799",
    "end": "75080"
  },
  {
    "text": "defense so what we really have for our motivation is we wanted to create a system that really Incorporated the full",
    "start": "75080",
    "end": "80960"
  },
  {
    "text": "scale of the analytics life cycle and we wanted to do this across multiple teams so we needed the system to be very fast",
    "start": "80960",
    "end": "87439"
  },
  {
    "text": "we needed it to be scalable we wanted it to be res resiliant we wanted it to be flexible and by flexible I mean we want",
    "start": "87439",
    "end": "93320"
  },
  {
    "text": "to be able to incorporate new analytic methods and techniques um pretty much with",
    "start": "93320",
    "end": "98479"
  },
  {
    "text": "EAS so what we did was we first we developed scallet when scallet is just",
    "start": "98479",
    "end": "104759"
  },
  {
    "text": "basically an architectural brewprint for saying this is how we need to design our system this is what we need to create we",
    "start": "104759",
    "end": "111119"
  },
  {
    "text": "then did totem which is a scalable static analysis implementation and then we said hey we need to take drau for",
    "start": "111119",
    "end": "117479"
  },
  {
    "text": "dynamic analysis and figure out how to tie this all into the system together and drau is done with the hypervisor and",
    "start": "117479",
    "end": "123680"
  },
  {
    "text": "it needs no in gust agent and it's quite nice so to kind of discuss the problem",
    "start": "123680",
    "end": "129640"
  },
  {
    "text": "is really the current state of affairs and as you guys are all well aware it's absolutely like a tsunami and this is for multiple reasons",
    "start": "129640",
    "end": "136879"
  },
  {
    "text": "which we'll discuss shortly but really it's because we can't keep up so in 2012",
    "start": "136879",
    "end": "142879"
  },
  {
    "text": "mcafe stated that we receive 200,000 unique samples a day however in May in",
    "start": "142879",
    "end": "148400"
  },
  {
    "text": "2015 virus was saying that we were receiving 1 million samples a day and",
    "start": "148400",
    "end": "153519"
  },
  {
    "text": "this doesn't even talk about the historic data that we have and trying to process all that information as well",
    "start": "153519",
    "end": "159599"
  },
  {
    "text": "furthermore our tools are absolutely disjointed um they're pretty much one shot wonders trying to solve the problem",
    "start": "159599",
    "end": "166080"
  },
  {
    "text": "for what they need to do at that time not really looking at how do you tie this into the big picture of things",
    "start": "166080",
    "end": "171400"
  },
  {
    "text": "there's also heavy Reliance on the individual analyst and a single person to try to tie it all together and figure out what's really going",
    "start": "171400",
    "end": "178200"
  },
  {
    "text": "on furthermore our tools are only focused on the binary this came a lot from the antivirus Community but the",
    "start": "178200",
    "end": "184720"
  },
  {
    "text": "problem with that is you got multi-stage droppers you got metamorphic malware you got polymorphism and really at the end",
    "start": "184720",
    "end": "191360"
  },
  {
    "text": "of the day creating a new binary creating a new sample is absolutely dirt cheap and it's just you can't keep up",
    "start": "191360",
    "end": "198120"
  },
  {
    "text": "furthermore you got your defensive tools are all focused on that signature so these binaries that can't keep up with",
    "start": "198120",
    "end": "204440"
  },
  {
    "text": "you got the defensive tools are trying to create signatures for those binaries so if you look at snort AV products y",
    "start": "204440",
    "end": "211760"
  },
  {
    "text": "rules you just really can't keep up so the current state of affairs is",
    "start": "211760",
    "end": "217879"
  },
  {
    "text": "getting even worse with kind of the rise of the actors you got organized crime you got nation states and these guys are",
    "start": "217879",
    "end": "224720"
  },
  {
    "text": "very sophisticated um they're very smart they definitely know what they're doing and now they have a lot of resources so",
    "start": "224720",
    "end": "231319"
  },
  {
    "text": "maare no longer is existing in a vacuum you really have teams that are dealing with sophisticated tools you got large",
    "start": "231319",
    "end": "237400"
  },
  {
    "text": "scale infrastructure that's very complex you analysts telling them what to do how to do it and where to do it and you also",
    "start": "237400",
    "end": "243560"
  },
  {
    "text": "have Financial networks that are moving the money around so what this really means is your",
    "start": "243560",
    "end": "249640"
  },
  {
    "text": "reverse engineer he's really not enough so we really need to get pretty",
    "start": "249640",
    "end": "255920"
  },
  {
    "text": "much going back to the initial like analytic life cycle and say we need to focus on the five W's we need to focus",
    "start": "255920",
    "end": "262040"
  },
  {
    "text": "on who's behind the action what are their goals where is the infrastructure",
    "start": "262040",
    "end": "267400"
  },
  {
    "text": "when do they operate why are they conducting this operation and most importantly how do we stop the",
    "start": "267400",
    "end": "274280"
  },
  {
    "text": "activity so lastly we're really in the age of big data and we need to figure",
    "start": "274280",
    "end": "280440"
  },
  {
    "text": "out how to leverage our defensive tools to actually take advantage of some of these techniques take advantage of this data that we have um and we need to use",
    "start": "280440",
    "end": "287840"
  },
  {
    "text": "multiple tools and different techniques to do this one thing's not going to do it for us so we need to use machine learning we need to do graphical",
    "start": "287840",
    "end": "294160"
  },
  {
    "text": "representation we also need to do reverse engineering across what we get so as we sat there we looked at the",
    "start": "294160",
    "end": "301039"
  },
  {
    "text": "problem and said really we got two ways to go forward one is we stick what we currently have and we're going to get failure or we probably already have it",
    "start": "301039",
    "end": "308280"
  },
  {
    "text": "or two we try to figure out something else try to go a different direction maybe have some success so in order to try to go to the",
    "start": "308280",
    "end": "315520"
  },
  {
    "text": "success path what we did was we created scallet and scallet is really a microservices framework that is",
    "start": "315520",
    "end": "322199"
  },
  {
    "text": "basically made to conduct the full analytic life cycle and provide the infrastructure needed so we wanted to support hundreds of millions of objects",
    "start": "322199",
    "end": "329199"
  },
  {
    "text": "allowed to automatically expand over public and private infrastructure pretty much the cloud we also wanted to provide",
    "start": "329199",
    "end": "335440"
  },
  {
    "text": "the infrastructure to not only gather all the features that we need but also to provide the infrastructure to then do",
    "start": "335440",
    "end": "340800"
  },
  {
    "text": "something with that data we also wanted to support third parties so if you're dealing with virus total threat connect",
    "start": "340800",
    "end": "347360"
  },
  {
    "text": "all these great places that it can bring the stuff into the system and even",
    "start": "347360",
    "end": "352400"
  },
  {
    "text": "though the tools are disjointed it doesn't mean that they're not valuable and they're not important so instead of having to rewrite the wheel we wanted to",
    "start": "352400",
    "end": "358720"
  },
  {
    "text": "be able to incorporate all that stuff back into the systems so when we look at scallet we",
    "start": "358720",
    "end": "365199"
  },
  {
    "text": "really broke the system down into three core components and these components are the transport layer your planner and",
    "start": "365199",
    "end": "372560"
  },
  {
    "text": "then your services so the goal of the service is",
    "start": "372560",
    "end": "377919"
  },
  {
    "text": "to perform an individual task independently of each other kind of an atomic nature and we wanted them to only",
    "start": "377919",
    "end": "384479"
  },
  {
    "text": "interact with the planner next with the planner we we",
    "start": "384479",
    "end": "389680"
  },
  {
    "text": "wanted to schedule the service's execution and figure out if something's going wrong with the service fix it if",
    "start": "389680",
    "end": "395759"
  },
  {
    "text": "thing needs to be restarted restart it and then kind of manage all that together but do it in a smart way where",
    "start": "395759",
    "end": "400800"
  },
  {
    "text": "it actually figures out how do we do this best so we're not just wasting our",
    "start": "400800",
    "end": "405960"
  },
  {
    "text": "Cycles furthermore we wanted a planner uh that can sorry we wanted a transport layer that can actually move everything",
    "start": "405960",
    "end": "411759"
  },
  {
    "text": "around between the planners and do this in a scheduled way to kind of make it so we can't really lose",
    "start": "411759",
    "end": "417599"
  },
  {
    "text": "data so looking at SC this is pretty much the big picture and with the big picture there's five main themes you got",
    "start": "417599",
    "end": "423879"
  },
  {
    "text": "your gateway your storage your investigation your interrogation and your presentation themes in this talk",
    "start": "423879",
    "end": "431120"
  },
  {
    "text": "we're really going to talk about the investigation and the interrogation levels so with the interrogation planner",
    "start": "431120",
    "end": "438960"
  },
  {
    "text": "the goal here is to figure out when you receive a sample when you receive an IP address a domain what is it and what",
    "start": "438960",
    "end": "446440"
  },
  {
    "text": "information can you get from it so so this really focuses on just one",
    "start": "446440",
    "end": "451639"
  },
  {
    "text": "object be whatever it is it's agnostic but how do you do the static analysis",
    "start": "451639",
    "end": "457039"
  },
  {
    "text": "perform the dynamic analysis get information from your third parties and kind of put everything together so let's",
    "start": "457039",
    "end": "463479"
  },
  {
    "text": "say you got a sample this will execute cuckoo this will pull into drau for dynamic analysis PE info virus total or",
    "start": "463479",
    "end": "470840"
  },
  {
    "text": "whatever have you next is you get a huge amount of data and you got a lot of features that",
    "start": "470840",
    "end": "476479"
  },
  {
    "text": "are generated from this so what do you do with that all that data how do you display it what do you work with it from",
    "start": "476479",
    "end": "482919"
  },
  {
    "text": "there we have the investigation planner this is broken down into two parts the first is you're dealing with a",
    "start": "482919",
    "end": "489800"
  },
  {
    "text": "tremendous amount of data so you need to parad an infrastructure to figure out what's going on and this incorporates",
    "start": "489800",
    "end": "495319"
  },
  {
    "text": "machine learning and static analysis to say Hey how do we cluster our stuff together do we see any patterns across",
    "start": "495319",
    "end": "501759"
  },
  {
    "text": "data that we have what is the behavior how is everything functioning so how do we do that on that level next is we're",
    "start": "501759",
    "end": "509159"
  },
  {
    "text": "dealing with with humans and our human analysts are very good so we wanted to be able to say what do we do and how do",
    "start": "509159",
    "end": "515800"
  },
  {
    "text": "we provide this data to these people in a way that makes sense for that individual not in a way that makes sense",
    "start": "515800",
    "end": "521440"
  },
  {
    "text": "for the person that created it so we wanted to be able to provide services that can provide an API interface plug",
    "start": "521440",
    "end": "527959"
  },
  {
    "text": "into a web portal so if you had say Ida Pro you could just provide a service that",
    "start": "527959",
    "end": "533800"
  },
  {
    "text": "provides the data you need into it pro if you had multigo just add a little service that provides an API so now your",
    "start": "533800",
    "end": "540440"
  },
  {
    "text": "data could be displayed in multigo the goal here was to display the data in a way that's best for the analyst best for",
    "start": "540440",
    "end": "546480"
  },
  {
    "text": "the end user and could tie into your existing tools so with scalled what we really did",
    "start": "546480",
    "end": "553920"
  },
  {
    "text": "we created a framework and the framework provides a general overview so going forward in this talk",
    "start": "553920",
    "end": "561160"
  },
  {
    "text": "we're going to provide kind of two different tiles of implementation the first is going to be static analysis and",
    "start": "561160",
    "end": "568079"
  },
  {
    "text": "then the second is going to be the damic analysis piece to start talking about the static",
    "start": "568079",
    "end": "573440"
  },
  {
    "text": "analysis implementation I'm going to hand it off to Zack and he's going to discuss",
    "start": "573440",
    "end": "579160"
  },
  {
    "text": "totem so totem is the first planner that we implemented that effectively controls",
    "start": "579839",
    "end": "585160"
  },
  {
    "text": "how we consume work what work needs to be done and how we monitor the work that needs to be performed um totem can be",
    "start": "585160",
    "end": "592120"
  },
  {
    "text": "thought of both as the planner the thing that coordinates all the individual elements of work and all we need to do",
    "start": "592120",
    "end": "598040"
  },
  {
    "text": "as well as the static analysis components which directly plug into it so totem represents our static",
    "start": "598040",
    "end": "605880"
  },
  {
    "text": "analysis process for very large file data sets um right now noveta which is where I'm working uh receives mid",
    "start": "605880",
    "end": "613640"
  },
  {
    "text": "middling six figures worth of malware every day for those of you from a large AV or one of the infrastructure owners",
    "start": "613640",
    "end": "619160"
  },
  {
    "text": "um I'm sure that's not what you would consider to be extremely large amounts of malware um but that's what we get in a streaming process on a daily basis and",
    "start": "619160",
    "end": "626040"
  },
  {
    "text": "we evaluated a number of different open source uh uh m zoo and Ma instrumentation engines to try and",
    "start": "626040",
    "end": "632560"
  },
  {
    "text": "figure out if anything that's already existing out there would work for us and what we found was more or less nothing",
    "start": "632560",
    "end": "637680"
  },
  {
    "text": "out there right now is able to consume streaming amounts of data uh at the volumes that we needed for the kind of",
    "start": "637680",
    "end": "643560"
  },
  {
    "text": "analytics that we need to perform um the other thing that we started noticing as well uh in the process of doing a",
    "start": "643560",
    "end": "649480"
  },
  {
    "text": "handful of uh directed operations over the course of this last year was that a lot of our partners in the AV industry",
    "start": "649480",
    "end": "656160"
  },
  {
    "text": "or in the uh larger larger security industry some of them had serious problems being",
    "start": "656160",
    "end": "661920"
  },
  {
    "text": "able to run historical signatures or historical analytics against their malware store um obviously anyone's",
    "start": "661920",
    "end": "669240"
  },
  {
    "text": "going to have issues running uh uh any kind of analytic against 200 300 million malware samples um but we were finding",
    "start": "669240",
    "end": "676360"
  },
  {
    "text": "that they probably couldn't even go back more than a week or two in many cases uh and so what we identified was we needed",
    "start": "676360",
    "end": "681959"
  },
  {
    "text": "to develop some way to allow us not just to ingest the ongoing set of M that we have right now but to also be able to",
    "start": "681959",
    "end": "688519"
  },
  {
    "text": "apply new analytics and new uh findings against the historical malare sets that we have because if you can't look back",
    "start": "688519",
    "end": "694920"
  },
  {
    "text": "what good are your models at the end of the day um in addition to that we identified a handful of other uh design",
    "start": "694920",
    "end": "701600"
  },
  {
    "text": "requirements that we had we needed to be able to have dynamically defined jobs and by that I mean uh let's say a piece",
    "start": "701600",
    "end": "708200"
  },
  {
    "text": "of M comes in and we know for whatever various reasons we have we only need to run it against one or two different",
    "start": "708200",
    "end": "713880"
  },
  {
    "text": "analytics whereas another piece of Mal that we collect might need to be run against seven or eight or even n um any",
    "start": "713880",
    "end": "720639"
  },
  {
    "text": "arbitrary number that we have you can't set up a system that uh has one particular path of execution through the",
    "start": "720639",
    "end": "728320"
  },
  {
    "text": "overall analytic stream you need to be able to uh route things dynamically you effectively have these small graphs that",
    "start": "728320",
    "end": "735000"
  },
  {
    "text": "get created so that you're able to say okay if this result is such and such you run it against this other analytic uh",
    "start": "735000",
    "end": "742360"
  },
  {
    "text": "and then finally we needed to be able to dynamically scale this system uh the other thing that we found when",
    "start": "742360",
    "end": "748120"
  },
  {
    "text": "interacting with other people in the the larger malare Community was when doing static analysis we found a lot of people",
    "start": "748120",
    "end": "754000"
  },
  {
    "text": "who would size clusters based on either the spike that they get uh on every",
    "start": "754000",
    "end": "759880"
  },
  {
    "text": "single day when new Mau comes in or they would size it against some uh known quantity that they'd be getting every",
    "start": "759880",
    "end": "766360"
  },
  {
    "text": "day on average um and and respectively this leads to either uh you have an",
    "start": "766360",
    "end": "771760"
  },
  {
    "text": "underutilized cluster or a cluster that you have to continuously resize every single time you go up another 10 or 20%",
    "start": "771760",
    "end": "778519"
  },
  {
    "text": "and your average number of malare samples you've collected a day um so we implemented it along the same time as we",
    "start": "778519",
    "end": "784279"
  },
  {
    "text": "began to define the scald framework and we We've Ended up with an asynchronous and easily extendable system um that",
    "start": "784279",
    "end": "790160"
  },
  {
    "text": "lets us scale very well and be resilient to failures in a distributed environment so calling back to the graph",
    "start": "790160",
    "end": "797880"
  },
  {
    "text": "we saw a little bit earlier between the transport planner and service layers uh this is how we've implemented it in",
    "start": "797880",
    "end": "803839"
  },
  {
    "text": "terms of uh totem our transport layer is handled by rabbit mq the transport layer",
    "start": "803839",
    "end": "809160"
  },
  {
    "text": "is where we load new samples into or at least tell the system that there are new samples that need to be processed we're",
    "start": "809160",
    "end": "815360"
  },
  {
    "text": "using rabit mq for a handful of reasons and and they're all very practical um at the end of the day it's a very well",
    "start": "815360",
    "end": "821360"
  },
  {
    "text": "understood well supported system every major language has bindings for it and most of the bindings are actually very",
    "start": "821360",
    "end": "826519"
  },
  {
    "text": "good um I'd imagine that probably I don't know a third to half of the people in here have probably used it or heard",
    "start": "826519",
    "end": "831639"
  },
  {
    "text": "of it in some way at some point in time and this allows us to asynchronously load malware hold it for work and then",
    "start": "831639",
    "end": "838199"
  },
  {
    "text": "have new workers join um there are a couple of very nice things about rabbit aside from the fact that it's easy to",
    "start": "838199",
    "end": "843759"
  },
  {
    "text": "understand and easy to work with um probably the biggest one of it is it's very easy to scale the system as a whole",
    "start": "843759",
    "end": "850440"
  },
  {
    "text": "right now we're capable of ingesting probably north of uh 7,000 uh malware",
    "start": "850440",
    "end": "856800"
  },
  {
    "text": "samples a second uh during our our current deployment um which is more than",
    "start": "856800",
    "end": "861920"
  },
  {
    "text": "fast enough for our average streaming process um what we're able to do with that is quickly uh ingest a large amount",
    "start": "861920",
    "end": "868639"
  },
  {
    "text": "of Mal but when we come to stages where we need to ingest even further not only can we add on more uh submitters to the",
    "start": "868639",
    "end": "875320"
  },
  {
    "text": "system we're capable of horizontally scaling rabbit itself um it's got high availability for those of you who need",
    "start": "875320",
    "end": "881759"
  },
  {
    "text": "uh some kind of high availability system and then you're also able to distribute the cues themselves so you can have",
    "start": "881759",
    "end": "887480"
  },
  {
    "text": "dedicated nodes working on a single queue and all sorts of other fun things the other piece of functionality that we",
    "start": "887480",
    "end": "893800"
  },
  {
    "text": "really rely on very heavily inside of rabbit is that it's got a very deep uh routing topology system um it's very",
    "start": "893800",
    "end": "900560"
  },
  {
    "text": "easy to insert various ways to Route samples through rabit and Q while being",
    "start": "900560",
    "end": "905880"
  },
  {
    "text": "able to maintain a level of persistence in the system in the event that we lose a rabbit node in the event we lose a",
    "start": "905880",
    "end": "911399"
  },
  {
    "text": "worker we never actually lose any kind of meaningful work we always remember that there was several jobs that were",
    "start": "911399",
    "end": "917199"
  },
  {
    "text": "hued that we need to process that M needs to be uh pushed through we never actually lose any kind of maintained",
    "start": "917199",
    "end": "923839"
  },
  {
    "text": "State the next part of the uh chain really then is the planner which is the totem work itself um it's the largest",
    "start": "923839",
    "end": "932319"
  },
  {
    "text": "collection of State overall in the system it manages rabid mq Communications it organizes verifies and",
    "start": "932319",
    "end": "938360"
  },
  {
    "text": "validates results once they've come in it ensures that uh downloads of the individual malware samples themselves",
    "start": "938360",
    "end": "944480"
  },
  {
    "text": "happen happen at speed and it does all the communication with the individual analytical Services um overall this is",
    "start": "944480",
    "end": "951800"
  },
  {
    "text": "our major Workhorse um it's got a lot of interesting properties if uh any any single worker fails messages are",
    "start": "951800",
    "end": "958440"
  },
  {
    "text": "persistent dis if uh a a particular set of analytics fails about halfway through",
    "start": "958440",
    "end": "963880"
  },
  {
    "text": "the analytical set anything that succeeded gets serialized out gets stored uh for uh database use later um",
    "start": "963880",
    "end": "970959"
  },
  {
    "text": "and anything that failed will simply get bundled back up and recued again um and this keeps us from having to do multiple",
    "start": "970959",
    "end": "977199"
  },
  {
    "text": "retransmissions or retransmissions in different areas all for the same set of analytics and this seriously cuts down",
    "start": "977199",
    "end": "983839"
  },
  {
    "text": "on the amount of network traffic that we have overall and speeds up what we have",
    "start": "983839",
    "end": "989319"
  },
  {
    "text": "finally we've got the services themselves um they're based off of Bas",
    "start": "989319",
    "end": "994560"
  },
  {
    "text": "basic restful wrappers around uh known uh uh tools or uh things that are",
    "start": "994560",
    "end": "999920"
  },
  {
    "text": "developed internally to uh to the consumer um we made this decision for a couple of reasons yes HTP is not the",
    "start": "999920",
    "end": "1006680"
  },
  {
    "text": "fastest thing out there and yes you could definitely have implemented it using say protab Buffs or Avro or even Thrift or something along those lines a",
    "start": "1006680",
    "end": "1013079"
  },
  {
    "text": "more traditional IPC system um but one of the things that we quickly found was uh our initial beta testers enjoyed the",
    "start": "1013079",
    "end": "1019759"
  },
  {
    "text": "fact that they were able to take any code that they currently had and any language they currently developed things",
    "start": "1019759",
    "end": "1026520"
  },
  {
    "text": "in and they were very easily able to integrate it with totem anything that speaks a basic rest uh communication",
    "start": "1026520",
    "end": "1033360"
  },
  {
    "text": "protocol will will be useful um you can immediately communicate with uh the service internally as well as",
    "start": "1033360",
    "end": "1039280"
  },
  {
    "text": "communicate with external uh Services um we've seen some room I have a branch",
    "start": "1039280",
    "end": "1045558"
  },
  {
    "text": "internal uh to the office um that allows us to get a little bit of extra speed But ultimately uh transference speed",
    "start": "1045559",
    "end": "1052960"
  },
  {
    "text": "between local nodes is is not necessarily a problem so a couple of the uh things",
    "start": "1052960",
    "end": "1059320"
  },
  {
    "text": "that I thought were important about totem that we should probably drill down on um the to the totem system as a whole is message Centric um there is no shared",
    "start": "1059320",
    "end": "1066520"
  },
  {
    "text": "State between workers so while you have a distributed worker swarm none of the workers know about any other worker in",
    "start": "1066520",
    "end": "1072320"
  },
  {
    "text": "the group um and this makes things a lot simpler for implementers uh both myself as well as anyone who would be",
    "start": "1072320",
    "end": "1078440"
  },
  {
    "text": "implementing this inside of their own uh local environment you don't have to worry about maintaining any kind of",
    "start": "1078440",
    "end": "1084520"
  },
  {
    "text": "concurrent State you don't have to worry about having any kind of consensus you don't have to worry about uh where",
    "start": "1084520",
    "end": "1090640"
  },
  {
    "text": "anything is if a worker dies this allows us to keep our workers as very Expendable nodes um and because of the",
    "start": "1090640",
    "end": "1097000"
  },
  {
    "text": "fact that our jobs are individual messages each one comprised of a single element of analytical work we're able to",
    "start": "1097000",
    "end": "1103080"
  },
  {
    "text": "just serialize a single message we don't have to ship uh individual binaries across the wire we don't have to ship",
    "start": "1103080",
    "end": "1109039"
  },
  {
    "text": "anything in any particular weird way you're only sending you a handful of bites at any given time and all of",
    "start": "1109039",
    "end": "1114640"
  },
  {
    "text": "that's textual and that really speeds up the ability to load new samples and perform analysis at scale um we've seen",
    "start": "1114640",
    "end": "1121000"
  },
  {
    "text": "a couple of other systems that are in the uh streaming space that uh do things using uh either zeromq or a handful of",
    "start": "1121000",
    "end": "1127400"
  },
  {
    "text": "other systems that do directed uh transference of U malare samples",
    "start": "1127400",
    "end": "1132520"
  },
  {
    "text": "themselves across the distributed Cloud um and that's a useful way of handling",
    "start": "1132520",
    "end": "1138080"
  },
  {
    "text": "things if you're guaranteed to be inside a local network at all times but we don't have that guarantee um one of the",
    "start": "1138080",
    "end": "1144120"
  },
  {
    "text": "things that we're doing is we have a hybrid system for processing this malware 99% of all the samples that we",
    "start": "1144120",
    "end": "1150240"
  },
  {
    "text": "have we're perfectly comfortable with processing them inside of AWS or another cloud provider we only get a handful of",
    "start": "1150240",
    "end": "1155679"
  },
  {
    "text": "samples at any given time uh which absolutely have to be maintained within the control of our our local",
    "start": "1155679",
    "end": "1160960"
  },
  {
    "text": "environments one of the nicer things about totem is it allows us to scale material across a hybrid environment",
    "start": "1160960",
    "end": "1166559"
  },
  {
    "text": "samples that need to stay local samples that that need to be run say a dynamic analysis system uh can stay and are",
    "start": "1166559",
    "end": "1172559"
  },
  {
    "text": "automatically routed to local nodes whereas other nodes uh sitting out in the cloud or sitting uh in in any kind",
    "start": "1172559",
    "end": "1178679"
  },
  {
    "text": "of distributed environment will automatically consume messages that are more appropriate for them so long as a totem worker is capable of communicating",
    "start": "1178679",
    "end": "1185200"
  },
  {
    "text": "with a rabbit and Q node in this case or um any kind of distributed file system we have a HTTP load balancer that sits",
    "start": "1185200",
    "end": "1192159"
  },
  {
    "text": "in front of a distributed Rea CS cluster um you're able to begin processing um at",
    "start": "1192159",
    "end": "1198840"
  },
  {
    "text": "the end of the day deployment for any individual node takes on the order of maybe 5 10 seconds all",
    "start": "1198840",
    "end": "1204760"
  },
  {
    "text": "told um we're overall very resilient to failures as you have to be in any kind of distributed environment um we take",
    "start": "1204760",
    "end": "1211039"
  },
  {
    "text": "best effort guarantees to be able to uh uh transfer your message not lose work and and and generally function normally",
    "start": "1211039",
    "end": "1217960"
  },
  {
    "text": "um right now we're a at at least once processing system which means that there",
    "start": "1217960",
    "end": "1223039"
  },
  {
    "text": "are sometimes instances where if you kill a worker a specific job might be completed twice these are fair rare",
    "start": "1223039",
    "end": "1229200"
  },
  {
    "text": "circumstances but we can't get the guarantee really any better than that at the moment um that's not a major concern",
    "start": "1229200",
    "end": "1234360"
  },
  {
    "text": "for us at the end of the day most of the static analyses that we do are relatively time independent and",
    "start": "1234360",
    "end": "1239520"
  },
  {
    "text": "everything that we load into our backend DBS gets time stamped so we know if there has been a secondary a secondary",
    "start": "1239520",
    "end": "1245640"
  },
  {
    "text": "run due to some you know component failure um but at the end of the day it allows us to very easily um make sure",
    "start": "1245640",
    "end": "1252039"
  },
  {
    "text": "that we have never lost any particular element of work um and finally because of the fact that each individual message",
    "start": "1252039",
    "end": "1258159"
  },
  {
    "text": "can be serialized as a set of individual components of analytics if we go through",
    "start": "1258159",
    "end": "1263600"
  },
  {
    "text": "four five six analytics and the seventh or eth one fail for any arbitrary reason",
    "start": "1263600",
    "end": "1268760"
  },
  {
    "text": "we serialize out anything that succeeded we retain anything that failed and we recue it all over",
    "start": "1268760",
    "end": "1274679"
  },
  {
    "text": "again um obviously as anyone who's familiar with uh some of the distributed systems work um anything that's backed",
    "start": "1274679",
    "end": "1280960"
  },
  {
    "text": "for and front with cues um is is a fairly Loosely coupled architecture um",
    "start": "1280960",
    "end": "1286159"
  },
  {
    "text": "we found that this is very very helpful for us um failures we found Even in our worst scenarios might stop processing",
    "start": "1286159",
    "end": "1292880"
  },
  {
    "text": "but at no point is the fact that we need to run particular samples uh ever actually compromised and we've never",
    "start": "1292880",
    "end": "1298559"
  },
  {
    "text": "failed to deliver a message regardless of how many workers we actually kill um this is useful for us um it allows us to",
    "start": "1298559",
    "end": "1305480"
  },
  {
    "text": "run uh things inside of AWS on spot instances where you don't have any real guarantees um which seriously cuts down",
    "start": "1305480",
    "end": "1312039"
  },
  {
    "text": "on the amount of uh cost that is ultimately incurred and it definitely allows us to add new workers and very",
    "start": "1312039",
    "end": "1318880"
  },
  {
    "text": "diverse environments very easily because we're never really concerned that something might become deadlocked or something might stop or or cause some",
    "start": "1318880",
    "end": "1325080"
  },
  {
    "text": "kind of cascading failure um one of the things that I got asked a lot when originally designing the system and",
    "start": "1325080",
    "end": "1330559"
  },
  {
    "text": "demoing it to people um was what are we doing for our language selection you know what what is everyone going to have",
    "start": "1330559",
    "end": "1336400"
  },
  {
    "text": "to learn to be able to work with this now obviously for the analytics we're more or less language agnostic um but",
    "start": "1336400",
    "end": "1342120"
  },
  {
    "text": "totem itself the planner and the monitoring layer is implemented in a jvm language which is Scala um we chose that",
    "start": "1342120",
    "end": "1349200"
  },
  {
    "text": "for a couple of reasons I know that there are a number of systems out there that are using python or other systems right now but we chose something that",
    "start": "1349200",
    "end": "1356000"
  },
  {
    "text": "that moves away from python for for three major reasons one I want to be able to have easy seamless concurrency",
    "start": "1356000",
    "end": "1363120"
  },
  {
    "text": "without having to fight the Gill every 10 minutes um because I get really sick of that um I wanted to be able to have",
    "start": "1363120",
    "end": "1368679"
  },
  {
    "text": "type safety internally so that way if someone who's implementing a new analytic wants to ensure that data is",
    "start": "1368679",
    "end": "1373880"
  },
  {
    "text": "heavily vetted before moving on to the database system or uh enforce a schema on one particular area uh they'd be able",
    "start": "1373880",
    "end": "1380880"
  },
  {
    "text": "to do so um and in the case for people who don't want to enforce schemas were capable of just serializing things",
    "start": "1380880",
    "end": "1385960"
  },
  {
    "text": "blindly to Json without any kind of major issue um and then uh finally we wanted to have a system that's",
    "start": "1385960",
    "end": "1391799"
  },
  {
    "text": "relatively approachable um lots of people may not like Java I'm not personally an enormous fan of it myself",
    "start": "1391799",
    "end": "1397480"
  },
  {
    "text": "but it's very understandable syntax um scholar syntax is not necessarily um substantially different and especially",
    "start": "1397480",
    "end": "1404039"
  },
  {
    "text": "in what we've uh open source today we've gone through some fairly substantive means to make sure that everything's",
    "start": "1404039",
    "end": "1409520"
  },
  {
    "text": "very clear and very approachable so no one who's looking at it should you know if you've passed a level one or level",
    "start": "1409520",
    "end": "1414840"
  },
  {
    "text": "two CS class or even been in the industry for a year or two you should be able to immediately understand what's",
    "start": "1414840",
    "end": "1420120"
  },
  {
    "text": "going on um so as I've mentioned before scale is something of a pain and one of the",
    "start": "1420120",
    "end": "1425440"
  },
  {
    "text": "things we've unfortunately not been able to open source yet um is our Dynamic uh our Dynamic scaling system we're capable",
    "start": "1425440",
    "end": "1431640"
  },
  {
    "text": "of monitoring all of totem figuring out what our level of load is based on uh analytics that need to be run or what",
    "start": "1431640",
    "end": "1437840"
  },
  {
    "text": "stored current C in the queue or the number of analytics that we currently have up compared to what we could be launching at any given time um and we've",
    "start": "1437840",
    "end": "1445679"
  },
  {
    "text": "got a system right now that allows us to monitor that material and dynamically launch more nodes whenever we have a",
    "start": "1445679",
    "end": "1451120"
  },
  {
    "text": "fairly large amount of samples that need to be racked obviously this does little for us in the event that we've got a lot",
    "start": "1451120",
    "end": "1457080"
  },
  {
    "text": "we we're primarily working on samples that need to remain inous um but that's a far Edge case in our in our",
    "start": "1457080",
    "end": "1463240"
  },
  {
    "text": "environment um as I mentioned before and as should be fairly clear by now totem speed really comes from the ability to",
    "start": "1463240",
    "end": "1469000"
  },
  {
    "text": "join workers dynamically to an existing workload um so we've we've generated um",
    "start": "1469000",
    "end": "1474480"
  },
  {
    "text": "early on WE generated a large number of performance metrics and these are some of the smaller sample sets um compared",
    "start": "1474480",
    "end": "1480480"
  },
  {
    "text": "against crits now comparing things against crits might be a little unfair mostly because crits is a single node",
    "start": "1480480",
    "end": "1486120"
  },
  {
    "text": "system it's completely monolithic um so this was less a comparison of raw speed",
    "start": "1486120",
    "end": "1491200"
  },
  {
    "text": "and more a comparison of what happens when you begin trying to analyze things under load inside of it um crits number",
    "start": "1491200",
    "end": "1497520"
  },
  {
    "text": "one is obvious ly slower than totem as it stands the issues with the underlying",
    "start": "1497520",
    "end": "1502600"
  },
  {
    "text": "language and and concurrency model but the bigger thing that we found is when you begin loading crits in any",
    "start": "1502600",
    "end": "1508159"
  },
  {
    "text": "meaningful fashion any amount of load on one section of it be at the inest or be",
    "start": "1508159",
    "end": "1513480"
  },
  {
    "text": "it the database loading portions or be it the analytics themselves causes that load to be distributed against all other",
    "start": "1513480",
    "end": "1519760"
  },
  {
    "text": "portions of the system and what we found was as we tried to load more and more samples and allow them to run",
    "start": "1519760",
    "end": "1525039"
  },
  {
    "text": "concurrently we found very quickly that we saw increasing numberers of error and we highlighted that here um towards the",
    "start": "1525039",
    "end": "1531760"
  },
  {
    "text": "50,000 sample uh range which is not a large number of samples by any means we",
    "start": "1531760",
    "end": "1537159"
  },
  {
    "text": "started to see crits begin falling over and those errors there are errors that caused an unrecoverable uh state for",
    "start": "1537159",
    "end": "1543440"
  },
  {
    "text": "that particular sample forced it to be recued or meant that we weren't able to load data or or perform the finalized",
    "start": "1543440",
    "end": "1549880"
  },
  {
    "text": "analytic um whereas with totem both for three workers 100 workers um while our",
    "start": "1549880",
    "end": "1555039"
  },
  {
    "text": "speed stayed more or less stable um we never actually saw those any any individual errors um in another test",
    "start": "1555039",
    "end": "1562600"
  },
  {
    "text": "even when we would try to load the system as much as we possibly could um even the worst failure scenarios had",
    "start": "1562600",
    "end": "1568640"
  },
  {
    "text": "individual analytics possibly failing but those would simply those individual portions of a job would get recued and",
    "start": "1568640",
    "end": "1574919"
  },
  {
    "text": "reprocessed at the end so well even if you have a misbehaving job you have a overall system that behaves slower the",
    "start": "1574919",
    "end": "1581919"
  },
  {
    "text": "system will still continue behaving and it will complete anything that it's capable of completing all the way to The Bitter End",
    "start": "1581919",
    "end": "1588679"
  },
  {
    "text": "so this graph which is not terribly readable at the moment um represents uh",
    "start": "1588679",
    "end": "1594320"
  },
  {
    "text": "two uh sets of totem deployments um that are running right uh that are running in our production environment um against a",
    "start": "1594320",
    "end": "1600960"
  },
  {
    "text": "million ma samples a piece um to run 1 million ma samples against 100 totem",
    "start": "1600960",
    "end": "1606159"
  },
  {
    "text": "nodes sitting on AWS larges um which works out to being I think 400 600 uh",
    "start": "1606159",
    "end": "1614159"
  },
  {
    "text": "cores I can't remember off the top of my head um Works into just under 2 hours",
    "start": "1614159",
    "end": "1619520"
  },
  {
    "text": "and this was running for three separate analytics for every single sample um and those analytics were a call the virus",
    "start": "1619520",
    "end": "1625360"
  },
  {
    "text": "total to check to see if VT knew anything about it which was an external uh API uh call that goes over hdps um",
    "start": "1625360",
    "end": "1633000"
  },
  {
    "text": "there was uh the application of the uh Yar exchanges full Yar rule set um",
    "start": "1633000",
    "end": "1639200"
  },
  {
    "text": "against each individual sample we were generously provided the uh access to the RS sets um and then finally we did a",
    "start": "1639200",
    "end": "1645480"
  },
  {
    "text": "number of uh various hashing techniques against each binary md5 Shaws uh feature",
    "start": "1645480",
    "end": "1651279"
  },
  {
    "text": "hashing just as an example of what you can do so while it's 1 million uh individual samples we've got 3 million",
    "start": "1651279",
    "end": "1657240"
  },
  {
    "text": "overall sets of analytics that get run um and it took us just under 2 hours",
    "start": "1657240",
    "end": "1662840"
  },
  {
    "text": "more like an hour and 45 minutes or so uh to process 1 million uh samples with",
    "start": "1662840",
    "end": "1668480"
  },
  {
    "text": "100 spot instances uh on AWS um so internally uh we've been able",
    "start": "1668480",
    "end": "1674840"
  },
  {
    "text": "to implement a large array of analytic Services um we've currently got crit Services parody internal to noveta um",
    "start": "1674840",
    "end": "1681120"
  },
  {
    "text": "we've got uh clear support for third party services such as virus total or anything else you may want to do an",
    "start": "1681120",
    "end": "1686279"
  },
  {
    "text": "external Call to um and we support resource extraction for a number of different uh techniques right now for",
    "start": "1686279",
    "end": "1692279"
  },
  {
    "text": "the open source release we're releasing a handful of these at the moment we're not able to open source all of them but now that it's an open source project we",
    "start": "1692279",
    "end": "1698120"
  },
  {
    "text": "should be able to develop uh these again uh in an external environment um finally",
    "start": "1698120",
    "end": "1703720"
  },
  {
    "text": "we're looking into support fairly soon going through apachi Tika to do uh content parsing for office HTML uh",
    "start": "1703720",
    "end": "1710720"
  },
  {
    "text": "JavaScript uh files which should be a useful thing for a lot of individuals who are working with more of these",
    "start": "1710720",
    "end": "1715799"
  },
  {
    "text": "textual based documents um we've even got a handful of more experimental things that are running internally um",
    "start": "1715799",
    "end": "1722360"
  },
  {
    "text": "we've managed to integrate a handful of radar instances radar 2 if anyone's familiar with the open source",
    "start": "1722360",
    "end": "1727919"
  },
  {
    "text": "disassembler we've been able to do that and uh begin pulling down some automated disassembly obviously that's not a",
    "start": "1727919",
    "end": "1734120"
  },
  {
    "text": "perfect solution but it's something that we found to be useful and is getting to be seated in a handful of uh other",
    "start": "1734120",
    "end": "1740200"
  },
  {
    "text": "analytics that we're developing going forward so obviously that's the planning layer the organization layer and the",
    "start": "1740200",
    "end": "1747600"
  },
  {
    "text": "static layer but the last thing that we have today to talk about is the dynamic analysis layer uh drav which is going to",
    "start": "1747600",
    "end": "1754320"
  },
  {
    "text": "be presented by Tomas thanks Z so as you can see Dr sits",
    "start": "1754320",
    "end": "1760559"
  },
  {
    "text": "in the investigation layer of the scal framework and uh let's look at that more",
    "start": "1760559",
    "end": "1766080"
  },
  {
    "text": "in detail so the best way to describe PO is that it's an agentless Dynamic analysis system and by that I mean that",
    "start": "1766080",
    "end": "1772159"
  },
  {
    "text": "you don't have to install any special software within the sandbox within the virtual machine that you want to run the malware in and this is very important",
    "start": "1772159",
    "end": "1779080"
  },
  {
    "text": "because one of the first things malware do when they want to tart analysis is look at the environment they run in and",
    "start": "1779080",
    "end": "1785679"
  },
  {
    "text": "if they can find a process coexisting with the malware itself they shut down",
    "start": "1785679",
    "end": "1791440"
  },
  {
    "text": "so if you don't have anything that's fingerprintable you are much more likely to actually be able to analyze malare",
    "start": "1791440",
    "end": "1797600"
  },
  {
    "text": "successfully so it is open source it has been out since last October and it's built on the lib VMI Library which is also an open",
    "start": "1797600",
    "end": "1804000"
  },
  {
    "text": "source Library which is effectively a wrapper around the Zen virtual machine introspection subsystem so while lbmi",
    "start": "1804000",
    "end": "1810799"
  },
  {
    "text": "itself is hypervisor agnostic for now drof really relies on Zen's VMI subsystem which is very",
    "start": "1810799",
    "end": "1817519"
  },
  {
    "text": "robust the three main components that I found uh the most important about drug fof is the stealth capability that I",
    "start": "1817519",
    "end": "1823720"
  },
  {
    "text": "already mentioned um monitoring is purely performed through the hypervisor using the Intel virtualization extension",
    "start": "1823720",
    "end": "1829360"
  },
  {
    "text": "so you really don't have any special software installed within the sandbox furthermore it is very scalable so we",
    "start": "1829360",
    "end": "1834880"
  },
  {
    "text": "are using both copy on right memory and copy on right disk so we can spin Up full virtual machines in second and",
    "start": "1834880",
    "end": "1840840"
  },
  {
    "text": "furthermore only allocate resources for those virtual machines that are absolutely necessary so you can really",
    "start": "1840840",
    "end": "1845919"
  },
  {
    "text": "scale up the number of sessions running on a given Hardware uh furthermore you have full access to the virtual Hardware",
    "start": "1845919",
    "end": "1852279"
  },
  {
    "text": "of that virtual machine vcpu registers the memory or even the disk so you really have a complete View of what's",
    "start": "1852279",
    "end": "1858320"
  },
  {
    "text": "happening within that virtual machine uh with that what we have been able to do is actually monitor all",
    "start": "1858320",
    "end": "1864639"
  },
  {
    "text": "system calls that happen within that virtual machine but really we can trap whatever event we want within that",
    "start": "1864639",
    "end": "1870240"
  },
  {
    "text": "system so for example we also trap on Heap allocations within the windows kernel and we also uh trap on all the",
    "start": "1870240",
    "end": "1875679"
  },
  {
    "text": "scheduling events that happen um the only problem with that is if you really don't have any agent within that virtual",
    "start": "1875679",
    "end": "1881760"
  },
  {
    "text": "machine is how do you actually start a Mal sample right uh with cuckoo it's quite straightforward you have the cuckoo agent sitting within the virtual",
    "start": "1881760",
    "end": "1887919"
  },
  {
    "text": "a machine that will start it on your behalf well we don't have an agent we don't want to have some server running",
    "start": "1887919",
    "end": "1893360"
  },
  {
    "text": "in it because then it that server itself could be act as a you know red flag for",
    "start": "1893360",
    "end": "1898559"
  },
  {
    "text": "malare to look for so instead what we developed is a way to hijack any existing process within that virtual",
    "start": "1898559",
    "end": "1904720"
  },
  {
    "text": "machine to start the Mal sample on our behalf so let's look at that actually uh",
    "start": "1904720",
    "end": "1910559"
  },
  {
    "text": "in a demo with that's probably going to be easier to follow so here I have uh Zen 4.4 running a Windows 7 virtual",
    "start": "1910559",
    "end": "1916559"
  },
  {
    "text": "machine and what I'm going to show you is that how to actually hijack that process the",
    "start": "1916559",
    "end": "1921799"
  },
  {
    "text": "task manager that's running within that VM to start arbitrary execution so again you have full access to that virtual",
    "start": "1921799",
    "end": "1927760"
  },
  {
    "text": "machine so you can actually reconstruct what's happened inside so I just listed all the processes that are within that",
    "start": "1927760",
    "end": "1933639"
  },
  {
    "text": "machine using standard memory forensic techniques so this is the same techniques that volatility would use",
    "start": "1933639",
    "end": "1938960"
  },
  {
    "text": "here we are just running it on a live virtual machine so the way we're going",
    "start": "1938960",
    "end": "1944080"
  },
  {
    "text": "to hijack that process is by trapping on the events when that process gets uh",
    "start": "1944080",
    "end": "1949360"
  },
  {
    "text": "returned from uh kernel mode to user mode to actually start calculator on our behalf so as you can see from an",
    "start": "1949360",
    "end": "1955320"
  },
  {
    "text": "external perspective using the hypervisor I was able to inject a brand new process into that virtual machine",
    "start": "1955320",
    "end": "1960880"
  },
  {
    "text": "without having anything but standard processes running in that machine so again I don't rely on task manager it",
    "start": "1960880",
    "end": "1968039"
  },
  {
    "text": "could have been any other process like Internet Explorer and with that what we effectively have is an external shell to",
    "start": "1968039",
    "end": "1973600"
  },
  {
    "text": "that virtual machine where we can actually pass arbitrary commands it's like having a terminal to that machine",
    "start": "1973600",
    "end": "1979120"
  },
  {
    "text": "so I just pass the command to Startup Internet Explorer and send it to a website uh as you can see it's quite",
    "start": "1979120",
    "end": "1985360"
  },
  {
    "text": "fast um and it also tells you a lot of information about the process that actually got injected so you get the P",
    "start": "1985360",
    "end": "1990559"
  },
  {
    "text": "ID the thread ID and all the information that will identify this new process that got injected and you can really chain",
    "start": "1990559",
    "end": "1997600"
  },
  {
    "text": "together as many commands as you want so instead of just typing in stuff I just going to copy paste it here CU it's a",
    "start": "1997600",
    "end": "2003840"
  },
  {
    "text": "long one so what I going to do here is actually startup command. exe to download a process monitor from CIS internals",
    "start": "2003840",
    "end": "2010600"
  },
  {
    "text": "unzip it and start it up automatically and it will uh hopefully",
    "start": "2010600",
    "end": "2018638"
  },
  {
    "text": "[Music] work there we go command injected zip is",
    "start": "2018850",
    "end": "2024679"
  },
  {
    "text": "downloading extracted and it's running so with that you really have a very effective external shell to the machine",
    "start": "2024679",
    "end": "2031760"
  },
  {
    "text": "the only thing we don't inject right now is keyboard and mouse events but that can also be done",
    "start": "2031760",
    "end": "2037880"
  },
  {
    "text": "so once you actually injected the malare sample the other thing you want to do is actually start monitoring so this is still Zen",
    "start": "2037880",
    "end": "2043799"
  },
  {
    "text": "4.4 and the way we actually achieve monitoring of this machine is that we are going to be injecting break points",
    "start": "2043799",
    "end": "2050158"
  },
  {
    "text": "into the kernel and by breakpoint I mean the standard break points that you would use when you are debugging a software",
    "start": "2050159",
    "end": "2056079"
  },
  {
    "text": "except we configured Zen to actually trap all those break points into uh the hypervisor so the Intel extensions are",
    "start": "2056079",
    "end": "2062079"
  },
  {
    "text": "configured that the break points will trap into the hypervisor so we can actually monitor the full execution of",
    "start": "2062079",
    "end": "2068079"
  },
  {
    "text": "of the windows kernel so still I have uh you know Standard Process list things I",
    "start": "2068079",
    "end": "2073200"
  },
  {
    "text": "also going to show the kernel modules listed so you really have a complete view of what's what's happening within",
    "start": "2073200",
    "end": "2078520"
  },
  {
    "text": "the machine and what's what's there so yeah this is the windows kernel those are all the kernel modules loaded and",
    "start": "2078520",
    "end": "2085040"
  },
  {
    "text": "what I'm going to do is actually I'm going to start up a screen session because the output is going to be very verbose and it's not going to be able to",
    "start": "2085040",
    "end": "2091599"
  },
  {
    "text": "uh you're not going to be able to actually read it so I'm going to be gripping through that output later so now what you actually see here is all",
    "start": "2091599",
    "end": "2097520"
  },
  {
    "text": "those break points have been injected into the windows kernel and this is the live execution of Windows um running on",
    "start": "2097520",
    "end": "2104520"
  },
  {
    "text": "the right and once I start moving the mouse around you see things speeding up quite considerably but I mean it's not",
    "start": "2104520",
    "end": "2110960"
  },
  {
    "text": "designed for humans to really understand what's happening in there it's like watching The Matrix uh so what we are",
    "start": "2110960",
    "end": "2117200"
  },
  {
    "text": "going to do is actually uh grab through that output for some more meaningful things to look for uh first I just going",
    "start": "2117200",
    "end": "2124119"
  },
  {
    "text": "to grab for the instruction pointer these are going to be the actual function that are getting called within the windows kernel where our breake",
    "start": "2124119",
    "end": "2130240"
  },
  {
    "text": "points are injected and this is how we actually are able to monitor system calls so we are not actually trapping on",
    "start": "2130240",
    "end": "2135280"
  },
  {
    "text": "the system call instruction we are trapping on the functions that get called when a system call is issued so",
    "start": "2135280",
    "end": "2140880"
  },
  {
    "text": "these are all the system calls that Windows uh is executing right now but the other thing that I'm also trapping",
    "start": "2140880",
    "end": "2146480"
  },
  {
    "text": "on is Heap allocations and Heap allocations are very useful features because that really allows you to reconstruct a lot of things about what's",
    "start": "2146480",
    "end": "2153280"
  },
  {
    "text": "happening within the machine so for example as you can see a lot of things happening even if the machine is Idle",
    "start": "2153280",
    "end": "2160240"
  },
  {
    "text": "once I start moving the mouse around you will see a lot of IO allocations maybe you can read it maybe you can't but",
    "start": "2160240",
    "end": "2165599"
  },
  {
    "text": "there is these are just the coordinate structures that hold where the mouse is moving but some of the other things that",
    "start": "2165599",
    "end": "2171599"
  },
  {
    "text": "are very useful from the kernel he that you can look for is file objects for example you want to see what files are",
    "start": "2171599",
    "end": "2177359"
  },
  {
    "text": "being accessed within the machine and you can do that by watching for file object all locations so I just right",
    "start": "2177359",
    "end": "2184160"
  },
  {
    "text": "clicked on uh some personalization thing on the Windows desktop and these are all the files that are actually getting",
    "start": "2184160",
    "end": "2189800"
  },
  {
    "text": "accessed by windows and I get this list just purely looking at the memory and the execution of the machine so I don't",
    "start": "2189800",
    "end": "2196280"
  },
  {
    "text": "have anything watching the file system access itself this is Windows trying to allocate the structures before it",
    "start": "2196280",
    "end": "2202319"
  },
  {
    "text": "actually accesses those files from the file system there's a lot of things getting access just for a simple thing",
    "start": "2202319",
    "end": "2207359"
  },
  {
    "text": "like this so this is quite amazing and as you can imagine this is very useful when you're analyzing malare when you",
    "start": "2207359",
    "end": "2212760"
  },
  {
    "text": "want to identify what files have been touched what is uh you know with the malware doing because you actually see",
    "start": "2212760",
    "end": "2218200"
  },
  {
    "text": "all the files that have been uh opened and this is not something Mal can really uh mess with this is really the internal",
    "start": "2218200",
    "end": "2225119"
  },
  {
    "text": "Windows kernel trying to open files so unless the malare is implementing its own file system access mechanism and its",
    "start": "2225119",
    "end": "2231880"
  },
  {
    "text": "own Heap allocation mechanism effectively loading another operating system within the operating system you",
    "start": "2231880",
    "end": "2237440"
  },
  {
    "text": "can really trust this so I just created a text file on the desktop and as you can see it shows up in the log as well",
    "start": "2237440",
    "end": "2242760"
  },
  {
    "text": "so this is really really a nice tool to have another really awesome thing about",
    "start": "2242760",
    "end": "2248640"
  },
  {
    "text": "Dro it's really cloud ready so everything that is required to run Dro has been in Zen since Zen 4.3 which has",
    "start": "2248640",
    "end": "2256000"
  },
  {
    "text": "been released about two years ago for Zen 4.6 I've revered the entire VMI",
    "start": "2256000",
    "end": "2261720"
  },
  {
    "text": "subsystem of Zen so in Zen 4.6 it has been uh optimized and uh a bunch of",
    "start": "2261720",
    "end": "2268599"
  },
  {
    "text": "really cool uh stuff have mer merged in 200 Z 4.6 the first rc is going to be cut in two weeks and Zam 4.6 is going to",
    "start": "2268599",
    "end": "2274960"
  },
  {
    "text": "be released later this year the only thing that's stopping us from running drop moof in the cloud like on Amazon is",
    "start": "2274960",
    "end": "2282079"
  },
  {
    "text": "the fact that most of the cloud providers don't enable this thing called Zen security modules which is really",
    "start": "2282079",
    "end": "2287440"
  },
  {
    "text": "what would enable us to run this system securely on on a cloud deployment where there might be other users on the system",
    "start": "2287440",
    "end": "2294040"
  },
  {
    "text": "so xsm theen security modules would enable us to segregate these systems from each other and unfortunately most C",
    "start": "2294040",
    "end": "2300319"
  },
  {
    "text": "providers don't enable that either though it has been in Zen for years now another really cool thing about uh Zen",
    "start": "2300319",
    "end": "2307760"
  },
  {
    "text": "is that it's running on arm software on arm chipsets so you can actually analyze",
    "start": "2307760",
    "end": "2312920"
  },
  {
    "text": "mobile malware like Android malware so I actually implemented for Zen 4.6 uh a basic uh tracing capability for Zen",
    "start": "2312920",
    "end": "2319920"
  },
  {
    "text": "using the arm two-stage paging mechanism so you can actually monitor memory accesses that are happening on arm chips",
    "start": "2319920",
    "end": "2325839"
  },
  {
    "text": "so you're actually going to be able to analyze mobile malware with this system as well but it's still a work in",
    "start": "2325839",
    "end": "2332119"
  },
  {
    "text": "progress and current status of drug proof is actually that it's still not complete so",
    "start": "2332119",
    "end": "2338800"
  },
  {
    "text": "it's not a dropin replacement for cuckoo you can just use this and forget about it but we are very much hoping to get",
    "start": "2338800",
    "end": "2345520"
  },
  {
    "text": "this up to that stage so right now this is really just an academic prototype that I created for my PhD thesis to show",
    "start": "2345520",
    "end": "2351440"
  },
  {
    "text": "that this is actually possible to do and as you can see it's quite stable uh but it definitely needs Community",
    "start": "2351440",
    "end": "2356599"
  },
  {
    "text": "involvement so it is open source so if you like it please use it submit patches submit bug reports um and there are many",
    "start": "2356599",
    "end": "2364480"
  },
  {
    "text": "new things coming uh that will be very very nice to have for drug proof so for example Intel is uh releasing a new",
    "start": "2364480",
    "end": "2371680"
  },
  {
    "text": "chipset that will have this thing called the Intel virtualization exceptions which will be very useful to have for",
    "start": "2371680",
    "end": "2377400"
  },
  {
    "text": "drug proof as well I actually had a chance to work with the Intel developers to create the first open source",
    "start": "2377400",
    "end": "2382560"
  },
  {
    "text": "implementation for this for Zen which will be available in Zen 4.6 as well so Zen on arm is also the one that I'm very",
    "start": "2382560",
    "end": "2389359"
  },
  {
    "text": "excited about and we also want to look at KVM so setting up Zen is a sharp learning curve so I'm aware that a lot",
    "start": "2389359",
    "end": "2396200"
  },
  {
    "text": "of people would just want to use it on KVM and it would be a lot simpler so we definitely want to get this or a similar",
    "start": "2396200",
    "end": "2402280"
  },
  {
    "text": "subsystem to KVM as well so we could actually run Dr roof with",
    "start": "2402280",
    "end": "2407359"
  },
  {
    "text": "KVM so let's look at the big picture again so this has been all the investigation layer and our future work",
    "start": "2407359",
    "end": "2412920"
  },
  {
    "text": "is really the interrogation what to do with the data we have so we really",
    "start": "2412920",
    "end": "2417960"
  },
  {
    "text": "generate a ton of data so some of the output from drug fof is hundreds of megabytes of logs what do you do with",
    "start": "2417960",
    "end": "2424079"
  },
  {
    "text": "that data I mean analyzing just the binary itself is not going to get you much as George said binaries themselves",
    "start": "2424079",
    "end": "2430520"
  },
  {
    "text": "are too cheap we should not focus on just the binaries themselves we really want to answer the 5 ws and the best way",
    "start": "2430520",
    "end": "2438359"
  },
  {
    "text": "to do that is to create context So based on this data we have very verbos data",
    "start": "2438359",
    "end": "2443680"
  },
  {
    "text": "what we're hoping to do is use big data analytics tools to mine that data to",
    "start": "2443680",
    "end": "2448920"
  },
  {
    "text": "determine how malare actually relates identify families relationships U",
    "start": "2448920",
    "end": "2454160"
  },
  {
    "text": "campaign actors who is behind the m and identify the INF structure it's a lot more effective way to shut down malware",
    "start": "2454160",
    "end": "2460640"
  },
  {
    "text": "if you shut down the infrastructure instead of trying to clean up all the binaries that are out",
    "start": "2460640",
    "end": "2466319"
  },
  {
    "text": "there and also making this data available to as many use cases as",
    "start": "2466680",
    "end": "2472160"
  },
  {
    "text": "possible so uh we definitely need to have a gooey for humans when they want to look at this data like for example",
    "start": "2472160",
    "end": "2478040"
  },
  {
    "text": "the drug proof output is pretty much unusable as a human it's way too verbose and you can't really get much out of it",
    "start": "2478040",
    "end": "2484480"
  },
  {
    "text": "so it has to be structured as well for humans as as well as for machine learning algorithms and this is",
    "start": "2484480",
    "end": "2489599"
  },
  {
    "text": "something that we want to do as we go forward uh also retaining historical data sets so we want to keep as much",
    "start": "2489599",
    "end": "2495839"
  },
  {
    "text": "data as possible but as we go forward that data is going to be become massive",
    "start": "2495839",
    "end": "2501520"
  },
  {
    "text": "and it has to remain searchable and that is going to be a challenge with that I'm very happy to",
    "start": "2501520",
    "end": "2507720"
  },
  {
    "text": "announce the open source release of totem so this is a brand new system released by Nova so this is what Zack",
    "start": "2507720",
    "end": "2513640"
  },
  {
    "text": "wrote and this is what drug roof integrates with so the three components of totem that are up on GitHub are the",
    "start": "2513640",
    "end": "2520119"
  },
  {
    "text": "service analytics component the HTTP file server and the transfer framework for the static analysis part and as I",
    "start": "2520119",
    "end": "2526400"
  },
  {
    "text": "said drug proof has been open source and it will remain open source and we are hoping to go forward and develop both of",
    "start": "2526400",
    "end": "2531640"
  },
  {
    "text": "these system uh systems and what we're releasing today is the lock parser that will integrate drug poof into the totem",
    "start": "2531640",
    "end": "2539720"
  },
  {
    "text": "framework uh we also have a booth so uh me and Zach work for no so please find us we are at boot 1064 uh we have a",
    "start": "2539720",
    "end": "2546559"
  },
  {
    "text": "bunch of other things that we would love to talk to you about so please uh come and find us and just to recap what we",
    "start": "2546559",
    "end": "2552240"
  },
  {
    "text": "have showed you here is we created a blueprint to create large scale malary",
    "start": "2552240",
    "end": "2557359"
  },
  {
    "text": "analysis Frameworks uh systems using the scal framework and we uh created two",
    "start": "2557359",
    "end": "2562559"
  },
  {
    "text": "systems the static analysis component with totem that can analyze hundreds of thousands of samples in minutes as well",
    "start": "2562559",
    "end": "2569000"
  },
  {
    "text": "as the droof system which is a staly hypervisor based Dynamic analysis systems so both of these systems are",
    "start": "2569000",
    "end": "2574720"
  },
  {
    "text": "open source the links are up there uh please go and grab them they are actually both on GitHub and with that I thank you for",
    "start": "2574720",
    "end": "2581880"
  },
  {
    "text": "coming and uh we will take any questions you have so there are micrones in each lane so if you have any",
    "start": "2581880",
    "end": "2587640"
  },
  {
    "text": "questions should thank",
    "start": "2587640",
    "end": "2591880"
  },
  {
    "text": "you so can you uh can you ask on the microphone sorry",
    "start": "2600800",
    "end": "2607440"
  },
  {
    "text": "can you break can you break on um ntdll or just",
    "start": "2612800",
    "end": "2618359"
  },
  {
    "text": "npos konel uh sorry can you repeat that I can barely hear you your break points",
    "start": "2618359",
    "end": "2623599"
  },
  {
    "text": "can you put them in uh user space as well yes yes so for now drug is uh monitoring the kernel but you can really",
    "start": "2623599",
    "end": "2630119"
  },
  {
    "text": "inject break points anywhere in physical memory which could correspond to user space applications as well the only",
    "start": "2630119",
    "end": "2635880"
  },
  {
    "text": "thing you need for that is break points um uh locations for the break points to be placed so if you don't have the debug",
    "start": "2635880",
    "end": "2642400"
  },
  {
    "text": "information for the process you not necessarily going to know where to place those break points that will be meaningful but for example if you know",
    "start": "2642400",
    "end": "2649119"
  },
  {
    "text": "that a process loads libraries that you have debug information for you can definitely monitor those usages for the",
    "start": "2649119",
    "end": "2656319"
  },
  {
    "text": "user space process as well so for now I'm not doing that but it is definitely possible yeah and you use the uh split",
    "start": "2656319",
    "end": "2664160"
  },
  {
    "text": "page technique so the reads are different than the the in the execution yeah so essentially the break points are",
    "start": "2664160",
    "end": "2670400"
  },
  {
    "text": "protected with EP permissions so if anyone within the virtu machine tries to read from those memory locations to",
    "start": "2670400",
    "end": "2676079"
  },
  {
    "text": "determine if there are break points um I actually trap those excesses to the hypervisor and I can just remove the",
    "start": "2676079",
    "end": "2681599"
  },
  {
    "text": "breakpoint and tell whatever processes running within the machine that oh there is nothing there and this was one of the",
    "start": "2681599",
    "end": "2687040"
  },
  {
    "text": "very first things that we had to do because Windows actually blue screens when you just inject break points into",
    "start": "2687040",
    "end": "2693000"
  },
  {
    "text": "it so so that was one one of the very first things we had to do to to actually just not crash the system so it's",
    "start": "2693000",
    "end": "2699559"
  },
  {
    "text": "actually the break points are invisible so you can scan the physical memory from within the machine but you will not find",
    "start": "2699559",
    "end": "2704920"
  },
  {
    "text": "anything thanks yep no",
    "start": "2704920",
    "end": "2709000"
  },
  {
    "text": "problem is on uh two questions real quick are you handling 64-bit malware on",
    "start": "2713160",
    "end": "2719960"
  },
  {
    "text": "64-bit os's yeah so right now Dr supports both 32bit and 64-bit Windows um the user",
    "start": "2719960",
    "end": "2727240"
  },
  {
    "text": "space component is doesn't really matter CU I'm really trapping the kernel itself so but yeah I can do it for both uh 32",
    "start": "2727240",
    "end": "2735280"
  },
  {
    "text": "and 64 bit so and when you do your Dynamic testing how long is your test run for uh it depends uh for my test",
    "start": "2735280",
    "end": "2743240"
  },
  {
    "text": "that I did uh I usually run malare for 1 minute but it's an arbitrary number so",
    "start": "2743240",
    "end": "2748920"
  },
  {
    "text": "you really have no idea how long you have to run malare for so I'm not doing any timing manipulation here to like you",
    "start": "2748920",
    "end": "2754920"
  },
  {
    "text": "know try to uh skip sleeping Mal or anything like that so this is just you",
    "start": "2754920",
    "end": "2760119"
  },
  {
    "text": "know if you want to run it for a year um you can I run it for 60 seconds if I see something interesting but it's it's an",
    "start": "2760119",
    "end": "2766640"
  },
  {
    "text": "arbitrary number um there is no solution for really determining how long you need to run malare before you actually",
    "start": "2766640",
    "end": "2773040"
  },
  {
    "text": "observe anything malicious um that's that's an open research",
    "start": "2773040",
    "end": "2778440"
  },
  {
    "text": "problem well thank you thank you again for coming",
    "start": "2780040",
    "end": "2785640"
  },
  {
    "text": "a",
    "start": "2787079",
    "end": "2790079"
  }
]