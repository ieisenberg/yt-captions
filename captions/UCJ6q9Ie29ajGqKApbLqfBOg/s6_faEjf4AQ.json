[
  {
    "start": "0",
    "end": "23000"
  },
  {
    "text": "hey guys how's everybody doing good well",
    "start": "0",
    "end": "5100"
  },
  {
    "text": "I just got four fidgets spinners all at the same time and now I'm comparing him",
    "start": "5100",
    "end": "10260"
  },
  {
    "text": "I don't know does anybody have this one check this out it's like mystical it's totally amazing",
    "start": "10260",
    "end": "17220"
  },
  {
    "text": "all right sorry this is not fidget spinner reviews this is exploit kick cornucopia although it may change into",
    "start": "17220",
    "end": "24539"
  },
  {
    "start": "23000",
    "end": "60000"
  },
  {
    "text": "it all right so my name is Brad Anton oh it's I work for Cisco umbrella and I do",
    "start": "24539",
    "end": "30750"
  },
  {
    "text": "security research there we do you know our goal at Cisco umbrella and our group",
    "start": "30750",
    "end": "35850"
  },
  {
    "text": "is to find stuff to block and so that's kind of what we're gonna be talking about today hi guys I'm a Brad's coffee",
    "start": "35850",
    "end": "44340"
  },
  {
    "text": "trainer or a coffee fetcher and Frankie now I'm Matt Foley I'm an intern at",
    "start": "44340",
    "end": "49530"
  },
  {
    "text": "Cisco umbrella and I'm also a student at NYU stand in School of Engineering this",
    "start": "49530",
    "end": "55170"
  },
  {
    "text": "is basically all of Matt's work so so just keep that in mind as we go through otherwise all right so today what we're",
    "start": "55170",
    "end": "62879"
  },
  {
    "start": "60000",
    "end": "170000"
  },
  {
    "text": "gonna do like I mentioned in our group we do a lot of research and we spend a lot of time detecting things all over",
    "start": "62879",
    "end": "69540"
  },
  {
    "text": "the sort of the spectrum and we decided you know we sort of were doing all of",
    "start": "69540",
    "end": "75360"
  },
  {
    "text": "this exploit kit research and we found some really great ways to identify exploit kits and block them and we also",
    "start": "75360",
    "end": "82740"
  },
  {
    "text": "found all of these kind of other things that by themselves weren't amazing talks",
    "start": "82740",
    "end": "89670"
  },
  {
    "text": "all like they they were too short of items to go over in a single talk so",
    "start": "89670",
    "end": "95729"
  },
  {
    "text": "what we did was we were like you know what we're just gonna combine them and you guys are gonna get basically for",
    "start": "95729",
    "end": "101040"
  },
  {
    "text": "talks in one session so you're gonna see four different ways to detect exploit",
    "start": "101040",
    "end": "106470"
  },
  {
    "text": "kits and all types of different things that we've put together so basically this is the best bang for your buck",
    "start": "106470",
    "end": "111899"
  },
  {
    "text": "you're gonna get at blackhat so we're going to talk all about our a little bit",
    "start": "111899",
    "end": "120060"
  },
  {
    "text": "of background we're gonna start off with some background so if you don't know a ton about exploit kits will bring up to speed really quick and then we're gonna give of some detail",
    "start": "120060",
    "end": "128459"
  },
  {
    "text": "into our crawler we'll talk to you to tell about ways that you can amplify conviction so once you",
    "start": "128459",
    "end": "133920"
  },
  {
    "text": "one thing to block once you find one part of an exploit kit how you can sort of amplify that and find a lot more and",
    "start": "133920",
    "end": "141450"
  },
  {
    "text": "then we're gonna look at this kind of interesting thing that we found we found a vulnerability actually in in some of",
    "start": "141450",
    "end": "147930"
  },
  {
    "text": "this exploit kit stuff and so we'll show you that vulnerability and and talk",
    "start": "147930",
    "end": "153930"
  },
  {
    "text": "about it and then the last part is we're gonna bring it all together with talking about a way that you can look at and",
    "start": "153930",
    "end": "160320"
  },
  {
    "text": "easily obtain the malware that's often distributed via exploit kits and and",
    "start": "160320",
    "end": "167400"
  },
  {
    "text": "just general like sort of phishing campaigns alright so first and foremost",
    "start": "167400",
    "end": "172500"
  },
  {
    "start": "170000",
    "end": "229000"
  },
  {
    "text": "I want to you know talk about the background this is my favorite exploit",
    "start": "172500",
    "end": "178980"
  },
  {
    "text": "kit site ever I'm from New Jersey right outside of of New York and this is a",
    "start": "178980",
    "end": "186000"
  },
  {
    "text": "legitimate website this is NYC running mama calm the person who runs it is this",
    "start": "186000",
    "end": "191459"
  },
  {
    "text": "woman named Michelle she lives in New York it's like I feel like I could run into her on the subway at any particular",
    "start": "191459",
    "end": "198209"
  },
  {
    "text": "day or time she she loves you know she really likes to run so she goes out and",
    "start": "198209",
    "end": "204750"
  },
  {
    "text": "she does all this running she loves her kids she seems like a good mom she takes pictures posts them all up on her",
    "start": "204750",
    "end": "210810"
  },
  {
    "text": "WordPress site and kind of shows them all shows them off and people go to it like Michelle has I think like 16,000",
    "start": "210810",
    "end": "218340"
  },
  {
    "text": "followers like she's kind of a big deal I mean at least compared to me I like five right so she's she's definitely",
    "start": "218340",
    "end": "225120"
  },
  {
    "text": "some you know pretty pretty awesome the thing about Michelle is that she's not like a wordpress admin she doesn't",
    "start": "225120",
    "end": "231810"
  },
  {
    "start": "229000",
    "end": "306000"
  },
  {
    "text": "know about computers and like hacking and all that stuff she knows about running and being a good mom right and",
    "start": "231810",
    "end": "237329"
  },
  {
    "text": "so something sort of unfortunate happens when when you go to Michelle's website",
    "start": "237329",
    "end": "244049"
  },
  {
    "text": "depending on what browser you so you get two different experiences on the on the",
    "start": "244049",
    "end": "249870"
  },
  {
    "text": "left hand side when you go to Michelle's website using Chrome you render",
    "start": "249870",
    "end": "256289"
  },
  {
    "text": "everything fine but on the right hand side something different happens right there's something a little sort of",
    "start": "256289",
    "end": "261329"
  },
  {
    "text": "strange that's happening there and that's oh is that I guess left hand left",
    "start": "261329",
    "end": "266849"
  },
  {
    "text": "hand side you know what which one is wrong so the",
    "start": "266849",
    "end": "274920"
  },
  {
    "text": "wood the one that's wrong is the one that has this pop-up that happens now the the messed-up thing about this",
    "start": "274920",
    "end": "280590"
  },
  {
    "text": "pop-up is this is no JavaScript pop-up this is not just some like alert or something like that",
    "start": "280590",
    "end": "286290"
  },
  {
    "text": "this is opera this pop-up is occurring outside of the context of the browser",
    "start": "286290",
    "end": "291590"
  },
  {
    "text": "when you visit Michele's website something happens where executable is",
    "start": "291590",
    "end": "297660"
  },
  {
    "text": "running locally on your system and crashes right this is not what NYC running mama is",
    "start": "297660",
    "end": "304170"
  },
  {
    "text": "about so it's sort of strange so if you look a level deeper you see a sort of a",
    "start": "304170",
    "end": "309510"
  },
  {
    "start": "306000",
    "end": "322000"
  },
  {
    "text": "something more into that story so if you look at the Internet Explorer side you'll see that there's a couple of",
    "start": "309510",
    "end": "315360"
  },
  {
    "text": "extra added lines in there and those lines aren't also present in in chrome",
    "start": "315360",
    "end": "321930"
  },
  {
    "text": "and if you look at those specific lines they actually match a very specific and",
    "start": "321930",
    "end": "327120"
  },
  {
    "text": "distinct pattern in the exploit kick community it matches the pseudo dark",
    "start": "327120",
    "end": "332490"
  },
  {
    "text": "leach campaign using the rig exploit kit and the way that we know that is by the",
    "start": "332490",
    "end": "337980"
  },
  {
    "text": "actual sort of characters that are there the length of those either sort of six lines the there's some random characters",
    "start": "337980",
    "end": "345690"
  },
  {
    "text": "there's an iframe some more random characters that whole pattern is a way that we can identify pseudo dark leech",
    "start": "345690",
    "end": "351630"
  },
  {
    "text": "and we can also identify rig through the URI in the iframe source based on that",
    "start": "351630",
    "end": "358920"
  },
  {
    "text": "and so we can really quickly identify that and so so to help you understand a",
    "start": "358920",
    "end": "364920"
  },
  {
    "start": "362000",
    "end": "997000"
  },
  {
    "text": "Michels website is actually now participating in exploit kit she doesn't even know this is happening right but to",
    "start": "364920",
    "end": "372090"
  },
  {
    "text": "her WordPress site got compromised and now she's now serving up an exploit kit",
    "start": "372090",
    "end": "379230"
  },
  {
    "text": "so exploit kits over the years there's nothing like brand new they've sort of evolved over there some of them really",
    "start": "379230",
    "end": "384960"
  },
  {
    "text": "great I don't know if you saw the one with the gun and the weird white powder substance you log into a cellphone like",
    "start": "384960",
    "end": "390900"
  },
  {
    "text": "they're really embracing the whole criminal ecosystem at that point and so",
    "start": "390900",
    "end": "396690"
  },
  {
    "text": "so with these exploit gates what they do is they essentially are selling the ability to execute code on your",
    "start": "396690",
    "end": "405780"
  },
  {
    "text": "victim system right there are a website that when someone visits that website",
    "start": "405780",
    "end": "411540"
  },
  {
    "text": "they get they get sort of targeted with an exploit and that exploit then",
    "start": "411540",
    "end": "417270"
  },
  {
    "text": "delivers some payload that the criminal has purchased and is paying for as part",
    "start": "417270",
    "end": "423540"
  },
  {
    "text": "of this whole ecosystem and the payload is usually you know as as far as the",
    "start": "423540",
    "end": "430020"
  },
  {
    "text": "exploit goes the exploits goal is to have execute a one-liner so this is kind of what the one-liner would look like",
    "start": "430020",
    "end": "436140"
  },
  {
    "text": "what it's basically doing is it's writing out on to disk of vbscript and it's then executing that VB script",
    "start": "436140",
    "end": "443400"
  },
  {
    "text": "the VB script fetches a dll from the internet and then executes the DLL so",
    "start": "443400",
    "end": "449280"
  },
  {
    "text": "super simple but at the end of the day it's really effective because it's taking advantage of a vulnerability in",
    "start": "449280",
    "end": "455460"
  },
  {
    "text": "that browser usually this is because it's part of this whole criminal",
    "start": "455460",
    "end": "460560"
  },
  {
    "text": "ecosystem usually it's meant to distribute of like ransomware or banking",
    "start": "460560",
    "end": "467040"
  },
  {
    "text": "Trojan something like that so that a criminal could make money off of it right now",
    "start": "467040",
    "end": "472260"
  },
  {
    "text": "Michels web site in the exploit kid world is called in a compromised site right hers website got compromised and",
    "start": "472260",
    "end": "479940"
  },
  {
    "text": "now it's redirecting the compromised site acts as as a proxy between the",
    "start": "479940",
    "end": "486330"
  },
  {
    "text": "victim and this back-end exploit kit ecosystem there's a exploit server that",
    "start": "486330",
    "end": "492510"
  },
  {
    "text": "that's there and this the compromised site actually makes requests to the",
    "start": "492510",
    "end": "497550"
  },
  {
    "text": "server to pull in that iframe content now there's another way that's really",
    "start": "497550",
    "end": "502770"
  },
  {
    "text": "popular for exploit kid authors to use and that's called malvert izing that's the bottom part of the the slide here",
    "start": "502770",
    "end": "508620"
  },
  {
    "text": "this sort of second way works with ad networks so ad network subscribers",
    "start": "508620",
    "end": "514740"
  },
  {
    "text": "people who sign up to make money off of having you know selling the space of their web site will opt in to an ad",
    "start": "514740",
    "end": "522270"
  },
  {
    "text": "network and what the attackers will do the exploited kid authors will do is they'll sign up as a publisher to this",
    "start": "522270",
    "end": "528780"
  },
  {
    "text": "network and so they sign up they have another system that will be the ad",
    "start": "528780",
    "end": "535470"
  },
  {
    "text": "but is basically just the the iframe itself and whoever is a subscriber to",
    "start": "535470",
    "end": "540540"
  },
  {
    "text": "that ad network then will be publishing out this exploit kit and the same thing happens in this case the attackers",
    "start": "540540",
    "end": "546720"
  },
  {
    "text": "machine operates as that proxy between the the back-end server and the victim and they infect the victim with whatever",
    "start": "546720",
    "end": "553200"
  },
  {
    "text": "they're going to infect now there's a other sort of area about this too",
    "start": "553200",
    "end": "558840"
  },
  {
    "text": "once you get that iframe and actually sort of render it your you're also gonna",
    "start": "558840",
    "end": "565380"
  },
  {
    "text": "get an exploit but before that what needs to happen is that there's a whole",
    "start": "565380",
    "end": "571620"
  },
  {
    "text": "bunch of filtering that happens so imagine you're an exploit kit author and you're trying to you know sort of attack",
    "start": "571620",
    "end": "579180"
  },
  {
    "text": "someone but you're also trying to protect yourself against researchers and things like that well what you do is you",
    "start": "579180",
    "end": "585090"
  },
  {
    "text": "filter heavily the people who are coming to your system right you don't want to",
    "start": "585090",
    "end": "590400"
  },
  {
    "text": "send an exploit to a researcher you also don't want to send the wrong exploit to the wrong browser or version because",
    "start": "590400",
    "end": "597030"
  },
  {
    "text": "it's not gonna land it's not gonna be successful so there's a big thing that happens in all of this is that exploit",
    "start": "597030",
    "end": "604020"
  },
  {
    "text": "authors use a heavy level of filtering to figure out who they're actually going",
    "start": "604020",
    "end": "609780"
  },
  {
    "text": "to target at this stage when someone lands on one of these ads are these compromised sites they're trying to figure out who they're going to target",
    "start": "609780",
    "end": "615900"
  },
  {
    "text": "so this is Kotaro it's a TDS or a traffic distribution system and it's",
    "start": "615900",
    "end": "621420"
  },
  {
    "text": "commonly used in ad networks and advertising and what we're seeing is is",
    "start": "621420",
    "end": "627330"
  },
  {
    "text": "that some exploit authors are actually using this itself as far part of that",
    "start": "627330",
    "end": "632880"
  },
  {
    "text": "filtering function so if you start to see you'll notice that there's just a crazy level of filtering that you can do",
    "start": "632880",
    "end": "638970"
  },
  {
    "text": "with this you can pick your users based on geographic region you can base do you",
    "start": "638970",
    "end": "644640"
  },
  {
    "text": "want a mobile or non mobile device what operating system down to the version and browser down to the version you can pick",
    "start": "644640",
    "end": "651120"
  },
  {
    "text": "certain plugins and extensions you can literally drag and drop what detail you",
    "start": "651120",
    "end": "656760"
  },
  {
    "text": "want to target and when you do that you set up what's called the flow and these flows say you know this user that",
    "start": "656760",
    "end": "663930"
  },
  {
    "text": "matches this level of filtering get served up this exploit this user who who's maybe a mobile user doesn't get",
    "start": "663930",
    "end": "671910"
  },
  {
    "text": "served any exploit because we don't have a mobile exploit and so they used this really heavy level of filtering through",
    "start": "671910",
    "end": "677820"
  },
  {
    "text": "all of this and one of the things that we were able to do which was were kind of fun was we were actually able to get",
    "start": "677820",
    "end": "683340"
  },
  {
    "text": "access to the web routes of a lot of these compromised websites and we actually started to look at them and see",
    "start": "683340",
    "end": "689310"
  },
  {
    "text": "all right you know looking at these web routes what information can we get and so what you're seeing on the screen we",
    "start": "689310",
    "end": "695010"
  },
  {
    "text": "started out with using something called a hashed which is just a free known good",
    "start": "695010",
    "end": "700560"
  },
  {
    "text": "service you can give it a list of directories and it'll tell you our list of files it'll tell you which files are",
    "start": "700560",
    "end": "706950"
  },
  {
    "text": "known goods so this is a wordpress installation so i'm just gonna quickly",
    "start": "706950",
    "end": "712020"
  },
  {
    "text": "remove out all of the known good wordpress sites and i'm left with a core",
    "start": "712020",
    "end": "717180"
  },
  {
    "text": "file as part of wordpress which is the nav menu dot PHP now sudo Darkly is also",
    "start": "717180",
    "end": "724440"
  },
  {
    "text": "notorious for using this nav menu dot PHP file to store their back-end code",
    "start": "724440",
    "end": "731690"
  },
  {
    "text": "okay so what they do is they compromised the website they manually modify nav",
    "start": "731690",
    "end": "736830"
  },
  {
    "text": "menu PHP to include their code this code is the code that fetches that iframe",
    "start": "736830",
    "end": "742620"
  },
  {
    "text": "information and renders it in the compromised website but it does a bunch of other things so it's kind of",
    "start": "742620",
    "end": "748230"
  },
  {
    "text": "interesting to see so first they don't serve the iframe to every single page",
    "start": "748230",
    "end": "753990"
  },
  {
    "text": "they read they don't want to embed the iframe into images right they don't want to embed the iframe into into just any",
    "start": "753990",
    "end": "761790"
  },
  {
    "text": "page that that gets rendered they picked only the specific ones the other thing is is that built into this injected code",
    "start": "761790",
    "end": "768480"
  },
  {
    "text": "is filters for Google's IP addresses so they're actually put in place whitelist",
    "start": "768480",
    "end": "775800"
  },
  {
    "text": "so that if it's if it's a Google certain google search engine like crawlers IP",
    "start": "775800",
    "end": "782280"
  },
  {
    "text": "addresses they'll won't serve the exploit khador won't fetch that out and they then they also the other weird",
    "start": "782280",
    "end": "789870"
  },
  {
    "text": "thing about this I don't know if you guys has noticed this but there's comments in this code which is kind of",
    "start": "789870",
    "end": "795060"
  },
  {
    "text": "weird right because you think like you know commented code suggests like you know something under",
    "start": "795060",
    "end": "802740"
  },
  {
    "text": "development right this is this code is found on a compromised site so that means that maybe they're either",
    "start": "802740",
    "end": "808830"
  },
  {
    "text": "deploying this commented out code to all of their systems or they're manually going into this compromised website and",
    "start": "808830",
    "end": "815250"
  },
  {
    "text": "testing it live in production testing this backdoored codes which is kind of",
    "start": "815250",
    "end": "820260"
  },
  {
    "text": "interesting so the other thing that they do is you'll see in in that and we'll",
    "start": "820260",
    "end": "825690"
  },
  {
    "text": "dive into that in a little bit is that there also have a string a base64",
    "start": "825690",
    "end": "831180"
  },
  {
    "text": "encoded string that is actually what that call is to the rig server and we'll",
    "start": "831180",
    "end": "836340"
  },
  {
    "text": "look at that in just a minute alright so the the other part now is actually getting the exploit so they put",
    "start": "836340",
    "end": "843480"
  },
  {
    "text": "first they get the iframe content and now when you render that iframe the victim renders that iframe now they need",
    "start": "843480",
    "end": "849810"
  },
  {
    "text": "to actually be hit with they exploit so this is sort of hard for us to see because this is happening you know on",
    "start": "849810",
    "end": "857250"
  },
  {
    "text": "systems that we don't control and we don't have good visibility into but from what we can tell it looks like there's",
    "start": "857250",
    "end": "864240"
  },
  {
    "text": "another system called a VDS or a virtual dedicated server that actually holds the exploits and that that domain that",
    "start": "864240",
    "end": "873120"
  },
  {
    "text": "actually include that that was in the iframe fetches back to from this virtual",
    "start": "873120",
    "end": "879510"
  },
  {
    "text": "dedicated server to pull the exploit and then render it when you actually get the",
    "start": "879510",
    "end": "885390"
  },
  {
    "text": "exploit the exploit is is a really an exploit bundle you get three different heavily obfuscated exploits it loads off",
    "start": "885390",
    "end": "892560"
  },
  {
    "text": "all three of them at least for this this particular case it'll launch all three exploits against your browser in your",
    "start": "892560",
    "end": "898350"
  },
  {
    "text": "plugins and the exploits themselves aren't anything amazing so you know a",
    "start": "898350",
    "end": "903870"
  },
  {
    "text": "few years back angler exploit kit was the most popular those guys really innovative well they were doing lots of",
    "start": "903870",
    "end": "910530"
  },
  {
    "text": "really cool interesting things ever since then we haven't seen a lot of really strong innovation and the exploit",
    "start": "910530",
    "end": "916620"
  },
  {
    "text": "kits what they do and one of my innovation what I mean is is writing their own exploits or coming up with you",
    "start": "916620",
    "end": "924090"
  },
  {
    "text": "know unpublished exploits or anything like that so what they do is they're using old you know security researcher",
    "start": "924090",
    "end": "931020"
  },
  {
    "text": "finds an exploit they write up a proof of except publish it to a blog and then within a week an exploited author takes",
    "start": "931020",
    "end": "937889"
  },
  {
    "text": "that sort of weaponize it and loads it into exploit kit and and serves whoever there's thereby the funny thing is is",
    "start": "937889",
    "end": "944999"
  },
  {
    "text": "that you can sort of see some of the lack of innovation in a way by the way that they're dealing with these exploits",
    "start": "944999",
    "end": "950429"
  },
  {
    "text": "so sometimes when they have a browser that they can't actually exploit they'll do sort of lame things in the exploit",
    "start": "950429",
    "end": "957809"
  },
  {
    "text": "world right they show these sort of fake font pop-ups which which try to convince",
    "start": "957809",
    "end": "964529"
  },
  {
    "text": "you to click a link and download something like to me this is super lame like these guys are exploited authors",
    "start": "964529",
    "end": "971459"
  },
  {
    "text": "right like they should be dealing with memory corruption vulnerabilities right bypassing exploit mitigations doing some",
    "start": "971459",
    "end": "977399"
  },
  {
    "text": "hardcore stuff and the resulting to this fake font download this is this just to",
    "start": "977399",
    "end": "982529"
  },
  {
    "text": "me like is an uppercut mortal combat finisher like they're really not doing amazing so there's obviously a ton of",
    "start": "982529",
    "end": "990480"
  },
  {
    "text": "stuff going on in with exploit kits but the weird thing about all of this there's so much activity happening with exploit kits that I thought it was weird",
    "start": "990480",
    "end": "998519"
  },
  {
    "start": "997000",
    "end": "1083000"
  },
  {
    "text": "that there wasn't like a website to track all of these so what I did was I reached out to some of the popular",
    "start": "998519",
    "end": "1004549"
  },
  {
    "text": "exploit kit researchers and talked to them a bit and asked them if they would contribute and built a website called ek",
    "start": "1004549",
    "end": "1011119"
  },
  {
    "text": "tracker com and so now you all can go to ek tracker comm and for free have a list",
    "start": "1011119",
    "end": "1017480"
  },
  {
    "text": "of brand new exploit kits that are detected you know minute by minute by exploit kit",
    "start": "1017480",
    "end": "1023239"
  },
  {
    "text": "researchers the other cool thing about that is now we have a public data set of exploit kit stuff that we can play with",
    "start": "1023239",
    "end": "1030529"
  },
  {
    "text": "and look at so this is a visualization I did with the data off of exploit ek tracker comm and we did a really simple",
    "start": "1030529",
    "end": "1037490"
  },
  {
    "text": "visualization we looked at the relationships for IPS to asns so which",
    "start": "1037490",
    "end": "1045168"
  },
  {
    "text": "you know from all of these different IPS that were known exploit kits you know what a SNS do they map to and you can",
    "start": "1045169",
    "end": "1051919"
  },
  {
    "text": "see one really I mean look at that that's a crazy mapping all those IPS to just that single ASN so that was really",
    "start": "1051919",
    "end": "1058490"
  },
  {
    "text": "sort of an interesting piece of information and we did the same thing two domains and registrants so we were able to see you know how many domains",
    "start": "1058490",
    "end": "1065629"
  },
  {
    "text": "and were there offending registrants and you can see at the center there we have a single registrant associated with a whole huge",
    "start": "1065629",
    "end": "1072370"
  },
  {
    "text": "cluster of different domains that are associated so that's a really good use case for ek tracker just getting it all",
    "start": "1072370",
    "end": "1078280"
  },
  {
    "text": "out there so I hopefully you guys will use it and and find value in it alright",
    "start": "1078280",
    "end": "1084100"
  },
  {
    "start": "1083000",
    "end": "1113000"
  },
  {
    "text": "your mat your it alright so how do we detect exploit kits the first method",
    "start": "1084100",
    "end": "1090760"
  },
  {
    "text": "will look at is probably the most common approach and it's the approach that we took first and that's to build a scraper",
    "start": "1090760",
    "end": "1096910"
  },
  {
    "text": "we focused on identifying the exploit Kate Landers because we already had a good corpus of known compromise sites",
    "start": "1096910",
    "end": "1103710"
  },
  {
    "text": "sort of compiled and we actually had two versions of our scraper and with those two separate proxy networks so we'll",
    "start": "1103710",
    "end": "1110200"
  },
  {
    "text": "break each of those down individually so the first version of our scraper was",
    "start": "1110200",
    "end": "1116710"
  },
  {
    "start": "1113000",
    "end": "1135000"
  },
  {
    "text": "built using VirtualBox and vagrant was used for sort of starting and stopping",
    "start": "1116710",
    "end": "1122590"
  },
  {
    "text": "the virtual machines as well as snapshot management the host OS was also responsible for hosting the multi",
    "start": "1122590",
    "end": "1129130"
  },
  {
    "text": "processing queue that the workers fed from so here's just a brief look at one",
    "start": "1129130",
    "end": "1137410"
  },
  {
    "text": "of the worker processes so you'll notice that we're making two requests for a",
    "start": "1137410",
    "end": "1143620"
  },
  {
    "text": "compromise site one with Internet Explorer through selenium and one with Python request and this lets us take a",
    "start": "1143620",
    "end": "1150490"
  },
  {
    "text": "diff of the rendered Dom versus the page source that was given to us so this",
    "start": "1150490",
    "end": "1156880"
  },
  {
    "text": "allows us to identify any iframes and beds params or other includes that occurred post JavaScript execution and",
    "start": "1156880",
    "end": "1167040"
  },
  {
    "start": "1166000",
    "end": "1237000"
  },
  {
    "text": "this diff gives us a candidate list but we still need to weed out some false positives so we run it through a couple",
    "start": "1167040",
    "end": "1172930"
  },
  {
    "text": "of filters we're really lucky in the sense that we have access to a popularity score in our product so it",
    "start": "1172930",
    "end": "1179920"
  },
  {
    "text": "works pretty similar to Google's popular PageRank algorithm another one of the interesting things that we can look at",
    "start": "1179920",
    "end": "1185830"
  },
  {
    "text": "for filtering is the DNS query volume that these domains receive so for",
    "start": "1185830",
    "end": "1191170"
  },
  {
    "text": "something like google.com you'll see a huge amount of volume over a large period of time and it's very periodic in",
    "start": "1191170",
    "end": "1197830"
  },
  {
    "text": "its graph with some like an exploit Kate Lander you'll see a dramatic spike preceded typically by",
    "start": "1197830",
    "end": "1204720"
  },
  {
    "text": "either 0 or no queries before it so",
    "start": "1204720",
    "end": "1210390"
  },
  {
    "text": "that's how the first version of the scraper worked but we're still missing a key detail which is how we actually got",
    "start": "1210390",
    "end": "1216420"
  },
  {
    "text": "around the IP filtering that they do typically they have some filter in place to make sure that you're coming from a",
    "start": "1216420",
    "end": "1223230"
  },
  {
    "text": "non corporate IP or to make sure they haven't served you and exploit within",
    "start": "1223230",
    "end": "1229380"
  },
  {
    "text": "the last 24 hours and to do this we build out a proxy network the first first version of the",
    "start": "1229380",
    "end": "1235080"
  },
  {
    "text": "proxy network looked a little something like this yeah there you go we just",
    "start": "1235080",
    "end": "1240480"
  },
  {
    "start": "1237000",
    "end": "1252000"
  },
  {
    "text": "scraped a bunch of public proxy lists and this actually worked surprisingly well for a couple months at least until",
    "start": "1240480",
    "end": "1248040"
  },
  {
    "text": "every single one of the proxy lists that we were using got blacklisted so we",
    "start": "1248040",
    "end": "1253260"
  },
  {
    "start": "1252000",
    "end": "1299000"
  },
  {
    "text": "started working on version to you and by this point the most advanced exploit kit angler had shut down and the ones that",
    "start": "1253260",
    "end": "1260700"
  },
  {
    "text": "had taken his place really weren't doing the same level of browser scrutinize ation that angler had been doing so this",
    "start": "1260700",
    "end": "1267059"
  },
  {
    "text": "allowed us to make a much lighter version of our scraper so we didn't have to use virtual machines anymore and no pie shark for saving the samples and no",
    "start": "1267059",
    "end": "1274350"
  },
  {
    "text": "dipping so now we just have a browser component made entirely using Python",
    "start": "1274350",
    "end": "1280160"
  },
  {
    "text": "requests and we fetch the page passed the response to a detector which just",
    "start": "1280160",
    "end": "1285809"
  },
  {
    "text": "does some very basic signature matching over the response to identify any exploit Landers and take a guess at its",
    "start": "1285809",
    "end": "1292230"
  },
  {
    "text": "campaign and then these Lander candidates are then queried and passed to a decoder module so the decoder",
    "start": "1292230",
    "end": "1300720"
  },
  {
    "start": "1299000",
    "end": "1322000"
  },
  {
    "text": "module just takes the response from these exploit gate Landers and does its best to sort of it runs it through a",
    "start": "1300720",
    "end": "1307170"
  },
  {
    "text": "JavaScript parser first and then does its best to take a guess that the exploit kit that it's looking at and from there it'll try to extract any for",
    "start": "1307170",
    "end": "1317880"
  },
  {
    "text": "example flash exploits executables or anything any other artifacts the second",
    "start": "1317880",
    "end": "1323640"
  },
  {
    "start": "1322000",
    "end": "1348000"
  },
  {
    "text": "version of approximate work we actually built out ourselves we hosted it across a bunch of hourly",
    "start": "1323640",
    "end": "1329309"
  },
  {
    "text": "VPS providers using squid proxy and this gives us a lot of flexibility",
    "start": "1329309",
    "end": "1334590"
  },
  {
    "text": "in the choice of region for our exit IP so if certain exploits exploit kits are",
    "start": "1334590",
    "end": "1340440"
  },
  {
    "text": "only targeting certain regions we can choose to be coming from there and it also gives us rotating IPS every hour or",
    "start": "1340440",
    "end": "1345870"
  },
  {
    "text": "two hours and so naturally the question becomes well what do you scrape so some",
    "start": "1345870",
    "end": "1353039"
  },
  {
    "start": "1348000",
    "end": "1403000"
  },
  {
    "text": "great resources are on the left hand side those are just researcher blogs and",
    "start": "1353039",
    "end": "1358500"
  },
  {
    "text": "ek tracker calm Twitter is also a great resource for intelligence sharing so for",
    "start": "1358500",
    "end": "1364770"
  },
  {
    "text": "example if you were to sit on the rig EK hashtag there's just a ton of",
    "start": "1364770",
    "end": "1369809"
  },
  {
    "text": "information that you can that you can harvest from there from other researchers public open source",
    "start": "1369809",
    "end": "1374820"
  },
  {
    "text": "intelligence and the last idea actually comes from a Twitter researcher now SEC",
    "start": "1374820",
    "end": "1380659"
  },
  {
    "text": "typically when we think of the Alexa one-million we think of the these sites as sort of reputable or sites that we",
    "start": "1380659",
    "end": "1388049"
  },
  {
    "text": "can trust but he actually found that a lot of a lot of the sites in the Alexa one-million are compromised and we're",
    "start": "1388049",
    "end": "1395490"
  },
  {
    "text": "serving exploit gates at one point so the Alexa one-million or we also have the Cisco umbrella one-million alright",
    "start": "1395490",
    "end": "1404340"
  },
  {
    "start": "1403000",
    "end": "1453000"
  },
  {
    "text": "great so we now have a bunch of exploit lenders but Brad and I wanted to do more",
    "start": "1404340",
    "end": "1409470"
  },
  {
    "text": "with this we wanted to amplify the convictions that we were getting with our scrapers so we built out this system called hitless to do that and so when a",
    "start": "1409470",
    "end": "1419070"
  },
  {
    "text": "customer using our product visits a site that's blocked instead of returning the",
    "start": "1419070",
    "end": "1424140"
  },
  {
    "text": "IP for that site we actually return the IP for one of our blocked page Landers and so every time someone hits one of",
    "start": "1424140",
    "end": "1434370"
  },
  {
    "text": "the block page lenders we tried to store the session information in our logs and that way when someone visits one of the",
    "start": "1434370",
    "end": "1441809"
  },
  {
    "text": "exploit lenders that we've identified we're able to look at the refer information which could potentially be a",
    "start": "1441809",
    "end": "1449610"
  },
  {
    "text": "compromised site all right so the block",
    "start": "1449610",
    "end": "1455279"
  },
  {
    "start": "1453000",
    "end": "1509000"
  },
  {
    "text": "page logs are started in in s3 buckets and currently we have hit list running",
    "start": "1455279",
    "end": "1460440"
  },
  {
    "text": "using a custom stream processing framework that we've created called avalanche but we also feel that",
    "start": "1460440",
    "end": "1466260"
  },
  {
    "text": "could be the perfect use case for a serverless architect architecture so something like AWS is lando lambda so we",
    "start": "1466260",
    "end": "1474600"
  },
  {
    "text": "could push the results from the scraper into another s3 bucket and feed these along with the block page logs into a",
    "start": "1474600",
    "end": "1481230"
  },
  {
    "text": "lambda function to produce compromise sight candidates these lambda the lambda",
    "start": "1481230",
    "end": "1486750"
  },
  {
    "text": "function could be something super simple and we could just check to see if the host is in our ek Lander list this",
    "start": "1486750",
    "end": "1495420"
  },
  {
    "text": "creates this really nice ecosystem where hit-list finds new compromise sites and the scraper can confirm the hitless",
    "start": "1495420",
    "end": "1503130"
  },
  {
    "text": "detections as well as provide new exploit Landers for hit list to work",
    "start": "1503130",
    "end": "1508140"
  },
  {
    "text": "with and so it's 2017 we have to justify our work through data visualization so",
    "start": "1508140",
    "end": "1515280"
  },
  {
    "start": "1509000",
    "end": "1578000"
  },
  {
    "text": "we built this graph over the first less than a month of of hit list data so you",
    "start": "1515280",
    "end": "1522360"
  },
  {
    "text": "can really see the amplification that we that we get in this graph the you'll see",
    "start": "1522360",
    "end": "1528090"
  },
  {
    "text": "a bunch of clusters and at the center of these clusters are the exploit Kate Landers and all of the nodes connecting",
    "start": "1528090",
    "end": "1533460"
  },
  {
    "text": "to the to the center are other or are compromised sites that hit list found so",
    "start": "1533460",
    "end": "1539760"
  },
  {
    "text": "in some cases you'll even see like there are 20-plus compromised sites connecting to a single exploit Kate Lander and",
    "start": "1539760",
    "end": "1546950"
  },
  {
    "text": "these exploit kick campaigns are operating at a scale of thousands or",
    "start": "1546950",
    "end": "1552270"
  },
  {
    "text": "tens of thousands of compromised sites as you can see just from how large the graph is over just one month of data all",
    "start": "1552270",
    "end": "1561270"
  },
  {
    "text": "right cool back in tagged okay so so the next",
    "start": "1561270",
    "end": "1569940"
  },
  {
    "text": "sister the next sort of thing that we wanted to talk about was something that's kind of interesting it's it's the",
    "start": "1569940",
    "end": "1575160"
  },
  {
    "text": "actual back door or the actual code that they inject so again back on Michelle's",
    "start": "1575160",
    "end": "1580710"
  },
  {
    "start": "1578000",
    "end": "1776000"
  },
  {
    "text": "website when we were looking at that nav menu dot PHP there was that code that's",
    "start": "1580710",
    "end": "1585840"
  },
  {
    "text": "that's there and in that code it did fetch the exploit kit that iframe and",
    "start": "1585840",
    "end": "1592020"
  },
  {
    "text": "render it to the victim but it actually did a little bit of other things as well so what's kind of interesting about it",
    "start": "1592020",
    "end": "1599670"
  },
  {
    "text": "is if you start to think about you know Matt just said that there's you know potentially tens of thousands of domains",
    "start": "1599670",
    "end": "1605340"
  },
  {
    "text": "that these campaigns are managing like when you start to think about how they have to deal with that they're facing",
    "start": "1605340",
    "end": "1611070"
  },
  {
    "text": "like an orchestration problem right like they have so many compromised sites that it's actually they have to figure out",
    "start": "1611070",
    "end": "1617400"
  },
  {
    "text": "how to orchestrate all these at once and so what they do is they actually have a back door in place they actually have a",
    "start": "1617400",
    "end": "1623880"
  },
  {
    "text": "piece of code in that snip that I showed you up front that allows them to access",
    "start": "1623880",
    "end": "1629460"
  },
  {
    "text": "these compromised sites using a specific method so this is a pretty well-known",
    "start": "1629460",
    "end": "1634799"
  },
  {
    "text": "though the back door itself is pretty well known it uses a peer aggregate",
    "start": "1634799",
    "end": "1641190"
  },
  {
    "text": "replace function this is a function that's available within PHP and all it",
    "start": "1641190",
    "end": "1647490"
  },
  {
    "text": "is is a simple sort of line substitution so you give it a string you determine you have a reg X and it'll find that",
    "start": "1647490",
    "end": "1654390"
  },
  {
    "text": "string and replace it with something else but because we're talking about PHP and PHP is I don't know bonkers",
    "start": "1654390",
    "end": "1662039"
  },
  {
    "text": "sometimes they also have this great thing that you could add on to your to",
    "start": "1662039",
    "end": "1669090"
  },
  {
    "text": "to your reg X and it's of trailing E and what that trailing II does means is that",
    "start": "1669090",
    "end": "1674549"
  },
  {
    "text": "it will treat the resulting string after that match as and pass it through eval",
    "start": "1674549",
    "end": "1682940"
  },
  {
    "text": "so if you pass it PHP code it will execute that PHP code if you repeated a",
    "start": "1682940",
    "end": "1690390"
  },
  {
    "text": "string of PHP code it will execute that string as it wore PHP so this is a",
    "start": "1690390",
    "end": "1695520"
  },
  {
    "text": "really common backdoor that people use in sort of the PHP world and they",
    "start": "1695520",
    "end": "1700710"
  },
  {
    "text": "usually do it by by setting cookies so normally you set 3 cookies and what",
    "start": "1700710",
    "end": "1708960"
  },
  {
    "text": "they'll do is they'll embed this this backdoor somewhere in the site and then if you have the right cookie set up to",
    "start": "1708960",
    "end": "1716760"
  },
  {
    "text": "sort of recreate this p reg replace backdoor you'll be able to get code",
    "start": "1716760",
    "end": "1722130"
  },
  {
    "text": "execution on that compromised site if you have the right cookie setup now the one of the critical flaws that the",
    "start": "1722130",
    "end": "1728549"
  },
  {
    "text": "pseudo dark leach campaign made when they're doing this is that they didn't use cookies they used post data",
    "start": "1728549",
    "end": "1736580"
  },
  {
    "text": "so that might not be obvious why that's a problem but hopefully I'll explain it in just a second",
    "start": "1736580",
    "end": "1743040"
  },
  {
    "text": "um so what they did to secure all of this is is that they actually set this",
    "start": "1743040",
    "end": "1749040"
  },
  {
    "text": "really long string it's a password you see it in the bottom highlighted in yellow and that really long string is",
    "start": "1749040",
    "end": "1755910"
  },
  {
    "text": "the security for this backdoor right anybody take a guess of what that string",
    "start": "1755910",
    "end": "1760980"
  },
  {
    "text": "is it's nothin oh I wish it is the pay",
    "start": "1760980",
    "end": "1766590"
  },
  {
    "text": "it is a password it's not the word password but I think what you're implying there is that this is a hash",
    "start": "1766590",
    "end": "1772860"
  },
  {
    "text": "and it is right it's the sure hash we don't know for sure it's a hash but it's obviously so we started to look up so",
    "start": "1772860",
    "end": "1778110"
  },
  {
    "start": "1776000",
    "end": "1912000"
  },
  {
    "text": "god what the heck is this hash like what is this thing man like what is it is it password what it'll be so I googled it",
    "start": "1778110",
    "end": "1783900"
  },
  {
    "text": "like I mean you know how else do you figure things out and so I googled it I started to see all these results for",
    "start": "1783900",
    "end": "1789750"
  },
  {
    "text": "this integer value this 102 I think it won't look like 102 one one seven got a",
    "start": "1789750",
    "end": "1794910"
  },
  {
    "text": "look at slide and I started to realize like wait wait this is this is a hash value of the string of an integer it's a",
    "start": "1794910",
    "end": "1802890"
  },
  {
    "text": "this number it's a hash number like this is weird what's going on here and so I started to look at it and confirm it and",
    "start": "1802890",
    "end": "1808800"
  },
  {
    "text": "in fact it was and so I started to look at it even more and say word what is this value and so when you start to dig",
    "start": "1808800",
    "end": "1815550"
  },
  {
    "text": "into these exploits you'll find this interesting function and oh I mentioned",
    "start": "1815550",
    "end": "1821790"
  },
  {
    "text": "that at the start that there was this long string embedded in the bat in that code of PHP now that string is base64",
    "start": "1821790",
    "end": "1830250"
  },
  {
    "text": "encoded and it's they do some other sort of like they move around the numbers of IP addresses to make it difficult I",
    "start": "1830250",
    "end": "1837120"
  },
  {
    "text": "don't know it's all you see the code so you just know how to fix it you know but",
    "start": "1837120",
    "end": "1842340"
  },
  {
    "text": "so so they do all that they change all this stuff around but when you unencrypted quotes this this base 64",
    "start": "1842340",
    "end": "1849720"
  },
  {
    "text": "encoded string what you see is that same number that same you know one whatever",
    "start": "1849720",
    "end": "1855360"
  },
  {
    "text": "it is 1 2 1 2 0 1 1 7 102 one of the two",
    "start": "1855360",
    "end": "1861000"
  },
  {
    "text": "so you see that same number pop up in that URL and so because we had access to a bunch of these differ",
    "start": "1861000",
    "end": "1866950"
  },
  {
    "text": "web roots of compromised servers we started to look at the other URLs and sure enough embedded in that decrypted",
    "start": "1866950",
    "end": "1874750"
  },
  {
    "text": "URL for all of those compromised websites they had this same sort of number that was there and what we think",
    "start": "1874750",
    "end": "1881889"
  },
  {
    "text": "it is based on just sort of understanding rig and sort of public information we think that that's the",
    "start": "1881889",
    "end": "1887620"
  },
  {
    "text": "user ID of the user subscribed to rig exploit kit so you know you purchase",
    "start": "1887620",
    "end": "1894399"
  },
  {
    "text": "subscription access to rig rig you probably gives you a user ID right and",
    "start": "1894399",
    "end": "1900340"
  },
  {
    "text": "and so that's what the that's what you you use in URL to get that iframe or get",
    "start": "1900340",
    "end": "1906610"
  },
  {
    "text": "that content back so we started to get all of these different user IDs and it turned out that these user IDs were",
    "start": "1906610",
    "end": "1916149"
  },
  {
    "start": "1912000",
    "end": "1981000"
  },
  {
    "text": "really really sort of easy to to use and to turn into full backdoor access onto",
    "start": "1916149",
    "end": "1922870"
  },
  {
    "text": "these systems once you knew the user ID you essentially knew the password just by M defying right so if you want to",
    "start": "1922870",
    "end": "1929080"
  },
  {
    "text": "access the backdoor this is your you know this is your remote command right",
    "start": "1929080",
    "end": "1934090"
  },
  {
    "text": "you just set up the variables correctly and you just sort of set one of the keys",
    "start": "1934090",
    "end": "1940600"
  },
  {
    "text": "to be this md5 value and you're good now this still requires you to know this",
    "start": "1940600",
    "end": "1948130"
  },
  {
    "text": "user ID and that kind of sucks like who's gonna know that user ID but there's something really great about",
    "start": "1948130",
    "end": "1954130"
  },
  {
    "text": "this user ID it's an integer value like it's you know what ifs eight digit",
    "start": "1954130",
    "end": "1959679"
  },
  {
    "text": "integer like come on man and there's also something else right because remember at front I said normally they",
    "start": "1959679",
    "end": "1966730"
  },
  {
    "text": "would be using these two using these in cookies right at first they would be",
    "start": "1966730",
    "end": "1971860"
  },
  {
    "text": "using these values in cookie cookie values but here they're post data values and there's one really important",
    "start": "1971860",
    "end": "1978519"
  },
  {
    "text": "attribute about post data is that you can support lots of it you can send a lot of post data to a server you want to",
    "start": "1978519",
    "end": "1985029"
  },
  {
    "start": "1981000",
    "end": "2014000"
  },
  {
    "text": "upload a file you've sent it as post data right you want to do anything else you just sort of send that post data so",
    "start": "1985029",
    "end": "1990580"
  },
  {
    "text": "hopefully you can see where I'm going with this so a lot of times these these",
    "start": "1990580",
    "end": "1996159"
  },
  {
    "text": "compromised sites they are running either nginx or Apache and default post data size is 1 Meg which is",
    "start": "1996159",
    "end": "2003910"
  },
  {
    "text": "a heck of a lot of post data if you think about it and Apache is just out of control they're just like you know",
    "start": "2003910",
    "end": "2010600"
  },
  {
    "text": "Yolo whatever you want to send which is wonderful so to actually so what you",
    "start": "2010600",
    "end": "2015970"
  },
  {
    "start": "2014000",
    "end": "2144000"
  },
  {
    "text": "could do here is you could brute force this value right like a brute force err is simple at this point all you have to",
    "start": "2015970",
    "end": "2021760"
  },
  {
    "text": "do is just you know the since we had a bunch of compromise sites we know roughly the range of integer values that",
    "start": "2021760",
    "end": "2028930"
  },
  {
    "text": "this is all gonna be and so to write a brute force she's just basically writing a for loop in Python right and you're",
    "start": "2028930",
    "end": "2035350"
  },
  {
    "text": "just m defying that value over and over again so the initial back door access would be sort of something like this",
    "start": "2035350",
    "end": "2041710"
  },
  {
    "text": "where you just send that single password as the value but once we actually want",
    "start": "2041710",
    "end": "2048700"
  },
  {
    "text": "to brute-force that we just send it a larger amount of post data and we just brute force hundreds of passwords at once and if any",
    "start": "2048700",
    "end": "2057100"
  },
  {
    "text": "one of those hundred passwords actually lands is actually correct then our code",
    "start": "2057100",
    "end": "2062408"
  },
  {
    "text": "gets executed and we could bash this into sizes that are appropriate to the the webserver so that we can prove force",
    "start": "2062409",
    "end": "2068919"
  },
  {
    "text": "it really efficiently and really quickly and so you could totally do that",
    "start": "2068919",
    "end": "2074560"
  },
  {
    "text": "and if you do that what do you get so it's kind of fun about this is that now",
    "start": "2074560",
    "end": "2080710"
  },
  {
    "text": "you have the ability to act as the proxy to these networks right so your so",
    "start": "2080710",
    "end": "2086648"
  },
  {
    "text": "normally what would happen is you'd go to Michelle's website Michelle's website would pull your user agent pull your IP",
    "start": "2086649",
    "end": "2092530"
  },
  {
    "text": "address and then pass it on to the rig back-end server which would then do a bunch of filtering to say you know this",
    "start": "2092530",
    "end": "2099190"
  },
  {
    "text": "I this IP address has hit me a bunch of times let me not serve they exploit but",
    "start": "2099190",
    "end": "2104680"
  },
  {
    "text": "here now we can spoof everything because now we're Michelle's site were that compromised website and we're",
    "start": "2104680",
    "end": "2110650"
  },
  {
    "text": "controlling what data rig sees so we can only use user agents that we know are",
    "start": "2110650",
    "end": "2116290"
  },
  {
    "text": "really good or we can test lots of different user agents we can set any IP address that we want right because it's",
    "start": "2116290",
    "end": "2122080"
  },
  {
    "text": "we're controlling it and we can just regularly setup that we're constantly requesting over and over again new gates",
    "start": "2122080",
    "end": "2129700"
  },
  {
    "text": "because these gates are revolving the road on a regular basis so now we can just",
    "start": "2129700",
    "end": "2135160"
  },
  {
    "text": "sort of use this as a proxy and just request more and more gates and find more things to you know more bad of this",
    "start": "2135160",
    "end": "2142569"
  },
  {
    "text": "networking undercover more of that infrastructure so we did we found out that the backend server that's hosting",
    "start": "2142569",
    "end": "2149560"
  },
  {
    "text": "this is almost always in our key in the cases that we saw were on Hetzler now if you've done a lot of this research has",
    "start": "2149560",
    "end": "2156550"
  },
  {
    "text": "there's a good you know generally a good service they do really really good stuff",
    "start": "2156550",
    "end": "2161770"
  },
  {
    "text": "but it seems like for whatever reason these actors love hats they're more than anything and so every case where the rig",
    "start": "2161770",
    "end": "2168339"
  },
  {
    "text": "server because we're also uncovering the rig server IP in this whole process so we actually know where that server is",
    "start": "2168339",
    "end": "2174400"
  },
  {
    "text": "that's controlled by the the not the criminal the actual attacker who's offering the exploit kit and so we know",
    "start": "2174400",
    "end": "2180250"
  },
  {
    "text": "it's almost always on Hessler so that's amazing that was a good piece of information and we were able to get a",
    "start": "2180250",
    "end": "2185710"
  },
  {
    "text": "lot more of these gates so that's sort of an interesting little fun little backdoor that that that exists in those",
    "start": "2185710",
    "end": "2191950"
  },
  {
    "text": "systems and that's still there as of you know today yeah I don't know who to report the bug - is there a responsible",
    "start": "2191950",
    "end": "2200079"
  },
  {
    "text": "disclosure I don't know okay so the other thing is we are also thinking",
    "start": "2200079",
    "end": "2205240"
  },
  {
    "text": "about ways like we're like all right we've looking at all those exploit good stuff but what's really exploit you like",
    "start": "2205240",
    "end": "2211030"
  },
  {
    "text": "what are they really doing they're sending you ransomware or they're sending you banking Trojans that sort of stuff so you know what let's try to",
    "start": "2211030",
    "end": "2219579"
  },
  {
    "text": "focus on that endgame of these exploit kits as well and try to understand these samples and pull them together so we're",
    "start": "2219579",
    "end": "2225130"
  },
  {
    "text": "thinking about it we're like are well how are we gonna get lots and lots of samples and we were like well one of the",
    "start": "2225130",
    "end": "2230200"
  },
  {
    "text": "things that we could do is we can set up sort of email honey pots so we started to go down this route I'm sure many of",
    "start": "2230200",
    "end": "2236079"
  },
  {
    "start": "2231000",
    "end": "2280000"
  },
  {
    "text": "you have gone down this route before you want to sign up you know you maybe register a gmail account and sign up for",
    "start": "2236079",
    "end": "2241930"
  },
  {
    "text": "lots of crap but it turns out like Gmail is a good service so they are looking at",
    "start": "2241930",
    "end": "2248319"
  },
  {
    "text": "your attachments they're looking at looking for phishing campaigns and they're actively blocking them or",
    "start": "2248319",
    "end": "2253690"
  },
  {
    "text": "publishing to your spam folder and we don't want that we want the crap right like we want the bad stuff in them today so I started to think about it like I oh",
    "start": "2253690",
    "end": "2260200"
  },
  {
    "text": "I could set up my own mail server but that sinus sucks like I don't want to set up my own mail server like I mean",
    "start": "2260200",
    "end": "2265300"
  },
  {
    "text": "it's not hard but it's just like I don't I don't feel like it's gonna last forever it's not great and",
    "start": "2265300",
    "end": "2270430"
  },
  {
    "text": "then I still have to sign up for all this crap like I got to go and sign up for all this you know threat reports and",
    "start": "2270430",
    "end": "2276069"
  },
  {
    "text": "you know all the other stuff that gets you the nasty nasty information and so what I started thinking is like well",
    "start": "2276069",
    "end": "2281529"
  },
  {
    "start": "2280000",
    "end": "2315000"
  },
  {
    "text": "wait a second I always use when I want to sign up for nasty stuff what I use is a disposable mailbox I go to mail at",
    "start": "2281529",
    "end": "2287469"
  },
  {
    "text": "malonate err calm and when I want to you know sign up for some that's probably suspicious and may result in compromised",
    "start": "2287469",
    "end": "2294339"
  },
  {
    "text": "I'll just use mail inators the disposable mailbox a single one use mailbox the the trick about it is is",
    "start": "2294339",
    "end": "2300369"
  },
  {
    "text": "that anybody could read your mail but who cares because it's just this one used mailbox and so so I was like all",
    "start": "2300369",
    "end": "2307119"
  },
  {
    "text": "right well let me see what if I used melon ater for my as my email honeypot right will",
    "start": "2307119",
    "end": "2314440"
  },
  {
    "text": "it work so I tried it out I was a girl right cool let's build a quick system we sort of prototype to quick system we",
    "start": "2314440",
    "end": "2320349"
  },
  {
    "start": "2315000",
    "end": "2376000"
  },
  {
    "text": "called it mail runner it basically pulls data from mail inator feeds it into thread grid or Cisco we get the record",
    "start": "2320349",
    "end": "2326799"
  },
  {
    "text": "for free and we pass it through a classification engine for stuff and if I",
    "start": "2326799",
    "end": "2333130"
  },
  {
    "text": "mean if you think about it if an email it has an attachment and that attachment is reaching out to the Internet that's",
    "start": "2333130",
    "end": "2338349"
  },
  {
    "text": "probably bad like most likely bad so we do some basic filtering on the results of the threat results and sure enough we",
    "start": "2338349",
    "end": "2345160"
  },
  {
    "text": "were happy to see that we actually found stuff there was actually one day around",
    "start": "2345160",
    "end": "2350979"
  },
  {
    "text": "this time last year were one third of all of the email that we saw in these mailboxes was actually lucky it was",
    "start": "2350979",
    "end": "2360039"
  },
  {
    "text": "crazy we found odin we found all this other stuff so we were like great this is awesome we're finding like good now",
    "start": "2360039",
    "end": "2366069"
  },
  {
    "text": "is like a source of it but the problem is we're using mail inator and mail inator cost money like and that's like a",
    "start": "2366069",
    "end": "2371949"
  },
  {
    "text": "you know like we've actually paid for the API you know just make it life easier so we said you know what forget",
    "start": "2371949",
    "end": "2377619"
  },
  {
    "start": "2376000",
    "end": "2437000"
  },
  {
    "text": "it man I'm just gonna roll my own so we created laced mail comm and the whole",
    "start": "2377619",
    "end": "2383229"
  },
  {
    "text": "purpose of this is for you guys to do the same thing so I'm basically don't",
    "start": "2383229",
    "end": "2388749"
  },
  {
    "text": "want to sign up for things so I'm hoping you guys will so sign up for anything anything that hits this server goes here",
    "start": "2388749",
    "end": "2395680"
  },
  {
    "text": "and it can be queried via an API so you can download all the samples you want from it just via the API super-easy and",
    "start": "2395680",
    "end": "2404760"
  },
  {
    "text": "and you you know if you set up your MX record 2.2 lace male comm it will take",
    "start": "2404760",
    "end": "2410290"
  },
  {
    "text": "the message what was really fun was some spammer I think was looking for open",
    "start": "2410290",
    "end": "2415630"
  },
  {
    "text": "relays SMB SMTP open relays and they came across this and they started to use",
    "start": "2415630",
    "end": "2421600"
  },
  {
    "text": "it to send out their spam but we're not sending email we're just taking email so we actually got their entire spam list",
    "start": "2421600",
    "end": "2428140"
  },
  {
    "text": "it was crazy they set all of their different emails that they sent out it was wonderful so I encourage you guys to use laced mail comm you know totally",
    "start": "2428140",
    "end": "2434710"
  },
  {
    "text": "free it's for us you know to do this kind of stuff alright so we only have a",
    "start": "2434710",
    "end": "2439780"
  },
  {
    "start": "2437000",
    "end": "2453000"
  },
  {
    "text": "couple minutes left but there was a couple of other things about exploit kits that has been like just sort of",
    "start": "2439780",
    "end": "2445720"
  },
  {
    "text": "like lingering in the back of my mind two really quick things and I thought why not let me tell you guys about them",
    "start": "2445720",
    "end": "2452110"
  },
  {
    "text": "so let's do it so the first thing is this I've spent a lot of time looking at",
    "start": "2452110",
    "end": "2457930"
  },
  {
    "start": "2453000",
    "end": "2570000"
  },
  {
    "text": "the exploits that are delivered by exploit kits right I used to care about",
    "start": "2457930",
    "end": "2463330"
  },
  {
    "text": "this stuff a lot they're heavily obvious gated so anybody who's done this is appreciated this quite a bit but I spent",
    "start": "2463330",
    "end": "2469000"
  },
  {
    "text": "time div skating all of this JavaScript and looking at it and actually reconstructing the entire exploits that",
    "start": "2469000",
    "end": "2476020"
  },
  {
    "text": "they're using because I want to look at how they're you know what is their rap chain look like what does you know how",
    "start": "2476020",
    "end": "2481480"
  },
  {
    "text": "are they arranging the heap when they're actually exploiting the browser what are they doing and so one really interesting",
    "start": "2481480",
    "end": "2487690"
  },
  {
    "text": "thing that I found was this this is the magic address so if you know",
    "start": "2487690",
    "end": "2492910"
  },
  {
    "text": "about exploitation you know in some cases if you can do a heap spray or some sort of spray of data there's a magic",
    "start": "2492910",
    "end": "2499570"
  },
  {
    "text": "address that once you spray enough data you can know that reliably whatever",
    "start": "2499570",
    "end": "2505450"
  },
  {
    "text": "object that you're trying to place in memory it will be at this address in memory somewhere right so it's called",
    "start": "2505450",
    "end": "2511480"
  },
  {
    "text": "the magic address it's just like people like run in a hundred times and then whatever address always has it they use it so there are published magic",
    "start": "2511480",
    "end": "2518530"
  },
  {
    "text": "addresses like everybody knows people who write exploits know what these addresses are there's articles talks they outline it usually everybody uses",
    "start": "2518530",
    "end": "2526600"
  },
  {
    "text": "the same magic address well the one thing that I noticed that was sort of weird was that there was",
    "start": "2526600",
    "end": "2533590"
  },
  {
    "text": "one or two exploits that used this magic address I've never seen this magic",
    "start": "2533590",
    "end": "2538870"
  },
  {
    "text": "address used ever before and any exploit that I've ever seen maybe you have but I have not so I started to think like this",
    "start": "2538870",
    "end": "2545770"
  },
  {
    "text": "could be a really you know this could be sort of an interesting way to track different actors right because I can",
    "start": "2545770",
    "end": "2552820"
  },
  {
    "text": "know pretty reliably that probably the person who wrote the first exploit is maybe this person who wrote the second",
    "start": "2552820",
    "end": "2558340"
  },
  {
    "text": "one and more at least know each other because this is a very unique value that no one else has picked so one little",
    "start": "2558340",
    "end": "2564370"
  },
  {
    "text": "piece of tidbit information so if you ever decide to look into this note the magic address and see if maybe you can",
    "start": "2564370",
    "end": "2570070"
  },
  {
    "start": "2570000",
    "end": "2632000"
  },
  {
    "text": "tackle it and the last piece is this piece so after you do one of these big",
    "start": "2570070",
    "end": "2576580"
  },
  {
    "text": "sprays and you overwrite a lot of times what you're trying to do is overwrite an array object in memory and when you",
    "start": "2576580",
    "end": "2583480"
  },
  {
    "text": "overload it is that the array objects",
    "start": "2583480",
    "end": "2593200"
  },
  {
    "text": "length field is different and then what you said so you overwrite the length field and then you find it somewhere in",
    "start": "2593200",
    "end": "2598570"
  },
  {
    "text": "memory so once you find the array object you sort of know it's you know you sort",
    "start": "2598570",
    "end": "2604780"
  },
  {
    "text": "of know that you found the right one because it's the only one with a different length field right for",
    "start": "2604780",
    "end": "2610270"
  },
  {
    "text": "whatever reason this author decided to include this additional check within",
    "start": "2610270",
    "end": "2615640"
  },
  {
    "text": "their exploits where they actually write decode the hex of decode into memory and",
    "start": "2615640",
    "end": "2622870"
  },
  {
    "text": "then read it back to confirm that they're at the right array object it's totally unnecessary but for some reason",
    "start": "2622870",
    "end": "2629260"
  },
  {
    "text": "these guys decided to do it so another interesting tidbit to follow up all right so just to recap wait I'm on the",
    "start": "2629260",
    "end": "2636910"
  },
  {
    "start": "2632000",
    "end": "2708000"
  },
  {
    "text": "right side see Homer alright good so just as a quick final recap I hope you guys enjoyed all of Matt's work he is an",
    "start": "2636910",
    "end": "2644920"
  },
  {
    "text": "intern and hopefully will work for us one day you can a couple of things one I",
    "start": "2644920",
    "end": "2652330"
  },
  {
    "text": "we encourage you guys to roll your own scraper a proxy totally doable there's lots of good way easy ways to do it learn from our experiences and hopefully",
    "start": "2652330",
    "end": "2659440"
  },
  {
    "text": "you'll be able to do some good stuff if you are finding bad exploit kit stuff make sure you think about how to amplify",
    "start": "2659440",
    "end": "2666220"
  },
  {
    "text": "that how do you pivot off of a piece of information and use it to find more information because these exploit kits are really",
    "start": "2666220",
    "end": "2673030"
  },
  {
    "text": "integrated that's a network right there's a whole network that's associated with this thing and if you find one piece you can find a lot more",
    "start": "2673030",
    "end": "2679180"
  },
  {
    "text": "so make sure you think about that when you're dealing with your exploit stuff and doing your research bad guys make",
    "start": "2679180",
    "end": "2685180"
  },
  {
    "text": "mistakes too maybe you could benefit off of that so I'm saying and the last thing",
    "start": "2685180",
    "end": "2691600"
  },
  {
    "text": "is is disposable mailboxes can actually be used for research and they could be a good nice fun way to find new samples",
    "start": "2691600",
    "end": "2699040"
  },
  {
    "text": "all right that's everything if you have any questions please go up to the mics [Applause]",
    "start": "2699040",
    "end": "2710280"
  }
]