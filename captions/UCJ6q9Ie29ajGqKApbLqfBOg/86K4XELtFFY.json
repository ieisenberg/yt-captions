[
  {
    "text": "conference and produced by the sound of knowledge [Music]",
    "start": "160",
    "end": "21390"
  },
  {
    "text": "Incorporated thanks for staying here um one one last thing um we we originally",
    "start": "23039",
    "end": "28160"
  },
  {
    "text": "thought that uh we were done with the with the authentication thing um I have to make additions to that asked how we",
    "start": "28160",
    "end": "35079"
  },
  {
    "text": "would find out um the IP address of the management module that we're going to impersonate um first of all um the thing",
    "start": "35079",
    "end": "42640"
  },
  {
    "text": "that we describe here is just what we do um even if we don't send IP addresses um",
    "start": "42640",
    "end": "48440"
  },
  {
    "text": "we will be sent IP addresses so the module will send us its IP addresses so",
    "start": "48440",
    "end": "53600"
  },
  {
    "text": "we know in which networks it is in and um well the probability that it's managed from one of these networks is",
    "start": "53600",
    "end": "60440"
  },
  {
    "text": "quite high and what we normally do is we just scan we scan for the Management console we just send different IP",
    "start": "60440",
    "end": "66439"
  },
  {
    "text": "addresses on each um try and it will refuse to authenticate if it doesn't know us if it doesn't know our IP",
    "start": "66439",
    "end": "72840"
  },
  {
    "text": "address and it will say no I don't know you um go away so in this way we can actually scan for the IP address of the",
    "start": "72840",
    "end": "79880"
  },
  {
    "text": "management module the other thing is that with checkpoint F1 4.1 you don't need anymore um an encryption license to",
    "start": "79880",
    "end": "88680"
  },
  {
    "text": "use fw1 and fw1 is the standard so sky and fwn N1 it's almost a bit um obsolete",
    "start": "88680",
    "end": "96680"
  },
  {
    "text": "if you have version 4.1 of fir War 1 so this is default fw1 but still fwa 1 as",
    "start": "96680",
    "end": "102399"
  },
  {
    "text": "we have seen is significantly broken and what we have tried in the past is um",
    "start": "102399",
    "end": "107479"
  },
  {
    "text": "just to send um without knowing the encryption key just to send zero bytes and hope that it gets decrypted to",
    "start": "107479",
    "end": "113320"
  },
  {
    "text": "something sensible because the encryption key is U well hopefully it's um distributed um I don't know the",
    "start": "113320",
    "end": "121119"
  },
  {
    "text": "English word for that anyway but um each key is normally it's hopefully um as likely as each other key so it's evenly",
    "start": "121119",
    "end": "128080"
  },
  {
    "text": "distributed that's what I was looking for and um we just HED that we that um",
    "start": "128080",
    "end": "133440"
  },
  {
    "text": "we would hit a key that would decrypt zerob bytes into something sensible we had it run one night but it it didn't",
    "start": "133440",
    "end": "139840"
  },
  {
    "text": "turn out to to work so you still have a very very slight chance of succeeding but actually what you have to transmit",
    "start": "139840",
    "end": "146120"
  },
  {
    "text": "is um at least seven bytes I think and uh well getting those seven bytes",
    "start": "146120",
    "end": "151280"
  },
  {
    "text": "decrypted to the to the right thing is is pretty unlikely so but back to the inter module protocol thing um we said",
    "start": "151280",
    "end": "159239"
  },
  {
    "text": "before that um IP addresses um that you transmit your own IP addresses in this",
    "start": "159239",
    "end": "165519"
  },
  {
    "text": "protocol so um this opens a pretty obvious thing that we didn't talk about",
    "start": "165519",
    "end": "171400"
  },
  {
    "text": "at all because you can switch authentication off for certain IP addresses so many people do so by editing the control. map file and",
    "start": "171400",
    "end": "178480"
  },
  {
    "text": "switching encrypt uh switching authentication off for 12701 because they assume that these",
    "start": "178480",
    "end": "185000"
  },
  {
    "text": "connections can only come from Local Host but like we said before hey it's not that um the IP Source address that",
    "start": "185000",
    "end": "191239"
  },
  {
    "text": "counts it's the IP addresses that we send so if anybody switches off authentication for",
    "start": "191239",
    "end": "197000"
  },
  {
    "text": "1271 then we just send 1271 and we can get into the whole thing without authentication and this is one last",
    "start": "197000",
    "end": "203159"
  },
  {
    "text": "thing that I want to show with the inter module authentication it's actually the switching off is actually recommended um",
    "start": "203159",
    "end": "209560"
  },
  {
    "text": "by website and um yeah because you you you",
    "start": "209560",
    "end": "214680"
  },
  {
    "text": "you lose you lose a lot of trouble you get around a lot of trouble doing that you don't have to configure keys and stuff and everything and um well it's",
    "start": "214680",
    "end": "222239"
  },
  {
    "text": "not recommended by checkpoint just let me that make clear let let me make that clear just recommended by by by another",
    "start": "222239",
    "end": "227840"
  },
  {
    "text": "website um I will to tell",
    "start": "227840",
    "end": "233879"
  },
  {
    "text": "you just do a just do a do a search on the search engine for that that is the line here",
    "start": "235400",
    "end": "240680"
  },
  {
    "text": "this is the line that I've inserted um they are those those rules are are",
    "start": "240680",
    "end": "245760"
  },
  {
    "text": "parsed on a first match basis so they go from here to there and then finally this one will say srisk SL none for",
    "start": "245760",
    "end": "253760"
  },
  {
    "text": "12701 for nothing for no command authentication is necessary and of course we have a tool for that that",
    "start": "253760",
    "end": "259320"
  },
  {
    "text": "doesn't authenticate at all um we can run this attack so if I'm",
    "start": "259320",
    "end": "265160"
  },
  {
    "text": "not mistaken we should be able to do it right now it's back there so just a",
    "start": "265160",
    "end": "270800"
  },
  {
    "text": "second I have to put that microphone",
    "start": "270800",
    "end": "274400"
  },
  {
    "text": "away okay again we are attacking the firewall here so let me just restart the",
    "start": "280000",
    "end": "286280"
  },
  {
    "text": "I to make sure that this has really been honored the changes that I've made FW stop semicolon FW",
    "start": "286280",
    "end": "296400"
  },
  {
    "text": "start stop it start it",
    "start": "296400",
    "end": "301520"
  },
  {
    "text": "okay and let's see whether the security it's the correct security policy that we have",
    "start": "301520",
    "end": "307960"
  },
  {
    "text": "loaded okay it comes up again okay we can't ping it as you see",
    "start": "311639",
    "end": "318360"
  },
  {
    "text": "over there so now we use our fw1 none authentication",
    "start": "318360",
    "end": "326080"
  },
  {
    "text": "tool as you see it takes just the um firewalls address which is 194",
    "start": "327720",
    "end": "333800"
  },
  {
    "text": "2216 159 this is the IP 440 and we say we are coming from 001 we don't even",
    "start": "333800",
    "end": "340919"
  },
  {
    "text": "have to do IP spoofing or whatever just go like that it authenticates authentication method none as you see up",
    "start": "340919",
    "end": "348360"
  },
  {
    "text": "here authentication method none we don't even have to authenticate we say we are 12701 we just send the unload command",
    "start": "348360",
    "end": "356120"
  },
  {
    "text": "again and as you will see we will be able to Ping the firewall again or do worst things locally exploit everything",
    "start": "356120",
    "end": "361280"
  },
  {
    "text": "and own the complete firewall so that's like that there you",
    "start": "361280",
    "end": "366319"
  },
  {
    "text": "go so never never ever do that so this was a little addendum and",
    "start": "366319",
    "end": "373080"
  },
  {
    "text": "now we can really go on to um the firewall filtering mechanism so I",
    "start": "373080",
    "end": "380680"
  },
  {
    "text": "will just be giving a short overview of the filtering mechanism and then my colleagues will take over and I will be",
    "start": "380680",
    "end": "386199"
  },
  {
    "text": "done um I just give you a short overview and then we will have quite a lot of demonstrations that will you show in",
    "start": "386199",
    "end": "392599"
  },
  {
    "text": "that will show to you in which way we can um subvert the filtering mechanism itself so this is what fir1 works",
    "start": "392599",
    "end": "401080"
  },
  {
    "text": "like there's a packet in the in the in the uppermost Corner in the left hand corner um the first thing a fir War One",
    "start": "401080",
    "end": "408000"
  },
  {
    "text": "does is it checks whether the packet is a fragment that has has either a non-zero offset or there more fragments",
    "start": "408000",
    "end": "413919"
  },
  {
    "text": "flag set in the in the first fragment and it creates a chain of fragments this is called virtual defragmentation so it",
    "start": "413919",
    "end": "420080"
  },
  {
    "text": "makes sure that um uh the Integrity of the fragments um that the fragments have",
    "start": "420080",
    "end": "425280"
  },
  {
    "text": "have integrity and um that they don't overlap and stuff like that they have integrity checking and after that um if",
    "start": "425280",
    "end": "431759"
  },
  {
    "text": "all fragments are collected it is passed into the inspection engine the inspection engine does the following it",
    "start": "431759",
    "end": "438080"
  },
  {
    "text": "has a pre-inspection part the pre-inspection part is in the loadable kernel module it's native code it does",
    "start": "438080",
    "end": "444120"
  },
  {
    "text": "the following um it looks at the fragments and then looks at a database",
    "start": "444120",
    "end": "449280"
  },
  {
    "text": "at a a table it's a connections table and if this um if this the whole packet",
    "start": "449280",
    "end": "455520"
  },
  {
    "text": "belongs to a connection that is already in the connections table well at the beginning it's empty but later there will be connections added to the",
    "start": "455520",
    "end": "461560"
  },
  {
    "text": "connections table how this works we will see down here but let's assume there's an existing TCP connection and um if the",
    "start": "461560",
    "end": "469479"
  },
  {
    "text": "packet belongs to existing to an existing connection then the pre-inspect pre-inspection part will see that it's",
    "start": "469479",
    "end": "476120"
  },
  {
    "text": "in the connection table and will accept the packet the pre-inspection part apart from that um make sure that because fire",
    "start": "476120",
    "end": "483039"
  },
  {
    "text": "one basically looks at the first fragment of this chain of fragments it only looks at the first fragment because that's where the interesting information",
    "start": "483039",
    "end": "489120"
  },
  {
    "text": "is like the the IP header the TCP header and the UDP header and icmp header and it makes sure for example that the whole",
    "start": "489120",
    "end": "495080"
  },
  {
    "text": "header is contained in the first fragment so that we can't play those those um old fragmentation tricks like",
    "start": "495080",
    "end": "500520"
  },
  {
    "text": "frag fragmenting the TCP header and stuff um so this is all done in pre-inspection if pre-inspection does",
    "start": "500520",
    "end": "506639"
  },
  {
    "text": "not accept the packet then the whole pack or the chain of fragments here is passed to the veral machine and the",
    "start": "506639",
    "end": "513839"
  },
  {
    "text": "veral Machine executes the inspect code that has been generated from the rule base so you have a rule base um from the",
    "start": "513839",
    "end": "520360"
  },
  {
    "text": "rule base inspect code is generated inspect code is compiled it's it's a risk- likee assembly uh um it's a risk-",
    "start": "520360",
    "end": "526839"
  },
  {
    "text": "like machine code that you that you have um and this is executed by the virtual machine and the virtual machine",
    "start": "526839",
    "end": "532600"
  },
  {
    "text": "basically represents the rule base and if the chain of fragments meets the rule base then the correspond a corresponding",
    "start": "532600",
    "end": "540120"
  },
  {
    "text": "entry is made in the connections table so this is the simple case we have more complicated cases like the FTP protocol",
    "start": "540120",
    "end": "546560"
  },
  {
    "text": "for example the FTP protocol has like um control connections and corresponding",
    "start": "546560",
    "end": "552399"
  },
  {
    "text": "data connections whenever you download something a data connection is opened and um you don't have rules in your EUR",
    "start": "552399",
    "end": "558720"
  },
  {
    "text": "rule base for those um for those data connections you just have a rule that allows outgoing FTP for example the",
    "start": "558720",
    "end": "565720"
  },
  {
    "text": "secondary connections like the uh FTP data connections are handled using a so-called pending table so the firewall",
    "start": "565720",
    "end": "572120"
  },
  {
    "text": "one monitors or the connections that are in the connections table monitors especially like FTP control connections",
    "start": "572120",
    "end": "578399"
  },
  {
    "text": "and whenever it sees a port command for example or a passive command depending whether you do active or passive FTP it",
    "start": "578399",
    "end": "584959"
  },
  {
    "text": "will make a corresponding entry in the pending table and the pending table means that um the firewall is ready to",
    "start": "584959",
    "end": "591079"
  },
  {
    "text": "accept a connection and as soon as the connection is accepted as soon as the um",
    "start": "591079",
    "end": "596279"
  },
  {
    "text": "the data connection arrives it will be put into the connection table so only of",
    "start": "596279",
    "end": "601760"
  },
  {
    "text": "course if the packet meets the rule base so that's why after the virtual machine either the packet is accepted and the",
    "start": "601760",
    "end": "608360"
  },
  {
    "text": "corresponding um the corresponding connection put is put into the rule base or the packet is rejected so this is how",
    "start": "608360",
    "end": "614920"
  },
  {
    "text": "the whole thing works and we have some other things um for example if you're using IPC um networks then before the",
    "start": "614920",
    "end": "621000"
  },
  {
    "text": "pre-inspection part there will be the decapsulation on decryption um what we will be using is um the proprietary form",
    "start": "621000",
    "end": "627519"
  },
  {
    "text": "of encapsulation the check Point proprietary fwz encapsulation this is",
    "start": "627519",
    "end": "632640"
  },
  {
    "text": "done also right before pre-inspection but we will hear more about that",
    "start": "632640",
    "end": "638399"
  },
  {
    "text": "later so um I was talking about Connections UDP",
    "start": "638399",
    "end": "647079"
  },
  {
    "text": "um oops UDP does not have connections but um they use Virtual connections",
    "start": "647079",
    "end": "652200"
  },
  {
    "text": "there so if you have have an internal client and an external server the internal client sends a request to the",
    "start": "652200",
    "end": "657279"
  },
  {
    "text": "external server then we have from a client port see an accepted UDP packet um to a server port s for example the",
    "start": "657279",
    "end": "663880"
  },
  {
    "text": "rule base accepts it and also for UDP connections there will be connection",
    "start": "663880",
    "end": "669160"
  },
  {
    "text": "entries so the interesting thing about that is that UDP replies are accepted",
    "start": "669160",
    "end": "674200"
  },
  {
    "text": "for these connections that's the little tick mark that you have in the um policy properties and um yeah normally you have",
    "start": "674200",
    "end": "681959"
  },
  {
    "text": "to take this because otherwise you would have to open all ports from 1024 up um for incoming replies for potential",
    "start": "681959",
    "end": "688399"
  },
  {
    "text": "replies that's why you normally want UTP replies to be accepted so you don't have to open the ports and um these UTP",
    "start": "688399",
    "end": "693920"
  },
  {
    "text": "replies are accepted from any port from any server Port this is not a security risk itself but um it makes things",
    "start": "693920",
    "end": "700440"
  },
  {
    "text": "easier later when we attack this so um the um what was I saying yeah um it was",
    "start": "700440",
    "end": "708560"
  },
  {
    "text": "about um we have virtual connections for that and um yeah we have a connection from a client to from Port C to a server",
    "start": "708560",
    "end": "715079"
  },
  {
    "text": "port s or a wild card Port the any port in the other direction so let me quickly show you how uh a connection table entry",
    "start": "715079",
    "end": "721959"
  },
  {
    "text": "looks like it's Source address Source Port destination address destination port and protocol those five parameters",
    "start": "721959",
    "end": "727320"
  },
  {
    "text": "that uniquely identify a connection in the internet",
    "start": "727320",
    "end": "732839"
  },
  {
    "text": "so let me quickly go through an example of stateful inspection the FTP protocol",
    "start": "732839",
    "end": "738000"
  },
  {
    "text": "the upper part is um the active part the lower uh the lower part is um where the",
    "start": "738000",
    "end": "743800"
  },
  {
    "text": "up it's the active case and down there is the low the the passive case um the active case is the FTP",
    "start": "743800",
    "end": "751079"
  },
  {
    "text": "client um connects to a server from a non-privileged port to port 21 of the",
    "start": "751079",
    "end": "756760"
  },
  {
    "text": "server and this is put into the connections table the connections table is being monitored and when fir War one",
    "start": "756760",
    "end": "762079"
  },
  {
    "text": "sees a packet that contains a port command that is the beginning of the packet has P RT and after that the port",
    "start": "762079",
    "end": "768600"
  },
  {
    "text": "information then it is parsed and a corresponding entry is made into the pending table and as soon as the data",
    "start": "768600",
    "end": "776360"
  },
  {
    "text": "connection is seen by the firewall it would look in the pend at the pending table and see wow there's a data",
    "start": "776360",
    "end": "782120"
  },
  {
    "text": "connection and it matches the data connection that's in the pending table and this will be moved to the connections table so the same thing is",
    "start": "782120",
    "end": "787480"
  },
  {
    "text": "true for the passive case you have a passive connection the client sends pasv PV is ignored by the firewall but if the",
    "start": "787480",
    "end": "794199"
  },
  {
    "text": "firewall sees a 227 reply that's the normal reply to a passive command if the firewall sees a packet that begins with",
    "start": "794199",
    "end": "801279"
  },
  {
    "text": "227 space then it's and which is coming from from Port 21 then it thinks that",
    "start": "801279",
    "end": "806519"
  },
  {
    "text": "this is a passive reply and will make a corresponding entry into the pending",
    "start": "806519",
    "end": "811760"
  },
  {
    "text": "table again this time from the client to the server because in the passive case um the data connections and the the",
    "start": "811760",
    "end": "818279"
  },
  {
    "text": "control connections and the data connections are from client to server and then as soon as it sees the",
    "start": "818279",
    "end": "823480"
  },
  {
    "text": "connection from the client to the server here it's Port the port is 4 36 which is 4 *",
    "start": "823480",
    "end": "829800"
  },
  {
    "text": "256 plus 36 which is 1060 and it will accept this data connection so this is",
    "start": "829800",
    "end": "836720"
  },
  {
    "text": "how stateful inspection works with the connection table and the pending table and my colleagues will now I think uh",
    "start": "836720",
    "end": "843959"
  },
  {
    "text": "fill in the details what's the next slide exactly so it's now up to my",
    "start": "843959",
    "end": "850759"
  },
  {
    "text": "colleagues fix [Music] theall so next uh exploit we'll be",
    "start": "856959",
    "end": "864000"
  },
  {
    "text": "looking at is an exploit of the uh fast mode Service uh fast modes um",
    "start": "864000",
    "end": "870880"
  },
  {
    "text": "F fast mode uh basically allows uh a connection based only on on whether or",
    "start": "870880",
    "end": "877480"
  },
  {
    "text": "not the source or the desk Port match uh the fast mode Service uh for example you might you may enable fast mode for HTTP",
    "start": "877480",
    "end": "885920"
  },
  {
    "text": "um if you wanted to uh um make the processing load on your firewall for web",
    "start": "885920",
    "end": "891120"
  },
  {
    "text": "traffic a lot faster the problem with this is that it's um pretty trivially looted um and one of the ways um in",
    "start": "891120",
    "end": "897680"
  },
  {
    "text": "which we can leverage this to our own ends is to uh do stealth scanning with a",
    "start": "897680",
    "end": "902920"
  },
  {
    "text": "uh Source Port set to Port 80 um yeah go",
    "start": "902920",
    "end": "909600"
  },
  {
    "text": "ahead okay I need a a little bit of time to get the firewall to reasonable",
    "start": "909759",
    "end": "916279"
  },
  {
    "text": "sck all right now a lot of what we're showing depends on misconfiguration so",
    "start": "927959",
    "end": "935319"
  },
  {
    "text": "we don't have anything up for sleeves I'm going to show you exactly we'll start with the default and I'll show you all the changes we make um so let's",
    "start": "935319",
    "end": "944600"
  },
  {
    "text": "see we have the IP 440 Network object and spoofing protection is",
    "start": "944600",
    "end": "951360"
  },
  {
    "text": "currently applied correctly so let's",
    "start": "951360",
    "end": "957920"
  },
  {
    "text": "see",
    "start": "957920",
    "end": "960920"
  },
  {
    "text": "so we have the slowest box uh anyone can FTP or HTTP to it um and the slowest box",
    "start": "968199",
    "end": "974279"
  },
  {
    "text": "is allowed to FTP out everything else is denied go on properties let's kill all",
    "start": "974279",
    "end": "981759"
  },
  {
    "text": "this so this is basically a default install",
    "start": "981759",
    "end": "987519"
  },
  {
    "text": "of checkpoint def",
    "start": "987519",
    "end": "990920"
  },
  {
    "text": "okay now what we're going to do for if you wanted a quick end M should not just",
    "start": "1008959",
    "end": "1014800"
  },
  {
    "text": "a straight just",
    "start": "1014800",
    "end": "1020839"
  },
  {
    "text": "[Music] make uh so over on the attacking box",
    "start": "1026020",
    "end": "1032959"
  },
  {
    "text": "we're uh just doing a simple s s port scan um just to demonstrate that uh in",
    "start": "1032959",
    "end": "1038520"
  },
  {
    "text": "fact the firewall is working as it should okay so what we're going to do",
    "start": "1038520",
    "end": "1044360"
  },
  {
    "text": "now is make HTTP a fast mode service",
    "start": "1044360",
    "end": "1050000"
  },
  {
    "text": "and it says here that if if it's a fast Bo service you can't do encryption address translation or accounting for the",
    "start": "1050000",
    "end": "1056919"
  },
  {
    "text": "service okay so if we redo the port scan that we just did uh as a fin",
    "start": "1067960",
    "end": "1074320"
  },
  {
    "text": "scan um with a source port of 80 which",
    "start": "1074320",
    "end": "1079559"
  },
  {
    "text": "is the fast mode service um we you see a lot",
    "start": "1079559",
    "end": "1084440"
  },
  {
    "text": "more and in fact we see uh everything on the keep in mind you can't get to any of these so it's not that that big a deal",
    "start": "1085720",
    "end": "1092760"
  },
  {
    "text": "but it does let you to scan behind the firewall show the next",
    "start": "1092760",
    "end": "1099400"
  },
  {
    "text": "SL um the next next up we have uh Port parsing um this is uh an example of the",
    "start": "1100679",
    "end": "1107720"
  },
  {
    "text": "end to end ambiguity um that some um passive monitoring devices are susceptible to in this case",
    "start": "1107720",
    "end": "1114320"
  },
  {
    "text": "the um the firewall gets desin from um what's actually being implemented by the",
    "start": "1114320",
    "end": "1120440"
  },
  {
    "text": "by the uh end host FTP server hi so the the command the command",
    "start": "1120440",
    "end": "1127880"
  },
  {
    "text": "being sent the command being sent in the port command the arguments to it are the IP address and the port to connect to um",
    "start": "1127880",
    "end": "1135159"
  },
  {
    "text": "split up into octets comma separated uh what we do is um we can leverage uh a",
    "start": "1135159",
    "end": "1141120"
  },
  {
    "text": "difference in the way that the our end host FTP server uh interprets this command uh versus what the fireball",
    "start": "1141120",
    "end": "1148200"
  },
  {
    "text": "believes is being is being stated here um um by using a an um a number here for",
    "start": "1148200",
    "end": "1156280"
  },
  {
    "text": "the port or for the for the end of the IP that's uh larger than than what can be represented in octet um so for",
    "start": "1156280",
    "end": "1163320"
  },
  {
    "text": "instance uh on the left on the left hand side we have the uh the actual machine which believes the string evaluates to",
    "start": "1163320",
    "end": "1170400"
  },
  {
    "text": "the IP address 172.16.0.0 while the firewall believes that it's 17216 1.2 um because of the uh the carry",
    "start": "1170400",
    "end": "1180240"
  },
  {
    "text": "so how can we actually use this to our own ends um a good application is to use it in a bounce attack uh there are not",
    "start": "1180240",
    "end": "1187200"
  },
  {
    "text": "too many FTP servers actually that are susceptible to bounce attacks anymore um but as it turns out this the cious ftpd",
    "start": "1187200",
    "end": "1193559"
  },
  {
    "text": "still is um and so we can use this um for example to exploit our and hold an",
    "start": "1193559",
    "end": "1198960"
  },
  {
    "text": "RPC Service uh so John do you want to set up",
    "start": "1198960",
    "end": "1204640"
  },
  {
    "text": "okay so well hold on let me make sure I cleaned",
    "start": "1207559",
    "end": "1215000"
  },
  {
    "text": "[Music] up okay so what we have running is a",
    "start": "1216140",
    "end": "1223880"
  },
  {
    "text": "Solaris FTP server the firewall and an attack box um what we're trying to do is",
    "start": "1223880",
    "end": "1229600"
  },
  {
    "text": "actually uh run an RPC exploit against this solar server um uh but uh of course",
    "start": "1229600",
    "end": "1236640"
  },
  {
    "text": "all the higher reports are closed um so what we do is we make use of the existing FTP Channel",
    "start": "1236640",
    "end": "1243880"
  },
  {
    "text": "um to perform a bounce attack to cause the uh server to send exploit an exploit",
    "start": "1243880",
    "end": "1251000"
  },
  {
    "text": "against itself essentially so you see here that there's a public directory that we can write to and that's what",
    "start": "1251000",
    "end": "1256760"
  },
  {
    "text": "we're going to use in this attack um I'm going to go ahead and upload two",
    "start": "1256760",
    "end": "1261919"
  },
  {
    "text": "files which we're going to send to the tool talk database demon um standard",
    "start": "1261919",
    "end": "1267720"
  },
  {
    "text": "exploit ah crap control h",
    "start": "1268440",
    "end": "1275159"
  },
  {
    "text": "contr all",
    "start": "1275159",
    "end": "1278320"
  },
  {
    "text": "right I I'll find it there we",
    "start": "1280880",
    "end": "1285000"
  },
  {
    "text": "go okay",
    "start": "1285919",
    "end": "1290520"
  },
  {
    "text": "okay so what we what we want to do for our attack is this we want to say connect back to 17 we want to tell it to",
    "start": "1301880",
    "end": "1307919"
  },
  {
    "text": "connect back to itself on WE happen to know that the port we want is 32775",
    "start": "1307919",
    "end": "1314120"
  },
  {
    "text": "which is where ttdb is you can actually scan for that with the by binding",
    "start": "1314120",
    "end": "1319240"
  },
  {
    "text": "um so that's what we want to do you can see the firewall doesn't want us to do that the firewall says more or less",
    "start": "1319240",
    "end": "1326120"
  },
  {
    "text": "wants to enforce that the data connection is going back to the FTP client so we're going to use the",
    "start": "1326120",
    "end": "1331440"
  },
  {
    "text": "ambiguity here to trick it um in earlier versions of R11 there's other easy ways",
    "start": "1331440",
    "end": "1336679"
  },
  {
    "text": "to trick it but because of the pass the recent passy bug they kind of tighten down on how it parses the FTP protocol",
    "start": "1336679",
    "end": "1343480"
  },
  {
    "text": "so this actually works out pretty nicely so and again we just threw this demo",
    "start": "1343480",
    "end": "1349080"
  },
  {
    "text": "uh we were supposed to have the video out on here so it might not work but we'll see what",
    "start": "1349080",
    "end": "1353880"
  },
  {
    "text": "happens okay you can see that the firewall let us get away with that because what it",
    "start": "1374440",
    "end": "1381159"
  },
  {
    "text": "thinks is that we're connecting to 192 16802 and we're really and the FTP demon",
    "start": "1381159",
    "end": "1387159"
  },
  {
    "text": "sees its own IP address 17262 so then we'll",
    "start": "1387159",
    "end": "1393279"
  },
  {
    "text": "just we're retrieve a file that will kill the tool talk database demon if you anyone's ever used the exploit you use",
    "start": "1393279",
    "end": "1398760"
  },
  {
    "text": "minus K Flag um now one obvious problem here is that you have a socket coming",
    "start": "1398760",
    "end": "1404760"
  },
  {
    "text": "from Port 202 32775 and that's going to take like 4 minutes or 5 minutes to time out so we did some ndds on this luris",
    "start": "1404760",
    "end": "1411640"
  },
  {
    "text": "box to make it time out [Music]",
    "start": "1411640",
    "end": "1416919"
  },
  {
    "text": "quicker so actually I should show real quick the payload of what we're doing um now in order for us to get",
    "start": "1416919",
    "end": "1425159"
  },
  {
    "text": "anything back I'm just going to make it easy I'm we're I'm going to send an xterm back um but I'll do it in kind of",
    "start": "1425159",
    "end": "1432000"
  },
  {
    "text": "a way that that we've used with a bunch of firewall ones um so I'm going to go",
    "start": "1432000",
    "end": "1437279"
  },
  {
    "text": "in to the policy settings and I'm going to accept domain",
    "start": "1437279",
    "end": "1442600"
  },
  {
    "text": "name over UDP and over TCP which you know in firewall version 4 is the default",
    "start": "1442600",
    "end": "1447880"
  },
  {
    "text": "configuration um a lot of the tax were shown will depend on this",
    "start": "1447880",
    "end": "1452960"
  },
  {
    "text": "but so now there's basically an implicit rule that anyone connect can connect anywhere on Port 53 so what we're going",
    "start": "1457120",
    "end": "1463840"
  },
  {
    "text": "to do is have it send an xterm over Port 53 which is pretty easy to do",
    "start": "1463840",
    "end": "1470360"
  },
  {
    "text": "um all right",
    "start": "1471799",
    "end": "1477640"
  },
  {
    "text": " this is the payload of what we're doing and you see that we send to display 59 589 and what happens is that",
    "start": "1479000",
    "end": "1485880"
  },
  {
    "text": "wraps around well your display number is added to 6,000 to determine the port and that wraps around 65536 to hit 53 so",
    "start": "1485880",
    "end": "1493240"
  },
  {
    "text": "it'll make a TCP connection out on Port 53 show the3 yeah so so on the Linux box",
    "start": "1493240",
    "end": "1500720"
  },
  {
    "text": "we have a simple a really simple",
    "start": "1500720",
    "end": "1505158"
  },
  {
    "text": "proxy um see right here domain we're just doing a netcat to the Box you're",
    "start": "1508000",
    "end": "1513159"
  },
  {
    "text": "looking at the 03 box 4 6000 so in theory this will",
    "start": "1513159",
    "end": "1520520"
  },
  {
    "text": "work [Applause]",
    "start": "1527320",
    "end": "1536880"
  },
  {
    "text": "boom okay go",
    "start": "1536880",
    "end": "1540399"
  },
  {
    "text": "away okay but I mean you're running a remote buff overflow so if you want to get fancy the you can send like there's",
    "start": "1542960",
    "end": "1550240"
  },
  {
    "text": "certain things that are allowed through firewall 1 by default even on 41 like RDP packets so there's a there's always",
    "start": "1550240",
    "end": "1557200"
  },
  {
    "text": "there's definitely some for communication there uh the next exploit in the uh FTP",
    "start": "1557200",
    "end": "1564640"
  },
  {
    "text": "server in the FTP proxy that we were exploiting is a well-known one it was discussed at length on bug track um and",
    "start": "1564640",
    "end": "1572760"
  },
  {
    "text": "uh it has to do with the the way that the uh the firewall verifies the pass V",
    "start": "1572760",
    "end": "1577960"
  },
  {
    "text": "command um actually as well as the port command um and what it actually what it",
    "start": "1577960",
    "end": "1583039"
  },
  {
    "text": "actually does it it is it looks at the discret TCP data within IP packets um",
    "start": "1583039",
    "end": "1588360"
  },
  {
    "text": "instead of reassembling the entire TCP stream um what this opens you up to is a sort of a framing attack where you can",
    "start": "1588360",
    "end": "1594320"
  },
  {
    "text": "actually um Leverage The the error uh messages rece uh sent back from the",
    "start": "1594320",
    "end": "1600279"
  },
  {
    "text": "server uh to sort of fake fake out the firewall into believing that a real uh",
    "start": "1600279",
    "end": "1605880"
  },
  {
    "text": "pass V positive response was sent back um and so the way we do this is um we",
    "start": "1605880",
    "end": "1612320"
  },
  {
    "text": "advertise a a small um MSS uh in our Al in our outgoing connection to the FTP",
    "start": "1612320",
    "end": "1617360"
  },
  {
    "text": "server um um so that when the FTP server replies its um carefully formatted um",
    "start": "1617360",
    "end": "1623760"
  },
  {
    "text": "bounce message is split up uh like such uh you have the 500 invalid command",
    "start": "1623760",
    "end": "1629399"
  },
  {
    "text": "given uh string um after which the actual command that you sent is quoted",
    "start": "1629399",
    "end": "1634799"
  },
  {
    "text": "um but it's actually sent in a in a separate discret IP packet and um this",
    "start": "1634799",
    "end": "1640000"
  },
  {
    "text": "tricks the firewall into believing that this past V command was in fact sent by the by the FTP server uh and it opens up",
    "start": "1640000",
    "end": "1646480"
  },
  {
    "text": "a whole it opens up um a hole in the firewall to allow that connection coming back um there is a restriction on this",
    "start": "1646480",
    "end": "1652799"
  },
  {
    "text": "though um checkpoint by default uh restricts uh incoming data connections",
    "start": "1652799",
    "end": "1658120"
  },
  {
    "text": "to a high number ports um as it turned out this bug was also existing existent in Cisco pick and it let you open up a",
    "start": "1658120",
    "end": "1665559"
  },
  {
    "text": "hole on any port which is much worse um but any we can demonstrate that as well right",
    "start": "1665559",
    "end": "1671919"
  },
  {
    "text": "now",
    "start": "1677120",
    "end": "1680120"
  },
  {
    "text": "so we'll use the tool FTP ozone written by Doug to",
    "start": "1692559",
    "end": "1697840"
  },
  {
    "text": "open up the port",
    "start": "1697840",
    "end": "1703000"
  },
  {
    "text": "and note here that it was open so we'll then send and and we're using the same",
    "start": "1703000",
    "end": "1709919"
  },
  {
    "text": "files as before yeah we'll open open the port",
    "start": "1709919",
    "end": "1714840"
  },
  {
    "text": "again and then there's our exra that's",
    "start": "1719799",
    "end": "1726159"
  },
  {
    "text": "it",
    "start": "1726159",
    "end": "1729159"
  },
  {
    "text": "um the uh the next set of uh constraints uh that we look at are these uh one-way",
    "start": "1731600",
    "end": "1736919"
  },
  {
    "text": "connections um firewall one tries to restrict uh the data flow of a",
    "start": "1736919",
    "end": "1742519"
  },
  {
    "text": "connection for instance for FTP data connections um by looking at the TCP",
    "start": "1742519",
    "end": "1747720"
  },
  {
    "text": "header um in the IP packet being sent uh and and checking well checking the IP",
    "start": "1747720",
    "end": "1753679"
  },
  {
    "text": "packet and seeing whether there's any TCP data in it uh the problem there is that you can actually fragment your uh packets coming back so that um the TCP",
    "start": "1753679",
    "end": "1760600"
  },
  {
    "text": "header and the the TCP payload are in separate packets um which lets you uh",
    "start": "1760600",
    "end": "1766080"
  },
  {
    "text": "establish a duplex connection um an examp so an example of this is",
    "start": "1766080",
    "end": "1774120"
  },
  {
    "text": "um in the original exploit that we had um for for with FTP ozone uh you could",
    "start": "1774120",
    "end": "1780519"
  },
  {
    "text": "only open up a one-way connection um but we found that uh the firewall responded",
    "start": "1780519",
    "end": "1785799"
  },
  {
    "text": "very well to uh to uh reopening the connection firewall one doesn't actually track sequence numbers um so you can so",
    "start": "1785799",
    "end": "1794399"
  },
  {
    "text": "packets um that have the have the correct IP and Source Port uh dust dust",
    "start": "1794399",
    "end": "1799799"
  },
  {
    "text": "IP and uh dust Port watch should you get associated with that connection um as",
    "start": "1799799",
    "end": "1805480"
  },
  {
    "text": "long as it's in the state table um so the way to to bypass this oneway restriction is simply to reopen the",
    "start": "1805480",
    "end": "1812039"
  },
  {
    "text": "connection um and then the the uh firewall looks at what direction the the",
    "start": "1812039",
    "end": "1817640"
  },
  {
    "text": "First Data packet coming back is in in this case um the retransmission happens um coming back to us um we can",
    "start": "1817640",
    "end": "1824640"
  },
  {
    "text": "demonstrate that as well okay my ex will't go away yeah um the fragmentation worked in version four but they fixed it",
    "start": "1824640",
    "end": "1831360"
  },
  {
    "text": "in 41 so in version four you can just fragment your packets and get past the uh the oneway Restriction but here it's",
    "start": "1831360",
    "end": "1837120"
  },
  {
    "text": "kind of a pain in the ass um so what I'm going to do is hook up",
    "start": "1837120",
    "end": "1843440"
  },
  {
    "text": "the spark and I'm going to set up a net cat on there so we can see the data going both",
    "start": "1843440",
    "end": "1849200"
  },
  {
    "text": "ways where's",
    "start": "1849200",
    "end": "1852559"
  },
  {
    "text": "the",
    "start": "1856919",
    "end": "1859919"
  },
  {
    "text": "oh it right there got it it",
    "start": "1865360",
    "end": "1872519"
  },
  {
    "text": "okay see it I can't see what I'm doing",
    "start": "1872519",
    "end": "1879080"
  },
  {
    "text": "but uh like 40 where am I 1 2 3 four",
    "start": "1879080",
    "end": "1886080"
  },
  {
    "text": "five okay so we got that listening there I'm going to use FTP ozone to open up a",
    "start": "1886080",
    "end": "1893919"
  },
  {
    "text": "hole and then we can connect [Music]",
    "start": "1902440",
    "end": "1908410"
  },
  {
    "text": "there right oh it's broken",
    "start": "1909399",
    "end": "1916840"
  },
  {
    "text": "okay",
    "start": "1916840",
    "end": "1919840"
  },
  {
    "text": "grab pick is it 54 3 2 1",
    "start": "1922679",
    "end": "1931760"
  },
  {
    "text": "okay who knows what's listed in there it's one of my experimentation boxes okay so I data can go in this",
    "start": "1940480",
    "end": "1951880"
  },
  {
    "text": "direction okay so now if I go and type a response it's going to it's going to uh",
    "start": "1951880",
    "end": "1958000"
  },
  {
    "text": "erase the connection from the uh connections table so because it's marked as a one-way connection so before I do",
    "start": "1958000",
    "end": "1964639"
  },
  {
    "text": "that I'm going to prepare to open it back up again because we end up having to wait for retransmissions that takes a",
    "start": "1964639",
    "end": "1971919"
  },
  {
    "text": "while so is this s yes",
    "start": "1973679",
    "end": "1979840"
  },
  {
    "text": "oops what have I done here",
    "start": "1985679",
    "end": "1993559"
  },
  {
    "text": "okay what John's doing here is discovering the ephemeral uh Source data Port uh Source Port that we used for",
    "start": "2006200",
    "end": "2012360"
  },
  {
    "text": "this this data connection so we can use the same one um when we make the second",
    "start": "2012360",
    "end": "2017880"
  },
  {
    "text": "connection so I'm just going to use this to I have to open the the connection with uh FTP ozone and then spoof a sin",
    "start": "2025120",
    "end": "2033440"
  },
  {
    "text": "in order to get the connection back into the table and then when the uh Solus box R transmits then it'll get through",
    "start": "2033440",
    "end": "2042440"
  },
  {
    "text": "so",
    "start": "2051879",
    "end": "2054878"
  },
  {
    "text": "wait",
    "start": "2066720",
    "end": "2069720"
  },
  {
    "text": "okay so we see here's the here's the connection I'm going to come over on the spark and type",
    "start": "2081079",
    "end": "2089440"
  },
  {
    "text": "something and we see that it didn't come through and now anything I type here won't make AC cross either so what we",
    "start": "2090879",
    "end": "2096679"
  },
  {
    "text": "can do is open the back",
    "start": "2096679",
    "end": "2100119"
  },
  {
    "text": "up spoof of sin and",
    "start": "2103920",
    "end": "2109400"
  },
  {
    "text": "then type some more so you can see that now the now the",
    "start": "2109400",
    "end": "2115079"
  },
  {
    "text": "connection's established in the other direction so if we want to send data back the other way we have to go through the process again but you could probably",
    "start": "2115079",
    "end": "2121079"
  },
  {
    "text": "script this with no problem and have a really slow two-way connection bypassing their",
    "start": "2121079",
    "end": "2126640"
  },
  {
    "text": "mechanism [Applause]",
    "start": "2126640",
    "end": "2135549"
  },
  {
    "text": "okay so this is interesting um what this is is fwz encapsulation it's what they",
    "start": "2139520",
    "end": "2145480"
  },
  {
    "text": "use for the SECU remote that's what they used to use for SECU remote uh clients",
    "start": "2145480",
    "end": "2150880"
  },
  {
    "text": "um what is a really lightweight tunneling protocol and we're going to use that in a lot of our attacks the interesting thing about this is you can",
    "start": "2150880",
    "end": "2156880"
  },
  {
    "text": "send you can and packets to a firewall 1 almost any version we've seen uh from 30 to to 41 and in this IP protocol 94 and",
    "start": "2156880",
    "end": "2165920"
  },
  {
    "text": "the firewall one will decapsulate it and you don't need to authenticate and there's no you don't have to encrypt",
    "start": "2165920",
    "end": "2171079"
  },
  {
    "text": "your packets or anything so basically the impact of this is you can send packets that you you can that you",
    "start": "2171079",
    "end": "2177440"
  },
  {
    "text": "wouldn't normally be able to route to the firewall which is fun",
    "start": "2177440",
    "end": "2183160"
  },
  {
    "text": "so so it's pretty simple what you do is you take your normal IP packet and you",
    "start": "2183480",
    "end": "2191119"
  },
  {
    "text": "you Destin it to the firewall and you set it to IP protocol 94 and then you append the real information to the end",
    "start": "2191119",
    "end": "2197880"
  },
  {
    "text": "of it so if you want to send it to like 10.0.1 you append that IP address to the",
    "start": "2197880",
    "end": "2203160"
  },
  {
    "text": "end of the packet and then you append the real protocol that you want so it's just five bytes you stick on the end of",
    "start": "2203160",
    "end": "2208599"
  },
  {
    "text": "the packet now it's a bit it's not that simple they offc it a little they do an",
    "start": "2208599",
    "end": "2214720"
  },
  {
    "text": "exclusive ore with a with a value with a value uh based off of the IP ID so it's",
    "start": "2214720",
    "end": "2221960"
  },
  {
    "text": "just a simple little trick to aisc it what we do in all our tools is just set the IP ID to one and then we know the",
    "start": "2221960",
    "end": "2228440"
  },
  {
    "text": "value so we just exort it with that so",
    "start": "2228440",
    "end": "2234200"
  },
  {
    "text": "okay what's that yeah you can't switch it off um we'll talk more about that but",
    "start": "2236119",
    "end": "2241760"
  },
  {
    "text": "it there's no it's not in the guey or anything so what we have here is the",
    "start": "2241760",
    "end": "2247720"
  },
  {
    "text": "general form of the attacks I'm going to talk about first are based on spoofing protection not being correctly applied",
    "start": "2247720",
    "end": "2253880"
  },
  {
    "text": "so if SPO spoofing protection if the firewall is misconfigured such that spoofing protection isn't applied right",
    "start": "2253880",
    "end": "2259560"
  },
  {
    "text": "then you can have a field day with it so assuming assuming that there's some rules that allow you to do what you want",
    "start": "2259560",
    "end": "2266520"
  },
  {
    "text": "um so for instance here our attacker would be 131",
    "start": "2266520",
    "end": "2271839"
  },
  {
    "text": "1591 and what we're going to do is we're going to send a packet from something in",
    "start": "2271839",
    "end": "2277200"
  },
  {
    "text": "the EMZ or Internet To Us by using this encapsulation and that'll allow us um to",
    "start": "2277200",
    "end": "2284760"
  },
  {
    "text": "to put data in it for to inspect or to respond to it you'll see the general form of the attack later so um basically",
    "start": "2284760",
    "end": "2292240"
  },
  {
    "text": "looking here in the IP header you see the source address is a 10.0.0 do1 so",
    "start": "2292240",
    "end": "2297960"
  },
  {
    "text": "it's an internet or DMZ box the destination address is now the the top",
    "start": "2297960",
    "end": "2303319"
  },
  {
    "text": "part is the real IP header the destination address is the external interface of the firewall and then the stuff we append is our IP address so",
    "start": "2303319",
    "end": "2310960"
  },
  {
    "text": "what's going to happen is this packet's going to make it to the firewall because it's destination address is the external",
    "start": "2310960",
    "end": "2316079"
  },
  {
    "text": "firewall interface then it's going to get decapsulated then spoofing protection is",
    "start": "2316079",
    "end": "2321680"
  },
  {
    "text": "going to check it and if it's proper improperly configured then it's going to pass it into the uh into the machine so",
    "start": "2321680",
    "end": "2329440"
  },
  {
    "text": "as far as the firewall knows the packet came from the DMZ or the internet and is headed for our",
    "start": "2329440",
    "end": "2334880"
  },
  {
    "text": "machine so I I can give a quick demo of this real",
    "start": "2334880",
    "end": "2340880"
  },
  {
    "text": "quick all I'm going to do now is just send a packet that meets the ACL just to show you that the encapsulation",
    "start": "2343240",
    "end": "2350440"
  },
  {
    "text": "works now I'm using a tool called ton that we put together and this takes the",
    "start": "2354880",
    "end": "2360880"
  },
  {
    "text": "protocol so I'm going to do TCP the the firewall",
    "start": "2360880",
    "end": "2365800"
  },
  {
    "text": "interface um then the source address which will be",
    "start": "2366359",
    "end": "2371599"
  },
  {
    "text": "our",
    "start": "2371599",
    "end": "2373800"
  },
  {
    "text": "machine the destination address is going to be the",
    "start": "2379640",
    "end": "2384119"
  },
  {
    "text": "spark destination Port we'll do 80 TTL 100 we'll make it a sin",
    "start": "2384760",
    "end": "2391359"
  },
  {
    "text": "um now let me bring up a TCP dump here",
    "start": "2391359",
    "end": "2399319"
  },
  {
    "text": "oh yeah we changed our demo a little",
    "start": "2400880",
    "end": "2408160"
  },
  {
    "text": "see all right",
    "start": "2410440",
    "end": "2415800"
  },
  {
    "text": "okay so what you see here is that we had an IP protocol 94 packet go through from",
    "start": "2415800",
    "end": "2423440"
  },
  {
    "text": "us to the external firewall interface and then the the now it's legitimate a",
    "start": "2423440",
    "end": "2429920"
  },
  {
    "text": "packet we just tunneled it so the spark responds with the syac because it got decapsulated and then our box shoots",
    "start": "2429920",
    "end": "2435319"
  },
  {
    "text": "back in rst so you can see that the that's just proof that the encapsulation works so moving on to we actually do an",
    "start": "2435319",
    "end": "2443560"
  },
  {
    "text": "attack now oops so I'm going to break the",
    "start": "2443560",
    "end": "2449079"
  },
  {
    "text": "firewall intentionally to show you I'm going to make a mistake in configuring the spoofing",
    "start": "2449079",
    "end": "2456240"
  },
  {
    "text": "protection I'm going to forget to have entered interfaces in on the network object um this is",
    "start": "2456240",
    "end": "2463400"
  },
  {
    "text": "just uh we've seen this before um the the other mistake obviously is to",
    "start": "2463400",
    "end": "2470200"
  },
  {
    "text": "say any address from the internet interface but it warns you when you do that but when you do this it doesn't warn you",
    "start": "2470200",
    "end": "2477480"
  },
  {
    "text": "so so since it doesn't know what interfaces the firewall has it doesn't know that we didn't correctly configure",
    "start": "2479920",
    "end": "2485560"
  },
  {
    "text": "spoofing protection yet everything else still works so it didn't warn us that we didn't do it um so now what we're going",
    "start": "2485560",
    "end": "2493480"
  },
  {
    "text": "to do is spoof a port command from the spark to",
    "start": "2493480",
    "end": "2498880"
  },
  {
    "text": "us so just to just to give an overview um",
    "start": "2498880",
    "end": "2505560"
  },
  {
    "text": "we're sending a packet encapsulated from the spark to us that contains the port command 17260 to 1287 so what the",
    "start": "2505560",
    "end": "2513520"
  },
  {
    "text": "firewall thinks is that we're a machine on the internet f tping to a box on the",
    "start": "2513520",
    "end": "2518760"
  },
  {
    "text": "internet and saying hey connect connect back to me on this port it's giv a port command so the firewall is going to open",
    "start": "2518760",
    "end": "2524880"
  },
  {
    "text": "up that",
    "start": "2524880",
    "end": "2527160"
  },
  {
    "text": "hole I'm putting a comma at the end for the line the new line checking gets",
    "start": "2537079",
    "end": "2542839"
  },
  {
    "text": "around it um",
    "start": "2542839",
    "end": "2549119"
  },
  {
    "text": "two what am I doing here sorry I'm a bit",
    "start": "2556559",
    "end": "2563040"
  },
  {
    "text": "disoriented",
    "start": "2564640",
    "end": "2567640"
  },
  {
    "text": "so so we're moving the packet from the firewall uh for 24 or excuse me from the",
    "start": "2571920",
    "end": "2578800"
  },
  {
    "text": "spark to us on Port 21 it'll be an act or ttail",
    "start": "2578800",
    "end": "2585880"
  },
  {
    "text": "of 100 it'll be an A and I'm in the wrong",
    "start": "2585880",
    "end": "2591440"
  },
  {
    "text": "directory okay so in theory we can",
    "start": "2597200",
    "end": "2602440"
  },
  {
    "text": "now make an FTP data connection back through the firewall",
    "start": "2602440",
    "end": "2609119"
  },
  {
    "text": "and it let it do it it let us do",
    "start": "2612720",
    "end": "2615960"
  },
  {
    "text": "it so",
    "start": "2621200",
    "end": "2627040"
  },
  {
    "text": "okay so again these are dependent on spy protection not being set up right there's a couple things you can do if",
    "start": "2630280",
    "end": "2635520"
  },
  {
    "text": "spofy protection is set up we get into that later and we've run into a surprising number of people that haven't",
    "start": "2635520",
    "end": "2640880"
  },
  {
    "text": "set it up even though it warns you when you say install Okay um now this rsh air",
    "start": "2640880",
    "end": "2648480"
  },
  {
    "text": "connections it's really it represents another way that another thing you could spoof to try to open a connection back",
    "start": "2648480",
    "end": "2656880"
  },
  {
    "text": "uh we actually had another attack based on this based on a collision in its use of the pending table but we we tested it",
    "start": "2656880",
    "end": "2664839"
  },
  {
    "text": "like a couple months ago and then we installed the version it doesn't work on the latest version so we don't want to",
    "start": "2664839",
    "end": "2670240"
  },
  {
    "text": "come out and say it worked at all because we haven't we didn't really have time to install the old version so we're not sure if this attack is valid or not",
    "start": "2670240",
    "end": "2677559"
  },
  {
    "text": "it almost works on the latest version it adds an entry to the connection table but the flags are wrong so",
    "start": "2677559",
    "end": "2683559"
  },
  {
    "text": "um I'm probably just going to go past this well I can I can cover it real quick what happens is when it sees a rsh",
    "start": "2683559",
    "end": "2692720"
  },
  {
    "text": "connection it records the sequence number of the packet in the pending",
    "start": "2692720",
    "end": "2698720"
  },
  {
    "text": "table because what it wants to do is it wants to look at the first packet of the rsh connection to extract the error Port",
    "start": "2698720",
    "end": "2705200"
  },
  {
    "text": "information so what happens is it uses the same table twice it pulls out the",
    "start": "2705200",
    "end": "2710280"
  },
  {
    "text": "sequence number and stores it in the table and then the when the next packet comes through it pulls out the port",
    "start": "2710280",
    "end": "2715960"
  },
  {
    "text": "number stores that in the table and then stores the protocol in the table and then when it sees the actual rsh error",
    "start": "2715960",
    "end": "2723079"
  },
  {
    "text": "connection it matches up with that information now the there's a problem here because it's using the same table",
    "start": "2723079",
    "end": "2729240"
  },
  {
    "text": "twice for do different things in basically the same way so our attack is",
    "start": "2729240",
    "end": "2734480"
  },
  {
    "text": "we send a TCP sin with a sequence number of five now that gets stored in there as",
    "start": "2734480",
    "end": "2740760"
  },
  {
    "text": "a sequence number as six which happens to match up with this criteria for the",
    "start": "2740760",
    "end": "2745960"
  },
  {
    "text": "second check so it actually our source our source Port is the one that we can get to with the air connection",
    "start": "2745960",
    "end": "2752839"
  },
  {
    "text": "um yeah um and we're not sure that it works so take that for what it's worth um but in",
    "start": "2752839",
    "end": "2760559"
  },
  {
    "text": "general with when you consider if spoofing protection is open then there's",
    "start": "2760559",
    "end": "2766480"
  },
  {
    "text": "probably all the protocols that can get through a firewall one probably a lot of them can be abused for opening up back",
    "start": "2766480",
    "end": "2772200"
  },
  {
    "text": "channels and and things like that so this is the one that we've had the most fun with the because it's a default rule",
    "start": "2772200",
    "end": "2779640"
  },
  {
    "text": "in uh the firewall one version 4 to allow UDP Port 53 everywhere so if",
    "start": "2779640",
    "end": "2785440"
  },
  {
    "text": "spoing protection isn't set up what we've been doing is spoofing uh DNS packets from the",
    "start": "2785440",
    "end": "2792119"
  },
  {
    "text": "Internet or DMZ to us and then we can respond to them on whatever Source Port",
    "start": "2792119",
    "end": "2798119"
  },
  {
    "text": "uh they came from so uh in this case uh we spoof a packet from 161 to us on Port",
    "start": "2798119",
    "end": "2804800"
  },
  {
    "text": "53 and then we can respond to the SNP demon on the Internet or or in the DMC so I'm going demonstrate",
    "start": "2804800",
    "end": "2812280"
  },
  {
    "text": "this okay now I have a pretty um I have a Solaris uh exploit for 26 snmpd so",
    "start": "2812280",
    "end": "2819720"
  },
  {
    "text": "that's what I'll show doesn't always work real well but we'll see what",
    "start": "2819720",
    "end": "2824960"
  },
  {
    "text": "happens so you see we're spoofing a packet from 161 on the spark to Us Port",
    "start": "2840680",
    "end": "2845839"
  },
  {
    "text": "53 UDP",
    "start": "2845839",
    "end": "2849440"
  },
  {
    "text": "packet now if you",
    "start": "2851280",
    "end": "2854680"
  },
  {
    "text": "notice oops wrong IP not the Farwell",
    "start": "2860119",
    "end": "2868318"
  },
  {
    "text": "us so we can leverage that for",
    "start": "2870040",
    "end": "2874760"
  },
  {
    "text": "root",
    "start": "2875839",
    "end": "2878839"
  },
  {
    "text": "maybe so I got to open up a port another UDP Port so I can talk to the directly to the MIB uh process not the",
    "start": "2894839",
    "end": "2904160"
  },
  {
    "text": "relay",
    "start": "2905760",
    "end": "2908760"
  },
  {
    "text": "oops all right I messed it",
    "start": "2929400",
    "end": "2933160"
  },
  {
    "text": "up",
    "start": "2935720",
    "end": "2938720"
  },
  {
    "text": "there we",
    "start": "2952680",
    "end": "2955000"
  },
  {
    "text": "go now the thing that's really cool about this is that you can reach internal addresses on any firewall one",
    "start": "2963359",
    "end": "2970079"
  },
  {
    "text": "and if there's any rules that let you talk to it like any any Source rule or anything that lets you talk to them then",
    "start": "2970079",
    "end": "2975440"
  },
  {
    "text": "you can address the internet so for instance in version 4.0 with a default",
    "start": "2975440",
    "end": "2980680"
  },
  {
    "text": "install you can talk to any DNS server on the Internet or DMZ so because you can address using the",
    "start": "2980680",
    "end": "2987440"
  },
  {
    "text": "encapsulation you can address 10.0.0 whatever or whatever you want so that's",
    "start": "2987440",
    "end": "2992839"
  },
  {
    "text": "a really pertinent uh application of of the uh Universal",
    "start": "2992839",
    "end": "2998319"
  },
  {
    "text": "decapsulation so I'm going to set up any spoofing protection",
    "start": "2998319",
    "end": "3003640"
  },
  {
    "text": "now oops I don't know what I'm",
    "start": "3006119",
    "end": "3010359"
  },
  {
    "text": "doing so I'll go in and I'll set up this net",
    "start": "3015880",
    "end": "3022079"
  },
  {
    "text": "protection on the two uh what represents their DMZ",
    "start": "3022079",
    "end": "3027160"
  },
  {
    "text": "interfaces and then on here I'll set up others protection so what that means is that",
    "start": "3027160",
    "end": "3036160"
  },
  {
    "text": "any packets coming into our internet interface that purport to be from any of the other interfaces on the firewall",
    "start": "3036160",
    "end": "3042280"
  },
  {
    "text": "will be rejected now this opens up a small problem because this doesn't",
    "start": "3042280",
    "end": "3048200"
  },
  {
    "text": "protect the external interface of the firewall so in some of the version of the firewall that we've seen if it if it",
    "start": "3048200",
    "end": "3054559"
  },
  {
    "text": "sees a packet that has the IP address of one of its interfaces it drop one of its interfaces it drops it immediately but",
    "start": "3054559",
    "end": "3062040"
  },
  {
    "text": "in actually in this version we just installed it doesn't do that so we can send packets that purport to be from the",
    "start": "3062040",
    "end": "3067720"
  },
  {
    "text": "external interface of the firewall even though spoofing protection is fully applied so then what you would need to",
    "start": "3067720",
    "end": "3073280"
  },
  {
    "text": "exploit this is some sort of rule that allows traffic out from the firewall to the Internet so we have that default DNS",
    "start": "3073280",
    "end": "3080280"
  },
  {
    "text": "rule so what we can do is access what I can do is access the SNMP demon on the",
    "start": "3080280",
    "end": "3086160"
  },
  {
    "text": "firewall now uh from I talked to someone from checkpoint and in service pack two this",
    "start": "3086160",
    "end": "3094040"
  },
  {
    "text": "is uh the automatic interface protection is set so it's something worth",
    "start": "3094040",
    "end": "3099119"
  },
  {
    "text": "checking um so we're basically doing the same",
    "start": "3099119",
    "end": "3105480"
  },
  {
    "text": "attack except we're using the external firewall interface I should probably",
    "start": "3105480",
    "end": "3111799"
  },
  {
    "text": "install a policy",
    "start": "3111799",
    "end": "3118520"
  },
  {
    "text": "and that's our IP 440 you can't do that normally okay",
    "start": "3136200",
    "end": "3143400"
  },
  {
    "text": "so um the next thing we can can do against anti spoofing protection that",
    "start": "3143400",
    "end": "3149480"
  },
  {
    "text": "even if everything's applied we still can leverage something is we send something from what we do is we spoof a",
    "start": "3149480",
    "end": "3156359"
  },
  {
    "text": "packet from the fire or excuse me from the multicast address or the subnet",
    "start": "3156359",
    "end": "3161799"
  },
  {
    "text": "broadcast address to us that um if there's a rule that allow that will",
    "start": "3161799",
    "end": "3166960"
  },
  {
    "text": "allow it then that'll get added to the connections table and we can respond to that and it'll get delivered to the",
    "start": "3166960",
    "end": "3172799"
  },
  {
    "text": "firewall so we we essentially make enable us to respond on to 224001 and that gets delivered to the",
    "start": "3172799",
    "end": "3180319"
  },
  {
    "text": "firewall itself to the UDP Services listening on it so in order to do this it requires a little bit of a setup um",
    "start": "3180319",
    "end": "3187440"
  },
  {
    "text": "we're going to run frag rout over here so that we can send so that I can route uh have use SNMP walk and have it uh",
    "start": "3187440",
    "end": "3195680"
  },
  {
    "text": "SNMP essentially it's going to be SNMP walking 224001 but on the",
    "start": "3195680",
    "end": "3202480"
  },
  {
    "text": "firewall",
    "start": "3205440",
    "end": "3208440"
  },
  {
    "text": "okay so we're running frag router on the second box here um we can look at the code real",
    "start": "3214960",
    "end": "3223839"
  },
  {
    "text": "quick",
    "start": "3235440",
    "end": "3238440"
  },
  {
    "text": "so here's something we threw together that does fwz uh encapsulation in frag",
    "start": "3251000",
    "end": "3257559"
  },
  {
    "text": "router uh okay so miss fwz um now the only thing I really want",
    "start": "3257559",
    "end": "3263799"
  },
  {
    "text": "to show you here is that if it receives packets destined to 2222 it rewrites them to the multicast address so it's",
    "start": "3263799",
    "end": "3270720"
  },
  {
    "text": "just a quick",
    "start": "3270720",
    "end": "3273280"
  },
  {
    "text": "hack so like I said before we're going to",
    "start": "3283359",
    "end": "3291078"
  },
  {
    "text": "okay we're going to send a packet from the multicast address us oh sorry",
    "start": "3293359",
    "end": "3300880"
  },
  {
    "text": "UDP to",
    "start": "3309720",
    "end": "3313078"
  },
  {
    "text": "us so you can see that we're we're actually delivering packets to 224001 on",
    "start": "3324200",
    "end": "3329440"
  },
  {
    "text": "the firewall and the responses are coming back now the responses come back",
    "start": "3329440",
    "end": "3334799"
  },
  {
    "text": "from the actual interface of the firewall so what we did to allow the responses come back is the source Port",
    "start": "3334799",
    "end": "3340240"
  },
  {
    "text": "of our SNMP walk is 53 so the responses are destined to us on Port 53 and",
    "start": "3340240",
    "end": "3345960"
  },
  {
    "text": "therefore they're allowed through the rule base so what you basically here you",
    "start": "3345960",
    "end": "3351160"
  },
  {
    "text": "see an attack that works with spoofing protection fully enabled as long as there's a rule that allows you to",
    "start": "3351160",
    "end": "3356880"
  },
  {
    "text": "utilize",
    "start": "3356880",
    "end": "3359279"
  },
  {
    "text": "it okay so these were the layer three attacks and layer four attacks that we",
    "start": "3362680",
    "end": "3368880"
  },
  {
    "text": "mounted against f one so what you saw is um that's quite possible if you don't have spoofing protection um to modify",
    "start": "3368880",
    "end": "3375640"
  },
  {
    "text": "the rule base uh not the rule base but the state of the firewall in a way that allows you to get packets through it that you shouldn't be able to get",
    "start": "3375640",
    "end": "3381359"
  },
  {
    "text": "through so um many people don't have um anti spoofing configure because they say",
    "start": "3381359",
    "end": "3386720"
  },
  {
    "text": "yeah we don't have our services running so we don't need anti spoofing but as you can see anti spoofing is also pivotal to um the Integrity of the",
    "start": "3386720",
    "end": "3393799"
  },
  {
    "text": "internal state of the firewall that is why you definitely should configure anti-spoofing so what else can you do to",
    "start": "3393799",
    "end": "3400559"
  },
  {
    "text": "harden your firewall one installation okay the first thing mainly applies to fire1 version 4.0 as we said before um",
    "start": "3400559",
    "end": "3406720"
  },
  {
    "text": "this is what we have been doing experiments with for quite a while um disable the implicit rules that allow",
    "start": "3406720",
    "end": "3412359"
  },
  {
    "text": "DNS from any to any because like you saw you can if you don't have anti spoofing configured and you can SPO packets",
    "start": "3412359",
    "end": "3418200"
  },
  {
    "text": "coming from DNS packets coming from the internet intranet and then um send replies to the internet and basically",
    "start": "3418200",
    "end": "3423960"
  },
  {
    "text": "access any arbitrary report on any Mach UDP port on on any arbitrary machine in the internet even if it's Network",
    "start": "3423960",
    "end": "3430200"
  },
  {
    "text": "address translated because you can encapsulate packets what we what we saw before disable this um then the F1",
    "start": "3430200",
    "end": "3436480"
  },
  {
    "text": "control connections thing is um also in F1 4.0 um was basically an allow any to",
    "start": "3436480",
    "end": "3442319"
  },
  {
    "text": "Port 256 which is as we have seen before also quite dangerous especially if you don't have an encryption license on that",
    "start": "3442319",
    "end": "3448160"
  },
  {
    "text": "machine so um the last thing is icmp which is normally also enable on for",
    "start": "3448160",
    "end": "3453520"
  },
  {
    "text": "zero machines also enabled from any to any you don't want to have this you want to configure this more restrictively so",
    "start": "3453520",
    "end": "3460319"
  },
  {
    "text": "this is the next point you want restrictive access rules no any sources or destinations you don't want um",
    "start": "3460319",
    "end": "3467400"
  },
  {
    "text": "especially any any sources you don't want basically to uh you don't want to allow uh DNS from any to anybody because",
    "start": "3467400",
    "end": "3475920"
  },
  {
    "text": "if we if somebody else is able to spoof packets then um the these packets will",
    "start": "3475920",
    "end": "3481680"
  },
  {
    "text": "be um parsed and uh the r rule based not the rule based the internal state will be um will be uh changed according to",
    "start": "3481680",
    "end": "3489000"
  },
  {
    "text": "the packets no matter which IP address that comes from so this for example if the anti spoofing for the firewall",
    "start": "3489000",
    "end": "3495160"
  },
  {
    "text": "interface is not uh configured and doesn't work as in our case then you would be able to spoof packets from the",
    "start": "3495160",
    "end": "3500640"
  },
  {
    "text": "firewall because you have an any Source um any destinations as um um I don't I",
    "start": "3500640",
    "end": "3506680"
  },
  {
    "text": "don't know whether we what was the idea behind any destinations I don't remember I don't",
    "start": "3506680",
    "end": "3511880"
  },
  {
    "text": "remember either oh perhaps let's let's get back to that to the destination thing that",
    "start": "3511880",
    "end": "3517000"
  },
  {
    "text": "was something I don't I can't currently think of it so you want to then one of the first rules might be you want to",
    "start": "3517000",
    "end": "3523240"
  },
  {
    "text": "deny broadcast and multic oh yeah the the any destinations um if you go to the internet and say any then um this means",
    "start": "3523240",
    "end": "3531799"
  },
  {
    "text": "that you also have outgoing packets especially to the broadcast addresses to the broadcast address or or to the",
    "start": "3531799",
    "end": "3538039"
  },
  {
    "text": "multicast address that we saw before so you can get reply packets back in to the multicast address which is something you",
    "start": "3538039",
    "end": "3543880"
  },
  {
    "text": "don't want this was the the idea behind the destination addresses I think yeah that was it then you want to deny",
    "start": "3543880",
    "end": "3549440"
  },
  {
    "text": "broadcast and multicast addresses in your rule base you can do that and um basically what you should do is um have",
    "start": "3549440",
    "end": "3555599"
  },
  {
    "text": "a rule base that aderes to the minimal privilege principle so you get want to get the rules as restrictive as possible",
    "start": "3555599",
    "end": "3561559"
  },
  {
    "text": "for example when you want to allow traffic to outside networks then you should just for",
    "start": "3561559",
    "end": "3566640"
  },
  {
    "text": "an a group of all your internal networks and then say not these networks instead of saying any on the outside so you can",
    "start": "3566640",
    "end": "3573799"
  },
  {
    "text": "in addition to that you could put into this group you could put the um more multic addresses 224 class D and E",
    "start": "3573799",
    "end": "3580319"
  },
  {
    "text": "networks um 224 and higher um class D and E like I said you could put that",
    "start": "3580319",
    "end": "3585440"
  },
  {
    "text": "into the group also and then say not and in this way you will be uh those spoofing attacks will not work anymore",
    "start": "3585440",
    "end": "3592319"
  },
  {
    "text": "so you should properly configure the anti spoofing mechanism um that means",
    "start": "3592319",
    "end": "3597359"
  },
  {
    "text": "that yeah you go through um uh through all the interfaces and tell the firewall",
    "start": "3597359",
    "end": "3602680"
  },
  {
    "text": "which networks these interfaces are hooked up to and um which IP addresses it may accept from these networks and",
    "start": "3602680",
    "end": "3611280"
  },
  {
    "text": "which interfaces it mustn't accept um then you might want to fill the protocol",
    "start": "3611280",
    "end": "3616400"
  },
  {
    "text": "94 at your border router if you're not using a SECU remote or if you are using SEC remote with ipsc um let's can for",
    "start": "3616400",
    "end": "3623319"
  },
  {
    "text": "example also be done using IP filter there was a posting um on the internet what was it the posting was it it wasn't bu trick was it",
    "start": "3623319",
    "end": "3631760"
  },
  {
    "text": "um they do it with IP filter they have a Solaris box and they have 51 on it and they use IP filter and um Darren Reed",
    "start": "3631760",
    "end": "3638720"
  },
  {
    "text": "said has has has no signature that says um IP filter protecting 51 from the",
    "start": "3638720",
    "end": "3643799"
  },
  {
    "text": "internet um it's a bit it's a bit mean but um the protocol 94 thing is really",
    "start": "3643799",
    "end": "3649480"
  },
  {
    "text": "something that you should that you should block at um at at your border rout if you're not using SEC mode I think that that Darren Reed uh um",
    "start": "3649480",
    "end": "3656280"
  },
  {
    "text": "signature was was due to the fragmentation thing that um that happened to to to to firewall one um",
    "start": "3656280",
    "end": "3663559"
  },
  {
    "text": "yeah what is interesting to to all those denial of St attacks by the way that um are happening have been happen happening",
    "start": "3663559",
    "end": "3669160"
  },
  {
    "text": "to fir1 um these attacks are based on logging so um as we saw before you have",
    "start": "3669160",
    "end": "3675319"
  },
  {
    "text": "the pre-inspect before it's passed to the virtual machine and the virtual machine thing it logs to the lock server",
    "start": "3675319",
    "end": "3681039"
  },
  {
    "text": "but the pre-inspect code mainly most of the things in there the Integrity checks are locked locally",
    "start": "3681039",
    "end": "3686640"
  },
  {
    "text": "to the local Z log so if you have a lot of logs then you get the load of the",
    "start": "3686640",
    "end": "3691880"
  },
  {
    "text": "firewall quite high and you will have a deny of service condition and all these deny of service attacks the",
    "start": "3691880",
    "end": "3696920"
  },
  {
    "text": "fragmentation thing and then there was an IP spoofing thing that um also was uh",
    "start": "3696920",
    "end": "3702160"
  },
  {
    "text": "could could lead to denial of service conditions both of these were exactly related to this logging thing so you generate this log messages and in this",
    "start": "3702160",
    "end": "3709359"
  },
  {
    "text": "way since the rate is not restricted you get a very high load on the firewall and um your firewall doesn't um doesn't",
    "start": "3709359",
    "end": "3716079"
  },
  {
    "text": "accept packets anymore so these are the hardening things um the first slide at least we",
    "start": "3716079",
    "end": "3722960"
  },
  {
    "text": "have a second slide on hardening firewall one one nice idea that you",
    "start": "3722960",
    "end": "3728359"
  },
  {
    "text": "might want to implement is that if you have a DMZ for example a DMZ um with",
    "start": "3728359",
    "end": "3733960"
  },
  {
    "text": "different servers with a web server with an FTP server we have shown that with the FTP protocol it might be able to you",
    "start": "3733960",
    "end": "3739680"
  },
  {
    "text": "might be an attacker might be able to open up ports to open up ports that he normally doesn't have access to um",
    "start": "3739680",
    "end": "3747279"
  },
  {
    "text": "but the ports are only opened for the IP address that the server resides on so",
    "start": "3747279",
    "end": "3753359"
  },
  {
    "text": "imagine a world or a DMZ in which every service is bound to a different IP address that's what we do in our DMZ we",
    "start": "3753359",
    "end": "3759760"
  },
  {
    "text": "have like an FTP server and the web server and the web server is bound to IP address one and the FTP server is bound",
    "start": "3759760",
    "end": "3766880"
  },
  {
    "text": "to IP address 2 and nothing but the web server bound to IP address one and nothing but the web servers bound to IP",
    "start": "3766880",
    "end": "3772599"
  },
  {
    "text": "address two so let people open ports there's nothing to find there so you might be um um you might you might want",
    "start": "3772599",
    "end": "3779920"
  },
  {
    "text": "to implement this just configure virtual interfaces and bind only the FTP server",
    "start": "3779920",
    "end": "3785200"
  },
  {
    "text": "to a certain address and nothing else for example that might be a nice idea to which can be implemented without um",
    "start": "3785200",
    "end": "3792039"
  },
  {
    "text": "going through too much efforts then the other thing is you want to restrict control connections of course you want",
    "start": "3792039",
    "end": "3797119"
  },
  {
    "text": "to use fw1 authentication which by now with 4.1 is the default and you don't need an encryption license anymore um",
    "start": "3797119",
    "end": "3804760"
  },
  {
    "text": "use perhaps even VPN technology in order to have the U Management console communicate with um the firewall module",
    "start": "3804760",
    "end": "3812799"
  },
  {
    "text": "you might want to um use tunneling IP SEC or whatever if you have the corresponding license and of course for",
    "start": "3812799",
    "end": "3819200"
  },
  {
    "text": "control connection you should never ever use 127 001 colon ASN because this um is",
    "start": "3819200",
    "end": "3826760"
  },
  {
    "text": "not does not make sure that the connections are only coming from Local Host but everybody can say I am Local Host and will not have to authenticate",
    "start": "3826760",
    "end": "3833799"
  },
  {
    "text": "himself when establishing control connections yeah and what you finally want is probably more than one line of",
    "start": "3833799",
    "end": "3841000"
  },
  {
    "text": "defense um we have seen installations that have like one firewall one or in",
    "start": "3841000",
    "end": "3846240"
  },
  {
    "text": "general just one firewall with 16 or 20 interfaces and this is the only point of",
    "start": "3846240",
    "end": "3852359"
  },
  {
    "text": "Defense so if there's an implementation error in there and we've been talking",
    "start": "3852359",
    "end": "3857400"
  },
  {
    "text": "about configuration errors and implementation errors and um although we have been showing quite some things um",
    "start": "3857400",
    "end": "3863880"
  },
  {
    "text": "this doesn't mean that firewall one is a bad firewall because it just means that we up to now only had the time to look",
    "start": "3863880",
    "end": "3870319"
  },
  {
    "text": "at firewall one so next year this there might be the same things just with other",
    "start": "3870319",
    "end": "3876720"
  },
  {
    "text": "firewalls so um like we have seen before we have seen um that those attacks can",
    "start": "3876720",
    "end": "3882559"
  },
  {
    "text": "be classified so it's quite likely that some of the attacks also apply to other firewalls in slightly different ways",
    "start": "3882559",
    "end": "3888920"
  },
  {
    "text": "perhaps but they might even apply to other firewalls like we saw before the FTP ozone ozone thing it was even worse",
    "start": "3888920",
    "end": "3895359"
  },
  {
    "text": "although we discovered it for firewall one it was even worse for Cisco Pig for example",
    "start": "3895359",
    "end": "3901279"
  },
  {
    "text": "so it it's not it's not a sign that fire War one is bad it has implementation",
    "start": "3901279",
    "end": "3906440"
  },
  {
    "text": "errors of course but implementation errors are in almost any product or in basically definitely any product so um",
    "start": "3906440",
    "end": "3914400"
  },
  {
    "text": "we want more line of defense because if you have two lines of Defense you have especially if you have two lines of",
    "start": "3914400",
    "end": "3919480"
  },
  {
    "text": "Defense constructed by different vendors you have a certain chance that mistakes",
    "start": "3919480",
    "end": "3924839"
  },
  {
    "text": "that one vendor made are not repeated by the second vendor and the other way around so that's a lesson that can be",
    "start": "3924839",
    "end": "3930480"
  },
  {
    "text": "learned from what we've seen now use more lines of Defense especially if you use those lines of Defense um from",
    "start": "3930480",
    "end": "3936599"
  },
  {
    "text": "different vendors so like I said before um we didn't even have to approach checkpoint",
    "start": "3936599",
    "end": "3942799"
  },
  {
    "text": "but checkpoint learned that we are giving a speech here and they approached us four weeks before uh the whole thing",
    "start": "3942799",
    "end": "3948760"
  },
  {
    "text": "here happened and they cooperated very closely with us they were pretty responsive and we had a phone conference",
    "start": "3948760",
    "end": "3954440"
  },
  {
    "text": "with their technical staff and so on and we have learned that um they have made available fixes for the problems shown",
    "start": "3954440",
    "end": "3961440"
  },
  {
    "text": "today on www. checkpoint.com tech support and",
    "start": "3961440",
    "end": "3967240"
  },
  {
    "text": "um uh yeah we haven't had the chance to look at this um but um at www.",
    "start": "3967240",
    "end": "3973079"
  },
  {
    "text": "checkpoint.com tech support um the latest fixes can be downloaded so this",
    "start": "3973079",
    "end": "3979960"
  },
  {
    "text": "is the end of our presentation wait forgot one thing buffer overflow",
    "start": "3979960",
    "end": "3985880"
  },
  {
    "text": "the buffer overflow yeah do we have a slide for that no no it's not really that cool no",
    "start": "3985880",
    "end": "3992000"
  },
  {
    "text": "it's just yeah okay all",
    "start": "3992000",
    "end": "3999039"
  },
  {
    "text": "right so what I'm going to do is um there's some uh publicly available ports",
    "start": "3999039",
    "end": "4006359"
  },
  {
    "text": "even on the latest version that allow you to run just a couple commands and we were playing around with it and we ran",
    "start": "4006359",
    "end": "4012559"
  },
  {
    "text": "into a buffer overflow in one of the commands now it there's um it's just",
    "start": "4012559",
    "end": "4019240"
  },
  {
    "text": "like what's that okay it's just like um basically it's it's it would be",
    "start": "4019240",
    "end": "4025880"
  },
  {
    "text": "extremely difficult to exploit what happens is it takes your input it",
    "start": "4025880",
    "end": "4031559"
  },
  {
    "text": "concatenates something to it and then does writes it over variable on the stack but right before the function",
    "start": "4031559",
    "end": "4036960"
  },
  {
    "text": "exits it checks one of its arguments so there's no way you can overwrite the IP or anything important without the",
    "start": "4036960",
    "end": "4042920"
  },
  {
    "text": "concatenated stuff messing up that argument and it's checking if the argument is zero so there's nothing you",
    "start": "4042920",
    "end": "4048079"
  },
  {
    "text": "can really do the only thing we came up with is you could overwrite the LSB of the save base pter with zero but um I",
    "start": "4048079",
    "end": "4055079"
  },
  {
    "text": "play with that a while on version three was actually maybe you could do that with like a 20% chance of it working but",
    "start": "4055079",
    "end": "4060559"
  },
  {
    "text": "on version four you have to sanitize the stack a bit too much for it to be a plausible attack but it does work on the",
    "start": "4060559",
    "end": "4067319"
  },
  {
    "text": "latest version and the only really thing you can do with it now as a denial service on the firewall demon so I should I can show you that real",
    "start": "4067319",
    "end": "4074440"
  },
  {
    "text": "quick",
    "start": "4074440",
    "end": "4077440"
  },
  {
    "text": "that",
    "start": "4104440",
    "end": "4107440"
  },
  {
    "text": "is",
    "start": "4113799",
    "end": "4116119"
  },
  {
    "text": "working better",
    "start": "4128719",
    "end": "4132600"
  },
  {
    "text": "okay",
    "start": "4134440",
    "end": "4137440"
  },
  {
    "text": "I don't",
    "start": "4147120",
    "end": "4149400"
  },
  {
    "text": "remember there you go so you can see here what happened is that function",
    "start": "4156319",
    "end": "4161798"
  },
  {
    "text": "checked its arguments and it saw that they were messed up and then it did it killed itself now what's cool is it says",
    "start": "4161799",
    "end": "4168000"
  },
  {
    "text": "filter uninstalled which would be nice but it doesn't really uninstall it so all you can really",
    "start": "4168000",
    "end": "4175040"
  },
  {
    "text": "do yeah we were pretty happy when we saw that but um so all you can really do is kill",
    "start": "4175040",
    "end": "4181000"
  },
  {
    "text": "the firewall demon which could be a pain okay but now we have finally come",
    "start": "4181000",
    "end": "4187318"
  },
  {
    "text": "to the end of our presentation I would like to thank you for your",
    "start": "4187319",
    "end": "4192079"
  },
  {
    "text": "attention",
    "start": "4194320",
    "end": "4197320"
  },
  {
    "text": "are there any",
    "start": "4208280",
    "end": "4211039"
  },
  {
    "text": "questions",
    "start": "4215960",
    "end": "4218960"
  },
  {
    "text": "pleas yes please wa I'll come just come to you with the",
    "start": "4223000",
    "end": "4231239"
  },
  {
    "text": "microphone Jerry Springer style um was SNMP by default on on the firewall one",
    "start": "4232280",
    "end": "4240040"
  },
  {
    "text": "um um yeah the question was whether um uh SNMP was by default on on the FP 440",
    "start": "4240159",
    "end": "4246159"
  },
  {
    "text": "yeah SN the SNMP demon is running by default and on on SOL letters it's normally running as well that's why we",
    "start": "4246159",
    "end": "4252920"
  },
  {
    "text": "were able to to exploit it and um all we had to do is open the corresponding port on the firewall in order to access it",
    "start": "4252920",
    "end": "4259320"
  },
  {
    "text": "but it's normally running yeah people don't Harden their firewalls because it's yeah it's nice",
    "start": "4259320",
    "end": "4264360"
  },
  {
    "text": "because then you can only if you want to have the interfaces of um of the firewall you just click on get and it's",
    "start": "4264360",
    "end": "4270080"
  },
  {
    "text": "Nic to administer that's why people have it running hi nice to meet you hey how's it",
    "start": "4270080",
    "end": "4278320"
  },
  {
    "text": "going um yeah we run it as a Honeypot system thank",
    "start": "4278320",
    "end": "4284120"
  },
  {
    "text": "you oh um oh",
    "start": "4284239",
    "end": "4291920"
  },
  {
    "text": "yeah I think so yeah",
    "start": "4292560",
    "end": "4299800"
  }
]