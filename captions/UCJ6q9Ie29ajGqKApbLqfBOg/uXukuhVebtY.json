[
  {
    "start": "0",
    "end": "21000"
  },
  {
    "text": "last Talk of the day man I hope you guys stay awake uh I hope you've had plenty",
    "start": "199",
    "end": "5799"
  },
  {
    "text": "of coffee uh and you're not drunk already just think about the goal man we're going to talk about some cool",
    "start": "5799",
    "end": "11519"
  },
  {
    "text": "stuff hopefully you'll find it interesting but after this plenty of drinks you can like get hung over do all",
    "start": "11519",
    "end": "17760"
  },
  {
    "text": "this good stuff so stick in there with me man stick in there if you uh so my name is Brad antonowicz I work for a",
    "start": "17760",
    "end": "24039"
  },
  {
    "start": "21000",
    "end": "77000"
  },
  {
    "text": "company called foundstone we are um we do all that strategic tactical uh",
    "start": "24039",
    "end": "30240"
  },
  {
    "text": "security Consulting you know all that stuff from uh you know embedded device control system penetration testing to",
    "start": "30240",
    "end": "36559"
  },
  {
    "text": "maturity assessments policy reviews all that good stuff um and also incident",
    "start": "36559",
    "end": "41640"
  },
  {
    "text": "response we're part of a bigger Cloud called McAfee uh which is part of even",
    "start": "41640",
    "end": "47199"
  },
  {
    "text": "bigger Cloud called Intel and uh and I do some research uh for the team there",
    "start": "47199",
    "end": "52960"
  },
  {
    "text": "uh so what I'm going to talk about is some of the research that I've been working on around 802.1x um I'd say the research is about",
    "start": "52960",
    "end": "60840"
  },
  {
    "text": "I don't know maybe 80% complete it's it's almost there it's pretty far along I've done some good work and so",
    "start": "60840",
    "end": "66760"
  },
  {
    "text": "hopefully you guys will like it uh I'm also an Adjunct professor at NYU poly I teach vulnerability analysis",
    "start": "66760",
    "end": "71920"
  },
  {
    "text": "exploitation uh and say authored some books and that kind of stuff so um yeah I hope you'll like everything so our",
    "start": "71920",
    "end": "78520"
  },
  {
    "start": "77000",
    "end": "114000"
  },
  {
    "text": "agenda for today what are we going to talk about first of all uh if you don't know anything about 802.1x uh we're going to give you a",
    "start": "78520",
    "end": "84920"
  },
  {
    "text": "little bit of a primer into it we'll tell you how it works what's going on with it all that good stuff and then from from there we'll talk about some of",
    "start": "84920",
    "end": "90960"
  },
  {
    "text": "the attacks that are going on nowadays uh that a lot of people have been looking at and sort of the established",
    "start": "90960",
    "end": "96040"
  },
  {
    "text": "ones we'll introduce some updated tools to to help out with those attacks and then really the what what I really care",
    "start": "96040",
    "end": "102600"
  },
  {
    "text": "about the most and what I've been really working on is fuzzing uh all of this stuff uh and so uh I'll I'll give you",
    "start": "102600",
    "end": "109000"
  },
  {
    "text": "some cool fuzzing tools and uh help you guys find some vulnerabilities so hopefully uh everybody will love it so",
    "start": "109000",
    "end": "115520"
  },
  {
    "start": "114000",
    "end": "324000"
  },
  {
    "text": "by show of hands how many of you guys actually know what 802.1x is",
    "start": "115520",
    "end": "120880"
  },
  {
    "text": "yes awesome I was hoping there wasn't going to be everybody who thought like oh 802.11 everybody always confuses that",
    "start": "120880",
    "end": "127360"
  },
  {
    "text": "because there's a one and both of them and I don't know uh so good so I'm glad most of you guys know what it is if you",
    "start": "127360",
    "end": "132760"
  },
  {
    "text": "don't know what it is it's basically a standard that defines uh how computers do port-based access control right um or",
    "start": "132760",
    "end": "140200"
  },
  {
    "text": "network access control so essentially the idea is in in most cases not all cases but in most cases uh 802.1x",
    "start": "140200",
    "end": "148280"
  },
  {
    "text": "defines How can a user join a network and be authorized to join that network",
    "start": "148280",
    "end": "154680"
  },
  {
    "text": "uh before they get an IP address so how can you sort of authenticate that user and so that's what we're really talking",
    "start": "154680",
    "end": "159920"
  },
  {
    "text": "about today um it's used in a couple of different areas the standard defines three different roles uh starting from",
    "start": "159920",
    "end": "167760"
  },
  {
    "text": "the right there's the supplicant right and this is your client or whatever there's a authenticator the",
    "start": "167760",
    "end": "174360"
  },
  {
    "text": "authenticator is what allows access onto the network but doesn't have the brains",
    "start": "174360",
    "end": "179480"
  },
  {
    "text": "to say this user is actually authenticated who does have the brains is the authentication server all the way",
    "start": "179480",
    "end": "185560"
  },
  {
    "text": "on the left so this authentication server is the one uh that really uh can can tell the authenticator whether or",
    "start": "185560",
    "end": "192159"
  },
  {
    "text": "not to allow access onto the network and this is usually a radius server something along those lines now in",
    "start": "192159",
    "end": "200080"
  },
  {
    "text": "802.11 there's some sort of interesting things that can happen right so",
    "start": "200080",
    "end": "205519"
  },
  {
    "text": "everything between the authenticator uh in A2 and the Authenticator is really an access point or Frankie munz here um and",
    "start": "205519",
    "end": "213519"
  },
  {
    "text": "so the access point speaks wirelessly to the client okay and now there's a",
    "start": "213519",
    "end": "219439"
  },
  {
    "text": "wireless communication that happens and then on the back end between the access point and the radio server uh there's",
    "start": "219439",
    "end": "225879"
  },
  {
    "text": "sort of this other communication on the wired side that facilitates that communication back and forth Now with uh",
    "start": "225879",
    "end": "232519"
  },
  {
    "text": "sort of standard ethernet uh the authenticator changes a little bit uh so",
    "start": "232519",
    "end": "238239"
  },
  {
    "text": "the authenticator is ESS your standard network switch um this uh has a wired",
    "start": "238239",
    "end": "244840"
  },
  {
    "text": "connection uh to the supplicant and this fact it might be a laptop or anything plugged physically into the switch and",
    "start": "244840",
    "end": "251680"
  },
  {
    "text": "then there's still an 802.1x communication that happens between them and then a same radius sort of",
    "start": "251680",
    "end": "257320"
  },
  {
    "text": "communication that happens uh between the authenticator and and the radio server so sort of similar the difference",
    "start": "257320",
    "end": "263280"
  },
  {
    "text": "is one has wires one doesn't now what was also pretty",
    "start": "263280",
    "end": "269000"
  },
  {
    "text": "interesting in to me about all this is so I've been doing Wireless for a little bit now and what was always interesting",
    "start": "269000",
    "end": "274400"
  },
  {
    "text": "about to me is there is this clear demarcation point between the sort of an",
    "start": "274400",
    "end": "279919"
  },
  {
    "text": "untrusted environment right between the client and the access point and then a totally trusted environment and the way",
    "start": "279919",
    "end": "286919"
  },
  {
    "text": "that 1X works is that data from the client is being sent all the way into",
    "start": "286919",
    "end": "292360"
  },
  {
    "text": "the untrusted environment um through the the authenticator through through that",
    "start": "292360",
    "end": "297440"
  },
  {
    "text": "middle piece whether it be an AP or switch and that's data is being sent back and forth and it can there could be a lot of data that goes back and forth",
    "start": "297440",
    "end": "303800"
  },
  {
    "text": "between that and so that was always really interesting to me you know you have this completely untrusted source and they can send all types of data to a",
    "start": "303800",
    "end": "311280"
  },
  {
    "text": "really really trusted Source right like your authenticator your authentication server uh sometimes has active directory",
    "start": "311280",
    "end": "317560"
  },
  {
    "text": "integration it could be you know on the domain it can have some pretty serious accounts on there uh so it was sort of",
    "start": "317560",
    "end": "323199"
  },
  {
    "text": "it's sort of interesting to me so what I started to do was initially when I was sort of creating a lab to do some of",
    "start": "323199",
    "end": "330120"
  },
  {
    "start": "324000",
    "end": "556000"
  },
  {
    "text": "this research what I did was is um I had like a a actual laptop with a wireless",
    "start": "330120",
    "end": "336720"
  },
  {
    "text": "client and then an actual AP and then an actual uh server and then they were all",
    "start": "336720",
    "end": "342199"
  },
  {
    "text": "actually set up it was a real situation but I realized I didn't have to do any of that because that was just a big",
    "start": "342199",
    "end": "347360"
  },
  {
    "text": "waste of time uh what I could do is simulate the entire environment within within VMS right so it's pretty easy to",
    "start": "347360",
    "end": "352840"
  },
  {
    "text": "do so what I did what I have is um I'm targeting the radius server on the back",
    "start": "352840",
    "end": "357919"
  },
  {
    "text": "end and so I have a umuntu VM that's that's pretending to send data to the",
    "start": "357919",
    "end": "363759"
  },
  {
    "text": "radio server uh as it would expect it from the authenticator as it would expect from the AP or the switch and so",
    "start": "363759",
    "end": "370960"
  },
  {
    "text": "I started to play around with this I'll show kind of show you what I started to do um so here is an admittedly old",
    "start": "370960",
    "end": "376880"
  },
  {
    "text": "version of uh Cisco ACS it's 4.2 uh if you're familiar with it it is actually on an end of life track um but it's uh",
    "start": "376880",
    "end": "384440"
  },
  {
    "text": "what really got me interested about eight months ago I started to play around with this I had a copy of Cisco ACS 4.2 and so I started to play around",
    "start": "384440",
    "end": "391400"
  },
  {
    "text": "with it so if you notice here I got I have this going and if you look on the",
    "start": "391400",
    "end": "396720"
  },
  {
    "text": "bottom there's this CS off. exe and that's running there and that's just sort of running hanging out and I",
    "start": "396720",
    "end": "402440"
  },
  {
    "text": "started to play around with this now in the foreground here is my own buntu system it's just in a different tab here",
    "start": "402440",
    "end": "407520"
  },
  {
    "text": "in my VMware system and if we look over here uh let me just clear all this out",
    "start": "407520",
    "end": "413319"
  },
  {
    "text": "um I have an SSH window in the foreground that's that's connected to my own bun two system so I started to play around with this are you guys WPA",
    "start": "413319",
    "end": "420879"
  },
  {
    "text": "supplicant yeah so WPA supplicant if you haven't haven't played play around with it at all it's basically a Linux uh",
    "start": "420879",
    "end": "427560"
  },
  {
    "text": "supplicant it's used it can be used for Wired uh 802.1x authentication and wireless authentication and the way that",
    "start": "427560",
    "end": "433879"
  },
  {
    "text": "you configure it is through a configuration file and it's just called uh you can name it whatever you want I",
    "start": "433879",
    "end": "439560"
  },
  {
    "text": "have this one named ep.com and it's a pretty straightforward configuration file you can sort of see everything that's in there and so I was playing",
    "start": "439560",
    "end": "445720"
  },
  {
    "text": "around with this and I was like all right well I want to try to hack stuff I hear you know uh A's are good characters",
    "start": "445720",
    "end": "450879"
  },
  {
    "text": "let's see what happens so I put in a bunch of A's and I'm like all right that's cool I can do a bunch of these in",
    "start": "450879",
    "end": "456280"
  },
  {
    "text": "there but what happens if I I don't know man maybe I'll just get a little weird with it and I'll just paste these in",
    "start": "456280",
    "end": "461560"
  },
  {
    "text": "here A whole bunch of times so I just paste like a whole bunch of them in there see what happens um and then uh",
    "start": "461560",
    "end": "467440"
  },
  {
    "text": "what I did was I wrote this uh this script that basically wraps around a tool called EPO Overland test and that",
    "start": "467440",
    "end": "473639"
  },
  {
    "text": "really does um pretends it communicates via radius to the authentication server",
    "start": "473639",
    "end": "478720"
  },
  {
    "text": "and so everything I'm sending is going to be encapsulated within radius going over it so it's sort of like it's coming right from the access point so I have",
    "start": "478720",
    "end": "486199"
  },
  {
    "text": "this script set up so I don't have to do all this crazy typing and stuff it sucks",
    "start": "486199",
    "end": "491360"
  },
  {
    "text": "to do just learning how to do that and so I sent this and if you look in the background you might have missed it that",
    "start": "491360",
    "end": "497759"
  },
  {
    "text": "CS a.exe just sort of disappeared right I was like what man where where did it",
    "start": "497759",
    "end": "503319"
  },
  {
    "text": "go right like what how did these processes just disappear like this sort of weird so what I did was uh I started",
    "start": "503319",
    "end": "510000"
  },
  {
    "text": "to look at it and I was like all right man you know what I need to do I got to figure out what's going on I got to use this debugger here let me jump on that",
    "start": "510000",
    "end": "515240"
  },
  {
    "text": "I'll attach my debugger tell it to go we'll jump back over and we'll send the same thing see maybe if we could figure out why this process keeps crashing and",
    "start": "515240",
    "end": "522839"
  },
  {
    "text": "so I looked and very early on I noticed that and I was like oh crap man I need",
    "start": "522839",
    "end": "529120"
  },
  {
    "text": "to start researching this whole area cuz that's uh it's interesting I don't know",
    "start": "529120",
    "end": "535399"
  },
  {
    "text": "how those A's somehow got somewhere so uh so I was sort of interested in that so that's really what spawned about you",
    "start": "535399",
    "end": "541839"
  },
  {
    "text": "know eight months ago that really is something that got me interested in this whole topic I was like oh man I need to",
    "start": "541839",
    "end": "547120"
  },
  {
    "text": "start you know see if I could fuzz it let's try to find some more vulnerabilities that are like amazing like that right like since 1999 type",
    "start": "547120",
    "end": "555200"
  },
  {
    "text": "stuff it's amazing so uh so I started to look into it so I was like all right let's let's start diving into this um",
    "start": "555200",
    "end": "560519"
  },
  {
    "start": "556000",
    "end": "648000"
  },
  {
    "text": "and so if you know anything about A2 i1x uh what really at the core of",
    "start": "560519",
    "end": "566120"
  },
  {
    "text": "802.1x is uh something called EP uh is extensible Authentication Protocol and",
    "start": "566120",
    "end": "572560"
  },
  {
    "text": "what this protocol does is it's a really basic very simple protocol it has a",
    "start": "572560",
    "end": "578360"
  },
  {
    "text": "request a response a success and a failure right really simple messages and",
    "start": "578360",
    "end": "584079"
  },
  {
    "text": "on top of those requests and response successes and failures you can have other EP types things like peep or EP",
    "start": "584079",
    "end": "590320"
  },
  {
    "text": "ttls EP md5 there's just absolute ton of those and those messages get sent back",
    "start": "590320",
    "end": "595519"
  },
  {
    "text": "and forth and if the authentication Ser or if the authenticator ever gets an EP success that then that's what actually",
    "start": "595519",
    "end": "602160"
  },
  {
    "text": "tells the uh AP or the uh switch to sort of allow it to connect to the network so",
    "start": "602160",
    "end": "607839"
  },
  {
    "text": "EP is a pretty F ingrained um what happens between the the client and say",
    "start": "607839",
    "end": "614360"
  },
  {
    "text": "the access point or the the switch is this e data gets sent by the client it",
    "start": "614360",
    "end": "619680"
  },
  {
    "text": "gets created and then gets encapsulated with 0 within 802 1X and sent over to",
    "start": "619680",
    "end": "624959"
  },
  {
    "text": "the authentication server now further within that e packet is again that's",
    "start": "624959",
    "end": "630040"
  },
  {
    "text": "where you see all of those EP type data uh so there's a couple of layers of encapsulation that goes on now once that",
    "start": "630040",
    "end": "637040"
  },
  {
    "text": "EP packet comes from the the client to the authentication server um then",
    "start": "637040",
    "end": "642440"
  },
  {
    "text": "something sort of interesting happens the access point or the authentication oh there's the dolly Lama I don't know",
    "start": "642440",
    "end": "648560"
  },
  {
    "start": "648000",
    "end": "667000"
  },
  {
    "text": "anyway so uh within that there's sort of this decapsulation that happens between",
    "start": "648560",
    "end": "654079"
  },
  {
    "text": "on the access point so the access point uh decapsulates its data from 1X",
    "start": "654079",
    "end": "659760"
  },
  {
    "text": "put re-encapsulated it within radius and then passes it over for the radius server to sort of process and",
    "start": "659760",
    "end": "666560"
  },
  {
    "text": "understand uh so radius let's talk a little bit about that if you're not familiar with radius uh radius is a",
    "start": "666560",
    "end": "672760"
  },
  {
    "start": "667000",
    "end": "733000"
  },
  {
    "text": "pretty established protocol it's been used in a lot of things it's used in uh in 802.1x networks for for uh sort of",
    "start": "672760",
    "end": "679519"
  },
  {
    "text": "that backend communication but it's also used in like DSL and dialup uh setups to",
    "start": "679519",
    "end": "685560"
  },
  {
    "text": "help your I don't know grandparents get on the internet whatever I don't know whatever they use uh and then it also helps like you know high school kids use",
    "start": "685560",
    "end": "693920"
  },
  {
    "text": "Torance and download those an anonymously through VPN uh so radius is",
    "start": "693920",
    "end": "699240"
  },
  {
    "text": "is pretty established and it's used on the back end for a lot of authentication mechanisms and and protocols so it's",
    "start": "699240",
    "end": "704320"
  },
  {
    "text": "been around for a while um and so that was sort of interesting to me too because there was sort of this extra",
    "start": "704320",
    "end": "710040"
  },
  {
    "text": "layer of uh encapsulation and complexity that could be sort of interesting now I",
    "start": "710040",
    "end": "715560"
  },
  {
    "text": "mentioned this a little bit but I want to underscore it a little bit that the radius server although it can be",
    "start": "715560",
    "end": "721440"
  },
  {
    "text": "self-contained it can also relate back to a database of some sort so again this could be active directory it could be uh",
    "start": "721440",
    "end": "728320"
  },
  {
    "text": "you know if you have secure ID any any of that kind of stuff there could be an active uh connection there so if we",
    "start": "728320",
    "end": "734600"
  },
  {
    "start": "733000",
    "end": "860000"
  },
  {
    "text": "start to sort of put all this together and think about all right if I want to hack this stuff right I need to",
    "start": "734600",
    "end": "740760"
  },
  {
    "text": "understand it's a tax surface so let's look at the overall attx surface that's that's invol involved so first and",
    "start": "740760",
    "end": "748440"
  },
  {
    "text": "foremost I like to think about attack surfaces in in three different ways especially in this area right we have",
    "start": "748440",
    "end": "754560"
  },
  {
    "text": "kind of the the protocol level vulnerabilities vulnerabilities and the protocols that you know the guys",
    "start": "754560",
    "end": "759680"
  },
  {
    "text": "designing it didn't think about something right and they designed it everybody implemented it and they messed it up right so there's those protocol",
    "start": "759680",
    "end": "765760"
  },
  {
    "text": "level vulnerabilities and then there's also kind of configuration related vulnerabilities where I don't know sis",
    "start": "765760",
    "end": "771040"
  },
  {
    "text": "and Men screwed up they've check the wrong box they click the wrong button type the wrong command and they screwed",
    "start": "771040",
    "end": "777519"
  },
  {
    "text": "something up and that can make you know whole thing vulnerable to attack somehow and then there's to me the more",
    "start": "777519",
    "end": "783680"
  },
  {
    "text": "interesting things and those are sort of the handling issues these are sort of software implementation flaws in which",
    "start": "783680",
    "end": "789440"
  },
  {
    "text": "the developer who's handling the data coming from whomever uh wrote it wrong and it could lead to memory corruption",
    "start": "789440",
    "end": "795360"
  },
  {
    "text": "and all that kind of stuff so if you think about the layers of encapsulation and sort of the complexity that happens",
    "start": "795360",
    "end": "801760"
  },
  {
    "text": "you have e 802.1x radius and then on the top end you have some external uh",
    "start": "801760",
    "end": "807399"
  },
  {
    "text": "authentication handlers so there's a lot of stuff that could go wrong here there's a lot of layers of complexity",
    "start": "807399",
    "end": "812480"
  },
  {
    "text": "that you could play around with and then on top of it to add even more complexity to it there's all of these web uis",
    "start": "812480",
    "end": "818399"
  },
  {
    "text": "everywhere right so you have to think about okay well some of my data that I",
    "start": "818399",
    "end": "823680"
  },
  {
    "text": "send uh from a completely unauthenticated wireless client may end up in a web UI somewhere and so one of",
    "start": "823680",
    "end": "831079"
  },
  {
    "text": "the vulnerabilities we found was a SQL injection vulnerability that if you send a packet as an unauthenticated Wireless",
    "start": "831079",
    "end": "837519"
  },
  {
    "text": "client it will land up a log and it's a little convoluted but a a admin would",
    "start": "837519",
    "end": "843639"
  },
  {
    "text": "have to click that log entry and by that admin clicking that log entry they would uh initiate a SQL injection uh sort of",
    "start": "843639",
    "end": "850720"
  },
  {
    "text": "attack and that could do a couple of different things there uh so there are a lot of cool things that you can do but",
    "start": "850720",
    "end": "857040"
  },
  {
    "text": "you have to sort of take take those into consideration when you're dealing with the attack surface all right let's talk",
    "start": "857040",
    "end": "862800"
  },
  {
    "start": "860000",
    "end": "972000"
  },
  {
    "text": "about some of the the known attacks that are out there um and some of the things",
    "start": "862800",
    "end": "867959"
  },
  {
    "text": "that that we've sort of looked so generally the taxs that are established now they focus um a little bit on the",
    "start": "867959",
    "end": "875360"
  },
  {
    "text": "data between the radius server and the authenticator and most but most of them",
    "start": "875360",
    "end": "880920"
  },
  {
    "text": "focus on the data between sort of the authenticator and the client a lot of them Focus specifically on that so the",
    "start": "880920",
    "end": "887639"
  },
  {
    "text": "first one that we'll look at these are sort of protocol level vulnerabilities um it's all around sniffing right I mean",
    "start": "887639",
    "end": "894360"
  },
  {
    "text": "all this stuff is around sniffing there's just data that's being sent back and forth between the radio server it's",
    "start": "894360",
    "end": "899959"
  },
  {
    "text": "sent in the clear and people can capture that and maybe take it offline to start brute forcing it whatever they want to",
    "start": "899959",
    "end": "906160"
  },
  {
    "text": "do um and then there's just data like for instance the EP uh response identities is pretty well known uh that",
    "start": "906160",
    "end": "912360"
  },
  {
    "text": "one uh you send the username the username in the clear and that could happen over the wireless network so",
    "start": "912360",
    "end": "918199"
  },
  {
    "text": "anybody sniffing that can get it sometimes also the domain name's there so you can get a little bit more information that might help you further",
    "start": "918199",
    "end": "924519"
  },
  {
    "text": "attack if you will right so there's some established ones but these are all again protocol type of issues the other type",
    "start": "924519",
    "end": "930720"
  },
  {
    "text": "of issue that's really popular um that's been covered a lot is the impersonation attack so this is more of a",
    "start": "930720",
    "end": "936600"
  },
  {
    "text": "configuration related issue and the idea here is is that the attacker has control",
    "start": "936600",
    "end": "941759"
  },
  {
    "text": "over who what you know the authenticator and can um you know basically convince",
    "start": "941759",
    "end": "948199"
  },
  {
    "text": "the client to connect to them in some way now if if they do that and there's",
    "start": "948199",
    "end": "953920"
  },
  {
    "text": "something like TLS enabled so with Peep and epls uh you can",
    "start": "953920",
    "end": "959600"
  },
  {
    "text": "basically disable the client from validating who they're connecting to you could essentially provide a false",
    "start": "959600",
    "end": "965480"
  },
  {
    "text": "environment for the client to connect to and get maybe the credentials that they send through epls or Peep and so that",
    "start": "965480",
    "end": "972680"
  },
  {
    "start": "972000",
    "end": "1000000"
  },
  {
    "text": "was uh really easily exploitable uh via um 80211 because if you just send out a",
    "start": "972680",
    "end": "980680"
  },
  {
    "text": "stronger signal to any of the access points that are around then than the access point that they're used to connecting well they'll connect to you",
    "start": "980680",
    "end": "987279"
  },
  {
    "text": "and this was uh there's a tool that myself and Josh Wright wrote called free radius WP so this is a cool tool",
    "start": "987279",
    "end": "994360"
  },
  {
    "text": "that it has some down downsides to it though one of the things is that um you have to also have your own access point",
    "start": "994360",
    "end": "1001120"
  },
  {
    "start": "1000000",
    "end": "1107000"
  },
  {
    "text": "so you need to set up an access point that feeds uh into free radius WP so just as part of this conference I uh",
    "start": "1001120",
    "end": "1007560"
  },
  {
    "text": "updated um this uh this other tool I wrote called host apwp it's the same",
    "start": "1007560",
    "end": "1013000"
  },
  {
    "text": "premise it's just a patch for an existing host APD but this does a lot more uh stuff so one you can do the same",
    "start": "1013000",
    "end": "1021040"
  },
  {
    "text": "stuff you can do with free radius because host APD can act as a standalone radius server so you can do all the standard stuff this supports more EP",
    "start": "1021040",
    "end": "1027959"
  },
  {
    "text": "types uh so you can start to attack Eep fast fave zero if you wanted to you just basically set this up and have clients",
    "start": "1027959",
    "end": "1034160"
  },
  {
    "text": "connect on to it uh at the time that that phase zero happens and then uh we also configured it so it'll always",
    "start": "1034160",
    "end": "1040600"
  },
  {
    "text": "return success so if you're trying to uh have a client connect to you uh and you",
    "start": "1040600",
    "end": "1046400"
  },
  {
    "text": "want to establish a connection to a client and maybe do man in the- middle or start to attack the the the client's",
    "start": "1046400",
    "end": "1052440"
  },
  {
    "text": "session in any way um this will no matter what password the client gives you it will just allow it to connect as",
    "start": "1052440",
    "end": "1058480"
  },
  {
    "text": "it dumps the password so that you can connect to the real Wireless uh so it does a couple of cool things like that",
    "start": "1058480",
    "end": "1063559"
  },
  {
    "text": "it'll also request really weak methods first so it'll request uh Pap for it",
    "start": "1063559",
    "end": "1068880"
  },
  {
    "text": "first uh which makes it a little bit easier if they're configured for multiple e types um and then I started to add some other patches I saw from the",
    "start": "1068880",
    "end": "1075080"
  },
  {
    "text": "community so one of the things I I sort of hacked around with is uh I added in um sort of karma style bro uh broadcast",
    "start": "1075080",
    "end": "1082080"
  },
  {
    "text": "probe responses so if a client is probing for any any uh any type of access point this will respond back so",
    "start": "1082080",
    "end": "1089480"
  },
  {
    "text": "it will automatically connect to them and try to get as much data as they can and then the last thing I added to it was um the cupid attack or the heart",
    "start": "1089480",
    "end": "1096440"
  },
  {
    "text": "bleed attack so if the client is vulnerable to heart bleed as they connect in uh this tries to get you know",
    "start": "1096440",
    "end": "1101880"
  },
  {
    "text": "grab some of its memory using the heart blade vulnerability so there's a couple of things I added to that hopefully you guys will find that useful but really at",
    "start": "1101880",
    "end": "1108360"
  },
  {
    "start": "1107000",
    "end": "1141000"
  },
  {
    "text": "the end of the say you know all this stuff is fine and great but where the hell are all the Handler bugs right",
    "start": "1108360",
    "end": "1113760"
  },
  {
    "text": "there's tons of protocol vulnerabilities there's tons of configuration related vulnerabilities but nobody has exploited",
    "start": "1113760",
    "end": "1119360"
  },
  {
    "text": "anything in this area I just don't understand it and so um there's been like a handful of exploits out there or",
    "start": "1119360",
    "end": "1125200"
  },
  {
    "text": "vulnerabilities out there but no exploits and so uh I was sort of pissed off about this um and so I started to",
    "start": "1125200",
    "end": "1131600"
  },
  {
    "text": "say all right well why and to me the reason why is because there was no tools that allowed people to start to look for",
    "start": "1131600",
    "end": "1136919"
  },
  {
    "text": "vulnerabilities in this area and so I decided I was like all right man I'm going to start trying to fuzz the hell out of everything I can I'm just going",
    "start": "1136919",
    "end": "1143520"
  },
  {
    "start": "1141000",
    "end": "1183000"
  },
  {
    "text": "to get silly with it um so what I did was uh I I used Peach fuzzer so um is",
    "start": "1143520",
    "end": "1149919"
  },
  {
    "text": "everybody familiar with peach fuzzer yes no who is not all right I see a couple of nose all right so Peach",
    "start": "1149919",
    "end": "1156240"
  },
  {
    "text": "fuzzer is a pretty decent fuzzer they have a paid for version I'm Not endorsed by them in any way shape or form but",
    "start": "1156240",
    "end": "1161640"
  },
  {
    "text": "they have a paid for version and they have a community version uh the community version is great and also like",
    "start": "1161640",
    "end": "1166960"
  },
  {
    "text": "the guy who made Peach it's like a company now the guy who made Peach responds to every Forum question that",
    "start": "1166960",
    "end": "1174039"
  },
  {
    "text": "you can have on their forums so it's just like awesome you know like the guy's a really good guy so I so I use",
    "start": "1174039",
    "end": "1180039"
  },
  {
    "text": "Peach because I've used it on a number of different projects before it's basically a fuzzer if you're if you haven't messed with it before uh the way",
    "start": "1180039",
    "end": "1185840"
  },
  {
    "start": "1183000",
    "end": "1251000"
  },
  {
    "text": "that it works is it does it uh it takes everything and creates a data model out of it so this is where you would",
    "start": "1185840",
    "end": "1191799"
  },
  {
    "text": "structure what an e packet would look like you would literally draw out what an e packet would look like in XML and",
    "start": "1191799",
    "end": "1198440"
  },
  {
    "text": "then you would feed that down to a publisher the publisher takes it and formats it for Network traffic it'll",
    "start": "1198440",
    "end": "1204799"
  },
  {
    "text": "format it um in this case it's uh the UDP publisher uh so it'll format it",
    "start": "1204799",
    "end": "1209840"
  },
  {
    "text": "encapsulated within UDP and then you can send it out so it's really nice and easy we're going to be targeting to two",
    "start": "1209840",
    "end": "1215080"
  },
  {
    "text": "agents the radius server and also we're going to go back and try to Target the supplicant as well uh and the reason uh",
    "start": "1215080",
    "end": "1221280"
  },
  {
    "text": "we're not targeting the authentication the authenticator uh so not the switch or the AP is because I don't have you",
    "start": "1221280",
    "end": "1227679"
  },
  {
    "text": "don't have a lot of control over that right so the problem is is that usually the switch is some embedded device or",
    "start": "1227679",
    "end": "1232919"
  },
  {
    "text": "the AP is some embedded device and they have all types of backoff algorithms so that if you see uh if it sees you",
    "start": "1232919",
    "end": "1238919"
  },
  {
    "text": "flooding it with data it tries to like you know regulate the speed at which you change send it at and then you can't",
    "start": "1238919",
    "end": "1244919"
  },
  {
    "text": "really fuzz effectively right so I sort of ignored that for now but that's sort of on the to-do list a little bit um all",
    "start": "1244919",
    "end": "1251880"
  },
  {
    "start": "1251000",
    "end": "1326000"
  },
  {
    "text": "right so what I did first and foremost was I just got silly with rfc's I all I",
    "start": "1251880",
    "end": "1257720"
  },
  {
    "text": "kept doing I just found as many different rfc's that I can find I data modeled them all so there's all every EP",
    "start": "1257720",
    "end": "1264440"
  },
  {
    "text": "type almost every EP type that I could think of or I could find is is data modeled out there for you so all you",
    "start": "1264440",
    "end": "1270159"
  },
  {
    "text": "have to do is just grab it it's built in a very modular fashion so um if you have say Ms chap V2 that feeds into another",
    "start": "1270159",
    "end": "1277440"
  },
  {
    "text": "data model that feeds into another data model and then you can use it um so if you need Ms chap V2 for another purpose",
    "start": "1277440",
    "end": "1283400"
  },
  {
    "text": "it's used in a lot of different areas you can just pull that data model out and use it for your own purposes to fuz some other stuff so both of those feed",
    "start": "1283400",
    "end": "1290240"
  },
  {
    "text": "up into a radius or 802.1x data model and then from there uh",
    "start": "1290240",
    "end": "1296480"
  },
  {
    "text": "I I started to discover that a lot of these like radius servers they all act",
    "start": "1296480",
    "end": "1301600"
  },
  {
    "text": "different I don't know what the plan is with that but they all just sort of act respond differently to different",
    "start": "1301600",
    "end": "1306799"
  },
  {
    "text": "requests so I had to create different fuzzers for different um those different uh radio servers that I came across so I",
    "start": "1306799",
    "end": "1313880"
  },
  {
    "text": "had to do all that all of this feeds into um Peach's default UDP publisher so",
    "start": "1313880",
    "end": "1319840"
  },
  {
    "text": "this is all focused on fuzzing kind of the radius side of stuff uh that's Michael catops and then I also created a whole",
    "start": "1319840",
    "end": "1327440"
  },
  {
    "start": "1326000",
    "end": "1412000"
  },
  {
    "text": "bunch of other Publishers so there's some interesting ones like that I that I thought you would need so a lot of times",
    "start": "1327440",
    "end": "1332760"
  },
  {
    "text": "you don't want to like write this huge crazy complex data model and then feed it into the UDP publisher sometimes you",
    "start": "1332760",
    "end": "1339400"
  },
  {
    "text": "just want to fuzz EP and not radius so I created a a radius publisher so you just have the Eep data you send it to the",
    "start": "1339400",
    "end": "1345480"
  },
  {
    "text": "radius publisher it formats it appropriately and sends it out and you can fuzz all of EP on the reverse side",
    "start": "1345480",
    "end": "1350559"
  },
  {
    "text": "if you wanted to fuzz um you know the supplicant you can do that as well uh",
    "start": "1350559",
    "end": "1356080"
  },
  {
    "text": "Peach has um a like sort of an Ethernet publisher or a raw ethernet publisher",
    "start": "1356080",
    "end": "1361360"
  },
  {
    "text": "but I was having some problems with it so I rewrote it so you can do that and then the biggest thing the hardest part",
    "start": "1361360",
    "end": "1366640"
  },
  {
    "text": "about all of this was uh those TLS sessions so with peep uh and Eep ttls",
    "start": "1366640",
    "end": "1372360"
  },
  {
    "text": "and all that those establish the tunnel and you don't care about what happens outside the tunnel you want to you want",
    "start": "1372360",
    "end": "1378080"
  },
  {
    "text": "to start to focus and fuzz everything inside of the tunnel and so um I had to write a bunch of Publishers that",
    "start": "1378080",
    "end": "1383760"
  },
  {
    "text": "actually do all of that they establish those TLS tunnels and get everything ready to go so you can just sort you",
    "start": "1383760",
    "end": "1388840"
  },
  {
    "text": "know sending junk through that tunnel with the hope that something will crash so we get pretty good coverage um the",
    "start": "1388840",
    "end": "1396080"
  },
  {
    "text": "other thing that we do is to account for all those web uis I had to modify some of Peach's code so that it would include",
    "start": "1396080",
    "end": "1402279"
  },
  {
    "text": "ldap injection command injection um you know cross- site scripting SQL injection all of that stuff uh so I modified it",
    "start": "1402279",
    "end": "1409919"
  },
  {
    "text": "string mutator to include all of it too so did a crazy amount of work we get some good coverage though on it um going",
    "start": "1409919",
    "end": "1416559"
  },
  {
    "start": "1412000",
    "end": "1424000"
  },
  {
    "text": "to be releasing it all free free uh don't judge me on my code man it's free stuff don't hate me because of that just",
    "start": "1416559",
    "end": "1422679"
  },
  {
    "text": "trying to be good to the community um and so you'll find some crashes with it man so I don't want to get too specific",
    "start": "1422679",
    "end": "1428799"
  },
  {
    "text": "but I do want to show you this one so this is a newer version of uh Windows running a network policy server and um",
    "start": "1428799",
    "end": "1437240"
  },
  {
    "text": "yeah so I have another script this is just a script to wrap around Peach when you run Peach you have to do a kind of",
    "start": "1437240",
    "end": "1442600"
  },
  {
    "text": "complex command uh so I'm just going to run this this it's asking for my password I won't tell you what that is",
    "start": "1442600",
    "end": "1449400"
  },
  {
    "text": "uh and then uh it's going to initialize Peach and start to fuzz everything and if you pay attention to the background",
    "start": "1449400",
    "end": "1455400"
  },
  {
    "text": "window you'll see that you can get some crashes out of this stuff pretty quick uh so I encourage you guys to download",
    "start": "1455400",
    "end": "1460919"
  },
  {
    "text": "the tools and see what you can find uh because there's um there's some stuff to be found for sure all right so uh let's",
    "start": "1460919",
    "end": "1469120"
  },
  {
    "text": "talk a little bit about how I how how to enable all this so I'll pull this",
    "start": "1469120",
    "end": "1474200"
  },
  {
    "start": "1474000",
    "end": "1555000"
  },
  {
    "text": "up um all right so some of the tools there were some existing tools that were already out there tools libraries all",
    "start": "1474200",
    "end": "1480320"
  },
  {
    "text": "that kind of good stuff um there's lib EP and P radius and both of those are good uh if you need to craft uh e",
    "start": "1480320",
    "end": "1487200"
  },
  {
    "text": "packets uh but there wasn't anything so the part of the difficulty with peaches is that it's written all in C it has a",
    "start": "1487200",
    "end": "1494159"
  },
  {
    "text": "lot of python extensions that make life a little bit easier but I really wanted to write everything uh in C so so that",
    "start": "1494159",
    "end": "1499760"
  },
  {
    "text": "it will work with peach uh as fast as it could be so I ended up having to take",
    "start": "1499760",
    "end": "1504960"
  },
  {
    "text": "there's a Freer radius. net project so I took that forked it so you can uh do a lot more hackery type of stuff they were",
    "start": "1504960",
    "end": "1511039"
  },
  {
    "text": "trying to use radius packets for like real radius stuff I don't know so I changed that up I fixed that problem so",
    "start": "1511039",
    "end": "1517760"
  },
  {
    "text": "now you can hack with it a lot easier um and then I also created a whole new library called e.net and so you can",
    "start": "1517760",
    "end": "1523799"
  },
  {
    "text": "really create e packets really really simple and I modified op SS l.net so you can do that that sort of asymmetric SSL",
    "start": "1523799",
    "end": "1531039"
  },
  {
    "text": "tunnels really easily so if you wanted to create a packet or create one of these uh tunneled TLS sessions really",
    "start": "1531039",
    "end": "1537159"
  },
  {
    "text": "easily you just uh if you're targeting a radius server you just create a radius e session instance and you can do that",
    "start": "1537159",
    "end": "1543120"
  },
  {
    "text": "super easy if you want to Target uh the client instead you can do that really quick with an Ethernet EP session uh and",
    "start": "1543120",
    "end": "1549360"
  },
  {
    "text": "then if you want to create crazy SSL tunnels you can pretty easily with the SSL UDP uh instance so the other thing",
    "start": "1549360",
    "end": "1556200"
  },
  {
    "start": "1555000",
    "end": "1596000"
  },
  {
    "text": "that I started to do was I was noticing I was playing around with these these uh different e types and servers a lot you",
    "start": "1556200",
    "end": "1562960"
  },
  {
    "text": "know and I I started to see that they were all kind of different right they were all responding different and after",
    "start": "1562960",
    "end": "1568440"
  },
  {
    "text": "over time I was like well wait a second you know I could probably profile which radio server is which just by looking at",
    "start": "1568440",
    "end": "1575000"
  },
  {
    "text": "the responses I got back from a lot of them and so I started to say all right well maybe I could do this I started to",
    "start": "1575000",
    "end": "1580440"
  },
  {
    "text": "find some things there was some special types of messages and the ways that we respond in the middle of a connection",
    "start": "1580440",
    "end": "1586360"
  },
  {
    "text": "and so I proof of concept A lot of that this radius e profile. exe it's using all those net extensions to figure out",
    "start": "1586360",
    "end": "1593720"
  },
  {
    "text": "you know what server you're connecting to um and so I was able to do that and then also there was um sort of some",
    "start": "1593720",
    "end": "1600159"
  },
  {
    "start": "1596000",
    "end": "1619000"
  },
  {
    "text": "opportunity for brute forcing and enumeration so it's sort of slow to do over Wi-Fi try to Brute Force the",
    "start": "1600159",
    "end": "1605679"
  },
  {
    "text": "password it's just really not going to be uh too good uh but you can do other types of interesting things like um",
    "start": "1605679",
    "end": "1611159"
  },
  {
    "text": "enumerate all the e types that are supported and just to sort of build a better picture of the network and how it's configured uh so I implemented that",
    "start": "1611159",
    "end": "1617559"
  },
  {
    "text": "into e .exe but really what I really want to do and I didn't have time to do",
    "start": "1617559",
    "end": "1622760"
  },
  {
    "start": "1619000",
    "end": "1649000"
  },
  {
    "text": "it for this conference but is to write a tool called uh WPA supplicant wp- WP and",
    "start": "1622760",
    "end": "1629360"
  },
  {
    "text": "so uh what this what this uh tool would do is it would Implement all of those other uh attacks and it would um be",
    "start": "1629360",
    "end": "1637039"
  },
  {
    "text": "allow you to do it using WPA supplicant so you can do it over the wireless or over the wire depending on what you want to do so that's sort of on my on my",
    "start": "1637039",
    "end": "1643480"
  },
  {
    "text": "to-do list um and I I expect maybe a next couple of months so keep an eye out on the GitHub and all that good stuff um",
    "start": "1643480",
    "end": "1650159"
  },
  {
    "start": "1649000",
    "end": "1687000"
  },
  {
    "text": "just some notes for researchers I just wanted to add in real quick uh so um you know just basic stuff like don't try to",
    "start": "1650159",
    "end": "1656159"
  },
  {
    "text": "fuzz all this over over Wireless it's just going to take you the rest of your life um you know there's a tool called",
    "start": "1656159",
    "end": "1662360"
  },
  {
    "text": "Eep Overland te Eep Overland test uh always use that it's really good um netsh landan reconnect is an invaluable",
    "start": "1662360",
    "end": "1670120"
  },
  {
    "text": "built-in command uh when you want to fuzz uh like Windows 7 or Windows 8 supplicants uh it's going to be a really",
    "start": "1670120",
    "end": "1676120"
  },
  {
    "text": "useful tool for you it sort of reestablish is that session um and then uh if you want to find the really good",
    "start": "1676120",
    "end": "1681720"
  },
  {
    "text": "stuff uh take a look at sort of uh you know page Heap and all that and make sure that's enabled to find some good",
    "start": "1681720",
    "end": "1687679"
  },
  {
    "start": "1687000",
    "end": "1729000"
  },
  {
    "text": "stuff all right so uh the last thing I wanted to do is just to just to sort of uh finish the thought with that first",
    "start": "1687679",
    "end": "1693840"
  },
  {
    "text": "pher ability I just wanted to exploit it but I also wanted to bring back an idea uh for you guys and that's the idea that",
    "start": "1693840",
    "end": "1702360"
  },
  {
    "text": "um after you uh try to exploit one of these things not only do you sort of get",
    "start": "1702360",
    "end": "1708960"
  },
  {
    "text": "remote code execution uh but you could also redirect program flow to just allow",
    "start": "1708960",
    "end": "1714519"
  },
  {
    "text": "you access to the wireless network uh and so that's a sort of interesting thing like you know your shell code not",
    "start": "1714519",
    "end": "1720399"
  },
  {
    "text": "just does whatever you want it to do but it can also allow you access to the the network so uh I just wanted to keep that",
    "start": "1720399",
    "end": "1726559"
  },
  {
    "text": "in mind too um so I'll show it to you I actually uh it shows you what s sort of",
    "start": "1726559",
    "end": "1732200"
  },
  {
    "start": "1729000",
    "end": "1748000"
  },
  {
    "text": "uh blunder I am I uh I wrote this exploit like a long time ago and then lost it so last actually this morning",
    "start": "1732200",
    "end": "1739519"
  },
  {
    "text": "during the keynote I had to rewrite it uh but luckily it was uh it wasn't too difficult to do so so we'll see if it",
    "start": "1739519",
    "end": "1745679"
  },
  {
    "text": "works you know we'll see all right so the idea here is again",
    "start": "1745679",
    "end": "1750840"
  },
  {
    "text": "here's CSO up here um and we're just going to look for some sort of proof of concept",
    "start": "1750840",
    "end": "1757158"
  },
  {
    "text": "code and Cisco by the way man let me just tell you Cisco awesome those guys",
    "start": "1757799",
    "end": "1763559"
  },
  {
    "text": "were super awesome with me uh they really they sent me the latest versions ACS so I can play around with it they",
    "start": "1763559",
    "end": "1770159"
  },
  {
    "text": "constantly sent me all these uh upgraded versions and let me kept working with it they fixed this bug really quick and",
    "start": "1770159",
    "end": "1776080"
  },
  {
    "text": "they're just they've been really good along the whole vulnerability disclosure process um so kudos to them they rock",
    "start": "1776080",
    "end": "1783000"
  },
  {
    "text": "all right so let's uh do a quick exploit on this uh right do that and now your",
    "start": "1783000",
    "end": "1788760"
  },
  {
    "text": "computer can do math uh calculate stuff it's all that good stuff",
    "start": "1788760",
    "end": "1795600"
  },
  {
    "text": "so thanks guys so uh I clearly drank way too much coffee before this because uh I",
    "start": "1799519",
    "end": "1805240"
  },
  {
    "text": "am all out of everything I went through my entire one hour long presentation already uh but I would like to say a",
    "start": "1805240",
    "end": "1810640"
  },
  {
    "text": "couple of things one if you are a student and want a a fon bag we had some left over from our training uh so come",
    "start": "1810640",
    "end": "1816440"
  },
  {
    "text": "on up I have three of them I'll give them to first come first serve and uh if you guys have any questions feel free to",
    "start": "1816440",
    "end": "1821519"
  },
  {
    "text": "ask yeah go ahead with ice uh with ice yeah the repl for AC uh no I have not I",
    "start": "1821519",
    "end": "1828919"
  },
  {
    "text": "haven't done anything with that any other questions does that exploit work with only the windows version of r or",
    "start": "1828919",
    "end": "1837840"
  },
  {
    "text": "radi uh this exploit so this is specific to ACS um but there are other",
    "start": "1837840",
    "end": "1843760"
  },
  {
    "text": "vulnerabilities out there uh for for free radius uh for Tech radius for S spr",
    "start": "1843760",
    "end": "1850720"
  },
  {
    "text": "uh host apds radius server so there's a lot of different uh vulnerabilities this one is specific for ACS",
    "start": "1850720",
    "end": "1858639"
  },
  {
    "text": "curiosity how many hours have you you know what man it was a lot of it",
    "start": "1858639",
    "end": "1863799"
  },
  {
    "text": "was a lot of development I don't know if I could put an hour count on it it was just like a lot of writing everything so that I can create and Forge packets and",
    "start": "1863799",
    "end": "1870639"
  },
  {
    "text": "then the the worst part about it was that stupid like uh not to rant too much butn net and SSL streams are just sort",
    "start": "1870639",
    "end": "1878320"
  },
  {
    "text": "of annoying and if you want to do them in fancy ways it's it's annoying so um so yeah I don't know about that as much",
    "start": "1878320",
    "end": "1884279"
  },
  {
    "text": "time but there's definitely a lot of libraries that I wrote but hopefully everyone will find new bugs and ice and",
    "start": "1884279",
    "end": "1891399"
  },
  {
    "text": "you know everything else new you know make the world a more secure place any other",
    "start": "1891399",
    "end": "1897120"
  },
  {
    "text": "questions all right thanks so much guys I really appreciate it",
    "start": "1897120",
    "end": "1902919"
  }
]