[
  {
    "text": "[Music] [Laughter]",
    "start": "1550",
    "end": "8730"
  },
  {
    "text": "welcome to the track s Mass Effect track in the Romans conference room we we",
    "start": "10679",
    "end": "17240"
  },
  {
    "text": "chose a room with some mood lighting for this particular talk this is hook and a easy beef injection with man in the",
    "start": "17240",
    "end": "23680"
  },
  {
    "text": "middle otherwise known as that man in the middle talk with the disgusting title with Steve oepic and Ryan Lyn",
    "start": "23680",
    "end": "30640"
  },
  {
    "text": "Steve is a senior security research manager at trustway spider lab he holds four patents with a patent pending he's",
    "start": "30640",
    "end": "37960"
  },
  {
    "text": "done many things but really we all know him from Laser Cats Ryan Lynn is a",
    "start": "37960",
    "end": "43039"
  },
  {
    "text": "pentester author of the book coding for penetration testers and he's a contributor to a number of open- source",
    "start": "43039",
    "end": "51039"
  },
  {
    "text": "projects thank you so uh so yeah you came all out you",
    "start": "53800",
    "end": "58960"
  },
  {
    "text": "all came out I was noticing we're sitting here there uh uh at least 98% men and we we we",
    "start": "58960",
    "end": "66479"
  },
  {
    "text": "realized that maybe we we might have alienated a few people with the name of the talk so um but I did want to tell",
    "start": "66479",
    "end": "71720"
  },
  {
    "text": "you congratulations because um you've actually chosen a talk and you're finishing strong I got to tell you um",
    "start": "71720",
    "end": "77119"
  },
  {
    "text": "you've actually chosen a talk that was uh denied by Defcon um first time I've ever seen this happen I think it was",
    "start": "77119",
    "end": "83360"
  },
  {
    "text": "actually a little too edgy um the uh the comment made was uh might offend sex",
    "start": "83360",
    "end": "89000"
  },
  {
    "text": "workers now that you know so so that being said I just wanted to say up front I apologize you know we're not talking",
    "start": "89000",
    "end": "94360"
  },
  {
    "text": "about you if there's anybody in that industry in the audience you know I think there's something here for everybody you know that say that being",
    "start": "94360",
    "end": "100399"
  },
  {
    "text": "said this guy voted yes so I'm not sure what that means it's kind of mixed signals but um so yeah I'm Steve this is",
    "start": "100399",
    "end": "106840"
  },
  {
    "text": "Ryan what we're going to talk about is really um the the combination this kind",
    "start": "106840",
    "end": "112439"
  },
  {
    "text": "of came around from doing pentest as a lot of this stuff does um the uh the",
    "start": "112439",
    "end": "118520"
  },
  {
    "text": "combination of not being able to use your microphone correctly the combination of doing the um you know pen",
    "start": "118520",
    "end": "126079"
  },
  {
    "text": "penetration testing and trying to you know we're always trying to find ways to hook into these machines right so get",
    "start": "126079",
    "end": "131760"
  },
  {
    "text": "into a network you've got a certain amount of access you're trying to sort of take it to the next level um and we",
    "start": "131760",
    "end": "137760"
  },
  {
    "text": "find ourselves in this situation a lot this is there's a lot of old stuff in this presentation actually I've done several presentations on on Mane middle",
    "start": "137760",
    "end": "144480"
  },
  {
    "text": "specifically art poisoning and Ryan came to me had kind of an interesting idea that we could combine this with",
    "start": "144480",
    "end": "150920"
  },
  {
    "text": "something called the the beef framework um that's that's something we're going to talk about allows you to really hook",
    "start": "150920",
    "end": "156040"
  },
  {
    "text": "yourself into clients hook into U HTTP clients like web web browsers and",
    "start": "156040",
    "end": "161319"
  },
  {
    "text": "actually start to perform actions on their behalf and actually go through them so just to kind of set this up it's",
    "start": "161319",
    "end": "168680"
  },
  {
    "text": "your sort of traditional story it's the uh you know the love story um boy meets",
    "start": "168680",
    "end": "174120"
  },
  {
    "text": "girl tries to impress girl hilarity ues and then of course a forest chain",
    "start": "174120",
    "end": "179519"
  },
  {
    "text": "student comes around sweeps her off her feet and then you got the video montage um but right boy becomes a man a man in",
    "start": "179519",
    "end": "187080"
  },
  {
    "text": "the middle boy installs backtrack five boy follows girl in coffee shop and of",
    "start": "187080",
    "end": "193159"
  },
  {
    "text": "course uses edap in inject uh traffic into the HTP stream so what we end up",
    "start": "193159",
    "end": "199280"
  },
  {
    "text": "with is um you know it's kind of like our own version of the hotspot um but",
    "start": "199280",
    "end": "204319"
  },
  {
    "text": "you just basically have a couple options there and a very important question presented",
    "start": "204319",
    "end": "211760"
  },
  {
    "text": "and um you know just like a regular hotspot if you click the the right button and you get you get access to Facebook and the internet so it works",
    "start": "213920",
    "end": "220680"
  },
  {
    "text": "out really nice it's actually a really good way to to get a date apparently um but how does this work right how do",
    "start": "220680",
    "end": "226519"
  },
  {
    "text": "people do that and that's uh that's going to be the first part of this talk and by the way I don't want us again I'm",
    "start": "226519",
    "end": "231599"
  },
  {
    "text": "all about not offending people so we want to make sure that everybody everybody is represented here okay so",
    "start": "231599",
    "end": "239239"
  },
  {
    "text": "okay so the diagram I've explained art poisoning a lot it's like one of those things you have to if you're going to do",
    "start": "239239",
    "end": "244400"
  },
  {
    "text": "a talk and it's going to have art poisoning in it you just have to explain it so bear with me if you know what it is it's motherhood and apple pie kind of",
    "start": "244400",
    "end": "250079"
  },
  {
    "text": "thing but if you don't know what it is if you know what it is I think it's going to be one of the more enjoyable discussions on what it is otherwise um",
    "start": "250079",
    "end": "257400"
  },
  {
    "text": "you know listen up this is this it's really not that hard so you've got these three machines um the top one is the",
    "start": "257400",
    "end": "263400"
  },
  {
    "text": "router let's say this is the Hotpot okay top one's the router then there's the you know victim or whatever um down here",
    "start": "263400",
    "end": "270039"
  },
  {
    "text": "in the bottom left the um soon to be date and the on the bottom right of the screen you see there's the there's good",
    "start": "270039",
    "end": "275680"
  },
  {
    "text": "old ptj trying to trying to get a hookup so we're just going to shorten these up you have IP addresses and Mac addresses",
    "start": "275680",
    "end": "283039"
  },
  {
    "text": "okay so the the Mac you know the Macs the Mac Gateway the Mac a and Mac B let's just make it simple on",
    "start": "283039",
    "end": "289199"
  },
  {
    "text": "ourselves okay all this is right is that R for those of you don't know ARP is",
    "start": "289199",
    "end": "294400"
  },
  {
    "text": "very simple it's just a mapping between an IP address which is layer three and a MAC address which is on layer 2 the MAC",
    "start": "294400",
    "end": "300400"
  },
  {
    "text": "address is burned into at the factory it's at the lowest layer of networking that's kind of how things communicate",
    "start": "300400",
    "end": "306039"
  },
  {
    "text": "the IP address is assigned dynamically so what it is it's kind of a lookup table it says this IP is associated with",
    "start": "306039",
    "end": "311120"
  },
  {
    "text": "this Mac so right now um Mac a this this person here thinks that uh the Gateway",
    "start": "311120",
    "end": "316520"
  },
  {
    "text": "is at the Mac G Gateway the Mac of the Gateway which makes sense and of course the AR cache of the of the Gateway is",
    "start": "316520",
    "end": "323720"
  },
  {
    "text": "right it says that that IP address associated with Mac a you can kind of see where this is going so there's the",
    "start": "323720",
    "end": "329240"
  },
  {
    "text": "Facebook then this guy gets involved now this is this is actually what's called we take",
    "start": "329240",
    "end": "334919"
  },
  {
    "text": "took a little Jump Ahead there's AR there's ARP reply poisoning there's AR request poisoning this is AR request poisoning it's a little sneakier you're",
    "start": "334919",
    "end": "341800"
  },
  {
    "text": "actually asking a question in this case we're asking the victim here on the bottom left we're asking them what's",
    "start": "341800",
    "end": "348400"
  },
  {
    "text": "their IP all right what's their Mac address tell me and by the way my IP is",
    "start": "348400",
    "end": "353520"
  },
  {
    "text": "the IP of the Gateway and I'm at Mac B so that's a little messed up and basically I'm asking him a question but",
    "start": "353520",
    "end": "358720"
  },
  {
    "text": "I'm also saying by the the way you know you send it to me I'm the Gateway that actually works a lot there are some os's",
    "start": "358720",
    "end": "364680"
  },
  {
    "text": "that that that don't like that open BSD comes to mind there's a few that that you know this is old again this is",
    "start": "364680",
    "end": "369759"
  },
  {
    "text": "really old stuff but generally speaking this is this is uh pretty successful",
    "start": "369759",
    "end": "374800"
  },
  {
    "text": "that uh basically our PT ptj guy gets M gets mapped to the IP address of the",
    "start": "374800",
    "end": "381680"
  },
  {
    "text": "Gateway so facebook.com if if if the machine's going to go to that site it's going to go to ptj now we do the same",
    "start": "381680",
    "end": "388800"
  },
  {
    "text": "thing we say who has 10.1 tell me and by the way you know 100 I'm at macb as well",
    "start": "388800",
    "end": "395919"
  },
  {
    "text": "so the ARP cach gets updated on the router and the same thing happens there so then we forward this stuff through",
    "start": "395919",
    "end": "401039"
  },
  {
    "text": "okay but then what do you do after that well this is where we kind of this is where we run into a little bit of a snag",
    "start": "401039",
    "end": "406759"
  },
  {
    "text": "because we start there's a lot of stuff we can do there's UNCC path injection there's a lot of stuff that that we've",
    "start": "406759",
    "end": "412240"
  },
  {
    "text": "already been doing with um things like I guess fire sheep and and stuff like that depending on what you're using um Eder",
    "start": "412240",
    "end": "418080"
  },
  {
    "text": "cap can do a lot of stuff but um a lot of times we find ourselves just sort of just sort of watching traffic if it's in",
    "start": "418080",
    "end": "423319"
  },
  {
    "text": "a pentest if it's you know something else um you just end up like watching watching the packets literally go",
    "start": "423319",
    "end": "429000"
  },
  {
    "text": "through you but the thing is it still works it still works in over 90% of our pentests",
    "start": "429000",
    "end": "435840"
  },
  {
    "text": "and it's it's kind of a problem because it's it's been overlooked people don't really think of it as as big of a",
    "start": "435840",
    "end": "440879"
  },
  {
    "text": "problem as it probably is um there are security measures uh available you don't see them very often there's things like",
    "start": "440879",
    "end": "446759"
  },
  {
    "text": "art poison um detection and countermeasures it's it's in that classification of",
    "start": "446759",
    "end": "452840"
  },
  {
    "text": "problems where people think it's not something you can actually fix or it's not worth fixing or oh yeah of course if",
    "start": "452840",
    "end": "459000"
  },
  {
    "text": "you have access to layer 2 Network then of course it's game over for everybody but I don't think it should be that way",
    "start": "459000",
    "end": "465319"
  },
  {
    "text": "um we think of it like the inevitable so if you're sitting at the keyboard of the server and you have a password well of",
    "start": "465319",
    "end": "470400"
  },
  {
    "text": "course you're going to get access but I wouldn't I wouldn't throw it in that same classification honestly um and of",
    "start": "470400",
    "end": "476919"
  },
  {
    "text": "course we always win in in the Hotpot scenario cuz you know the the girls need to get to Facebook and they they always click the yes button eventually so that",
    "start": "476919",
    "end": "483800"
  },
  {
    "text": "works out pretty nice but in the real world it's it really is once you get access once you're able to get access",
    "start": "483800",
    "end": "490560"
  },
  {
    "text": "this way it's a good way to Pivot right so it's not just that basically you're",
    "start": "490560",
    "end": "495720"
  },
  {
    "text": "doing the art poisoning and you have access to the machine now once you get access to the machine you can then start",
    "start": "495720",
    "end": "500960"
  },
  {
    "text": "targeting other things um it's also somewhat hard when it comes to forensics there really isn't anything that",
    "start": "500960",
    "end": "507199"
  },
  {
    "text": "generally there's there's some old there's some of the older stuff like art watch and stuff like that that will do logging of of of of art but there there",
    "start": "507199",
    "end": "514360"
  },
  {
    "text": "just isn't a whole lot of data kept in this area uh like I said we used a lot in pentests it's great Recon data it's",
    "start": "514360",
    "end": "521120"
  },
  {
    "text": "great to see where people are talking what are the interesting machines and uh as you you probably heard of the UNCC",
    "start": "521120",
    "end": "526880"
  },
  {
    "text": "injection before I'm just going to go real quick through a couple tools that are sort of the bread and butter in this",
    "start": "526880",
    "end": "532880"
  },
  {
    "text": "space again for those of you who been using these tools you probably be very familiar with them this one in particular um I imagine a lot of people",
    "start": "532880",
    "end": "539600"
  },
  {
    "text": "been using Eder cap I've been using Eder cap since like 2001 I think um it's a",
    "start": "539600",
    "end": "544640"
  },
  {
    "text": "really featur man- ofth the-middle framework it's um it was actually some new maintainers recently which is great",
    "start": "544640",
    "end": "550640"
  },
  {
    "text": "to see there's something that's uh part of it's called Eder filter which is uh which allows you to take these um",
    "start": "550640",
    "end": "556920"
  },
  {
    "text": "basically make a language and and do replacement you can say if you see you know X Change it to Y um it's very",
    "start": "556920",
    "end": "563880"
  },
  {
    "text": "helpful and um honestly when I when I first saw this program I thought it's the most amazing thing i' ever seen um",
    "start": "563880",
    "end": "569200"
  },
  {
    "text": "we we actually I'm from The Knack space I started network access control company back in 2001 and we did Art poisoning to",
    "start": "569200",
    "end": "575200"
  },
  {
    "text": "actually protect device in the network and just kind of an interesting interesting way of doing it I was a big fan of these guys zura Naga who made",
    "start": "575200",
    "end": "581760"
  },
  {
    "text": "this in my mind this is probably what these guys look like I mean I I told you this was a little bit old right this is",
    "start": "581760",
    "end": "587040"
  },
  {
    "text": "old technology but I'm pretty sure that like you know this is this is pretty much what their life is like every",
    "start": "587040",
    "end": "592560"
  },
  {
    "text": "day um SSL strip is another one um this is moxy's Tool uh this was the thing",
    "start": "592560",
    "end": "598760"
  },
  {
    "text": "where he was changing hdps to hdp um he recommends ARP spoof ARP spoof is the old Doug song tool so some of these",
    "start": "598760",
    "end": "605600"
  },
  {
    "text": "might be ringing a bell um he ARP spoof does the actual man in the middle and uh and then and then the SSL strip does the",
    "start": "605600",
    "end": "612640"
  },
  {
    "text": "rest thicknet is my tool uh me and wendle made this a couple years ago thicknet was another man- inth the-",
    "start": "612640",
    "end": "617880"
  },
  {
    "text": "middle tool that does um Microsoft SQL and Oracle it'll do like inject it'll actually do interactive injections",
    "start": "617880",
    "end": "623880"
  },
  {
    "text": "against that so you just take over the session it's yours um and um those of you heard about it they're wearing the",
    "start": "623880",
    "end": "629360"
  },
  {
    "text": "the licensing talks for the new line of men's body spray which is which is kind of kind of kind of cool so um the can",
    "start": "629360",
    "end": "636519"
  },
  {
    "text": "enable is another one Windows based Tool uh man the middle lots of different types of hashes this is the this is the",
    "start": "636519",
    "end": "643360"
  },
  {
    "text": "windows sorry the windows side of this right um if you're on the Windows platform probably use this one time or",
    "start": "643360",
    "end": "648560"
  },
  {
    "text": "another it is more like a pointand click man thee middle they they've used it for demonstrations on things like taking",
    "start": "648560",
    "end": "655200"
  },
  {
    "text": "over RDP sessions and stuff like that so there's some pretty good uh pretty good stuff there a screenshot of it um so",
    "start": "655200",
    "end": "662440"
  },
  {
    "text": "that gets us up again there's a lot of like explaining sort of the history of where we're at that gets us up to where",
    "start": "662440",
    "end": "667480"
  },
  {
    "text": "we're at now where we're just starting to sort of Peel back what we can do with with man in the middle I mean there's we've done we've done RP we've done you",
    "start": "667480",
    "end": "674440"
  },
  {
    "text": "like you know all the things we talked about the UNC path injection but it always feels very it always feels like it's really really hard it feels like",
    "start": "674440",
    "end": "680600"
  },
  {
    "text": "you got to write these custom filters you have to jump through a lot of Hoops to get it working so one of the things we want to do is try to make this easier",
    "start": "680600",
    "end": "686160"
  },
  {
    "text": "and we wrote some tools to really streamline this process of getting in the way and we targeted I think you know",
    "start": "686160",
    "end": "692680"
  },
  {
    "text": "what you'll what you'll uh see is is is probably the best uh attack Vector out there so I'll let uh Ryan talk about",
    "start": "692680",
    "end": "697959"
  },
  {
    "text": "beef for a little while",
    "start": "697959",
    "end": "702880"
  },
  {
    "text": "thanks so uh obviously browsers uh are are very prominent in uh in network",
    "start": "703240",
    "end": "709959"
  },
  {
    "text": "pentest we see a lot of network traffic and we see a lot of web traffic as part of it so if there were one thing that we",
    "start": "709959",
    "end": "716440"
  },
  {
    "text": "wanted to own being able to own the web traff traffic would be a great place to start so the other thing is is so we can",
    "start": "716440",
    "end": "723760"
  },
  {
    "text": "see the traffic we can inject things into it but one of the problems with the traditional man in Middle tools is",
    "start": "723760",
    "end": "728959"
  },
  {
    "text": "typically it's a onetoone mapping you can't dynamically pick what you want from moment to moment without stopping",
    "start": "728959",
    "end": "734440"
  },
  {
    "text": "the tool modifying code restarting it so for tools like Ed cap you have to rebuild a filter recompile it for a lot",
    "start": "734440",
    "end": "741760"
  },
  {
    "text": "of the other tools you me have to write custom plugins to do different things so we wanted a way to be able to do this uh",
    "start": "741760",
    "end": "748480"
  },
  {
    "text": "a little bit easier and so obviously web browser is the best place to do it and so being able to",
    "start": "748480",
    "end": "756199"
  },
  {
    "text": "focus specifically on its own protocol is great one of the things we want to be able to do is disrupt the users as",
    "start": "756199",
    "end": "763519"
  },
  {
    "text": "little as possible because obviously if you just start injecting stuff into every single web page you have a better",
    "start": "763519",
    "end": "769600"
  },
  {
    "text": "chance of getting noticed you have a better chance of actually causing the user who's browsing size problems and our goal is to keep the web browser up",
    "start": "769600",
    "end": "775680"
  },
  {
    "text": "for as long as possible if they click the close button then we're we're done so we want them to keep browsing",
    "start": "775680",
    "end": "782000"
  },
  {
    "text": "websites hopefully very long interesting websites so that we can keep our browser hooks alive for as long as possible and",
    "start": "782000",
    "end": "788560"
  },
  {
    "text": "so what we really wished is that there was something that would streamline this and make it easy and let us leverage all",
    "start": "788560",
    "end": "794480"
  },
  {
    "text": "of these tools so obviously beef is awesome uh beef will allow us to hook uh different",
    "start": "794480",
    "end": "802519"
  },
  {
    "text": "browsers basically what that means is by injecting a chunk of JavaScript code we",
    "start": "802519",
    "end": "807639"
  },
  {
    "text": "have the ab ability to create a uh Beacon back and forth between them so",
    "start": "807639",
    "end": "813600"
  },
  {
    "text": "browser exploitation framework is a uh Ruby application that has that",
    "start": "813600",
    "end": "819120"
  },
  {
    "text": "JavaScript built in so that we can place that into a page and it'll create that uh beaconing but also it allows us to",
    "start": "819120",
    "end": "826440"
  },
  {
    "text": "have a modular framework where we can pick specific things out of that framework that we want executed in the",
    "start": "826440",
    "end": "831680"
  },
  {
    "text": "context of the browser so in short beef allows an attacker to",
    "start": "831680",
    "end": "837399"
  },
  {
    "text": "control browsers we can lots of different things the attacker hooks uh the browser and then it becomes what is",
    "start": "837399",
    "end": "844079"
  },
  {
    "text": "referred to as a zombie because it's sort of wandering around on its own aimlessly until we will shift it a",
    "start": "844079",
    "end": "849880"
  },
  {
    "text": "little bit and point it in its own Direction and then it continues to amble on so everything the uh that beef",
    "start": "849880",
    "end": "856759"
  },
  {
    "text": "interacts with as far as the browser itself is Javascript based so anything that can run JavaScript code we have the",
    "start": "856759",
    "end": "864040"
  },
  {
    "text": "ability to to hook it's also modular so as we come up with new things we want to",
    "start": "864040",
    "end": "869399"
  },
  {
    "text": "do basically write some Ruby code and it's easy to incorporate um in the past we've we've",
    "start": "869399",
    "end": "875480"
  },
  {
    "text": "done some other things incorporating into metas sploit so for instance one of the things we have the ability to do is to pass the actual browser hidden",
    "start": "875480",
    "end": "883839"
  },
  {
    "text": "iframes to metlo payloads so we're going to talk a little bit about how to fingerprint browsers and based off that",
    "start": "883839",
    "end": "889759"
  },
  {
    "text": "fingerprinting information we can Target specific browsers send them specific exploits that we think are going to have",
    "start": "889759",
    "end": "894959"
  },
  {
    "text": "higher likelihood of being successful to minimize the chance that both the US user will notice us and also that we'll",
    "start": "894959",
    "end": "900959"
  },
  {
    "text": "do something bad enough to the browser that it'll crash and we won't really get a second shot at them so there's also some cool stuff",
    "start": "900959",
    "end": "907680"
  },
  {
    "text": "with cross protocol exploits one of the nice things about um XML uh RPC and and",
    "start": "907680",
    "end": "914480"
  },
  {
    "text": "all of the aack stuff that's happening is there's a lot of things that respond to web requests and not all of them are",
    "start": "914480",
    "end": "920000"
  },
  {
    "text": "web browsers so for instance um IRC will ignore part of the HTTP header so",
    "start": "920000",
    "end": "926120"
  },
  {
    "text": "there's actually IRC exploits that we can Leverage through the browser to attack IRC servers printers all sorts of",
    "start": "926120",
    "end": "932839"
  },
  {
    "text": "other stuff so even if we can't get into a certain place on a network if we can make sure that that browser is be back",
    "start": "932839",
    "end": "939440"
  },
  {
    "text": "to beef we can launch those exploits internally and one of the most important ones that's been added fairly recently",
    "start": "939440",
    "end": "945440"
  },
  {
    "text": "is we actually have the ability to proxy through that browser and execute requests through that browser with the",
    "start": "945440",
    "end": "951319"
  },
  {
    "text": "credentials built into it um cookies that it is currently using and also the",
    "start": "951319",
    "end": "956839"
  },
  {
    "text": "access that it has from its Network vantage point so we have the ability to have a lot more control so obviously surprise",
    "start": "956839",
    "end": "967120"
  },
  {
    "text": "um nobody really wants to uh have have beef injection occur to them but what we",
    "start": "967120",
    "end": "973519"
  },
  {
    "text": "really want to do is figure out how to entice a user into this JavaScript code",
    "start": "973519",
    "end": "978720"
  },
  {
    "text": "so traditionally uh the way that this has worked is through cross-site scripting um either through reflected",
    "start": "978720",
    "end": "986199"
  },
  {
    "text": "which requires a uh user to to click on a link that has cross-site scripting",
    "start": "986199",
    "end": "992040"
  },
  {
    "text": "code in it that's usually part of social engineering attacks something like that um and the other one is fishing and",
    "start": "992040",
    "end": "998720"
  },
  {
    "text": "actually creating a static malicious site that has the hook in it and then figuring out how to get people to click it so all of those are sort of",
    "start": "998720",
    "end": "1005160"
  },
  {
    "text": "problematic because it requires you to trick a user into doing something so what we wanted to do was make it so that",
    "start": "1005160",
    "end": "1011800"
  },
  {
    "text": "we didn't have to rely on the the user being gullible we wanted to just go ahead and take care of that for so they",
    "start": "1011800",
    "end": "1017959"
  },
  {
    "text": "didn't have to worry about it so this is a screenshot of the the beef console as you can see over on the left",
    "start": "1017959",
    "end": "1024199"
  },
  {
    "text": "there are the various hosts that are hooked and on the right is some basic general information about uh about the",
    "start": "1024199",
    "end": "1031480"
  },
  {
    "text": "browser itself but the one of the problems with with beef is again you can't just stick",
    "start": "1031480",
    "end": "1037918"
  },
  {
    "text": "it anywhere you have to find a web page to put it you have to figure out how to get in the middle of the traffic so that",
    "start": "1037919",
    "end": "1043600"
  },
  {
    "text": "you can uh can actually get the JavaScript code executing in the browser",
    "start": "1043600",
    "end": "1049200"
  },
  {
    "text": "um and so finding vulnerable web pages on an internal is really sort of a pain um and also you know you really want to",
    "start": "1049200",
    "end": "1056480"
  },
  {
    "text": "sort of make this as as optim optimized as possible so being able to just go ahead and stick this into the web page",
    "start": "1056480",
    "end": "1062799"
  },
  {
    "text": "forum is really beneficial fishing you know you send out enough fishing emails you're probably going to get caught",
    "start": "1062799",
    "end": "1068880"
  },
  {
    "text": "these days somebody's going to turn into the help desk and then they're going to send out the broadcast email if you get this link don't click on it so the other",
    "start": "1068880",
    "end": "1077520"
  },
  {
    "text": "problem we have is that hooking browsers is typically transient because you can hook a single vulnerable page and if",
    "start": "1077520",
    "end": "1082679"
  },
  {
    "text": "that page isn't very interesting somebody's going to click on something else and then the hook goes away so what",
    "start": "1082679",
    "end": "1088600"
  },
  {
    "text": "we wanted to do with this is have the ability to constantly inject the beef hook into the pages so as people are",
    "start": "1088600",
    "end": "1094919"
  },
  {
    "text": "browsing to different sites we are hitting that we are able to inject into those pages on a regular basis to keep",
    "start": "1094919",
    "end": "1101440"
  },
  {
    "text": "them coming back to us over and over so that takes us to where we're at",
    "start": "1101440",
    "end": "1109480"
  },
  {
    "text": "now um that that actually makes for a really",
    "start": "1109480",
    "end": "1114840"
  },
  {
    "text": "interesting Google Images search so um but but you know I mean the thing is",
    "start": "1114840",
    "end": "1120400"
  },
  {
    "text": "we're talking about manhood and that whole theme and and Womanhood if you will and uh honestly do you see anything",
    "start": "1120400",
    "end": "1125720"
  },
  {
    "text": "for children here right um Ed Cap's awesome okay like I said before I I'm",
    "start": "1125720",
    "end": "1131440"
  },
  {
    "text": "I'm a big fan um still a big fan they're they're developing it a lot but we the thing is it's gotten to the point where",
    "start": "1131440",
    "end": "1137640"
  },
  {
    "text": "we just we wanted something was a little more purpose built for this specific problem domain um there's some unique",
    "start": "1137640",
    "end": "1145520"
  },
  {
    "text": "issues with injecting web content if you know if you've used Eder filter uh you have this thing where you're basically",
    "start": "1145520",
    "end": "1151679"
  },
  {
    "text": "saying replace x with Y specifically you have to say wait for this specific thing to come along and then we're going to",
    "start": "1151679",
    "end": "1157760"
  },
  {
    "text": "just replace it with this which is useful in some cases but when it comes to something like you know HTML and the Dom and how you have these variable",
    "start": "1157760",
    "end": "1164000"
  },
  {
    "text": "length protocols um it's not as flexible there's some other tricks you that we'd like to do that we can't really do",
    "start": "1164000",
    "end": "1170080"
  },
  {
    "text": "inside of an Eder filter and um as who actually who's who's written Eder",
    "start": "1170080",
    "end": "1175559"
  },
  {
    "text": "filters in here who used ater filters for this is anybody does anybody look at the accept encoding if anybody knows",
    "start": "1175559",
    "end": "1181720"
  },
  {
    "text": "what I'm talking about there that except nannerpus is like the equivalent to accepting coding the reason why we used",
    "start": "1181720",
    "end": "1187880"
  },
  {
    "text": "to do that is okay so what would happen is somebody request a site somebody request a page and and the and the",
    "start": "1187880",
    "end": "1193280"
  },
  {
    "text": "browser would say like if they're going out to Google the browser would say um accept encoding and one of the things",
    "start": "1193280",
    "end": "1199039"
  },
  {
    "text": "would be gzip well that's really bad for us in the middle right this is a very bad situation because what's happening",
    "start": "1199039",
    "end": "1204520"
  },
  {
    "text": "is they're encoding it using using gzip and they're spreading it across multiple files so it's not plain text anymore if",
    "start": "1204520",
    "end": "1210159"
  },
  {
    "text": "we're going to mess with it if we're going to add stuff to it we don't want it to be encoded so with Eder cap a lot",
    "start": "1210159",
    "end": "1217080"
  },
  {
    "text": "of times what we would do is because you had to be very explicit you didn't want to mess with the size of the protocol it",
    "start": "1217080",
    "end": "1222880"
  },
  {
    "text": "just so happened that the word except like except nannerpus lined up with except encoding and so we start Ed doing",
    "start": "1222880",
    "end": "1229039"
  },
  {
    "text": "what we called the nannerpus right but the nannerpus is getting a little bit old man you know he's getting a little",
    "start": "1229039",
    "end": "1234520"
  },
  {
    "text": "tired um and and it it limits what we can actually do this is an example of an Eder filter if you're going to use Eder",
    "start": "1234520",
    "end": "1240840"
  },
  {
    "text": "cap that that you're that use a lot I mean there's like there's a few different variants of this but that's",
    "start": "1240840",
    "end": "1246039"
  },
  {
    "text": "that's ensuring that when the web page when the web browser asks for a page it comes back and it says uh it comes back",
    "start": "1246039",
    "end": "1251840"
  },
  {
    "text": "in plain text so we can mess with it thicknet was another one I looked at I thought well maybe I can just extend thicknet to do this but it's really made",
    "start": "1251840",
    "end": "1258240"
  },
  {
    "text": "more for interactive session injection it's more about database protocols it's Overkill maybe in it's in Pearl and I",
    "start": "1258240",
    "end": "1265520"
  },
  {
    "text": "had Ruby people you know crying at me about it so I said fine I'll make you a tool and it will be in Ruby and let's",
    "start": "1265520",
    "end": "1271279"
  },
  {
    "text": "call it shank and use it as a verb on people so down at the bottom of the screen there you see there's a really",
    "start": "1271279",
    "end": "1277919"
  },
  {
    "text": "nice very simple um tool we're releasing at the talk releasing today now um that",
    "start": "1277919",
    "end": "1284000"
  },
  {
    "text": "is called shank you can use it for lots of other stuff you don't have to use it for this beef injection",
    "start": "1284000",
    "end": "1289080"
  },
  {
    "text": "stuff you can actually use it to do any kind of man inthe middle stuff um it's using um it's using a number of things",
    "start": "1289080",
    "end": "1295679"
  },
  {
    "text": "what's kind of fun about it is it's kind of the art poisoner I've always wanted um thicknet had something sort of like",
    "start": "1295679",
    "end": "1301480"
  },
  {
    "text": "this in there as well it's stateful so for those of you who' have used edcap before one of the things you know about",
    "start": "1301480",
    "end": "1307799"
  },
  {
    "text": "it is initially you turn it on it says who's there where's everybody at and",
    "start": "1307799",
    "end": "1312960"
  },
  {
    "text": "then it gets a list it gets a list that populates once of all the different IPS in the network right at least last time",
    "start": "1312960",
    "end": "1318200"
  },
  {
    "text": "I looked the code so if somebody comes along later right so like you're in a hot spot or",
    "start": "1318200",
    "end": "1324080"
  },
  {
    "text": "something or you're in a very Dynamic environment which most networks are with people taking their laptops home whatnot",
    "start": "1324080",
    "end": "1329559"
  },
  {
    "text": "it's going to miss that because the person came in since you've done the scan um the nice thing about shank is",
    "start": "1329559",
    "end": "1335279"
  },
  {
    "text": "it's it's stateful so it will actually watch the network it'll and and and anytime somebody not just by doing",
    "start": "1335279",
    "end": "1340600"
  },
  {
    "text": "periodic scans it actually looks for broadcast so somebody jumps on the network and does gratuitous art or",
    "start": "1340600",
    "end": "1345679"
  },
  {
    "text": "somebody sends any kind of art broadcast at all it gets listed here and it will get poisoned as well um there's only a",
    "start": "1345679",
    "end": "1351679"
  },
  {
    "text": "few external dependencies the main one's packet Fu so if you're in Ruby land you you're very familiar with that um and it",
    "start": "1351679",
    "end": "1357880"
  },
  {
    "text": "actually does something a little nicer it uses the actual um RFC friendly way",
    "start": "1357880",
    "end": "1363960"
  },
  {
    "text": "of changing the encoding which is to say accept encoding identity I know that's kind of weird that's kind of a weird",
    "start": "1363960",
    "end": "1369120"
  },
  {
    "text": "word to use there but that is the RFC for saying don't send me anything other than just the basic text right that's",
    "start": "1369120",
    "end": "1375720"
  },
  {
    "text": "just that's basically just asking for plain text um so no more nannerpus someday I",
    "start": "1375720",
    "end": "1381440"
  },
  {
    "text": "actually like to take a shot at gzip um actually just I mean it's not encrypted",
    "start": "1381440",
    "end": "1386520"
  },
  {
    "text": "or anything it's just encoding it's just you got to gather them all the different you know all the packets together in",
    "start": "1386520",
    "end": "1391880"
  },
  {
    "text": "that and and meanwhile the client's waiting for you you have to gather everything that's in that communication stream unzip it then send it to them and",
    "start": "1391880",
    "end": "1399400"
  },
  {
    "text": "then you know and rezip it you also have to start at that point because if you're going to mess with it you're going to change the way it looks completely",
    "start": "1399400",
    "end": "1404960"
  },
  {
    "text": "you're going to change the size of it you're going to have to start managing sequence acknowledgement numbers like thicknet does so it's hard it's you know",
    "start": "1404960",
    "end": "1410919"
  },
  {
    "text": "but this works just as well um so so the other nice thing about shank is it is in",
    "start": "1410919",
    "end": "1416840"
  },
  {
    "text": "and of itself it is a poisoner but it's also a forwarder so sort of like edap",
    "start": "1416840",
    "end": "1422080"
  },
  {
    "text": "does at Layer Two if you're familiar with um like ARP spoof you set up ARP spoof everything's coming to you but",
    "start": "1422080",
    "end": "1427840"
  },
  {
    "text": "your machine will just drop it on the ground if you don't have IP forwarding enabled in like an ARP spoof scenario",
    "start": "1427840",
    "end": "1434240"
  },
  {
    "text": "everything's just going to go into a black hole your system's going to say this isn't for me I don't know why you're sending this to me um shank will do it itself it has to do",
    "start": "1434240",
    "end": "1441440"
  },
  {
    "text": "it itself because we're actually changing stuff do not have IP foring enabled when you use shank because shank",
    "start": "1441440",
    "end": "1448279"
  },
  {
    "text": "that will actually double your packets you you just want to let shank handle that um I'm going to gripe a little bit",
    "start": "1448279",
    "end": "1453960"
  },
  {
    "text": "but actually it's gotten a lot better since uh another guy on the team took a look at the code and made it a lot better um Ruby and man the middle",
    "start": "1453960",
    "end": "1460799"
  },
  {
    "text": "performance see the thing about man the middle tools I've written a few of them now is that performance is always the",
    "start": "1460799",
    "end": "1466000"
  },
  {
    "text": "big sticking point if you're going to jump in the middle between multiple hosts and you're going to basically be",
    "start": "1466000",
    "end": "1471399"
  },
  {
    "text": "their way of sending traffic you need to think about performance because if you start really if you start dropping a lot",
    "start": "1471399",
    "end": "1476840"
  },
  {
    "text": "of packets you start taking a long time you start running like large Rex queries on all these things it's going to it's",
    "start": "1476840",
    "end": "1482120"
  },
  {
    "text": "going to take a while so performance was actually kind of a pain here um there's",
    "start": "1482120",
    "end": "1487240"
  },
  {
    "text": "for those of you who've messed around with like TCP dump and you like BPF filters this is like BPF filter porn up",
    "start": "1487240",
    "end": "1492960"
  },
  {
    "text": "here basically um it's this is this is one the the first one is basically saying um the get it's like saying if if",
    "start": "1492960",
    "end": "1501240"
  },
  {
    "text": "get is in is in the request then send it through so we're actually looking at the application layer itself um the next one",
    "start": "1501240",
    "end": "1507520"
  },
  {
    "text": "is saying HTTP uh is it an HTTP response so what this does the reason I would do this in",
    "start": "1507520",
    "end": "1514240"
  },
  {
    "text": "BPF versus doing it in Ruby is you want to send Ruby or your whatever Dynamic",
    "start": "1514240",
    "end": "1519440"
  },
  {
    "text": "language you're using you want to send that thing as little traffic as possible you want to send it only the stuff that",
    "start": "1519440",
    "end": "1525000"
  },
  {
    "text": "it cares about because you're you're going to take a speed hit so what this is doing is this is a BPF filter so it's",
    "start": "1525000",
    "end": "1530880"
  },
  {
    "text": "basically telling uh pcap the LI the the pcap library that is closely tied to the kernel the kernel has like a BPF device",
    "start": "1530880",
    "end": "1538159"
  },
  {
    "text": "and it's doing filtering so it's basically B Berkeley packet filter so it's it's it compiles this sort of like",
    "start": "1538159",
    "end": "1543520"
  },
  {
    "text": "in a virtual machine kind of language and then it will apply that to the filter and that's all written in really",
    "start": "1543520",
    "end": "1548760"
  },
  {
    "text": "really tight C code so if you can if you can take the time to figure out the BPF filter like in this case I know it looks",
    "start": "1548760",
    "end": "1554960"
  },
  {
    "text": "really ugly um but uh you can you can actually you can actually get a lot of performance gains out of it um so if",
    "start": "1554960",
    "end": "1562039"
  },
  {
    "text": "anybody's interested in that we can talk afterwards I tell you all about I won't I won't go into it now it's a little ugly but um it's like the the four the",
    "start": "1562039",
    "end": "1568480"
  },
  {
    "text": "colon four is basically like the range and then um the offset TCP TCP 12 that's like the offset so what we're doing the",
    "start": "1568480",
    "end": "1574640"
  },
  {
    "text": "top line I'm sorry I have to tell you uh the top line if you do TCP and then you see those brackets those brackets around",
    "start": "1574640",
    "end": "1581720"
  },
  {
    "text": "it that's actually interpreting the internal portion of that line which I didn't know you could do this until I",
    "start": "1581720",
    "end": "1587320"
  },
  {
    "text": "did it for this tool as a number so we're saying if where the TCP basically ends is equal to get which",
    "start": "1587320",
    "end": "1595480"
  },
  {
    "text": "is kind of cool I I that's that's pretty fun um you can have what what the other",
    "start": "1595480",
    "end": "1601120"
  },
  {
    "text": "thing it does is it does multiple peap sessions some people think oh I got to get it all in one filter I got to do all this stuff in one line no you can open",
    "start": "1601120",
    "end": "1606760"
  },
  {
    "text": "up multiple packet descriptors and do it just as well and that's what we do um we let peap do the work if you use packet",
    "start": "1606760",
    "end": "1612840"
  },
  {
    "text": "pars too much right the the machine's going to get really hot and burn your legs um packet pars inside of packet fu",
    "start": "1612840",
    "end": "1618640"
  },
  {
    "text": "is actually we've it's funny story we've actually submitted some some um optimizations to that project um in the",
    "start": "1618640",
    "end": "1624799"
  },
  {
    "text": "process of doing this we found some things that could be optimized a lot but packet parse itself is still going to look at the whole packet and try to",
    "start": "1624799",
    "end": "1630960"
  },
  {
    "text": "figure out what it is it's pretty slow so um with that so the beef",
    "start": "1630960",
    "end": "1636039"
  },
  {
    "text": "integration side um right I'll tell you how we how we got that",
    "start": "1636039",
    "end": "1640799"
  },
  {
    "text": "working one of the uh other things added to beef recently is a rest API so we can actually communicate with the the beef",
    "start": "1641559",
    "end": "1648200"
  },
  {
    "text": "server from outside of the the traditional web console one of the things we wanted to do was to only",
    "start": "1648200",
    "end": "1653960"
  },
  {
    "text": "poison hosts that weren't already hooked and by doing this we can limit the number of JavaScript uh uh scripts that",
    "start": "1653960",
    "end": "1661200"
  },
  {
    "text": "are running inside the browser but also whenever we start modifying traffic you have a chance that something's going to",
    "start": "1661200",
    "end": "1666279"
  },
  {
    "text": "look funny on the page you know we're sort of taking our best guess about where to stick this in and obviously if",
    "start": "1666279",
    "end": "1672320"
  },
  {
    "text": "you put it in the wrong place somebody is going to notice um so uh we want to",
    "start": "1672320",
    "end": "1677840"
  },
  {
    "text": "limit the impact on the browser period whether it's the the load from the JavaScript and also if somebody has five",
    "start": "1677840",
    "end": "1684480"
  },
  {
    "text": "different pages open really we only need one to be able to do most of what we're doing so the other thing is is again we",
    "start": "1684480",
    "end": "1691640"
  },
  {
    "text": "talked about before with traditional ways that you in inject the beef hook if somebody leaves the page they're gone so",
    "start": "1691640",
    "end": "1698039"
  },
  {
    "text": "by constantly re-injecting them every time we notice them go away that means that we get to keep them uh hooked long",
    "start": "1698039",
    "end": "1705279"
  },
  {
    "text": "term so the other thing is uh beef has an autor run functionality right now you can pick a module and hopefully it's the",
    "start": "1705279",
    "end": "1711880"
  },
  {
    "text": "bestest module ever because that's all you're going to run automatically so if you're on a local network with lots and",
    "start": "1711880",
    "end": "1717240"
  },
  {
    "text": "lots of people that's not really practical because you want to get as much information about these lots and lots of people as possible to figure out",
    "start": "1717240",
    "end": "1724200"
  },
  {
    "text": "who you really want to Target you want to get to the stuff that is going to you know have access to Internet sites",
    "start": "1724200",
    "end": "1729840"
  },
  {
    "text": "access to maybe email or you know financial institutions the people who have teller systems open or financial",
    "start": "1729840",
    "end": "1736240"
  },
  {
    "text": "management stuff open so those the people you want to to look at and so we want to profile as many people as",
    "start": "1736240",
    "end": "1741960"
  },
  {
    "text": "possible so with auto run it allows us to basically query when new people get",
    "start": "1741960",
    "end": "1747080"
  },
  {
    "text": "hooked and then run a bunch of modules against them in sequence but since it's in Ruby we also have the ability to",
    "start": "1747080",
    "end": "1752880"
  },
  {
    "text": "query basic information through the beef rust interface about the browser so that we target specific things based off the",
    "start": "1752880",
    "end": "1759720"
  },
  {
    "text": "specific browsers for instance Chrome will give away different pieces of information than Firefox will and I6",
    "start": "1759720",
    "end": "1765799"
  },
  {
    "text": "gives away different piece of information than ie9 so we may want to specify the types of modules that we're running from one point to",
    "start": "1765799",
    "end": "1772960"
  },
  {
    "text": "another and the other thing is is we don't want to wait we know that these people may go away so we want to figure",
    "start": "1772960",
    "end": "1778840"
  },
  {
    "text": "out who we want to Target as quickly as possible and then that way if we do find somebody interesting and they do go away for a period of time like for lunch we",
    "start": "1778840",
    "end": "1785840"
  },
  {
    "text": "know when they show back up they're not somebody that we want to look at again and so basically the more information we",
    "start": "1785840",
    "end": "1792080"
  },
  {
    "text": "have the more targeted attacks we can do uh we're going to look at in a couple minutes being able to figure out what",
    "start": "1792080",
    "end": "1798120"
  },
  {
    "text": "plugins are running so for instance if you see somebody's running an old Adobe that's obviously something that's",
    "start": "1798120",
    "end": "1803399"
  },
  {
    "text": "interesting to a pentester um dump results one of the the other scripts that we wrote was uh once",
    "start": "1803399",
    "end": "1810559"
  },
  {
    "text": "we start running these scripts part of the problem with beef is that as you run them the command results return back",
    "start": "1810559",
    "end": "1816600"
  },
  {
    "text": "into the beef console so the results are part of each individual Command Module so if you run 20 command modules you",
    "start": "1816600",
    "end": "1823960"
  },
  {
    "text": "have to go and click 20 times in multiple different places to see what happened and since it is per browser per",
    "start": "1823960",
    "end": "1830880"
  },
  {
    "text": "module that's a lot of clicking if you have a lot of stuff so as we are injecting these we're we're uh logging",
    "start": "1830880",
    "end": "1837720"
  },
  {
    "text": "the auto run output and we're going to log that to a file and then dump results is going to query all of that",
    "start": "1837720",
    "end": "1843399"
  },
  {
    "text": "information go into the rest interface pull all that and just dump it to the screen so this part isn't very full",
    "start": "1843399",
    "end": "1849600"
  },
  {
    "text": "featured yet cuz we're trying to get some feedback as to what people and how people might be interested in having",
    "start": "1849600",
    "end": "1854880"
  },
  {
    "text": "this information displayed to them but all of the framework is here so if you want to display it in a certain way it's",
    "start": "1854880",
    "end": "1860799"
  },
  {
    "text": "easy to modify so we're going to look some at uh demo now and we're going to go through",
    "start": "1860799",
    "end": "1867799"
  },
  {
    "text": "this as a sample so for the demo um we want to",
    "start": "1867799",
    "end": "1874080"
  },
  {
    "text": "start off with some basic information gathering to start off we want to fingerprint plugins on the target hosts",
    "start": "1874080",
    "end": "1880120"
  },
  {
    "text": "gather as much browser information as we can um also look at what they're looking at so we can get whatever the current",
    "start": "1880120",
    "end": "1886000"
  },
  {
    "text": "page is that we've injected into um do things like enable key logging so for instance if they're uh if you have a",
    "start": "1886000",
    "end": "1893440"
  },
  {
    "text": "single sign on page and we're able to inject into that page being able to capture all the keystrokes on the page",
    "start": "1893440",
    "end": "1899080"
  },
  {
    "text": "would certainly be handy um and then also one of the the things that we use a lot in pentesting is uh the HTTP capture",
    "start": "1899080",
    "end": "1907120"
  },
  {
    "text": "module and the SB capture module and so by injecting a hidden iframe we can capture the challenge credentials which",
    "start": "1907120",
    "end": "1913639"
  },
  {
    "text": "we can then turn into usable usernames and passwords to compromise host so we might not had before then the other",
    "start": "1913639",
    "end": "1920159"
  },
  {
    "text": "thing is to get persistence modules running so that we don't have to keep injecting people we can do things like",
    "start": "1920159",
    "end": "1925799"
  },
  {
    "text": "uh pop over tabs pop Under tabs launch new windows so that uh the page that",
    "start": "1925799",
    "end": "1931000"
  },
  {
    "text": "we've injected stays there for as long as possible so here's the the environment",
    "start": "1931000",
    "end": "1936200"
  },
  {
    "text": "we have we have uh a domain controller uh user and uh our attacker all in a",
    "start": "1936200",
    "end": "1942159"
  },
  {
    "text": "local network and then we have sort of the production network over on the side so what we're going to be doing is we're",
    "start": "1942159",
    "end": "1949159"
  },
  {
    "text": "going to uh try to figure out how to get to that production Network obviously we don't have credentials to get to it so",
    "start": "1949159",
    "end": "1956279"
  },
  {
    "text": "we might not be able to get there but luckily the user does so what we're going to look at is figuring out how to",
    "start": "1956279",
    "end": "1962559"
  },
  {
    "text": "leverage that user in order to get ourselves access so everybody think",
    "start": "1962559",
    "end": "1968679"
  },
  {
    "text": "positive thoughts",
    "start": "1968679",
    "end": "1972120"
  },
  {
    "text": "okay so what we have here is we have uh the latest Inu and what we're going to",
    "start": "1981639",
    "end": "1986720"
  },
  {
    "text": "do first is we're going to set up our metas sploit listener because one of the things we want to do is this with this",
    "start": "1986720",
    "end": "1992399"
  },
  {
    "text": "is gather challenge credentials as we have users coming in so that even if we don't get anything good as the browser",
    "start": "1992399",
    "end": "1999639"
  },
  {
    "text": "sees us as part of their local network they'll transparently send us credentials and we can work on those",
    "start": "1999639",
    "end": "2004720"
  },
  {
    "text": "offline so that we can get access to more stuff so the two modules we're going to load are the",
    "start": "2004720",
    "end": "2010360"
  },
  {
    "text": "auxiliary um server capture SMB module and so we can just type in run",
    "start": "2010360",
    "end": "2018159"
  },
  {
    "text": "here the other one is the web one so auxiliary server capture httpcore ntlm theore nlm uh",
    "start": "2018159",
    "end": "2027320"
  },
  {
    "text": "capture module instead of capturing basic off credentials is going to give the the web page and nlm challenge",
    "start": "2027320",
    "end": "2033240"
  },
  {
    "text": "response so it will encourage the browser to transparently send us their windows credentials it's important to",
    "start": "2033240",
    "end": "2038840"
  },
  {
    "text": "note that the um the capturing the credentials is not required for this attack this is something that we like to",
    "start": "2038840",
    "end": "2044720"
  },
  {
    "text": "show because it's a nice like added benefit but credential capture is not required for the the beef man mill",
    "start": "2044720",
    "end": "2051158"
  },
  {
    "text": "stuff all right and uh the default ports are sort of weird for this module so we",
    "start": "2051159",
    "end": "2056358"
  },
  {
    "text": "go ahead and send them to Port 80 and slash so that it it's a little bit more traditional so with those running um",
    "start": "2056359",
    "end": "2064158"
  },
  {
    "text": "let's go ahead and see if we can get to the the site first",
    "start": "2064159",
    "end": "2069440"
  },
  {
    "text": "so let's find our",
    "start": "2069440",
    "end": "2073200"
  },
  {
    "text": "Firefox so we want to go to uh an Internet site so",
    "start": "2080639",
    "end": "2086760"
  },
  {
    "text": "internet so actually that is leftt over from the last one so let me fix this yay",
    "start": "2088320",
    "end": "2094560"
  },
  {
    "text": "demos so turn off our proxy don't worry we",
    "start": "2094560",
    "end": "2101920"
  },
  {
    "text": "have a video if things go completely",
    "start": "2101920",
    "end": "2105440"
  },
  {
    "text": "sideways and the resolution is kind of awesome I like when the resolution blocks you from even clicking okay",
    "start": "2111839",
    "end": "2117640"
  },
  {
    "text": "that's always the best I'm not sure what you're going to do there there you go let's try that",
    "start": "2117640",
    "end": "2123920"
  },
  {
    "text": "okay so let's try this again yeah there go use your own password",
    "start": "2123920",
    "end": "2129440"
  },
  {
    "text": "we're better now so This Is Us failing right we're not allowed to get in there okay so that",
    "start": "2129440",
    "end": "2135359"
  },
  {
    "text": "sucks um so from now we want to figure out how to get that access so the first",
    "start": "2135359",
    "end": "2141160"
  },
  {
    "text": "thing we're going to do is we're going to load up beef soon as we find our terminal window",
    "start": "2141160",
    "end": "2148320"
  },
  {
    "text": "again there we go so uh to make sure our beef in is in",
    "start": "2148320",
    "end": "2153680"
  },
  {
    "text": "a pristine condition we are going to go ahead and specify the dashh X flag which",
    "start": "2153680",
    "end": "2159680"
  },
  {
    "text": "um will reset the database and make sure that everything is",
    "start": "2159680",
    "end": "2164920"
  },
  {
    "text": "fresh so we can see here uh a bunch of information about uh beef launching we",
    "start": "2165280",
    "end": "2171560"
  },
  {
    "text": "can see all of the different uh information about uh where to go to to get to everything uh the API key which",
    "start": "2171560",
    "end": "2177720"
  },
  {
    "text": "we're actually going to get automatically and also the most important one is the proxy URI which we're going to use here in a couple",
    "start": "2177720",
    "end": "2184960"
  },
  {
    "text": "minutes so the next thing we want to do is we want to start shank so let's see M yep over on the",
    "start": "2184960",
    "end": "2193760"
  },
  {
    "text": "left there you go so to run shank the only options that we really require are the network we want to to",
    "start": "2193760",
    "end": "2201240"
  },
  {
    "text": "poison cool and so we have to do this as root obviously um because we're going to be",
    "start": "2202119",
    "end": "2208319"
  },
  {
    "text": "generating raw packets and so we'll do this on the 192.168 15",
    "start": "2208319",
    "end": "2214960"
  },
  {
    "text": "Network from here we'll see a couple of",
    "start": "2214960",
    "end": "2220280"
  },
  {
    "text": "different things one is the beef thread started just as sort of a debug message to let us know that it's connected to",
    "start": "2220280",
    "end": "2225560"
  },
  {
    "text": "beef um and we'll look at this minut again in a minute as we start to actually poison",
    "start": "2225560",
    "end": "2231359"
  },
  {
    "text": "traffic so other thing we want to do is run auto run which this is going to be",
    "start": "2231359",
    "end": "2236720"
  },
  {
    "text": "looking for new browsers so this is uh talking back and forth with beef as well and as it sees new browsers come in it",
    "start": "2236720",
    "end": "2243240"
  },
  {
    "text": "sends all the commands to launch the the different modules we want so there's already One browser hooked",
    "start": "2243240",
    "end": "2250040"
  },
  {
    "text": "that was one of our test systems so we can see that it went ahead and launched those so next what we want to do is we",
    "start": "2250040",
    "end": "2258119"
  },
  {
    "text": "want to go and look at our internal",
    "start": "2258119",
    "end": "2262559"
  },
  {
    "text": "box so here this is one of our internal users we want them to go and test uh the",
    "start": "2265280",
    "end": "2271079"
  },
  {
    "text": "Internet site So eventually somebody on the inside is going to go and visit their Internet site we've left the",
    "start": "2271079",
    "end": "2276319"
  },
  {
    "text": "inject pop-up box there um just so that we can see it for demo purposes but obviously traditionally we",
    "start": "2276319",
    "end": "2282200"
  },
  {
    "text": "wouldn't want anything to pop up so um that's one of the the first things that runs as we inject the host once you",
    "start": "2282200",
    "end": "2289319"
  },
  {
    "text": "click okay we can see that oh my gosh internets um so here we have the user",
    "start": "2289319",
    "end": "2294520"
  },
  {
    "text": "that is now hooked um when we look at the browser code here is the script that we injected in so there is the first",
    "start": "2294520",
    "end": "2301680"
  },
  {
    "text": "part with the inject and here is our beef hook URL",
    "start": "2301680",
    "end": "2307640"
  },
  {
    "text": "so this is actually generating the code that's calling back and creating the beacon so from here we can go back and",
    "start": "2307640",
    "end": "2315839"
  },
  {
    "text": "we can look at Beef obviously the new modules for this browser started Auto",
    "start": "2315839",
    "end": "2321040"
  },
  {
    "text": "running and we can see that that worked we can also look back at the um window",
    "start": "2321040",
    "end": "2329599"
  },
  {
    "text": "for shank and we can see a couple of things one is we've added a hook browser we",
    "start": "2329599",
    "end": "2336400"
  },
  {
    "text": "also see each one of these poisons is as arper quests are seen it goes down and",
    "start": "2336400",
    "end": "2341760"
  },
  {
    "text": "sends out new uh new poisons overload encoding obviously",
    "start": "2341760",
    "end": "2346880"
  },
  {
    "text": "again this is all debug messages to let us know that everything's working so if you're doing this on a large scale this",
    "start": "2346880",
    "end": "2352160"
  },
  {
    "text": "is stuff that you probably want to take out and then finally when we look into",
    "start": "2352160",
    "end": "2357400"
  },
  {
    "text": "beef itself hello H",
    "start": "2357400",
    "end": "2365960"
  },
  {
    "text": "there sorry so when we look back into beef itself there we",
    "start": "2365960",
    "end": "2372400"
  },
  {
    "text": "go it will show us that both stuff was hooked and also that the different",
    "start": "2372400",
    "end": "2377560"
  },
  {
    "text": "modules ran so this doesn't actually tell us about what information it got so the other thing that we want to look at",
    "start": "2377560",
    "end": "2383680"
  },
  {
    "text": "is transparently we didn't see this any popups for the user but here is the",
    "start": "2383680",
    "end": "2389000"
  },
  {
    "text": "user's credentials or past in so demo one user from the spiders domain we now",
    "start": "2389000",
    "end": "2394200"
  },
  {
    "text": "have their uh challenge credentials so we can do different types of password attacks on this in order to get access",
    "start": "2394200",
    "end": "2400160"
  },
  {
    "text": "to their machine again this isn't part in of the attack itself but this is a sort of bonus side effect that we use a",
    "start": "2400160",
    "end": "2406760"
  },
  {
    "text": "lot while pen testing so now that we have uh the the browser and beef let's look at Beef",
    "start": "2406760",
    "end": "2413200"
  },
  {
    "text": "itself for for just a",
    "start": "2413200",
    "end": "2416800"
  },
  {
    "text": "second so when we look at the beef control panel the first thing we see is username",
    "start": "2419760",
    "end": "2426319"
  },
  {
    "text": "and password which is by default beef and beef so if you're actually using this on a pentest change the username",
    "start": "2426319",
    "end": "2432240"
  },
  {
    "text": "and password it's in the config file and obviously you don't want people helping you on a pentest um that's that would be",
    "start": "2432240",
    "end": "2440119"
  },
  {
    "text": "embarrassing so we see here this was the test one that we hooked and this is the new one that we hooked the windows um so",
    "start": "2440119",
    "end": "2448640"
  },
  {
    "text": "here we see Safari unknown we know a little bit about it we know that it it doesn't have Flash",
    "start": "2448640",
    "end": "2456280"
  },
  {
    "text": "installed uh all this goodness so basically this is the result of some of the information that we gathered we know",
    "start": "2456280",
    "end": "2462720"
  },
  {
    "text": "that it's on the Internet site um and we also know the cookies from that site when we look at some of the commands",
    "start": "2462720",
    "end": "2468839"
  },
  {
    "text": "that we ran one of the the interesting ones is the get System Info module so you can see here that it actually has uh",
    "start": "2468839",
    "end": "2476760"
  },
  {
    "text": "module results history so when we click on that if we can actually get to it which",
    "start": "2476760",
    "end": "2485520"
  },
  {
    "text": "gay screen resolutions so we can see that uh but basically what it shows and I'll show that in just a",
    "start": "2485520",
    "end": "2492720"
  },
  {
    "text": "second yeah yeah okay good",
    "start": "2492720",
    "end": "2499160"
  },
  {
    "text": "point right the old Shuffle so the bad part is is once you start reducing",
    "start": "2499160",
    "end": "2504599"
  },
  {
    "text": "resolution the user interface is really problematic so um from here as long as you don't",
    "start": "2504599",
    "end": "2511040"
  },
  {
    "text": "have a serious logic graphics card you should be okay though yeah we can probably just make it",
    "start": "2511040",
    "end": "2517280"
  },
  {
    "text": "it really small um actually I don't think that's going",
    "start": "2517280",
    "end": "2522599"
  },
  {
    "text": "to make any difference there you go you see it over here a little bit bit maybe you can",
    "start": "2522599",
    "end": "2527760"
  },
  {
    "text": "move so now you can see from over here that some of the stuff actually maybe you can see maybe you can't uh we know",
    "start": "2528880",
    "end": "2535119"
  },
  {
    "text": "the number of cores on the system we know how much free memory we know about the interfaces specific OS versions all",
    "start": "2535119",
    "end": "2540839"
  },
  {
    "text": "sorts of other good stuff but the real cool part about this is when we right",
    "start": "2540839",
    "end": "2545960"
  },
  {
    "text": "click on this guy we can set uses proxy so now we can set a local proxy through",
    "start": "2545960",
    "end": "2552760"
  },
  {
    "text": "beef and all of our outgoing requests will use their browser uh to issue the",
    "start": "2552760",
    "end": "2558119"
  },
  {
    "text": "requests so since they already have uh authentication that makes sense it's",
    "start": "2558119",
    "end": "2563359"
  },
  {
    "text": "something we might want to use so let's come back in here and we'll edit our",
    "start": "2563359",
    "end": "2569960"
  },
  {
    "text": "proxy preferences and right now it said it no",
    "start": "2569960",
    "end": "2576440"
  },
  {
    "text": "proxy before when it popped up it let us know that our proxy was at Local Host Port Port",
    "start": "2576440",
    "end": "2583640"
  },
  {
    "text": "6789 so let's go there and so next we want to refresh the page and obviously",
    "start": "2587839",
    "end": "2595839"
  },
  {
    "text": "this is left over I think again from before but anyway so we see that their",
    "start": "2595839",
    "end": "2602079"
  },
  {
    "text": "browser is getting injected again we see the pop-up box that they would have seen and also so we see",
    "start": "2602079",
    "end": "2609079"
  },
  {
    "text": "that um and this takes all of the proxy activities take a little while to load so we see that we can actually see the",
    "start": "2609079",
    "end": "2615520"
  },
  {
    "text": "Internet site as them where before we couldn't do the username and password so again the other piece to",
    "start": "2615520",
    "end": "2623240"
  },
  {
    "text": "this was that all of these different modules that we ran against them we had some problems because uh you have to",
    "start": "2623240",
    "end": "2629280"
  },
  {
    "text": "click on each individual thing if you have a really small screen you can't see the uh text unless you zoom out uh and",
    "start": "2629280",
    "end": "2635400"
  },
  {
    "text": "all that so we also wanted to create an easy way of being able to get to that",
    "start": "2635400",
    "end": "2641000"
  },
  {
    "text": "information so we come back to the auto",
    "start": "2641000",
    "end": "2647880"
  },
  {
    "text": "run and so as you can see all of this uh ends up printing out to the screen so",
    "start": "2647880",
    "end": "2652960"
  },
  {
    "text": "one of the things that I do when I run auto run is I te this into auto. out so",
    "start": "2652960",
    "end": "2659640"
  },
  {
    "text": "when we run it again we see that there's again browsers there so it'll go ahead and run these so now that we have",
    "start": "2659640",
    "end": "2665520"
  },
  {
    "text": "captured that output",
    "start": "2665520",
    "end": "2669000"
  },
  {
    "text": "basically this is a series of um Json uh hashes that we can then parse by our",
    "start": "2670839",
    "end": "2676960"
  },
  {
    "text": "secondary script and we'll print all this information out so typically when you're clicking on the user interface in",
    "start": "2676960",
    "end": "2682079"
  },
  {
    "text": "beef this is all of the information that you have to know so programmatically it's sort of a pain going from one step",
    "start": "2682079",
    "end": "2688440"
  },
  {
    "text": "to the next because you have to go back in query all the browsers figure out how all of this matches up and there's two",
    "start": "2688440",
    "end": "2694960"
  },
  {
    "text": "different pieces there's the module and the command so unless we log this out it's kind of hard to get to from the beef API so what we do at this point is",
    "start": "2694960",
    "end": "2704000"
  },
  {
    "text": "we dump the results and so here we can see all of the different things that uh the modules",
    "start": "2704000",
    "end": "2711720"
  },
  {
    "text": "output so we can see here is the information about uh the systems the",
    "start": "2711720",
    "end": "2716880"
  },
  {
    "text": "display that it was on all the display information the Java versioning all of",
    "start": "2716880",
    "end": "2722040"
  },
  {
    "text": "this goodness um and then also stuff that you'll see in here is if there's a lot of different other modules that",
    "start": "2722040",
    "end": "2728240"
  },
  {
    "text": "you've run that have been information gathering all this will be here again this is sort of a a template for what people might like to do with it uh a lot",
    "start": "2728240",
    "end": "2735240"
  },
  {
    "text": "of the time when I'm doing specific things I will look for specific message types from specific modules and either",
    "start": "2735240",
    "end": "2741200"
  },
  {
    "text": "eliminate them from the output because I don't care I just wanted to know the module ran or take something like this",
    "start": "2741200",
    "end": "2746319"
  },
  {
    "text": "and bundle it up in a more manageable form so that is sort of the the core of",
    "start": "2746319",
    "end": "2753599"
  },
  {
    "text": "um the the two pieces merge together",
    "start": "2753599",
    "end": "2758920"
  },
  {
    "text": "nice so that worked that's awesome um the uh so more information I mean we've",
    "start": "2760040",
    "end": "2766040"
  },
  {
    "text": "got just got some links here I wanted to save time for questions um but uh definitely check out beef pro.com",
    "start": "2766040",
    "end": "2773119"
  },
  {
    "text": "um also the um the we put a link up here for the restful API we're going to have",
    "start": "2773119",
    "end": "2778880"
  },
  {
    "text": "up on the uh GitHub site on the SP Labs GitHub site we're going to be releasing the code um for this either later",
    "start": "2778880",
    "end": "2784599"
  },
  {
    "text": "tonight or tomorrow morning we have some DVDs here for those you stuck it out want to ask some good questions or funny",
    "start": "2784599",
    "end": "2789839"
  },
  {
    "text": "questions or whatever you want to you know uh we'll we'll reward you um it's a it's it's a DVD but I promise you it's a",
    "start": "2789839",
    "end": "2796440"
  },
  {
    "text": "it's a and it has beef injection written on the front of it but I I it's uh I promise it's it's safe um so uh Eder cap",
    "start": "2796440",
    "end": "2804359"
  },
  {
    "text": "of course can enable all that stuff um come on up and get the CDs uh this is",
    "start": "2804359",
    "end": "2811200"
  },
  {
    "text": "our our Twitter information and uh emails if you want to talk to us about it more uh we'd be glad to talk to you a",
    "start": "2811200",
    "end": "2817160"
  },
  {
    "text": "big thanks to other spider Labs people uh Mel Oru what works on uh Spider Labs team as well he's a he's a beef Project",
    "start": "2817160",
    "end": "2823119"
  },
  {
    "text": "Lead uh helped us out with lot you know with ideas and guidance and and um that kind of thing um it's great to have him",
    "start": "2823119",
    "end": "2828440"
  },
  {
    "text": "AB aboard and uh Mike Ryan another guy on my team who um took my Ruby code and",
    "start": "2828440",
    "end": "2834640"
  },
  {
    "text": "um what was to him just a complete mess and waste of time made it look like something I couldn't even understand 10",
    "start": "2834640",
    "end": "2840680"
  },
  {
    "text": "minutes and really uh really boosted my self-esteem there so um any uh any",
    "start": "2840680",
    "end": "2848839"
  },
  {
    "text": "questions oh well thank",
    "start": "2848839",
    "end": "2852280"
  },
  {
    "text": "[Applause]",
    "start": "2855090",
    "end": "2858739"
  },
  {
    "text": "you uh question was uh art poisoning tool you really really sure you can't PR present a death G why are you are you",
    "start": "2861119",
    "end": "2867060"
  },
  {
    "text": "[Laughter] offering oh oh oh I see just use it",
    "start": "2867060",
    "end": "2872079"
  },
  {
    "text": "there is what you're saying oh yeah yeah we could present like on the on the Wi-Fi there right that's what you're saying okay okay okay that's not a bad",
    "start": "2872079",
    "end": "2878200"
  },
  {
    "text": "idea um any other",
    "start": "2878200",
    "end": "2882520"
  },
  {
    "text": "questions all righty um I guess it's first come first serve on the DVDs up here if anybody wants some come on up",
    "start": "2883920",
    "end": "2890520"
  },
  {
    "text": "thanks a lot guys [Applause]",
    "start": "2890520",
    "end": "2896100"
  }
]