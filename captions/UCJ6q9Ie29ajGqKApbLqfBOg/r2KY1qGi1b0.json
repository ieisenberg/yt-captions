[
  {
    "text": "[Music]",
    "start": "2200",
    "end": "5439"
  },
  {
    "text": "[Music]",
    "start": "21850",
    "end": "25489"
  },
  {
    "text": "[Music]",
    "start": "44090",
    "end": "47479"
  },
  {
    "text": "[Music]",
    "start": "54350",
    "end": "57889"
  },
  {
    "text": "[Music]",
    "start": "115510",
    "end": "126010"
  },
  {
    "text": "heat Heat",
    "start": "128599",
    "end": "132599"
  },
  {
    "text": "[Music]",
    "start": "136870",
    "end": "142879"
  },
  {
    "text": "[Music]",
    "start": "145560",
    "end": "150180"
  },
  {
    "text": "Heat Heat",
    "start": "152760",
    "end": "156760"
  },
  {
    "text": "[Music]",
    "start": "158960",
    "end": "166860"
  },
  {
    "text": "Heat Heat",
    "start": "176200",
    "end": "180200"
  },
  {
    "text": "Heat",
    "start": "220480",
    "end": "223480"
  },
  {
    "text": "[Music]",
    "start": "240070",
    "end": "247090"
  },
  {
    "text": "Heat Heat",
    "start": "253560",
    "end": "257560"
  },
  {
    "text": "[Music]",
    "start": "259720",
    "end": "268709"
  },
  {
    "text": "Heat",
    "start": "275960",
    "end": "278960"
  },
  {
    "text": "Heat",
    "start": "283080",
    "end": "286080"
  },
  {
    "text": "[Music]",
    "start": "288890",
    "end": "294260"
  },
  {
    "text": "Heat Heat [Music]",
    "start": "296840",
    "end": "302970"
  },
  {
    "text": "Heat [Music]",
    "start": "319639",
    "end": "325159"
  },
  {
    "text": "Heat",
    "start": "327080",
    "end": "330080"
  },
  {
    "text": "[Music]",
    "start": "334300",
    "end": "342050"
  },
  {
    "text": "Heat [Music]",
    "start": "344919",
    "end": "350610"
  },
  {
    "text": "Heat",
    "start": "350840",
    "end": "353840"
  },
  {
    "text": "Heat",
    "start": "364360",
    "end": "367360"
  },
  {
    "text": "up here",
    "start": "374600",
    "end": "378600"
  },
  {
    "text": "[Music]",
    "start": "383980",
    "end": "387589"
  },
  {
    "text": "Heat Heat [Music]",
    "start": "392600",
    "end": "408380"
  },
  {
    "text": "Heat Heat",
    "start": "417479",
    "end": "421479"
  },
  {
    "text": "Heat Heat",
    "start": "439400",
    "end": "443400"
  },
  {
    "text": "Heat Heat [Music]",
    "start": "464479",
    "end": "487319"
  },
  {
    "text": "Heat",
    "start": "487319",
    "end": "490319"
  },
  {
    "text": "Heat",
    "start": "493400",
    "end": "496400"
  },
  {
    "text": "[Music]",
    "start": "498570",
    "end": "511660"
  },
  {
    "text": "Heat",
    "start": "512680",
    "end": "515680"
  },
  {
    "text": "Heat Heat",
    "start": "517880",
    "end": "520880"
  },
  {
    "text": "up here",
    "start": "537880",
    "end": "541880"
  },
  {
    "text": "[Music] Heat Heat",
    "start": "554300",
    "end": "562680"
  },
  {
    "text": "Heat Heat",
    "start": "590680",
    "end": "594680"
  },
  {
    "text": "Heat Heat",
    "start": "608040",
    "end": "612040"
  },
  {
    "text": "[Music]",
    "start": "620900",
    "end": "627659"
  },
  {
    "text": "Heat",
    "start": "628320",
    "end": "630399"
  },
  {
    "text": "up here",
    "start": "639000",
    "end": "643000"
  },
  {
    "text": "Heat Heat",
    "start": "714200",
    "end": "718200"
  },
  {
    "text": "[Music]",
    "start": "729670",
    "end": "739040"
  },
  {
    "text": "Heat Heat",
    "start": "739040",
    "end": "742199"
  },
  {
    "text": "Heat Heat",
    "start": "755360",
    "end": "758440"
  },
  {
    "text": "[Music]",
    "start": "772860",
    "end": "783320"
  },
  {
    "text": "Heat Heat",
    "start": "783320",
    "end": "787320"
  },
  {
    "text": "Heat Heat",
    "start": "827519",
    "end": "830600"
  },
  {
    "text": "But you can use uh your programming skills to develop an application that modifies the the times on on the files",
    "start": "873519",
    "end": "881040"
  },
  {
    "text": "any way you want This is one of those anti-forensics techniques I talked about If you go through and modify the times",
    "start": "881040",
    "end": "886639"
  },
  {
    "text": "on the files for instance uh image files for example and you're going to take off from work for two week",
    "start": "886639",
    "end": "893720"
  },
  {
    "text": "break So maybe maybe an administrator thinks that something's going on with your system You run your little program",
    "start": "893720",
    "end": "900000"
  },
  {
    "text": "before you leave and it modifies all the last access times on all the image files on your system to sometime about the",
    "start": "900000",
    "end": "906399"
  },
  {
    "text": "middle of the first week when you're gone on vacation Okay Well you come back and they say \"Well we found some images",
    "start": "906399",
    "end": "912800"
  },
  {
    "text": "image files on your system.\" them and you can tell them \"Well hey what when were they accessed?\" And they said \"Well",
    "start": "912800",
    "end": "918639"
  },
  {
    "text": "they were accessed on this date.\" And you said \"Well hey look I was on vacation Here's my plane tickets Go to HR They've got me on record as not being",
    "start": "918639",
    "end": "924959"
  },
  {
    "text": "here My manager hasn't seen me Here's my hotel receipts This shows that I was not here using this computer during that",
    "start": "924959",
    "end": "931639"
  },
  {
    "text": "time.\" Now what does that do to a a case in in either pornography or child pornography",
    "start": "931639",
    "end": "939639"
  },
  {
    "text": "speak up please Yeah Yeah Could be I",
    "start": "940880",
    "end": "945920"
  },
  {
    "text": "pres I gave the same presentation at uh George Mason this summer at the forensics conference 2003 Talked about",
    "start": "945920",
    "end": "952240"
  },
  {
    "text": "it a little bit Everybody in the room was a cop State local federal Presented this information they",
    "start": "952240",
    "end": "959440"
  },
  {
    "text": "kind of woke up Okay When I talk about it in a corporate f in a corporate sense um the",
    "start": "959440",
    "end": "966560"
  },
  {
    "text": "cops really don't pay attention But as soon as you say child pornography they all wake up and you know hey could you go back two slides and go over this okay",
    "start": "966560",
    "end": "972720"
  },
  {
    "text": "I've got a quick uh demonstration I put together a little proof of concept script Uh we'll take a",
    "start": "972720",
    "end": "979440"
  },
  {
    "text": "look at that first Uh again this is Pearl This is my programming language of",
    "start": "979440",
    "end": "985639"
  },
  {
    "text": "choice But I use uh the Win32 API prototype module from",
    "start": "985639",
    "end": "991839"
  },
  {
    "text": "Dave Roth Installs via PPM into the active state distribution of Pro Very easy Dave provides it for",
    "start": "991839",
    "end": "998759"
  },
  {
    "text": "free that allows me to access kernel32.dll and grab create file API",
    "start": "998759",
    "end": "1005440"
  },
  {
    "text": "functions set file time all that",
    "start": "1005440",
    "end": "1010800"
  },
  {
    "text": "Okay so I have a uh have a file in the system Uh let's",
    "start": "1011079",
    "end": "1018000"
  },
  {
    "text": "take a look at uh uh the actual demonstration file itself Okay here we",
    "start": "1018000",
    "end": "1024839"
  },
  {
    "text": "go I moved it over to this directory this morning",
    "start": "1024839",
    "end": "1030799"
  },
  {
    "text": "Okay here we see the original the original times creation time It says",
    "start": "1037319",
    "end": "1044600"
  },
  {
    "text": "2001 Last access [Music] time My my uh clock is still on East",
    "start": "1044600",
    "end": "1051600"
  },
  {
    "text": "Coast time That's why it's a little bit off And we have the last right time Well",
    "start": "1051600",
    "end": "1057520"
  },
  {
    "text": "I've hardcoded a date into the script My creation time last access time",
    "start": "1057520",
    "end": "1065200"
  },
  {
    "text": "last modification time that's all been altered Now I could I could run this",
    "start": "1065200",
    "end": "1072080"
  },
  {
    "text": "again go back and change the the times on it and say let's say this this c this",
    "start": "1072080",
    "end": "1077120"
  },
  {
    "text": "uh script was last access in [Music] 1963 But what if the file was created we",
    "start": "1077120",
    "end": "1084400"
  },
  {
    "text": "had the file being created in the year 2007 and then at last being accessed in",
    "start": "1084400",
    "end": "1089960"
  },
  {
    "text": "1999 One file like that on a system is enough to create doubt don't you think cuz how do we know that the rest",
    "start": "1089960",
    "end": "1096720"
  },
  {
    "text": "of the files haven't also been altered just as a side note when I talk to the forensics analysts and the police",
    "start": "1096720",
    "end": "1103840"
  },
  {
    "text": "and whatnot on the topic of information that they find on systems generally the",
    "start": "1103840",
    "end": "1109679"
  },
  {
    "text": "the response I'm getting is they don't suspect things like stenography unless they find a stenography tool Okay The",
    "start": "1109679",
    "end": "1116240"
  },
  {
    "text": "same thing would be true for something like this If they found a file of a system called touch.exe they might be a",
    "start": "1116240",
    "end": "1121520"
  },
  {
    "text": "little bit concerned and say \"Okay well we're going to have problem we might have problems with file times on the system.\" But if this if the the program",
    "start": "1121520",
    "end": "1128240"
  },
  {
    "text": "was run from a CD that wasn't available when they executed a search warrant they",
    "start": "1128240",
    "end": "1133440"
  },
  {
    "text": "have nothing to base their suspicion on Okay Again all that's required to do",
    "start": "1133440",
    "end": "1140480"
  },
  {
    "text": "something like this on a system is write access to the file That's it",
    "start": "1140480",
    "end": "1146000"
  },
  {
    "text": "And again Microsoft makes the API very very public and it has its uses but it also has malicious",
    "start": "1146000",
    "end": "1153000"
  },
  {
    "text": "uses Okay file binding Now this is something I I first",
    "start": "1153000",
    "end": "1158960"
  },
  {
    "text": "kind of noticed when BO came out but file binding using tools like Elite Wrap Saran Wrap Silk Rope they allow us to",
    "start": "1158960",
    "end": "1165919"
  },
  {
    "text": "bind several files together for execution Elite Wrap is fairly easy to use It works off of a script It's fairly",
    "start": "1165919",
    "end": "1172160"
  },
  {
    "text": "straightforward You can tell uh you you can one run one program uh have it run",
    "start": "1172160",
    "end": "1177840"
  },
  {
    "text": "other programs invisibly I've worked with uh just little example files just to show other",
    "start": "1177840",
    "end": "1184400"
  },
  {
    "text": "audiences how simple it is I bind notepad to solitaire and I run one and",
    "start": "1184400",
    "end": "1190400"
  },
  {
    "text": "they both open It's fairly straightforward fairly simple Okay Now something like this is",
    "start": "1190400",
    "end": "1197039"
  },
  {
    "text": "going to be a little bit difficult Not impossible just a little bit difficult with Windows file protection especially",
    "start": "1197039",
    "end": "1202799"
  },
  {
    "text": "if it's done with a protected file Is everybody familiar with Windows file protection who's",
    "start": "1202799",
    "end": "1210120"
  },
  {
    "text": "not okay Well there are ways to shut it off In fact uh in November At Stake",
    "start": "1210120",
    "end": "1215840"
  },
  {
    "text": "released a nice little tool that supposedly shuts off Windows file protection until the next time the system is",
    "start": "1215840",
    "end": "1222799"
  },
  {
    "text": "rebooted So okay O and calm",
    "start": "1223240",
    "end": "1229120"
  },
  {
    "text": "Now you might be wondering what this has got to do with file hiding but just bear with me here Uh OLE or COM is referred to a",
    "start": "1229120",
    "end": "1236000"
  },
  {
    "text": "structured storage compound files file system within a file Um I found all these references on both Google and the",
    "start": "1236000",
    "end": "1242720"
  },
  {
    "text": "Microsoft TechNet site Um it's kind of an interesting little idea Basically uh there's a",
    "start": "1242720",
    "end": "1249919"
  },
  {
    "text": "little utility out there called Merge Streams and I'll run a demonstration here but what Merge Streams will let us do is take a word document that's got",
    "start": "1249919",
    "end": "1256480"
  },
  {
    "text": "legitimate you know corporate data or whatever maybe innocuous information and we bind a spreadsheet into it The end",
    "start": "1256480",
    "end": "1263039"
  },
  {
    "text": "result is the original file still has the original Word document's name to it But if we change the extension tox it",
    "start": "1263039",
    "end": "1270640"
  },
  {
    "text": "gets opened in Excel and the spreadsheet is open So we can hide one file within",
    "start": "1270640",
    "end": "1276960"
  },
  {
    "text": "another Okay I'll run a quick little",
    "start": "1276960",
    "end": "1282320"
  },
  {
    "text": "demonstration uh again for the police Uh I think they're uh I think the",
    "start": "1282320",
    "end": "1288400"
  },
  {
    "text": "standard for uh child pornography is three images of am I correct on that",
    "start": "1288400",
    "end": "1293520"
  },
  {
    "text": "does anybody know for sure okay Anyway uh if you take three",
    "start": "1293520",
    "end": "1299200"
  },
  {
    "text": "images and you bind them into a Word document you hide them in Excel spreadsheet now you've got the three",
    "start": "1299200",
    "end": "1305240"
  },
  {
    "text": "images but you know by default if you double click on the Excel spreadsheet it's just going to open up in Excel and",
    "start": "1305240",
    "end": "1310799"
  },
  {
    "text": "you're not going to see the Word document Okay so I'll run a quick demonstration here I've got the",
    "start": "1310799",
    "end": "1318919"
  },
  {
    "text": "utility called Merge Streams installed Here we",
    "start": "1318919",
    "end": "1324520"
  },
  {
    "text": "go on my system It's actually called",
    "start": "1324520",
    "end": "1330559"
  },
  {
    "text": "glue I go to my black hat directory and I",
    "start": "1331400",
    "end": "1337880"
  },
  {
    "text": "have Oops Take that back I have a Word document and I have an Excel spreadsheet",
    "start": "1337880",
    "end": "1344559"
  },
  {
    "text": "in the same directory Okay Now before I launch",
    "start": "1344559",
    "end": "1351039"
  },
  {
    "text": "this okay we see that the black hat.d do file is certain size about 56K The",
    "start": "1352200",
    "end": "1360799"
  },
  {
    "text": "spreadsheet is about 23K So I'll switch back over and tell it",
    "start": "1360799",
    "end": "1365919"
  },
  {
    "text": "to merge Okay merge complete That simple Close",
    "start": "1365919",
    "end": "1374240"
  },
  {
    "text": "that Hm have to maybe I need to run that",
    "start": "1375640",
    "end": "1383280"
  },
  {
    "text": "again Isn't the way Isn't this the way it always seems to work you do it you do a demonstration",
    "start": "1388760",
    "end": "1395440"
  },
  {
    "text": "just before the presentation everything goes fine You come in and you give it and it just doesn't work",
    "start": "1395440",
    "end": "1401480"
  },
  {
    "text": "Open Okay Merge Merge complete",
    "start": "1401480",
    "end": "1407200"
  },
  {
    "text": "Hopefully it'll work this time",
    "start": "1407200",
    "end": "1411080"
  },
  {
    "text": "[Music] No I used it in a different directory on a different partition So",
    "start": "1414690",
    "end": "1422039"
  },
  {
    "text": "um tell you what let's try this again Maybe put them in a different directory this time",
    "start": "1422080",
    "end": "1429880"
  },
  {
    "text": "Well the idea is that what I should have had was a black hat file black hat.doc",
    "start": "1440840",
    "end": "1448559"
  },
  {
    "text": "file that was a lot larger And if I ran say if I double clicked on black hat Then it would open",
    "start": "1448559",
    "end": "1455760"
  },
  {
    "text": "up in a word document and you would see the original word document If I had opened it up in Excel",
    "start": "1455760",
    "end": "1462720"
  },
  {
    "text": "though and changed the file extension to XLS and open it in Excel I'd see the Excel spreadsheet which in this case was",
    "start": "1462720",
    "end": "1467919"
  },
  {
    "text": "the uh schedule for GMU 2003 So what I what this tool",
    "start": "1467919",
    "end": "1473360"
  },
  {
    "text": "effectively lets us do is hide a Excel spreadsheet inside a word document or if I if I change the extensions vice versa",
    "start": "1473360",
    "end": "1484278"
  },
  {
    "text": "Um I I provided an update to the presentation that actually has notes",
    "start": "1484400",
    "end": "1489760"
  },
  {
    "text": "that should be on the website but the information for the merge streams utility is uh located at",
    "start": "1489760",
    "end": "1497440"
  },
  {
    "text": "www.entkernel.com So if you want to try it yourself again I uh not really sure what happened with the",
    "start": "1499559",
    "end": "1507039"
  },
  {
    "text": "demonstration We'll just proceed Just my luck It'll work later this",
    "start": "1508120",
    "end": "1513760"
  },
  {
    "text": "afternoon too Um another another little piece of",
    "start": "1513760",
    "end": "1520559"
  },
  {
    "text": "information about hiding files that most pe most of you are probably familiar with are hiding data within Word documents involves",
    "start": "1520559",
    "end": "1527080"
  },
  {
    "text": "metadata Uh this is information that's added to added by the program by Word.exe or Winword.exe automatically Uh",
    "start": "1527080",
    "end": "1534480"
  },
  {
    "text": "there's built-in document properties that are added There's u uh just",
    "start": "1534480",
    "end": "1539679"
  },
  {
    "text": "revision information that's maintained in the file itself Now this re revision information came out and uh bit Tony",
    "start": "1539679",
    "end": "1546000"
  },
  {
    "text": "Blair in the ass last year uh there's a website um by",
    "start": "1546000",
    "end": "1551960"
  },
  {
    "text": "computerman.com that has all the basic I see somebody smiling over here You seem to be familiar with it Um basically Tony",
    "start": "1551960",
    "end": "1559279"
  },
  {
    "text": "Blair's government put together a word document regarding information on u",
    "start": "1559279",
    "end": "1564320"
  },
  {
    "text": "intelligence information on the Iraq military the Iraq infrastructure Uh when they released it they released it in",
    "start": "1564320",
    "end": "1569440"
  },
  {
    "text": "Word format and uh you were able to go through and pull out the revision information out of the file Uh the",
    "start": "1569440",
    "end": "1575200"
  },
  {
    "text": "gentleman who maintains the website has a utility called WD.exe It's basically a",
    "start": "1575200",
    "end": "1580720"
  },
  {
    "text": "Java utility that was compiled into an exe with an associated DLL but it'll go through and pull out the revision log",
    "start": "1580720",
    "end": "1587440"
  },
  {
    "text": "Now a lot of times this is not necessarily available I've done some testing uh some limited testing using",
    "start": "1587440",
    "end": "1592880"
  },
  {
    "text": "metadata assistant and Pearl scripts that I've written myself A lot of times I won't be able to get the revision log",
    "start": "1592880",
    "end": "1598559"
  },
  {
    "text": "using metadata assistant or the word API available from Microsoft However this",
    "start": "1598559",
    "end": "1604240"
  },
  {
    "text": "utility will find it in some cases It's maintained in Unicode within the document So things like strings we'll",
    "start": "1604240",
    "end": "1611600"
  },
  {
    "text": "find it using the unic code switch if you're familiar with uh cis internals.com There's a lot of very very",
    "start": "1611600",
    "end": "1617200"
  },
  {
    "text": "interesting information that's out there There's also uh two other utilities that were used that were actually ports from",
    "start": "1617200",
    "end": "1622880"
  },
  {
    "text": "the Unix or the Linux world One was called cat do and the other one was called anti-word Uh this was used by an",
    "start": "1622880",
    "end": "1629279"
  },
  {
    "text": "individual from ATM research to go through and pull down I believe it was a 100,000 word documents off the net at",
    "start": "1629279",
    "end": "1634880"
  },
  {
    "text": "random and he was able to pull information out of that had been embedded in word documents that included",
    "start": "1634880",
    "end": "1641039"
  },
  {
    "text": "information such as network paths Um a lot of sensitive information that never",
    "start": "1641039",
    "end": "1646640"
  },
  {
    "text": "should have made it out Okay",
    "start": "1646640",
    "end": "1651960"
  },
  {
    "text": "Yes Can you say that again scrub Ice scrub Did everybody catch",
    "start": "1652159",
    "end": "1658200"
  },
  {
    "text": "that okay There's a tool called Ice Scrub How do you spell that i scrub Okay",
    "start": "1658200",
    "end": "1664799"
  },
  {
    "text": "Okay Ice Scrub is in Ice Scrub not EE Scrub or Eye E Yeah Okay Ice Scrub will",
    "start": "1664799",
    "end": "1671760"
  },
  {
    "text": "uh I'm told get rid of all that information Now the Microsoft site does",
    "start": "1671760",
    "end": "1677080"
  },
  {
    "text": "provide a document listing how you can go through and have it removed but uh you might want to scrub it or better yet",
    "start": "1677080",
    "end": "1684159"
  },
  {
    "text": "save it to another format Save it to a TXT format Um the information is removed",
    "start": "1684159",
    "end": "1689919"
  },
  {
    "text": "that way as well Any questions yes",
    "start": "1689919",
    "end": "1696080"
  },
  {
    "text": "Uh there's a tool called metadata assistant that will show you the information that's available for",
    "start": "1696799",
    "end": "1702080"
  },
  {
    "text": "download There's a demonstration version [Music] available Okay Anybody",
    "start": "1702080",
    "end": "1710679"
  },
  {
    "text": "else okay It's a little difficult for me to see out there because of the lights So throw something Not heavy",
    "start": "1710679",
    "end": "1718000"
  },
  {
    "text": "though I lean up there's a lot of information that can be pulled out for instance uh",
    "start": "1718000",
    "end": "1724720"
  },
  {
    "text": "just for giggles at work a lot of times you know I will see some information on the server or maybe uh somebody will",
    "start": "1724720",
    "end": "1730559"
  },
  {
    "text": "pass a word document that's a design document and I can go through and tell uh who's edited it for instance by",
    "start": "1730559",
    "end": "1735919"
  },
  {
    "text": "looking at the paths you know people will email it back and forth throughout the company it'll uh as an attachment",
    "start": "1735919",
    "end": "1741919"
  },
  {
    "text": "it'll be dropped into a certain directory and under my documents for the user you can walk through and see who's actually had access to that particular",
    "start": "1741919",
    "end": "1748240"
  },
  {
    "text": "version of the file it's kind of interesting um in the process of uh uh doing book",
    "start": "1748240",
    "end": "1756559"
  },
  {
    "text": "reviews and whatnot I've done the same thing to kind of find out where some of the uh the word documents had originated",
    "start": "1756559",
    "end": "1761679"
  },
  {
    "text": "and come from I've alo also seen where people have taken the the reviewer's guide in a word format and saved it as",
    "start": "1761679",
    "end": "1768000"
  },
  {
    "text": "TXT because they don't want their personal information to get out in a smart or save it as a",
    "start": "1768000",
    "end": "1774520"
  },
  {
    "text": "PDF Okay this is my favorite part of the presentation",
    "start": "1774520",
    "end": "1779600"
  },
  {
    "text": "NTFS alternate data streams Is anybody Is anybody in the room not familiar with alternate data streams okay we got one over here You",
    "start": "1779600",
    "end": "1787760"
  },
  {
    "text": "guys from Microsoft don't be afraid to raise your hands God what a rough crowd Okay",
    "start": "1787760",
    "end": "1795720"
  },
  {
    "text": "Uh uh NTFS alternate data streams It's a nice little uh feature shall we say of",
    "start": "1795720",
    "end": "1801279"
  },
  {
    "text": "the NTFS operating system uh going back and doing some research several years ago when I started taking a look at NTFS",
    "start": "1801279",
    "end": "1807679"
  },
  {
    "text": "alternate data streams I couldn't find any information literally maybe some scant references at Microsoft because",
    "start": "1807679",
    "end": "1813279"
  },
  {
    "text": "Microsoft refers to it literally as alternative data streams multiple data streams and alternate data streams They",
    "start": "1813279",
    "end": "1819200"
  },
  {
    "text": "use the the three variations So sometimes it's a little difficult to find information Basically NTFS alternate",
    "start": "1819200",
    "end": "1825360"
  },
  {
    "text": "data streams are part of the operating system because Microsoft wanted to support the Macintosh HFS file system",
    "start": "1825360",
    "end": "1832240"
  },
  {
    "text": "from the hierarchal file system at within the operating system itself not as part of the service that it provides",
    "start": "1832240",
    "end": "1838559"
  },
  {
    "text": "which you can uninstall So the Macintosh HFS actually stores files using two forks a data fork",
    "start": "1838559",
    "end": "1845039"
  },
  {
    "text": "and a resource fork Well what alternate data streams lets us do is it lets us create",
    "start": "1845039",
    "end": "1853159"
  },
  {
    "text": "files launch files all on the operating system",
    "start": "1853159",
    "end": "1859200"
  },
  {
    "text": "without any of the inherent tools of the operating system or of the resource kit",
    "start": "1859200",
    "end": "1864559"
  },
  {
    "text": "allowing us to view these [Music] files Okay now this is when I usually",
    "start": "1864559",
    "end": "1870480"
  },
  {
    "text": "expect it to kind of get quiet Again you can create files on the",
    "start": "1870480",
    "end": "1876240"
  },
  {
    "text": "system You can launch those files either executables or",
    "start": "1876240",
    "end": "1882559"
  },
  {
    "text": "scripts and the the person using the operating system or using the system will not be able to see the file itself",
    "start": "1882679",
    "end": "1890320"
  },
  {
    "text": "either using explorer diir or any of the tools available on the resource kit You",
    "start": "1890320",
    "end": "1895760"
  },
  {
    "text": "actually have to go out to places like cis internals found uh frank hindsight",
    "start": "1895760",
    "end": "1901360"
  },
  {
    "text": "uh hesoft.de ID you've got to go out to these sites to get this to get the tools to be able to view this these files Now",
    "start": "1901360",
    "end": "1909120"
  },
  {
    "text": "I believe recently there have been some projects out there to add the capability to the context menu or to the shell in",
    "start": "1909120",
    "end": "1915120"
  },
  {
    "text": "some way Uh I've I've seen them I found references to them I haven't actually seen some of the source code and been",
    "start": "1915120",
    "end": "1921360"
  },
  {
    "text": "been able to try it Okay But that seems very interesting and it's it's something you might want to think about once we",
    "start": "1921360",
    "end": "1926559"
  },
  {
    "text": "get done here today So we can create alternate data streams Well how we go about doing that there's several tools",
    "start": "1926559",
    "end": "1933360"
  },
  {
    "text": "on the system that let us create alternate data streams CP.exe from the",
    "start": "1933360",
    "end": "1938480"
  },
  {
    "text": "resource kit will let us create alternate data streams But we have type the type command We have the echo",
    "start": "1938480",
    "end": "1945320"
  },
  {
    "text": "command Okay So let's go ahead and uh create a couple of alternate data",
    "start": "1945320",
    "end": "1951200"
  },
  {
    "text": "streams Those of you that have your laptops up that have NTFS on them feel free to follow along Anybody ask any",
    "start": "1951200",
    "end": "1957279"
  },
  {
    "text": "questions at any point Okay So we're going to create an alternate data stream We'll start This",
    "start": "1957279",
    "end": "1963760"
  },
  {
    "text": "is our directory listing I've got a couple of files PowerPoint file Word document my file.txt",
    "start": "1963760",
    "end": "1971159"
  },
  {
    "text": "Okay Like a",
    "start": "1971159",
    "end": "1977360"
  },
  {
    "text": "file Okay We see the file we just created 17",
    "start": "1978840",
    "end": "1985799"
  },
  {
    "text": "bytes Okay",
    "start": "1985799",
    "end": "1989919"
  },
  {
    "text": "Here we go Notice the",
    "start": "2002679",
    "end": "2008760"
  },
  {
    "text": "syntax We simply put a colon That gives us an alternate data stream",
    "start": "2008760",
    "end": "2016360"
  },
  {
    "text": "I run the diir command again I have no file listed by diir called",
    "start": "2019600",
    "end": "2025559"
  },
  {
    "text": "ads.txt And my original file filet txt it's sized It's not al been altered in",
    "start": "2025559",
    "end": "2031440"
  },
  {
    "text": "any way",
    "start": "2031440",
    "end": "2034679"
  },
  {
    "text": "Say say again The date and time Yes the uh the last modification time will be",
    "start": "2036559",
    "end": "2041799"
  },
  {
    "text": "updated because you've written to the file but the file size doesn't change in any",
    "start": "2041799",
    "end": "2048320"
  },
  {
    "text": "way Okay So let's try something",
    "start": "2048520",
    "end": "2055679"
  },
  {
    "text": "else I said we could launch you know files from within the uh alternate data",
    "start": "2056520",
    "end": "2062000"
  },
  {
    "text": "streams",
    "start": "2062000",
    "end": "2065000"
  },
  {
    "text": "Okay I ran the type command If I didn't redirect the output to a file what would happen the contents of the file would",
    "start": "2074960",
    "end": "2082079"
  },
  {
    "text": "appear on the screen and just a bunch of gobbledygook would go by My my laptop would beep sound like it's having fits",
    "start": "2082079",
    "end": "2088480"
  },
  {
    "text": "Okay so I redirected it to a file Again file.txt TXT has not been",
    "start": "2088480",
    "end": "2095200"
  },
  {
    "text": "changed in its size in any way Okay",
    "start": "2095200",
    "end": "2104319"
  },
  {
    "text": "So didn't find it Nope Still didn't find it",
    "start": "2111640",
    "end": "2121640"
  },
  {
    "text": "I'm trying to find that file that we created since we know the name of",
    "start": "2122320",
    "end": "2126960"
  },
  {
    "text": "it There we go Wow DIR doesn't find it but Notepad does",
    "start": "2132440",
    "end": "2141160"
  },
  {
    "text": "So I can effectively place pretty much any information I want into alternate data",
    "start": "2142880",
    "end": "2148680"
  },
  {
    "text": "streams text information Is everybody familiar with the with the uh the guy that was arrested in Manhattan recently",
    "start": "2148680",
    "end": "2155359"
  },
  {
    "text": "just last year the guy that like to go to Kinko and put key loggers on all the systems The guy that captured 450",
    "start": "2155359",
    "end": "2162640"
  },
  {
    "text": "individuals online banking usernames and passwords the guy that created all the fraudulent accounts on those people's",
    "start": "2162640",
    "end": "2170200"
  },
  {
    "text": "accounts The guy that got caught because he got somebody's go to my PC account and broke into the guy's PC used that PC",
    "start": "2170200",
    "end": "2176960"
  },
  {
    "text": "to go to the guy's bank site and open other accounts all the time The guy was just sitting there watching him at you",
    "start": "2176960",
    "end": "2182640"
  },
  {
    "text": "know watching the mouse and the everything move around on his screen I'm not making this up Go to",
    "start": "2182640",
    "end": "2189480"
  },
  {
    "text": "cybercrime.gov and look at the press releases It's there It's pretty interesting information But you know he",
    "start": "2189480",
    "end": "2195680"
  },
  {
    "text": "could very well have just collected the information and hid it in hidden it in alternate data stream Nobody would ever",
    "start": "2195680",
    "end": "2201280"
  },
  {
    "text": "know it was on the system",
    "start": "2201280",
    "end": "2204920"
  },
  {
    "text": "It's a good question I I see you don't have a laptop Usually the way I answer that is try and",
    "start": "2208640",
    "end": "2213839"
  },
  {
    "text": "let me [Music] know But let's give it a shot",
    "start": "2213839",
    "end": "2218960"
  },
  {
    "text": "Oh sorry The question was \"Will Notepad save changes to the file any bidders any",
    "start": "2218960",
    "end": "2225680"
  },
  {
    "text": "bets pretty resounding Okay how about this",
    "start": "2225680",
    "end": "2231920"
  },
  {
    "text": "we'll make a change to this file We'll do a",
    "start": "2231920",
    "end": "2236800"
  },
  {
    "text": "save Okay there he",
    "start": "2237320",
    "end": "2245000"
  },
  {
    "text": "goes DI doesn't recognize alternate data streams Explorer doesn't recognize alternate data streams Notepad does Very",
    "start": "2245000",
    "end": "2255280"
  },
  {
    "text": "interesting Okay Now I created an alternate data stream Let's see Let me",
    "start": "2255400",
    "end": "2261920"
  },
  {
    "text": "do G",
    "start": "2261920",
    "end": "2266000"
  },
  {
    "text": "col there Okay I created an ultimate data stream using Notepad I called it np.exe I made",
    "start": "2268920",
    "end": "2276560"
  },
  {
    "text": "the claim that we could run it How would we go about doing that",
    "start": "2276560",
    "end": "2283520"
  },
  {
    "text": "how would I launch Notepad from within an alternate data stream i mean I've got the executable in",
    "start": "2283520",
    "end": "2289440"
  },
  {
    "text": "there It's got aexe extension Any ideas say again",
    "start": "2289440",
    "end": "2296400"
  },
  {
    "text": "Okay that's that's good Try",
    "start": "2296400",
    "end": "2300960"
  },
  {
    "text": "that Huh Well that worked on NT",
    "start": "2304520",
    "end": "2311760"
  },
  {
    "text": "that came out in uh Hacking Exposed That's been out for a while but",
    "start": "2311760",
    "end": "2317040"
  },
  {
    "text": "that worked on NT It's I've got an XP system Any other",
    "start": "2317040",
    "end": "2321839"
  },
  {
    "text": "ideas say again command How about",
    "start": "2322200",
    "end": "2328720"
  },
  {
    "text": "this relative or absolute path",
    "start": "2331560",
    "end": "2336680"
  },
  {
    "text": "so imagine I can do this with Notepad Notepad's a nice little gooey program 56",
    "start": "2337920",
    "end": "2345079"
  },
  {
    "text": "kilobytes How about Netcat a lot of the documentation out",
    "start": "2345079",
    "end": "2350560"
  },
  {
    "text": "there on running Netcat on a system involves using the start command too You can put a backdoor",
    "start": "2350560",
    "end": "2356760"
  },
  {
    "text": "listener launch it associated with uh you know I don't know port",
    "start": "2356760",
    "end": "2362440"
  },
  {
    "text": "80 bind cmd.exe to it There you go launch it from an alternate data stream",
    "start": "2362440",
    "end": "2370680"
  },
  {
    "text": "The question is do anti virus software does that scan alternate data streams i'm told that uh computer associates",
    "start": "2375119",
    "end": "2383640"
  },
  {
    "text": "does Okay I'm somewhat limited to the number of anti virus software that I have access to I'm told that computer",
    "start": "2383640",
    "end": "2390640"
  },
  {
    "text": "associates antivirus software does look in alternate data streams Um I was at an is ISS conference a",
    "start": "2390640",
    "end": "2398480"
  },
  {
    "text": "little while ago and I asked Trend Micros representative again uh I you know to def in Trend Micro's defense it",
    "start": "2398480",
    "end": "2405119"
  },
  {
    "text": "was a marketing representative and I said does your anti virus product handle alternate data streams and the answer I",
    "start": "2405119",
    "end": "2411359"
  },
  {
    "text": "got was yes we have modules for exchange at that point I said thank you",
    "start": "2411359",
    "end": "2417359"
  },
  {
    "text": "very much and took some aspirin Uh but again it was it was a marketing",
    "start": "2417359",
    "end": "2423720"
  },
  {
    "text": "individual So if I can access things from the command prompt I can you know with alternate data streams I can do so",
    "start": "2423720",
    "end": "2430240"
  },
  {
    "text": "programmatically as well All it takes to create an alternate data stream uh literally on the create file API you",
    "start": "2430240",
    "end": "2437359"
  },
  {
    "text": "simply if you want to open a file launch it or you want to create it using the create file API all you have to do is",
    "start": "2437359",
    "end": "2442480"
  },
  {
    "text": "add the colon that's it and gives you access Again tools like uh sfind from",
    "start": "2442480",
    "end": "2448760"
  },
  {
    "text": "boundstone streams from cis internals uh lads.exe ls.exe will all help you find",
    "start": "2448760",
    "end": "2456079"
  },
  {
    "text": "alternate data streams Um crucial security based out of Chantelli Virginia has a graphical uh",
    "start": "2456079",
    "end": "2463200"
  },
  {
    "text": "utility that will let you find alternate data streams but for incident response purposes and getting the information off",
    "start": "2463200",
    "end": "2468400"
  },
  {
    "text": "the system I prefer to use a command line utilities I do believe",
    "start": "2468400",
    "end": "2474920"
  },
  {
    "text": "uh let's take a quick look",
    "start": "2474960",
    "end": "2478078"
  },
  {
    "text": "here Ah there it is XC to D",
    "start": "2480920",
    "end": "2487880"
  },
  {
    "text": "colon There we go Anybody unfamiliar with the dark",
    "start": "2487880",
    "end": "2493119"
  },
  {
    "text": "place the command prompts reason I ask is I've taught some incident response courses uh with",
    "start": "2493119",
    "end": "2500160"
  },
  {
    "text": "Windows 2000 and I I can't believe how difficult it is to get some people to open up a command prompt They're just",
    "start": "2500160",
    "end": "2506240"
  },
  {
    "text": "completely unfamiliar with it How to move around in a command prompt I'm going to run this is the LA utility from",
    "start": "2506240",
    "end": "2512079"
  },
  {
    "text": "Frank Hine Very useful It's freeware I'm using version 3.10 Uh this lets me see the alternate",
    "start": "2512079",
    "end": "2518560"
  },
  {
    "text": "data streams associated with my current directory There's simple command line switches you can use to recursively search directories and whatnot However",
    "start": "2518560",
    "end": "2525359"
  },
  {
    "text": "the outputs command line it's very easy to parse using uh scripting tools Uh",
    "start": "2525359",
    "end": "2530960"
  },
  {
    "text": "redirect it to a file parts it out get the pertinent information provides the complete path to the uh alternate data",
    "start": "2530960",
    "end": "2538880"
  },
  {
    "text": "stream Okay now I'm sure the question on all your all minds right now is what",
    "start": "2539319",
    "end": "2544640"
  },
  {
    "text": "does this look like in task manager is anybody thinking that is everybody trying desperately to",
    "start": "2544640",
    "end": "2550720"
  },
  {
    "text": "stay awake say again If you were to search for the",
    "start": "2550720",
    "end": "2557720"
  },
  {
    "text": "text would it find it in the ads if you were to search the question is if",
    "start": "2557720",
    "end": "2563440"
  },
  {
    "text": "you were to search for the text would it find it in the ads again anybody want to place bets on",
    "start": "2563440",
    "end": "2570960"
  },
  {
    "text": "that",
    "start": "2570960",
    "end": "2573960"
  },
  {
    "text": "it would find it Okay Okay Well let's give it a shot What",
    "start": "2576079",
    "end": "2582560"
  },
  {
    "text": "do you want to use laptop",
    "start": "2582560",
    "end": "2588079"
  },
  {
    "text": "Anybody else got a laptop come on This is a computer convention Don't tell me nobody else has",
    "start": "2588079",
    "end": "2593520"
  },
  {
    "text": "got a laptop Fine String What do you want to use",
    "start": "2593520",
    "end": "2601520"
  },
  {
    "text": "okay I'll open up Exploder",
    "start": "2601520",
    "end": "2605560"
  },
  {
    "text": "I'm going to leave this open because I want there's something I want to show you what the process is",
    "start": "2607839",
    "end": "2613200"
  },
  {
    "text": "And please excuse the America online icon",
    "start": "2615280",
    "end": "2622240"
  },
  {
    "text": "Okay there's my directory Oops Okay there's all the",
    "start": "2622599",
    "end": "2630359"
  },
  {
    "text": "utilities What now",
    "start": "2630359",
    "end": "2634680"
  },
  {
    "text": "say that again search Right Exactly Walk me through what you want me to do We're",
    "start": "2638800",
    "end": "2645280"
  },
  {
    "text": "going to do it your way Gotcha",
    "start": "2645280",
    "end": "2652040"
  },
  {
    "text": "Okay Search Yeah that's what you want Okay",
    "start": "2660520",
    "end": "2666119"
  },
  {
    "text": "You just want to search for data stream",
    "start": "2668240",
    "end": "2672839"
  },
  {
    "text": "Oh sorry Sorry You're",
    "start": "2676400",
    "end": "2680240"
  },
  {
    "text": "right Is that good i can't change my question",
    "start": "2681720",
    "end": "2686820"
  },
  {
    "text": "[Music] I'm I'm just going to use three words Another alternate data Does that sound",
    "start": "2686820",
    "end": "2692079"
  },
  {
    "text": "good okay Okay Well we we'll just reduce it to one",
    "start": "2692079",
    "end": "2698400"
  },
  {
    "text": "word",
    "start": "2698400",
    "end": "2700640"
  },
  {
    "text": "then Huh black hat is my submission to be",
    "start": "2707720",
    "end": "2714720"
  },
  {
    "text": "able to stand up here and talk to you guys today So that's got the word alternate",
    "start": "2714720",
    "end": "2720640"
  },
  {
    "text": "in it The presentation we're looking at datahiding.pppt has the word alternate in",
    "start": "2720640",
    "end": "2726440"
  },
  {
    "text": "it Noah alternate data stream",
    "start": "2726440",
    "end": "2731560"
  },
  {
    "text": "Right Well I I I would hesitate to use the",
    "start": "2731920",
    "end": "2737599"
  },
  {
    "text": "word existing because the alternate the file in the alternate data stream is also an existing file",
    "start": "2737599",
    "end": "2744160"
  },
  {
    "text": "It find it parses the files it knows about or it's able to recognize as files",
    "start": "2744160",
    "end": "2751480"
  },
  {
    "text": "Okay Any any other any other what happens if",
    "start": "2751480",
    "end": "2757640"
  },
  {
    "text": "about manager is this",
    "start": "2757640",
    "end": "2763200"
  },
  {
    "text": "the Microsoft quota manager um to be honest I'm not sure but if you",
    "start": "2763200",
    "end": "2768400"
  },
  {
    "text": "create multiple alternate data streams it does show up as a change in the available drive space So if you were if",
    "start": "2768400",
    "end": "2774880"
  },
  {
    "text": "you were to create a little utility that did nothing but copy uh you know a 300 kilobyte DL into multiple alternate data",
    "start": "2774880",
    "end": "2781720"
  },
  {
    "text": "streams then you would progressively see a drop in available drive space",
    "start": "2781720",
    "end": "2789000"
  },
  {
    "text": "And the limit the the limit to the number of alternate data streams I can append to any single file is",
    "start": "2789200",
    "end": "2797000"
  },
  {
    "text": "what it's how much hard drive space I've got left There's a question over here Yes",
    "start": "2797000",
    "end": "2803119"
  },
  {
    "text": "right there",
    "start": "2803119",
    "end": "2806359"
  },
  {
    "text": "Okay Yeah you're you're jumping a little bit ahead We'll get to that That's that's got some Can you another ads can",
    "start": "2809440",
    "end": "2818400"
  },
  {
    "text": "you nest them within another ads i haven't been able to do it yet Um but then I might have just been trying the",
    "start": "2818400",
    "end": "2823760"
  },
  {
    "text": "wrong things And by that I assume you mean multiple multiple colons in the file",
    "start": "2823760",
    "end": "2829240"
  },
  {
    "text": "name I I haven't been able to get that to work but I have been able to add just an arbitrary number of alternate data",
    "start": "2829240",
    "end": "2834480"
  },
  {
    "text": "streams to any single file as as we've done in the demonstration we've already got two alternate data streams associated with the same file and we can",
    "start": "2834480",
    "end": "2841599"
  },
  {
    "text": "do 200 2,00 and again it's based on drive space",
    "start": "2841599",
    "end": "2847960"
  },
  {
    "text": "The question is does the NTFS change journal record those um",
    "start": "2850880",
    "end": "2857000"
  },
  {
    "text": "is that you Mark i I can't see out there Okay",
    "start": "2858640",
    "end": "2865960"
  },
  {
    "text": "Um we had a discussion earlier about the indexing service and uh I guess it was",
    "start": "2865960",
    "end": "2871760"
  },
  {
    "text": "the backup software Yeah Okay Um I haven't noticed",
    "start": "2871760",
    "end": "2877599"
  },
  {
    "text": "any change to the change journal itself but then again I'm I I've been looking and talking to people at Microsoft",
    "start": "2877599",
    "end": "2883920"
  },
  {
    "text": "trying to get a utility that will allow me to to view uh the change journal on a",
    "start": "2883920",
    "end": "2889040"
  },
  {
    "text": "system just like a regular system that doesn't have anything else installed on it So far I haven't been able to",
    "start": "2889040",
    "end": "2894079"
  },
  {
    "text": "determine any change I haven't given up looking but uh I haven't seen anything",
    "start": "2894079",
    "end": "2900078"
  },
  {
    "text": "yet Anything else okay I said I wanted to take a look at",
    "start": "2901319",
    "end": "2908559"
  },
  {
    "text": "something that had to do with the processes Now this is something that",
    "start": "2908559",
    "end": "2913920"
  },
  {
    "text": "popped up on uh Windows XP Actually I didn't I don't get this on my 2000 system but I want to look at what this",
    "start": "2913920",
    "end": "2920160"
  },
  {
    "text": "stuff looks like while it's running So I left I left Notepad that we launched from the alternate data stream I left it",
    "start": "2920160",
    "end": "2925359"
  },
  {
    "text": "running so we can look at it through task manager So when I look at the applications I see that uh there's an",
    "start": "2925359",
    "end": "2930400"
  },
  {
    "text": "untitled document running in notepad Okay I have my regular notepad notepad I",
    "start": "2930400",
    "end": "2937680"
  },
  {
    "text": "have one here But let's take a look at the processes I'll go ahead and sort these",
    "start": "2937680",
    "end": "2942839"
  },
  {
    "text": "things Look at that I know you can't see that way back there but what this says is remember we",
    "start": "2942839",
    "end": "2951440"
  },
  {
    "text": "launched the alternate data stream and now we have notepad open What",
    "start": "2951440",
    "end": "2956960"
  },
  {
    "text": "this shows is file.txt colon np.exe as a running",
    "start": "2956960",
    "end": "2963720"
  },
  {
    "text": "process So a change they made between Windows 2000 and Windows XP and this",
    "start": "2963720",
    "end": "2969280"
  },
  {
    "text": "continues over to 2003 as well processes run from within alternate data",
    "start": "2969280",
    "end": "2975240"
  },
  {
    "text": "streams You can see them in the task [Music] manager So they do look a little bit",
    "start": "2975240",
    "end": "2981440"
  },
  {
    "text": "unusual They have the colon associated with them Yes",
    "start": "2981440",
    "end": "2987318"
  },
  {
    "text": "Uhhuh",
    "start": "2987520",
    "end": "2990520"
  },
  {
    "text": "Well let's let's let's think about that for a minute question is if I copy this file to another",
    "start": "2994079",
    "end": "3000680"
  },
  {
    "text": "directory is that the question just just a directory does it have to be on the same machine same partitions",
    "start": "3000680",
    "end": "3008280"
  },
  {
    "text": "okay the question is does the AP does the ads go with the file any guesses",
    "start": "3010000",
    "end": "3017119"
  },
  {
    "text": "who said no somebody yes why you're the only one the the only",
    "start": "3017119",
    "end": "3023760"
  },
  {
    "text": "reason I'm picking on you is because you said no and you're the only What",
    "start": "3023760",
    "end": "3029078"
  },
  {
    "text": "i heard it probably in there Okay Yeah Okay that's a good",
    "start": "3034319",
    "end": "3041160"
  },
  {
    "text": "guess Let's go ahead and take a look Let's find",
    "start": "3041160",
    "end": "3045440"
  },
  {
    "text": "out Okay in my black hat directory here I'm",
    "start": "3049480",
    "end": "3054720"
  },
  {
    "text": "going to go to another partition in this case Uh let's go to the C drive I want",
    "start": "3054720",
    "end": "3060680"
  },
  {
    "text": "my tools directory Here we go Because there's a copy of latch there",
    "start": "3060680",
    "end": "3066119"
  },
  {
    "text": "already So I got my two copies of Exploder open I'm going to take",
    "start": "3066119",
    "end": "3072440"
  },
  {
    "text": "file I'm going to copy it over Copy Is that good not going to move it Just going to copy it Go back to my command",
    "start": "3072440",
    "end": "3081160"
  },
  {
    "text": "prompt Takes me back to the tools directory I confirm that the file is there and the",
    "start": "3081160",
    "end": "3087520"
  },
  {
    "text": "file 17 bytes in size since I have a copy of lads in this",
    "start": "3087520",
    "end": "3094558"
  },
  {
    "text": "directory What do you know both alternate data streams got",
    "start": "3095319",
    "end": "3102640"
  },
  {
    "text": "copied over Why is that",
    "start": "3102640",
    "end": "3106680"
  },
  {
    "text": "yeah NTFS supports alternate data streams Yeah",
    "start": "3108079",
    "end": "3114240"
  },
  {
    "text": "If you do a copy like if you if you do a file share copy using that BIOS even to",
    "start": "3114240",
    "end": "3120400"
  },
  {
    "text": "another system the alternate data stream will go I've done this in my home lab I've done it at uh a couple of other",
    "start": "3120400",
    "end": "3126800"
  },
  {
    "text": "offices where we've had you know a Windows network setup Uh FTP doesn't",
    "start": "3126800",
    "end": "3133280"
  },
  {
    "text": "understand alternate data stream so it doesn't get copied If you copy it over to a discet",
    "start": "3133280",
    "end": "3139440"
  },
  {
    "text": "it won't get copied if the discet is formatted fat And I uh caveat that because there",
    "start": "3139440",
    "end": "3145680"
  },
  {
    "text": "is a utility out there that will let you format discets in TFS at the CIS internal",
    "start": "3145680",
    "end": "3151480"
  },
  {
    "text": "site So this leads us to this jumps us ahead a little bit but this also tells us how we can get rid of alternate data",
    "start": "3151480",
    "end": "3157839"
  },
  {
    "text": "streams Question comment Uh is it the same if you use copy or comp if you use",
    "start": "3157839",
    "end": "3162880"
  },
  {
    "text": "what now copy or something Okay let's let's give it a shot with copy",
    "start": "3162880",
    "end": "3168720"
  },
  {
    "text": "Actually let me go back there and get rid of that",
    "start": "3168720",
    "end": "3173079"
  },
  {
    "text": "Well the way the alternate data stream works is that it's actually associated with the file named in the",
    "start": "3177200",
    "end": "3184280"
  },
  {
    "text": "MFTt Okay so if you delete the file named in the MFT in this case my file.txt txt all the other information",
    "start": "3184280",
    "end": "3191280"
  },
  {
    "text": "associated with it goes away as well Okay so I' I've just deleted file.txt",
    "start": "3191280",
    "end": "3196800"
  },
  {
    "text": "from the tools directory If I run lads again okay I have no alternate data streams So I've confirmed I've gotten",
    "start": "3196800",
    "end": "3202960"
  },
  {
    "text": "rid of it So let's try You want to try copy right okay",
    "start": "3202960",
    "end": "3211160"
  },
  {
    "text": "So again I've copied the file over using the copy command There we",
    "start": "3219440",
    "end": "3226440"
  },
  {
    "text": "go Very neat Excuse me Oh try that Okay let's",
    "start": "3226440",
    "end": "3233040"
  },
  {
    "text": "delete file",
    "start": "3233040",
    "end": "3235680"
  },
  {
    "text": "again Any special switches you want to use",
    "start": "3242760",
    "end": "3247599"
  },
  {
    "text": "okay Okay So we go to the C",
    "start": "3250920",
    "end": "3258880"
  },
  {
    "text": "directory Okay We've got file back Oops There we go Copy and X copy both",
    "start": "3259720",
    "end": "3267359"
  },
  {
    "text": "work Now this is simply crossing partitions okay okay But if you're on a Windows network and you've got the the",
    "start": "3267359",
    "end": "3273760"
  },
  {
    "text": "file sharing going on it'll work the same way Is anybody like freaked out by",
    "start": "3273760",
    "end": "3282359"
  },
  {
    "text": "this anybody at all okay Say",
    "start": "3282359",
    "end": "3289359"
  },
  {
    "text": "again Does what work the same way oh uh copying over uh network using",
    "start": "3290839",
    "end": "3297119"
  },
  {
    "text": "Microsoft file sharing does work the same way right but uh say downloading if",
    "start": "3297119",
    "end": "3302400"
  },
  {
    "text": "say you've got an IIS server running for instance and you attach an alternate data stream to a GIF image on one of",
    "start": "3302400",
    "end": "3307920"
  },
  {
    "text": "your web pages or a JPEG and you download the the file that way it's not going to work HTTP FTP they don't",
    "start": "3307920",
    "end": "3314880"
  },
  {
    "text": "understand it Yes If you zip it",
    "start": "3314880",
    "end": "3322680"
  },
  {
    "text": "God where do you guys come up with this stuff",
    "start": "3322680",
    "end": "3328119"
  },
  {
    "text": "what's that",
    "start": "3328319",
    "end": "3331640"
  },
  {
    "text": "okay I'm going to I'm going to I'm going to entertain the little zip suggestion here but",
    "start": "3340880",
    "end": "3346720"
  },
  {
    "text": "yes copy Uh the question from up front is when",
    "start": "3347880",
    "end": "3354160"
  },
  {
    "text": "you're creating the alternate data streams when you're creating them initially do you have to use cop or can you use copy or xc copy or can you use",
    "start": "3354160",
    "end": "3361480"
  },
  {
    "text": "cp um I haven't actually tried using copy and I'm not really sure how I would go about doing that If I want to create",
    "start": "3361480",
    "end": "3368720"
  },
  {
    "text": "an altered data stream to begin with I use either the type or the echo command Yeah Yeah Copy lets us move it back and",
    "start": "3368720",
    "end": "3374799"
  },
  {
    "text": "forth Yes This motor does the stuff I mean if",
    "start": "3374799",
    "end": "3379839"
  },
  {
    "text": "there's a scenario right",
    "start": "3379839",
    "end": "3384520"
  },
  {
    "text": "which disc quota does this come from uh I haven't noticed really any difference",
    "start": "3387680",
    "end": "3392799"
  },
  {
    "text": "uh in in a corporate environment where most users have a home drive up on a file server someplace Um I'm able to",
    "start": "3392799",
    "end": "3399440"
  },
  {
    "text": "create them on my if as long as it's NTFS I'm able to create them copy them up to the file system Um other users",
    "start": "3399440",
    "end": "3406880"
  },
  {
    "text": "that only have access to their home home drives are able to create them as well I'm not sure I understand the question",
    "start": "3406880",
    "end": "3414760"
  },
  {
    "text": "Ah okay The question is will disqu prevent us from creating alternate data",
    "start": "3415599",
    "end": "3421200"
  },
  {
    "text": "streams right Okay The question is will this",
    "start": "3421200",
    "end": "3426559"
  },
  {
    "text": "quota prevent us from creating large or multiple alternate data streams i'm guessing that it would if we were given",
    "start": "3426559",
    "end": "3432559"
  },
  {
    "text": "a quota I'm guessing that it would I haven't actually tried it yet",
    "start": "3432559",
    "end": "3439480"
  },
  {
    "text": "Ah good question Why don't you turn to the guy at Microsoft and ask him",
    "start": "3442240",
    "end": "3449240"
  },
  {
    "text": "well you're asking me Uh the question is can you configure the operating system to not support alternate data streams",
    "start": "3450040",
    "end": "3457200"
  },
  {
    "text": "yeah you can Format it fat",
    "start": "3457200",
    "end": "3462599"
  },
  {
    "text": "I'm sorry that's it Uh you know when I started looking at this you know and looking at going just",
    "start": "3463520",
    "end": "3469599"
  },
  {
    "text": "solely on the Microsoft information they said well what I understood was we want to support HFS Okay And they did it",
    "start": "3469599",
    "end": "3477280"
  },
  {
    "text": "through the operating system through the file system rather than going through the service",
    "start": "3477280",
    "end": "3482760"
  },
  {
    "text": "So yes",
    "start": "3482760",
    "end": "3486760"
  },
  {
    "text": "right As as Mark stated in the back there you can use uh ACL on the file",
    "start": "3494119",
    "end": "3499520"
  },
  {
    "text": "system to prevent right access Okay But users need to be able to write to some",
    "start": "3499520",
    "end": "3505760"
  },
  {
    "text": "portion of the drive",
    "start": "3505760",
    "end": "3509319"
  },
  {
    "text": "Okay Really okay",
    "start": "3513119",
    "end": "3521240"
  },
  {
    "text": "Right [Music]",
    "start": "3523280",
    "end": "3528289"
  },
  {
    "text": "Did everybody catch that basically what Mark's saying is using the ACL's on the system Am I correct",
    "start": "3529680",
    "end": "3535839"
  },
  {
    "text": "Mark that's that's the in a nutshell",
    "start": "3535839",
    "end": "3541480"
  },
  {
    "text": "right right",
    "start": "3542240",
    "end": "3549559"
  },
  {
    "text": "Ah okay That's good That's good to know So it's not so much configuring the operating system per se but it's uh the",
    "start": "3549760",
    "end": "3556640"
  },
  {
    "text": "access control lists modifying the access control lists on on the system itself",
    "start": "3556640",
    "end": "3562240"
  },
  {
    "text": "And that extends to other areas of the presentation as well you know with regards to uh data hiding installing",
    "start": "3562240",
    "end": "3569559"
  },
  {
    "text": "software things like that You know if you don't give users the ability to write to the run key then some of the some of the spyware and the malware that",
    "start": "3569559",
    "end": "3576240"
  },
  {
    "text": "gets on the systems isn't active That just goes back to basic uh well maybe not basic but system administration",
    "start": "3576240",
    "end": "3584760"
  },
  {
    "text": "Okay any questions yes I see a hand up",
    "start": "3585280",
    "end": "3591119"
  },
  {
    "text": "backf",
    "start": "3591119",
    "end": "3594119"
  },
  {
    "text": "just NTFS Yes One additional",
    "start": "3596160",
    "end": "3604319"
  },
  {
    "text": "thing you'll get the primary screen Okay let's try that Uh",
    "start": "3604920",
    "end": "3611760"
  },
  {
    "text": "if you're validating data based on where we get access",
    "start": "3611760",
    "end": "3618720"
  },
  {
    "text": "right right",
    "start": "3618720",
    "end": "3623400"
  },
  {
    "text": "Like that Say say it again Right",
    "start": "3626640",
    "end": "3633920"
  },
  {
    "text": "Two colins Okay",
    "start": "3633920",
    "end": "3639720"
  },
  {
    "text": "Oh Ah gotcha",
    "start": "3642920",
    "end": "3647480"
  },
  {
    "text": "Is it one or two colons okay Uh this this goes back the",
    "start": "3652720",
    "end": "3658640"
  },
  {
    "text": "gentleman up front here was talking about one of the old IIS vulnerabilities being able to view source code It",
    "start": "3658640",
    "end": "3663920"
  },
  {
    "text": "actually refers to alternate data streams Um it's good to try It's always good to try new things See if something",
    "start": "3663920",
    "end": "3670160"
  },
  {
    "text": "works",
    "start": "3670160",
    "end": "3673160"
  },
  {
    "text": "Okay More less than like that with one more colon You got your laptop",
    "start": "3679200",
    "end": "3687319"
  },
  {
    "text": "up Okay there you go I've got That's the",
    "start": "3687319",
    "end": "3693680"
  },
  {
    "text": "contents of the primary stream though right",
    "start": "3693680",
    "end": "3700119"
  },
  {
    "text": "okay Well lads here we go We've got these alternate data streams on our system We",
    "start": "3700119",
    "end": "3706400"
  },
  {
    "text": "talked about uh getting rid of these alternate data streams by moving them over to another file system What if I",
    "start": "3706400",
    "end": "3711520"
  },
  {
    "text": "don't what if I'm running an all Microsoft shop and I don't necessarily have a file system that's big enough for",
    "start": "3711520",
    "end": "3716720"
  },
  {
    "text": "me to move it over to even sketch how about this",
    "start": "3716720",
    "end": "3724519"
  },
  {
    "text": "huh try this one Oops Didn't take that",
    "start": "3737400",
    "end": "3743920"
  },
  {
    "text": "either That's because it doesn't find it How about [Music]",
    "start": "3744920",
    "end": "3751240"
  },
  {
    "text": "this remember this is how we created the original alternate data stream",
    "start": "3751240",
    "end": "3757119"
  },
  {
    "text": "first one we created Uh cannot access the file because it's being used by another process Okay now we're getting",
    "start": "3757119",
    "end": "3763240"
  },
  {
    "text": "somewhere Close that process Get rid of that process just to be",
    "start": "3763240",
    "end": "3769920"
  },
  {
    "text": "sure There we go How many uh executable files out",
    "start": "3772119",
    "end": "3778240"
  },
  {
    "text": "there that are four bytes in size are very effective this is what a zero and a",
    "start": "3778240",
    "end": "3783680"
  },
  {
    "text": "carriage return I think zero space in a carriage return So that's one way of getting rid",
    "start": "3783680",
    "end": "3789280"
  },
  {
    "text": "of the alternate data streams if you don't have access to you know a convenience uh drive out there someplace",
    "start": "3789280",
    "end": "3794319"
  },
  {
    "text": "on your network that's formatted",
    "start": "3794319",
    "end": "3797440"
  },
  {
    "text": "fat Okay the question up here is can you can you not just delete the alternate data stream well we really don't have",
    "start": "3801799",
    "end": "3808400"
  },
  {
    "text": "access to it using tools like delete We can delete the file okay the main file But what if it's",
    "start": "3808400",
    "end": "3815200"
  },
  {
    "text": "a interesting little side effect that that leads us into is if you do a search on alternate data streams at the",
    "start": "3815200",
    "end": "3821440"
  },
  {
    "text": "Microsoft site and include Windows file protection you're going to get a knowledgebased article that says that",
    "start": "3821440",
    "end": "3826480"
  },
  {
    "text": "the files protected with Windows file protection you can add an alternate data stream to it and Windows file protection",
    "start": "3826480",
    "end": "3833680"
  },
  {
    "text": "won't even notice because it's concerned with the primary stream",
    "start": "3833680",
    "end": "3839039"
  },
  {
    "text": "So what does that mean if we have Windows file protection running and we uh uh cmd.exe is a good example It's a",
    "start": "3839039",
    "end": "3845680"
  },
  {
    "text": "protected file on XP If I add an alternate data stream to that file how am I going to get rid of the alternate",
    "start": "3845680",
    "end": "3851039"
  },
  {
    "text": "data stream so what and then what happens",
    "start": "3851039",
    "end": "3859520"
  },
  {
    "text": "right file protection restores it File protection restores it It's not the original cmd.exe Altern data stream is gone",
    "start": "3859520",
    "end": "3869039"
  },
  {
    "text": "But file uh Windows file protection does not prevent somebody from creating an alternate data stream associated with",
    "start": "3869680",
    "end": "3874960"
  },
  {
    "text": "those files Yes",
    "start": "3874960",
    "end": "3882200"
  },
  {
    "text": "Yeah [Music] Okay",
    "start": "3884640",
    "end": "3892440"
  },
  {
    "text": "Okay Hey the question up here is does the does the properties does the size do the size properties change is that",
    "start": "3895359",
    "end": "3901440"
  },
  {
    "text": "correct okay",
    "start": "3901440",
    "end": "3906839"
  },
  {
    "text": "Right Properties Okay Well I would get some of the similar information",
    "start": "3908559",
    "end": "3915359"
  },
  {
    "text": "Okay [Music] Okay Does everybody hear that okay Okay",
    "start": "3915359",
    "end": "3923440"
  },
  {
    "text": "the question was by looking at the properties let me get that again By",
    "start": "3923440",
    "end": "3928799"
  },
  {
    "text": "looking at the properties here size and size on disk does this information change if I add alternate data",
    "start": "3928799",
    "end": "3936880"
  },
  {
    "text": "streams got a no got a yes got a maybe",
    "start": "3937319",
    "end": "3944280"
  },
  {
    "text": "Anybody going for it's time for lunch let's let's give it a shot",
    "start": "3944480",
    "end": "3949640"
  },
  {
    "text": "Uh we can do a couple of these Windows system",
    "start": "3949640",
    "end": "3955960"
  },
  {
    "text": "Oops System 32 Notepad.exe We're going to send it to",
    "start": "3955960",
    "end": "3965160"
  },
  {
    "text": "file.txt np Oops 1.exe Do",
    "start": "3965160",
    "end": "3971480"
  },
  {
    "text": "this Two And three",
    "start": "3971480",
    "end": "3977000"
  },
  {
    "text": "Okay Let's go back here Uh let me go ahead and close this Open",
    "start": "3977000",
    "end": "3984559"
  },
  {
    "text": "it back up",
    "start": "3984559",
    "end": "3987039"
  },
  {
    "text": "again Haven't noticed any change there Okay Well let's do this Let's try",
    "start": "3989799",
    "end": "3999160"
  },
  {
    "text": "this lads I run lads I got the three three",
    "start": "3999160",
    "end": "4005280"
  },
  {
    "text": "alternate data streams 66k approximately each one 65k Let's do a",
    "start": "4005280",
    "end": "4012680"
  },
  {
    "text": "diir Okay",
    "start": "4012680",
    "end": "4016680"
  },
  {
    "text": "Okay Let's go to that one What do the properties of filet txt look",
    "start": "4018520",
    "end": "4024319"
  },
  {
    "text": "like still 17 bytes Hey",
    "start": "4026440",
    "end": "4034039"
  },
  {
    "text": "that's that's that's just 4K though",
    "start": "4035359",
    "end": "4040000"
  },
  {
    "text": "Advanced Say again Advanced Advanced Yeah",
    "start": "4041839",
    "end": "4048720"
  },
  {
    "text": "So it looks like pretty much the easiest way to find these things is to just go out to Frank hindsight grab a copy of",
    "start": "4048720",
    "end": "4055359"
  },
  {
    "text": "Lads and run it So in a nutshell yes",
    "start": "4055359",
    "end": "4063000"
  },
  {
    "text": "Can you create yes request operation",
    "start": "4065039",
    "end": "4071400"
  },
  {
    "text": "You mean are you asking to create an alternate data stream using cmd.exe",
    "start": "4074319",
    "end": "4079960"
  },
  {
    "text": "hiding it associated with it Oh Oh okay Let's see",
    "start": "4080240",
    "end": "4089000"
  },
  {
    "text": "Oh okay I'm just going to walk through question was can you create an alternate data stream associated with cmd.exe",
    "start": "4092000",
    "end": "4099080"
  },
  {
    "text": "X8 We should be able to Okay Uh how do we want to do this",
    "start": "4099080",
    "end": "4107120"
  },
  {
    "text": "type",
    "start": "4107120",
    "end": "4110120"
  },
  {
    "text": "[Music]",
    "start": "4112689",
    "end": "4122659"
  },
  {
    "text": "you might have a different setting I've got uh very few modifications you",
    "start": "4122799",
    "end": "4129199"
  },
  {
    "text": "know in order to do this testing I've got very few modifications on my system which is why I don't have it connected to a",
    "start": "4129199",
    "end": "4134838"
  },
  {
    "text": "network cuz I don't want to take it back to my to my office and find that you've all created alternate data",
    "start": "4134839",
    "end": "4141880"
  },
  {
    "text": "streams on my system Okay let's let's try using lads",
    "start": "4141880",
    "end": "4149838"
  },
  {
    "text": "cows system 32 There we go",
    "start": "4150279",
    "end": "4156639"
  },
  {
    "text": "[Music] So I was able to add it And again as we talked about with the gentleman right",
    "start": "4158069",
    "end": "4164880"
  },
  {
    "text": "here if I want to get rid of that alternate data stream I simply delete cmd.exe Windows file protection will go",
    "start": "4164880",
    "end": "4170080"
  },
  {
    "text": "ahead and replace it for me I'm good to go Okay Any other questions comments at",
    "start": "4170080",
    "end": "4177120"
  },
  {
    "text": "this point I'm running as the",
    "start": "4177120",
    "end": "4183159"
  },
  {
    "text": "admin regular uh if the regular user has right access",
    "start": "4183159",
    "end": "4189120"
  },
  {
    "text": "to that file Yes But as Mark mentioned if you uh if you",
    "start": "4189120",
    "end": "4195360"
  },
  {
    "text": "block the user from having right I think it was uh extended attributes right okay",
    "start": "4195360",
    "end": "4200640"
  },
  {
    "text": "If you block that capability you won't be able to add alternate data stream Okay",
    "start": "4200640",
    "end": "4208239"
  },
  {
    "text": "Let's uh let's move through the presentation a",
    "start": "4208239",
    "end": "4214320"
  },
  {
    "text": "little bit It's getting close to the end here Executing alternate data streams using the start command There's several",
    "start": "4214320",
    "end": "4219679"
  },
  {
    "text": "methods uh with NTFS5 that also work For instance I'll just I'll just talk about",
    "start": "4219679",
    "end": "4225120"
  },
  {
    "text": "this quickly I mentioned running scripts from alternate data streams For instance interpreted languages like Pearl don't",
    "start": "4225120",
    "end": "4230640"
  },
  {
    "text": "care You know you give it a file name it's got a colon in it So what but Pearl doesn't come installed by default on",
    "start": "4230640",
    "end": "4236000"
  },
  {
    "text": "Windows systems What [Music] does Windows scripting",
    "start": "4236000",
    "end": "4244400"
  },
  {
    "text": "host you create a U say create a little uh Visual Basic script that runs uh say",
    "start": "4245000",
    "end": "4251760"
  },
  {
    "text": "a message box for instance See maybe we can do that real",
    "start": "4251760",
    "end": "4256840"
  },
  {
    "text": "quick Maybe this won't be too bad D",
    "start": "4256840",
    "end": "4262920"
  },
  {
    "text": "echo message box Welcome",
    "start": "4262920",
    "end": "4269239"
  },
  {
    "text": "to Blackhead and call it uh",
    "start": "4269239",
    "end": "4274360"
  },
  {
    "text": "VH VBS",
    "start": "4274360",
    "end": "4279040"
  },
  {
    "text": "Okay there we go Okay that's that's about the extent of my uh Windows scripting host skills",
    "start": "4281400",
    "end": "4288239"
  },
  {
    "text": "right there Okay so I' I've created a little Visual Basic script for those of you in the back It's uh it says \"Welcome to Black",
    "start": "4288239",
    "end": "4295520"
  },
  {
    "text": "Hat.\" Just creates a little message box Okay so type BH",
    "start": "4295520",
    "end": "4303480"
  },
  {
    "text": "uh VBS into",
    "start": "4303480",
    "end": "4308600"
  },
  {
    "text": "file.txt Call it BH",
    "start": "4308600",
    "end": "4314400"
  },
  {
    "text": "VBS wcript file txt",
    "start": "4315000",
    "end": "4322560"
  },
  {
    "text": "phbs There we go I put the little Windows scripting",
    "start": "4322679",
    "end": "4328080"
  },
  {
    "text": "notes little Visual Basic script right into an alternate data stream and launched it Um oddly",
    "start": "4328080",
    "end": "4335440"
  },
  {
    "text": "enough the other tool that we have available does the same thing",
    "start": "4335719",
    "end": "4341640"
  },
  {
    "text": "Now here's a tricky one Let's try this",
    "start": "4341840",
    "end": "4347800"
  },
  {
    "text": "type I'm going to try something a little different TXT Is that going to",
    "start": "4347800",
    "end": "4356400"
  },
  {
    "text": "work try that Who thinks this will",
    "start": "4357560",
    "end": "4366239"
  },
  {
    "text": "work who thinks it won't work",
    "start": "4367080",
    "end": "4372040"
  },
  {
    "text": "i got an error All I did was rename the extension of the alternate data stream from BBS to TXT That's all I did The",
    "start": "4372560",
    "end": "4380560"
  },
  {
    "text": "Windows scripting host says there's no script engine for that file extension",
    "start": "4380560",
    "end": "4386920"
  },
  {
    "text": "Okay But knowing that the even Windows scripting host has help",
    "start": "4386920",
    "end": "4395000"
  },
  {
    "text": "functionality Oops I simply add two forward slashes",
    "start": "4395000",
    "end": "4400880"
  },
  {
    "text": "capital E and then the scripting engine that I want to use in this case VBS and it",
    "start": "4400880",
    "end": "4408000"
  },
  {
    "text": "works So there are a lot of different ways to launch executable code be it",
    "start": "4409800",
    "end": "4415120"
  },
  {
    "text": "scripts be it.exe files from within alternate data stream There's several different ways to do this",
    "start": "4415120",
    "end": "4421760"
  },
  {
    "text": "Uh one way that works on Windows 2000 but doesn't work as nicely on XP in 2003",
    "start": "4421760",
    "end": "4427280"
  },
  {
    "text": "is to create a shortcut on the",
    "start": "4427280",
    "end": "4430480"
  },
  {
    "text": "desktop It works Okay let's keep going with the",
    "start": "4433000",
    "end": "4440159"
  },
  {
    "text": "presentation here Okay page down Okay talk about",
    "start": "4440159",
    "end": "4446080"
  },
  {
    "text": "detecting ultimate data streams Lads.exe is my favorite personally Uh but found stone has sind cis internals has got",
    "start": "4446080",
    "end": "4453679"
  },
  {
    "text": "streams and uh I wrote a little pearl script uh basically to demonstrate how",
    "start": "4453679",
    "end": "4459440"
  },
  {
    "text": "to use the backup seek and the backup read APIs from Microsoft to detect alternate data",
    "start": "4459440",
    "end": "4465679"
  },
  {
    "text": "streams Encryption This is another way to hide data That's maybe not particularly as obvious but encryption",
    "start": "4465719",
    "end": "4471679"
  },
  {
    "text": "has the effect uh has the effect rather of of causing",
    "start": "4471679",
    "end": "4477120"
  },
  {
    "text": "uh file signature analysis tools to maybe hiccup a little bit Says okay the",
    "start": "4477120",
    "end": "4482640"
  },
  {
    "text": "extension of this file um does not match the file signature Uh PKzip files have their own",
    "start": "4482640",
    "end": "4490480"
  },
  {
    "text": "you know as far as compressed files PKzip files have their own signature that can be identified Uh there's a",
    "start": "4490480",
    "end": "4495920"
  },
  {
    "text": "variety of tools out there that you can use to encrypt files EFS F-Crypt uh you",
    "start": "4495920",
    "end": "4501920"
  },
  {
    "text": "can use Pearl to encrypt files If you notice I'm heavily relying upon Pearl",
    "start": "4501920",
    "end": "4507239"
  },
  {
    "text": "Steganography it's another utility for hiding files or hiding information on a",
    "start": "4507239",
    "end": "4512440"
  },
  {
    "text": "system Um I believe it was earlier 2003 that Hiden was presented at",
    "start": "4512440",
    "end": "4520640"
  },
  {
    "text": "Black Hat Did anybody catch that presentation okay Uh hiden is a steganography tool",
    "start": "4520640",
    "end": "4528560"
  },
  {
    "text": "that allows you to hide an executable in I believe it is another",
    "start": "4528560",
    "end": "4533960"
  },
  {
    "text": "executable or hide data in an executable I haven't seen any Windows version of the utility that's come out There hasn't",
    "start": "4533960",
    "end": "4540239"
  },
  {
    "text": "been a pre-ompiled Windows version Uh but I believe the source code is available from the off author's website",
    "start": "4540239",
    "end": "4545520"
  },
  {
    "text": "It's fairly interesting uh concept However the ability to hide uh",
    "start": "4545520",
    "end": "4551760"
  },
  {
    "text": "information is rather limited because it uses the actual instructions in the file",
    "start": "4551760",
    "end": "4557320"
  },
  {
    "text": "itself Hiding information in the registry The registry is that nice little technological minefield that",
    "start": "4557320",
    "end": "4563199"
  },
  {
    "text": "Microsoft has posted warnings around Any Microsoft knowledgebased article that involves accessing the registry has a",
    "start": "4563199",
    "end": "4568800"
  },
  {
    "text": "nice little warning about modifying it Uh most of us just tend to ignore it I think the people that tend to observe it",
    "start": "4568800",
    "end": "4575199"
  },
  {
    "text": "are Windows administrators for the most part um you know they you can go in you can",
    "start": "4575199",
    "end": "4580880"
  },
  {
    "text": "add things like uh log on notices things like that You can also hide information",
    "start": "4580880",
    "end": "4587199"
  },
  {
    "text": "in the registry like we mentioned earlier any any bit of binary any binary data type whether you take a a file and",
    "start": "4587199",
    "end": "4593760"
  },
  {
    "text": "you break it up into smaller pieces or you just take a small file and place it within a binary or a string data type",
    "start": "4593760",
    "end": "4599679"
  },
  {
    "text": "within a registry you can hide information there Um couple of good places to hide it HQ classes root hive",
    "start": "4599679",
    "end": "4606640"
  },
  {
    "text": "uh is a nice place Very few people I know actually go there Hidden functionality Hidden hidden",
    "start": "4606640",
    "end": "4614400"
  },
  {
    "text": "is relative I guess is the best way to put this explain this particular slide",
    "start": "4614400",
    "end": "4620040"
  },
  {
    "text": "Um oddly enough there are a lot of Windows administrators that aren't familiar with the functionality of the run key aren't familiar with the",
    "start": "4620040",
    "end": "4626400"
  },
  {
    "text": "functionality of startup directories And I'm not I'm not trying to pick on system administrators Not at all I'm simply",
    "start": "4626400",
    "end": "4633679"
  },
  {
    "text": "pointing out that there's a lot of places on a Windows system where code is activated automatically that folks just",
    "start": "4633679",
    "end": "4639120"
  },
  {
    "text": "aren't aware of U some good places to go to find out these locations include any anti virus",
    "start": "4639120",
    "end": "4645760"
  },
  {
    "text": "site A lot of the malware a lot of the spyware that's at these that's listed at these sites use different techniques",
    "start": "4645760",
    "end": "4652199"
  },
  {
    "text": "to make themselves persistent across reboots and",
    "start": "4652199",
    "end": "4657679"
  },
  {
    "text": "loginins Services is another way to do it Another bit of hidden functionality is clear page file at shutdown Uh if",
    "start": "4658600",
    "end": "4664880"
  },
  {
    "text": "there's information in the uh the page file it could be cleared at shutdown you know using a normal",
    "start": "4664880",
    "end": "4670880"
  },
  {
    "text": "shutdown not unplugging the system Startup directories",
    "start": "4670880",
    "end": "4676239"
  },
  {
    "text": "again Root kits as I said in the beginning of the presentation I'm not going to go into a lot of detail here",
    "start": "4677560",
    "end": "4683199"
  },
  {
    "text": "not a lot at all but I did want to bring it up because it is a method for hiding data on a system There's two ba two",
    "start": "4683199",
    "end": "4689440"
  },
  {
    "text": "basic types of root kits kernel mode and user mode Uh Greg Hogland has got uh",
    "start": "4689440",
    "end": "4695440"
  },
  {
    "text": "what I think was the original entity rootkit at least by that name Um that's",
    "start": "4695440",
    "end": "4701120"
  },
  {
    "text": "a kernel mode rootkit and then the user mode root kits hacker defender AFX rootkit vanquish all use DL injection",
    "start": "4701120",
    "end": "4708800"
  },
  {
    "text": "I've worked with the AFX root kit a little bit um detecting these these hacker defender",
    "start": "4708800",
    "end": "4716320"
  },
  {
    "text": "AFX and Vanquish It's kind of like uh if you want to take a Zen approach to it it's",
    "start": "4716320",
    "end": "4721679"
  },
  {
    "text": "kind of like identifying the wind We we can't see the wind directly but we can see its effects In the case of the AFX",
    "start": "4721679",
    "end": "4728159"
  },
  {
    "text": "root kit uh it uses DLL injection so that the fi it doesn't actually hide the files that it injects into the explorer",
    "start": "4728159",
    "end": "4735440"
  },
  {
    "text": "process space So if you find those files on the system you run a tool like list DLS and you you you dump all the the",
    "start": "4735440",
    "end": "4743920"
  },
  {
    "text": "modules or the DLS that are being used by the explorer process you'll find the effects of AFX rootkit on your system if",
    "start": "4743920",
    "end": "4751440"
  },
  {
    "text": "it's there Uh I haven't had a chance to work with decom DKOM yet and I'm not",
    "start": "4751440",
    "end": "4757199"
  },
  {
    "text": "going to I'm not going to go into that one because the author of the tool is actually presenting it tomorrow He's actually giving a talk",
    "start": "4757199",
    "end": "4764239"
  },
  {
    "text": "tomorrow So I'll leave that to him",
    "start": "4764239",
    "end": "4768158"
  },
  {
    "text": "preventing and detecting again hiding data a lot of a lot of different areas",
    "start": "4770320",
    "end": "4775360"
  },
  {
    "text": "that we haven't covered in this presentation but hiding data on a system it all goes back to configuration policies configuration management how",
    "start": "4775360",
    "end": "4782080"
  },
  {
    "text": "you want to set the systems up how you're going to monitor and administer the",
    "start": "4782080",
    "end": "4787400"
  },
  {
    "text": "systems any questions at this point okay well the material that I've",
    "start": "4787400",
    "end": "4794640"
  },
  {
    "text": "given in this presentation is actually part of a book that's coming out from Addison Wesley later this year This is what the cover is supposed to look",
    "start": "4794640",
    "end": "4802719"
  },
  {
    "text": "like So well if there are no other questions or comments thank you very much",
    "start": "4802760",
    "end": "4811960"
  },
  {
    "text": "Yeah",
    "start": "4878159",
    "end": "4881159"
  },
  {
    "text": "for",
    "start": "5408800",
    "end": "5411800"
  }
]