[
  {
    "text": "[Music]",
    "start": "1180",
    "end": "14730"
  },
  {
    "text": "hello everyone",
    "start": "16080",
    "end": "18800"
  },
  {
    "text": "i'm renter and i'm very glad",
    "start": "18800",
    "end": "22160"
  },
  {
    "text": "to share my research with you at the",
    "start": "22160",
    "end": "25119"
  },
  {
    "text": "blackhead",
    "start": "25119",
    "end": "25920"
  },
  {
    "text": "europe conference my talk today",
    "start": "25920",
    "end": "30480"
  },
  {
    "text": "is discovery 20 years old",
    "start": "30480",
    "end": "33520"
  },
  {
    "text": "vulnerabilities in modern windows kernel",
    "start": "33520",
    "end": "37840"
  },
  {
    "text": "as the title shows this",
    "start": "37840",
    "end": "41280"
  },
  {
    "text": "presentation will talk about",
    "start": "41280",
    "end": "44320"
  },
  {
    "text": "an old and rare known",
    "start": "44320",
    "end": "47920"
  },
  {
    "text": "component in windows kernel",
    "start": "47920",
    "end": "52000"
  },
  {
    "text": "it's named user mode print",
    "start": "52000",
    "end": "55360"
  },
  {
    "text": "driver unpd",
    "start": "55360",
    "end": "57860"
  },
  {
    "text": "[Music]",
    "start": "57860",
    "end": "60239"
  },
  {
    "text": "actually i have got more",
    "start": "60239",
    "end": "63280"
  },
  {
    "text": "than a thousand of box from the umpd",
    "start": "63280",
    "end": "66960"
  },
  {
    "text": "callback",
    "start": "66960",
    "end": "69438"
  },
  {
    "text": "but microsoft just merged",
    "start": "71360",
    "end": "74960"
  },
  {
    "text": "nine cases of",
    "start": "74960",
    "end": "78479"
  },
  {
    "text": "them in fact this box",
    "start": "78479",
    "end": "84159"
  },
  {
    "text": "affects all the versions of windows",
    "start": "84400",
    "end": "86960"
  },
  {
    "text": "system",
    "start": "86960",
    "end": "87680"
  },
  {
    "text": "from windows 7 to windows 10.",
    "start": "87680",
    "end": "92880"
  },
  {
    "text": "it is still very few people",
    "start": "96560",
    "end": "100079"
  },
  {
    "text": "have paid attention to the security",
    "start": "100079",
    "end": "103360"
  },
  {
    "text": "issue about the user mode about the user",
    "start": "103360",
    "end": "106880"
  },
  {
    "text": "mode printed driver",
    "start": "106880",
    "end": "109040"
  },
  {
    "text": "so i want to discuss",
    "start": "109040",
    "end": "112079"
  },
  {
    "text": "the details about the umpd",
    "start": "112079",
    "end": "115840"
  },
  {
    "text": "callback with you",
    "start": "115840",
    "end": "119840"
  },
  {
    "text": "okay i will give a brief introduction",
    "start": "123920",
    "end": "127280"
  },
  {
    "text": "about myself",
    "start": "127280",
    "end": "129200"
  },
  {
    "text": "i am a researcher of singular security",
    "start": "129200",
    "end": "133120"
  },
  {
    "text": "lab",
    "start": "133120",
    "end": "134640"
  },
  {
    "text": "um past years",
    "start": "134640",
    "end": "137840"
  },
  {
    "text": "i mainly focus on a windows kernel",
    "start": "137840",
    "end": "141599"
  },
  {
    "text": "but hunting and exploitation",
    "start": "141599",
    "end": "146239"
  },
  {
    "text": "and i have also found",
    "start": "146239",
    "end": "149599"
  },
  {
    "text": "some bugs about visualization",
    "start": "149599",
    "end": "154400"
  },
  {
    "text": "in vmware workstation and the microsoft",
    "start": "154400",
    "end": "157760"
  },
  {
    "text": "hyper-v",
    "start": "157760",
    "end": "160319"
  },
  {
    "text": "and in the past i have",
    "start": "161280",
    "end": "165760"
  },
  {
    "text": "spoken in summer security conference",
    "start": "165760",
    "end": "169040"
  },
  {
    "text": "such as hitp 44 count",
    "start": "169040",
    "end": "172560"
  },
  {
    "text": "and zero knights",
    "start": "172560",
    "end": "175680"
  },
  {
    "text": "the agenda today includes three parts",
    "start": "177360",
    "end": "182840"
  },
  {
    "text": "first i will introduce",
    "start": "182840",
    "end": "188239"
  },
  {
    "text": "the print driver model in",
    "start": "188239",
    "end": "191440"
  },
  {
    "text": "windows system the second",
    "start": "191440",
    "end": "194959"
  },
  {
    "text": "i will introduce the umpd callback",
    "start": "194959",
    "end": "199200"
  },
  {
    "text": "and displaying why the user work printer",
    "start": "199200",
    "end": "203120"
  },
  {
    "text": "driver",
    "start": "203120",
    "end": "204239"
  },
  {
    "text": "could lead to a good attack service",
    "start": "204239",
    "end": "209200"
  },
  {
    "text": "the third part i will disclose",
    "start": "209200",
    "end": "212959"
  },
  {
    "text": "two box found by myself",
    "start": "212959",
    "end": "216720"
  },
  {
    "text": "which never discussed by others before",
    "start": "216720",
    "end": "221360"
  },
  {
    "text": "okay",
    "start": "224840",
    "end": "226319"
  },
  {
    "text": "let's have a quick view of the printer",
    "start": "226319",
    "end": "229519"
  },
  {
    "text": "driver",
    "start": "229519",
    "end": "231920"
  },
  {
    "text": "from the windows 1000 systems",
    "start": "233599",
    "end": "237200"
  },
  {
    "text": "to now all the windows",
    "start": "237200",
    "end": "240480"
  },
  {
    "text": "printer drivers consist consist",
    "start": "240480",
    "end": "244159"
  },
  {
    "text": "of many two components",
    "start": "244159",
    "end": "249200"
  },
  {
    "text": "the printer graphic dll",
    "start": "249280",
    "end": "253120"
  },
  {
    "text": "and a printer interface the air",
    "start": "253120",
    "end": "256959"
  },
  {
    "text": "a printer interface dll",
    "start": "256959",
    "end": "260239"
  },
  {
    "text": "usually provides a user interface",
    "start": "260239",
    "end": "265040"
  },
  {
    "text": "to the driver and",
    "start": "265040",
    "end": "268880"
  },
  {
    "text": "provide an interface the spoiler",
    "start": "268880",
    "end": "272560"
  },
  {
    "text": "could call to notify the driver",
    "start": "272560",
    "end": "275600"
  },
  {
    "text": "about the print system events",
    "start": "275600",
    "end": "280080"
  },
  {
    "text": "the printer graphic model usually",
    "start": "281199",
    "end": "285520"
  },
  {
    "text": "essences assist",
    "start": "285520",
    "end": "288720"
  },
  {
    "text": "gdi kernel in rendering a print job",
    "start": "288720",
    "end": "292880"
  },
  {
    "text": "and send the rendered data screen",
    "start": "292880",
    "end": "296880"
  },
  {
    "text": "to the print exposure",
    "start": "296880",
    "end": "300080"
  },
  {
    "text": "this picture shows how",
    "start": "302400",
    "end": "305520"
  },
  {
    "text": "the printer graphic model working",
    "start": "305520",
    "end": "308960"
  },
  {
    "text": "with the gdi rendering engine in kernel",
    "start": "308960",
    "end": "313919"
  },
  {
    "text": "a printer graphic dlr should",
    "start": "318960",
    "end": "322240"
  },
  {
    "text": "implement the graphic device driver",
    "start": "322240",
    "end": "325360"
  },
  {
    "text": "interface",
    "start": "325360",
    "end": "326160"
  },
  {
    "text": "to ensure that its graphic device",
    "start": "326160",
    "end": "329600"
  },
  {
    "text": "produce the bad lead the very neat",
    "start": "329600",
    "end": "333199"
  },
  {
    "text": "graphic output",
    "start": "333199",
    "end": "335919"
  },
  {
    "text": "the graphics driver interface function",
    "start": "335919",
    "end": "339280"
  },
  {
    "text": "is named with a prefix drv",
    "start": "339280",
    "end": "343759"
  },
  {
    "text": "some of the driver interface functions",
    "start": "343759",
    "end": "346560"
  },
  {
    "text": "live",
    "start": "346560",
    "end": "347120"
  },
  {
    "text": "load as you see",
    "start": "347120",
    "end": "350560"
  },
  {
    "text": "if you start a print job",
    "start": "350560",
    "end": "354720"
  },
  {
    "text": "the xu will execute the drv start doc",
    "start": "354720",
    "end": "359360"
  },
  {
    "text": "diary start page they are restart",
    "start": "359360",
    "end": "362000"
  },
  {
    "text": "binding",
    "start": "362000",
    "end": "363360"
  },
  {
    "text": "functions in the user mode printer",
    "start": "363360",
    "end": "365600"
  },
  {
    "text": "driver",
    "start": "365600",
    "end": "366720"
  },
  {
    "text": "and when the kernel draw in",
    "start": "366720",
    "end": "370000"
  },
  {
    "text": "the graphics the graphic",
    "start": "370000",
    "end": "373280"
  },
  {
    "text": "emits the drv big",
    "start": "373280",
    "end": "376960"
  },
  {
    "text": "the refill path function should be",
    "start": "376960",
    "end": "379680"
  },
  {
    "text": "called",
    "start": "379680",
    "end": "381840"
  },
  {
    "text": "when a user print a document",
    "start": "385280",
    "end": "388800"
  },
  {
    "text": "and start a rendering and start",
    "start": "388800",
    "end": "391919"
  },
  {
    "text": "rendering a print job",
    "start": "391919",
    "end": "395199"
  },
  {
    "text": "the interaction between gdi render",
    "start": "395199",
    "end": "398080"
  },
  {
    "text": "engine",
    "start": "398080",
    "end": "398800"
  },
  {
    "text": "and their printer graphics framework as",
    "start": "398800",
    "end": "401600"
  },
  {
    "text": "follows",
    "start": "401600",
    "end": "404080"
  },
  {
    "text": "as follows as shown",
    "start": "404240",
    "end": "407280"
  },
  {
    "text": "we can see that the gdi kernel called",
    "start": "407280",
    "end": "411199"
  },
  {
    "text": "drv enable surface function",
    "start": "411199",
    "end": "415280"
  },
  {
    "text": "in print graphics driver",
    "start": "415280",
    "end": "419199"
  },
  {
    "text": "attack the umpd callback",
    "start": "421520",
    "end": "424960"
  },
  {
    "text": "the second part of this talk i will",
    "start": "424960",
    "end": "428319"
  },
  {
    "text": "introduce",
    "start": "428319",
    "end": "429120"
  },
  {
    "text": "the working mechanism of user mode",
    "start": "429120",
    "end": "432080"
  },
  {
    "text": "printer driver",
    "start": "432080",
    "end": "434840"
  },
  {
    "text": "index",
    "start": "434840",
    "end": "437840"
  },
  {
    "text": "what is umpd it means",
    "start": "438319",
    "end": "442080"
  },
  {
    "text": "user mode print driver",
    "start": "442080",
    "end": "446000"
  },
  {
    "text": "as the partners design a windows system",
    "start": "446000",
    "end": "450240"
  },
  {
    "text": "bring the driver models",
    "start": "450240",
    "end": "453280"
  },
  {
    "text": "a load unloaded into the kernel",
    "start": "453280",
    "end": "457520"
  },
  {
    "text": "but started with windows vista",
    "start": "457520",
    "end": "461759"
  },
  {
    "text": "microsoft made a big change",
    "start": "461759",
    "end": "466560"
  },
  {
    "text": "the printer drivers would run",
    "start": "467759",
    "end": "471440"
  },
  {
    "text": "in user mode instead of running",
    "start": "471440",
    "end": "474639"
  },
  {
    "text": "as a part as part of the current",
    "start": "474639",
    "end": "478800"
  },
  {
    "text": "this change was made as a",
    "start": "478800",
    "end": "482080"
  },
  {
    "text": "security enhancement and",
    "start": "482080",
    "end": "485120"
  },
  {
    "text": "the security benefit is quite",
    "start": "485120",
    "end": "488720"
  },
  {
    "text": "screwed is quite clear once move",
    "start": "488720",
    "end": "492960"
  },
  {
    "text": "once moved the print driver into user",
    "start": "492960",
    "end": "495919"
  },
  {
    "text": "mode",
    "start": "495919",
    "end": "497039"
  },
  {
    "text": "the box in printer driver have",
    "start": "497039",
    "end": "500160"
  },
  {
    "text": "a much reduced security impact",
    "start": "500160",
    "end": "507280"
  },
  {
    "text": "in fact it's",
    "start": "507280",
    "end": "510800"
  },
  {
    "text": "it surely reduced",
    "start": "510800",
    "end": "514159"
  },
  {
    "text": "the balance in the",
    "start": "514159",
    "end": "517518"
  },
  {
    "text": "printer driver but",
    "start": "517519",
    "end": "521839"
  },
  {
    "text": "it has",
    "start": "523279",
    "end": "525839"
  },
  {
    "text": "create a new attack surface to make",
    "start": "527519",
    "end": "530880"
  },
  {
    "text": "the kernel driver to make the graphic",
    "start": "530880",
    "end": "533519"
  },
  {
    "text": "corner",
    "start": "533519",
    "end": "534720"
  },
  {
    "text": "more dangerous because",
    "start": "534720",
    "end": "538240"
  },
  {
    "text": "the kernel callback should",
    "start": "538240",
    "end": "542480"
  },
  {
    "text": "usually shoot the callback to the",
    "start": "542480",
    "end": "545519"
  },
  {
    "text": "user mode printer graphic driver",
    "start": "545519",
    "end": "549839"
  },
  {
    "text": "a user mode printer driver should export",
    "start": "551279",
    "end": "555120"
  },
  {
    "text": "the driver interface functions",
    "start": "555120",
    "end": "558959"
  },
  {
    "text": "these functions nand with the drv prefix",
    "start": "560800",
    "end": "566320"
  },
  {
    "text": "they will be called by the kernel guy",
    "start": "566880",
    "end": "569680"
  },
  {
    "text": "engine",
    "start": "569680",
    "end": "570560"
  },
  {
    "text": "the callback from graphics kernel to",
    "start": "570560",
    "end": "573279"
  },
  {
    "text": "user mode",
    "start": "573279",
    "end": "575040"
  },
  {
    "text": "print driver could",
    "start": "575040",
    "end": "578240"
  },
  {
    "text": "lead to a big attack surface",
    "start": "578240",
    "end": "582240"
  },
  {
    "text": "as you know",
    "start": "583440",
    "end": "586160"
  },
  {
    "text": "the user mode the kernel attacks",
    "start": "586959",
    "end": "590560"
  },
  {
    "text": "through the user mode callbacks",
    "start": "590560",
    "end": "593760"
  },
  {
    "text": "it's very good it's a very good",
    "start": "593760",
    "end": "598160"
  },
  {
    "text": "presentation",
    "start": "598160",
    "end": "600959"
  },
  {
    "text": "the use mode callback is first discussed",
    "start": "601760",
    "end": "605440"
  },
  {
    "text": "in public nine years ago",
    "start": "605440",
    "end": "609680"
  },
  {
    "text": "we just we just revealed",
    "start": "611680",
    "end": "616320"
  },
  {
    "text": "mixing uk user mode callback whenever it",
    "start": "616320",
    "end": "619279"
  },
  {
    "text": "is",
    "start": "619279",
    "end": "621519"
  },
  {
    "text": "a classic user mode callback path",
    "start": "622320",
    "end": "625760"
  },
  {
    "text": "is shown as nice",
    "start": "625760",
    "end": "629760"
  },
  {
    "text": "when you create",
    "start": "630959",
    "end": "634000"
  },
  {
    "text": "a user object",
    "start": "634000",
    "end": "637200"
  },
  {
    "text": "in user space",
    "start": "637440",
    "end": "640320"
  },
  {
    "text": "and income",
    "start": "640800",
    "end": "644839"
  },
  {
    "text": "and when you trigger some functions",
    "start": "644839",
    "end": "649519"
  },
  {
    "text": "to call or use motor callback to use a",
    "start": "649519",
    "end": "652240"
  },
  {
    "text": "space",
    "start": "652240",
    "end": "653360"
  },
  {
    "text": "and the v another attacker",
    "start": "653360",
    "end": "656800"
  },
  {
    "text": "the attacker could could hook",
    "start": "656800",
    "end": "661279"
  },
  {
    "text": "in the user space to modify the object",
    "start": "661279",
    "end": "665839"
  },
  {
    "text": "and when you return to the kernel",
    "start": "665839",
    "end": "670079"
  },
  {
    "text": "the kernel code reuse the object",
    "start": "670079",
    "end": "674959"
  },
  {
    "text": "it could it could",
    "start": "674959",
    "end": "678800"
  },
  {
    "text": "make many security",
    "start": "678800",
    "end": "683600"
  },
  {
    "text": "issues",
    "start": "686839",
    "end": "689839"
  },
  {
    "text": "through the user mode call back",
    "start": "692000",
    "end": "696079"
  },
  {
    "text": "vulnerabilities it's not",
    "start": "696079",
    "end": "699360"
  },
  {
    "text": "is has has",
    "start": "699360",
    "end": "703200"
  },
  {
    "text": "been discussed many years",
    "start": "703200",
    "end": "706240"
  },
  {
    "text": "but few people ever noticed",
    "start": "706240",
    "end": "709920"
  },
  {
    "text": "that the umpd callback assumptions",
    "start": "709920",
    "end": "714079"
  },
  {
    "text": "as shown in the left the unpd dre",
    "start": "714079",
    "end": "717760"
  },
  {
    "text": "prefix functions let's look",
    "start": "717760",
    "end": "721600"
  },
  {
    "text": "how the umpd driver functions triggered",
    "start": "721600",
    "end": "724480"
  },
  {
    "text": "a user mode callback",
    "start": "724480",
    "end": "727440"
  },
  {
    "text": "all the umpd dirv functions in vc2k",
    "start": "727440",
    "end": "731279"
  },
  {
    "text": "we are called the umpd opt up",
    "start": "731279",
    "end": "734959"
  },
  {
    "text": "and the umpd object stock called",
    "start": "734959",
    "end": "738399"
  },
  {
    "text": "ppp user callback finance",
    "start": "738399",
    "end": "742079"
  },
  {
    "text": "the ppp user mod callback function",
    "start": "742079",
    "end": "745200"
  },
  {
    "text": "returned to the client print stack",
    "start": "745200",
    "end": "748880"
  },
  {
    "text": "in user space",
    "start": "748880",
    "end": "751839"
  },
  {
    "text": "the code of umpd of json function",
    "start": "754399",
    "end": "758079"
  },
  {
    "text": "pass the parameters directly to client",
    "start": "758079",
    "end": "762800"
  },
  {
    "text": "printer start function but if command",
    "start": "762800",
    "end": "766000"
  },
  {
    "text": "process is a 32-bit",
    "start": "766000",
    "end": "770639"
  },
  {
    "text": "process",
    "start": "770839",
    "end": "772240"
  },
  {
    "text": "ump the the ump of estack",
    "start": "772240",
    "end": "776079"
  },
  {
    "text": "will send a local procedural message",
    "start": "776079",
    "end": "779519"
  },
  {
    "text": "to a proxy port created by the printer",
    "start": "779519",
    "end": "782800"
  },
  {
    "text": "driver",
    "start": "782800",
    "end": "783440"
  },
  {
    "text": "host the print drive host process",
    "start": "783440",
    "end": "787680"
  },
  {
    "text": "the splw64",
    "start": "787680",
    "end": "793040"
  },
  {
    "text": "this process is the print is the print",
    "start": "793440",
    "end": "796639"
  },
  {
    "text": "driver host",
    "start": "796639",
    "end": "798240"
  },
  {
    "text": "it is created for the 32-bit",
    "start": "798240",
    "end": "802079"
  },
  {
    "text": "process using the print driver",
    "start": "802079",
    "end": "807120"
  },
  {
    "text": "the communication between",
    "start": "807200",
    "end": "810240"
  },
  {
    "text": "print client and the print driver host",
    "start": "810240",
    "end": "813440"
  },
  {
    "text": "could also make a big attack service too",
    "start": "813440",
    "end": "819440"
  },
  {
    "text": "it is another story about mercer sandbox",
    "start": "819440",
    "end": "824880"
  },
  {
    "text": "escape",
    "start": "826839",
    "end": "828560"
  },
  {
    "text": "let's come back about the umpd callback",
    "start": "828560",
    "end": "832240"
  },
  {
    "text": "and you see in this page the call stack",
    "start": "832240",
    "end": "835920"
  },
  {
    "text": "a the typical user mode printer driver",
    "start": "835920",
    "end": "839040"
  },
  {
    "text": "callbacks",
    "start": "839040",
    "end": "840560"
  },
  {
    "text": "callback expect callback caustic",
    "start": "840560",
    "end": "843680"
  },
  {
    "text": "like this",
    "start": "843680",
    "end": "846320"
  },
  {
    "text": "it is difficult for others to notice",
    "start": "847839",
    "end": "851399"
  },
  {
    "text": "misspelling flaws why",
    "start": "851399",
    "end": "855040"
  },
  {
    "text": "i think sweet sweet three ingredients",
    "start": "855040",
    "end": "858800"
  },
  {
    "text": "first the umpd div functions",
    "start": "858800",
    "end": "862639"
  },
  {
    "text": "are not referenced directly in the",
    "start": "862639",
    "end": "865519"
  },
  {
    "text": "current mode",
    "start": "865519",
    "end": "866320"
  },
  {
    "text": "in the kernel's code so",
    "start": "866320",
    "end": "869519"
  },
  {
    "text": "it is not easy to find in it",
    "start": "869519",
    "end": "873040"
  },
  {
    "text": "the second reason the umpd",
    "start": "873040",
    "end": "876560"
  },
  {
    "text": "driver functions not use xxx",
    "start": "876560",
    "end": "880160"
  },
  {
    "text": "or ddg as as the name",
    "start": "880160",
    "end": "883360"
  },
  {
    "text": "and the prefix and function then",
    "start": "883360",
    "end": "888240"
  },
  {
    "text": "the provisions the previous the previous",
    "start": "890000",
    "end": "894399"
  },
  {
    "text": "researchers told us the xxx functions",
    "start": "894399",
    "end": "898079"
  },
  {
    "text": "will trigger use mode callback",
    "start": "898079",
    "end": "901199"
  },
  {
    "text": "maybe we just not consider",
    "start": "901199",
    "end": "905199"
  },
  {
    "text": "the other situations could",
    "start": "905199",
    "end": "908240"
  },
  {
    "text": "also trigger user mode callback",
    "start": "908240",
    "end": "913839"
  },
  {
    "text": "the third reason the third reason",
    "start": "913920",
    "end": "917440"
  },
  {
    "text": "we need to meet certain conditions",
    "start": "917440",
    "end": "921279"
  },
  {
    "text": "for triggering the umpd driver functions",
    "start": "921279",
    "end": "924560"
  },
  {
    "text": "if this slave is not a umpd state",
    "start": "924560",
    "end": "928240"
  },
  {
    "text": "or if our code",
    "start": "928240",
    "end": "931440"
  },
  {
    "text": "haven't implement the specific",
    "start": "931759",
    "end": "936320"
  },
  {
    "text": "variable interface function the graphic",
    "start": "936320",
    "end": "939440"
  },
  {
    "text": "kernel will not",
    "start": "939440",
    "end": "941120"
  },
  {
    "text": "execute the umpd drive function",
    "start": "941120",
    "end": "945440"
  },
  {
    "text": "so how to trigger a umpd callback",
    "start": "946639",
    "end": "951920"
  },
  {
    "text": "shall we shall we implement a print",
    "start": "951920",
    "end": "954880"
  },
  {
    "text": "driver",
    "start": "954880",
    "end": "955519"
  },
  {
    "text": "myself for ourselves and if we just",
    "start": "955519",
    "end": "958560"
  },
  {
    "text": "eat in system no",
    "start": "958560",
    "end": "962399"
  },
  {
    "text": "we could just use the virtual printer",
    "start": "962399",
    "end": "966320"
  },
  {
    "text": "created by the system such as",
    "start": "966320",
    "end": "969680"
  },
  {
    "text": "fax xps document writer",
    "start": "969680",
    "end": "974639"
  },
  {
    "text": "and onenote",
    "start": "974639",
    "end": "977600"
  },
  {
    "text": "case body in this part",
    "start": "979440",
    "end": "982480"
  },
  {
    "text": "i will discuss two parts found by myself",
    "start": "982480",
    "end": "987519"
  },
  {
    "text": "the cve202087",
    "start": "990720",
    "end": "997839"
  },
  {
    "text": "in fact microsoft merged nine cases",
    "start": "998399",
    "end": "1002000"
  },
  {
    "text": "i reported i reported last year",
    "start": "1002000",
    "end": "1006880"
  },
  {
    "text": "one of them is the gi",
    "start": "1006880",
    "end": "1010560"
  },
  {
    "text": "exp text out the",
    "start": "1010560",
    "end": "1013759"
  },
  {
    "text": "locked function user3",
    "start": "1013759",
    "end": "1018560"
  },
  {
    "text": "the root cause shows",
    "start": "1018959",
    "end": "1022320"
  },
  {
    "text": "here the specific floor axis",
    "start": "1022480",
    "end": "1025918"
  },
  {
    "text": "within the gre exp takes out.locked",
    "start": "1025919",
    "end": "1029438"
  },
  {
    "text": "function",
    "start": "1029439",
    "end": "1030959"
  },
  {
    "text": "the issue results from the lack of",
    "start": "1030959",
    "end": "1035120"
  },
  {
    "text": "check from the surface object in printer",
    "start": "1035120",
    "end": "1038480"
  },
  {
    "text": "device context",
    "start": "1038480",
    "end": "1040319"
  },
  {
    "text": "when the gi ext takes out that locked",
    "start": "1040319",
    "end": "1043918"
  },
  {
    "text": "function called the unpdiv text out",
    "start": "1043919",
    "end": "1047438"
  },
  {
    "text": "function",
    "start": "1047439",
    "end": "1048400"
  },
  {
    "text": "as you know triggered a umpd callback",
    "start": "1048400",
    "end": "1053600"
  },
  {
    "text": "it will trigger a umpd callback to the",
    "start": "1053600",
    "end": "1056720"
  },
  {
    "text": "drb text out function in the user mode",
    "start": "1056720",
    "end": "1060640"
  },
  {
    "text": "printed barrier",
    "start": "1060640",
    "end": "1063039"
  },
  {
    "text": "and if and we can destroy",
    "start": "1063039",
    "end": "1066240"
  },
  {
    "text": "the surface object in user space",
    "start": "1066240",
    "end": "1069520"
  },
  {
    "text": "so we can so we call a usb3",
    "start": "1069520",
    "end": "1073440"
  },
  {
    "text": "when returned to a kernel code",
    "start": "1073440",
    "end": "1077279"
  },
  {
    "text": "first we create",
    "start": "1078840",
    "end": "1081360"
  },
  {
    "text": "a printer device context after that",
    "start": "1081360",
    "end": "1085200"
  },
  {
    "text": "start dot therefore the printer",
    "start": "1085200",
    "end": "1088720"
  },
  {
    "text": "device context creates its",
    "start": "1088720",
    "end": "1092840"
  },
  {
    "text": "surface",
    "start": "1092840",
    "end": "1095360"
  },
  {
    "text": "then the text out function will trigger",
    "start": "1095360",
    "end": "1098320"
  },
  {
    "text": "a unpd callback",
    "start": "1098320",
    "end": "1100799"
  },
  {
    "text": "to drb text out",
    "start": "1100799",
    "end": "1104960"
  },
  {
    "text": "now we just need hook the army takes out",
    "start": "1105039",
    "end": "1108720"
  },
  {
    "text": "function",
    "start": "1108720",
    "end": "1109520"
  },
  {
    "text": "in nxt w driver",
    "start": "1109520",
    "end": "1113520"
  },
  {
    "text": "when we call undertalk function",
    "start": "1113840",
    "end": "1117440"
  },
  {
    "text": "in our in our redefined",
    "start": "1117440",
    "end": "1121679"
  },
  {
    "text": "dre text out function the surface",
    "start": "1121679",
    "end": "1126080"
  },
  {
    "text": "selected with device context",
    "start": "1126080",
    "end": "1129200"
  },
  {
    "text": "will be destroyed",
    "start": "1129200",
    "end": "1132240"
  },
  {
    "text": "now and now the esi register",
    "start": "1133919",
    "end": "1137470"
  },
  {
    "text": "[Music]",
    "start": "1137470",
    "end": "1138720"
  },
  {
    "text": "point to a free poor",
    "start": "1138720",
    "end": "1142160"
  },
  {
    "text": "memory the crash stack",
    "start": "1142160",
    "end": "1145280"
  },
  {
    "text": "shows up here",
    "start": "1145280",
    "end": "1151360"
  },
  {
    "text": "let's look at another case a little",
    "start": "1151360",
    "end": "1154799"
  },
  {
    "text": "more complicated in this case",
    "start": "1154799",
    "end": "1158480"
  },
  {
    "text": "we should modify the data",
    "start": "1158480",
    "end": "1161679"
  },
  {
    "text": "returned by the ordinary umpt functions",
    "start": "1161679",
    "end": "1166720"
  },
  {
    "text": "first we initialized a useable printer",
    "start": "1166720",
    "end": "1170000"
  },
  {
    "text": "driver instance",
    "start": "1170000",
    "end": "1172799"
  },
  {
    "text": "and we start the dock to create",
    "start": "1172799",
    "end": "1176400"
  },
  {
    "text": "a surface with with device content",
    "start": "1176400",
    "end": "1181039"
  },
  {
    "text": "then the next we call np",
    "start": "1182240",
    "end": "1185360"
  },
  {
    "text": "gdi doing ntgdi2 binding function",
    "start": "1185360",
    "end": "1189919"
  },
  {
    "text": "in a kernel code the gre 2 binding",
    "start": "1189919",
    "end": "1194400"
  },
  {
    "text": "function",
    "start": "1194400",
    "end": "1195120"
  },
  {
    "text": "will check the return value and the",
    "start": "1195120",
    "end": "1198559"
  },
  {
    "text": "point x and the point f structure",
    "start": "1198559",
    "end": "1202640"
  },
  {
    "text": "so we should modify the x field",
    "start": "1202640",
    "end": "1206240"
  },
  {
    "text": "of point a structure",
    "start": "1206240",
    "end": "1209840"
  },
  {
    "text": "and the return true in our hooked",
    "start": "1209840",
    "end": "1213840"
  },
  {
    "text": "direct band function",
    "start": "1213840",
    "end": "1217600"
  },
  {
    "text": "if we end up",
    "start": "1219120",
    "end": "1222240"
  },
  {
    "text": "in in our driv next band function",
    "start": "1222240",
    "end": "1227120"
  },
  {
    "text": "the surface object associated",
    "start": "1227120",
    "end": "1230880"
  },
  {
    "text": "with the printed device context",
    "start": "1230880",
    "end": "1234000"
  },
  {
    "text": "should be free",
    "start": "1234000",
    "end": "1236880"
  },
  {
    "text": "it will lead to a user free",
    "start": "1237039",
    "end": "1241519"
  },
  {
    "text": "conclusion i think",
    "start": "1245919",
    "end": "1249200"
  },
  {
    "text": "i can share my takeaways from",
    "start": "1249200",
    "end": "1252720"
  },
  {
    "text": "the research",
    "start": "1252720",
    "end": "1255360"
  },
  {
    "text": "i think the people may not",
    "start": "1255760",
    "end": "1260400"
  },
  {
    "text": "really understand what they used",
    "start": "1260400",
    "end": "1264080"
  },
  {
    "text": "every day such as the print driver",
    "start": "1264080",
    "end": "1270080"
  },
  {
    "text": "second maybe",
    "start": "1271120",
    "end": "1274960"
  },
  {
    "text": "in some ancient components in",
    "start": "1274960",
    "end": "1278000"
  },
  {
    "text": "modern system you could",
    "start": "1278000",
    "end": "1281280"
  },
  {
    "text": "discovery some normal and unique",
    "start": "1281280",
    "end": "1284559"
  },
  {
    "text": "vulnerabilities",
    "start": "1284559",
    "end": "1287520"
  },
  {
    "text": "as you see we can find a new",
    "start": "1288159",
    "end": "1291600"
  },
  {
    "text": "attack surface in",
    "start": "1291600",
    "end": "1294799"
  },
  {
    "text": "some old code",
    "start": "1294799",
    "end": "1298000"
  },
  {
    "text": "at last at least again this umpd",
    "start": "1299679",
    "end": "1303760"
  },
  {
    "text": "callback is not over yet",
    "start": "1303760",
    "end": "1306430"
  },
  {
    "text": "[Music]",
    "start": "1306430",
    "end": "1309039"
  },
  {
    "text": "for example this call stack",
    "start": "1309039",
    "end": "1312720"
  },
  {
    "text": "shows an out of bound",
    "start": "1312720",
    "end": "1316080"
  },
  {
    "text": "memory write in color",
    "start": "1316080",
    "end": "1319600"
  },
  {
    "text": "after we have modified",
    "start": "1319600",
    "end": "1322640"
  },
  {
    "text": "a padded object in our",
    "start": "1322640",
    "end": "1325679"
  },
  {
    "text": "redefined unpd driver function",
    "start": "1325679",
    "end": "1333840"
  },
  {
    "text": "this part is packed already in april",
    "start": "1335600",
    "end": "1338320"
  },
  {
    "text": "this year",
    "start": "1338320",
    "end": "1339520"
  },
  {
    "text": "but i'm not sure which cv number is",
    "start": "1339520",
    "end": "1342880"
  },
  {
    "text": "assigned",
    "start": "1342880",
    "end": "1343760"
  },
  {
    "text": "for it",
    "start": "1343760",
    "end": "1347039"
  },
  {
    "text": "the last case it is sphere 0d",
    "start": "1347039",
    "end": "1351600"
  },
  {
    "text": "it's a non-point reference in min c2k",
    "start": "1351600",
    "end": "1355440"
  },
  {
    "text": "color",
    "start": "1355440",
    "end": "1356640"
  },
  {
    "text": "the exclave object is this is destroyed",
    "start": "1356640",
    "end": "1360720"
  },
  {
    "text": "already in my redefined",
    "start": "1360720",
    "end": "1364720"
  },
  {
    "text": "umd driver function",
    "start": "1364720",
    "end": "1368080"
  },
  {
    "text": "yes",
    "start": "1368080",
    "end": "1370320"
  },
  {
    "text": "when when the umpd callback returned to",
    "start": "1373600",
    "end": "1376559"
  },
  {
    "text": "the corner",
    "start": "1376559",
    "end": "1377520"
  },
  {
    "text": "the kernel reused the xclip object",
    "start": "1377520",
    "end": "1382880"
  },
  {
    "text": "but in the latest windows 10",
    "start": "1383840",
    "end": "1387679"
  },
  {
    "text": "the vc2k via zero the",
    "start": "1387679",
    "end": "1391520"
  },
  {
    "text": "reserve and the free the memory",
    "start": "1391520",
    "end": "1394640"
  },
  {
    "text": "from the gdi object when a ddr object",
    "start": "1394640",
    "end": "1398880"
  },
  {
    "text": "is destroyed the memory the freedom",
    "start": "1398880",
    "end": "1402320"
  },
  {
    "text": "memory",
    "start": "1402320",
    "end": "1403440"
  },
  {
    "text": "will be zero",
    "start": "1403440",
    "end": "1406399"
  },
  {
    "text": "so it's just a non-pointed reference",
    "start": "1408000",
    "end": "1412480"
  },
  {
    "text": "now thank you everybody",
    "start": "1412480",
    "end": "1416799"
  },
  {
    "text": "thank you for your attention",
    "start": "1416799",
    "end": "1421120"
  }
]