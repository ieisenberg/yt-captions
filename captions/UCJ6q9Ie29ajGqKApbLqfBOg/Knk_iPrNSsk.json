[
  {
    "start": "0",
    "end": "169000"
  },
  {
    "text": "[Music]",
    "start": "860",
    "end": "9280"
  },
  {
    "text": "hello everybody and welcome to my talk the bad guys win analysis of 10 000 mage",
    "start": "9280",
    "end": "14880"
  },
  {
    "text": "card vulnerabilities a little about myself my name is nathaniel gallaranter ceo and cto at",
    "start": "14880",
    "end": "21600"
  },
  {
    "text": "cyberpion we protect the organization's hyper-connected attack surface from the perimeter to the direct and indirect",
    "start": "21600",
    "end": "29039"
  },
  {
    "text": "supply chain i'm security researcher hacker web application security cloud security",
    "start": "29039",
    "end": "36320"
  },
  {
    "text": "expert i have phd in computer science hacks research paper cvs talks etc",
    "start": "36320",
    "end": "44120"
  },
  {
    "text": "the agenda for this talk background uh the magical problem some statistics",
    "start": "44879",
    "end": "51360"
  },
  {
    "text": "we then we dive into the core uh of the talk which is about protection mechanisms and how the hikers",
    "start": "51360",
    "end": "59039"
  },
  {
    "text": "relatively easily bypass them and today why the bad guys win and how",
    "start": "59039",
    "end": "65119"
  },
  {
    "text": "they win then we will summarize the talk and obviously when we talk about more than",
    "start": "65119",
    "end": "72479"
  },
  {
    "text": "10 000 mage called vulnerabilities we will allow organizations to test whether they are",
    "start": "72479",
    "end": "78400"
  },
  {
    "text": "in the statistic so let's start with some background about mage card",
    "start": "78400",
    "end": "84960"
  },
  {
    "text": "mage card is a web application security attack that in which hackers steal information by",
    "start": "84960",
    "end": "91280"
  },
  {
    "text": "running malicious script javascript in web applications it is named after the",
    "start": "91280",
    "end": "96640"
  },
  {
    "text": "infamous hacking group magekart that launched",
    "start": "96640",
    "end": "102240"
  },
  {
    "text": "the most famous mage card attack against uh british airways and some others",
    "start": "102240",
    "end": "108159"
  },
  {
    "text": "although this vector was used um before",
    "start": "108159",
    "end": "112719"
  },
  {
    "text": "the famous mage card attacks triggered new generation of anti-mage card",
    "start": "113360",
    "end": "120000"
  },
  {
    "text": "solutions and we will analyze that",
    "start": "120000",
    "end": "124880"
  },
  {
    "text": "in this talk when we say mage card we will refer to specific the most",
    "start": "125040",
    "end": "130160"
  },
  {
    "text": "challenging and interesting uh variant of mage card in which the hackers attack",
    "start": "130160",
    "end": "136000"
  },
  {
    "text": "third party sometimes fourth fifth party they compromise the script that is",
    "start": "136000",
    "end": "141280"
  },
  {
    "text": "loaded from this uh third party and then just you know from the third",
    "start": "141280",
    "end": "147360"
  },
  {
    "text": "party they serve malicious code to other applications that rely on this",
    "start": "147360",
    "end": "152800"
  },
  {
    "text": "third party from one vulnerable infrastructure of a vendor it is possible obviously to",
    "start": "152800",
    "end": "158160"
  },
  {
    "text": "affect many applications many organizations it could be done for stealing",
    "start": "158160",
    "end": "163840"
  },
  {
    "text": "information but potentially it is possible to do more than that",
    "start": "163840",
    "end": "170480"
  },
  {
    "start": "169000",
    "end": "169000"
  },
  {
    "text": "before we dive into the mage card diagram let's go",
    "start": "170480",
    "end": "175519"
  },
  {
    "text": "through the script inclusion diagram so when a user serves to",
    "start": "175519",
    "end": "180840"
  },
  {
    "text": "apps.com the first thing the browser sends an http get request to get app.com",
    "start": "180840",
    "end": "187920"
  },
  {
    "text": "maybe through the firewall of the web server and it gets back html page once",
    "start": "187920",
    "end": "193360"
  },
  {
    "text": "the html page is loaded it is rendered by the browser and the html page might",
    "start": "193360",
    "end": "198400"
  },
  {
    "text": "include instructions to load additional code or other objects from third fourth",
    "start": "198400",
    "end": "204560"
  },
  {
    "text": "fifth party and this is what is happening the browser sends from the context of the",
    "start": "204560",
    "end": "210720"
  },
  {
    "text": "application a request to load scripts the script is loaded the script can change the application and the script",
    "start": "210720",
    "end": "217040"
  },
  {
    "text": "potentially can send some data to the third party or to other parties in a mage card attack",
    "start": "217040",
    "end": "224080"
  },
  {
    "text": "it starts the same the browser the user wants to serve to app.com the browser",
    "start": "224080",
    "end": "229920"
  },
  {
    "text": "sends the http request gets the same html page from the web server",
    "start": "229920",
    "end": "236400"
  },
  {
    "text": "the app is loaded same app the same request for a third party script",
    "start": "236400",
    "end": "241840"
  },
  {
    "text": "is sent to the third party but this time the hacker can reply with malicious code",
    "start": "241840",
    "end": "247120"
  },
  {
    "text": "the malicious code can change the app but for bad and just as",
    "start": "247120",
    "end": "253519"
  },
  {
    "text": "information could be sent to the legit third party now it could be sent either to the hacker or to the",
    "start": "253519",
    "end": "259199"
  },
  {
    "text": "compromised third party so mage cart traditionally is about",
    "start": "259199",
    "end": "265600"
  },
  {
    "text": "stealing information i would like to bring an example for a webpage through which an abuse",
    "start": "265600",
    "end": "273040"
  },
  {
    "text": "could achieve more than um more than just stealing information so",
    "start": "273040",
    "end": "278960"
  },
  {
    "text": "let's go through this page so this is an old one no longer active obviously so if",
    "start": "278960",
    "end": "285840"
  },
  {
    "text": "some time ago you search for downloading the microsoft edge browser",
    "start": "285840",
    "end": "292639"
  },
  {
    "text": "application you google it you follow the first link",
    "start": "292639",
    "end": "298880"
  },
  {
    "text": "and then you get um this web page in which you can type your phone number or email and then",
    "start": "298880",
    "end": "306400"
  },
  {
    "text": "you're gonna get a link to download so obviously it is possible because this page was",
    "start": "306400",
    "end": "312800"
  },
  {
    "text": "vulnerable to mage card it was possible to steal the phone number and the emails that i that are tied but",
    "start": "312800",
    "end": "319280"
  },
  {
    "text": "more than that think about hackers getting the phone numbers and then just",
    "start": "319280",
    "end": "324560"
  },
  {
    "text": "sending malicious links so the users download malware to their",
    "start": "324560",
    "end": "331360"
  },
  {
    "text": "computer it is enough that somebody will download such",
    "start": "331360",
    "end": "336720"
  },
  {
    "text": "a fake application to a mobile device that includes credentials to an organization it could this could be the beginning of an apt attack",
    "start": "336720",
    "end": "344479"
  },
  {
    "text": "so that's one example but in general mage cut from what we see is classical digital supply chain attack",
    "start": "344479",
    "end": "351520"
  },
  {
    "start": "347000",
    "end": "347000"
  },
  {
    "text": "mistake of one vendor allows reaching many organizations and i would like to bring two examples",
    "start": "351520",
    "end": "357680"
  },
  {
    "text": "in the first one a misconfiguration in marketing performance platform in the us",
    "start": "357680",
    "end": "365199"
  },
  {
    "text": "we detected strong indications to the fact that this",
    "start": "365199",
    "end": "370240"
  },
  {
    "text": "the misconfigured cloud instance of the vendor was abused",
    "start": "370240",
    "end": "376639"
  },
  {
    "text": "uh and it could affect many retailers that loaded script from that instance we",
    "start": "376639",
    "end": "382319"
  },
  {
    "text": "reported about this issue to one of the largest retailers in the us",
    "start": "382319",
    "end": "387680"
  },
  {
    "text": "that was affected in one of its login pages it was fixed immediately by this",
    "start": "387680",
    "end": "393039"
  },
  {
    "text": "retailer and the retailer also notified the vendor that quickly fixed the issue",
    "start": "393039",
    "end": "398479"
  },
  {
    "text": "but we know that many other retailers do not even know about this incident",
    "start": "398479",
    "end": "404400"
  },
  {
    "text": "they don't know that they were affected by it a second example even bigger one",
    "start": "404400",
    "end": "411520"
  },
  {
    "text": "security misconfiguration in one of the five largest advertising agency networks",
    "start": "411520",
    "end": "417360"
  },
  {
    "text": "according to wikipedia allows to run code on many of their customers we talk about",
    "start": "417360",
    "end": "424000"
  },
  {
    "text": "the largest brands in the world most of the largest brands in some countries",
    "start": "424000",
    "end": "429840"
  },
  {
    "text": "global corporations and really many others here we directly contacted um the vendor",
    "start": "429840",
    "end": "436960"
  },
  {
    "text": "the vendor quickly fixed the issue yet as far as we know the vendor has never reported",
    "start": "436960",
    "end": "444160"
  },
  {
    "text": "about this security vulnerability to any of the many affected companies",
    "start": "444160",
    "end": "452720"
  },
  {
    "text": "so what are the challenges about mage card it happens without",
    "start": "453039",
    "end": "458400"
  },
  {
    "text": "anybody knowing about it in most of the cases it happens outside the organization as you",
    "start": "458400",
    "end": "464319"
  },
  {
    "text": "could see from the few examples we brought and we so many examples like that the third part is do not disclose",
    "start": "464319",
    "end": "470479"
  },
  {
    "text": "vulnerabilities incidents to affect it and companies if you remember the diagram it looks the",
    "start": "470479",
    "end": "476560"
  },
  {
    "text": "same from the server's perspective so hackers can complete a major card attack without a single packet going through",
    "start": "476560",
    "end": "483199"
  },
  {
    "text": "the organizational network and what we are going to talk about is the fact that security solutions today",
    "start": "483199",
    "end": "489520"
  },
  {
    "text": "are blind about it including the ones that should be anti-magic [Music]",
    "start": "489520",
    "end": "495199"
  },
  {
    "start": "494000",
    "end": "494000"
  },
  {
    "text": "so uh some statistics the data in the title of the talk we say ten",
    "start": "495199",
    "end": "501520"
  },
  {
    "text": "thousand major vulnerabilities actually it is much more than that um so the source of",
    "start": "501520",
    "end": "507199"
  },
  {
    "text": "the data is cyberpunk's global monitoring system we have a system that analyzes the entire internet a little",
    "start": "507199",
    "end": "512479"
  },
  {
    "text": "more than that assets and the connections between them we were able to detect mage card",
    "start": "512479",
    "end": "517760"
  },
  {
    "text": "vulnerabilities and to track their exploitation in some of the cases we took",
    "start": "517760",
    "end": "524080"
  },
  {
    "text": "active steps and we hijack hijacked",
    "start": "524080",
    "end": "530560"
  },
  {
    "text": "servers so we were able to see and analyze the server side of the attack to see",
    "start": "530640",
    "end": "537040"
  },
  {
    "text": "what the hackers can see once they take over the servers the servers of the third",
    "start": "537040",
    "end": "542720"
  },
  {
    "text": "party the trigger for the research if you're interested basically we detected several major",
    "start": "542720",
    "end": "549519"
  },
  {
    "text": "vulnerabilities in our system including several incidents of mage cart",
    "start": "549519",
    "end": "555279"
  },
  {
    "text": "abused you know resources",
    "start": "555279",
    "end": "560320"
  },
  {
    "text": "and we found that some of the assets that suffered from the issue",
    "start": "560480",
    "end": "565680"
  },
  {
    "text": "uh were actually protected by anti-mage cart solutions so it triggered it",
    "start": "565680",
    "end": "571120"
  },
  {
    "text": "brought us to deeply dive into this problem and see why",
    "start": "571120",
    "end": "577440"
  },
  {
    "text": "why it happened why the solution failed to catch the attacks so to the numbers we detected more than",
    "start": "577440",
    "end": "584880"
  },
  {
    "start": "582000",
    "end": "582000"
  },
  {
    "text": "30 000 vulnerable assets we made efforts to disclose vulnerabilities and yet",
    "start": "584880",
    "end": "591519"
  },
  {
    "text": "it would be nice for me to say that we had partial success in most of the cases third parties",
    "start": "591519",
    "end": "597279"
  },
  {
    "text": "haven't reported to affected organizations or replied to us organizations that were affected we",
    "start": "597279",
    "end": "604560"
  },
  {
    "text": "did not respond to emails um so the situation today is that organizations do not know",
    "start": "604560",
    "end": "611360"
  },
  {
    "text": "that they are or were vulnerable to magical vulnerabilities as of today",
    "start": "611360",
    "end": "617200"
  },
  {
    "text": "october the 8th there are more than 15 000",
    "start": "617200",
    "end": "622959"
  },
  {
    "text": "unique fully qualified domain names that are still vulnerable or abused and new",
    "start": "622959",
    "end": "628560"
  },
  {
    "text": "issues are still being found just today this morning we found 10 assets of our application security",
    "start": "628560",
    "end": "636000"
  },
  {
    "text": "company one of the largest ones that are vulnerable to magic",
    "start": "636000",
    "end": "641839"
  },
  {
    "start": "641000",
    "end": "641000"
  },
  {
    "text": "let's talk about the popularity of the affected sites so as of today they said more than",
    "start": "642320",
    "end": "648240"
  },
  {
    "text": "fifteen thousand unique fully qualified domain names domain or subdomains belong to um",
    "start": "648240",
    "end": "654000"
  },
  {
    "text": "ten thousand uh unique second level domain apex domain including very popular sites and main",
    "start": "654000",
    "end": "661040"
  },
  {
    "text": "pages of newspapers there are the most famous tech retail",
    "start": "661040",
    "end": "666640"
  },
  {
    "text": "and other uh companies more than ten thousand uh more than one",
    "start": "666640",
    "end": "672399"
  },
  {
    "text": "thousand are in the alexa top ten thousands and more than two thousands are uh in the alexa top one million",
    "start": "672399",
    "end": "682640"
  },
  {
    "start": "683000",
    "end": "683000"
  },
  {
    "text": "we found that this is a cross-sector problem so just to give an idea about the big",
    "start": "684160",
    "end": "690079"
  },
  {
    "text": "names and the fact that it affects many sectors we found that in the following sectors",
    "start": "690079",
    "end": "697519"
  },
  {
    "text": "at least one of the top five okay and and of course others",
    "start": "697519",
    "end": "702720"
  },
  {
    "text": "were affected banking insurance healthcare retail pharma tech media and use both",
    "start": "702720",
    "end": "709839"
  },
  {
    "text": "newspapers and mass media agencies energy industrials airline accounting",
    "start": "709839",
    "end": "717519"
  },
  {
    "text": "including the big four food beverages companies telecom manufacturing electronics and",
    "start": "717519",
    "end": "724480"
  },
  {
    "text": "some of the biggest names in the security sector government universities global",
    "start": "724480",
    "end": "730399"
  },
  {
    "text": "organizations such as the red cross or uh or similar ones",
    "start": "730399",
    "end": "736000"
  },
  {
    "text": "and some of the big companies are are not only affected by third party they are themselves the third party through",
    "start": "736000",
    "end": "743200"
  },
  {
    "text": "which other organizations are vulnerable to magic which is worse",
    "start": "743200",
    "end": "750399"
  },
  {
    "start": "750000",
    "end": "750000"
  },
  {
    "text": "analyzing the pages that were vulnerable we found that it is possible to steal credit card",
    "start": "750399",
    "end": "756320"
  },
  {
    "text": "numbers login and personal information more sensitive business information such as crm information we found several",
    "start": "756320",
    "end": "763440"
  },
  {
    "text": "customized crm pages for example customized salesforce login pages that",
    "start": "763440",
    "end": "769040"
  },
  {
    "text": "are vulnerable to magecart um customer ticketing systems web forms",
    "start": "769040",
    "end": "774800"
  },
  {
    "text": "and on the active site we found you know as i said main page main pages of newspapers so it is",
    "start": "774800",
    "end": "781279"
  },
  {
    "start": "775000",
    "end": "775000"
  },
  {
    "text": "possible it is possible to change the headlines of the most popular media news sites",
    "start": "781279",
    "end": "787279"
  },
  {
    "text": "just think about a stock exchange manipulations that could be done it is possible to change advertisements",
    "start": "787279",
    "end": "793440"
  },
  {
    "text": "steal revenues from online ad services and he demonstrated the download app but",
    "start": "793440",
    "end": "798800"
  },
  {
    "text": "we have many other examples so it is possible to download and install malicious files and",
    "start": "798800",
    "end": "805680"
  },
  {
    "text": "when the magic card is beyond you know behind authentication so it is possible to act",
    "start": "805680",
    "end": "811279"
  },
  {
    "text": "on authenticated applications on behalf of authenticated users and basically we",
    "start": "811279",
    "end": "816959"
  },
  {
    "text": "found in many cases it is possible to start the penetration into the organizational network",
    "start": "816959",
    "end": "824560"
  },
  {
    "start": "824000",
    "end": "824000"
  },
  {
    "text": "the most important thing when we talk about magekart and the most important thing that is required to understand the",
    "start": "825040",
    "end": "832079"
  },
  {
    "text": "big gap is the threat model and we strongly believe that both enterprises and some of the",
    "start": "832079",
    "end": "839360"
  },
  {
    "text": "security solutions that aim to help enterprises fight mageguard kind of forgot about",
    "start": "839360",
    "end": "846959"
  },
  {
    "text": "the threat model part and when we talk about magic card we talk about the careful hacker",
    "start": "846959",
    "end": "852639"
  },
  {
    "text": "professional hackers are interested in earning money they are not gonna deface your site",
    "start": "852639",
    "end": "859839"
  },
  {
    "text": "they want to maximize their benefits they want to stay under the radar keep the attack",
    "start": "859839",
    "end": "867519"
  },
  {
    "text": "unknown they understand the web they are not script kitties and therefore they are careful as much",
    "start": "867519",
    "end": "875360"
  },
  {
    "text": "as they can on the other side there are the enterprises okay so many websites many",
    "start": "875360",
    "end": "881519"
  },
  {
    "start": "877000",
    "end": "877000"
  },
  {
    "text": "applications distributedly managed many teams some of their applications are",
    "start": "881519",
    "end": "886880"
  },
  {
    "text": "managed by third parties complex distributed applications variety",
    "start": "886880",
    "end": "892480"
  },
  {
    "text": "of websites and applications so very difficult to to act on",
    "start": "892480",
    "end": "898480"
  },
  {
    "text": "all of them at once and",
    "start": "898480",
    "end": "903839"
  },
  {
    "start": "901000",
    "end": "901000"
  },
  {
    "text": "to the help of the enterprises come the anti-mage card solutions",
    "start": "903839",
    "end": "909680"
  },
  {
    "text": "the most naive one script monitoring periodically load script and just check whether",
    "start": "909680",
    "end": "916639"
  },
  {
    "text": "it has been manipulated we will go through this one quickly cliented solutions add a script",
    "start": "916639",
    "end": "925199"
  },
  {
    "text": "to the pages you want to protect and this script will fight the other injected scripts",
    "start": "925199",
    "end": "931680"
  },
  {
    "text": "and solutions that use browser native mechanisms csp sri and combinations",
    "start": "931680",
    "end": "939120"
  },
  {
    "start": "938000",
    "end": "938000"
  },
  {
    "text": "general notes about the careful hacker and that's very important just think about it when you consider solving the",
    "start": "939279",
    "end": "945519"
  },
  {
    "text": "problem once the hackers the kerf yeah",
    "start": "945519",
    "end": "950959"
  },
  {
    "text": "took over a third party the hackers will not act recklessly",
    "start": "950959",
    "end": "957040"
  },
  {
    "text": "they have all the time and all the resources to detect the anti-mage card solutions major is a",
    "start": "957040",
    "end": "964160"
  },
  {
    "text": "client-side attack so they can do it easily they can study them carefully we",
    "start": "964160",
    "end": "969199"
  },
  {
    "text": "will discuss this and for hackers that plan to earn millions of dollars from a mage card",
    "start": "969199",
    "end": "975519"
  },
  {
    "text": "attack it is worth to invest hundreds of thousands dollars",
    "start": "975519",
    "end": "981120"
  },
  {
    "text": "in launching a perfect attack that is undetected okay",
    "start": "981120",
    "end": "988079"
  },
  {
    "start": "988000",
    "end": "988000"
  },
  {
    "text": "so even before we talk about the specific anti-mage card solutions",
    "start": "988079",
    "end": "994639"
  },
  {
    "text": "let's talk about something that the hackers can do they can start in small change the script gradually",
    "start": "994639",
    "end": "1000959"
  },
  {
    "text": "the beginning they will add spaces then unmeaningful changes replace one line in equivalent another line then changes",
    "start": "1000959",
    "end": "1006880"
  },
  {
    "text": "that are failed not exactly the same but not malicious and only then if they see",
    "start": "1006880",
    "end": "1012000"
  },
  {
    "text": "that nobody detects what they do they they can attack orthogonally they can start not on all",
    "start": "1012000",
    "end": "1017839"
  },
  {
    "text": "the users but on specific ip addresses potentially not from the organizational network or just from the organizational",
    "start": "1017839",
    "end": "1024880"
  },
  {
    "text": "network so they can start in small and carefully",
    "start": "1024880",
    "end": "1031280"
  },
  {
    "text": "and increase the effect of the attack they can be non-deterministic they can change their behavior",
    "start": "1031280",
    "end": "1036640"
  },
  {
    "text": "and they can generally decrease detection chance by making noise",
    "start": "1036640",
    "end": "1042720"
  },
  {
    "text": "you will be you will see in most of the cases the hackers can generate false positive alerts",
    "start": "1042720",
    "end": "1048960"
  },
  {
    "text": "easily and therefore just think about it you are a stock team",
    "start": "1048960",
    "end": "1055760"
  },
  {
    "text": "member you get an alert about a script that got changed from one of your many security solutions",
    "start": "1055760",
    "end": "1061200"
  },
  {
    "text": "but in the last two weeks you got 20 similar alerts that are basically",
    "start": "1061200",
    "end": "1067919"
  },
  {
    "text": "false positive most of the stock teams most of the security teams will just ignore it",
    "start": "1067919",
    "end": "1075440"
  },
  {
    "start": "1075000",
    "end": "1075000"
  },
  {
    "text": "okay so let's now just dive into their specific solutions start with bypass street monitoring the",
    "start": "1075840",
    "end": "1082400"
  },
  {
    "text": "easiest the simplest ones so in this case obviously the careful hacker will always",
    "start": "1082400",
    "end": "1089440"
  },
  {
    "text": "operate and control machine service as usual before acting",
    "start": "1089440",
    "end": "1094720"
  },
  {
    "text": "the hacker have the hacker has all the time to learn the traffic pattern to identify the",
    "start": "1094720",
    "end": "1100400"
  },
  {
    "text": "monitoring tool to correlate the potential monitoring tools with",
    "start": "1100400",
    "end": "1107039"
  },
  {
    "text": "with the documentation of the vendors providing these scans",
    "start": "1107039",
    "end": "1112080"
  },
  {
    "text": "potentially the hacker can buy a demo of the product",
    "start": "1112080",
    "end": "1117200"
  },
  {
    "text": "um the hacker can identify the source the sources of the request what",
    "start": "1117200",
    "end": "1122559"
  },
  {
    "text": "uh whether it comes from the cloud from a specific subnet um and basically the hackers can use the",
    "start": "1122559",
    "end": "1129440"
  },
  {
    "text": "same techniques the enterprises use um to avoid serving bots the hackers can",
    "start": "1129440",
    "end": "1135280"
  },
  {
    "text": "use the same techniques to avoid serving the monitoring solutions okay",
    "start": "1135280",
    "end": "1142480"
  },
  {
    "text": "and as i mentioned we had the opportunity to analyze some server side logs of",
    "start": "1142480",
    "end": "1147840"
  },
  {
    "text": "protected sites and you will never believe how easy it is to",
    "start": "1147840",
    "end": "1153360"
  },
  {
    "text": "distinguish between the legit traffic and the monitoring one the the frequency the",
    "start": "1153360",
    "end": "1160240"
  },
  {
    "text": "the subnets the fact that they come from the cloud most of them and some of them are super nice maybe after this talk no",
    "start": "1160240",
    "end": "1165679"
  },
  {
    "text": "longer but some of them just add to the user agent their name",
    "start": "1165679",
    "end": "1171440"
  },
  {
    "text": "okay just like that who you can the hacker can simply check the user agent oh that's",
    "start": "1171440",
    "end": "1178320"
  },
  {
    "text": "vendor x i'm gonna return a reply with the original script",
    "start": "1178320",
    "end": "1184720"
  },
  {
    "text": "others i will reply with the modified malicious one so that's about",
    "start": "1184720",
    "end": "1191840"
  },
  {
    "text": "the script monitoring and the ease of bypassing it the client side in this family of",
    "start": "1191840",
    "end": "1198480"
  },
  {
    "text": "solutions there is a client-side script of the security vendor that is added to the pages of the",
    "start": "1198480",
    "end": "1204840"
  },
  {
    "text": "applications of the website and this script should detect uh bad behavior uh of other scripts or",
    "start": "1204840",
    "end": "1212159"
  },
  {
    "text": "malicious scripts are loaded from some blacklist or something and by definition these family of",
    "start": "1212159",
    "end": "1218559"
  },
  {
    "text": "solutions cannot work against the careful hacker remember that client-side solutions",
    "start": "1218559",
    "end": "1224240"
  },
  {
    "text": "could be carefully analyzed and in the end this is a file between the fixed script of the",
    "start": "1224240",
    "end": "1231200"
  },
  {
    "text": "security solution and the hacker that can simulate the attack and change",
    "start": "1231200",
    "end": "1237280"
  },
  {
    "text": "its own script millions of times until he succeeds in bypassing",
    "start": "1237280",
    "end": "1242720"
  },
  {
    "text": "um the script of the security solution more than that we talk about many",
    "start": "1242720",
    "end": "1248080"
  },
  {
    "text": "environments in which the attack can happen dozens of desktop and",
    "start": "1248080",
    "end": "1253919"
  },
  {
    "text": "mobile browsers each of them is updated every few weeks",
    "start": "1253919",
    "end": "1260400"
  },
  {
    "text": "and different pages sometimes different pages could be different cases or different scenarios in which i don't",
    "start": "1260400",
    "end": "1266640"
  },
  {
    "text": "know some bypass will work for the hack and the hackers can basically find the",
    "start": "1266640",
    "end": "1272960"
  },
  {
    "text": "bottom line the hackers can find the bypass and choose the vulnerable environment without being detected",
    "start": "1272960",
    "end": "1280159"
  },
  {
    "start": "1280000",
    "end": "1280000"
  },
  {
    "text": "so let's see how it happens you know on the hacker side",
    "start": "1280159",
    "end": "1285440"
  },
  {
    "text": "so a real world situation is that the user the browser of the user sends the",
    "start": "1285440",
    "end": "1291039"
  },
  {
    "text": "company.com gets the html page then the once the page is rendered the page",
    "start": "1291039",
    "end": "1297440"
  },
  {
    "text": "triggers a request to load a script from the third party when the hacker",
    "start": "1297440",
    "end": "1304640"
  },
  {
    "text": "who that compromise who compromised the third party wants to simulate the attack and make sure he can bypass",
    "start": "1304640",
    "end": "1310880"
  },
  {
    "text": "he only needs his own laptop and an and an http proxy potentially as a software",
    "start": "1310880",
    "end": "1316080"
  },
  {
    "text": "on the laptop itself yes and the hacker will do the same the hacker will",
    "start": "1316080",
    "end": "1322640"
  },
  {
    "text": "load the page will get the web page once the page is loaded a request for",
    "start": "1322640",
    "end": "1328799"
  },
  {
    "text": "the script will be sent but then on the proxy side on the proxy level",
    "start": "1328799",
    "end": "1334000"
  },
  {
    "text": "the response will be modified to the attack code",
    "start": "1334000",
    "end": "1339600"
  },
  {
    "text": "then the hacker can carefully monitor what is happening on the client side on the company side",
    "start": "1339600",
    "end": "1348400"
  },
  {
    "text": "if he sees that the solution somehow succeeds um you know in the text in detecting the",
    "start": "1348400",
    "end": "1355679"
  },
  {
    "text": "change the hacker can simply block it okay the hacker controls the environment",
    "start": "1355679",
    "end": "1362720"
  },
  {
    "text": "and the hacker can try this again and again and again and again until",
    "start": "1362720",
    "end": "1368559"
  },
  {
    "text": "he succeeds and once a change no",
    "start": "1368559",
    "end": "1374720"
  },
  {
    "text": "successful change is done and there is no reaction on the cliented solution",
    "start": "1374720",
    "end": "1380240"
  },
  {
    "text": "then the actor can run the same attack on the real world directly from the compromised third",
    "start": "1380240",
    "end": "1386640"
  },
  {
    "text": "party but now the hacker knows that the client resolution will not be able to detect it",
    "start": "1386640",
    "end": "1395280"
  },
  {
    "text": "notice that in each of the steps the it is you know none of the situation",
    "start": "1396559",
    "end": "1404559"
  },
  {
    "text": "the situations are indistinguishable from the perspective of both the monitoring tool and the company so this is the real world",
    "start": "1404559",
    "end": "1412640"
  },
  {
    "text": "that's the simulation and his success that's the success and that's",
    "start": "1412640",
    "end": "1418240"
  },
  {
    "text": "the the the actual attack you can see on both the",
    "start": "1418240",
    "end": "1423919"
  },
  {
    "text": "company server and the monitoring tool it looks the same they cannot detect anything",
    "start": "1423919",
    "end": "1430960"
  },
  {
    "text": "other disadvantages of client-side solutions there is performance effect or might there might be performance effect",
    "start": "1430960",
    "end": "1437520"
  },
  {
    "text": "let's be accurate deployment is required so they're going to be skill issue",
    "start": "1437520",
    "end": "1442880"
  },
  {
    "text": "um we're gonna solve the script problem by adding another script so",
    "start": "1442880",
    "end": "1449679"
  },
  {
    "text": "based on other uh other cases in security uh",
    "start": "1449679",
    "end": "1456320"
  },
  {
    "text": "we know that it it might cause the same other problems or the same problem because",
    "start": "1456320",
    "end": "1462559"
  },
  {
    "text": "um just like the xss is an example um anti-access solutions that kind of",
    "start": "1462559",
    "end": "1469760"
  },
  {
    "text": "change um http responses and by that triggered",
    "start": "1469760",
    "end": "1474799"
  },
  {
    "text": "cross-set scripting attacks okay potentially it can happen here as well",
    "start": "1474799",
    "end": "1481919"
  },
  {
    "text": "to summarize we found mage card vulnerabilities in organizations that are protected that way we were able to",
    "start": "1482559",
    "end": "1488640"
  },
  {
    "text": "use the methodology we demonstrated to reproduce the attacks on protected organizations and to document",
    "start": "1488640",
    "end": "1495919"
  },
  {
    "text": "exfiltration of data we haven't encountered a cliented solution that successfully stopped our",
    "start": "1495919",
    "end": "1502400"
  },
  {
    "text": "mage cart attack effort and in all the cases we we succeeded to",
    "start": "1502400",
    "end": "1508640"
  },
  {
    "text": "exfiltrate the data uh also you know not to the third to the compromised third",
    "start": "1508640",
    "end": "1514080"
  },
  {
    "text": "party but to other new parties obviously we can save",
    "start": "1514080",
    "end": "1519840"
  },
  {
    "text": "with 100 confidence that none of the solutions detect what we did we believe they didn't",
    "start": "1519840",
    "end": "1526640"
  },
  {
    "text": "because we didn't see any change but potentially and it is important to say",
    "start": "1526640",
    "end": "1532559"
  },
  {
    "text": "there could be something that we missed and they somehow found what we can be 100 sure is that we succeeded in running",
    "start": "1532559",
    "end": "1540640"
  },
  {
    "text": "the code [Music] the third type of solution is",
    "start": "1540640",
    "end": "1547279"
  },
  {
    "start": "1543000",
    "end": "1543000"
  },
  {
    "text": "you know is using browser native mechanisms csp content security policy",
    "start": "1547279",
    "end": "1553279"
  },
  {
    "text": "white listing instructing the browser to whitelist the sources from which scripts could be loaded or limited and or",
    "start": "1553279",
    "end": "1560400"
  },
  {
    "text": "limiting um the origins to which a ajax request or others could be sent",
    "start": "1560400",
    "end": "1568840"
  },
  {
    "text": "um about whitelisting we all know that the csp should be used carefully usually",
    "start": "1568840",
    "end": "1576000"
  },
  {
    "text": "could be bypassed the second part of limiting this the target could be bypassed easily",
    "start": "1576000",
    "end": "1584400"
  },
  {
    "text": "a later mechanism that was added is sri sri is basically adding integrity um",
    "start": "1584400",
    "end": "1591600"
  },
  {
    "text": "check by cryptographic hash and then if the script",
    "start": "1591600",
    "end": "1597440"
  },
  {
    "text": "doesn't match the hash the browser will not uh execute the script",
    "start": "1597440",
    "end": "1604400"
  },
  {
    "text": "okay um so about mage cart and these solutions so",
    "start": "1604400",
    "end": "1609919"
  },
  {
    "text": "csv is almost irrelevant when it comes to compromised third party okay the third party",
    "start": "1609919",
    "end": "1616480"
  },
  {
    "text": "the compromise that party is whitelisted yesterday it was okay today it is bad",
    "start": "1616480",
    "end": "1621760"
  },
  {
    "text": "csp is not gonna help here um about executing the data hackers can",
    "start": "1621760",
    "end": "1627360"
  },
  {
    "text": "send the data to the compromised third party which is whitelisted or as i said could exploit the data without adjust or",
    "start": "1627360",
    "end": "1635840"
  },
  {
    "text": "you know either via dns tricks or others sri",
    "start": "1635840",
    "end": "1641360"
  },
  {
    "text": "could have been a challenge but it is very difficult to deploy it in scale",
    "start": "1641360",
    "end": "1646559"
  },
  {
    "text": "it is almost impossible to deploy sri on dynamic scripts",
    "start": "1646559",
    "end": "1652799"
  },
  {
    "text": "and remember also that legit scripts change all the time so we haven't seen a",
    "start": "1652799",
    "end": "1659039"
  },
  {
    "text": "wide appointment of sri so how do enterprises can use the",
    "start": "1659039",
    "end": "1665520"
  },
  {
    "start": "1661000",
    "end": "1661000"
  },
  {
    "text": "browser native mechanisms the first option will be manual and",
    "start": "1665520",
    "end": "1671279"
  },
  {
    "text": "this option could be done for a fraction minimal fraction of the organization's apps or sites",
    "start": "1671279",
    "end": "1677360"
  },
  {
    "text": "but again based on researches that were that were done in the past usually it could be bypassed at least",
    "start": "1677360",
    "end": "1684159"
  },
  {
    "text": "for some pages the second and more interesting for this talk is",
    "start": "1684159",
    "end": "1689679"
  },
  {
    "text": "the semi-automated tools that usually work with the following flow",
    "start": "1689679",
    "end": "1694880"
  },
  {
    "text": "find the current use of the script by using the csp report only mode or scripts themselves will collect",
    "start": "1694880",
    "end": "1700880"
  },
  {
    "text": "information and analyze the current behavior then define a policy that will prevent",
    "start": "1700880",
    "end": "1707200"
  },
  {
    "text": "the use of new sources or be heavier and then move to the block mode okay",
    "start": "1707200",
    "end": "1713279"
  },
  {
    "text": "so this mechanism could be done to a larger fraction of the organization but yet for",
    "start": "1713279",
    "end": "1718320"
  },
  {
    "text": "enterprises that we analyze they have six thousand size application you know web accessible",
    "start": "1718320",
    "end": "1723760"
  },
  {
    "text": "ones and magikov was deployed on anti-mage card solutions like that were deployed",
    "start": "1723760",
    "end": "1728960"
  },
  {
    "text": "on 10. okay so the skate problem is still here when we",
    "start": "1728960",
    "end": "1735440"
  },
  {
    "text": "talk about csp so yes the solution that",
    "start": "1735440",
    "end": "1740880"
  },
  {
    "text": "the policies still could be bypassed",
    "start": "1740880",
    "end": "1745840"
  },
  {
    "text": "the challenges so again cannot be deployed strictly in scale",
    "start": "1746240",
    "end": "1753120"
  },
  {
    "text": "we found that in protected apps or sites not all the pages use sri and csp",
    "start": "1753120",
    "end": "1760159"
  },
  {
    "text": "example we you can find applications in which in one page there is a script it is",
    "start": "1760159",
    "end": "1767279"
  },
  {
    "text": "protected by sri and a second page the same script without sri",
    "start": "1767279",
    "end": "1774720"
  },
  {
    "text": "okay just as an example and now let's talk about some new",
    "start": "1774720",
    "end": "1780559"
  },
  {
    "start": "1778000",
    "end": "1778000"
  },
  {
    "text": "techniques to manipulate bypass each of the attacks",
    "start": "1780559",
    "end": "1786960"
  },
  {
    "text": "so the first attack is the trusted source injection tsi attack and this attack exploits the user of csp or",
    "start": "1786960",
    "end": "1794559"
  },
  {
    "text": "client based scripts solutions is done by tools security solutions we",
    "start": "1794559",
    "end": "1802080"
  },
  {
    "text": "do not exploit the implementation and the design of csp and the idea would be to manipulate the",
    "start": "1802080",
    "end": "1809360"
  },
  {
    "text": "tools during the learning phase to widely hacker controlled origins",
    "start": "1809360",
    "end": "1816960"
  },
  {
    "text": "so the attack will work as follows so inspect the target website and detect the learning phase of the tool this",
    "start": "1816960",
    "end": "1823200"
  },
  {
    "text": "could be done easily because there is an evidence for that on the client side",
    "start": "1823200",
    "end": "1830159"
  },
  {
    "text": "either a csp report header or a new script of a known anti-mage called",
    "start": "1830159",
    "end": "1836080"
  },
  {
    "text": "vendor then once the learning phase begins start",
    "start": "1836080",
    "end": "1841679"
  },
  {
    "text": "manipulating it by start running the page but manipulate it with",
    "start": "1841679",
    "end": "1847039"
  },
  {
    "text": "on the proxy level and kind of add new sources to the manipulated pages",
    "start": "1847039",
    "end": "1854080"
  },
  {
    "text": "preferably run this from many ips many times and remember that because there",
    "start": "1854080",
    "end": "1859760"
  },
  {
    "text": "could be many environments for example applications can act on ip based or",
    "start": "1859760",
    "end": "1866080"
  },
  {
    "text": "depending on whether users are authenticated or not",
    "start": "1866080",
    "end": "1871120"
  },
  {
    "text": "antimate card solutions will not be able to detect that there is something wrong here",
    "start": "1871120",
    "end": "1878559"
  },
  {
    "text": "uh the hackers will continue the manipulation until the learning phase is over when in csp based solutions it is",
    "start": "1878559",
    "end": "1884559"
  },
  {
    "text": "easy to see that it is over and that the attack is successful you just see your origins",
    "start": "1884559",
    "end": "1890159"
  },
  {
    "text": "widely instead in others it depends on the implementation of the solution",
    "start": "1890159",
    "end": "1896880"
  },
  {
    "start": "1896000",
    "end": "1896000"
  },
  {
    "text": "another attack that bypasses all the attacks that we mentioned is the",
    "start": "1897279",
    "end": "1903360"
  },
  {
    "text": "scriptless mage card attack the idea here is basically to avoid",
    "start": "1903360",
    "end": "1908559"
  },
  {
    "text": "changing the script itself by changing other resources potentially fourth fifth",
    "start": "1908559",
    "end": "1915120"
  },
  {
    "text": "part is that the script is affected by them the most common one",
    "start": "1915120",
    "end": "1920399"
  },
  {
    "text": "fourth party to which ajax requests uh is sent and",
    "start": "1920399",
    "end": "1926000"
  },
  {
    "text": "the third party script is affected by so for example if the third-party script",
    "start": "1926000",
    "end": "1932240"
  },
  {
    "text": "evolves parse or row response from fourth part",
    "start": "1932240",
    "end": "1938480"
  },
  {
    "text": "okay an example for you know some statistics from a scripted major",
    "start": "1938480",
    "end": "1944080"
  },
  {
    "text": "card attack that we were able to launch and analyze again from the from the server side um so we talk about common fourth party",
    "start": "1944080",
    "end": "1953039"
  },
  {
    "text": "that was adjust we were able to to take over the fourth party",
    "start": "1953039",
    "end": "1960240"
  },
  {
    "text": "and we were able to see that uh 15 alexa top 10 000 sites uh",
    "start": "1960240",
    "end": "1968080"
  },
  {
    "text": "and many others uh are running script third-party script",
    "start": "1968080",
    "end": "1973919"
  },
  {
    "text": "that load that eval the http response that they adjust you know",
    "start": "1973919",
    "end": "1979360"
  },
  {
    "text": "from from our fourth party most of them were in this case media and use and media news and retail sites",
    "start": "1979360",
    "end": "1988000"
  },
  {
    "text": "and in three hours we were able to see half a million",
    "start": "1988000",
    "end": "1993279"
  },
  {
    "text": "requests from more than 200 000 unique ips um many of them from android",
    "start": "1993279",
    "end": "2000080"
  },
  {
    "text": "applications many of some of them from vulnerable browsers so we could",
    "start": "2000080",
    "end": "2006399"
  },
  {
    "text": "even do more than just attacking the application but we could attack potentially the machines",
    "start": "2006399",
    "end": "2011679"
  },
  {
    "text": "themselves um and yes we could do we were able to",
    "start": "2011679",
    "end": "2018000"
  },
  {
    "text": "manipulate the fourth party and see that actually it could is being run uh",
    "start": "2018000",
    "end": "2023760"
  },
  {
    "text": "on the on the sides so yes to summarize um the anti-mage",
    "start": "2023760",
    "end": "2030399"
  },
  {
    "start": "2026000",
    "end": "2026000"
  },
  {
    "text": "card solutions the enterprise versus the hackers we see scalability problems solutions",
    "start": "2030399",
    "end": "2037840"
  },
  {
    "text": "are either not scalable you know in terms of sites",
    "start": "2037840",
    "end": "2043519"
  },
  {
    "text": "and applications or not to all the pages on the same site",
    "start": "2043519",
    "end": "2049839"
  },
  {
    "text": "none of the attacks can catch the scriptless variants or similar ones hackers can generate",
    "start": "2050159",
    "end": "2057200"
  },
  {
    "text": "false positive in many of the cases if they attack",
    "start": "2057200",
    "end": "2063440"
  },
  {
    "text": "the attack in some of the cases in the split monitoring cannot work and cannot catch",
    "start": "2063440",
    "end": "2070240"
  },
  {
    "text": "targeted attacks some of the attacks might pose performance over it or more worse than",
    "start": "2070240",
    "end": "2077919"
  },
  {
    "text": "that security risk and in all of them based on what we saw the bad guys win the enterprise",
    "start": "2077919",
    "end": "2085358"
  },
  {
    "text": "just lose to the hackers the hackers to be more accurate the hackers can't lose",
    "start": "2085359",
    "end": "2091440"
  },
  {
    "text": "so based on our analysis we believe that most major card attacks are completed without being detected",
    "start": "2091440",
    "end": "2097920"
  },
  {
    "text": "organizations only later find their data sold or exploited and",
    "start": "2097920",
    "end": "2102960"
  },
  {
    "text": "maybe they will be able to detect what is the source of the breach we found that",
    "start": "2102960",
    "end": "2109760"
  },
  {
    "text": "script vendors do not report to their customers to the affected companies that's why the awareness is so",
    "start": "2109760",
    "end": "2115599"
  },
  {
    "text": "low and in the bottom line the bad guys win what could be done",
    "start": "2115599",
    "end": "2122320"
  },
  {
    "start": "2120000",
    "end": "2120000"
  },
  {
    "text": "we believe that the best option is yet the browser native mechanisms but they should be used carefully",
    "start": "2122320",
    "end": "2129040"
  },
  {
    "text": "manually by the people who know the best the application they will be",
    "start": "2129040",
    "end": "2134720"
  },
  {
    "text": "able to detect when something is manipulated they would they know what are the third parties",
    "start": "2134720",
    "end": "2141520"
  },
  {
    "text": "we call the browser vendors provide us with more tools to protect ourselves and for sure a different approach is",
    "start": "2141520",
    "end": "2148400"
  },
  {
    "text": "required you can be sure that the amazing findings here and the",
    "start": "2148400",
    "end": "2153520"
  },
  {
    "text": "findings that we still get every day triggered or triggered",
    "start": "2153520",
    "end": "2158640"
  },
  {
    "text": "more research you know on our side we already developed something and i",
    "start": "2158640",
    "end": "2163920"
  },
  {
    "text": "invite you to follow myself and cyberpunk on linkedin hopefully um",
    "start": "2163920",
    "end": "2170160"
  },
  {
    "text": "we now allow everybody to check whether they are affected and we plan to publish more information",
    "start": "2170160",
    "end": "2176640"
  },
  {
    "text": "about the many cases we detected um so stay tuned",
    "start": "2176640",
    "end": "2183200"
  },
  {
    "text": "if you want to check whether your organization is in the statistic we developed a site simple app",
    "start": "2183200",
    "end": "2190000"
  },
  {
    "text": "we don't send the sensitive data we don't keep it you know on this public server but this page will tell you",
    "start": "2190000",
    "end": "2195760"
  },
  {
    "text": "whether your organization is affected was affected still affected and you will be able then to get more details",
    "start": "2195760",
    "end": "2204720"
  },
  {
    "text": "and yes thank you very very much and i'm available",
    "start": "2205280",
    "end": "2210960"
  },
  {
    "text": "connect via linkedin and you're welcome you know to ask questions",
    "start": "2210960",
    "end": "2217280"
  },
  {
    "text": "email or any other way thank you [Music]",
    "start": "2217280",
    "end": "2231279"
  },
  {
    "text": "you",
    "start": "2231760",
    "end": "2233839"
  }
]