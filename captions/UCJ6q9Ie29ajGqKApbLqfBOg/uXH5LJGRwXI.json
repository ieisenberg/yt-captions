[
  {
    "start": "0",
    "end": "42000"
  },
  {
    "text": "this session is breaking Samsung's arm trust zone with Maxine Peterman all",
    "start": "60",
    "end": "21359"
  },
  {
    "text": "right all right good afternoon everyone",
    "start": "21359",
    "end": "27240"
  },
  {
    "text": "thanks for coming to this presentation about breaking Samsung Amazon my name is Maksim potala I'm working at",
    "start": "27240",
    "end": "33690"
  },
  {
    "text": "quarks lab which is a French security company and I've been working on this subject for about a year with two of my",
    "start": "33690",
    "end": "39030"
  },
  {
    "text": "colleagues Alex Adams key and refer get more so our agenda for today this is the following first I'll talk about the",
    "start": "39030",
    "end": "45149"
  },
  {
    "start": "42000",
    "end": "69000"
  },
  {
    "text": "current state of emitted security to give you an idea of where Troezen is coming from and why do we need it",
    "start": "45149",
    "end": "51210"
  },
  {
    "text": "then I'll introduce the actual arm chosen technology give you a year of hobby the entrant knows what the",
    "start": "51210",
    "end": "57300"
  },
  {
    "text": "internals are then I'll focus on Samson's trustzone implementation and",
    "start": "57300",
    "end": "62640"
  },
  {
    "text": "after that we'll talk about vanity research tool developments and exploitation so let's start with the",
    "start": "62640",
    "end": "70770"
  },
  {
    "start": "69000",
    "end": "99000"
  },
  {
    "text": "current state of embedded security so a long time ago we used to have this traditional architecture with everything",
    "start": "70770",
    "end": "76830"
  },
  {
    "text": "inside the kernel so we had secrets we add security medications etc and they",
    "start": "76830",
    "end": "82650"
  },
  {
    "text": "did that because they thought about well the kernel is really hard to break into so just like let's put everything in",
    "start": "82650",
    "end": "88979"
  },
  {
    "text": "there but as it has been a shown time and time again parallel is not",
    "start": "88979",
    "end": "94259"
  },
  {
    "text": "applicable and if you're able to compromise it when you have access to your entire system so at this point we",
    "start": "94259",
    "end": "100920"
  },
  {
    "start": "99000",
    "end": "169000"
  },
  {
    "text": "can ask ourself how do we protect ourselves if the kernel is corrected during the boot process while during the",
    "start": "100920",
    "end": "106439"
  },
  {
    "text": "boot process what you can do is implement mechanisms such as secrets but if we try to protect our system against",
    "start": "106439",
    "end": "114630"
  },
  {
    "text": "runtime confirmation well it's a little bit more complicated what you could do",
    "start": "114630",
    "end": "119700"
  },
  {
    "text": "is to use an improvisor now instead of having your security instant in inside your operating system",
    "start": "119700",
    "end": "126060"
  },
  {
    "text": "it's now in the hypervisor and now you're looking over you virtual machines to make sure that there",
    "start": "126060",
    "end": "132050"
  },
  {
    "text": "is no confirmation but we issues that that it's still a software implemented",
    "start": "132050",
    "end": "137350"
  },
  {
    "text": "if you have a VM escape or an I provides a compromising you it's you you you",
    "start": "137350",
    "end": "144470"
  },
  {
    "text": "still have the same issue than as before and your entire system is compromised at",
    "start": "144470",
    "end": "150380"
  },
  {
    "text": "this point vendors realize that software is not enough because you can make mistake when implementing software and I",
    "start": "150380",
    "end": "157930"
  },
  {
    "text": "saw a very large they said that maybe we can leverage the hardware to to amend",
    "start": "157930",
    "end": "163190"
  },
  {
    "text": "the system other the secretary of the system and act as some kind of safety nets and this is where trusted execution",
    "start": "163190",
    "end": "171200"
  },
  {
    "start": "169000",
    "end": "268000"
  },
  {
    "text": "environments came from so we've got stressed at execution environments what's going to happen is instead of",
    "start": "171200",
    "end": "177200"
  },
  {
    "text": "having a single state in which your SEP CPU is running you're going to have two one is the non secure state so this is",
    "start": "177200",
    "end": "184670"
  },
  {
    "text": "like the regular state where you are regular non sensitive operations will be",
    "start": "184670",
    "end": "190460"
  },
  {
    "text": "performed and then you're going to have a second state well all the sensitive operations will be performed and what's",
    "start": "190460",
    "end": "196970"
  },
  {
    "text": "going to happen is that even if you have confirmation in non secure States you won't be able to access the secure state",
    "start": "196970",
    "end": "203630"
  },
  {
    "text": "because the hardware will prevent it so we can have a different type of implementation of trusted execution",
    "start": "203630",
    "end": "210739"
  },
  {
    "text": "environments so the first one I'm going to talk about is the virtual processor so this is what is going to be used by",
    "start": "210739",
    "end": "216950"
  },
  {
    "text": "our ultra zone in that instrumentation you have a CPU and you have your system",
    "start": "216950",
    "end": "222680"
  },
  {
    "text": "on ship with all the peripherals our auto resources and you can separate these resources into the two state I was",
    "start": "222680",
    "end": "229940"
  },
  {
    "text": "talking about when you can also have an on stock processor this is pretty much",
    "start": "229940",
    "end": "235700"
  },
  {
    "text": "what is used by Apple in the second drive at least according to the documentation and now instead of having",
    "start": "235700",
    "end": "242360"
  },
  {
    "text": "a CPU that can run in two states you have two CPU and one dedicated to non sensitive operation so in unsecured",
    "start": "242360",
    "end": "248660"
  },
  {
    "text": "state and one are running in in the second States and finally you can add an external coprocessor we have just a",
    "start": "248660",
    "end": "256970"
  },
  {
    "text": "regular system and chip but is running in non second States next to that you have a secure core",
    "start": "256970",
    "end": "263960"
  },
  {
    "text": "processor but is going to be dedicated to over sensitive operations alright so",
    "start": "263960",
    "end": "269900"
  },
  {
    "text": "now let's talk about the actual arm chosen technology so I'm trans own is a system-wide Hardware isolation mechanism",
    "start": "269900",
    "end": "276430"
  },
  {
    "text": "meaning that it's going to be based on two two layers so you have your hardware",
    "start": "276430",
    "end": "284270"
  },
  {
    "text": "architecture so this is what all the partitioning is going to take place is where you going to you of your database",
    "start": "284270",
    "end": "290330"
  },
  {
    "text": "your control bus but is going to be separated into a non circular state and second States and you also have your",
    "start": "290330",
    "end": "297170"
  },
  {
    "text": "software architecture where you have the actual software implementation implementation that you're going to run",
    "start": "297170",
    "end": "302930"
  },
  {
    "text": "in six states so this point I've only talked about non secure state and second",
    "start": "302930",
    "end": "310010"
  },
  {
    "text": "states what you usually will encounter actually secure and non-secure worlds",
    "start": "310010",
    "end": "316370"
  },
  {
    "text": "and again so in the second world you have all the trusted code you have all those sensitive operations that are",
    "start": "316370",
    "end": "322760"
  },
  {
    "text": "being performed and in the normal world this is well you will app for example on",
    "start": "322760",
    "end": "328400"
  },
  {
    "text": "Samsungs advices this is where Android is running you have your normal well that is considered as compromised by",
    "start": "328400",
    "end": "335660"
  },
  {
    "text": "design and this is where all the non sensitive operation take place so to",
    "start": "335660",
    "end": "341690"
  },
  {
    "start": "340000",
    "end": "363000"
  },
  {
    "text": "know so the secure or non secure state of the CPU is going to be determined by the least significant bits in the secure",
    "start": "341690",
    "end": "348590"
  },
  {
    "text": "configuration register and so this this significant bit is called the NS bits",
    "start": "348590",
    "end": "353630"
  },
  {
    "text": "and it's going to be clear when you're running in Sector States and it's going",
    "start": "353630",
    "end": "359210"
  },
  {
    "text": "to be set ran running in non secure States just a quick reminder on the",
    "start": "359210",
    "end": "365300"
  },
  {
    "start": "363000",
    "end": "390000"
  },
  {
    "text": "privileges separation that exists on arm system so in mv7 you have what is called",
    "start": "365300",
    "end": "370760"
  },
  {
    "text": "privilege levels and in arm v8 you have what is called exception levels so this is just a naming convention it's pretty",
    "start": "370760",
    "end": "377390"
  },
  {
    "text": "much the same thing and I from now on I'll only talk about exception levels so",
    "start": "377390",
    "end": "384190"
  },
  {
    "text": "in ER zero so exception level 0 you have all the applications so in the normal",
    "start": "384190",
    "end": "390860"
  },
  {
    "start": "390000",
    "end": "515000"
  },
  {
    "text": "world in the secure world so just privileged exception level then you have l1 this is where the operational system",
    "start": "390860",
    "end": "397850"
  },
  {
    "text": "will be then l2 UI provider and then el 3er free only exists in the sector well",
    "start": "397850",
    "end": "404630"
  },
  {
    "text": "there's no elf in the normal world and this is where you will find your second money - I'll talk about the second",
    "start": "404630",
    "end": "410150"
  },
  {
    "text": "monitor just after one thing I wanted to note here is that as you can see there",
    "start": "410150",
    "end": "415880"
  },
  {
    "text": "is no hypervisor in the in the sector wall this is because at the moment there",
    "start": "415880",
    "end": "422000"
  },
  {
    "text": "is no there's no way our arm does not provide any way to to do that in the",
    "start": "422000",
    "end": "430790"
  },
  {
    "text": "secure vault currently and this is an upcoming feature that is coming on the 8.4 with the 8th edition of sake of",
    "start": "430790",
    "end": "438830"
  },
  {
    "text": "options but for the moment what you have is a privilege escalation by design",
    "start": "438830",
    "end": "445220"
  },
  {
    "text": "meaning that if you have code execution in SEL 1 you have access to the same",
    "start": "445220",
    "end": "450620"
  },
  {
    "text": "resources as l3 alright so now now we",
    "start": "450620",
    "end": "458150"
  },
  {
    "text": "know how we can commit we can switch between the two states or how we know",
    "start": "458150",
    "end": "463790"
  },
  {
    "text": "how we can be free or in normal world or insecure world now how do we do to communicate between these two these two",
    "start": "463790",
    "end": "470060"
  },
  {
    "text": "words so to do that we are going to use the sacrimoni term and the second monitor is going to run at the highest",
    "start": "470060",
    "end": "476890"
  },
  {
    "text": "exception level on an arm platform and if you want to exchange data between the",
    "start": "476890",
    "end": "483890"
  },
  {
    "text": "normal world in the sector world you have different mechanisms to do so first we have explicit calls so visual secure",
    "start": "483890",
    "end": "490610"
  },
  {
    "text": "of monitor call instruction then you have also interruptions external bots",
    "start": "490610",
    "end": "496670"
  },
  {
    "text": "and if you are in the sector world and at least in sl1 you can directly write",
    "start": "496670",
    "end": "502100"
  },
  {
    "text": "into our P state register in our v8 over CPS or register in our p7",
    "start": "502100",
    "end": "508100"
  },
  {
    "text": "risk because it requires certain privilege to do so alright so now let's",
    "start": "508100",
    "end": "517250"
  },
  {
    "start": "515000",
    "end": "589000"
  },
  {
    "text": "talk about the different software implementation that you can find in the second world so in the second world you",
    "start": "517250",
    "end": "524270"
  },
  {
    "text": "can have a full-fledged operating system so we will secure OS but is going to load trusted applications and this is",
    "start": "524270",
    "end": "532170"
  },
  {
    "text": "pretty much what you're going to find on sunghoon's devices on Perkins devices then you can have a lighter solution",
    "start": "532170",
    "end": "540170"
  },
  {
    "text": "pretty much completely the opposite where you have a synchronous library",
    "start": "540170",
    "end": "545730"
  },
  {
    "text": "which is going to be used by the normal world as some kind of sexual API and you",
    "start": "545730",
    "end": "550830"
  },
  {
    "text": "can run cryptographic operations and you have all you secret keys but are stored",
    "start": "550830",
    "end": "558150"
  },
  {
    "text": "in the secret world and the normal world cannot access them and this is a way that you can do a cryptography in the second manner and an example of such an",
    "start": "558150",
    "end": "565530"
  },
  {
    "text": "implementation will be the Nintendo switch and finally of the arm",
    "start": "565530",
    "end": "570600"
  },
  {
    "text": "documentation talks about intermediate options we have never seen something like like this in practice but in theory",
    "start": "570600",
    "end": "579450"
  },
  {
    "text": "because of the trust on technology is so flexible you can do pretty much anything you want but to our knowledge it's not",
    "start": "579450",
    "end": "586140"
  },
  {
    "text": "used that much all right so what is chosen actually useful well most of the",
    "start": "586140",
    "end": "593670"
  },
  {
    "start": "589000",
    "end": "631000"
  },
  {
    "text": "time trustzone will be used to access Hardware backed features for example the",
    "start": "593670",
    "end": "600450"
  },
  {
    "text": "cryptographic engine credential storage trng etc and using these other Bank",
    "start": "600450",
    "end": "607530"
  },
  {
    "text": "features you can start to create more advanced systems such as DRM and you can",
    "start": "607530",
    "end": "615300"
  },
  {
    "text": "also do things such as protecting and monitoring the normal world by using the second row and an example of that would",
    "start": "615300",
    "end": "621090"
  },
  {
    "text": "be Samsung's or KP for real-time kernel protection and Samsung speaker a PKM for",
    "start": "621090",
    "end": "628320"
  },
  {
    "text": "periodic criminal measurements all right so now I've talked about Amazon explain",
    "start": "628320",
    "end": "637500"
  },
  {
    "start": "631000",
    "end": "725000"
  },
  {
    "text": "a little bit how it works and now let's see how they the implementation that has",
    "start": "637500",
    "end": "642750"
  },
  {
    "text": "been done by Samsung so Samsung devices are a bit particular",
    "start": "642750",
    "end": "649110"
  },
  {
    "text": "because they can either a system ownership that is made by Samsung so",
    "start": "649110",
    "end": "654180"
  },
  {
    "text": "this is the Exynos sucks and then they can also use quite Cubs vagrant the the reason for that is that",
    "start": "654180",
    "end": "661019"
  },
  {
    "text": "depending on the country because of telecommunication norms because of patent issues you will have either the",
    "start": "661019",
    "end": "669119"
  },
  {
    "text": "NXT knows our Snapdragon the thing that is important is to do is to note to note",
    "start": "669119",
    "end": "674579"
  },
  {
    "text": "is that some some stress zone is only found on Exynos socks otherwise it's",
    "start": "674579",
    "end": "681449"
  },
  {
    "text": "going to be Qualcomm stress zone and this zone was first used on the samsung",
    "start": "681449",
    "end": "687029"
  },
  {
    "text": "galaxy s3 and the trusted OS but but i used two different trusted OS the first",
    "start": "687029",
    "end": "694589"
  },
  {
    "text": "one is QB but is developed by Tristana and you can find this trusted OS from",
    "start": "694589",
    "end": "700170"
  },
  {
    "text": "the galaxy s3 to the galaxy s time and now they are starting to replace kb by",
    "start": "700170",
    "end": "705629"
  },
  {
    "text": "their own implementation which is called tigress and you can find this one on the galaxy s 10 and so I'm only talking",
    "start": "705629",
    "end": "713879"
  },
  {
    "text": "about galaxy models here but these two trusted OS are used on other phones and",
    "start": "713879",
    "end": "719639"
  },
  {
    "text": "other models - and this talk will focus exclusively on kimby alright so this",
    "start": "719639",
    "end": "727079"
  },
  {
    "start": "725000",
    "end": "841000"
  },
  {
    "text": "presentation is not the first publication on the subject there has already been research done on the",
    "start": "727079",
    "end": "735389"
  },
  {
    "text": "subject before so here i've noted a free notable example the first one is reverse",
    "start": "735389",
    "end": "742110"
  },
  {
    "text": "engineering samsung s6 s boots biphenyl and song in this article he explains our",
    "start": "742110",
    "end": "748730"
  },
  {
    "text": "untrusted firmware of a secure monitor implementation that is used by samsung works and it also explain how you can",
    "start": "748730",
    "end": "755910"
  },
  {
    "text": "extract the trusted OS from an MTA when you have unbox your phone by daniel kumara me where he reversed engineer a",
    "start": "755910",
    "end": "763410"
  },
  {
    "text": "really big part of the TV and the different components a lot of our work",
    "start": "763410",
    "end": "769019"
  },
  {
    "text": "is based on what he has done and in his article series he also explained how",
    "start": "769019",
    "end": "774929"
  },
  {
    "text": "exploited vulnerabilities are in some trust sets and finally various trust issues exporting trust owns his bike out",
    "start": "774929",
    "end": "781589"
  },
  {
    "text": "on Yamini and in this in this article he has an a security analysis of different trusted",
    "start": "781589",
    "end": "787259"
  },
  {
    "text": "execution environments and one of the really important resolve",
    "start": "787259",
    "end": "792260"
  },
  {
    "text": "that he has found is that there was no replication in some sixth row so and",
    "start": "792260",
    "end": "797870"
  },
  {
    "text": "what that means is that if you have a trusted application that is vulnerable you are still able to load it on the",
    "start": "797870",
    "end": "805880"
  },
  {
    "text": "newest versions of the of the trusted OS which should not happen because if you've in reality you patched it you",
    "start": "805880",
    "end": "811850"
  },
  {
    "text": "shouldn't be able to load all the trusted in the neuro Trussell and now KB",
    "start": "811850",
    "end": "817250"
  },
  {
    "text": "as influences a feature but manages just that but the issue is that at the moment",
    "start": "817250",
    "end": "824840"
  },
  {
    "text": "there are some trust sets but do not use that feature meaning that even on the Galaxy S line you still have replication",
    "start": "824840",
    "end": "831530"
  },
  {
    "text": "problems and if you have Finnerty in the trusted form I don't know six months ago you're still able to exploit it in",
    "start": "831530",
    "end": "838790"
  },
  {
    "text": "upstream versions okay so now let's talk",
    "start": "838790",
    "end": "844430"
  },
  {
    "start": "841000",
    "end": "1110000"
  },
  {
    "text": "about the architecture of Samsung's trestle so in the normal world you will have different components so you have",
    "start": "844430",
    "end": "850790"
  },
  {
    "text": "drivers diamonds libraries interfaces also going to be used by the normal world to communicate with the sacred",
    "start": "850790",
    "end": "856250"
  },
  {
    "text": "world the communications are going to pass through of SMC's and since SM seeds",
    "start": "856250",
    "end": "862100"
  },
  {
    "text": "are cannot they cannot pass a lot of info of information what's going to",
    "start": "862100",
    "end": "868610"
  },
  {
    "text": "happen is what we are going to use the SMC s to set up a shared memory buffer and most of the data will be transferred",
    "start": "868610",
    "end": "876590"
  },
  {
    "text": "using this shared memory buffer then you have the second monitor implementation",
    "start": "876590",
    "end": "882860"
  },
  {
    "text": "so as I said very very using arm trusted firmware which is an open source reference provided by arm and the what",
    "start": "882860",
    "end": "891230"
  },
  {
    "text": "is interesting with wisdom and assurance that yeah first it's open source so there are chances but it has been every",
    "start": "891230",
    "end": "897020"
  },
  {
    "text": "deal reviewed and it's pretty safe to use it and also that it's really modular meaning that any vendor can take this",
    "start": "897020",
    "end": "905450"
  },
  {
    "text": "implementation and adapt it to where to their own needs and finally now I'm",
    "start": "905450",
    "end": "911300"
  },
  {
    "text": "going to concentrate on the SEL 0 and sql1 components",
    "start": "911300",
    "end": "916680"
  },
  {
    "text": "and when you call that the trusted OS and the trusted OS is based on a microkernel architecture so the trust",
    "start": "916680",
    "end": "924420"
  },
  {
    "text": "otherwise is key be it's so 52 bit OS but is the load by trust niche and the",
    "start": "924420",
    "end": "930119"
  },
  {
    "text": "actual microkernel is called MDK and it's the only component that is going to run in SEL what all the other components",
    "start": "930119",
    "end": "936240"
  },
  {
    "text": "are running in SEL zero which limits a lot being attacked so face that's you",
    "start": "936240",
    "end": "941339"
  },
  {
    "text": "but you have on on key B but lesser privileged processes still need to",
    "start": "941339",
    "end": "948149"
  },
  {
    "text": "execute some some privileged operation and to do that mtk provides Cisco so",
    "start": "948149",
    "end": "956429"
  },
  {
    "text": "which is called you can do things such as memory mapping process creation SMC's but this as this is a lot available to",
    "start": "956429",
    "end": "962999"
  },
  {
    "text": "all type of processes it depends on their on their privileges because we",
    "start": "962999",
    "end": "970350"
  },
  {
    "text": "have Software Defined our privileges in SEL jewel one of the other thing can be",
    "start": "970350",
    "end": "977490"
  },
  {
    "text": "is responsible for is to build other components and especially our TM a TM is",
    "start": "977490",
    "end": "984300"
  },
  {
    "text": "the runtime manager this is also a component that is running as hill 0 and this is like a special type of trusted",
    "start": "984300",
    "end": "992160"
  },
  {
    "text": "application and its equivalent review to the init process on Linus its main task is going to be to start and manage all",
    "start": "992160",
    "end": "999240"
  },
  {
    "text": "the processes but also to manage the oops to manage the communication between",
    "start": "999240",
    "end": "1004809"
  },
  {
    "text": "addressed applications and the normal world and also to manage the",
    "start": "1004809",
    "end": "1010279"
  },
  {
    "text": "communications between the over processes running in ser 0 and to do",
    "start": "1010279",
    "end": "1017240"
  },
  {
    "text": "that so you so you have IPC's and also the mobile pod the mobile communication",
    "start": "1017240",
    "end": "1022879"
  },
  {
    "text": "interface to communicate with the normal world then we have the MC leave so this is",
    "start": "1022879",
    "end": "1029510"
  },
  {
    "text": "skinny beast and the library it's going to provide standard function for certain applications liquid drivers and also all",
    "start": "1029510",
    "end": "1035538"
  },
  {
    "text": "TM it's separated into two sets of api's you have the JPS vote Russell",
    "start": "1035539",
    "end": "1040819"
  },
  {
    "text": "application which is called adhere ad ice and then you have the functions for use by secure drivers which are called",
    "start": "1040819",
    "end": "1047298"
  },
  {
    "text": "the Geo API X and this library is especially useful when we're doing",
    "start": "1047299",
    "end": "1052789"
  },
  {
    "text": "exploitation because this is where we're going to find most of our gadgets all",
    "start": "1052789",
    "end": "1058340"
  },
  {
    "text": "right so at this point ever talked a lot about trusted applications but I didn't give an actual definition of it so",
    "start": "1058340",
    "end": "1064220"
  },
  {
    "text": "trusted applications are like the equivalent of regular application that you find in the normal world and we're",
    "start": "1064220",
    "end": "1070099"
  },
  {
    "text": "going to run in SES Europe and since you have a central operating system running the trusted OS as limited",
    "start": "1070099",
    "end": "1076429"
  },
  {
    "text": "functionalities what's going to happen is that you have your trusted applications that are used as an",
    "start": "1076429",
    "end": "1082789"
  },
  {
    "text": "extension of the trusted OS so that you're able to implement more functionalities such as trust a UI",
    "start": "1082789",
    "end": "1089359"
  },
  {
    "text": "grm secret storage and cetera and these binaries so we execute tools they are",
    "start": "1089359",
    "end": "1096379"
  },
  {
    "text": "going to be loaded directly from the normal world and to make sure that you",
    "start": "1096379",
    "end": "1102559"
  },
  {
    "text": "cannot just rule any executable they are signed by Tristana so the lifecycle of",
    "start": "1102559",
    "end": "1112070"
  },
  {
    "start": "1110000",
    "end": "1267000"
  },
  {
    "text": "trusted applications when you're going to build a trust certification from the normal world you will so use the API",
    "start": "1112070",
    "end": "1118639"
  },
  {
    "text": "proof in the normal world you send your application in the second well the trusted OS I mean RTM is going to check",
    "start": "1118639",
    "end": "1126679"
  },
  {
    "text": "the signature to make sure that it's it's ok then it's going to make",
    "start": "1126679",
    "end": "1132009"
  },
  {
    "text": "different checks in its radiation such as stachy linearization and one thing to",
    "start": "1132009",
    "end": "1138019"
  },
  {
    "text": "note also is that the communication between normal world and the Trust debts will be musta made using a wheelchair",
    "start": "1138019",
    "end": "1145489"
  },
  {
    "text": "memory buffer and in chemistry terminal and Trust onyx terminology this world",
    "start": "1145489",
    "end": "1151039"
  },
  {
    "text": "memory buffer is called the TCI buffer and this is here buffer is going to to",
    "start": "1151039",
    "end": "1156289"
  },
  {
    "text": "contain data so what's going to happen is that you know normal well you're going to put data in your DCI buffer you",
    "start": "1156289",
    "end": "1163099"
  },
  {
    "text": "send a notification to the trust at that data are waiting to be processed the trust that is entered an infinite loop",
    "start": "1163099",
    "end": "1170599"
  },
  {
    "text": "while it's going to wait for its notification when it's going to look at the data that is in the DCI buffer",
    "start": "1170599",
    "end": "1176559"
  },
  {
    "text": "depending on the data that you have sent it's going to execute a certain type of",
    "start": "1176559",
    "end": "1182509"
  },
  {
    "text": "command and also his comment as I've been I've been performed trusted application white",
    "start": "1182509",
    "end": "1190039"
  },
  {
    "text": "backs the results into the TCI buffer and it's going to notify the normal world that Pokemon has been involved and",
    "start": "1190039",
    "end": "1196280"
  },
  {
    "text": "the normal can now recruit the results from the TCM ever also secured drivers",
    "start": "1196280",
    "end": "1203030"
  },
  {
    "text": "so secure drivers are a special type of trusted applications they also run that",
    "start": "1203030",
    "end": "1208340"
  },
  {
    "text": "as here zero but they have more privileges than ventra states because",
    "start": "1208340",
    "end": "1213500"
  },
  {
    "text": "they have access to a richer set of API so access to more as we seize and they",
    "start": "1213500",
    "end": "1219200"
  },
  {
    "text": "are used they are also used by trusted as an interface to access physical",
    "start": "1219200",
    "end": "1225470"
  },
  {
    "text": "memory and also sector resources so and",
    "start": "1225470",
    "end": "1230929"
  },
  {
    "text": "to do that because we don't want trust that you to be able to do anything even though we are running in the trusted",
    "start": "1230929",
    "end": "1236419"
  },
  {
    "text": "world they they even though we're",
    "start": "1236419",
    "end": "1242120"
  },
  {
    "text": "running in the trust as well they are not completely trusted and they cannot do anything they want and the single",
    "start": "1242120",
    "end": "1248960"
  },
  {
    "text": "drivers are acting as some kind of sexual buffer between the security of",
    "start": "1248960",
    "end": "1254809"
  },
  {
    "text": "our resources and electro certification and so I know that you to communicate",
    "start": "1254809",
    "end": "1260720"
  },
  {
    "text": "with the sacred driver the trust let will use I pcs and send data using that",
    "start": "1260720",
    "end": "1267100"
  },
  {
    "start": "1267000",
    "end": "1457000"
  },
  {
    "text": "alright so this was the big overview of what Samsung's chosen is and how it",
    "start": "1267100",
    "end": "1274460"
  },
  {
    "text": "works so now let's see how we're going to find rarities on this platform so",
    "start": "1274460",
    "end": "1280520"
  },
  {
    "text": "first we needed to assess this the attack surface on on this target so we",
    "start": "1280520",
    "end": "1287600"
  },
  {
    "text": "are in the normal world and we want you a privileged Java code execution in SEL",
    "start": "1287600",
    "end": "1293210"
  },
  {
    "text": "1 or l3 what we can do is that we start by attacking a trestle application when",
    "start": "1293210",
    "end": "1300200"
  },
  {
    "text": "we attack a driver a secure driver and from there we have access to enough Cisco to have a large attack surf",
    "start": "1300200",
    "end": "1306770"
  },
  {
    "text": "surface on on the trusted OS on key B and here we could and here we could",
    "start": "1306770",
    "end": "1315040"
  },
  {
    "text": "find reneges in the the SBC's and try to gain code execution in sl1 what we can",
    "start": "1315040",
    "end": "1322240"
  },
  {
    "text": "also do because sacred drivers are able to do SMC's we could also attack the monitor from from ser zero this is also",
    "start": "1322240",
    "end": "1330430"
  },
  {
    "text": "possible from the normal world but the issues that the attacks to face is really small compared to the one that",
    "start": "1330430",
    "end": "1336490"
  },
  {
    "text": "you have from the secret world and also another issues that because eighty eight",
    "start": "1336490",
    "end": "1342040"
  },
  {
    "text": "is open source there are chances that it has been heavily reviewed and so it",
    "start": "1342040",
    "end": "1347110"
  },
  {
    "text": "seemed kind of arts you find predominate in that so we we prefer to concentrate",
    "start": "1347110",
    "end": "1353260"
  },
  {
    "text": "on trusted applications because they look like low-hanging fruits so now I'm",
    "start": "1353260",
    "end": "1358420"
  },
  {
    "text": "going to explain our journey in five steps so the first one the first one is",
    "start": "1358420",
    "end": "1365100"
  },
  {
    "text": "so now we want to attack one five enemies interested application so the first thing we need to do is to load",
    "start": "1365100",
    "end": "1370690"
  },
  {
    "text": "them into a disassembled so tracer applications are based on the MCL format",
    "start": "1370690",
    "end": "1377650"
  },
  {
    "text": "it's the same thing for sacred drivers and Artyom and this is a proprietary file format but is quite simple and",
    "start": "1377650",
    "end": "1386160"
  },
  {
    "text": "there was already an idle loader for VAT format and we have also developed one",
    "start": "1386160",
    "end": "1392140"
  },
  {
    "text": "for gidran so obvious to a lot of available online if you needa next step",
    "start": "1392140",
    "end": "1400180"
  },
  {
    "text": "was to identify functions in the in the trusted because in the trust sets you",
    "start": "1400180",
    "end": "1406960"
  },
  {
    "text": "will have called to be am syllable and in them sleep you have different functions also reused in interests and",
    "start": "1406960",
    "end": "1413470"
  },
  {
    "text": "having access to this information is really useful because we get a general idea of what the trust that's useful and",
    "start": "1413470",
    "end": "1419050"
  },
  {
    "text": "here we have an example of our script in in execution in on the Left we have no",
    "start": "1419050",
    "end": "1427930"
  },
  {
    "text": "symbol it's pretty complicated to to understand what's going on but afterwards after a script has been",
    "start": "1427930",
    "end": "1433540"
  },
  {
    "text": "executed we are able to have the name of the function and also its prototype",
    "start": "1433540",
    "end": "1439320"
  },
  {
    "text": "okay so at this point we're able to do a static analysis but what we wanted to have our dynamic capabilities but",
    "start": "1440020",
    "end": "1448570"
  },
  {
    "text": "who have not access to the SDK of Tristana k-- we needed to find another solution so what we did but we developed",
    "start": "1448570",
    "end": "1455590"
  },
  {
    "text": "an emulator to emulate the trust sets so it's a simple Liberator that is based on unicorn and it's going to load B instead",
    "start": "1455590",
    "end": "1462250"
  },
  {
    "start": "1457000",
    "end": "1475000"
  },
  {
    "text": "binary it's going to map the shell memory buffer and it's going to hook the",
    "start": "1462250",
    "end": "1467580"
  },
  {
    "text": "MCV potions and also increment some of them so that the executions will trust that execute execute almost completely",
    "start": "1467580",
    "end": "1475230"
  },
  {
    "start": "1475000",
    "end": "1528000"
  },
  {
    "text": "so here's an example of the emulator running so the first thing I'm doing",
    "start": "1475230",
    "end": "1480850"
  },
  {
    "text": "here is to create an input of the TCI buffer so I putting this one in input the bin and then I'm passing this into",
    "start": "1480850",
    "end": "1488830"
  },
  {
    "text": "the bin to our emulator and now the emulator is going to execute and here we",
    "start": "1488830",
    "end": "1495610"
  },
  {
    "text": "can see that binary has a little bit we have two different sections that have been mapped and oh yeah the for simple",
    "start": "1495610",
    "end": "1502269"
  },
  {
    "text": "API love be print a function that has been hooked and we can see the outputs right here so if your emulator is really",
    "start": "1502269",
    "end": "1509590"
  },
  {
    "text": "useful during reverse engineering but also during exploitation because we were able to test our exploits on this",
    "start": "1509590",
    "end": "1514809"
  },
  {
    "text": "emulator so now we are able to find so",
    "start": "1514809",
    "end": "1520509"
  },
  {
    "text": "you have over capabilities but we Mullen we were able to find your abilities statically but we also wanted to find",
    "start": "1520509",
    "end": "1525909"
  },
  {
    "text": "them dynamically using a photo so this factor is based on our previous emulator",
    "start": "1525909",
    "end": "1532649"
  },
  {
    "start": "1528000",
    "end": "1573000"
  },
  {
    "text": "it's it's if you're familiar with Eiffel unicorn we have an internal version of",
    "start": "1532649",
    "end": "1538059"
  },
  {
    "text": "that that is equivalent but your performance the performances are a little bit better and we have used that",
    "start": "1538059",
    "end": "1544830"
  },
  {
    "text": "too so we have played this I fell for the Eiffel unique unlike projects into",
    "start": "1544830",
    "end": "1552820"
  },
  {
    "text": "our emulator and now able to further trusted using bands so here's an example",
    "start": "1552820",
    "end": "1559259"
  },
  {
    "text": "here I'm running the trust let's I'm running the photo on rosettes and you",
    "start": "1559259",
    "end": "1564610"
  },
  {
    "text": "can see that after only 12 seconds we have already free unique crashes so this",
    "start": "1564610",
    "end": "1569919"
  },
  {
    "text": "is pretty useful we have a lot of vulnerabilities using that another way",
    "start": "1569919",
    "end": "1575289"
  },
  {
    "start": "1573000",
    "end": "1653000"
  },
  {
    "text": "to control it is that we have implemented is to use a symbolic execution and you have used a Manticore",
    "start": "1575289",
    "end": "1580779"
  },
  {
    "text": "by trail of bits so the strategy that we have used is pretty simple we are using so we are",
    "start": "1580779",
    "end": "1587870"
  },
  {
    "text": "mark we are you taking the TCI buffer we are marking it as symbol like then we explore different tops of the trust at",
    "start": "1587870",
    "end": "1594470"
  },
  {
    "text": "different come on Andrew and cetera then we check the reads and writes a to memory and we look and we try to detect",
    "start": "1594470",
    "end": "1602120"
  },
  {
    "text": "there is an invalid address that has been accessed so here's an example right",
    "start": "1602120",
    "end": "1607370"
  },
  {
    "text": "here running the manticore Elektra stats and here you have a crush results and",
    "start": "1607370",
    "end": "1614900"
  },
  {
    "text": "right here you have all one that is going to be the referenced and if you look at the value of all run this is a",
    "start": "1614900",
    "end": "1621710"
  },
  {
    "text": "user control value so this is a value that is directly taken from the TTA buffer and now this is not a",
    "start": "1621710",
    "end": "1628309"
  },
  {
    "text": "vulnerability per se we don't because we still have to look at the rest of the code to make sure that it's actually",
    "start": "1628309",
    "end": "1634010"
  },
  {
    "text": "exploitable but this is a good starting point and finally now that we have over",
    "start": "1634010",
    "end": "1640280"
  },
  {
    "text": "vulnerabilities that we want we want to exploit the vulnerabilities and to do that well you have to use the natural",
    "start": "1640280",
    "end": "1647720"
  },
  {
    "text": "library of native API but available in the normal world to communicate to the secure world issues that is that we need",
    "start": "1647720",
    "end": "1655970"
  },
  {
    "text": "to write our exploit in C and we didn't want to do that because we prefer Python and so we've developed by providing for",
    "start": "1655970",
    "end": "1661940"
  },
  {
    "text": "the API in farm in the second world and so we have the API but it's called MC",
    "start": "1661940",
    "end": "1668870"
  },
  {
    "text": "clients our bindings are called pieman MC clients and it provides different",
    "start": "1668870",
    "end": "1674059"
  },
  {
    "text": "utilities just x time it's a symbol as well go and also a common interpreter",
    "start": "1674059",
    "end": "1679130"
  },
  {
    "text": "but the most interesting feature is actually video but the result is that",
    "start": "1679130",
    "end": "1685880"
  },
  {
    "text": "the script that we are using all really simple so here it's a script example but",
    "start": "1685880",
    "end": "1691550"
  },
  {
    "text": "is going to load the trust let's send a comment to it wait for the notification and display",
    "start": "1691550",
    "end": "1696590"
  },
  {
    "text": "the results and it's not even 20 lines of Python and the equivalent in C would be about a hundred lines all right so",
    "start": "1696590",
    "end": "1706070"
  },
  {
    "start": "1705000",
    "end": "1714000"
  },
  {
    "text": "with all the different tools but we have developed now let's see take a look at three vulnerabilities that we have found",
    "start": "1706070",
    "end": "1711890"
  },
  {
    "text": "and all we have exploited them so here is going to be a samsung galaxy s /",
    "start": "1711890",
    "end": "1717170"
  },
  {
    "text": "s7 that is running Android seven so this is pretty old but all the tools over methodology everything I'm explaining",
    "start": "1717170",
    "end": "1723830"
  },
  {
    "text": "here will still work on the samsung galaxy s 9 on its latest version so the",
    "start": "1723830",
    "end": "1729770"
  },
  {
    "text": "main goal here is to thing called execution in el3 and the paratroop prerequisites are to be part of the",
    "start": "1729770",
    "end": "1735260"
  },
  {
    "text": "radio group because this is the earliest after age group that is able to communicate with the trestle and also to",
    "start": "1735260",
    "end": "1740840"
  },
  {
    "text": "be able to write files somewhere on the device so our attack plan here is to go",
    "start": "1740840",
    "end": "1747440"
  },
  {
    "start": "1744000",
    "end": "1762000"
  },
  {
    "text": "from the normal world try to find phonology electrostatics it's hosted application exploited find a",
    "start": "1747440",
    "end": "1753560"
  },
  {
    "text": "vulnerability in a second driver exploit it again and then we're going to attack the trusted OS and the monitor so the",
    "start": "1753560",
    "end": "1763700"
  },
  {
    "start": "1762000",
    "end": "1801000"
  },
  {
    "text": "sub cementation that you found in intro zone or most evil the lack of error the",
    "start": "1763700",
    "end": "1771530"
  },
  {
    "text": "varies so varies at least beliefs and bits but other than that you don't find",
    "start": "1771530",
    "end": "1777800"
  },
  {
    "text": "a lot of medications we have no you have no I saw you buy executables it's",
    "start": "1777800",
    "end": "1784010"
  },
  {
    "text": "possible to have a canary canary spin talented but we haven't really seen them on the s6 s7 NS",
    "start": "1784010",
    "end": "1791210"
  },
  {
    "text": "and it's starting to be used a lot more on the s9 but before well not that much so that means that if you have a",
    "start": "1791210",
    "end": "1797870"
  },
  {
    "text": "vulnerability it's going to be pretty simple to exploit it alright so first",
    "start": "1797870",
    "end": "1803180"
  },
  {
    "text": "thing what we're going to do is to find vulnerability intercept application so the vulnerability but we have found is",
    "start": "1803180",
    "end": "1809210"
  },
  {
    "start": "1806000",
    "end": "1830000"
  },
  {
    "text": "in the trusted that is called SVM so we have no idea what this trust does and we think that we know is that it has a",
    "start": "1809210",
    "end": "1814850"
  },
  {
    "text": "common a buffer overflow in v common angular and this buffer overflow is due",
    "start": "1814850",
    "end": "1820460"
  },
  {
    "text": "to LEM copy with a user control sighs a user control sauce and it's going to",
    "start": "1820460",
    "end": "1826640"
  },
  {
    "text": "copy it directly into the stack so we have a textbook buffer overflow now we're exploit this with generating",
    "start": "1826640",
    "end": "1833720"
  },
  {
    "text": "you know we are able to execute code in sol 0 and now we are able to communicate with secure drivers we are also able to",
    "start": "1833720",
    "end": "1841100"
  },
  {
    "text": "make some Cisco's but the cisco vato available to trust all the caches are not that useful and we haven't found anything interesting in",
    "start": "1841100",
    "end": "1847610"
  },
  {
    "text": "that so our next target will be a secret drivers so the narrative that you have",
    "start": "1847610",
    "end": "1853830"
  },
  {
    "text": "found is again a buffer overflow in the valley that's a very danger signal",
    "start": "1853830",
    "end": "1859830"
  },
  {
    "text": "driver again we have no idea what this driver dots but has powerful flow into",
    "start": "1859830",
    "end": "1866039"
  },
  {
    "text": "15th come on Donder and it's the same dynamic as before so we have a user control size",
    "start": "1866039",
    "end": "1871940"
  },
  {
    "text": "user control source and copy it copies it directly into the stack so now we if",
    "start": "1871940",
    "end": "1879929"
  },
  {
    "start": "1877000",
    "end": "1908000"
  },
  {
    "text": "we explain with everything we have called execution in SVSU but with higher privileges and now we are able to",
    "start": "1879929",
    "end": "1886649"
  },
  {
    "text": "communicate we've bought young but also we have access to more Cisco's and this is really interesting because the Cisco box",
    "start": "1886649",
    "end": "1892710"
  },
  {
    "text": "we have access to or perform very sensitive operations for example we are able to map physical memory we also",
    "start": "1892710",
    "end": "1899519"
  },
  {
    "text": "create slides we are able to make sense ease so very interesting stuff right now",
    "start": "1899519",
    "end": "1905159"
  },
  {
    "text": "our next target will be the trusted ways and the monitor so as I said we are going to use the Cisco to exploit that",
    "start": "1905159",
    "end": "1911220"
  },
  {
    "start": "1908000",
    "end": "1992000"
  },
  {
    "text": "and the Cisco we are going to use is a map a map is can be used to map the",
    "start": "1911220",
    "end": "1919320"
  },
  {
    "text": "physical memory in secure and non-secure States and the Phenom it is that there",
    "start": "1919320",
    "end": "1926009"
  },
  {
    "text": "is no restriction on what you can map with a map and sober monitor is going to",
    "start": "1926009",
    "end": "1931349"
  },
  {
    "text": "be mapped at the other as twenty twenty two thousand so we map it into our secure driver we modify it to hijack the",
    "start": "1931349",
    "end": "1939539"
  },
  {
    "text": "SMC and then we just execute the SMC from the second driver and this reality",
    "start": "1939539",
    "end": "1947009"
  },
  {
    "text": "has been patched in the newest version of the of Samsung's resume I mean in DB",
    "start": "1947009",
    "end": "1953609"
  },
  {
    "text": "by using a black fist so now you cannot just map anything you want but the",
    "start": "1953609",
    "end": "1960929"
  },
  {
    "text": "reality on all the devices what you can do is to have co-decision in a3 and here's a quick example I'm executing the",
    "start": "1960929",
    "end": "1968519"
  },
  {
    "text": "exploit right here looking at the value insurance yeah so the current exception",
    "start": "1968519",
    "end": "1973590"
  },
  {
    "text": "level and it's going to read to return the value see but since current L as",
    "start": "1973590",
    "end": "1979640"
  },
  {
    "text": "as its value shifted by two bits what we do is but we shifted back on the right by two bits and you obtain three",
    "start": "1979640",
    "end": "1985860"
  },
  {
    "text": "meaning that we have code execution in year free so we have a pretty much compromised the entire system so now",
    "start": "1985860",
    "end": "1994490"
  },
  {
    "start": "1992000",
    "end": "2070000"
  },
  {
    "text": "these are prepping our now what can we do a fun of it our first",
    "start": "1994490",
    "end": "2000770"
  },
  {
    "text": "thing we did is to you added up a framework that would allow us to exploit the vulnerabilities easier more easily",
    "start": "2000770",
    "end": "2007940"
  },
  {
    "text": "and also to to to to to create tools based on this frame a framework and I'm",
    "start": "2007940",
    "end": "2015980"
  },
  {
    "text": "not going to go into the details you know but the idea is that you the arch",
    "start": "2015980",
    "end": "2026330"
  },
  {
    "text": "I'm going to go into details view so right now we're going to use the Year friggin ability to have an apple tree",
    "start": "2026330",
    "end": "2032750"
  },
  {
    "text": "access to it so what it means that in l3 we are going to take the physical address of can you be map it into a page",
    "start": "2032750",
    "end": "2040700"
  },
  {
    "text": "table from tree MMU and now we can access can be from the l3 and from there",
    "start": "2040700",
    "end": "2048860"
  },
  {
    "text": "we are able to add our API function and SBC to execute code in sl1 natively and",
    "start": "2048860",
    "end": "2057139"
  },
  {
    "text": "so I began with this framework what we are able to do is to read and write",
    "start": "2057140",
    "end": "2062149"
  },
  {
    "text": "memory arbitrarily and also to execute code in SEL one and a free pretty easily",
    "start": "2062150",
    "end": "2070840"
  },
  {
    "start": "2070000",
    "end": "2202000"
  },
  {
    "text": "all right so the first demo I'm going to talk about is finding the master key in",
    "start": "2070840",
    "end": "2075919"
  },
  {
    "text": "the monitor so the master key is used in cryptographic operations to find it",
    "start": "2075920",
    "end": "2083419"
  },
  {
    "text": "you have you can reduce what it is that",
    "start": "2083420",
    "end": "2089030"
  },
  {
    "text": "I reverse engineer of the crypto driver that's called your crypto you can find this Chris sacred driver embedded",
    "start": "2089030",
    "end": "2094820"
  },
  {
    "text": "directly in Psych a B and one is doing a cryptographic operation this driver will",
    "start": "2094820",
    "end": "2102020"
  },
  {
    "text": "make a call to the or API it's Rick's 10:30 so you don't know the exact name but this G our API can take four",
    "start": "2102020",
    "end": "2110900"
  },
  {
    "text": "possible current ideas cerise a a a B AC and AD the one is interesting here and the one that can",
    "start": "2110900",
    "end": "2117310"
  },
  {
    "text": "give us the master key is Eric's baby and this the API",
    "start": "2117310",
    "end": "2124010"
  },
  {
    "text": "we'll make a call we'll make a call to a SBC and this as we see is actually",
    "start": "2124010",
    "end": "2129860"
  },
  {
    "text": "wrapper around the SMC 0x b200 sulphide and so right now we have two ways to",
    "start": "2129860",
    "end": "2137600"
  },
  {
    "text": "retrieve the master key so we can even either directly call mr. tariiji our API",
    "start": "2137600",
    "end": "2143270"
  },
  {
    "text": "it's Rick's 10:30 with the correct power arguments or we can directly read the",
    "start": "2143270",
    "end": "2149090"
  },
  {
    "text": "value in the l3 and I'm going to do both here but first let's take a look at the add virtual function so what is",
    "start": "2149090",
    "end": "2157810"
  },
  {
    "text": "interesting here the only thing that is important right here is that here you have the comparison with the value a B",
    "start": "2157810",
    "end": "2163880"
  },
  {
    "text": "meaning that you're going to go in this basic block and in this basic block you have a SMC call to Vassar xB to zero",
    "start": "2163880",
    "end": "2171650"
  },
  {
    "text": "zero five SMC and if we go to the angular of this snc you have so you just",
    "start": "2171650",
    "end": "2182960"
  },
  {
    "text": "have to follow along with the different arguments that one but the really important part here is that in this",
    "start": "2182960",
    "end": "2188590"
  },
  {
    "text": "basic block you have the value you have zero X 10 bytes that are going to be",
    "start": "2188590",
    "end": "2194300"
  },
  {
    "text": "extracted from the address 0 X 10 1e 4000 and this is where the master key is",
    "start": "2194300",
    "end": "2201140"
  },
  {
    "text": "actually stopped and so what we can do is to read it using our framework so our",
    "start": "2201140",
    "end": "2207890"
  },
  {
    "start": "2202000",
    "end": "2241000"
  },
  {
    "text": "human just holding a novel driver to make the exploit work and then I exploit their shoulder mobility and here I'm",
    "start": "2207890",
    "end": "2215420"
  },
  {
    "text": "going to retrieve the master key using the D or API so let's just to make sure that I'm actually retrieving the the",
    "start": "2215420",
    "end": "2220610"
  },
  {
    "text": "correct value afterwards so it's a 1985 F etcetera and if we read directly this",
    "start": "2220610",
    "end": "2227090"
  },
  {
    "text": "value in el3 so at the address Zurich's 10 1 e 4000 we can see right here but we are rigidly",
    "start": "2227090",
    "end": "2234440"
  },
  {
    "text": "the same value meaning that we can have access to anything you want in the l3",
    "start": "2234440",
    "end": "2241330"
  },
  {
    "start": "2241000",
    "end": "2350000"
  },
  {
    "text": "alright so the second demonstration is going to be to bypass sing two checks one of the interesting thing",
    "start": "2241330",
    "end": "2249110"
  },
  {
    "text": "that we wanted to do is to be able to load our own trusted applications our own secret drivers because it's really",
    "start": "2249110",
    "end": "2255800"
  },
  {
    "text": "useful when you want to execute arbitrary code in the second world but to do that we needed to be able to to",
    "start": "2255800",
    "end": "2263390"
  },
  {
    "text": "load this trust because we didn't have trust on the private keys so we were not",
    "start": "2263390",
    "end": "2268430"
  },
  {
    "text": "able to sign them correctly but since we have all the capabilities we want in the",
    "start": "2268430",
    "end": "2274850"
  },
  {
    "text": "second one we can do anything we want then you can just bypass these checks so trusted application the sacred rivals",
    "start": "2274850",
    "end": "2281540"
  },
  {
    "text": "are going to be loaded by RTM and the signature is verified using TLA p.i",
    "start": "2281540",
    "end": "2288680"
  },
  {
    "text": "signature verify and there are only two codes to this function in our TM rosaldo",
    "start": "2288680",
    "end": "2293720"
  },
  {
    "text": "call it's not really important but the idea is that we're going to patch the",
    "start": "2293720",
    "end": "2301210"
  },
  {
    "text": "instructions that are checking the value returned by by this function and here",
    "start": "2301750",
    "end": "2309470"
  },
  {
    "text": "I'm going to try its load so again I'm the vunerable driver and when I'm trying",
    "start": "2309470",
    "end": "2314630"
  },
  {
    "text": "to load a fatal sense so factors that I've made from scratch and if I try to",
    "start": "2314630",
    "end": "2320660"
  },
  {
    "text": "load it it's going to set error invalid operation which is normal but now I'm",
    "start": "2320660",
    "end": "2326570"
  },
  {
    "text": "going to exploit the gravity and bypass these checks and now if I try to reload",
    "start": "2326570",
    "end": "2334040"
  },
  {
    "text": "this fake trusted again now it's going to work and we are able to go our own",
    "start": "2334040",
    "end": "2340990"
  },
  {
    "text": "justification in the sake of all and here you can see that we have different drugs but I printed the cetera meaning",
    "start": "2340990",
    "end": "2347150"
  },
  {
    "text": "that it works all right so the last demonstration I wanted to show you is an",
    "start": "2347150",
    "end": "2353600"
  },
  {
    "start": "2350000",
    "end": "2437000"
  },
  {
    "text": "instrumentation of trusted waste so this is a really important result for us to",
    "start": "2353600",
    "end": "2359480"
  },
  {
    "text": "be able to do that because at this point we are we are no debugging capabilities everything what we have done it was done",
    "start": "2359480",
    "end": "2366710"
  },
  {
    "text": "statically or using the emulator but by using address our our framework",
    "start": "2366710",
    "end": "2373310"
  },
  {
    "text": "we were able to develop a debugger what's this some kind of debugger because we can",
    "start": "2373310",
    "end": "2379420"
  },
  {
    "text": "puts actual breakpoints on instructions otherwise it's going to trigger a watchdog and this end of phone will",
    "start": "2379420",
    "end": "2385539"
  },
  {
    "text": "reboot so what we do is were three instruments of trusted OS by replacing",
    "start": "2385539",
    "end": "2390910"
  },
  {
    "text": "the instruction but we want two instruments by an undefined instruction and then we hijack the exception the in",
    "start": "2390910",
    "end": "2401170"
  },
  {
    "text": "undefined instruction exception and run where we're going to write our own code and what's going to happen is that when",
    "start": "2401170",
    "end": "2407619"
  },
  {
    "text": "the trust said OS run execute our undefined instruction it's going to",
    "start": "2407619",
    "end": "2412779"
  },
  {
    "text": "trigger the undefined instruction exception and then run our own code and for a moment this the code that we are",
    "start": "2412779",
    "end": "2419260"
  },
  {
    "text": "running in the in this andr is to save the current context of the CPU and then",
    "start": "2419260",
    "end": "2425170"
  },
  {
    "text": "we we just execute the instruction that we have replaced and the system just",
    "start": "2425170",
    "end": "2432730"
  },
  {
    "text": "executes normally after that so here are",
    "start": "2432730",
    "end": "2439359"
  },
  {
    "start": "2437000",
    "end": "2597000"
  },
  {
    "text": "the results I'm going to a connect to the phone launching my debugger and so",
    "start": "2439359",
    "end": "2445809"
  },
  {
    "text": "the debugger is just a simple it's just a simple Python promise so first thing",
    "start": "2445809",
    "end": "2454420"
  },
  {
    "text": "I'm going to do is to add breakpoints in a map so this is arbitrary just taken an SVC and I've put a breakpoint inside it",
    "start": "2454420",
    "end": "2461619"
  },
  {
    "text": "and if I deserve all the instructions at",
    "start": "2461619",
    "end": "2467170"
  },
  {
    "text": "this address you can see that we have the UDF with zero so this is our",
    "start": "2467170",
    "end": "2473440"
  },
  {
    "text": "undefined instruction the value afterwards you can do pretty much",
    "start": "2473440",
    "end": "2479319"
  },
  {
    "text": "anything you want but personally were you I mean I'm using it to to to improve",
    "start": "2479319",
    "end": "2486069"
  },
  {
    "text": "the number of the breakpoints and right now I'm going to make a call to with SVC",
    "start": "2486069",
    "end": "2492039"
  },
  {
    "text": "so from a debugger and I don't know if you can see it but the argument of the",
    "start": "2492039",
    "end": "2500109"
  },
  {
    "text": "debugger is going to be the number of the cisco services 7 4 m up then you have the the permissions of the the page",
    "start": "2500109",
    "end": "2507609"
  },
  {
    "text": "you want huge map when you have a starting address in the virtual address",
    "start": "2507609",
    "end": "2512740"
  },
  {
    "text": "space so the address space of the debugger why you want to map your physical memory the end of virtual address and finally your",
    "start": "2512740",
    "end": "2519880"
  },
  {
    "text": "physical address that you want to map and in that case is going to be the first page of the second monitor and so",
    "start": "2519880",
    "end": "2528220"
  },
  {
    "text": "I've indicated my mine Cisco and now if I display the logs of the debugger so",
    "start": "2528220",
    "end": "2537040"
  },
  {
    "text": "I've stripped a strip to the rest of the results of our more close to yes I see",
    "start": "2537040",
    "end": "2542620"
  },
  {
    "text": "the SVC but I made between starting at the debugger and and my my own call to",
    "start": "2542620",
    "end": "2550570"
  },
  {
    "text": "em up but here is the results of my own call and you can see that I have access",
    "start": "2550570",
    "end": "2557290"
  },
  {
    "text": "to U of a state of the CPU and here you have all one which is your X 100,000 so",
    "start": "2557290",
    "end": "2562870"
  },
  {
    "text": "my start virtual address in or - I am the response hundred one thousand my end",
    "start": "2562870",
    "end": "2568990"
  },
  {
    "text": "it will address in all three I have my permissions and in awful I have the physical address that I wanted to map",
    "start": "2568990",
    "end": "2575830"
  },
  {
    "text": "and so this is really interesting to us because now we are able to debug the",
    "start": "2575830",
    "end": "2581830"
  },
  {
    "text": "trusted OS and it would be really useful to find other vulnerabilities in in a",
    "start": "2581830",
    "end": "2588000"
  },
  {
    "text": "Samsung stressor all right so that's that's it for me thank you very much",
    "start": "2588000",
    "end": "2594370"
  },
  {
    "text": "[Applause]",
    "start": "2594370",
    "end": "2599150"
  }
]