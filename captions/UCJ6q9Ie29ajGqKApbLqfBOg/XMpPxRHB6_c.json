[
  {
    "start": "0",
    "end": "81000"
  },
  {
    "text": "so my name is Ben Surrey I'm the VP of research at Armas and today with me I",
    "start": "30",
    "end": "5670"
  },
  {
    "text": "have a doors Iseman he's a researcher my team Varmus is an agent agent society",
    "start": "5670",
    "end": "12840"
  },
  {
    "text": "security company which is focused on security IRT devices and many many devices in general specifically in",
    "start": "12840",
    "end": "19980"
  },
  {
    "text": "enterprise organizations part of the goal of our company is to better understand the threat landscape that IOT",
    "start": "19980",
    "end": "25529"
  },
  {
    "text": "devices and wireless protocols in general pose on the security of an enterprise network so part of this cause",
    "start": "25529",
    "end": "32300"
  },
  {
    "text": "came and led us to this research and it",
    "start": "32300",
    "end": "37530"
  },
  {
    "text": "started by understanding that there is a recent trend in which Enterprise great access points actually embed in them in",
    "start": "37530",
    "end": "45120"
  },
  {
    "text": "addition a radio chip abby lee able to flow energy chip and this additional",
    "start": "45120",
    "end": "51239"
  },
  {
    "text": "chip is there to have new features for access points but we also naturally",
    "start": "51239",
    "end": "57899"
  },
  {
    "text": "introduces a new threat landscape it opens the possibility of a network",
    "start": "57899",
    "end": "63000"
  },
  {
    "text": "bridge coming from a ble connection and in fact in the process of this research",
    "start": "63000",
    "end": "68460"
  },
  {
    "text": "we thought we found two zero day vulnerabilities affecting TI billy chips",
    "start": "68460",
    "end": "74340"
  },
  {
    "text": "that are used by Aruba Meraki and Cisco access points and so what is our agenda",
    "start": "74340",
    "end": "82530"
  },
  {
    "start": "81000",
    "end": "188000"
  },
  {
    "text": "for today it's it's quite packed so I hope we've managed to get to everything",
    "start": "82530",
    "end": "89570"
  },
  {
    "text": "but initially I'm going to talk about Billy in general where is it used why is",
    "start": "89570",
    "end": "96299"
  },
  {
    "text": "it used how is it being adopted in different verticals in the environment and then",
    "start": "96299",
    "end": "103490"
  },
  {
    "text": "specifically on access points why is it using the access points what are the features that are embedded in access",
    "start": "103490",
    "end": "109860"
  },
  {
    "text": "points for triggering lvd functionalities then I'm going to talk",
    "start": "109860",
    "end": "116549"
  },
  {
    "text": "about over-the-air firmware upgrades for ble chips so what are the mechanism is",
    "start": "116549",
    "end": "123329"
  },
  {
    "text": "for allow OTA upgrades really chips are they secure",
    "start": "123329",
    "end": "128489"
  },
  {
    "text": "when are they secure and so forth and then we're going to the two of all about vulnerabilities",
    "start": "128489",
    "end": "134220"
  },
  {
    "text": "that I mentioned the first is if ability that affects every back this points there really shimmer in the beauty chip",
    "start": "134220",
    "end": "143100"
  },
  {
    "text": "that's using interact-as points and then I'm going to talk about second vulnerability which is gonna be latina",
    "start": "143100",
    "end": "150030"
  },
  {
    "text": "TI's Texas in France merely stack but is used in many of their whaling ships and",
    "start": "150030",
    "end": "157710"
  },
  {
    "text": "this is an RC vulnerability I think maybe as far as I know first mobility found in a melee",
    "start": "157710",
    "end": "165660"
  },
  {
    "text": "controller or Bluetooth controller level right so really close to the hardware level and indoor talking extensively",
    "start": "165660",
    "end": "174360"
  },
  {
    "text": "about how we exploited this vulnerability on a Cisco access point",
    "start": "174360",
    "end": "179490"
  },
  {
    "text": "and in general impact of this on networks and the security of really so",
    "start": "179490",
    "end": "189870"
  },
  {
    "start": "188000",
    "end": "260000"
  },
  {
    "text": "to begin to begin just a bit about bluetooth or energy why why is it used",
    "start": "189870",
    "end": "195690"
  },
  {
    "text": "what is the benefits of having Bluetooth Low Energy and different environments",
    "start": "195690",
    "end": "200700"
  },
  {
    "text": "different verticals so Bluetooth Low Energy is kind of on the cool new kid around the block when you look at a",
    "start": "200700",
    "end": "206610"
  },
  {
    "text": "little sparkle in general it's been around a few years but it's really not",
    "start": "206610",
    "end": "212370"
  },
  {
    "text": "adopted very fast by many industries there are good causes for this it is the",
    "start": "212370",
    "end": "219959"
  },
  {
    "text": "newer version of bluetooth so it doesn't have many of old generation code that",
    "start": "219959",
    "end": "228900"
  },
  {
    "text": "was involved in Bluetooth so it's much cleaner and it's also lower energy right",
    "start": "228900",
    "end": "235200"
  },
  {
    "text": "so there was a lot of applications that can benefit from being lower energy and",
    "start": "235200",
    "end": "240239"
  },
  {
    "text": "it is being used in many vehicles like I mentioned it's using the healthcare devices medical devices in healthcare",
    "start": "240239",
    "end": "247220"
  },
  {
    "text": "systems in general in manufacturing warehouses and facilities in retail and",
    "start": "247220",
    "end": "253830"
  },
  {
    "text": "in general IOT devices that are if you can find throughout officers",
    "start": "253830",
    "end": "260090"
  },
  {
    "start": "260000",
    "end": "404000"
  },
  {
    "text": "but why really is it used in access points what is the use case they're so",
    "start": "260270",
    "end": "265950"
  },
  {
    "text": "access points had the advantage of already being deployed throughout many",
    "start": "265950",
    "end": "270960"
  },
  {
    "text": "organizations right there are the backbone to serving Wi-Fi to the entire organization so they're already the",
    "start": "270960",
    "end": "278340"
  },
  {
    "text": "infrastructure is already there so any application that you really can benefit from the fact that an access point can",
    "start": "278340",
    "end": "285330"
  },
  {
    "text": "be part of that application since it's already deployed in the organization and in fact there are many different",
    "start": "285330",
    "end": "292830"
  },
  {
    "text": "applications that take in versions of this ability you have indoor navigation systems for example you want to do",
    "start": "292830",
    "end": "299790"
  },
  {
    "text": "navigations inside closed building and so that's points we sent out beacons",
    "start": "299790",
    "end": "305720"
  },
  {
    "text": "which can help implement internal vacation systems you can also see the",
    "start": "305720",
    "end": "311420"
  },
  {
    "text": "medical asset tracking applications or other asset tracking applications where",
    "start": "311420",
    "end": "316620"
  },
  {
    "text": "you want to track devices their location and so you put a beacon on on the",
    "start": "316620",
    "end": "322650"
  },
  {
    "text": "devices on the track and the access points will track these weekends retails also use belief or a customer tracking",
    "start": "322650",
    "end": "330870"
  },
  {
    "text": "or what you also look at as spying on their customers and in some sense but",
    "start": "330870",
    "end": "338190"
  },
  {
    "text": "this allows them to engage with customers right and to know some specific person entered the shopping",
    "start": "338190",
    "end": "345390"
  },
  {
    "text": "mall or something and now we can show him a specific advertisement or something and then you have the last a",
    "start": "345390",
    "end": "351360"
  },
  {
    "text": "use case that's getting traction also innovation here is the use of smart sensors mainly in manufacturing but",
    "start": "351360",
    "end": "359250"
  },
  {
    "text": "others as well the sensors will send out the read over ble beacons and at this",
    "start": "359250",
    "end": "365550"
  },
  {
    "text": "point can serve as gateways to those beacons that are connecting them to which loud order or the Internet in",
    "start": "365550",
    "end": "371790"
  },
  {
    "text": "general but really when we looked at the availability is found in these devices",
    "start": "371790",
    "end": "379200"
  },
  {
    "text": "in these chips and their effect on practice points in or networks through",
    "start": "379200",
    "end": "384230"
  },
  {
    "text": "that ability is our impact was similar",
    "start": "384230",
    "end": "389880"
  },
  {
    "text": "to the Internet's impact once we really sorry why I really do you need Billy in access",
    "start": "389880",
    "end": "395320"
  },
  {
    "text": "points and like one person voting staff dot obviously it is there to increase",
    "start": "395320",
    "end": "400690"
  },
  {
    "text": "the tax service so as I mentioned our",
    "start": "400690",
    "end": "406360"
  },
  {
    "start": "404000",
    "end": "525000"
  },
  {
    "text": "two vulnerabilities we found and we're going to discuss today Billy stack has different layers and different functions",
    "start": "406360",
    "end": "413800"
  },
  {
    "text": "to in the layers in the eyes tips we're going to talk about most of these errors",
    "start": "413800",
    "end": "419170"
  },
  {
    "text": "are embedded inside the inside one chip it's a system on chip so it has it",
    "start": "419170",
    "end": "424630"
  },
  {
    "text": "embedded all of these layers inside the chip but it can also be split between a couple of different processors it's much",
    "start": "424630",
    "end": "432490"
  },
  {
    "text": "simpler than the classic Bluetooth it's not so many parts but essentially you have inter controller layer you have a",
    "start": "432490",
    "end": "439420"
  },
  {
    "text": "physical layer you have the link layer that does most of the basic functionalities lowly functionalities",
    "start": "439420",
    "end": "446530"
  },
  {
    "text": "for the protocol in clear we also found one wall ability as I",
    "start": "446530",
    "end": "452740"
  },
  {
    "text": "mentioned that affects Billy stacks in ki chips and this ships are already also",
    "start": "452740",
    "end": "458800"
  },
  {
    "text": "used by Cisco and Oracle access points so they affect these but we can also affect other devices right because it's",
    "start": "458800",
    "end": "465730"
  },
  {
    "text": "a really stack availability in these chips any device that uses these chips",
    "start": "465730",
    "end": "471310"
  },
  {
    "text": "in the vulnerable state will be affected by this one ability so it's it has a potential to affect many devices when",
    "start": "471310",
    "end": "477520"
  },
  {
    "text": "you continue up the stack you have all these parts that are in the host layer",
    "start": "477520",
    "end": "483430"
  },
  {
    "text": "and they are they were function is more high-level they create creating",
    "start": "483430",
    "end": "488470"
  },
  {
    "text": "connections listening for connections you have this specific part is called",
    "start": "488470",
    "end": "494050"
  },
  {
    "text": "gat which is the most simple way to transform transferred a data over mealy",
    "start": "494050",
    "end": "499810"
  },
  {
    "text": "it's like a REST API you may like for Billy so it allows you really a simple way to",
    "start": "499810",
    "end": "506620"
  },
  {
    "text": "transfer data and on top of that you have a specific application and that will obviously change between one device",
    "start": "506620",
    "end": "512650"
  },
  {
    "text": "in another what is let's use case of baby and in this there we found the one",
    "start": "512650",
    "end": "518169"
  },
  {
    "text": "ability that effects Aruba which I'm going to talk about now",
    "start": "518169",
    "end": "523710"
  },
  {
    "text": "so when you look at over there are solutions for a few more upgrades in Billy chips so these chips are",
    "start": "526180",
    "end": "534440"
  },
  {
    "text": "standalone device right you don't have any other communication channel other than melee they are not connected to the",
    "start": "534440",
    "end": "540950"
  },
  {
    "text": "internet they are standalone you can find them in IOT devices or even in access points where they're alongside",
    "start": "540950",
    "end": "548030"
  },
  {
    "text": "another processor and so they need to find a way to neutralize over there or",
    "start": "548030",
    "end": "554300"
  },
  {
    "text": "verbally and so we we wanted to see what are the challenges in these solutions",
    "start": "554300",
    "end": "559490"
  },
  {
    "text": "there are two major vendors that do ble chips standalone system of chips",
    "start": "559490",
    "end": "565330"
  },
  {
    "text": "Texas Instruments and Nordic semiconductors there are others but just for the ease of for this let's consider",
    "start": "565330",
    "end": "572900"
  },
  {
    "text": "these two and they have each separate framework for doing okay upgrades Texas",
    "start": "572900",
    "end": "581060"
  },
  {
    "text": "Instruments has OAD over-the-air download and nordic has the fu device",
    "start": "581060",
    "end": "586400"
  },
  {
    "text": "firmware upgrade so the challenges in securing these solutions these frameworks are obvious right you need to",
    "start": "586400",
    "end": "594560"
  },
  {
    "text": "find a way to transfer the fumer over biele in a secure manner so it can't be",
    "start": "594560",
    "end": "600350"
  },
  {
    "text": "captured really has encryption but in order to use that Egyptian the best way",
    "start": "600350",
    "end": "605900"
  },
  {
    "text": "to do so is to create a bond a baby bond which is the equivalent of bluetooth caring and so that's another challenge",
    "start": "605900",
    "end": "614780"
  },
  {
    "text": "we want these connections to be offer a bonded baby connection and then you want to use authentication that's also",
    "start": "614780",
    "end": "621650"
  },
  {
    "text": "connect connected to the fact you have you've done a billabong trial so is the",
    "start": "621650",
    "end": "628580"
  },
  {
    "text": "connection of antiquated can you validate who is doing the firmware upgrade and lastly but most importantly",
    "start": "628580",
    "end": "634520"
  },
  {
    "text": "you want to validate the integrity of the femurs that is being uploaded with a signature or in other means you want to",
    "start": "634520",
    "end": "641450"
  },
  {
    "text": "validate the shimmer is may be trustworthy I think practice these frameworks exist",
    "start": "641450",
    "end": "649139"
  },
  {
    "text": "for a few years but not so many the recent versions are more secure but the",
    "start": "649139",
    "end": "654209"
  },
  {
    "text": "ones that are used today in market that secure or not secure at all the funeral",
    "start": "654209",
    "end": "660360"
  },
  {
    "text": "encrypt order of the error the add connections is not offended again this is by judicial configuration each",
    "start": "660360",
    "end": "666959"
  },
  {
    "text": "application can change this but but by default it's not educated and the",
    "start": "666959",
    "end": "672360"
  },
  {
    "text": "funeral is not validated or if it is validated it uses a week before signature that can be abused so when we",
    "start": "672360",
    "end": "682199"
  },
  {
    "start": "681000",
    "end": "732000"
  },
  {
    "text": "looked in Aruba at this point we wanted to understand what is the attack surface here and so the first thing we did is we",
    "start": "682199",
    "end": "689160"
  },
  {
    "text": "tried to connect to get when the Aruba is in weakening mode so we and at this",
    "start": "689160",
    "end": "695610"
  },
  {
    "text": "point has a different mode when it's using the BD functionalities but the",
    "start": "695610",
    "end": "701250"
  },
  {
    "text": "most basic one is using a beginning mode it just sends out specific unique identifier over advertising packets but",
    "start": "701250",
    "end": "708089"
  },
  {
    "text": "to our surprise even in that mode the gas was still open and we can connect to",
    "start": "708089",
    "end": "713190"
  },
  {
    "text": "it and see the services that this device exposes more interesting was the",
    "start": "713190",
    "end": "720029"
  },
  {
    "text": "specific unique identifier which is CI is a ID service so it seems there is",
    "start": "720029",
    "end": "726240"
  },
  {
    "text": "just maybe the ability to upload from you to this beauty tip over Oh Edie a",
    "start": "726240",
    "end": "731870"
  },
  {
    "text": "bit about oh it in general just to understand the mechanics of it it's",
    "start": "731870",
    "end": "738209"
  },
  {
    "text": "pretty simple you have a user there is a device you want to upload it if you were",
    "start": "738209",
    "end": "743339"
  },
  {
    "text": "to it the first thing is initiating a gas connection and then you can send an immediate identify message simple",
    "start": "743339",
    "end": "750690"
  },
  {
    "text": "message with similar header in it and if that's where is in the correct version",
    "start": "750690",
    "end": "756269"
  },
  {
    "text": "or something something pretty simple the device will acknowledge it by sending image block request which will then",
    "start": "756269",
    "end": "763319"
  },
  {
    "text": "follow an image block message sent from the user to device containing a chunk of the femur and this will continue this",
    "start": "763319",
    "end": "770639"
  },
  {
    "text": "process design new chunks of the femur will be in a loop until all chunks have been sent at which point the device will",
    "start": "770639",
    "end": "777000"
  },
  {
    "text": "reboot into the new camera so very straightforward so naturally we tried",
    "start": "777000",
    "end": "782540"
  },
  {
    "text": "just uploading our femur over OED today we'll back this point and it didn't",
    "start": "782540",
    "end": "787880"
  },
  {
    "text": "really work we initiated a got connection we sent an image identified but no response always received so",
    "start": "787880",
    "end": "793430"
  },
  {
    "text": "something was customized by implementation and we wanted to find out find out what so the logical next step",
    "start": "793430",
    "end": "800240"
  },
  {
    "text": "let's open the stop let's hook up the debugger and dump the fumarole and in",
    "start": "800240",
    "end": "807800"
  },
  {
    "start": "806000",
    "end": "909000"
  },
  {
    "text": "fact when looking at this function that does the functionalities in the",
    "start": "807800",
    "end": "813200"
  },
  {
    "text": "framework we noticed there is an additional call to mem compare yeah so may be added like I mentioned something",
    "start": "813200",
    "end": "819680"
  },
  {
    "text": "custom that validates you know it in some sense when you look at the eyes",
    "start": "819680",
    "end": "825980"
  },
  {
    "text": "away the function this function receives any gap right request and then",
    "start": "825980",
    "end": "833360"
  },
  {
    "text": "dispatches them to specific functions so it's very simple you compare the unique",
    "start": "833360",
    "end": "839930"
  },
  {
    "text": "identifier is being being waiting right now to the image identifies new D and if",
    "start": "839930",
    "end": "846290"
  },
  {
    "text": "it is so you you can call the function that handles that that message and if if",
    "start": "846290",
    "end": "853850"
  },
  {
    "text": "you find it to be equal to another value for the image block method you can call",
    "start": "853850",
    "end": "859700"
  },
  {
    "text": "that function lets handle that message so it's very straightforward in a robust",
    "start": "859700",
    "end": "865459"
  },
  {
    "text": "implementation like I said we found that there is an additional code here and zooming in on the main comparison that I",
    "start": "865459",
    "end": "872560"
  },
  {
    "text": "talked about before there is just two more men compares or three more memo",
    "start": "872560",
    "end": "877970"
  },
  {
    "text": "compares here that validate another unique identifier and if you write a",
    "start": "877970",
    "end": "884570"
  },
  {
    "text": "specific unique identifier of the OED unlock team with a specific value with",
    "start": "884570",
    "end": "891290"
  },
  {
    "text": "oh it cooking then that unlocks the specific global state is already",
    "start": "891290",
    "end": "896300"
  },
  {
    "text": "unlocked and if you do this with another value that unlocks another state this is",
    "start": "896300",
    "end": "904160"
  },
  {
    "text": "some cell record of the function that we were reverse-engineer before so obviously every bad added encourage a",
    "start": "904160",
    "end": "911990"
  },
  {
    "text": "heart or a password to their implementation it is not me out one two three four but it's not a good solution",
    "start": "911990",
    "end": "918860"
  },
  {
    "text": "either way and so really what this is is",
    "start": "918860",
    "end": "926180"
  },
  {
    "text": "the ability to upload famer over be lean on Senate uh no physical connection",
    "start": "926180",
    "end": "931540"
  },
  {
    "text": "using this haircut password and then you can have your own matrix code on this really cheap so what what can an",
    "start": "931540",
    "end": "945260"
  },
  {
    "start": "938000",
    "end": "1066000"
  },
  {
    "text": "attacker do by gaining access to a really cheap in silent access point right is still initially is still",
    "start": "945260",
    "end": "950990"
  },
  {
    "text": "confined to only being affecting this specific chip continue is what is the",
    "start": "950990",
    "end": "958279"
  },
  {
    "text": "next step for him so at this point design is such that Billy chip has",
    "start": "958279",
    "end": "963890"
  },
  {
    "text": "access to to your interfaces zero York interfaces one of them is used for a",
    "start": "963890",
    "end": "971930"
  },
  {
    "text": "configuration of the ble chip form of the main CPU and from Beadie packets",
    "start": "971930",
    "end": "976970"
  },
  {
    "text": "being sent back from the Bailey chip to the main CPU so this interface is one avenue for an attacker to look for",
    "start": "976970",
    "end": "983390"
  },
  {
    "text": "additional vulnerabilities to try and target the main CPU of an at this point but another one exists here that will be",
    "start": "983390",
    "end": "991100"
  },
  {
    "text": "much simpler every access points can be configured to allow a user to connect to",
    "start": "991100",
    "end": "998209"
  },
  {
    "text": "a console to a terminal console over a BD connection so this is the same",
    "start": "998209",
    "end": "1003459"
  },
  {
    "text": "console you get if you can attack serial cable to a network device but this is offered over a BD connection you listed",
    "start": "1003459",
    "end": "1010390"
  },
  {
    "text": "to be useful in some scenarios where there at this point I needs to be configured you know for",
    "start": "1010390",
    "end": "1015610"
  },
  {
    "text": "network configurations it's not physically accessible its way up in the",
    "start": "1015610",
    "end": "1021370"
  },
  {
    "text": "ceiling or something so this feature is implemented by the fact that the UART",
    "start": "1021370",
    "end": "1026890"
  },
  {
    "text": "interface between the console and the main CPU is shared with merely chip so the melee chip may be able to use this",
    "start": "1026890",
    "end": "1034418"
  },
  {
    "text": "interface by an attacker and get access to that shell interface and this interface",
    "start": "1034419",
    "end": "1041630"
  },
  {
    "text": "exposes few commands you can configure the network configurations of an access",
    "start": "1041630",
    "end": "1047819"
  },
  {
    "text": "point you can even send packets within the network it can be password protected but it actually can also be not",
    "start": "1047820",
    "end": "1054840"
  },
  {
    "text": "protected it's not them it must and can also potentially be work force so it's",
    "start": "1054840",
    "end": "1060330"
  },
  {
    "text": "not it's not clear how the security solution so how would an attack with me",
    "start": "1060330",
    "end": "1068340"
  },
  {
    "start": "1066000",
    "end": "1100000"
  },
  {
    "text": "look like how would it be carried out first like I mentioned you can upload",
    "start": "1068340",
    "end": "1075090"
  },
  {
    "text": "the mer-ka-ba chip using the hardware passwords then the attacker can use a",
    "start": "1075090",
    "end": "1081540"
  },
  {
    "text": "few more that gives me access to this console connection although this connection is configurable by the main",
    "start": "1081540",
    "end": "1089250"
  },
  {
    "text": "CPU the ble chip is the one that carries out whether it's on or off so once",
    "start": "1089250",
    "end": "1094770"
  },
  {
    "text": "you're on that chip you can make it access that your interface regardless looking at an entire network here or",
    "start": "1094770",
    "end": "1102720"
  },
  {
    "start": "1100000",
    "end": "1144000"
  },
  {
    "text": "zooming out a bit and at this point will generally have access to multiple segments right I preserve both the",
    "start": "1102720",
    "end": "1109320"
  },
  {
    "text": "corporate network and in the guest network or maybe other segments so gaining access to the main CPU of an",
    "start": "1109320",
    "end": "1115920"
  },
  {
    "text": "access point can potentially lead in a calculus all of these segments if the",
    "start": "1115920",
    "end": "1122130"
  },
  {
    "text": "network is connected to the Internet like many are in fact we can also take advantage of this and create an outbound",
    "start": "1122130",
    "end": "1127500"
  },
  {
    "text": "connection to a C&C server and that at that point he no longer needs to be in",
    "start": "1127500",
    "end": "1133890"
  },
  {
    "text": "vicinity of the device that he's attacking he doesn't need to use really he can create a backdoor over that C&C",
    "start": "1133890",
    "end": "1139470"
  },
  {
    "text": "connection and then the attack and continue over the Internet ok so we",
    "start": "1139470",
    "end": "1145260"
  },
  {
    "text": "wanted to to see how an attack like this will work and because we are also",
    "start": "1145260",
    "end": "1153120"
  },
  {
    "text": "engineers and we like the idea of it we decided to take the attack airborne as",
    "start": "1153120",
    "end": "1158310"
  },
  {
    "text": "you'd see in a minute [Music]",
    "start": "1158310",
    "end": "1169010"
  },
  {
    "start": "1168000",
    "end": "1366000"
  },
  {
    "text": "yeah so our office is in Tel Aviv in a pine",
    "start": "1169010",
    "end": "1175230"
  },
  {
    "text": "floor so we want to see if we can come from the era literally in attack in a",
    "start": "1175230",
    "end": "1181770"
  },
  {
    "text": "row back this point sitting in our office we installed an Ubuntu on an old",
    "start": "1181770",
    "end": "1188370"
  },
  {
    "text": "nex-5 we attached to a drone I'm a hacker for this demonstration in the",
    "start": "1188370",
    "end": "1194340"
  },
  {
    "text": "smartphone is connected with the server connection to a scene server C&C server which the laptop is also connected to so",
    "start": "1194340",
    "end": "1200580"
  },
  {
    "text": "the laptop on the ground controls the smartphone in there so getting to the",
    "start": "1200580",
    "end": "1212930"
  },
  {
    "text": "27th floor was a bit of a challenge and",
    "start": "1212930",
    "end": "1217950"
  },
  {
    "text": "the Maverick didn't really like the added weight but but he managed [Music]",
    "start": "1217950",
    "end": "1229770"
  },
  {
    "text": "[Music] in here on the table is their back this point waiting to be owned okay so once",
    "start": "1232450",
    "end": "1244740"
  },
  {
    "text": "once you're in the drone or the smartphone is nearby you can search for",
    "start": "1244740",
    "end": "1249960"
  },
  {
    "text": "beacons they're about access point using beginning mode right so you can find the market race by that you can see use the",
    "start": "1249960",
    "end": "1256920"
  },
  {
    "text": "gut tool to find the OBD service and then we wrote this small script that",
    "start": "1256920",
    "end": "1262050"
  },
  {
    "text": "just uses the heart or the password we retrieved from the streamer and uploads our own weather system or this is a bit",
    "start": "1262050",
    "end": "1269100"
  },
  {
    "text": "sped up but it takes about a minute to upload a few more so that fumer allows",
    "start": "1269100",
    "end": "1276840"
  },
  {
    "text": "us access unauthenticated to this shell interface so we just use the shell access on the 18 and through this Billie",
    "start": "1276840",
    "end": "1284250"
  },
  {
    "text": "connection we can change network configurations you know if can figure out all of these",
    "start": "1284250",
    "end": "1291030"
  },
  {
    "text": "commands and you can also send packets within the network there is a ping",
    "start": "1291030",
    "end": "1297510"
  },
  {
    "text": "command for that an interesting aspect is that Billy is connected to this",
    "start": "1297510",
    "end": "1303120"
  },
  {
    "text": "console interface even throughout a boot of a reboot of the device so by",
    "start": "1303120",
    "end": "1309540"
  },
  {
    "text": "rebooting the AAP through this interface we can access the bootloader shell over this media connection and change boot",
    "start": "1309540",
    "end": "1316410"
  },
  {
    "text": "parameters maybe potentially even upload like an older version of the entire ap",
    "start": "1316410",
    "end": "1321510"
  },
  {
    "text": "or something as I mentioned if the",
    "start": "1321510",
    "end": "1329190"
  },
  {
    "text": "attacker does achieve code execution on the main CPU he can create an out world connection and then the facility of the",
    "start": "1329190",
    "end": "1335670"
  },
  {
    "text": "drone is no longer needed",
    "start": "1335670",
    "end": "1339170"
  },
  {
    "text": "[Music]",
    "start": "1340870",
    "end": "1344460"
  },
  {
    "text": "[Applause] okay yeah so this is one ability the",
    "start": "1346180",
    "end": "1354770"
  },
  {
    "text": "rubberband is significant but we have more to discuss so this second ability",
    "start": "1354770",
    "end": "1359960"
  },
  {
    "text": "as I mentioned is in T is Billy stack and it effects is kuraki am at this point but potentially other devices and",
    "start": "1359960",
    "end": "1367010"
  },
  {
    "text": "this mobility is in the code that parses beacons parses incoming packets in Billy",
    "start": "1367010",
    "end": "1373160"
  },
  {
    "text": "you have different roles a device can be scanner it's kind of role or an advertiser role and it's simple right",
    "start": "1373160",
    "end": "1380900"
  },
  {
    "text": "when one device would send out beacons through what is called advertising packets and the other will listen to",
    "start": "1380900",
    "end": "1386270"
  },
  {
    "text": "these packets and in parse them as they come in and you have three channels for",
    "start": "1386270",
    "end": "1391790"
  },
  {
    "text": "that are fixed channels for advertising packets on Billy and so the advertiser will send these packets on all of these",
    "start": "1391790",
    "end": "1398330"
  },
  {
    "text": "channels and the scanner will hop between these three between the frequencies and listen to these packets a Billy packet is has a structure that",
    "start": "1398330",
    "end": "1407720"
  },
  {
    "start": "1404000",
    "end": "1424000"
  },
  {
    "text": "is pretty straightforward you have a preamble fixed access address and then a PDU that is different between shape this",
    "start": "1407720",
    "end": "1414260"
  },
  {
    "text": "advertising channel or another channel in advertising channel you have a two bytes header and then 30 up to 37 bytes",
    "start": "1414260",
    "end": "1422630"
  },
  {
    "text": "of payload this two byte header is built up with different flags but there is one",
    "start": "1422630",
    "end": "1430460"
  },
  {
    "start": "1424000",
    "end": "1487000"
  },
  {
    "text": "interesting piece here that I want to mention there is a length field in the",
    "start": "1430460",
    "end": "1437090"
  },
  {
    "text": "header and that actually changed the length field changed between Bluetooth 4.2 in verses 5 with the 5 is now",
    "start": "1437090",
    "end": "1443390"
  },
  {
    "text": "becoming interesting to the market so chips are being designed to use this new",
    "start": "1443390",
    "end": "1449690"
  },
  {
    "text": "protocol and the length field between 4.2 and will size increased from six",
    "start": "1449690",
    "end": "1455240"
  },
  {
    "text": "bits to a bit and in the order of version in 4.20 an additional two bits",
    "start": "1455240",
    "end": "1462500"
  },
  {
    "text": "in that bite reserved for future use are a few bits and they were also always",
    "start": "1462500",
    "end": "1468050"
  },
  {
    "text": "supposed to be 0 bits so this change in the specification might have in",
    "start": "1468050",
    "end": "1473570"
  },
  {
    "text": "retrospect leave it to the variability that we found we're not sure but but this looks",
    "start": "1473570",
    "end": "1479630"
  },
  {
    "text": "ominous right the fact that the length field has changes as a potential for for",
    "start": "1479630",
    "end": "1485600"
  },
  {
    "text": "bugs looking specifically on the architecture of TI is a mealy chip it's",
    "start": "1485600",
    "end": "1493340"
  },
  {
    "start": "1487000",
    "end": "1543000"
  },
  {
    "text": "a it's a part of quite an interesting device you have you have two cores you",
    "start": "1493340",
    "end": "1498410"
  },
  {
    "text": "have the main CPU that's running an arm CPU and this one does most of the logic",
    "start": "1498410",
    "end": "1503690"
  },
  {
    "text": "work most of the Billy stack logic and then you have your radio color that also",
    "start": "1503690",
    "end": "1510740"
  },
  {
    "text": "runs it now scene CPU and that one does the more more physical layer stuff and",
    "start": "1510740",
    "end": "1515930"
  },
  {
    "text": "it really the low-level handling of packets and the link layer is actually",
    "start": "1515930",
    "end": "1521030"
  },
  {
    "text": "split between these two cores and they have a shared interface to exchange the",
    "start": "1521030",
    "end": "1526640"
  },
  {
    "text": "packets that are coming in there are also systems where you have an",
    "start": "1526640",
    "end": "1531950"
  },
  {
    "text": "additional CPU like an access point so the application layer will be split between the Billy chip and the external",
    "start": "1531950",
    "end": "1538160"
  },
  {
    "text": "CPU over some interface other york the face or not or another like many devices",
    "start": "1538160",
    "end": "1545000"
  },
  {
    "text": "and other devices right there there is no inherent security in this chip there",
    "start": "1545000",
    "end": "1550940"
  },
  {
    "text": "is no use of data execution prevention no SLR and no MMU so finding",
    "start": "1550940",
    "end": "1559430"
  },
  {
    "text": "availability here still has the challenge of being able to exploit it like any other one Willa T but the chip",
    "start": "1559430",
    "end": "1566690"
  },
  {
    "text": "itself will not stop availability with inherent mitigations okay looking at",
    "start": "1566690",
    "end": "1572780"
  },
  {
    "text": "this function this is the function that parses advertising packets as they are",
    "start": "1572780",
    "end": "1578660"
  },
  {
    "text": "coming into the chip when it is scanning for advertising packets and it will do",
    "start": "1578660",
    "end": "1584870"
  },
  {
    "text": "some parsing of the tacit in some handling of different types of packets",
    "start": "1584870",
    "end": "1590150"
  },
  {
    "text": "and such I mean instantly we see that there are a few problems in this",
    "start": "1590150",
    "end": "1595220"
  },
  {
    "text": "function the first thing is this handling of the length field that I talked about",
    "start": "1595220",
    "end": "1600430"
  },
  {
    "text": "as I mentioned it's supposed to be six bits but this code here takes the entire eight dates from the header and calls it",
    "start": "1600430",
    "end": "1608150"
  },
  {
    "text": "the pack I didn't interact this is the packet length so it doesn't mask out the RFU meets the reserved bits in the second",
    "start": "1608150",
    "end": "1615769"
  },
  {
    "text": "problem here is the third line on that red box where the code will increase six",
    "start": "1615769",
    "end": "1622549"
  },
  {
    "text": "bytes from the packet length so there's a potential here to do an intro and the",
    "start": "1622549",
    "end": "1628820"
  },
  {
    "text": "data length is actually actually a signed integer in this if case and so if",
    "start": "1628820",
    "end": "1635029"
  },
  {
    "text": "it is a small number if it's minus 1 or minus 2 or something it won't be",
    "start": "1635029",
    "end": "1640100"
  },
  {
    "text": "detected is a large packet but even if it is detected the function that is",
    "start": "1640100",
    "end": "1645590"
  },
  {
    "text": "called the hull of sir handler is actually a null function that does nothing so the code will carry on and",
    "start": "1645590",
    "end": "1652659"
  },
  {
    "text": "there is a copy loop at the end of the function using the packet length pass to it it will copy then tack it onto the",
    "start": "1652659",
    "end": "1660950"
  },
  {
    "text": "advertising data pointer so this is many powerless here in the next step for us",
    "start": "1660950",
    "end": "1667820"
  },
  {
    "text": "is let's try and crash it let's send different packets and see what happens you mentioned there are the length field",
    "start": "1667820",
    "end": "1676309"
  },
  {
    "text": "which is 6 bits but you also have the RFU bits and all the 8 bits together are considered as the length of a packet so",
    "start": "1676309",
    "end": "1682190"
  },
  {
    "text": "we have a couple of parameters to to play with initial step we'll let's send",
    "start": "1682190",
    "end": "1687919"
  },
  {
    "text": "the largest package we can in the 8 bits but if in crash so if something is not as expected right now the next step was",
    "start": "1687919",
    "end": "1695870"
  },
  {
    "text": "write and send a very small packet right maybe we can hit this integer on the flow but this also doesn't crash next",
    "start": "1695870",
    "end": "1703340"
  },
  {
    "text": "thing we thought maybe we can't really touch these bits there are a few bits so let's send the largest package we can",
    "start": "1703340",
    "end": "1709039"
  },
  {
    "text": "within 6 bits if we all also be changing out of bounds but it's also didn't crash",
    "start": "1709039",
    "end": "1715220"
  },
  {
    "text": "the store sanity check we decided a central RS packet we can within the",
    "start": "1715220",
    "end": "1721279"
  },
  {
    "text": "specification limit a 37 by it's packet this limit privacy did reach the code",
    "start": "1721279",
    "end": "1726980"
  },
  {
    "text": "that we were looking looking at so we are partially in the right direction and last let's try and carry on one of the",
    "start": "1726980",
    "end": "1733610"
  },
  {
    "text": "are a few bits but keep the packet at SRI 7 bytes so it is a short packet",
    "start": "1733610",
    "end": "1738769"
  },
  {
    "text": "but it may be be perceived by the code as a large packet which will result in corruption",
    "start": "1738769",
    "end": "1744440"
  },
  {
    "text": "and in fact that did pass the device so we understood there is another mechanism",
    "start": "1744440",
    "end": "1750530"
  },
  {
    "text": "here that validates the input to others and cut the code we were looking at what is that mechanism as I mentioned the",
    "start": "1750530",
    "end": "1757850"
  },
  {
    "text": "main CPU and the radio core shared the links are there both do part of it and when we went back to the manual it was",
    "start": "1757850",
    "end": "1764930"
  },
  {
    "text": "clear that the radio validates packets to be between 6 and 37 bytes but when we",
    "start": "1764930",
    "end": "1773090"
  },
  {
    "text": "look at the code from the radio code we see that it looks at the length of the packet as 6 bits as the fine defined in",
    "start": "1773090",
    "end": "1779150"
  },
  {
    "text": "the specification where is the main core looked at the entire 8 bits so this difference leads to this one ability by",
    "start": "1779150",
    "end": "1787970"
  },
  {
    "text": "sending a small packet but turning on one of the are a few bits or both of them it would result in a memory",
    "start": "1787970",
    "end": "1793640"
  },
  {
    "text": "corruption and how we exploited this corruption and on the Cisco access point",
    "start": "1793640",
    "end": "1798670"
  },
  {
    "text": "back to talk to you now okay so I'm",
    "start": "1798670",
    "end": "1803690"
  },
  {
    "text": "gonna dive deep into exploiting this vulnerability but before we start exploiting we need that victim so we",
    "start": "1803690",
    "end": "1810230"
  },
  {
    "text": "chose this Co IP to exploit the town because it contains the CC 26:40 chip",
    "start": "1810230",
    "end": "1815390"
  },
  {
    "text": "and naturally we opened it up hooked up a debugger and the floor and started not",
    "start": "1815390",
    "end": "1820430"
  },
  {
    "text": "understanding where the data that is being that is corrupting and what are we exactly corrupting so looking back at",
    "start": "1820430",
    "end": "1827990"
  },
  {
    "text": "the vulnerable function that Ben talked about you can see that the advertising that our variable is coming from the",
    "start": "1827990",
    "end": "1833450"
  },
  {
    "text": "caller function which is advertising packet advertising packet is a global variable",
    "start": "1833450",
    "end": "1838460"
  },
  {
    "start": "1837000",
    "end": "1895000"
  },
  {
    "text": "that is statically allocated in memory which is its inari array that contains",
    "start": "1838460",
    "end": "1844760"
  },
  {
    "text": "the advertising packet that has arrived and it's it's a new fixed address it's",
    "start": "1844760",
    "end": "1849980"
  },
  {
    "text": "been mentioned there are no SLR no def here so it will be allocated at the same address every time and there's a lot of",
    "start": "1849980",
    "end": "1855830"
  },
  {
    "text": "interesting stuff to overflow after it's in the data section so the one that",
    "start": "1855830",
    "end": "1861200"
  },
  {
    "text": "sticks out the most are the these three function pointers which are system",
    "start": "1861200",
    "end": "1867350"
  },
  {
    "text": "critical function pointers the Deaf in what he uses so the first point of the I call dispatcher is the",
    "start": "1867350",
    "end": "1873539"
  },
  {
    "text": "Tim Colgate where every system called the firm makes every mullick goes through there that looks like a really",
    "start": "1873539",
    "end": "1879119"
  },
  {
    "text": "good target for us to control and the other two are the enter and exit critical section function pointer which",
    "start": "1879119",
    "end": "1885330"
  },
  {
    "text": "does exactly that it looks good as well they are called quite often Li but not",
    "start": "1885330",
    "end": "1890519"
  },
  {
    "text": "as much as the dispatcher so we're gonna head for for it so going back to the",
    "start": "1890519",
    "end": "1895590"
  },
  {
    "start": "1895000",
    "end": "1931000"
  },
  {
    "text": "vulnerable function you can see the data that the function parses is coming from",
    "start": "1895590",
    "end": "1900629"
  },
  {
    "text": "some data entry key so we needed to do some research and understand what is this data cue and where does this data",
    "start": "1900629",
    "end": "1907049"
  },
  {
    "text": "come from so this data cue is basically four entries of packets that arrives",
    "start": "1907049",
    "end": "1913320"
  },
  {
    "text": "from between the radio : the main core it is allocated in the shared RAM memory between those cores and it's linked",
    "start": "1913320",
    "end": "1921269"
  },
  {
    "text": "together to form a cyclic list and also they are contiguous in memory so let's",
    "start": "1921269",
    "end": "1926580"
  },
  {
    "text": "go over quickly how would the packet that is being received would look like so the pack the radio core and the main",
    "start": "1926580",
    "end": "1933629"
  },
  {
    "start": "1931000",
    "end": "1992000"
  },
  {
    "text": "core starts off at the start of the this list the radio corrosives a packet from there so it needs to mark the entry as",
    "start": "1933629",
    "end": "1940109"
  },
  {
    "text": "being used goes on and fills the data and then frees the entry so the main core can now start passing it",
    "start": "1940109",
    "end": "1946499"
  },
  {
    "text": "while the main core is passing it the radio core had received another packet from the air and filled it up in the",
    "start": "1946499",
    "end": "1952499"
  },
  {
    "text": "next entry so the main core can go on and parse it as well this happens in a cyclic motion meaning that when the",
    "start": "1952499",
    "end": "1959309"
  },
  {
    "text": "radio call will hit the fourth entry it will go back to the first entry and so on and so forth ok so now that we",
    "start": "1959309",
    "end": "1966179"
  },
  {
    "text": "understand where the data is coming from let's look at this scenario a normal advertising packet had arrived and then",
    "start": "1966179",
    "end": "1973080"
  },
  {
    "text": "the vulnerable function had copied it onto the advertising packet global variable okay so far so good another",
    "start": "1973080",
    "end": "1979109"
  },
  {
    "text": "normal advertising packet had come same here but now a triggering packet had",
    "start": "1979109",
    "end": "1984419"
  },
  {
    "text": "arrived meaning that we have turned on one or two of there are a few bits inside those packet but it's in the",
    "start": "1984419",
    "end": "1990269"
  },
  {
    "text": "legitimate length and now one out of bands copy will be initiated inside this",
    "start": "1990269",
    "end": "1995309"
  },
  {
    "text": "function and we can see that the data that resides inside entry number three will be copied onto the I call pointers",
    "start": "1995309",
    "end": "2002419"
  },
  {
    "text": "that you would like to control okay so this gives us a little bit of hint of where will the data that we want to",
    "start": "2002419",
    "end": "2008659"
  },
  {
    "text": "control will be held if this happens in the second entry then the fourth entry",
    "start": "2008659",
    "end": "2013669"
  },
  {
    "text": "will will be copied onto the icon pointers but what happens if it will trigger from the third of the fourth",
    "start": "2013669",
    "end": "2019970"
  },
  {
    "text": "entry we copy that of one after the data entry queue which we cannot hope to",
    "start": "2019970",
    "end": "2025010"
  },
  {
    "text": "control and this puts this form of expectation at 50% success rate so now",
    "start": "2025010",
    "end": "2031399"
  },
  {
    "start": "2030000",
    "end": "2132000"
  },
  {
    "text": "that we understand that we would like to control data entries that are not the triggering one we need obviously to",
    "start": "2031399",
    "end": "2036919"
  },
  {
    "text": "spray this data entry queue so I'm gonna go back a little bit about how Billy does is advertising",
    "start": "2036919",
    "end": "2043909"
  },
  {
    "text": "basically there are three advertising channels or frequencies which advertising packets are sent on and the",
    "start": "2043909",
    "end": "2051050"
  },
  {
    "text": "radio car is gonna hop between them looking for advertising packets so basically if you want or the radio call",
    "start": "2051050",
    "end": "2057200"
  },
  {
    "text": "to receive a spray packet every time we're going to need to be on all three channels also the radio the main core",
    "start": "2057200",
    "end": "2062810"
  },
  {
    "text": "the radio call head has a packet duplication mechanism that helps it",
    "start": "2062810",
    "end": "2067908"
  },
  {
    "text": "prevent seeing duplicated packets and basically it validates that it hasn't seen this packet from the same sender",
    "start": "2067909",
    "end": "2073849"
  },
  {
    "text": "from the same MAC address so basically we're just going to randomize every MAC address of the packet and then we will",
    "start": "2073849",
    "end": "2079398"
  },
  {
    "text": "easily circumvent this mechanism so now that we understand how we're gonna spray we're basically just gonna spray packets",
    "start": "2079399",
    "end": "2086658"
  },
  {
    "text": "that hold out desired I call values that we would like to put on the I call pointers and then after some time we're",
    "start": "2086659",
    "end": "2093050"
  },
  {
    "text": "going to trigger the overflow and do it again and again hoping to fall into the right place inside scanning process so",
    "start": "2093050",
    "end": "2099619"
  },
  {
    "text": "our strategy is as follows will trigger the packet the open flow from one entry",
    "start": "2099619",
    "end": "2105290"
  },
  {
    "text": "while copying on to the icon pointers and now we need to put meaningful values inside those I call pointers so we could",
    "start": "2105290",
    "end": "2111530"
  },
  {
    "text": "execute code so it's been mentioned we have no def here meaning we can execute data and we know exactly where our",
    "start": "2111530",
    "end": "2117320"
  },
  {
    "text": "overflow packet will be held because it's in advertising packet so let's put this address inside I'll call dispatcher",
    "start": "2117320",
    "end": "2124670"
  },
  {
    "text": "and then when the next sis call is called we'll just jump on to our packet and execute our packet sounds simple enough",
    "start": "2124670",
    "end": "2130670"
  },
  {
    "text": "but we have a lot of limitations on this exploitation first every advertising packet holds 37",
    "start": "2130670",
    "end": "2138109"
  },
  {
    "start": "2132000",
    "end": "2157000"
  },
  {
    "text": "bytes maximum of that so we control the trigger packet and we control the spray packet but spray",
    "start": "2138109",
    "end": "2144250"
  },
  {
    "text": "packet has three I call pointers values it needs to whole so we are left with 62",
    "start": "2144250",
    "end": "2150060"
  },
  {
    "text": "shellcode bytes that we can use in our exploitation this is not a lot of bytes",
    "start": "2150060",
    "end": "2155470"
  },
  {
    "text": "to maneuver within but let's talk about the task at hand that we're gonna need to do inside those 62 bytes we're gonna",
    "start": "2155470",
    "end": "2162490"
  },
  {
    "start": "2157000",
    "end": "2257000"
  },
  {
    "text": "prevent future over fuel crashes I'm going to talk about it in a bit we're going to install some sort of backdoor",
    "start": "2162490",
    "end": "2167560"
  },
  {
    "text": "because we want to keep communicating with the chip and controlling it and we're gonna need to restore the chip",
    "start": "2167560",
    "end": "2172810"
  },
  {
    "text": "state because we are running from a sis call that runs a packet which the system",
    "start": "2172810",
    "end": "2178660"
  },
  {
    "text": "things were kind of in a weird state and we're going to need to restore its original state so it will keep scanning",
    "start": "2178660",
    "end": "2184240"
  },
  {
    "text": "as usual and we have corrupted a lot of that on our way to the I call point is basically a 109 bytes of corrupted data",
    "start": "2184240",
    "end": "2192550"
  },
  {
    "text": "that was written by our overflow until we hit the I call pointers without",
    "start": "2192550",
    "end": "2197800"
  },
  {
    "text": "control values this is more bytes that we corrupt then we can actually control in this exploitation because we have",
    "start": "2197800",
    "end": "2204190"
  },
  {
    "text": "only 62 shellcode bytes meaning that if we will bring all the data with us we basically have on a little bit more than",
    "start": "2204190",
    "end": "2211000"
  },
  {
    "text": "half of the bytes that we need to restore so we're gonna need to find a solution for that and also we're gonna",
    "start": "2211000",
    "end": "2216880"
  },
  {
    "text": "need to return some error value because we don't have enough bytes to actually do the system call that is expected of",
    "start": "2216880",
    "end": "2222280"
  },
  {
    "text": "us because we are running from a 16 call back and then we're gonna need to patch the system call address back the I call",
    "start": "2222280",
    "end": "2229150"
  },
  {
    "text": "dispatch it back to its original value so we want we want to be called every time a system call happened then the",
    "start": "2229150",
    "end": "2235480"
  },
  {
    "text": "system can continue as usual so I looked at it at first I was like oh man it",
    "start": "2235480",
    "end": "2241450"
  },
  {
    "text": "can't be done like logically we don't have enough bytes to do it and I remember talking with Ben about it and",
    "start": "2241450",
    "end": "2247570"
  },
  {
    "text": "saying let's just not exploit this whenever it's it's too much but Ben told me let's take it part by part and so I",
    "start": "2247570",
    "end": "2253570"
  },
  {
    "text": "will take you through part by part of our exploitation so the first problem is",
    "start": "2253570",
    "end": "2258910"
  },
  {
    "start": "2257000",
    "end": "2280000"
  },
  {
    "text": "preventing future overflows what do I mean by that let's imagine a trigger packet had arrived in the entry number 2",
    "start": "2258910",
    "end": "2264370"
  },
  {
    "text": "and we controlled with Osprey an entry number 4 now the overflow will be triggered our code will run and",
    "start": "2264370",
    "end": "2270520"
  },
  {
    "text": "everything is good in the world but what happens if another triggered package just arrived in entry number three so after a shell",
    "start": "2270520",
    "end": "2276720"
  },
  {
    "text": "code has gotten executed the main code will go on to pass the third entry and",
    "start": "2276720",
    "end": "2283080"
  },
  {
    "start": "2280000",
    "end": "2295000"
  },
  {
    "text": "then copy uncontrolled data on the I call pointers and basically crush the chip if this is left on fixed we will",
    "start": "2283080",
    "end": "2288840"
  },
  {
    "text": "eventually sometime crush the chip so this is bled obviously we need to find a",
    "start": "2288840",
    "end": "2293940"
  },
  {
    "text": "way to fix it so let's assume our triggered packet was from the second",
    "start": "2293940",
    "end": "2299280"
  },
  {
    "text": "entry and now we can we have executed code we do this nifty little trick where",
    "start": "2299280",
    "end": "2304530"
  },
  {
    "text": "we link the same entry that triggered the vulnerability to itself effectively freezing other entries from being",
    "start": "2304530",
    "end": "2310830"
  },
  {
    "text": "touched by the main core or the radio core because now they don't even know they exist and now when the when another packet",
    "start": "2310830",
    "end": "2318090"
  },
  {
    "text": "will come the radio echo will fill the second entry but the Manco will have to wait until it finish because the entry",
    "start": "2318090",
    "end": "2324150"
  },
  {
    "text": "the data entry queue is only one entry long so now when the main hall will pass it everything is good but now another",
    "start": "2324150",
    "end": "2330690"
  },
  {
    "text": "trigger packet come no problem because we're in the same pool state that we used to and now the copy will be called",
    "start": "2330690",
    "end": "2336870"
  },
  {
    "text": "again and we'll still won't crush the chip but execute code again meaning that when we first succeed we will succeed",
    "start": "2336870",
    "end": "2343710"
  },
  {
    "text": "every time after doing this trick this trick costs us about three armed instructions that's not a lot and we are",
    "start": "2343710",
    "end": "2351390"
  },
  {
    "text": "left with 56 shellcode bytes okay so now the hot pot we need to restore execution",
    "start": "2351390",
    "end": "2358260"
  },
  {
    "start": "2357000",
    "end": "2453000"
  },
  {
    "text": "of the chip to its original state I don't have the time to go into everything but I'm just going to talk",
    "start": "2358260",
    "end": "2364590"
  },
  {
    "text": "about after a lot of research we did we found that these variables must be restored for in order for the chip to be",
    "start": "2364590",
    "end": "2370200"
  },
  {
    "text": "in its original state so we wrote some code that does exactly that but I",
    "start": "2370200",
    "end": "2375540"
  },
  {
    "text": "haven't mentioned our overflow will corrupt some gap task related variables",
    "start": "2375540",
    "end": "2381330"
  },
  {
    "text": "there that are 16 bytes long so now after restoring everything we need and we have 17 banks of shellcode left for",
    "start": "2381330",
    "end": "2388500"
  },
  {
    "text": "us to do logic we need to restore sixteen bytes of data which means that",
    "start": "2388500",
    "end": "2393900"
  },
  {
    "text": "even we can do it in zero instructions we'll still have one shellcode bytes for for our logic to do which basically is a",
    "start": "2393900",
    "end": "2402060"
  },
  {
    "text": "half of our arm instruction so our expert just restores execution and does nothing this is obviously bad and we're",
    "start": "2402060",
    "end": "2409650"
  },
  {
    "text": "gonna need to go back to the drawing board and take an eight-second look at this so we did some more research and",
    "start": "2409650",
    "end": "2417630"
  },
  {
    "text": "found out that basically if we stop the gab desk from ever running again we can",
    "start": "2417630",
    "end": "2422640"
  },
  {
    "text": "just restore those three variables put a null inside one of the gap test",
    "start": "2422640",
    "end": "2427740"
  },
  {
    "text": "callbacks which make it would make it stop running and then we can just restore those three variables making it",
    "start": "2427740",
    "end": "2435780"
  },
  {
    "text": "not that byte expensive for us to restore those those variables and we",
    "start": "2435780",
    "end": "2441780"
  },
  {
    "text": "could now do we now have 32 shellcode bytes for us to maneuver within still",
    "start": "2441780",
    "end": "2447330"
  },
  {
    "text": "not a lot but it's lists it's something so now that we have restored their execution we're gonna need to install",
    "start": "2447330",
    "end": "2453839"
  },
  {
    "start": "2453000",
    "end": "2537000"
  },
  {
    "text": "some form of a backdoor because we have only 32 bytes of shellcode left we're gonna need a vector to be really really",
    "start": "2453839",
    "end": "2459630"
  },
  {
    "text": "lightweight in size efficient and also we would like to put there somewhere it won't cost us a lot of time and",
    "start": "2459630",
    "end": "2466880"
  },
  {
    "text": "instructions to install the hook for our backdoor so our backdoor that we come up",
    "start": "2466880",
    "end": "2472560"
  },
  {
    "text": "with will be this bed oh it's only 8 bytes long it will it will sit our",
    "start": "2472560",
    "end": "2478380"
  },
  {
    "text": "shellcode will read rewrite it just above the advertising packet by global variable what it does is basically",
    "start": "2478380",
    "end": "2484530"
  },
  {
    "text": "checks if the first four bytes of the packet that is been received is a magic",
    "start": "2484530",
    "end": "2490140"
  },
  {
    "text": "value in this case PC but because everything is static we can predict PC every time and if it's the magic value",
    "start": "2490140",
    "end": "2496200"
  },
  {
    "text": "it will jump over it and just execute our packet that's great and we need some",
    "start": "2496200",
    "end": "2501900"
  },
  {
    "text": "we need now we need some runtime for our back though so remember we control the I call pointers so why not use the other",
    "start": "2501900",
    "end": "2508650"
  },
  {
    "text": "two we'll use the entry critical section to execute our back door it is called many times during one packet parsing",
    "start": "2508650",
    "end": "2515010"
  },
  {
    "text": "making sure our vector will be called every time a new packet has arrived and we'll use the exit critical section",
    "start": "2515010",
    "end": "2520500"
  },
  {
    "text": "basically because we don't have enough bytes in the end row and in our back door to do the actual enter critical",
    "start": "2520500",
    "end": "2526260"
  },
  {
    "text": "section we'll just put a gadget that does nothing inside the exit critical section and render this mechanism useless but still we get some execution",
    "start": "2526260",
    "end": "2534690"
  },
  {
    "text": "time for back though so let's recap all of our back door first we set up some",
    "start": "2534690",
    "end": "2540450"
  },
  {
    "start": "2537000",
    "end": "2575000"
  },
  {
    "text": "environment they're reading some variables into registers then we're going to stop the gap test from running",
    "start": "2540450",
    "end": "2546540"
  },
  {
    "text": "we're going to install our back though this is to store instructions because our back door is only eight bytes long then we're going to link the data entry",
    "start": "2546540",
    "end": "2554220"
  },
  {
    "text": "that has triggered the vulnerability to itself using other entries in making sure we won't crash in the next figure",
    "start": "2554220",
    "end": "2560060"
  },
  {
    "text": "then we're going to restore our corrupted values as I mentioned we need to restore only two variables the time I",
    "start": "2560060",
    "end": "2565619"
  },
  {
    "text": "had in the Bailey dispatch task ID and then we're gonna unhook ourselves from the Cisco and then Gateway because we",
    "start": "2565619",
    "end": "2572160"
  },
  {
    "text": "want we don't want to run again and that's it basically we have exploited the CC 2640 we don't need 32 bytes of",
    "start": "2572160",
    "end": "2580079"
  },
  {
    "text": "shellcode that we had in our disposal and now I'm gonna press the stage two bandits gonna talk about the demo thank",
    "start": "2580079",
    "end": "2586560"
  },
  {
    "start": "2585000",
    "end": "2688000"
  },
  {
    "text": "you so as you as you saw it was quite",
    "start": "2586560",
    "end": "2597750"
  },
  {
    "text": "challenging to achieve execution through this small bug but but eventually we did",
    "start": "2597750",
    "end": "2604740"
  },
  {
    "text": "it I don't show a small a short video on how this is exploited so you have again",
    "start": "2604740",
    "end": "2613400"
  },
  {
    "text": "the hacker it controls raspberry pi that connect it",
    "start": "2613400",
    "end": "2618540"
  },
  {
    "text": "to a new belief that device can be used to send MIDI packets custom packets and",
    "start": "2618540",
    "end": "2624150"
  },
  {
    "text": "this attacks this gratis point on the right we can see the attacker is scanning for ble beacons when the attack",
    "start": "2624150",
    "end": "2631589"
  },
  {
    "text": "is finished we will see the targeted device beginning a specific message a",
    "start": "2631589",
    "end": "2637980"
  },
  {
    "text": "specific so on the Left we can see the attack going on we send the spray packets we send the trigger overflow and",
    "start": "2637980",
    "end": "2644550"
  },
  {
    "text": "now once we have a backdoor we upload our specific beacon data onto the device",
    "start": "2644550",
    "end": "2651240"
  },
  {
    "text": "using that regular backdoor and we tell the chip to start advertising this",
    "start": "2651240",
    "end": "2656569"
  },
  {
    "text": "malicious weekend and you can see on the right the AP is saying it has been owned",
    "start": "2656569",
    "end": "2663270"
  },
  {
    "text": "and an indication of compromise from familiar just from the VDP hands so in",
    "start": "2663270",
    "end": "2671880"
  },
  {
    "text": "that state any device nearby that scans from Billy weekend's like my smartphone we will show that in",
    "start": "2671880",
    "end": "2678990"
  },
  {
    "text": "fact the beacon is saying you're a piece we don't to us okay so yes we really at",
    "start": "2678990",
    "end": "2701220"
  },
  {
    "start": "2688000",
    "end": "2810000"
  },
  {
    "text": "the end I just want to tip to talk about",
    "start": "2701220",
    "end": "2706260"
  },
  {
    "text": "three takeaways I think should be taken from this research first the fact that",
    "start": "2706260",
    "end": "2712700"
  },
  {
    "text": "Billy chips radio chips that are sometimes considered peripheral chips",
    "start": "2712700",
    "end": "2717990"
  },
  {
    "text": "can also be vulnerable to attack right they have CPUs they run code they can be vulnerable if they are vulnerable this",
    "start": "2717990",
    "end": "2726450"
  },
  {
    "text": "can lead to something greater this can lead in an access point environment for example to a network breach so you can",
    "start": "2726450",
    "end": "2732270"
  },
  {
    "text": "start for something very small like a billy chip but this can go on and then targeting an entire network code and",
    "start": "2732270",
    "end": "2739650"
  },
  {
    "text": "third the fact is that access points in network infrastructure devices in general or practically also unmanaged",
    "start": "2739650",
    "end": "2746250"
  },
  {
    "text": "devices the Billy chip inside the access point is not managed right the access",
    "start": "2746250",
    "end": "2751920"
  },
  {
    "text": "point itself is just a device that service Wi-Fi it doesn't have an agent on it it doesn't have too many too much",
    "start": "2751920",
    "end": "2757619"
  },
  {
    "text": "inherent security so in the global like you zooming out from the bits that we",
    "start": "2757619",
    "end": "2763589"
  },
  {
    "text": "talked about it is a general picture and obviously this is a slang step that should be",
    "start": "2763589",
    "end": "2769740"
  },
  {
    "text": "looked at we have a white paper that we tell is all of what we talked about in",
    "start": "2769740",
    "end": "2775859"
  },
  {
    "text": "detail on our website and all the affected devices and one of it is obviously we did it",
    "start": "2775859",
    "end": "2781680"
  },
  {
    "text": "security disclosure process which I haven't talked about but it's also detailed in this website and I think we",
    "start": "2781680",
    "end": "2788190"
  },
  {
    "text": "have like three minutes for questions if anybody want to ask",
    "start": "2788190",
    "end": "2792828"
  },
  {
    "text": "maybe we were really really clear that's a good sign right",
    "start": "2796810",
    "end": "2802660"
  },
  {
    "text": "thank you very much [Applause]",
    "start": "2806240",
    "end": "2811959"
  }
]