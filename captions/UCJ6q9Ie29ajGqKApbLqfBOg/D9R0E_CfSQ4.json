[
  {
    "text": "thank you for having me here today welcome to adversary detection pipelines",
    "start": "3840",
    "end": "9679"
  },
  {
    "text": "finally making your threat intel useful today i'm going to talk about how to get",
    "start": "9679",
    "end": "15920"
  },
  {
    "text": "more out of your threat intel i'm xena olson also known as cheerio on",
    "start": "15920",
    "end": "23359"
  },
  {
    "text": "twitter i'm a blue team village senior lead a doctoral student in cyber security at marymount university a",
    "start": "23359",
    "end": "31039"
  },
  {
    "text": "cyber threat intelligence or cti analyst cnn's women's academy graduate i have an mba and it management",
    "start": "31039",
    "end": "38239"
  },
  {
    "text": "seven gx certs and i'm a huge disney fan also i'll be sharing a lot of really",
    "start": "38239",
    "end": "44320"
  },
  {
    "text": "good resources in this talk so i created a repo for you at the bitly link",
    "start": "44320",
    "end": "49840"
  },
  {
    "text": "but before we get started i have a quick note from the lawyers i'm not speaking on behalf of my",
    "start": "49840",
    "end": "55600"
  },
  {
    "text": "employers the opinions i express are mine alone i'm here in my own individual",
    "start": "55600",
    "end": "60640"
  },
  {
    "text": "capacity and the use of size purple team exercise framework later in this talk does not endorse them",
    "start": "60640",
    "end": "65840"
  },
  {
    "text": "as a vendor so let's get started to set the theme of this talk i'll be using the lyrics from",
    "start": "65840",
    "end": "72240"
  },
  {
    "text": "songs of an international pop star taylor swift i made a custom spotify playlist with",
    "start": "72240",
    "end": "78400"
  },
  {
    "text": "all the songs i used in this presentation along with a few extras so you can find the link to the playlist",
    "start": "78400",
    "end": "86240"
  },
  {
    "text": "on the github repo in the bitly link so when taylor swift",
    "start": "86240",
    "end": "91680"
  },
  {
    "text": "sings that you'll never find another one like her that translates to how",
    "start": "91680",
    "end": "97360"
  },
  {
    "text": "there isn't a one size fits all for a company's threat landscape because every org is different and",
    "start": "97360",
    "end": "104560"
  },
  {
    "text": "unique in this talk i will not",
    "start": "104560",
    "end": "110079"
  },
  {
    "text": "focus on the microsofts the targets the walmarts the googles of the world meaning the more",
    "start": "110079",
    "end": "116960"
  },
  {
    "text": "mature cti or cyber threat intelligence teams nor will i focus on government entities or",
    "start": "116960",
    "end": "124079"
  },
  {
    "text": "critical infrastructure instead i'll be focusing on pretty much everyone else",
    "start": "124079",
    "end": "130160"
  },
  {
    "text": "so first i'm going to discuss some pain points that are specific",
    "start": "130160",
    "end": "135200"
  },
  {
    "text": "to cti if you ask around there are security professionals that",
    "start": "135200",
    "end": "141520"
  },
  {
    "text": "are not happy with cti i've heard of people getting outdated intelligence copy paste reports",
    "start": "141520",
    "end": "148800"
  },
  {
    "text": "not timely intel intel that isn't relevant to your org or you're only getting iocs indicator of",
    "start": "148800",
    "end": "156480"
  },
  {
    "text": "compromise or iox instead of looking at what is actually going on on their networks and",
    "start": "156480",
    "end": "162560"
  },
  {
    "text": "threat landscape i've heard some cti analysts solely focusing",
    "start": "162560",
    "end": "167920"
  },
  {
    "text": "on public threat actor reporting and going for the sexy apts which is",
    "start": "167920",
    "end": "174319"
  },
  {
    "text": "advanced persistent threats such as fancy bear which is a russian-based threat actor",
    "start": "174319",
    "end": "179920"
  },
  {
    "text": "publicly linked to intrusions into the german bundestag and france's tv5",
    "start": "179920",
    "end": "187040"
  },
  {
    "text": "maldives station in april 2015.",
    "start": "187040",
    "end": "191840"
  },
  {
    "text": "so another issue facing cti is that the teams are all in silos and they aren't talking",
    "start": "192159",
    "end": "198239"
  },
  {
    "text": "or sharing projects or what they're working on and in some orgs red teams kind of do",
    "start": "198239",
    "end": "204080"
  },
  {
    "text": "their own thing and decide operations based on the latest shiny hack that's out there thank mr",
    "start": "204080",
    "end": "211519"
  },
  {
    "text": "robot so you know instead of looking at org specific adversaries and ttps",
    "start": "211519",
    "end": "220720"
  },
  {
    "text": "in some organizations cti is fighting an uphill battle",
    "start": "220799",
    "end": "226000"
  },
  {
    "text": "some intel vendors might have ulterior motives and trying to get you to buy their",
    "start": "226000",
    "end": "231360"
  },
  {
    "text": "product when it doesn't necessarily suit your threat model and i've heard",
    "start": "231360",
    "end": "236480"
  },
  {
    "text": "some managers just don't understand the importance of blocked attacks or the collection of forensic artifacts",
    "start": "236480",
    "end": "243439"
  },
  {
    "text": "for the cti team and i don't know if you know this but threat intel managers",
    "start": "243439",
    "end": "249200"
  },
  {
    "text": "they're a very very special kind of manager because they need to be aware of their use of",
    "start": "249200",
    "end": "256320"
  },
  {
    "text": "logical fallacies and cognitive bias otherwise it could kinda under mean",
    "start": "256320",
    "end": "262000"
  },
  {
    "text": "undermine the threat intel team's efforts so finally office politics and i don't need to",
    "start": "262000",
    "end": "269440"
  },
  {
    "text": "elaborate or get into that one so how can cti provide more value to the",
    "start": "269440",
    "end": "276000"
  },
  {
    "text": "organization while overcoming some of the obstacles i mentioned how can cti help teams get out of their",
    "start": "276000",
    "end": "283120"
  },
  {
    "text": "silos and work together you know i started asking myself these questions and a few more",
    "start": "283120",
    "end": "289600"
  },
  {
    "text": "and it ended up leading me down a rabbit hole to discover if it is possible to come up",
    "start": "289600",
    "end": "296400"
  },
  {
    "text": "with a reasonable solution that almost any cti analyst can use to create a",
    "start": "296400",
    "end": "302080"
  },
  {
    "text": "baseline of their org threat landscape so the goal is to produce meaningful",
    "start": "302080",
    "end": "308240"
  },
  {
    "text": "threat intelligence products so this talk will hopefully shed some light on what",
    "start": "308240",
    "end": "315039"
  },
  {
    "text": "i've found over the course of over two years and give you some ideas to incorporate",
    "start": "315039",
    "end": "320160"
  },
  {
    "text": "at your org so first we'll explore attribution then",
    "start": "320160",
    "end": "325280"
  },
  {
    "text": "we'll move on to ttps or tactics techniques and procedures we'll discuss some ideas for filtering",
    "start": "325280",
    "end": "331440"
  },
  {
    "text": "threats and finally adversary detection pipelines so attribution is hard for the purposes",
    "start": "331440",
    "end": "339120"
  },
  {
    "text": "of this talk i will solely focus on private companies where attribution may not be as",
    "start": "339120",
    "end": "346240"
  },
  {
    "text": "important as it might be for governments or critical infrastructure in this section also",
    "start": "346240",
    "end": "352160"
  },
  {
    "text": "when i refer to attribution i mean true attribution where you find out who actually did it",
    "start": "352160",
    "end": "359199"
  },
  {
    "text": "so even if you get all of the forensic information such as keyboard used",
    "start": "359199",
    "end": "364479"
  },
  {
    "text": "libraries languages use compiler use compile time metadata code styles",
    "start": "364479",
    "end": "369759"
  },
  {
    "text": "resource language c2 check-in mutex names chronicle tags and more you would still need other evidence or",
    "start": "369759",
    "end": "376560"
  },
  {
    "text": "possibly to include other parties such as law enforcement government agencies",
    "start": "376560",
    "end": "381600"
  },
  {
    "text": "or outside consulting firms for true attribution",
    "start": "381600",
    "end": "386960"
  },
  {
    "text": "in tim mowers cyber mercenaries the state hackers in power he discusses the use of independent",
    "start": "386960",
    "end": "392880"
  },
  {
    "text": "hackers to act as a proxy for nation-state actors so how would you tell the difference",
    "start": "392880",
    "end": "399360"
  },
  {
    "text": "between a proxy and the actual source of the attack i know i couldn't",
    "start": "399360",
    "end": "405280"
  },
  {
    "text": "another issue with attempting to do true attribution is false flag operations where the attackers purposefully create",
    "start": "405280",
    "end": "412479"
  },
  {
    "text": "misleading artifacts to throw researchers off their trail a really great example of this is",
    "start": "412479",
    "end": "418160"
  },
  {
    "text": "the olympic destroyer operation it was originally thought to be north korea then russia with some things that look",
    "start": "418160",
    "end": "425599"
  },
  {
    "text": "like a chinese apt but still no solid attribution so you know for more in-depth discussion of false",
    "start": "425599",
    "end": "432000"
  },
  {
    "text": "flag operations check out jake williams talk at black cat europe 2019",
    "start": "432000",
    "end": "437440"
  },
  {
    "text": "called conducting a successful false flag operation",
    "start": "437440",
    "end": "443440"
  },
  {
    "text": "so in summary about attribution most orgs do not need it nor is it worth the time effort and",
    "start": "444319",
    "end": "451840"
  },
  {
    "text": "expense true attribution is not going to be considered in the adversary detection",
    "start": "451840",
    "end": "457599"
  },
  {
    "text": "model instead we're going to use the diamond model along with ttps to form",
    "start": "457599",
    "end": "463120"
  },
  {
    "text": "activity groups based upon internal attack data that we then name",
    "start": "463120",
    "end": "468319"
  },
  {
    "text": "for the ease of explaining data so let's talk about behaviors tactics",
    "start": "468319",
    "end": "475120"
  },
  {
    "text": "techniques and procedures for the adversary i'm interested in looking at stuff that does something",
    "start": "475120",
    "end": "481120"
  },
  {
    "text": "bad instead of focusing on a few adversaries that may or may not actually be",
    "start": "481120",
    "end": "486319"
  },
  {
    "text": "attacking my org so mitre attack offers a great free training resource on",
    "start": "486319",
    "end": "492319"
  },
  {
    "text": "how to make ttps by katie nichols and adam pennington and i recommend checking that out",
    "start": "492319",
    "end": "499039"
  },
  {
    "text": "so we want to create a solution to support other teams the pyramid of pain by david j bianca",
    "start": "499039",
    "end": "507360"
  },
  {
    "text": "provides a perfect illustration of increasing the effort of attackers",
    "start": "507360",
    "end": "512399"
  },
  {
    "text": "through the use of ttps it is trivial to generate a new hash but",
    "start": "512399",
    "end": "519039"
  },
  {
    "text": "far more difficult to change how an attacker compromises an organization we want to increase the",
    "start": "519039",
    "end": "526000"
  },
  {
    "text": "difficulty and the time the adversary has to invest to pone us",
    "start": "526000",
    "end": "532399"
  },
  {
    "text": "ttps to me means that i am interested in how an attacker does something versus",
    "start": "532399",
    "end": "539200"
  },
  {
    "text": "why they did it or who is doing it",
    "start": "539200",
    "end": "544240"
  },
  {
    "text": "an adversary detection pipeline is about sharing the behaviors of attacks impacting your",
    "start": "544560",
    "end": "550560"
  },
  {
    "text": "org and setting up other teams for success bryson bort ceo and founder of scythe",
    "start": "550560",
    "end": "557120"
  },
  {
    "text": "points out that ttps allow you to look at the controls detection and response across all the",
    "start": "557120",
    "end": "564399"
  },
  {
    "text": "stages of the attack path for your org that's why ttps are critical to building",
    "start": "564399",
    "end": "571519"
  },
  {
    "text": "out the adversary detection pipeline so focusing on ttps can help other teams",
    "start": "571519",
    "end": "578560"
  },
  {
    "text": "too for instance if i give domains and ips to red team that won't be as helpful as sharing",
    "start": "578560",
    "end": "585200"
  },
  {
    "text": "actual behaviors or ttps so that red can build out their adversary emulation",
    "start": "585200",
    "end": "591519"
  },
  {
    "text": "operation adam pennington at defcon 28 red team village",
    "start": "591519",
    "end": "596880"
  },
  {
    "text": "a talk called emulating an adversary with imperfect intelligence he talks about dependencies for",
    "start": "596880",
    "end": "603440"
  },
  {
    "text": "techniques and other helpful tips in building out an adversary detection or adversary emulation plan based on",
    "start": "603440",
    "end": "610880"
  },
  {
    "text": "open source reporting so focusing on ttps might seem simple",
    "start": "610880",
    "end": "617519"
  },
  {
    "text": "but as john the senior director of mandiant threat intelligence points out attackers will use what works even if",
    "start": "617519",
    "end": "625279"
  },
  {
    "text": "it's simple one of the main goals of adversary detection pipelines",
    "start": "625279",
    "end": "630640"
  },
  {
    "text": "is to get really good at understanding simple attacks specific to your org's infrastructure",
    "start": "630640",
    "end": "638000"
  },
  {
    "text": "controls and detection joe a seasoned threat intelligence",
    "start": "638000",
    "end": "643680"
  },
  {
    "text": "professional points out many attackers will take the path of least resistance to get the job",
    "start": "643680",
    "end": "649519"
  },
  {
    "text": "done even verizon's data breach investigation report in 2020 showed that attackers are",
    "start": "649519",
    "end": "656480"
  },
  {
    "text": "favoring stolen credentials for breaches so why develop a zero day or a complex",
    "start": "656480",
    "end": "663360"
  },
  {
    "text": "attack when you can just steal creds former fbi director robert mueller says",
    "start": "663360",
    "end": "671120"
  },
  {
    "text": "there are only two types of companies those that have been hacked and those that will be hacked so the",
    "start": "671120",
    "end": "678959"
  },
  {
    "text": "adversary detection pipeline model works from a place of assumed breach if this malware or whatever attack it is",
    "start": "678959",
    "end": "686640"
  },
  {
    "text": "bypasses our controls what will it do how will it operate in your environment",
    "start": "686640",
    "end": "692160"
  },
  {
    "text": "what are the ttps from there you can work with other teams to better understand your visibility detection",
    "start": "692160",
    "end": "699360"
  },
  {
    "text": "and response the purpose of threat intelligence is to",
    "start": "699360",
    "end": "705600"
  },
  {
    "text": "be actionable so here's an example of how you can use ttps so these are",
    "start": "705600",
    "end": "712800"
  },
  {
    "text": "some of the behaviors of the attack coming at the org of the attacks coming at the orc we have",
    "start": "712800",
    "end": "719120"
  },
  {
    "text": "x percent coverage with our controls detection for x percent and",
    "start": "719120",
    "end": "725360"
  },
  {
    "text": "are in the process of addressing x gaps through actions x y and z",
    "start": "725360",
    "end": "732560"
  },
  {
    "text": "this provides meaningful and organization specific metrics and shows due diligence to your",
    "start": "732560",
    "end": "739360"
  },
  {
    "text": "shareholders your investors management senior management as well as a justification for any",
    "start": "739360",
    "end": "745360"
  },
  {
    "text": "security products you have so now that i've shared why ttps are",
    "start": "745360",
    "end": "750399"
  },
  {
    "text": "favored versus true attribution let's look at how ttps could help other teams",
    "start": "750399",
    "end": "759839"
  },
  {
    "text": "so now we're going to use initiatives to basically filter the entire internet",
    "start": "760079",
    "end": "767040"
  },
  {
    "text": "it's going to take time and it's going to take some work but it's worth it",
    "start": "767440",
    "end": "774480"
  },
  {
    "text": "so for the business initiatives i usually recommend looking at the management discussion for the 10k",
    "start": "774480",
    "end": "779839"
  },
  {
    "text": "10q or the annual report or whatever goals report you have for your organization",
    "start": "779839",
    "end": "785760"
  },
  {
    "text": "for the department and security team i really recommend having conversations with the various teams at your org",
    "start": "785760",
    "end": "792320"
  },
  {
    "text": "whether it's red or purple or blue or hunt and then also too generally these security teams will have",
    "start": "792320",
    "end": "800320"
  },
  {
    "text": "goals or initiatives they have to meet each quarter or each year and what you could do is",
    "start": "800320",
    "end": "806079"
  },
  {
    "text": "find those out and then figure out how to help them with whatever it is they're trying to",
    "start": "806079",
    "end": "811440"
  },
  {
    "text": "do and then of course the cti team can basically create the baseline for a",
    "start": "811440",
    "end": "817279"
  },
  {
    "text": "lot of these deliverables so that you can track stuff over time",
    "start": "817279",
    "end": "823040"
  },
  {
    "text": "scott j roberts and cti squad goal setting requirements and brian p heim in threat intel",
    "start": "823440",
    "end": "830720"
  },
  {
    "text": "planning they offer some good suggestions on some basic ideas around the operation that the operational",
    "start": "830720",
    "end": "838000"
  },
  {
    "text": "environment of your org so one of them is reviewing industry verticals",
    "start": "838000",
    "end": "843440"
  },
  {
    "text": "reviewing the threat actors that historically attacked your verticals and then looking at the threats and",
    "start": "843440",
    "end": "849519"
  },
  {
    "text": "threat actors that attacked your org and then also to assessing the internal and external exposure",
    "start": "849519",
    "end": "856240"
  },
  {
    "text": "so you want to run attack scenarios and understand the attack progression so you go from external to internal and",
    "start": "856240",
    "end": "863920"
  },
  {
    "text": "then internal to external so that you get a good idea",
    "start": "863920",
    "end": "870079"
  },
  {
    "text": "you are going to need to make sure you're collecting some data so in a 2019 cti survey rebecca brown",
    "start": "870079",
    "end": "877440"
  },
  {
    "text": "and robert emily share some suggested data collection sources so internally you can look at your",
    "start": "877440",
    "end": "884560"
  },
  {
    "text": "internal tickets your waff email analysis endpoint ids on and on uh open source reporting",
    "start": "884560",
    "end": "891839"
  },
  {
    "text": "you can look at white papers threat reports researchers news doj indictments",
    "start": "891839",
    "end": "898000"
  },
  {
    "text": "and then there's sharing groups so you have the isacs the certs the tlp amber and bread private intel",
    "start": "898000",
    "end": "905519"
  },
  {
    "text": "groups and then finally threat feeds and intel vendors",
    "start": "905519",
    "end": "911519"
  },
  {
    "text": "you also need to prioritize your threats so you look at the intent opportunity and capability of the",
    "start": "911519",
    "end": "918720"
  },
  {
    "text": "attackers with respect to threats to your org david jay bianco and cat self in their",
    "start": "918720",
    "end": "925199"
  },
  {
    "text": "talk at sands threat hunting and ir europe summit 2020 shared a method of prioritizing hunting",
    "start": "925199",
    "end": "933360"
  },
  {
    "text": "using polar geometry you can adapt this to cti when prioritizing threats too",
    "start": "933360",
    "end": "941759"
  },
  {
    "text": "the diamond model can help you structure your pivoting it can also be used to make activity",
    "start": "941759",
    "end": "947839"
  },
  {
    "text": "groups so you've got to get kind of creative and use the diamond model in a way that",
    "start": "947839",
    "end": "952880"
  },
  {
    "text": "works for your org here's a suggestion start with your",
    "start": "952880",
    "end": "957920"
  },
  {
    "text": "email data both blocked and delivered to get a baseline on your org specific threat landscape if",
    "start": "957920",
    "end": "965199"
  },
  {
    "text": "you see the repetitive use of infrastructure and capability vertices of the diamond",
    "start": "965199",
    "end": "971440"
  },
  {
    "text": "model in your attack data you can group those attacks as a thread activity group and name it",
    "start": "971440",
    "end": "978079"
  },
  {
    "text": "as an easier way to convey data such as zero cool or fuzzy snuggly duck",
    "start": "978079",
    "end": "985360"
  },
  {
    "text": "next you can focus on other internal sources such as sock or d for tickets",
    "start": "985360",
    "end": "992639"
  },
  {
    "text": "so we just laid the foundation for adversary detection pipelines next we'll explore it further",
    "start": "993040",
    "end": "1001279"
  },
  {
    "text": "so the analysis of organization specific threats",
    "start": "1002480",
    "end": "1007839"
  },
  {
    "text": "via structured and unstructured formats for an adversary detection pipeline focused",
    "start": "1007839",
    "end": "1014959"
  },
  {
    "text": "on business departmental and cti initiatives",
    "start": "1014959",
    "end": "1020879"
  },
  {
    "text": "what does that mean basically i'm going to use the initiatives with the focus on ttps and behaviors",
    "start": "1021519",
    "end": "1028558"
  },
  {
    "text": "pulling from email attack data internal sources and publicly available available data",
    "start": "1028559",
    "end": "1034240"
  },
  {
    "text": "to filter out threats that do not impact my org",
    "start": "1034240",
    "end": "1039839"
  },
  {
    "text": "so imagine these are all the possible threats on the internet how do we make this more manageable",
    "start": "1040720",
    "end": "1049759"
  },
  {
    "text": "you can narrow your focus based upon the initiatives that are specific to your org the purpose",
    "start": "1050559",
    "end": "1057600"
  },
  {
    "text": "of the cti team initiative is to create a threat landscape specific to",
    "start": "1057600",
    "end": "1063200"
  },
  {
    "text": "the org that you track over time so you can spot anomalies",
    "start": "1063200",
    "end": "1068480"
  },
  {
    "text": "it's also to prioritize organization specific threats and to build out deliverables for other",
    "start": "1068480",
    "end": "1075679"
  },
  {
    "text": "teams so using email attack data you have a",
    "start": "1075679",
    "end": "1080880"
  },
  {
    "text": "source of data that can give you info on the various ransomware variants sent to your org",
    "start": "1080880",
    "end": "1087039"
  },
  {
    "text": "malware phishing campaigns business email compromise and any other attacks so through looking",
    "start": "1087039",
    "end": "1094559"
  },
  {
    "text": "at all of the email data including the blocked you can gain a better understanding of the type of ttps",
    "start": "1094559",
    "end": "1101440"
  },
  {
    "text": "that are being used against your org prior to the post-exploitation phase",
    "start": "1101440",
    "end": "1109840"
  },
  {
    "text": "when you incorporate the assumed breach model in conjunction with looking at the ttps",
    "start": "1109919",
    "end": "1115360"
  },
  {
    "text": "of the email attack data you can get involved in proactive security practices through",
    "start": "1115360",
    "end": "1121679"
  },
  {
    "text": "ensuring you have visibility detection and security controls this table",
    "start": "1121679",
    "end": "1129679"
  },
  {
    "text": "shows you the blocked delivered and clicked malicious emails so this can be used to prioritize work",
    "start": "1129679",
    "end": "1137039"
  },
  {
    "text": "to give to other teams such as looking at the ttps associated with the clicked",
    "start": "1137039",
    "end": "1142559"
  },
  {
    "text": "or delivered campaigns first you can take it a step further and prioritize looking at actors",
    "start": "1142559",
    "end": "1149120"
  },
  {
    "text": "that show a high click rate of delivered messages what sets that particular activity group",
    "start": "1149120",
    "end": "1155600"
  },
  {
    "text": "apart from the others so this heat map is just a fancy way of",
    "start": "1155600",
    "end": "1162880"
  },
  {
    "text": "grouping attacks based on the diamond model then instead of listing out the infrastructure and",
    "start": "1162880",
    "end": "1168640"
  },
  {
    "text": "capabilities of the attack in a really really long sentence you give it a name so the names can",
    "start": "1168640",
    "end": "1176000"
  },
  {
    "text": "represent various activity groups specific to your org you can use this to prioritize",
    "start": "1176000",
    "end": "1182240"
  },
  {
    "text": "intelligence products you create for other teams",
    "start": "1182240",
    "end": "1187440"
  },
  {
    "text": "then you can get the ttps for the various threat activity groups and throw them into mitre attacks",
    "start": "1188559",
    "end": "1194559"
  },
  {
    "text": "navigator to see what overlaps then from here you can prioritize those techniques for",
    "start": "1194559",
    "end": "1201200"
  },
  {
    "text": "purple exercises hunt activities adversary emulation and more",
    "start": "1201200",
    "end": "1207440"
  },
  {
    "text": "you can also use other internal sources for the adversary detection pipelines such as incident data internal monitoring",
    "start": "1207440",
    "end": "1216320"
  },
  {
    "text": "intel vendors and sharing groups oceant and publicly available threat",
    "start": "1216320",
    "end": "1222240"
  },
  {
    "text": "reports white papers and pretty much anything else in the public domain can also be used to supplement and build",
    "start": "1222240",
    "end": "1229600"
  },
  {
    "text": "out adversary detection pipelines so here's an example if you know an apt",
    "start": "1229600",
    "end": "1235679"
  },
  {
    "text": "is targeting other companies in your vertical through private intel sharing groups you",
    "start": "1235679",
    "end": "1241360"
  },
  {
    "text": "can then look at public reporting to offset any gaps in your knowledge",
    "start": "1241360",
    "end": "1248400"
  },
  {
    "text": "so i break down the data into structured and unstructured formats based upon",
    "start": "1248400",
    "end": "1253760"
  },
  {
    "text": "joshua stephen's 2015 rsec talk called hunting for the",
    "start": "1253760",
    "end": "1258960"
  },
  {
    "text": "undefined threat advanced analytics and visualization where basically the",
    "start": "1258960",
    "end": "1265039"
  },
  {
    "text": "unstructured format equals the undefined threat and new ttps and the",
    "start": "1265039",
    "end": "1270880"
  },
  {
    "text": "structured format equals searching known threats such as iocs ttps and real-time analysis",
    "start": "1270880",
    "end": "1279120"
  },
  {
    "text": "so there was already structured data in the form of email attack data iocs in public reports known ttps",
    "start": "1279120",
    "end": "1286400"
  },
  {
    "text": "but i hadn't addressed the unstructured nature of hypothesis-driven threat hunting",
    "start": "1286400",
    "end": "1293280"
  },
  {
    "text": "until i came across matt bromley's sans",
    "start": "1293280",
    "end": "1298960"
  },
  {
    "text": "analyst paper on thinking like a hunter implementing a threat hunting",
    "start": "1298960",
    "end": "1304080"
  },
  {
    "text": "program and he gave me the idea to reverse engineer hunt to determine what",
    "start": "1304080",
    "end": "1311440"
  },
  {
    "text": "they would need for their ct from their cti team so what you see is the result of my interpretation of",
    "start": "1311440",
    "end": "1318880"
  },
  {
    "text": "that paper from a cti perspective so you take a specific time frame with",
    "start": "1318880",
    "end": "1324480"
  },
  {
    "text": "known badness for a particular area of the network so hunt can form hypotheses",
    "start": "1324480",
    "end": "1330480"
  },
  {
    "text": "so you can do this by grouping for example email attack data or providing high level behaviors for",
    "start": "1330480",
    "end": "1337120"
  },
  {
    "text": "threat actors that were scanning your network for a specified quarter or even group",
    "start": "1337120",
    "end": "1342640"
  },
  {
    "text": "the threats other fi share for a specified time frame with the behaviors so hunt can hunt",
    "start": "1342640",
    "end": "1351919"
  },
  {
    "text": "you can also create thread actor dossiers based upon email attack data and incident tickets",
    "start": "1354080",
    "end": "1360000"
  },
  {
    "text": "these are helpful for sock to know who is targeting you helpful for red team emulation helpful",
    "start": "1360000",
    "end": "1366799"
  },
  {
    "text": "for purple team exercises and maybe even hunt to form hypotheses",
    "start": "1366799",
    "end": "1373360"
  },
  {
    "text": "you can measure and track what is going on in different areas of your org departments and people that are being",
    "start": "1373360",
    "end": "1380320"
  },
  {
    "text": "attacked you can track the various deliverables and projects using a gantt chart or whatever other",
    "start": "1380320",
    "end": "1386640"
  },
  {
    "text": "tracking means you have for all the initiatives and intelligence requirements you have",
    "start": "1386640",
    "end": "1392880"
  },
  {
    "text": "so to oversimplify the adversary detection pipelines they provide a prioritized workflow",
    "start": "1392880",
    "end": "1399679"
  },
  {
    "text": "based upon the attacks directed at the org through analysis performed by the cti analyst",
    "start": "1399679",
    "end": "1407520"
  },
  {
    "text": "it is the focused creation of intelligence based upon specific intelligence",
    "start": "1407520",
    "end": "1414159"
  },
  {
    "text": "requirements for the sole purpose of enriching other teams and improving the security",
    "start": "1414159",
    "end": "1420240"
  },
  {
    "text": "posture of the organization you can also do reports and metrics you",
    "start": "1420240",
    "end": "1427440"
  },
  {
    "text": "can trap purple team ops track hunt track gaps and i recommend also documenting",
    "start": "1427440",
    "end": "1433760"
  },
  {
    "text": "communication and procedural shifts as a result of implementing the adversary detection pipelines",
    "start": "1433760",
    "end": "1442559"
  },
  {
    "text": "so the use of business departmental and security team and cti initiatives to filter the",
    "start": "1443200",
    "end": "1450000"
  },
  {
    "text": "entire internet and look at three things so the email attack data",
    "start": "1450000",
    "end": "1455520"
  },
  {
    "text": "internal sources such as defer sock tickets monitoring private intel sharing groups",
    "start": "1455520",
    "end": "1461840"
  },
  {
    "text": "industry vertical private sharing groups intel vendors",
    "start": "1461840",
    "end": "1467200"
  },
  {
    "text": "and third open source reporting to produce actionable intelligence and create",
    "start": "1467200",
    "end": "1473919"
  },
  {
    "text": "an adversary detection pipeline for the blue red and purple teams to use to search",
    "start": "1473919",
    "end": "1480159"
  },
  {
    "text": "for badness to emulate the badness and better understand the org's controls",
    "start": "1480159",
    "end": "1486720"
  },
  {
    "text": "detection and response capabilities",
    "start": "1486720",
    "end": "1491440"
  },
  {
    "text": "oh and one more thing i'm going to show you how to tie",
    "start": "1491919",
    "end": "1498480"
  },
  {
    "text": "everything together with a practical example incorporating the cti departmental and",
    "start": "1498480",
    "end": "1504080"
  },
  {
    "text": "business initiatives for the adversary detection pipeline so let's say in the businesses annual",
    "start": "1504080",
    "end": "1511200"
  },
  {
    "text": "report x team is leading a program to form partnerships for a new incentives",
    "start": "1511200",
    "end": "1517520"
  },
  {
    "text": "program that is revenue generating for the org so keeping an eye on the department you",
    "start": "1517520",
    "end": "1524640"
  },
  {
    "text": "notice a campaign that is being sent specifically to those people associated with the project",
    "start": "1524640",
    "end": "1531279"
  },
  {
    "text": "purple just happens to have an exercise coming up and you know how important it is to the",
    "start": "1531279",
    "end": "1538400"
  },
  {
    "text": "org to support the revenue generating incentives programs so why not create a purple exercise out of",
    "start": "1538400",
    "end": "1546159"
  },
  {
    "text": "it so this is where psi's purple team exercise framework comes in and we'll",
    "start": "1546159",
    "end": "1551760"
  },
  {
    "text": "start at the cyber threat intelligence arrow we're also going to incorporate a threat",
    "start": "1551760",
    "end": "1558720"
  },
  {
    "text": "intelligence process for the purple teaming using eric van burgen out's threat intel",
    "start": "1558720",
    "end": "1564880"
  },
  {
    "text": "process so understanding the org adversary detection pipelines can help",
    "start": "1564880",
    "end": "1570000"
  },
  {
    "text": "you understand your org identify the adversary of course adversary detection pipelines",
    "start": "1570000",
    "end": "1577200"
  },
  {
    "text": "can help you identify and prioritize threats impacting your organization",
    "start": "1577200",
    "end": "1584480"
  },
  {
    "text": "so you noticed the targeted attacks to the people involved in the new revenue generating business",
    "start": "1584480",
    "end": "1590400"
  },
  {
    "text": "initiative through looking at the blocked email data that you are tracking as part of the adversary",
    "start": "1590400",
    "end": "1596799"
  },
  {
    "text": "detection pipeline oh and as a reminder for purple team exercises",
    "start": "1596799",
    "end": "1602720"
  },
  {
    "text": "you can use the threat actor heat maps to see the activity and prioritize purple team operations",
    "start": "1602720",
    "end": "1609360"
  },
  {
    "text": "based on delivery or even clicked messages and the associated ttps",
    "start": "1609360",
    "end": "1616720"
  },
  {
    "text": "you can also use the miter attack navigator to view all the ttps for your thread activity groups to help you",
    "start": "1617039",
    "end": "1623279"
  },
  {
    "text": "prioritize your purple team exercises also purple team exercises do not have to be",
    "start": "1623279",
    "end": "1631360"
  },
  {
    "text": "only about emulating behaviors of attacks in a specific sequence you can run exercises based upon",
    "start": "1631360",
    "end": "1639279"
  },
  {
    "text": "whatever works your org and your resources available",
    "start": "1639279",
    "end": "1644720"
  },
  {
    "text": "so you can supplement the email attack data with any incident data sharing group",
    "start": "1645120",
    "end": "1650960"
  },
  {
    "text": "intel or publicly available threat reports and of course open source reporting",
    "start": "1650960",
    "end": "1658080"
  },
  {
    "text": "so remember we are extracting the ttps to provide value to the org so that your security",
    "start": "1658480",
    "end": "1664960"
  },
  {
    "text": "team can look at the controls detection and response for all the stages of the attack path",
    "start": "1664960",
    "end": "1671039"
  },
  {
    "text": "for your organization so as you get further into this and",
    "start": "1671039",
    "end": "1677679"
  },
  {
    "text": "you you might want to get better at malware analysis and understanding what it is that you're looking at",
    "start": "1677679",
    "end": "1683279"
  },
  {
    "text": "coleman kane a phd candidate and senior cyber threat intelligence research analyst",
    "start": "1683279",
    "end": "1689440"
  },
  {
    "text": "has some great malware analysis materials also monapa ka",
    "start": "1689440",
    "end": "1696720"
  },
  {
    "text": "he's an information security investigator at cisco he has a great book called learning",
    "start": "1696720",
    "end": "1702399"
  },
  {
    "text": "malware analysis and in it he goes through and uses memory forensic techniques",
    "start": "1702399",
    "end": "1708799"
  },
  {
    "text": "to analyze malware to extract the behaviors it's a really good book i recommend it",
    "start": "1708799",
    "end": "1716000"
  },
  {
    "text": "so we're going to use mitre attacks tactics to guide the research and extraction of the ttps",
    "start": "1716000",
    "end": "1723200"
  },
  {
    "text": "and the process i used throughout this is i i looked at joe's sandbox and the miter",
    "start": "1723200",
    "end": "1728399"
  },
  {
    "text": "attack section then i looked at the joe sandbox specific entry in the report then i pivoted to",
    "start": "1728399",
    "end": "1736159"
  },
  {
    "text": "atomic red team for the technique then i looked at the yaml contents and whatever wasn't there i googled the",
    "start": "1736159",
    "end": "1743200"
  },
  {
    "text": "rest so also too for the purposes of this talk",
    "start": "1743200",
    "end": "1748320"
  },
  {
    "text": "i'm going to provide highlights of extracting ttps",
    "start": "1748320",
    "end": "1753840"
  },
  {
    "text": "so it's an email with an xe attachment and whether or not an org blocks exe",
    "start": "1754720",
    "end": "1760559"
  },
  {
    "text": "attachments what i'm interested in are the behaviors of these campaigns since they are targeting",
    "start": "1760559",
    "end": "1766080"
  },
  {
    "text": "people involved in a new revenue generating business initiative",
    "start": "1766080",
    "end": "1771360"
  },
  {
    "text": "so that is why we are taking an assumed breach approach",
    "start": "1771360",
    "end": "1776559"
  },
  {
    "text": "execution so when you look at the specific section of the malware report do your best to",
    "start": "1776559",
    "end": "1783039"
  },
  {
    "text": "get the specific campaigns that so that it can help adversary emulation",
    "start": "1783039",
    "end": "1789919"
  },
  {
    "text": "so for t1047 i couldn't find the atomic red team test that fit my use case initially",
    "start": "1789919",
    "end": "1797679"
  },
  {
    "text": "so then i had to do a bunch of googling and i found what i needed on stack overflow and it wasn't until later in this",
    "start": "1797679",
    "end": "1804720"
  },
  {
    "text": "exercise of extracting the ttps that i found an atomic test under a different technique name that",
    "start": "1804720",
    "end": "1812159"
  },
  {
    "text": "worked for my use case so keep in mind when you're building this out",
    "start": "1812159",
    "end": "1817200"
  },
  {
    "text": "to look at other techniques just in case privilege escalation so getting the",
    "start": "1817200",
    "end": "1824320"
  },
  {
    "text": "command line arguments are important i pivoted from joe sandbox to malware",
    "start": "1824320",
    "end": "1830080"
  },
  {
    "text": "bazaar found the sample and i looked it up to find any associated yara rules with",
    "start": "1830080",
    "end": "1835360"
  },
  {
    "text": "it and what i found was a yara rule from 2015 and it was still catching samples off",
    "start": "1835360",
    "end": "1840960"
  },
  {
    "text": "the command line argument so what this tells me is that i need to include this in the end report that i give to the other team",
    "start": "1840960",
    "end": "1848559"
  },
  {
    "text": "since it remained the same since 2015. it might change tomorrow but for now it",
    "start": "1848559",
    "end": "1854559"
  },
  {
    "text": "hasn't so there was a lot of defense evasion with this sample",
    "start": "1854559",
    "end": "1859679"
  },
  {
    "text": "and you want to try to include things in the ttp extraction that could be useful for defenders too",
    "start": "1859679",
    "end": "1867120"
  },
  {
    "text": "credentialed access they were trying to get the passwords from browsers collection they were trying to",
    "start": "1867120",
    "end": "1874480"
  },
  {
    "text": "get the mail client info command and control a really helpful tip is using the c2",
    "start": "1874480",
    "end": "1881760"
  },
  {
    "text": "matrix you can look at the specific ttps of the sample that you're extracting",
    "start": "1881760",
    "end": "1886960"
  },
  {
    "text": "and find the specifics and then look on the c2 matrix for something that will work for the address",
    "start": "1886960",
    "end": "1893600"
  },
  {
    "text": "for the purple team exercise so exfiltration this is a really good",
    "start": "1893600",
    "end": "1899039"
  },
  {
    "text": "place to consider how your org handles encrypted x fill as well as to understand how your",
    "start": "1899039",
    "end": "1906240"
  },
  {
    "text": "org handles x film in general well whether it's encrypted or not so sometimes uh you get lucky",
    "start": "1906240",
    "end": "1914399"
  },
  {
    "text": "and companies will share how the exfil happened during their data breach so knowing what you do at your org can",
    "start": "1914399",
    "end": "1921600"
  },
  {
    "text": "help you gauge where you're at also as a little side note i do not recommend using",
    "start": "1921600",
    "end": "1928000"
  },
  {
    "text": "real pii or credit card data for x filling",
    "start": "1928000",
    "end": "1933279"
  },
  {
    "text": "and testing and exercises i don't recommend it",
    "start": "1933279",
    "end": "1938480"
  },
  {
    "text": "so impact with this particular sample there doesn't seem to be destruction involved it's not ransomware",
    "start": "1938480",
    "end": "1944399"
  },
  {
    "text": "um it just seems like they're stealing credentials so once you extract the ttps you need to",
    "start": "1944399",
    "end": "1950399"
  },
  {
    "text": "analyze and organize the information and part of the purple team exercise framework provides a",
    "start": "1950399",
    "end": "1956640"
  },
  {
    "text": "template to collect all the ttp information it also provides suggestions on working",
    "start": "1956640",
    "end": "1962640"
  },
  {
    "text": "with other teams to decide which ttps to actually test in the purple team exercise so once the",
    "start": "1962640",
    "end": "1970000"
  },
  {
    "text": "ttps are decided upon teams can work together to create a plan",
    "start": "1970000",
    "end": "1976799"
  },
  {
    "text": "and emulate the adversary this is where the cti team waits for the rest of the phases of the",
    "start": "1976799",
    "end": "1982320"
  },
  {
    "text": "purple team exercise to complete so now you go back to the purple team",
    "start": "1982320",
    "end": "1988159"
  },
  {
    "text": "exercise framework from the threat intel process where the other team members finish up",
    "start": "1988159",
    "end": "1993440"
  },
  {
    "text": "the preparation for the purple team exercise and actually complete the exercise and",
    "start": "1993440",
    "end": "1999760"
  },
  {
    "text": "just so you know the cti analyst can attend the exercise as a spectator if",
    "start": "1999760",
    "end": "2004880"
  },
  {
    "text": "they want so the lessons learned phase of purple",
    "start": "2004880",
    "end": "2010080"
  },
  {
    "text": "of the purple team exercise is where cti analysts can learn even more about the organization",
    "start": "2010080",
    "end": "2016559"
  },
  {
    "text": "and take these insights back to the products they create for other teams so through this exercise you",
    "start": "2016559",
    "end": "2024320"
  },
  {
    "text": "saw a practical example of adversary detection pipelines you were able to determine that the",
    "start": "2024320",
    "end": "2031760"
  },
  {
    "text": "attacker is looking for browser and email passwords for these key people in your org that are involved with the",
    "start": "2031760",
    "end": "2038320"
  },
  {
    "text": "new revenue generating business initiative so through the purple team exercise you can find out",
    "start": "2038320",
    "end": "2045360"
  },
  {
    "text": "how easy it could be to get passwords from those particular users and the purple team exercise can also",
    "start": "2045360",
    "end": "2052560"
  },
  {
    "text": "help you look at your org's visibility controls detection and response",
    "start": "2052560",
    "end": "2058638"
  },
  {
    "text": "also consider if there is a site associated with the initiative that you can access off network",
    "start": "2058639",
    "end": "2065040"
  },
  {
    "text": "if so is 2fa enabled so you were able to support the business",
    "start": "2065040",
    "end": "2070878"
  },
  {
    "text": "initiatives and security team initiatives through understanding your internal attack landscape",
    "start": "2070879",
    "end": "2077118"
  },
  {
    "text": "with the cti initiatives the attackers basically don't need to get to full post",
    "start": "2077119",
    "end": "2083679"
  },
  {
    "text": "exploitation activities for cti analysts to get value out of the ttps that the attackers share",
    "start": "2083679",
    "end": "2091030"
  },
  {
    "text": "[Music] you also want to track your progress and the exercises so",
    "start": "2091030",
    "end": "2096960"
  },
  {
    "text": "roberto rodriguez the principal threat researcher at microsoft also known as",
    "start": "2096960",
    "end": "2102720"
  },
  {
    "text": "cyberwardog on twitter he has a great resource using excel for the miter attack navigator",
    "start": "2102720",
    "end": "2108960"
  },
  {
    "text": "and it's a heat map basically a tracking hunt activities hunting activities so you can apply the same techniques he",
    "start": "2108960",
    "end": "2116160"
  },
  {
    "text": "shared to your purple and adversary emulation exercises so beyond lessons learned",
    "start": "2116160",
    "end": "2125680"
  },
  {
    "text": "commit to intelligence driven purple team exercises use models frameworks processes to make",
    "start": "2125680",
    "end": "2132160"
  },
  {
    "text": "your life easier like miter attack diamond models c2 matrix pyramida pane",
    "start": "2132160",
    "end": "2138079"
  },
  {
    "text": "purple team exercise framework yara rules eric fan boogin outs threat intel",
    "start": "2138079",
    "end": "2143200"
  },
  {
    "text": "process and of course adversary detection pipelines",
    "start": "2143200",
    "end": "2148320"
  },
  {
    "text": "talk with your cti team and tell them what you need of course pick up a copy of the purple",
    "start": "2148320",
    "end": "2154640"
  },
  {
    "text": "team exercise framework and jorge archules the cto of scythe",
    "start": "2154640",
    "end": "2160000"
  },
  {
    "text": "put together a free workshop on purple team exercises so check that out",
    "start": "2160000",
    "end": "2168000"
  },
  {
    "text": "basically use all of your org's specific attack data including the block data to",
    "start": "2169280",
    "end": "2175760"
  },
  {
    "text": "analyze and create intelligence specific to your organization",
    "start": "2175760",
    "end": "2182960"
  },
  {
    "text": "so in this talk we filtered the entire internet through the business",
    "start": "2183040",
    "end": "2188960"
  },
  {
    "text": "department and security team and cti initiatives",
    "start": "2188960",
    "end": "2194320"
  },
  {
    "text": "we used email attack data internal sources and open source reporting to create",
    "start": "2194320",
    "end": "2199920"
  },
  {
    "text": "deliverables based on these initiatives i showed you a practical example of how",
    "start": "2199920",
    "end": "2205920"
  },
  {
    "text": "adversary detection pipelines would fit into a purple team exercise",
    "start": "2205920",
    "end": "2211119"
  },
  {
    "text": "using the purple team exercise framework so i hope the ideas shared with you today help you get more",
    "start": "2211119",
    "end": "2218960"
  },
  {
    "text": "out of your threat intel and finally make your threat intel useful to close some taylor swift wisdom",
    "start": "2218960",
    "end": "2228960"
  },
  {
    "text": "cti analysts can show you incredible things",
    "start": "2228960",
    "end": "2234960"
  },
  {
    "text": "thank you for your time this is my twitter linkedin and also the",
    "start": "2234960",
    "end": "2242320"
  },
  {
    "text": "bitly link again in case you didn't catch it and a special thanks to these people",
    "start": "2242320",
    "end": "2250160"
  },
  {
    "text": "thank you",
    "start": "2250400",
    "end": "2255599"
  }
]