[
  {
    "text": "um cues so different type of cues if you can do Q do Q uh Rec the packets when",
    "start": "1040",
    "end": "8440"
  },
  {
    "text": "you can um get get to know your Hardware really look at different type of cues",
    "start": "8440",
    "end": "13559"
  },
  {
    "text": "you have on your Hardware is it just like people qes different type of cues DW red based uh low latency cues uh how",
    "start": "13559",
    "end": "21800"
  },
  {
    "text": "do they do buffering how much memory do they have to me what's the Q size can you just contain 10 packets no and just",
    "start": "21800",
    "end": "28400"
  },
  {
    "text": "by looking at the Q size the different Q size and type of traffic going have you can then rever back and say okay I'm not",
    "start": "28400",
    "end": "34280"
  },
  {
    "text": "going to be able to cope with 2 gigs of traffic but only one.5 gig or whatever so this is something usually people",
    "start": "34280",
    "end": "40239"
  },
  {
    "text": "didn't used to do and believe me you really have to know it's really doing traffic engineering it's not just as",
    "start": "40239",
    "end": "46800"
  },
  {
    "text": "simple anymore as just put more bandar that was the I mean the answer some years ago to the quality of service and",
    "start": "46800",
    "end": "53359"
  },
  {
    "text": "the tax was just hard bandwidth it just through anymore so different things you you have to keep an eye on um also most",
    "start": "53359",
    "end": "61480"
  },
  {
    "text": "of the as I said in the beginning marketing slides or marketing presentation talk like I can support one",
    "start": "61480",
    "end": "66799"
  },
  {
    "text": "billion of packets per second yeah what's the size what's the destination is it going to me the forwarding path",
    "start": "66799",
    "end": "72240"
  },
  {
    "text": "isn't hitting the CPU so have a look at all this kind of information nobody used",
    "start": "72240",
    "end": "77320"
  },
  {
    "text": "to have a look at before and uh take it into account when you do the",
    "start": "77320",
    "end": "82880"
  },
  {
    "text": "design okay that was just the the easy part about the architecture I'm not going to go into more details you want",
    "start": "82880",
    "end": "88640"
  },
  {
    "text": "if you want more details you know differences between GSR 75 72 or whatever we can talk about that offline",
    "start": "88640",
    "end": "95880"
  },
  {
    "text": "um iOS um iOS is a basic yeah basic operating",
    "start": "95880",
    "end": "104240"
  },
  {
    "text": "system it's propri to it's close tools it's running on risk um it's more a port",
    "start": "104240",
    "end": "110399"
  },
  {
    "text": "of an old BSD than a fork so they change a lot of things in it but still uh most",
    "start": "110399",
    "end": "115680"
  },
  {
    "text": "of the birds hitting wellknown uh Unix based applications or libraries or",
    "start": "115680",
    "end": "121600"
  },
  {
    "text": "whatever are going to hit iOS Z Li hit iOS because they're using the same Z Li",
    "start": "121600",
    "end": "127280"
  },
  {
    "text": "SS HB because they're using a port from an old s 1.2. 25 or 26 all thep BD so you can be",
    "start": "127280",
    "end": "135360"
  },
  {
    "text": "sure that if you see a bug hitting a major Unix based application I saw it's",
    "start": "135360",
    "end": "141440"
  },
  {
    "text": "probably going to hit Cisco iOS because they may use it somewhere um I was quite",
    "start": "141440",
    "end": "146599"
  },
  {
    "text": "surprised like when the 10et Deb came out uh that the Tet debug didn't hit",
    "start": "146599",
    "end": "151879"
  },
  {
    "text": "cisq us I don't know why probably they Ed different one but still came really came out as a surprise um the format",
    "start": "151879",
    "end": "159200"
  },
  {
    "text": "they use is is the L format the all the Unix Unix guys know most signicant most",
    "start": "159200",
    "end": "164519"
  },
  {
    "text": "significant first to bit uh iOS is statically linked and strip so you just",
    "start": "164519",
    "end": "169640"
  },
  {
    "text": "running strings on it that's not going to give you any useful information um",
    "start": "169640",
    "end": "174879"
  },
  {
    "text": "then you're using ipcs IPC stands for interprocess communications uh between the the road processor and the line",
    "start": "174879",
    "end": "181000"
  },
  {
    "text": "cards on the GSR the the road processor is really the main part of the system",
    "start": "181000",
    "end": "186280"
  },
  {
    "text": "that keeps the system running line card is where the part is dealing with all the packet forwarding and all this kind",
    "start": "186280",
    "end": "192680"
  },
  {
    "text": "of stuff so they're using ipcs for that and something that is new to people were used to have like you run iOS on the box",
    "start": "192680",
    "end": "199920"
  },
  {
    "text": "and you just have to have IOS uh on the gsrs each line card is running a different micro code and micro code are",
    "start": "199920",
    "end": "206400"
  },
  {
    "text": "really getting complex because uh it's running first of all next to main iOS so it needs to be compatible with the main",
    "start": "206400",
    "end": "213000"
  },
  {
    "text": "iOS and also it's going to be feature dependent so the iOS you may the the",
    "start": "213000",
    "end": "218720"
  },
  {
    "text": "microc code you may be running uh on the edge if you need AC net flow it's it's not going to be the same micro code if",
    "start": "218720",
    "end": "224040"
  },
  {
    "text": "you need like U Qs and a FL or Qs in ACS and what's going to happen is if",
    "start": "224040",
    "end": "230040"
  },
  {
    "text": "somebody um managing the system has a good idea of on a system that was just doing like Qs and networ to put an ACL",
    "start": "230040",
    "end": "237519"
  },
  {
    "text": "on the interface Well the box is going to it's going to load the micro code that support AC and drop the other one",
    "start": "237519",
    "end": "243239"
  },
  {
    "text": "so you may have AC but you're not doing Qs anymore for example so and that happens and also when you do it you have",
    "start": "243239",
    "end": "250799"
  },
  {
    "text": "a small delay where the rout is doing nothing because you has to change a micro Cod so we have seen things like",
    "start": "250799",
    "end": "257120"
  },
  {
    "text": "ISP doing attack they were using like I don't know that's a Q Net putting yeah",
    "start": "257120",
    "end": "263440"
  },
  {
    "text": "cool I'm an ACL and they were using uh input AC uh output ACL that you should never use so it loaded the the output HL",
    "start": "263440",
    "end": "271800"
  },
  {
    "text": "code and dropped the input HL code so that means you are just filtering to one destination but you the rest of network",
    "start": "271800",
    "end": "277520"
  },
  {
    "text": "was wide open to attacks and you only realize it when you have a people look at you say yeah micro load is the one",
    "start": "277520",
    "end": "283440"
  },
  {
    "text": "for the output ACS and you don't have input ACS anymore so that's the thing you usually learn the hard way um",
    "start": "283440",
    "end": "290639"
  },
  {
    "text": "another part I I put on some slides already two years ago it's an except from inside Cisco iOS from Cisco press",
    "start": "290639",
    "end": "297160"
  },
  {
    "text": "it's just some details on how iOS is being design I was even quite surprised that they put that in book so um iOS the",
    "start": "297160",
    "end": "304840"
  },
  {
    "text": "design from IOS is basically done so that everything that needs to be all the operations that need to be in the Box",
    "start": "304840",
    "end": "311759"
  },
  {
    "text": "are focused on delivering the packets as soon as possible so that means there's no memory protection everything that",
    "start": "311759",
    "end": "318360"
  },
  {
    "text": "every process in the Box being in bgp tet SNMP whatever is running in the same space no it has all the rights you can",
    "start": "318360",
    "end": "325440"
  },
  {
    "text": "you know you can if one process dies usually the Box reloads because you know it just gives the memory whatever there's no memory protection U",
    "start": "325440",
    "end": "332280"
  },
  {
    "text": "everything has really the same there's no there's no ring zero ring three level that you're use in all systems really",
    "start": "332280",
    "end": "338120"
  },
  {
    "text": "everything is rning the same space so is they're trying to change that um I can",
    "start": "338120",
    "end": "343199"
  },
  {
    "text": "only tell you one thing go to see the talk on EIC on on iOS so you're going to understand when you have just I don't",
    "start": "343199",
    "end": "348960"
  },
  {
    "text": "know talking about the tftp server B uh when you just need one hole and you can",
    "start": "348960",
    "end": "354160"
  },
  {
    "text": "just play with the box so um in the new iOS is are trying to",
    "start": "354160",
    "end": "359840"
  },
  {
    "text": "kind of had some memory management memory Protection Systems and also when the process dies that only the process",
    "start": "359840",
    "end": "365600"
  },
  {
    "text": "dies and the watch watch dog brings it back up for example doesn't kill the whole box but it just means that if you",
    "start": "365600",
    "end": "373280"
  },
  {
    "text": "find a hole in one one of the applications on in the Box you own the box if you if you man to get if you",
    "start": "373280",
    "end": "379240"
  },
  {
    "text": "manage to get in not not uh make it reboot because you know you're just overwriting too much the T in the Heap",
    "start": "379240",
    "end": "386960"
  },
  {
    "text": "but uh you know so they're trying to change that and they were also looking",
    "start": "386960",
    "end": "392880"
  },
  {
    "text": "to come up or have it with iOS andg so talk about it um what what helps them",
    "start": "392880",
    "end": "399440"
  },
  {
    "text": "protect that is there's no real local tool to play interact with the system",
    "start": "399440",
    "end": "404800"
  },
  {
    "text": "while it when it's running so you cannot go like on a Unix or Windows system and say uh copy that application launch that",
    "start": "404800",
    "end": "411120"
  },
  {
    "text": "application um the kernel is uh like the lest SC in the beginning I want take big",
    "start": "411120",
    "end": "416560"
  },
  {
    "text": "con everything runs there you can just i f PT FP application and since say run",
    "start": "416560",
    "end": "421680"
  },
  {
    "text": "application that doesn't work so you can just play around with tools you are running on the system so on a running",
    "start": "421680",
    "end": "429280"
  },
  {
    "text": "system you have you have a local GDB on system and you can GDB the curently itself or do GDB PID and process number",
    "start": "429280",
    "end": "437560"
  },
  {
    "text": "of I don't know bgp or any process but usually it tends to crash quite fast and",
    "start": "437560",
    "end": "442879"
  },
  {
    "text": "it takes 6 minutes or depending on the hardware like between two and six minutes to boot again so I mean I don't",
    "start": "442879",
    "end": "448919"
  },
  {
    "text": "know how many times EIC pan waiting for for his CCO to boot when he's doing test probably quite most of the time so um",
    "start": "448919",
    "end": "456720"
  },
  {
    "text": "there's also another GDB in the romm that means when the books uh the Box boots you can break it or break the the",
    "start": "456720",
    "end": "464800"
  },
  {
    "text": "boot sequence and in Roman you also have a GDB uh to play with but it's way more",
    "start": "464800",
    "end": "470440"
  },
  {
    "text": "limited and you still need to boot some of the things and play some of things so you can you can do some playing but",
    "start": "470440",
    "end": "476159"
  },
  {
    "text": "don't expect like to run ada8 Pro on on Cisco box um on the Catalyst there's a special",
    "start": "476159",
    "end": "482919"
  },
  {
    "text": "Mode called enable engineer where you have uh you need to know how to get in but then you can really do whatever you",
    "start": "482919",
    "end": "489639"
  },
  {
    "text": "like with the Box including breaking it completely that means one boot again send back to Cisco every made um and",
    "start": "489639",
    "end": "496199"
  },
  {
    "text": "usually when you do that you send it back they know what you did so so uh just you can do you have also",
    "start": "496199",
    "end": "503319"
  },
  {
    "text": "special thing on on the r with iOS which you need a special copie to get in but same again you know you can break read",
    "start": "503319",
    "end": "510120"
  },
  {
    "text": "Hardware you can change everything you need and uh you're you're done but if you're going to go to the talk eics talk",
    "start": "510120",
    "end": "516719"
  },
  {
    "text": "just asking how many box you break I don't know um you what what you cannot do also",
    "start": "516719",
    "end": "524320"
  },
  {
    "text": "quite easily what that is changing is upload a modified iOS and start start it",
    "start": "524320",
    "end": "530800"
  },
  {
    "text": "without repoting the box like using the the Linx two can Monty approach uh but",
    "start": "530800",
    "end": "536240"
  },
  {
    "text": "what you can do is on most of the of the gsrs you have two raw processors on most",
    "start": "536240",
    "end": "541600"
  },
  {
    "text": "of the Broadband concentrators like for DSL type of Customs or cable you also have two main bards so just easily you",
    "start": "541600",
    "end": "550279"
  },
  {
    "text": "upload a new iOS or if you can get in the Box you change the iOS of the standby car and you just s the system",
    "start": "550279",
    "end": "555560"
  },
  {
    "text": "switch from active or passive to active from backup to active and that happens without losing any PPP or E session or",
    "start": "555560",
    "end": "562720"
  },
  {
    "text": "whatever so you're not changing the running iOS but using you know the fact that you have rant system to a problem",
    "start": "562720",
    "end": "568519"
  },
  {
    "text": "using and nobody's going to see it ever uh the only thing I don't know is I haven't had a chance to look at is like",
    "start": "568519",
    "end": "574839"
  },
  {
    "text": "if the SNMP CS for the interface are also kept in memory or if you get if they get back to Z so we would see some",
    "start": "574839",
    "end": "581240"
  },
  {
    "text": "peaks in some kind of traffic but that would be like I mean seeing it would only be using a side effects of changing",
    "start": "581240",
    "end": "589920"
  },
  {
    "text": "the the main to the backup or backup to main so that that's one of the ways of doing it uh the other thing is it's not",
    "start": "589920",
    "end": "596720"
  },
  {
    "text": "easy to produce an iOS because you need the source and well it's not the wrong",
    "start": "596720",
    "end": "601839"
  },
  {
    "text": "officially um and you need an iOS that's going to support the features you need you have that's one of the crazy things",
    "start": "601839",
    "end": "608800"
  },
  {
    "text": "with iOS like you have 37 different type of feature sets and Cisco is maintaining",
    "start": "608800",
    "end": "615320"
  },
  {
    "text": "2,500 different images in the wheel so in a while so you know if you know before that that",
    "start": "615320",
    "end": "624079"
  },
  {
    "text": "IP is running 1207 St st3 a whatever on the box and you can produce the same one",
    "start": "624079",
    "end": "630640"
  },
  {
    "text": "and upload it well then Pro nobody's going to notice it no chance but you need to know before but if you take like",
    "start": "630640",
    "end": "636279"
  },
  {
    "text": "an Enterprise image that I don't know doesn't see well no a normal IP image doesn't see but SSH and IP using SSH",
    "start": "636279",
    "end": "643680"
  },
  {
    "text": "when you change iOS is working anymore you know so that's that's also one of the things that make makes exploitation",
    "start": "643680",
    "end": "650040"
  },
  {
    "text": "quite complex um Cisco was saying like already two years ago that they were working on something called iOS Next",
    "start": "650040",
    "end": "656240"
  },
  {
    "text": "Generation and they going had something which is quite interesting is like with L you start with the mon you",
    "start": "656240",
    "end": "661480"
  },
  {
    "text": "can you have modules so they're going to do the same thing and it was the goal was to reduce the number of feature sets",
    "start": "661480",
    "end": "667920"
  },
  {
    "text": "and only load like ATM code if you have ATM interfaces I mean who needs ATM interface or code in in memory and using",
    "start": "667920",
    "end": "674800"
  },
  {
    "text": "memory if you don't have ATM interfaces for example I know same if you have I know one is Qs Qs don't Qs or whatever",
    "start": "674800",
    "end": "684079"
  },
  {
    "text": "so that would be one of the things of loading your own piece of code and running it but but they are still not to",
    "start": "684079",
    "end": "690279"
  },
  {
    "text": "the point there there some Alpha code around have been told but no not to the point where they're going to replace any",
    "start": "690279",
    "end": "696440"
  },
  {
    "text": "in any of the next iOS releases uh the existing iOS we know with this iOS Next Generation supporting",
    "start": "696440",
    "end": "704200"
  },
  {
    "text": "modules okay um ACS in the core kind of one1 uh you guys are probably used",
    "start": "704200",
    "end": "712079"
  },
  {
    "text": "depending I most of you probably running Cisco Hardware of some kind you have the normal kind of EX in the ACLS that you",
    "start": "712079",
    "end": "718639"
  },
  {
    "text": "can use a norm iOS with the IP IP plus feature set or using iOS firewall that",
    "start": "718639",
    "end": "724680"
  },
  {
    "text": "is included also in the lowend devices so this kind of normal extended ACL",
    "start": "724680",
    "end": "729720"
  },
  {
    "text": "where you can fter Source destination P type of photoc so on um are fine uh for",
    "start": "729720",
    "end": "736440"
  },
  {
    "text": "home usage so to say um each ACL I mean",
    "start": "736440",
    "end": "742079"
  },
  {
    "text": "in ACL you have each time you have an AC an entry and if you start for each",
    "start": "742079",
    "end": "747399"
  },
  {
    "text": "packet that has to be processed and go up the ACL pass it's going to compare it to each AC you have in the ACL so if you",
    "start": "747399",
    "end": "754079"
  },
  {
    "text": "have one packet entering and your ACL is like 20 Aces it's going to do 20 comparisons if you have 100 it's going",
    "start": "754079",
    "end": "759880"
  },
  {
    "text": "to do 100 for each packet so it's just fine at home with low boundaries but in the core or gar me you just activate it",
    "start": "759880",
    "end": "767519"
  },
  {
    "text": "and the Box dies it's like probably you can cope up to like a few mags of band Wheels if you have like less than 10 AC",
    "start": "767519",
    "end": "774639"
  },
  {
    "text": "AC in ACL but that's it so since the kn",
    "start": "774639",
    "end": "779720"
  },
  {
    "text": "for ACLS came back um Cisco Implement something they called sometime turbo ACS",
    "start": "779720",
    "end": "786040"
  },
  {
    "text": "the new name is compelled ACLS so what they are doing for U they're taking the ACLS looking at all the Aces and",
    "start": "786040",
    "end": "793440"
  },
  {
    "text": "generating a binary tree so the number of lookups you have to do for each packet is constant is five it's five",
    "start": "793440",
    "end": "799040"
  },
  {
    "text": "lookups so you can have AC like with 100 entries the lookup time what number of",
    "start": "799040",
    "end": "804079"
  },
  {
    "text": "CPU Cycles you're going to need uh is going to be fixed but it still needs",
    "start": "804079",
    "end": "809639"
  },
  {
    "text": "uh Asic Cy lot of documentation saying yeah CPU impact is zero yeah right but",
    "start": "809639",
    "end": "815440"
  },
  {
    "text": "you know the Asic still has to do the five cycles per packet so that was one",
    "start": "815440",
    "end": "820720"
  },
  {
    "text": "of the things of doing it then we found out that well on the engine zero this is software based so compared AC engine",
    "start": "820720",
    "end": "828680"
  },
  {
    "text": "zero means normal ACM it's basically set so all the new types like engine ones",
    "start": "828680",
    "end": "834839"
  },
  {
    "text": "and more recent ones um support real compiled ACR to the the only issue is",
    "start": "834839",
    "end": "840079"
  },
  {
    "text": "that if you have gig the 3 G three times G interface with Engine 2 the micro code",
    "start": "840079",
    "end": "846040"
  },
  {
    "text": "doesn't support ACLS so lots of peing points or hosting censors use that to deliver gig services to customers while",
    "start": "846040",
    "end": "852639"
  },
  {
    "text": "you can filter so but this is being fixed um and as I said uh before you",
    "start": "852639",
    "end": "858959"
  },
  {
    "text": "have a big difference between using input and output AC on the interface um the recommendation is never ever use",
    "start": "858959",
    "end": "866000"
  },
  {
    "text": "output ACS uh all the hardware is being designed to deal with packet",
    "start": "866000",
    "end": "872120"
  },
  {
    "text": "entering the Box not leaving the box so all the operations are really happening on the incoming on the Ingress pass and",
    "start": "872120",
    "end": "878360"
  },
  {
    "text": "not on the Ingress pass um and you have an output a report on the GSR for",
    "start": "878360",
    "end": "884279"
  },
  {
    "text": "example but in fact the box is generating an input ACL in all the interfaces so if you have new AC in one",
    "start": "884279",
    "end": "891360"
  },
  {
    "text": "of the interfaces and you have like 20 interfaces on the 19th Au interface you're going to have an hidden input ACL",
    "start": "891360",
    "end": "898880"
  },
  {
    "text": "with which you know you may forget you don't take into account when you do looking at the CPU cycle CPU load or",
    "start": "898880",
    "end": "904240"
  },
  {
    "text": "whatever so keep that in mind also input ACL um it's compiled and not hitting the",
    "start": "904240",
    "end": "911560"
  },
  {
    "text": "CPU only if you don't use port filtering",
    "start": "911560",
    "end": "917560"
  },
  {
    "text": "PA",
    "start": "951120",
    "end": "954120"
  },
  {
    "text": "amaz to change to 448 but that's going to eat memory because it's going to reserve the memory",
    "start": "985800",
    "end": "991560"
  },
  {
    "text": "when it boots and then what happens oh your bgp and your fit set tape doesn't fit anymore and the bo box isn't R",
    "start": "991560",
    "end": "998480"
  },
  {
    "text": "anymore so you Mo back to 128 and you put again and you you have downtime",
    "start": "998480",
    "end": "1004000"
  },
  {
    "text": "again again so people are saying yeah easy just upgrade the memory on the on the line",
    "start": "1004000",
    "end": "1009399"
  },
  {
    "text": "cards on the engines well you can't it's fixed so usually the 44 the 44",
    "start": "1009399",
    "end": "1017120"
  },
  {
    "text": "448 atce limits nobody can use it in real production environments so you're",
    "start": "1017120",
    "end": "1023680"
  },
  {
    "text": "really stuck with 12 128 um I don't know if they're going to do something like in",
    "start": "1023680",
    "end": "1029678"
  },
  {
    "text": "between so as I mentioned in the beginning filtering you you should do filtering at the edge filtering at the",
    "start": "1029679",
    "end": "1036918"
  },
  {
    "text": "core is is just really a killer you're not going to survive it and you're going to have problems like it's going to work",
    "start": "1036919",
    "end": "1042520"
  },
  {
    "text": "on the normal operation and then you lose a link and packets are coming where on a way on a PA you didn't expect the",
    "start": "1042520",
    "end": "1048600"
  },
  {
    "text": "packet the come and you're going to drop them so do do it at the edge and as I",
    "start": "1048600",
    "end": "1053960"
  },
  {
    "text": "said it really implies that have really structured address plan otherwise it's just you're going to hit a limit you're",
    "start": "1053960",
    "end": "1059520"
  },
  {
    "text": "going to miss one you're going to do miss typing you're going to filter whatever out so make sure the the other",
    "start": "1059520",
    "end": "1064880"
  },
  {
    "text": "space or other Str you have rest structure um at the r level",
    "start": "1064880",
    "end": "1069960"
  },
  {
    "text": "um basic stuff filter out the uh your core address space to avoid spoofing",
    "start": "1069960",
    "end": "1076840"
  },
  {
    "text": "like you know UDP sessionless the one of things of the the SNP attack was not that critically if you filtering problem",
    "start": "1076840",
    "end": "1082960"
  },
  {
    "text": "you know if somebody knew the which acl's allow UDP packets to 161",
    "start": "1082960",
    "end": "1091280"
  },
  {
    "text": "UDP on the box you just put them inject them from the network in your network so if you don't don't do anti proofing of",
    "start": "1091280",
    "end": "1097280"
  },
  {
    "text": "the core at the edge you just have no chance um and Cisco also in the in the",
    "start": "1097280",
    "end": "1102960"
  },
  {
    "text": "new IRS came up a new feature called the receive ACL feature before you had to apply on each interface and ACL to fil",
    "start": "1102960",
    "end": "1110600"
  },
  {
    "text": "the traffic hitting the the rou so now with the IP receive ACL just do one and",
    "start": "1110600",
    "end": "1116039"
  },
  {
    "text": "applies it at the RO processor level so it's kind of virtually on all interfaces and makes things much much more easy um",
    "start": "1116039",
    "end": "1123720"
  },
  {
    "text": "the next thing when you the filtering when you activate ACLS or change ACLS uh",
    "start": "1123720",
    "end": "1128760"
  },
  {
    "text": "check if you didn't change a micro code that is loaded uh check the CPU usage because if if you have a heat on CPU",
    "start": "1128760",
    "end": "1134480"
  },
  {
    "text": "something must be wrong with some of the acss and keep in mind you have two c use the main one in the one of the line",
    "start": "1134480",
    "end": "1140679"
  },
  {
    "text": "cards and usually people are forgetting the one of the line card um recol the packets if you do Q",
    "start": "1140679",
    "end": "1147000"
  },
  {
    "text": "record the packets to the kind of um class of service you want and don't let",
    "start": "1147000",
    "end": "1152919"
  },
  {
    "text": "people just use the best class of service from outside if they're not paying for it um filter space to the",
    "start": "1152919",
    "end": "1158320"
  },
  {
    "text": "core and next thing is filter the bons um next to blacking them the bogons is U",
    "start": "1158320",
    "end": "1165240"
  },
  {
    "text": "or the IP space that are not yet allocated by r are in UPN to customers",
    "start": "1165240",
    "end": "1171280"
  },
  {
    "text": "well you shouldn't see them um Harbor or some studies of Harbor call that a dark IP space me you shouldn't see such",
    "start": "1171280",
    "end": "1178120"
  },
  {
    "text": "packets so just drop them and uh there you're going to get close to",
    "start": "1178120",
    "end": "1185320"
  },
  {
    "text": "trouble because if you f all the bogons you call because some customers with 12 128 you know is you know you probably",
    "start": "1185320",
    "end": "1192240"
  },
  {
    "text": "going to have 110 or whatever so you only have 15 left and when you need them you know sometimes you have to get rid",
    "start": "1192240",
    "end": "1199280"
  },
  {
    "text": "of some other AC is really not easy okay",
    "start": "1199280",
    "end": "1205480"
  },
  {
    "text": "uh water configuration before you go live like on any system turn off all the",
    "start": "1205480",
    "end": "1211320"
  },
  {
    "text": "services you don't need uh iOS in for the current iOS is bit like any rad",
    "start": "1211320",
    "end": "1216440"
  },
  {
    "text": "Windows whatever system up have everything that is just available that's running so turn off what you don't need",
    "start": "1216440",
    "end": "1223919"
  },
  {
    "text": "um I have the link to to some other slides that I called protect new IP network structure um on the last slide",
    "start": "1223919",
    "end": "1229559"
  },
  {
    "text": "you can have a look at slides 44 and and and following um you have all the commands you need to turn off by default",
    "start": "1229559",
    "end": "1236520"
  },
  {
    "text": "um in 12.3 Cisco is coming up with not secure strip it's doing more the same thing and local accounting that's really",
    "start": "1236520",
    "end": "1243120"
  },
  {
    "text": "broken uh will also support XML format would make passing much easier but keep in mind don't keep logs local on the",
    "start": "1243120",
    "end": "1249880"
  },
  {
    "text": "system reboot means they are gone or somebody gets in they can erase them so",
    "start": "1249880",
    "end": "1256200"
  },
  {
    "text": "find the right mix between what you need to log and you pull up the box without killing the CPU it means use C log use",
    "start": "1256200",
    "end": "1263559"
  },
  {
    "text": "SNMP but don't don't don't polarize NP every second or every two seconds you",
    "start": "1263559",
    "end": "1269280"
  },
  {
    "text": "usually every minute or every two minutes is more than enough um like with anything on for six you know use and use",
    "start": "1269280",
    "end": "1276440"
  },
  {
    "text": "ntp to make sure you something crazy usually it's you know you have something R what's the time difference okay you",
    "start": "1276440",
    "end": "1282559"
  },
  {
    "text": "just switching three okay that was two hours ago that was three hours ago you know just make sure you use ntp to to",
    "start": "1282559",
    "end": "1287720"
  },
  {
    "text": "some extent run CIS log uh on the box if you don't run CIS loog you have local buffer but local buffer is side limited",
    "start": "1287720",
    "end": "1294440"
  },
  {
    "text": "new entries when it's full drop old entries so make sure you export things uh make sure that for ospf bgp and",
    "start": "1294440",
    "end": "1301559"
  },
  {
    "text": "everything you can generate logs when things happen like uh for bgp when neighbor uh neighbor State change for",
    "start": "1301559",
    "end": "1308080"
  },
  {
    "text": "OPF when uh some like the bdrs DRS or whatever things change is really",
    "start": "1308080",
    "end": "1313679"
  },
  {
    "text": "important all the information you want log is gone and when you have some problems you you just are it's black you",
    "start": "1313679",
    "end": "1319559"
  },
  {
    "text": "know don't see anything not races um make sure you send S&M PS on some of the",
    "start": "1319559",
    "end": "1324760"
  },
  {
    "text": "major changes uh P but not too much and if you can use AAA use the central",
    "start": "1324760",
    "end": "1331120"
  },
  {
    "text": "radius of T system to do the authentication accounting and don't just",
    "start": "1331120",
    "end": "1336320"
  },
  {
    "text": "use local password you know not the type type seven type of password or being it",
    "start": "1336320",
    "end": "1341360"
  },
  {
    "text": "for usernames or enable pass 457 you can reverse it it's just encoding it's not",
    "start": "1341360",
    "end": "1346840"
  },
  {
    "text": "encrypted so at least you type file which is nd5 based or better use Central",
    "start": "1346840",
    "end": "1352600"
  },
  {
    "text": "the Tria system um again net flow is the basic",
    "start": "1352600",
    "end": "1358799"
  },
  {
    "text": "thing you want to use in export things uh you don't need to use commercial Solutions uh to to analyze the data just",
    "start": "1358799",
    "end": "1365279"
  },
  {
    "text": "taking like flow scan argu or whatever or the GPL tool is going to work if if you blow B is going to generate like",
    "start": "1365279",
    "end": "1371360"
  },
  {
    "text": "tons of blogs the accounting logs to day uh you can also have the box automatically generate a codom and",
    "start": "1371360",
    "end": "1377720"
  },
  {
    "text": "crashes another upload of FTP the the core file to C system issue is uh when",
    "start": "1377720",
    "end": "1384240"
  },
  {
    "text": "it reboots and uploads the file the box is not coming back up until he has finished uploading the core file so uh",
    "start": "1384240",
    "end": "1391159"
  },
  {
    "text": "depending on the network architecture May might not be a problem because you may have a backup pass if not U upgrading a core image and a GSR may",
    "start": "1391159",
    "end": "1398360"
  },
  {
    "text": "take up to 10 minutes so take that into account when you do that uh put ACLS",
    "start": "1398360",
    "end": "1404919"
  },
  {
    "text": "first of all for filtering traffic into your car but also traffic hitting your being it using the IP receive ACL",
    "start": "1404919",
    "end": "1411559"
  },
  {
    "text": "feature or for Access Control like don't leave SNMP tet SSH whatever open to the",
    "start": "1411559",
    "end": "1416799"
  },
  {
    "text": "world put an an application AC on it and try to be quite restrictive um another thing you have in",
    "start": "1416799",
    "end": "1422840"
  },
  {
    "text": "the box is the contact register that regist is going to Define how the BX should behave when the re Boots the",
    "start": "1422840",
    "end": "1428760"
  },
  {
    "text": "normal uh setup is 212 that means when on Crush just reload and restop if you",
    "start": "1428760",
    "end": "1434080"
  },
  {
    "text": "put just four time zero on Crush it's going to reload and stop and where wait on a console until you telling or",
    "start": "1434080",
    "end": "1440720"
  },
  {
    "text": "continue to boot so that's one of the ways of fighting against FX the thing is",
    "start": "1440720",
    "end": "1446159"
  },
  {
    "text": "if the box is far away and you don't have any out of band thing me you're going to take your car and usually it's",
    "start": "1446159",
    "end": "1452240"
  },
  {
    "text": "4:00 in the morning on Saturday so keep that in mind and if somebody",
    "start": "1452240",
    "end": "1457360"
  },
  {
    "text": "gets into the box and H you can change it so it's something you can just configure uh the skid is the system uh",
    "start": "1457360",
    "end": "1464080"
  },
  {
    "text": "that's going to allocate time to packet processing process switching whatever so by default the values should fit for",
    "start": "1464080",
    "end": "1470000"
  },
  {
    "text": "more for most of you if you got some P per second attacks you may have to T the SC but that's not kind of",
    "start": "1470000",
    "end": "1476559"
  },
  {
    "text": "usual another thing to fight what eix is doing is to use debug sanity uh that",
    "start": "1476559",
    "end": "1482320"
  },
  {
    "text": "thing tells the box that on every met of memory allocation or freeing of memory to check what happens and to do a clean",
    "start": "1482320",
    "end": "1489760"
  },
  {
    "text": "allocation and uh freeing there's a performance impact but it may save you against some of the of EIC overflows but",
    "start": "1489760",
    "end": "1497399"
  },
  {
    "text": "you know just working the lab like two magn band afterwards do it",
    "start": "1497399",
    "end": "1503240"
  },
  {
    "text": "less okay uh R configuration I'm already time no five minutes it should be okay",
    "start": "1503240",
    "end": "1509120"
  },
  {
    "text": "so as I said um export what you can CIS log SNMP AAA colums netflow whatever uh",
    "start": "1509120",
    "end": "1517120"
  },
  {
    "text": "the Box basically needs when it boots on on that part you can boot over DP bootp",
    "start": "1517120",
    "end": "1523520"
  },
  {
    "text": "you can FTP the configuration if you want to uh you can even have t T FP the",
    "start": "1523520",
    "end": "1529000"
  },
  {
    "text": "iOS on boot so if somebody breaks in it it could just tell the Box you know Boot",
    "start": "1529000",
    "end": "1534240"
  },
  {
    "text": "and tftp the configuration and the the iOS image from my server not from your server so I can just easily tell you",
    "start": "1534240",
    "end": "1541240"
  },
  {
    "text": "boot with a broken image or program configuration change configuration or",
    "start": "1541240",
    "end": "1546720"
  },
  {
    "text": "whatever um things running uh stored as being stored locally or remotely uh",
    "start": "1546720",
    "end": "1552799"
  },
  {
    "text": "locally uh being in Flash nram or Dam so running iOS then get start running",
    "start": "1552799",
    "end": "1558720"
  },
  {
    "text": "configuration running configuration is just the copy it's just a copy of the Startup configuration when Boots and you",
    "start": "1558720",
    "end": "1565559"
  },
  {
    "text": "can do all the changes that means when you configure the Box all the changes happen on in the running configuration",
    "start": "1565559",
    "end": "1570960"
  },
  {
    "text": "and as long as you don't write running into starter it's not going to be St for the next reboot and then yeah on D you have as I",
    "start": "1570960",
    "end": "1578760"
  },
  {
    "text": "said all the local logs history ring information that was just kind of a generic",
    "start": "1578760",
    "end": "1584679"
  },
  {
    "text": "reminder integrated checking you can do a basic trip fire for rollers uh kind of",
    "start": "1584679",
    "end": "1590240"
  },
  {
    "text": "easy find a simple place to S the things and make sure the place is secure and not just a box sitting on the net not",
    "start": "1590240",
    "end": "1595679"
  },
  {
    "text": "fire world and open CDs open tftp or whatever uh you can use any Pearl X",
    "start": "1595679",
    "end": "1602320"
  },
  {
    "text": "whatever type of script to uh get the configuration and put into some place do",
    "start": "1602320",
    "end": "1607360"
  },
  {
    "text": "a CVS D stor it uh you can also if you use an SNP rri Community which is really",
    "start": "1607360",
    "end": "1613640"
  },
  {
    "text": "not recommended is tell from your nms system to the box please upload your configuration to that system but that",
    "start": "1613640",
    "end": "1619960"
  },
  {
    "text": "really means you have to open a rri community which you should never ever use in a system uh and then check the CH",
    "start": "1619960",
    "end": "1628120"
  },
  {
    "text": "or have a look at the changes you can do that automatically like once a day you know what has Chang and I report it uh",
    "start": "1628120",
    "end": "1634240"
  },
  {
    "text": "when you see in the log file that somebody change a configuration uh or when you get of SNP that change",
    "start": "1634240",
    "end": "1640080"
  },
  {
    "text": "configuration trap or configuration change trap or whatever and then you can use whatever tools you have or use to",
    "start": "1640080",
    "end": "1645679"
  },
  {
    "text": "like we're using CVS but you can use you could use C walks R SE your own tools per script to do to do a diff and find",
    "start": "1645679",
    "end": "1652360"
  },
  {
    "text": "out what Chang is happening that's really basic thing to do um there are some limitations of course uh you still",
    "start": "1652360",
    "end": "1658880"
  },
  {
    "text": "have to trust the network uh most of the things you'll be running is you know clear text interet I",
    "start": "1658880",
    "end": "1664360"
  },
  {
    "text": "mean I don't know how many of you are using sshing into your Cisco devices or using IPC between the management system",
    "start": "1664360",
    "end": "1670519"
  },
  {
    "text": "and the Cisco devices but probably like 90 95% of 10 that so you have to trust",
    "start": "1670519",
    "end": "1675919"
  },
  {
    "text": "the network and you have to see to trust iOS or C on the switches or the rers there's no Cisco Rock yet I mean at",
    "start": "1675919",
    "end": "1683039"
  },
  {
    "text": "least it's kind of publicly known if there's any so you can see TR us what's going on there",
    "start": "1683039",
    "end": "1689760"
  },
  {
    "text": "um keep in mind there are two files start and running so if you guy just Chang the running and you just check",
    "start": "1689760",
    "end": "1694960"
  },
  {
    "text": "check startup well okay next weot he will be out but in the meantime you won't see anything um if we use the the",
    "start": "1694960",
    "end": "1702360"
  },
  {
    "text": "SNP R Community The Cisco me is called Cisco confit D something so uh have a",
    "start": "1702360",
    "end": "1708720"
  },
  {
    "text": "look at it and also keep copies or MP5 SS of the iOS and C images because you",
    "start": "1708720",
    "end": "1714519"
  },
  {
    "text": "may change the image and mean can you can produce easily a file with same size",
    "start": "1714519",
    "end": "1719640"
  },
  {
    "text": "same CSC because it's just Tak CSC you know it has been well known for years that cs32 you can get around it so uh do",
    "start": "1719640",
    "end": "1727039"
  },
  {
    "text": "md5 SS of the images when you have an incident and that's going to be the last part of the",
    "start": "1727039",
    "end": "1733480"
  },
  {
    "text": "talk um make uh the right decisions and make",
    "start": "1733480",
    "end": "1739880"
  },
  {
    "text": "sure you took the decision like before the incident happening that means have an incident response process somewhere",
    "start": "1739880",
    "end": "1745480"
  },
  {
    "text": "or some documentation say you have to do that that that and that um because first of all depending on the network",
    "start": "1745480",
    "end": "1751120"
  },
  {
    "text": "architecture mean you can you won't be able to do forensics because if you do it I mean the box is gone and you don't",
    "start": "1751120",
    "end": "1756880"
  },
  {
    "text": "have connectivity for quite some time and what usually happens if use a system that the guy seees something with wrong",
    "start": "1756880",
    "end": "1762600"
  },
  {
    "text": "just that just reinstalled and so all the evidence is gone but the system is back up and hopefully nobody see that",
    "start": "1762600",
    "end": "1768480"
  },
  {
    "text": "something WR in the meantime so you you w't have roing recording um if you have some spare Hardware I mean just change a",
    "start": "1768480",
    "end": "1775880"
  },
  {
    "text": "hardware take the motorboard hour keep the flash disc or this kind of things so this is something you should have",
    "start": "1775880",
    "end": "1781039"
  },
  {
    "text": "prepared in advance uh I can only recommend when you connect to the Box use sale Port as as soon as you t s it's",
    "start": "1781039",
    "end": "1788159"
  },
  {
    "text": "going to change the environment of the Box you know you going to have a new VTR you can to have a new log entries or whatever the the side effects of using",
    "start": "1788159",
    "end": "1794960"
  },
  {
    "text": "the serial or console Port is really lower uh do all the things you can before you",
    "start": "1794960",
    "end": "1801320"
  },
  {
    "text": "reboot because most of the things will beun after reboot so if the guy is not stupid is going to keepi you out of the",
    "start": "1801320",
    "end": "1807559"
  },
  {
    "text": "box I mean he going to make sure you won't be able to connect to the box and then uh you're going to have trouble",
    "start": "1807559",
    "end": "1812960"
  },
  {
    "text": "because the only information you going to have is is will depend on what you cont the Box before or the login if you",
    "start": "1812960",
    "end": "1819399"
  },
  {
    "text": "didn't have any login and you all the Box you're dead so if that happens to",
    "start": "1819399",
    "end": "1824720"
  },
  {
    "text": "you uh at least you any the andap the Box try to SNP work it maybe forgot to",
    "start": "1824720",
    "end": "1831399"
  },
  {
    "text": "remove SNMP access um depending on the network environment if you have some switches somewhere just you do a span",
    "start": "1831399",
    "end": "1837760"
  },
  {
    "text": "port or Mir port and switch and get all the data that enters and leaves the box if if the guy connected to it and you",
    "start": "1837760",
    "end": "1843880"
  },
  {
    "text": "don't have a search you're probably using 10et so you may be able to you know find out what the resource is and what he's currently doing on the box so",
    "start": "1843880",
    "end": "1851440"
  },
  {
    "text": "but that's really going to depend if you have switch if just just have point to point STM 4M 16s well you're going to",
    "start": "1851440",
    "end": "1857000"
  },
  {
    "text": "have hard time doing any any packet DS",
    "start": "1857000",
    "end": "1862120"
  },
  {
    "text": "so this is not really easy on on the next page you have some of the commands you should use to to have a look or to",
    "start": "1862120",
    "end": "1869440"
  },
  {
    "text": "get some data about what's going on um same thing when you use I don't know hyp terminal here whatever to the box or any",
    "start": "1869440",
    "end": "1877080"
  },
  {
    "text": "uni ter make sure you log everything type and everything was screen I mean how many times have you been behind a",
    "start": "1877080",
    "end": "1883519"
  },
  {
    "text": "guy I'm coming like oh yeah s that information triy to go up you know with scrolling bar and but have 20 lines and",
    "start": "1883519",
    "end": "1889799"
  },
  {
    "text": "all the rest is gone too bad so you make sure you save your session it's really important um don't enter configuration",
    "start": "1889799",
    "end": "1896760"
  },
  {
    "text": "mode because configuration mode is really changing a lot of things in the environment and usually when you're doing forensics you don't need to change",
    "start": "1896760",
    "end": "1902039"
  },
  {
    "text": "the configuration so avoid doing con or configure terminal whatever um the other",
    "start": "1902039",
    "end": "1907600"
  },
  {
    "text": "thing is if the guy like I said is not stupid you probably kicked you out of the box or made sure you won't be able",
    "start": "1907600",
    "end": "1912639"
  },
  {
    "text": "to access enable mode enable mode is like root and unic system or administrator on Windows we have all the",
    "start": "1912639",
    "end": "1918039"
  },
  {
    "text": "right and the user exact mode is just basic model you can do lot things you can just do some show commands but all",
    "start": "1918039",
    "end": "1924639"
  },
  {
    "text": "the the key information won't be available so most of the commands are just you know half the time the version",
    "start": "1924639",
    "end": "1931639"
  },
  {
    "text": "the copies of the configuration show users going to show you uh who is connected uh show log is going to show",
    "start": "1931639",
    "end": "1937600"
  },
  {
    "text": "you the local login and show stack context uh you can understand a little bit more in the afternoon if you're",
    "start": "1937600",
    "end": "1943000"
  },
  {
    "text": "going to see FX talk about all the stack and memory information uh same for the process",
    "start": "1943000",
    "end": "1948399"
  },
  {
    "text": "show text report is usually a recommended command because everybody see it's show show text report is",
    "start": "1948399",
    "end": "1954399"
  },
  {
    "text": "basically a script that runs most of the commands but it's removing all the",
    "start": "1954399",
    "end": "1959639"
  },
  {
    "text": "passwords so the password is just going to be removed you're going to have password or SNP Community you just have",
    "start": "1959639",
    "end": "1965200"
  },
  {
    "text": "have community and you won't have the real thing so show text report is not the best thing to do when you're doing",
    "start": "1965200",
    "end": "1970519"
  },
  {
    "text": "front six because you won't have all the information all the password you may have changed communi may have changed you have all the network information you",
    "start": "1970519",
    "end": "1976919"
  },
  {
    "text": "know the routes being it igp like uspf bgp CDP neighbors sometimes quite",
    "start": "1976919",
    "end": "1983120"
  },
  {
    "text": "interesting CDP is the Cisco discover protocol like can easily find out you know what kind of iOS is running what",
    "start": "1983120",
    "end": "1989000"
  },
  {
    "text": "kind of PE do they have um of if it's local attack all the",
    "start": "1989000",
    "end": "1994639"
  },
  {
    "text": "TCP sessions the IP net translations the local net cash if you don't export the",
    "start": "1994639",
    "end": "2000120"
  },
  {
    "text": "net information the currently connected SNMP users if you use SNMP three and so",
    "start": "2000120",
    "end": "2005960"
  },
  {
    "text": "on um you also have the file system level two kind of uh lsf and file like",
    "start": "2005960",
    "end": "2012840"
  },
  {
    "text": "commands if you're used to them in uni systems the first one is show file descript is really it's going to give you some basic lsf related information",
    "start": "2012840",
    "end": "2020519"
  },
  {
    "text": "and show file information the file name is going to do tell you know it is it is a configuration file an iOS and so on so",
    "start": "2020519",
    "end": "2026760"
  },
  {
    "text": "I can see some strange files in the flash well this is the easy way to find",
    "start": "2026760",
    "end": "2032399"
  },
  {
    "text": "out the the other one is uh for the flash memory is to take the flash card",
    "start": "2032399",
    "end": "2037960"
  },
  {
    "text": "out and put it into your PC for for your laptops and Unix there's a tool called Cisco flash that enables you to read",
    "start": "2037960",
    "end": "2044399"
  },
  {
    "text": "this the Cisco flash C and see if the guy changed some some of the files and try to hide some files it's um basically",
    "start": "2044399",
    "end": "2051040"
  },
  {
    "text": "like a little bit like the fat system you know when you're a file it's not really erased it's just Mark that's being erased so if you didn't squeeze",
    "start": "2051040",
    "end": "2057878"
  },
  {
    "text": "delete format or whatever you still have some evidence um what is recommended to",
    "start": "2057879",
    "end": "2063398"
  },
  {
    "text": "sometimes with some of the forensics guide is to do debugging like you do debug what whatever but most of guys",
    "start": "2063399",
    "end": "2069679"
  },
  {
    "text": "that have ever doing done any operation C device like deug mode the Kil one like",
    "start": "2069679",
    "end": "2075839"
  },
  {
    "text": "you do debug IP packet details whatever and you press enter and say oh okay",
    "start": "2075839",
    "end": "2081398"
  },
  {
    "text": "probably that so uh when you do debugging uh all the thing you debug uh",
    "start": "2081399",
    "end": "2086878"
  },
  {
    "text": "going to change to process switching or process CPU whatever more and well if",
    "start": "2086879",
    "end": "2092118"
  },
  {
    "text": "it's a lowend device yeah it just may crash but if it's GSR or or major Ro",
    "start": "2092119",
    "end": "2098320"
  },
  {
    "text": "you're going to have thr because it may crush and not even reload so debugging whatever is really kind of last res if",
    "start": "2098320",
    "end": "2106040"
  },
  {
    "text": "you know you can just do theug all and maybe in all the things going have all information you may have some evidence",
    "start": "2106040",
    "end": "2112200"
  },
  {
    "text": "but don't count on it I would say uh as I said from memory the BS the memory",
    "start": "2112200",
    "end": "2117800"
  },
  {
    "text": "regions and so on EIC going to talk about it um you can also find out if somebody changed the default Startup",
    "start": "2117800",
    "end": "2124320"
  },
  {
    "text": "configuration mode by using the show boot bar so you can see if is still running the the local information or the",
    "start": "2124320",
    "end": "2130839"
  },
  {
    "text": "local configuration and iOS or if he getting everything from remote that's also kind of",
    "start": "2130839",
    "end": "2137160"
  },
  {
    "text": "interesting okay uh environments these are the most important things but make sure you did",
    "start": "2137160",
    "end": "2143400"
  },
  {
    "text": "all the right things when you did the installation keep the application logs and have a look at them everything you have in CIS loog TXS your nms strange",
    "start": "2143400",
    "end": "2150920"
  },
  {
    "text": "SNP responses whatever have a look at them um also try to find out if you see",
    "start": "2150920",
    "end": "2156200"
  },
  {
    "text": "some Strange Behaviors in the Network like side effect of the change the guy may have done uh a road changing a busp",
    "start": "2156200",
    "end": "2163359"
  },
  {
    "text": "pass changing all the kind of things or different or the type of traffic if you're doing some traffic profiling um",
    "start": "2163359",
    "end": "2169119"
  },
  {
    "text": "if you have a chance to run an ideas of some sort somewhere you know try to get some Network traces um if you don't have",
    "start": "2169119",
    "end": "2175400"
  },
  {
    "text": "access to the Box anymore you know use a span port on a switch a mirror port to to get some of the things have a look at",
    "start": "2175400",
    "end": "2181319"
  },
  {
    "text": "at the netf export that's quite important and if you happen to have inline devices or tabs for non ethernet",
    "start": "2181319",
    "end": "2188839"
  },
  {
    "text": "things like s s links or whatever that's also quite useful sometimes but it's",
    "start": "2188839",
    "end": "2194000"
  },
  {
    "text": "only usually you only have that when the network is more on large scale Network you usually don't have any inline device",
    "start": "2194000",
    "end": "2199760"
  },
  {
    "text": "have on on a large scale um the general recommendation but that's forensics uh in general do R",
    "start": "2199760",
    "end": "2206800"
  },
  {
    "text": "document and date every single step you did what you did because if you want to use that you know code or whatever you",
    "start": "2206800",
    "end": "2212119"
  },
  {
    "text": "know you should be able to prove what you've done and that you didn't you know change the evidence by doing the forensic stuff",
    "start": "2212119",
    "end": "2218319"
  },
  {
    "text": "and use autof fan Communications as much as you can uh most of the isps have",
    "start": "2218319",
    "end": "2224280"
  },
  {
    "text": "autof fan to local RS but not the one sitting in New York or whatever whever so Auto band is it's a thing you should",
    "start": "2224280",
    "end": "2231359"
  },
  {
    "text": "have but i' I've seen a lot of network out of band is just you know not",
    "start": "2231359",
    "end": "2236960"
  },
  {
    "text": "available okay um that was it I hope I gave you just I think it should be yeah",
    "start": "2236960",
    "end": "2243000"
  },
  {
    "text": "little bit of a Time an update on dos so dos you can protect you can mitigate um",
    "start": "2243000",
    "end": "2250440"
  },
  {
    "text": "there's there's this solution that fixes everything doesn't exist yet and I don't",
    "start": "2250440",
    "end": "2256040"
  },
  {
    "text": "think it's going to ever happen you know people saying yeah you should secure the internet use IPv6 to authenticate every",
    "start": "2256040",
    "end": "2261200"
  },
  {
    "text": "packet you secure bgp or whatever you know that's not going to happen in the next 5 years and it's only fixing or H",
    "start": "2261200",
    "end": "2267160"
  },
  {
    "text": "part is only fixing part of the problem and uh the problem itself cannot be S because in some of the countries some of",
    "start": "2267160",
    "end": "2273520"
  },
  {
    "text": "the regions you will never able to to import like filtering uh filtering at the edge for every customer which will",
    "start": "2273520",
    "end": "2279960"
  },
  {
    "text": "solve IP proofing so you know this this is GNA this is not going to be solved",
    "start": "2279960",
    "end": "2285359"
  },
  {
    "text": "and we're still going to have like probably some hard times fighting the deas attacks uh water Fric is still",
    "start": "2285359",
    "end": "2291280"
  },
  {
    "text": "quite new s s information saying that you you should be able to plan that if you have an instant response plan for",
    "start": "2291280",
    "end": "2297800"
  },
  {
    "text": "all the other systems make sure you include instant response for for rers because it's it's getting abused and I",
    "start": "2297800",
    "end": "2304240"
  },
  {
    "text": "don't know how many I've seen you can tell it to it you see login well Cisco password Cisco enable enable enter and",
    "start": "2304240",
    "end": "2310760"
  },
  {
    "text": "you're in uh even on ISP or on ISP or t backbone so you know forensics and",
    "start": "2310760",
    "end": "2316599"
  },
  {
    "text": "forensics preparation or forensic Readiness what I used to call it is really important so uh I changed like",
    "start": "2316599",
    "end": "2324160"
  },
  {
    "text": "some one slide of the presentation would be anyway online on Blackout website I'm going to put a copy like probably next",
    "start": "2324160",
    "end": "2329359"
  },
  {
    "text": "week on sec.org and and Below you have the links to the two presentation and",
    "start": "2329359",
    "end": "2334880"
  },
  {
    "text": "the second one in that one you have all the basic commands you should use like to turn off the services you don't need",
    "start": "2334880",
    "end": "2340160"
  },
  {
    "text": "and hard Harden Cisco box by default okay some",
    "start": "2340160",
    "end": "2346520"
  },
  {
    "text": "questions yeah do the uh the attacking Bots use the IP address or do they view",
    "start": "2346520",
    "end": "2353240"
  },
  {
    "text": "the have you seen different types uh usually the question is other BS using the IP address to attack on DNS lups",
    "start": "2353240",
    "end": "2360200"
  },
  {
    "text": "usually just IP address so you won't have the DNS Lookout before to find out what came from okay so my my point is is",
    "start": "2360200",
    "end": "2365920"
  },
  {
    "text": "there any defense by having DNS server that they can lie two IP address ranges I don't think",
    "start": "2365920",
    "end": "2373119"
  },
  {
    "text": "so because most of the commands we have seen when the agent or the MJ Master agent tells to the Bots to attack they",
    "start": "2373119",
    "end": "2378720"
  },
  {
    "text": "give the IP address or the IP range or whatever usually not the name can can you switch the customers with other IP",
    "start": "2378720",
    "end": "2385000"
  },
  {
    "text": "address continue to attack the the old oh yeah that that's one of the things but depending on you have changing IP",
    "start": "2385000",
    "end": "2390880"
  },
  {
    "text": "address in one system and updating DNS is one thing but you have the TTL you need to expire the TTL on zone so and",
    "start": "2390880",
    "end": "2396960"
  },
  {
    "text": "usually you know TTL is usually one or two days on most of the zones when you're not prepared so well it's way but",
    "start": "2396960",
    "end": "2403359"
  },
  {
    "text": "usually the attack doesn't last two days so what would be one of the approaches but uh you should be have like the TTI",
    "start": "2403359",
    "end": "2410000"
  },
  {
    "text": "really low like one or two minutes that and usually don't do it but that we want the wa and you the end system needs to",
    "start": "2410000",
    "end": "2415400"
  },
  {
    "text": "support it doing it on one server is usually easy if you have cell PHS That Base whatever just have no",
    "start": "2415400",
    "end": "2422359"
  },
  {
    "text": "chance another question okay if you have some other questions since I going out of time just",
    "start": "2422359",
    "end": "2428520"
  },
  {
    "text": "do that offline thank [Applause]",
    "start": "2428520",
    "end": "2437739"
  },
  {
    "text": "you can I get an there oh yeah sure",
    "start": "2443440",
    "end": "2449800"
  },
  {
    "text": "room here yeah yes sound",
    "start": "2453000",
    "end": "2458400"
  },
  {
    "text": "okay thanks I'm",
    "start": "2458400",
    "end": "2461559"
  },
  {
    "text": "using e",
    "start": "2486240",
    "end": "2490280"
  },
  {
    "text": "the real problem with with Windows is that it's it's generally used by people",
    "start": "2524160",
    "end": "2529440"
  },
  {
    "text": "who are not very smart and out of those people come the group of Windows hackers",
    "start": "2529440",
    "end": "2536000"
  },
  {
    "text": "and so generally do not in public get to see the best of the best sort of",
    "start": "2536000",
    "end": "2541599"
  },
  {
    "text": "exploitation techniques still about pretty mature in terms of exploitation in a while",
    "start": "2541599",
    "end": "2548280"
  },
  {
    "text": "uh there's I just list a few things that are not basic so you can see that there",
    "start": "2548280",
    "end": "2553440"
  },
  {
    "text": "is some space to explore in this area um fixing a heap after an overflow occurred",
    "start": "2553440",
    "end": "2559000"
  },
  {
    "text": "when a heap overflow happens uh and then connect to it and you want to make win 32 calls in your gel code it becomes",
    "start": "2559000",
    "end": "2566280"
  },
  {
    "text": "very difficult because some of these calls actually do things like Mal 3 and unless you prepared the Heep they're",
    "start": "2566280",
    "end": "2571640"
  },
  {
    "text": "going to fail presumably not the way you want finding good locations that are",
    "start": "2571640",
    "end": "2576839"
  },
  {
    "text": "right I think um there's you know there's a lot of well-known locations for function corins in Unix and",
    "start": "2576839",
    "end": "2584680"
  },
  {
    "text": "specialist Solaris and Linux in terms of Windows uh it's a big gray ball some",
    "start": "2584680",
    "end": "2590440"
  },
  {
    "text": "people use a second Handler some people use fun point and I hand of like decom",
    "start": "2590440",
    "end": "2596040"
  },
  {
    "text": "hand but everyone has their own take on that uh multiple overrides I think uh",
    "start": "2596040",
    "end": "2602760"
  },
  {
    "text": "Brett Mo New Zealander has been pushing exploits around circles where he",
    "start": "2602760",
    "end": "2609599"
  },
  {
    "text": "actually does m rights with you know his standard e well well what what you do",
    "start": "2609599",
    "end": "2615280"
  },
  {
    "text": "with that is then the next question so I think a lot of these these sorts of issues are still being",
    "start": "2615280",
    "end": "2621119"
  },
  {
    "text": "explored um next slot a",
    "start": "2621119",
    "end": "2627960"
  },
  {
    "text": "while okay so I think uh some of the other things are writing Shell Code I",
    "start": "2630640",
    "end": "2636240"
  },
  {
    "text": "think probably two years ago um people all realized in Pary or less fuel hair",
    "start": "2636240",
    "end": "2643440"
  },
  {
    "text": "or not more depending on how smart you like and uh get the address of L Library",
    "start": "2643440",
    "end": "2650319"
  },
  {
    "text": "a and get prop address and from there you can write fa reliable portable Windows shell Cod still tend to be",
    "start": "2650319",
    "end": "2656319"
  },
  {
    "text": "rather large but at least it's it's not going to rely on service pack or special",
    "start": "2656319",
    "end": "2661599"
  },
  {
    "text": "function points um why they're called the direction because you're going to be",
    "start": "2661599",
    "end": "2667240"
  },
  {
    "text": "doing Windows you really don't have a system call interface you need the interface",
    "start": "2667240",
    "end": "2672440"
  },
  {
    "text": "for Library call and be able to do this dynamically um and of course the the the",
    "start": "2672440",
    "end": "2678079"
  },
  {
    "text": "big Achilles heel of Windows has always been their use of tokens and multiple",
    "start": "2678079",
    "end": "2684520"
  },
  {
    "text": "security contexts within a given process which is a idea and I'm sure",
    "start": "2684520",
    "end": "2689880"
  },
  {
    "text": "they're learning this slowly but um the every Windows server is the same",
    "start": "2689880",
    "end": "2696839"
  },
  {
    "text": "thing really it just spreads off impersonates a user based on username and password or perhaps if you're using",
    "start": "2696839",
    "end": "2703000"
  },
  {
    "text": "SSL it goes to LSS and ask elas if it can have a token and then it",
    "start": "2703000",
    "end": "2708480"
  },
  {
    "text": "impersonates it SP thread with that impersonated token and now for all FES",
    "start": "2708480",
    "end": "2713520"
  },
  {
    "text": "and purposes the actual thread is running as someone else which means that",
    "start": "2713520",
    "end": "2719119"
  },
  {
    "text": "when you compromise the thread you have multiple security contexts to play with you have your own you have that of the",
    "start": "2719119",
    "end": "2726280"
  },
  {
    "text": "primary the the main primary token and you have that of every other impersonated thread in your process all",
    "start": "2726280",
    "end": "2733160"
  },
  {
    "text": "sharing the same data space so this is not lost but uh few people understand it",
    "start": "2733160",
    "end": "2740800"
  },
  {
    "text": "including those Microsoft uh BC RPC exploitation uh is BC RPC itself no one",
    "start": "2740800",
    "end": "2747839"
  },
  {
    "text": "understands I don't think anyone in the world actually understands that protocol which is great for us because we live in",
    "start": "2747839",
    "end": "2752960"
  },
  {
    "text": "the cracks but in terms of uh PR find Superior system and probably not the",
    "start": "2752960",
    "end": "2759880"
  },
  {
    "text": "best uh and also Unicode spring exploitation as OS has become more Unicode friendly they're they're going",
    "start": "2759880",
    "end": "2767200"
  },
  {
    "text": "to uh definitely have different filters and SLI it's in both because that's the one we're going to look at this",
    "start": "2767200",
    "end": "2774559"
  },
  {
    "text": "dead Okay so uh unic code okay here's here's the problem which I think is is",
    "start": "2774559",
    "end": "2781800"
  },
  {
    "text": "common to Windows not so much to Unix but still in Unix which is that you have",
    "start": "2781800",
    "end": "2787400"
  },
  {
    "text": "a process and I have is here for this the essential Lage process but any any",
    "start": "2787400",
    "end": "2792760"
  },
  {
    "text": "other server will do and it tends to do something very similar which is taking a string from the network convert it to",
    "start": "2792760",
    "end": "2799200"
  },
  {
    "text": "unic code and then pass it over via RPC to a different process in in is they",
    "start": "2799200",
    "end": "2806240"
  },
  {
    "text": "they do D host right there a d host process running around with all the asps loaded all the all the DS loaded like KP",
    "start": "2806240",
    "end": "2814160"
  },
  {
    "text": "or anything else you have en and and so the actual overflow can occur in a",
    "start": "2814160",
    "end": "2820359"
  },
  {
    "text": "process that doesn't have any socket handle for you to steal in case you want to steal a socket handle and maintain a",
    "start": "2820359",
    "end": "2826599"
  },
  {
    "text": "connection and doesn't have your original string in it anyway because it all got converted in in the first",
    "start": "2826599",
    "end": "2833240"
  },
  {
    "text": "process so and I think probably there was a lot of confusion because initially",
    "start": "2833240",
    "end": "2838559"
  },
  {
    "text": "when unic code started becoming very popular people would call anything that had anything to do with Unicode a sort",
    "start": "2838559",
    "end": "2843880"
  },
  {
    "text": "of Unicode specific explo and then you go look at it and they were using maybe one like string in memory with unic code",
    "start": "2843880",
    "end": "2851040"
  },
  {
    "text": "but there were like dozens of strings everywhere that were not or instead of unic code it was actually getting precon",
    "start": "2851040",
    "end": "2856839"
  },
  {
    "text": "converted on the client and the client was sending a unic code buffer and this is what happened to say the locator",
    "start": "2856839",
    "end": "2862680"
  },
  {
    "text": "buffer right you send a unic code buffer over and it copies with WCS you know copy Square copy or",
    "start": "2862680",
    "end": "2869520"
  },
  {
    "text": "whatever and but you get to control every bite in string which is not a",
    "start": "2869520",
    "end": "2874920"
  },
  {
    "text": "filter to test okay so we are going to say just you're",
    "start": "2874920",
    "end": "2881960"
  },
  {
    "text": "going to take my word for it that UniFi is going is very popular in places that perhaps you don't know about and and as",
    "start": "2881960",
    "end": "2890000"
  },
  {
    "text": "all the low paying frof get picked off people are going to use the actual protocols that Windows",
    "start": "2890000",
    "end": "2895480"
  },
  {
    "text": "supports which natively Windows sort very dcpc is kind of the back with dcpc",
    "start": "2895480",
    "end": "2902760"
  },
  {
    "text": "uses unic so we're going to use the back of Windows to do their their transports",
    "start": "2902760",
    "end": "2909760"
  },
  {
    "text": "and it's uh it's not always possible to use QT tricks to sort of get to that backend process repr processes down the",
    "start": "2909760",
    "end": "2917000"
  },
  {
    "text": "line where the actual overflow is going to be and I think code read this the",
    "start": "2917000",
    "end": "2922760"
  },
  {
    "text": "send UT trick would you know was a breakthrough we can actually specify any kind of data we want but that's not",
    "start": "2922760",
    "end": "2928760"
  },
  {
    "text": "always possible so I think I think that is why with this presentation help",
    "start": "2928760",
    "end": "2934599"
  },
  {
    "text": "things I wanted to at the ntpl since no one seems to know what it is um you",
    "start": "2934599",
    "end": "2942119"
  },
  {
    "text": "can't you can't use the percent Ed stuff with the ntpl just the unit of string but you can",
    "start": "2942119",
    "end": "2947960"
  },
  {
    "text": "specify you know a string that does overflow a current R and it's of this format which I'm going to just a a and",
    "start": "2947960",
    "end": "2954920"
  },
  {
    "text": "BB are just two numbers that you get specify uh but the zeros are inserted to",
    "start": "2954920",
    "end": "2960280"
  },
  {
    "text": "in the conversion and uh it's it's actually a pretty nice entry to unit",
    "start": "2960280",
    "end": "2965680"
  },
  {
    "text": "code exploitation because your Flur corly on info which means you're running a",
    "start": "2965680",
    "end": "2971000"
  },
  {
    "text": "system and you have the socket handle and you have a lot of other stuff in memory that you can look at and it's a",
    "start": "2971000",
    "end": "2977440"
  },
  {
    "text": "big process and unfortunately in at least the US bill there's no text segments",
    "start": "2977440",
    "end": "2983599"
  },
  {
    "text": "that are mapped to uh nice areas and most most solutions just guess and jump",
    "start": "2983599",
    "end": "2990040"
  },
  {
    "text": "into the Heap",
    "start": "2990040",
    "end": "2993400"
  },
  {
    "text": "okay so this is the first demo and I just want to show you the uh web devb exploit which I bring for canvas and",
    "start": "2997960",
    "end": "3006280"
  },
  {
    "text": "there's going to be a few differences between jump into the Heat and the way this does it",
    "start": "3006280",
    "end": "3013119"
  },
  {
    "text": "[Music]",
    "start": "3014090",
    "end": "3017229"
  },
  {
    "text": "[Music] C this is the product I sell",
    "start": "3030720",
    "end": "3037720"
  },
  {
    "text": "it's but uh basically it's it's a little p dpk goey over some exploits uh one of",
    "start": "3037720",
    "end": "3044359"
  },
  {
    "text": "the exploits is the web da exploit and to demonstrate what's going",
    "start": "3044359",
    "end": "3050920"
  },
  {
    "text": "on we going to log in and of Al buug which is in my opinion",
    "start": "3050920",
    "end": "3058799"
  },
  {
    "text": "the best Windows bugger for writing exploits in user",
    "start": "3058799",
    "end": "3064480"
  },
  {
    "text": "space this particular this is a Windows 2000 Service Pack 3 machine it does not",
    "start": "3066079",
    "end": "3072000"
  },
  {
    "text": "have the web dab patch on it although there's some fun things you can do even with that patch on it those of you with",
    "start": "3072000",
    "end": "3078520"
  },
  {
    "text": "Spike can feel free to explore um but the it also has Microsoft content",
    "start": "3078520",
    "end": "3086680"
  },
  {
    "text": "loaded on at an SQL Server [Music]",
    "start": "3086680",
    "end": "3098139"
  },
  {
    "text": "same ALB is free and it's fre downloadable so you can Google it",
    "start": "3100160",
    "end": "3105400"
  },
  {
    "text": "now it's not open source but have",
    "start": "3105400",
    "end": "3111359"
  },
  {
    "text": "everything that looks like on",
    "start": "3113040",
    "end": "3117680"
  },
  {
    "text": "it loads up all the DS we're going to maximize the vmw soon so that you can see what's going on what happens is I",
    "start": "3125559",
    "end": "3132799"
  },
  {
    "text": "run the explo of canvas the first time it it doesn't actually work I have a small bu person and the second time it",
    "start": "3132799",
    "end": "3139280"
  },
  {
    "text": "goes through and actually does exploit um we're going to look at that a little",
    "start": "3139280",
    "end": "3145760"
  },
  {
    "text": "bit closely not super closely don't [Music]",
    "start": "3145760",
    "end": "3159090"
  },
  {
    "text": "have all right so the option I picked here if you can't see it it says I",
    "start": "3159440",
    "end": "3165079"
  },
  {
    "text": "multiple versions of the exploit one is just a specific jump location for Windows sp3 one is do a Brute Force",
    "start": "3165079",
    "end": "3173440"
  },
  {
    "text": "which occasionally H us the unnecessary s shutting down the web",
    "start": "3173440",
    "end": "3179799"
  },
  {
    "text": "ser and the third version is a much more reliable um sort of jump location and",
    "start": "3179799",
    "end": "3187440"
  },
  {
    "text": "that's the one with",
    "start": "3187440",
    "end": "3190280"
  },
  {
    "text": "SH the target is 192 168 166",
    "start": "3198200",
    "end": "3203960"
  },
  {
    "text": "55 and like I said the first is just going to give us a bunch of error",
    "start": "3203960",
    "end": "3210799"
  },
  {
    "text": "messages and initialize Bunch DS on that",
    "start": "3211160",
    "end": "3216160"
  },
  {
    "text": "side seconds",
    "start": "3221480",
    "end": "3226200"
  },
  {
    "text": "dise that's that's we're going to start off with this demo and then we're going to kind of jump into the you can read",
    "start": "3230720",
    "end": "3237319"
  },
  {
    "text": "ahead a little bit you can we're going to jump into the sort of what unic code is and how to how to escape the kinds of",
    "start": "3237319",
    "end": "3243920"
  },
  {
    "text": "problems you see UN code want it to go away and we're going to kind of analyze",
    "start": "3243920",
    "end": "3249119"
  },
  {
    "text": "a Content server exploit but I wanted to show you this exploit as an example of something that people have been calling",
    "start": "3249119",
    "end": "3254760"
  },
  {
    "text": "a Unicode exploit which is actually",
    "start": "3254760",
    "end": "3258520"
  },
  {
    "text": "really this time it's going to break",
    "start": "3260200",
    "end": "3265040"
  },
  {
    "text": "take it off three again you see it's having B time",
    "start": "3273880",
    "end": "3280440"
  },
  {
    "text": "there oh everyone see that nice dat all right so this is what Alig Buck does",
    "start": "3283079",
    "end": "3289839"
  },
  {
    "text": "when an acception happen be a little yellow button and you can see this this is the stack over there this is the uh",
    "start": "3289839",
    "end": "3296880"
  },
  {
    "text": "sort of data window where you can change display the top is the uh current",
    "start": "3296880",
    "end": "3302200"
  },
  {
    "text": "threads sort of keep violation or assembly and over there are",
    "start": "3302200",
    "end": "3308440"
  },
  {
    "text": "[Music] registers can so if you look at the stack after",
    "start": "3308440",
    "end": "3314720"
  },
  {
    "text": "the after the Overflow you see a bunch of these are poins to our string which are set",
    "start": "3314720",
    "end": "3323200"
  },
  {
    "text": "up and this is the magic place right here there's a pointer to in in the way",
    "start": "3323200",
    "end": "3331720"
  },
  {
    "text": "Windows Works in C++ you say try then catch and the way Windows does that is",
    "start": "3331720",
    "end": "3337480"
  },
  {
    "text": "pushes pushes first a function pointer and then a pointer to the a list a list",
    "start": "3337480",
    "end": "3344680"
  },
  {
    "text": "to another function pointer call that section Handler record or something",
    "start": "3344680",
    "end": "3350960"
  },
  {
    "text": "like that so uh the SE Handler itself is is basically function poin sitting on",
    "start": "3350960",
    "end": "3356839"
  },
  {
    "text": "the stack which was a great way to escape early versions of their stack generary uh but now it is I think they",
    "start": "3356839",
    "end": "3363520"
  },
  {
    "text": "probably fix that so basically all you have to worry about is this is the this is basically",
    "start": "3363520",
    "end": "3369200"
  },
  {
    "text": "the return of rest that we've overr know really what we've done is overwritten an exception Handler and they've gone all",
    "start": "3369200",
    "end": "3375280"
  },
  {
    "text": "the way to the end of the stack which we're overwriting until an exception is caused by a seg by so we can look",
    "start": "3375280",
    "end": "3384799"
  },
  {
    "text": "at what's in 5 e4f and you'll see this nice tall dword",
    "start": "3384799",
    "end": "3391000"
  },
  {
    "text": "pointer d right CU everyone do that now the benefit about this is the ntll bug is",
    "start": "3391000",
    "end": "3399760"
  },
  {
    "text": "triggerable in about 80 different ways there's a billion ways to kind of get control of mddl bug here unfortunately",
    "start": "3399760",
    "end": "3407799"
  },
  {
    "text": "most of those ways don't get you anything in EA but if you use the right",
    "start": "3407799",
    "end": "3413160"
  },
  {
    "text": "way the magic Dave way you actually do get e um pointing to your string which then",
    "start": "3413160",
    "end": "3420760"
  },
  {
    "text": "gives you an reliable way to take control and I think we can uh oh you",
    "start": "3420760",
    "end": "3427280"
  },
  {
    "text": "don't see e point scen right now because the exception G moves all the rest of and I think probably Cera 4 there will",
    "start": "3427280",
    "end": "3434079"
  },
  {
    "text": "be no registers pointing to anything I think might B I fix that page the page",
    "start": "3434079",
    "end": "3444160"
  },
  {
    "text": "so uh that's that's the how to write a semi- reliable us build of this and it's",
    "start": "3444160",
    "end": "3450559"
  },
  {
    "text": "actually wanted 004 e 004 and 0 so I can't take B credit",
    "start": "3450559",
    "end": "3457520"
  },
  {
    "text": "for this sort of technique but again more all the and now it's kind of become",
    "start": "3457520",
    "end": "3465280"
  },
  {
    "text": "sem knowledge so we can that nine and says I can't connect back",
    "start": "3465280",
    "end": "3475799"
  },
  {
    "text": "some like [Music]",
    "start": "3476319",
    "end": "3484979"
  },
  {
    "text": "[Music]",
    "start": "3494480",
    "end": "3497650"
  },
  {
    "text": "[Music]",
    "start": "3507750",
    "end": "3510900"
  },
  {
    "text": "really",
    "start": "3516160",
    "end": "3519160"
  },
  {
    "text": "slow we'll get back to now we're going to delve into the Microsoft content server vulnerability and how it's",
    "start": "3530920",
    "end": "3537359"
  },
  {
    "text": "different from how easy and fun that one is which actually probably worked in the background there",
    "start": "3537359",
    "end": "3544520"
  },
  {
    "text": "[Music] probably all",
    "start": "3545520",
    "end": "3552160"
  },
  {
    "text": "right so a vulnerability comes out in Microsoft I go look at it because well",
    "start": "3552160",
    "end": "3558640"
  },
  {
    "text": "now it's my job but also because it's F of hacking in Microsoft um you",
    "start": "3558640",
    "end": "3564520"
  },
  {
    "text": "I'm so obv 7 2002 I don't know how to pronounce his name so I will not try to",
    "start": "3564520",
    "end": "3570200"
  },
  {
    "text": "butcher it but this announcement came out along with two other ones which are actually easier to exploit and we're not",
    "start": "3570200",
    "end": "3576319"
  },
  {
    "text": "going to go over uh this is kind of a said now this will make a good you know five minutes and it turned into 2 weeks",
    "start": "3576319",
    "end": "3583920"
  },
  {
    "text": "but um had some interesting notes in the in",
    "start": "3583920",
    "end": "3589160"
  },
  {
    "text": "the announcement which is always the notes in Microsoft announcements are basically misleading uh By Design",
    "start": "3589160",
    "end": "3596599"
  },
  {
    "text": "and and usually incomplete and sometimes justl lies but uh one of the things that",
    "start": "3596599",
    "end": "3604240"
  },
  {
    "text": "that he you know they did they do have to release something somewhat resembling the pro occasionally so you still",
    "start": "3604240",
    "end": "3609480"
  },
  {
    "text": "believe it was that there is a buffer overrun in a low level function that does perform user identification that",
    "start": "3609480",
    "end": "3615200"
  },
  {
    "text": "much is true uh they have a little hand number and they have minating factors which is when they line URL scan which",
    "start": "3615200",
    "end": "3623079"
  },
  {
    "text": "blocks all urls obtain nonas data uh yeah but doesn't matter and be hopeful",
    "start": "3623079",
    "end": "3630400"
  },
  {
    "text": "it's not there and they also say the attacker will need to discr valid executable code using only n data surely",
    "start": "3630400",
    "end": "3637200"
  },
  {
    "text": "not and I actually read something interesting in bamford's new book uh while on plane and he says that when we",
    "start": "3637200",
    "end": "3643920"
  },
  {
    "text": "captured some Germans after World War II who were involved in their encryption program they said that they knew unigo",
    "start": "3643920",
    "end": "3649559"
  },
  {
    "text": "was breakable but they figured that you know it takes a cool two building full machines to break this so they didn't",
    "start": "3649559",
    "end": "3655680"
  },
  {
    "text": "they with a problem right and that's the kind of attitude you're seeing here you're seeing you need to you know but a",
    "start": "3655680",
    "end": "3661200"
  },
  {
    "text": "whole building full of machine make this actually a problem and uh I think we",
    "start": "3661200",
    "end": "3666839"
  },
  {
    "text": "know all that worked out so the first trick with with any of these vulnerabilities try to find the",
    "start": "3666839",
    "end": "3673839"
  },
  {
    "text": "vulnerability in question and occasionally you find something that's like the vulnerability in question you",
    "start": "3673839",
    "end": "3679319"
  },
  {
    "text": "don't ever know if the one you found is the one that the Rapport is actually on which probably means they fixed four or",
    "start": "3679319",
    "end": "3685640"
  },
  {
    "text": "five different bugs in the same uh patch you can usually go back and dip",
    "start": "3685640",
    "end": "3691319"
  },
  {
    "text": "the patch against the thing my do but that's really not what I like to do",
    "start": "3691319",
    "end": "3697079"
  },
  {
    "text": "since that involves work so I tend to do buzzing it's something I'm semi known",
    "start": "3697079",
    "end": "3702720"
  },
  {
    "text": "for uh being LA and uh and I have this",
    "start": "3702720",
    "end": "3707799"
  },
  {
    "text": "program called Spike proxy which is a sort of web man in the middle HB HPS web",
    "start": "3707799",
    "end": "3714440"
  },
  {
    "text": "application thing I crushing San little market um but basically I just browse to I",
    "start": "3714440",
    "end": "3722359"
  },
  {
    "text": "browse for the application I installed it first that's always the hard part then I browse the application and then I",
    "start": "3722359",
    "end": "3728160"
  },
  {
    "text": "hit you know Buzz and then it craft and that's it so the way the way to do this",
    "start": "3728160",
    "end": "3735520"
  },
  {
    "text": "in I think it's fun when you guys go back and replicate these results right like something that you should be able",
    "start": "3735520",
    "end": "3740920"
  },
  {
    "text": "to replicate it is you can take Spike proxy you can browse to a default cont",
    "start": "3740920",
    "end": "3746119"
  },
  {
    "text": "server you know entry and then put overflow and if you've attach the right",
    "start": "3746119",
    "end": "3752319"
  },
  {
    "text": "process you'll see all EBG break with an exception in that process we have it on",
    "start": "3752319",
    "end": "3758960"
  },
  {
    "text": "this P right the only one that loads up to local system and is related content",
    "start": "3758960",
    "end": "3765279"
  },
  {
    "text": "server is a security service so you already know the process in doing this so the request is thus",
    "start": "3765279",
    "end": "3773839"
  },
  {
    "text": "basically they have a domain they have a list and they have all all these things that you send over",
    "start": "3773839",
    "end": "3779799"
  },
  {
    "text": "htps and that that long o a4c a thing is actually my username for",
    "start": "3779799",
    "end": "3786960"
  },
  {
    "text": "the machine you have to have this win and stuff in front of it otherwise it doesn't doesn't break but if you put a",
    "start": "3786960",
    "end": "3794520"
  },
  {
    "text": "long domain name then you will in fact cause an overflow and that's that and",
    "start": "3794520",
    "end": "3801119"
  },
  {
    "text": "there's the page so now you know okay what's the bug the bug is this",
    "start": "3801119",
    "end": "3806880"
  },
  {
    "text": "it's a this is a ol bug stack back Trace you can see does a wcsn copy you can see",
    "start": "3806880",
    "end": "3814240"
  },
  {
    "text": "where the destination is that's a stack address if you play with Windows long enough you can see kind of what a stack",
    "start": "3814240",
    "end": "3819640"
  },
  {
    "text": "address looks like keep addresses tend to be some like [Music] 07 so and obviously there's multiple",
    "start": "3819640",
    "end": "3828039"
  },
  {
    "text": "Stacks this is right but this this is this looks like a stack and then you can see that you have contr string and then",
    "start": "3828039",
    "end": "3834799"
  },
  {
    "text": "the length is extremely long the L is 40,000 which is what the fuzer decided",
    "start": "3834799",
    "end": "3840000"
  },
  {
    "text": "to do um so this is what they did they did a",
    "start": "3840000",
    "end": "3846480"
  },
  {
    "text": "copy and they used the size of the source was fantastic must have been a general",
    "start": "3846480",
    "end": "3854880"
  },
  {
    "text": "s okay so this is what I wanted to show you like a brief summary one page summary of all the other talks we've",
    "start": "3854880",
    "end": "3861000"
  },
  {
    "text": "been to on Windows exploitation where you have this SE Handler which you",
    "start": "3861000",
    "end": "3866319"
  },
  {
    "text": "overwrite something and then you you go to a jump evx or something like that and you get control of you know the you know",
    "start": "3866319",
    "end": "3874440"
  },
  {
    "text": "the instruction Corner which then lets you jum you have all fun but um here's",
    "start": "3874440",
    "end": "3881400"
  },
  {
    "text": "one in a security service originally I thought you control EDI which is a much",
    "start": "3881400",
    "end": "3888400"
  },
  {
    "text": "fa tell you that you lost little while uh that actually is not the case you",
    "start": "3888400",
    "end": "3894880"
  },
  {
    "text": "don't in have e if you can see down in the slid proba more",
    "start": "3894880",
    "end": "3901960"
  },
  {
    "text": "stuff okay so this been you know foreshadowing for a little while it's",
    "start": "3901960",
    "end": "3907119"
  },
  {
    "text": "not a typical overflow I mean no windows overflow is really typical some that are easy and",
    "start": "3907119",
    "end": "3912960"
  },
  {
    "text": "some that are only monly hard most um various versions of your tax ring do",
    "start": "3912960",
    "end": "3920160"
  },
  {
    "text": "exist in memory unfortunately they're all unic coded also unfortunately on some EX packs are unic coded in one way",
    "start": "3920160",
    "end": "3928039"
  },
  {
    "text": "some service packs are unic coded in another way and uh this particular",
    "start": "3928039",
    "end": "3933720"
  },
  {
    "text": "VMware box is Service Pack 3 in Service Pack 2 the problem is actually harder so I was originally doing Service",
    "start": "3933720",
    "end": "3940799"
  },
  {
    "text": "Pack 2 really painful okay so here's as as you write",
    "start": "3940799",
    "end": "3947440"
  },
  {
    "text": "an xplay the philosophy of how to write an xplay is really what I'm trying to show here it's catalog your situation",
    "start": "3947440",
    "end": "3953319"
  },
  {
    "text": "when the exploit happens and if you're really really good you use the the whole API of the program everything you can",
    "start": "3953319",
    "end": "3959480"
  },
  {
    "text": "send to the program you kind of look at in terms of what how it affects your",
    "start": "3959480",
    "end": "3964599"
  },
  {
    "text": "exploit like how do you what kinds of memory can you move can you change where can you put other things I mean you",
    "start": "3964599",
    "end": "3971319"
  },
  {
    "text": "don't have to sh send your real Shell Code in the same packet that you send your attack with right in this",
    "start": "3971319",
    "end": "3977200"
  },
  {
    "text": "particular case I do but a lot of xlo don't so that's kind of the philosophy I",
    "start": "3977200",
    "end": "3982359"
  },
  {
    "text": "wanted to say the these are catalog things that you have wrting down somewh the light we have this string at this",
    "start": "3982359",
    "end": "3988559"
  },
  {
    "text": "place this string at this place we have this kind of filter applied to each one that converge in this way this is what",
    "start": "3988559",
    "end": "3995319"
  },
  {
    "text": "EIP is this is how the stack is set up and this is what's in you know various",
    "start": "3995319",
    "end": "4000880"
  },
  {
    "text": "pointers and then you start saying well what are the constraints that I'm going to have to pass through on this exploit",
    "start": "4000880",
    "end": "4006960"
  },
  {
    "text": "and in this case you're like well I have only I definitely know and after playing with it for a little while you realize",
    "start": "4006960",
    "end": "4013200"
  },
  {
    "text": "you really can't get around the unit coding of this stren and you can't there's a lot of things",
    "start": "4013200",
    "end": "4019920"
  },
  {
    "text": "you cannot do and one of them is you can have you can write IP over and that's",
    "start": "4019920",
    "end": "4025039"
  },
  {
    "text": "that's fantastic but you can only write it over with this sort of pattern this 00 a BB",
    "start": "4025039",
    "end": "4032400"
  },
  {
    "text": "pattern and they must be asking printable strings and they must be uh",
    "start": "4032400",
    "end": "4038599"
  },
  {
    "text": "they can't be zeros obviously that would end the string and they get converted in this very annoying way and in addition I",
    "start": "4038599",
    "end": "4045880"
  },
  {
    "text": "because of the way you even get into this function you can't use an at sign and you can't use a slash or back slash",
    "start": "4045880",
    "end": "4052520"
  },
  {
    "text": "or any sort of those and the percent UT trick does not work and changing the",
    "start": "4052520",
    "end": "4058200"
  },
  {
    "text": "language of the HTTP request are not seem to do anything so for those of you",
    "start": "4058200",
    "end": "4063279"
  },
  {
    "text": "who have never heard of Unicode or utf16 or any of these standards you can download some fairly confusing rfcs and",
    "start": "4063279",
    "end": "4070160"
  },
  {
    "text": "stuff also in that um and I actually probably post series show unic code",
    "start": "4070160",
    "end": "4076160"
  },
  {
    "text": "which dos it's real simple but basically it's just adding a zero to",
    "start": "4076160",
    "end": "4082240"
  },
  {
    "text": "the front and restricting what you can put in and in addition in some conversion routines they also change",
    "start": "4082240",
    "end": "4088680"
  },
  {
    "text": "things so that if you have an ox8 it gets turned into Ox",
    "start": "4088680",
    "end": "4094799"
  },
  {
    "text": "c2001 one0 something so sometimes you have you know you have",
    "start": "4094799",
    "end": "4100798"
  },
  {
    "text": "one bite of entry and you end up with four bites we always have four sometimes they tend to be",
    "start": "4100799",
    "end": "4107238"
  },
  {
    "text": "like you're seeing where I'm going so with that said some in some some",
    "start": "4107239",
    "end": "4113238"
  },
  {
    "text": "versions of the conversion you don't end up with this C2 stuff and Service Pack 3 you never do you always end up with z0",
    "start": "4113239",
    "end": "4119838"
  },
  {
    "text": "something something okay so this sort",
    "start": "4119839",
    "end": "4125480"
  },
  {
    "text": "of restriction on where you can return to really kind of channels your efforts",
    "start": "4125480",
    "end": "4130600"
  },
  {
    "text": "and you can play some games by trying to overwrite only two you know B of the",
    "start": "4130600",
    "end": "4135798"
  },
  {
    "text": "function pointer and that that can do some fun but but let's restrict ourselves in the way we think about this",
    "start": "4135799",
    "end": "4141600"
  },
  {
    "text": "exp to make it more reliable just to do the cause the exception immediately which means you're going to have to",
    "start": "4141600",
    "end": "4146798"
  },
  {
    "text": "overwrite the entire return of this or the entire function point that you're over so even if there was a nice little",
    "start": "4146799",
    "end": "4154758"
  },
  {
    "text": "call evx or jump evx because it turns out that evx is what ends up pointing your spring even if something like that",
    "start": "4154759",
    "end": "4161040"
  },
  {
    "text": "was really nice and existed somewhere we could go the buffer is actually corrupted as",
    "start": "4161040",
    "end": "4167000"
  },
  {
    "text": "this gets processed in memory so the beginning of the buffer which is very common when a stack of flow is trash",
    "start": "4167000",
    "end": "4172679"
  },
  {
    "text": "result the varibles there that someone actually wanted to run into and the place in the heat since",
    "start": "4172679",
    "end": "4179560"
  },
  {
    "text": "I've thrown you can throw like meds and meds of this problem but for the sake of this demonstration we're throwing 40K at",
    "start": "4179560",
    "end": "4185359"
  },
  {
    "text": "the problem and in the heat we thrown it we have one version of the string so you",
    "start": "4185359",
    "end": "4192080"
  },
  {
    "text": "can say you know hopefully 0017 01 we have one version of the",
    "start": "4192080",
    "end": "4198040"
  },
  {
    "text": "string and we can execute some instructions but it turns out this bizarre uh UTF 16ish spring is very",
    "start": "4198040",
    "end": "4205640"
  },
  {
    "text": "difficult to do without knowing that some register points directly to a no position in your screen someone came up",
    "start": "4205640",
    "end": "4210760"
  },
  {
    "text": "to me before the talk this Happ before I guess a lot of people talks are like way at least two weeks ago that we don't",
    "start": "4210760",
    "end": "4217280"
  },
  {
    "text": "need to know about the um position of a registering or position of reging",
    "start": "4217280",
    "end": "4224719"
  },
  {
    "text": "relative to but uh okay I so go back and see what",
    "start": "4224719",
    "end": "4231000"
  },
  {
    "text": "else it add so this is this is in any unic code",
    "start": "4231000",
    "end": "4237080"
  },
  {
    "text": "exploit you have to know a few things and you want to actually in any exploit you catalog all the things you know and",
    "start": "4237080",
    "end": "4242679"
  },
  {
    "text": "in this case you know what registers writable addresses this never changes I mean they're pointing to different writable addresses but they're always",
    "start": "4242679",
    "end": "4248600"
  },
  {
    "text": "pointing to maybe writable address and you know what register the point of view is bring and what",
    "start": "4248600",
    "end": "4253880"
  },
  {
    "text": "offsets so I mean immediately you can see the inputs to make unit code 2 which is",
    "start": "4253880",
    "end": "4259199"
  },
  {
    "text": "going to be output of this whole exercise which is a function that generates",
    "start": "4259199",
    "end": "4265360"
  },
  {
    "text": "shelter and hopefully you have the slides in front of you but if you don't basically there's classes of",
    "start": "4265400",
    "end": "4271280"
  },
  {
    "text": "instructions that you're then going to use to generate an encoder or decoder and that's kind of your one by",
    "start": "4271280",
    "end": "4277280"
  },
  {
    "text": "instruction so like 41 we all know INX and 42 is something but um",
    "start": "4277280",
    "end": "4285600"
  },
  {
    "text": "I know a lot of you have out but you have like four B structures you can use",
    "start": "4285600",
    "end": "4291760"
  },
  {
    "text": "two B structures you can use which you're going to start with Z 0 and then a number or have a number and then Z 0",
    "start": "4291760",
    "end": "4300000"
  },
  {
    "text": "and then you have three bites of four byes and if you your slideable have basically use anything",
    "start": "4300000",
    "end": "4305520"
  },
  {
    "text": "that has anything Z so you know obviously canvas has a lot",
    "start": "4305520",
    "end": "4311800"
  },
  {
    "text": "of I wanted to stop writing window shelf code at one point so I real you're always going to be run Shel have to live",
    "start": "4311800",
    "end": "4317679"
  },
  {
    "text": "with that uh like a routine but so",
    "start": "4317679",
    "end": "4323480"
  },
  {
    "text": "the canvas does a lot of things for me and one of the things I want to do is be able to use this Shell Code in every",
    "start": "4323480",
    "end": "4330440"
  },
  {
    "text": "other unit code exploit that comes out because like I mentioned before I have the profound belief that there will be",
    "start": "4330440",
    "end": "4336199"
  },
  {
    "text": "more of them and I also on this slide just have",
    "start": "4336199",
    "end": "4341400"
  },
  {
    "text": "Primitives that we're going to use to construct it so you think of yourself as an assembler trying to construct you",
    "start": "4341400",
    "end": "4347400"
  },
  {
    "text": "know arbitrary data and these are sort of The Primitives that you can call you can say I want to move between registers",
    "start": "4347400",
    "end": "4353239"
  },
  {
    "text": "I want to add subract contents from registers and I want to move between registers and memory right if I can do",
    "start": "4353239",
    "end": "4358440"
  },
  {
    "text": "these things I have a little machine that I can write so this is what the finished",
    "start": "4358440",
    "end": "4365320"
  },
  {
    "text": "exploit does and I want everyone to see where we're going because I think a lot of these talks you kind of get lost in",
    "start": "4365320",
    "end": "4371880"
  },
  {
    "text": "the middle you're like okay why are we doing this now and",
    "start": "4371880",
    "end": "4377120"
  },
  {
    "text": "so this is what it does basically it overrides the exception angular and jump",
    "start": "4377920",
    "end": "4383480"
  },
  {
    "text": "to the heat once on the heat you you run a little increment PVS thing and you actually then you actually can only do",
    "start": "4383480",
    "end": "4391480"
  },
  {
    "text": "that because you know yesi is R slow but and then you jump to sort of another",
    "start": "4391480",
    "end": "4398040"
  },
  {
    "text": "decoder which then goes another Cod another Cod and eventually you're actually actually something BL",
    "start": "4398040",
    "end": "4405320"
  },
  {
    "text": "so how do we get to get control of the IP at a known place in our buffer this",
    "start": "4405679",
    "end": "4411159"
  },
  {
    "text": "is and earlier on we're like you want to know that a register points to you and then you want to get control of VIP and",
    "start": "4411159",
    "end": "4417400"
  },
  {
    "text": "still know that and evx does point to a known place it points to a known",
    "start": "4417400",
    "end": "4422639"
  },
  {
    "text": "corrupted place but does point to a known place so what we're going to do is we're going to increment evx and then",
    "start": "4422639",
    "end": "4427880"
  },
  {
    "text": "we're going to push evx in order return you can do this timely",
    "start": "4427880",
    "end": "4433600"
  },
  {
    "text": "easily and the other problem you have is that you need to align yourself with",
    "start": "4433600",
    "end": "4440880"
  },
  {
    "text": "because you have zeros interpers in your thing you need to be able to execute both one b and two by instructions and",
    "start": "4440880",
    "end": "4447120"
  },
  {
    "text": "three by so on you're very carefully maintaining what alignment am I on I need to execute some sort of noop to",
    "start": "4447120",
    "end": "4453520"
  },
  {
    "text": "realign myself as I as I execute this code so here's a magic alignment program",
    "start": "4453520",
    "end": "4461760"
  },
  {
    "text": "or code basically 20 6 has no effect on",
    "start": "4461760",
    "end": "4466920"
  },
  {
    "text": "itself so 2600 26 and 0026 will all end",
    "start": "4466920",
    "end": "4473199"
  },
  {
    "text": "up executing exactly in one alignment and I want to see that kind of just align you you jump into a bunch of these",
    "start": "4473199",
    "end": "4479719"
  },
  {
    "text": "noops and you become [Music]",
    "start": "4479719",
    "end": "4484760"
  },
  {
    "text": "aligned okay and that I if you look back there that does say ESI has to be right",
    "start": "4484760",
    "end": "4490840"
  },
  {
    "text": "because it doesn't right okay so I wanted to give you a",
    "start": "4490840",
    "end": "4497800"
  },
  {
    "text": "quick look at this think we're going skip a couple slides here do a demo Dem",
    "start": "4497800",
    "end": "4503360"
  },
  {
    "text": "lot of us but so you have this sort of no off this 26 no off and you have 6 e",
    "start": "4503360",
    "end": "4509239"
  },
  {
    "text": "which is actually going to see a alignment thing and then you're going to increment EVs and then you're going to",
    "start": "4509239",
    "end": "4515639"
  },
  {
    "text": "have another alignment and then you're going to increment EVS because you can't control that these zeros are there those",
    "start": "4515639",
    "end": "4521320"
  },
  {
    "text": "zeros are going to get put in there for you so even though your scen originally was 266e",
    "start": "4521320",
    "end": "4527159"
  },
  {
    "text": "436e this is kind of what it actually does and once you go through that and",
    "start": "4527159",
    "end": "4533120"
  },
  {
    "text": "then it turns out that the scen that you're actually executing in got coded in a certain way you can use a non-asd",
    "start": "4533120",
    "end": "4539120"
  },
  {
    "text": "principal character see3 to return in if you bu they other way around this and if",
    "start": "4539120",
    "end": "4545239"
  },
  {
    "text": "you have the bottom of this can see it okay so we'll rationalize it here we",
    "start": "4545239",
    "end": "4553719"
  },
  {
    "text": "say we know evx our string but it points at a place that that is crack so we need",
    "start": "4553719",
    "end": "4560960"
  },
  {
    "text": "to increment we've done that we've seen all that and we kind of we solve the",
    "start": "4560960",
    "end": "4566440"
  },
  {
    "text": "problem of not knowing exactly where in the heat we are because the heat moving around willy-nilly in Windows especially",
    "start": "4566440",
    "end": "4572679"
  },
  {
    "text": "uh in processes that you don't really control and so you know maintaining a model of the",
    "start": "4572679",
    "end": "4579840"
  },
  {
    "text": "heat is going to be big pain so we don't really know where in the heat we are and the noops Align us and take care of that",
    "start": "4579840",
    "end": "4587480"
  },
  {
    "text": "problem okay so now we're jumping into Shell Code we have execution at a place we know we know enough that we can",
    "start": "4587520",
    "end": "4594280"
  },
  {
    "text": "actually do the EXP uh and we need to write this incoder decoder and the basic concepts were",
    "start": "4594280",
    "end": "4599960"
  },
  {
    "text": "originally taken from Chrisley's paper which you can download from his website but he actually uses a bunch of",
    "start": "4599960",
    "end": "4605719"
  },
  {
    "text": "characters that we can't use so we had to change a lot of that and here's here's how I wrote this",
    "start": "4605719",
    "end": "4613760"
  },
  {
    "text": "this decoder is to create this little Loop which actually is not a loop because it gets completely",
    "start": "4613760",
    "end": "4620280"
  },
  {
    "text": "linearized and it kind of just adds this but you can see the instruction it does",
    "start": "4620280",
    "end": "4625800"
  },
  {
    "text": "it uses these Primitives which in the program itself are a dictionary they're a hash table if you will of of sort of",
    "start": "4625800",
    "end": "4634159"
  },
  {
    "text": "the instructions you're allowed to do and so it sort of assembles it as it goes along and what you're doing is you're maintaining sort of one register",
    "start": "4634159",
    "end": "4641560"
  },
  {
    "text": "as a counter which is going to be your data that you're going to put into into memory one bite at a time and",
    "start": "4641560",
    "end": "4649760"
  },
  {
    "text": "at the other end of on the other end of your string you actually have a big block of sort of uh pre-printed taable",
    "start": "4649760",
    "end": "4657639"
  },
  {
    "text": "so you get control of so many bites the major problem with this is size if your encoder is too big it's just not going",
    "start": "4657639",
    "end": "4663920"
  },
  {
    "text": "to work and it does get really large so line not line we've all went",
    "start": "4663920",
    "end": "4669440"
  },
  {
    "text": "through started out with pushes and Pops which you can",
    "start": "4669440",
    "end": "4675639"
  },
  {
    "text": "see we kind of we want to do also one of The Primitives that I missed in the original list was setting a register to",
    "start": "4675639",
    "end": "4682520"
  },
  {
    "text": "a known value and that's this is how you do that push it keep Popp all standard",
    "start": "4682520",
    "end": "4689679"
  },
  {
    "text": "so I want to just show you kind of what the Shell Code looks like this may be a little hard to read on the screen but",
    "start": "4689679",
    "end": "4695760"
  },
  {
    "text": "basically it subtracts a known value from eax which has already been set in order to set eax to something you know",
    "start": "4695760",
    "end": "4702920"
  },
  {
    "text": "you then kind of you walk your you also have to walk your a pointer through memory so one of the pointers is encoded",
    "start": "4702920",
    "end": "4709600"
  },
  {
    "text": "or decoded sh and at that point you kind of add what",
    "start": "4709600",
    "end": "4714840"
  },
  {
    "text": "you're pointing to to what you have so if it's a zero you add you know whatever's in Al to zero and that's",
    "start": "4714840",
    "end": "4721760"
  },
  {
    "text": "going to be the value but if it's not zero you have some options so you can",
    "start": "4721760",
    "end": "4726880"
  },
  {
    "text": "you can try to play little games with the the actual stuff in memory to",
    "start": "4726880",
    "end": "4731920"
  },
  {
    "text": "optimize the size of this encoder the issues that you're looking",
    "start": "4731920",
    "end": "4738960"
  },
  {
    "text": "at uh window Shell Code Parson thatp header like I mentioned and I think LSD",
    "start": "4738960",
    "end": "4746719"
  },
  {
    "text": "has some public code that does that has some",
    "start": "4746719",
    "end": "4750920"
  },
  {
    "text": "cod I'm not sure what his good is but it's been out there for a while you can do this ke P parsing but the big",
    "start": "4752760",
    "end": "4759760"
  },
  {
    "text": "downside is unlike unit Shell Code which can be you know 23 bytes long still be great window shelf code tend to get know",
    "start": "4759760",
    "end": "4766760"
  },
  {
    "text": "belwar itself and even I mean if you remember the original paper that started people",
    "start": "4766760",
    "end": "4772679"
  },
  {
    "text": "really looking at Windows the Dow Windows overflow build doog was like you know what are you writing MFC explo in",
    "start": "4772679",
    "end": "4778840"
  },
  {
    "text": "reality is you are you're writing this giant application to the win3 2 API and",
    "start": "4778840",
    "end": "4784159"
  },
  {
    "text": "it gets big so 500 bytes is not a completely unreasonable size and actually this is uh my current Shell",
    "start": "4784159",
    "end": "4791120"
  },
  {
    "text": "Code because there's a bug in Lo Library a that you have to account for balloon to 800 btes so I had a lot of of shell",
    "start": "4791120",
    "end": "4798400"
  },
  {
    "text": "Cod that I needed to put in there somehow to make it reliable um and optimistically the shell",
    "start": "4798400",
    "end": "4804800"
  },
  {
    "text": "coat is going to get 10 times bigger when it goes to this whole encoding process but uh that's too big there's",
    "start": "4804800",
    "end": "4812400"
  },
  {
    "text": "just not enough space on a stack and stacks even though they tend to be similar sizes they they they're not",
    "start": "4812400",
    "end": "4818760"
  },
  {
    "text": "always the same depth basically think about it and uh you just don't you don't",
    "start": "4818760",
    "end": "4825480"
  },
  {
    "text": "know that you're going to have enough room for that and you can only subtract or ads so",
    "start": "4825480",
    "end": "4830679"
  },
  {
    "text": "much because you can only use certain characters so sometimes you're playing wraparound games with eax to try to get",
    "start": "4830679",
    "end": "4836480"
  },
  {
    "text": "it to be the right value uh you can't do certain numbers like oh at sporty because you're not allowed to use an at",
    "start": "4836480",
    "end": "4842800"
  },
  {
    "text": "sign in the string or you know 5c 4C or anything these anyway so I have this on",
    "start": "4842800",
    "end": "4848679"
  },
  {
    "text": "my if you go to my canvas web page which is imity sex canvas you can download a nice new version of making your to that",
    "start": "4848679",
    "end": "4855360"
  },
  {
    "text": "you can run with any Python and you conver any Shell Code into this nice format which we're going to do a",
    "start": "4855360",
    "end": "4861679"
  },
  {
    "text": "demonstration on soon so the uh annoying thing about this",
    "start": "4861679",
    "end": "4867239"
  },
  {
    "text": "is you to crush this down to crush it down even farther you have to write a third a",
    "start": "4867239",
    "end": "4873280"
  },
  {
    "text": "second stage which is going to actually go search through the Heat and find your real Shell Code decode that and then I",
    "start": "4873280",
    "end": "4880719"
  },
  {
    "text": "have another decoder on top of that which runs the sh",
    "start": "4880719",
    "end": "4886120"
  },
  {
    "text": "and this makes makes it all a big fun game and you're playing games with the sizes here as you stage up you're you're",
    "start": "4886120",
    "end": "4892920"
  },
  {
    "text": "in a bigger space so you're kind of growing getting bigger and stronger like the",
    "start": "4892920",
    "end": "4897960"
  },
  {
    "text": "whole okay so you're never just screwed and this is the important lesson that the Microsoft uh technical writers know",
    "start": "4897960",
    "end": "4905600"
  },
  {
    "text": "but don't want to know because they it always eventually does work um even in",
    "start": "4905600",
    "end": "4911639"
  },
  {
    "text": "in bad times because sometimes you really want to content server machine",
    "start": "4911639",
    "end": "4917840"
  },
  {
    "text": "so we we'll do all the things we have to do we're going to start in 1701 because that's where the Heap is and we know",
    "start": "4917840",
    "end": "4924520"
  },
  {
    "text": "that we're there somewhere okay so if you if you've gone through this whole process and you've",
    "start": "4924520",
    "end": "4931040"
  },
  {
    "text": "done I mean this took for two weeks so you're getting a compressed thought process and you a few other things but",
    "start": "4931040",
    "end": "4937560"
  },
  {
    "text": "the decoder and wallet coders are going to go H through the Heat and find the actual Shell Code eventually turn you a",
    "start": "4937560",
    "end": "4943960"
  },
  {
    "text": "shell and after this conclusion we're going to go do",
    "start": "4943960",
    "end": "4949199"
  },
  {
    "text": "demo but I think the I think the main thing you can learn is that utf16 should not be a problem for you if you have",
    "start": "4949360",
    "end": "4955719"
  },
  {
    "text": "some spread time on your hands uh the exploit has one hardcoded value Windows",
    "start": "4955719",
    "end": "4961159"
  },
  {
    "text": "this is considered decent uh embarrassing but still decent and um",
    "start": "4961159",
    "end": "4967280"
  },
  {
    "text": "it's easily adapted to other overflows of this type which I believe there are many but that remains to be proven by",
    "start": "4967280",
    "end": "4974840"
  },
  {
    "text": "public at least and you can find this is my web page if you don't know how to find it you can Google way but um that",
    "start": "4974840",
    "end": "4983560"
  },
  {
    "text": "that indeed is what it is my Prett piure okay now we're going to do some",
    "start": "4983560",
    "end": "4991120"
  },
  {
    "text": "some demos and do some all",
    "start": "4991120",
    "end": "4994600"
  },
  {
    "text": "bugging yeah you can see that it actually did work I'll show you what",
    "start": "4999719",
    "end": "5005760"
  },
  {
    "text": "I'll show you just how canvas looks when it's actually working so you can know when on line during my presentations but",
    "start": "5005760",
    "end": "5012080"
  },
  {
    "text": "when the web that exploit Ram it actually did the Overflow caus a little exception did some fun things and then",
    "start": "5012080",
    "end": "5018040"
  },
  {
    "text": "connected back to this this other machine which is at 1 192 168",
    "start": "5018040",
    "end": "5023679"
  },
  {
    "text": "1661 and at that point this little listener popped up and you can",
    "start": "5023679",
    "end": "5031400"
  },
  {
    "text": "do things like upload or download files and run commands and pwp and that sort",
    "start": "5031400",
    "end": "5039000"
  },
  {
    "text": "of thing via the Shell Code because of all whatever it has to do to get that working so that's what that's what",
    "start": "5039000",
    "end": "5044159"
  },
  {
    "text": "happens when I work so now I know if my demo is working we have to close the web dab",
    "start": "5044159",
    "end": "5049760"
  },
  {
    "text": "thing because is Must Die for can't have two exploits exploits",
    "start": "5049760",
    "end": "5057320"
  },
  {
    "text": "exploit an is at the same time so if your exploits don't work in a while that means I'm busy come back in 10 minutes",
    "start": "5057320",
    "end": "5066320"
  },
  {
    "text": "I'm going to give is a little bit of time to start back",
    "start": "5066360",
    "end": "5070719"
  },
  {
    "text": "up",
    "start": "5076040",
    "end": "5079040"
  },
  {
    "text": "okay I only have one version for it's not it's more technology demonstration",
    "start": "5082480",
    "end": "5087960"
  },
  {
    "text": "than everything else",
    "start": "5087960",
    "end": "5091360"
  },
  {
    "text": "all right so I used to think this is a one shot and by that I mean one you would only get one chance to try it out",
    "start": "5109159",
    "end": "5115840"
  },
  {
    "text": "and the process would die and you would be able to get in but for some reason",
    "start": "5115840",
    "end": "5121119"
  },
  {
    "text": "it's not on sp3 and it gets restarted nicely every time you try the exploit so",
    "start": "5121119",
    "end": "5126639"
  },
  {
    "text": "that that's adding to the reliability of this",
    "start": "5126639",
    "end": "5131199"
  },
  {
    "text": "exploit we're going to attach to",
    "start": "5131800",
    "end": "5135719"
  },
  {
    "text": "it so typical all in above Behavior an excess violation has occurred with against control",
    "start": "5145199",
    "end": "5153080"
  },
  {
    "text": "cool okay so this is what you're faced with when you actually do things and it's a Unicode string I'll you about",
    "start": "5156119",
    "end": "5162440"
  },
  {
    "text": "this great because it tells you what pointers reference and kind of PR them out for you and initially you're like",
    "start": "5162440",
    "end": "5167560"
  },
  {
    "text": "well edx is pointing at me need ESI is pointing at me and there's a few other things pointing at me maybe it won't be",
    "start": "5167560",
    "end": "5174159"
  },
  {
    "text": "so hard and you kind of do a search looking for other versions of your string which I'm not going to do now but",
    "start": "5174159",
    "end": "5180040"
  },
  {
    "text": "you can load up in memory map and do a search and you won't find any versions of your original R and this is this is",
    "start": "5180040",
    "end": "5185920"
  },
  {
    "text": "when he started maybe not as easy I thought and if you look at the",
    "start": "5185920",
    "end": "5193360"
  },
  {
    "text": "stack you can see all the unod stuff and it hit the end of the stack and that's when the ACT that's what we're actually",
    "start": "5198159",
    "end": "5204400"
  },
  {
    "text": "seeing here is I hit the end and I don't know what to",
    "start": "5204400",
    "end": "5209198"
  },
  {
    "text": "do but somewhere above that hiden in the",
    "start": "5210679",
    "end": "5216679"
  },
  {
    "text": "mess is thetion here okay so at a known place in",
    "start": "5216960",
    "end": "5223000"
  },
  {
    "text": "our string the exception Handler pointer is going to be uh we don't want to care about the next record because work",
    "start": "5223000",
    "end": "5230159"
  },
  {
    "text": "concern there is no next record return from this",
    "start": "5230159",
    "end": "5235280"
  },
  {
    "text": "and that right there is the address we're going to go to I'll show you what looks like in the",
    "start": "5235280",
    "end": "5242280"
  },
  {
    "text": "dump it looks like this and even if even if it hadn't been perfectly aligned for us this time think in like we go to",
    "start": "5242280",
    "end": "5253198"
  },
  {
    "text": "172 you'll see that it doesn't matter because in the end it does get a line force and you sp a few while bit hting",
    "start": "5258239",
    "end": "5266280"
  },
  {
    "text": "down through the Shell Code",
    "start": "5266280",
    "end": "5270960"
  },
  {
    "text": "shelter does get up but the",
    "start": "5278119",
    "end": "5282639"
  },
  {
    "text": "here",
    "start": "5291000",
    "end": "5294000"
  },
  {
    "text": "search all right so here you're seeing what we do we do a bunch of 6s and 43s",
    "start": "5302800",
    "end": "5308040"
  },
  {
    "text": "and there's just a list of these things so in the in the actual encoder what you do is you specify I I have dbx pointing",
    "start": "5308040",
    "end": "5315679"
  },
  {
    "text": "to my string and I want to increment it by 17 and put that in here so there's",
    "start": "5315679",
    "end": "5323400"
  },
  {
    "text": "actually a whole whole demonstration for this particular exploit in the code I",
    "start": "5323400",
    "end": "5328480"
  },
  {
    "text": "gave up and at the end of this it quite nicely just returns push PX and then",
    "start": "5328480",
    "end": "5335360"
  },
  {
    "text": "return so I'm going to put a break point",
    "start": "5335360",
    "end": "5339400"
  },
  {
    "text": "there and US point plan we hit C F9 which is how use handle the",
    "start": "5341080",
    "end": "5347320"
  },
  {
    "text": "exception and hit the break point and you can see now if you do a look at evx",
    "start": "5347320",
    "end": "5353080"
  },
  {
    "text": "which the seven okay so here's what happened this",
    "start": "5353080",
    "end": "5358400"
  },
  {
    "text": "is our this is the Shell Code now we're executing the Shell Code on the stack where we know is pointing to and we know",
    "start": "5358400",
    "end": "5365719"
  },
  {
    "text": "exactly what instruction we're pointing at so we have a push evx and then a pop",
    "start": "5365719",
    "end": "5372080"
  },
  {
    "text": "e which is going to say it's basically move one register to another register and in between that you have you have a",
    "start": "5372080",
    "end": "5378719"
  },
  {
    "text": "three butt no off so you can immediately see where all the length problems are coming from because every time we want",
    "start": "5378719",
    "end": "5384760"
  },
  {
    "text": "to do a simple primitive we have you know 10 bites 7 byes",
    "start": "5384760",
    "end": "5391560"
  },
  {
    "text": "by so I mean that simple takes five bytes some other per take other amounts of bytes and they'll walk through",
    "start": "5391560",
    "end": "5399040"
  },
  {
    "text": "briefly show you that now Pax is pointing in a certain place we're going",
    "start": "5399040",
    "end": "5405679"
  },
  {
    "text": "to add to it because in our string at the end of our string is going to be the sort of mask that we're going to apply",
    "start": "5405679",
    "end": "5412320"
  },
  {
    "text": "to the Shell Code subtractor you have kind of add and subtract and play with it you want to",
    "start": "5412320",
    "end": "5418360"
  },
  {
    "text": "add Ox 500 we have to add and subtract because we can't have a zero",
    "start": "5418360",
    "end": "5425679"
  },
  {
    "text": "move some restes around we're going to set eax to a certain value you can see e has change the value",
    "start": "5426960",
    "end": "5434159"
  },
  {
    "text": "thatl and we're going to start manipulating in this case look at I don't have a lb Point look at the the AL",
    "start": "5434159",
    "end": "5441719"
  },
  {
    "text": "basically the EA in this case and you can watch that that's actually the number we're going to be putting into",
    "start": "5441719",
    "end": "5448239"
  },
  {
    "text": "our Shelf code to decode it so you can watch it as it goes down in this case h",
    "start": "5448239",
    "end": "5455239"
  },
  {
    "text": "we we show you what's get here",
    "start": "5455239",
    "end": "5460400"
  },
  {
    "text": "ACS okay so you can see this is the mask this is the sort of Shell Code before",
    "start": "5486960",
    "end": "5492040"
  },
  {
    "text": "it's been decoded and you see all these ones which are basically just placeholders and then in some case uh",
    "start": "5492040",
    "end": "5499119"
  },
  {
    "text": "you the zero over there as well we're going to watch this kind of Step through and change that shell to be what we need",
    "start": "5499119",
    "end": "5505360"
  },
  {
    "text": "it to be where where you see say a 74 or 7B or",
    "start": "5505360",
    "end": "5510400"
  },
  {
    "text": "something it the encoder realized that it could save Space by just skipping",
    "start": "5510400",
    "end": "5515600"
  },
  {
    "text": "that particular bite because it could just put it in there so as we step through you can see it's kind of",
    "start": "5515600",
    "end": "5520800"
  },
  {
    "text": "changing what that shell code is and it's disassembled here so that's the actual you're seeing over there in the",
    "start": "5520800",
    "end": "5528639"
  },
  {
    "text": "disassembly is is the actual search code it's going to search through the heat to find the other code and it's going to",
    "start": "5528639",
    "end": "5534760"
  },
  {
    "text": "decode that little so you can see the bike scrolling",
    "start": "5534760",
    "end": "5540159"
  },
  {
    "text": "by as it does this which is a problem",
    "start": "5540159",
    "end": "5545159"
  },
  {
    "text": "ideally with an exp like this you have multiple encoding options so you can you know one doesn't happen to work you have",
    "start": "5545239",
    "end": "5552000"
  },
  {
    "text": "another one that may perhaps want to",
    "start": "5552000",
    "end": "5557080"
  }
]