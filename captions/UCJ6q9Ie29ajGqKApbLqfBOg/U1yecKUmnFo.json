[
  {
    "start": "0",
    "end": "42000"
  },
  {
    "text": "so uh yeah thanks for coming uh my name is Eric evanchuk and today I'll be talking about hopping on the can bus so",
    "start": "280",
    "end": "5839"
  },
  {
    "text": "we're going to go into a little bit about automotive security kind of how car networks work how things in car talk",
    "start": "5839",
    "end": "11759"
  },
  {
    "text": "and uh then show some tools that we can use to automatically play with cars um",
    "start": "11759",
    "end": "18240"
  },
  {
    "text": "my background I guess I played around a lot with cars when I was in university worked in research for actually",
    "start": "18240",
    "end": "23400"
  },
  {
    "text": "developing some green Vehicles so we did a hydrogen fuel cell vehicle and some",
    "start": "23400",
    "end": "28720"
  },
  {
    "text": "other vehicles we man should not blow ourselves up which I find somewhat impressive for a bunch of University",
    "start": "28720",
    "end": "34040"
  },
  {
    "text": "students dealing with hydrogen but uh yeah we got to learn a lot about how cars work and uh the security that's",
    "start": "34040",
    "end": "40800"
  },
  {
    "text": "going on in them so what is can can is controller area network it's uh one of",
    "start": "40800",
    "end": "47239"
  },
  {
    "start": "42000",
    "end": "42000"
  },
  {
    "text": "the many three-letter acronyms in the automotive world uh and controller area network is a very relatively cheap and",
    "start": "47239",
    "end": "54920"
  },
  {
    "text": "simple way to connect uh controllers so microcontrollers",
    "start": "54920",
    "end": "60199"
  },
  {
    "text": "with really uh minimal wiring and minimal cost so there's a bunch of",
    "start": "60199",
    "end": "65439"
  },
  {
    "text": "different types of can you'll see in cars uh you have high-speed can this is a differential signaling so it's got",
    "start": "65439",
    "end": "71960"
  },
  {
    "text": "some noise immunity that's nice and uh typically runs at about 500 kbps",
    "start": "71960",
    "end": "77159"
  },
  {
    "text": "sometimes a megabit but rarely uh low speed can this is used for Less critical",
    "start": "77159",
    "end": "82479"
  },
  {
    "text": "things because it's cheaper it's one wire it's single-ended ground is actually the chassis of the car so you",
    "start": "82479",
    "end": "88479"
  },
  {
    "text": "just need to run one wire out and you'll see this in like your light control door control like radio things",
    "start": "88479",
    "end": "95720"
  },
  {
    "text": "that are more uh you know less critical and just more uh convenience features",
    "start": "95720",
    "end": "101119"
  },
  {
    "text": "fault tolerant can is what you'll often see in airbags this is actually a pretty neat trick what they do is it's",
    "start": "101119",
    "end": "107200"
  },
  {
    "text": "highspeed can but if you cut one of the wires it becomes lows speed can so it's it's got some tolerance there and the",
    "start": "107200",
    "end": "114159"
  },
  {
    "text": "new thing is can FD for flexible data which nobody uses yet but it gets around some of the limitations right now of the",
    "start": "114159",
    "end": "121280"
  },
  {
    "text": "size of a can message it's probably going to make its way into cars in the next I don't know knowing how fast the",
    "start": "121280",
    "end": "127360"
  },
  {
    "text": "automotive industry moves five years or something uh and what does this look",
    "start": "127360",
    "end": "133120"
  },
  {
    "text": "like in a car well there's a little diagram over here which hopefully is legible and is just showing that you",
    "start": "133120",
    "end": "139239"
  },
  {
    "text": "have often a bunch of canned buses this is a bit of a simplified example but here you have four controllers on a high",
    "start": "139239",
    "end": "145400"
  },
  {
    "text": "speed bus in green so these are your more critical controllers you got like an engine transmission uh anlock brakes",
    "start": "145400",
    "end": "152800"
  },
  {
    "text": "as well as uh your body control module uh that body control module is then",
    "start": "152800",
    "end": "158000"
  },
  {
    "text": "connected to the low speeed bus shown in red which is connected to some things like door controllers yes there's a",
    "start": "158000",
    "end": "164560"
  },
  {
    "text": "controller in most of the doors in the car nowadays uh also an instrument panel",
    "start": "164560",
    "end": "169879"
  },
  {
    "text": "that reads out your speed and uh engine RPM uh you know there's controllers now in pretty much everything in a car",
    "start": "169879",
    "end": "176120"
  },
  {
    "text": "they're just giant computers uh to the point where if you have automatic seats that move back and forth electronically",
    "start": "176120",
    "end": "182920"
  },
  {
    "text": "that probably has a microcontroller that's likely hooked up to a can buas or something similar so why might you care uh",
    "start": "182920",
    "end": "190560"
  },
  {
    "start": "188000",
    "end": "188000"
  },
  {
    "text": "hopefully you're interested in the stuff or you wouldn't have come here but uh in case you have no idea can is used a lot",
    "start": "190560",
    "end": "196799"
  },
  {
    "text": "in industrial Control Systems it's used a lot in skada systems uh you'll see it",
    "start": "196799",
    "end": "201840"
  },
  {
    "text": "just sort of all over the place in uh in industrial because it's pretty good at being fa or reliable in terms of there's",
    "start": "201840",
    "end": "209120"
  },
  {
    "text": "like a CR built into the actual uh like Hardware level protocol and it also has acknowledgement built in so guaranteed",
    "start": "209120",
    "end": "215879"
  },
  {
    "text": "message delivery all this stuff that industrial people like but it's also in pretty much every car and what I mean by",
    "start": "215879",
    "end": "221799"
  },
  {
    "text": "that is every car after 2008 sold in California and I sorry and sold in the US had to have can so all of those and",
    "start": "221799",
    "end": "229760"
  },
  {
    "text": "everything after 2005 it starts to phase its way in some as early as like the early 2000s uh Mercedes was sort of the",
    "start": "229760",
    "end": "237200"
  },
  {
    "text": "first to use it and it's a direct interface with the controllers so often you're talking well when when you're",
    "start": "237200",
    "end": "242840"
  },
  {
    "text": "using this you're talking actually directly with code that's running on an embedded controller that is also",
    "start": "242840",
    "end": "248239"
  },
  {
    "text": "responsible for things like operating your engine or unlocking your doors so",
    "start": "248239",
    "end": "253280"
  },
  {
    "text": "clearly there's you know some potential to do some some interesting things so how can Works we're just going to Define",
    "start": "253280",
    "end": "259799"
  },
  {
    "text": "some terms here um first one is a bus I've already said this a few times",
    "start": "259799",
    "end": "264880"
  },
  {
    "text": "basically just a bunch of controllers connected together by can it's a can bus great a canf frame is sort of a single",
    "start": "264880",
    "end": "272000"
  },
  {
    "text": "data packet it's uh you know sort of an atomic thing that you can send out on this bus and every frame will have an",
    "start": "272000",
    "end": "278960"
  },
  {
    "text": "identifier a data length code and data so the identifier is just very simply",
    "start": "278960",
    "end": "284720"
  },
  {
    "text": "what does what is this message you know what does it mean the data length code how long is the message how many bytes",
    "start": "284720",
    "end": "291400"
  },
  {
    "text": "and finally the data is the actual data and if you draw it out it looks a little bit like this identifiers either 11 or",
    "start": "291400",
    "end": "298759"
  },
  {
    "text": "29 bits usually 11 data length code just a 4bit number and then you have your data and that's really all there is to",
    "start": "298759",
    "end": "305199"
  },
  {
    "text": "can is an identifier a data length and some data and it's as simple as",
    "start": "305199",
    "end": "310600"
  },
  {
    "text": "that so let's start with like the super easy attack that is it's so easy it's",
    "start": "310600",
    "end": "316880"
  },
  {
    "start": "311000",
    "end": "311000"
  },
  {
    "text": "almost not worth mentioning but it's sort of entertaining so I'll mention it anyway which is a denial of service uh",
    "start": "316880",
    "end": "323000"
  },
  {
    "text": "the way that arbitration Works in can so whenever people want to talk on the bus everyone sends out their identifier",
    "start": "323000",
    "end": "330280"
  },
  {
    "text": "and while they're doing this they're also listening to see what identifier is being sent so if I'm message 500 or if",
    "start": "330280",
    "end": "337680"
  },
  {
    "text": "I'm sending message 500 I'll start putting that out on the bus but if I see a lower me a lower can ID then I will",
    "start": "337680",
    "end": "345360"
  },
  {
    "text": "shut up and go into listen mode um I won't get into how the electrical part of this works but basically the lowest",
    "start": "345360",
    "end": "351560"
  },
  {
    "text": "ID always wins and gets control of the bus now what's fun about this is that",
    "start": "351560",
    "end": "356800"
  },
  {
    "text": "you can come up with a very easy proof of concept for denial of service which is just keep",
    "start": "356800",
    "end": "362160"
  },
  {
    "text": "sending a message with ID zero and if you do this nobody else can really talk because they get to the arbitration you",
    "start": "362160",
    "end": "367680"
  },
  {
    "text": "send zero everyone else goes into listen mode then they get to the next arbitration phase you send zero and this",
    "start": "367680",
    "end": "373039"
  },
  {
    "text": "keeps happening and like this is really simple stuff but it actually will do some not so nice things in a car uh",
    "start": "373039",
    "end": "379840"
  },
  {
    "text": "depends on the vehicle depends on what can bus you're on but I did this uh actually it was a company I was working at it was the CEO of the company had a",
    "start": "379840",
    "end": "386800"
  },
  {
    "text": "Chevrolet Volt and we were playing around with it and I plugged into it and I didn't",
    "start": "386800",
    "end": "392039"
  },
  {
    "text": "realize that the tool I had was sending messages when I plugged into it and I think the actual message was id4 not",
    "start": "392039",
    "end": "398680"
  },
  {
    "text": "zero but it was low enough and so what ended up happening was every fault code and every light turned on like all",
    "start": "398680",
    "end": "405680"
  },
  {
    "text": "across the dashboard like lighting up like crazy but it was a volt and the volt actually has some great fault codes",
    "start": "405680",
    "end": "412240"
  },
  {
    "text": "it doesn't just have your like service stable track service power Brak service power steering all that stuff that all",
    "start": "412240",
    "end": "418000"
  },
  {
    "text": "came up but then it comes up with because the Volt's a Hybrid engine not available which is actually my favorite",
    "start": "418000",
    "end": "424759"
  },
  {
    "text": "thing I've seen a car say other than the next line which is service soon so like if you lose your engine in a volt",
    "start": "424759",
    "end": "430759"
  },
  {
    "text": "they're expecting you to get to the service station before you you know run out of battery I guess but that was sort of a fun uh a fun message I've never",
    "start": "430759",
    "end": "437440"
  },
  {
    "text": "seen anyone recommend that I you know it's just the engine it won't it won't be that bad um so let's take a look at",
    "start": "437440",
    "end": "444319"
  },
  {
    "start": "441000",
    "end": "441000"
  },
  {
    "text": "sort of how messages move around on cam so we have an engine control module in this somewhat contrived example but this",
    "start": "444319",
    "end": "450759"
  },
  {
    "text": "is really how it works I've just changed the numbers um engine control module",
    "start": "450759",
    "end": "455960"
  },
  {
    "text": "will send a frame and it will be received by everybody on the bus in this case we are going to send it or receive",
    "start": "455960",
    "end": "462160"
  },
  {
    "text": "it with an instrument cluster and what I mean by instrument cluster is that panel of gauges that you look at while you're",
    "start": "462160",
    "end": "467520"
  },
  {
    "text": "driving and in this example we are going to decode the first two bytes as the",
    "start": "467520",
    "end": "473479"
  },
  {
    "text": "engine RPM how do we know that well we have to agree on all of this beforehand",
    "start": "473479",
    "end": "479240"
  },
  {
    "text": "nothing nothing tells you what any of the btes mean in this message other than you create a database called a can",
    "start": "479240",
    "end": "486039"
  },
  {
    "text": "database of all these uh of all these messages and you program that into every",
    "start": "486039",
    "end": "491479"
  },
  {
    "text": "controller on the bus and now those controllers are able to say oh this is message with ID hex1 123 and I know that",
    "start": "491479",
    "end": "498440"
  },
  {
    "text": "the first bytes that's engine RPM in that endianness and often there'll be",
    "start": "498440",
    "end": "504080"
  },
  {
    "text": "like a multiplication factor or maybe an Offset you got to add or subtract something to get to real value but then",
    "start": "504080",
    "end": "510800"
  },
  {
    "text": "eventually there's you do a little bit of math and it actually has real world units so in this example I just assumed",
    "start": "510800",
    "end": "516680"
  },
  {
    "text": "okay we'll just multiply by one don't add anything and we just get okay 5dc is 1500 RPM it might be a little bit more",
    "start": "516680",
    "end": "524120"
  },
  {
    "text": "complicated in a real vehicle but you know it's just a multiplication factor in an offset and once that's sent out it",
    "start": "524120",
    "end": "530120"
  },
  {
    "text": "can be received by the instrument cluster which can display it so this brings us to another really pretty easy",
    "start": "530120",
    "end": "536360"
  },
  {
    "start": "536000",
    "end": "536000"
  },
  {
    "text": "t attack to do that follows really naturally from that which which is injection uh we sort of talked about how",
    "start": "536360",
    "end": "543360"
  },
  {
    "text": "you know canbus all these controllers are just connected to it there's no routing or anything so everyone sees",
    "start": "543360",
    "end": "548920"
  },
  {
    "text": "every message and everyone can send a message with any ID there's no limitations there's no Mac addresses or",
    "start": "548920",
    "end": "555000"
  },
  {
    "text": "anything it's just identifiers so it's sort of a it's it's a trusted Network",
    "start": "555000",
    "end": "560320"
  },
  {
    "text": "they're expecting you to not put anything bad on it that's sort of the Assumption so this means that we can do",
    "start": "560320",
    "end": "567399"
  },
  {
    "text": "something simple like this we take a Rogue controller now I say Rogue controller it could be a tool you plug",
    "start": "567399",
    "end": "573800"
  },
  {
    "text": "in manually but it could also be if you found some vulnerability in a radio or",
    "start": "573800",
    "end": "579440"
  },
  {
    "text": "in the uh I don't know the telematic system or anything else that's on the",
    "start": "579440",
    "end": "585560"
  },
  {
    "text": "car that connects to the internet and remember nowadays that uh we're connecting more and more cars to the internet or connects over some other uh",
    "start": "585560",
    "end": "593160"
  },
  {
    "text": "RF link uh that's potential for one way to get in but once you have control of",
    "start": "593160",
    "end": "598839"
  },
  {
    "text": "anything on the can buus you can do stuff like this and we could just you",
    "start": "598839",
    "end": "604240"
  },
  {
    "text": "know send a different engine RPM what happens when we do that well whenever it gets up to arbitration both these",
    "start": "604240",
    "end": "611000"
  },
  {
    "text": "messages are going to get sent and uh they actually will end up getting sent out at the same time and whatever one",
    "start": "611000",
    "end": "617560"
  },
  {
    "text": "has the most zeros in it will like that value will win so if somebody sends zero and the other person sends all ones the",
    "start": "617560",
    "end": "624320"
  },
  {
    "text": "value received will be zero but if you send it faster than the real controller that's supposed to send it you you can",
    "start": "624320",
    "end": "629519"
  },
  {
    "text": "usually just take over and and really mess up operation so if you do this on a car you get that which this car actually",
    "start": "629519",
    "end": "637399"
  },
  {
    "text": "has no engine in it um we're just sending a message and as you can see it's like okay 8,000 RPM that's fun uh",
    "start": "637399",
    "end": "645560"
  },
  {
    "text": "this is a bit of a benign example it's just a really easy example to see but remember that you know cars are there's",
    "start": "645560",
    "end": "652760"
  },
  {
    "text": "so many controllers and they're making so many decisions based on this data so if you can tell a vehicle hey like",
    "start": "652760",
    "end": "659600"
  },
  {
    "text": "here's some fake data that makes you think oh uh an accelerometer is reading a very high value that might be like a",
    "start": "659600",
    "end": "666279"
  },
  {
    "text": "crash situation that could potentially have like a chain of effect um cars do",
    "start": "666279",
    "end": "672720"
  },
  {
    "text": "certain things in Crash situations they do uh certain things in different operating modes and you can you can fake",
    "start": "672720",
    "end": "678800"
  },
  {
    "text": "these things out so how do you get on a canvas uh we talked a little bit about two you know",
    "start": "678800",
    "end": "684880"
  },
  {
    "start": "680000",
    "end": "680000"
  },
  {
    "text": "pretty simple ways of sending stuff but we need to actually be able to send messages and the answer is you'll need",
    "start": "684880",
    "end": "690360"
  },
  {
    "text": "some hardware and some software most computers won't talk can directly uh MacBooks don't have a can",
    "start": "690360",
    "end": "696920"
  },
  {
    "text": "Port so you're going to need something that goes typically USB to can there's also some PCI to can stuff that nobody",
    "start": "696920",
    "end": "704480"
  },
  {
    "text": "really uses anymore and you'll also need a bit of software that just can make this easier for you to send and receive",
    "start": "704480",
    "end": "711079"
  },
  {
    "text": "messages uh also the software can often encode data into these formats I mentioned can databases that Define",
    "start": "711079",
    "end": "718000"
  },
  {
    "text": "where all the little all the bits are and what they mean uh there's tools that will take live can data and decode it",
    "start": "718000",
    "end": "723800"
  },
  {
    "text": "into real world value so you just look at you know engineerm temperature all",
    "start": "723800",
    "end": "729000"
  },
  {
    "text": "this stuff just shows up um so with a little bit of Hardware a little bit of software you can hop on on a can bus so",
    "start": "729000",
    "end": "735800"
  },
  {
    "start": "735000",
    "end": "735000"
  },
  {
    "text": "we'll start with the hardware part unfortunately a lot of this is kind of expensive uh Vector is like the I don't",
    "start": "735800",
    "end": "743120"
  },
  {
    "text": "know Holy Grail of of caned tools they're like the really expensive uh company that OEM use and not many other",
    "start": "743120",
    "end": "750279"
  },
  {
    "text": "people because the way I explain them is uh it's so expensive they don't list the price on their website you have to call",
    "start": "750279",
    "end": "755800"
  },
  {
    "text": "them and ask uh kasser is another pretty expensive Tool uh they're also a pain to",
    "start": "755800",
    "end": "762120"
  },
  {
    "text": "work with uh moving down in the price list you got Peak grid connect same",
    "start": "762120",
    "end": "767600"
  },
  {
    "text": "thing with a different sticker on it that's you know 250 bucks $300 uh this one's not bad it's got some",
    "start": "767600",
    "end": "774639"
  },
  {
    "text": "support for socket can which we'll talk about later but it's not not the best tool I've seen out there uh it's got",
    "start": "774639",
    "end": "781519"
  },
  {
    "text": "some weird issues with VMS in particular uh there's the Ecom cable which I haven't used but was what was used by uh",
    "start": "781519",
    "end": "788199"
  },
  {
    "text": "Charlie uh Miller and Chris valc in their research and it's you know 150",
    "start": "788199",
    "end": "794720"
  },
  {
    "text": "bucks I think for that tool and it just gives you an interface with you take some dll and you can write your own",
    "start": "794720",
    "end": "800000"
  },
  {
    "text": "scripts for it moving down in price you got the open source options which",
    "start": "800000",
    "end": "805120"
  },
  {
    "text": "include the Good thopter by guy named Andrew Ryder which it's actually the",
    "start": "805120",
    "end": "810160"
  },
  {
    "text": "good fet if you've seen Travis good feeds good fet it's that for can and",
    "start": "810160",
    "end": "815560"
  },
  {
    "text": "yeah it does Cy USB for you only problem is you can't really buy them uh you can get a board and solder it up yourself",
    "start": "815560",
    "end": "822040"
  },
  {
    "text": "obino is sort of the same thing it's uh it's an Arduino clone that was originally meant to be like a dash unit",
    "start": "822040",
    "end": "828720"
  },
  {
    "text": "that you could read OBD messages which we'll also talk about later and display them for you uh again you can you can",
    "start": "828720",
    "end": "835160"
  },
  {
    "text": "build one of those yourself and then KCT is a tool that I'm working on which we'll talk about later that looks like this uh and you know USB goes in one",
    "start": "835160",
    "end": "842839"
  },
  {
    "text": "side can comes out the other last one are these elm327 knockoffs which are kind of neat uh these do a bunch of",
    "start": "842839",
    "end": "849240"
  },
  {
    "text": "protocols that is are for OBD2 uh it's not always can OBD2 it's",
    "start": "849240",
    "end": "855160"
  },
  {
    "text": "it's this diagnostic protocol that uses like five different electrical signaling things uh depending on the car it'll do",
    "start": "855160",
    "end": "862440"
  },
  {
    "text": "all of them and you can get these from like deal extreme for 10 bucks which is pretty fun if you just want to play around with it like go deal stream and",
    "start": "862440",
    "end": "869519"
  },
  {
    "text": "buy one there's no reason not to uh I recommend a USB one instead of a Bluetooth one though for all the reasons",
    "start": "869519",
    "end": "876600"
  },
  {
    "text": "that we're discussing um on the software side you have the proprietary tools but really I",
    "start": "876600",
    "end": "883800"
  },
  {
    "start": "879000",
    "end": "879000"
  },
  {
    "text": "don't care about those they're expensive and uh we're focus on the free ones so",
    "start": "883800",
    "end": "888880"
  },
  {
    "text": "socket can can you tills and vcan these are some things built into the Linux kernel uh you got wire shark which is",
    "start": "888880",
    "end": "896279"
  },
  {
    "text": "something you've probably used for looking at IP Networks but we can use it for can too and it's really handy and",
    "start": "896279",
    "end": "902120"
  },
  {
    "text": "then this kard tool which is a python tool kit that I'm working on that just makes scripting some of this",
    "start": "902120",
    "end": "907920"
  },
  {
    "text": "easier so let's start with socket can uh socket can it pretty much gives you a a",
    "start": "907920",
    "end": "917240"
  },
  {
    "start": "910000",
    "end": "910000"
  },
  {
    "text": "Unix Network device like a typical eth0 except it's can zero and you can",
    "start": "917240",
    "end": "923199"
  },
  {
    "text": "literally interface with it using like if config and it's it's great you can even like do routes if you want to which",
    "start": "923199",
    "end": "930560"
  },
  {
    "text": "sort of works um and once you once you get that working you can use the can yous package to use these tools like can",
    "start": "930560",
    "end": "938399"
  },
  {
    "text": "send can dump and can gen which we'll take a look at one nice thing is that this is now included in the Unix kernel",
    "start": "938399",
    "end": "945120"
  },
  {
    "text": "or in the Linux Kel by default if you install like the latest Ubuntu this is in there you'll have to type like maybe",
    "start": "945120",
    "end": "952560"
  },
  {
    "text": "mod probe something uh you don't even need that actually just it just works uh and then you can app get all these tools",
    "start": "952560",
    "end": "960160"
  },
  {
    "text": "which makes it really easy to work with rather than you know you don't to build anything from scratch it just works and so I'm just going to show what that",
    "start": "960160",
    "end": "966680"
  },
  {
    "text": "looks like uh just really quickly these are simple tools but I have wire shark",
    "start": "966680",
    "end": "972560"
  },
  {
    "text": "up at the top I'm sorry the resolution's a little sketchy but hopefully legible uh wire sharks up the top which will",
    "start": "972560",
    "end": "979000"
  },
  {
    "text": "show us what's going on and I'm going to use the vcan uh module so vcan rather",
    "start": "979000",
    "end": "985120"
  },
  {
    "text": "than sending real messages and receiving real messages just let you do it all in memory and it's just a local virtual can",
    "start": "985120",
    "end": "992720"
  },
  {
    "text": "device so if I just do a can gen V can zero we'll get some traffic and wire",
    "start": "992720",
    "end": "999079"
  },
  {
    "text": "shark will nicely present that and you know you can you can take a look at it uh sadly we can't see all the way across",
    "start": "999079",
    "end": "1005040"
  },
  {
    "text": "but you you will see the typical what you'd expect to on on wire shark uh data",
    "start": "1005040",
    "end": "1012079"
  },
  {
    "text": "length the ID is over there it well let me get that far over but uh yeah it's",
    "start": "1012079",
    "end": "1017800"
  },
  {
    "text": "just an easy way of dumping of dumping that data if you want to do it in an even uh simpler way you can",
    "start": "1017800",
    "end": "1024160"
  },
  {
    "text": "run uh I've resized my window we can run can dump vcan zero and this is just",
    "start": "1024160",
    "end": "1030760"
  },
  {
    "text": "going to dump out all the messages if you plug a device into a car though and do this you'll get a very very fast rate",
    "start": "1030760",
    "end": "1036360"
  },
  {
    "text": "of data with a whole bunch of real live car data flying by and wi shark's just a",
    "start": "1036360",
    "end": "1042400"
  },
  {
    "text": "great way to be able to filter that stuff out um so on the topic of wire Shar",
    "start": "1042400",
    "end": "1050440"
  },
  {
    "start": "1050000",
    "end": "1050000"
  },
  {
    "text": "it not only lets you you know see what's going on but it also lets you do everything you'd expect to do with a",
    "start": "1050440",
    "end": "1055520"
  },
  {
    "text": "normal IP network you can actually filter based on ID you can filter Based on data lengths you can put in columns",
    "start": "1055520",
    "end": "1062360"
  },
  {
    "text": "for Delta times to see time differences and everything that you'd expect and you can also save packet captures replay",
    "start": "1062360",
    "end": "1069120"
  },
  {
    "text": "packet captures so it it's a really great tool it actually is more powerful than most the proprietary can tools for",
    "start": "1069120",
    "end": "1075280"
  },
  {
    "text": "doing the same thing which is great because it's free um and I've been using this actually",
    "start": "1075280",
    "end": "1083280"
  },
  {
    "text": "like for work a lot because you can write custom can scripts for interfacing with whatever system and then just fire",
    "start": "1083280",
    "end": "1089400"
  },
  {
    "text": "up wire shark in the corner and it will just tell you what's going on in the bus at all times which is quite handy um",
    "start": "1089400",
    "end": "1097400"
  },
  {
    "start": "1097000",
    "end": "1097000"
  },
  {
    "text": "then we get into some custom steps so I started playing around with this and",
    "start": "1097400",
    "end": "1102799"
  },
  {
    "text": "realized that there's a lot of little scripts out there but there was no sort of nothing I could really build off of",
    "start": "1102799",
    "end": "1108200"
  },
  {
    "text": "uh so I decided to build my own little python toolkit for can called Canard which is French for duck uh Vector stole",
    "start": "1108200",
    "end": "1115960"
  },
  {
    "text": "all of the can puns from me they have canoe canalyzer canopy uh they also have",
    "start": "1115960",
    "end": "1122400"
  },
  {
    "text": "the uh Candela so they stole all those so I I was stuck with French but uh this",
    "start": "1122400",
    "end": "1129600"
  },
  {
    "text": "the idea of this software is to provide some Hardware abstraction uh to implement the protocols that are really common on",
    "start": "1129600",
    "end": "1135600"
  },
  {
    "text": "these can buses to ease uh a ating looking at canses and sending and",
    "start": "1135600",
    "end": "1141240"
  },
  {
    "text": "receiving messages and also just to make it easier to share uh these things you know if you if the hardware is",
    "start": "1141240",
    "end": "1147280"
  },
  {
    "text": "abstracted and you have any supported tool now I can give you a script and you can just run it and it works rather than",
    "start": "1147280",
    "end": "1154080"
  },
  {
    "text": "oh well you know I wrote with this for Peak and it doesn't work on casser tools or whatever way around it is so just by",
    "start": "1154080",
    "end": "1160679"
  },
  {
    "text": "making something that's not paid for by any of the people who actually make those tools means that you can make it",
    "start": "1160679",
    "end": "1165960"
  },
  {
    "text": "compatible with all the tools which is nice so what I mean by Hardware abstraction",
    "start": "1165960",
    "end": "1171600"
  },
  {
    "start": "1169000",
    "end": "1169000"
  },
  {
    "text": "well really simply uh a hardware device is a python class that has to implement",
    "start": "1171600",
    "end": "1177360"
  },
  {
    "text": "four methods start stop send and receive it can Implement more to do things like set bit rate things like that but really",
    "start": "1177360",
    "end": "1184280"
  },
  {
    "text": "this is all a can device actually needs to do uh in the most basic form so a",
    "start": "1184280",
    "end": "1190280"
  },
  {
    "text": "really simple code example if you were wondering how you actually do this is uh you know we import some stuff we're",
    "start": "1190280",
    "end": "1196799"
  },
  {
    "text": "going to create a socket can device so this is is going to bind to the can zero device as a socket we'll start that",
    "start": "1196799",
    "end": "1204080"
  },
  {
    "text": "device with dev. start then we'll make ourselves a can frame so that is a frame",
    "start": "1204080",
    "end": "1209480"
  },
  {
    "text": "with ID zero that's the identifier the data length code DLC is8 saying that it's 8 bytes long and the data is one",
    "start": "1209480",
    "end": "1217960"
  },
  {
    "text": "through eight it's not a terribly useful frame but it's a frame and then we can just do device. send or dev. send frame",
    "start": "1217960",
    "end": "1224880"
  },
  {
    "text": "and it will go out on the bus to receive a frame we just do dev. receive and we",
    "start": "1224880",
    "end": "1230120"
  },
  {
    "text": "get a frame back and then finally when we're done we can stop the device and free it up for other stuff to use so",
    "start": "1230120",
    "end": "1236640"
  },
  {
    "text": "really with those four functions imp or four methods implemented you can now write more complex protocol stuff and",
    "start": "1236640",
    "end": "1244120"
  },
  {
    "text": "have it work across different devices uh which is what we'll get into next but",
    "start": "1244120",
    "end": "1249200"
  },
  {
    "text": "first I talked about this denial of service thing and I really like it whenever an example that does something",
    "start": "1249200",
    "end": "1256120"
  },
  {
    "text": "especially something bad fits on what one slide it's it's a great when the code does that and I mean this is pretty",
    "start": "1256120",
    "end": "1262559"
  },
  {
    "text": "much the same as the last example only difference is ID is zero we set the length to eight just because while we're",
    "start": "1262559",
    "end": "1269240"
  },
  {
    "text": "spamming the bus with zeros we might as well spam it with as many zeros as possible so we just said to eight we",
    "start": "1269240",
    "end": "1274799"
  },
  {
    "text": "don't care what the data is as long as the ID is zero it's just GNA you know shoot out eight bytes of data and then",
    "start": "1274799",
    "end": "1280960"
  },
  {
    "text": "you know wild truth end um this will send many many frames a second it'll",
    "start": "1280960",
    "end": "1286240"
  },
  {
    "text": "totally lock up the the bus you will latch fault codes on every controller because it will say I haven't",
    "start": "1286240",
    "end": "1292120"
  },
  {
    "text": "communicated with the rest of the ecus uh the rest of the sorry control modules and the car in the last however many",
    "start": "1292120",
    "end": "1298520"
  },
  {
    "text": "seconds that's considered like a hard fault so you'll have to clear all those codes it's it's really a bit of a pain",
    "start": "1298520",
    "end": "1304840"
  },
  {
    "text": "but uh it does work in some Vehicles it'll actually just totally disable things like you know it'll turn off the",
    "start": "1304840",
    "end": "1311320"
  },
  {
    "text": "car essentially uh all depends on the car you're on and what can bus you're on but it can do some nasty things",
    "start": "1311320",
    "end": "1319400"
  },
  {
    "start": "1318000",
    "end": "1318000"
  },
  {
    "text": "so now that we've talked a bit about can and just the simple injecting messages and sending messages at high speeds",
    "start": "1319400",
    "end": "1326559"
  },
  {
    "text": "we're going to get into the fun bits that you know the manufacturers don't tell you about which is the diagnostic",
    "start": "1326559",
    "end": "1332760"
  },
  {
    "text": "protocols so there's really two main Diagnostics",
    "start": "1332760",
    "end": "1337960"
  },
  {
    "text": "protocols one is OBD2 and one is Unified diagnostic services conveniently OBD2 is a subset",
    "start": "1338760",
    "end": "1345840"
  },
  {
    "text": "of UDS unified diagnostic services so so we can start with OBD and build and OBD",
    "start": "1345840",
    "end": "1353559"
  },
  {
    "start": "1351000",
    "end": "1351000"
  },
  {
    "text": "it's actually a courtesy of the California air resources board they decided that every car sold in California had to have this back in 1991",
    "start": "1353559",
    "end": "1361640"
  },
  {
    "text": "because they wanted to be able to do smog tests uh so you know they mandated it and now every car has it it lets you",
    "start": "1361640",
    "end": "1368200"
  },
  {
    "text": "read basic engine data uh the vehicle RPM throttle position vehicle speed uh",
    "start": "1368200",
    "end": "1374320"
  },
  {
    "text": "math pressure so on and so forth uh you know it's it's all read only that stuff",
    "start": "1374320",
    "end": "1380159"
  },
  {
    "text": "it's interesting if you're trying to tune a car or fix a car and see what's going on that's about it you can also",
    "start": "1380159",
    "end": "1386600"
  },
  {
    "text": "read the fault codes this is actually a really great way to save money if you read your fault code and see like that's",
    "start": "1386600",
    "end": "1392039"
  },
  {
    "text": "a dead mass airflow sensor you can just replace your mass airf flow sensor and then your car usually works again and",
    "start": "1392039",
    "end": "1398320"
  },
  {
    "text": "you can save yourself a trip to the dealer um but you can also uh clear the fault codes so when that little lamp",
    "start": "1398320",
    "end": "1404960"
  },
  {
    "text": "comes on with the check engine all that means is that is some fault code somewhere and this lets you not only",
    "start": "1404960",
    "end": "1411320"
  },
  {
    "text": "read them but clear it that's really all it does not terribly exciting but somewhat useful for uh for just looking",
    "start": "1411320",
    "end": "1417159"
  },
  {
    "text": "at vehicles and getting some basic information another important thing about OBD is that they standardized this",
    "start": "1417159",
    "end": "1423520"
  },
  {
    "text": "connector that looks like that um any car you get in is going to have the The",
    "start": "1423520",
    "end": "1429480"
  },
  {
    "text": "Mating side of this connector under the dash typically by your knee somewhere if you're driving and that will give you",
    "start": "1429480",
    "end": "1436240"
  },
  {
    "text": "access to a few things at least at least one can bus in modern vehicles uh anything past 2008 like I said is going",
    "start": "1436240",
    "end": "1442640"
  },
  {
    "text": "to be canned for Diagnostics so it's going to have at least one can bus what's kind of important about uh those",
    "start": "1442640",
    "end": "1449840"
  },
  {
    "text": "connectors though is they only specify some of the pins the other pins manufacturers just kind of do their own",
    "start": "1449840",
    "end": "1457159"
  },
  {
    "text": "thing uh back to the volt actually it has two ports one on each side of the car but they conveniently break out",
    "start": "1457159",
    "end": "1464080"
  },
  {
    "text": "every single can bus to one of those ports so you can just hop on to any of them really EAS easily uh really",
    "start": "1464080",
    "end": "1469919"
  },
  {
    "text": "convenient when you want to do data logging or or look in more detail at those um but you know OBD it's kind of",
    "start": "1469919",
    "end": "1479360"
  },
  {
    "start": "1476000",
    "end": "1476000"
  },
  {
    "text": "neat but it's not the it's not the big the big picture unified diagnostic services is it's this ISO standard 14229",
    "start": "1479360",
    "end": "1487840"
  },
  {
    "text": "if you want to Google it and it defines a diagnostics system that is used by",
    "start": "1487840",
    "end": "1494679"
  },
  {
    "text": "every automotive manufacturer the reason is because when you take your car to a mechanic they're",
    "start": "1494679",
    "end": "1499960"
  },
  {
    "text": "going to use a tool like that thing up up top the Snap-on scan tool to take a look at it now they don't just get OBD",
    "start": "1499960",
    "end": "1507279"
  },
  {
    "text": "they get another set of messages that's manufacturer specific but that",
    "start": "1507279",
    "end": "1512960"
  },
  {
    "text": "manufacturer has to provide them a database and this ISO standard basically",
    "start": "1512960",
    "end": "1518080"
  },
  {
    "text": "says here's how you're going to communicate for Diagnostics and here's how you're going to provide the database",
    "start": "1518080",
    "end": "1523679"
  },
  {
    "text": "to the you know people who make these tools that way Snap-on can build one tool that can do Mercedes BMW GM all",
    "start": "1523679",
    "end": "1531960"
  },
  {
    "text": "those because it just has to speak one protocol it's also really handy when you want to reverse engineer these because",
    "start": "1531960",
    "end": "1537640"
  },
  {
    "text": "there's an ISO standard that tells you what the protocol looks like and you can just you know implement it yourself uh",
    "start": "1537640",
    "end": "1543760"
  },
  {
    "text": "so yeah usually you would have to buy a rather expensive tool like the uh s Ultra from Snap-on or the MDI from GM",
    "start": "1543760",
    "end": "1551640"
  },
  {
    "text": "that can do this then you have to pay a yearly subscription in order to get those messages and that's just a subset",
    "start": "1551640",
    "end": "1556880"
  },
  {
    "text": "that's just the messages that are considered for mechanics um there's a whole bunch of other messages that are",
    "start": "1556880",
    "end": "1563399"
  },
  {
    "text": "for the OEM that are way more interesting but how does this work this",
    "start": "1563399",
    "end": "1569399"
  },
  {
    "text": "ISO protocol that everybody uses uh it's super simple you have a client like that tool you plug it in it sends a UDS",
    "start": "1569399",
    "end": "1577000"
  },
  {
    "text": "request and then a server this is their ISO terminology the server is that uh",
    "start": "1577000",
    "end": "1582480"
  },
  {
    "text": "controller maybe an engine controller maybe a body controller maybe uh a door handle controller if you have Tesla",
    "start": "1582480",
    "end": "1588760"
  },
  {
    "text": "Model S um and that server will send back a response that's it really simple",
    "start": "1588760",
    "end": "1596159"
  },
  {
    "text": "uh all you have to do is figure out how to pack the data and you can send requests and response all",
    "start": "1596159",
    "end": "1601279"
  },
  {
    "text": "day and what kind of services are we talking about uh they're unified and diagnostic services but uh these are",
    "start": "1601279",
    "end": "1609080"
  },
  {
    "text": "this is a short list there's actually uh something like 30 of them these are some of the cooler ones I think so security",
    "start": "1609080",
    "end": "1616360"
  },
  {
    "text": "access we'll talk about a bit but this let them provide a basic level of security um it's really basic and we'll",
    "start": "1616360",
    "end": "1622720"
  },
  {
    "text": "show that it's broken uh it's been shown to be broken a few times um the routine control is a way that you could just run",
    "start": "1622720",
    "end": "1629240"
  },
  {
    "text": "arbitrary routines on the controller the idea is if you're a uh you know",
    "start": "1629240",
    "end": "1634880"
  },
  {
    "text": "servicing a car and you want to find out why a window isn't going down well now you can just actuate the window from",
    "start": "1634880",
    "end": "1640360"
  },
  {
    "text": "your scan tool you don't have to you know just push the button so now you can isolate things you can say oh well the",
    "start": "1640360",
    "end": "1646360"
  },
  {
    "text": "window goes down when I ask it to with with my scan tool but the button doesn't work so the button's probably broken a",
    "start": "1646360",
    "end": "1652399"
  },
  {
    "text": "lot of things like that where you can just do diagnostics step by step and isolate little",
    "start": "1652399",
    "end": "1658159"
  },
  {
    "text": "pieces uh read and write data by identifier this sounds pretty arbitrary and it is because these",
    "start": "1658159",
    "end": "1664799"
  },
  {
    "text": "identifiers uh identify everything from the VIN number of your car to like it's",
    "start": "1664799",
    "end": "1671960"
  },
  {
    "text": "uh I don't know look up values for the uh engine so that it can do different uh",
    "start": "1671960",
    "end": "1677600"
  },
  {
    "text": "like uh emission standard stuff to like everything you could imagine is one of",
    "start": "1677600",
    "end": "1682679"
  },
  {
    "text": "these values uh and you can read them and sometimes you can write them which is kind of cool uh especially with",
    "start": "1682679",
    "end": "1689679"
  },
  {
    "text": "things like VIN numbers and engine control values and and things like that and then there's also the memory access",
    "start": "1689679",
    "end": "1696720"
  },
  {
    "text": "which is implemented on some controllers which literally just provides you arbitrary access to memory um this is in",
    "start": "1696720",
    "end": "1704960"
  },
  {
    "text": "most cars I've seen somewhat locked down but with so many cars out there and often these implementations being done",
    "start": "1704960",
    "end": "1711640"
  },
  {
    "text": "by one company that hands it off to another company that hands it off to another company that finally puts it in the car uh there's definitely going to",
    "start": "1711640",
    "end": "1718840"
  },
  {
    "text": "be edge cases with all this stuff when you start scanning for it talking about scanning for it that's",
    "start": "1718840",
    "end": "1725760"
  },
  {
    "start": "1723000",
    "end": "1723000"
  },
  {
    "text": "one of the things that was really lacking I found with most of the stuff out there was you know this is it's an",
    "start": "1725760",
    "end": "1731440"
  },
  {
    "text": "ISO standard it should be really simple like there should be software tools out there to send and receive messages",
    "start": "1731440",
    "end": "1739000"
  },
  {
    "text": "um there really wasn't anything out there where you could just say Okay I want to do UDS and I'm going to tell you",
    "start": "1739000",
    "end": "1745760"
  },
  {
    "text": "the service and the payload and do it for me so this Canard tool I've built that",
    "start": "1745760",
    "end": "1751240"
  },
  {
    "text": "into so what this does is it starts up Imports some stuff and then it's going",
    "start": "1751240",
    "end": "1757039"
  },
  {
    "text": "to create a device I used the uh the KAC device just to be different with this",
    "start": "1757039",
    "end": "1762159"
  },
  {
    "text": "one uh this is a direct access to the to this board rather than going through",
    "start": "1762159",
    "end": "1767320"
  },
  {
    "text": "socket can the reason for that is you can sometimes have special features that aren't",
    "start": "1767320",
    "end": "1772679"
  },
  {
    "text": "supported by socket can things like listen only mode and uh doing filter",
    "start": "1772679",
    "end": "1777799"
  },
  {
    "text": "Hardware level filtering by identifier stuff like that so socket can doesn't support it so sometimes you might want",
    "start": "1777799",
    "end": "1783120"
  },
  {
    "text": "direct access uh then you can set the bit rate of most diagnostic ports I think",
    "start": "1783120",
    "end": "1789320"
  },
  {
    "text": "actually all of them are 500 kbps so you set the bit rate and you start the",
    "start": "1789320",
    "end": "1794519"
  },
  {
    "text": "device then you just assign a interface you just set up an interface and it",
    "start": "1794519",
    "end": "1800240"
  },
  {
    "text": "actually takes over that device at that point and then this gets really simple because we can just send UDS requests",
    "start": "1800240",
    "end": "1806720"
  },
  {
    "text": "and we'll get back UDS responses so what I wanted to do with this example was I",
    "start": "1806720",
    "end": "1812039"
  },
  {
    "text": "was plugged into a vehicle it was actually a Honda uh it was it was my roommate's or",
    "start": "1812039",
    "end": "1819679"
  },
  {
    "text": "is my roommate's car uh so I have to thank him for letting me plug into his car and and mess around with it I did",
    "start": "1819679",
    "end": "1826640"
  },
  {
    "text": "kill his 12volt battery while I was doing it so I feel sort of bad but uh I wanted to play around with the Honda cuz",
    "start": "1826640",
    "end": "1832360"
  },
  {
    "text": "I never played around with the Honda and one thing is I don't know where to send my messages to where are the you know",
    "start": "1832360",
    "end": "1838440"
  },
  {
    "text": "what where do I send my uh diagnostic requests to I have no idea what's what a Honda is like so I figured I'd scan and",
    "start": "1838440",
    "end": "1845360"
  },
  {
    "text": "try to get a session diagnostic session from every ID on the bus and once I get a response a positive response saying",
    "start": "1845360",
    "end": "1852720"
  },
  {
    "text": "yes youve started a diagnostic session we're good right I found a controller and on Honda it was really simple I",
    "start": "1852720",
    "end": "1858039"
  },
  {
    "text": "around this and it goes EC response for ID o x70 so what this is doing is it's going from 700 to 800 I just know having",
    "start": "1858039",
    "end": "1865200"
  },
  {
    "text": "worked on these that typically diagnostic uh messages are very high on the uh ID list of IDs reason being that",
    "start": "1865200",
    "end": "1872880"
  },
  {
    "text": "whole uh priority thing low messages get a higher priority so they don't want Diagnostics to be high priority um then",
    "start": "1872880",
    "end": "1880480"
  },
  {
    "text": "we're going to try to get a diagnostic session so UDS request uh I is just the",
    "start": "1880480",
    "end": "1886480"
  },
  {
    "text": "ID we're going to send it on then we got the service identifier 10 is the service",
    "start": "1886480",
    "end": "1891600"
  },
  {
    "text": "identifier for a diagnostic session uh the payload is is really simple for this",
    "start": "1891600",
    "end": "1896919"
  },
  {
    "text": "it's just what session would you like I would like just the standard ox1 is the default and the timeout",
    "start": "1896919",
    "end": "1904279"
  },
  {
    "text": "is2 seconds that's actually a long time for this but just uh just to give the",
    "start": "1904279",
    "end": "1910200"
  },
  {
    "text": "controller enough time to respond and then we just Loop through it and send all these and wait for something to come",
    "start": "1910200",
    "end": "1915279"
  },
  {
    "text": "back and that's what I got from the Honda uh some vehicles I know GM puts way more on that bus so you'd expect to",
    "start": "1915279",
    "end": "1921320"
  },
  {
    "text": "get a lot more responses back same with I believe Ford vehicles do the same thing uh it really depends on the",
    "start": "1921320",
    "end": "1928120"
  },
  {
    "text": "manufacturer what some people have done is that uh OBD2 port they've kind of air",
    "start": "1928120",
    "end": "1936600"
  },
  {
    "text": "not air gapped it but they put a controller uh that's immediately after it and let made it so you can only talk",
    "start": "1936600",
    "end": "1942600"
  },
  {
    "text": "to that controller the reason is mostly because when people start putting weird devic on their can bus things like these",
    "start": "1942600",
    "end": "1951120"
  },
  {
    "text": "Insurance dongles that Progressive will give you in the states or deal and Canada or you know even little data",
    "start": "1951120",
    "end": "1957559"
  },
  {
    "text": "loggers made by who knows what company that might have some issues the automotive companies don't want to be",
    "start": "1957559",
    "end": "1963559"
  },
  {
    "text": "liable for those devices obviously if you're driving down the road and your car shots down they don't want to go well that was the fault of this little",
    "start": "1963559",
    "end": "1970320"
  },
  {
    "text": "dongle that you plugged in so what they've done is they've kind of created a bridge so you can't crash that the",
    "start": "1970320",
    "end": "1977159"
  },
  {
    "text": "entire network just just by you know messing around with that first one so in this case I only saw the one",
    "start": "1977159",
    "end": "1983360"
  },
  {
    "text": "controller but in a lot of cases you will see messages get Gateway through that controller so if you read an",
    "start": "1983360",
    "end": "1988720"
  },
  {
    "text": "identifier it might actually be from a different controller in the car and it's just working its way through and working its way back um so 740 is probably just",
    "start": "1988720",
    "end": "1996799"
  },
  {
    "text": "a generic you know uh access and you can request stuff from different controllers",
    "start": "1996799",
    "end": "2002360"
  },
  {
    "text": "on it security access gets a special mention just because it's entertaining",
    "start": "2002360",
    "end": "2009000"
  },
  {
    "start": "2003000",
    "end": "2003000"
  },
  {
    "text": "um whenever they set this all up they went well okay if we're going to provide access to read and write everything well",
    "start": "2009000",
    "end": "2015919"
  },
  {
    "text": "we should probably secure it and so they set up this in the iso standard this",
    "start": "2015919",
    "end": "2021440"
  },
  {
    "text": "security access thing and it doesn't look bad in up itself it looks kind of like a normal seed key exchange right",
    "start": "2021440",
    "end": "2027159"
  },
  {
    "text": "you got a request for a seed then you get a seed back from that you generate",
    "start": "2027159",
    "end": "2033120"
  },
  {
    "text": "your key you send that to the server it checks your key based on the seed make sure matches if it does they say Okay",
    "start": "2033120",
    "end": "2041000"
  },
  {
    "text": "positive response you're good to go and I've unlocked myself if it's wrong it sends you back negative response and you",
    "start": "2041000",
    "end": "2047320"
  },
  {
    "text": "don't have access now this protects some pretty interesting things uh this",
    "start": "2047320",
    "end": "2052720"
  },
  {
    "text": "unified diagnostic services is used to do end ofline uh configuration of",
    "start": "2052720",
    "end": "2058919"
  },
  {
    "text": "vehicles so whenever your VD number gets written into your car's controllers that",
    "start": "2058919",
    "end": "2064000"
  },
  {
    "text": "happens over this protocol whenever in some cases whenever firmware gets loaded onto controllers that can happen over",
    "start": "2064000",
    "end": "2070280"
  },
  {
    "text": "this protocol there is a uh UDS service for uh upload and download data and it",
    "start": "2070280",
    "end": "2076520"
  },
  {
    "text": "is used for writing firmware so if you manage to get security access you can do some some really uh bad things but this",
    "start": "2076520",
    "end": "2085440"
  },
  {
    "text": "protocol doesn't look terrible until you start breaking down some of the assumptions they've made the first one is the seed is fixed now the reason that",
    "start": "2085440",
    "end": "2092960"
  },
  {
    "text": "they give for this is that they didn't want to put the algorithm or the like some actual important key in every",
    "start": "2092960",
    "end": "2100960"
  },
  {
    "text": "controller so instead they just put one seed in every controller and you know",
    "start": "2100960",
    "end": "2106119"
  },
  {
    "text": "it'll just send you the same seed every time so okay that already means one thing which is that the key is fixed and",
    "start": "2106119",
    "end": "2113200"
  },
  {
    "text": "that means this is 100% vulnerable to a replay attack because you know just send the same key back every time you don't",
    "start": "2113200",
    "end": "2118839"
  },
  {
    "text": "even need to look at the seed you know it's the same thing um still not so bad",
    "start": "2118839",
    "end": "2124400"
  },
  {
    "text": "because odds are unless you're logging the bus while a firmware update happens or while uh it's running through its End",
    "start": "2124400",
    "end": "2132119"
  },
  {
    "text": "of Line tests at a factory you probably won't be able to see this happen uh",
    "start": "2132119",
    "end": "2137760"
  },
  {
    "text": "though some cars now are being updated over the air so if you manage to log one of those you could definitely uh be",
    "start": "2137760",
    "end": "2145000"
  },
  {
    "text": "looking into the looking into this but the thing that's uh really great about",
    "start": "2145000",
    "end": "2150400"
  },
  {
    "text": "it is that both the seed in the key are 16 bits long uh which means you can BR",
    "start": "2150400",
    "end": "2156240"
  },
  {
    "text": "Force the key space pretty quickly they've sort of tried to stop you from doing this by putting in a delay so you",
    "start": "2156240",
    "end": "2163440"
  },
  {
    "text": "can't just send like all the requests all at once but it's not that uh it's",
    "start": "2163440",
    "end": "2169440"
  },
  {
    "text": "not that long really it's not something you can just jump in a car plug in and like crack it but if you have access to",
    "start": "2169440",
    "end": "2176359"
  },
  {
    "text": "the car or if you've taken over a controller in a car it's pretty much you know maybe a couple a couple days worst",
    "start": "2176359",
    "end": "2183040"
  },
  {
    "text": "case to get access to that there was some research done by some folks at the University of Washington that they",
    "start": "2183040",
    "end": "2188720"
  },
  {
    "text": "actually went into detail about how long these keys are how long the delays are and figured out like all the worst case",
    "start": "2188720",
    "end": "2194640"
  },
  {
    "text": "times and said like this is pretty bad they're basically just assuming that you won't do it is the what they got out of",
    "start": "2194640",
    "end": "2202680"
  },
  {
    "text": "that um so why might we want to uh look",
    "start": "2202680",
    "end": "2207800"
  },
  {
    "start": "2204000",
    "end": "2204000"
  },
  {
    "text": "into these Diagnostics well fuzzing Diagnostics basically can create a map of these controllers right so we did the",
    "start": "2207800",
    "end": "2215160"
  },
  {
    "text": "automotive or automated controller discovery that's you know a really simple example but you can extend that",
    "start": "2215160",
    "end": "2220480"
  },
  {
    "text": "example to automatically map all of the services provided by an automotive controller so you could plug in and just",
    "start": "2220480",
    "end": "2227880"
  },
  {
    "text": "request every routine every data identifier every piece of memory uh you",
    "start": "2227880",
    "end": "2233079"
  },
  {
    "text": "could request to do security access and figure out what all the different security access uh they can have",
    "start": "2233079",
    "end": "2239160"
  },
  {
    "text": "multiple levels of security access you can get all of those and really create just like a a map of all the uh",
    "start": "2239160",
    "end": "2246160"
  },
  {
    "text": "diagnostic features on a control controller and that's pretty much the starting point to playing around with this because once you know where you can",
    "start": "2246160",
    "end": "2253480"
  },
  {
    "text": "look uh it's you just start pulling stuff out you can create memory Maps pretty much of of a controller you can",
    "start": "2253480",
    "end": "2260240"
  },
  {
    "text": "take a look at uh where these values are you can try to write things and figure out if you need security access and of",
    "start": "2260240",
    "end": "2266520"
  },
  {
    "text": "course you can brute force that security access key if you so wish so the concept",
    "start": "2266520",
    "end": "2272319"
  },
  {
    "text": "of just fuzzing Diagnostics uh I think's an interesting thing because the aut of",
    "start": "2272319",
    "end": "2278520"
  },
  {
    "text": "Manufacturers didn't really expect or didn't really care about people plugging",
    "start": "2278520",
    "end": "2283640"
  },
  {
    "text": "into these buses right they designed the cars in such a way that they figured H well no one's going to play around with",
    "start": "2283640",
    "end": "2289839"
  },
  {
    "text": "this and as long as you know you can't remotely do it it shouldn't be a problem so one side is we're starting to see",
    "start": "2289839",
    "end": "2295960"
  },
  {
    "text": "that as we connect cars to the internet more you get attacks like the recent bmw1 where oh they did authentication",
    "start": "2295960",
    "end": "2302400"
  },
  {
    "text": "over HTTP and you could create a fake uh GSM base station and and you know man in",
    "start": "2302400",
    "end": "2308240"
  },
  {
    "text": "the middle it but the other side is that you that lets people potentially get",
    "start": "2308240",
    "end": "2313319"
  },
  {
    "text": "access to these cam buses and exposes a whole bunch of functionality that the automotive folks just never really",
    "start": "2313319",
    "end": "2320280"
  },
  {
    "text": "secured so most of the stuff in automotive security is like oh it's it's just there and you can do it and the",
    "start": "2320280",
    "end": "2326160"
  },
  {
    "text": "reason is because they just weren't expecting anyone to track so uh just to conclude here we",
    "start": "2326160",
    "end": "2332480"
  },
  {
    "start": "2329000",
    "end": "2329000"
  },
  {
    "text": "talked about sort of three different types of attacks that you can pull off the first two are pretty simple just",
    "start": "2332480",
    "end": "2337960"
  },
  {
    "text": "sending messages will let you do it uh a denial of service which is pretty easy",
    "start": "2337960",
    "end": "2343160"
  },
  {
    "text": "um you know just Spam zeros an injection attack which it's really going to depend on what you're injecting but you can",
    "start": "2343160",
    "end": "2351839"
  },
  {
    "text": "fake out a lot of signals and just really confuse a vehicle in in those cases and then Diagnostics which is",
    "start": "2351839",
    "end": "2358599"
  },
  {
    "text": "pretty much just a giant attack Vector that hasn't been looked at in too much detail in most vehicles but looking into",
    "start": "2358599",
    "end": "2366079"
  },
  {
    "text": "the implementations even if the implementations aren't bad there's concerns and then once you go past that",
    "start": "2366079",
    "end": "2371480"
  },
  {
    "text": "and look into problems where they've you know Left Behind little little things that were not implemented right it it",
    "start": "2371480",
    "end": "2378040"
  },
  {
    "text": "could be even worse um in order to play with this you'll need a hardware interface I mean I got to promote my own",
    "start": "2378040",
    "end": "2384240"
  },
  {
    "text": "I guess which is this can tact thing uh this you know Open Source Hardware tool",
    "start": "2384240",
    "end": "2389560"
  },
  {
    "text": "for for plugging into a can bus and you'll need some software I like the Linux stuff to be honest uh wire shark",
    "start": "2389560",
    "end": "2396560"
  },
  {
    "text": "is great uh this Kenard tool it's getting better I promise uh but the idea",
    "start": "2396560",
    "end": "2401920"
  },
  {
    "text": "is to make something where you can write scripts to play with cars and share them with people so they can also play with",
    "start": "2401920",
    "end": "2407359"
  },
  {
    "text": "cars because automotive security has been pretty much security through obscurity to be honest and now that we",
    "start": "2407359",
    "end": "2413640"
  },
  {
    "text": "can start to look at it and make it easier to get on these systems we can actually start to have some fun so",
    "start": "2413640",
    "end": "2419599"
  },
  {
    "text": "that's pretty much my main part of my talk here but I definitely want to move into questions about anything to do with",
    "start": "2419599",
    "end": "2425319"
  },
  {
    "text": "cars security and uh anything else you have on your mind so over at the back",
    "start": "2425319",
    "end": "2432640"
  },
  {
    "text": "there okay so the question was do they share code for the implementations or do they write their own in a lot of cases",
    "start": "2438640",
    "end": "2444560"
  },
  {
    "text": "they buy it from some vendors uh actually it's kind of fun to explain how",
    "start": "2444560",
    "end": "2450240"
  },
  {
    "text": "Automotive code gets written so let's say you work at an automotive company as a software developer you probably don't",
    "start": "2450240",
    "end": "2457720"
  },
  {
    "text": "write any C or any anything that's in text uh you might write some mat lab",
    "start": "2457720",
    "end": "2464040"
  },
  {
    "text": "scripts most the actual development of Automotive control algorithms is done in simulink and if you're familiar with",
    "start": "2464040",
    "end": "2470839"
  },
  {
    "text": "simulink you'll know it's the graphical part of mat lab which literally is drag and drop blocks and connect them",
    "start": "2470839",
    "end": "2476920"
  },
  {
    "text": "together with wires that's how they develop these things and that's what most the people working in software",
    "start": "2476920",
    "end": "2482520"
  },
  {
    "text": "positions that Automotive companies do once they're done that uh you Pro type",
    "start": "2482520",
    "end": "2487599"
  },
  {
    "text": "on a prototype controller so I I kid you not you take your diagram you hold control press B and out pops like an",
    "start": "2487599",
    "end": "2494920"
  },
  {
    "text": "executable and you flash that to a controller and it usually works pretty well once they're done that development",
    "start": "2494920",
    "end": "2501119"
  },
  {
    "text": "process they'll work with an actual uh company that makes a production controller like a deli or a Bosch or",
    "start": "2501119",
    "end": "2507520"
  },
  {
    "text": "somebody and working along with them they can actually get the cost down and",
    "start": "2507520",
    "end": "2514040"
  },
  {
    "text": "get it into something they can put in a car but all the code for things like can",
    "start": "2514040",
    "end": "2519839"
  },
  {
    "text": "uh things like the diagnostic Stacks they typically buy from one of a few companies probably the most common is",
    "start": "2519839",
    "end": "2526359"
  },
  {
    "text": "Vector who make the can tools as well uh they sell stacks for uh UDS they sell",
    "start": "2526359",
    "end": "2533000"
  },
  {
    "text": "stacks for uh just generic can on different microcontrollers all sorts of stuff so the answer is yeah a lot of it",
    "start": "2533000",
    "end": "2539240"
  },
  {
    "text": "shared but even more concerning a lot of it is cobbled together from different sources and then like",
    "start": "2539240",
    "end": "2544880"
  },
  {
    "text": "shipped um any other questions kicking around",
    "start": "2544880",
    "end": "2551400"
  },
  {
    "text": "here I didn't see that",
    "start": "2553240",
    "end": "2556839"
  },
  {
    "text": "one okay the question was uh how could you brick a car uh apparently Charlie Miller managed to Brick his car and",
    "start": "2564079",
    "end": "2570480"
  },
  {
    "text": "posted about it on Twitter um I'd say one of the biggest things is if it's a car that does have ridable flash for uh",
    "start": "2570480",
    "end": "2577960"
  },
  {
    "text": "for firmware obviously if you you know write some junk firmware to a controller it's probably gonna going to not end",
    "start": "2577960",
    "end": "2584359"
  },
  {
    "text": "well other things you could do if you start messing around with vin numbers uh cars often have checks to make sure that",
    "start": "2584359",
    "end": "2590920"
  },
  {
    "text": "all the VIN numbers and controllers match so if you uh you know start playing around with that you could potentially stop a car from from",
    "start": "2590920",
    "end": "2597319"
  },
  {
    "text": "starting there's a few other checks that the car does it that stuff's really manufacturer specific and they really",
    "start": "2597319",
    "end": "2603040"
  },
  {
    "text": "don't like talking about it but the immobilizer um so the thing that actually make sure that you have a key",
    "start": "2603040",
    "end": "2610480"
  },
  {
    "text": "those use some weird challenge response stuff and you know if you mess with any",
    "start": "2610480",
    "end": "2615800"
  },
  {
    "text": "of that if you screw up any of the uh the seeds for that or anything then the",
    "start": "2615800",
    "end": "2621280"
  },
  {
    "text": "car will no longer do a proper immobilization uh unlock and then the car won't be able to start so I think",
    "start": "2621280",
    "end": "2628040"
  },
  {
    "text": "pretty much any of those but the firmware one is probably like once you break the UDS code if if it supports",
    "start": "2628040",
    "end": "2633760"
  },
  {
    "text": "flashing which quite a few controllers do you can just like yeah write zeros to",
    "start": "2633760",
    "end": "2638800"
  },
  {
    "text": "your firmware and that's definitely going to break a car",
    "start": "2638800",
    "end": "2645400"
  },
  {
    "text": "yep so it sort of depends what level you want to do it at you can fuzz like a raw",
    "start": "2652520",
    "end": "2657720"
  },
  {
    "text": "canbus which I didn't talk about too much but someone I was talking to today was doing that with uh with planes which",
    "start": "2657720",
    "end": "2663680"
  },
  {
    "text": "sounds terrifying but uh essentially you can you know uh you could send uh Rand or",
    "start": "2663680",
    "end": "2671640"
  },
  {
    "text": "send arbitrary data uh just in messages and kind of see what the responses were",
    "start": "2671640",
    "end": "2677119"
  },
  {
    "text": "so if you pick okay here's one great example if you wanted to find where uh the message",
    "start": "2677119",
    "end": "2684079"
  },
  {
    "text": "was that was controlling something like your vehicle speed or that was showing your vehicle speed you could you know go",
    "start": "2684079",
    "end": "2689520"
  },
  {
    "text": "through messages and send junk data until you manage like randomly through messages until you manage to get the expected vehicle speed to show up on a",
    "start": "2689520",
    "end": "2696040"
  },
  {
    "text": "display uh so that's kind of the really low level of you can fuzz raw like literally btes then going one level up",
    "start": "2696040",
    "end": "2703760"
  },
  {
    "text": "you can uh do fuzzing at the implementation level of the Diagnostics",
    "start": "2703760",
    "end": "2709240"
  },
  {
    "text": "so in that case you can try one great example that I don't have the uh I don't",
    "start": "2709240",
    "end": "2715720"
  },
  {
    "text": "have the I'm scared to do this on a real car is you can just ask it that routine",
    "start": "2715720",
    "end": "2723119"
  },
  {
    "text": "Control Function you can just ask it to run routine zero through through ffffff",
    "start": "2723119",
    "end": "2728680"
  },
  {
    "text": "and it's going to do a lot of things and you who knows what it's going to do the manufacturer does but you don't so you",
    "start": "2728680",
    "end": "2736079"
  },
  {
    "text": "know by trying these things out you can you can start to figure out what it is and something like that is something you're going to want to do definitely",
    "start": "2736079",
    "end": "2741640"
  },
  {
    "text": "with the controller on a bench hopefully and not in a car but uh as you start to look at that you can reverse engineer",
    "start": "2741640",
    "end": "2747720"
  },
  {
    "text": "sort of what what are these actions and what abilities does that give",
    "start": "2747720",
    "end": "2752960"
  },
  {
    "text": "me oh I I got the pr not good at self-promotion I'm sorry but uh there there's like a",
    "start": "2754119",
    "end": "2761359"
  },
  {
    "text": "website there which is K.O uh there's like nine of them or something left from my I did a first",
    "start": "2761359",
    "end": "2767839"
  },
  {
    "text": "batch of them there's not many left uh if that ends up selling out I guess I'll make more uh but yeah it's it's kind of",
    "start": "2767839",
    "end": "2776400"
  },
  {
    "text": "fun doing Open Source Hardware for stuff like this because uh you know a lot of this has",
    "start": "2776400",
    "end": "2782559"
  },
  {
    "text": "been obscure and the tools were expensive and if I can make it cheaper to play with that's that's kind of fun",
    "start": "2782559",
    "end": "2788599"
  },
  {
    "text": "also if you want to build your own you can download the Gerber files and like ET your own board at home or or",
    "start": "2788599",
    "end": "2795400"
  },
  {
    "text": "whatever",
    "start": "2795400",
    "end": "2798400"
  },
  {
    "text": "yep um depends what you mean by fragile so the question was I guess are there",
    "start": "2809599",
    "end": "2815280"
  },
  {
    "text": "risks to fuzzing the the bus and sending arbitrary stuff",
    "start": "2815280",
    "end": "2821520"
  },
  {
    "text": "um I mean you the the real concern is you know that that's a controller that's",
    "start": "2821520",
    "end": "2827119"
  },
  {
    "text": "potentially controlling an engine and an engine is a very uh complex system",
    "start": "2827119",
    "end": "2833520"
  },
  {
    "text": "nowadays mostly because of emissions regulations more than anything um an",
    "start": "2833520",
    "end": "2838599"
  },
  {
    "text": "engine has things like uh variable valve timing that lets cams move around and",
    "start": "2838599",
    "end": "2844000"
  },
  {
    "text": "slip so you know if you start fuzzing stuff and it's expecting a message that",
    "start": "2844000",
    "end": "2849480"
  },
  {
    "text": "it's using to compute some of these uh some of this stuff so if it's expecting a message to compute something to do",
    "start": "2849480",
    "end": "2854640"
  },
  {
    "text": "with how that engine's running and you fuzz it well you could potentially cause the engine to go into some terrible",
    "start": "2854640",
    "end": "2861680"
  },
  {
    "text": "State now the engine controllers are typically pretty smart they'll do a lot",
    "start": "2861680",
    "end": "2867280"
  },
  {
    "text": "of Sanity tests or checks on that data they won't just you know let you destroy",
    "start": "2867280",
    "end": "2873760"
  },
  {
    "text": "an engine um but in a real car can be you know it's probably not something you",
    "start": "2873760",
    "end": "2878880"
  },
  {
    "text": "want to be doing while driving down the road uh actually for fun we plugged in",
    "start": "2878880",
    "end": "2883960"
  },
  {
    "text": "that soless Ultra the the that guy we plugged that into a car and we drove",
    "start": "2883960",
    "end": "2889720"
  },
  {
    "text": "around waterly with it and uh we were just like pushing like honking the horn",
    "start": "2889720",
    "end": "2894839"
  },
  {
    "text": "and like doing all the it was it was fun you can you can hit the brakes actually from it which is kind of",
    "start": "2894839",
    "end": "2900119"
  },
  {
    "text": "cool but yeah it that probably wasn't you shouldn't do that now that I've said that we did it um but will you actually",
    "start": "2900119",
    "end": "2908480"
  },
  {
    "text": "break the can device no they you they'll take the messages they might overflow a bit they might you know go into some",
    "start": "2908480",
    "end": "2915000"
  },
  {
    "text": "shutdown state but you can't damage the controller the bigger concern is what the controller is actually",
    "start": "2915000",
    "end": "2922960"
  },
  {
    "text": "driving anything else oh I think I'm good all right well",
    "start": "2923520",
    "end": "2932520"
  },
  {
    "text": "I'll be around so if you do come up with questions come find me I like talking about this stuff and uh yeah thanks very much for coming",
    "start": "2932520",
    "end": "2938880"
  },
  {
    "text": "to this and thanks for your time hope you got a little bit of an introduction into Automotive Systems and how to play",
    "start": "2938880",
    "end": "2944000"
  },
  {
    "text": "with them [Applause]",
    "start": "2944000",
    "end": "2950929"
  }
]