[
  {
    "text": "two left as he moves the mic down",
    "start": "46399",
    "end": "51680"
  },
  {
    "text": "all right let's start off with a quick poll how many people here are responsible for bgp speaking routers or the security of",
    "start": "52160",
    "end": "59039"
  },
  {
    "text": "bgp speaking routers okay 20",
    "start": "59039",
    "end": "64559"
  },
  {
    "text": "how many people here have read any of the vulnerability work either the attack tree that we've published or any of the other bgp threats drafts that have been",
    "start": "64559",
    "end": "71360"
  },
  {
    "text": "published okay about the same amount all right we're going to spend the next",
    "start": "71360",
    "end": "76479"
  },
  {
    "text": "90 minutes talking about is trying to put some real numbers and real testing behind some of the bgp fud",
    "start": "76479",
    "end": "83600"
  },
  {
    "text": "that's been out there you've probably seen it in the papers you've probably seen it on websites bgp",
    "start": "83600",
    "end": "88880"
  },
  {
    "text": "is completely insecure the internet can be taken down in 15 minutes you know we're all screwed right",
    "start": "88880",
    "end": "93920"
  },
  {
    "text": "so we're going to try and talk about some real testing that we did some tools we were going to be releasing",
    "start": "93920",
    "end": "100240"
  },
  {
    "text": "today nothing spectacular but proof of concept stuff that allow you to reproduce a lot of the tests that we did",
    "start": "100240",
    "end": "107680"
  },
  {
    "text": "and we're going to detail a lot of this and try and",
    "start": "107680",
    "end": "112720"
  },
  {
    "text": "not necessarily walk away saying bgp is fine and everything's great but to point out that much of the",
    "start": "112720",
    "end": "118799"
  },
  {
    "text": "vulnerabilities around bgp have to do with the platform they're running on rather than the protocol itself",
    "start": "118799",
    "end": "125200"
  },
  {
    "text": "so my name is sean convery this is matthew franz we're both in the cisco's critical infrastructure",
    "start": "125200",
    "end": "130879"
  },
  {
    "text": "assurance group which is a group at cisco that has no product responsibility we're supposed to be completely vendor",
    "start": "130879",
    "end": "136080"
  },
  {
    "text": "neutral and our goal is to do forward-thinking research in the area of",
    "start": "136080",
    "end": "141120"
  },
  {
    "text": "critical infrastructure and that's a pretty nebulous definition which could include you know just about anything uh",
    "start": "141120",
    "end": "146720"
  },
  {
    "text": "which is which is good for our job security i guess",
    "start": "146720",
    "end": "150959"
  },
  {
    "text": "so the approach we tried to take is uh the government expressed some interest",
    "start": "153040",
    "end": "158959"
  },
  {
    "text": "in bgp security i mean rob thomas has said in the past uh any of you know thomas's he's done a lot of work with",
    "start": "158959",
    "end": "164800"
  },
  {
    "text": "isp best practices he says the internet runs on dns bgp and caffeine and you got",
    "start": "164800",
    "end": "170319"
  },
  {
    "text": "to protect all three in order to keep the internet running and so the focus of this this pa this paper this presentation we're doing is",
    "start": "170319",
    "end": "176879"
  },
  {
    "text": "focusing in on bgp uh the government with the national strategy has identified bgp as a as a critical",
    "start": "176879",
    "end": "183760"
  },
  {
    "text": "vulnerability that we need to address as a community to make this whole internet thing better",
    "start": "183760",
    "end": "189680"
  },
  {
    "text": "and so we're going to talk about some real testing in that space we're going to talk through vulnerabilities uh some",
    "start": "189680",
    "end": "195040"
  },
  {
    "text": "testing we did on implementations design vulnerabilities uh we'll analyze the best practices that are out there",
    "start": "195040",
    "end": "200640"
  },
  {
    "text": "because there's a whole list if you go and look at rob thomas's hardening template or cisco's bgp hardening template there's this huge list of",
    "start": "200640",
    "end": "207040"
  },
  {
    "text": "things you're supposed to do many of which do really good things many of which you know are have a huge administrative burden and do okay things",
    "start": "207040",
    "end": "214239"
  },
  {
    "text": "so we'll talk about the best practices that stop the attacks that are most likely and then we'll do some demos along the",
    "start": "214239",
    "end": "220000"
  },
  {
    "text": "way okay so when we started doing this uh",
    "start": "220000",
    "end": "226799"
  },
  {
    "text": "you know the first first you know rule of any research is you do some kind of literature search to figure out what works been done in the past and we found",
    "start": "226799",
    "end": "233840"
  },
  {
    "text": "a lot of work that i would call academic and theoretical in nature with",
    "start": "233840",
    "end": "239120"
  },
  {
    "text": "respect to bgp vulnerabilities these are a couple of the choice or quotes that we found during our search and they have",
    "start": "239120",
    "end": "245120"
  },
  {
    "text": "statements here that are more or less uh completely false more or less true",
    "start": "245120",
    "end": "250640"
  },
  {
    "text": "you know some of the better ones being that any outsider can inject believable bgp messages",
    "start": "250640",
    "end": "256400"
  },
  {
    "text": "outside sources can break tcp connections by spoofing resets a lot of these things that are",
    "start": "256400",
    "end": "262000"
  },
  {
    "text": "claimed because there's a there's an understanding in the ietf and in other standards bodies that well tcp because",
    "start": "262000",
    "end": "267600"
  },
  {
    "text": "it's not using ipsec or any kind of strong authentication or cryptography is completely insecure right you know it's",
    "start": "267600",
    "end": "273280"
  },
  {
    "text": "obviously better than udp but it's not something you want to rely on so we found in the testing we did that",
    "start": "273280",
    "end": "278320"
  },
  {
    "text": "security is is not necessarily a black and white where you can say all right bgp is secure or insecure it's really the",
    "start": "278320",
    "end": "284639"
  },
  {
    "text": "trade-offs that you make and this is this is probably old news to most of you",
    "start": "284639",
    "end": "289600"
  },
  {
    "text": "so the objectives that we had is we started out with an internet draft or ietf draft that we published back in the",
    "start": "292320",
    "end": "297600"
  },
  {
    "text": "fall detailing uh an attack tree for bgp how many people here have heard of attack trees just in general",
    "start": "297600",
    "end": "304639"
  },
  {
    "text": "they're a pretty good way to look at threats we're going to talk through some examples if you're not familiar with them just so you can sort of get up to",
    "start": "304639",
    "end": "309680"
  },
  {
    "text": "speed with the way we started approaching this problem because a lot of the assumptions were based around going through each",
    "start": "309680",
    "end": "316240"
  },
  {
    "text": "individual field within bgp and saying okay well this field can be exploited this way and this field can be exploited",
    "start": "316240",
    "end": "321520"
  },
  {
    "text": "this other way well instead what the testing that we did basically tried to say is all right here's what a bad guy is going to try to do with bgp or due to",
    "start": "321520",
    "end": "328960"
  },
  {
    "text": "bgp and how can you try and stop those things again we then went into looking at best",
    "start": "328960",
    "end": "334960"
  },
  {
    "text": "practices and how those are going to sort of deal with the problem i come from a network design background",
    "start": "334960",
    "end": "341600"
  },
  {
    "text": "matt comes from a product testing protocol testing background so it was a good pairing to do this work",
    "start": "341600",
    "end": "347199"
  },
  {
    "text": "and then we wanted to say all right best practices are great and you know we've had things that have been best practices",
    "start": "347199",
    "end": "353919"
  },
  {
    "text": "for years that still nobody does right so what we wanted to say is all right how many people are here are",
    "start": "353919",
    "end": "359280"
  },
  {
    "text": "actually out there doing the best practices that we recommend so to the extent we could we",
    "start": "359280",
    "end": "364400"
  },
  {
    "text": "went out on the internet and measured best practice implementation in isps and this was sort of a a non-voluntary",
    "start": "364400",
    "end": "371360"
  },
  {
    "text": "survey of isps uh using using tools that were written by our own mike schiffman",
    "start": "371360",
    "end": "376800"
  },
  {
    "text": "who's sitting down here wave mike so uh mike wrote some really cool tools which due to the recent",
    "start": "376800",
    "end": "383199"
  },
  {
    "text": "cisco vulnerability we're unable to release that particular tool because it's really bad timing but",
    "start": "383199",
    "end": "389280"
  },
  {
    "text": "the other tools you know it's not really good to say hey we're releasing a tool that allows you to survey the complete internet you know why would you want to",
    "start": "389680",
    "end": "395039"
  },
  {
    "text": "do that i don't know so this is what we'll talk through",
    "start": "395039",
    "end": "401360"
  },
  {
    "text": "okay so the methodology we went through lots of intro slides promise we'll get into the meat here soon",
    "start": "401520",
    "end": "407520"
  },
  {
    "text": "we wanted to look at the bgp specific tcp attacks again like i said earlier a lot of the vulnerabilities that have",
    "start": "407520",
    "end": "412800"
  },
  {
    "text": "been theorized around bgp have to do with attacking its transport i spoof a reset message i somehow spoof tcp to be",
    "start": "412800",
    "end": "419280"
  },
  {
    "text": "able to send a bgp update a lot of these kinds of things are all centered around tcp also if you look at the implementations",
    "start": "419280",
    "end": "425520"
  },
  {
    "text": "of bgp that are out there many of them are tightly wedded to the tcp stack so error conditions you can cause on the",
    "start": "425520",
    "end": "430960"
  },
  {
    "text": "tcp stack will potentially flow over into causing problems to bgp",
    "start": "430960",
    "end": "436240"
  },
  {
    "text": "so that was one of the things we want to look at first and that includes things like md5 authentication which we'll talk",
    "start": "436240",
    "end": "441520"
  },
  {
    "text": "about sequence number attacks those sorts of things then we did some interesting work which",
    "start": "441520",
    "end": "447039"
  },
  {
    "text": "matt's going to talk more in more detail about where we sent a series of malformed messages to a",
    "start": "447039",
    "end": "453919"
  },
  {
    "text": "representative set of bgp implementations to try and look at the implementation",
    "start": "453919",
    "end": "458960"
  },
  {
    "text": "uh vulnerabilities that might exist out there you know we've found lots of problems in you know the 50th exploit",
    "start": "458960",
    "end": "464639"
  },
  {
    "text": "for internet explorer we wanted to figure out okay what kinds of problems might be in deployed uh bgp speakers",
    "start": "464639",
    "end": "470880"
  },
  {
    "text": "today so that was one of the things we specifically set out to do again then we took the b2b attack tree",
    "start": "470880",
    "end": "476720"
  },
  {
    "text": "which details all these attacks and we try to take those that seed information from our tcp testing and our malformed",
    "start": "476720",
    "end": "482800"
  },
  {
    "text": "message testing to try and formulate what attacks are the most successful for an attacker to launch have the lowest",
    "start": "482800",
    "end": "489680"
  },
  {
    "text": "entrance requirements and have the highest impact and that's really what should be solved first there are two",
    "start": "489680",
    "end": "495199"
  },
  {
    "text": "competing proposals right now to improve the security of bgp as a protocol one is called sbgp the other is called sobgp",
    "start": "495199",
    "end": "502879"
  },
  {
    "text": "and they you know they have pros and cons but any replacement to bgp because it's",
    "start": "502879",
    "end": "508160"
  },
  {
    "text": "going to be a massive pain in the butt for large organizations and isps to roll this out better solve a lot of these",
    "start": "508160",
    "end": "514080"
  },
  {
    "text": "problems so we want to try and do some work in this space because again it was actually pretty surprising to find out",
    "start": "514080",
    "end": "519599"
  },
  {
    "text": "that you know arguably you know among the two most important protocols on the internet we weren't able to find any",
    "start": "519599",
    "end": "526000"
  },
  {
    "text": "systematic testing of implementations or designs using real tools and real you know real test methods uh you know this",
    "start": "526000",
    "end": "532320"
  },
  {
    "text": "isn't certainly 100 percent in terms of the testing we did but at least it's a start because we weren't able to find",
    "start": "532320",
    "end": "537440"
  },
  {
    "text": "anything and then uh the active or the the non-voluntary survey that we did we",
    "start": "537440",
    "end": "542959"
  },
  {
    "text": "actually uh sent a single sin packet on port 22 23 and 80 which are the three",
    "start": "542959",
    "end": "548720"
  },
  {
    "text": "command and control ports ssh telnet and web because you know even the",
    "start": "548720",
    "end": "553839"
  },
  {
    "text": "even the most basic internet you know isp administrator should know that he shouldn't allow command and",
    "start": "553839",
    "end": "559120"
  },
  {
    "text": "control in from any arbitrary ip address so if we figure if we were able to get a telnet session to somebody's router out",
    "start": "559120",
    "end": "566000"
  },
  {
    "text": "there on the internet then chances are all the more difficult to implement best practices there's no way that they",
    "start": "566000",
    "end": "571360"
  },
  {
    "text": "actually did those so and then we also looked at will people respond to a tcp 179",
    "start": "571360",
    "end": "578000"
  },
  {
    "text": "connection which is bgp can i send something on 179 and get a response and if so am i allowed to do some kind of",
    "start": "578000",
    "end": "584240"
  },
  {
    "text": "fingerprinting to figure out what kind of bgp implementation it might be how can i use that information you know",
    "start": "584240",
    "end": "589279"
  },
  {
    "text": "to potentially even even cause some problems to uh to that particular router",
    "start": "589279",
    "end": "595519"
  },
  {
    "text": "okay so most of the work if you look at the three types of vulnerabilities i'm not going to talk about those in any any level of detail but the three major ones",
    "start": "596880",
    "end": "603920"
  },
  {
    "text": "you know design implementation and misconfiguration most of the theoretical work has been around design and misconfiguration very",
    "start": "603920",
    "end": "610560"
  },
  {
    "text": "little work in implementation and trying to find flaws and implementations so that was an area we focused at focused",
    "start": "610560",
    "end": "616399"
  },
  {
    "text": "on also you know we spent some time in design so all the flaws that we found all the",
    "start": "616399",
    "end": "623200"
  },
  {
    "text": "vendors have been notified they've been given the tools necessary to reproduce the",
    "start": "623200",
    "end": "629120"
  },
  {
    "text": "conditions that we found the cert has been given a set of test cases which they have already distributed to all the",
    "start": "629120",
    "end": "634640"
  },
  {
    "text": "bgp vendors that we didn't get a chance to test no vendors that we tested or didn't test no",
    "start": "634640",
    "end": "640720"
  },
  {
    "text": "flaws that we found or didn't found are going to be disclosed in this talk so please don't ask because we don't want to get tripped up",
    "start": "640720",
    "end": "648640"
  },
  {
    "text": "all right so here's a quick attack tree example taking taking something from the physical world at the root of the attack tree",
    "start": "651920",
    "end": "657680"
  },
  {
    "text": "you can see the goal of the attacker in this case he's trying to gain unauthorized access to a building so all",
    "start": "657680",
    "end": "663200"
  },
  {
    "text": "the leaf nodes that are underneath that become the various methods that he's able to do that so he can unlock the",
    "start": "663200",
    "end": "668240"
  },
  {
    "text": "door pick the lock break the window etc and then for each one of these levels you can further elaborate",
    "start": "668240",
    "end": "673839"
  },
  {
    "text": "more sub goals blue indicating you know it's an or relationship i can either social",
    "start": "673839",
    "end": "678959"
  },
  {
    "text": "engineer to unlock the door with a key or i can steal the key or an and condition as in the case of",
    "start": "678959",
    "end": "684320"
  },
  {
    "text": "trying to follow somebody in if you're tailgating into a building you probably need to be wearing the right clothes no matter what method you're choosing to do",
    "start": "684320",
    "end": "690640"
  },
  {
    "text": "it something appropriate for the location so this gives you kind of a way to think",
    "start": "690640",
    "end": "696160"
  },
  {
    "text": "about flaws and vulnerabilities as they relate to what the attacker is going to actually do as opposed to",
    "start": "696160",
    "end": "701920"
  },
  {
    "text": "what's theoretically possible so in the attack tree that we link to at the end of this presentation",
    "start": "701920",
    "end": "708399"
  },
  {
    "text": "we talk we talk about bgp attacks in the in the attack reformat this is one of the attacks in this case resetting a bgp",
    "start": "708399",
    "end": "714959"
  },
  {
    "text": "session well i can either misconfigure a router or compromise a router to cause that connection to be reset or i can",
    "start": "714959",
    "end": "721440"
  },
  {
    "text": "send some kind of a message and the easiest way to do that is to send a tcp reset because in order to send any of",
    "start": "721440",
    "end": "726639"
  },
  {
    "text": "the bgp messages like a notify an open or keep alive i have to also get the tcp",
    "start": "726639",
    "end": "732079"
  },
  {
    "text": "sequence number guessing right anyway and if you've already gone that far why not just send the tcp reset",
    "start": "732079",
    "end": "739040"
  },
  {
    "text": "okay so this is a summary of that draft because i'm as i as i found out in the poll most of you haven't read it and i",
    "start": "740639",
    "end": "746079"
  },
  {
    "text": "certainly wouldn't have expected everybody to uh what we did was we broke down atomic goals which is what we",
    "start": "746079",
    "end": "751600"
  },
  {
    "text": "called the lowest level of the tree so these are sort of the building blocks of the larger attacks so things like",
    "start": "751600",
    "end": "757519"
  },
  {
    "text": "compromising the md5 authentication establishing an unauthorized session or changing the path preference preference",
    "start": "757519",
    "end": "763760"
  },
  {
    "text": "of a prefix when you're talking bgp essentially you're sending prefixes out between your peers to try and say okay i",
    "start": "763760",
    "end": "769839"
  },
  {
    "text": "know how to get to these 20 networks and this is the path you would use to get them or hear the different preferences",
    "start": "769839",
    "end": "775120"
  },
  {
    "text": "you might use there's all kinds of different optional parameters you might send in those bgp updates and then there's a bunch of attacks that really",
    "start": "775120",
    "end": "781120"
  },
  {
    "text": "have nothing to do with bgp which are more supporting attacks things like compromising a route or denial of servicing a router those kinds of things",
    "start": "781120",
    "end": "787519"
  },
  {
    "text": "and you take those two and kind of smush them together and you're able to do these larger attacks things like you know what would it take to try and",
    "start": "787519",
    "end": "793600"
  },
  {
    "text": "disable significant portions of the internet which is this attack that everybody's saying because bgp is so",
    "start": "793600",
    "end": "798639"
  },
  {
    "text": "insecure uh it's it's so easy to do so we tried to look at that if you're interested in more in in that i'd",
    "start": "798639",
    "end": "804320"
  },
  {
    "text": "encourage you to take a look at the draft okay so now i'm going to turn it over to matt who's going to start the",
    "start": "804320",
    "end": "809760"
  },
  {
    "text": "conversation about the specific vulnerability testing that we did",
    "start": "809760",
    "end": "815160"
  },
  {
    "text": "so tack trees can be kind of interesting a couple of years ago uh started using",
    "start": "823279",
    "end": "829279"
  },
  {
    "text": "them for several protocols when i was doing testing of cisco products and",
    "start": "829279",
    "end": "834560"
  },
  {
    "text": "they require a little bit of a change of of how you're thinking and they can lead a lot of uh",
    "start": "834560",
    "end": "840320"
  },
  {
    "text": "end up with a lot of arguments and what's the best way to represent you can get caught in this whole trap of being over formal",
    "start": "840320",
    "end": "846399"
  },
  {
    "text": "but i think i found them to be one of the more useful tools in terms of trying to",
    "start": "846399",
    "end": "851839"
  },
  {
    "text": "be comprehensive trying to anticipate all the attacks that a device or protocol or an application will expect",
    "start": "851839",
    "end": "859360"
  },
  {
    "text": "and also prioritizing and determining you know what are the what are the specific preconditions that you have to do to for",
    "start": "859360",
    "end": "866079"
  },
  {
    "text": "an attack to succeed so if you think of an attack tree as a tree",
    "start": "866079",
    "end": "871519"
  },
  {
    "text": "the leaves are tests that are specific things that either cause something to happen or they don't",
    "start": "871519",
    "end": "878240"
  },
  {
    "text": "so we we took the work we did as part of the ietf and came up with a set of tests",
    "start": "878240",
    "end": "884560"
  },
  {
    "text": "and then we wrote tools and this is basically what we uh what we came up with so we started out with with looking",
    "start": "884560",
    "end": "890399"
  },
  {
    "text": "at tcp implementations of of a variety of a variety of routers",
    "start": "890399",
    "end": "895839"
  },
  {
    "text": "because the primary belief was that tcp is insecure therefore bgp is insecure so",
    "start": "895839",
    "end": "901760"
  },
  {
    "text": "and a lot of this these tests aren't necessarily the the sexiest tests uh but you know if",
    "start": "901760",
    "end": "908480"
  },
  {
    "text": "you come from a background of you know in a product company of having to provide some level of assurance that your products aren't going to have",
    "start": "908480",
    "end": "914800"
  },
  {
    "text": "vulnerabilities and you know if you're particularly if you're in a security test team and kind of your greatest fear",
    "start": "914800",
    "end": "920160"
  },
  {
    "text": "is that somebody's going to post a bug track the next day for a product that you tested and you know that's that's no",
    "start": "920160",
    "end": "925440"
  },
  {
    "text": "fun so but so you basically come up with you want to cover all your bases first get the low hanging fruit so we start",
    "start": "925440",
    "end": "932320"
  },
  {
    "text": "with the basic tcp things that are that are pretty well known then we developed some some some attack tools",
    "start": "932320",
    "end": "939040"
  },
  {
    "text": "for for md5 for the authentication that bgp uses uh looked at some update flooding",
    "start": "939040",
    "end": "944320"
  },
  {
    "text": "attacks flooding those common ways to you know exhaust memory result in cpu exhaustion things like that",
    "start": "944320",
    "end": "950240"
  },
  {
    "text": "and then also generate variety of malformed messages uh protocol buzzing it's a popular",
    "start": "950240",
    "end": "955759"
  },
  {
    "text": "technique it you know there was a big deal when the this uh snmp these series of snmp vulnerabilities that impacted",
    "start": "955759",
    "end": "961519"
  },
  {
    "text": "nearly everybody's implementation and there was this group in finland that you know wrote a tool called produce and",
    "start": "961519",
    "end": "966959"
  },
  {
    "text": "you're probably familiar with that so basically what we did was",
    "start": "966959",
    "end": "973279"
  },
  {
    "text": "uh and one of the neat things about this project was that you know typically when i when i did product testing i'd maybe",
    "start": "973279",
    "end": "978320"
  },
  {
    "text": "see one or two implementations and you know given that a lot of the cisco products they'll just simply port the",
    "start": "978320",
    "end": "984000"
  },
  {
    "text": "implementation from one platform to another i really didn't see a variety of behavior but this way i got to see a lot",
    "start": "984000",
    "end": "990240"
  },
  {
    "text": "of different stuff and and big surprise uh you know given the ambiguity and in",
    "start": "990240",
    "end": "995279"
  },
  {
    "text": "the in the rfcs there's a lot of wiggle room for for vendors to do interesting things",
    "start": "995279",
    "end": "1000480"
  },
  {
    "text": "which can be exploited so when we did our testing we uh used pretty much the default out of the",
    "start": "1000480",
    "end": "1006560"
  },
  {
    "text": "box configuration we didn't try to tighten them down in terms of adding any sort of access",
    "start": "1006560",
    "end": "1011680"
  },
  {
    "text": "controls you know for this initial base of testing that i'm gonna be talking about or any sort of you know filtering mechanisms uh when you see test results",
    "start": "1011680",
    "end": "1019040"
  },
  {
    "text": "in here uh when possible i tried to include the number of implementations so you can get a sense of the range of",
    "start": "1019040",
    "end": "1025280"
  },
  {
    "text": "responses that we get and some when we talk about you know impact of certain flooding attacks the",
    "start": "1025280",
    "end": "1031280"
  },
  {
    "text": "uh cpu utilization and you know impact of things like that it's it's on a you know we tried to",
    "start": "1031280",
    "end": "1037038"
  },
  {
    "text": "build our network as representative possible but it's not a fully loaded network",
    "start": "1037039",
    "end": "1042400"
  },
  {
    "text": "so like sean said one of the uh one of the problems with some of the existing bgp vulnerability work is that",
    "start": "1043919",
    "end": "1050000"
  },
  {
    "text": "there there wasn't any there weren't any tests there weren't any tools so when we did our tcp and bgp testing we",
    "start": "1050000",
    "end": "1055679"
  },
  {
    "text": "used a variety of you know well-known packet construction tools that you're all probably all familiar with hp",
    "start": "1055679",
    "end": "1061120"
  },
  {
    "text": "nemesis you know netcat a variety of things like that but when we needed to do something new we did write some tools",
    "start": "1061120",
    "end": "1068080"
  },
  {
    "text": "to do that so the md5 password cracker uh the generation of the tcp option 19",
    "start": "1068080",
    "end": "1074080"
  },
  {
    "text": "for the md5 uh for the md5 authentication the hijacking",
    "start": "1074080",
    "end": "1079120"
  },
  {
    "text": "tool that's new uh the fuzzing tool was something that uh i'll talk about a little bit later",
    "start": "1079120",
    "end": "1084720"
  },
  {
    "text": "that's basically a general purpose way to generate to generate malformed messages for a wide variety of protocols",
    "start": "1084720",
    "end": "1090080"
  },
  {
    "text": "uh some simple ways to just some some python scripts that to generate opens and updates basically just you know",
    "start": "1090080",
    "end": "1097039"
  },
  {
    "text": "pretty much packed hacked together by looking at ethereal and building the packets putting you know the typical ascii",
    "start": "1097039",
    "end": "1102640"
  },
  {
    "text": "string stuff and then the the tools used for the isp survey those",
    "start": "1102640",
    "end": "1107679"
  },
  {
    "text": "were new as well so the the fuzzing tool we're not going to be",
    "start": "1107679",
    "end": "1112960"
  },
  {
    "text": "able to release that i'll talk a little bit more about that later in the future we'll probably be able to release the isp tools",
    "start": "1112960",
    "end": "1120000"
  },
  {
    "text": "so and these are available on the cisco website",
    "start": "1120000",
    "end": "1125200"
  },
  {
    "text": "so one of the kind of the first first question when you get exposed to a new protocol",
    "start": "1126400",
    "end": "1132240"
  },
  {
    "text": "and what you start thinking about is what can i do and from where so kind of the",
    "start": "1132240",
    "end": "1138320"
  },
  {
    "text": "you need to prioritize the sorts of attacks that you want to test against the protocol so",
    "start": "1138320",
    "end": "1144080"
  },
  {
    "text": "typically you go with start with what can a remote blind attacker that basically knows what the target ip",
    "start": "1144080",
    "end": "1151200"
  },
  {
    "text": "address is and that's it what can what can that attacker do and you want to make sure that your your protocol",
    "start": "1151200",
    "end": "1157520"
  },
  {
    "text": "is resistant to those sorts of attacks so typically you'll start with you know protocol negotiation uh",
    "start": "1157520",
    "end": "1164000"
  },
  {
    "text": "assuming zero knowledge and the this case sin flooding would be would be the most obvious and you know well-known",
    "start": "1164000",
    "end": "1170480"
  },
  {
    "text": "attack then you can go into tcp resource exhaustion acts later uh some of these are known as napa attacks and then as",
    "start": "1170480",
    "end": "1177360"
  },
  {
    "text": "you start to be able to send bgp message messages such as open and update",
    "start": "1177360",
    "end": "1184320"
  },
  {
    "text": "so a big surprise quite a variety of response when you start probing",
    "start": "1185679",
    "end": "1191280"
  },
  {
    "text": "bgp implementations and from you know pretty tight that are that are very difficult to to exploit to",
    "start": "1191280",
    "end": "1198720"
  },
  {
    "text": "quite quite promiscuous so you know the best case you know i'm from i'm at home on my dsl you know dsl",
    "start": "1198720",
    "end": "1207280"
  },
  {
    "text": "modem and i uh you know i start trace routing across isps and i start thinking oh these are routers okay i'll do a you",
    "start": "1207280",
    "end": "1214559"
  },
  {
    "text": "know probe to port 23. oh i get a syntax back so this must be a router now let's let's do use h ping send a 179 and oh",
    "start": "1214559",
    "end": "1221600"
  },
  {
    "text": "okay wow i get actually get a synack back so that's that's not a good thing and only one of the implementations that",
    "start": "1221600",
    "end": "1227120"
  },
  {
    "text": "we tested would you uh would it be silently dropped so that that's the the recommended behavior so",
    "start": "1227120",
    "end": "1233360"
  },
  {
    "text": "there should be no way for me you know i'm not a i'm just any arbitrary ip address i'm not a configured peer in the",
    "start": "1233360",
    "end": "1239200"
  },
  {
    "text": "bgp configuration there should be no way for me to just send that sin and get a syn act back but as you can see",
    "start": "1239200",
    "end": "1245600"
  },
  {
    "text": "that isn't the case for most of the testing so the more typical response is",
    "start": "1245600",
    "end": "1250640"
  },
  {
    "text": "uh to get a a reset act which is basically looks like a closed port",
    "start": "1250640",
    "end": "1255919"
  },
  {
    "text": "so that's that's not so bad the worst case is obviously to synack that because that's going to leave you susceptible to",
    "start": "1255919",
    "end": "1262720"
  },
  {
    "text": "tcp resource exhaustion attacks or allow you to go further along and start sending opens",
    "start": "1262720",
    "end": "1268000"
  },
  {
    "text": "so the this next says if i'm spoofing a sin from a configured pier",
    "start": "1268000",
    "end": "1274000"
  },
  {
    "text": "the goal is to see what i get back so there's an established bgp session and i spoof it from the other from the peer",
    "start": "1274000",
    "end": "1282000"
  },
  {
    "text": "the behavior is typically to either get a reset act which is a good thing because it shouldn't know i mean there's already a session established so it",
    "start": "1282000",
    "end": "1288320"
  },
  {
    "text": "should not attempt a snack but as you see on about three of the implementations there was a synagogue so",
    "start": "1288320",
    "end": "1293600"
  },
  {
    "text": "not a good thing so moving on to bgp let's say i send an open to a",
    "start": "1293600",
    "end": "1299440"
  },
  {
    "text": "non-configured peer and what i mean by non-configured peers you're not explicitly identifying that ip address",
    "start": "1299440",
    "end": "1304720"
  },
  {
    "text": "or the autonomous system number that matches up to it in the configuration so in most of the cases you get a reset",
    "start": "1304720",
    "end": "1310559"
  },
  {
    "text": "okay that's that's cool on one implementation you did get a you get an open notification back now it was",
    "start": "1310559",
    "end": "1316720"
  },
  {
    "text": "interesting when i started doing this a couple years ago i said i noticed a few of these where i would actually get an open back soaker and then when uh when",
    "start": "1316720",
    "end": "1324000"
  },
  {
    "text": "mike did the scanning of the internet we found a whole lot of them so there are a bunch there are some implementations",
    "start": "1324000",
    "end": "1329840"
  },
  {
    "text": "that we haven't tested out there and there are a relatively large number of of bgp implementations that you can send",
    "start": "1329840",
    "end": "1335520"
  },
  {
    "text": "opens to you know could be you could possibly send malformed opens to some of these and who knows maybe someone might crash",
    "start": "1335520",
    "end": "1342400"
  },
  {
    "text": "so if you have a invalid as you get two different two different",
    "start": "1342400",
    "end": "1347440"
  },
  {
    "text": "options back basically an error authentication failure of bad pure as so",
    "start": "1347440",
    "end": "1352480"
  },
  {
    "text": "if you put all this together and you maybe use some some tcp stack fingerprinting you can probably",
    "start": "1352480",
    "end": "1357679"
  },
  {
    "text": "determine the operating system and then if you take application layer stuff from telnet or http or ssh version numbers",
    "start": "1357679",
    "end": "1364159"
  },
  {
    "text": "you know the banners in the negoti negotiation you can probably determine what type of box it is",
    "start": "1364159",
    "end": "1370320"
  },
  {
    "text": "okay some of the interesting things that we ran across was you know you start sending all these opens some but some devices have you know a minute to three",
    "start": "1370799",
    "end": "1377280"
  },
  {
    "text": "minute timeouts so it made it kind of a pain in the butt when we were doing all these test cases because we had to manually reset all the sessions and then",
    "start": "1377280",
    "end": "1384320"
  },
  {
    "text": "there was there was one really funky implementation that you basically use it use netcat and hit a bunch of returns to",
    "start": "1384320",
    "end": "1391120"
  },
  {
    "text": "port 179 and it sends a bgp open back to you so we didn't try to exploit that",
    "start": "1391120",
    "end": "1396240"
  },
  {
    "text": "but uh there's some weird stuff out there",
    "start": "1396240",
    "end": "1401159"
  },
  {
    "text": "so y'all are probably familiar with sin floods been around for a long time what i've found in testing various",
    "start": "1402080",
    "end": "1409039"
  },
  {
    "text": "tcp applications is that and this is not so much true with sin floods but when you start making",
    "start": "1409039",
    "end": "1415520"
  },
  {
    "text": "connections go to the established state or or some of the other states the closing states you can cause the",
    "start": "1415520",
    "end": "1421679"
  },
  {
    "text": "application to crash or use up all the memory and there's lots of interesting things to do so we wanted to see if bgp",
    "start": "1421679",
    "end": "1427600"
  },
  {
    "text": "had the same issues so y'all are familiar with sin flooding",
    "start": "1427600",
    "end": "1433280"
  },
  {
    "text": "basically you try to exhaust the tcp backlog you know early implementations you know sun os had you know four or",
    "start": "1433280",
    "end": "1439280"
  },
  {
    "text": "eight something small like that no big deal established flooding uh last act",
    "start": "1439280",
    "end": "1445039"
  },
  {
    "text": "flooding these are these are in a uh there's a good white paper by bind view called the napa attacks and there's a",
    "start": "1445039",
    "end": "1450720"
  },
  {
    "text": "couple little tools here the srv are in uh that you can use to do these things and uh particularly against some you",
    "start": "1450720",
    "end": "1457360"
  },
  {
    "text": "know tcp based or tcp protocols that that use encryption you can sometimes do some do some interesting things",
    "start": "1457360",
    "end": "1464240"
  },
  {
    "text": "but we really uh didn't find i mean the results were kind of disappointing or",
    "start": "1464240",
    "end": "1470240"
  },
  {
    "text": "or good i don't know depending on what your your perspective is but there wasn't really the negative impact of",
    "start": "1470240",
    "end": "1476080"
  },
  {
    "text": "these attacks that we that we thought there could be so you know tc with uh sin flooding",
    "start": "1476080",
    "end": "1481840"
  },
  {
    "text": "uh i mean it was actually harder because there was a lot of talk about how easy it is to basically send floodport 179 on",
    "start": "1481840",
    "end": "1488080"
  },
  {
    "text": "a router and it's actually not the case particularly if the session is already established because in most cases",
    "start": "1488080",
    "end": "1494080"
  },
  {
    "text": "they're just they're just reset and they're not it's not going to this in received state",
    "start": "1494080",
    "end": "1499520"
  },
  {
    "text": "so you're not blocking any new connection attempts now if you were able to spoof the sin from an established peer",
    "start": "1499520",
    "end": "1506799"
  },
  {
    "text": "and the session were not already established we were able to you know prevent new sessions",
    "start": "1506799",
    "end": "1512720"
  },
  {
    "text": "from being renegotiated by basically hitting one side of the conversation so basically you're gagging",
    "start": "1512720",
    "end": "1519200"
  },
  {
    "text": "one peer and you're forcing that peer that's under attack to negotiate the session with the",
    "start": "1519200",
    "end": "1525520"
  },
  {
    "text": "other peer because bgp is weird because it both on both peers listens on 179 on both",
    "start": "1525520",
    "end": "1531919"
  },
  {
    "text": "peers it tries to connect to the other routers so whoever gets it first ends up being the client",
    "start": "1531919",
    "end": "1537200"
  },
  {
    "text": "so if you can you really if you wanted to do a a real attack against bgp using a you know a",
    "start": "1537200",
    "end": "1544240"
  },
  {
    "text": "classical sin flood you would have to basically hit both sides of the of the",
    "start": "1544240",
    "end": "1550640"
  },
  {
    "text": "both book piers and the sessions weren't already established now bgp is something that's these sessions",
    "start": "1550640",
    "end": "1556960"
  },
  {
    "text": "are up for a very long period of time and they're almost always established so low risk here",
    "start": "1556960",
    "end": "1563360"
  },
  {
    "text": "so i've already talked about that really not too much with tcp resource exhaustion",
    "start": "1563600",
    "end": "1571000"
  },
  {
    "text": "so i'll pass it over to sean for tcp sequence and vertex",
    "start": "1571200",
    "end": "1576559"
  },
  {
    "text": "all right so the whole tcp reset thing and sequence number guessing was one of the",
    "start": "1580400",
    "end": "1587039"
  },
  {
    "text": "one of the things we really wanted to make sure we addressed in our testing because like i was saying earlier a lot of the uh",
    "start": "1587039",
    "end": "1593120"
  },
  {
    "text": "theoretical vulnerabilities that had been published were based around the idea that it's relatively trivial to",
    "start": "1593120",
    "end": "1598159"
  },
  {
    "text": "spoof tcp messages as a blind attacker and i don't know if any of you have tried to do this in the real world but",
    "start": "1598159",
    "end": "1603840"
  },
  {
    "text": "we found it's actually quite a bit harder uh than than easy the reason why is",
    "start": "1603840",
    "end": "1609679"
  },
  {
    "text": "you know first off as many of you probably know to get a tcp reset to work you first have to get the four tuple right right you need the right source ip",
    "start": "1609679",
    "end": "1615919"
  },
  {
    "text": "desk ip source port and destination port but then you need the sequence number to be right and the sequence number is a 32",
    "start": "1615919",
    "end": "1621679"
  },
  {
    "text": "bit number right the same size as the entire ipv4 internet so it's sort of like trying to guess somebody's ip",
    "start": "1621679",
    "end": "1627039"
  },
  {
    "text": "address on the internet at large and having you know no information to go on",
    "start": "1627039",
    "end": "1632159"
  },
  {
    "text": "so the question is don't you have to just be within the window and the testing that we did and again the implementations is going to vary",
    "start": "1634480",
    "end": "1640559"
  },
  {
    "text": "based on what you know how close you need to be but you need to be pretty darn close and in a range of 4 billion even if you need to be within a couple",
    "start": "1640559",
    "end": "1646640"
  },
  {
    "text": "hundred it's still a huge range",
    "start": "1646640",
    "end": "1650600"
  },
  {
    "text": "so the question is do we test icmp port unreachable messages",
    "start": "1654640",
    "end": "1660120"
  },
  {
    "text": "okay i'd like to talk to you about that afterwards um we didn't do anything with icmp testing at all um and and what we",
    "start": "1669279",
    "end": "1677200"
  },
  {
    "text": "did so what we did was we wrote a basic tool to to do this um uh you know tcp kill",
    "start": "1677200",
    "end": "1684159"
  },
  {
    "text": "exists and that's that's really easy to use already um but what we wanted to do is write a tool that would allow the sequence number guessing to work uh if",
    "start": "1684159",
    "end": "1690320"
  },
  {
    "text": "you see here this is ttt which is one of the tools you can download and it's got a nemesis-like configuration you can",
    "start": "1690320",
    "end": "1695679"
  },
  {
    "text": "basically go in and specify the sequence number pretty easily in order to cause the reset assuming you",
    "start": "1695679",
    "end": "1701440"
  },
  {
    "text": "have access to the sequence number",
    "start": "1701440",
    "end": "1704799"
  },
  {
    "text": "so the thing we found though is even assuming you're able to get the tcp reset to work 50 seconds later the pier",
    "start": "1706640",
    "end": "1712559"
  },
  {
    "text": "comes back up in our test network if you have a heavily loaded bgp network it might take a couple of minutes before the pier comes back up",
    "start": "1712559",
    "end": "1718399"
  },
  {
    "text": "but it's not going to take a it's not going to be a very long a long time you know there's been some",
    "start": "1718399",
    "end": "1724480"
  },
  {
    "text": "research in the past from tim newsham and others talking about tcp initial sequence number um selection and how",
    "start": "1724480",
    "end": "1730960"
  },
  {
    "text": "some of that is flawed uh we didn't repeat any of those tests those that research has been out for several years",
    "start": "1730960",
    "end": "1736240"
  },
  {
    "text": "now so we're hoping that all the implementations have fixed this problem with varying degrees of success",
    "start": "1736240",
    "end": "1741679"
  },
  {
    "text": "we did find though that in both of the methods that we saw to do tcp you know basically with these kinds of attacks",
    "start": "1741679",
    "end": "1747520"
  },
  {
    "text": "you're trying to narrow down the amount of sequence numbers that you need to guess and both of these attacks you needed to have a large",
    "start": "1747520",
    "end": "1754399"
  },
  {
    "text": "seed of initial sequence numbers you know such as by you know sending a bunch of sins to uh to the telnet port and",
    "start": "1754399",
    "end": "1760960"
  },
  {
    "text": "measuring all those initial sequence numbers that come back if you keep doing that over and over and over again you start to be able to potentially predict",
    "start": "1760960",
    "end": "1766960"
  },
  {
    "text": "what the next sequence number is going to be but if you're implementing best practices properly on your router there should be no way you can implement or",
    "start": "1766960",
    "end": "1773200"
  },
  {
    "text": "initiate a tcp communication to one of these routers which makes that c data impossible",
    "start": "1773200",
    "end": "1778480"
  },
  {
    "text": "so uh in all the testing we found we found that this is a very very difficult thing to try to do",
    "start": "1778480",
    "end": "1784880"
  },
  {
    "text": "we also found that you also need to get the source port right right so if if implementations were to move",
    "start": "1784880",
    "end": "1790559"
  },
  {
    "text": "towards a pseudorandom source port and many of them don't today then that essentially adds another 16 bits to the",
    "start": "1790559",
    "end": "1796320"
  },
  {
    "text": "to the number space you have to go to so you go from 2 to 32 to the 48 in terms of the number space you've got to guess",
    "start": "1796320",
    "end": "1804158"
  },
  {
    "text": "okay so we said all right theoretically let's just look at the math behind this if we were able to generate a million packets per second on the wire um",
    "start": "1805919",
    "end": "1812559"
  },
  {
    "text": "and we had a you know a link that was able to deal with a million packets per second it would take about 30 minutes just to guess a single sequence number",
    "start": "1812559",
    "end": "1818960"
  },
  {
    "text": "that single 32-bit number assuming about halfway through it gets it right and there may be some things you can do to now that window down but it's going to",
    "start": "1818960",
    "end": "1825279"
  },
  {
    "text": "be a large a large number the tool we generated and optimized in c",
    "start": "1825279",
    "end": "1830720"
  },
  {
    "text": "we were able to generate 62 000 packets per second so that bumps it to about 9 hours now sure there are different things you",
    "start": "1830720",
    "end": "1836880"
  },
  {
    "text": "could do you could do some kind of a distributed.net kind of a thing where you have a whole bunch of machines trying to do this at once and you",
    "start": "1836880",
    "end": "1842159"
  },
  {
    "text": "distribute chunks of the sequence number space to try and guess but if everybody's doing that at 62 000",
    "start": "1842159",
    "end": "1847520"
  },
  {
    "text": "packets per second you have other problems on your router right you've got link saturation you've got packet loss",
    "start": "1847520",
    "end": "1852960"
  },
  {
    "text": "you've got all kinds of other things going on well before any sequence number gets reset",
    "start": "1852960",
    "end": "1858960"
  },
  {
    "text": "now also as as matt was saying since either side is just as likely to initiate communication on port 179 you",
    "start": "1859279",
    "end": "1866480"
  },
  {
    "text": "have to go after both sides because you're not sure which side is 179 is a blind attacker so that essentially",
    "start": "1866480",
    "end": "1872000"
  },
  {
    "text": "doubles everything you've got to do and then you know just for fun we said all right if people were to go to",
    "start": "1872000",
    "end": "1877520"
  },
  {
    "text": "pseudorandom source ports that makes this really really nasty and you start going into you know centuries to try and",
    "start": "1877520",
    "end": "1882799"
  },
  {
    "text": "guess the stuff so again you know the walk away is these kinds of attacks will be very very high",
    "start": "1882799",
    "end": "1888080"
  },
  {
    "text": "in packet per second count larger isps are going to notice it because they're probably spending a lot more time watching this stuff and the",
    "start": "1888080",
    "end": "1894320"
  },
  {
    "text": "smaller isps are going to notice it because their length sizes are smaller and you probably flooded their link and now all their customers can't get out on",
    "start": "1894320",
    "end": "1900640"
  },
  {
    "text": "the wire so they're going to they're going to call and want to know what's going on",
    "start": "1900640",
    "end": "1906120"
  },
  {
    "text": "okay so but again this all goes away if you're doing our best practice is right so rfc",
    "start": "1907279",
    "end": "1914159"
  },
  {
    "text": "2827 if you're unfamiliar with it how many people are familiar with it by the way ingress filtering anti-spoof rfc",
    "start": "1914159",
    "end": "1919840"
  },
  {
    "text": "basically it says you know if i own the you know 10 you know i wouldn't own the 10. let's say on the 11 network the",
    "start": "1919840",
    "end": "1925120"
  },
  {
    "text": "class a i should set myself up so that nobody can send packets to me with the source address of the 11 network because",
    "start": "1925120",
    "end": "1931760"
  },
  {
    "text": "that's my network and that must mean somebody's trying to spoof me well as an isp if i were to set that up so that nobody can send packets to me if i own",
    "start": "1931760",
    "end": "1938720"
  },
  {
    "text": "the 11 network i can prevent people from trying to communicate with me prevent people from doing any of this tcp",
    "start": "1938720",
    "end": "1943919"
  },
  {
    "text": "spoofing and all this stuff goes away so if everybody would implement rfc 2827 ip",
    "start": "1943919",
    "end": "1949679"
  },
  {
    "text": "spoofing with the exception of the last octet of the subnet you're in mostly goes away but in the case of an isp",
    "start": "1949679",
    "end": "1956240"
  },
  {
    "text": "trying to prevent some of these bgp attacks or a large organization just doing ingress filtering against bgp will",
    "start": "1956240",
    "end": "1962720"
  },
  {
    "text": "solve a lot of these problems even if the bcps weren't turned on this is an awful lot of work a really high",
    "start": "1962720",
    "end": "1968559"
  },
  {
    "text": "level of packet count to achieve five minutes of downtime 50 seconds in a lightly loaded network",
    "start": "1968559",
    "end": "1974320"
  },
  {
    "text": "and then you need to keep doing this over and over again because as soon as you reset the session it comes right back up congratulations you know the",
    "start": "1974320",
    "end": "1979600"
  },
  {
    "text": "asymmetric nature of the internet the larger the isp the more likely they are to have large numbers of asymmetric",
    "start": "1979600",
    "end": "1984640"
  },
  {
    "text": "links all over the place so you need to somehow coordinate this and get you know hundreds of people around the world thousands of people around the world",
    "start": "1984640",
    "end": "1990480"
  },
  {
    "text": "just keep doing this over and over again and figure out a way to to narrow the sequence number down to be a manageable",
    "start": "1990480",
    "end": "1996399"
  },
  {
    "text": "range of of space that you have to go through and again link saturation is probably",
    "start": "1996399",
    "end": "2001519"
  },
  {
    "text": "going to hit first question turns back",
    "start": "2001519",
    "end": "2005720"
  },
  {
    "text": "is once you brought the link down you can simply both sides yeah so if you were to get the reset to occur and then",
    "start": "2011200",
    "end": "2018559"
  },
  {
    "text": "at the same time somehow sinful both sides at the same time and get those packets out",
    "start": "2018559",
    "end": "2024000"
  },
  {
    "text": "before the before the router re-initiates the session you could cause some level of",
    "start": "2024000",
    "end": "2030640"
  },
  {
    "text": "flooding but in the testing that we did it was never a permanent thing it would just slow things down and eventually",
    "start": "2030640",
    "end": "2036080"
  },
  {
    "text": "they would be able to communicate so shifting gears into md5 those of you who",
    "start": "2036080",
    "end": "2041919"
  },
  {
    "text": "are unfamiliar with bgp it actually does have a security mechanism not a particularly strong one that's detailed",
    "start": "2041919",
    "end": "2047679"
  },
  {
    "text": "in rfc 2385 this is the mb5 signature it is not a bgp specific function",
    "start": "2047679",
    "end": "2053520"
  },
  {
    "text": "although bgp is the only place where it's used it's actually a tcp option option 19 which essentially takes a bunch of the",
    "start": "2053520",
    "end": "2060240"
  },
  {
    "text": "tcp fields a bunch of the ip fields uh you know zeroes out the checksum adds in the payload and then it concatenates that",
    "start": "2060240",
    "end": "2067118"
  },
  {
    "text": "with whatever md5 secret you define and then creates an md5 digest and puts that in option 19 and sends that along the",
    "start": "2067119",
    "end": "2073520"
  },
  {
    "text": "wire so if you know if this side of the room is ispa and this side of the room is ispb and you're trying to appear with",
    "start": "2073520",
    "end": "2078560"
  },
  {
    "text": "one another all of you all you need to share is that individual secret in order to be able to communicate with one",
    "start": "2078560",
    "end": "2083599"
  },
  {
    "text": "another however just like um cracking password files with a",
    "start": "2083599",
    "end": "2089358"
  },
  {
    "text": "dictionary attack because because an attacker is able to know everything except for the password itself we found",
    "start": "2089359",
    "end": "2095520"
  },
  {
    "text": "that you're able to essentially do a dictionary attack if you are able to get access to the packet on the wire",
    "start": "2095520",
    "end": "2100960"
  },
  {
    "text": "so we wrote a proof of concept tool called bgb crack which you can download and what it does is it basically sits",
    "start": "2100960",
    "end": "2107440"
  },
  {
    "text": "there and watches the wire and or actually you do that via tcp dump and",
    "start": "2107440",
    "end": "2112720"
  },
  {
    "text": "then you essentially run bgp crack against it and it will sit there and churn through passwords until it matches",
    "start": "2112720",
    "end": "2118480"
  },
  {
    "text": "the right md5 signature that's the same as the one that was originally sent in the packet and then it knows what the",
    "start": "2118480",
    "end": "2123599"
  },
  {
    "text": "password is and it lets you know so this is just trying to drive home the point that just because you're using md5 for",
    "start": "2123599",
    "end": "2128800"
  },
  {
    "text": "your routing protocols you know it doesn't mean you're allowed to use the password of cisco 123 or cisco or",
    "start": "2128800",
    "end": "2134480"
  },
  {
    "text": "password right you know just because it's not sent doesn't mean it can't be determined you know particularly in",
    "start": "2134480",
    "end": "2139520"
  },
  {
    "text": "large organizations where you might be running ibgp internally and somebody's able to do some kind of arp spoofing or",
    "start": "2139520",
    "end": "2145680"
  },
  {
    "text": "mac flooding in order to get access to the packets so it also can work with john the ripper so you can take john the ripper's",
    "start": "2145680",
    "end": "2151520"
  },
  {
    "text": "incremental mode which which i've got on the next slide and i'll show you then",
    "start": "2151520",
    "end": "2157359"
  },
  {
    "text": "and there's an online mode as well which we didn't do a heck of a lot of testing around so let's do a quick demo",
    "start": "2157359",
    "end": "2165119"
  },
  {
    "text": "all right so the first thing i want to do is start up startup ethereal",
    "start": "2167760",
    "end": "2173000"
  },
  {
    "text": "alright so while that's running let me show you what the router config looks like",
    "start": "2178480",
    "end": "2184800"
  },
  {
    "text": "so basically the way this lab is set up there's there's three routers depending on the the demo we're gonna we're gonna be using either one or the other two and",
    "start": "2184800",
    "end": "2191599"
  },
  {
    "text": "so in this case we've got two routers that are talking to one another right now they're running",
    "start": "2191599",
    "end": "2197440"
  },
  {
    "text": "passwords you look at the configuration here's the bgp relevant part of the",
    "start": "2197680",
    "end": "2202960"
  },
  {
    "text": "config you can see as matt was looking to earlier you define neighbors so you explicitly say with bgp who i'm going to",
    "start": "2202960",
    "end": "2209599"
  },
  {
    "text": "be talking to by ip address and then by as number and then underneath that you can see the password that we've set for",
    "start": "2209599",
    "end": "2214880"
  },
  {
    "text": "that specific peer and it's just a a you know a standard english word gambling",
    "start": "2214880",
    "end": "2220480"
  },
  {
    "text": "so now again this is not necessarily good best practices so",
    "start": "2220480",
    "end": "2226240"
  },
  {
    "text": "do a show ip route you can see it's pulling in the route from the other pier",
    "start": "2226240",
    "end": "2231200"
  },
  {
    "text": "and it's communicating and everything is working fine with respect to bgp",
    "start": "2232000",
    "end": "2237040"
  },
  {
    "text": "so if we switch back over to ethereal looks like we've gotten a few port 179 packets we stop those you can actually",
    "start": "2237040",
    "end": "2243680"
  },
  {
    "text": "see make this a little bigger",
    "start": "2243680",
    "end": "2248240"
  },
  {
    "text": "you can see that the signature is not in bgp if i go down to the bgp information let",
    "start": "2249839",
    "end": "2256160"
  },
  {
    "text": "me go up to the keep alive it's not on the bgp specific information down here",
    "start": "2256160",
    "end": "2261680"
  },
  {
    "text": "scroll down and the keep live message at all it's actually up in the tcp options so there's tcp option 19 you can see the",
    "start": "2262640",
    "end": "2269440"
  },
  {
    "text": "md5 signature and pull that in so that's the signature that it's using when it sends those packets out on the wire",
    "start": "2269440",
    "end": "2275599"
  },
  {
    "text": "and that's how it looks before you run this attack all right",
    "start": "2275599",
    "end": "2281359"
  },
  {
    "text": "so if you exit the router",
    "start": "2281359",
    "end": "2285078"
  },
  {
    "text": "actually let me save this capture file it's not going to do as much good",
    "start": "2288640",
    "end": "2294680"
  },
  {
    "text": "just say what we're called capture all right so that's saved off",
    "start": "2298000",
    "end": "2303599"
  },
  {
    "text": "so these are the options here for bgp crack there's a lot of options that are designed to make it more efficient if",
    "start": "2303599",
    "end": "2309599"
  },
  {
    "text": "you're doing large scale attack large scale scanning if you want to go through a whole bunch of different passwords",
    "start": "2309599",
    "end": "2315520"
  },
  {
    "text": "there's delays you can you can put you can tell it only to go after the first frame that it finds but by default it's just going to basically pull in the pcap",
    "start": "2315520",
    "end": "2322079"
  },
  {
    "text": "file and just start going after any frame with option 19. so it's uh it's it's quite exciting to see let me tell",
    "start": "2322079",
    "end": "2327920"
  },
  {
    "text": "you you guys all have your fingers crossed here",
    "start": "2327920",
    "end": "2332799"
  },
  {
    "text": "all right so you just basically specify minus r for the capture file and the minus w for the words file in",
    "start": "2333359",
    "end": "2339440"
  },
  {
    "text": "this case we get a really basic words file you know if you were to write a words file to be tuned towards doing",
    "start": "2339440",
    "end": "2344480"
  },
  {
    "text": "this kind of attacks you put things like cisco one two three and you know lots of instantiations of the word cisco and you",
    "start": "2344480",
    "end": "2350320"
  },
  {
    "text": "know juniper and you know whatever else you want to do so you're on the attack boom it's done right yay",
    "start": "2350320",
    "end": "2357838"
  },
  {
    "text": "so because there's only three segments that basically pulled it into memory you know the initial implementation that i wrote in python wasn't nearly as fast",
    "start": "2357920",
    "end": "2363920"
  },
  {
    "text": "but when it was reported to see it got a little faster so so there's the password and you're",
    "start": "2363920",
    "end": "2369280"
  },
  {
    "text": "pretty much done so that's that's basically how how this tool works any questions",
    "start": "2369280",
    "end": "2375599"
  },
  {
    "text": "okay",
    "start": "2375599",
    "end": "2378599"
  },
  {
    "text": "okay and then just to point out the uh the example here that i talked about with john if",
    "start": "2384480",
    "end": "2389680"
  },
  {
    "text": "you have john installed there's an incremental mode that john can use and you basically say how many characters you want it to check for the password in",
    "start": "2389680",
    "end": "2396480"
  },
  {
    "text": "this case we used six so it's just going to go through and keep churning on passwords that are completely random so",
    "start": "2396480",
    "end": "2402320"
  },
  {
    "text": "in this example you see here it took eight seconds to find the password domino in all caps",
    "start": "2402320",
    "end": "2407599"
  },
  {
    "text": "just using the regular words file but then if i permuted that password to be d0m1 and 0",
    "start": "2407599",
    "end": "2413839"
  },
  {
    "text": "and ran that and by basically piping the output from john into bgp crack took",
    "start": "2413839",
    "end": "2418960"
  },
  {
    "text": "about three and a half hours to get that you know arguably pretty random password if you were to you know go to eight",
    "start": "2418960",
    "end": "2425440"
  },
  {
    "text": "characters obviously this would take a heck of a lot more time so counter measure is very easy just choose good passwords for your md5 and this applies",
    "start": "2425440",
    "end": "2432320"
  },
  {
    "text": "you know this kind of a tool could apply to multiple routing protocols that was only written for bgp there's an ietf",
    "start": "2432320",
    "end": "2437359"
  },
  {
    "text": "draft here that's linked at the end which explains you know how long your keys should probably be based on how long you're going to keep them before",
    "start": "2437359",
    "end": "2443200"
  },
  {
    "text": "you change them to limit the ability for the attacker to go after the stuff this starts mattering a lot when you have an",
    "start": "2443200",
    "end": "2449359"
  },
  {
    "text": "ethernet peering point right now there's a lot of cases with internet exchange providers where you have a lot of isps",
    "start": "2449359",
    "end": "2454640"
  },
  {
    "text": "that are coming together and connecting to one another over like a you know a big ethernet switch essentially and so",
    "start": "2454640",
    "end": "2460480"
  },
  {
    "text": "the the requirement to do mp5 starts mattering a lot more there than over a private lease line between a customer",
    "start": "2460480",
    "end": "2466319"
  },
  {
    "text": "and a provider although they're beneficial in in both cases",
    "start": "2466319",
    "end": "2471839"
  },
  {
    "text": "okay so the md5 testing that we did in addition to the proof of concept tool to figure out",
    "start": "2471839",
    "end": "2477680"
  },
  {
    "text": "you know is it possible to derive that password by just doing a dictionary attack we wanted to see",
    "start": "2477680",
    "end": "2483520"
  },
  {
    "text": "can i use md5 as an interesting denial of service attack you know in the past crypto protocols",
    "start": "2483520",
    "end": "2488960"
  },
  {
    "text": "have allowed you to do an easier denial of service with a smaller number of packets as is the case perhaps with ike so we",
    "start": "2488960",
    "end": "2495359"
  },
  {
    "text": "wanted to see is that is that same kind of thing possible so we tried a bunch of different combinations whether it was a valid bgp or valid bgp or invalid bgp",
    "start": "2495359",
    "end": "2503200"
  },
  {
    "text": "peer although it was established or not established whether the password was right or wrong we just flood a lot of this md5 stuff using this ttt tool",
    "start": "2503200",
    "end": "2511280"
  },
  {
    "text": "so two results we found dropped silently or reset everybody who dropped silently seemed to have a lower cpu impact",
    "start": "2511280",
    "end": "2517680"
  },
  {
    "text": "and in worst case we found that using md5 and doing sin flooding if the",
    "start": "2517680",
    "end": "2522800"
  },
  {
    "text": "peer if no session had been established we got about 70 utilization but what that doesn't show is that the router",
    "start": "2522800",
    "end": "2529119"
  },
  {
    "text": "with just a regular syn flood because we weren't you know using 12 000 for all of our testing was it was that about 60",
    "start": "2529119",
    "end": "2534880"
  },
  {
    "text": "utilization with just a regular sin flood without any md5 so it's really an incremental of you know 10 12",
    "start": "2534880",
    "end": "2541359"
  },
  {
    "text": "which didn't seem like it would be all that useful for an attacker to uh to try to exploit and then it dropped even lower if the",
    "start": "2541359",
    "end": "2547119"
  },
  {
    "text": "session had already been established the order of processing though did",
    "start": "2547119",
    "end": "2552480"
  },
  {
    "text": "impact the results so we found some implementations which when you tried to test them over md5 they would check to",
    "start": "2552480",
    "end": "2558079"
  },
  {
    "text": "see if the md5 signature was right before they checked to see if any of the other tcp information was correct which",
    "start": "2558079",
    "end": "2563680"
  },
  {
    "text": "is which is bad right what you should be doing is checking to make sure your ip addresses and port numbers and sequence",
    "start": "2563680",
    "end": "2569040"
  },
  {
    "text": "numbers are right the basic stuff that doesn't require any crypto and then run the md5 signature assuming everything is",
    "start": "2569040",
    "end": "2574480"
  },
  {
    "text": "correct so that's certainly something you may want to check and recommend to to your vendor if",
    "start": "2574480",
    "end": "2580480"
  },
  {
    "text": "your particular implementation happens to do this in the backwards order and then again the tcp behavior uh that",
    "start": "2580480",
    "end": "2587040"
  },
  {
    "text": "you know the different the different things that we found when we were doing the tcp testing definitely impacted the results so something that was already",
    "start": "2587040",
    "end": "2592720"
  },
  {
    "text": "fairly susceptible to a sin flood was still just susceptible to a sin flood with md5",
    "start": "2592720",
    "end": "2599119"
  },
  {
    "text": "afterwards",
    "start": "2599119",
    "end": "2602119"
  },
  {
    "text": "the question is did they think it was a good packet if the md5 signature was correct no they didn't so after they checked the md5 signature they would",
    "start": "2612079",
    "end": "2618319"
  },
  {
    "text": "then go to make sure that all the rest of the tcp stuff is it's just kind of a backwards order not not not the most efficient way to do the testing",
    "start": "2618319",
    "end": "2625599"
  },
  {
    "text": "okay so now i'm going to turn it over to matt who's going to talk about update flooding and do a sexy demo",
    "start": "2625599",
    "end": "2632560"
  },
  {
    "text": "wow our 1750 is going to be simulating a core router it's got a 48 megahertz processor",
    "start": "2633040",
    "end": "2639440"
  },
  {
    "text": "and 48 megs of ram so we we can definitely have the entire internet routing tables here",
    "start": "2639440",
    "end": "2647000"
  },
  {
    "text": "so responding to that earlier question about icmp port unreachable i haven't tested that stuff for a while but i if i",
    "start": "2648480",
    "end": "2655280"
  },
  {
    "text": "recall most modern operating systems i don't know if you put windows as a modern operating system ignore that so",
    "start": "2655280",
    "end": "2662319"
  },
  {
    "text": "uh we did not test bgp but i remember in the past testing other ios tcp",
    "start": "2662319",
    "end": "2667440"
  },
  {
    "text": "applications and by sending the the port unreachable you were not able to tear down the session but that's a",
    "start": "2667440",
    "end": "2674400"
  },
  {
    "text": "good point for being comprehensive so so basically assuming",
    "start": "2674400",
    "end": "2681119"
  },
  {
    "text": "and this is and this is probably assuming a lot assuming somehow you were able to",
    "start": "2681119",
    "end": "2687040"
  },
  {
    "text": "complete your three-way handshake establish get a valid open",
    "start": "2687040",
    "end": "2692319"
  },
  {
    "text": "and start sending updates to a router we just wanted to see what you could do",
    "start": "2692319",
    "end": "2697440"
  },
  {
    "text": "by flooding large numbers of update messages so basically i wrote a little silly python script that that manually",
    "start": "2697440",
    "end": "2704640"
  },
  {
    "text": "goes through and initiates a bgp session and starts sending sending routes to see how long it takes",
    "start": "2704640",
    "end": "2711119"
  },
  {
    "text": "for you know the router to crash the cpu to get exhausted for it to stop accepting routes for to override",
    "start": "2711119",
    "end": "2717280"
  },
  {
    "text": "existing routes or things like that so i'll show you what happens on this super",
    "start": "2717280",
    "end": "2722880"
  },
  {
    "text": "powerful 1750 here so",
    "start": "2722880",
    "end": "2729039"
  },
  {
    "text": "only the best for y'all only the best that would fit in our",
    "start": "2729440",
    "end": "2734720"
  },
  {
    "text": "carry-on",
    "start": "2734720",
    "end": "2737720"
  },
  {
    "text": "okay so simple uh",
    "start": "2747599",
    "end": "2752000"
  },
  {
    "text": "pi if i can spell here high update uh target router",
    "start": "2753040",
    "end": "2758640"
  },
  {
    "text": "the and then specify my autonomous system number",
    "start": "2758640",
    "end": "2764640"
  },
  {
    "text": "and we should see the peer come up so basically at this point what i do is i'm manually establishing a a bgp session it",
    "start": "2764640",
    "end": "2773200"
  },
  {
    "text": "brings up the route and we should if i go down here",
    "start": "2773200",
    "end": "2777839"
  },
  {
    "text": "tell i'm definitely using four passwords here so",
    "start": "2782079",
    "end": "2789160"
  },
  {
    "text": "so we've established a session and what i'm going to do is i basically one thing i've found is that you have you can't uh",
    "start": "2790880",
    "end": "2797119"
  },
  {
    "text": "send more than a thousand uh routes at once so you have to split those up so i'll do 1500",
    "start": "2797119",
    "end": "2802640"
  },
  {
    "text": "so that should",
    "start": "2802640",
    "end": "2805838"
  },
  {
    "text": "you'll see that it it splits it up so very exciting sends a couple of",
    "start": "2808640",
    "end": "2814640"
  },
  {
    "text": "updates so just to prove that now we have fifteen hundred rounds so we start upping the ante",
    "start": "2814640",
    "end": "2821440"
  },
  {
    "text": "now ten thousand and continues and",
    "start": "2821440",
    "end": "2827359"
  },
  {
    "text": "console becomes somewhat unresponsive",
    "start": "2827359",
    "end": "2831838"
  },
  {
    "text": "now if we go to 100 000",
    "start": "2832480",
    "end": "2837838"
  },
  {
    "text": "it came up now",
    "start": "2841440",
    "end": "2845000"
  },
  {
    "text": "and it's getting kind of sluggish on the console",
    "start": "2849119",
    "end": "2853480"
  },
  {
    "text": "and big surprise we ran out of memory really that's not a bug it's a feature",
    "start": "2858960",
    "end": "2865520"
  },
  {
    "text": "so okay the point of this kind of silly demo is that",
    "start": "2865520",
    "end": "2871119"
  },
  {
    "text": "the different implementations responded differently to this sort of uh attack if you can call it attack this",
    "start": "2871599",
    "end": "2877440"
  },
  {
    "text": "was i considered this almost kind of like dev testing so i really didn't want to do it so but anyway",
    "start": "2877440",
    "end": "2885040"
  },
  {
    "text": "so what happened on different implementations was we saw a wide variety and we were trying we're",
    "start": "2885040",
    "end": "2890160"
  },
  {
    "text": "shooting for pretty much comparable hardware hardware platforms they were at the rate at which new new routes could",
    "start": "2890160",
    "end": "2895920"
  },
  {
    "text": "be accepted uh that varied even on comparable platforms the number of routes that could be",
    "start": "2895920",
    "end": "2901520"
  },
  {
    "text": "accepted just the maximum number of routes really varied as well and then probably the most important was",
    "start": "2901520",
    "end": "2907599"
  },
  {
    "text": "what happens when when you hit your max you know let's say you only accept 200 000 routes do you start uh overriding",
    "start": "2907599",
    "end": "2915200"
  },
  {
    "text": "existing routes do you not allow any new routes or as we saw in the case of of ios you basically terminate the process",
    "start": "2915200",
    "end": "2922800"
  },
  {
    "text": "and renegotiate and the the theory behind why you would want to terminate the process is you want the router to be",
    "start": "2922800",
    "end": "2930079"
  },
  {
    "text": "in a known state so it's better to kill the process",
    "start": "2930079",
    "end": "2935440"
  },
  {
    "text": "and renegotiate the sessions than to accept all of these routes and put the rubber in an unstable seat",
    "start": "2935440",
    "end": "2942960"
  },
  {
    "text": "so sean's going to move on and talk about the tcp hijacking",
    "start": "2942960",
    "end": "2948880"
  },
  {
    "text": "all right so tcp hijacking so assuming the ability to guess the sequence number which as we talked about",
    "start": "2951359",
    "end": "2956800"
  },
  {
    "text": "earlier is not the easiest thing in the world to do let's assume that the attacker had some method to do that whether they're in line or through some",
    "start": "2956800",
    "end": "2962640"
  },
  {
    "text": "other method how easy is it to send this magic single spoofed message because ideally if you",
    "start": "2962640",
    "end": "2968720"
  },
  {
    "text": "have a bgp peer that's already set up i can send a single packet as a bgp update",
    "start": "2968720",
    "end": "2973920"
  },
  {
    "text": "if i get all the fields right i can cause a route to be picked up by the victim and then propagated throughout",
    "start": "2973920",
    "end": "2980000"
  },
  {
    "text": "the internet so we wanted to test to see how that would work well what we found was is we",
    "start": "2980000",
    "end": "2986000"
  },
  {
    "text": "wrote a tool to do that which is again available on the website and instead of trying to guess the sequence",
    "start": "2986000",
    "end": "2992079"
  },
  {
    "text": "number we just make it only work in line so it just sits there in line and it watches for a",
    "start": "2992079",
    "end": "2997440"
  },
  {
    "text": "keep alive and once it sees the bgp keep live it can sync to the tcp session knows what the sequence number is and",
    "start": "2997440",
    "end": "3003200"
  },
  {
    "text": "then it can send the update you'll see that in a demo here but as soon as that update is sent",
    "start": "3003200",
    "end": "3008240"
  },
  {
    "text": "what immediately happens is those sequence numbers have been stepped on right because i sent in a spoofed um a spoofed bgp update and now the sequence",
    "start": "3008240",
    "end": "3014960"
  },
  {
    "text": "numbers between the client the server the real client the server get out of sync so they run into an act storm if",
    "start": "3014960",
    "end": "3020160"
  },
  {
    "text": "you you know if you want to look it up on your stevens basically it just starts you know storming for about five minutes",
    "start": "3020160",
    "end": "3025200"
  },
  {
    "text": "you'll see it go by on the tcp dump which is all kinds of crap streaming by meanwhile the bgp session is fine",
    "start": "3025200",
    "end": "3031280"
  },
  {
    "text": "because again this is happening at at the tcp layer and all that information will be propagated up whatever update",
    "start": "3031280",
    "end": "3038000"
  },
  {
    "text": "you send will be propagated to any other routers that are listening however again as soon as that act storm",
    "start": "3038000",
    "end": "3045440"
  },
  {
    "text": "is resolved the session is reset and rebuilt meaning that route that you inserted will no longer be valid",
    "start": "3045440",
    "end": "3052480"
  },
  {
    "text": "so again it takes about five minutes to resolve that storm and there are there are ways",
    "start": "3052480",
    "end": "3059200"
  },
  {
    "text": "yeah so so we are right so there's there's some there's so we didn't do a lot of testing to figure out ways to gracefully back",
    "start": "3059359",
    "end": "3065599"
  },
  {
    "text": "out uh to make that extra not happen to resync the sessions obviously if you're doing something like arp spoofing if",
    "start": "3065599",
    "end": "3070800"
  },
  {
    "text": "you're in line you can do a lot to make sure the sequence numbers don't get messed up but if you're just a blind attacker",
    "start": "3070800",
    "end": "3077119"
  },
  {
    "text": "several hops away it's pretty difficult to get those sequence numbers to resync",
    "start": "3077119",
    "end": "3082160"
  },
  {
    "text": "all right so let's do a quick demo here",
    "start": "3082160",
    "end": "3086078"
  },
  {
    "text": "all right let me start up speed up",
    "start": "3092640",
    "end": "3097839"
  },
  {
    "text": "so what we're going to need to do is we need to start this up because you're going to need to know what the port number is in order to send this hijack",
    "start": "3097839",
    "end": "3102880"
  },
  {
    "text": "out so while that's running",
    "start": "3102880",
    "end": "3107920"
  },
  {
    "text": "so there's a couple of tools here that you need to use to do this uh the tcp hydra tool that we're releasing uh isn't",
    "start": "3108960",
    "end": "3114720"
  },
  {
    "text": "bgp specific essentially it's it's it's dirt simple right it just watches for a tcp communication to go by in the wire",
    "start": "3114720",
    "end": "3121520"
  },
  {
    "text": "that matches what you configure and then once it's synced to it it'll send whatever binary payload you identify off",
    "start": "3121520",
    "end": "3127359"
  },
  {
    "text": "to the to the victim so we wrote another little utility called bgp update create which builds uh the binary payload for",
    "start": "3127359",
    "end": "3134000"
  },
  {
    "text": "the bgp update so you can see it's only got a couple of parameters so we just say",
    "start": "3134000",
    "end": "3139119"
  },
  {
    "text": "bgp update create in this case the as number doesn't matter the next hop has to be",
    "start": "3139119",
    "end": "3145760"
  },
  {
    "text": "the hop of the server that you're spoofing in order for this to work",
    "start": "3145760",
    "end": "3151200"
  },
  {
    "text": "so in this case we're going to send it to dot 200 which is the victim",
    "start": "3151200",
    "end": "3156880"
  },
  {
    "text": "and then we'll use the destnet i don't know 69.0.0.0.8.",
    "start": "3156880",
    "end": "3162359"
  },
  {
    "text": "so send the class a and if i just hit enter it's just going to write the binary payload of standard",
    "start": "3163040",
    "end": "3168079"
  },
  {
    "text": "out so i need to redirect it call it test update",
    "start": "3168079",
    "end": "3174318"
  },
  {
    "text": "now i've got the test update file and now i can run the tcp hijack",
    "start": "3175200",
    "end": "3181200"
  },
  {
    "text": "those are the command line options now i need to go back over to my tcp dump to look for the keep lives so i can see",
    "start": "3181200",
    "end": "3186400"
  },
  {
    "text": "that 200 looks like he's the client in this particular situation so he's got",
    "start": "3186400",
    "end": "3191520"
  },
  {
    "text": "port 11 0001 and 100 is the is the one who's active on the 179 listener so because i'm going",
    "start": "3191520",
    "end": "3198800"
  },
  {
    "text": "after 200 i need to send it on port 11 0001 so i go back over here and i'm going to",
    "start": "3198800",
    "end": "3204880"
  },
  {
    "text": "say tcp hijack minus c the client which is the client that i'm spoofing",
    "start": "3204880",
    "end": "3210880"
  },
  {
    "text": "to the server which is the victim then the port in this case is 11 0001",
    "start": "3210880",
    "end": "3218480"
  },
  {
    "text": "and then the payload file is test update so i hit enter and if everything works",
    "start": "3218480",
    "end": "3224480"
  },
  {
    "text": "right it's going to take a few seconds because again it's waiting for that tcp it's waiting for that bgp keep alive to go by",
    "start": "3224480",
    "end": "3231520"
  },
  {
    "text": "on the wire once it sees the bgp keep live it'll know the sequence number and it will be able to sync to that",
    "start": "3231520",
    "end": "3236800"
  },
  {
    "text": "conversation and send it out so so far still hasn't synced yet",
    "start": "3236800",
    "end": "3244640"
  },
  {
    "text": "has anybody seen the bgp plugin for look at this look headercasting the",
    "start": "3244880",
    "end": "3250000"
  },
  {
    "text": "source code it's kind of amusing it's not trying to crack authentication",
    "start": "3250000",
    "end": "3256000"
  },
  {
    "text": "all right",
    "start": "3261599",
    "end": "3264680"
  },
  {
    "text": "and we're waiting",
    "start": "3267760",
    "end": "3270640"
  },
  {
    "text": "there we go okay we're synced to the tcp conversation it sends the payload you know prepare for network meltdown",
    "start": "3273520",
    "end": "3278960"
  },
  {
    "text": "and by network meltdown i mean this yeah there's your x storm right so",
    "start": "3278960",
    "end": "3284800"
  },
  {
    "text": "however while this live stream is happening i can telnet into one of the routers in",
    "start": "3284800",
    "end": "3290240"
  },
  {
    "text": "this case the victim and do a show up you out",
    "start": "3290240",
    "end": "3295680"
  },
  {
    "text": "and there's that 69 network that we sent so while that exterm is resolving for the next five minutes that route will be",
    "start": "3295680",
    "end": "3301359"
  },
  {
    "text": "picked up and that route will be propagated to all other peers that are connected to that pier so that route",
    "start": "3301359",
    "end": "3307200"
  },
  {
    "text": "will get into the network but again preconditions for this attack is you got to get the tcp sequence number stuff right or you got",
    "start": "3307200",
    "end": "3313359"
  },
  {
    "text": "to be in line in which case the tcp hijack tool will will work by itself",
    "start": "3313359",
    "end": "3319960"
  },
  {
    "text": "right this is also not assuming md5 good point so if you had md5 turned on i guess you could probably do some",
    "start": "3320079",
    "end": "3325359"
  },
  {
    "text": "frankenstein work building on what we're releasing to take the bgp crack tool and the ttt tool but we decided you know",
    "start": "3325359",
    "end": "3331920"
  },
  {
    "text": "most people to be honest how many people here using tcp md5 for bgp yeah okay that's about",
    "start": "3331920",
    "end": "3338400"
  },
  {
    "text": "that's right i saw zero hands so most people aren't using it because of the key management issue right it's really",
    "start": "3338400",
    "end": "3344160"
  },
  {
    "text": "painful to manage pre-shared keys on all these routers so a lot of people just plain don't do it so we thought you know",
    "start": "3344160",
    "end": "3349760"
  },
  {
    "text": "sort of a declining returns to spend too much time trying to go after md5",
    "start": "3349760",
    "end": "3356480"
  },
  {
    "text": "all right and then you know there's some simple things you can do again just arp spoofing we're not going to spend any time on one thing that was interesting",
    "start": "3357119",
    "end": "3362799"
  },
  {
    "text": "to note though is if you have a victim who is multi-homed meaning he's peering to multiple peers one of the problems with our spoofing is you want to make",
    "start": "3362799",
    "end": "3368880"
  },
  {
    "text": "sure the rest of the communication continues to work so if instead you only spoof",
    "start": "3368880",
    "end": "3373920"
  },
  {
    "text": "one of the p one of the victims peers you can basically uh you know leave that up and running and then be",
    "start": "3373920",
    "end": "3380559"
  },
  {
    "text": "able to send whatever spoof traffic you want over the spoof peering while the valid pier will",
    "start": "3380559",
    "end": "3386319"
  },
  {
    "text": "continue to send all the information so that's the tcp hijack tool and now matt's going to get into",
    "start": "3386319",
    "end": "3393040"
  },
  {
    "text": "protocol fuzzing",
    "start": "3393040",
    "end": "3396520"
  },
  {
    "text": "how many of you all have heard of the term fuzzing it's a pretty old term first kind of appeared back in the for",
    "start": "3406960",
    "end": "3412880"
  },
  {
    "text": "the 80s and then some research at the university of wisconsin primarily on the host side basically sending all sorts of",
    "start": "3412880",
    "end": "3419280"
  },
  {
    "text": "input to unix environment variables command line arguments things like that uh i i won't",
    "start": "3419280",
    "end": "3424400"
  },
  {
    "text": "claim that fuzzing is any sort of panacea but it i'll tell you one thing it scares a",
    "start": "3424400",
    "end": "3429760"
  },
  {
    "text": "lot of people i could tell you some stories but i can't so",
    "start": "3429760",
    "end": "3435680"
  },
  {
    "text": "we're not releasing the tools so yeah the bottom line is not able to release this tool so basically",
    "start": "3435680",
    "end": "3442000"
  },
  {
    "text": "how many of you have heard of isaac how many have used isic to crash a network device or an application",
    "start": "3442000",
    "end": "3448799"
  },
  {
    "text": "okay basically the goal of of this tool called pif protocol independent fuzzer",
    "start": "3448799",
    "end": "3454640"
  },
  {
    "text": "was to kind of go beyond the functionality of isig isek is really cool provided was",
    "start": "3454640",
    "end": "3460160"
  },
  {
    "text": "written by mike franz and i think it came out in 99 uh provides about a half a dozen tools e-cig isaac tcp sick udp",
    "start": "3460160",
    "end": "3467920"
  },
  {
    "text": "sick you because it can be useful if you try that against your uh ike ike implementations you might i think they",
    "start": "3467920",
    "end": "3473599"
  },
  {
    "text": "probably fixed most of the things now but never ever can tell so it it's but it's pretty crude uh",
    "start": "3473599",
    "end": "3480799"
  },
  {
    "text": "basically it gives you some control over you know ip options tcp options whether or not the checksums are valid but the",
    "start": "3480799",
    "end": "3488079"
  },
  {
    "text": "payload whether it's you know an ip payload uh or like a udp payload it just",
    "start": "3488079",
    "end": "3493200"
  },
  {
    "text": "generates random crap now it's not really crypto random it just basically uses the the process id to to run it to",
    "start": "3493200",
    "end": "3498799"
  },
  {
    "text": "the uh as the seed but uh and and you can do a few little things to make it a little bit better",
    "start": "3498799",
    "end": "3504079"
  },
  {
    "text": "and if you add a few lines to isig you can specify a uh ip protocol number so then now i could",
    "start": "3504079",
    "end": "3510319"
  },
  {
    "text": "get some granularity i could say well maybe i want to go after ip protocol 50 and 51 esp and ah or maybe i want to go",
    "start": "3510319",
    "end": "3516799"
  },
  {
    "text": "after joy some malformed gre but really it's not it's not giving you the the functionality that you need to send",
    "start": "3516799",
    "end": "3523040"
  },
  {
    "text": "those malformed payloads deeper into the packet so the goal of pip was to come up",
    "start": "3523040",
    "end": "3528079"
  },
  {
    "text": "with a simple way of describing a large number of primarily binary protocols and",
    "start": "3528079",
    "end": "3533839"
  },
  {
    "text": "i use bgp and ike as the primary test protocols so that you could basically you describe",
    "start": "3533839",
    "end": "3541200"
  },
  {
    "text": "the protocols you run the script the script prompts you for some some possible field values",
    "start": "3541200",
    "end": "3547680"
  },
  {
    "text": "and then it generates test cases so this way you can have much greater",
    "start": "3547680",
    "end": "3553760"
  },
  {
    "text": "control over which fields you want to try to send invalid data to and the theory is that",
    "start": "3553760",
    "end": "3560240"
  },
  {
    "text": "the greater or the deeper into the packet that you're able to inject invalid data the",
    "start": "3560240",
    "end": "3565599"
  },
  {
    "text": "greater you're going to expose possible points in the code where things could go wrong",
    "start": "3565599",
    "end": "3572160"
  },
  {
    "text": "so basically what i ended up writing is it's about it's 16 1700 lines python",
    "start": "3572160",
    "end": "3579119"
  },
  {
    "text": "came up with this simple flat file format and i'll go through a demo and show you what it looks like but a simple way of",
    "start": "3579119",
    "end": "3585839"
  },
  {
    "text": "describing the protocol didn't want to use anything like bnf or sn1 like some folks would like to",
    "start": "3585839",
    "end": "3591839"
  },
  {
    "text": "do describe the fields of the protocol have a user input module which is basically a",
    "start": "3591839",
    "end": "3598400"
  },
  {
    "text": "interactive script that asks you what what fields you want to use uh generate the messages and then the messages are",
    "start": "3598400",
    "end": "3604640"
  },
  {
    "text": "end up in just standard binary format just like the you know the smp snmp proto tests or ssh shredder",
    "start": "3604640",
    "end": "3612240"
  },
  {
    "text": "test suites that's pretty much the standard way and then you can use whatever you want to to inject them",
    "start": "3612240",
    "end": "3618880"
  },
  {
    "text": "so this is just a uh you know what it looks like for for bgp if you want to generate some messages and i'll do this",
    "start": "3619280",
    "end": "3625359"
  },
  {
    "text": "so so if you this is the nice management",
    "start": "3625359",
    "end": "3630960"
  },
  {
    "text": "slide i came up with you know so lines and boxes and pictures great",
    "start": "3630960",
    "end": "3637119"
  },
  {
    "text": "okay so you have the protocol description language you look at your sniffer traces you",
    "start": "3637119",
    "end": "3643200"
  },
  {
    "text": "look at the specs and you come up with a simple way you come up with a definition now one of the things that i wanted this",
    "start": "3643200",
    "end": "3648799"
  },
  {
    "text": "to do is i only if let's say i only wanted to describe the first few fields in a protocol i didn't want to define",
    "start": "3648799",
    "end": "3654240"
  },
  {
    "text": "the complete protocol that's fine it basically takes what you've got and then the rest of it it just generates crap",
    "start": "3654240",
    "end": "3660960"
  },
  {
    "text": "so then you generate the you the you run the pdl's through the engine generates test cases then you fire on the network",
    "start": "3660960",
    "end": "3667119"
  },
  {
    "text": "and hopefully it'll cause some damage and cause your router to crash and do all sorts of nasty things depending",
    "start": "3667119",
    "end": "3673520"
  },
  {
    "text": "on your perspective okay so basically",
    "start": "3673520",
    "end": "3681240"
  },
  {
    "text": "pdl direct pdf directory pdl has a set of protocols",
    "start": "3687920",
    "end": "3695040"
  },
  {
    "text": "we're going to bgp and the way it works is each file is essentially a group of",
    "start": "3695040",
    "end": "3702079"
  },
  {
    "text": "fields that go together so this is the simple generic bgp header",
    "start": "3702079",
    "end": "3708720"
  },
  {
    "text": "that you've you've seen when we opened up ethereum so there the first column is a basically a tag descriptor the f would",
    "start": "3708720",
    "end": "3715599"
  },
  {
    "text": "be for fixed values things that always change that don't change for example at the beginning of every bgp message",
    "start": "3715599",
    "end": "3722480"
  },
  {
    "text": "there's a 128 bit i think that's 16 16 bytes 16 bytes of all f's so that's that's",
    "start": "3722480",
    "end": "3729920"
  },
  {
    "text": "always has to be there in order for it to be a valid message next field length length field now one of the interesting",
    "start": "3729920",
    "end": "3736160"
  },
  {
    "text": "things about protocols is there are probably about half a dozen different ways of calculating length so i had to",
    "start": "3736160",
    "end": "3741599"
  },
  {
    "text": "write little functions which properly calculate length now why do i want to properly calculate length because some",
    "start": "3741599",
    "end": "3747280"
  },
  {
    "text": "implementations if they look at the top of the top here field and it's an invalid length they just drop it so they",
    "start": "3747280",
    "end": "3753520"
  },
  {
    "text": "don't do anything else so you need to be able to build valid links and then the third third field there is",
    "start": "3753520",
    "end": "3758720"
  },
  {
    "text": "basically a type field and i can specify the different bgp option types now it was basically four",
    "start": "3758720",
    "end": "3766000"
  },
  {
    "text": "or five you know and you can use the hexadecimal value or can use the standard",
    "start": "3766000",
    "end": "3771280"
  },
  {
    "text": "standard name the last field is an action a or action field and it basically based on the value of the",
    "start": "3771280",
    "end": "3777920"
  },
  {
    "text": "previous field it will go to the next block so assuming we're doing it open",
    "start": "3777920",
    "end": "3784720"
  },
  {
    "text": "it goes to the open fields so version number bgp version 4 your autonomous system number",
    "start": "3786880",
    "end": "3794160"
  },
  {
    "text": "16 bits for the whole time etc and then you can append options onto this so",
    "start": "3794160",
    "end": "3800240"
  },
  {
    "text": "you know if you want to go deep into the packet you could chain together six or seven different files and it can get",
    "start": "3800240",
    "end": "3805359"
  },
  {
    "text": "kind of hairy trying to write these things up bgp is easy compared to some of the stuff in ike",
    "start": "3805359",
    "end": "3812160"
  },
  {
    "text": "so so basically how this works is you're within the directory of the",
    "start": "3812240",
    "end": "3818720"
  },
  {
    "text": "the protocol that you want to generate messages i'll say pif bgp build buzz",
    "start": "3818720",
    "end": "3825440"
  },
  {
    "text": "and then this neat feature called backtrace so basically what this is going to do is it's going to read in the",
    "start": "3825440",
    "end": "3830799"
  },
  {
    "text": "first file and i'm going to say well i wanted to do a valid length and i want it to be an open and based on",
    "start": "3830799",
    "end": "3837119"
  },
  {
    "text": "the decisions that you get it will make certain choices and it will piece together your different messages in the",
    "start": "3837119",
    "end": "3843280"
  },
  {
    "text": "protocol and i want to use my autonomous system number and that i'll just do random",
    "start": "3843280",
    "end": "3850079"
  },
  {
    "text": "random and then one of the cool things is if you ever stop",
    "start": "3850079",
    "end": "3855200"
  },
  {
    "text": "and you just hit a return that just means fuzz the rest so the rest of it's crap so if you just want to quickly start generating messages just fill in a",
    "start": "3855200",
    "end": "3862720"
  },
  {
    "text": "few fields hit return and then you're ready to go so don't need to enter a file name",
    "start": "3862720",
    "end": "3868160"
  },
  {
    "text": "so these are the the nasty python dictionaries dictionaries of dictionaries of dictionaries very",
    "start": "3868160",
    "end": "3874079"
  },
  {
    "text": "very messy i probably couldn't tell you what they mean now because so",
    "start": "3874079",
    "end": "3879440"
  },
  {
    "text": "now it says well these are the fields that we've processed it populates them and",
    "start": "3879440",
    "end": "3884799"
  },
  {
    "text": "so we have the last valid field is the bgp id",
    "start": "3884799",
    "end": "3890400"
  },
  {
    "text": "and then there's the rest of it is the fuzz load so uh i was i was going to add so you could",
    "start": "3890400",
    "end": "3895440"
  },
  {
    "text": "have multiple embedded fuzz loads but but i didn't get around to that yet uh so for this buzz load i'll specify a",
    "start": "3895440",
    "end": "3902079"
  },
  {
    "text": "minimum of zero because as you all know you need to test zero length messages because they do crash things but",
    "start": "3902079",
    "end": "3908960"
  },
  {
    "text": "historically there have been a lot of a lot of protocols that have issues with that",
    "start": "3908960",
    "end": "3914799"
  },
  {
    "text": "so basically what this is going to do is using this back trace feature i specify",
    "start": "3916720",
    "end": "3924319"
  },
  {
    "text": "deep into the message almost the complete message that i want to build and it starts popping off each field",
    "start": "3924319",
    "end": "3931680"
  },
  {
    "text": "so it basically moves the fuzz load more shallow to the front end of the packet",
    "start": "3931680",
    "end": "3937599"
  },
  {
    "text": "and i'll show you what it looks like in just a second so 10 messages",
    "start": "3937599",
    "end": "3942960"
  },
  {
    "text": "okay so basically what it's doing and you'll see this number now it's six",
    "start": "3942960",
    "end": "3949359"
  },
  {
    "text": "5 and it's going shallower into the bgp message",
    "start": "3949359",
    "end": "3955039"
  },
  {
    "text": "now to the marker and now we just have a fuzz loop",
    "start": "3955039",
    "end": "3960079"
  },
  {
    "text": "so basically it creates directories in here so",
    "start": "3962000",
    "end": "3967200"
  },
  {
    "text": "if we go to buzz load you know you'll just see this is",
    "start": "3967200",
    "end": "3973280"
  },
  {
    "text": "complete random there's no valid marker there so if we go bgp length",
    "start": "3973280",
    "end": "3981838"
  },
  {
    "text": "so there you it starts to look more like a a real message and then within each file it just tells you what to do there",
    "start": "3985119",
    "end": "3993039"
  },
  {
    "text": "so to kind of illustrate what these look like on the network so you know open up ethereal",
    "start": "3993039",
    "end": "4000559"
  },
  {
    "text": "and i'll instead of having to have an actual existing implementation running when i",
    "start": "4000559",
    "end": "4006480"
  },
  {
    "text": "was doing all the development i just wrote a little simple script that opens up the net netcat listener just because",
    "start": "4006480",
    "end": "4012160"
  },
  {
    "text": "i just want to see it on the wire and make sure that it gets decoded by ethereal so",
    "start": "4012160",
    "end": "4018880"
  },
  {
    "text": "basically i'll go just type trace 179 and it's just a really stupid shell",
    "start": "4018880",
    "end": "4024319"
  },
  {
    "text": "script that opens up ncat dash l and then pipes it with another ncad",
    "start": "4024319",
    "end": "4029440"
  },
  {
    "text": "so you can see that it's it's building up tcp",
    "start": "4029440",
    "end": "4035640"
  },
  {
    "text": "so",
    "start": "4037039",
    "end": "4039200"
  },
  {
    "text": "so this one is actually an unknown message type it has a valid marker the length is valid so it",
    "start": "4043520",
    "end": "4050480"
  },
  {
    "text": "it's a message type 45 so it doesn't know what that is so theoretically you might want to test an implementation to",
    "start": "4050480",
    "end": "4055920"
  },
  {
    "text": "see how it responds to that and then you basically can do the do the same thing with other uh",
    "start": "4055920",
    "end": "4063119"
  },
  {
    "text": "i'll go here",
    "start": "4063119",
    "end": "4066599"
  },
  {
    "text": "and i'll show you what it looks like on the router",
    "start": "4080160",
    "end": "4085760"
  },
  {
    "text": "and i did what i did write some scripts to automate sending large numbers of test cases it's probably not as",
    "start": "4086319",
    "end": "4091359"
  },
  {
    "text": "automated as as you know if i were to be doing this full time because it can be kind of painful",
    "start": "4091359",
    "end": "4098880"
  },
  {
    "text": "okay",
    "start": "4103359",
    "end": "4105838"
  },
  {
    "text": "okay so what what i can do is and i really hope this doesn't reboot the router i really hope it doesn't",
    "start": "4110159",
    "end": "4115520"
  },
  {
    "text": "because i'm going to get fired if i do it's a joke maybe",
    "start": "4115520",
    "end": "4122318"
  },
  {
    "text": "so it's one of these",
    "start": "4122319",
    "end": "4127520"
  },
  {
    "text": "okay so basically what i'm going to do is i'm going to cut the file 192. six",
    "start": "4127520",
    "end": "4133199"
  },
  {
    "text": "to 225 specified quotes eliminating okay good i got a response that means that it's a notification back so",
    "start": "4133199",
    "end": "4140159"
  },
  {
    "text": "i'll look back and",
    "start": "4140159",
    "end": "4145719"
  },
  {
    "text": "so",
    "start": "4151199",
    "end": "4153440"
  },
  {
    "text": "so basically it shows you these those messages right there and you would use that to to do debugging as you go",
    "start": "4157679",
    "end": "4164080"
  },
  {
    "text": "through exposing various fields to determine whether or not you know there were issues in that protocol so",
    "start": "4164080",
    "end": "4172080"
  },
  {
    "text": "so that's basically how i generated these test cases came up with about 800 bgp open test cases uh those of you that",
    "start": "4172480",
    "end": "4179520"
  },
  {
    "text": "are familiar with produce know that that's significantly less protos had you know 30 40 000 test cases",
    "start": "4179520",
    "end": "4185838"
  },
  {
    "text": "they chose a slightly different approach more of a permutation through all possible packets",
    "start": "4185839",
    "end": "4191920"
  },
  {
    "text": "it would be interesting to see if this approach which is a little more efficient has the same coverage in terms of number of vulnerabilities so",
    "start": "4191920",
    "end": "4198800"
  },
  {
    "text": "generally",
    "start": "4198800",
    "end": "4201800"
  },
  {
    "text": "and then i also generated fewer okay so this is just another shot of what it looks like",
    "start": "4208320",
    "end": "4214239"
  },
  {
    "text": "you've got it on the slides and then i did the same thing for",
    "start": "4214239",
    "end": "4219840"
  },
  {
    "text": "updated i didn't do as many updates because i didn't write out the complete pdl for the updates uh because it starts",
    "start": "4219840",
    "end": "4226159"
  },
  {
    "text": "to get pretty hairy and i would have had to do a significant modification of the code and also since basically in order",
    "start": "4226159",
    "end": "4232560"
  },
  {
    "text": "to send an update you have to negotiate a true session you have to have a valid ip and a valid as number so from a risk",
    "start": "4232560",
    "end": "4239199"
  },
  {
    "text": "perspective do the up do the opens first so total about 1200 test cases",
    "start": "4239199",
    "end": "4245760"
  },
  {
    "text": "in terms of the the response came up with four unique",
    "start": "4245760",
    "end": "4250960"
  },
  {
    "text": "flaws and four different implementations uh i was actually expecting to find more",
    "start": "4250960",
    "end": "4258239"
  },
  {
    "text": "so and you know i feel pretty confident about the the open test cases in terms",
    "start": "4258239",
    "end": "4263440"
  },
  {
    "text": "of exercising the various fields there's probably some more room in terms of the bgp options that are used with the open",
    "start": "4263440",
    "end": "4270400"
  },
  {
    "text": "for negotiating you know mpls or various routing extensions because as we know options always have lots of potential",
    "start": "4270400",
    "end": "4277440"
  },
  {
    "text": "for mischief so three of the four vulnerabilities had to have a valid as and only one of these",
    "start": "4277440",
    "end": "4284880"
  },
  {
    "text": "could you do remote from a remote and these a remote uh compromise i'll keep it as ambiguous as",
    "start": "4284880",
    "end": "4290880"
  },
  {
    "text": "that so so like i said need more comprehensive",
    "start": "4290880",
    "end": "4297280"
  },
  {
    "text": "update testing one of the questions i got when presented some of this material at nanog",
    "start": "4297280",
    "end": "4302640"
  },
  {
    "text": "was have you tested the system-wide effects so let's say i send an invalid",
    "start": "4302640",
    "end": "4307679"
  },
  {
    "text": "update to one router it's properly handled by that but it gets passed on to another router which then cannot handle",
    "start": "4307679",
    "end": "4314000"
  },
  {
    "text": "it and crashes no i didn't do any of that i was just focusing on a single router so there is some more potential",
    "start": "4314000",
    "end": "4319760"
  },
  {
    "text": "work that needs to be done in terms of invalid messages and hopefully",
    "start": "4319760",
    "end": "4326080"
  },
  {
    "text": "assuming there's a certain advisory that comes out maybe the test cases will go public and maybe",
    "start": "4326080",
    "end": "4331600"
  },
  {
    "text": "someone will find this idea interested enough to maybe do some work on this",
    "start": "4331600",
    "end": "4336719"
  },
  {
    "text": "so anyway okay so based on we did you know looked",
    "start": "4336719",
    "end": "4342159"
  },
  {
    "text": "at seven implementations the tcp stuff the bgp stuff uh",
    "start": "4342159",
    "end": "4347280"
  },
  {
    "text": "we saw a variety of responses and one of the things was the logging some of these implementations basically gave you",
    "start": "4347280",
    "end": "4353040"
  },
  {
    "text": "nothing to go on some of them were extremely verbose in terms of the types of malformed messages that you were",
    "start": "4353040",
    "end": "4359360"
  },
  {
    "text": "sending and you know so that i would recommend that if you're looking at",
    "start": "4359360",
    "end": "4364480"
  },
  {
    "text": "identifying potential attacks obviously more verbose logging and configurable logging is a nice thing",
    "start": "4364480",
    "end": "4370159"
  },
  {
    "text": "aggressive rejection early into the into the state so the best case would be i",
    "start": "4370159",
    "end": "4375840"
  },
  {
    "text": "send a sin from a non-peer and there's no response or it doesn't or it resets",
    "start": "4375840",
    "end": "4382080"
  },
  {
    "text": "it does not allow anything to get to this in receive state certainly does not process any bgp open from an",
    "start": "4382080",
    "end": "4389440"
  },
  {
    "text": "unconfigured peer that's the best case source randomization we talked about the",
    "start": "4389440",
    "end": "4395280"
  },
  {
    "text": "issues with tcp sequence over randomization timeouts we found made it more difficult to do the testing because",
    "start": "4395280",
    "end": "4401360"
  },
  {
    "text": "we had to clear them out and there's also a work within the ietf to require that bgp",
    "start": "4401360",
    "end": "4407840"
  },
  {
    "text": "you accept a ttl of 255 or 254",
    "start": "4407840",
    "end": "4413040"
  },
  {
    "text": "to help minimize the impact of spoofing attacks",
    "start": "4413040",
    "end": "4418400"
  },
  {
    "text": "so i'll move on to mr best practices right here sean convey",
    "start": "4418400",
    "end": "4425239"
  },
  {
    "text": "all right so the last 15 minutes here let's kind of put this all together this is the test network that we built out in the",
    "start": "4435520",
    "end": "4441920"
  },
  {
    "text": "lab again not necessarily representative of the internet as a whole but we tried to make something wide enough that we would",
    "start": "4441920",
    "end": "4447520"
  },
  {
    "text": "actually be able to see some interesting results and again our goal here was to see given all these attacks that we",
    "start": "4447520",
    "end": "4452719"
  },
  {
    "text": "talked about how easy are they to run against the network implementing best practices and how easy are they to run",
    "start": "4452719",
    "end": "4457920"
  },
  {
    "text": "against the network not implementing best practices and does the location on the wire whether you're blind or non-blind matter",
    "start": "4457920",
    "end": "4464400"
  },
  {
    "text": "these are the best practices that we use we base them off for rob thomas's hardening template which is essentially the same as the isp essentials template",
    "start": "4464400",
    "end": "4471440"
  },
  {
    "text": "we made some additions though in red for internet exchange providers where you're doing ethernet based peering things like",
    "start": "4471440",
    "end": "4476800"
  },
  {
    "text": "static arp entries static cam entries port security a lot of the layer 2 stuff which has been talked about before",
    "start": "4476800",
    "end": "4482239"
  },
  {
    "text": "starts mattering a lot in these environments one of the interesting things to point out is similar to ingress filtering for",
    "start": "4482239",
    "end": "4489040"
  },
  {
    "text": "spoofing they have mechanisms to do ingress filtering for prefixes so i can say if i'm you know if i'm an isp and",
    "start": "4489040",
    "end": "4495600"
  },
  {
    "text": "i'm peering with a customer who has the you know the 57.27",
    "start": "4495600",
    "end": "4501040"
  },
  {
    "text": "you know cider block class b 16 i can set it up so that that's the only route i will accept from him so that if that",
    "start": "4501040",
    "end": "4508000"
  },
  {
    "text": "router somehow gets compromised and somebody just starts spewing crap you know crap 32 routes i can set prefix",
    "start": "4508000",
    "end": "4513840"
  },
  {
    "text": "filters up to prevent that so that's definitely a recommended a recommended best practice and in many",
    "start": "4513840",
    "end": "4519520"
  },
  {
    "text": "cases it's the only thing that helps you when there's a compromised router if i've got a compromised router just like",
    "start": "4519520",
    "end": "4524880"
  },
  {
    "text": "if i have a compromise web server all bets are off in terms of what you can do with that compromise device",
    "start": "4524880",
    "end": "4532320"
  },
  {
    "text": "so actually i think i somehow skipped the slide sorry guys",
    "start": "4532320",
    "end": "4538880"
  },
  {
    "text": "so if we look before the best practices um backing up one apologize uh if you",
    "start": "4538880",
    "end": "4544400"
  },
  {
    "text": "don't have any best practices at all as a blind attacker because of the sequence number guessing problem uh most attacks",
    "start": "4544400",
    "end": "4550239"
  },
  {
    "text": "are mostly impossible you know there's some potentially some things you could do but the pain involved is going to be such that an attacker isn't necessarily",
    "start": "4550239",
    "end": "4556640"
  },
  {
    "text": "going to want to spend a lot of time in that space and everything depends on getting access to a link with a bgp",
    "start": "4556640",
    "end": "4562239"
  },
  {
    "text": "speaker on it or compromising a router so those become really really important as initial tests as a non-blind attacker",
    "start": "4562239",
    "end": "4569600"
  },
  {
    "text": "there's a lot more you can do i can reset sessions at will i can insert routes but again that axe storm is going to tear down the session after a few",
    "start": "4569600",
    "end": "4575840"
  },
  {
    "text": "minutes i can do pure hijacking with arp spoofing there's a lot more damage i can cause then finally with a compromise",
    "start": "4575840",
    "end": "4581520"
  },
  {
    "text": "router i could do just about anything i want which includes sending ballot or invalid prefix information out so if i",
    "start": "4581520",
    "end": "4587520"
  },
  {
    "text": "want to modify the as path of a bgp update so that you know maybe traffic is preferred through my isp when it's not",
    "start": "4587520",
    "end": "4593600"
  },
  {
    "text": "supposed to be i can cause traffic to be redirected through my connection",
    "start": "4593600",
    "end": "4599520"
  },
  {
    "text": "so we talked about the best practices if we have all those best practices implemented the key ones become for a",
    "start": "4600800",
    "end": "4606719"
  },
  {
    "text": "blind attacker rfc 2827 again the ingress filtering anti-spoof rfc if i do",
    "start": "4606719",
    "end": "4611760"
  },
  {
    "text": "this right i can stop all the tcp based attacks that are happening from a remote",
    "start": "4611760",
    "end": "4616800"
  },
  {
    "text": "blind attacker and then if i have a if i have a bgp implementation that will synack to 179",
    "start": "4616800",
    "end": "4622960"
  },
  {
    "text": "even if it's not a configured peer i can do some work with bgp acls to basically limit who's allowed to talk on tcp port",
    "start": "4622960",
    "end": "4629360"
  },
  {
    "text": "179. so those become the two biggest hitters for a blind attacker for a non-blind attacker again layer two best",
    "start": "4629360",
    "end": "4635520"
  },
  {
    "text": "practices that we talked about before start mattering a lot and then md5 in an ethernet exterior exchange point that",
    "start": "4635520",
    "end": "4641840"
  },
  {
    "text": "becomes a lot more valuable than md5 digest for bgp might be in a private peering relationship over over a private",
    "start": "4641840",
    "end": "4648560"
  },
  {
    "text": "lease line and then the ingress and egress prefix filtering which i've talked about in the previous slide that's going to limit the damage if",
    "start": "4648560",
    "end": "4654800"
  },
  {
    "text": "there's a compromise same thing in a compromised router that prefix filtering will allow me to prevent a lot of the",
    "start": "4654800",
    "end": "4660400"
  },
  {
    "text": "update flooding from happening now the closer you get to the core the network the harder it gets to be able to do that prefix filtering because due to the",
    "start": "4660400",
    "end": "4666800"
  },
  {
    "text": "asymmetric nature of the internet it's more likely that you start receiving all kinds of different networks so you can",
    "start": "4666800",
    "end": "4672000"
  },
  {
    "text": "optionally set the how big a prefix you'll you'll accept so you can set it",
    "start": "4672000",
    "end": "4677280"
  },
  {
    "text": "up and say i'm not going to allow anybody to advertise a slash 32 route because that's a host route i shouldn't get that but i may say let people any uh",
    "start": "4677280",
    "end": "4685040"
  },
  {
    "text": "advertise anything 27 bits or smaller for example might be might be a best practice that somebody would implement",
    "start": "4685040",
    "end": "4691440"
  },
  {
    "text": "so as we expected a compromise route is the most beneficial thing that you can have",
    "start": "4691440",
    "end": "4696560"
  },
  {
    "text": "as a bgp attacker there are certainly lots of data that's shown that there's a lot of bgp routers that are able to be",
    "start": "4696560",
    "end": "4703199"
  },
  {
    "text": "compromised or have been compromised we'll show you some of the isp scan data here in a couple of slides but that",
    "start": "4703199",
    "end": "4708880"
  },
  {
    "text": "doesn't necessarily mean we need to completely replace bgp as a result right i mean i can compromise a web server but",
    "start": "4708880",
    "end": "4714320"
  },
  {
    "text": "that doesn't mean we need to throw out http as a protocol so we want to focus on the things that that the attacker can",
    "start": "4714320",
    "end": "4720080"
  },
  {
    "text": "do with a compromise router or without a compromise router and try and fix those problems first with any modifications",
    "start": "4720080",
    "end": "4725520"
  },
  {
    "text": "that we make to bgp",
    "start": "4725520",
    "end": "4728560"
  },
  {
    "text": "all right so the the active survey results",
    "start": "4730640",
    "end": "4735679"
  },
  {
    "text": "so the goal is we didn't want to intrusively test there's a lot more work we could have done if we would have went very aggressive in the port scanning",
    "start": "4735679",
    "end": "4741760"
  },
  {
    "text": "that we did of the isp routers we went after and tried to log into these boxes if we tried to establish peering",
    "start": "4741760",
    "end": "4747679"
  },
  {
    "text": "relationships to the boxes there's a lot more we could do but you know having cisco port scan you is probably not something real high in your list of",
    "start": "4747679",
    "end": "4754080"
  },
  {
    "text": "happy things to have happen so we tried to make this very very benign and uh try and stay below the radar you know",
    "start": "4754080",
    "end": "4760480"
  },
  {
    "text": "although you know because we you know matt basically had to stand up in front of nanog and tell the isp community we",
    "start": "4760480",
    "end": "4765600"
  },
  {
    "text": "just scanned you sorry uh and and they were they're pretty uh pretty good uh good chaps about it",
    "start": "4765600",
    "end": "4771440"
  },
  {
    "text": "so the way we did it was we limited the scanning to only a single sin so this is going to result in the results being a",
    "start": "4771440",
    "end": "4776960"
  },
  {
    "text": "little bit skewed because if something got lost in transit we're not going to do a retry because we want it again keep",
    "start": "4776960",
    "end": "4782320"
  },
  {
    "text": "this very very light so what we started with is we went to one of the route servers on the internet",
    "start": "4782320",
    "end": "4787520"
  },
  {
    "text": "and got the entire internet routing table which is about 120 000 rounds and then we took each one of those cider",
    "start": "4787520",
    "end": "4793120"
  },
  {
    "text": "blocks and then created a host out of that cider block so you know hp for example has the 15 network so we took",
    "start": "4793120",
    "end": "4800280"
  },
  {
    "text": "15.0.0.0 we took those last three zeros and then randomized to create a source address or a destination address for our",
    "start": "4800280",
    "end": "4807120"
  },
  {
    "text": "trace route that we took those hundred twenty thousand routes and then traced to each of them using using the tools that make",
    "start": "4807120",
    "end": "4813520"
  },
  {
    "text": "shipment developed for us and uh and basically built a huge database of all the various potential routers that we",
    "start": "4813520",
    "end": "4819760"
  },
  {
    "text": "went after we then lopped off a couple of hops at the front and the back to make sure we had bgp speakers and then",
    "start": "4819760",
    "end": "4825199"
  },
  {
    "text": "unique the list and pulled out rfc 1918 routers which believe it or not there are rfc 1918 addressed routers in the",
    "start": "4825199",
    "end": "4832800"
  },
  {
    "text": "core of the internet you know if you've ever had trace route you know return a 10 network address and had trouble",
    "start": "4832800",
    "end": "4837840"
  },
  {
    "text": "troubleshooting you know that's uh that's that's certainly why then we sent the tcp sends on port 22",
    "start": "4837840",
    "end": "4843920"
  },
  {
    "text": "2380 and 179. we embedded a message into the payload saying that this wasn't uh",
    "start": "4843920",
    "end": "4849199"
  },
  {
    "text": "this wasn't some sort of uh you know attack and that if they wanted more information they could contact us uh",
    "start": "4849199",
    "end": "4854719"
  },
  {
    "text": "mike actually did get one response uh i'm not gonna say who but let's just say i have a little bit more respect for the",
    "start": "4854719",
    "end": "4859920"
  },
  {
    "text": "information security skills of our military",
    "start": "4859920",
    "end": "4863920"
  },
  {
    "text": "actually we were notified through the cisco account manager um it was everything's okay now we're all still",
    "start": "4865600",
    "end": "4871520"
  },
  {
    "text": "employed so um and we measured the response you know",
    "start": "4871520",
    "end": "4877040"
  },
  {
    "text": "did they send us an act did they reset did they give no response at all and then the tcp 179s that did synac we",
    "start": "4877040",
    "end": "4883440"
  },
  {
    "text": "then sent a bgp open to try and measure the response okay so what do we find well after we",
    "start": "4883440",
    "end": "4890480"
  },
  {
    "text": "unique the list we had about 115 000 routers that we went and scanned of those uh four thousand responded over",
    "start": "4890480",
    "end": "4898400"
  },
  {
    "text": "four thousand responded with a syn act to bgp 3000 reset and the vast majority thankfully uh gave no response as you",
    "start": "4898400",
    "end": "4905360"
  },
  {
    "text": "would expect them to when we tried to send a bgp open to those 4 600 that sent synax we found in",
    "start": "4905360",
    "end": "4912239"
  },
  {
    "text": "most cases we actually got to connect uh just a tcp connect with no data so we weren't able to establish any kind of bgp",
    "start": "4912239",
    "end": "4918719"
  },
  {
    "text": "communication but uh about 1600 of them sent open notifications some with authentication",
    "start": "4918719",
    "end": "4924800"
  },
  {
    "text": "fail and then some we got the cease message which we didn't previously see in any of our testing some we got notification only is where",
    "start": "4924800",
    "end": "4931040"
  },
  {
    "text": "we got a cease message as well so this information combined with the tcp information that matt was talking about",
    "start": "4931040",
    "end": "4936560"
  },
  {
    "text": "earlier in the presentation could probably use as a way to fingerprint bgp routers on the internet based on the",
    "start": "4936560",
    "end": "4942719"
  },
  {
    "text": "responses that they give to some of these invalid or valid messages that's something to be aware of",
    "start": "4942719",
    "end": "4948000"
  },
  {
    "text": "now again you know basic best practice for an isp you should not be allowing people to telnet or ssh or web to your",
    "start": "4948000",
    "end": "4955120"
  },
  {
    "text": "routers from any arbitrary ip address this is a basic best practice so we figured if you're not if the isp wasn't",
    "start": "4955120",
    "end": "4960480"
  },
  {
    "text": "doing that then there was no way they were doing prefix filtering or any of the more advanced best practices so we",
    "start": "4960480",
    "end": "4965679"
  },
  {
    "text": "found 6300 responded on 422 over almost 11 000 and 423 which is pretty scary and",
    "start": "4965679",
    "end": "4972080"
  },
  {
    "text": "5500 had web servers running which is never a good thing you know for your router if you've you know ever followed",
    "start": "4972080",
    "end": "4977280"
  },
  {
    "text": "any of the hardening templates for uh for devices and then we took that list and said okay how many of the routers of",
    "start": "4977280",
    "end": "4982800"
  },
  {
    "text": "115 000 were reachable on at least one of those ports and we found almost",
    "start": "4982800",
    "end": "4987920"
  },
  {
    "text": "seventeen thousand were really reachable on at least one command and control port uh which is um fourteen and a half",
    "start": "4987920",
    "end": "4993679"
  },
  {
    "text": "percent of all the routers we tested so based on this data and again like we said we we skewed towards being sort of",
    "start": "4993679",
    "end": "5000960"
  },
  {
    "text": "uh nice in our scanning so the data is going to be a little bit inaccurate you know 15 of the routers out there are",
    "start": "5000960",
    "end": "5007520"
  },
  {
    "text": "reachable on some kind of a command and control port which uh which isn't um you know good",
    "start": "5007520",
    "end": "5013600"
  },
  {
    "text": "so then we took a commercial tool that we uh we purchased to unique that list and to give us",
    "start": "5013600",
    "end": "5019760"
  },
  {
    "text": "information on country just for fun to kind of see where what areas of the world might have the most susceptibility",
    "start": "5019760",
    "end": "5025520"
  },
  {
    "text": "or uh to some of these attacks or or the best implementation of best practices so we had lots of countries that either had",
    "start": "5025520",
    "end": "5032080"
  },
  {
    "text": "100 of their routers uh accessible on command and control or zero percent but we didn't include them because there",
    "start": "5032080",
    "end": "5037600"
  },
  {
    "text": "were less than 10 routers in the country that we actually tested yeah there were probably more than 10 rounders in the whole country but you",
    "start": "5037600",
    "end": "5043920"
  },
  {
    "text": "know only 10 that we tested and then we came up with a list here this is just showing you sort of the uh the best the average and the worst usa",
    "start": "5043920",
    "end": "5051360"
  },
  {
    "text": "because it has the vast majority of the routers you'd expect it to be near the average and it was uh you know anybody",
    "start": "5051360",
    "end": "5056639"
  },
  {
    "text": "here from all davies or gibraltar you know excellent very nicely done zero percent",
    "start": "5056639",
    "end": "5062000"
  },
  {
    "text": "so and then you know if you're ever going to the bahamas and you know you get tired of sitting on the beach you know probably most of the routers there",
    "start": "5062000",
    "end": "5068239"
  },
  {
    "text": "would would happily allow you to log in with the password of cisco",
    "start": "5068239",
    "end": "5073040"
  },
  {
    "text": "so honorable mentions actually it's worthy of note spain france and great britain which all had large numbers of",
    "start": "5074960",
    "end": "5080159"
  },
  {
    "text": "routers all did significantly better than the us and canada in their implementation of best practices",
    "start": "5080159",
    "end": "5086880"
  },
  {
    "text": "all right and then i'll give it over to matt and he'll wrap it up and y'all can go on your way",
    "start": "5087600",
    "end": "5092639"
  },
  {
    "text": "so fortunately this ended on a sour note because uh one of the painful thing painful and",
    "start": "5092639",
    "end": "5098320"
  },
  {
    "text": "unusual things about uh this work was that as a you know security researcher typically your your job is to say that",
    "start": "5098320",
    "end": "5105440"
  },
  {
    "text": "everything is horrible the sky is falling and things are really bad so some of this work was kind of curious",
    "start": "5105440",
    "end": "5112159"
  },
  {
    "text": "and that we were saying you know oh well bgp isn't as bad as it really as it could be or",
    "start": "5112159",
    "end": "5117840"
  },
  {
    "text": "but i don't want to give the the perception or i want you to walk away that things are okay with internet",
    "start": "5117840",
    "end": "5124159"
  },
  {
    "text": "routing the goal of this work was to provide some more concrete data on where",
    "start": "5124159",
    "end": "5129920"
  },
  {
    "text": "specifically the issues were where were the vulnerabilities was it through",
    "start": "5129920",
    "end": "5136000"
  },
  {
    "text": "was it through using bgp or as we found that you know the greatest threat is obviously a compromise router so if the",
    "start": "5136000",
    "end": "5143280"
  },
  {
    "text": "greatest threats uh don't have nothing to do with the protocol itself then maybe we need when you're devising",
    "start": "5143280",
    "end": "5150000"
  },
  {
    "text": "solutions you shouldn't moved so quickly to",
    "start": "5150000",
    "end": "5155440"
  },
  {
    "text": "implementing solutions that will require you know massive upgrades and widespread",
    "start": "5155440",
    "end": "5160800"
  },
  {
    "text": "widespread deployment of pki et cetera now i'm not being i'm not disparaging these",
    "start": "5160800",
    "end": "5166080"
  },
  {
    "text": "you know spg sbgp or sob gp but uh",
    "start": "5166080",
    "end": "5171120"
  },
  {
    "text": "it's important to know where the real risks are and based on the testing that we did many of it's just the basic",
    "start": "5171120",
    "end": "5176639"
  },
  {
    "text": "common sense stuff and it's harder to actually do things with bgp itself",
    "start": "5176639",
    "end": "5182159"
  },
  {
    "text": "unless you're able to somehow compromise that link so simple things that we thought would",
    "start": "5182159",
    "end": "5187440"
  },
  {
    "text": "be fairly easy some of the tcp attacks proved to be you know harder than harder",
    "start": "5187440",
    "end": "5193120"
  },
  {
    "text": "than we would suspect so you have to uh someone asked well if i reset the link and then i quickly syn flood it before",
    "start": "5193120",
    "end": "5199440"
  },
  {
    "text": "the links are established again then you're able to do something with simplet so it it proves to be harder than than",
    "start": "5199440",
    "end": "5205520"
  },
  {
    "text": "what many folks were talking about now and kind of the bottom line is that you know the way i see it is if you're an",
    "start": "5205520",
    "end": "5210880"
  },
  {
    "text": "attacker and you have a specific objective you will choose the you're not trying to choose the most",
    "start": "5210880",
    "end": "5217360"
  },
  {
    "text": "elegant or the best attack that will get you a nice black hat presentation you will choose the",
    "start": "5217360",
    "end": "5224960"
  },
  {
    "text": "path of least resistance so given the data on the large numbers of owned",
    "start": "5224960",
    "end": "5230719"
  },
  {
    "text": "routers out there and the large numbers of routers with default passwords and this this correlates with what we saw in",
    "start": "5230719",
    "end": "5237360"
  },
  {
    "text": "terms of the admin ports the best way to altering the internet routing infrastructure is to compromise a router",
    "start": "5237360",
    "end": "5244480"
  },
  {
    "text": "and and do it that way",
    "start": "5244480",
    "end": "5247679"
  },
  {
    "text": "so other things uh encourage folks to do testing i mean there's never enough time to do",
    "start": "5250480",
    "end": "5257679"
  },
  {
    "text": "security testing vendors have to do their jobs independent researchers need to do their jobs academics customers if they have",
    "start": "5257679",
    "end": "5265120"
  },
  {
    "text": "the ability to do testing of devices so that's that's one thing uh this the",
    "start": "5265120",
    "end": "5271840"
  },
  {
    "text": "testing that we did was by no means a hundred percent i'm sure there are some things we've we missed the goal is this",
    "start": "5271840",
    "end": "5278639"
  },
  {
    "text": "you know because there was such a scarcity of information on testing of actual devices versus more theoretical",
    "start": "5278639",
    "end": "5284639"
  },
  {
    "text": "academic work was to just put some information and some techniques and some methodology and some tools out there so for folks could",
    "start": "5284639",
    "end": "5291840"
  },
  {
    "text": "extend and do test more devices fill in some gaps because there are probably some gaps",
    "start": "5291840",
    "end": "5298480"
  },
  {
    "text": "bcps best common practices uh you know you hear it over and over again but people don't do them",
    "start": "5298480",
    "end": "5304880"
  },
  {
    "text": "also they're you know and i found this to be true uh in some other areas such as scada protocols there are a lot of",
    "start": "5304880",
    "end": "5311040"
  },
  {
    "text": "folks that are just literally out there saying the sky is falling things are completely insecure uh makes folks be a",
    "start": "5311040",
    "end": "5317440"
  },
  {
    "text": "little more specific what are the specific problems where are the vulnerabilities because we we're not in this you know",
    "start": "5317440",
    "end": "5324159"
  },
  {
    "text": "security is not all or nothing and you know there will be you know within you know probably the most",
    "start": "5324159",
    "end": "5330800"
  },
  {
    "text": "aggressive estimates you know 18 months to 24 months there will be secure versions of bgp that reach the standards",
    "start": "5330800",
    "end": "5338000"
  },
  {
    "text": "form but they're not going to be here anytime soon so you need to use the best practices you need to tighten the",
    "start": "5338000",
    "end": "5343920"
  },
  {
    "text": "vendors implementations because there are a lot of little things that you can do to minimize most of the tax the attacks so",
    "start": "5343920",
    "end": "5351840"
  },
  {
    "text": "and like i said there's there's more test cases because we were not comprehensive and you know based on the",
    "start": "5352719",
    "end": "5359440"
  },
  {
    "text": "responses that we got from from scanning isp routers there are definitely some some implementations that we did not get",
    "start": "5359440",
    "end": "5366320"
  },
  {
    "text": "to test so and there's a whole bunch of references so i guess maybe a few questions",
    "start": "5366320",
    "end": "5373120"
  },
  {
    "text": "we're done okay we'll be we'll be around if anybody wants to give us feedback or argue with us or whatever",
    "start": "5373120",
    "end": "5382119"
  }
]