[
  {
    "start": "0",
    "end": "27000"
  },
  {
    "text": "so the this is uh track 3 malware the talk is Hardware back dooring is practical by Jonathan",
    "start": "80",
    "end": "7160"
  },
  {
    "text": "Brad thank you Bab thank you for coming uh before we",
    "start": "7480",
    "end": "12880"
  },
  {
    "text": "start I would ask you to uh give a big Applause to like all the goons the staff the organizers it's massive work they've",
    "start": "12880",
    "end": "19960"
  },
  {
    "text": "not been",
    "start": "19960",
    "end": "22279"
  },
  {
    "text": "sleeping thank you for them all right so we're going to talk a bit about back dooring",
    "start": "25000",
    "end": "31640"
  },
  {
    "text": "Hardware uh obviously like you know we had blackout and stuff so we're not terrorists um interestingly the source",
    "start": "31640",
    "end": "39840"
  },
  {
    "text": "code is already public cuz most of the malware is built on on top of Open",
    "start": "39840",
    "end": "46079"
  },
  {
    "text": "Source the main problem really that um the PC architecture is pled by Legacy",
    "start": "46079",
    "end": "53680"
  },
  {
    "text": "it should not be a surprise to most of you but we're going to see that it's actually pled to an extent that I",
    "start": "53680",
    "end": "59399"
  },
  {
    "text": "believe it's not possible to do U security on on on the PC",
    "start": "59399",
    "end": "65119"
  },
  {
    "text": "already um so like there is a there is a need to disco these problems I don't have a magic solution uh but like feel",
    "start": "65119",
    "end": "72080"
  },
  {
    "text": "free to contribute and uh I mean one of the",
    "start": "72080",
    "end": "77640"
  },
  {
    "text": "point of why doing a talk like this uh I believe this is slightly better we will",
    "start": "77640",
    "end": "82920"
  },
  {
    "text": "see see why over existing work so uh we will start by explaining",
    "start": "82920",
    "end": "91200"
  },
  {
    "text": "um I mean if I was to design a back door which is something I don't usually do um",
    "start": "91200",
    "end": "98880"
  },
  {
    "text": "I would I would like it to be epic I want to do it once so uh we'll start by",
    "start": "98880",
    "end": "104560"
  },
  {
    "text": "designing a scope of work on what would be the perfect back door then I will explain you a bit of architecture uh of",
    "start": "104560",
    "end": "111560"
  },
  {
    "text": "Intel architecture we we review the state-of-the-art of root kitching bias",
    "start": "111560",
    "end": "117600"
  },
  {
    "text": "kitching r kitching and I introduce you to uh the the new work I've been I've been",
    "start": "117600",
    "end": "125159"
  },
  {
    "text": "developing all right so the typical one my slide uh so I'm a security researcher",
    "start": "125159",
    "end": "131400"
  },
  {
    "text": "I do a bit of pen test because they keep promising me that uh the next month I'm going to do uh main frames and stuff and",
    "start": "131400",
    "end": "138959"
  },
  {
    "text": "it never happens uh I started assembly about 15 years ago it was my first language so uh",
    "start": "138959",
    "end": "146080"
  },
  {
    "text": "I think like the first language you will learn is actually super super important",
    "start": "146080",
    "end": "151440"
  },
  {
    "text": "um for the the way you see computers and um so like I started by by",
    "start": "151440",
    "end": "157200"
  },
  {
    "text": "running these Assemblies of viruses and stuff I had no idea what's difficult so like you know you don't consider it as",
    "start": "157200",
    "end": "164080"
  },
  {
    "text": "such I've been a speaker to a few at a few conferences um if you if you would",
    "start": "164080",
    "end": "169640"
  },
  {
    "text": "like to speak yourself we actually organizing conference in Paris uh hak to arome which is mostly around reverse",
    "start": "169640",
    "end": "176680"
  },
  {
    "text": "engineering and low level stuff feel free to sub submit uh well that's it and uh okay my",
    "start": "176680",
    "end": "185040"
  },
  {
    "text": "my English is not quite perfect right first off I'm French which is quite a handicap when it comes to",
    "start": "185040",
    "end": "191519"
  },
  {
    "text": "language then I learned English in India and to make things really perfect",
    "start": "191519",
    "end": "197560"
  },
  {
    "text": "I live in Australia so like so if you don't understand what I'm saying maybe it's not just you uh feel",
    "start": "197560",
    "end": "204560"
  },
  {
    "text": "free to ask me to reformulate all right a bit of f to",
    "start": "204560",
    "end": "209920"
  },
  {
    "start": "207000",
    "end": "447000"
  },
  {
    "text": "start uh and see what it's interesting all right so could a state",
    "start": "209920",
    "end": "216360"
  },
  {
    "text": "uh like China for instance is very much in the air uh back computers so like this was this terrific",
    "start": "216360",
    "end": "224040"
  },
  {
    "text": "report uh prepared for the US Cate and they actually realized after 30 years",
    "start": "224040",
    "end": "231319"
  },
  {
    "text": "that most computers nowadays are actually built in China uh even if your computer is actually designed uh in Western",
    "start": "231319",
    "end": "238040"
  },
  {
    "text": "countries the modules which are assembled all come",
    "start": "238040",
    "end": "243319"
  },
  {
    "text": "from China so it magnifies definitely the risk of someone someone back",
    "start": "243319",
    "end": "250000"
  },
  {
    "text": "dooring a bit more fud and it's the last bot sheet slide I promise so like if you",
    "start": "250000",
    "end": "255439"
  },
  {
    "text": "read the news uh lately like you know you find claims such as 80% of the world",
    "start": "255439",
    "end": "260560"
  },
  {
    "text": "communication at back door by China uh yeah China is backing 80% of",
    "start": "260560",
    "end": "265720"
  },
  {
    "text": "the telecoms um in France it was interesting last last week um basically they realize",
    "start": "265720",
    "end": "272080"
  },
  {
    "text": "that the world core network of France is built out of",
    "start": "272080",
    "end": "278639"
  },
  {
    "text": "zware and they thought that you know somehow this was not quite appropriate",
    "start": "278639",
    "end": "283960"
  },
  {
    "text": "and they choose to default to Alat Lucent which",
    "start": "283960",
    "end": "289800"
  },
  {
    "text": "is I mean the main problem from a European point of view is that really we don't have any anybody uh building",
    "start": "289800",
    "end": "295919"
  },
  {
    "text": "building um um you know core routers and stuff like that Alcatel is Franco amican",
    "start": "295919",
    "end": "302240"
  },
  {
    "text": "but U the hardware is still very much built in China all right that's it so let's",
    "start": "302240",
    "end": "308919"
  },
  {
    "text": "switch a bit to the architecture let me introduce you the problem here is the Intel",
    "start": "308919",
    "end": "316000"
  },
  {
    "text": "architecture so basically uh it has a few layers if we go from the slower",
    "start": "317400",
    "end": "323440"
  },
  {
    "text": "peripherals so ISL was like the first stff design uh in the original specs of",
    "start": "323440",
    "end": "329440"
  },
  {
    "text": "the IBM PC in 1981 so all the those peripherals have one characteristic in",
    "start": "329440",
    "end": "335280"
  },
  {
    "text": "common they are slow as so you have the mouse the floppy the keyboard and that's pretty much",
    "start": "335280",
    "end": "342800"
  },
  {
    "text": "it the South Bridge um contains most of the peripherals like anything which is",
    "start": "342960",
    "end": "349479"
  },
  {
    "text": "like you know your typical ethernet card um uh your CD ROM um your sound card",
    "start": "349479",
    "end": "356360"
  },
  {
    "text": "whatever um should be connected to the thir Bridge then you have the nor Bridge basically",
    "start": "356360",
    "end": "362759"
  },
  {
    "text": "the closer you get to the CPU the faster it gets so the North Bridge typically um",
    "start": "362759",
    "end": "368840"
  },
  {
    "text": "is connected to peripherals which are much faster like uh extended PCI uh",
    "start": "368840",
    "end": "375520"
  },
  {
    "text": "which is used for gigabyte ethernet uh sand communication um",
    "start": "375520",
    "end": "381360"
  },
  {
    "text": "video and then you have like the proper the proper CPU so one thing which you",
    "start": "381360",
    "end": "386520"
  },
  {
    "text": "can notice is that uh TPM is actually connected very low inside",
    "start": "386520",
    "end": "392880"
  },
  {
    "text": "the inside the chain right we'll get back to this later the other problem I mean the main",
    "start": "392880",
    "end": "401120"
  },
  {
    "text": "big Legacy problem which is a bit unexpected is that at each",
    "start": "401120",
    "end": "407520"
  },
  {
    "text": "layer on every peripheral you have you have a bit of of firmware which can",
    "start": "407520",
    "end": "413599"
  },
  {
    "text": "actually control any other firmware of the same layer so for instance um you",
    "start": "413599",
    "end": "419160"
  },
  {
    "text": "could a firmware on your CD room and it could control your network card which is a bit",
    "start": "419160",
    "end": "426360"
  },
  {
    "text": "unexpected and there's really no no way to fix it it's like the standard is like this and we're going to see that this",
    "start": "426360",
    "end": "433000"
  },
  {
    "text": "leads to some problems any questions so far Y what is",
    "start": "433000",
    "end": "439120"
  },
  {
    "text": "FSB FSB it's a fast something",
    "start": "439120",
    "end": "445199"
  },
  {
    "text": "Bridge exactly I just wondered if you guys were",
    "start": "445199",
    "end": "451479"
  },
  {
    "start": "447000",
    "end": "692000"
  },
  {
    "text": "following so let's talk a bit about the state of the art the idea of of of getting early",
    "start": "451479",
    "end": "459360"
  },
  {
    "text": "execution is really not new like um the first IBM PC virus uh brain which was",
    "start": "459360",
    "end": "466240"
  },
  {
    "text": "allegedly built in in Pakistan uh was targeting himself the master B record in",
    "start": "466240",
    "end": "471759"
  },
  {
    "text": "the ' 80s and '90s like virtually every virus was acting this",
    "start": "471759",
    "end": "477360"
  },
  {
    "text": "way um then with the appearance of in of",
    "start": "477360",
    "end": "483840"
  },
  {
    "text": "Internet uh people started to switch to like higher",
    "start": "483840",
    "end": "489360"
  },
  {
    "text": "um higher languages like you know um to spread via email and stuff like that",
    "start": "489360",
    "end": "494960"
  },
  {
    "text": "which is a bit an easy if you start very low um um very low level so people",
    "start": "494960",
    "end": "500639"
  },
  {
    "text": "started to spread like you know VBS um um manare and stuff like that then in",
    "start": "500639",
    "end": "507159"
  },
  {
    "text": "2007 um so johnes man from NGS uh resurrected sort of uh the concept of of",
    "start": "507159",
    "end": "515800"
  },
  {
    "text": "of backdooring um so not exactly the BIOS but the the",
    "start": "515800",
    "end": "522760"
  },
  {
    "text": "EFI which is the standard which was before unite unified EFI and which is which is not",
    "start": "522760",
    "end": "530120"
  },
  {
    "text": "duplicated inspired this work a lot from um the work from EI uh boot root which",
    "start": "530120",
    "end": "536839"
  },
  {
    "text": "was a boot kit so it's not exactly a back door but uh the idea was like to subvert the kernel by patching it on the",
    "start": "536839",
    "end": "543760"
  },
  {
    "text": "flight to gain higher privileges then an amazing work from the guys from cor Security in",
    "start": "543760",
    "end": "550440"
  },
  {
    "text": "2009 they did it the hard way they said all right like let's forget about the master B record um you know if people",
    "start": "550440",
    "end": "557680"
  },
  {
    "text": "change their hard drive or reinstall their operating system um you don't keep you don't keep",
    "start": "557680",
    "end": "563839"
  },
  {
    "text": "extion anymore and they did it the hard way cuz they took a firmware uh from a",
    "start": "563839",
    "end": "569160"
  },
  {
    "text": "bik the award um firmware they identified the checkin",
    "start": "569160",
    "end": "575920"
  },
  {
    "text": "routine they patch it to introduce um um interesting functions and they patch",
    "start": "575920",
    "end": "582120"
  },
  {
    "text": "back the uh checksumming they compensated the checking uh of this of",
    "start": "582120",
    "end": "587600"
  },
  {
    "text": "this um firmware so it was really the first bios bios kit um",
    "start": "587600",
    "end": "594440"
  },
  {
    "text": "no then a bunch of people um worked on boot kitting they again not not exactly",
    "start": "594440",
    "end": "601160"
  },
  {
    "text": "from a back backd dooring perspective but more to elevate privileges everybody's familiar with",
    "start": "601160",
    "end": "607360"
  },
  {
    "text": "what bootkit Jey",
    "start": "607360",
    "end": "613800"
  },
  {
    "text": "okay so the the best commercial boot kit you can find these days is is the one",
    "start": "614360",
    "end": "619399"
  },
  {
    "text": "from p b it's called comut and it works it's pretty simple it works for every version of Windows 32 and 64 bit it's uh",
    "start": "619399",
    "end": "627880"
  },
  {
    "text": "it's pretty decent uh um penetration testing tool like if you need to elevate privileges assuming you can boot the",
    "start": "627880",
    "end": "634079"
  },
  {
    "text": "computer you boot on a you boot on a floppy or a CD and um it's going to",
    "start": "634079",
    "end": "639920"
  },
  {
    "text": "patch on the Fly the Cel so that you don't need I mean you can authenticate",
    "start": "639920",
    "end": "644959"
  },
  {
    "text": "using any password with the administrative account anybody has seen snare in the",
    "start": "644959",
    "end": "652600"
  },
  {
    "text": "morning yep was he good so his work is pretty related cuz",
    "start": "652600",
    "end": "658760"
  },
  {
    "text": "he's been working working on the uh uh unified EFI which is like what's used mostly by um um apple and is upcoming",
    "start": "658760",
    "end": "668440"
  },
  {
    "text": "also for for Intel and so like it's pretty complimentary the idea that it's not",
    "start": "668440",
    "end": "674320"
  },
  {
    "text": "entirely different it's still very much a bias back end actually to detect the hardware and stuff your",
    "start": "674320",
    "end": "680000"
  },
  {
    "text": "peripherals um but instead of having an inter Vector table um um you're using",
    "start": "680000",
    "end": "685440"
  },
  {
    "text": "another set of API to interact with the hardware um when train to impact your Cel in",
    "start": "685440",
    "end": "692320"
  },
  {
    "text": "memory all right let's go for the meat okay so let's say we want to do the",
    "start": "692320",
    "end": "698920"
  },
  {
    "text": "super cool back door the super cool back door of the of the",
    "start": "698920",
    "end": "703959"
  },
  {
    "text": "year we want it persistent like obviously not just persistent between reboots but persistent as in even if you",
    "start": "703959",
    "end": "712160"
  },
  {
    "text": "remove the hard drive and change it even if you reinstall the operating system um even if if somehow like you",
    "start": "712160",
    "end": "719240"
  },
  {
    "text": "you know you remove peripherals and you put all the peripherals or even if you actually Flash the bias we still want to",
    "start": "719240",
    "end": "725360"
  },
  {
    "text": "be there this is what I Define as persistent we want to be still so I",
    "start": "725360",
    "end": "733440"
  },
  {
    "text": "think this is pretty interesting um we're going to try to have zero hostile code on the machine which leaves zero",
    "start": "733440",
    "end": "740800"
  },
  {
    "text": "attack surface for n virus if you think from a mar",
    "start": "740800",
    "end": "746040"
  },
  {
    "text": "perspective ideally it should be portable so like not targeting um any operating",
    "start": "746040",
    "end": "754360"
  },
  {
    "text": "system if you want the perfect back door I mean come on we'd like remote access uh we we' like to we'd like to be",
    "start": "755040",
    "end": "761519"
  },
  {
    "text": "capable of remote updates even if we're talking about firmware",
    "start": "761519",
    "end": "768160"
  },
  {
    "text": "stuff if you want a nation state quality back door think flame St net we'd like",
    "start": "768160",
    "end": "774800"
  },
  {
    "text": "two things plausible deniability which is basically saying oh no no it's a mistake like it wasn't a",
    "start": "774800",
    "end": "782079"
  },
  {
    "text": "back door and non attribution which is basically oh no no it wasn't me usually",
    "start": "782079",
    "end": "788160"
  },
  {
    "text": "it's like it wasn't me it was China ideally we'd like to cross Network",
    "start": "788160",
    "end": "794639"
  },
  {
    "text": "parameters I mean if if we are to uh um back door proper corporations and stuff",
    "start": "794639",
    "end": "801120"
  },
  {
    "text": "it's very likely that they will have authentication firewalls um they will have IDs IPS",
    "start": "801120",
    "end": "807399"
  },
  {
    "text": "whatnot um so like we'd like to get rid of all",
    "start": "807399",
    "end": "812480"
  },
  {
    "text": "this problem at all we'd like to have some degree of redundancy there again if um you know",
    "start": "812480",
    "end": "819600"
  },
  {
    "text": "say we want to um infect U the CD driver I mean the CD firmware if for",
    "start": "819600",
    "end": "826880"
  },
  {
    "text": "some reason the user decides to uh remove the CD and PCH another one I mean",
    "start": "826880",
    "end": "833320"
  },
  {
    "text": "not the not the proper uh disc but like remove the physical peripheral and PCH another one with want to be there so we",
    "start": "833320",
    "end": "840639"
  },
  {
    "text": "need some degree of redundancy and needless to say we don't want to be detected by",
    "start": "840639",
    "end": "847759"
  },
  {
    "text": "antiviruses who works for an antivirus",
    "start": "847759",
    "end": "852199"
  },
  {
    "text": "company all right Andrew yeah yeah you do actually all right so let's go to the",
    "start": "853160",
    "end": "860279"
  },
  {
    "text": "design thing so rasa is built on top of free",
    "start": "860279",
    "end": "866279"
  },
  {
    "text": "software Bo familiar with cor boot for instance Coro is awesome it used to be called uh",
    "start": "866279",
    "end": "872360"
  },
  {
    "text": "Linux bias it's like a bias is basically comprised of two things you have the the",
    "start": "872360",
    "end": "878519"
  },
  {
    "text": "back end of the bias which is responsible for doing the BIOS post and discovering all the",
    "start": "878519",
    "end": "884120"
  },
  {
    "text": "peripherals um is basically the first piece of software which is executed in memory um um on your on your computer so",
    "start": "884120",
    "end": "891399"
  },
  {
    "text": "like it's responsible for finding critical things such as the ram such as the hard drive and all the other",
    "start": "891399",
    "end": "897639"
  },
  {
    "text": "peripherals then the other half of a bias is like",
    "start": "897639",
    "end": "903959"
  },
  {
    "text": "the front end if you will in the corebot language they call it a payload and I've been using cbias but",
    "start": "903959",
    "end": "911279"
  },
  {
    "text": "there are a few other Alternatives with like better guies and stuff the idea that cbias will do only",
    "start": "911279",
    "end": "918279"
  },
  {
    "text": "one thing it's initializing an interrup Vector table so that you can actually program the",
    "start": "918279",
    "end": "924440"
  },
  {
    "text": "hardware ipxe is an extension of I mean it's an implementation of pxc and a",
    "start": "924440",
    "end": "930839"
  },
  {
    "text": "massive extension of it uh pxc is basically a standard which has been defined by",
    "start": "930839",
    "end": "937240"
  },
  {
    "text": "Intel NM I think um to allow remote",
    "start": "937240",
    "end": "943000"
  },
  {
    "text": "booting and it was using DHCP and tftp that's not really good enough for",
    "start": "943000",
    "end": "949600"
  },
  {
    "text": "me if I want the back door of the century I don't want to uh to be limited to tftp so ipxe provides U massive",
    "start": "949600",
    "end": "958160"
  },
  {
    "text": "Network stack at firmware layer um you have like a full TCP IP stack obviously",
    "start": "958160",
    "end": "965639"
  },
  {
    "text": "UDP but you're you also have like upper layers you can do FTP you can do uh HTTP",
    "start": "965639",
    "end": "972759"
  },
  {
    "text": "you can do https which is going to be interesting for us and there we have a set of payloads",
    "start": "972759",
    "end": "979319"
  },
  {
    "text": "and I'll get back to this later so the good thing about using free software when you think about it uh",
    "start": "979319",
    "end": "985959"
  },
  {
    "text": "apart from portability because cor booot is working with with 230 motherboards",
    "start": "985959",
    "end": "992319"
  },
  {
    "text": "currently I'd like to remind you that the stateof the art is to infect one Biers the job from core security all",
    "start": "992319",
    "end": "999120"
  },
  {
    "text": "right so then think about it 230 motherboards and I did not do the job",
    "start": "999120",
    "end": "1006279"
  },
  {
    "text": "they deserve all the credit um in terms of non-attribution I mean if you think",
    "start": "1006279",
    "end": "1012880"
  },
  {
    "text": "about it most malware today to date contain like 99%",
    "start": "1012880",
    "end": "1021199"
  },
  {
    "text": "of custom code is basically built from scratch so",
    "start": "1021199",
    "end": "1027000"
  },
  {
    "text": "it's super expensive uh people do code reuse between releases like you know um Dooku",
    "start": "1027000",
    "end": "1034360"
  },
  {
    "text": "is borrowing from stocket and whatnot uh which in terms of non attribution is not so great if you're",
    "start": "1034360",
    "end": "1041280"
  },
  {
    "text": "using open source software you can definitely say you know it wasn't me it was public on the internet so this clo",
    "start": "1041280",
    "end": "1047839"
  },
  {
    "text": "is um is a given and it's pretty cheap development U for the",
    "start": "1047839",
    "end": "1054880"
  },
  {
    "text": "result also if you using only uh open source stuff which is legit and I mean",
    "start": "1054880",
    "end": "1061559"
  },
  {
    "text": "they are legitimate projects uh uh using cor booot cbias or ipxe is going to be",
    "start": "1061559",
    "end": "1067200"
  },
  {
    "text": "very hard for an antivirus um to distinguish a malicious version of kobot",
    "start": "1067200",
    "end": "1073559"
  },
  {
    "text": "from a legit one the only thing I did really on KOB boot was um well with a",
    "start": "1073559",
    "end": "1079159"
  },
  {
    "text": "few twist was to patch uh the definition of printf to get rid of the you know",
    "start": "1079159",
    "end": "1085120"
  },
  {
    "text": "this is called Blah Blah Blah um and well from an antivirus perspective the",
    "start": "1085120",
    "end": "1090440"
  },
  {
    "text": "attack surface to detect this cod as malicious is basically",
    "start": "1090440",
    "end": "1095360"
  },
  {
    "start": "1097000",
    "end": "1332000"
  },
  {
    "text": "zero all right so let's go to O",
    "start": "1097280",
    "end": "1102320"
  },
  {
    "text": "works so the idea is to infect multiple firmware inside the computer the first one which is like the",
    "start": "1102320",
    "end": "1109679"
  },
  {
    "text": "obvious you want to infect is the bias because it's the first one to get executed but basically when the bias",
    "start": "1109679",
    "end": "1116280"
  },
  {
    "text": "does is bi post um it executes the uh every firmware to do",
    "start": "1116280",
    "end": "1122320"
  },
  {
    "text": "initialization and if we if we infect for instance the PCI ROM of the CD ROM",
    "start": "1122320",
    "end": "1128440"
  },
  {
    "text": "we get as early execution pretty much as the bias um I mean we get we get",
    "start": "1128440",
    "end": "1133679"
  },
  {
    "text": "executed on um 8086 um real mode because this is a mode",
    "start": "1133679",
    "end": "1141000"
  },
  {
    "text": "CPU starts on and we are the only one in Ram this mode does not support multitasking right",
    "start": "1141000",
    "end": "1147960"
  },
  {
    "text": "so like you you have access to everything in terms of resources but",
    "start": "1147960",
    "end": "1153360"
  },
  {
    "text": "maybe uh if the IU is in place and is decent um maybe you cannot write to some",
    "start": "1153360",
    "end": "1158720"
  },
  {
    "text": "portions of memory so the idea is like we going to we're going to flash the bias and we're",
    "start": "1158720",
    "end": "1165120"
  },
  {
    "text": "going to flash all the PCI RS um like I said previously we can very well",
    "start": "1165120",
    "end": "1171880"
  },
  {
    "text": "use ipxe which is a network firmware and flash a c uh uh with this firmware and",
    "start": "1171880",
    "end": "1179080"
  },
  {
    "text": "it's actually very much going to work so this this is what's going to",
    "start": "1179080",
    "end": "1185280"
  },
  {
    "text": "provide us redundancy and even if the bias uh is somewhat disinfected uh for instance because the",
    "start": "1185280",
    "end": "1192039"
  },
  {
    "text": "user does his proper maintenance and decided to flash his bias to do like CPU updates or whatever",
    "start": "1192039",
    "end": "1199080"
  },
  {
    "text": "um we still have early execution and we can't patch the BIOS back I get back to",
    "start": "1199080",
    "end": "1206919"
  },
  {
    "text": "this what we want to do really eventually uh is boot a bootkit from the",
    "start": "1207200",
    "end": "1213039"
  },
  {
    "text": "network instead of having it on the on the the file system but even on the bias",
    "start": "1213039",
    "end": "1219600"
  },
  {
    "text": "or firmware like it would be much better to have zero sty code on the computer and fetch it at boot time every time",
    "start": "1219600",
    "end": "1228679"
  },
  {
    "text": "so I told you about breaching the network perimeter to avoid detection and you know basically it's very hard to um",
    "start": "1228799",
    "end": "1235880"
  },
  {
    "text": "uh at this very early stage to steal the credentials of a user if the hard drive is encrypted or whatever um stealing the",
    "start": "1235880",
    "end": "1243919"
  },
  {
    "text": "stealing the credentials to access an authentication proxy is going to be pretty tough so we're going to get rid",
    "start": "1243919",
    "end": "1250880"
  },
  {
    "text": "of this problem entirely we're going to try to go primarily over",
    "start": "1250880",
    "end": "1256360"
  },
  {
    "text": "Wi-Fi because there again you even if the company has like massive layers of IDs IPS Etc um if you if you use",
    "start": "1256360",
    "end": "1265480"
  },
  {
    "text": "Wi-Fi um and with some decent encryption um they're very unlikely to actually",
    "start": "1265480",
    "end": "1271000"
  },
  {
    "text": "detect that you're doing any kind of connection at all or exfiltrating",
    "start": "1271000",
    "end": "1276600"
  },
  {
    "text": "data a good thing with ipxe is actually it can fail and um default to",
    "start": "1276840",
    "end": "1284760"
  },
  {
    "text": "other settings so what I do in my back door is try to First boot of a Wi-Fi or",
    "start": "1284760",
    "end": "1290960"
  },
  {
    "text": "yaax if it's available YX even better cuz it's faster if if for some reason there is no",
    "start": "1290960",
    "end": "1297360"
  },
  {
    "text": "Wi-Fi on the current computer then we're going to try to default to DHCP if DHCP",
    "start": "1297360",
    "end": "1302520"
  },
  {
    "text": "is not there we're going to try to default to a static IP and if you cannot connect using a static IP basically the",
    "start": "1302520",
    "end": "1308919"
  },
  {
    "text": "stuff is like well pretty unlikely to have any kind of network connection right if everything else",
    "start": "1308919",
    "end": "1315679"
  },
  {
    "text": "faded okay and uh we're going to show that uh I mean we're going to see that",
    "start": "1317039",
    "end": "1324159"
  },
  {
    "text": "um it will be possible to basically reflash um a firmware later",
    "start": "1324159",
    "end": "1330510"
  },
  {
    "text": "[Music] on any questions so far too easy all",
    "start": "1330510",
    "end": "1337799"
  },
  {
    "start": "1332000",
    "end": "1536000"
  },
  {
    "text": "right so we said um being generic is better because um not only I mean if if",
    "start": "1337799",
    "end": "1344880"
  },
  {
    "text": "you're not if you're not system dependent operating system dependent um you know upcoming versions of whatever",
    "start": "1344880",
    "end": "1351720"
  },
  {
    "text": "operating system you're using or uh if the user is using a very exotic uh",
    "start": "1351720",
    "end": "1357200"
  },
  {
    "text": "operating system um well you'll still be able to get execution so I'm going to show you how",
    "start": "1357200",
    "end": "1363960"
  },
  {
    "text": "we can remove the NX bit everybody's familiar with this concept non-executable",
    "start": "1363960",
    "end": "1372320"
  },
  {
    "text": "bit I'm going to show you how to uh make the mapping I mean every mapping in",
    "start": "1372320",
    "end": "1378520"
  },
  {
    "text": "memory rable in ring Zero from a bootkit or from the BIOS",
    "start": "1378520",
    "end": "1383840"
  },
  {
    "text": "itself we're going to see uh how to downgrade the security of the CPU basically uh micr code updates are",
    "start": "1383840",
    "end": "1391880"
  },
  {
    "text": "usually pushed in the Bios itself uh they got to be pushed early and U you",
    "start": "1391880",
    "end": "1397320"
  },
  {
    "text": "need massive privileges to do them obviously so if you're not familiar with this concept basically when vendors uh I",
    "start": "1397320",
    "end": "1404200"
  },
  {
    "text": "mean Intel or AMD have a problem with their um",
    "start": "1404200",
    "end": "1409559"
  },
  {
    "text": "um CPUs instead of changing your CPU they they allow you to push a sign",
    "start": "1409559",
    "end": "1416279"
  },
  {
    "text": "micro code update which is going to reprogram the the CPU and compensate the",
    "start": "1416279",
    "end": "1422080"
  },
  {
    "text": "physical problem which was there in first place so clearly this is signed uh uh",
    "start": "1422080",
    "end": "1427799"
  },
  {
    "text": "you know using asymmetric proper asymmetric cryptography and the idea that if we get rid of these protections",
    "start": "1427799",
    "end": "1434080"
  },
  {
    "text": "which are usually pushed at the bias layer uh we're going to downgrade",
    "start": "1434080",
    "end": "1439520"
  },
  {
    "text": "the security of the of the CPU entirely some of those bugs are actually",
    "start": "1439520",
    "end": "1445720"
  },
  {
    "text": "exploitable we're going to talk a bit about uh smm which is really a patch",
    "start": "1446360",
    "end": "1451679"
  },
  {
    "text": "mode or ring minus 2 for um uh Intel like",
    "start": "1451679",
    "end": "1457120"
  },
  {
    "text": "CPUs I will not enter into the details but basically uh L Dlow in 2006 and 2007",
    "start": "1457120",
    "end": "1464720"
  },
  {
    "text": "at Conquest presented an attack um so smm stands for system management",
    "start": "1464720",
    "end": "1470760"
  },
  {
    "text": "mode um is basically possible to switch",
    "start": "1470760",
    "end": "1476000"
  },
  {
    "text": "to this super Elite mode which is better than ring zero uh but triggering what's called",
    "start": "1476000",
    "end": "1482960"
  },
  {
    "text": "anme you can do it from userland um but there are I mean and the",
    "start": "1482960",
    "end": "1488399"
  },
  {
    "text": "big problem is that the SMI Ender is basically overlapping with other content in memory typically your video card",
    "start": "1488399",
    "end": "1495679"
  },
  {
    "text": "video frame buffer um so BS demon showed a generic exploit",
    "start": "1495679",
    "end": "1502720"
  },
  {
    "text": "for it in Frack so if we manage to get rid of those smm protections uh we get a local route and",
    "start": "1502720",
    "end": "1509600"
  },
  {
    "text": "given it's going to work whatever operating system you're using because it's a physical",
    "start": "1509600",
    "end": "1515639"
  },
  {
    "text": "problem we're going to talk a bit about disabling address space layer",
    "start": "1516600",
    "end": "1521880"
  },
  {
    "text": "randomization and a bit of boot kitting um the boot kitting part has been",
    "start": "1521880",
    "end": "1527159"
  },
  {
    "text": "provided by P B um I actually asked him like can you",
    "start": "1527159",
    "end": "1532360"
  },
  {
    "text": "help and he helped which is cool okay so audio remove the NX bit",
    "start": "1532360",
    "end": "1541000"
  },
  {
    "start": "1536000",
    "end": "1595000"
  },
  {
    "text": "this is getting a bit gory stay with me okay it's first off every CPU doesn't",
    "start": "1541000",
    "end": "1547000"
  },
  {
    "text": "have it it's a model specific uh register so assuming you have the NX bit",
    "start": "1547000",
    "end": "1553760"
  },
  {
    "text": "uh the AMD 64 um manual stay that there is a a",
    "start": "1553760",
    "end": "1560039"
  },
  {
    "text": "specific bit in the EF register which is also a model specific register and if",
    "start": "1560039",
    "end": "1567240"
  },
  {
    "text": "you flip this bit you disable or you enable um non-execution so the fact of",
    "start": "1567240",
    "end": "1574279"
  },
  {
    "text": "marking I mean historically um everything which was mapped in memory used to be executable",
    "start": "1574279",
    "end": "1581039"
  },
  {
    "text": "which is a terrible idea from an exploitation perspective um so they introdu this bit",
    "start": "1581039",
    "end": "1586880"
  },
  {
    "text": "with the um case six generation in 97 so the idea is like we'd like very",
    "start": "1586880",
    "end": "1593240"
  },
  {
    "text": "much to to get rid of this stuff so we can do it this way um assuming we we so I get back to or we",
    "start": "1593240",
    "end": "1600760"
  },
  {
    "start": "1595000",
    "end": "1725000"
  },
  {
    "text": "get to boot kit execution but assuming we can um launch a",
    "start": "1600760",
    "end": "1606480"
  },
  {
    "text": "bootkit uh basically the idea is to use the CPU ID uh instruction if you don't",
    "start": "1606480",
    "end": "1612600"
  },
  {
    "text": "have the CPU ID instruction your CPU is older than 97 so I will assume that it's",
    "start": "1612600",
    "end": "1618559"
  },
  {
    "text": "all right I don't care uh so first off we query like which is the higher uh function supported by",
    "start": "1618559",
    "end": "1626480"
  },
  {
    "text": "the CPU ID instruction the function is always provided in eax if we have uh something which is",
    "start": "1626480",
    "end": "1633960"
  },
  {
    "text": "lower than 2000 something one uh it's not going to be good enough but there",
    "start": "1633960",
    "end": "1639200"
  },
  {
    "text": "again your CPU is super super hard if we do have this instruction um we query what are the um",
    "start": "1639200",
    "end": "1648440"
  },
  {
    "text": "um um processor information and fature bit",
    "start": "1648440",
    "end": "1653480"
  },
  {
    "text": "so which are processor specific which actually do support and the one we Twisted on is the bit 20 in edx uh CPU",
    "start": "1653480",
    "end": "1662360"
  },
  {
    "text": "ID returns uh I mean the output of CPU ID is basically two registers it's ECX",
    "start": "1662360",
    "end": "1667559"
  },
  {
    "text": "and edx and assuming you actually do have",
    "start": "1667559",
    "end": "1672679"
  },
  {
    "text": "the enx bit uh we're just going to uh flip the bit on eex so the whole thing",
    "start": "1672679",
    "end": "1678960"
  },
  {
    "text": "is like the ef ef register which is actually c",
    "start": "1678960",
    "end": "1686440"
  },
  {
    "text": "000000008 um so we're going to read this MSR into a eax you do do Ms with model",
    "start": "1687600",
    "end": "1695120"
  },
  {
    "text": "specific resistors you do this we thing Rd MSR right so this is going to take",
    "start": "1695120",
    "end": "1701360"
  },
  {
    "text": "this is going to load the content of the EF register into",
    "start": "1701360",
    "end": "1706399"
  },
  {
    "text": "ax we test if the 11th bit is there the",
    "start": "1706399",
    "end": "1711519"
  },
  {
    "text": "one corresponding to an X and um we reset it and right back to",
    "start": "1711519",
    "end": "1717840"
  },
  {
    "text": "the register so the net effect is to disable NX any",
    "start": "1717840",
    "end": "1723720"
  },
  {
    "text": "question too easy okay uh this is something which is",
    "start": "1723720",
    "end": "1729360"
  },
  {
    "start": "1725000",
    "end": "1771000"
  },
  {
    "text": "actually I mean the fact of changing permissions in ring zero is actually something pretty common if you saw uh",
    "start": "1729360",
    "end": "1735919"
  },
  {
    "text": "Dan rosenberg's exploit last year his remote Canal uh uh exploit on uh x25 he",
    "start": "1735919",
    "end": "1742799"
  },
  {
    "text": "was actually using a trick like this so the the idea there again by the manual uh the Intel",
    "start": "1742799",
    "end": "1750320"
  },
  {
    "text": "manuals you have a specific bit which um if you",
    "start": "1755880",
    "end": "1761240"
  },
  {
    "text": "flip uh makes everything which used to be read only in memory executable again",
    "start": "1761240",
    "end": "1767279"
  },
  {
    "text": "um sorry WR again which is a super massive cool feature so uh it's a bit in CR Z it's a",
    "start": "1767279",
    "end": "1775799"
  },
  {
    "start": "1771000",
    "end": "1801000"
  },
  {
    "text": "16th bit of cr0 the control register zero so like it's very straightforward",
    "start": "1775799",
    "end": "1782039"
  },
  {
    "text": "like you just read cr0 into a um you um you mask the bit 16 and you write it",
    "start": "1782039",
    "end": "1788960"
  },
  {
    "text": "back and it's the same thing in 64 bit uh the thing is in 64bit the first",
    "start": "1788960",
    "end": "1794600"
  },
  {
    "text": "32 bits are always zero anyway in CR zero otherwise you get a general protection fault say the",
    "start": "1794600",
    "end": "1802960"
  },
  {
    "start": "1801000",
    "end": "1825000"
  },
  {
    "text": "manuals so removing the CPU updates so cor booot actually does provide the",
    "start": "1802960",
    "end": "1808519"
  },
  {
    "text": "capability of patching your CPU on the Fly uh using CPU Microsoft updates um",
    "start": "1808519",
    "end": "1814799"
  },
  {
    "text": "for the perspective of my back door all I had to do was really to delete all the micro codes and that's it we got rid of",
    "start": "1814799",
    "end": "1824080"
  },
  {
    "start": "1825000",
    "end": "1868000"
  },
  {
    "text": "it so The SMN thing is a bit touchy um basically you have two bits deop and",
    "start": "1826000",
    "end": "1833840"
  },
  {
    "text": "dck um which are to be taken into account the idea that when the delock",
    "start": "1833840",
    "end": "1839240"
  },
  {
    "text": "bit is set u you cannot use um smm anymore ever and this this dirty fix is",
    "start": "1839240",
    "end": "1848320"
  },
  {
    "text": "supposed to be provided by the buyers the specification say that the",
    "start": "1848320",
    "end": "1854159"
  },
  {
    "text": "buyers can use the Deen function to initialize smm and then use the doog to lock down smm",
    "start": "1854159",
    "end": "1863240"
  },
  {
    "text": "space the problem the problem of course is that you don't have to so the only thing uh",
    "start": "1863240",
    "end": "1870840"
  },
  {
    "start": "1868000",
    "end": "2065000"
  },
  {
    "text": "cor is not supported so like if you want to get rid of um smm protection you just",
    "start": "1870840",
    "end": "1877760"
  },
  {
    "text": "install cor booot and use a super Shell Code or which does nothing any",
    "start": "1877760",
    "end": "1885200"
  },
  {
    "text": "question yeah to prevent the operating system from",
    "start": "1885200",
    "end": "1890240"
  },
  {
    "text": "deing all as because they don't have sufficient privileges it has to be like",
    "start": "1890240",
    "end": "1895399"
  },
  {
    "text": "super super early well I can see that for the mode",
    "start": "1895399",
    "end": "1900840"
  },
  {
    "text": "but as far as writing the MSR and changing that oh",
    "start": "1900840",
    "end": "1906440"
  },
  {
    "text": "yeah uh writing to MSR yeah definitely um so like what's your",
    "start": "1906440",
    "end": "1912440"
  },
  {
    "text": "question like if I remove it can they put it back well iess I guess the question is why would you expect",
    "start": "1912440",
    "end": "1918639"
  },
  {
    "text": "they are operating system people to turn around and for instance if they're not",
    "start": "1918639",
    "end": "1926200"
  },
  {
    "text": "already MSR and C you know in",
    "start": "1926200",
    "end": "1931720"
  },
  {
    "text": "this okay I shouldn't have skipped uh the definition of a bootkit basically a",
    "start": "1935639",
    "end": "1940679"
  },
  {
    "text": "bootkit is all right let's step let's step back",
    "start": "1940679",
    "end": "1946760"
  },
  {
    "text": "um let's assume get execution on the bias magically will explain how and I'm",
    "start": "1946760",
    "end": "1952360"
  },
  {
    "text": "fing a bootkit from the internet all boot kits work the same way the ick",
    "start": "1952360",
    "end": "1957639"
  },
  {
    "text": "Interruption 13 which is the one which is used for every dis access all right",
    "start": "1957639",
    "end": "1962840"
  },
  {
    "text": "uh remember that when when you boot a computer you have no such thing as a lipy or a kernel the only API so to",
    "start": "1962840",
    "end": "1970120"
  },
  {
    "text": "speak is the interrupt Vector table so if you hook Interruption 13 you're hooking",
    "start": "1970120",
    "end": "1976120"
  },
  {
    "text": "systemwide uh access to the the disc and some somehow the the master Bard record",
    "start": "1976120",
    "end": "1981480"
  },
  {
    "text": "which is loaded at you know um 7 c00 in memory by Interruption 19 when you're",
    "start": "1981480",
    "end": "1988159"
  },
  {
    "text": "trying to boot um is going to use some o uh I mean",
    "start": "1988159",
    "end": "1993480"
  },
  {
    "text": "the the the master B record is going to try it its w point is basically to try",
    "start": "1993480",
    "end": "1998559"
  },
  {
    "text": "to take a Kel from the dis and unpack it in memory right to do this it has to",
    "start": "1998559",
    "end": "2006399"
  },
  {
    "text": "access a dis so if I'm if I'm owning Interruption 13 I can make sure that",
    "start": "2006399",
    "end": "2012159"
  },
  {
    "text": "during the unpacking uh I can hook the reading from the from the sector is",
    "start": "2012159",
    "end": "2018399"
  },
  {
    "text": "going to read the is going to read the Kel from right so the idea that the whole point",
    "start": "2018399",
    "end": "2026720"
  },
  {
    "text": "of the bootkit is to let the cnel be unpacked in memory and get execution",
    "start": "2026720",
    "end": "2032000"
  },
  {
    "text": "after and Patch the cnel on a fly so if you're asking me like um um can the",
    "start": "2032000",
    "end": "2038720"
  },
  {
    "text": "operating system and can the colel do it yeah what I'm going to do basically patch the colel to inject those uh shell",
    "start": "2038720",
    "end": "2045919"
  },
  {
    "text": "code into it so even if the colel previously set it up um um the MSR",
    "start": "2045919",
    "end": "2052240"
  },
  {
    "text": "correctly and stuff I can UND do it right make sense yeah the good question",
    "start": "2052240",
    "end": "2058919"
  },
  {
    "text": "thank you any other",
    "start": "2058919",
    "end": "2063118"
  },
  {
    "text": "question all right so so if we put all those um things",
    "start": "2065440",
    "end": "2070839"
  },
  {
    "text": "together we end up with a a permanent lowering of the the",
    "start": "2070839",
    "end": "2076800"
  },
  {
    "text": "security level of any operating system in particular if you remove the CPU updates like it's going to be system",
    "start": "2076800",
    "end": "2084440"
  },
  {
    "text": "independent um if you remove NX you get back to 97 because it's when like NX was",
    "start": "2084440",
    "end": "2090599"
  },
  {
    "text": "first introduced and I mean it's a game changer in terms of security right right here you can exploit on a a CPU which",
    "start": "2090599",
    "end": "2097359"
  },
  {
    "text": "does support NX or doesn't is a game changer U there is one",
    "start": "2097359",
    "end": "2103760"
  },
  {
    "text": "trick there are two tricks actually even if your CPU does not support NX you can still have non-exec",
    "start": "2103760",
    "end": "2111000"
  },
  {
    "text": "non-executable PES um it can be emulated in software um stuff like packs for",
    "start": "2111000",
    "end": "2118400"
  },
  {
    "text": "instance protection against execution and um so this has to do with",
    "start": "2118400",
    "end": "2123960"
  },
  {
    "text": "segmentation and it's a lot trickier um the idea is that",
    "start": "2123960",
    "end": "2129640"
  },
  {
    "text": "when you create an operating system at some stage you will have to switch from real mode which is 16bit only and like",
    "start": "2130200",
    "end": "2138480"
  },
  {
    "text": "um non multitask to 32 bit or 64bit to do that you need to define a set of",
    "start": "2138480",
    "end": "2145040"
  },
  {
    "text": "structures like uh the global descripted table which contain the definition of",
    "start": "2145040",
    "end": "2150480"
  },
  {
    "text": "each segment assuming you're using segmentation um so if you're using",
    "start": "2150480",
    "end": "2156760"
  },
  {
    "text": "segmentation um you're defining ranges of memory which have certain",
    "start": "2156760",
    "end": "2162599"
  },
  {
    "text": "properties um so being executable being writeable being readable and you could",
    "start": "2162599",
    "end": "2168119"
  },
  {
    "text": "actually um um change the you could use the",
    "start": "2168119",
    "end": "2174520"
  },
  {
    "text": "lgdt um uh instruction to find the um",
    "start": "2174520",
    "end": "2180560"
  },
  {
    "text": "location of the gdt then find the location of the segments and Patch the permissions but it's not such a good",
    "start": "2180560",
    "end": "2187200"
  },
  {
    "text": "idea because the same bits have different meanings if you set um a code",
    "start": "2187200",
    "end": "2193599"
  },
  {
    "text": "segment uh it's never writeable and if you set a data segment it's never supposed to be executable because the",
    "start": "2193599",
    "end": "2200640"
  },
  {
    "text": "bit are read and read and writeable are the same bit so if you",
    "start": "2200640",
    "end": "2206440"
  },
  {
    "text": "flip it it's not going to work too well if you're using uh",
    "start": "2206440",
    "end": "2211760"
  },
  {
    "text": "um pae physical extensions uh on 32 bits",
    "start": "2211760",
    "end": "2216800"
  },
  {
    "text": "it's even worse um and if you're using Pages um I mean",
    "start": "2216800",
    "end": "2222359"
  },
  {
    "text": "it's it's going to be a bit of a problem because basically you Cann not know the location of the pages you'd",
    "start": "2222359",
    "end": "2229079"
  },
  {
    "text": "like to change permission from unless you know the exact location in memory in in Virtual in um sorry virtual memory um",
    "start": "2229079",
    "end": "2237520"
  },
  {
    "text": "you can query the mmu and find back like what to patch in in physical memory but",
    "start": "2237520",
    "end": "2243240"
  },
  {
    "text": "uh uh brid forcing every page is not doable given the size of the architecture",
    "start": "2243240",
    "end": "2249520"
  },
  {
    "text": "was that very clear okay so the idea that if we put",
    "start": "2250800",
    "end": "2257280"
  },
  {
    "text": "all these features um even if you change your hard drive or remove the operating system you still very much going to be",
    "start": "2257280",
    "end": "2263760"
  },
  {
    "text": "owned and we don't even need like any other boot kit with the malicious payload um any any vulnerability to",
    "start": "2263760",
    "end": "2271880"
  },
  {
    "text": "come you you're just going to be like Bank vulnerable if you don't have aslr if you don't have NX",
    "start": "2271880",
    "end": "2278160"
  },
  {
    "text": "uh and if you don't have smm protection I mean it's it's Christmas",
    "start": "2278160",
    "end": "2283520"
  },
  {
    "text": "time uh it's good question I skip that",
    "start": "2285599",
    "end": "2290680"
  },
  {
    "start": "2290000",
    "end": "2377000"
  },
  {
    "text": "one I forgot the I forgot that one uh I",
    "start": "2291680",
    "end": "2297280"
  },
  {
    "text": "suggest you read the white paper uh you'll be the one um basically for Windows it's been",
    "start": "2297280",
    "end": "2304880"
  },
  {
    "text": "identified by Kumar and Kumar with the the for randomization is located if you patch it with a St static value um the",
    "start": "2304880",
    "end": "2312640"
  },
  {
    "text": "mapping is going to be repeatable if you think about it for any operating system um the seed for randomization cannot",
    "start": "2312640",
    "end": "2319720"
  },
  {
    "text": "come from us land it has to come from can land so if you patch the definition",
    "start": "2319720",
    "end": "2325079"
  },
  {
    "text": "of this seed um to be a static value the mapping is going to be always the same thing",
    "start": "2325079",
    "end": "2332960"
  },
  {
    "text": "yeah some people are paying attention thank you",
    "start": "2333359",
    "end": "2338520"
  },
  {
    "text": "okay the remote P thing we'll do some demos don't worry it's",
    "start": "2338520",
    "end": "2344200"
  },
  {
    "text": "coming so the idea that um you know even if today um con boot is capable of boot",
    "start": "2344200",
    "end": "2350720"
  },
  {
    "text": "kitting say Windows 7 on 64bit or 32bit or whatever uh Windows 8 is going to be",
    "start": "2350720",
    "end": "2356480"
  },
  {
    "text": "coming we don't have the final release and we still like to be able to own it like if I take the paint to back door",
    "start": "2356480",
    "end": "2362880"
  },
  {
    "text": "your computer today I want to own you for the 3 years to come or something",
    "start": "2362880",
    "end": "2368839"
  },
  {
    "text": "so we definitely need a way to update remove or reflash the",
    "start": "2368839",
    "end": "2374880"
  },
  {
    "text": "firmwares which is going to be a lot trickier than",
    "start": "2376960",
    "end": "2381640"
  },
  {
    "text": "expected so if we if we fetch if we only infect PCI firmwares and fetch the",
    "start": "2382960",
    "end": "2390079"
  },
  {
    "text": "malicious code from the internet every time we effectively don't put don't",
    "start": "2390079",
    "end": "2395359"
  },
  {
    "text": "leave any trace on the F system um the code we're going to put on the",
    "start": "2395359",
    "end": "2401319"
  },
  {
    "text": "motherboard is not actually a style per se it's just like a slightly modified version of of",
    "start": "2401319",
    "end": "2407839"
  },
  {
    "text": "coreboot um the file which is actually modified is a configuration file for",
    "start": "2407839",
    "end": "2413520"
  },
  {
    "text": "ipxe which tells it all right you're going to do um um an extension of a pxe",
    "start": "2413520",
    "end": "2419680"
  },
  {
    "text": "boot so boot from the internet and the only parameter which is",
    "start": "2419680",
    "end": "2425240"
  },
  {
    "text": "changing is basically like the UR L you're going to boot from so like to skip the to skip the magic uh we",
    "start": "2425240",
    "end": "2432200"
  },
  {
    "text": "actually going to boot an operating system from the internet over https and if possible over Wi-Fi and",
    "start": "2432200",
    "end": "2440040"
  },
  {
    "text": "there again if there is no Wi-fi we default to ethernet um I mean DHCP and if DHCP is not there we can try a bunch",
    "start": "2440040",
    "end": "2447760"
  },
  {
    "text": "of static",
    "start": "2447760",
    "end": "2450319"
  },
  {
    "text": "IPS okay I'll get back to the true problem",
    "start": "2453079",
    "end": "2458760"
  },
  {
    "start": "2462000",
    "end": "2598000"
  },
  {
    "text": "okay so in terms of of portability I think that using open source software to",
    "start": "2463440",
    "end": "2468880"
  },
  {
    "text": "write a back door is actually a super cool idea um I mean if I had to myself",
    "start": "2468880",
    "end": "2474760"
  },
  {
    "text": "Port stuff for 230 motherboards I mean a bias which is accepted by 230 mother",
    "start": "2474760",
    "end": "2481359"
  },
  {
    "text": "boards a lifetime would not be enough so benefiting from the work of people who",
    "start": "2481359",
    "end": "2486400"
  },
  {
    "text": "did like all the gory work of doing the hardware reverse engineering to get the",
    "start": "2486400",
    "end": "2491520"
  },
  {
    "text": "P the portability down um is just is just massive um",
    "start": "2491520",
    "end": "2499280"
  },
  {
    "text": "help the modularity of cor boot is also awesome you can put PCI firmwares so a a",
    "start": "2499280",
    "end": "2505359"
  },
  {
    "text": "firmware controlling a you can embed it directly inside the bias which is not supposed to be I mean",
    "start": "2505359",
    "end": "2512920"
  },
  {
    "text": "like you give it like drivers for your network car drivers for your CD ROM you make a single firmware out of it you put",
    "start": "2512920",
    "end": "2520280"
  },
  {
    "text": "it in your bias and the bias is able to control everything um without without",
    "start": "2520280",
    "end": "2525880"
  },
  {
    "text": "even requiring the help of the original firmware which is located on the motherboard so this modularity is very",
    "start": "2525880",
    "end": "2534280"
  },
  {
    "text": "precious and uh I I explained that in terms of NE stack the fact of using ipx",
    "start": "2534280",
    "end": "2539720"
  },
  {
    "text": "is a massive help because you don't have to record yourself say",
    "start": "2539720",
    "end": "2545160"
  },
  {
    "text": "um um an IP stack in real mode or in protected mode so strictly speaking the bias doesn't have",
    "start": "2545160",
    "end": "2551599"
  },
  {
    "text": "to execute only in real mode it can switch to protected mod it can switch to",
    "start": "2551599",
    "end": "2556640"
  },
  {
    "text": "protected mode provided it gets back to real mode when it it get it gives back execution to the master B record and",
    "start": "2556640",
    "end": "2563720"
  },
  {
    "text": "this is what this is actually the trick that both Coro and ipxe are using because it's a lot easier you have",
    "start": "2563720",
    "end": "2570040"
  },
  {
    "text": "proper multitasking I mean if you want to do a network stack think about it if you need a notion of timing uh",
    "start": "2570040",
    "end": "2578119"
  },
  {
    "text": "without um um multitasking is basically",
    "start": "2578119",
    "end": "2583559"
  },
  {
    "text": "possible you're going to wait for packets forever or or or timeout or",
    "start": "2583559",
    "end": "2588599"
  },
  {
    "text": "whatever implementing a timeout is just not possible with multitasking I guess unless you do something like waiting for",
    "start": "2588599",
    "end": "2595119"
  },
  {
    "text": "physical interrupts which is going to be super ugly and not reliable all right thank you for staying",
    "start": "2595119",
    "end": "2601640"
  },
  {
    "start": "2598000",
    "end": "3039000"
  },
  {
    "text": "until now we're going to do the magic demo of death",
    "start": "2601640",
    "end": "2608000"
  },
  {
    "text": "um so that should be pretty interesting and show you how everything",
    "start": "2608000",
    "end": "2613760"
  },
  {
    "text": "works so let me check that I actually do have internet",
    "start": "2616559",
    "end": "2622040"
  },
  {
    "text": "connection oh sorry Andrew I I meant microsof",
    "start": "2630160",
    "end": "2635720"
  },
  {
    "text": "all right seems like it works uh let me check if there is no like authentication",
    "start": "2637800",
    "end": "2644119"
  },
  {
    "text": "with the um over HTTP for yeah no it's cool okay we have",
    "start": "2644119",
    "end": "2650520"
  },
  {
    "text": "access to the internet so I'm going to kill this",
    "start": "2650520",
    "end": "2654799"
  },
  {
    "text": "stuff I'm going to start a network sniffer to show you like what's really happening inside cuz it's going to go",
    "start": "2658440",
    "end": "2663880"
  },
  {
    "text": "pretty fast",
    "start": "2663880",
    "end": "2667200"
  },
  {
    "text": "dear God all",
    "start": "2669520",
    "end": "2675400"
  },
  {
    "text": "right so I'm going to sniff on any interface only HTTP is going to be",
    "start": "2678559",
    "end": "2683640"
  },
  {
    "text": "really useful to",
    "start": "2683640",
    "end": "2686480"
  },
  {
    "text": "us uh okay the comment I'm going to be",
    "start": "2689960",
    "end": "2695280"
  },
  {
    "text": "using so like I could I I could show you on a proper motherboard but um it wouldn't be too visual we could not",
    "start": "2695280",
    "end": "2701480"
  },
  {
    "text": "sniff packet Etc so we're going to use um we're going to use one of the",
    "start": "2701480",
    "end": "2707200"
  },
  {
    "text": "motherboards which is a virtual one uh which is supported by kobot and it's KVM",
    "start": "2707200",
    "end": "2712559"
  },
  {
    "text": "which is basically an extension of qmu to benefit of a candle um candle speed",
    "start": "2712559",
    "end": "2721680"
  },
  {
    "text": "so the thing is like this uh we're going to just boot another bias instead of the",
    "start": "2721680",
    "end": "2727559"
  },
  {
    "text": "normal KVM one which is a rassa bin okay we start in full screen we need Network",
    "start": "2727559",
    "end": "2733760"
  },
  {
    "text": "and the real disc we actually boain is uh Windows",
    "start": "2733760",
    "end": "2738760"
  },
  {
    "text": "7 all",
    "start": "2741359",
    "end": "2744640"
  },
  {
    "text": "right can I ask someone innocent to come and uh type my admin",
    "start": "2753599",
    "end": "2759319"
  },
  {
    "text": "password Andrew do you know my admin password",
    "start": "2759319",
    "end": "2764720"
  },
  {
    "text": "2C how do you know",
    "start": "2764720",
    "end": "2771040"
  },
  {
    "text": "friend oh come",
    "start": "2772520",
    "end": "2776040"
  },
  {
    "text": "[Music]",
    "start": "2778110",
    "end": "2781169"
  },
  {
    "text": "on okay can you please come over and type a password for me for the administrator administrator",
    "start": "2785760",
    "end": "2792720"
  },
  {
    "text": "account what the password what's the password well that the will point",
    "start": "2792720",
    "end": "2798800"
  },
  {
    "text": "right no no take the me one which is like I mean are you privileges oh you",
    "start": "2807400",
    "end": "2813000"
  },
  {
    "text": "want that one all right",
    "start": "2813000",
    "end": "2816839"
  },
  {
    "text": "dude you guessed it awesome",
    "start": "2820400",
    "end": "2825920"
  },
  {
    "text": "awesome can you redo it like can you exit and log at a proper system",
    "start": "2825920",
    "end": "2832400"
  },
  {
    "text": "administrator well you removed my msdn license mate so like",
    "start": "2840880",
    "end": "2847280"
  },
  {
    "text": "okay so it works too thank you for that no",
    "start": "2856319",
    "end": "2861359"
  },
  {
    "text": "problem wait until we look at the packets come on all",
    "start": "2864480",
    "end": "2871599"
  },
  {
    "text": "right mhm",
    "start": "2872880",
    "end": "2876880"
  },
  {
    "text": "okay so I'm just going to kill it um so let's look at what really happened in terms",
    "start": "2879040",
    "end": "2885160"
  },
  {
    "text": "of HTTP connections so first",
    "start": "2885160",
    "end": "2890559"
  },
  {
    "text": "off the BIOS itself uh tried to connect I'm going to show you the configuration",
    "start": "2890559",
    "end": "2895640"
  },
  {
    "text": "file later on to correlate this data but like the bias itself tried to uh fetch a",
    "start": "2895640",
    "end": "2901920"
  },
  {
    "text": "page which is called like ads blah blah blah it's a gpeg but it's actually uh",
    "start": "2901920",
    "end": "2907200"
  },
  {
    "text": "sending a bunch of dodgy parameters like an IP address a Mac and a Gateway which",
    "start": "2907200",
    "end": "2912839"
  },
  {
    "text": "is a bit like suspicious uh normally this would go over https and there again over Wi-Fi so in terms of forensic",
    "start": "2912839",
    "end": "2919800"
  },
  {
    "text": "analysis from a network perspective forget it and this um there it's so it's",
    "start": "2919800",
    "end": "2927200"
  },
  {
    "text": "actually not an image it's another ipxe configuration file so the main configuration file which is embedded in",
    "start": "2927200",
    "end": "2933599"
  },
  {
    "text": "the firmware in the bias um is fetching another one from the internet because",
    "start": "2933599",
    "end": "2938640"
  },
  {
    "text": "it's much easier to maintain um so it's telling M blah blah",
    "start": "2938640",
    "end": "2945240"
  },
  {
    "text": "so all this stuff is comenting it's telling him all right you're going to you're going to fetch a Kel on an ND",
    "start": "2945240",
    "end": "2951880"
  },
  {
    "text": "much like Linux ready from PMC which is a a website which is very much",
    "start": "2951880",
    "end": "2959960"
  },
  {
    "text": "online Okay so let's go back to HTT P this",
    "start": "2964119",
    "end": "2970799"
  },
  {
    "text": "is the stuffing question all right so it actually did",
    "start": "2970799",
    "end": "2976400"
  },
  {
    "text": "fetch the Stu from pmc.org uh here it's a m dis so it's like you have two parts",
    "start": "2976400",
    "end": "2983480"
  },
  {
    "text": "one is like a colel and the other one is the other one is like the payload itself",
    "start": "2983480",
    "end": "2989359"
  },
  {
    "text": "so this is this is a conel which is REM disc like just slightly modified um to",
    "start": "2989359",
    "end": "2995559"
  },
  {
    "text": "boot the boot kit",
    "start": "2995559",
    "end": "2998960"
  },
  {
    "text": "itself and the boot kit the proper boot kit is actually here",
    "start": "3001200",
    "end": "3007520"
  },
  {
    "text": "right okay I'm going to show you the configuration file and we're going to trick it a bit I won't have time to show",
    "start": "3008280",
    "end": "3013720"
  },
  {
    "text": "you like even half of what I had prepared but it doesn't",
    "start": "3013720",
    "end": "3020079"
  },
  {
    "text": "matter uh",
    "start": "3022079",
    "end": "3026079"
  },
  {
    "text": "so let's look at this dodgy thing called uh love doy Peg which is very much the",
    "start": "3027960",
    "end": "3033480"
  },
  {
    "text": "configuration file right it all makes",
    "start": "3033480",
    "end": "3039200"
  },
  {
    "start": "3039000",
    "end": "3113000"
  },
  {
    "text": "sense just a bit of um I mean we we're going to we we have to talk a bit of",
    "start": "3039200",
    "end": "3044680"
  },
  {
    "text": "mitigations uh before I let you go so I told you before that TPM is a",
    "start": "3044680",
    "end": "3050440"
  },
  {
    "text": "passive ship which mean that if you have a boot kit and you",
    "start": "3050440",
    "end": "3055880"
  },
  {
    "text": "attacking hard drive which is fully encrypted and stuff if you don't want the data you don't have to use a",
    "start": "3055880",
    "end": "3062480"
  },
  {
    "text": "TPM and it's not working say like game consoles where the cryptographic ship",
    "start": "3062480",
    "end": "3068640"
  },
  {
    "text": "embedding the cryptographic keys is actually active and if you don't use it the stuff just doesn't",
    "start": "3068640",
    "end": "3074520"
  },
  {
    "text": "boot so this is a bit of a problem the main problem really when it",
    "start": "3074520",
    "end": "3079720"
  },
  {
    "text": "comes to uh supply chain Bing is that when someone delivers you a new",
    "start": "3079720",
    "end": "3086000"
  },
  {
    "text": "laptop he has not encrypted it for you which would be also a problem I mean",
    "start": "3086000",
    "end": "3092400"
  },
  {
    "text": "if they did like they would know your password obviously so like the thing is they give you a laptop which is not",
    "start": "3092400",
    "end": "3097520"
  },
  {
    "text": "encrypted which means that TPM is actually not sealed which means that TPM is actually not used so TPM is not made",
    "start": "3097520",
    "end": "3105760"
  },
  {
    "text": "to um prevent this kind of",
    "start": "3105760",
    "end": "3110680"
  },
  {
    "start": "3113000",
    "end": "3130000"
  },
  {
    "text": "attacks all about antiviruses I very much think that antiviruses",
    "start": "3113960",
    "end": "3119280"
  },
  {
    "text": "especially on servers yeah is a bit like putting lipstick I know that many of you actually work for antiviruses so I",
    "start": "3119280",
    "end": "3126359"
  },
  {
    "text": "wanted to show you some love all right this is the default cono",
    "start": "3126359",
    "end": "3133760"
  },
  {
    "start": "3130000",
    "end": "3169000"
  },
  {
    "text": "uh floppy which is 3 years old and I submitted it to V virus tootal there",
    "start": "3133760",
    "end": "3139160"
  },
  {
    "text": "again this is the only piece of active malware the stuff we fetching over https",
    "start": "3139160",
    "end": "3145240"
  },
  {
    "text": "and Wi-Fi every time when we boot uh so detection ratio is 2 over",
    "start": "3145240",
    "end": "3152000"
  },
  {
    "text": "43 and if if we pack it with lzma which is like the standard Packer for the",
    "start": "3152000",
    "end": "3158480"
  },
  {
    "text": "Linux colal for virtually every bias in the universe the detection ratio is of",
    "start": "3158480",
    "end": "3166558"
  },
  {
    "start": "3169000",
    "end": "3187000"
  },
  {
    "text": "zero uh other stuff you could do so like if you get if you own a machine like cuz",
    "start": "3170000",
    "end": "3175119"
  },
  {
    "text": "you got a remote shell um you could definitely Flash the bias you could definitely flash uh PCI",
    "start": "3175119",
    "end": "3183079"
  },
  {
    "text": "firmwares um there are limitations but we don't have time for that another uh attack scenario could be",
    "start": "3183079",
    "end": "3190599"
  },
  {
    "start": "3187000",
    "end": "3200000"
  },
  {
    "text": "for instance you purchase a new network card on eBay and the stuff has been",
    "start": "3190599",
    "end": "3196079"
  },
  {
    "text": "backed off for you and when you install it you actually get own you can even like back door data",
    "start": "3196079",
    "end": "3203400"
  },
  {
    "text": "centers because you can back door VMware I haven't checked if if it works with ipv can you can you define your own",
    "start": "3203400",
    "end": "3210240"
  },
  {
    "text": "firmware with ipv not sure all right but it works with",
    "start": "3210240",
    "end": "3218000"
  },
  {
    "start": "3217000",
    "end": "3336000"
  },
  {
    "text": "VMware remediation so the main problem is that",
    "start": "3218000",
    "end": "3224079"
  },
  {
    "text": "if someone uh puts a single Rogue PCI firmware on your",
    "start": "3224079",
    "end": "3232880"
  },
  {
    "text": "machine it basically owns you forever how many of you check your PCI firmware",
    "start": "3233200",
    "end": "3239359"
  },
  {
    "text": "before using your first laptop",
    "start": "3239359",
    "end": "3244760"
  },
  {
    "text": " so I very much uh recommend um to actually do it like when when you get",
    "start": "3246440",
    "end": "3253000"
  },
  {
    "text": "a new laptop um to flash all these dodgy uh um firmware you don't understand and",
    "start": "3253000",
    "end": "3259400"
  },
  {
    "text": "you cannot possibly understand because it's all um um propriatary with open",
    "start": "3259400",
    "end": "3264520"
  },
  {
    "text": "source stuff you can actually understand so like cor booot would be a good idea it works on 230 motherboards yep is",
    "start": "3264520",
    "end": "3272760"
  },
  {
    "text": "your exploit kit configurable so that you could have it in exploit mode or in",
    "start": "3272760",
    "end": "3278640"
  },
  {
    "text": "remediation mode there is uh so actually we can disinfected yes um all right if I",
    "start": "3278640",
    "end": "3285440"
  },
  {
    "text": "have one more minute I will I I I will explain that it's actually very interesting um the other point is like",
    "start": "3285440",
    "end": "3291440"
  },
  {
    "text": "after you get an intrusion um I mean usually like the best practice",
    "start": "3291440",
    "end": "3297440"
  },
  {
    "text": "is like Restore for backup do you guys restore your F war from",
    "start": "3297440",
    "end": "3303760"
  },
  {
    "text": "backup and just the cost of doing this because the you cannot trust the colel anymore right so like if if if you got a",
    "start": "3304839",
    "end": "3313359"
  },
  {
    "text": "nutrition like this you would have to actually physically open your box and using a um active fpga flash every",
    "start": "3313359",
    "end": "3321240"
  },
  {
    "text": "single firmware on your board uh including the BIOS and stuff and since people never make backup CS of such",
    "start": "3321240",
    "end": "3327039"
  },
  {
    "text": "things in first place like I recommend to just throw your server away it's",
    "start": "3327039",
    "end": "3332240"
  },
  {
    "text": "going to be a lot cheaper than than doing it actually and get the expertise to do it so remote flashing which was a",
    "start": "3332240",
    "end": "3338200"
  },
  {
    "start": "3336000",
    "end": "3355000"
  },
  {
    "text": "very good uh question can you get rid of I mean can we disinfect rasa or I told",
    "start": "3338200",
    "end": "3345039"
  },
  {
    "text": "you that if I own one PCI firmware which get executed early I can actually flash any other firmware uh including the the",
    "start": "3345039",
    "end": "3353000"
  },
  {
    "text": "main bias um usually there is one problem with that so the idea that you",
    "start": "3353000",
    "end": "3359880"
  },
  {
    "text": "can boot remotely an operating system we've seen this you could you could fetch um a small Linux colel with um a",
    "start": "3359880",
    "end": "3368359"
  },
  {
    "text": "small tool to flash the bias and so like it's a floppy you have a colel a tool to",
    "start": "3368359",
    "end": "3373760"
  },
  {
    "text": "flash a small bash script if you will and the new firmware this would be enough to flly the bias and possibly",
    "start": "3373760",
    "end": "3380720"
  },
  {
    "text": "restore the original one or something which looks a lot like it",
    "start": "3380720",
    "end": "3386960"
  },
  {
    "text": "to flash another PCI device is actually a lot harder in particular we're going to see how to how to flash the uh",
    "start": "3387000",
    "end": "3393440"
  },
  {
    "text": "network card the problem with the network card is that tools to flash the network card are very much vendor",
    "start": "3393440",
    "end": "3400599"
  },
  {
    "text": "dependent so how do we go around this in the network packets we we saw",
    "start": "3400599",
    "end": "3408920"
  },
  {
    "start": "3405000",
    "end": "3468000"
  },
  {
    "text": "that the first stuff I was sending",
    "start": "3408920",
    "end": "3413798"
  },
  {
    "text": "actually contain information such as my Mac address and this is a feature of ipxe if you look it's not out coded it's",
    "start": "3416480",
    "end": "3423960"
  },
  {
    "text": "it's CED like this like you have net IP and Mac equals all right so it's a macro",
    "start": "3423960",
    "end": "3429440"
  },
  {
    "text": "inside ipxe and it's very much fed dynamically yeah I'm coming so if I have",
    "start": "3429440",
    "end": "3434799"
  },
  {
    "text": "the MAC address I know the vendor cuz like I know the wi number and from the wi number I canu a vendor and send back",
    "start": "3434799",
    "end": "3442599"
  },
  {
    "text": "um as a a payload a tool which is targeted to flly exactly this firmware",
    "start": "3442599",
    "end": "3447680"
  },
  {
    "text": "for this vendor it's actually supported by um um",
    "start": "3447680",
    "end": "3453280"
  },
  {
    "text": "ipxe so it's not a dirty trick we don't have time you sure all",
    "start": "3453280",
    "end": "3458680"
  },
  {
    "text": "right thank you for coming",
    "start": "3458680",
    "end": "3462838"
  },
  {
    "text": "[Applause]",
    "start": "3467920",
    "end": "3470549"
  }
]