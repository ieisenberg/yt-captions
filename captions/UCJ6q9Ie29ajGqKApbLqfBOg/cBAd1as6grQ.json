[
  {
    "start": "0",
    "end": "78000"
  },
  {
    "text": "[Music]",
    "start": "1130",
    "end": "13679"
  },
  {
    "text": "hello everyone",
    "start": "13679",
    "end": "14639"
  },
  {
    "text": "my name is joju welcome to my talk it's",
    "start": "14639",
    "end": "17359"
  },
  {
    "text": "called curlsite escape",
    "start": "17359",
    "end": "19119"
  },
  {
    "text": "panimeko has the first sandbox the",
    "start": "19119",
    "end": "21039"
  },
  {
    "text": "unusual way",
    "start": "21039",
    "end": "22720"
  },
  {
    "text": "now first thing first please allow me to",
    "start": "22720",
    "end": "24400"
  },
  {
    "text": "introduce myself",
    "start": "24400",
    "end": "25760"
  },
  {
    "text": "this is my twitter handle called",
    "start": "25760",
    "end": "27199"
  },
  {
    "text": "colorist i work for end security like",
    "start": "27199",
    "end": "29599"
  },
  {
    "text": "the labs now",
    "start": "29599",
    "end": "30640"
  },
  {
    "text": "mostly on product security and",
    "start": "30640",
    "end": "32160"
  },
  {
    "text": "vulnerability research",
    "start": "32160",
    "end": "34160"
  },
  {
    "text": "i've spoken at several conferences i",
    "start": "34160",
    "end": "36719"
  },
  {
    "text": "have won",
    "start": "36719",
    "end": "37760"
  },
  {
    "text": "iphone category at 10th cup 2020 and it",
    "start": "37760",
    "end": "40559"
  },
  {
    "text": "was the first ever public successful",
    "start": "40559",
    "end": "42480"
  },
  {
    "text": "hours challenge",
    "start": "42480",
    "end": "43520"
  },
  {
    "text": "in such competitions after pac has been",
    "start": "43520",
    "end": "46000"
  },
  {
    "text": "introduced",
    "start": "46000",
    "end": "47840"
  },
  {
    "text": "this talk mainly consists of three parts",
    "start": "47840",
    "end": "51039"
  },
  {
    "text": "since it's only 25 minutes long i have",
    "start": "51039",
    "end": "53199"
  },
  {
    "text": "to do things so quickly",
    "start": "53199",
    "end": "55120"
  },
  {
    "text": "most of the talk is about case studies",
    "start": "55120",
    "end": "57199"
  },
  {
    "text": "but hopefully",
    "start": "57199",
    "end": "58239"
  },
  {
    "text": "you can gain more insights on these",
    "start": "58239",
    "end": "59920"
  },
  {
    "text": "special attack surfaces",
    "start": "59920",
    "end": "62320"
  },
  {
    "text": "so let's get it started",
    "start": "62320",
    "end": "65359"
  },
  {
    "text": "here is the definition of cross-site",
    "start": "66000",
    "end": "67680"
  },
  {
    "text": "scripting from wikipedia",
    "start": "67680",
    "end": "70880"
  },
  {
    "text": "so are we going to talk about web",
    "start": "70880",
    "end": "72640"
  },
  {
    "text": "security today",
    "start": "72640",
    "end": "74640"
  },
  {
    "text": "absolutely no",
    "start": "74640",
    "end": "77680"
  },
  {
    "text": "i borrowed the name from crosstalk",
    "start": "77680",
    "end": "79119"
  },
  {
    "start": "78000",
    "end": "78000"
  },
  {
    "text": "scripting because they have things in",
    "start": "79119",
    "end": "80799"
  },
  {
    "text": "common",
    "start": "80799",
    "end": "82400"
  },
  {
    "text": "cursor scripting and my attack both want",
    "start": "82400",
    "end": "85360"
  },
  {
    "text": "to",
    "start": "85360",
    "end": "85680"
  },
  {
    "text": "inject javascript to a different context",
    "start": "85680",
    "end": "87920"
  },
  {
    "text": "that is not supposed to be controllable",
    "start": "87920",
    "end": "90240"
  },
  {
    "text": "while crosstalk scripting is targeting",
    "start": "90240",
    "end": "91840"
  },
  {
    "text": "web applications our target is to run",
    "start": "91840",
    "end": "94400"
  },
  {
    "text": "javascript",
    "start": "94400",
    "end": "95280"
  },
  {
    "text": "in a more privileged local process",
    "start": "95280",
    "end": "98240"
  },
  {
    "text": "cross-scripting nuisance",
    "start": "98240",
    "end": "99840"
  },
  {
    "text": "uses various http parameters",
    "start": "99840",
    "end": "104240"
  },
  {
    "text": "while ours uses inter-process",
    "start": "104240",
    "end": "106560"
  },
  {
    "text": "communication",
    "start": "106560",
    "end": "108159"
  },
  {
    "text": "the goal for cross-site scripting is to",
    "start": "108159",
    "end": "110240"
  },
  {
    "text": "bypass same origin policy",
    "start": "110240",
    "end": "112799"
  },
  {
    "text": "where our attack wants to gain native",
    "start": "112799",
    "end": "114720"
  },
  {
    "text": "code execution",
    "start": "114720",
    "end": "116000"
  },
  {
    "text": "and break out of safari sandbox",
    "start": "116000",
    "end": "120079"
  },
  {
    "text": "apart from the web browser safari there",
    "start": "120960",
    "end": "124159"
  },
  {
    "text": "are actually more applications",
    "start": "124159",
    "end": "126479"
  },
  {
    "text": "that supports web content rendering with",
    "start": "126479",
    "end": "128560"
  },
  {
    "text": "webview",
    "start": "128560",
    "end": "131119"
  },
  {
    "text": "there are two kinds of webviews on mac",
    "start": "131280",
    "end": "133680"
  },
  {
    "text": "os",
    "start": "133680",
    "end": "134720"
  },
  {
    "text": "they're both based on webkit wkwebview",
    "start": "134720",
    "end": "138160"
  },
  {
    "text": "is the successor of legacy webview",
    "start": "138160",
    "end": "141120"
  },
  {
    "text": "it has isolated renderer process sandbox",
    "start": "141120",
    "end": "144160"
  },
  {
    "text": "and cheat support",
    "start": "144160",
    "end": "145920"
  },
  {
    "text": "the legacy web wheel is duplicated it",
    "start": "145920",
    "end": "148239"
  },
  {
    "text": "does not support multi-process",
    "start": "148239",
    "end": "150480"
  },
  {
    "text": "no render sandbox no jit",
    "start": "150480",
    "end": "154560"
  },
  {
    "text": "lexi webviews still exist they often",
    "start": "155040",
    "end": "157920"
  },
  {
    "text": "expose",
    "start": "157920",
    "end": "158400"
  },
  {
    "text": "extra functionalities to javascript and",
    "start": "158400",
    "end": "161120"
  },
  {
    "text": "they don't have sandbox",
    "start": "161120",
    "end": "163200"
  },
  {
    "text": "if we manage to inject our js payload to",
    "start": "163200",
    "end": "166480"
  },
  {
    "text": "den",
    "start": "166480",
    "end": "167360"
  },
  {
    "text": "would it be possible to escape browser",
    "start": "167360",
    "end": "169440"
  },
  {
    "text": "sandbox",
    "start": "169440",
    "end": "171040"
  },
  {
    "text": "so let's see this case studies first one",
    "start": "171040",
    "end": "175040"
  },
  {
    "text": "exploiting a ton of checktown of use",
    "start": "175040",
    "end": "177120"
  },
  {
    "text": "with process escape",
    "start": "177120",
    "end": "180400"
  },
  {
    "start": "180000",
    "end": "180000"
  },
  {
    "text": "there was a sandbox bug in core",
    "start": "181360",
    "end": "183440"
  },
  {
    "text": "foundation before",
    "start": "183440",
    "end": "184720"
  },
  {
    "text": "mac os mojave to reproduce it",
    "start": "184720",
    "end": "188319"
  },
  {
    "text": "first turn off rootless so you can debug",
    "start": "188319",
    "end": "191120"
  },
  {
    "text": "safari renderer",
    "start": "191120",
    "end": "192800"
  },
  {
    "text": "attach ldb to any rendering process",
    "start": "192800",
    "end": "196159"
  },
  {
    "text": "and use this command to read the p list",
    "start": "196159",
    "end": "198879"
  },
  {
    "text": "from a location",
    "start": "198879",
    "end": "200400"
  },
  {
    "text": "where it is not accessible by the",
    "start": "200400",
    "end": "203120"
  },
  {
    "text": "sandbox",
    "start": "203120",
    "end": "205760"
  },
  {
    "text": "they act like there is no sandbox at all",
    "start": "205920",
    "end": "208959"
  },
  {
    "text": "and you can actually read",
    "start": "208959",
    "end": "210480"
  },
  {
    "text": "the value from calculator.app",
    "start": "210480",
    "end": "214480"
  },
  {
    "text": "why",
    "start": "214480",
    "end": "216799"
  },
  {
    "text": "the root cause of this bug is by",
    "start": "217760",
    "end": "219680"
  },
  {
    "text": "coincidence",
    "start": "219680",
    "end": "221120"
  },
  {
    "text": "cf preferences api families are based on",
    "start": "221120",
    "end": "223840"
  },
  {
    "text": "xpc",
    "start": "223840",
    "end": "225200"
  },
  {
    "text": "there is a demo daemon process cf",
    "start": "225200",
    "end": "228480"
  },
  {
    "text": "preference",
    "start": "228480",
    "end": "229440"
  },
  {
    "text": "d who is responsible for data",
    "start": "229440",
    "end": "232480"
  },
  {
    "text": "persistence it does have sandbox check",
    "start": "232480",
    "end": "236080"
  },
  {
    "text": "to read and write but implementation is",
    "start": "236080",
    "end": "240000"
  },
  {
    "text": "bugging so look at this code it only",
    "start": "240000",
    "end": "243360"
  },
  {
    "text": "costs",
    "start": "243360",
    "end": "243840"
  },
  {
    "text": "sandbox check once per process",
    "start": "243840",
    "end": "247040"
  },
  {
    "text": "then this result is catched forever",
    "start": "247040",
    "end": "252159"
  },
  {
    "text": "if a process happens to assess",
    "start": "252159",
    "end": "255360"
  },
  {
    "text": "preferences sanderbox before sanderbox",
    "start": "255360",
    "end": "258239"
  },
  {
    "text": "lockdown",
    "start": "258239",
    "end": "259759"
  },
  {
    "text": "cf preference d still syncs its own",
    "start": "259759",
    "end": "263520"
  },
  {
    "text": "sandbox and allowed all the read and",
    "start": "263520",
    "end": "267199"
  },
  {
    "text": "writes",
    "start": "267199",
    "end": "269840"
  },
  {
    "start": "270000",
    "end": "270000"
  },
  {
    "text": "unfortunately there is a time window",
    "start": "270639",
    "end": "272960"
  },
  {
    "text": "that web content",
    "start": "272960",
    "end": "274080"
  },
  {
    "text": "is not sandbox at all it should have",
    "start": "274080",
    "end": "276720"
  },
  {
    "text": "been",
    "start": "276720",
    "end": "277120"
  },
  {
    "text": "safe because webkit won't load any",
    "start": "277120",
    "end": "279600"
  },
  {
    "text": "untrusted content during this time",
    "start": "279600",
    "end": "282400"
  },
  {
    "text": "but just at this stage time there is a",
    "start": "282400",
    "end": "285040"
  },
  {
    "text": "framework called app kit",
    "start": "285040",
    "end": "287280"
  },
  {
    "text": "that happens to assess preferences in",
    "start": "287280",
    "end": "290160"
  },
  {
    "text": "this time window",
    "start": "290160",
    "end": "291919"
  },
  {
    "text": "so the renderer is marked on sandbox",
    "start": "291919",
    "end": "295280"
  },
  {
    "text": "by cf preference d",
    "start": "295280",
    "end": "298800"
  },
  {
    "start": "300000",
    "end": "300000"
  },
  {
    "text": "the timeline is like this first part",
    "start": "300400",
    "end": "303840"
  },
  {
    "text": "initialization web content is a normal",
    "start": "303840",
    "end": "306880"
  },
  {
    "text": "process",
    "start": "306880",
    "end": "308000"
  },
  {
    "text": "and it reads preferences",
    "start": "308000",
    "end": "311840"
  },
  {
    "text": "then cf preference d check the sandbox",
    "start": "312400",
    "end": "315280"
  },
  {
    "text": "states",
    "start": "315280",
    "end": "316400"
  },
  {
    "text": "and mark it as not sam the box",
    "start": "316400",
    "end": "320479"
  },
  {
    "text": "now we enter the sandbox lockdown with",
    "start": "320479",
    "end": "322720"
  },
  {
    "text": "sandbox init with parameters",
    "start": "322720",
    "end": "326720"
  },
  {
    "text": "now try to read and write preferences",
    "start": "327840",
    "end": "330240"
  },
  {
    "text": "again",
    "start": "330240",
    "end": "332560"
  },
  {
    "text": "no problem that's a big problem",
    "start": "332720",
    "end": "338000"
  },
  {
    "text": "okay now where is our cross-site script",
    "start": "338000",
    "end": "342960"
  },
  {
    "text": "let's meet dashboard a legacy mac os",
    "start": "344160",
    "end": "346720"
  },
  {
    "text": "feature that has been removed on",
    "start": "346720",
    "end": "348240"
  },
  {
    "text": "catalina",
    "start": "348240",
    "end": "349680"
  },
  {
    "text": "it was an application for apple smac os",
    "start": "349680",
    "end": "352240"
  },
  {
    "text": "operating systems",
    "start": "352240",
    "end": "353360"
  },
  {
    "text": "uses a secondary desktop for hosting",
    "start": "353360",
    "end": "355840"
  },
  {
    "text": "many applications",
    "start": "355840",
    "end": "357199"
  },
  {
    "text": "known as widgets",
    "start": "357199",
    "end": "360400"
  },
  {
    "start": "360000",
    "end": "360000"
  },
  {
    "text": "widgets are written in html and",
    "start": "360639",
    "end": "362479"
  },
  {
    "text": "javascript and they are presented in the",
    "start": "362479",
    "end": "364479"
  },
  {
    "text": "web",
    "start": "364479",
    "end": "364800"
  },
  {
    "text": "views of dashboard yeah that's where",
    "start": "364800",
    "end": "367759"
  },
  {
    "text": "we're gonna",
    "start": "367759",
    "end": "368639"
  },
  {
    "text": "inject malicious script too everywhere",
    "start": "368639",
    "end": "371680"
  },
  {
    "text": "just has a manifest file in playlist",
    "start": "371680",
    "end": "373840"
  },
  {
    "text": "format",
    "start": "373840",
    "end": "374880"
  },
  {
    "text": "here are some of its keys main html is",
    "start": "374880",
    "end": "378000"
  },
  {
    "text": "the file name of",
    "start": "378000",
    "end": "379440"
  },
  {
    "text": "main user interface if this allowed",
    "start": "379440",
    "end": "382720"
  },
  {
    "text": "network",
    "start": "382720",
    "end": "383520"
  },
  {
    "text": "access is set as true the widget can",
    "start": "383520",
    "end": "386319"
  },
  {
    "text": "send http requests",
    "start": "386319",
    "end": "387919"
  },
  {
    "text": "in jacks there is a key named allow",
    "start": "387919",
    "end": "391600"
  },
  {
    "text": "system",
    "start": "391600",
    "end": "392880"
  },
  {
    "text": "if enabled the javascript of the widget",
    "start": "392880",
    "end": "395680"
  },
  {
    "text": "can call dashboard.system function",
    "start": "395680",
    "end": "398160"
  },
  {
    "text": "to execute shell commands",
    "start": "398160",
    "end": "401440"
  },
  {
    "text": "that's pretty scary",
    "start": "401440",
    "end": "405280"
  },
  {
    "start": "405000",
    "end": "405000"
  },
  {
    "text": "the web content sandbox allows reading",
    "start": "405520",
    "end": "407840"
  },
  {
    "text": "files to a temporary directory",
    "start": "407840",
    "end": "410240"
  },
  {
    "text": "that's where we're gonna release the",
    "start": "410240",
    "end": "412639"
  },
  {
    "text": "html and javascript",
    "start": "412639",
    "end": "414080"
  },
  {
    "text": "payloads we can we can extract",
    "start": "414080",
    "end": "418080"
  },
  {
    "text": "a widget bundle here",
    "start": "418080",
    "end": "421520"
  },
  {
    "text": "now remember we have to write two p list",
    "start": "421520",
    "end": "424160"
  },
  {
    "text": "files",
    "start": "424160",
    "end": "424960"
  },
  {
    "text": "one is for our all we just manifest",
    "start": "424960",
    "end": "428080"
  },
  {
    "text": "another one is to install our widget",
    "start": "428080",
    "end": "430800"
  },
  {
    "text": "bundle",
    "start": "430800",
    "end": "431919"
  },
  {
    "text": "to com.apple.dashboard where we can",
    "start": "431919",
    "end": "434800"
  },
  {
    "text": "supply the",
    "start": "434800",
    "end": "435599"
  },
  {
    "text": "absolute path to our bundle in our",
    "start": "435599",
    "end": "438400"
  },
  {
    "text": "temporary path",
    "start": "438400",
    "end": "441199"
  },
  {
    "text": "that's it cross-site script to dashboard",
    "start": "442400",
    "end": "445360"
  },
  {
    "text": "webview",
    "start": "445360",
    "end": "446560"
  },
  {
    "text": "through an ipc bug",
    "start": "446560",
    "end": "451759"
  },
  {
    "start": "450000",
    "end": "450000"
  },
  {
    "text": "now we have inject injected scripts to",
    "start": "451759",
    "end": "454639"
  },
  {
    "text": "dashboard",
    "start": "454639",
    "end": "455680"
  },
  {
    "text": "there is no need to re-exploit the",
    "start": "455680",
    "end": "458400"
  },
  {
    "text": "renderer twice",
    "start": "458400",
    "end": "460240"
  },
  {
    "text": "remember remember the allow system key",
    "start": "460240",
    "end": "463440"
  },
  {
    "text": "just enable it and window.dashboard",
    "start": "463440",
    "end": "465759"
  },
  {
    "text": "assistant is available for us to execute",
    "start": "465759",
    "end": "468160"
  },
  {
    "text": "shell commands no sandboxes time of",
    "start": "468160",
    "end": "470960"
  },
  {
    "text": "course",
    "start": "470960",
    "end": "473280"
  },
  {
    "start": "474000",
    "end": "474000"
  },
  {
    "text": "but there are still two problems what if",
    "start": "475120",
    "end": "478080"
  },
  {
    "text": "dashboard is disabled",
    "start": "478080",
    "end": "479919"
  },
  {
    "text": "and how do we switch to dashboard",
    "start": "479919",
    "end": "481680"
  },
  {
    "text": "desktop to activate the script",
    "start": "481680",
    "end": "485520"
  },
  {
    "start": "485000",
    "end": "485000"
  },
  {
    "text": "further investigation shows that web",
    "start": "486319",
    "end": "488479"
  },
  {
    "text": "content is allowed to talk to",
    "start": "488479",
    "end": "491599"
  },
  {
    "text": "server doc has been attracted",
    "start": "491599",
    "end": "495039"
  },
  {
    "text": "at least twice at pong21 but i guess my",
    "start": "495039",
    "end": "497520"
  },
  {
    "text": "exploit",
    "start": "497520",
    "end": "498319"
  },
  {
    "text": "is more interesting now look at this",
    "start": "498319",
    "end": "500720"
  },
  {
    "text": "dock related apis",
    "start": "500720",
    "end": "506000"
  },
  {
    "text": "there is a preferences pane",
    "start": "506000",
    "end": "509280"
  },
  {
    "text": "for turning dashboard on and off to my",
    "start": "509280",
    "end": "512560"
  },
  {
    "text": "surprise",
    "start": "512560",
    "end": "514080"
  },
  {
    "text": "it's so if you want to use dashboard you",
    "start": "514080",
    "end": "517360"
  },
  {
    "text": "have to",
    "start": "517360",
    "end": "517919"
  },
  {
    "text": "set it to a space or",
    "start": "517919",
    "end": "521039"
  },
  {
    "text": "as overlay but to my surprise it's",
    "start": "521039",
    "end": "524240"
  },
  {
    "text": "possible to change this setting",
    "start": "524240",
    "end": "525920"
  },
  {
    "text": "through the dark mig",
    "start": "525920",
    "end": "530000"
  },
  {
    "text": "core desk core dock set preferences",
    "start": "530800",
    "end": "534399"
  },
  {
    "text": "function can enable it and chrome dock",
    "start": "534399",
    "end": "537279"
  },
  {
    "text": "send notification",
    "start": "537279",
    "end": "538640"
  },
  {
    "text": "can switch to the secondary desktop for",
    "start": "538640",
    "end": "541040"
  },
  {
    "text": "widgets",
    "start": "541040",
    "end": "542320"
  },
  {
    "text": "now all we need is list two line of code",
    "start": "542320",
    "end": "546320"
  },
  {
    "text": "two lines of code",
    "start": "546320",
    "end": "549600"
  },
  {
    "text": "now putting all things together here's",
    "start": "549600",
    "end": "551519"
  },
  {
    "text": "our demo",
    "start": "551519",
    "end": "553839"
  },
  {
    "text": "combining our exploit at pontoon 2017",
    "start": "553839",
    "end": "558000"
  },
  {
    "text": "exploiting the web sql to gain initial",
    "start": "558000",
    "end": "560959"
  },
  {
    "text": "remote code execution",
    "start": "560959",
    "end": "562240"
  },
  {
    "text": "and then use this kind of chat handle",
    "start": "562240",
    "end": "563920"
  },
  {
    "text": "use to finally escape",
    "start": "563920",
    "end": "567519"
  },
  {
    "text": "here comes the third case study how we",
    "start": "570320",
    "end": "572880"
  },
  {
    "text": "will exit cross-site scripting",
    "start": "572880",
    "end": "574839"
  },
  {
    "text": "again",
    "start": "574839",
    "end": "577839"
  },
  {
    "text": "this is basically a copycat of cve",
    "start": "578160",
    "end": "582519"
  },
  {
    "text": "2017-2361",
    "start": "582519",
    "end": "584240"
  },
  {
    "text": "project xero's ex-member lockheed hart",
    "start": "584240",
    "end": "586080"
  },
  {
    "text": "found his client's side crosstalk script",
    "start": "586080",
    "end": "587760"
  },
  {
    "text": "they can jump from safari to a local",
    "start": "587760",
    "end": "589519"
  },
  {
    "text": "application",
    "start": "589519",
    "end": "590480"
  },
  {
    "text": "then run calculator without any memory",
    "start": "590480",
    "end": "592399"
  },
  {
    "text": "corruption this is so",
    "start": "592399",
    "end": "594080"
  },
  {
    "text": "impressive the truth about security is",
    "start": "594080",
    "end": "598399"
  },
  {
    "text": "that",
    "start": "598399",
    "end": "598880"
  },
  {
    "text": "developers never learn from box but we",
    "start": "598880",
    "end": "601680"
  },
  {
    "text": "researchers do",
    "start": "601680",
    "end": "604560"
  },
  {
    "start": "604000",
    "end": "604000"
  },
  {
    "text": "his bug exploited help viewer which is",
    "start": "604560",
    "end": "607040"
  },
  {
    "text": "trusted by safari",
    "start": "607040",
    "end": "608480"
  },
  {
    "text": "safari has a list of hard-coded trusted",
    "start": "608480",
    "end": "610800"
  },
  {
    "text": "url schemes",
    "start": "610800",
    "end": "612399"
  },
  {
    "text": "and redirection to these schemes won't",
    "start": "612399",
    "end": "614480"
  },
  {
    "text": "trigger confirmation",
    "start": "614480",
    "end": "616480"
  },
  {
    "text": "these apps are built in system apps and",
    "start": "616480",
    "end": "618640"
  },
  {
    "text": "some apple internal tools",
    "start": "618640",
    "end": "621200"
  },
  {
    "text": "they must have digital signature by",
    "start": "621200",
    "end": "623519"
  },
  {
    "text": "apple",
    "start": "623519",
    "end": "625839"
  },
  {
    "text": "the one explained by loki heart is help",
    "start": "627200",
    "end": "630240"
  },
  {
    "text": "but what about this x apple help basic",
    "start": "630240",
    "end": "634720"
  },
  {
    "start": "634000",
    "end": "634000"
  },
  {
    "text": "it's another legacy url skin accepted by",
    "start": "634800",
    "end": "637360"
  },
  {
    "text": "hellviewer",
    "start": "637360",
    "end": "638480"
  },
  {
    "text": "it replaces the urls the uil skin x",
    "start": "638480",
    "end": "642320"
  },
  {
    "text": "apple help basic to https",
    "start": "642320",
    "end": "646640"
  },
  {
    "text": "and open the url in a web view only",
    "start": "646640",
    "end": "649680"
  },
  {
    "text": "apple.com is accepted",
    "start": "649680",
    "end": "653200"
  },
  {
    "text": "and in this process in this jump there's",
    "start": "654240",
    "end": "656720"
  },
  {
    "text": "no confirmation at all",
    "start": "656720",
    "end": "658399"
  },
  {
    "text": "this webview is not sandbox and it's",
    "start": "658399",
    "end": "661440"
  },
  {
    "text": "possible to fan",
    "start": "661440",
    "end": "662880"
  },
  {
    "text": "to find in crosstalk script or open",
    "start": "662880",
    "end": "665120"
  },
  {
    "text": "redirection on apple.com to make it",
    "start": "665120",
    "end": "667839"
  },
  {
    "text": "loads arbitrary scripts",
    "start": "667839",
    "end": "670959"
  },
  {
    "start": "670000",
    "end": "670000"
  },
  {
    "text": "we haven't got render remote code",
    "start": "670959",
    "end": "672880"
  },
  {
    "text": "execution yet",
    "start": "672880",
    "end": "674320"
  },
  {
    "text": "but we have already bypassed sandbox",
    "start": "674320",
    "end": "677279"
  },
  {
    "text": "help viewer webview has no cheat",
    "start": "677279",
    "end": "679360"
  },
  {
    "text": "nor sandbox which means we have we need",
    "start": "679360",
    "end": "682399"
  },
  {
    "text": "one more except one more dom bug exploit",
    "start": "682399",
    "end": "685920"
  },
  {
    "text": "we can we can execute arbitrary native",
    "start": "685920",
    "end": "688880"
  },
  {
    "text": "code",
    "start": "688880",
    "end": "689279"
  },
  {
    "text": "outside sandbox which is a food chain",
    "start": "689279",
    "end": "692959"
  },
  {
    "text": "exploit",
    "start": "692959",
    "end": "695440"
  },
  {
    "text": "and this webview can open more universal",
    "start": "695600",
    "end": "698079"
  },
  {
    "text": "links which",
    "start": "698079",
    "end": "699279"
  },
  {
    "text": "maybe may open more attack surfaces for",
    "start": "699279",
    "end": "702800"
  },
  {
    "text": "us",
    "start": "702800",
    "end": "703279"
  },
  {
    "text": "for example like this vnc or ssh you can",
    "start": "703279",
    "end": "707440"
  },
  {
    "text": "connect to a remote machine",
    "start": "707440",
    "end": "709600"
  },
  {
    "text": "and here are some real bugs that",
    "start": "709600",
    "end": "712240"
  },
  {
    "text": "reported to this",
    "start": "712240",
    "end": "713440"
  },
  {
    "text": "to the re here are some bug examples for",
    "start": "713440",
    "end": "716079"
  },
  {
    "text": "the vnc client",
    "start": "716079",
    "end": "717839"
  },
  {
    "text": "clients to be attacked by the server but",
    "start": "717839",
    "end": "721360"
  },
  {
    "text": "unfortunately file is not allowed here",
    "start": "721360",
    "end": "723839"
  },
  {
    "text": "because we",
    "start": "723839",
    "end": "724560"
  },
  {
    "text": "are in https domain otherwise we can",
    "start": "724560",
    "end": "727839"
  },
  {
    "text": "just",
    "start": "727839",
    "end": "728240"
  },
  {
    "text": "execute a local application by using",
    "start": "728240",
    "end": "731399"
  },
  {
    "text": "location.replace",
    "start": "731399",
    "end": "733360"
  },
  {
    "text": "and point it to a calculator.app",
    "start": "733360",
    "end": "738079"
  },
  {
    "start": "738000",
    "end": "738000"
  },
  {
    "text": "i have tried another approach to trying",
    "start": "739040",
    "end": "741440"
  },
  {
    "text": "to extract local files",
    "start": "741440",
    "end": "744079"
  },
  {
    "text": "in this this contact webkit supports",
    "start": "744079",
    "end": "747440"
  },
  {
    "text": "url interception using an sui protocol",
    "start": "747440",
    "end": "750639"
  },
  {
    "text": "and i found that this there are three",
    "start": "750639",
    "end": "753600"
  },
  {
    "text": "and sql protocols in hub",
    "start": "753600",
    "end": "755200"
  },
  {
    "text": "viewer this protocol you",
    "start": "755200",
    "end": "758800"
  },
  {
    "text": "with this protocol you can hijack the",
    "start": "758800",
    "end": "761440"
  },
  {
    "text": "url",
    "start": "761440",
    "end": "762240"
  },
  {
    "text": "request and return custom content",
    "start": "762240",
    "end": "765680"
  },
  {
    "text": "and please do not confuse url here with",
    "start": "765680",
    "end": "768240"
  },
  {
    "text": "the universal app link we",
    "start": "768240",
    "end": "770480"
  },
  {
    "text": "jump from it before this is about",
    "start": "770480",
    "end": "774079"
  },
  {
    "text": "resource loading and",
    "start": "774079",
    "end": "777360"
  },
  {
    "text": "here is a an hv help ui protocol",
    "start": "777360",
    "end": "780639"
  },
  {
    "text": "that can that is able to load local",
    "start": "780639",
    "end": "783200"
  },
  {
    "text": "files",
    "start": "783200",
    "end": "784000"
  },
  {
    "text": "and this function actually help url",
    "start": "784000",
    "end": "785839"
  },
  {
    "text": "protocol start loading",
    "start": "785839",
    "end": "787200"
  },
  {
    "text": "it accepts a url parameter and extracts",
    "start": "787200",
    "end": "789839"
  },
  {
    "text": "its path",
    "start": "789839",
    "end": "790720"
  },
  {
    "text": "then use nsdata to read the content from",
    "start": "790720",
    "end": "793360"
  },
  {
    "text": "this path",
    "start": "793360",
    "end": "794880"
  },
  {
    "text": "if we if we use this url help whatever",
    "start": "794880",
    "end": "798720"
  },
  {
    "text": "htc password even results in the",
    "start": "798720",
    "end": "801120"
  },
  {
    "text": "contents of etc password file",
    "start": "801120",
    "end": "803360"
  },
  {
    "text": "in your local system so we need to",
    "start": "803360",
    "end": "807200"
  },
  {
    "text": "jump from https to help",
    "start": "807200",
    "end": "812320"
  },
  {
    "text": "then we can use ejects to read from",
    "start": "812320",
    "end": "815440"
  },
  {
    "text": "local files before catalina we can use",
    "start": "815440",
    "end": "818800"
  },
  {
    "text": "this nfs to mount a remote source",
    "start": "818800",
    "end": "822000"
  },
  {
    "text": "and for example help and this hostname",
    "start": "822000",
    "end": "825760"
  },
  {
    "text": "does not matter",
    "start": "825760",
    "end": "827040"
  },
  {
    "text": "and you can use this net this special",
    "start": "827040",
    "end": "830639"
  },
  {
    "text": "this special path this mount point",
    "start": "830639",
    "end": "833040"
  },
  {
    "text": "called net",
    "start": "833040",
    "end": "834240"
  },
  {
    "text": "and followed by the host name of the",
    "start": "834240",
    "end": "837120"
  },
  {
    "text": "remote machine",
    "start": "837120",
    "end": "838639"
  },
  {
    "text": "and then the path name we can use this",
    "start": "838639",
    "end": "841240"
  },
  {
    "text": "reader.html from a remote machine",
    "start": "841240",
    "end": "843680"
  },
  {
    "text": "to read arbitrary local paths but",
    "start": "843680",
    "end": "846800"
  },
  {
    "text": "unfortunately on catalina an fs",
    "start": "846800",
    "end": "850399"
  },
  {
    "text": "auto mountain was removed so i use",
    "start": "850399",
    "end": "853920"
  },
  {
    "text": "another",
    "start": "853920",
    "end": "854839"
  },
  {
    "text": "approach i try to use finder to mount",
    "start": "854839",
    "end": "858240"
  },
  {
    "text": "a remote volume using samba",
    "start": "858240",
    "end": "862320"
  },
  {
    "text": "i have to use this samba url and i",
    "start": "862320",
    "end": "865199"
  },
  {
    "text": "directly pass my",
    "start": "865199",
    "end": "866560"
  },
  {
    "text": "username and password then if",
    "start": "866560",
    "end": "870000"
  },
  {
    "text": "i sus if i succeed if i succeeded",
    "start": "870000",
    "end": "873199"
  },
  {
    "text": "this reader.html will be mounted to this",
    "start": "873199",
    "end": "876959"
  },
  {
    "text": "path name volumes slash file stage slash",
    "start": "876959",
    "end": "880600"
  },
  {
    "text": "reader.html",
    "start": "880600",
    "end": "882160"
  },
  {
    "text": "then i can make a redirection to this",
    "start": "882160",
    "end": "884399"
  },
  {
    "text": "url",
    "start": "884399",
    "end": "885760"
  },
  {
    "text": "to load reader.html and finally use this",
    "start": "885760",
    "end": "888560"
  },
  {
    "text": "reader.html to read from",
    "start": "888560",
    "end": "890639"
  },
  {
    "text": "local files but this approach failed",
    "start": "890639",
    "end": "893839"
  },
  {
    "text": "because it as it actually asks for",
    "start": "893839",
    "end": "896720"
  },
  {
    "text": "confirmation",
    "start": "896720",
    "end": "897600"
  },
  {
    "text": "in finder before the samba",
    "start": "897600",
    "end": "900639"
  },
  {
    "text": "volume was mounted",
    "start": "900639",
    "end": "904560"
  },
  {
    "text": "another thing in this review is that i",
    "start": "904800",
    "end": "907360"
  },
  {
    "text": "found that it's able to call",
    "start": "907360",
    "end": "909279"
  },
  {
    "text": "limited objective c message",
    "start": "909279",
    "end": "912639"
  },
  {
    "text": "there is an hv webview delegate object",
    "start": "912639",
    "end": "915519"
  },
  {
    "text": "assessing both",
    "start": "915519",
    "end": "916480"
  },
  {
    "text": "while window.help viewer but",
    "start": "916480",
    "end": "920320"
  },
  {
    "text": "there is no interesting interface",
    "start": "920320",
    "end": "924320"
  },
  {
    "start": "924000",
    "end": "924000"
  },
  {
    "text": "here's some drama for this bug i found",
    "start": "925040",
    "end": "927680"
  },
  {
    "text": "this",
    "start": "927680",
    "end": "928480"
  },
  {
    "text": "i actually had an exploit prepared for",
    "start": "928480",
    "end": "932160"
  },
  {
    "text": "10th cup",
    "start": "932160",
    "end": "933360"
  },
  {
    "text": "but mac os 10.15 developer beta",
    "start": "933360",
    "end": "936560"
  },
  {
    "text": "killed my sandbox exploit like a month",
    "start": "936560",
    "end": "939199"
  },
  {
    "text": "before so i have to find another",
    "start": "939199",
    "end": "941279"
  },
  {
    "text": "replacement and there's no there was no",
    "start": "941279",
    "end": "944639"
  },
  {
    "text": "enough time for me to do so i",
    "start": "944639",
    "end": "947120"
  },
  {
    "text": "accidentally found this help we were",
    "start": "947120",
    "end": "949199"
  },
  {
    "text": "schemed about",
    "start": "949199",
    "end": "950560"
  },
  {
    "text": "just one week before 10th cup and i",
    "start": "950560",
    "end": "952720"
  },
  {
    "text": "rushed to find another croissant",
    "start": "952720",
    "end": "954079"
  },
  {
    "text": "scripting",
    "start": "954079",
    "end": "955199"
  },
  {
    "text": "on apple.com one day just one day later",
    "start": "955199",
    "end": "960240"
  },
  {
    "text": "at this point it's already a sandbox",
    "start": "960240",
    "end": "962320"
  },
  {
    "text": "escape but i still need",
    "start": "962320",
    "end": "964320"
  },
  {
    "text": "one more dom exploit to achieve native",
    "start": "964320",
    "end": "966480"
  },
  {
    "text": "code execution",
    "start": "966480",
    "end": "967600"
  },
  {
    "text": "but i didn't make it so i got a partial",
    "start": "967600",
    "end": "970800"
  },
  {
    "text": "win",
    "start": "970800",
    "end": "971199"
  },
  {
    "text": "and but other partic participator of",
    "start": "971199",
    "end": "974480"
  },
  {
    "text": "this competition",
    "start": "974480",
    "end": "975680"
  },
  {
    "text": "didn't want to share the awards so they",
    "start": "975680",
    "end": "977680"
  },
  {
    "text": "all gave up",
    "start": "977680",
    "end": "978720"
  },
  {
    "text": "i was the only one who want this",
    "start": "978720",
    "end": "981600"
  },
  {
    "text": "category",
    "start": "981600",
    "end": "983839"
  },
  {
    "text": "but that bug was actually no fun so",
    "start": "985600",
    "end": "988639"
  },
  {
    "text": "here are some really real masterpiece i",
    "start": "988639",
    "end": "991759"
  },
  {
    "text": "call it masterpiece",
    "start": "991759",
    "end": "993759"
  },
  {
    "text": "let's look up the shell in dictionary",
    "start": "993759",
    "end": "997600"
  },
  {
    "start": "997000",
    "end": "997000"
  },
  {
    "text": "this is a story for cve 2020-979",
    "start": "997600",
    "end": "1002399"
  },
  {
    "text": "we got trust issue so mac os and ios",
    "start": "1002399",
    "end": "1006320"
  },
  {
    "text": "regularly pull ota updates from this",
    "start": "1006320",
    "end": "1008880"
  },
  {
    "text": "website mesu.ipro.com and store them",
    "start": "1008880",
    "end": "1012639"
  },
  {
    "text": "to system library assets typically",
    "start": "1012639",
    "end": "1015920"
  },
  {
    "text": "these assets are not executable there is",
    "start": "1015920",
    "end": "1018720"
  },
  {
    "text": "for example there are some",
    "start": "1018720",
    "end": "1020240"
  },
  {
    "text": "there are some dictionary fonts and",
    "start": "1020240",
    "end": "1022399"
  },
  {
    "text": "mobile accessories",
    "start": "1022399",
    "end": "1023759"
  },
  {
    "text": "etc it's implemented in mobile assets",
    "start": "1023759",
    "end": "1027038"
  },
  {
    "text": "framework and a daemon called mobile ssd",
    "start": "1027039",
    "end": "1032319"
  },
  {
    "text": "it provides some private apis for you to",
    "start": "1032319",
    "end": "1034798"
  },
  {
    "text": "opt to query and",
    "start": "1034799",
    "end": "1036079"
  },
  {
    "text": "update the assets for in this particular",
    "start": "1036079",
    "end": "1040000"
  },
  {
    "text": "class as asset you can update the",
    "start": "1040000",
    "end": "1043038"
  },
  {
    "text": "properties",
    "start": "1043039",
    "end": "1044000"
  },
  {
    "text": "of an asset and trigger the download",
    "start": "1044000",
    "end": "1046079"
  },
  {
    "text": "action",
    "start": "1046079",
    "end": "1048480"
  },
  {
    "text": "the attributes of this asset class",
    "start": "1048960",
    "end": "1052400"
  },
  {
    "text": "is an unnext dictionary that includes",
    "start": "1052400",
    "end": "1055120"
  },
  {
    "text": "following keys",
    "start": "1055120",
    "end": "1056880"
  },
  {
    "text": "you can either use a base url and a",
    "start": "1056880",
    "end": "1058960"
  },
  {
    "text": "relative path to con",
    "start": "1058960",
    "end": "1060720"
  },
  {
    "text": "to compose of an absolute url",
    "start": "1060720",
    "end": "1064400"
  },
  {
    "text": "or just use a full remote url to set",
    "start": "1064400",
    "end": "1068400"
  },
  {
    "text": "the remote location of an asset",
    "start": "1068400",
    "end": "1072559"
  },
  {
    "text": "the host doesn't have to be",
    "start": "1072559",
    "end": "1075080"
  },
  {
    "text": "memso.apple.com",
    "start": "1075080",
    "end": "1076559"
  },
  {
    "text": "actually it can be anything there is no",
    "start": "1076559",
    "end": "1078799"
  },
  {
    "text": "checking at all",
    "start": "1078799",
    "end": "1080960"
  },
  {
    "text": "so we can use this trust bug to download",
    "start": "1080960",
    "end": "1085440"
  },
  {
    "text": "anything from anywhere you like",
    "start": "1085440",
    "end": "1089200"
  },
  {
    "text": "and you have to supply the",
    "start": "1089280",
    "end": "1092960"
  },
  {
    "text": "corresponding download size and archive",
    "start": "1092960",
    "end": "1095840"
  },
  {
    "text": "size and measurement",
    "start": "1095840",
    "end": "1097360"
  },
  {
    "text": "to the resource otherwise it will not",
    "start": "1097360",
    "end": "1100559"
  },
  {
    "text": "pass the check",
    "start": "1100559",
    "end": "1101440"
  },
  {
    "text": "and the integrated check and the",
    "start": "1101440",
    "end": "1103200"
  },
  {
    "text": "download will fail",
    "start": "1103200",
    "end": "1105360"
  },
  {
    "text": "now we try to exploit this bug",
    "start": "1105360",
    "end": "1108960"
  },
  {
    "text": "firstly we will use this asset query",
    "start": "1108960",
    "end": "1113200"
  },
  {
    "text": "to to find the asset that we want to",
    "start": "1113200",
    "end": "1115919"
  },
  {
    "text": "replace",
    "start": "1115919",
    "end": "1117360"
  },
  {
    "text": "and we attach its attributes to point to",
    "start": "1117360",
    "end": "1120400"
  },
  {
    "text": "our remote resource",
    "start": "1120400",
    "end": "1122320"
  },
  {
    "text": "and then we invoke this aes asset begin",
    "start": "1122320",
    "end": "1124880"
  },
  {
    "text": "download with options method",
    "start": "1124880",
    "end": "1126720"
  },
  {
    "text": "to actually download it and replace the",
    "start": "1126720",
    "end": "1129280"
  },
  {
    "text": "local",
    "start": "1129280",
    "end": "1129840"
  },
  {
    "text": "one now this",
    "start": "1129840",
    "end": "1133760"
  },
  {
    "text": "this service is accessible by web",
    "start": "1133760",
    "end": "1136320"
  },
  {
    "text": "content sandbox",
    "start": "1136320",
    "end": "1137840"
  },
  {
    "text": "to update some certain resource the",
    "start": "1137840",
    "end": "1140480"
  },
  {
    "text": "caller must",
    "start": "1140480",
    "end": "1141360"
  },
  {
    "text": "sometimes needs to hold an entitlement",
    "start": "1141360",
    "end": "1143679"
  },
  {
    "text": "called com.private.accessible",
    "start": "1143679",
    "end": "1146880"
  },
  {
    "text": "asset types which is a an array of all",
    "start": "1146880",
    "end": "1150480"
  },
  {
    "text": "the assets type",
    "start": "1150480",
    "end": "1151440"
  },
  {
    "text": "string but fortunately some of the",
    "start": "1151440",
    "end": "1153679"
  },
  {
    "text": "resources don't",
    "start": "1153679",
    "end": "1154720"
  },
  {
    "text": "require this entitlement for example",
    "start": "1154720",
    "end": "1158640"
  },
  {
    "text": "com.apple.mobileasset.dictionaryservices.dictionaryos10",
    "start": "1160200",
    "end": "1162000"
  },
  {
    "text": "it's hardcoded in this function",
    "start": "1162000",
    "end": "1165120"
  },
  {
    "text": "so in this way we can download from",
    "start": "1165120",
    "end": "1166880"
  },
  {
    "text": "arbitrary remote url",
    "start": "1166880",
    "end": "1168640"
  },
  {
    "text": "and replace arbitrary dictionaries",
    "start": "1168640",
    "end": "1173760"
  },
  {
    "text": "and what's even better is that mobile",
    "start": "1173760",
    "end": "1175520"
  },
  {
    "text": "asset d doesn't set this com.current",
    "start": "1175520",
    "end": "1178000"
  },
  {
    "text": "thing flag to",
    "start": "1178000",
    "end": "1178960"
  },
  {
    "text": "download the file so we can bypass the",
    "start": "1178960",
    "end": "1182160"
  },
  {
    "text": "gatekeeper",
    "start": "1182160",
    "end": "1184880"
  },
  {
    "start": "1184000",
    "end": "1184000"
  },
  {
    "text": "now here is the dictionary app is one of",
    "start": "1185039",
    "end": "1188400"
  },
  {
    "text": "the built-in apps",
    "start": "1188400",
    "end": "1189440"
  },
  {
    "text": "that comes with mac os it's basically",
    "start": "1189440",
    "end": "1192000"
  },
  {
    "text": "some local html and javascript in a web",
    "start": "1192000",
    "end": "1194160"
  },
  {
    "text": "view",
    "start": "1194160",
    "end": "1195039"
  },
  {
    "text": "in the url the domain is file",
    "start": "1195039",
    "end": "1198160"
  },
  {
    "text": "since we have exploited the debug and",
    "start": "1198160",
    "end": "1200880"
  },
  {
    "text": "mobile set",
    "start": "1200880",
    "end": "1201840"
  },
  {
    "text": "asset framework we can inject cross-site",
    "start": "1201840",
    "end": "1204720"
  },
  {
    "text": "cross-scripting payload from safari to",
    "start": "1204720",
    "end": "1206960"
  },
  {
    "text": "dictionary",
    "start": "1206960",
    "end": "1207760"
  },
  {
    "text": "webview and what can we do in this",
    "start": "1207760",
    "end": "1210240"
  },
  {
    "text": "webview",
    "start": "1210240",
    "end": "1211679"
  },
  {
    "text": "ideally that i tried something in this",
    "start": "1211679",
    "end": "1213760"
  },
  {
    "start": "1212000",
    "end": "1212000"
  },
  {
    "text": "webview and i",
    "start": "1213760",
    "end": "1215039"
  },
  {
    "text": "managed to create and manage it to",
    "start": "1215039",
    "end": "1218159"
  },
  {
    "text": "launch the calculator from these",
    "start": "1218159",
    "end": "1220559"
  },
  {
    "text": "three lines of code i can you",
    "start": "1220559",
    "end": "1223600"
  },
  {
    "text": "create an entry element and",
    "start": "1223600",
    "end": "1226640"
  },
  {
    "text": "trigger the click event to it and",
    "start": "1226640",
    "end": "1230080"
  },
  {
    "text": "it actually works the calculator shows",
    "start": "1230080",
    "end": "1232400"
  },
  {
    "text": "up",
    "start": "1232400",
    "end": "1233440"
  },
  {
    "text": "but another one another way to redirect",
    "start": "1233440",
    "end": "1236799"
  },
  {
    "text": "the page that assign and string to the",
    "start": "1236799",
    "end": "1239919"
  },
  {
    "text": "location object",
    "start": "1239919",
    "end": "1241039"
  },
  {
    "text": "does not work nothing happen",
    "start": "1241039",
    "end": "1245039"
  },
  {
    "text": "so how could this even happen this is",
    "start": "1247440",
    "end": "1250320"
  },
  {
    "text": "where it's changed",
    "start": "1250320",
    "end": "1251840"
  },
  {
    "text": "the answer is inside this delegate",
    "start": "1251840",
    "end": "1255039"
  },
  {
    "text": "handler it's called decide policy for",
    "start": "1255039",
    "end": "1257120"
  },
  {
    "text": "navigation action",
    "start": "1257120",
    "end": "1258799"
  },
  {
    "text": "it will fire each time the webview needs",
    "start": "1258799",
    "end": "1261200"
  },
  {
    "text": "to redirect the url",
    "start": "1261200",
    "end": "1263360"
  },
  {
    "text": "it fetch the url from the entry only in",
    "start": "1263360",
    "end": "1266240"
  },
  {
    "text": "this web action element key",
    "start": "1266240",
    "end": "1269600"
  },
  {
    "text": "it wouldn't handle for location",
    "start": "1269600",
    "end": "1272159"
  },
  {
    "text": "redirection",
    "start": "1272159",
    "end": "1273039"
  },
  {
    "text": "that's how that's what we saw",
    "start": "1273039",
    "end": "1276720"
  },
  {
    "text": "when this url is started",
    "start": "1276720",
    "end": "1279840"
  },
  {
    "text": "is started by when this url is not is",
    "start": "1279840",
    "end": "1284240"
  },
  {
    "start": "1280000",
    "end": "1280000"
  },
  {
    "text": "in file url",
    "start": "1284240",
    "end": "1287440"
  },
  {
    "text": "it will try to ask the next workspace",
    "start": "1287440",
    "end": "1292639"
  },
  {
    "text": "to open it which",
    "start": "1292720",
    "end": "1296000"
  },
  {
    "text": "is a well-known vector for opening local",
    "start": "1296000",
    "end": "1299600"
  },
  {
    "text": "apps and files when the file url points",
    "start": "1299600",
    "end": "1303360"
  },
  {
    "text": "to an app bundle",
    "start": "1303360",
    "end": "1305039"
  },
  {
    "text": "it gets executed by the launch service",
    "start": "1305039",
    "end": "1308720"
  },
  {
    "text": "now of course the file must not have",
    "start": "1308720",
    "end": "1310640"
  },
  {
    "text": "this com.current thing flagged",
    "start": "1310640",
    "end": "1313039"
  },
  {
    "text": "otherwise it will be blocked by the",
    "start": "1313039",
    "end": "1315280"
  },
  {
    "text": "gatekeeper",
    "start": "1315280",
    "end": "1316880"
  },
  {
    "text": "the new process does not inherit sandbox",
    "start": "1316880",
    "end": "1319360"
  },
  {
    "text": "profile from dictionary app",
    "start": "1319360",
    "end": "1321200"
  },
  {
    "text": "which makes it much more ideal for",
    "start": "1321200",
    "end": "1324000"
  },
  {
    "text": "sandbox escape",
    "start": "1324000",
    "end": "1326960"
  },
  {
    "start": "1326000",
    "end": "1326000"
  },
  {
    "text": "so now how do we jump to dictionary",
    "start": "1326960",
    "end": "1329600"
  },
  {
    "text": "obviously we cannot just use this url",
    "start": "1329600",
    "end": "1332320"
  },
  {
    "text": "redirect there is an",
    "start": "1332320",
    "end": "1336080"
  },
  {
    "text": "ipc in webkit that can open a dictionary",
    "start": "1336080",
    "end": "1338640"
  },
  {
    "text": "lookup window",
    "start": "1338640",
    "end": "1340960"
  },
  {
    "text": "and it's all is is able to open a",
    "start": "1340960",
    "end": "1343200"
  },
  {
    "text": "dictionary in this way",
    "start": "1343200",
    "end": "1346559"
  },
  {
    "start": "1345000",
    "end": "1345000"
  },
  {
    "text": "now first we create a text selection in",
    "start": "1346559",
    "end": "1349200"
  },
  {
    "text": "javascript",
    "start": "1349200",
    "end": "1351039"
  },
  {
    "text": "now we draw our exploit to get shell",
    "start": "1351039",
    "end": "1353760"
  },
  {
    "text": "code executed",
    "start": "1353760",
    "end": "1356240"
  },
  {
    "text": "then we exploit this mobile asset to",
    "start": "1356240",
    "end": "1358799"
  },
  {
    "text": "download the malicious dictionary from",
    "start": "1358799",
    "end": "1360400"
  },
  {
    "text": "the internet",
    "start": "1360400",
    "end": "1361679"
  },
  {
    "text": "and we send this ipc to perform the",
    "start": "1361679",
    "end": "1363360"
  },
  {
    "text": "lookup and show this local view service",
    "start": "1363360",
    "end": "1365760"
  },
  {
    "text": "over late",
    "start": "1365760",
    "end": "1367440"
  },
  {
    "text": "it will trigger our first crosstalk",
    "start": "1367440",
    "end": "1369760"
  },
  {
    "text": "script",
    "start": "1369760",
    "end": "1370480"
  },
  {
    "text": "in this overlay in this in our in this",
    "start": "1370480",
    "end": "1374240"
  },
  {
    "text": "course",
    "start": "1374240",
    "end": "1374720"
  },
  {
    "text": "in this payload we will use another",
    "start": "1374720",
    "end": "1377760"
  },
  {
    "text": "location to redirect to this",
    "start": "1377760",
    "end": "1380880"
  },
  {
    "text": "universal link to open the dictionary",
    "start": "1380880",
    "end": "1384000"
  },
  {
    "text": "the app without confirmation",
    "start": "1384000",
    "end": "1387440"
  },
  {
    "text": "then the dictionary app will load our",
    "start": "1387440",
    "end": "1389120"
  },
  {
    "text": "malicious script",
    "start": "1389120",
    "end": "1390640"
  },
  {
    "text": "and execute the final payload outside",
    "start": "1390640",
    "end": "1394080"
  },
  {
    "text": "the sandbox",
    "start": "1394080",
    "end": "1396880"
  },
  {
    "text": "let's see the demo now here's the second",
    "start": "1397919",
    "end": "1401120"
  },
  {
    "text": "demonstration today",
    "start": "1401120",
    "end": "1402960"
  },
  {
    "text": "first we use a cheat box to gain remote",
    "start": "1402960",
    "end": "1405200"
  },
  {
    "text": "control execution in a renderer process",
    "start": "1405200",
    "end": "1407440"
  },
  {
    "text": "then we use the wireless ipc to download",
    "start": "1407440",
    "end": "1410080"
  },
  {
    "text": "the meshes",
    "start": "1410080",
    "end": "1411280"
  },
  {
    "text": "dictionary and finally execute our",
    "start": "1411280",
    "end": "1414840"
  },
  {
    "text": "payload",
    "start": "1414840",
    "end": "1416640"
  },
  {
    "text": "now putting it all together here's the",
    "start": "1416640",
    "end": "1418720"
  },
  {
    "start": "1417000",
    "end": "1417000"
  },
  {
    "text": "summary",
    "start": "1418720",
    "end": "1420080"
  },
  {
    "text": "in this talk we have just demonstrated a",
    "start": "1420080",
    "end": "1422799"
  },
  {
    "text": "new technique",
    "start": "1422799",
    "end": "1424159"
  },
  {
    "text": "that you can inject javascript to a",
    "start": "1424159",
    "end": "1426159"
  },
  {
    "text": "privileged process",
    "start": "1426159",
    "end": "1428080"
  },
  {
    "text": "through inter process communication",
    "start": "1428080",
    "end": "1431440"
  },
  {
    "text": "to escape from safari sandbox or mac os",
    "start": "1431440",
    "end": "1435279"
  },
  {
    "text": "and it's part there are some possible",
    "start": "1435279",
    "end": "1436960"
  },
  {
    "text": "vectors including uil schemes and",
    "start": "1436960",
    "end": "1439279"
  },
  {
    "text": "traditional",
    "start": "1439279",
    "end": "1440400"
  },
  {
    "text": "inter-process communication like xpc or",
    "start": "1440400",
    "end": "1442880"
  },
  {
    "text": "mig or even webkit",
    "start": "1442880",
    "end": "1444880"
  },
  {
    "text": "rpc sometimes you don't have to you",
    "start": "1444880",
    "end": "1448400"
  },
  {
    "text": "don't need the initial",
    "start": "1448400",
    "end": "1449520"
  },
  {
    "text": "renderer remote code execution to jump",
    "start": "1449520",
    "end": "1452240"
  },
  {
    "text": "to another url's",
    "start": "1452240",
    "end": "1453440"
  },
  {
    "text": "universal link to escape from the",
    "start": "1453440",
    "end": "1456840"
  },
  {
    "text": "sandbox",
    "start": "1456840",
    "end": "1458320"
  },
  {
    "text": "ending in this those privileged webview",
    "start": "1458320",
    "end": "1462240"
  },
  {
    "text": "you have to do some reverse engineering",
    "start": "1462240",
    "end": "1465520"
  },
  {
    "text": "to develop your next step of",
    "start": "1465520",
    "end": "1468320"
  },
  {
    "text": "exploitation",
    "start": "1468320",
    "end": "1469840"
  },
  {
    "text": "you have to focus on delegates for",
    "start": "1469840",
    "end": "1472320"
  },
  {
    "text": "resource loading",
    "start": "1472320",
    "end": "1473440"
  },
  {
    "text": "navigation file download etc and",
    "start": "1473440",
    "end": "1476159"
  },
  {
    "text": "sometimes there will be some",
    "start": "1476159",
    "end": "1477520"
  },
  {
    "text": "objective c message exposed by briefly",
    "start": "1477520",
    "end": "1481039"
  },
  {
    "text": "bridge to javascript call which you can",
    "start": "1481039",
    "end": "1483919"
  },
  {
    "text": "call this",
    "start": "1483919",
    "end": "1484960"
  },
  {
    "text": "message to execute",
    "start": "1484960",
    "end": "1488240"
  },
  {
    "text": "code or something and sometimes",
    "start": "1488240",
    "end": "1493360"
  },
  {
    "text": "it will be in the file url in the web",
    "start": "1493360",
    "end": "1496480"
  },
  {
    "text": "view in this web in the legacy web will",
    "start": "1496480",
    "end": "1499279"
  },
  {
    "text": "file url",
    "start": "1499279",
    "end": "1500080"
  },
  {
    "text": "is treated as privilege that it can has",
    "start": "1500080",
    "end": "1502720"
  },
  {
    "text": "a universal process scripting to access",
    "start": "1502720",
    "end": "1505039"
  },
  {
    "text": "arbitrary",
    "start": "1505039",
    "end": "1506000"
  },
  {
    "text": "remote url and arbitrary local files",
    "start": "1506000",
    "end": "1510320"
  },
  {
    "text": "and in this webview you are often",
    "start": "1510480",
    "end": "1513840"
  },
  {
    "text": "able to silently open more url schemes",
    "start": "1513840",
    "end": "1516320"
  },
  {
    "text": "than safari which",
    "start": "1516320",
    "end": "1517679"
  },
  {
    "text": "opens a greater attack surface than",
    "start": "1517679",
    "end": "1520000"
  },
  {
    "text": "before",
    "start": "1520000",
    "end": "1522400"
  },
  {
    "start": "1522000",
    "end": "1522000"
  },
  {
    "text": "and the takeaways from this talk is that",
    "start": "1522559",
    "end": "1526400"
  },
  {
    "text": "this desktop operating systems have",
    "start": "1526400",
    "end": "1528799"
  },
  {
    "text": "complex attack surfaces",
    "start": "1528799",
    "end": "1530720"
  },
  {
    "text": "that may be on your imagination and",
    "start": "1530720",
    "end": "1533520"
  },
  {
    "text": "sometimes this legacy of components",
    "start": "1533520",
    "end": "1535679"
  },
  {
    "text": "may lower your security baseline and",
    "start": "1535679",
    "end": "1538880"
  },
  {
    "text": "find and of course we have",
    "start": "1538880",
    "end": "1540400"
  },
  {
    "text": "shown three full sandbox escape",
    "start": "1540400",
    "end": "1543840"
  },
  {
    "text": "exploits on safari",
    "start": "1543840",
    "end": "1547919"
  },
  {
    "text": "with zero memory corruption",
    "start": "1547919",
    "end": "1551519"
  },
  {
    "text": "if you have any questions you can ask me",
    "start": "1551760",
    "end": "1553760"
  },
  {
    "text": "now",
    "start": "1553760",
    "end": "1555039"
  },
  {
    "text": "thank you",
    "start": "1555039",
    "end": "1557840"
  }
]