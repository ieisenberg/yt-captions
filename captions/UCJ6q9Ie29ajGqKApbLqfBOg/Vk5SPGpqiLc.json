[
  {
    "text": "this is Nishant with JavaScript Statics security analysis Made Easy with JS Prime let's give him a",
    "start": "560",
    "end": "7799"
  },
  {
    "text": "hand uh thanks Jack for introducing me uh thank you guys for coming in I know",
    "start": "11960",
    "end": "17320"
  },
  {
    "text": "it's tough to be in a session um right after the lunch in the afternoon so I'll try my best to keep you awake during the",
    "start": "17320",
    "end": "25400"
  },
  {
    "text": "session okay so yeah as Jack mentioned uh this talk will be uh titled as uh",
    "start": "25400",
    "end": "32520"
  },
  {
    "text": "JavaScript static analysis static security analysis Made Easy uh with a tool that we have been working since",
    "start": "32520",
    "end": "39559"
  },
  {
    "text": "last couple of months called JS Prime and uh so before we get started uh",
    "start": "39559",
    "end": "45520"
  },
  {
    "text": "I just wanted to uh ask you guys uh please raise up your hands how many of you are uh JavaScript developers here or",
    "start": "45520",
    "end": "52359"
  },
  {
    "text": "are involved in U source code reviews of security secure code reviews of JavaScript okay lots of fans thank you",
    "start": "52359",
    "end": "61519"
  },
  {
    "text": "uh okay so uh let's get started so by the way this talk will be",
    "start": "61519",
    "end": "67920"
  },
  {
    "text": "uh was jointly prepared by me and uh my uh friend sari uh unfortunately he is",
    "start": "67920",
    "end": "73759"
  },
  {
    "text": "not here due to some Visa problem so I'll be uh taking this session",
    "start": "73759",
    "end": "78920"
  },
  {
    "text": "alone so we have the agenda for uh today uh",
    "start": "78920",
    "end": "84880"
  },
  {
    "text": "for the next uh 40 45 minutes or so I'll be speaking on some of these uh things",
    "start": "84880",
    "end": "90920"
  },
  {
    "text": "we'll first talk about the problem the problem that we we're trying to",
    "start": "90920",
    "end": "96479"
  },
  {
    "text": "solve and we'll try to introduce you why it's a problem what is the problem and",
    "start": "96479",
    "end": "102159"
  },
  {
    "text": "how it can be a problem and some of the demos then we'll introduce uh uh the",
    "start": "102159",
    "end": "109280"
  },
  {
    "text": "tool or the solution that we are working called GS Prime I'll tell you what is it",
    "start": "109280",
    "end": "115320"
  },
  {
    "text": "who is it meant for how it works what it can do and what it cannot do so that I",
    "start": "115320",
    "end": "121520"
  },
  {
    "text": "set the expectation right and uh though I have kept uh the",
    "start": "121520",
    "end": "129800"
  },
  {
    "text": "last 10 minutes for question and uh answers but please feel free to stop me anywhere when you want some",
    "start": "129800",
    "end": "135599"
  },
  {
    "text": "clarification or you have some doubts okay so a brief seeless",
    "start": "135599",
    "end": "143519"
  },
  {
    "text": "self-promotion so I am um first time blacket speaker",
    "start": "143519",
    "end": "149239"
  },
  {
    "text": "and first time in Vegas 2o so a little bit nervous hope you'll",
    "start": "149239",
    "end": "156560"
  },
  {
    "text": "uh hope you guys will make me comfortable and uh I'm I work as a senior pared at Yahoo",
    "start": "159680",
    "end": "167239"
  },
  {
    "text": "uh India and as uh how many of you are from Yahoo",
    "start": "167239",
    "end": "173440"
  },
  {
    "text": "here okay lots of guys so I'm already comfortable I was uh previously worked",
    "start": "173440",
    "end": "181040"
  },
  {
    "text": "for eBay as a security engineer uh during my weekends uh so since my",
    "start": "181040",
    "end": "186599"
  },
  {
    "text": "manager is here so I'll just say in my weekends I'm a bug Bounty",
    "start": "186599",
    "end": "192120"
  },
  {
    "text": "Hunter uh I have managed to be successful in uh for hunting some bugs for Facebook Mozilla Nokia forare and",
    "start": "192640",
    "end": "200480"
  },
  {
    "text": "like some similar companies I was a speaker at ncon 2012 which is a security",
    "start": "200480",
    "end": "206599"
  },
  {
    "text": "conference um in that that takes place in uh India and there we release a very basic",
    "start": "206599",
    "end": "213000"
  },
  {
    "text": "Firefox add-on that helps you scan for Dom based accss issues um I I've been studying self",
    "start": "213000",
    "end": "220720"
  },
  {
    "text": "studying security for Last 5 Years or so I occasionally play uh grand piano and",
    "start": "220720",
    "end": "227040"
  },
  {
    "text": "keyboards and uh recently uh I'm been turned into a sports bike [Music]",
    "start": "227040",
    "end": "233400"
  },
  {
    "text": "Enthusiast so that's U my introduction I'll just take a few minutes to",
    "start": "233400",
    "end": "239200"
  },
  {
    "text": "introduce sari unfortunately he's not here as I told you he's a very experienced application developer almost",
    "start": "239200",
    "end": "246439"
  },
  {
    "text": "about more than 7 years of experience he uh was with Yahoo for the last 5 years",
    "start": "246439",
    "end": "252680"
  },
  {
    "text": "or so he is now the full-time uh developer for this tool called JS Prime",
    "start": "252680",
    "end": "259359"
  },
  {
    "text": "you can catch him up at his Twitter handle and as well as on Facebook Okay so let's get serious",
    "start": "259359",
    "end": "269320"
  },
  {
    "text": "JavaScript um it's it's it's not nothing new we all know uh JavaScript you guys",
    "start": "274360",
    "end": "281720"
  },
  {
    "text": "have been uh writing applications in JavaScript but the fact today is that",
    "start": "281720",
    "end": "287320"
  },
  {
    "text": "it's the lingua franka of web and mobile now you you you see the new technologies",
    "start": "287320",
    "end": "294280"
  },
  {
    "text": "coming up Firefox OS you name it uh on mobile devices on",
    "start": "294280",
    "end": "300160"
  },
  {
    "text": "mainstream web applications in hybrid mobile applications like using Frameworks like phone",
    "start": "300160",
    "end": "306840"
  },
  {
    "text": "Gap and uh in Windows uh mobile phones what they call it as",
    "start": "306840",
    "end": "312919"
  },
  {
    "text": "wijs and there are new sdks or Frameworks being released like the goo",
    "start": "312919",
    "end": "318440"
  },
  {
    "text": "engine which is uh you lets you write interactive and uh 3D games using",
    "start": "318440",
    "end": "324600"
  },
  {
    "text": "JavaScript and HTML 5 so it's everywhere and uh I sorry I forgot to mention about",
    "start": "324600",
    "end": "330880"
  },
  {
    "text": "nodejs the new uh server side uh JavaScript so it's almost everywhere be",
    "start": "330880",
    "end": "338800"
  },
  {
    "text": "it client side be it server side be it on mobile phones it's everywhere so it's becoming",
    "start": "338800",
    "end": "345479"
  },
  {
    "text": "the most uh I mean the de facto language for developers",
    "start": "345479",
    "end": "350600"
  },
  {
    "text": "because they need to know just one language and they can program for like say whatever application they need to or",
    "start": "350600",
    "end": "357479"
  },
  {
    "text": "feel feel like uh so that's about it and uh so what is",
    "start": "357479",
    "end": "363000"
  },
  {
    "text": "the problem with JavaScript then so before I uh talk about the",
    "start": "363000",
    "end": "368400"
  },
  {
    "text": "problem in in context to security I just wanted to uh let you know that why it's",
    "start": "368400",
    "end": "373680"
  },
  {
    "text": "a big deal in know you know or big deal to review JavaScript based Source codes",
    "start": "373680",
    "end": "380960"
  },
  {
    "text": "why why there's a uh talk uh on uh on a tool that just scans JavaScript source",
    "start": "380960",
    "end": "387520"
  },
  {
    "text": "code and figures out security issues that's because JavaScript is a very Dynamic",
    "start": "387520",
    "end": "392919"
  },
  {
    "text": "language and these are some of the uh points that I have mentioned I'll just go uh",
    "start": "392919",
    "end": "399840"
  },
  {
    "text": "through I I'll just go through each one of them and show you some code Snippets",
    "start": "399840",
    "end": "405280"
  },
  {
    "text": "and uh I hope I'll I'll be able to convince you why it's it's it can be a",
    "start": "405280",
    "end": "410639"
  },
  {
    "text": "really a pain or it can be really tricky to write a at least a good JavaScript source code",
    "start": "410639",
    "end": "418360"
  },
  {
    "text": "canner if not perfect so JavaScript as you know is a",
    "start": "418360",
    "end": "424440"
  },
  {
    "text": "objectoriented uh uh language you can create properties on",
    "start": "424440",
    "end": "430520"
  },
  {
    "text": "demand so let us just go and I I'll just show you some uh source sces",
    "start": "430520",
    "end": "439479"
  },
  {
    "text": "okay so let me just try and explain you uh briefly uh objectoriented and",
    "start": "454280",
    "end": "461360"
  },
  {
    "text": "properties created on demand so you see here uh this line separates three",
    "start": "461360",
    "end": "467599"
  },
  {
    "text": "different uh code Snippets but the interesting thing here is all these code Snippets do the exact",
    "start": "467599",
    "end": "474639"
  },
  {
    "text": "same thing so what I've done here is I'm trying to create an object called",
    "start": "474639",
    "end": "479800"
  },
  {
    "text": "blackhe hat and there's an uh function called",
    "start": "479800",
    "end": "484919"
  },
  {
    "text": "upcoming which is declared this way and it's it has another attribute",
    "start": "484919",
    "end": "492360"
  },
  {
    "text": "called events which is an array so this is one way you can uh",
    "start": "492360",
    "end": "499360"
  },
  {
    "text": "create an object this is the second way",
    "start": "499360",
    "end": "506240"
  },
  {
    "text": "I'm using the new uh operator um defining an object which um",
    "start": "510360",
    "end": "516839"
  },
  {
    "text": "called black hat and I'm using the object. defin property to do this exact",
    "start": "516839",
    "end": "521959"
  },
  {
    "text": "same thing have an attribute called upcoming which is a",
    "start": "521959",
    "end": "527120"
  },
  {
    "text": "function and passing these uh function arguments which is like writeable is it",
    "start": "527920",
    "end": "533800"
  },
  {
    "text": "modifiable or not en numerable whether it shows up in the foreign Loop or the",
    "start": "533800",
    "end": "538880"
  },
  {
    "text": "object do keys configurable or not whether you can dynamically delete this uh",
    "start": "538880",
    "end": "545040"
  },
  {
    "text": "attribute and the same thing for the uh second property called uh or attribute called events which is again an",
    "start": "545040",
    "end": "553720"
  },
  {
    "text": "array and this is the third way I'm doing it via the setter and getter",
    "start": "554800",
    "end": "562440"
  },
  {
    "text": "so next thing is uh prototype based inheritance I'll just again go to the",
    "start": "570959",
    "end": "580600"
  },
  {
    "text": "uh same thing",
    "start": "580600",
    "end": "585000"
  },
  {
    "text": "in JavaScript function is also a class so there is a no um independent or uh",
    "start": "602480",
    "end": "610320"
  },
  {
    "text": "you know specific operator or keyboard called say like what you do in Java or something like for defining a class you",
    "start": "610320",
    "end": "616880"
  },
  {
    "text": "can just Define a function and that becomes a class and here the the class is a",
    "start": "616880",
    "end": "626079"
  },
  {
    "text": "person and and uh say hello is is a new",
    "start": "628000",
    "end": "633079"
  },
  {
    "text": "uh method that I'm uh creating in the class using the",
    "start": "633079",
    "end": "638320"
  },
  {
    "text": "Prototype similarly uh there are functions in JavaScript function is a",
    "start": "639760",
    "end": "647279"
  },
  {
    "text": "first class Cien now what that means is it can be assigned to a variable it can",
    "start": "647279",
    "end": "652560"
  },
  {
    "text": "be an objects property it can be passed to another function as an argument it",
    "start": "652560",
    "end": "657680"
  },
  {
    "text": "can be returned by a function it's a class by default and it can be",
    "start": "657680",
    "end": "663200"
  },
  {
    "text": "anonymous so here you see there are uh multiple function definitions all doing",
    "start": "663200",
    "end": "670000"
  },
  {
    "text": "the same thing taking two arguments X and Y and returning the uh you know multiplication of X and Y in the first",
    "start": "670000",
    "end": "678639"
  },
  {
    "text": "case the function is defined with a function",
    "start": "678639",
    "end": "683120"
  },
  {
    "text": "Constructor this is a regular function definition called",
    "start": "684880",
    "end": "690440"
  },
  {
    "text": "multiply and this is a function expression that is assigned to a l",
    "start": "690440",
    "end": "696320"
  },
  {
    "text": "called multiply and using an anonymous",
    "start": "696320",
    "end": "701079"
  },
  {
    "text": "function similarly there is something called interesting thing about uh in JavaScript",
    "start": "701800",
    "end": "707920"
  },
  {
    "text": "called closure closure is nothing but in one line you can Define closer as un nested",
    "start": "707920",
    "end": "715040"
  },
  {
    "text": "function so the outer function so you have function within function so you",
    "start": "715040",
    "end": "720399"
  },
  {
    "text": "have uh the outer function within the inner function together the make up a",
    "start": "720399",
    "end": "727120"
  },
  {
    "text": "closure the inner function uh the inner function can only be accessed by",
    "start": "727120",
    "end": "732560"
  },
  {
    "text": "statements within the outer function and the inner function can access arguments and variables of the outer",
    "start": "732560",
    "end": "739720"
  },
  {
    "text": "function but the vice versa is not possible so any variables within the",
    "start": "739720",
    "end": "745320"
  },
  {
    "text": "inner function is not accessible so so here you see very",
    "start": "745320",
    "end": "750519"
  },
  {
    "text": "simple uh closure it just returns takes two arguments X and Y and returns this",
    "start": "750519",
    "end": "759320"
  },
  {
    "text": "sum so here is the outer function called outside takes the argument X and this is",
    "start": "759320",
    "end": "764680"
  },
  {
    "text": "the inner function inside which takes the argument Y and returns x + y the",
    "start": "764680",
    "end": "770800"
  },
  {
    "text": "outer functions uh return this inner function so which makes a",
    "start": "770800",
    "end": "776560"
  },
  {
    "text": "closer so the the ways you can call this or do this uh statement",
    "start": "776560",
    "end": "783680"
  },
  {
    "text": "is you can call the outer function with the variable for argument for the outer",
    "start": "783680",
    "end": "789360"
  },
  {
    "text": "function and then it can whatever it returns that is this inside the inner",
    "start": "789360",
    "end": "796279"
  },
  {
    "text": "function they can pass an argument to it and it returns 8 in this case 3 + 5 8",
    "start": "796279",
    "end": "802120"
  },
  {
    "text": "you can also do it as like this you can take this outer function and pass two",
    "start": "802120",
    "end": "808519"
  },
  {
    "text": "arguments separately it also returns",
    "start": "808519",
    "end": "813720"
  },
  {
    "text": "eight okay so coming back so what I wanted to tell you here",
    "start": "817680",
    "end": "823360"
  },
  {
    "text": "is that you can see that we are just doing one simple stuff and there were",
    "start": "823360",
    "end": "830160"
  },
  {
    "text": "like multiple ways of doing it some bit easy or some simp simple and some are",
    "start": "830160",
    "end": "837600"
  },
  {
    "text": "really complex so how do you make a static analyzer that that is able to you",
    "start": "837600",
    "end": "844079"
  },
  {
    "text": "know handle all these cases really well and can figure out issues with minimum",
    "start": "844079",
    "end": "850759"
  },
  {
    "text": "and the most important thing is with less false positives and false",
    "start": "850759",
    "end": "855839"
  },
  {
    "text": "negatives so that is why I think we have a session here today",
    "start": "855839",
    "end": "863360"
  },
  {
    "text": "uh that's we will be talking about why it's a pain to write a JavaScript static",
    "start": "863360",
    "end": "871560"
  },
  {
    "text": "analyzer okay now coming back to security as the context and",
    "start": "871839",
    "end": "879079"
  },
  {
    "text": "JavaScript in my experience what I have found like when I uh in my free time",
    "start": "879600",
    "end": "884680"
  },
  {
    "text": "when I hunt for bug bounties I figured out that there are there are many uh",
    "start": "884680",
    "end": "889920"
  },
  {
    "text": "Fortune 500 companies who are very well protected they have very really good server side libraries that filter",
    "start": "889920",
    "end": "896480"
  },
  {
    "text": "against regular uh cross side scripting at attacks when I say regular I mean reflected excesses and stored excesses",
    "start": "896480",
    "end": "905399"
  },
  {
    "text": "but it's it's it's very surprising to see that Dom based exess is one such",
    "start": "905399",
    "end": "912040"
  },
  {
    "text": "variant of cross-side scripting that is present or it's very common you find it on almost every such",
    "start": "912040",
    "end": "919759"
  },
  {
    "text": "sites and this is due to the fact that JavaScript is responsible it's it",
    "start": "919759",
    "end": "926240"
  },
  {
    "text": "happens in the client side and due to insecure JavaScript programming so that's that's a problem",
    "start": "926240",
    "end": "933880"
  },
  {
    "text": "uh that we are will'll be trying to uh solve or uh figure out how we can solve",
    "start": "933880",
    "end": "939720"
  },
  {
    "text": "it and when you are writing applications in",
    "start": "939720",
    "end": "945319"
  },
  {
    "text": "nodejs it's very much possible to you know inject JavaScript and run it in context of the in this in the server",
    "start": "945319",
    "end": "952000"
  },
  {
    "text": "site uh it's pretty much similar to you know um local F inclusion or remote code",
    "start": "952000",
    "end": "958000"
  },
  {
    "text": "execution on the server",
    "start": "958000",
    "end": "960920"
  },
  {
    "text": "um okay so as I as I told",
    "start": "966600",
    "end": "973880"
  },
  {
    "text": "you um server side filtering fails for dbased excesses that I mean I I I hope",
    "start": "973880",
    "end": "981440"
  },
  {
    "text": "you all know and JavaScript code review is intimidating if you know what I mean",
    "start": "981440",
    "end": "989560"
  },
  {
    "text": "so how many of you uh I I just wanted to ask uh once again the question how many of you are uh involved in reviewing uh",
    "start": "989560",
    "end": "997199"
  },
  {
    "text": "security reviewing of JavaScript Source codes okay so uh would anybody mind",
    "start": "997199",
    "end": "1005360"
  },
  {
    "text": "telling me what how how do you do it do you do it manually or do you use some",
    "start": "1005360",
    "end": "1010759"
  },
  {
    "text": "tools like open source or commercial tools",
    "start": "1010759",
    "end": "1016000"
  },
  {
    "text": "tools tools any any would you like to name few tools",
    "start": "1016000",
    "end": "1023280"
  },
  {
    "text": "sorry GS lint okay hell Storm 45 okay and uh what what is your",
    "start": "1023280",
    "end": "1032640"
  },
  {
    "text": "satisfaction label I mean how uh how these tools perform are they really good",
    "start": "1032640",
    "end": "1038720"
  },
  {
    "text": "they um like how do they handle false positives false",
    "start": "1038720",
    "end": "1044160"
  },
  {
    "text": "negatives Fair",
    "start": "1046199",
    "end": "1050199"
  },
  {
    "text": "okay and um the reason I ask this question is because there are the",
    "start": "1051240",
    "end": "1058360"
  },
  {
    "text": "availability of so much uh libraries and uh when I when we uh scan JavaScript",
    "start": "1058360",
    "end": "1064280"
  },
  {
    "text": "source code for sourcing pairs there there are uh libraries like jqu yui",
    "start": "1064280",
    "end": "1070880"
  },
  {
    "text": "where you have some Library dependent source and syncs as compared to the pure",
    "start": "1070880",
    "end": "1076200"
  },
  {
    "text": "JavaScript Bas programs so it's really uh tricky to know maintain a track of",
    "start": "1076200",
    "end": "1082919"
  },
  {
    "text": "all these libraries and you know figure out what is the source and sync pair for",
    "start": "1082919",
    "end": "1088440"
  },
  {
    "text": "uh for each and every",
    "start": "1088440",
    "end": "1091720"
  },
  {
    "text": "Library um well as I said uh I didn't have access to many uh enough JavaScript",
    "start": "1094440",
    "end": "1101480"
  },
  {
    "text": "source code scanners so that's the reason I asked this uh question to you",
    "start": "1101480",
    "end": "1107159"
  },
  {
    "text": "guys um",
    "start": "1107159",
    "end": "1110760"
  },
  {
    "text": "okay so what is the impact of Dom best xss or server side uh script",
    "start": "1112400",
    "end": "1119600"
  },
  {
    "text": "injection I think the impact is almost same when you have a serers side uh",
    "start": "1119600",
    "end": "1125120"
  },
  {
    "text": "sorry um D excesss it's whether it's reflect or not the impact is same script",
    "start": "1125120",
    "end": "1131919"
  },
  {
    "text": "injection on server side and in mobile applications can be really lethal because it runs it it it it actually",
    "start": "1131919",
    "end": "1139200"
  },
  {
    "text": "enables remote code execution in context to that application and uh just imagine about",
    "start": "1139200",
    "end": "1144880"
  },
  {
    "text": "these uh libraries or Frameworks platforms like nodejs Firefox OS Windows",
    "start": "1144880",
    "end": "1152039"
  },
  {
    "text": "8 applications so I just like to show you some uh some of these um vulnerable",
    "start": "1152039",
    "end": "1158840"
  },
  {
    "text": "sample codes before we can U so that I can give you some context before we can",
    "start": "1158840",
    "end": "1164000"
  },
  {
    "text": "move on to know what is JS Prime and and uh what it can do or not",
    "start": "1164000",
    "end": "1173200"
  },
  {
    "text": "[Music]",
    "start": "1174040",
    "end": "1179609"
  },
  {
    "text": "okay uh so this is a pretty uh simple uh example that uh I have uh of vulnerable",
    "start": "1223919",
    "end": "1231520"
  },
  {
    "text": "code that I have written using yui so what it does it it simply you",
    "start": "1231520",
    "end": "1237600"
  },
  {
    "text": "know tracks",
    "start": "1237600",
    "end": "1241158"
  },
  {
    "text": "the the Onkey up event of this uh text box and just displays whatever you type",
    "start": "1245400",
    "end": "1254679"
  },
  {
    "text": "as simple as that now in this case if you do",
    "start": "1264320",
    "end": "1271080"
  },
  {
    "text": "something like [Music]",
    "start": "1271080",
    "end": "1274990"
  },
  {
    "text": "this so you have an [Music] xss and this is use this is a domest xss",
    "start": "1277960",
    "end": "1289240"
  },
  {
    "text": "and this is the client side script responsible for you know causing this [Music]",
    "start": "1290679",
    "end": "1297360"
  },
  {
    "text": "excesses this one is using yui I have another",
    "start": "1297360",
    "end": "1303559"
  },
  {
    "text": "one using jQuery this is also the",
    "start": "1306159",
    "end": "1311480"
  },
  {
    "text": "same example",
    "start": "1311480",
    "end": "1315480"
  },
  {
    "text": "but in this case it's using uh",
    "start": "1330600",
    "end": "1336360"
  },
  {
    "text": "JY so these are some sample you know codes are vulnerable to domas xss in",
    "start": "1336440",
    "end": "1343400"
  },
  {
    "text": "Secure uh JavaScript programming and let me go ahead uh and show show you one uh",
    "start": "1343400",
    "end": "1349720"
  },
  {
    "text": "vulnerable nodejs application that I have written using uh JavaScript sorry",
    "start": "1349720",
    "end": "1359880"
  },
  {
    "text": "okay",
    "start": "1398520",
    "end": "1401520"
  },
  {
    "text": "[Music]",
    "start": "1406190",
    "end": "1409409"
  },
  {
    "text": "uh so it's",
    "start": "1413799",
    "end": "1418799"
  },
  {
    "text": "9091 so it's a pretty basic uh nodejs application uh what it does is it's just",
    "start": "1422360",
    "end": "1428600"
  },
  {
    "text": "uh it has three functionalities you can U pass a Jon object and you can save",
    "start": "1428600",
    "end": "1435200"
  },
  {
    "text": "this uh create a profile with uh the name age gender",
    "start": "1435200",
    "end": "1443279"
  },
  {
    "text": "location you can view this profile what it does it it takes this adj object and",
    "start": "1443279",
    "end": "1448880"
  },
  {
    "text": "writes a file on the disk and then know reads it back to you",
    "start": "1448880",
    "end": "1455799"
  },
  {
    "text": "so we can delete a profile but interestingly",
    "start": "1455799",
    "end": "1462360"
  },
  {
    "text": "uh if you goe uh",
    "start": "1462360",
    "end": "1467840"
  },
  {
    "text": "look here this code is using eval so that means I can uh pass JavaScript",
    "start": "1476480",
    "end": "1483640"
  },
  {
    "text": "statements as an argument and see with",
    "start": "1483640",
    "end": "1490440"
  },
  {
    "text": "it we can create a just to save time I have just created",
    "start": "1490440",
    "end": "1497919"
  },
  {
    "text": "uh the load uh what I'll do is we'll just go",
    "start": "1497919",
    "end": "1504679"
  },
  {
    "text": "ahead and save it once again",
    "start": "1504679",
    "end": "1509960"
  },
  {
    "text": "and so if you see here with my payload I was able to uh run this command called",
    "start": "1523039",
    "end": "1528600"
  },
  {
    "text": "LS and was able to list the directory on the server similarly I can run commands",
    "start": "1528600",
    "end": "1535200"
  },
  {
    "text": "in the context of the server and and create an arbitrary code execution um",
    "start": "1535200",
    "end": "1540320"
  },
  {
    "text": "you know",
    "start": "1540320",
    "end": "1542919"
  },
  {
    "text": "condition so what we saw here is uh one second",
    "start": "1547000",
    "end": "1554000"
  },
  {
    "text": "so what we saw here was three different examples using three different uh libraries as a platforms like yui jry",
    "start": "1566559",
    "end": "1573760"
  },
  {
    "text": "and nodejs and how they can be vulnerable due to insecure Javas coding practices like turning uh U making uh",
    "start": "1573760",
    "end": "1582840"
  },
  {
    "text": "enabling uh Dom based xss server side code execution",
    "start": "1582840",
    "end": "1588360"
  },
  {
    "text": "so these are the problems that we have to solve in context to security",
    "start": "1588360",
    "end": "1595320"
  },
  {
    "text": "so let me introduce here JS Prime so what is JS Prime it's it's a",
    "start": "1595320",
    "end": "1604840"
  },
  {
    "text": "pretty lightweight uh source code scanner for identifying security issues using static",
    "start": "1604840",
    "end": "1612279"
  },
  {
    "text": "analysis it's a tool written in JavaScript to analyze JavaScript",
    "start": "1612279",
    "end": "1619960"
  },
  {
    "text": "and uh it uses the open-source uh JavaScript parser ecmascript parser called",
    "start": "1620080",
    "end": "1627440"
  },
  {
    "text": "espra um and who is it uh meant",
    "start": "1628960",
    "end": "1636360"
  },
  {
    "text": "for JS Prime is uh from the day we started uh working on this project we we",
    "start": "1636360",
    "end": "1643679"
  },
  {
    "text": "were uh sure of one thing we were actually focused towards",
    "start": "1643679",
    "end": "1648960"
  },
  {
    "text": "uh making this tool developer Centric so that they can uh use this tool while",
    "start": "1648960",
    "end": "1654039"
  },
  {
    "text": "writing the code it it can be also used by security",
    "start": "1654039",
    "end": "1659080"
  },
  {
    "text": "reviewers or uh code reviewers as a first pass of in identifying security Us",
    "start": "1659080",
    "end": "1664559"
  },
  {
    "text": "in JavaScript code and Security Professionals Also may find it useful during their P",
    "start": "1664559",
    "end": "1670480"
  },
  {
    "text": "penetration testing engagements uh but uh some of the niche uh you know functionalities or features uh that has",
    "start": "1670480",
    "end": "1678360"
  },
  {
    "text": "you identify issues on the Fly that Security Professionals might uh require",
    "start": "1678360",
    "end": "1684279"
  },
  {
    "text": "may not be present in this version but it's it's in this right in this version it's more focused towards",
    "start": "1684279",
    "end": "1692200"
  },
  {
    "text": "developers so before I uh go ahead and give you a demo of the tool I just wanted to uh briefly run you through and",
    "start": "1693159",
    "end": "1699399"
  },
  {
    "text": "give you an overall uh idea about how this [Music]",
    "start": "1699399",
    "end": "1704720"
  },
  {
    "text": "works so as I said we are using the open source uh JavaScript uh parser called",
    "start": "1704720",
    "end": "1712080"
  },
  {
    "text": "espra to generate the as or the abstract syntax table I'll just go ahead and uh",
    "start": "1712080",
    "end": "1718080"
  },
  {
    "text": "give you a demo of how this uh",
    "start": "1718080",
    "end": "1724039"
  },
  {
    "text": "espra EST look like so how many of you are familiar",
    "start": "1724039",
    "end": "1729880"
  },
  {
    "text": "with espra okay so espra is a very pretty",
    "start": "1729880",
    "end": "1738679"
  },
  {
    "text": "interesting JavaScript parser um it's written by a guy called Arya",
    "start": "1738679",
    "end": "1744559"
  },
  {
    "text": "hiat and it's written in JavaScript so you can use it uh run it in the browser",
    "start": "1744559",
    "end": "1750320"
  },
  {
    "text": "as well as it has a a port of nodejs so you can run it on the server",
    "start": "1750320",
    "end": "1756919"
  },
  {
    "text": "side so it has a very basic so this is uh online demo of this",
    "start": "1757880",
    "end": "1764640"
  },
  {
    "text": "parser so you see a very uh simple on line state M we have a variable called",
    "start": "1764640",
    "end": "1771159"
  },
  {
    "text": "answer and it's assigned the multiplication of 6 and 8 and the",
    "start": "1771159",
    "end": "1777360"
  },
  {
    "text": "abstract syntax tree that espra generates looks something like",
    "start": "1777360",
    "end": "1782880"
  },
  {
    "text": "this so what it does it it abstracts all these uh you know tricky",
    "start": "1791120",
    "end": "1798640"
  },
  {
    "text": "coding style of developers and just represents um a Json object of of of of",
    "start": "1798640",
    "end": "1807600"
  },
  {
    "text": "the code and it it has a very uh Parable uh Json object so that we can actually",
    "start": "1807600",
    "end": "1814480"
  },
  {
    "text": "pick up like what are the variable declarators variable names and the Expressions happening so what we do is",
    "start": "1814480",
    "end": "1822200"
  },
  {
    "text": "we take this Json object and it also Returns the you know um line number and",
    "start": "1822200",
    "end": "1829200"
  },
  {
    "text": "column number so that if you want to you know do some syntax highlighting stuff",
    "start": "1829200",
    "end": "1835120"
  },
  {
    "text": "and it it's being used in by some popular in browser uh JavaScript IDs uh",
    "start": "1835120",
    "end": "1840880"
  },
  {
    "text": "one of uh one of my most favorite is the Cloud9 uh JS ID they also use this uh",
    "start": "1840880",
    "end": "1850279"
  },
  {
    "text": "parser so we didn't try to write uh our own parsel because it's uh we know that",
    "start": "1851799",
    "end": "1858000"
  },
  {
    "text": "that it's very tough you can just select this option to see the line number and column number of",
    "start": "1858000",
    "end": "1864480"
  },
  {
    "text": "the particular [Music] statements okay so that was es Prima now",
    "start": "1864480",
    "end": "1872240"
  },
  {
    "text": "what we do with it once we take the JavaScript snippet or the code snippet code block we feed",
    "start": "1872240",
    "end": "1879320"
  },
  {
    "text": "it to espra and we generate the ASD the Json object that I just showed you we",
    "start": "1879320",
    "end": "1886720"
  },
  {
    "text": "then pass the Json uh as to locate all sources uh I'm I'm sure all of you are",
    "start": "1886720",
    "end": "1894519"
  },
  {
    "text": "aware of the sources and syncs in context to JavaScript uh Dom accss so",
    "start": "1894519",
    "end": "1900480"
  },
  {
    "text": "I'll just uh give a small um introduction to sources so any Dom apis",
    "start": "1900480",
    "end": "1907880"
  },
  {
    "text": "or any uh apis in JavaScript that actually takes uh data that that can be",
    "start": "1907880",
    "end": "1913880"
  },
  {
    "text": "manipulated by the user or that takes user data we call it as source so that's how the xss can arise so if",
    "start": "1913880",
    "end": "1922919"
  },
  {
    "text": "you call those you know apis you can um actually take user data",
    "start": "1922919",
    "end": "1929120"
  },
  {
    "text": "for example uh one of the most common example is the location. has object so",
    "start": "1929120",
    "end": "1934360"
  },
  {
    "text": "it takes anything after the URL fragment the hash so that that part is U",
    "start": "1934360",
    "end": "1939600"
  },
  {
    "text": "modifiable by the user you can the user can tamper with it and that's what the",
    "start": "1939600",
    "end": "1944880"
  },
  {
    "text": "um we call it a source so we locates all such so I'll show you a list of sources",
    "start": "1944880",
    "end": "1950039"
  },
  {
    "text": "and syncs uh that we have that we are using so it it takes all the sources",
    "start": "1950039",
    "end": "1956919"
  },
  {
    "text": "including passing um within the objects objects that are defined within the code",
    "start": "1956919",
    "end": "1962360"
  },
  {
    "text": "blocks and pro prototype based assignments and keeping track of their",
    "start": "1962360",
    "end": "1967519"
  },
  {
    "text": "Scopes so we we know so this is a scope aware analysis so we track the scope of",
    "start": "1967519",
    "end": "1973519"
  },
  {
    "text": "these objects or the apis of the statements and uh for for our next steps",
    "start": "1973519",
    "end": "1980120"
  },
  {
    "text": "then thirdly what we do is we pass the as to locate all",
    "start": "1980120",
    "end": "1986320"
  },
  {
    "text": "assignment operations so for example there might be code Snippets where direct assignment from source to sync is",
    "start": "1986320",
    "end": "1992600"
  },
  {
    "text": "is not happening what they are doing is they're taking an intermediary uh step where the Dom API is assigned to another",
    "start": "1992600",
    "end": "2000360"
  },
  {
    "text": "variable third party variable and that variable goes to sync so that's we all",
    "start": "2000360",
    "end": "2005519"
  },
  {
    "text": "keep track of of those assignment as",
    "start": "2005519",
    "end": "2010120"
  },
  {
    "text": "well also keeping track of the Scopes with then uh pass the EST again",
    "start": "2010639",
    "end": "2017880"
  },
  {
    "text": "to locate all syns and sync leases now when I say sync uh sinks are",
    "start": "2017880",
    "end": "2025519"
  },
  {
    "text": "those functions or assignments which make uh this uh code execution possible for example one of the most common sync",
    "start": "2025519",
    "end": "2032519"
  },
  {
    "text": "is eval now if you pass anything uh with to eval and that any is user",
    "start": "2032519",
    "end": "2039440"
  },
  {
    "text": "controllable that can cause code execution now there might be cases where",
    "start": "2039440",
    "end": "2045480"
  },
  {
    "text": "user input is not being directly passed to eval but we we have created an L for eval so for example say x is equal to",
    "start": "2045480",
    "end": "2053079"
  },
  {
    "text": "eval now we are passing something into X now X is not eval I mean uh if you if",
    "start": "2053079",
    "end": "2060200"
  },
  {
    "text": "you read it um in the code X is not evil but in runtime X is",
    "start": "2060200",
    "end": "2066200"
  },
  {
    "text": "evil so we track all uh again keeping their scope uh keeping a track of their",
    "start": "2066200",
    "end": "2072960"
  },
  {
    "text": "scope then we move on and find or locate functions including closures Anonymous",
    "start": "2072960",
    "end": "2079750"
  },
  {
    "text": "[Music] functions which are fed with uh sources",
    "start": "2079750",
    "end": "2085200"
  },
  {
    "text": "as arguments we find functions where uh sources has been passed as an",
    "start": "2085200",
    "end": "2090240"
  },
  {
    "text": "arguments and while keeping track of the return values if the function is returning something uh we we keep track",
    "start": "2090240",
    "end": "2096800"
  },
  {
    "text": "whether it's returning the source as it is or it's returning the function whatever it's returning we we keep a",
    "start": "2096800",
    "end": "2105200"
  },
  {
    "text": "track now once we have collected so uh all these data structures are there with",
    "start": "2105200",
    "end": "2110640"
  },
  {
    "text": "us all all these information or metadata are with us what we then do",
    "start": "2110640",
    "end": "2117240"
  },
  {
    "text": "is we see if any filter functions are applied on these uh sources or or",
    "start": "2117480",
    "end": "2126280"
  },
  {
    "text": "directly over the sources or when or before the source is being passed to uh the syns now when I say filter functions",
    "start": "2126280",
    "end": "2133599"
  },
  {
    "text": "filter functions are nothing but uh functions that are written or that are called to avoid excesses or avoid such",
    "start": "2133599",
    "end": "2141119"
  },
  {
    "text": "security issues for example a um uh like say filter function you you",
    "start": "2141119",
    "end": "2147880"
  },
  {
    "text": "have you rem you write a function that actually removes or strips out all those",
    "start": "2147880",
    "end": "2152960"
  },
  {
    "text": "uh you know special characters that can cause excesses uh so some libraries do offer such",
    "start": "2152960",
    "end": "2160920"
  },
  {
    "text": "filter functions natively one is uh with yui we have the Escape uh uh you know uh",
    "start": "2160920",
    "end": "2168760"
  },
  {
    "text": "object uh Escape class where we have the HTML escape. HTML which actually filters",
    "start": "2168760",
    "end": "2174680"
  },
  {
    "text": "out all meta characters that can be dangerous in context to HTML similarly uh the encode URI",
    "start": "2174680",
    "end": "2183160"
  },
  {
    "text": "component decode URI component encode URI component can be uh treated as filter function when you're actually",
    "start": "2183160",
    "end": "2189680"
  },
  {
    "text": "passing uh sources in context to URL so for example you're setting it to an",
    "start": "2189680",
    "end": "2195240"
  },
  {
    "text": "iframes source so in that context if you're actually um passing something",
    "start": "2195240",
    "end": "2200400"
  },
  {
    "text": "like the JavaScript colog Alert document. cooki in that case if you apply uh encode URI component in that",
    "start": "2200400",
    "end": "2207040"
  },
  {
    "text": "case uh it it will not be a issue anymore so we we we keep track of those",
    "start": "2207040",
    "end": "2213240"
  },
  {
    "text": "uh filter uh functions and I'll I I I'll tell you how this uh how we fit these",
    "start": "2213240",
    "end": "2218359"
  },
  {
    "text": "filter functions uh uh you can U pass your own custom filter functions as",
    "start": "2218359",
    "end": "2225920"
  },
  {
    "text": "well now once we have done up to this what we do is we do the same process all these",
    "start": "2225920",
    "end": "2233400"
  },
  {
    "text": "steps in the backward Direction so first we did it in a top down Direction then",
    "start": "2233400",
    "end": "2238480"
  },
  {
    "text": "we uh move backwards in a bottom up approach so that we want to just be",
    "start": "2238480",
    "end": "2243880"
  },
  {
    "text": "double sure that we reach the exact Source if we start from this sync again so that just to avoid false",
    "start": "2243880",
    "end": "2252200"
  },
  {
    "text": "positives and then once we confirm that this particular uh data flow or this particular control flow is actually is",
    "start": "2252680",
    "end": "2260160"
  },
  {
    "text": "responsible will create a xss condition we then uh report them uh in a",
    "start": "2260160",
    "end": "2267480"
  },
  {
    "text": "by collecting the line numbers in this version we are not",
    "start": "2267480",
    "end": "2273280"
  },
  {
    "text": "actually uh reporting their uh the column numbers of the line we're not just highlighting the variable",
    "start": "2273280",
    "end": "2280000"
  },
  {
    "text": "names or the syncs but we are just reporting the line numbers Al",
    "start": "2280000",
    "end": "2285880"
  },
  {
    "text": "together okay so these are some of the color codes that we using in um in the report so we have an orange color uh so",
    "start": "2286720",
    "end": "2294640"
  },
  {
    "text": "I I'll just give you a demo so this will make more sense then but uh just for an heads up that the orange color is an",
    "start": "2294640",
    "end": "2301000"
  },
  {
    "text": "active source so if we figure out that there is a source which is reaching a",
    "start": "2301000",
    "end": "2306200"
  },
  {
    "text": "sync uh it is making up a pair for creating an xss or a code execution we",
    "start": "2306200",
    "end": "2311599"
  },
  {
    "text": "Mark that Source line as in orange color and if it is a source but it is it",
    "start": "2311599",
    "end": "2317359"
  },
  {
    "text": "is it is unused I mean it's it could not reach a sync we color it as",
    "start": "2317359",
    "end": "2325000"
  },
  {
    "text": "brown uh and if it is a source and it has been assigned to some other variables which are not again used we",
    "start": "2325640",
    "end": "2333240"
  },
  {
    "text": "mark them as gray active Source assignments for for example we have a location. hash which",
    "start": "2333240",
    "end": "2339520"
  },
  {
    "text": "is reaching uh to eval via a uh third step say x is equal to um um there is a",
    "start": "2339520",
    "end": "2347560"
  },
  {
    "text": "third intermediary assignment we mark them as a in yellow color which an",
    "start": "2347560",
    "end": "2354119"
  },
  {
    "text": "active Source assignment red is uh the sync if we find that there is a source",
    "start": "2354119",
    "end": "2359800"
  },
  {
    "text": "sync pair that's causing a execution we Mark that sink as red and pink color is",
    "start": "2359800",
    "end": "2366400"
  },
  {
    "text": "for functions that lead to syncs I mean that are uh I mean function arguments",
    "start": "2366400",
    "end": "2371960"
  },
  {
    "text": "which actually take uh the functions which take arguments and pass it to the syns we mark them as in pink",
    "start": "2371960",
    "end": "2378920"
  },
  {
    "text": "colors okay so what is uh what JS Prime can do",
    "start": "2381960",
    "end": "2387839"
  },
  {
    "text": "it can follow uh code execution order I I'll show you in the demo of these points it can handle first class",
    "start": "2387839",
    "end": "2394520"
  },
  {
    "text": "functions the I have mentioned it earlier it can analyze prototype based",
    "start": "2394520",
    "end": "2400079"
  },
  {
    "text": "inheritance it can understand type casting it understands context based",
    "start": "2400079",
    "end": "2406400"
  },
  {
    "text": "filter functions uh it has to be manually fed though you have to manually configure",
    "start": "2406400",
    "end": "2412079"
  },
  {
    "text": "it uh it has Library aware sources and syns so far we are supporting just for",
    "start": "2412079",
    "end": "2417800"
  },
  {
    "text": "yui and jQuery it has a scope aware analysis for",
    "start": "2417800",
    "end": "2424040"
  },
  {
    "text": "variables objects and functions so that we have you have less false positives it has control flow analysis",
    "start": "2424040",
    "end": "2431280"
  },
  {
    "text": "and data flow",
    "start": "2431280",
    "end": "2434160"
  },
  {
    "text": "analysis what it cannot do JS Prime alone cannot detect 100% of",
    "start": "2436920",
    "end": "2443160"
  },
  {
    "text": "the issues like for with any other tool it cannot uh it uh learn sources and",
    "start": "2443160",
    "end": "2449760"
  },
  {
    "text": "syns automatically you have to uh provide them if you're using a very custom Library it cannot handle off",
    "start": "2449760",
    "end": "2457440"
  },
  {
    "text": "first skitted JavaScript like in case of malwares or something it can't report issues in",
    "start": "2457440",
    "end": "2464040"
  },
  {
    "text": "minified JavaScript unless beautified so there's a uh catch here it can analyze",
    "start": "2464040",
    "end": "2471079"
  },
  {
    "text": "uh you know minified JavaScript but since minified JavaScript is nothing but in in one line so it cannot actually",
    "start": "2471079",
    "end": "2477960"
  },
  {
    "text": "report the issue because it will report in report that that's line one has issue line one has source and sync so you need",
    "start": "2477960",
    "end": "2485560"
  },
  {
    "text": "to beautify it so that you can you'll be able to understand the",
    "start": "2485560",
    "end": "2490880"
  },
  {
    "text": "report and it cannot uh actually uh analyze dynamically generated JavaScript",
    "start": "2490880",
    "end": "2497280"
  },
  {
    "text": "using eval so if you are constructing JavaScript or if you're executing uh",
    "start": "2497280",
    "end": "2502760"
  },
  {
    "text": "JavaScript statements using eval so it's it's not uh in this version it's not uh",
    "start": "2502760",
    "end": "2508079"
  },
  {
    "text": "possible yet but we are working on it what about stability and",
    "start": "2508079",
    "end": "2514599"
  },
  {
    "text": "automation uh so far we have benchmarked that uh up to 1,500 lines of code uh",
    "start": "2514599",
    "end": "2520000"
  },
  {
    "text": "this tool can handle in a single scan um it it might be able to scan a",
    "start": "2520000",
    "end": "2527040"
  },
  {
    "text": "bit longer uh JavaScript but this was the longest Javascript file uh we had to",
    "start": "2527040",
    "end": "2533960"
  },
  {
    "text": "test with us uh we do have a nodejs port so that you can run it on the backend",
    "start": "2533960",
    "end": "2540319"
  },
  {
    "text": "server for a large scale automation you can um you know pass JavaScript files uh",
    "start": "2540319",
    "end": "2546800"
  },
  {
    "text": "I mean sorry JavaScript codes and it can return you results you can make it as a",
    "start": "2546800",
    "end": "2551920"
  },
  {
    "text": "web service actually to integrate in your uh continuous integration environment in Enterprise application uh",
    "start": "2551920",
    "end": "2558640"
  },
  {
    "text": "environment and it's actually a lot dependent on esa's uh",
    "start": "2558640",
    "end": "2564559"
  },
  {
    "text": "robustness and it can be the first point valure so we have seen uh some uh",
    "start": "2564559",
    "end": "2570680"
  },
  {
    "text": "JavaScript files where espra itself is unable to pass or it you know uh breaks",
    "start": "2570680",
    "end": "2578200"
  },
  {
    "text": "so in this case we are since we are dependent upon the as that es Prima",
    "start": "2578200",
    "end": "2583280"
  },
  {
    "text": "generates we are not able to know go",
    "start": "2583280",
    "end": "2587680"
  },
  {
    "text": "further okay so time for",
    "start": "2589559",
    "end": "2594640"
  },
  {
    "text": "demo what uh we have here",
    "start": "2600839",
    "end": "2605800"
  },
  {
    "text": "is he",
    "start": "2606119",
    "end": "2610200"
  },
  {
    "text": "oops okay so uh this is the uh web version of uh JS Prime this look looks",
    "start": "2641480",
    "end": "2648319"
  },
  {
    "text": "something like this so you have a um you know code editor you can paste your",
    "start": "2648319",
    "end": "2654079"
  },
  {
    "text": "JavaScript uh",
    "start": "2654079",
    "end": "2656880"
  },
  {
    "text": "Snippets so if you guys are wondering like how you can scan multiple files because it's just a code editor so I'll",
    "start": "2662040",
    "end": "2668599"
  },
  {
    "text": "come to that in a minute",
    "start": "2668599",
    "end": "2674920"
  },
  {
    "text": "um okay uh so you remember the first example that I showed you and that I",
    "start": "2681040",
    "end": "2686079"
  },
  {
    "text": "have that I coded in yui so this is the script function what I'll do is uh",
    "start": "2686079",
    "end": "2694960"
  },
  {
    "text": "I'll just paste it here and I'll try to run",
    "start": "2704319",
    "end": "2710599"
  },
  {
    "text": "scan thank you Mr curly Cur",
    "start": "2715000",
    "end": "2720599"
  },
  {
    "text": "okay so you see here uh this is how it the report looks",
    "start": "2744480",
    "end": "2749800"
  },
  {
    "text": "like this set HTML is a yui specific sync so it was able to",
    "start": "2749800",
    "end": "2757760"
  },
  {
    "text": "uh this script and let's figure out that here we have taken uh this something uh",
    "start": "2757760",
    "end": "2762800"
  },
  {
    "text": "this is again a yui specific uh source which takes uh so you have",
    "start": "2762800",
    "end": "2769599"
  },
  {
    "text": "a a text box text email and it takes the value and and you know passes it to the",
    "start": "2769599",
    "end": "2776960"
  },
  {
    "text": "div so it it was able to you know detect the",
    "start": "2776960",
    "end": "2782318"
  },
  {
    "text": "xss um I'll just go ahead and show you something uh like",
    "start": "2784319",
    "end": "2789839"
  },
  {
    "text": "this so uh that was a simple",
    "start": "2789839",
    "end": "2794960"
  },
  {
    "text": "example let us go ahead here and I'll just try to P something like this so",
    "start": "2794960",
    "end": "2801920"
  },
  {
    "text": "this is a SW short snippet but it's kind of uh a little bit more complicated in",
    "start": "2801920",
    "end": "2807480"
  },
  {
    "text": "the first one what I've done here is uh there are two",
    "start": "2807480",
    "end": "2812559"
  },
  {
    "text": "functions one is uh called as time message and the second one is called called",
    "start": "2812559",
    "end": "2818160"
  },
  {
    "text": "fire now fire uh when you uh call this function it takes the location. hash and",
    "start": "2818160",
    "end": "2825680"
  },
  {
    "text": "passes it to it has an assignment to call and call is passed as an argument",
    "start": "2825680",
    "end": "2831400"
  },
  {
    "text": "to time message which is defined earlier and this becomes the argument and it's",
    "start": "2831400",
    "end": "2837599"
  },
  {
    "text": "passed to something called eval now this is a pretty uh simple",
    "start": "2837599",
    "end": "2843359"
  },
  {
    "text": "example of Dom xss if you see here this it it reports the",
    "start": "2843359",
    "end": "2850400"
  },
  {
    "text": "first line uh the active Source call and it's uh the pink color shows",
    "start": "2850400",
    "end": "2858079"
  },
  {
    "text": "the source pass being passed through a uh function and finally the uh sync",
    "start": "2858079",
    "end": "2865160"
  },
  {
    "text": "which is eval now interesting thing to know I mean to uh notice in this report here is it is actually following the",
    "start": "2865160",
    "end": "2872040"
  },
  {
    "text": "code execution order if you look here though the sync was present in line",
    "start": "2872040",
    "end": "2878359"
  },
  {
    "text": "number three it's not reported in line number three I mean first line is",
    "start": "2878359",
    "end": "2884559"
  },
  {
    "text": "reported is line number eight here which means that it actually followed the code",
    "start": "2884559",
    "end": "2891839"
  },
  {
    "text": "execution order and took the source from here then it went to time message which",
    "start": "2891839",
    "end": "2898079"
  },
  {
    "text": "is being we pass we are passing argument to time message and then it reported line number",
    "start": "2898079",
    "end": "2904200"
  },
  {
    "text": "nine the next line that was executed and finally it went all the way up to the uh",
    "start": "2904200",
    "end": "2909760"
  },
  {
    "text": "to the top and reported the sync so line number three is reported at the",
    "start": "2909760",
    "end": "2915640"
  },
  {
    "text": "end so now let us modify this source code a little bit let us take uh two arguments here",
    "start": "2915640",
    "end": "2924319"
  },
  {
    "text": "say AB BC and uh let us pass call to the second",
    "start": "2924319",
    "end": "2929920"
  },
  {
    "text": "as a second argument and let us pass a string say 12",
    "start": "2929920",
    "end": "2937680"
  },
  {
    "text": "you see that it reported the sink but what it reported here is it's a non-active source that",
    "start": "2947040",
    "end": "2954000"
  },
  {
    "text": "means the source was not reaching the sink but if you do a swap of these",
    "start": "2954000",
    "end": "2964000"
  },
  {
    "text": "values",
    "start": "2964000",
    "end": "2967000"
  },
  {
    "text": "it was again it's again orange it shows that it's an active Source now it reached the",
    "start": "2974359",
    "end": "2981680"
  },
  {
    "text": "sink now what happens if I make call as",
    "start": "2982880",
    "end": "2988040"
  },
  {
    "text": "a string instead of a literal",
    "start": "2988040",
    "end": "2992280"
  },
  {
    "text": "again it was able to identify that call is it's it's not actually gripping but",
    "start": "3000520",
    "end": "3006599"
  },
  {
    "text": "it's able it was able to identify that call is actually a literal and U so uh",
    "start": "3006599",
    "end": "3011720"
  },
  {
    "text": "it's it's a string it's not a literal actually so let us move on to some more",
    "start": "3011720",
    "end": "3017400"
  },
  {
    "text": "interesting examples or say test cases okay this one this is a very uh typical uh example",
    "start": "3017400",
    "end": "3026000"
  },
  {
    "text": "of uh redirects developers",
    "start": "3026000",
    "end": "3031000"
  },
  {
    "text": "do so we have a function called reload and uh there is a variable called read red which takes the location. hash so",
    "start": "3031720",
    "end": "3038920"
  },
  {
    "text": "when anything that is after the hash uh so if you have passed an URL your page the page will redirect to redirect you",
    "start": "3038920",
    "end": "3045160"
  },
  {
    "text": "to that URL so and the Sync here is set attribute but the interesting thing to note here is set attribute itself is not",
    "start": "3045160",
    "end": "3052079"
  },
  {
    "text": "a sync if you pass the variable to set attribute and set the attribute is",
    "start": "3052079",
    "end": "3058480"
  },
  {
    "text": "Source only then it becomes a sync so in this case and uh and the uh element is",
    "start": "3058480",
    "end": "3065480"
  },
  {
    "text": "an i frame so let me just put it here and run",
    "start": "3065480",
    "end": "3072000"
  },
  {
    "text": "okay so you see the orange color again so this is the uh line it took the it is the source and it found the uh syn but",
    "start": "3072000",
    "end": "3080440"
  },
  {
    "text": "let me just uh know change this to something say ID which which is not an",
    "start": "3080440",
    "end": "3086200"
  },
  {
    "text": "exploit able uh",
    "start": "3086200",
    "end": "3089838"
  },
  {
    "text": "issue see see here it's it's not an active Source anymore no syns are",
    "start": "3092160",
    "end": "3099200"
  },
  {
    "text": "reported so uh I'll just go ahead and",
    "start": "3101599",
    "end": "3108680"
  },
  {
    "text": "uh uh okay so this is the Prototype based inheritance uh that I was talking",
    "start": "3111559",
    "end": "3117880"
  },
  {
    "text": "about it's also able to analyze this so we just",
    "start": "3117880",
    "end": "3125920"
  },
  {
    "text": "uh so see here we have a function called template which is a class and we are",
    "start": "3127799",
    "end": "3132839"
  },
  {
    "text": "defining a uh prototype called exec and assigning eval",
    "start": "3132839",
    "end": "3137880"
  },
  {
    "text": "to it so it becomes an LS and then we have another uh attribute called parm",
    "start": "3137880",
    "end": "3143240"
  },
  {
    "text": "which is actually taking the source we have a new class called clone which is inherited from this uh template from the",
    "start": "3143240",
    "end": "3150920"
  },
  {
    "text": "template class and we are creating a new instance called XY and then we are",
    "start": "3150920",
    "end": "3159240"
  },
  {
    "text": "calling xy. exact and passing the param uh which is nothing but the",
    "start": "3159240",
    "end": "3165119"
  },
  {
    "text": "source yeah so you see the orange color and the source is able to pass through",
    "start": "3166280",
    "end": "3171839"
  },
  {
    "text": "and it was able to track down that it's uh actually a xss condition",
    "start": "3171839",
    "end": "3178440"
  },
  {
    "text": "so this is a bit more complex so this this is an uh xss",
    "start": "3179720",
    "end": "3185480"
  },
  {
    "text": "that was caused with uh document.",
    "start": "3185480",
    "end": "3190960"
  },
  {
    "text": "cookie just ref it once more so there is uh this variable CK",
    "start": "3191119",
    "end": "3198280"
  },
  {
    "text": "holds the document. cookie and we have a function called get cookie which basically reads the cookie values and uh",
    "start": "3198280",
    "end": "3205079"
  },
  {
    "text": "there's a cookie called r so this was taken from a live site we have a portal",
    "start": "3205079",
    "end": "3210200"
  },
  {
    "text": "called rediff.com which is a very popular portal in India so they had a xss which is now fixed so this is the",
    "start": "3210200",
    "end": "3217680"
  },
  {
    "text": "code responsible for causing that xss there and uh this cookie value is being",
    "start": "3217680",
    "end": "3222720"
  },
  {
    "text": "passed to an inner HTML which is a",
    "start": "3222720",
    "end": "3226760"
  },
  {
    "text": "sync okay so just okay you see uh this is the active",
    "start": "3230400",
    "end": "3235559"
  },
  {
    "text": "Source document cookie and if we go down bottom we see that uh active sync found",
    "start": "3235559",
    "end": "3242799"
  },
  {
    "text": "uh inner HTML the it was",
    "start": "3242799",
    "end": "3247799"
  },
  {
    "text": "assigned so I have another uh example to show you that I found uh in uh during my",
    "start": "3248079",
    "end": "3256520"
  },
  {
    "text": "one of my um",
    "start": "3256520",
    "end": "3261440"
  },
  {
    "text": "so this was an xss uh that I found in",
    "start": "3271240",
    "end": "3276000"
  },
  {
    "text": "PayPal so I'll just go ahead and uh now let this scan this",
    "start": "3276480",
    "end": "3286599"
  },
  {
    "text": "code so yeah it was it it's able to you know scan so the use case here was they",
    "start": "3286920",
    "end": "3293160"
  },
  {
    "text": "were allowing U you know uploading a file name I mean a file um and that file",
    "start": "3293160",
    "end": "3299079"
  },
  {
    "text": "name fill was uh taken from this value and uh it was being passed uh to Inner",
    "start": "3299079",
    "end": "3305839"
  },
  {
    "text": "HTML which was creating the xss condition okay so there are more uh",
    "start": "3305839",
    "end": "3312480"
  },
  {
    "text": "complex uh test cases just that we are running out of",
    "start": "3312480",
    "end": "3320559"
  },
  {
    "text": "time okay okay so that was a brief introduction of how this two tool works",
    "start": "3321160",
    "end": "3327079"
  },
  {
    "text": "and uh how it can uh um follow these uh",
    "start": "3327079",
    "end": "3332559"
  },
  {
    "text": "JavaScript features so what is the road map for this project uh we are working on",
    "start": "3332559",
    "end": "3338760"
  },
  {
    "text": "improving the performance and stability uh we are trying to focus on multiple file",
    "start": "3338760",
    "end": "3345640"
  },
  {
    "text": "scanning nodejs uh project scanning okay I I just uh forget to show you one more",
    "start": "3345640",
    "end": "3353160"
  },
  {
    "text": "thing",
    "start": "3353160",
    "end": "3356160"
  },
  {
    "text": "uh if we go",
    "start": "3358920",
    "end": "3362318"
  },
  {
    "text": "here okay",
    "start": "3369359",
    "end": "3373359"
  },
  {
    "text": "okay so this is the uh uh nodejs application that I showed you in the beginning so this is uh tool is also",
    "start": "3392559",
    "end": "3399400"
  },
  {
    "text": "able to scan uh nodejs uh code and you see here is that we are",
    "start": "3399400",
    "end": "3405760"
  },
  {
    "text": "taking uh um the one of the arguments URL arguments and we are passing and is",
    "start": "3405760",
    "end": "3411880"
  },
  {
    "text": "being passed to eval so yeah just to give you a uh um example of how we can",
    "start": "3411880",
    "end": "3418640"
  },
  {
    "text": "scan nodejs code as well nodejs",
    "start": "3418640",
    "end": "3423440"
  },
  {
    "text": "projects uh okay and uh we also planning to have an ID uh ID plugin for say",
    "start": "3425319",
    "end": "3433680"
  },
  {
    "text": "notepad JS or webstorm or whatever is your favorite ID uh more Library support",
    "start": "3433680",
    "end": "3439839"
  },
  {
    "text": "u in addition to yui and jQuery and uh support for uh string",
    "start": "3439839",
    "end": "3444960"
  },
  {
    "text": "manipulation simulation and of course your suggestions if you have any",
    "start": "3444960",
    "end": "3452079"
  },
  {
    "text": "um so the summary is it's an actively uh work in progress uh we have a promising",
    "start": "3452079",
    "end": "3458119"
  },
  {
    "text": "road map um so we are we we committed in making it um even more better um it's",
    "start": "3458119",
    "end": "3465160"
  },
  {
    "text": "open source today so you can just go ahead and uh check out the code and uh",
    "start": "3465160",
    "end": "3470720"
  },
  {
    "text": "we have the we have a nodejs port as well so I'll just uh go ahead and show you",
    "start": "3470720",
    "end": "3478119"
  },
  {
    "text": "[Music]",
    "start": "3478630",
    "end": "3481709"
  },
  {
    "text": "okay so by default this runs on 127",
    "start": "3498599",
    "end": "3504720"
  },
  {
    "text": "so here you go you have something like sayare is equal to loc location.",
    "start": "3506599",
    "end": "3514119"
  },
  {
    "text": "hash and then you pass it to",
    "start": "3514119",
    "end": "3518519"
  },
  {
    "text": "eval and so the UI is not that much fancy in the nodejs version but you you",
    "start": "3520720",
    "end": "3526520"
  },
  {
    "text": "get the idea so you can just take it and make it as a web service and run it as an a large scale um environment",
    "start": "3526520",
    "end": "3535599"
  },
  {
    "text": "so just to wrap up uh it's there on um one more thing we",
    "start": "3536440",
    "end": "3544079"
  },
  {
    "text": "have github.com /dp",
    "start": "3544079",
    "end": "3550280"
  },
  {
    "text": "Nishan so here you have Gs Prime you can just",
    "start": "3551480",
    "end": "3557078"
  },
  {
    "text": "download source code and uh yeah this is what this JS Prime",
    "start": "3557720",
    "end": "3565119"
  },
  {
    "text": "source code looks like so you can just specify uh your sources and syns right and uh you can",
    "start": "3565119",
    "end": "3572599"
  },
  {
    "text": "like mention like uh syns with conditional uh conditional syncs like",
    "start": "3572599",
    "end": "3578760"
  },
  {
    "text": "whether you have set attribute when you have HF or SRC and similarly you can write filter functions like we have for",
    "start": "3578760",
    "end": "3585319"
  },
  {
    "text": "esape HTML and code U component okay",
    "start": "3585319",
    "end": "3591760"
  },
  {
    "text": "so I just wanted to thank uh these guys Arya hiat Paul trial bishan Singh and",
    "start": "3591760",
    "end": "3599160"
  },
  {
    "text": "RAF Bach any questions",
    "start": "3599160",
    "end": "3604720"
  }
]