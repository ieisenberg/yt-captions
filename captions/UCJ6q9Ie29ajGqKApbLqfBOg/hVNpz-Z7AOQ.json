[
  {
    "text": "[Music]",
    "start": "180",
    "end": "3310"
  },
  {
    "text": "[Music]",
    "start": "11370",
    "end": "14469"
  },
  {
    "text": "welcome to black hat window security conference 2002 held February 7th through the 9th in New Orleans",
    "start": "17359",
    "end": "24480"
  },
  {
    "text": "Louisiana the following videotape was recorded live at the conference and produced by the sound of knowledge",
    "start": "24480",
    "end": "30980"
  },
  {
    "text": "[Music]",
    "start": "30980",
    "end": "40000"
  },
  {
    "text": "Incorporated it for Windows considering where at the last presentation during Marty gr I would say",
    "start": "40000",
    "end": "47079"
  },
  {
    "text": "that I'm impressed at the size of the audience welcome and thank you very much for coming my name is Todd Fineman work",
    "start": "47079",
    "end": "52879"
  },
  {
    "text": "for Price waterhous Coopers along here with David Goldman and Joon no Sarah and",
    "start": "52879",
    "end": "58039"
  },
  {
    "text": "we are managing the Windows security practice at Price waterhous Coopers for those of you who don't know what price waterhous Coopers does or is we're",
    "start": "58039",
    "end": "64760"
  },
  {
    "text": "basically a Professional Services firm specializing in audits we've been doing for the last 100 years for the last 15",
    "start": "64760",
    "end": "70439"
  },
  {
    "text": "years we've been specializing in doing security audits across it environments whether it be Unix or Windows today",
    "start": "70439",
    "end": "76320"
  },
  {
    "text": "we're here to talk to you about specifically doing a deep technical audit on Windows",
    "start": "76320",
    "end": "82079"
  },
  {
    "text": "security I'm a manager within the Boston office in the Northeast region and",
    "start": "82079",
    "end": "87360"
  },
  {
    "text": "manage the Windows security practice up there David Goldman's manager in the New York Metro region managing that area of",
    "start": "87360",
    "end": "93439"
  },
  {
    "text": "the Windows security core team responsible for developing the audit methodologies throughout the practice",
    "start": "93439",
    "end": "98759"
  },
  {
    "text": "used globally and Joon noer also a manager in the Chicago Midwest region he",
    "start": "98759",
    "end": "104280"
  },
  {
    "text": "is also manager in the windows core team developing our methodologies globally so",
    "start": "104280",
    "end": "109560"
  },
  {
    "text": "the reason the three of us are here today is to talk to you about how you can create your own methodology and we're going to talk to you about the",
    "start": "109560",
    "end": "115079"
  },
  {
    "text": "methodology we use and coming up with how do we do an audit that's going to be",
    "start": "115079",
    "end": "120280"
  },
  {
    "text": "comprehensive targeted towards your environment relevant and accurate things we're going to talk",
    "start": "120280",
    "end": "126320"
  },
  {
    "text": "about today are the role of an audit why is it it's important to do an audit we're going to focus on the methodology",
    "start": "126320",
    "end": "131920"
  },
  {
    "text": "so that when you're walking out of here today you feel empowered to be able to develop a methodology that is customized",
    "start": "131920",
    "end": "137319"
  },
  {
    "text": "for your environment and if you implement that methodology you will have confidence in the results using our",
    "start": "137319",
    "end": "144000"
  },
  {
    "text": "methodology we go through what's called The Fabulous 5 we'll cover areas that are extremely important when we're",
    "start": "144000",
    "end": "149239"
  },
  {
    "text": "talking about wind window security and then lastly we'll do risk management and wrap-ups that you guys",
    "start": "149239",
    "end": "155480"
  },
  {
    "text": "have a full understanding when you walk out of here what it is you're able to audit with confidence in its results one",
    "start": "155480",
    "end": "162560"
  },
  {
    "text": "thing I want to make sure everyone understands is that the presentation we're using up here today is going to be slightly different than the presentation",
    "start": "162560",
    "end": "168400"
  },
  {
    "text": "in your handouts we will make this one available to you of course through the web and the CD and anyone else who needs",
    "start": "168400",
    "end": "174599"
  },
  {
    "text": "it can always always email us okay okay the role of an",
    "start": "174599",
    "end": "182159"
  },
  {
    "text": "audit why is it that we have to do audits well for some people who are",
    "start": "182159",
    "end": "187640"
  },
  {
    "text": "familiar with some upand cominging news you'll understand that audits are extremely important in today's environment and while one of the most",
    "start": "187640",
    "end": "193760"
  },
  {
    "text": "famous audits in history is going on right now or lack thereof it is in a different area that",
    "start": "193760",
    "end": "199959"
  },
  {
    "text": "was financial statements and the one we're talking about today is security audits within the windows environment the same thing can happen risks need to",
    "start": "199959",
    "end": "206519"
  },
  {
    "text": "be mitigated so when we talk about the role of an audit we're talking about two specific spefic things actually even more but specifically preventative",
    "start": "206519",
    "end": "213519"
  },
  {
    "text": "controls and detective controls an order can be used as a form of insurance what",
    "start": "213519",
    "end": "218920"
  },
  {
    "text": "you're doing is you're spending money today to make sure that you are prepared against something that's going to happen",
    "start": "218920",
    "end": "224200"
  },
  {
    "text": "tomorrow you need to mitigate the risks when we talk about detective controls",
    "start": "224200",
    "end": "229480"
  },
  {
    "text": "we're talking about how is it we can actually find out if our environment is secure against Intruders or hackers have",
    "start": "229480",
    "end": "237120"
  },
  {
    "text": "we even been breached a lot of times when we're going to clients will go there we'll be doing a standard audit",
    "start": "237120",
    "end": "242959"
  },
  {
    "text": "and then realize that perhaps you've actually been hacked because we'll see certain holes we'll see certain files",
    "start": "242959",
    "end": "248239"
  },
  {
    "text": "that don't look right so when we talk about the audit again two areas preventative controls and detective",
    "start": "248239",
    "end": "254000"
  },
  {
    "text": "controls it's not just the fact that well we don't feel so comfortable or you know we're trying to be proactive we",
    "start": "254000",
    "end": "260160"
  },
  {
    "text": "want to save some money in the long run by doing something today there's also regulatory requirements it's very",
    "start": "260160",
    "end": "266400"
  },
  {
    "text": "important that in today's society we are are actually meeting certain regulatory requirements the SEC mandates certain",
    "start": "266400",
    "end": "273600"
  },
  {
    "text": "requirements the healthc care industry has come up with a standard called",
    "start": "273600",
    "end": "278639"
  },
  {
    "text": "Hippa this Hippa standard for example requires security within it systems",
    "start": "278639",
    "end": "284080"
  },
  {
    "text": "throughout the health care hospitals pharmaceutical companies Etc GBA Glam Leach Bry act BL act uh",
    "start": "284080",
    "end": "292840"
  },
  {
    "text": "basically this one allows financial institutions to do more than they were in the past with that comes a certain",
    "start": "292840",
    "end": "298880"
  },
  {
    "text": "requirement for security if you want to be doing this there are regulatory agencies that will mandate you have",
    "start": "298880",
    "end": "305560"
  },
  {
    "text": "certain security requirements so this is why we actually need to do audits it's not something that just like well you",
    "start": "305560",
    "end": "312280"
  },
  {
    "text": "know we got this internal Department that really wants us to do things they're always you know climbing down our throats we got to actually do it for",
    "start": "312280",
    "end": "318720"
  },
  {
    "text": "them there are very important reasons in society to be doing Audits and and Todd I think one of the things we're going to",
    "start": "318720",
    "end": "324160"
  },
  {
    "text": "talk about later is the importance to customize the methodology to fit your requirements and one of those requirements you're going to want to",
    "start": "324160",
    "end": "330240"
  },
  {
    "text": "take into consideration or what regulatory requirements your specific industry is under so that may actually",
    "start": "330240",
    "end": "336360"
  },
  {
    "text": "impact the methodology you actually end up using absolutely thank",
    "start": "336360",
    "end": "341800"
  },
  {
    "text": "you the role of the audit continued confidentiality integrity and",
    "start": "341800",
    "end": "348199"
  },
  {
    "text": "availability when we talk about what it is we want to prevent we want to prevent prevent the compromise of these things",
    "start": "348199",
    "end": "356080"
  },
  {
    "text": "confidentiality well I have data I have customers that are transacting brokerage",
    "start": "356080",
    "end": "362240"
  },
  {
    "text": "houses people are buying stocks selling stocks you want this information to be kept confidential at all times so",
    "start": "362240",
    "end": "369080"
  },
  {
    "text": "confidentiality Integrity you want to prevent people from denying that something actually happen maybe they say",
    "start": "369080",
    "end": "375680"
  },
  {
    "text": "they didn't send an email but they really did or they really did send an email and it has very critical information and you want to be able to",
    "start": "375680",
    "end": "381160"
  },
  {
    "text": "prove that he did or she did send that email Integrity of your transactions and",
    "start": "381160",
    "end": "386520"
  },
  {
    "text": "of course availability I think it was about a year and a half ago when the distributed deny of service attacks came out where sites went down because they",
    "start": "386520",
    "end": "393599"
  },
  {
    "text": "were being bombarded with traffic availability when we're talking about companies like erade that make",
    "start": "393599",
    "end": "401400"
  },
  {
    "text": "their money based on the volume of transactions need to be constantly up well the audit is going to be used to",
    "start": "401400",
    "end": "407360"
  },
  {
    "text": "detect whether or not confidentiality integrity and availability are constantly being",
    "start": "407360",
    "end": "413160"
  },
  {
    "text": "met so basically what we're here to talk about today is really the the way to",
    "start": "415039",
    "end": "421479"
  },
  {
    "text": "build a methodology to audit the environment which is what you see is the fourth bullet here but that audit is",
    "start": "421479",
    "end": "428360"
  },
  {
    "text": "really part of an overall security architecture which as you can see here has risk assessment data classification",
    "start": "428360",
    "end": "436319"
  },
  {
    "text": "and this really is the other side of what Joe was talking about before targeted customized for your environment",
    "start": "436319",
    "end": "442280"
  },
  {
    "text": "you need to understand where the risks are in your environment and when you audit um certain systems whether they be",
    "start": "442280",
    "end": "450240"
  },
  {
    "text": "domain controllers mail servers other infrastructure servers in-house custom developed application servers you need",
    "start": "450240",
    "end": "456639"
  },
  {
    "text": "to treat them differently and you need to understand how critical those servers are to determine how much time and money",
    "start": "456639",
    "end": "464319"
  },
  {
    "text": "and Manpower you want to spend on each one of those type of servers and how",
    "start": "464319",
    "end": "469440"
  },
  {
    "text": "they communicate back and forth to each other to determine all of those paths",
    "start": "469440",
    "end": "476199"
  },
  {
    "text": "so basically you want to determine the vulnerable areas and obtain specific",
    "start": "476199",
    "end": "482479"
  },
  {
    "text": "information so you need to get an amount of information that is valuable to you",
    "start": "482479",
    "end": "487840"
  },
  {
    "text": "so you don't have information overload and get it in a way that allows you to act on it so if you just have reams of",
    "start": "487840",
    "end": "494199"
  },
  {
    "text": "information that tell you these are problem areas in your environment and it's not in a way that you can then",
    "start": "494199",
    "end": "499919"
  },
  {
    "text": "create an action plan and actually make changes to your environment Implement security then it's worthless to you so",
    "start": "499919",
    "end": "507840"
  },
  {
    "text": "after that point you want to be able to check for compliance on an ongoing basis and you want to make sure that security",
    "start": "507840",
    "end": "513640"
  },
  {
    "text": "is not a One-Shot deal it doesn't just occur okay we implemented security and",
    "start": "513640",
    "end": "518719"
  },
  {
    "text": "now we're done you need to have a methodology that supports a process and",
    "start": "518719",
    "end": "523839"
  },
  {
    "text": "I I think a good point point there is the allow for remediation I've certainly seen a lot of audit reports where",
    "start": "523839",
    "end": "529480"
  },
  {
    "text": "sometimes the level of detail provided uh may not be specific enough where it allows for a quick and easy remediation",
    "start": "529480",
    "end": "536440"
  },
  {
    "text": "by uh the audit so making sure that what whatever feedback you're giving them is is is very easy to",
    "start": "536440",
    "end": "543959"
  },
  {
    "text": "remediate now specifically we do want to talk about our audit methodology and",
    "start": "543959",
    "end": "549240"
  },
  {
    "text": "more better for you how is it you guys can create a methodology so that's it's for your environment well when we sat",
    "start": "549240",
    "end": "556720"
  },
  {
    "text": "down many years ago and tried to figure out what it is we need to put into our",
    "start": "556720",
    "end": "562000"
  },
  {
    "text": "policies and procedures for securing a server or detecting the security on a",
    "start": "562000",
    "end": "567040"
  },
  {
    "text": "server and whether or not it's it's sufficient we came up with three four five things",
    "start": "567040",
    "end": "574240"
  },
  {
    "text": "that were basically vital the three three main ones were comprehensiveness",
    "start": "574240",
    "end": "580279"
  },
  {
    "text": "relevancy and customization and then timeliness is also extremely important I want to cover",
    "start": "580279",
    "end": "586880"
  },
  {
    "text": "those three because I think that every component of a methodology will always link back to comprehensiveness",
    "start": "586880",
    "end": "593360"
  },
  {
    "text": "customization and relevancy when we talk about comprehensiveness what we're talking about is making sure that you",
    "start": "593360",
    "end": "598800"
  },
  {
    "text": "cover everything within the environment that could potentially lead to a breach now it might sound like a daunting task",
    "start": "598800",
    "end": "605320"
  },
  {
    "text": "or unmanageable but it actually isn't if you do it right and the meth the methodology we're going to talk to you today about will help you do that the",
    "start": "605320",
    "end": "612120"
  },
  {
    "text": "comprehensiveness is absolutely important because you can look at let's say there was going to be a hacker that",
    "start": "612120",
    "end": "617920"
  },
  {
    "text": "was going to break into your registry through whatever means but the idea is they're going after registry keys they're going to try to hack You by",
    "start": "617920",
    "end": "623800"
  },
  {
    "text": "going through specific software registry keys well if if you secure 19 of the 21 of",
    "start": "623800",
    "end": "631959"
  },
  {
    "text": "the 20 individual keys that potentially could be compromised the hacker could",
    "start": "631959",
    "end": "637800"
  },
  {
    "text": "still get in on the 20th so when we say comprehensiveness we're saying that yes you need to make sure you cover all of",
    "start": "637800",
    "end": "643040"
  },
  {
    "text": "that you can't necessarily do a random sampling of of of registry keys you",
    "start": "643040",
    "end": "649000"
  },
  {
    "text": "could do a random sampling of servers which we'll talk about later but it's important that comprehensiveness also",
    "start": "649000",
    "end": "654279"
  },
  {
    "text": "means outside the registry it also includes users and it includes groups and it includes services and yes it does",
    "start": "654279",
    "end": "661760"
  },
  {
    "text": "sound like it's a lot but you'll see today that it's actually something that can be done very quick and very easily the important thing of this is of course",
    "start": "661760",
    "end": "667920"
  },
  {
    "text": "scalability you want to make sure that whatever method whatever meth whatever methodology you decide to use you'll be",
    "start": "667920",
    "end": "674560"
  },
  {
    "text": "able to use it throughout your company your organization relevancy you want to make sure that the audit methodology is",
    "start": "674560",
    "end": "682200"
  },
  {
    "text": "going to be safe if you can download some random tool and it's going to be able to audit your box you put it on and",
    "start": "682200",
    "end": "689560"
  },
  {
    "text": "all of a sudden your box crashes doesn't do you a lot of good you want to make sure all the time your computers are",
    "start": "689560",
    "end": "696880"
  },
  {
    "text": "safe especially in a production environment most of our clients do not have a specific environment for us to be",
    "start": "696880",
    "end": "702200"
  },
  {
    "text": "able to audit we need to go on to production servers as much as we try to avoid it sometimes it needs to happen",
    "start": "702200",
    "end": "708320"
  },
  {
    "text": "we're going to talk to you about safe ways to be able to audit these servers and oh that's a really key point I think",
    "start": "708320",
    "end": "715680"
  },
  {
    "text": "as an auditor a lot of times you're an outside third party even if you're in an internal audit or you're a security",
    "start": "715680",
    "end": "721519"
  },
  {
    "text": "person you're not the owner of the system a lot of times that that's usually a systems administrator so as",
    "start": "721519",
    "end": "726760"
  },
  {
    "text": "that outside third party just like you're a visitor to someone's house you don't want to go in trashed place you want to leave it untouched so uh the",
    "start": "726760",
    "end": "734120"
  },
  {
    "text": "safety is really key uh I don't care how good your technical findings are if your tool crashed one of the client's systems",
    "start": "734120",
    "end": "740959"
  },
  {
    "text": "it's probably going to invalidate everything else that that that that you're doing from a work perspective yeah and going along with that example",
    "start": "740959",
    "end": "746880"
  },
  {
    "text": "of the uh the house Gast the of course unw welc House cast you want them out as fast as possible which is why we talk",
    "start": "746880",
    "end": "752199"
  },
  {
    "text": "about speed of the audit when internal audit if you're an administrator you're an internal order you know you want to",
    "start": "752199",
    "end": "758399"
  },
  {
    "text": "be on and off that system as fast as possible one because it's safe but two because you're slowing down the system",
    "start": "758399",
    "end": "763800"
  },
  {
    "text": "the quicker you're off it the better off you are because the system potentially won't go down while you're on it you",
    "start": "763800",
    "end": "770760"
  },
  {
    "text": "want to add anything on that customization this is without a doubt one of the trickiest parts of our audit",
    "start": "770760",
    "end": "776360"
  },
  {
    "text": "methodology customizing it for every specific client PWC doesn't necessarily have one audit that we use regardless of",
    "start": "776360",
    "end": "782800"
  },
  {
    "text": "what client we go to and for each of your environments you don't want to have your audit methodology that's something",
    "start": "782800",
    "end": "788639"
  },
  {
    "text": "you download off the internet that's like a baseline security standard needs to be customized and tweaked for exactly what you're doing tweaked targeted and",
    "start": "788639",
    "end": "796959"
  },
  {
    "text": "tailored the idea behind this is if you're running Windows XP on one server windows nt40 with Service Pack 3 on",
    "start": "796959",
    "end": "804000"
  },
  {
    "text": "another Windows NT Service Pack 6A uh Windows 2000 active directory domain",
    "start": "804000",
    "end": "809160"
  },
  {
    "text": "controller Windows 2000 Exchange Server a SQL Server you need to audit different",
    "start": "809160",
    "end": "814240"
  },
  {
    "text": "components of each of those boxes believe it or not you know you don't see a lot of tools today that have these",
    "start": "814240",
    "end": "820519"
  },
  {
    "text": "types of options well what is it you're auditing what is it that you're doing what's This Server being used for but for an audit methodology it is so",
    "start": "820519",
    "end": "826680"
  },
  {
    "text": "important that you know what the server is doing its functionality what operating system it's running how much",
    "start": "826680",
    "end": "832880"
  },
  {
    "text": "has it been patched all of these components go into whether or not your audit is actually going to make you feel",
    "start": "832880",
    "end": "838320"
  },
  {
    "text": "confident in the results you find and timeliness of",
    "start": "838320",
    "end": "843560"
  },
  {
    "text": "course you want to make sure that you're doing it within a change control window so that your audit does not disrupt",
    "start": "843560",
    "end": "848800"
  },
  {
    "text": "production environment and you also want to make sure that the data you look at is done and it's relevant for you when",
    "start": "848800",
    "end": "855199"
  },
  {
    "text": "you're actually looking at it you can't do an audit during uh you know during a backup time which you know might be at",
    "start": "855199",
    "end": "861399"
  },
  {
    "text": "the end of the year and then look at the data 6 months afterwards and then say okay well we looked at dat six you know",
    "start": "861399",
    "end": "867360"
  },
  {
    "text": "from 6 months ago and we found out that there are some problems and now here are audit findings",
    "start": "867360",
    "end": "874000"
  },
  {
    "text": "because first of all with the way security patches are being rolled out these days if you look at your",
    "start": "874000",
    "end": "879240"
  },
  {
    "text": "environment today 6 months from now it's going to be completely different hacks are always being",
    "start": "879240",
    "end": "885720"
  },
  {
    "text": "produced that you need to always be securing your environment against audits need to reveal what what level of",
    "start": "885720",
    "end": "891920"
  },
  {
    "text": "security you do have on it okay when we also talk about the",
    "start": "891920",
    "end": "899199"
  },
  {
    "text": "audit we need to talk about from what perspective we're auditing those servers",
    "start": "899199",
    "end": "904320"
  },
  {
    "text": "what that means is you could try to audit a server and determine how good the security is as if you're protecting",
    "start": "904320",
    "end": "911240"
  },
  {
    "text": "against people that are on the internet that don't have access through your firewall that basically means maybe they",
    "start": "911240",
    "end": "917959"
  },
  {
    "text": "have Port 8 open up to a web server that's in a DMZ maybe they have you know some you know maybe some DNS is open SSL",
    "start": "917959",
    "end": "925079"
  },
  {
    "text": "might be open but at the end of the day in Windows net bios won't be open right no one really opens up net bios on their",
    "start": "925079",
    "end": "931079"
  },
  {
    "text": "firew to the internet because of the implications of that we hope we hope",
    "start": "931079",
    "end": "936120"
  },
  {
    "text": "that's right we've seen it so that is one scenario though some",
    "start": "936120",
    "end": "943480"
  },
  {
    "text": "people like to say well our boxes inside the firewall are secured as if we go on",
    "start": "943480",
    "end": "948680"
  },
  {
    "text": "the Assumption no one can get through our firewall except through Port 80 and then only goes to our web server so",
    "start": "948680",
    "end": "954680"
  },
  {
    "text": "that's one way to do an audit and that might be part of the audit methodology you want to use another type might be a",
    "start": "954680",
    "end": "959880"
  },
  {
    "text": "targeted expert from the outside that maybe knows how to get through the firewall a little bit maybe they have certain access maybe there's a vendor",
    "start": "959880",
    "end": "966680"
  },
  {
    "text": "segment so they have certain access to certain boxes and this person actually wants to hack you know they actually",
    "start": "966680",
    "end": "972319"
  },
  {
    "text": "know your environment inside they want to go after specific surge they know your internal IP addresses maybe they did DNS Zone transfer or something and",
    "start": "972319",
    "end": "979800"
  },
  {
    "text": "they actually are going after you as opposed to just you know the script kitties a run you know sub seven Port",
    "start": "979800",
    "end": "985360"
  },
  {
    "text": "you know Port probes and you know back orifice all of those those so this is a second level now you need to actually be",
    "start": "985360",
    "end": "991560"
  },
  {
    "text": "a little so this sort of methodology is going to be a little more rigorous and then the last one that we",
    "start": "991560",
    "end": "997199"
  },
  {
    "text": "will describe is the one where you you're worried about someone being on the inside maybe you have people who can",
    "start": "997199",
    "end": "1003360"
  },
  {
    "text": "walk into your facilities maybe your facilities aren't even that physically protected someone can just walk in network drop plug their laptop in guess",
    "start": "1003360",
    "end": "1009920"
  },
  {
    "text": "what they just circum circumvented all that money you spent on your firewall by walking into your front",
    "start": "1009920",
    "end": "1016639"
  },
  {
    "text": "door right and I think the the basic point that Todd's getting across here is",
    "start": "1016639",
    "end": "1022160"
  },
  {
    "text": "that you can't just take one tool and scan or look at a system from a single",
    "start": "1022160",
    "end": "1027438"
  },
  {
    "text": "perspective and say okay we're looking at this from from the external perspective and we're protected unless",
    "start": "1027439",
    "end": "1035480"
  },
  {
    "text": "you know that meets certain criteria that you've defined but you need to assume that anyone with any level of",
    "start": "1035480",
    "end": "1042000"
  },
  {
    "text": "access may be able to get to a greater level of access so a script Kitty that you know scans all of Time Warner Cable",
    "start": "1042000",
    "end": "1050480"
  },
  {
    "text": "modem space looking for Port 80 does that first then they say okay here are",
    "start": "1050480",
    "end": "1056280"
  },
  {
    "text": "the machines with Port 80 let me find IIs web servers all right now I found IIs web servers let me try to find ones",
    "start": "1056280",
    "end": "1062320"
  },
  {
    "text": "that are still vulnerable to Unicode or still vulnerable to code red and then they move on from that okay now we get",
    "start": "1062320",
    "end": "1068720"
  },
  {
    "text": "to the next the next level and now now we're a targeted expert and maybe we can",
    "start": "1068720",
    "end": "1074000"
  },
  {
    "text": "use some vulnerability to gain user level access on the system now somebody",
    "start": "1074000",
    "end": "1080360"
  },
  {
    "text": "has access to that system in a way that you did not foresee so you you were keeping up to date on patches you had",
    "start": "1080360",
    "end": "1086960"
  },
  {
    "text": "good firewall rules etc etc but now somebody's a user on that system so what can they do so we need to make sure that",
    "start": "1086960",
    "end": "1093559"
  },
  {
    "text": "that system was looked at from that perspective so that even when they're user access they only do certain things",
    "start": "1093559",
    "end": "1099640"
  },
  {
    "text": "and they can't get to the admin level of access and then start compromising other systems and for that reason today we're",
    "start": "1099640",
    "end": "1106400"
  },
  {
    "text": "going to focus on the third audit methodology which is is as if someone is ACC able to access your service",
    "start": "1106400",
    "end": "1113200"
  },
  {
    "text": "through net bios ports and they are inside the firewall because we do believe that it is possible and we know",
    "start": "1113200",
    "end": "1118400"
  },
  {
    "text": "we've seen the reports out there that it is possible to get from you know all you have is one port open on the firewall to",
    "start": "1118400",
    "end": "1124240"
  },
  {
    "text": "this guy is inside your systems you know we just we just went to you know by you know there was a presentation today on the bidirectional attacks Communications",
    "start": "1124240",
    "end": "1131320"
  },
  {
    "text": "these guys will go in on Port 80 they'll map other ports through that they'll they'll map net bios right through it",
    "start": "1131320",
    "end": "1136440"
  },
  {
    "text": "and now all of a sudden from your web server they'll go after computers in your environment through net VI and it's all running on 480 to them yeah so the",
    "start": "1136440",
    "end": "1142919"
  },
  {
    "text": "benefit of designing an audit strategy through the authenticated user is you're kind of covering the other two scenarios",
    "start": "1142919",
    "end": "1148480"
  },
  {
    "text": "as part of that because it's the most comprehensive of the scenarios exactly if if you could protect yourself against",
    "start": "1148480",
    "end": "1154280"
  },
  {
    "text": "someone that's already got a user ID you're hopefully already protected from somebody that's a script KY the only",
    "start": "1154280",
    "end": "1160480"
  },
  {
    "text": "other thing I'd add is that you really don't want to just focus on one software package there's a lot of auditing packages out there there's a lot of",
    "start": "1160480",
    "end": "1166520"
  },
  {
    "text": "software companies that claim this is it we got the AUD software for you go ahead download it run it you got it we don't",
    "start": "1166520",
    "end": "1173000"
  },
  {
    "text": "really I mean we've looked at them thoroughly today we haven't found one that can cover an audit methodology that's customized for your environment",
    "start": "1173000",
    "end": "1179720"
  },
  {
    "text": "that's comprehensive enough to cover the types of systems you're using and that is relevant and accurate and safe there",
    "start": "1179720",
    "end": "1187200"
  },
  {
    "text": "are very good tools out there and they are excellent at covering what it is they need to cover um there really isn't",
    "start": "1187200",
    "end": "1194320"
  },
  {
    "text": "one out there that's the end all Beall solution and none of them are going to be customized for you",
    "start": "1194320",
    "end": "1200440"
  },
  {
    "text": "okay Fabulous Five this is the audit methodology we came up with to make it",
    "start": "1200440",
    "end": "1205919"
  },
  {
    "text": "as simple as possible to understand how it is we go through looking at an NT system when I say NT I mean 2000 xp. net",
    "start": "1205919",
    "end": "1212720"
  },
  {
    "text": "whatever anything that's not Windows 95 or Linux or Unix okay we look at",
    "start": "1212720",
    "end": "1220200"
  },
  {
    "text": "system audit Network resource and then user so the system security assessment",
    "start": "1220200",
    "end": "1226880"
  },
  {
    "text": "is going to be the first part the the reason system comes first is because you need to understand what the system is",
    "start": "1226880",
    "end": "1232880"
  },
  {
    "text": "doing the EAS way to do that is to start with this all the other four components",
    "start": "1232880",
    "end": "1238520"
  },
  {
    "text": "will change based on what you find during the system security assessment of your",
    "start": "1238520",
    "end": "1243960"
  },
  {
    "text": "audit and we're going to go into a lot of detail on what that is so I'm not going to go I'm not I'm not going to talk to you too much about system right",
    "start": "1243960",
    "end": "1249320"
  },
  {
    "text": "now but the auditing component this one does have this one is impacted by system",
    "start": "1249320",
    "end": "1254880"
  },
  {
    "text": "and this one impacts other ones because for example if auditing is disabled well that's going to actually change the way",
    "start": "1254880",
    "end": "1260000"
  },
  {
    "text": "you go through your resources you know when you get when you get to the resource security assessment do you want to actually check the AC the uh the uh",
    "start": "1260000",
    "end": "1268919"
  },
  {
    "text": "sackle system Access Control lists on every single directory no you don't",
    "start": "1268919",
    "end": "1273960"
  },
  {
    "text": "because ordering is disabled so save save yourself some time don't just go and use standard methodologies customize",
    "start": "1273960",
    "end": "1280640"
  },
  {
    "text": "it uh I skipped over networks I'll just mentioned it briefly the network the network security assessment is going to",
    "start": "1280640",
    "end": "1285919"
  },
  {
    "text": "be the components you're running you know are you a DNS server are you an internet web server are you running uh",
    "start": "1285919",
    "end": "1292360"
  },
  {
    "text": "Shares are you which most of course most people are are you in a trust relationship so",
    "start": "1292360",
    "end": "1299360"
  },
  {
    "text": "there are components of the network security assessment that you need to understand based on that so you don't",
    "start": "1299360",
    "end": "1304720"
  },
  {
    "text": "even ask the question about trusts if you're not a domain controller because the domain controllers establish the trusts that's what you're going to find",
    "start": "1304720",
    "end": "1310600"
  },
  {
    "text": "out during system and based on that you're going to go after users later the last section of course is users you want",
    "start": "1310600",
    "end": "1316159"
  },
  {
    "text": "to find out user rights groups ET and we're going to go through all this in much",
    "start": "1316159",
    "end": "1322000"
  },
  {
    "text": "detail this is my slide too system security okay so all right",
    "start": "1322279",
    "end": "1328840"
  },
  {
    "text": "I'll start talking in detail the components of system are the registry",
    "start": "1328840",
    "end": "1335919"
  },
  {
    "text": "the service executables actually not just the executables the services that are running and a bunch of others we're",
    "start": "1335919",
    "end": "1341919"
  },
  {
    "text": "actually going to have some nice little demonstrations for you guys throughout the rest of this presentation we're going to start developing an audit",
    "start": "1341919",
    "end": "1348279"
  },
  {
    "text": "method methodology that you might want to I would say you would not want to use this methodology walk away with it but",
    "start": "1348279",
    "end": "1355000"
  },
  {
    "text": "if you watch the way we've developed it this is something that you guys can easily do every tool we're going to show you today is freeware or something that",
    "start": "1355000",
    "end": "1361159"
  },
  {
    "text": "we've scripted which you can either have or script yourself because it's freely available from Microsoft software",
    "start": "1361159",
    "end": "1366640"
  },
  {
    "text": "development kit easily gotten off of uh parts of it at least the parts we're going to show you were all downloaded",
    "start": "1366640",
    "end": "1371960"
  },
  {
    "text": "off the internet for free from them and it's all open source so yeah I think the",
    "start": "1371960",
    "end": "1377360"
  },
  {
    "text": "key component here are are these tools are kind of a baseline beginning Foundation to understand what's out",
    "start": "1377360",
    "end": "1384320"
  },
  {
    "text": "there uh it's kind of the process that we started um after a time you'll probably see some limitations in each of",
    "start": "1384320",
    "end": "1390679"
  },
  {
    "text": "these tools and you're going to want something better uh and you'll start to to be more comfortable with what's out",
    "start": "1390679",
    "end": "1396440"
  },
  {
    "text": "there and you can start to build a more robust toolkit of your own thank you thanks for letting me you",
    "start": "1396440",
    "end": "1403400"
  },
  {
    "text": "give my voice last second got to shut tot up every now and then yes okay so",
    "start": "1403400",
    "end": "1408559"
  },
  {
    "text": "talk about systems some of the some of the key issues here are what's in the registry because the registry is really",
    "start": "1408559",
    "end": "1416080"
  },
  {
    "text": "kind of like the crown jewels of Windows if you can get access to that registry you can pretty much access anything you want and you'll see through some of the",
    "start": "1416080",
    "end": "1422559"
  },
  {
    "text": "types of hacker scenarios we tell you about while we're demonstrating these what can really happen but we put up",
    "start": "1422559",
    "end": "1427600"
  },
  {
    "text": "there like you know the wind regge key which says what are who is allowed to access your registry remotely we'll talk",
    "start": "1427600",
    "end": "1433960"
  },
  {
    "text": "about the AE debug key for example this is something where people can replace what your debugger is and which also runs a system so if they",
    "start": "1433960",
    "end": "1440720"
  },
  {
    "text": "place a trojan horse there now they'll have administrator access to your box and of course the things called like",
    "start": "1440720",
    "end": "1446880"
  },
  {
    "text": "the allowed paths well these are things that don't adhere to the permissions on that wind regge key registry",
    "start": "1446880",
    "end": "1454760"
  },
  {
    "text": "permissions uh in general there's a lot of keys that normal users will be able",
    "start": "1454760",
    "end": "1461440"
  },
  {
    "text": "to run programs from like the Run key the Run ones key uh the a buug I just",
    "start": "1461440",
    "end": "1467399"
  },
  {
    "text": "described so you need specific permissions on these to prevent people from actually changing them registry values the restricted",
    "start": "1467399",
    "end": "1474440"
  },
  {
    "text": "Anonymous key crash Dum clear page files these are the types of keys you need to audit we're going to talk about some of",
    "start": "1474440",
    "end": "1480080"
  },
  {
    "text": "these in a minute installed services this is the other big part of system what services are running is the",
    "start": "1480080",
    "end": "1486559"
  },
  {
    "text": "exchange service running well if it is that means it's an exchange box it's a mail server so you need to now change",
    "start": "1486559",
    "end": "1492880"
  },
  {
    "text": "the rest of your audit methodology based on information and you know what based on the methodology you're using if you",
    "start": "1492880",
    "end": "1498720"
  },
  {
    "text": "have scripted it the neat thing is you take a look at what the service is running from and you're able to pull the exact path in case someone didn't",
    "start": "1498720",
    "end": "1504960"
  },
  {
    "text": "install exchange from its default path we've seen lots of audit tools that had C back/ Wint hardcoded into everything",
    "start": "1504960",
    "end": "1513039"
  },
  {
    "text": "so people were looking at permissions on cwin system 32 well guess what if they",
    "start": "1513039",
    "end": "1518360"
  },
  {
    "text": "install to the D drive doesn't do you any good on your audit and nothing will come up as bad because it doesn't find",
    "start": "1518360",
    "end": "1523840"
  },
  {
    "text": "anything so guess what I just passed an audit because I installed NT to a different directory right and that goes",
    "start": "1523840",
    "end": "1529520"
  },
  {
    "text": "back to the scalability issue where you may have some systems where you have a default you know domain controllers",
    "start": "1529520",
    "end": "1535159"
  },
  {
    "text": "maybe you have a default system directory seol and winnt maybe in your DMZ your web servers you put the system",
    "start": "1535159",
    "end": "1540600"
  },
  {
    "text": "in a different location you don't want to have to go back and change your methodology for that specific type of",
    "start": "1540600",
    "end": "1546399"
  },
  {
    "text": "information every time you want something that's flexible and can uh you know can account for changes like that",
    "start": "1546399",
    "end": "1553240"
  },
  {
    "text": "yeah it's a great point you can get a lot of excellent information out of out of the service information the services that are running like am I terminal",
    "start": "1553240",
    "end": "1560000"
  },
  {
    "text": "server am I clustered am I SQL SQL am I exchange and also during this audit you",
    "start": "1560000",
    "end": "1566880"
  },
  {
    "text": "need to make sure you're running tools that tell you am I in a domain or a work group if I'm in a domain am I a domain",
    "start": "1566880",
    "end": "1572640"
  },
  {
    "text": "controller in the entt case am I a backup or am I a primary and you also want to find out",
    "start": "1572640",
    "end": "1579039"
  },
  {
    "text": "what version of Windows you're running what system path is actually uh used for the installation of",
    "start": "1579039",
    "end": "1585159"
  },
  {
    "text": "Windows okay we're going to start kicking off our oh Joe want to say something first oh no that's okay we're",
    "start": "1585159",
    "end": "1590799"
  },
  {
    "text": "going to start kicking off some of these demos now to show you how it is you can actually Implement a methodology to take",
    "start": "1590799",
    "end": "1596159"
  },
  {
    "text": "home to your specific environments um how many people here are",
    "start": "1596159",
    "end": "1601320"
  },
  {
    "text": "familiar with security configuration manager security configuration analysis Etc show a hands okay couple people so yeah there's",
    "start": "1601320",
    "end": "1609960"
  },
  {
    "text": "a whole bunch of people in the back there yeah uh well we have it up there a second it because that's the the command",
    "start": "1609960",
    "end": "1615360"
  },
  {
    "text": "line version and we tend to like to script things so uh command line version is is very nice but um a lot of the",
    "start": "1615360",
    "end": "1622640"
  },
  {
    "text": "things that that Todd was just talking about you can actually look at uh via the security configuration manager uh",
    "start": "1622640",
    "end": "1628320"
  },
  {
    "text": "security configuration analysis as it's called Windows 2000 um I think a lot of my clients are aware that you can use",
    "start": "1628320",
    "end": "1634960"
  },
  {
    "text": "the security configuration manager to implement security settings but sometimes they Overlook the fact that you can also use the same tool to",
    "start": "1634960",
    "end": "1641720"
  },
  {
    "text": "actually audit those settings and a significant portion of of what we're going to cover today would be able to be",
    "start": "1641720",
    "end": "1647640"
  },
  {
    "text": "covered during ing you know using SEC edit and the security configuration manager um the way you get to that tool",
    "start": "1647640",
    "end": "1654240"
  },
  {
    "text": "Windows 2000 is is launch MMC so start run MMC and if you click console add remove",
    "start": "1654240",
    "end": "1662200"
  },
  {
    "text": "snap in you can actually add I like to add two Stampin",
    "start": "1662200",
    "end": "1668399"
  },
  {
    "text": "really security configuration and Analysis and security templates",
    "start": "1668399",
    "end": "1675559"
  },
  {
    "text": "what this allows you to do first is Define a template and uh when we talk about the templates that you actually",
    "start": "1679600",
    "end": "1686880"
  },
  {
    "text": "Define as I close that up a little bit uh you can Define templates again",
    "start": "1686880",
    "end": "1693840"
  },
  {
    "text": "for all those baselines uh whether that be an is server a SQL Server an exchange",
    "start": "1693840",
    "end": "1700080"
  },
  {
    "text": "server a domain controller and you should Define all those different templates because the security requirements for for each of those",
    "start": "1700080",
    "end": "1706320"
  },
  {
    "text": "servers is going to be vastly different uh there are some great resources out there on the net we heard about uh the",
    "start": "1706320",
    "end": "1712000"
  },
  {
    "text": "NSA configuration manual that's out there that provides a set of imps uh there's several imps that are available",
    "start": "1712000",
    "end": "1718840"
  },
  {
    "text": "uh via Microsoft um the key there is is those should really be a starting point",
    "start": "1718840",
    "end": "1724200"
  },
  {
    "text": "I mean you're going to have to custom customize those standards to to what you want them to be for your environment",
    "start": "1724200",
    "end": "1729559"
  },
  {
    "text": "right and just to jump in for a second remember that every default install of Windows",
    "start": "1729559",
    "end": "1736080"
  },
  {
    "text": "2000 xp. net server every default install right out of the box is the same and there are certain security changes",
    "start": "1736080",
    "end": "1743240"
  },
  {
    "text": "that you need to make right away across all servers so there will be certain",
    "start": "1743240",
    "end": "1748399"
  },
  {
    "text": "system directory certain registry keys some of the things Todd talked about already some of the things that we'll talk about coming up that are really",
    "start": "1748399",
    "end": "1754840"
  },
  {
    "text": "across the board and so you'll have you know say a 65% Baseline that you can",
    "start": "1754840",
    "end": "1760039"
  },
  {
    "text": "apply and then the rest Beyond and on top of that is where you're customizing things it's also important to make sure",
    "start": "1760039",
    "end": "1766640"
  },
  {
    "text": "that you're looking at the right version of window windows for your audit methodology I know there's not a lot of keys but there was a landman server key",
    "start": "1766640",
    "end": "1772640"
  },
  {
    "text": "I don't actually remember exactly which one it was but NT 4.0 and Windows 2000 actually swapped where the information",
    "start": "1772640",
    "end": "1779480"
  },
  {
    "text": "for lman server was located I actually don't know of any other examples besides that one but if it happened once it",
    "start": "1779480",
    "end": "1785320"
  },
  {
    "text": "could happen again when we go to net which is going to be released soon enough and no and and that that's definitely the case with XP andet some",
    "start": "1785320",
    "end": "1792279"
  },
  {
    "text": "of the registry values that we're talking about here changed slightly particularly the way restrict Anonymous",
    "start": "1792279",
    "end": "1797640"
  },
  {
    "text": "is treated from Windows 2000 to Windows XP and windows.net that's a pretty significant",
    "start": "1797640",
    "end": "1803000"
  },
  {
    "text": "change if you try to use a Windows 2000 template on a Windows XP system or a windows.net system your results are",
    "start": "1803000",
    "end": "1809240"
  },
  {
    "text": "probably going to be very very inaccurate the biggest problem is probably the fact that the later",
    "start": "1809240",
    "end": "1814320"
  },
  {
    "text": "operating systems like XP have a lot of extra keys in there to allow you to do a lot of extra security well if you're",
    "start": "1814320",
    "end": "1820039"
  },
  {
    "text": "using your template from Windows NT or 2000 you're going to miss out on a lot of those features so specifically what",
    "start": "1820039",
    "end": "1826000"
  },
  {
    "text": "we're going to do we're going to come back to sack at it several times in each of these areas uh what we're looking at right now are the specific areas that",
    "start": "1826000",
    "end": "1832559"
  },
  {
    "text": "are covered under the system uh audit step and that's really going to be looking at registry values and services",
    "start": "1832559",
    "end": "1838720"
  },
  {
    "text": "as Todd said uh the registry values are located in an area in the template called uh local policies Security",
    "start": "1838720",
    "end": "1847039"
  },
  {
    "text": "Options uh within those Security Options what you'll actually see is you'll see",
    "start": "1847039",
    "end": "1852440"
  },
  {
    "text": "the kind of a friendly name if you will of of of how th those things are titled in almost in English like",
    "start": "1852440",
    "end": "1858960"
  },
  {
    "text": "setting uh and you'll see things like additional restriction for anonymous connections again that goes back to your",
    "start": "1858960",
    "end": "1864799"
  },
  {
    "text": "restrict Anonymous registry value um you'll see things like clear page file and shut down uh land manager",
    "start": "1864799",
    "end": "1871919"
  },
  {
    "text": "authentication level these all should be values and keys that that that you're hopefully familiar with uh these",
    "start": "1871919",
    "end": "1877360"
  },
  {
    "text": "actually get stored as just flat imp files uh in the whenn security templates",
    "start": "1877360",
    "end": "1883000"
  },
  {
    "text": "directory um if you open them up they're they're they're straight text files that that are fairly easy to read and just to",
    "start": "1883000",
    "end": "1889399"
  },
  {
    "text": "jump in while Joe's doing that this information that appears in the guy and has friendly names all of that is stored",
    "start": "1889399",
    "end": "1895679"
  },
  {
    "text": "in the registry and you can actually update that to add in your own friendly names and the options for you know radio",
    "start": "1895679",
    "end": "1901840"
  },
  {
    "text": "buttons or drop- down boxes to set all of those things and all that information could be updated with more registry keys",
    "start": "1901840",
    "end": "1908320"
  },
  {
    "text": "than Microsoft provides you the the friendly Facility by default yep so you",
    "start": "1908320",
    "end": "1913760"
  },
  {
    "text": "you can see there right here and this is unfortunately very small me uh increase this font to something that'll whoa that",
    "start": "1913760",
    "end": "1922600"
  },
  {
    "text": "was probably too",
    "start": "1922600",
    "end": "1925440"
  },
  {
    "text": "big that's better so we were talking about Security Options uh and these are",
    "start": "1927880",
    "end": "1933440"
  },
  {
    "text": "going to show up if I can right here uh you can see in",
    "start": "1933440",
    "end": "1938760"
  },
  {
    "text": "the comments field they're uh local policy Security Options so all these things we saw in the guie get translated",
    "start": "1938760",
    "end": "1944480"
  },
  {
    "text": "back into just a straight text string in the INF file uh and the nice thing is it's actually giving you the the the",
    "start": "1944480",
    "end": "1950720"
  },
  {
    "text": "registry path before the security configuration manager you were opening up regge edit you were manually",
    "start": "1950720",
    "end": "1955880"
  },
  {
    "text": "navigating to this registry path HK local machine system current control set and either verifying the value if you're",
    "start": "1955880",
    "end": "1961559"
  },
  {
    "text": "doing an audit or actually changing the value if you were doing an implementation whereas in now with these",
    "start": "1961559",
    "end": "1967080"
  },
  {
    "text": "templates you know you define it once you run and analyze it tells you whether",
    "start": "1967080",
    "end": "1972279"
  },
  {
    "text": "or not the setting is is is still correct and and then at a later date uh if you're responsible for the",
    "start": "1972279",
    "end": "1977399"
  },
  {
    "text": "implementation you then do a configure and it actually imp implements the change for",
    "start": "1977399",
    "end": "1982760"
  },
  {
    "text": "you so now you see that you actually have so this was actually step one but you you now have one tool in Your",
    "start": "1982760",
    "end": "1989240"
  },
  {
    "text": "Arsenal to start doing your audit methodology we're actually going to run through about 12 tools some of them are going to be used more than once so",
    "start": "1989240",
    "end": "1995240"
  },
  {
    "text": "there's about 16 steps maybe up to 20 using this type of methodology which is based on all freeware tools that are",
    "start": "1995240",
    "end": "2002399"
  },
  {
    "text": "either easily downloaded off the internet or open source that you can create yourself but you now have one",
    "start": "2002399",
    "end": "2007919"
  },
  {
    "text": "tool so using this now we're going to start talking about all the other ones and you're going to start to see this formation of something that you could",
    "start": "2007919",
    "end": "2014080"
  },
  {
    "text": "potentially make into a batch a or a script that you can run against one server one thing I want to point out is",
    "start": "2014080",
    "end": "2020440"
  },
  {
    "text": "that a lot of the tools we're going to show you today because they are freeware that you guys can use yourselves or open",
    "start": "2020440",
    "end": "2026120"
  },
  {
    "text": "source many of them only run locally this contradicts one of the things we said earlier which had which was",
    "start": "2026120",
    "end": "2032320"
  },
  {
    "text": "scalability and safe running tools locally is not scalable because if you have a th000 Serv you're not going to",
    "start": "2032320",
    "end": "2038679"
  },
  {
    "text": "locally run it on all of those thousand servers second in terms of safety anytime you run something locally on a",
    "start": "2038679",
    "end": "2045799"
  },
  {
    "text": "box there's another chance that memory's going to get corrupt something's going to happen that's wrong it's going to take up too much time and effort on the",
    "start": "2045799",
    "end": "2052118"
  },
  {
    "text": "processor's part to actually complete and it might crash something we call the final Factor Theory you know there's a",
    "start": "2052119",
    "end": "2058320"
  },
  {
    "text": "point in a server processing time where literally the next thing you do will crash it well guess what if you're an",
    "start": "2058320",
    "end": "2064240"
  },
  {
    "text": "internal audit and you're running this tool and you know the tool works fine and crashed the Box doesn't matter whose",
    "start": "2064240",
    "end": "2069320"
  },
  {
    "text": "fault it was you know you're in big trouble and you're going to get yelled at for a long time just so happens it might have been notepad that crashed it",
    "start": "2069320",
    "end": "2075440"
  },
  {
    "text": "but so we want to make sure that we are using an audit methodology that is going to be safe and scalable y uh getting",
    "start": "2075440",
    "end": "2084240"
  },
  {
    "text": "back to security configuration analysis and and and the system audit uh the other area that uh Todd talked about",
    "start": "2084240",
    "end": "2090280"
  },
  {
    "text": "were the system Services uh the great thing I we like about um the security configuration manager is it allows you",
    "start": "2090280",
    "end": "2096760"
  },
  {
    "text": "not only to view the system startup status whether or not it's set to automatic uh manual or disabled but it",
    "start": "2096760",
    "end": "2102440"
  },
  {
    "text": "also allows you to view the service permissions uh there's a really good example of of the net DDE exploit I",
    "start": "2102440",
    "end": "2107680"
  },
  {
    "text": "don't know how many of you are familiar with that exploit uh but one of the things uh that that exploit took advantage of was the fact that any any",
    "start": "2107680",
    "end": "2114359"
  },
  {
    "text": "user could start the service it wasn't limited to administrators that were had the ability to start that service so as",
    "start": "2114359",
    "end": "2120040"
  },
  {
    "text": "a non-privileged user you could start the net DDE ex uh service and then you can run an exploit based on that so one",
    "start": "2120040",
    "end": "2126560"
  },
  {
    "text": "of the things that's really important to do when you're looking at Services is not only look up at the startup status",
    "start": "2126560",
    "end": "2131920"
  },
  {
    "text": "but also look at the security descript descriptors and the permissions on those Services uh and unfortunately there",
    "start": "2131920",
    "end": "2137720"
  },
  {
    "text": "aren't a lot of tools out there right now that do that uh likewise though with Services one of the things that we don't",
    "start": "2137720",
    "end": "2143760"
  },
  {
    "text": "like about the SEC edit Tool uh is that you don't get the executable path so you don't you don't know uh what's kicking",
    "start": "2143760",
    "end": "2150200"
  },
  {
    "text": "off the alert or service is that stored in the Wint system 32 directory is it stored somewhere else uh if you're",
    "start": "2150200",
    "end": "2155880"
  },
  {
    "text": "running SQL Server you don't know where SQL servers installed uh you don't know what context something like SQL Server is running under you don't know what",
    "start": "2155880",
    "end": "2162280"
  },
  {
    "text": "context something like exchange is running under so you really need a secondary tool or something else that's",
    "start": "2162280",
    "end": "2168280"
  },
  {
    "text": "going to show you what context it's running under and also what what file path it's running under and that's",
    "start": "2168280",
    "end": "2174200"
  },
  {
    "text": "really where Ms info 32 comes in Yes again just to make sure we uh cover on",
    "start": "2174200",
    "end": "2180359"
  },
  {
    "text": "this an extra time the idea behind going after registry values first is because the registry is going to hold things",
    "start": "2180359",
    "end": "2186000"
  },
  {
    "text": "like what service pack you're running going to hold your version of the operating system so that if you're running remotely you can actually pull",
    "start": "2186000",
    "end": "2191960"
  },
  {
    "text": "that without having to do any API calls you're going to find out oh I had a whole bunch of them",
    "start": "2191960",
    "end": "2197839"
  },
  {
    "text": "system path system path thank you um so yes when you go after the registry values you have to go after it first you",
    "start": "2197839",
    "end": "2203079"
  },
  {
    "text": "want to find out what these things are that the Box is doing and then you can customize the rest of your activity",
    "start": "2203079",
    "end": "2208680"
  },
  {
    "text": "based on that so matter fact if you pull the uh the uh the version of Windows first as the first registry value you",
    "start": "2208680",
    "end": "2214319"
  },
  {
    "text": "know the next few registry values you going to have to pull after that based on what version of Windows is running because we were saying earlier registry",
    "start": "2214319",
    "end": "2220079"
  },
  {
    "text": "values are going to depend on the version of Windows right another example that Todd already pointed out earlier with registry values you get the list of",
    "start": "2220079",
    "end": "2226960"
  },
  {
    "text": "allowed pads those are your exceptions to the wind reg key rule so now you want to look at registry permissions on those",
    "start": "2226960",
    "end": "2233880"
  },
  {
    "text": "allowed paths you want to see okay you know we say administrators are the only",
    "start": "2233880",
    "end": "2239119"
  },
  {
    "text": "ones that can access the registry remotely except for these pads so who can access those pads so your reg valves",
    "start": "2239119",
    "end": "2245119"
  },
  {
    "text": "feed into your regge perms exactly which is why registered firms come second and now we're going to switch into Ms info",
    "start": "2245119",
    "end": "2251880"
  },
  {
    "text": "32 which talks about uh Ms info 32 is also going to give us a lot of that that",
    "start": "2251880",
    "end": "2257079"
  },
  {
    "text": "basic configuration information things like Service Pack level OS version things like that for those of you that",
    "start": "2257079",
    "end": "2262839"
  },
  {
    "text": "aren't familiar with Ms uh info 32 it's basically win MSD with a new interface",
    "start": "2262839",
    "end": "2267960"
  },
  {
    "text": "and a new name uh in fact it looks like if you type win MSD it's just a basic",
    "start": "2267960",
    "end": "2273240"
  },
  {
    "text": "executable that actually calls uh Ms info 32 um there's a guey interface to",
    "start": "2273240",
    "end": "2278760"
  },
  {
    "text": "it that's very slow and kind of cranky uh the nice thing is though you can",
    "start": "2278760",
    "end": "2283880"
  },
  {
    "text": "actually run it from a command line and Export it to specific reports uh if you",
    "start": "2283880",
    "end": "2289040"
  },
  {
    "text": "look up there you can see uh you can actually uh kick off a report uh you can",
    "start": "2289040",
    "end": "2294920"
  },
  {
    "text": "go a list of categories you can pull the categories out of msdn just do a search for like system summary or something like that and uh Ms info 32 and that'll",
    "start": "2294920",
    "end": "2302440"
  },
  {
    "text": "pull out the whole listing for you but the ones that we're Mo most concerned about right now from a system audit",
    "start": "2302440",
    "end": "2307560"
  },
  {
    "text": "perspective uh is system summary uh Services running tasks and device",
    "start": "2307560",
    "end": "2313200"
  },
  {
    "text": "drivers that's going to give us a really good idea of of what the nature of the server is yeah like this is this is",
    "start": "2313200",
    "end": "2318680"
  },
  {
    "text": "something that we scripted because we wanted to be able to run this as quick as possible and some of the most important things are finding out what",
    "start": "2318680",
    "end": "2325000"
  },
  {
    "text": "context services are running as sometimes you'll have a third party tool running as a service and as local system",
    "start": "2325000",
    "end": "2331520"
  },
  {
    "text": "if someone can replace what that exe is they now have administrator actually they have system access which is even",
    "start": "2331520",
    "end": "2336680"
  },
  {
    "text": "better than administrator access but it doesn't matter at that point you own the Box another one is device drivers I just want to touch on this real quick because",
    "start": "2336680",
    "end": "2343319"
  },
  {
    "text": "I don't know many people who do audits that even care about what the device drivers are that are running a lot of",
    "start": "2343319",
    "end": "2349400"
  },
  {
    "text": "the pieces that come in Windows services for Unix and some of the other thirdparty",
    "start": "2349400",
    "end": "2354760"
  },
  {
    "text": "applications are running as device drivers that could potentially be",
    "start": "2354760",
    "end": "2359960"
  },
  {
    "text": "harmful for your environment depending on what you're doing our commands are running as device drivers NFS is running",
    "start": "2359960",
    "end": "2365480"
  },
  {
    "text": "as a device driver so packet. sniffers That's a classic example the only way that you would know generally",
    "start": "2365480",
    "end": "2371960"
  },
  {
    "text": "looking at a Windows system that a packet sniffer is installed is to review the list of drive device drivers that are active likewise running tasks I mean",
    "start": "2371960",
    "end": "2379119"
  },
  {
    "text": "if you you know a lot of rootkits now are are trying to hide what running tasks are out there but if you get a a",
    "start": "2379119",
    "end": "2385680"
  },
  {
    "text": "bad one you may still see that showing up in task list these are things that that we typically see ignored uh in a",
    "start": "2385680",
    "end": "2392400"
  },
  {
    "text": "lot of the other products that are out there that are looking at things from you know maybe just the Network",
    "start": "2392400",
    "end": "2397760"
  },
  {
    "text": "perspective they're not going to give you you know a process listing or a listing what device drivers loaded on",
    "start": "2397760",
    "end": "2402839"
  },
  {
    "text": "the system right just a quick example of process listing that we had at a client and this isn't necessarily a security",
    "start": "2402839",
    "end": "2408240"
  },
  {
    "text": "related issue but it's something you should see in an audit and it doesn't make sense we're going through the production of viment we looked at the",
    "start": "2408240",
    "end": "2414160"
  },
  {
    "text": "list of running processes and on one of their main production application customer facing servers they had seti at",
    "start": "2414160",
    "end": "2420920"
  },
  {
    "text": "home running which you know is the search for extraterrestrial life and somebody had installed that on a production server and it was off you",
    "start": "2420920",
    "end": "2427440"
  },
  {
    "text": "know causing operational impact and other than you know looking at what's",
    "start": "2427440",
    "end": "2433119"
  },
  {
    "text": "running on the box physically there's no way other than if you know you see huge",
    "start": "2433119",
    "end": "2438480"
  },
  {
    "text": "Network lag etc etc you try to file it up eventually you'll find out that that's that's what was going on so like",
    "start": "2438480",
    "end": "2444760"
  },
  {
    "text": "Joe said a lot of bad Trojan horses and and things like that will still show up",
    "start": "2444760",
    "end": "2450800"
  },
  {
    "text": "there but there are ways around that want me to pull up Ms inf4 32 let's just see what yeah I don't know why it's not",
    "start": "2450800",
    "end": "2456599"
  },
  {
    "text": "kicking off for m I uh seems to be dying so this is what it looks like obviously from the command prompt it's just going",
    "start": "2456599",
    "end": "2462720"
  },
  {
    "text": "to dump everything out into a nice little text file for you which makes it easy for you to manipulate you can write some quick uh what is that Pearl right",
    "start": "2462720",
    "end": "2470599"
  },
  {
    "text": "you use Todd this guy Todd becomes a manager and pearl all of a sudden is a foreign word to him yeah I don't",
    "start": "2470599",
    "end": "2477079"
  },
  {
    "text": "know thank you that feel like embarrassing me in front of everyone no problem um so this is Ms info 32 is goey",
    "start": "2477079",
    "end": "2484440"
  },
  {
    "text": "and again you might as well just go to the help and take a look at all the commands you can run from the command prompt with it or just do a flash",
    "start": "2484440",
    "end": "2490440"
  },
  {
    "text": "question mark and uh you'll be able to see all the reports but those are the four we recommend for uh",
    "start": "2490440",
    "end": "2496680"
  },
  {
    "text": "comprehensiveness of a methodology HFN net check this is an extremely important",
    "start": "2496680",
    "end": "2501880"
  },
  {
    "text": "one we're not going to do a full demo on it because I think many of you were in Eric Schultz's presentation Microsoft was",
    "start": "2501880",
    "end": "2508000"
  },
  {
    "text": "just here showing you exactly so Microsoft has this new free tool developed by shabel technologies that",
    "start": "2508000",
    "end": "2513200"
  },
  {
    "text": "will look at your entire system and tell you how patched or not patched you are this is very important because you know",
    "start": "2513200",
    "end": "2518760"
  },
  {
    "text": "what at the end of the day you know we can order the Box till we're you know blew in the face for registry keys permissions users groups if you don't if",
    "start": "2518760",
    "end": "2526800"
  },
  {
    "text": "you're not protected against some buffer overflow that runs over Port 80 on the I Services then they're going to get",
    "start": "2526800",
    "end": "2533680"
  },
  {
    "text": "access to your box so a way to look at all of the patches on system is made",
    "start": "2533680",
    "end": "2540400"
  },
  {
    "text": "pretty easy through this HF net check tool and the idea behind it is it will",
    "start": "2540400",
    "end": "2546720"
  },
  {
    "text": "look at the patches for SQL exchange I don't know if they done exchange I know it's SQL Windows IIs and Internet",
    "start": "2546720",
    "end": "2553599"
  },
  {
    "text": "Explorer I think there's even some office patches in there so it's fully comprehensive if you don't want to use",
    "start": "2553599",
    "end": "2559160"
  },
  {
    "text": "something like HF net check which is which is free and you would rather use something that you've developed yourself",
    "start": "2559160",
    "end": "2564319"
  },
  {
    "text": "not a problem you can go into the registry where the Q article based on a",
    "start": "2564319",
    "end": "2569520"
  },
  {
    "text": "security patch that's been written is located and you can look to see if it exists if the Q which is just a query",
    "start": "2569520",
    "end": "2576440"
  },
  {
    "text": "for Microsoft's knowledge base exists then you know you've been patched yeah the uh yeah so the other way you could",
    "start": "2576440",
    "end": "2583520"
  },
  {
    "text": "do it of course is to download the check sums of all the files for Microsoft's website and then do a little check sum",
    "start": "2583520",
    "end": "2589240"
  },
  {
    "text": "on your own files but now we're talking about why people don't like internal Auditors because we do things like that",
    "start": "2589240",
    "end": "2595000"
  },
  {
    "text": "Y and then lastly is uh saay which I guess you want me to yeah I you can just sa is basically a tool that is part of",
    "start": "2595000",
    "end": "2603680"
  },
  {
    "text": "the Microsoft platform SDK for Windows so the source is available and it's",
    "start": "2603680",
    "end": "2609599"
  },
  {
    "text": "basically just the tool that we chose to compile and demonstrate for this one uh",
    "start": "2609599",
    "end": "2616440"
  },
  {
    "text": "one task of gathering tasks this one task of gathering tasks",
    "start": "2616440",
    "end": "2622480"
  },
  {
    "text": "yes is that one too many tasks and again if you don't like the",
    "start": "2622480",
    "end": "2628520"
  },
  {
    "text": "output it's open source go ahead change it stick your company name at the top of it this is odd I this is a different box",
    "start": "2628520",
    "end": "2635839"
  },
  {
    "text": "I'm on right now and I've got job scheduled from like October 2001 I have no idea what those jobs are so you don't",
    "start": "2635839",
    "end": "2641480"
  },
  {
    "text": "audit your system on a periodic basis to determine what jobs are running no not at all see that's the problem but there",
    "start": "2641480",
    "end": "2646640"
  },
  {
    "text": "are a couple reasons that it's important to look at tasks here the first being that you know these are things that are",
    "start": "2646640",
    "end": "2652400"
  },
  {
    "text": "going to execute on your system and starting with ie4 on or yeah I4 on nt4",
    "start": "2652400",
    "end": "2661079"
  },
  {
    "text": "the model changed from at to the test scheduler and you had a lot more flexibility and granularity with the",
    "start": "2661079",
    "end": "2667119"
  },
  {
    "text": "scheduling so you can see what context what account the task is running as is",
    "start": "2667119",
    "end": "2673960"
  },
  {
    "text": "it a user is it an admin etc etc and also what is the executable path to that",
    "start": "2673960",
    "end": "2680240"
  },
  {
    "text": "job so if it's C backt back you know Trojan",
    "start": "2680240",
    "end": "2686079"
  },
  {
    "text": "dobat that's obviously a bad thing but if it's a job that we want if it's",
    "start": "2686079",
    "end": "2691640"
  },
  {
    "text": "something a backup that we've scheduled then what we want to do is look at the permission the NTFS permissions on that",
    "start": "2691640",
    "end": "2699160"
  },
  {
    "text": "executable file so maybe we have it locked down people can't change theuer people can't submit jobs they won't be",
    "start": "2699160",
    "end": "2705559"
  },
  {
    "text": "able to add anything in that way but they just go find the executable path and replace the XE itself and and this",
    "start": "2705559",
    "end": "2711960"
  },
  {
    "text": "is a good example of that right there uh you can see if we use the at command uh no jobs show up as being scheduled but",
    "start": "2711960",
    "end": "2718079"
  },
  {
    "text": "if you use sa it actually shows that there are two jobs from October that's actually my birthday I have no idea what",
    "start": "2718079",
    "end": "2724280"
  },
  {
    "text": "those jobs were someone must have left me a present um that we're sched David actually just started touching on and",
    "start": "2724280",
    "end": "2730480"
  },
  {
    "text": "now that we've completed system security assessment it's it's good to mention this but try to think of the fabulous 5",
    "start": "2730480",
    "end": "2737400"
  },
  {
    "text": "as a clock and at 12:00 you have system and then let's see that's clockwise for me so clockwise for you would be so it's",
    "start": "2737400",
    "end": "2744160"
  },
  {
    "text": "going to be system audit Network resource user and what happens is you",
    "start": "2744160",
    "end": "2749280"
  },
  {
    "text": "have all of these uh disparate audit security assessments that you need to do so",
    "start": "2749280",
    "end": "2755520"
  },
  {
    "text": "there's there's two one one here here here what happened is we just completed system now we have all of this information up here that we've gathered",
    "start": "2755520",
    "end": "2762760"
  },
  {
    "text": "well David just gave you the example of the task scheduler you now have an exe that runs as system so when we get down",
    "start": "2762760",
    "end": "2770160"
  },
  {
    "text": "through the clock to the resource part which is down here at your 7:30 then",
    "start": "2770160",
    "end": "2776559"
  },
  {
    "text": "you're going to start seeing that you need to start bringing things up from your security assessment into your resource security assessment and as we",
    "start": "2776559",
    "end": "2783160"
  },
  {
    "text": "go through this audit methodology you're going to start seeing how it really is comprehensive how things in system are going to go",
    "start": "2783160",
    "end": "2789040"
  },
  {
    "text": "down to Resource um things from us are going to be coming from Network things",
    "start": "2789040",
    "end": "2794400"
  },
  {
    "text": "you know the Network's another good one that we're going to touch on but you know Network when you look at to see if IIs web service is running which by",
    "start": "2794400",
    "end": "2800000"
  },
  {
    "text": "default is on all installations of Windows you're going to start having to pull I virtual Roots into your resource",
    "start": "2800000",
    "end": "2805400"
  },
  {
    "text": "security assessment to find out if NTFS permissions are actually commensurate with what people should be doing right",
    "start": "2805400",
    "end": "2811440"
  },
  {
    "text": "so so far in through Services we could tell that exchange is running or that SQL is running",
    "start": "2811440",
    "end": "2817400"
  },
  {
    "text": "so now we need to look at certain registry keys certain file permissions certain application Level settings for",
    "start": "2817400",
    "end": "2823440"
  },
  {
    "text": "exchange SQL terminal server Etc things like that so those feed into there we",
    "start": "2823440",
    "end": "2828800"
  },
  {
    "text": "have the other example Todd just did with the scheduler also it's running as uh a certain context maybe not local",
    "start": "2828800",
    "end": "2835000"
  },
  {
    "text": "system so we need to funnel that into users so that and and groups so that",
    "start": "2835000",
    "end": "2840200"
  },
  {
    "text": "when we get there we can look at that user and find out uh what groups are they a member of what user rights does",
    "start": "2840200",
    "end": "2845800"
  },
  {
    "text": "that user have either explicitly or effectively this this is a key part of the customization process this is this",
    "start": "2845800",
    "end": "2851880"
  },
  {
    "text": "is more than just just taking the standard files and directories that are out there and looking at those this is",
    "start": "2851880",
    "end": "2856960"
  },
  {
    "text": "saying here's a service execut that we' we've never heard of that's located on the D drive we need to look at the perms",
    "start": "2856960",
    "end": "2862760"
  },
  {
    "text": "there as well not just the standard One n system 32 Etc and it'll become much more clear as we go through these as we",
    "start": "2862760",
    "end": "2869079"
  },
  {
    "text": "go through the Fabulous Five security assessment areas we've only talked about one so you might be thinking yourself I don't understand how it all links",
    "start": "2869079",
    "end": "2874920"
  },
  {
    "text": "together but it will come more clear hopefully okay so the second",
    "start": "2874920",
    "end": "2880599"
  },
  {
    "text": "block of this is auditing which basically talks about our auditing policy um clearly out of the box we all",
    "start": "2880599",
    "end": "2887960"
  },
  {
    "text": "know that auditing is disabled so you need to turn it on and set some options so that we start having an audit",
    "start": "2887960",
    "end": "2894839"
  },
  {
    "text": "Trail the flip side of that is even though we've turned auditing on we then",
    "start": "2894839",
    "end": "2899880"
  },
  {
    "text": "later need to make sure that we actually have resources that say audit this so",
    "start": "2899880",
    "end": "2904920"
  },
  {
    "text": "make sure we're auditing this directory auditing this registry key so on and so forth event logs are they big enough to",
    "start": "2904920",
    "end": "2912200"
  },
  {
    "text": "hold our amount of data are they overwriting data presenting data to us in a timely fashion so that we can",
    "start": "2912200",
    "end": "2918240"
  },
  {
    "text": "review it and really get an accurate picture of what changes are being made to the system how the system is being",
    "start": "2918240",
    "end": "2923800"
  },
  {
    "text": "used and then through Network alerts and performance monitor which we're not going to touch on too much we can",
    "start": "2923800",
    "end": "2929240"
  },
  {
    "text": "schedule different things that say all right here's a threshold uh we've got too many failed logins we need to act",
    "start": "2929240",
    "end": "2935799"
  },
  {
    "text": "right so for our configuration issues as I kind of just touched on we need to",
    "start": "2935799",
    "end": "2941119"
  },
  {
    "text": "make sure that we are auditing a proper amount of information enough information but not too much and if you sat in on",
    "start": "2941119",
    "end": "2947640"
  },
  {
    "text": "some of the other classes or presentations um people have given good examples of you know process checking or",
    "start": "2947640",
    "end": "2954640"
  },
  {
    "text": "object access generate a lot of information that in production environments may slow down systems or",
    "start": "2954640",
    "end": "2961680"
  },
  {
    "text": "may provide and inundate you with information it's it's useless at that point it's too much",
    "start": "2961680",
    "end": "2967400"
  },
  {
    "text": "then I as I said files and directories even though you've got an audit policy that says you know failed object access",
    "start": "2967400",
    "end": "2972920"
  },
  {
    "text": "we're going to look at that if you don't then go and set the system Access Control list on a directory in a file on",
    "start": "2972920",
    "end": "2979599"
  },
  {
    "text": "a registry key on a printer on other things then you know it doesn't matter",
    "start": "2979599",
    "end": "2985359"
  },
  {
    "text": "that you check that box same with the registry and then again with our log settings we want to make sure they're",
    "start": "2985359",
    "end": "2991400"
  },
  {
    "text": "they're sufficient so so we return back to SEC",
    "start": "2991400",
    "end": "2996920"
  },
  {
    "text": "at it as as we're going to several times uh the audit settings again they're kind of spread out over two areas one is the",
    "start": "2996920",
    "end": "3003000"
  },
  {
    "text": "local policies the audit policy uh within there uh you'll see each of the options uh that you can audit whether",
    "start": "3003000",
    "end": "3009839"
  },
  {
    "text": "that be account log on events account management directory service accesses uh log on events object access policy",
    "start": "3009839",
    "end": "3017480"
  },
  {
    "text": "change privilege use process tracking and system events uh again for every",
    "start": "3017480",
    "end": "3023160"
  },
  {
    "text": "environment how much of this you're going to turn on and enable uh is is going to probably be different based on your regulatory requirements uh",
    "start": "3023160",
    "end": "3030200"
  },
  {
    "text": "particularly whether or not you're going to log successful and failed log on events that's going to depend on on what",
    "start": "3030200",
    "end": "3035559"
  },
  {
    "text": "your stance is from a forensic perspective and how much data you want to collect uh in general as David was indicating you probably don't want to",
    "start": "3035559",
    "end": "3042000"
  },
  {
    "text": "audit process tracking uh you probably don't want to audit every successful privilege use because that's going to",
    "start": "3042000",
    "end": "3047040"
  },
  {
    "text": "pick up bypass Traverse checking successfully and that's going to create a lot of audit entries so you do",
    "start": "3047040",
    "end": "3052400"
  },
  {
    "text": "definitely want to tweak that um and then likewise the event log settings uh you can actually look in here and you",
    "start": "3052400",
    "end": "3058319"
  },
  {
    "text": "can view how large the event logs are what's the overwrite setting are they being being overwritten every seven days",
    "start": "3058319",
    "end": "3064640"
  },
  {
    "text": "are they being overwritten as needed Etc uh another key point in here you could you can actually uh see whether or not",
    "start": "3064640",
    "end": "3071119"
  },
  {
    "text": "guest access to the event logs is being restricted properly right and then so that's great and that gives us a lot of",
    "start": "3071119",
    "end": "3077280"
  },
  {
    "text": "information but it doesn't give us a picture of what's going on what's really being audited what's in the event log",
    "start": "3077280",
    "end": "3083520"
  },
  {
    "text": "and that's where we say maybe we want to bring in a resource kit utility like dumpel dump event lock it's a command",
    "start": "3083520",
    "end": "3090000"
  },
  {
    "text": "line utility very easy to run you basically Supply it with the name of the log you want to dump Security",
    "start": "3090000",
    "end": "3096240"
  },
  {
    "text": "application etc etc and it will spit out the logs now again maybe there's too",
    "start": "3096240",
    "end": "3102720"
  },
  {
    "text": "much information in here so one of the nice features of dump is that it lets you filter by event ID so you can go",
    "start": "3102720",
    "end": "3110040"
  },
  {
    "text": "look in Microsoft documentation and say all right I want to see security policy changes that means something has you",
    "start": "3110040",
    "end": "3116640"
  },
  {
    "text": "know somebody's changed the way the the auditing on this box happens I want to",
    "start": "3116640",
    "end": "3122440"
  },
  {
    "text": "see account lockout events I want to see um you know account uh disabled events so you",
    "start": "3122440",
    "end": "3130680"
  },
  {
    "text": "can filter you know pick out 529 539 you know 618 you give it those options and",
    "start": "3130680",
    "end": "3137760"
  },
  {
    "text": "you just run this small command line and it'll dump out those specific events and now you can say all right do I have any",
    "start": "3137760",
    "end": "3143040"
  },
  {
    "text": "security policy changes no oh yes I do and it was right here what what happened this wasn't scheduled",
    "start": "3143040",
    "end": "3149640"
  },
  {
    "text": "let me go follow up and you get you know there's you've all seen the event lock so part of the audit is for detection so",
    "start": "3149640",
    "end": "3156480"
  },
  {
    "text": "that is why you want to filter out 529 and 539 which are account lockout and incorrect password guesses and then say",
    "start": "3156480",
    "end": "3162680"
  },
  {
    "text": "to yourself well hm there seems to be an inordinate amount of password guesses at this one account and it kind of happens",
    "start": "3162680",
    "end": "3168119"
  },
  {
    "text": "three times every minute which is odd because I have my counter reset after one minute so those are the types of",
    "start": "3168119",
    "end": "3174319"
  },
  {
    "text": "things you want to look for and dumpel is going to make this so much easier for you than to have to go through the gooey",
    "start": "3174319",
    "end": "3180680"
  },
  {
    "text": "Event Viewer and look at all these things manually this gets back to what we discussed originally about relevancy",
    "start": "3180680",
    "end": "3185880"
  },
  {
    "text": "and timeliness by filtering this event log this way you're going to get only the information that's relevant to you",
    "start": "3185880",
    "end": "3191119"
  },
  {
    "text": "and you're going to be able to do the audit in a much more timely manner okay so that feeds us into network security",
    "start": "3191119",
    "end": "3199920"
  },
  {
    "text": "and basically the things here we're caring about are network resources so domains and trusts what is the envir",
    "start": "3199920",
    "end": "3206839"
  },
  {
    "text": "look like who can talk to who if we have our domain and there's another domain and we have great security over here but",
    "start": "3206839",
    "end": "3214319"
  },
  {
    "text": "they have lousy security over there and there are trusts we all know that basically we might as well have lousy",
    "start": "3214319",
    "end": "3219400"
  },
  {
    "text": "security too so we want to know what the environment looks like and the next",
    "start": "3219400",
    "end": "3224839"
  },
  {
    "text": "thing we care about what protocols are running if we're running uh net buoy net bios ipx you know what's going on how",
    "start": "3224839",
    "end": "3231599"
  },
  {
    "text": "are different machines talking to each other and then also IIs is something that lives here in network security and",
    "start": "3231599",
    "end": "3238760"
  },
  {
    "text": "um we basically want to see how is IIs configured there are aside from patches",
    "start": "3238760",
    "end": "3245920"
  },
  {
    "text": "and updates and hot fixes there are a lot of application Level settings that",
    "start": "3245920",
    "end": "3251640"
  },
  {
    "text": "prevent or allow high level of access to your machine a lot of you know that",
    "start": "3251640",
    "end": "3257200"
  },
  {
    "text": "things like the uh HTR printer uh script mappings in IIs provided uh a way to get",
    "start": "3257200",
    "end": "3265680"
  },
  {
    "text": "access to the system very easily by default there are you know a whole list",
    "start": "3265680",
    "end": "3271119"
  },
  {
    "text": "of application mappings extension mappings in IIs we want to see what those are have some of them have the",
    "start": "3271119",
    "end": "3277480"
  },
  {
    "text": "defaults been removed if we're only using HTML we don't need anything in there if we're only using ASP only ASP",
    "start": "3277480",
    "end": "3284480"
  },
  {
    "text": "should be in there you should not provide functionality that you don't need",
    "start": "3284480",
    "end": "3289599"
  },
  {
    "text": "so that's basically that same with FTP SMTP and uh nntp which",
    "start": "3289599",
    "end": "3296839"
  },
  {
    "text": "we don't see too much but that basically leads us into the tools what do we use",
    "start": "3296839",
    "end": "3302160"
  },
  {
    "text": "how do we look at these things so in the admin script directory of an IIs",
    "start": "3302160",
    "end": "3308240"
  },
  {
    "text": "installation you get a utility called adsu till.vs it's a Visual Basic script",
    "start": "3308240",
    "end": "3314200"
  },
  {
    "text": "that dumps What's called the metabase the IIs metabase is equivalent to the registry for Windows so it's basically",
    "start": "3314200",
    "end": "3321680"
  },
  {
    "text": "like I's big giant configuration file and if you run so you use use it here",
    "start": "3321680",
    "end": "3326720"
  },
  {
    "text": "with cscript which is the command line script interpreter cscript ads UIL enum",
    "start": "3326720",
    "end": "3332760"
  },
  {
    "text": "you can use enum which will dump out a whole bunch of information as you can as you'll see or you can use get to just",
    "start": "3332760",
    "end": "3338520"
  },
  {
    "text": "get specific values we'll do an enum here and then W3 SVC is the web service you can also use FTP Service Etc y so if",
    "start": "3338520",
    "end": "3346680"
  },
  {
    "text": "we dump this out we'll wait and then you see on the",
    "start": "3346680",
    "end": "3353160"
  },
  {
    "text": "left are metabase entry names and on the right are there values so here we see",
    "start": "3353160",
    "end": "3358319"
  },
  {
    "text": "that the anonymous username is I user Davy which tells us that Joe's machine's name is probably Davy and enable",
    "start": "3358319",
    "end": "3366160"
  },
  {
    "text": "directory browsing is set to false that's one of those things if there's no default document in the directory or",
    "start": "3366160",
    "end": "3372319"
  },
  {
    "text": "people going to get a listing generally we don't want that to happen so here it says false that won't happen and our",
    "start": "3372319",
    "end": "3378640"
  },
  {
    "text": "default docs are default.htm and default. ASP if that was set to uh true",
    "start": "3378640",
    "end": "3385599"
  },
  {
    "text": "and all of our directories did not contain default.htm or default.asp people would be getting directory",
    "start": "3385599",
    "end": "3391480"
  },
  {
    "text": "listings on our site keep going so again if you script this you'll be able to pull out very",
    "start": "3391480",
    "end": "3396680"
  },
  {
    "text": "important information like what are the IIs virtual Roots what is the user right that is required for the I user account",
    "start": "3396680",
    "end": "3405119"
  },
  {
    "text": "to access the IIs Services by default it is access computer from the network log",
    "start": "3405119",
    "end": "3411280"
  },
  {
    "text": "on locally however using this metabase not the Reg anymore that was in the old case",
    "start": "3411280",
    "end": "3417839"
  },
  {
    "text": "and then nt40 is the registry in new versions of Windows including Windows 2000 the the the uh metabase will have",
    "start": "3417839",
    "end": "3427200"
  },
  {
    "text": "an entry for the log on right and you can actually set it to access the computer from the network log on locally",
    "start": "3427200",
    "end": "3433920"
  },
  {
    "text": "which it is by default or uh the batch job One log on as a batch job yep yeah",
    "start": "3433920",
    "end": "3439119"
  },
  {
    "text": "something like that yes sorry and so there's a whole bunch there's script maps that we talked about earlier so",
    "start": "3439119",
    "end": "3444760"
  },
  {
    "text": "here we can tell that on Jo box he has not removed some of the uh default script mappings so you know ASA and CDX",
    "start": "3444760",
    "end": "3452319"
  },
  {
    "text": "is there but we know printer is not there and uh htx is not there so he has",
    "start": "3452319",
    "end": "3458119"
  },
  {
    "text": "gone some of the way so he has looked at this uh so maybe he has valid business reasons for still leaving these here um",
    "start": "3458119",
    "end": "3465559"
  },
  {
    "text": "some of the other things we want to look at are what kind of access rights are there read write um index things like",
    "start": "3465559",
    "end": "3473559"
  },
  {
    "text": "that we want to see if uh pads are allowed can you use dot dot slashes",
    "start": "3473559",
    "end": "3479000"
  },
  {
    "text": "because there we know there are some vulnerabilities that go along with that um we care about are detailed error",
    "start": "3479000",
    "end": "3485200"
  },
  {
    "text": "messages sent back to the browser when people have an error or does it just say you know page can not be found or does",
    "start": "3485200",
    "end": "3491640"
  },
  {
    "text": "it say unable to find seeon backin Pub dubdub duub rout blah blah blah that you requested and then you're giving them",
    "start": "3491640",
    "end": "3497920"
  },
  {
    "text": "enticement information which we're trying to minimize um so there's a ton of stuff in",
    "start": "3497920",
    "end": "3505119"
  },
  {
    "text": "here that is is valuable and important and ads UIL lets you you suck it out nicely yeah it's also the place where",
    "start": "3505119",
    "end": "3511400"
  },
  {
    "text": "you can pull out the is auditing settings those are listed in there under the log extended settings as well exactly yep um okay serve check serve",
    "start": "3511400",
    "end": "3519839"
  },
  {
    "text": "check okay so the next one while we're still in network security is shares that Todd mentioned so shares is one of those",
    "start": "3519839",
    "end": "3527359"
  },
  {
    "text": "one of those places that is a wideopen access point into your system you create",
    "start": "3527359",
    "end": "3533039"
  },
  {
    "text": "a share you're basically saying to someone you have some amount of access at this point on my file system so you",
    "start": "3533039",
    "end": "3539960"
  },
  {
    "text": "care here about two levels of security one what are the share permissions look like and two what do you then take that",
    "start": "3539960",
    "end": "3547599"
  },
  {
    "text": "information feed it into resource and say what are the NTFS level permissions look like serve check is a utility again",
    "start": "3547599",
    "end": "3555520"
  },
  {
    "text": "it's a resource kit utility and it only gets us part of the way but the part of the way that it gets us is it will show",
    "start": "3555520",
    "end": "3562000"
  },
  {
    "text": "us any shares on the system that have an access control list",
    "start": "3562000",
    "end": "3567760"
  },
  {
    "text": "so here we see we have a CIS file share a net log on share and a black hat share and at the share level we have",
    "start": "3567760",
    "end": "3573880"
  },
  {
    "text": "administrator full control on that everyone read on that everyone read on cisv Fall the problem is surf check doesn't",
    "start": "3573880",
    "end": "3581200"
  },
  {
    "text": "show you any shares that have a null dle by default when you create a share there's no access control list which is",
    "start": "3581200",
    "end": "3588119"
  },
  {
    "text": "effectively the same as everyone full control so as Joe did a net share here",
    "start": "3588119",
    "end": "3594079"
  },
  {
    "text": "you can see there's also a c dollar an admin dollar an IPC dollar now those by",
    "start": "3594079",
    "end": "3600119"
  },
  {
    "text": "default are admin shares which means they have no daal and you can't change them so it's okay but if Joe had another",
    "start": "3600119",
    "end": "3606559"
  },
  {
    "text": "share here that he had created that had no access control lists on it we would need the combination of the two to see",
    "start": "3606559",
    "end": "3613960"
  },
  {
    "text": "it again this is only part of the story though because now that we know everyone has read on cisv fall or everyone has",
    "start": "3613960",
    "end": "3620760"
  },
  {
    "text": "full control on whatever it was what do they really have and we won't find that out until we get down into resource y um",
    "start": "3620760",
    "end": "3629599"
  },
  {
    "text": "the the other Tool uh that you could potentially use for some of this is dump SEC uh dump SEC does have the ability to",
    "start": "3629599",
    "end": "3635400"
  },
  {
    "text": "pull uh a list of available shares a list of particular share permissions uh",
    "start": "3635400",
    "end": "3640720"
  },
  {
    "text": "it's a little bit more difficult because it's not quite as robust about pulling all the shares at once uh it would take",
    "start": "3640720",
    "end": "3646200"
  },
  {
    "text": "a little bit more effort to actually script that uh likewise dumps SEC uh for those of you that are familiar with it",
    "start": "3646200",
    "end": "3651760"
  },
  {
    "text": "would also pull trust relationships as part of that uh you could launch it and you could pull specific trust relationships as well right and dumpsack",
    "start": "3651760",
    "end": "3658720"
  },
  {
    "text": "is the newer version of dump ACL which you may be familiar with and it's a free tool from somar",
    "start": "3658720",
    "end": "3664839"
  },
  {
    "text": "soft so uh to actually pull the the trust relationships it's part of the policiy report uh you would launch dumps",
    "start": "3664839",
    "end": "3671039"
  },
  {
    "text": "SEC uh go to the report menu do dump policies it would dump the policies uh",
    "start": "3671039",
    "end": "3676760"
  },
  {
    "text": "and under trust trusted domains it would actually list any trusted domains that are there and then the last the last",
    "start": "3676760",
    "end": "3683319"
  },
  {
    "text": "part of the network settings uh basic information basic blocking and tackling uh using IP config and net stat minusa",
    "start": "3683319",
    "end": "3690119"
  },
  {
    "text": "to basically pull the IP address information and net stat to pull any listenting and active services that are",
    "start": "3690119",
    "end": "3696440"
  },
  {
    "text": "available uh other tools that are out there you could use something like fport or in map to to get a list of active",
    "start": "3696440",
    "end": "3701680"
  },
  {
    "text": "Services as well obviously uh looking at resource security uh this is again a very large",
    "start": "3701680",
    "end": "3708359"
  },
  {
    "text": "part of of the audit a very critical part and like we've been talking about all the other things we've done up until",
    "start": "3708359",
    "end": "3714880"
  },
  {
    "text": "this point should feed resource security yes you're going to want to look at things like winnt system 32 drivers Etc",
    "start": "3714880",
    "end": "3722319"
  },
  {
    "text": "but it's also critical at this point to look at any system services that are out there any executables that are running",
    "start": "3722319",
    "end": "3727720"
  },
  {
    "text": "under them it's critical if I is running to locate the inet pub directory uh that",
    "start": "3727720",
    "end": "3733160"
  },
  {
    "text": "may not be hopefully it's not on the C drive hopefully it's not cinet Pub hopefully it's on the de or some other",
    "start": "3733160",
    "end": "3739640"
  },
  {
    "text": "drive so taking the information that you got during the network checks and the system checks to understand",
    "start": "3739640",
    "end": "3746440"
  },
  {
    "text": "is is installed and if it is where is it installed and then looking at it at that point is a critical step in this process",
    "start": "3746440",
    "end": "3754079"
  },
  {
    "text": "uh historically under the nt4 what we were really concerned about here from a resource perspective were registry",
    "start": "3754079",
    "end": "3759839"
  },
  {
    "text": "permissions file and directory permissions permissions on shares uh a new thing that comes up with Windows",
    "start": "3759839",
    "end": "3766559"
  },
  {
    "text": "2000 obviously is active directory permissions what are some critical active directory containers and",
    "start": "3766559",
    "end": "3772880"
  },
  {
    "text": "organizational units and what are the accles on those directory objects uh this is something unfortunately there",
    "start": "3772880",
    "end": "3779119"
  },
  {
    "text": "aren't a lot of tools out there uh that do that there are some that we'll talk about uh Microsoft has provided some in",
    "start": "3779119",
    "end": "3784760"
  },
  {
    "text": "the resource kit uh and this is a critical step in assessing any Windows 2000 environment is is sitting down",
    "start": "3784760",
    "end": "3791400"
  },
  {
    "text": "looking at the Active Directory structure figuring out which OS are critical and figuring out what the access controls are on those U so I",
    "start": "3791400",
    "end": "3798359"
  },
  {
    "text": "think we listed all those critical resources um again to access the Legacy",
    "start": "3798359",
    "end": "3803720"
  },
  {
    "text": "the Legacy things that would be the file on directory permissions the registry permissions you use SEC at it uh there's",
    "start": "3803720",
    "end": "3809319"
  },
  {
    "text": "a file system area where you could go in there and you could Define what are the defaults I would I would definitely",
    "start": "3809319",
    "end": "3815319"
  },
  {
    "text": "start with that default listing and then once you find out what are the other critical areas in there You' add those in likewise registry permissions you can",
    "start": "3815319",
    "end": "3822559"
  },
  {
    "text": "go in you can Define uh if you go out to the Microsoft website or you read the NSA configuration or any other manual",
    "start": "3822559",
    "end": "3829359"
  },
  {
    "text": "you you'd like you're going to get a laundry list of registry F uh values and and d uh keys that should be secured as",
    "start": "3829359",
    "end": "3835520"
  },
  {
    "text": "well right and then on top of those you would want to dump in you know any custom in-house apps that you have that write",
    "start": "3835520",
    "end": "3841079"
  },
  {
    "text": "to the registry you want to pull out those and throw them in there too uh looking at DS accles uh because",
    "start": "3841079",
    "end": "3847880"
  },
  {
    "text": "that's actually I think one of the one of the more interesting ones DS accles is actually a lot like cackles or X",
    "start": "3847880",
    "end": "3853880"
  },
  {
    "text": "cackles or or or any of the other uh commandline tools out there that will dump Access Control list except it does",
    "start": "3853880",
    "end": "3859640"
  },
  {
    "text": "it for the directory Services the the use of the tool is very simple it's dles and then you just put",
    "start": "3859640",
    "end": "3865279"
  },
  {
    "text": "the the the ldap path that you're concerned about um let's say um we had",
    "start": "3865279",
    "end": "3870880"
  },
  {
    "text": "we wanted to know what the permissions were on the user container you type CN equals user comma DC equals the domain",
    "start": "3870880",
    "end": "3877000"
  },
  {
    "text": "name in this case it's going to be gold comma DC equals black hat comma DC equals uh",
    "start": "3877000",
    "end": "3886520"
  },
  {
    "text": "Comm so what is wrong there if it does",
    "start": "3887200",
    "end": "3895119"
  },
  {
    "text": "that not what I",
    "start": "3901680",
    "end": "3904240"
  },
  {
    "text": "typed thought I typed that so one of the important things that you want to make sure during your audit methodology is",
    "start": "3907880",
    "end": "3913880"
  },
  {
    "text": "that you are looking at permissions on active directory objects as Joe is saying you want to make sure that people",
    "start": "3913880",
    "end": "3919279"
  },
  {
    "text": "can't change you know it doesn't if if you're looking at the container for who the administrator is and someone had and",
    "start": "3919279",
    "end": "3925119"
  },
  {
    "text": "everyone has write permissions to it well then anyone who's not an administrator can add themselves to the administrator group you also want to",
    "start": "3925119",
    "end": "3931440"
  },
  {
    "text": "make sure that you include this part into your methodology if you are indeed on the domain controller and you indeed",
    "start": "3931440",
    "end": "3936720"
  },
  {
    "text": "are in Windows 2000 so again you want to make sure you pull that stuff from the system security assessment and now the",
    "start": "3936720",
    "end": "3942319"
  },
  {
    "text": "Demo's ready y uh and and this this is going to be a key one uh as as Todd was",
    "start": "3942319",
    "end": "3948160"
  },
  {
    "text": "saying I mean you want to make sure that that you know where all your admin user objects are and based on what and this",
    "start": "3948160",
    "end": "3953760"
  },
  {
    "text": "is another linkage between user and between resources uh you find out you've got a domain admin uh account that's in",
    "start": "3953760",
    "end": "3961039"
  },
  {
    "text": "a specific OU called you know West users and control of that OU has been",
    "start": "3961039",
    "end": "3966359"
  },
  {
    "text": "delegated to the help desk now your help desk can reset that domain admin account's password so looking at the AAL",
    "start": "3966359",
    "end": "3972240"
  },
  {
    "text": "I mean you want to make sure you're looking at your basic ones like users domain controllers config things of that nature and you want to look at any",
    "start": "3972240",
    "end": "3978359"
  },
  {
    "text": "specific custom ones that you have out there and that's going to have to be customized to your",
    "start": "3978359",
    "end": "3983839"
  },
  {
    "text": "environment uh MS 32 which we've seen before and I don't know we pull it up",
    "start": "3983839",
    "end": "3990720"
  },
  {
    "text": "again but it's basically those the four commands earlier I don't",
    "start": "3990720",
    "end": "3996279"
  },
  {
    "text": "know if we want to show what it does give you the ability to do as well is is the drives report which actually will",
    "start": "3996279",
    "end": "4002200"
  },
  {
    "text": "show you uh whether or not all your drives are in TFS if there are any fat drives that are out there it'll also",
    "start": "4002200",
    "end": "4007400"
  },
  {
    "text": "give you configuration information related to um the amount of free space that's available on each Drive obviously",
    "start": "4007400",
    "end": "4013680"
  },
  {
    "text": "you'd want to know if if any of those drives are are are going to be close to capacity or something like that",
    "start": "4013680",
    "end": "4019359"
  },
  {
    "text": "right EFS and TFS important things and then and then the last tool we had here",
    "start": "4019359",
    "end": "4025960"
  },
  {
    "text": "uh relates to again it's a platform SDK utility that we just compiled quickly",
    "start": "4025960",
    "end": "4031960"
  },
  {
    "text": "basically what check SD does is check security descriptors so for objects that",
    "start": "4031960",
    "end": "4037720"
  },
  {
    "text": "you can't get through uh DS accles or through security configuration editor",
    "start": "4037720",
    "end": "4042839"
  },
  {
    "text": "like printer permissions um maybe you have a uh you know a printer that holds",
    "start": "4042839",
    "end": "4048319"
  },
  {
    "text": "check paper you want to see who can submit jobs to that who can manage that printer who can add and delete printers",
    "start": "4048319",
    "end": "4053839"
  },
  {
    "text": "so check SD you can just leave it right there as you can see you could use it for files you could use it like a uh",
    "start": "4053839",
    "end": "4060240"
  },
  {
    "text": "like a cackles but it'll also do a lot of other system objects like printers",
    "start": "4060240",
    "end": "4065559"
  },
  {
    "text": "like the window station or a mail slot you can also get it with service",
    "start": "4065559",
    "end": "4070760"
  },
  {
    "text": "unfortunately here though the output is horribly ugly it actually goes through and lists",
    "start": "4070760",
    "end": "4076799"
  },
  {
    "text": "each individual Access Control entry within the list and then it's access mask but again it's open source so if",
    "start": "4076799",
    "end": "4083200"
  },
  {
    "text": "you were so inclined you could pretty it up and do whatever you'd like yeah I mean that that's really a key point for",
    "start": "4083200",
    "end": "4088319"
  },
  {
    "text": "all the tools we're talking about here we're trying to give you a baseline a starting point a lot of these tools are",
    "start": "4088319",
    "end": "4094119"
  },
  {
    "text": "open source you could take a look at them and you can actually modify them for your use which is in fact what what what we've done we we've we've taken",
    "start": "4094119",
    "end": "4100640"
  },
  {
    "text": "some of these tools and modified them I'll add something too horribly ugly is not the worst thing if it gets you off",
    "start": "4100640",
    "end": "4106238"
  },
  {
    "text": "your box really fast and it works then and it gives you all the information you need horribly ugly isn't all that bad",
    "start": "4106239",
    "end": "4113080"
  },
  {
    "text": "you know it just means that you're going to have to spend a little extra time on the back end reviewing it",
    "start": "4113080",
    "end": "4118679"
  },
  {
    "text": "but right again if but going back to Todd's earlier point if you get your information quickly but it takes you an",
    "start": "4118679",
    "end": "4126920"
  },
  {
    "text": "extraordinarily amount of long time to go through it then your information is no longer timely yep moving on to users",
    "start": "4126920",
    "end": "4135159"
  },
  {
    "text": "obvious obviously we're all concerned about users uh when we talk about users we're also talking about the groups that those users are a member of we're",
    "start": "4135159",
    "end": "4141040"
  },
  {
    "text": "concerns with what are the user account policies do any users have passwords that do not expire uh are users being",
    "start": "4141040",
    "end": "4147520"
  },
  {
    "text": "forced to change their password upon log gun what are the account policies uh is there account lockout obviously we're",
    "start": "4147520",
    "end": "4153798"
  },
  {
    "text": "not going to go through password length and things like that I think you've all probably at least heard that once in your life if not a hundred times uh but",
    "start": "4153799",
    "end": "4160238"
  },
  {
    "text": "user rights as well what privileges do specific users or specific groups have this is all very Central to getting a",
    "start": "4160239",
    "end": "4166040"
  },
  {
    "text": "good understanding for the server as a whole right and again this is one of those places where something as simple",
    "start": "4166040",
    "end": "4172040"
  },
  {
    "text": "as the platform you're looking at matters because if it's Windows NT you've got 27 user rights if you're in",
    "start": "4172040",
    "end": "4177238"
  },
  {
    "text": "Windows 2000 you've got 34 when you get to net server you're up to 37 and you need to make sure that your methodology",
    "start": "4177239",
    "end": "4184000"
  },
  {
    "text": "is growing with the new operating systems and and and and likewise along",
    "start": "4184000",
    "end": "4189798"
  },
  {
    "text": "those same lines um one of the weaknesses uh dump SEC was a great tool for Windows NT uh for dumping users in",
    "start": "4189799",
    "end": "4196840"
  },
  {
    "text": "groups not so well for Windows 2000 for a couple reasons one nested groups you can do nested groups in Windows 2000",
    "start": "4196840",
    "end": "4203880"
  },
  {
    "text": "well if you've checked the option within dumps sec to fully expand each group it'll get CAU in an endless loop as soon",
    "start": "4203880",
    "end": "4209760"
  },
  {
    "text": "as it gets to a nested group because it gets trapped in there trying to expand that group likewise it's not aware of",
    "start": "4209760",
    "end": "4216040"
  },
  {
    "text": "all the new active directory properties within dumps SEC so dump SEC was a tool we used quite a bit in the nt4 world to",
    "start": "4216040",
    "end": "4222920"
  },
  {
    "text": "dump user right or to dump user properties and group properties and then Windows 2000 World had to go back to the",
    "start": "4222920",
    "end": "4228840"
  },
  {
    "text": "SDK look up a couple things and you know write a quick program that that would go ahead and dump that for us uh but the",
    "start": "4228840",
    "end": "4235600"
  },
  {
    "text": "basics the account policy information which is also basic user information is all really stored within the or really",
    "start": "4235600",
    "end": "4241920"
  },
  {
    "text": "obtained through the SEC edit utility security configuration and Analysis uh you can get password policies uh account",
    "start": "4241920",
    "end": "4247960"
  },
  {
    "text": "lockouts things of that nature okay and then as Joe said to kind",
    "start": "4247960",
    "end": "4253360"
  },
  {
    "text": "of mitigate the shortcoming of dumps the active directory world uh another Microsoft tool is uh the active",
    "start": "4253360",
    "end": "4259840"
  },
  {
    "text": "directory Services viewer adsv that is a gooey utility that it",
    "start": "4259840",
    "end": "4266320"
  },
  {
    "text": "it's very raw but it basically dumps the information that you need yeah so just",
    "start": "4266320",
    "end": "4271560"
  },
  {
    "text": "click okay so here we basically just pointed",
    "start": "4271560",
    "end": "4277239"
  },
  {
    "text": "it at the root of his box so we just did an ldap colon colon and then the uh",
    "start": "4277239",
    "end": "4283120"
  },
  {
    "text": "server name and then a colon 38 because that's the ldap port and if you click on",
    "start": "4283120",
    "end": "4288480"
  },
  {
    "text": "each one of these objects on the left you know it expands and gives you",
    "start": "4288480",
    "end": "4294199"
  },
  {
    "text": "the the stuff that's in there so in the built-in container we have these groups account operators administrators backup",
    "start": "4294199",
    "end": "4300840"
  },
  {
    "text": "operators when you click on each one of those if there are things inside like",
    "start": "4300840",
    "end": "4306360"
  },
  {
    "text": "here the users group if there are objects inside it'll expand and it'll give you the list of those objects and",
    "start": "4306360",
    "end": "4312040"
  },
  {
    "text": "then when you click on those individual objects it'll put all the properties in the right hand side for example you see",
    "start": "4312040",
    "end": "4317639"
  },
  {
    "text": "the ads path shows you the the full uh fully qualified domain name of that",
    "start": "4317639",
    "end": "4322960"
  },
  {
    "text": "object and this is where you can really see a user property and a user and group",
    "start": "4322960",
    "end": "4329199"
  },
  {
    "text": "membership perspective in ad and the code for for for this tool is all in msdn as well it it's actually an example",
    "start": "4329199",
    "end": "4336360"
  },
  {
    "text": "which is what it was really originally written for so it's another tool that you could take and you can tweak just a little bit more to specifically work in",
    "start": "4336360",
    "end": "4342520"
  },
  {
    "text": "your environment right and lastly is uh passwords of course that's usually the",
    "start": "4342520",
    "end": "4347960"
  },
  {
    "text": "number one way a hacker breaks in is by guessing a simple password so it's important for you to actually udit these",
    "start": "4347960",
    "end": "4353480"
  },
  {
    "text": "passwords if you don't have other controls in place to make sure they're long and complex using password filters",
    "start": "4353480",
    "end": "4358639"
  },
  {
    "text": "Etc so there are tools out there that allow you to dump passwords there's a lot of them um so PW you could you could",
    "start": "4358639",
    "end": "4365360"
  },
  {
    "text": "tell by the organization of this presentation that they give me the difficult tools to uh to demonstrate to",
    "start": "4365360",
    "end": "4370880"
  },
  {
    "text": "you but uh don't let that take away from my uh extraordinary K set here",
    "start": "4370880",
    "end": "4376800"
  },
  {
    "text": "the tool dumps out a ntlm and no what is it it's a land",
    "start": "4376800",
    "end": "4384280"
  },
  {
    "text": "manager version of the hash and it's a ntlm whatever you're using version two however it's going to be stored",
    "start": "4384280",
    "end": "4389840"
  },
  {
    "text": "depending on right so y so you then need to throw that into a brood Force cracker",
    "start": "4389840",
    "end": "4395360"
  },
  {
    "text": "like loft is the most famous one I mean that's uh that'll do the job but there's a lot of other ones out there quick",
    "start": "4395360",
    "end": "4401199"
  },
  {
    "text": "right right down that hash yeah I know right and the purp purpose of this of course is for administrators to make",
    "start": "4401199",
    "end": "4407719"
  },
  {
    "text": "sure that they you this is a really good way for administrators to force their users to have good passwords because if he throws it into Loft and lets it run",
    "start": "4407719",
    "end": "4414679"
  },
  {
    "text": "for on a fast computer just let it run for a day there's no point in doing a brood Force attack you just want to check it against dictionary words then",
    "start": "4414679",
    "end": "4421400"
  },
  {
    "text": "he can or she can go up to them individually and say look you know I'm going to disable your account your password is the word",
    "start": "4421400",
    "end": "4427280"
  },
  {
    "text": "welcome this is uh this is some point of contention because obviously some companies don't want their",
    "start": "4427280",
    "end": "4432400"
  },
  {
    "text": "administrators dumping out passwords because it allows the administrators to improve personate the users however based on your policy you might want to",
    "start": "4432400",
    "end": "4438239"
  },
  {
    "text": "implement a control like this sometimes it's good for you to do it sometimes it's not you want to make sure there's other controls in place like password",
    "start": "4438239",
    "end": "4443880"
  },
  {
    "text": "length password filters Etc yep right and again here just to to tie back to",
    "start": "4443880",
    "end": "4449159"
  },
  {
    "text": "some of the information earlier we saw user contexts on uh on scheduled jobs we",
    "start": "4449159",
    "end": "4456080"
  },
  {
    "text": "saw users in groups listed in acl's in resource security so this is the point",
    "start": "4456080",
    "end": "4461159"
  },
  {
    "text": "where now we have a list of all these users and groups that have access to all these different resources and are the",
    "start": "4461159",
    "end": "4468199"
  },
  {
    "text": "the context for services the context for jobs all of the system this is when we really look and say okay who are these",
    "start": "4468199",
    "end": "4474520"
  },
  {
    "text": "people what are the properties of those user accounts if it's a a service executable account does it have a strong",
    "start": "4474520",
    "end": "4480880"
  },
  {
    "text": "password you know just to tie it all back so now we've covered The Fabulous",
    "start": "4480880",
    "end": "4486440"
  },
  {
    "text": "Five we've covered an entire audit methodology going around all five security segments so now you're probably",
    "start": "4486440",
    "end": "4492159"
  },
  {
    "text": "saying okay great now I could run off and go do my audit m methodology no problem I'll just go figure out what",
    "start": "4492159",
    "end": "4497199"
  },
  {
    "text": "freeware tools that are best for me and download them all but wait there's",
    "start": "4497199",
    "end": "4502320"
  },
  {
    "text": "more that was a lot less cheesy when we came up with it last night no it was just as cheesy and what we want to do",
    "start": "4502320",
    "end": "4509120"
  },
  {
    "text": "now is tie it all together risk management actually we just kind of covered that with the password hash but",
    "start": "4509120",
    "end": "4515080"
  },
  {
    "text": "you want to make sure that what you're doing does follow the risk management procedures of your company some of them have more Stringer procedures some less",
    "start": "4515080",
    "end": "4520840"
  },
  {
    "text": "that's not going to be part of your audit methodology unless you're actually going to Bubble up to that level but you want to make sure that what you're doing is within your standards you want to",
    "start": "4520840",
    "end": "4527400"
  },
  {
    "text": "make sure that it's okay to run things locally if that's the methodology you're going to use you want to make sure that",
    "start": "4527400",
    "end": "4533400"
  },
  {
    "text": "you are dumping out things that aren't confidential to who you are in other words password hashes it's important",
    "start": "4533400",
    "end": "4540320"
  },
  {
    "text": "that you actually are following this whatever regulatory requirements you have you're actually obeying them by",
    "start": "4540320",
    "end": "4546239"
  },
  {
    "text": "doing your audits on a regular basis I think you know Hippa requires actually I",
    "start": "4546239",
    "end": "4551440"
  },
  {
    "text": "don't know the specific numbers but Hippa does require there to be certain security setting certain security audits",
    "start": "4551440",
    "end": "4556800"
  },
  {
    "text": "done so that's the timing piece comprehens again it's so important to remember these three pieces you want to",
    "start": "4556800",
    "end": "4562639"
  },
  {
    "text": "make sure that all of the five Fabulous Five get covered by comprehensiveness relevancy and customization you've got",
    "start": "4562639",
    "end": "4569480"
  },
  {
    "text": "to make sure that your audit methodology is tweak tailored and targeted towards your environment you really cannot just",
    "start": "4569480",
    "end": "4575920"
  },
  {
    "text": "go download someone's tool and say ah okay I'm running it it works because at the end of the day it's",
    "start": "4575920",
    "end": "4581280"
  },
  {
    "text": "not it's not going to tell you if you are vulnerable it's going to tell you if some generic standard server server",
    "start": "4581280",
    "end": "4588880"
  },
  {
    "text": "vulnerable and and I think the final thing there is is these are some tools",
    "start": "4588880",
    "end": "4594239"
  },
  {
    "text": "there are obviously other tools out there there are things like ISS and cyber cybercop which are going to do some other similar checks what you need",
    "start": "4594239",
    "end": "4600880"
  },
  {
    "text": "to do is sit down and look at what are your existing tools you have today that your staff has that they're comfortable with and what are the gaps to fill in",
    "start": "4600880",
    "end": "4607120"
  },
  {
    "text": "the rest of that methodology maybe you only take three tools away from what we talked about or maybe you only take the",
    "start": "4607120",
    "end": "4612960"
  },
  {
    "text": "three idas ideas away because you you got some other tools that are doing Parts a through X or whatever but you",
    "start": "4612960",
    "end": "4619360"
  },
  {
    "text": "still need Y and Z so taking what you have doing that Gap analysis to the",
    "start": "4619360",
    "end": "4624400"
  },
  {
    "text": "methodology and saying here are the other tools we need we're either going to go out and we're going to use an existing product or we're going to build",
    "start": "4624400",
    "end": "4630520"
  },
  {
    "text": "our own you know most of the stuff is is fairly simple bu you could build your",
    "start": "4630520",
    "end": "4635840"
  },
  {
    "text": "own I mean right basically this is the process that Joe said very at the very beginning of the presentation this is",
    "start": "4635840",
    "end": "4642120"
  },
  {
    "text": "what we did starting a couple of years ago and we determined that for our needs managing this kind of a a multi-tool",
    "start": "4642120",
    "end": "4649280"
  },
  {
    "text": "environment things that would allow changes to the system etc etc wasn't acceptable for Price waterhous Cooper so",
    "start": "4649280",
    "end": "4655840"
  },
  {
    "text": "what we did we don't have a script that incorporates these but we have a a proprietary program that incorporates",
    "start": "4655840",
    "end": "4663159"
  },
  {
    "text": "all of these Concepts and hits on all these areas and basically goes through in the order that we we discuss today so",
    "start": "4663159",
    "end": "4670800"
  },
  {
    "text": "that when you first hit system security it determines the type of system we're looking at and and then moves down the",
    "start": "4670800",
    "end": "4675960"
  },
  {
    "text": "line and it's something we developed you know in from the ground up in C to do",
    "start": "4675960",
    "end": "4682000"
  },
  {
    "text": "all of these things and of course that's an option you know for everyone well at this point you guys",
    "start": "4682000",
    "end": "4687719"
  },
  {
    "text": "have questions obviously we're here to answer them we have 7 minutes left but uh go ahead and shoot and uh if you have",
    "start": "4687719",
    "end": "4694440"
  },
  {
    "text": "no questions obviously you're welcome to leave our contact information is up here feel free to email us if you want",
    "start": "4694440",
    "end": "4700320"
  },
  {
    "text": "whatever present plenty of business cards up here fre to step and give this this version of the presentation to",
    "start": "4700320",
    "end": "4707120"
  },
  {
    "text": "black hat to put up on the website so that you can all download it and if any of you are having trouble finding some of these tools if we talked about tools",
    "start": "4707120",
    "end": "4712320"
  },
  {
    "text": "and and for some reason you can't find them on the web send us an email everything we talked about is free we we",
    "start": "4712320",
    "end": "4718000"
  },
  {
    "text": "can shoot it to you or we can show you where to where to get it from the SDK Etc David doesn't work very hard email",
    "start": "4718000",
    "end": "4723199"
  },
  {
    "text": "him whatever you need he'll be more than happy to get something for send it to David first please sit around it's it's really believe",
    "start": "4723199",
    "end": "4728960"
  },
  {
    "text": "me okay so questions",
    "start": "4728960",
    "end": "4733440"
  },
  {
    "text": "wow excellent I think they're ready for wow I think everyone in this room is ready to go start their own we do our",
    "start": "4735120",
    "end": "4740480"
  },
  {
    "text": "parade right now right right right down this way I think everybody wants to go to Marty G it's 6 o'clock on Marty G house well thanks guys thank you all",
    "start": "4740480",
    "end": "4747000"
  },
  {
    "text": "very much [Applause]",
    "start": "4747000",
    "end": "4753479"
  },
  {
    "text": "enjoy",
    "start": "4754800",
    "end": "4757800"
  },
  {
    "text": "okay",
    "start": "4763719",
    "end": "4766719"
  },
  {
    "text": "e",
    "start": "4793639",
    "end": "4796639"
  },
  {
    "text": "e",
    "start": "4823639",
    "end": "4826639"
  },
  {
    "text": "e",
    "start": "4853639",
    "end": "4856639"
  },
  {
    "text": "e e",
    "start": "4883560",
    "end": "4887560"
  },
  {
    "text": "e",
    "start": "5003440",
    "end": "5006440"
  },
  {
    "text": "e",
    "start": "5033440",
    "end": "5036440"
  },
  {
    "text": "e",
    "start": "5063320",
    "end": "5066320"
  },
  {
    "text": "e e",
    "start": "5093320",
    "end": "5097360"
  },
  {
    "text": "for",
    "start": "5183239",
    "end": "5186239"
  },
  {
    "text": "e",
    "start": "5213239",
    "end": "5216239"
  },
  {
    "text": "e",
    "start": "5243119",
    "end": "5246119"
  },
  {
    "text": "e",
    "start": "5273119",
    "end": "5276119"
  },
  {
    "text": "e e",
    "start": "5303119",
    "end": "5307119"
  },
  {
    "text": "e",
    "start": "5482920",
    "end": "5485920"
  },
  {
    "text": "e e",
    "start": "5512840",
    "end": "5516880"
  },
  {
    "text": "e",
    "start": "5602760",
    "end": "5605760"
  },
  {
    "text": "e",
    "start": "5632719",
    "end": "5635719"
  },
  {
    "text": "e",
    "start": "5662719",
    "end": "5665719"
  },
  {
    "text": "e",
    "start": "5692639",
    "end": "5695639"
  },
  {
    "text": "e",
    "start": "5722639",
    "end": "5725639"
  },
  {
    "text": "e",
    "start": "5752639",
    "end": "5755639"
  },
  {
    "text": "e",
    "start": "5782560",
    "end": "5785560"
  },
  {
    "text": "e",
    "start": "5812520",
    "end": "5815520"
  },
  {
    "text": "e",
    "start": "5842520",
    "end": "5845520"
  },
  {
    "text": "e",
    "start": "5872440",
    "end": "5875440"
  },
  {
    "text": "e",
    "start": "5902440",
    "end": "5905440"
  },
  {
    "text": "e",
    "start": "5932440",
    "end": "5935440"
  },
  {
    "text": "e",
    "start": "5962360",
    "end": "5965360"
  },
  {
    "text": "e",
    "start": "5992320",
    "end": "5995320"
  },
  {
    "text": "e",
    "start": "6022320",
    "end": "6025320"
  },
  {
    "text": "e",
    "start": "6052239",
    "end": "6055239"
  },
  {
    "text": "e",
    "start": "6082239",
    "end": "6085239"
  },
  {
    "text": "e",
    "start": "6112239",
    "end": "6115239"
  },
  {
    "text": "e",
    "start": "6142159",
    "end": "6145159"
  },
  {
    "text": "e",
    "start": "6172119",
    "end": "6175119"
  },
  {
    "text": "e",
    "start": "6202119",
    "end": "6205119"
  },
  {
    "text": "e",
    "start": "6232040",
    "end": "6235040"
  },
  {
    "text": "e",
    "start": "6262040",
    "end": "6265040"
  },
  {
    "text": "e",
    "start": "6292040",
    "end": "6295040"
  },
  {
    "text": "e",
    "start": "6321960",
    "end": "6324960"
  },
  {
    "text": "e",
    "start": "6351920",
    "end": "6354920"
  },
  {
    "text": "e",
    "start": "6381920",
    "end": "6384920"
  },
  {
    "text": "e",
    "start": "6411840",
    "end": "6414840"
  },
  {
    "text": "e",
    "start": "6441840",
    "end": "6444840"
  },
  {
    "text": "e",
    "start": "6471840",
    "end": "6474840"
  },
  {
    "text": "e",
    "start": "6501760",
    "end": "6504760"
  },
  {
    "text": "e",
    "start": "6531719",
    "end": "6534719"
  },
  {
    "text": "e",
    "start": "6561719",
    "end": "6564719"
  },
  {
    "text": "e",
    "start": "6591639",
    "end": "6594639"
  },
  {
    "text": "e",
    "start": "6621639",
    "end": "6624639"
  },
  {
    "text": "e",
    "start": "6651639",
    "end": "6654639"
  },
  {
    "text": "e",
    "start": "6681560",
    "end": "6684560"
  },
  {
    "text": "e",
    "start": "6711520",
    "end": "6714520"
  },
  {
    "text": "e",
    "start": "6741520",
    "end": "6744520"
  },
  {
    "text": "e",
    "start": "6771440",
    "end": "6774440"
  },
  {
    "text": "e",
    "start": "6801440",
    "end": "6804440"
  },
  {
    "text": "e",
    "start": "6831440",
    "end": "6834440"
  },
  {
    "text": "e",
    "start": "6861360",
    "end": "6864360"
  },
  {
    "text": "e",
    "start": "6891320",
    "end": "6894320"
  },
  {
    "text": "e",
    "start": "6921320",
    "end": "6924320"
  },
  {
    "text": "e",
    "start": "6951239",
    "end": "6954239"
  },
  {
    "text": "e",
    "start": "6981239",
    "end": "6984239"
  },
  {
    "text": "e",
    "start": "7011239",
    "end": "7014239"
  },
  {
    "text": "e",
    "start": "7041159",
    "end": "7044159"
  },
  {
    "text": "e",
    "start": "7071119",
    "end": "7074119"
  },
  {
    "text": "e",
    "start": "7101119",
    "end": "7104119"
  },
  {
    "text": "e",
    "start": "7131040",
    "end": "7134040"
  },
  {
    "text": "e",
    "start": "7161040",
    "end": "7164040"
  },
  {
    "text": "e",
    "start": "7191040",
    "end": "7194040"
  },
  {
    "text": "e",
    "start": "7220960",
    "end": "7223960"
  },
  {
    "text": "e",
    "start": "7250920",
    "end": "7253920"
  },
  {
    "text": "e",
    "start": "7280920",
    "end": "7283920"
  },
  {
    "text": "e for",
    "start": "7310840",
    "end": "7314880"
  }
]