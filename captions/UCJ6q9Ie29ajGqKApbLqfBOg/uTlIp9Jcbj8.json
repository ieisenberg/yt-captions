[
  {
    "text": "um and i told him uh i'd plug his book he didn't want me to but uh it's uh",
    "start": "53199",
    "end": "59520"
  },
  {
    "text": "web hacking uh attacks and defense uh breakpoint's got it outside uh he'll be doing a signing uh at lunch you doing it",
    "start": "59520",
    "end": "66799"
  },
  {
    "text": "upstairs at launch somewhere so um look for him pick up a copy if you don't have it",
    "start": "66799",
    "end": "72880"
  },
  {
    "text": "and mr shah",
    "start": "72880",
    "end": "76079"
  },
  {
    "text": "i will refrain from using this haunted house mic because it's making all the creaking noises scares me",
    "start": "81840",
    "end": "89360"
  },
  {
    "text": "as the audience doesn't scare me even further thank you arthur thanks for the quick introduction i will",
    "start": "89360",
    "end": "96479"
  },
  {
    "text": "just add a little bit more to it i am so milshah director of net square we are a",
    "start": "96479",
    "end": "101600"
  },
  {
    "text": "little sharp security shop based out of india we but we've been here we've been working in",
    "start": "101600",
    "end": "107360"
  },
  {
    "text": "the us and stay on top of http research that's our game i would be failing in my duties if i",
    "start": "107360",
    "end": "113920"
  },
  {
    "text": "also did not point out the help of my colleague srirach sitting in the first row another co-author of web hacking",
    "start": "113920",
    "end": "121040"
  },
  {
    "text": "attacks and defense he is the silent but deadly types he does a lot of research and",
    "start": "121040",
    "end": "127600"
  },
  {
    "text": "you know together what we've worked on and what we're going to bring to you today is",
    "start": "127600",
    "end": "133840"
  },
  {
    "text": "all of all our efforts put together so with that uh hope you enjoy the talk",
    "start": "133840",
    "end": "140400"
  },
  {
    "text": "so what i'm going to talk about is some uh you know some innovations in",
    "start": "140400",
    "end": "145599"
  },
  {
    "text": "the way we do web security and you know three key concepts that i'm going to talk about and i shall introduce them as",
    "start": "145599",
    "end": "152800"
  },
  {
    "text": "we go along um as usual please feel free to pound me with questions once i'm done at",
    "start": "152800",
    "end": "159840"
  },
  {
    "text": "the end of the talk if the question is entirely urgent you may feel free to stop me even in the middle of my talk",
    "start": "159840",
    "end": "166800"
  },
  {
    "text": "so let's let's go so before we begin i always",
    "start": "166800",
    "end": "172239"
  },
  {
    "text": "introduce this little slide so we get an idea of what our playground is you know this is what i call the web hackers",
    "start": "172239",
    "end": "178319"
  },
  {
    "text": "playground this diagram has been borrowed and beaten and reproduced in many many places not copyrighted so you",
    "start": "178319",
    "end": "183920"
  },
  {
    "text": "can use it as well so what do we have here on the right on the left hand side we have the web",
    "start": "183920",
    "end": "189760"
  },
  {
    "text": "client that's our web browser and everything to the right hand side is the web application area you typically",
    "start": "189760",
    "end": "197120"
  },
  {
    "text": "have a firewall which is pretty restrictive allows only http going in and http coming out",
    "start": "197120",
    "end": "203120"
  },
  {
    "text": "there's a web server which catches most of the front-end requests and serves you the static pages and stuff but for a",
    "start": "203120",
    "end": "209040"
  },
  {
    "text": "complex web application you usually have web application servers plugging in",
    "start": "209040",
    "end": "214400"
  },
  {
    "text": "either running in the same memory space on the same computer or they're on different computers they're connected",
    "start": "214400",
    "end": "220879"
  },
  {
    "text": "via some plug-in mechanisms and such these will typically have the entire",
    "start": "220879",
    "end": "225920"
  },
  {
    "text": "business logic of the application hosted on them the front-end web server does the input gathering vforms and renders",
    "start": "225920",
    "end": "233599"
  },
  {
    "text": "output into html etc and usually these back-end application",
    "start": "233599",
    "end": "238640"
  },
  {
    "text": "servers are powered by databases and there's an sql connection with the backend database so this is the typical",
    "start": "238640",
    "end": "245280"
  },
  {
    "text": "layout and this is what you know we as web hackers will be focusing on",
    "start": "245280",
    "end": "250640"
  },
  {
    "text": "so um this next slide is you know something like what has been the evolution of web",
    "start": "250640",
    "end": "255760"
  },
  {
    "text": "hacking since the early you know the late 90s everybody was concerned with firewalls rpc buffer overflows um",
    "start": "255760",
    "end": "263440"
  },
  {
    "text": "windows netbio stuff and whatnot but the web hacking was still you know still an",
    "start": "263440",
    "end": "268639"
  },
  {
    "text": "esoteric area i think if i can recall things we can begin with a classic phf bug where you",
    "start": "268639",
    "end": "275280"
  },
  {
    "text": "could extend the phf and put put an ampersand x term and such and get",
    "start": "275280",
    "end": "281360"
  },
  {
    "text": "x terms thrown back to you then slowly came along automated web",
    "start": "281360",
    "end": "286560"
  },
  {
    "text": "vulnerability checking a notable achievement was done by rainforest puppy with whisker she's looking for web ones",
    "start": "286560",
    "end": "293120"
  },
  {
    "text": "all over with multiple gate and head requests and then came the whole game of input validation attacks which is not so",
    "start": "293120",
    "end": "299280"
  },
  {
    "text": "much automated it's you look through a form you find that there's some parameters that you can tamper with and you poison",
    "start": "299280",
    "end": "306080"
  },
  {
    "text": "the parameters get the app to blow up or throw back uh connections at you or what not then",
    "start": "306080",
    "end": "311680"
  },
  {
    "text": "there's a game of buffer overflows either in the web server or the app server even in the input fields of the",
    "start": "311680",
    "end": "317199"
  },
  {
    "text": "application ei did some work on the iis buffer overflow games and whatnot",
    "start": "317199",
    "end": "325840"
  },
  {
    "text": "then came the whole arena of source code disclosure where you have",
    "start": "326000",
    "end": "331360"
  },
  {
    "text": "applications written in scripted languages like php or asp java server pages and you you take",
    "start": "331360",
    "end": "338960"
  },
  {
    "text": "advantage of a few flaws and you get the app get the server to return you the code in an unparsed",
    "start": "338960",
    "end": "345120"
  },
  {
    "text": "manner some more advanced http attacks are session hijacking where you can take",
    "start": "345120",
    "end": "350639"
  },
  {
    "text": "over you you know copy and paste some cookies and take over somebody other sessions then uh",
    "start": "350639",
    "end": "356560"
  },
  {
    "text": "pardon me for using the word lame but i would i i coming from the server side consider client side attacks not as my",
    "start": "356560",
    "end": "363840"
  },
  {
    "text": "area so then there yeah the whole cross site question mark type of attacks where you",
    "start": "363840",
    "end": "369360"
  },
  {
    "text": "get javascripts popping up on everybody and stealing cookies and whatnot hacking grandma over aol",
    "start": "369360",
    "end": "377120"
  },
  {
    "text": "so this is you know how far things have come and what is it that lies next is what we're going to talk about",
    "start": "377280",
    "end": "382960"
  },
  {
    "text": "as far as the defense side goes not much effort has been put into web defense",
    "start": "382960",
    "end": "388400"
  },
  {
    "text": "as compared to the effort put into normal network and protocol defense so",
    "start": "388400",
    "end": "393440"
  },
  {
    "text": "we have you know some of the defense areas are lock down your web server configuration as much as you can you",
    "start": "393440",
    "end": "399280"
  },
  {
    "text": "know make it tight you can have web server plug-in filters like url scan or secure iis",
    "start": "399280",
    "end": "406400"
  },
  {
    "text": "whatever have you to do some sort of checking and filtering um then of course secure coding who does",
    "start": "406400",
    "end": "412479"
  },
  {
    "text": "that you know it's it's a mystery it's a myth but i still preach that uh you know somebody asked me what's the",
    "start": "412479",
    "end": "419199"
  },
  {
    "text": "patch to input validation problems there's no patch it's called secure coding and then of course one other thing for",
    "start": "419199",
    "end": "425919"
  },
  {
    "text": "web defense is security web security you disguise servers and keep the script kds away but how far all this is going to",
    "start": "425919",
    "end": "433199"
  },
  {
    "text": "help us well we'll take a look at it so let me just talk about security",
    "start": "433199",
    "end": "439039"
  },
  {
    "text": "obscurity first of all in a lot of cases you know i ask people who's running iis",
    "start": "439039",
    "end": "445360"
  },
  {
    "text": "no not me not me people change the iis server banners to apache or netscape and",
    "start": "445360",
    "end": "451759"
  },
  {
    "text": "they'll key hopefully they'll keep away all the iis attacks away if you change the",
    "start": "451759",
    "end": "457199"
  },
  {
    "text": "apache banner to something else you keep the apache attack so it is at least at least from the you know the script",
    "start": "457199",
    "end": "464160"
  },
  {
    "text": "kds or the automated things angle a lot of cases whenever",
    "start": "464160",
    "end": "470720"
  },
  {
    "text": "an attacker is trying to focus on which server to attack or which server to analyze",
    "start": "470720",
    "end": "476479"
  },
  {
    "text": "when it comes to identifying web servers we do not have we do not have many alternatives but to",
    "start": "476479",
    "end": "482319"
  },
  {
    "text": "just look at the server banner yesterday jeremiah talked to you about",
    "start": "482319",
    "end": "487599"
  },
  {
    "text": "web server fingerprinting where i'm going to take that concept and build up some more and give you another parallel",
    "start": "487599",
    "end": "493440"
  },
  {
    "text": "view of web server fingerprinting from my angle",
    "start": "493440",
    "end": "498879"
  },
  {
    "text": "so if you want to change the server banner what are the what are some of the common things that people have done you",
    "start": "500000",
    "end": "505919"
  },
  {
    "text": "patch the web server binaries say you you patch the w3 svc.dll",
    "start": "505919",
    "end": "512240"
  },
  {
    "text": "to change microsoft is 5.0 to apache 1.3.26",
    "start": "512240",
    "end": "517839"
  },
  {
    "text": "if you have the source you can recompile say you have a new company that had",
    "start": "517839",
    "end": "523360"
  },
  {
    "text": "apache 1.3.26 and they recompiled it with a web star 4.2 server banner to",
    "start": "523360",
    "end": "530160"
  },
  {
    "text": "keep people away it works very well in defeating certain automated attacks or script kitties but",
    "start": "530160",
    "end": "537200"
  },
  {
    "text": "this is not we are not afraid of kitties right nobody is so",
    "start": "537200",
    "end": "542240"
  },
  {
    "text": "well let's see what we can do and then there are other products one of",
    "start": "542240",
    "end": "547760"
  },
  {
    "text": "them i think jeremy mentioned that yesterday is called server mask products such as these go a step further",
    "start": "547760",
    "end": "554800"
  },
  {
    "text": "than just obfuscating the banner not only do they give you a different banner they will also mimic",
    "start": "554800",
    "end": "561440"
  },
  {
    "text": "the header of a particular web server for example apache they change",
    "start": "561440",
    "end": "567600"
  },
  {
    "text": "they change the date and the server field order the other way around",
    "start": "567600",
    "end": "573279"
  },
  {
    "text": "iis has it different i is has server and date these guys have date and server so it tries to mimic the",
    "start": "573279",
    "end": "580880"
  },
  {
    "text": "other server as far as possible and you know provides you better security by obscurity than just changing the banners",
    "start": "580880",
    "end": "589040"
  },
  {
    "text": "so this is as far as things have come so now what i'm going to talk to you",
    "start": "589040",
    "end": "595040"
  },
  {
    "text": "about is http fingerprinting what is objective of http fingerprinting",
    "start": "595040",
    "end": "600320"
  },
  {
    "text": "is to accurately determine the underlying web server platform independent of any",
    "start": "600320",
    "end": "606959"
  },
  {
    "text": "banner strings or any response codes whatsoever we can also take it further to",
    "start": "606959",
    "end": "613680"
  },
  {
    "text": "as an attempt to uncover any plugins or application servers that might be fitted in to the front-end web server",
    "start": "613680",
    "end": "621279"
  },
  {
    "text": "and the whole theory is based upon what people assume when implementing",
    "start": "621279",
    "end": "626480"
  },
  {
    "text": "http specs it's like some areas http spec is not very well defined so what",
    "start": "626480",
    "end": "632800"
  },
  {
    "text": "microsoft's response to a particular request is may not be the same as apache response and vice versa it's pretty much",
    "start": "632800",
    "end": "639680"
  },
  {
    "text": "the same as os fingerprinting you know some areas of the ip protocol stack whereas responses are not well defined",
    "start": "639680",
    "end": "645120"
  },
  {
    "text": "and that is why people use it and are successful in identifying operating systems",
    "start": "645120",
    "end": "651360"
  },
  {
    "text": "so what are the kind of approaches to fingerprinting there's",
    "start": "651360",
    "end": "656480"
  },
  {
    "text": "classical decision tree based methods saying it's more like a chemistry test you know if you add some acid to a",
    "start": "656480",
    "end": "663360"
  },
  {
    "text": "compound if it turns red it's this if it turns blue it's this so you have one test you have a decision tree which",
    "start": "663360",
    "end": "669519"
  },
  {
    "text": "keeps on going further and then you decide more tests based upon which direction the tree takes and then you",
    "start": "669519",
    "end": "675040"
  },
  {
    "text": "narrow down and lock down your result accurately or you can have statistical or neural",
    "start": "675040",
    "end": "680399"
  },
  {
    "text": "network based methods that's pretty much what i've been trying to do is one is not based one is not dependent on",
    "start": "680399",
    "end": "687440"
  },
  {
    "text": "pattern matching or tree logic or you know focusing on particular tests because servers keep on evolving and i",
    "start": "687440",
    "end": "693600"
  },
  {
    "text": "can't keep track of all servers and all pure peculiarities so what i do is i build a learning system you you just",
    "start": "693600",
    "end": "701200"
  },
  {
    "text": "set it in a free learning mode gathers all signatures and you manually assist and classify them ah this looks like iis",
    "start": "701200",
    "end": "707120"
  },
  {
    "text": "this looks like apache because you know them so once you train the machine and it just keeps keeps going and",
    "start": "707120",
    "end": "713440"
  },
  {
    "text": "keeps improving its weight vectors so the fingerprinting engine",
    "start": "713440",
    "end": "718880"
  },
  {
    "text": "one usually you know if you're if you're based on a decision tree based method you have a set of test cases which are",
    "start": "718880",
    "end": "724640"
  },
  {
    "text": "carefully chosen in a response tree or if you have a statistical engine you have weight vectors neural machine you",
    "start": "724640",
    "end": "730720"
  },
  {
    "text": "have weight vectors which just keep on getting refined the more you train it",
    "start": "730720",
    "end": "736320"
  },
  {
    "text": "what are some of the techniques that are used we detect you know we usually like to",
    "start": "736720",
    "end": "742800"
  },
  {
    "text": "focus on what are the deviations from the http rfcs if the rfc says something",
    "start": "742800",
    "end": "748880"
  },
  {
    "text": "and you get a different response then these are the kind of peculiarities so you have a set of tests you throw it",
    "start": "748880",
    "end": "755360"
  },
  {
    "text": "at it see what peculiarities you get back and then the machine learns from there",
    "start": "755360",
    "end": "760800"
  },
  {
    "text": "the behavior sometimes is not specified by the http rfcs should i give a",
    "start": "760800",
    "end": "766880"
  },
  {
    "text": "forbidden or should i give a not found or should i give a 500 error so sometimes developers just figure out ah",
    "start": "766880",
    "end": "773680"
  },
  {
    "text": "this is the best way i'm going to respond to this kind of an error scenario sometimes things like the header field",
    "start": "773680",
    "end": "780240"
  },
  {
    "text": "order matters error analysis you know what responses create what type of",
    "start": "780240",
    "end": "786000"
  },
  {
    "text": "errors sometimes you even have cookie strings like microsoft servers will return an asp session id or apache servers will",
    "start": "786000",
    "end": "793839"
  },
  {
    "text": "return the ip address and some other strings with it if you know these cookies are generated by a",
    "start": "793839",
    "end": "800240"
  },
  {
    "text": "particular flavor of server you can detect that as well products like server mask even go so far",
    "start": "800240",
    "end": "806880"
  },
  {
    "text": "as to obfuscate the asp session id but that's not going to stop us in fingerprinting as you shall soon see",
    "start": "806880",
    "end": "813760"
  },
  {
    "text": "so the whole approach is pretty much similar to os fingerprinting what are we really",
    "start": "813760",
    "end": "819519"
  },
  {
    "text": "trying to achieve through fingerprinting is accuracy the accuracy of your results is going to depend on the choice of test",
    "start": "819519",
    "end": "826480"
  },
  {
    "text": "cases in that matter i would vote for a statistical machine as opposed to a",
    "start": "826480",
    "end": "832639"
  },
  {
    "text": "decision tree based machine because decision trees are hard to scale and then of course a lot of accuracy",
    "start": "832639",
    "end": "839440"
  },
  {
    "text": "depends on the kind of scoring system that you've implemented you know you you justify the weights",
    "start": "839440",
    "end": "844800"
  },
  {
    "text": "that you've picked and you need a very good training input set uh to train the machine once it once",
    "start": "844800",
    "end": "851760"
  },
  {
    "text": "it's trained it's all right you just can't set it in the wild and let it learn one of the biggest problems with http",
    "start": "851760",
    "end": "858480"
  },
  {
    "text": "analysis is as far as a protocol goes http is very easy to customize you can change banner strings you can write your",
    "start": "858480",
    "end": "865360"
  },
  {
    "text": "own modifications or plugins to change response codes so you really if you want to do accurate analysis you can't depend",
    "start": "865360",
    "end": "871839"
  },
  {
    "text": "on 200 okay or 404 or such but there are ways of getting around that",
    "start": "871839",
    "end": "878560"
  },
  {
    "text": "so let me give you uh three examples and i'll go into a demo and show these in front of you",
    "start": "878560",
    "end": "885199"
  },
  {
    "text": "here is the first example of a little prototype that i've built",
    "start": "885199",
    "end": "890240"
  },
  {
    "text": "in this screenshot we have the server reporting itself as apache",
    "start": "890240",
    "end": "896720"
  },
  {
    "text": "advanced extranet server 1.3.19 this is the string that you get from a",
    "start": "896720",
    "end": "901920"
  },
  {
    "text": "get or a head request and then the fingerprinting engine compares it with",
    "start": "901920",
    "end": "908000"
  },
  {
    "text": "known weight vectors for iis405 5.1 here you notice it will it will take",
    "start": "908000",
    "end": "915519"
  },
  {
    "text": "each weight vector and give a score say 23 is the best it could do for 4.0",
    "start": "915519",
    "end": "922399"
  },
  {
    "text": "23 is the best to do for 5.0 as far as the apache groups go the",
    "start": "922399",
    "end": "927519"
  },
  {
    "text": "scores are higher 70 77 76 apache 1.3 point x score",
    "start": "927519",
    "end": "933279"
  },
  {
    "text": "78 and that happens to be the highest score out of any weight so the engine",
    "start": "933279",
    "end": "938320"
  },
  {
    "text": "says ah the best match seems to be apache 1.3.x so this is how",
    "start": "938320",
    "end": "943440"
  },
  {
    "text": "we do the differentiation you know based on the highest score wins theory",
    "start": "943440",
    "end": "949040"
  },
  {
    "text": "in this instance there is no obfuscation it's just a verification of",
    "start": "949040",
    "end": "954399"
  },
  {
    "text": "it's just a verification that the engine works perfectly well",
    "start": "954399",
    "end": "959519"
  },
  {
    "text": "in this instance we have a server which reports its string as web",
    "start": "959519",
    "end": "965040"
  },
  {
    "text": "star but in reality what is it it's an apache 1.3.27",
    "start": "965040",
    "end": "970480"
  },
  {
    "text": "or 1.3.26 server somebody just recompiled the source of apache and",
    "start": "970480",
    "end": "976320"
  },
  {
    "text": "change the server banner to web star and again you see that",
    "start": "976320",
    "end": "981759"
  },
  {
    "text": "as if we look at the scores the apache the two apache weight vectors score",
    "start": "981759",
    "end": "987519"
  },
  {
    "text": "the highest total it's fairly easy to tell",
    "start": "987519",
    "end": "992959"
  },
  {
    "text": "in of such of such trivial obfuscations there's some advanced obfuscations for",
    "start": "992959",
    "end": "998959"
  },
  {
    "text": "example here's a server running with server mask 2.0",
    "start": "998959",
    "end": "1004800"
  },
  {
    "text": "it's an is4 server but the string comes back as apache 1.3.23",
    "start": "1004800",
    "end": "1010320"
  },
  {
    "text": "even the field orders come out in in apache fashion but that really",
    "start": "1010320",
    "end": "1015600"
  },
  {
    "text": "doesn't defeat the fingerprinting engine as for score 63 the other iss score 53 54 and",
    "start": "1015600",
    "end": "1024720"
  },
  {
    "text": "so on and the best score wins so this is a little prelude to finger",
    "start": "1024720",
    "end": "1030000"
  },
  {
    "text": "printing i think i'll be best able to illustrate with a demo so uh let's get into the demo",
    "start": "1030000",
    "end": "1037038"
  },
  {
    "text": "is this very legible to everybody at the back okay great",
    "start": "1037039",
    "end": "1043038"
  },
  {
    "text": "so let me just make sure i'll first of all open a browser",
    "start": "1043039",
    "end": "1049199"
  },
  {
    "text": "into the browser",
    "start": "1050799",
    "end": "1053840"
  },
  {
    "text": "there's a system i have called red october",
    "start": "1056400",
    "end": "1062240"
  },
  {
    "text": "i installed red hat linux in october that's how i picked the name",
    "start": "1063520",
    "end": "1068559"
  },
  {
    "text": "but this is actually a basic static web page pretty much like anything",
    "start": "1068559",
    "end": "1073679"
  },
  {
    "text": "representative of the front page of google or yahoo doesn't have too much dynamic content and we're going to use",
    "start": "1073679",
    "end": "1079600"
  },
  {
    "text": "this as a control system to verify if things really work or not",
    "start": "1079600",
    "end": "1085120"
  },
  {
    "text": "so i have http fingerprint is my program",
    "start": "1085120",
    "end": "1091679"
  },
  {
    "text": "i give it a red october as the target and",
    "start": "1091679",
    "end": "1098960"
  },
  {
    "text": "actually let me do a netcat before i do that just show you the raw string",
    "start": "1099120",
    "end": "1105200"
  },
  {
    "text": "netcat red october port 80 head http",
    "start": "1105200",
    "end": "1110799"
  },
  {
    "text": "1.0 and we have the string returned as apache advanced external server no",
    "start": "1110799",
    "end": "1117840"
  },
  {
    "text": "obfuscation done on this so let's run http fingerprint against that http fingerprint read october",
    "start": "1117840",
    "end": "1127200"
  },
  {
    "text": "it first of all uh where's the mouse yeah",
    "start": "1127200",
    "end": "1133440"
  },
  {
    "text": "it first of all pulls up the header as i showed you in netcat and then it goes on to reporting each",
    "start": "1133600",
    "end": "1140799"
  },
  {
    "text": "score so it",
    "start": "1140799",
    "end": "1144159"
  },
  {
    "text": "showed yeah it showed the best match as apache 1.3 point x and below it you see all the totals that are returned the is",
    "start": "1148840",
    "end": "1156000"
  },
  {
    "text": "scored 32 40 to 43 etc apache 1.3 point",
    "start": "1156000",
    "end": "1161280"
  },
  {
    "text": "x scored 92 the other two dot 27.26 were close behind with 1991 so this is a",
    "start": "1161280",
    "end": "1169440"
  },
  {
    "text": "verification of the whole fingerprint now let us take uh a slightly",
    "start": "1169440",
    "end": "1176559"
  },
  {
    "text": "different example we have there's another server which we have",
    "start": "1176559",
    "end": "1182960"
  },
  {
    "text": "190 yes",
    "start": "1182960",
    "end": "1187520"
  },
  {
    "text": "i beg your pardon",
    "start": "1191200",
    "end": "1194000"
  },
  {
    "text": "should i send do the net cat thing again okay no not a problem",
    "start": "1197200",
    "end": "1202480"
  },
  {
    "text": "all right so we we'll just do the net cat thing again we",
    "start": "1202480",
    "end": "1207600"
  },
  {
    "text": "have red october is the ip address the host name port 80 we do head",
    "start": "1207600",
    "end": "1213840"
  },
  {
    "text": "http 1.0 and this is the http header that's returned",
    "start": "1213840",
    "end": "1221360"
  },
  {
    "text": "don't worry we'll uh we'll revisit this many times as we go along so",
    "start": "1221360",
    "end": "1226720"
  },
  {
    "text": "this is clears up your query this is not obfuscated",
    "start": "1226720",
    "end": "1232400"
  },
  {
    "text": "this is zero obfuscation performed uh here's another server here's an iis server which does not have any",
    "start": "1232400",
    "end": "1238559"
  },
  {
    "text": "obfuscation which is",
    "start": "1238559",
    "end": "1243840"
  },
  {
    "text": "192.1 the 192.168.7.247",
    "start": "1244600",
    "end": "1249960"
  },
  {
    "text": "so here's a web page for this server it's just two html lines and",
    "start": "1254080",
    "end": "1260080"
  },
  {
    "text": "let us run netcat again and verify this what it is",
    "start": "1260080",
    "end": "1266400"
  },
  {
    "text": "so netcat 192.168.7 or 247 port 80.",
    "start": "1266400",
    "end": "1273440"
  },
  {
    "text": "again the same request head http 1.0",
    "start": "1273440",
    "end": "1278960"
  },
  {
    "text": "and the server banner comes back as is 5.0 and the other peripheral server header strings that",
    "start": "1278960",
    "end": "1287120"
  },
  {
    "text": "iis returns now let's run the fingerprinting engine against this and see how it fares",
    "start": "1287120",
    "end": "1293840"
  },
  {
    "text": "so we have http http fingerprint 192.168.7.247.",
    "start": "1293840",
    "end": "1300279"
  },
  {
    "text": "so we have the string pulled up and in a little bit",
    "start": "1305280",
    "end": "1312240"
  },
  {
    "text": "it pulls up best matches is 5.0 you see the is 5.0",
    "start": "1312240",
    "end": "1318080"
  },
  {
    "text": "scored 131 amongst all the other servers and the apache scored",
    "start": "1318080",
    "end": "1325280"
  },
  {
    "text": "low in this area this thing even detects iis running with url scan so",
    "start": "1325280",
    "end": "1331600"
  },
  {
    "text": "as many as many different servers as you train it against it will easily learn and begin detecting the same it does not",
    "start": "1331600",
    "end": "1338559"
  },
  {
    "text": "i do not have to alter any assessment logic number of requests remain constant and the computation time",
    "start": "1338559",
    "end": "1345679"
  },
  {
    "text": "remains constant as well it could be further optimized by some decision tree based method but",
    "start": "1345679",
    "end": "1351760"
  },
  {
    "text": "for now i work too hard to bring you all this so maybe next black hat you'll see optimizations in this theory",
    "start": "1351760",
    "end": "1358559"
  },
  {
    "text": "um so that is this is running it against non-obfuscated servers now let's put it",
    "start": "1358559",
    "end": "1364880"
  },
  {
    "text": "to the test against some obfuscated servers i have another system over here",
    "start": "1364880",
    "end": "1371120"
  },
  {
    "text": "which is uh uh netcat 192.168.7.248.",
    "start": "1371120",
    "end": "1377720"
  },
  {
    "text": "um let me just show you in the browser first",
    "start": "1380559",
    "end": "1385840"
  },
  {
    "text": "248 and",
    "start": "1386480",
    "end": "1391840"
  },
  {
    "text": "well here's a some website of a electronic shopping store kind of a",
    "start": "1391840",
    "end": "1397039"
  },
  {
    "text": "thing sells art on the web but uh if we launch a netcat request to port 80",
    "start": "1397039",
    "end": "1403520"
  },
  {
    "text": "say head http 1.0 it returns back saying server is",
    "start": "1403520",
    "end": "1410320"
  },
  {
    "text": "netscape enterprise 6.0 seems to be fairly hardened because now you don't have other peripheral etag or",
    "start": "1410320",
    "end": "1417600"
  },
  {
    "text": "you know content or anything else being returned in the header just the minimal headers that are needed to serve a web",
    "start": "1417600",
    "end": "1424559"
  },
  {
    "text": "page are given out so now let's run the fingerprinting engine against this",
    "start": "1424559",
    "end": "1430559"
  },
  {
    "text": "http fingerprint 192.168.7.248.",
    "start": "1430559",
    "end": "1434919"
  },
  {
    "text": "it pulls up the header and let's see who won the best match is apache 1.3 point",
    "start": "1436880",
    "end": "1443840"
  },
  {
    "text": "and it's it's it's really an apache 1.3.x server um",
    "start": "1443840",
    "end": "1449520"
  },
  {
    "text": "it wins with a score of 55. it was it was an apache recompiled with netscape",
    "start": "1449520",
    "end": "1455200"
  },
  {
    "text": "6.0 as a server string so yeah the engine will detect all these",
    "start": "1455200",
    "end": "1461120"
  },
  {
    "text": "anomalies and report them back and now uh let's put this to an even",
    "start": "1461120",
    "end": "1467600"
  },
  {
    "text": "further test we're going to go back to that is server",
    "start": "1467600",
    "end": "1472720"
  },
  {
    "text": "and run server mask on it and see how that happens so let me just",
    "start": "1472720",
    "end": "1477919"
  },
  {
    "text": "pull up that screen for you",
    "start": "1477919",
    "end": "1481679"
  },
  {
    "text": "here is the server here is server oops",
    "start": "1483279",
    "end": "1490080"
  },
  {
    "text": "bloody here thanks windows",
    "start": "1490080",
    "end": "1496559"
  },
  {
    "text": "it's interesting this is uh arthur mentioned you know what are you doing with a mac in a windows security conference",
    "start": "1499520",
    "end": "1505440"
  },
  {
    "text": "but uh oh well maybe you'll have a blackhat macintosh someday",
    "start": "1505440",
    "end": "1511480"
  },
  {
    "text": "please",
    "start": "1515200",
    "end": "1517600"
  },
  {
    "text": "will server mask never run for me",
    "start": "1525919",
    "end": "1529840"
  },
  {
    "text": "wait a second",
    "start": "1532240",
    "end": "1534880"
  },
  {
    "text": "i",
    "start": "1538400",
    "end": "1541400"
  },
  {
    "text": "i did i did my prayers all right i assure you of that",
    "start": "1545360",
    "end": "1550559"
  },
  {
    "text": "to the demo gods but apparently they're not happy",
    "start": "1550559",
    "end": "1557158"
  },
  {
    "text": "it's growing up one second give me",
    "start": "1565039",
    "end": "1571840"
  },
  {
    "text": "some time with this",
    "start": "1571919",
    "end": "1575720"
  },
  {
    "text": "um",
    "start": "1598559",
    "end": "1601559"
  },
  {
    "text": "all right i will do one thing i will give you the server mask demo a little bit later",
    "start": "1615760",
    "end": "1625480"
  },
  {
    "text": "just give me a second to restart",
    "start": "1636640",
    "end": "1642480"
  },
  {
    "text": "this thing",
    "start": "1644240",
    "end": "1647480"
  },
  {
    "text": "so",
    "start": "1659679",
    "end": "1662679"
  },
  {
    "text": "ok ah we will we will revisit this i have just restarted the vm engine so",
    "start": "1675279",
    "end": "1681760"
  },
  {
    "text": "hopefully we'll be will be able to do this before the end of my talk",
    "start": "1681760",
    "end": "1687760"
  },
  {
    "text": "let's get back to the example but i what i wanted to convey across is you know how",
    "start": "1687760",
    "end": "1694159"
  },
  {
    "text": "statistical fingerprinting works the demo with server mask is pretty killer because no matter even if it's activated",
    "start": "1694159",
    "end": "1701200"
  },
  {
    "text": "the fingerprinting engine still comes back and says ah this is an iis server so my my whole theme is yeah you know",
    "start": "1701200",
    "end": "1707840"
  },
  {
    "text": "you can't really trust security web security when it comes to focused attacks",
    "start": "1707840",
    "end": "1715360"
  },
  {
    "text": "so let me go ahead so we saw this and now let me talk to",
    "start": "1715360",
    "end": "1722960"
  },
  {
    "text": "you about an entirely different concept",
    "start": "1722960",
    "end": "1727520"
  },
  {
    "text": "the concept i want to talk to you about is called page signatures it's it's a little bit difficult to grasp than http",
    "start": "1729120",
    "end": "1737520"
  },
  {
    "text": "fingerprinting but you know first i'll describe you the problem what we're up against and then",
    "start": "1737520",
    "end": "1744480"
  },
  {
    "text": "how can page signatures really help us so we usually what happens is when you do web",
    "start": "1744480",
    "end": "1750640"
  },
  {
    "text": "assessment like say when you run whisker what does whisker really look for when saying yes a vulnerability exists or no",
    "start": "1750640",
    "end": "1757919"
  },
  {
    "text": "it it usually the first thing that it looks for is the http response code if you have a",
    "start": "1757919",
    "end": "1763760"
  },
  {
    "text": "200 okay means that the respon the the resource was there if it was a script",
    "start": "1763760",
    "end": "1768799"
  },
  {
    "text": "that it executed and such and uh you get the response code back and then",
    "start": "1768799",
    "end": "1774320"
  },
  {
    "text": "you say this thing existed or not but in a lot of cases people have customized",
    "start": "1774320",
    "end": "1779600"
  },
  {
    "text": "error pages it's very easy to write a little program that will return your customized response so instead of a",
    "start": "1779600",
    "end": "1786960"
  },
  {
    "text": "non-existent page being returned 404 you get a 200 okay but the screen shows oops",
    "start": "1786960",
    "end": "1793200"
  },
  {
    "text": "your page was not found here you are penalized with five banner ads to look at and you know",
    "start": "1793200",
    "end": "1799279"
  },
  {
    "text": "some 20 javascript pop-ups that will make some exit control guys some money",
    "start": "1799279",
    "end": "1804320"
  },
  {
    "text": "so you have customized errors like that sometimes there's a page not found but",
    "start": "1804320",
    "end": "1810320"
  },
  {
    "text": "they'll return you a 301 or a 302 to take you back to the starting page and such",
    "start": "1810320",
    "end": "1816159"
  },
  {
    "text": "some sites have 200 okay deliberately to full crawling engines you know the first",
    "start": "1816159",
    "end": "1821840"
  },
  {
    "text": "page will contain a clear pixel which will be linked to a non-existent link and the non-existent link will return a",
    "start": "1821840",
    "end": "1828159"
  },
  {
    "text": "200 okay and 20 random links on the same page which will all return 200 okays and",
    "start": "1828159",
    "end": "1833360"
  },
  {
    "text": "whatnot so the crawler will get stuck at infinitum and never be able to figure out your website",
    "start": "1833360",
    "end": "1839520"
  },
  {
    "text": "so this is what we're up against so we can't really depend on the response codes so we have to increase",
    "start": "1839520",
    "end": "1846559"
  },
  {
    "text": "our accuracy we have page signatures and the objective of page signatures",
    "start": "1846559",
    "end": "1851760"
  },
  {
    "text": "is to accurately identify proper http response codes you know even if it's a 200 okay can we tell if it's a",
    "start": "1851760",
    "end": "1859120"
  },
  {
    "text": "page which is which is returned as resource non-existent and such",
    "start": "1859120",
    "end": "1865279"
  },
  {
    "text": "the idea is to minimize false positives it greatly helps in automated testing",
    "start": "1865279",
    "end": "1870399"
  },
  {
    "text": "because now you can say with confidence what your tests came back with and this concept is not just to detect",
    "start": "1870399",
    "end": "1877440"
  },
  {
    "text": "error responses or such it can be used way beyond error detection like if you",
    "start": "1877440",
    "end": "1882480"
  },
  {
    "text": "crawl a website and you get the same page signature for 20 pages you can you can infer that these pages",
    "start": "1882480",
    "end": "1889679"
  },
  {
    "text": "are driven off some template based resource so you can start grouping",
    "start": "1889679",
    "end": "1894960"
  },
  {
    "text": "various resources together and form functional areas for your application to",
    "start": "1894960",
    "end": "1900480"
  },
  {
    "text": "for your application and security analysis page signatures can be used in even",
    "start": "1900480",
    "end": "1905679"
  },
  {
    "text": "funkier stuff which i'll talk about uh near the end of my show",
    "start": "1905679",
    "end": "1911519"
  },
  {
    "text": "so here's what a page signature looks like each http response",
    "start": "1911519",
    "end": "1917039"
  },
  {
    "text": "in the http header and the html data goes into computing this magic page",
    "start": "1917039",
    "end": "1924399"
  },
  {
    "text": "signature it is independent of the content in there which is very important because we",
    "start": "1924399",
    "end": "1929679"
  },
  {
    "text": "can't really trust the content being written returned it has the ability to overlook random",
    "start": "1929679",
    "end": "1936159"
  },
  {
    "text": "contents you know you can have random strings in there which keep on changing but the page signature is impervious to",
    "start": "1936159",
    "end": "1942880"
  },
  {
    "text": "any randomized stuff the signature itself is a string of",
    "start": "1942880",
    "end": "1947919"
  },
  {
    "text": "constant length as shown in the blue box at the bottom uh the comp for you know algorithmic",
    "start": "1947919",
    "end": "1955200"
  },
  {
    "text": "purposes the computation time is order of n where n being the number of bytes of the response but the comparison time",
    "start": "1955200",
    "end": "1961279"
  },
  {
    "text": "because it's a string of constant length is an order of k so when you once you have the page signatures working with",
    "start": "1961279",
    "end": "1967120"
  },
  {
    "text": "them is very very fast there were other theories that had hatched in the past you know to overcome",
    "start": "1967120",
    "end": "1972880"
  },
  {
    "text": "this problem but they were all order of n square n log n n log n time they never",
    "start": "1972880",
    "end": "1978720"
  },
  {
    "text": "scale we can't live with that so uh here's some examples uh and then",
    "start": "1978720",
    "end": "1983919"
  },
  {
    "text": "i'll get into a demo and hopefully the demo guards will not be mad at me this time um",
    "start": "1983919",
    "end": "1990480"
  },
  {
    "text": "here's an example of a normal error page if you type in some http site",
    "start": "1990480",
    "end": "1995919"
  },
  {
    "text": "slash garbage.txt you get page not found here the requested url",
    "start": "1995919",
    "end": "2002159"
  },
  {
    "text": "junk was not found and if you do a net cat request and do a",
    "start": "2002159",
    "end": "2008000"
  },
  {
    "text": "do the thing it will say http 1.1 404 not firm",
    "start": "2008000",
    "end": "2013679"
  },
  {
    "text": "in the next example i have a customized error page which you know which returns some random",
    "start": "2013679",
    "end": "2020320"
  },
  {
    "text": "number saying uh this is to just simulate some randomized content which will keep on changing",
    "start": "2020320",
    "end": "2026640"
  },
  {
    "text": "uh see please contact the site administrator blah blah blah in one minute you'll be refreshed to the main page or you can search for your missing",
    "start": "2026640",
    "end": "2034080"
  },
  {
    "text": "page with google if you do a netcat it will say http 1.1 200 ok and then proceed to give you the",
    "start": "2034080",
    "end": "2041120"
  },
  {
    "text": "content this is very much like a normal web page response to the browser when",
    "start": "2041120",
    "end": "2046799"
  },
  {
    "text": "we're looking at it visually the user knows that this is an error page but to an automated program it's",
    "start": "2046799",
    "end": "2052720"
  },
  {
    "text": "not an error it's it's a genuine response so with this let me just give you a little",
    "start": "2052720",
    "end": "2059599"
  },
  {
    "text": "demo once again pop open the browser",
    "start": "2059599",
    "end": "2067598"
  },
  {
    "text": "there's a browser first let's use the same control page",
    "start": "2067919",
    "end": "2076158"
  },
  {
    "text": "which does not have a customized error strings we go to red october",
    "start": "2076159",
    "end": "2083879"
  },
  {
    "text": "this is the normal page let's make some request which doesn't exist",
    "start": "2084079",
    "end": "2090158"
  },
  {
    "text": "and it says not found let's try the same thing with net cat",
    "start": "2090159",
    "end": "2096960"
  },
  {
    "text": "net cat red october port 80 get slash blah blah blah",
    "start": "2097040",
    "end": "2105759"
  },
  {
    "text": "it says http 404 not found and this is good enough because this is genuine this is all you need to look at and you can",
    "start": "2107520",
    "end": "2114800"
  },
  {
    "text": "pretty much ignore the rest of the stuff and say this is a non-existent page",
    "start": "2114800",
    "end": "2120160"
  },
  {
    "text": "now let us look at another server which is",
    "start": "2120160",
    "end": "2125200"
  },
  {
    "text": "configured otherwise",
    "start": "2125200",
    "end": "2130119"
  },
  {
    "text": "192.168.7.248",
    "start": "2131760",
    "end": "2134760"
  },
  {
    "text": "and let's try some error strings here",
    "start": "2137440",
    "end": "2141440"
  },
  {
    "text": "oops uh this is visually it looks like an error page it",
    "start": "2142720",
    "end": "2147760"
  },
  {
    "text": "has a random number it says in one minute you'll be refreshed to the page whatever",
    "start": "2147760",
    "end": "2152880"
  },
  {
    "text": "and now let's send a netcat request to",
    "start": "2152880",
    "end": "2158880"
  },
  {
    "text": "yeah let's send a netcat request say get slash blah blah blah",
    "start": "2158880",
    "end": "2165200"
  },
  {
    "text": "http 1.0 see here we get a 200 okay",
    "start": "2165200",
    "end": "2171839"
  },
  {
    "text": "here we get a random number and other such things if i keep on reloading this",
    "start": "2171839",
    "end": "2177680"
  },
  {
    "text": "you know if i say reload notice the random number is going to keep on changing you know this is just",
    "start": "2177680",
    "end": "2183599"
  },
  {
    "text": "one instance of a randomized field there can be more instances of this along i just cooked up a trivial demo",
    "start": "2183599",
    "end": "2189760"
  },
  {
    "text": "to illustrate the fact so now let's see how page signatures can help",
    "start": "2189760",
    "end": "2195599"
  },
  {
    "text": "us over here um we i'll show you first the page",
    "start": "2195599",
    "end": "2202160"
  },
  {
    "text": "signature program uh it's page signature",
    "start": "2202160",
    "end": "2209200"
  },
  {
    "text": "yeah http let's try this for red october",
    "start": "2210000",
    "end": "2217760"
  },
  {
    "text": "just give the url hit enter it gives us a",
    "start": "2217760",
    "end": "2223280"
  },
  {
    "text": "constant length hex encoded signature and this will remain the same no matter",
    "start": "2223280",
    "end": "2228640"
  },
  {
    "text": "what if i try page signature for some non-existent link",
    "start": "2228640",
    "end": "2235280"
  },
  {
    "text": "it will give me a different signature and this will remain constant it's it because the content remains",
    "start": "2235280",
    "end": "2241680"
  },
  {
    "text": "constant now let's try the page signatures for the customized site so we say http",
    "start": "2241680",
    "end": "2248880"
  },
  {
    "text": "192.1 168.7.248.",
    "start": "2248880",
    "end": "2255480"
  },
  {
    "text": "blah blah blah here we get this as the page signature",
    "start": "2257359",
    "end": "2265280"
  },
  {
    "text": "mouse club there it is now even if we change something over here",
    "start": "2265280",
    "end": "2270960"
  },
  {
    "text": "or we keep on say hitting reload which is giving the same thing notice that the page signature will never change",
    "start": "2270960",
    "end": "2277280"
  },
  {
    "text": "so now i know this is the response for a non-existent page and this is going to be constant all throughout as long as",
    "start": "2277280",
    "end": "2284640"
  },
  {
    "text": "the site doesn't change so if i know this when i'm doing my assessment for every page that i come across i get the",
    "start": "2284640",
    "end": "2289920"
  },
  {
    "text": "signature throw it away this is a false response don't even attempt crawling it don't even attempt reporting it",
    "start": "2289920",
    "end": "2296640"
  },
  {
    "text": "interesting let me show you what what will happen if i run whisker against this site so i have",
    "start": "2296640",
    "end": "2302240"
  },
  {
    "text": "whisker dot pl i'm going to say h192 1687 or 248",
    "start": "2302240",
    "end": "2308960"
  },
  {
    "text": "oops there it's running it's netscape enterprise",
    "start": "2308960",
    "end": "2315440"
  },
  {
    "text": "and reporting every vulnerability under the sun exists on the server and something can be right correct",
    "start": "2315440",
    "end": "2322320"
  },
  {
    "text": "so now let's say if we have written a script",
    "start": "2322320",
    "end": "2329520"
  },
  {
    "text": "which incorporates which is pretty much like a whisker type testing engine but with page",
    "start": "2329520",
    "end": "2334560"
  },
  {
    "text": "signatures in there and let me show you how that is going to fare against this site",
    "start": "2334560",
    "end": "2339599"
  },
  {
    "text": "again one does not need to have any prior knowledge about how the site is configured",
    "start": "2339599",
    "end": "2345839"
  },
  {
    "text": "so i have weight whisker with page signatures 192.168.7.248.",
    "start": "2345839",
    "end": "2351400"
  },
  {
    "text": "this is going to try for many many checks it's going to return the page signature for each check",
    "start": "2356880",
    "end": "2362960"
  },
  {
    "text": "but notice for test.cgi over here it returned a different signature for say",
    "start": "2362960",
    "end": "2368280"
  },
  {
    "text": "guestbook.pl it returned a different signature so now if we if we know this",
    "start": "2368280",
    "end": "2375119"
  },
  {
    "text": "what we're going to do next once this thing finishes is",
    "start": "2375119",
    "end": "2380960"
  },
  {
    "text": "do some more unix magic so now i know that this is a",
    "start": "2380960",
    "end": "2386079"
  },
  {
    "text": "worthless page this is really does not exist i cut this",
    "start": "2386079",
    "end": "2391359"
  },
  {
    "text": "i do pipe to grape minus v",
    "start": "2391359",
    "end": "2397040"
  },
  {
    "text": "paste this over here so filter out all non-existent pages",
    "start": "2397040",
    "end": "2402160"
  },
  {
    "text": "and the same thing will run but it will only report me the genuine resources which exist like for example test.cgi",
    "start": "2402160",
    "end": "2409040"
  },
  {
    "text": "exists so all of a sec all of a sudden your vulnerability assessment has become",
    "start": "2409040",
    "end": "2414960"
  },
  {
    "text": "deadly accurate and this we can manually verify this with the browser and it will come back",
    "start": "2414960",
    "end": "2421599"
  },
  {
    "text": "and show you another interesting thing to notice",
    "start": "2421599",
    "end": "2428000"
  },
  {
    "text": "is take a look at the signatures for test cgi",
    "start": "2428000",
    "end": "2433359"
  },
  {
    "text": "and nph test cgi the signatures are the same",
    "start": "2433359",
    "end": "2438400"
  },
  {
    "text": "because the output returned by these two is the same so now if you have multiple pages like",
    "start": "2438400",
    "end": "2444800"
  },
  {
    "text": "this you can figure out they came all from the same source or they belong in the same group",
    "start": "2444800",
    "end": "2450320"
  },
  {
    "text": "so let's just take a look at some of these test cgis manually let's first",
    "start": "2450320",
    "end": "2456240"
  },
  {
    "text": "say cgi bin yeah there was there was one test which",
    "start": "2456240",
    "end": "2461839"
  },
  {
    "text": "was perl.exe which whisker reported as existing but it doesn't exist if you have perl",
    "start": "2461839",
    "end": "2469359"
  },
  {
    "text": "perl.exe it's going to come back with the error",
    "start": "2470160",
    "end": "2475280"
  },
  {
    "text": "page but if we have say test.c test cgi",
    "start": "2475280",
    "end": "2480960"
  },
  {
    "text": "this actually exists if we have say nph",
    "start": "2480960",
    "end": "2487520"
  },
  {
    "text": "test cgi this also exists it's it's similar there was a there's one mark difference one was you",
    "start": "2488720",
    "end": "2496160"
  },
  {
    "text": "know can you see the little difference in there are type and size but the page signature",
    "start": "2496160",
    "end": "2501440"
  },
  {
    "text": "is impervious to this thing it really doesn't matter if the content changes a little bit the the base essence is the",
    "start": "2501440",
    "end": "2508240"
  },
  {
    "text": "same and therefore the page signatures are the same for these two resources so for a web",
    "start": "2508240",
    "end": "2514480"
  },
  {
    "text": "web security auditor it's very uh very easy to just look at paid signatures along",
    "start": "2514480",
    "end": "2520319"
  },
  {
    "text": "with the crawl results you can start grouping things you can separate the fluff from the",
    "start": "2520319",
    "end": "2526720"
  },
  {
    "text": "i forgot that proverbs please excuse me the wheat from the chaff that's right",
    "start": "2526720",
    "end": "2531839"
  },
  {
    "text": "so this is where they can come in useful what else did i have to show you about",
    "start": "2531839",
    "end": "2539119"
  },
  {
    "text": "page signatures",
    "start": "2539119",
    "end": "2542480"
  },
  {
    "text": "should we try that fingerprinting thing again i am keeping my fingers crossed because after page signatures i want to",
    "start": "2544160",
    "end": "2549520"
  },
  {
    "text": "go on to proxy servers and tricks with proxies and then i will end the talk so let's revisit",
    "start": "2549520",
    "end": "2557200"
  },
  {
    "text": "that let's revisit the server mask demo i hope it works this time",
    "start": "2557200",
    "end": "2564920"
  },
  {
    "text": "all right it worked",
    "start": "2584800",
    "end": "2587920"
  },
  {
    "text": "okay so we have server mask we're going to enable",
    "start": "2589839",
    "end": "2595040"
  },
  {
    "text": "server mask we're going to disguise this is server as apache emulate the apache",
    "start": "2595040",
    "end": "2602079"
  },
  {
    "text": "header remove the web dab blah blah blah mask the session cookie yeah everything is on",
    "start": "2602079",
    "end": "2607440"
  },
  {
    "text": "apply restart",
    "start": "2607440",
    "end": "2612160"
  },
  {
    "text": "ah it's successfully restarted now",
    "start": "2616079",
    "end": "2621200"
  },
  {
    "text": "away you go away you go as well",
    "start": "2621200",
    "end": "2627200"
  },
  {
    "text": "and now let's just test this once again with netcat and show you what it comes back with",
    "start": "2627760",
    "end": "2636880"
  },
  {
    "text": "head http 1.0 you see it comes back with apache 1.3.19 the data and server fields",
    "start": "2637839",
    "end": "2643920"
  },
  {
    "text": "are interchanged like a trueblue apache server is etc it really doesn't matter if these fields",
    "start": "2643920",
    "end": "2650400"
  },
  {
    "text": "are there or not my technology is impervious to it and now let's run",
    "start": "2650400",
    "end": "2656400"
  },
  {
    "text": "http fingerprint 192.168.7.247.",
    "start": "2656400",
    "end": "2661000"
  },
  {
    "text": "and what do we have here it's is 5.0 server",
    "start": "2664079",
    "end": "2671920"
  },
  {
    "text": "mask is unmasked and the scores in the last time without server match the score was 131 the",
    "start": "2671920",
    "end": "2679359"
  },
  {
    "text": "scores just dropped 211 but it's still the highest score it's very easy to see",
    "start": "2679359",
    "end": "2684480"
  },
  {
    "text": "that these two have the highest score amongst everybody else so security web security is",
    "start": "2684480",
    "end": "2690880"
  },
  {
    "text": "defeated once again anyway that was the demo for server mass",
    "start": "2690880",
    "end": "2696000"
  },
  {
    "text": "i finished the demos for page signatures so now let's get back to",
    "start": "2696000",
    "end": "2701599"
  },
  {
    "text": "the show i'll wrap up page signatures a little bit i will then go on to",
    "start": "2701599",
    "end": "2706880"
  },
  {
    "text": "tricks with proxy servers so",
    "start": "2706880",
    "end": "2712240"
  },
  {
    "text": "just to recap a little bit i showed you that paid signatures are independent of the content no matter if you have",
    "start": "2712240",
    "end": "2718240"
  },
  {
    "text": "different urls if they're all you know of the same property the page signature is going to remain the same so here this",
    "start": "2718240",
    "end": "2726480"
  },
  {
    "text": "all these are non-existent pages even if there's you know differences",
    "start": "2726480",
    "end": "2731760"
  },
  {
    "text": "in the rank the content is random the response code is 200 whatever the signature is going to remain the same",
    "start": "2731760",
    "end": "2739359"
  },
  {
    "text": "so uh now let's get to proxy servers and certain funky things let's let's try to apply",
    "start": "2739359",
    "end": "2746319"
  },
  {
    "text": "the concepts we learned from paid signatures and apply them to proxy servers and see how this can help us go",
    "start": "2746319",
    "end": "2751839"
  },
  {
    "text": "even further we all know what can go wrong with proxy servers you know sometimes",
    "start": "2751839",
    "end": "2758480"
  },
  {
    "text": "servers can inadvertently behave as open proxies allowing somebody else to surf",
    "start": "2758480",
    "end": "2764319"
  },
  {
    "text": "the web and launch attacks from your site and sometimes what is worse is servers",
    "start": "2764319",
    "end": "2770640"
  },
  {
    "text": "can work as reverse proxies that is if you have a system which is dual homed and a web server running on that system",
    "start": "2770640",
    "end": "2778400"
  },
  {
    "text": "you connect to the front-end web server from the internet and you use that as a proxy to get into the internal non-routable network in",
    "start": "2778400",
    "end": "2786079"
  },
  {
    "text": "many instances sriracha and i have taken apart sites we're just you know setting",
    "start": "2786079",
    "end": "2791440"
  },
  {
    "text": "that front-end web server as our proxy and then you know saying go to 10.0.1.1.10.0.1.2",
    "start": "2791440",
    "end": "2797800"
  },
  {
    "text": "and all of a sudden you are taking all their internal systems apart what are the causes of misconfig what",
    "start": "2797920",
    "end": "2804240"
  },
  {
    "text": "are the causes why would web servers behave like reverse proxies",
    "start": "2804240",
    "end": "2809280"
  },
  {
    "text": "especially the answer lies over here to go to this front side especially if",
    "start": "2809280",
    "end": "2816400"
  },
  {
    "text": "the method to plug in web applications is fairly complex you know there's ways like url mapping or port redirection or",
    "start": "2816400",
    "end": "2823680"
  },
  {
    "text": "things like that these would all this front-end web server will start",
    "start": "2823680",
    "end": "2828720"
  },
  {
    "text": "proxying things to the back end and if the configuration is not very well locked down we have a problem on our",
    "start": "2828720",
    "end": "2834480"
  },
  {
    "text": "hands it can either be an open proxy or a reverse proxy so",
    "start": "2834480",
    "end": "2840640"
  },
  {
    "text": "sometimes devices or you know standard specialized servers like compact insight",
    "start": "2841599",
    "end": "2847680"
  },
  {
    "text": "manager would act as an open proxy or a reverse proxy compact insight manager i think",
    "start": "2847680",
    "end": "2853200"
  },
  {
    "text": "has been beaten way too much right but people like poor things suffered from",
    "start": "2853200",
    "end": "2859599"
  },
  {
    "text": "you know file retrievals to buffer overflows to reverse and open proxies",
    "start": "2859599",
    "end": "2866560"
  },
  {
    "text": "anyway so here's an example of you know what happens is you have a front-end web server which is dual home",
    "start": "2866560",
    "end": "2873520"
  },
  {
    "text": "you have one routable or internet accessible address in the demo it's not because this is all i have",
    "start": "2873520",
    "end": "2879920"
  },
  {
    "text": "and you have an internal address and there's some other servers sitting on the inside which this whole system works",
    "start": "2879920",
    "end": "2886720"
  },
  {
    "text": "together and if i want if this thing is misconfigured or it acts as a reverse proxy i can send a get request like this",
    "start": "2886720",
    "end": "2893680"
  },
  {
    "text": "get http 10.0.1.2 http 1.0 so this is actually",
    "start": "2893680",
    "end": "2900880"
  },
  {
    "text": "a valid http proxy request it goes to here this guy passes the request onto this",
    "start": "2900880",
    "end": "2907599"
  },
  {
    "text": "internal server gets a response and returns it back this is how reverse proxies work",
    "start": "2907599",
    "end": "2913280"
  },
  {
    "text": "so now we can do many things with a reverse for example you can do port scanning",
    "start": "2913280",
    "end": "2919839"
  },
  {
    "text": "through a proxy all you got to do is issue multiple get requests with different ports so you'll find out what",
    "start": "2919839",
    "end": "2927040"
  },
  {
    "text": "ports are open on systems inside you may not get a valid http response but if as long as you don't get a denied",
    "start": "2927040",
    "end": "2933440"
  },
  {
    "text": "response you're okay and how do we figure out what response is valid ah we just learned page",
    "start": "2933440",
    "end": "2938800"
  },
  {
    "text": "signatures 15 minutes ago so you send a request to port zero you get no way to connect take the page signature",
    "start": "2938800",
    "end": "2946000"
  },
  {
    "text": "and start sending these requests port 21 for 25 and if the signature is different then those ports are open",
    "start": "2946000",
    "end": "2952640"
  },
  {
    "text": "so you know here is how you can take one simple concept and extend theories far and wide",
    "start": "2952640",
    "end": "2958559"
  },
  {
    "text": "the only problem with trying to port scan behind a proxy is you have to somehow guess the internal ip addressing",
    "start": "2958559",
    "end": "2966160"
  },
  {
    "text": "range and sometimes it is leaked out through http headers or through application error messages saying sql odbc error at",
    "start": "2966160",
    "end": "2974000"
  },
  {
    "text": "10.0.0.3 brilliant i now know what you're inside ranges",
    "start": "2974000",
    "end": "2979520"
  },
  {
    "text": "and computers are great at doing things automatically so i set a large internal",
    "start": "2979520",
    "end": "2984720"
  },
  {
    "text": "class c have it running overnight in the morning i have my results so",
    "start": "2984720",
    "end": "2990079"
  },
  {
    "text": "okay i will again break for a demo over here so let's see what we can do with proxies",
    "start": "2990079",
    "end": "2999839"
  },
  {
    "text": "so again we will use the same system red october as our control system think of",
    "start": "3001760",
    "end": "3008400"
  },
  {
    "text": "red october as google it's not going to change it's accessible from all over the internet",
    "start": "3008400",
    "end": "3013920"
  },
  {
    "text": "so we will do net cat to red october port 80 do a plane",
    "start": "3013920",
    "end": "3020160"
  },
  {
    "text": "get request http 1.0 and we get a",
    "start": "3020160",
    "end": "3027440"
  },
  {
    "text": "response now we have a server over here which has a",
    "start": "3027440",
    "end": "3032880"
  },
  {
    "text": "proxy issue 192 168.7.248",
    "start": "3032880",
    "end": "3038640"
  },
  {
    "text": "port 8001 here's a here's a proxy server running which also acts as an open reverse proxy",
    "start": "3038640",
    "end": "3045680"
  },
  {
    "text": "so with this let us try to get the same page from red october http",
    "start": "3045680",
    "end": "3051200"
  },
  {
    "text": "red october http 1.0 so we're sending a proxy request to",
    "start": "3051200",
    "end": "3058920"
  },
  {
    "text": "192.168.7 or 248 48001 to fetch a page from that red october system",
    "start": "3058920",
    "end": "3064960"
  },
  {
    "text": "and it does it gets you the same page so this means this is an open proxy that we",
    "start": "3064960",
    "end": "3071119"
  },
  {
    "text": "have now this is a manual check we can you know go to a web browser set this as our",
    "start": "3071119",
    "end": "3076720"
  },
  {
    "text": "proxy and surf to red october and find out the same for ourselves but the question is how can we do it in an",
    "start": "3076720",
    "end": "3081920"
  },
  {
    "text": "automated manner and for that i have another",
    "start": "3081920",
    "end": "3087359"
  },
  {
    "text": "script or a program based on page signatures uh",
    "start": "3087359",
    "end": "3092400"
  },
  {
    "text": "we i have a program called proxy detect and all i have to do is give it",
    "start": "3092400",
    "end": "3099599"
  },
  {
    "text": "a potential candidate which might be a reverse proxy and i've hard coded it to",
    "start": "3099599",
    "end": "3104800"
  },
  {
    "text": "look up red october i could hard code it to look up google and verify so",
    "start": "3104800",
    "end": "3111599"
  },
  {
    "text": "i i suspect that 192.168.7.248 port 8001 is a open proxy so i'm going",
    "start": "3111599",
    "end": "3118000"
  },
  {
    "text": "to just give this parameter to proxy detect and says open proxy detector",
    "start": "3118000",
    "end": "3124480"
  },
  {
    "text": "with via proxy it returned this page signature and directly it also",
    "start": "3124480",
    "end": "3130400"
  },
  {
    "text": "returned the same page signature so we we take the content compare the signature and say ah this is an open",
    "start": "3130400",
    "end": "3136000"
  },
  {
    "text": "proxy let us take port 80 on this server and see if this is an",
    "start": "3136000",
    "end": "3141440"
  },
  {
    "text": "open proxy or not and says via proxy it got this signature",
    "start": "3141440",
    "end": "3146559"
  },
  {
    "text": "direct it got this different signature no this web server on port 80 is not an",
    "start": "3146559",
    "end": "3152079"
  },
  {
    "text": "open proxy so now we have a very accurate automated way of figuring out open proxies",
    "start": "3152079",
    "end": "3160079"
  },
  {
    "text": "now let's go ahead and try to pull up something like port scanning",
    "start": "3160079",
    "end": "3166720"
  },
  {
    "text": "through proxies now i know that the internal this 192 168",
    "start": "3166720",
    "end": "3173160"
  },
  {
    "text": "7.248 is a dual home system on the internal iep addressing range it has 10.0.1.1",
    "start": "3173160",
    "end": "3180400"
  },
  {
    "text": "that is the subnet we can always throw the entire you know non-routable range at it to figure out",
    "start": "3180400",
    "end": "3186880"
  },
  {
    "text": "if if this is there or not but for our demo purposes i've just shortened it so i have another program here called",
    "start": "3186880",
    "end": "3193680"
  },
  {
    "text": "proxy scan 192 168.7.248",
    "start": "3193680",
    "end": "3201000"
  },
  {
    "text": "port 8001. this is my suspect once i figure out this is an open proxy",
    "start": "3201760",
    "end": "3207920"
  },
  {
    "text": "now i have to give it the range that i think is on the inside so from 10.0.1.1",
    "start": "3207920",
    "end": "3214880"
  },
  {
    "text": "to 10.0.1.5 let's just say i want to take the first five system and look for open",
    "start": "3214880",
    "end": "3221599"
  },
  {
    "text": "port 80 on these internal systems so i hit this say run",
    "start": "3221599",
    "end": "3226880"
  },
  {
    "text": "and it starts returning your results 10.0.1.1 it came back with netscape enterprise60",
    "start": "3226880",
    "end": "3232960"
  },
  {
    "text": "this is the same system which is dual home the the 190 says 2 168 7 or 248",
    "start": "3232960",
    "end": "3239680"
  },
  {
    "text": "and 10.0.1.1 is the same system there's another system on the inside",
    "start": "3239680",
    "end": "3244800"
  },
  {
    "text": "which is running apache 1.3.19 this is actually",
    "start": "3244800",
    "end": "3251838"
  },
  {
    "text": "accessible through the proxy and we can verify this",
    "start": "3253280",
    "end": "3258480"
  },
  {
    "text": "through a browser let's let's first verify it through net",
    "start": "3258480",
    "end": "3264640"
  },
  {
    "text": "cat net cat 192.168.7.248.",
    "start": "3264640",
    "end": "3272760"
  },
  {
    "text": "port 8001 as a get http",
    "start": "3274800",
    "end": "3280319"
  },
  {
    "text": "10.0.1.2 port 80",
    "start": "3280319",
    "end": "3285520"
  },
  {
    "text": "http 1.0 it says object not found",
    "start": "3285520",
    "end": "3291440"
  },
  {
    "text": "returns you a server so yes indeed this is how you can target other systems on",
    "start": "3291440",
    "end": "3296559"
  },
  {
    "text": "the internal network through an open proxy we can verify the same thing through a browser um",
    "start": "3296559",
    "end": "3305480"
  },
  {
    "text": "and what i'm going to do is",
    "start": "3306240",
    "end": "3312400"
  },
  {
    "text": "set the proxy preferences",
    "start": "3312400",
    "end": "3315920"
  },
  {
    "text": "network",
    "start": "3318880",
    "end": "3321838"
  },
  {
    "text": "proxies oops sorry you're not supposed to see these",
    "start": "3324240",
    "end": "3331880"
  },
  {
    "text": "sorry those are my test proxies can't let you have that now can i uh",
    "start": "3336720",
    "end": "3341839"
  },
  {
    "text": "so i enable the web proxy",
    "start": "3341839",
    "end": "3345599"
  },
  {
    "text": "192 168 7 or 248 port 8001 say apply now",
    "start": "3347040",
    "end": "3354000"
  },
  {
    "text": "and go over here now i can start accessing systems on the 10.0.1.2",
    "start": "3354000",
    "end": "3361480"
  },
  {
    "text": "range yep it does exist of course no website is configured at this address but",
    "start": "3362640",
    "end": "3369520"
  },
  {
    "text": "yeah we we can start accessing systems on the internal network so that's what i wanted to show",
    "start": "3369520",
    "end": "3376319"
  },
  {
    "text": "and like one last trick that i have to disclose",
    "start": "3376319",
    "end": "3382319"
  },
  {
    "text": "before that let me turn this proxy stuff off",
    "start": "3382319",
    "end": "3387720"
  },
  {
    "text": "yes what he said is the the way to scan internal systems is the same when it",
    "start": "3396240",
    "end": "3401440"
  },
  {
    "text": "comes to ports 135 and such yes that is correct i'm going to show you that",
    "start": "3401440",
    "end": "3406559"
  },
  {
    "text": "so let's do that all we have to do is just use the same",
    "start": "3406559",
    "end": "3411920"
  },
  {
    "text": "program let us say proxy scan now instead of port 80 let's",
    "start": "3411920",
    "end": "3418079"
  },
  {
    "text": "say 1 35",
    "start": "3418079",
    "end": "3421599"
  },
  {
    "text": "first type address didn't have it second",
    "start": "3424559",
    "end": "3430440"
  },
  {
    "text": "it's actually timing out or it's just it's just not returning the connection back",
    "start": "3433440",
    "end": "3439839"
  },
  {
    "text": "well let me let me show you in another way there's actually port",
    "start": "3440160",
    "end": "3446559"
  },
  {
    "text": "five eight zero zero open which is v and c let's just try to scan systems for v and c",
    "start": "3446559",
    "end": "3452640"
  },
  {
    "text": "so over here yes you do get port five eight zero zero open on ten zero zero",
    "start": "3452640",
    "end": "3458640"
  },
  {
    "text": "ten zero 101.2 now just one more thing",
    "start": "3458640",
    "end": "3463839"
  },
  {
    "text": "i'll go back to the demo i'm into the slides",
    "start": "3463839",
    "end": "3469640"
  },
  {
    "text": "only can you issue get requests you can also do http connect which is even more",
    "start": "3474079",
    "end": "3479359"
  },
  {
    "text": "dangerous because connect frees you from the rest of http protocol",
    "start": "3479359",
    "end": "3486000"
  },
  {
    "text": "all it does is open up a bi-directional tcp stream and then you can tunnel whatever else you want over http connect",
    "start": "3486000",
    "end": "3493359"
  },
  {
    "text": "is originally meant to serve as a fix for proxying ssl traffic through because",
    "start": "3493359",
    "end": "3499280"
  },
  {
    "text": "ssl will you know just replace the rest of the http but",
    "start": "3499280",
    "end": "3504799"
  },
  {
    "text": "in a lot of cases if you have an open proxy or a reverse proxy chances are you'll have http connect",
    "start": "3504799",
    "end": "3513040"
  },
  {
    "text": "available as well to reach any port so now",
    "start": "3513040",
    "end": "3518240"
  },
  {
    "text": "what you can do is establish a connect between a port on the internal system",
    "start": "3518240",
    "end": "3523599"
  },
  {
    "text": "and then start tunneling all your data through",
    "start": "3523599",
    "end": "3527839"
  },
  {
    "text": "how many of you are familiar with this tool called data pipe it's a portrait director you open a",
    "start": "3529119",
    "end": "3535200"
  },
  {
    "text": "local port and you forward the port to a port on the remote system so what i did",
    "start": "3535200",
    "end": "3540799"
  },
  {
    "text": "is i hacked up data pipe and put in http proxy features through http connect so",
    "start": "3540799",
    "end": "3546240"
  },
  {
    "text": "i'm going to give you a demo of that",
    "start": "3546240",
    "end": "3549680"
  },
  {
    "text": "let me get back to this demo we know that vnc is running on the",
    "start": "3552799",
    "end": "3559200"
  },
  {
    "text": "system inside on 10.0.1.2 vnc runs on port 5800 through the web and 5900",
    "start": "3559200",
    "end": "3566960"
  },
  {
    "text": "through the native rfb protocol so what i want to do is",
    "start": "3566960",
    "end": "3572640"
  },
  {
    "text": "open up port 5900 on my local system my remote host is going to be 10.0.1.2",
    "start": "3573200",
    "end": "3583440"
  },
  {
    "text": "the remote port is going to be 5900 on that system my proxy host is going to be",
    "start": "3583440",
    "end": "3589520"
  },
  {
    "text": "192.168.7.2428 and my proxy port is 8001.",
    "start": "3589520",
    "end": "3597200"
  },
  {
    "text": "so now this is the way i can use an http proxy to connect to an internal vnc",
    "start": "3597200",
    "end": "3604640"
  },
  {
    "text": "so i run this i have i'm going to do an n-grip",
    "start": "3604640",
    "end": "3611040"
  },
  {
    "text": "to show you the traffic that really goes across",
    "start": "3611520",
    "end": "3618640"
  },
  {
    "text": "so i'm going to open up vnc",
    "start": "3618640",
    "end": "3622160"
  },
  {
    "text": "and connect to",
    "start": "3624880",
    "end": "3629559"
  },
  {
    "text": "go to open up vnc and connect to localhost",
    "start": "3630000",
    "end": "3635839"
  },
  {
    "text": "port 5900 is implied let's say i know the password",
    "start": "3635839",
    "end": "3640880"
  },
  {
    "text": "oops notice all this stuff is happening",
    "start": "3640880",
    "end": "3646318"
  },
  {
    "text": "and let me show you what's really happened",
    "start": "3649200",
    "end": "3655960"
  },
  {
    "text": "notice the connect went through this is you know part of the data pipe whenever it gets a connection it will shoot a",
    "start": "3665359",
    "end": "3670799"
  },
  {
    "text": "connect establish the connection and then hand over the connection to the bi-directional stream that's established",
    "start": "3670799",
    "end": "3677760"
  },
  {
    "text": "and let me drag over the vnc here is vnc running through an http",
    "start": "3677760",
    "end": "3685280"
  },
  {
    "text": "proxy from the outside to a non-routable address and",
    "start": "3685280",
    "end": "3690799"
  },
  {
    "text": "thank you things will run just fine you've owned people through http any arbitrary",
    "start": "3690799",
    "end": "3696720"
  },
  {
    "text": "protocol any port so uh yeah this was the",
    "start": "3696720",
    "end": "3703200"
  },
  {
    "text": "last of the tricks that i had to show you i will get back wind up the demo and be",
    "start": "3703200",
    "end": "3708400"
  },
  {
    "text": "happy to answer your questions in a little bit",
    "start": "3708400",
    "end": "3713838"
  },
  {
    "text": "oh okay",
    "start": "3713920",
    "end": "3717720"
  },
  {
    "text": "wait a second",
    "start": "3730960",
    "end": "3734280"
  },
  {
    "text": "so i just ended up resetting thing",
    "start": "3746319",
    "end": "3750240"
  },
  {
    "text": "so this was about http connect what can go wrong with that so just to summarize you know what is it",
    "start": "3751839",
    "end": "3758319"
  },
  {
    "text": "that we're really seeking when it comes to automated web security assessment we need to overcome http's customizable",
    "start": "3758319",
    "end": "3766240"
  },
  {
    "text": "aspects such as the server banner strings response codes but now we have technology",
    "start": "3766240",
    "end": "3772960"
  },
  {
    "text": "to defeat the obscurities or anomalies with these to improve accuracy and these core",
    "start": "3772960",
    "end": "3779920"
  },
  {
    "text": "concepts can be used to extend extend other assessment techniques like proxy",
    "start": "3779920",
    "end": "3785119"
  },
  {
    "text": "detection was one of them grouping is another one of them and so on so yeah my closing thoughts i never",
    "start": "3785119",
    "end": "3792000"
  },
  {
    "text": "really i never really discussed vulnerabilities so there's no counter measures you know these are just things",
    "start": "3792000",
    "end": "3797359"
  },
  {
    "text": "to keep in mind this is to help us become better security practitioners but one thing is you can't patch or hide",
    "start": "3797359",
    "end": "3804240"
  },
  {
    "text": "carelessness you know security by obscurity doesn't work there's no there's no patch to overcoming things",
    "start": "3804240",
    "end": "3810480"
  },
  {
    "text": "like secure coding read good books one of them is out there",
    "start": "3810480",
    "end": "3815520"
  },
  {
    "text": "and oops what",
    "start": "3815520",
    "end": "3820240"
  },
  {
    "text": "happened and thank you this this is formal conclusion of what i had",
    "start": "3822839",
    "end": "3828480"
  },
  {
    "text": "to say we have around 20 minutes to take",
    "start": "3828480",
    "end": "3834240"
  },
  {
    "text": "any questions and answers that you might have from this talk yes please uh can we have the",
    "start": "3834240",
    "end": "3839599"
  },
  {
    "text": "we'll just keep the lights on yes your question please",
    "start": "3839599",
    "end": "3844359"
  },
  {
    "text": "okay the your question is how much of my http fingerprinting technique was",
    "start": "3856160",
    "end": "3862000"
  },
  {
    "text": "dependent on the http rfc and how much was it dependent on patterns",
    "start": "3862000",
    "end": "3868000"
  },
  {
    "text": "that were returned uh none there is no dependency on patterns whatsoever because uh i have not",
    "start": "3868000",
    "end": "3876240"
  },
  {
    "text": "this is a statistical comparator you know it's just going to compare and score things it's not looking for any",
    "start": "3876240",
    "end": "3882240"
  },
  {
    "text": "patterns per se it's just looking at overall things it's like how do i explain fuzzy systems",
    "start": "3882240",
    "end": "3889680"
  },
  {
    "text": "you know it's basically you take blocks of string and you know all you care is if they differ or not you know not where they",
    "start": "3889680",
    "end": "3896160"
  },
  {
    "text": "differ or you know there's some quantifiable aspects like you know",
    "start": "3896160",
    "end": "3901200"
  },
  {
    "text": "what is the degree of difference not you know how many bytes differ say 20",
    "start": "3901200",
    "end": "3906799"
  },
  {
    "text": "bytes 30 bytes like how mathematically how close are two vectors to one another how far away that's what",
    "start": "3906799",
    "end": "3913039"
  },
  {
    "text": "that's the kind of pattern matching or string differentiation that i'm doing not looking for anything it it could be",
    "start": "3913039",
    "end": "3919200"
  },
  {
    "text": "very well applied to databases for all i ikea you can use this technique to build a database fingerprinter or you know",
    "start": "3919200",
    "end": "3927039"
  },
  {
    "text": "whatever sap or erp fingerprint any protocol can be fingerprinted using this",
    "start": "3927680",
    "end": "3932720"
  },
  {
    "text": "technique i just applied it to http because i like http and",
    "start": "3932720",
    "end": "3938319"
  },
  {
    "text": "then again the answer to your first part is how much of this is dependent on the http rfc again no dependency all i have",
    "start": "3938319",
    "end": "3945119"
  },
  {
    "text": "done is just collected a bunch of tests you know requests that would typically generate",
    "start": "3945119",
    "end": "3950640"
  },
  {
    "text": "varying responses uh yes some of them may be dependent on the rfc but in general",
    "start": "3950640",
    "end": "3958000"
  },
  {
    "text": "i never looked at the rfc to create those test requests you know pretty much evolved by trial and error",
    "start": "3958000",
    "end": "3963599"
  },
  {
    "text": "and so if say you were to build a database fingerprint you could have n number of database requests and gather",
    "start": "3963599",
    "end": "3969920"
  },
  {
    "text": "results and do this statistical thing so yeah that would be",
    "start": "3969920",
    "end": "3976400"
  },
  {
    "text": "my answer to your question your question please",
    "start": "3976400",
    "end": "3982079"
  },
  {
    "text": "great question uh are these tools available uh some of the technology especially",
    "start": "3983119",
    "end": "3988799"
  },
  {
    "text": "paid signatures and http fingerprinting is available in the nt objectives fire",
    "start": "3988799",
    "end": "3994160"
  },
  {
    "text": "and water toolkit the toolkit is still being updated and i will be posting out",
    "start": "3994160",
    "end": "4002400"
  },
  {
    "text": "separate versions shortly i do not know when just as soon as i head back to india in three weeks and",
    "start": "4002400",
    "end": "4010160"
  },
  {
    "text": "get going once again catch up on some rest but yes they will be publicly available",
    "start": "4010160",
    "end": "4015760"
  },
  {
    "text": "no the source will not be available and no i'm not going to talk about the internal statistic funkiness that i did",
    "start": "4015760",
    "end": "4022160"
  },
  {
    "text": "so but you can be free to use it and enjoy it and script it up and report it up and",
    "start": "4022160",
    "end": "4028400"
  },
  {
    "text": "play with it and send me feedback if it fails i'll be happy to fix it for you",
    "start": "4028400",
    "end": "4034920"
  },
  {
    "text": "uh your question",
    "start": "4034960",
    "end": "4040039"
  },
  {
    "text": "right uh question is i've used a training mode for uh you know building up the weight vectors for",
    "start": "4049280",
    "end": "4055760"
  },
  {
    "text": "fingerprinting does the software go in and out of training mode and such yes",
    "start": "4055760",
    "end": "4061280"
  },
  {
    "text": "well initially there's the the engine is the same i just have two binaries one to keep on accumulating and training and",
    "start": "4061280",
    "end": "4068640"
  },
  {
    "text": "then once you know i have then it'll show me that you know here are the different groups all i have to",
    "start": "4068640",
    "end": "4073839"
  },
  {
    "text": "do is go and label these groups so i'll label one of the groups as is 4.0 because i know that you know all those",
    "start": "4073839",
    "end": "4079760"
  },
  {
    "text": "servers were is 4.0 if there's is5 i'll label it as is5 and then once i put the",
    "start": "4079760",
    "end": "4086160"
  },
  {
    "text": "labels in that is when the software becomes into uh production mode i can train it as much or as little as i want",
    "start": "4086160",
    "end": "4093440"
  },
  {
    "text": "the the thing just remains the same so yeah there's two binaries but no the the training logic is not",
    "start": "4093440",
    "end": "4100400"
  },
  {
    "text": "different than the fingerprinting logic it's like",
    "start": "4100400",
    "end": "4106238"
  },
  {
    "text": "labeled inputs and unlabeled inputs that's what it all boils down to",
    "start": "4106239",
    "end": "4112000"
  },
  {
    "text": "jeremiah",
    "start": "4112000",
    "end": "4115000"
  },
  {
    "text": "how do you ensure that the page signature is the same as even though there's dynamic content",
    "start": "4121839",
    "end": "4128080"
  },
  {
    "text": "there's a lot of i had to overcome this question with a lot of mathematical stuff you know if",
    "start": "4128159",
    "end": "4135359"
  },
  {
    "text": "you let me give you a brief response you familiar with uh fourier transform",
    "start": "4135359",
    "end": "4140560"
  },
  {
    "text": "theory you know you have signals and then you know if you do a fourier transform you group them by frequency so if you apply",
    "start": "4140560",
    "end": "4148000"
  },
  {
    "text": "this to strings you group you're not looking at patterns and then you're looking at you know what",
    "start": "4148000",
    "end": "4153520"
  },
  {
    "text": "are the frequencies of symbols occurring in the stream and you",
    "start": "4153520",
    "end": "4158798"
  },
  {
    "text": "know if those are similar you know then you it's again then there's a fuzzification that what are the",
    "start": "4158799",
    "end": "4165120"
  },
  {
    "text": "thresholds you know how much do you do so that's that's the way you could do it",
    "start": "4165120",
    "end": "4170480"
  },
  {
    "text": "the other approach i used was longest common subsequence like pretty much what dif does",
    "start": "4170480",
    "end": "4175679"
  },
  {
    "text": "and then you know you have a threshold to ignore any diffs that are less than so much percentage of the string but",
    "start": "4175679",
    "end": "4181920"
  },
  {
    "text": "that's an order of n square computation you have to if the string is",
    "start": "4181920",
    "end": "4187040"
  },
  {
    "text": "n bytes long it's it'll take you an n square time to compute and it will not scale",
    "start": "4187040",
    "end": "4192798"
  },
  {
    "text": "somebody else had a question yes",
    "start": "4192799",
    "end": "4196839"
  },
  {
    "text": "have i have i tried this thing on pages that majority of the content is random",
    "start": "4206960",
    "end": "4213840"
  },
  {
    "text": "well i would say i have not tried it on pages where 50 or more content is random but it",
    "start": "4214400",
    "end": "4220320"
  },
  {
    "text": "works with a huge you know for all practical purposes it catches",
    "start": "4220320",
    "end": "4225520"
  },
  {
    "text": "high degrees of randomness but if you have pages that are heavily random then it won't work",
    "start": "4225520",
    "end": "4231920"
  },
  {
    "text": "perhaps i'm not right but you know what if you have such a page or set up",
    "start": "4231920",
    "end": "4237520"
  },
  {
    "text": "i'll figure it i'll figure something out",
    "start": "4237520",
    "end": "4241760"
  },
  {
    "text": "okay great no problem",
    "start": "4243280",
    "end": "4246639"
  },
  {
    "text": "anything else yes your question",
    "start": "4249199",
    "end": "4255800"
  },
  {
    "text": "have i tried with asp pages and different parameters passed in uh tried",
    "start": "4259600",
    "end": "4264880"
  },
  {
    "text": "what page signatures with it yes yes if you have different parameters which are being passed in",
    "start": "4264880",
    "end": "4272320"
  },
  {
    "text": "yes yes let me actually you know let me demo this good good question",
    "start": "4273199",
    "end": "4278960"
  },
  {
    "text": "i happen to have an asp page",
    "start": "4278960",
    "end": "4284320"
  },
  {
    "text": "but it's actually a cgi page",
    "start": "4284320",
    "end": "4287840"
  },
  {
    "text": "okay it's this see here's a page say index.cgi",
    "start": "4291440",
    "end": "4299040"
  },
  {
    "text": "page is equal to false.shtml all right here's another one",
    "start": "4299040",
    "end": "4306640"
  },
  {
    "text": "page is equal to flower.html so these are parameters now let's take the page signatures of these so i just cut this",
    "start": "4306640",
    "end": "4314880"
  },
  {
    "text": "i will take it here page signature",
    "start": "4314880",
    "end": "4320719"
  },
  {
    "text": "paste this guy blam it return something now let's go back to",
    "start": "4320719",
    "end": "4326080"
  },
  {
    "text": "the other page let's say golden sunset",
    "start": "4326080",
    "end": "4330719"
  },
  {
    "text": "and signature",
    "start": "4332159",
    "end": "4338080"
  },
  {
    "text": "paste this yep the signatures are the same so you know parameters can vary and signatures",
    "start": "4338080",
    "end": "4344960"
  },
  {
    "text": "will remain the same even if there was some more or some less as long as the basic",
    "start": "4344960",
    "end": "4350800"
  },
  {
    "text": "basic uh you know the basic program that generated these is more or less the same",
    "start": "4350800",
    "end": "4356400"
  },
  {
    "text": "it will stay the same",
    "start": "4356400",
    "end": "4359280"
  },
  {
    "text": "have i tried fingerprinting parameters like could you could you just explain",
    "start": "4361760",
    "end": "4369480"
  },
  {
    "text": "uh i have say i have a cgi page and i want to find out what parameters it can",
    "start": "4379280",
    "end": "4385520"
  },
  {
    "text": "have i'm not too sure how fingerprinting can help in this one",
    "start": "4385520",
    "end": "4394400"
  },
  {
    "text": "we can always i mean one can always look at the source and figure out if there's input fields but no that will happen",
    "start": "4394400",
    "end": "4400159"
  },
  {
    "text": "only if there's a form no i",
    "start": "4400159",
    "end": "4405679"
  },
  {
    "text": "i don't know how to how to fingerprint or perhaps what would be the kind of value that you want to generate out of",
    "start": "4405679",
    "end": "4412480"
  },
  {
    "text": "figuring out parameter fingerprints",
    "start": "4412480",
    "end": "4417600"
  },
  {
    "text": "see one way to do it is to you know if the page has parameters that are not derived from a form",
    "start": "4431600",
    "end": "4438719"
  },
  {
    "text": "then you can just crawl the site and figure out all the pages with the parameters and you know once you group",
    "start": "4438719",
    "end": "4444000"
  },
  {
    "text": "them by page signatures you'll figure out that i even if the parameters vary this is still the same resource you can",
    "start": "4444000",
    "end": "4450159"
  },
  {
    "text": "eliminate 99 out of 100 and just look at the one resource if the parameters are generated of a form then you don't need",
    "start": "4450159",
    "end": "4457199"
  },
  {
    "text": "to look at the signature you just look at the form source code look at the action is equal",
    "start": "4457199",
    "end": "4463040"
  },
  {
    "text": "to and figure out all the input fields that go into the form target",
    "start": "4463040",
    "end": "4469520"
  },
  {
    "text": "no you can even have the html form code right you can have the html form code",
    "start": "4469520",
    "end": "4475679"
  },
  {
    "text": "you know the form input all those fields will be readily available to you in html you don't need the source for that and",
    "start": "4475679",
    "end": "4482159"
  },
  {
    "text": "you say the action is equal to target script all these parameters will go to the target script",
    "start": "4482159",
    "end": "4489199"
  },
  {
    "text": "right your question i'm hoping but",
    "start": "4489199",
    "end": "4494840"
  },
  {
    "text": "um perception of what i see here is a proxy server or a web server that's working as a proxy server",
    "start": "4494840",
    "end": "4500480"
  },
  {
    "text": "um is that by default or is that a special function that's running on this box",
    "start": "4500480",
    "end": "4507440"
  },
  {
    "text": "again i apologize no no no i will answer you your your basic question is you know",
    "start": "4507440",
    "end": "4513040"
  },
  {
    "text": "how how come a web server is you know what are the causes that make a web server",
    "start": "4513040",
    "end": "4518159"
  },
  {
    "text": "behave like a proxy server sometimes see here is our exam the",
    "start": "4518159",
    "end": "4523440"
  },
  {
    "text": "example that i gave you was a misconfigured squid server it was a squid proxy sometimes what",
    "start": "4523440",
    "end": "4529600"
  },
  {
    "text": "happens is companies will use a squid proxy to let their internal traffic",
    "start": "4529600",
    "end": "4535280"
  },
  {
    "text": "in and out via one system and sometimes it can be misconfigured so that it lets",
    "start": "4535280",
    "end": "4540560"
  },
  {
    "text": "traffic the other way in as well sometimes systems like compact insight",
    "start": "4540560",
    "end": "4545679"
  },
  {
    "text": "manager you know the way they've implemented the http engine by i mean they took http proxies just by",
    "start": "4545679",
    "end": "4552560"
  },
  {
    "text": "mistake and let things through it was a design flaw sometimes you have",
    "start": "4552560",
    "end": "4558000"
  },
  {
    "text": "a front end say an iis or a netscape enterprise server which hands over different parts or maps or different",
    "start": "4558000",
    "end": "4564480"
  },
  {
    "text": "parts of the application to back ends saying the netscape server all it does is serve out static front pages then certain",
    "start": "4564480",
    "end": "4571760"
  },
  {
    "text": "applications like a stock trading application might be running on an iis system which is",
    "start": "4571760",
    "end": "4577440"
  },
  {
    "text": "internally proxied through and the configuration is such that it's proxied through or a java server plug-in might",
    "start": "4577440",
    "end": "4583840"
  },
  {
    "text": "be running on a different port and things are handed off internally or rewritten so again these would cause",
    "start": "4583840",
    "end": "4590159"
  },
  {
    "text": "this type of proxy behavior",
    "start": "4590159",
    "end": "4593840"
  },
  {
    "text": "yeah it's other things and typically the more complex something becomes uh these kind of things have a higher probability",
    "start": "4595840",
    "end": "4602159"
  },
  {
    "text": "of occurrence welcome yeah apache by itself doesn't do this is by itself don't do this it's",
    "start": "4602159",
    "end": "4608480"
  },
  {
    "text": "like yeah what you configure it as can leave this open",
    "start": "4608480",
    "end": "4613600"
  },
  {
    "text": "okay anything else",
    "start": "4613600",
    "end": "4618239"
  },
  {
    "text": "all right i am done thank you for your attention",
    "start": "4619520",
    "end": "4626679"
  },
  {
    "text": "you",
    "start": "5214000",
    "end": "5216080"
  }
]