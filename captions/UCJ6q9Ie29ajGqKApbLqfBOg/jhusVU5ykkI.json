[
  {
    "start": "0",
    "end": "111000"
  },
  {
    "text": "hello everyone today we will talk about the exploitation of a modern smartphone",
    "start": "30",
    "end": "5490"
  },
  {
    "text": "based and so this is our agenda for today at the beginning we will do some",
    "start": "5490",
    "end": "13830"
  },
  {
    "text": "introduction and show some related work and then do some background for some",
    "start": "13830",
    "end": "19740"
  },
  {
    "text": "necessary knowledge to understand this talk and then we will show to you a pack",
    "start": "19740",
    "end": "27090"
  },
  {
    "text": "of the basement which we use in mobile upon to own what we device and then we",
    "start": "27090",
    "end": "33630"
  },
  {
    "text": "will show to you how to deliver and exploit at the back we will do a demo and finally we will explore a little bit",
    "start": "33630",
    "end": "41100"
  },
  {
    "text": "the concept of escaping from the basement and then we will do conclusions",
    "start": "41100",
    "end": "47420"
  },
  {
    "text": "so we are from $0.10 keen security lab and previously we were known as skin",
    "start": "47420",
    "end": "54239"
  },
  {
    "text": "team and I'm Marko and my main focus is hypervisor and the basement and CM where",
    "start": "54239",
    "end": "60960"
  },
  {
    "text": "and those are my colleagues and is a",
    "start": "60960",
    "end": "69570"
  },
  {
    "text": "member of a jury Kim Kim also steeped in foreign country",
    "start": "69570",
    "end": "80040"
  },
  {
    "text": "the captain of city in video here and trip movie okay so about our security",
    "start": "80040",
    "end": "88890"
  },
  {
    "text": "lab we are a white hat security researcher and we are based in Shanghai in China and you can see our blog and",
    "start": "88890",
    "end": "96869"
  },
  {
    "text": "Twitter if you want to follow our our research our research area our DC",
    "start": "96869",
    "end": "102689"
  },
  {
    "text": "security mobile security baseband and VMware virtualization car security and",
    "start": "102689",
    "end": "108540"
  },
  {
    "text": "application security so let's start",
    "start": "108540",
    "end": "113670"
  },
  {
    "start": "111000",
    "end": "111000"
  },
  {
    "text": "start talking about baseband so there is a small amount of public research on",
    "start": "113670",
    "end": "119040"
  },
  {
    "text": "basement this is most likely because the complexity of the baseband is by type",
    "start": "119040",
    "end": "124590"
  },
  {
    "text": "and you have to deal with complex specification so you need to study a lot",
    "start": "124590",
    "end": "130950"
  },
  {
    "text": "of material in order to get - no this this radio network so the",
    "start": "130950",
    "end": "137489"
  },
  {
    "text": "entry barrier is a little bit high but nevertheless we have the billions of",
    "start": "137489",
    "end": "142530"
  },
  {
    "text": "smart phone around the world and the most of them they have a baseband processor and this attack surface is",
    "start": "142530",
    "end": "150870"
  },
  {
    "text": "reachable remotely so it's important to study and doubt it usually a baseband",
    "start": "150870",
    "end": "158220"
  },
  {
    "text": "can provide the first remote code execution bug that you can trigger over-the-air and start to compromise a",
    "start": "158220",
    "end": "164790"
  },
  {
    "text": "smartphone without user interaction so our talk will focus on the huawei",
    "start": "164790",
    "end": "171030"
  },
  {
    "text": "basement because it was our work at the mobile point 1 2017 where we",
    "start": "171030",
    "end": "176519"
  },
  {
    "text": "successfully exploited it over there but there are other works on other baseband",
    "start": "176519",
    "end": "182910"
  },
  {
    "text": "for example there is work on samsung Shannon the Intel baseband the Qualcomm",
    "start": "182910",
    "end": "188910"
  },
  {
    "text": "basement and mtk basement so how does a",
    "start": "188910",
    "end": "195090"
  },
  {
    "text": "modern smartphone looks like maybe 20 years ago or I don't know 10 years ago a",
    "start": "195090",
    "end": "201630"
  },
  {
    "text": "phone was just a single CPU executing everything and but now it's different",
    "start": "201630",
    "end": "208889"
  },
  {
    "text": "you have a main CPU which is called application processor which is executing your main operating system which can be",
    "start": "208889",
    "end": "215760"
  },
  {
    "text": "for example Android or iOS and then you say you have several other processor",
    "start": "215760",
    "end": "221400"
  },
  {
    "text": "involved in other operation and in the radio area you have the basement",
    "start": "221400",
    "end": "227370"
  },
  {
    "text": "processor and the Wi-Fi and Bluetooth system of system chip mainly and the",
    "start": "227370",
    "end": "233639"
  },
  {
    "text": "basement handled the communication the radio communication with many different",
    "start": "233639",
    "end": "238769"
  },
  {
    "text": "type of network such as 2g 3G 4G so for example they could be GSM UMTS and LTE",
    "start": "238769",
    "end": "247260"
  },
  {
    "text": "and this kind of radio component can be attacked remotely over-the-air so we",
    "start": "247260",
    "end": "257070"
  },
  {
    "start": "254000",
    "end": "254000"
  },
  {
    "text": "just told you that you have application processor and then you have a paste and and they are two separate CPU but they",
    "start": "257070",
    "end": "265800"
  },
  {
    "text": "communicate each and usually they do it with a bus which",
    "start": "265800",
    "end": "271120"
  },
  {
    "text": "depending on implementation could be USB PCI Express or shared memory so since",
    "start": "271120",
    "end": "279580"
  },
  {
    "text": "they are separate system from each other if you get remote code execution on the basement you run code inside the",
    "start": "279580",
    "end": "286300"
  },
  {
    "text": "debasement you don't run code on the application processor because those two are two separate CPU but the Advanta",
    "start": "286300",
    "end": "294520"
  },
  {
    "text": "advantage is that based on the lag behind in terms of mitigation compared",
    "start": "294520",
    "end": "299560"
  },
  {
    "text": "to the application processor for example in the Wow in basement we notice that",
    "start": "299560",
    "end": "305110"
  },
  {
    "text": "they lack of SLR and stack cookies so the remote exploitation is easier but",
    "start": "305110",
    "end": "312760"
  },
  {
    "text": "this kind of lack of mitigation is not only on this basement it's widespread",
    "start": "312760",
    "end": "318100"
  },
  {
    "text": "between basically all manufacture so why",
    "start": "318100",
    "end": "323680"
  },
  {
    "text": "do we want to target the basement there are several reason which can be an",
    "start": "323680",
    "end": "329680"
  },
  {
    "text": "advantage first it's less understood attack surface and less audited second",
    "start": "329680",
    "end": "337420"
  },
  {
    "text": "one it can be exploited remotely over the air and potentially you can do it from very long distance because if you",
    "start": "337420",
    "end": "344140"
  },
  {
    "text": "think about it maybe your phone right now is connected to a base station several kilometres from here the third",
    "start": "344140",
    "end": "352240"
  },
  {
    "text": "reason is like I said the lack of mitigation and often when a device die",
    "start": "352240",
    "end": "361330"
  },
  {
    "text": "such as for example the iPhone has a quite calm voice then maybe Apple",
    "start": "361330",
    "end": "367150"
  },
  {
    "text": "doesn't have access to the source code of the basement so they cannot audit themselves so it's less people looking",
    "start": "367150",
    "end": "373540"
  },
  {
    "text": "for Bobby there and last but not least reason it's because of complexity of",
    "start": "373540",
    "end": "378820"
  },
  {
    "text": "course so we need to interact with radio so we need to know Auto radio technology",
    "start": "378820",
    "end": "386400"
  },
  {
    "start": "380000",
    "end": "380000"
  },
  {
    "text": "luckily today it's easier to do this kind of research tends to software-defined radio they are",
    "start": "386400",
    "end": "394090"
  },
  {
    "text": "inexpensive electronic device which allows you to run fake base station",
    "start": "394090",
    "end": "400090"
  },
  {
    "text": "basically and with this fake base station you can attack the basement and example of this",
    "start": "400090",
    "end": "406660"
  },
  {
    "text": "kind of product can be blade RF for us RT and there is a lot of open source",
    "start": "406660",
    "end": "412450"
  },
  {
    "text": "software but the only problem is that they cover only some radio stacks and we",
    "start": "412450",
    "end": "418930"
  },
  {
    "text": "will see why this will be a problem for us so the traditional way to attack a",
    "start": "418930",
    "end": "425170"
  },
  {
    "text": "basement is to run base station with a STR and the problem why this is exactly",
    "start": "425170",
    "end": "432550"
  },
  {
    "text": "is it because the older network like GSM they don't have mutual authentication so",
    "start": "432550",
    "end": "439419"
  },
  {
    "text": "if I just go around with a SDR and my signal is stronger than the base station",
    "start": "439419",
    "end": "444880"
  },
  {
    "text": "of the carrier then your phone will connect to my SDR based fake base",
    "start": "444880",
    "end": "450580"
  },
  {
    "text": "station and I can exploit your basement and like I said we cannot use this",
    "start": "450580",
    "end": "456850"
  },
  {
    "text": "approach in our case unfortunately so",
    "start": "456850",
    "end": "461880"
  },
  {
    "text": "probably in the u.s. you already know what CDMA is because it was popular in",
    "start": "461880",
    "end": "468370"
  },
  {
    "text": "the US and the our bot will be in the CDMA part so we needed to at least know",
    "start": "468370",
    "end": "474910"
  },
  {
    "text": "what CDMA is CDMA is a family of three G Network which allow you to carry a voice",
    "start": "474910",
    "end": "483490"
  },
  {
    "text": "data and signal data so it was competing in some area of the world with unts so",
    "start": "483490",
    "end": "493260"
  },
  {
    "text": "to some sama sum up basically a dividend is a black box inside of your phone",
    "start": "493260",
    "end": "500560"
  },
  {
    "text": "which fans are not specified VMware and it's kind of similar to IOT device",
    "start": "500560",
    "end": "507100"
  },
  {
    "text": "because they run like a real-time operating system and they have tasks and they schedule those tasks and each task",
    "start": "507100",
    "end": "515680"
  },
  {
    "text": "is responsible for some layer or some component of the basement and the",
    "start": "515680",
    "end": "521110"
  },
  {
    "text": "complexity is huge because if you take for example the GPRS or GSM",
    "start": "521110",
    "end": "527639"
  },
  {
    "text": "specification they are thousands of pages so let's talk a little bit more",
    "start": "527639",
    "end": "536139"
  },
  {
    "text": "about real-time operating system on days when like I said they run tasks but what",
    "start": "536139",
    "end": "541779"
  },
  {
    "text": "you need to know is that often there is a task for every Network layer you can",
    "start": "541779",
    "end": "548290"
  },
  {
    "text": "find in the protocol so for example if you take it a mobility management layer which is a GSM part you are often able",
    "start": "548290",
    "end": "558850"
  },
  {
    "text": "to find a task called mmm which is responsible for this part so once you",
    "start": "558850",
    "end": "564880"
  },
  {
    "text": "identify the correct task you can check the message handler because this kind of",
    "start": "564880",
    "end": "570670"
  },
  {
    "text": "task they communicate via IPC and once you found this message handler you can",
    "start": "570670",
    "end": "577690"
  },
  {
    "text": "identify the function responsible for parsing and processing the radio message",
    "start": "577690",
    "end": "584010"
  },
  {
    "text": "which is the one that the attacker controls and you can start from here to audit for memory corruption bugs so how",
    "start": "584010",
    "end": "594490"
  },
  {
    "text": "do you start to define bugs we need the first of course to collect information and we have three mains",
    "start": "594490",
    "end": "600070"
  },
  {
    "text": "trimming area to get information the first one is of course fumer the second",
    "start": "600070",
    "end": "605290"
  },
  {
    "text": "one is runtime information for some debugging at least the third one is",
    "start": "605290",
    "end": "610390"
  },
  {
    "text": "online information so we will check those three so the fumer for huawei we",
    "start": "610390",
    "end": "617470"
  },
  {
    "text": "grabbed it from the file system of the smartphone you can find a file called",
    "start": "617470",
    "end": "622630"
  },
  {
    "text": "the sector belong modem dot bean and it's on the file system of the phone",
    "start": "622630",
    "end": "628540"
  },
  {
    "text": "because the Android kernel will load it and then it will pass it to the trust zone trusted execution environment to",
    "start": "628540",
    "end": "636069"
  },
  {
    "text": "check the signature and then load it into the base and memory and start to the basement since we got this file",
    "start": "636069",
    "end": "642760"
  },
  {
    "text": "after some adjustment we can just load it in either Pro and start at the reverse engineering as you know if you",
    "start": "642760",
    "end": "650410"
  },
  {
    "text": "do reverse engineering if you have any kind of debugging or runtime information",
    "start": "650410",
    "end": "655660"
  },
  {
    "text": "it's very useful in the wall a basement there was some",
    "start": "655660",
    "end": "660959"
  },
  {
    "text": "runtime shell called the seashell but sadly now it has been removed when you",
    "start": "660959",
    "end": "666870"
  },
  {
    "text": "were version so we cannot use it anymore however we found out that when you crash",
    "start": "666870",
    "end": "672690"
  },
  {
    "text": "the basement with some bug it will output some log to the application",
    "start": "672690",
    "end": "678300"
  },
  {
    "text": "processor and store it on the filesystem and also if you have kernel code execution you can just read the basement",
    "start": "678300",
    "end": "685980"
  },
  {
    "text": "memory from physical memory of the device starting from this address and this kind of memory dump capability",
    "start": "685980",
    "end": "693690"
  },
  {
    "text": "helped us a lot to adjust our expert we",
    "start": "693690",
    "end": "700410"
  },
  {
    "text": "did some research online and I mean of course you need to know that 3gpp specifications since you are attacking",
    "start": "700410",
    "end": "706380"
  },
  {
    "text": "radio network you need to know how those network work and the second one we found",
    "start": "706380",
    "end": "712230"
  },
  {
    "text": "some leak at the version of the source code it was old but it was very useful for",
    "start": "712230",
    "end": "718529"
  },
  {
    "text": "reverse engineer and then there is this small project which also was quite",
    "start": "718529",
    "end": "724920"
  },
  {
    "text": "useful because it documents the format of the non-volatile Ram for this data so",
    "start": "724920",
    "end": "732500"
  },
  {
    "text": "let's now go into the case study of the basement so this section of the",
    "start": "732500",
    "end": "740220"
  },
  {
    "text": "presentation we will first show the back then we will explain how we trigger it",
    "start": "740220",
    "end": "746520"
  },
  {
    "text": "and then our we exploited it so our",
    "start": "746520",
    "end": "751770"
  },
  {
    "text": "point woman vulnerability was in the CDMA part of the basement specifically",
    "start": "751770",
    "end": "757260"
  },
  {
    "text": "in a apart CDMA 1x SMS transport message",
    "start": "757260",
    "end": "762350"
  },
  {
    "text": "transport layer message in a function that it's responsible for some message",
    "start": "762350",
    "end": "769290"
  },
  {
    "text": "called PR L so at the bottom you can see a like a very simplified version of the",
    "start": "769290",
    "end": "775380"
  },
  {
    "text": "back but first before we check the back we need to check what men copy s is and",
    "start": "775380",
    "end": "783329"
  },
  {
    "text": "copy s is a secure version of a more secure version of the memory copy instead of taking three parameters",
    "start": "783329",
    "end": "790870"
  },
  {
    "text": "which should be a destination source and size they take four because if",
    "start": "790870",
    "end": "797069"
  },
  {
    "text": "destination destination size source and source size in this way they can check",
    "start": "797069",
    "end": "803079"
  },
  {
    "text": "if the copy goes out of bound the right or out of boundary in terms of length so",
    "start": "803079",
    "end": "809709"
  },
  {
    "text": "they can do this kind of check and for example if you are overflowing the destination they will panic the basement",
    "start": "809709",
    "end": "817750"
  },
  {
    "text": "and they will you you cannot exploit this back and this kind of method is a little bit maybe primitive but it gives",
    "start": "817750",
    "end": "826870"
  },
  {
    "text": "a lot of back actually purely by chance and luckily our body is not affected by",
    "start": "826870",
    "end": "833019"
  },
  {
    "text": "this because we control the offset of the destination so let's check again in",
    "start": "833019",
    "end": "841209"
  },
  {
    "text": "the bud basically in this function some offset and the lengths are extracted",
    "start": "841209",
    "end": "847149"
  },
  {
    "text": "from the message then you have this for loop which is incrementing the variable called byte position and it keep adding",
    "start": "847149",
    "end": "855100"
  },
  {
    "text": "some length that we control to the to the offset and these objects this offset",
    "start": "855100",
    "end": "860230"
  },
  {
    "text": "is used as a offset into the destination buffer so at the end we can out of bound",
    "start": "860230",
    "end": "867160"
  },
  {
    "text": "right and we this lead to a exploitable stack overflow on the base so now they",
    "start": "867160",
    "end": "876370"
  },
  {
    "text": "will I will leave the stage and they will explain to you how to trigger the body okay I will talk about how to how",
    "start": "876370",
    "end": "886269"
  },
  {
    "text": "it figure and deliver or exploit to the base that so probably you will know that",
    "start": "886269",
    "end": "894600"
  },
  {
    "start": "890000",
    "end": "890000"
  },
  {
    "text": "traditional to talk with the pace van we need some open relay some open source",
    "start": "894600",
    "end": "901029"
  },
  {
    "text": "project which based on the soft defined radio tracks there are many many open",
    "start": "901029",
    "end": "907420"
  },
  {
    "text": "source project that can help us to set up certain networks such as via open DPS",
    "start": "907420",
    "end": "913449"
  },
  {
    "text": "which help us to give you the GSM network or open or open our interface which can",
    "start": "913449",
    "end": "920250"
  },
  {
    "text": "help us to set up a LTE network but you",
    "start": "920250",
    "end": "925800"
  },
  {
    "text": "know that or case it the refined back in the CDMA that seems none of the those",
    "start": "925800",
    "end": "931890"
  },
  {
    "text": "open source project do not support the CDMA protocol so is that means that we",
    "start": "931890",
    "end": "939870"
  },
  {
    "text": "have to build a new project to export it to write a thousand or much much more",
    "start": "939870",
    "end": "946740"
  },
  {
    "text": "co2 to make a new product to support its",
    "start": "946740",
    "end": "951770"
  },
  {
    "text": "anomia higher stop so we came up with a different solution actually we abused",
    "start": "951770",
    "end": "961190"
  },
  {
    "text": "multi-protocol testers made by loads Schwartz this machine is used used to be",
    "start": "961190",
    "end": "969000"
  },
  {
    "text": "design is designed we tested signal and non signal functionality of mobile",
    "start": "969000",
    "end": "974730"
  },
  {
    "text": "stations it supports different networks including or targets which is in CDMA so",
    "start": "974730",
    "end": "982620"
  },
  {
    "text": "you will see that how we reverse this machine and Paget's to make it specify",
    "start": "982620",
    "end": "988770"
  },
  {
    "text": "our requirement to deliver and to to trigger back so we use this machine",
    "start": "988770",
    "end": "997410"
  },
  {
    "text": "together with a Faraday cage assuring box in order to gain better stability",
    "start": "997410",
    "end": "1004900"
  },
  {
    "text": "and now as well we also use this cake to",
    "start": "1004900",
    "end": "1010040"
  },
  {
    "text": "avoid any interferences you know that you cannot it cannot disturb any common",
    "start": "1010040",
    "end": "1016700"
  },
  {
    "text": "communications in the air otherwise you may breaks law in many countries so we have to do that and",
    "start": "1016700",
    "end": "1023770"
  },
  {
    "text": "using this machine from the user interface we can adjust the network",
    "start": "1023770",
    "end": "1029540"
  },
  {
    "text": "parameters such as the country code the network code and even the channel channel neighbors and",
    "start": "1029540",
    "end": "1036800"
  },
  {
    "text": "so on so after connecting the mobile phone with the this machine we can to",
    "start": "1036800",
    "end": "1043069"
  },
  {
    "text": "this network which the this machine make it we can make her phone calls and even",
    "start": "1043070",
    "end": "1051380"
  },
  {
    "text": "send text messages from the interface but it's a common tester so we cannot",
    "start": "1051380",
    "end": "1060710"
  },
  {
    "start": "1056000",
    "end": "1056000"
  },
  {
    "text": "use it to deliver or malicious payload so we have to hack into this machine to",
    "start": "1060710",
    "end": "1067460"
  },
  {
    "text": "make it satisfy our requirement this machine contains different part the",
    "start": "1067460",
    "end": "1075770"
  },
  {
    "text": "major part is so-called base unit which including mainboard and memories and",
    "start": "1075770",
    "end": "1081560"
  },
  {
    "text": "hard drive the person experienced Windows operating system which is a",
    "start": "1081560",
    "end": "1086990"
  },
  {
    "text": "quite old version of Windows and to support different different protocol",
    "start": "1086990",
    "end": "1093470"
  },
  {
    "text": "stacks the different so-called optional link handle pores plaque needed if for",
    "start": "1093470",
    "end": "1101600"
  },
  {
    "text": "example if you want this machine's whispered the GSM you need to plug a",
    "start": "1101600",
    "end": "1106610"
  },
  {
    "text": "so-called p21 singular unit and mainboard and to support CVMA we need",
    "start": "1106610",
    "end": "1114940"
  },
  {
    "text": "b83 signal early on it so like the shot",
    "start": "1114940",
    "end": "1120320"
  },
  {
    "text": "message as example when the users tried to send a message to the mobile station",
    "start": "1120320",
    "end": "1126770"
  },
  {
    "text": "to the base pair he input the plain tax and interface and soon it will try to",
    "start": "1126770",
    "end": "1133760"
  },
  {
    "text": "encode the message and send it as a so-called link handling message to the",
    "start": "1133760",
    "end": "1139940"
  },
  {
    "text": "sync single unit and then the single errand in Rio had headers and calculate",
    "start": "1139940",
    "end": "1146120"
  },
  {
    "text": "the checksum to generate assembled automatic one unit and finally it is",
    "start": "1146120",
    "end": "1152020"
  },
  {
    "text": "unknown if you have sent to the base can browse on channels so or target is",
    "start": "1152020",
    "end": "1158960"
  },
  {
    "text": "trying to patch this machine to make it deliver or",
    "start": "1158960",
    "end": "1165140"
  },
  {
    "text": "malicious payload so we have to do some",
    "start": "1165140",
    "end": "1172110"
  },
  {
    "text": "work on the base unit as well as the single a on it so it can just make the a pair of just",
    "start": "1172110",
    "end": "1179640"
  },
  {
    "text": "pass through the two units and attract Li instant into the base station",
    "start": "1179640",
    "end": "1187490"
  },
  {
    "text": "immobilization so let me talk about the",
    "start": "1187490",
    "end": "1193710"
  },
  {
    "text": "basics we reverse the base unit the",
    "start": "1193710",
    "end": "1202530"
  },
  {
    "text": "facility is built on top of the min/max of stars and the windows you can see the",
    "start": "1202530",
    "end": "1210210"
  },
  {
    "text": "house list in the right of the slide and users can send a short message from",
    "start": "1210210",
    "end": "1217140"
  },
  {
    "text": "using user individual truce a pretty fine line to send so it's all about the",
    "start": "1217140",
    "end": "1223710"
  },
  {
    "text": "p reversing work so we are able to locate the person sending the message to",
    "start": "1223710",
    "end": "1228980"
  },
  {
    "text": "single element now actually we find dynamic library in this file system",
    "start": "1228980",
    "end": "1235890"
  },
  {
    "text": "which probably means the the cdma2000",
    "start": "1235890",
    "end": "1241250"
  },
  {
    "text": "mobile station this dynamic library to read content from internal file and",
    "start": "1241250",
    "end": "1247350"
  },
  {
    "text": "encode it and then send it to the single layer on it as so cuddling handling",
    "start": "1247350",
    "end": "1253380"
  },
  {
    "text": "message the foul is showing the low box in the",
    "start": "1253380",
    "end": "1258480"
  },
  {
    "text": "slide so you can see that we can specify the telus server's IP which is quite low",
    "start": "1258480",
    "end": "1265679"
  },
  {
    "text": "allow parameters in the shut message if we give a message in our investigation",
    "start": "1265679",
    "end": "1275400"
  },
  {
    "text": "that we can we find that we actually we cannot control the full paradise which is needed in your in our exploit so we",
    "start": "1275400",
    "end": "1284549"
  },
  {
    "text": "have to go further in this stage we patch the best unit to escape the payload length check and",
    "start": "1284549",
    "end": "1291830"
  },
  {
    "text": "force the force it to upwards singly on it you will see what's at that in the",
    "start": "1291830",
    "end": "1297950"
  },
  {
    "text": "next page so another work is to we have",
    "start": "1297950",
    "end": "1303320"
  },
  {
    "text": "to make the single layer on it works so we find the upgrade functionality of",
    "start": "1303320",
    "end": "1309680"
  },
  {
    "text": "this single unit the arc welding is occurs when the self-check fills which",
    "start": "1309680",
    "end": "1315110"
  },
  {
    "text": "means the less unit when the person is put it will check if the single unit",
    "start": "1315110",
    "end": "1320179"
  },
  {
    "text": "works well so if it's not it will trigger the single unit to operate itself - to try to fix it we found a",
    "start": "1320179",
    "end": "1329720"
  },
  {
    "text": "similar package in the file system and we recover the format by some reverse",
    "start": "1329720",
    "end": "1334880"
  },
  {
    "text": "and some gas so it's actually space reacts works at us and it's a PowerPC",
    "start": "1334880",
    "end": "1344290"
  },
  {
    "text": "architecture so actually a quite Laxus",
    "start": "1344290",
    "end": "1349580"
  },
  {
    "text": "town you know hectoring has a purpose they become higher Tyler so we have the we can get the be compiled code and we",
    "start": "1349580",
    "end": "1359000"
  },
  {
    "text": "find the single and the name toy box at the end of the file and you know it's a",
    "start": "1359000",
    "end": "1364520"
  },
  {
    "text": "very old machine so there's a tray there's the no signal check and it's only rather than to the jacks up so if",
    "start": "1364520",
    "end": "1372500"
  },
  {
    "text": "it can be either leap and bypass so finally we located some functions and",
    "start": "1372500",
    "end": "1379960"
  },
  {
    "text": "short message message in the firmware and we patch it just patch it to carry",
    "start": "1379960",
    "end": "1386510"
  },
  {
    "text": "arbitrary very data and then we packed Vermeer and trigger the self-test to",
    "start": "1386510",
    "end": "1394040"
  },
  {
    "text": "upgrade the single unit and the family we got the gun to shoot our boys to",
    "start": "1394040",
    "end": "1403880"
  },
  {
    "text": "crash base net so not can you talk about",
    "start": "1403880",
    "end": "1409100"
  },
  {
    "text": "did help the our payload look like",
    "start": "1409100",
    "end": "1414220"
  },
  {
    "text": "okay thanks Luce and next I will briefly talk about the exploitation that and as",
    "start": "1414340",
    "end": "1421370"
  },
  {
    "text": "you can hear I got coal recently so pardon me if I don't sound clearly okay",
    "start": "1421370",
    "end": "1428919"
  },
  {
    "text": "so firstly we do to me to doing exploitation we need to find a path to",
    "start": "1428980",
    "end": "1435080"
  },
  {
    "start": "1429000",
    "end": "1429000"
  },
  {
    "text": "reach the vulnerable function so the payload we should construct is basically",
    "start": "1435080",
    "end": "1440510"
  },
  {
    "text": "a malformed CDMA 1 x SMS transport layer message so there are many fields and",
    "start": "1440510",
    "end": "1446990"
  },
  {
    "text": "many structures in status message and we have to set them all correctly to reach",
    "start": "1446990",
    "end": "1452000"
  },
  {
    "text": "that one one function so the first field we need to step is this messenger type",
    "start": "1452000",
    "end": "1457580"
  },
  {
    "text": "message we have to state it to 0 0 0 and 2 indicating itself on self SMS p2p",
    "start": "1457580",
    "end": "1464750"
  },
  {
    "text": "message and next we the message actually",
    "start": "1464750",
    "end": "1470290"
  },
  {
    "text": "consists of several TLV format they call it as parameters in a specification so",
    "start": "1470290",
    "end": "1478070"
  },
  {
    "text": "this is a list of the parameters hope you can see it clearly and the two one as I said a red marked",
    "start": "1478070",
    "end": "1487790"
  },
  {
    "text": "and this is a two mandatory field we have to set this terror service identifier on the originating address a",
    "start": "1487790",
    "end": "1497620"
  },
  {
    "text": "next one you can see here this is a very data field so although this field is",
    "start": "1497650",
    "end": "1504740"
  },
  {
    "text": "optional but since this field is critical to our exploit and this field",
    "start": "1504740",
    "end": "1511070"
  },
  {
    "text": "actually means the upper layer payload of this message so actually it contains",
    "start": "1511070",
    "end": "1518270"
  },
  {
    "text": "the data of the upper layer protocol and this is where the volleyball very copy",
    "start": "1518270",
    "end": "1524690"
  },
  {
    "text": "happens so we have to again state attractively the data inside this very",
    "start": "1524690",
    "end": "1532490"
  },
  {
    "text": "data and similarly the bearer data also contains TLB format structures they call",
    "start": "1532490",
    "end": "1541760"
  },
  {
    "text": "it stop parameters so the parameters inside better data should",
    "start": "1541760",
    "end": "1548539"
  },
  {
    "text": "indicate itself pío message so the structure of a sub",
    "start": "1548539",
    "end": "1554149"
  },
  {
    "text": "parameter is basically like this open stuff with a ID the 8 here means 8 bits",
    "start": "1554149",
    "end": "1560779"
  },
  {
    "text": "so it is one part and it has a one part less and following with the rest of the",
    "start": "1560779",
    "end": "1566690"
  },
  {
    "text": "content so as to reach that vulnerable",
    "start": "1566690",
    "end": "1575269"
  },
  {
    "text": "memory copy relation so we have to set the stop parameters correctly inside the",
    "start": "1575269",
    "end": "1582470"
  },
  {
    "text": "bearer data so first one is we have to set this message display mode sub",
    "start": "1582470",
    "end": "1588919"
  },
  {
    "text": "parameter so the structure of the message of display mode looks like this it has many many fields itself and we",
    "start": "1588919",
    "end": "1597559"
  },
  {
    "text": "have to stay as a message discipline mode to directs the rows 3 which is 2 1",
    "start": "1597559",
    "end": "1603919"
  },
  {
    "text": "bits and we have to stand on the reserved field to the rocks 1 0 so as",
    "start": "1603919",
    "end": "1609350"
  },
  {
    "text": "you can see the P our message is actually a vendor specific feature so it",
    "start": "1609350",
    "end": "1616190"
  },
  {
    "text": "is not in the specification so after we've that or the field correct it looks",
    "start": "1616190",
    "end": "1623899"
  },
  {
    "text": "like we can just reach that final wonderful memory copy",
    "start": "1623899",
    "end": "1629919"
  },
  {
    "text": "so the basic function of that vulnerable code it actually sorts the stock",
    "start": "1629919",
    "end": "1636320"
  },
  {
    "text": "parameters inside the mirror data is sort the parameters by their a parameter",
    "start": "1636320",
    "end": "1642950"
  },
  {
    "text": "ID from small to big and that is where the overflow happens so it looks like",
    "start": "1642950",
    "end": "1650739"
  },
  {
    "text": "trivial to exploit since there are no index no AF there are in the basement",
    "start": "1650739",
    "end": "1656029"
  },
  {
    "text": "and those that cannery looks like a very classical stack overflow quite like like",
    "start": "1656029",
    "end": "1662539"
  },
  {
    "text": "in the 90s smashing a stack for fun and profit looks a very eerie task stop it",
    "start": "1662539",
    "end": "1668119"
  },
  {
    "text": "it qu and next so we are trying to do",
    "start": "1668119",
    "end": "1674090"
  },
  {
    "text": "this but we found there are many we need travels we encountered here so",
    "start": "1674090",
    "end": "1680470"
  },
  {
    "text": "first of all there are multiple code parties to reach that vulnerable function and two of them actually not",
    "start": "1680470",
    "end": "1688660"
  },
  {
    "text": "very useful since they are only reachable they are usually used in an mo",
    "start": "1688660",
    "end": "1694030"
  },
  {
    "text": "message situation mo message stands for mobile or originating messages at random",
    "start": "1694030",
    "end": "1700060"
  },
  {
    "text": "method actually stands from your mobile phone so you cannot reach this code pass",
    "start": "1700060",
    "end": "1705310"
  },
  {
    "text": "over there and actually we hung found one code path that I reachable through",
    "start": "1705310",
    "end": "1712480"
  },
  {
    "text": "an empty message mobile terminating message but yes and but we found that",
    "start": "1712480",
    "end": "1719680"
  },
  {
    "text": "the power you can overflow is not understand it is it actually inside the global variable section and yeah we try",
    "start": "1719680",
    "end": "1728530"
  },
  {
    "text": "to see what we can overflow what we can overwrite see if we can exploit but",
    "start": "1728530",
    "end": "1733860"
  },
  {
    "text": "sadly we failed and we cannot exploit this situation an active moment we just",
    "start": "1733860",
    "end": "1741210"
  },
  {
    "text": "got confused to state it is a stack overflow and yes indeed we do find a",
    "start": "1741210",
    "end": "1749560"
  },
  {
    "start": "1744000",
    "end": "1744000"
  },
  {
    "text": "code pass that you know with it has the buffer you have of wrote it on a step",
    "start": "1749560",
    "end": "1754870"
  },
  {
    "text": "but that code pass is only used when you the mobile station reads out an SMS from",
    "start": "1754870",
    "end": "1762250"
  },
  {
    "text": "a using card seems not very useful since an attacker you attacked over-the-air so",
    "start": "1762250",
    "end": "1768490"
  },
  {
    "text": "you cannot put inserts on malicious using cut and tribute to read your",
    "start": "1768490",
    "end": "1774030"
  },
  {
    "text": "malicious SMS so looks like we are out of options and we since the flow is at",
    "start": "1774030",
    "end": "1781150"
  },
  {
    "text": "the end but since we are determined hacker we are determined attacker",
    "start": "1781150",
    "end": "1786250"
  },
  {
    "text": "so there is all the one saying where there is a will there is a way so we",
    "start": "1786250",
    "end": "1792120"
  },
  {
    "text": "again we read all the source code and you know we try to understand the whole",
    "start": "1792120",
    "end": "1799540"
  },
  {
    "text": "process when your mobile home receiving an SMS and",
    "start": "1799540",
    "end": "1806350"
  },
  {
    "text": "finally we did discover a deep but very stable pass to trigger that Stack",
    "start": "1806350",
    "end": "1814250"
  },
  {
    "text": "Overflow it is following this this specific past it's this specific could",
    "start": "1814250",
    "end": "1822410"
  },
  {
    "text": "use this past look seem in a useless parts so what",
    "start": "1822410",
    "end": "1828530"
  },
  {
    "text": "does the the whole process of mobile for handling or PR message looks like so first of all it has to receive the",
    "start": "1828530",
    "end": "1835610"
  },
  {
    "text": "message over there right and then well try to decode your message and this is where the overflow could happens but",
    "start": "1835610",
    "end": "1843380"
  },
  {
    "text": "since as I mentioned the first all flow you can trigger this with the buffer and",
    "start": "1843380",
    "end": "1849140"
  },
  {
    "text": "not on the step it's not very useful and then it will try to encode your message",
    "start": "1849140",
    "end": "1856190"
  },
  {
    "text": "and write eight things into the using card and just immediately after it right",
    "start": "1856190",
    "end": "1861590"
  },
  {
    "text": "into into the SIM card it reads the message back out and decode it again and",
    "start": "1861590",
    "end": "1866870"
  },
  {
    "text": "the second time decoding is were the stack buffer overflow happens and it is",
    "start": "1866870",
    "end": "1872030"
  },
  {
    "text": "where we try to exploit it I saw it it's",
    "start": "1872030",
    "end": "1880130"
  },
  {
    "text": "not a very trivial task so our payload actually must survive the first encoding",
    "start": "1880130",
    "end": "1886550"
  },
  {
    "text": "and decoding cycle so you are not going to overflow the stack for the first time",
    "start": "1886550",
    "end": "1891890"
  },
  {
    "text": "you are going to overflow stack on the second time and your payload must survive is this cycle so this is not a",
    "start": "1891890",
    "end": "1899420"
  },
  {
    "text": "very trivial task so every time when you",
    "start": "1899420",
    "end": "1905090"
  },
  {
    "text": "want to solve a problem you will want to make it abstraction and make it a math",
    "start": "1905090",
    "end": "1910550"
  },
  {
    "text": "problem so we will do some simple abstraction a simple math here so first I will add in like the payload as X and",
    "start": "1910550",
    "end": "1919070"
  },
  {
    "text": "the decoding function has decode X and encoding function has encode X so our",
    "start": "1919070",
    "end": "1925190"
  },
  {
    "text": "final step over for option should be P so our goal is actually to find an X for",
    "start": "1925190",
    "end": "1932330"
  },
  {
    "text": "a given P such that P a post decoding encoding decoding sex right it's just right what",
    "start": "1932330",
    "end": "1939900"
  },
  {
    "text": "we want the 4x goes through the decoding and encoding and decoding again and it becomes our stack overflow R option so",
    "start": "1939900",
    "end": "1951930"
  },
  {
    "text": "as we are a hacker and we are trying to solve a mathematical problem so we will",
    "start": "1951930",
    "end": "1956940"
  },
  {
    "text": "always want to solve it in a more mathematical way in a more elegant way so we adjust our go to to another go",
    "start": "1956940",
    "end": "1967020"
  },
  {
    "text": "life like this so we are trying to find an X for a given shape such as PE post",
    "start": "1967020",
    "end": "1972210"
  },
  {
    "text": "decoding X and x equals encoding decoding X so we can find here the X is",
    "start": "1972210",
    "end": "1980640"
  },
  {
    "text": "actually the fixed point of the combination function encoding decoding X",
    "start": "1980640",
    "end": "1987710"
  },
  {
    "text": "so with this condition actually the P you can see the P you can't derive it P",
    "start": "1987710",
    "end": "1992910"
  },
  {
    "text": "from 2 to the end PE post decoding encoding tacones that's exactly what we want and the",
    "start": "1992910",
    "end": "2001550"
  },
  {
    "text": "furthermore actually this kind of payload that can go through not only one or two cycles of this encoding and",
    "start": "2001550",
    "end": "2009050"
  },
  {
    "text": "decoding it can go through arbitrary levels of encoding and decoding under survived all the time so this is",
    "start": "2009050",
    "end": "2015710"
  },
  {
    "text": "actually a very elegant stop and it is what we want and what's more at the CMU",
    "start": "2015710",
    "end": "2023030"
  },
  {
    "text": "200 machine actually we don't we don't know how to pass a bypass des restrict",
    "start": "2023030",
    "end": "2030530"
  },
  {
    "text": "it's actually restrict your length of the TP layer message to be less than 130",
    "start": "2030530",
    "end": "2036230"
  },
  {
    "text": "bytes and the buffer you want to overflow is 256 bytes long so you have",
    "start": "2036230",
    "end": "2044570"
  },
  {
    "text": "to make a 130 bite payload to overflow a 256 byte buffer so this is not a very",
    "start": "2044570",
    "end": "2051530"
  },
  {
    "text": "trivial task but it indeed is possible and yes we successfully made it and",
    "start": "2051530",
    "end": "2059888"
  },
  {
    "text": "since the details is very complicated so I will not talk it here but you can find",
    "start": "2059889",
    "end": "2066590"
  },
  {
    "text": "all the details in paper and I gave an example payload and",
    "start": "2066590",
    "end": "2071929"
  },
  {
    "text": "all the process when the decoding and encoding happens and you can see the",
    "start": "2071929",
    "end": "2077148"
  },
  {
    "text": "payload stays the same when going through the encoding and decoding cycle and thus were MOF I am a fifth year",
    "start": "2077149",
    "end": "2084710"
  },
  {
    "text": "player so I adapted to a CTF challenge of this year's DeRosa TFT CTF cost and",
    "start": "2084710",
    "end": "2092230"
  },
  {
    "text": "they meet mighty dragon and this name actually writes comes from an ACO name",
    "start": "2092230",
    "end": "2098599"
  },
  {
    "text": "of the mob demon we exploited so if you are interested you can try to see if you",
    "start": "2098599",
    "end": "2104539"
  },
  {
    "text": "can solve this challenge and the Turing the game only one team successfully solved it so it is a very challenging",
    "start": "2104539",
    "end": "2111890"
  },
  {
    "text": "task so that's all for my parts ok so at",
    "start": "2111890",
    "end": "2124099"
  },
  {
    "text": "this point we gain remote code execution on the base line but we are at a competition we need to provide a visual",
    "start": "2124099",
    "end": "2131180"
  },
  {
    "text": "confirmation to the judges but the problem is there is no display on the",
    "start": "2131180",
    "end": "2137509"
  },
  {
    "text": "beta and there is nothing and we cannot just pop calculator like on windows because there is no UI so we decided",
    "start": "2137509",
    "end": "2145549"
  },
  {
    "text": "from the bateman to change the phone IMEI which is like phone identifier and",
    "start": "2145549",
    "end": "2152890"
  },
  {
    "text": "this identifier can be checked from the settings of the phone so after our",
    "start": "2152890",
    "end": "2158019"
  },
  {
    "text": "exploitation attempt the judge can just go to settings and see if we",
    "start": "2158019",
    "end": "2164180"
  },
  {
    "text": "successfully change the IMEI to 1 3 3 7 1 2 3 7 so with our C is already quite a",
    "start": "2164180",
    "end": "2174289"
  },
  {
    "text": "good capability for an attacker because it's running code inside the base band and from the basement you can gain",
    "start": "2174289",
    "end": "2182329"
  },
  {
    "text": "control you can intercept and modify SMS calls and mobile Internet traffic so we",
    "start": "2182329",
    "end": "2191930"
  },
  {
    "text": "will do a demo now",
    "start": "2191930",
    "end": "2195548"
  },
  {
    "text": "oops so here you can see the machine",
    "start": "2203529",
    "end": "2214369"
  },
  {
    "text": "that we described to you and the Faraday cage here we show you the original IMEI",
    "start": "2214369",
    "end": "2219890"
  },
  {
    "text": "which is eight six one nine now we will use the machine to trigger the exploit",
    "start": "2219890",
    "end": "2227318"
  },
  {
    "text": "[Music] and then now we will check if the if the",
    "start": "2229580",
    "end": "2235819"
  },
  {
    "text": "IMEI is one two three seven one three three seven and you can see the IMEI is",
    "start": "2235819",
    "end": "2246619"
  },
  {
    "text": "one two three seven so we will ponder the basement [Music]",
    "start": "2246619",
    "end": "2253389"
  },
  {
    "text": "[Applause] [Music]",
    "start": "2255110",
    "end": "2258429"
  },
  {
    "text": "okay so the vendor response was very quick and while we quickly patched the",
    "start": "2265740",
    "end": "2271690"
  },
  {
    "start": "2266000",
    "end": "2266000"
  },
  {
    "text": "issue releasing an update and we had a good communication with the Security",
    "start": "2271690",
    "end": "2277990"
  },
  {
    "text": "Response Team and we even follow up after a pontoon and they are they",
    "start": "2277990",
    "end": "2284140"
  },
  {
    "text": "we had a very responsive feedback and they seems to care a lot about the security of their base them so mmm we",
    "start": "2284140",
    "end": "2293530"
  },
  {
    "text": "talked about remote code execution on the base line but what can you do after",
    "start": "2293530",
    "end": "2298540"
  },
  {
    "text": "this to get more capabilities well I like to think it's similar to browser",
    "start": "2298540",
    "end": "2304920"
  },
  {
    "text": "exploitation in the browser context you get first a browser bug and you get",
    "start": "2304920",
    "end": "2309970"
  },
  {
    "text": "remote code execution then you chain a sandbox escape and you get like machine",
    "start": "2309970",
    "end": "2315640"
  },
  {
    "text": "compromising here it's the same the first bug might be a baseband remote",
    "start": "2315640",
    "end": "2321070"
  },
  {
    "text": "code execution and then you can launch another bug to escape the basement it's",
    "start": "2321070",
    "end": "2326230"
  },
  {
    "text": "not a very well studied topic but there are some material known on similar",
    "start": "2326230",
    "end": "2332350"
  },
  {
    "text": "scenarios we didn't have to provide this kind of proof to the competition because",
    "start": "2332350",
    "end": "2339760"
  },
  {
    "text": "it was not a required by the rule but you I recommend you to check out the",
    "start": "2339760",
    "end": "2344830"
  },
  {
    "text": "Galvan a meaning of project zero research where from the Wi-Fi chip he used DMA to override memory on the",
    "start": "2344830",
    "end": "2353350"
  },
  {
    "text": "application processor and the comm securest blog post where they use a potato itself in the MDK reachable from",
    "start": "2353350",
    "end": "2360970"
  },
  {
    "text": "the empty K basement in order to modify files on the application processor and",
    "start": "2360970",
    "end": "2366609"
  },
  {
    "text": "escape the basement and after this you can potentially get complete control of",
    "start": "2366609",
    "end": "2372640"
  },
  {
    "text": "the target device and the attack surface in this area is significant and there is",
    "start": "2372640",
    "end": "2379810"
  },
  {
    "text": "no public research so now we will conclude the talk just to summarize we",
    "start": "2379810",
    "end": "2388540"
  },
  {
    "text": "show it we show to you that baseband remote code execution not only it's possible but also practical if you are",
    "start": "2388540",
    "end": "2395380"
  },
  {
    "text": "determind attacker second point based on their very complex and they have a huge",
    "start": "2395380",
    "end": "2401080"
  },
  {
    "text": "remote attack surface Third Point they are written in a memory unsafe language",
    "start": "2401080",
    "end": "2406450"
  },
  {
    "text": "C and C++ and they lack of even basic mitigations so it should not surprise",
    "start": "2406450",
    "end": "2412690"
  },
  {
    "text": "you if someone came back can get a remote code execution on wave them given those two facts and we hope in the",
    "start": "2412690",
    "end": "2420430"
  },
  {
    "text": "future to see more mitigation on the basement and maybe in the long term to see that the basement are written in",
    "start": "2420430",
    "end": "2427750"
  },
  {
    "text": "some memory safe language and but this cannot happen in short a time frame so",
    "start": "2427750",
    "end": "2433840"
  },
  {
    "text": "maybe in the meanwhile more people should audit a basement and we would",
    "start": "2433840",
    "end": "2440860"
  },
  {
    "text": "like to talk at knowledge the following of our colleagues and thank you everyone",
    "start": "2440860",
    "end": "2447490"
  },
  {
    "text": "for attending our talk",
    "start": "2447490",
    "end": "2450810"
  },
  {
    "text": "[Applause]",
    "start": "2452640",
    "end": "2457339"
  }
]