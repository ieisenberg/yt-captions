[
  {
    "text": "hi everyone thank you for coming to my talk so I'm Mario Polina I recently got my",
    "start": "299",
    "end": "8760"
  },
  {
    "text": "PhD from Politecnico di Milano working mostly on malware analysis so I'm gonna",
    "start": "8760",
    "end": "14519"
  },
  {
    "text": "talk you about the Huntington and the instrumentation and ever super marker",
    "start": "14519",
    "end": "20189"
  },
  {
    "text": "okay so this is the agenda for my talk the talk is about Iran China a framework",
    "start": "20189",
    "end": "27930"
  },
  {
    "text": "that we developed them to to contrast",
    "start": "27930",
    "end": "33149"
  },
  {
    "text": "the episode of agua so before actually explain you how we did it I will give",
    "start": "33149",
    "end": "39750"
  },
  {
    "text": "you a brief introduction on dynamic man instrumentation and then I explain you",
    "start": "39750",
    "end": "47370"
  },
  {
    "text": "how to create some evasion or detection for this kind of analysis then I gonna",
    "start": "47370",
    "end": "55770"
  },
  {
    "text": "talk about an experiment we did a measurement about how much ever Sigma",
    "start": "55770",
    "end": "61170"
  },
  {
    "text": "we're actually using those kind of technique and briefly show you we talked",
    "start": "61170",
    "end": "66360"
  },
  {
    "text": "about an unpacking tool that we implemented on top of our receiver until",
    "start": "66360",
    "end": "71580"
  },
  {
    "text": "ant ant ant instrumentation system and at the end I'll give you a really quick",
    "start": "71580",
    "end": "77790"
  },
  {
    "text": "demo on on our tools so that you may may want to use it okay so let's talk about",
    "start": "77790",
    "end": "84530"
  },
  {
    "text": "1900 our engine so this is actually an ion channel okay so it's a nutrient",
    "start": "84530",
    "end": "91250"
  },
  {
    "text": "delicious food it's a bowl of rice deep fried with inside meat and piece okay so",
    "start": "91250",
    "end": "98159"
  },
  {
    "text": "you may wonder why why we have a ranch I know so me and Ray are used to eat a lot",
    "start": "98159",
    "end": "104820"
  },
  {
    "text": "of different you know during the night the banking stuff so at some point we decided we had to name something that",
    "start": "104820",
    "end": "110399"
  },
  {
    "text": "after orangey and we named this tool after after this one so if you go to",
    "start": "110399",
    "end": "116850"
  },
  {
    "text": "Italy you should really try that then of course I'm not gonna talk on how to make",
    "start": "116850",
    "end": "122700"
  },
  {
    "text": "this energy no I mean me call my mother to about talk on that but I cannot make that so this is Dr Ng no I'm actually",
    "start": "122700",
    "end": "130590"
  },
  {
    "text": "going to talk you about okay so it's a framework he has many modules and and we can combine",
    "start": "130590",
    "end": "138459"
  },
  {
    "text": "them to have some to defeat aversive my words so I don't want to start explain",
    "start": "138459",
    "end": "145780"
  },
  {
    "text": "you the old framework and then show you the are we use it what I gonna do is I'm",
    "start": "145780",
    "end": "152799"
  },
  {
    "text": "gonna show you each technique on most of the evasive technique that we found and",
    "start": "152799",
    "end": "158579"
  },
  {
    "text": "I gonna explain you the the right model that we used to defeat that technique",
    "start": "158579",
    "end": "164409"
  },
  {
    "text": "okay that's that's the plan I'll show you the aversive technique and then I show the module that can trust",
    "start": "164409",
    "end": "170920"
  },
  {
    "text": "that technique so before actually starting talking",
    "start": "170920",
    "end": "176730"
  },
  {
    "text": "doing the this this journey about the and experimentation a brief introduction",
    "start": "176730",
    "end": "182109"
  },
  {
    "text": "of my granite is that is what they do so malware analysis is the way that we use to actually understand what what our",
    "start": "182109",
    "end": "189430"
  },
  {
    "text": "software is doing know we may discovers if something is malicious or not looking",
    "start": "189430",
    "end": "195579"
  },
  {
    "text": "at the others behavior and historically let's say historically we have two kind of big technically studied malware",
    "start": "195579",
    "end": "202870"
  },
  {
    "text": "analysis and dynamic malware analysis so the static the static analysis is usually the stuff about reversing the",
    "start": "202870",
    "end": "209949"
  },
  {
    "text": "code building the control flow graph and and so forth so on okay and that's not",
    "start": "209949",
    "end": "215470"
  },
  {
    "text": "the part I'm gonna talk about so this the static analysis a big limitation",
    "start": "215470",
    "end": "220930"
  },
  {
    "text": "that is I can obfuscate the code and then it's it's harder to be able to",
    "start": "220930",
    "end": "227650"
  },
  {
    "text": "skate and and look at the stuff so people came out with what we call dynamic malware analysis that is",
    "start": "227650",
    "end": "232989"
  },
  {
    "text": "actually looking and interaction between the software and the operand the underlying operating system so I can",
    "start": "232989",
    "end": "238269"
  },
  {
    "text": "trace down system call files I can look at the memory all this kind of stuff and",
    "start": "238269",
    "end": "244720"
  },
  {
    "text": "this make much easier to to actually perform this kind of analysis so the",
    "start": "244720",
    "end": "252040"
  },
  {
    "text": "problem with the the prominence a with the dynamic analysis to act well this control on on what what is happening",
    "start": "252040",
    "end": "258579"
  },
  {
    "text": "usually people do what is called instrumentation of something I can instrument a virtual machine",
    "start": "258579",
    "end": "264130"
  },
  {
    "text": "I can instrument an emulator or I can instrument a banner but because there is",
    "start": "264130",
    "end": "269890"
  },
  {
    "text": "this kind of instrumentation we can write code like that okay I can check if for small",
    "start": "269890",
    "end": "280780"
  },
  {
    "text": "differences between what I expect from a bare-metal execution and from an",
    "start": "280780",
    "end": "288190"
  },
  {
    "text": "execution that is actually made inside an instrumented environment so if I found those little differences then I",
    "start": "288190",
    "end": "295360"
  },
  {
    "text": "can write this can for this kind of code if I am under analysis just I don't know I don't do anything okay otherwise I can",
    "start": "295360",
    "end": "302140"
  },
  {
    "text": "be malicious and this of course defeat the purpose of the purpose of dynamic analysis okay so those small differences",
    "start": "302140",
    "end": "309910"
  },
  {
    "text": "are what we gonna call activate okay there are some activity introduced it on",
    "start": "309910",
    "end": "315160"
  },
  {
    "text": "the system because you did some instrumentation you are not using bare metal machines okay cool so let's talk",
    "start": "315160",
    "end": "325060"
  },
  {
    "text": "about dynamic value instrumentation so the dynamic binding cementation is one",
    "start": "325060",
    "end": "330640"
  },
  {
    "text": "kind of instrumentation that you may perform in order to perform malware",
    "start": "330640",
    "end": "336550"
  },
  {
    "text": "analysis and the idea behind dynamic binding cementation is that you don't need a voice for machine or an emulator",
    "start": "336550",
    "end": "344200"
  },
  {
    "text": "okay what you do is actually adding some code inside the executable so you you",
    "start": "344200",
    "end": "351970"
  },
  {
    "text": "are the executable you had something inside that is actually logging and perform they deny that you using the",
    "start": "351970",
    "end": "358960"
  },
  {
    "text": "tools that they are called dbi so to understand how a dbi works we need we",
    "start": "358960",
    "end": "369340"
  },
  {
    "text": "actually need a bit of introduction on on how the the binary is may know so you",
    "start": "369340",
    "end": "378010"
  },
  {
    "text": "have basic blocks that are basically instruction that are executed always together and they are connected by jumps",
    "start": "378010",
    "end": "384970"
  },
  {
    "text": "and they build a big control flow graph and then if you take a set of basic",
    "start": "384970",
    "end": "391990"
  },
  {
    "text": "block that are connecting two together you will get what is called a trace okay Tracy",
    "start": "391990",
    "end": "397900"
  },
  {
    "text": "multiple basic block that usually are close enough to be executed almost",
    "start": "397900",
    "end": "403750"
  },
  {
    "text": "together and most DB I told actually used to mint a trace at a time so they",
    "start": "403750",
    "end": "410710"
  },
  {
    "text": "load a chess instrument the test and then they load another chess instrument",
    "start": "410710",
    "end": "415900"
  },
  {
    "text": "the other one so how'd they do that they took a trace they copied in some",
    "start": "415900",
    "end": "422710"
  },
  {
    "text": "other part of the memory that is called the code cache and then they use what is",
    "start": "422710",
    "end": "428110"
  },
  {
    "text": "called a magic compiler just-in-time compiler okay so it's something that as",
    "start": "428110",
    "end": "433180"
  },
  {
    "text": "an input the origin of code and something that you want hard okay it's actually recompiling your binary code",
    "start": "433180",
    "end": "441160"
  },
  {
    "text": "adding this stuff inside okay and you can the great thing about dynamic burn",
    "start": "441160",
    "end": "447729"
  },
  {
    "text": "instrumentation is that you have a really fine direct control on what you are doing okay you can insert the",
    "start": "447729",
    "end": "454300"
  },
  {
    "text": "instruction between certain specific instruction between blessing box between",
    "start": "454300",
    "end": "459430"
  },
  {
    "text": "chess you can search for read instruction for Cisco structure for",
    "start": "459430",
    "end": "466419"
  },
  {
    "text": "interrupt for you have a really fine grid control and this is the great advantage of using vbi instead of using",
    "start": "466419",
    "end": "473110"
  },
  {
    "text": "a virtual machine or or remember it okay so I so those are the four vbi tools",
    "start": "473110",
    "end": "481570"
  },
  {
    "text": "that I know okay some of them like bargaining then revenge",
    "start": "481570",
    "end": "487419"
  },
  {
    "text": "they actually works only on Linux as far as I know and the one we actually use is",
    "start": "487419",
    "end": "494199"
  },
  {
    "text": "intern pin that is actually the most used and it's also the one that is actually better documented usually so",
    "start": "494199",
    "end": "500680"
  },
  {
    "text": "all go all the talk is based on opinion okay so let's talk about a massive",
    "start": "500680",
    "end": "508479"
  },
  {
    "text": "malware then so in deactivate we actually divided all",
    "start": "508479",
    "end": "516339"
  },
  {
    "text": "the article that we found by by their",
    "start": "516339",
    "end": "522820"
  },
  {
    "text": "check okay so we come up with basically four categories that are those one so we have cocci artifact need compare",
    "start": "522820",
    "end": "529089"
  },
  {
    "text": "detection and vial artherton Oberon detection and I go I gonna go to all of them so let's start",
    "start": "529089",
    "end": "535480"
  },
  {
    "text": "with code cache active okay so what are",
    "start": "535480",
    "end": "540700"
  },
  {
    "text": "the code cache shockula's the basic are all the artifact that exists because you",
    "start": "540700",
    "end": "548079"
  },
  {
    "text": "are using the cultish okay the code cache is the one I just explained you is the part of memory that the dynamic",
    "start": "548079",
    "end": "555250"
  },
  {
    "text": "binding simulation tool is using to create the the instrumented binary and",
    "start": "555250",
    "end": "562510"
  },
  {
    "text": "we can basically to kind of code cache",
    "start": "562510",
    "end": "568180"
  },
  {
    "text": "detect detection is the first one is instruction pointer detection okay the",
    "start": "568180",
    "end": "575019"
  },
  {
    "text": "fact that you are actually executing something inside the code cache and not something inside the original text",
    "start": "575019",
    "end": "581470"
  },
  {
    "text": "session section it means that your restriction point is different and you may let this so I'll you can detect this",
    "start": "581470",
    "end": "589990"
  },
  {
    "text": "we basically have two ways that are actually working the first one is is the",
    "start": "589990",
    "end": "598180"
  },
  {
    "text": "one of using the interrupt to e okay that is the instruction that was",
    "start": "598180",
    "end": "604029"
  },
  {
    "text": "historically used for doing be anti cisco when you call the interrupt to e",
    "start": "604029",
    "end": "609990"
  },
  {
    "text": "you have as a side effect that is the current instruction pointer is copying",
    "start": "609990",
    "end": "616120"
  },
  {
    "text": "in the in the index register and this is one one time the other one is using some",
    "start": "616120",
    "end": "623140"
  },
  {
    "text": "instructions that are actually related to floating-point context if used one of",
    "start": "623140",
    "end": "628269"
  },
  {
    "text": "those instruction they are basically storing in on top of the stack",
    "start": "628269",
    "end": "633360"
  },
  {
    "text": "information about the context that actually contains also the instruction port okay so if you call in to it you",
    "start": "633360",
    "end": "642310"
  },
  {
    "text": "get the edx with the instruction pointer if you if",
    "start": "642310",
    "end": "647470"
  },
  {
    "text": "you call f safe on this instruction here you have the instruction pointer set on",
    "start": "647470",
    "end": "654010"
  },
  {
    "text": "on the stack some of you may may wonder i can do other tricks like I can call",
    "start": "654010",
    "end": "661000"
  },
  {
    "text": "five instruction head so I am so that I have on the stack the",
    "start": "661000",
    "end": "667530"
  },
  {
    "text": "destruction point that if you if you if you know all the cold works is pushing on the stack D in such a man but this",
    "start": "667530",
    "end": "673630"
  },
  {
    "text": "using the goal is actually already entered by pin out and and so pin is",
    "start": "673630",
    "end": "679510"
  },
  {
    "text": "already because of pin because of our pin works you basically will not end up",
    "start": "679510",
    "end": "686410"
  },
  {
    "text": "with the code cache in structure inside the stack but we do the beauty channel okay so the only tool I am aware of are",
    "start": "686410",
    "end": "693840"
  },
  {
    "text": "those that was does this way to actually identify the instruction point so what",
    "start": "693840",
    "end": "704470"
  },
  {
    "text": "we did what we did we did this before but we have a module that is called the pattern matching module okay that we're",
    "start": "704470",
    "end": "710980"
  },
  {
    "text": "gonna use to defeat this technique of instrumentation detection so the pattern",
    "start": "710980",
    "end": "718990"
  },
  {
    "text": "matching module is basically two components the first one is what we call the patch map is basically a list of",
    "start": "718990",
    "end": "726420"
  },
  {
    "text": "instruction that we know can be used for detection and then function pointer that",
    "start": "726420",
    "end": "733750"
  },
  {
    "text": "are basically function that gonna patch the result of the of our instruction and",
    "start": "733750",
    "end": "739900"
  },
  {
    "text": "the patch dispatcher is basically the module that is actually during the beta",
    "start": "739900",
    "end": "745270"
  },
  {
    "text": "build of the Tres is actually going to search for the instruction okay to to",
    "start": "745270",
    "end": "751510"
  },
  {
    "text": "patch okay so I give you an example an example here on the on you're right",
    "start": "751510",
    "end": "757420"
  },
  {
    "text": "actually so you have the trace the original trace okay in the middle we have the patch",
    "start": "757420",
    "end": "763270"
  },
  {
    "text": "dispatcher and on the left is the Patchett trace and the idea of the patch is pasture is that you are loading each",
    "start": "763270",
    "end": "769960"
  },
  {
    "text": "time one instruction you are checking inside your list if is a blacklisted",
    "start": "769960",
    "end": "775630"
  },
  {
    "text": "instruction it's not you're gonna save it as it is if you have one of those",
    "start": "775630",
    "end": "781120"
  },
  {
    "text": "instruction what you do you just add okay the patch function for for this",
    "start": "781120",
    "end": "787630"
  },
  {
    "text": "specific instruction so all the patch is working so here I'll",
    "start": "787630",
    "end": "796320"
  },
  {
    "text": "show you the we know that into is basically storing inside the register it",
    "start": "796320",
    "end": "802140"
  },
  {
    "text": "eats the bronc instruction pointer so the patch is easier so you may think I",
    "start": "802140",
    "end": "807450"
  },
  {
    "text": "just change ok the value inside the register ok and that's all you need to",
    "start": "807450",
    "end": "813840"
  },
  {
    "text": "actually page this for the floating point for the floating point instruction",
    "start": "813840",
    "end": "820920"
  },
  {
    "text": "you need to patch the memory inside the stack but the principal is basically the same ok cool so that's the first example",
    "start": "820920",
    "end": "828630"
  },
  {
    "text": "show and then we have another one that is even more interesting",
    "start": "828630",
    "end": "833820"
  },
  {
    "text": "that is the self-modifying code so the",
    "start": "833820",
    "end": "839930"
  },
  {
    "text": "idea of self-modifying code is the code that is changing itself during the execution so I'll give you this example",
    "start": "839930",
    "end": "847680"
  },
  {
    "text": "I have a set of instruction that you can see here and one of them the third one is what I wrote a strong construction ok",
    "start": "847680",
    "end": "856260"
  },
  {
    "text": "it may actually be literally something that cannot be disassembled so it's",
    "start": "856260",
    "end": "861450"
  },
  {
    "text": "wrong instruction or they may be something like some privileged",
    "start": "861450",
    "end": "867420"
  },
  {
    "text": "instruction like in out something that you need to be in a drink zero to execute ok no you cannot executing in",
    "start": "867420",
    "end": "874680"
  },
  {
    "text": "user mode or it can be some access on on memory that you know it's not allocated",
    "start": "874680",
    "end": "880020"
  },
  {
    "text": "so the idea is something that is crashing the program so what happened",
    "start": "880020",
    "end": "886020"
  },
  {
    "text": "with self-modifying code is you have collided you like this you collect the",
    "start": "886020",
    "end": "891480"
  },
  {
    "text": "chess and put it inside the cob dish and then you start executing and the first distraction is actually changing the",
    "start": "891480",
    "end": "898170"
  },
  {
    "text": "third one to an extraction that can be executed ok so you keep executing and when you",
    "start": "898170",
    "end": "905400"
  },
  {
    "text": "reach destruction tree the page happened only on the original text so you",
    "start": "905400",
    "end": "912000"
  },
  {
    "text": "executing the code cache you get a crash ok you die you identify that there is something wrong so we want to flip that",
    "start": "912000",
    "end": "920339"
  },
  {
    "text": "so we write a specific module for self-modifying code and he has basically two functions one",
    "start": "920339",
    "end": "929220"
  },
  {
    "text": "that is called mathlete written address that we put before each instruction that",
    "start": "929220",
    "end": "935910"
  },
  {
    "text": "actually writes something inside the memory okay and the other one that is check IP written is basically put it",
    "start": "935910",
    "end": "943920"
  },
  {
    "text": "before each instruction so what we add is something like that so I Section 1 is",
    "start": "943920",
    "end": "949440"
  },
  {
    "text": "actually writing something in the memory so we have both the the function the other are not writing anything so we",
    "start": "949440",
    "end": "956040"
  },
  {
    "text": "have only the check and then it's easy when when we exit before actually",
    "start": "956040",
    "end": "961470"
  },
  {
    "text": "securing the first subtraction we check which part of memories Donna is gonna",
    "start": "961470",
    "end": "966750"
  },
  {
    "text": "bright and we store it in a list okay then the B patch happen at every time",
    "start": "966750",
    "end": "973589"
  },
  {
    "text": "that before actually executing interest action we're gonna check the the list to",
    "start": "973589",
    "end": "979410"
  },
  {
    "text": "see if the instruction we are about to execute is an extraction that is has",
    "start": "979410",
    "end": "984899"
  },
  {
    "text": "been modified or not ok so the instruction to have not been modified so",
    "start": "984899",
    "end": "991290"
  },
  {
    "text": "we can go on when we reach destruction 3 we know destruction 3 has been modified",
    "start": "991290",
    "end": "997399"
  },
  {
    "text": "so we just trigger a invalidation of dictation ok we actually trigger what is",
    "start": "997399",
    "end": "1004850"
  },
  {
    "text": "called a trace recollection so basically the case is invalidated",
    "start": "1004850",
    "end": "1010940"
  },
  {
    "text": "so we recollect the chase from that point on and now the new trace actually",
    "start": "1010940",
    "end": "1017000"
  },
  {
    "text": "contain the instruction page so we can keep executing because we have the new",
    "start": "1017000",
    "end": "1023029"
  },
  {
    "text": "instruction ok so that's the idea it's kind of heavy as you may think",
    "start": "1023029",
    "end": "1028790"
  },
  {
    "text": "because we are basically adding something or each instruction but this work okay so that's for the first part",
    "start": "1028790",
    "end": "1041260"
  },
  {
    "text": "so now I want to talk about environment",
    "start": "1041260",
    "end": "1047899"
  },
  {
    "text": "Hartford so you may see environment hotspots as the same miscellany of of",
    "start": "1047899",
    "end": "1055610"
  },
  {
    "text": "the octopods okay are actually those artifact that I'm not specific about the",
    "start": "1055610",
    "end": "1061279"
  },
  {
    "text": "JIT compiler or the code cache or the other end detection okay we have some",
    "start": "1061279",
    "end": "1068779"
  },
  {
    "text": "that is trillion some of it is less cheetah so the first one the trivial one is pollen detection so we can basically",
    "start": "1068779",
    "end": "1077179"
  },
  {
    "text": "check the list of process and see okay the the may further process spin so I'm",
    "start": "1077179",
    "end": "1085850"
  },
  {
    "text": "and extra mentation okay it's easy as as in this there is two way you can check",
    "start": "1085850",
    "end": "1091070"
  },
  {
    "text": "your father there is one using Windows system called",
    "start": "1091070",
    "end": "1097070"
  },
  {
    "text": "so the Aquarian system information and the other one is looking inside the CSI",
    "start": "1097070",
    "end": "1103220"
  },
  {
    "text": "RSS process that is actually a useful and process that that keeps an entire",
    "start": "1103220",
    "end": "1108830"
  },
  {
    "text": "list of process inside its memory so you can you can read it from from his memory",
    "start": "1108830",
    "end": "1115299"
  },
  {
    "text": "so we can easily defeat this with you key modules okay you looking is",
    "start": "1115299",
    "end": "1121309"
  },
  {
    "text": "something that is well known so in the communities the idea is are I intercept",
    "start": "1121309",
    "end": "1127789"
  },
  {
    "text": "some function looking some function we implemented in our framework to way to",
    "start": "1127789",
    "end": "1135860"
  },
  {
    "text": "hooking modules one that is the function module and the other one that is looking",
    "start": "1135860",
    "end": "1141919"
  },
  {
    "text": "at the Cisco so the second one is is working searching for the instruction",
    "start": "1141919",
    "end": "1147250"
  },
  {
    "text": "for the Cisco instruction the one that has actually triggering the Cisco adding",
    "start": "1147250",
    "end": "1152590"
  },
  {
    "text": "something after and and the first one is actually different because it's it's on",
    "start": "1152590",
    "end": "1159970"
  },
  {
    "text": "it's on yellow so the idea about the new module is that",
    "start": "1159970",
    "end": "1165799"
  },
  {
    "text": "when you are loading a new DLL inside the memory are you check on with with a",
    "start": "1165799",
    "end": "1172549"
  },
  {
    "text": "dispatcher if if some of the phone inside this dll is on your list so if",
    "start": "1172549",
    "end": "1179500"
  },
  {
    "text": "it's on your list what you do is actually putting a jump at the beginning",
    "start": "1179500",
    "end": "1185289"
  },
  {
    "text": "of the function is the classical hook you put a jump at the beginning of the function and the jump is jumping inside",
    "start": "1185289",
    "end": "1191260"
  },
  {
    "text": "your function define the place doing whatever you want a jumping back okay",
    "start": "1191260",
    "end": "1198070"
  },
  {
    "text": "that's a pretty standard way of looking functions and what we can do is",
    "start": "1198070",
    "end": "1203620"
  },
  {
    "text": "basically hooking the antiquary system information and changing the value",
    "start": "1203620",
    "end": "1211120"
  },
  {
    "text": "returned by the function so if there is pin it's a blacklist if there is pin the tax inside a change it with common dot",
    "start": "1211120",
    "end": "1217149"
  },
  {
    "text": "exact okay just a blacklist and to deny access to the memory further process we",
    "start": "1217149",
    "end": "1226289"
  },
  {
    "text": "we hook the empty open process okay so that basically when when you try to open",
    "start": "1226289",
    "end": "1234730"
  },
  {
    "text": "opening the memory of the process you cannot of course Daniel is where you may",
    "start": "1234730",
    "end": "1241299"
  },
  {
    "text": "may think oh but if I don't if I don't I cannot have access to this process it's",
    "start": "1241299",
    "end": "1249820"
  },
  {
    "text": "a way to detect the system and this is true but you may use other model to actually I'll show you later to actually",
    "start": "1249820",
    "end": "1256480"
  },
  {
    "text": "affect the read of memory okay but if you implement in this way and then yes",
    "start": "1256480",
    "end": "1261909"
  },
  {
    "text": "you there's another activity basically to display this cool so and this is the",
    "start": "1261909",
    "end": "1271210"
  },
  {
    "text": "parent detection that is pretty pretty easy so the second environment artifact that",
    "start": "1271210",
    "end": "1278169"
  },
  {
    "text": "I want to show you is what we call memory fingerprint so the idea of memory",
    "start": "1278169",
    "end": "1286029"
  },
  {
    "text": "fingerprinting is you can start looking inside the memory for forced strings for",
    "start": "1286029",
    "end": "1296350"
  },
  {
    "text": "binary sequence for whatever is actually",
    "start": "1296350",
    "end": "1301980"
  },
  {
    "text": "something that you know it's it's from ping you know there's the pintle DLL",
    "start": "1301980",
    "end": "1307840"
  },
  {
    "text": "inside the memory so if I start searching in the memory at some point I'm gonna find the dependence I see if I find it",
    "start": "1307840",
    "end": "1315220"
  },
  {
    "text": "okay I know it I'm under instrumentation so the problem of searching the memory",
    "start": "1315220",
    "end": "1321460"
  },
  {
    "text": "like I shown you going back and forth is that you cannot",
    "start": "1321460",
    "end": "1328060"
  },
  {
    "text": "jumping around around with any address inside the memory because if you end up",
    "start": "1328060",
    "end": "1334080"
  },
  {
    "text": "in a place like this that is basically some memory that is not allocated you",
    "start": "1334080",
    "end": "1342250"
  },
  {
    "text": "basically get a crash No so you cannot go through the memory like okay start from zero and then I try",
    "start": "1342250",
    "end": "1348940"
  },
  {
    "text": "a very address and so to search to the memory you usually use some some call so",
    "start": "1348940",
    "end": "1359200"
  },
  {
    "text": "some system call asking the operating system about the memory layout now the",
    "start": "1359200",
    "end": "1365290"
  },
  {
    "text": "idea is oh I use the virtual query and then I ask to the operating system this",
    "start": "1365290",
    "end": "1370300"
  },
  {
    "text": "memory is allocated or not and then the operating system is Daniel yeah I so locator or not in this way you know",
    "start": "1370300",
    "end": "1376540"
  },
  {
    "text": "which is the memory layout and you just search inside not that memory that you",
    "start": "1376540",
    "end": "1383140"
  },
  {
    "text": "know is allocated so you may guess the way we used to treat this we basically",
    "start": "1383140",
    "end": "1390390"
  },
  {
    "text": "hook the diverter query and we created a whitelist of accessible memory so that",
    "start": "1390390",
    "end": "1398430"
  },
  {
    "text": "every time you try to query the system it tells you that the free memory is",
    "start": "1398430",
    "end": "1404290"
  },
  {
    "text": "only the one that you want to show and the memo released is actually updated at",
    "start": "1404290",
    "end": "1412180"
  },
  {
    "text": "runtime okay so inside the list we have the main",
    "start": "1412180",
    "end": "1417460"
  },
  {
    "text": "module of course the text module and then a library and there is another hook inside the load library such that if you",
    "start": "1417460",
    "end": "1425140"
  },
  {
    "text": "actually loading a new library we know it if you're loading later so we can add",
    "start": "1425140",
    "end": "1430300"
  },
  {
    "text": "to to the to do it to the a whitelist and of course you have the heap the",
    "start": "1430300",
    "end": "1436540"
  },
  {
    "text": "stack and then you have some of the windows table and the Muppet file okay when you are",
    "start": "1436540",
    "end": "1444620"
  },
  {
    "text": "mapping something okay so that's the",
    "start": "1444620",
    "end": "1450770"
  },
  {
    "text": "second step we are halfway there okay so stay with me another another 20",
    "start": "1450770",
    "end": "1459200"
  },
  {
    "text": "minutes so big compiler detection okay we are using read compilers and actually",
    "start": "1459200",
    "end": "1469789"
  },
  {
    "text": "it's not DT Street good compiler so I can detect big I can detect that I'm",
    "start": "1469789",
    "end": "1476450"
  },
  {
    "text": "using this stuff compiling inside the memory no so what one of the way to to",
    "start": "1476450",
    "end": "1483590"
  },
  {
    "text": "detect I do comparison looking at the edit permission of the pages because because you are bragging",
    "start": "1483590",
    "end": "1493340"
  },
  {
    "text": "the code that you want to execute your pages will have writing and executable",
    "start": "1493340",
    "end": "1499460"
  },
  {
    "text": "permission so you can just list the the",
    "start": "1499460",
    "end": "1505669"
  },
  {
    "text": "pages and see oh okay I have a lot of writing and executable so I didn't use any on my mother so I know this there is",
    "start": "1505669",
    "end": "1514730"
  },
  {
    "text": "something odd and so this is the problem",
    "start": "1514730",
    "end": "1521090"
  },
  {
    "text": "with the memory pages and another thing that you can do is you can detect that",
    "start": "1521090",
    "end": "1527840"
  },
  {
    "text": "someone hooked some functions okay and pin is actually looking some",
    "start": "1527840",
    "end": "1534650"
  },
  {
    "text": "function to to perform is tracing every building and on and so forth and all",
    "start": "1534650",
    "end": "1540620"
  },
  {
    "text": "this stuff so I can look inside the memory of of a dll and set some",
    "start": "1540620",
    "end": "1547789"
  },
  {
    "text": "functions that I know pin is gonna hook and if the beginning of the function is",
    "start": "1547789",
    "end": "1552919"
  },
  {
    "text": "not what I expect I know there is no so that's actually the example this is the",
    "start": "1552919",
    "end": "1558049"
  },
  {
    "text": "example on now pin is soaking the user a PC dispatcher okay so it's basically",
    "start": "1558049",
    "end": "1564380"
  },
  {
    "text": "adding a jump at the beginning as I show you so I can read it and I know I'm an",
    "start": "1564380",
    "end": "1572179"
  },
  {
    "text": "instrumentation so we have a module for of course so it's called a fakery dental",
    "start": "1572179",
    "end": "1578060"
  },
  {
    "text": "module what it does is basically you can see as a built on memory on top of",
    "start": "1578060",
    "end": "1584960"
  },
  {
    "text": "crystal memory okay I gonna show you now the idea is I of the function there",
    "start": "1584960",
    "end": "1591980"
  },
  {
    "text": "inside the memory and what I expecting there is this Lea instruction but of",
    "start": "1591980",
    "end": "1598640"
  },
  {
    "text": "course it's suit so I have a jump instruction so when when we are building",
    "start": "1598640",
    "end": "1606350"
  },
  {
    "text": "the chase we search for for rate for instruction that are performing every",
    "start": "1606350",
    "end": "1612530"
  },
  {
    "text": "inside the memory like the movie okay so it's reading inside the memory we keep a",
    "start": "1612530",
    "end": "1620150"
  },
  {
    "text": "list of you can look at the hook that functions inside the insert another part",
    "start": "1620150",
    "end": "1625670"
  },
  {
    "text": "of memory as if the if the memory if the if the memory we are going to read is",
    "start": "1625670",
    "end": "1632540"
  },
  {
    "text": "inside our our list we basically redirect the memory to another address",
    "start": "1632540",
    "end": "1637730"
  },
  {
    "text": "where we stored the real volume okay so every time we actually perform a hook we",
    "start": "1637730",
    "end": "1645940"
  },
  {
    "text": "we saved the old value somewhere else and then we keep a list of of where are",
    "start": "1645940",
    "end": "1655340"
  },
  {
    "text": "our stuff where we put the old value and when we you are trying to read to read",
    "start": "1655340",
    "end": "1661490"
  },
  {
    "text": "the beginning of our function we just change the address on distraction so that you can read another place okay so",
    "start": "1661490",
    "end": "1668390"
  },
  {
    "text": "you read the original it's the actual and then you are fine because of the",
    "start": "1668390",
    "end": "1674060"
  },
  {
    "text": "compare and check that you are doing it's actually what you expected so we",
    "start": "1674060",
    "end": "1681100"
  },
  {
    "text": "have another one another thing that is memory allocations so the the decompiler",
    "start": "1681100",
    "end": "1691790"
  },
  {
    "text": "inside pin is actually performing a lot of memory allocation so every time you",
    "start": "1691790",
    "end": "1697340"
  },
  {
    "text": "need more space for building it stress",
    "start": "1697340",
    "end": "1702440"
  },
  {
    "text": "is actually locating something so another easy way to",
    "start": "1702440",
    "end": "1708130"
  },
  {
    "text": "detect the detect ID digit Kampala is the one of King the develop memory",
    "start": "1708260",
    "end": "1717680"
  },
  {
    "text": "function okay so I'm the malware I'm making the hook on the allocated memory",
    "start": "1717680",
    "end": "1726160"
  },
  {
    "text": "so I can actually count how many a location are there",
    "start": "1726160",
    "end": "1732050"
  },
  {
    "text": "this is our there is the our function 10 I could be jump back I increment a",
    "start": "1732050",
    "end": "1738110"
  },
  {
    "text": "counter and then hm I jump back in this way I can count how many allocation are there and you may not perform any any",
    "start": "1738110",
    "end": "1749000"
  },
  {
    "text": "counting so if there is as if the counter is greater than 0 you know that basically around under instrumentation",
    "start": "1749000",
    "end": "1755210"
  },
  {
    "text": "so like so what we did is actually so this is our reception in New York okay",
    "start": "1755210",
    "end": "1761450"
  },
  {
    "text": "you are the malware someone you're writing inside the jump so what we did is actually it's similar to the read",
    "start": "1761450",
    "end": "1770780"
  },
  {
    "text": "stuff I just show you but this time with the right so we're basically using the",
    "start": "1770780",
    "end": "1776240"
  },
  {
    "text": "fake right hander module that is basically stopping the bright of what is",
    "start": "1776240",
    "end": "1782720"
  },
  {
    "text": "actually doing is redirect redirecting the bright sound somewhere else okay so",
    "start": "1782720",
    "end": "1787790"
  },
  {
    "text": "we basically change release will is while you are building the chase we we",
    "start": "1787790",
    "end": "1795740"
  },
  {
    "text": "are checking for all the destruction that are performing on a memory right and then we change the address",
    "start": "1795740",
    "end": "1802130"
  },
  {
    "text": "putting the bright something's in other place other place we are located for some reason okay so of course what we do",
    "start": "1802130",
    "end": "1810740"
  },
  {
    "text": "is when you try to read that memory location you we still have the module that",
    "start": "1810740",
    "end": "1818270"
  },
  {
    "text": "factory its so we can basically redirect the read also in the same place you brought so you're so awesome aware you",
    "start": "1818270",
    "end": "1825470"
  },
  {
    "text": "are thinking too right inside the ntdll or reading there but basically everything you are doing on that address",
    "start": "1825470",
    "end": "1832070"
  },
  {
    "text": "is ready read some somewhere else so you perform nuke you think it's fine because",
    "start": "1832070",
    "end": "1838220"
  },
  {
    "text": "you're reading back the value you brought but actually there is no hook in place and so you cannot count any any a",
    "start": "1838220",
    "end": "1845630"
  },
  {
    "text": "location okay so we are almost there",
    "start": "1845630",
    "end": "1851840"
  },
  {
    "text": "with the with the instrumentation and discrimination part this is going to be",
    "start": "1851840",
    "end": "1858830"
  },
  {
    "text": "a bit quicker it's about over at detection so this is also a kind of well",
    "start": "1858830",
    "end": "1869330"
  },
  {
    "text": "know technique when when you are performing any instrumentation of any time actually so I count the time I I",
    "start": "1869330",
    "end": "1879410"
  },
  {
    "text": "come the time my my script my executable is taking it to perform some action and because there is some instrumentation",
    "start": "1879410",
    "end": "1886720"
  },
  {
    "text": "involved I'm actually my execution is gonna be longer than expected on a bare",
    "start": "1886720",
    "end": "1895400"
  },
  {
    "text": "metal machine okay so this is of course also true with we think it's even more",
    "start": "1895400",
    "end": "1901700"
  },
  {
    "text": "true if you use module like self-modifying code that I'll show you that it's having an instruction maybe",
    "start": "1901700",
    "end": "1907210"
  },
  {
    "text": "between each instruction so there are",
    "start": "1907210",
    "end": "1912250"
  },
  {
    "text": "two big way to actually detect the the overhead the first one is you basically",
    "start": "1912250",
    "end": "1919520"
  },
  {
    "text": "check the time using the windows functions so there are two API that are",
    "start": "1919520",
    "end": "1924770"
  },
  {
    "text": "called get account and time get time that are basically giving you the",
    "start": "1924770",
    "end": "1931340"
  },
  {
    "text": "execution time but what does API are actually doing is reading from a memory",
    "start": "1931340",
    "end": "1938150"
  },
  {
    "text": "a memory structure a structure inside the memory is called K you searched data",
    "start": "1938150",
    "end": "1944630"
  },
  {
    "text": "but basically add some value some counter that is keeping them so you may",
    "start": "1944630",
    "end": "1952520"
  },
  {
    "text": "guess the solution here is we use the yukkin yukkin module for the ethic time and we use the sacred module for usage",
    "start": "1952520",
    "end": "1962360"
  },
  {
    "text": "at that it's this cap this part is not",
    "start": "1962360",
    "end": "1968290"
  },
  {
    "text": "automatic as you may think because the problem is which while you're gonna put",
    "start": "1968290",
    "end": "1973730"
  },
  {
    "text": "inside there okay and I'll say trial is it right now is kinda manually so we we estimated the",
    "start": "1973730",
    "end": "1982870"
  },
  {
    "text": "value for our tools for our framework okay and we are using a fixed value",
    "start": "1982870",
    "end": "1988750"
  },
  {
    "text": "there but you can change it if you are using with with the other other value",
    "start": "1988750",
    "end": "1994420"
  },
  {
    "text": "that you may think it works and there is a another way to actually detect the do",
    "start": "1994420",
    "end": "2004140"
  },
  {
    "text": "birth of yoga read of your program that is using the FD a DTS C instruction that",
    "start": "2004140",
    "end": "2013500"
  },
  {
    "text": "these are actually destruction is giving you the count on CPU cycle and also here",
    "start": "2013500",
    "end": "2021210"
  },
  {
    "text": "you right now may already know which part of the tool we want to use for that",
    "start": "2021210",
    "end": "2026370"
  },
  {
    "text": "we use the pattern matching module that is the module that we also use for the",
    "start": "2026370",
    "end": "2032700"
  },
  {
    "text": "into e now is the module that is searching for some instruction and then patching adding some function after",
    "start": "2032700",
    "end": "2039450"
  },
  {
    "text": "destruction so you just change the the return value of of this instruction okay so that's",
    "start": "2039450",
    "end": "2049378"
  },
  {
    "text": "enough for the for the end discrimination now I'm gonna talk about the experiment we did on aversive",
    "start": "2049379",
    "end": "2059250"
  },
  {
    "text": "malware so our idea is we had this tool",
    "start": "2059250",
    "end": "2064740"
  },
  {
    "text": "okay I mean and then we know okay it's useful it's not we don't really know because we don't know how many ever seen",
    "start": "2064740",
    "end": "2071220"
  },
  {
    "text": "malware out there so what we we thought okay let's add a bunch of malware and",
    "start": "2071220",
    "end": "2078358"
  },
  {
    "text": "try to understand if they are performing some aversive be aid or not so that's",
    "start": "2078359",
    "end": "2085169"
  },
  {
    "text": "basically what we did we collected about 7,000 binary from about of total with",
    "start": "2085169",
    "end": "2093330"
  },
  {
    "text": "the condition that they are detected at least from some antivirus because we",
    "start": "2093330",
    "end": "2098760"
  },
  {
    "text": "want them to be malicious that's from October to flat body illa",
    "start": "2098760",
    "end": "2105930"
  },
  {
    "text": "last year okay and we run it actually on a virtual machine that's because we need to run",
    "start": "2105930",
    "end": "2114180"
  },
  {
    "text": "7,000 binary and we know Nelson thousand bare-metal machine so the experiment has",
    "start": "2114180",
    "end": "2120330"
  },
  {
    "text": "been done onions out the inside the diverter machine but we were checking for ant instrumentation technique so for",
    "start": "2120330",
    "end": "2128160"
  },
  {
    "text": "10 ft burna instrumentation of course we may add some false positive because the malware was actually detecting the",
    "start": "2128160",
    "end": "2134970"
  },
  {
    "text": "virtual machine and on the anyway we talked we tried our best to make to make",
    "start": "2134970",
    "end": "2140430"
  },
  {
    "text": "the Goethe machinist as complete as possible so we installed a bunch of",
    "start": "2140430",
    "end": "2146540"
  },
  {
    "text": "application we even stored some credential some cookies some browser",
    "start": "2146540",
    "end": "2151650"
  },
  {
    "text": "history so to be as free as possible and of course we are the moving mouse and",
    "start": "2151650",
    "end": "2159119"
  },
  {
    "text": "some other to the blanching application this stuff and we run each application",
    "start": "2159119",
    "end": "2165210"
  },
  {
    "text": "for at least 5 minutes ok so those are the results more or less",
    "start": "2165210",
    "end": "2171420"
  },
  {
    "text": "so we from all the banner we collected",
    "start": "2171420",
    "end": "2176570"
  },
  {
    "text": "we run them through every class that is this tool that basically give you the",
    "start": "2176570",
    "end": "2182700"
  },
  {
    "text": "family of the malware so the name that you see here is the the name given to",
    "start": "2182700",
    "end": "2189210"
  },
  {
    "text": "you by the by every class so what you can see is that we have a really huge",
    "start": "2189210",
    "end": "2196710"
  },
  {
    "text": "number of very lock is like 80% so this is how much of this specific family",
    "start": "2196710",
    "end": "2203130"
  },
  {
    "text": "we're inside our sample so there are many abilities are about the about 9",
    "start": "2203130",
    "end": "2209520"
  },
  {
    "text": "percent we think that it's because during February and and and actually",
    "start": "2209520",
    "end": "2217290"
  },
  {
    "text": "during a temporary February that was more submitted than others I actually",
    "start": "2217290",
    "end": "2222480"
  },
  {
    "text": "talked with the guy who developed the class and he it told me that Barak is not so common as a family inside them",
    "start": "2222480",
    "end": "2229680"
  },
  {
    "text": "inside they're told so this is the reason and what you see in the middle is",
    "start": "2229680",
    "end": "2236310"
  },
  {
    "text": "the percentage of sample of that family that is a ratio so the bed lock is almost always amazing",
    "start": "2236310",
    "end": "2243109"
  },
  {
    "text": "but for rather you you see that they never cheater any of our our technique",
    "start": "2243109",
    "end": "2250130"
  },
  {
    "text": "and of course on the on day on on the last column there you see how many",
    "start": "2250130",
    "end": "2255589"
  },
  {
    "text": "different technique they triggered okay so this table may be more interesting",
    "start": "2255589",
    "end": "2264039"
  },
  {
    "text": "here we basically ordered the family about the ever silliness I mean the",
    "start": "2264039",
    "end": "2272779"
  },
  {
    "text": "first one is the one that is 100% and so on so as you may may see there are few",
    "start": "2272779",
    "end": "2279109"
  },
  {
    "text": "family that are basically 100% Avis if they always implement some sort of dbi",
    "start": "2279109",
    "end": "2285799"
  },
  {
    "text": "and the instrumentation technique and some other that actually have a few few",
    "start": "2285799",
    "end": "2292009"
  },
  {
    "text": "sample that implements those technique so let's see which technique they",
    "start": "2292009",
    "end": "2297470"
  },
  {
    "text": "actually implement so the first one is",
    "start": "2297470",
    "end": "2304329"
  },
  {
    "text": "the soft modifying code and this is not actually surprising because self-modifying code is not only used to",
    "start": "2304329",
    "end": "2312739"
  },
  {
    "text": "the fifth dynamic values to mentorship is useful for many reason it can also be",
    "start": "2312739",
    "end": "2320180"
  },
  {
    "text": "like a side effect that is actually breaking also be bi if if you if you",
    "start": "2320180",
    "end": "2325549"
  },
  {
    "text": "want to be honnest but another the second spot is kinda",
    "start": "2325549",
    "end": "2332739"
  },
  {
    "text": "more interesting because they are doing the parent detection check many of them",
    "start": "2332739",
    "end": "2339589"
  },
  {
    "text": "and that is a super easy trick so that's probably the reason because many many",
    "start": "2339589",
    "end": "2345950"
  },
  {
    "text": "members have have it implemented but it's also one of the easier to actually",
    "start": "2345950",
    "end": "2351529"
  },
  {
    "text": "bypass know and then we have other so the bright on protecting memory region",
    "start": "2351529",
    "end": "2357950"
  },
  {
    "text": "II means basically each I taught something okay and we have other classic",
    "start": "2357950",
    "end": "2363799"
  },
  {
    "text": "stuff like that the bug flag or and and very few they actually did memory",
    "start": "2363799",
    "end": "2370400"
  },
  {
    "text": "finger-painting so searching to the memo for for stuff so another disclaimer here",
    "start": "2370400",
    "end": "2378880"
  },
  {
    "text": "the memory fingerprinting memory finger Kingdom may not be done to actually",
    "start": "2378880",
    "end": "2385420"
  },
  {
    "text": "identify pain it may be done to identify other stuff but they were doing memory",
    "start": "2385420",
    "end": "2390580"
  },
  {
    "text": "fingerprinting somehow okay so about override of our tool because as I told",
    "start": "2390580",
    "end": "2397870"
  },
  {
    "text": "you all this stuff doesn't come for free and we here I just show you some rough",
    "start": "2397870",
    "end": "2405460"
  },
  {
    "text": "number on overhead and the percentage of the red is actually on top of pin",
    "start": "2405460",
    "end": "2411790"
  },
  {
    "text": "overhead with peanuts its own overhead so when you say we we need to to use the",
    "start": "2411790",
    "end": "2418390"
  },
  {
    "text": "sacred module two hundred fifty four percent it means on top of pin",
    "start": "2418390",
    "end": "2423810"
  },
  {
    "text": "instrumentation okay and we don't have one for for the for",
    "start": "2423810",
    "end": "2431470"
  },
  {
    "text": "the self-modifying code because they have modified code was not working without our implementation basically it",
    "start": "2431470",
    "end": "2437650"
  },
  {
    "text": "was crashing every time okay we are almost done this is a feature that we",
    "start": "2437650",
    "end": "2447880"
  },
  {
    "text": "have in our tool so last year public at USA the guys who actually develop the",
    "start": "2447880",
    "end": "2454810"
  },
  {
    "text": "part of this stuff they about talked about unpacking packet unpacking tools",
    "start": "2454810",
    "end": "2459820"
  },
  {
    "text": "that was called pin demonium so pinned ammonia is actually integrated with with",
    "start": "2459820",
    "end": "2466810"
  },
  {
    "text": "Iran China okay and in Timonium what was doing really neat stuff like detecting",
    "start": "2466810",
    "end": "2475960"
  },
  {
    "text": "the the brighten executable region was dumping the program identifying the",
    "start": "2475960",
    "end": "2481710"
  },
  {
    "text": "original entry pointing at the end which was also able to reconstruct the executable some time and so you have all",
    "start": "2481710",
    "end": "2489160"
  },
  {
    "text": "this stuff on top of I can enable some anti received system so last year we",
    "start": "2489160",
    "end": "2497380"
  },
  {
    "text": "weren't supporting at all obsidium that is actually doing some some anti aunt in",
    "start": "2497380",
    "end": "2504760"
  },
  {
    "text": "the banking test a bank check so now our tool can also end the obsidium as Hassan al-bakr so",
    "start": "2504760",
    "end": "2513059"
  },
  {
    "text": "for one of you didn't follow the talk the the green the green spot means",
    "start": "2513059",
    "end": "2521030"
  },
  {
    "text": "basically we can fold the recover the executable it means that the output is",
    "start": "2521030",
    "end": "2527579"
  },
  {
    "text": "an executable that you can run the yellow means you add the unpackage code",
    "start": "2527579",
    "end": "2533760"
  },
  {
    "text": "but it's not not runnable because we fail to detect the import table in this",
    "start": "2533760",
    "end": "2538829"
  },
  {
    "text": "canister okay and and the tool is actually working on many this is an",
    "start": "2538829",
    "end": "2544859"
  },
  {
    "text": "experiment where we did were basically trying to unpacking random stuff and it works on more than 60% of random random",
    "start": "2544859",
    "end": "2556170"
  },
  {
    "text": "Packers okay so they've been randomly chose from from virustotal ah good so",
    "start": "2556170",
    "end": "2564319"
  },
  {
    "text": "demo time so i gonna show you quickly how to use the tool so for the",
    "start": "2564319",
    "end": "2571950"
  },
  {
    "text": "demonstration I'm actually using excite excited czar tool written by some guy",
    "start": "2571950",
    "end": "2577470"
  },
  {
    "text": "from Kerr security they basically they have implemented some of those technique",
    "start": "2577470",
    "end": "2584099"
  },
  {
    "text": "I just show you so I am Bobby I'm here and I tried 20 times this morning the",
    "start": "2584099",
    "end": "2593130"
  },
  {
    "text": "demo I hope still gonna work so we have the excite binary here okay and for",
    "start": "2593130",
    "end": "2605880"
  },
  {
    "text": "example I can tell okay detect direct",
    "start": "2605880",
    "end": "2611599"
  },
  {
    "text": "buy into it okay said they ll actually",
    "start": "2611599",
    "end": "2617119"
  },
  {
    "text": "detecting if I'm if I'm is using the into instruction to detect me the",
    "start": "2617119",
    "end": "2624140"
  },
  {
    "text": "instrumentation of course I'm not using pin so the textual fail so if I actually use pin",
    "start": "2624140",
    "end": "2631220"
  },
  {
    "text": "you see that is detecting pills so let's use our stall and we have many flags",
    "start": "2632790",
    "end": "2645470"
  },
  {
    "text": "that you can enable so anti-air is the generic flag for the instruction",
    "start": "2645470",
    "end": "2652290"
  },
  {
    "text": "specific patch you know you need to use the entire instruction patch and now you",
    "start": "2652290",
    "end": "2658350"
  },
  {
    "text": "see it's actually not detected anymore okay so another couple of stuff I can",
    "start": "2658350",
    "end": "2666750"
  },
  {
    "text": "show you we have the easy parent that action so parent okay okay and you can",
    "start": "2666750",
    "end": "2682230"
  },
  {
    "text": "just use the ante up flag to to defeat",
    "start": "2682230",
    "end": "2693060"
  },
  {
    "text": "that what okay okay or another one that",
    "start": "2693060",
    "end": "2701010"
  },
  {
    "text": "is cool is the the one that is actually booking stuff so is detect ntdll",
    "start": "2701010",
    "end": "2714840"
  },
  {
    "text": "books",
    "start": "2714840",
    "end": "2717110"
  },
  {
    "text": "okay and you can use the hunt every day",
    "start": "2719970",
    "end": "2725130"
  },
  {
    "text": "just read okay mister so I can spend all",
    "start": "2725160",
    "end": "2732280"
  },
  {
    "text": "day show you this stuff that that's almost it so okay so let's wrap up the",
    "start": "2732280",
    "end": "2740230"
  },
  {
    "text": "talk so I show you that some anti",
    "start": "2740230",
    "end": "2746260"
  },
  {
    "text": "fermentation technique I show you a framework that we built to defeat those",
    "start": "2746260",
    "end": "2751990"
  },
  {
    "text": "techniques selectively you can enable some part or other and you can eventually use the framework to",
    "start": "2751990",
    "end": "2758440"
  },
  {
    "text": "implement some other page that you want to add for other reason and we show you",
    "start": "2758440",
    "end": "2768280"
  },
  {
    "text": "that there are actually malware that are using those kind of technique there",
    "start": "2768280",
    "end": "2773559"
  },
  {
    "text": "directly to the fit pin or not and I show that we have a tracker that is",
    "start": "2773559",
    "end": "2780069"
  },
  {
    "text": "actually a evasion resilient right now so that's almost it for my talk you can",
    "start": "2780069",
    "end": "2787930"
  },
  {
    "text": "find the the tool on github if you're gonna there you can download it we also",
    "start": "2787930",
    "end": "2793270"
  },
  {
    "text": "have the some samples to check the stuff and right now if you have any question",
    "start": "2793270",
    "end": "2801010"
  },
  {
    "text": "we can chat about this stuff or if you wanna so there is someone with the",
    "start": "2801010",
    "end": "2806829"
  },
  {
    "text": "microphone and you can ask a question on the microphone or maybe we can talk",
    "start": "2806829",
    "end": "2812349"
  },
  {
    "text": "later I still be around for a while definitely wanna follow the the",
    "start": "2812349",
    "end": "2817390"
  },
  {
    "text": "following talk so okay let's go about some some question okay guys what are",
    "start": "2817390",
    "end": "2824140"
  },
  {
    "text": "the questions that you will like to ask Mario",
    "start": "2824140",
    "end": "2828630"
  },
  {
    "text": "okay there's a question down here it is",
    "start": "2836710",
    "end": "2845560"
  },
  {
    "text": "quick question on the way you were detecting cheat emulation you said that",
    "start": "2845590",
    "end": "2851030"
  },
  {
    "text": "at every step you are basically checking what's that was the address if the",
    "start": "2851030",
    "end": "2858890"
  },
  {
    "text": "address is the one of the binary yeah yeah so why didn't you just map those",
    "start": "2858890",
    "end": "2864110"
  },
  {
    "text": "magic pages as read-only and then trap on executing you're right those pages so",
    "start": "2864110",
    "end": "2871640"
  },
  {
    "text": "the pages were you mapped your original text file so you're saying let me go",
    "start": "2871640",
    "end": "2878480"
  },
  {
    "text": "back you are saying why we so the question was about the defector in man",
    "start": "2878480",
    "end": "2887180"
  },
  {
    "text": "mod right so why we redirect the raid instead of",
    "start": "2887180",
    "end": "2892810"
  },
  {
    "text": "catching the the readin and stopping it",
    "start": "2892810",
    "end": "2897830"
  },
  {
    "text": "yes so you basically have in one of your prevention techniques you basically have after every what is it read you have",
    "start": "2897830",
    "end": "2907630"
  },
  {
    "text": "where do I check the PC check the PC against the day oh what's the stuff modifying call me maybe",
    "start": "2907630",
    "end": "2913340"
  },
  {
    "text": "yeah okay so your question is why we why don't you just map the original DLL",
    "start": "2913340",
    "end": "2920450"
  },
  {
    "text": "pages as read-only because this of",
    "start": "2920450",
    "end": "2926120"
  },
  {
    "text": "modifying code was about the malware changing itself okay so it so you need",
    "start": "2926120",
    "end": "2934340"
  },
  {
    "text": "the right yes it needs to be to change it itself to actually works because it's",
    "start": "2934340",
    "end": "2940010"
  },
  {
    "text": "not fully thankful okay so it's changing itself in a working version so at the",
    "start": "2940010",
    "end": "2947180"
  },
  {
    "text": "beginning is not working because here it has the wrong instruction so it is patching itself so we we don't even know",
    "start": "2947180",
    "end": "2954920"
  },
  {
    "text": "how is going to patch it before actually before the execution so we not we cannot",
    "start": "2954920",
    "end": "2960200"
  },
  {
    "text": "like redirect the read or this kind of stuff so we came up with this social I",
    "start": "2960200",
    "end": "2965870"
  },
  {
    "text": "think can be improved I mean of course checking for forever instruction we may",
    "start": "2965870",
    "end": "2971670"
  },
  {
    "text": "do something like we reinstall ain't",
    "start": "2971670",
    "end": "2978480"
  },
  {
    "text": "only on on those on those memory addresses that are market inside our",
    "start": "2978480",
    "end": "2984180"
  },
  {
    "text": "list something like that I think this can be improved a bit but yeah the",
    "start": "2984180",
    "end": "2990570"
  },
  {
    "text": "reason because we are not mapping we are not catching the not back mapping with",
    "start": "2990570",
    "end": "2997320"
  },
  {
    "text": "only or whatever is true because we are not controlling the we don't know what",
    "start": "2997320",
    "end": "3003530"
  },
  {
    "text": "is gonna be right I think I have but not",
    "start": "3003530",
    "end": "3013610"
  },
  {
    "text": "voice but okay so have you ever tried to use the tool to defuse protection",
    "start": "3013610",
    "end": "3019280"
  },
  {
    "text": "impecca mechanism like the protect or the unprotect or for example the media",
    "start": "3019280",
    "end": "3026390"
  },
  {
    "text": "supply that there are obviously the most complicated - yes so I think they",
    "start": "3026390",
    "end": "3031520"
  },
  {
    "text": "probably to me that was that I wear I'm packing tool is not able to to unpack",
    "start": "3031520",
    "end": "3037070"
  },
  {
    "text": "tamina yeah I am a reverse I know quite well that is very difficult to achieve that so I'm really interested in",
    "start": "3037070",
    "end": "3043790"
  },
  {
    "text": "understanding the porch the song so the impact is not I'm doing Tomita and we",
    "start": "3043790",
    "end": "3050000"
  },
  {
    "text": "didn't try to run it with the ante evasion of stuff but I actually might try to do now that you you said so to",
    "start": "3050000",
    "end": "3059420"
  },
  {
    "text": "answer your question is the other thing is about the set of samples that you",
    "start": "3059420",
    "end": "3067400"
  },
  {
    "text": "have collected from our solo I normally am facing malware that is very low in",
    "start": "3067400",
    "end": "3073430"
  },
  {
    "text": "terms of ratio from virus total IMAP about one or two just because the antivirus definitely not enough to be",
    "start": "3073430",
    "end": "3080660"
  },
  {
    "text": "able to catch that stuff so what I'm asking is if you have a try to analyze",
    "start": "3080660",
    "end": "3086120"
  },
  {
    "text": "with this show malware that even available from virus Ola have low ratio",
    "start": "3086120",
    "end": "3091310"
  },
  {
    "text": "but definitely is malicious because it's reported by I don't know apt groups and study about upon up empty groups",
    "start": "3091310",
    "end": "3099610"
  },
  {
    "text": "the of the stopped we analyzed were actually at low ratio so our limit was",
    "start": "3099610",
    "end": "3104710"
  },
  {
    "text": "at least three antiviruses so that we know it's malicious so I don't have",
    "start": "3104710",
    "end": "3111790"
  },
  {
    "text": "numbers on that I I didn't check if which one it was low right if I'd motivation but this is actually another",
    "start": "3111790",
    "end": "3117730"
  },
  {
    "text": "interesting number to actually happen and so uh so we add for sure run it on",
    "start": "3117730",
    "end": "3124990"
  },
  {
    "text": "on low ratio but the power but I don't know the number okay thank you emerging next question do",
    "start": "3124990",
    "end": "3137680"
  },
  {
    "text": "you think you can extend this to other dynamic binary instrumentation tools like create a library or something that",
    "start": "3137680",
    "end": "3144220"
  },
  {
    "text": "can be added so okay so more than other",
    "start": "3144220",
    "end": "3151360"
  },
  {
    "text": "dynamic balance transition tool was what I was thinking about is to extend to",
    "start": "3151360",
    "end": "3156520"
  },
  {
    "text": "other other nations other detection mechanism like VM detection so I may use",
    "start": "3156520",
    "end": "3164920"
  },
  {
    "text": "pin okay right now I'm using pin to avoid pin detection because pin is",
    "start": "3164920",
    "end": "3172030"
  },
  {
    "text": "powerful enough but I mean you so soap into about VM detection or to avoid another emulator of detection yeah I'm",
    "start": "3172030",
    "end": "3179740"
  },
  {
    "text": "okay that but there are companies and people that use different custom dynamic",
    "start": "3179740",
    "end": "3186190"
  },
  {
    "text": "binary structures and I see this as a useful thing like a library that can be",
    "start": "3186190",
    "end": "3191500"
  },
  {
    "text": "easily added in their systems so the",
    "start": "3191500",
    "end": "3197410"
  },
  {
    "text": "problem with that is that I don't have access to those tools so it's kind of as",
    "start": "3197410",
    "end": "3202930"
  },
  {
    "text": "you I should as I show you many of those techniques are can a one-point of a kind",
    "start": "3202930",
    "end": "3210520"
  },
  {
    "text": "of specific on pain okay so you need to know how the the tool is working to",
    "start": "3210520",
    "end": "3217930"
  },
  {
    "text": "creates or some simulation but I mean the framework is already there to be",
    "start": "3217930",
    "end": "3224830"
  },
  {
    "text": "used in this way okay it's open source oh yeah yeah it's on okay so let me show you",
    "start": "3224830",
    "end": "3233200"
  },
  {
    "text": "yes you can search aren t know on Google but I also depart because if you just",
    "start": "3233200",
    "end": "3241190"
  },
  {
    "text": "search challenge II know you get the Italian food ok so if you go on github and search for aren't you know you",
    "start": "3241190",
    "end": "3247160"
  },
  {
    "text": "you're fine I have the link at the end sorry I'm not",
    "start": "3247160",
    "end": "3254570"
  },
  {
    "text": "this question um what if your tool your dynamic binary instrumentation tool uses",
    "start": "3254570",
    "end": "3259850"
  },
  {
    "text": "those functions that you actually patch like empty virtual whatever that read",
    "start": "3259850",
    "end": "3267290"
  },
  {
    "text": "the memory and so you're asking if they",
    "start": "3267290",
    "end": "3272500"
  },
  {
    "text": "DLL the ntdll functions if them are were try talks that stuff",
    "start": "3272500",
    "end": "3278600"
  },
  {
    "text": "no no if if your dynamic binary instrumentation tool actually uses those so is using some of them so we don't",
    "start": "3278600",
    "end": "3288080"
  },
  {
    "text": "change the yoke of the binary we just add it with the fake memory read okay",
    "start": "3288080",
    "end": "3295360"
  },
  {
    "text": "okay so there are another question I",
    "start": "3295360",
    "end": "3300800"
  },
  {
    "text": "thank you all for coming to my talk and see",
    "start": "3300800",
    "end": "3306370"
  }
]