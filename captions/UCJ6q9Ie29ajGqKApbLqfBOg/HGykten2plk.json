[
  {
    "text": "all right hello everyone afternoon I'm Todd again and welcome to my talk which",
    "start": "30",
    "end": "5759"
  },
  {
    "text": "is OK the name is with bit a bit long it's called ok it's only called",
    "start": "5759",
    "end": "11790"
  },
  {
    "text": "exploring and reversing a post continuity protocol and let me introduce myself my name is pavel yen and I'm from",
    "start": "11790",
    "end": "21420"
  },
  {
    "text": "Taiwan I'm used to be independent security researcher but then I joined",
    "start": "21420",
    "end": "27210"
  },
  {
    "text": "trained my code which is actually I mean tx1 majority owned subsidiary of Trend",
    "start": "27210",
    "end": "33360"
  },
  {
    "text": "Micro and I'm in a out in ICS research labs I'm joined them on November of 2019 and",
    "start": "33360",
    "end": "41879"
  },
  {
    "text": "I mainly focus on protocol analysis and wireless and hardware's that I have previously talked at hit down 2018-19",
    "start": "41879",
    "end": "48780"
  },
  {
    "text": "and I do try to part if every day before I work so you can ask me if you have any",
    "start": "48780",
    "end": "55379"
  },
  {
    "text": "problems regarding participate besides technical questions so let's take an",
    "start": "55379",
    "end": "64140"
  },
  {
    "text": "overview today's agenda will be talking about the background of this protocol",
    "start": "64140",
    "end": "69750"
  },
  {
    "text": "and its research and about Kundalini protocols introduction and we'll be",
    "start": "69750",
    "end": "76259"
  },
  {
    "text": "talking about fire studies about priors current status of continuities security",
    "start": "76259",
    "end": "81630"
  },
  {
    "text": "and our attack scenario which we'll be able to fingerprint and track and use",
    "start": "81630",
    "end": "86670"
  },
  {
    "text": "metadata beliefs and we will be somehow able to break apples Mac rotation and",
    "start": "86670",
    "end": "93030"
  },
  {
    "text": "we'll be we'll be finalizing this talk with the demo so first I'll have to talk",
    "start": "93030",
    "end": "102420"
  },
  {
    "text": "about arrows unboxing experience so the apples unboxing experience which in the",
    "start": "102420",
    "end": "109470"
  },
  {
    "text": "industry is quite a match I mean other vendors are not quite on",
    "start": "109470",
    "end": "115350"
  },
  {
    "text": "par with apples unboxing experience like when you buy a product you just have to",
    "start": "115350",
    "end": "121110"
  },
  {
    "text": "unbox it like log in to unlock a device and provision that guides to the iCloud",
    "start": "121110",
    "end": "126630"
  },
  {
    "text": "and it will work magically but of oh I was 13 squad Pocky you might",
    "start": "126630",
    "end": "133180"
  },
  {
    "text": "into comics in daily use but however unboxing experience of April products is improving a lot of way and for continual",
    "start": "133180",
    "end": "144670"
  },
  {
    "text": "protocol the this protocol is a proprietary protocol developed by Apple and is used by their devices based on",
    "start": "144670",
    "end": "151629"
  },
  {
    "text": "Mbutu flow energy in Wi-Fi and it is tightly integrated with iCloud for",
    "start": "151629",
    "end": "157120"
  },
  {
    "text": "public key infrastructure and also the Bluetooth encryption keys will be sent to iCloud during Prohibition and this",
    "start": "157120",
    "end": "164260"
  },
  {
    "text": "protocol is usually used for users to move seamlessly between devices for",
    "start": "164260",
    "end": "170769"
  },
  {
    "text": "example you can make phone calls on your Mac to your iPhone and you can share click clipboards between your devices",
    "start": "170769",
    "end": "176620"
  },
  {
    "text": "you can have your Mac open you can you can help your Mac carry your phone to open a hotspot without reaching your",
    "start": "176620",
    "end": "183489"
  },
  {
    "text": "phones and maybe share cameras between your devices send files and send messages and then why we're we're",
    "start": "183489",
    "end": "193060"
  },
  {
    "text": "talking about its topic the research ok wait I don't have to ask is there some",
    "start": "193060",
    "end": "199599"
  },
  {
    "text": "someone from fo in this room ok no but",
    "start": "199599",
    "end": "205180"
  },
  {
    "text": "I'm not going to do echo passion today because efforts they are actually pretty nice for me so this research was",
    "start": "205180",
    "end": "212829"
  },
  {
    "text": "intended to re-implement continuity and Linux because I switch my work letter",
    "start": "212829",
    "end": "217840"
  },
  {
    "text": "from active Linux a year ago and I miss air job and instant hotspot it's because",
    "start": "217840",
    "end": "224739"
  },
  {
    "text": "instant Hospital has some gimmicks while you're using it we've now fo device you",
    "start": "224739",
    "end": "230109"
  },
  {
    "text": "have to have your settings menu open but sometimes even you do so you will fail to connect to that hotspot and actually",
    "start": "230109",
    "end": "240489"
  },
  {
    "text": "Steve Jobs promised FaceTime would be open standard and introduction but since",
    "start": "240489",
    "end": "245549"
  },
  {
    "text": "stick trust has that last now can cook click over and also make continuity open",
    "start": "245549",
    "end": "251079"
  },
  {
    "text": "standard since Windows market share is pretty high and also",
    "start": "251079",
    "end": "258070"
  },
  {
    "text": "continuity protocol has they discussed before and I decided to fire up my uber tooth one and a package Locker peg",
    "start": "258070",
    "end": "265450"
  },
  {
    "text": "Locker is in for developers to debug and develop blue boot of applications while using your",
    "start": "265450",
    "end": "271010"
  },
  {
    "text": "Mac and then I found out it's more interesting to study these protocols security and privacy implications so I",
    "start": "271010",
    "end": "282470"
  },
  {
    "text": "later found out that is based heavily on proof broadcast and a research turned from",
    "start": "282470",
    "end": "289190"
  },
  {
    "text": "reimplantation to study is possible issues but the original objective of",
    "start": "289190",
    "end": "295030"
  },
  {
    "text": "implementation still lives and will be done in the near future so here's some",
    "start": "295030",
    "end": "303670"
  },
  {
    "text": "responsibility closure I reported this issues to a porter around August and",
    "start": "303670",
    "end": "310070"
  },
  {
    "text": "haplin we do try to my dreams presented during hit Kong and I resubmitted this",
    "start": "310070",
    "end": "316940"
  },
  {
    "text": "slides to Apple in relation to to apply a new presentation and it's around the",
    "start": "316940",
    "end": "324380"
  },
  {
    "text": "end of November then they assigned a CV number for me which means FM I'd fixed",
    "start": "324380",
    "end": "329630"
  },
  {
    "text": "some of the issues in the near future and about they took their time and submitted this issue as a smooth CV for",
    "start": "329630",
    "end": "336560"
  },
  {
    "text": "me so here's a shout out to the epic ice for cover according with external researchers and it took them a long time",
    "start": "336560",
    "end": "344570"
  },
  {
    "text": "for volunteer fix days but it's understandable since mitigating these issues without breaking fiends could be",
    "start": "344570",
    "end": "349880"
  },
  {
    "text": "difficult so here's the days of relative",
    "start": "349880",
    "end": "355700"
  },
  {
    "text": "work and which you might use provable entry to track devices software might be related to this work but some of them",
    "start": "355700",
    "end": "361820"
  },
  {
    "text": "are not so there are numbers of wonderful works regarding this and especially like",
    "start": "361820",
    "end": "368090"
  },
  {
    "text": "garments work and chosen plaintext attacks which kind of inspired this research and I have to mention that",
    "start": "368090",
    "end": "374090"
  },
  {
    "text": "ministers work an airdrop which is called up DL and also there's one Martin's concurrent work and continuity",
    "start": "374090",
    "end": "381170"
  },
  {
    "text": "which is listed here so here's a",
    "start": "381170",
    "end": "387710"
  },
  {
    "text": "disclaimer so since it's unavoidable for research Christians to happen and sometimes one or more research groups",
    "start": "387710",
    "end": "394190"
  },
  {
    "text": "can came out with some new findings without prior touching base with each other so this research was done prior to a",
    "start": "394190",
    "end": "401729"
  },
  {
    "text": "from showing Trend Micro and some of the findings of its research it is submitted",
    "start": "401729",
    "end": "406889"
  },
  {
    "text": "but not based on the one reads by Martin in April",
    "start": "406889",
    "end": "412549"
  },
  {
    "text": "all right so let's have a quick run away of groceries in basically low energy and",
    "start": "412549",
    "end": "419179"
  },
  {
    "text": "if you're familiar with Pluto energy then you can probably take a nap now and",
    "start": "419179",
    "end": "424769"
  },
  {
    "text": "wake up later so for Bluetooth Low",
    "start": "424769",
    "end": "430229"
  },
  {
    "text": "Energy it's a workhorse of its kind of needed protocol you can use this they can use",
    "start": "430229",
    "end": "435269"
  },
  {
    "text": "this protocol to push another protocol in continuity and it's many time by",
    "start": "435269",
    "end": "440669"
  },
  {
    "text": "using out of entering by iCloud and for preparing usually the best has to be",
    "start": "440669",
    "end": "446009"
  },
  {
    "text": "paired with each other before connecting to each other unless your devices headset or the keyboard and out of",
    "start": "446009",
    "end": "453179"
  },
  {
    "text": "pampering is uncommon due to implantation but Apple Street is big enough so that shouldn't be an issue and",
    "start": "453179",
    "end": "460229"
  },
  {
    "text": "Apple also uses a private resolver address while broadcasting this will be explained in later slides so actually",
    "start": "460229",
    "end": "470309"
  },
  {
    "text": "device will amp or - yes device will actually um port your iCloud after",
    "start": "470309",
    "end": "475379"
  },
  {
    "text": "device login I guess probably ever uses all of temporary to reduce many many",
    "start": "475379",
    "end": "482189"
  },
  {
    "text": "middle attack surface since in in both of you you if you managed to sneak",
    "start": "482189",
    "end": "487709"
  },
  {
    "text": "parent packets then you can you get the keys for pairing and also device will",
    "start": "487709",
    "end": "494279"
  },
  {
    "text": "send is RK which use two different devices in a wild so for pirate resolver",
    "start": "494279",
    "end": "502169"
  },
  {
    "text": "address it's actually a way to render lies Mac and your Mac will be remain recognizable to a few clients and",
    "start": "502169",
    "end": "509869"
  },
  {
    "text": "inspects that's best call for addressed range and certain timeouts any apples in",
    "start": "509869",
    "end": "516930"
  },
  {
    "text": "relations they actually change this address on each enough cycle and timeout the Bluetooth proxy address can be",
    "start": "516930",
    "end": "524008"
  },
  {
    "text": "either proper or random and random can be static means it will not change or private means that it will change",
    "start": "524009",
    "end": "530730"
  },
  {
    "text": "and as what render private it can be non resolve oh it means essentially Wrentham",
    "start": "530730",
    "end": "535980"
  },
  {
    "text": "unless your engine is broken or resolved Oh research generally 15 which is like a",
    "start": "535980",
    "end": "541649"
  },
  {
    "text": "seed it is in fact and 128-bit RK and private address will change so usually",
    "start": "541649",
    "end": "550350"
  },
  {
    "text": "this part this RK is a s1 or 28 ki n4 j",
    "start": "550350",
    "end": "556860"
  },
  {
    "text": "TT is stands for genetic attribute profile it's used to transfer data improve low energy and there's also one",
    "start": "556860",
    "end": "564240"
  },
  {
    "text": "read under 28 bit UID to add vast resources so maybe there's one ID for",
    "start": "564240",
    "end": "569670"
  },
  {
    "text": "device name one ID for battery level and for continuity that's there's actually a to specifically IDs oh sorry this is my",
    "start": "569670",
    "end": "578430"
  },
  {
    "text": "first start-up Arad and my English it is is a little rusty and let's have an",
    "start": "578430",
    "end": "584519"
  },
  {
    "text": "overview at cannoneer protocol so as shown here's the current products tag which",
    "start": "584519",
    "end": "592260"
  },
  {
    "text": "when we're phone tries to send a mass continuity message to the phone the",
    "start": "592260",
    "end": "597420"
  },
  {
    "text": "phone we actually uses created to to send message to to a host interface",
    "start": "597420",
    "end": "603569"
  },
  {
    "text": "which calls SGI and actually i will send its data to proof of D which is the program runs on a Mac or on a device",
    "start": "603569",
    "end": "611720"
  },
  {
    "text": "return call cause charity which is also a uses and process and if every process",
    "start": "611720",
    "end": "619560"
  },
  {
    "text": "every components which wants to support continuity will indeed hook with sharing",
    "start": "619560",
    "end": "625260"
  },
  {
    "text": "D and runtime and a sure D will actually exchange data with ideas framework and",
    "start": "625260",
    "end": "631860"
  },
  {
    "text": "if the message is encrypted then you will comment a message protection framework then if it's the creepiest",
    "start": "631860",
    "end": "640050"
  },
  {
    "text": "successfully then the certainty will indeed call the module which cooks with it so we can see that ideas framework is",
    "start": "640050",
    "end": "647790"
  },
  {
    "text": "indeed a integral part in this process and for ideas from work according to",
    "start": "647790",
    "end": "655110"
  },
  {
    "text": "white paper container messages are encrypted as a way similar with iMessage which is quite true and both Korea's IDs",
    "start": "655110",
    "end": "663790"
  },
  {
    "text": "ideas when work is a posterity service for every device and it is a you're",
    "start": "663790",
    "end": "669790"
  },
  {
    "text": "actually able to fetch any devices public key with corresponding for number or emails which is why you can send your",
    "start": "669790",
    "end": "676090"
  },
  {
    "text": "iMessage to to anyone you know if you have this phone number or email and for",
    "start": "676090",
    "end": "683860"
  },
  {
    "text": "encryption in cannoneer protocol JTD exchanges are actually encrypted as",
    "start": "683860",
    "end": "690180"
  },
  {
    "text": "mentioned prior alert keys are sent to iCloud and divas are boarding but do",
    "start": "690180",
    "end": "695560"
  },
  {
    "text": "know that private key usually will not leave the device in keys are actually",
    "start": "695560",
    "end": "700960"
  },
  {
    "text": "two is able to be extracted from device if you've managed to unlock the device keychain or manage to some some hacker",
    "start": "700960",
    "end": "708520"
  },
  {
    "text": "device and the encryption is actually a two-stage encryption the first stage is",
    "start": "708520",
    "end": "713710"
  },
  {
    "text": "I say 1 1 to 80 and secretary second stage is aes-128 so let's talk about the",
    "start": "713710",
    "end": "724540"
  },
  {
    "text": "current status of continuities security which ok and which we will be talking",
    "start": "724540",
    "end": "732310"
  },
  {
    "text": "about the most skilled most issues which might impact in daily life and I will",
    "start": "732310",
    "end": "738610"
  },
  {
    "text": "introduce two protocols briefly so we'll",
    "start": "738610",
    "end": "745960"
  },
  {
    "text": "be talking about airdrop which you can use it to send files to allied with I device without hassle and another",
    "start": "745960",
    "end": "752230"
  },
  {
    "text": "protocol is call relay which you can use it to make calls from another I device for airdrop where if your so as strong",
    "start": "752230",
    "end": "762600"
  },
  {
    "text": "device a device a is which you is sending a job from it will broadcast",
    "start": "762600",
    "end": "768160"
  },
  {
    "text": "hash of a party to another device if another device has a job set to a set Edwin Edwards airdrop or hash is no let",
    "start": "768160",
    "end": "776110"
  },
  {
    "text": "you eternal airdrop learn every job because L job is essentially a protocol based on wife a direct they will",
    "start": "776110",
    "end": "782440"
  },
  {
    "text": "establish a wife a direct connection exchange data and for current status of",
    "start": "782440",
    "end": "791080"
  },
  {
    "text": "adopting euro which is airdrop there's a couple of one over work done by - dude",
    "start": "791080",
    "end": "797330"
  },
  {
    "text": "- you Darmstadt it's called semen labs it stands for secure mobile networking",
    "start": "797330",
    "end": "802550"
  },
  {
    "text": "labs they actually found a few of quite few volunteer keys and I do have a wonderful work and they have an open",
    "start": "802550",
    "end": "809720"
  },
  {
    "text": "sorry implantation switch you can find the leaks here and the problems they found is in some cases you can track",
    "start": "809720",
    "end": "816769"
  },
  {
    "text": "users using end up deal in worst cases you can you can use it to me in the middle attack for example while you're",
    "start": "816769",
    "end": "823370"
  },
  {
    "text": "sending of cat photo to others the other device will indeed receive a doc photo instead of cat photo and for career day",
    "start": "823370",
    "end": "834310"
  },
  {
    "text": "there's a there's some previous work by Martin Vigo which I will put the links",
    "start": "834310",
    "end": "839329"
  },
  {
    "text": "up here later oh the case were in a previous slide sorry the call relay is it century when you",
    "start": "839329",
    "end": "848180"
  },
  {
    "text": "receive call about LTE or UMTS it goes to your iPhone and your phone will work whole iCloud says that there's an",
    "start": "848180",
    "end": "855170"
  },
  {
    "text": "incoming call and I call will indeed send this message to a local Mac or other device and should other devices",
    "start": "855170",
    "end": "862250"
  },
  {
    "text": "accept this call then you will establish a UDP connection to the Stifel and we can we can find out",
    "start": "862250",
    "end": "871910"
  },
  {
    "text": "that integration is really hard because there were numbers issues with call",
    "start": "871910",
    "end": "876980"
  },
  {
    "text": "relay before which fo has already fixed but in some cases they have fixed it and broke it broke again so for example like",
    "start": "876980",
    "end": "885260"
  },
  {
    "text": "we have found some Martine has found some found some issues like user interface inconsistency in handling of",
    "start": "885260",
    "end": "891620"
  },
  {
    "text": "relay calls which which in fact means that you can you can actually have a call which is like ended for you but in",
    "start": "891620",
    "end": "899510"
  },
  {
    "text": "fact it's not ended and you can spoof caller on multi-party calls and you can",
    "start": "899510",
    "end": "904940"
  },
  {
    "text": "end calls for another device and in worst case you can do FaceTime memory",
    "start": "904940",
    "end": "910970"
  },
  {
    "text": "corruption alright so we're done with",
    "start": "910970",
    "end": "916630"
  },
  {
    "text": "introduction then let's go into program implantation so for the next ten slides",
    "start": "916630",
    "end": "923209"
  },
  {
    "text": "we would represent most of time spent on its research and so it's like walking to",
    "start": "923209",
    "end": "929180"
  },
  {
    "text": "Mordor so for message where occasion and",
    "start": "929180",
    "end": "935450"
  },
  {
    "text": "decryption actually continuity is heavily an security framework which apple says that this framework is",
    "start": "935450",
    "end": "942200"
  },
  {
    "text": "obsolete and you should not reduce it any more but this is understandable",
    "start": "942200",
    "end": "947390"
  },
  {
    "text": "because obsolete doesn't mean that interpreting ask you to be rewritten and continuity itself is really a long while",
    "start": "947390",
    "end": "954230"
  },
  {
    "text": "ago maybe around iOS 8 and here's the major api's used in decryption toolbar",
    "start": "954230",
    "end": "960950"
  },
  {
    "text": "in Kuching is actually this the same thing so you can find it's to api's and",
    "start": "960950",
    "end": "966680"
  },
  {
    "text": "actually you'll find some wonderful API documentation sound APIs ever side and",
    "start": "966680",
    "end": "974800"
  },
  {
    "text": "here are actually a few FPS which is used furthermore in the decryption process and do no revocation doesn't run",
    "start": "974800",
    "end": "982640"
  },
  {
    "text": "if a lens is under 75 and this we saw this results were obtained through",
    "start": "982640",
    "end": "988760"
  },
  {
    "text": "combine use of a post profiler which will produce a stack trace and reversing",
    "start": "988760",
    "end": "994190"
  },
  {
    "text": "a post binary with goodra and you by using a or db2 either five functions which is quite normal for today the",
    "start": "994190",
    "end": "1000730"
  },
  {
    "text": "reverse engineering so in these functions you will find the raw payload from HTC I layer and you",
    "start": "1000730",
    "end": "1008020"
  },
  {
    "text": "will you will look how a verification function and the actual encryption",
    "start": "1008020",
    "end": "1013110"
  },
  {
    "text": "decryption story will be called if verification has passed and if a",
    "start": "1013110",
    "end": "1019090"
  },
  {
    "text": "decryption has failed then you will not go sorry if the murchison has failed",
    "start": "1019090",
    "end": "1024550"
  },
  {
    "text": "then the christian will not be wrong this will fail silently and for duty",
    "start": "1024550",
    "end": "1031420"
  },
  {
    "text": "stainless structure because i were praying with with a very big package in",
    "start": "1031420",
    "end": "1037990"
  },
  {
    "text": "continuity you can actually observe a total of 70 by over 700 by its package",
    "start": "1037990",
    "end": "1044530"
  },
  {
    "text": "when you're paying with hotspot so the data can be split into bottom o packets",
    "start": "1044530",
    "end": "1050380"
  },
  {
    "text": "payload length will be located everything-proof 0 x for the n20x 40",
    "start": "1050380",
    "end": "1056320"
  },
  {
    "text": "bytes from from the zoo x 480 by 2 n will be the payload path signature",
    "start": "1056320",
    "end": "1062200"
  },
  {
    "text": "and total F which you can use Wireshark you assemble a package for you the total",
    "start": "1062200",
    "end": "1067929"
  },
  {
    "text": "length will - payload length equals a signature length which tops out at around 72 pies for production",
    "start": "1067929",
    "end": "1079059"
  },
  {
    "text": "well the dirted exchange for decadent large 18 message exchange the messages",
    "start": "1079059",
    "end": "1084309"
  },
  {
    "text": "are signed by there were no no Mack are used and I message actually share ideas",
    "start": "1084309",
    "end": "1089710"
  },
  {
    "text": "with continuity and so for previous work by car by Garmin and others and the",
    "start": "1089710",
    "end": "1095710"
  },
  {
    "text": "chosen chosen cipher text attack and I message mentioned this that a couple in",
    "start": "1095710",
    "end": "1101950"
  },
  {
    "text": "table is used in iMessage but I didn't observe it in continuity so if you are",
    "start": "1101950",
    "end": "1107710"
  },
  {
    "text": "interested in these kind of issues you're welcome to check out Carmen's work so Apple actually did fix this",
    "start": "1107710",
    "end": "1115510"
  },
  {
    "text": "problem by hashing every payload and storage storing it in a message head store and while the device received to",
    "start": "1115510",
    "end": "1122380"
  },
  {
    "text": "engage a payload like it will fail fail silently and shown his message in console dot F for the data structure I",
    "start": "1122380",
    "end": "1131529"
  },
  {
    "text": "think this could be a most important slide in in the talk for the first one",
    "start": "1131529",
    "end": "1137830"
  },
  {
    "text": "assist device will be RSA encrypted payload the RSA key can actually be obtained through for keychain and for",
    "start": "1137830",
    "end": "1144789"
  },
  {
    "text": "the first 60 bytes will be a s21 28 key which you will need to use on a second",
    "start": "1144789",
    "end": "1150700"
  },
  {
    "text": "stage and for the rest of bytes will be what we call sacrifice a and for the",
    "start": "1150700",
    "end": "1156279"
  },
  {
    "text": "rest one is 60 bytes from the object or return message it will be what we call subtext P language assembles",
    "start": "1156279",
    "end": "1164260"
  },
  {
    "text": "suppressed ASRs B you have to decrypt it using AES 128 yard and the PK is set to",
    "start": "1164260",
    "end": "1169990"
  },
  {
    "text": "1 when you take away you will get a Drizzy payload learn when you answer the",
    "start": "1169990",
    "end": "1175029"
  },
  {
    "text": "plate you will receive the panel finished apparently this is essentially a box way",
    "start": "1175029",
    "end": "1180250"
  },
  {
    "text": "of speaking what a what a tick in pi pi pi thong is this is little spikes",
    "start": "1180250",
    "end": "1186190"
  },
  {
    "text": "utilized the method of encryption is somehow like what is described in garments work ms:i message there were",
    "start": "1186190",
    "end": "1193750"
  },
  {
    "text": "some differences and here's a little time to promote Nike",
    "start": "1193750",
    "end": "1199540"
  },
  {
    "text": "hub project actually currently this is a little scrip to pay with rock has only in the future I will pick our is that",
    "start": "1199540",
    "end": "1207340"
  },
  {
    "text": "the encryption codes and the encryption codes I can actually do the decryption",
    "start": "1207340",
    "end": "1212980"
  },
  {
    "text": "right now but it's not in a state which I'm certified to releasing in public",
    "start": "1212980",
    "end": "1218320"
  },
  {
    "text": "domain and also I plan to enable this project you in even a hot spot behavior",
    "start": "1218320",
    "end": "1226679"
  },
  {
    "text": "okay so time to introduce our attack scenario the attack the attack scenario",
    "start": "1226679",
    "end": "1234790"
  },
  {
    "text": "I propose an annuity which exploits parse imported different protocols and",
    "start": "1234790",
    "end": "1240360"
  },
  {
    "text": "for some of audiences that I assure you let this is not the end of a world and",
    "start": "1240360",
    "end": "1246100"
  },
  {
    "text": "we're actually cooperated we are how to fix feeds and as mentioned previously",
    "start": "1246100",
    "end": "1251130"
  },
  {
    "text": "that CB number has been assigned for partial other issues but as fo has and",
    "start": "1251130",
    "end": "1257770"
  },
  {
    "text": "wrote all those fixes we have to validate it after it was rolled out our",
    "start": "1257770",
    "end": "1263380"
  },
  {
    "text": "attacks some behaviors in continuity which might leaks device usage and",
    "start": "1263380",
    "end": "1269650"
  },
  {
    "text": "device identity and it will allow any adversaries to track stick device and in",
    "start": "1269650",
    "end": "1276760"
  },
  {
    "text": "some cases we are able to the analyzation so actually any people",
    "start": "1276760",
    "end": "1282400"
  },
  {
    "text": "who've low entry sniffer can serve as a tracking platform and here's overview of",
    "start": "1282400",
    "end": "1288580"
  },
  {
    "text": "our attacks and continuity so the prerequisite here we'll be talking about",
    "start": "1288580",
    "end": "1295450"
  },
  {
    "text": "format of continuity broadcast and where we can't talking about some type of some",
    "start": "1295450",
    "end": "1301270"
  },
  {
    "text": "privacy leaks we'll be talking about if I spring of renting which I can add a BIOS version in device type they I can",
    "start": "1301270",
    "end": "1308320"
  },
  {
    "text": "tell tell the device activity status your battery levels etc and in some",
    "start": "1308320",
    "end": "1314020"
  },
  {
    "text": "cases I can manage to break Meg randomization which renders this useless and I can actually spool packets but",
    "start": "1314020",
    "end": "1321490"
  },
  {
    "text": "this is not in an attack in its nature but it might prove useful in some use",
    "start": "1321490",
    "end": "1326830"
  },
  {
    "text": "cases so for culinary broadcast format you can",
    "start": "1326830",
    "end": "1332270"
  },
  {
    "text": "you can you can see it if you're using wireshark to capture packets it will be stored in indexed a section and for for",
    "start": "1332270",
    "end": "1339980"
  },
  {
    "text": "this broadcast the first byte will be the type ID and the second part would be the length and the others will be a",
    "start": "1339980",
    "end": "1346730"
  },
  {
    "text": "payload and multiple multiple broadcasts can be actually be concentrated into one",
    "start": "1346730",
    "end": "1353380"
  },
  {
    "text": "so when you see when you see two packets which starts with a same same format",
    "start": "1353380",
    "end": "1358940"
  },
  {
    "text": "that means multiple packets have been merged into one and for device",
    "start": "1358940",
    "end": "1364490"
  },
  {
    "text": "fingerprinting that's why I have a previous type here in some cases that",
    "start": "1364490",
    "end": "1369970"
  },
  {
    "text": "you can you can tell a device oh oh it's version or device type by looking at the L type field",
    "start": "1369970",
    "end": "1376150"
  },
  {
    "text": "it is because that if a device is is it it's not a printer apparently your phone",
    "start": "1376150",
    "end": "1381980"
  },
  {
    "text": "will not say that I'm able to print so when you see progress with with zero",
    "start": "1381980",
    "end": "1387680"
  },
  {
    "text": "X zero free IP that means that essentially it's a printer the same applies with Apple ID fo TV IDs and the",
    "start": "1387680",
    "end": "1395120"
  },
  {
    "text": "rest of the IDs is in akihabara poke and for I hand off Terrence ocean nearby",
    "start": "1395120",
    "end": "1401770"
  },
  {
    "text": "actually apple has released a wonderful support article which takes scribes that for which protocol you need you need",
    "start": "1401770",
    "end": "1409760"
  },
  {
    "text": "what is the version to run it and for",
    "start": "1409760",
    "end": "1415040"
  },
  {
    "text": "for accurate fingerprinting this will not be a prohibition on its own because",
    "start": "1415040",
    "end": "1420680"
  },
  {
    "text": "you have to actually connect your device and interrogated and this function is is quite abnormal so I think it cannot be",
    "start": "1420680",
    "end": "1428690"
  },
  {
    "text": "classified as a poor material itself but however if you manage to connect to the device interrogated and cadiz ma Geddes",
    "start": "1428690",
    "end": "1436400"
  },
  {
    "text": "manufacturer name string or mother name string then you will be able to do you know what make a model it is and for an",
    "start": "1436400",
    "end": "1446360"
  },
  {
    "text": "attribute called nearby this is a you can actually tell the OS version from",
    "start": "1446360",
    "end": "1452990"
  },
  {
    "text": "the format of a Wi-Fi field which is stated under sa a and there's a field",
    "start": "1452990",
    "end": "1459140"
  },
  {
    "text": "called iconic account location sherry about that doesn't do anything significant pal",
    "start": "1459140",
    "end": "1464899"
  },
  {
    "text": "there's a field called action code for action code you can tell whatever device is recently updated it has the lock",
    "start": "1464899",
    "end": "1471590"
  },
  {
    "text": "screen or if it has an active user or device is used by with a phone call or",
    "start": "1471590",
    "end": "1478309"
  },
  {
    "text": "FaceTime and for instant hotspots is",
    "start": "1478309",
    "end": "1484100"
  },
  {
    "text": "type 0 X 0 e which starts broadcasting effort that device under the same app ID",
    "start": "1484100",
    "end": "1489320"
  },
  {
    "text": "sense teri soch present which is type 0 X 0 T which can lift info on the",
    "start": "1489320",
    "end": "1496429"
  },
  {
    "text": "broadcast since you can tell its battery levels its from 0 to 0 X is 4 which",
    "start": "1496429",
    "end": "1502999"
  },
  {
    "text": "means 0 to 100 and you can tell it's stereotyped like it's in 4 4 2 3 3 it",
    "start": "1502999",
    "end": "1509419"
  },
  {
    "text": "has like eight types for signal quality so in fact you can replay and changeup",
    "start": "1509419",
    "end": "1518299"
  },
  {
    "text": "is within this hive I use super - I have the patch version of wood roof which I",
    "start": "1518299",
    "end": "1523549"
  },
  {
    "text": "will submit to the perfect for chat later but in my work I managed to change",
    "start": "1523549",
    "end": "1530239"
  },
  {
    "text": "some bytes and show different stereotypes but I can only do it with if",
    "start": "1530239",
    "end": "1536239"
  },
  {
    "text": "you know the devices pop America and this could be used for if you know a",
    "start": "1536239",
    "end": "1541249"
  },
  {
    "text": "phones Apple Mac and you want to use that information you find real hit device so it's a following we'll be",
    "start": "1541249",
    "end": "1553429"
  },
  {
    "text": "talking about how to pair a heartbreak magnet randomization",
    "start": "1553429",
    "end": "1558460"
  },
  {
    "text": "okay so for review our objective is to track device regardless of materialization and we can",
    "start": "1565940",
    "end": "1574080"
  },
  {
    "text": "break make rotation by a few means like nearby handoff and of course the RK",
    "start": "1574080",
    "end": "1580110"
  },
  {
    "text": "which is stated in specs and we can find connection between a private address and",
    "start": "1580110",
    "end": "1585659"
  },
  {
    "text": "a public address by using a normal country function let's take a look a",
    "start": "1585659",
    "end": "1592169"
  },
  {
    "text": "buffalo and respect the spec recommend recommends the rotation per 15 minutes",
    "start": "1592169",
    "end": "1597210"
  },
  {
    "text": "and actually I absurd a larger than 15 minutes interval on Apple devices but",
    "start": "1597210",
    "end": "1603059"
  },
  {
    "text": "that's okay since there were rotations but I was thinking about whether if",
    "start": "1603059",
    "end": "1609360"
  },
  {
    "text": "layers unaware two-track devices regardless of a place rotation so let's",
    "start": "1609360",
    "end": "1615480"
  },
  {
    "text": "talk about a type which are taught which I have talked about earlier which is nearby so this is essentially an output",
    "start": "1615480",
    "end": "1623039"
  },
  {
    "text": "of scripts on my github page and the payload found nearby is not changed immediately and the address rotation",
    "start": "1623039",
    "end": "1631259"
  },
  {
    "text": "list can be observed RS 12 but I upgraded my test machine to I was 14 and",
    "start": "1631259",
    "end": "1638370"
  },
  {
    "text": "this can be still observed so I can essentially track devices next render MAC address with the same payload in a",
    "start": "1638370",
    "end": "1645990"
  },
  {
    "text": "short period of time and let's check let's talk about handoff handoff is",
    "start": "1645990",
    "end": "1653519"
  },
  {
    "text": "stated as the type is do X Y or Z and you can move up States we could divide",
    "start": "1653519",
    "end": "1659669"
  },
  {
    "text": "seamlessly for example you have a nose app open on device a you can transfer transfer the node to another device",
    "start": "1659669",
    "end": "1666529"
  },
  {
    "text": "that's called next item SB and when you open device P you will see icon on your",
    "start": "1666529",
    "end": "1672539"
  },
  {
    "text": "main screen okay I told you open the nose app and you will you will be starting from trace when you left off",
    "start": "1672539",
    "end": "1678629"
  },
  {
    "text": "from device a and for handoff actually there's a field called clipboard which",
    "start": "1678629",
    "end": "1685320"
  },
  {
    "text": "can shows whether you have contents in your Universal Universal keep a clipboard and please know that there is",
    "start": "1685320",
    "end": "1692250"
  },
  {
    "text": "a field called counter which is consistent two bytes as four handles in the",
    "start": "1692250",
    "end": "1699030"
  },
  {
    "text": "penetration the payload field which is on the previous page the payload Lupino",
    "start": "1699030",
    "end": "1705150"
  },
  {
    "text": "is essentially an apps apps ID which is it used to identify where what kind of",
    "start": "1705150",
    "end": "1711780"
  },
  {
    "text": "app you want to use in handoff and this failure this is encrypted with aes-256",
    "start": "1711780",
    "end": "1718320"
  },
  {
    "text": "GCM mode the keys can be send where me to peer-to-peer or iCloud but there's",
    "start": "1718320",
    "end": "1725190"
  },
  {
    "text": "only one keeper device and there's no Tristan tag validation used in this",
    "start": "1725190",
    "end": "1730590"
  },
  {
    "text": "protocol and IV equals a counter field which I mentioned earlier is a to bad",
    "start": "1730590",
    "end": "1735960"
  },
  {
    "text": "field well this counter field is increment contrary which will go by one per action",
    "start": "1735960",
    "end": "1744000"
  },
  {
    "text": "for example when you go from your home screen to add it will increase by one when you go back for to a home screen",
    "start": "1744000",
    "end": "1749550"
  },
  {
    "text": "you will again plus one and when you reboot your device it will increase but",
    "start": "1749550",
    "end": "1756030"
  },
  {
    "text": "the exact number of increases by reboot is not sure but it's around 100 and when",
    "start": "1756030",
    "end": "1766050"
  },
  {
    "text": "when you're when you're ending handoff which means that you're going from F which supports handoff going to the home",
    "start": "1766050",
    "end": "1773190"
  },
  {
    "text": "screen your phone will broadcast a payload which consists of all zeros which is called goodbye from for the",
    "start": "1773190",
    "end": "1780270"
  },
  {
    "text": "cares of our output from the console app this counter will not reset between Macs",
    "start": "1780270",
    "end": "1787740"
  },
  {
    "text": "change and since this field is also used as IV I started to think that whether if",
    "start": "1787740",
    "end": "1795870"
  },
  {
    "text": "there is the IV reduce issue within its protocol since there's only two bytes",
    "start": "1795870",
    "end": "1801510"
  },
  {
    "text": "for me to prefers but in fact because lists field only costs up to like 50 50",
    "start": "1801510",
    "end": "1807690"
  },
  {
    "text": "thousand after the two-year usage of my phone I did some magical frames to make",
    "start": "1807690",
    "end": "1812730"
  },
  {
    "text": "this many scoundrel overflow and it will indeed rotate back to zero but a poetry",
    "start": "1812730",
    "end": "1820680"
  },
  {
    "text": "had think of it they have thought of this and the keys will rotate when IV reaches zero so no",
    "start": "1820680",
    "end": "1827389"
  },
  {
    "text": "one ring for me sorry but let's talk",
    "start": "1827389",
    "end": "1833659"
  },
  {
    "text": "about our K which we are taught earlier you can use the RK to add a VAT devised by is random at Redmond resolver address",
    "start": "1833659",
    "end": "1840859"
  },
  {
    "text": "the Erica changing is naturist absorb at all even after the device reset so if",
    "start": "1840859",
    "end": "1847549"
  },
  {
    "text": "you have a valid stalker which sold his phone to you and he indeed remember the",
    "start": "1847549",
    "end": "1852769"
  },
  {
    "text": "iron key from the device then he can use the phone he does so to you to stock you",
    "start": "1852769",
    "end": "1857959"
  },
  {
    "text": "forever as long as you keep that film this Erica can actually be retrieved in",
    "start": "1857959",
    "end": "1863389"
  },
  {
    "text": "Casselton Airport packet Locker and the RK is sing to another I device and devices provisioning process okay let's",
    "start": "1863389",
    "end": "1875479"
  },
  {
    "text": "talk about how to solve the connection between par with mega trees and popping MAC address so here's the hotspot flow",
    "start": "1875479",
    "end": "1884950"
  },
  {
    "text": "when when you are using a Mac and you want to come you want to use the Mac to connect your phone's hotspot you will",
    "start": "1884950",
    "end": "1891079"
  },
  {
    "text": "open your home Wi-Fi menu on your Mac your Mac will will start broadcasting a",
    "start": "1891079",
    "end": "1896450"
  },
  {
    "text": "type called Terry sauce tarantara presence which type ID has been mentioned earlier and the phone will",
    "start": "1896450",
    "end": "1902839"
  },
  {
    "text": "again broadcast 10 resource presence which means the phone is ready to to be",
    "start": "1902839",
    "end": "1909019"
  },
  {
    "text": "acted as a hotspot if the phone is in a state which is appropriate for a hotspot so for example when your phone has it",
    "start": "1909019",
    "end": "1916729"
  },
  {
    "text": "has no sink heart then you will not even up rockets this so should you decide to",
    "start": "1916729",
    "end": "1922879"
  },
  {
    "text": "connect to your phone by clicking clicking your phone in a Wi-Fi menu then",
    "start": "1922879",
    "end": "1927919"
  },
  {
    "text": "your Mac will establish a Bluetooth low-energy connection let two devices will exchange data to validations and",
    "start": "1927919",
    "end": "1935859"
  },
  {
    "text": "the phone will eventually send has potential specula Mac and then your Mac",
    "start": "1935859",
    "end": "1942229"
  },
  {
    "text": "receive these messages should decryption and validation checks out then you will",
    "start": "1942229",
    "end": "1947239"
  },
  {
    "text": "connect to the hotspot but there are quite a few problems here one because",
    "start": "1947239",
    "end": "1954159"
  },
  {
    "text": "when when the Mac wants to connect to the iPhone the Mac has to use this pop with MAC address to",
    "start": "1954159",
    "end": "1961769"
  },
  {
    "text": "- iPhones private mac address so you can learn a connection between between MX",
    "start": "1961769",
    "end": "1966989"
  },
  {
    "text": "public and private address and Anna phones private address and when when Mac",
    "start": "1966989",
    "end": "1973259"
  },
  {
    "text": "connects to the phone actually it because there's no any anomalous agen protocols in Wi-Fi so it must use the",
    "start": "1973259",
    "end": "1980849"
  },
  {
    "text": "private MAC address of both devices and since ever use ever is using programs",
    "start": "1980849",
    "end": "1987089"
  },
  {
    "text": "integrated Bluetooth Wi-Fi chip which means that a Wi-Fi improve is made into",
    "start": "1987089",
    "end": "1992459"
  },
  {
    "text": "the same truth the MAC address is close to each other by off by one so in this",
    "start": "1992459",
    "end": "1998609"
  },
  {
    "text": "case you're able to deduce above devices public and private Mac well so in a",
    "start": "1998609",
    "end": "2006349"
  },
  {
    "text": "world you if you manage have a bit of one and a high and Wi-Fi tango which",
    "start": "2006349",
    "end": "2013159"
  },
  {
    "text": "supports sniffing packets then you can look for tender instance presents which",
    "start": "2013159",
    "end": "2019099"
  },
  {
    "text": "appears effort error in target that which means that a device a which M is",
    "start": "2019099",
    "end": "2024549"
  },
  {
    "text": "carrying target is related to diversity which amazed high resource presence and",
    "start": "2024549",
    "end": "2030609"
  },
  {
    "text": "in this flow actually you can observe one permit Mac and pull both devices public Mac in order to prove itself you",
    "start": "2030609",
    "end": "2039859"
  },
  {
    "text": "have to actually sniffing both Bluetooth Low Energy when Wi-Fi and in order to learn the MAC addresses you you need to",
    "start": "2039859",
    "end": "2046309"
  },
  {
    "text": "look at a prop request and response after the proof of low energy connection",
    "start": "2046309",
    "end": "2052388"
  },
  {
    "text": "so let's have a quick look at our demos but my demo is quite short so it is what",
    "start": "2052389",
    "end": "2059750"
  },
  {
    "text": "we call contact contact roti Animas ation so let's switch to my demo",
    "start": "2059750",
    "end": "2067148"
  },
  {
    "text": "hmm all right",
    "start": "2072860",
    "end": "2077820"
  },
  {
    "text": "so here's the setup phase okay on the",
    "start": "2078980",
    "end": "2084138"
  },
  {
    "text": "top I have a Wi-Fi tango which I use total links and and 150 UA and on the",
    "start": "2084139",
    "end": "2090108"
  },
  {
    "text": "bottom I use but with one but which Wi-Fi dongle you're using doesn't matter and also you don't have to use it uber",
    "start": "2090109",
    "end": "2096378"
  },
  {
    "text": "tooth one for it so let's go through the setup phase which I way to connect so",
    "start": "2096379",
    "end": "2105260"
  },
  {
    "text": "now I connect your iPhone where a very hot spot under Malatesta Mac machine so",
    "start": "2105260",
    "end": "2113230"
  },
  {
    "text": "here's an example when when you open this menu your mango actually broadcast",
    "start": "2113230",
    "end": "2118460"
  },
  {
    "text": "hair in target presence lenguin the phone which is just called target zero",
    "start": "2118460",
    "end": "2124369"
  },
  {
    "text": "in here it reads it receives that broadcast and it was again sent back",
    "start": "2124369",
    "end": "2129859"
  },
  {
    "text": "Atari's terrorist source presence along with his signal levels and battery",
    "start": "2129859",
    "end": "2135680"
  },
  {
    "text": "levels and cellular type well should I click on that target zero",
    "start": "2135680",
    "end": "2141890"
  },
  {
    "text": "it will start trying to connect to that device so the Mac will try to connect to the",
    "start": "2141890",
    "end": "2148400"
  },
  {
    "text": "iPhone which will send a Connect connect underscore RQ with Mac's public address",
    "start": "2148400",
    "end": "2154490"
  },
  {
    "text": "who iPhones public MAC address which you can observe on here so let's wait for a",
    "start": "2154490",
    "end": "2165079"
  },
  {
    "text": "moment because it could take some time",
    "start": "2165079",
    "end": "2168970"
  },
  {
    "text": "all right so here's the info you are looking about so for Liz for it's zero",
    "start": "2171630",
    "end": "2177180"
  },
  {
    "text": "to Fred 527 it's related Wi-Fi address is zero to four thirty five twenty six",
    "start": "2177180",
    "end": "2182880"
  },
  {
    "text": "so you can actually got proper response with both devices polymeric and if you",
    "start": "2182880",
    "end": "2188880"
  },
  {
    "text": "managed to connect these two captures with each other then you can current correlate about both devices identity so",
    "start": "2188880",
    "end": "2198950"
  },
  {
    "text": "this will concludes my demo of contextual the authorizations okay let's",
    "start": "2198950",
    "end": "2210599"
  },
  {
    "text": "go back to our slides",
    "start": "2210599",
    "end": "2213410"
  },
  {
    "text": "okay so let's talk about a few practical considerations",
    "start": "2224340",
    "end": "2229580"
  },
  {
    "text": "well while you could wear well you are implementing a protocol actually you can",
    "start": "2229580",
    "end": "2236460"
  },
  {
    "text": "try to encrypt everything which is in the case about a pertinent tried",
    "start": "2236460",
    "end": "2241880"
  },
  {
    "text": "allocated for Apple the infrastructure for encrypted everything earlier already they have iCloud to publish keys to",
    "start": "2241880",
    "end": "2248190"
  },
  {
    "text": "every devices and for some someone might ask whatever they will run into",
    "start": "2248190",
    "end": "2253290"
  },
  {
    "text": "performance issues which I think that won't be okay is because we can observe that they're trying to encrypt",
    "start": "2253290",
    "end": "2258510"
  },
  {
    "text": "everything with handoff so it would be okay ish but you will not have",
    "start": "2258510",
    "end": "2264690"
  },
  {
    "text": "protection against any attack against iCloud because unless the keys are under in the iCloud and you will not be",
    "start": "2264690",
    "end": "2272130"
  },
  {
    "text": "permitted against any compromise I device because on the device I am bored into IDs",
    "start": "2272130",
    "end": "2277530"
  },
  {
    "text": "the keys are are sent through I call to every allow no device you have so in the",
    "start": "2277530",
    "end": "2282780"
  },
  {
    "text": "case that if you have both have a tool if you have two laptops and iPhone when",
    "start": "2282780",
    "end": "2288750"
  },
  {
    "text": "I compromise one over your one of our Macs and managed to extract the keys then I should be able to do some of the",
    "start": "2288750",
    "end": "2295950"
  },
  {
    "text": "messages and to added by all your devices and there are some",
    "start": "2295950",
    "end": "2301310"
  },
  {
    "text": "considerations with Wi-Fi and nominations which I will talk about later so for Wi-Fi analyzation which",
    "start": "2301310",
    "end": "2311820"
  },
  {
    "text": "unfortunately is doing draft you can find there's a presentation about this",
    "start": "2311820",
    "end": "2317460"
  },
  {
    "text": "this standard here but this thing is still on the draft and there's a",
    "start": "2317460",
    "end": "2323840"
  },
  {
    "text": "generalization in Android Q which which Coco has stated here maybe fo can take a",
    "start": "2323840",
    "end": "2330900"
  },
  {
    "text": "look at later pal I think in in a real world you might run through some issues",
    "start": "2330900",
    "end": "2336380"
  },
  {
    "text": "because some some companies might they might use Mac log on your Wi-Fi hotspot",
    "start": "2336380",
    "end": "2344180"
  },
  {
    "text": "so I think this will be near the end of my talk so that has some takeaways which",
    "start": "2344690",
    "end": "2352830"
  },
  {
    "text": "is called cracking sound bites so we English this talk I new approach arrived device tracking",
    "start": "2352830",
    "end": "2361610"
  },
  {
    "text": "sometimes the convenience will imply degrees of privacy hazards which has",
    "start": "2361610",
    "end": "2367500"
  },
  {
    "text": "happened to the continued protocol and the first I will recommend you to review",
    "start": "2367500",
    "end": "2373260"
  },
  {
    "text": "your information of new protocols carefully especially when you are integrating with another protocol which",
    "start": "2373260",
    "end": "2379230"
  },
  {
    "text": "is exactly what happened with continuity so thank you for coming to my talk and",
    "start": "2379230",
    "end": "2386730"
  },
  {
    "text": "this will be my email and my twitter handle should you have any questions feel free to to send a message to me and",
    "start": "2386730",
    "end": "2393720"
  },
  {
    "text": "Twitter or by my email thank you",
    "start": "2393720",
    "end": "2399250"
  },
  {
    "text": "[Applause]",
    "start": "2399250",
    "end": "2406500"
  }
]