[
  {
    "text": "hello everyone and welcome to this talk um so in this talk we will explain how",
    "start": "1719",
    "end": "7439"
  },
  {
    "text": "we found some vulnerabilities in leading bgp implementation and what are the",
    "start": "7439",
    "end": "14320"
  },
  {
    "text": "security implications so first a quick word about who we are um so this vulnerability",
    "start": "14320",
    "end": "23400"
  },
  {
    "text": "research work was done by stanislav daski Amin amri and Uso",
    "start": "23400",
    "end": "30759"
  },
  {
    "text": "uh and under the direction of Daniel uh and we all works at ver vs",
    "start": "30759",
    "end": "38239"
  },
  {
    "text": "which is a team at forcod Technologies and our mission includes vulnerability",
    "start": "38239",
    "end": "44800"
  },
  {
    "text": "research sweat research and thre intelligence um first uh so we already",
    "start": "44800",
    "end": "52879"
  },
  {
    "text": "presented the previous vulnerability research uh in particular we had the",
    "start": "52879",
    "end": "60079"
  },
  {
    "text": "project Memoria uh which is a an initiative in in which we analyzed 13",
    "start": "60079",
    "end": "68240"
  },
  {
    "text": "different TCP IP Stacks we that we found inside OT and iot devices and in total",
    "start": "68240",
    "end": "76240"
  },
  {
    "text": "we found 61 vulnerabilities and we were able to find",
    "start": "76240",
    "end": "82479"
  },
  {
    "text": "patterns uh in these vulnerabilities and we even published an",
    "start": "82479",
    "end": "88079"
  },
  {
    "text": "informal uh information RFC so RFC 92",
    "start": "88079",
    "end": "96840"
  },
  {
    "text": "9267 uh which is specifically about DNS",
    "start": "96840",
    "end": "103079"
  },
  {
    "text": "implementations um and in general we saw widespread problems in the parsing uh",
    "start": "103079",
    "end": "110920"
  },
  {
    "text": "and this is why we had the idea to look at bgp so uh first in this presentation",
    "start": "110920",
    "end": "118759"
  },
  {
    "text": "we're going to explain where and how bgp is used today and then we will PR",
    "start": "118759",
    "end": "125520"
  },
  {
    "text": "present our technique in finding the vulnerabilities and what we were able to",
    "start": "125520",
    "end": "131720"
  },
  {
    "text": "find but first let's talk about bgp thank you uh Simon so let's talk a",
    "start": "131720",
    "end": "139200"
  },
  {
    "text": "little bit about bgp I think that most people in this room already at least have a basic idea of what bgp is but",
    "start": "139200",
    "end": "145280"
  },
  {
    "text": "this days bgp is used not just as it's shown in the figure there uh to Route",
    "start": "145280",
    "end": "150959"
  },
  {
    "text": "data packets on the internet between different networks but it's also used in in in some different context and that's",
    "start": "150959",
    "end": "157040"
  },
  {
    "text": "what we want to to go over a little bit here but first the internet in a nutshell right so we have Edge devices",
    "start": "157040",
    "end": "162640"
  },
  {
    "text": "and we have routers that connect this Edge devices in different networks the research that um Simon mentioned before",
    "start": "162640",
    "end": "169519"
  },
  {
    "text": "was performed before in these it iot OT types of devices which are at the edge of these networks and basically um you",
    "start": "169519",
    "end": "177480"
  },
  {
    "text": "know run to the BP pack uh BP Stacks send and receive data packets to other",
    "start": "177480",
    "end": "182959"
  },
  {
    "text": "devices right but those data packets they go via routers that connect this these different networks and this research is about trying to understand a",
    "start": "182959",
    "end": "189879"
  },
  {
    "text": "bit better uh the the routing uh Stacks that goes into these into these routers so what is bgp it provides routing for",
    "start": "189879",
    "end": "196879"
  },
  {
    "text": "the internet right so it's a protocol to exchange routing uh enrich ability information among different autonomous",
    "start": "196879",
    "end": "202400"
  },
  {
    "text": "systems as's H H as is a a block of ips that is",
    "start": "202400",
    "end": "207560"
  },
  {
    "text": "Leed to an organization by a register uh for a certain time period and bgp is used to advertise this autonomous",
    "start": "207560",
    "end": "213959"
  },
  {
    "text": "systems numbers and to peer networks that are each part of of a different uh as right and bgp can used can be used",
    "start": "213959",
    "end": "220799"
  },
  {
    "text": "internally uh to appearer uh um within the same autonomous systems and that's",
    "start": "220799",
    "end": "226280"
  },
  {
    "text": "called internal bgp or externally external bgp peers on the internet different autonomous systems and bgp",
    "start": "226280",
    "end": "232760"
  },
  {
    "text": "makes routing decisions based on paths Network policies and Rule sets to basically find the the best way to to to",
    "start": "232760",
    "end": "239040"
  },
  {
    "text": "send a packet from one um device one host on the network to another one in in",
    "start": "239040",
    "end": "244360"
  },
  {
    "text": "potentially a different network on the other side of the world um and again this is what people know um about bgp",
    "start": "244360",
    "end": "252079"
  },
  {
    "text": "very well and and and historically what it has been used for but these days there are some other different use cases",
    "start": "252079",
    "end": "257759"
  },
  {
    "text": "of bgp um that leverage the same protocol the same capabilities for U",
    "start": "257759",
    "end": "263000"
  },
  {
    "text": "more uh um internal more organization or let's say use cases things like internal",
    "start": "263000",
    "end": "268520"
  },
  {
    "text": "data center routing right so data centers have grown massively in the past decades to the point that pgp is used",
    "start": "268520",
    "end": "275039"
  },
  {
    "text": "internally to Route packets within um these data centers um it's also used these days for",
    "start": "275039",
    "end": "280840"
  },
  {
    "text": "vpns uh layer Tre vpns uh using MLS so across different organization sites",
    "start": "280840",
    "end": "286080"
  },
  {
    "text": "right so within the same uh organization U across different sites to set up a VPN",
    "start": "286080",
    "end": "291520"
  },
  {
    "text": "this uh this protocol is is used it's also embedded in custom appliances right there are appliances by companies such",
    "start": "291520",
    "end": "297960"
  },
  {
    "text": "as um Netflix for instance that uh you know deal with some specific type of traffic they are put on the on the on",
    "start": "297960",
    "end": "304800"
  },
  {
    "text": "the isps data centers in some cases and they have and baded bgp implementations as well and there are other use cases",
    "start": "304800",
    "end": "310680"
  },
  {
    "text": "emerging use cases like load balancing and and and a lot of other stuff so we just want to um you know reiterate that",
    "start": "310680",
    "end": "317400"
  },
  {
    "text": "pgps these days not just for Internet service providers and internet exchanges",
    "start": "317400",
    "end": "322560"
  },
  {
    "text": "as uh people still probably think a lot about uh bgp so the basics of the",
    "start": "322560",
    "end": "328440"
  },
  {
    "text": "protocol right mentioned what it's used for but how it's actually implemented very quickly in a nutshell it's a simple",
    "start": "328440",
    "end": "334319"
  },
  {
    "text": "State machine where peers uh um they're basically in in an idle waiting State",
    "start": "334319",
    "end": "341360"
  },
  {
    "text": "then they set up a connection and Pi sent keep alive connection every X",
    "start": "341360",
    "end": "346800"
  },
  {
    "text": "seconds to to make sure that the connection is is still open and from time to time they um they send uh",
    "start": "346800",
    "end": "353759"
  },
  {
    "text": "messages to update the routing tables of the of the of the other peers right so it's a somewhat simple you can see the",
    "start": "353759",
    "end": "360000"
  },
  {
    "text": "whole the whole state machine there there are three four five six states uh there's a limited set of messages as I",
    "start": "360000",
    "end": "365800"
  },
  {
    "text": "mentioned it's open update the the the the routes send a notification if there is any error or keep",
    "start": "365800",
    "end": "371840"
  },
  {
    "text": "alive uh and the packets are also relatively straightforward right you have a a header uh that has that marker",
    "start": "371840",
    "end": "378440"
  },
  {
    "text": "length and type and then you have uh the actual content of the message which has the the header and the and and the",
    "start": "378440",
    "end": "383800"
  },
  {
    "text": "content um uh below that uh with some optional uh parameters so what",
    "start": "383800",
    "end": "389599"
  },
  {
    "text": "potentially could go wrong right it's not a very super complicated um protocol if you look at it this way but",
    "start": "389599",
    "end": "396479"
  },
  {
    "text": "historically and and again this is going back to what people typically talk about uh bgp bgp has no building security per",
    "start": "396479",
    "end": "404759"
  },
  {
    "text": "se right like DNS like many other uh you know early protocol in the internet um",
    "start": "404759",
    "end": "410319"
  },
  {
    "text": "so there's no authentication authorization mechanism kind of built into the the the original protocol uh so",
    "start": "410319",
    "end": "416120"
  },
  {
    "text": "there are mistakes or intentional attacks that lead to network out to and traffic redirection when um autonomous",
    "start": "416120",
    "end": "423120"
  },
  {
    "text": "systems or or rout routers actually advertise uh IPS blocks of ips that they",
    "start": "423120",
    "end": "428280"
  },
  {
    "text": "are not actually responsible for right and there are hijacks and leaks and again this is something that has been",
    "start": "428280",
    "end": "434840"
  },
  {
    "text": "discussed for for uh many years when networks are originating that's the the",
    "start": "434840",
    "end": "440000"
  },
  {
    "text": "the bgp jargon a prefix that is owned by another Network without the permission of their Network and sometimes",
    "start": "440000",
    "end": "445879"
  },
  {
    "text": "propagating that routing announcement Beyond its intendent scope and it's been known for a long time but still there",
    "start": "445879",
    "end": "451479"
  },
  {
    "text": "are potentially thousands of incidents per year right and there are organizations that track this these",
    "start": "451479",
    "end": "456520"
  },
  {
    "text": "incidents they happen uh frequently less frequently than in the past but still somewhat frequently and there are from",
    "start": "456520",
    "end": "462879"
  },
  {
    "text": "time to time uh big cases that lead us to wonder you know if if it's a",
    "start": "462879",
    "end": "468000"
  },
  {
    "text": "potential attack uh or not right when when countries China and Russia are involved in in in in the headlines that",
    "start": "468000",
    "end": "474960"
  },
  {
    "text": "you see uh there on the slide so traditional bgp security with all that in mind has typically dealt with",
    "start": "474960",
    "end": "481680"
  },
  {
    "text": "filtering incorrect or malicious routing information right so you have nowadays lots of techniques and ideas that are",
    "start": "481680",
    "end": "488520"
  },
  {
    "text": "being implemented slowly because as everything in the in the um internet",
    "start": "488520",
    "end": "493680"
  },
  {
    "text": "infrastructure this takes a lot of effort and implementation from this different isps people to to to agree and",
    "start": "493680",
    "end": "499560"
  },
  {
    "text": "coordinate on implementations and so on but these things are being implemented right aring validation path validation",
    "start": "499560",
    "end": "504800"
  },
  {
    "text": "using things like rpki so basically verifying that when whenever a network",
    "start": "504800",
    "end": "510159"
  },
  {
    "text": "announces a route it is actually somewhat authorized to do so but in all",
    "start": "510159",
    "end": "515440"
  },
  {
    "text": "of this context we see that there is not often too much discussion about vulnerabilities in bgp implementations",
    "start": "515440",
    "end": "522200"
  },
  {
    "text": "right rather than talking about the protocol per se and how to add new features uh to it um as Simone was",
    "start": "522200",
    "end": "530080"
  },
  {
    "text": "discussing before we see that a lot of parsing in other protocols in top STX for instance is done or historically has",
    "start": "530080",
    "end": "536519"
  },
  {
    "text": "been done in a way that has led to bugs and we don't see too much discussion on on bgp implementations about that there",
    "start": "536519",
    "end": "543120"
  },
  {
    "text": "are instances already where bgp has failed uh because of software flow so",
    "start": "543120",
    "end": "548320"
  },
  {
    "text": "not bgp the protocol itself but bgp an implementation of bgp so basically the the use of the protocol on",
    "start": "548320",
    "end": "554480"
  },
  {
    "text": "the internet has failed because of software flaws there was an experiment uh in 2019 where uh some",
    "start": "554480",
    "end": "561200"
  },
  {
    "text": "researchers were trying some new uh some new features of bgp that was not supported and they were using the F rou",
    "start": "561200",
    "end": "566240"
  },
  {
    "text": "in implementation which we'll discuss a little bit more in the rest of the presentation and that was supported by a",
    "start": "566240",
    "end": "571440"
  },
  {
    "text": "a subset of routers not by others and basically that took down some routers that couldn't process some messages and",
    "start": "571440",
    "end": "577880"
  },
  {
    "text": "you know it led to some crashes of course in the end the internet recovers and and things go go go back to working",
    "start": "577880",
    "end": "583399"
  },
  {
    "text": "but for a limited period of time there is an outage caused by by software flaws so in NHL why do we want to research",
    "start": "583399",
    "end": "590880"
  },
  {
    "text": "these BG implementations then the latest systematized work that we found about",
    "start": "590880",
    "end": "596040"
  },
  {
    "text": "testing pgp implementations was actually 20 years ago here at blackhe hat um and",
    "start": "596040",
    "end": "601519"
  },
  {
    "text": "I invite you to have a look at that talk it's it's a very interesting talk and it was a team at Cisco that looked at",
    "start": "601519",
    "end": "606880"
  },
  {
    "text": "implementations and configurations of bgp across U some vendors they like us",
    "start": "606880",
    "end": "612079"
  },
  {
    "text": "created a fuzzer but that was um 20 years ago and analyzed seven implementations and found four new CVS",
    "start": "612079",
    "end": "619200"
  },
  {
    "text": "but at that time they concluded that misconfigurations on bgpu were more dangerous than implementation issues",
    "start": "619200",
    "end": "624399"
  },
  {
    "text": "right so again all the all the stuff about origin and path validation and so on that we disc discussed before we also",
    "start": "624399",
    "end": "630800"
  },
  {
    "text": "saw some research uh in 2007 uh from a team at Juniper that analyzed the update",
    "start": "630800",
    "end": "636440"
  },
  {
    "text": "message handling uh specifically update messages in several vendors and again have a look at their at their work uh",
    "start": "636440",
    "end": "644399"
  },
  {
    "text": "the main uh result of that was uh the finding that mishandling can lead to",
    "start": "644399",
    "end": "649639"
  },
  {
    "text": "some denial of of service there were seven vendors affected 10 that this declared not to be affected and 25 that",
    "start": "649639",
    "end": "656680"
  },
  {
    "text": "were uh actually unknown they didn't didn't uh answer to the to the disclosure but in this meantime there",
    "start": "656680",
    "end": "663320"
  },
  {
    "text": "are in the nvd 129 CVS on digp implementation some including uh remote",
    "start": "663320",
    "end": "668880"
  },
  {
    "text": "code executions right and 123 of those based on our analysis actually have to do with message parsing issues 95% of",
    "start": "668880",
    "end": "677079"
  },
  {
    "text": "the vulnerabilities there have to do with parsing of bgp um messages so if we",
    "start": "677079",
    "end": "682279"
  },
  {
    "text": "drill down a little bit into these previous vulnerabilities we see that there are a few vendors that are",
    "start": "682279",
    "end": "688160"
  },
  {
    "text": "represented uh uh with a higher number of vulnerabilities there it doesn't mean that those vendors are more vulnerable",
    "start": "688160",
    "end": "694000"
  },
  {
    "text": "of course I mean whenever we talk about vulnerability disclosure that I believe that's obious for everybody but it just means that those vendors maybe are more",
    "start": "694000",
    "end": "700600"
  },
  {
    "text": "transparent or maybe are doing more research in their own protocols or maybe because you know they are major vendors",
    "start": "700600",
    "end": "705920"
  },
  {
    "text": "people are looking at their uh at those implementations more but you see that Juniper Cisco um are are the vendors",
    "start": "705920",
    "end": "712680"
  },
  {
    "text": "that have the largest number of vabes there and that's followed by uh F routing uh which again I mentioned",
    "start": "712680",
    "end": "718519"
  },
  {
    "text": "before and we'll talk about later and its pre predecessor quag so F routing is a is a fork of an open source project",
    "start": "718519",
    "end": "725519"
  },
  {
    "text": "called uh quag and then you have some other uh open source and closed source implementations as well most of these",
    "start": "725519",
    "end": "732040"
  },
  {
    "text": "vulnerabilities actually lead to denials of service 82% of them and some others can lead to information leaks uh remote",
    "start": "732040",
    "end": "738639"
  },
  {
    "text": "code execution authentication bypasses and and and other types of um of impacts",
    "start": "738639",
    "end": "744440"
  },
  {
    "text": "and we see also interestingly that from 2017 onwards there is a of a spike in",
    "start": "744440",
    "end": "749720"
  },
  {
    "text": "the disclosure of these uh vulnerabilities it's not entirely clear if it's because um more researchers were",
    "start": "749720",
    "end": "756639"
  },
  {
    "text": "looking at it or more vendors or both but the fact is that from 2017 there",
    "start": "756639",
    "end": "762040"
  },
  {
    "text": "seems to be a bit more interest in this type of vulnerability in bgp implementations and if we look not just at the vulnerability research but at the",
    "start": "762040",
    "end": "768440"
  },
  {
    "text": "threat landscape per se uh it's it it became very very clear this year it's",
    "start": "768440",
    "end": "774320"
  },
  {
    "text": "been clear for for a few years uh for sure but it became very very clear this year that thread actors have been focusing on network infrastructure very",
    "start": "774320",
    "end": "781519"
  },
  {
    "text": "heavily right so we have state sponsored actors you have cesa alerts there that deal with state sponsored actors looking",
    "start": "781519",
    "end": "787279"
  },
  {
    "text": "at uh Network infrastructure and when I say Network infrastructure it means routers firewalls anything that is",
    "start": "787279",
    "end": "792720"
  },
  {
    "text": "exposed directly and providing the basic um layers for infrastructure for networking in an organization and it's",
    "start": "792720",
    "end": "800120"
  },
  {
    "text": "not just state sponsored actors right you also have Ransom groups cyber criminals activists and so on actually",
    "start": "800120",
    "end": "805760"
  },
  {
    "text": "very recently uh a couple of months ago there was a binding operational directive from cesa uh talking about",
    "start": "805760",
    "end": "812120"
  },
  {
    "text": "mitigating risks of exposed management uh interfaces um uh of network infrastructure specifically and we see",
    "start": "812120",
    "end": "819079"
  },
  {
    "text": "that there are still several bgp implementations that were not systematically analyzed and there are open bgp implementations that are",
    "start": "819079",
    "end": "824560"
  },
  {
    "text": "gaining very uh they're became very Pro popular right gaining traction with a new or somewhat new uh uh Trend called",
    "start": "824560",
    "end": "832079"
  },
  {
    "text": "nfg or network function disaggregation so basically basically nowadays it's",
    "start": "832079",
    "end": "837320"
  },
  {
    "text": "more popular or it's become more popular that the hardware and the software uh in",
    "start": "837320",
    "end": "842639"
  },
  {
    "text": "in a network Appliance such as a router are provided by different vendors or kind of mixed and matched rather than",
    "start": "842639",
    "end": "848199"
  },
  {
    "text": "the traditional uh model where the software the hardware everything was provided by a major vendor as one uh one",
    "start": "848199",
    "end": "854120"
  },
  {
    "text": "piece of of equipment right so there are many different implementations of routing platforms Network operating",
    "start": "854120",
    "end": "859920"
  },
  {
    "text": "systems Looking Glass servers and other routing components that uh that haven't been analyzed as I mentioned in the",
    "start": "859920",
    "end": "865680"
  },
  {
    "text": "previous point so we cataloged actually 52 different routing protocols 40 of them are open 12 are actually closed 20",
    "start": "865680",
    "end": "873000"
  },
  {
    "text": "routing platforms 17 uh open and and three closed and 53 different network",
    "start": "873000",
    "end": "878320"
  },
  {
    "text": "operating systems out of those uh 20 were open so we had to really narrow down the scope of this Research into",
    "start": "878320",
    "end": "884360"
  },
  {
    "text": "what we wanted to do and just to uh go a little bit further into the threat",
    "start": "884360",
    "end": "889480"
  },
  {
    "text": "landscape right cisa also maintains a catalog of non- exploited vulnerabilities and if we look most of",
    "start": "889480",
    "end": "895680"
  },
  {
    "text": "the vulnerabilities out there are actually affecting typical software like Windows Linux Mac OS and things",
    "start": "895680",
    "end": "902079"
  },
  {
    "text": "like that but 179 of those vulnerabilities can be mapped to specific types of devices such as",
    "start": "902079",
    "end": "907320"
  },
  {
    "text": "routers right and out of those 88 actually affect routers so 49% of the",
    "start": "907320",
    "end": "912600"
  },
  {
    "text": "vulnerabilities that we looked at that can be mapped to specific devices are mapped to routers um and there has been",
    "start": "912600",
    "end": "919800"
  },
  {
    "text": "some past Research into why routers are so popular uh uh um an attack Vector",
    "start": "919800",
    "end": "925680"
  },
  {
    "text": "it's pretty obvious right because they are internet facing and they can provide a very good initial access point into an",
    "start": "925680",
    "end": "931360"
  },
  {
    "text": "organization but I I invite you to have a look at those uh those presentations as well and uh the last slide of this of",
    "start": "931360",
    "end": "939240"
  },
  {
    "text": "this kind of contextualization part out of those 88 vulnerabilities we also see that three vulnerabilities are CVS",
    "start": "939240",
    "end": "946560"
  },
  {
    "text": "affecting uh Cisco bgp implementations that are they were added to the cesa catalog in 2022 so they were being",
    "start": "946560",
    "end": "952360"
  },
  {
    "text": "actively exploited into 2022 and they some of them are actually kind of decades old right from 2010 2009 so it's",
    "start": "952360",
    "end": "959839"
  },
  {
    "text": "not like just the latest and greatest popular vulnerabilities that are being exploited but things that are more than 10 years old still affecting uh routers",
    "start": "959839",
    "end": "966880"
  },
  {
    "text": "out there and still being uh exploited by by um by trade actors we also saw two",
    "start": "966880",
    "end": "972240"
  },
  {
    "text": "other denial service on um on Cisco implementations but they are affecting a different protocol called dvmrp",
    "start": "972240",
    "end": "980240"
  },
  {
    "text": "and that was it for this part so let's see how we actually found some new stuff yes so no we took first about the",
    "start": "980240",
    "end": "989319"
  },
  {
    "text": "methodology of what we did to find these vulnerabilities so for this analysis we",
    "start": "989319",
    "end": "996720"
  },
  {
    "text": "first looked at the implementations where previous researchers from the",
    "start": "996720",
    "end": "1003160"
  },
  {
    "text": "vulnerabilities and uh then we looked at the most popular bgp",
    "start": "1003160",
    "end": "1008440"
  },
  {
    "text": "implementations and uh so this led us to select multiple implementations both",
    "start": "1008440",
    "end": "1015040"
  },
  {
    "text": "both open source and and closed source um and uh for the actual analysis uh we",
    "start": "1015040",
    "end": "1023360"
  },
  {
    "text": "used the previous knowledge of vulnerability research and network",
    "start": "1023360",
    "end": "1030160"
  },
  {
    "text": "protocols and we also looked at RFC non compliance uh and uh of course for",
    "start": "1030160",
    "end": "1038120"
  },
  {
    "text": "closed Source implementations it was more difficult uh to look for the uh",
    "start": "1038120",
    "end": "1045360"
  },
  {
    "text": "vulnerability patterns that we knew uh so we decided to use the fer in the end",
    "start": "1045360",
    "end": "1051480"
  },
  {
    "text": "and uh actually we ended up using the fer also for open source",
    "start": "1051480",
    "end": "1057679"
  },
  {
    "text": "implementation so uh there are some uh specific anti patterns that we found",
    "start": "1057679",
    "end": "1064240"
  },
  {
    "text": "during this research uh some of them are directly protocol issues uh so first we",
    "start": "1064240",
    "end": "1072000"
  },
  {
    "text": "have the bgp messages that use type length value fields which means passing",
    "start": "1072000",
    "end": "1079200"
  },
  {
    "text": "is more prone to errors and another common issue is the possibility",
    "start": "1079200",
    "end": "1085840"
  },
  {
    "text": "of optional parameters so again it's something that",
    "start": "1085840",
    "end": "1090880"
  },
  {
    "text": "is sometimes not handled correctly as we will see in the vulnerabilities that we",
    "start": "1090880",
    "end": "1096679"
  },
  {
    "text": "found and an interesting thing to know is that most of the time the bgp PE so",
    "start": "1096679",
    "end": "1107360"
  },
  {
    "text": "the yes so the PE they answer to any open message",
    "start": "1107360",
    "end": "1114960"
  },
  {
    "text": "and because open message is actually used to establish bgp peing so bgp",
    "start": "1114960",
    "end": "1122200"
  },
  {
    "text": "connection uh and uh sometimes they also accept update messages without prior",
    "start": "1122200",
    "end": "1130679"
  },
  {
    "text": "peering and since this is a stateful protocol as Daniel explained uh it is uh",
    "start": "1130679",
    "end": "1139039"
  },
  {
    "text": "it can be difficult to do the exception handling and the passing also is more PR",
    "start": "1139039",
    "end": "1146400"
  },
  {
    "text": "to errors and so in then we focused mostly on open and update messages because as",
    "start": "1146400",
    "end": "1154080"
  },
  {
    "text": "we so that can sometime be passed uh before uh having a previous bgp",
    "start": "1154080",
    "end": "1160960"
  },
  {
    "text": "connection established so for open Messages we",
    "start": "1160960",
    "end": "1166640"
  },
  {
    "text": "compared some implementations and we found a few things uh first in most",
    "start": "1166640",
    "end": "1172200"
  },
  {
    "text": "cases the bgp demon runs in user mode uh which means that there is always a",
    "start": "1172200",
    "end": "1178559"
  },
  {
    "text": "complete TCP handshake uh before rejection because uh the TCP handshake",
    "start": "1178559",
    "end": "1186039"
  },
  {
    "text": "is handled by the Kel so an application",
    "start": "1186039",
    "end": "1191080"
  },
  {
    "text": "running in user mode cannot block the connection before the TCP hand check is",
    "start": "1191080",
    "end": "1197000"
  },
  {
    "text": "done and the so this is true except for Cisco",
    "start": "1197000",
    "end": "1202400"
  },
  {
    "text": "iOS uh and the second interesting thing is that the particular implementation",
    "start": "1202400",
    "end": "1210120"
  },
  {
    "text": "called the FR routing uh use does some processing of the open",
    "start": "1210120",
    "end": "1217400"
  },
  {
    "text": "message before the pier is validated because in the open message you have",
    "start": "1217400",
    "end": "1222440"
  },
  {
    "text": "specific fields that allow for the identification of the pier that is trying to connect but fting does not do",
    "start": "1222440",
    "end": "1231640"
  },
  {
    "text": "uh does do some passing of the open message before this check",
    "start": "1231640",
    "end": "1237000"
  },
  {
    "text": "um and so now about the phasing we did uh so first a quick word about phasing",
    "start": "1237000",
    "end": "1244280"
  },
  {
    "text": "so the goal is to give general direction to a program that will do the",
    "start": "1244280",
    "end": "1250080"
  },
  {
    "text": "vulnerability uh testing for us it will generate uh random payloads uh that look",
    "start": "1250080",
    "end": "1258120"
  },
  {
    "text": "look like real bgp packets um but the",
    "start": "1258120",
    "end": "1263640"
  },
  {
    "text": "specific Fields inside the payloads are either randomly generated or set to uh",
    "start": "1263640",
    "end": "1270480"
  },
  {
    "text": "problematic values uh and uh we run this program in",
    "start": "1270480",
    "end": "1275919"
  },
  {
    "text": "infinite Loop and we just wait for the Target to crash so during the making of This fer",
    "start": "1275919",
    "end": "1283760"
  },
  {
    "text": "we could not find any open source bgp further uh so we use the bers which is a",
    "start": "1283760",
    "end": "1291120"
  },
  {
    "text": "a framework used to create fs and after making this Feer we only need",
    "start": "1291120",
    "end": "1299279"
  },
  {
    "text": "to have the bgp demon running uh for example in the virtual machine and uh",
    "start": "1299279",
    "end": "1307279"
  },
  {
    "text": "we then the fer will establish a connection with bgp demon and try payloads until",
    "start": "1307279",
    "end": "1315919"
  },
  {
    "text": "the bgp demon demon crash crashes so here is the demo video of the",
    "start": "1315919",
    "end": "1322840"
  },
  {
    "text": "further running so on the right you can see the you will see the bgp demon",
    "start": "1322840",
    "end": "1330000"
  },
  {
    "text": "running and the terminal on the left will be the fer running um and so so now",
    "start": "1330000",
    "end": "1338360"
  },
  {
    "text": "you have the bgp demon running on the right and now the fer is going to be",
    "start": "1338360",
    "end": "1346200"
  },
  {
    "text": "launched now it's Malone packets in a",
    "start": "1346200",
    "end": "1351320"
  },
  {
    "text": "loop and uh and we it will soon cause a crash in",
    "start": "1351320",
    "end": "1357000"
  },
  {
    "text": "the bgp demon so now it crashed and uh as you",
    "start": "1357000",
    "end": "1365120"
  },
  {
    "text": "can see the bgp demon restarted automatically because the phing is automated but uh in this case we uh also",
    "start": "1365120",
    "end": "1374000"
  },
  {
    "text": "on the left you can see that the further generated file uh that contains the",
    "start": "1374000",
    "end": "1379279"
  },
  {
    "text": "specific payload that made the bgp demon crush and now we're going to launch",
    "start": "1379279",
    "end": "1385200"
  },
  {
    "text": "again the bgp demand but this time inside the debugger so we can find the root of the",
    "start": "1385200",
    "end": "1392360"
  },
  {
    "text": "issue okay so now the bgp demon is running again in the debuger we're going",
    "start": "1397880",
    "end": "1403600"
  },
  {
    "text": "to execute the payload that made it crash the first time",
    "start": "1403600",
    "end": "1409880"
  },
  {
    "text": "and now it crashed again so we are going to look at the back Trace to see what",
    "start": "1412600",
    "end": "1419360"
  },
  {
    "text": "happened and uh you you cannot see it but it's a function that was called inside",
    "start": "1420320",
    "end": "1427679"
  },
  {
    "text": "the function called bgp open receive which is a function that contains the",
    "start": "1427679",
    "end": "1433320"
  },
  {
    "text": "open message passing uh so it shows that there is an issue in the passing of open messages in",
    "start": "1433320",
    "end": "1440480"
  },
  {
    "text": "this bgpd mod so in total we quickly found three",
    "start": "1440480",
    "end": "1446880"
  },
  {
    "text": "issues using the feather and they were all due to wrong passing of the bgp open",
    "start": "1446880",
    "end": "1453440"
  },
  {
    "text": "messages and what is interesting to mention is that these issues are very similar to other vulnerabilities that",
    "start": "1453440",
    "end": "1460640"
  },
  {
    "text": "were previously found in the Cisco iOS and also we wanted to mention that it",
    "start": "1460640",
    "end": "1467440"
  },
  {
    "text": "was really easy for us to report these vulnerabilities and they they were fixed",
    "start": "1467440",
    "end": "1474000"
  },
  {
    "text": "very quickly by the F routing team uh and because it's a open",
    "start": "1474000",
    "end": "1481120"
  },
  {
    "text": "source project and uh now we're going to see the vulnerabilities in detail so the",
    "start": "1481120",
    "end": "1488200"
  },
  {
    "text": "first issue uh was in the bgp open receip function and uh actually there",
    "start": "1488200",
    "end": "1494080"
  },
  {
    "text": "are two issues because uh there is a check online four that checks is a a parameter called",
    "start": "1494080",
    "end": "1504159"
  },
  {
    "text": "extended optional parameter length um is",
    "start": "1504159",
    "end": "1509360"
  },
  {
    "text": "present in the bgp packet um and uh we can pass this check if the",
    "start": "1509360",
    "end": "1515880"
  },
  {
    "text": "bite at this if this bite is equal to FF and uh",
    "start": "1515880",
    "end": "1523840"
  },
  {
    "text": "it will cause the rid of the next next bite of the packet but uh there is never",
    "start": "1523840",
    "end": "1530240"
  },
  {
    "text": "a check to see if actually the packet contains something after the length bite",
    "start": "1530240",
    "end": "1537440"
  },
  {
    "text": "so in this case we can read one bite beyond the packet and uh then just below",
    "start": "1537440",
    "end": "1544440"
  },
  {
    "text": "you have another check which is exactly the same thing but this time it's",
    "start": "1544440",
    "end": "1549520"
  },
  {
    "text": "reading two bytes after the packet uh so",
    "start": "1549520",
    "end": "1555279"
  },
  {
    "text": "it's a single dis uh for the next one it's uh also due to",
    "start": "1555279",
    "end": "1562080"
  },
  {
    "text": "the optional parameters um so this time it's the",
    "start": "1562080",
    "end": "1567720"
  },
  {
    "text": "issue that we Sol that we saw in the video um so it is in the P for is4",
    "start": "1567720",
    "end": "1574799"
  },
  {
    "text": "capability function which was called by the bgp open receive function and it's",
    "start": "1574799",
    "end": "1580559"
  },
  {
    "text": "again due to insufficient checks on the bounds of the packet because on line 12",
    "start": "1580559",
    "end": "1587000"
  },
  {
    "text": "you have a check check that see if we can go two byes after the",
    "start": "1587000",
    "end": "1595120"
  },
  {
    "text": "length param uh if you can read two more bites but uh after that you have you",
    "start": "1595120",
    "end": "1603880"
  },
  {
    "text": "there is a line that tries to read two more bites but if the line works and",
    "start": "1603880",
    "end": "1610760"
  },
  {
    "text": "there is actually extended length parameter uh we will read one bite more",
    "start": "1610760",
    "end": "1617440"
  },
  {
    "text": "which which but we only checked before if we could read two byes not three so",
    "start": "1617440",
    "end": "1623360"
  },
  {
    "text": "it's another issue where we read beyond the packet Beyond this in the packet and so",
    "start": "1623360",
    "end": "1631679"
  },
  {
    "text": "finally for this thir vulnerability it's almost the same as the previous one",
    "start": "1631679",
    "end": "1637559"
  },
  {
    "text": "because uh this time it's uh the code accounts for two byes",
    "start": "1637559",
    "end": "1644880"
  },
  {
    "text": "again for regular packets but if we have the extended option uh length it will",
    "start": "1644880",
    "end": "1651600"
  },
  {
    "text": "again try to read one bite more so it's again a read out of",
    "start": "1651600",
    "end": "1659039"
  },
  {
    "text": "BS thanks uh Simon for the details on the on the techniques and vulnerabilities so I think summarizing",
    "start": "1659919",
    "end": "1665880"
  },
  {
    "text": "what's interesting that we saw there is two things right so the handling of open messages that in some cases is a little",
    "start": "1665880",
    "end": "1672320"
  },
  {
    "text": "bit insecure right so so in in other um context we have called that in",
    "start": "1672320",
    "end": "1678080"
  },
  {
    "text": "the past shotgun parsing Right Where You parse kind of you you check the the the",
    "start": "1678080",
    "end": "1684440"
  },
  {
    "text": "the structure of the of a packet and and parse the messages at the same time right so that's what we see in some",
    "start": "1684440",
    "end": "1689960"
  },
  {
    "text": "cases with with open Messages where basically it it's not checked that the message is actually conforming let's say",
    "start": "1689960",
    "end": "1696919"
  },
  {
    "text": "before trying to do the the the actual parsing for for some data right so that can lead to to mistakes as I said uh in",
    "start": "1696919",
    "end": "1703159"
  },
  {
    "text": "the beginning of this presentation we have seen that in the past of TCP stacks and we see that again now with with pgp",
    "start": "1703159",
    "end": "1708880"
  },
  {
    "text": "implementations um on the other hand uh beyond that it's also interesting to see that even with leading implementations",
    "start": "1708880",
    "end": "1715519"
  },
  {
    "text": "and and popular implementations with a fuzzer with you saw in the video two three minutes running you can actually",
    "start": "1715519",
    "end": "1721120"
  },
  {
    "text": "find some issues it doesn't mean that you will find an issue every two three minutes that you run that because after those two three minutes we ran the",
    "start": "1721120",
    "end": "1726480"
  },
  {
    "text": "fuzzer for some more hours and then we didn't find you know it's not hundreds of c CVS there it was three but it's",
    "start": "1726480",
    "end": "1732720"
  },
  {
    "text": "interesting to see that there are some uh some low hanging fruits in uh still in some implementations right right but",
    "start": "1732720",
    "end": "1738399"
  },
  {
    "text": "adding on to the conclusion of of this talk right so let's talk a little bit about it what what this actually means",
    "start": "1738399",
    "end": "1743440"
  },
  {
    "text": "right any of these three new CVS leads to a deny of service uh on a vulnerable bgp Pier vulnerable bgp Pier running F",
    "start": "1743440",
    "end": "1751440"
  },
  {
    "text": "routing the vulnerable version of course um but what that means is that it it drops all the bgp sessions and the",
    "start": "1751440",
    "end": "1757120"
  },
  {
    "text": "routing tables and and renders the peer unresponsive for for some seconds it's a Demons of the demon will typically",
    "start": "1757120",
    "end": "1762919"
  },
  {
    "text": "restart but um you can prolong that it's it's just small formed packet in an open",
    "start": "1762919",
    "end": "1768600"
  },
  {
    "text": "message right so you can prolong that by by sending this the small formed packets over and over again um again going back",
    "start": "1768600",
    "end": "1775840"
  },
  {
    "text": "to what I said two of those issues actually can be triggered before if a routing validates the bgp identifier in",
    "start": "1775840",
    "end": "1781240"
  },
  {
    "text": "the ASN field so that means you don't need to be peered you don't need to be trusted by the other peer in these cases",
    "start": "1781240",
    "end": "1787679"
  },
  {
    "text": "you you only need to spoof a valid IP address uh to to uh to send an open",
    "start": "1787679",
    "end": "1792799"
  },
  {
    "text": "message and Beyond just these three vulnerabilities that we found talking about the others in the past right there",
    "start": "1792799",
    "end": "1799039"
  },
  {
    "text": "are close to or more than 330,000 hosts with bgp enabled on on the internet the",
    "start": "1799039",
    "end": "1804799"
  },
  {
    "text": "general internet you know looking at show done there um scan of the ipv4 space you see more than 330,000 hostes",
    "start": "1804799",
    "end": "1812120"
  },
  {
    "text": "with bgp more than 200 hosts actually run qua the predecessor of uh F routing",
    "start": "1812120",
    "end": "1818159"
  },
  {
    "text": "uh which not all of them are running bgp right they also run some other um some",
    "start": "1818159",
    "end": "1823399"
  },
  {
    "text": "other protocols doesn't mean that out of those 300 1,200 run qu but it's still a very popular implementation and more",
    "start": "1823399",
    "end": "1829600"
  },
  {
    "text": "than a thousand are running F routing but it's interesting to see that even the predecessor routing is is still",
    "start": "1829600",
    "end": "1834799"
  },
  {
    "text": "super popular so that means some V bees from the past from those hundreds that we that we saw uh in the past 20 years",
    "start": "1834799",
    "end": "1841840"
  },
  {
    "text": "can still be uh um leveraged by thread actors and then we come to supply chain issues right uh which whenever we talk",
    "start": "1841840",
    "end": "1849360"
  },
  {
    "text": "about open source and things that will go into appliances from vendors and so on supply chain is is a big topic these",
    "start": "1849360",
    "end": "1855919"
  },
  {
    "text": "days and it's a big uh issue because if you look at effort routing specifically there is a timeline there uh you know it",
    "start": "1855919",
    "end": "1862399"
  },
  {
    "text": "was initially zebra then it became qua then it was fored into e for routing they're all popular projects but if you",
    "start": "1862399",
    "end": "1867919"
  },
  {
    "text": "look at e routing specifically it has more than a thousand Forks on uh on GitHub so even if this issues were fixed",
    "start": "1867919",
    "end": "1875320"
  },
  {
    "text": "very quickly as as Simon mentioned on F routing you never know when this fixes will will go into Downstream um",
    "start": "1875320",
    "end": "1882320"
  },
  {
    "text": "Downstream projects right and that's something we faced in the past with disclosures that uh never actually made",
    "start": "1882320",
    "end": "1887360"
  },
  {
    "text": "into the downstream projects and then that specific implementation of for routing is used by Network operating",
    "start": "1887360",
    "end": "1892880"
  },
  {
    "text": "systems that are open source as well such as D Sonic calus there are many um popular ones these days and that gets",
    "start": "1892880",
    "end": "1899679"
  },
  {
    "text": "implemented into uh an appliance from a from a networking vendor or a router from a networking vendor and that is",
    "start": "1899679",
    "end": "1905960"
  },
  {
    "text": "then used by an actual end user right so there are at least this these three um",
    "start": "1905960",
    "end": "1911320"
  },
  {
    "text": "steps between an end user having a router on their Network and the actual original uh project that uh fixes these",
    "start": "1911320",
    "end": "1918760"
  },
  {
    "text": "issues right so of course having these patches trickle down the supply chain is is sometimes uh complicated and even",
    "start": "1918760",
    "end": "1924559"
  },
  {
    "text": "getting vendors to acknowledge to understand how they're vulnerable is is um difficult um so let's talk a little",
    "start": "1924559",
    "end": "1931600"
  },
  {
    "text": "bit about risk mitigation right with everything that we said in this presentation uh we still want to",
    "start": "1931600",
    "end": "1937000"
  },
  {
    "text": "highlight that routing security is still very important right I started by saying that a lot of um a lot of attention has",
    "start": "1937000",
    "end": "1943360"
  },
  {
    "text": "been given to routing Security in the past and not so much to to vulnerabilities in parsing but we still need to look at uh at uh routing",
    "start": "1943360",
    "end": "1950480"
  },
  {
    "text": "security right so there are many projects like manners um different rfcs different guides from nist and others",
    "start": "1950480",
    "end": "1957279"
  },
  {
    "text": "that deal with uh path validation origin validation and all the all the typical uh bgp routing security and please do",
    "start": "1957279",
    "end": "1963360"
  },
  {
    "text": "have a look at that and make sure that if you're implementing bgp you do it securely but thread actors have also been attacking Network infrastructure",
    "start": "1963360",
    "end": "1969799"
  },
  {
    "text": "devices directly right so don't forget about software vulnerabilities patching devices uh and all that and to patch",
    "start": "1969799",
    "end": "1975120"
  },
  {
    "text": "those devices you first need to of course identify all the devices in your network that may be using bgp as we said",
    "start": "1975120",
    "end": "1980600"
  },
  {
    "text": "uh in the motivation section it's not just uh you know isps and and internet exchanges routers that are running that",
    "start": "1980600",
    "end": "1987399"
  },
  {
    "text": "right in your organization you have potentially bgp as well even uh internally in data centers and um yeah",
    "start": "1987399",
    "end": "1994880"
  },
  {
    "text": "the fuzzer that we released comes with um pre-prepared test cases for the CVS that we found so you if you want to test",
    "start": "1994880",
    "end": "2001080"
  },
  {
    "text": "if you know that you're running a for router and you want to test those specific CVS you can you can you have just Python scripts that are distributed",
    "start": "2001080",
    "end": "2007639"
  },
  {
    "text": "with the tool if you want to run that against a new implementation you know you can do that by extending the fuzzer or you know let us know and and and we",
    "start": "2007639",
    "end": "2014240"
  },
  {
    "text": "can work uh together um so takeaways and future work right so takeaways bgp is",
    "start": "2014240",
    "end": "2020240"
  },
  {
    "text": "crucial for the internet and and widely used Beyond uh internet service providers in Internet exchanges unlike",
    "start": "2020240",
    "end": "2026799"
  },
  {
    "text": "and by the tcpip stacks that we we researched in the past the bgb implementations have actually matured very well and in general do not have",
    "start": "2026799",
    "end": "2033080"
  },
  {
    "text": "very obvious mistakes right we did analyze seven so finishing with a with a the kind of a positive node we did",
    "start": "2033080",
    "end": "2038720"
  },
  {
    "text": "analyze seven uh implementations and we only found issues in one of them and it was uh three issues as I said not not",
    "start": "2038720",
    "end": "2044519"
  },
  {
    "text": "hundreds right but some popular implementation such as this one still have vulnerabilities or are too",
    "start": "2044519",
    "end": "2049638"
  },
  {
    "text": "permissive with open messages and other types of messages with network function disaggregation uh this will make some",
    "start": "2049639",
    "end": "2056800"
  },
  {
    "text": "open implementations become potentially very popular so it's important to keep the security of this projects in check",
    "start": "2056800",
    "end": "2062520"
  },
  {
    "text": "and thread actors are exploiting these kinds of issues and the mitigation should not only be about routing security and it's not entirely up to",
    "start": "2062520",
    "end": "2069200"
  },
  {
    "text": "your internet service provider right it's it's up to everyone to make sure that pgp is implemented securely we do",
    "start": "2069200",
    "end": "2075398"
  },
  {
    "text": "have a bit more information and a technical uh report on on on the link uh shown there on the slide and as future",
    "start": "2075399",
    "end": "2081760"
  },
  {
    "text": "work uh we invite everybody to to keep fuzzing new versions new implementation improve the fuzzer it's an open source",
    "start": "2081760",
    "end": "2087200"
  },
  {
    "text": "project uh it's on GitHub feel free to to you know send PO requests contribute to it talk to us about how we can work",
    "start": "2087200",
    "end": "2093520"
  },
  {
    "text": "it work on it together and we also invite other researchers to look at other parts of the routing attack",
    "start": "2093520",
    "end": "2098720"
  },
  {
    "text": "surface that we mentioned right like other routing protocols Looking Glass servers remote control and and and other",
    "start": "2098720",
    "end": "2104000"
  },
  {
    "text": "things like that so that's that's what we had for today thank you so much and we'll be taking questions in the rep",
    "start": "2104000",
    "end": "2109880"
  },
  {
    "text": "room thank [Applause] [Music]",
    "start": "2109880",
    "end": "2115040"
  },
  {
    "text": "[Applause] you",
    "start": "2115440",
    "end": "2120839"
  }
]