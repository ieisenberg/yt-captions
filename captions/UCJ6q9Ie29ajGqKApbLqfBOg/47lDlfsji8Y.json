[
  {
    "text": "let's start it's a great honor to be here and sharing this's talk with you so SE of talk today is about the flows and",
    "start": "2560",
    "end": "9160"
  },
  {
    "text": "availabilities in system UI and Sy server how to using box and the",
    "start": "9160",
    "end": "14559"
  },
  {
    "text": "availabilities to bypass the instructions to achieving hijack tax on High version Android",
    "start": "14559",
    "end": "20320"
  },
  {
    "text": "platform so simply introduce myself my name is wi I'm a security research lab",
    "start": "20320",
    "end": "26359"
  },
  {
    "text": "and focus on mobile and ASP security researching is our group leader helps a lot while I'm doing this",
    "start": "26359",
    "end": "32599"
  },
  {
    "text": "research so agenda agenda contains four different part the first part I will introduce what is activity hijack Tech",
    "start": "32600",
    "end": "39399"
  },
  {
    "text": "also called ha and how ha work on on Old verion Android platform and next I will",
    "start": "39399",
    "end": "46399"
  },
  {
    "text": "introduce the security policies and restruction released by Google thiss and",
    "start": "46399",
    "end": "51600"
  },
  {
    "text": "how these policies make H not work then next part I will bypass this rest",
    "start": "51600",
    "end": "56840"
  },
  {
    "text": "structions by funding some new tech surface and the a abilities and in the end I will combine all the bypass",
    "start": "56840",
    "end": "63440"
  },
  {
    "text": "technique qu to weaponize for TR and then we will have a video demo for l so about the a it is old and",
    "start": "63440",
    "end": "72000"
  },
  {
    "text": "traditional aack scheme and many well mware such at the We R someware Bank both R likely to abing this technically",
    "start": "72000",
    "end": "79240"
  },
  {
    "text": "to injecting a Evo content to trusted application then L can perform hijack to stealing sensitive user date or",
    "start": "79240",
    "end": "85960"
  },
  {
    "text": "dangerous runtime permission it is let is what ha can do",
    "start": "85960",
    "end": "91240"
  },
  {
    "text": "and uh the hijack happens you usually don't know their under attack we take a real world I will take",
    "start": "91240",
    "end": "98720"
  },
  {
    "text": "Android 4 as a simple and you can see code snip in the screen it is belong to a real world mware R real one L where s",
    "start": "98720",
    "end": "107360"
  },
  {
    "text": "blocker and you can see the S blocker creates a schedule and uh the schedule",
    "start": "107360",
    "end": "112479"
  },
  {
    "text": "check the top is activity per second if the top activity is not the r itself it",
    "start": "112479",
    "end": "118360"
  },
  {
    "text": "will start activity with special flag the the new test flag to C",
    "start": "118360",
    "end": "124320"
  },
  {
    "text": "foreground after C foreground the mware can push the previous application text",
    "start": "124320",
    "end": "130399"
  },
  {
    "text": "into the background Test Now mayware can for identity of just the application",
    "start": "130399",
    "end": "136040"
  },
  {
    "text": "it's kind of like uh Str hog uh Str hog attack scheme but uh why may Weare have",
    "start": "136040",
    "end": "142000"
  },
  {
    "text": "to C for one to perform H Tech before we talk about this we need",
    "start": "142000",
    "end": "147239"
  },
  {
    "text": "to know something about the Tex and the back stack and uh from from described in",
    "start": "147239",
    "end": "152599"
  },
  {
    "text": "the uh developer document the tast t is a collection of activities and use in",
    "start": "152599",
    "end": "158239"
  },
  {
    "text": "the system usually separate the text into two type is forground Tex and background Tex and us us in most case",
    "start": "158239",
    "end": "166200"
  },
  {
    "text": "can only interact with only one forr TK such as you are using uh application one",
    "start": "166200",
    "end": "172360"
  },
  {
    "text": "and at the least time you can interact the topest activity of the application",
    "start": "172360",
    "end": "177840"
  },
  {
    "text": "one for GR TK but at the same time you cannot you are unable to interact other",
    "start": "177840",
    "end": "183159"
  },
  {
    "text": "with other application in the background so let that is why for let is while may",
    "start": "183159",
    "end": "188560"
  },
  {
    "text": "we have to se for one to injecting to injecting a Evo content to",
    "start": "188560",
    "end": "193599"
  },
  {
    "text": "screen of standard related know can simulating a hijack Tech we simul",
    "start": "193599",
    "end": "200920"
  },
  {
    "text": "simulate L is user device and the user has a installed the payment application ebank in his device and the mware in",
    "start": "200920",
    "end": "208560"
  },
  {
    "text": "background is keep keep leing the runtime state or of all proxies at this",
    "start": "208560",
    "end": "213799"
  },
  {
    "text": "time ebank user click ebank the system should blow the ebank to users",
    "start": "213799",
    "end": "219239"
  },
  {
    "text": "face and also at the same time the mail in background detect the ebank comes to",
    "start": "219239",
    "end": "224959"
  },
  {
    "text": "foreground then injecting a fake ebank login page and the Caesar for",
    "start": "224959",
    "end": "230760"
  },
  {
    "text": "Grant and it is a low cost High return attack scheme and uh in all the Android",
    "start": "230760",
    "end": "236599"
  },
  {
    "text": "devices it affects almost all application",
    "start": "236599",
    "end": "241720"
  },
  {
    "text": "so we can conclude three three key factor of of ha theability start",
    "start": "241920",
    "end": "247040"
  },
  {
    "text": "activity from background detecting runtime state from background and the run in background persistently loose the",
    "start": "247040",
    "end": "254879"
  },
  {
    "text": "one of these these factors uh we cannot achieve in precise hyra Tech of course Google will not just not",
    "start": "254879",
    "end": "262680"
  },
  {
    "text": "let let this Tech happen so this yes Google released a serious of uh security",
    "start": "262680",
    "end": "268000"
  },
  {
    "text": "policies and the destructions the first restruction is about the",
    "start": "268000",
    "end": "273479"
  },
  {
    "text": "runtime State leaking before API 22 mware can leak the runtime state of our",
    "start": "273479",
    "end": "278680"
  },
  {
    "text": "our application directly by calling s special interface and you can see po code in the",
    "start": "278680",
    "end": "284840"
  },
  {
    "text": "screen and it it get all running test and all running Proxes directly and",
    "start": "284840",
    "end": "291000"
  },
  {
    "text": "without any permission but after ap22 the this this special interface can only",
    "start": "291000",
    "end": "297400"
  },
  {
    "text": "return call State but before API 26 there is still have",
    "start": "297400",
    "end": "304120"
  },
  {
    "text": "may still have chance to bypass this restruction in a psyo way Proxes can access the pro folder of other Proxes in",
    "start": "304120",
    "end": "312680"
  },
  {
    "text": "uh directly and and request no py so mware can detecting the targets where",
    "start": "312680",
    "end": "319319"
  },
  {
    "text": "the targets come to foreground by access its o adj",
    "start": "319319",
    "end": "325039"
  },
  {
    "text": "score in 2017 Google updated the S Linux Pary the policy add to new line code the",
    "start": "325800",
    "end": "331680"
  },
  {
    "text": "new line code retracted the application to access file in non app domain it's",
    "start": "331680",
    "end": "336880"
  },
  {
    "text": "kind of like a high P2 protection so M where from now cannot access the OM adj",
    "start": "336880",
    "end": "343759"
  },
  {
    "text": "score from of other proes but let's Okay we still have a",
    "start": "343759",
    "end": "349280"
  },
  {
    "text": "compromise scheme we take a real world mware mystery board as example it turn",
    "start": "349280",
    "end": "354479"
  },
  {
    "text": "to use usage State manager to L long time State indirectly but the Leist",
    "start": "354479",
    "end": "360680"
  },
  {
    "text": "components request dangerous runtime permission and request complex user interaction such as a guide user into",
    "start": "360680",
    "end": "367880"
  },
  {
    "text": "the setting app and uh gu them to switch on switch on options manually and in",
    "start": "367880",
    "end": "373960"
  },
  {
    "text": "some third party loan uh the phone even well put out a full screen to one user",
    "start": "373960",
    "end": "380000"
  },
  {
    "text": "when granting such a permission the second restruction is",
    "start": "380000",
    "end": "385400"
  },
  {
    "text": "about the B after AI 29 application with privileg can start activity from",
    "start": "385400",
    "end": "391680"
  },
  {
    "text": "background and the no BL means we our mware cannot inject in the screen from",
    "start": "391680",
    "end": "398400"
  },
  {
    "text": "background and the maware have to detect in the runtime state from background so due to this restruction many mware and",
    "start": "398400",
    "end": "405440"
  },
  {
    "text": "hyare disappeared so the compromise is turn to",
    "start": "405440",
    "end": "411759"
  },
  {
    "text": "use accessibility services or other system services or we can use the system",
    "start": "411759",
    "end": "417680"
  },
  {
    "text": "aler window permission to Overlay screen but all these request the complex user",
    "start": "417680",
    "end": "423360"
  },
  {
    "text": "interaction and the danger Dangerous longtime permission and the second scheme is we",
    "start": "423360",
    "end": "429160"
  },
  {
    "text": "try to satisfy the BL restriction exceptions in the developer document but",
    "start": "429160",
    "end": "434479"
  },
  {
    "text": "all these restrictions such as request request bond by system or request hold",
    "start": "434479",
    "end": "439840"
  },
  {
    "text": "system privy is almost almost impossible to meet the third restruction is about the",
    "start": "439840",
    "end": "447720"
  },
  {
    "text": "the background execution limits and LM KD after API 26 background Services",
    "start": "447720",
    "end": "454280"
  },
  {
    "text": "cannot run in background precisly and it will get the high out of memory ATZ",
    "start": "454280",
    "end": "459680"
  },
  {
    "text": "score and this high score means low priority and the this will this services",
    "start": "459680",
    "end": "464879"
  },
  {
    "text": "will be considered as a background proxies by system and the idle proxies",
    "start": "464879",
    "end": "470199"
  },
  {
    "text": "will be killed by LM KD first to release memory and after API 24 system broadcast",
    "start": "470199",
    "end": "477319"
  },
  {
    "text": "trick also get burned uh this means mware cannot pull themsel up by listen listening to the brast",
    "start": "477319",
    "end": "485560"
  },
  {
    "text": "streck the compromise scheme is provided by Google The Google uh addressed the",
    "start": "485560",
    "end": "492039"
  },
  {
    "text": "developer to start the forr services for for get a low low low adj score but the",
    "start": "492039",
    "end": "500080"
  },
  {
    "text": "start but start supp Grand Services need to continuously notify user and it",
    "start": "500080",
    "end": "505560"
  },
  {
    "text": "cannot even cannot run in background uh silently",
    "start": "505560",
    "end": "511240"
  },
  {
    "text": "assuming we all use compromise scheme which means mware have to Grant dangerous onetime permission and the",
    "start": "511639",
    "end": "518320"
  },
  {
    "text": "request compl user interaction it even cannot run in background silently then",
    "start": "518320",
    "end": "524360"
  },
  {
    "text": "it means that Tech well be detected by user even we start foreground in we we",
    "start": "524360",
    "end": "529800"
  },
  {
    "text": "take a xiaomi OSX and example when user clear Recon test from background shami",
    "start": "529800",
    "end": "535640"
  },
  {
    "text": "will directly call first stop to all Proxes which means our forground services even will get",
    "start": "535640",
    "end": "543880"
  },
  {
    "text": "killed so in this talk what we need to do is bypass all the restruction achieving undetectable and and no",
    "start": "543880",
    "end": "551160"
  },
  {
    "text": "permission required hyra Tech so the first High we have to face",
    "start": "551160",
    "end": "557000"
  },
  {
    "text": "is about the BL restruction this is most important part of the flow",
    "start": "557000",
    "end": "562839"
  },
  {
    "text": "chain when MW start activity from its ABD domain the request will be handled",
    "start": "562839",
    "end": "568360"
  },
  {
    "text": "by activity manager Services then the system well goes to the execute request",
    "start": "568360",
    "end": "573760"
  },
  {
    "text": "the function and you can see Cod snip in the in the screen the function CA should B the background activity start then",
    "start": "573760",
    "end": "580079"
  },
  {
    "text": "Returns the result to retracted the BG activity member next system will try to start",
    "start": "580079",
    "end": "587680"
  },
  {
    "text": "targets component and in set initial State function the code will decide",
    "start": "587680",
    "end": "593000"
  },
  {
    "text": "whether make the application count to forr by by check the restricted BG",
    "start": "593000",
    "end": "598399"
  },
  {
    "text": "activity and you can see if the a a move to front member is set to true and in",
    "start": "598399",
    "end": "604600"
  },
  {
    "text": "the side activity in the function the move to front function will will never",
    "start": "604600",
    "end": "610320"
  },
  {
    "text": "be caught so we still need to focus on the check function and find ways to",
    "start": "610320",
    "end": "615560"
  },
  {
    "text": "bypass it and the developer document gives some exceptions for the check function such",
    "start": "615560",
    "end": "622680"
  },
  {
    "text": "as uh if application has a visible window it can start activity from",
    "start": "622680",
    "end": "627720"
  },
  {
    "text": "background the simplest example example is to make application kind to forr and this T will be considered as visible for",
    "start": "627720",
    "end": "635720"
  },
  {
    "text": "by System but we do not consider list we back to the check function and the check",
    "start": "635720",
    "end": "640959"
  },
  {
    "text": "function called has active visible window function and reason return a result to to the system if the result is",
    "start": "640959",
    "end": "648800"
  },
  {
    "text": "true the check function well return forse for telling system do not prevent Le application come to",
    "start": "648800",
    "end": "656720"
  },
  {
    "text": "foreground then next the The function well call has active visible window",
    "start": "656839",
    "end": "662320"
  },
  {
    "text": "inside the code you can see the code get the call uid and try to access its",
    "start": "662320",
    "end": "668360"
  },
  {
    "text": "window type if it window type is bigger than the first uh system window value it",
    "start": "668360",
    "end": "674560"
  },
  {
    "text": "this window will be considered as visible by system and the window type is related",
    "start": "674560",
    "end": "681760"
  },
  {
    "text": "with it Z index we take uh add window function as a example before system call",
    "start": "681760",
    "end": "688639"
  },
  {
    "text": "add window it will check the base ler between new window and the existing",
    "start": "688639",
    "end": "693880"
  },
  {
    "text": "window if the Bas Li you can see the base lier member is higher and uh its Z",
    "start": "693880",
    "end": "699880"
  },
  {
    "text": "index will be higher and uh you can see the base ler is related with the get",
    "start": "699880",
    "end": "705760"
  },
  {
    "text": "window liveon type so now we can know the window type is bigger the Z index will be also",
    "start": "705760",
    "end": "712399"
  },
  {
    "text": "bigger solar check function request us to get the system window and the system",
    "start": "712399",
    "end": "718160"
  },
  {
    "text": "window and our nonp application unble to to get a system window and usually it",
    "start": "718160",
    "end": "724320"
  },
  {
    "text": "get a base application type type window it is a low z index and invisible in",
    "start": "724320",
    "end": "730519"
  },
  {
    "text": "most time if we want to get the system window have to we have to request system aot window permission it is request",
    "start": "730519",
    "end": "737399"
  },
  {
    "text": "complex user interaction so the picture in picture feature is uh belong to Android system",
    "start": "737399",
    "end": "745279"
  },
  {
    "text": "and uh also called pipe mode it is a compromise scheme Google provided for developers any",
    "start": "745279",
    "end": "752680"
  },
  {
    "text": "application without the S permission can start the and can get a system for window uh at any time and the pin is",
    "start": "752680",
    "end": "760480"
  },
  {
    "text": "active D to a small pipe window at top of screen and the pipe window is handled",
    "start": "760480",
    "end": "765800"
  },
  {
    "text": "by system UI and of course its window type is bigger than than first window",
    "start": "765800",
    "end": "770920"
  },
  {
    "text": "first system window value and the request no permission of course is it is a good good attack",
    "start": "770920",
    "end": "777959"
  },
  {
    "text": "service with take video app as a example you can see app app comes to background",
    "start": "777959",
    "end": "783920"
  },
  {
    "text": "goes to background but it it it goes to pipe pipe model and the pin is activity",
    "start": "783920",
    "end": "790320"
  },
  {
    "text": "in a small pipe window so the system we considered is is in visible State",
    "start": "790320",
    "end": "796320"
  },
  {
    "text": "because it's because it's window type is system and uh it's in pin in pin",
    "start": "796320",
    "end": "804360"
  },
  {
    "text": "model but we still cannnot uh abuse pip directly because pipe window can hide",
    "start": "804360",
    "end": "811079"
  },
  {
    "text": "from screen and even we use the transparent theme in the pin activity",
    "start": "811079",
    "end": "816760"
  },
  {
    "text": "the system UI will make the pipe window uh visible for user and the user can",
    "start": "816760",
    "end": "823240"
  },
  {
    "text": "remove the pipe window at any time so pipe is a highly detectable",
    "start": "823240",
    "end": "828560"
  },
  {
    "text": "feature but the pipe will still have a history Buck uh we can set abnormal Heat",
    "start": "828560",
    "end": "835440"
  },
  {
    "text": "and the was in activity then the system while input abnormal one pxel one pxel",
    "start": "835440",
    "end": "841560"
  },
  {
    "text": "object to pipe window then there you can see the screen there is a very small dot",
    "start": "841560",
    "end": "847279"
  },
  {
    "text": "that is abnormal pipe only for one p one pxel but uh it is it is invisible and",
    "start": "847279",
    "end": "855600"
  },
  {
    "text": "Untouchable for user but the interesting is it is visible for",
    "start": "855600",
    "end": "861480"
  },
  {
    "text": "system so patch is quite simple you can see the pipe Bon algorithm component uh",
    "start": "861480",
    "end": "867839"
  },
  {
    "text": "it has some checks to check whether the count uh pass in value is ABN AB",
    "start": "867839",
    "end": "873600"
  },
  {
    "text": "abnormal if it is abnormal it will only Returns the a fixed",
    "start": "873600",
    "end": "879639"
  },
  {
    "text": "value so it is a nice bu to expanding attack surface now we not need to bypass",
    "start": "879639",
    "end": "885199"
  },
  {
    "text": "window visible check because we can find a way to abuse pipe such as create a",
    "start": "885199",
    "end": "890720"
  },
  {
    "text": "legal legal system window but this window are user",
    "start": "890720",
    "end": "896279"
  },
  {
    "text": "undetectable before before we finding where this in pipe we need to know how pipe work and the app call call",
    "start": "896399",
    "end": "904120"
  },
  {
    "text": "interpipe mode and the system ATMs well handle list then the system where goes",
    "start": "904120",
    "end": "909199"
  },
  {
    "text": "to move activity to pin Lo TK function and in this function you can see the",
    "start": "909199",
    "end": "915199"
  },
  {
    "text": "code call set set Window mode and the pin and the set the test in pin model",
    "start": "915199",
    "end": "920680"
  },
  {
    "text": "mode and the L call set text appear and inside the code it will it will IPC it",
    "start": "920680",
    "end": "927680"
  },
  {
    "text": "will IPC with the uh system UI site and the system UI site",
    "start": "927680",
    "end": "933000"
  },
  {
    "text": "on takes appear callback function will be tricked and inside this code the code",
    "start": "933000",
    "end": "938920"
  },
  {
    "text": "the system will init some pipe Rams such as a setup uh uh animation transition",
    "start": "938920",
    "end": "944959"
  },
  {
    "text": "and uh set up window sites anyway pipe will be officially rended",
    "start": "944959",
    "end": "951959"
  },
  {
    "text": "here so so we can now complete the pipe Trend pipe startup Trend here and uh we",
    "start": "951959",
    "end": "959160"
  },
  {
    "text": "can get the simple sequence diagram if we want to take pipe we need to attack",
    "start": "959160",
    "end": "964240"
  },
  {
    "text": "the weakest part in this train so our first scheme is try to prevent IPC uh",
    "start": "964240",
    "end": "970399"
  },
  {
    "text": "you can know uh we said before the ATMs well set the pin mod mode and uh after",
    "start": "970399",
    "end": "976600"
  },
  {
    "text": "after set the pin mode the system well considered is as a visible then if we",
    "start": "976600",
    "end": "982360"
  },
  {
    "text": "block IPC here the system UI will not render the pipe pipe window maybe we can",
    "start": "982360",
    "end": "987680"
  },
  {
    "text": "get a uh uh undetectable but still impin State",
    "start": "987680",
    "end": "994279"
  },
  {
    "text": "task but unfortunately in user space we almost have no way to affect the code",
    "start": "994279",
    "end": "999839"
  },
  {
    "text": "execution in system server so the second scheme is try to teack the UI system UI side like",
    "start": "999839",
    "end": "1007040"
  },
  {
    "text": "creating a abnormal window type the set Source reactor H is a",
    "start": "1007040",
    "end": "1013160"
  },
  {
    "text": "interesting interface it can Auto scale and the croper activity window to uh to",
    "start": "1013160",
    "end": "1019079"
  },
  {
    "text": "to define the sze to by the by pass in Lector object so if we input a abnormal",
    "start": "1019079",
    "end": "1026160"
  },
  {
    "text": "reor object where we get a abnormal pipe window here we write a L poke and poke",
    "start": "1026160",
    "end": "1034760"
  },
  {
    "text": "run in Android setting and of course it get a one pxel re uh it get one pxel",
    "start": "1034760",
    "end": "1041199"
  },
  {
    "text": "window by pass in one pxel object but after half seconds it come back to the",
    "start": "1041199",
    "end": "1047038"
  },
  {
    "text": "normal s so what happen inside the half half seconds and any ways to expanding",
    "start": "1047039",
    "end": "1053720"
  },
  {
    "text": "the direction so we need to trace left object and inside the Onex appear",
    "start": "1053720",
    "end": "1060960"
  },
  {
    "text": "callback function and uh we can know the left object pass to the schedule animate",
    "start": "1060960",
    "end": "1067120"
  },
  {
    "text": "resite pipe and inside the code the the code set up a transition and the set the",
    "start": "1067120",
    "end": "1074520"
  },
  {
    "text": "duration this duration is a fixed value defined by System it's uh 42 uh 25 and",
    "start": "1074520",
    "end": "1081799"
  },
  {
    "text": "after some debuging we can know this transition will resize the pipe pipe window into the uh into the left object",
    "start": "1081799",
    "end": "1090559"
  },
  {
    "text": "defined s so what happen if after the",
    "start": "1090559",
    "end": "1095720"
  },
  {
    "text": "resides then this transition object will set up a call back hander this call back",
    "start": "1095720",
    "end": "1101320"
  },
  {
    "text": "hander uh r on pipe animation animated the animation and the interface then it",
    "start": "1101320",
    "end": "1108440"
  },
  {
    "text": "will be called after the pipe animated played over within the code it will call",
    "start": "1108440",
    "end": "1113880"
  },
  {
    "text": "the Finish sites finish sites will create the window container transation",
    "start": "1113880",
    "end": "1119440"
  },
  {
    "text": "object also called wct it will be passed to the prepare finish reside recite",
    "start": "1119440",
    "end": "1125120"
  },
  {
    "text": "transition with a normal size direct object defined by system and then it will set the surface",
    "start": "1125120",
    "end": "1132799"
  },
  {
    "text": "control transition and the and the system defined direct to wct",
    "start": "1132799",
    "end": "1140320"
  },
  {
    "text": "L system will carry wct to I IPC with system before IPC the system UI side",
    "start": "1140720",
    "end": "1148039"
  },
  {
    "text": "will extra SCT from the W C then car relas s to IPC then system side well",
    "start": "1148039",
    "end": "1155960"
  },
  {
    "text": "goes to set m window side TR transition in this transition the system will",
    "start": "1155960",
    "end": "1161679"
  },
  {
    "text": "directly call merge upate to rendering the SD on the screen this upate will",
    "start": "1161679",
    "end": "1167000"
  },
  {
    "text": "cause pipe window resid to normal sites and uh now our Target is try to prevent",
    "start": "1167000",
    "end": "1174120"
  },
  {
    "text": "the merge the first uh we want to the first",
    "start": "1174120",
    "end": "1179760"
  },
  {
    "text": "thing we is we want to try to prevent IPC but uh not work so we compare the",
    "start": "1179760",
    "end": "1186280"
  },
  {
    "text": "many branch of this of this uh uh of this function and we found the API 32",
    "start": "1186280",
    "end": "1192760"
  },
  {
    "text": "has a code change and uh from its comit detail we can know it is a functional",
    "start": "1192760",
    "end": "1198320"
  },
  {
    "text": "patch instead of scly patch so it is still avilable to analyze AP 32 and 32",
    "start": "1198320",
    "end": "1205120"
  },
  {
    "text": "do not call merge operate and instead call merge is set",
    "start": "1205120",
    "end": "1212320"
  },
  {
    "text": "the SCT to a goal member and the this goo member will and we follow the goo",
    "start": "1212320",
    "end": "1218280"
  },
  {
    "text": "member in we can find the set surface boundaries locked function will get the S so we hook this function f what what",
    "start": "1218280",
    "end": "1226480"
  },
  {
    "text": "happens in this C we found the familiar function prepare",
    "start": "1226480",
    "end": "1232200"
  },
  {
    "text": "surface of uh it this this function is brought to activity record components",
    "start": "1232200",
    "end": "1238080"
  },
  {
    "text": "this components is related with activity lunch and the rendering so it this means",
    "start": "1238080",
    "end": "1244039"
  },
  {
    "text": "we can con uh indirectly control this call trend from in the user",
    "start": "1244039",
    "end": "1251280"
  },
  {
    "text": "space now we know API 32 and the 33 where finally goes to the setman window",
    "start": "1251280",
    "end": "1257679"
  },
  {
    "text": "side trans trans uh function and uh we know the 33 the this function will call merge and uh we",
    "start": "1257679",
    "end": "1265600"
  },
  {
    "text": "almost have no way to prevent the pipe reside to normal because the trend is",
    "start": "1265600",
    "end": "1271000"
  },
  {
    "text": "handled by system UI but in 32 the this function will set set the S to goal",
    "start": "1271000",
    "end": "1277960"
  },
  {
    "text": "member then in inside the activity R draw operate list operator will start up",
    "start": "1277960",
    "end": "1284400"
  },
  {
    "text": "a train and access list s and then the code will call merge so if we re Frozen",
    "start": "1284400",
    "end": "1291919"
  },
  {
    "text": "withraw operate well maybe maybe the merge operator will not be kill not will",
    "start": "1291919",
    "end": "1296960"
  },
  {
    "text": "not be caught so we get our first cve uh you",
    "start": "1296960",
    "end": "1302559"
  },
  {
    "text": "can see there is very very small dot in the screen it is US undetectable and",
    "start": "1302559",
    "end": "1308600"
  },
  {
    "text": "invis invisible uh this pipe can keep staying in the in the screen in the in the phone",
    "start": "1308600",
    "end": "1315520"
  },
  {
    "text": "and because we F the F the UI thir SP this is still a API 32 bypass we want",
    "start": "1315520",
    "end": "1322760"
  },
  {
    "text": "a bypass after API 33 so we look into the API list we found",
    "start": "1322760",
    "end": "1330679"
  },
  {
    "text": "the new Tex surface left function make lunch into pipe this function well",
    "start": "1330679",
    "end": "1336520"
  },
  {
    "text": "returns activity options object this object you can see it as additional",
    "start": "1336520",
    "end": "1341840"
  },
  {
    "text": "options for activity lunch then inside the code the the",
    "start": "1341840",
    "end": "1348559"
  },
  {
    "text": "function will will save the receive the pipe to package the bundle object by a spey a spefic key the key man is launch",
    "start": "1348559",
    "end": "1356279"
  },
  {
    "text": "into pipe RS then the package bundle can be used to set options for activity",
    "start": "1356279",
    "end": "1362880"
  },
  {
    "text": "start we trace the bundle object inside the activity L TR and you can see the",
    "start": "1362880",
    "end": "1370039"
  },
  {
    "text": "bundle will finally be passed to a function start activity iner and about this function we have analyzed it before",
    "start": "1370039",
    "end": "1377559"
  },
  {
    "text": "it will call move to font if Will application pass the blo restruction by uh restruction trick so what will the",
    "start": "1377559",
    "end": "1385799"
  },
  {
    "text": "bundle object do inside the co inside the",
    "start": "1385799",
    "end": "1391440"
  },
  {
    "text": "code so inside the code uh you can see the code call uh call is launched into",
    "start": "1393279",
    "end": "1400240"
  },
  {
    "text": "pipe to check the bundle if the bundle is takes the spefic key and after the",
    "start": "1400240",
    "end": "1405880"
  },
  {
    "text": "trick you can see code directly move activity to pin L Tas without any other",
    "start": "1405880",
    "end": "1411919"
  },
  {
    "text": "check and no ba err restriction check so which means our mware can start",
    "start": "1411919",
    "end": "1419520"
  },
  {
    "text": "the activity from background at any time or to and start activity into P mode so",
    "start": "1419520",
    "end": "1426440"
  },
  {
    "text": "we get our new cve for after APS",
    "start": "1426440",
    "end": "1431480"
  },
  {
    "text": "33 so the second highight we have to face is about the B uh is about the state breaking State uh",
    "start": "1431720",
    "end": "1439000"
  },
  {
    "text": "uh after after bypass the B we have to we have to do",
    "start": "1439000",
    "end": "1444840"
  },
  {
    "text": "this this is The Bu I made when I'm doing developing you can see the you can",
    "start": "1444840",
    "end": "1451880"
  },
  {
    "text": "see the SLO exception in the screen the exception happens when I merge the code",
    "start": "1451880",
    "end": "1458919"
  },
  {
    "text": "after merge the code the system tells me I try to start start services from",
    "start": "1458919",
    "end": "1464200"
  },
  {
    "text": "background but before I merge code I I use the Box position I use bind Services",
    "start": "1464200",
    "end": "1470640"
  },
  {
    "text": "after merge I use start Services after checking the developing document we can",
    "start": "1470640",
    "end": "1476039"
  },
  {
    "text": "know B Services is not under limit of the background execution",
    "start": "1476039",
    "end": "1482880"
  },
  {
    "text": "limitation so let's why app crashed and we can know background exclusion limitation where through exception when",
    "start": "1482880",
    "end": "1489760"
  },
  {
    "text": "app try to start background services in this case we can abuse this",
    "start": "1489760",
    "end": "1496520"
  },
  {
    "text": "limitation to be a background boxes Detector by Target exported Services",
    "start": "1496520",
    "end": "1505120"
  },
  {
    "text": "component so you can see I write the PO Code to start the targets from",
    "start": "1506159",
    "end": "1512520"
  },
  {
    "text": "background and uh if the if the target is in background the system the system",
    "start": "1512520",
    "end": "1518320"
  },
  {
    "text": "side will return abnormal component name this abnormal man this abnormal",
    "start": "1518320",
    "end": "1524120"
  },
  {
    "text": "components will cause the user user space through the exception which means",
    "start": "1524120",
    "end": "1529480"
  },
  {
    "text": "I can catch this exception in user space so so I can detecting targets uh come to",
    "start": "1529480",
    "end": "1537039"
  },
  {
    "text": "foreground by a CYO way and the least issue is still waiting for",
    "start": "1537039",
    "end": "1542919"
  },
  {
    "text": "cve and due to time reason all Trick please see my we",
    "start": "1542919",
    "end": "1548520"
  },
  {
    "text": "paper next we will app LM KD achieving Pressly Proxes in",
    "start": "1548520",
    "end": "1555840"
  },
  {
    "text": "background uh before we talk about mkd we can we need to know something about",
    "start": "1556360",
    "end": "1561440"
  },
  {
    "text": "the out of memory adj score you can see we if we get the higher score means our",
    "start": "1561440",
    "end": "1567760"
  },
  {
    "text": "proxies will have a lower priority and you can see the screen our our show keep",
    "start": "1567760",
    "end": "1575399"
  },
  {
    "text": "checking the uh background keep keep checking a background Proxes and the",
    "start": "1575399",
    "end": "1580480"
  },
  {
    "text": "this background Proxes its priority is lower and lower and in the end it get killed by LM KD but we can start the",
    "start": "1580480",
    "end": "1588440"
  },
  {
    "text": "foreground services but in the least foreground Services usually get the 200 score is a high priority but uh we said",
    "start": "1588440",
    "end": "1597559"
  },
  {
    "text": "before it it is no way to run in background Silly by analyzing the code of of",
    "start": "1597559",
    "end": "1604720"
  },
  {
    "text": "calculating the priority in system we know we can know if the proxy Services",
    "start": "1604720",
    "end": "1610200"
  },
  {
    "text": "is bond by third party and the the party priority is higher L self code will",
    "start": "1610200",
    "end": "1616200"
  },
  {
    "text": "check whether the client priority is higher L visible visible application adj",
    "start": "1616200",
    "end": "1622080"
  },
  {
    "text": "well if true the app can get a visible app",
    "start": "1622080",
    "end": "1627760"
  },
  {
    "text": "priority so is there any way to be bonded by system system Proxes before we",
    "start": "1628000",
    "end": "1634480"
  },
  {
    "text": "know this we need to know something about the managers there is several managers in framework such as activity",
    "start": "1634480",
    "end": "1641720"
  },
  {
    "text": "managers window managers and the package manager and the non priority application",
    "start": "1641720",
    "end": "1647559"
  },
  {
    "text": "can can operate operate managers by correspond I object and the managers usually run as a",
    "start": "1647559",
    "end": "1655399"
  },
  {
    "text": "system user can so can we abuse managers we take uh accessibility",
    "start": "1655399",
    "end": "1661880"
  },
  {
    "text": "Services as an example that accessibility uh Fe feature is handled",
    "start": "1661880",
    "end": "1668279"
  },
  {
    "text": "by accessibility manager services and uh nonp parage application needs to declare",
    "start": "1668279",
    "end": "1675440"
  },
  {
    "text": "declare spefic inter inter fil before use this feature and the this filer is",
    "start": "1675440",
    "end": "1682360"
  },
  {
    "text": "pointing to a specific application Services",
    "start": "1682360",
    "end": "1687519"
  },
  {
    "text": "component accessibility manager services will first find all application want to",
    "start": "1687720",
    "end": "1693279"
  },
  {
    "text": "access the this feature by the intern filter then it will create create a",
    "start": "1693279",
    "end": "1698919"
  },
  {
    "text": "connection objects inside the code and the this object Targets this application",
    "start": "1698919",
    "end": "1705000"
  },
  {
    "text": "then code well call B locked function to B into to the",
    "start": "1705000",
    "end": "1711159"
  },
  {
    "text": "app one poke now we get the high prority Proxes because it's baned by uh system",
    "start": "1711159",
    "end": "1718399"
  },
  {
    "text": "system Proxes but uh this feat this accessibility uh feature is request",
    "start": "1718399",
    "end": "1724600"
  },
  {
    "text": "dangerous runtime permission so we do not use this to achieving prly",
    "start": "1724600",
    "end": "1730559"
  },
  {
    "text": "proxies we find another manager called account manager this is uh API added",
    "start": "1730559",
    "end": "1736159"
  },
  {
    "text": "from API 5 it's uh 2009 and this is a manager used",
    "start": "1736159",
    "end": "1742360"
  },
  {
    "text": "to M this is a manager used to ma device account by uh at at the same same time",
    "start": "1742360",
    "end": "1750320"
  },
  {
    "text": "to use these components nonp application also need to declare spefic in filter",
    "start": "1750320",
    "end": "1756919"
  },
  {
    "text": "the key point is to use these components we do not need to request dangerous runtime",
    "start": "1756919",
    "end": "1763600"
  },
  {
    "text": "permission so we have a chance to call addcon interface by",
    "start": "1763600",
    "end": "1768640"
  },
  {
    "text": "this manager the system will create the system objects Targets this call application then system will call the",
    "start": "1768640",
    "end": "1776080"
  },
  {
    "text": "bind function of the system object it will make the system bind to our PO",
    "start": "1776080",
    "end": "1784080"
  },
  {
    "text": "Code and uh our poke will get the high PRI priority and the user",
    "start": "1784080",
    "end": "1790519"
  },
  {
    "text": "undetectable and there some more tricks can make account manager keep binding to",
    "start": "1790519",
    "end": "1795760"
  },
  {
    "text": "nonp application uh let the the proxies I'm kill about",
    "start": "1795760",
    "end": "1801279"
  },
  {
    "text": "due to the time reason we do not talk about list and the list trick can be found in my white",
    "start": "1801279",
    "end": "1808200"
  },
  {
    "text": "paper and this is a code uh video demo for persistently",
    "start": "1808200",
    "end": "1815000"
  },
  {
    "text": "poke first we we uh we start uh we check the Android version It's API",
    "start": "1816320",
    "end": "1824320"
  },
  {
    "text": "34 we start poke poke start running and uh we make this application comes to",
    "start": "1826360",
    "end": "1833880"
  },
  {
    "text": "background we try to check it out of M adj",
    "start": "1833880",
    "end": "1840679"
  },
  {
    "text": "score it's high",
    "start": "1840880",
    "end": "1844399"
  },
  {
    "text": "priority we try to for stop it for stop relas application but uh you can see the",
    "start": "1846880",
    "end": "1853240"
  },
  {
    "text": "Pok is still running it can be killed by any operate even we call for",
    "start": "1853240",
    "end": "1860760"
  },
  {
    "text": "stop we still check it's out of memory",
    "start": "1862159",
    "end": "1867399"
  },
  {
    "text": "adj high priority then we try to kill it in ADB",
    "start": "1871080",
    "end": "1878519"
  },
  {
    "text": "shell before stop it still",
    "start": "1885639",
    "end": "1892960"
  },
  {
    "text": "running so next is the forain of hijack",
    "start": "1893000",
    "end": "1898600"
  },
  {
    "text": "exploit check Android version is",
    "start": "1906000",
    "end": "1911000"
  },
  {
    "text": "14 we need to hijack all these three application",
    "start": "1913519",
    "end": "1919639"
  },
  {
    "text": "we first first run this application to make sure this app run",
    "start": "1919760",
    "end": "1925960"
  },
  {
    "text": "normally then we start poke we click hijack all it start",
    "start": "1939880",
    "end": "1947919"
  },
  {
    "text": "detecting the runtime",
    "start": "1947919",
    "end": "1951039"
  },
  {
    "text": "state after we click it we get the",
    "start": "1954159",
    "end": "1959200"
  },
  {
    "text": "hijacked you YouTuber also get",
    "start": "1961440",
    "end": "1966120"
  },
  {
    "text": "hijacked te telegram is also get hijacked",
    "start": "1967399",
    "end": "1973519"
  },
  {
    "text": "so this is the end thank you",
    "start": "1979120",
    "end": "1983799"
  }
]