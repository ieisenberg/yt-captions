[
  {
    "start": "0",
    "end": "28000"
  },
  {
    "text": "[Music]",
    "start": "1180",
    "end": "14730"
  },
  {
    "text": "hello and welcome to our talks",
    "start": "14960",
    "end": "17119"
  },
  {
    "text": "circumventing the guardians how the",
    "start": "17119",
    "end": "19600"
  },
  {
    "text": "security features in",
    "start": "19600",
    "end": "20960"
  },
  {
    "text": "state of the art tls inspection",
    "start": "20960",
    "end": "23199"
  },
  {
    "text": "solutions",
    "start": "23199",
    "end": "24000"
  },
  {
    "text": "can be exploited for cover data",
    "start": "24000",
    "end": "26480"
  },
  {
    "text": "exfiltration",
    "start": "26480",
    "end": "28800"
  },
  {
    "start": "28000",
    "end": "47000"
  },
  {
    "text": "my name is morton marstrander",
    "start": "28800",
    "end": "31920"
  },
  {
    "text": "i'm a senior security consultant working",
    "start": "31920",
    "end": "34480"
  },
  {
    "text": "for the norwegian",
    "start": "34480",
    "end": "35840"
  },
  {
    "text": "cyber security firm called mnemonic",
    "start": "35840",
    "end": "39440"
  },
  {
    "text": "and i'm mateo malvika a principal",
    "start": "39440",
    "end": "41920"
  },
  {
    "text": "security researcher",
    "start": "41920",
    "end": "43440"
  },
  {
    "text": "at the software company norton livelock",
    "start": "43440",
    "end": "47440"
  },
  {
    "start": "47000",
    "end": "84000"
  },
  {
    "text": "and here is what you can expect from our",
    "start": "47440",
    "end": "50239"
  },
  {
    "text": "talk",
    "start": "50239",
    "end": "51920"
  },
  {
    "text": "first we're going to present the results",
    "start": "51920",
    "end": "54480"
  },
  {
    "text": "of our research",
    "start": "54480",
    "end": "55920"
  },
  {
    "text": "that we conducted lately then we're",
    "start": "55920",
    "end": "58960"
  },
  {
    "text": "going to have a brief overview of tls",
    "start": "58960",
    "end": "60800"
  },
  {
    "text": "inspection devices",
    "start": "60800",
    "end": "61920"
  },
  {
    "text": "and more specifically on the hello",
    "start": "61920",
    "end": "63840"
  },
  {
    "text": "packet",
    "start": "63840",
    "end": "65840"
  },
  {
    "text": "then we're going to tell you a short",
    "start": "65840",
    "end": "67920"
  },
  {
    "text": "story on how we develop",
    "start": "67920",
    "end": "69840"
  },
  {
    "text": "the common in control around this new",
    "start": "69840",
    "end": "72400"
  },
  {
    "text": "exfiltration method",
    "start": "72400",
    "end": "75520"
  },
  {
    "text": "and we are going to conclude with the",
    "start": "75520",
    "end": "78400"
  },
  {
    "text": "mitigation and detection",
    "start": "78400",
    "end": "80240"
  },
  {
    "text": "and as a cherry on top live demo",
    "start": "80240",
    "end": "85119"
  },
  {
    "start": "84000",
    "end": "144000"
  },
  {
    "text": "so uh during the start of 2020 we came",
    "start": "85119",
    "end": "89200"
  },
  {
    "text": "up with an idea on",
    "start": "89200",
    "end": "90479"
  },
  {
    "text": "how to exfiltrate data through tls",
    "start": "90479",
    "end": "93200"
  },
  {
    "text": "inspection devices",
    "start": "93200",
    "end": "94479"
  },
  {
    "text": "by using the sni fields as a container",
    "start": "94479",
    "end": "97680"
  },
  {
    "text": "for data exfiltration",
    "start": "97680",
    "end": "101280"
  },
  {
    "text": "our test validates that this was a",
    "start": "101280",
    "end": "103360"
  },
  {
    "text": "widespread issue",
    "start": "103360",
    "end": "104640"
  },
  {
    "text": "affecting different types of security",
    "start": "104640",
    "end": "106720"
  },
  {
    "text": "solution as well as solution from a",
    "start": "106720",
    "end": "108720"
  },
  {
    "text": "variety of vendors",
    "start": "108720",
    "end": "110720"
  },
  {
    "text": "we successfully tested our technique",
    "start": "110720",
    "end": "112799"
  },
  {
    "text": "against products from",
    "start": "112799",
    "end": "114159"
  },
  {
    "text": "f5 networks palo alto networks and",
    "start": "114159",
    "end": "116479"
  },
  {
    "text": "fortinet",
    "start": "116479",
    "end": "117520"
  },
  {
    "text": "but this could uh have affected other",
    "start": "117520",
    "end": "119439"
  },
  {
    "text": "vendors as well",
    "start": "119439",
    "end": "122159"
  },
  {
    "text": "we had an excellent cooperation with the",
    "start": "122320",
    "end": "124560"
  },
  {
    "text": "each of this vendor adhering to",
    "start": "124560",
    "end": "126320"
  },
  {
    "text": "the responsible disclosure procedure",
    "start": "126320",
    "end": "129440"
  },
  {
    "text": "powers and f5 publish their own security",
    "start": "129440",
    "end": "131920"
  },
  {
    "text": "advisory along with workarounds",
    "start": "131920",
    "end": "134160"
  },
  {
    "text": "fortinet is going to publish it as soon",
    "start": "134160",
    "end": "136000"
  },
  {
    "text": "as they release a fix for that",
    "start": "136000",
    "end": "138720"
  },
  {
    "text": "this joint of corporation results in the",
    "start": "138720",
    "end": "141120"
  },
  {
    "text": "two following cvs",
    "start": "141120",
    "end": "144239"
  },
  {
    "start": "144000",
    "end": "206000"
  },
  {
    "text": "the end product of these research of",
    "start": "146640",
    "end": "149520"
  },
  {
    "text": "ours",
    "start": "149520",
    "end": "150000"
  },
  {
    "text": "is a proof of concept open source",
    "start": "150000",
    "end": "151680"
  },
  {
    "text": "project named snicket which stands for",
    "start": "151680",
    "end": "154080"
  },
  {
    "text": "surname indication concatenator",
    "start": "154080",
    "end": "157519"
  },
  {
    "text": "sneak it is a situ capable of navigating",
    "start": "157519",
    "end": "160319"
  },
  {
    "text": "the file system of the compromise host",
    "start": "160319",
    "end": "162480"
  },
  {
    "text": "in",
    "start": "162480",
    "end": "162720"
  },
  {
    "text": "exfiltrate files through tls inspection",
    "start": "162720",
    "end": "164959"
  },
  {
    "text": "devices sitting in between",
    "start": "164959",
    "end": "167360"
  },
  {
    "text": "even if the c2 domain is black laces and",
    "start": "167360",
    "end": "170080"
  },
  {
    "text": "configured to be blocked by the device",
    "start": "170080",
    "end": "172959"
  },
  {
    "text": "sneak it comprises of two separate per",
    "start": "172959",
    "end": "175200"
  },
  {
    "text": "interdependent components",
    "start": "175200",
    "end": "177360"
  },
  {
    "text": "a passive agent that should be dropped",
    "start": "177360",
    "end": "179760"
  },
  {
    "text": "on the target",
    "start": "179760",
    "end": "180879"
  },
  {
    "text": "and that is already compromised and",
    "start": "180879",
    "end": "184000"
  },
  {
    "text": "in its goal is to connect back to the c2",
    "start": "184000",
    "end": "186800"
  },
  {
    "text": "and execute the provided command by the",
    "start": "186800",
    "end": "188800"
  },
  {
    "text": "operator",
    "start": "188800",
    "end": "190560"
  },
  {
    "text": "also we have the ct server which",
    "start": "190560",
    "end": "192000"
  },
  {
    "text": "controls the agent from anywhere on the",
    "start": "192000",
    "end": "194400"
  },
  {
    "text": "internet acting at the",
    "start": "194400",
    "end": "195680"
  },
  {
    "text": "as the threat actor",
    "start": "195680",
    "end": "198800"
  },
  {
    "text": "so we are about to describe each step",
    "start": "198800",
    "end": "200400"
  },
  {
    "text": "involved in this process but first",
    "start": "200400",
    "end": "202879"
  },
  {
    "text": "an introduction on tls inspection",
    "start": "202879",
    "end": "204799"
  },
  {
    "text": "devices is mandatory",
    "start": "204799",
    "end": "208080"
  },
  {
    "start": "206000",
    "end": "429000"
  },
  {
    "text": "yeah so during the",
    "start": "208080",
    "end": "211920"
  },
  {
    "text": "handshake process the sni is uh",
    "start": "211920",
    "end": "214400"
  },
  {
    "text": "populated by a value provided by the",
    "start": "214400",
    "end": "216640"
  },
  {
    "text": "client",
    "start": "216640",
    "end": "217920"
  },
  {
    "text": "and it instructs the server on the",
    "start": "217920",
    "end": "221599"
  },
  {
    "text": "right side of this diagram which host",
    "start": "221599",
    "end": "224560"
  },
  {
    "text": "name the client is trying to connect",
    "start": "224560",
    "end": "226000"
  },
  {
    "text": "to and what certificate the server",
    "start": "226000",
    "end": "228319"
  },
  {
    "text": "should present to the client",
    "start": "228319",
    "end": "230640"
  },
  {
    "text": "in this example diagram we are using a",
    "start": "230640",
    "end": "233200"
  },
  {
    "text": "tls inspection device",
    "start": "233200",
    "end": "235760"
  },
  {
    "text": "either a next generation firewall or a",
    "start": "235760",
    "end": "238159"
  },
  {
    "text": "web proxy of some sorts",
    "start": "238159",
    "end": "240959"
  },
  {
    "text": "working as a legal man in the middle so",
    "start": "240959",
    "end": "243840"
  },
  {
    "text": "to speak",
    "start": "243840",
    "end": "244799"
  },
  {
    "text": "in order to inspect the traffic for",
    "start": "244799",
    "end": "247200"
  },
  {
    "text": "malicious content",
    "start": "247200",
    "end": "249360"
  },
  {
    "text": "look up the domain being used in a",
    "start": "249360",
    "end": "251280"
  },
  {
    "text": "blacklist and block or allow said",
    "start": "251280",
    "end": "253680"
  },
  {
    "text": "traffic",
    "start": "253680",
    "end": "254319"
  },
  {
    "text": "based on the result so",
    "start": "254319",
    "end": "258560"
  },
  {
    "text": "in step one the client begins by sending",
    "start": "258560",
    "end": "260479"
  },
  {
    "text": "in client hello",
    "start": "260479",
    "end": "261680"
  },
  {
    "text": "and in step two the tls inspection",
    "start": "261680",
    "end": "263759"
  },
  {
    "text": "device forwards this to the server",
    "start": "263759",
    "end": "266960"
  },
  {
    "text": "fair enough and step three the",
    "start": "266960",
    "end": "270240"
  },
  {
    "text": "server responds with a server hello and",
    "start": "270240",
    "end": "273280"
  },
  {
    "text": "a",
    "start": "273280",
    "end": "273680"
  },
  {
    "text": "server certificate which the next such",
    "start": "273680",
    "end": "277280"
  },
  {
    "text": "generation firewall or",
    "start": "277280",
    "end": "278400"
  },
  {
    "text": "web proxy tls inspection device",
    "start": "278400",
    "end": "281680"
  },
  {
    "text": "performs the following in step four it",
    "start": "281680",
    "end": "283360"
  },
  {
    "text": "compares the sni",
    "start": "283360",
    "end": "285520"
  },
  {
    "text": "with the server certificate subject name",
    "start": "285520",
    "end": "289270"
  },
  {
    "text": "[Music]",
    "start": "289270",
    "end": "291040"
  },
  {
    "text": "then thereby authenticating the server",
    "start": "291040",
    "end": "294720"
  },
  {
    "text": "and also it validates if the",
    "start": "294720",
    "end": "298479"
  },
  {
    "text": "certificate is trusted or not based on",
    "start": "298479",
    "end": "300720"
  },
  {
    "text": "its",
    "start": "300720",
    "end": "301600"
  },
  {
    "text": "internal trust store",
    "start": "301600",
    "end": "305199"
  },
  {
    "text": "it then in step 5 performs a",
    "start": "305600",
    "end": "308800"
  },
  {
    "text": "filtering decision based on comparing",
    "start": "308800",
    "end": "312160"
  },
  {
    "text": "the content of the sni",
    "start": "312160",
    "end": "314320"
  },
  {
    "text": "to a reputation database of domains and",
    "start": "314320",
    "end": "317120"
  },
  {
    "text": "urls",
    "start": "317120",
    "end": "319680"
  },
  {
    "text": "then the tls inspection device",
    "start": "321840",
    "end": "326160"
  },
  {
    "text": "completes the handshake by",
    "start": "326160",
    "end": "329520"
  },
  {
    "text": "signing an emulated version of",
    "start": "330160",
    "end": "333440"
  },
  {
    "text": "the certificate presented by the origin",
    "start": "333440",
    "end": "335840"
  },
  {
    "text": "server",
    "start": "335840",
    "end": "336960"
  },
  {
    "text": "and it does this with its own internal",
    "start": "336960",
    "end": "338720"
  },
  {
    "text": "ca",
    "start": "338720",
    "end": "340160"
  },
  {
    "text": "uh this ca is trusted by the client",
    "start": "340160",
    "end": "343600"
  },
  {
    "text": "and uh thereby the",
    "start": "343600",
    "end": "346639"
  },
  {
    "text": "tls inspection device is able to to work",
    "start": "346639",
    "end": "349199"
  },
  {
    "text": "as a man in the middle",
    "start": "349199",
    "end": "351039"
  },
  {
    "text": "um the inspection device then presents",
    "start": "351039",
    "end": "354080"
  },
  {
    "text": "this emulated certificate",
    "start": "354080",
    "end": "355840"
  },
  {
    "text": "to the client uh while also emulating",
    "start": "355840",
    "end": "358319"
  },
  {
    "text": "most of the values in the original",
    "start": "358319",
    "end": "359840"
  },
  {
    "text": "certificates",
    "start": "359840",
    "end": "360560"
  },
  {
    "text": "like validity if it's trusted untrusted",
    "start": "360560",
    "end": "364479"
  },
  {
    "text": "self-signed etc",
    "start": "364479",
    "end": "367840"
  },
  {
    "text": "also in some cases we saw some devices",
    "start": "368319",
    "end": "371840"
  },
  {
    "text": "that",
    "start": "371840",
    "end": "373759"
  },
  {
    "text": "not always emulate the certificate if it",
    "start": "373759",
    "end": "376639"
  },
  {
    "text": "is",
    "start": "376639",
    "end": "377680"
  },
  {
    "text": "untrusted then the device some of the",
    "start": "377680",
    "end": "380800"
  },
  {
    "text": "some of the devices will instead send a",
    "start": "380800",
    "end": "383120"
  },
  {
    "text": "reset to the client",
    "start": "383120",
    "end": "384720"
  },
  {
    "text": "instead of the actual certificate um",
    "start": "384720",
    "end": "389360"
  },
  {
    "text": "yes so after that step 6",
    "start": "389440",
    "end": "392960"
  },
  {
    "text": "the handshake is complete and",
    "start": "392960",
    "end": "396240"
  },
  {
    "text": "the application data application traffic",
    "start": "396240",
    "end": "399199"
  },
  {
    "text": "starts flowing and",
    "start": "399199",
    "end": "400560"
  },
  {
    "text": "the tls inspection will first",
    "start": "400560",
    "end": "403759"
  },
  {
    "text": "then enforce a deny or allow decision",
    "start": "403759",
    "end": "405919"
  },
  {
    "text": "based on the reputation lookup in step",
    "start": "405919",
    "end": "408000"
  },
  {
    "text": "5. in addition as it",
    "start": "408000",
    "end": "411280"
  },
  {
    "text": "is now acting as a man in the middle it",
    "start": "411280",
    "end": "413360"
  },
  {
    "text": "can",
    "start": "413360",
    "end": "414560"
  },
  {
    "text": "inspect the traffic and data for",
    "start": "414560",
    "end": "416319"
  },
  {
    "text": "malicious content and",
    "start": "416319",
    "end": "418080"
  },
  {
    "text": "deny or allow this traffic",
    "start": "418080",
    "end": "422800"
  },
  {
    "text": "based on its policies configured",
    "start": "422800",
    "end": "426800"
  },
  {
    "text": "so um what can we do with this well",
    "start": "426800",
    "end": "431680"
  },
  {
    "text": "uh based on how these devices work we",
    "start": "431680",
    "end": "434080"
  },
  {
    "text": "figured out a way to abuse",
    "start": "434080",
    "end": "435759"
  },
  {
    "text": "the tls handshake for exfiltration in",
    "start": "435759",
    "end": "439039"
  },
  {
    "text": "some devices this will even trigger",
    "start": "439039",
    "end": "441759"
  },
  {
    "text": "false negatives",
    "start": "441759",
    "end": "442800"
  },
  {
    "text": "in the tls inspection device logs",
    "start": "442800",
    "end": "446479"
  },
  {
    "text": "which we will show you later in our",
    "start": "446479",
    "end": "449520"
  },
  {
    "text": "demo but first let's have a look at the",
    "start": "449520",
    "end": "452000"
  },
  {
    "text": "client hello in a bit more detail",
    "start": "452000",
    "end": "455599"
  },
  {
    "start": "455000",
    "end": "562000"
  },
  {
    "text": "so here we see a simplified version of",
    "start": "457360",
    "end": "459840"
  },
  {
    "text": "the tls handshake",
    "start": "459840",
    "end": "461680"
  },
  {
    "text": "with a focus on the server name",
    "start": "461680",
    "end": "464639"
  },
  {
    "text": "indication field",
    "start": "464639",
    "end": "465599"
  },
  {
    "text": "or sni in short the purpose of the",
    "start": "465599",
    "end": "469759"
  },
  {
    "text": "sni field is to tell the server which",
    "start": "469759",
    "end": "472879"
  },
  {
    "text": "domain or sites you want to visit so",
    "start": "472879",
    "end": "474720"
  },
  {
    "text": "that",
    "start": "474720",
    "end": "475120"
  },
  {
    "text": "it can present you with the correct",
    "start": "475120",
    "end": "476560"
  },
  {
    "text": "certificate as i explained earlier",
    "start": "476560",
    "end": "480639"
  },
  {
    "text": "this originally became a necessity when",
    "start": "480639",
    "end": "482800"
  },
  {
    "text": "using virtual hosting",
    "start": "482800",
    "end": "484080"
  },
  {
    "text": "where a single web server hosted",
    "start": "484080",
    "end": "486160"
  },
  {
    "text": "multiple sites with",
    "start": "486160",
    "end": "487280"
  },
  {
    "text": "different server certificates",
    "start": "487280",
    "end": "490639"
  },
  {
    "text": "any did hand and it then had to have a",
    "start": "490800",
    "end": "493120"
  },
  {
    "text": "way to",
    "start": "493120",
    "end": "494160"
  },
  {
    "text": "know uh what certificate it should",
    "start": "494160",
    "end": "496319"
  },
  {
    "text": "present to",
    "start": "496319",
    "end": "497199"
  },
  {
    "text": "the clients so sinai was a solution okay",
    "start": "497199",
    "end": "501440"
  },
  {
    "text": "but uh what if we do something nefarious",
    "start": "501440",
    "end": "504720"
  },
  {
    "text": "with sni",
    "start": "504720",
    "end": "507840"
  },
  {
    "text": "so here we uh",
    "start": "508080",
    "end": "511680"
  },
  {
    "text": "use a wildcard certificate on the web",
    "start": "511680",
    "end": "513919"
  },
  {
    "text": "server",
    "start": "513919",
    "end": "514800"
  },
  {
    "text": "for star.example.com",
    "start": "514800",
    "end": "518839"
  },
  {
    "text": "uh but we add uh example.com",
    "start": "518839",
    "end": "522880"
  },
  {
    "text": "to the sni uh but we also prepend the",
    "start": "522880",
    "end": "526080"
  },
  {
    "text": "data we",
    "start": "526080",
    "end": "527839"
  },
  {
    "text": "want to exfiltrate and then code it with",
    "start": "527839",
    "end": "530240"
  },
  {
    "text": "the base32",
    "start": "530240",
    "end": "531760"
  },
  {
    "text": "we use base32 in order to use a",
    "start": "531760",
    "end": "534959"
  },
  {
    "text": "character set",
    "start": "534959",
    "end": "535760"
  },
  {
    "text": "that is allowed in a domain name and",
    "start": "535760",
    "end": "539360"
  },
  {
    "text": "so far here we have proved that it was",
    "start": "539360",
    "end": "542800"
  },
  {
    "text": "possible to",
    "start": "542800",
    "end": "543680"
  },
  {
    "text": "send data in the sni if the complete",
    "start": "543680",
    "end": "545839"
  },
  {
    "text": "domain name matched the server",
    "start": "545839",
    "end": "547360"
  },
  {
    "text": "certificate",
    "start": "547360",
    "end": "548720"
  },
  {
    "text": "by using wildcard certificate in this",
    "start": "548720",
    "end": "550640"
  },
  {
    "text": "case",
    "start": "550640",
    "end": "552399"
  },
  {
    "text": "and that it also adhered to rfc",
    "start": "552399",
    "end": "554880"
  },
  {
    "text": "standards",
    "start": "554880",
    "end": "555600"
  },
  {
    "text": "and allowed character sets in a domain",
    "start": "555600",
    "end": "557600"
  },
  {
    "text": "name",
    "start": "557600",
    "end": "559839"
  },
  {
    "text": "so uh",
    "start": "561440",
    "end": "564880"
  },
  {
    "start": "562000",
    "end": "655000"
  },
  {
    "text": "we were able to send data out okay so",
    "start": "564880",
    "end": "568320"
  },
  {
    "text": "what's next after some tinkering we",
    "start": "568320",
    "end": "571040"
  },
  {
    "text": "discovered a",
    "start": "571040",
    "end": "572080"
  },
  {
    "text": "common denominator in every solution we",
    "start": "572080",
    "end": "574839"
  },
  {
    "text": "tested",
    "start": "574839",
    "end": "576080"
  },
  {
    "text": "as long as the server presents a valid",
    "start": "576080",
    "end": "578640"
  },
  {
    "text": "and trusted certificate",
    "start": "578640",
    "end": "579839"
  },
  {
    "text": "during the tls handshake the",
    "start": "579839",
    "end": "582959"
  },
  {
    "text": "tls inspection device will always",
    "start": "582959",
    "end": "585519"
  },
  {
    "text": "present an emulated version of that",
    "start": "585519",
    "end": "587360"
  },
  {
    "text": "certificate to the client",
    "start": "587360",
    "end": "589120"
  },
  {
    "text": "signed by the devices built in ca",
    "start": "589120",
    "end": "592160"
  },
  {
    "text": "this behavior occurs even if the domain",
    "start": "592160",
    "end": "595920"
  },
  {
    "text": "used is blacklisted by a reputation",
    "start": "595920",
    "end": "597680"
  },
  {
    "text": "database",
    "start": "597680",
    "end": "599360"
  },
  {
    "text": "as you can see it's in step 6 in this",
    "start": "599360",
    "end": "602000"
  },
  {
    "text": "diagram",
    "start": "602000",
    "end": "602720"
  },
  {
    "text": "it happens before the enforcement",
    "start": "602720",
    "end": "605839"
  },
  {
    "text": "decision so uh in",
    "start": "605839",
    "end": "609120"
  },
  {
    "text": "in addition by serving a self-signed",
    "start": "609120",
    "end": "611120"
  },
  {
    "text": "certificate from a server",
    "start": "611120",
    "end": "613279"
  },
  {
    "text": "or a unvalid untrusted certificate",
    "start": "613279",
    "end": "616959"
  },
  {
    "text": "the tls inspection solution either",
    "start": "616959",
    "end": "619440"
  },
  {
    "text": "presents the client with an emulated",
    "start": "619440",
    "end": "621279"
  },
  {
    "text": "untrusted self-signed certificate or a",
    "start": "621279",
    "end": "623920"
  },
  {
    "text": "simple tcp reset",
    "start": "623920",
    "end": "627120"
  },
  {
    "text": "so this is to highlight the fact that",
    "start": "627120",
    "end": "628880"
  },
  {
    "text": "our exfiltration method isn't just",
    "start": "628880",
    "end": "630800"
  },
  {
    "text": "another exfiltration method it also",
    "start": "630800",
    "end": "632640"
  },
  {
    "text": "manages to",
    "start": "632640",
    "end": "633839"
  },
  {
    "text": "exfiltrate before the traffic is",
    "start": "633839",
    "end": "636079"
  },
  {
    "text": "enforced blocked",
    "start": "636079",
    "end": "637279"
  },
  {
    "text": "in the next generation firewall or web",
    "start": "637279",
    "end": "640000"
  },
  {
    "text": "proxy",
    "start": "640000",
    "end": "641440"
  },
  {
    "text": "solution performing tls inspection",
    "start": "641440",
    "end": "644880"
  },
  {
    "text": "it also became a critical function",
    "start": "644880",
    "end": "648720"
  },
  {
    "text": "of how we would implement a command and",
    "start": "648720",
    "end": "651200"
  },
  {
    "text": "control solution",
    "start": "651200",
    "end": "653040"
  },
  {
    "text": "which mateo will talk about in his tale",
    "start": "653040",
    "end": "656240"
  },
  {
    "start": "655000",
    "end": "757000"
  },
  {
    "text": "yes so at the very inception or testing",
    "start": "656240",
    "end": "661279"
  },
  {
    "text": "the channel was only working one way",
    "start": "661279",
    "end": "663360"
  },
  {
    "text": "since every tesla solution was blocking",
    "start": "663360",
    "end": "665920"
  },
  {
    "text": "the returning traffic",
    "start": "665920",
    "end": "667040"
  },
  {
    "text": "coming back from the server and that was",
    "start": "667040",
    "end": "669120"
  },
  {
    "text": "obviously not",
    "start": "669120",
    "end": "670160"
  },
  {
    "text": "the optimal scenario we were stuck and",
    "start": "670160",
    "end": "674079"
  },
  {
    "text": "in in need for a new way of letting the",
    "start": "674079",
    "end": "676000"
  },
  {
    "text": "control server data pass back through",
    "start": "676000",
    "end": "677920"
  },
  {
    "text": "the security solution",
    "start": "677920",
    "end": "680800"
  },
  {
    "text": "to overcome this hurdle we built an",
    "start": "680800",
    "end": "682720"
  },
  {
    "text": "interim out-of-band c2 based on the",
    "start": "682720",
    "end": "685040"
  },
  {
    "text": "instagram social network which employed",
    "start": "685040",
    "end": "687120"
  },
  {
    "text": "embedded c2 common in control",
    "start": "687120",
    "end": "689600"
  },
  {
    "text": "inside instagram's own command section",
    "start": "689600",
    "end": "693279"
  },
  {
    "text": "this was enough to get a working demo",
    "start": "693279",
    "end": "695839"
  },
  {
    "text": "which proved our theory to be correct",
    "start": "695839",
    "end": "698560"
  },
  {
    "text": "functional and hopefully extensible we",
    "start": "698560",
    "end": "701040"
  },
  {
    "text": "were able to remotely control the",
    "start": "701040",
    "end": "702880"
  },
  {
    "text": "compromised",
    "start": "702880",
    "end": "704160"
  },
  {
    "text": "host and selectively exfiltrate data",
    "start": "704160",
    "end": "707680"
  },
  {
    "text": "then our next goal was to replace the",
    "start": "707680",
    "end": "709920"
  },
  {
    "text": "instagram component since",
    "start": "709920",
    "end": "711680"
  },
  {
    "text": "it was not stealthy and we wanted to",
    "start": "711680",
    "end": "714000"
  },
  {
    "text": "avoid relying on a",
    "start": "714000",
    "end": "715680"
  },
  {
    "text": "third party beyond our own control",
    "start": "715680",
    "end": "719760"
  },
  {
    "text": "in addition we also wanted to create a",
    "start": "719760",
    "end": "721440"
  },
  {
    "text": "synchronous c2",
    "start": "721440",
    "end": "723519"
  },
  {
    "text": "so we continue pursuing an alternative",
    "start": "723519",
    "end": "726320"
  },
  {
    "text": "of establishing an",
    "start": "726320",
    "end": "727360"
  },
  {
    "text": "end-to-end communication between the",
    "start": "727360",
    "end": "729920"
  },
  {
    "text": "agent and the commanding control server",
    "start": "729920",
    "end": "733839"
  },
  {
    "text": "on a very primitive communication",
    "start": "734399",
    "end": "736240"
  },
  {
    "text": "channel a basic response",
    "start": "736240",
    "end": "737839"
  },
  {
    "text": "will only require binary yes and no",
    "start": "737839",
    "end": "739839"
  },
  {
    "text": "capability",
    "start": "739839",
    "end": "741200"
  },
  {
    "text": "and so we added at that point a valid",
    "start": "741200",
    "end": "744079"
  },
  {
    "text": "trusted certificate",
    "start": "744079",
    "end": "745600"
  },
  {
    "text": "gives us yes an untrusted self-signed",
    "start": "745600",
    "end": "748560"
  },
  {
    "text": "certificate gives us a no",
    "start": "748560",
    "end": "751040"
  },
  {
    "text": "so we implemented this logic into our",
    "start": "751040",
    "end": "753440"
  },
  {
    "text": "sneaker tool",
    "start": "753440",
    "end": "756160"
  },
  {
    "start": "757000",
    "end": "841000"
  },
  {
    "text": "let's have a let's have a talk about",
    "start": "757600",
    "end": "761040"
  },
  {
    "text": "how we can explain a little bit more the",
    "start": "761040",
    "end": "763519"
  },
  {
    "text": "mechanism between the agent and the and",
    "start": "763519",
    "end": "765519"
  },
  {
    "text": "the c2",
    "start": "765519",
    "end": "766720"
  },
  {
    "text": "so the agent is shipped with the",
    "start": "766720",
    "end": "769360"
  },
  {
    "text": "predefined",
    "start": "769360",
    "end": "770160"
  },
  {
    "text": "set of command and it loops it starts by",
    "start": "770160",
    "end": "773200"
  },
  {
    "text": "looping through every every command",
    "start": "773200",
    "end": "776560"
  },
  {
    "text": "and after each loop it sends",
    "start": "776560",
    "end": "780720"
  },
  {
    "text": "a request to the c2 and the cto replies",
    "start": "780720",
    "end": "783519"
  },
  {
    "text": "with an untrusted certificate",
    "start": "783519",
    "end": "785839"
  },
  {
    "text": "until a matching command is found the",
    "start": "785839",
    "end": "787920"
  },
  {
    "text": "matching command is",
    "start": "787920",
    "end": "789040"
  },
  {
    "text": "obviously the command issued by the c2",
    "start": "789040",
    "end": "792079"
  },
  {
    "text": "operator in this case",
    "start": "792079",
    "end": "795199"
  },
  {
    "text": "then when the c2",
    "start": "795519",
    "end": "798720"
  },
  {
    "text": "is matching the command it replies with",
    "start": "798720",
    "end": "801360"
  },
  {
    "text": "a trusted certificate",
    "start": "801360",
    "end": "802560"
  },
  {
    "text": "indicating to the client that it should",
    "start": "802560",
    "end": "804240"
  },
  {
    "text": "execute this very command",
    "start": "804240",
    "end": "807680"
  },
  {
    "text": "for example if the operator has issued",
    "start": "809040",
    "end": "811519"
  },
  {
    "text": "an ls",
    "start": "811519",
    "end": "812959"
  },
  {
    "text": "command the agent encodes the file list",
    "start": "812959",
    "end": "815279"
  },
  {
    "text": "with the base 32",
    "start": "815279",
    "end": "817120"
  },
  {
    "text": "and appends a special training code by",
    "start": "817120",
    "end": "819920"
  },
  {
    "text": "the end of it just to notify the city",
    "start": "819920",
    "end": "821839"
  },
  {
    "text": "that the appellate is over",
    "start": "821839",
    "end": "823120"
  },
  {
    "text": "and and then it can just decode",
    "start": "823120",
    "end": "825839"
  },
  {
    "text": "everything",
    "start": "825839",
    "end": "826639"
  },
  {
    "text": "at once at this point now",
    "start": "826639",
    "end": "830720"
  },
  {
    "text": "both the c2 and the agent have identical",
    "start": "830720",
    "end": "833279"
  },
  {
    "text": "copies of the file list",
    "start": "833279",
    "end": "834639"
  },
  {
    "text": "so the c2 can actually",
    "start": "834639",
    "end": "837839"
  },
  {
    "text": "react upon this logic",
    "start": "837839",
    "end": "843519"
  },
  {
    "text": "yes if we dig a little bit better",
    "start": "843519",
    "end": "846720"
  },
  {
    "text": "and deeper let's uh let's see um",
    "start": "846720",
    "end": "850399"
  },
  {
    "text": "on the agent from the agent point of",
    "start": "850399",
    "end": "852320"
  },
  {
    "text": "view an example of no matching command",
    "start": "852320",
    "end": "855120"
  },
  {
    "text": "and above cert from the client side and",
    "start": "855120",
    "end": "858800"
  },
  {
    "text": "we can see that the the operator well",
    "start": "858800",
    "end": "862079"
  },
  {
    "text": "in the the agent in this case uh is",
    "start": "862079",
    "end": "864480"
  },
  {
    "text": "trying to send the",
    "start": "864480",
    "end": "865519"
  },
  {
    "text": "cd command and we can also see",
    "start": "865519",
    "end": "868880"
  },
  {
    "text": "a random string appended to the command",
    "start": "868880",
    "end": "871440"
  },
  {
    "text": "what's that",
    "start": "871440",
    "end": "873279"
  },
  {
    "text": "this is a is made in order to prevent",
    "start": "873279",
    "end": "876079"
  },
  {
    "text": "tls inspection device from caching",
    "start": "876079",
    "end": "878560"
  },
  {
    "text": "the certificate response from our c2",
    "start": "878560",
    "end": "881600"
  },
  {
    "text": "and we can also see that the handshakes",
    "start": "881600",
    "end": "883920"
  },
  {
    "text": "fail so this",
    "start": "883920",
    "end": "884880"
  },
  {
    "text": "was not the the internet command by the",
    "start": "884880",
    "end": "887120"
  },
  {
    "text": "c2 operator",
    "start": "887120",
    "end": "888560"
  },
  {
    "text": "we can also notice that this is not a",
    "start": "888560",
    "end": "890560"
  },
  {
    "text": "trusted certificate since it's",
    "start": "890560",
    "end": "892160"
  },
  {
    "text": "uh uh ubuntu generic self-signed",
    "start": "892160",
    "end": "896839"
  },
  {
    "text": "certificate",
    "start": "896839",
    "end": "898240"
  },
  {
    "start": "897000",
    "end": "920000"
  },
  {
    "text": "yeah in this uh traffic capture on the",
    "start": "898240",
    "end": "901519"
  },
  {
    "text": "other hand we can see that the",
    "start": "901519",
    "end": "903360"
  },
  {
    "text": "the c2 operator it's actually issued the",
    "start": "903360",
    "end": "906000"
  },
  {
    "text": "the work command",
    "start": "906000",
    "end": "907279"
  },
  {
    "text": "this is still captured from the agent",
    "start": "907279",
    "end": "909199"
  },
  {
    "text": "perspective and we can see that the the",
    "start": "909199",
    "end": "911360"
  },
  {
    "text": "handshake",
    "start": "911360",
    "end": "912000"
  },
  {
    "text": "has completed successfully because",
    "start": "912000",
    "end": "914399"
  },
  {
    "text": "there's no",
    "start": "914399",
    "end": "915040"
  },
  {
    "text": "reset and we can also see",
    "start": "915040",
    "end": "918800"
  },
  {
    "text": "the payload coming through and on this",
    "start": "918800",
    "end": "921839"
  },
  {
    "text": "slide",
    "start": "921839",
    "end": "922480"
  },
  {
    "text": "we can also see that this the",
    "start": "922480",
    "end": "924839"
  },
  {
    "text": "certificate",
    "start": "924839",
    "end": "926079"
  },
  {
    "text": "it's the it's a weicker certificate",
    "start": "926079",
    "end": "928000"
  },
  {
    "text": "trusted by tls inspection device",
    "start": "928000",
    "end": "930560"
  },
  {
    "text": "because it's signed by a public",
    "start": "930560",
    "end": "932079"
  },
  {
    "text": "well-known ca",
    "start": "932079",
    "end": "935120"
  },
  {
    "text": "yeah and we can also have a",
    "start": "935120",
    "end": "938639"
  },
  {
    "text": "brief look at the core functionality on",
    "start": "938639",
    "end": "941440"
  },
  {
    "start": "939000",
    "end": "1019000"
  },
  {
    "text": "the on the codebase this is an",
    "start": "941440",
    "end": "943199"
  },
  {
    "text": "excerpt from the github repo and it",
    "start": "943199",
    "end": "946000"
  },
  {
    "text": "highlights a few core functionalities of",
    "start": "946000",
    "end": "947759"
  },
  {
    "text": "the sneaker tool",
    "start": "947759",
    "end": "950240"
  },
  {
    "text": "on the left on the left side we can see",
    "start": "950240",
    "end": "952720"
  },
  {
    "text": "the",
    "start": "952720",
    "end": "953440"
  },
  {
    "text": "c2 uh bit where it passes the",
    "start": "953440",
    "end": "956880"
  },
  {
    "text": "the tls packet and",
    "start": "956880",
    "end": "959920"
  },
  {
    "text": "in particular the the yellow packet and",
    "start": "959920",
    "end": "962560"
  },
  {
    "text": "it's",
    "start": "962560",
    "end": "963120"
  },
  {
    "text": "just react based on the on the value",
    "start": "963120",
    "end": "966639"
  },
  {
    "text": "inside it",
    "start": "966639",
    "end": "967519"
  },
  {
    "text": "with the good context or bad tls",
    "start": "967519",
    "end": "971360"
  },
  {
    "text": "context so basically a trust cert and",
    "start": "971360",
    "end": "974560"
  },
  {
    "text": "and the untrusted cert as we as we saw",
    "start": "974560",
    "end": "976800"
  },
  {
    "text": "earlier",
    "start": "976800",
    "end": "978000"
  },
  {
    "text": "on the right side instead we can see the",
    "start": "978000",
    "end": "980720"
  },
  {
    "text": "agent",
    "start": "980720",
    "end": "981519"
  },
  {
    "text": "uh code snippet where it actually",
    "start": "981519",
    "end": "984160"
  },
  {
    "text": "encodes the",
    "start": "984160",
    "end": "985040"
  },
  {
    "text": "the um comma output payload in the",
    "start": "985040",
    "end": "989360"
  },
  {
    "text": "base 32 encode fashion and",
    "start": "989360",
    "end": "993519"
  },
  {
    "text": "um the payload is actually divided into",
    "start": "993519",
    "end": "996399"
  },
  {
    "text": "chunks",
    "start": "996399",
    "end": "997360"
  },
  {
    "text": "of the maximum length allowed and then",
    "start": "997360",
    "end": "1000000"
  },
  {
    "text": "it is",
    "start": "1000000",
    "end": "1000639"
  },
  {
    "text": "trailed with the with the finito code",
    "start": "1000639",
    "end": "1002959"
  },
  {
    "text": "which is the",
    "start": "1002959",
    "end": "1003920"
  },
  {
    "text": "a way to tell the c2 that the payload is",
    "start": "1003920",
    "end": "1006320"
  },
  {
    "text": "finished and completed",
    "start": "1006320",
    "end": "1008000"
  },
  {
    "text": "so you can just parse it to the operator",
    "start": "1008000",
    "end": "1012560"
  },
  {
    "text": "yes then at this point we decided to",
    "start": "1012560",
    "end": "1015600"
  },
  {
    "text": "build mitigation and detections of our",
    "start": "1015600",
    "end": "1019120"
  },
  {
    "start": "1019000",
    "end": "1121000"
  },
  {
    "text": "own tool",
    "start": "1019120",
    "end": "1021519"
  },
  {
    "text": "so um",
    "start": "1021759",
    "end": "1025120"
  },
  {
    "text": "first from a tls inspection device point",
    "start": "1025120",
    "end": "1027199"
  },
  {
    "text": "of view we recommend",
    "start": "1027199",
    "end": "1028959"
  },
  {
    "text": "changing the blocked url categories",
    "start": "1028959",
    "end": "1031520"
  },
  {
    "text": "logic",
    "start": "1031520",
    "end": "1032079"
  },
  {
    "text": "logic to match the sni field and thus",
    "start": "1032079",
    "end": "1034959"
  },
  {
    "text": "block",
    "start": "1034959",
    "end": "1035438"
  },
  {
    "text": "or allow any session in case of a match",
    "start": "1035439",
    "end": "1038160"
  },
  {
    "text": "occurring",
    "start": "1038160",
    "end": "1039678"
  },
  {
    "text": "this should actually be performed before",
    "start": "1039679",
    "end": "1041918"
  },
  {
    "text": "completing the server-side tls and shake",
    "start": "1041919",
    "end": "1044400"
  },
  {
    "text": "and this way the data in the malicious",
    "start": "1044400",
    "end": "1047038"
  },
  {
    "text": "sni will not be passed to the",
    "start": "1047039",
    "end": "1049360"
  },
  {
    "text": "c2 if the site is already restricted by",
    "start": "1049360",
    "end": "1051919"
  },
  {
    "text": "the blacklist or if it's not matching an",
    "start": "1051919",
    "end": "1053679"
  },
  {
    "text": "explicit whitelist",
    "start": "1053679",
    "end": "1056799"
  },
  {
    "text": "and we also have detection in the",
    "start": "1057679",
    "end": "1059840"
  },
  {
    "text": "security parameter",
    "start": "1059840",
    "end": "1061120"
  },
  {
    "text": "and in in the sense that performing",
    "start": "1061120",
    "end": "1063760"
  },
  {
    "text": "heuristic on the",
    "start": "1063760",
    "end": "1065200"
  },
  {
    "text": "clientele osni what we did we",
    "start": "1065200",
    "end": "1068799"
  },
  {
    "text": "have successfully used custom logic to",
    "start": "1068799",
    "end": "1070880"
  },
  {
    "text": "perform an entropy check",
    "start": "1070880",
    "end": "1072720"
  },
  {
    "text": "on the esi field and detect anomalous",
    "start": "1072720",
    "end": "1075120"
  },
  {
    "text": "sni by utilizing this method",
    "start": "1075120",
    "end": "1077600"
  },
  {
    "text": "mnemonic also developed the cervical ids",
    "start": "1077600",
    "end": "1079919"
  },
  {
    "text": "signature to specify",
    "start": "1079919",
    "end": "1081679"
  },
  {
    "text": "to specifically detect our tool",
    "start": "1081679",
    "end": "1085919"
  },
  {
    "text": "yeah and finally we also developed a",
    "start": "1085919",
    "end": "1089679"
  },
  {
    "text": "very very early stage proof of concept",
    "start": "1089679",
    "end": "1092400"
  },
  {
    "text": "of a passive sni detection tool which is",
    "start": "1092400",
    "end": "1095440"
  },
  {
    "text": "conceptually similar to the well-known",
    "start": "1095440",
    "end": "1097360"
  },
  {
    "text": "passive dns application",
    "start": "1097360",
    "end": "1099200"
  },
  {
    "text": "and it works by constantly monitoring",
    "start": "1099200",
    "end": "1101760"
  },
  {
    "text": "and logging every tls slow packets sent",
    "start": "1101760",
    "end": "1104160"
  },
  {
    "text": "through any network socket interface on",
    "start": "1104160",
    "end": "1106240"
  },
  {
    "text": "the",
    "start": "1106240",
    "end": "1106880"
  },
  {
    "text": "on the hand host these generator logs",
    "start": "1106880",
    "end": "1109600"
  },
  {
    "text": "can",
    "start": "1109600",
    "end": "1110080"
  },
  {
    "text": "also be gathered and analyzed through a",
    "start": "1110080",
    "end": "1112320"
  },
  {
    "text": "cm solution",
    "start": "1112320",
    "end": "1113360"
  },
  {
    "text": "against any well-known signature or",
    "start": "1113360",
    "end": "1115600"
  },
  {
    "text": "behavioral analytics",
    "start": "1115600",
    "end": "1118320"
  },
  {
    "text": "yeah let's jump to",
    "start": "1118320",
    "end": "1121600"
  },
  {
    "start": "1121000",
    "end": "1210000"
  },
  {
    "text": "conclusion yeah so",
    "start": "1121600",
    "end": "1126080"
  },
  {
    "text": "core features of today's security per",
    "start": "1126080",
    "end": "1128080"
  },
  {
    "text": "meter solution",
    "start": "1128080",
    "end": "1129440"
  },
  {
    "text": "is to detect and prevent malicious",
    "start": "1129440",
    "end": "1131600"
  },
  {
    "text": "traffic from passing through",
    "start": "1131600",
    "end": "1134000"
  },
  {
    "text": "we attacked those features from",
    "start": "1134000",
    "end": "1135760"
  },
  {
    "text": "different angles and discovered that no",
    "start": "1135760",
    "end": "1138160"
  },
  {
    "text": "tls inspection solution",
    "start": "1138160",
    "end": "1140080"
  },
  {
    "text": "analyzed the very start of a session",
    "start": "1140080",
    "end": "1143520"
  },
  {
    "text": "we hope to improve such appliance by",
    "start": "1143520",
    "end": "1145520"
  },
  {
    "text": "raising the bar on how",
    "start": "1145520",
    "end": "1146720"
  },
  {
    "text": "tls session is handled and scrutinized",
    "start": "1146720",
    "end": "1149120"
  },
  {
    "text": "by these products",
    "start": "1149120",
    "end": "1151840"
  },
  {
    "text": "we could also speculate that other",
    "start": "1151840",
    "end": "1153520"
  },
  {
    "text": "vendors than those mentioned in the",
    "start": "1153520",
    "end": "1155200"
  },
  {
    "text": "stock are affected by sneakers even",
    "start": "1155200",
    "end": "1157039"
  },
  {
    "text": "though",
    "start": "1157039",
    "end": "1157840"
  },
  {
    "text": "it will have been interesting to test",
    "start": "1157840",
    "end": "1159679"
  },
  {
    "text": "every network",
    "start": "1159679",
    "end": "1160960"
  },
  {
    "text": "security solution on the market we had",
    "start": "1160960",
    "end": "1163120"
  },
  {
    "text": "actually limited resources",
    "start": "1163120",
    "end": "1164880"
  },
  {
    "text": "and and scope this time",
    "start": "1164880",
    "end": "1168559"
  },
  {
    "text": "and we therefore advise vendors to test",
    "start": "1168559",
    "end": "1171200"
  },
  {
    "text": "uh",
    "start": "1171200",
    "end": "1171600"
  },
  {
    "text": "if their products is vulnerable not to",
    "start": "1171600",
    "end": "1174160"
  },
  {
    "text": "to sneak at",
    "start": "1174160",
    "end": "1176799"
  },
  {
    "text": "um again there's no silver bullet and",
    "start": "1177200",
    "end": "1179919"
  },
  {
    "text": "the",
    "start": "1179919",
    "end": "1180480"
  },
  {
    "text": "defense in depth is the it's still uh",
    "start": "1180480",
    "end": "1183360"
  },
  {
    "text": "chief",
    "start": "1183360",
    "end": "1183760"
  },
  {
    "text": "on that so um it can be taken for",
    "start": "1183760",
    "end": "1187520"
  },
  {
    "text": "granted by it but",
    "start": "1187520",
    "end": "1188880"
  },
  {
    "text": "it's still important and we demonstrated",
    "start": "1188880",
    "end": "1191600"
  },
  {
    "text": "this fact when",
    "start": "1191600",
    "end": "1192880"
  },
  {
    "text": "bypassing the security features of tls",
    "start": "1192880",
    "end": "1195280"
  },
  {
    "text": "inspection devices",
    "start": "1195280",
    "end": "1197679"
  },
  {
    "text": "and in addition end user and enterprises",
    "start": "1197679",
    "end": "1201120"
  },
  {
    "text": "may find it helpful to test their",
    "start": "1201120",
    "end": "1202720"
  },
  {
    "text": "solution with our proof of concept code",
    "start": "1202720",
    "end": "1204640"
  },
  {
    "text": "that is",
    "start": "1204640",
    "end": "1205120"
  },
  {
    "text": "it's available on on github so feel free",
    "start": "1205120",
    "end": "1207440"
  },
  {
    "text": "to test sneak it",
    "start": "1207440",
    "end": "1208559"
  },
  {
    "text": "on your own yeah",
    "start": "1208559",
    "end": "1211600"
  },
  {
    "start": "1210000",
    "end": "1243000"
  },
  {
    "text": "so uh sneak out is a project conducted",
    "start": "1211600",
    "end": "1214159"
  },
  {
    "text": "by us",
    "start": "1214159",
    "end": "1214640"
  },
  {
    "text": "while we were working in demonic a",
    "start": "1214640",
    "end": "1216320"
  },
  {
    "text": "norway region cyber security company",
    "start": "1216320",
    "end": "1218880"
  },
  {
    "text": "and uh as we said earlier it is",
    "start": "1218880",
    "end": "1222159"
  },
  {
    "text": "open source so feel free to try it out",
    "start": "1222159",
    "end": "1226080"
  },
  {
    "text": "we have the github link here and also if",
    "start": "1226080",
    "end": "1229120"
  },
  {
    "text": "you want to read more about the story of",
    "start": "1229120",
    "end": "1230799"
  },
  {
    "text": "house",
    "start": "1230799",
    "end": "1231440"
  },
  {
    "text": "kneecat came to be there's a blog post",
    "start": "1231440",
    "end": "1234159"
  },
  {
    "text": "at mnemonics",
    "start": "1234159",
    "end": "1235120"
  },
  {
    "text": "website as well so yeah with that being",
    "start": "1235120",
    "end": "1238320"
  },
  {
    "text": "said i think",
    "start": "1238320",
    "end": "1239140"
  },
  {
    "text": "[Music]",
    "start": "1239140",
    "end": "1240400"
  },
  {
    "text": "it's time to introduce you guys for a",
    "start": "1240400",
    "end": "1242960"
  },
  {
    "text": "demo",
    "start": "1242960",
    "end": "1243600"
  },
  {
    "start": "1243000",
    "end": "1290000"
  },
  {
    "text": "yay so okay let's talk a bit about the",
    "start": "1243600",
    "end": "1246880"
  },
  {
    "text": "demo environment before",
    "start": "1246880",
    "end": "1248000"
  },
  {
    "text": "we begin it is a simulated environment",
    "start": "1248000",
    "end": "1251919"
  },
  {
    "text": "where we have a simulated compromised",
    "start": "1251919",
    "end": "1255280"
  },
  {
    "text": "client on the inside network",
    "start": "1255280",
    "end": "1259120"
  },
  {
    "text": "and we have a c2",
    "start": "1259120",
    "end": "1262480"
  },
  {
    "text": "server on on the outside network",
    "start": "1262480",
    "end": "1264960"
  },
  {
    "text": "simulating a threat actor on the",
    "start": "1264960",
    "end": "1266559"
  },
  {
    "text": "internet",
    "start": "1266559",
    "end": "1267760"
  },
  {
    "text": "and in between the two hosts we have a",
    "start": "1267760",
    "end": "1272480"
  },
  {
    "text": "palo alto next generation firewall um",
    "start": "1272480",
    "end": "1277840"
  },
  {
    "text": "using tls inspection and threat",
    "start": "1277919",
    "end": "1280559"
  },
  {
    "text": "prevention features",
    "start": "1280559",
    "end": "1283200"
  },
  {
    "text": "so let's go over to the",
    "start": "1283200",
    "end": "1288320"
  },
  {
    "text": "demo",
    "start": "1288840",
    "end": "1291760"
  },
  {
    "start": "1290000",
    "end": "1338000"
  },
  {
    "text": "so here this is um the client",
    "start": "1291760",
    "end": "1295919"
  },
  {
    "text": "and um as you can see uh i have tried to",
    "start": "1295919",
    "end": "1300240"
  },
  {
    "text": "uh to visit a website here with my",
    "start": "1300240",
    "end": "1302320"
  },
  {
    "text": "browser um",
    "start": "1302320",
    "end": "1304400"
  },
  {
    "text": "and this is the domain name of our",
    "start": "1304400",
    "end": "1307600"
  },
  {
    "text": "c2 server and i added",
    "start": "1307600",
    "end": "1310640"
  },
  {
    "text": "the this domain name to a custom",
    "start": "1310640",
    "end": "1313919"
  },
  {
    "text": "category on the palato",
    "start": "1313919",
    "end": "1315919"
  },
  {
    "text": "that should be blocked and as you can",
    "start": "1315919",
    "end": "1318159"
  },
  {
    "text": "see this is the web page that",
    "start": "1318159",
    "end": "1319760"
  },
  {
    "text": "is returned to me by the palo alto",
    "start": "1319760",
    "end": "1321840"
  },
  {
    "text": "device",
    "start": "1321840",
    "end": "1323280"
  },
  {
    "text": "saying that the traffic was blocked and",
    "start": "1323280",
    "end": "1326480"
  },
  {
    "text": "yes it actually is blocked so",
    "start": "1326480",
    "end": "1330000"
  },
  {
    "text": "are we safe then um well let's see let's",
    "start": "1330000",
    "end": "1333120"
  },
  {
    "text": "try with sneak out instead",
    "start": "1333120",
    "end": "1334480"
  },
  {
    "text": "instead of ordinary browsing",
    "start": "1334480",
    "end": "1338640"
  },
  {
    "text": "so okay let's try to fire up sneak out",
    "start": "1338640",
    "end": "1341280"
  },
  {
    "text": "on the client",
    "start": "1341280",
    "end": "1342960"
  },
  {
    "text": "in the context of the current logged on",
    "start": "1342960",
    "end": "1345919"
  },
  {
    "text": "user",
    "start": "1345919",
    "end": "1347520"
  },
  {
    "text": "okay it's idle waiting for the c2",
    "start": "1347520",
    "end": "1351039"
  },
  {
    "text": "okay then so let's move over to the",
    "start": "1351039",
    "end": "1354240"
  },
  {
    "text": "host our c2 server and",
    "start": "1354240",
    "end": "1357840"
  },
  {
    "text": "fire up the c2 here we",
    "start": "1357840",
    "end": "1361440"
  },
  {
    "text": "run it as root because we listen on port",
    "start": "1361440",
    "end": "1364159"
  },
  {
    "text": "443",
    "start": "1364159",
    "end": "1366480"
  },
  {
    "text": "so this is the c2",
    "start": "1366480",
    "end": "1369679"
  },
  {
    "text": "and as you can see we have a help",
    "start": "1369919",
    "end": "1372559"
  },
  {
    "text": "command here",
    "start": "1372559",
    "end": "1373440"
  },
  {
    "text": "where we can display all our",
    "start": "1373440",
    "end": "1376640"
  },
  {
    "text": "predefined commands feel free to extend",
    "start": "1376640",
    "end": "1379200"
  },
  {
    "text": "uh",
    "start": "1379200",
    "end": "1379840"
  },
  {
    "text": "with more commands uh it's open source",
    "start": "1379840",
    "end": "1382080"
  },
  {
    "text": "so yeah",
    "start": "1382080",
    "end": "1383760"
  },
  {
    "text": "be our guest uh it's um",
    "start": "1383760",
    "end": "1386799"
  },
  {
    "text": "basically most of these are basically",
    "start": "1386799",
    "end": "1388720"
  },
  {
    "text": "aliases of",
    "start": "1388720",
    "end": "1390799"
  },
  {
    "text": "linux commands that are necessary to",
    "start": "1390799",
    "end": "1393760"
  },
  {
    "text": "navigate",
    "start": "1393760",
    "end": "1394480"
  },
  {
    "text": "in a file system so now that the client",
    "start": "1394480",
    "end": "1398159"
  },
  {
    "text": "is constantly",
    "start": "1398159",
    "end": "1398960"
  },
  {
    "text": "pulling the server let's try to",
    "start": "1398960",
    "end": "1402400"
  },
  {
    "text": "use the wear command to see where in the",
    "start": "1402400",
    "end": "1406960"
  },
  {
    "text": "directory we exist on the client which",
    "start": "1407120",
    "end": "1410080"
  },
  {
    "text": "is basically basically the same as the",
    "start": "1410080",
    "end": "1411600"
  },
  {
    "text": "as the linux pwd command",
    "start": "1411600",
    "end": "1413760"
  },
  {
    "text": "yeah so here we go we got our reply",
    "start": "1413760",
    "end": "1417200"
  },
  {
    "text": "uh the home folder of this user and it",
    "start": "1417200",
    "end": "1420240"
  },
  {
    "text": "changed our output on the shell as well",
    "start": "1420240",
    "end": "1423120"
  },
  {
    "text": "so we can see where we are at all times",
    "start": "1423120",
    "end": "1426240"
  },
  {
    "text": "okay let's try something more",
    "start": "1426240",
    "end": "1427600"
  },
  {
    "text": "interesting see what files are in that",
    "start": "1427600",
    "end": "1429279"
  },
  {
    "text": "directory",
    "start": "1429279",
    "end": "1430400"
  },
  {
    "text": "so let's try the ls command yeah",
    "start": "1430400",
    "end": "1433840"
  },
  {
    "text": "okay that was fast reply ls command okay",
    "start": "1433840",
    "end": "1436960"
  },
  {
    "text": "so we got a list of three files in the",
    "start": "1436960",
    "end": "1440080"
  },
  {
    "text": "directory in the client",
    "start": "1440080",
    "end": "1441840"
  },
  {
    "text": "and they are indexed with numbers in",
    "start": "1441840",
    "end": "1443600"
  },
  {
    "text": "order to easily identify them when we",
    "start": "1443600",
    "end": "1445760"
  },
  {
    "text": "want to exfiltrate",
    "start": "1445760",
    "end": "1447039"
  },
  {
    "text": "file number one looks very juicy yeah",
    "start": "1447039",
    "end": "1449279"
  },
  {
    "text": "let's try that",
    "start": "1449279",
    "end": "1450640"
  },
  {
    "text": "file number one export rate",
    "start": "1450640",
    "end": "1458080"
  },
  {
    "text": "here we go secrets dot text executed",
    "start": "1458080",
    "end": "1460480"
  },
  {
    "text": "successfully",
    "start": "1460480",
    "end": "1461760"
  },
  {
    "text": "yeah let's have a look at it then",
    "start": "1461760",
    "end": "1464880"
  },
  {
    "text": "hey cheesy credentials and",
    "start": "1467760",
    "end": "1470960"
  },
  {
    "text": "yeah yeah very interesting yeah gluten",
    "start": "1470960",
    "end": "1473360"
  },
  {
    "text": "root yes so",
    "start": "1473360",
    "end": "1474640"
  },
  {
    "text": "uh then the interesting question is uh",
    "start": "1474640",
    "end": "1476960"
  },
  {
    "text": "what happened uh",
    "start": "1476960",
    "end": "1479120"
  },
  {
    "text": "in the last inspection device well let's",
    "start": "1479120",
    "end": "1481679"
  },
  {
    "text": "have a look",
    "start": "1481679",
    "end": "1482880"
  },
  {
    "text": "because this was supposed to be blocked",
    "start": "1482880",
    "end": "1484240"
  },
  {
    "text": "right so this is the palo alto interface",
    "start": "1484240",
    "end": "1487520"
  },
  {
    "text": "i'm going to open the logs now refresh",
    "start": "1487520",
    "end": "1489919"
  },
  {
    "text": "them",
    "start": "1489919",
    "end": "1491679"
  },
  {
    "text": "and here you can see all our sni",
    "start": "1491679",
    "end": "1495279"
  },
  {
    "text": "registered as urls in the custom",
    "start": "1495279",
    "end": "1497679"
  },
  {
    "text": "category block",
    "start": "1497679",
    "end": "1499679"
  },
  {
    "text": "these things are looks like they're",
    "start": "1499679",
    "end": "1501520"
  },
  {
    "text": "blocked",
    "start": "1501520",
    "end": "1502720"
  },
  {
    "text": "but in reality they were not as you",
    "start": "1502720",
    "end": "1504480"
  },
  {
    "text": "could see",
    "start": "1504480",
    "end": "1506000"
  },
  {
    "text": "so these are false false negatives sorry",
    "start": "1506000",
    "end": "1508159"
  },
  {
    "text": "in the log",
    "start": "1508159",
    "end": "1509840"
  },
  {
    "text": "which is quite interesting so an",
    "start": "1509840",
    "end": "1511440"
  },
  {
    "text": "administrator would think these were",
    "start": "1511440",
    "end": "1512640"
  },
  {
    "text": "blocked but in reality they are not",
    "start": "1512640",
    "end": "1516080"
  },
  {
    "start": "1515000",
    "end": "1530000"
  },
  {
    "text": "so yeah that concludes uh our demo",
    "start": "1516080",
    "end": "1519120"
  },
  {
    "text": "um and um",
    "start": "1519120",
    "end": "1522640"
  },
  {
    "text": "thank you thank you if you have any",
    "start": "1522640",
    "end": "1524799"
  },
  {
    "text": "questions",
    "start": "1524799",
    "end": "1525840"
  },
  {
    "text": "please reach out reach out we're here",
    "start": "1525840",
    "end": "1528400"
  },
  {
    "text": "thank you thank you",
    "start": "1528400",
    "end": "1532720"
  }
]