[
  {
    "start": "52000",
    "end": "52000"
  },
  {
    "text": "now is it working okay there we go can you hear me now um all right",
    "start": "56320",
    "end": "62160"
  },
  {
    "text": "this is on uh well this pretty much says it exploiting abusing securing server",
    "start": "62160",
    "end": "68799"
  },
  {
    "text": "extensions windows server 2003",
    "start": "68799",
    "end": "72720"
  },
  {
    "text": "the uh okay this is going to be interesting because",
    "start": "75840",
    "end": "80880"
  },
  {
    "text": "um well the server extensions have had an interesting history um",
    "start": "80880",
    "end": "88159"
  },
  {
    "text": "they originally purchased from vermeer technologies uh for like",
    "start": "88159",
    "end": "93840"
  },
  {
    "text": "80 million dollars in stock or 80 80 to 100 million dollars in stock um they",
    "start": "93840",
    "end": "102479"
  },
  {
    "text": "have had a bad reputation security reputation um",
    "start": "103600",
    "end": "109119"
  },
  {
    "text": "and well a lot of people just stop putting them on their server a lot of people a",
    "start": "109439",
    "end": "115520"
  },
  {
    "text": "lot of checklists recommend not installing the server extensions on on a production server um",
    "start": "115520",
    "end": "122719"
  },
  {
    "text": "and a lot of people quite frequently ask me if if they can be secure",
    "start": "122719",
    "end": "129759"
  },
  {
    "text": "and for quite some time i told people no they cannot be made secure and you should not run them on a",
    "start": "129759",
    "end": "136480"
  },
  {
    "text": "on a server on a production server but this presentation is about how to make them secure um",
    "start": "136480",
    "end": "143599"
  },
  {
    "text": "they uh serve extensions for a while we thought where they were gonna die you know they",
    "start": "143599",
    "end": "149840"
  },
  {
    "start": "146000",
    "end": "146000"
  },
  {
    "text": "people stopped putting them on their servers but um they seem to have made a little bit of a combat uh come come back",
    "start": "149840",
    "end": "155599"
  },
  {
    "text": "here they have been included on a lot of new products sharepoint",
    "start": "155599",
    "end": "162400"
  },
  {
    "text": "uh office xp uh",
    "start": "162400",
    "end": "168000"
  },
  {
    "text": "um visualstudio.net and it seems like they're here to stay",
    "start": "168840",
    "end": "174560"
  },
  {
    "text": "so the question is how do we secure them but let you know let me start off with my my experience with the front page",
    "start": "174560",
    "end": "180959"
  },
  {
    "text": "server extensions just right here um i started off",
    "start": "180959",
    "end": "186400"
  },
  {
    "text": "playing around with them right when they first came out um the i was learning html and so i'd i'd open",
    "start": "186400",
    "end": "194319"
  },
  {
    "text": "up websites and learn how to write their code how they do all the different tricks and um i noticed that",
    "start": "194319",
    "end": "200879"
  },
  {
    "text": "some sites would open up just fine some sites would prompt me for a password and",
    "start": "200879",
    "end": "205920"
  },
  {
    "text": "then some sites would open up and give me server-side code and at the time i knew nothing about security",
    "start": "205920",
    "end": "213040"
  },
  {
    "text": "um but you know i i knew something was up there and so i i started spending some",
    "start": "213040",
    "end": "218560"
  },
  {
    "text": "time researching and actually my the front page server extensions were the first security work that i did and it's kind",
    "start": "218560",
    "end": "225280"
  },
  {
    "text": "of what got me into security but uh well kind of got me into what got me into",
    "start": "225280",
    "end": "230799"
  },
  {
    "text": "security but anyway the uh",
    "start": "230799",
    "end": "238720"
  },
  {
    "text": "i started playing around and i started realizing a lot of sites had server extensions and a lot of sites had the",
    "start": "239200",
    "end": "244720"
  },
  {
    "text": "server extensions running in securely um and just to give you a couple stories here um",
    "start": "244720",
    "end": "252319"
  },
  {
    "text": "uh",
    "start": "253120",
    "end": "255840"
  },
  {
    "text": "trying to decide which stories i can tell um well okay let's start with this one the",
    "start": "258239",
    "end": "263520"
  },
  {
    "text": "uh there was a friend of mine who who got very angry with a company",
    "start": "263520",
    "end": "269199"
  },
  {
    "text": "and went to their website and on the website has this this uh the owner of the company who was the guy who made him",
    "start": "269199",
    "end": "275759"
  },
  {
    "text": "angry uh this big picture on the front page of the website so what he did is uh took",
    "start": "275759",
    "end": "281759"
  },
  {
    "text": "him about 10 seconds to figure out that the front page sir extensions were on there and they were not secure",
    "start": "281759",
    "end": "286800"
  },
  {
    "text": "so he took the guy's picture and kind of modified it a little bit it was real subtle you know he just made one ear",
    "start": "286800",
    "end": "292240"
  },
  {
    "text": "bigger um you know kai's power go stuff um and i've saved it put it back on there",
    "start": "292240",
    "end": "298400"
  },
  {
    "text": "and and it was there for a week um i thought it was really cool we all thought it was cool",
    "start": "298400",
    "end": "304960"
  },
  {
    "text": "so we went back again changed the pitch a little bit more um",
    "start": "304960",
    "end": "311199"
  },
  {
    "text": "uh this picture was there for a week he changed it more changed it more changed it more got to the point where",
    "start": "311199",
    "end": "316560"
  },
  {
    "text": "this guy picture on the front page of the website by the way the the picture it looks like a alfred newman spock",
    "start": "316560",
    "end": "323600"
  },
  {
    "text": "troll i mean his face was so distorted but it was such a subtle thing that no one ever really picked up on it um and",
    "start": "323600",
    "end": "329840"
  },
  {
    "text": "it was there for like two months and this guy did this every day as this morning ritual he'd go in you know check his email",
    "start": "329840",
    "end": "335600"
  },
  {
    "text": "check his voicemail messed this guy's face up it was and it just made him happy you",
    "start": "335600",
    "end": "341360"
  },
  {
    "text": "know if you ever get an opportunity to do that i'd highly recommend it legally do that",
    "start": "341360",
    "end": "347360"
  },
  {
    "text": "anyway another situation i had",
    "start": "347520",
    "end": "353199"
  },
  {
    "text": "was i had a i used to be a software developer and i had a",
    "start": "353199",
    "end": "358240"
  },
  {
    "text": "component i was using in a project and we were six months in the project and i ran into a bug in the component",
    "start": "358240",
    "end": "365360"
  },
  {
    "text": "the developer wouldn't i was like the only person in the whole world who ever ran into this bug and so he wasn't",
    "start": "365360",
    "end": "370400"
  },
  {
    "text": "really willing to fix it for me um he did say it would be fixed in the next",
    "start": "370400",
    "end": "376319"
  },
  {
    "text": "release but i didn't have time to wait for that so i just playing around and this is a long time ago when",
    "start": "376319",
    "end": "383680"
  },
  {
    "text": "the security world was much different um and i basically saw his computer was on the",
    "start": "384080",
    "end": "391120"
  },
  {
    "text": "internet and had front page server extensions running and so i just fixed the bug myself and i got me a nice fixed patch version",
    "start": "391120",
    "end": "398240"
  },
  {
    "text": "of the software after that",
    "start": "398240",
    "end": "401280"
  },
  {
    "text": "that was one you're supposed to laugh at if you didn't catch on that is this thing working",
    "start": "403600",
    "end": "409600"
  },
  {
    "text": "um anyway uh i i got realizing that that you know a lot of",
    "start": "409600",
    "end": "416080"
  },
  {
    "text": "a lot of people really didn't understand front page serve extension security they were confusing there a lot of",
    "start": "416080",
    "end": "422639"
  },
  {
    "text": "people don't really understand how it works and and what it does what what the server extensions do they there's a lot",
    "start": "422639",
    "end": "428720"
  },
  {
    "text": "of confusion about what is part of the server extension what's front page what's a personal web",
    "start": "428720",
    "end": "434080"
  },
  {
    "text": "server and a lot of fact a lot of vulnerabilities associated with front",
    "start": "434080",
    "end": "439840"
  },
  {
    "text": "page server extensions are actually with other products such as personal web server",
    "start": "439840",
    "end": "446479"
  },
  {
    "text": "but the question is are the front page server extension as insecure as everyone says",
    "start": "448560",
    "end": "454800"
  },
  {
    "text": "and and like i said it makes on checklist you know do not install them on a server",
    "start": "454800",
    "end": "460479"
  },
  {
    "start": "459000",
    "end": "459000"
  },
  {
    "text": "so the risks are the actual risks are there's an increased attack surface obviously running more",
    "start": "460479",
    "end": "466880"
  },
  {
    "text": "services having more dlls you are going to increase the attack surface or more potential for holes",
    "start": "466880",
    "end": "473599"
  },
  {
    "text": "you create an entry point into your network or onto your web server",
    "start": "473599",
    "end": "479599"
  },
  {
    "text": "when you go to your when you open up a page and front page if you haven't properly configured you're prompted for",
    "start": "479599",
    "end": "485039"
  },
  {
    "text": "a password normally this is good but it's also an opportunity to brute force that password or lock out an account or",
    "start": "485039",
    "end": "491039"
  },
  {
    "text": "whatever you want to do and if you do if you already have a password it's an opportunity to get on the server",
    "start": "491039",
    "end": "498080"
  },
  {
    "text": "uh information gathering which has always been the biggest weakness with front page server extensions you can gather quite a bit of information you",
    "start": "498080",
    "end": "505039"
  },
  {
    "text": "can figure out server software server versions even web stats all kinds of stuff",
    "start": "505039",
    "end": "513599"
  },
  {
    "text": "they run on the system partition which is",
    "start": "513599",
    "end": "518800"
  },
  {
    "text": "jeez it's it's been long-standing advice in fact i remember i actually remember",
    "start": "519360",
    "end": "525760"
  },
  {
    "text": "see david sitting over here i remember david's um bug track post must been four years ago",
    "start": "525760",
    "end": "532720"
  },
  {
    "text": "when you you pretty much said that um the",
    "start": "532720",
    "end": "539120"
  },
  {
    "text": "uh the web route shouldn't be on its on the server the main partition assist partition it",
    "start": "539120",
    "end": "544720"
  },
  {
    "text": "should be on its own partition and we we all kind of picked up that advice after that and microsoft has has followed that",
    "start": "544720",
    "end": "549839"
  },
  {
    "text": "advice but the server extensions run on the system partition and there's no way to choose where it's",
    "start": "549839",
    "end": "555600"
  },
  {
    "text": "partitioned to install it on and there's no way to change it well there's no way to norm to automatically change it",
    "start": "555600",
    "end": "564000"
  },
  {
    "text": "so it's definitely a big risk i had a client once a banking client they were",
    "start": "564399",
    "end": "571200"
  },
  {
    "text": "through a strange mixture of circumstances they had the front-page",
    "start": "571200",
    "end": "576560"
  },
  {
    "text": "server extensions running and they had one patch that they had not applied uh",
    "start": "576560",
    "end": "581920"
  },
  {
    "text": "they had actually or they had applied the patches in the wrong horizon nt4 system and so",
    "start": "581920",
    "end": "587440"
  },
  {
    "text": "the server extensions were vulnerable to the unicode exploit and",
    "start": "587440",
    "end": "592720"
  },
  {
    "text": "someone broke in through this through the front page server extensions directory and was able to run",
    "start": "592720",
    "end": "598080"
  },
  {
    "text": "commands and basically steal the whole database um",
    "start": "598080",
    "end": "604959"
  },
  {
    "text": "so you know you don't run uh virtual directors on server on the",
    "start": "604959",
    "end": "610640"
  },
  {
    "text": "system partitions so you need to change that uh insufficient logging the logging sucks it doesn't really tell you what's",
    "start": "610640",
    "end": "616320"
  },
  {
    "text": "happening and there it's the log files are stored in the on the web route",
    "start": "616320",
    "end": "622000"
  },
  {
    "text": "and they're hard to manage and so that's that itself is a problem um",
    "start": "622000",
    "end": "628320"
  },
  {
    "text": "another issue here is storing files within the web route they store configuration files as child directories to the web route and you've seen those",
    "start": "628320",
    "end": "634800"
  },
  {
    "text": "files those directories which i'm going to mention here later",
    "start": "634800",
    "end": "640240"
  },
  {
    "text": "greater risk is first of all the security model is confusing it used to be that the",
    "start": "641839",
    "end": "647200"
  },
  {
    "text": "security model was based on the ntfs part permissions of the individual dlls now",
    "start": "647200",
    "end": "653680"
  },
  {
    "text": "it's based on the ntfs permissions of the web route another issue is it runs in process with",
    "start": "653680",
    "end": "659360"
  },
  {
    "text": "inet info on 2003 it will that it will run in its own pool but",
    "start": "659360",
    "end": "665519"
  },
  {
    "text": "basically you've got an elevated privilege there you've got on a windows 2000 box they're running as",
    "start": "665519",
    "end": "672320"
  },
  {
    "text": "system on windows 2003 they're going to run as a network service",
    "start": "672320",
    "end": "678959"
  },
  {
    "text": "i believe relaxed ntfs permission permissions when you install the",
    "start": "678959",
    "end": "684480"
  },
  {
    "text": "server extensions they're going to lighten the ntfs permissions um more than i would normally run on a",
    "start": "684480",
    "end": "690720"
  },
  {
    "text": "server and they cannot be secured without ntfs now this is",
    "start": "690720",
    "end": "697200"
  },
  {
    "text": "this is probably the one was the biggest problems i've ever seen with",
    "start": "697200",
    "end": "702240"
  },
  {
    "text": "the the server extension is that people install it on a fat partition",
    "start": "702240",
    "end": "707839"
  },
  {
    "text": "in fact i saw a site hacked because someone accidentally had left a fat partition on the system partition the",
    "start": "707839",
    "end": "713920"
  },
  {
    "text": "web route was ntfs but the the system partition was fat and so someone's able to go in and author it so",
    "start": "713920",
    "end": "721360"
  },
  {
    "text": "if if you learn anything here today is that you cannot secure the server extensions",
    "start": "721360",
    "end": "726959"
  },
  {
    "text": "on a fat partition got got that right what happens david",
    "start": "726959",
    "end": "732800"
  },
  {
    "text": "what happens when you install the ntfs preventions on a fat partition",
    "start": "732800",
    "end": "738560"
  },
  {
    "text": "and are the front pager extensions on that partition",
    "start": "738560",
    "end": "744120"
  },
  {
    "text": "you get hacked right yeah that's what i wanted you get hacked",
    "start": "748560",
    "end": "753920"
  },
  {
    "text": "what happens if you don't pit what happens if dave doesn't pay attention exactly",
    "start": "753920",
    "end": "759920"
  },
  {
    "text": "all right anyway the basic files have been around forever",
    "start": "759920",
    "end": "765120"
  },
  {
    "start": "760000",
    "end": "760000"
  },
  {
    "text": "are shtml.dll author.dll and admin dll they are basically the same file uh",
    "start": "765120",
    "end": "771839"
  },
  {
    "text": "shtml dll has forked a little bit to include some other functions but author and admin are the same file",
    "start": "771839",
    "end": "779760"
  },
  {
    "text": "this the reason why it's like that is just because it's a leftover",
    "start": "779760",
    "end": "784839"
  },
  {
    "text": "from yeah that's that's that slide's born anyway so is that one um",
    "start": "784839",
    "end": "790639"
  },
  {
    "start": "788000",
    "end": "788000"
  },
  {
    "text": "anyone have any questions on that part i'll just skip right over there all right let's get in the stuff the deep",
    "start": "790639",
    "end": "796560"
  },
  {
    "text": "stuff here front page server extensions work by sending post",
    "start": "796560",
    "end": "802720"
  },
  {
    "text": "requests to the front page server extension binaries whether it be shtml.dll",
    "start": "802720",
    "end": "808480"
  },
  {
    "text": "author dll or admin dll the post is uh to the the deal i don't know if",
    "start": "808480",
    "end": "814399"
  },
  {
    "text": "you can read that there and the the the body of the post contains the actual command that you are submitting",
    "start": "814399",
    "end": "820000"
  },
  {
    "text": "in this case the command is list documents and then it has all the parameters for the command after that",
    "start": "820000",
    "end": "825200"
  },
  {
    "text": "um what the front page server extensions do is they as you if you send a request to the",
    "start": "825200",
    "end": "830639"
  },
  {
    "text": "um the binary it first checks the permissions for the",
    "start": "830639",
    "end": "835760"
  },
  {
    "text": "anonymous user account on the web root of that directory if you are if the anonymous web user does not have",
    "start": "835760",
    "end": "843120"
  },
  {
    "text": "permissions for that then it it prompts you for a password you enter password and it checks that those permissions",
    "start": "843120",
    "end": "849760"
  },
  {
    "text": "um and so on until it does get is it able to authenticate you um",
    "start": "849760",
    "end": "857320"
  },
  {
    "text": "the uh you can also submit vti rpc commands which is what the",
    "start": "857920",
    "end": "863040"
  },
  {
    "text": "command that's in the body there you can send as a get to o wssvr.dll",
    "start": "863040",
    "end": "869880"
  },
  {
    "text": "or you can send multiple posts using a xml based language called camel is that",
    "start": "870079",
    "end": "875760"
  },
  {
    "text": "you guys call it camel caml",
    "start": "875760",
    "end": "880560"
  },
  {
    "text": "but the interesting thing is what's in this rpc",
    "start": "881279",
    "end": "887440"
  },
  {
    "text": "packet here it's it's a it's a very poorly documented language and",
    "start": "887920",
    "end": "893440"
  },
  {
    "text": "has caused quite a bit of confusion the sample output basically gives you a",
    "start": "893440",
    "end": "899120"
  },
  {
    "text": "html output like this and it's it's tell you the server version it tells you",
    "start": "899120",
    "end": "904800"
  },
  {
    "text": "this one is actually a result from a list services um",
    "start": "904800",
    "end": "911560"
  },
  {
    "text": "command it tells you different information tells you about the information you see a ux sr",
    "start": "912399",
    "end": "919440"
  },
  {
    "text": "that indicates the permissions of whether this information is protected or public um",
    "start": "919440",
    "end": "927079"
  },
  {
    "start": "927000",
    "end": "927000"
  },
  {
    "text": "this is the interesting command here list services you send a method",
    "start": "928480",
    "end": "933600"
  },
  {
    "text": "list services method to a front page server extensions server and you get",
    "start": "933600",
    "end": "939680"
  },
  {
    "text": "a list of websites on that server you get a list of",
    "start": "939680",
    "end": "945839"
  },
  {
    "text": "you can find out if a website is protected or not and you can gather lots of other information like i",
    "start": "945839",
    "end": "951040"
  },
  {
    "text": "showed in the last slide there uh the interesting thing is the amount of information that's shared anyone can",
    "start": "951040",
    "end": "957279"
  },
  {
    "start": "954000",
    "end": "954000"
  },
  {
    "text": "see this anyone sending a post to the server extensions gets to see",
    "start": "957279",
    "end": "962480"
  },
  {
    "text": "like you see this srms iis it's you know it's an iis server you see the the server extensions version",
    "start": "962480",
    "end": "968880"
  },
  {
    "text": "major minor version there you can see usage hits by week so they get 370",
    "start": "968880",
    "end": "974800"
  },
  {
    "text": "337 hits the first week 380 hits next week usage hits by month you can see the welcome names we got",
    "start": "974800",
    "end": "981199"
  },
  {
    "text": "default htm default asp default.spx which tells us they have.net server running",
    "start": "981199",
    "end": "987759"
  },
  {
    "text": "or the net framework running we see this vti bin vitae admin",
    "start": "987759",
    "end": "993199"
  },
  {
    "text": "fp admin adm dll.ell where do you guys do that dll.dll",
    "start": "993199",
    "end": "1000000"
  },
  {
    "text": "anyway um so you can find out quite a bit information you can find out email",
    "start": "1000000",
    "end": "1005199"
  },
  {
    "text": "addresses you can find out who runs the website there's just a wealth",
    "start": "1005199",
    "end": "1011680"
  },
  {
    "text": "of information there",
    "start": "1011680",
    "end": "1014480"
  },
  {
    "text": "geez i'm already over here you know what this is i need to get some input here",
    "start": "1016720",
    "end": "1022079"
  },
  {
    "text": "i'm already like halfway through here and i have new guns um",
    "start": "1022079",
    "end": "1027918"
  },
  {
    "text": "the issue here is that front page server extensions are confusing and they're hard to follow and hard to understand the security",
    "start": "1032880",
    "end": "1038558"
  },
  {
    "text": "models used and",
    "start": "1038559",
    "end": "1042079"
  },
  {
    "text": "and there's a lot of things left over from an old framework from an old",
    "start": "1044240",
    "end": "1051200"
  },
  {
    "text": "a program that was not intended to be secure was not written to be secure",
    "start": "1051200",
    "end": "1056720"
  },
  {
    "text": "and and basically it's it's that we're adding they're adding new features onto",
    "start": "1056720",
    "end": "1063440"
  },
  {
    "text": "old programs that already are flawed let me just get some exploits",
    "start": "1063440",
    "end": "1071039"
  },
  {
    "text": "basically the biggest problem i've seen with the",
    "start": "1072160",
    "end": "1078240"
  },
  {
    "text": "front page server extensions are that they're confusing and they're hard to secure and they're hard to patch and",
    "start": "1078240",
    "end": "1084320"
  },
  {
    "text": "they're hard to keep track of so it's actually quite easy to exploit",
    "start": "1084320",
    "end": "1089520"
  },
  {
    "text": "the server extensions because of that um it's it's it's not so much that the the server extensions themselves are flawed",
    "start": "1089520",
    "end": "1097039"
  },
  {
    "text": "it's that um that it's",
    "start": "1097039",
    "end": "1102400"
  },
  {
    "text": "difficult to to know where your holes are know what you've done wrong",
    "start": "1102400",
    "end": "1109840"
  },
  {
    "text": "there's a lot of a lot of leftovers there's a lot of code",
    "start": "1110320",
    "end": "1115520"
  },
  {
    "text": "i just talked to some of the developers earlier i was asking about some of the code in",
    "start": "1115520",
    "end": "1120720"
  },
  {
    "text": "the the hex that i saw in there and and you know they don't really know what it",
    "start": "1120720",
    "end": "1126160"
  },
  {
    "text": "is um and so it's it kind of makes me wonder about the surf extensions now",
    "start": "1126160",
    "end": "1131600"
  },
  {
    "text": "uh in researching this this stuff um i've been playing around server extensions for several years now",
    "start": "1131600",
    "end": "1138000"
  },
  {
    "text": "and i've there's been hundreds and hundreds of holes that that i've found that others have found",
    "start": "1138000",
    "end": "1143280"
  },
  {
    "text": "and not all of them have been made public not all of them been shared for a long time no one's really cared about",
    "start": "1143280",
    "end": "1148960"
  },
  {
    "text": "the server extensions so i just stopped sharing a lot of the stuff but",
    "start": "1148960",
    "end": "1155840"
  },
  {
    "text": "in preparing this i went through i went through my old list of exploits and a lot of them have been fixed and actually i've sent about",
    "start": "1156240",
    "end": "1162160"
  },
  {
    "text": "10 million uh i had a perl script sent about 10 million requests to the server extensions trying to overflow them and",
    "start": "1162160",
    "end": "1167280"
  },
  {
    "text": "they they held up pretty well there was there were no overflows that i had encountered but there were a lot of weird things um",
    "start": "1167280",
    "end": "1174000"
  },
  {
    "text": "that i ran into when i was doing this uh for example if you make a request",
    "start": "1174000",
    "end": "1181799"
  },
  {
    "text": "html.dll to any file and the file is not there",
    "start": "1200640",
    "end": "1209960"
  },
  {
    "text": "does nothing",
    "start": "1229440",
    "end": "1232759"
  },
  {
    "text": "ah it says",
    "start": "1238480",
    "end": "1242919"
  },
  {
    "text": "you guys changed this last minute fixes um",
    "start": "1250080",
    "end": "1256640"
  },
  {
    "text": "depending on",
    "start": "1256640",
    "end": "1259960"
  },
  {
    "text": "nice okay you guys keep ruining all my good exploits here you keep fixing this stuff",
    "start": "1266400",
    "end": "1272000"
  },
  {
    "text": "on every version except for the one i run on my laptop um",
    "start": "1272000",
    "end": "1277840"
  },
  {
    "text": "i just updated made sure i got all the proper updates which you know rests my point even further that's the confusing issue",
    "start": "1278240",
    "end": "1285039"
  },
  {
    "text": "is which updates to install um",
    "start": "1285039",
    "end": "1289880"
  },
  {
    "text": "you know i had a good dos too and i that one got fixed too um",
    "start": "1290080",
    "end": "1295760"
  },
  {
    "text": "the uh and you can see one night in my",
    "start": "1295760",
    "end": "1300159"
  },
  {
    "text": "recently anyway on the on the on most versions of the server extensions if you request a file that is not there what",
    "start": "1301840",
    "end": "1308159"
  },
  {
    "text": "you get is an error message that says cannot open uh and it has returns name the file says no such file folder",
    "start": "1308159",
    "end": "1314960"
  },
  {
    "text": "on when the file is there you get this error message that you see here so you can actually use the server extensions",
    "start": "1314960",
    "end": "1321120"
  },
  {
    "text": "to do a cgi scan on the server now the interesting thing about the server extensions is a lot of times",
    "start": "1321120",
    "end": "1327200"
  },
  {
    "text": "people have them installed but do not use them and so therefore do not update them um",
    "start": "1327200",
    "end": "1332320"
  },
  {
    "text": "and so it's it is actually quite common to be able to go to a site and do a full cgi scan on their server through",
    "start": "1332320",
    "end": "1338480"
  },
  {
    "text": "through shmail.dll just by interpreting the different output you get",
    "start": "1338480",
    "end": "1344840"
  },
  {
    "text": "the and the interesting thing about it is because it's in the body of the in the",
    "start": "1344840",
    "end": "1350880"
  },
  {
    "text": "post method there that it actually evades detection by many uh",
    "start": "1350880",
    "end": "1357039"
  },
  {
    "text": "ids depending on how the rules are written but um you know a lot of them the ideas are expecting that the exploit",
    "start": "1357039",
    "end": "1362559"
  },
  {
    "text": "string in the url itself so this puts it in the post uh method so it's it's a good way to avoid detection there plus",
    "start": "1362559",
    "end": "1369039"
  },
  {
    "text": "when they look in their log files all they'll see is you know 100 requests to shtml.dll",
    "start": "1369039",
    "end": "1374640"
  },
  {
    "text": "um there were there were some other there's some other issues here like the",
    "start": "1374640",
    "end": "1380000"
  },
  {
    "text": "you know this one's probably fixed too doing something like",
    "start": "1380000",
    "end": "1386080"
  },
  {
    "text": "yeah see it's hit please the server's application log okay",
    "start": "1387280",
    "end": "1392720"
  },
  {
    "text": "and we go in the event viewer and we look at the application log and we see two warnings",
    "start": "1392720",
    "end": "1400320"
  },
  {
    "text": "cannot open file aux htm for reading and permission denied",
    "start": "1400400",
    "end": "1406799"
  },
  {
    "text": "which is a good way to fill up someone's application log you know you get two you get two application log entries for",
    "start": "1406799",
    "end": "1412320"
  },
  {
    "text": "every url you send um again these are just minor issues um some of the the more major issues i",
    "start": "1412320",
    "end": "1419120"
  },
  {
    "text": "found we there's some confusion about which uh version would they affect and so we i'm",
    "start": "1419120",
    "end": "1424240"
  },
  {
    "text": "not gonna be able to release all those details here um",
    "start": "1424240",
    "end": "1430000"
  },
  {
    "text": "another interesting thing is that uh the way the front-page server extensions work is they've got a um",
    "start": "1430000",
    "end": "1435440"
  },
  {
    "text": "since it they used to be an executable file uh for the shtml and the author they used",
    "start": "1435440",
    "end": "1441600"
  },
  {
    "text": "to be shmail.exe author.exe and admin.exe",
    "start": "1441600",
    "end": "1449039"
  },
  {
    "text": "these files were there was a copy of each of these files",
    "start": "1449039",
    "end": "1455679"
  },
  {
    "text": "for each website on your server they then went to a stub where these files were just a sub to the master file then",
    "start": "1455679",
    "end": "1461840"
  },
  {
    "text": "it went to a shared dll file to maintain compatibility",
    "start": "1461840",
    "end": "1468480"
  },
  {
    "text": "microsoft made the isapi filter that converts all requests for shtml.exe",
    "start": "1468480",
    "end": "1474159"
  },
  {
    "text": "to shtml.dll now if you make a request to",
    "start": "1474159",
    "end": "1481120"
  },
  {
    "text": "shtml.exe you get the same message um",
    "start": "1484760",
    "end": "1490600"
  },
  {
    "text": "oh by the way",
    "start": "1500400",
    "end": "1503440"
  },
  {
    "text": "it's part of my tool i have a little pearl script that takes ascii art and puts it into someone's log files",
    "start": "1506159",
    "end": "1513039"
  },
  {
    "text": "which is really kind of funny because it's people it's just the psycho psychological effect is amazing you know",
    "start": "1513039",
    "end": "1518960"
  },
  {
    "text": "it's it's it's one thing to you know have your site defaced but when people go in their log files and they see alfred newman",
    "start": "1518960",
    "end": "1524240"
  },
  {
    "text": "you know it's just it's just really disheartening and all it is you're putting stuff in the log files but it's it's amazing the impact it has i",
    "start": "1524240",
    "end": "1530960"
  },
  {
    "text": "always be sure i do that when i fan test someone um",
    "start": "1530960",
    "end": "1537039"
  },
  {
    "text": "okay if you look down here the file that we sent was shtml.exe and then it shows",
    "start": "1537039",
    "end": "1542480"
  },
  {
    "text": "in the log files as request for shmail.dll even though requested.exe",
    "start": "1542480",
    "end": "1548640"
  },
  {
    "text": "now",
    "start": "1548640",
    "end": "1550799"
  },
  {
    "text": "interesting thing about that what the way the server extensions work is they've got a a copy of the files here in",
    "start": "1554240",
    "end": "1563039"
  },
  {
    "text": "web server extensions forum isapy all the files go here",
    "start": "1568240",
    "end": "1573919"
  },
  {
    "text": "in this directory and then",
    "start": "1573919",
    "end": "1578360"
  },
  {
    "text": "in your website the um the vti bin directory shows up as a virtual directory mapped",
    "start": "1584240",
    "end": "1589520"
  },
  {
    "text": "to that directory on the c on the c partitions was talking about before",
    "start": "1589520",
    "end": "1594880"
  },
  {
    "text": "now if you have a file there named shtml.exe",
    "start": "1594880",
    "end": "1600520"
  },
  {
    "text": "it will never be called because the isapi filter changes the name and so it never never actually is seen",
    "start": "1605919",
    "end": "1612480"
  },
  {
    "text": "by iis however if you do something like this",
    "start": "1612480",
    "end": "1618640"
  },
  {
    "text": "and just stick another slash in it you get a internal server error and the",
    "start": "1620080",
    "end": "1625520"
  },
  {
    "text": "reason is because i just renamed the dll but it actually called that shtml.exe file and if we look in the",
    "start": "1625520",
    "end": "1632320"
  },
  {
    "text": "log files it shows up as html.exe so it actually",
    "start": "1632320",
    "end": "1637919"
  },
  {
    "text": "called shtml.exe the point is that it's an interesting way to hide a trojan",
    "start": "1637919",
    "end": "1643679"
  },
  {
    "text": "in someone's website is create a file called shtml.exe and then using two slashes",
    "start": "1643679",
    "end": "1649120"
  },
  {
    "text": "when you access it some of the other holes i found uh",
    "start": "1649120",
    "end": "1656080"
  },
  {
    "text": "oh yeah yeah and that's the thing about the front page of extensions i should have mentioned earlier is that um",
    "start": "1658240",
    "end": "1664640"
  },
  {
    "text": "by themselves they're not always that great for well great in the perspective of",
    "start": "1665440",
    "end": "1670799"
  },
  {
    "text": "a hackers great but not always that bad from someone",
    "start": "1670799",
    "end": "1676640"
  },
  {
    "text": "else's perspective but when used in conjunction with other exploits they can be very powerful like",
    "start": "1676640",
    "end": "1683440"
  },
  {
    "text": "for example i said it gives you an entry point to the network well yeah you can try to brute force the password but if you already have a",
    "start": "1683440",
    "end": "1688960"
  },
  {
    "text": "password that's a good way to get in or the information it has well the information itself isn't going to be",
    "start": "1688960",
    "end": "1694720"
  },
  {
    "text": "useful but use that information with another exploit you know it's quite useful so yeah you have to be in but use that",
    "start": "1694720",
    "end": "1701840"
  },
  {
    "text": "you know in combination with something else someone could have a height of trojan on your server for years and you'll never notice it",
    "start": "1701840",
    "end": "1708000"
  },
  {
    "text": "they'll look in the log files you'll see quest request shmail.exe you browse to that and it's",
    "start": "1708000",
    "end": "1713679"
  },
  {
    "text": "you get the server extensions so just you know these are the the point of bringing this stuff up isn't to point",
    "start": "1713679",
    "end": "1720080"
  },
  {
    "text": "out how to hack the server extensions it's it's the kind of stuff that um",
    "start": "1720080",
    "end": "1725840"
  },
  {
    "text": "uh kind of demonstrates the the fact that they they increase the server exposure",
    "start": "1726080",
    "end": "1731919"
  },
  {
    "text": "they increase the attack surface basically um and kind of demonstrate what kind of",
    "start": "1731919",
    "end": "1737279"
  },
  {
    "text": "changes need to be made on these server extensions to make them more secure another thing i ran into is",
    "start": "1737279",
    "end": "1744799"
  },
  {
    "text": "the include bot can include itself which is kind of interesting when a file",
    "start": "1744799",
    "end": "1749919"
  },
  {
    "text": "includes itself and then includes itself and then includes itself",
    "start": "1749919",
    "end": "1754559"
  },
  {
    "text": "you can identify the service pack level by looking at the front page server extensions version so you can do one",
    "start": "1755520",
    "end": "1760640"
  },
  {
    "text": "request server and know exactly where they're at um you can detect the presence of the",
    "start": "1760640",
    "end": "1768080"
  },
  {
    "text": "presence of the front page service extensions 2002 by different uh headers that the",
    "start": "1768080",
    "end": "1774720"
  },
  {
    "text": "uh sharepoint installs server headers there's a couple doses i",
    "start": "1774720",
    "end": "1780240"
  },
  {
    "text": "found one of them one was interesting that it's it's by",
    "start": "1780240",
    "end": "1786960"
  },
  {
    "text": "creating a long url it i noticed i was running file i start off i look for our explodes",
    "start": "1786960",
    "end": "1793840"
  },
  {
    "text": "exploits i just couldn't find any you know they've done a real good job going through and protecting themselves there",
    "start": "1793840",
    "end": "1800080"
  },
  {
    "text": "so i started running filemon see what i could find that way and see what it was doing the background i",
    "start": "1800080",
    "end": "1806080"
  },
  {
    "text": "did one of the rpc methods with a looking for a slash a slash b slash c directory it",
    "start": "1806080",
    "end": "1812320"
  },
  {
    "text": "check for slash a slash b sleeve then check for a slash b then check for slash a",
    "start": "1812320",
    "end": "1817919"
  },
  {
    "text": "well that's interesting so i did slash a 5 000 times and it pretty much brought the server 100 cpu",
    "start": "1817919",
    "end": "1825120"
  },
  {
    "text": "but it didn't crash it you know if you crash is it restarts so this it brought up 200 cpu",
    "start": "1825440",
    "end": "1831600"
  },
  {
    "text": "and kind of almost completely disables it but not totally um",
    "start": "1831600",
    "end": "1837360"
  },
  {
    "text": "like if you're on a using load balancing it won't pull it out of the pool because it still sees it",
    "start": "1837360",
    "end": "1842720"
  },
  {
    "text": "you get about 50 packet loss the only way to to to fix it is to reset is which you can't terminal service into it",
    "start": "1842720",
    "end": "1848880"
  },
  {
    "text": "because you've got 50 packet loss which is an interesting thing like that another thing is that if you",
    "start": "1848880",
    "end": "1855919"
  },
  {
    "text": "if you don't set the permissions right now initially this the permissions are set",
    "start": "1855919",
    "end": "1861919"
  },
  {
    "text": "fairly good they could be a lot better but they're set fairly good but in my experience dealing with administrators",
    "start": "1861919",
    "end": "1868559"
  },
  {
    "text": "is that permissions never really stay at what they originally were or i should say developers or even worse",
    "start": "1868559",
    "end": "1874320"
  },
  {
    "text": "and you tend to get permissions changed lightened someone can't get something working so they like",
    "start": "1874320",
    "end": "1879679"
  },
  {
    "text": "permissions or whatever and that's when it starts really being a problem because then anyone can get access to the various",
    "start": "1879679",
    "end": "1885600"
  },
  {
    "text": "configuration files or even access the website itself uh here's an interesting one if if",
    "start": "1885600",
    "end": "1892080"
  },
  {
    "text": "you're using the front page client to connect to a website and you authenticate you log in you're offering",
    "start": "1892080",
    "end": "1897760"
  },
  {
    "text": "your website you close the website but don't close the front page itself",
    "start": "1897760",
    "end": "1903519"
  },
  {
    "text": "anyone come along and reconnect your website and authenticate automatically so if you're if you're using front page",
    "start": "1903519",
    "end": "1909919"
  },
  {
    "text": "authentic to advance your website be sure to exit the whole thing",
    "start": "1909919",
    "end": "1915519"
  },
  {
    "text": "another interesting thing is if you're in a website and you exit out front page without closing the website next time you come",
    "start": "1915519",
    "end": "1921679"
  },
  {
    "text": "in it'll automatically open that website which is the first thing comes to my mind is is you know what if i",
    "start": "1921679",
    "end": "1928320"
  },
  {
    "text": "go to my website exit the front page run a sniff around my side",
    "start": "1928320",
    "end": "1935120"
  },
  {
    "text": "someone goes into their opens up front page again tries to log in they're logging into my website",
    "start": "1935120",
    "end": "1941120"
  },
  {
    "text": "and i get their password there were some issues i found in",
    "start": "1941120",
    "end": "1946159"
  },
  {
    "text": "overflowing the client which is kind of interesting you can actually use a server to overflow the client",
    "start": "1946159",
    "end": "1952320"
  },
  {
    "text": "there were some cross-site scripting issues in the search form the the database results search form there are",
    "start": "1952320",
    "end": "1957840"
  },
  {
    "text": "also some sql injection issues there um where you could actually",
    "start": "1957840",
    "end": "1963600"
  },
  {
    "text": "put in in the search form you could you could close off the html for the the input box you know put a quote and a",
    "start": "1963600",
    "end": "1971120"
  },
  {
    "text": "greater a greater than sign and then write your own html and that html is returned in the actual page",
    "start": "1971120",
    "end": "1979120"
  },
  {
    "text": "but the biggest problem with server extension is updating the server extensions",
    "start": "1979279",
    "end": "1986000"
  },
  {
    "text": "and talking with the office guys over here guys and",
    "start": "1986000",
    "end": "1991600"
  },
  {
    "start": "1988000",
    "end": "1988000"
  },
  {
    "text": "people over here um that's the frustration they have too is",
    "start": "1991600",
    "end": "1997279"
  },
  {
    "text": "that uh is that you know who owns off or who owns front page first thing i ask them so who owns front page and they just",
    "start": "1997279",
    "end": "2004000"
  },
  {
    "text": "kind of laugh do that again do come here and do that where i where i asked you that and you guys",
    "start": "2004000",
    "end": "2010240"
  },
  {
    "text": "um anyways and the thing is it's they own front page it's an office product but it's also included with",
    "start": "2010240",
    "end": "2017200"
  },
  {
    "text": "windows visualstudio.net it's included with",
    "start": "2017200",
    "end": "2022240"
  },
  {
    "text": "sharepoint i mean it's a standalone product so it's when you go to update it the question is",
    "start": "2022240",
    "end": "2029679"
  },
  {
    "text": "what what updates do you use um the finding the product updates is often",
    "start": "2029679",
    "end": "2036000"
  },
  {
    "text": "difficult um scott you may remember the complaints i had before about the",
    "start": "2036000",
    "end": "2044080"
  },
  {
    "text": "sometimes the updates are just hidden and they're not you don't really know about them when they come out um",
    "start": "2044399",
    "end": "2050158"
  },
  {
    "text": "the they used to not be updated with the windows 2000 service packs but now",
    "start": "2050159",
    "end": "2055679"
  },
  {
    "text": "they are but they're also updated with the office service packs they're also updated alone",
    "start": "2055679",
    "end": "2060800"
  },
  {
    "text": "and they're also updated with xp and and so it's confusing and it's inconsistent which makes it very",
    "start": "2060800",
    "end": "2066320"
  },
  {
    "text": "difficult to fix it and then there's some things that you have to fix manually so",
    "start": "2066320",
    "end": "2071679"
  },
  {
    "text": "uh you know it's it it's hard knowing i i had on one of my some of these",
    "start": "2071679",
    "end": "2077839"
  },
  {
    "text": "some of these exploits i was trying they didn't work you know it didn't work because i i guess i i updated my my box",
    "start": "2077839",
    "end": "2083760"
  },
  {
    "text": "wrong you know my server i was testing these on i had the wrong version you know i'd run all the updates and",
    "start": "2083760",
    "end": "2090240"
  },
  {
    "text": "everything but i was actually testing on a previous version and unless you get them installed right right and in the right order another",
    "start": "2090240",
    "end": "2095919"
  },
  {
    "text": "thing is they aren't cumulative they",
    "start": "2095919",
    "end": "2100960"
  },
  {
    "text": "you often have to install the all the service or all the hot fixes in the correct order and the thing is",
    "start": "2100960",
    "end": "2108480"
  },
  {
    "text": "this uh the bulletins are confusing",
    "start": "2108480",
    "end": "2114720"
  },
  {
    "text": "i've got gotta read you this because it's such a such a great example",
    "start": "2114720",
    "end": "2119760"
  },
  {
    "text": "anyone ever seen this one on the it's ms-02053 okay download locations for this patch",
    "start": "2123040",
    "end": "2130480"
  },
  {
    "text": "you've got microsoft front-page server extensions 2002 for all platforms or for sharepoint team services 2002 we",
    "start": "2130480",
    "end": "2137280"
  },
  {
    "text": "recommend office xp sp2 which contains a number of other security fixes which ones i mean",
    "start": "2137280",
    "end": "2142880"
  },
  {
    "text": "they're not included with these if for some reason web administrator cannot apply office xp to sp2 we recommend the",
    "start": "2142880",
    "end": "2148880"
  },
  {
    "text": "front page server extension 2002 patch list above microsoft page server extensions 2000 for nt4 microsoft",
    "start": "2148880",
    "end": "2156400"
  },
  {
    "text": "front pager extensions 2001 is xp this fix is included in windows xp service pack one",
    "start": "2156400",
    "end": "2162720"
  },
  {
    "text": "users who do not wish to apply search pack once you apply this patch and then microsoft front page server extensions 2004 windows 2000",
    "start": "2162720",
    "end": "2170160"
  },
  {
    "text": "and then you've got some issues here um",
    "start": "2170160",
    "end": "2174078"
  },
  {
    "text": "front page server extends 2002 the patch can be applied on all platforms which support front page server extends since",
    "start": "2175680",
    "end": "2180720"
  },
  {
    "text": "2002 and then front page server extension 2000 the patches can be applied on the following systems running front page servers extension 2000",
    "start": "2180720",
    "end": "2187599"
  },
  {
    "text": "windows xp gold windows 2000 and nt4 and it says this fix for this issue will",
    "start": "2187599",
    "end": "2193599"
  },
  {
    "text": "be included in windows 2000 sp4 windows xp sp1 and any future service packs for spse 2002 and then",
    "start": "2193599",
    "end": "2201119"
  },
  {
    "text": "you've got the patch can be uninstalled it can be installed uh front page server extension is 2000 patches on windows",
    "start": "2201119",
    "end": "2206960"
  },
  {
    "text": "2000 and windows xp can be uninstalled front page server extension 2000 patches for nt4 cannot be uninstalled front page",
    "start": "2206960",
    "end": "2213359"
  },
  {
    "text": "server extensions 2002 patch cannot be uninstalled um",
    "start": "2213359",
    "end": "2219040"
  },
  {
    "text": "you know so it gets oh and caveats oh okay well there's a caveat to all this um",
    "start": "2219040",
    "end": "2224960"
  },
  {
    "text": "users running front page server extensions 2002 on any supported platform who have not applied the latest update we'll need to apply the update",
    "start": "2224960",
    "end": "2231440"
  },
  {
    "text": "before installing this patch to learn more about this anyway you get my point here it gets really confusing which",
    "start": "2231440",
    "end": "2236800"
  },
  {
    "text": "which update do you install which if you've installed some products which do you have to install the other ones",
    "start": "2236800",
    "end": "2242560"
  },
  {
    "text": "do some products overwrite uh do this does it says included with uh office xp",
    "start": "2242560",
    "end": "2248960"
  },
  {
    "text": "uh service pack two well and it says that one includes other security fixes well what if you're",
    "start": "2248960",
    "end": "2254400"
  },
  {
    "text": "running the windows 2000 version we say you're running windows 2000 with front page server extension 2002 and",
    "start": "2254400",
    "end": "2260000"
  },
  {
    "text": "you've got xp service pack too but which order do you install them so it's it's it's almost impossible to know without",
    "start": "2260000",
    "end": "2266320"
  },
  {
    "text": "going through every single version file version and comparing them that way um htm edge.exe and imagemap.exe the",
    "start": "2266320",
    "end": "2274240"
  },
  {
    "start": "2273000",
    "end": "2273000"
  },
  {
    "text": "these these have had some holes for quite some time and these are actually very common um",
    "start": "2274240",
    "end": "2280400"
  },
  {
    "text": "i see these all the time on servers and it's because",
    "start": "2280400",
    "end": "2285520"
  },
  {
    "text": "it's a manual step i mean people will go through and they have their software update services running they install the hot fixes",
    "start": "2285520",
    "end": "2291440"
  },
  {
    "text": "but there's no installation for this you have to remove two files but the problem is you remove the files",
    "start": "2291440",
    "end": "2297040"
  },
  {
    "text": "and windows file protection puts them back so you go and you delete them from the dll cache but the problem is with",
    "start": "2297040",
    "end": "2302960"
  },
  {
    "text": "sp3 they change that so that now it keeps prompting you for this the windows",
    "start": "2302960",
    "end": "2308240"
  },
  {
    "text": "cd to replace those files so",
    "start": "2308240",
    "end": "2313838"
  },
  {
    "text": "i don't know what i meant by that but um the solution was solution was to delete the files oh another thing is that these",
    "start": "2314240",
    "end": "2320640"
  },
  {
    "text": "files were actually included with service pack 2 which came out after the the bulletins came out and the security",
    "start": "2320640",
    "end": "2326880"
  },
  {
    "text": "roll-ups that were included the vulnerable versions of these files were included in those security roll-ups and the service pack too finally in service",
    "start": "2326880",
    "end": "2334320"
  },
  {
    "text": "pack three what they did is they stuck in a stub that basically a neutered version of the file so",
    "start": "2334320",
    "end": "2340480"
  },
  {
    "text": "apparently that that is the real solution is you installing service pack 3 will replace",
    "start": "2340480",
    "end": "2346480"
  },
  {
    "text": "it with a stub version file but the files will no longer be functional if you use them which their recommendation is to not use them",
    "start": "2346480",
    "end": "2353359"
  },
  {
    "text": "security model um",
    "start": "2353359",
    "end": "2357599"
  },
  {
    "text": "anyone i'm assuming you're all here because you use front-page server extensions or you",
    "start": "2358880",
    "end": "2364160"
  },
  {
    "text": "develop them or you're involved with like who here's from microsoft by the way",
    "start": "2364160",
    "end": "2369839"
  },
  {
    "text": "is this like all microsoft i'm just um",
    "start": "2369839",
    "end": "2375599"
  },
  {
    "text": "do you all use the front page server extensions on your on your servers to some extent",
    "start": "2376400",
    "end": "2381440"
  },
  {
    "text": "i mean i'm i assume you're here because you have some reason to know how to secure them",
    "start": "2381440",
    "end": "2387440"
  },
  {
    "text": "anyone anyone use the server extensions on their servers",
    "start": "2387440",
    "end": "2392560"
  },
  {
    "text": "yeah they come with sharepoint they're an integral part of sharepoint in fact it's the whole the whole foundation for",
    "start": "2392560",
    "end": "2398400"
  },
  {
    "text": "that so use those sharepoint on your",
    "start": "2398400",
    "end": "2402640"
  },
  {
    "text": "have sitting on our servers",
    "start": "2409040",
    "end": "2409040"
  },
  {
    "text": "is it clear to you how how the security model works",
    "start": "2428800",
    "end": "2433520"
  },
  {
    "text": "and exactly that's that's what pretty much everyone says they're just a mystery and it's why why are they such a mystery i mean they they don't they",
    "start": "2435839",
    "end": "2442480"
  },
  {
    "text": "don't really use the is model but they don't really use ntfs permissions completely",
    "start": "2442480",
    "end": "2448560"
  },
  {
    "text": "i mean you don't you can't just send ntfs permissions on each individual file however you want to access it's all based on the web route",
    "start": "2448560",
    "end": "2456240"
  },
  {
    "text": "you've basically got three roles in front page you've got browse author administer browse is generally the",
    "start": "2457359",
    "end": "2463920"
  },
  {
    "text": "public authors and then administer administrators are able to change",
    "start": "2463920",
    "end": "2469119"
  },
  {
    "start": "2464000",
    "end": "2464000"
  },
  {
    "text": "uh settings the web itself authors can change the content it's all based on the ntfs permissions",
    "start": "2469119",
    "end": "2475040"
  },
  {
    "text": "for the web route or if you have subwebs that inherit permissions on the parent web route",
    "start": "2475040",
    "end": "2482480"
  },
  {
    "text": "if someone has read permissions on the web route they have read permissions for server extensions if",
    "start": "2482480",
    "end": "2489280"
  },
  {
    "text": "they have write permissions on the web route they have right permissions for they have author permissions i'm sorry",
    "start": "2489280",
    "end": "2494800"
  },
  {
    "text": "for the server extensions if they have change or modify or full control permissions",
    "start": "2494800",
    "end": "2501520"
  },
  {
    "text": "on the web route then they have administer permissions now with the sharepoint there's a couple other roles",
    "start": "2501520",
    "end": "2507440"
  },
  {
    "text": "added and you can make your own custom rolls but those are the three basic rules",
    "start": "2507440",
    "end": "2513839"
  },
  {
    "text": "and it's pretty common to to mess that up and it's it's it's not not uncommon at all to",
    "start": "2513839",
    "end": "2520880"
  },
  {
    "text": "change the for people to change this the permissions on the web route not realizing that they're also changing the",
    "start": "2521280",
    "end": "2526960"
  },
  {
    "text": "permissions for the server extensions and again",
    "start": "2526960",
    "end": "2532079"
  },
  {
    "text": "if you have a fat partition then you don't have such thing as ntfs permissions",
    "start": "2532079",
    "end": "2538160"
  },
  {
    "text": "and therefore if you run a fat partition on the web route what happens",
    "start": "2538160",
    "end": "2544480"
  },
  {
    "text": "if you're a fat partition with the server extensions you can act right",
    "start": "2544480",
    "end": "2551838"
  },
  {
    "text": "and um",
    "start": "2568160",
    "end": "2572040"
  },
  {
    "text": "right but there's also developers developers you know use front page on there so oftentimes on their own",
    "start": "2584079",
    "end": "2590640"
  },
  {
    "text": "machine and they have their own copy of the website their development copy the website and a lot",
    "start": "2590640",
    "end": "2596000"
  },
  {
    "text": "of times it's changing more but you know it was very common for a long time to see developers using windows 98 or",
    "start": "2596000",
    "end": "2602079"
  },
  {
    "text": "windows 95 now you're seeing a lot more xp but you know what i've found is if i didn't",
    "start": "2602079",
    "end": "2607839"
  },
  {
    "text": "see the front page of extensions open the website i'd go right find out who the developers were and go for their system",
    "start": "2607839",
    "end": "2613440"
  },
  {
    "text": "and a lot of times we're running fat partitions and the fact is yeah it's that it is changing a lot but you still",
    "start": "2613440",
    "end": "2619280"
  },
  {
    "text": "see it too much you know so you can't not run surf extensions on a fat partition if i haven't",
    "start": "2619280",
    "end": "2625760"
  },
  {
    "text": "emphasized that enough okay the uh when you clean and stall",
    "start": "2625760",
    "end": "2632079"
  },
  {
    "start": "2627000",
    "end": "2627000"
  },
  {
    "text": "this the windows server you can uncheck the server extensions um",
    "start": "2632079",
    "end": "2637440"
  },
  {
    "text": "you know make sure they're not installed but if you look there the directories will are still there and the question is why",
    "start": "2637440",
    "end": "2642880"
  },
  {
    "text": "are they still there if you unchecked it a lot of people used to tell me that you can't not install them but what i found",
    "start": "2642880",
    "end": "2649119"
  },
  {
    "text": "out is it's it's basically due to windows file protection windows file protection monitors directories it needs",
    "start": "2649119",
    "end": "2654400"
  },
  {
    "text": "the directories to be there and actually holds those directories open um and so it creates those directories",
    "start": "2654400",
    "end": "2659839"
  },
  {
    "text": "it creates a directory structure if you go into safe mode and delete the whole entire front page",
    "start": "2659839",
    "end": "2666000"
  },
  {
    "text": "directory structure and then reboot the windows file protection will actually recreate those directories and if you look in the",
    "start": "2666000",
    "end": "2672480"
  },
  {
    "text": "windows file protection executables all these things all these files and directors are all hard coded in there why won't they uninstall i don't know",
    "start": "2672480",
    "end": "2679359"
  },
  {
    "text": "that's they they don't uninstall if you if you uninstall them they just don't",
    "start": "2679359",
    "end": "2684400"
  },
  {
    "text": "go completely you have to actually manually uninstall them and how do you remove them well the question the answer is that you go in",
    "start": "2684400",
    "end": "2690960"
  },
  {
    "text": "safe mode and you delete the whole entire directory and the copies in dll cache",
    "start": "2690960",
    "end": "2696800"
  },
  {
    "text": "and even then you'll still be prompted for the windows cd and you just have to put up with that until we get a proper put that one on",
    "start": "2696800",
    "end": "2703119"
  },
  {
    "start": "2700000",
    "end": "2700000"
  },
  {
    "text": "your list you guys the uninstall did you guys hear that back there okay",
    "start": "2703119",
    "end": "2709520"
  },
  {
    "text": "um moving the binaries to move the i i said that you shouldn't put them on",
    "start": "2709520",
    "end": "2714640"
  },
  {
    "text": "the system part repetition so you you know what you do you move them to a different partition problem is you don't get to choose where",
    "start": "2714640",
    "end": "2720720"
  },
  {
    "text": "to install them when you initially install them kind of how do you move them well what you do basically is you move the",
    "start": "2720720",
    "end": "2726640"
  },
  {
    "text": "binaries to a new or sorry you copy the binders that's not right you copy the binaries to a new the new location",
    "start": "2726640",
    "end": "2732400"
  },
  {
    "text": "you update the registry uh any references the old location chain them to the new location and then you",
    "start": "2732400",
    "end": "2738000"
  },
  {
    "text": "update the database any references to the old location you put them in the new reference into the new location i have a",
    "start": "2738000",
    "end": "2744640"
  },
  {
    "text": "batch file so that does this entire process the and then you re-register any com",
    "start": "2744640",
    "end": "2751040"
  },
  {
    "text": "components in the new location then every time you update you repeat the process so you can movements",
    "start": "2751040",
    "end": "2757680"
  },
  {
    "text": "just to paint the butts do that securing the front page server extension okay this is this is the whole point of the talk here",
    "start": "2757680",
    "end": "2764480"
  },
  {
    "start": "2759000",
    "end": "2759000"
  },
  {
    "text": "the front page server extensions can be used safely if you",
    "start": "2764560",
    "end": "2770240"
  },
  {
    "text": "and and they can't be used safely in all under all circumstances but if you do have control of who your authors are",
    "start": "2770240",
    "end": "2776800"
  },
  {
    "text": "and where the authors are authoring from then you can secure them you've got to have secure user accounts",
    "start": "2776800",
    "end": "2783359"
  },
  {
    "text": "secure your user accounts you set the proper ntfs permissions not the defaults they give you",
    "start": "2783359",
    "end": "2788400"
  },
  {
    "text": "you configure the registry defaults you keep patched if you can figure out how to do that",
    "start": "2788400",
    "end": "2793839"
  },
  {
    "text": "use ssl for authoring if you don't have an ssl certificate just use a you know self signature self signed one or go to",
    "start": "2793839",
    "end": "2799920"
  },
  {
    "text": "free ssl or something and get a get a certificate there's no reason not to do that you've got to manage the log",
    "start": "2799920",
    "end": "2805680"
  },
  {
    "text": "files and set ip restrictions",
    "start": "2805680",
    "end": "2810240"
  },
  {
    "text": "but you know that's that's all pretty there's a lot to that it's you we're talking a lot of restrictions",
    "start": "2812400",
    "end": "2818319"
  },
  {
    "text": "here if you can restrict people from certain sites to ip addresses to access the surf",
    "start": "2818319",
    "end": "2824079"
  },
  {
    "start": "2819000",
    "end": "2819000"
  },
  {
    "text": "extensions then you can you can use those techniques another technique is to set up a mirror site in web and",
    "start": "2824079",
    "end": "2831280"
  },
  {
    "text": "web in is and basically the the mirror site has",
    "start": "2831280",
    "end": "2837280"
  },
  {
    "text": "all the front page server extensions has everything you need in there the the regular website",
    "start": "2837280",
    "end": "2843280"
  },
  {
    "text": "doesn't have that stuff it doesn't have the front page server extensions enabled but it has this i said that backwards you have to",
    "start": "2843280",
    "end": "2848560"
  },
  {
    "text": "regular website and then on the mirror site the front page server extension site you map all the same virtual",
    "start": "2848560",
    "end": "2853760"
  },
  {
    "text": "directories to this mirror site you can use the mir site then to author all your stuff without having to put any",
    "start": "2853760",
    "end": "2859839"
  },
  {
    "text": "of the front page directories on the actual site the problem is that's not going to really work when",
    "start": "2859839",
    "end": "2866000"
  },
  {
    "text": "if you make extensive use of the web bots but you know it is it is quite effective another thing is url scan rules",
    "start": "2866000",
    "end": "2872400"
  },
  {
    "text": "you can set up rules to limit who can have access to it but or how",
    "start": "2872400",
    "end": "2878319"
  },
  {
    "text": "it's accessed another thing is a customized happy filter i've got a filter and i'll include this all in the",
    "start": "2878319",
    "end": "2883359"
  },
  {
    "text": "download on the it'll be on the black hat website probably by next week um i've got a",
    "start": "2883359",
    "end": "2888560"
  },
  {
    "text": "customized happy filter that basically looks for requests and this would be cool if this was built in but it looks for requests",
    "start": "2888560",
    "end": "2895440"
  },
  {
    "text": "to the front page binaries and then checks your ip address and if you're in the loud ip",
    "start": "2895440",
    "end": "2901359"
  },
  {
    "text": "address range it it lets you through if it if you're not it just says 404 so anyone else who looks at them will think",
    "start": "2901359",
    "end": "2908000"
  },
  {
    "text": "that they're not there the other solution is to neuter the front page server extension through ntfs",
    "start": "2908000",
    "end": "2913119"
  },
  {
    "text": "restrictions like i said that anyone can have access",
    "start": "2913119",
    "end": "2918480"
  },
  {
    "text": "to all this information through shtml.dll but you can actually set",
    "start": "2918480",
    "end": "2924240"
  },
  {
    "text": "permissions on that now if you don't use how many people use the front page server extensions for authoring but",
    "start": "2924240",
    "end": "2929520"
  },
  {
    "text": "don't really make use of the web bots in that case you can you can set mtfs restrictions on shmail.dll",
    "start": "2929520",
    "end": "2936640"
  },
  {
    "text": "that way when you go to request it it's going to request authentication you authenticate and you're able to author a",
    "start": "2936640",
    "end": "2942800"
  },
  {
    "text": "site normally it works transparently for front page but anyone who wants to come in and",
    "start": "2942800",
    "end": "2947920"
  },
  {
    "text": "play around with html dll will not be able to do that without being authenticated another thing you can do is remove some of the directories",
    "start": "2947920",
    "end": "2954079"
  },
  {
    "text": "that are on there the the if you don't use the bots then you can remove many of the directories that are",
    "start": "2954079",
    "end": "2959760"
  },
  {
    "text": "on there and again there's so many different configurations there's it's that depends",
    "start": "2959760",
    "end": "2965920"
  },
  {
    "text": "on what you're doing another thing you can do is disable authoring if you use the web bots but use",
    "start": "2965920",
    "end": "2971839"
  },
  {
    "text": "another method for uploading your sites then you can you can disable author.dll",
    "start": "2971839",
    "end": "2978160"
  },
  {
    "text": "and admin.dll but still allow the web bots so it's protects you a little bit more there there are some other tricks",
    "start": "2978160",
    "end": "2986880"
  },
  {
    "text": "i actually work on a nice happy filter that use regular expressions to",
    "start": "2986880",
    "end": "2993200"
  },
  {
    "text": "to do more advanced filtering spotting attacks okay log entries oh",
    "start": "2993200",
    "end": "3000400"
  },
  {
    "text": "if you ever see this that's probably because i was there no",
    "start": "3000400",
    "end": "3007280"
  },
  {
    "text": "um the log entries the uh you basically got it's pretty obvious",
    "start": "3007280",
    "end": "3014240"
  },
  {
    "text": "what product someone's using you got i can't can anyone see that",
    "start": "3014240",
    "end": "3019520"
  },
  {
    "text": "you'll see requests to the various binaries um you'll also see the user agent in fact",
    "start": "3024240",
    "end": "3029520"
  },
  {
    "text": "the user agent will tell you which product they're using now i mentioned there's front pages integrated",
    "start": "3029520",
    "end": "3036160"
  },
  {
    "text": "with many products you see as web folders you see them there's actually an ado driver to access",
    "start": "3036160",
    "end": "3042880"
  },
  {
    "text": "front page enable enable well front page and web dev enabled sites so you can see right here",
    "start": "3042880",
    "end": "3048960"
  },
  {
    "text": "microsoft data access internet publishing provider protocol discovery which is uh",
    "start": "3048960",
    "end": "3056640"
  },
  {
    "text": "what uh front page does to see if the site is webdav enabled",
    "start": "3056880",
    "end": "3061920"
  },
  {
    "text": "you'll see depending on like uh someone's trying to",
    "start": "3061920",
    "end": "3068240"
  },
  {
    "text": "do a scan for front page likes i wrote the um a bunch of scripts for",
    "start": "3068240",
    "end": "3074240"
  },
  {
    "text": "rfps whisker and and those are actually integrated as part of the product now but you'll see a lot of scans there for",
    "start": "3074240",
    "end": "3080559"
  },
  {
    "text": "like registration.ta and you'll see the you know the telltale sign that it's it's a cgi scan",
    "start": "3080559",
    "end": "3088160"
  },
  {
    "text": "now an interesting thing i had a there's a puerto rican government site that was",
    "start": "3088319",
    "end": "3094319"
  },
  {
    "text": "defaced and i took a lot a look at the log files",
    "start": "3094319",
    "end": "3101838"
  },
  {
    "text": "and it was uh it was it was a pretty busy site it's hard to track down exactly where the where the treasures occurred",
    "start": "3102160",
    "end": "3108800"
  },
  {
    "text": "and what happened and there wasn't there weren't a lot of the typical things that you see when a web intrusion occurs and",
    "start": "3108800",
    "end": "3114000"
  },
  {
    "text": "so i started what happened is they had replaced the index.html and then created a",
    "start": "3114000",
    "end": "3121920"
  },
  {
    "text": "a graphic there which is very graphic uh",
    "start": "3123040",
    "end": "3128559"
  },
  {
    "text": "what i did is basically started looking through the web files when you when you visit a website and you download the graphic",
    "start": "3128559",
    "end": "3135119"
  },
  {
    "text": "the first time you'll get a 200 status code second time you come back there if it's in your cache you'll get 302. so",
    "start": "3135119",
    "end": "3140720"
  },
  {
    "text": "i've seen all these 302 so i look back to find the first 200 where the 200s first start appearing and then that took",
    "start": "3140720",
    "end": "3146160"
  },
  {
    "text": "me to three lines of of log entries and basically what they were was one post to the um one get uh one host",
    "start": "3146160",
    "end": "3153839"
  },
  {
    "text": "to the shtml dll um to see if the",
    "start": "3153839",
    "end": "3158880"
  },
  {
    "text": "front the front page circuit sensors were password protected and then two posts to author dll that basically",
    "start": "3158880",
    "end": "3163920"
  },
  {
    "text": "uploaded the two files it didn't even do a check it just uploaded index.htm",
    "start": "3163920",
    "end": "3168960"
  },
  {
    "text": "and this graphic file three lines someone defaced the website three lines and it was it was looking at",
    "start": "3168960",
    "end": "3175359"
  },
  {
    "text": "the um agent string i could tell that it was a",
    "start": "3175359",
    "end": "3182400"
  },
  {
    "text": "the web component in visual basic so it was basically some visual basic app that some guy runs to deface websites",
    "start": "3182400",
    "end": "3188160"
  },
  {
    "text": "interesting is i used index.htm he probably would have been better off going with something like",
    "start": "3188160",
    "end": "3195839"
  },
  {
    "text": "documents like default htm because that's the first in the in the list",
    "start": "3201680",
    "end": "3206800"
  },
  {
    "text": "you know that way if there was an index if there was d if there's default html take that one first otherwise it'll go",
    "start": "3206800",
    "end": "3212559"
  },
  {
    "text": "the next one anyway so three lines active website",
    "start": "3212559",
    "end": "3218319"
  },
  {
    "text": "um that's the kind of stuff that's going on with the stuff with with the front page server extension actually in my",
    "start": "3218319",
    "end": "3223680"
  },
  {
    "start": "3219000",
    "end": "3219000"
  },
  {
    "text": "experience in in uh investigating or or",
    "start": "3223680",
    "end": "3228960"
  },
  {
    "text": "responding to intrusions the front-page server extensions were involved probably about 75 of the time",
    "start": "3228960",
    "end": "3234960"
  },
  {
    "text": "in some way um anyway the other trails are files in the server extensions and not",
    "start": "3234960",
    "end": "3241040"
  },
  {
    "text": "one interesting thing about the server extensions is if you use the client uh and i i'm not sure if that's true on",
    "start": "3241040",
    "end": "3247680"
  },
  {
    "text": "the newer clients but if use the front page editor it actually leaves some",
    "start": "3247680",
    "end": "3254400"
  },
  {
    "text": "information on the server's configuration files where you came from",
    "start": "3254400",
    "end": "3259680"
  },
  {
    "text": "if you look at the the actual services.cnf and the various files there you can actually see the the netbios",
    "start": "3259680",
    "end": "3266079"
  },
  {
    "text": "name of the client that last changed it um front page service extension versus web",
    "start": "3266079",
    "end": "3272400"
  },
  {
    "text": "dab i don't know why i put that there so they're kind of the same but kind of different",
    "start": "3272400",
    "end": "3278480"
  },
  {
    "text": "store rules the thing i've noticed on the snort rules is they're",
    "start": "3278480",
    "end": "3284480"
  },
  {
    "text": "largely insufficient in",
    "start": "3284480",
    "end": "3288760"
  },
  {
    "text": "and detecting um front-page",
    "start": "3295040",
    "end": "3300960"
  },
  {
    "text": "front-page attacks and the reason is is the same thing is that people really don't understand front page and therefore",
    "start": "3301839",
    "end": "3307359"
  },
  {
    "text": "they don't understand how to write the rules what i've noticed here is is actually a lot of the the urls that i",
    "start": "3307359",
    "end": "3314400"
  },
  {
    "text": "i put in that that whisker script a lot of these things really aren't significant anymore i mean you don't",
    "start": "3314400",
    "end": "3320559"
  },
  {
    "text": "really see administ authors.pwd very much anymore you don't see orders.txt and registrations.stm",
    "start": "3320559",
    "end": "3327359"
  },
  {
    "text": "those were things i stuck in there because they were common at one time and and unprotected too a form results.html",
    "start": "3327359",
    "end": "3335040"
  },
  {
    "text": "form results.txt but most of stuff you really don't see four dots",
    "start": "3335040",
    "end": "3342240"
  },
  {
    "text": "you know that's that's a personal web server one dv wssr.dll that's a visual interdev one",
    "start": "3342240",
    "end": "3350079"
  },
  {
    "text": "and then he got this this bottom rule is is just vti bin access you know anyone",
    "start": "3350079",
    "end": "3355920"
  },
  {
    "text": "access pti bin it puts a snort event so anyway what i've done is i've gone through and created a bunch of snort",
    "start": "3355920",
    "end": "3361599"
  },
  {
    "text": "rules that are more specific for example that look for specific vtrpc methods so",
    "start": "3361599",
    "end": "3367839"
  },
  {
    "text": "you can find out if someone has deleted files from the site or",
    "start": "3367839",
    "end": "3374240"
  },
  {
    "text": "changed configuration settings or whatever and and those i will also include in the in the download um",
    "start": "3374240",
    "end": "3381440"
  },
  {
    "text": "but it's a lot of times you do legitimately use the front page server extensions but you don't want people",
    "start": "3381440",
    "end": "3388640"
  },
  {
    "text": "authoring from certain ip addresses or whatever and this will give you a lot more control over that",
    "start": "3388640",
    "end": "3395280"
  },
  {
    "text": "you can also use the snort rules to log front page server extension actions now i said the the log",
    "start": "3395280",
    "end": "3402559"
  },
  {
    "start": "3396000",
    "end": "3396000"
  },
  {
    "text": "files there they kind of suck they tell you what a lot of times they'll tell you what the",
    "start": "3402559",
    "end": "3409040"
  },
  {
    "text": "the vti rpc method is but they won't tell you the actual parameters of the method",
    "start": "3409040",
    "end": "3414079"
  },
  {
    "text": "so like say let's say someone deleted a file but you don't know what file they deleted or if they created one or whatever",
    "start": "3414079",
    "end": "3419520"
  },
  {
    "text": "and with the snort rules you can actually trigger on every vtr rpc method that's",
    "start": "3419520",
    "end": "3426559"
  },
  {
    "text": "sent and then create your own log file of what's going on there",
    "start": "3426559",
    "end": "3432480"
  },
  {
    "text": "i got some tools uh xf xfp.pl it's from a perl script basically",
    "start": "3432480",
    "end": "3438960"
  },
  {
    "start": "3435000",
    "end": "3435000"
  },
  {
    "text": "it's it scans websites for front page server extensions",
    "start": "3438960",
    "end": "3444720"
  },
  {
    "text": "fpsc info it pulls the services file and and instructs that and puts it in a more",
    "start": "3445359",
    "end": "3450799"
  },
  {
    "text": "readable format um basically you know you can look at all the different subwebs on the site it used to be on the old old",
    "start": "3450799",
    "end": "3457440"
  },
  {
    "text": "front page client 98 you could connect to a site and you could list all the subwebs which is really interesting because",
    "start": "3457440",
    "end": "3463119"
  },
  {
    "text": "you you could quite a few times i connected to commercial websites and you see this you know test one and then my web one and",
    "start": "3463119",
    "end": "3470960"
  },
  {
    "text": "um and you could connect to them without a password well the sites are there the new client",
    "start": "3470960",
    "end": "3476079"
  },
  {
    "text": "doesn't show that it doesn't show all the different subwebs unless they're directly underneath the main web",
    "start": "3476079",
    "end": "3482240"
  },
  {
    "text": "um but this the information is still there for backwards compatibility so that's that's one thing that that tool",
    "start": "3482240",
    "end": "3487359"
  },
  {
    "text": "does secure fpsc.cmd is basically a tool that sets the registry settings and",
    "start": "3487359",
    "end": "3492880"
  },
  {
    "text": "relocates the server extensions to the right partition to a safe partition and the fp blocks the isap filter i",
    "start": "3492880",
    "end": "3498960"
  },
  {
    "text": "mentioned and this is an interesting thing i you know it used to be that i one time around my",
    "start": "3498960",
    "end": "3504720"
  },
  {
    "text": "script that xfp i've had this this tool for about three years now and like i said people didn't really care for a",
    "start": "3504720",
    "end": "3510480"
  },
  {
    "text": "long time and um you know just you just don't use the front page server extensions well i it",
    "start": "3510480",
    "end": "3516319"
  },
  {
    "text": "used to be that i could scan a classy address and i actually one time had a little script that pulled a bunch",
    "start": "3516319",
    "end": "3522000"
  },
  {
    "text": "of urls from yahoo and then ran them through here and it was amazing it was like 75",
    "start": "3522000",
    "end": "3527760"
  },
  {
    "text": "percent of the companies would be configured wrong i was back with nt4 um but this is a i just ran this on you",
    "start": "3527760",
    "end": "3535520"
  },
  {
    "text": "know 10 ip addresses i found two sites that were open",
    "start": "3535520",
    "end": "3541280"
  },
  {
    "text": "you know and it's that was a good representation of what",
    "start": "3541280",
    "end": "3546640"
  },
  {
    "text": "way where we're still at you know 500 error but you know it's it's why isn't this still fixed i mean why",
    "start": "3546640",
    "end": "3552720"
  },
  {
    "text": "are people still getting this thing wrong and you know kind of illustrates the point the surf",
    "start": "3552720",
    "end": "3558880"
  },
  {
    "text": "extensions are actually more important that people realize a lot of people want to forget about them but the fact is they're here to",
    "start": "3558880",
    "end": "3564400"
  },
  {
    "text": "stay and they're vulnerable",
    "start": "3564400",
    "end": "3570240"
  },
  {
    "text": "um i already talked about that already talked about that",
    "start": "3570839",
    "end": "3576319"
  },
  {
    "start": "3575000",
    "end": "3575000"
  },
  {
    "text": "future actually i have nothing to say on the future it's just a good way to",
    "start": "3576319",
    "end": "3582240"
  },
  {
    "text": "slide there does anyone have any questions i i kind of ranted as quick and i didn't uh",
    "start": "3582240",
    "end": "3588480"
  },
  {
    "text": "i'm not sure if i covered everything in enough details any questions specifically about",
    "start": "3588480",
    "end": "3594400"
  },
  {
    "text": "uh server extension vulnerabilities or how to secure them",
    "start": "3594400",
    "end": "3599799"
  },
  {
    "text": "okay yeah the question is there url um i will make these available on um my website is security.info and also",
    "start": "3603119",
    "end": "3611040"
  },
  {
    "text": "they will be available on the black hat website um one comment is that uh on the server",
    "start": "3611040",
    "end": "3617839"
  },
  {
    "text": "extensions if you run a front-page server extension site one quick way to check them is if you connect to your",
    "start": "3617839",
    "end": "3622960"
  },
  {
    "text": "site and you're not prompted to for a password then no one else is prompted for a password and another thing is if",
    "start": "3622960",
    "end": "3630000"
  },
  {
    "text": "they're not prompted for a password they can usually upload executables or trojans or just about anything they want",
    "start": "3630000",
    "end": "3636400"
  },
  {
    "text": "so it's significant risk if you have front page server extensions open then your whole server is owned",
    "start": "3636400",
    "end": "3642799"
  },
  {
    "text": "most likely any other questions",
    "start": "3642799",
    "end": "3647040"
  },
  {
    "text": "okay the question is what are the actual permissions needed for it to function properly now that's",
    "start": "3654839",
    "end": "3660319"
  },
  {
    "text": "a good question depends on what you're doing now if you're doing say like a discussion web bot then you're going to",
    "start": "3660319",
    "end": "3665599"
  },
  {
    "text": "need right access to i'm talking ntfs permissions here you need right access to",
    "start": "3665599",
    "end": "3671200"
  },
  {
    "text": "certain directories on is permissions you don't need right access for anything ever",
    "start": "3671200",
    "end": "3676400"
  },
  {
    "text": "well very rare um but the the ntfs permissions the the",
    "start": "3676400",
    "end": "3682799"
  },
  {
    "text": "the either the anomalous web user or the user who will be accessing the website",
    "start": "3682799",
    "end": "3687839"
  },
  {
    "text": "or the group however you do set that up they need at least read access oftentimes",
    "start": "3687839",
    "end": "3695040"
  },
  {
    "text": "write oftentimes full change permissions and it's it's it's actually so complicated that i just gave up trying",
    "start": "3695040",
    "end": "3700559"
  },
  {
    "text": "to figure it out because it was um there's just so many variables there's so many different things that you could",
    "start": "3700559",
    "end": "3706000"
  },
  {
    "text": "throw in there for the basic basic permissions if you don't use the web bots all you need is read and write",
    "start": "3706000",
    "end": "3713280"
  },
  {
    "text": "on the the vti bin directory that's kind of interesting what i do on that",
    "start": "3713280",
    "end": "3718559"
  },
  {
    "text": "is it needs that executable execute access on that but what i do is i set",
    "start": "3718559",
    "end": "3724400"
  },
  {
    "text": "on the directory itself i i do not allow write and i do not allow execute and then i go to each of the binaries and",
    "start": "3724400",
    "end": "3731200"
  },
  {
    "text": "set them individually so if someone say using a unicode exploiter something uploads a new file to that directory",
    "start": "3731200",
    "end": "3738000"
  },
  {
    "text": "first of all they wouldn't be able to write to it that directory but if they were able to upload something there they wouldn't be able to execute it",
    "start": "3738000",
    "end": "3745440"
  },
  {
    "text": "so it's it prevents new files in that directory from being executed as a way of limiting the exposure of having",
    "start": "3745440",
    "end": "3750799"
  },
  {
    "text": "execute access i try to stay away from any kind of execute access now the dlls",
    "start": "3750799",
    "end": "3758160"
  },
  {
    "text": "even though they are dlls you still need execute ntfs permissions on those because they",
    "start": "3758160",
    "end": "3764000"
  },
  {
    "text": "are isap extension dlls on the root directory again it's it's based on the ntfs permissions the best",
    "start": "3764000",
    "end": "3770559"
  },
  {
    "text": "way to do that is to use the front page server extensions",
    "start": "3770559",
    "end": "3775920"
  },
  {
    "text": "wizard to set the permissions change permissions to the titus and then go back and tighten it up even more",
    "start": "3775920",
    "end": "3782880"
  },
  {
    "text": "based on your exact configuration um another thing i",
    "start": "3782880",
    "end": "3789040"
  },
  {
    "text": "hadn't mentioned i kind of lightly touched on was the ip restrictions if you have a front page server extension",
    "start": "3789040",
    "end": "3794960"
  },
  {
    "text": "site and you only want your individual developers on your network to author the",
    "start": "3794960",
    "end": "3800240"
  },
  {
    "text": "site you can go through and set the ip restrictions on each of those individual virtual directories to only allow to",
    "start": "3800240",
    "end": "3806240"
  },
  {
    "text": "your specific ip range and depending on whether you use the bots or not you can also do that on",
    "start": "3806240",
    "end": "3813280"
  },
  {
    "text": "html.dll and that way anyone else who tries to play around with server extensions is",
    "start": "3813280",
    "end": "3818720"
  },
  {
    "text": "not able to get anything and i also mentioned you if you don't use the bots you can hackle the shtml.dll",
    "start": "3818720",
    "end": "3826400"
  },
  {
    "text": "requiring people authenticate before they get in there another thing i should also mention is when i set up",
    "start": "3826400",
    "end": "3832480"
  },
  {
    "text": "the the server extensions i do not use administrators group to administer the website i create a new",
    "start": "3832480",
    "end": "3838480"
  },
  {
    "text": "group for administering them and then i deny administrators permissions on those",
    "start": "3838480",
    "end": "3844000"
  },
  {
    "text": "directories um i'm on the on the dlls the front page binary dlls that prevents",
    "start": "3844000",
    "end": "3851440"
  },
  {
    "text": "people from getting using administrator accounts to get in and gain access to server extensions",
    "start": "3851440",
    "end": "3857839"
  },
  {
    "text": "basically limits it to those access to the specific web authors or administrators or",
    "start": "3857839",
    "end": "3863520"
  },
  {
    "text": "web administrators that you have set up without using the built-in administrator account",
    "start": "3863520",
    "end": "3868960"
  },
  {
    "text": "any other questions",
    "start": "3868960",
    "end": "3872440"
  },
  {
    "text": "it's um as you point out it's not as user friendly",
    "start": "3879440",
    "end": "3884960"
  },
  {
    "text": "but if you go to the knowledge base and um",
    "start": "3884960",
    "end": "3891079"
  },
  {
    "text": "yeah there's there are some good knowledge-based articles i would recommend not using them sorry that no they",
    "start": "3896240",
    "end": "3902799"
  },
  {
    "text": "i would recommend using them looking at them and taking that information into account but um even even still they",
    "start": "3902799",
    "end": "3908720"
  },
  {
    "text": "they're off they're often a little bit more liberal than they could be i mean you can you can you can lock those things down pretty tight",
    "start": "3908720",
    "end": "3915039"
  },
  {
    "text": "um much further than what what's recommended there but yeah there are knowledge based articles that do that do",
    "start": "3915039",
    "end": "3920720"
  },
  {
    "text": "go into detail and quite a bit of detail on that",
    "start": "3920720",
    "end": "3925480"
  },
  {
    "text": "executables within the website itself",
    "start": "3936240",
    "end": "3941960"
  },
  {
    "text": "and and yeah and that cares through all of yeah all of is it's you know set different permissions on the directories",
    "start": "3953839",
    "end": "3959039"
  },
  {
    "text": "than you said on the files themselves that way any new files are created don't automatically have the permissions like",
    "start": "3959039",
    "end": "3964559"
  },
  {
    "text": "for example you could you could not allow read acts that well read acts a little bit different but uh you can",
    "start": "3964559",
    "end": "3970160"
  },
  {
    "text": "limit read access um to inherited and it gets really complicated because you can set a set of",
    "start": "3970160",
    "end": "3976000"
  },
  {
    "text": "permissions on the directory itself on subdirectories and then on new files that are created what i do is on new",
    "start": "3976000",
    "end": "3981760"
  },
  {
    "text": "files are created i set it so that you don't have read access at all or that no one has read acts or only administrators",
    "start": "3981760",
    "end": "3986960"
  },
  {
    "text": "have read access and then it gets kind of complicated when you upload new content you actually actually have to",
    "start": "3986960",
    "end": "3992160"
  },
  {
    "text": "specifically set the ntfs permissions to allow read access that file but it makes a server really secure and when you're",
    "start": "3992160",
    "end": "3997599"
  },
  {
    "text": "talking a high secure server that makes all the difference and the issue here the issue here is i've talked i kind of",
    "start": "3997599",
    "end": "4003039"
  },
  {
    "text": "went through this thing pretty quick but it's the the main con the main point i want to make here is that the security is all",
    "start": "4003039",
    "end": "4008960"
  },
  {
    "text": "about control it's all about being thorough and the front page server extensions you",
    "start": "4008960",
    "end": "4014559"
  },
  {
    "text": "don't really have much control and it's hard to really be thorough because of the the complicated nature i mean you",
    "start": "4014559",
    "end": "4019760"
  },
  {
    "text": "have to i mean i guess i spent quite a bit of time researching and learning about all this stuff",
    "start": "4019760",
    "end": "4024960"
  },
  {
    "text": "and it's and still i don't feel like i've done a thorough job of of researching it and um",
    "start": "4024960",
    "end": "4030079"
  },
  {
    "text": "and it's very difficult to be thorough it's very difficult to be in control therefore",
    "start": "4030079",
    "end": "4036319"
  },
  {
    "text": "in general i would say the front page of extensions are not secure but they do have that potential they do have the time if you do spend the time",
    "start": "4036319",
    "end": "4042480"
  },
  {
    "text": "with that you can you can that make them reasonably secure to very secure depending on how much",
    "start": "4042480",
    "end": "4048319"
  },
  {
    "text": "control you have over who accesses the site any other questions",
    "start": "4048319",
    "end": "4055520"
  },
  {
    "text": "am i out of time five minutes early okay all right that's it",
    "start": "4060000",
    "end": "4068359"
  },
  {
    "text": "you",
    "start": "4257120",
    "end": "4259199"
  }
]