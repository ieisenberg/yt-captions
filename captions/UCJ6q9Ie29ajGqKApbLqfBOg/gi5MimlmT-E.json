[
  {
    "start": "0",
    "end": "45000"
  },
  {
    "text": "hello thank you all for coming to this session um cyber spage capabilities may",
    "start": "2600",
    "end": "7720"
  },
  {
    "text": "appear to be still limited to the biggest countries and we often he about China Airline or Russia aine protectors",
    "start": "7720",
    "end": "15360"
  },
  {
    "text": "on the other hand it's known that smaller countries are buying capabilities from private sector",
    "start": "15360",
    "end": "20400"
  },
  {
    "text": "offensive actors such as NSO or kiru but what about capabilities developed in our",
    "start": "20400",
    "end": "26439"
  },
  {
    "text": "we rarely about that and even less about B TR actors so for the first time",
    "start": "26439",
    "end": "32480"
  },
  {
    "text": "publicly I'm going to introduce mustach moner with the bad guy on the right uh",
    "start": "32480",
    "end": "37719"
  },
  {
    "text": "he has some fancy Tools in his bag of tricks for example he's able to do adverse ininal attacks to compromise",
    "start": "37719",
    "end": "43120"
  },
  {
    "text": "very specific people first a quick presentation of myself I've been working at iset as a",
    "start": "43120",
    "end": "49480"
  },
  {
    "start": "45000",
    "end": "90000"
  },
  {
    "text": "mar researcher since 2016 for those who don't know the company iset is the largest NP security vendor based in the",
    "start": "49480",
    "end": "55960"
  },
  {
    "text": "EU and you may have heard about some of our big research last year a black hat when my colleagues presented about",
    "start": "55960",
    "end": "62559"
  },
  {
    "text": "industri 2 which was an attempt by srum to take down electricity in Ukraine in",
    "start": "62559",
    "end": "68360"
  },
  {
    "text": "April 2022 um we have been working very hard to protect Ukraine from Russia line",
    "start": "68360",
    "end": "73920"
  },
  {
    "text": "tractors for the past 10 years and even most in the beginning of the war and myself I mostly focus on targeted attack",
    "start": "73920",
    "end": "80960"
  },
  {
    "text": "and do technical research on groups such as cha and the Dukes and here is my email in case you want to send questions",
    "start": "80960",
    "end": "87520"
  },
  {
    "text": "after the talk so let's start um this presentation is",
    "start": "87520",
    "end": "93439"
  },
  {
    "start": "90000",
    "end": "376000"
  },
  {
    "text": "divided in five sections and in the first one let's see who is mustach",
    "start": "93439",
    "end": "98640"
  },
  {
    "text": "bonser so our latest interest into the group started around the Russian invasion of Ukraine in February 2022 it",
    "start": "98640",
    "end": "106360"
  },
  {
    "text": "turns out that mustach monel targeted the foreign embassies of of a European",
    "start": "106360",
    "end": "111520"
  },
  {
    "text": "country in Belarus just four days after the invasion and this immediately triggered our attention however mustach",
    "start": "111520",
    "end": "119399"
  },
  {
    "text": "bu didn't start operating in 2022 and actually the earliest sample we found",
    "start": "119399",
    "end": "125280"
  },
  {
    "text": "was uploaded in 2014 on varus toter and it was just in 2018 that one of my colle",
    "start": "125280",
    "end": "132080"
  },
  {
    "text": "first uncovered the group when they targeted one of our customer in barus I",
    "start": "132080",
    "end": "137200"
  },
  {
    "text": "take this opportunity to thank all my colleague at EET research to help me to better understand mustach buer",
    "start": "137200",
    "end": "143560"
  },
  {
    "text": "operations and then in 2020 the group acquired a new capability and they are",
    "start": "143560",
    "end": "148680"
  },
  {
    "text": "now able to do aders in the middle",
    "start": "148680",
    "end": "152680"
  },
  {
    "text": "attacks then the group stay active during 2022 and in July we detected a",
    "start": "154560",
    "end": "160120"
  },
  {
    "text": "campaign against diplomats of the EU country in Belarus and finally in October that year we were able to link",
    "start": "160120",
    "end": "166480"
  },
  {
    "text": "mustach wer to another cyber group known as winter River more on that in the first section of this presentation and",
    "start": "166480",
    "end": "173280"
  },
  {
    "text": "of course must buer have been also active in 2023 but without major changes in the ttps over this means the group",
    "start": "173280",
    "end": "180800"
  },
  {
    "text": "have been operating for almost 10 years targeting foreign diplomats in barus without gain much public attention until",
    "start": "180800",
    "end": "189879"
  },
  {
    "text": "today based on EET Telemetry data that we have reviewed we found out that mustach b only targets foreign diplomats",
    "start": "189879",
    "end": "197159"
  },
  {
    "text": "stationed in barus that means the group is engaging in surveillance and probably cont Espionage within the border of the",
    "start": "197159",
    "end": "206040"
  },
  {
    "text": "country but where do those foreign diplomats come from we actually identify different countries being targeted some",
    "start": "206040",
    "end": "212360"
  },
  {
    "text": "are African countries or the South Asian countries and also countries in Europe and the EU we have highlighted the whole",
    "start": "212360",
    "end": "220239"
  },
  {
    "text": "region because we don't want to disclose exactly which countries were targeted and our research is based on iset",
    "start": "220239",
    "end": "227360"
  },
  {
    "text": "Telemetry data so of course we don't have full visibility on all Targets and as such as such it is difficult to",
    "start": "227360",
    "end": "233840"
  },
  {
    "text": "assess if most Asun targets all forign diplomats in barus or only those of a",
    "start": "233840",
    "end": "238959"
  },
  {
    "text": "few selected countri mustache bones for operation",
    "start": "238959",
    "end": "244879"
  },
  {
    "text": "have interesting characteristics first the group uses adverse in the middle attacks in order to compromise their",
    "start": "244879",
    "end": "250720"
  },
  {
    "text": "targets usually this technique is used by stateb groups doing surveillance in a specific country I will give more",
    "start": "250720",
    "end": "257079"
  },
  {
    "text": "details about that in a few slides second they're using several different Mala families from big and M C++",
    "start": "257079",
    "end": "264280"
  },
  {
    "text": "implants to simple Tools in go and third mustach Bon use quite unusual Network",
    "start": "264280",
    "end": "269680"
  },
  {
    "text": "protocols for Comm control Communications they're leveraging M protocols such as SMTP and IMAP they",
    "start": "269680",
    "end": "275919"
  },
  {
    "text": "also do DNS toning and are also using SMB in conjunction with the adversary inal",
    "start": "275919",
    "end": "282479"
  },
  {
    "text": "attacks finally if you are will have summarize mustache Bon like that to me I",
    "start": "282479",
    "end": "287600"
  },
  {
    "text": "will have immediately said that cha a wellknown raline tractors was behind",
    "start": "287600",
    "end": "292759"
  },
  {
    "text": "those operations so who knows if mustage boner could have received some kind of training from T and for those",
    "start": "292759",
    "end": "300440"
  },
  {
    "text": "where CH is a cyber spage group that has been active for around 20 years and that was attributed to the Russian FSB by the",
    "start": "300440",
    "end": "308080"
  },
  {
    "text": "USA and UK governments now that we've talked about",
    "start": "308080",
    "end": "313400"
  },
  {
    "text": "the TTP and the victims what about the operators of the group on one hand we found strings written in Russian in one",
    "start": "313400",
    "end": "319400"
  },
  {
    "text": "of the backos uh the one of the L translates to thread cannot create",
    "start": "319400",
    "end": "324759"
  },
  {
    "text": "trade and not that Russian is a language",
    "start": "324759",
    "end": "330039"
  },
  {
    "text": "commonly used in belus but of course it's just a string any like Russian speaker could could write that on the",
    "start": "330039",
    "end": "336840"
  },
  {
    "text": "other hand we know that mustach moner engage in the surveillance of foreign diplomats in barus and they are not",
    "start": "336840",
    "end": "342680"
  },
  {
    "text": "operating against targets outside of the country so given these two elements we",
    "start": "342680",
    "end": "348319"
  },
  {
    "text": "assess with medum confidence that mustach mon is align with the interest of Belarus I believe it's an interesting",
    "start": "348319",
    "end": "355319"
  },
  {
    "text": "Discovery because there is very little public information about barine tractus",
    "start": "355319",
    "end": "360560"
  },
  {
    "text": "except maybe UNC 1151 but their operation are very different and UNC 1151 operation are",
    "start": "360560",
    "end": "367319"
  },
  {
    "text": "more I'm oriented toward disinformation and creating chaos in Central and Eastern",
    "start": "367319",
    "end": "374520"
  },
  {
    "start": "376000",
    "end": "488000"
  },
  {
    "text": "Europe now let's Deep dive into adverse inal attacks which enabl mustache moner",
    "start": "376080",
    "end": "381440"
  },
  {
    "text": "to compromise their targets first what is an adversary in",
    "start": "381440",
    "end": "386840"
  },
  {
    "text": "the middle attack for those who have been in the field for a long time that's exactly what we use to name m in the middle as it names indicates it consist",
    "start": "386840",
    "end": "394440"
  },
  {
    "text": "in in an attacker being positioned between two network devices that are communicating between each the goal is",
    "start": "394440",
    "end": "400560"
  },
  {
    "text": "to listen to the traffic and if possible to modify it both listening and modifying the traffic are not always",
    "start": "400560",
    "end": "406759"
  },
  {
    "text": "possible for example TLS encryption could prevent this kind of",
    "start": "406759",
    "end": "411960"
  },
  {
    "text": "attack and it's not the first time that I've investigated a cyber spinach group",
    "start": "411960",
    "end": "417000"
  },
  {
    "text": "using aitm attacks in the W in in 2018 we published a report about the Tua",
    "start": "417000",
    "end": "422800"
  },
  {
    "text": "mosquito campaign in which diplomats were compromised using this technique",
    "start": "422800",
    "end": "428160"
  },
  {
    "text": "you can access the full white paper on our blog with security.com",
    "start": "428160",
    "end": "434039"
  },
  {
    "text": "if we scr on the white paper it says that we have identified the download of malicious executor files from ADM",
    "start": "434039",
    "end": "440879"
  },
  {
    "text": "download. id.com through HTTP so not https at that time Adobe confirmed that",
    "start": "440879",
    "end": "446840"
  },
  {
    "text": "those executable files were not distributed from from their servers as such we concluded that the network",
    "start": "446840",
    "end": "452199"
  },
  {
    "text": "packets were temper with between the victim's machine and the Adobe or actually akami servers and that's what",
    "start": "452199",
    "end": "458759"
  },
  {
    "text": "is called an adversary in the middle attack we came up with few hypothesis",
    "start": "458759",
    "end": "464080"
  },
  {
    "text": "but only two are the most likely a compromised Network Gateway such as the rout of the victims or an itm attack at",
    "start": "464080",
    "end": "470400"
  },
  {
    "text": "the ASP level in both cases the HTTP traffic would have been modified on the fly to inject a manous HTTP reply",
    "start": "470400",
    "end": "477039"
  },
  {
    "text": "containing the Malin what's important to remember is that it's fully transparent for the victim and the network traffic",
    "start": "477039",
    "end": "483960"
  },
  {
    "text": "looks genuine from the victim's machine point of view now that we've seen how attackers",
    "start": "483960",
    "end": "491400"
  },
  {
    "text": "can use aitm to compromise their targets let's see what exactly happened with",
    "start": "491400",
    "end": "496840"
  },
  {
    "text": "mustache boner let's take the point of view of a diplomat working in their Embassy in",
    "start": "496840",
    "end": "502759"
  },
  {
    "text": "barus they sto their computer and windows does a DNS request for mstf",
    "start": "502759",
    "end": "508000"
  },
  {
    "text": "connect.com to see if the machine is being a captive portal so as a reminder",
    "start": "508000",
    "end": "513560"
  },
  {
    "text": "captive portal is a web page like that um that allows the user to log in a",
    "start": "513560",
    "end": "519200"
  },
  {
    "text": "Wi-Fi network is commonly used in hotel restaurants Etc and to check if a computer needs to authenticate to a",
    "start": "519200",
    "end": "525800"
  },
  {
    "text": "captive portal Windows does automatically a DNS request to this",
    "start": "525800",
    "end": "531080"
  },
  {
    "text": "domain it turns out that there is something responding to the DNS request for the mustache bonser targets we",
    "start": "531080",
    "end": "538360"
  },
  {
    "text": "believe it's some kind of of device located at the ASP providers and then we observe HTTP redirection from this msft",
    "start": "538360",
    "end": "546000"
  },
  {
    "text": "connect test.com domain to update the microsoft.com um it's not a valid",
    "start": "546000",
    "end": "552200"
  },
  {
    "text": "subdomain meaning that if you try on a machine it won't resolve and nonetheless the domain was reserved on the victim's",
    "start": "552200",
    "end": "558440"
  },
  {
    "text": "machine and HTML content was served so this is what the victims could",
    "start": "558440",
    "end": "565040"
  },
  {
    "text": "observe on their machine so they started their computer and a fake Microsoft update page is automatically displayed",
    "start": "565040",
    "end": "572000"
  },
  {
    "text": "to them it's in Russian probably because it's the main language used in barus and the page indicate that there are",
    "start": "572000",
    "end": "578000"
  },
  {
    "text": "critical system security updates that must be installed when looking at the source",
    "start": "578000",
    "end": "584680"
  },
  {
    "text": "code of the page we notice some JavaScript code here and it starts",
    "start": "584680",
    "end": "589760"
  },
  {
    "text": "download of a zip archive Microsoft uh update and then a few digits do zip and",
    "start": "589760",
    "end": "596800"
  },
  {
    "text": "because there is there isn't any any kind of exploit involved the victims needs to manually extract the Z archive",
    "start": "596800",
    "end": "603680"
  },
  {
    "text": "and launch the malicious executables but what interesting is that mustache buer knows who click and",
    "start": "603680",
    "end": "610079"
  },
  {
    "text": "install the mar so long long as long as the target haven't install it they will",
    "start": "610079",
    "end": "615480"
  },
  {
    "text": "be displayed the warning message every time they start their computer so of course even if the first time they don't",
    "start": "615480",
    "end": "621480"
  },
  {
    "text": "want to click on the button after a few days or weeks they will they will just install those fake",
    "start": "621480",
    "end": "628040"
  },
  {
    "text": "updates so the fake Microsoft update is actually a malicious downloader that fetches and",
    "start": "628040",
    "end": "635000"
  },
  {
    "text": "executes additional executables or plugins via the SMB",
    "start": "635000",
    "end": "640360"
  },
  {
    "text": "protocol if we look at a samp that we detected on a victim's machine and this",
    "start": "641279",
    "end": "646680"
  },
  {
    "text": "is the SMB P that was out coded in the binaries and if we look what is this",
    "start": "646680",
    "end": "653000"
  },
  {
    "text": "IP it looks like it's part of Google Cloud but there is no SMB Port open and",
    "start": "653000",
    "end": "659040"
  },
  {
    "text": "and we found many more of those IP addresses in different samples and none of them had smv open so if you try to",
    "start": "659040",
    "end": "665560"
  },
  {
    "text": "mon those shares to exess the files it won't work as such we believe that there is",
    "start": "665560",
    "end": "671880"
  },
  {
    "text": "again adverse in the midle attack involved and the plugin are not deliver by the server that is specified in the",
    "start": "671880",
    "end": "678360"
  },
  {
    "text": "SMB part the SMB traffic is somehow redirected and another server that the attacker controls deliver those",
    "start": "678360",
    "end": "684440"
  },
  {
    "text": "additional executables we are able to capture SMB traffic from compromise machine and we",
    "start": "684440",
    "end": "690880"
  },
  {
    "text": "noted that the name of the server that it's actually replying to the SMB traffic was keelly so it's kind of funny",
    "start": "690880",
    "end": "699720"
  },
  {
    "text": "and also it's also funny because some of the hardcoded IP addresses were clearly",
    "start": "699720",
    "end": "705160"
  },
  {
    "text": "Windows machine so it could not be like some Kelly Kell",
    "start": "705160",
    "end": "711200"
  },
  {
    "text": "server but unfortunately uh we didn't discover the real IP address of these",
    "start": "711200",
    "end": "716320"
  },
  {
    "text": "Kelly servers and anyway it's it could could be behind like a net in a private",
    "start": "716320",
    "end": "721880"
  },
  {
    "text": "range another interesting thing is that the exfiltration is also done via SMB uh",
    "start": "721880",
    "end": "729279"
  },
  {
    "text": "and the aitm attack as such there is no infrastructure that can be easily taken down or blocked attackers are modifying",
    "start": "729279",
    "end": "736920"
  },
  {
    "text": "the CNC IP addresses all the time and it doesn't M doesn't matter for them because they intercept all the traffic",
    "start": "736920",
    "end": "743199"
  },
  {
    "text": "so they can gather data whatever uh the IP is",
    "start": "743199",
    "end": "750120"
  },
  {
    "start": "749000",
    "end": "925000"
  },
  {
    "text": "so we know that the network traffic is intercepted and modified between the victim's machine and the SMB or web",
    "start": "750120",
    "end": "756040"
  },
  {
    "text": "server so there are two main possibilities so same possibilities as",
    "start": "756040",
    "end": "761519"
  },
  {
    "text": "um IAL about when I mention the mosquito campaign it can be the rout of the",
    "start": "761519",
    "end": "767120"
  },
  {
    "text": "Target that was compromised or the tempering could be done at the ISP level with So-Cal lawful interception devices",
    "start": "767120",
    "end": "774079"
  },
  {
    "text": "or deep packet inspection devices so the IP addresses used by the",
    "start": "774079",
    "end": "780240"
  },
  {
    "text": "compromised embassies seem to be residentials and it's not easy to know that those are the embassy exit IP",
    "start": "780240",
    "end": "786079"
  },
  {
    "text": "address except if you have access to the list of customer of the country ISP and second we didn't notice any admin",
    "start": "786079",
    "end": "793079"
  },
  {
    "text": "interface Exposed on those IP addresses so it seems unlikely that this rter",
    "start": "793079",
    "end": "798199"
  },
  {
    "text": "could have been compromised remotely then let's explore public",
    "start": "798199",
    "end": "803839"
  },
  {
    "text": "information about de packet inspection devices in barus",
    "start": "803839",
    "end": "809600"
  },
  {
    "text": "there is an article from Bloomberg who claims that barus bought sunvine devices to filter internet traffic even if the",
    "start": "809600",
    "end": "815920"
  },
  {
    "text": "deal has reportedly been cons a few days after this article those kind of devices",
    "start": "815920",
    "end": "821240"
  },
  {
    "text": "can also be used to inject Network packets and actually it was demonstrated by citizen lab in their bad traffic",
    "start": "821240",
    "end": "827720"
  },
  {
    "text": "investigation in 2018 I encourage you to to read it if you're interesting in the topic it's",
    "start": "827720",
    "end": "834000"
  },
  {
    "text": "very interesting and shows how DPI devices can be abused for for espionage",
    "start": "834000",
    "end": "840759"
  },
  {
    "text": "second there is this report from Amnesty International and it it state that all",
    "start": "840880",
    "end": "847199"
  },
  {
    "text": "isps in belus must install s devices s is a system of operative investigation",
    "start": "847199",
    "end": "853199"
  },
  {
    "text": "me which is developed and deploy in Russia it's a lawful interception system that enables to listen and temper with",
    "start": "853199",
    "end": "860240"
  },
  {
    "text": "the network traffic at scale those two articles tells us that barus has the",
    "start": "860240",
    "end": "865519"
  },
  {
    "text": "ability to do aitm at the ASP level or lawful interception in other words if they wanted",
    "start": "865519",
    "end": "872440"
  },
  {
    "text": "to so given the DPI capabilities that barus has we believe that the address in",
    "start": "872440",
    "end": "877880"
  },
  {
    "text": "the middle is attack is done at the ASP level however we cannot fully discard the compromise rout option it's will",
    "start": "877880",
    "end": "885480"
  },
  {
    "text": "still be possible that roter were compromised via physical access and we were not able to do any forensic on",
    "start": "885480",
    "end": "891680"
  },
  {
    "text": "those devices as a reminder all targeted devices were physically in barus so yeah",
    "start": "891680",
    "end": "897959"
  },
  {
    "text": "that's still a possib and finally it's important to note that the aitm only works for specific IP",
    "start": "897959",
    "end": "905160"
  },
  {
    "text": "addresses it's not possible to reproduce this Chain by using a random VPN IP",
    "start": "905160",
    "end": "910519"
  },
  {
    "text": "address in bellarus so they really know which IP they are",
    "start": "910519",
    "end": "916880"
  },
  {
    "text": "targeting let's go back to to the end of the infection chain which is a tool set",
    "start": "916880",
    "end": "922320"
  },
  {
    "text": "we have named disco so disco is developed in goang has",
    "start": "922320",
    "end": "928040"
  },
  {
    "start": "925000",
    "end": "1104000"
  },
  {
    "text": "been used in 2020 and this is the implant Us in conjunction with the aitm",
    "start": "928040",
    "end": "935000"
  },
  {
    "text": "attacks in most disco samples the function names are not stripped which help the",
    "start": "935000",
    "end": "940720"
  },
  {
    "text": "analysis and this is a main function from the first stage downloader that was delivered via the fake Windows update",
    "start": "940720",
    "end": "948519"
  },
  {
    "text": "page as you can see it create a schedule task uh to to run an executable located",
    "start": "948519",
    "end": "955360"
  },
  {
    "text": "on an out coded SMB P every minute and it also sends a DNS request to The",
    "start": "955360",
    "end": "961079"
  },
  {
    "text": "Domain windows. system. update.com that they probably don't own and our guess is that it is",
    "start": "961079",
    "end": "967880"
  },
  {
    "text": "intercepted and it is a signal that the machine is infected and they don't need to display the fake Windows update page",
    "start": "967880",
    "end": "974319"
  },
  {
    "text": "again because we notice that when a machine is infected then the user isn't",
    "start": "974319",
    "end": "979720"
  },
  {
    "text": "shown again this uh this fake Windows update",
    "start": "979720",
    "end": "984759"
  },
  {
    "text": "page the SMB Shares are both used to deliver spying plugin that are actually additional executable",
    "start": "984759",
    "end": "991680"
  },
  {
    "text": "files but also to exil data collected by those PLS and as I mentioned it's interesting",
    "start": "991680",
    "end": "998199"
  },
  {
    "text": "to note that the machine use by the attackers as CNC server is running C so it doesn't S very",
    "start": "998199",
    "end": "1005680"
  },
  {
    "text": "legitimate here are a few SMB PS that we observe so always as with the Google IP",
    "start": "1006720",
    "end": "1011959"
  },
  {
    "text": "address that was mentioned those server don't expose SMB and if you if you try to mon those shares it won't work so I",
    "start": "1011959",
    "end": "1019079"
  },
  {
    "text": "want to inist that those IP addresses are more or less random it doesn't mean that attacker rented the server like",
    "start": "1019079",
    "end": "1026199"
  },
  {
    "text": "they don't own uh the server uh related to those IP addresses and the traffic never reach",
    "start": "1026199",
    "end": "1033360"
  },
  {
    "text": "reaches the actual server it is intercepted before we have also observed a few",
    "start": "1033360",
    "end": "1039720"
  },
  {
    "text": "non-registered domains instead of IP addresses so for example if you try the wi command on the last one osy",
    "start": "1039720",
    "end": "1046520"
  },
  {
    "text": "status.com uh you'll see that it's not register but nonetheless in iset",
    "start": "1046520",
    "end": "1052640"
  },
  {
    "text": "Telemetry recorded that on a victim machine this domain resol to a real IP",
    "start": "1052640",
    "end": "1057919"
  },
  {
    "text": "address located in China so the victim's machine was really able to get a DNS reply for this",
    "start": "1057919",
    "end": "1064520"
  },
  {
    "text": "non-existent domain and on a side note we've registered the first domain so of",
    "start": "1064520",
    "end": "1069760"
  },
  {
    "text": "course now it's resolving for everyone different go goang plugins are",
    "start": "1069760",
    "end": "1076559"
  },
  {
    "text": "delivered via the SMB shares we found a screenshotter a tool to execute porell script also recent file stealer or local",
    "start": "1076559",
    "end": "1083720"
  },
  {
    "text": "privilege escalation tools that exploit a nonn vulnerability and finally a reverse proxy based on the refox project",
    "start": "1083720",
    "end": "1091200"
  },
  {
    "text": "which is on GitHub the setup of plugins show that mustache Bomer main motivation is is",
    "start": "1091200",
    "end": "1098120"
  },
  {
    "text": "spying on their targets and still confidential",
    "start": "1098120",
    "end": "1103039"
  },
  {
    "start": "1104000",
    "end": "1324000"
  },
  {
    "text": "informations let's move on to the technical analysis of the second implant mustach",
    "start": "1104240",
    "end": "1109280"
  },
  {
    "text": "Ops we named it nine Club because one of the C C++ class was named nine club by",
    "start": "1109280",
    "end": "1115320"
  },
  {
    "text": "its developer as you can see in this LTI",
    "start": "1115320",
    "end": "1119840"
  },
  {
    "text": "information nclub is a modular back door implemented in sepl and it's used since",
    "start": "1120720",
    "end": "1126559"
  },
  {
    "text": "at least 2014 we have never observed nightclub used at the same time as disco and it",
    "start": "1126559",
    "end": "1134320"
  },
  {
    "text": "was never used at the same time as address in the midle attacks and and we don't know how it is actually installed",
    "start": "1134320",
    "end": "1140320"
  },
  {
    "text": "on the victim's machine our guess is that it is used against the targets who are protected by an end to to end",
    "start": "1140320",
    "end": "1147480"
  },
  {
    "text": "encrypted tunnel or VPN for which is not possible to do the rad Direction",
    "start": "1147480",
    "end": "1154360"
  },
  {
    "text": "trick so there are actually few samples of n Club on VAR toal and the oldest one",
    "start": "1154480",
    "end": "1161640"
  },
  {
    "text": "was uploaded in November 2014 from Ukraine and as you can see it fine name",
    "start": "1161640",
    "end": "1167200"
  },
  {
    "text": "indicates that mustach tried to make the target things it was an update for net",
    "start": "1167200",
    "end": "1174520"
  },
  {
    "text": "product there is a not coded configuration in the malware it's encrypted with bite generated via an lcg",
    "start": "1174919",
    "end": "1181720"
  },
  {
    "text": "algorithm and once decrypted we can see that there are few file extensions and",
    "start": "1181720",
    "end": "1186840"
  },
  {
    "text": "also two email addresses which leads to the next",
    "start": "1186840",
    "end": "1192080"
  },
  {
    "text": "slide yes so capabilities of nclub are quite simple and can be summarized in",
    "start": "1193000",
    "end": "1198280"
  },
  {
    "text": "two points it implements a file stealer um it ex filtrates files with the",
    "start": "1198280",
    "end": "1203640"
  },
  {
    "text": "extensions that are included in the configuration so it shows mustach monster is interested in Word Excel and",
    "start": "1203640",
    "end": "1209200"
  },
  {
    "text": "PDF documents the second capability is related to the common in control",
    "start": "1209200",
    "end": "1214320"
  },
  {
    "text": "protocol these days most back doors communicate with the CNC server using HTTP or https in case of nightclub all",
    "start": "1214320",
    "end": "1221919"
  },
  {
    "text": "communication are done via emails they use the SMTP protocol to send emails and",
    "start": "1221919",
    "end": "1226960"
  },
  {
    "text": "they borrow code from the C MTP project uh cmtp Library sorry and to qualify a",
    "start": "1226960",
    "end": "1232720"
  },
  {
    "text": "little bit the email addresses are the one from the configuration they were created and are operated by the",
    "start": "1232720",
    "end": "1238559"
  },
  {
    "text": "attackers nightclub doesn't use the email address of the victim and also note that in the version",
    "start": "1238559",
    "end": "1244840"
  },
  {
    "text": "from 2014 there is no backd door function to for example execute additional payloads it's only a file",
    "start": "1244840",
    "end": "1252640"
  },
  {
    "text": "stealer so let's check in W Shack what it looks like when nightclub execrator file",
    "start": "1252640",
    "end": "1259200"
  },
  {
    "text": "first it authenticate the main server using the credentials from the configuration and in this example the",
    "start": "1259200",
    "end": "1264799"
  },
  {
    "text": "email address was registered at seznam.cz which is a free email provider and the from email fill is also filled",
    "start": "1264799",
    "end": "1271720"
  },
  {
    "text": "with this first email address then it send the email address",
    "start": "1271720",
    "end": "1277000"
  },
  {
    "text": "to the second it sends the email to the second email address that was in the configuration which was also register at",
    "start": "1277000",
    "end": "1284320"
  },
  {
    "text": "cam. CZ and we can guess that the sender email address is per victim while the",
    "start": "1284320",
    "end": "1289840"
  },
  {
    "text": "recipient email address is used by The Operators to collect data from multiple",
    "start": "1289840",
    "end": "1295799"
  },
  {
    "text": "victims then there are a few ERS they might might look uni but they are actually from the cmtp library so it's",
    "start": "1296840",
    "end": "1303520"
  },
  {
    "text": "not a very good signal for Network detection as many software which are using the same Library uh will have",
    "start": "1303520",
    "end": "1309720"
  },
  {
    "text": "those edos and finally there is the file to",
    "start": "1309720",
    "end": "1315440"
  },
  {
    "text": "exrate which is attached uh to the email it's encrypted and then uncoded in B",
    "start": "1315440",
    "end": "1323120"
  },
  {
    "text": "64 the previous slides were a quick analysis of the nclub version from 20144",
    "start": "1323440",
    "end": "1328480"
  },
  {
    "start": "1324000",
    "end": "1549000"
  },
  {
    "text": "in the next year the implant has evolved a little bit for example the turn nclub in a modular back door res on strict F",
    "start": "1328480",
    "end": "1336000"
  },
  {
    "text": "stealer it means that nclub can receive plugins via email in order to collect additional information from the victim's",
    "start": "1336000",
    "end": "1341799"
  },
  {
    "text": "machine and then in 2020 they introduced major changes in the architecture of the",
    "start": "1341799",
    "end": "1346960"
  },
  {
    "text": "mway so it was divided in two components an orator which is responsible for the",
    "start": "1346960",
    "end": "1353159"
  },
  {
    "text": "networking and a modu agent which is responsible for loading additional models as you can see both F names masad",
    "start": "1353159",
    "end": "1360120"
  },
  {
    "text": "has variant of svcs thee a legitimate Windows component um The Operators",
    "start": "1360120",
    "end": "1366000"
  },
  {
    "text": "probably thought they can stay undetected with this little trck and you might wonder how we link",
    "start": "1366000",
    "end": "1373000"
  },
  {
    "text": "the new variant to the previous nro samples and it turns out that they kept this uh",
    "start": "1373000",
    "end": "1378640"
  },
  {
    "text": "log message in Russian and also part of other part of the source",
    "start": "1378640",
    "end": "1385240"
  },
  {
    "text": "code the configuration format was also modified it was moved to an external file named gfl fry. CFG and encrypted",
    "start": "1385240",
    "end": "1393320"
  },
  {
    "text": "with RSA we notice that the RSA private key is out coded in the sample so I'm",
    "start": "1393320",
    "end": "1398880"
  },
  {
    "text": "not sure the advantage of using symmetric cryptography",
    "start": "1398880",
    "end": "1404120"
  },
  {
    "text": "here once the crypted configuration is in Jen uh for example there are fin the",
    "start": "1404120",
    "end": "1409720"
  },
  {
    "text": "modu agent and also the orchestrator name server here then we have a notel",
    "start": "1409720",
    "end": "1415000"
  },
  {
    "text": "option which will uninstall nightclub after a given number of days this can prevent incident respond from analyzing",
    "start": "1415000",
    "end": "1420840"
  },
  {
    "text": "the samples if they analyze the machine too late it's interesting because it shows that mustach moner have a certain",
    "start": "1420840",
    "end": "1427320"
  },
  {
    "text": "level of sophistication and they're thinking about operational",
    "start": "1427320",
    "end": "1432360"
  },
  {
    "text": "security then we scroll down again and we have a section called transport and",
    "start": "1432360",
    "end": "1438000"
  },
  {
    "text": "about the common in control protocol and finally this is the same word that is often used by cha to define the kind of",
    "start": "1438000",
    "end": "1445240"
  },
  {
    "text": "network protocol use in the back door it's not unique but not very frequent then there are two email",
    "start": "1445240",
    "end": "1452400"
  },
  {
    "text": "addresses and two domain used to send and receive emails and not to that",
    "start": "1452400",
    "end": "1457480"
  },
  {
    "text": "contrary to the first version of nclab they are not using any more freil providers those are uh this those are",
    "start": "1457480",
    "end": "1464679"
  },
  {
    "text": "domain name of a server main server they operate and finally there are two options at the",
    "start": "1464679",
    "end": "1471480"
  },
  {
    "text": "bottom Nam ma Max file size and max daily traffic we believe it's intended to prevent nclub from execrating too",
    "start": "1471480",
    "end": "1477600"
  },
  {
    "text": "much data in a short period of time and such big spikes in network traffic could be noticed by security teams and be the",
    "start": "1477600",
    "end": "1484080"
  },
  {
    "text": "start of an investigation it's another example that nclub developer did think about ways of",
    "start": "1484080",
    "end": "1492120"
  },
  {
    "text": "staying under the rider and finally last section it's",
    "start": "1492120",
    "end": "1498279"
  },
  {
    "text": "about the configuration for for the additional modu so it's again some gon and it can have some specific F",
    "start": "1498279",
    "end": "1505159"
  },
  {
    "text": "depending what is a plugin speaking of plugins there are DL",
    "start": "1505159",
    "end": "1511640"
  },
  {
    "text": "masing at any file on disk they are not encrypted and are simply like DL with an",
    "start": "1511640",
    "end": "1517360"
  },
  {
    "text": "export named start starts this export takes one argument which is a configuration in Jen which was like the",
    "start": "1517360",
    "end": "1523960"
  },
  {
    "text": "configuration contain is the bigger configuration of nclub",
    "start": "1523960",
    "end": "1529679"
  },
  {
    "text": "we found four different plugins used by nightclub an audio recorder a screenshotter a Koger and a DNS T back",
    "start": "1529880",
    "end": "1536880"
  },
  {
    "text": "door the first three I used to spy on the victim's machine while the later provide more intera interactive control",
    "start": "1536880",
    "end": "1543760"
  },
  {
    "text": "of the victim's machine to the attacker and Via a different network protocol I won't describe the first",
    "start": "1543760",
    "end": "1550720"
  },
  {
    "start": "1549000",
    "end": "1706000"
  },
  {
    "text": "three plugins because they are not very interesting technically and I guess you can imagine what is a kilog so let's",
    "start": "1550720",
    "end": "1557679"
  },
  {
    "text": "let's focus on the DNS tunneling back door so how does this DNS tuning back",
    "start": "1557679",
    "end": "1564600"
  },
  {
    "text": "door works the pro config provided configuration should contain an IP",
    "start": "1564600",
    "end": "1570080"
  },
  {
    "text": "address of a CNC server which will be used as a DNS server it is provided as a",
    "start": "1570080",
    "end": "1575640"
  },
  {
    "text": "first arguments of DNS query a function it's not really documented by Microsoft",
    "start": "1575640",
    "end": "1581039"
  },
  {
    "text": "on on on their website but it allows to use a specific DNS server instead of the ones configure on the machine",
    "start": "1581039",
    "end": "1588880"
  },
  {
    "text": "the attacker control DNS server replies with one or several DNS txt record they",
    "start": "1588880",
    "end": "1593919"
  },
  {
    "text": "are concatenated and this contain the command to execute so let's check with an",
    "start": "1593919",
    "end": "1600000"
  },
  {
    "text": "example this is the domain that the back door is going to send for resolution to the to the attacker control DNS server",
    "start": "1600000",
    "end": "1606799"
  },
  {
    "text": "the message to send to the DNS server is contained between two letter",
    "start": "1606799",
    "end": "1612520"
  },
  {
    "text": "X and the message in this B 64 when the back door wants to beon to the CNC",
    "start": "1612520",
    "end": "1618559"
  },
  {
    "text": "server to request a command it sends the string empty a reply would look like that not",
    "start": "1618559",
    "end": "1626200"
  },
  {
    "text": "that the delimiter X are still used in for the replies and this is an example I",
    "start": "1626200",
    "end": "1632440"
  },
  {
    "text": "created for the purpose of this talk and if we decode the F the first part in B 64 we have the path to cal.",
    "start": "1632440",
    "end": "1641240"
  },
  {
    "text": "txe then we have the common ID which is in this case 27 which correspond to",
    "start": "1641240",
    "end": "1646640"
  },
  {
    "text": "create a process and then we have a common name we can",
    "start": "1646640",
    "end": "1651919"
  },
  {
    "text": "you can put whatever you want here it's not taken into account by by the back door I guess it's more use on the CNC",
    "start": "1651919",
    "end": "1658919"
  },
  {
    "text": "server side so I told you that 27 correspond to create process so let's check the other",
    "start": "1658919",
    "end": "1665320"
  },
  {
    "text": "command available there is 21 which is a copy directory 22 move a file 23 to",
    "start": "1665320",
    "end": "1673919"
  },
  {
    "text": "remove a file or a directory 24 to search a file 25 to write a file 26 to read a file and",
    "start": "1673919",
    "end": "1682679"
  },
  {
    "text": "of course 27 to create a process so overall this allows to do pretty much everything on the victim's machine from",
    "start": "1682679",
    "end": "1689000"
  },
  {
    "text": "stealing files to dropping files to executing arbitrary",
    "start": "1689000",
    "end": "1693840"
  },
  {
    "text": "commands so after some more works we had finished uh analyzing all samples but we",
    "start": "1694080",
    "end": "1699200"
  },
  {
    "text": "were missing a real example of a conf configuration file the GFA 45. cfv",
    "start": "1699200",
    "end": "1706080"
  },
  {
    "text": "file luckily at some point we got our end on a real nightclub configuration",
    "start": "1706080",
    "end": "1711840"
  },
  {
    "text": "file and we took the CNC domain that was in the config F and we extracted inter",
    "start": "1711840",
    "end": "1718519"
  },
  {
    "text": "interesting characteristics such as the register hosting provider or the port exploited by the server we able to",
    "start": "1718519",
    "end": "1725559"
  },
  {
    "text": "create a quite unique pattern that will match uh active server active nclub server in",
    "start": "1725559",
    "end": "1733399"
  },
  {
    "text": "the world but it turns out that this pattern was also matching another set of",
    "start": "1733399",
    "end": "1738640"
  },
  {
    "text": "server and we quickly realized that they were related to another Espionage group",
    "start": "1738640",
    "end": "1744720"
  },
  {
    "text": "no known as winter R so what is winter r at the time of our",
    "start": "1744720",
    "end": "1752360"
  },
  {
    "text": "Discovery in October 2022 only this original blog post from domain tools was",
    "start": "1752360",
    "end": "1757760"
  },
  {
    "text": "available online it describes the campaigns against various government using malicious documents on a custom",
    "start": "1757760",
    "end": "1763640"
  },
  {
    "text": "poral implants the compaign was specifically uh aim at the governments",
    "start": "1763640",
    "end": "1768760"
  },
  {
    "text": "of aaban Cyprus India Italy Lithuania Ukraine and the",
    "start": "1768760",
    "end": "1773960"
  },
  {
    "text": "Vatican few months uh after additional blog posts were provided were published",
    "start": "1773960",
    "end": "1779960"
  },
  {
    "text": "in February 2023 setu published about a fishing campaign targeting Ukrainian and",
    "start": "1779960",
    "end": "1785200"
  },
  {
    "text": "polish governmental entities it was followed in March 2023",
    "start": "1785200",
    "end": "1790720"
  },
  {
    "text": "by proof point to publish about a campaign abusing non vulnerability in the Zimbra May portal to Target NATO",
    "start": "1790720",
    "end": "1797640"
  },
  {
    "text": "align governments so I can confirm that we have observed exactly what c c and",
    "start": "1797640",
    "end": "1802760"
  },
  {
    "text": "proof publish and agree with their findings so let's look at a typical",
    "start": "1802760",
    "end": "1808320"
  },
  {
    "start": "1806000",
    "end": "1907000"
  },
  {
    "text": "compromise chain the target generary governance staff receive a SP",
    "start": "1808320",
    "end": "1814039"
  },
  {
    "text": "fishing email with a link to a malicious website in this case the page is impersonating the security service of",
    "start": "1814039",
    "end": "1820840"
  },
  {
    "text": "Ukraine ss.gov DOA and it encourages visitors to download the software to check if their computer infected VI M",
    "start": "1820840",
    "end": "1829360"
  },
  {
    "text": "software if the targets don't don't run the software it displays this terminal",
    "start": "1829360",
    "end": "1834679"
  },
  {
    "text": "window so as you can see they didn't even invest much in the UI and you can",
    "start": "1834679",
    "end": "1840279"
  },
  {
    "text": "also see tyos such as a n missing in scanning in the second line that tells",
    "start": "1840279",
    "end": "1846519"
  },
  {
    "text": "us that the attackers are probably not native English speakers but what is exactly this",
    "start": "1846519",
    "end": "1853320"
  },
  {
    "text": "antivirus in fact it's just a bad script uh it first exist execute a poral command to execute an additional poral",
    "start": "1853320",
    "end": "1860760"
  },
  {
    "text": "script and then it writes Al percentages to the console and then writes varus not",
    "start": "1860760",
    "end": "1867760"
  },
  {
    "text": "form without doing any scanning I'm not sure that's how an antivirus it supposed",
    "start": "1867760",
    "end": "1872799"
  },
  {
    "text": "to be implemented or at least that's not how our antivirus is",
    "start": "1872799",
    "end": "1878919"
  },
  {
    "text": "implemented as I said the fake antivirus downloads an additional porell script",
    "start": "1878919",
    "end": "1884039"
  },
  {
    "text": "it's a simple porell back door that downloads commands execute them for",
    "start": "1884039",
    "end": "1889120"
  },
  {
    "text": "example we have seen operators executing Recon command such as task list Ori before trying to exrate some files and",
    "start": "1889120",
    "end": "1896799"
  },
  {
    "text": "finally the result of the command is uploaded to the CNC server so this is the same paral back",
    "start": "1896799",
    "end": "1902679"
  },
  {
    "text": "door that was also mentioned in the domain tools original domain tool blog post in addition to the first chain",
    "start": "1902679",
    "end": "1909279"
  },
  {
    "start": "1907000",
    "end": "2222000"
  },
  {
    "text": "which leads to the full compromise of the victim's machine we notice that winter operators are interested in",
    "start": "1909279",
    "end": "1914399"
  },
  {
    "text": "stealing web make credentials and to do that there have been exploiting a few known vulnerabilities in",
    "start": "1914399",
    "end": "1920760"
  },
  {
    "text": "zra so it start with an email containing a manous link and the link points to the",
    "start": "1920760",
    "end": "1926880"
  },
  {
    "text": "victim's web M portal if we check the URL carefully we can see that it contain",
    "start": "1926880",
    "end": "1931960"
  },
  {
    "text": "JavaScript code in the air code URL parameter the JavaScript code loads",
    "start": "1931960",
    "end": "1937559"
  },
  {
    "text": "another script from the OS oscp dad.com",
    "start": "1937559",
    "end": "1944519"
  },
  {
    "text": "domain after some Googling we found the code corresonding patch on the GitHub of Zimbra as you can see they added a call",
    "start": "1944519",
    "end": "1951679"
  },
  {
    "text": "to the function Escape XML around a few URL parameter including air",
    "start": "1951679",
    "end": "1957320"
  },
  {
    "text": "C this is intended to prevent arbitrary JavaScript code pass via those",
    "start": "1957320",
    "end": "1962760"
  },
  {
    "text": "parameters to be interpreted in the context of the Zimbra web page causing an xss vulnerability and cvu cve was",
    "start": "1962760",
    "end": "1971240"
  },
  {
    "text": "issued in 2022 for this vulnerability uh but the exploitation happen only the next year that means winter only",
    "start": "1971240",
    "end": "1978679"
  },
  {
    "text": "targeted organization that were running outdated versions of Zimbra Here's the final payload",
    "start": "1978679",
    "end": "1986080"
  },
  {
    "text": "downloaded by the script injected via xss first it requires the target to insert the credentials as long as it's",
    "start": "1986080",
    "end": "1993039"
  },
  {
    "text": "not done the error message it displayed to the Target and after a few checks it",
    "start": "1993039",
    "end": "2000360"
  },
  {
    "text": "exfiltrate the credentials to a CNC server not that it also authenticate the victims to the real Z",
    "start": "2000360",
    "end": "2008039"
  },
  {
    "text": "M portal at the same time so the victim won't know anything wrong they will be able to access their inbox right after",
    "start": "2008039",
    "end": "2014559"
  },
  {
    "text": "they have F their credentials in the malicious loging form to summarize winter Ren is a cyber",
    "start": "2014559",
    "end": "2021880"
  },
  {
    "text": "espan group targeting govern government staff in Europe and Asia we found some",
    "start": "2021880",
    "end": "2027000"
  },
  {
    "text": "links in the network infrastructure that lead us to believe that a group is that the group is related to mustach B they",
    "start": "2027000",
    "end": "2033919"
  },
  {
    "text": "maybe collaborate with an entities and manage the two Network infrastructure however it's important to note that",
    "start": "2033919",
    "end": "2040080"
  },
  {
    "text": "winter ven operates against targets outside bellus so their objective is slightly",
    "start": "2040080",
    "end": "2045320"
  },
  {
    "text": "different winter many uses a simple poral back door and they are also doing",
    "start": "2045320",
    "end": "2051040"
  },
  {
    "text": "SP fishing compaigns to steal we credentials using vulnerabilities in",
    "start": "2051040",
    "end": "2057240"
  },
  {
    "text": "zimra during this plation I describe how ters are operating and how we but can we",
    "start": "2057679",
    "end": "2063679"
  },
  {
    "text": "do something to protect against mustache buer and interv actually yes uh first when I",
    "start": "2063679",
    "end": "2071520"
  },
  {
    "text": "presented disco I mentioned that plugins are delivered via SMB shares and that stolen data is also excitated via those",
    "start": "2071520",
    "end": "2078320"
  },
  {
    "text": "shares so we advise to deny smv traffic from the in internal to external network",
    "start": "2078320",
    "end": "2084240"
  },
  {
    "text": "for example using fire and the good thing is that they could have preved the also the recent vulnerability in outl",
    "start": "2084240",
    "end": "2091358"
  },
  {
    "text": "that exate nlm ases via SMB second we suggest to always run run",
    "start": "2091359",
    "end": "2097118"
  },
  {
    "text": "an end to end encrypted VPN tunnel exiting in a trusted location when visiting an unrusted country ideally",
    "start": "2097119",
    "end": "2104359"
  },
  {
    "text": "this VPN tunnel should be out of ban meaning that it's not running on the Nong devices that way it prevent any",
    "start": "2104359",
    "end": "2110760"
  },
  {
    "text": "traffic from going outside the tunnel before the VPN has started for example",
    "start": "2110760",
    "end": "2116079"
  },
  {
    "text": "and so that usual important to patch internet internet facing facing or age devices in the past year there was this",
    "start": "2116079",
    "end": "2123839"
  },
  {
    "text": "uh wool exchange Saga that had a big impact on many organiz a and as a reminder winter even is only targeting",
    "start": "2123839",
    "end": "2130880"
  },
  {
    "text": "unpatched zimra instances they don't have access to to zero day",
    "start": "2130880",
    "end": "2136560"
  },
  {
    "text": "exploits based on the initial DNS request made by nclub uh the the DNS",
    "start": "2136599",
    "end": "2143720"
  },
  {
    "text": "tunneling back nightclub sorry we created this n it's quite quite simple",
    "start": "2143720",
    "end": "2149560"
  },
  {
    "text": "and matches the first DNS request that is made to the TNT",
    "start": "2149560",
    "end": "2155160"
  },
  {
    "text": "server so we're reaching the end of this presentation so let's summarize in order",
    "start": "2155480",
    "end": "2160560"
  },
  {
    "text": "to compromise their target mustach buer uses aitm attack probably abusing lawful interception devices installed at the",
    "start": "2160560",
    "end": "2167359"
  },
  {
    "text": "country ISP we assess that mustach moner is align with the interest of Belarus which",
    "start": "2167359",
    "end": "2174200"
  },
  {
    "text": "is interesting given the nearly absence of public knowledge about their cyber",
    "start": "2174200",
    "end": "2180800"
  },
  {
    "text": "capabilities the targets of the group are throwing Diplomat station in barus we believe that they're engaged in",
    "start": "2181200",
    "end": "2186800"
  },
  {
    "text": "surveillance of those diplomats may be for contary Espionage purposes mustage mon have been operating",
    "start": "2186800",
    "end": "2194079"
  },
  {
    "text": "since 2014 so and for the first time today we have reled information of the group and as such we can say that they",
    "start": "2194079",
    "end": "2201440"
  },
  {
    "text": "were quite successful in flying under the radar so if you'd like to get all",
    "start": "2201440",
    "end": "2207280"
  },
  {
    "text": "technical details please check our blog post it's already live on wise security.com um thank you for your",
    "start": "2207280",
    "end": "2214440"
  },
  {
    "text": "attention I think we have some time for question or you can also join me in the W",
    "start": "2214440",
    "end": "2221240"
  },
  {
    "text": "room",
    "start": "2221640",
    "end": "2224640"
  }
]