[
  {
    "start": "0",
    "end": "81000"
  },
  {
    "text": "all right so I'm Craig Hefner uh this talk is obviously exploiting surveillance cameras like a Hollywood",
    "start": "80",
    "end": "5960"
  },
  {
    "text": "hacker um now as some of you may or may not know uh when my talk was first",
    "start": "5960",
    "end": "13000"
  },
  {
    "text": "announced it got a little bit of press which as a speaker is really cool um the",
    "start": "13000",
    "end": "20080"
  },
  {
    "text": "problem is that in order to Hype their articles all of the news stories who covered my talk decided to emphasize the",
    "start": "20080",
    "end": "27599"
  },
  {
    "text": "fact that I used to work for a particular three-letter agency who has been in the Press quite a bit themselves",
    "start": "27599",
    "end": "34559"
  },
  {
    "text": "lately and although they couldn't quite seem to agree what those three letters actually stood for uh some of them did",
    "start": "34559",
    "end": "42520"
  },
  {
    "text": "go as far as to claim that what I was presenting at black hat was actually work I had done for said",
    "start": "42520",
    "end": "48760"
  },
  {
    "text": "agency um now with current events being what they are this resulted in some very",
    "start": "48760",
    "end": "54399"
  },
  {
    "text": "interesting phone calls from my ex-employer yeah",
    "start": "54399",
    "end": "60879"
  },
  {
    "text": "uh luckily we have people who who handle the phones for me and they got yelled at instead of me um but while my initial",
    "start": "60879",
    "end": "67840"
  },
  {
    "text": "attempts to kind of assuage their fears didn't work I was eventually able to convince",
    "start": "67840",
    "end": "75159"
  },
  {
    "text": "them that yes sometimes people on the internet are wrong so just to be very clear this talk",
    "start": "75159",
    "end": "84040"
  },
  {
    "start": "81000",
    "end": "172000"
  },
  {
    "text": "is not about any work that I've ever done for any ex-employer um what this talk is about",
    "start": "84040",
    "end": "89720"
  },
  {
    "text": "is is work that I do for my current employer um I work as an embedded vulnerability analyst for tactical",
    "start": "89720",
    "end": "96079"
  },
  {
    "text": "Network Solutions um I also teach our embedded device exploitation courses and",
    "start": "96079",
    "end": "101159"
  },
  {
    "text": "Dabble with wireless hacking from time to time as well um what I'm be going to",
    "start": "101159",
    "end": "106280"
  },
  {
    "text": "be talking about today obviously um is the security in surveillance cameras or",
    "start": "106280",
    "end": "113360"
  },
  {
    "text": "lack thereof as it may be um back in early 2011 last year I",
    "start": "113360",
    "end": "121039"
  },
  {
    "text": "started taking a look at um the security that's in the firmware actually running",
    "start": "121039",
    "end": "126920"
  },
  {
    "text": "on these Network connected surveillance cameras um and since I'm up here talking",
    "start": "126920",
    "end": "133720"
  },
  {
    "text": "about it as you might surmise I found a lot of interesting things uh so I'll be dropping some OD days as well as some",
    "start": "133720",
    "end": "140000"
  },
  {
    "text": "not so OD days and we'll talk about that when we get to it um but also",
    "start": "140000",
    "end": "145560"
  },
  {
    "text": "demonstrating how these vulnerabilities ultimately can be leveraged um in True",
    "start": "145560",
    "end": "150680"
  },
  {
    "text": "Hollywood style fashion so when I started looking at surveillance cameras I said well I've looked at a lot of",
    "start": "150680",
    "end": "156560"
  },
  {
    "text": "embedded devices before but I haven't looked at surveillance cameras so I kind of wanted to start off with something",
    "start": "156560",
    "end": "162720"
  },
  {
    "text": "easy something that would be almost guaranteed to get me a win uh so I picked dlink because they never fail to",
    "start": "162720",
    "end": "170920"
  },
  {
    "text": "disappoint specifically I looked at the DCS uh 7410 which at around $900 is one of",
    "start": "171120",
    "end": "178680"
  },
  {
    "start": "172000",
    "end": "240000"
  },
  {
    "text": "their more expensive business IP cameras and like all the cameras that",
    "start": "178680",
    "end": "185480"
  },
  {
    "text": "I'm going to be talking about today um they provide an administrative interface uh as well as access to the video feed",
    "start": "185480",
    "end": "192440"
  },
  {
    "text": "through a web server running on the camera uh which makes a web server a very attractive Target for an",
    "start": "192440",
    "end": "198560"
  },
  {
    "text": "attacker um now specifically this camera uses Lighty which is an open- Source um",
    "start": "198560",
    "end": "204840"
  },
  {
    "text": "web server that you find used quite a bit in embedded devices and they actually in in the Lighty configuration",
    "start": "204840",
    "end": "211879"
  },
  {
    "text": "they set up some very sane and restrictive access rules as to who can get to what through the web server uh so",
    "start": "211879",
    "end": "218840"
  },
  {
    "text": "you can see here that if you wanted to get to anything in the CGI admin directory you have to be logged in as an",
    "start": "218840",
    "end": "224519"
  },
  {
    "text": "admin if you want to get to anything in the video directory you can be any user",
    "start": "224519",
    "end": "229560"
  },
  {
    "text": "but you do have to be authenticated you do have to be a valid user so they had entries for every",
    "start": "229560",
    "end": "236720"
  },
  {
    "text": "single directory in their web interface except one they did not have an entry",
    "start": "236720",
    "end": "242400"
  },
  {
    "start": "240000",
    "end": "343000"
  },
  {
    "text": "for CGI bin now as it turns out there's not much in the CGI bin directory almost",
    "start": "242400",
    "end": "248840"
  },
  {
    "text": "all of the CGI scripts are actually in the CGI directory which is protected um",
    "start": "248840",
    "end": "254519"
  },
  {
    "text": "in fact CGI bin only has one file in it and that was rtpd do",
    "start": "254519",
    "end": "260840"
  },
  {
    "text": "CGI which is a shell script that can be used to start and stop the real-time",
    "start": "260840",
    "end": "266639"
  },
  {
    "text": "transport protocol Damon so for example if you want wanted to stop the RTP Damon",
    "start": "266639",
    "end": "272400"
  },
  {
    "text": "you would simply send a request to rtpd CGI and in your query string you specify",
    "start": "272400",
    "end": "277720"
  },
  {
    "text": "action equals stop to stop the service the problem is the way they handle this query string that you provide is they",
    "start": "277720",
    "end": "284919"
  },
  {
    "text": "replace all ampersands with spaces and then eval the result so they're literally executing in a shell whatever",
    "start": "284919",
    "end": "291560"
  },
  {
    "text": "you put in your query string and not only that it runs as root",
    "start": "291560",
    "end": "298440"
  },
  {
    "text": "so you can do something like this this and it reboots the",
    "start": "298440",
    "end": "303320"
  },
  {
    "text": "device and I actually had a hard time categorizing this because it's not even command injection we're not injecting",
    "start": "304600",
    "end": "310960"
  },
  {
    "text": "anything it's just running whatever we give it um so I've dubbed this the Ron Burgundy because it will literally",
    "start": "310960",
    "end": "317360"
  },
  {
    "text": "execute whatever you put in your query string not only will it execute what you",
    "start": "317360",
    "end": "324120"
  },
  {
    "text": "put in your query string but it'll send you the response back to your browser so you can do something like",
    "start": "324120",
    "end": "329880"
  },
  {
    "text": "this this particular command will Echo out the admin password you get that sent back to your browser and so you now have",
    "start": "329880",
    "end": "335280"
  },
  {
    "text": "the admin password and access to the video feed and so you're not only root you're also",
    "start": "335280",
    "end": "341319"
  },
  {
    "text": "admin now as it turns out dlink like many vendors really likes to reuse code",
    "start": "341919",
    "end": "347479"
  },
  {
    "start": "343000",
    "end": "415000"
  },
  {
    "text": "and so this Pro popped up in a lot of their products but it didn't just affect dlink because it was also used by",
    "start": "347479",
    "end": "354800"
  },
  {
    "text": "trendnet and several other off-brand devices as well um and due to the fact",
    "start": "354800",
    "end": "362360"
  },
  {
    "text": "that there is so much reuse of this code through within vendors and throughout different vendors um it turns out",
    "start": "362360",
    "end": "369039"
  },
  {
    "text": "there's quite a few of them already publicly accessible in indexed by show in for",
    "start": "369039",
    "end": "374360"
  },
  {
    "text": "you um now this vulnerability might sound familiar to some people and that's",
    "start": "374360",
    "end": "380479"
  },
  {
    "text": "because it probably is uh of course after my talk got accepted someone put a cve out for this bug so it's technically",
    "start": "380479",
    "end": "387840"
  },
  {
    "text": "not an oday anymore um however the cve only addressed dlink devices um it did",
    "start": "387840",
    "end": "394039"
  },
  {
    "text": "not mention any of the other vendors affected and the truth is even if every single vendor put out a firmware update",
    "start": "394039",
    "end": "400160"
  },
  {
    "text": "fixing this today everyone would still be vulnerable like 3 years from now because no one updates firmware or even",
    "start": "400160",
    "end": "405440"
  },
  {
    "text": "knows what it is half the time so I expect this bug even though it's technically not a no day to be quite",
    "start": "405440",
    "end": "410639"
  },
  {
    "text": "useful for some time to come so I said okay dlink is an easy",
    "start": "410639",
    "end": "415919"
  },
  {
    "start": "415000",
    "end": "479000"
  },
  {
    "text": "target as I mentioned that's why I picked them let's move on to perhaps a more reputable vendor like",
    "start": "415919",
    "end": "421680"
  },
  {
    "text": "Cisco um The Cisco PVC 2300 is um kind of a mid-range business",
    "start": "421680",
    "end": "428199"
  },
  {
    "text": "IP camera runs about $500 um now it too has a web",
    "start": "428199",
    "end": "434800"
  },
  {
    "text": "server and it enforces authentication by using HT password files which most",
    "start": "434800",
    "end": "440360"
  },
  {
    "text": "people are probably already familiar with um so basically you put an HT password file or more specifically a Sim",
    "start": "440360",
    "end": "446800"
  },
  {
    "text": "link to a centralized HT password file uh in every directory that you want to",
    "start": "446800",
    "end": "452240"
  },
  {
    "text": "be password protected so looking through the firmware every single directory in the web interface had a HD password file",
    "start": "452240",
    "end": "459680"
  },
  {
    "text": "except one um the oamp directory did not have",
    "start": "459680",
    "end": "465159"
  },
  {
    "text": "any HD password file what it had was a bunch of XML files that were actually",
    "start": "465159",
    "end": "470319"
  },
  {
    "text": "Sim links to this o. CGI binary so I said okay well let's let's",
    "start": "470319",
    "end": "476280"
  },
  {
    "text": "look at what this amp. CGI thing does and as turns out it implements kind of",
    "start": "476280",
    "end": "481360"
  },
  {
    "start": "479000",
    "end": "539000"
  },
  {
    "text": "its own little mini API that's totally separate from the rest of everything",
    "start": "481360",
    "end": "487159"
  },
  {
    "text": "else running in the web interface um so it expects you when you make a request to it to specify an action and this",
    "start": "487159",
    "end": "494240"
  },
  {
    "text": "action you can specify can be one of many different things including download configuration",
    "start": "494240",
    "end": "499520"
  },
  {
    "text": "file update firmware and many others but they weren't completely stupid we'll get",
    "start": "499520",
    "end": "505720"
  },
  {
    "text": "to the stupid stuff later but they weren't completely stupid um because what they do is before executing an",
    "start": "505720",
    "end": "511720"
  },
  {
    "text": "action they check to make sure that you've also provided a valid session",
    "start": "511720",
    "end": "516959"
  },
  {
    "text": "ID if you have not provided a valid session ID the only action it lets you run is the login action I said okay well",
    "start": "516959",
    "end": "525320"
  },
  {
    "text": "this in itself is interesting because they're implementing authentication that's totally separate from the",
    "start": "525320",
    "end": "530760"
  },
  {
    "text": "authentication used everywhere else in the interface so I started looking at how they actually handle this login",
    "start": "530760",
    "end": "538279"
  },
  {
    "text": "action um they expect you to specify a username and a password all right so no",
    "start": "538279",
    "end": "544399"
  },
  {
    "text": "surprises there they then make two calls to this Pro geter function now at this",
    "start": "544399",
    "end": "551120"
  },
  {
    "text": "point I have no idea what Pro geter does presumably it gets a string of some sort",
    "start": "551120",
    "end": "556440"
  },
  {
    "text": "but I do know that on the first call to this function they pass it two strings oamp and L1 user and on the second call",
    "start": "556440",
    "end": "565279"
  },
  {
    "text": "they pass oamp and L1 password now the value return for L1 user is then",
    "start": "565279",
    "end": "570839"
  },
  {
    "text": "compared against the username that you provided and the value return for L1 password is compared against the",
    "start": "570839",
    "end": "577120"
  },
  {
    "text": "password you provided so presumably this L1 user and L1 password whatever their values are are the correct login for",
    "start": "577120",
    "end": "584519"
  },
  {
    "text": "this oamp interface now the only other place I could find in the firmware that actually referenced L1 user and L1",
    "start": "584519",
    "end": "591399"
  },
  {
    "text": "password was in the configuration file these values are hardcoded in the",
    "start": "591399",
    "end": "596480"
  },
  {
    "text": "devices running config under the oamp section of the configuration file uh you",
    "start": "596480",
    "end": "601600"
  },
  {
    "text": "can see that L1 user is set to the string L1 admin and L1 password is set",
    "start": "601600",
    "end": "606839"
  },
  {
    "text": "to the string l151 and this is a real problem because",
    "start": "606839",
    "end": "612760"
  },
  {
    "text": "this whole oamp interface and these hardcoded accounts are completely undocumented so no one knows they're",
    "start": "612760",
    "end": "618839"
  },
  {
    "text": "there except for people who bother to look at the firmware which of course an admin is never going to do that and even",
    "start": "618839",
    "end": "623959"
  },
  {
    "text": "if an admin knew that these were here there's no way for the admin to change this there's no interface for the admin",
    "start": "623959",
    "end": "629480"
  },
  {
    "text": "to go in and change these values and the problem with having hardcoded secret",
    "start": "629480",
    "end": "635839"
  },
  {
    "text": "passwords in your system and back doors is that they don't stay secrets for long",
    "start": "635839",
    "end": "642959"
  },
  {
    "text": "right so we can use these these backd door accounts uh to exercise the login",
    "start": "642959",
    "end": "649360"
  },
  {
    "text": "action and sure enough we get back a session ID now as long as we send the",
    "start": "649360",
    "end": "654880"
  },
  {
    "text": "session ID along with all of our other requests we can invoke any of the other actions supported by o. CGI including",
    "start": "654880",
    "end": "663320"
  },
  {
    "text": "download configuration file and this gives us back what appears to be base 64 encoded data the problem",
    "start": "663320",
    "end": "670880"
  },
  {
    "text": "is if you try to base 64 decode this no working um you just get a bunch of junk",
    "start": "670880",
    "end": "677760"
  },
  {
    "text": "uh the reason for that becomes readily apparent when you look at the actual encode 64 function in the binary itself",
    "start": "677760",
    "end": "685200"
  },
  {
    "text": "they are doing B 64 encoding but they're using a non-standard B6 4 key string",
    "start": "685200",
    "end": "691639"
  },
  {
    "text": "luckily um it's very easy in Python to substitute the standard Bic C4 key",
    "start": "691639",
    "end": "697440"
  },
  {
    "text": "string in python's um B 64 module with a custom key string like this and so with",
    "start": "697440",
    "end": "703079"
  },
  {
    "text": "a couple lines of python we can easily decode the config which gives us plain Tex admin creds which lets me see your",
    "start": "703079",
    "end": "710120"
  },
  {
    "text": "server room now the problem with viewing someone's server room is it's really",
    "start": "710120",
    "end": "715839"
  },
  {
    "text": "exciting for like 10 seconds and then you're like holy this is boring",
    "start": "715839",
    "end": "721240"
  },
  {
    "text": "so I went back and started looking at some more code cuz that's more exciting um now the load firmware action",
    "start": "722720",
    "end": "730959"
  },
  {
    "start": "727000",
    "end": "778000"
  },
  {
    "text": "is one of the other actions you can invoke and it's actually very interesting because instead of uploading",
    "start": "730959",
    "end": "736199"
  },
  {
    "text": "a firmware file to the device you specify a URL and then the device goes",
    "start": "736199",
    "end": "741360"
  },
  {
    "text": "to that URL downloads presumably the firmware and then flashes it the problem",
    "start": "741360",
    "end": "746680"
  },
  {
    "text": "is that URL that you specify is shoved into a command line string that's ultimately passed to lib C's system and",
    "start": "746680",
    "end": "753880"
  },
  {
    "text": "hopefully everyone here knows that taking unfiltered users supplied content and passing it to system is bad you",
    "start": "753880",
    "end": "761199"
  },
  {
    "text": "don't do it so we can easily do command injection",
    "start": "761199",
    "end": "766800"
  },
  {
    "text": "through this parameter um just putting semicolon reboot semicolon somewhere in your url reboots the machine and of",
    "start": "766800",
    "end": "773440"
  },
  {
    "text": "course we can run uh whatever command we want at this point um this also effects",
    "start": "773440",
    "end": "779560"
  },
  {
    "start": "778000",
    "end": "815000"
  },
  {
    "text": "the wvc 2300 um it's basically the same camera but with antennas and there are hundreds of these",
    "start": "779560",
    "end": "786639"
  },
  {
    "text": "cameras already out there online in hotels obviously server rooms and",
    "start": "786639",
    "end": "792800"
  },
  {
    "text": "engineering companies who design things for the International Space Station I'm",
    "start": "792800",
    "end": "798040"
  },
  {
    "text": "told so I said okay clearly Dink and Cisco are doing it wrong in their",
    "start": "798040",
    "end": "803279"
  },
  {
    "text": "defense though you know they're not really camera companies they they don't do cameras cameras isn't really their",
    "start": "803279",
    "end": "808480"
  },
  {
    "text": "their focus so let's look at someone who is a camera company it's their bread and butter hopefully they know how to do it",
    "start": "808480",
    "end": "814440"
  },
  {
    "text": "right so I picked on IQ Envision partially because they make",
    "start": "814440",
    "end": "821040"
  },
  {
    "start": "815000",
    "end": "891000"
  },
  {
    "text": "some really expensive highdefinition cameras um the IQ 8832n for example will",
    "start": "821040",
    "end": "826560"
  },
  {
    "text": "run you over $1,000 a piece so it was certainly not cheap um the main reason though is that these are the guys who",
    "start": "826560",
    "end": "832920"
  },
  {
    "text": "make the cameras that are used in the business complex where I work so it was a little more personal and what you get",
    "start": "832920",
    "end": "840040"
  },
  {
    "text": "for $1,000 per camera is a highdefinition video feed unauthenticated open to the World by",
    "start": "840040",
    "end": "846920"
  },
  {
    "text": "default now admittedly this is a configurable option you can require authentication",
    "start": "846920",
    "end": "854279"
  },
  {
    "text": "this is the default setting but you can go in as an admin and change that now guess how many admins connected their",
    "start": "854279",
    "end": "860639"
  },
  {
    "text": "cameras to the internet without changing that default setting almost all of them um so this is",
    "start": "860639",
    "end": "868079"
  },
  {
    "text": "really interesting but it's not really that interesting from a um security standpoint right it's like okay they",
    "start": "868079",
    "end": "874560"
  },
  {
    "text": "don't know how to secure their stuff um big deal I but I wanted some actual vulnerabilities so I said well let's",
    "start": "874560",
    "end": "880720"
  },
  {
    "text": "look at getting into the admin area which is password protected and which thankfully most admins had the presence",
    "start": "880720",
    "end": "887360"
  },
  {
    "text": "of mind to change the default settings for um so to do this I started looking",
    "start": "887360",
    "end": "893240"
  },
  {
    "start": "891000",
    "end": "1028000"
  },
  {
    "text": "at what else can I get to without authentication and one of the few pages",
    "start": "893240",
    "end": "898560"
  },
  {
    "text": "that you can get get to without authentication is oid table. CGI and the output from oid table really",
    "start": "898560",
    "end": "905240"
  },
  {
    "text": "isn't that interesting it's a bunch of uh technical camera settings like focus and all that other stuff um there's",
    "start": "905240",
    "end": "911720"
  },
  {
    "text": "nothing really sensitive in here like usernames and passwords what's more interesting is the code behind oid",
    "start": "911720",
    "end": "918839"
  },
  {
    "text": "table um because if you if you disassemble this CGI binary you'll see",
    "start": "918839",
    "end": "924279"
  },
  {
    "text": "that it looks to see if you've specified a grep parameter in your query string",
    "start": "924279",
    "end": "929639"
  },
  {
    "text": "when you send your get request to it now if you have it checks to make sure the",
    "start": "929639",
    "end": "935199"
  },
  {
    "text": "value you provided is less than 32 bytes long and as long as you meet that requirement it'll take that string shove",
    "start": "935199",
    "end": "941800"
  },
  {
    "text": "it into a GP command and pass it to poop at which case I face palmed did my",
    "start": "941800",
    "end": "948160"
  },
  {
    "text": "best Kim Jong eel impression and did some command",
    "start": "948160",
    "end": "953680"
  },
  {
    "text": "injection um and again just like with a dlink you see I can run a a PS command",
    "start": "953680",
    "end": "959040"
  },
  {
    "text": "and I get the output sent back to my browser so I have a built-in unauthenticated web root shell already",
    "start": "959040",
    "end": "965279"
  },
  {
    "text": "on the device um it's also worth noting that while process listings are interesting um these cameras already",
    "start": "965279",
    "end": "972000"
  },
  {
    "text": "have netcat installed on them with the- e option enabled so I'm sure most people",
    "start": "972000",
    "end": "977199"
  },
  {
    "text": "here can think of some more interesting commands to run than a process listing um but my main goal in all this was",
    "start": "977199",
    "end": "984279"
  },
  {
    "text": "really to get to the admin area recall so I said well how can I do that well we can also use this bug to retrieve the",
    "start": "984279",
    "end": "990800"
  },
  {
    "text": "contents of arbitrary files um now the Etsy priv password file is what contains",
    "start": "990800",
    "end": "996360"
  },
  {
    "text": "the actual admin credentials it's not an Etsy password it's Etsy priv password um",
    "start": "996360",
    "end": "1001920"
  },
  {
    "text": "so we can we can pull back the contents of that file um and as you can see here it has the username root and the an",
    "start": "1001920",
    "end": "1009440"
  },
  {
    "text": "encrypted password so at this point we have two options you can try and decrypt the password or if that doesn't work I",
    "start": "1009440",
    "end": "1016079"
  },
  {
    "text": "mean screw it we're root we'll just overwrite the file with whatever we want um in either case we get access to the",
    "start": "1016079",
    "end": "1022120"
  },
  {
    "text": "admin area and again we're both root and admin on these cameras",
    "start": "1022120",
    "end": "1027160"
  },
  {
    "text": "um these bugs affect most of IQ IND division's product line uh including",
    "start": "1027160",
    "end": "1032360"
  },
  {
    "text": "their three series cameras the seven series The Sentinel series The Alliance Pro Alliance MX and Alliance miniseries",
    "start": "1032360",
    "end": "1039038"
  },
  {
    "text": "I won't read off all the models it's I'll be up here forever um and there are plenty of these",
    "start": "1039039",
    "end": "1046000"
  },
  {
    "text": "out online which is a little distressing consider considering that they're known to be deployed by Schools Police Banks",
    "start": "1046000",
    "end": "1052480"
  },
  {
    "text": "governments prisons casinos utility companies financial consulting firms and DHL to name a few um so have fun with",
    "start": "1052480",
    "end": "1061520"
  },
  {
    "text": "that um by far the most expensive camera I looked at though um was the",
    "start": "1061520",
    "end": "1068320"
  },
  {
    "start": "1062000",
    "end": "1248000"
  },
  {
    "text": "n572 from 3s Vision um now this one has a list price of contact us which is how",
    "start": "1068320",
    "end": "1074720"
  },
  {
    "text": "I know I can't afford it um and I ran into a bit of a problem with",
    "start": "1074720",
    "end": "1081000"
  },
  {
    "text": "this particular camera at little hiccup at first because for all the other cameras I had been able to just go to",
    "start": "1081000",
    "end": "1087799"
  },
  {
    "text": "the vendor website pull down a firmware update whatever the latest firmware update was and start analyzing the code",
    "start": "1087799",
    "end": "1093760"
  },
  {
    "text": "in the firmware for vulnerability so I really didn't have to buy the device in order to at least do initial testing and",
    "start": "1093760",
    "end": "1099480"
  },
  {
    "text": "things like that um when I went to download the firmware for this camera it gave me a little JavaScript",
    "start": "1099480",
    "end": "1105440"
  },
  {
    "text": "pop-up box on the vendor web page saying ah we want your password so I immediately tried all the most common",
    "start": "1105440",
    "end": "1111280"
  },
  {
    "text": "passwords love sex god of course none of those worked um what ended up working",
    "start": "1111280",
    "end": "1117159"
  },
  {
    "text": "though was tab equals 4 because if you look at the JavaScript",
    "start": "1117159",
    "end": "1122679"
  },
  {
    "text": "um it sends your password back to the server I don't even need to explain this",
    "start": "1122679",
    "end": "1129080"
  },
  {
    "text": "to you guys this great um and as long as you get the password right it just redirects you to your current URL with",
    "start": "1129080",
    "end": "1135640"
  },
  {
    "text": "ENT tab equals 4 appended on to the end of it and I said well gez since I'm literate and all I",
    "start": "1135640",
    "end": "1141440"
  },
  {
    "text": "bet I can do that myself and sure enough I get the download [Applause]",
    "start": "1141440",
    "end": "1149460"
  },
  {
    "text": "page so this does not bode well for the security of their systems nor does the fact that they're",
    "start": "1151440",
    "end": "1158480"
  },
  {
    "text": "using a custom web server uh it's rather innocuously named httpd um but if you actually look just",
    "start": "1158480",
    "end": "1165360"
  },
  {
    "text": "look at the strings in this binary it's very clear that this is very custom to their firmware uh it's either something",
    "start": "1165360",
    "end": "1171640"
  },
  {
    "text": "that they rolled themselves from scratch or something that's been very heavily modified by them um so I said well if",
    "start": "1171640",
    "end": "1178240"
  },
  {
    "text": "this this looks really custom I really need to start looking at how their web server handles authentication um now I",
    "start": "1178240",
    "end": "1185200"
  },
  {
    "text": "know that the cameras use basic HT HTTP basic authentication um so I know that",
    "start": "1185200",
    "end": "1190720"
  },
  {
    "text": "they're going to be doing some Bas 64 decoding um because if you're not familiar with um HTTP basic o your",
    "start": "1190720",
    "end": "1196840"
  },
  {
    "text": "username and password are basically concat ated and then b64 encoded so I started looking through the code for",
    "start": "1196840",
    "end": "1203240"
  },
  {
    "text": "cross references to b64 decode um and so what they do when they when they decode your password is they",
    "start": "1203240",
    "end": "1209679"
  },
  {
    "text": "pass it to b64 decode all right that's fine that's they're decoding your stuff they then do two string comparisons",
    "start": "1209679",
    "end": "1217000"
  },
  {
    "text": "against a hard-coded string 3s admin and another hardcoded string 279",
    "start": "1217000",
    "end": "1222520"
  },
  {
    "text": "8833 and I saw this and I thought there is no way you were dumb enough to hardc code stuff into your HTTP server these",
    "start": "1222520",
    "end": "1230039"
  },
  {
    "text": "can't possibly be creds but they were and they worked",
    "start": "1230039",
    "end": "1235480"
  },
  {
    "text": "great so you can access any 3s vision camera become admin with these backdoor",
    "start": "1237360",
    "end": "1242679"
  },
  {
    "text": "creds and that gives you access to video feeds of cash machines Taiwanese",
    "start": "1242679",
    "end": "1249280"
  },
  {
    "start": "1248000",
    "end": "1354000"
  },
  {
    "text": "checkpoints and Russian industrial basements at least that's what I assume that",
    "start": "1249280",
    "end": "1254880"
  },
  {
    "text": "is um now again looking at video feed is really boring so I wanted root um",
    "start": "1254880",
    "end": "1262840"
  },
  {
    "text": "luckily their code is littered especially once you're logged in as admin your attack surface is wide open",
    "start": "1262840",
    "end": "1268320"
  },
  {
    "text": "um and their code is just littered with unsafe function calls is absolutely horrible um probably the best example of",
    "start": "1268320",
    "end": "1275720"
  },
  {
    "text": "this is their um records. CGI Handler uh now not all of the cameras but many of",
    "start": "1275720",
    "end": "1281919"
  },
  {
    "text": "their cameras support um local storage so you can plug in say an SD card to the",
    "start": "1281919",
    "end": "1287039"
  },
  {
    "text": "camera and it'll save files off to the SD card for you so they also provide a",
    "start": "1287039",
    "end": "1293520"
  },
  {
    "text": "way to do some basic file management from the admin interface um and this is done through the records. CGI page now",
    "start": "1293520",
    "end": "1300840"
  },
  {
    "text": "records. CGI is not a physical CGI page sitting on disk um what happens is when",
    "start": "1300840",
    "end": "1307320"
  },
  {
    "text": "the web server sees that you requested records. CGI and it it invokes the do records function",
    "start": "1307320",
    "end": "1313480"
  },
  {
    "text": "Handler so the do records function Handler checks to see what action you",
    "start": "1313480",
    "end": "1319320"
  },
  {
    "text": "uh provided so for example if you wanted to delete a file you can tell it action equals remove now if you're deleting a",
    "start": "1319320",
    "end": "1326039"
  },
  {
    "text": "file you also have to tell it which file you want deleted so it checks to make sure that you specified a file name as",
    "start": "1326039",
    "end": "1332799"
  },
  {
    "text": "well that file name is then shoved into an RM command that is passed to",
    "start": "1332799",
    "end": "1338600"
  },
  {
    "text": "system and I think everyone knows where this is going",
    "start": "1338600",
    "end": "1343600"
  },
  {
    "text": "yeah setting file name equals backtick reboot backtick makes it not respond to",
    "start": "1343720",
    "end": "1348960"
  },
  {
    "text": "pings anymore um now this affects almost all",
    "start": "1348960",
    "end": "1355039"
  },
  {
    "start": "1354000",
    "end": "1474000"
  },
  {
    "text": "of 3s vision's product line not only the cameras but also their video servers because they use the same web server as",
    "start": "1355039",
    "end": "1361480"
  },
  {
    "text": "well um and after a bit of research I found that another company named A- linking used the same code in their",
    "start": "1361480",
    "end": "1369039"
  },
  {
    "text": "cameras as well now A- linking went through and changed the hard-coded creds to something else so they still have all",
    "start": "1369039",
    "end": "1376000"
  },
  {
    "text": "the aink and cameras have the same hard-coded creds they're just different from 3s Visions hard-coded creds and",
    "start": "1376000",
    "end": "1381039"
  },
  {
    "text": "I'll leave finding those as an exercise to the reader but they're there and they're easy to find um now these cameras are",
    "start": "1381039",
    "end": "1389240"
  },
  {
    "text": "particularly interesting um due to their their cost there's not a whole lot of them you know when compared to some of",
    "start": "1389240",
    "end": "1395000"
  },
  {
    "text": "the other devices um but considering that these cameras are known to be deployed in foreign military energy and",
    "start": "1395000",
    "end": "1401960"
  },
  {
    "text": "Industrial facilities they're particularly interesting um so all of you who are already like looking these",
    "start": "1401960",
    "end": "1407559"
  },
  {
    "text": "up on showen you know be careful don't blame me when the Chinese military shows up and gets pissed at you um so what all",
    "start": "1407559",
    "end": "1415120"
  },
  {
    "text": "this what this all boils down to is I'm in your network I can see you and I'm",
    "start": "1415120",
    "end": "1422360"
  },
  {
    "text": "root which is not a bad position for any attacker to be in most of these cameras",
    "start": "1422360",
    "end": "1427679"
  },
  {
    "text": "the way that they're deployed they're actually connected to the internal Network so if you can remotely access",
    "start": "1427679",
    "end": "1433320"
  },
  {
    "text": "them and break into them get root on them you now have a linux-based arm machine sitting inside their Network",
    "start": "1433320",
    "end": "1440559"
  },
  {
    "text": "that you can then use to go after anything else in the network um but I wanted to kind of take a step back from",
    "start": "1440559",
    "end": "1447200"
  },
  {
    "text": "that and say okay that's great and all but what can I do to the camera itself",
    "start": "1447200",
    "end": "1452960"
  },
  {
    "text": "all right I've got root on the camera this is awesome but if you go up to an average admin and say I got root on your",
    "start": "1452960",
    "end": "1458640"
  },
  {
    "text": "camera he's like I don't even know what that means right what the hell you talking about",
    "start": "1458640",
    "end": "1464960"
  },
  {
    "text": "so I wanted to do something a little more interesting something that would actually demonstrate what you can do so",
    "start": "1464960",
    "end": "1472120"
  },
  {
    "text": "skipping slides I wanted to take say a video stream that looks like this and",
    "start": "1472120",
    "end": "1477440"
  },
  {
    "start": "1474000",
    "end": "1601000"
  },
  {
    "text": "instead make it look like this and this is kind of the Classic Hollywood hack right you've got you got",
    "start": "1477440",
    "end": "1483960"
  },
  {
    "text": "to get into the facility that's guarded and it's got security cameras so the token hacker of the group has to break",
    "start": "1483960",
    "end": "1489799"
  },
  {
    "text": "into this camera system and make it look like no one's there when really they are um so to demonstrate this and just",
    "start": "1489799",
    "end": "1497520"
  },
  {
    "text": "do a little proof of concept um I picked a trendnet IP 410 WN now I picked this",
    "start": "1497520",
    "end": "1504720"
  },
  {
    "text": "camera for a couple reasons first of all I can afford it which is a big plus um",
    "start": "1504720",
    "end": "1510520"
  },
  {
    "text": "but secondly it has a backdoor account that can access certain restricted",
    "start": "1510520",
    "end": "1516039"
  },
  {
    "text": "files which have very obvious command injection bugs which can be trivially",
    "start": "1516039",
    "end": "1521320"
  },
  {
    "text": "exploited by anyone who can send packets to the camera in other words it's the",
    "start": "1521320",
    "end": "1526360"
  },
  {
    "text": "same stuff I've been up here talking about the whole time just on a slightly less expensive camera um now as it turns out this",
    "start": "1526360",
    "end": "1533679"
  },
  {
    "text": "particular bug is also not a no day um it was actually first published in 2011",
    "start": "1533679",
    "end": "1542039"
  },
  {
    "text": "the problem is I didn't know about it and neither did anyone else because they",
    "start": "1542039",
    "end": "1547120"
  },
  {
    "text": "when they published this they didn't mention any specific devices that were affected they didn't mention any specific firmware versions that were",
    "start": "1547120",
    "end": "1553600"
  },
  {
    "text": "affected so if you went and Googled for you know TV IP 410 W vulnerabilities or",
    "start": "1553600",
    "end": "1559640"
  },
  {
    "text": "exploits you didn't find anything and the problem with not providing this information when you do things like",
    "start": "1559640",
    "end": "1565799"
  },
  {
    "text": "vulnerability reports is it's difficult for other people in the security Community to validate your claims first",
    "start": "1565799",
    "end": "1573559"
  },
  {
    "text": "of all but it also makes it impossible for vendors and customers to determine",
    "start": "1573559",
    "end": "1579559"
  },
  {
    "text": "what models need to be fixed and whether I'm actually vulnerable or not so the easiest solution here is to just ignore",
    "start": "1579559",
    "end": "1586240"
  },
  {
    "text": "it and hope it goes away which is what everyone did so these devices even though this is a known bug since 2011 have been shipping",
    "start": "1586240",
    "end": "1592880"
  },
  {
    "text": "with these bugs ever since oh yeah there's a lot of them out there",
    "start": "1592880",
    "end": "1599039"
  },
  {
    "text": "too so let's say hypothetically this is our admin's video feed we want to make",
    "start": "1599399",
    "end": "1604919"
  },
  {
    "text": "sure it stays that way right um so for purposes of demonstration we'll assume that the admin is browsing the video",
    "start": "1604919",
    "end": "1611440"
  },
  {
    "text": "feed um through the web interface uh rather than maybe through a custom service or rtpd or something like that",
    "start": "1611440",
    "end": "1619399"
  },
  {
    "text": "so if you're on this particular camera when you're browsing um excuse me when",
    "start": "1619399",
    "end": "1624600"
  },
  {
    "text": "you're viewing the video feed through your browser the process responsible for streaming images to your browser is MJ",
    "start": "1624600",
    "end": "1632240"
  },
  {
    "text": "peg. CGI so with command injection and the ability to see the output from our",
    "start": "1632240",
    "end": "1638159"
  },
  {
    "text": "commands that we're injecting we can run process lists and see what processes are running and then we can just kill off",
    "start": "1638159",
    "end": "1644880"
  },
  {
    "text": "all the MJ peg. CGI processes and this actually has the effect of temporarily freezing the admin's video feed because",
    "start": "1644880",
    "end": "1653559"
  },
  {
    "text": "his browser is only going to show him whatever the last image it received was and he's no longer getting any more images but we don't want to stop there",
    "start": "1653559",
    "end": "1660840"
  },
  {
    "text": "because if the admin refreshes his browser or navigates away from the page and comes back he starts up a new stream",
    "start": "1660840",
    "end": "1666559"
  },
  {
    "text": "and then he's going to see the live video feed so what we also want to do is replace MJ peg. CGI and this does not",
    "start": "1666559",
    "end": "1673159"
  },
  {
    "text": "have to be difficult A two-line bash script will suffice particularly in a pinch all you have to do is replace this",
    "start": "1673159",
    "end": "1679519"
  },
  {
    "text": "CGI page on disk um with a bass grip that Echoes out some basic headers to make the browser happy and then cats out",
    "start": "1679519",
    "end": "1687080"
  },
  {
    "text": "the contents of its static jpeg image presumably this jpeg is a picture of um",
    "start": "1687080",
    "end": "1693600"
  },
  {
    "text": "the empty uh elevator but you know it can be goatsy or whatever you",
    "start": "1693600",
    "end": "1699559"
  },
  {
    "text": "want so while the admin will all now always see this no matter what is",
    "start": "1699559",
    "end": "1706200"
  },
  {
    "start": "1702000",
    "end": "2015000"
  },
  {
    "text": "actually going on in the elevator um so this is actually a lot more fun to see in a live",
    "start": "1706200",
    "end": "1712679"
  },
  {
    "text": "demo so if the demo Gods will work with me today um all right so I have my camera",
    "start": "1712679",
    "end": "1720600"
  },
  {
    "text": "guarding my precious beer here so you can see if I try and take it whoever's watching will",
    "start": "1720600",
    "end": "1725960"
  },
  {
    "text": "know um however I have a little exploit script written up um and this exploit",
    "start": "1725960",
    "end": "1732760"
  },
  {
    "text": "script does a couple of things um first of all it's going to kill the admin's video feed it's going to repl the MJ",
    "start": "1732760",
    "end": "1738600"
  },
  {
    "text": "pig. CGI just like we showed it's also going to give me the administrative credentials to the camera and set up a",
    "start": "1738600",
    "end": "1745760"
  },
  {
    "text": "secret URL so that I can still see the live video feed even though the admins is frozen",
    "start": "1745760",
    "end": "1752159"
  },
  {
    "text": "permanently so sending exploit okay so you can see here it gave",
    "start": "1755080",
    "end": "1762399"
  },
  {
    "text": "me back um user credentials uh the login is admin and secure cam1 1234 it also",
    "start": "1762399",
    "end": "1768320"
  },
  {
    "text": "tells me what URL it's set up so that I can view the real video feed um so if I go over to my hacker",
    "start": "1768320",
    "end": "1776080"
  },
  {
    "text": "browser here see if I can type",
    "start": "1776080",
    "end": "1783518"
  },
  {
    "text": "this um I can see what's going on so if I try and take this I know",
    "start": "1783799",
    "end": "1791320"
  },
  {
    "text": "that but the admin doesn't so that's the demo",
    "start": "1791320",
    "end": "1800039"
  },
  {
    "text": "[Applause]",
    "start": "1805330",
    "end": "1808740"
  },
  {
    "text": "so a couple closing thoughts I'd like to leave you with first of all this clearly",
    "start": "1811080",
    "end": "1816679"
  },
  {
    "text": "is not an all-encompassing list of bugs in security cameras not by a long shot",
    "start": "1816679",
    "end": "1822799"
  },
  {
    "text": "um so there's lots more of these to be found if you want to go look for them yourself and as you've seen most of them",
    "start": "1822799",
    "end": "1828080"
  },
  {
    "text": "are epically trivial uh to exploit um another thing I'd like to",
    "start": "1828080",
    "end": "1833640"
  },
  {
    "text": "point out is that almost all of these cameras will reveal their model name",
    "start": "1833640",
    "end": "1839640"
  },
  {
    "text": "even if you're not authenticated e either on the login page or the login prompt depending on on how they're doing",
    "start": "1839640",
    "end": "1844960"
  },
  {
    "text": "authentication it'll tell you what its model number is so if I is an attacker",
    "start": "1844960",
    "end": "1850440"
  },
  {
    "text": "know the model number even if I know nothing else about this camera I can go on Google I can Google the model number",
    "start": "1850440",
    "end": "1855720"
  },
  {
    "text": "go to the vendor's web page download the firmware you know maybe have to have you know tab equals 4 um get the firmware",
    "start": "1855720",
    "end": "1862639"
  },
  {
    "text": "and start analyzing it for vulnerabilities without ever even having to buy the device uh and this is exactly what I did",
    "start": "1862639",
    "end": "1869639"
  },
  {
    "text": "with all of these cameras I was able to find the vulnerabilities and write working exploits without ever having to",
    "start": "1869639",
    "end": "1874840"
  },
  {
    "text": "buy a single camera it was all done um with um firmware analysis uh basically",
    "start": "1874840",
    "end": "1882000"
  },
  {
    "text": "using binwalk to do firmware analysis and extraction and then using Ida and qmu for disassembly uh and emulation if",
    "start": "1882000",
    "end": "1890000"
  },
  {
    "text": "necessary so with that um now I know when I open up for Q&A like half the",
    "start": "1890000",
    "end": "1896200"
  },
  {
    "text": "room always leaves so before you head out please fill out the surveys or swipe your badge for surveys or however that",
    "start": "1896200",
    "end": "1902519"
  },
  {
    "text": "works in the back um but with that I'll open up for any questions you guys might",
    "start": "1902519",
    "end": "1908559"
  },
  {
    "text": "have oh got one",
    "start": "1909760",
    "end": "1914240"
  },
  {
    "text": "no um so so there there were a lot more cameras that I looked at um I simply didn't I need like a 2-hour slot to talk",
    "start": "1919600",
    "end": "1926519"
  },
  {
    "text": "about all of them um I did not run into one that was actually well done and actually secure now with that said there",
    "start": "1926519",
    "end": "1932799"
  },
  {
    "text": "are a lot of larger vendors um that I simply didn't have the resources to look at um you know they don't put their",
    "start": "1932799",
    "end": "1939480"
  },
  {
    "text": "firmware up for free and I don't have the money to buy their cameras right um so I'm not saying there aren't secure",
    "start": "1939480",
    "end": "1945440"
  },
  {
    "text": "cameras out there but the ones I've looked at certainly not",
    "start": "1945440",
    "end": "1949840"
  },
  {
    "text": "anyone else",
    "start": "1951880",
    "end": "1955960"
  },
  {
    "text": "oh hey you have to speak up I can't can't hear you",
    "start": "1959880",
    "end": "1965398"
  },
  {
    "text": "ah so the easiest way to do that in this case would be like an animated gif which",
    "start": "1980279",
    "end": "1986279"
  },
  {
    "text": "is you know a really pretty hacky workaround um certainly this can be taken a lot farther yeah I mean you",
    "start": "1986279",
    "end": "1991760"
  },
  {
    "text": "could easily write your own CGI that really does feed a live video of whatever you want um I'm lazy though and",
    "start": "1991760",
    "end": "1999639"
  },
  {
    "text": "that was my demo um but you the concept's the same you know you're roote on these devices you can do whatever you",
    "start": "1999639",
    "end": "2005120"
  },
  {
    "text": "want yeah you could certainly do that",
    "start": "2005120",
    "end": "2009760"
  },
  {
    "text": "that it oh",
    "start": "2011200",
    "end": "2016519"
  }
]