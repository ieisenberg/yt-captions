[
  {
    "text": "hello everyone my name is Inu today I'm delighted to be here to talk to you about a novel attack service Java",
    "start": "2639",
    "end": "10400"
  },
  {
    "text": "authentication and authorization service J first of all let me introduce my team",
    "start": "10400",
    "end": "17480"
  },
  {
    "text": "the first one is Zang Le and the second one is giano and the last one is me we",
    "start": "17480",
    "end": "24160"
  },
  {
    "text": "are security Engineers from Alibaba Cloud then let me introduce the agenda",
    "start": "24160",
    "end": "30320"
  },
  {
    "text": "first I will introduce something about J then I will compare the previous",
    "start": "30320",
    "end": "36120"
  },
  {
    "text": "research with our new findings and next I will discuss the process of hunting",
    "start": "36120",
    "end": "41800"
  },
  {
    "text": "bugs in other Java libraries and then I will explore the impacts and differences",
    "start": "41800",
    "end": "48800"
  },
  {
    "text": "and finally I will conclude with takeaways let's move on to the first",
    "start": "48800",
    "end": "54600"
  },
  {
    "text": "section first you may wonder what is J J is a popular authentication and",
    "start": "54600",
    "end": "61559"
  },
  {
    "text": "authorization framework it supports authentication via username and password",
    "start": "61559",
    "end": "67640"
  },
  {
    "text": "L and coverus so how can we use J let's take a",
    "start": "67640",
    "end": "73759"
  },
  {
    "text": "look the main method of the sample ACN class performs the authentication if all",
    "start": "73759",
    "end": "80159"
  },
  {
    "text": "succeeds it will print the current subject the code for authenticating the",
    "start": "80159",
    "end": "85600"
  },
  {
    "text": "user includes Three Steps step one set set login",
    "start": "85600",
    "end": "91119"
  },
  {
    "text": "config the login config fail defines an entry named Sample and it's login config",
    "start": "91119",
    "end": "99119"
  },
  {
    "text": "step two instantiate a login contest there are two arguments the first one is",
    "start": "99119",
    "end": "105759"
  },
  {
    "text": "the entry name defined in the login config file sample and the second one is",
    "start": "105759",
    "end": "111520"
  },
  {
    "text": "a callback Handler step three call the login method",
    "start": "111520",
    "end": "116960"
  },
  {
    "text": "of the login contest to carry out the authentication process the program runs like this first",
    "start": "116960",
    "end": "125479"
  },
  {
    "text": "it prompts the user to enter a username and password and then it verifies them",
    "start": "125479",
    "end": "131400"
  },
  {
    "text": "if the verification is successful it will print authentication succeed along",
    "start": "131400",
    "end": "136959"
  },
  {
    "text": "with the current subject now let's use the sample code to",
    "start": "136959",
    "end": "142560"
  },
  {
    "text": "understand how J works first we need to understand the core classes and",
    "start": "142560",
    "end": "148360"
  },
  {
    "text": "interfaces of J the first one is subject it represents",
    "start": "148360",
    "end": "153560"
  },
  {
    "text": "information for an entity for example a person or a service the second one is",
    "start": "153560",
    "end": "159120"
  },
  {
    "text": "login contest it helps develop an application independent of the",
    "start": "159120",
    "end": "164200"
  },
  {
    "text": "underlying authenticating authentication technology and it consults a",
    "start": "164200",
    "end": "169319"
  },
  {
    "text": "configuration to determine the login modules the next one is login module it",
    "start": "169319",
    "end": "176800"
  },
  {
    "text": "imp it implements different Authentication techn technology for example ldap and cus the next one is",
    "start": "176800",
    "end": "185040"
  },
  {
    "text": "cack Handler it communicates with the user to obtain authentication info the",
    "start": "185040",
    "end": "191319"
  },
  {
    "text": "last one is callback the login module passes an array of callbacks to the cback Handler after understanding the",
    "start": "191319",
    "end": "199080"
  },
  {
    "text": "core classes and interfaces we can move on to the analysis of the sample code in",
    "start": "199080",
    "end": "205400"
  },
  {
    "text": "line two and three we specify the login config file URL by by setting the Java",
    "start": "205400",
    "end": "211040"
  },
  {
    "text": "system property Java security or login config the file structure is shown",
    "start": "211040",
    "end": "218560"
  },
  {
    "text": "here it begins with an entry named used by the application to refer to this",
    "start": "218560",
    "end": "224720"
  },
  {
    "text": "entry the content of the entry includes login module name flag and options the",
    "start": "224720",
    "end": "232159"
  },
  {
    "text": "login config file used in our code is shown here an entry named Sample is",
    "start": "232159",
    "end": "238280"
  },
  {
    "text": "defined and used by our sample code the entry",
    "start": "238280",
    "end": "243640"
  },
  {
    "text": "specifies that the login module to be used to do the user authentication is",
    "start": "243640",
    "end": "249280"
  },
  {
    "text": "sample login module and that this sample login module is required to success to",
    "start": "249280",
    "end": "255360"
  },
  {
    "text": "succeed in order for authentication to be considered successful the sample",
    "start": "255360",
    "end": "261320"
  },
  {
    "text": "login module succeeds only if the name and password Pro supplied by the user",
    "start": "261320",
    "end": "268040"
  },
  {
    "text": "are the one it it expect admin and admin one 123",
    "start": "268040",
    "end": "273880"
  },
  {
    "text": "namely in line four the developer instantiates a login contest and pass",
    "start": "273880",
    "end": "279479"
  },
  {
    "text": "two arguments the first argument is the name of the of the entry in the login",
    "start": "279479",
    "end": "285120"
  },
  {
    "text": "config file sample and the second one is a cack Handler it performs the user of",
    "start": "285120",
    "end": "292720"
  },
  {
    "text": "interaction and obtain authentication info from user which we will discuss",
    "start": "292720",
    "end": "298639"
  },
  {
    "text": "later specifically the instantiation process of login contest goes like this",
    "start": "298639",
    "end": "305800"
  },
  {
    "text": "first the sample code set login config URL and then it passes the entry name",
    "start": "305800",
    "end": "312520"
  },
  {
    "text": "and cack Handler to the login contest and then the login contest gets login",
    "start": "312520",
    "end": "318600"
  },
  {
    "text": "config URL and finally the login contest find login config specified by entry",
    "start": "318600",
    "end": "325000"
  },
  {
    "text": "named Sample in short we can say the sample code configure the login",
    "start": "325000",
    "end": "332840"
  },
  {
    "text": "contest once we have a login contest we can call it login method to carry out",
    "start": "332840",
    "end": "338840"
  },
  {
    "text": "the authentication process so let's move on to the login method first the login Contex",
    "start": "338840",
    "end": "346160"
  },
  {
    "text": "instantiates a new empathy subject which represents the user or service being",
    "start": "346160",
    "end": "353680"
  },
  {
    "text": "authenticated the the login contest constructs the login module configured",
    "start": "353680",
    "end": "359280"
  },
  {
    "text": "in the the login config file namely sample login module then the login contest calls the",
    "start": "359280",
    "end": "366599"
  },
  {
    "text": "initialized method of sample login module the login contest initialize",
    "start": "366599",
    "end": "371840"
  },
  {
    "text": "login module with empty subject callback Handler and options which are defined in",
    "start": "371840",
    "end": "378360"
  },
  {
    "text": "the login config file then the login contest calls the",
    "start": "378360",
    "end": "383440"
  },
  {
    "text": "login method of sample login module to carry out the authentication process the",
    "start": "383440",
    "end": "389160"
  },
  {
    "text": "sample login module will pass name callback and password callback to the handle method of callback Handler in",
    "start": "389160",
    "end": "397080"
  },
  {
    "text": "order to obtain username and password next let's move on to the",
    "start": "397080",
    "end": "403360"
  },
  {
    "text": "handle method of my callback Handler it will obtain username and password from",
    "start": "403360",
    "end": "409520"
  },
  {
    "text": "user through standard input and then return the username and",
    "start": "409520",
    "end": "415160"
  },
  {
    "text": "password and this is the diagram obtain username password and return return to",
    "start": "415160",
    "end": "421560"
  },
  {
    "text": "the login module and then the login module will will will check whether the",
    "start": "421560",
    "end": "427560"
  },
  {
    "text": "name and password are correct if true the the authentication is",
    "start": "427560",
    "end": "434160"
  },
  {
    "text": "successful finally if the authentication is successful the login contest will",
    "start": "434160",
    "end": "439639"
  },
  {
    "text": "call the commit method of sample login module to we call the commit method and",
    "start": "439639",
    "end": "447160"
  },
  {
    "text": "the sample login module will populate the subject with a principal representing the current",
    "start": "447160",
    "end": "453560"
  },
  {
    "text": "user and this is the complete process of login method of login contest consisting",
    "start": "453560",
    "end": "461319"
  },
  {
    "text": "of nine steps after authentication we can call",
    "start": "461319",
    "end": "466800"
  },
  {
    "text": "get subject method and utilize the subject now you have understood how to",
    "start": "466800",
    "end": "473199"
  },
  {
    "text": "use J and how it works J is a security framework",
    "start": "473199",
    "end": "480159"
  },
  {
    "text": "but if it is used improperly it can bring some security",
    "start": "480159",
    "end": "485800"
  },
  {
    "text": "risks here is an example cve 2023 25194 of kfka client when users can",
    "start": "485800",
    "end": "494120"
  },
  {
    "text": "control kfka connection stram they can trigger J injection which may further",
    "start": "494120",
    "end": "499440"
  },
  {
    "text": "lead to R first the attacker set up an Evo gndi server and then he passes an",
    "start": "499440",
    "end": "506960"
  },
  {
    "text": "EVO connection stream to the kovka client and then the cupka client will look up the Evo gmdi server and the",
    "start": "506960",
    "end": "514039"
  },
  {
    "text": "server returns some Evo payloads and finally the jvm is taken over by the",
    "start": "514039",
    "end": "521200"
  },
  {
    "text": "attacker here is the part this program acts as a kovka client using the",
    "start": "521200",
    "end": "527399"
  },
  {
    "text": "connection string provided by attacker to connect to the kovka server we can",
    "start": "527399",
    "end": "533480"
  },
  {
    "text": "say we can see there is an ldap URL in the payload and this is the key key",
    "start": "533480",
    "end": "540200"
  },
  {
    "text": "point when we run the PK nothing happens but an exception but if we check the out app",
    "start": "540200",
    "end": "547480"
  },
  {
    "text": "server we can find that the kfka client requests the server and then the server",
    "start": "547480",
    "end": "552760"
  },
  {
    "text": "responds with evil payload and finally the kovka client is taken",
    "start": "552760",
    "end": "559600"
  },
  {
    "text": "over before we move on I'd like to ask a question are you familiar with the",
    "start": "560440",
    "end": "567240"
  },
  {
    "text": "Pok yes this part of the Pok is very similar to J login config fail in our",
    "start": "567240",
    "end": "574440"
  },
  {
    "text": "sample code which I have demonstrated in section one so here's a question what is",
    "start": "574440",
    "end": "581240"
  },
  {
    "text": "the relationship between kovka client and J we can find the answer if we review",
    "start": "581240",
    "end": "589040"
  },
  {
    "text": "the review the exception of the Pok we can see some familiar classes and",
    "start": "589040",
    "end": "594800"
  },
  {
    "text": "methods login contest login module there are the Cor four classes of",
    "start": "594800",
    "end": "601200"
  },
  {
    "text": "J if we debug the Pok we can find that the kfka client utilize Jas first",
    "start": "601200",
    "end": "608279"
  },
  {
    "text": "instantiate a login contest and then call the login method the code of Kafka client is very",
    "start": "608279",
    "end": "615800"
  },
  {
    "text": "similar to the co to the sample code but there is something different what is",
    "start": "615800",
    "end": "622560"
  },
  {
    "text": "it the construct method are different the kka client call The Constructor with",
    "start": "622560",
    "end": "629440"
  },
  {
    "text": "four arguments and the sample code called The Constructor with two arguments so let's move on to the four",
    "start": "629440",
    "end": "637000"
  },
  {
    "text": "argument configuration I will omit the analysis process and just give the final result",
    "start": "637000",
    "end": "644680"
  },
  {
    "text": "this slides show how kka client instantiates the login contest first the",
    "start": "644680",
    "end": "650680"
  },
  {
    "text": "kfka client passes the login config string and then it instantiate a a new",
    "start": "650680",
    "end": "657800"
  },
  {
    "text": "configuration object and then it passes the entry name cobc Handler and the",
    "start": "657800",
    "end": "665040"
  },
  {
    "text": "configuration object to the login contest in short we can say the kovka",
    "start": "665040",
    "end": "670880"
  },
  {
    "text": "client configure the login contest so the only difference between",
    "start": "670880",
    "end": "677760"
  },
  {
    "text": "kka client and Sample code lies in the way of configuring the login",
    "start": "677760",
    "end": "684760"
  },
  {
    "text": "contest then let's move on to the login method we are very familiar with step 3",
    "start": "684760",
    "end": "691880"
  },
  {
    "text": "to six so let's move on to the loging method of the jndi loging",
    "start": "691880",
    "end": "698120"
  },
  {
    "text": "module the login method cost the cost the attempt authentication method and",
    "start": "698120",
    "end": "705120"
  },
  {
    "text": "then the lookup method of initial contest is called before we move on I'd like to",
    "start": "705120",
    "end": "711839"
  },
  {
    "text": "briefly introduce the lookup method here the lookup method is a very common",
    "start": "711839",
    "end": "718200"
  },
  {
    "text": "sync in Javas security just like execute method of runtime and the read object",
    "start": "718200",
    "end": "723720"
  },
  {
    "text": "method and look up with an untrusted address leads to",
    "start": "723720",
    "end": "729600"
  },
  {
    "text": "rce uh here is the attack process first the attacker set up an Evo GDI server",
    "start": "729600",
    "end": "736160"
  },
  {
    "text": "and then the attacker passes an evil gndi URL to your application code if",
    "start": "736160",
    "end": "742160"
  },
  {
    "text": "your code look up this address the server will return some evil",
    "start": "742160",
    "end": "747800"
  },
  {
    "text": "payload to your jvn and then your jvm is taken over by the",
    "start": "747800",
    "end": "753120"
  },
  {
    "text": "attacker now let's go back to the code the variable user provider can be",
    "start": "753120",
    "end": "759920"
  },
  {
    "text": "specified in the login config so it can be controlled by the",
    "start": "759920",
    "end": "766399"
  },
  {
    "text": "attacker then the variable user provider is passed to the look to the lookup",
    "start": "766399",
    "end": "772519"
  },
  {
    "text": "method so we can control the address when the server look up this address it",
    "start": "772519",
    "end": "778760"
  },
  {
    "text": "will be be taken over we can use a diagram to show the",
    "start": "778760",
    "end": "784480"
  },
  {
    "text": "the attack process first the attacker set up an evil gndi server and second",
    "start": "784480",
    "end": "791399"
  },
  {
    "text": "the attacker passes an evil connection stream to the kovka client third the",
    "start": "791399",
    "end": "797440"
  },
  {
    "text": "kovka client passes the connection string and constructs the Evo gndi the",
    "start": "797440",
    "end": "804880"
  },
  {
    "text": "Evo login config passes it to login contest and call the login method of",
    "start": "804880",
    "end": "811440"
  },
  {
    "text": "login contest then the login contest utilize jdi login module to do the user",
    "start": "811440",
    "end": "818800"
  },
  {
    "text": "authentication finally if the if finally the log the J login module looks up the",
    "start": "818800",
    "end": "826199"
  },
  {
    "text": "Evo gndi server and the attacker achieve rce the key point is the controllable",
    "start": "826199",
    "end": "834519"
  },
  {
    "text": "login config kfka client allows user to control the login config so the user can",
    "start": "834519",
    "end": "843199"
  },
  {
    "text": "use a Evo login config to achieve rce so what about the sample code what",
    "start": "843199",
    "end": "851160"
  },
  {
    "text": "will happen if we edit the sample JS config fail and change the sample login",
    "start": "851160",
    "end": "857800"
  },
  {
    "text": "module to jdi login module the answer is very",
    "start": "857800",
    "end": "863560"
  },
  {
    "text": "obvious we achieve RC again we can use a diagram to show the",
    "start": "863560",
    "end": "870279"
  },
  {
    "text": "attack process this attack process is very similar to that of the cve so I put",
    "start": "870279",
    "end": "877399"
  },
  {
    "text": "them in the same diagram the red Parts represent the differences and while the",
    "start": "877399",
    "end": "884440"
  },
  {
    "text": "black parts are completely the Same by comparing we can find that both",
    "start": "884440",
    "end": "891399"
  },
  {
    "text": "kovka client and the sample code allows us to control the login config then we",
    "start": "891399",
    "end": "899360"
  },
  {
    "text": "can use an EVO login config to achieve",
    "start": "899360",
    "end": "904440"
  },
  {
    "text": "RC so we can draw an important conclusion that is controllable login",
    "start": "905440",
    "end": "912279"
  },
  {
    "text": "config can lead to R now that we understand the principle",
    "start": "912279",
    "end": "918279"
  },
  {
    "text": "of the vulnerability let's explore the patch of it in version",
    "start": "918279",
    "end": "925360"
  },
  {
    "text": "3.4.0 the vendor provided an provided a blacklist in and the default Blacklist",
    "start": "925360",
    "end": "934240"
  },
  {
    "text": "includes J dialoging module in other words the Gen dialoging module is",
    "start": "934240",
    "end": "939839"
  },
  {
    "text": "disabled by default we can use a diagram to show how the patch Works after the attacker",
    "start": "939839",
    "end": "947360"
  },
  {
    "text": "passes the Evo connection string to Kar client the kar client will check the",
    "start": "947360",
    "end": "953399"
  },
  {
    "text": "login config if the login config contains an EVO login mod namely gen",
    "start": "953399",
    "end": "960319"
  },
  {
    "text": "dialog module it will be rejected so can we",
    "start": "960319",
    "end": "966519"
  },
  {
    "text": "bypass after analyzing the principle and the patch we got an idea to bypass that",
    "start": "966519",
    "end": "973360"
  },
  {
    "text": "is find other login modules if we can find a new Evo login module just like",
    "start": "973360",
    "end": "980639"
  },
  {
    "text": "jdi login module we can achieve RC again so what are the restrictions on the",
    "start": "980639",
    "end": "987880"
  },
  {
    "text": "login modules that we are looking for here's the restri restrictions",
    "start": "987880",
    "end": "995560"
  },
  {
    "text": "first it should Implement login module interface and then it should exist in",
    "start": "995560",
    "end": "1002759"
  },
  {
    "text": "popular Java Libs and finally it should be able to trigger RC arbitrary fire",
    "start": "1002759",
    "end": "1009240"
  },
  {
    "text": "right or arbitrary fire read or Etc thanks to the idea we found some",
    "start": "1009240",
    "end": "1016360"
  },
  {
    "text": "interesting login modules the first one is proxy login module provided by jbos",
    "start": "1016360",
    "end": "1023000"
  },
  {
    "text": "as its name suggests it will dedicate an agent to perform the perform the",
    "start": "1023000",
    "end": "1030120"
  },
  {
    "text": "authentication specifically the initial the initialized methods of proxy login",
    "start": "1030120",
    "end": "1035798"
  },
  {
    "text": "module construct an agent specified by module name and",
    "start": "1035799",
    "end": "1041959"
  },
  {
    "text": "initialize it then the login method will dedicate the user to perform the",
    "start": "1041959",
    "end": "1049320"
  },
  {
    "text": "authentication perhaps you've already guessed what I'm going to say yes we can",
    "start": "1049320",
    "end": "1054520"
  },
  {
    "text": "use the proxy login module to bypass The Blacklist here is the Pok we use proxy",
    "start": "1054520",
    "end": "1061400"
  },
  {
    "text": "login module and assign gen login module to the module name when we run the Pok",
    "start": "1061400",
    "end": "1069360"
  },
  {
    "text": "we can see that the login method of j& login module is",
    "start": "1069360",
    "end": "1074880"
  },
  {
    "text": "called if we check the Evo gnd server we can find that we have bypassed we have",
    "start": "1074880",
    "end": "1081080"
  },
  {
    "text": "bypassed The Blacklist and Achieve rce again this diagram show how we bypass",
    "start": "1081080",
    "end": "1088480"
  },
  {
    "text": "The Blacklist the proxy login module delegates J&D login module to perform",
    "start": "1088480",
    "end": "1094640"
  },
  {
    "text": "the authentication so we can bypass the Blacklist trigger jdi injection and",
    "start": "1094640",
    "end": "1099760"
  },
  {
    "text": "Achieve RC other interesting login modules is provided by websphere due to time",
    "start": "1099760",
    "end": "1106720"
  },
  {
    "text": "constraints I will only share the Park imagine there is a web service deployed",
    "start": "1106720",
    "end": "1112919"
  },
  {
    "text": "on web spere that allows user to control the CUA connection string we can follow",
    "start": "1112919",
    "end": "1118880"
  },
  {
    "text": "these four steps to achieve RC step one two three and four and finally we will",
    "start": "1118880",
    "end": "1126320"
  },
  {
    "text": "get a web Shi in addition there's an interesting login module named alep login module it",
    "start": "1126320",
    "end": "1134919"
  },
  {
    "text": "is built into the jdk its login method calls the attempt authentication method",
    "start": "1134919",
    "end": "1141240"
  },
  {
    "text": "when authenticating the user the login module will first obtain name and",
    "start": "1141240",
    "end": "1147480"
  },
  {
    "text": "password via a p a callback Handler and then it will check whether the password",
    "start": "1147480",
    "end": "1154159"
  },
  {
    "text": "is blank if not blank it will instantiate a initial ldap contest which",
    "start": "1154159",
    "end": "1161280"
  },
  {
    "text": "will trigger J&D injection briefly if we can find a callback Handler that can",
    "start": "1161280",
    "end": "1166880"
  },
  {
    "text": "provide the password we can trigger jdi injection and Achieve",
    "start": "1166880",
    "end": "1171919"
  },
  {
    "text": "rce so our goal is to find a callback Handler for ldap login",
    "start": "1171919",
    "end": "1178280"
  },
  {
    "text": "module there are three restrictions on the cack handlers that we are looking",
    "start": "1178280",
    "end": "1184799"
  },
  {
    "text": "for first it should be able to handle name callback and password callback",
    "start": "1184799",
    "end": "1190919"
  },
  {
    "text": "otherwise we may receive an unsupported callback exception second it should be",
    "start": "1190919",
    "end": "1198200"
  },
  {
    "text": "able to to obtain passw a password which is not blank and most importantly it is",
    "start": "1198200",
    "end": "1205720"
  },
  {
    "text": "uh it should Implement authenticate cack Handler which is an interface provided",
    "start": "1205720",
    "end": "1212120"
  },
  {
    "text": "by kovka otherwise we we will receive a class cost exception to be honest it is",
    "start": "1212120",
    "end": "1220280"
  },
  {
    "text": "extremely challenging to meet all three conditions simultaneously especially the",
    "start": "1220280",
    "end": "1226640"
  },
  {
    "text": "last one which significantly narrow the",
    "start": "1226640",
    "end": "1232120"
  },
  {
    "text": "scope so which vendors implemented the interface of",
    "start": "1232120",
    "end": "1237240"
  },
  {
    "text": "kovka luckily we find one but due to the disclosure policy we will use some demo",
    "start": "1237240",
    "end": "1244200"
  },
  {
    "text": "code to share the basic principle of the vulnerability instead of sharing the real Park we found the file cack Handler",
    "start": "1244200",
    "end": "1252880"
  },
  {
    "text": "it can obtain name and password from a local file here is the simple simplified code",
    "start": "1252880",
    "end": "1259880"
  },
  {
    "text": "of file callback Handler first it will read key value pairs from a file and the",
    "start": "1259880",
    "end": "1267159"
  },
  {
    "text": "file pass is controlled by us and the column is used to separate each key from",
    "start": "1267159",
    "end": "1273559"
  },
  {
    "text": "its value then it will get value by user controlled",
    "start": "1273559",
    "end": "1279000"
  },
  {
    "text": "keys and the values will be treated as the name and password",
    "start": "1279000",
    "end": "1284520"
  },
  {
    "text": "separately it seems that we have found a callback Handler that mean needs all",
    "start": "1284520",
    "end": "1289640"
  },
  {
    "text": "three conditions simultaneously but the file named user",
    "start": "1289640",
    "end": "1295400"
  },
  {
    "text": "config is created by us can we find a more common one",
    "start": "1295400",
    "end": "1301880"
  },
  {
    "text": "/c/ password can be used to replace the user config file after replacing the",
    "start": "1301880",
    "end": "1308400"
  },
  {
    "text": "file pass we need to replace the origin keys with root then the Handler will",
    "start": "1308400",
    "end": "1314720"
  },
  {
    "text": "treat the string after root column and as the name and password as the name and",
    "start": "1314720",
    "end": "1322279"
  },
  {
    "text": "password then we can construct the final payload we use file callback Handler",
    "start": "1322279",
    "end": "1328720"
  },
  {
    "text": "ldap login module and the file pass is slash it/ password and both the name key",
    "start": "1328720",
    "end": "1336640"
  },
  {
    "text": "and password key are root finally we achieve RC again this is the attack",
    "start": "1336640",
    "end": "1343480"
  },
  {
    "text": "process we use ldap login module and file callback Handler which can obtain a",
    "start": "1343480",
    "end": "1348840"
  },
  {
    "text": "username and password then the ldap login module will look up the Evo gnd",
    "start": "1348840",
    "end": "1354320"
  },
  {
    "text": "server finally we achieve RC again thank you for your attention now",
    "start": "1354320",
    "end": "1360640"
  },
  {
    "text": "I'd like to hand it over to giano who will discuss hunting boxs in other Java",
    "start": "1360640",
    "end": "1367080"
  },
  {
    "text": "libraries hello everyone I'm gangel and after some background knowledges and",
    "start": "1367080",
    "end": "1372919"
  },
  {
    "text": "some Vol abilities about kava Clan next come to the most exciting part",
    "start": "1372919",
    "end": "1379080"
  },
  {
    "text": "and I will share some vulnerabilities we found first let's take some time to",
    "start": "1379080",
    "end": "1385240"
  },
  {
    "text": "review the root cause of the C abilities and that is the G config can be",
    "start": "1385240",
    "end": "1392039"
  },
  {
    "text": "controlled by user that will be a problem have you ever imagine that there",
    "start": "1392039",
    "end": "1399240"
  },
  {
    "text": "are many softwares that may also have this kind of",
    "start": "1399240",
    "end": "1404720"
  },
  {
    "text": "problems with these questions in mind as simply searches on Google and you can",
    "start": "1404720",
    "end": "1409960"
  },
  {
    "text": "see there are lot of softwares that use J and since there are so many Java",
    "start": "1409960",
    "end": "1418000"
  },
  {
    "text": "libraries used G how can we analyze",
    "start": "1418000",
    "end": "1423200"
  },
  {
    "text": "them so we need to do three important things and first we need to summarize",
    "start": "1423200",
    "end": "1429279"
  },
  {
    "text": "the things and then download jav libraries and finally just analyze them",
    "start": "1429279",
    "end": "1435159"
  },
  {
    "text": "let me introduce them one by one first we need to summarize the things if we",
    "start": "1435159",
    "end": "1441039"
  },
  {
    "text": "don't summarize the things we we cannot complete the analyze work and the first",
    "start": "1441039",
    "end": "1447320"
  },
  {
    "text": "one is the one of is thingss in K Clan and you are very familiar with it if a",
    "start": "1447320",
    "end": "1454600"
  },
  {
    "text": "user can control the configuration and that will be a problem and the last two things are Java",
    "start": "1454600",
    "end": "1463240"
  },
  {
    "text": "system property you may also wonder why they works because it can be a remote redress",
    "start": "1463240",
    "end": "1470799"
  },
  {
    "text": "so if a Tacker can control the system property he can just set it as a remote",
    "start": "1470799",
    "end": "1477360"
  },
  {
    "text": "HTP URL and the Evo configuration can be loaded remotely and the next we need to",
    "start": "1477360",
    "end": "1484640"
  },
  {
    "text": "download Java libraries as many as possible we can download from M or just",
    "start": "1484640",
    "end": "1490679"
  },
  {
    "text": "use Google to download and last we need to analyze them automatically and then manually and",
    "start": "1490679",
    "end": "1498399"
  },
  {
    "text": "and we can use static program analyze to find some possible things and then we",
    "start": "1498399",
    "end": "1505159"
  },
  {
    "text": "just review it to find the real box so starting from now we will",
    "start": "1505159",
    "end": "1512279"
  },
  {
    "text": "introduce the vulnerabilities we have found and this is the first vulnerability this is RC in PG gtpc",
    "start": "1512279",
    "end": "1520240"
  },
  {
    "text": "driver and this is also the first type we just call it controllable system",
    "start": "1520240",
    "end": "1525840"
  },
  {
    "text": "property and you can say the poke it's very simple just need to set the J",
    "start": "1525840",
    "end": "1532440"
  },
  {
    "text": "system property and then this time we also need",
    "start": "1532440",
    "end": "1537840"
  },
  {
    "text": "to prepare a Evo PG server because the server needs to send some data to the",
    "start": "1537840",
    "end": "1544320"
  },
  {
    "text": "client and the client will act as will authenticate with the server using",
    "start": "1544320",
    "end": "1551520"
  },
  {
    "text": "curs and this is the four attack process of this vulnerability first the attacker",
    "start": "1551520",
    "end": "1558360"
  },
  {
    "text": "need to set up a Evo GDX server and then set up a Evo PG server and set up a Evo",
    "start": "1558360",
    "end": "1566279"
  },
  {
    "text": "HP server and attacker just control the gtpc URL and the system property and the",
    "start": "1566279",
    "end": "1573559"
  },
  {
    "text": "client will try to connect to the server and then follow the server's",
    "start": "1573559",
    "end": "1578720"
  },
  {
    "text": "instructions to authenticate using Cur and then the G",
    "start": "1578720",
    "end": "1584919"
  },
  {
    "text": "will try to F the remote G config and then just trigger a j request and",
    "start": "1584919",
    "end": "1592320"
  },
  {
    "text": "finally RC and this is the video",
    "start": "1592320",
    "end": "1597799"
  },
  {
    "text": "demo first we need to prepare a Evo login config with h rdbp request and",
    "start": "1597799",
    "end": "1604840"
  },
  {
    "text": "then we just start up HTP server and then we start up a Evo G",
    "start": "1604840",
    "end": "1611559"
  },
  {
    "text": "server and here a ltp server next just start up the Evo PG",
    "start": "1611559",
    "end": "1617919"
  },
  {
    "text": "server nice and then we just run the",
    "start": "1617919",
    "end": "1623039"
  },
  {
    "text": "code and you can see a request of the long config and then request G request",
    "start": "1623039",
    "end": "1630840"
  },
  {
    "text": "and finally you can say the command ex C here and this time we just execute cat",
    "start": "1630840",
    "end": "1638120"
  },
  {
    "text": "EDC password and you can see this is this password in me system because",
    "start": "1638120",
    "end": "1646080"
  },
  {
    "text": "because this is our test environment and you can say RC",
    "start": "1646080",
    "end": "1652278"
  },
  {
    "text": "successfully and there are also other gtpc drivers have this kind of problem",
    "start": "1653919",
    "end": "1659559"
  },
  {
    "text": "like mxq gtpc driver and Microsoft SQL server and their poke are very similar",
    "start": "1659559",
    "end": "1667120"
  },
  {
    "text": "to PG jdpc driver and this is the second type of",
    "start": "1667120",
    "end": "1672600"
  },
  {
    "text": "the vulnerabilities controllable Ur of login config and this is poke of impala gdbc",
    "start": "1672600",
    "end": "1680960"
  },
  {
    "text": "driver and Impala is a very famous database in Big Data area and you can",
    "start": "1680960",
    "end": "1686840"
  },
  {
    "text": "see here the GDP contains a malicious parameter named curb jsv with a remote",
    "start": "1686840",
    "end": "1695480"
  },
  {
    "text": "HP URL and this is the Poke Sho and you can",
    "start": "1695480",
    "end": "1700840"
  },
  {
    "text": "see we just provided a HTP server and a g server and I also prepare a Evo in par",
    "start": "1700840",
    "end": "1709000"
  },
  {
    "text": "config and then just run the code and you can say RC here and this time we",
    "start": "1709000",
    "end": "1715600"
  },
  {
    "text": "just execute calculator command and you can see calculator here that's",
    "start": "1715600",
    "end": "1722200"
  },
  {
    "text": "RC and this see the tech process of this kind of pro this kind of vulnerability",
    "start": "1722200",
    "end": "1728240"
  },
  {
    "text": "and the techer needs to set up a e server and EV server and no need to set",
    "start": "1728240",
    "end": "1734679"
  },
  {
    "text": "up a Evo database server and then it just send the GDP URL to the impart gdpc",
    "start": "1734679",
    "end": "1740960"
  },
  {
    "text": "driver and no need to control the system property and the impart gdpc driver pass",
    "start": "1740960",
    "end": "1747440"
  },
  {
    "text": "the GP URL and then try to use GES to authenticate with the server and then",
    "start": "1747440",
    "end": "1754159"
  },
  {
    "text": "fetch a remote GS config and then trigger urg request and finally",
    "start": "1754159",
    "end": "1763159"
  },
  {
    "text": "RC and there are also GDP ders have this kind of on abilities first is the cloud",
    "start": "1763159",
    "end": "1771760"
  },
  {
    "text": "he gtpc driver and cloud is a very famous company in Big Data area and also",
    "start": "1771760",
    "end": "1779399"
  },
  {
    "text": "database data breaks jdpc drivers and data breaks is the very famous company",
    "start": "1779399",
    "end": "1785519"
  },
  {
    "text": "provided Big Data Solutions and also XO gtpc driver have this kind of problem",
    "start": "1785519",
    "end": "1793799"
  },
  {
    "text": "and exito is a famous company in big data and AI",
    "start": "1793799",
    "end": "1799039"
  },
  {
    "text": "arrow and also there are spark gdpc drivers he gdpc drivers and the Impala",
    "start": "1799039",
    "end": "1806720"
  },
  {
    "text": "gdbc drivers provided by AWS have this kind of",
    "start": "1806720",
    "end": "1812120"
  },
  {
    "text": "problem and also the he and Spark GP driver provided by inside software have",
    "start": "1812120",
    "end": "1818360"
  },
  {
    "text": "this kind of problems and currently this vendors have confirmed the",
    "start": "1818360",
    "end": "1824240"
  },
  {
    "text": "vulnerabilities and provide us with feedback that they have applied for CV numbers for example the CV number of",
    "start": "1824240",
    "end": "1832919"
  },
  {
    "text": "cloud Ro GTP driver is CV 2024 4 five 4",
    "start": "1832919",
    "end": "1839559"
  },
  {
    "text": "five 54 66 Z and in a few days you will",
    "start": "1839559",
    "end": "1844799"
  },
  {
    "text": "be able to see the C numbers of the vulnerabilities online and there are also some",
    "start": "1844799",
    "end": "1851519"
  },
  {
    "text": "vulnerabilities due to the disclosure policies we cannot disclose them this time and we plan to write the complete",
    "start": "1851519",
    "end": "1859320"
  },
  {
    "text": "possability list in our blog for your viewing and this is the thir type",
    "start": "1859320",
    "end": "1867399"
  },
  {
    "text": "controllable login config and but due to some legal reasons and disclosure policy",
    "start": "1867399",
    "end": "1874600"
  },
  {
    "text": "we cannot public share it here so we use some demo code to share the basic",
    "start": "1874600",
    "end": "1880799"
  },
  {
    "text": "principle of the disability instead of sharing the real",
    "start": "1880799",
    "end": "1886480"
  },
  {
    "text": "poke and this this is the Cod implment of the gtpc driver and you can see it",
    "start": "1886480",
    "end": "1892720"
  },
  {
    "text": "let users to set the K tab parameter and it directly use the splashing method",
    "start": "1892720",
    "end": "1899519"
  },
  {
    "text": "without any restrictions and we can just inject some Evo content",
    "start": "1899519",
    "end": "1905480"
  },
  {
    "text": "here and this is a clear roll display and you can see the key tab par",
    "start": "1905480",
    "end": "1911600"
  },
  {
    "text": "parameter can inject some malicious content and here but they also me the questions does",
    "start": "1911600",
    "end": "1920600"
  },
  {
    "text": "this kind of injection method Works can we inject some malicious config to achieve",
    "start": "1920600",
    "end": "1926880"
  },
  {
    "text": "RC and this is the definition of JS config from GDK official website and you",
    "start": "1926880",
    "end": "1933480"
  },
  {
    "text": "can say each entry of JS config supports multi loging",
    "start": "1933480",
    "end": "1939279"
  },
  {
    "text": "modules and that means we can inject with a new login model",
    "start": "1939279",
    "end": "1945480"
  },
  {
    "text": "here and you can see this is the full process of the resolving this kind of JS",
    "start": "1945480",
    "end": "1952519"
  },
  {
    "text": "config first it needs the flag of first login module is required and then",
    "start": "1952519",
    "end": "1960320"
  },
  {
    "text": "regardless of whether or not the login module one log in successfully or not it",
    "start": "1960320",
    "end": "1967000"
  },
  {
    "text": "will finally use login model 2 to log in and that means our injection method",
    "start": "1967000",
    "end": "1973639"
  },
  {
    "text": "works and then here is we has set key tab parameter to our Evo dialoging model and then we",
    "start": "1973639",
    "end": "1984200"
  },
  {
    "text": "RC and and this is the Poke and then you",
    "start": "1984200",
    "end": "1989919"
  },
  {
    "text": "can see the core P core part is curb key tab parameter and is very long because",
    "start": "1989919",
    "end": "1997320"
  },
  {
    "text": "it contain the full Evo G config and this is",
    "start": "1997320",
    "end": "2003320"
  },
  {
    "text": "the H sh and you can see here we no need to set up a Evo HP server and a Evo",
    "start": "2003320",
    "end": "2010960"
  },
  {
    "text": "database server we just need to set up a Evo GD server and just run the code you",
    "start": "2010960",
    "end": "2016960"
  },
  {
    "text": "can see RC here also a calculator and this is four attack",
    "start": "2016960",
    "end": "2024320"
  },
  {
    "text": "process of this kind of aties and you can see only need to set up a evogen d",
    "start": "2024320",
    "end": "2030600"
  },
  {
    "text": "server and the techer send the gtpc URL to the gtpc driver and the gtpc driver",
    "start": "2030600",
    "end": "2037039"
  },
  {
    "text": "pass the parameter and then create a new login config content with our injection",
    "start": "2037039",
    "end": "2044840"
  },
  {
    "text": "and then it try to authenticate using G and will trigger agendia request and",
    "start": "2044840",
    "end": "2052240"
  },
  {
    "text": "finally RC and next come to the fourth part let",
    "start": "2052240",
    "end": "2057800"
  },
  {
    "text": "me introduce the impact of this kind of vulnerabilities and I think you may also",
    "start": "2057800",
    "end": "2063720"
  },
  {
    "text": "very curious about the impact of these vulnerabilities first we can use this can of",
    "start": "2063720",
    "end": "2070240"
  },
  {
    "text": "vulnerabilities to take over the cloud service provided by Cloud",
    "start": "2070240",
    "end": "2075320"
  },
  {
    "text": "vendors and what is cloud service and since some people may not familiar with it let me introduce it in short words",
    "start": "2075320",
    "end": "2083118"
  },
  {
    "text": "Cloud vendors deploy service in their own environments and provide them to",
    "start": "2083119",
    "end": "2088398"
  },
  {
    "text": "users after purchase and the cloud and the service deployed by Cloud vendors",
    "start": "2088399",
    "end": "2094720"
  },
  {
    "text": "are just cloud service and it a very simple content and it come then it comes that",
    "start": "2094720",
    "end": "2102000"
  },
  {
    "text": "new questions which cloud service are the most likely to be taken over via our",
    "start": "2102000",
    "end": "2107760"
  },
  {
    "text": "own ability since there are two many cloud service and Cloud",
    "start": "2107760",
    "end": "2113200"
  },
  {
    "text": "products based on my experience I have summarized two types of cloud surveys",
    "start": "2113200",
    "end": "2119520"
  },
  {
    "text": "and the first type is the cloud surveys that assist users in conducting data Anze because this this type of service",
    "start": "2119520",
    "end": "2127760"
  },
  {
    "text": "need the server to connect to the users own database and the second tab is data",
    "start": "2127760",
    "end": "2134560"
  },
  {
    "text": "visualization and it is also a very popular and a common products so how do you take",
    "start": "2134560",
    "end": "2142280"
  },
  {
    "text": "over and you can see in the left window this is a function called new database",
    "start": "2142280",
    "end": "2148800"
  },
  {
    "text": "connection and it need it lets user to set the gtpc URL because the server need",
    "start": "2148800",
    "end": "2155520"
  },
  {
    "text": "to connect to the user's own datab base and in the right window you can say it a",
    "start": "2155520",
    "end": "2162599"
  },
  {
    "text": "function called add cka data source because the server will try to connect",
    "start": "2162599",
    "end": "2168359"
  },
  {
    "text": "to the users cast server and then we can just exploit the",
    "start": "2168359",
    "end": "2175000"
  },
  {
    "text": "Vol abilities we can set our poke in the GDP parameter and just simply test",
    "start": "2175000",
    "end": "2182480"
  },
  {
    "text": "connection and the server will act as a gdbc driver to connect to our gdpt",
    "start": "2182480",
    "end": "2189440"
  },
  {
    "text": "server and then we RC and here we can set our po of CA Clan",
    "start": "2189440",
    "end": "2197000"
  },
  {
    "text": "and then the server will act as a cka clan to authenticate with our server and",
    "start": "2197000",
    "end": "2203240"
  },
  {
    "text": "then rce and this is architecture of this kind of cloud product and you can see",
    "start": "2203240",
    "end": "2210640"
  },
  {
    "text": "there is something like called config service and the users need to send the",
    "start": "2210640",
    "end": "2216240"
  },
  {
    "text": "data source config to the config server and then the server schedules the",
    "start": "2216240",
    "end": "2221400"
  },
  {
    "text": "request to the executor and the executor will finally connect to the user",
    "start": "2221400",
    "end": "2228440"
  },
  {
    "text": "database and help users manage data and attacker just need to send the payload",
    "start": "2228440",
    "end": "2235440"
  },
  {
    "text": "to the config server and the executor follow the servers request to connect to",
    "start": "2235440",
    "end": "2242319"
  },
  {
    "text": "our Evo data source and then we R and we are be taken over by by",
    "start": "2242319",
    "end": "2249920"
  },
  {
    "text": "us and if different users shared a use a shared executive that means once we",
    "start": "2249920",
    "end": "2258119"
  },
  {
    "text": "control one of the executive we can also connect to other users database and that",
    "start": "2258119",
    "end": "2265720"
  },
  {
    "text": "will be a disaster and the commercial products are very similar to cloud service commercial",
    "start": "2265720",
    "end": "2273920"
  },
  {
    "text": "products are generally de deployed local by user and the cloud service are",
    "start": "2273920",
    "end": "2280560"
  },
  {
    "text": "deployed by Cloud Wenders and I think there are no significant difference",
    "start": "2280560",
    "end": "2286160"
  },
  {
    "text": "between the commercial product and the cloud survey so I w't take time to",
    "start": "2286160",
    "end": "2291839"
  },
  {
    "text": "provide a detailed introduction of the impact on the commercial products so",
    "start": "2291839",
    "end": "2298160"
  },
  {
    "text": "besid the cloud service and the commercial products what other scenarios also have this kind of",
    "start": "2298160",
    "end": "2304960"
  },
  {
    "text": "problem and that is the database server and we can just achieve rce from execute",
    "start": "2304960",
    "end": "2313000"
  },
  {
    "text": "SQL because the database also support external data source like here this is a",
    "start": "2313000",
    "end": "2320119"
  },
  {
    "text": "PG functions it need the users to connect to a remote PG server and also",
    "start": "2320119",
    "end": "2327599"
  },
  {
    "text": "this is a function in Click house database and you can see it allows users",
    "start": "2327599",
    "end": "2333599"
  },
  {
    "text": "to connect to a remote M mq database and this kind of functions really Implement",
    "start": "2333599",
    "end": "2340960"
  },
  {
    "text": "by gdbc so if a database support a vulnerable driver we can just takeen",
    "start": "2340960",
    "end": "2348359"
  },
  {
    "text": "over it by executing SQL and then the next part is H to",
    "start": "2348359",
    "end": "2356480"
  },
  {
    "text": "defense and I think there are three parts first DK and I think it is",
    "start": "2356480",
    "end": "2363560"
  },
  {
    "text": "necessary to disallow loading loging config remote because it is very risk and then I think",
    "start": "2363560",
    "end": "2371160"
  },
  {
    "text": "it is better to disable some Evo loging modules like gen dialoging model by",
    "start": "2371160",
    "end": "2376800"
  },
  {
    "text": "default and then just ja labories providers like kka Clan and gtpc driver",
    "start": "2376800",
    "end": "2383680"
  },
  {
    "text": "I think it is better to use white list instead of Black List because Black List",
    "start": "2383680",
    "end": "2389319"
  },
  {
    "text": "are very easy to bypass and next is applications like",
    "start": "2389319",
    "end": "2394839"
  },
  {
    "text": "Clos series or commercial products I think it it is not it is not good to",
    "start": "2394839",
    "end": "2400960"
  },
  {
    "text": "trust the inut from users and we should and they they are better to use W Le to",
    "start": "2400960",
    "end": "2408160"
  },
  {
    "text": "limit the users ability and I think they should also pay attention to the new",
    "start": "2408160",
    "end": "2414920"
  },
  {
    "text": "volner abilities and just update Java libraries promptly and finally some",
    "start": "2414920",
    "end": "2422520"
  },
  {
    "text": "takeaways and after our talk and I think you can know what JS is and how to use",
    "start": "2422520",
    "end": "2428079"
  },
  {
    "text": "Jes and how it works and you can also know some interesting vulnerabilities about Jes and know their root cause and",
    "start": "2428079",
    "end": "2436280"
  },
  {
    "text": "uh you will also acquire new technique to CH rce and as for the software",
    "start": "2436280",
    "end": "2442920"
  },
  {
    "text": "providers you can also know how to securely integrate J into Java",
    "start": "2442920",
    "end": "2448960"
  },
  {
    "text": "libraries and that's all thank you for your listening and if you have any questions you can contact us via Twitter",
    "start": "2448960",
    "end": "2456520"
  },
  {
    "text": "and if you get inspiration from here and discover new abilities you can also",
    "start": "2456520",
    "end": "2461880"
  },
  {
    "text": "share the good news with us and here are some patched gtpc",
    "start": "2461880",
    "end": "2467319"
  },
  {
    "text": "drivers and if you are using an affected gtpc driver please upgrade it promptly",
    "start": "2467319",
    "end": "2475720"
  }
]