[
  {
    "text": "awesome well good morning everyone thanks for your patience uh really excited to be here today um and Welcome",
    "start": "2560",
    "end": "7680"
  },
  {
    "text": "to Cloud console cartographer tapping into mapping is greater than slogging through logging uh so first a brief introduction",
    "start": "7680",
    "end": "15120"
  },
  {
    "text": "who are we and what are we going to be talking about good morning everyone has everybody got a coffee in sweet my name",
    "start": "15120",
    "end": "23000"
  },
  {
    "text": "is andreti I live and work in Pristina Kosovo recently graduated for computer",
    "start": "23000",
    "end": "28880"
  },
  {
    "text": "engineering background I started working at permisso security almost a year ago as an",
    "start": "28880",
    "end": "36200"
  },
  {
    "text": "associate thre researcher recently I published an open- Source tool called cloud cloud Grappler",
    "start": "36200",
    "end": "43600"
  },
  {
    "text": "so you have the link below if you want to give it some",
    "start": "43600",
    "end": "48640"
  },
  {
    "text": "love and my name is Daniel banan uh I'm from the USA I'm a principal threat researcher with periso uh I've been in",
    "start": "50239",
    "end": "56719"
  },
  {
    "text": "the security industry for about 14 years now um the last couple roles I've been in where instant response and researcher",
    "start": "56719",
    "end": "62800"
  },
  {
    "text": "at mandant and then also spent a couple years at Microsoft I've been at priso for about a year and a half now um and I'm a big fan of uh of security research",
    "start": "62800",
    "end": "70200"
  },
  {
    "text": "I love these conferences I love uh open source tools and have a deep fascination with aisc and looking at uh common",
    "start": "70200",
    "end": "76920"
  },
  {
    "text": "things and uncommon ways I'm always taking an offensive approach uh to a defensive uh",
    "start": "76920",
    "end": "82960"
  },
  {
    "text": "mindset so with that being said logs what you know uh we're here to talk for",
    "start": "82960",
    "end": "88000"
  },
  {
    "text": "40 minutes about logs and keep you interested in exciting uh so what's the role of logs well as a Defender logs are",
    "start": "88000",
    "end": "93520"
  },
  {
    "text": "visibility they tell me what has happened in an environment um often people do not enable logs and typically",
    "start": "93520",
    "end": "100360"
  },
  {
    "text": "attackers do not do this for you so know what logs you're capable of recording and turn them on um secondly move them",
    "start": "100360",
    "end": "107880"
  },
  {
    "text": "to another location so that you have a duplication replication so it's harder for an attacker to go and remove those",
    "start": "107880",
    "end": "113119"
  },
  {
    "text": "logs and then do something with them uh you don't just want to have logs to look at when there's been an incident you",
    "start": "113119",
    "end": "119119"
  },
  {
    "text": "want to monitor them and see uh proactively is there something that is suspicious that you should be looking for um I'm going to briefly talk about",
    "start": "119119",
    "end": "126479"
  },
  {
    "text": "some of the differences in my opinion between kind of on Prim and Cloud logs now this is not the storage location",
    "start": "126479",
    "end": "131720"
  },
  {
    "text": "it's more of the data source so like what are some differences between like host Bas logs Network logs and then",
    "start": "131720",
    "end": "137400"
  },
  {
    "text": "Cloud logs um from a host and network perspective um they've been around a lot longer you have more options for",
    "start": "137400",
    "end": "143160"
  },
  {
    "text": "forwarders um for tools to look at the logs um in my opinion they're a lot more granular think of how much information",
    "start": "143160",
    "end": "149200"
  },
  {
    "text": "you can get from something like sysmon you can get process information image loads network connections even the",
    "start": "149200",
    "end": "154400"
  },
  {
    "text": "contents of files that attackers might be using for binaries or scripts um so there are a lot of opportunities for",
    "start": "154400",
    "end": "160080"
  },
  {
    "text": "fingerprints to be left uh unknowingly by an attacker um and in the world of instant response and forensics it's just",
    "start": "160080",
    "end": "166560"
  },
  {
    "text": "a beautiful thing to find all these secondary effects that come from an initial action from an attacker but",
    "start": "166560",
    "end": "171640"
  },
  {
    "text": "things get a little blurrier with Cloud um there's not quite as much control you are basically holding to whatever the",
    "start": "171640",
    "end": "177480"
  },
  {
    "text": "cloud provider gives you um and typically most those Cloud providers break up their logs into control plane",
    "start": "177480",
    "end": "182560"
  },
  {
    "text": "and data plane log control plane is typically enabled by default and it gives you information about the",
    "start": "182560",
    "end": "188200"
  },
  {
    "text": "management and configuration of everything within that environment data plane is typically not enabled by",
    "start": "188200",
    "end": "193760"
  },
  {
    "text": "default so control plane can be um like the configuration of an S3 bucket data",
    "start": "193760",
    "end": "199480"
  },
  {
    "text": "plan is every time someone requests something from that bucket or uploads something to it um and it's typically not enabled by default just due to",
    "start": "199480",
    "end": "205599"
  },
  {
    "text": "volume and cost there are also different retention limits which we'll talk about um in the next slide U but typically",
    "start": "205599",
    "end": "211360"
  },
  {
    "text": "they're a little less granular because Cloud logs are basically a record of an API call it's not even something that is",
    "start": "211360",
    "end": "217000"
  },
  {
    "text": "logging activity on an endpoint or device it's already abstracted one layer so finding those fingerprints becomes",
    "start": "217000",
    "end": "222840"
  },
  {
    "text": "more about grouping less uh less precise information um into a larger aggregate",
    "start": "222840",
    "end": "228799"
  },
  {
    "text": "um data um so let's talk a little more about Cloud logs for Defender um for",
    "start": "228799",
    "end": "234439"
  },
  {
    "text": "Defenders so if we were to look at let's say AWS and Azure this is an example of doing something really simple we're just",
    "start": "234439",
    "end": "239760"
  },
  {
    "text": "creating a new user in this case called qua um we can see here there's kind of similarly named events um and the name",
    "start": "239760",
    "end": "247000"
  },
  {
    "text": "of the user that was created between these two logs um so what about actually",
    "start": "247000",
    "end": "252079"
  },
  {
    "text": "quering these logs how do you actually get to what we just saw um well you have the opportunity to hit the API that the",
    "start": "252079",
    "end": "257600"
  },
  {
    "text": "cloud providers uh give you um one of the pros is it's the least delayed you don't have to worry about getting a",
    "start": "257600",
    "end": "262800"
  },
  {
    "text": "secondary replication you can get it right from the source um sometimes even a few minutes earlier um than some other locations one of the cons though is",
    "start": "262800",
    "end": "269400"
  },
  {
    "text": "retention AWS cloud trail you can go back 90 days Azure is only 30 does that matter to you",
    "start": "269400",
    "end": "275320"
  },
  {
    "text": "it's at least something you should think about and know what the limitations are um fored though gives you the ability to",
    "start": "275320",
    "end": "281880"
  },
  {
    "text": "have however much storage you want you can retain it for 5 years 10 years if you want to and typically storage is not",
    "start": "281880",
    "end": "287639"
  },
  {
    "text": "too expensive again it all depends on the volume that you're talking about um there's also no API throttling um so for",
    "start": "287639",
    "end": "294080"
  },
  {
    "text": "example cloud trail lookup events you can hit two times per second now that's still a lot but when you have a lot of different security tools competing for",
    "start": "294080",
    "end": "300560"
  },
  {
    "text": "that you can hit API throttling pretty quickly um it's also a bit easier to consume by other tools if it's already",
    "start": "300560",
    "end": "306880"
  },
  {
    "text": "replicated onto an Azure storage blob or an S3 bucket anyone can consume that data and you can control access to that",
    "start": "306880",
    "end": "312320"
  },
  {
    "text": "storage location rather than giving someone access to build to Hidden API in your account one of the cons though is",
    "start": "312320",
    "end": "317960"
  },
  {
    "text": "that sometimes you're actually missing metadata uh if you query logs from cloud trail um then you'll actually get an",
    "start": "317960",
    "end": "323440"
  },
  {
    "text": "entire different section of resources with a resource type and resource name if you for those logs that data is",
    "start": "323440",
    "end": "328560"
  },
  {
    "text": "completely missing um so it's important to kind of diff the two uh options and see if that matters to you um also",
    "start": "328560",
    "end": "336000"
  },
  {
    "text": "additional monitoring anytime you introduce another step into the pipeline you want to make sure that you're monitoring the health of that step to",
    "start": "336000",
    "end": "341680"
  },
  {
    "text": "make sure that those logs um are flowing",
    "start": "341680",
    "end": "345919"
  },
  {
    "text": "correctly um so when we use the word console this talk is called Cloud console cartographer this is a bit",
    "start": "347280",
    "end": "352840"
  },
  {
    "text": "confusing because typically console means like a terminal a black terminal window or blue if you're a pow shell",
    "start": "352840",
    "end": "357880"
  },
  {
    "text": "user um but in this case uh console hey can we actually go back a",
    "start": "357880",
    "end": "364039"
  },
  {
    "text": "slide um console is referring to the AWS Management console so it's the actual web browser that you log into uh to look",
    "start": "364039",
    "end": "370720"
  },
  {
    "text": "at your configurations to manage your um to manage your",
    "start": "370720",
    "end": "375840"
  },
  {
    "text": "environment hey can we move get some other batteries in this thank you um so uh do do people actually still use",
    "start": "376720",
    "end": "383160"
  },
  {
    "text": "console um the answer is yes uh legitimate users and attackers still use console today um there's two different",
    "start": "383160",
    "end": "389599"
  },
  {
    "text": "threat groups that we've seen do this quite a bit luer 3 um and lcer uh one lcer 3 is also known as scattered spider",
    "start": "389599",
    "end": "395000"
  },
  {
    "text": "or roasted octopus um they actually use console pre prolifically sometimes maybe that's just because they might have PDFs",
    "start": "395000",
    "end": "400960"
  },
  {
    "text": "that's their run books and it says click here do this do that some attackers are still learning cloud but it's lucrative enough for them to still break in",
    "start": "400960",
    "end": "407199"
  },
  {
    "text": "because many organizations are not too advanced in their Cloud security um configurations um sometimes there are",
    "start": "407199",
    "end": "413639"
  },
  {
    "text": "also technical reasons uh why uh someone might use the console we go to the next slide please um for example we've",
    "start": "413639",
    "end": "420120"
  },
  {
    "text": "actually seen a case where an attacker um got a uh they basically uh broke out of an ECS container um and they had a",
    "start": "420120",
    "end": "426720"
  },
  {
    "text": "federation uh token and what's interesting is that if you look at AWS documentation if you have access in the",
    "start": "426720",
    "end": "432240"
  },
  {
    "text": "Federated token there are some limitations like you cannot access the I Service uh via the CLI or an SDK but",
    "start": "432240",
    "end": "439560"
  },
  {
    "text": "that limitation does not apply to console and that's precisely what this attacker did as soon as they broke out",
    "start": "439560",
    "end": "444759"
  },
  {
    "text": "of that ECS container they then went straight to the uh the Management console and then went right to the IM",
    "start": "444759",
    "end": "451080"
  },
  {
    "text": "service to create a user login profile all the rest so there are technical reasons why attackers still might use",
    "start": "451080",
    "end": "456520"
  },
  {
    "text": "the console oh cool Deo showed us two",
    "start": "456520",
    "end": "463160"
  },
  {
    "text": "examples of cloud logs both in Asia and AWS but how do they look from the log",
    "start": "463160",
    "end": "469120"
  },
  {
    "text": "volume perspective and for that we're going to do some enumeration process in AWS console listing some user policies",
    "start": "469120",
    "end": "476919"
  },
  {
    "text": "roles E2 instances and we' be surprised on how many events are generated by",
    "start": "476919",
    "end": "482960"
  },
  {
    "text": "those simple readon uh Clicks aure in the other hand tends to do things",
    "start": "482960",
    "end": "489000"
  },
  {
    "text": "differently they only log change or update events so if we were to do the same enumeration process in asure Portal",
    "start": "489000",
    "end": "496120"
  },
  {
    "text": "like listing user blobs or containers we'd be muted and get no logs at all and",
    "start": "496120",
    "end": "501400"
  },
  {
    "text": "stand uh speaking from a security standpoint you always want to know if an attacker is doing the enumeration",
    "start": "501400",
    "end": "508599"
  },
  {
    "text": "process of your sensitive data in your environment and for that Asel kind of",
    "start": "508599",
    "end": "514719"
  },
  {
    "text": "gets a free pass from our problem not because they are doing a better job obviously but since they don't provide",
    "start": "514719",
    "end": "521399"
  },
  {
    "text": "us enough logs to actually make sense of what's happening in their",
    "start": "521399",
    "end": "526440"
  },
  {
    "text": "environment and with that being said we're going to focus only on the AWS part where we can actually get that",
    "start": "526440",
    "end": "533519"
  },
  {
    "text": "information let's jump down to the main part of the presentation which is the problem of noisy console logs we all",
    "start": "533519",
    "end": "541399"
  },
  {
    "text": "love logs here they shine our path towards the truth but sometimes too much",
    "start": "541399",
    "end": "547160"
  },
  {
    "text": "brightness can make you blind and leave you out in the dark but the main problem",
    "start": "547160",
    "end": "552399"
  },
  {
    "text": "here is not the absence of logs just like we discuss that aure doesn't log many of these things it's actually the",
    "start": "552399",
    "end": "559800"
  },
  {
    "text": "sheer volume of logs that get generated from the console session in ews and",
    "start": "559800",
    "end": "565399"
  },
  {
    "text": "sometimes it feels just like playing the Tor super Breakout game where we can think that every single UI click that we",
    "start": "565399",
    "end": "571760"
  },
  {
    "text": "do is just like when the ball goes from a paddle hits one brick so you have that",
    "start": "571760",
    "end": "577600"
  },
  {
    "text": "one to one correlation so one request one response or even say better for each",
    "start": "577600",
    "end": "583360"
  },
  {
    "text": "single UI click you get only one event generated but that's obviously not the",
    "start": "583360",
    "end": "588720"
  },
  {
    "text": "case at all times sometimes the ball goes from a paddle goes way over to the top it TS if not hundred of API calls in",
    "start": "588720",
    "end": "596920"
  },
  {
    "text": "the back end and we're going to see later on Slide that's actually the use case in some of our conso session back to",
    "start": "596920",
    "end": "605000"
  },
  {
    "text": "you you so uh how did we come across this well we look at a lot of logs and",
    "start": "605000",
    "end": "610480"
  },
  {
    "text": "we realized wow there's a lot here how do we even make sense of what happened in this 1,000 event console session and",
    "start": "610480",
    "end": "616000"
  },
  {
    "text": "we see a lot of these events are occurring in the exact same timestamp so what we decided to do was we created an identity called No permissions and we",
    "start": "616000",
    "end": "622680"
  },
  {
    "text": "gave it no permissions we only gave it a login profile and then started to go through uh the console and what we found",
    "start": "622680",
    "end": "629079"
  },
  {
    "text": "was uh many different errors started showing up um and you can see all these different widgets in the console have these different errors so let's click to",
    "start": "629079",
    "end": "635240"
  },
  {
    "text": "the IM dashboard we see even more errors let's just start to kind of pull those over to the side um and and basically",
    "start": "635240",
    "end": "641800"
  },
  {
    "text": "try to understand uh are these consistent across every time you visit these different pages so if we click on users we have list users let's actually",
    "start": "641800",
    "end": "648920"
  },
  {
    "text": "use this one as an example if we focus just on list users um then what if we give ourselves just that access so what",
    "start": "648920",
    "end": "655279"
  },
  {
    "text": "if we can make it one step further like if we give ourselves an inline policy now we can actually make a little more",
    "start": "655279",
    "end": "660920"
  },
  {
    "text": "progress now it lists the users but you'll notice that each column are more errors with different API calls um so uh",
    "start": "660920",
    "end": "668160"
  },
  {
    "text": "how do we actually approach this and say understanding list users um what are",
    "start": "668160",
    "end": "673680"
  },
  {
    "text": "what are these other events how are they required how do we figure this out cool in order for us to be looking",
    "start": "673680",
    "end": "680399"
  },
  {
    "text": "at the data that dbo just uh told we need to crack open the hood and see what treasure is inside of it and from there",
    "start": "680399",
    "end": "687399"
  },
  {
    "text": "we extract full four golden rules that we live by First full permissions our",
    "start": "687399",
    "end": "693279"
  },
  {
    "text": "user needs to have full full permissions in order for us not to be losing time and giving ourselves manual permissions",
    "start": "693279",
    "end": "699920"
  },
  {
    "text": "for every action we're trying to do new environment or a clean environment for each service lots of Excel spreadsheets",
    "start": "699920",
    "end": "707079"
  },
  {
    "text": "where we track our time of our actions and my favorite one lots of coffee or any coffee and drink of your choice",
    "start": "707079",
    "end": "714440"
  },
  {
    "text": "let's go back to the IM user part where we have three scenarios the first one",
    "start": "714440",
    "end": "719600"
  },
  {
    "text": "where our user has no permissions at all besides breathing and just logging into the profile scenario B where our user",
    "start": "719600",
    "end": "726800"
  },
  {
    "text": "has only one action allowed and that's the IM list users and the L scenario",
    "start": "726800",
    "end": "731880"
  },
  {
    "text": "scenario C where our user has full permissions uh in the environment now",
    "start": "731880",
    "end": "737079"
  },
  {
    "text": "let's see what events are generated in the back for each scenario for scenario a we have only one",
    "start": "737079",
    "end": "743800"
  },
  {
    "text": "uh event generated and that's the IM list user which was obviously night uh",
    "start": "743800",
    "end": "750320"
  },
  {
    "text": "due to lack of permissions so nothing fancy going on here if we move down to scenario B we obviously see more evance",
    "start": "750320",
    "end": "758040"
  },
  {
    "text": "generated and the difference between these two scenarios is that in the scenario B the IM list user uh event was",
    "start": "758040",
    "end": "767079"
  },
  {
    "text": "successful indeed and we see five group five other grouping of events which occurred but uh uh were denied due to",
    "start": "767079",
    "end": "774920"
  },
  {
    "text": "lack of permissions again moving down to scenario C is where things start to get",
    "start": "774920",
    "end": "780040"
  },
  {
    "text": "uh interesting we obviously that the first event is uh again successful we have the five grouping of events which",
    "start": "780040",
    "end": "786720"
  },
  {
    "text": "in this case were successful and they occurred once per identity so we know that uh occurred also in the previous",
    "start": "786720",
    "end": "794040"
  },
  {
    "text": "scenario and in this scenarios so we're going to move them uh to our map on this",
    "start": "794040",
    "end": "799320"
  },
  {
    "text": "site and now we shift our Focus down to the two additional events at the bottom so we have the uh event get access key",
    "start": "799320",
    "end": "807000"
  },
  {
    "text": "last used and they occur only if the user has a access key uh present so a",
    "start": "807000",
    "end": "812040"
  },
  {
    "text": "user may contain zero up to two access keys but they may have none so this event might never occur our approach to",
    "start": "812040",
    "end": "819399"
  },
  {
    "text": "this problem is let's list these events in three groupings the anchor event",
    "start": "819399",
    "end": "824800"
  },
  {
    "text": "which is the main event that must happen at all times the required events and last the optional events which are again",
    "start": "824800",
    "end": "832160"
  },
  {
    "text": "are events that may happen but if not they won't be a deal breaker to us",
    "start": "832160",
    "end": "839839"
  },
  {
    "text": "so let's talk a little more about optional events we kind of break this up into two separate categories one is kind of the background health events if",
    "start": "840560",
    "end": "846759"
  },
  {
    "text": "you're still logged in there's going to be some events that show up so even just logging into the console home session we actually can Define these into the",
    "start": "846759",
    "end": "853560"
  },
  {
    "text": "events that are actually correlated to the click and then all these background health events um so one of the things",
    "start": "853560",
    "end": "859000"
  },
  {
    "text": "that we that we first do is to try to figure out the noise that exist in general and this as Andi said in all",
    "start": "859000",
    "end": "864399"
  },
  {
    "text": "those spreadsheets we need to do the same actions multiple times to start to understand which are consistent with the input action and which are just kind of",
    "start": "864399",
    "end": "870959"
  },
  {
    "text": "events hanging around and we basically like to slide those events out of the way so that we're not accidentally putting those background health events",
    "start": "870959",
    "end": "877079"
  },
  {
    "text": "as a required event into the definition of the signal itself um the other kind of optional event is based on the",
    "start": "877079",
    "end": "883720"
  },
  {
    "text": "context um I think we're really hungry the day that we came up with this idea and basically uh we have the everything bagel and the plane bagel and what I",
    "start": "883720",
    "end": "890720"
  },
  {
    "text": "mean by this is we're going to create a user that has everything let's give every single thing we can think of to this identity and then compare the",
    "start": "890720",
    "end": "896639"
  },
  {
    "text": "clicks um so in this example uh this identity it has multiple group memberships it has a permissions",
    "start": "896639",
    "end": "902320"
  },
  {
    "text": "boundary um we can see that group also grants it different attached policies um we give it tags from a credentials",
    "start": "902320",
    "end": "907680"
  },
  {
    "text": "perspective it has a login profile so it can log in interactively we have an MFA device to active access Keys SSH Keys",
    "start": "907680",
    "end": "914839"
  },
  {
    "text": "again uh get credentials uh key spaces even some signing certificates um now",
    "start": "914839",
    "end": "920320"
  },
  {
    "text": "the plane bagel has nothing no permissions uh not even a login profile so even less than our no permissions",
    "start": "920320",
    "end": "926320"
  },
  {
    "text": "users so if we were to compare CS looking at these different users what differences would we see well if we",
    "start": "926320",
    "end": "932759"
  },
  {
    "text": "click into the plane Bagel into the permissions tab of the IM uh dashboard uh we can see these events and then",
    "start": "932759",
    "end": "939120"
  },
  {
    "text": "plane everything bagel has just a few more events um if we were to compare also at the bottom we have a similar",
    "start": "939120",
    "end": "945800"
  },
  {
    "text": "scenario where that access key is mentioned uh to Andy's point it's like in the last example if keys are present",
    "start": "945800",
    "end": "950920"
  },
  {
    "text": "often times that will generate additional events but here's what's funny is that even the user agents are different in some of these those are two",
    "start": "950920",
    "end": "956440"
  },
  {
    "text": "different versions of the AWS internal user agent talking about the same key um so there's a lot of interesting dis I",
    "start": "956440",
    "end": "962639"
  },
  {
    "text": "wouldn't call them discrepancies but maybe some redundancies that we see and this is very very different across many",
    "start": "962639",
    "end": "967920"
  },
  {
    "text": "different Services uh at AWS which which makes sense there are many different teams that work on these different services and so even the kinds of",
    "start": "967920",
    "end": "974240"
  },
  {
    "text": "background events that occur or even kind of the style of how the front end and back end is programmed becomes a",
    "start": "974240",
    "end": "979560"
  },
  {
    "text": "little more evident as you spend a lot of time uh going through these different services and seeing how they're mapped",
    "start": "979560",
    "end": "984759"
  },
  {
    "text": "um but if we were just to compare these events for the everything bagel and plane Bagel user we'll see in the green",
    "start": "984759",
    "end": "989959"
  },
  {
    "text": "boxes are the common events um that are there no matter what and then in the yellow and uh purple we have uh the",
    "start": "989959",
    "end": "996480"
  },
  {
    "text": "optional events that are dependent on the context um if we click into the security",
    "start": "996480",
    "end": "1002040"
  },
  {
    "text": "credentials we'll see a pretty similar story um again most of these events all the ones in green are the common ones no",
    "start": "1002040",
    "end": "1007560"
  },
  {
    "text": "matter what and then purple uh are the different events U again uh in this case based on uh if an access key is present",
    "start": "1007560",
    "end": "1014199"
  },
  {
    "text": "for that user so we were talking about the differences between to IM IM users the",
    "start": "1014199",
    "end": "1020440"
  },
  {
    "text": "everything bagel and the uh plane Bagel but if we're trying to look at the",
    "start": "1020440",
    "end": "1026160"
  },
  {
    "text": "bigger picture let's just take a step back and see what's actually difference between doing some some of the previous",
    "start": "1026160",
    "end": "1032798"
  },
  {
    "text": "uh common events in CLI versus the console and for that we're we're going to look at from the AWS CLI perspective",
    "start": "1032799",
    "end": "1040678"
  },
  {
    "text": "the boto 3 and the uh console let's see what steps we need to produce we need to",
    "start": "1040679",
    "end": "1047438"
  },
  {
    "text": "create a user named Kiva create an access key and attach a user policy to",
    "start": "1047439",
    "end": "1053080"
  },
  {
    "text": "this user what events are generated in the cloud trail we have only three events that are generated and uh with",
    "start": "1053080",
    "end": "1060480"
  },
  {
    "text": "some differences between each other U uh speaking on user agent terms because the",
    "start": "1060480",
    "end": "1066200"
  },
  {
    "text": "Event Source and the event name uh are appended at the back of each user agent so that's what makes them uh different",
    "start": "1066200",
    "end": "1073559"
  },
  {
    "text": "going down to the boto 3 where we are doing the same exact steps create a user",
    "start": "1073559",
    "end": "1078919"
  },
  {
    "text": "create a access key and attach a user policy to it what events are generated the same three events with just one um",
    "start": "1078919",
    "end": "1086640"
  },
  {
    "text": "uh difference between the previous scenario because the user agent is simpler now because it's not different",
    "start": "1086640",
    "end": "1094720"
  },
  {
    "text": "across these actions moving down to the last uh scenario where we have the",
    "start": "1094720",
    "end": "1100159"
  },
  {
    "text": "console where things start to get intense now we're not just going to show",
    "start": "1100159",
    "end": "1105520"
  },
  {
    "text": "how much events uh will be uh occurring but we also do a breakdown of each click",
    "start": "1105520",
    "end": "1111039"
  },
  {
    "text": "that the user needs to make in order to recreate the same uh action we did earlier so buck up and let's see what's",
    "start": "1111039",
    "end": "1117840"
  },
  {
    "text": "going on the first click is the console home click or the homepage that we get redirected once we log into the console",
    "start": "1117840",
    "end": "1125679"
  },
  {
    "text": "so that account for 13 events generated now let's put that to the side and keep track of the total number of",
    "start": "1125679",
    "end": "1132440"
  },
  {
    "text": "events typing into the search bar or searching for the IM service holds one",
    "start": "1132440",
    "end": "1138840"
  },
  {
    "text": "for one event and immediately we get thrown at the IM dashboard for a total",
    "start": "1138840",
    "end": "1145080"
  },
  {
    "text": "of eight events so we have nine events going on there we have the IM user click",
    "start": "1145080",
    "end": "1150360"
  },
  {
    "text": "or the user breadcrumb uh underneath the IM service and that holds 18 events uh",
    "start": "1150360",
    "end": "1158000"
  },
  {
    "text": "generated and we're going to talk shortly about this uh worst C scenarios of clicking uh this breadcrumb and this",
    "start": "1158000",
    "end": "1166400"
  },
  {
    "text": "is a pretty good decent scenario since we had only three users available users uh to list so we have 80 events there",
    "start": "1166400",
    "end": "1174799"
  },
  {
    "text": "now we are starting the creation of the users so until now we haven't even started the uh process and we got 30",
    "start": "1174799",
    "end": "1182000"
  },
  {
    "text": "plus events create the create user button holds four events immediately",
    "start": "1182000",
    "end": "1187679"
  },
  {
    "text": "creating or U attaching a user policy to this user which has 15",
    "start": "1187679",
    "end": "1194039"
  },
  {
    "text": "events after this we uh is the final step of uh this user creation which has",
    "start": "1194039",
    "end": "1200000"
  },
  {
    "text": "three events and immediately we get redirected to the permission tab of this",
    "start": "1200000",
    "end": "1205240"
  },
  {
    "text": "newly created identity so 13 events there and surprisingly we have only one event generated from the create access",
    "start": "1205240",
    "end": "1212280"
  },
  {
    "text": "key action the user agents that were present are shown as we have only 10",
    "start": "1212280",
    "end": "1218440"
  },
  {
    "text": "events that are generated from our actual user browser and the other user agents consist of Health ews internal",
    "start": "1218440",
    "end": "1226919"
  },
  {
    "text": "and some different uh Java CLI user agents and if we were",
    "start": "1226919",
    "end": "1233120"
  },
  {
    "text": "down to look closely on them highlighted in green and yellow we'll see some differences between their versions so",
    "start": "1233120",
    "end": "1240039"
  },
  {
    "text": "for all of you threat Hunters over here who are trying to do some sort of statistical data or baselining on these",
    "start": "1240039",
    "end": "1246559"
  },
  {
    "text": "fields make sure to First do a good normal data normalization on them for",
    "start": "1246559",
    "end": "1253039"
  },
  {
    "text": "comparison three input events three output events for both AWS CLI and Botto 3 so very clean very simple and 73",
    "start": "1253039",
    "end": "1261360"
  },
  {
    "text": "events generated by those nine clicks that we did in the uh",
    "start": "1261360",
    "end": "1266840"
  },
  {
    "text": "console I mentioned the worst case scenario so here we go we thought it would be interesting to approach this",
    "start": "1266840",
    "end": "1272760"
  },
  {
    "text": "with a mathematical uh formula so for this particular click uh we have the",
    "start": "1272760",
    "end": "1278440"
  },
  {
    "text": "constant one which is referring to the Anchor uh event five * n where five is",
    "start": "1278440",
    "end": "1284000"
  },
  {
    "text": "the five grouping of events and N is the number of available users so we have 15",
    "start": "1284000",
    "end": "1289640"
  },
  {
    "text": "there and again the access keys where a user may contain zero up to two access",
    "start": "1289640",
    "end": "1294760"
  },
  {
    "text": "keys and in our case we had only two events for this so 18 in total but let's",
    "start": "1294760",
    "end": "1301880"
  },
  {
    "text": "increase the number of uh IM user and start listing them for 20 IM users we",
    "start": "1301880",
    "end": "1307600"
  },
  {
    "text": "get a total of 141 events let's try now 50 we have 3 51 events and now let's try",
    "start": "1307600",
    "end": "1314880"
  },
  {
    "text": "the maximum number of I am user in an account which is uh 100 and we get 701",
    "start": "1314880",
    "end": "1321000"
  },
  {
    "text": "events generated by that simple click we approached this uh with with other",
    "start": "1321000",
    "end": "1327919"
  },
  {
    "text": "services as well and we have the S3 service over here where if we have 100 buckets available and list them we'll",
    "start": "1327919",
    "end": "1335200"
  },
  {
    "text": "get 421 events generated back to you",
    "start": "1335200",
    "end": "1340240"
  },
  {
    "text": "Debo thank you so how do we make sense of all this noise you know we've gone through we have tons of Excel",
    "start": "1340240",
    "end": "1345960"
  },
  {
    "text": "spreadsheets we've consumed lots of coffee we've made tons of notes on all these different events and we've broken it out into the anchor events the",
    "start": "1345960",
    "end": "1351480"
  },
  {
    "text": "required events the optional events but really we're just trying to bring meaning to a messy situation and aggregate this knowledge so that we can",
    "start": "1351480",
    "end": "1357799"
  },
  {
    "text": "take all these input pieces of information and say these are when im am users was clicked or this is when a user",
    "start": "1357799",
    "end": "1364159"
  },
  {
    "text": "was created or here is when an access key was created and by the way we also want to be very particular about the events that we know are not associated",
    "start": "1364159",
    "end": "1371120"
  },
  {
    "text": "with input action and let's move those health events um out of the way so what's the solution mapping",
    "start": "1371120",
    "end": "1378960"
  },
  {
    "text": "um the way that we approach this problem is it kind of a two- pass approach the first pass is based on adding labels to",
    "start": "1378960",
    "end": "1384679"
  },
  {
    "text": "individual event evaluation um and then we go back and uh and evaluate all the neighboring labeled events and that's",
    "start": "1384679",
    "end": "1391159"
  },
  {
    "text": "where we have a concept of a signal being created and when we say signal we kind of mean like think of it like an alert or like a mapping a click has been",
    "start": "1391159",
    "end": "1398640"
  },
  {
    "text": "mapped to this uh grouping of events um so first how do we Define the signal um well we focus first on that",
    "start": "1398640",
    "end": "1406159"
  },
  {
    "text": "anchor event optional event and required event breakdown just like we showed in the previous uh slide and we also have",
    "start": "1406159",
    "end": "1412480"
  },
  {
    "text": "metadata about the event you know what's the bread crumb Trail how do you get to this click in the AWS Management console",
    "start": "1412480",
    "end": "1418799"
  },
  {
    "text": "what's the URL what's the summary and are there fields that should be uh dynamically updated based on the anchor",
    "start": "1418799",
    "end": "1424480"
  },
  {
    "text": "event or any of the optional events that are present uh in that click um and then we have additional options down at the",
    "start": "1424480",
    "end": "1430200"
  },
  {
    "text": "bottom for increasing or decreasing the look ahead and look behind uh when we're evaluating the signals for all the",
    "start": "1430200",
    "end": "1435320"
  },
  {
    "text": "neighboring labeled events um so pass number one is ADD adding labels so every single event is evaluated individually",
    "start": "1435320",
    "end": "1442159"
  },
  {
    "text": "and then based on very specifically specific criteria of user agent request parameters which ones are empty which",
    "start": "1442159",
    "end": "1447400"
  },
  {
    "text": "ones are not and to then say we're adding this label or as we can see here these labels are all being added in this",
    "start": "1447400",
    "end": "1453400"
  },
  {
    "text": "very particular order to this one event these labels will come back in the second pass um to then say let's now go",
    "start": "1453400",
    "end": "1460080"
  },
  {
    "text": "back through all the events and we're going to stop at every anchor event think of an anchor event like one of the required events so for every event we",
    "start": "1460080",
    "end": "1466559"
  },
  {
    "text": "evaluate all the labels if any of those labels said hey my definition says this is an anchor event for my scenario now",
    "start": "1466559",
    "end": "1473240"
  },
  {
    "text": "that has received the anchor event equals true flag so we go to Second pass every event we stop at every anchor",
    "start": "1473240",
    "end": "1479559"
  },
  {
    "text": "event and then we take that anchor event it labels and we go label by label and then we evaluate the signal logic so",
    "start": "1479559",
    "end": "1485640"
  },
  {
    "text": "each label will say my logic says go backwards 3 seconds and forwards 10 seconds and look at every single event",
    "start": "1485640",
    "end": "1490720"
  },
  {
    "text": "that also contains the same label pull all those things together and then evaluate that against the signal if all",
    "start": "1490720",
    "end": "1495960"
  },
  {
    "text": "the criteria is met uh then create a signal for this and then Mark all these",
    "start": "1495960",
    "end": "1501279"
  },
  {
    "text": "events as accounted for they have contributed to a signal they cannot contribute to another signal and that's how we group those together um there's a",
    "start": "1501279",
    "end": "1509039"
  },
  {
    "text": "long list of additional things that we thought would be cool to do most of them are things we just had to do there were so many weird situations that we had to",
    "start": "1509039",
    "end": "1516520"
  },
  {
    "text": "account for um so as you saw in the signal definition we can dynamically modify the URL the summary we basically",
    "start": "1516520",
    "end": "1522840"
  },
  {
    "text": "want to provide as much uh easy to consume information to the users as possible so you can literally see if",
    "start": "1522840",
    "end": "1528640"
  },
  {
    "text": "they clicked on the everything bagel user here's the exact URL that has that information uh if they clicked on IM users and it was those uh 100 users then",
    "start": "1528640",
    "end": "1535960"
  },
  {
    "text": "we want to list those 100 users or list the access Keys associated with them um all this extracted information we use to",
    "start": "1535960",
    "end": "1542159"
  },
  {
    "text": "update the summary or the URL we also have an uh Json object called it additional data so you can always",
    "start": "1542159",
    "end": "1548720"
  },
  {
    "text": "programmatically access all the information that we gathered for these signals and we actually do that too",
    "start": "1548720",
    "end": "1553840"
  },
  {
    "text": "because in the last bullet point we have the ability to do look backs um so sometimes",
    "start": "1553840",
    "end": "1558960"
  },
  {
    "text": "when we get to a certain signal we might look back and say actually we need to modify that last signal based on what",
    "start": "1558960",
    "end": "1564200"
  },
  {
    "text": "our current signal is other times the current signal could happen in four or five different places in the Management",
    "start": "1564200",
    "end": "1569399"
  },
  {
    "text": "console so we need to know what's the last signal that just happened within the last 10 seconds um if that was I am",
    "start": "1569399",
    "end": "1574919"
  },
  {
    "text": "users create user then I need to basically pull information from that signal um like what's the username or",
    "start": "1574919",
    "end": "1580559"
  },
  {
    "text": "what's the username of that we're adding a key2 or something like that we also have the capability of merging existing",
    "start": "1580559",
    "end": "1586000"
  },
  {
    "text": "signals this is important for very long running um long running signals where we don't want to define a super long look",
    "start": "1586000",
    "end": "1591240"
  },
  {
    "text": "ahead but we can basically merge adjacent signals um that are identical and have matching uh extracted data um",
    "start": "1591240",
    "end": "1598159"
  },
  {
    "text": "and so yeah there's a lot of there's a lot of weird tricks that we had to do uh still give give us some headaches to this day but it's pretty cool um it was",
    "start": "1598159",
    "end": "1604559"
  },
  {
    "text": "really a fun uh fun problem to try to solve um so enough talking enough slides",
    "start": "1604559",
    "end": "1610080"
  },
  {
    "text": "let's actually look at a demo so we have two quick demo videos here um and so for the first one we're",
    "start": "1610080",
    "end": "1616880"
  },
  {
    "text": "basically just going to uh if we can go and play that we're basically just going to walk through uh what like how does",
    "start": "1616880",
    "end": "1622440"
  },
  {
    "text": "this all start well a user logs into the Management console and starts to click on some things um so uh we're going to go really",
    "start": "1622440",
    "end": "1629880"
  },
  {
    "text": "really fast to cover a couple different examples so if a user goes in uh they've signed in the console home they clicked",
    "start": "1629880",
    "end": "1635559"
  },
  {
    "text": "the IM service they've listed some user groups uh they clicked on users to list them and let's just choose a user in",
    "start": "1635559",
    "end": "1640960"
  },
  {
    "text": "this case Zero Petula uh we had clicked on the permissions tab security credentials in this case let's actually",
    "start": "1640960",
    "end": "1646720"
  },
  {
    "text": "let's let's enable a login profile hackers like to do this so now this identity can go in and access the console maybe we want to create an",
    "start": "1646720",
    "end": "1653120"
  },
  {
    "text": "access key for ourselves well there's already two perfect deactivate one delete it and now let's go and create a",
    "start": "1653120",
    "end": "1659080"
  },
  {
    "text": "new access key for ourselves uh and these are precisely some of the steps we see attackers do uh once they log into a",
    "start": "1659080",
    "end": "1664559"
  },
  {
    "text": "console session um so now we have given ourselves a login profile uh we have",
    "start": "1664559",
    "end": "1669960"
  },
  {
    "text": "created an access key next let's go to Secrets manager let's start to enumerate some secrets and see uh what's available",
    "start": "1669960",
    "end": "1675440"
  },
  {
    "text": "what values might I be able to extract from this environment another thing that we see attackers do um in this case there's only five Secrets um so we'll",
    "start": "1675440",
    "end": "1681919"
  },
  {
    "text": "click on this one open uh we'll look at the overview page and then we'll click on um the uh retrieve secret value so",
    "start": "1681919",
    "end": "1688919"
  },
  {
    "text": "that we can uh look at that secret but you know what this is kind of boring let's actually open up cloudshell just",
    "start": "1688919",
    "end": "1694000"
  },
  {
    "text": "like real attackers do and let's programmatically extract all these values into a file called secrets. Json",
    "start": "1694000",
    "end": "1699600"
  },
  {
    "text": "and then conveniently we can just click and download that file out of the console all these actions are recorded in very different ways and pulling these",
    "start": "1699600",
    "end": "1706000"
  },
  {
    "text": "all together was another great headache but as you'll see in the next video in just a minute uh it's pretty pretty neat",
    "start": "1706000",
    "end": "1711640"
  },
  {
    "text": "to see how all this can come together in a readable fashion so there's our downloaded file next let's go to the S3",
    "start": "1711640",
    "end": "1717000"
  },
  {
    "text": "service um who doesn't like to look at some buckets um so uh we're basically going to list at some buckets um and",
    "start": "1717000",
    "end": "1723279"
  },
  {
    "text": "then uh we're going to choose one in particular um to click into and so kind of keep in mind these different names that we're clicking into so zero flea",
    "start": "1723279",
    "end": "1729760"
  },
  {
    "text": "bucket we clicked on the objects tab permissions management access points um and then lastly let's go to ec2 um this",
    "start": "1729760",
    "end": "1736360"
  },
  {
    "text": "is one of my favorites um the EC dashboard is not super uh interesting from a volume perspective but that",
    "start": "1736360",
    "end": "1741919"
  },
  {
    "text": "second one there ec2 global view this thing takes so long to run there's literally a status bar so you get really",
    "start": "1741919",
    "end": "1748200"
  },
  {
    "text": "interested in how many events are actually being generated behind here the answer is over 300 just for this one click and we don't even have any ec2",
    "start": "1748200",
    "end": "1754679"
  },
  {
    "text": "instances in this environment um so it's pretty uh pretty fun to watch so in the next video we'll see uh is let's",
    "start": "1754679",
    "end": "1761200"
  },
  {
    "text": "actually do something with these event logs um uh you can actually query event logs directly in the API and pipe them",
    "start": "1761200",
    "end": "1766679"
  },
  {
    "text": "into the our tool um in this case we've actually downloaded this session and put it in the demo folder of the project um",
    "start": "1766679",
    "end": "1772880"
  },
  {
    "text": "and so we're just going to pipe that into add signal which is adding the labels to the individual events it's doing that second pass in generating",
    "start": "1772880",
    "end": "1779000"
  },
  {
    "text": "signals based on the aggregation of that data let's just look at a couple of these and convert to Json real quick so you can kind of see that we contain the",
    "start": "1779000",
    "end": "1785159"
  },
  {
    "text": "original event and we also contain the enrichment object on top of it in this case this event wasn't part of a signal",
    "start": "1785159",
    "end": "1791159"
  },
  {
    "text": "so let's actually add update our query to look for some examples where a signal was generated so we'll call this a",
    "start": "1791159",
    "end": "1796600"
  },
  {
    "text": "signal bearing event so so this event is I am list users should look familiar uh and then our signal here is really big",
    "start": "1796600",
    "end": "1803559"
  },
  {
    "text": "uh it is saying I am users was clicked um and by the way it was 33 users that were shown here are the users 62 access",
    "start": "1803559",
    "end": "1810200"
  },
  {
    "text": "keys at this time were present with those identities and here they are here's the URL and all that data we extracted is again in that additional",
    "start": "1810200",
    "end": "1816200"
  },
  {
    "text": "data blob so you can programmatically access it however you want so we have some interesting context about this environment without needing any",
    "start": "1816200",
    "end": "1822000"
  },
  {
    "text": "additional API calls just from this offline log analysis um next we're going",
    "start": "1822000",
    "end": "1827559"
  },
  {
    "text": "to do event summary um this is going to show all these events colorcoded to see which ones were actually part of a",
    "start": "1827559",
    "end": "1832600"
  },
  {
    "text": "signal and then we can see the signal on top of each one pointing down and this gives us a little slightly better view",
    "start": "1832600",
    "end": "1838039"
  },
  {
    "text": "into what the signals were um any extracted values are highlighted in green as well but let's look at this one this is that Secrets manager where we",
    "start": "1838039",
    "end": "1844240"
  },
  {
    "text": "clicked on the open y user um so here uh we can see it's these four events let's actually add a little more detail and so",
    "start": "1844240",
    "end": "1850279"
  },
  {
    "text": "let's say show me details about each of those events so now all four have a detailed block underneath um so that",
    "start": "1850279",
    "end": "1855559"
  },
  {
    "text": "first one is the anchor event that was evaluated for and we can see it had four labels the first two labels the look",
    "start": "1855559",
    "end": "1860639"
  },
  {
    "text": "ahead look behinds failed the third one was successful and we'll see all the other events were also successful for that label that's why they were grouped",
    "start": "1860639",
    "end": "1866960"
  },
  {
    "text": "together as part of this mapping and then anything in purple these are really helpful values for creating the labels",
    "start": "1866960",
    "end": "1872480"
  },
  {
    "text": "um the request parameters all that stuff and so we wanted to make it easy to use um whenever you're uh debugging or",
    "start": "1872480",
    "end": "1878159"
  },
  {
    "text": "adding new uh new data to see what are the precise request parameters in user agents I need to Define if I want these",
    "start": "1878159",
    "end": "1883720"
  },
  {
    "text": "events to be part of a new or existing um signal last lastly is a session summary so just give to me one line how",
    "start": "1883720",
    "end": "1891080"
  },
  {
    "text": "many events contributed to this line and then what are events that did not contribute to a signal so we can kind of see at a high level again the extracting",
    "start": "1891080",
    "end": "1898159"
  },
  {
    "text": "information um is highlighted in a different color and then at the bottom uh we have some stats just on the number",
    "start": "1898159",
    "end": "1904200"
  },
  {
    "text": "of labeled events mapped events as well as what services were involved in the mappings and then for all the unmapped events what were the services that were",
    "start": "1904200",
    "end": "1910080"
  },
  {
    "text": "involved six minutes um and that is our session we were already motivated to do",
    "start": "1910080",
    "end": "1916639"
  },
  {
    "text": "some front end uh stuff in order to give the you a more friendly approach so here",
    "start": "1916639",
    "end": "1921919"
  },
  {
    "text": "we are with our UI visualizer we have uh three additional buttons at the top",
    "start": "1921919",
    "end": "1927360"
  },
  {
    "text": "right corner where you can click the maap to get the mapped events the unmapped events Etc the table view is",
    "start": "1927360",
    "end": "1934360"
  },
  {
    "text": "supported with Dash AG grid so you have that all these cool features of AG grid like uh filtering uh based on different",
    "start": "1934360",
    "end": "1941880"
  },
  {
    "text": "conditionals um rearranging the columns also um even sorting on different",
    "start": "1941880",
    "end": "1948200"
  },
  {
    "text": "columns we also gave a search filter where you can uh search as you type and",
    "start": "1948200",
    "end": "1953960"
  },
  {
    "text": "get U the view from all of the uh Fields also uh instantly G uh getting the uh",
    "start": "1953960",
    "end": "1962000"
  },
  {
    "text": "information on the place holder above it for in two uh different perspectives from the events and the total number of",
    "start": "1962000",
    "end": "1971200"
  },
  {
    "text": "rows all right so if we can go back to the slides um that that's the Tool uh we've spent uh almost a year developing",
    "start": "1971360",
    "end": "1977960"
  },
  {
    "text": "in this with many many hundreds of hours and again I think my eyes are still red from looking all those Excel uh",
    "start": "1977960",
    "end": "1983360"
  },
  {
    "text": "spreadsheets um so we're really excited to announce that this tool is now uh uh officially live we'll have the link on",
    "start": "1983360",
    "end": "1989200"
  },
  {
    "text": "the next slide but let's wrap this up what are the three takeaways here uh console sessions still matter attackers",
    "start": "1989200",
    "end": "1995600"
  },
  {
    "text": "still use them and probably more importantly for most organizations is normal users use them you still have to",
    "start": "1995600",
    "end": "2000799"
  },
  {
    "text": "look at that activity and know is this normal user activity actually normal um is it something that we should be",
    "start": "2000799",
    "end": "2006080"
  },
  {
    "text": "concerned about uh and we seek to bring Clarity into those situations uh through this tool um the second is understanding",
    "start": "2006080",
    "end": "2013000"
  },
  {
    "text": "what your Cloud logging options are uh what are the limitations uh what are the attention uh issues do you need more",
    "start": "2013000",
    "end": "2019120"
  },
  {
    "text": "attention uh from a policy perspective uh what tooling do you have available to look through these logs and are you",
    "start": "2019120",
    "end": "2024159"
  },
  {
    "text": "doing anything with it do you have the Personnel or the capabilities to make sense of what's in the logs um lastly is",
    "start": "2024159",
    "end": "2030480"
  },
  {
    "text": "uh We've released this tool so that the community can use it and hopefully benefit from it and even add your own signal mappings to it um to to basically",
    "start": "2030480",
    "end": "2037440"
  },
  {
    "text": "help it' be a more robust uh uh capability for uh for the community um",
    "start": "2037440",
    "end": "2043440"
  },
  {
    "text": "and uh with that we just want to say thank you so much for your time uh thank you for your patience uh with it with the delay earlier and uh this has been a",
    "start": "2043440",
    "end": "2049760"
  },
  {
    "text": "lot of fun for us um and uh here's the URL to The Tool uh and here's our social",
    "start": "2049760",
    "end": "2055040"
  },
  {
    "text": "media information we'd love to before we ask for questions we'd love just to say always feel free to reach out whether",
    "start": "2055040",
    "end": "2060520"
  },
  {
    "text": "it's in this room uh if you see us walking around we have some fun stickers to give out um but but yeah we definitely appreciate talking with the",
    "start": "2060520",
    "end": "2066560"
  },
  {
    "text": "community and so look forward to saying hello uh and with that thank you so much for your",
    "start": "2066560",
    "end": "2072020"
  },
  {
    "text": "[Applause] time any brave souls for some",
    "start": "2072020",
    "end": "2078240"
  },
  {
    "text": "questions yes I think there's microphones in the aisle there thank you guys um thanks for being here um I am",
    "start": "2078240",
    "end": "2086679"
  },
  {
    "text": "background I am a threat detection response cyber security analyst so um I",
    "start": "2086679",
    "end": "2092358"
  },
  {
    "text": "am the ones that benefit from your kind of work um but one question I do have",
    "start": "2092359",
    "end": "2098160"
  },
  {
    "text": "um we often have to disable some alerts SL signals based on the amount of false",
    "start": "2098160",
    "end": "2103520"
  },
  {
    "text": "positive alerts that we have So based on your work here what have you found that can decrease the number of false",
    "start": "2103520",
    "end": "2109520"
  },
  {
    "text": "positives without increasing the risk of missing true positives yeah that that's a that's a",
    "start": "2109520",
    "end": "2115320"
  },
  {
    "text": "great question so nice nice to meet a fellow Defender so um yeah the question was like how does our tool help reduce",
    "start": "2115320",
    "end": "2120640"
  },
  {
    "text": "false false positives um so what I would say is our tool seeks to bring Clarity to a lot of events and give you an",
    "start": "2120640",
    "end": "2126640"
  },
  {
    "text": "information on what that event was um if in in uh I don't want to do any vendor",
    "start": "2126640",
    "end": "2131920"
  },
  {
    "text": "bashing um but for example if we were talking about guard Duty alerts in AWS this is precisely the kind of scenario",
    "start": "2131920",
    "end": "2137839"
  },
  {
    "text": "that we see a lot of false positives with when a console session occurs because there's all these crazy events that have never happened before a lot of",
    "start": "2137839",
    "end": "2143960"
  },
  {
    "text": "them are related to I am and a lot of those guard Duty alerts will say anomalous IAM privilege escalation stuff",
    "start": "2143960",
    "end": "2149520"
  },
  {
    "text": "and the reality was you just click to view some users like that that's it um so our tool does not directly change any",
    "start": "2149520",
    "end": "2156680"
  },
  {
    "text": "alerts in fact all the mappings are not we don't view them as alerts we view them as a simplified way to say instead of there's a thousand events there's 45",
    "start": "2156680",
    "end": "2163839"
  },
  {
    "text": "events there's 45 clicks that occurred and now you can kind of decide um is this is this normal or not um uh and so",
    "start": "2163839",
    "end": "2171000"
  },
  {
    "text": "in some ways the way that guard duty is uh I'm assuming baselining the activity we kind of view I mean we view that uh",
    "start": "2171000",
    "end": "2178520"
  },
  {
    "text": "in our team as how can we Baseline these clicks instead of baselining individually hundreds of events how",
    "start": "2178520",
    "end": "2183760"
  },
  {
    "text": "often was IM users clicked how often was S3 buckets permissions clicked or object or management um so this does not change",
    "start": "2183760",
    "end": "2191599"
  },
  {
    "text": "noisy alerts from other tools but hopefully even in the light of those noisy alerts you have a little better uh",
    "start": "2191599",
    "end": "2197599"
  },
  {
    "text": "read readable way to look at that information to say was there really something interesting going on in the session or were they just clicking",
    "start": "2197599",
    "end": "2202680"
  },
  {
    "text": "around uh looking at some users and buckets and stuff like that um I I hope that at least partially answered your",
    "start": "2202680",
    "end": "2208240"
  },
  {
    "text": "question but thank you great question by the way yes hey guys uh awesome work by the",
    "start": "2208240",
    "end": "2215599"
  },
  {
    "text": "way um so I just wanted to ask like obviously Cloud renders they don't come to you and say like okay we made a",
    "start": "2215599",
    "end": "2220920"
  },
  {
    "text": "change to our loging things have changed so update your detection so I I haven't",
    "start": "2220920",
    "end": "2226280"
  },
  {
    "text": "quite caught how you guys like you know is the signal creation process is quite manual at the moment have you guys",
    "start": "2226280",
    "end": "2232240"
  },
  {
    "text": "considered maybe automating it and if you had what was the some of the channel challenges you guys",
    "start": "2232240",
    "end": "2238599"
  },
  {
    "text": "found would you say it's pretty manual I mean yeah yeah yeah the question you",
    "start": "2238599",
    "end": "2244720"
  },
  {
    "text": "around is there any way that we can automate some of this because you all right it is a very manual process today I would say some of that manual process",
    "start": "2244720",
    "end": "2251000"
  },
  {
    "text": "probably is like uh quite personally my level of OCD and wanting to understand truly all the differences because we",
    "start": "2251000",
    "end": "2256480"
  },
  {
    "text": "don't just want to group logs we want to say what are the unique values from those logs we can pull out and say these are important context um but but even",
    "start": "2256480",
    "end": "2264160"
  },
  {
    "text": "some of the mappings we did a year ago and then retested some of them now some of those had slight differences like",
    "start": "2264160",
    "end": "2269359"
  },
  {
    "text": "like the ec2 service uh where it used to log a certain event as the AWS internal user agent now logs your web browser",
    "start": "2269359",
    "end": "2275520"
  },
  {
    "text": "user agent in some of those clicks um so I think there will always be those kinds of scenarios to to manually catch up um",
    "start": "2275520",
    "end": "2280920"
  },
  {
    "text": "Andy I know one of the first things you did was actually I think your first uh one of your first approaches was to have",
    "start": "2280920",
    "end": "2286200"
  },
  {
    "text": "like a a browser Plugin or something looking for the request but but I think kind of the pong scenario was there's",
    "start": "2286200",
    "end": "2291599"
  },
  {
    "text": "only so much you can see browser side that ball gets bouncing around in the cloud uh and generating all those logs",
    "start": "2291599",
    "end": "2296760"
  },
  {
    "text": "that are absent from that view so uh we are certainly open for suggestions if there are uh more automated ways to do",
    "start": "2296760",
    "end": "2302440"
  },
  {
    "text": "it uh and would love to spare people some pain from all those uh uh blinding Excel spreadsheets for our for our",
    "start": "2302440",
    "end": "2309160"
  },
  {
    "text": "tracking yeah would love to hear your ideas if you have some around that but great question perfect sounds great thank",
    "start": "2309160",
    "end": "2316359"
  },
  {
    "text": "you any other questions awesome well thank you again",
    "start": "2316359",
    "end": "2321880"
  },
  {
    "text": "for your time and we'll be around uh if you see us say hello and thank you again have a great day",
    "start": "2321880",
    "end": "2327030"
  },
  {
    "text": "[Applause]",
    "start": "2327030",
    "end": "2331039"
  }
]