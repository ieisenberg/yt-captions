[
  {
    "text": "[Music]",
    "start": "5350",
    "end": "16909"
  },
  {
    "text": "welcome to black hat window security conference 2002 held February 7th through the 9th in New Orleans",
    "start": "18199",
    "end": "25320"
  },
  {
    "text": "Louisiana the following videotape was recorded live at the conference and produced by the sound of knowledge",
    "start": "25320",
    "end": "31620"
  },
  {
    "text": "[Music]",
    "start": "31620",
    "end": "41189"
  },
  {
    "text": "Incorporated we'll probably go ahead and get started I was going to see if a couple more people might come in so it",
    "start": "41399",
    "end": "47480"
  },
  {
    "text": "doesn't look so sparse but I actually kind of like these smaller intimate groups we can uh kind of whiz through",
    "start": "47480",
    "end": "53800"
  },
  {
    "text": "some stuff and we'll have some I think some time for some specific questions and answers and looks like we will have",
    "start": "53800",
    "end": "60719"
  },
  {
    "text": "time for something that uh we may not have had time for before anyway welcome to black hat it's actually almost over",
    "start": "60719",
    "end": "67240"
  },
  {
    "text": "so a little late for the welcome my name is Tim Mullen I work at a company called anoris where we attempt to design secure",
    "start": "67240",
    "end": "77320"
  },
  {
    "text": "accounting software it's actually a little bit more exciting than it sounds but I won't bore you with all of that",
    "start": "77320",
    "end": "83479"
  },
  {
    "text": "what we're going to talk about today is the secure development of web-based",
    "start": "83479",
    "end": "89320"
  },
  {
    "text": "applications we're going to get into mostly code in this session uh we had a training",
    "start": "89320",
    "end": "95720"
  },
  {
    "text": "specifically on this which was a full day training and",
    "start": "95720",
    "end": "101360"
  },
  {
    "text": "it included some host hardening parameters and things of that nature but I think what we're going to do here is pretty much concentrate on the code",
    "start": "101360",
    "end": "107880"
  },
  {
    "text": "aspect of things and kind of give you guys a good idea of how to or or at",
    "start": "107880",
    "end": "115000"
  },
  {
    "text": "least an initial concept I think of how to properly design your web-based",
    "start": "115000",
    "end": "120200"
  },
  {
    "text": "applications so that you can mitigate possible exposure due to SQL",
    "start": "120200",
    "end": "125840"
  },
  {
    "text": "injection uh URL manipulation things of that nature as the slide",
    "start": "125840",
    "end": "131959"
  },
  {
    "text": "says the development of our Marketplace whatever the market actually might be constantly",
    "start": "131959",
    "end": "139680"
  },
  {
    "text": "pushes our developers to increase features on the web for our clients for",
    "start": "139680",
    "end": "145319"
  },
  {
    "text": "anonymous clients as well as authenticated clients coming in to view content on our website it sites post",
    "start": "145319",
    "end": "151040"
  },
  {
    "text": "content to our websites Etc even with the most advanced firewalls",
    "start": "151040",
    "end": "159760"
  },
  {
    "text": "the most up-to-date patches on our",
    "start": "159760",
    "end": "164959"
  },
  {
    "text": "servers an improperly designed web form and an improperly sanitized user input",
    "start": "164959",
    "end": "172200"
  },
  {
    "text": "that's acted upon can really open the door wide open for compromise in these",
    "start": "172200",
    "end": "178560"
  },
  {
    "text": "environments before we jump into",
    "start": "178560",
    "end": "185959"
  },
  {
    "text": "everything I'm going to tell you a little joke so there these two guys best",
    "start": "185959",
    "end": "192360"
  },
  {
    "text": "buddies they're out in the mountains camping the Montana",
    "start": "192360",
    "end": "197720"
  },
  {
    "text": "say rough day of fish and they're all sacked out in their tent and all of a sudden this grizzly bear comes into the",
    "start": "197720",
    "end": "203640"
  },
  {
    "text": "Camp starts ripping everything up Furious the guy peers out the tent he",
    "start": "203640",
    "end": "209959"
  },
  {
    "text": "going holy crap I'm getting out of here runs into his to his bag starts lacing",
    "start": "209959",
    "end": "215920"
  },
  {
    "text": "up his shoes and his other friend goes what the hell are you doing you're never going to",
    "start": "215920",
    "end": "221799"
  },
  {
    "text": "outrun that bear and he says I don't have to I just have to outrun",
    "start": "221799",
    "end": "229319"
  },
  {
    "text": "you that's very much what security is like today is",
    "start": "230400",
    "end": "237760"
  },
  {
    "text": "attackers will most often go for the low hanging fruit the slowest developer out",
    "start": "237760",
    "end": "243599"
  },
  {
    "text": "there so what we're going to do is hopefully give you the tools in which to",
    "start": "243599",
    "end": "250120"
  },
  {
    "text": "get you a couple of steps ahead of the next guy so if anybody's looking for a sight to hack unless they've",
    "start": "250120",
    "end": "256639"
  },
  {
    "text": "specifically targeted you in which case you're in bad shape hopefully these tools will give",
    "start": "256639",
    "end": "263320"
  },
  {
    "text": "you the ability to be a couple of steps ahead and they'll stop and eat him while you continue on down the path",
    "start": "263320",
    "end": "270240"
  },
  {
    "text": "let's go over an overview I'm going to exit out of this guy",
    "start": "270240",
    "end": "277759"
  },
  {
    "text": "here what we have is a real estate application that",
    "start": "279120",
    "end": "285880"
  },
  {
    "text": "we wrote we're all on the same development team now okay we're all part of the IT",
    "start": "285880",
    "end": "294080"
  },
  {
    "text": "department at www.realestate.com located in sucka fool California",
    "start": "294080",
    "end": "300160"
  },
  {
    "text": "now there actually is a real www.realestate.com",
    "start": "300160",
    "end": "305240"
  },
  {
    "text": "okay I just chose the name no way all characters are",
    "start": "305240",
    "end": "310960"
  },
  {
    "text": "fictitious and any resemblance to anyone alive or de is purely coincidental so let's not and if anybody",
    "start": "310960",
    "end": "318080"
  },
  {
    "text": "happens to work for real estate.com please don't sue me I don't have any money anyway okay so what we're going to",
    "start": "318080",
    "end": "325080"
  },
  {
    "text": "go over is some common vulnerabilities client side HTML URL manipulation SQL",
    "start": "325080",
    "end": "330919"
  },
  {
    "text": "injection and then we're going to go over the counter measures most of the black hat sessions",
    "start": "330919",
    "end": "337319"
  },
  {
    "text": "typically a lot of them anyway are focused on the exploit side of things right we show you how to break in we",
    "start": "337319",
    "end": "345240"
  },
  {
    "text": "show you how to break things that are supposed to be unbreakable plug for Lichfield",
    "start": "345240",
    "end": "352639"
  },
  {
    "text": "there and uh basically give you the tools to do",
    "start": "352680",
    "end": "358080"
  },
  {
    "text": "this kind of thing what I want to do here is kind of give you the counter measures CU to me that's what's what's really important it's fine to show you",
    "start": "358080",
    "end": "365280"
  },
  {
    "text": "that SQL injection can be done but at the same time we need to be responsible and show you how to protect yourself",
    "start": "365280",
    "end": "370840"
  },
  {
    "text": "from it and then if we have time and the network is up I'll show you a couple of",
    "start": "370840",
    "end": "376680"
  },
  {
    "text": "vulnerabilities some uh real life real world scenarios I'm a little torn about doing",
    "start": "376680",
    "end": "383319"
  },
  {
    "text": "that publicly now because the one that I was going to use an example turned out to be worse than I thought it was and",
    "start": "383319",
    "end": "389880"
  },
  {
    "text": "during our class we saw that you could do something really bad and I don't know if I want to publicize that now but",
    "start": "389880",
    "end": "395720"
  },
  {
    "text": "we'll burn that bridge when we get to it",
    "start": "395720",
    "end": "401360"
  },
  {
    "text": "specifically the client side now we did that clients side HTML",
    "start": "401360",
    "end": "410160"
  },
  {
    "text": "issues the easiest way for us to get information from a user is to build a web form right where Joe Blow anonymous",
    "start": "410960",
    "end": "419599"
  },
  {
    "text": "user comes to the website he's going to uh give us some data and we're going to",
    "start": "419599",
    "end": "426639"
  },
  {
    "text": "access a backend server that will perform some sort of operation using his",
    "start": "426639",
    "end": "432000"
  },
  {
    "text": "input right in this case what we're going to do is provide the user with the ability",
    "start": "432000",
    "end": "441400"
  },
  {
    "text": "to pull up listings meaning uh they want to search",
    "start": "441400",
    "end": "448639"
  },
  {
    "text": "for homes to buy so I've already lost chip chip come",
    "start": "448639",
    "end": "455039"
  },
  {
    "text": "back so what we're going to do here is just run through it real quick right now",
    "start": "455680",
    "end": "461360"
  },
  {
    "text": "this search is kind of broken we're still developing here I just give you a little heads up what we're going to do",
    "start": "461360",
    "end": "467080"
  },
  {
    "text": "is go through kind of like a bad better best scenario so we're going to graduate",
    "start": "467080",
    "end": "475720"
  },
  {
    "text": "our code that we use to do this showing you the worst possible thing you can do and hopefully we'll arrive at what one",
    "start": "475720",
    "end": "483319"
  },
  {
    "text": "of the better ways of doing this is so just to illustrate I can go up here and",
    "start": "483319",
    "end": "488479"
  },
  {
    "text": "select any of these areas I'm going to select trucky these happen to be places in Lake Tahoe I'm going to say search",
    "start": "488479",
    "end": "496280"
  },
  {
    "text": "and hopefully good I should have checked that before I started the class my SQL Server could have been dead from",
    "start": "496280",
    "end": "501360"
  },
  {
    "text": "something earlier so what we'll see here is I've selected an",
    "start": "501360",
    "end": "506479"
  },
  {
    "text": "area and it's given me a result set back",
    "start": "506479",
    "end": "512399"
  },
  {
    "text": "okay laser pointer fun with cats at home",
    "start": "512399",
    "end": "518399"
  },
  {
    "text": "okay particularly after drinking vodka yeah after the cat is drinking vodka I",
    "start": "518399",
    "end": "524120"
  },
  {
    "text": "mean okay so you see it shows us has 27 properties some some blah blah",
    "start": "524120",
    "end": "529959"
  },
  {
    "text": "information over here and now as a customer I can go back and I have these",
    "start": "529959",
    "end": "536800"
  },
  {
    "text": "little info links so basically what we've done is designed",
    "start": "536800",
    "end": "542200"
  },
  {
    "text": "a form that takes this user's input executes a query on our SQL Server",
    "start": "542200",
    "end": "548760"
  },
  {
    "text": "over here and if we look up at the top obviously in a production environment",
    "start": "548760",
    "end": "553839"
  },
  {
    "text": "we're not going to have this but if you look up at the top you'll see what my SQL statement is I return it just for",
    "start": "553839",
    "end": "559880"
  },
  {
    "text": "purposes of discussion here we'll see that it's selecting the MLS number the address city state and",
    "start": "559880",
    "end": "566360"
  },
  {
    "text": "zip or city state area type price marks an our listing from listings where the",
    "start": "566360",
    "end": "572040"
  },
  {
    "text": "status is zero and the area equals one so let's just take a look at the",
    "start": "572040",
    "end": "579959"
  },
  {
    "text": "code the user side",
    "start": "579959",
    "end": "585040"
  },
  {
    "text": "code that does this here's all my fancy mouseovers and stuff because I wanted it to be you know not just some crappy",
    "start": "585560",
    "end": "592120"
  },
  {
    "text": "little form right what we see here",
    "start": "592120",
    "end": "601320"
  },
  {
    "text": "does the laser pointer bother people or does it help you anyone that that bothers okay good because if so I was",
    "start": "603720",
    "end": "611560"
  },
  {
    "text": "going to get you okay um we see what we're going to do here is post this",
    "start": "611560",
    "end": "616720"
  },
  {
    "text": "information of the form into a script called get data right here is that little drop-",
    "start": "616720",
    "end": "622440"
  },
  {
    "text": "down box is everybody familiar with clients side HTML programming forms everybody does this all day long right",
    "start": "622440",
    "end": "630160"
  },
  {
    "text": "so the reason that we've done it like this we've done two things here as a development team that we thought was",
    "start": "630160",
    "end": "635279"
  },
  {
    "text": "going to be smart we're using post methods which hide the data from the URL",
    "start": "635279",
    "end": "640920"
  },
  {
    "text": "as it's getting posted to the web server right so we don't have all these parameters stuck up there in the URL",
    "start": "640920",
    "end": "647120"
  },
  {
    "text": "that would be there for get request and the other thing that we've done is explicitly limited what options the",
    "start": "647120",
    "end": "652680"
  },
  {
    "text": "person can select so they can't do anything else right well of course that's incorrect but that's what we're",
    "start": "652680",
    "end": "659680"
  },
  {
    "text": "thinking at the time so we know going in that this is the only thing that the",
    "start": "659680",
    "end": "664720"
  },
  {
    "text": "people can select I'll select the uh West Shore area select all properties we",
    "start": "664720",
    "end": "672079"
  },
  {
    "text": "now see that an area equals three area equals 3 everything else stays the same",
    "start": "672079",
    "end": "678079"
  },
  {
    "text": "so really all this client side HTML form has done is posted a variable called area to the get data ASP file right easy",
    "start": "678079",
    "end": "688160"
  },
  {
    "text": "stuff well let's take a look on the server side and see exactly what's going on",
    "start": "688160",
    "end": "693720"
  },
  {
    "text": "there let me get into my real that's not it that's",
    "start": "694120",
    "end": "700839"
  },
  {
    "text": "it in my scripts directory let's just take a look at get",
    "start": "702000",
    "end": "707440"
  },
  {
    "text": "data yes it loads in front page don't laugh at me I just said don't laugh at me",
    "start": "707440",
    "end": "714800"
  },
  {
    "text": "David the reason is is because like if I showed you this in net visual interdev",
    "start": "714800",
    "end": "721399"
  },
  {
    "text": "or whatever it might be you know I don't want you to have to see this done in some program that you're going to have to go out and buy everybody has front",
    "start": "721399",
    "end": "727360"
  },
  {
    "text": "page so if we're going to change stuff and and for purposes of of discussion here this works",
    "start": "727360",
    "end": "733720"
  },
  {
    "text": "fine does everybody know what an asp file is server side a server processing",
    "start": "733720",
    "end": "739560"
  },
  {
    "text": "file does anybody want to know a little bit more about an asp file active server page ber anyone anyone okay so here's",
    "start": "739560",
    "end": "748560"
  },
  {
    "text": "what this guy going to do the active server page is going to return preloaded",
    "start": "748560",
    "end": "753839"
  },
  {
    "text": "images to the top for Speed and then it's going to get down",
    "start": "753839",
    "end": "759560"
  },
  {
    "text": "here and begin this",
    "start": "761920",
    "end": "766240"
  },
  {
    "text": "processing the first thing that we're going to do is create a connection to the database right so as we have a means",
    "start": "767199",
    "end": "773399"
  },
  {
    "text": "of retrieving that information I want to create a connection create a record set object and populate that record set",
    "start": "773399",
    "end": "779920"
  },
  {
    "text": "object with records right so we create our adodb connection up here and then I",
    "start": "779920",
    "end": "786320"
  },
  {
    "text": "pass it a connection string you have to have a method of connecting to an an adodb connection has",
    "start": "786320",
    "end": "795519"
  },
  {
    "text": "to have some sort of connection string has to have some sort of means of getting to the data here I've chosen to",
    "start": "795519",
    "end": "803160"
  },
  {
    "text": "use the full connection string which is actually very typical of developers chip you ever",
    "start": "803160",
    "end": "811279"
  },
  {
    "text": "see anybody use this yeah we have the provider the user ID is",
    "start": "811279",
    "end": "817600"
  },
  {
    "text": "saay the password is suck a fool the database is MLS and the server equals web one so we're providing the ad adodb",
    "start": "817600",
    "end": "825800"
  },
  {
    "text": "connection object all the information it needs in order to connect up to this database now there are obviously some",
    "start": "825800",
    "end": "831639"
  },
  {
    "text": "problems with this we'll go over those in a little bit the first of all being that the username and password not not",
    "start": "831639",
    "end": "837880"
  },
  {
    "text": "just the fact that the username and password is available in clear teex should anyone get hold of this file but",
    "start": "837880",
    "end": "843240"
  },
  {
    "text": "in this case that the username and password is the essay user",
    "start": "843240",
    "end": "848160"
  },
  {
    "text": "correct what we're then doing but we're we're developers now we've got to get this thing we got to make it work so the",
    "start": "849279",
    "end": "856440"
  },
  {
    "text": "the the first step that many many people do is to provide a",
    "start": "856440",
    "end": "862800"
  },
  {
    "text": "function make sure it works then come back and make sure it's secure un",
    "start": "862800",
    "end": "869079"
  },
  {
    "text": "fortunately it's the come back and make sure it's secure part that a lot of people Miss secondly I'm going to create a",
    "start": "869079",
    "end": "875920"
  },
  {
    "text": "variable called SQL where I'm just going to give it the string value of what it is this string equals select MLS blah",
    "start": "875920",
    "end": "882920"
  },
  {
    "text": "blah blah from listings where status is zero and area equals and in this case I",
    "start": "882920",
    "end": "891040"
  },
  {
    "text": "say request form area so when my user",
    "start": "891040",
    "end": "901399"
  },
  {
    "text": "input user form is what it's called when my user form HTML form posts in the",
    "start": "901560",
    "end": "907600"
  },
  {
    "text": "variable area here the get data ASP file grabs that assign and it has it in",
    "start": "907600",
    "end": "913759"
  },
  {
    "text": "variable form request. form area and what I've done here is just taken that and jammed it in on the end of my string",
    "start": "913759",
    "end": "921639"
  },
  {
    "text": "value which results in the string area equals three and so far we're okay with that",
    "start": "921639",
    "end": "928720"
  },
  {
    "text": "because we think we've limited what people can do over here right we then go",
    "start": "928720",
    "end": "935560"
  },
  {
    "text": "ahead execute that statement here and here's a helpful little feature where I",
    "start": "937399",
    "end": "944120"
  },
  {
    "text": "then execute another statement selecting the count of those records there's other",
    "start": "944120",
    "end": "949360"
  },
  {
    "text": "ways I could have done this but what I wanted to know is so as the people before they start scrolling down I",
    "start": "949360",
    "end": "955440"
  },
  {
    "text": "wanted them to know how many properties were found so in this case it's 26 so I a little select statement that does that",
    "start": "955440",
    "end": "961639"
  },
  {
    "text": "we'll see that this secondary select statement actually helps us when people try to do Union statements and SQL",
    "start": "961639",
    "end": "968360"
  },
  {
    "text": "injection I'll show you why in a bit I think 50% of what I say is I'll show you",
    "start": "968360",
    "end": "974000"
  },
  {
    "text": "why in a bit we execute that and we just basically roll through this record set",
    "start": "974000",
    "end": "980639"
  },
  {
    "text": "until we get to the end so let's just take a little a look",
    "start": "980639",
    "end": "986480"
  },
  {
    "text": "here at what we could do I'm going to write my",
    "start": "986480",
    "end": "991639"
  },
  {
    "text": "own user form save it on the client which I can do whatever I want with I'm",
    "start": "991639",
    "end": "998399"
  },
  {
    "text": "going to call it user form hack well maybe",
    "start": "998399",
    "end": "1004839"
  },
  {
    "text": "not got me user form hack oh help somebody stopped",
    "start": "1004839",
    "end": "1010639"
  },
  {
    "text": "me I think it's user form hack",
    "start": "1010639",
    "end": "1014880"
  },
  {
    "text": "one there so let's look at the source here now I'm kind of doing it this way",
    "start": "1017120",
    "end": "1022920"
  },
  {
    "text": "on purpose because it's very easy to show you SQL SQL injection techniques with get",
    "start": "1022920",
    "end": "1030760"
  },
  {
    "text": "commands right where it's right up there in the URL and I can just start typing it in or whatever I want so I'm kind of",
    "start": "1030760",
    "end": "1036558"
  },
  {
    "text": "doing it this way on purpose I'm using integer values on purpose we're doing all this stuff on purpose just to make",
    "start": "1036559",
    "end": "1041880"
  },
  {
    "text": "it a little bit more realistic I mean I know many people use the get method",
    "start": "1041880",
    "end": "1047079"
  },
  {
    "text": "whenever they're pushing the data out to the ASP file but I think this is this is actually more typical so what I've done",
    "start": "1047079",
    "end": "1054720"
  },
  {
    "text": "is created my own value called area and I know that I use we I I know that we",
    "start": "1054720",
    "end": "1061000"
  },
  {
    "text": "use that right because I can just look at the source code for that user form in the first form I can see everything that",
    "start": "1061000",
    "end": "1066240"
  },
  {
    "text": "we've done there so I know it's passing the variable called area so in this case what we've done the",
    "start": "1066240",
    "end": "1074120"
  },
  {
    "text": "first trick of all SQL injection techniques is to put my own value in",
    "start": "1074120",
    "end": "1080080"
  },
  {
    "text": "there so rather than providing the V the value from a select list that we thought would limit people from putting in the",
    "start": "1080080",
    "end": "1085919"
  },
  {
    "text": "data what I've done is said value equals one or 1 equals 1",
    "start": "1085919",
    "end": "1093039"
  },
  {
    "text": "right so let's let's execute this",
    "start": "1093039",
    "end": "1100360"
  },
  {
    "text": "submit get line three oh that's right I need to change this this was still this was a leftover",
    "start": "1100360",
    "end": "1107360"
  },
  {
    "text": "huh I know stop oh Jim's getting me",
    "start": "1108919",
    "end": "1115919"
  },
  {
    "text": "back you need to go sit next to Laura and have all of your all of your questions proxied through Laura",
    "start": "1116799",
    "end": "1125600"
  },
  {
    "text": "because Jim is a Isa ninja if anyone was lucky enough to catch his stuff or to",
    "start": "1125600",
    "end": "1130720"
  },
  {
    "text": "read his stuff on the uh on the news groups Jim is great and I was just giving him kind of a hard time with a million more more so Tom but a bunch of",
    "start": "1130720",
    "end": "1138799"
  },
  {
    "text": "questions that I was launching over there all right let me change this file here I have it here for EAS right but I",
    "start": "1138799",
    "end": "1144799"
  },
  {
    "text": "would normally be saving it over there so user form",
    "start": "1144799",
    "end": "1150960"
  },
  {
    "text": "hack I didn't want",
    "start": "1154360",
    "end": "1157960"
  },
  {
    "text": "that is it not there so there are these two guys in the",
    "start": "1164039",
    "end": "1172158"
  },
  {
    "text": "woods okay I was actually doing it this way",
    "start": "1176520",
    "end": "1181960"
  },
  {
    "text": "what I want to do is use this now and for illustration purposes rather than posting it into get data I'm going to",
    "start": "1181960",
    "end": "1188799"
  },
  {
    "text": "post it into actually let me just post it straight into get",
    "start": "1188799",
    "end": "1193400"
  },
  {
    "text": "data and refresh this guy",
    "start": "1194520",
    "end": "1200640"
  },
  {
    "text": "yeah okay so what we've done now is I use the",
    "start": "1210600",
    "end": "1216200"
  },
  {
    "text": "same form and where before area equals 1 gave",
    "start": "1216200",
    "end": "1222480"
  },
  {
    "text": "us all the areas that were one what we have now is no notice that the sequel",
    "start": "1222480",
    "end": "1229840"
  },
  {
    "text": "statement is changed get it where status is zero area equals 1 or 1 equals",
    "start": "1229840",
    "end": "1237159"
  },
  {
    "text": "1 so the SQL server has now parsed that out it's looking at the entire statement",
    "start": "1237159",
    "end": "1244679"
  },
  {
    "text": "and it's going to get me all of this all these fields where are is one or where",
    "start": "1244679",
    "end": "1250320"
  },
  {
    "text": "one equals one well one always equals one that's a true statement one doesn't equal two 1 equals one so it's going to",
    "start": "1250320",
    "end": "1257640"
  },
  {
    "text": "give me every record in the database now typically this would be thousands of Records in this case it's",
    "start": "1257640",
    "end": "1264840"
  },
  {
    "text": "135 so we already see that we can execute arbitrary",
    "start": "1264840",
    "end": "1271400"
  },
  {
    "text": "SQL on our server anyone not know how this anyone not see why this is working everybody",
    "start": "1271400",
    "end": "1278880"
  },
  {
    "text": "already know all about this stuff right is anyone",
    "start": "1278880",
    "end": "1284039"
  },
  {
    "text": "listening okay there are these two guys all right um",
    "start": "1284039",
    "end": "1290520"
  },
  {
    "text": "so now let's just take a look at and actually I think somebody reported to us",
    "start": "1291159",
    "end": "1298760"
  },
  {
    "text": "we thought we had done something that if you select all areas nothing happens oops we have a",
    "start": "1298760",
    "end": "1304919"
  },
  {
    "text": "little logic bug so we need to fix that so two things that we need to do now we've got a logic bug that we need to",
    "start": "1304919",
    "end": "1310720"
  },
  {
    "text": "fix and we've seen that we can do some SQL injection so what we're going to do now is take a look at get data 2",
    "start": "1310720",
    "end": "1320520"
  },
  {
    "text": "where we've done a little bit more to protect",
    "start": "1322200",
    "end": "1329360"
  },
  {
    "text": "ourselves hopefully well what we do here is that",
    "start": "1329360",
    "end": "1336279"
  },
  {
    "text": "we need to change the logic of the statement a little bit to accept a zero because previously we had like a an and",
    "start": "1336279",
    "end": "1342640"
  },
  {
    "text": "logic get me where it's this and area is one and area is two and equal right and",
    "start": "1342640",
    "end": "1348360"
  },
  {
    "text": "and and equal logic but in this case if they select zero we want to get all the",
    "start": "1348360",
    "end": "1353840"
  },
  {
    "text": "properties so we're going to say where area is greater than zero because we",
    "start": "1353840",
    "end": "1359640"
  },
  {
    "text": "know it's got to be some area um I'll show you the actual structure of this database in a little",
    "start": "1359640",
    "end": "1365880"
  },
  {
    "text": "bit does anyone need to see that now would it help them anybody want to see the structure now",
    "start": "1365880",
    "end": "1372360"
  },
  {
    "text": "okay so we do a little extense checking we say",
    "start": "1372440",
    "end": "1379360"
  },
  {
    "text": "let's assign a variable to this request",
    "start": "1379360",
    "end": "1383480"
  },
  {
    "text": "form and that variable is I area so I area now equals whatever they put in if",
    "start": "1385640",
    "end": "1391320"
  },
  {
    "text": "it's zero then I'm going to have a string say an area is greater than zero otherwise area equals whatever they put",
    "start": "1391320",
    "end": "1397679"
  },
  {
    "text": "in for the area then I come down here same connection string SQL statement and",
    "start": "1397679",
    "end": "1404159"
  },
  {
    "text": "again I Jam in this string value on the end of this SQL statement to can my entire SQL string variable all",
    "start": "1404159",
    "end": "1414080"
  },
  {
    "text": "right and we still have the Nifty little count feature in there so if we come back here now we go to user form two and",
    "start": "1414440",
    "end": "1422559"
  },
  {
    "text": "user form two just happens to call get data to right so as I'm not doing a",
    "start": "1422559",
    "end": "1427760"
  },
  {
    "text": "whole lot of editing over here I'm going to say all areas great so now we see area is",
    "start": "1427760",
    "end": "1435840"
  },
  {
    "text": "greater than one perfect it still says 0 properties found I think I I uh rimmed",
    "start": "1435840",
    "end": "1441960"
  },
  {
    "text": "out something bgy",
    "start": "1441960",
    "end": "1449320"
  },
  {
    "text": "bgy uh R record",
    "start": "1450120",
    "end": "1453880"
  },
  {
    "text": "count oh yeah that's fine so let's go back here and just",
    "start": "1455799",
    "end": "1461919"
  },
  {
    "text": "select a one trucky area search so we see where that works",
    "start": "1461919",
    "end": "1470039"
  },
  {
    "text": "however our get data oops our user form hack will still",
    "start": "1470039",
    "end": "1477480"
  },
  {
    "text": "work need to edit it let's post this guy in the get data",
    "start": "1477480",
    "end": "1485440"
  },
  {
    "text": "2 view the source yep",
    "start": "1491559",
    "end": "1498440"
  },
  {
    "text": "we'll see that I was still able to inject that 1 equals 1 in there because I didn't do a very I didn't do a very",
    "start": "1501640",
    "end": "1508880"
  },
  {
    "text": "good job of looking at my data I just said if",
    "start": "1508880",
    "end": "1513919"
  },
  {
    "text": "it's greater than zero if it equals zero then do this otherwise do this not real",
    "start": "1513919",
    "end": "1521559"
  },
  {
    "text": "smart now let's talk a little bit about what",
    "start": "1523279",
    "end": "1529480"
  },
  {
    "text": "we can do with SQL injection this isn't a how to inject SQL to break people's",
    "start": "1529480",
    "end": "1534840"
  },
  {
    "text": "stuff class it's how to protect yourselves from it but in order to protect ourselves from it we need to",
    "start": "1534840",
    "end": "1540240"
  },
  {
    "text": "have an idea of what can be done knowing that I can inject arbitrary",
    "start": "1540240",
    "end": "1546480"
  },
  {
    "text": "code in here has tells me that I can own this entire server there's many things",
    "start": "1546480",
    "end": "1553080"
  },
  {
    "text": "that we can do I don't see this code so I don't know the user context that I'm operating in",
    "start": "1553080",
    "end": "1561159"
  },
  {
    "text": "however the bad thing is is that it's an sa user which is the god user on SQL",
    "start": "1561159",
    "end": "1567360"
  },
  {
    "text": "Server so any query that I pump into this server from here gets executed as",
    "start": "1567360",
    "end": "1574000"
  },
  {
    "text": "the saay user I can do anything if I was malicious I could app",
    "start": "1574000",
    "end": "1581240"
  },
  {
    "text": "pinned a ara equals one drop database MLS",
    "start": "1581240",
    "end": "1588440"
  },
  {
    "text": "execute it and in that one statement this entire database is gone anybody else who is attempting to",
    "start": "1588440",
    "end": "1597120"
  },
  {
    "text": "access our data won't be able to in one statement I can completely hose it",
    "start": "1597120",
    "end": "1602360"
  },
  {
    "text": "that's just if you're if a vandel does something if somebody who's trying to get at your data does something there's",
    "start": "1602360",
    "end": "1608320"
  },
  {
    "text": "some other mean things that they can do let's talk about a union statement real",
    "start": "1608320",
    "end": "1614000"
  },
  {
    "text": "quick I have a couple of different tables",
    "start": "1615039",
    "end": "1620240"
  },
  {
    "text": "and my MLS",
    "start": "1622760",
    "end": "1630279"
  },
  {
    "text": "database I'm going to select this is just my query analyzer okay this is a client tool that allows me to just throw",
    "start": "1631760",
    "end": "1638520"
  },
  {
    "text": "SQL at my SQL Server select Splat from listings so you can see here that this",
    "start": "1638520",
    "end": "1645799"
  },
  {
    "text": "is just accessing all the data in the table and I have another table called",
    "start": "1645799",
    "end": "1652799"
  },
  {
    "text": "blah and blah has a integer value a",
    "start": "1652799",
    "end": "1658640"
  },
  {
    "text": "invar care 25 and another integer value the SQL Union statement allows me to",
    "start": "1658640",
    "end": "1665399"
  },
  {
    "text": "grab data from one table and then concatenate it to the record set returned from another",
    "start": "1665399",
    "end": "1671360"
  },
  {
    "text": "table did I say that right so if I want to select",
    "start": "1671360",
    "end": "1679240"
  },
  {
    "text": "the MLS number the city and",
    "start": "1679240",
    "end": "1684760"
  },
  {
    "text": "um",
    "start": "1684760",
    "end": "1687760"
  },
  {
    "text": "price I get that I can Union in a",
    "start": "1690240",
    "end": "1696519"
  },
  {
    "text": "select um ID blah blah",
    "start": "1696519",
    "end": "1701760"
  },
  {
    "text": "two from blah and we see what it's done is in the",
    "start": "1701760",
    "end": "1706880"
  },
  {
    "text": "same return set it's grabbed the data from the other table and given it to me that can be a powerful method of me",
    "start": "1706880",
    "end": "1714720"
  },
  {
    "text": "circumventing your SQL statement up here in order to grab data from other tables so let's do something similar to",
    "start": "1714720",
    "end": "1722440"
  },
  {
    "text": "that I'm going to jump ahead just to kind of show you uh let's go to user form hack",
    "start": "1722440",
    "end": "1729760"
  },
  {
    "text": "two we're going to view the source on",
    "start": "1730799",
    "end": "1735158"
  },
  {
    "text": "that okay let me show you one thing if my select statement up",
    "start": "1736399",
    "end": "1745039"
  },
  {
    "text": "here brings in fields that cannot be directly the the price happens to be a",
    "start": "1746440",
    "end": "1752399"
  },
  {
    "text": "money value blah two happens to be an integer value the server can give me",
    "start": "1752399",
    "end": "1758440"
  },
  {
    "text": "both of those values in the same Union statement because it can convert it on the fly but let's say that I don't",
    "start": "1758440",
    "end": "1764320"
  },
  {
    "text": "select price I select state and then I try to execute this statement well the",
    "start": "1764320",
    "end": "1770480"
  },
  {
    "text": "first thing you saw it do was actually executed the first part of that statement but then it gives me an error message saying that it can't convert the",
    "start": "1770480",
    "end": "1777200"
  },
  {
    "text": "invar care value of California to integer I'd get the same sort of message",
    "start": "1777200",
    "end": "1783399"
  },
  {
    "text": "over here and as Jim pointed out that's because my error reporting on my IIs",
    "start": "1783399",
    "end": "1790279"
  },
  {
    "text": "server is turned on which is on by default which means that it gives the client who submits an adodb",
    "start": "1790279",
    "end": "1799159"
  },
  {
    "text": "connection string or whatever any any error it's going to give me some uh good detail on why you got that",
    "start": "1799159",
    "end": "1806159"
  },
  {
    "text": "error so I would get the exact same error something similar to it over here",
    "start": "1806159",
    "end": "1811960"
  },
  {
    "text": "and then I would know that that third column is an incar value",
    "start": "1811960",
    "end": "1817840"
  },
  {
    "text": "right I can throw Canan inated",
    "start": "1817840",
    "end": "1823159"
  },
  {
    "text": "statements at the server systematically and get all of the take",
    "start": "1823159",
    "end": "1828279"
  },
  {
    "text": "all the information I need like that I could add I could just keep saying blah",
    "start": "1828279",
    "end": "1833600"
  },
  {
    "text": "two blah two blah two and it would tell me what it is and along the way I could structure my select statement in such a",
    "start": "1833600",
    "end": "1840440"
  },
  {
    "text": "way that it matches up with the number of columns and the data type so as it would execute an example being it's giving me",
    "start": "1840440",
    "end": "1848240"
  },
  {
    "text": "the stuff from listings maybe I want to select name credit card number and expiration date from the customer's file",
    "start": "1848240",
    "end": "1855720"
  },
  {
    "text": "at the same time and all of a sudden get all the credit card numbers or what have you what I'll show",
    "start": "1855720",
    "end": "1863200"
  },
  {
    "text": "you is here I'm going to say where one equals one or one equals",
    "start": "1863200",
    "end": "1868639"
  },
  {
    "text": "1 I could actually get rid of that one equals 1 Union",
    "start": "1868639",
    "end": "1873679"
  },
  {
    "text": "select and I'm throwing in a number of convert statements for the sake of brevity I'm",
    "start": "1873679",
    "end": "1879840"
  },
  {
    "text": "not going to sit here and hack every I'm not going to hack that statement and show you the return values to where I",
    "start": "1879840",
    "end": "1885679"
  },
  {
    "text": "can canate a value onto the end statement each time to make my union select statement work okay what I'm",
    "start": "1885679",
    "end": "1892840"
  },
  {
    "text": "doing is using a new function was it in seven or",
    "start": "1892840",
    "end": "1899000"
  },
  {
    "text": "2000 the variant 2000 gave us the variant type",
    "start": "1899000",
    "end": "1906120"
  },
  {
    "text": "the data type of variant so no longer do I have to worry about stuff like this I",
    "start": "1906120",
    "end": "1911440"
  },
  {
    "text": "don't have to match up the data type of a second column select to the First Column select using the variant data",
    "start": "1911440",
    "end": "1918720"
  },
  {
    "text": "type I just say convert it for me I don't care what it was here's a value convert it to whatever this initial",
    "start": "1918720",
    "end": "1924399"
  },
  {
    "text": "column was and in this case what I'm doing is",
    "start": "1924399",
    "end": "1929720"
  },
  {
    "text": "matching up when you see convert SQL variant zero I'm converting a zero to a",
    "start": "1929720",
    "end": "1935000"
  },
  {
    "text": "SQL variant of whatever the first data type was and then I'm selecting the name from",
    "start": "1935000",
    "end": "1942559"
  },
  {
    "text": "The Master databases CIS objects again the first X number of",
    "start": "1942559",
    "end": "1950600"
  },
  {
    "text": "convert statements are used to match up the number of Select statements in my original every does everybody knows how",
    "start": "1950600",
    "end": "1957720"
  },
  {
    "text": "this Union is working and want me to go into a little more detail we have time it's",
    "start": "1957720",
    "end": "1964360"
  },
  {
    "text": "okay okay so let's execute this guy oh I did it",
    "start": "1964360",
    "end": "1972440"
  },
  {
    "text": "again he's supposed to go to get data too",
    "start": "1972440",
    "end": "1977679"
  },
  {
    "text": "[Music] I should have prep more",
    "start": "1981780",
    "end": "1988200"
  },
  {
    "text": "jokes I mean actually have some more jokes but they really wouldn't be appropriate you know what I",
    "start": "1988799",
    "end": "1994960"
  },
  {
    "text": "mean okay",
    "start": "1997039",
    "end": "2001039"
  },
  {
    "text": "ah I got a little ahead of myself let me pull up get data 2",
    "start": "2011279",
    "end": "2017320"
  },
  {
    "text": "here remember that little trick I was talking about to where I'm pulling up that single column in my record set to",
    "start": "2018080",
    "end": "2024000"
  },
  {
    "text": "give you the count let me show you at work first then",
    "start": "2024000",
    "end": "2031760"
  },
  {
    "text": "I'll get rid of this guy this is the code that does that",
    "start": "2031760",
    "end": "2039720"
  },
  {
    "text": "this is the code that does",
    "start": "2047960",
    "end": "2051280"
  },
  {
    "text": "that okay so what I've done is submitted another another query now to where not",
    "start": "2064399",
    "end": "2071118"
  },
  {
    "text": "only does it grab the listings I've done a union select matching up the columns",
    "start": "2071119",
    "end": "2077358"
  },
  {
    "text": "where over here in the remarks field it's now giving me every name of every",
    "start": "2077359",
    "end": "2082800"
  },
  {
    "text": "object on that database of this on the the SQL",
    "start": "2082800",
    "end": "2089319"
  },
  {
    "text": "Server which would give an attacker plenty of information on the structure of that server the object in it what",
    "start": "2091800",
    "end": "2098440"
  },
  {
    "text": "stored procedures you have what databases you have what tables you have what every",
    "start": "2098440",
    "end": "2104200"
  },
  {
    "text": "Everything lots of Rich data here all from us being able to allow",
    "start": "2104200",
    "end": "2109560"
  },
  {
    "text": "somebody to do a quick search what's what's interesting about",
    "start": "2109560",
    "end": "2116240"
  },
  {
    "text": "the way the adodb parser works on an asp page is that even though a second even",
    "start": "2116240",
    "end": "2123880"
  },
  {
    "text": "though it's a second request being made if the same same connection object",
    "start": "2123880",
    "end": "2129640"
  },
  {
    "text": "submits another query behind a union query even that guy has to",
    "start": "2129640",
    "end": "2137079"
  },
  {
    "text": "match meaning I do my first select statement up here with my nine",
    "start": "2137079",
    "end": "2143599"
  },
  {
    "text": "columns in my injection I Union another select statement with nine columns with",
    "start": "2143599",
    "end": "2150079"
  },
  {
    "text": "the properly converted variable so that the statement executed properly but here I had a select",
    "start": "2150079",
    "end": "2157079"
  },
  {
    "text": "statement that that retrieved a single",
    "start": "2157079",
    "end": "2161920"
  },
  {
    "text": "value not that I expect everyone to go through and have secondary data connects",
    "start": "2163160",
    "end": "2169000"
  },
  {
    "text": "made where you change the number of columns being returned on a connection object but if you do that a union select",
    "start": "2169000",
    "end": "2176839"
  },
  {
    "text": "would",
    "start": "2176839",
    "end": "2179040"
  },
  {
    "text": "fail pardon in the same equal statement or",
    "start": "2182599",
    "end": "2188319"
  },
  {
    "text": "like multiple ones over here and when you say a multiple result",
    "start": "2188319",
    "end": "2193920"
  },
  {
    "text": "set via what if it's a union that you're first",
    "start": "2193920",
    "end": "2201319"
  },
  {
    "text": "doing yes they that would have to match too but you as a developer are going to know whether you have a union or",
    "start": "2201319",
    "end": "2207760"
  },
  {
    "text": "not you know what I'm saying what I've done is I've thrown in a union over",
    "start": "2207760",
    "end": "2213440"
  },
  {
    "text": "here and again I don't expect now what this wouldn't do this wouldn't help you at all if if I had put a drop database",
    "start": "2213440",
    "end": "2222000"
  },
  {
    "text": "behind that right this is strictly don't think that this is a Magic Bullet you go hey",
    "start": "2222000",
    "end": "2228119"
  },
  {
    "text": "well I'll just throw in another connection adob connection that creates a record set that's got a different number of columns selected so as a union",
    "start": "2228119",
    "end": "2234480"
  },
  {
    "text": "statement fails that's all it does is it makes the union statement fail I was just showing you that because I find that interesting it kind of gives us and",
    "start": "2234480",
    "end": "2241720"
  },
  {
    "text": "some insight into the way that the parser works",
    "start": "2241720",
    "end": "2246319"
  },
  {
    "text": "you would probably create that with a separate um connection string if you actually wanted that kind of",
    "start": "2247960",
    "end": "2253640"
  },
  {
    "text": "functionality you could probably submit a go or uh you could you could terminate that",
    "start": "2253640",
    "end": "2259880"
  },
  {
    "text": "connection so let's take a a little bit better look at what we could be doing",
    "start": "2260000",
    "end": "2269039"
  },
  {
    "text": "here and I think this corresponds with a slide",
    "start": "2270480",
    "end": "2277000"
  },
  {
    "text": "let's talk a little bit about the counter measures",
    "start": "2281280",
    "end": "2287839"
  },
  {
    "text": "here I've jumped ahead of one I'll go back to that one what we're not doing is validating",
    "start": "2287839",
    "end": "2295760"
  },
  {
    "text": "any of this input and this is where it becomes critical any",
    "start": "2295760",
    "end": "2302319"
  },
  {
    "text": "input that's coming in from a thirdparty source",
    "start": "2302319",
    "end": "2307640"
  },
  {
    "text": "must be considered evil every single piece of information that you get that a user submits to you",
    "start": "2307640",
    "end": "2314880"
  },
  {
    "text": "consider it absolutely evil and it has to be exercised it has to be",
    "start": "2314880",
    "end": "2320960"
  },
  {
    "text": "sanitized if you start thinking that way you'll catch a lot of this stuff before",
    "start": "2320960",
    "end": "2327040"
  },
  {
    "text": "it even begins quick example I even got Jeremiah",
    "start": "2327040",
    "end": "2333839"
  },
  {
    "text": "with this one I think he's going to talk about it so I don't mind bu in him can",
    "start": "2333839",
    "end": "2339079"
  },
  {
    "text": "you hear me Jeremiah I took he's got an outstanding",
    "start": "2339079",
    "end": "2345880"
  },
  {
    "text": "tool that parses out web forms for you third party he can like tell it to dump out all of your information I changed",
    "start": "2345880",
    "end": "2352760"
  },
  {
    "text": "the server header form on my web server to have an image tag an HTML image tag rather than i50 or Apache 1.34 on Unix",
    "start": "2352760",
    "end": "2363000"
  },
  {
    "text": "or whatever whenever he tried to look at my web",
    "start": "2363000",
    "end": "2368800"
  },
  {
    "text": "it I had control of what data he was putting in his browser and up goes that",
    "start": "2368800",
    "end": "2375079"
  },
  {
    "text": "image statement and he sees this spinning 3D skull on his screen and he's like what the",
    "start": "2375079",
    "end": "2380280"
  },
  {
    "text": "hell right even things like that whenever you grab data from somebody",
    "start": "2380280",
    "end": "2386160"
  },
  {
    "text": "else sanitize it first so let's look at some ways of doing",
    "start": "2386160",
    "end": "2391440"
  },
  {
    "text": "that other things uh as far as input validation we want to do some value or",
    "start": "2391440",
    "end": "2399200"
  },
  {
    "text": "length checking as developers we know that the only possible inputs that we want to accept are areas 1 through six",
    "start": "2399200",
    "end": "2406480"
  },
  {
    "text": "so we should explicitly check and say it's got to be a one 2 3 4 5 or six or",
    "start": "2406480",
    "end": "2412800"
  },
  {
    "text": "zero 0 through six so check the value of it or extents",
    "start": "2412800",
    "end": "2419400"
  },
  {
    "text": "of boundaries like uh uh the value length checking would be if you know that you're not going to use more than a",
    "start": "2419400",
    "end": "2424880"
  },
  {
    "text": "25 character input check the length to make sure it's 25",
    "start": "2424880",
    "end": "2430000"
  },
  {
    "text": "characters and then the extents boundary tracking host submission limits per unit of",
    "start": "2430000",
    "end": "2437160"
  },
  {
    "text": "time if you're accepting user input that you actually store on your servers like whenever people come to maybe we want",
    "start": "2437160",
    "end": "2443839"
  },
  {
    "text": "them to be able to tell us what they're looking for I want to be able to find a house with blah blah blah blah blah blah",
    "start": "2443839",
    "end": "2450440"
  },
  {
    "text": "blah here's my email address somebody contact me submit we've got that data actually",
    "start": "2450440",
    "end": "2456680"
  },
  {
    "text": "being stored on our server someplace little bit of checking we",
    "start": "2456680",
    "end": "2462079"
  },
  {
    "text": "might see that we can actually put a th000 2,000 5,000 characters in that",
    "start": "2462079",
    "end": "2467280"
  },
  {
    "text": "text string that they're accepting and save it if we don't like them we can write an",
    "start": "2467280",
    "end": "2473000"
  },
  {
    "text": "automated script that goes through and does about a million or two million posts overnight that post that data into",
    "start": "2473000",
    "end": "2479720"
  },
  {
    "text": "their server with the hopes of using up all of the space on the server or something like that now granted it would",
    "start": "2479720",
    "end": "2485760"
  },
  {
    "text": "normally it would take a very long time to do that but my you get my point right",
    "start": "2485760",
    "end": "2490800"
  },
  {
    "text": "in that case whenever you're accepting these insert commands you might want to",
    "start": "2490800",
    "end": "2496160"
  },
  {
    "text": "take a look at how many you've had today or in the last hour or something like that and say you know what we've had 4",
    "start": "2496160",
    "end": "2504359"
  },
  {
    "text": "million requests for information in the last hour alone something's wrong and not accept",
    "start": "2504359",
    "end": "2511079"
  },
  {
    "text": "any more user input or anything like that that's what I mean by submission limits per unit of time",
    "start": "2511079",
    "end": "2517640"
  },
  {
    "text": "so let's and and and we're not going to do any of that particularly but we are going to go into some of these other",
    "start": "2517640",
    "end": "2523599"
  },
  {
    "text": "features of data sanitation and what have you so let's look at the code again yes",
    "start": "2523599",
    "end": "2531240"
  },
  {
    "text": "sir right and uh that's a good the the question was you have to be careful",
    "start": "2542839",
    "end": "2548400"
  },
  {
    "text": "about doing that because somebody could do a denial of service on your machine purposefully knowing that you're not",
    "start": "2548400",
    "end": "2554599"
  },
  {
    "text": "going to accept any more submissions but which one would you rather have a denial",
    "start": "2554599",
    "end": "2560280"
  },
  {
    "text": "of service that is based on them crashing the server for resources being used up or the fact that you would then",
    "start": "2560280",
    "end": "2567680"
  },
  {
    "text": "we would probably be notified in some manner somebody would say it's not just going to stop it's going to stop it's",
    "start": "2567680",
    "end": "2574520"
  },
  {
    "text": "going to programmatically stop and say you know paage you the server would then page you",
    "start": "2574520",
    "end": "2579599"
  },
  {
    "text": "or something like that but you're but you're absolutely",
    "start": "2579599",
    "end": "2583880"
  },
  {
    "text": "right so and you know and that but that's one of the decisions what I like is I like to be able to make that decision decision if it's going to be if",
    "start": "2602040",
    "end": "2608800"
  },
  {
    "text": "I'm going to stop accepting user input it's because I want to not because chip wants me to right so and that's a valid",
    "start": "2608800",
    "end": "2616280"
  },
  {
    "text": "point but I mean a lot of this stuff is give and take let's take a look at user form",
    "start": "2616280",
    "end": "2623680"
  },
  {
    "text": "three let's not use user form three we wouldn't get data",
    "start": "2623680",
    "end": "2628760"
  },
  {
    "text": "three what I want to start doing now",
    "start": "2634119",
    "end": "2639039"
  },
  {
    "text": "is getting a little bit more control over this data did I mention that they",
    "start": "2641520",
    "end": "2646839"
  },
  {
    "text": "told me not to stand right here they did they said Tim don't stand here so",
    "start": "2646839",
    "end": "2654280"
  },
  {
    "text": "hi well it's just I'm close to my code I don't want to get too far from him we're going to introduce a couple of new",
    "start": "2655040",
    "end": "2660720"
  },
  {
    "text": "things here one is a very very simple object called the regular expression object",
    "start": "2660720",
    "end": "2668559"
  },
  {
    "text": "it also happens to be very powerful the regular expression object",
    "start": "2669359",
    "end": "2674839"
  },
  {
    "text": "allows me to assign a variable to the object and then assign a pattern to that",
    "start": "2674839",
    "end": "2682280"
  },
  {
    "text": "variable and what that pattern does is matches a particular series of text",
    "start": "2682280",
    "end": "2688200"
  },
  {
    "text": "elements or alpha numeric elements text ones",
    "start": "2688200",
    "end": "2694200"
  },
  {
    "text": "zeros once I've created that expression I can use a method of the regular",
    "start": "2694200",
    "end": "2699480"
  },
  {
    "text": "expression object to replace anything in that object that",
    "start": "2699480",
    "end": "2705920"
  },
  {
    "text": "matches the pattern with a particular variable in this case what I've done is",
    "start": "2705920",
    "end": "2712000"
  },
  {
    "text": "I've said the pattern is anything that's not a number I want you to match anything that",
    "start": "2712000",
    "end": "2718680"
  },
  {
    "text": "isn't a number and replace it with a null value where and and and this is",
    "start": "2718680",
    "end": "2724760"
  },
  {
    "text": "what we're checking so what I've done this time as I've taken my I area and rather than it just being the request",
    "start": "2724760",
    "end": "2730160"
  },
  {
    "text": "form area it is the replacement it's the integer value which this way I know it's",
    "start": "2730160",
    "end": "2735640"
  },
  {
    "text": "going to be a one it's the integer value of the resultant replacement of the form",
    "start": "2735640",
    "end": "2746160"
  },
  {
    "text": "area let's look at some of the other things that we can do real quick with this pattern because I think it's a",
    "start": "2746800",
    "end": "2753720"
  },
  {
    "text": "good let me uh",
    "start": "2753720",
    "end": "2758359"
  },
  {
    "text": "oh that was the wrong",
    "start": "2760880",
    "end": "2764720"
  },
  {
    "text": "one this is probably kind of hard to see but just here in the help section",
    "start": "2772240",
    "end": "2778000"
  },
  {
    "text": "this is in my MSD and Library we can see an enormous number of pre-stored pattern",
    "start": "2778000",
    "end": "2784760"
  },
  {
    "text": "types that we can use non digit characters form feeds new lines any",
    "start": "2784760",
    "end": "2790280"
  },
  {
    "text": "white space tabs vertical lines anything and then we can do our own custom",
    "start": "2790280",
    "end": "2795680"
  },
  {
    "text": "patterns stuff like that um either this or that you know so you can use or logic",
    "start": "2795680",
    "end": "2801200"
  },
  {
    "text": "you can use and logic it's very flexible Microsoft did a really good job with",
    "start": "2801200",
    "end": "2806640"
  },
  {
    "text": "this little this little object sir one more time I couldn't hear oh",
    "start": "2806640",
    "end": "2814640"
  },
  {
    "text": "absolutely I'm actually a big fan of Microsoft I mean some of the stuff that I say",
    "start": "2814640",
    "end": "2819960"
  },
  {
    "text": "that's I write an article on security Focus I do the Microsoft column on security focus and you know sometimes I",
    "start": "2819960",
    "end": "2825640"
  },
  {
    "text": "get a little mean towards you guys Jim works for Microsoft but you deserve it okay",
    "start": "2825640",
    "end": "2832920"
  },
  {
    "text": "um wait till the next one I'll probably get a call from Scott Charney himself",
    "start": "2833240",
    "end": "2839319"
  },
  {
    "text": "okay so here's the uh here are some of the other just examples of what we can",
    "start": "2839319",
    "end": "2844559"
  },
  {
    "text": "do here",
    "start": "2844559",
    "end": "2847839"
  },
  {
    "text": "so the first thing we do is we kind of sanitize that input I strip it out of any characters that I don't want this",
    "start": "2850480",
    "end": "2857040"
  },
  {
    "text": "would have taken the equal sign out right so whenever I try to inject area is one",
    "start": "2857040",
    "end": "2864040"
  },
  {
    "text": "space o r space one equal sign one and maybe another",
    "start": "2864040",
    "end": "2869680"
  },
  {
    "text": "space whenever I run that string through this replacement object it's going to",
    "start": "2869680",
    "end": "2875240"
  },
  {
    "text": "strip all of that out in most cases where I'm going to do",
    "start": "2875240",
    "end": "2880640"
  },
  {
    "text": "something evil on your SQL server and in again most cases it's",
    "start": "2880640",
    "end": "2887119"
  },
  {
    "text": "going to require that I escape out some way of your normal SQL code either with",
    "start": "2887119",
    "end": "2892920"
  },
  {
    "text": "a Double Dash to rim out something or including",
    "start": "2892920",
    "end": "2898160"
  },
  {
    "text": "quotes I chose the integer here because an integer value is particularly",
    "start": "2898160",
    "end": "2903599"
  },
  {
    "text": "susceptible to SQL injection because I don't have to worry about quotes right a quote would be if I said it",
    "start": "2903599",
    "end": "2910920"
  },
  {
    "text": "where if I didn't have my area stored as integer values and rather had them stored as textual values which really",
    "start": "2910920",
    "end": "2917280"
  },
  {
    "text": "wouldn't be smart in good database programming anyway but it's done if I said where area equals quote single",
    "start": "2917280",
    "end": "2925319"
  },
  {
    "text": "quote trucky single quote I would probably be programmatically appending that ending",
    "start": "2925319",
    "end": "2932480"
  },
  {
    "text": "quote and the beginning quote to that input right I'm just going to you're",
    "start": "2932480",
    "end": "2937599"
  },
  {
    "text": "just going to type in trucky I would have to say where area equals quote",
    "start": "2937599",
    "end": "2943920"
  },
  {
    "text": "request form area plus quote that second quote that I use would",
    "start": "2943920",
    "end": "2951200"
  },
  {
    "text": "kill any SQL injection it would make that statement fail when being parsed by the SQL engine because you'd have two",
    "start": "2951200",
    "end": "2957319"
  },
  {
    "text": "quotes in it right quick uh quick",
    "start": "2957319",
    "end": "2964760"
  },
  {
    "text": "example where City equals trucky well that's going to error",
    "start": "2965480",
    "end": "2971480"
  },
  {
    "text": "because it's",
    "start": "2971480",
    "end": "2973920"
  },
  {
    "text": "not right so it gives me",
    "start": "2978079",
    "end": "2981880"
  },
  {
    "text": "everything that's very secure sequel right there from",
    "start": "2983520",
    "end": "2991599"
  },
  {
    "text": "listings so there there's everything here programmatically the that would be where",
    "start": "2991599",
    "end": "2997319"
  },
  {
    "text": "my string would end and then I would append that single quote to it again if I was concatenating string values",
    "start": "2997319",
    "end": "3004839"
  },
  {
    "text": "together to make that sequel statement right as a programmer as a as a hacker",
    "start": "3004839",
    "end": "3010640"
  },
  {
    "text": "I'd probably have to throw another single quote in this string in",
    "start": "3010640",
    "end": "3017319"
  },
  {
    "text": "order to terminate it properly and then",
    "start": "3017319",
    "end": "3022000"
  },
  {
    "text": "throw a double line in there see how it turned to",
    "start": "3022359",
    "end": "3028119"
  },
  {
    "text": "Green if I could inject a single quote and a double line then I'm going to change the entire logic and rim out",
    "start": "3028119",
    "end": "3034359"
  },
  {
    "text": "everything Beyond it so even if you had where sit equals this and area equals one and you're an authenticated user all",
    "start": "3034359",
    "end": "3041720"
  },
  {
    "text": "of that language would be terminated from my SQL strings",
    "start": "3041720",
    "end": "3046920"
  },
  {
    "text": "parser what the regular expression object",
    "start": "3047240",
    "end": "3052880"
  },
  {
    "text": "does is would be it it would strip out that single quote it strip out double quotes it' strip out dashes it strips",
    "start": "3053440",
    "end": "3059440"
  },
  {
    "text": "out all of that stuff that make it really hard for you to inject data into",
    "start": "3059440",
    "end": "3064839"
  },
  {
    "text": "my system I would go out I would say that the replace",
    "start": "3064839",
    "end": "3069880"
  },
  {
    "text": "statement except for integer values but e even in that case the the",
    "start": "3069880",
    "end": "3075559"
  },
  {
    "text": "the replace statement here just that one little piece would fix like 90% of the",
    "start": "3075559",
    "end": "3080599"
  },
  {
    "text": "potential that people would have to inject SQL not all of it obviously but a lot of it",
    "start": "3080599",
    "end": "3087520"
  },
  {
    "text": "it wouldn't fix the drop database right because there's no quotes",
    "start": "3087520",
    "end": "3093640"
  },
  {
    "text": "there's no anything we're one equals one space drop database",
    "start": "3093640",
    "end": "3098839"
  },
  {
    "text": "blue pardon exactly it's just another expression it's",
    "start": "3098839",
    "end": "3104599"
  },
  {
    "text": "valid I thought I had to put a semicolon in there but um Beth uh someone from one",
    "start": "3104599",
    "end": "3110680"
  },
  {
    "text": "one of my classes you know showed me that that was incorrect that you don't need a semicolon to concanon a secondary",
    "start": "3110680",
    "end": "3117040"
  },
  {
    "text": "statement onto it and I was like",
    "start": "3117040",
    "end": "3121680"
  },
  {
    "text": "damn oh the whole I mean there there there are a tremendous number number of",
    "start": "3123920",
    "end": "3129520"
  },
  {
    "text": "pre-stored SQL codes that are valid what it does it steps back and looks at the entire code what it considers a syntax",
    "start": "3129520",
    "end": "3137040"
  },
  {
    "text": "and will break it out as it does it the actual method that SQL uses to pars it I'm sure I mean I I couldn't go into",
    "start": "3137040",
    "end": "3142880"
  },
  {
    "text": "that I mean I it's got to be complex though because it's really it's pretty there there are a lot of different",
    "start": "3142880",
    "end": "3148000"
  },
  {
    "text": "things that I can do but like another select statement you know it knows that a select needs a wear and a FR I mean",
    "start": "3148000",
    "end": "3153400"
  },
  {
    "text": "you know it it parses all that stuff out so if it's smart enough it'll figure",
    "start": "3153400",
    "end": "3158520"
  },
  {
    "text": "out that's why I was thinking the semicolon was was necessary but it's not well let's try it",
    "start": "3158520",
    "end": "3165839"
  },
  {
    "text": "well I mean their parser actually does what it's going to do is it's going to parse",
    "start": "3196240",
    "end": "3202160"
  },
  {
    "text": "in and say is this valid is this valid is this valid is this valid is this valid this is valid execute okay is this",
    "start": "3202160",
    "end": "3209599"
  },
  {
    "text": "valid is this valid you'll see I actually got two different result sets with no separation know anything",
    "start": "3209599",
    "end": "3215319"
  },
  {
    "text": "select this where this equals this select this it just doesn't care I mean obviously it cares but but what we're",
    "start": "3215319",
    "end": "3221680"
  },
  {
    "text": "doing is as soon as it encounters a valid um a valid statement it's going to",
    "start": "3221680",
    "end": "3229280"
  },
  {
    "text": "execute it and in fact even if I said I",
    "start": "3229280",
    "end": "3234599"
  },
  {
    "text": "think if it errors out in the second part select um Fu from",
    "start": "3234599",
    "end": "3241920"
  },
  {
    "text": "blah I'm thinking it actually executed that first statement I'll have to check on that even though it didn't return",
    "start": "3241960",
    "end": "3250400"
  },
  {
    "text": "it maybe if I did it like that it would now if I put a go in there then I know",
    "start": "3250400",
    "end": "3256000"
  },
  {
    "text": "it would right",
    "start": "3256000",
    "end": "3261079"
  },
  {
    "text": "sir say it one more time I can't hear",
    "start": "3261839",
    "end": "3267079"
  },
  {
    "text": "oh yeah that's the grid um let's",
    "start": "3268599",
    "end": "3273160"
  },
  {
    "text": "see if I if I turn on the statistics it",
    "start": "3275359",
    "end": "3280599"
  },
  {
    "text": "will well there really is no web page parser in this regard I'm just creating a SQL I'm just creating a string value",
    "start": "3285480",
    "end": "3291319"
  },
  {
    "text": "and sending it to it let's get to that let me",
    "start": "3291319",
    "end": "3295880"
  },
  {
    "text": "let me let me show you a couple of more things and it'll probably answer that for you because that's what we're going to",
    "start": "3304440",
    "end": "3309599"
  },
  {
    "text": "do so and again I mean there really is there there's we could do just how to",
    "start": "3309599",
    "end": "3315240"
  },
  {
    "text": "inject SQL but it really wouldn't be about that I would just be giving some little class about how to structure",
    "start": "3315240",
    "end": "3321119"
  },
  {
    "text": "valid SQL statements that's really all we're doing is we're structuring valid statements",
    "start": "3321119",
    "end": "3328200"
  },
  {
    "text": "um the you know the other end of this is",
    "start": "3328240",
    "end": "3333319"
  },
  {
    "text": "again as Jim pointed out with these error messages I wouldn't necessarily just get this error message but I could",
    "start": "3333319",
    "end": "3339079"
  },
  {
    "text": "have said Group by area the adodb the O the olb provider",
    "start": "3339079",
    "end": "3347680"
  },
  {
    "text": "would tell me you can't Group by this from this table even if I had no idea",
    "start": "3347680",
    "end": "3353960"
  },
  {
    "text": "what you were doing if I could inject some SQL using Group by Clauses and other aggregate Clauses that I would",
    "start": "3353960",
    "end": "3359480"
  },
  {
    "text": "inject we could disassemble the entire back end just from the error messages it tells us you know this is a character",
    "start": "3359480",
    "end": "3366280"
  },
  {
    "text": "value oh good okay character oh you can't do that from the listings table o",
    "start": "3366280",
    "end": "3371880"
  },
  {
    "text": "listings oh this the MLS database doesn't accept this you know and you just start collecting more and more",
    "start": "3371880",
    "end": "3378280"
  },
  {
    "text": "information so let's let's",
    "start": "3378280",
    "end": "3382000"
  },
  {
    "text": "see what else we do after we sanitize the data removing any",
    "start": "3383400",
    "end": "3392160"
  },
  {
    "text": "um let's say we did one accept character data I'd still remove single quotes",
    "start": "3392160",
    "end": "3397200"
  },
  {
    "text": "double quotes dashes semicolons stuff that we know we don't need right after we sanitize the input",
    "start": "3397200",
    "end": "3406480"
  },
  {
    "text": "here we have what 45 15 minutes to go thanks",
    "start": "3408920",
    "end": "3417160"
  },
  {
    "text": "after we sanitize the input here I'm going to do some extense checking I know that at this point in the",
    "start": "3417160",
    "end": "3422839"
  },
  {
    "text": "game that I area is an integer if somebody has gotten around this somehow",
    "start": "3422839",
    "end": "3429359"
  },
  {
    "text": "and thrown some characters in there which they're not going to be able to do the replace statement I still have a",
    "start": "3429359",
    "end": "3435200"
  },
  {
    "text": "little bit of power here is that I'm making that an integer value if it can't make it an integer value it'll error out",
    "start": "3435200",
    "end": "3441920"
  },
  {
    "text": "which might be good for me better to have it error out I won't be showing many error messages that them actually",
    "start": "3441920",
    "end": "3448119"
  },
  {
    "text": "injecting SQL so what we're going to do here is I'm going to say is area greater",
    "start": "3448119",
    "end": "3453960"
  },
  {
    "text": "than six because over here I could get I could put a seven",
    "start": "3453960",
    "end": "3460920"
  },
  {
    "text": "in right I could say seven it'd be valid it'd go right through my my cleanser",
    "start": "3461079",
    "end": "3466200"
  },
  {
    "text": "because it's all valid I could say well no I don't want a six I want it to be a seven Seven's not going to hurt us in",
    "start": "3466200",
    "end": "3472240"
  },
  {
    "text": "this case but we don't know that always but we do know that it has to be 0 to six so we check for that if it's greater",
    "start": "3472240",
    "end": "3480319"
  },
  {
    "text": "than six make it a zero I don't care what it is it's a zero",
    "start": "3480319",
    "end": "3486119"
  },
  {
    "text": "now and then at that point we know o logic error what have we done",
    "start": "3486119",
    "end": "3496480"
  },
  {
    "text": "there what if it's negative yes sir",
    "start": "3496480",
    "end": "3504200"
  },
  {
    "text": "well that's a good case you know I might make it zero just in this case so as",
    "start": "3508440",
    "end": "3513920"
  },
  {
    "text": "they still see all of my stuff it depends on your mindset at that point you're absolutely valid what I would",
    "start": "3513920",
    "end": "3519240"
  },
  {
    "text": "probably do and have something else happen like a big skull or flipping them",
    "start": "3519240",
    "end": "3525319"
  },
  {
    "text": "off or something like that to where you say you know what the only way that this could be a seven is if you're messing",
    "start": "3525319",
    "end": "3530440"
  },
  {
    "text": "with me you didn't do it the way I wanted you to do it I know you're screwing with me piss off",
    "start": "3530440",
    "end": "3537079"
  },
  {
    "text": "that might be one thing you do you might want if it's some programmatic method of some robot out there somebody wrote to",
    "start": "3537079",
    "end": "3545079"
  },
  {
    "text": "collect all of the data for them at night so as they don't have to sit there on your website you may want it to just",
    "start": "3545079",
    "end": "3550440"
  },
  {
    "text": "return all the record sets just so as you don't piss anybody off it all depends on what you want it's an absolutely valid point you see what Jim",
    "start": "3550440",
    "end": "3556359"
  },
  {
    "text": "said he said why are you making it zero because if it's zero they're going to get everything like well that's just our",
    "start": "3556359",
    "end": "3563119"
  },
  {
    "text": "choice that's what I made here so here we go we've gone through here",
    "start": "3563119",
    "end": "3569319"
  },
  {
    "text": "and now what I'm doing is I'm building this SQL statement based on cleansed and",
    "start": "3569319",
    "end": "3574839"
  },
  {
    "text": "extense checked data if it's this then this if it's this then this this then this I've kind of limited what it can do",
    "start": "3574839",
    "end": "3582200"
  },
  {
    "text": "now I'm assigning values based on everything that I know it is and I'm I'm building this string variable the other",
    "start": "3582200",
    "end": "3589280"
  },
  {
    "text": "thing that I'm doing here is building in some functionality of additional logic to allow us to search for or other types",
    "start": "3589280",
    "end": "3597000"
  },
  {
    "text": "of things the first two submission types of price and area are equals this or",
    "start": "3597000",
    "end": "3603720"
  },
  {
    "text": "this equals this as we all know whenever we're designing these applications we have",
    "start": "3603720",
    "end": "3608880"
  },
  {
    "text": "more complex logic than that somebody wants a range of prices in this case a house between1 million and $3 million we",
    "start": "3608880",
    "end": "3615359"
  },
  {
    "text": "need to build in this between logic so what we're doing here is building a",
    "start": "3615359",
    "end": "3620400"
  },
  {
    "text": "string building strings are still wrong by the way we're still doing this wrong",
    "start": "3620400",
    "end": "3627960"
  },
  {
    "text": "so we come down here we execute this statement here we",
    "start": "3628599",
    "end": "3634240"
  },
  {
    "text": "have so far pretty much limited programmatically limited what these",
    "start": "3634240",
    "end": "3639920"
  },
  {
    "text": "people can do but I'm still at the end of the day connecting up to this",
    "start": "3639920",
    "end": "3645720"
  },
  {
    "text": "database as the essay user I'm displaying the information in in text format which is bad and I'm executing an",
    "start": "3645720",
    "end": "3653680"
  },
  {
    "text": "ad hoc query even though as if everybody's playing",
    "start": "3653680",
    "end": "3659480"
  },
  {
    "text": "right at this part of the game whatever they're submitting over here even though we're doing a pretty good job now of stripping it out validating the",
    "start": "3659480",
    "end": "3668079"
  },
  {
    "text": "extents we we we have performance problems because we're doing an ad hot query and we also have that ad hoc query",
    "start": "3668079",
    "end": "3675960"
  },
  {
    "text": "being executed in the context of the super user I hate the word Superuser did I mention",
    "start": "3675960",
    "end": "3682720"
  },
  {
    "text": "that yeah thank you is that what essay stands for I thought it was the guy who wrote it his name was",
    "start": "3683799",
    "end": "3692000"
  },
  {
    "text": "sa would be Sue which would be far too",
    "start": "3692440",
    "end": "3698078"
  },
  {
    "text": "close to what Microsoft would do to us whenever we try to publish a vulnerability",
    "start": "3698559",
    "end": "3704720"
  },
  {
    "text": "okays I'm here all week okay um since we're running out of time a",
    "start": "3706440",
    "end": "3712920"
  },
  {
    "text": "little bit I'm not going to submit each one of these I mean at least I'll at least show you that our um our logic",
    "start": "3712920",
    "end": "3721240"
  },
  {
    "text": "works so let's go to what are we on get data 3 let's go to user form",
    "start": "3721240",
    "end": "3728319"
  },
  {
    "text": "3 and I'm going to select everything great I got 122 I guess I was",
    "start": "3728319",
    "end": "3734559"
  },
  {
    "text": "supposed to get 135 but let's say where everything [Music]",
    "start": "3734559",
    "end": "3739960"
  },
  {
    "text": "is area [Music] two area one rather and let's make sure",
    "start": "3739960",
    "end": "3746440"
  },
  {
    "text": "our between logic works and it does so the result in",
    "start": "3746440",
    "end": "3753880"
  },
  {
    "text": "Sequel statement after all this stuff has concatenated the string value that says select MLS address blah blah blah",
    "start": "3753880",
    "end": "3760319"
  },
  {
    "text": "where a is one and price between half a million in one and",
    "start": "3760319",
    "end": "3766200"
  },
  {
    "text": "$750,000 which we can all afford right we're in the IT industry oh there's Beth",
    "start": "3766200",
    "end": "3771880"
  },
  {
    "text": "Beth I talked about you earlier today Beth's the one who told me about the me",
    "start": "3771880",
    "end": "3777359"
  },
  {
    "text": "colon see I thought you had to have that and you don't",
    "start": "3777359",
    "end": "3784200"
  },
  {
    "text": "okay so let's hone this down a little bit more I think it's time to introduce a",
    "start": "3785720",
    "end": "3794160"
  },
  {
    "text": "new variable a new object",
    "start": "3794160",
    "end": "3802318"
  },
  {
    "text": "so so far up here we've still done a relatively good job of stripping out the data blah blah blah we've uh sanitized",
    "start": "3809200",
    "end": "3815359"
  },
  {
    "text": "it validated it what have you we've assigned string",
    "start": "3815359",
    "end": "3820839"
  },
  {
    "text": "values we were still using an ad hoc query this is going to and in a lot of",
    "start": "3822480",
    "end": "3828880"
  },
  {
    "text": "cases we're going to have to do ad hoc queries I mean it's just the way it is in the real world yes everything as",
    "start": "3828880",
    "end": "3834039"
  },
  {
    "text": "opposed to having strongly declared procedures stored procedures",
    "start": "3834039",
    "end": "3839480"
  },
  {
    "text": "and executing everything like that okay so I'm just going to show you how a good way of doing this",
    "start": "3839480",
    "end": "3845079"
  },
  {
    "text": "is SQL has an execute SQL stored procedure available to us that allow",
    "start": "3845079",
    "end": "3851319"
  },
  {
    "text": "that is specifically designed for the execution of ad hoc queries where we can",
    "start": "3851319",
    "end": "3856720"
  },
  {
    "text": "build a string value and submit that string value to the SQL Server that gets parsed",
    "start": "3856720",
    "end": "3865359"
  },
  {
    "text": "in checked and we actually get a performance benefit out of that a little",
    "start": "3865359",
    "end": "3871599"
  },
  {
    "text": "bit what I'm saying now is that my SQL code equals execute",
    "start": "3871640",
    "end": "3878039"
  },
  {
    "text": "SQL and then I'm defining the SQL",
    "start": "3878039",
    "end": "3882680"
  },
  {
    "text": "statement where a SQL equals I'm sorry where a staus equals z",
    "start": "3883200",
    "end": "3890160"
  },
  {
    "text": "and area equals at area",
    "start": "3890160",
    "end": "3896119"
  },
  {
    "text": "the at area expressly defines that as a parameter",
    "start": "3896119",
    "end": "3901960"
  },
  {
    "text": "value okay so it knows to expect a parameter there part of the other",
    "start": "3901960",
    "end": "3907160"
  },
  {
    "text": "parameters for the execute SQL stored procedure as we see here are the",
    "start": "3907160",
    "end": "3913960"
  },
  {
    "text": "Declarations of that parameter and the value assignment of that parameter so",
    "start": "3913960",
    "end": "3920839"
  },
  {
    "text": "I'm saying get it where area equals this parameter value that parameter value has",
    "start": "3920839",
    "end": "3925960"
  },
  {
    "text": "to be an integer see where we say an area equals int so now we're starting to Define this a little bit better so even",
    "start": "3925960",
    "end": "3932440"
  },
  {
    "text": "if somebody throws in some string data in there that happens to get past all of this crap up here we've still have the",
    "start": "3932440",
    "end": "3940279"
  },
  {
    "text": "SQL Server who's going to parse that and go wait a minute I'm expecting an integer here you can't give me character",
    "start": "3940279",
    "end": "3946599"
  },
  {
    "text": "data inside of this guy and then I assign it right there at area equals I area and again I area was the resultant",
    "start": "3946599",
    "end": "3954400"
  },
  {
    "text": "of the extense checked form replacement using the reg XP this is starting to",
    "start": "3954400",
    "end": "3960400"
  },
  {
    "text": "approach something that's a little bit better right you have any questions about the execute",
    "start": "3960400",
    "end": "3968119"
  },
  {
    "text": "SQL what's still our problem correct if people see that some",
    "start": "3969359",
    "end": "3975559"
  },
  {
    "text": "people say well no nobody's ever going to see that let me show you what happened on a",
    "start": "3975559",
    "end": "3981799"
  },
  {
    "text": "Microsoft site recently",
    "start": "3981799",
    "end": "3986000"
  },
  {
    "text": "on the certified partner site which we happen to be certified Partners at anchor",
    "start": "3988960",
    "end": "3995720"
  },
  {
    "text": "is somebody did something that regurgitated this code as an",
    "start": "3995720",
    "end": "4003480"
  },
  {
    "text": "error this was code generated by some of theet",
    "start": "4003520",
    "end": "4008720"
  },
  {
    "text": "servers and of course we couldn't help but go through",
    "start": "4008720",
    "end": "4013680"
  },
  {
    "text": "it this was actually on the",
    "start": "4013920",
    "end": "4018000"
  },
  {
    "text": "net I almost remembered what the line number was lookie",
    "start": "4020160",
    "end": "4025680"
  },
  {
    "text": "lookie line 444 no you can't see",
    "start": "4025680",
    "end": "4032359"
  },
  {
    "text": "that connection string in case in case you were saying people don't really do",
    "start": "4032760",
    "end": "4038640"
  },
  {
    "text": "this the password is mscp data the database is that that's the name of the server and that's the name of the user I",
    "start": "4038640",
    "end": "4044039"
  },
  {
    "text": "got the username the password I got everything I need I got",
    "start": "4044039",
    "end": "4050078"
  },
  {
    "text": "everything pardon right and it's over https which means that I can securely",
    "start": "4050160",
    "end": "4057319"
  },
  {
    "text": "try to hack their system without their IDs going",
    "start": "4057319",
    "end": "4062359"
  },
  {
    "text": "off now if they had gym working for them what they probably would be doing was have it be https all the way up to the",
    "start": "4062359",
    "end": "4069160"
  },
  {
    "text": "ISA server then the ISA server would have HTTP redirected to the internal site so",
    "start": "4069160",
    "end": "4074960"
  },
  {
    "text": "they can be looking so as you're not going from client to web server in an encrypted session so as all my SQL",
    "start": "4074960",
    "end": "4081599"
  },
  {
    "text": "injection is encrypted everything that I'm trying to do you'd never be able to see yes",
    "start": "4081599",
    "end": "4088520"
  },
  {
    "text": "sir really",
    "start": "4088520",
    "end": "4091920"
  },
  {
    "text": "why well that's correct but hopefully that you're on the trusted net at that point",
    "start": "4098600",
    "end": "4103920"
  },
  {
    "text": "but I like the way you think yeah and you shouldn't you shouldn't trust The Trusted",
    "start": "4103920",
    "end": "4109440"
  },
  {
    "text": "net right one other thing that might be embarrassing which I thought was really kind of bad being",
    "start": "4109440",
    "end": "4117759"
  },
  {
    "text": "uh look at this their password is porn",
    "start": "4118319",
    "end": "4123880"
  },
  {
    "text": "online that's a little cheesy that give me the nice warm fuzzy feeling of Microsoft having you know it's like",
    "start": "4126480",
    "end": "4132920"
  },
  {
    "text": "pass's porn online",
    "start": "4132920",
    "end": "4136798"
  },
  {
    "text": "great certified professionals yeah Netscape Engineers",
    "start": "4141000",
    "end": "4146920"
  },
  {
    "text": "are weenies but at least that's true I'm kidding okay so we're running",
    "start": "4146920",
    "end": "4153040"
  },
  {
    "text": "out a little bit of time I want to get in here real quick and um show",
    "start": "4153040",
    "end": "4158520"
  },
  {
    "text": "you really a much better way of doing this got just a couple of minutes",
    "start": "4158520",
    "end": "4166718"
  },
  {
    "text": "I'm leaving this code in here just for um",
    "start": "4167120",
    "end": "4172920"
  },
  {
    "text": "reference still not the best thing to do because I'm using essay and password is suck a fool and blah blah blah but what",
    "start": "4172920",
    "end": "4178560"
  },
  {
    "text": "we've done now is we're creating a Comm a connection object and we're using the command object now to talk to it command",
    "start": "4178560",
    "end": "4188080"
  },
  {
    "text": "object is very strong now this presupposes now that what we've done is",
    "start": "4188080",
    "end": "4193520"
  },
  {
    "text": "gotten our act together and written a stored procedure on the server and what that stored procedure has is all of that",
    "start": "4193520",
    "end": "4199640"
  },
  {
    "text": "SQL text in it it's looking for an integer value of area and that's all the stored procedure is going to accept I'll",
    "start": "4199640",
    "end": "4206440"
  },
  {
    "text": "show you that real super quick super",
    "start": "4206440",
    "end": "4212320"
  },
  {
    "text": "quick well I'll do it I'll do it in my query window",
    "start": "4212320",
    "end": "4218000"
  },
  {
    "text": "um I have a stored procedure out there called get",
    "start": "4218000",
    "end": "4222960"
  },
  {
    "text": "area that accepts that data and where area equals one as you see over here in",
    "start": "4223440",
    "end": "4228800"
  },
  {
    "text": "this fifth column five whatever it is if I try to put area equals",
    "start": "4228800",
    "end": "4235679"
  },
  {
    "text": "blah it's going to error out on me so in this case all it's going to",
    "start": "4235679",
    "end": "4241520"
  },
  {
    "text": "take as this guy is an integer value so that and",
    "start": "4241520",
    "end": "4249080"
  },
  {
    "text": "that's all from the SQL Server standpoint no matter what I'm doing over here that's all he's going to take so that's kind of cool so knowing that we",
    "start": "4249080",
    "end": "4254719"
  },
  {
    "text": "have that let's take a look at how we've structured this command",
    "start": "4254719",
    "end": "4261400"
  },
  {
    "text": "yikes the command object and this is really what you guys should be doing when you walk away from here when you go",
    "start": "4262640",
    "end": "4268840"
  },
  {
    "text": "home use the regular expression object and use the command object if you're doing ad hoc query strings use the",
    "start": "4268840",
    "end": "4275199"
  },
  {
    "text": "execute SQL stored procedure this is really you know I probably could have just said that and",
    "start": "4275199",
    "end": "4280840"
  },
  {
    "text": "we could all go drink but you know we had an hour and 15 to kill",
    "start": "4280840",
    "end": "4286920"
  },
  {
    "text": "we set the command act the command objects active connection to our connection that we created earlier that's the adbo connection the command",
    "start": "4286920",
    "end": "4294120"
  },
  {
    "text": "text is sp get area that's the text that's going to be forwarded onto the SQL Server inside of this command the",
    "start": "4294120",
    "end": "4299719"
  },
  {
    "text": "command type is four so now it expressly knows that this is a stored procedure that I'm executing okay so it's not it's not ad",
    "start": "4299719",
    "end": "4306880"
  },
  {
    "text": "hoc it's like this is a stored procedure treated as such I then create a parameter called",
    "start": "4306880",
    "end": "4313360"
  },
  {
    "text": "area that three tells it that it's integer type and the value of it is I area and I",
    "start": "4313360",
    "end": "4320560"
  },
  {
    "text": "pinned that parameter to the parameter object that I've created in the previous statement then I execute that command",
    "start": "4320560",
    "end": "4328239"
  },
  {
    "text": "object well now we've really now what we've really done is strongly type this",
    "start": "4328239",
    "end": "4333280"
  },
  {
    "text": "thing all they can do is we have a get area we have stripped out anything that",
    "start": "4333280",
    "end": "4338480"
  },
  {
    "text": "they're putting in we've made it an integer we've checked the extense of it",
    "start": "4338480",
    "end": "4343880"
  },
  {
    "text": "we've now packaged up that variable into a command object parameter where we have",
    "start": "4343880",
    "end": "4349120"
  },
  {
    "text": "said to get the area as a store procedure and the area is that integer and then we execute",
    "start": "4349120",
    "end": "4354840"
  },
  {
    "text": "it and that really really starts to arrive to a place of securely passing",
    "start": "4354840",
    "end": "4360679"
  },
  {
    "text": "data back and forth because we've done it on both sides we're checking this is what you",
    "start": "4360679",
    "end": "4366760"
  },
  {
    "text": "were talking about right this is on the website before it even gets passed to the server we've really tightened it",
    "start": "4366760",
    "end": "4374000"
  },
  {
    "text": "down once it gets passed to the server the server since it's a stored procedure",
    "start": "4374000",
    "end": "4379239"
  },
  {
    "text": "is expecting it to be in a particular format the last thing that we want to",
    "start": "4379239",
    "end": "4387080"
  },
  {
    "text": "do is get outside of our essay",
    "start": "4392960",
    "end": "4398280"
  },
  {
    "text": "user in this case I just have a data source name called MLS that data source name uses a trusted connection",
    "start": "4398280",
    "end": "4406679"
  },
  {
    "text": "what we've done now and it's going to take me another the segment's over but it's going to take me another 5 minutes to explain needs to",
    "start": "4406679",
    "end": "4414320"
  },
  {
    "text": "bail I haven't been following my present my PowerPoint presentation but you've got them all in your book I'm still I'm",
    "start": "4416199",
    "end": "4421520"
  },
  {
    "text": "going to wing it I'm winging it for the rest of the five minutes SQL service supports two types",
    "start": "4421520",
    "end": "4428239"
  },
  {
    "text": "of authentication mixed mode authentication and in integrated authentication mixed mode authentication",
    "start": "4428239",
    "end": "4433639"
  },
  {
    "text": "requires you to create SQL users on the SQL box that people use to log in SQL",
    "start": "4433639",
    "end": "4439880"
  },
  {
    "text": "uses that list of people as the valid user base there's problems with that you can't log people um out based on X",
    "start": "4439880",
    "end": "4447239"
  },
  {
    "text": "number of login attempts you can't require passwords you can't or I'm sorry you can't re well you can't require",
    "start": "4447239",
    "end": "4453639"
  },
  {
    "text": "passwords you can't require complex passwords things of that nature did you have a question sir no I was going to I",
    "start": "4453639",
    "end": "4461560"
  },
  {
    "text": "was watching you n authenticated",
    "start": "4461560",
    "end": "4467040"
  },
  {
    "text": "authentication allows you to base all of the access to the SQL server on an ntuser",
    "start": "4468520",
    "end": "4474120"
  },
  {
    "text": "account which gives you affords you the management functions of being able to lock out an account if it's had X number",
    "start": "4474120",
    "end": "4480719"
  },
  {
    "text": "of attempts you can require complex passwords you can require them to change",
    "start": "4480719",
    "end": "4486600"
  },
  {
    "text": "them it also kind of gets us outside of this one user every user mentality of",
    "start": "4487000",
    "end": "4493280"
  },
  {
    "text": "every single query being executed in the the context of the SQL um administrator the",
    "start": "4493280",
    "end": "4499000"
  },
  {
    "text": "sa what we can do now is we can impose permissions if we had more time I'd show",
    "start": "4499000",
    "end": "4505320"
  },
  {
    "text": "you all of that stuff we're not even going to get to do the vulnerabilities but what we can do is",
    "start": "4505320",
    "end": "4512480"
  },
  {
    "text": "say the anonymous user here is part of a public role or we can give him specific",
    "start": "4512480",
    "end": "4518320"
  },
  {
    "text": "permissions himself so that all they can do is they have read access to a view that this",
    "start": "4518320",
    "end": "4526360"
  },
  {
    "text": "data is based on and they have execute permissions of the stored procedure so even if they do hop outside and can",
    "start": "4526360",
    "end": "4532320"
  },
  {
    "text": "execute some arbitrary commands the permissions now are going to be bound to",
    "start": "4532320",
    "end": "4537960"
  },
  {
    "text": "them based on their user context that's a strong thing to do many",
    "start": "4537960",
    "end": "4543639"
  },
  {
    "text": "times it's a difficult thing to do because you've got third party applications you've got Commerce server",
    "start": "4543639",
    "end": "4550480"
  },
  {
    "text": "you've got bis talk server anything that kind of requires mixed mode so on the one hand Microsoft tells us oh well if",
    "start": "4550480",
    "end": "4556840"
  },
  {
    "text": "you're using mixed mode you're an idiot and on the other hand they're telling us well if you want this product you have to use mixed mode okay so there's a",
    "start": "4556840",
    "end": "4562840"
  },
  {
    "text": "little bit of uh what do we call it chip calls that they don't practice what they",
    "start": "4562840",
    "end": "4568440"
  },
  {
    "text": "preach so what we've done now is we finally arrived to a place that we have",
    "start": "4570040",
    "end": "4575920"
  },
  {
    "text": "a trusted connection that has strong akles put on it that allows them to only do what we",
    "start": "4575920",
    "end": "4582000"
  },
  {
    "text": "want them to do and I didn't get to show you all of that that person can maybe execute this SQL",
    "start": "4582000",
    "end": "4590480"
  },
  {
    "text": "command but not other SQL commands we're hiding the connection string we are sanitizing authenticate we're",
    "start": "4590480",
    "end": "4598159"
  },
  {
    "text": "sanitizing typing extense checking value",
    "start": "4598159",
    "end": "4603600"
  },
  {
    "text": "checking we are calling the data now in a strongly typed command object passing",
    "start": "4603600",
    "end": "4610679"
  },
  {
    "text": "the parameter over and then executing that statement to provide the record",
    "start": "4610679",
    "end": "4616840"
  },
  {
    "text": "said any questions on this anyone berer",
    "start": "4617280",
    "end": "4624000"
  },
  {
    "text": "anyone thank you good night actually that's really about it",
    "start": "4624800",
    "end": "4629810"
  },
  {
    "text": "[Applause] yeah um if",
    "start": "4629810",
    "end": "4636119"
  },
  {
    "text": "any",
    "start": "4643840",
    "end": "4646840"
  },
  {
    "text": "e e",
    "start": "4673840",
    "end": "4677840"
  }
]