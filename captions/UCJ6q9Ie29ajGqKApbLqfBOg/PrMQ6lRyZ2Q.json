[
  {
    "start": "0",
    "end": "118000"
  },
  {
    "text": "okay so it's 5:00 I'm going to start the",
    "start": "199",
    "end": "2840"
  },
  {
    "text": "presentation hello my name is Ryan",
    "start": "2840",
    "end": "4759"
  },
  {
    "text": "Johnson I'm from crypto wire in George",
    "start": "4759",
    "end": "6359"
  },
  {
    "text": "Mason University and I also collaborated",
    "start": "6359",
    "end": "8519"
  },
  {
    "text": "with Angelo Sao from crypto wire for",
    "start": "8519",
    "end": "10639"
  },
  {
    "text": "This research and today we're going to",
    "start": "10639",
    "end": "12360"
  },
  {
    "text": "talk about the read logs permission on",
    "start": "12360",
    "end": "14080"
  },
  {
    "text": "Samsung devices and how to get it back",
    "start": "14080",
    "end": "17880"
  },
  {
    "text": "so here's the agenda for today we're",
    "start": "17880",
    "end": "19640"
  },
  {
    "text": "going to talk about the read logs",
    "start": "19640",
    "end": "21560"
  },
  {
    "text": "permission what it is and what it does",
    "start": "21560",
    "end": "23599"
  },
  {
    "text": "we're also going to talk about the",
    "start": "23599",
    "end": "24720"
  },
  {
    "text": "sensitive data that's written to the",
    "start": "24720",
    "end": "26119"
  },
  {
    "text": "Android log we're going to talk about",
    "start": "26119",
    "end": "28320"
  },
  {
    "text": "how to regain the functional equivalent",
    "start": "28320",
    "end": "30480"
  },
  {
    "text": "of the read logs permission on Samsung",
    "start": "30480",
    "end": "32558"
  },
  {
    "text": "devices I'm also going to talk about why",
    "start": "32559",
    "end": "35840"
  },
  {
    "text": "the text of notifications is written to",
    "start": "35840",
    "end": "37840"
  },
  {
    "text": "the Android log on certain Samsung",
    "start": "37840",
    "end": "39719"
  },
  {
    "text": "builds and also talk about how to fix",
    "start": "39719",
    "end": "43200"
  },
  {
    "text": "it so the Android log it's mostly used",
    "start": "43200",
    "end": "46320"
  },
  {
    "text": "for debugging so in your application",
    "start": "46320",
    "end": "48320"
  },
  {
    "text": "When You Reach certain States or an",
    "start": "48320",
    "end": "50239"
  },
  {
    "text": "unexpected event occurs generally you",
    "start": "50239",
    "end": "52840"
  },
  {
    "text": "would want to write something to the log",
    "start": "52840",
    "end": "54879"
  },
  {
    "text": "uh the crash dumps also go to the log so",
    "start": "54879",
    "end": "58600"
  },
  {
    "text": "uh a developer can get the feedback and",
    "start": "58600",
    "end": "60800"
  },
  {
    "text": "improve the program so any process on",
    "start": "60800",
    "end": "63079"
  },
  {
    "text": "the Android operating system can write",
    "start": "63079",
    "end": "65280"
  },
  {
    "text": "to the Android log and if you've written",
    "start": "65280",
    "end": "68000"
  },
  {
    "text": "a program other than uh hello world",
    "start": "68000",
    "end": "70040"
  },
  {
    "text": "application for Android you've probably",
    "start": "70040",
    "end": "71520"
  },
  {
    "text": "used the Android log you use it using",
    "start": "71520",
    "end": "73759"
  },
  {
    "text": "the standard Android API it's uh Android",
    "start": "73759",
    "end": "76640"
  },
  {
    "text": "u. log for the main log SL log for the",
    "start": "76640",
    "end": "79600"
  },
  {
    "text": "system log and event log for the event",
    "start": "79600",
    "end": "81720"
  },
  {
    "text": "log and also if you use certain log tags",
    "start": "81720",
    "end": "83840"
  },
  {
    "text": "it will go into the Radio log generally",
    "start": "83840",
    "end": "86159"
  },
  {
    "text": "you read it with log cat which will uh",
    "start": "86159",
    "end": "88200"
  },
  {
    "text": "look at the log buffers and Translate",
    "start": "88200",
    "end": "90040"
  },
  {
    "text": "them from binary to plain text format",
    "start": "90040",
    "end": "92159"
  },
  {
    "text": "because it's easier to work with and on",
    "start": "92159",
    "end": "94759"
  },
  {
    "text": "current Android builds you need your",
    "start": "94759",
    "end": "97159"
  },
  {
    "text": "application when it's installed it gets",
    "start": "97159",
    "end": "99000"
  },
  {
    "text": "a user ID and it gets assigned groups",
    "start": "99000",
    "end": "101000"
  },
  {
    "text": "depending on the permission and you will",
    "start": "101000",
    "end": "103159"
  },
  {
    "text": "need to have the be part of the log",
    "start": "103159",
    "end": "105759"
  },
  {
    "text": "group to actually get full access to the",
    "start": "105759",
    "end": "107439"
  },
  {
    "text": "Android log and Google Google",
    "start": "107439",
    "end": "109960"
  },
  {
    "text": "applications user apps any thirdparty",
    "start": "109960",
    "end": "112200"
  },
  {
    "text": "applications as well as the Android",
    "start": "112200",
    "end": "114200"
  },
  {
    "text": "operating system itself can write",
    "start": "114200",
    "end": "116399"
  },
  {
    "text": "sensitive data to the Android log",
    "start": "116399",
    "end": "120920"
  },
  {
    "start": "118000",
    "end": "118000"
  },
  {
    "text": "so the read logs permission gives you",
    "start": "120920",
    "end": "122600"
  },
  {
    "text": "access to these device logs uh on",
    "start": "122600",
    "end": "125000"
  },
  {
    "text": "Android 4.1 and Below you could just",
    "start": "125000",
    "end": "127360"
  },
  {
    "text": "request the read logs permission and",
    "start": "127360",
    "end": "129479"
  },
  {
    "text": "this would be granted to any application",
    "start": "129479",
    "end": "131239"
  },
  {
    "text": "and you would be able to read the log",
    "start": "131239",
    "end": "132879"
  },
  {
    "text": "messages uh systemwide from any process",
    "start": "132879",
    "end": "135720"
  },
  {
    "text": "on the operating system on Android 4.1",
    "start": "135720",
    "end": "138480"
  },
  {
    "text": "and up this permission was no longer",
    "start": "138480",
    "end": "140319"
  },
  {
    "text": "granted to uh user",
    "start": "140319",
    "end": "142319"
  },
  {
    "text": "applications um on the left is a snippet",
    "start": "142319",
    "end": "145480"
  },
  {
    "text": "from the Android manifest.xml from the",
    "start": "145480",
    "end": "148360"
  },
  {
    "text": "Android package and this is actually",
    "start": "148360",
    "end": "150200"
  },
  {
    "text": "where",
    "start": "150200",
    "end": "151680"
  },
  {
    "text": "the the read logs permission is declared",
    "start": "151680",
    "end": "155200"
  },
  {
    "text": "so at the top you can see an XML comment",
    "start": "155200",
    "end": "157319"
  },
  {
    "text": "saying why they took it away it's",
    "start": "157319",
    "end": "158879"
  },
  {
    "text": "essentially because it can contain",
    "start": "158879",
    "end": "160400"
  },
  {
    "text": "private data uh the red text below that",
    "start": "160400",
    "end": "163000"
  },
  {
    "text": "is actually where the read logs",
    "start": "163000",
    "end": "164159"
  },
  {
    "text": "permission is declared and F further",
    "start": "164159",
    "end": "166519"
  },
  {
    "text": "below that shows the protection level of",
    "start": "166519",
    "end": "169400"
  },
  {
    "text": "this permission which is system",
    "start": "169400",
    "end": "171480"
  },
  {
    "text": "signature or development so you either",
    "start": "171480",
    "end": "173440"
  },
  {
    "text": "need to be signed with your application",
    "start": "173440",
    "end": "174959"
  },
  {
    "text": "needs to be signed with a platform key",
    "start": "174959",
    "end": "177400"
  },
  {
    "text": "or it needs to be a system app it needs",
    "start": "177400",
    "end": "179640"
  },
  {
    "text": "to be be installed on the system",
    "start": "179640",
    "end": "180959"
  },
  {
    "text": "partition or it's also a development",
    "start": "180959",
    "end": "183599"
  },
  {
    "text": "permission so a user can explicitly",
    "start": "183599",
    "end": "185480"
  },
  {
    "text": "Grant this permission to an application",
    "start": "185480",
    "end": "187599"
  },
  {
    "text": "using ADB shell PM Grant package name",
    "start": "187599",
    "end": "190400"
  },
  {
    "text": "and then the permission which is read",
    "start": "190400",
    "end": "192879"
  },
  {
    "text": "logs so why try to regain the read logs",
    "start": "192879",
    "end": "196000"
  },
  {
    "start": "193000",
    "end": "193000"
  },
  {
    "text": "permission it's for the same reason they",
    "start": "196000",
    "end": "197599"
  },
  {
    "text": "took it away it's for the private data",
    "start": "197599",
    "end": "199640"
  },
  {
    "text": "so these are just some of the items that",
    "start": "199640",
    "end": "201319"
  },
  {
    "text": "I've noticed showing up in the Android",
    "start": "201319",
    "end": "203040"
  },
  {
    "text": "log there's the user's email address",
    "start": "203040",
    "end": "205360"
  },
  {
    "text": "there's the cell tower ID and each of",
    "start": "205360",
    "end": "207799"
  },
  {
    "text": "these log entries has a Tim stamp so you",
    "start": "207799",
    "end": "209959"
  },
  {
    "text": "can kind of track the user uh see what",
    "start": "209959",
    "end": "212319"
  },
  {
    "text": "they're doing at certain times so the",
    "start": "212319",
    "end": "213640"
  },
  {
    "text": "cell tower ID once you have the cell",
    "start": "213640",
    "end": "215680"
  },
  {
    "text": "tower ID you can access uh free an open",
    "start": "215680",
    "end": "218239"
  },
  {
    "text": "database to see exactly the latitude and",
    "start": "218239",
    "end": "221239"
  },
  {
    "text": "longitude of that cell tower and kind of",
    "start": "221239",
    "end": "223159"
  },
  {
    "text": "if the user is moving you can see the",
    "start": "223159",
    "end": "225159"
  },
  {
    "text": "different cell towers uh that they're",
    "start": "225159",
    "end": "227280"
  },
  {
    "text": "connecting to when they're doing the",
    "start": "227280",
    "end": "228599"
  },
  {
    "text": "handoff between base stations there's",
    "start": "228599",
    "end": "230560"
  },
  {
    "text": "also raw GPS data from the satellite so",
    "start": "230560",
    "end": "233120"
  },
  {
    "text": "you can further process this and get the",
    "start": "233120",
    "end": "234840"
  },
  {
    "text": "exact coordinates of the user there's",
    "start": "234840",
    "end": "237720"
  },
  {
    "text": "also non-google account username so seen",
    "start": "237720",
    "end": "240120"
  },
  {
    "text": "Twitter show up so you can get the",
    "start": "240120",
    "end": "241720"
  },
  {
    "text": "user's Twitter profile start looking at",
    "start": "241720",
    "end": "244120"
  },
  {
    "text": "pictures and uh get information about",
    "start": "244120",
    "end": "246280"
  },
  {
    "text": "them depending on their uh privacy",
    "start": "246280",
    "end": "248439"
  },
  {
    "text": "settings their cellular network and",
    "start": "248439",
    "end": "250120"
  },
  {
    "text": "Wi-Fi information so you can get the",
    "start": "250120",
    "end": "251720"
  },
  {
    "text": "private IP address uh on the carrier the",
    "start": "251720",
    "end": "254319"
  },
  {
    "text": "private IP address on the wireless",
    "start": "254319",
    "end": "256239"
  },
  {
    "text": "network the SSID routing information the",
    "start": "256239",
    "end": "258799"
  },
  {
    "text": "DNS Gateway and the default gateway",
    "start": "258799",
    "end": "261720"
  },
  {
    "text": "there's also the voicemail number that",
    "start": "261720",
    "end": "263240"
  },
  {
    "text": "shows up so once you have the voic mail",
    "start": "263240",
    "end": "265560"
  },
  {
    "text": "number you could try a guessing attack",
    "start": "265560",
    "end": "267960"
  },
  {
    "text": "on their pin as well as a brute Force",
    "start": "267960",
    "end": "270080"
  },
  {
    "text": "attack depending on the security",
    "start": "270080",
    "end": "271560"
  },
  {
    "text": "settings of the",
    "start": "271560",
    "end": "273479"
  },
  {
    "text": "voicemail uh I also saw the my full name",
    "start": "273479",
    "end": "277160"
  },
  {
    "text": "show there was associated with one of my",
    "start": "277160",
    "end": "278880"
  },
  {
    "text": "Gmail accounts show up in the log the",
    "start": "278880",
    "end": "280880"
  },
  {
    "text": "Google ID show up in the log so you can",
    "start": "280880",
    "end": "282560"
  },
  {
    "text": "take this Google ID uh put it into",
    "start": "282560",
    "end": "285120"
  },
  {
    "text": "Google+ and start looking uh at their",
    "start": "285120",
    "end": "287720"
  },
  {
    "text": "profile depending on their privacy",
    "start": "287720",
    "end": "290000"
  },
  {
    "text": "settings you might see their picture or",
    "start": "290000",
    "end": "291400"
  },
  {
    "text": "anything they share publicly you can",
    "start": "291400",
    "end": "293280"
  },
  {
    "text": "also tell when the user is present or",
    "start": "293280",
    "end": "294960"
  },
  {
    "text": "not there's a broadcast intent action",
    "start": "294960",
    "end": "297600"
  },
  {
    "text": "user present which is sent when the user",
    "start": "297600",
    "end": "300479"
  },
  {
    "text": "is active so you can tell when they're",
    "start": "300479",
    "end": "302320"
  },
  {
    "text": "not present so then if you're doing some",
    "start": "302320",
    "end": "304639"
  },
  {
    "text": "attack you might want to wait till",
    "start": "304639",
    "end": "307160"
  },
  {
    "text": "they're not present just in case there's",
    "start": "307160",
    "end": "308600"
  },
  {
    "text": "any side",
    "start": "308600",
    "end": "310600"
  },
  {
    "text": "effects there's also uh various IDs",
    "start": "310600",
    "end": "313720"
  },
  {
    "text": "which are associated with the pin or the",
    "start": "313720",
    "end": "315520"
  },
  {
    "text": "SIM card which is the ICC ID the MC the",
    "start": "315520",
    "end": "319039"
  },
  {
    "text": "MCC MNC so you can see the country",
    "start": "319039",
    "end": "321080"
  },
  {
    "text": "they're in as well as their carrier the",
    "start": "321080",
    "end": "323280"
  },
  {
    "text": "device serial number and the MAC address",
    "start": "323280",
    "end": "325880"
  },
  {
    "text": "um so these are some unique IDs you",
    "start": "325880",
    "end": "327880"
  },
  {
    "text": "could use to track the user and also",
    "start": "327880",
    "end": "329960"
  },
  {
    "text": "when you send an intent from one",
    "start": "329960",
    "end": "331600"
  },
  {
    "text": "application to another this shows up in",
    "start": "331600",
    "end": "333240"
  },
  {
    "text": "the Android log you can also embed a URI",
    "start": "333240",
    "end": "336800"
  },
  {
    "text": "into the intent and this will show up in",
    "start": "336800",
    "end": "338400"
  },
  {
    "text": "the log as well so say if you're using",
    "start": "338400",
    "end": "339960"
  },
  {
    "text": "Google search and then you uh search",
    "start": "339960",
    "end": "342479"
  },
  {
    "text": "something you click on it it will send",
    "start": "342479",
    "end": "344360"
  },
  {
    "text": "an intent to the browser with that URI",
    "start": "344360",
    "end": "346840"
  },
  {
    "text": "so you can see what the user is",
    "start": "346840",
    "end": "348120"
  },
  {
    "text": "searching for and looking at also when",
    "start": "348120",
    "end": "350400"
  },
  {
    "text": "you're using Chrome anytime there's any",
    "start": "350400",
    "end": "352039"
  },
  {
    "text": "errors this could be just due to",
    "start": "352039",
    "end": "353800"
  },
  {
    "text": "connectivity issues uh these URLs for",
    "start": "353800",
    "end": "356440"
  },
  {
    "text": "which there are errors will show up in",
    "start": "356440",
    "end": "357840"
  },
  {
    "text": "the Android log you can also tell uh",
    "start": "357840",
    "end": "360759"
  },
  {
    "text": "which applications and processes are",
    "start": "360759",
    "end": "362840"
  },
  {
    "text": "executing on the system and when because",
    "start": "362840",
    "end": "365560"
  },
  {
    "text": "activity manager provides all of this",
    "start": "365560",
    "end": "368520"
  },
  {
    "text": "data so here we have uh on the left a",
    "start": "368520",
    "end": "372199"
  },
  {
    "start": "369000",
    "end": "369000"
  },
  {
    "text": "screenshot showing various notifications",
    "start": "372199",
    "end": "374360"
  },
  {
    "text": "I've chosen to highlight the uh a text",
    "start": "374360",
    "end": "377080"
  },
  {
    "text": "message that was received and over on",
    "start": "377080",
    "end": "379479"
  },
  {
    "text": "the right is a log entry from a dump",
    "start": "379479",
    "end": "381520"
  },
  {
    "text": "State file",
    "start": "381520",
    "end": "383639"
  },
  {
    "text": "and the text in red on the top is the",
    "start": "383639",
    "end": "387039"
  },
  {
    "text": "log tag which is notification NQ the the",
    "start": "387039",
    "end": "390280"
  },
  {
    "text": "next red text is com. android.mms which",
    "start": "390280",
    "end": "393479"
  },
  {
    "text": "is the application which sent this",
    "start": "393479",
    "end": "395280"
  },
  {
    "text": "notification below that is the actual",
    "start": "395280",
    "end": "398840"
  },
  {
    "text": "the text of the notification that the",
    "start": "398840",
    "end": "401080"
  },
  {
    "text": "user sees so you can see it's from the",
    "start": "401080",
    "end": "403599"
  },
  {
    "text": "number",
    "start": "403599",
    "end": "405240"
  },
  {
    "text": "224444 and you can also see the",
    "start": "405240",
    "end": "407240"
  },
  {
    "text": "verification code which is 546 729 so",
    "start": "407240",
    "end": "411039"
  },
  {
    "text": "using this uh if you if you have an app",
    "start": "411039",
    "end": "414080"
  },
  {
    "text": "on the user's device you're reading the",
    "start": "414080",
    "end": "416039"
  },
  {
    "text": "logs you get their Gmail account which",
    "start": "416039",
    "end": "418080"
  },
  {
    "text": "shows up in the log then you send a",
    "start": "418080",
    "end": "420039"
  },
  {
    "text": "password reset and then elect it receive",
    "start": "420039",
    "end": "422400"
  },
  {
    "text": "it via text message and then you can",
    "start": "422400",
    "end": "424639"
  },
  {
    "text": "essentially lock them out of their",
    "start": "424639",
    "end": "425919"
  },
  {
    "text": "account their Gmail account and then see",
    "start": "425919",
    "end": "428879"
  },
  {
    "text": "lock them out of other accounts where",
    "start": "428879",
    "end": "430599"
  },
  {
    "text": "they use the Gmail account as a a",
    "start": "430599",
    "end": "432800"
  },
  {
    "text": "recovery email so you can start taking",
    "start": "432800",
    "end": "434560"
  },
  {
    "text": "over some of their accounts and uh this",
    "start": "434560",
    "end": "437759"
  },
  {
    "text": "is a method to bypass two Factor",
    "start": "437759",
    "end": "441240"
  },
  {
    "start": "441000",
    "end": "441000"
  },
  {
    "text": "authentication so any application or",
    "start": "441240",
    "end": "444080"
  },
  {
    "text": "process can write any ARB arbitrary data",
    "start": "444080",
    "end": "446479"
  },
  {
    "text": "to the log so I've chosen to highlight",
    "start": "446479",
    "end": "448879"
  },
  {
    "text": "uh an unnam named uh fitness and health",
    "start": "448879",
    "end": "451039"
  },
  {
    "text": "application that's on Google Play it",
    "start": "451039",
    "end": "453560"
  },
  {
    "text": "writes everything possible to the log",
    "start": "453560",
    "end": "456039"
  },
  {
    "text": "it's fairly popular it's got 5 to 10",
    "start": "456039",
    "end": "458120"
  },
  {
    "text": "million installations according to",
    "start": "458120",
    "end": "460199"
  },
  {
    "text": "Google Play 85,000 reviews and I also",
    "start": "460199",
    "end": "462759"
  },
  {
    "text": "told the company of uh the behavior of",
    "start": "462759",
    "end": "465159"
  },
  {
    "text": "writing all the sensitive data to the",
    "start": "465159",
    "end": "467639"
  },
  {
    "text": "log so here we actually have uh the log",
    "start": "467639",
    "end": "470240"
  },
  {
    "text": "messages I've redacted uh some of the",
    "start": "470240",
    "end": "472039"
  },
  {
    "text": "items so the app isn't identified but",
    "start": "472039",
    "end": "473919"
  },
  {
    "text": "there's the user login so there's the",
    "start": "473919",
    "end": "475720"
  },
  {
    "text": "Gmail account that I use to create the",
    "start": "475720",
    "end": "477840"
  },
  {
    "text": "account uh for the application there's",
    "start": "477840",
    "end": "480520"
  },
  {
    "text": "also the password I used there's also",
    "start": "480520",
    "end": "483000"
  },
  {
    "text": "the cookie which using the cookie as",
    "start": "483000",
    "end": "485240"
  },
  {
    "text": "long as it wasn't expired you could log",
    "start": "485240",
    "end": "486800"
  },
  {
    "text": "in uh without the username and login but",
    "start": "486800",
    "end": "489360"
  },
  {
    "text": "that's not necessary since you they also",
    "start": "489360",
    "end": "491400"
  },
  {
    "text": "give you the username and",
    "start": "491400",
    "end": "493400"
  },
  {
    "text": "password so here are some more uh items",
    "start": "493400",
    "end": "496400"
  },
  {
    "text": "that are written to the log there's a",
    "start": "496400",
    "end": "497840"
  },
  {
    "text": "security token which could be used for",
    "start": "497840",
    "end": "499800"
  },
  {
    "text": "ooth and in the application you can",
    "start": "499800",
    "end": "502240"
  },
  {
    "text": "input any medical procedures you've",
    "start": "502240",
    "end": "504360"
  },
  {
    "text": "undergone as well as any medications",
    "start": "504360",
    "end": "506360"
  },
  {
    "text": "that you're taking so whenever you enter",
    "start": "506360",
    "end": "508000"
  },
  {
    "text": "them into the app application it will",
    "start": "508000",
    "end": "510400"
  },
  {
    "text": "immediately write them to the Android",
    "start": "510400",
    "end": "511960"
  },
  {
    "text": "log so I've just entered some phony data",
    "start": "511960",
    "end": "514518"
  },
  {
    "text": "in",
    "start": "514519",
    "end": "515360"
  },
  {
    "text": "here and uh this is medical information",
    "start": "515360",
    "end": "517800"
  },
  {
    "text": "so it's generally regarded as highly",
    "start": "517800",
    "end": "520159"
  },
  {
    "text": "sensitive you can also put any",
    "start": "520159",
    "end": "522320"
  },
  {
    "text": "conditions you have in the Android log",
    "start": "522320",
    "end": "524320"
  },
  {
    "text": "so I just entered some phony data here",
    "start": "524320",
    "end": "526399"
  },
  {
    "text": "you can also input insurance information",
    "start": "526399",
    "end": "529320"
  },
  {
    "text": "so I just used a a phony Etna account",
    "start": "529320",
    "end": "531880"
  },
  {
    "text": "and put in the member ID and group",
    "start": "531880",
    "end": "534560"
  },
  {
    "text": "number and then this also showed up in",
    "start": "534560",
    "end": "536600"
  },
  {
    "text": "the Android log",
    "start": "536600",
    "end": "539800"
  },
  {
    "start": "539000",
    "end": "539000"
  },
  {
    "text": "so regaining Android log access so I've",
    "start": "539800",
    "end": "542959"
  },
  {
    "text": "identified three um conditions which",
    "start": "542959",
    "end": "545120"
  },
  {
    "text": "will trigger a world readable log file",
    "start": "545120",
    "end": "547279"
  },
  {
    "text": "to be generated on uh Samsung builds of",
    "start": "547279",
    "end": "550560"
  },
  {
    "text": "Android so if there's an uncaught",
    "start": "550560",
    "end": "552200"
  },
  {
    "text": "exception in the apps delic bite code so",
    "start": "552200",
    "end": "554320"
  },
  {
    "text": "your application is executing and",
    "start": "554320",
    "end": "555920"
  },
  {
    "text": "there's some uncaught runtime exception",
    "start": "555920",
    "end": "558040"
  },
  {
    "text": "this will force close the app and then",
    "start": "558040",
    "end": "560000"
  },
  {
    "text": "also generate the world readable log",
    "start": "560000",
    "end": "561640"
  },
  {
    "text": "file uh there's an application not",
    "start": "561640",
    "end": "564000"
  },
  {
    "text": "responding event or an anr event if the",
    "start": "564000",
    "end": "567240"
  },
  {
    "text": "application is not responsive to the",
    "start": "567240",
    "end": "568959"
  },
  {
    "text": "user and it's doing too much work on its",
    "start": "568959",
    "end": "570640"
  },
  {
    "text": "UI thread and not responding to UI",
    "start": "570640",
    "end": "572480"
  },
  {
    "text": "events then it'll be an anr event and",
    "start": "572480",
    "end": "575959"
  },
  {
    "text": "this will also generate a world readable",
    "start": "575959",
    "end": "577880"
  },
  {
    "text": "log",
    "start": "577880",
    "end": "578720"
  },
  {
    "text": "file uh the last is if your application",
    "start": "578720",
    "end": "581279"
  },
  {
    "text": "has a native code library and some sort",
    "start": "581279",
    "end": "583120"
  },
  {
    "text": "of error is encountered in the native",
    "start": "583120",
    "end": "584959"
  },
  {
    "text": "code Library this will also generate a",
    "start": "584959",
    "end": "586600"
  },
  {
    "text": "world readable log file and the first",
    "start": "586600",
    "end": "588640"
  },
  {
    "text": "two will actually generate a system",
    "start": "588640",
    "end": "590440"
  },
  {
    "text": "message indicating the user that",
    "start": "590440",
    "end": "591880"
  },
  {
    "text": "something has happened and the third one",
    "start": "591880",
    "end": "593920"
  },
  {
    "text": "will not if done",
    "start": "593920",
    "end": "596399"
  },
  {
    "text": "properly so here we have uh pictures of",
    "start": "596399",
    "end": "599160"
  },
  {
    "start": "597000",
    "end": "597000"
  },
  {
    "text": "the three events on the the left is the",
    "start": "599160",
    "end": "602640"
  },
  {
    "text": "uncaught exception which essentially",
    "start": "602640",
    "end": "604200"
  },
  {
    "text": "force closes the application and",
    "start": "604200",
    "end": "605800"
  },
  {
    "text": "displays the system message to the user",
    "start": "605800",
    "end": "607959"
  },
  {
    "text": "the picture in the middle is the anr",
    "start": "607959",
    "end": "610040"
  },
  {
    "text": "event which it will prompt the user",
    "start": "610040",
    "end": "611959"
  },
  {
    "text": "whether they want to wait for the",
    "start": "611959",
    "end": "613240"
  },
  {
    "text": "application to become responsive for",
    "start": "613240",
    "end": "614800"
  },
  {
    "text": "some period of time or if they just want",
    "start": "614800",
    "end": "616120"
  },
  {
    "text": "to kill the application and the third is",
    "start": "616120",
    "end": "618240"
  },
  {
    "text": "the native code error which in this when",
    "start": "618240",
    "end": "620680"
  },
  {
    "text": "done properly won't generate any message",
    "start": "620680",
    "end": "623440"
  },
  {
    "text": "and we'll go on to display or perform",
    "start": "623440",
    "end": "625560"
  },
  {
    "text": "whatever functionality functionality it",
    "start": "625560",
    "end": "627680"
  },
  {
    "text": "was intended to which in this case was",
    "start": "627680",
    "end": "629320"
  },
  {
    "text": "is just to display an image",
    "start": "629320",
    "end": "632640"
  },
  {
    "start": "632000",
    "end": "632000"
  },
  {
    "text": "view so the dump State binary is",
    "start": "632640",
    "end": "635200"
  },
  {
    "text": "responsible for writing the world",
    "start": "635200",
    "end": "636839"
  },
  {
    "text": "readable log files so dump state is run",
    "start": "636839",
    "end": "639440"
  },
  {
    "text": "anytime there's some sort of error or",
    "start": "639440",
    "end": "641320"
  },
  {
    "text": "like unexpected condition in the",
    "start": "641320",
    "end": "643000"
  },
  {
    "text": "application it can't be run by user",
    "start": "643000",
    "end": "645120"
  },
  {
    "text": "applications you need to either be the",
    "start": "645120",
    "end": "647200"
  },
  {
    "text": "shell user belong to the log group to",
    "start": "647200",
    "end": "650279"
  },
  {
    "text": "actually Su or be root the root user to",
    "start": "650279",
    "end": "652800"
  },
  {
    "text": "successfully uh get the output from",
    "start": "652800",
    "end": "654760"
  },
  {
    "text": "dumpstate so the dumpstate file it's",
    "start": "654760",
    "end": "657399"
  },
  {
    "text": "usually 3 to 6 megabytes it contains the",
    "start": "657399",
    "end": "659560"
  },
  {
    "text": "Android log the kernel log system",
    "start": "659560",
    "end": "661680"
  },
  {
    "text": "properties as well as a lot of data from",
    "start": "661680",
    "end": "663680"
  },
  {
    "text": "the proc file system and below is the",
    "start": "663680",
    "end": "667279"
  },
  {
    "text": "actual path to the",
    "start": "667279",
    "end": "669279"
  },
  {
    "start": "669000",
    "end": "669000"
  },
  {
    "text": "binary so the error in native code what",
    "start": "669279",
    "end": "671800"
  },
  {
    "text": "you would do is you would have an",
    "start": "671800",
    "end": "672880"
  },
  {
    "text": "application you would integrate a native",
    "start": "672880",
    "end": "675000"
  },
  {
    "text": "code Library into this application so",
    "start": "675000",
    "end": "677279"
  },
  {
    "text": "then uh from the Java layer dvic you",
    "start": "677279",
    "end": "680240"
  },
  {
    "text": "would use the Java native interface or",
    "start": "680240",
    "end": "682519"
  },
  {
    "text": "jni to call into a c function so once",
    "start": "682519",
    "end": "685360"
  },
  {
    "text": "you're in the C function you're outside",
    "start": "685360",
    "end": "687120"
  },
  {
    "text": "of the dvic virtual machine you want to",
    "start": "687120",
    "end": "688920"
  },
  {
    "text": "for the process which essentially clones",
    "start": "688920",
    "end": "690959"
  },
  {
    "text": "the process in the child process you",
    "start": "690959",
    "end": "693000"
  },
  {
    "text": "want to call abort and in the parent",
    "start": "693000",
    "end": "695320"
  },
  {
    "text": "process you essentially just want to",
    "start": "695320",
    "end": "696880"
  },
  {
    "text": "return from the function back into the",
    "start": "696880",
    "end": "698839"
  },
  {
    "text": "dvic virtual machine and when the child",
    "start": "698839",
    "end": "701480"
  },
  {
    "text": "process calls abort it's going to the",
    "start": "701480",
    "end": "703720"
  },
  {
    "text": "abort function it's going to send the",
    "start": "703720",
    "end": "705160"
  },
  {
    "text": "sigo signal which is going to get",
    "start": "705160",
    "end": "707000"
  },
  {
    "text": "handled by debugger D which uh debugger",
    "start": "707000",
    "end": "709880"
  },
  {
    "text": "D runs his route and this is going to",
    "start": "709880",
    "end": "711440"
  },
  {
    "text": "call dump State and it has the",
    "start": "711440",
    "end": "712720"
  },
  {
    "text": "permission to do so or the Privileges",
    "start": "712720",
    "end": "714800"
  },
  {
    "text": "since it's running his rout and uh",
    "start": "714800",
    "end": "717040"
  },
  {
    "text": "debugger D it in injects or it sets the",
    "start": "717040",
    "end": "720600"
  },
  {
    "text": "default signal handlers into processes",
    "start": "720600",
    "end": "723240"
  },
  {
    "text": "uh in Android so once Sig it injects",
    "start": "723240",
    "end": "726360"
  },
  {
    "text": "that signal Handler so it will get",
    "start": "726360",
    "end": "727920"
  },
  {
    "text": "called once the Cort signal is sent and",
    "start": "727920",
    "end": "731440"
  },
  {
    "text": "on Samsung devices there's the actual",
    "start": "731440",
    "end": "733600"
  },
  {
    "text": "path to the dump State file when you",
    "start": "733600",
    "end": "735959"
  },
  {
    "text": "create an error in native code it's",
    "start": "735959",
    "end": "737920"
  },
  {
    "text": "/data log dumpstate app native text.",
    "start": "737920",
    "end": "741079"
  },
  {
    "text": "gzip and if you do it properly uh if you",
    "start": "741079",
    "end": "744440"
  },
  {
    "text": "Fork the process and do this it won't",
    "start": "744440",
    "end": "746160"
  },
  {
    "text": "generate any error message but if you",
    "start": "746160",
    "end": "748040"
  },
  {
    "text": "don't Fork the process it will generate",
    "start": "748040",
    "end": "750279"
  },
  {
    "text": "an error message and crashy",
    "start": "750279",
    "end": "753360"
  },
  {
    "start": "753000",
    "end": "753000"
  },
  {
    "text": "application so here is a partial listing",
    "start": "753360",
    "end": "755600"
  },
  {
    "text": "of files in the SL dat log directory",
    "start": "755600",
    "end": "758959"
  },
  {
    "text": "there's the three dump State files that",
    "start": "758959",
    "end": "761800"
  },
  {
    "text": "um correspond to the three conditions",
    "start": "761800",
    "end": "764160"
  },
  {
    "text": "that I mentioned previously and the",
    "start": "764160",
    "end": "766399"
  },
  {
    "text": "thing to pay attention to are the",
    "start": "766399",
    "end": "768120"
  },
  {
    "text": "highlighted RS in red which uh on the",
    "start": "768120",
    "end": "772040"
  },
  {
    "text": "file permissions which show that these",
    "start": "772040",
    "end": "773560"
  },
  {
    "text": "files are publicly readable by any user",
    "start": "773560",
    "end": "775480"
  },
  {
    "text": "on the device so any application on the",
    "start": "775480",
    "end": "777440"
  },
  {
    "text": "device can read these files",
    "start": "777440",
    "end": "779920"
  },
  {
    "text": "and below is the actual command that's",
    "start": "779920",
    "end": "782120"
  },
  {
    "text": "being executed by debugger D to generate",
    "start": "782120",
    "end": "785959"
  },
  {
    "text": "the dump State",
    "start": "785959",
    "end": "787519"
  },
  {
    "start": "787000",
    "end": "787000"
  },
  {
    "text": "file so the SL dat log directory this is",
    "start": "787519",
    "end": "791480"
  },
  {
    "text": "not in standard AOSP it was created by",
    "start": "791480",
    "end": "794000"
  },
  {
    "text": "Samsung so I pulled the init RC file off",
    "start": "794000",
    "end": "797160"
  },
  {
    "text": "of Samsung Android 4.4.2 builds and the",
    "start": "797160",
    "end": "800720"
  },
  {
    "text": "init RC is a script that runs after boot",
    "start": "800720",
    "end": "802880"
  },
  {
    "text": "to perform certain commands and start",
    "start": "802880",
    "end": "804720"
  },
  {
    "text": "services so here uh the actual snippet",
    "start": "804720",
    "end": "807720"
  },
  {
    "text": "from the in RC file shows that they're",
    "start": "807720",
    "end": "810240"
  },
  {
    "text": "creating the/ dat log directory changing",
    "start": "810240",
    "end": "813639"
  },
  {
    "text": "the owner of it and then changing the",
    "start": "813639",
    "end": "815320"
  },
  {
    "text": "file",
    "start": "815320",
    "end": "817440"
  },
  {
    "start": "817000",
    "end": "817000"
  },
  {
    "text": "permissions so the dump State file I've",
    "start": "817440",
    "end": "819839"
  },
  {
    "text": "provided a snippet here and it contains",
    "start": "819839",
    "end": "823399"
  },
  {
    "text": "uh a date and time stamp the process ID",
    "start": "823399",
    "end": "826480"
  },
  {
    "text": "that wrote The Log message the parent",
    "start": "826480",
    "end": "828199"
  },
  {
    "text": "process ID the log level the log tag and",
    "start": "828199",
    "end": "831560"
  },
  {
    "text": "the log message so here I've highlighted",
    "start": "831560",
    "end": "834279"
  },
  {
    "text": "uh a log entry the in red the first one",
    "start": "834279",
    "end": "837639"
  },
  {
    "text": "is notification NQ which is the log tag",
    "start": "837639",
    "end": "840480"
  },
  {
    "text": "which the notifications are getting",
    "start": "840480",
    "end": "841959"
  },
  {
    "text": "written to the log the next is the",
    "start": "841959",
    "end": "844120"
  },
  {
    "text": "package name of the application that",
    "start": "844120",
    "end": "845759"
  },
  {
    "text": "wrote The Log message in this instance",
    "start": "845759",
    "end": "848079"
  },
  {
    "text": "it's com. WhatsApp which is the package",
    "start": "848079",
    "end": "850040"
  },
  {
    "text": "name for WhatsApp on Android and the",
    "start": "850040",
    "end": "852800"
  },
  {
    "text": "rest of the red text is the actual text",
    "start": "852800",
    "end": "855680"
  },
  {
    "text": "of the notification so this is just a",
    "start": "855680",
    "end": "857759"
  },
  {
    "text": "message that says test message for the",
    "start": "857759",
    "end": "859480"
  },
  {
    "text": "Android log with a smiley face and it's",
    "start": "859480",
    "end": "862000"
  },
  {
    "text": "from uh user on WhatsApp named",
    "start": "862000",
    "end": "866519"
  },
  {
    "start": "866000",
    "end": "866000"
  },
  {
    "text": "Nikos so how to exploit this you would",
    "start": "866759",
    "end": "868880"
  },
  {
    "text": "need to create an application and you",
    "start": "868880",
    "end": "870680"
  },
  {
    "text": "would request the receive boot completed",
    "start": "870680",
    "end": "872519"
  },
  {
    "text": "permission so once the boot sequence",
    "start": "872519",
    "end": "874360"
  },
  {
    "text": "completes uh the Andro Android OS will",
    "start": "874360",
    "end": "877199"
  },
  {
    "text": "send out a broadcast intent uh to",
    "start": "877199",
    "end": "881120"
  },
  {
    "text": "applications that have that have the",
    "start": "881120",
    "end": "882959"
  },
  {
    "text": "permission to receive it so once the",
    "start": "882959",
    "end": "884680"
  },
  {
    "text": "receive boot completed is received in a",
    "start": "884680",
    "end": "887440"
  },
  {
    "text": "broadcast receiver you would from the",
    "start": "887440",
    "end": "889680"
  },
  {
    "text": "broadcast receiver start a service and",
    "start": "889680",
    "end": "892440"
  },
  {
    "text": "have that service schedule a thread to",
    "start": "892440",
    "end": "894480"
  },
  {
    "text": "run at certain whatever inter interval",
    "start": "894480",
    "end": "896440"
  },
  {
    "text": "you want and then that would call that c",
    "start": "896440",
    "end": "898720"
  },
  {
    "text": "function which Forks the process uh and",
    "start": "898720",
    "end": "901480"
  },
  {
    "text": "call Cort so you could do this in the",
    "start": "901480",
    "end": "903199"
  },
  {
    "text": "background even when the user isn't",
    "start": "903199",
    "end": "904800"
  },
  {
    "text": "using the application and this could be",
    "start": "904800",
    "end": "906759"
  },
  {
    "text": "done whenever you",
    "start": "906759",
    "end": "909639"
  },
  {
    "text": "want so once the dump you force the",
    "start": "909639",
    "end": "912880"
  },
  {
    "text": "generation of the dump State file then",
    "start": "912880",
    "end": "915399"
  },
  {
    "text": "you can uh unzip it just using the",
    "start": "915399",
    "end": "917440"
  },
  {
    "text": "Android API from there you could if you",
    "start": "917440",
    "end": "920000"
  },
  {
    "text": "know what you're looking for you could",
    "start": "920000",
    "end": "921160"
  },
  {
    "text": "use regular Expressions to get any data",
    "start": "921160",
    "end": "924360"
  },
  {
    "text": "that uh you know is already known if not",
    "start": "924360",
    "end": "927480"
  },
  {
    "text": "you could just exfiltrate the whole file",
    "start": "927480",
    "end": "929040"
  },
  {
    "text": "and process it later and the only",
    "start": "929040",
    "end": "930880"
  },
  {
    "text": "evidence of this happening is some log",
    "start": "930880",
    "end": "932839"
  },
  {
    "text": "messages so if the user is using ADB and",
    "start": "932839",
    "end": "936519"
  },
  {
    "text": "recording it they would be able to see",
    "start": "936519",
    "end": "938079"
  },
  {
    "text": "this but ADB is generally for developers",
    "start": "938079",
    "end": "940839"
  },
  {
    "text": "and most users probably wouldn't use it",
    "start": "940839",
    "end": "944360"
  },
  {
    "text": "so here we have uh the same screenshot",
    "start": "944360",
    "end": "946279"
  },
  {
    "text": "as before showing the different",
    "start": "946279",
    "end": "949399"
  },
  {
    "text": "notifications there's also I've",
    "start": "949399",
    "end": "951440"
  },
  {
    "text": "highlighted the Facebook Messenger",
    "start": "951440",
    "end": "952880"
  },
  {
    "text": "application which is very popular uh",
    "start": "952880",
    "end": "955680"
  },
  {
    "text": "Android application that many users have",
    "start": "955680",
    "end": "958160"
  },
  {
    "text": "again up at the top there's the",
    "start": "958160",
    "end": "959800"
  },
  {
    "text": "notification NQ log tag which is the log",
    "start": "959800",
    "end": "962480"
  },
  {
    "text": "tag which notifications are getting",
    "start": "962480",
    "end": "964000"
  },
  {
    "text": "written with the package name which is",
    "start": "964000",
    "end": "966360"
  },
  {
    "text": "com. facebook. Orco which corresponds to",
    "start": "966360",
    "end": "968720"
  },
  {
    "text": "the package name for Facebook Messenger",
    "start": "968720",
    "end": "971399"
  },
  {
    "text": "on Android and below is the actual text",
    "start": "971399",
    "end": "974160"
  },
  {
    "text": "of the notification corresponding to the",
    "start": "974160",
    "end": "976560"
  },
  {
    "text": "highlighted notification on the left in",
    "start": "976560",
    "end": "978440"
  },
  {
    "text": "the screenshot and it just it's from a",
    "start": "978440",
    "end": "981199"
  },
  {
    "text": "phony Facebook account the name of Elena",
    "start": "981199",
    "end": "984959"
  },
  {
    "text": "bner and it says this will show up in",
    "start": "984959",
    "end": "987600"
  },
  {
    "text": "the Android log with a smiley face",
    "start": "987600",
    "end": "990279"
  },
  {
    "text": "Cas so once I saw that it was happening",
    "start": "990279",
    "end": "993160"
  },
  {
    "text": "I wanted to see why it was happening so",
    "start": "993160",
    "end": "995199"
  },
  {
    "text": "off my phone I pulled the framework.",
    "start": "995199",
    "end": "998000"
  },
  {
    "text": "odex uh from the device used backmy to",
    "start": "998000",
    "end": "1001079"
  },
  {
    "text": "generate the the SMY files for it and",
    "start": "1001079",
    "end": "1003920"
  },
  {
    "text": "the android.app do notification class is",
    "start": "1003920",
    "end": "1006360"
  },
  {
    "text": "what you would use when you are creating",
    "start": "1006360",
    "end": "1008160"
  },
  {
    "text": "a notification so I looked at the two-",
    "start": "1008160",
    "end": "1011279"
  },
  {
    "text": "string method of this class and the two",
    "start": "1011279",
    "end": "1013279"
  },
  {
    "text": "string is if you want a string",
    "start": "1013279",
    "end": "1014600"
  },
  {
    "text": "representation of the state of an object",
    "start": "1014600",
    "end": "1017720"
  },
  {
    "text": "so I looked at uh compared Samsung's",
    "start": "1017720",
    "end": "1019880"
  },
  {
    "text": "implementation for the the the",
    "start": "1019880",
    "end": "1022440"
  },
  {
    "text": "notification class as well as AOSP and I",
    "start": "1022440",
    "end": "1024760"
  },
  {
    "text": "noticed that Samsung was including",
    "start": "1024760",
    "end": "1026880"
  },
  {
    "text": "various uh string instance variables in",
    "start": "1026880",
    "end": "1029199"
  },
  {
    "text": "the two the output of the two string",
    "start": "1029199",
    "end": "1031558"
  },
  {
    "text": "whereas the AOSP was not including them",
    "start": "1031559",
    "end": "1034079"
  },
  {
    "text": "specifically their content title content",
    "start": "1034079",
    "end": "1036160"
  },
  {
    "text": "text and ticker text and these are",
    "start": "1036160",
    "end": "1038360"
  },
  {
    "text": "actually what the the user sees when",
    "start": "1038360",
    "end": "1040400"
  },
  {
    "text": "they look at a",
    "start": "1040400",
    "end": "1042839"
  },
  {
    "start": "1042000",
    "end": "1042000"
  },
  {
    "text": "notification so here I have two",
    "start": "1042839",
    "end": "1045520"
  },
  {
    "text": "different builds both 4.4.2 a Samsung",
    "start": "1045520",
    "end": "1048280"
  },
  {
    "text": "build and AOSP build and this is the",
    "start": "1048280",
    "end": "1050840"
  },
  {
    "text": "same",
    "start": "1050840",
    "end": "1051840"
  },
  {
    "text": "notification uh the two string of the",
    "start": "1051840",
    "end": "1054280"
  },
  {
    "text": "notification so at the top you see AOSP",
    "start": "1054280",
    "end": "1057640"
  },
  {
    "text": "it's much more tur and if you look at",
    "start": "1057640",
    "end": "1059799"
  },
  {
    "text": "Samsung it's more verbose and the the",
    "start": "1059799",
    "end": "1062559"
  },
  {
    "text": "text in red is the actual uh three",
    "start": "1062559",
    "end": "1065080"
  },
  {
    "text": "instance variables that I mentioned",
    "start": "1065080",
    "end": "1066840"
  },
  {
    "text": "previously were in the two string",
    "start": "1066840",
    "end": "1068200"
  },
  {
    "text": "content title content text and ticker",
    "start": "1068200",
    "end": "1072760"
  },
  {
    "start": "1072000",
    "end": "1072000"
  },
  {
    "text": "text so there's the notification manager",
    "start": "1072760",
    "end": "1075600"
  },
  {
    "text": "server which runs in the system server",
    "start": "1075600",
    "end": "1077760"
  },
  {
    "text": "process so when you are interacting with",
    "start": "1077760",
    "end": "1081480"
  },
  {
    "text": "the notification manager using the",
    "start": "1081480",
    "end": "1083559"
  },
  {
    "text": "frontend API you're actually calling an",
    "start": "1083559",
    "end": "1085320"
  },
  {
    "text": "interface which is going to interact",
    "start": "1085320",
    "end": "1087120"
  },
  {
    "text": "with a notification manager server uh on",
    "start": "1087120",
    "end": "1089679"
  },
  {
    "text": "the back end in the system server",
    "start": "1089679",
    "end": "1091760"
  },
  {
    "text": "process uh that shows at the top it's",
    "start": "1091760",
    "end": "1095440"
  },
  {
    "text": "com. android. server. notification",
    "start": "1095440",
    "end": "1097600"
  },
  {
    "text": "manager service and I looked at the",
    "start": "1097600",
    "end": "1101000"
  },
  {
    "text": "source code for this there's the enq",
    "start": "1101000",
    "end": "1103080"
  },
  {
    "text": "notification internal method and I",
    "start": "1103080",
    "end": "1105760"
  },
  {
    "text": "provided uh a snippet of the source code",
    "start": "1105760",
    "end": "1108240"
  },
  {
    "text": "of this method method and it essentially",
    "start": "1108240",
    "end": "1111320"
  },
  {
    "text": "says and this is called whenever a",
    "start": "1111320",
    "end": "1113360"
  },
  {
    "text": "notification is received and it",
    "start": "1113360",
    "end": "1115360"
  },
  {
    "text": "essentially says uh the source code if",
    "start": "1115360",
    "end": "1117840"
  },
  {
    "text": "the notification isn't from the download",
    "start": "1117840",
    "end": "1119760"
  },
  {
    "text": "manager get a the two- string of the",
    "start": "1119760",
    "end": "1122120"
  },
  {
    "text": "notification that's being sent as well",
    "start": "1122120",
    "end": "1124520"
  },
  {
    "text": "as a few other data or few other data",
    "start": "1124520",
    "end": "1126919"
  },
  {
    "text": "items and then it's being written to the",
    "start": "1126919",
    "end": "1128720"
  },
  {
    "text": "event log which goes into the Android",
    "start": "1128720",
    "end": "1130559"
  },
  {
    "text": "log and it's also under the the",
    "start": "1130559",
    "end": "1132880"
  },
  {
    "text": "notification NQ uh log tag in this call",
    "start": "1132880",
    "end": "1136400"
  },
  {
    "text": "It's actually an integer but it gets",
    "start": "1136400",
    "end": "1137720"
  },
  {
    "text": "converted to",
    "start": "1137720",
    "end": "1139280"
  },
  {
    "text": "the the string of notification",
    "start": "1139280",
    "end": "1142919"
  },
  {
    "text": "NQ so vulnerable builds uh we",
    "start": "1142919",
    "end": "1147280"
  },
  {
    "start": "1143000",
    "end": "1143000"
  },
  {
    "text": "essentially tested a bunch of devices",
    "start": "1147280",
    "end": "1148799"
  },
  {
    "text": "that we were able to get our hands on",
    "start": "1148799",
    "end": "1150480"
  },
  {
    "text": "from friends and colleagues uh we also",
    "start": "1150480",
    "end": "1152559"
  },
  {
    "text": "downloaded stock Samsung firmwares from",
    "start": "1152559",
    "end": "1154919"
  },
  {
    "text": "this site uh Sam mobile so if you have a",
    "start": "1154919",
    "end": "1157760"
  },
  {
    "text": "Samsung device you can just assuming",
    "start": "1157760",
    "end": "1159640"
  },
  {
    "text": "it's you're downloading it for the",
    "start": "1159640",
    "end": "1161320"
  },
  {
    "text": "correct model you can download a stock",
    "start": "1161320",
    "end": "1163919"
  },
  {
    "text": "uh ROM from there put your phone into",
    "start": "1163919",
    "end": "1166039"
  },
  {
    "text": "downloader or Odin mode and then flash",
    "start": "1166039",
    "end": "1168320"
  },
  {
    "text": "it uh to your device using Odin and the",
    "start": "1168320",
    "end": "1172400"
  },
  {
    "text": "the vulnerability where the text of",
    "start": "1172400",
    "end": "1174440"
  },
  {
    "text": "notifications uh it's only in certain",
    "start": "1174440",
    "end": "1176559"
  },
  {
    "text": "builds from uh Android",
    "start": "1176559",
    "end": "1179360"
  },
  {
    "text": "4.1.2 Android 4.3 and Android",
    "start": "1179360",
    "end": "1183440"
  },
  {
    "text": "4.4.2 and it's not in it got fixed in",
    "start": "1183440",
    "end": "1186360"
  },
  {
    "text": "Android 4.4.4 and it's not present in",
    "start": "1186360",
    "end": "1189760"
  },
  {
    "text": "Android",
    "start": "1189760",
    "end": "1192200"
  },
  {
    "start": "1192000",
    "end": "1192000"
  },
  {
    "text": "lollipop so here is a screenshot from",
    "start": "1192640",
    "end": "1195760"
  },
  {
    "text": "the Android developers website which",
    "start": "1195760",
    "end": "1197840"
  },
  {
    "text": "shows the current Android platform usage",
    "start": "1197840",
    "end": "1200760"
  },
  {
    "text": "and this is just data I believe a 7we",
    "start": "1200760",
    "end": "1203559"
  },
  {
    "text": "period ending March",
    "start": "1203559",
    "end": "1205400"
  },
  {
    "text": "2nd and this is just from the devices",
    "start": "1205400",
    "end": "1208159"
  },
  {
    "text": "that have checked into Google servers as",
    "start": "1208159",
    "end": "1210000"
  },
  {
    "text": "you can see the largest component is",
    "start": "1210000",
    "end": "1212200"
  },
  {
    "text": "Jelly Bean and the next largest",
    "start": "1212200",
    "end": "1214440"
  },
  {
    "text": "component is KitKat and both of these",
    "start": "1214440",
    "end": "1216840"
  },
  {
    "text": "are the it doesn't break down Kit Kat by",
    "start": "1216840",
    "end": "1218720"
  },
  {
    "text": "the minor version number",
    "start": "1218720",
    "end": "1221760"
  },
  {
    "text": "um but Kit Kat and jelly bean both",
    "start": "1221760",
    "end": "1224600"
  },
  {
    "text": "contain uh the vulnerab vulnerable",
    "start": "1224600",
    "end": "1227080"
  },
  {
    "text": "builds at least on Samsung deves uh at",
    "start": "1227080",
    "end": "1230360"
  },
  {
    "text": "least a slice of",
    "start": "1230360",
    "end": "1233200"
  },
  {
    "start": "1233000",
    "end": "1233000"
  },
  {
    "text": "them so threat mitigation so if you are",
    "start": "1233320",
    "end": "1236080"
  },
  {
    "text": "running uh vulnerable Samsung builds you",
    "start": "1236080",
    "end": "1238880"
  },
  {
    "text": "would want to update the OS if possible",
    "start": "1238880",
    "end": "1241840"
  },
  {
    "text": "if your model is supported for an update",
    "start": "1241840",
    "end": "1244760"
  },
  {
    "text": "if not you can actually uh use ADB once",
    "start": "1244760",
    "end": "1247840"
  },
  {
    "text": "to prevent the dump State files from",
    "start": "1247840",
    "end": "1249840"
  },
  {
    "text": "being World readable so would you you",
    "start": "1249840",
    "end": "1252400"
  },
  {
    "text": "would use Andro Android debug Bridge uh",
    "start": "1252400",
    "end": "1255320"
  },
  {
    "text": "and you need to change the file",
    "start": "1255320",
    "end": "1256559"
  },
  {
    "text": "permissions on the dump State files so",
    "start": "1256559",
    "end": "1258880"
  },
  {
    "text": "these files uh have the owner of shell",
    "start": "1258880",
    "end": "1261960"
  },
  {
    "text": "as well as the group of log which is the",
    "start": "1261960",
    "end": "1264200"
  },
  {
    "text": "same as",
    "start": "1264200",
    "end": "1265320"
  },
  {
    "text": "ADB and uh dump State when it IT",
    "start": "1265320",
    "end": "1268200"
  },
  {
    "text": "initially runs it does have root",
    "start": "1268200",
    "end": "1269640"
  },
  {
    "text": "privileges but it drops them to Shell",
    "start": "1269640",
    "end": "1272000"
  },
  {
    "text": "user and it belongs to the log group as",
    "start": "1272000",
    "end": "1274159"
  },
  {
    "text": "well as some other groups so the first",
    "start": "1274159",
    "end": "1275840"
  },
  {
    "text": "thing you would want to do is you would",
    "start": "1275840",
    "end": "1277400"
  },
  {
    "text": "want to delete any existing dump State",
    "start": "1277400",
    "end": "1279760"
  },
  {
    "text": "files then you would want to change",
    "start": "1279760",
    "end": "1281880"
  },
  {
    "text": "directory to the /data log directory",
    "start": "1281880",
    "end": "1285000"
  },
  {
    "text": "then you would use the touch command to",
    "start": "1285000",
    "end": "1287720"
  },
  {
    "text": "generate an empty file or empty temp",
    "start": "1287720",
    "end": "1291200"
  },
  {
    "text": "file for uh dump State app uh Native",
    "start": "1291200",
    "end": "1295919"
  },
  {
    "text": "because it writes to a a temp file first",
    "start": "1295919",
    "end": "1298159"
  },
  {
    "text": "and then it it moves it to uh not a temp",
    "start": "1298159",
    "end": "1301320"
  },
  {
    "text": "file so once you generate the the temp",
    "start": "1301320",
    "end": "1303960"
  },
  {
    "text": "file you want to change the file",
    "start": "1303960",
    "end": "1305480"
  },
  {
    "text": "permissions to 0000 0 so no user on the",
    "start": "1305480",
    "end": "1308640"
  },
  {
    "text": "device can read write or execute the",
    "start": "1308640",
    "end": "1310360"
  },
  {
    "text": "file other than root but dump State",
    "start": "1310360",
    "end": "1312720"
  },
  {
    "text": "isn't executing his roote when it's",
    "start": "1312720",
    "end": "1314159"
  },
  {
    "text": "writing these files",
    "start": "1314159",
    "end": "1316919"
  },
  {
    "text": "so so one then one of those three",
    "start": "1316919",
    "end": "1320000"
  },
  {
    "text": "conditions occur it's going to try and",
    "start": "1320000",
    "end": "1321440"
  },
  {
    "text": "write to one of these files but it",
    "start": "1321440",
    "end": "1323240"
  },
  {
    "text": "doesn't delete it first it just uses",
    "start": "1323240",
    "end": "1324840"
  },
  {
    "text": "output redirection to overwrite the file",
    "start": "1324840",
    "end": "1327400"
  },
  {
    "text": "but since it doesn't have the correct",
    "start": "1327400",
    "end": "1329080"
  },
  {
    "text": "file permissions to write to this file",
    "start": "1329080",
    "end": "1331039"
  },
  {
    "text": "it's just going to silently fail and not",
    "start": "1331039",
    "end": "1333200"
  },
  {
    "text": "write the log",
    "start": "1333200",
    "end": "1335080"
  },
  {
    "text": "data just due to the restrictive file",
    "start": "1335080",
    "end": "1338240"
  },
  {
    "start": "1336000",
    "end": "1336000"
  },
  {
    "text": "permission so the conclusion a secure",
    "start": "1338240",
    "end": "1340039"
  },
  {
    "text": "programming practice is to sanitize any",
    "start": "1340039",
    "end": "1342640"
  },
  {
    "text": "log Data before writing into the Android",
    "start": "1342640",
    "end": "1344919"
  },
  {
    "text": "log or any log because other users may",
    "start": "1344919",
    "end": "1347000"
  },
  {
    "text": "have access to that uh in Android they",
    "start": "1347000",
    "end": "1350159"
  },
  {
    "text": "took it away but I found a way to get it",
    "start": "1350159",
    "end": "1351840"
  },
  {
    "text": "back on Samsung builds you also need to",
    "start": "1351840",
    "end": "1354679"
  },
  {
    "text": "when you Fork AOSP or Android open",
    "start": "1354679",
    "end": "1356679"
  },
  {
    "text": "source project source code if you're",
    "start": "1356679",
    "end": "1358919"
  },
  {
    "text": "making your own build you need to be",
    "start": "1358919",
    "end": "1360279"
  },
  {
    "text": "careful about what you're adding in",
    "start": "1360279",
    "end": "1362039"
  },
  {
    "text": "there because you may introduce",
    "start": "1362039",
    "end": "1364080"
  },
  {
    "text": "vulnerabilities so you need to test and",
    "start": "1364080",
    "end": "1366200"
  },
  {
    "text": "audit it carefully and you also be need",
    "start": "1366200",
    "end": "1369000"
  },
  {
    "text": "to be careful of the file permissions uh",
    "start": "1369000",
    "end": "1371000"
  },
  {
    "text": "set on files that contain sensitive data",
    "start": "1371000",
    "end": "1372960"
  },
  {
    "text": "in this instance there was World",
    "start": "1372960",
    "end": "1374559"
  },
  {
    "text": "readable log files that contained uh",
    "start": "1374559",
    "end": "1377039"
  },
  {
    "text": "private user data",
    "start": "1377039",
    "end": "1380440"
  },
  {
    "text": "and I also informed Samsung of this and",
    "start": "1380480",
    "end": "1384200"
  },
  {
    "text": "as of uh Android lollipop uh they are",
    "start": "1384200",
    "end": "1389760"
  },
  {
    "text": "these these files are no longer World",
    "start": "1389760",
    "end": "1392000"
  },
  {
    "text": "readable uh thank you for attending the",
    "start": "1392000",
    "end": "1394080"
  },
  {
    "start": "1393000",
    "end": "1393000"
  },
  {
    "text": "presentation are there any questions",
    "start": "1394080",
    "end": "1398559"
  },
  {
    "text": "[Music]",
    "start": "1407460",
    "end": "1410659"
  },
  {
    "text": "uh you could use it without it but if if",
    "start": "1416840",
    "end": "1419159"
  },
  {
    "text": "you didn't have the received boot",
    "start": "1419159",
    "end": "1420520"
  },
  {
    "text": "completed permission you would only be",
    "start": "1420520",
    "end": "1422039"
  },
  {
    "text": "able to generate that dump State file",
    "start": "1422039",
    "end": "1424159"
  },
  {
    "text": "only when the user is using your",
    "start": "1424159",
    "end": "1425720"
  },
  {
    "text": "application so you could do it without",
    "start": "1425720",
    "end": "1428159"
  },
  {
    "text": "it um",
    "start": "1428159",
    "end": "1430919"
  },
  {
    "text": "but yeah there so uh once the",
    "start": "1430919",
    "end": "1433919"
  },
  {
    "text": "application receives the receive boot",
    "start": "1433919",
    "end": "1435559"
  },
  {
    "text": "completed per uh in broadcast intent in",
    "start": "1435559",
    "end": "1438640"
  },
  {
    "text": "a broadcast receiver and then it starts",
    "start": "1438640",
    "end": "1440360"
  },
  {
    "text": "a service which then is going to run in",
    "start": "1440360",
    "end": "1442720"
  },
  {
    "text": "the background or have persistent",
    "start": "1442720",
    "end": "1444440"
  },
  {
    "text": "execution and then it whatever interval",
    "start": "1444440",
    "end": "1447200"
  },
  {
    "text": "you want then you can call uh use jni to",
    "start": "1447200",
    "end": "1449600"
  },
  {
    "text": "call into the C function and then Fork",
    "start": "1449600",
    "end": "1451919"
  },
  {
    "text": "the process call Cort in the child",
    "start": "1451919",
    "end": "1453799"
  },
  {
    "text": "process parent process returns and then",
    "start": "1453799",
    "end": "1456440"
  },
  {
    "text": "from there the the world readable dump",
    "start": "1456440",
    "end": "1459159"
  },
  {
    "text": "State file is created and then you can",
    "start": "1459159",
    "end": "1460919"
  },
  {
    "text": "just process it",
    "start": "1460919",
    "end": "1464559"
  },
  {
    "text": "you can only uh you could if you don't",
    "start": "1472120",
    "end": "1474120"
  },
  {
    "text": "have that you're going to need to wait",
    "start": "1474120",
    "end": "1475640"
  },
  {
    "text": "until the application starts the app or",
    "start": "1475640",
    "end": "1478480"
  },
  {
    "text": "launches your uh main activity",
    "start": "1478480",
    "end": "1481679"
  },
  {
    "text": "before okay you're",
    "start": "1481679",
    "end": "1485519"
  },
  {
    "text": "welcome yeah",
    "start": "1489480",
    "end": "1493480"
  },
  {
    "text": "uh so on 4.4.4 that's when they fixed",
    "start": "1498720",
    "end": "1501480"
  },
  {
    "text": "writing the notifications to the log uh",
    "start": "1501480",
    "end": "1504240"
  },
  {
    "text": "you can still generate the dump State",
    "start": "1504240",
    "end": "1505799"
  },
  {
    "text": "files but once after I informed them on",
    "start": "1505799",
    "end": "1508200"
  },
  {
    "text": "Samsung uh or Android 5 they've they've",
    "start": "1508200",
    "end": "1511559"
  },
  {
    "text": "made those files not World",
    "start": "1511559",
    "end": "1514039"
  },
  {
    "text": "readable yeah they just changed the the",
    "start": "1514039",
    "end": "1516600"
  },
  {
    "text": "permission so it's the same except they",
    "start": "1516600",
    "end": "1518200"
  },
  {
    "text": "took away the that r or that last R uh",
    "start": "1518200",
    "end": "1522600"
  },
  {
    "text": "to on the file permissions to make it",
    "start": "1522600",
    "end": "1524559"
  },
  {
    "text": "World readable",
    "start": "1524559",
    "end": "1527840"
  },
  {
    "text": "yeah well if it's a rooted phone it can",
    "start": "1533000",
    "end": "1535000"
  },
  {
    "text": "you know end the application that's",
    "start": "1535000",
    "end": "1537120"
  },
  {
    "text": "requesting it depending on how they're",
    "start": "1537120",
    "end": "1538600"
  },
  {
    "text": "doing it if it's super suu and the user",
    "start": "1538600",
    "end": "1540520"
  },
  {
    "text": "grants it once they do that then you",
    "start": "1540520",
    "end": "1542440"
  },
  {
    "text": "know that process can do anything on the",
    "start": "1542440",
    "end": "1544080"
  },
  {
    "text": "device",
    "start": "1544080",
    "end": "1547080"
  },
  {
    "text": "are there any other",
    "start": "1572120",
    "end": "1574919"
  },
  {
    "text": "questions I haven't checked all phones",
    "start": "1584520",
    "end": "1587760"
  },
  {
    "text": "um I mean I just checked what I had I",
    "start": "1587760",
    "end": "1589640"
  },
  {
    "text": "checked a Nexus 5 it's uh it doesn't",
    "start": "1589640",
    "end": "1592200"
  },
  {
    "text": "have the SL dat log directory and when",
    "start": "1592200",
    "end": "1594360"
  },
  {
    "text": "there is a crash uh generally I think it",
    "start": "1594360",
    "end": "1596720"
  },
  {
    "text": "gets written",
    "start": "1596720",
    "end": "1598600"
  },
  {
    "text": "todd. android. shell which is only",
    "start": "1598600",
    "end": "1601399"
  },
  {
    "text": "readable by the um the shell process so",
    "start": "1601399",
    "end": "1605039"
  },
  {
    "text": "if you're using ADB those crash dumps go",
    "start": "1605039",
    "end": "1607720"
  },
  {
    "text": "there so those are much uh more well",
    "start": "1607720",
    "end": "1610000"
  },
  {
    "text": "protected so you won't unless you're the",
    "start": "1610000",
    "end": "1612320"
  },
  {
    "text": "shell user using ADB you won't have read",
    "start": "1612320",
    "end": "1614960"
  },
  {
    "text": "access to them but I haven't checked",
    "start": "1614960",
    "end": "1617080"
  },
  {
    "text": "every single manufact to see if they've",
    "start": "1617080",
    "end": "1619720"
  },
  {
    "text": "made any world readable log files or",
    "start": "1619720",
    "end": "1622480"
  },
  {
    "text": "maybe there's another vulnerability I",
    "start": "1622480",
    "end": "1623960"
  },
  {
    "text": "haven't checked all the vendors to see",
    "start": "1623960",
    "end": "1625919"
  },
  {
    "text": "how well the the crash dumps are",
    "start": "1625919",
    "end": "1630200"
  },
  {
    "text": "protected",
    "start": "1633159",
    "end": "1635399"
  },
  {
    "text": "uh not right now I need to get access to",
    "start": "1635399",
    "end": "1638880"
  },
  {
    "text": "a lot of devices which I think would be",
    "start": "1638880",
    "end": "1641919"
  },
  {
    "text": "um kind of tough or not too tough but uh",
    "start": "1641919",
    "end": "1645760"
  },
  {
    "text": "not at the moment",
    "start": "1645760",
    "end": "1648640"
  },
  {
    "text": "but there's uh there there may be other",
    "start": "1648640",
    "end": "1650919"
  },
  {
    "text": "vulnerabilities out there in other",
    "start": "1650919",
    "end": "1652919"
  },
  {
    "text": "manufacturers um at least with in regard",
    "start": "1652919",
    "end": "1655320"
  },
  {
    "text": "to the logs I'm not sure about it",
    "start": "1655320",
    "end": "1660039"
  },
  {
    "text": "so any other questions",
    "start": "1671240",
    "end": "1675679"
  },
  {
    "text": "okay if there's no other questions uh",
    "start": "1682200",
    "end": "1683919"
  },
  {
    "text": "thank you for coming to the presentation",
    "start": "1683919",
    "end": "1686810"
  },
  {
    "text": "[Applause]",
    "start": "1686810",
    "end": "1692490"
  }
]