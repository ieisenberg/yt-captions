[
  {
    "start": "0",
    "end": "137000"
  },
  {
    "text": "[Music]",
    "start": "4280",
    "end": "14710"
  },
  {
    "text": "hello welcome to our talk today on healthcare application security um my name is seth foggy i've been doing",
    "start": "14719",
    "end": "20160"
  },
  {
    "text": "security in various forms and functions for about 20 years the last 10 of which have been with penn medicine really specifically focused on health",
    "start": "20160",
    "end": "27119"
  },
  {
    "text": "care applications and embedded in the health security environments with the various healthcare organizations",
    "start": "27119",
    "end": "33200"
  },
  {
    "text": "so a point of reference 16 years ago i happened to be presenting a black cat that subject was on pocket pc abuse a",
    "start": "33200",
    "end": "38800"
  },
  {
    "text": "few things have changed since then i've got less hair got more kids and pocket pc really isn't a thing anymore",
    "start": "38800",
    "end": "45039"
  },
  {
    "text": "but it's it's kind of underlying architecture um windows ce still is actually in use",
    "start": "45039",
    "end": "51280"
  },
  {
    "text": "inside of the healthcare environments along with hl7 and dicom these particular subjects have been of",
    "start": "51280",
    "end": "58719"
  },
  {
    "text": "of interest and have gotten a lot of tension i just want to give a nod to those people who have been doing research in that including one of our very own dependent medicine",
    "start": "58719",
    "end": "64559"
  },
  {
    "text": "dr benoit who's been focused on dot com security but this talk is not about those things",
    "start": "64559",
    "end": "69600"
  },
  {
    "text": "instead we're going to be focused on the application security and by application security i mean those applications that deal with",
    "start": "69600",
    "end": "75680"
  },
  {
    "text": "the patient records and the patient workflows that really kind of address a a definite",
    "start": "75680",
    "end": "81920"
  },
  {
    "text": "concern in the security field and that that these are actively being exploited and being",
    "start": "81920",
    "end": "87119"
  },
  {
    "text": "the patient records are being sold and there's a real monetized value about these things so on that note these are one day",
    "start": "87119",
    "end": "93280"
  },
  {
    "text": "vulnerabilities and that vendors are aware and certain members of hisac aware as we try and get awareness",
    "start": "93280",
    "end": "99040"
  },
  {
    "text": "around that but there's no guarantee that the patches have been deployed if there's even patches available so as a result the vendor names and",
    "start": "99040",
    "end": "105840"
  },
  {
    "text": "products are going to be censored from this talk thus the the fuzzy screen however certain goals we do have today and the",
    "start": "105840",
    "end": "111759"
  },
  {
    "text": "first is to really bring awareness to healthcare security professionals on some of the methods and things they can",
    "start": "111759",
    "end": "117119"
  },
  {
    "text": "look at in their own environment as well as bring attention to the vendors as to what we don't like to see",
    "start": "117119",
    "end": "122479"
  },
  {
    "text": "in their software so they can proactively remove this kind of stuff from their solutions and finally provide some insight to the",
    "start": "122479",
    "end": "127920"
  },
  {
    "text": "security community what they can be looking for whether they're assessors or auditors or pen testers to help really raise the",
    "start": "127920",
    "end": "134239"
  },
  {
    "text": "bar when it comes to healthcare application security now we can't have a talk about security without alice and bob",
    "start": "134239",
    "end": "140560"
  },
  {
    "start": "137000",
    "end": "137000"
  },
  {
    "text": "and we're be using alice and bob in a kind of a fictional overlay and official context as they as they are interfaced with the",
    "start": "140560",
    "end": "147280"
  },
  {
    "text": "black hat clinic now conveniently the black hat clinic is about the same size as penn medicine so there's some correlation there",
    "start": "147280",
    "end": "153360"
  },
  {
    "text": "in in the numbers but again this is going to be a fictional overlay with some fictional elements using bob",
    "start": "153360",
    "end": "160400"
  },
  {
    "text": "and alice to really drive home the patient perspective because we can't lose fact that there is a patient behind",
    "start": "160400",
    "end": "166080"
  },
  {
    "text": "all these technical issues ultimately and we want to make sure that patient care is one of the key priorities here so you",
    "start": "166080",
    "end": "173599"
  },
  {
    "text": "know alice and bob been with us since the 70s um in the 80s apparently they went through some kind of divorce something to do",
    "start": "173599",
    "end": "179840"
  },
  {
    "text": "with lack of communication and keeping secrets but they were able to get reconciled and have grown old with each",
    "start": "179840",
    "end": "186239"
  },
  {
    "text": "other over the past what 40 50 years and now in their 60s or 70s with age some come some healthcare",
    "start": "186239",
    "end": "191920"
  },
  {
    "text": "issues and and bob is with us now at blackhat clinic where he's getting his pancreas taken care of and some",
    "start": "191920",
    "end": "197040"
  },
  {
    "text": "some analysis done there he lost his diabetes and alice is beside him and helping him through this process",
    "start": "197040",
    "end": "202720"
  },
  {
    "text": "so currently bob is off getting this procedure and alice is sitting inside of his room doing what most loved",
    "start": "202720",
    "end": "208640"
  },
  {
    "text": "ones do at this point watching tv and at this point we're going to introduce mallory mallory is the bad guy in this",
    "start": "208640",
    "end": "215680"
  },
  {
    "text": "in this um kind of fictional overlay he's the one that's a threat and he's kind of interjected himself",
    "start": "215680",
    "end": "221360"
  },
  {
    "text": "right on alice's screen with this message that kind of really throws alice off now alice is a security person she",
    "start": "221360",
    "end": "227200"
  },
  {
    "text": "understands that there's risks here but she also knows who to contact and she contacts the security team at black hat clinic and",
    "start": "227200",
    "end": "232799"
  },
  {
    "text": "we come in and and start talking to alice about this particular system um ali's first",
    "start": "232799",
    "end": "238080"
  },
  {
    "text": "question is this is a tv how is somebody able to take over this tv and we're well we want to clarify",
    "start": "238080",
    "end": "243519"
  },
  {
    "text": "that and that analysis isn't really tv anymore this is a patient entertainment system meaning it's a system that has all kinds",
    "start": "243519",
    "end": "249439"
  },
  {
    "text": "of integrations behind the scenes to not just entertainment but to meal ordering and education and nurse call",
    "start": "249439",
    "end": "255519"
  },
  {
    "text": "systems in addition to that it does have a screencast feature which allows doctors to take their screen and throw it up onto the",
    "start": "255519",
    "end": "262560"
  },
  {
    "text": "patient's screen or to their patient device so um it looks like mallory got into",
    "start": "262560",
    "end": "267680"
  },
  {
    "text": "this now we're going to take a look at that because from a bad guy's perspective if mallory's in there he can obviously",
    "start": "267680",
    "end": "273280"
  },
  {
    "text": "impact the patient experience but also potentially access patient records and as you're experiencing ellis",
    "start": "273280",
    "end": "279280"
  },
  {
    "text": "it can raise some stress issues and also there's some potential issues about data and security privacy",
    "start": "279280",
    "end": "285040"
  },
  {
    "text": "so we take a look inside of our application database of about 250 applications and find the application listed there",
    "start": "285040",
    "end": "291040"
  },
  {
    "text": "and get it installed and note that it's a it's a client server architecture with some web interfacing behind the scenes",
    "start": "291040",
    "end": "296720"
  },
  {
    "text": "so we integrate burp into this which is a good proxy program and when we launch the program we're expecting to see some kind of",
    "start": "296720",
    "end": "302479"
  },
  {
    "text": "authentication prompt but so we come right to the screen we can see bob's room there room number five no authentication so we",
    "start": "302479",
    "end": "309680"
  },
  {
    "text": "want to see what happened behind the scenes we take a look inside our burp records and the logs there and see that there is",
    "start": "309680",
    "end": "314880"
  },
  {
    "text": "indeed a web request no authentication this web request but more concerning it returns a whole lot",
    "start": "314880",
    "end": "320479"
  },
  {
    "text": "of xml and this xml contains date of birth patient name patient number room number and it's",
    "start": "320479",
    "end": "327520"
  },
  {
    "text": "important to note here that that this is kind of kind of setting a line in the sand and hitting a bar that we don't want to",
    "start": "327520",
    "end": "334080"
  },
  {
    "text": "ever see and that it actually sent more than 500 records back and that's kind of a",
    "start": "334080",
    "end": "339199"
  },
  {
    "text": "line of sand because when you get above 500 records and and if this was a breach it would be",
    "start": "339199",
    "end": "344320"
  },
  {
    "text": "posted to a wall of shame there's potential investigations actually there will be investigations with potential fines",
    "start": "344320",
    "end": "350479"
  },
  {
    "text": "not to say that less than 500 records isn't important definitely for patient safety and privacy and security",
    "start": "350479",
    "end": "356800"
  },
  {
    "text": "and also it may not get some attention but that 500 line is definitely a mark in the sand",
    "start": "356800",
    "end": "362319"
  },
  {
    "text": "but that's not how mallory got access to the screen so we go back to the program and hit bob's",
    "start": "362319",
    "end": "368240"
  },
  {
    "text": "room number and it comes with this prompt enter the number one two three four in there",
    "start": "368240",
    "end": "373440"
  },
  {
    "text": "and we look behind the scenes and don't see anything that's being passed from the client to the server which is unexpected because we would expect to",
    "start": "373440",
    "end": "379759"
  },
  {
    "text": "see that authentication occur so we do take a look and we see that there is a websocket upgrade request and inside that",
    "start": "379759",
    "end": "386080"
  },
  {
    "text": "websocket data there is a reference to this four digit number here 9284 which we plug into the prompt",
    "start": "386080",
    "end": "392800"
  },
  {
    "text": "and sure enough that allows us to know the screen so in this just basic kind of simple",
    "start": "392800",
    "end": "397840"
  },
  {
    "text": "example we kind of illustrated that that there's some unauthenticated api requests that we",
    "start": "397840",
    "end": "404400"
  },
  {
    "text": "are able to allow you to retrieve over 500 records and there's no validation other than on the client so",
    "start": "404400",
    "end": "410400"
  },
  {
    "text": "you've got a client created pin a client validated pin and really the bins only the pins only pass to the",
    "start": "410400",
    "end": "416319"
  },
  {
    "text": "the server just for informational purposes so not very complex definitely a high issue and we got",
    "start": "416319",
    "end": "422160"
  },
  {
    "text": "patient records over 500 so we got what we would consider a high risk issue in this case",
    "start": "422160",
    "end": "427280"
  },
  {
    "text": "now we start reaching out to the vendor and we talk with our internal team and realize that we can probably just",
    "start": "427280",
    "end": "432400"
  },
  {
    "text": "disable this feature and get rid of it all together so we go back to alice with these findings and explain to her that well we",
    "start": "432400",
    "end": "437680"
  },
  {
    "text": "figured out what was going on we're being shutting it down so we're gonna get that taken care of at this moment the doctor walks in and",
    "start": "437680",
    "end": "443759"
  },
  {
    "text": "and says well bob is done with his procedure and we're documenting everything up and we're getting prepared for for the the",
    "start": "443759",
    "end": "449680"
  },
  {
    "text": "documentation you can take home so you know how to treat bob at home and what you can do afterwards and making sure",
    "start": "449680",
    "end": "454960"
  },
  {
    "text": "that everything's everything's properly uh proceduralized away in the system we'll be back then",
    "start": "454960",
    "end": "460000"
  },
  {
    "text": "very soon with some more information about his mri system and and doctor walks out and alice turns us and says well you know mallory's already",
    "start": "460000",
    "end": "466479"
  },
  {
    "text": "threatened us is this something that he can take advantage of and well we we tell alice this is a system",
    "start": "466479",
    "end": "472160"
  },
  {
    "start": "469000",
    "end": "469000"
  },
  {
    "text": "that kind of captures all the the procedural parts of what occurred and allows a",
    "start": "472160",
    "end": "478000"
  },
  {
    "text": "physician or clinical care team to provide instructions and follow up workflow there's auditing capability",
    "start": "478000",
    "end": "483440"
  },
  {
    "text": "built into it there's a lot of really important information here so yeah if if mallory was into the system he",
    "start": "483440",
    "end": "490479"
  },
  {
    "text": "could access the information at a minimum and maybe modify which could be a problem because from a patient",
    "start": "490479",
    "end": "495599"
  },
  {
    "text": "perspective that could lead to a misdiagnosis it could actually lead a higher cost for care because there's coding which ties",
    "start": "495599",
    "end": "501520"
  },
  {
    "text": "to insurance there's also definitely the the loss of data and private security issues",
    "start": "501520",
    "end": "506879"
  },
  {
    "text": "so we tell us we're going to take a look pull up our application database again and this time we have 300 applications",
    "start": "506879",
    "end": "512080"
  },
  {
    "text": "now we're digging through we find the application get it installed and start a different approach on this",
    "start": "512080",
    "end": "518000"
  },
  {
    "text": "one where we're going to take a look at the code that represents the client software and we like to do this because we sometimes",
    "start": "518000",
    "end": "523440"
  },
  {
    "text": "learn a little bit about how the the program operates by just investigating how the the logic of the code works some key",
    "start": "523440",
    "end": "529680"
  },
  {
    "text": "functions that might be in there that that indicate there's some issues in particular we're going to use dnspy it's",
    "start": "529680",
    "end": "535200"
  },
  {
    "start": "533000",
    "end": "533000"
  },
  {
    "text": "a freely available and really great tool that we'll use a couple times in this presentation but",
    "start": "535200",
    "end": "540320"
  },
  {
    "text": "we look for keywords like encryption backdoor seed secret username and it's really up to the the tester",
    "start": "540320",
    "end": "547279"
  },
  {
    "text": "kind of build their own library but in in doing this we we end up drilling into the program we find a",
    "start": "547279",
    "end": "553040"
  },
  {
    "text": "a point called validate user and password sounds interesting so we drill down into it get to the snippet of code and at this",
    "start": "553040",
    "end": "559279"
  },
  {
    "text": "point we noticed two particularly disturbing issues one is that there's a backdoor reference and the other is the",
    "start": "559279",
    "end": "564880"
  },
  {
    "text": "daily password function we drill down in the daily password function and at that point",
    "start": "564880",
    "end": "569920"
  },
  {
    "text": "we see the snippet of code here that we just basically just copy out drop into an online site",
    "start": "569920",
    "end": "575240"
  },
  {
    "text": "called.netfiddler and hit the run button and it produces a 8 character value",
    "start": "575240",
    "end": "580880"
  },
  {
    "text": "this this looks like a password of sort so we take that username backdoor and we take the password that was just",
    "start": "580880",
    "end": "586240"
  },
  {
    "text": "generated plug it into the the client interface and bang we're now into the system",
    "start": "586240",
    "end": "592080"
  },
  {
    "text": "as a back door account with full access to all the data all the information in there for all the patients",
    "start": "592080",
    "end": "597440"
  },
  {
    "text": "definitely a major issue that we discovered here now in addition to that we did find several other issues that are equally as bad but",
    "start": "597440",
    "end": "604880"
  },
  {
    "start": "600000",
    "end": "600000"
  },
  {
    "text": "really end up with the same result and that the system's fully compromisable um and",
    "start": "604880",
    "end": "610160"
  },
  {
    "text": "the complexity is not that high the impact is definitely pretty significantly high but what frames is a little differently",
    "start": "610160",
    "end": "616399"
  },
  {
    "text": "is we got over a hundred thousand patient records now that are potentially exposed to this particular bug so we go to the vendor",
    "start": "616399",
    "end": "622320"
  },
  {
    "text": "and the vendor recognizes the issue and starts remediating it and looking for the how to how to fix the problems for",
    "start": "622320",
    "end": "627440"
  },
  {
    "text": "their clients and go back to allison and tell us well it looks like there were some bugs there we don't see any",
    "start": "627440",
    "end": "633440"
  },
  {
    "text": "indication that bob was in there messing with anything we're double checking and making sure that nothing happened to his record",
    "start": "633440",
    "end": "638560"
  },
  {
    "text": "so at that moment the nurse walks in and it's time for bob who's back from the procedure he's lying there he's got a",
    "start": "638560",
    "end": "644000"
  },
  {
    "text": "little bit of pain nurse comes in with some drugs alice stops her and just takes a look at the drugs notes the",
    "start": "644000",
    "end": "649839"
  },
  {
    "text": "the number stamp on them and allows that to go on because bob's got some allergies so",
    "start": "649839",
    "end": "656000"
  },
  {
    "text": "knowing that alice turns to listen and says well you know he got allergies how do i know that that malory couldn't",
    "start": "656000",
    "end": "661360"
  },
  {
    "text": "end up impacting like the drugs could he mess with something in that system so we tell us well you know this is part",
    "start": "661360",
    "end": "666959"
  },
  {
    "start": "666000",
    "end": "666000"
  },
  {
    "text": "of a bigger system it's a drug dispensary system we've got centralized medicine management that allows you to distribute",
    "start": "666959",
    "end": "673519"
  },
  {
    "text": "medication out to the floor where it needs to be closest to the patient but integrated into that is a lot of",
    "start": "673519",
    "end": "679760"
  },
  {
    "text": "automation a lot of auditing diversion control which is theft control so",
    "start": "679760",
    "end": "685360"
  },
  {
    "text": "i mean yes you're right if mallory did get in there he could do something you could access patient records",
    "start": "685360",
    "end": "690399"
  },
  {
    "text": "modify the drug information maybe even steal drugs from a patient perspective that could lead to drug misoverdose or",
    "start": "690399",
    "end": "696720"
  },
  {
    "text": "mis the wrong kind of drugs which could be an underdose as a result of theft in addition to that there's the patient's",
    "start": "696720",
    "end": "702800"
  },
  {
    "text": "privacy and security issues so again we take a look at our application database and we tell alice that we're going to take a look",
    "start": "702800",
    "end": "708800"
  },
  {
    "text": "we're up to like 400 applications now and we just find the application and a",
    "start": "708800",
    "end": "714399"
  },
  {
    "start": "714000",
    "end": "714000"
  },
  {
    "text": "quick quick look at the server we see that there's this open share file that's part of the application install it's",
    "start": "714399",
    "end": "720320"
  },
  {
    "text": "an authenticated user share which means anybody on really on the network who's authenticated can get into the share",
    "start": "720320",
    "end": "726160"
  },
  {
    "text": "exposed in the share are two kind of issues one is a configuration file which you have a snippet here on",
    "start": "726160",
    "end": "731839"
  },
  {
    "text": "the screen you can see the second is that you have a bunch of binaries now we kind of illustrated in the last",
    "start": "731839",
    "end": "737200"
  },
  {
    "text": "issue that you if you have the binaries you can get a good understanding of what's in the program and how it operates so we drill",
    "start": "737200",
    "end": "745440"
  },
  {
    "text": "into the program start taking apart and start focusing on the the sql account decryption first and note that there is",
    "start": "745440",
    "end": "751120"
  },
  {
    "start": "749000",
    "end": "749000"
  },
  {
    "text": "actually a function there called the crypt sql credentials what's important about this is we've got the code and since it's in a",
    "start": "751120",
    "end": "757680"
  },
  {
    "text": "dll we can really just take all the functionality of that dll import it into our own visualstudio.net",
    "start": "757680",
    "end": "764000"
  },
  {
    "text": "program and have access to that functionality and really within one line of code decrypt that value that's in the config",
    "start": "764000",
    "end": "770000"
  },
  {
    "text": "file it's open to the network so we do that find out it's the essay account for the the database",
    "start": "770000",
    "end": "775360"
  },
  {
    "text": "and it has a password that appears to be a pretty much a probably as a vendor default password um",
    "start": "775360",
    "end": "781680"
  },
  {
    "text": "but still we have that that account we go back to the user accounts this time and we start looking at what we can do",
    "start": "781680",
    "end": "787839"
  },
  {
    "start": "784000",
    "end": "784000"
  },
  {
    "text": "there now in this case the decryption functionality is in some exe files so it's not just a matter of",
    "start": "787839",
    "end": "793519"
  },
  {
    "text": "referencing a dll but we can still copy out the hard-coded aes value and the and the algorithms used to",
    "start": "793519",
    "end": "800320"
  },
  {
    "text": "decrypt these strings and still paste them and piecemeal them together and own visual studio.net program",
    "start": "800320",
    "end": "806160"
  },
  {
    "text": "so we do that and we discover that inside of these uh encrypted values is a",
    "start": "806160",
    "end": "811200"
  },
  {
    "text": "local administrator account for the server as well as some other key critical accounts for the application so in other words we have full system",
    "start": "811200",
    "end": "817760"
  },
  {
    "text": "access to the database full system full access to the server",
    "start": "817760",
    "end": "822800"
  },
  {
    "text": "we take a look inside the database now and discover that there is a user table and there's usernames but",
    "start": "822800",
    "end": "829040"
  },
  {
    "text": "there's also a bunch of passwords that are encrypted do a little testing on on those encrypted passwords and discover that's",
    "start": "829040",
    "end": "835440"
  },
  {
    "text": "the same encryption algorithm used to be used to encrypt the user accounts from before so we'd run through and decrypt",
    "start": "835440",
    "end": "841839"
  },
  {
    "text": "all those accounts as well and discover that there's a bunch of vendor accounts in there that have a the same default password",
    "start": "841839",
    "end": "847839"
  },
  {
    "text": "um in addition to that uh we really have just compromised the whole entire user table database so we take that information and",
    "start": "847839",
    "end": "855360"
  },
  {
    "text": "now actually log into the application interface and gain access to the the the drug distribution",
    "start": "855360",
    "end": "862240"
  },
  {
    "text": "tool that's used to basically put medication in the cabinets control medication and cabinets tell us what",
    "start": "862240",
    "end": "867440"
  },
  {
    "text": "medications in the cabinets um in addition that we can add ourselves as a user to the whole entire",
    "start": "867440",
    "end": "872560"
  },
  {
    "text": "uh application back in at any level of permissions we want and to make a long",
    "start": "872560",
    "end": "879120"
  },
  {
    "text": "story short we now have access to one of the patient cabinets as well or that's right the the drug cabinets as well",
    "start": "879120",
    "end": "884880"
  },
  {
    "text": "and we decided to get some acetaminophen for the headache we now have just kidding we wouldn't actually do that at blackhead clinic um but still at",
    "start": "884880",
    "end": "892240"
  },
  {
    "start": "892000",
    "end": "892000"
  },
  {
    "text": "the end of the day we have fully compromised the system in the server and again we have over a hundred",
    "start": "892240",
    "end": "897519"
  },
  {
    "text": "thousand patient records in here the complexity really wasn't all that high the impact is definitely high",
    "start": "897519",
    "end": "903440"
  },
  {
    "text": "so this is this is again what we would consider a high risk issue oh we immediately contact a vendor the",
    "start": "903440",
    "end": "909199"
  },
  {
    "text": "vendor starts making changes right away and there's some simple changes that can really reduce the risk of this which were put in place",
    "start": "909199",
    "end": "915600"
  },
  {
    "text": "we tell alice about this and and alice is thankful she understands that there's issues and it's good that we're",
    "start": "915600",
    "end": "921120"
  },
  {
    "text": "we're on top of it and making changes here but bob has an insulin issue related to his",
    "start": "921120",
    "end": "926320"
  },
  {
    "text": "diabetes and she asked the question you know i think insulin is supposed to be kept in a in a secure safe environment when it comes to",
    "start": "926320",
    "end": "932560"
  },
  {
    "text": "temperature do you guys have a temperature monitoring system on that is that something malaria can mess with well we tell us that this is we do have",
    "start": "932560",
    "end": "939519"
  },
  {
    "text": "a temporary money system it's part of a overall system that monitors our drugs our food and",
    "start": "939519",
    "end": "944800"
  },
  {
    "text": "and blood in the organization and you know it's used in many different industry types but yeah if mallory were",
    "start": "944800",
    "end": "951199"
  },
  {
    "text": "to get in here he could disable honoring he could break the monitoring um which could in turn have an impact on",
    "start": "951199",
    "end": "956959"
  },
  {
    "text": "patient safety and that they could get poisoned or ineffective medication um but we tell us we're going to take a",
    "start": "956959",
    "end": "963440"
  },
  {
    "text": "look because this is again another critical system of patient care so we pull up our application database of 425",
    "start": "963440",
    "end": "969759"
  },
  {
    "text": "applications now and and in this case we installed the client but we're going to take a little",
    "start": "969759",
    "end": "974959"
  },
  {
    "text": "bit of a different approach and start to look at the data traffic behind the scenes because this isn't just a standard web",
    "start": "974959",
    "end": "980320"
  },
  {
    "text": "kind of vish bish client server architecture so we get ourselves a test account and",
    "start": "980320",
    "end": "985920"
  },
  {
    "text": "plug it in and run wireshark behind the scenes and immediately start to notice that there's a pattern typically what we",
    "start": "985920",
    "end": "991680"
  },
  {
    "text": "what you see is that there's a there's a integer value followed by a",
    "start": "991680",
    "end": "998000"
  },
  {
    "text": "couple variables called which then result in a return data um for example we have 12 as",
    "start": "998000",
    "end": "1004639"
  },
  {
    "text": "an auth code we have 34 as a change password code we have 67 as an ad update user code",
    "start": "1004639",
    "end": "1011440"
  },
  {
    "text": "uh 42 is a get group detail code and kind of build out this library here and we kind of just want to test this out in",
    "start": "1011440",
    "end": "1018240"
  },
  {
    "text": "our own little program and see if we can just simply throw the request at the server using something like scappy so we",
    "start": "1018240",
    "end": "1023440"
  },
  {
    "text": "create a scappy script which allows us to send raw data right to the server interface and",
    "start": "1023440",
    "end": "1028720"
  },
  {
    "text": "put this together see if we can query back our own user account and sure enough we end up with our user id the user name",
    "start": "1028720",
    "end": "1035280"
  },
  {
    "text": "and the password that we had set up and yes the password is alpha one not a very secure one for this testing experiment but still",
    "start": "1035280",
    "end": "1041520"
  },
  {
    "text": "we get that password now we don't have to use scappy we can just simply use a netcat command essentially and we try",
    "start": "1041520",
    "end": "1048558"
  },
  {
    "text": "and test out what we can get from the administrators group and sure enough we unback we end up with all the usernames and passwords of the",
    "start": "1048559",
    "end": "1054480"
  },
  {
    "text": "administrators group as well so we take that administrator account we log into the server and we see that",
    "start": "1054480",
    "end": "1060080"
  },
  {
    "text": "there's actually a t monitoring device that appears to be offline this is suspicious because it is",
    "start": "1060080",
    "end": "1065440"
  },
  {
    "text": "associated to where bob's at in the in the organization so we get the ip address out of the system",
    "start": "1065440",
    "end": "1070880"
  },
  {
    "text": "connect to this little iot monitoring device which collects the data for various different temperature monitors notice there's a",
    "start": "1070880",
    "end": "1077360"
  },
  {
    "text": "simple login password but we take a look at the html see there's a reference to this w directory",
    "start": "1077360",
    "end": "1083280"
  },
  {
    "text": "take a look at that directory it's got file indexing enabled and we can see that there's some uh pearl files here drill down inside those",
    "start": "1083280",
    "end": "1090320"
  },
  {
    "text": "pearl files and sure enough there's yet another password of the day function here and a completely different program",
    "start": "1090320",
    "end": "1095520"
  },
  {
    "text": "seems that this is a not so uncommon thing to find but in addition to that we also have a",
    "start": "1095520",
    "end": "1100799"
  },
  {
    "text": "reference to a hard-coded cookie value that can be set and gives",
    "start": "1100799",
    "end": "1106400"
  },
  {
    "text": "you administrator access to the iot device hard coded in these profiles as well we use our cookie editor",
    "start": "1106400",
    "end": "1112400"
  },
  {
    "text": "just simply set that value in there refresh the web page to iot device and bang we're now in so i mean this is",
    "start": "1112400",
    "end": "1119120"
  },
  {
    "text": "starting to feel like a capture the flag or some kind of sans event where where you're following through and some pretty stereotypical hacks so",
    "start": "1119120",
    "end": "1125520"
  },
  {
    "text": "we're not so surprised to see a ping out test here and one of the more common ways that those type of",
    "start": "1125520",
    "end": "1130640"
  },
  {
    "text": "tests can be exploited is to simply concatenate another command on the end of the the ip address which we attempt",
    "start": "1130640",
    "end": "1137280"
  },
  {
    "text": "to do with the cat etsy password file which should return the whole password file of course it does and we now have",
    "start": "1137280",
    "end": "1143280"
  },
  {
    "text": "passwords for the iot device take those throw those into john in about two seconds we end up cracking one",
    "start": "1143280",
    "end": "1149039"
  },
  {
    "text": "of the passwords it's not the root account but it is one of the passwords to be able to allow us to ssh",
    "start": "1149039",
    "end": "1155120"
  },
  {
    "text": "into the device once we're in the device we start looking around and there's an index.cgi file now that file",
    "start": "1155120",
    "end": "1161679"
  },
  {
    "text": "is the the main page that is that is used to piecemeal all together the the web requests and",
    "start": "1161679",
    "end": "1166799"
  },
  {
    "text": "we find this reference to a run su command now that looks suspicious because it looks like it's going to give us the",
    "start": "1166799",
    "end": "1172480"
  },
  {
    "text": "ability to run a super user command on the system so we swap out one of those values there we kind of",
    "start": "1172480",
    "end": "1178640"
  },
  {
    "text": "actually just add our own we're going to try and run a reverse shell and get that reverse shell pointed back to our server we refresh the index.cgi",
    "start": "1178640",
    "end": "1186080"
  },
  {
    "text": "page and sure enough we are now have root access to the device since it's not working anyway we ask",
    "start": "1186080",
    "end": "1191200"
  },
  {
    "text": "permission to reboot the device reboot it it comes back online so it looks like a more of a fast positive just a glitch in the system",
    "start": "1191200",
    "end": "1197200"
  },
  {
    "text": "but at the end of the day we still have unauthenticated access to the server gain administrator account access and",
    "start": "1197200",
    "end": "1203600"
  },
  {
    "text": "iot device as well we have full system control of both those parts of the the application",
    "start": "1203600",
    "end": "1209840"
  },
  {
    "text": "now there's no patient records exposed but this is a compliance and kind of regulatory issue",
    "start": "1209840",
    "end": "1215039"
  },
  {
    "text": "uh wasn't very complex the impact is rated a little bit less higher because there's no patient records but still in",
    "start": "1215039",
    "end": "1220960"
  },
  {
    "text": "his own that we don't like to see oh we go back to alice and we tell us that we're going to be actually",
    "start": "1220960",
    "end": "1226400"
  },
  {
    "text": "architecting this kind of off the network and segment this whole system out so so it's it's uh we can reduce the risk",
    "start": "1226400",
    "end": "1232640"
  },
  {
    "text": "for this environment again alice thanks us for our work and at this point um",
    "start": "1232640",
    "end": "1238320"
  },
  {
    "text": "uh bob mentions that he's a little hungry and and so alex picks up the nurse call system kind of pauses and says you know this",
    "start": "1238320",
    "end": "1245039"
  },
  {
    "text": "nurse call system is it just going to ring a bell or is there more to it well just like the patient entertainment",
    "start": "1245039",
    "end": "1250720"
  },
  {
    "text": "system these have evolved over time as well and they're kind of baked into a whole back end",
    "start": "1250720",
    "end": "1256080"
  },
  {
    "text": "environment where we can basically uh monitor the resources that are used across the organization from",
    "start": "1256080",
    "end": "1262640"
  },
  {
    "text": "from who's the most needy patient to to how fast as nurses can reply and and",
    "start": "1262640",
    "end": "1268559"
  },
  {
    "text": "help us allocate where resources need to be put as well as tracking devices and nurses",
    "start": "1268559",
    "end": "1273679"
  },
  {
    "text": "and in that whole entire process as well so from mallory's perspective he gained access",
    "start": "1273679",
    "end": "1279120"
  },
  {
    "text": "he could probably get access to patient data take over the nurse call system locate patients if it has rtls enabled",
    "start": "1279120",
    "end": "1286320"
  },
  {
    "text": "from a patient perspective they could end up getting woken up repeatedly at 2 a.m in the morning if somebody wanted to be really pain and start doing nurse",
    "start": "1286320",
    "end": "1292000"
  },
  {
    "text": "slotting in addition there's the the loss of data and privacy security issues so we take a look at our application",
    "start": "1292000",
    "end": "1298240"
  },
  {
    "text": "database and if you haven't noticed this is growing which is indicative of what is happening in healthcare",
    "start": "1298240",
    "end": "1304000"
  },
  {
    "text": "we're seeing more and more applications being thrown onto the stack to provide all kinds of different functionality and",
    "start": "1304000",
    "end": "1309600"
  },
  {
    "text": "a lot of these applications have some really great use and some key patient",
    "start": "1309600",
    "end": "1315039"
  },
  {
    "text": "care value but the stack keeps growing which means",
    "start": "1315039",
    "end": "1320240"
  },
  {
    "text": "the security teams have greater risk exposure as well well in this particular application we",
    "start": "1320240",
    "end": "1326320"
  },
  {
    "text": "get it installed and we're going to take a little bit of a different approach because it's got a client and a server but we want to see if if maybe this",
    "start": "1326320",
    "end": "1332880"
  },
  {
    "text": "client has some logic errors that really allow us to completely bypass authentication altogether",
    "start": "1332880",
    "end": "1338000"
  },
  {
    "text": "so we drill down inside of it and on the on the left side of the screen we have the the",
    "start": "1338000",
    "end": "1344080"
  },
  {
    "text": "logic flow of the program you can see there it basically throws the password and the",
    "start": "1344080",
    "end": "1349600"
  },
  {
    "text": "username off to the database and the database returns an integer value one of the values is sitting in the table layer on the right",
    "start": "1349600",
    "end": "1356080"
  },
  {
    "text": "so looking inside that table we see that there's some some values there but in this case we want to take the take the program and debug it",
    "start": "1356080",
    "end": "1363360"
  },
  {
    "text": "and again there's a couple different ways to do this but dot net spy makes it very easy so we",
    "start": "1363360",
    "end": "1368400"
  },
  {
    "text": "we simply connect the application to it we hit the debug button on the menu and and start debugging the",
    "start": "1368400",
    "end": "1374960"
  },
  {
    "text": "program and this gives us the ability to watch the program work in memory and see the values that are actually",
    "start": "1374960",
    "end": "1381360"
  },
  {
    "text": "being passed around in variables inside the program so we drill down on the verify login function here and you",
    "start": "1381360",
    "end": "1386799"
  },
  {
    "text": "can see in a little small type there there's an admin account the password asdf we let it flow through the",
    "start": "1386799",
    "end": "1392000"
  },
  {
    "text": "program and at the bottom there it returns a result now that's not the right password so and in addition that the account appears",
    "start": "1392000",
    "end": "1398159"
  },
  {
    "text": "to be locked out so it's returning that integer value that's associated with the uh the account being locked out but we can",
    "start": "1398159",
    "end": "1405200"
  },
  {
    "text": "change that value so we can just go in there and switch it to a zero now we could do this every time we restart the program",
    "start": "1405200",
    "end": "1411440"
  },
  {
    "text": "but since we have the capability we can also just simply modify the binary and make this value hard-coded so it always",
    "start": "1411440",
    "end": "1418159"
  },
  {
    "text": "returns a zero no matter what password you then enter it's going to be valid so we do that we save off",
    "start": "1418159",
    "end": "1423600"
  },
  {
    "text": "the new binary and we relaunch the application use the username admin with with whatever",
    "start": "1423600",
    "end": "1429360"
  },
  {
    "text": "password and bang we're now into the the the system as an administrator which",
    "start": "1429360",
    "end": "1434880"
  },
  {
    "text": "gives us the ability to control all the user accounts and basically make nurse calls to any room any floor anybody we want to",
    "start": "1434880",
    "end": "1442840"
  },
  {
    "text": "um now that's definitely a big problem but we also you know note that there's a",
    "start": "1442840",
    "end": "1448159"
  },
  {
    "text": "server side component to this we just want to take a look at the server side we're going to drill in a little bit and see what kind of",
    "start": "1448159",
    "end": "1454480"
  },
  {
    "text": "um references using that same example we used in in the clinical documentation system to",
    "start": "1454480",
    "end": "1459679"
  },
  {
    "text": "see if there's anything important in there and we do that here's the user interface and while we're looking around we happen",
    "start": "1459679",
    "end": "1464880"
  },
  {
    "text": "to find a reverse still back door account except not just one back door three back doors in this case",
    "start": "1464880",
    "end": "1470320"
  },
  {
    "text": "and this is a little bit interesting because we go back to the vendor and the vendor's basically kind of stuck because this was",
    "start": "1470320",
    "end": "1475520"
  },
  {
    "text": "part of a merger and acquisition where they've kind of acquired some of this code and don't really have the",
    "start": "1475520",
    "end": "1480880"
  },
  {
    "text": "capability at least to really fix it they're going to focus on a new version so you know we've got the capability to",
    "start": "1480880",
    "end": "1486640"
  },
  {
    "text": "patch it so instead of asking a vendor for a patch we've looked into patching it ourselves and just",
    "start": "1486640",
    "end": "1491840"
  },
  {
    "text": "simply changing those passwords to something a lot more complex and not so standard and we do that reboot the program it",
    "start": "1491840",
    "end": "1497600"
  },
  {
    "text": "comes back up and now we we've passed our own issue regarding this back door but we have access to the administrator",
    "start": "1497600",
    "end": "1503760"
  },
  {
    "text": "interface of the nurse call system all the patient data that's flowing in between and the adt feeds are called",
    "start": "1503760",
    "end": "1510640"
  },
  {
    "text": "at the end of the day the system's fully compromised um wasn't really that complex and the impact's definitely high we're",
    "start": "1510640",
    "end": "1517360"
  },
  {
    "text": "over our 500 count and this 500 counts a little bit of a of a fuzzy number because it's a per day",
    "start": "1517360",
    "end": "1523360"
  },
  {
    "text": "account maybe a per week account and that number is going to grow over time as more patients come through the system",
    "start": "1523360",
    "end": "1528880"
  },
  {
    "text": "if somebody was actively monitoring or it's going to be a snapshot in time if somebody just found that",
    "start": "1528880",
    "end": "1533919"
  },
  {
    "text": "found this issue at a point of uh of exploitation so we go back to alice",
    "start": "1533919",
    "end": "1540960"
  },
  {
    "text": "and tell her that you know we found some issues we're working to get those remediated segmentation and patching um alice replies thank you",
    "start": "1540960",
    "end": "1548480"
  },
  {
    "text": "and and at this point the doctor comes back and says well we took a look at the radiology images and",
    "start": "1548480",
    "end": "1554640"
  },
  {
    "text": "and everything looks fine um you know we just need to make sure we keep an eye on bob but you know we're going to wrap",
    "start": "1554640",
    "end": "1560480"
  },
  {
    "text": "this up and you'll be able to get out of here soon so alice turns us and says what's this radiology system is that another system",
    "start": "1560480",
    "end": "1566240"
  },
  {
    "text": "that potentially could put you know bob at risk if mallory got in so we tell what this is a clinically immune system",
    "start": "1566240",
    "end": "1572559"
  },
  {
    "start": "1571000",
    "end": "1571000"
  },
  {
    "text": "there's numerous ones out there this one you know they kind of all serve the same general purpose and that",
    "start": "1572559",
    "end": "1578480"
  },
  {
    "text": "they allow you to look at the images and analyze them they have baked in tools for analyzing uh track the images over time",
    "start": "1578480",
    "end": "1585679"
  },
  {
    "text": "allow your document against it and share that with other other radiologists um",
    "start": "1585679",
    "end": "1590960"
  },
  {
    "text": "and doctors and you know if a bad guy got in yes they could access it they could modify they could delete",
    "start": "1590960",
    "end": "1596559"
  },
  {
    "text": "obviously that's going to have potential to impact patient care from from bob's perspective in addition to the loss of data and",
    "start": "1596559",
    "end": "1602640"
  },
  {
    "text": "privacy security so we pull up our application database of 500 applications now",
    "start": "1602640",
    "end": "1609679"
  },
  {
    "text": "find the application get it installed and this time it's not a net program but we want to make sure that that we still take a look and we",
    "start": "1609679",
    "end": "1616320"
  },
  {
    "start": "1612000",
    "end": "1612000"
  },
  {
    "text": "use ida which kind of allows us to do much of the same thing we can search through the program fight find",
    "start": "1616320",
    "end": "1622159"
  },
  {
    "text": "key elements that are important in there and we do that and find a reference to um password match hash and and password",
    "start": "1622159",
    "end": "1629279"
  },
  {
    "text": "is valid and we start to look at those and in addition we can still also patch the program now it's a little bit different",
    "start": "1629279",
    "end": "1635440"
  },
  {
    "text": "inside of a c plus plus or c compiled program but at the end of the day there's there's op codes that operate behind the",
    "start": "1635440",
    "end": "1642159"
  },
  {
    "start": "1639000",
    "end": "1639000"
  },
  {
    "text": "scene and these op codes uh work with the we're kind of the same way and",
    "start": "1642159",
    "end": "1647520"
  },
  {
    "text": "in the current program there's a jump not zero which basically says that the password doesn't match go this way",
    "start": "1647520",
    "end": "1652720"
  },
  {
    "text": "if it matches go this way we can change that to a jump zero which means if the password matches",
    "start": "1652720",
    "end": "1658240"
  },
  {
    "text": "fail if the password doesn't match open so the difference between the two op codes",
    "start": "1658240",
    "end": "1663279"
  },
  {
    "text": "is really just a 75 versus a 74 which we can find in in the binary we",
    "start": "1663279",
    "end": "1668480"
  },
  {
    "text": "swap that out save it off have a new binary and we have the old and the new noun that you",
    "start": "1668480",
    "end": "1673840"
  },
  {
    "text": "can see on the screen here from a jump not zero converter to jump zero and as a result when we go back to the",
    "start": "1673840",
    "end": "1678960"
  },
  {
    "text": "program plug in this user account of support which is provided to us as a result of some other issues with",
    "start": "1678960",
    "end": "1684559"
  },
  {
    "text": "the system we plug in a password of a and sure enough we are now logged in and are able to see bob's records but",
    "start": "1684559",
    "end": "1691120"
  },
  {
    "text": "we don't really know what this means at the end of the day though it still is exposed in addition to that because we",
    "start": "1691120",
    "end": "1697679"
  },
  {
    "start": "1696000",
    "end": "1696000"
  },
  {
    "text": "patched that particular part of the program it also allows us into the administrator tool with the same support account um and we",
    "start": "1697679",
    "end": "1704000"
  },
  {
    "text": "can access to all the users and change their passwords change the configuration of the system and so on so the system's fully",
    "start": "1704000",
    "end": "1711120"
  },
  {
    "start": "1710000",
    "end": "1710000"
  },
  {
    "text": "compromised um the con the the complexity it may be a medium but i mean it wasn't super complicated the",
    "start": "1711120",
    "end": "1718080"
  },
  {
    "text": "impact is definitely high and in this case we've got over a thousand records just because the program",
    "start": "1718080",
    "end": "1723520"
  },
  {
    "text": "is a little bit more of a niche program so we go back to alice we we also work with",
    "start": "1723520",
    "end": "1728640"
  },
  {
    "text": "the vendor before that and the vendor's going to get us a patch for this and and remediate the issue go back to alice and",
    "start": "1728640",
    "end": "1734640"
  },
  {
    "text": "explain what happened and i always thanks us for all the work that we've been doing related to this application security",
    "start": "1734640",
    "end": "1739840"
  },
  {
    "text": "you know raising the bar for for this getting some vendors to pay attention to the software issues um but she asked other additional",
    "start": "1739840",
    "end": "1747039"
  },
  {
    "text": "questions and says well you know you guys are working with these applications they all sit in the data center",
    "start": "1747039",
    "end": "1752880"
  },
  {
    "text": "somewhere and i know you're working on the confidentiality and integrity of that that cia triad but what about the",
    "start": "1752880",
    "end": "1758799"
  },
  {
    "text": "availability um what if that data center goes offline how are patients able to to maintain their care and and how the",
    "start": "1758799",
    "end": "1765440"
  },
  {
    "text": "the patient care teams able to know what the patient's even there for we tell",
    "start": "1765440",
    "end": "1771360"
  },
  {
    "text": "alice well this is part of an emr downtime device solution because you're right you know you have a have an organization all the",
    "start": "1771360",
    "end": "1778000"
  },
  {
    "text": "databases and the software runs in the data center but there are some times where where the",
    "start": "1778000",
    "end": "1783360"
  },
  {
    "text": "network goes down or a piece of hardware goes down and kind of isolates a piece of the the network whether it's an outpatient facility a small hospital",
    "start": "1783360",
    "end": "1790480"
  },
  {
    "text": "or clinic or even a floor in the hospital but we have these things called downtime devices",
    "start": "1790480",
    "end": "1796080"
  },
  {
    "text": "that we distribute throughout the organization and they have enough information on them for the patients in those in those areas",
    "start": "1796080",
    "end": "1802559"
  },
  {
    "text": "that allow the care teams to maybe know allergies what the patient's there for um",
    "start": "1802559",
    "end": "1808080"
  },
  {
    "text": "key critical things that they need to understand about what the patients you know that they need to know in order",
    "start": "1808080",
    "end": "1813279"
  },
  {
    "text": "to treat the patient um i mean these are sensitive obviously so we encrypt the hard drives they have",
    "start": "1813279",
    "end": "1818960"
  },
  {
    "start": "1816000",
    "end": "1816000"
  },
  {
    "text": "username and passwords in them you know for hipaa compliance and the patient reports are encrypted the user everything i mean the user",
    "start": "1818960",
    "end": "1825600"
  },
  {
    "text": "table is encrypted um so alice just kind of stops and pauses for a second and says well",
    "start": "1825600",
    "end": "1831440"
  },
  {
    "text": "you've kind of illustrated that client-side security is really hard to do and these all kind of sound like they're",
    "start": "1831440",
    "end": "1837200"
  },
  {
    "text": "self-embodied clients that have all the data in them we pause you're right alice so you know we're",
    "start": "1837200",
    "end": "1843200"
  },
  {
    "text": "going to take a look at one of these and we pull up one of the downtime devices and find a login prompt and",
    "start": "1843200",
    "end": "1849679"
  },
  {
    "text": "start taking a look at the code behind the scenes using the same process before with dan spy find a part of the program",
    "start": "1849679",
    "end": "1856000"
  },
  {
    "text": "there that that the password is basically doing a matching validation and from there we we strip that out and",
    "start": "1856000",
    "end": "1863919"
  },
  {
    "text": "we resave the binaries and we basically set the program up so all it checks to see",
    "start": "1863919",
    "end": "1869039"
  },
  {
    "text": "if the user is locked if the user isn't locked we find that we can gain access to the patient records inside the downtime device",
    "start": "1869039",
    "end": "1875679"
  },
  {
    "text": "now that's a small subset of patients but while we're in there we also happen to really",
    "start": "1875679",
    "end": "1880720"
  },
  {
    "text": "we notice that there's a load and decrypt user table function in there so again you know if it's pulling those",
    "start": "1880720",
    "end": "1886399"
  },
  {
    "text": "values into memory then we can probably take the opportunity to write those values out and we patched the program again to",
    "start": "1886399",
    "end": "1892640"
  },
  {
    "text": "to just simply write the user table out using just some more c sharp code and plug it in there save the binary off uh",
    "start": "1892640",
    "end": "1899279"
  },
  {
    "text": "relaunch the the computer and program and and it gives us a copy of the user table",
    "start": "1899279",
    "end": "1904720"
  },
  {
    "start": "1904000",
    "end": "1904000"
  },
  {
    "text": "now the user hash kind of looks like this um it's got pieces of information in it but",
    "start": "1904720",
    "end": "1910399"
  },
  {
    "text": "again we have access to the code that we can create our own basically uh representation of of how the hash is",
    "start": "1910399",
    "end": "1917600"
  },
  {
    "text": "created when it's entered from a username and password perspective the hash has to be created so it can be bounced against the",
    "start": "1917600",
    "end": "1923519"
  },
  {
    "text": "the table there so we recreate our own hash creation process and effectively allow us to do a hash",
    "start": "1923519",
    "end": "1929279"
  },
  {
    "text": "cracking um type of program that we can do offline it's important to note that that inside",
    "start": "1929279",
    "end": "1935600"
  },
  {
    "start": "1931000",
    "end": "1931000"
  },
  {
    "text": "the user table is a copy of every single emr user's username and hash",
    "start": "1935600",
    "end": "1940880"
  },
  {
    "text": "which is pretty significant number of the the employees at blackhat clinic but we we do that we run",
    "start": "1940880",
    "end": "1947679"
  },
  {
    "text": "it through and sure enough um after a few minutes we we discover that we can actually crack some of the passwords",
    "start": "1947679",
    "end": "1953360"
  },
  {
    "text": "it's slow but it's offline and and it's just a matter of time and resources",
    "start": "1953360",
    "end": "1958880"
  },
  {
    "text": "and while doing that we kind of took a step back and realized that we had another issue here in that",
    "start": "1958880",
    "end": "1964080"
  },
  {
    "start": "1959000",
    "end": "1959000"
  },
  {
    "text": "the the authentication prompt sat in generic user space but it interfaced with a",
    "start": "1964080",
    "end": "1969120"
  },
  {
    "text": "service account running in system space which was using dlls that were in what were effective that's",
    "start": "1969120",
    "end": "1975200"
  },
  {
    "text": "effectively generic user space and has the ability to um be modified and",
    "start": "1975200",
    "end": "1980399"
  },
  {
    "text": "written to by authenticated users again meaning we have a traditional dll",
    "start": "1980399",
    "end": "1985840"
  },
  {
    "text": "injection or overwrite issue that has been allowing us to do some of these um rewrites and and",
    "start": "1985840",
    "end": "1991279"
  },
  {
    "start": "1988000",
    "end": "1988000"
  },
  {
    "text": "patches in the first place inside of the application on the downtime devices so we take advantage of this and there's",
    "start": "1991279",
    "end": "1998000"
  },
  {
    "text": "many ways to do this but we simply just patch it again and point it to a batch file which gives us the capability to",
    "start": "1998000",
    "end": "2003360"
  },
  {
    "text": "run any particular script or program we want we just want to get admin on the box so we just put in the command to add admin",
    "start": "2003360",
    "end": "2009679"
  },
  {
    "start": "2009000",
    "end": "2009000"
  },
  {
    "text": "and we now have admin to the box and once we have admin on the box we we can now configure the downtime device",
    "start": "2009679",
    "end": "2016399"
  },
  {
    "text": "and we do it the first thing we do is we configure the downtime device to basically be a downtime device for the",
    "start": "2016399",
    "end": "2022159"
  },
  {
    "text": "entire organization which means all the patients in all the other pieces and parts of the organization all",
    "start": "2022159",
    "end": "2028159"
  },
  {
    "text": "their records now also come to just this one downtime device so we get all those records um and while doing that we we kind of",
    "start": "2028159",
    "end": "2034559"
  },
  {
    "text": "discovered there's a key that that syncs the downtime device to the downtime server it's the same key for all the downtime",
    "start": "2034559",
    "end": "2040880"
  },
  {
    "text": "devices so it's a per organization key now the key is securely",
    "start": "2040880",
    "end": "2046159"
  },
  {
    "text": "stored on the downtime device but because we have access to the code whereas",
    "start": "2046159",
    "end": "2051679"
  },
  {
    "text": "administrator now in the box we can again just simply find the location in the program export that key out and now we we've got",
    "start": "2051679",
    "end": "2058878"
  },
  {
    "text": "a process by which we can export a key out for the downtime devices for an organization",
    "start": "2058879",
    "end": "2064079"
  },
  {
    "text": "so we go down the street to defcon clinic and we see if this is actually going to be something that that can be exploited",
    "start": "2064079",
    "end": "2070158"
  },
  {
    "text": "we take our patch dll throw it into a downtown device in defcon clinic reboot the device and it produces the",
    "start": "2070159",
    "end": "2076480"
  },
  {
    "text": "key for us we've got the key we have our our device here we we've managed to get it on the network",
    "start": "2076480",
    "end": "2082320"
  },
  {
    "text": "which is is is the first um a hurdle to overcome not necessarily a really difficult hurdle so",
    "start": "2082320",
    "end": "2089599"
  },
  {
    "text": "we get that um our own downtime device uh like a fake one a spoofed one onto",
    "start": "2089599",
    "end": "2095440"
  },
  {
    "text": "the network insert the key into that downtime device by just modifying memory",
    "start": "2095440",
    "end": "2100480"
  },
  {
    "text": "patching it um a couple different ways we could do that but the downtime device now has that def con clinics key points to",
    "start": "2100480",
    "end": "2107119"
  },
  {
    "text": "defcon clinics downtime server and now we have all the records for the um for the defcon clinic as well",
    "start": "2107119",
    "end": "2115119"
  },
  {
    "text": "in addition to that we already know how to bypass authentication so we don't need to worry about actually logging into it because we can just do that",
    "start": "2115119",
    "end": "2121760"
  },
  {
    "start": "2116000",
    "end": "2116000"
  },
  {
    "text": "and the the uh part of the information downloaded is also the user",
    "start": "2121760",
    "end": "2126800"
  },
  {
    "text": "table for defcon clinic so we can now access the user accounts and the passwords there",
    "start": "2126800",
    "end": "2132000"
  },
  {
    "text": "and um as a result we've basically expanded our scope of uh",
    "start": "2132000",
    "end": "2137440"
  },
  {
    "text": "of compromise to other organizations with this particular issue so again the complexity is a little bit",
    "start": "2137440",
    "end": "2144160"
  },
  {
    "text": "more challenging putting everything in on the table the the impact is definitely high 13 000",
    "start": "2144160",
    "end": "2150640"
  },
  {
    "text": "records exposed um in our scenario here and again this is a kind of like a per",
    "start": "2150640",
    "end": "2156240"
  },
  {
    "text": "day or per patient while they're in the organization rolling number so that number kind of",
    "start": "2156240",
    "end": "2162560"
  },
  {
    "text": "could grow over time or just be a simple snapshot as as the uh if somebody were to exploit",
    "start": "2162560",
    "end": "2168000"
  },
  {
    "text": "this bug um so i mean kind of wrapping it all up if you look at what we did",
    "start": "2168000",
    "end": "2173200"
  },
  {
    "start": "2170000",
    "end": "2170000"
  },
  {
    "text": "we started with something simple relatively speaking with burp looking behind the scenes noticing that there's just client-side code with",
    "start": "2173200",
    "end": "2179760"
  },
  {
    "text": "client-side validation then we start looking at some of the code and see if there's anything suspicious in there that's hidden away",
    "start": "2179760",
    "end": "2185520"
  },
  {
    "text": "inside the code that could be exploited we we also looked at some of the tcp protocols and the the activity on the",
    "start": "2185520",
    "end": "2192960"
  },
  {
    "text": "network looked at how we could modify some of the logic behind the scenes for net programs and then also use that",
    "start": "2192960",
    "end": "2200320"
  },
  {
    "text": "for our c plus plus program and patch the program and kind of wrapped it all up in a final example",
    "start": "2200320",
    "end": "2206079"
  },
  {
    "text": "with the downtime devices where he took that kind of to the next level and just showed how far it you can get if one of these",
    "start": "2206079",
    "end": "2212480"
  },
  {
    "text": "particular web sorry application security issues so the reason why this is again",
    "start": "2212480",
    "end": "2219119"
  },
  {
    "text": "important is that you know just in our example here with the sizing of black hat clinic and",
    "start": "2219119",
    "end": "2224400"
  },
  {
    "text": "defcon clinic thrown in there we effectively were able to illustrate a compromise of about 225 000 records",
    "start": "2224400",
    "end": "2230960"
  },
  {
    "text": "now these records can go for depending who you talk to a thousand dollars or ten dollars a record either way we're",
    "start": "2230960",
    "end": "2236960"
  },
  {
    "text": "talking about you know 2.25 million or 225 million for just one ecosystem or one one",
    "start": "2236960",
    "end": "2243359"
  },
  {
    "text": "environment now if we extrapolate that out and you look at all the hospitals inside of the",
    "start": "2243359",
    "end": "2248720"
  },
  {
    "text": "the country or even broader i mean i could have probably named this the trillion dollar healthcare application",
    "start": "2248720",
    "end": "2253839"
  },
  {
    "text": "security issue because we're talking about some pretty significant numbers when you go that big of real data records that are",
    "start": "2253839",
    "end": "2261280"
  },
  {
    "text": "have a real value out there in the real world um so some pointers that we do go",
    "start": "2261280",
    "end": "2268160"
  },
  {
    "start": "2265000",
    "end": "2265000"
  },
  {
    "text": "through when we look at these applications is we just kind of spend two to four hours looking for what i'll call red",
    "start": "2268160",
    "end": "2273520"
  },
  {
    "text": "flag indicators default credentials playing plain text credentials um it's a badly designed apis with no",
    "start": "2273520",
    "end": "2279920"
  },
  {
    "text": "credentials or or secrets that are embedded in code really kind of help us understand where",
    "start": "2279920",
    "end": "2285839"
  },
  {
    "text": "we may need to pay more attention and dig in deeper in addition to that we have found many",
    "start": "2285839",
    "end": "2291040"
  },
  {
    "text": "cases where where the credentials themselves are stored in a database but you know they we are told that their",
    "start": "2291040",
    "end": "2297440"
  },
  {
    "text": "credentials are secure but when we actually reverse out the the way those credentials are secured they",
    "start": "2297440",
    "end": "2303760"
  },
  {
    "text": "number one aren't really that well secured number two often have really bad passwords and password management baked",
    "start": "2303760",
    "end": "2309040"
  },
  {
    "text": "into the program so these are all the different the different ways that we we look inside the organization and we",
    "start": "2309040",
    "end": "2315520"
  },
  {
    "start": "2315000",
    "end": "2315000"
  },
  {
    "text": "do this doing what i'll call light pen test against new products um in addition to that because we want the team to continue to grow their",
    "start": "2315520",
    "end": "2321839"
  },
  {
    "text": "skills and and have have an understanding of these the the the security issues that are current",
    "start": "2321839",
    "end": "2327440"
  },
  {
    "text": "in the past or even that are coming up in the future we do team pace uh team-based pen test exercise practices where we let the",
    "start": "2327440",
    "end": "2335119"
  },
  {
    "text": "team play on capture the flags or internal products or even self-develop ones that some of our team have helped create",
    "start": "2335119",
    "end": "2341520"
  },
  {
    "text": "in fact this one the cso 2020 award for just just pushing that bar a little",
    "start": "2341520",
    "end": "2347440"
  },
  {
    "text": "bit further we have the security testing back into our goals we have a program",
    "start": "2347440",
    "end": "2353200"
  },
  {
    "text": "for our team that that again encourages them to learn more and and understand more about these bugs",
    "start": "2353200",
    "end": "2358960"
  },
  {
    "text": "we also are working with hisac which is a healthcare um consortium for for those in the",
    "start": "2358960",
    "end": "2364880"
  },
  {
    "text": "healthcare field to share information and we're moving in that direction where we can share some of these vulnerabilities because that is",
    "start": "2364880",
    "end": "2370240"
  },
  {
    "text": "a big challenge for healthcare is we don't want to just post this stuff out there publicly when we find it and it's hard to kind of get",
    "start": "2370240",
    "end": "2376079"
  },
  {
    "text": "traction sometimes on getting remediation moving but we want other healthcare providers",
    "start": "2376079",
    "end": "2381119"
  },
  {
    "text": "to understand that there's some risk inside their network as well and if they have the same product they probably want to do something about it",
    "start": "2381119",
    "end": "2387119"
  },
  {
    "text": "so we're gonna we're looking at leveraging hisac for that particular aspect of this and i mean finally where",
    "start": "2387119",
    "end": "2393920"
  },
  {
    "start": "2392000",
    "end": "2392000"
  },
  {
    "text": "to from here healthcare security teams we encourage you to start using some of these tactics and",
    "start": "2393920",
    "end": "2400079"
  },
  {
    "text": "methods to kind of look through your own security software our own applications for security issues",
    "start": "2400079",
    "end": "2406400"
  },
  {
    "text": "um we would like to be able to share if you remember hisac that seems to be a good place to do it",
    "start": "2406400",
    "end": "2411520"
  },
  {
    "text": "uh it's more of an enclosed environment and we just really need to share a lot more um security community",
    "start": "2411520",
    "end": "2417839"
  },
  {
    "text": "i ask that if you guys and women have an opportunity to get out there and when you're doing",
    "start": "2417839",
    "end": "2424000"
  },
  {
    "text": "audits or assessments or pen tests and look at the applications just don't look",
    "start": "2424000",
    "end": "2429200"
  },
  {
    "text": "at the the how active directory works or or just you know the normal stuff that",
    "start": "2429200",
    "end": "2434560"
  },
  {
    "text": "you look for in a pen test add in the scope a healthcare application and you might find something interesting",
    "start": "2434560",
    "end": "2440079"
  },
  {
    "text": "and different instead of just going to main admin and finally the healthcare vendors",
    "start": "2440079",
    "end": "2445440"
  },
  {
    "text": "i mean us healthcare security professionals already have multiple hats in many cases",
    "start": "2445440",
    "end": "2450800"
  },
  {
    "text": "especially for smaller healthcare organizations um we also have to maintain all the normal things that the security teams",
    "start": "2450800",
    "end": "2456960"
  },
  {
    "text": "have to do with firewalls and end users and training and and and maintaining a secure edge and patching and all that",
    "start": "2456960",
    "end": "2463920"
  },
  {
    "text": "this healthcare application issue just makes it that much more challenging to keep things secure at the end of the day",
    "start": "2463920",
    "end": "2469040"
  },
  {
    "text": "we're really talking about patience and patient care and that this is a in many ways a patient data",
    "start": "2469040",
    "end": "2476240"
  },
  {
    "text": "and privacy security issue so um i'd just like to thank the penn medicine security team uh everybody on the team",
    "start": "2476240",
    "end": "2483119"
  },
  {
    "text": "has had some impact on this presentation um and i just not like to thank black hat for",
    "start": "2483119",
    "end": "2488160"
  },
  {
    "text": "making this possible and with that i'll take your questions inside the chat channel",
    "start": "2488160",
    "end": "2493680"
  },
  {
    "text": "thanks hello um i only have 10 seconds uh",
    "start": "2493680",
    "end": "2500160"
  },
  {
    "text": "to really say thank you for all those who have been interacting with me on the chat there i'll be around the chat for",
    "start": "2500160",
    "end": "2506240"
  },
  {
    "text": "another 20 minutes or so thanks for the question thanks for the feedback i hope this is enlightening and brought some uh really much needed",
    "start": "2506240",
    "end": "2512960"
  },
  {
    "text": "attention to healthcare data healthcare application security so thanks and hope to talk to you later",
    "start": "2512960",
    "end": "2521920"
  }
]