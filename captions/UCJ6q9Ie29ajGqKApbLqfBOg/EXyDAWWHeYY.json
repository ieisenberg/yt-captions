[
  {
    "text": "all right let's start the presentation i am simon han and very pleased to share my research thank",
    "start": "2960",
    "end": "8960"
  },
  {
    "text": "you for inviting me in this presentation i'm going to talk about the vulnerability of the trusted",
    "start": "8960",
    "end": "14719"
  },
  {
    "text": "flapper module and the first microsoft bitracker with it",
    "start": "14719",
    "end": "20560"
  },
  {
    "text": "i am a senior security researcher at the affiliated institute of etri and i am a review board member of black",
    "start": "20560",
    "end": "27519"
  },
  {
    "text": "laser and gibson conference i was a speaker at several conferences like using security",
    "start": "27519",
    "end": "33600"
  },
  {
    "text": "black asia black and draw hacking the box skill conference and so on additionally i'm a deviant linux",
    "start": "33600",
    "end": "40320"
  },
  {
    "text": "maintainer and have been taking care of packages related to the cpu and advanced",
    "start": "40320",
    "end": "45360"
  },
  {
    "text": "configuration and power interface i have contributed several linux corner",
    "start": "45360",
    "end": "50399"
  },
  {
    "text": "patches too these are my previous works i presented",
    "start": "50399",
    "end": "56559"
  },
  {
    "text": "three vulnerabilities about the tpm cbe 2017-1637",
    "start": "56559",
    "end": "62879"
  },
  {
    "text": "cbe 2018.602 and cve 2020 0.526",
    "start": "62879",
    "end": "69360"
  },
  {
    "text": "if you want to know detailed information about the tpm and the vulnerabilities please check my previous works the goal",
    "start": "69360",
    "end": "76960"
  },
  {
    "text": "of this presentation i present an object vector f3 switching",
    "start": "76960",
    "end": "82080"
  },
  {
    "text": "state to support a trusted black module the f3 flipping state is because of the",
    "start": "82080",
    "end": "88159"
  },
  {
    "text": "power of cpu and repair devices i found cve 2018.602 from a discrete dpm",
    "start": "88159",
    "end": "95920"
  },
  {
    "text": "and cve 2020 from 5 to 6 from formula tpn",
    "start": "95920",
    "end": "102159"
  },
  {
    "text": "i also introduced a new tool b trigger bit record extracts the volume master key of the tracker from dpms",
    "start": "102159",
    "end": "109680"
  },
  {
    "text": "b trigger can mount a betrayal corrupt partition with the pnk disclaimer",
    "start": "109680",
    "end": "116560"
  },
  {
    "text": "firstly i do not explain bitracker's encryption algorithm",
    "start": "116560",
    "end": "121680"
  },
  {
    "text": "i focus on the protection mechanism for the volume master key especially the mechanism only without",
    "start": "121680",
    "end": "128800"
  },
  {
    "text": "tpm and it's a default option of it rocker secondly i do not explain",
    "start": "128800",
    "end": "135840"
  },
  {
    "text": "vulnerabilities in b tracker i introduced the tpm vulnerabilities",
    "start": "135840",
    "end": "141200"
  },
  {
    "text": "and support the vmk protection of vitractor with them the vulnerabilities i found are in the",
    "start": "141200",
    "end": "147840"
  },
  {
    "text": "tpm not the bitracker all right first of all",
    "start": "147840",
    "end": "155440"
  },
  {
    "text": "i would like to tell you a short story because i don't want to make a serious mood",
    "start": "155440",
    "end": "163680"
  },
  {
    "text": "right once upon a time there was a young boy and his father",
    "start": "163680",
    "end": "170080"
  },
  {
    "text": "made a wise remark to him like his wife my son",
    "start": "170080",
    "end": "177840"
  },
  {
    "text": "when he listened to it he imagined a scene and thought he was a small lion",
    "start": "178480",
    "end": "186000"
  },
  {
    "text": "and would be a king like this yeah it was a happy dream",
    "start": "186000",
    "end": "194720"
  },
  {
    "text": "however as he grew up he thought he was not a king like a lion",
    "start": "194800",
    "end": "200400"
  },
  {
    "text": "and would be will become that guy and could do",
    "start": "200400",
    "end": "207599"
  },
  {
    "text": "something important with the king but life was wild like the father's word",
    "start": "207599",
    "end": "213519"
  },
  {
    "text": "and he finally realized that he was just a small animal over there",
    "start": "213519",
    "end": "221680"
  },
  {
    "text": "and it was almost impossible to become an important person like the left side however",
    "start": "221680",
    "end": "229920"
  },
  {
    "text": "he was not disappointed because he became a street researcher and the",
    "start": "229920",
    "end": "236640"
  },
  {
    "text": "nuts were enough for him as you know the happiness doesn't last",
    "start": "236640",
    "end": "242400"
  },
  {
    "text": "forever and the day had come he met a big big problem this guy",
    "start": "242400",
    "end": "250319"
  },
  {
    "text": "was his hero and he wanted to be like the guy as you know the guy is the father of",
    "start": "250319",
    "end": "256560"
  },
  {
    "text": "leonardo's operating system and he looked like he loved both",
    "start": "256560",
    "end": "262240"
  },
  {
    "text": "linux and windows so the poor security researcher tried to make the best",
    "start": "262240",
    "end": "267840"
  },
  {
    "text": "researching machine with windows 10 plus interactive plus",
    "start": "267840",
    "end": "273520"
  },
  {
    "text": "linux and then this screen showed as you know",
    "start": "273520",
    "end": "280080"
  },
  {
    "text": "this screen shows that b trucker kidnapped your day i'm sorry um i mean bit tracker",
    "start": "280080",
    "end": "288560"
  },
  {
    "text": "protected your data maybe from you right",
    "start": "288560",
    "end": "295759"
  },
  {
    "text": "anyway it means that if you want to get your data back uh you have to type the recovery key",
    "start": "295759",
    "end": "303199"
  },
  {
    "text": "even though the data are yours unfortunately the prosecute researcher",
    "start": "303199",
    "end": "310160"
  },
  {
    "text": "forgot the key and he just screamed even though he was in adversity he",
    "start": "310160",
    "end": "317600"
  },
  {
    "text": "didn't give up he made up his mind to get the data back and",
    "start": "317600",
    "end": "323440"
  },
  {
    "text": "started his long and painful journey as you guess the poor script researcher",
    "start": "323440",
    "end": "330479"
  },
  {
    "text": "is me and this is my story this is content",
    "start": "330479",
    "end": "338400"
  },
  {
    "text": "and background this is poor skills researchers uh",
    "start": "338400",
    "end": "343680"
  },
  {
    "text": "system the system was internal look 8 i7 hvk and had a skill boot and tpm 2.0",
    "start": "343680",
    "end": "351039"
  },
  {
    "text": "feature and windows 10 and ubuntu 18.4 were installed in each disk from now",
    "start": "351039",
    "end": "358800"
  },
  {
    "text": "i will talk about bitracker according to the microsoft documents bitracker is a data protection",
    "start": "358800",
    "end": "366639"
  },
  {
    "text": "feature that integrates with windows operating system oh yeah the data protection feature that",
    "start": "366639",
    "end": "374720"
  },
  {
    "text": "protects data from me maybe anyway",
    "start": "374720",
    "end": "380560"
  },
  {
    "text": "it addresses the threats of data theft or exposure from lost stolen or inappropriately",
    "start": "380560",
    "end": "387360"
  },
  {
    "text": "decommissioned computers it provides the most protection when used with a",
    "start": "387360",
    "end": "393919"
  },
  {
    "text": "transfer platform module for that the formula must support tcg specified static rotor transfer",
    "start": "393919",
    "end": "401919"
  },
  {
    "text": "measurement the important point of the bit rocker are",
    "start": "401919",
    "end": "408160"
  },
  {
    "text": "thrusted flapper motor and statue doctors for measurement tpm is a tamper resistant device and has",
    "start": "408160",
    "end": "416000"
  },
  {
    "text": "two versions tpm 2.0 and tpin 1.2 tpm is used to determine the trustworthiness of a",
    "start": "416000",
    "end": "423120"
  },
  {
    "text": "system by investigating the value stored in the pcrs tpm is also used to limit access to",
    "start": "423120",
    "end": "430560"
  },
  {
    "text": "secret data based on specific pcr values for this has two operations clan and",
    "start": "430560",
    "end": "437440"
  },
  {
    "text": "cell to manage secret data serial operation includes the secret data with pcrs of the tpm",
    "start": "437440",
    "end": "444080"
  },
  {
    "text": "unzero operation can decrease the sales data only if the pcr values matches the specific values b tracker of",
    "start": "444080",
    "end": "452160"
  },
  {
    "text": "microsoft uses the serial nonzero functions for vnk protection",
    "start": "452160",
    "end": "458400"
  },
  {
    "text": "the root of trust for measurement sends integrity relevant information to the tpm",
    "start": "458400",
    "end": "463759"
  },
  {
    "text": "tpm specification course this accumulating operation extend as you see the extent process on",
    "start": "463759",
    "end": "470400"
  },
  {
    "text": "the middle of the page the tpm accumulates the measurements to a pcr with the",
    "start": "470400",
    "end": "476400"
  },
  {
    "text": "previously stored value in the pcr because of this process a smart bit chain that changes uh to a",
    "start": "476400",
    "end": "483919"
  },
  {
    "text": "pcr value will affect all the following extended values rtm is the cpu control device core",
    "start": "483919",
    "end": "491120"
  },
  {
    "text": "rtm and it is the first set of instruction when a new chain of trust is established",
    "start": "491120",
    "end": "497759"
  },
  {
    "text": "static rtm is started by static crtm when the host of platform",
    "start": "497759",
    "end": "503199"
  },
  {
    "text": "platform starts at power on or restart the important point of sr team is that",
    "start": "503199",
    "end": "509280"
  },
  {
    "text": "it extends measurements or hashes or components to pcrs b4",
    "start": "509280",
    "end": "514800"
  },
  {
    "text": "passing control to them when the host of level starts set power on",
    "start": "514800",
    "end": "519839"
  },
  {
    "text": "restart scrtm measured itself and bio super formal code",
    "start": "519839",
    "end": "526080"
  },
  {
    "text": "after that scrtm extends hashes to pcrs before transferring the controller to bio super",
    "start": "526080",
    "end": "532160"
  },
  {
    "text": "format finally scr cam transfers the controller",
    "start": "532160",
    "end": "538560"
  },
  {
    "text": "biosurface formula bootloader and color also measure and extend the next code",
    "start": "538880",
    "end": "544000"
  },
  {
    "text": "and transfer the contour to them this process is called measured boot these are examples of",
    "start": "544000",
    "end": "551680"
  },
  {
    "text": "uh fiscal values static related static rpm related pcrs are from issue",
    "start": "551680",
    "end": "559279"
  },
  {
    "text": "number 0 to 15. all right let's summarize the things we have to do",
    "start": "559279",
    "end": "564959"
  },
  {
    "text": "as i mentioned before the tpm protects a vmk so firstly we have to",
    "start": "564959",
    "end": "572640"
  },
  {
    "text": "recover pcrs of tpm to unseal the vmk secondly we have to get encrypted vmk",
    "start": "572640",
    "end": "580720"
  },
  {
    "text": "from bitracker thirdly we have to decrypt the encrypted vmk",
    "start": "580720",
    "end": "586560"
  },
  {
    "text": "with the tpm and finally we have to unlock a betrayal blocked",
    "start": "586560",
    "end": "592320"
  },
  {
    "text": "partition with the vmk supporting tpms with one vulnerability",
    "start": "592320",
    "end": "600000"
  },
  {
    "text": "many security researchers have tried to get the vmk with physical bus attacks like these",
    "start": "600000",
    "end": "608640"
  },
  {
    "text": "wow they are amazing right but i could not use this way because",
    "start": "608640",
    "end": "616640"
  },
  {
    "text": "firstly my sorting skill is not as good as these researchers you know",
    "start": "616640",
    "end": "622640"
  },
  {
    "text": "secondly uh the pc was not was my company's property so it means",
    "start": "622640",
    "end": "629040"
  },
  {
    "text": "the pc was not mine and if i failed to fix it i would have another",
    "start": "629040",
    "end": "636079"
  },
  {
    "text": "big problem anyway the physical bus attack was lessener and",
    "start": "636079",
    "end": "642399"
  },
  {
    "text": "replica tpm is a temporary resistant device so it is hard to get data from inside of a",
    "start": "642399",
    "end": "650160"
  },
  {
    "text": "tpm however the voice called low pin count is not secure and temper resistant",
    "start": "650160",
    "end": "656959"
  },
  {
    "text": "researchers believe it pcrs over tpm were well protected according to the",
    "start": "656959",
    "end": "664880"
  },
  {
    "text": "tpm specifications srtmp cells only can be reset by host reset that means power on or",
    "start": "664880",
    "end": "672839"
  },
  {
    "text": "restart we usually trust the specification but the implementation is",
    "start": "672839",
    "end": "681360"
  },
  {
    "text": "unfortunately software development is not easy these days because",
    "start": "682560",
    "end": "688880"
  },
  {
    "text": "there are so many people who support the developer like this",
    "start": "688880",
    "end": "694560"
  },
  {
    "text": "project manager security manager manager manager even cto and ceo heartily",
    "start": "694560",
    "end": "701120"
  },
  {
    "text": "support the developer and due to it the developer has no time to",
    "start": "701120",
    "end": "707040"
  },
  {
    "text": "lead the specification carefully [Music] because of this environment i could find",
    "start": "707040",
    "end": "714160"
  },
  {
    "text": "and publish cbe 2018.6.2",
    "start": "714160",
    "end": "719360"
  },
  {
    "text": "it could reset the tpm when the system entered the f3 serving state of the advanced",
    "start": "719360",
    "end": "725839"
  },
  {
    "text": "configuration and power interface or acpi after exploiting the vulnerability all",
    "start": "725839",
    "end": "731920"
  },
  {
    "text": "pcrs and states were initialized due to the vulnerability i could reset",
    "start": "731920",
    "end": "738399"
  },
  {
    "text": "the tpm without physical access unlike other researchers entering a three sleeping state was",
    "start": "738399",
    "end": "745200"
  },
  {
    "text": "enough to exploit the vulnerability it meant i did not need to worry about",
    "start": "745200",
    "end": "751760"
  },
  {
    "text": "tearing down the pc a recent system supports the acpi",
    "start": "751760",
    "end": "758320"
  },
  {
    "text": "shipping state spi is a specification about configuring hardware components and",
    "start": "758320",
    "end": "764079"
  },
  {
    "text": "performing a power management when the system enters the sleeping state",
    "start": "764079",
    "end": "769360"
  },
  {
    "text": "the system cuts off the power of our devices and the important thing is that",
    "start": "769360",
    "end": "777200"
  },
  {
    "text": "tpm is also powered off in the f3 sleeping state or suspend mode",
    "start": "777200",
    "end": "782560"
  },
  {
    "text": "from this page i just called slim mode for the f3 serving state",
    "start": "782560",
    "end": "789839"
  },
  {
    "text": "this is the slim mode display process of the srtm the important point of this",
    "start": "789839",
    "end": "797440"
  },
  {
    "text": "process is the interaction of the operating system and the spi module",
    "start": "797440",
    "end": "803279"
  },
  {
    "text": "for the the htc process to work correctly the operating system and the hdpi module",
    "start": "803279",
    "end": "809120"
  },
  {
    "text": "have to collaborate with each other in a predefined order",
    "start": "809120",
    "end": "815360"
  },
  {
    "text": "what if the operating system is compromised and does not not by the tpm of slave",
    "start": "815360",
    "end": "821519"
  },
  {
    "text": "this is the srtm vulnerability and i call it the gray area vulnerability cve",
    "start": "821519",
    "end": "828360"
  },
  {
    "text": "2018.6.2 if you want to know the reason of the name please check my previous",
    "start": "828360",
    "end": "834959"
  },
  {
    "text": "works this is the impact of cve 2018-3602",
    "start": "834959",
    "end": "841360"
  },
  {
    "text": "as you see the left one is normal pcrs of the tpm when srtm is enabled and the right one is",
    "start": "841360",
    "end": "849760"
  },
  {
    "text": "pcrs after exploiting the vulnerability or sr10 pcrs are cleared",
    "start": "849760",
    "end": "856560"
  },
  {
    "text": "so i tried to exploit the tpm with the vulnerability and my",
    "start": "856560",
    "end": "863199"
  },
  {
    "text": "effort would be gone because this is the tpm information and",
    "start": "863199",
    "end": "869920"
  },
  {
    "text": "it said intel tpm",
    "start": "869920",
    "end": "874800"
  },
  {
    "text": "as you know intel didn't make the hardware tpm so this means that",
    "start": "876560",
    "end": "884399"
  },
  {
    "text": "yeah something wrong let's go back to the tpm there are two",
    "start": "884399",
    "end": "891440"
  },
  {
    "text": "typical types of tpms uh one is a discrete dpm and the other is",
    "start": "891440",
    "end": "897040"
  },
  {
    "text": "your tpm discrete tpm or dtpm is a hardware hardware based tpm and",
    "start": "897040",
    "end": "903199"
  },
  {
    "text": "connected to nps bus it is secure expensive and widely",
    "start": "903199",
    "end": "908399"
  },
  {
    "text": "deployed in high-end products and it also supports tpm 1.2 and tpm 2.0 specification formula tpm or",
    "start": "908399",
    "end": "917120"
  },
  {
    "text": "ftpm is a 4ml based tpm and resides in a sql processor",
    "start": "917120",
    "end": "922639"
  },
  {
    "text": "it is may be secure cheap and also widely deployed from",
    "start": "922639",
    "end": "930399"
  },
  {
    "text": "entry products to high-end products it usually supports only tpm 2.0",
    "start": "930399",
    "end": "936560"
  },
  {
    "text": "specification to get my data back i tested cve",
    "start": "936560",
    "end": "943240"
  },
  {
    "text": "2018.6.2 and unfortunately intel platform trust technology or ptt",
    "start": "943240",
    "end": "949839"
  },
  {
    "text": "also had the slim mode vulnerability so i reported it to intel in february",
    "start": "949839",
    "end": "956839"
  },
  {
    "text": "2018 and 19 and they assigned intel security advisory",
    "start": "956839",
    "end": "962480"
  },
  {
    "text": "and cve 2020.05 to 6. according to my test result many",
    "start": "962480",
    "end": "969199"
  },
  {
    "text": "manufacturers such such as intel level gigabyte and asus",
    "start": "969199",
    "end": "974240"
  },
  {
    "text": "were vulnerable uh at the time it means tpm related code of biosafety",
    "start": "974240",
    "end": "980160"
  },
  {
    "text": "formula seems to be shared for the dtpm and ftpm",
    "start": "980160",
    "end": "986720"
  },
  {
    "text": "all right i got the real power i could reset the ttpmn ftpm",
    "start": "987279",
    "end": "994000"
  },
  {
    "text": "with one's remote vulnerability let's exploit it corner motor for exploiting the",
    "start": "994000",
    "end": "1000000"
  },
  {
    "text": "vulnerability purchase the tpmp suspend function and the tpm driver",
    "start": "1000000",
    "end": "1005519"
  },
  {
    "text": "the function is invoked by connor during slave and sends tpm2 shutdown state to the",
    "start": "1005519",
    "end": "1012240"
  },
  {
    "text": "tpm for saving current state the corner module changes the function",
    "start": "1012240",
    "end": "1017519"
  },
  {
    "text": "to another function like this yeah it's a very simple quote",
    "start": "1017519",
    "end": "1023519"
  },
  {
    "text": "support microsoft v drugger as i mentioned earlier tpmcs the vmk of",
    "start": "1023519",
    "end": "1031038"
  },
  {
    "text": "bitracker vitrapper uses two pcr profiles if the uefi security is enabled",
    "start": "1031039",
    "end": "1038720"
  },
  {
    "text": "it uses pcr number seven and eleven if uefr squad is uh disabled it uses",
    "start": "1038720",
    "end": "1045678"
  },
  {
    "text": "pcr number zero two four and eleven if you want to know the profile um",
    "start": "1045679",
    "end": "1054320"
  },
  {
    "text": "you can see it with manage bd tool like low this machine uses uh pieces number seven",
    "start": "1054320",
    "end": "1060880"
  },
  {
    "text": "and eleven if then what information is stored in pcr number seven and eleven",
    "start": "1060880",
    "end": "1067760"
  },
  {
    "text": "this is the pcr uses of uefi the tpm specification said security",
    "start": "1067760",
    "end": "1074640"
  },
  {
    "text": "policy information like keys certificates are used by",
    "start": "1074640",
    "end": "1079760"
  },
  {
    "text": "ufi is stored in pcr number seven and operating system defined information",
    "start": "1079760",
    "end": "1086799"
  },
  {
    "text": "is stored efficient number 11. after analysis of bitracker i could i",
    "start": "1086799",
    "end": "1093120"
  },
  {
    "text": "concluded that i needed hashes of norm of the normal system for pc number seven and eleven",
    "start": "1093120",
    "end": "1100720"
  },
  {
    "text": "because as you know i could reset the tpm with my vulnerabilities and it meant",
    "start": "1100720",
    "end": "1108160"
  },
  {
    "text": "i could make pcr number 7 and 11 lower with replaying the lower axis",
    "start": "1108160",
    "end": "1115840"
  },
  {
    "text": "but how i could get them from event logs event loads consists of",
    "start": "1115840",
    "end": "1123120"
  },
  {
    "text": "pcr number seven oh sorry official numbers hashes and event types and event data",
    "start": "1123120",
    "end": "1129600"
  },
  {
    "text": "according to the specification rtm extends hashes to a tpm and saves event logs for",
    "start": "1129600",
    "end": "1137520"
  },
  {
    "text": "each measurement however event logs were gone when the corner",
    "start": "1137520",
    "end": "1143760"
  },
  {
    "text": "started if active services of efi boot service",
    "start": "1143760",
    "end": "1150000"
  },
  {
    "text": "was called if i put from efi formula flushed them",
    "start": "1150000",
    "end": "1155760"
  },
  {
    "text": "in meant i needed a custom voter order",
    "start": "1155760",
    "end": "1162880"
  },
  {
    "text": "frankly say i felt something wrong again at that time and",
    "start": "1162960",
    "end": "1170559"
  },
  {
    "text": "i should have given up and removed bennett or linux operating system i regret that now anyway",
    "start": "1170960",
    "end": "1179760"
  },
  {
    "text": "i made a custom bootloader version one custom footroller version one is uh",
    "start": "1179760",
    "end": "1184799"
  },
  {
    "text": "based on group two of coreboot because it has a wrapper of efi tc2",
    "start": "1184799",
    "end": "1190799"
  },
  {
    "text": "protocol so i didn't need to make the custom boot router from scratch",
    "start": "1190799",
    "end": "1196799"
  },
  {
    "text": "for for event logs i added a new feature that got event logs",
    "start": "1196799",
    "end": "1203120"
  },
  {
    "text": "and saved them into addresses 18 000 the event logos function",
    "start": "1203120",
    "end": "1209679"
  },
  {
    "text": "of the get event logs function returned uh crypto as i look forward like this and",
    "start": "1209679",
    "end": "1215520"
  },
  {
    "text": "it consists of a single header and multiple raw data so i had to parse each entry from the",
    "start": "1215520",
    "end": "1222960"
  },
  {
    "text": "start and to the end and finally i got the event logs this is the boot",
    "start": "1222960",
    "end": "1229520"
  },
  {
    "text": "sequence of custom controller encounter when biased u5 former starts",
    "start": "1229520",
    "end": "1236480"
  },
  {
    "text": "it loads simple trotter because of skill boot and sim boot router is signed by",
    "start": "1236480",
    "end": "1241919"
  },
  {
    "text": "microsoft and linux operating system can boot with it simple throttle loads are my custom",
    "start": "1241919",
    "end": "1248880"
  },
  {
    "text": "controller version one and it executes get event locks function and extracts event logs like this",
    "start": "1248880",
    "end": "1257840"
  },
  {
    "text": "on the left side key cell numbers are shown and on the right side hashes are shown",
    "start": "1257919",
    "end": "1266320"
  },
  {
    "text": "and then custom boot router executes ring scanner and it lost the corner module and user",
    "start": "1266320",
    "end": "1272559"
  },
  {
    "text": "level applications the corner modules event logs and dumps them into a color file",
    "start": "1272559",
    "end": "1280880"
  },
  {
    "text": "lastly replay tool loads event logs from a color file and replay them to the",
    "start": "1280880",
    "end": "1288840"
  },
  {
    "text": "tpm even though i got the hashes",
    "start": "1288840",
    "end": "1294880"
  },
  {
    "text": "i couldn't get my data back yet let's see the boot sequence again for",
    "start": "1294880",
    "end": "1300159"
  },
  {
    "text": "the reason in case of normal windows boot",
    "start": "1300159",
    "end": "1305360"
  },
  {
    "text": "when u5 formula starts it extends key to certificates and the skill would flag",
    "start": "1305360",
    "end": "1310559"
  },
  {
    "text": "to the tpm they are static value and always the same",
    "start": "1310559",
    "end": "1316559"
  },
  {
    "text": "it executes window boot manager put mg.f ngfw.efi",
    "start": "1316640",
    "end": "1322640"
  },
  {
    "text": "and the formula verifies its signature with microsoft windows production pca",
    "start": "1322640",
    "end": "1327919"
  },
  {
    "text": "certificate and extends it to the tpm this is the final value of pcr number",
    "start": "1327919",
    "end": "1334400"
  },
  {
    "text": "seven when the boot manager starts it tries to unseal the sealed vmk",
    "start": "1334400",
    "end": "1340880"
  },
  {
    "text": "of bit rocker with the tpm and guess the vmk from the tpm",
    "start": "1340880",
    "end": "1348400"
  },
  {
    "text": "finally the boot manager can decrypt a bit drug like partition and windows",
    "start": "1348400",
    "end": "1353520"
  },
  {
    "text": "operating system starts successfully in contrast other footrollers like",
    "start": "1353520",
    "end": "1361039"
  },
  {
    "text": "linux footroller and malicious bootloader start the formula extends microsoft",
    "start": "1361039",
    "end": "1367679"
  },
  {
    "text": "corporation uefi ca certificate to the tpm because microsoft signs",
    "start": "1367679",
    "end": "1374400"
  },
  {
    "text": "other boot routers only with the private key of the uefi c8",
    "start": "1374400",
    "end": "1381760"
  },
  {
    "text": "because of it the final value of pixel number 7 yes different from the previous case",
    "start": "1382400",
    "end": "1390400"
  },
  {
    "text": "and so the boot manager start when the boot manager start i tried to",
    "start": "1390400",
    "end": "1396000"
  },
  {
    "text": "unzip the csv mk of the tracker with the tpm and phase like this",
    "start": "1396000",
    "end": "1403840"
  },
  {
    "text": "fortunately getting a hash of microsoft windows production pca is easy because security is uh",
    "start": "1404159",
    "end": "1412799"
  },
  {
    "text": "has been widely deployed and i could get it from other pcs additionally microsoft windows",
    "start": "1412799",
    "end": "1419200"
  },
  {
    "text": "also saves our measurement logs so i could get it from microsoft tpm pcp",
    "start": "1419200",
    "end": "1425279"
  },
  {
    "text": "toolkit this is the result of the pcb took it and",
    "start": "1425279",
    "end": "1432240"
  },
  {
    "text": "this is the hash of windows production pca certificate",
    "start": "1432240",
    "end": "1437279"
  },
  {
    "text": "how do i find it because this is the event log data and",
    "start": "1437279",
    "end": "1444960"
  },
  {
    "text": "this is the text part you can see the text microsoft production pca",
    "start": "1444960",
    "end": "1453600"
  },
  {
    "text": "additionally the expired date is 2026 so i can use this hash for",
    "start": "1453600",
    "end": "1461520"
  },
  {
    "text": "more than six years however i'm not sure because the boot or was",
    "start": "1461520",
    "end": "1468720"
  },
  {
    "text": "found this year all right the last step is unsealing the",
    "start": "1468720",
    "end": "1474960"
  },
  {
    "text": "bmk according to my research unsealing the vmk is",
    "start": "1474960",
    "end": "1480880"
  },
  {
    "text": "not performed in a single tpm command these dpn commands and parameters are",
    "start": "1480880",
    "end": "1486720"
  },
  {
    "text": "needed as i analyzed the bitlocker i found out",
    "start": "1486720",
    "end": "1492000"
  },
  {
    "text": "that all parameters of tpn commands were stacked as you know all parameters start started",
    "start": "1492000",
    "end": "1499919"
  },
  {
    "text": "from the base base index and windows boot manager was the first application after ufi",
    "start": "1499919",
    "end": "1506559"
  },
  {
    "text": "former so if i got the parameters i could",
    "start": "1506559",
    "end": "1513039"
  },
  {
    "text": "use them forever the important thing is that how to get the parameters of each",
    "start": "1513039",
    "end": "1520559"
  },
  {
    "text": "command reverse engineering was good for that however i have no time as you know",
    "start": "1520559",
    "end": "1528880"
  },
  {
    "text": "so i made another custom bootloader version too this time i added hooks to the tpm",
    "start": "1528880",
    "end": "1536000"
  },
  {
    "text": "protocol of uefi format and the bootloader executes windows boot manager with",
    "start": "1536000",
    "end": "1542080"
  },
  {
    "text": "the chain loader feature then the hooks of the tpm protocol dumps",
    "start": "1542080",
    "end": "1547919"
  },
  {
    "text": "all commands and parameters this is the boot and dump sequence",
    "start": "1547919",
    "end": "1556000"
  },
  {
    "text": "the uefi former starts it makes an efi tc protocol service structure like",
    "start": "1556000",
    "end": "1562000"
  },
  {
    "text": "this the custom boot router makes a hooked efi tc protocol service structure",
    "start": "1562000",
    "end": "1569360"
  },
  {
    "text": "and then the custom boot router executes window boot manager and the hook downs or data",
    "start": "1569360",
    "end": "1576880"
  },
  {
    "text": "and parameters like this this is real dumb data of tpm2 rows",
    "start": "1576880",
    "end": "1584640"
  },
  {
    "text": "command this field shows tpm throat command value",
    "start": "1584640",
    "end": "1590000"
  },
  {
    "text": "and this field shows a used handle for ceiling vmk",
    "start": "1590000",
    "end": "1595679"
  },
  {
    "text": "these two fields are important they are public and private data of sealed vmk object the output buffer is below",
    "start": "1595679",
    "end": "1604400"
  },
  {
    "text": "is the response of the tpm command this field shows a success",
    "start": "1604400",
    "end": "1611840"
  },
  {
    "text": "and this field shows the loaded handle of cldbmk the handler is important for tpin2 on",
    "start": "1611840",
    "end": "1619279"
  },
  {
    "text": "sale command this data shows tpm to start",
    "start": "1619279",
    "end": "1624720"
  },
  {
    "text": "our session it is very simple to the previous command this is tpm to",
    "start": "1624720",
    "end": "1630880"
  },
  {
    "text": "start a session command and tpm key and bind handlers for",
    "start": "1630880",
    "end": "1637279"
  },
  {
    "text": "protecting a new session nor handle means just creating a new session handler with",
    "start": "1637279",
    "end": "1643200"
  },
  {
    "text": "unknowns this is a hash of unknowns",
    "start": "1643200",
    "end": "1649760"
  },
  {
    "text": "and the response has us a success code and a new session handler the session handle",
    "start": "1649760",
    "end": "1655679"
  },
  {
    "text": "is important and used for tpm2 on c command",
    "start": "1655679",
    "end": "1661120"
  },
  {
    "text": "this shows tpm2 policy authorize and the tpm to pulse pcr command",
    "start": "1661120",
    "end": "1667360"
  },
  {
    "text": "tpm to policy authorize is very simple it allows a new policy to the session so",
    "start": "1667360",
    "end": "1673600"
  },
  {
    "text": "the parameters are a typical command and the session handle that are created",
    "start": "1673600",
    "end": "1679679"
  },
  {
    "text": "on the previous page the result has a success code",
    "start": "1679679",
    "end": "1685120"
  },
  {
    "text": "tpm2 policy pcr means creating a policy that includes specific",
    "start": "1685120",
    "end": "1691520"
  },
  {
    "text": "pcr values so the parameters are tpm to pilot pcr and the session handler",
    "start": "1691520",
    "end": "1699440"
  },
  {
    "text": "and police digest and the map and the result shows an error code",
    "start": "1699440",
    "end": "1706880"
  },
  {
    "text": "the code is the tpm return code value tpm return called value means the value",
    "start": "1706880",
    "end": "1713120"
  },
  {
    "text": "is not correct and the reason is that pcr number seven and 11 are not matched with the pcr",
    "start": "1713120",
    "end": "1722080"
  },
  {
    "text": "pcr used for sealing the nk for us this is not a big problem because we",
    "start": "1722080",
    "end": "1729279"
  },
  {
    "text": "already have the power that resets and makes the tpm lower so",
    "start": "1729279",
    "end": "1736080"
  },
  {
    "text": "the final result is looks like this this shows deep end to unseal command",
    "start": "1736080",
    "end": "1743600"
  },
  {
    "text": "and these two are the loaded handle of clvmk and session handle",
    "start": "1743600",
    "end": "1750159"
  },
  {
    "text": "and the result is success and this is the vmk",
    "start": "1750159",
    "end": "1757200"
  },
  {
    "text": "whew it was a long journey right yeah",
    "start": "1757200",
    "end": "1763440"
  },
  {
    "text": "and if this was the last page of my journey i couldn't be here as a",
    "start": "1763440",
    "end": "1769279"
  },
  {
    "text": "speaker i tried to find where the public and private data of clvmk were",
    "start": "1769279",
    "end": "1775840"
  },
  {
    "text": "and i also tried to find where the pcr policy and bitmap were this is",
    "start": "1775840",
    "end": "1782240"
  },
  {
    "text": "very very important because if i if i find this information i can extract the",
    "start": "1782240",
    "end": "1789520"
  },
  {
    "text": "vmk from other pcs and the location is the bitracker",
    "start": "1789520",
    "end": "1797520"
  },
  {
    "text": "metadata bitracker saved parameters into the",
    "start": "1797520",
    "end": "1803679"
  },
  {
    "text": "tpm encoded vmk blob of the metadata area and i could get the metadata with the",
    "start": "1803679",
    "end": "1810880"
  },
  {
    "text": "well-known tool dislocker and due to it i could also get the speaker ticket",
    "start": "1810880",
    "end": "1819360"
  },
  {
    "text": "this is the tpm encoded blob of bitracker's metadata",
    "start": "1819520",
    "end": "1826240"
  },
  {
    "text": "this part has public and private data of clvmk for tpm to load command",
    "start": "1826640",
    "end": "1833360"
  },
  {
    "text": "and this part has policy digest and pcrb met for tpm to polish pcr command",
    "start": "1833360",
    "end": "1840080"
  },
  {
    "text": "except for these this data other parameters are static",
    "start": "1840080",
    "end": "1847200"
  },
  {
    "text": "as you know so i can extract the vmk from other pcs",
    "start": "1847200",
    "end": "1854240"
  },
  {
    "text": "finally i got the last piece of the puzzle i reset dd payment ftpm",
    "start": "1854480",
    "end": "1861600"
  },
  {
    "text": "and got no more hashes from uefi former and replayed them to the tpm",
    "start": "1861600",
    "end": "1868159"
  },
  {
    "text": "i also got a tpm encoded vmk blob and sent it to the exploit tpm",
    "start": "1868159",
    "end": "1876000"
  },
  {
    "text": "lastly i extracted the vmk from the exploited tpm and",
    "start": "1876720",
    "end": "1882880"
  },
  {
    "text": "got my data back",
    "start": "1882880",
    "end": "1886880"
  },
  {
    "text": "beatrice design and implementation bitreeker is a new tool to get your data",
    "start": "1888399",
    "end": "1894480"
  },
  {
    "text": "back it can decrypt the betrayal correct partition with the sliding mode vulnerability",
    "start": "1894480",
    "end": "1900480"
  },
  {
    "text": "it consists of several parts i made and customized such as a bitrate bitrate",
    "start": "1900480",
    "end": "1907200"
  },
  {
    "text": "bootloader bit regular corner module between launcher and customized customized dislocker",
    "start": "1907200",
    "end": "1914640"
  },
  {
    "text": "this is bit recurs github url so if you want to get the source code",
    "start": "1914640",
    "end": "1922159"
  },
  {
    "text": "you can get the source code from here",
    "start": "1922159",
    "end": "1927039"
  },
  {
    "text": "you can also make bitrate but bootable usb like me firstly i",
    "start": "1927679",
    "end": "1934799"
  },
  {
    "text": "installed ubuntu 18.4 to the usb drive and then i built and installed my",
    "start": "1934799",
    "end": "1942480"
  },
  {
    "text": "bitrate router because of customized corner module and launcher to a usb",
    "start": "1942480",
    "end": "1948960"
  },
  {
    "text": "drive finally ibl 10 installed customized tpm to tool",
    "start": "1948960",
    "end": "1954080"
  },
  {
    "text": "and customized this locker this page shows the test results i",
    "start": "1954080",
    "end": "1961200"
  },
  {
    "text": "reported ddpm vulnerability in early 2018 and ftpm vulnerability in early",
    "start": "1961200",
    "end": "1970720"
  },
  {
    "text": "2018. now many products seem to be past",
    "start": "1971880",
    "end": "1977760"
  },
  {
    "text": "this vulnerability i really appreciate global companies responses thank you",
    "start": "1977760",
    "end": "1985440"
  },
  {
    "text": "however some products are still vulnerable and many products that warranty previous has",
    "start": "1985440",
    "end": "1991440"
  },
  {
    "text": "been expired are also vulnerable if you use",
    "start": "1991440",
    "end": "1996480"
  },
  {
    "text": "old products i recommend you following the countermeasure of my",
    "start": "1996480",
    "end": "2002840"
  },
  {
    "text": "presentation all right demo time because of the time",
    "start": "2002840",
    "end": "2008720"
  },
  {
    "text": "i prepared a short demo with ricker",
    "start": "2008720",
    "end": "2013120"
  },
  {
    "text": "the system is floating with windows 10. the target system is internal look 8 i7 hbk",
    "start": "2016960",
    "end": "2025200"
  },
  {
    "text": "uefi security is enabled",
    "start": "2025200",
    "end": "2029278"
  },
  {
    "text": "so malicious with router cannot be loaded in this system",
    "start": "2030240",
    "end": "2036080"
  },
  {
    "text": "bitracker is also enabled vitro rocker uses pixel number seven and",
    "start": "2040080",
    "end": "2047679"
  },
  {
    "text": "eleven to protect the vmk",
    "start": "2047679",
    "end": "2051760"
  },
  {
    "text": "the secret is in the vitra collect partition it cannot be read without subverting",
    "start": "2057040",
    "end": "2063679"
  },
  {
    "text": "bitracker's protection mechanism as you",
    "start": "2063679",
    "end": "2067679"
  },
  {
    "text": "know all right let's extract the secret with b tweaker plug the big trigger usb",
    "start": "2072839",
    "end": "2089440"
  },
  {
    "text": "drive in the machine the shim boot router and b trigger controller are loaded chin",
    "start": "2089440",
    "end": "2096800"
  },
  {
    "text": "boot rotor is loaded first to pass the verification of ua by square boot beat",
    "start": "2096800",
    "end": "2102720"
  },
  {
    "text": "record footroller dumps or event logs like this",
    "start": "2102720",
    "end": "2107760"
  },
  {
    "text": "piston numbers and hashes are are used to make the tpm state number",
    "start": "2107760",
    "end": "2117359"
  },
  {
    "text": "bitricker extracts event logs with the canola corner module",
    "start": "2117359",
    "end": "2123280"
  },
  {
    "text": "the bitricker corner module saves them to account low file the bit rigger can detect the bitra",
    "start": "2123599",
    "end": "2130720"
  },
  {
    "text": "blocked partition automatically",
    "start": "2130720",
    "end": "2134640"
  },
  {
    "text": "let's make the system slip to exploit the tpm vulnerability",
    "start": "2137680",
    "end": "2143359"
  },
  {
    "text": "vitriol module exploits the tpm vulnerability after exploiting the dpm is initialized",
    "start": "2143599",
    "end": "2151520"
  },
  {
    "text": "bitry currently replaces hashes to the tpm replaying hashes makes the tpm state",
    "start": "2151520",
    "end": "2157760"
  },
  {
    "text": "number bit record sense typing commands to unseal the vnk",
    "start": "2157760",
    "end": "2163520"
  },
  {
    "text": "vmk is the key that decrypts the petroglyph partition as you see the we got the vmk",
    "start": "2163520",
    "end": "2171520"
  },
  {
    "text": "and decrypted the partition successfully",
    "start": "2171520",
    "end": "2176480"
  },
  {
    "text": "the partition is mounted to windows directory",
    "start": "2176800",
    "end": "2181920"
  },
  {
    "text": "all right let's explore the windows 10 partition with the file manager",
    "start": "2181920",
    "end": "2187839"
  },
  {
    "text": "the descriptive partition is shown in it and finally we got the",
    "start": "2192160",
    "end": "2197280"
  },
  {
    "text": "secret file this is conclusion and black sound bite",
    "start": "2197280",
    "end": "2205040"
  },
  {
    "text": "i found the sleep mode vulnerabilities cve 2018.602 and cpe2020526",
    "start": "2205040",
    "end": "2212880"
  },
  {
    "text": "that can suffer the dtpm and fdpm using the f3 sleeping state b trigger can decrease a betrayal",
    "start": "2212880",
    "end": "2219680"
  },
  {
    "text": "correct partition it extracts the vmk from dpms and mounts",
    "start": "2219680",
    "end": "2225040"
  },
  {
    "text": "the encrypted partition lastly please please update your viruses performance",
    "start": "2225040",
    "end": "2231520"
  },
  {
    "text": "or usb 3 bit rocker with the pin additionally i published tpm",
    "start": "2231520",
    "end": "2237680"
  },
  {
    "text": "vulnerabilities checking tool network last year please check your system with the latest version of",
    "start": "2237680",
    "end": "2243280"
  },
  {
    "text": "method network is in github",
    "start": "2243280",
    "end": "2248240"
  },
  {
    "text": "this is the last page as you know once upon a time there was a secret",
    "start": "2248480",
    "end": "2254480"
  },
  {
    "text": "researcher over there and he overcame adversity and went back",
    "start": "2254480",
    "end": "2259599"
  },
  {
    "text": "to his peaceful life nothing has changed except it become a speaker and",
    "start": "2259599",
    "end": "2267520"
  },
  {
    "text": "libya world member of blacklasia and these are my first link and email",
    "start": "2267520",
    "end": "2275599"
  },
  {
    "text": "address i always welcome your contributions so if you have any idea please let me know",
    "start": "2275599",
    "end": "2282560"
  },
  {
    "text": "thank you for listening and your precious time",
    "start": "2282560",
    "end": "2288320"
  }
]