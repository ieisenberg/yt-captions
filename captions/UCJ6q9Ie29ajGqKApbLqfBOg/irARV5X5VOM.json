[
  {
    "text": "good morning and welcome to black hat and welcome to Badge of Shame",
    "start": "3760",
    "end": "8800"
  },
  {
    "text": "breaking into secure facilities with osdp before we begin we would like to",
    "start": "8800",
    "end": "14240"
  },
  {
    "text": "invite you to join the speaker in the r room in South Seas H as in Hotel following this session for continued",
    "start": "14240",
    "end": "20359"
  },
  {
    "text": "discussions but there will be a Q&A section with three different microphones to your left or immediate right please",
    "start": "20359",
    "end": "27240"
  },
  {
    "text": "feel free to approach them as they indicate the Q&A session is good to go so you may ask your questions during",
    "start": "27240",
    "end": "33360"
  },
  {
    "text": "time and we also thank you for putting your phone on silent mode it is now my",
    "start": "33360",
    "end": "38800"
  },
  {
    "text": "pleasure to Welcome to the stage Dan petro and David [Music]",
    "start": "38800",
    "end": "46440"
  },
  {
    "text": "[Applause] Vargas hey what's up black hat so uh",
    "start": "46440",
    "end": "52480"
  },
  {
    "text": "yeah I'm Dan Petro this is David Vargas we're a pentesters at Bishop Fox I was a",
    "start": "52480",
    "end": "57640"
  },
  {
    "text": "longtime pentester currently I'm a a part of the capability development team a senior software engineer over at",
    "start": "57640",
    "end": "64478"
  },
  {
    "text": "Bishop Fox yeah I'm a senior red teamer I'm on the red team do a lot of fun engagements which is kind of how this",
    "start": "64479",
    "end": "70080"
  },
  {
    "text": "whole thing came to be yeah so um breaking into secure facilities is easily one of the coolest things we get",
    "start": "70080",
    "end": "75400"
  },
  {
    "text": "to do here at pishop Fox and this came about as uh one of the engagements that we ran into we happened to hit an osdp",
    "start": "75400",
    "end": "81159"
  },
  {
    "text": "installation uh during one of our physical pentests and thought like I don't think there's any security",
    "start": "81159",
    "end": "86759"
  },
  {
    "text": "research around this looked into it and uh what we found is going to be contents of this talk so all right so one of the",
    "start": "86759",
    "end": "92399"
  },
  {
    "text": "other first things you should know about me is that I hate slides um and there we",
    "start": "92399",
    "end": "97439"
  },
  {
    "text": "go so we got some uh uh bespoke uh free range slides these slides were allowed",
    "start": "97439",
    "end": "103119"
  },
  {
    "text": "to turn fully around inside of PowerPoint before they were uh released so suppose you're trying to break into a",
    "start": "103119",
    "end": "109079"
  },
  {
    "text": "secure facility uh say some undisclosed location in Santa Fe New Mexico and part",
    "start": "109079",
    "end": "115640"
  },
  {
    "text": "of this uh facility has a badge reader an RFID badge reader if you're in this",
    "start": "115640",
    "end": "121640"
  },
  {
    "text": "audience I assume you know what RFID badge readers are um it's one of these things uh just the little like got a",
    "start": "121640",
    "end": "128879"
  },
  {
    "text": "little red light on it you tag a card to it it lets you into the door um so uh",
    "start": "128879",
    "end": "134599"
  },
  {
    "text": "there's lots of ways of tacking RFID badge systems um some of which we've actually pioneered here at Bishop Fox um",
    "start": "134599",
    "end": "140519"
  },
  {
    "text": "this is the tastic RFID Thief U the my boss Fran Brown made this forever ago",
    "start": "140519",
    "end": "146200"
  },
  {
    "text": "it's like a a long range RFID badge reader so you can like read a badge from somebody like",
    "start": "146200",
    "end": "152519"
  },
  {
    "text": "five six feet away we even de developed this like Nifty little maneuver with it where you like put it into a briefcase",
    "start": "152519",
    "end": "158080"
  },
  {
    "text": "like set it down into the ground and then kind of pick it up and put it onto your shoulder and really what you're doing is scanning someone tow to head as",
    "start": "158080",
    "end": "164480"
  },
  {
    "text": "you're like sitting next to him in a Starbucks um and uh we actually uh got featured in an episode of Mr Robot one",
    "start": "164480",
    "end": "170959"
  },
  {
    "text": "time which is really cool um the prop uh they made for the that's in the show I made so that little guy that's there",
    "start": "170959",
    "end": "177200"
  },
  {
    "text": "like in the show is just like a raspberry pie instead of a plas case it's not a real tastic RFID Thief but I",
    "start": "177200",
    "end": "183159"
  },
  {
    "text": "put it together for the show so that's kind of cool so anyway let's talk a bit about how badge readers really work under the",
    "start": "183159",
    "end": "189080"
  },
  {
    "text": "hood and more uh pointedly behind the reader since that's what we're going to be talking about so there's three pieces",
    "start": "189080",
    "end": "195239"
  },
  {
    "text": "that are important for uh the the door system on the outside of the door there's the door itself a lock and then",
    "start": "195239",
    "end": "201080"
  },
  {
    "text": "the reader so when you present your badge to the reader it basically just sends a",
    "start": "201080",
    "end": "207319"
  },
  {
    "text": "card number it's like 1 2 3 four sometimes these are very low entropy like the the number of bits and these things is quite small um and it just",
    "start": "207319",
    "end": "214519"
  },
  {
    "text": "sends the message to the reader now importantly the reader isn't the thing that lets you into the door it doesn't",
    "start": "214519",
    "end": "219840"
  },
  {
    "text": "do any authentication or authorization there's a backend controller for that that sits inside of the building like",
    "start": "219840",
    "end": "226239"
  },
  {
    "text": "inside of the secure area so when you uh badge into the reader the reader then just kind of",
    "start": "226239",
    "end": "232159"
  },
  {
    "text": "relays that badge number out over to the controller because the controller is the thing that has to know like you know is",
    "start": "232159",
    "end": "237920"
  },
  {
    "text": "this person authorized for this specific door door or not and then the control will say yeah sure they're good and it",
    "start": "237920",
    "end": "243599"
  },
  {
    "text": "illuminates the little green light on the reader and then separately importantly sends a separate W signal",
    "start": "243599",
    "end": "249560"
  },
  {
    "text": "over a different wire to the lock to actually physically like unlock the door that's not over the same wires that",
    "start": "249560",
    "end": "256320"
  },
  {
    "text": "talks to the reader the reader has no ability to let you into the door cool okay so let's talk about what",
    "start": "256320",
    "end": "262280"
  },
  {
    "text": "happens behind the scenes currently everything runs over",
    "start": "262280",
    "end": "267600"
  },
  {
    "text": "something called weekend which is an unencrypted protocol so what does that mean there's a device that's been",
    "start": "267600",
    "end": "273199"
  },
  {
    "text": "invented called the ESP key that you can actually insert between the reader and the controller now whenever a batch",
    "start": "273199",
    "end": "278680"
  },
  {
    "text": "number goes over that wire the ESP key is able to record it and even replay it",
    "start": "278680",
    "end": "284080"
  },
  {
    "text": "to the controller now we can as attackers we can actually clone the card right to gain access to that system or",
    "start": "284080",
    "end": "290120"
  },
  {
    "text": "we can replay the badge number using the sp sp key the security industry took notice of",
    "start": "290120",
    "end": "295600"
  },
  {
    "text": "this and they said okay we need to do something um to to prevent these attacks from happening so they develop osdp",
    "start": "295600",
    "end": "303039"
  },
  {
    "text": "which is the open supervised device protocol which is meant to be",
    "start": "303039",
    "end": "308960"
  },
  {
    "text": "encrypted if it's encrypted we can't see the data we can replay it it doesn't",
    "start": "308960",
    "end": "314720"
  },
  {
    "text": "work some of the benefits bold claim unhackable as of 2020 bold claims all",
    "start": "314720",
    "end": "322039"
  },
  {
    "text": "right so we did a couple of things right uh first off we developed our own attack device uh called melon and so this much",
    "start": "322039",
    "end": "329919"
  },
  {
    "text": "like the es key a man in the metal device that's meant to go between a reader and a",
    "start": "329919",
    "end": "335560"
  },
  {
    "text": "controller we got our hands on an axis a1001 controller and a couple of hid",
    "start": "335560",
    "end": "342520"
  },
  {
    "text": "signal readers which by the way support",
    "start": "342520",
    "end": "346680"
  },
  {
    "text": "osdp all right so before I play this so what's happening here on the right hand",
    "start": "349800",
    "end": "355919"
  },
  {
    "text": "side of the screen we see the controller the reader and and a couple of USB dongles so we can see what's going on on",
    "start": "355919",
    "end": "361560"
  },
  {
    "text": "the computers and on the left hand of the screen we see the communication going back and",
    "start": "361560",
    "end": "368280"
  },
  {
    "text": "forth cool so that's a problem right we actually can see the raw car data now",
    "start": "370199",
    "end": "378240"
  },
  {
    "text": "why is that why is that both the readers and",
    "start": "378240",
    "end": "383560"
  },
  {
    "text": "the controllers support osdp so what happened as it turns out osdp supports",
    "start": "383560",
    "end": "388919"
  },
  {
    "text": "but doesn't actually require encryption osdp SC secure channels an",
    "start": "388919",
    "end": "394720"
  },
  {
    "text": "extension added to osdp which is the encrypted portion of it this means that",
    "start": "394720",
    "end": "400240"
  },
  {
    "text": "a system that supports osdp can choose to either encrypt or not to encrypt the traffic and that's going to be important",
    "start": "400240",
    "end": "406160"
  },
  {
    "text": "a little later on all right so let's back up a little bit and talk more about the protocol and how it works under the hood since a lot of this is going to be",
    "start": "406160",
    "end": "412520"
  },
  {
    "text": "important later on so uh OSP runs on top of rs45 which is a Serial protocol but",
    "start": "412520",
    "end": "418840"
  },
  {
    "text": "not that serial protocol that you're thinking of it's the other serial um and the one of the important bits behind",
    "start": "418840",
    "end": "424440"
  },
  {
    "text": "this that's important is that it's a multi-d drop architecture so which means if you have a controller that is plugged",
    "start": "424440",
    "end": "429879"
  },
  {
    "text": "into a reader and you want to have multiple other readers on the same bus um you can connect them in serial like",
    "start": "429879",
    "end": "436160"
  },
  {
    "text": "this just a BC all in a line um and naturally all messages are broadcast",
    "start": "436160",
    "end": "441840"
  },
  {
    "text": "over that bus so this isn't necessarily a bug but it is going to be important because it means that if reader a wants",
    "start": "441840",
    "end": "448319"
  },
  {
    "text": "to send a message to controller it necessarily also has to send the same message out to all of the other readers",
    "start": "448319",
    "end": "454080"
  },
  {
    "text": "on the same bus because they're all connected on the same wire it's a differential signal line and uh the like",
    "start": "454080",
    "end": "459960"
  },
  {
    "text": "at the application layer all of the readers and controller are sort of instructed to disregard any packets that",
    "start": "459960",
    "end": "466199"
  },
  {
    "text": "are not supposed to be for them but obviously anyone can listen to anything so what that means is that if",
    "start": "466199",
    "end": "472720"
  },
  {
    "text": "we go back to our um top secret facility happen to be guarded by some guy let's call him George uh and and there happens",
    "start": "472720",
    "end": "479759"
  },
  {
    "text": "to be a a side door that is not terribly secret that is like not terribly important to us they might be on the",
    "start": "479759",
    "end": "486280"
  },
  {
    "text": "same bus which means that if we want to get the badges stolen from the the front door we can actually insert a listening",
    "start": "486280",
    "end": "492440"
  },
  {
    "text": "device onto this side door you want to attack that door anyway just because it might be on the same bus as the other",
    "start": "492440",
    "end": "498159"
  },
  {
    "text": "thing and this is not true of wegan which the the old systems that are all pointto point so this is a difference in",
    "start": "498159",
    "end": "503840"
  },
  {
    "text": "the new ostb setup so keep that in mind does an attack her also all message me in ostb are",
    "start": "503840",
    "end": "510759"
  },
  {
    "text": "according to this client server model where the controller is the client and all the readers are the server um so all",
    "start": "510759",
    "end": "516919"
  },
  {
    "text": "messages are initiated from the controller and the readers just respond so if you as a reader or an attacker",
    "start": "516919",
    "end": "523680"
  },
  {
    "text": "pretending to be a reader want to just sort of asynchronously send a message out to a controller you can't do that",
    "start": "523680",
    "end": "529800"
  },
  {
    "text": "it's just like not a thing the message will just be ignored um ideally and then uh you have to like respond to messages",
    "start": "529800",
    "end": "537240"
  },
  {
    "text": "uh that are sent uh from the controller so uh this brings us to uh protocol WTF",
    "start": "537240",
    "end": "544680"
  },
  {
    "text": "number one like to call what do we Pain by the bit now so one of the fundamental things",
    "start": "544680",
    "end": "552279"
  },
  {
    "text": "that a cryptographic protocol has to do is to prevent replay attacks have to prevent an attacker from just taking a",
    "start": "552279",
    "end": "559000"
  },
  {
    "text": "packet encrypt it or not um and packaging it up and replaying it so imagine we have a badge number here",
    "start": "559000",
    "end": "565279"
  },
  {
    "text": "somebody badged in they beep their card against the reader with the badge numbers and inside of a message sent out",
    "start": "565279",
    "end": "572079"
  },
  {
    "text": "encrypted what keeps the attack from just taking that packet and just replaying it along encryption at all so",
    "start": "572079",
    "end": "578880"
  },
  {
    "text": "normally a cryptographic protocol prevents against Replay taxs by having your data and you add a sequence number",
    "start": "578880",
    "end": "584240"
  },
  {
    "text": "onto it that way every message is different and every message is going to be expected to be just like the",
    "start": "584240",
    "end": "589399"
  },
  {
    "text": "monotonically increasing value from the last one or like some other system well that way each like number is different",
    "start": "589399",
    "end": "595480"
  },
  {
    "text": "you can't just take an old message and replay it and then you you take all that stuff you package it up into an hmac um",
    "start": "595480",
    "end": "601640"
  },
  {
    "text": "if you don't know what an hmac is we don't have time to go into it but it's a key hash it basically keeps an attacker from modifying the data that is inside",
    "start": "601640",
    "end": "608360"
  },
  {
    "text": "of the orange area basically that way you can't just modify the sequence number to be the correct",
    "start": "608360",
    "end": "614200"
  },
  {
    "text": "one so OSB does this kind of um but you might be wondering all right so there's",
    "start": "614200",
    "end": "619920"
  },
  {
    "text": "there's a sequence number and that's a number how many bits do we need to make a secure sequence number then we need",
    "start": "619920",
    "end": "626480"
  },
  {
    "text": "like 128 bits like that would be strong that's like cryptographically strong um",
    "start": "626480",
    "end": "631839"
  },
  {
    "text": "maybe 64 bits that's sort of like the the edge of enumeration where like if you try to Brute Force something offline",
    "start": "631839",
    "end": "638360"
  },
  {
    "text": "then 64 bits is kind of the edge of that 32 bits like that's like okay like I",
    "start": "638360",
    "end": "644959"
  },
  {
    "text": "guess maybe how about two bits now now I",
    "start": "644959",
    "end": "650680"
  },
  {
    "text": "know what you're thinking two bits those are rookie numbers we can get that down how about one and a half bits because",
    "start": "650680",
    "end": "658200"
  },
  {
    "text": "osdb has has a sequence number but we actually just skip zero in the two bits so it's only one uh two and three are",
    "start": "658200",
    "end": "665519"
  },
  {
    "text": "like valid sequence numbers um like as the like the series is going along um uh",
    "start": "665519",
    "end": "671560"
  },
  {
    "text": "so this exists but it might as well not for the purposes of security in fact I question whether it does anything for",
    "start": "671560",
    "end": "678079"
  },
  {
    "text": "non-security purposes either but there we are all right so uh let's talk about",
    "start": "678079",
    "end": "683519"
  },
  {
    "text": "this uh uh uh hmac though so instead of having a sequence number the uh protocol",
    "start": "683519",
    "end": "689200"
  },
  {
    "text": "does this like system of IV chaining where the initialization Vector oh by the way um we are using AES in CBC mode",
    "start": "689200",
    "end": "695959"
  },
  {
    "text": "I can hear the like cryptographers in the crowd groaning we don't have time to get into that it's CBC mode don't worry",
    "start": "695959",
    "end": "701959"
  },
  {
    "text": "about it um so the IV of every message is the hmac of the previous message and",
    "start": "701959",
    "end": "707639"
  },
  {
    "text": "so they kind of just like daisy chain down the line like this um and this sort of like like gives a kind of sequence",
    "start": "707639",
    "end": "714399"
  },
  {
    "text": "number where like every packet is going to be different and you have to have the um hmac of the the previous one so it",
    "start": "714399",
    "end": "720120"
  },
  {
    "text": "kind of does the similar job but we're going to come back to that so the hmac though um the bad part about the hmac is",
    "start": "720120",
    "end": "726760"
  },
  {
    "text": "that we take uh the hmac and we just throw most of it away so only the first",
    "start": "726760",
    "end": "732079"
  },
  {
    "text": "32 bits of the hmac are actually maintained and 96 bits of it are just",
    "start": "732079",
    "end": "737240"
  },
  {
    "text": "sort of put into the trash it even says right here in the spec to reduce message time message size and transmission time",
    "start": "737240",
    "end": "744040"
  },
  {
    "text": "overhead only the first four bytes are sent like what like can't just you can't",
    "start": "744040",
    "end": "749760"
  },
  {
    "text": "just like reduce the overhead of packets like this like those were important bits",
    "start": "749760",
    "end": "754800"
  },
  {
    "text": "like like what are you doing put the bits back those were important bits so if we just do some backof the envelope",
    "start": "754800",
    "end": "760959"
  },
  {
    "text": "math based off of like if you wanted to take a packet that has a badge number in it and replay it um and just like",
    "start": "760959",
    "end": "767800"
  },
  {
    "text": "randomly guess on the hmac I mean it's going to take you on average two to the 31 attempts um to do that successfully",
    "start": "767800",
    "end": "774680"
  },
  {
    "text": "and we're running on rs45 which is practice is likely at maximum like 115200 B uh though rs45 does actually",
    "start": "774680",
    "end": "783040"
  },
  {
    "text": "support up to 10 megabits and if you find an installation that's running in 10 megabits then that's going to make these numbers a lot better um but it",
    "start": "783040",
    "end": "789399"
  },
  {
    "text": "it'll have the success on an average of after like 35 days of consecutive attacking and given the actual like",
    "start": "789399",
    "end": "796880"
  },
  {
    "text": "practicality of Performing this attack I think it's unlikely to be very successful um just because it would mean",
    "start": "796880",
    "end": "802320"
  },
  {
    "text": "like you'd have to like insert your device like sit next to it for 35 consecutive days like in a sleeping bag",
    "start": "802320",
    "end": "808519"
  },
  {
    "text": "next to the door um as it's like brute forcing attempts right just sleeping and then at some point during that time",
    "start": "808519",
    "end": "814079"
  },
  {
    "text": "you're going to hear a beep and the door is going to open you make a Mad Dash to the door it's like I don't know about our budget on the red team but like",
    "start": "814079",
    "end": "820560"
  },
  {
    "text": "that's probably not a thing we're going to do here at Bishop Fox um and uh it the only thing keeping this from being",
    "start": "820560",
    "end": "825800"
  },
  {
    "text": "even more practical is just the throughput of the network and if that changes uh then like the math might",
    "start": "825800",
    "end": "831360"
  },
  {
    "text": "actually become much better for us uh and then lastly on this point is that we have a birthday problem uh if",
    "start": "831360",
    "end": "837720"
  },
  {
    "text": "you're not familiar with the birthday problem you should Google it it's actually really fun we don't have time to get into it but basically if you ask",
    "start": "837720",
    "end": "843680"
  },
  {
    "text": "the question what are the chances that any of these IVs any two of these IVs are the same because again they're only",
    "start": "843680",
    "end": "849320"
  },
  {
    "text": "32 bits um it turns out that this actually happens pretty quickly um after about 77,000 packets you're going to get",
    "start": "849320",
    "end": "856120"
  },
  {
    "text": "a collision and then when that happens you're just going to loot back around because it's going to be the haac of the",
    "start": "856120",
    "end": "861399"
  },
  {
    "text": "previous thing and U as long as no new data is being sent uh that you're just going to be in this kind of like um",
    "start": "861399",
    "end": "867720"
  },
  {
    "text": "request uh response Loop since about at a in the ballpark of 100 Hertz the",
    "start": "867720",
    "end": "872800"
  },
  {
    "text": "controller is gonna be pulling the reader for like do you got any badge numbers now no I badge numbers now no",
    "start": "872800",
    "end": "878880"
  },
  {
    "text": "it's just G be the same data back and forth and uh this tends to not be like a really big deal in practice um this",
    "start": "878880",
    "end": "885399"
  },
  {
    "text": "exact Behavior because once somebody actually does badge in then it's going to break you out of this Loop but just",
    "start": "885399",
    "end": "891199"
  },
  {
    "text": "sort of a bad look for cryptographic protocol to be like looping back around and sending literally the same bits over",
    "start": "891199",
    "end": "896720"
  },
  {
    "text": "and over again and reusing IV is the sort of a thing that lots of other protocols have gotten in pretty big",
    "start": "896720",
    "end": "902480"
  },
  {
    "text": "trouble for um so it's kind of a bad look all right let's take a look at how",
    "start": "902480",
    "end": "908040"
  },
  {
    "text": "a downgrade attack works so remember how I mentioned that osdp supports both",
    "start": "908040",
    "end": "913440"
  },
  {
    "text": "encrypted and un encrypted traffic well let's see how we can leverage that on the right hand side we have our",
    "start": "913440",
    "end": "919480"
  },
  {
    "text": "controller and then on the left hand side we have our monitoring device so we",
    "start": "919480",
    "end": "925639"
  },
  {
    "text": "can see everything set up it's great and now we're going to badge",
    "start": "925639",
    "end": "932120"
  },
  {
    "text": "in there we go we badged in everything's encrypted we can't see anything right",
    "start": "932120",
    "end": "938160"
  },
  {
    "text": "card number save well let's see we're gonna run everything again but this time",
    "start": "938160",
    "end": "943480"
  },
  {
    "text": "we're actually going to carry out a downgrade attack everything goes back online we",
    "start": "943480",
    "end": "950720"
  },
  {
    "text": "tried downgrade attack and now when we actually swipe in there's the card numbers",
    "start": "950720",
    "end": "956240"
  },
  {
    "text": "again so what actually happen happened",
    "start": "956240",
    "end": "961000"
  },
  {
    "text": "here cool okay so some background on what we just saw when initially when the",
    "start": "962720",
    "end": "968079"
  },
  {
    "text": "reader boots up there's a handshake between the controller and the reader where the controller asks the reader what are your capabilities and now the",
    "start": "968079",
    "end": "974440"
  },
  {
    "text": "reader can say well this is what I can do some of those parameters are do I",
    "start": "974440",
    "end": "981480"
  },
  {
    "text": "support Biometrics am I talking to a fingerprint scanner does it have keypad data right",
    "start": "981480",
    "end": "986639"
  },
  {
    "text": "can I send some keypad information over what about communication security so this is the interesting one the reader",
    "start": "986639",
    "end": "993319"
  },
  {
    "text": "tells the controller whether or not it actually supports encryption so in practice what does this",
    "start": "993319",
    "end": "998560"
  },
  {
    "text": "mean for us well with our device on The Wire whenever the controller talks to",
    "start": "998560",
    "end": "1003639"
  },
  {
    "text": "the reader asking it for the capability report all we have to do is switch that communication security bit from one to",
    "start": "1003639",
    "end": "1010399"
  },
  {
    "text": "zero the controller says the reader doesn't support encryption and everything is set up un",
    "start": "1010399",
    "end": "1017240"
  },
  {
    "text": "encrypted okay moving on to our WTF number two stop making null",
    "start": "1017319",
    "end": "1024079"
  },
  {
    "text": "ciphers to set up a secure Channel session there is this like super intricate four-step Mutual",
    "start": "1024079",
    "end": "1029520"
  },
  {
    "text": "authentication process between the controller and the reader not going to go into details but it's basically uh",
    "start": "1029520",
    "end": "1035760"
  },
  {
    "text": "they both have to authenticate to each other to make sure that everybody has the same key and they can decou",
    "start": "1035760",
    "end": "1040839"
  },
  {
    "text": "data two of those message types after everything is set up are message types 15 and 16 15 being a command from the",
    "start": "1040839",
    "end": "1049000"
  },
  {
    "text": "controller to the reader and the reply being 16 a command a reply from the reader to the",
    "start": "1049000",
    "end": "1055039"
  },
  {
    "text": "controller let me go back here if you take a look at what the spec says is",
    "start": "1055039",
    "end": "1060480"
  },
  {
    "text": "that these message types are unencrypted and the data attributes are unencrypted there's a Mac applied to it right we",
    "start": "1060480",
    "end": "1066160"
  },
  {
    "text": "can't replay the messages but we can still see everything that's transmitted again this is in a secure Channel",
    "start": "1066160",
    "end": "1072679"
  },
  {
    "text": "session when everything is meant to be great so what it means is is we can see",
    "start": "1072679",
    "end": "1079400"
  },
  {
    "text": "everything on the wire now to be fair the protocol does say that it shouldn't",
    "start": "1079400",
    "end": "1084960"
  },
  {
    "text": "be used to transmit any data but then why exist in the first place now we're going to talk about install mode",
    "start": "1084960",
    "end": "1092240"
  },
  {
    "text": "attack show the",
    "start": "1092240",
    "end": "1095640"
  },
  {
    "text": "example so again um on the right side here where you're going to see is a controller running and then on the left",
    "start": "1097840",
    "end": "1103640"
  },
  {
    "text": "is our reader SL attacker so we're going to um start up uh attack script in",
    "start": "1103640",
    "end": "1109320"
  },
  {
    "text": "install mode attack mode and this time when we boot up the reader we don't just",
    "start": "1109320",
    "end": "1115280"
  },
  {
    "text": "steal a uh badge number we steal the encryption key straight out from underneath the controller so how the",
    "start": "1115280",
    "end": "1120960"
  },
  {
    "text": "heck does that work let's get dig into it so the ostp has a bit of what you",
    "start": "1120960",
    "end": "1128000"
  },
  {
    "text": "might call the SSH security model which is a one-time insecure setup which is like by itself not a terrible thing we",
    "start": "1128000",
    "end": "1135159"
  },
  {
    "text": "use SSH all the time and we don't complain about it or at least not much um and this is fine just so long as your",
    "start": "1135159",
    "end": "1140919"
  },
  {
    "text": "onetime insecure setup really is one time right you can do it one time like",
    "start": "1140919",
    "end": "1146120"
  },
  {
    "text": "in the confines of a like secur setup and then after that you're good to go um",
    "start": "1146120",
    "end": "1152559"
  },
  {
    "text": "and so uh ostp has this like quasi official install mode that is you can",
    "start": "1152559",
    "end": "1158760"
  },
  {
    "text": "put onto both controllers and readers I say quasi official because it's it's there in the spec but like the exact uh",
    "start": "1158760",
    "end": "1165640"
  },
  {
    "text": "semantics of how this should operate aren't fully fleshed out and in practice how controllers operate and how readers",
    "start": "1165640",
    "end": "1171960"
  },
  {
    "text": "operate can vary wildly so the way this works um I'm this is going to be a bit",
    "start": "1171960",
    "end": "1177440"
  },
  {
    "text": "AB abbreviated because the exact messages back and forth are um complicated not important basically when",
    "start": "1177440",
    "end": "1183159"
  },
  {
    "text": "you're both in install mode the reader can just ask hey uh what's the encryption key because I don't have it and then the controller says yeah here",
    "start": "1183159",
    "end": "1189520"
  },
  {
    "text": "it is here's the key um and this is like the way that it's supposed to work this is just more or less how the key",
    "start": "1189520",
    "end": "1195440"
  },
  {
    "text": "exchange happens um in install mode the problem is when this install mode",
    "start": "1195440",
    "end": "1200880"
  },
  {
    "text": "persists if after you've done installing and you're just in normal operation are you in install mode and lots of",
    "start": "1200880",
    "end": "1207600"
  },
  {
    "text": "controllers do this they'll just hang around in install mode until like something changes or like the admin",
    "start": "1207600",
    "end": "1214400"
  },
  {
    "text": "manually clicks out of the like install mode checkbox in the interface which like no one's ever going to do um and so",
    "start": "1214400",
    "end": "1221960"
  },
  {
    "text": "what this does is it lets an attacker just show up on the bus and say hey I'm a new reader can you give me the key and",
    "start": "1221960",
    "end": "1227520"
  },
  {
    "text": "it goes bet your boss and just sends them the key um and uh that's bad so uh",
    "start": "1227520",
    "end": "1233919"
  },
  {
    "text": "the attacker makes it this makes it really easy for an attacker when the controller is in this install",
    "start": "1233919",
    "end": "1239799"
  },
  {
    "text": "mode so backing up a little bit we might be um punching on the protocol a whole",
    "start": "1239799",
    "end": "1246559"
  },
  {
    "text": "bunch but um there's actually a lot of different places where these vulnerabilities could lie depending on",
    "start": "1246559",
    "end": "1252320"
  },
  {
    "text": "your perspective depending on your point of view it could be the protocol right you could say well like why did they",
    "start": "1252320",
    "end": "1257520"
  },
  {
    "text": "even allow you to send un encrypted messages in this protocol that's supposed to be encrypted um you could",
    "start": "1257520",
    "end": "1262640"
  },
  {
    "text": "look at the library instead say well the actual implementation of these things is going to be encoded mostly inside of the",
    "start": "1262640",
    "end": "1269799"
  },
  {
    "text": "libraries and whatever the library does is likely going to be out there in the wild right depending on how you want to",
    "start": "1269799",
    "end": "1275200"
  },
  {
    "text": "look at it these could be configuration options well it's up to the user to not like click that button like they should have unchecked the box like it's the",
    "start": "1275200",
    "end": "1281440"
  },
  {
    "text": "configurations problem it could be a documentation issue we say like the you know the exact semantics of this install",
    "start": "1281440",
    "end": "1287679"
  },
  {
    "text": "mode should have been laid out better maybe it's an implementation problem where it's not the libraries problem but",
    "start": "1287679",
    "end": "1292919"
  },
  {
    "text": "it's like the individual controller whoever wrote the code that's on the controller it's like it's their fault or",
    "start": "1292919",
    "end": "1298200"
  },
  {
    "text": "maybe even as we'll get into a bit later a marketing problem that there's a like a whole bunch of uh operate devices in",
    "start": "1298200",
    "end": "1305600"
  },
  {
    "text": "operation that are ostp supported or that they like use ostp but not actually",
    "start": "1305600",
    "end": "1311159"
  },
  {
    "text": "like verified there's an official like verification process that you can put Hardware through and they'll will",
    "start": "1311159",
    "end": "1316679"
  },
  {
    "text": "recommend and have a bit of it more about later um that way you can be sure that like it's not just somebody putting",
    "start": "1316679",
    "end": "1322080"
  },
  {
    "text": "in like a completely half-ass effort in uh implementation and saying it supports the protocol that's not a legally",
    "start": "1322080",
    "end": "1327840"
  },
  {
    "text": "enforcable like thing you can get in trouble for saying and so what this does is it kind of makes this world where",
    "start": "1327840",
    "end": "1334520"
  },
  {
    "text": "nobody sees any problem as their problem and uh it could always depending on how you want to look at it be somebody",
    "start": "1334520",
    "end": "1340679"
  },
  {
    "text": "else's problem to fix all right let's get into protocol WTF number three now we're going to step it up we're going to",
    "start": "1340679",
    "end": "1346760"
  },
  {
    "text": "start looking at properly established secure chat so we're talking about uh",
    "start": "1346760",
    "end": "1352919"
  },
  {
    "text": "encryption modes or sorry message types 17 and 18 this is what we would expect to see",
    "start": "1352919",
    "end": "1360440"
  },
  {
    "text": "we would expect to see a header plain text find the command bite and that to be",
    "start": "1360440",
    "end": "1365559"
  },
  {
    "text": "encrypted this is what we actually see that is encrypted but not the command bite now some of you may be thinking",
    "start": "1365559",
    "end": "1372279"
  },
  {
    "text": "okay well what does that matter if the DAT is encrypted well the command bite tells us what kind of message message is",
    "start": "1372279",
    "end": "1379120"
  },
  {
    "text": "being transmitted some of the interesting ones that we can keep an eye out for are the osdp raw which contains raw card data",
    "start": "1379120",
    "end": "1386640"
  },
  {
    "text": "the osdp fmt which contains formatted car data keypad",
    "start": "1386640",
    "end": "1392679"
  },
  {
    "text": "self-explanatory bio reader an interesting one biometric data is in that packet or the osdp key set message",
    "start": "1392679",
    "end": "1399799"
  },
  {
    "text": "which we're going to dive into a little bit further on but basically the key set message contains the encryption key",
    "start": "1399799",
    "end": "1405880"
  },
  {
    "text": "being delivered so why is this a problem well so before",
    "start": "1405880",
    "end": "1412679"
  },
  {
    "text": "we get into this part of the demo I will say this is not a protocol specific",
    "start": "1412679",
    "end": "1418840"
  },
  {
    "text": "vulnerability but it is an implementation one that we have seen so again we have our uh reader and",
    "start": "1418840",
    "end": "1425520"
  },
  {
    "text": "attack tool on the left hand side and the command on the right cool we found a weak key and we",
    "start": "1425520",
    "end": "1432440"
  },
  {
    "text": "use that to decrypt that packet and get the actual encryption key",
    "start": "1432440",
    "end": "1439880"
  },
  {
    "text": "okay so what just happened again not protocol specific that has nothing to do with osdp but it's something we've seen in a",
    "start": "1441799",
    "end": "1449400"
  },
  {
    "text": "lot of Open Source libraries that are being used when implementing osdp to step back a little bit this is",
    "start": "1449400",
    "end": "1456320"
  },
  {
    "text": "kind of the hierarchy of the encryption key so there is or there used to be a master key stored at the controller the",
    "start": "1456320",
    "end": "1462679"
  },
  {
    "text": "session base key is derived from that master key and then the actual encryption key used for the messages",
    "start": "1462679",
    "end": "1468000"
  },
  {
    "text": "derived on the session base key the new standard of osdp got rid of the master",
    "start": "1468000",
    "end": "1473480"
  },
  {
    "text": "key and so we just have the session base key and the S encryption key now the protocol now specify they",
    "start": "1473480",
    "end": "1482559"
  },
  {
    "text": "they actually don't say what how we should derive that session base key and so what we've seen online is a lot of",
    "start": "1482559",
    "end": "1489080"
  },
  {
    "text": "this a lot of hardcoded keys that are being used by these libraries to",
    "start": "1489080",
    "end": "1495279"
  },
  {
    "text": "basically encrypt to derive the the key that's then used for the",
    "start": "1495279",
    "end": "1500520"
  },
  {
    "text": "encryption so let's say we capture through our device some car data on The",
    "start": "1500520",
    "end": "1506240"
  },
  {
    "text": "Wire now we're not saying we're going to Brute Force the entire 128bit key space because that's just impossible but what",
    "start": "1506240",
    "end": "1513039"
  },
  {
    "text": "we're going to do is we can try a whole bunch of let's say nulls we can try ascending numbers descending numbers",
    "start": "1513039",
    "end": "1518640"
  },
  {
    "text": "about a thousand keys in total if we actually managed to guess one of the weak keys well now we can decrypt the",
    "start": "1518640",
    "end": "1525120"
  },
  {
    "text": "data all right this is protocol wgf number for encryption is not magic fairy dust which uh very nearly was the title",
    "start": "1525120",
    "end": "1532200"
  },
  {
    "text": "of this entire presentation by the way um so uh might have seen uh this bold",
    "start": "1532200",
    "end": "1538039"
  },
  {
    "text": "marketing claim earlier this also happens to say something that says uh that use 120 bit as encryption which is",
    "start": "1538039",
    "end": "1544399"
  },
  {
    "text": "true give a props for that um the problem however is that we only use AES",
    "start": "1544399",
    "end": "1549520"
  },
  {
    "text": "encryption meaning there's no asymmetric cryptography at all in this entire process so you might be wondering then",
    "start": "1549520",
    "end": "1556440"
  },
  {
    "text": "if we only use symmetric encryption how do we do key exchange right ah well dear",
    "start": "1556440",
    "end": "1562200"
  },
  {
    "text": "listener it's easy you just send the key now this surely that makes cryptographic",
    "start": "1562200",
    "end": "1568960"
  },
  {
    "text": "protocols easy but uh like you can't just send the the key unencrypted right uh we thought of that instead we encrypt",
    "start": "1568960",
    "end": "1576520"
  },
  {
    "text": "that key but now what do we encrypt that key with since we don't have another key",
    "start": "1576520",
    "end": "1581559"
  },
  {
    "text": "like we're just sending the key what what do we encrypt that key with well we encrypt it with the SCB KD the sbk D of",
    "start": "1581559",
    "end": "1587799"
  },
  {
    "text": "course is the um secure channel base key default um default meaning that's it",
    "start": "1587799",
    "end": "1594559"
  },
  {
    "text": "that's the key right there it's just literally the asy bites for like zero to F like that's it like that's not how",
    "start": "1594559",
    "end": "1602679"
  },
  {
    "text": "encryption works like you can't just like have like a public key encrypt and say well it's encrypted boss like I get",
    "start": "1602679",
    "end": "1610200"
  },
  {
    "text": "this the impression like somebody presented this to their boss and said like you know like you can't do that",
    "start": "1610200",
    "end": "1616120"
  },
  {
    "text": "like it's it's un encrypted they you have to have it encrypted we have to check the box that says everything is encrypted like well all right I got an",
    "start": "1616120",
    "end": "1624440"
  },
  {
    "text": "idea so this brings us to key set capture so again we're",
    "start": "1624840",
    "end": "1631919"
  },
  {
    "text": "attacking and we manage to capture the encryption key but how do we do it this",
    "start": "1631919",
    "end": "1638919"
  },
  {
    "text": "time so let's assume that everything is fine right a lot of what we've talked",
    "start": "1638919",
    "end": "1644600"
  },
  {
    "text": "about so far can be attributed to misconfigurations can be attrib to the device not being set up properly you",
    "start": "1644600",
    "end": "1649720"
  },
  {
    "text": "know hardcoded keys so there's an argument that can be made about what if best practices are followed well one of",
    "start": "1649720",
    "end": "1656440"
  },
  {
    "text": "best practices were followed a lot of us would be out of a job so this is how the attack would work",
    "start": "1656440",
    "end": "1662519"
  },
  {
    "text": "step number one insert the listening device step number two break the reader now how you do this it's up to you",
    "start": "1662519",
    "end": "1669840"
  },
  {
    "text": "there's the sneaky way of doing it um some readers you can actually misconfigure or figure with an NFC app",
    "start": "1669840",
    "end": "1677039"
  },
  {
    "text": "on your phone you just go up to it tap it you can mess with it or you can also rip it out of the wall whatever you do",
    "start": "1677039",
    "end": "1683440"
  },
  {
    "text": "we need to break that reader three we need to wait for it to come replace that reader and four we",
    "start": "1683440",
    "end": "1690799"
  },
  {
    "text": "capture the key set command which if you remember is encrypted with the session based default",
    "start": "1690799",
    "end": "1696480"
  },
  {
    "text": "key so in practice what is what happens all right so let's remember that all",
    "start": "1696480",
    "end": "1701600"
  },
  {
    "text": "this osdp runs an rs485 right so there can be multiple controllers on a bus so",
    "start": "1701600",
    "end": "1708000"
  },
  {
    "text": "let's say you get to your top secret facility you want to get in the front door there's security guards there's cameras there's all sorts of Protections",
    "start": "1708000",
    "end": "1714600"
  },
  {
    "text": "in place but there is a back door and the back door doesn't have the same security you show up everything's",
    "start": "1714600",
    "end": "1720480"
  },
  {
    "text": "encrypted right everything's great you still insert the device right you go to the side door take the reader out put",
    "start": "1720480",
    "end": "1726240"
  },
  {
    "text": "the device inside now you break that reader you break the reader you're interested in accessing so the front",
    "start": "1726240",
    "end": "1733159"
  },
  {
    "text": "door that's going to make somebody say what's happening let's replace this reader it's no longer working now at",
    "start": "1733159",
    "end": "1739600"
  },
  {
    "text": "that point remember we have our device on the bus in another part of the building there's no way of knowing where",
    "start": "1739600",
    "end": "1745440"
  },
  {
    "text": "that device is if it's on the same bus once the handshake happens that delivers",
    "start": "1745440",
    "end": "1751559"
  },
  {
    "text": "that osdp key set message encrypted with the default key that we now have well we can actually then",
    "start": "1751559",
    "end": "1759159"
  },
  {
    "text": "intercept the session base key and now we have access to that reader while everything else looks like it's",
    "start": "1759159",
    "end": "1765720"
  },
  {
    "text": "fine cool so all right what can I do couple of",
    "start": "1765720",
    "end": "1771559"
  },
  {
    "text": "things first check your configuration use encryption remember just because it supports osdp does not mean that it",
    "start": "1771559",
    "end": "1779200"
  },
  {
    "text": "actually uses encryption so you need to make sure you're using secure Channel require encryption so only Force",
    "start": "1779200",
    "end": "1785880"
  },
  {
    "text": "communication to use encryption there are some devices that will allow you to specify this",
    "start": "1785880",
    "end": "1791000"
  },
  {
    "text": "setting disable install mode this is something we actually saw",
    "start": "1791000",
    "end": "1796320"
  },
  {
    "text": "in practice so we actually went to some sites and install mode was enabled in both the controller and the reader",
    "start": "1796320",
    "end": "1802279"
  },
  {
    "text": "because it's just simple to troubleshoot that way when it is so make sure you disable that so this is a recommendation",
    "start": "1802279",
    "end": "1809080"
  },
  {
    "text": "that uh is strong but I know none of you are going to do so this is to um never configure a reader in production that",
    "start": "1809080",
    "end": "1815880"
  },
  {
    "text": "basically um you can kind of invent your own uh uh outof band key exchange",
    "start": "1815880",
    "end": "1821399"
  },
  {
    "text": "mechanism by uh never doing that key exchange over the production wiring which means you have to take the reader",
    "start": "1821399",
    "end": "1827480"
  },
  {
    "text": "unscrew it from the wall walk it with your feet over to the controller which could be on the other side of the",
    "start": "1827480",
    "end": "1833399"
  },
  {
    "text": "building right hook it up to the controller with like a small two foot wire that you are reasonably sure has no",
    "start": "1833399",
    "end": "1839640"
  },
  {
    "text": "listening device on it do the configuration there take it out of install mode walk it back to the wall",
    "start": "1839640",
    "end": "1845960"
  },
  {
    "text": "with your feet and then put it back onto the wall right that way you never ever do the key exchange the installation",
    "start": "1845960",
    "end": "1853080"
  },
  {
    "text": "over the actual wires in the building um that way you're sure that when you do this initial key exchange that nobody is",
    "start": "1853080",
    "end": "1859480"
  },
  {
    "text": "listening um you have to do this every time a reader has any kind of a hiccup or a problem and it's going to be",
    "start": "1859480",
    "end": "1864840"
  },
  {
    "text": "massive and a headache and no one's going to do it but if you wanted to be super paranoid one could in theory do",
    "start": "1864840",
    "end": "1870600"
  },
  {
    "text": "this um also to never ignore tamper alerts so one of the things that's very likely to happen when performing this",
    "start": "1870600",
    "end": "1876919"
  },
  {
    "text": "attack in practice like with a real red team or a real attacker is that you're going to unscrew the reader and that",
    "start": "1876919",
    "end": "1882840"
  },
  {
    "text": "modern uh readers have a little tamper alarm button on them it's literally just a button that's on the back side of the",
    "start": "1882840",
    "end": "1888600"
  },
  {
    "text": "reader becomes unpressed when you like take it off from the wall and it sends a message really quick out over the wires",
    "start": "1888600",
    "end": "1894679"
  },
  {
    "text": "there's ways of getting around this but like in practice I think a lot of people are going to hit the tamper alarm um",
    "start": "1894679",
    "end": "1900360"
  },
  {
    "text": "certainly bypassing tamper alarms are beyond the scope of what we're trying to talk about here but don't ignore these alarms If this just goes into a log file",
    "start": "1900360",
    "end": "1907039"
  },
  {
    "text": "somewhere that somebody notices many months down the road that's useless like have these things set to some sort of",
    "start": "1907039",
    "end": "1913279"
  },
  {
    "text": "alarm that maybe triggers some other physical security stuff like a camera like who",
    "start": "1913279",
    "end": "1918440"
  },
  {
    "text": "knowes um also by OSB verified devices there's actually an entire like test",
    "start": "1918440",
    "end": "1923799"
  },
  {
    "text": "bench thing that the people who run the protocol s Sia um do that uh they can",
    "start": "1923799",
    "end": "1930360"
  },
  {
    "text": "verify devices it's not going to like make sure that there's no vulnerabilities in or whatever but at least it verifies that it's using the",
    "start": "1930360",
    "end": "1936399"
  },
  {
    "text": "entire protocol like the encryption bits we literally bought this uh uh Hardware that is now sitting on the floor because",
    "start": "1936399",
    "end": "1942679"
  },
  {
    "text": "we thought that it would support osdp and it did technically but didn't do the important parts like encryption so you",
    "start": "1942679",
    "end": "1948480"
  },
  {
    "text": "know I'd hate for you to be sitting in the audience thinking like oh I'm totally secure I'm using OSP and then turns out it's like not even encrypted",
    "start": "1948480",
    "end": "1954799"
  },
  {
    "text": "at home so yeah um one of the major takeaways though is to never trust it's",
    "start": "1954799",
    "end": "1960080"
  },
  {
    "text": "encrypted there's actually a lot of things that can go wrong in a cryptographic protocol and just because you're using as 128 doesn't basically",
    "start": "1960080",
    "end": "1966760"
  },
  {
    "text": "mean anything and that's about it thanks a lot we're going to uh do a Q&A now um so",
    "start": "1966760",
    "end": "1973200"
  },
  {
    "text": "if you have any questions uh feel free to uh stand up to one of the microphones",
    "start": "1973200",
    "end": "1978720"
  },
  {
    "text": "um thank you uh if you don't want to stand up to one of the microphones just make sure to",
    "start": "1978720",
    "end": "1984279"
  },
  {
    "text": "shout really loud I don't know how about you over here hi uh just a quick question about",
    "start": "1984279",
    "end": "1993960"
  },
  {
    "text": "um you cover everything from The Wire perspective and how to protect that side",
    "start": "1993960",
    "end": "1999720"
  },
  {
    "text": "but how about when people buy those flipper devices that can run Pyon",
    "start": "1999720",
    "end": "2004960"
  },
  {
    "text": "scripts and and simulate multi or Brute Force like multiple times the number of bads and how how how can you",
    "start": "2004960",
    "end": "2012799"
  },
  {
    "text": "prevent that that perspective as well yeah so I think that's that's more like attacking like you're talking about one",
    "start": "2012799",
    "end": "2019440"
  },
  {
    "text": "of those devices that like um tries to bruteforce the badge numbers to the reader yeah yeah so this doesn't really",
    "start": "2019440",
    "end": "2026399"
  },
  {
    "text": "uh that's sort of like using osdp on I don't know some feedback uh the our",
    "start": "2026399",
    "end": "2032240"
  },
  {
    "text": "research doesn't really affect that at all I guess um that's there are some devices like some readers that try to",
    "start": "2032240",
    "end": "2037480"
  },
  {
    "text": "prevent that Brute Force mechanism basically to say like only let somebody badge in once per 5 seconds or something",
    "start": "2037480",
    "end": "2043679"
  },
  {
    "text": "like that um the like in order to if you're at the point where you can talk",
    "start": "2043679",
    "end": "2048839"
  },
  {
    "text": "over the osdb protocol behind the scenes then you could just replay a badge like there's no point like doing that same",
    "start": "2048839",
    "end": "2054679"
  },
  {
    "text": "attack um from the wiring perspective is kind of irrelevant all right thank you we're here yeah so um one of the",
    "start": "2054679",
    "end": "2063200"
  },
  {
    "text": "thing the attacks was forcing one of those devices offline or Break It is there any capability of the device",
    "start": "2063200",
    "end": "2069960"
  },
  {
    "text": "interfer interfering with that broadcast communication to make a device look like it failed so you don't have to destroy",
    "start": "2069960",
    "end": "2076158"
  },
  {
    "text": "that device so there are a couple of ways um you can spam the bus and you can",
    "start": "2076159",
    "end": "2082240"
  },
  {
    "text": "spam the device so uh there is a busy signal I believe that you can send we",
    "start": "2082240",
    "end": "2087280"
  },
  {
    "text": "haven't messed around with it um but there are ways to uh yeah get break that",
    "start": "2087280",
    "end": "2092520"
  },
  {
    "text": "reader actually on The Wire yeah yeah basically any way you can take the reader offline is fine if it doesn't",
    "start": "2092520",
    "end": "2098960"
  },
  {
    "text": "have to like you know break it like if you if you manage to like factory reset it that works just basically something",
    "start": "2098960",
    "end": "2104520"
  },
  {
    "text": "that makes the it come back and like reset up the the reader in the middle",
    "start": "2104520",
    "end": "2110960"
  },
  {
    "text": "hey thank thanks for the to this is great um you mentioned at the end here you were like oh you need to have access",
    "start": "2110960",
    "end": "2116599"
  },
  {
    "text": "to the readers but surely you just need access to the wire yeah like why why the reader specifically and then my other",
    "start": "2116599",
    "end": "2123760"
  },
  {
    "text": "question was uh that for the downgrade attack one of the readers will say like hey I don't do encryption or I do you",
    "start": "2123760",
    "end": "2129599"
  },
  {
    "text": "know a vulnerable version of encryption what is the is the traffic to that reader then um does it like impact any",
    "start": "2129599",
    "end": "2135640"
  },
  {
    "text": "of the other readers does it downgrade other readers or only that specific one yeah so I'll answering in reverse order",
    "start": "2135640",
    "end": "2143160"
  },
  {
    "text": "the uh for the downgrade attack it it might be implementation specific so comes with an the a the answer comes",
    "start": "2143160",
    "end": "2149359"
  },
  {
    "text": "with an asterisk that says who knows it's up to the vendor to decide those kinds of behaviors but um at least from",
    "start": "2149359",
    "end": "2155839"
  },
  {
    "text": "what I've seen it's uh like per reader controller pair so like one reader might",
    "start": "2155839",
    "end": "2161480"
  },
  {
    "text": "be encrypted and one might not be and they're all just sent over the same bus as long as they're on the same physical bus um it the controllers are perfectly",
    "start": "2161480",
    "end": "2168000"
  },
  {
    "text": "happy in a scenario like that as long as they're not like you know they don't care about being encrypted and as for um",
    "start": "2168000",
    "end": "2175319"
  },
  {
    "text": "accessing the wires that is true that um in theory you don't really need access to a reader you just need access to the wires though in like in practice uh the",
    "start": "2175319",
    "end": "2182960"
  },
  {
    "text": "wires are not likely to just like laying on the ground on the outside of the building there usually like behind the wall and the easiest way to get access",
    "start": "2182960",
    "end": "2189599"
  },
  {
    "text": "to them is to like find a reader unscrew it like unhinge it a little bit and then access the the wires right there um but",
    "start": "2189599",
    "end": "2197119"
  },
  {
    "text": "yeah if you happen to find the wires just like hanging around a building or whatever if that's how they installed it then knock yourself out you can just go",
    "start": "2197119",
    "end": "2202960"
  },
  {
    "text": "right there thank you over here uh is there any easy well",
    "start": "2202960",
    "end": "2209560"
  },
  {
    "text": "not easy but is there a way to detect a listening to device that are on the wire can you go after the controller for a",
    "start": "2209560",
    "end": "2215280"
  },
  {
    "text": "specific set of devices that are authorized and you know any way to detect it if there's we're in a",
    "start": "2215280",
    "end": "2221800"
  },
  {
    "text": "geographically dispersed setup with ours so easier to probably find some of the",
    "start": "2221800",
    "end": "2227839"
  },
  {
    "text": "less travel or less busy places but they could stick something any way to do that",
    "start": "2227839",
    "end": "2234800"
  },
  {
    "text": "I'm not aware of any off any signatures or no nothing like that yeah basically",
    "start": "2234800",
    "end": "2240720"
  },
  {
    "text": "the only authentication that happens if you even want to call it that is the key exchange mechanism okay basically it's",
    "start": "2240720",
    "end": "2247359"
  },
  {
    "text": "the controller that authentic authenticates to the reader in a in a sense by sending a key but nobody really",
    "start": "2247359",
    "end": "2252560"
  },
  {
    "text": "knows who they're talking to they just get a key and then they start talking um like there's not any authentication",
    "start": "2252560",
    "end": "2258200"
  },
  {
    "text": "certainly not mutual authentication like there's no certificates or anything like that involved so physically finding it",
    "start": "2258200",
    "end": "2264000"
  },
  {
    "text": "is probably the the only yeah physically finding it and physically finding a listening device is just going to be on",
    "start": "2264000",
    "end": "2269280"
  },
  {
    "text": "a large like attack surface a large building is just going to be intractable right because you can take that listing",
    "start": "2269280",
    "end": "2275240"
  },
  {
    "text": "device it's going to be tiny like our thing is like an inch by one inch right and you're going to hide that way behind",
    "start": "2275240",
    "end": "2281079"
  },
  {
    "text": "the dot like you're going to put like many feet of wire behind the door so you're gon have to like go to every door",
    "start": "2281079",
    "end": "2286880"
  },
  {
    "text": "and like pull out the wires and then like inspect it and look at like is that a listening device like and it could be",
    "start": "2286880",
    "end": "2292920"
  },
  {
    "text": "anywhere in the building too because you're GNA have these things set up in multi drop probably it's a complete nightmare I think that you're better off",
    "start": "2292920",
    "end": "2299640"
  },
  {
    "text": "in a scenario where you just assume that the cabling is unsafe because that's the",
    "start": "2299640",
    "end": "2304839"
  },
  {
    "text": "whole point of OSP right is like you're assuming there's an attack there if you assume there's no attack on The Wire",
    "start": "2304839",
    "end": "2310200"
  },
  {
    "text": "then just use we it's fine like there's no attack like okay thank you",
    "start": "2310200",
    "end": "2317640"
  },
  {
    "text": "sure I can hardly see in the middle hey how you doing I'm just curious would multiactor negate that vulnerability for",
    "start": "2317640",
    "end": "2323920"
  },
  {
    "text": "example if I have to swipe in but I also have to put in a pin um if the device is",
    "start": "2323920",
    "end": "2330040"
  },
  {
    "text": "compromised is the attacker just getting my pin now or is that separate channels and it it kind of negates the encryption",
    "start": "2330040",
    "end": "2336119"
  },
  {
    "text": "issue so as as far as we can tell um the keypad data is part of what we would see",
    "start": "2336119",
    "end": "2342240"
  },
  {
    "text": "as well right because it is uh it's just a command that goes or a reply from the reader that goes back to the command",
    "start": "2342240",
    "end": "2348160"
  },
  {
    "text": "with with that keypad data so anything that's traveling via osdp through that",
    "start": "2348160",
    "end": "2353480"
  },
  {
    "text": "wire if we have the decryption keys for the SCB if we have the session base key via you know key set command or install mode or whatever it is we'd be able to",
    "start": "2353480",
    "end": "2359760"
  },
  {
    "text": "get that in as well okay so so that could potentially be worse than meaning I'm getting users pins as well in to the",
    "start": "2359760",
    "end": "2365800"
  },
  {
    "text": "key yeah but it comes with an asterisk that exactly how that's implemented might be vendor specific and if there's",
    "start": "2365800",
    "end": "2372000"
  },
  {
    "text": "some weird proprietary extension thing who knows how that works sometimes those like extra features in a keypad or",
    "start": "2372000",
    "end": "2377920"
  },
  {
    "text": "whatever that work that way but at least out of the box like keypad data is also part of the OSD spec so you would also",
    "start": "2377920",
    "end": "2383880"
  },
  {
    "text": "just capture that got thank you yeah uh I think we're actually out of time so we'd happy to take additional questions",
    "start": "2383880",
    "end": "2390480"
  },
  {
    "text": "down in a overflow room so just follow the throng of people if you want to do that so hey thanks a lot thanks for",
    "start": "2390480",
    "end": "2396240"
  },
  {
    "text": "having than do",
    "start": "2396240",
    "end": "2404040"
  }
]