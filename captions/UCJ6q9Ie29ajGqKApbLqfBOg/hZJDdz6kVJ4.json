[
  {
    "text": "so this will be bringing software defined radio to the penetration testing Community let's give our presenters a",
    "start": "240",
    "end": "5520"
  },
  {
    "text": "small hand of Applause thank",
    "start": "5520",
    "end": "8600"
  },
  {
    "text": "you thank you so my name is John Michelle here is Hano uh will present",
    "start": "12599",
    "end": "18720"
  },
  {
    "text": "you a tool that uh we have been we have been developing for for quite a while uh",
    "start": "18720",
    "end": "24640"
  },
  {
    "text": "to help pesters to assess radio frequency communicative",
    "start": "24640",
    "end": "32439"
  },
  {
    "text": "equipments so the first constatation we made was that more and more connected",
    "start": "32440",
    "end": "38200"
  },
  {
    "text": "objects are coming to the market the status from Cisco is and as you can see it grows pretty",
    "start": "38200",
    "end": "44840"
  },
  {
    "text": "fast uh second thing and that was the main um the main topic that led us to to",
    "start": "44840",
    "end": "51559"
  },
  {
    "text": "develop that uh is regarding Smart Meters the startat is from the US Energy Information",
    "start": "51559",
    "end": "58199"
  },
  {
    "text": "Administration uh the main risk with those devices is that the devices will",
    "start": "58199",
    "end": "64198"
  },
  {
    "text": "be at your home so you do have physical access to the device plus it's provided",
    "start": "64199",
    "end": "69680"
  },
  {
    "text": "for free the Energy company is just giving you a device uh and fraud is not the main",
    "start": "69680",
    "end": "76200"
  },
  {
    "text": "issue with that uh that's not what the the Energy company uh is",
    "start": "76200",
    "end": "81600"
  },
  {
    "text": "fearing what we fear is to is you to be able to compromise the firmware of those",
    "start": "81600",
    "end": "89320"
  },
  {
    "text": "uh those metes and being able for example to shut down a whole neighborhood because they will produce",
    "start": "89320",
    "end": "96439"
  },
  {
    "text": "energy and it cannot be stored so the energy has to go somewhere so if you shut down you're just raising up the the",
    "start": "96439",
    "end": "103119"
  },
  {
    "text": "gap between what's produced and what's has been consumed uh moreover after we started",
    "start": "103119",
    "end": "110600"
  },
  {
    "text": "the our development uh we saw draft from The Nest stating that basically there",
    "start": "110600",
    "end": "116479"
  },
  {
    "text": "was a tool that was missing using a software defined r video from HS research uh to do the RF analysis and",
    "start": "116479",
    "end": "124960"
  },
  {
    "text": "that was exactly what we were developing so we decided to read the tool and that's why we we are",
    "start": "124960",
    "end": "131239"
  },
  {
    "text": "here so what are the challenges challenges with the radio frequencies",
    "start": "131239",
    "end": "136480"
  },
  {
    "text": "that you have to face up multiple radio protocols um for example Smart Meters",
    "start": "136480",
    "end": "141640"
  },
  {
    "text": "you can have Smart Meters communicating with zigby but you can also have heart-",
    "start": "141640",
    "end": "148640"
  },
  {
    "text": "S your name uh you also have to deal with multiple bands of frequencies most of the time",
    "start": "148640",
    "end": "156640"
  },
  {
    "text": "you will face the ism band but still it goes from 453 MHz up to 2.4 GHz so it's still too",
    "start": "156640",
    "end": "165519"
  },
  {
    "text": "wide to be able to deal with that with only one transceiver and in addition to that even",
    "start": "165519",
    "end": "172599"
  },
  {
    "text": "though for example WM bus can can be can transmit on the ism band it also have a",
    "start": "172599",
    "end": "180080"
  },
  {
    "text": "proprietary frequency to transmit on you also have multiple",
    "start": "180080",
    "end": "186159"
  },
  {
    "text": "modulations FSK psk as you name it so it's pretty hard to deal with uh with a",
    "start": "186159",
    "end": "192959"
  },
  {
    "text": "transer that has been alwi and you also have multiple bit",
    "start": "192959",
    "end": "198239"
  },
  {
    "text": "rates all those things make make somehow difficult to to deal with radio",
    "start": "198239",
    "end": "203519"
  },
  {
    "text": "frequency in a in a common way like we can do on traditional pen testing with ethernet",
    "start": "203519",
    "end": "211360"
  },
  {
    "text": "uh and you also have multiple applicated layer that's for example for the uh for the 15.4 protocol uh on which Z zigby is",
    "start": "211519",
    "end": "221120"
  },
  {
    "text": "based uh this protocol just gives you the the the lower",
    "start": "221120",
    "end": "227000"
  },
  {
    "text": "layers but you you can Define your applicative layer on top of that and zigby is one of",
    "start": "227000",
    "end": "234920"
  },
  {
    "text": "that um the existing tools to deal with radio frequency so far",
    "start": "235000",
    "end": "240319"
  },
  {
    "text": "that are quite close to what we're are doing you have the O too from Michael Osman but is dedicated to Bluetooth and",
    "start": "240319",
    "end": "247120"
  },
  {
    "text": "Bluetooth low energy so you're you're somehow limitated with that you also",
    "start": "247120",
    "end": "254200"
  },
  {
    "text": "have the RF cat from by atlas of Doom and this one is maybe the closest to",
    "start": "254200",
    "end": "259280"
  },
  {
    "text": "what we we are trying to a to achieve but it's only compatible with a subset of CH chipcon based jungles so it's just",
    "start": "259280",
    "end": "267720"
  },
  {
    "text": "a a transceiver uh which is made to deal with ISM band and you flash another",
    "start": "267720",
    "end": "273919"
  },
  {
    "text": "firmware on it and then you able to deal with sub gahz ASM band and just",
    "start": "273919",
    "end": "279080"
  },
  {
    "text": "configure it with a python intera interactive shell 2.4 GHz I think at lastas is",
    "start": "279080",
    "end": "286160"
  },
  {
    "text": "trying to develop it but I don't know I don't think it's released yet and he still figuring out uh which dongle it",
    "start": "286160",
    "end": "293199"
  },
  {
    "text": "will use and again it just grabs you row packet you set a frequency you set a bit",
    "start": "293199",
    "end": "299360"
  },
  {
    "text": "rate you set the modulation the packet land and then you just have row packets",
    "start": "299360",
    "end": "304759"
  },
  {
    "text": "you don't have the the understanding of upper layers and for zigby you have the OTE",
    "start": "304759",
    "end": "312520"
  },
  {
    "text": "for example that is that has been developed by R Spears from rival Loop",
    "start": "312520",
    "end": "318000"
  },
  {
    "text": "security fortunately uh right now Compu computers are going more and more",
    "start": "318000",
    "end": "324080"
  },
  {
    "text": "efficient so we can move from what has been done in Hardware moving it to your",
    "start": "324080",
    "end": "330400"
  },
  {
    "text": "CPU instead and that's why we are dealing with software defend radio it is",
    "start": "330400",
    "end": "337319"
  },
  {
    "text": "basically a configurable local oscillator no hard wire processing is done you just just have a local",
    "start": "337319",
    "end": "343560"
  },
  {
    "text": "oscillator pre amplificator filters and an ADC an analogic to digital converter",
    "start": "343560",
    "end": "350720"
  },
  {
    "text": "it will just stream some row digital samples to your computer and then your",
    "start": "350720",
    "end": "355919"
  },
  {
    "text": "CPU your CPU will do the rest it comes from 20 bucks up to 10,000",
    "start": "355919",
    "end": "364199"
  },
  {
    "text": "bucks maybe more uh the compromise we found between the size of the appliance the",
    "start": "364199",
    "end": "370680"
  },
  {
    "text": "performance and the price is that you can just grab uh a you a software",
    "start": "370680",
    "end": "376919"
  },
  {
    "text": "defined radio card from 300 bucks to 1,000 and you and you'll be",
    "start": "376919",
    "end": "382240"
  },
  {
    "text": "fine and it became very popular uh and affordable since RL SDR those are the",
    "start": "382240",
    "end": "387880"
  },
  {
    "text": "one for 20 bucks it's just a USB t uh T TV receptor that has been hacked by the",
    "start": "387880",
    "end": "395120"
  },
  {
    "text": "driver to be able to stream samples but can just",
    "start": "395120",
    "end": "400160"
  },
  {
    "text": "receive and all can listen but some also can send and that's the deal you have the ACF by Michael Osman",
    "start": "400160",
    "end": "408560"
  },
  {
    "text": "maybe some of the luckiest from you have taken this is um is training from the",
    "start": "408560",
    "end": "415639"
  },
  {
    "text": "few days before you have also the usrp from h research Bal cber from the HS",
    "start": "415639",
    "end": "422879"
  },
  {
    "text": "research will probably show you some stuff with the with that card tomorrow on his on his briefing uh this one has",
    "start": "422879",
    "end": "430560"
  },
  {
    "text": "the particularity to to be dual Channel with ACF if you want to use a ARF with",
    "start": "430560",
    "end": "435720"
  },
  {
    "text": "our tool you will need to have two cards because it's all duplex so you will need one card for reception and one card for",
    "start": "435720",
    "end": "442800"
  },
  {
    "text": "transmitting packets with usrp you have dual channel so you can do full duplex",
    "start": "442800",
    "end": "448440"
  },
  {
    "text": "with two channels at once but our tool will just use one and finally you have the blade ref which can",
    "start": "448440",
    "end": "455400"
  },
  {
    "text": "do just receive and transmit on a on one",
    "start": "455400",
    "end": "460400"
  },
  {
    "text": "card uh so let me introduce new radio and scapy but are the two main",
    "start": "461199",
    "end": "466280"
  },
  {
    "text": "components of our tool and has anyone in the audience play with new",
    "start": "466280",
    "end": "473159"
  },
  {
    "text": "radio quite a lot and with Sky almost the same",
    "start": "473159",
    "end": "480280"
  },
  {
    "text": "so G radio it's a framework uh you have a click and play GUI which is called G radio companion",
    "start": "480280",
    "end": "487919"
  },
  {
    "text": "where you can just assemble basic blocks those are the the picture you can see on the right you just have basic blocks",
    "start": "487919",
    "end": "495159"
  },
  {
    "text": "that you specific uh specific computation and you just uh connect them",
    "start": "495159",
    "end": "500199"
  },
  {
    "text": "together to do what was done in a DSP for example in a digital signal",
    "start": "500199",
    "end": "506720"
  },
  {
    "text": "processor you can extend it with the Heth g mode tool you can extend it",
    "start": "506720",
    "end": "513080"
  },
  {
    "text": "coding in python or C++ and it supports a lot of",
    "start": "513080",
    "end": "518399"
  },
  {
    "text": "SD uh at least the three where I was mentioning on the previous slide are fully",
    "start": "518399",
    "end": "523880"
  },
  {
    "text": "supported and you got a lot of great tutorials plus mic anouncement training like I mentioned",
    "start": "523880",
    "end": "530320"
  },
  {
    "text": "before basic blocks are also available to do blind signal analysis it's pretty",
    "start": "530320",
    "end": "535360"
  },
  {
    "text": "uh pretty neat because on once you're dealing with with uh with an equipment sometimes you know",
    "start": "535360",
    "end": "542320"
  },
  {
    "text": "everything about the the radio protocol at the radio frequency it will it will communicate on but sometimes you don't",
    "start": "542320",
    "end": "550000"
  },
  {
    "text": "so it's pretty pretty awesome to have some kind of block so you can just do a",
    "start": "550000",
    "end": "555240"
  },
  {
    "text": "TR try and uh try fail try succeed to to bring your your graph working and",
    "start": "555240",
    "end": "561880"
  },
  {
    "text": "receiving packet and of course it's open source it's uh gpv free licensed so basically",
    "start": "561880",
    "end": "569560"
  },
  {
    "text": "just a signal processor that works like a Lego game it's just as easy as as plugging and connects blocks",
    "start": "569560",
    "end": "577680"
  },
  {
    "text": "together for scappy it's an interactive packet manipulation program this coach",
    "start": "577880",
    "end": "583560"
  },
  {
    "text": "is taken from the from its website uh it's used I think worldwide",
    "start": "583560",
    "end": "588920"
  },
  {
    "text": "by pentesters because it's provided on a lot and a lot of Linux distribution it's full python code and",
    "start": "588920",
    "end": "596160"
  },
  {
    "text": "it's it's supported in Windows Linux Mac X it's easy to extend you just have to",
    "start": "596160",
    "end": "603040"
  },
  {
    "text": "to bring new python classes and that's all and it supports a lot of protocols",
    "start": "603040",
    "end": "608600"
  },
  {
    "text": "right now it has native fuzzing capabilities so it can speed up your pent test when",
    "start": "608600",
    "end": "615600"
  },
  {
    "text": "you're just adding a protocol you just you can use the the basic fuzzing capabilities of scappy and find a crash",
    "start": "615600",
    "end": "622600"
  },
  {
    "text": "or things like that uh and you also have some high level tools available based on scapy for",
    "start": "622600",
    "end": "628440"
  },
  {
    "text": "example like lator automat and you also have external",
    "start": "628440",
    "end": "633800"
  },
  {
    "text": "programs so let's talk about our tool scap radio how does it work it works",
    "start": "633800",
    "end": "640480"
  },
  {
    "text": "with scapy of course a lot of layers implementing your",
    "start": "640480",
    "end": "645519"
  },
  {
    "text": "packets for the given protocols you have your software defin radio on the other side with new radio",
    "start": "645519",
    "end": "652279"
  },
  {
    "text": "graph the GSC GSC is the file uh from the picture with the blocks connected",
    "start": "652279",
    "end": "657760"
  },
  {
    "text": "this is the the file produced by radio companion and it's the flow graph to process your",
    "start": "657760",
    "end": "663600"
  },
  {
    "text": "packets scapy will Fork to launch new radio on the background given your uh",
    "start": "663600",
    "end": "671079"
  },
  {
    "text": "given your RF protocol you want to launch skap provides you a way which is",
    "start": "671079",
    "end": "678160"
  },
  {
    "text": "called a super socket to change the physical layer so that's what we are",
    "start": "678160",
    "end": "683480"
  },
  {
    "text": "using right now you have to provide an input socket and an output socket so uh we have implemented class for that and G",
    "start": "683480",
    "end": "691399"
  },
  {
    "text": "radio on the other side will provide you the the exact same socket to connect them together and we used UDP plus a",
    "start": "691399",
    "end": "698720"
  },
  {
    "text": "custom header to identify the protocols for the communication uh and recently we wanted",
    "start": "698720",
    "end": "706600"
  },
  {
    "text": "to play with the to dynamically change the behavior of the the new radio graph",
    "start": "706600",
    "end": "713519"
  },
  {
    "text": "and new radio provides an XML PC server that can be leveraged to do that to change variables and it will reconfigure",
    "start": "713519",
    "end": "720440"
  },
  {
    "text": "your graph dynamically so we added that channel uh why using a UDP socet well",
    "start": "720440",
    "end": "728079"
  },
  {
    "text": "first it's natively supported under new radio uh it also supports tune tap but",
    "start": "728079",
    "end": "734920"
  },
  {
    "text": "this one requires root uh and we didn't found any reason to to to Pro to to have",
    "start": "734920",
    "end": "744079"
  },
  {
    "text": "to run our tool under root uh root privileges account so UDP was",
    "start": "744079",
    "end": "750160"
  },
  {
    "text": "fine and creating our own custom interface didn't sound a good idea uh plus it's easy to forward if you",
    "start": "750160",
    "end": "758360"
  },
  {
    "text": "think of that you can have a a computer running an SDR and you can forward with netcat socat or whatever you want just",
    "start": "758360",
    "end": "765279"
  },
  {
    "text": "rooting UDP packets to another instance of scapy that will just process the the",
    "start": "765279",
    "end": "772000"
  },
  {
    "text": "sample uh and that led us to our latest functionality that is uh is not",
    "start": "772000",
    "end": "777639"
  },
  {
    "text": "implemented yet uh it could also EAS us to build a cluster because sometimes",
    "start": "777639",
    "end": "783320"
  },
  {
    "text": "with protocols you one SDR will not be sufficient sometimes you need multiple",
    "start": "783320",
    "end": "788519"
  },
  {
    "text": "SDR to deal with high bandwidth uh and high frequencies so maybe you without",
    "start": "788519",
    "end": "795519"
  },
  {
    "text": "UDP can be helpful to to is the way to bring all the packets to one instance of",
    "start": "795519",
    "end": "801079"
  },
  {
    "text": "sc one instance of scappy and process that uh our custom eror is pretty simple",
    "start": "801079",
    "end": "807880"
  },
  {
    "text": "right now the first B you have a total of eight bytes the first bite is the",
    "start": "807880",
    "end": "813079"
  },
  {
    "text": "protocol ID and seven bytes are reserve for food you use we plan to put there",
    "start": "813079",
    "end": "818639"
  },
  {
    "text": "the channel for example the signal quality or anything that needs a per packet use uh why put the channel there",
    "start": "818639",
    "end": "826440"
  },
  {
    "text": "is because sometimes on channel opening or whitening uh some protocols may use",
    "start": "826440",
    "end": "832040"
  },
  {
    "text": "the channel number with algorithm to scrumble the data so it can be useful",
    "start": "832040",
    "end": "838040"
  },
  {
    "text": "to to be able to push the channel uh just as a metadata of your packet so the",
    "start": "838040",
    "end": "844000"
  },
  {
    "text": "SDR can know that it has to op on another channel to send this particular",
    "start": "844000",
    "end": "850000"
  },
  {
    "text": "packet uh and we have defined several protocols right now uh zero is for",
    "start": "850199",
    "end": "855639"
  },
  {
    "text": "invalid packets U most of the time invalid CC it's still useful when you",
    "start": "855639",
    "end": "861000"
  },
  {
    "text": "develop things to to just grab those packets you have zwave you have uh1 15.4 which which",
    "start": "861000",
    "end": "869639"
  },
  {
    "text": "uh which is the lower protocol for zigby and six lowan Etc uh you have Bluetooth",
    "start": "869639",
    "end": "874759"
  },
  {
    "text": "low energy wus and-7 and you still have a lot of room for other",
    "start": "874759",
    "end": "880480"
  },
  {
    "text": "protocols we are also providing you helpers because each time you your new",
    "start": "880480",
    "end": "886000"
  },
  {
    "text": "radio flow will receive a packet from the radio side it will have to put that",
    "start": "886000",
    "end": "891040"
  },
  {
    "text": "header in front of it so we are providing basic helpers uh just a block",
    "start": "891040",
    "end": "897160"
  },
  {
    "text": "to add a gr header and another another block to strip it respectively for the",
    "start": "897160",
    "end": "902279"
  },
  {
    "text": "the reception and the transmission of packets you just have to put as a parameter the protocol ID and that's all",
    "start": "902279",
    "end": "909160"
  },
  {
    "text": "it will add the eight bytes with seven zeros what we're releasing we're",
    "start": "909160",
    "end": "914720"
  },
  {
    "text": "releasing the modified SC version of scapy scapy radio uh with all the protocols we have uh we have developed",
    "start": "914720",
    "end": "921519"
  },
  {
    "text": "and test under concrete equipment uh and the corresponding new",
    "start": "921519",
    "end": "927920"
  },
  {
    "text": "radio FL graphs for atus for the the atus board we have for",
    "start": "927920",
    "end": "933199"
  },
  {
    "text": "usrp2 uh just be care U well if you want for example to modify the the new Radio",
    "start": "933199",
    "end": "940160"
  },
  {
    "text": "Pro the G files to work with for example the Acura or the blade ref all you have",
    "start": "940160",
    "end": "946160"
  },
  {
    "text": "to do is just run new radio companion open them and change the UHD sync and",
    "start": "946160",
    "end": "951360"
  },
  {
    "text": "Source block which are dealing with the usrp with gr Osmos SDR blocks which can",
    "start": "951360",
    "end": "957839"
  },
  {
    "text": "deal with a lot of other ones so it's just simple as changing two",
    "start": "957839",
    "end": "963680"
  },
  {
    "text": "blocks and we're also Rel releasing external external Tools around zwave uh",
    "start": "963680",
    "end": "970360"
  },
  {
    "text": "passive zwave discovering so which will just sniff for packets and print out uh Z-Wave networks that can sniff and all",
    "start": "970360",
    "end": "978560"
  },
  {
    "text": "the equipments and involved in this automation Network and an example of the",
    "start": "978560",
    "end": "984199"
  },
  {
    "text": "wave automatan that we will demonstrate later uh there's still known limitations",
    "start": "984199",
    "end": "990560"
  },
  {
    "text": "for example uh when you're dealing with Dynamic channel oping uh for example the usrp2 can deal",
    "start": "990560",
    "end": "998680"
  },
  {
    "text": "with 60 56 mahz bandwidth uh bler ref is",
    "start": "998680",
    "end": "1004040"
  },
  {
    "text": "uh is limited to 38 MHz so if you think about Bluetooth low energy that uses 80",
    "start": "1004040",
    "end": "1010839"
  },
  {
    "text": "MHz wide you're just running a bit short of bandwidth so that's one case where",
    "start": "1010839",
    "end": "1016600"
  },
  {
    "text": "you need to have multiple SDR uh and you cannot configure easily your",
    "start": "1016600",
    "end": "1022279"
  },
  {
    "text": "local oscillator to just hop from a frequency to another so the main IDE is",
    "start": "1022279",
    "end": "1027319"
  },
  {
    "text": "to listen wide for example the the 56 MHz bandwidth of the usrp and you do",
    "start": "1027319",
    "end": "1035160"
  },
  {
    "text": "multiple Channel fing and frequency translating to process all the channel together at once instead of just oping",
    "start": "1035160",
    "end": "1042400"
  },
  {
    "text": "from one channel to another and have one just single flow",
    "start": "1042400",
    "end": "1047480"
  },
  {
    "text": "line I iess deadband withd limitation both on radio side like I like I talked",
    "start": "1047480",
    "end": "1053000"
  },
  {
    "text": "and also on computer side because usdr is uh connected to the computer most of the time through USB port so you also",
    "start": "1053000",
    "end": "1060120"
  },
  {
    "text": "have sample limitation on that uh one other limitation it's pretty",
    "start": "1060120",
    "end": "1067240"
  },
  {
    "text": "pretty annoying is G radio does not tell you when the graph is running you just launch G radio and it takes time to",
    "start": "1067240",
    "end": "1073919"
  },
  {
    "text": "configure usdr initialize all the blocks that are involved in the graph and you don't have feedback so right now we are",
    "start": "1073919",
    "end": "1081760"
  },
  {
    "text": "added to have out cuted sleep timers to wait for the graph to be set",
    "start": "1081760",
    "end": "1087520"
  },
  {
    "text": "up but there's no walk around for now uh the over setup cannot be",
    "start": "1087520",
    "end": "1093600"
  },
  {
    "text": "fast if you think of that your packet will go from python to C++ to python to",
    "start": "1093600",
    "end": "1099159"
  },
  {
    "text": "UDP to python not very efficient in term of uh",
    "start": "1099159",
    "end": "1104919"
  },
  {
    "text": "of timing dependencies and it won't give you superpowers but we may think of that later we're working on",
    "start": "1104919",
    "end": "1112280"
  },
  {
    "text": "that uh as a disclaimer if you want to transmit don't forget to check your",
    "start": "1112280",
    "end": "1117720"
  },
  {
    "text": "local regulation Because unless you're living on a far cage it might be illegal or you need a ham radio license to to be",
    "start": "1117720",
    "end": "1125280"
  },
  {
    "text": "able to transmit um no let's talk about a little",
    "start": "1125280",
    "end": "1130760"
  },
  {
    "text": "bit about the the devices we studied with uh with our bed uh with our tool so first we started to assess zwave",
    "start": "1130760",
    "end": "1139520"
  },
  {
    "text": "home automation devices so the devices we had we had a magnetic sensor an alarm",
    "start": "1139520",
    "end": "1146240"
  },
  {
    "text": "device and a network controller uh we use the open source software on Raspberry Pi uh based on",
    "start": "1146240",
    "end": "1153559"
  },
  {
    "text": "open zwave unfortunately open zwave does not support the cryptography which zwave",
    "start": "1153559",
    "end": "1159200"
  },
  {
    "text": "supports so everything was in clear so the the layer we provide you in scapy",
    "start": "1159200",
    "end": "1165360"
  },
  {
    "text": "won't support uh cryptography because we did not have packet to to test",
    "start": "1165360",
    "end": "1171640"
  },
  {
    "text": "that side findings we had over of the devices while the first one is pretty",
    "start": "1171640",
    "end": "1176960"
  },
  {
    "text": "annoying uh if you transmit too fast it crashes the software it's just it's not Hardware",
    "start": "1176960",
    "end": "1183960"
  },
  {
    "text": "related it's just op the the Open The Wave stack that is a bit crappy so we",
    "start": "1183960",
    "end": "1190440"
  },
  {
    "text": "have to hardcut timers again to just slow down the transmission even with going through python UDP C++ Etc it's",
    "start": "1190440",
    "end": "1198080"
  },
  {
    "text": "still too fast for for opy wave and at some point we wanted to reverse the firmware too about",
    "start": "1198080",
    "end": "1204960"
  },
  {
    "text": "d a so with the devices we're using uh relied on Zenus uh SX the Z",
    "start": "1204960",
    "end": "1214159"
  },
  {
    "text": "w301 Asik more specifically then seems to be the leader providing eik for zwave",
    "start": "1214159",
    "end": "1220919"
  },
  {
    "text": "since it's the company that BR the the zwave protocol and it uses a kind of crappy",
    "start": "1220919",
    "end": "1228240"
  },
  {
    "text": "SPI protocol so we added support in the good fet from Travis good speed so it's",
    "start": "1228240",
    "end": "1233960"
  },
  {
    "text": "right now on the firmware if you just download the the firmware uh for for you good fet it will be on that uh and if",
    "start": "1233960",
    "end": "1241080"
  },
  {
    "text": "you want more detail about that you can read uh our company blog that details everything we we've done on",
    "start": "1241080",
    "end": "1247919"
  },
  {
    "text": "the uh on the Spy protocol and implementing the the the protocol in the good",
    "start": "1247919",
    "end": "1255240"
  },
  {
    "text": "fed we also studied the Bluetooth low energy elect elic cigarette this one is from a French company so as French",
    "start": "1255240",
    "end": "1262280"
  },
  {
    "text": "people we we felt compelled to to analyze it uh it uses Texas Instruments uh",
    "start": "1262280",
    "end": "1270279"
  },
  {
    "text": "system on chip the firmware is really heavily based on TI on TI",
    "start": "1270279",
    "end": "1276600"
  },
  {
    "text": "examples uh I think 80% if not 90% of the code is taken from TI examples for",
    "start": "1276600",
    "end": "1284039"
  },
  {
    "text": "the sending the packets and overd firmware upgrades so it's pretty easy to",
    "start": "1284039",
    "end": "1289559"
  },
  {
    "text": "understand that uh still it was really difficult to AIT that uh right now the",
    "start": "1289559",
    "end": "1295640"
  },
  {
    "text": "Bluetooth low energy only support the advertising because once the device is connected it Ops really really fast to",
    "start": "1295640",
    "end": "1304080"
  },
  {
    "text": "40 channels over 80 MHz bandwidth so with one SDR we weren't able to sniff",
    "start": "1304080",
    "end": "1310720"
  },
  {
    "text": "all the packets and follow the the connection uh and more um in addition to",
    "start": "1310720",
    "end": "1317720"
  },
  {
    "text": "that we had signal even with an nober and being at 2 cm away from the",
    "start": "1317720",
    "end": "1323760"
  },
  {
    "text": "cigarette we are losing packets uh so that's uh that was the",
    "start": "1323760",
    "end": "1329200"
  },
  {
    "text": "time when we thought about SDR clustering to get a wider Spectrum to be",
    "start": "1329200",
    "end": "1334279"
  },
  {
    "text": "able to analyze it the Potential Threat we we imagine on",
    "start": "1334279",
    "end": "1340039"
  },
  {
    "text": "that well the first is privacy issues still not a good a good a good one",
    "start": "1340039",
    "end": "1345400"
  },
  {
    "text": "because sniffing consumption of your electronic cigarettes might not reveal a lot of things to on",
    "start": "1345400",
    "end": "1351440"
  },
  {
    "text": "your uh uh on yourself maybe heal issues because uh",
    "start": "1351440",
    "end": "1356960"
  },
  {
    "text": "this electronic cigarette can be configured from your iPhone to select uh",
    "start": "1356960",
    "end": "1362840"
  },
  {
    "text": "between I think it's two parameters of nicotine so maybe we if we can overwrite",
    "start": "1362840",
    "end": "1369600"
  },
  {
    "text": "this and send you a huge dose of nikotine will be a bit",
    "start": "1369600",
    "end": "1375679"
  },
  {
    "text": "DIY uh you also have f coruption over year um the protocol Texas instrument",
    "start": "1375679",
    "end": "1382200"
  },
  {
    "text": "provides in in his examples uh allows the firmware to be to be",
    "start": "1382200",
    "end": "1388240"
  },
  {
    "text": "ciphered but they're not using it it's just just sent over the year in clear",
    "start": "1388240",
    "end": "1394039"
  },
  {
    "text": "text so you can easily think about writing a firmware uh based on the same",
    "start": "1394039",
    "end": "1400120"
  },
  {
    "text": "TI examples the the manufacturer has taken and corupt the firmware and with",
    "start": "1400120",
    "end": "1406520"
  },
  {
    "text": "that maybe you can K attack you can maybe you can hack the",
    "start": "1406520",
    "end": "1412400"
  },
  {
    "text": "cig the electronic cigarette to push a corrupted firmware and hack back the iPhone it is connected to",
    "start": "1412400",
    "end": "1419960"
  },
  {
    "text": "automatically we also studied XB art Bridges uh those are",
    "start": "1420760",
    "end": "1425840"
  },
  {
    "text": "uh uh 15.4 protocols based uh as the name stated it's not",
    "start": "1425840",
    "end": "1432159"
  },
  {
    "text": "zigby so they're chip and ready to use devices just like your shield for an U",
    "start": "1432159",
    "end": "1439039"
  },
  {
    "text": "you just plug it on your Dev board and it's done and therefore they're very popular to to electronic Engineers",
    "start": "1439039",
    "end": "1445799"
  },
  {
    "text": "because they're ready to use you have a a bunch of software to deal with that uh it's a custom protocol over 5.41",
    "start": "1445799",
    "end": "1453799"
  },
  {
    "text": "15.4 sorry and we started the implementation of the layer but we haven't uh we have we haven't gone",
    "start": "1453799",
    "end": "1460559"
  },
  {
    "text": "through all the all the specificities of the protocol so so far it's very",
    "start": "1460559",
    "end": "1467240"
  },
  {
    "text": "riment and and in fact we discovered that 15.4 is used for six lopan zigby",
    "start": "1467240",
    "end": "1473799"
  },
  {
    "text": "and XB protocol at least and it's really annoying because they thought about an",
    "start": "1473799",
    "end": "1479600"
  },
  {
    "text": "under layer but they didn't give you uh a way to determine the upper layer you",
    "start": "1479600",
    "end": "1485520"
  },
  {
    "text": "don't have a field stating well above this you will find zigg so you have to",
    "start": "1485520",
    "end": "1491399"
  },
  {
    "text": "rely on yourist check algorithms and it's pretty annoying you you cannot tell",
    "start": "1491399",
    "end": "1496480"
  },
  {
    "text": "easily the theing protocol the road map of the",
    "start": "1496480",
    "end": "1502279"
  },
  {
    "text": "development uh well the first line is uh has been stri because it's already done",
    "start": "1502279",
    "end": "1508720"
  },
  {
    "text": "that's the XML PC server we also want to write a war shock plugin to be able to",
    "start": "1508720",
    "end": "1514399"
  },
  {
    "text": "read back the the peap that scapy is able to read and to read or",
    "start": "1514399",
    "end": "1520440"
  },
  {
    "text": "write uh also leveraged our header to put uh more metadata on it and that",
    "start": "1520440",
    "end": "1526600"
  },
  {
    "text": "function to handle a cluster of computer plus s z and of course add more",
    "start": "1526600",
    "end": "1532200"
  },
  {
    "text": "protocols so how to add stuff you choose a protocol ID you build your graph in G",
    "start": "1532200",
    "end": "1538440"
  },
  {
    "text": "radio companion to be able to read your uh your to receive your packets then you create a packet sync which is basically",
    "start": "1538440",
    "end": "1545640"
  },
  {
    "text": "a state automaton that will check for access code and remove invalid frames based most of the time on the CLC and",
    "start": "1545640",
    "end": "1554120"
  },
  {
    "text": "that prepend the new radio either or use our our PS test it then you invert the graph for",
    "start": "1554120",
    "end": "1562640"
  },
  {
    "text": "the transmission Port and you create create a cryst custom Preamble block it",
    "start": "1562640",
    "end": "1568279"
  },
  {
    "text": "will prepend Preamble bites that are not part of the packet and it will also add",
    "start": "1568279",
    "end": "1574960"
  },
  {
    "text": "couples of null bytes at the end of the packet you may wonder why it this is necessary and in our test we found that",
    "start": "1574960",
    "end": "1583320"
  },
  {
    "text": "g radio just shuts down the local oscillator of your uh of your SDR too",
    "start": "1583320",
    "end": "1588520"
  },
  {
    "text": "early so the last btes are always corrupted by adding extra null bites at the end we just leverage that to uh to",
    "start": "1588520",
    "end": "1596279"
  },
  {
    "text": "be able to to get the last bite correct you test it again and you're",
    "start": "1596279",
    "end": "1601440"
  },
  {
    "text": "done then you move to scappy scapy is pretty simple you just write your required layers beware of pred disect",
    "start": "1601440",
    "end": "1608520"
  },
  {
    "text": "and post build because most of the time in computer based environments you have",
    "start": "1608520",
    "end": "1613600"
  },
  {
    "text": "the you have your header and then your pad on radio your pad is is uh of is",
    "start": "1613600",
    "end": "1620320"
  },
  {
    "text": "really often uh taken between the the header and the CC so for scap you just",
    "start": "1620320",
    "end": "1626679"
  },
  {
    "text": "have to pred disect your packet to bring back the CC to the Leer so it can process packets",
    "start": "1626679",
    "end": "1633799"
  },
  {
    "text": "smoothly you test it and you're done then you have to tie together the GC and",
    "start": "1633799",
    "end": "1639000"
  },
  {
    "text": "scapy you just put your GC in your home directory. scapy radio and that's all",
    "start": "1639000",
    "end": "1645360"
  },
  {
    "text": "the tool will find it but for that do not change the top underscore block value of your which is",
    "start": "1645360",
    "end": "1653080"
  },
  {
    "text": "the default one for your graph name because the tool will re will rely on",
    "start": "1653080",
    "end": "1658960"
  },
  {
    "text": "that you then edit capy layer new radio. py and you bind the layers together and",
    "start": "1658960",
    "end": "1667600"
  },
  {
    "text": "optionally you can just add your protocol in the in the list it's just for autoloading but it's not",
    "start": "1667600",
    "end": "1674320"
  },
  {
    "text": "necessary you update the install capap and of course don't forget to send a to send us a pool request for a",
    "start": "1674320",
    "end": "1682279"
  },
  {
    "text": "contribution and now it's time for ano to show you the demonstration and talk about",
    "start": "1682279",
    "end": "1688039"
  },
  {
    "text": "that uh first a disclaimer we have to apologize we really plan to to do a live",
    "start": "1688039",
    "end": "1695720"
  },
  {
    "text": "demonstration of that but we discovered quite lately that the zwave automation",
    "start": "1695720",
    "end": "1700880"
  },
  {
    "text": "system we were using relies on European frequencies which is 868 mahz and is ban",
    "start": "1700880",
    "end": "1707960"
  },
  {
    "text": "in in the US is used for GSM so if we were bringing the stuff and pouring it",
    "start": "1707960",
    "end": "1713000"
  },
  {
    "text": "uh on stage it will just infrige a federal",
    "start": "1713000",
    "end": "1718600"
  },
  {
    "text": "LW so we moved back to video",
    "start": "1718600",
    "end": "1724240"
  },
  {
    "text": "demonstration okay so in the left side no no me okay perfect so in the",
    "start": "1732080",
    "end": "1739919"
  },
  {
    "text": "left side we have our alarm system with the door sensor the controller based on",
    "start": "1739919",
    "end": "1746000"
  },
  {
    "text": "the Rasberry p and the open Z library and the alarm itself how does it works",
    "start": "1746000",
    "end": "1752039"
  },
  {
    "text": "when you open the door it send the frame to the controller and the controller send the frame to the alarm to turn",
    "start": "1752039",
    "end": "1758120"
  },
  {
    "text": "on and also when you close the door it send frame the controller and the controller sender frame to arm to turn",
    "start": "1758120",
    "end": "1764600"
  },
  {
    "text": "it off of course in a real alarm you need to enter a password to shut down",
    "start": "1764600",
    "end": "1770360"
  },
  {
    "text": "the alarm but for demo purpose that make it easier so a short video of the function",
    "start": "1770360",
    "end": "1777919"
  },
  {
    "text": "stem working okay",
    "start": "1777919",
    "end": "1785440"
  },
  {
    "text": "okay even with video you don't escape m is low",
    "start": "1794080",
    "end": "1800000"
  },
  {
    "text": "okay the the virtual machine is",
    "start": "1811360",
    "end": "1815000"
  },
  {
    "text": "Frozen Okay [Music] so have to wa",
    "start": "1820519",
    "end": "1828159"
  },
  {
    "text": "so this is just a video of the stem working nothing as special uh I will continue in the attacker",
    "start": "1833799",
    "end": "1841000"
  },
  {
    "text": "side PowerPoint also sorry sorry about that",
    "start": "1841000",
    "end": "1850640"
  },
  {
    "text": "so let's take a short break I have restart a",
    "start": "1862200",
    "end": "1868518"
  },
  {
    "text": "computer VMware froze so the stem is working when you",
    "start": "1869679",
    "end": "1876440"
  },
  {
    "text": "open start the alarm so the attacks we use the usrp and of course a Linux",
    "start": "1876440",
    "end": "1882320"
  },
  {
    "text": "computer and in the first time we use interactive shell if you already use capy you have a shell like Pon and you",
    "start": "1882320",
    "end": "1889480"
  },
  {
    "text": "can place n packet list show inject so this is most for Discovery and also you",
    "start": "1889480",
    "end": "1896639"
  },
  {
    "text": "can script that sh and we also introduce automaton automaton is a feature of",
    "start": "1896639",
    "end": "1902200"
  },
  {
    "text": "scapy it's well documented and it's like a state machine so you can do something",
    "start": "1902200",
    "end": "1908120"
  },
  {
    "text": "like uh I rate a frame when I have this Frame I launch another state and this",
    "start": "1908120",
    "end": "1913279"
  },
  {
    "text": "state send another frame in this example when we receive a frame to turn on the alarm you send TR to turn it",
    "start": "1913279",
    "end": "1919880"
  },
  {
    "text": "off but okay so air can show",
    "start": "1919880",
    "end": "1926600"
  },
  {
    "text": "that it's coming back again sorry about that",
    "start": "1926600",
    "end": "1934320"
  },
  {
    "text": "okayy",
    "start": "1964279",
    "end": "1967279"
  },
  {
    "text": "no black screen",
    "start": "2001399",
    "end": "2004880"
  },
  {
    "text": "okay so no video because have some trouble so like I said in the Atta side",
    "start": "2009840",
    "end": "2015639"
  },
  {
    "text": "we only need the US is all points of the tools and software defined radio just an",
    "start": "2015639",
    "end": "2020720"
  },
  {
    "text": "SDR and a Linux laptop some details about automaton",
    "start": "2020720",
    "end": "2027679"
  },
  {
    "text": "okay okay so automaton it's like a state machine the first state is the initial",
    "start": "2027679",
    "end": "2033200"
  },
  {
    "text": "State we just in fact launch the SDR on the wave like you can see the switch",
    "start": "2033200",
    "end": "2038720"
  },
  {
    "text": "radio protocol command it's a command we had to scapy so you just have to change the parameter for Z ZB if you want Zig",
    "start": "2038720",
    "end": "2046840"
  },
  {
    "text": "B after that we jump to the waiting State like in N State we just wait we",
    "start": "2046840",
    "end": "2052878"
  },
  {
    "text": "wait for the receive condition and the receive condition is a switch on frame this is a frame the controller send to",
    "start": "2052879",
    "end": "2058919"
  },
  {
    "text": "turn on the alarm and when we have we receive that we do the action and the",
    "start": "2058919",
    "end": "2064200"
  },
  {
    "text": "action is to turn off the alarm lat on and like said we have to set a delay",
    "start": "2064200",
    "end": "2071480"
  },
  {
    "text": "because we have Trav with Z Wave controller is we we inject frame too",
    "start": "2071480",
    "end": "2077919"
  },
  {
    "text": "fast again automaton are well documented in scy documentation and it work the",
    "start": "2077919",
    "end": "2083878"
  },
  {
    "text": "same way regular scopy and incy right do",
    "start": "2083879",
    "end": "2089960"
  },
  {
    "text": "okay okay so where to get the to get this Tool uh all you require is a new",
    "start": "2091599",
    "end": "2098440"
  },
  {
    "text": "radio 3.7 be careful because the 3.7.5 which is the the upcoming",
    "start": "2098440",
    "end": "2105040"
  },
  {
    "text": "development version just breaks the UHD blocks um in a pretty nasty way uh the",
    "start": "2105040",
    "end": "2113960"
  },
  {
    "text": "it's just the UHD sync so the block that is responsible to transmit packets with an",
    "start": "2113960",
    "end": "2119680"
  },
  {
    "text": "usrp uh the first uh connection of this block used to be complex streams so just",
    "start": "2119680",
    "end": "2126359"
  },
  {
    "text": "the the data that has been to be sent and they moved on the latest",
    "start": "2126359",
    "end": "2131760"
  },
  {
    "text": "version to have two entries but without uh without letting the first entry being",
    "start": "2131760",
    "end": "2137760"
  },
  {
    "text": "the samples now it's the second one so the graph just doesn't work anymore you just have to to launch the graph and",
    "start": "2137760",
    "end": "2145040"
  },
  {
    "text": "just and move the the road for the to go to the second U to the second",
    "start": "2145040",
    "end": "2151319"
  },
  {
    "text": "entry new radio 3.7 is already provided in KX or Samurai STFU and you also need",
    "start": "2151319",
    "end": "2158640"
  },
  {
    "text": "a compatible SDR of course then you just grab the code from our uh our bid backet",
    "start": "2158640",
    "end": "2165520"
  },
  {
    "text": "repository uh you go into the directory launch install uh you don't need to",
    "start": "2165520",
    "end": "2170880"
  },
  {
    "text": "launch it uh as a route it will automatically sudo when it needs to and",
    "start": "2170880",
    "end": "2176400"
  },
  {
    "text": "that's all you you have all you all you need to to be able to deal with",
    "start": "2176400",
    "end": "2182599"
  },
  {
    "text": "that thank you",
    "start": "2182599",
    "end": "2186760"
  },
  {
    "text": "if you have question you can go and right after the question I would try to just move the setup to show you the",
    "start": "2190119",
    "end": "2195920"
  },
  {
    "text": "videos yeah yeah sure this",
    "start": "2195920",
    "end": "2201520"
  },
  {
    "text": "one is there any question uh the tools will be online soon yeah the the tool will be will be",
    "start": "2203319",
    "end": "2210240"
  },
  {
    "text": "put online right after the after the talk and the scapy modification I've talk to Philip B which is a coworker and",
    "start": "2210240",
    "end": "2218000"
  },
  {
    "text": "it will merge it into scapy mainstream so hopefully all the scapy radio stuff will be available in the next Kelly",
    "start": "2218000",
    "end": "2224319"
  },
  {
    "text": "Linux or things like",
    "start": "2224319",
    "end": "2227319"
  },
  {
    "text": "that thank you thank you",
    "start": "2230160",
    "end": "2235119"
  }
]