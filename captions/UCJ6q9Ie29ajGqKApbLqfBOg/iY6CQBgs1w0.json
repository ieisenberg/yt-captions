[
  {
    "text": "and now please welcome you in beer hi",
    "start": "30",
    "end": "7919"
  },
  {
    "text": "thanks for coming this is my first time at blackhat and",
    "start": "7919",
    "end": "13080"
  },
  {
    "text": "I'm staying here at Mandalay Bay so I don't know if anyone else got this on their door this morning",
    "start": "13080",
    "end": "18630"
  },
  {
    "text": "like when I worked up wake up very early very jet-lagged to like open my door there was this thing stuck on there",
    "start": "18630",
    "end": "24269"
  },
  {
    "text": "there's got nothing to do with Apple by the way this is just an observation and so anyway like open up this box it's",
    "start": "24269",
    "end": "29880"
  },
  {
    "text": "like arm a bit some some lovely chocolates that I'm definitely not going to eat what's inside here oh it's like",
    "start": "29880",
    "end": "35760"
  },
  {
    "text": "some say on the front it's some like cyber startup thing if you work here if",
    "start": "35760",
    "end": "42510"
  },
  {
    "text": "you worked with them and you're here hello I don't read it what it does something cyber anyway you look at this",
    "start": "42510",
    "end": "48450"
  },
  {
    "text": "thing morning recovery and if you were to read what's on the back of this thing I mean what's it saying that that the",
    "start": "48450",
    "end": "55620"
  },
  {
    "text": "stereo thing is here to help you feel better after a night of celebrating and by the way this statement has not been evaluated by the Food and Drug",
    "start": "55620",
    "end": "61379"
  },
  {
    "text": "Administration so it seems to me like a very bold strategy to market your cyber",
    "start": "61379",
    "end": "67979"
  },
  {
    "text": "security company with a product that the FDA is declaring snake oil yeah so I",
    "start": "67979",
    "end": "73650"
  },
  {
    "text": "mean anyway I don't know who thought that was a good idea so anyway let's get",
    "start": "73650",
    "end": "78689"
  },
  {
    "text": "back to realtalk so my name is ian i joined crime security in 2013 and then",
    "start": "78689",
    "end": "84830"
  },
  {
    "text": "project zero when chris evans started this team so we have an expanded remit",
    "start": "84830",
    "end": "90780"
  },
  {
    "text": "to look at the security of the internet and so my personal focus has mostly been",
    "start": "90780",
    "end": "95850"
  },
  {
    "text": "on iOS and these days with a major focus on sandboxing and kernel exploitation",
    "start": "95850",
    "end": "101720"
  },
  {
    "text": "why should you listen to what I have to say so I think I have a pretty good idea how I Oh s actually works and how to",
    "start": "101720",
    "end": "109140"
  },
  {
    "text": "exploit it yes my exploits are not perfect but nevertheless and since Apple",
    "start": "109140",
    "end": "114299"
  },
  {
    "text": "launched their bug bounty a couple of years ago I spent a lot of my time writing exploits for iOS to make it",
    "start": "114299",
    "end": "120030"
  },
  {
    "text": "easier for researchers like you to actually be able to participate in that bug bounty if you've association to an",
    "start": "120030",
    "end": "126240"
  },
  {
    "text": "iPhone in the last two years you were probably either using your own exploits or potentially round one of",
    "start": "126240",
    "end": "131940"
  },
  {
    "text": "a kernel sandbox exploits so actually the main emphasis of this talk today is",
    "start": "131940",
    "end": "137400"
  },
  {
    "text": "to talk about why I think this stuff is important and why I don't think vendors or taking an exploitation seriously",
    "start": "137400",
    "end": "143670"
  },
  {
    "text": "enough I think this is something that we have projects around maybe don't do such a good job of so we're gonna start with",
    "start": "143670",
    "end": "150270"
  },
  {
    "text": "a history lesson yes this is half my lifetime ago but like I think it was formative stuff and it was in the news",
    "start": "150270",
    "end": "156300"
  },
  {
    "text": "all the time right and what kind of things were in the news all the time this this is a diagram from I Triple E",
    "start": "156300",
    "end": "163500"
  },
  {
    "text": "paper about slammer and if you were a black cat 15 years ago you could have seen them put on stage of the code that",
    "start": "163500",
    "end": "170370"
  },
  {
    "text": "was this what achieve was this this is a",
    "start": "170370",
    "end": "175880"
  },
  {
    "text": "straight copy from the first byte of UDP packet onto a 16 byte stack buffer right",
    "start": "175880",
    "end": "183120"
  },
  {
    "text": "so this is some Microsoft sequel server code and it's expecting that the UDP",
    "start": "183120",
    "end": "189330"
  },
  {
    "text": "packet has null-terminated database name it's like right at the beginning of the",
    "start": "189330",
    "end": "194610"
  },
  {
    "text": "packet and the server is trusting this why am I saying this",
    "start": "194610",
    "end": "200190"
  },
  {
    "text": "so what do things look like 15 years ago poor security development practices used",
    "start": "200190",
    "end": "206550"
  },
  {
    "text": "to lead to clearly visible harm and people cared right specifically Microsoft customers cared",
    "start": "206550",
    "end": "212730"
  },
  {
    "text": "and they were really worried about the future and so sure you're also all very",
    "start": "212730",
    "end": "218910"
  },
  {
    "text": "familiar with this this cause Bill Gates to write this famous trustworthy computing memo and yes I'm going to read",
    "start": "218910",
    "end": "224220"
  },
  {
    "text": "it off with the screen no all of it our new design approaches we need to dramatically reduce the number of such",
    "start": "224220",
    "end": "231030"
  },
  {
    "text": "issues that come up in the software the Microsoft its partners and its customers create it goes on at the same time we're",
    "start": "231030",
    "end": "238440"
  },
  {
    "text": "in the process of training all our developers and the latest secure coding techniques now I've actually managed to",
    "start": "238440",
    "end": "244130"
  },
  {
    "text": "grab hold of some of those internal training materials from Microsoft at the",
    "start": "244130",
    "end": "249150"
  },
  {
    "text": "time this is one of their motivational posters explaining about the dangers of",
    "start": "249150",
    "end": "255269"
  },
  {
    "text": "district copy thank you to natty Schenker for getting all of this for me",
    "start": "255269",
    "end": "260840"
  },
  {
    "text": "so one last quick and this is from Bill Gates so now",
    "start": "260840",
    "end": "265889"
  },
  {
    "text": "we face a choice between adding features and resolving security issues we need to choose security right and this memo was",
    "start": "265889",
    "end": "273090"
  },
  {
    "text": "the foundation of Microsoft's secure development lifecycle 15 years ago so 15",
    "start": "273090",
    "end": "280650"
  },
  {
    "text": "years later now surely everyone now develop secure systems uses safe languages and you know if they must",
    "start": "280650",
    "end": "286499"
  },
  {
    "text": "write low-level code they use annotations and model checking to help those developers and in some products",
    "start": "286499",
    "end": "293069"
  },
  {
    "text": "Microsoft is on their way down that path but did everyone take that route and what does the world look like today so",
    "start": "293069",
    "end": "300180"
  },
  {
    "text": "now in this mobile first world Microsoft is not such a dominant player on there is mobile endpoints right it's",
    "start": "300180",
    "end": "307289"
  },
  {
    "text": "now Android and it's now iOS and these code bases in their current forms they",
    "start": "307289",
    "end": "312300"
  },
  {
    "text": "didn't exist then yes xnu did exist 15 years ago it did exist almost who not xnu but large parts",
    "start": "312300",
    "end": "318719"
  },
  {
    "text": "of that codebase existed 30 years ago but the security models of iOS are vastly different from the security",
    "start": "318719",
    "end": "325080"
  },
  {
    "text": "models of xnu and mark and these purposes never went through this sudden moment of clarity the code quality like",
    "start": "325080",
    "end": "332430"
  },
  {
    "text": "not struck copying to the stack is actually super important so what are the",
    "start": "332430",
    "end": "337620"
  },
  {
    "text": "consequences of these code bases never having gone through such an event well",
    "start": "337620",
    "end": "343020"
  },
  {
    "text": "it doesn't look like a big map with pinkie lights on it instead it looks like these two 42-year acts also with",
    "start": "343020",
    "end": "351419"
  },
  {
    "text": "pinkie lights on them so maybe some of you are familiar with where this rack diagram is taken from so",
    "start": "351419",
    "end": "358740"
  },
  {
    "text": "this is a from the Pegasus product description manual it was leaked during",
    "start": "358740",
    "end": "366419"
  },
  {
    "text": "the hacking team attack and why am i showing you this so it makes the discussion you read",
    "start": "366419",
    "end": "372270"
  },
  {
    "text": "about NSA and about Pegasus they generally talk about numbers they talk about numbers and exploits and you can",
    "start": "372270",
    "end": "378479"
  },
  {
    "text": "see that the talks about Pegasus from from the team look out who reversed the",
    "start": "378479",
    "end": "384770"
  },
  {
    "text": "exploit like a super good super super axiom write-up and I'm sure you've all",
    "start": "384770",
    "end": "389849"
  },
  {
    "text": "seen like the stories that came out of this in Wired like these million-dollar dissident story and that's what people",
    "start": "389849",
    "end": "395490"
  },
  {
    "text": "take away I think that you take these big numbers like 1 million dollars kind of a comfort blanket I am pretty",
    "start": "395490",
    "end": "402150"
  },
  {
    "text": "sure that like Google directors do this as well I think the reasoning goes we know a million dollars is a lot of money",
    "start": "402150",
    "end": "408120"
  },
  {
    "text": "right tack one person in a SLR works and makes us ninety-nine point seven percent secure and what I want to try to paint",
    "start": "408120",
    "end": "415470"
  },
  {
    "text": "with things like this is a different picture so because this is a product",
    "start": "415470",
    "end": "420780"
  },
  {
    "text": "from NSA that will not forget that NSO is a proud American company yes the",
    "start": "420780",
    "end": "425790"
  },
  {
    "text": "seventy percent owned by San Francisco private equity and were they selling they're not selling an exploit they're",
    "start": "425790",
    "end": "433260"
  },
  {
    "text": "selling complete computer network exploitation in a box set ups right in these two boxes and in addition to this",
    "start": "433260",
    "end": "440280"
  },
  {
    "text": "you also get some like Windows boxes to run their front end like data visualize",
    "start": "440280",
    "end": "447200"
  },
  {
    "text": "someone's just moving there Pegasus installation so there are two major",
    "start": "447620",
    "end": "454770"
  },
  {
    "text": "vegetable points I want to emphasize here firstly this this room massive two",
    "start": "454770",
    "end": "462180"
  },
  {
    "text": "rack installations is clearly targeted at customers without see any experience",
    "start": "462180",
    "end": "467340"
  },
  {
    "text": "without computer network exploitation experience like the manual that this is part of this miss Utley states that so",
    "start": "467340",
    "end": "474360"
  },
  {
    "text": "they're over-the-air installation method the operator only needs to put in a phone number and the agent is installed",
    "start": "474360",
    "end": "480570"
  },
  {
    "text": "right there's no more details that's the level of sophistication which they are expecting from their customer so my",
    "start": "480570",
    "end": "488100"
  },
  {
    "text": "personal fear here is that exploitation these and things like this is an extremely powerful an Eastern metric",
    "start": "488100",
    "end": "494820"
  },
  {
    "text": "tool and you might use a maybe I and",
    "start": "494820",
    "end": "501150"
  },
  {
    "text": "probably I might feel comfortable that some government institutions in some governments in the world are capable of",
    "start": "501150",
    "end": "506520"
  },
  {
    "text": "handling such tools but this product is not targeted to them this is for this is",
    "start": "506520",
    "end": "511890"
  },
  {
    "text": "for organizations in four countries rather that don't have decades of experience in the technical and policy",
    "start": "511890",
    "end": "519110"
  },
  {
    "text": "discussions that are required to like balance the use of this power and in the",
    "start": "519110",
    "end": "524610"
  },
  {
    "text": "wrong hands this is a very very powerful weapon against things like dissent which",
    "start": "524610",
    "end": "529860"
  },
  {
    "text": "is how it's used but it's not only used for suppressing political dissent you know",
    "start": "529860",
    "end": "535990"
  },
  {
    "text": "the slippery slope of the use of tools like this is real so one global problem which product like",
    "start": "535990",
    "end": "543279"
  },
  {
    "text": "this contribute to is obesity right especially in the US alone and all",
    "start": "543279",
    "end": "548350"
  },
  {
    "text": "across the world so citizen lab this group from Canada have collected",
    "start": "548350",
    "end": "553540"
  },
  {
    "text": "evidence suggesting that exploits served by one of these installations were sent to employees of a NGO in Mexico the",
    "start": "553540",
    "end": "561579"
  },
  {
    "text": "campaign in favor of a Mexican soda tax right is that really a justified use of",
    "start": "561579",
    "end": "568060"
  },
  {
    "text": "this kind of power the second point I want to make regarding this is that",
    "start": "568060",
    "end": "574449"
  },
  {
    "text": "these prices which you hear quoted everywhere I think of white you must use to paint an inaccurate picture of code",
    "start": "574449",
    "end": "581050"
  },
  {
    "text": "quality discomfort blanket of like okay and maybe the code isn't perfect but",
    "start": "581050",
    "end": "586149"
  },
  {
    "text": "it's still like a million dollars to exploit someone this is not real and that's really not helpful the system is",
    "start": "586149",
    "end": "592990"
  },
  {
    "text": "not serving a unique single exploit perfect target right the true discovery",
    "start": "592990",
    "end": "598480"
  },
  {
    "text": "and exploitation costs of the bugs involved here I think a far lower than people believe and this is the area that",
    "start": "598480",
    "end": "604720"
  },
  {
    "text": "predictor are focused on so you can remember these posted these quoted prices are taking you from literally",
    "start": "604720",
    "end": "611019"
  },
  {
    "text": "nothing to this kind of mid-level Intelligence Agency capability that cause money and most of that money is",
    "start": "611019",
    "end": "618040"
  },
  {
    "text": "not the cost of the exploits so what does the world look like now fifteen years later now poor software",
    "start": "618040",
    "end": "625660"
  },
  {
    "text": "development practices need to hidden harm with some squiggly areas poor software development practices in",
    "start": "625660",
    "end": "633250"
  },
  {
    "text": "Android and iOS lead to hidden but quite widespread and damaging but easy to",
    "start": "633250",
    "end": "638980"
  },
  {
    "text": "ignore you know these are different code bases that are under attack now and they",
    "start": "638980",
    "end": "645069"
  },
  {
    "text": "never had this slammer moment that their development practices were never forced to mature and them in feature versus",
    "start": "645069",
    "end": "653079"
  },
  {
    "text": "security feature seems to always win so in the rest of this talk I'm going to try to convince you of just how poor",
    "start": "653079",
    "end": "658959"
  },
  {
    "text": "those practices are and yes I know more stuff about iOS than Android because that's just happens to be what I work on",
    "start": "658959",
    "end": "665830"
  },
  {
    "text": "please go read the particular tracker like read the report from the bug Yan released on Monday if you think Android",
    "start": "665830",
    "end": "673300"
  },
  {
    "text": "is any better than this so the stuff has changed in the last 15 years right it's unlikely I hope that",
    "start": "673300",
    "end": "680740"
  },
  {
    "text": "Pegasus like Pegasus payload sends a single UDP packet unless it's a",
    "start": "680740",
    "end": "686470"
  },
  {
    "text": "targeting like insert of things or you know any embedded chip on your phone right like the Broadcom white module",
    "start": "686470",
    "end": "692230"
  },
  {
    "text": "maybe they're attending one packet but we have things like sandboxing which mean that you might need more than that",
    "start": "692230",
    "end": "699880"
  },
  {
    "text": "one bug what's my provocative statement here security systems design is making",
    "start": "699880",
    "end": "704950"
  },
  {
    "text": "promises which poor software development practices cannot keep and when I'm talking about things like the unboxing",
    "start": "704950",
    "end": "710579"
  },
  {
    "text": "what I'm talking about are the implementation details of sandboxing now",
    "start": "710579",
    "end": "715899"
  },
  {
    "text": "it's more likely nowadays that the thing you're served by Pegasus is like a small",
    "start": "715899",
    "end": "721269"
  },
  {
    "text": "chain of bugs but that doesn't necessarily mean that those bugs are all that hard to find or all that hard to",
    "start": "721269",
    "end": "726610"
  },
  {
    "text": "explore so I'm gonna fit a bit more on this like systems design stuff because I",
    "start": "726610",
    "end": "732430"
  },
  {
    "text": "think it's important to understand how these companies think about secure",
    "start": "732430",
    "end": "738339"
  },
  {
    "text": "software development so if you search around hard enough on the Apple website you'll come across this diagram it",
    "start": "738339",
    "end": "745060"
  },
  {
    "text": "doesn't matter too much what's on there but this is from the iOS security white paper and it's got this like layered",
    "start": "745060",
    "end": "751570"
  },
  {
    "text": "diagram of like data protection class app sandbox use a partition encrypted OS",
    "start": "751570",
    "end": "757570"
  },
  {
    "text": "partition so both iOS and Android current security",
    "start": "757570",
    "end": "762640"
  },
  {
    "text": "leads come from like these security systems design backgrounds so on the Android side it's now the security lead",
    "start": "762640",
    "end": "769720"
  },
  {
    "text": "is Dave Klein damaja has a background in doing small real-time oasis in like avionics so it's",
    "start": "769720",
    "end": "776709"
  },
  {
    "text": "possible that the plane that you flew here on had was running like some other code the ran on his OS from 20 years ago",
    "start": "776709",
    "end": "783310"
  },
  {
    "text": "right even Christic or the apple size prior to apples at OLPC this one laptop per child",
    "start": "783310",
    "end": "790600"
  },
  {
    "text": "thing and I found I bought one of those back in the day and so there he led",
    "start": "790600",
    "end": "797230"
  },
  {
    "text": "there like security architecture it's called bit frost if you want to go see and look it up so undeniably both",
    "start": "797230",
    "end": "804360"
  },
  {
    "text": "these security leaders have like really strong security engineering skill sets but they don't come from an exploitation",
    "start": "804360",
    "end": "810360"
  },
  {
    "text": "background so this academic understanding of security perhaps tends",
    "start": "810360",
    "end": "816089"
  },
  {
    "text": "to kind of discount implementation flaws if a bugs found you fix it and then the",
    "start": "816089",
    "end": "821130"
  },
  {
    "text": "system is perfect again and the focus is on like the design of the system and not the implementation you can go watch",
    "start": "821130",
    "end": "827970"
  },
  {
    "text": "events talk from two years ago at blackhat to see examples of this so I",
    "start": "827970",
    "end": "833820"
  },
  {
    "text": "don't come from this background I come from an exploitation background and I see things like the other way up so to",
    "start": "833820",
    "end": "840300"
  },
  {
    "text": "me code is nothing but a collection of bugs in implementation details and so",
    "start": "840300",
    "end": "846930"
  },
  {
    "text": "what's my opinion of security systems design yes again this is a other deliberately provocative statement given",
    "start": "846930",
    "end": "852899"
  },
  {
    "text": "sufficient bug density security design is irrelevant so everything that I'm",
    "start": "852899",
    "end": "861000"
  },
  {
    "text": "saying kind of goes against the little which Apple publicly say about bugs in iOS so there is like very little you can",
    "start": "861000",
    "end": "869880"
  },
  {
    "text": "find out there so this is again from Yvonne's talk two years ago and let's let's read the quote from the screen so",
    "start": "869880",
    "end": "876029"
  },
  {
    "text": "a feedback that we've heard pretty consistently both from my red team Apple I hope some of them were here today and also from researchers directly I don't",
    "start": "876029",
    "end": "883560"
  },
  {
    "text": "know what weird like actual security researchers hacking iOS a-tellin even that it's hard",
    "start": "883560",
    "end": "888630"
  },
  {
    "text": "maybe you shouldn't trust them but these people are telling us that it's getting",
    "start": "888630",
    "end": "893700"
  },
  {
    "text": "increasingly more difficult to find some of them type this wrong to find some of",
    "start": "893700",
    "end": "899970"
  },
  {
    "text": "those most critical types of security vulnerabilities and so I'm putting it to you that everyone is wearing this",
    "start": "899970",
    "end": "906029"
  },
  {
    "text": "comfort blanket if like thinking that this is hard and I'm not trying to say",
    "start": "906029",
    "end": "911370"
  },
  {
    "text": "it's not hard what I'm more trying to emphasize is that I don't think that many people are actually looking and",
    "start": "911370",
    "end": "916649"
  },
  {
    "text": "it's as simple as like if you don't look you definitely won't find anything and it seems to me to be much more a factor",
    "start": "916649",
    "end": "923130"
  },
  {
    "text": "of time you put in and I put a lot of time in but this is all I do equals bugs out say all right let's",
    "start": "923130",
    "end": "930270"
  },
  {
    "text": "actually like get to some bug yes for those of you from Apple this is a very old example but I will get to",
    "start": "930270",
    "end": "935880"
  },
  {
    "text": "some much more relevant examples it's a much more recent examples but I think nevertheless that this is like the",
    "start": "935880",
    "end": "942750"
  },
  {
    "text": "lessons that you can learn from this example do still apply right so when he found was making this this",
    "start": "942750",
    "end": "950490"
  },
  {
    "text": "point that it's getting increasingly difficult to find more of these most critical types of security vulnerabilities this code hit one of the",
    "start": "950490",
    "end": "957780"
  },
  {
    "text": "iOS 10 betas and it shipped first in iOS 10 which was the first iOS release which",
    "start": "957780",
    "end": "964580"
  },
  {
    "text": "qualified for the Apple bug bounty so if you're not familiar with xnu kernel this",
    "start": "964580",
    "end": "970710"
  },
  {
    "text": "is a brand new siskel reachable from any sandbox context like the sandbox is not",
    "start": "970710",
    "end": "975750"
  },
  {
    "text": "involved at all here so for example you can reach this from the Safari renderer",
    "start": "975750",
    "end": "981050"
  },
  {
    "text": "so it's fun to like play spot the bug here so if your so I'll just like tell",
    "start": "981050",
    "end": "986160"
  },
  {
    "text": "you a little bit about the API so in case you're not familiar with them so copy in let's have a look",
    "start": "986160",
    "end": "992640"
  },
  {
    "text": "copy in is like a copy from user or Linux so the first argument is user",
    "start": "992640",
    "end": "998700"
  },
  {
    "text": "space pointer second argument is a kernel space pointer and the last argument is the size I just have some",
    "start": "998700",
    "end": "1006800"
  },
  {
    "text": "more Pepsi and you can get a code",
    "start": "1006800",
    "end": "1010480"
  },
  {
    "text": "because this is an example of a bug that it's actually kind of fun it was kind of fun at the time to show you people in",
    "start": "1012700",
    "end": "1018800"
  },
  {
    "text": "the office because you it really makes you do a double-take of like is there",
    "start": "1018800",
    "end": "1024110"
  },
  {
    "text": "actually a bug there right let's look through the code okay what do we do we're gonna copy in so ARBs points to",
    "start": "1024110",
    "end": "1031189"
  },
  {
    "text": "stuff that we control from user space so we're going to copy in from recipe size users base pointer to SC this size the",
    "start": "1031190",
    "end": "1038209"
  },
  {
    "text": "size of size all right so easy so recipe size points to a size and then we pass that size to kalach which is like the",
    "start": "1038209",
    "end": "1045290"
  },
  {
    "text": "kernels base general purpose keep alligator and then we get back this chunk of memory Kay recipe and later on",
    "start": "1045290",
    "end": "1051740"
  },
  {
    "text": "down the bottom we're gonna copy in from args recipe pointing to some kind of",
    "start": "1051740",
    "end": "1056810"
  },
  {
    "text": "recipe structure it doesn't really matter what recipe is to K recipe and",
    "start": "1056810",
    "end": "1061970"
  },
  {
    "text": "how much we're gonna copy we're gonna copy recipe size all that sounds we're gonna copy the signs except about",
    "start": "1061970",
    "end": "1068520"
  },
  {
    "text": "if you go back up to the top recipe science was used as a pointer and now it's used as a limp so like this code shipped for six months",
    "start": "1068520",
    "end": "1080670"
  },
  {
    "text": "until I got around to graphing the xnu dips for copy in because yes that's what",
    "start": "1080670",
    "end": "1088650"
  },
  {
    "text": "I do every time these these dips come out they're very sporadically so this is",
    "start": "1088650",
    "end": "1094830"
  },
  {
    "text": "the kind of issue that I'm claiming is still on the same order of like complexity as davidich fields sequel",
    "start": "1094830",
    "end": "1102540"
  },
  {
    "text": "server but from 15 years ago right for this kind of issue there's no need to understand like complex or",
    "start": "1102540",
    "end": "1108060"
  },
  {
    "text": "esoteric stuff about the operating system just knowing C should let you see if this code is completely wrong so",
    "start": "1108060",
    "end": "1114660"
  },
  {
    "text": "clearly there are no annotations there's nothing like Linux I'm just got underscore user ID you pre get some",
    "start": "1114660",
    "end": "1123210"
  },
  {
    "text": "compiler warnings but I don't know if you've ever tried to compile xnu with all warnings enabled yeah good luck",
    "start": "1123210",
    "end": "1129780"
  },
  {
    "text": "reading through that and finding this so what are my main points here or what about code review I'm not blaming the",
    "start": "1129780",
    "end": "1136170"
  },
  {
    "text": "individual developer in fact if you look at this case you can see why it ended up like this this is just copy and pasted",
    "start": "1136170",
    "end": "1141540"
  },
  {
    "text": "from some other code and they made a subtle change the API writing C code is hard and this is a new Siskel reachable",
    "start": "1141540",
    "end": "1148620"
  },
  {
    "text": "from everywhere on the system and it has clearly not been reviewed by someone with a vulnerability research background",
    "start": "1148620",
    "end": "1154200"
  },
  {
    "text": "because they would spot this and yes this example is from iOS 10 this kind of stuff is still having today in iOS 11",
    "start": "1154200",
    "end": "1160740"
  },
  {
    "text": "and the motivating examples are so motivating in recent that I can't talk about them because they're still under",
    "start": "1160740",
    "end": "1166590"
  },
  {
    "text": "the 90-day deadline so right what about testing all right you might realize exactly kind of tricky to make that code",
    "start": "1166590",
    "end": "1173220"
  },
  {
    "text": "run the kind of tricky B even to exploit this code because it will just come a panic so yeah there are no tests and",
    "start": "1173220",
    "end": "1179370"
  },
  {
    "text": "there's also clearly no fuzzing alright so you may be up things better now all",
    "start": "1179370",
    "end": "1184860"
  },
  {
    "text": "right so this is an example from the exploit I released a month ago or so",
    "start": "1184860",
    "end": "1189930"
  },
  {
    "text": "called multipath and so we just do one more spot bug in some C code so this picture",
    "start": "1189930",
    "end": "1198150"
  },
  {
    "text": "is called multipath TCP it lets you take TCP and like run it over multiple physical multiple network",
    "start": "1198150",
    "end": "1205270"
  },
  {
    "text": "interfaces so if you wanna play spot the bug and you control what desk points do",
    "start": "1205270",
    "end": "1211779"
  },
  {
    "text": "it points to one of these so kind of structures like the positive side of thing and so if we just look through the",
    "start": "1211779",
    "end": "1217630"
  },
  {
    "text": "logic of this code coming to down a bit but the logic is still the same right so if this sock adder is a F I know",
    "start": "1217630",
    "end": "1224440"
  },
  {
    "text": "so ipv4 socket and the length is not the size of an ipv4 address then we bail if",
    "start": "1224440",
    "end": "1231730"
  },
  {
    "text": "the family type is ipv6 address and the socket length is not the size of an ipv6",
    "start": "1231730",
    "end": "1238299"
  },
  {
    "text": "address then we bail otherwise I have some other if which is got nothing to do",
    "start": "1238299",
    "end": "1243490"
  },
  {
    "text": "with the length then we just like mem copy straight into here so you control",
    "start": "1243490",
    "end": "1248500"
  },
  {
    "text": "sa Len it's a single byte so it's up to 255 bytes and you can go read the Keene team right up for my exploit for this",
    "start": "1248500",
    "end": "1255760"
  },
  {
    "text": "it's actually exploitable in kind of an interesting way because you can you can",
    "start": "1255760",
    "end": "1262960"
  },
  {
    "text": "overwrite interesting pointers inside this structure you don't really need to do any heat grooming to get a use of a",
    "start": "1262960",
    "end": "1268539"
  },
  {
    "text": "control point to here so yeah those two",
    "start": "1268539",
    "end": "1275500"
  },
  {
    "text": "points lie firmly in this class of like legacy bugs I mean they're not legacy bugs they're not thirty year old mark",
    "start": "1275500",
    "end": "1282880"
  },
  {
    "text": "bugs they're very new bugs but they're this class of like legacy C coding problems right which maybe we shouldn't",
    "start": "1282880",
    "end": "1289330"
  },
  {
    "text": "have anymore we definitely do so again please like I'm not trying to criticize criticize",
    "start": "1289330",
    "end": "1294460"
  },
  {
    "text": "the individual developers who wrote those two particular examples these are failures of process it shouldn't be",
    "start": "1294460",
    "end": "1300340"
  },
  {
    "text": "possible to commit this kind of pair right it should be prevented by annotations it should be prevented by",
    "start": "1300340",
    "end": "1305980"
  },
  {
    "text": "code review it should be prevented by manual testing it should be prevented by fuzzing and this is the kind of stuff that Bill Gates was talking about 15",
    "start": "1305980",
    "end": "1312100"
  },
  {
    "text": "years ago right and this should not be happening in quote/unquote secure code",
    "start": "1312100",
    "end": "1317380"
  },
  {
    "text": "bases now any case you think I'm just taking - two - two examples like please",
    "start": "1317380",
    "end": "1323649"
  },
  {
    "text": "go look at the project zero bug tracker and see all of the similar issues right my point is that this is systemic",
    "start": "1323649",
    "end": "1328990"
  },
  {
    "text": "process failures and that's what Apple need to address so there are other classes of issues which",
    "start": "1328990",
    "end": "1335730"
  },
  {
    "text": "perhaps more interesting than these see bugs which fall into more like this bucket of more esoteric issues so",
    "start": "1335730",
    "end": "1341880"
  },
  {
    "text": "they're not just simple C coding problems like buffer overflows like these but they require kind of more",
    "start": "1341880",
    "end": "1347160"
  },
  {
    "text": "understanding of the underlying system and its paradigms so let's take a look at two examples of esoteric bugs which",
    "start": "1347160",
    "end": "1355140"
  },
  {
    "text": "also say something about apples security culture so if you've read this book this",
    "start": "1355140",
    "end": "1360330"
  },
  {
    "text": "is a book from 2012 by Jonathan Levin and so iOS is based on this combination",
    "start": "1360330",
    "end": "1368940"
  },
  {
    "text": "of bsd and ma so MA it's full of like a bunch of really weird API is and like",
    "start": "1368940",
    "end": "1375570"
  },
  {
    "text": "Apple are slowly turning these API eyes off removing them and this is very good thing but I definitely get the feeling",
    "start": "1375570",
    "end": "1381540"
  },
  {
    "text": "that Apple lacks the kind of institutional memory to know why many of these things are there or are still",
    "start": "1381540",
    "end": "1387930"
  },
  {
    "text": "there so I think I mentioned before it the iOS has a very confusing and",
    "start": "1387930",
    "end": "1393840"
  },
  {
    "text": "complicated privileged model right it's way more complicated than just user unroot root is completely distinct from",
    "start": "1393840",
    "end": "1402060"
  },
  {
    "text": "kernel code execution on iOS and each process has its own set of these things called entitlements and checks for these",
    "start": "1402060",
    "end": "1409080"
  },
  {
    "text": "entitlements like dotted basically seemingly randomly across user space on the kernel so what is this bug that's in",
    "start": "1409080",
    "end": "1419310"
  },
  {
    "text": "this book from 2012 so this is a some old feature from ma that if your root",
    "start": "1419310",
    "end": "1426600"
  },
  {
    "text": "gives you read/write access to all the user space processes on the system we'd more access to their memory without",
    "start": "1426600",
    "end": "1432240"
  },
  {
    "text": "requiring the entitlement that's meant to stop you ever getting that right so I",
    "start": "1432240",
    "end": "1438090"
  },
  {
    "text": "didn't find this bug it's in this book free 2012 right and also when I read",
    "start": "1438090",
    "end": "1443580"
  },
  {
    "text": "this I just kind of assumed it had been fixed because you know it's in this old book but you know I found myself in the",
    "start": "1443580",
    "end": "1450570"
  },
  {
    "text": "situation with a bug or I was able to test this right so if you just go buy a device from Apple and test this you",
    "start": "1450570",
    "end": "1458580"
  },
  {
    "text": "can't because you need to exploit some own a that you found that's not patched in order to get",
    "start": "1458580",
    "end": "1464550"
  },
  {
    "text": "in order to copy-paste but you don't even need to type the code in from here because Jonathan Levin even put it on",
    "start": "1464550",
    "end": "1470370"
  },
  {
    "text": "his website with a big like banner saying this is a bug right and it only",
    "start": "1470370",
    "end": "1475740"
  },
  {
    "text": "got fixed after I used it in an exploit so what's my point here applique Lee not",
    "start": "1475740",
    "end": "1481950"
  },
  {
    "text": "doing enough proactive runner ability research and they're not even fixing these bugs that are documented in books",
    "start": "1481950",
    "end": "1488720"
  },
  {
    "text": "right so I discuss lack of code review lack of testing auditing and practice",
    "start": "1489080",
    "end": "1495720"
  },
  {
    "text": "run durability research I felt obliged to have at least one slide with some assembly on so what is this bug this is",
    "start": "1495720",
    "end": "1503910"
  },
  {
    "text": "an example of a failure of variant analysis so in 2016 I reported a bunch",
    "start": "1503910",
    "end": "1510090"
  },
  {
    "text": "of issues found in these user space services which are written using this ancient tool called MIG and I feel",
    "start": "1510090",
    "end": "1516690"
  },
  {
    "text": "obliged to show you some MIG code this is the mock interface generator",
    "start": "1516690",
    "end": "1522690"
  },
  {
    "text": "it's literally thousands upon thousands of lines of C code F print effing more C",
    "start": "1522690",
    "end": "1528330"
  },
  {
    "text": "code to generate these handlers right and these are used everywhere this gets you from the user to colonel or between",
    "start": "1528330",
    "end": "1534630"
  },
  {
    "text": "all of these users face processes so much of it is built on this literally impossible to audit code base but this",
    "start": "1534630",
    "end": "1543720"
  },
  {
    "text": "is not about bugs in that code generator it's about a much simpler aspect of meg which is this simple rule for object",
    "start": "1543720",
    "end": "1550560"
  },
  {
    "text": "lifetime management so for the objects that you pass across an RPC boundary",
    "start": "1550560",
    "end": "1555630"
  },
  {
    "text": "there's the simple there is a simple rule if your handler returns zero which",
    "start": "1555630",
    "end": "1561210"
  },
  {
    "text": "is a success value then your handlers responsible for the lifetime of any objects which will pass to it and if",
    "start": "1561210",
    "end": "1568020"
  },
  {
    "text": "your handler returns an error code you are not responsible for the ownership namely the system the RPC system is",
    "start": "1568020",
    "end": "1573780"
  },
  {
    "text": "responsible for the ownership so this leads to a very common class of bug which is if you have a handler which",
    "start": "1573780",
    "end": "1581450"
  },
  {
    "text": "takes ownership of a reference in this case it is dropping a reference on this",
    "start": "1581450",
    "end": "1587400"
  },
  {
    "text": "object and then w22 ends up being the return value index zero for this method",
    "start": "1587400",
    "end": "1596509"
  },
  {
    "text": "what that means is that the actual mig system itself will dis or what the mixed",
    "start": "1596509",
    "end": "1602179"
  },
  {
    "text": "system itself will decide that okay the code didn't take ownership of this",
    "start": "1602179",
    "end": "1607429"
  },
  {
    "text": "object so i'm gonna release the reference and this leads to in this case dropping a reference that was only taken",
    "start": "1607429",
    "end": "1613159"
  },
  {
    "text": "once I'm dropping it twice so I reported",
    "start": "1613159",
    "end": "1619579"
  },
  {
    "text": "the first instance of this in 2016 you can go into the project Co tracker and",
    "start": "1619579",
    "end": "1624649"
  },
  {
    "text": "see where I quite explicitly say there are more instances of this bug and it's really hard when you only have the",
    "start": "1624649",
    "end": "1631669"
  },
  {
    "text": "binary switch it's what I have for almost all of this stuff on this it's on open source tarball comm it's really hard to go find all instances of this",
    "start": "1631669",
    "end": "1638839"
  },
  {
    "text": "but in the source my guess is that it shouldn't be so hard right but I see",
    "start": "1638839",
    "end": "1644359"
  },
  {
    "text": "very little evidence again very little evidence up until like bugs that I can't say that not enough ferret analysis of",
    "start": "1644359",
    "end": "1652639"
  },
  {
    "text": "things like this are happening for example one of the Keene team bugs which they are nominated for a pony for is",
    "start": "1652639",
    "end": "1658879"
  },
  {
    "text": "this bug class which I pointed out two years ago so yeah what I'm trying to tell you is that this is like systemic",
    "start": "1658879",
    "end": "1665359"
  },
  {
    "text": "these are avoidable and yes so I've",
    "start": "1665359",
    "end": "1675409"
  },
  {
    "text": "spoken a lot about what I think Apple are not doing what are they doing so if",
    "start": "1675409",
    "end": "1681019"
  },
  {
    "text": "you prefer to try to engineer your way out of things rather than investing in",
    "start": "1681019",
    "end": "1688579"
  },
  {
    "text": "proactive vulnerability research and develop a process changes then you've read mitigations right and this is a",
    "start": "1688579",
    "end": "1694249"
  },
  {
    "text": "trend across the whole industry Android and iOS are like especially invested in",
    "start": "1694249",
    "end": "1699409"
  },
  {
    "text": "this so you can watch dave krietor maccas talk from the Google cloud conference a few weeks ago explicitly",
    "start": "1699409",
    "end": "1706489"
  },
  {
    "text": "saying this they're Androids mitigations are the things that make it more secure and in my opinion this is like",
    "start": "1706489",
    "end": "1711619"
  },
  {
    "text": "dangerously naive but these people don't come from an exploitation background and so it's hard for them to weigh up the",
    "start": "1711619",
    "end": "1718569"
  },
  {
    "text": "true impact or lack thereof in these litigations in fact I also I often get",
    "start": "1718569",
    "end": "1725659"
  },
  {
    "text": "the feeling that the people designing and implementing these mitigations don't necessarily have exploitation by either often it's more the case and",
    "start": "1725659",
    "end": "1732970"
  },
  {
    "text": "especially if it's an iOS of there was a public proof-of-concept exploit or an exploit in a jailbreak let's make a",
    "start": "1732970",
    "end": "1738910"
  },
  {
    "text": "small change to how the heap allocated works and now the POC doesn't work we're",
    "start": "1738910",
    "end": "1743920"
  },
  {
    "text": "done right so how far fake who works",
    "start": "1743920",
    "end": "1749680"
  },
  {
    "text": "with us on project there has been making this point a bunch recently you can go watch his his talks about this yes again",
    "start": "1749680",
    "end": "1756490"
  },
  {
    "text": "it's like deliberately provocative I don't think we commit occasions at that bad but week mitigations can be trivially defeated with more bugs and if",
    "start": "1756490",
    "end": "1763150"
  },
  {
    "text": "you don't care about bugs there's no point in shipping these week mitigations so what is the canonical week mitigation",
    "start": "1763150",
    "end": "1770440"
  },
  {
    "text": "that everyone implements randomization so I mean you talk very very briefly about randomization go read all the",
    "start": "1770440",
    "end": "1779410"
  },
  {
    "text": "preset bonuses talks about iOS exploitation and he covers like the",
    "start": "1779410",
    "end": "1785200"
  },
  {
    "text": "whole history of iOS kernel EEP exploitation and how it's changed over the years we'll just look at like this",
    "start": "1785200",
    "end": "1793600"
  },
  {
    "text": "one tiny aspect so this is the iOS kernel heap it's one small part I always",
    "start": "1793600",
    "end": "1800470"
  },
  {
    "text": "gonna leave so you have this thing called the zone map this is a 384 mega PI region or kernel versus your space",
    "start": "1800470",
    "end": "1808120"
  },
  {
    "text": "yes regardless of whether you pour $200 iPod Touch or 1000 wherever how much it costs",
    "start": "1808120",
    "end": "1815530"
  },
  {
    "text": "$1,800 iPhone X with three gigs of RAM you don't get a bigger kernel zone heap",
    "start": "1815530",
    "end": "1822370"
  },
  {
    "text": "sorry you only get three hundred eighty four megabytes so this thing is a pool",
    "start": "1822370",
    "end": "1828430"
  },
  {
    "text": "allocator and that's free and really four megabytes gets split up on demand into smaller regions of like a few pages",
    "start": "1828430",
    "end": "1838030"
  },
  {
    "text": "and then the zone is like keeping track of individual allocations inside there and if the whole region is free then",
    "start": "1838030",
    "end": "1845710"
  },
  {
    "text": "this smaller region is a candidate for getting given back to the underlying",
    "start": "1845710",
    "end": "1850780"
  },
  {
    "text": "system if there's memory pressure so we saw the call to Kalakh earlier so",
    "start": "1850780",
    "end": "1857290"
  },
  {
    "text": "cowlick underneath is just has its own bunch of zone four different sizes if your allocation",
    "start": "1857290",
    "end": "1865660"
  },
  {
    "text": "is bigger than a certain threshold it doesn't go to the zone map it goes to the kernel map so a recent mitigation",
    "start": "1865660",
    "end": "1873880"
  },
  {
    "text": "not too sure when this is reduced maybe sometime in I was 10 was to add some",
    "start": "1873880",
    "end": "1880240"
  },
  {
    "text": "randomness to the initial state of this free list so it used to be allocated like this so this is actually linear",
    "start": "1880240",
    "end": "1889620"
  },
  {
    "text": "actually this when I say used to be allocated like this this means that when you actually make a calc and then the",
    "start": "1889620",
    "end": "1895240"
  },
  {
    "text": "next calc and then the next catalog it comes backwards so it's just II pushed on to the free list in the in the other",
    "start": "1895240",
    "end": "1900930"
  },
  {
    "text": "deal around answer this recent mitigation rather than making occur like",
    "start": "1900930",
    "end": "1907120"
  },
  {
    "text": "that now it goes like this so it randomly goes from the inside to the",
    "start": "1907120",
    "end": "1914740"
  },
  {
    "text": "outside so this is the world's most useless bug I only found this because",
    "start": "1914740",
    "end": "1920910"
  },
  {
    "text": "there was a bug in my heap room and I became convinced that the random number",
    "start": "1920910",
    "end": "1926500"
  },
  {
    "text": "generated they had must be like totally broken because it didn't look random at all so I was like right let's look at",
    "start": "1926500",
    "end": "1931690"
  },
  {
    "text": "the random number generator achieve this random number generator is slightly broken but it was just a bug in my code I think this has absolutely no security",
    "start": "1931690",
    "end": "1939670"
  },
  {
    "text": "impact unless the people from Apple tell me that actually they also use this for their like VPN but probably not so",
    "start": "1939670",
    "end": "1946180"
  },
  {
    "text": "what's this are you trying to do but this is just some trivia this is taking a natural random number generator and",
    "start": "1946180",
    "end": "1952390"
  },
  {
    "text": "trying to generate a random bit stream I think we probably do have enough time to just quickly walk through this code",
    "start": "1952390",
    "end": "1958270"
  },
  {
    "text": "because it's kind of its kind of interesting and like I am no cartographer but even I can spot that",
    "start": "1958270",
    "end": "1965350"
  },
  {
    "text": "this thing is kind of biased right so what's the dirt as we're comes in with",
    "start": "1965350",
    "end": "1970750"
  },
  {
    "text": "this buffer and count so buffer points to count number of un petit a 32 by D",
    "start": "1970750",
    "end": "1979870"
  },
  {
    "text": "words right find a portion of the buffer that hasn't been emptied we might have",
    "start": "1979870",
    "end": "1985570"
  },
  {
    "text": "emptied our last index in the previous iteration so it's originally this index value is zero and then it's walking",
    "start": "1985570",
    "end": "1991690"
  },
  {
    "text": "through each of the D words try to find the first one which is nonzero right and if the first",
    "start": "1991690",
    "end": "1998679"
  },
  {
    "text": "one that's nonzero or if we didn't find one that was nonzero and we got to the end then refill the buffer then collect",
    "start": "1998679",
    "end": "2008009"
  },
  {
    "text": "a bit so what's that doing you can practice your bit twiddling it's pulling the least significant bit from the D",
    "start": "2008009",
    "end": "2015899"
  },
  {
    "text": "word at offset index in buffer pulling that hour into bit its then shifting",
    "start": "2015899",
    "end": "2021750"
  },
  {
    "text": "that value in buffer down by one so it's shifting the bits down and then it's oaring that bit into the result",
    "start": "2021750",
    "end": "2028440"
  },
  {
    "text": "bits and it goes back around again and this thing is reentrant so in the sense",
    "start": "2028440",
    "end": "2033809"
  },
  {
    "text": "of that same buffer will get used again so what's wrong with this if this was",
    "start": "2033809",
    "end": "2042720"
  },
  {
    "text": "actually like cryptographic this like weird way that they are like checking if",
    "start": "2042720",
    "end": "2048000"
  },
  {
    "text": "the value has totally been incomplete the D word has been consumed by seeing if it's equal to 0 so this misses out",
    "start": "2048000",
    "end": "2055108"
  },
  {
    "text": "leaving 0 bits in those random D words so I'd see the bias you get from it is",
    "start": "2055109",
    "end": "2060569"
  },
  {
    "text": "like totally meaningless for so sorry for wasting your time it's totally meaningless for for heap randomization",
    "start": "2060569",
    "end": "2067260"
  },
  {
    "text": "but never less but the only odor you get in this talk sorry right but back to you",
    "start": "2067260",
    "end": "2075720"
  },
  {
    "text": "think this ever so slightly biased where I'm a generator for kernel heap allocation like what effect does this",
    "start": "2075720",
    "end": "2081810"
  },
  {
    "text": "actually have so if you look at it from a exploiters perspective especially from",
    "start": "2081810",
    "end": "2086908"
  },
  {
    "text": "an exploiters perspective who knows that bugs are dense and you have a choice of bugs well what's the first observation",
    "start": "2086909",
    "end": "2093960"
  },
  {
    "text": "there's still a pattern right the pattern is no longer linear but there is a problem still there and",
    "start": "2093960",
    "end": "2099960"
  },
  {
    "text": "there's still stuff we can do with that pattern so one example of an operation that I've used with precisely this",
    "start": "2099960",
    "end": "2106650"
  },
  {
    "text": "pattern in the empty list exploit you can go read a write-up with this is to",
    "start": "2106650",
    "end": "2112170"
  },
  {
    "text": "reverse the order of this free list so rather than your allocations going from the inside out there from outside in and",
    "start": "2112170",
    "end": "2119099"
  },
  {
    "text": "this has some properties in the case of the empty list exploit were useful this",
    "start": "2119099",
    "end": "2125550"
  },
  {
    "text": "doesn't require like a new bug right this just means finding right primitive and this case is very easy right you just allocate a bunch of",
    "start": "2125550",
    "end": "2131730"
  },
  {
    "text": "objects and then find them and then free them in the same order and this is what's the free list around the second",
    "start": "2131730",
    "end": "2139200"
  },
  {
    "text": "observation here larger objects are less randomized so the randomization only",
    "start": "2139200",
    "end": "2145140"
  },
  {
    "text": "applies to this initial free list population and generally like the bigger your object the shorter the initial free",
    "start": "2145140",
    "end": "2152580"
  },
  {
    "text": "list is and yes at the limit the initial free list is of size 1 so it's still",
    "start": "2152580",
    "end": "2158010"
  },
  {
    "text": "cool the random number generator but it generates a single random value of it yeah so I exploited both of these things",
    "start": "2158010",
    "end": "2166680"
  },
  {
    "text": "so I exploited this part one that they were still apparent in empty lists and in extra recipe which is my exploit for",
    "start": "2166680",
    "end": "2173520"
  },
  {
    "text": "that first chunk of code that I showed you I used this property if energy I was",
    "start": "2173520",
    "end": "2181200"
  },
  {
    "text": "able to control the size of the object that was overflowing out of which means I could just choose the size that",
    "start": "2181200",
    "end": "2186540"
  },
  {
    "text": "doesn't have this randomization property",
    "start": "2186540",
    "end": "2190520"
  },
  {
    "text": "that thing can we just sort the free list right again this doesn't",
    "start": "2191630",
    "end": "2197310"
  },
  {
    "text": "necessarily need a bug right you've just got to find some optimized kernel data structure like a hash table that has",
    "start": "2197310",
    "end": "2205800"
  },
  {
    "text": "some primitive that it's gonna like sort on the addresses of objects I don't have",
    "start": "2205800",
    "end": "2211800"
  },
  {
    "text": "an example of this to show you but just just to like emphasize the point that it's not so simple to actually guarantee",
    "start": "2211800",
    "end": "2219210"
  },
  {
    "text": "that these mitigations have any impact at all so yeah some more per octave",
    "start": "2219210",
    "end": "2227010"
  },
  {
    "text": "statements please stop just stop fixing bugs learn from them and act on that so",
    "start": "2227010",
    "end": "2233310"
  },
  {
    "text": "this current fashion which we see all over the place the mitigations will save",
    "start": "2233310",
    "end": "2238740"
  },
  {
    "text": "us mitigations will not save strong mitigations which is like making real",
    "start": "2238740",
    "end": "2244920"
  },
  {
    "text": "meaningful reductions in reachable attack surface or relevant in combination with caring about bugs right",
    "start": "2244920",
    "end": "2252030"
  },
  {
    "text": "each bug needs to be a lesson if this is",
    "start": "2252030",
    "end": "2257340"
  },
  {
    "text": "truly a secure code base do you need for each issue to be like why this here how is it introduced how could",
    "start": "2257340",
    "end": "2264150"
  },
  {
    "text": "we have caught this earlier which process problems do we need to address as Donna said that we could have caught this earlier who should have had access",
    "start": "2264150",
    "end": "2270750"
  },
  {
    "text": "to this code to review it but for whatever internal or political reasons didn't have that access how do we find",
    "start": "2270750",
    "end": "2276600"
  },
  {
    "text": "every instance of this bug and fix it how do we genuinely kill this class of bugs so the attitude that I would love",
    "start": "2276600",
    "end": "2283770"
  },
  {
    "text": "people to view these bugs through or the lens I would like them to view these bugs is someone has already found this",
    "start": "2283770",
    "end": "2290760"
  },
  {
    "text": "issue and like I can't talk on the stage at blackhat about things like suspected bug collisions and who I think they",
    "start": "2290760",
    "end": "2297570"
  },
  {
    "text": "collided with but I think these issues collide with people I'm very certain a",
    "start": "2297570",
    "end": "2303090"
  },
  {
    "text": "large proportion of the issues which I've reported in iOS have at some point been actively exploited in fact the",
    "start": "2303090",
    "end": "2309690"
  },
  {
    "text": "thing that worries me more and over which I have even less control is the trivial variants of the things that I",
    "start": "2309690",
    "end": "2315750"
  },
  {
    "text": "have found and reported are still being exploited in the world and that's why I",
    "start": "2315750",
    "end": "2322530"
  },
  {
    "text": "want to do this Apple one more thing thing so the reason I decided to give",
    "start": "2322530",
    "end": "2332070"
  },
  {
    "text": "this talk is that I think I'm failing in my goal to do you",
    "start": "2332070",
    "end": "2337109"
  },
  {
    "text": "know my small part to move the world towards this vision of trustworthy",
    "start": "2337109",
    "end": "2342180"
  },
  {
    "text": "computing it's way too easy for vendors like Google and Samsung and Apple to",
    "start": "2342180",
    "end": "2347910"
  },
  {
    "text": "ignore exploitation one of the problems here is that they like to tout themselves as being data-driven right",
    "start": "2347910",
    "end": "2353910"
  },
  {
    "text": "making decisions on evidence and big data and this doesn't work for this kind of security you know by definition good",
    "start": "2353910",
    "end": "2361290"
  },
  {
    "text": "attackers don't get caught you didn't collect your big data and I hope that I",
    "start": "2361290",
    "end": "2367050"
  },
  {
    "text": "have kind of raised to convince you that may be targeted exploitation is actually kind of widespread and more importantly",
    "start": "2367050",
    "end": "2373560"
  },
  {
    "text": "it's too easily abused the key causes which you probably don't believe in like stopping people thinking this you know",
    "start": "2373560",
    "end": "2381030"
  },
  {
    "text": "it has a societal impact and the societal impact is much wider than the single user who is targeted by each",
    "start": "2381030",
    "end": "2388020"
  },
  {
    "text": "attack and I hope I've also kind of managed to convince you that the bar for",
    "start": "2388020",
    "end": "2393359"
  },
  {
    "text": "iOS exploitation is kind of lower than you probably think you know there is no comfort blanket that you can wrap yourself in to think",
    "start": "2393359",
    "end": "2400589"
  },
  {
    "text": "that just because you're campaigning for human rights or gains childhood obesity did you all not a target yeah I've had",
    "start": "2400589",
    "end": "2408269"
  },
  {
    "text": "to leave out a bunch of anecdotes which would make these points more clearly because I am for some of the anecdotes",
    "start": "2408269",
    "end": "2414539"
  },
  {
    "text": "like afraid of being targeted and not by governments but by private individuals",
    "start": "2414539",
    "end": "2419969"
  },
  {
    "text": "who also were part of this you're like I rely on this device oh yeah nothing",
    "start": "2419969",
    "end": "2427650"
  },
  {
    "text": "really changes like Percy said in her keynote this morning it's all spot fixes and not raising the bar and without this",
    "start": "2427650",
    "end": "2434759"
  },
  {
    "text": "kind of organizational change from the top declaring that all of these vendors Apple included have a security problem",
    "start": "2434759",
    "end": "2441989"
  },
  {
    "text": "nothing is going to get better so I've reported over 150 bugs similar",
    "start": "2441989",
    "end": "2448349"
  },
  {
    "text": "stat those handfuls that I've shown you today all with detailed technical write-ups and I'm still not seeing any",
    "start": "2448349",
    "end": "2454380"
  },
  {
    "text": "momentum within Apple but genuine process change from the top so let's end",
    "start": "2454380",
    "end": "2459479"
  },
  {
    "text": "with one more example of why the stuff still matters so this is a report from last week from Amnesty International",
    "start": "2459479",
    "end": "2466049"
  },
  {
    "text": "this global human rights organization and their employees in Saudi Arabia were",
    "start": "2466049",
    "end": "2471839"
  },
  {
    "text": "targeted are suspected of being targeted by a user of one of these Pegasus installations and if you read this",
    "start": "2471839",
    "end": "2478949"
  },
  {
    "text": "article more closely and you look at the screenshots well you'll notice that",
    "start": "2478949",
    "end": "2485160"
  },
  {
    "text": "those screenshots are from the iOS messaging app right they're using iPhones this stuff is real right this is",
    "start": "2485160",
    "end": "2492599"
  },
  {
    "text": "happening and it's way too easy to ignore so yes we have made some",
    "start": "2492599",
    "end": "2499199"
  },
  {
    "text": "paragraphs like parisa said so maybe now Apple don't take over a year to fix most externally reported bugs but I want more",
    "start": "2499199",
    "end": "2506339"
  },
  {
    "text": "than that yep so I want to see real organizational",
    "start": "2506339",
    "end": "2512369"
  },
  {
    "text": "and process changes not just for fixes anymore and just sending these hundreds",
    "start": "2512369",
    "end": "2517499"
  },
  {
    "text": "of highly technical write-ups and bugs has not achieved that so I am gonna try something else",
    "start": "2517499",
    "end": "2522739"
  },
  {
    "text": "so two years ago on this stage Apple announced that they were starting a bug bounty",
    "start": "2522739",
    "end": "2528190"
  },
  {
    "text": "and here's some quotes from Yvonne's talk it's not meant to be any kind of",
    "start": "2528190",
    "end": "2533260"
  },
  {
    "text": "exclusive club so if anyone who is not in the program brings to us a vulnerability that would be covered",
    "start": "2533260",
    "end": "2539079"
  },
  {
    "text": "under the program we welcome that we're going to take a look and if the work merits it we'll invite them into the",
    "start": "2539079",
    "end": "2545319"
  },
  {
    "text": "program and real reward the vulnerability that they found so I don't think that Apple ever intended this bug",
    "start": "2545319",
    "end": "2551109"
  },
  {
    "text": "bounty program to be a PR tool I mean obviously it's given them lots of good PR it's again got like these numbers out",
    "start": "2551109",
    "end": "2557140"
  },
  {
    "text": "that people uses these comfort blankets but I think that Apple to do on some",
    "start": "2557140",
    "end": "2562210"
  },
  {
    "text": "level genuinely care about getting more security bugs so there was one other",
    "start": "2562210",
    "end": "2570910"
  },
  {
    "text": "thing they said so in addition to these exact amounts we've all that researchers do need the reward to a charity of their choosing we will add our option match",
    "start": "2570910",
    "end": "2577839"
  },
  {
    "text": "that one to one doubling the donation and so it might surprise you to learn that I and particular have never been",
    "start": "2577839",
    "end": "2585010"
  },
  {
    "text": "invited to be part of this even though we would absolutely love for Apple to donate the bounties that we find to",
    "start": "2585010",
    "end": "2592540"
  },
  {
    "text": "charity and so that is why I am asking Apple to do today so here's 30 bugs I",
    "start": "2592540",
    "end": "2597970"
  },
  {
    "text": "found and reported to Apple [Applause]",
    "start": "2597970",
    "end": "2605450"
  },
  {
    "text": "so I think every one of these met the bar they all have detailed technical write-ups repr cases an H defeat a",
    "start": "2605450",
    "end": "2611630"
  },
  {
    "text": "critical part of the iOS security model so yet if you added up with the corporate donation matching it's two",
    "start": "2611630",
    "end": "2617270"
  },
  {
    "text": "point four five million dollars and so yeah Apple today I'm asking you to",
    "start": "2617270",
    "end": "2622430"
  },
  {
    "text": "follow through on that bug bounty ago two years ago and I have one thing to say directly to Tim Cook where's the",
    "start": "2622430",
    "end": "2628640"
  },
  {
    "text": "camera there so yeah I really worried that people are getting hacked using Barents with the bugs that I report and",
    "start": "2628640",
    "end": "2635059"
  },
  {
    "text": "you do a poor job of fixing so some of these issues are highlighted in fact",
    "start": "2635059",
    "end": "2642109"
  },
  {
    "text": "anything ones that aren't fixed yeah please go look those up in your bug tracker and find out why they happened",
    "start": "2642109",
    "end": "2647660"
  },
  {
    "text": "why they won't call earlier on what processes need to change to prevent them happening again and I'm very happy to",
    "start": "2647660",
    "end": "2653660"
  },
  {
    "text": "sit down with you with my laptop and walk through these issues and together we can make things better so just to",
    "start": "2653660",
    "end": "2659809"
  },
  {
    "text": "make sure Tim finds this out so I don't have to in Kurt's email but what I do",
    "start": "2659809",
    "end": "2665930"
  },
  {
    "text": "have is that's very small that's wrong",
    "start": "2665930",
    "end": "2673700"
  },
  {
    "text": "what I'll know in the trash well I do have an explicable number of Twitter",
    "start": "2673700",
    "end": "2678799"
  },
  {
    "text": "followers so I'm just going to tweet to Tim now just so he sees this",
    "start": "2678799",
    "end": "2685030"
  },
  {
    "text": "there we go and see all the interesting things are my Twitter feed so yeah thank",
    "start": "2685030",
    "end": "2690559"
  },
  {
    "text": "you for listening and [Applause]",
    "start": "2690559",
    "end": "2696270"
  }
]