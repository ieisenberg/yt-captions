[
  {
    "start": "0",
    "end": "30000"
  },
  {
    "text": "the following video was recorded live at the conference and produced by the sound of knowledge",
    "start": "640",
    "end": "7160"
  },
  {
    "text": "Incorporated welcome to the black hat briefings 1999 this meeting was held in exciting Las Vegas Nevada from July 7th",
    "start": "7920",
    "end": "15320"
  },
  {
    "text": "through the 8th this is videotape number 21 track a auditing NT catching Greg",
    "start": "15320",
    "end": "22800"
  },
  {
    "text": "hogland",
    "start": "22800",
    "end": "25800"
  },
  {
    "start": "30000",
    "end": "88000"
  },
  {
    "text": "good morning um my name is uh JD glosser and uh a little bit new at this so bear",
    "start": "36160",
    "end": "43200"
  },
  {
    "text": "with me um I have a bunch of slides so I'm probably going to go pretty quick",
    "start": "43200",
    "end": "49320"
  },
  {
    "text": "um uh I come from a little microscopic uh software company that I own in Portland and",
    "start": "49320",
    "end": "56440"
  },
  {
    "text": "uh let's see where we at",
    "start": "56440",
    "end": "61120"
  },
  {
    "text": "hold on I have to figure out which uh slide this",
    "start": "67360",
    "end": "71280"
  },
  {
    "start": "88000",
    "end": "121000"
  },
  {
    "text": "is all right hi do it this way um the need for auditing this is a quote from",
    "start": "88479",
    "end": "94759"
  },
  {
    "text": "information security magazine that um I felt was pretty accurate um personally",
    "start": "94759",
    "end": "101119"
  },
  {
    "text": "from the the type of things that I see I've worked at uh Intel helip Packard I see much more uh internal problems than",
    "start": "101119",
    "end": "107560"
  },
  {
    "text": "I do uh than I see outside problems coming in so uh I put this up there uh",
    "start": "107560",
    "end": "113520"
  },
  {
    "text": "you're probably all pretty familiar with this but just a starting point of of where we're going",
    "start": "113520",
    "end": "119960"
  },
  {
    "start": "121000",
    "end": "174000"
  },
  {
    "text": "this is a slide uh a little bit confirming that Steven North cut sent me this slide uh something that that he",
    "start": "124399",
    "end": "130560"
  },
  {
    "text": "experiences a lot uh kind of the idea behind this is that um",
    "start": "130560",
    "end": "136840"
  },
  {
    "text": "uh basically if you can um uh be sneaking your intrusion auditing you know what you're trying to do is capture",
    "start": "136840",
    "end": "143120"
  },
  {
    "text": "information um if you you can grab information and you",
    "start": "143120",
    "end": "149280"
  },
  {
    "text": "find out how something's going to uh happen like let's say in the auditing Department if you knew how a particular",
    "start": "149280",
    "end": "154440"
  },
  {
    "text": "stock deal was going to go down or something um and uh you knew how the",
    "start": "154440",
    "end": "159800"
  },
  {
    "text": "outcome was going to be you'd be buying your you could buy stocks or something on the outside and you know legitimately",
    "start": "159800",
    "end": "167239"
  },
  {
    "text": "uh make money so um just a note on",
    "start": "167239",
    "end": "172360"
  },
  {
    "start": "174000",
    "end": "230000"
  },
  {
    "text": "that okay uh Windows NT has uh a lot of great uh",
    "start": "176360",
    "end": "183840"
  },
  {
    "text": "built-in uh audit facilities however they don't have uh a lot of good tools for uh",
    "start": "183840",
    "end": "189920"
  },
  {
    "text": "reading uh looking through those logs so I wrote this little tool called n last",
    "start": "189920",
    "end": "195400"
  },
  {
    "text": "uh totally snarfed it from the Unix last um any Unix people here will be totally familiar with it however it's pretty new",
    "start": "195400",
    "end": "202319"
  },
  {
    "text": "to uh NT people I don't know a lot of um ant people who do a lot of actual",
    "start": "202319",
    "end": "208000"
  },
  {
    "text": "reading of the audit log so um if you've ever tried and you used a little uh",
    "start": "208000",
    "end": "213400"
  },
  {
    "text": "gooey event log viewer um you might be a little bit frustrated um this is something I wrote",
    "start": "213400",
    "end": "220040"
  },
  {
    "text": "that grabs a little bit more information puts it together uh reads a little bit more information um so go over an overview of",
    "start": "220040",
    "end": "227799"
  },
  {
    "text": "that I'll introduce it um the reasons I wrote it are speed uh",
    "start": "227799",
    "end": "235920"
  },
  {
    "start": "230000",
    "end": "261000"
  },
  {
    "text": "cuts down my search time dramatically um automates it eliminates a lot of hassle",
    "start": "235920",
    "end": "243480"
  },
  {
    "text": "um going back and looking through an audit logs uh not usually too happy with",
    "start": "243480",
    "end": "248599"
  },
  {
    "text": "uh matching up the heximal ID so um it helps out a lot there uh so these are",
    "start": "248599",
    "end": "254680"
  },
  {
    "text": "the reasons I wrote it hopefully if you you use it uh you'll feel the",
    "start": "254680",
    "end": "260560"
  },
  {
    "start": "261000",
    "end": "359000"
  },
  {
    "text": "same the biggest thing that I wrote it or um uh one of the things that interested me the most was I didn't have",
    "start": "264160",
    "end": "270320"
  },
  {
    "text": "a way with NT there was no way to match up log on times with log off times so",
    "start": "270320",
    "end": "275440"
  },
  {
    "text": "that's one of the things that n last does um is it goes through matches log",
    "start": "275440",
    "end": "280840"
  },
  {
    "text": "on times with log off times and gives me some kind of time frame that I can look for uh file activity um and it's the",
    "start": "280840",
    "end": "286680"
  },
  {
    "text": "only way I know of to do this under NT",
    "start": "286680",
    "end": "290639"
  },
  {
    "text": "so uh how it works it just basically uh reads uh the anti audit log",
    "start": "293919",
    "end": "300759"
  },
  {
    "text": "um uh puts the information together um the three things that it",
    "start": "300759",
    "end": "306280"
  },
  {
    "text": "helps me do uh that I find faster it does faster than with the uh Event",
    "start": "306280",
    "end": "311720"
  },
  {
    "text": "Viewer is quickly displaying who logged on and when how long they were logged on",
    "start": "311720",
    "end": "317160"
  },
  {
    "text": "uh log on failures and most specifically it helps me really clearly see what machine they came from um usually it's",
    "start": "317160",
    "end": "323720"
  },
  {
    "text": "pretty hard to tell uh if someone's connecting to your remote shares um",
    "start": "323720",
    "end": "329080"
  },
  {
    "text": "where they're coming from so anas does that pretty pretty",
    "start": "329080",
    "end": "334319"
  },
  {
    "text": "easily um I'm going to give some shots of uh n last year and you can see it um",
    "start": "335560",
    "end": "341120"
  },
  {
    "text": "but one thing I wanted to bring up really quickly is uh in all the things I've seen this is a really really common",
    "start": "341120",
    "end": "347800"
  },
  {
    "text": "error um I've seen this really really widespread uh some of you may think this is a no-brainer but I see it so often",
    "start": "347800",
    "end": "355199"
  },
  {
    "text": "that I wanted to bring it up um",
    "start": "355199",
    "end": "360240"
  },
  {
    "start": "359000",
    "end": "396000"
  },
  {
    "text": "that is this situation when you're when you're setting auditing on Windows NT uh",
    "start": "361520",
    "end": "367039"
  },
  {
    "text": "you'll set up you'll go to this uh uh audit dialogue box this is a particular",
    "start": "367039",
    "end": "373680"
  },
  {
    "text": "um this document and you select the users that you want you select the",
    "start": "373680",
    "end": "379039"
  },
  {
    "text": "attributes that you're auditing for uh you click on the first name you set it up that looks great you hit the",
    "start": "379039",
    "end": "386240"
  },
  {
    "text": "okay button and you go on to your next task uh the only problem is is that it",
    "start": "386240",
    "end": "391479"
  },
  {
    "text": "looks like you've set those attributes for the first three guys but you",
    "start": "391479",
    "end": "397000"
  },
  {
    "start": "396000",
    "end": "443000"
  },
  {
    "text": "haven't what you end up with is this nothing has been set for the domain",
    "start": "397479",
    "end": "402759"
  },
  {
    "text": "admins and nothing has been set for domain users so when you're doing this on a wide",
    "start": "402759",
    "end": "410160"
  },
  {
    "text": "scale um you basically now have a bunch of nothing so you think You' you've set up",
    "start": "410160",
    "end": "416360"
  },
  {
    "text": "uh uh an audit system and and when you go back and look at this a couple months later you have actually no information",
    "start": "416360",
    "end": "423319"
  },
  {
    "text": "recorded uh the bummer about NT is it's got this great thing uh to do this",
    "start": "423319",
    "end": "429319"
  },
  {
    "text": "microscopic uh auditing but there's no way to go back and double check your work unless you actually go back",
    "start": "429319",
    "end": "435280"
  },
  {
    "text": "doubleclick on all of these things you have no way of knowing whether whether this worked or not and that's really",
    "start": "435280",
    "end": "441639"
  },
  {
    "text": "kind of a drag um I didn't have a slide up here",
    "start": "441639",
    "end": "447280"
  },
  {
    "start": "443000",
    "end": "505000"
  },
  {
    "text": "for it but I wrote a free tool that's on on my site you can grab it um it's a",
    "start": "447280",
    "end": "452440"
  },
  {
    "text": "little command line tool called audited and it will go through and it will read all of your files um and let you know",
    "start": "452440",
    "end": "458879"
  },
  {
    "text": "whether or not the audit bits been set and what attributes you're auditing so uh you can run it it'll really quickly",
    "start": "458879",
    "end": "465000"
  },
  {
    "text": "tell you um what actually is being audited so it's a it's a good way and a",
    "start": "465000",
    "end": "470080"
  },
  {
    "text": "fast way to double check your work um I didn't have a slide up here but uh if you go to my site um uh www.n",
    "start": "470080",
    "end": "478440"
  },
  {
    "text": "objectives. comom uh you can find it okay probably one of the biggest",
    "start": "478440",
    "end": "484759"
  },
  {
    "text": "questions I get about nlas is why doesn't it work um to work uh auditing",
    "start": "484759",
    "end": "491080"
  },
  {
    "text": "has to be already turned on and you have to have events in it for it to read um it doesn't do any good to run any last",
    "start": "491080",
    "end": "497360"
  },
  {
    "text": "against an empty log um and you have no idea how many emails I",
    "start": "497360",
    "end": "503400"
  },
  {
    "text": "get on that okay here's a little bit about uh",
    "start": "503400",
    "end": "509840"
  },
  {
    "start": "505000",
    "end": "577000"
  },
  {
    "text": "setting it up um these are some of the switches uh if you run this at the",
    "start": "509840",
    "end": "516279"
  },
  {
    "text": "command line uh n last- f-i uh grabs the last 10 log on",
    "start": "516279",
    "end": "522680"
  },
  {
    "text": "failures uh interactively um NT last-",
    "start": "522680",
    "end": "528760"
  },
  {
    "text": "f-r uh dn25 grabs the less failed remote logons telling you how many people tried",
    "start": "528760",
    "end": "534560"
  },
  {
    "text": "to connect from some other machine cheers um the third one anti last- I uh-",
    "start": "534560",
    "end": "542720"
  },
  {
    "text": "not administrator shows you the last 10 interactive logons besides administrator",
    "start": "542720",
    "end": "547760"
  },
  {
    "text": "um you can substitute administrator with any user whatever what whoever you want to exclude from your list",
    "start": "547760",
    "end": "555120"
  },
  {
    "text": "um and uh one of the most useful things is this last one uh nl- m-",
    "start": "555120",
    "end": "562399"
  },
  {
    "text": "f-r uh grabs the last 10 failed remote attempts against uh another machine so",
    "start": "562399",
    "end": "568880"
  },
  {
    "text": "if you're sitting at your console you can use this to scan your network and grab all the other machines so",
    "start": "568880",
    "end": "577360"
  },
  {
    "text": "um okay uh failures are indicated by single value of 528 that also has a",
    "start": "584640",
    "end": "591600"
  },
  {
    "text": "little little lock thing on it um but when you're looking at really large um",
    "start": "591600",
    "end": "597959"
  },
  {
    "text": "event logs um it's pretty hard to to look through and grab all those things also it's hard to the little lock",
    "start": "597959",
    "end": "604079"
  },
  {
    "text": "doesn't always help you distinguish because there's other failures that show up as a lock and you don't exactly know",
    "start": "604079",
    "end": "609399"
  },
  {
    "text": "uh which is which so then you have to go look for the 528 and I find that a bit",
    "start": "609399",
    "end": "614519"
  },
  {
    "text": "painful so um uh personally the- sft the- F switch",
    "start": "614519",
    "end": "620920"
  },
  {
    "text": "is uh I just live with that",
    "start": "620920",
    "end": "625360"
  },
  {
    "text": "thing um okay here it is an actual use use um I ran this against a box",
    "start": "625959",
    "end": "635639"
  },
  {
    "text": "um uh and what it do it grabbed all the the remote failures generates this list",
    "start": "635639",
    "end": "641000"
  },
  {
    "text": "this is a partial list um and so kind of what you see is it's going through uh a",
    "start": "641000",
    "end": "646040"
  },
  {
    "text": "couple different people um three at a time uh the last one got cut off but if you look at the",
    "start": "646040",
    "end": "653480"
  },
  {
    "text": "uh the time syns they're all very very close together and so kind of what this shows this is an example of",
    "start": "653480",
    "end": "659760"
  },
  {
    "text": "uh some automated password guessing and what they're what it looks like they're doing is they're not trying to um guess",
    "start": "659760",
    "end": "665399"
  },
  {
    "text": "too much at one time they're not trying to trigger out any any lockouts um you guess a couple of these every day",
    "start": "665399",
    "end": "671079"
  },
  {
    "text": "looking for some common dictionary words um if you ran this for a month it stands",
    "start": "671079",
    "end": "676800"
  },
  {
    "text": "a pretty good chance of uh squeaking by without anybody noticing so",
    "start": "676800",
    "end": "683160"
  },
  {
    "text": "um anyway this switch is pretty useful for helping you try to to look at information like that",
    "start": "683160",
    "end": "691240"
  },
  {
    "text": "um pretty much when I do my work I I just uh redirected out to to a file so I",
    "start": "696279",
    "end": "701320"
  },
  {
    "text": "can uh be collecting my results um that was one of the other things that that caused me to write a tool was uh saving",
    "start": "701320",
    "end": "707480"
  },
  {
    "text": "stuff to a file um then I can load it into Excel or something if I want to do more",
    "start": "707480",
    "end": "713959"
  },
  {
    "text": "analysis uh one thing I think Nas is pretty good at at doing is finding",
    "start": "713959",
    "end": "720320"
  },
  {
    "text": "Oddball situations like here I find it it's easier to view information uh this way than it is",
    "start": "720320",
    "end": "726880"
  },
  {
    "text": "through uh The Event Viewer for instance it helps me to see uh each person",
    "start": "726880",
    "end": "732000"
  },
  {
    "text": "logging on from their from their own machine uh you have like the C Renfield guy from his machine um however you",
    "start": "732000",
    "end": "739720"
  },
  {
    "text": "notice it's pretty easy to see all of a sudden we have this Renfield guy logging on from Susan's machine um and that's",
    "start": "739720",
    "end": "746959"
  },
  {
    "text": "odd that may be normal uh it may be an administrator may be someone um who has the password who's",
    "start": "746959",
    "end": "754040"
  },
  {
    "text": "legitimately doing some work connecting through uh net use or whatever or it may",
    "start": "754040",
    "end": "759480"
  },
  {
    "text": "be odd you also notice the time was the admin there at 12:47 a.m. in the",
    "start": "759480",
    "end": "765120"
  },
  {
    "text": "morning uh so then you have to decide for yourself but at least it helps you see it at least I find uh it helps me",
    "start": "765120",
    "end": "771120"
  },
  {
    "text": "see it a lot",
    "start": "771120",
    "end": "774040"
  },
  {
    "text": "easier okay here's uh something else that um I feel this",
    "start": "776920",
    "end": "782959"
  },
  {
    "text": "tool helps uh helps me see really easily if you notice starting down at",
    "start": "782959",
    "end": "788079"
  },
  {
    "text": "the bottom uh you see Thomas logging on from his machine see Brian M logging on",
    "start": "788079",
    "end": "793720"
  },
  {
    "text": "from his machine uh you see Thomas logging in from a different machine uh when you get towards the top",
    "start": "793720",
    "end": "802279"
  },
  {
    "text": "all of a sudden you see Brian M logging on from this machine that no one's ever heard of okay well that's that's a bit",
    "start": "802279",
    "end": "808880"
  },
  {
    "text": "odd so if you look at the time stamps you'll see Brian M logging on uh April",
    "start": "808880",
    "end": "815040"
  },
  {
    "text": "22nd at 202 and then you get this Oddball log on you know uh 15 days later um so on the",
    "start": "815040",
    "end": "824199"
  },
  {
    "text": "second April second uh the password hash went out over the wire and now 12 days",
    "start": "824199",
    "end": "829279"
  },
  {
    "text": "later uh someone else is logging in so it's pretty strong evidence of a sniffed password and you know that could be",
    "start": "829279",
    "end": "836040"
  },
  {
    "text": "about the time it takes for uh the password for it to fall to like LOF crack or something",
    "start": "836040",
    "end": "842160"
  },
  {
    "text": "um so I find this is a pretty easy way to to help me kind of see these kinds of problems um God I don't even know how",
    "start": "842160",
    "end": "850079"
  },
  {
    "text": "many people have Loft crack running at Intel",
    "start": "850079",
    "end": "854279"
  },
  {
    "text": "but uh okay here we're establishing a time",
    "start": "855720",
    "end": "862800"
  },
  {
    "text": "frame um using n- r-u uh username now that I've noticed",
    "start": "862800",
    "end": "869560"
  },
  {
    "text": "that this guy is uh logging in in a non-legitimate way I want to try and",
    "start": "869560",
    "end": "874680"
  },
  {
    "text": "find out um what he's been doing so I grab a list of of some of his",
    "start": "874680",
    "end": "880839"
  },
  {
    "text": "accesses the day I see him uh logging on on these days at these",
    "start": "880839",
    "end": "886000"
  },
  {
    "text": "times uh now I have something that's um worth going",
    "start": "886000",
    "end": "891639"
  },
  {
    "text": "after now that I have an actual time uh a Kick n last into verbose verbose mode",
    "start": "895920",
    "end": "902279"
  },
  {
    "text": "which is using the V switch um and now I get my time frames what this does is uh",
    "start": "902279",
    "end": "908800"
  },
  {
    "text": "in the middle of the slide here you see the log on and log off and now I have a 35-minute window uh where this guy was",
    "start": "908800",
    "end": "916199"
  },
  {
    "text": "um on the system so now I at least have something to look for you know maybe if he hasn't covered his tracks I'll find",
    "start": "916199",
    "end": "922680"
  },
  {
    "text": "some clue or something so uh I was really frustrated that um I wasn't able",
    "start": "922680",
    "end": "928240"
  },
  {
    "text": "to do this so so this little bit right here is probably pretty much the reason why I wrote this",
    "start": "928240",
    "end": "934720"
  },
  {
    "start": "936000",
    "end": "976000"
  },
  {
    "text": "thing once you actually get um uh a time frame you want to try and start looking",
    "start": "939120",
    "end": "946600"
  },
  {
    "text": "or uh looking at the first possible possible activity so uh I'm going to go after the first",
    "start": "946600",
    "end": "953680"
  },
  {
    "text": "day and I'm going to try and see if I get with any luck if I can see what he did on the first day what he might have",
    "start": "953680",
    "end": "959519"
  },
  {
    "text": "left for himself and then uh look at the the final day he was here and see what",
    "start": "959519",
    "end": "964839"
  },
  {
    "text": "uh what he left so I'm going to try and go from the first activity to the last",
    "start": "964839",
    "end": "970680"
  },
  {
    "text": "activity you also have to be prepared you may not find anything uh andt a pretty noisy operating",
    "start": "970720",
    "end": "977319"
  },
  {
    "start": "976000",
    "end": "1065000"
  },
  {
    "text": "system the advantage of that is um uh someone who's trying to clean up their",
    "start": "977319",
    "end": "983440"
  },
  {
    "text": "footsteps and he so noisy that they may forget something the disadvantage is is it's so noisy that that uh looking for",
    "start": "983440",
    "end": "989880"
  },
  {
    "text": "stuff is somewhat of problematic at times so when you're searching for files uh",
    "start": "989880",
    "end": "998040"
  },
  {
    "text": "you have to rule out normal system file activity um and there's really in order to do that you really",
    "start": "998040",
    "end": "1004319"
  },
  {
    "text": "just kind of need to to spend some time examining your system so you know what normal file system activity is um I use",
    "start": "1004319",
    "end": "1010959"
  },
  {
    "text": "a handle x uh from the CIS internals guys it's a really really great tool for",
    "start": "1010959",
    "end": "1017240"
  },
  {
    "text": "uh seeing what processes are running what files are being accessed by what DLS um and it's just I know very very",
    "start": "1017240",
    "end": "1025918"
  },
  {
    "text": "invaluable Tool uh okay without using any specialized tools uh just",
    "start": "1025919",
    "end": "1033319"
  },
  {
    "text": "basically uh making use of nt's built-in stuff um here's three commands that I",
    "start": "1033319",
    "end": "1039280"
  },
  {
    "text": "probably never see uh anyone in the N world do too much um but that's uh the",
    "start": "1039280",
    "end": "1045120"
  },
  {
    "text": "dur /t colon c switch uh the W and the a and these just list out the uh creation",
    "start": "1045120",
    "end": "1052400"
  },
  {
    "text": "times uh the right times and the access time so I'm going to try and find something that was uh created or",
    "start": "1052400",
    "end": "1059559"
  },
  {
    "text": "accessed um during the time that this guy was on the",
    "start": "1059559",
    "end": "1064320"
  },
  {
    "text": "system and again with luck we'll we'll find what we're looking",
    "start": "1067039",
    "end": "1072360"
  },
  {
    "text": "for oh sorry I clicked through that last one probably one of the um I see people",
    "start": "1074559",
    "end": "1080320"
  },
  {
    "text": "do this a lot a lot of people aren't aware of um if you're looking through your files don't use Explorer it's just",
    "start": "1080320",
    "end": "1086240"
  },
  {
    "text": "it's not your friend if you if you're trying to look at a file and explore and you right click on it and you look at",
    "start": "1086240",
    "end": "1093120"
  },
  {
    "text": "properties it changes the access time to when you just clicked on it so it that",
    "start": "1093120",
    "end": "1098280"
  },
  {
    "text": "destroys your evidence of access time if that's what you're looking",
    "start": "1098280",
    "end": "1103120"
  },
  {
    "text": "for so here we get lucky uh and we see",
    "start": "1103640",
    "end": "1109280"
  },
  {
    "text": "that we have a file uh that was created uh during the time frame that",
    "start": "1109280",
    "end": "1117080"
  },
  {
    "text": "that guy was logged on so now you want to go examine that file",
    "start": "1117080",
    "end": "1123159"
  },
  {
    "text": "um if you spend some time experimenting with the files uh like when n is first",
    "start": "1123159",
    "end": "1129720"
  },
  {
    "text": "installed you may be able to have like some list or some comparison of going back and looking at what was first",
    "start": "1129720",
    "end": "1135120"
  },
  {
    "text": "installed versus what there's now and this assuming of course you haven't installed the super hiip trip wire to do",
    "start": "1135120",
    "end": "1140159"
  },
  {
    "text": "all these changes for you um so if you look at this file this file",
    "start": "1140159",
    "end": "1147799"
  },
  {
    "text": "is called wind old app.exe um and there is no such thing however there is a",
    "start": "1147799",
    "end": "1153240"
  },
  {
    "text": "legitimate file called wind old app. mod so you can see this is is very similar",
    "start": "1153240",
    "end": "1158600"
  },
  {
    "text": "and it really doesn't look out of place if you're looking through a list of NT files um there's a really good chance",
    "start": "1158600",
    "end": "1164400"
  },
  {
    "text": "that you're going to miss this there's a lot of files um and it's pretty painstaking to to to go through all",
    "start": "1164400",
    "end": "1169880"
  },
  {
    "text": "these things uh and try and sort out these differences um so anyway this just kind",
    "start": "1169880",
    "end": "1176360"
  },
  {
    "text": "of shows uh something that's out of place but doesn't look out of place",
    "start": "1176360",
    "end": "1181919"
  },
  {
    "start": "1184000",
    "end": "1229000"
  },
  {
    "text": "really I probably couldn't live without grep and uh uh strings so if anyone um",
    "start": "1186440",
    "end": "1193760"
  },
  {
    "text": "uh doesn't know this um sis.com has free versions of uh strings and GP you can",
    "start": "1193760",
    "end": "1199919"
  },
  {
    "text": "grab it um running strings on this executable basically list all the API",
    "start": "1199919",
    "end": "1206799"
  },
  {
    "text": "calls this is a partial list so you can see that this particular exe um has the",
    "start": "1206799",
    "end": "1212000"
  },
  {
    "text": "ability to connect back out and uh do some uh daal checking so",
    "start": "1212000",
    "end": "1220039"
  },
  {
    "text": "um doesn't really look like a normal system file so uh pretty much looks like your",
    "start": "1220039",
    "end": "1226280"
  },
  {
    "text": "culprit",
    "start": "1226280",
    "end": "1229280"
  },
  {
    "start": "1229000",
    "end": "1263000"
  },
  {
    "text": "okay this is uh just a reminder of uh you know different types of of problems",
    "start": "1237159",
    "end": "1242919"
  },
  {
    "text": "that you run into you're just not always going to find uh the exact time frames you're looking on either the system May",
    "start": "1242919",
    "end": "1248559"
  },
  {
    "text": "modify it um modify the times um the user may clean up after",
    "start": "1248559",
    "end": "1254400"
  },
  {
    "text": "himself um so you just have to deal with those problems best",
    "start": "1254400",
    "end": "1259559"
  },
  {
    "text": "can luck does play into some things a little",
    "start": "1259559",
    "end": "1264320"
  },
  {
    "start": "1263000",
    "end": "1429000"
  },
  {
    "text": "bit okay this is really kind of what I wanted to uh wanted to talk",
    "start": "1265360",
    "end": "1271200"
  },
  {
    "text": "about um this is a pretty interesting list um of some access",
    "start": "1271200",
    "end": "1278120"
  },
  {
    "text": "times and it shows that when word ran what's missing from this list is the",
    "start": "1278120",
    "end": "1285159"
  },
  {
    "text": "uh Ms idol. dll um",
    "start": "1285159",
    "end": "1290520"
  },
  {
    "text": "right Ms idol. dll is uh the Microsoft guey hook that runs in all of The Office",
    "start": "1291799",
    "end": "1297400"
  },
  {
    "text": "Products and it runs it's loaded whenever you load any office product um",
    "start": "1297400",
    "end": "1303799"
  },
  {
    "text": "using interactive log on and you're working with it and what it is it's a hook that detects keyboard activity so",
    "start": "1303799",
    "end": "1309320"
  },
  {
    "text": "it knows when the gooey is active and if it isn't uh it just uh at that time you",
    "start": "1309320",
    "end": "1314880"
  },
  {
    "text": "know Winward says okay the user is not doing anything I'll do my background task if you run Winward remotely uh pop it up",
    "start": "1314880",
    "end": "1322679"
  },
  {
    "text": "through dcom this dll doesn't get loaded so what I know from this list is that",
    "start": "1322679",
    "end": "1329240"
  },
  {
    "text": "someone launched my wiw remotely and you'll never see it unless you look in the task",
    "start": "1329240",
    "end": "1334640"
  },
  {
    "text": "list so um what I have to do now is I have to go",
    "start": "1334640",
    "end": "1340919"
  },
  {
    "text": "back and look at my decom permissions um I I know at least at least 100 professional",
    "start": "1340919",
    "end": "1347600"
  },
  {
    "text": "administrators and not one of them knows how to set or really anything about decom permissions um it's not in any",
    "start": "1347600",
    "end": "1354679"
  },
  {
    "text": "book and it's not in any of the uh uh security papers I've read um the the",
    "start": "1354679",
    "end": "1361799"
  },
  {
    "text": "Navy ant security paper yeah go ahead there's a whole buch of information about",
    "start": "1361799",
    "end": "1369520"
  },
  {
    "text": "ISS you must be David",
    "start": "1370039",
    "end": "1373799"
  },
  {
    "text": "LeBlanc we had some heated email last week so I hope he's forgiven",
    "start": "1375799",
    "end": "1382039"
  },
  {
    "text": "me um cool make that information more available because it's not very well",
    "start": "1382039",
    "end": "1388600"
  },
  {
    "text": "known um okay uh a lot of people just aren't",
    "start": "1388600",
    "end": "1395919"
  },
  {
    "text": "aware that that uh Microsoft Word can be popped up in the background without them knowing it it's it's really easy uh if I",
    "start": "1395919",
    "end": "1404159"
  },
  {
    "text": "have the right permissions I can sit on my machine uh I can pop up whenw on your machine and with word basic uh you really don't",
    "start": "1404159",
    "end": "1412000"
  },
  {
    "text": "need um uh back office you can with the exception of",
    "start": "1412000",
    "end": "1417960"
  },
  {
    "text": "popping this the CD ROM in and out you can pretty much do just about anything you want with word basic you can uh",
    "start": "1417960",
    "end": "1424600"
  },
  {
    "text": "pretty much have total control of the file",
    "start": "1424600",
    "end": "1428320"
  },
  {
    "start": "1429000",
    "end": "1490000"
  },
  {
    "text": "system the trouble with finding decom permissions is that um uh you don't look in the usual place",
    "start": "1432159",
    "end": "1438440"
  },
  {
    "text": "places I I don't know many admins who are familiar with dcom config uh or have",
    "start": "1438440",
    "end": "1444279"
  },
  {
    "text": "uh the tool that developers have Olay view uh for looking at things um or",
    "start": "1444279",
    "end": "1450400"
  },
  {
    "text": "knowing to go to the classes key in regge edit and checking out what's",
    "start": "1450400",
    "end": "1457039"
  },
  {
    "text": "there okay the other thing is that Decon permiss you're not going to find anything related in user manager perm so",
    "start": "1458840",
    "end": "1465679"
  },
  {
    "text": "if you're used to going there uh if you suspect um uh you know someone may have been added",
    "start": "1465679",
    "end": "1470799"
  },
  {
    "text": "to your list that you don't know about so you want to go to user manager check out your list and the permissions that",
    "start": "1470799",
    "end": "1475919"
  },
  {
    "text": "various people have it's not going to help you it's there's no information listed there",
    "start": "1475919",
    "end": "1482039"
  },
  {
    "text": "so and that's that's really the only place that most uh ENT people or ENT",
    "start": "1482039",
    "end": "1487880"
  },
  {
    "text": "admins know where to check so uh this came out a little bit uh",
    "start": "1487880",
    "end": "1495080"
  },
  {
    "start": "1490000",
    "end": "1611000"
  },
  {
    "text": "distorted um what you're looking at um this is Olay View and it usually",
    "start": "1495080",
    "end": "1501799"
  },
  {
    "text": "comes with the developers kit and it gives a list of all um the com",
    "start": "1501799",
    "end": "1507840"
  },
  {
    "text": "applications uh that are on your machine over on the right can you guys see that is it",
    "start": "1507840",
    "end": "1515640"
  },
  {
    "text": "readable okay the key here is the launch's interactive user been set and uh really",
    "start": "1515640",
    "end": "1523279"
  },
  {
    "text": "really very few people know what that means so what that means is that Microsoft",
    "start": "1523279",
    "end": "1529120"
  },
  {
    "text": "Word is set to be launched as the interactive user so whoever is logged on",
    "start": "1529120",
    "end": "1534960"
  },
  {
    "text": "at your machine uh at the keyboard so if the administrator is logged on as um at the",
    "start": "1534960",
    "end": "1541559"
  },
  {
    "text": "keyboard and it's pretty easy to find that out you can just do a net stat a or MBT stat a sorry um find out that he's",
    "start": "1541559",
    "end": "1549240"
  },
  {
    "text": "logged on and then you can launch Winward and it's now running with administrative privileges",
    "start": "1549240",
    "end": "1557398"
  },
  {
    "text": "here is um uh let's see oh there's the",
    "start": "1561399",
    "end": "1567360"
  },
  {
    "text": "launch permissions uh the activation permissions access permissions um here",
    "start": "1567360",
    "end": "1573159"
  },
  {
    "text": "it shows uh the group that's been accessed or or added uh to give",
    "start": "1573159",
    "end": "1578480"
  },
  {
    "text": "themselves permission so what this means is um the the Aurora domain guests can",
    "start": "1578480",
    "end": "1584480"
  },
  {
    "text": "launch this program and when it launch it's not going to run uh as a administrator so now there's a pretty",
    "start": "1584480",
    "end": "1591120"
  },
  {
    "text": "large hole um in your NT system it can be easily closed it's not like a",
    "start": "1591120",
    "end": "1596760"
  },
  {
    "text": "security weakness the problem is is that there's only two places you can see this information either uh in this tool or go",
    "start": "1596760",
    "end": "1603240"
  },
  {
    "text": "in the registry and look at it yourself um but just not a lot of people know how",
    "start": "1603240",
    "end": "1608600"
  },
  {
    "text": "to do that so here's just kind of a list of",
    "start": "1608600",
    "end": "1615520"
  },
  {
    "start": "1611000",
    "end": "1675000"
  },
  {
    "text": "how someone uh could could look at your machine machine in a different way someone's sitting on u a remote box they",
    "start": "1615520",
    "end": "1623080"
  },
  {
    "text": "do a MBT stat uh find out when the administrators logged on uh you can",
    "start": "1623080",
    "end": "1628279"
  },
  {
    "text": "remotely launch uh Winward uh it's not going to run under full admin privileges",
    "start": "1628279",
    "end": "1636480"
  },
  {
    "text": "um and it it pretty much serves as a back door if if this was left set up this way and uh let's say as an",
    "start": "1636480",
    "end": "1643760"
  },
  {
    "text": "administrator you suspect that um you know there's some password compromises so you go through and you change",
    "start": "1643760",
    "end": "1648880"
  },
  {
    "text": "everyone's password um they're not going to be able to log on to what what you just did was",
    "start": "1648880",
    "end": "1655760"
  },
  {
    "text": "you just prevented them from logging on to your shares however they can now log in",
    "start": "1655760",
    "end": "1661360"
  },
  {
    "text": "through dcom and with word basic uh they can still read all your files so uh you",
    "start": "1661360",
    "end": "1668399"
  },
  {
    "text": "need to be aware that this is a potential back door",
    "start": "1668399",
    "end": "1673080"
  },
  {
    "start": "1675000",
    "end": "1790000"
  },
  {
    "text": "okay I think this is what dominic was talking about and uh this isn't really any uh great discovery um it's pretty",
    "start": "1678480",
    "end": "1686559"
  },
  {
    "text": "it's it's documented um 132 um hooking process however I think",
    "start": "1686559",
    "end": "1693600"
  },
  {
    "text": "there's an advantage that I think there's a larger majority of Unix admins who are also programmers where that isn't really true for uh NT",
    "start": "1693600",
    "end": "1701960"
  },
  {
    "text": "admins I've never seen this key listed in any security um documentation what's",
    "start": "1701960",
    "end": "1708320"
  },
  {
    "text": "whatsoever but what this key does it's blank by default however if you list um",
    "start": "1708320",
    "end": "1716000"
  },
  {
    "text": "a D in app inore DLS it will load that dll into every uh interactive guey",
    "start": "1716000",
    "end": "1722399"
  },
  {
    "text": "process that that pops up I've never seen it used uh by any legitimate app",
    "start": "1722399",
    "end": "1729120"
  },
  {
    "text": "uh um what are some of the common uh large scale backup programs or whatever",
    "start": "1729120",
    "end": "1734360"
  },
  {
    "text": "but I've never seen it used so if you're looking for evidence and you're trying to see what someone's",
    "start": "1734360",
    "end": "1739880"
  },
  {
    "text": "done to your system uh you might want to check out this key if there's something there it's um very possibly a",
    "start": "1739880",
    "end": "1748960"
  },
  {
    "text": "problem the interesting thing about this key is that um when n starts it will read this",
    "start": "1748960",
    "end": "1756200"
  },
  {
    "text": "key and the value is saved in kernel mode whenever it's requested by any user",
    "start": "1756200",
    "end": "1761279"
  },
  {
    "text": "32 programs uh that value is read and the dll is loaded however you can erase the",
    "start": "1761279",
    "end": "1768360"
  },
  {
    "text": "key and you go back and look at it and you're not going to see it so someone could uh use this to launch their",
    "start": "1768360",
    "end": "1773720"
  },
  {
    "text": "process delete it cover their tracks the dll is still going to load um and it's",
    "start": "1773720",
    "end": "1778760"
  },
  {
    "text": "going to be harder for you to find so its effect stays in place until it's",
    "start": "1778760",
    "end": "1785519"
  },
  {
    "text": "rebooted hopefully someone will put this in their",
    "start": "1786080",
    "end": "1790440"
  },
  {
    "start": "1790000",
    "end": "1929000"
  },
  {
    "text": "guidelines uh another thing people aren't very aware of are are hooks uh hooks allow the loading of DLS into",
    "start": "1793120",
    "end": "1799440"
  },
  {
    "text": "every um guey process um and this means a keyboard",
    "start": "1799440",
    "end": "1804600"
  },
  {
    "text": "clipboard Interceptor uh an example is pgp uh a lot of people aren't aware that",
    "start": "1804600",
    "end": "1810799"
  },
  {
    "text": "pgp hooks uh a dll into every process space um and again handle X is a really",
    "start": "1810799",
    "end": "1817840"
  },
  {
    "text": "really good tool for seeing this I think the next slide shows that oh man that's awful",
    "start": "1817840",
    "end": "1826159"
  },
  {
    "text": "um okay if you could is this very clear to you guys it looks horrible here",
    "start": "1826159",
    "end": "1832440"
  },
  {
    "text": "um okay what this shows",
    "start": "1832440",
    "end": "1837080"
  },
  {
    "text": "is I think this is uh Outlook was the one I I highlighted um but on the blue",
    "start": "1838080",
    "end": "1845840"
  },
  {
    "text": "bar you see the the pgp dll in there",
    "start": "1845840",
    "end": "1851679"
  },
  {
    "text": "um and it shows it in Windward so you can see that this is injected into Windward and that's how pgp does its",
    "start": "1852799",
    "end": "1859480"
  },
  {
    "text": "really cool you know copy your text to the clipboard um however uh it's really",
    "start": "1859480",
    "end": "1865240"
  },
  {
    "text": "easy to write write a hook um anyone can do anything I mean it's uh if you're",
    "start": "1865240",
    "end": "1871399"
  },
  {
    "text": "trying to um it's it's much easier to do it this way than to try to write the traditional Unix Trojan type deal you",
    "start": "1871399",
    "end": "1879000"
  },
  {
    "text": "can just write a hook it'll inject in it'll intercept all uh keystrokes um you",
    "start": "1879000",
    "end": "1884159"
  },
  {
    "text": "saw that other program the other program could send it back to you and there you",
    "start": "1884159",
    "end": "1891278"
  },
  {
    "text": "go this is kind of interesting because uh it shows uh command. exe running in",
    "start": "1891360",
    "end": "1898159"
  },
  {
    "text": "the same situation as all those other programs however you do not see the hook DL listed um the interesting thing about",
    "start": "1898159",
    "end": "1905039"
  },
  {
    "text": "this is it forms a a small amount of protection if that was a hook dll that was doing some type of spying um I can",
    "start": "1905039",
    "end": "1912679"
  },
  {
    "text": "run command exe and do some command line stuff and in this particular case the hook isn't intercepting my call so uh",
    "start": "1912679",
    "end": "1919960"
  },
  {
    "text": "that's worth noting and uh worth possibly",
    "start": "1919960",
    "end": "1924840"
  },
  {
    "start": "1929000",
    "end": "2046000"
  },
  {
    "text": "using okay a lot of other people don't really know about Gina replacement",
    "start": "1931639",
    "end": "1938039"
  },
  {
    "text": "um this key right here uh shows the value of uh the Microsoft G DL is",
    "start": "1938039",
    "end": "1944440"
  },
  {
    "text": "responsible for doing your log on a lot of people are very surprised to learn that um you can add another value there",
    "start": "1944440",
    "end": "1951120"
  },
  {
    "text": "and replace it uh the legitimate value of that is if someone wants to do like you know a thumb log on or something",
    "start": "1951120",
    "end": "1959039"
  },
  {
    "text": "um that's how they do it to bypass the standard uh log on and now you like some type of IID um the the bad use of that",
    "start": "1959039",
    "end": "1967799"
  },
  {
    "text": "is that if someone if you go and you look at this and there's another dll there um you you need to investigate it",
    "start": "1967799",
    "end": "1975519"
  },
  {
    "text": "because you need to know what that D is doing um uh Greg hogland has uh the root",
    "start": "1975519",
    "end": "1981200"
  },
  {
    "text": "kit. uh root kit.com site and uh one of the things that's on there is a Trojan",
    "start": "1981200",
    "end": "1988799"
  },
  {
    "text": "dll basically what it does is all it does is it's really really very simple",
    "start": "1988799",
    "end": "1994039"
  },
  {
    "text": "all it does is it's kind of like a pass through dll and uh it forwards all the calls to",
    "start": "1994039",
    "end": "2000919"
  },
  {
    "text": "the original Gina it's loaded by this wind key and then but as a password",
    "start": "2000919",
    "end": "2006240"
  },
  {
    "text": "comes in it just uh captures the password savs it to a text file and then calls the original dll so and again you",
    "start": "2006240",
    "end": "2013320"
  },
  {
    "text": "can erase the key value so it's a little bit harder to detect and I think it's a little bit more uh Insidious than an",
    "start": "2013320",
    "end": "2020840"
  },
  {
    "text": "actual troan um the one thing about Trojans under NT is they don't seem to work really well because NT is so",
    "start": "2020840",
    "end": "2028000"
  },
  {
    "text": "fragile um it just kind of breaks really quickly um Unix functions really really",
    "start": "2028000",
    "end": "2033679"
  },
  {
    "text": "well with tons of Trojans you can install root kit 3 have you know all these commands Trojan and Unix just",
    "start": "2033679",
    "end": "2040320"
  },
  {
    "text": "keeps running uh I don't think you're going to find that happening under",
    "start": "2040320",
    "end": "2045360"
  },
  {
    "start": "2046000",
    "end": "2227000"
  },
  {
    "text": "nt Okay this is something I consider pretty important um NT is a very noisy",
    "start": "2048599",
    "end": "2055320"
  },
  {
    "text": "system however this is one place where it is incredibly quiet um the NT repair",
    "start": "2055320",
    "end": "2062320"
  },
  {
    "text": "directory um I think it ships by default with uh everyone read writes on my",
    "start": "2062320",
    "end": "2068158"
  },
  {
    "text": "personal system the last time this directory was touched was five months ago um it usually only gets touched if",
    "start": "2068159",
    "end": "2073760"
  },
  {
    "text": "you run the NT um you know backup repair thing uh and you go on to make um I know",
    "start": "2073760",
    "end": "2079720"
  },
  {
    "text": "a lot of people do that religiously every day so um if you're looking at",
    "start": "2079720",
    "end": "2085118"
  },
  {
    "text": "this there's only two things that really touch this uh The Loft crack password",
    "start": "2085119",
    "end": "2090240"
  },
  {
    "text": "dump guy and uh the legitimate Microsoft repair disc thing um so if you go here",
    "start": "2090240",
    "end": "2097359"
  },
  {
    "text": "and you see that this access time is recent it's pretty safe to assume that it's been read by Loft crack um so you",
    "start": "2097359",
    "end": "2105760"
  },
  {
    "text": "might want to check that out I got to get something to",
    "start": "2105760",
    "end": "2111680"
  },
  {
    "text": "drink I'd like to talk about trip wire for a second uh Jean if you have a you",
    "start": "2119760",
    "end": "2125720"
  },
  {
    "text": "have a phone call White p phone come back in five",
    "start": "2125720",
    "end": "2132240"
  },
  {
    "text": "um this is one case where where over security kind of works against you um",
    "start": "2132880",
    "end": "2139440"
  },
  {
    "text": "because when you run okay you want to run trip wire most people want to run it and you know have it do everything you",
    "start": "2139440",
    "end": "2145280"
  },
  {
    "text": "know super cryptographic you know nothing on this system is going to change uh I'm going to detect it no one",
    "start": "2145280",
    "end": "2151400"
  },
  {
    "text": "can subverted um because of that trip wire reads the file which means it modifies",
    "start": "2151400",
    "end": "2158280"
  },
  {
    "text": "the access time so uh and it doesn't record the access time so trip wire is not going to catch",
    "start": "2158280",
    "end": "2165319"
  },
  {
    "text": "trip is going to catch changes but it's not going to catch someone reading this",
    "start": "2165319",
    "end": "2170359"
  },
  {
    "text": "into password dump uh so one thing you might want to do is back off a little bit or maybe",
    "start": "2170359",
    "end": "2177800"
  },
  {
    "text": "like have like two scripts and have one script that runs that doesn't do any cryptographic signing but just checks",
    "start": "2177800",
    "end": "2184160"
  },
  {
    "text": "for Access time changes um and then you could catch that uh this is by far the",
    "start": "2184160",
    "end": "2192400"
  },
  {
    "text": "most common attack against NT I think um everybody has Loft crack everyone knows",
    "start": "2192400",
    "end": "2197599"
  },
  {
    "text": "how to do it um we had uh one afternoon I think every machine at trip wire was",
    "start": "2197599",
    "end": "2203400"
  },
  {
    "text": "running LOF crack and uh Jean was so intrigued by that he had beer set up so we could all watch and uh I'm",
    "start": "2203400",
    "end": "2210000"
  },
  {
    "text": "embarrassed to say my password fell in 3.2 seconds I thought candy bar names were",
    "start": "2210000",
    "end": "2216960"
  },
  {
    "text": "really good I had to switch to Bubble",
    "start": "2216960",
    "end": "2221440"
  },
  {
    "text": "Gum okay",
    "start": "2223680",
    "end": "2227359"
  },
  {
    "start": "2227000",
    "end": "2591000"
  },
  {
    "text": "uh thought I had some more",
    "start": "2231800",
    "end": "2235760"
  },
  {
    "text": "stuff um you guys can read through the appendix it's pretty self-explanatory there is I thought I",
    "start": "2237480",
    "end": "2243160"
  },
  {
    "text": "had a slide in here and it's not so I apologize um there's probably one other thing that that a lot of people aren't",
    "start": "2243160",
    "end": "2248240"
  },
  {
    "text": "aware of and that is um uh you know NT has uh these things called uh system",
    "start": "2248240",
    "end": "2254119"
  },
  {
    "text": "watches and you can set uh directory system watches watch for file activity",
    "start": "2254119",
    "end": "2259319"
  },
  {
    "text": "and such uh but one one of the parameters you can set there is uh a",
    "start": "2259319",
    "end": "2264520"
  },
  {
    "text": "remote machine that you want to watch so if you're able to get initial access to a machine you're scanning through it and",
    "start": "2264520",
    "end": "2271520"
  },
  {
    "text": "you see uh wow this guy's got like you know he's been really good and he's uh",
    "start": "2271520",
    "end": "2276680"
  },
  {
    "text": "got all his import financial data uh pgp armored and you say wow uh I'm going to",
    "start": "2276680",
    "end": "2283640"
  },
  {
    "text": "copy those files I'm going to spend the next year U trying to see if I can break it but you really don't need to go to",
    "start": "2283640",
    "end": "2288920"
  },
  {
    "text": "that much work what you can do is just set uh a directory watch and when the",
    "start": "2288920",
    "end": "2294359"
  },
  {
    "text": "guy unarm his files uh it's going to set the trigger it's going to let you know",
    "start": "2294359",
    "end": "2299560"
  },
  {
    "text": "immediately that um they're now in the open then you just jet over there grab a",
    "start": "2299560",
    "end": "2305160"
  },
  {
    "text": "copy of the uh naked file and you're set to go um saves a couple CPU",
    "start": "2305160",
    "end": "2314000"
  },
  {
    "text": "Cycles um I think that's pretty much all I",
    "start": "2314000",
    "end": "2319119"
  },
  {
    "text": "have",
    "start": "2319280",
    "end": "2322280"
  },
  {
    "text": "hey",
    "start": "2336440",
    "end": "2339440"
  },
  {
    "text": "e",
    "start": "2366359",
    "end": "2369359"
  },
  {
    "text": "e",
    "start": "2396319",
    "end": "2399319"
  },
  {
    "text": "e",
    "start": "2426319",
    "end": "2429319"
  },
  {
    "text": "e",
    "start": "2456240",
    "end": "2459240"
  },
  {
    "text": "e",
    "start": "2486240",
    "end": "2489240"
  },
  {
    "text": "e",
    "start": "2516240",
    "end": "2519240"
  },
  {
    "text": "e",
    "start": "2546119",
    "end": "2549119"
  },
  {
    "text": "e for",
    "start": "2576119",
    "end": "2580160"
  }
]