[
  {
    "text": "welcome to black hat briefings held November 21st through the 22nd 2001 in Amsterdam this is videotape number 5B a",
    "start": "18760",
    "end": "28678"
  },
  {
    "text": "continuation",
    "start": "28960",
    "end": "31960"
  },
  {
    "text": "uh we kind of left at uh the end of code red one uh now we'll be looking at Code Red 2 uh which was a completely",
    "start": "34840",
    "end": "42320"
  },
  {
    "text": "different worm uh following code red one um just like code red one however it",
    "start": "42320",
    "end": "49160"
  },
  {
    "text": "did uh it it did focus on uh the the same",
    "start": "49160",
    "end": "55039"
  },
  {
    "text": "vulnerability the the Ida vulnerability and I um it it it does have some aspects",
    "start": "55039",
    "end": "61879"
  },
  {
    "text": "that were similar to to code red one uh things like uh the fact that basically",
    "start": "61879",
    "end": "69000"
  },
  {
    "text": "the exploitation technique was exactly alike with the exception that for COD Red 2 it used the the X character",
    "start": "69000",
    "end": "76240"
  },
  {
    "text": "instead of the end character uh ba basically other than that infection uh",
    "start": "76240",
    "end": "82520"
  },
  {
    "text": "phase is basically the same uh one of the other things that it did do was it",
    "start": "82520",
    "end": "88119"
  },
  {
    "text": "it did leave a physical Trojan on the system which could easily be used to",
    "start": "88119",
    "end": "93320"
  },
  {
    "text": "identify the existence of cod Red",
    "start": "93320",
    "end": "97280"
  },
  {
    "text": "2 okay um as as far as propagation uh Cod Red 2 was very very very much",
    "start": "99320",
    "end": "107079"
  },
  {
    "text": "smarter than code red one um it used a a a statistical distribution uh On Target",
    "start": "107079",
    "end": "115479"
  },
  {
    "text": "selection that seriously favored hosts that were on the same same subnet uh",
    "start": "115479",
    "end": "120960"
  },
  {
    "text": "class uh Class C subnet uh and Then followed up by uh favoring Class B",
    "start": "120960",
    "end": "127160"
  },
  {
    "text": "subnets and then uh a small percentage of them could spread basically to any",
    "start": "127160",
    "end": "133200"
  },
  {
    "text": "any host on the internet um now I'm going to show you the the the pieces of",
    "start": "133200",
    "end": "138280"
  },
  {
    "text": "code that uh that actually do this",
    "start": "138280",
    "end": "144319"
  },
  {
    "text": "stuff",
    "start": "148760",
    "end": "151760"
  },
  {
    "text": "okay um Code Red 2 um just like code red one uh was",
    "start": "157040",
    "end": "165239"
  },
  {
    "text": "basically uh multi-threaded uh it spawned a bunch of threads uh Cod Red 2",
    "start": "165239",
    "end": "171239"
  },
  {
    "text": "as opposed to code red one uh favored attacking Chinese hosts uh on a Chinese",
    "start": "171239",
    "end": "177360"
  },
  {
    "text": "host it would spawn uh 600 threads on a non-chinese host it",
    "start": "177360",
    "end": "183480"
  },
  {
    "text": "would spawn 300 threads uh this right here is basically the top of the process",
    "start": "183480",
    "end": "190799"
  },
  {
    "text": "that gets called uh every time uh a thread is created uh basically what happens here",
    "start": "190799",
    "end": "198920"
  },
  {
    "text": "is that it goes down and checks the number of uh threads that are uh",
    "start": "198920",
    "end": "203959"
  },
  {
    "text": "currently active uh and if it's not above the the the required number it it",
    "start": "203959",
    "end": "210200"
  },
  {
    "text": "will create a thread now when each thread is created like code red one it spawns at the very beginning of the uh",
    "start": "210200",
    "end": "217959"
  },
  {
    "text": "of the code so basically you end up with between 300 and 600 uh exact replicas",
    "start": "217959",
    "end": "224439"
  },
  {
    "text": "sitting in memory um also like code red one it did use a small amount of shared uh shared",
    "start": "224439",
    "end": "231560"
  },
  {
    "text": "memory between all these threads to deal with things like thread count and local IP storage and and the like um um",
    "start": "231560",
    "end": "240400"
  },
  {
    "text": "basically what happens is uh code uh Code Red 2 did not have uh an",
    "start": "240400",
    "end": "249439"
  },
  {
    "text": "attacking payload uh it was more about weakening the host that it was uh",
    "start": "249439",
    "end": "255200"
  },
  {
    "text": "residing on uh setting it up for potentially a later attack uh one of the",
    "start": "255200",
    "end": "260919"
  },
  {
    "text": "things that let's see here um uh the the propagation methods",
    "start": "260919",
    "end": "268600"
  },
  {
    "text": "basically let's see here I just lost myself",
    "start": "268600",
    "end": "274440"
  },
  {
    "text": "here um one of the uh one of the creation",
    "start": "274440",
    "end": "281280"
  },
  {
    "text": "methods or or the propagation method was specifically to um to go through and create an",
    "start": "281280",
    "end": "289199"
  },
  {
    "text": "address that it was going to attack um and",
    "start": "289199",
    "end": "294320"
  },
  {
    "text": "then let's see here",
    "start": "297440",
    "end": "301560"
  },
  {
    "text": "okay um it creates uh a series of octets uh that uh that form an internet",
    "start": "303520",
    "end": "310360"
  },
  {
    "text": "address then finally it goes through creates a socket to connect to that um",
    "start": "310360",
    "end": "317039"
  },
  {
    "text": "unlike code red this uses some more advanced socket techniques uh like non-blocking sockets for The Connect uh",
    "start": "317039",
    "end": "324000"
  },
  {
    "text": "that gives uh a much higher degree of uh handling errors in in the connect",
    "start": "324000",
    "end": "330800"
  },
  {
    "text": "process uh basically a a much more streamlined process in how it's spreading uh what",
    "start": "330800",
    "end": "339520"
  },
  {
    "text": "what happens is it creates the socket it then right here uh IT issues an iocl on",
    "start": "339520",
    "end": "346520"
  },
  {
    "text": "the socket um and that will set it to non-blocking uh IT issues a connect",
    "start": "346520",
    "end": "353080"
  },
  {
    "text": "against the target IP on Port 80 uh and then as you can see here it's",
    "start": "353080",
    "end": "359960"
  },
  {
    "text": "actually checking for the the errors coming back from connect um one of the",
    "start": "359960",
    "end": "365080"
  },
  {
    "text": "one of the other things because it's non-blocking is that it does use a select statement um if you're familiar",
    "start": "365080",
    "end": "371720"
  },
  {
    "text": "with uh Windows sockets at all basically uh select is to check for so uh sockets",
    "start": "371720",
    "end": "378240"
  },
  {
    "text": "that are in a specific uh specific State um once it finds a connection that",
    "start": "378240",
    "end": "386080"
  },
  {
    "text": "actually happened it puts itself in non-blocking uh simply so that it doesn't have to waste code space and",
    "start": "386080",
    "end": "392880"
  },
  {
    "text": "going through select anymore uh IT issues uh on an error it'll close",
    "start": "392880",
    "end": "400199"
  },
  {
    "text": "otherwise what it does is it sends uh its entire chunk of code off uh and then",
    "start": "400199",
    "end": "407000"
  },
  {
    "text": "Waits on a receive once the server received that code it'll spit out a a a",
    "start": "407000",
    "end": "412280"
  },
  {
    "text": "chunk uh and it knows that it succeeded uh then the sockets closed and this",
    "start": "412280",
    "end": "418080"
  },
  {
    "text": "Loops so basically what happens is you have 300 threads or 600 threads on",
    "start": "418080",
    "end": "423440"
  },
  {
    "text": "Chinese systems going through uh attempting to propagate now as I showed",
    "start": "423440",
    "end": "429080"
  },
  {
    "text": "before here the um the target selection uh is based on your network uh when when",
    "start": "429080",
    "end": "436879"
  },
  {
    "text": "code red starts it gets your IP uh and and using this probability based uh",
    "start": "436879",
    "end": "443000"
  },
  {
    "text": "Matrix here it will select uh potentially the uh any of the zero tets",
    "start": "443000",
    "end": "449840"
  },
  {
    "text": "and replace them with a pseudo random number basically meaning that um 50% of",
    "start": "449840",
    "end": "456039"
  },
  {
    "text": "the time it will be within your class C 37.5 it will be within your class B and",
    "start": "456039",
    "end": "461360"
  },
  {
    "text": "then 12.5% it will be a potentially random host next up here I'm going to show you",
    "start": "461360",
    "end": "469440"
  },
  {
    "text": "uh a little bit about the payload of cod rad now or Cod Red 2 rather um Cod Red 2",
    "start": "469440",
    "end": "476720"
  },
  {
    "text": "did a number of things uh as I said said before they're primarily designed to",
    "start": "476720",
    "end": "482800"
  },
  {
    "text": "weaken the system uh and provide other ways of entry into this system uh one of",
    "start": "482800",
    "end": "490000"
  },
  {
    "text": "the one of the parts that it did was to create um a a Trojan command executable",
    "start": "490000",
    "end": "498240"
  },
  {
    "text": "in the web directory called root. exe um basically it will",
    "start": "498240",
    "end": "504240"
  },
  {
    "text": "copy um I'm just GNA find where I'm going here",
    "start": "504240",
    "end": "511240"
  },
  {
    "text": "um all um basically what it does is it goes through and",
    "start": "517680",
    "end": "524680"
  },
  {
    "text": "issues uh a get system directory so that it can find the Windows system directory uh and then uh it it adds CMD",
    "start": "524680",
    "end": "535000"
  },
  {
    "text": "on the end of it so you have a buffer that that basically equates out to C colon Winn",
    "start": "535000",
    "end": "542279"
  },
  {
    "text": "system32 command. exe or cmd.exe rather um what it does then is that it will go",
    "start": "542279",
    "end": "550120"
  },
  {
    "text": "through and uh by these embedded numbers here uh this one says Deon what actually",
    "start": "550120",
    "end": "557040"
  },
  {
    "text": "happens is that this process goes through twice one for C and one for D um",
    "start": "557040",
    "end": "562800"
  },
  {
    "text": "initially what's going to happen here is it's going to copy this CMD into uh C",
    "start": "562800",
    "end": "568800"
  },
  {
    "text": "colon inet Pub scripts root. exe uh and then again uh into Deon in uh inet Pub",
    "start": "568800",
    "end": "577160"
  },
  {
    "text": "scripts root. exe uh and basically what this does is um uh inet Pub scripts uh",
    "start": "577160",
    "end": "586160"
  },
  {
    "text": "is an often mapped virtual directory to the SL scripts uh folder in uh in most",
    "start": "586160",
    "end": "593680"
  },
  {
    "text": "is systems Now by copying a command uh execut there uh and renaming it to root",
    "start": "593680",
    "end": "601839"
  },
  {
    "text": "that allows you to basically execute any command uh in the I user which is an",
    "start": "601839",
    "end": "609279"
  },
  {
    "text": "unprivileged account across the internet um it's the same type of technique that",
    "start": "609279",
    "end": "614360"
  },
  {
    "text": "was used uh to exploit attacks like Unicode and double decode but you're not",
    "start": "614360",
    "end": "620839"
  },
  {
    "text": "limited to a bug here you basically have a CGI program that is acting as a",
    "start": "620839",
    "end": "627320"
  },
  {
    "text": "command interpreter um it it does it in uh inet Pub it also",
    "start": "627320",
    "end": "633519"
  },
  {
    "text": "does it in uh Ms ADC which is uh another",
    "start": "633519",
    "end": "638760"
  },
  {
    "text": "commonly mapped uh virtual directory uh a after it goes through and",
    "start": "638760",
    "end": "644399"
  },
  {
    "text": "creates those two um a a big chunk of code in in the Code Red 2 binary is is a",
    "start": "644399",
    "end": "651000"
  },
  {
    "text": "a partially uh a partially",
    "start": "651000",
    "end": "656120"
  },
  {
    "text": "compressed uh copy of a a Trojan the the",
    "start": "656120",
    "end": "661639"
  },
  {
    "text": "basically will do some other bad things I'll show you the Trojan in a minute here but basically all these databytes",
    "start": "661639",
    "end": "667000"
  },
  {
    "text": "are are code for the Trojan and they're embedded right in the middle what it",
    "start": "667000",
    "end": "672399"
  },
  {
    "text": "does is it creates a file in the root of the C or D drive um named explorer.exe",
    "start": "672399",
    "end": "680240"
  },
  {
    "text": "now what um what that does is there's actually a bug in Windows NT that would",
    "start": "680240",
    "end": "687320"
  },
  {
    "text": "accept uh the C dve before I accepted the explorer.exe in the uh in the proc",
    "start": "687320",
    "end": "693600"
  },
  {
    "text": "or in the system directory what that allowed this to do is the next time that you log on um and you execute",
    "start": "693600",
    "end": "700560"
  },
  {
    "text": "explorer.exe as your command shell uh putting all your pretty pictures up on Windows it would execute the Trojan one",
    "start": "700560",
    "end": "707880"
  },
  {
    "text": "uh and I'll show you how the Trojan one then executes the legitimate one here in a minute um but as you can see all these",
    "start": "707880",
    "end": "714440"
  },
  {
    "text": "little FC's here um",
    "start": "714440",
    "end": "719880"
  },
  {
    "text": "these are actually compression characters um each FC is designed to be",
    "start": "719880",
    "end": "725519"
  },
  {
    "text": "replaced by 20 hex uh which is 32 uh binary null bites um they they chose not",
    "start": "725519",
    "end": "734040"
  },
  {
    "text": "to do it uh like uh the traditional way simply because this program ends up",
    "start": "734040",
    "end": "739079"
  },
  {
    "text": "being a lot bigger that way they found a common uh bite pattern that they could",
    "start": "739079",
    "end": "744480"
  },
  {
    "text": "overwrite uh and and expand um uh basically this all happens here in",
    "start": "744480",
    "end": "749920"
  },
  {
    "text": "create Explorer um basically it uses an L create file uh file name uh and what L",
    "start": "749920",
    "end": "757000"
  },
  {
    "text": "create is is it's a a runtime Library creation function to create a file uh",
    "start": "757000",
    "end": "762880"
  },
  {
    "text": "then uses L WR to write individual bytes of that very large string out here until",
    "start": "762880",
    "end": "769120"
  },
  {
    "text": "it sees an FC now let's see",
    "start": "769120",
    "end": "776360"
  },
  {
    "text": "here okay um basically I'm looking for my FC",
    "start": "777839",
    "end": "786639"
  },
  {
    "text": "here ah um it's around here I just can't read my comments anymore um B basically",
    "start": "789600",
    "end": "796959"
  },
  {
    "text": "what it does is every time it sees that FC it'll write out 20 bytes rather than an FC and it Loops through this program",
    "start": "796959",
    "end": "804199"
  },
  {
    "text": "writes it all out and then when it's done it goes to um",
    "start": "804199",
    "end": "809480"
  },
  {
    "text": "um it actually reboots the system so the next time that you run uh run your",
    "start": "809480",
    "end": "814959"
  },
  {
    "text": "windows you actually log in wind login will spawn Explorer which is the Trojan Explorer and what I'm going to do now is",
    "start": "814959",
    "end": "822160"
  },
  {
    "text": "I also have a disassembly of the Explorer uh Trojan so",
    "start": "822160",
    "end": "828079"
  },
  {
    "text": "I can show you kind of what is actually happening there um again this comes down",
    "start": "828079",
    "end": "833399"
  },
  {
    "text": "to uh Explorer is being treated as um a a binary Windows executable",
    "start": "833399",
    "end": "841399"
  },
  {
    "text": "rather than um uh rather than a piece of baseless",
    "start": "841399",
    "end": "846839"
  },
  {
    "text": "code now because it's uh when it's written out is actually a valid Windows",
    "start": "846839",
    "end": "852160"
  },
  {
    "text": "PE file uh so as you can see here we have different segments um we have a",
    "start": "852160",
    "end": "859279"
  },
  {
    "text": "start SE uh section A text section and uh an actual data section now um",
    "start": "859279",
    "end": "868040"
  },
  {
    "text": "this is all excuse me um this is all valid in a win32 environment um and these all have",
    "start": "868040",
    "end": "875199"
  },
  {
    "text": "their places and this is the file that was written out uh what happens is when",
    "start": "875199",
    "end": "881600"
  },
  {
    "text": "it starts um it gets the windows directory uh the the system 32 directory",
    "start": "881600",
    "end": "889000"
  },
  {
    "text": "uh and it takes that returned buffer and Supply uh aens explorer.exe",
    "start": "889000",
    "end": "895240"
  },
  {
    "text": "on the end of it uh then what it does is it uses win exec here to execute your",
    "start": "895240",
    "end": "900720"
  },
  {
    "text": "real explorer.exe so now if you looked in your task list you'd have two",
    "start": "900720",
    "end": "905920"
  },
  {
    "text": "explorer. eex one of them being a Trojan and one of them being legitimate they",
    "start": "905920",
    "end": "911360"
  },
  {
    "text": "they probably won't look alike one of them probably uses a lot more memory than the other but you actually have two",
    "start": "911360",
    "end": "916920"
  },
  {
    "text": "of them sitting there um what what then happens uh is it goes into this short",
    "start": "916920",
    "end": "922639"
  },
  {
    "text": "Loop here um where it basically sleeps for about uh it it sets some register",
    "start": "922639",
    "end": "928399"
  },
  {
    "text": "key sleeps for about 2 minutes uh and then goes through and continues through this process uh doe reg set um is a",
    "start": "928399",
    "end": "936480"
  },
  {
    "text": "series of calls to registry keys uh that serve to weak uh further weaken the",
    "start": "936480",
    "end": "942839"
  },
  {
    "text": "system um basically it goes through um and it",
    "start": "942839",
    "end": "948319"
  },
  {
    "text": "creates uh a a it creates the the scripts directory and makes it",
    "start": "948319",
    "end": "953560"
  },
  {
    "text": "executable it creates the msad directory and makes it executable both those uh",
    "start": "953560",
    "end": "958959"
  },
  {
    "text": "whether they're uh whether they're there often times they're turned off sometimes they're deleted this makes sure that",
    "start": "958959",
    "end": "965079"
  },
  {
    "text": "they're there this is so that you can get to the the planted root. exe um the",
    "start": "965079",
    "end": "970560"
  },
  {
    "text": "the other two things that it does that are pretty dangerous is that it directly Maps the C drive and the D drive to/ c",
    "start": "970560",
    "end": "979959"
  },
  {
    "text": "and/ d respectively on the web server this gives an outside entity full uh",
    "start": "979959",
    "end": "987160"
  },
  {
    "text": "full access at iwam privilege level to your entire hard drives um from that you",
    "start": "987160",
    "end": "993480"
  },
  {
    "text": "can continue to execute uh execute further code or um just steal files um",
    "start": "993480",
    "end": "1002199"
  },
  {
    "text": "that that's basically the the core of what um the explorer.exe troan did as I",
    "start": "1002199",
    "end": "1008600"
  },
  {
    "text": "said before it executes before the other one there is actually a patch out now that will fix that process but um it did",
    "start": "1008600",
    "end": "1017880"
  },
  {
    "text": "affect a lot of of people okay next up",
    "start": "1017880",
    "end": "1025398"
  },
  {
    "text": "here um this is actually one that I'm very happy about um we we really didn't",
    "start": "1025959",
    "end": "1031959"
  },
  {
    "text": "talk about this much in our um disassembly uh originally um because we we didn't",
    "start": "1031959",
    "end": "1039400"
  },
  {
    "text": "actually take a very good look at it until well after Cod red had blown over um about a day after we published our",
    "start": "1039400",
    "end": "1047400"
  },
  {
    "text": "initial code red anal is we got a a a basically an anonymous post from a",
    "start": "1047400",
    "end": "1053360"
  },
  {
    "text": "government lab saying hey we seen uh we have seen this worm out there about four",
    "start": "1053360",
    "end": "1058919"
  },
  {
    "text": "months ago um and this is prior to code red one uh what happened was a a very",
    "start": "1058919",
    "end": "1066559"
  },
  {
    "text": "similar worm exploting a very different undisclosed vulnerability uh had been traversing",
    "start": "1066559",
    "end": "1072679"
  },
  {
    "text": "around the networks before nobody knew about it it was reported to various reporting agencies but but they chose to",
    "start": "1072679",
    "end": "1079159"
  },
  {
    "text": "not respond to it um so basically it was 4 months before code run uh code red one",
    "start": "1079159",
    "end": "1085440"
  },
  {
    "text": "there was a warning shut out there that people didn't understand um there there's a couple reasons uh political",
    "start": "1085440",
    "end": "1093280"
  },
  {
    "text": "reasons and just time reasons that nobody actually uh nobody actually saw",
    "start": "1093280",
    "end": "1098559"
  },
  {
    "text": "it um what okay um what I'm going to start out",
    "start": "1098559",
    "end": "1103880"
  },
  {
    "text": "here is that this is a this worm uh a attacked a air uh",
    "start": "1103880",
    "end": "1111159"
  },
  {
    "text": "although about 2 and a half years ago EI um published details on an HDR",
    "start": "1111159",
    "end": "1118919"
  },
  {
    "text": "vulnerability um yep does thism have a name nope never we never gave it one",
    "start": "1118919",
    "end": "1126760"
  },
  {
    "text": "nobody really uh noticed and we didn't really talk about it very much so um it",
    "start": "1126760",
    "end": "1133480"
  },
  {
    "text": "nobody it just never happened that way um this this is actually a different",
    "start": "1133480",
    "end": "1138559"
  },
  {
    "text": "vulnerability than uh than the HTR vulnerability that we had uh we had found the patch that fixed the HTR",
    "start": "1138559",
    "end": "1145280"
  },
  {
    "text": "vulnerability also fixed this one so in reality there's been a good two to three",
    "start": "1145280",
    "end": "1150520"
  },
  {
    "text": "years of patched nt4 systems out there however this is a an undisclosed bug",
    "start": "1150520",
    "end": "1156840"
  },
  {
    "text": "that somebody's been keeping in their pocket and decide to write a worm about um which is like the Dooms Day scenario",
    "start": "1156840",
    "end": "1163120"
  },
  {
    "text": "that everybody's worried about fortunately for all of us it's kind of a lame old bug so it never really took off",
    "start": "1163120",
    "end": "1170320"
  },
  {
    "text": "but this this just goes to show that details don't need to be available for somebody to write a worm um basically",
    "start": "1170320",
    "end": "1177360"
  },
  {
    "text": "What's Happening Here is that these are a bunch of different addresses uh being replicated here",
    "start": "1177360",
    "end": "1185799"
  },
  {
    "text": "um uh and what happens is down further uh you end up with a little bit of code",
    "start": "1190120",
    "end": "1197840"
  },
  {
    "text": "and and it took us a few times to go through this and see this is what what was actually happening but basically",
    "start": "1197840",
    "end": "1203799"
  },
  {
    "text": "what happens is that this is right here a decryption algorithm uh that's used",
    "start": "1203799",
    "end": "1211120"
  },
  {
    "text": "to uh dxor the the worm and as you can tell there's a bunch of garbage down",
    "start": "1211120",
    "end": "1217360"
  },
  {
    "text": "here uh the the reason that it was XR encoded was because like a lot of",
    "start": "1217360",
    "end": "1222440"
  },
  {
    "text": "standard exploits you simply cannot put null bites in them uh code red used an",
    "start": "1222440",
    "end": "1227799"
  },
  {
    "text": "innov a placement of its data to avoid that problem uh most exploits that are",
    "start": "1227799",
    "end": "1233720"
  },
  {
    "text": "written now are XR encoded this one is no exception now obviously this doesn't",
    "start": "1233720",
    "end": "1239320"
  },
  {
    "text": "mean a whole lot to anybody because it's all uh XR encrypted uh this is where Ida",
    "start": "1239320",
    "end": "1246720"
  },
  {
    "text": "really really kicks ass um the uh inside of Ida there's a there's a system called",
    "start": "1246720",
    "end": "1252159"
  },
  {
    "text": "IDC uh it's a c like scripting language that allows you to do uh automatic",
    "start": "1252159",
    "end": "1258720"
  },
  {
    "text": "things to your data um so what I did is uh if you follow this uh system here",
    "start": "1258720",
    "end": "1265880"
  },
  {
    "text": "basically we're clearing uh ECX here we're loading a bite um and up here is",
    "start": "1265880",
    "end": "1271919"
  },
  {
    "text": "where we actually set up everything but basically we load a bite we exor CA uh",
    "start": "1271919",
    "end": "1278120"
  },
  {
    "text": "against al uh to see if Al is null if it is then we jump down to our code uh",
    "start": "1278120",
    "end": "1284640"
  },
  {
    "text": "otherwise we go through and um compare it uh if it doesn't",
    "start": "1284640",
    "end": "1292200"
  },
  {
    "text": "then uh uh um we we compare uh Al",
    "start": "1292200",
    "end": "1297640"
  },
  {
    "text": "against 30 hex if it is then we jump over xor decrypting that bite and we just subtract and place the bite uh what",
    "start": "1297640",
    "end": "1306000"
  },
  {
    "text": "we do then uh basically is we go through and we xor against AA now I created a an",
    "start": "1306000",
    "end": "1315799"
  },
  {
    "text": "IDC file",
    "start": "1315799",
    "end": "1320039"
  },
  {
    "text": "and I thought I had it in there",
    "start": "1324200",
    "end": "1327919"
  },
  {
    "text": "um wrong word um and I'm just going to show you",
    "start": "1335360",
    "end": "1341640"
  },
  {
    "text": "um kind of what it looks like here um basically what we have going on is",
    "start": "1341640",
    "end": "1349159"
  },
  {
    "text": "the exact same situation it's basically in a c context um we have a static",
    "start": "1349159",
    "end": "1356440"
  },
  {
    "text": "decrypt the it's the only function that we call I personally put the uh the",
    "start": "1356440",
    "end": "1361799"
  },
  {
    "text": "length in here um and the Base address right here um so that we could walk",
    "start": "1361799",
    "end": "1367720"
  },
  {
    "text": "through this um uh again if not uh if the bite that we just got was a null",
    "start": "1367720",
    "end": "1374159"
  },
  {
    "text": "that means that we're at the end of our string we skip that or or we're done then uh if uh if the bite is equal to 30",
    "start": "1374159",
    "end": "1383279"
  },
  {
    "text": "we go through we get the next bite um or or we increase that we get we point to",
    "start": "1383279",
    "end": "1390200"
  },
  {
    "text": "the next bite and we decrease it by 40 uh that's just basically the equivalent of the ASM that I just showed you over",
    "start": "1390200",
    "end": "1397120"
  },
  {
    "text": "here um in a C- like format um what then happens is that we",
    "start": "1397120",
    "end": "1403120"
  },
  {
    "text": "patch the bite back or we exer it against AA and and we put the back into",
    "start": "1403120",
    "end": "1409000"
  },
  {
    "text": "the uh back into the disassembly um again these are all fairly automatic if",
    "start": "1409000",
    "end": "1415200"
  },
  {
    "text": "I just do this it just uh I don't know if you saw that but it went down through here this is now code where it actually",
    "start": "1415200",
    "end": "1423080"
  },
  {
    "text": "makes sense uh and you can go down here and B uh basically what you end up with",
    "start": "1423080",
    "end": "1430720"
  },
  {
    "text": "is um I think I went too far",
    "start": "1430720",
    "end": "1435559"
  },
  {
    "text": "there",
    "start": "1436880",
    "end": "1439880"
  },
  {
    "text": "okay um but what we have is we have Imports",
    "start": "1443480",
    "end": "1449600"
  },
  {
    "text": "that we're loading um basically these are just like",
    "start": "1449600",
    "end": "1456400"
  },
  {
    "text": "before we're going through we have basically the exact same import table that we had in code red",
    "start": "1456400",
    "end": "1464799"
  },
  {
    "text": "one um and even down to I I I'm just not",
    "start": "1466799",
    "end": "1473919"
  },
  {
    "text": "going to run through all this stuff but um but you can see wor.com just like code Redan um C colon not",
    "start": "1473919",
    "end": "1483080"
  },
  {
    "text": "worm um but the uh the really one that gets people is that you see uh USA",
    "start": "1483080",
    "end": "1490000"
  },
  {
    "text": "hacked by Chinese um so basically what this is is that this is code red four",
    "start": "1490000",
    "end": "1496000"
  },
  {
    "text": "months before anybody had ever heard of code red in the wild using undisclosed",
    "start": "1496000",
    "end": "1501080"
  },
  {
    "text": "vulnerabilities lucky again luckily it wasn't a very powerful undisclosed",
    "start": "1501080",
    "end": "1506440"
  },
  {
    "text": "vulnerability otherwise we'd have all been running around with uh not a clue as to what the hell was going on",
    "start": "1506440",
    "end": "1513760"
  },
  {
    "text": "um again I I haven't went through and completely disassembled this worm simply",
    "start": "1513760",
    "end": "1519520"
  },
  {
    "text": "because there's really no value in knowing beyond what uh beyond the fact",
    "start": "1519520",
    "end": "1525559"
  },
  {
    "text": "that it's very similar to code rad there are a few bite change differences but I believe that's mostly for platform uh",
    "start": "1525559",
    "end": "1532320"
  },
  {
    "text": "reasons versus functionality reasons um and just checking time here",
    "start": "1532320",
    "end": "1541080"
  },
  {
    "text": "um uh for right now I will go over some of uh some of the nimda code actually um",
    "start": "1541080",
    "end": "1548120"
  },
  {
    "text": "nimda was probably the last big worm that we've seen here uh it affected a",
    "start": "1548120",
    "end": "1553679"
  },
  {
    "text": "ton of people um it it actually had a whole lot going on on in it um it it",
    "start": "1553679",
    "end": "1559960"
  },
  {
    "text": "attacked both clients and servers uh it it infected it uh files similar to vir",
    "start": "1559960",
    "end": "1566399"
  },
  {
    "text": "uh using viral techniques um it it basically just had a ton of stuff happening in it so I'm I'm I'm not going",
    "start": "1566399",
    "end": "1573720"
  },
  {
    "text": "to cover the whole disassembly I'm just going to go through some specific parts that that are interesting to how it was",
    "start": "1573720",
    "end": "1579960"
  },
  {
    "text": "propagating how it was uh what some of the payloads were um just as a a quick",
    "start": "1579960",
    "end": "1586159"
  },
  {
    "text": "little side here here I'm going to flip here",
    "start": "1586159",
    "end": "1593159"
  },
  {
    "text": "um okay next slide uh nimda um basically it",
    "start": "1593159",
    "end": "1599640"
  },
  {
    "text": "it used um all the",
    "start": "1599640",
    "end": "1604520"
  },
  {
    "text": "vulner all of the vulnerabilities that nimda used were disclosed sometimes up to a year before",
    "start": "1609720",
    "end": "1617320"
  },
  {
    "text": "uh any of them were used here um it used basically four different ways three of them were really vulnerabilities the the",
    "start": "1617320",
    "end": "1625159"
  },
  {
    "text": "fourth was just a a poor Computing practice um basically it used a",
    "start": "1625159",
    "end": "1630840"
  },
  {
    "text": "technique that allowed code to be executed uh through M uh incorrect mime",
    "start": "1630840",
    "end": "1636520"
  },
  {
    "text": "handling uh in Outlook and ie specifically it's because Outlook uses",
    "start": "1636520",
    "end": "1643159"
  },
  {
    "text": "the IE to view HTML email messages um it it also implemented and and used to",
    "start": "1643159",
    "end": "1650720"
  },
  {
    "text": "propagate both the Unicode and the double decode attacks uh and the Unicode attack has been",
    "start": "1650720",
    "end": "1657880"
  },
  {
    "text": "around for a very very long time as I'm sure you all know um finally what it did",
    "start": "1657880",
    "end": "1663840"
  },
  {
    "text": "is uh any type of open share that it could find it would attempt to replicate",
    "start": "1663840",
    "end": "1669080"
  },
  {
    "text": "itself across to files located on those uh on those shares um that that kind of",
    "start": "1669080",
    "end": "1674799"
  },
  {
    "text": "gives a lot of different ways that that this worm can spread and it also makes",
    "start": "1674799",
    "end": "1680200"
  },
  {
    "text": "an administrator's job that much harder having to close potentially all these different",
    "start": "1680200",
    "end": "1685720"
  },
  {
    "text": "holes um now into the",
    "start": "1685720",
    "end": "1690600"
  },
  {
    "text": "code um this is uh basically uh a very little touched uh",
    "start": "1705200",
    "end": "1713279"
  },
  {
    "text": "binary of nimda excuse me um I did do a little bit of uh write up on it simply because it",
    "start": "1713279",
    "end": "1721360"
  },
  {
    "text": "made it a little bit easier to show you guys what was going on um again nimda is",
    "start": "1721360",
    "end": "1727159"
  },
  {
    "text": "a Trojan type of um uh type of code it it actually is a a little bit different",
    "start": "1727159",
    "end": "1734320"
  },
  {
    "text": "because it's actually both a dll and an executable it has has basically full functioning parts to be both uh a",
    "start": "1734320",
    "end": "1742399"
  },
  {
    "text": "dynamically loaded library and an executable and depending on how it's called it does act different um let's",
    "start": "1742399",
    "end": "1751919"
  },
  {
    "text": "see here I'm GNA crank open my uh my tags",
    "start": "1751919",
    "end": "1757960"
  },
  {
    "text": "here I'm going to first start out with uh",
    "start": "1757960",
    "end": "1762960"
  },
  {
    "text": "propagation",
    "start": "1766320",
    "end": "1769320"
  },
  {
    "text": "um okay",
    "start": "1774159",
    "end": "1777559"
  },
  {
    "text": "for for propagation first we will cover",
    "start": "1779640",
    "end": "1785440"
  },
  {
    "text": "um uh how it's actually using email um to get the email addresses that it sent",
    "start": "1785440",
    "end": "1791559"
  },
  {
    "text": "through uh it used uh a set of Mappy calls Mappy is the Microsoft message API",
    "start": "1791559",
    "end": "1798640"
  },
  {
    "text": "uh it's what Outlook uses basically it's a series of apis internal to the program",
    "start": "1798640",
    "end": "1804799"
  },
  {
    "text": "designed to uh facilitate mail sending however it doesn't actually send using",
    "start": "1804799",
    "end": "1811120"
  },
  {
    "text": "those what it does is it actually has a built-in SMTP system uh that will",
    "start": "1811120",
    "end": "1817519"
  },
  {
    "text": "connect out to a remote uh uh SMTP server and actually deal as a client",
    "start": "1817519",
    "end": "1823480"
  },
  {
    "text": "connecting to that to send the email uh as you can tell uh by by the the way I found this was by",
    "start": "1823480",
    "end": "1830840"
  },
  {
    "text": "looking in the strings you can go through and um find the various",
    "start": "1830840",
    "end": "1838600"
  },
  {
    "text": "different um the various different calls hello hello is uh uh recipient to mail",
    "start": "1838640",
    "end": "1845840"
  },
  {
    "text": "from these are all SMTP commands and as you can tell here they all are basically",
    "start": "1845840",
    "end": "1852279"
  },
  {
    "text": "in or a bunch of them are in the same functions here so by using a cross reference here I am hello it sends the",
    "start": "1852279",
    "end": "1860320"
  },
  {
    "text": "computer name mail from and it gets the the email address from uh the Mappy",
    "start": "1860320",
    "end": "1868159"
  },
  {
    "text": "call uh it sends us slrn to to go to the next line recipient two uh gets the",
    "start": "1868159",
    "end": "1875840"
  },
  {
    "text": "recipient from uh from the uh Mappy client and then data now one one of the",
    "start": "1875840",
    "end": "1884720"
  },
  {
    "text": "funny things about this is if you can see here basically nimda I I'm almost",
    "start": "1884720",
    "end": "1891200"
  },
  {
    "text": "positive was written using a a basically a c compiler uh it's got string copies and string cats pounded all the way",
    "start": "1891200",
    "end": "1898120"
  },
  {
    "text": "through it and there are a lot of overflows within nimda itself uh so in theory you could attack the nimda virus",
    "start": "1898120",
    "end": "1905399"
  },
  {
    "text": "by uh sending specific emails or feeding it junk data you could cause it to overflow and even take control of EIP",
    "start": "1905399",
    "end": "1912840"
  },
  {
    "text": "within the within the Trojan um",
    "start": "1912840",
    "end": "1917960"
  },
  {
    "text": "again you know it's just showing the from uh the subject and and all these are string cats and string copies so uh",
    "start": "1917960",
    "end": "1925480"
  },
  {
    "text": "Bas basically that's how it's using its uh internal SMTP system to shoot off a",
    "start": "1925480",
    "end": "1932039"
  },
  {
    "text": "mail um what do we got next here open",
    "start": "1932039",
    "end": "1937518"
  },
  {
    "text": "shares um basically how nimda went through and uh shot across open shares",
    "start": "1940840",
    "end": "1947799"
  },
  {
    "text": "is that anytime it found a drive it would deal with um placing copies of itself out there typically it us a name",
    "start": "1947799",
    "end": "1955360"
  },
  {
    "text": "read me.exe or read me. um other times it uses admin. DL or",
    "start": "1955360",
    "end": "1963279"
  },
  {
    "text": "r e32 or 20. DLo which is an internal Word",
    "start": "1963279",
    "end": "1969120"
  },
  {
    "text": "document um basically what it's doing is it it's finding any spot that it can",
    "start": "1969120",
    "end": "1974559"
  },
  {
    "text": "dump itself uh and pumping it out there this combined with the fact that nimda",
    "start": "1974559",
    "end": "1980120"
  },
  {
    "text": "infected hosts have open guest shares uh is is a pretty deadly combination um uh so basically what it's",
    "start": "1980120",
    "end": "1988159"
  },
  {
    "text": "doing here uh is it's picking up read me. EML um copying it onto the the path that",
    "start": "1988159",
    "end": "1995360"
  },
  {
    "text": "it has found uh and then uh basically create file and it dumps a copy of",
    "start": "1995360",
    "end": "2000799"
  },
  {
    "text": "itself over there um basically what What's Happening Here is that this is a",
    "start": "2000799",
    "end": "2007880"
  },
  {
    "text": "a way where nimda can continually drop copies of itself all over uh a lot of",
    "start": "2007880",
    "end": "2013279"
  },
  {
    "text": "times uh they're just inactive copies that never get run sometimes uh for",
    "start": "2013279",
    "end": "2018880"
  },
  {
    "text": "instance with the the r E30 or 20. dll",
    "start": "2018880",
    "end": "2024320"
  },
  {
    "text": "um there there's actually a bug in office that if you open a file in the",
    "start": "2024320",
    "end": "2029679"
  },
  {
    "text": "same directory that that dll is uh it will execute code from that D rather than using a word one so that that's",
    "start": "2029679",
    "end": "2036320"
  },
  {
    "text": "another method that it began to propagate um again not all of Nima's",
    "start": "2036320",
    "end": "2043120"
  },
  {
    "text": "techniques for propagation were completely technical so it kind of is a",
    "start": "2043120",
    "end": "2048878"
  },
  {
    "text": "hybrid worm and virus um uh one one of the the final ways that it continued to",
    "start": "2048879",
    "end": "2056760"
  },
  {
    "text": "to spread was it used a bunch of standard techniques for attacking web servers um let's see",
    "start": "2056760",
    "end": "2065878"
  },
  {
    "text": "here",
    "start": "2065879",
    "end": "2068878"
  },
  {
    "text": "okay this part here um is actually the part that builds the URL to send to the",
    "start": "2072560",
    "end": "2079280"
  },
  {
    "text": "remote system to attack with uh to attack with various attacks",
    "start": "2079280",
    "end": "2086398"
  },
  {
    "text": "now um basically what happens is we have a bunch of different um different chunks of a a",
    "start": "2086399",
    "end": "2094000"
  },
  {
    "text": "double decode and a Unicode attack uh as you can see here it's looking for double decode off of the scripts",
    "start": "2094000",
    "end": "2100880"
  },
  {
    "text": "directory um and here it's using standard Unicode chunks to build um",
    "start": "2100880",
    "end": "2108480"
  },
  {
    "text": "potential attacks that it can use against uh the it can use against uh the",
    "start": "2108480",
    "end": "2114200"
  },
  {
    "text": "host to execute code when and if one of these attacks do occur uh it will use",
    "start": "2114200",
    "end": "2120640"
  },
  {
    "text": "the tftp protocol to download a copy of itself called admin. dll um once that's",
    "start": "2120640",
    "end": "2127119"
  },
  {
    "text": "on the remote side it treats it as a CGI script and can use that to execute",
    "start": "2127119",
    "end": "2133040"
  },
  {
    "text": "itself uh which then infects that system one of the things that once the system",
    "start": "2133040",
    "end": "2138680"
  },
  {
    "text": "is infected uh any HTML or ASP file that you see is going to have a a a copy of a",
    "start": "2138680",
    "end": "2146800"
  },
  {
    "text": "a MIM encoded copy o of the the read me.exe plunked on the end of it and what",
    "start": "2146800",
    "end": "2153720"
  },
  {
    "text": "that will do is that the next time somebody views that HTM it's back to the Outlook IE",
    "start": "2153720",
    "end": "2159040"
  },
  {
    "text": "vulnerability and it attempts to automatically execute that so it had a a very big chain of uh uh different ways",
    "start": "2159040",
    "end": "2166680"
  },
  {
    "text": "they could spread around and it that that was one of the hardest parts of dealing with nimda is to close all of",
    "start": "2166680",
    "end": "2173520"
  },
  {
    "text": "the individual holes and make sure that all of the HTML was clean um and then",
    "start": "2173520",
    "end": "2179000"
  },
  {
    "text": "even then you still have people who click on it when they get it even even if it's not automatically",
    "start": "2179000",
    "end": "2185560"
  },
  {
    "text": "going um next up here we're going to talk a little bit about the various things that",
    "start": "2185560",
    "end": "2191520"
  },
  {
    "text": "nimda actually did to a system once it was infected the the sort of payload rather than the propagation techniques",
    "start": "2191520",
    "end": "2197480"
  },
  {
    "text": "that it used um one of the things",
    "start": "2197480",
    "end": "2205040"
  },
  {
    "text": "here um the first part that I'm going to talk about here um is how it open shares",
    "start": "2205040",
    "end": "2214000"
  },
  {
    "text": "uh it actually physically added users and open shares available to these users",
    "start": "2214000",
    "end": "2219800"
  },
  {
    "text": "um this is a a severe system weakening uh what it did is it added a",
    "start": "2219800",
    "end": "2226720"
  },
  {
    "text": "guest yep um it added a guest account to",
    "start": "2226720",
    "end": "2231839"
  },
  {
    "text": "the uh to the local machine and it did this using a win exec for the net user",
    "start": "2231839",
    "end": "2237800"
  },
  {
    "text": "account or or the net user command or the net local group command um what it did here as you can see is that issued",
    "start": "2237800",
    "end": "2245960"
  },
  {
    "text": "net with a um with a argument of user",
    "start": "2245960",
    "end": "2251560"
  },
  {
    "text": "guest ad now what that did is if for some reason there wasn't a guest account",
    "start": "2251560",
    "end": "2256640"
  },
  {
    "text": "which is default uh uh guest accounts are default on all NT and 2000 systems",
    "start": "2256640",
    "end": "2261920"
  },
  {
    "text": "uh it it added this account uh typically they are disabled which is where the",
    "start": "2261920",
    "end": "2267599"
  },
  {
    "text": "second uh command comes in it creates that account or it makes that account",
    "start": "2267599",
    "end": "2273359"
  },
  {
    "text": "active uh meaning that it has login privileges uh you can authenticate against it",
    "start": "2273359",
    "end": "2279640"
  },
  {
    "text": "finally uh it adds or I'm not finally but next it adds uh the guest account to",
    "start": "2279640",
    "end": "2286680"
  },
  {
    "text": "the guest's local group um that it's probably already there but it wants to",
    "start": "2286680",
    "end": "2292720"
  },
  {
    "text": "make sure that it uh clears everything and although you can't see this because the the comments have slid off I'll hop",
    "start": "2292720",
    "end": "2298520"
  },
  {
    "text": "over here what it does is a uh a net local group administrators guest ad and",
    "start": "2298520",
    "end": "2305680"
  },
  {
    "text": "what this does is it adds the guest account that was just created and made active to the local group administrators",
    "start": "2305680",
    "end": "2313480"
  },
  {
    "text": "which as you all know an NT basically grants you most of the Privileges that",
    "start": "2313480",
    "end": "2318680"
  },
  {
    "text": "you'd need to do anything on a uh on an NT box um what next comes up and this is",
    "start": "2318680",
    "end": "2326680"
  },
  {
    "text": "the really really dangerous part uh is that it goes through and issues a net",
    "start": "2326680",
    "end": "2331760"
  },
  {
    "text": "user guest no password so now you have a local guest account on your machine in",
    "start": "2331760",
    "end": "2338560"
  },
  {
    "text": "the administer group that's active and has no password meaning that anybody",
    "start": "2338560",
    "end": "2343680"
  },
  {
    "text": "anywhere can connect to any shared resource that you have be it a printer be it a uh a drive that you're sharing",
    "start": "2343680",
    "end": "2351880"
  },
  {
    "text": "or uh even your IPC connection and IPC is used to enumerate users authenticate",
    "start": "2351880",
    "end": "2359079"
  },
  {
    "text": "against different RPC resources so B basically at that point anybody anywhere",
    "start": "2359079",
    "end": "2365480"
  },
  {
    "text": "can connect with basically no credentials with an administrative AIS",
    "start": "2365480",
    "end": "2370920"
  },
  {
    "text": "on that machine um as if that wasn't enough for it to do",
    "start": "2370920",
    "end": "2377480"
  },
  {
    "text": "um the the next part of the payload that it did is it went through and infected a bunch of system binaries um meaning uh",
    "start": "2377480",
    "end": "2384800"
  },
  {
    "text": "typically what it did was that it would replace the system binary um and",
    "start": "2384800",
    "end": "2391079"
  },
  {
    "text": "then keep a a local copy of it inside of itself like a an embedded copy of it and",
    "start": "2391079",
    "end": "2397599"
  },
  {
    "text": "anytime it gets called it writes out the original executes the original and then goes on about his business of further",
    "start": "2397599",
    "end": "2404119"
  },
  {
    "text": "infecting your",
    "start": "2404119",
    "end": "2406799"
  },
  {
    "text": "systems um we'll go to payload two here",
    "start": "2412480",
    "end": "2418720"
  },
  {
    "text": "um this part is where just want to double check where I",
    "start": "2418720",
    "end": "2425119"
  },
  {
    "text": "am here um oh this is for uh introducing itself",
    "start": "2425119",
    "end": "2431480"
  },
  {
    "text": "as a a a system binary",
    "start": "2431480",
    "end": "2436720"
  },
  {
    "text": "um lost where I was supposed to be",
    "start": "2440240",
    "end": "2444440"
  },
  {
    "text": "here okay um uh basically right here is where it's showing what it's going to",
    "start": "2452200",
    "end": "2458720"
  },
  {
    "text": "copy itself over as I as I mentioned before the the riched 20. D um and it",
    "start": "2458720",
    "end": "2467440"
  },
  {
    "text": "also places itself originally in a copy of MMC MMC is the Microsoft Management",
    "start": "2467440",
    "end": "2472800"
  },
  {
    "text": "console it's used for most system administration purposes since about N4",
    "start": "2472800",
    "end": "2477880"
  },
  {
    "text": "service PC 4 so um basically what we got going on here",
    "start": "2477880",
    "end": "2483839"
  },
  {
    "text": "is that uh we're uh we create this and then we issue a copy file um so we have",
    "start": "2483839",
    "end": "2490440"
  },
  {
    "text": "our copy that we're running um and we copy it over the top of MMC um next time",
    "start": "2490440",
    "end": "2497079"
  },
  {
    "text": "MMC gets called we we're basically calling nimda and further our infection",
    "start": "2497079",
    "end": "2503960"
  },
  {
    "text": "um it does this for mmc.exe uh load. exe",
    "start": "2503960",
    "end": "2509480"
  },
  {
    "text": "and uh Rich ed20 DOD um it also plays as",
    "start": "2509480",
    "end": "2515160"
  },
  {
    "text": "copies of itself as read me.exe and read me. EML and admin. dll all throughout",
    "start": "2515160",
    "end": "2523280"
  },
  {
    "text": "the hard drive what uh basically it's laying traps for future uh for future",
    "start": "2523280",
    "end": "2528599"
  },
  {
    "text": "clicking um one one of the other things that it does is that it will change uh",
    "start": "2528599",
    "end": "2536880"
  },
  {
    "text": "the the various um uh change the various uh register",
    "start": "2536880",
    "end": "2543760"
  },
  {
    "text": "keys that are out there um some of the ones that it it tends to attack happen to be",
    "start": "2543760",
    "end": "2549839"
  },
  {
    "text": "things like uh keys that specify Security on landman shares in other",
    "start": "2549839",
    "end": "2555559"
  },
  {
    "text": "words by deleting a series of keys it can create basically a zero share po a",
    "start": "2555559",
    "end": "2561400"
  },
  {
    "text": "zero protection on your share policy um meaning that anybody anywhere regardless",
    "start": "2561400",
    "end": "2566599"
  },
  {
    "text": "of the fact that the guest account was taken um anybody anywhere can just connect and have full privileges to your",
    "start": "2566599",
    "end": "2573079"
  },
  {
    "text": "shell or or to your uh shared drives um see here um some of the some of the",
    "start": "2573079",
    "end": "2582079"
  },
  {
    "text": "various keys that it does deal with",
    "start": "2582079",
    "end": "2586200"
  },
  {
    "text": "are um uh this is specifically the one that uses to open",
    "start": "2587640",
    "end": "2594040"
  },
  {
    "text": "shares uh hkey local machine system service Uh current control set Services",
    "start": "2594040",
    "end": "2600720"
  },
  {
    "text": "landman server which is the the services key that's pertinent to all the",
    "start": "2600720",
    "end": "2606160"
  },
  {
    "text": "different landman Services be they shares or uh dealing with RPC and whatnot um this one specifically goes",
    "start": "2606160",
    "end": "2613200"
  },
  {
    "text": "after shares um what we got also going on uh a",
    "start": "2613200",
    "end": "2618599"
  },
  {
    "text": "lot of the code in here um really isn't pertinent to an NT discussion uh there's",
    "start": "2618599",
    "end": "2623920"
  },
  {
    "text": "a lot in here that that only happens on uh Windows 95 Windows 98 and me um uh I",
    "start": "2623920",
    "end": "2631839"
  },
  {
    "text": "just don't really touch those operating systems very much so uh they they don't hold a whole lot of interest but there",
    "start": "2631839",
    "end": "2638079"
  },
  {
    "text": "is a lot of various registry keys that are doing basically the equivalent on",
    "start": "2638079",
    "end": "2643599"
  },
  {
    "text": "95 um we just never see them in our lab because we don't use 95 um uh here's",
    "start": "2643599",
    "end": "2650040"
  },
  {
    "text": "just going through the strings here this is one that you should probably notice um this is why nimda when it first began",
    "start": "2650040",
    "end": "2656520"
  },
  {
    "text": "was being called concept virus uh why they claim it was a Chinese hack uh I I",
    "start": "2656520",
    "end": "2663280"
  },
  {
    "text": "guess it's uh a good idea to copyright your viruses nowadays",
    "start": "2663280",
    "end": "2668400"
  },
  {
    "text": "but I I I guess to uh however you want to do it but um like like I said we go",
    "start": "2668400",
    "end": "2674280"
  },
  {
    "text": "through and we add uh and modify a bunch of registry keys uh things like removing",
    "start": "2674280",
    "end": "2680440"
  },
  {
    "text": "share protection uh opening up uh see if I can find the other one here",
    "start": "2680440",
    "end": "2688359"
  },
  {
    "text": "um oh this one is actually kind of interesting internally nimda is actually using some of the performance monitoring",
    "start": "2688359",
    "end": "2695160"
  },
  {
    "text": "libraries to deal with internal coners um it it uses them to keep track of",
    "start": "2695160",
    "end": "2701680"
  },
  {
    "text": "various things that are happening on the system uh kind of a a different track for uh a virus to take but uh",
    "start": "2701680",
    "end": "2709960"
  },
  {
    "text": "interesting nonetheless um I guess next",
    "start": "2709960",
    "end": "2715160"
  },
  {
    "text": "up um next up on the payload system um",
    "start": "2715160",
    "end": "2721920"
  },
  {
    "text": "nimda will uh take the the windows directory and then file called win anit",
    "start": "2721920",
    "end": "2727920"
  },
  {
    "text": "inii um and this is kind of a hold over from back in the old days um where",
    "start": "2727920",
    "end": "2734000"
  },
  {
    "text": "Windows still used inii instead of the registry uh this file specifically is used often Time by installers to remove",
    "start": "2734000",
    "end": "2742040"
  },
  {
    "text": "or change files that are currently in Access um what Nim did uh is that it",
    "start": "2742040",
    "end": "2748720"
  },
  {
    "text": "would write out to this so that it would have a a series uh potentially deleting",
    "start": "2748720",
    "end": "2755319"
  },
  {
    "text": "files or removing them uh from like temp directories and whatnot trying to hide after itself uh it could have did a lot",
    "start": "2755319",
    "end": "2761760"
  },
  {
    "text": "more here but luckily it didn't um basically what happens is the next time you reboot uh the the series of commands",
    "start": "2761760",
    "end": "2770280"
  },
  {
    "text": "uh put forth in the winin it.i are going to be executed uh",
    "start": "2770280",
    "end": "2775960"
  },
  {
    "text": "supposedly uh nimda screwed with a bunch of installers I we didn't test it that",
    "start": "2775960",
    "end": "2781319"
  },
  {
    "text": "deep but um because it played with this file some files were lost and some",
    "start": "2781319",
    "end": "2787520"
  },
  {
    "text": "installations got screwed up um finally there's one more part of",
    "start": "2787520",
    "end": "2795200"
  },
  {
    "text": "uh of the payload system in nimda that actually",
    "start": "2795200",
    "end": "2801280"
  },
  {
    "text": "maybe no I guess not um ba basically",
    "start": "2801280",
    "end": "2806599"
  },
  {
    "text": "what nimda will do um is it it places itself as load. exe and then it uses",
    "start": "2806599",
    "end": "2814800"
  },
  {
    "text": "uh uh",
    "start": "2814800",
    "end": "2818079"
  },
  {
    "text": "system.ini um",
    "start": "2820800",
    "end": "2824200"
  },
  {
    "text": "and um it places itself as load. exe and then using",
    "start": "2837280",
    "end": "2842920"
  },
  {
    "text": "system.ini um it will go through and make uh an an entry so that it runs",
    "start": "2842920",
    "end": "2849319"
  },
  {
    "text": "load. exe every time it starts meaning every time you start up your machine if nimda is there it's going to be",
    "start": "2849319",
    "end": "2856119"
  },
  {
    "text": "running um nimda attaches itself behind the explorer.exe thread so you won't see",
    "start": "2856119",
    "end": "2861559"
  },
  {
    "text": "anything in the task manager um it IT issues a create remote thread to do that",
    "start": "2861559",
    "end": "2866960"
  },
  {
    "text": "process uh it's the same process that B2K uses to hide a bunch of different",
    "start": "2866960",
    "end": "2872520"
  },
  {
    "text": "spywares use it to hide basically it's a way that you can shift command into a",
    "start": "2872520",
    "end": "2877839"
  },
  {
    "text": "different processes memory space um and that's pretty much uh what I got on nimda here uh kind of concludes",
    "start": "2877839",
    "end": "2886359"
  },
  {
    "text": "our uh in-depth and under the hood of all these different worms what we're going to go over now um you know worms",
    "start": "2886359",
    "end": "2893920"
  },
  {
    "text": "suck there we got to have something to do uh to to keep them from annihilating",
    "start": "2893920",
    "end": "2899119"
  },
  {
    "text": "the internet every 1 to five months um so we we put together our heads and came",
    "start": "2899119",
    "end": "2904640"
  },
  {
    "text": "up with a bunch of different techniques that that we feel um would would really help the internet as a",
    "start": "2904640",
    "end": "2911119"
  },
  {
    "text": "whole in dealing with one keeping worms from ever spreading to begin with and two dealing with them very quickly and",
    "start": "2911119",
    "end": "2917839"
  },
  {
    "text": "effectively when they do actually get out um one of the strongest things is",
    "start": "2917839",
    "end": "2923559"
  },
  {
    "text": "that there really does need to be a common reporting mechanism uh one of the the problems",
    "start": "2923559",
    "end": "2929480"
  },
  {
    "text": "with code red is that there is five different reporting agencies and nobody had any kind of solid statistic",
    "start": "2929480",
    "end": "2935559"
  },
  {
    "text": "statistical analysis nobody had any kind of real Global scope on what it is uh",
    "start": "2935559",
    "end": "2942040"
  },
  {
    "text": "certain people would report to more than one agency certain people would just not report we need a common standard format",
    "start": "2942040",
    "end": "2949240"
  },
  {
    "text": "where anybody that you report to gets correlated in with everybody uh",
    "start": "2949240",
    "end": "2955200"
  },
  {
    "text": "everybody else's data regardless of who you report it to or who you are reporting um to do that we're going to",
    "start": "2955200",
    "end": "2962960"
  },
  {
    "text": "need a lot better data sharing in the information world um we need uh on individual networks we",
    "start": "2962960",
    "end": "2969960"
  },
  {
    "text": "need IDs deployments and and monitoring tools out there that are centralizing",
    "start": "2969960",
    "end": "2976280"
  },
  {
    "text": "their logging and from that we need those centralized logging spots to feed",
    "start": "2976280",
    "end": "2982040"
  },
  {
    "text": "um a an a reporting organ uh agency like security focuses ARS like CER or sand uh",
    "start": "2982040",
    "end": "2991040"
  },
  {
    "text": "any large uh organization that can handle the kind of of uh information",
    "start": "2991040",
    "end": "2996480"
  },
  {
    "text": "that's being pumped to it uh to to even further that we we really need a solid",
    "start": "2996480",
    "end": "3001720"
  },
  {
    "text": "way where Aeros sand C and all these large reporting agencies be the government be the commercial be the any",
    "start": "3001720",
    "end": "3008720"
  },
  {
    "text": "of those um we need a way where these organizations can share data in in a",
    "start": "3008720",
    "end": "3015000"
  },
  {
    "text": "nice Collective manner so that we can get a real honest Global picture of what's going on um unfortunately that",
    "start": "3015000",
    "end": "3023040"
  },
  {
    "text": "that opens up a whole new can of worms um um basically when you have that much data",
    "start": "3023040",
    "end": "3029000"
  },
  {
    "text": "there's it's pretty hard to deal with um what we need to look at is ways that we",
    "start": "3029000",
    "end": "3034640"
  },
  {
    "text": "can reduce uh somebody reporting to two different agencies and that event being counted twice in the global scale of",
    "start": "3034640",
    "end": "3041400"
  },
  {
    "text": "things um or potentially multiple times um uh we need a way where we can do very",
    "start": "3041400",
    "end": "3048640"
  },
  {
    "text": "large scale statistical analysis um you know computing power has grown",
    "start": "3048640",
    "end": "3054040"
  },
  {
    "text": "phenomenally over the the last 10 years 20 years but you know so is the amount",
    "start": "3054040",
    "end": "3059480"
  },
  {
    "text": "of data that we have to deal with on a daily basis so we we need a a a good tradeoff where we can get pertinent data",
    "start": "3059480",
    "end": "3066280"
  },
  {
    "text": "from huge amounts of network sensor data in real or near real",
    "start": "3066280",
    "end": "3072480"
  },
  {
    "text": "time um and the coral are of that is that obviously there would need to be a",
    "start": "3072480",
    "end": "3078720"
  },
  {
    "text": "heavy investment from either a nonprofit organization or a government into huge",
    "start": "3078720",
    "end": "3084640"
  },
  {
    "text": "amounts of storage huge amounts of processing power and of course massive",
    "start": "3084640",
    "end": "3089799"
  },
  {
    "text": "Network bandwidth to be able to handle all of the incoming information and be",
    "start": "3089799",
    "end": "3094920"
  },
  {
    "text": "able to report on it um plus this has to be done uh redundantly of course so that",
    "start": "3094920",
    "end": "3102520"
  },
  {
    "text": "if there is a a denial of service it doesn't become the target so we have to",
    "start": "3102520",
    "end": "3108440"
  },
  {
    "text": "uh we have to look at a lot of different um Avenues but we really do feel that",
    "start": "3108440",
    "end": "3114119"
  },
  {
    "text": "there needs to be a lot more analysis uh on what's actually going on",
    "start": "3114119",
    "end": "3119839"
  },
  {
    "text": "um and on that uh I'm just by looking at the the AIS reports of uh code red 1 and",
    "start": "3119839",
    "end": "3126000"
  },
  {
    "text": "two and the various uh other reports that were done uh that when when a worm",
    "start": "3126000",
    "end": "3131079"
  },
  {
    "text": "is around you can tell Network traffic degrades uh the number of attacks for",
    "start": "3131079",
    "end": "3136960"
  },
  {
    "text": "any specific type of exploit uh just shoot through the roof uh you can tell",
    "start": "3136960",
    "end": "3142960"
  },
  {
    "text": "statistically if it's an automated attack or uh just some kids playing",
    "start": "3142960",
    "end": "3148160"
  },
  {
    "text": "around um 700 uh 700,000 hosts don't get",
    "start": "3148160",
    "end": "3153280"
  },
  {
    "text": "owned in a week uh any way but a worm it just doesn't happen any other way so I",
    "start": "3153280",
    "end": "3159160"
  },
  {
    "text": "if we have good global data um we can see trends like this we can spot worm",
    "start": "3159160",
    "end": "3165040"
  },
  {
    "text": "strikes very early on giving people a chance to disassemble the worm understand what's going on and produce",
    "start": "3165040",
    "end": "3171680"
  },
  {
    "text": "Some solid results on on what needs uh what patches need to be applied and",
    "start": "3171680",
    "end": "3178280"
  },
  {
    "text": "whatnot um one of the other things that you can do um to mitigate worms uh on",
    "start": "3178280",
    "end": "3185359"
  },
  {
    "text": "your own networks uh is to look at the environment that these worms operate in",
    "start": "3185359",
    "end": "3191040"
  },
  {
    "text": "um I mean you can go as uh as far off as the Gartner group says you should and",
    "start": "3191040",
    "end": "3197960"
  },
  {
    "text": "just ditch IAS obviously there won't be any more is worms hitting you however I",
    "start": "3197960",
    "end": "3203559"
  },
  {
    "text": "really don't feel that that solves the problem um sometimes in worms there are",
    "start": "3203559",
    "end": "3209559"
  },
  {
    "text": "lysing deficiencies uh Ling deficiencies in this case uh are based on a a concept",
    "start": "3209559",
    "end": "3216559"
  },
  {
    "text": "written about by Caesar uh in a paper called lysine deficiencies and viral",
    "start": "3216559",
    "end": "3222040"
  },
  {
    "text": "systems I believe uh it's available on www. rootkit",
    "start": "3222040",
    "end": "3227880"
  },
  {
    "text": "docomo Park where there was a a a a a",
    "start": "3229599",
    "end": "3234799"
  },
  {
    "text": "chemical called lysine that was fed to the dinosaurs to make sure that they would continue to live and had any of",
    "start": "3234799",
    "end": "3241559"
  },
  {
    "text": "them broken out they wouldn't be getting their lysine and so they would die worms often times have environmental",
    "start": "3241559",
    "end": "3249880"
  },
  {
    "text": "dependencies that act just like lysine deficiencies uh there are often things",
    "start": "3249880",
    "end": "3255200"
  },
  {
    "text": "that you can do in a in the situation of a wor or a virus that when implemented",
    "start": "3255200",
    "end": "3260559"
  },
  {
    "text": "you can go through and stop that virus from spreading further things like mtic",
    "start": "3260559",
    "end": "3265760"
  },
  {
    "text": "is uh removing mutic is uh for code red there was a not worm file that if that",
    "start": "3265760",
    "end": "3271640"
  },
  {
    "text": "file existed it simply would not spread any further now these are all uh what",
    "start": "3271640",
    "end": "3277079"
  },
  {
    "text": "I'd like to call like half-ass defenses um they're they're not solving the problem they're just stopping it so that",
    "start": "3277079",
    "end": "3283359"
  },
  {
    "text": "you can actually have enough time to go through and solve it um one of the big problems with uh network computing today",
    "start": "3283359",
    "end": "3290400"
  },
  {
    "text": "is that most shops are a monoculture they have one type of system cut",
    "start": "3290400",
    "end": "3295799"
  },
  {
    "text": "uh cut early on and replicated over and over and over now what this does is this gives a very ripe uh environment for any",
    "start": "3295799",
    "end": "3303960"
  },
  {
    "text": "kind of agent that's going to go in there uh be it code red be it an attacker um typically in a situation",
    "start": "3303960",
    "end": "3311960"
  },
  {
    "text": "like that if there's one thing wrong on one machine it's probably going to be replicated to hundreds or even thousands",
    "start": "3311960",
    "end": "3318640"
  },
  {
    "text": "of machines that that makes it really an effective Target for worms and for uh",
    "start": "3318640",
    "end": "3326039"
  },
  {
    "text": "viruses um other times in worms we uh the the worm author makes assumptions uh",
    "start": "3326039",
    "end": "3333319"
  },
  {
    "text": "it hard uh they can hardcode uh Network addresses memory locations or or even do",
    "start": "3333319",
    "end": "3339799"
  },
  {
    "text": "something as weird as design the code so that um it it's assuming Network bite",
    "start": "3339799",
    "end": "3345640"
  },
  {
    "text": "order uh basically uh what what we can do is we can change situations uh it happened",
    "start": "3345640",
    "end": "3353240"
  },
  {
    "text": "during code red where the where the author hardcoded the",
    "start": "3353240",
    "end": "3359480"
  },
  {
    "text": "www.house.gov in uh by by proper alerting and uh action by the network",
    "start": "3359480",
    "end": "3365640"
  },
  {
    "text": "backbone providers we removed a lot of the the potential for problem just by by",
    "start": "3365640",
    "end": "3372160"
  },
  {
    "text": "changing that one assumption um sometimes uh worms do make memory",
    "start": "3372160",
    "end": "3378200"
  },
  {
    "text": "location assumptions uh they assume that this dll is going to be loaded at this Base address or this function is going",
    "start": "3378200",
    "end": "3385559"
  },
  {
    "text": "to be at this specific point in memory uh a lot of times even myself when runting exploits for XYZ server uh to",
    "start": "3385559",
    "end": "3394599"
  },
  {
    "text": "save space all hardcode memory addresses I realized that it only works with the",
    "start": "3394599",
    "end": "3400000"
  },
  {
    "text": "specific instance that I'm at typically a single Service Pack but sometimes that's all you need uh in this case uh",
    "start": "3400000",
    "end": "3408559"
  },
  {
    "text": "the worm used RVA techniques to to get its addresses at run time that's not as",
    "start": "3408559",
    "end": "3414319"
  },
  {
    "text": "uh Ade quit during any of these but uh nonetheless something to consider if if",
    "start": "3414319",
    "end": "3420760"
  },
  {
    "text": "you do change some base addresses on some dlls uh in in your programs uh it",
    "start": "3420760",
    "end": "3426240"
  },
  {
    "text": "could cause uh an exploit to stop working just based on the Merit of uh uh",
    "start": "3426240",
    "end": "3433119"
  },
  {
    "text": "on the fact that your addresses don't line up uh again these are all small",
    "start": "3433119",
    "end": "3438599"
  },
  {
    "text": "steps that you can do to make spreading worms more difficult I I really",
    "start": "3438599",
    "end": "3444880"
  },
  {
    "text": "recommend you know writing solid code uh making sure that uh you know you have a",
    "start": "3444880",
    "end": "3450200"
  },
  {
    "text": "good firewall rule set that you actively watch for new vulnerabilities and that",
    "start": "3450200",
    "end": "3455640"
  },
  {
    "text": "you patch those are the the real honesty goodness finally going to get the worm situation under control but uh there are",
    "start": "3455640",
    "end": "3464839"
  },
  {
    "text": "other options also um this is a a a fairly Hot Topic um",
    "start": "3464839",
    "end": "3473520"
  },
  {
    "text": "that's been beat up on a lot of security mailing lists the concept of a conter worm is writing a worm that uses the",
    "start": "3473520",
    "end": "3481280"
  },
  {
    "text": "same uh propagation methods uh as and infection methods as the original Worm",
    "start": "3481280",
    "end": "3487680"
  },
  {
    "text": "but this time it uh includes a type of fix um as a security professional I'm",
    "start": "3487680",
    "end": "3495160"
  },
  {
    "text": "not sure if this is such a great idea however there have been a lot of very",
    "start": "3495160",
    "end": "3501680"
  },
  {
    "text": "solid arguments to the fact that 700,000 systems uh were owned in about a week's",
    "start": "3501680",
    "end": "3509160"
  },
  {
    "text": "time uh and none of them went to the trouble to do any kind of patching uh",
    "start": "3509160",
    "end": "3515319"
  },
  {
    "text": "even though that was a month old um there are issues with this uh both",
    "start": "3515319",
    "end": "3521599"
  },
  {
    "text": "ethical and Technical um I if you write a a counter worm to attack a specific uh",
    "start": "3521599",
    "end": "3528839"
  },
  {
    "text": "specific series of machines or a specific vulnerability uh what if you write it wrong and it starts crashing machines uh",
    "start": "3528839",
    "end": "3536440"
  },
  {
    "text": "I mean then then you have two rampant worms out there causing trouble um one",
    "start": "3536440",
    "end": "3542480"
  },
  {
    "text": "of the things that if anybody does decide to write one of these um I I really recommend that you put very tight",
    "start": "3542480",
    "end": "3550680"
  },
  {
    "text": "limits um make sure that you're checking every error code that that you're going to be planning uh and make sure that you",
    "start": "3550680",
    "end": "3557400"
  },
  {
    "text": "limit it to specific net blocks that you are actually in control of um we really",
    "start": "3557400",
    "end": "3563440"
  },
  {
    "text": "don't need another worm on the internet um even if it's a helpful worm it's still p uh traffic that's potentially",
    "start": "3563440",
    "end": "3570000"
  },
  {
    "text": "pounding millions of servers every minute you know uh just just not the",
    "start": "3570000",
    "end": "3575400"
  },
  {
    "text": "best way to to go about doing it but uh just like the early Xerox people if you",
    "start": "3575400",
    "end": "3580520"
  },
  {
    "text": "want one for your network yeah that that's your network um finally our our last part",
    "start": "3580520",
    "end": "3587799"
  },
  {
    "text": "here uh is we're going to discuss some of the future of worms um basically",
    "start": "3587799",
    "end": "3593880"
  },
  {
    "text": "again this is us sitting around thinking about looking at what we've seen so far",
    "start": "3593880",
    "end": "3599640"
  },
  {
    "text": "uh and and kind of envisioning where we really think that worms are going to be unfortunately it's not a very bright",
    "start": "3599640",
    "end": "3606920"
  },
  {
    "text": "future um what what we're going to see and",
    "start": "3606920",
    "end": "3612400"
  },
  {
    "text": "actually we are discussing this a little bit before nimda came out and then nimda came out as a proof of concept on this",
    "start": "3612400",
    "end": "3619079"
  },
  {
    "text": "um is that we're going to start seeing some uh different attack vectors like multiple ways that a worm can get into a",
    "start": "3619079",
    "end": "3625599"
  },
  {
    "text": "system nimda had four to five different ways that could infect you I I think that's only going to get bigger and",
    "start": "3625599",
    "end": "3632920"
  },
  {
    "text": "worse uh I I can see attacks using a buffer overflows like code red uh",
    "start": "3632920",
    "end": "3638799"
  },
  {
    "text": "potentially format string attacks um uh attacking things like design flaws and",
    "start": "3638799",
    "end": "3644720"
  },
  {
    "text": "protocols uh is a very under uh under touch subject right now but uh",
    "start": "3644720",
    "end": "3651079"
  },
  {
    "text": "potentially it could be very dangerous to have a worm out there attacking weak Isn numbers uh in the TCP",
    "start": "3651079",
    "end": "3658920"
  },
  {
    "text": "protocol uh and building spoofed Pro uh spoofed sessions just randomly um and finally like open shares",
    "start": "3658920",
    "end": "3667240"
  },
  {
    "text": "that that actually falls under more just bad Computing practice but there there",
    "start": "3667240",
    "end": "3672480"
  },
  {
    "text": "are I I'm anticipating uh worms in the future that that basically pick from a",
    "start": "3672480",
    "end": "3679440"
  },
  {
    "text": "big bucket of potential vulnerabilities typically within the last three months",
    "start": "3679440",
    "end": "3684559"
  },
  {
    "text": "because everybody knows that nobody patches on time um so you you begin to get a A continuing thing where once you",
    "start": "3684559",
    "end": "3693319"
  },
  {
    "text": "have a framework for a worm plugging in new vulnerabilities isn't that",
    "start": "3693319",
    "end": "3699559"
  },
  {
    "text": "difficult um y misconfigurations uh just poor decisions and how you're going to",
    "start": "3699720",
    "end": "3705760"
  },
  {
    "text": "start your system there um one of the other techniques",
    "start": "3705760",
    "end": "3712599"
  },
  {
    "text": "that we've discussed uh a as a as a future of worms is to use less than",
    "start": "3712599",
    "end": "3719559"
  },
  {
    "text": "visible ways of propagating or communicating uh if that's where uh",
    "start": "3719559",
    "end": "3726160"
  },
  {
    "text": "worms may go um one of the things uh uh about covert Channel stuff is that it",
    "start": "3726160",
    "end": "3733000"
  },
  {
    "text": "looks like normal uh normal traffic um they've been able to effectively put",
    "start": "3733000",
    "end": "3738599"
  },
  {
    "text": "data inside things like d uh DNS traffic um uh the the Loki project uh run by",
    "start": "3738599",
    "end": "3746640"
  },
  {
    "text": "Mike schiffman uh was able to successfully",
    "start": "3746640",
    "end": "3751920"
  },
  {
    "text": "embed a full TCP session within icmp uh the these things aren't places where",
    "start": "3751920",
    "end": "3757200"
  },
  {
    "text": "normal people where people normally look to to even think about seeing vir uh",
    "start": "3757200",
    "end": "3762960"
  },
  {
    "text": "virus and worm traffic but um as as as",
    "start": "3762960",
    "end": "3768119"
  },
  {
    "text": "effective measures are being placed for uh watching web worms and email worms",
    "start": "3768119",
    "end": "3774520"
  },
  {
    "text": "they may resort to a a trickier method um that can be uh either non-standard",
    "start": "3774520",
    "end": "3782680"
  },
  {
    "text": "data transmission and it it could be as weird as having modems uh you find a",
    "start": "3782680",
    "end": "3787920"
  },
  {
    "text": "modem on a system and you use it to dial into an internet connection somewhere else and then bounce it off that I you",
    "start": "3787920",
    "end": "3794599"
  },
  {
    "text": "know obviously what can be done and what has been done are completely different",
    "start": "3794599",
    "end": "3800039"
  },
  {
    "text": "but those are some of the things where where we may not actually see",
    "start": "3800039",
    "end": "3805319"
  },
  {
    "text": "uh everything that's going on um one of the other things that we were discussing",
    "start": "3805319",
    "end": "3810920"
  },
  {
    "text": "um is the and this sort of we saw in in the case of nimda um is like a callback",
    "start": "3810920",
    "end": "3818279"
  },
  {
    "text": "mechanism where you send out a mostly encrypted worm uh to a remote system it",
    "start": "3818279",
    "end": "3824440"
  },
  {
    "text": "infects and it all it has is a small kernel uh of functionality there uh what",
    "start": "3824440",
    "end": "3830640"
  },
  {
    "text": "that kernel uh the rest of the code that you shipped was either encrypted or physically not even there uh what the",
    "start": "3830640",
    "end": "3836799"
  },
  {
    "text": "colonel serves to do is to call back to the host that infected it and either",
    "start": "3836799",
    "end": "3841839"
  },
  {
    "text": "request the key to decrypt the rest of that information or potentially get new",
    "start": "3841839",
    "end": "3847839"
  },
  {
    "text": "chunks of information um basically what this would do is it sets up a a system",
    "start": "3847839",
    "end": "3853240"
  },
  {
    "text": "of communication between worms that could potentially lead to much bigger",
    "start": "3853240",
    "end": "3858760"
  },
  {
    "text": "and worse things the other thing is is that if I have a a completely encrypted binary it's based on key information",
    "start": "3858760",
    "end": "3866039"
  },
  {
    "text": "that I don't have it makes it nearly impossible to correctly decode that",
    "start": "3866039",
    "end": "3871319"
  },
  {
    "text": "binary so rather than using a netcat listener to look at one thing unless you",
    "start": "3871319",
    "end": "3876720"
  },
  {
    "text": "see that second part you're not going to have everything that you need to disassemble that worm or do any kind of",
    "start": "3876720",
    "end": "3882839"
  },
  {
    "text": "analysis on it um what we uh what we may see also is a",
    "start": "3882839",
    "end": "3890520"
  },
  {
    "text": "a a cross between worms and viruses um polymorphic viruses have been around since the early uh early to mid 80s uh",
    "start": "3890520",
    "end": "3899599"
  },
  {
    "text": "basically a polymorphic virus is one that changes every time it's run it re-encrypts itself or re-encodes itself",
    "start": "3899599",
    "end": "3906680"
  },
  {
    "text": "uh using a different method um this is designed to foil uh most uh static signature-based",
    "start": "3906680",
    "end": "3915079"
  },
  {
    "text": "anti virus uh things but the same concept could be applied to a polymorphic virus to avoid IDs detection",
    "start": "3915079",
    "end": "3923000"
  },
  {
    "text": "uh K2 uh did a recently did a a talk on",
    "start": "3923000",
    "end": "3928400"
  },
  {
    "text": "polymorphic Shell Code this is roughly around the same idea where it goes",
    "start": "3928400",
    "end": "3933599"
  },
  {
    "text": "through and every time the virus is spread it's mildly different it doesn't have to be extremely different it just",
    "start": "3933599",
    "end": "3940400"
  },
  {
    "text": "has to be different enough where it won't match the signatures out there um",
    "start": "3940400",
    "end": "3946400"
  },
  {
    "text": "potentially I I if virus writers do get involved um you you could even go go as",
    "start": "3946400",
    "end": "3954359"
  },
  {
    "text": "far as to see a a mutation design where it specifically will once injected will",
    "start": "3954359",
    "end": "3961960"
  },
  {
    "text": "attempt to find better offsets or different offsets uh often times when",
    "start": "3961960",
    "end": "3967680"
  },
  {
    "text": "when an IDs signature is based it looks for where where specific offsets are um",
    "start": "3967680",
    "end": "3975680"
  },
  {
    "text": "to to tag that now the problem with that is that if I find a different offset that's equal or better uh it it doesn't",
    "start": "3975680",
    "end": "3983240"
  },
  {
    "text": "matter I that the IDS signature is now broken so um basically a lot of people",
    "start": "3983240",
    "end": "3989319"
  },
  {
    "text": "were looking at that very first string of Code Red the the bunch of ends and then percent you this this this this",
    "start": "3989319",
    "end": "3997279"
  },
  {
    "text": "well that that doesn't automatically make it a good choice um what what can",
    "start": "3997279",
    "end": "4003119"
  },
  {
    "text": "happen even uh there there's a ton of different profiling techniques out there in theory you could have a virus that's",
    "start": "4003119",
    "end": "4010200"
  },
  {
    "text": "profiling itself and making it smaller faster smarter uh you know uh there",
    "start": "4010200",
    "end": "4016039"
  },
  {
    "text": "there is no potential limit to how far that's gone and these are the sad part",
    "start": "4016039",
    "end": "4021079"
  },
  {
    "text": "about it is that this isn't just speculation techniques like this have been used in virus writing so it it's a",
    "start": "4021079",
    "end": "4029240"
  },
  {
    "text": "it's a pretty scary thought when virus uh writers actually sit down and learn enough security where they can start",
    "start": "4029240",
    "end": "4035440"
  },
  {
    "text": "writing worms um uh there uh after Code Red there was",
    "start": "4035440",
    "end": "4041240"
  },
  {
    "text": "a con uh a concept bed around the concept of flash worms a flash worm um",
    "start": "4041240",
    "end": "4048480"
  },
  {
    "text": "is estimated to uh be like a a pre-targeted system uh",
    "start": "4048480",
    "end": "4055160"
  },
  {
    "text": "where if I infect a host along with that infection I send it a chunk of address",
    "start": "4055160",
    "end": "4061520"
  },
  {
    "text": "space that I needed to infect further uh what it requires is it requires a good",
    "start": "4061520",
    "end": "4067119"
  },
  {
    "text": "topological understanding of the internet and the ability to Target host",
    "start": "4067119",
    "end": "4072200"
  },
  {
    "text": "selectively um in theory uh if there wasn't a lot of duplication or Randomness in Target",
    "start": "4072200",
    "end": "4078920"
  },
  {
    "text": "selection uh potentially every potential host that could be infected would be",
    "start": "4078920",
    "end": "4085319"
  },
  {
    "text": "infected within between 5 and 20 minutes now the this concept is kind of a long",
    "start": "4085319",
    "end": "4090599"
  },
  {
    "text": "ways away because obviously if you knew every infectable host before you uh went out you'd have to pre-scan huge chunks",
    "start": "4090599",
    "end": "4098238"
  },
  {
    "text": "of the internet however a a hybrid between say uh code uh what Code Red 2",
    "start": "4098239",
    "end": "4105359"
  },
  {
    "text": "did with the local uh uh probability and a better targeting mechanism could",
    "start": "4105359",
    "end": "4112318"
  },
  {
    "text": "greatly increase the speed that a worm could spread um again flash worms require a very low",
    "start": "4112319",
    "end": "4120560"
  },
  {
    "text": "false positive rate because you already know what you're going to infect it's a Cascade um but they have the benefit of",
    "start": "4120560",
    "end": "4128318"
  },
  {
    "text": "no matter what kind of reporting mechanism we have uh if we see a statistical Spike from uh basically zero",
    "start": "4128319",
    "end": "4136359"
  },
  {
    "text": "attacks an hour up to 50 million attacks an hour and then it's gone the next hour we really don't have anything to to go",
    "start": "4136359",
    "end": "4143560"
  },
  {
    "text": "on uh unless constant monitoring and a a capture can be taken",
    "start": "4143560",
    "end": "4150798"
  },
  {
    "text": "yes I it it's um just a uh as a guess",
    "start": "4161640",
    "end": "4167838"
  },
  {
    "text": "typically um you know we get a lot of binaries uh and like I said I'm an",
    "start": "4167839",
    "end": "4173960"
  },
  {
    "text": "application developer so most of my time is spent writing code not disassembling it but when we get a binary I'll usually",
    "start": "4173960",
    "end": "4180838"
  },
  {
    "text": "invest between a half hour uh and 45 minutes on it to see if there is anything interesting going on in it um",
    "start": "4180839",
    "end": "4188600"
  },
  {
    "text": "if I do find that I I I'll usually devote between uh two and four hours to uh to",
    "start": "4188600",
    "end": "4195880"
  },
  {
    "text": "get a pretty good high level um complete disassembly of of a program typically",
    "start": "4195880",
    "end": "4201520"
  },
  {
    "text": "takes between um between 5 hours and 30 hours uh like",
    "start": "4201520",
    "end": "4208920"
  },
  {
    "text": "a a smaller troen type program",
    "start": "4208920",
    "end": "4213360"
  },
  {
    "text": "um yeah I I I mean there there are there are some very very crazy things I",
    "start": "4217440",
    "end": "4223719"
  },
  {
    "text": "Concepts like Java worms um Java isn't invulnerable to malicious remote agent",
    "start": "4223719",
    "end": "4230320"
  },
  {
    "text": "code no matter what anybody says if the permissions are there java can spread",
    "start": "4230320",
    "end": "4235880"
  },
  {
    "text": "from one jvm to another which is similar to what you're talking about",
    "start": "4235880",
    "end": "4242039"
  },
  {
    "text": "but",
    "start": "4242440",
    "end": "4245440"
  },
  {
    "text": "exactly exactly IED",
    "start": "4248520",
    "end": "4254800"
  },
  {
    "text": "hours I I believe that um I Ida is extendable you can write your own",
    "start": "4254800",
    "end": "4260400"
  },
  {
    "text": "disassembly uh Tools in it but it is a horrible pin in the ass to have to do",
    "start": "4260400",
    "end": "4267320"
  },
  {
    "text": "that",
    "start": "4268920",
    "end": "4271920"
  },
  {
    "text": "certainly oh I there there uh the future worms it's only going to get harder to",
    "start": "4279440",
    "end": "4285000"
  },
  {
    "text": "analyze and it's the worms are only going to get faster basically we have to",
    "start": "4285000",
    "end": "4290199"
  },
  {
    "text": "uh we have to focus on making sure that one when a worm strike happens we know about it and two everybody that's",
    "start": "4290199",
    "end": "4296520"
  },
  {
    "text": "willing to do any kind of work uh on worm disassembly is involved and armed",
    "start": "4296520",
    "end": "4301760"
  },
  {
    "text": "with information and tools to do it correctly yes I think sty work also will",
    "start": "4301760",
    "end": "4309000"
  },
  {
    "text": "be live on the internet because lot of",
    "start": "4309000",
    "end": "4314320"
  },
  {
    "text": "people learning to write code and want to write the own worm will will put",
    "start": "4314320",
    "end": "4320639"
  },
  {
    "text": "together very fast I",
    "start": "4320639",
    "end": "4324440"
  },
  {
    "text": "thinking absolutely all users then some password",
    "start": "4327560",
    "end": "4332840"
  },
  {
    "text": "on every user then the system and then next I",
    "start": "4332840",
    "end": "4337880"
  },
  {
    "text": "think that kind of worm will be",
    "start": "4337880",
    "end": "4344080"
  },
  {
    "text": "very easily absolutely I",
    "start": "4344080",
    "end": "4350280"
  },
  {
    "text": "and should be afraid the absolutely uh guest passwords are",
    "start": "4352199",
    "end": "4358000"
  },
  {
    "text": "still one of the worst problems with computer security uh easily guessable stuff I there there are so many uh right",
    "start": "4358000",
    "end": "4365480"
  },
  {
    "text": "now this entire talk has been focusing on uh like buffer overflow exploitations",
    "start": "4365480",
    "end": "4370960"
  },
  {
    "text": "and stuff but the the concept of open shares the concept of guest passwords uh",
    "start": "4370960",
    "end": "4377280"
  },
  {
    "text": "all of these things are glossed over a lot of times when it comes to security but any kind of misconfiguration as long",
    "start": "4377280",
    "end": "4384719"
  },
  {
    "text": "as it's prolific can be the base of a worm be it uh a technical problem like a",
    "start": "4384719",
    "end": "4390080"
  },
  {
    "text": "buffer overflow or like a open share uh I I guarantee if you guys go home and",
    "start": "4390080",
    "end": "4396440"
  },
  {
    "text": "look on your networks there's probably at least one share that doesn't require a password now making sure that those",
    "start": "4396440",
    "end": "4402760"
  },
  {
    "text": "are all closed is the first step the other problem is is once you have a username through a",
    "start": "4402760",
    "end": "4408239"
  },
  {
    "text": "password guessing account or by hijacking somebody's Machine by sending him a Trojan then you have the next",
    "start": "4408239",
    "end": "4415199"
  },
  {
    "text": "level of problems where you you are an authenticated user on that Network so it",
    "start": "4415199",
    "end": "4420520"
  },
  {
    "text": "it's not going to stop at any point in time in the near future so uh basically what we need is we need to like I said",
    "start": "4420520",
    "end": "4428120"
  },
  {
    "text": "we need to be smarter about it and faster about it we need more people who can do it and we need them to be able to",
    "start": "4428120",
    "end": "4434000"
  },
  {
    "text": "share their information very fluidly",
    "start": "4434000",
    "end": "4439480"
  },
  {
    "text": "um uh the next one um and this is from some work that we were looking at",
    "start": "4439480",
    "end": "4444719"
  },
  {
    "text": "through intelligent agents uh is uh a type of worm net uh once say a thousand",
    "start": "4444719",
    "end": "4452440"
  },
  {
    "text": "worms are uh infected uh they they go into stasis and they only talk within",
    "start": "4452440",
    "end": "4457840"
  },
  {
    "text": "each other uh sending encoded messages uh intelligent agents tend to uh call",
    "start": "4457840",
    "end": "4465159"
  },
  {
    "text": "this uh uh k a knowledge interchange format um and there has been a lot of",
    "start": "4465159",
    "end": "4471560"
  },
  {
    "text": "work done legitimately based on agents that are able to dock to different ports",
    "start": "4471560",
    "end": "4477840"
  },
  {
    "text": "on the network and and do work in in the name of somebody um this is basically",
    "start": "4477840",
    "end": "4483880"
  },
  {
    "text": "the malicious equivalent uh where I send out a th probes and I hook on to your",
    "start": "4483880",
    "end": "4490960"
  },
  {
    "text": "system at these thousand vulnerable points points and then each one of these thousand vulnerable points can share",
    "start": "4490960",
    "end": "4497480"
  },
  {
    "text": "information with any of the other nodes um and basically sooner or later you begin to build the concept of the",
    "start": "4497480",
    "end": "4504080"
  },
  {
    "text": "internet where by knowing a an internal routing table you can get a message to",
    "start": "4504080",
    "end": "4509320"
  },
  {
    "text": "any worm on that Network um uh they could be uh exchanging information say",
    "start": "4509320",
    "end": "4516239"
  },
  {
    "text": "like uh what's what's a best targeted Network once you have a thousand hosts start sharing targeting information so",
    "start": "4516239",
    "end": "4523000"
  },
  {
    "text": "that the host don't replicate Target blocks um uh and obviously as this",
    "start": "4523000",
    "end": "4529440"
  },
  {
    "text": "network grows there's there's more traffic iner uh involved in it um uh",
    "start": "4529440",
    "end": "4535800"
  },
  {
    "text": "other information that they can share uh What uh if the worm is modular it's possible to ship a new chunk of binary",
    "start": "4535800",
    "end": "4543239"
  },
  {
    "text": "code out to a single worm on this a single node on this worm Network and have it replicate to all these different",
    "start": "4543239",
    "end": "4549880"
  },
  {
    "text": "things and Bam you you can hit the latest zero day only vulnerability so",
    "start": "4549880",
    "end": "4555120"
  },
  {
    "text": "worms of this type although they're very complex uh and and will be very",
    "start": "4555120",
    "end": "4560400"
  },
  {
    "text": "difficult to to Target and disassemble um may be kind of what we're",
    "start": "4560400",
    "end": "4566040"
  },
  {
    "text": "looking at in the future here um another thing that that worms uh",
    "start": "4566040",
    "end": "4571800"
  },
  {
    "text": "and actually security research has been uh tagged on a little bit recently here",
    "start": "4571800",
    "end": "4576840"
  },
  {
    "text": "um is multi OS Shell Code uh basically uh it would be great if a",
    "start": "4576840",
    "end": "4583600"
  },
  {
    "text": "single worm uh with a single vulnerability say like the the telnet Dev vulnerability uh could hit all the",
    "start": "4583600",
    "end": "4590960"
  },
  {
    "text": "free BSD open BSD Alpha uh Linux Alpha systems Linux Intel systems and",
    "start": "4590960",
    "end": "4597320"
  },
  {
    "text": "basically have Shell Code that's smart enough to execute the correct bits based on how",
    "start": "4597320",
    "end": "4604280"
  },
  {
    "text": "the how the operating system interacts and how the the processor architecture interacts um yeah we're still even the",
    "start": "4604280",
    "end": "4612159"
  },
  {
    "text": "security community is still a ways away from this uh but it has come a long way I believe uh two",
    "start": "4612159",
    "end": "4619440"
  },
  {
    "text": "years ago at Defcon they were able to get shell code to uh work on both I",
    "start": "4619440",
    "end": "4624880"
  },
  {
    "text": "believe a FreeBSD Intel and a myips machine uh running Iris uh with a single",
    "start": "4624880",
    "end": "4630320"
  },
  {
    "text": "code base now of course there's um there there's always a possibility that you",
    "start": "4630320",
    "end": "4635960"
  },
  {
    "text": "keep two copies of an exploit along with your worm so if you come up against an open BSD box you use the open BSD",
    "start": "4635960",
    "end": "4642679"
  },
  {
    "text": "version or the uh up against a Linux box you're going to use the Linux version um",
    "start": "4642679",
    "end": "4649840"
  },
  {
    "text": "basically that that requires a very large database of exploitation techniques where typically worms tend to",
    "start": "4649840",
    "end": "4657440"
  },
  {
    "text": "be small and fast um there uh but uh if",
    "start": "4657440",
    "end": "4662760"
  },
  {
    "text": "it means attacking another 100,000 systems from having that database sometimes that tradeoff may be worth it",
    "start": "4662760",
    "end": "4669199"
  },
  {
    "text": "to the worm author I guess we're open to question questions and answers here yes in the",
    "start": "4669199",
    "end": "4676920"
  },
  {
    "text": "back um I believe there was actually a worm similar to that um early on I believe uh the ADM worm uh the attack",
    "start": "4694600",
    "end": "4703000"
  },
  {
    "text": "DNS servers uh went through and uh it w it because it wasn't very public it",
    "start": "4703000",
    "end": "4708719"
  },
  {
    "text": "didn't attack a ton of systems but you're right absolutely in in that case uh finding statistical analysis of uh of",
    "start": "4708719",
    "end": "4717159"
  },
  {
    "text": "worm attacks is pretty difficult however luckily sooner or later you pass a threshold there uh unless there's some",
    "start": "4717159",
    "end": "4725400"
  },
  {
    "text": "uh information being passed around uh sooner or later if you infect enough",
    "start": "4725400",
    "end": "4730880"
  },
  {
    "text": "hosts you will begin to show show off on the radar so to speak uh the the the other flip side of that is that assuming",
    "start": "4730880",
    "end": "4739480"
  },
  {
    "text": "that it's even a mildly interesting vulnerability uh that that is exploiting",
    "start": "4739480",
    "end": "4744760"
  },
  {
    "text": "um the lifetime of that vulnerability probably isn't exceptionally long um the",
    "start": "4744760",
    "end": "4751120"
  },
  {
    "text": "the sad fact of the matter is that the next code red that comes out and and wipes out a system even it's not using",
    "start": "4751120",
    "end": "4757080"
  },
  {
    "text": "the same vulnerability it may be a rollup patch that will fix your vulnerability um",
    "start": "4757080",
    "end": "4764840"
  },
  {
    "text": "absolutely absolutely I and that's the one thing that you have to remember is that you can't make assumptions about",
    "start": "4776639",
    "end": "4782840"
  },
  {
    "text": "virus readers and uh like I said the the unknown unnamed worm that I showed you",
    "start": "4782840",
    "end": "4789040"
  },
  {
    "text": "uh was basically the same inform and function as code red but it was attacking a horribly old vulnerability",
    "start": "4789040",
    "end": "4795199"
  },
  {
    "text": "and the fact that it ever spread at all completely amazes me but there are still people out there that have nt4 service",
    "start": "4795199",
    "end": "4802520"
  },
  {
    "text": "PC 3 machines and and that that's a vulnerable machine uh I if that worm and",
    "start": "4802520",
    "end": "4809199"
  },
  {
    "text": "that worm may still be cycling through the internet I I'm not even positive um",
    "start": "4809199",
    "end": "4815440"
  },
  {
    "text": "but uh if there's machine if if there's food the worm will continue to grow uh",
    "start": "4815440",
    "end": "4821320"
  },
  {
    "text": "basically we need at anytime we target a worm we have to cut off the food supply",
    "start": "4821320",
    "end": "4826800"
  },
  {
    "text": "in the fastest easiest method any more",
    "start": "4826800",
    "end": "4832080"
  },
  {
    "text": "questions cool okay thanks",
    "start": "4835159",
    "end": "4839920"
  },
  {
    "text": "guys",
    "start": "4851719",
    "end": "4854719"
  },
  {
    "text": "e",
    "start": "4881639",
    "end": "4884639"
  },
  {
    "text": "e",
    "start": "4911639",
    "end": "4914639"
  },
  {
    "text": "e",
    "start": "4971560",
    "end": "4974560"
  },
  {
    "text": "e",
    "start": "5001480",
    "end": "5004480"
  },
  {
    "text": "e",
    "start": "5031480",
    "end": "5034480"
  },
  {
    "text": "e",
    "start": "5061360",
    "end": "5064360"
  },
  {
    "text": "e",
    "start": "5091360",
    "end": "5094360"
  },
  {
    "text": "e",
    "start": "5151280",
    "end": "5154280"
  },
  {
    "text": "e",
    "start": "5181199",
    "end": "5184199"
  },
  {
    "text": "e",
    "start": "5211199",
    "end": "5214199"
  },
  {
    "text": "e",
    "start": "5241119",
    "end": "5244119"
  },
  {
    "text": "e",
    "start": "5271119",
    "end": "5274119"
  },
  {
    "text": "e",
    "start": "5301040",
    "end": "5304040"
  },
  {
    "text": "e",
    "start": "5331000",
    "end": "5334000"
  },
  {
    "text": "e",
    "start": "5360920",
    "end": "5363920"
  },
  {
    "text": "e",
    "start": "5390920",
    "end": "5393920"
  },
  {
    "text": "e",
    "start": "5420840",
    "end": "5423840"
  },
  {
    "text": "e",
    "start": "5450840",
    "end": "5453840"
  },
  {
    "text": "e",
    "start": "5480760",
    "end": "5483760"
  },
  {
    "text": "e",
    "start": "6169760",
    "end": "6172760"
  }
]