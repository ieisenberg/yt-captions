[
  {
    "text": "afternoon everyone I'm TT Lanka we are",
    "start": "709",
    "end": "6120"
  },
  {
    "text": "from Taiwan we are front in T 5 and 10 t5 research and the topic of this talk",
    "start": "6120",
    "end": "13590"
  },
  {
    "text": "is you can see you cannot see me a Mac OS rocket uses the tricks you haven't",
    "start": "13590",
    "end": "21779"
  },
  {
    "text": "known yet since there are more and more people start using Mac so attacking Mac",
    "start": "21779",
    "end": "29519"
  },
  {
    "text": "OS has become a trend as we see more and more malware with advanced attack",
    "start": "29519",
    "end": "36510"
  },
  {
    "text": "techniques make OS X in order to gain persistent control and avoid detection",
    "start": "36510",
    "end": "43500"
  },
  {
    "text": "malware has started to attack a rootkit tricks so in this talk we are going to",
    "start": "43500",
    "end": "50460"
  },
  {
    "text": "introduce several new rootkit tricks that couldn't be detected by existing",
    "start": "50460",
    "end": "57239"
  },
  {
    "text": "security software right ananka and me",
    "start": "57239",
    "end": "62969"
  },
  {
    "text": "found identify research in Taiwan recently and where we are doing cyber",
    "start": "62969",
    "end": "68430"
  },
  {
    "text": "threat research we monitor analyze and trick substrates throughout the",
    "start": "68430",
    "end": "75530"
  },
  {
    "text": "asia-pacific region we are also very interested in variability and",
    "start": "75530",
    "end": "82189"
  },
  {
    "text": "variability research not only analyzed exploit and variability that is used by",
    "start": "82189",
    "end": "90650"
  },
  {
    "text": "injury or attack we are also happy to look for new problems in a new problem",
    "start": "90650",
    "end": "97020"
  },
  {
    "text": "or in new technology we are also members",
    "start": "97020",
    "end": "102090"
  },
  {
    "text": "of changer security group in Taiwan and we hope he come every year I am the",
    "start": "102090",
    "end": "107729"
  },
  {
    "text": "Recon organizer he Kong is the largest security conference in Taiwan and we",
    "start": "107729",
    "end": "114930"
  },
  {
    "text": "have like about 800 attendees every year ok so many people say that Taiwan is a",
    "start": "114930",
    "end": "124920"
  },
  {
    "text": "country without without natural resource actually it is wrong Taiwan has the most",
    "start": "124920",
    "end": "131129"
  },
  {
    "text": "abundant cyber attack natural resource in the war especially apt and target",
    "start": "131129",
    "end": "136470"
  },
  {
    "text": "examples you know many I think many apt researchers they are eager for - to look",
    "start": "136470",
    "end": "144450"
  },
  {
    "text": "for simples because because it is not easy to get samples but we it is not",
    "start": "144450",
    "end": "150840"
  },
  {
    "text": "very difficult in Taiwan because you know through two political issues and so you know the picture shows the picture",
    "start": "150840",
    "end": "158400"
  },
  {
    "text": "is from Marzotto and Taiwan the summation from a Taiwan is ranked number two so doing several",
    "start": "158400",
    "end": "169950"
  },
  {
    "text": "three research in Taiwan is interesting so this is a short introduction of me",
    "start": "169950",
    "end": "176100"
  },
  {
    "text": "you my name is something and you can trust committee which is easier and I'm",
    "start": "176100",
    "end": "181800"
  },
  {
    "text": "the leader of team Tifa research and we like astray and permeability research",
    "start": "181800",
    "end": "188990"
  },
  {
    "text": "ananka is our chief researcher he is a well known viability researcher and has",
    "start": "188990",
    "end": "195000"
  },
  {
    "text": "been disclosed in Newbern ability for many years and his major area of",
    "start": "195000",
    "end": "202190"
  },
  {
    "text": "expertise include BraunAbility research exploit techniques malware detection",
    "start": "202190",
    "end": "208530"
  },
  {
    "text": "mobile security and he discovered numerous in Windows system and document",
    "start": "208530",
    "end": "213720"
  },
  {
    "text": "application volatilities and so he released many today and report to",
    "start": "213720",
    "end": "219120"
  },
  {
    "text": "Microsoft before and three in recent years we have started exploration and",
    "start": "219120",
    "end": "228570"
  },
  {
    "text": "discovery in programs and mccoys and non-current me frequently give",
    "start": "228570",
    "end": "234990"
  },
  {
    "text": "presentations in many security conferences all right so okay this is",
    "start": "234990",
    "end": "240690"
  },
  {
    "text": "the these are the topics we are going to discuss today and more than five tricks",
    "start": "240690",
    "end": "246959"
  },
  {
    "text": "we are going to show you and we will show you some advanced process hiding",
    "start": "246959",
    "end": "252840"
  },
  {
    "text": "techniques and how to become a privileged normal user and how to direct",
    "start": "252840",
    "end": "260340"
  },
  {
    "text": "access kernel memory from user space and also I'll make OS 10.9",
    "start": "260340",
    "end": "267979"
  },
  {
    "text": "you know there is a security check security warning that if you want to load third-party kernel module you have",
    "start": "267990",
    "end": "275259"
  },
  {
    "text": "got a warning but we will show you how to load a malicious kernel module",
    "start": "275259",
    "end": "280479"
  },
  {
    "text": "without warnings and finally we'll I will show you a trick to gain root",
    "start": "280479",
    "end": "286960"
  },
  {
    "text": "permission okay so the first topic advanced process hiding oh yeah let me",
    "start": "286960",
    "end": "296650"
  },
  {
    "text": "introduce the ruble in Rockets it is it was released for disclosure in 2012 and",
    "start": "296650",
    "end": "304680"
  },
  {
    "text": "claim that capabilities that you can see like hiding files hide in the process",
    "start": "304680",
    "end": "311860"
  },
  {
    "text": "hiding a user hiding a network connection so yeah it is very famous",
    "start": "311860",
    "end": "319680"
  },
  {
    "text": "yeah and because it is open source so it shows how shows people how to implement",
    "start": "319680",
    "end": "326889"
  },
  {
    "text": "look it and make OS and also although it",
    "start": "326889",
    "end": "332469"
  },
  {
    "text": "is already two years old it is still many people are still discussing about",
    "start": "332469",
    "end": "338289"
  },
  {
    "text": "this and we are going to and yeah but there are many features but we only we",
    "start": "338289",
    "end": "345250"
  },
  {
    "text": "are going to focus on the process hiding okay so this is horrible in height",
    "start": "345250",
    "end": "352779"
  },
  {
    "text": "process it directly modified kernel objects to unlink a process for from the",
    "start": "352779",
    "end": "360039"
  },
  {
    "text": "link linking list so it is a typical TK om approach to to hide process and this",
    "start": "360039",
    "end": "372610"
  },
  {
    "text": "is the process structure in kernel in Mac OS kernel and the P list is the",
    "start": "372610",
    "end": "380020"
  },
  {
    "text": "linked list is a linked list it is the list of our process the first",
    "start": "380020",
    "end": "385659"
  },
  {
    "text": "element is a list of our process so",
    "start": "385659",
    "end": "391139"
  },
  {
    "text": "ruling just okay so Reuben just yeah",
    "start": "391139",
    "end": "396819"
  },
  {
    "text": "unlink list and you probably noticed that Poynter this the third element is a task",
    "start": "396819",
    "end": "406240"
  },
  {
    "text": "pointer I will point to another task object and so o1 process object will",
    "start": "406240",
    "end": "413830"
  },
  {
    "text": "have one person process object have a text object so actually all text arrow",
    "start": "413830",
    "end": "423309"
  },
  {
    "text": "tasks are also in another linkedlist so you as you can see on the task is the",
    "start": "423309",
    "end": "432809"
  },
  {
    "text": "there is a chain a couch and a task that is a linked list of all tasks so there's",
    "start": "432809",
    "end": "440830"
  },
  {
    "text": "there's another linked list okay so detecting rebuilding process",
    "start": "440830",
    "end": "446469"
  },
  {
    "text": "hiding is trivial that the word rebuilding hide process is very simple",
    "start": "446469",
    "end": "452319"
  },
  {
    "text": "so it is it just on links appear list too hard process so detecting troubling",
    "start": "452319",
    "end": "458709"
  },
  {
    "text": "is not difficult we can easily detect rebuilding process hiding by listing",
    "start": "458709",
    "end": "464709"
  },
  {
    "text": "tasks and comparing with process so if yeah if the process is not showing in",
    "start": "464709",
    "end": "471849"
  },
  {
    "text": "the task so that is that means someone is pounding",
    "start": "471849",
    "end": "476889"
  },
  {
    "text": "someone did unlink the process okay so",
    "start": "476889",
    "end": "483219"
  },
  {
    "text": "and rebuilding actually cannot hide from active monitor if you cannot see hided",
    "start": "483219",
    "end": "490149"
  },
  {
    "text": "process using you it can only hide from PS the PS come in you type PS and you",
    "start": "490149",
    "end": "496689"
  },
  {
    "text": "cannot see a process but if you use active monitor it will see the process",
    "start": "496689",
    "end": "501729"
  },
  {
    "text": "that I did by Ruben and another information is Ruben cannot run",
    "start": "501729",
    "end": "507999"
  },
  {
    "text": "I can only run on 10.7 okay so",
    "start": "507999",
    "end": "514229"
  },
  {
    "text": "volatility is a very well-known memory forensic tool and new version of",
    "start": "514229",
    "end": "520149"
  },
  {
    "text": "volatility suppose Mac OS X so it can scan a memory dump from from McCoy's and",
    "start": "520149",
    "end": "527560"
  },
  {
    "text": "so it can detect Ruby in your kids as well of course",
    "start": "527560",
    "end": "533370"
  },
  {
    "text": "okay so uh in Mac OS kernel process and tasks is actually very complicated there",
    "start": "533640",
    "end": "540750"
  },
  {
    "text": "are several linkedlist to change those objects not only all process and tasks there are a",
    "start": "540750",
    "end": "547290"
  },
  {
    "text": "lot so volatility volatility check several incan list as well to make sure",
    "start": "547290",
    "end": "554130"
  },
  {
    "text": "there is no invisible process so we are",
    "start": "554130",
    "end": "560070"
  },
  {
    "text": "we try to bypass volatility so we unlink plist",
    "start": "560070",
    "end": "565890"
  },
  {
    "text": "we aren't linked pH we only PG list we are linked text so then we can bypass",
    "start": "565890",
    "end": "572850"
  },
  {
    "text": "volatility so this is the way we bypass it okay let's see a demo",
    "start": "572850",
    "end": "583130"
  },
  {
    "text": "okay in the beginning we launched a calculator and the PID of calculator is",
    "start": "600860",
    "end": "609240"
  },
  {
    "text": "200",
    "start": "609240",
    "end": "611990"
  },
  {
    "text": "right and now we will load our rocket our kernel module and we use si si si",
    "start": "624780",
    "end": "633690"
  },
  {
    "text": "just city control to specify the PID that we would like to to height all",
    "start": "633690",
    "end": "647280"
  },
  {
    "text": "right so you as you can see the our calculator is missed in the active",
    "start": "647280",
    "end": "652530"
  },
  {
    "text": "monitor so now this process is invisible now and now we we're trying to dump",
    "start": "652530",
    "end": "666990"
  },
  {
    "text": "memory",
    "start": "666990",
    "end": "669770"
  },
  {
    "text": "it requires some time right um okay so",
    "start": "691320",
    "end": "696600"
  },
  {
    "text": "now we can use volatility to to show that this is a we use volatility to read",
    "start": "696600",
    "end": "704670"
  },
  {
    "text": "their memory to pass the memory dump and to see if there is the process take you",
    "start": "704670",
    "end": "712620"
  },
  {
    "text": "later so as you can see it is sorted by PID",
    "start": "712620",
    "end": "721500"
  },
  {
    "text": "and the PID 200 is missed not not shown here yeah so now use this approach we",
    "start": "721500",
    "end": "729720"
  },
  {
    "text": "can bypass volatility",
    "start": "729720",
    "end": "733339"
  },
  {
    "text": "okay so height and detect a process is like an cat-and-mouse game in Colonel",
    "start": "746890",
    "end": "754690"
  },
  {
    "text": "and when some someone release a new way to detect there is always a new way to",
    "start": "754690",
    "end": "760090"
  },
  {
    "text": "bypass it's you know if you need the approach you you have yet in future",
    "start": "760090",
    "end": "766660"
  },
  {
    "text": "there definitely someone will bypass you or detect you so you know doing this",
    "start": "766660",
    "end": "771760"
  },
  {
    "text": "stuff is really hard works you need to take into complicated color objects you",
    "start": "771760",
    "end": "776890"
  },
  {
    "text": "need to implement a kernel module you need to guarantee the speed stability of",
    "start": "776890",
    "end": "782290"
  },
  {
    "text": "your route kids so however during this",
    "start": "782290",
    "end": "787720"
  },
  {
    "text": "research we noticed something very interesting so let's see a demo yet now",
    "start": "787720",
    "end": "799390"
  },
  {
    "text": "we use the the root kit that we have to hide a process and we found something",
    "start": "799390",
    "end": "805930"
  },
  {
    "text": "very interesting",
    "start": "805930",
    "end": "808710"
  },
  {
    "text": "okay so we launched the calculator and",
    "start": "829140",
    "end": "837740"
  },
  {
    "text": "the PID is 425",
    "start": "837740",
    "end": "844370"
  },
  {
    "text": "okay so now we use our rockets to hide this process",
    "start": "848240",
    "end": "856300"
  },
  {
    "text": "all right so you cannot seek a curator now",
    "start": "867310",
    "end": "872550"
  },
  {
    "text": "all right okay so um but there was some",
    "start": "876660",
    "end": "883080"
  },
  {
    "text": "day we noticed a comment can actually very easily to see all process no matter",
    "start": "883080",
    "end": "891480"
  },
  {
    "text": "what way you hide a way to use what rocket what rookie he used to hide the",
    "start": "891480",
    "end": "897540"
  },
  {
    "text": "process you see the lunch CTL lists crap",
    "start": "897540",
    "end": "903110"
  },
  {
    "text": "find develop EIT so you can see this process and so how what happened",
    "start": "903110",
    "end": "910770"
  },
  {
    "text": "let me explain",
    "start": "910770",
    "end": "914480"
  },
  {
    "text": "okay so it will call it it is a user mode magic that from demo you can see",
    "start": "924540",
    "end": "931020"
  },
  {
    "text": "the command we used to list all process this comment is purely our user more",
    "start": "931020",
    "end": "936660"
  },
  {
    "text": "application and all the data it used is in user mode and it is very simple way",
    "start": "936660",
    "end": "944010"
  },
  {
    "text": "to detect an invisible process from user space only user space no matter what",
    "start": "944010",
    "end": "949920"
  },
  {
    "text": "matrix you are using in the kernel so no matter what how many kernel objects you",
    "start": "949920",
    "end": "955920"
  },
  {
    "text": "modify so the user mode tool can list all process that you hide in kernel it",
    "start": "955920",
    "end": "964350"
  },
  {
    "text": "is because of lunch D the reason is the lunch D lunch D is monitoring all",
    "start": "964350",
    "end": "970620"
  },
  {
    "text": "process creation and a termination it it is in charge of their process creation",
    "start": "970620",
    "end": "976560"
  },
  {
    "text": "so it maintains a job list in user mode our lunch CTL is the tool to communicate",
    "start": "976560",
    "end": "984210"
  },
  {
    "text": "with lunch D it can easily easily list of jobs so if you want to hide process",
    "start": "984210",
    "end": "990780"
  },
  {
    "text": "you have to do is lunch D so we are",
    "start": "990780",
    "end": "996810"
  },
  {
    "text": "going to see more details of lunch D since lunch CTO can list process so we",
    "start": "996810",
    "end": "1005180"
  },
  {
    "text": "start from here it is lunch city of the",
    "start": "1005180",
    "end": "1010400"
  },
  {
    "text": "code of lunch CTO you can see this function is the key the key part so use",
    "start": "1010400",
    "end": "1019040"
  },
  {
    "text": "this code is come in and this command will send a message to the HT ok and",
    "start": "1019040",
    "end": "1027250"
  },
  {
    "text": "finally it will call this function to send message to lunch D and learn in",
    "start": "1027250",
    "end": "1032540"
  },
  {
    "text": "lunch D the function is in charge of the list Oh Oh chop is in this function and",
    "start": "1032540",
    "end": "1043240"
  },
  {
    "text": "as you can see a job object is actually the process in lunch D so yep if we can",
    "start": "1043240",
    "end": "1053150"
  },
  {
    "text": "look for the job in a lunch D then we can list all process or a week",
    "start": "1053150",
    "end": "1058310"
  },
  {
    "text": "try to unlink list and each job has a",
    "start": "1058310",
    "end": "1063560"
  },
  {
    "text": "job empty our structure for management of information so we need to look for",
    "start": "1063560",
    "end": "1069050"
  },
  {
    "text": "job MGR in lunch T okay however on the",
    "start": "1069050",
    "end": "1074480"
  },
  {
    "text": "symbol in lunch D is removed so here are some hint for you that how we'd",
    "start": "1074480",
    "end": "1080930"
  },
  {
    "text": "reverse-engineer the lunch D we use some string to identify the code here is the",
    "start": "1080930",
    "end": "1086060"
  },
  {
    "text": "source code but in lunch D you cannot see function simple so we use like this",
    "start": "1086060",
    "end": "1092570"
  },
  {
    "text": "string to identify the call and try to look for the job MGR structure okay so",
    "start": "1092570",
    "end": "1101990"
  },
  {
    "text": "in in this function you can also see on there is a root job MGR so from this",
    "start": "1101990",
    "end": "1109940"
  },
  {
    "text": "function yeah if we can access this object root MGR we can list all jobs or",
    "start": "1109940",
    "end": "1118160"
  },
  {
    "text": "look for specific job in lunch D but it is not easy because no symbol and you",
    "start": "1118160",
    "end": "1124610"
  },
  {
    "text": "have to to try so yeah we reversed",
    "start": "1124610",
    "end": "1129860"
  },
  {
    "text": "we analyzed the root job MGR and we found it is in the data section yeah so",
    "start": "1129860",
    "end": "1141380"
  },
  {
    "text": "yeah you see here you can see the this place is around in the file of this",
    "start": "1141380",
    "end": "1148850"
  },
  {
    "text": "place so okay so the way we unlinked a",
    "start": "1148850",
    "end": "1153980"
  },
  {
    "text": "job in lunch D is the first we have to get group permission the second",
    "start": "1153980",
    "end": "1159200"
  },
  {
    "text": "enumerate process lunch D and get lunch D tasks and try to rate lunch D memory",
    "start": "1159200",
    "end": "1166880"
  },
  {
    "text": "and find data section and find a yeah the next and the most important thing is",
    "start": "1166880",
    "end": "1172550"
  },
  {
    "text": "find root MGR and you have to try the element in the data section of the of",
    "start": "1172550",
    "end": "1179180"
  },
  {
    "text": "the lunch D and you that the way we verify it is a lunch D is a list there",
    "start": "1179180",
    "end": "1185570"
  },
  {
    "text": "you have to verify the point is it real lunch the real root job empty",
    "start": "1185570",
    "end": "1191990"
  },
  {
    "text": "if we get the job I wrote German gr then",
    "start": "1191990",
    "end": "1197450"
  },
  {
    "text": "we can start to enumerate job and gr and job then using the link list in the",
    "start": "1197450",
    "end": "1204380"
  },
  {
    "text": "between the job and we can find target job and we unlink the job right we have",
    "start": "1204380",
    "end": "1212660"
  },
  {
    "text": "a short demo here as well",
    "start": "1212660",
    "end": "1216070"
  },
  {
    "text": "right yeah yeah continue the demo that we had so no we use rookie to hide the",
    "start": "1257360",
    "end": "1265460"
  },
  {
    "text": "process but you are from user mode we can still use lunch City Auto to see the",
    "start": "1265460",
    "end": "1271190"
  },
  {
    "text": "process now we will try to modify the the data in lunch D so then we can hide",
    "start": "1271190",
    "end": "1279200"
  },
  {
    "text": "the process",
    "start": "1279200",
    "end": "1282549"
  },
  {
    "text": "okay so now we we know we use our try",
    "start": "1295840",
    "end": "1300850"
  },
  {
    "text": "our the target is 425",
    "start": "1300850",
    "end": "1308580"
  },
  {
    "text": "as least or can kill the job in new HD not not kill a tree real job just unlink",
    "start": "1313190",
    "end": "1320779"
  },
  {
    "text": "it alright so with it so now we try to",
    "start": "1320779",
    "end": "1329419"
  },
  {
    "text": "find the trap again it is invisible now",
    "start": "1329419",
    "end": "1334299"
  },
  {
    "text": "so hiding a process in Mac OS you need",
    "start": "1334779",
    "end": "1339919"
  },
  {
    "text": "to t always something in kernel and and your space as well",
    "start": "1339919",
    "end": "1345398"
  },
  {
    "text": "all right so after hiding files as a root the next as a rootkit on the next",
    "start": "1354200",
    "end": "1361039"
  },
  {
    "text": "important thing to is to give permission to a normal user so in following slide",
    "start": "1361039",
    "end": "1367909"
  },
  {
    "text": "I'm going to show you how we signed to the current permission to a normal user",
    "start": "1367909",
    "end": "1375100"
  },
  {
    "text": "okay here is a demonstration that you can see the user who am I",
    "start": "1375100",
    "end": "1381970"
  },
  {
    "text": "VM it it is actually a normal user and but we use a ext state to check the",
    "start": "1381970",
    "end": "1393470"
  },
  {
    "text": "kernel module non-aquatic true is it in the in kernel but yeah we couldn't find",
    "start": "1393470",
    "end": "1400039"
  },
  {
    "text": "that and we use our tool kxe load is or to load the kernel module and you can",
    "start": "1400039",
    "end": "1409249"
  },
  {
    "text": "see it's successfully loaded the kernel module but it is still normal user yeah",
    "start": "1409249",
    "end": "1416029"
  },
  {
    "text": "so a normal user can dot a kernel module so how did how do we do this okay it is",
    "start": "1416029",
    "end": "1425450"
  },
  {
    "text": "because of their host privilege the host privileged can with post privilege you",
    "start": "1425450",
    "end": "1432289"
  },
  {
    "text": "can do many things including local module and if you can load con module",
    "start": "1432289",
    "end": "1437330"
  },
  {
    "text": "you can get into kernel you can do many things so this privilege is very important it",
    "start": "1437330",
    "end": "1443200"
  },
  {
    "text": "actually are more important than then it is almost similar to root so in host",
    "start": "1443200",
    "end": "1453289"
  },
  {
    "text": "project you can see this element spec special is storing the privileged",
    "start": "1453289",
    "end": "1461389"
  },
  {
    "text": "information host privileged information and host privilege is list here and no more it is",
    "start": "1461389",
    "end": "1468019"
  },
  {
    "text": "one and with special privilege is two",
    "start": "1468019",
    "end": "1473980"
  },
  {
    "text": "and with host privilege you can do many things like here yeah at least you can",
    "start": "1473980",
    "end": "1480649"
  },
  {
    "text": "load kinda module okay so and also with with host",
    "start": "1480649",
    "end": "1485899"
  },
  {
    "text": "privilege you can your desk cannot ask and I will show you",
    "start": "1485899",
    "end": "1491130"
  },
  {
    "text": "what what powerful it is okay so how to obtain host privilege the first in",
    "start": "1491130",
    "end": "1498640"
  },
  {
    "text": "Colonel you have to find a real host this symbol from Colonel you pass colonel and find symbol and then find",
    "start": "1498640",
    "end": "1506200"
  },
  {
    "text": "target tasks which task you want to assign the permission the privilege and",
    "start": "1506200",
    "end": "1512370"
  },
  {
    "text": "assign this point are real host special to two tasks itk host then this task has",
    "start": "1512370",
    "end": "1523120"
  },
  {
    "text": "a privilege and no need with no need to become root it already already have had",
    "start": "1523120",
    "end": "1528940"
  },
  {
    "text": "the privilege okay so um so how do we",
    "start": "1528940",
    "end": "1535720"
  },
  {
    "text": "implement a rookie with host privilege so there are several ways like Co hook",
    "start": "1535720",
    "end": "1541660"
  },
  {
    "text": "like system called hook and Co patching and the influence line I will show you",
    "start": "1541660",
    "end": "1547900"
  },
  {
    "text": "how the way to cope h2 to make rookie with this function so um we try to",
    "start": "1547900",
    "end": "1555460"
  },
  {
    "text": "replace system code table and then we find this address and then we try to",
    "start": "1555460",
    "end": "1560920"
  },
  {
    "text": "patch the call here and it is global effectiveness like you",
    "start": "1560920",
    "end": "1567010"
  },
  {
    "text": "any user want to request a permission and the root kit will work render",
    "start": "1567010",
    "end": "1572110"
  },
  {
    "text": "permission without asking without any checking all right so in this function",
    "start": "1572110",
    "end": "1577600"
  },
  {
    "text": "is this yeah it is trip this handle in charge of the checking the the host",
    "start": "1577600",
    "end": "1585240"
  },
  {
    "text": "permission of the test but we multiply the co here then when every time that",
    "start": "1585240",
    "end": "1592929"
  },
  {
    "text": "when the next time this disco is is caught it will return always give the",
    "start": "1592929",
    "end": "1598720"
  },
  {
    "text": "permission okay so instead of code",
    "start": "1598720",
    "end": "1604450"
  },
  {
    "text": "matching cooperating is not easy it's difficult we have another better way that it this way is easiest and",
    "start": "1604450",
    "end": "1612450"
  },
  {
    "text": "undetectable by transitional detection and stable how do we do this",
    "start": "1612450",
    "end": "1619279"
  },
  {
    "text": "very simple we just find the that host privilege object and then we specify two",
    "start": "1619279",
    "end": "1628230"
  },
  {
    "text": "to one so the no more host privilege it's the same with the spatial privilege",
    "start": "1628230",
    "end": "1636269"
  },
  {
    "text": "so after modify this we call it data page with after patch this data then it",
    "start": "1636269",
    "end": "1643080"
  },
  {
    "text": "is global effectiveness that every user can have permission to Lord Kanha module",
    "start": "1643080",
    "end": "1650750"
  },
  {
    "text": "okay so now our no more user can do many",
    "start": "1652340",
    "end": "1657419"
  },
  {
    "text": "things know with host privileged how and what are no more user can do from user",
    "start": "1657419",
    "end": "1663750"
  },
  {
    "text": "mode and color mode I will I'm going to show you so the first direct kernel memory access",
    "start": "1663750",
    "end": "1670080"
  },
  {
    "text": "from user mode this is knew that since Mac OS 10 point 6 it restrict task",
    "start": "1670080",
    "end": "1680399"
  },
  {
    "text": "access from kernel desk so um text for PID originally text for",
    "start": "1680399",
    "end": "1686159"
  },
  {
    "text": "PID can be used to access kernel but cannot ask but it is not supported the",
    "start": "1686159",
    "end": "1694230"
  },
  {
    "text": "new and cannot have so a new version of Mac OS X this function cannot be used to",
    "start": "1694230",
    "end": "1703230"
  },
  {
    "text": "access kernel desk so no matter you your privilege level nor what API you used so",
    "start": "1703230",
    "end": "1709110"
  },
  {
    "text": "there is no legitimate way that you will",
    "start": "1709110",
    "end": "1714929"
  },
  {
    "text": "use for inspecting kernel memory but I'm",
    "start": "1714929",
    "end": "1720090"
  },
  {
    "text": "going to show you a way so now we make it possible again DirectX access we we",
    "start": "1720090",
    "end": "1729059"
  },
  {
    "text": "don't use text popularity instead we use processor set tasks this API can get our",
    "start": "1729059",
    "end": "1736710"
  },
  {
    "text": "object the text list we can reword",
    "start": "1736710",
    "end": "1741929"
  },
  {
    "text": "return attacks this object and this object is actually the kernel task",
    "start": "1741929",
    "end": "1747179"
  },
  {
    "text": "so from use the mall you when you call this function you you need to you their host privilege at least and you",
    "start": "1747179",
    "end": "1754750"
  },
  {
    "text": "can call this function and after call this function you can get the kernel task so text list you can access all",
    "start": "1754750",
    "end": "1761620"
  },
  {
    "text": "tasks you from this list so using this code we can start to",
    "start": "1761620",
    "end": "1767860"
  },
  {
    "text": "access all tasks and even using a VM grid and VM right to read and write",
    "start": "1767860",
    "end": "1774820"
  },
  {
    "text": "tasks tasks memory and also for example we can use thread state to to dynamic",
    "start": "1774820",
    "end": "1783010"
  },
  {
    "text": "library injection yeah like Windows still injection so yeah so",
    "start": "1783010",
    "end": "1789910"
  },
  {
    "text": "we make it happen again yeah we can access their kernel tears",
    "start": "1789910",
    "end": "1796110"
  },
  {
    "text": "okay so um neck teens who is host privilege a normal user can not only",
    "start": "1796950",
    "end": "1804910"
  },
  {
    "text": "load kernel module and also we are going",
    "start": "1804910",
    "end": "1810070"
  },
  {
    "text": "to show you how to bypass kernel module verification make OS 10.9 okay so this",
    "start": "1810070",
    "end": "1820240"
  },
  {
    "text": "is the standard way that you want to load kernel module on 10.9 so put the",
    "start": "1820240",
    "end": "1827440"
  },
  {
    "text": "kernel module file file it has to be a file into it has to be in this folder it",
    "start": "1827440",
    "end": "1834940"
  },
  {
    "text": "is passed system library extension and run k EXT lot to load the file if the",
    "start": "1834940",
    "end": "1843040"
  },
  {
    "text": "kernel module is not signed always will always pop up a warning message like",
    "start": "1843040",
    "end": "1849130"
  },
  {
    "text": "this so it is a third-party cano module and yet yeah it's a warning for you okay",
    "start": "1849130",
    "end": "1859210"
  },
  {
    "text": "so we implemented a my kiss okay Mike a txt load and so we can load a condom at",
    "start": "1859210",
    "end": "1866920"
  },
  {
    "text": "you from any pests and file is not required so we can load kernel module on",
    "start": "1866920",
    "end": "1875530"
  },
  {
    "text": "the fly for example from a memory from even from network we can download a",
    "start": "1875530",
    "end": "1880600"
  },
  {
    "text": "chunk of data from network and it could be a kernel module and we don't",
    "start": "1880600",
    "end": "1885940"
  },
  {
    "text": "have to write file and we can load this as economical so and this tool can load",
    "start": "1885940",
    "end": "1893350"
  },
  {
    "text": "a kernel module without verification not worrying no warning message you don't",
    "start": "1893350",
    "end": "1898570"
  },
  {
    "text": "have to sign it and sign the kernel module so and and our way no need to",
    "start": "1898570",
    "end": "1905649"
  },
  {
    "text": "patch kex DP the reason is this api k",
    "start": "1905649",
    "end": "1915370"
  },
  {
    "text": "ext request we use this API to load kernel module so this API can help us to",
    "start": "1915370",
    "end": "1921840"
  },
  {
    "text": "not kill module directly without any checking so as you can see if you",
    "start": "1921840",
    "end": "1928740"
  },
  {
    "text": "specify your own kernel module you have to follow the format and then you can",
    "start": "1928740",
    "end": "1935110"
  },
  {
    "text": "use the this API to load your kono machi oh of course of course you have to have",
    "start": "1935110",
    "end": "1940990"
  },
  {
    "text": "the permission the host privilege okay",
    "start": "1940990",
    "end": "1946570"
  },
  {
    "text": "so in this slide you can see it is the source code and the first the the code",
    "start": "1946570",
    "end": "1954220"
  },
  {
    "text": "actually check the host privilege so not UID is a hot privilege",
    "start": "1954220",
    "end": "1959919"
  },
  {
    "text": "so yeah with this hot spray which then you can start to load camacho and one",
    "start": "1959919",
    "end": "1966250"
  },
  {
    "text": "other thing important thing is you have to make your own m KX T it is the kernel",
    "start": "1966250",
    "end": "1973720"
  },
  {
    "text": "module object ok so here is the structure of the object and here is the",
    "start": "1973720",
    "end": "1979779"
  },
  {
    "text": "sample of the plist it's a yeah you have to follow the format and you have to",
    "start": "1979779",
    "end": "1985539"
  },
  {
    "text": "specify the offset size and you have all the spaces follow the spec and you can",
    "start": "1985539",
    "end": "1992100"
  },
  {
    "text": "load your own color module and you have no warn warnings okay so that's your",
    "start": "1992100",
    "end": "1999789"
  },
  {
    "text": "demo so in this demo first we will we will",
    "start": "1999789",
    "end": "2009919"
  },
  {
    "text": "demo that using post privilege to to to",
    "start": "2009919",
    "end": "2015110"
  },
  {
    "text": "do things and then to okay using host privilege to lot kana module",
    "start": "2015110",
    "end": "2021440"
  },
  {
    "text": "and then after load Cano Cano module then we will show you bypassed their",
    "start": "2021440",
    "end": "2029830"
  },
  {
    "text": "kono module warning",
    "start": "2029830",
    "end": "2033460"
  },
  {
    "text": "okay now we installed kilometer and okay",
    "start": "2039860",
    "end": "2051589"
  },
  {
    "text": "so this page modified that the the kernel data that we make the host",
    "start": "2051589",
    "end": "2059990"
  },
  {
    "text": "privilege we grow hot horse privilege to all users so now even normal user can",
    "start": "2059990",
    "end": "2067368"
  },
  {
    "text": "not Cannavaro",
    "start": "2067369",
    "end": "2071589"
  },
  {
    "text": "okay so now we load current module using instant our way using stand our way not",
    "start": "2085580",
    "end": "2092600"
  },
  {
    "text": "done alright so now you can see pickup but we already have prosper image so we",
    "start": "2092600",
    "end": "2099020"
  },
  {
    "text": "can do this as a normal user but this is the message a warning message you can",
    "start": "2099020",
    "end": "2105110"
  },
  {
    "text": "still see because we are using instant our way to a lot kernel module now",
    "start": "2105110",
    "end": "2111130"
  },
  {
    "text": "as you can see is it's a it's a normal user okay so not not rude not a",
    "start": "2123190",
    "end": "2130210"
  },
  {
    "text": "privileged user but yeah our Kannamma our page cannot page grant the",
    "start": "2130210",
    "end": "2135880"
  },
  {
    "text": "permission to this user to our user actually",
    "start": "2135880",
    "end": "2140670"
  },
  {
    "text": "okay so yep yeah this kilometer we just",
    "start": "2150490",
    "end": "2158470"
  },
  {
    "text": "loaded",
    "start": "2158470",
    "end": "2160890"
  },
  {
    "text": "all right so I see that we used my texts my Kelo to Lord Kanha module and without",
    "start": "2182730",
    "end": "2191160"
  },
  {
    "text": "warnings this time there is no warnings yeah and the current module is loaded",
    "start": "2191160",
    "end": "2197839"
  },
  {
    "text": "all right all the tricks that we show basically require some privilege at",
    "start": "2218339",
    "end": "2223650"
  },
  {
    "text": "least the host spirit right so so for our lookit you still need at least one",
    "start": "2223650",
    "end": "2230549"
  },
  {
    "text": "time to be alert and so here I'm going to show you a tricks a trick that can",
    "start": "2230549",
    "end": "2237660"
  },
  {
    "text": "easily get root permission it's not a",
    "start": "2237660",
    "end": "2243209"
  },
  {
    "text": "real day just a trick so basically on when when an application require",
    "start": "2243209",
    "end": "2250499"
  },
  {
    "text": "permission such as installation or so it will use this API to obtain",
    "start": "2250499",
    "end": "2258029"
  },
  {
    "text": "authorization from security D if you are a Mac iOS developer you might know this",
    "start": "2258029",
    "end": "2265920"
  },
  {
    "text": "API and we you using this API you can get authorization then you can do you",
    "start": "2265920",
    "end": "2273449"
  },
  {
    "text": "can have permission to do things so it is okay so an app will call this",
    "start": "2273449",
    "end": "2285959"
  },
  {
    "text": "function to request the premium permission to to security and security",
    "start": "2285959",
    "end": "2291150"
  },
  {
    "text": "will load the configuration frontier to know which permission is required and",
    "start": "2291150",
    "end": "2298489"
  },
  {
    "text": "security will pop up a message to show to X user to type password to type s or",
    "start": "2298489",
    "end": "2305489"
  },
  {
    "text": "so after type the password security will return token to to the application with",
    "start": "2305489",
    "end": "2315299"
  },
  {
    "text": "this token application can I can say met Ken Starr can do something can voice",
    "start": "2315299",
    "end": "2323369"
  },
  {
    "text": "permission and lunch D with this token HT will use another permission to launch",
    "start": "2323369",
    "end": "2330269"
  },
  {
    "text": "the application okay there are many",
    "start": "2330269",
    "end": "2338219"
  },
  {
    "text": "authorization configurations in here so yeah there are there are a lot and you",
    "start": "2338219",
    "end": "2344369"
  },
  {
    "text": "can choose what you need what what kind of authorization you need and you just specified that you need",
    "start": "2344369",
    "end": "2351040"
  },
  {
    "text": "you can create the authorization if use a tablet password but there is one configuration is very",
    "start": "2351040",
    "end": "2358930"
  },
  {
    "text": "interesting it's it's the car come to airport and software update the skin and",
    "start": "2358930",
    "end": "2365560"
  },
  {
    "text": "it shows this application is trying to",
    "start": "2365560",
    "end": "2370840"
  },
  {
    "text": "check for new a poll priority software type your password to allow this so",
    "start": "2370840",
    "end": "2377890"
  },
  {
    "text": "where you allow this is just check Apple provided software so after user tap the",
    "start": "2377890",
    "end": "2385900"
  },
  {
    "text": "password you can get the permission yeah but I think most of user will tap this",
    "start": "2385900",
    "end": "2392260"
  },
  {
    "text": "password without any any feed in any any thing different so it is the trick that",
    "start": "2392260",
    "end": "2401650"
  },
  {
    "text": "you might the malware developer or the guys can use to to get permission from",
    "start": "2401650",
    "end": "2408250"
  },
  {
    "text": "this okay so conclusion that today I will",
    "start": "2408250",
    "end": "2413830"
  },
  {
    "text": "introduce advanced process hiding tricks especially we introduced latch D the the",
    "start": "2413830",
    "end": "2422400"
  },
  {
    "text": "application control from user mode and so you if you want to hide process you",
    "start": "2422400",
    "end": "2427630"
  },
  {
    "text": "have to do is not only kernel you have to do is user mode as well so and also",
    "start": "2427630",
    "end": "2434410"
  },
  {
    "text": "we we also introduced a privileged normal user that you know actually in in",
    "start": "2434410",
    "end": "2443320"
  },
  {
    "text": "Mac OS kernel the application the permission control is very complicated so I think there are still many many",
    "start": "2443320",
    "end": "2450640"
  },
  {
    "text": "things you can try to do that so with host privilege that we can do many",
    "start": "2450640",
    "end": "2457630"
  },
  {
    "text": "things that because you don't have to do to be a root so maybe a demonstrator",
    "start": "2457630",
    "end": "2464560"
  },
  {
    "text": "will not feel anything weird if you are just a normal user when you are located",
    "start": "2464560",
    "end": "2471280"
  },
  {
    "text": "installed in the system then we introduced a new way to direct SS",
    "start": "2471280",
    "end": "2476410"
  },
  {
    "text": "Colonel tasks and it is very easy easy",
    "start": "2476410",
    "end": "2483460"
  },
  {
    "text": "way to end you know memory and and also we introduced a load kernel module how do",
    "start": "2483460",
    "end": "2490540"
  },
  {
    "text": "we a lot conversion without warnings and also a tricks to gain root permission",
    "start": "2490540",
    "end": "2499079"
  },
  {
    "text": "okay so there's one more thing that not only the rookie tricks that we are",
    "start": "2499530",
    "end": "2506830"
  },
  {
    "text": "actually developing system virtuality verifier for Mac OSX you know on Windows",
    "start": "2506830",
    "end": "2512710"
  },
  {
    "text": "there is svv released in 2006 or 2007 I",
    "start": "2512710",
    "end": "2518020"
  },
  {
    "text": "don't remember but it is basically a rootkit checker to to check your kernel",
    "start": "2518020",
    "end": "2523090"
  },
  {
    "text": "easy kernel is not modified by rookie so we are developing this tool and we are",
    "start": "2523090",
    "end": "2530260"
  },
  {
    "text": "going to give you a preview of this tool and this tool is basically a rookie",
    "start": "2530260",
    "end": "2537070"
  },
  {
    "text": "scanner and it is comparing it with comprehensive checkup it checked system",
    "start": "2537070",
    "end": "2545200"
  },
  {
    "text": "code table a trap table ID tea table kernel functions policy permission and",
    "start": "2545200",
    "end": "2550690"
  },
  {
    "text": "neck and network so we check every everything that might be justified okay",
    "start": "2550690",
    "end": "2559110"
  },
  {
    "text": "but this is under development we are giving you a demo now",
    "start": "2559110",
    "end": "2567240"
  },
  {
    "text": "this is the way we more inter-process creation",
    "start": "2632130",
    "end": "2637160"
  },
  {
    "text": "all right now we use our tool to scan the kernel and it checks system called",
    "start": "2668750",
    "end": "2677330"
  },
  {
    "text": "check tribe check ID t-table check kernel functions",
    "start": "2677330",
    "end": "2683680"
  },
  {
    "text": "oh all right um yeah I'm sorry we used",
    "start": "2692790",
    "end": "2699360"
  },
  {
    "text": "the okay so this this function I'm sorry",
    "start": "2699360",
    "end": "2715670"
  },
  {
    "text": "you if you want to know enter the SEC as its nope is more into the process",
    "start": "2715670",
    "end": "2724230"
  },
  {
    "text": "creation right so it will insert some hook in the kernel so we use our tool to",
    "start": "2724230",
    "end": "2730170"
  },
  {
    "text": "check this hook and it discovered the hook yeah so they are there to alert",
    "start": "2730170",
    "end": "2742530"
  },
  {
    "text": "yeah there are two hooks we discovered that yeah it's occupied by that tool",
    "start": "2742530",
    "end": "2749660"
  },
  {
    "text": "okay so that's it I'm sorry that the screen is I think not not very clear",
    "start": "2767480",
    "end": "2773420"
  },
  {
    "text": "enough so if you make encouraging of you want to see something please can come to here and yeah any question",
    "start": "2773420",
    "end": "2782289"
  },
  {
    "text": "alright thanks for attending and thanks for your listening yeah any question please come to here and yeah we are very",
    "start": "2787510",
    "end": "2794050"
  },
  {
    "text": "happy - thank you very much",
    "start": "2794050",
    "end": "2797580"
  }
]