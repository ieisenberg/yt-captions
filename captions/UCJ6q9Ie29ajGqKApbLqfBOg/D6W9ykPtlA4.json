[
  {
    "start": "0",
    "end": "31000"
  },
  {
    "text": "hello ooh a lot of people and thank you very much for having me and I just want",
    "start": "30",
    "end": "6480"
  },
  {
    "text": "to share my research something I discovered and for me I find it really interesting I will try very hard not to",
    "start": "6480",
    "end": "13349"
  },
  {
    "text": "bore some of you to tears and I but I am going to be moving very very quickly I've got way too much content just my",
    "start": "13349",
    "end": "24480"
  },
  {
    "text": "favorite little video it was rather appropriate considering the the topic",
    "start": "24480",
    "end": "30980"
  },
  {
    "text": "right and I'm the global head of hardware security and capability",
    "start": "30980",
    "end": "36600"
  },
  {
    "start": "31000",
    "end": "65000"
  },
  {
    "text": "development for IBM's x-force read I didn't come up with that title it's a really really big mouthful I spend most",
    "start": "36600",
    "end": "43980"
  },
  {
    "text": "my time creating capability hardware capability offensive tools for IBM when",
    "start": "43980",
    "end": "50820"
  },
  {
    "text": "the consultants need some capability or they need a piece of hardware that that we can't get or is only available in the",
    "start": "50820",
    "end": "57420"
  },
  {
    "text": "dark web then I'll go ahead and actually build it and my alias is the toy maker simply because that's why I spend most",
    "start": "57420",
    "end": "63539"
  },
  {
    "text": "of my time doing and that's a lot easier than simply you're spouting that long title and some of the boring bits and",
    "start": "63539",
    "end": "69060"
  },
  {
    "text": "because some of the content I'm going to be going through here is I believe it",
    "start": "69060",
    "end": "74340"
  },
  {
    "text": "would be irresponsible to tell you the company's affected by it and any other",
    "start": "74340",
    "end": "79680"
  },
  {
    "text": "particular details simply because they can't fix it with software they have to re-engineer their product and as a",
    "start": "79680",
    "end": "87360"
  },
  {
    "text": "result the target component as you can see is just going to be referred to as component throughout the entire",
    "start": "87360",
    "end": "93210"
  },
  {
    "text": "presentation there are some company names in here but they're not related to the disclosure so to get on to the topic",
    "start": "93210",
    "end": "102540"
  },
  {
    "text": "I'll give you a very quick summary there are some I think I'm popping a bit there",
    "start": "102540",
    "end": "108689"
  },
  {
    "text": "are some IOT manufacturers that are taking a very serious action to make",
    "start": "108689",
    "end": "114180"
  },
  {
    "text": "sure that in the event of a software compromise that the users privacy is not",
    "start": "114180",
    "end": "119490"
  },
  {
    "text": "affected and I think that's really admirable so they're actually building in hardware to make sure that on the",
    "start": "119490",
    "end": "126240"
  },
  {
    "text": "assumption that software can be hacked when it is hacked the user still has control over their privacy and",
    "start": "126240",
    "end": "131800"
  },
  {
    "text": "there's a particular component or series of components that's been used to to",
    "start": "131800",
    "end": "136870"
  },
  {
    "text": "make this happen I'm targeting one particular one in this paper that or this presentation but the",
    "start": "136870",
    "end": "142900"
  },
  {
    "text": "same research they've done here I've I have been able to apply another context",
    "start": "142900",
    "end": "148030"
  },
  {
    "text": "and you'll see what I'm talking about but this product or this particular target component just once again from a",
    "start": "148030",
    "end": "154690"
  },
  {
    "text": "disclosure point of view makes no security claims it doesn't pretend to be a security product this is all about a",
    "start": "154690",
    "end": "160330"
  },
  {
    "text": "circuit board util implemented so how these products are being used at the circuit layer and how you can manipulate",
    "start": "160330",
    "end": "166870"
  },
  {
    "text": "some of the physical properties by finding a certain characteristics and but before I get into the the fun bits",
    "start": "166870",
    "end": "173500"
  },
  {
    "start": "170000",
    "end": "182000"
  },
  {
    "text": "that's what I should do a little bit of a recap security as a design problem we",
    "start": "173500",
    "end": "179170"
  },
  {
    "text": "we all heard here about sdlc and secure",
    "start": "179170",
    "end": "184690"
  },
  {
    "start": "182000",
    "end": "238000"
  },
  {
    "text": "software development but if you're not familiar in 1970 the DoD commissioned a",
    "start": "184690",
    "end": "190150"
  },
  {
    "text": "report which was nicknamed or being named the ware report and actually state that you require as you can see a",
    "start": "190150",
    "end": "197770"
  },
  {
    "text": "combination of hardware software communications physical personal and administrative procedural safeguards is",
    "start": "197770",
    "end": "204040"
  },
  {
    "text": "required for comprehensive security in particular software safeguards alone are not sufficient I think the really key",
    "start": "204040",
    "end": "210910"
  },
  {
    "text": "part of this is this was in 1970 we're still seeing in the industry a lot of people purely relying on software",
    "start": "210910",
    "end": "216970"
  },
  {
    "text": "safeguards and if you've if your systems are stuck behind firewalls in a data center that's that's probably fine but",
    "start": "216970",
    "end": "223660"
  },
  {
    "text": "in IOT space embedded automotive people have effectively unlimited access to the",
    "start": "223660",
    "end": "230410"
  },
  {
    "text": "target product in which case you need to look at the holistic picture I'm a firm",
    "start": "230410",
    "end": "237040"
  },
  {
    "text": "believer that I'm not saying that you should but anyone who uses product should be able to publish all of the",
    "start": "237040",
    "end": "244390"
  },
  {
    "start": "238000",
    "end": "439000"
  },
  {
    "text": "information all the schematics source code design documents about their product and their product should still",
    "start": "244390",
    "end": "249730"
  },
  {
    "text": "be secure because it's been engineered properly in the first place just a nice simple case study this is actually nota",
    "start": "249730",
    "end": "256390"
  },
  {
    "text": "motive one the first thing we do in Hardware Security's you get given a product you pull it apart you find out",
    "start": "256390",
    "end": "262660"
  },
  {
    "text": "all the components anything that has data stored on it you try and get the data off we did this for a telematics",
    "start": "262660",
    "end": "268180"
  },
  {
    "text": "unit you know in a vehicle and you can see the little flash chip over on the side here and the manufacturer said all",
    "start": "268180",
    "end": "276190"
  },
  {
    "text": "that's fine yes you've got access to the file system but what did you do how did you do that so well we use a data man",
    "start": "276190",
    "end": "281890"
  },
  {
    "text": "reader and a flash chip socket and they said well you know that's that's a couple of thousand pounds that's a little bit of a barrier I said it's not",
    "start": "281890",
    "end": "288190"
  },
  {
    "text": "a barrier we simply do it that way because it's quicker so to prove a point and now there's somebody in the audience",
    "start": "288190",
    "end": "294310"
  },
  {
    "text": "who's going to heckle me for this one I'm gonna say I did it but that's actually my wife because she's better with a soldering iron than I am and",
    "start": "294310",
    "end": "300000"
  },
  {
    "text": "soldered seven wires on to the bottom of the BGA chip and most people don't realize that flash chips will actually",
    "start": "300000",
    "end": "305290"
  },
  {
    "text": "emulate an SD card if they're wired up correctly so seven wires straight into an SD card adapter stuck it into an SD",
    "start": "305290",
    "end": "310930"
  },
  {
    "text": "slot mounted the filesystem got past all the software controls so this system was well locked down had good software",
    "start": "310930",
    "end": "316360"
  },
  {
    "text": "controls but all you had to do is pull the flash chip off to recover the entire file system and a couple of hours and",
    "start": "316360",
    "end": "322720"
  },
  {
    "text": "Mego come on solar faster I want to get on with this but that's just a classic example once we had access to the file",
    "start": "322720",
    "end": "328360"
  },
  {
    "text": "system the rest of it fell we're out to decompile you know java we're able to get access to the storage any",
    "start": "328360",
    "end": "333940"
  },
  {
    "text": "cryptographic material and that was just to prove a point another very simple one this one's a",
    "start": "333940",
    "end": "340330"
  },
  {
    "text": "typical of security through obscurity approach once again it's really difficult because the the engineers the",
    "start": "340330",
    "end": "346660"
  },
  {
    "text": "electronics engineers mechanical engineers always do such a good job they're just not thinking like the devious people we all are so we actually",
    "start": "346660",
    "end": "353770"
  },
  {
    "text": "explain to them some of the processes we go about to recover and get access to these systems it makes a lot more sense so this one was a an atom based phone it",
    "start": "353770",
    "end": "363760"
  },
  {
    "text": "had quite good security controls in place from a software point of view again but I'm being a very impatient",
    "start": "363760",
    "end": "369490"
  },
  {
    "text": "person well spent about 15 minutes trying to get past the software and decided this just wasn't worth the hassle so I simply pulled it apart a",
    "start": "369490",
    "end": "375160"
  },
  {
    "text": "little USB microscope and started looking over the circuit board and I found that there was a small cluster of unloaded components so to cover a long",
    "start": "375160",
    "end": "382150"
  },
  {
    "text": "story short those components are typically option resistors which is how the developers choose whether or not the",
    "start": "382150",
    "end": "387610"
  },
  {
    "text": "bootloader is to go into development mode or production mode so one by one put one of these resistors on reset the",
    "start": "387610",
    "end": "392950"
  },
  {
    "text": "device and went round and round in circles I also found one I was pretty sure was a serial port but that on logic analyzer",
    "start": "392950",
    "end": "399610"
  },
  {
    "text": "nothing happened the first few times all a sudden I put on one of these components reset the device and a load",
    "start": "399610",
    "end": "405100"
  },
  {
    "text": "of data spat out and it was I put it into real term as you can see there it was the BIOS boot screen so is the entire terminal straight into the into",
    "start": "405100",
    "end": "412990"
  },
  {
    "text": "the back end there's no user name no password on the control some once I had that it's a little bit blurry but I went",
    "start": "412990",
    "end": "419500"
  },
  {
    "text": "in there and disabled you feel secure boot then I once again I was able to get access to the entire file system the",
    "start": "419500",
    "end": "424750"
  },
  {
    "text": "this was so easy because the parts are so small that literally with a screwdriver you could scrape the solder",
    "start": "424750",
    "end": "430060"
  },
  {
    "text": "paste that's leftover from the production process to actually bridge the part so once again with a screwdriver is all that was actually",
    "start": "430060",
    "end": "435670"
  },
  {
    "text": "required to get access to this development mode so as I said before I'm",
    "start": "435670",
    "end": "442060"
  },
  {
    "start": "439000",
    "end": "485000"
  },
  {
    "text": "a firm believer that security comes from process yeah you don't choose security",
    "start": "442060",
    "end": "447520"
  },
  {
    "text": "technology you choose what your requirements are first once you know how you want to what you're what you want",
    "start": "447520",
    "end": "452830"
  },
  {
    "text": "your product to do how you want it to function part of that should also be how you want it secured then you can go ahead and choose technology anyone from",
    "start": "452830",
    "end": "460480"
  },
  {
    "text": "an engineering background we all love gadgets we all love toys something new comes out let's use this to build a new product that's not actually the right",
    "start": "460480",
    "end": "467110"
  },
  {
    "text": "way around so if you implement a proper process and make sure before any designs are done product requirements functional",
    "start": "467110",
    "end": "473830"
  },
  {
    "text": "safety security and bold obviously commercial life cycle part of the",
    "start": "473830",
    "end": "479170"
  },
  {
    "text": "security requirements obviously doing cover life cycle as well end-of-life that sort of thing",
    "start": "479170",
    "end": "485820"
  },
  {
    "start": "485000",
    "end": "572000"
  },
  {
    "text": "so as I said earlier a lot of these companies are assuming their products will be compromised",
    "start": "485820",
    "end": "491470"
  },
  {
    "text": "so if you assume it can be compromised design it with that assumption in mind so for a traditional data system risks",
    "start": "491470",
    "end": "496870"
  },
  {
    "text": "will compromise are typically to date or availability let's say for semi autonomous systems or vehicles you end",
    "start": "496870",
    "end": "502930"
  },
  {
    "text": "up with a security risk that can actually have an impact to life safety",
    "start": "502930",
    "end": "508120"
  },
  {
    "text": "risk so if we look at the I Triple E guidance on EMC and functional safety that's a",
    "start": "508120",
    "end": "513580"
  },
  {
    "text": "massive book but this particular part I think is really really important warning of a hazard is not considered a",
    "start": "513580",
    "end": "519400"
  },
  {
    "text": "substitute for guarding against it where guarding against it is possible guarding is considered no substitute",
    "start": "519400",
    "end": "525279"
  },
  {
    "text": "for designing the hazard out in the first place where it is possible to design the hazard out so you're talking about anything embedded it's really",
    "start": "525279",
    "end": "531189"
  },
  {
    "text": "important where you can design these hazards out don't simply tell people about it so if we put this into context",
    "start": "531189",
    "end": "537279"
  },
  {
    "text": "with an autonomous vehicle telling a driver they may not have control of the car if someone was to hack it really is",
    "start": "537279",
    "end": "542649"
  },
  {
    "text": "not a substitute for guarding against that in the first place conversely you know adding edge security",
    "start": "542649",
    "end": "548199"
  },
  {
    "text": "devices is not considered a substitute for designing the system properly so that in the event of a hack that the",
    "start": "548199",
    "end": "553509"
  },
  {
    "text": "driver still has sufficient control to control the vehicle safely and that's a hardware design problem that's not",
    "start": "553509",
    "end": "558999"
  },
  {
    "text": "software design problem you've assumed the software can be compromised so I've done things with some automotive",
    "start": "558999",
    "end": "564879"
  },
  {
    "text": "manufacturers where we've redesigned their steering controllers so that in the event of a software hack the steering the the controller actually",
    "start": "564879",
    "end": "572800"
  },
  {
    "start": "572000",
    "end": "581000"
  },
  {
    "text": "validates the human input over the top of the software input so it's actually relatively straightforward process so",
    "start": "572800",
    "end": "578589"
  },
  {
    "text": "now getting onto the topic this is the bit which I get really excited about so I had to get through the first bit so as",
    "start": "578589",
    "end": "583600"
  },
  {
    "start": "581000",
    "end": "628000"
  },
  {
    "text": "I said earlier some IOT designers are taking really serious action actually building in hardware so you imagine you",
    "start": "583600",
    "end": "589689"
  },
  {
    "text": "know their IOT devices where you've got a mute button you've actually got a button to mute and unmute the system",
    "start": "589689",
    "end": "595509"
  },
  {
    "text": "you've got laptops with LEDs at the top to tell you when the camera is on these",
    "start": "595509",
    "end": "600519"
  },
  {
    "text": "are all things designed to make sure that we are aware when our devices are listening to us or watching us so some",
    "start": "600519",
    "end": "606850"
  },
  {
    "text": "of these hardware designs require as I said a user to physically press a button so I've implemented that not through",
    "start": "606850",
    "end": "612459"
  },
  {
    "text": "software they've implemented that through digital logic and that's what my little board down here is all about the",
    "start": "612459",
    "end": "618639"
  },
  {
    "text": "question that I asked them was you know just use your logics floorless does that mean your implementations flawless and",
    "start": "618639",
    "end": "624579"
  },
  {
    "text": "no it doesn't because of some of the physical characteristics so if we look",
    "start": "624579",
    "end": "630129"
  },
  {
    "start": "628000",
    "end": "687000"
  },
  {
    "text": "at the failsafe logic itself now once again setting a little bit of scene there's a lot of technical content here",
    "start": "630129",
    "end": "635319"
  },
  {
    "text": "so I'm going to try and move fairly quickly there's a this particular component and is a very small mixed",
    "start": "635319",
    "end": "642100"
  },
  {
    "text": "signal component so it's like if you're familiar with a tiny little field programmable gate array so FPGA tiny",
    "start": "642100",
    "end": "647920"
  },
  {
    "text": "little thing it's you know small cluster of look-up tables and some comparators and a few other things but it's really",
    "start": "647920",
    "end": "653379"
  },
  {
    "text": "ideal for building these small state machines in",
    "start": "653379",
    "end": "657750"
  },
  {
    "text": "so this is the development board and just to put it into context you can see the USB plug on the left hand side and",
    "start": "658620",
    "end": "664930"
  },
  {
    "text": "you can see how small the actual component is it's tiny it's I think it's 2 millimeters by one and a half or you",
    "start": "664930",
    "end": "671530"
  },
  {
    "text": "know 2 by 3 something like that it's a really tiny little component so this development board and that that carrier",
    "start": "671530",
    "end": "676660"
  },
  {
    "text": "board I actually have that carrier board plugged in to my target IOT device and I'll show you that later on but that",
    "start": "676660",
    "end": "682750"
  },
  {
    "text": "little tiny component is actually the the target of my research on this particular instance so so what it does",
    "start": "682750",
    "end": "690040"
  },
  {
    "start": "687000",
    "end": "875000"
  },
  {
    "text": "this these mixed signal logic they have a series of gates so you imagine the whole thing is just a matrix you connect",
    "start": "690040",
    "end": "697920"
  },
  {
    "text": "columns and rows and actually form a small circuit inside that and depending",
    "start": "697920",
    "end": "703690"
  },
  {
    "text": "on what you want to do you connect those those circuit paths to as you can see a lookup table that lookup table is",
    "start": "703690",
    "end": "711220"
  },
  {
    "text": "functionally a NAND gate so anyone familiar with electronics is where what I'm talking about and then you then route the output so once these things",
    "start": "711220",
    "end": "717940"
  },
  {
    "text": "are program they can't be changed so you actually defining this logic inside so",
    "start": "717940",
    "end": "724300"
  },
  {
    "text": "this is that's a screenshot from the actual designer software so you can see we've got some and gates so that the",
    "start": "724300",
    "end": "730990"
  },
  {
    "text": "blue the blue parts around the outer edge are inputs and outputs you can see by the direction of the arrows we've",
    "start": "730990",
    "end": "736240"
  },
  {
    "text": "then got the all the gray parts which are the configurable logic so depending on how the signals are actually made you",
    "start": "736240",
    "end": "742330"
  },
  {
    "text": "you simply draw and line you know draw these lines throught this nice little schematic and then you can test your",
    "start": "742330",
    "end": "747520"
  },
  {
    "text": "logic so the logic of this one is that the user has to press the button to disable privacy mode so the software can",
    "start": "747520",
    "end": "754690"
  },
  {
    "text": "put the system in to privacy mode which is fine as in it can turn off the cameras and microphones but the user has",
    "start": "754690",
    "end": "759700"
  },
  {
    "text": "to press a button to re-enable it and that's done through the the bottom path which is the the there's a button",
    "start": "759700",
    "end": "765880"
  },
  {
    "text": "debounce there's a latch in there and some other bits and pieces and you can also see that the privacy LED on the",
    "start": "765880",
    "end": "771190"
  },
  {
    "text": "right-hand side you've got camera microphone gate enabled and then below at privacy LED so they're actually",
    "start": "771190",
    "end": "776920"
  },
  {
    "text": "running separately which is really important so that you know the the logic",
    "start": "776920",
    "end": "782110"
  },
  {
    "text": "itself because they might both run at different voltages or different characteristics and you might want them want to be inverted one not to be but",
    "start": "782110",
    "end": "787839"
  },
  {
    "text": "those two are both actually run so in the event that the camera turns on the privacy LED because",
    "start": "787839",
    "end": "793460"
  },
  {
    "text": "actually two different functions so this software can also turn it on and off if it needs to if it doesn't have enough",
    "start": "793460",
    "end": "798500"
  },
  {
    "text": "reason to it but the minute you press the mute button and the software enables privacy mode there should be no way for",
    "start": "798500",
    "end": "803870"
  },
  {
    "text": "the system to listen to what you're doing or see what you're doing without you pressing a button so said this is",
    "start": "803870",
    "end": "811820"
  },
  {
    "text": "the this is the bit that gets a little bit dry so I do apologize this is a typical data sheet this is a data sheet",
    "start": "811820",
    "end": "817640"
  },
  {
    "text": "from one of these particular products anyone involved in hardware security the first thing you do is you go to the data",
    "start": "817640",
    "end": "823790"
  },
  {
    "text": "sheets you have a look see what the manufacturers say the actual tolerances are see what the voltages are anyway when I was doing this research this was",
    "start": "823790",
    "end": "830360"
  },
  {
    "text": "many years ago the first thing I did was look at look at this and I saw a ball there was there was a couple of gates so",
    "start": "830360",
    "end": "836570"
  },
  {
    "text": "there's a couple of gates in the chain one particular gate if you see here in the middle at 3.3 volts the center",
    "start": "836570",
    "end": "842510"
  },
  {
    "text": "column there to change from a 1 to 0 or a 0 to a 1 takes this these little gates",
    "start": "842510",
    "end": "847970"
  },
  {
    "text": "15 nanoseconds that's pretty quick but one when you add them up to change from",
    "start": "847970",
    "end": "853340"
  },
  {
    "text": "1 to 0 to back to il-1 again that's 30 nanoseconds all of a sudden that little gate can only handle 33 megahertz so",
    "start": "853340",
    "end": "860510"
  },
  {
    "text": "you've got total bandwidth of 33 megahertz and I started thinking what happens we've got two of them together",
    "start": "860510",
    "end": "866750"
  },
  {
    "text": "what happens if I go above that frequency then these things are not designed to go quickly but they're connected to a very powerful processor",
    "start": "866750",
    "end": "873410"
  },
  {
    "text": "that can make these changes very quickly once again a little bit more context so",
    "start": "873410",
    "end": "878900"
  },
  {
    "start": "875000",
    "end": "930000"
  },
  {
    "text": "I do apologize about this with any any electronic component this manufacturer didn't take any manufacturing there's a",
    "start": "878900",
    "end": "883910"
  },
  {
    "text": "manufacturing bell curve in the data sheets they say typical so typical is that redline that's where most things",
    "start": "883910",
    "end": "891380"
  },
  {
    "text": "should actually work then you've obviously got the low end of the spectrum you got the high end of the spectrum with these sorts of resonance",
    "start": "891380",
    "end": "897650"
  },
  {
    "text": "attacks you will find that you made it depending on what sort of voltages you can get out you may find that your",
    "start": "897650",
    "end": "903560"
  },
  {
    "text": "attacks work on typical and below but won't work on the higher end because of thresholds are slightly different there's a lot to actually consider but",
    "start": "903560",
    "end": "909920"
  },
  {
    "text": "because this is all about manipulating physical properties you have to understand exactly what you're looking at so once again you can get these",
    "start": "909920",
    "end": "916180"
  },
  {
    "text": "manufacturing bell curves and these tolerance curves from the manufacturers so if you're trying to do one of these",
    "start": "916180",
    "end": "921410"
  },
  {
    "text": "sorts of attacks it's you characterize you target you then go through and find all the data shoots from all the parts and",
    "start": "921410",
    "end": "926470"
  },
  {
    "text": "actually put together a chain to work out best and worst case so without",
    "start": "926470",
    "end": "932230"
  },
  {
    "text": "boring your too much the that's this the the picture I've reproduced it again and",
    "start": "932230",
    "end": "937360"
  },
  {
    "text": "then underneath it this is a very very simple logical version of what I've got my little board here so you've got the",
    "start": "937360",
    "end": "943630"
  },
  {
    "text": "microcontroller you've got that logic and you can see a little physical button there and then there's a load switch now",
    "start": "943630",
    "end": "949450"
  },
  {
    "text": "the load switch is simply to turn the USB power on and off because I've seen these some of these systems where they",
    "start": "949450",
    "end": "955660"
  },
  {
    "text": "actually have a USB camera and microphone so they simply turn the power off because they think they're doing the right thing turn the power off you can't",
    "start": "955660",
    "end": "961750"
  },
  {
    "text": "hack if it's powers off which is which is really good so they also turn off the the data but that's controlled the same",
    "start": "961750",
    "end": "967090"
  },
  {
    "text": "way so my objective is or was can I turn that load switch back on through",
    "start": "967090",
    "end": "973300"
  },
  {
    "text": "software even though the hardware the hardware's there to make sure that no matter what happens to the software unless the user presses that button the",
    "start": "973300",
    "end": "979870"
  },
  {
    "text": "camera and microphone should stay off so obviously I wanted to understand what happened so as I said earlier my",
    "start": "979870",
    "end": "985210"
  },
  {
    "text": "question is what happens if I exceed the bandwidth so what happens if I start sending a signal out that's faster than",
    "start": "985210",
    "end": "990520"
  },
  {
    "text": "what this little chip can actually handle so some sciency stuff really",
    "start": "990520",
    "end": "996700"
  },
  {
    "text": "technical and an inductor is a small passive electrical component that stores energy in a magnetic field more from not",
    "start": "996700",
    "end": "1004170"
  },
  {
    "text": "it's just some copper wire around a some sort of ferrite core or something like that and I put all the equations at the",
    "start": "1004170",
    "end": "1010500"
  },
  {
    "text": "bottom because I thought they look cool and they made a slide look really cool and there's a lot of maths behind it and it's that's really dry and but we'll get",
    "start": "1010500",
    "end": "1018420"
  },
  {
    "start": "1017000",
    "end": "1090000"
  },
  {
    "text": "onto some of some more sciency stuff exam really creative in my lessons my slide titles and don't a voltage Delta",
    "start": "1018420",
    "end": "1025620"
  },
  {
    "text": "time so anyone who deals with electronics is aware of the fact that a 1 and a 0 isn't actually a 1 and a 0",
    "start": "1025620",
    "end": "1030839"
  },
  {
    "text": "when you change from a 1 to a 0 there's the infinite ranges of voltages in between as the signal actually",
    "start": "1030840",
    "end": "1036240"
  },
  {
    "text": "changes the rate at which this change happens is called Delta voltage over Delta times how fast the voltage changes",
    "start": "1036240",
    "end": "1042930"
  },
  {
    "text": "over the period of time so the the top on there shows you obviously time and voltage so if you look at a simple clock",
    "start": "1042930",
    "end": "1049650"
  },
  {
    "text": "signal it looks like a 1 and a 0 and in software it is a 1 in a 0 but the electronics has to change from a 1/2",
    "start": "1049650",
    "end": "1056080"
  },
  {
    "text": "zero if you zoom in on an oscilloscope and actually have a look at any clock signal you'll see something more like",
    "start": "1056080",
    "end": "1061570"
  },
  {
    "text": "the one at the bottom where they're actually on an angle so in when you're",
    "start": "1061570",
    "end": "1066820"
  },
  {
    "text": "designing products for EMC compliance or whatever else you need to slow those curves down because every time that",
    "start": "1066820",
    "end": "1072519"
  },
  {
    "text": "changes you get a small amount of emissions and to get those emissions down most EMC electronics designers will",
    "start": "1072519",
    "end": "1077980"
  },
  {
    "text": "actually slow those curves down mostly thio t products they're not designing for that purpose so they have really",
    "start": "1077980",
    "end": "1083350"
  },
  {
    "text": "really sharp edges and it's actually those sharp edges that cause the problem that's what I've actually well that's my",
    "start": "1083350",
    "end": "1088960"
  },
  {
    "text": "theory anyway so we'll get on to a little bit more context an analogue",
    "start": "1088960",
    "end": "1094450"
  },
  {
    "start": "1090000",
    "end": "1119000"
  },
  {
    "text": "switch is like a relay except there's no no parts so it's an electrical component that allows electricity to flow either",
    "start": "1094450",
    "end": "1100659"
  },
  {
    "text": "way when it's turned on and when you turn it off it stops so when I was mentioning earlier about those and that",
    "start": "1100659",
    "end": "1106360"
  },
  {
    "text": "matrix all those little points where the columns and rows join is actually done by an analog switch now analog switch is",
    "start": "1106360",
    "end": "1112360"
  },
  {
    "text": "really important it's not a digital switch it's an analog switch that means it allows ya analog voltages to come",
    "start": "1112360",
    "end": "1117639"
  },
  {
    "text": "through now more electrical stuff once again really created with my slide",
    "start": "1117639",
    "end": "1123940"
  },
  {
    "start": "1119000",
    "end": "1148000"
  },
  {
    "text": "titles and a charge pump a charge pump in electrical terms is where you have a",
    "start": "1123940",
    "end": "1129510"
  },
  {
    "text": "signal that's changing rapidly and you're actually able to use that signal to charge capacitors via diodes etc and",
    "start": "1129510",
    "end": "1135639"
  },
  {
    "text": "reach a higher voltage and that's actually really important there's a parasitic charge pump in some of these",
    "start": "1135639",
    "end": "1141639"
  },
  {
    "text": "systems that if you keep the these these systems moving fast enough you can actually reach a high voltage internally then they're expecting so back to the",
    "start": "1141639",
    "end": "1150370"
  },
  {
    "start": "1148000",
    "end": "1269000"
  },
  {
    "text": "essentially a scope trace just to show you and the blue and the yellow are actually in millivolts and what are they",
    "start": "1150370",
    "end": "1156580"
  },
  {
    "text": "I think they're 20 millivolts per division so they're tiny little voltages and normally if you're looking at system you wouldn't see these it's only because",
    "start": "1156580",
    "end": "1162250"
  },
  {
    "text": "are specifically looking for it the green is actually on five hundred millivolts per division so that's that's",
    "start": "1162250",
    "end": "1167950"
  },
  {
    "text": "a clock signal now on an oscilloscope I noticed that when the clock signal changed and this was under normal",
    "start": "1167950",
    "end": "1173980"
  },
  {
    "text": "conditions if I captured it correctly I could see a very small output following",
    "start": "1173980",
    "end": "1179169"
  },
  {
    "text": "so through this logic system I noticed that there was a small very small output that followed on the edge so as you can",
    "start": "1179169",
    "end": "1186760"
  },
  {
    "text": "see green goes up the yellow and blue go up that's to the outputs from this particular target device when the green goes down",
    "start": "1186760",
    "end": "1193559"
  },
  {
    "text": "blue and the yellow go down but they going below ground it's not that's not that's not a digital signal that's an",
    "start": "1193559",
    "end": "1200079"
  },
  {
    "text": "analog signal and well that's really interesting so once again you have to have an oscilloscope to find this so I",
    "start": "1200079",
    "end": "1205809"
  },
  {
    "text": "used a signal generator and then I started to increase so I set the signal generator up to be the same",
    "start": "1205809",
    "end": "1211209"
  },
  {
    "text": "characteristic same impedance as the processor and I started winding up the frequency when you start to approach the",
    "start": "1211209",
    "end": "1217629"
  },
  {
    "text": "resonant frequency of this of the particular target the amplitude goes up so you can see the first one I think is a bit hard to see from here it's it's 20",
    "start": "1217629",
    "end": "1225279"
  },
  {
    "text": "odd you know 22:03 megahertz 22:52 megahertz and you can see we're starting to form a sine wave and you can",
    "start": "1225279",
    "end": "1231519"
  },
  {
    "text": "see the amplitude is going up this one is twenty three point three six megahertz and it's near as matters a",
    "start": "1231519",
    "end": "1236799"
  },
  {
    "text": "perfect sine wave so we found the resonant frequency of that particular target so at that particular that at",
    "start": "1236799",
    "end": "1242169"
  },
  {
    "text": "twenty three point two three six megahertz that target was actually resonating so those tiny little signals",
    "start": "1242169",
    "end": "1247269"
  },
  {
    "text": "that were earlier on we're just in millivolts and if you're doing a normal logic design you'd never notice them because your scopes not even haven't",
    "start": "1247269",
    "end": "1252339"
  },
  {
    "text": "configured it to capture that you hit the right frequency constructive interference and you start in this resonance then we go above it we're at",
    "start": "1252339",
    "end": "1258879"
  },
  {
    "text": "two twenty three point nine megahertz and the amplitude is dropping off 2300 a twenty five point nine and it's really",
    "start": "1258879",
    "end": "1264219"
  },
  {
    "text": "starting to fall off so once you've modeled the the characteristics you can start to find the resonant frequency and",
    "start": "1264219",
    "end": "1269379"
  },
  {
    "start": "1269000",
    "end": "1409000"
  },
  {
    "text": "then of course what we need to do is reproduce that so we have a quick look at the the target that target is here on",
    "start": "1269379",
    "end": "1278169"
  },
  {
    "text": "the board or sorry on the table so standard sort of IOT device but rather",
    "start": "1278169",
    "end": "1284229"
  },
  {
    "text": "than having any Wi-Fi or anything else this is literally just like a test the AC characteristics of it so I simply",
    "start": "1284229",
    "end": "1290409"
  },
  {
    "text": "include a USB to serial interface normally that would be a Wi-Fi module or something how you talk to it is",
    "start": "1290409",
    "end": "1295599"
  },
  {
    "text": "completely irrelevant and we've got the switchable USB so the actual block in",
    "start": "1295599",
    "end": "1300639"
  },
  {
    "text": "the middle the purple block is this is the actual target component and we've got the microcontroller in the middle",
    "start": "1300639",
    "end": "1306009"
  },
  {
    "text": "this just happens to be one of the microchip MIPS cores and then the",
    "start": "1306009",
    "end": "1311559"
  },
  {
    "text": "component interface because this components so small and I can't solder it not without using pick-and-place",
    "start": "1311559",
    "end": "1318039"
  },
  {
    "text": "machinery so it's a lot easier when you you can program them once you program at the",
    "start": "1318039",
    "end": "1323040"
  },
  {
    "text": "bring the carrier board across so the fact that I'm using a carrier board as opposed to the chip directly on there",
    "start": "1323040",
    "end": "1328590"
  },
  {
    "text": "changes the AC characteristics and it does make a small change but the same thing happens if the chips directly on",
    "start": "1328590",
    "end": "1334920"
  },
  {
    "text": "the board is just a slightly different frequency so it's a matter of finding that frequency so that's that's the",
    "start": "1334920",
    "end": "1341160"
  },
  {
    "text": "picture that's the little board which I designed and loads of test points so I can see what's going on and you can see",
    "start": "1341160",
    "end": "1347160"
  },
  {
    "text": "the little carrier board sticking up from the right there I put in those those switches those dip switches so I",
    "start": "1347160",
    "end": "1353970"
  },
  {
    "text": "can turn on and off the signals from the microcontroller I can also include some slow rate limiting resistors in the path",
    "start": "1353970",
    "end": "1360570"
  },
  {
    "text": "to show that simply by putting a resistor in line actually solves the entire problem so it's that it's",
    "start": "1360570",
    "end": "1366780"
  },
  {
    "text": "connected to the PC that's the same docking station and I've got here so we go through that and you know that's the",
    "start": "1366780",
    "end": "1374100"
  },
  {
    "text": "little board we've got the FTDI chip for providing a us a USB to UART interface",
    "start": "1374100",
    "end": "1380790"
  },
  {
    "text": "we've got the mips core we've got the component adapter and we've got the switchable USB so that I can reproduce",
    "start": "1380790",
    "end": "1385920"
  },
  {
    "text": "the reason I did this is so like we can reproduce this attack without mentioning any of the products that are actually",
    "start": "1385920",
    "end": "1390930"
  },
  {
    "text": "vulnerable to it because like I said that would actually be responsible because the only way they can fix it is to redesign it so anyone else can",
    "start": "1390930",
    "end": "1397650"
  },
  {
    "text": "reproduce what I've done I just simply did all using harmony literally pick the chip pick the framework you know went",
    "start": "1397650",
    "end": "1405270"
  },
  {
    "text": "through and configured all the bits I wanted to do so there's nothing there's there's nothing particularly clever about this and use their configuration",
    "start": "1405270",
    "end": "1412140"
  },
  {
    "start": "1409000",
    "end": "1422000"
  },
  {
    "text": "tools to configure the the processor turn on the framework turn on the serial",
    "start": "1412140",
    "end": "1417690"
  },
  {
    "text": "drivers turn on the console so basically using existing framework to build it all the other reason I did this is that this",
    "start": "1417690",
    "end": "1424230"
  },
  {
    "start": "1422000",
    "end": "1483000"
  },
  {
    "text": "is a very common approach you see a lot of people building IOT devices much like this because the frameworks like fantastic they make it easy why write",
    "start": "1424230",
    "end": "1430440"
  },
  {
    "text": "all this code yourself when you can take a few boxes and it generates it all for you it's another reason I did it this way so you can't really see that but",
    "start": "1430440",
    "end": "1436500"
  },
  {
    "text": "that's that's my console handler so I had to write the write that bit itself but there's a buffalo cated on actually",
    "start": "1436500",
    "end": "1444330"
  },
  {
    "text": "made say on stack I didn't proofread that properly and and then there's a in the middle boxes the you are afraid so",
    "start": "1444330",
    "end": "1450240"
  },
  {
    "text": "that's a that's a function provided by the framework to read the serial buffer if you look at this",
    "start": "1450240",
    "end": "1456110"
  },
  {
    "text": "code itself it's an unbounded right so it's an unbounded right to the calling functions stack so you've also send in",
    "start": "1456110",
    "end": "1463100"
  },
  {
    "text": "the wrong payload or whatever else like actually overflow the calling convention oh they're calling function stack get my",
    "start": "1463100",
    "end": "1469460"
  },
  {
    "text": "remote code execution which is how you can actually make this this sort of attack happen once again this is just an example this happens all the time and",
    "start": "1469460",
    "end": "1475610"
  },
  {
    "text": "when you're doing code reviews you see this sort of stuff yes you can fix that but the assumption is is that the software can be hacked so I'm just",
    "start": "1475610",
    "end": "1481640"
  },
  {
    "text": "literally put that in there for that purpose and that's the the dummy IOT",
    "start": "1481640",
    "end": "1489460"
  },
  {
    "start": "1483000",
    "end": "1542000"
  },
  {
    "text": "interface that's just a little a little terminal and I'll show you that and in a little bit and that just allows me to if",
    "start": "1489460",
    "end": "1496760"
  },
  {
    "text": "you can see that enable to turn the power on or off so enable or disable the",
    "start": "1496760",
    "end": "1501770"
  },
  {
    "text": "minute privacy mode is enabled that stops me from turning the power on and off because until the user presses the",
    "start": "1501770",
    "end": "1507290"
  },
  {
    "text": "button so basically the software can enable privacy mode which means the software no longer has control over the",
    "start": "1507290",
    "end": "1513470"
  },
  {
    "text": "power the user has to press a button from the earlier logic which then allows",
    "start": "1513470",
    "end": "1518840"
  },
  {
    "text": "the software to actually yet turn the power back on and I think that's that's",
    "start": "1518840",
    "end": "1524650"
  },
  {
    "text": "quite straightforward you can't disable privacy from there so what about you got",
    "start": "1524650",
    "end": "1530809"
  },
  {
    "text": "is a little video here simply because this room's very wide but if I've got time afterwards I'll do the same thing",
    "start": "1530809",
    "end": "1537620"
  },
  {
    "text": "on my I'm like computer right here but this is Jo so everyone can see it yeah",
    "start": "1537620",
    "end": "1544070"
  },
  {
    "start": "1542000",
    "end": "1660000"
  },
  {
    "text": "is that gonna start yes okay so I'll just talk through this that's that's",
    "start": "1544070",
    "end": "1549950"
  },
  {
    "text": "just a hand tech USB oscilloscope I've got the two traces and this including the autofocus thing it's a little bit of",
    "start": "1549950",
    "end": "1556190"
  },
  {
    "text": "fun so I'm trying to set this up properly now on the device itself you've got the power LED as you can see down the bottom there there's also another",
    "start": "1556190",
    "end": "1563299"
  },
  {
    "text": "LED that says when privacy mode is disabled so that means that the system can potentially be listening to oh I'm",
    "start": "1563299",
    "end": "1570890"
  },
  {
    "text": "actually talking through here as well I'll just mute that so if I press the button itself as you can see from there",
    "start": "1570890",
    "end": "1576380"
  },
  {
    "text": "you can see that second layer actually turns on so that's a fairly typical sort of you know workflow you press the",
    "start": "1576380",
    "end": "1582440"
  },
  {
    "text": "button to unmute the system then says I'm potentially watching you or listening to you and to simulate that",
    "start": "1582440",
    "end": "1588740"
  },
  {
    "text": "I've got a USB light here as well just to show you once again all I'm looking at his peril not looking at the data and and you can see on the",
    "start": "1588740",
    "end": "1596390"
  },
  {
    "text": "oscilloscope that the yellow and the blue voltage both went up so the blue voltage is at 5 volts there and the",
    "start": "1596390",
    "end": "1602360"
  },
  {
    "text": "yellow voltage was that I think three point three which is the target voltage so then with the software I can enable",
    "start": "1602360",
    "end": "1607940"
  },
  {
    "text": "and disable it at will so I skip to yeah",
    "start": "1607940",
    "end": "1620500"
  },
  {
    "text": "okay so if I actually run the the exploit you can see that now all of",
    "start": "1620500",
    "end": "1626390"
  },
  {
    "text": "sudden well that's just because the earth probe fell off you can now actually see that it's not a one or a zero and if you look on the left hand",
    "start": "1626390",
    "end": "1633110"
  },
  {
    "text": "side you can see where ground is it's actually above and below so there's actually the resonant output by find by",
    "start": "1633110",
    "end": "1638270"
  },
  {
    "text": "sending in the clock signal at 70 megahertz the yellow line is actually oscillating that oscillating has a",
    "start": "1638270",
    "end": "1644360"
  },
  {
    "text": "charge pump effect which actually turns a system back on once again you should be able to see that that shouldn't work and if the frequency is wrong you barely",
    "start": "1644360",
    "end": "1651770"
  },
  {
    "text": "see a glitch you get exactly the right frequency and the entire thing starts oscillating so I've got a few theories",
    "start": "1651770",
    "end": "1657380"
  },
  {
    "text": "I've said I'm not a hundred percent sure as to what's what's causing it there's probably gonna need to be some much lot",
    "start": "1657380",
    "end": "1663530"
  },
  {
    "start": "1660000",
    "end": "1940000"
  },
  {
    "text": "of people than me looking at the problem to identify exactly what's causing it but it's really easy to solve so it doesn't really matter so if we look at",
    "start": "1663530",
    "end": "1671270"
  },
  {
    "text": "the edges you know the green clock signal goes up the output goes up the agreeance clock signal goes down the",
    "start": "1671270",
    "end": "1676490"
  },
  {
    "text": "output goes down so this means that there's a distinct coupling between the input and output signals on the edges",
    "start": "1676490",
    "end": "1682550"
  },
  {
    "text": "and only on the edges when the privacy hardware is operational the faster",
    "start": "1682550",
    "end": "1688370"
  },
  {
    "text": "that's the faster that slew rate or faster their change in voltage in volts time the larger the output is so this",
    "start": "1688370",
    "end": "1695240"
  },
  {
    "text": "tends to indicate a number of different things now I've had lots of discussions with lots of people including some RF",
    "start": "1695240",
    "end": "1700580"
  },
  {
    "text": "engineers who came up with some other potential theories for why this is happening so I'll included all the theories that I've heard so far and I think honestly",
    "start": "1700580",
    "end": "1707390"
  },
  {
    "text": "it's probably a combination of them all so I talked earlier about an inductor just being not much more on a copper",
    "start": "1707390",
    "end": "1713390"
  },
  {
    "text": "wire that stores energy in a magnetic field so this one if you look at my very",
    "start": "1713390",
    "end": "1718429"
  },
  {
    "text": "early diagram the analog switches join effectively to two or three or four lines together that",
    "start": "1718429",
    "end": "1726300"
  },
  {
    "text": "is by pinching an inductor depending on you know the path if it's actually looping round back on itself that's an",
    "start": "1726300",
    "end": "1731400"
  },
  {
    "text": "inductor then you have something called parasitic capacitance which is the natural capacitance that any component",
    "start": "1731400",
    "end": "1736650"
  },
  {
    "text": "has at a certain frequency you put those two together and you get what's called an LC circuit an LC circuit has a natural resonant frequency",
    "start": "1736650",
    "end": "1743400"
  },
  {
    "text": "so that was that was my initial thought but the actual resonant frequency of a circuit that small is going to be up",
    "start": "1743400",
    "end": "1749370"
  },
  {
    "text": "into the gigahertz and I'm nowhere near that so that could be part of it I said I don't I don't entirely know this is a",
    "start": "1749370",
    "end": "1756480"
  },
  {
    "text": "my theories but the it's possible that the parasitic capacitance of other parts",
    "start": "1756480",
    "end": "1762360"
  },
  {
    "text": "of the board how it's how it sold it on etc I've reduced that frequency quite a bit and an RF engineer said to me and",
    "start": "1762360",
    "end": "1768630"
  },
  {
    "text": "that he thinks this might actually be partially an RF strip line he said you might beginning reflections so at the",
    "start": "1768630",
    "end": "1774270"
  },
  {
    "text": "right frequency effectively ending up with either end of this this small inductive loop at you know at different",
    "start": "1774270",
    "end": "1781080"
  },
  {
    "text": "voltages and you do it fast enough you end up getting RF reflect reflections I thought okay that that might make sense",
    "start": "1781080",
    "end": "1786090"
  },
  {
    "text": "once again if you get them at the right frequency coupled with everything else and I think the main thing is is that there's",
    "start": "1786090",
    "end": "1791730"
  },
  {
    "text": "there's parasitic capacitance on the inputs and there's also a ground bounce if we hit it exactly the right frequency",
    "start": "1791730",
    "end": "1797520"
  },
  {
    "text": "I think the parasitic capacitance and the ground bounces we're driving this",
    "start": "1797520",
    "end": "1802680"
  },
  {
    "text": "chip so fast that it's actually bouncing above and below ground therefore the outputs are simply following it and as",
    "start": "1802680",
    "end": "1807720"
  },
  {
    "text": "it's all analog switch basis we end up with this AC signal coming out and the",
    "start": "1807720",
    "end": "1812730"
  },
  {
    "text": "observation that I noticed is that the capacitance does change the resonant frequency so if you touch part of it the",
    "start": "1812730",
    "end": "1819510"
  },
  {
    "text": "resonant frequency does change so it does very much indicate that there is a capacitance there if you change the decoupling capacitors on the thing it",
    "start": "1819510",
    "end": "1826020"
  },
  {
    "text": "changes the resonant frequency that doesn't stop it but it simply changes the frequency so I think there's a lot of going on so just going back to the",
    "start": "1826020",
    "end": "1834360"
  },
  {
    "text": "slide again as you we approach the resonant frequency the amplitude goes up we end up with a near perfect sine wave",
    "start": "1834360",
    "end": "1840600"
  },
  {
    "text": "certainly for this purpose you can see it's not a perfect sine wave for anyone whose particular detail focus it's",
    "start": "1840600",
    "end": "1847470"
  },
  {
    "text": "pretty close so the next part I needed to understand",
    "start": "1847470",
    "end": "1852490"
  },
  {
    "text": "is why is this turning on the USB switch when the USB switch says it requires a",
    "start": "1852490",
    "end": "1857920"
  },
  {
    "text": "minimum voltage to actually enable the the output so I started looking through",
    "start": "1857920",
    "end": "1863650"
  },
  {
    "text": "all the data sheets and of course the manufacturers aren't going to tell you exactly how their chips work internally but with my best judgment talking to a",
    "start": "1863650",
    "end": "1871510"
  },
  {
    "text": "cup of engineers as well we came up with a number of different simulation models that we thought were pretty close they",
    "start": "1871510",
    "end": "1877300"
  },
  {
    "text": "had the same basic characteristics as what the data sheets were describing when we actually modeled and this is just one particular one you can see the",
    "start": "1877300",
    "end": "1884710"
  },
  {
    "text": "the green trace along the bottom when it starts resonating we actually end up with the the parasitic capacitance of",
    "start": "1884710",
    "end": "1891730"
  },
  {
    "text": "the gate of the FET at the top actually playing into effect of this we're actually charged pumping that capacitor",
    "start": "1891730",
    "end": "1898480"
  },
  {
    "text": "so the switch the logical switch the FET at the top has a its gate has a capacitance in it we're actually using",
    "start": "1898480",
    "end": "1904780"
  },
  {
    "text": "that storing energy and slowly pulling it down which is where you can see the the purple signal yeah they're purple",
    "start": "1904780",
    "end": "1911350"
  },
  {
    "text": "signal so as we reach also and we reach the on threshold so we're charging it frantically if we keep charging it comes",
    "start": "1911350",
    "end": "1917650"
  },
  {
    "text": "down then when it reaches the on threshold you can see the red line all the sun starts to go up now if you turn",
    "start": "1917650",
    "end": "1922930"
  },
  {
    "text": "this on normally that red line would be near as mad as vertical and that blue line would come all the purple line would come all the way down but because",
    "start": "1922930",
    "end": "1928870"
  },
  {
    "text": "of the characteristics we're using that the charge pump effect we can turn it on slowly while relatively slowly from the",
    "start": "1928870",
    "end": "1934510"
  },
  {
    "text": "time you actually start the attack to the time this turns on it's still only five microseconds so it's still still pretty quick so that was all research I",
    "start": "1934510",
    "end": "1943030"
  },
  {
    "text": "did without using the software that was a signal generators and everything else although this is an interesting characteristic it's not really very",
    "start": "1943030",
    "end": "1949960"
  },
  {
    "text": "useful unless it can be done by a software so then of course how do you actually get these exact frequencies out",
    "start": "1949960",
    "end": "1954970"
  },
  {
    "text": "of microcontrollers etc so this was a",
    "start": "1954970",
    "end": "1961450"
  },
  {
    "text": "software exploit fir for one of the versions of this board most of the microcontrollers if you familiar with",
    "start": "1961450",
    "end": "1967450"
  },
  {
    "text": "them they have had this processor core they then have peripheral hardware they have you know output comparators all",
    "start": "1967450",
    "end": "1973420"
  },
  {
    "text": "sorts of analog lovelies and they've got pulse width modulation Hardware all that stuff turned on or enabled the exploit",
    "start": "1973420",
    "end": "1980770"
  },
  {
    "text": "what it needs to do is to turn on this hardware so he turns on this capability adjusts the relevant divisors",
    "start": "1980770",
    "end": "1987309"
  },
  {
    "text": "and then you get exactly the right frequency so as long as your clock signals 50% duty cycle and you can get",
    "start": "1987309",
    "end": "1992529"
  },
  {
    "text": "the right frequency purely using the hardware so the CPU core is not actually involved in this all it has to do is run",
    "start": "1992529",
    "end": "1997570"
  },
  {
    "text": "this code configure the peripheral hardware and then your away so I've come across some of the CPUs where their",
    "start": "1997570",
    "end": "2003630"
  },
  {
    "text": "actual GPIO s can only go to 25 megahertz and I like what our CPU simply",
    "start": "2003630",
    "end": "2009419"
  },
  {
    "text": "can't go to that but what you can do is you can drive two signals out of phase to each other and you can double the",
    "start": "2009419",
    "end": "2014460"
  },
  {
    "text": "effective frequency so there's all sorts of funny things you can actually do to actually you don't have to have a perfect sine wave you can find the",
    "start": "2014460",
    "end": "2020309"
  },
  {
    "text": "writes of a combination of input signals to these devices you can create the the AC signal with a high enough RMS above",
    "start": "2020309",
    "end": "2027539"
  },
  {
    "text": "ground to actually turn these systems on so once again once again this is all",
    "start": "2027539",
    "end": "2033090"
  },
  {
    "text": "based around the assumption that the software has an RCA of some sort which is the assumption that these products",
    "start": "2033090",
    "end": "2038159"
  },
  {
    "text": "are being built around hence they put the hardware in so turning that into assembly language and thirty-two",
    "start": "2038159",
    "end": "2045360"
  },
  {
    "text": "instructions 128 bytes of code if you can inject that into a buffer overflow like I showed you earlier on you can",
    "start": "2045360",
    "end": "2052020"
  },
  {
    "text": "configure the hardware the system can continue running as normal you've simply reconfigured some of the peripheral",
    "start": "2052020",
    "end": "2057210"
  },
  {
    "text": "hardware to enable this exploit the output stays on but the LED itself never comes on so the user is completely",
    "start": "2057210",
    "end": "2063210"
  },
  {
    "text": "unaware that the system has actually enabled the camera microphone or whatever else so this particular device",
    "start": "2063210",
    "end": "2069929"
  },
  {
    "text": "here I captured it on a scope and set that the triggers up properly and you can see that once again the the yellow",
    "start": "2069929",
    "end": "2075690"
  },
  {
    "text": "signal the voltage at the bottom that says 1.3 volts that's not correct that's just because I had to design the time",
    "start": "2075690",
    "end": "2081240"
  },
  {
    "text": "base out so far it's about 750 million volts something like that but once again you can see the the output actually",
    "start": "2081240",
    "end": "2087270"
  },
  {
    "text": "drops slightly because of the charge pump effects are actually pulling the whole system down slightly below ground then we charge up the output sorry we",
    "start": "2087270",
    "end": "2094500"
  },
  {
    "text": "charge up the gate capacitor on there on the high side FET and also then it turns on because it's quite a slow turn on",
    "start": "2094500",
    "end": "2099780"
  },
  {
    "text": "anyone who's familiar with electronics that's quite slow but it's still turning on within 12 microseconds and that's quite a that's quite a slow slow edge",
    "start": "2099780",
    "end": "2108470"
  },
  {
    "text": "it's not all as bad as it as it seems so",
    "start": "2110390",
    "end": "2115410"
  },
  {
    "start": "2114000",
    "end": "2170000"
  },
  {
    "text": "we we just summarize it quickly you've got the change in voltage so the rate of change of voltage has a big",
    "start": "2115410",
    "end": "2121589"
  },
  {
    "text": "impact on this so that main means it's actually really really simple to stop if you reduce the speed at which the",
    "start": "2121589",
    "end": "2128339"
  },
  {
    "text": "voltage can change this attack goes away altogether and that's part of the problem that's why it's unpatch well you can't do that",
    "start": "2128339",
    "end": "2133469"
  },
  {
    "text": "through software because if you can change it through software it can be changed back through software all you need to do is actually put it in just a",
    "start": "2133469",
    "end": "2139440"
  },
  {
    "text": "simple resistor in line with all of your logic signals going to and from any of these devices just like you would with software your software controls I was",
    "start": "2139440",
    "end": "2146400"
  },
  {
    "text": "validate your inputs hardware needs to validate the controls from other parts of the hardware system make sure that",
    "start": "2146400",
    "end": "2151890"
  },
  {
    "text": "the maximum input frequency of your devices is it here too so if you've got a really fast CPU like the one I'm using",
    "start": "2151890",
    "end": "2158130"
  },
  {
    "text": "here that can generate these signals make sure that anything it's talking to you validated those inputs you've slowed",
    "start": "2158130",
    "end": "2163499"
  },
  {
    "text": "the signal down so that no matter what the software does it simply cannot exert that level of control so going back to",
    "start": "2163499",
    "end": "2173819"
  },
  {
    "start": "2170000",
    "end": "2220000"
  },
  {
    "text": "it the purpose of this hardware state machine in these designs is to make sure that when the software on the main",
    "start": "2173819",
    "end": "2179130"
  },
  {
    "text": "processor assuming it can be hacked to make sure that the user still has control the risk is that these these",
    "start": "2179130",
    "end": "2185940"
  },
  {
    "text": "designs because their logic is flaws but the implementation is not that the",
    "start": "2185940",
    "end": "2191130"
  },
  {
    "text": "hardware actually serves very little purpose it's good it looks good it's nice really fantastic these companies",
    "start": "2191130",
    "end": "2197460"
  },
  {
    "text": "are building it in and they should be commended for that the problem is that software can manipulate then they view spend the time and actually understand",
    "start": "2197460",
    "end": "2203670"
  },
  {
    "text": "the target every model of device would have a different resonant frequency every manufacturer would have a",
    "start": "2203670",
    "end": "2209940"
  },
  {
    "text": "different resonant frequency depending on how they've designed it but once again once somebody did the research and actually targeted these particular",
    "start": "2209940",
    "end": "2215819"
  },
  {
    "text": "systems it's just a matter of doing a simple software exploit to actually turn this back on so there is some stuff we",
    "start": "2215819",
    "end": "2222299"
  },
  {
    "start": "2220000",
    "end": "2406000"
  },
  {
    "text": "can do through software I said software alone can't mitigate it which is true but there is some things you can actually do now depending on the",
    "start": "2222299",
    "end": "2227999"
  },
  {
    "text": "the the processor etc so there's nothing we can do about the silicon level stuff",
    "start": "2227999",
    "end": "2233160"
  },
  {
    "text": "because that's outside of our control anyone doing hardware design you have no control over what the companies are providing to the faster the slew rate",
    "start": "2233160",
    "end": "2240509"
  },
  {
    "text": "the faster the change in voltage over changing the greater the output amplitude we can do something about this simply put a",
    "start": "2240509",
    "end": "2247140"
  },
  {
    "text": "resistor in line now in production these you know you're going to talk fractions of a cent cost differences it's",
    "start": "2247140",
    "end": "2253080"
  },
  {
    "text": "completely immaterial if you do it when you're doing the design if you wait till after the design you have to do a reengineer it gets very expensive it",
    "start": "2253080",
    "end": "2260190"
  },
  {
    "text": "probably ends up tens of thousands of times more expensive if you could simply adding these parts is at the design time",
    "start": "2260190",
    "end": "2265500"
  },
  {
    "text": "that there's no cost to it to speak of now see oh I just dropped out then right",
    "start": "2265500",
    "end": "2271560"
  },
  {
    "text": "as the signals that are under software control and you can do some hardening depending on the processor that you've",
    "start": "2271560",
    "end": "2277110"
  },
  {
    "text": "actually got so I'll talk about there this particular MIPS one so if you do some hardening and make sure that some",
    "start": "2277110",
    "end": "2283590"
  },
  {
    "text": "of the hardware security capabilities are turned on now the really obvious one is on this particular chip you can make",
    "start": "2283590",
    "end": "2290550"
  },
  {
    "text": "sure that those pins can only be changed purpose once so if they're being set to",
    "start": "2290550",
    "end": "2296460"
  },
  {
    "text": "GPIO you can say do not allow these to be turned to an output compare all pulse width modulated pin later that's",
    "start": "2296460",
    "end": "2303090"
  },
  {
    "text": "fine for the RC e running in this instance but if it's the persistent RC and you can actually restart the device",
    "start": "2303090",
    "end": "2308430"
  },
  {
    "text": "then that doesn't serve any purpose but it's it's a countermeasure it can help it's all about defense and depth try to",
    "start": "2308430",
    "end": "2314970"
  },
  {
    "text": "make the thing more more difficult the other way to do it once again is a redesign issue on the microchip parts",
    "start": "2314970",
    "end": "2323130"
  },
  {
    "text": "they call them are Pepin's as in remappable pins you can change the function but there's a lot of pins that are not remappable so if there's",
    "start": "2323130",
    "end": "2328920"
  },
  {
    "text": "something particularly security-conscious that you want to make sure can only go at certain speeds and no matter what the issue don't use a",
    "start": "2328920",
    "end": "2334020"
  },
  {
    "text": "remappable pin if it's remappable then it means it's got this put this additional hardware connected to it that you can change through software so you",
    "start": "2334020",
    "end": "2340170"
  },
  {
    "text": "can see here I've just picked a couple of pins you know the RPM means that this is port e so remappable and it's and it's bit v",
    "start": "2340170",
    "end": "2346410"
  },
  {
    "text": "you don't you don't want to use that if it's particularly critical the pins in green they're not remappable well",
    "start": "2346410",
    "end": "2352230"
  },
  {
    "text": "technically they are you can see there's analog there's a parallel port and",
    "start": "2352230",
    "end": "2358380"
  },
  {
    "text": "there's GPIO stuff on there as well so you could potentially remap that just those pins into the parallel port and do",
    "start": "2358380",
    "end": "2363480"
  },
  {
    "text": "something similar with DMA but once again it makes the thing more challenging but there's always ways around it the simplest one is to simply",
    "start": "2363480",
    "end": "2369000"
  },
  {
    "text": "add resistors inline and to show that was again a really really simple",
    "start": "2369000",
    "end": "2374010"
  },
  {
    "text": "simulation so if we Shoom a parasitic capacitance on the defect gate of say five Pico farad's",
    "start": "2374010",
    "end": "2381810"
  },
  {
    "text": "which is fairly typical for some of these peach and fats you can see the the the blue signal you can see we're",
    "start": "2381810",
    "end": "2387870"
  },
  {
    "text": "getting a nice nice large amplitude the minute you put a resistor that are 1 in line the amplitude drops that little",
    "start": "2387870",
    "end": "2395610"
  },
  {
    "text": "green trace that's all it is it's as simple as putting a resistor in line to change that slew rate so that we don't",
    "start": "2395610",
    "end": "2400740"
  },
  {
    "text": "end up with same amount of current going through to effect this charge pump so a",
    "start": "2400740",
    "end": "2408240"
  },
  {
    "start": "2406000",
    "end": "2771000"
  },
  {
    "text": "summary of all of this some of these some do say some some of these implementations are vulnerable to",
    "start": "2408240",
    "end": "2414600"
  },
  {
    "text": "resonance attacks there's a lot of characteristics but than any sort of side channel it's all about characterizing the target if somebody is",
    "start": "2414600",
    "end": "2421980"
  },
  {
    "text": "used a particular component with a very high logic - abling it that may not be",
    "start": "2421980",
    "end": "2428550"
  },
  {
    "text": "vulnerable I haven't researched all these options but I'm not going to say they all are because that would be completely irresponsible and a lot of",
    "start": "2428550",
    "end": "2434850"
  },
  {
    "text": "the modern systems on a chip or microcontrollers can generate signals fast enough to exploit this behavior I",
    "start": "2434850",
    "end": "2440790"
  },
  {
    "text": "said even if the front side will only go at just a 25 megahertz by running two of the pins out of phase to each other you",
    "start": "2440790",
    "end": "2446940"
  },
  {
    "text": "can actually generate their right sort of signals that you're looking for you can also do some funky things with DMA and actually changing the tri-states as",
    "start": "2446940",
    "end": "2453900"
  },
  {
    "text": "well so you can float pins and pull them back down to end up with some of the doubling effects the other thing is to",
    "start": "2453900",
    "end": "2459210"
  },
  {
    "text": "use the one time configuration fuses if they're supported so if your chip has the ability to set some of this stuff up",
    "start": "2459210",
    "end": "2464490"
  },
  {
    "text": "in you know permanently then use that capability because if you don't use that capability somebody can actually exploit",
    "start": "2464490",
    "end": "2470700"
  },
  {
    "text": "this through through you know through software now I'm gonna try I'll put them",
    "start": "2470700",
    "end": "2476670"
  },
  {
    "text": "onto that one but I'm going to do this first it's gonna pong and bing and if",
    "start": "2476670",
    "end": "2482130"
  },
  {
    "text": "anyone wants to come have a look you're welcome to get my mouse working oh and",
    "start": "2482130",
    "end": "2490230"
  },
  {
    "text": "of course it's suspended well that's going to slow things down a little bit but what's that's resuming does anyone",
    "start": "2490230",
    "end": "2497070"
  },
  {
    "text": "have any have any questions whilst I try and set this up wow that's quiet",
    "start": "2497070",
    "end": "2503520"
  },
  {
    "text": "either everyone's asleep so bored you all or no one once asked a question is",
    "start": "2503520",
    "end": "2510720"
  },
  {
    "text": "this like wait waiting for a kettle to boil it's not even that big a virtual",
    "start": "2510720",
    "end": "2516450"
  },
  {
    "text": "machine",
    "start": "2516450",
    "end": "2518690"
  },
  {
    "text": "hello sorry have you looked at the power output of the circuit while it's",
    "start": "2528130",
    "end": "2534439"
  },
  {
    "text": "resonating in terms of emissions so does",
    "start": "2534439",
    "end": "2539449"
  },
  {
    "text": "it as at resonance also have higher emissions yes I could tell you about something about the system yeah actually",
    "start": "2539449",
    "end": "2545479"
  },
  {
    "text": "that's a really good point and I did notice whether I used a waveguide antenna as with an SDR and a spectrum",
    "start": "2545479",
    "end": "2550969"
  },
  {
    "text": "analyzer and when you actually hit this resonance you do definitely see a spike at that particular frequency and",
    "start": "2550969",
    "end": "2556119"
  },
  {
    "text": "obviously I don't have the equipment to see exactly what's going on inside the chip and exactly it's sort of the area",
    "start": "2556119",
    "end": "2562400"
  },
  {
    "text": "around that particular component is definitely resonating at that frequency yeah on the spectrum analyzer it's quite loud there's a wouldn't be a good way to",
    "start": "2562400",
    "end": "2571930"
  },
  {
    "text": "explore this a bit further alright let's see if it just will work and see my",
    "start": "2571930",
    "end": "2577339"
  },
  {
    "text": "little scope on stress no I don't want you're going to feel scream can somebody",
    "start": "2577339",
    "end": "2584029"
  },
  {
    "text": "please tell Microsoft to stop doing that all right",
    "start": "2584029",
    "end": "2590709"
  },
  {
    "text": "and I thought it would be a good idea to show this live what I Muppet and",
    "start": "2596109",
    "end": "2606369"
  },
  {
    "text": "and connect that one alright alright so",
    "start": "2608830",
    "end": "2615200"
  },
  {
    "text": "we got that there oh is that connected",
    "start": "2615200",
    "end": "2622240"
  },
  {
    "text": "yes okay so if I press the privacy",
    "start": "2622240",
    "end": "2628000"
  },
  {
    "text": "enable button you can see that this light here turns on so that's simulating the USB power side turn around so you",
    "start": "2628000",
    "end": "2635180"
  },
  {
    "text": "can see that's on try not to blind anyone if I tell the system to disable",
    "start": "2635180",
    "end": "2643570"
  },
  {
    "text": "the lighted turn off so I saw a reflection online oh it's not turning off but it's a light over there so I can",
    "start": "2645790",
    "end": "2650870"
  },
  {
    "text": "enable and disable it from here and you can see the scope traces behind me are",
    "start": "2650870",
    "end": "2655880"
  },
  {
    "text": "going up and down as well so if I enable privacy they go down and obviously the",
    "start": "2655880",
    "end": "2664580"
  },
  {
    "text": "the software itself says privacy modes and they will be you can't do that but the actual logic in this little device here guarantees that so now yeah where's",
    "start": "2664580",
    "end": "2674780"
  },
  {
    "text": "my little program connected jolly good ok so if anyone wants to see the privacy",
    "start": "2674780",
    "end": "2683480"
  },
  {
    "text": "LED is off saying that the system cannot watch so I can try power on power off",
    "start": "2683480",
    "end": "2689480"
  },
  {
    "text": "nothing's happening if I then do the resonance exploit the lights turn back on and you can see the resonant signal",
    "start": "2689480",
    "end": "2696100"
  },
  {
    "text": "you can see the signal at the bottom though that is enough to create this charge pump effect to actually turn the",
    "start": "2696100",
    "end": "2701570"
  },
  {
    "text": "system back on so you can see the lights actually on I can then clear the X point and if I turn on measure one source one",
    "start": "2701570",
    "end": "2711850"
  },
  {
    "text": "just look at peak to peak so I'll go",
    "start": "2711850",
    "end": "2717470"
  },
  {
    "text": "back through it again press the button",
    "start": "2717470",
    "end": "2721089"
  },
  {
    "text": "okay and Paran it's really hard to see",
    "start": "2724100",
    "end": "2730140"
  },
  {
    "text": "that that's actually on from here it's a power on and power off and you can see that that's all working there so I'll",
    "start": "2730140",
    "end": "2736740"
  },
  {
    "text": "enable privacy mode again and turn it back on and you can see we've got peak to peak of 785 millivolts and you can",
    "start": "2736740",
    "end": "2744660"
  },
  {
    "text": "actually see it's actually slightly below ground but that's enough to create the charge pumping effect actually turn the system back on and that's purely",
    "start": "2744660",
    "end": "2750300"
  },
  {
    "text": "through software okay and most people",
    "start": "2750300",
    "end": "2762690"
  },
  {
    "text": "still awake Wow thank you very much for having me and I said it's just some research which I find fascinating so",
    "start": "2762690",
    "end": "2768600"
  },
  {
    "text": "hopefully of interest to you all as well",
    "start": "2768600",
    "end": "2772790"
  }
]