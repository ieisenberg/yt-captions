[
  {
    "start": "0",
    "end": "51000"
  },
  {
    "text": "hi everyone welcome to blackhead my name is Max Buzzelli and today I'm gonna talk",
    "start": "179",
    "end": "7080"
  },
  {
    "text": "about the iOS dual booting so I'm bleeding security research at Nvidia at",
    "start": "7080",
    "end": "14940"
  },
  {
    "text": "enormous pickle group and most of my time are having fun with Nvidia driver s tech but previously I was working at a",
    "start": "14940",
    "end": "22050"
  },
  {
    "text": "security researcher at lookout in the blue box focuses on mobile security so I",
    "start": "22050",
    "end": "27449"
  },
  {
    "text": "was made up barreled jailbreak for iOS which is toas as well as was after off",
    "start": "27449",
    "end": "33450"
  },
  {
    "text": "Pegasus exploit white pepper a quick disclaimer I don't speak for my employer",
    "start": "33450",
    "end": "39870"
  },
  {
    "text": "so this research is not related to my work at Nvidia it was just a fun",
    "start": "39870",
    "end": "45210"
  },
  {
    "text": "personal project for me so all the opinions called snippets and ideas they're all mine the old boot like what",
    "start": "45210",
    "end": "53940"
  },
  {
    "start": "51000",
    "end": "176000"
  },
  {
    "text": "is a dual boot why do we need it it's pretty much a process of having multiple",
    "start": "53940",
    "end": "58980"
  },
  {
    "text": "operating systems on one device and both operating systems they can share the",
    "start": "58980",
    "end": "64530"
  },
  {
    "text": "same hardware resources but we have some freedom on which iOS version one to boot",
    "start": "64530",
    "end": "71900"
  },
  {
    "text": "unfortunately Apple did not make our life any easier so there's no low-level",
    "start": "71900",
    "end": "77610"
  },
  {
    "text": "boot manager for is that we can easily switch between the version so we need to figure out by ourself",
    "start": "77610",
    "end": "84560"
  },
  {
    "text": "why do we need the old boot first of all like quick experiments with a different",
    "start": "84560",
    "end": "90869"
  },
  {
    "text": "operating system levels for example heaven is eleven point four and eleven point fun on the same device and easily",
    "start": "90869",
    "end": "97950"
  },
  {
    "text": "switch between them or for example for system recovery if you're working on a",
    "start": "97950",
    "end": "105180"
  },
  {
    "text": "some persistent exploit for is and you're really scared that you can boot loop your device you can boot in a",
    "start": "105180",
    "end": "110790"
  },
  {
    "text": "second system and repair the corrupted file or for example even boot the second",
    "start": "110790",
    "end": "117479"
  },
  {
    "text": "days with in-app red yellow container with disabled",
    "start": "117479",
    "end": "122759"
  },
  {
    "text": "guys LR with disabled KTR are we disabled at all the mitigations which",
    "start": "122759",
    "end": "128039"
  },
  {
    "text": "makes it perfect for different POC test if you want just to focus on",
    "start": "128039",
    "end": "134720"
  },
  {
    "text": "sharpen your exploit and you have someone on mitigation I can disable just a few of them so dead build boot really",
    "start": "135230",
    "end": "142290"
  },
  {
    "text": "works for how does it work so the bad news we need a create a new",
    "start": "142290",
    "end": "148469"
  },
  {
    "text": "set of Bucheon components pretty much the bootloader the kernel the modified file system sometimes the device 3 the",
    "start": "148469",
    "end": "157590"
  },
  {
    "text": "good news that we can bootstrap our second system from a ram itself or from",
    "start": "157590",
    "end": "163560"
  },
  {
    "text": "an end for this purpose kernel or another bootloader can be used and of",
    "start": "163560",
    "end": "169680"
  },
  {
    "text": "course when it kernel or bootloader level code execution like a few words",
    "start": "169680",
    "end": "179189"
  },
  {
    "start": "176000",
    "end": "291000"
  },
  {
    "text": "about Apple secure boot so the secure boot is our arc enemy on a way to draw boot and there's a lot of papers how",
    "start": "179189",
    "end": "186599"
  },
  {
    "text": "they pose secure boot work I just want to make a quick overview so every since",
    "start": "186599",
    "end": "193049"
  },
  {
    "text": "start with Apple routes a public key in a boot ROM and pretty much each component get verified before the",
    "start": "193049",
    "end": "199560"
  },
  {
    "text": "execution so for example boot ROM verified and low I boot stage 1 which",
    "start": "199560",
    "end": "205109"
  },
  {
    "text": "verify and Louis I boot stage 2 which we refine load the rest of the system like kernel cash and device 3 and root of s",
    "start": "205109",
    "end": "212810"
  },
  {
    "text": "in some of the operation during boot step get involved it mostly to provide",
    "start": "212810",
    "end": "218519"
  },
  {
    "text": "secure random number generator so here's",
    "start": "218519",
    "end": "224159"
  },
  {
    "text": "how the Apple boot process looks like for the Apple support local and remote boot and the main difference are we",
    "start": "224159",
    "end": "231659"
  },
  {
    "text": "booting from NAND or IV booting from DFU mode so boot ROM checking are we",
    "start": "231659",
    "end": "237120"
  },
  {
    "text": "currently in DFU mode if we are it expect IBSS image to be uploaded over the USB verified furniture if ever since",
    "start": "237120",
    "end": "245340"
  },
  {
    "text": "the key IBSS gonna load the I back and I beg gonna boot the rest of the system in",
    "start": "245340",
    "end": "250829"
  },
  {
    "text": "the remote mode in a case of local boot boot rom will try to boot",
    "start": "250829",
    "end": "256889"
  },
  {
    "text": "ll be from and if everything is great I will be will boot I boot and continue to",
    "start": "256889",
    "end": "262409"
  },
  {
    "text": "boot rest of the system there is this few changes",
    "start": "262409",
    "end": "267930"
  },
  {
    "text": "- seven so on - seven Apple increase",
    "start": "267930",
    "end": "273610"
  },
  {
    "text": "this the amount of static RAM in a boot ROM so now it can blow it like much",
    "start": "273610",
    "end": "280060"
  },
  {
    "text": "larger boot loaders which means that now boot ROM can boot the I ll be and I will",
    "start": "280060",
    "end": "285190"
  },
  {
    "text": "be for example can boot the rest of the system by passing the high boot the same for DFU mode",
    "start": "285190",
    "end": "291810"
  },
  {
    "start": "291000",
    "end": "410000"
  },
  {
    "text": "alright so boot ROM and boot ROM implements IMG for image verifications",
    "start": "292020",
    "end": "298330"
  },
  {
    "text": "I'm g4 is pretty much a container it contain a payload that contain decryption keys for a payload and",
    "start": "298330",
    "end": "304449"
  },
  {
    "text": "payload manifest the most interesting parts the manifest the manifest is pretty much the set of the different",
    "start": "304449",
    "end": "310479"
  },
  {
    "text": "properties that get verified during the boot so which property from manifests compare it with a property from a device",
    "start": "310479",
    "end": "316599"
  },
  {
    "text": "and if all of them match then boot ROM will pass the execution so for example",
    "start": "316599",
    "end": "323530"
  },
  {
    "text": "one of the properties is payload hash to make sure that payload is not modified",
    "start": "323530",
    "end": "328570"
  },
  {
    "text": "nonce to make sure that we run this specific iOS version on this specific",
    "start": "328570",
    "end": "333639"
  },
  {
    "text": "device this pretty much the way how Apple prevents it downgrade is the ad or",
    "start": "333639",
    "end": "338949"
  },
  {
    "text": "like a board ad to make sure that we run the fiber on the for this device and so",
    "start": "338949",
    "end": "344949"
  },
  {
    "text": "on so if everything is great all the chicks are pass it boot ROM will decrypt the payload and execute it a few more",
    "start": "344949",
    "end": "353409"
  },
  {
    "text": "sins may happen first is if the payload image and payload manifest contains",
    "start": "353409",
    "end": "361300"
  },
  {
    "text": "specific properties the boot ROM can do the stopped override for refuses for like production a production security",
    "start": "361300",
    "end": "367930"
  },
  {
    "text": "fuse and pretty much switch device from release mode to development mode in",
    "start": "367930",
    "end": "373509"
  },
  {
    "text": "other words it can enable the JTAG of course it's really secured by Apple",
    "start": "373509",
    "end": "378729"
  },
  {
    "text": "by Apple Senator another thing is our own manifest hash is this thing for",
    "start": "378729",
    "end": "385720"
  },
  {
    "text": "iPhone 7 and later and the basic idea is its boot ROM calculate hash of the",
    "start": "385720",
    "end": "392050"
  },
  {
    "text": "payload manifest and save it in one of the harder' register and lock this hardware register and during the next",
    "start": "392050",
    "end": "398320"
  },
  {
    "text": "component this hash will be compared it with payload manifest hash of the next",
    "start": "398320",
    "end": "404650"
  },
  {
    "text": "components it's to prevent the mix and match so okay",
    "start": "404650",
    "end": "411490"
  },
  {
    "start": "410000",
    "end": "507000"
  },
  {
    "text": "the bootrom brief ID of the pay load it load load and execute a payload which is",
    "start": "411490",
    "end": "417430"
  },
  {
    "text": "Stage one load well boot loaders IBSS or I ll be the only difference between them",
    "start": "417430",
    "end": "422950"
  },
  {
    "text": "is it's just for remote and local boot in a case of IBSS it's just a weight for",
    "start": "422950",
    "end": "431020"
  },
  {
    "text": "I back image to be uploaded over the USB if everything is great verifies when booted in a case if I load",
    "start": "431020",
    "end": "437740"
  },
  {
    "text": "B it just boot I boot image from meant if something is wrong switch back to the EFI mode both boot loaders they perform",
    "start": "437740",
    "end": "446020"
  },
  {
    "text": "md4 checks the same as boot rom the same mix and match preventing checks they",
    "start": "446020",
    "end": "451300"
  },
  {
    "text": "store it in encrypted time before container so Apple still not ship them decrypt it but luckily there are some",
    "start": "451300",
    "end": "458650"
  },
  {
    "text": "key is available on public it really helped us to check how how the",
    "start": "458650",
    "end": "464470"
  },
  {
    "text": "patrollers really work and since I found 10 Apple made some refactoring work so",
    "start": "464470",
    "end": "470860"
  },
  {
    "text": "now all the boot loaders pretty much one binary that can be run in a different",
    "start": "470860",
    "end": "476020"
  },
  {
    "text": "code path like in local or remote boot so stage 2 i Baker I boot again for local remote",
    "start": "476020",
    "end": "484360"
  },
  {
    "text": "boot both can lower the kernel cache both can load the device 3 the RAM disks and since iOS 12 and now they can lower",
    "start": "484360",
    "end": "492070"
  },
  {
    "text": "the trust cache they perform IMD four checks the same mix-and-match prevention",
    "start": "492070",
    "end": "497350"
  },
  {
    "text": "checks still encrypted and Apple made some refactoring and by merging into one",
    "start": "497350",
    "end": "504460"
  },
  {
    "text": "big binary device 3 that's an image",
    "start": "504460",
    "end": "510130"
  },
  {
    "start": "507000",
    "end": "541000"
  },
  {
    "text": "which basically represents the hardware mappings it's a way for a kernel to communicate with low-level hardware so",
    "start": "510130",
    "end": "517930"
  },
  {
    "text": "doing a boot I boot or I back the set up various entries of the device tree and",
    "start": "517930",
    "end": "523390"
  },
  {
    "text": "later on kernel will read this entries map the addresses if if needed set up",
    "start": "523390",
    "end": "528460"
  },
  {
    "text": "the properties since I Stan it's not encrypted anymore it's still sign it's it's still rapid in",
    "start": "528460",
    "end": "535660"
  },
  {
    "text": "IMG for container and there are few container types for remote and local boot the next component of a boot chain",
    "start": "535660",
    "end": "543850"
  },
  {
    "start": "541000",
    "end": "588000"
  },
  {
    "text": "is a kernel Mukesh so the kernel cache premised xnu kernel and all the kernel",
    "start": "543850",
    "end": "550750"
  },
  {
    "text": "extensions which are static link it to a kernel part the device tree Maps",
    "start": "550750",
    "end": "557560"
  },
  {
    "text": "addresses that some of the properties and in case of is 12 now I boot map the",
    "start": "557560",
    "end": "566080"
  },
  {
    "text": "static trust cash in the memory and the kernel now and I'll read it from one of the device three entries next is gonna",
    "start": "566080",
    "end": "572740"
  },
  {
    "text": "load sep 5 or like sap is Wi-Fi baseband",
    "start": "572740",
    "end": "578010"
  },
  {
    "text": "it still sign it in IMG for container not encrypted since I stand and there",
    "start": "578010",
    "end": "584650"
  },
  {
    "text": "are few container types for remote and local boot the next one is ram disk so",
    "start": "584650",
    "end": "591040"
  },
  {
    "start": "588000",
    "end": "722000"
  },
  {
    "text": "drum disk is like a set of like minimum OS image so it's like minimum set of",
    "start": "591040",
    "end": "597220"
  },
  {
    "text": "frameworks and command-line tools that use it for restore and update purposes and that's why we have two types of ram",
    "start": "597220",
    "end": "604600"
  },
  {
    "text": "disk the only difference is that restoring disk it's by a person from an end and then a flare the fiber and the",
    "start": "604600",
    "end": "612400"
  },
  {
    "text": "update from disk it's not wipe in an end it just updating the different bail",
    "start": "612400",
    "end": "618280"
  },
  {
    "text": "deltas during the update for this since I was 12",
    "start": "618280",
    "end": "623800"
  },
  {
    "text": "Apple moved static thrust cache to a separate file the RAM disk so now each",
    "start": "623800",
    "end": "630250"
  },
  {
    "text": "from this get its own static trust care that need to be loaded by I boot yeah",
    "start": "630250",
    "end": "636070"
  },
  {
    "text": "it's not encrypted anymore since I stand but still sign it and finally the trust cache that then",
    "start": "636070",
    "end": "643450"
  },
  {
    "text": "you think in is 12 so it's it's a file that contain code directory hashes for",
    "start": "643450",
    "end": "654100"
  },
  {
    "text": "binaries that I store it on the RAM disks or the root of s so each from disk when it's get loaded",
    "start": "654100",
    "end": "661240"
  },
  {
    "text": "it requires the trust cache image to be uploaded first and there are two container types and",
    "start": "661240",
    "end": "667120"
  },
  {
    "text": "for local and remote boot during the restore time I guess we'll look for",
    "start": "667120",
    "end": "673240"
  },
  {
    "text": "/boot /i boot offender in a restore partition to read the trust cache for",
    "start": "673240",
    "end": "679300"
  },
  {
    "text": "root of s in a case of normal boot it just look for filesystem ephemeral - fu",
    "start": "679300",
    "end": "685839"
  },
  {
    "text": "d static trust cache image so again instead of like later on it was Colonel",
    "start": "685839",
    "end": "694720"
  },
  {
    "text": "the the part of the kernel was a static trust cache though the one of the data",
    "start": "694720",
    "end": "702279"
  },
  {
    "text": "in a consignment now I will move it into separate image for security purposes so",
    "start": "702279",
    "end": "709749"
  },
  {
    "text": "I boot map it annex a new read chose chosen memory map trust cache entry and",
    "start": "709749",
    "end": "717180"
  },
  {
    "text": "using one of the P map functions basically to map into memory so it's",
    "start": "717180",
    "end": "723370"
  },
  {
    "start": "722000",
    "end": "751000"
  },
  {
    "text": "just a theory how the modern secure boot works on modern Apple devices and now I",
    "start": "723370",
    "end": "730389"
  },
  {
    "text": "want to move more to like reverse engineer in the Apple fiber so it will be a little bit more fun okay so I put",
    "start": "730389",
    "end": "738879"
  },
  {
    "text": "an eye bag so that's level two lot of boot loaders they both support the",
    "start": "738879",
    "end": "744670"
  },
  {
    "text": "different set of commands and this commentar they viable use it during the restore",
    "start": "744670",
    "end": "750220"
  },
  {
    "text": "and update process and unfortunately on recent I boots there is no visible menu",
    "start": "750220",
    "end": "757050"
  },
  {
    "start": "751000",
    "end": "812000"
  },
  {
    "text": "but the common handler still exists so if we know the common name we can send",
    "start": "757050",
    "end": "762399"
  },
  {
    "text": "send the comment over the USB and with other should react the trick is that",
    "start": "762399",
    "end": "767800"
  },
  {
    "text": "boot older should be in recovery mode and we need to use our recovery - C to send the command so what are the",
    "start": "767800",
    "end": "776769"
  },
  {
    "text": "commands basically all we need to do just to grab a decryption key decrypt",
    "start": "776769",
    "end": "783670"
  },
  {
    "text": "one of the boot loaders and use any disassembler and look for boutique",
    "start": "783670",
    "end": "789160"
  },
  {
    "text": "string so as you see each command its rapid into each instruct and distract",
    "start": "789160",
    "end": "795009"
  },
  {
    "text": "this common name pointer to c'mon handler and some of the common",
    "start": "795009",
    "end": "800240"
  },
  {
    "text": "description Apple usually wipe out the common description but even this",
    "start": "800240",
    "end": "805430"
  },
  {
    "text": "information still enough so we can map each common name to each common handler",
    "start": "805430",
    "end": "811040"
  },
  {
    "text": "and here is an incomplete list of commands they are supported in Teresa with others for example like RAM disk",
    "start": "811040",
    "end": "818860"
  },
  {
    "start": "812000",
    "end": "922000"
  },
  {
    "text": "rub these key commands it allow us to create the RAM disk image just from memory so we can upload ROM discovered",
    "start": "818860",
    "end": "826550"
  },
  {
    "text": "the USB send the RAM disk command to boot loader and to try to create a ram",
    "start": "826550",
    "end": "833060"
  },
  {
    "text": "disk object the same for device 3 we can upload device 3 over the USB and create",
    "start": "833060",
    "end": "839240"
  },
  {
    "text": "it just from Ram finder it's basically the way how Apple upload the trust cache",
    "start": "839240",
    "end": "845840"
  },
  {
    "text": "and verified the trust cache I'm uploading the image and send the Feinberg command and I believe they in a",
    "start": "845840",
    "end": "855710"
  },
  {
    "text": "future version they're going to move more and more finder to be uploaded by I boot instead of the kernel I think for",
    "start": "855710",
    "end": "861830"
  },
  {
    "text": "security reasons anyway for now fibre just slowed the trust cache the next is",
    "start": "861830",
    "end": "868460"
  },
  {
    "text": "boutique's the boutique's it's a nice comment it allow us to boot the whole kernel cache just from a",
    "start": "868460",
    "end": "874250"
  },
  {
    "text": "memory so we can upload Ram disk device 3 trust cached and boutiques and here we",
    "start": "874250",
    "end": "879890"
  },
  {
    "text": "go the the system of the Lord a first boot did the opposite of boutiques it's",
    "start": "879890",
    "end": "886400"
  },
  {
    "text": "say hey with louder please boot the system from file system from NAND the",
    "start": "886400",
    "end": "892100"
  },
  {
    "text": "same kernel cares device 3 and it is Rajesh and the last one is gold so it's",
    "start": "892100",
    "end": "898970"
  },
  {
    "text": "interesting command basically did say how Apple that's a way how Apple upload",
    "start": "898970",
    "end": "907750"
  },
  {
    "text": "different diagnostic images to I boot so we can upload different images or the",
    "start": "907750",
    "end": "914510"
  },
  {
    "text": "USB then send the go command and if the image tag is correct it will be executed",
    "start": "914510",
    "end": "920780"
  },
  {
    "text": "by a boot loader okay so let's switch back to drill boot so the plan is we can",
    "start": "920780",
    "end": "928810"
  },
  {
    "start": "922000",
    "end": "952000"
  },
  {
    "text": "bootstrap our like fix it bootloader from a kernel that the one way for this purpose kernel code",
    "start": "928810",
    "end": "935810"
  },
  {
    "text": "execution require it as well is still called the k-loader or we can execute",
    "start": "935810",
    "end": "941630"
  },
  {
    "text": "our fixed bootloader from another bootloader in this purpose in this case like bootloader code execution is",
    "start": "941630",
    "end": "948770"
  },
  {
    "text": "required if if we choose the jail boot",
    "start": "948770",
    "end": "954200"
  },
  {
    "start": "952000",
    "end": "1048000"
  },
  {
    "text": "from a kernel like most of the dual boot that use the kernel they all base it on",
    "start": "954200",
    "end": "960650"
  },
  {
    "text": "a tool called a kill order and the main idea is as soon as we jailbreak our device we can get Colonel readwrite",
    "start": "960650",
    "end": "968750"
  },
  {
    "text": "exact primitives we can take a boot loader that we modified we can write it",
    "start": "968750",
    "end": "974180"
  },
  {
    "text": "back the specific address into physical memory and change a lower set vector in",
    "start": "974180",
    "end": "980210"
  },
  {
    "text": "a kernel to be bootstrap our new bootloader so again the ideas the",
    "start": "980210",
    "end": "985790"
  },
  {
    "text": "bootloader will load the kernel we write to kernel memory and the new bootloader",
    "start": "985790",
    "end": "991910"
  },
  {
    "text": "and jump back to bootloader so it's kind of like big hack but that works and it",
    "start": "991910",
    "end": "998470"
  },
  {
    "text": "the k-loader is in a base of cool booter tool by jonathan sills and the computer",
    "start": "998470",
    "end": "1004720"
  },
  {
    "text": "will do most of the thing for you automatically it will download the fiber or it will decrypt it it will set up the",
    "start": "1004720",
    "end": "1011020"
  },
  {
    "text": "partitions and so on unfortunately it's only work for 32-bit devices and OS",
    "start": "1011020",
    "end": "1016510"
  },
  {
    "text": "versions so the latest device we support is the iPhone 5c there was a few",
    "start": "1016510",
    "end": "1024250"
  },
  {
    "text": "attempts to port key loader or 64-bit devices and the most successful one was",
    "start": "1024250",
    "end": "1031810"
  },
  {
    "text": "kilo door 64 by economics it supports",
    "start": "1031810",
    "end": "1037180"
  },
  {
    "text": "some of the 64-bit devices but there is still a problem that it limited up to",
    "start": "1037180",
    "end": "1042760"
  },
  {
    "text": "highest point eight point four point one I will show you why",
    "start": "1042760",
    "end": "1047910"
  },
  {
    "text": "so since iOS 9 Apple introduced kernel patch protector or the kpp and",
    "start": "1047910",
    "end": "1053560"
  },
  {
    "start": "1048000",
    "end": "1154000"
  },
  {
    "text": "more advanced version of it in 810 devices HRR which walk the kernel memory",
    "start": "1053560",
    "end": "1061780"
  },
  {
    "text": "and prevent any write attempts to memory which means we cannot really map",
    "start": "1061780",
    "end": "1067010"
  },
  {
    "text": "our new bootloader to physical memory it's yeah it's chicken and egg problem",
    "start": "1067010",
    "end": "1072160"
  },
  {
    "text": "there are few ways to bypass it the last successful one was by Luca Tedesco in",
    "start": "1072160",
    "end": "1077809"
  },
  {
    "text": "yellow 10 jailbreak but still even if we can disable Katie RR there's still some",
    "start": "1077809",
    "end": "1083900"
  },
  {
    "text": "atras on map issues there is a trans own memory overlap so in other words the gel",
    "start": "1083900",
    "end": "1090890"
  },
  {
    "text": "boot from Colonel not really working on the newer system yeah one more thing",
    "start": "1090890",
    "end": "1096290"
  },
  {
    "text": "that I didn't mention the GED key the GED keys the key that used to decrypt",
    "start": "1096290",
    "end": "1102049"
  },
  {
    "text": "the fiber and in a time when the Colonel's law that is already locked so even if you jump back to bootloader the",
    "start": "1102049",
    "end": "1109730"
  },
  {
    "text": "keys already locket and we cannot decrypt the new fiber which mean kernel",
    "start": "1109730",
    "end": "1116120"
  },
  {
    "text": "way of gel booting it's works but it gets its own limitation so why not try",
    "start": "1116120",
    "end": "1121549"
  },
  {
    "text": "to draw wood from another bottle itself so we're gonna bootstrap our fixed",
    "start": "1121549",
    "end": "1126799"
  },
  {
    "text": "bootloader from another bootloader which going to load this fixed head kernel cash 6 device 3 ram these fiber all the",
    "start": "1126799",
    "end": "1136130"
  },
  {
    "text": "stuff that I mentioned and finally boot the carbocation so we boot the system just just from RAM and we get the SSH it",
    "start": "1136130",
    "end": "1144860"
  },
  {
    "text": "says I will show show you how we can write the rest of root filesystem",
    "start": "1144860",
    "end": "1150020"
  },
  {
    "text": "to an end and boot a second systems did the plan but on a way to draw boot there",
    "start": "1150020",
    "end": "1158030"
  },
  {
    "text": "a lot I just require as I say we need to create our own set of bootloader components and here is a set of patches",
    "start": "1158030",
    "end": "1166340"
  },
  {
    "text": "that I found useful during my research",
    "start": "1166340",
    "end": "1171470"
  },
  {
    "text": "of dual boot so for example for I boot in I back it's really required to disable code senator check like MD for I",
    "start": "1171470",
    "end": "1178390"
  },
  {
    "text": "want to show you how it's nice to have to exist to disable care is alarm if you",
    "start": "1178390",
    "end": "1183710"
  },
  {
    "text": "want to put the second system with disabled mitigations or for example to",
    "start": "1183710",
    "end": "1189100"
  },
  {
    "text": "inject this custom boot argument because they release a boost the do not support any boot arguments from nvram",
    "start": "1189100",
    "end": "1199040"
  },
  {
    "text": "for xnu for a kernel itself it's required to disable code sign it's nice to disable KTR are like kernel text read",
    "start": "1199040",
    "end": "1206490"
  },
  {
    "text": "on the region I will show it a little bit later it's nice to export tasks for",
    "start": "1206490",
    "end": "1212910"
  },
  {
    "text": "p0 or even room up the whole kernel is readable writable executable as far up",
    "start": "1212910",
    "end": "1218670"
  },
  {
    "text": "disk all we need to do just to add the SSH client and some minimal set of",
    "start": "1218670",
    "end": "1224280"
  },
  {
    "text": "common line tools that we need to play with device 3 again it's not really",
    "start": "1224280",
    "end": "1231360"
  },
  {
    "text": "required patch but it's nice to have if we want to boot the second file system with the second highest system with UI",
    "start": "1231360",
    "end": "1239130"
  },
  {
    "text": "we need to disable the physical storage and finally trust cache is one of the",
    "start": "1239130",
    "end": "1244730"
  },
  {
    "text": "alternative ways of disabling the called sign we can just add a new interest rate R as cache so this is how it looks like",
    "start": "1244730",
    "end": "1252800"
  },
  {
    "start": "1251000",
    "end": "1306000"
  },
  {
    "text": "for I back and I boot there is a function image for validate property",
    "start": "1252800",
    "end": "1258810"
  },
  {
    "text": "callback which compare each of the properties from a boot manifest and",
    "start": "1258810",
    "end": "1264720"
  },
  {
    "text": "compare with the same properties on the device itself and if all the properties are good it kind of continue a boot and",
    "start": "1264720",
    "end": "1271830"
  },
  {
    "text": "it gets it get reference to you from image for load it's like it's easier way",
    "start": "1271830",
    "end": "1278460"
  },
  {
    "text": "to find it just look for one of the properties for example B and C N and there's will be only one reference to",
    "start": "1278460",
    "end": "1284640"
  },
  {
    "text": "image for image for validated property callback so what we need to do is just",
    "start": "1284640",
    "end": "1290340"
  },
  {
    "text": "scroll down to the end of the function and we will see a reference stack check fail and before that it will it will",
    "start": "1290340",
    "end": "1297810"
  },
  {
    "text": "gonna calculate the return value just make sure that we always return 0 into X",
    "start": "1297810",
    "end": "1303030"
  },
  {
    "text": "0 which means like all the checks will be successful boot arguments so the the",
    "start": "1303030",
    "end": "1310680"
  },
  {
    "text": "problem is it release I boot they do not support any custom boot arguments to be",
    "start": "1310680",
    "end": "1316170"
  },
  {
    "text": "pass it to boot loader which means even if we can somehow right boot argument in",
    "start": "1316170",
    "end": "1322290"
  },
  {
    "text": "veeram their role is a boot will just ignore them and continue to use the hard-coded one so as we see here there",
    "start": "1322290",
    "end": "1329670"
  },
  {
    "text": "is like one of the restore boot argument what we can do we can just change them right if",
    "start": "1329670",
    "end": "1335400"
  },
  {
    "start": "1332000",
    "end": "1358000"
  },
  {
    "text": "we can register the bootloader why not so what I did I just changed the boot",
    "start": "1335400",
    "end": "1341910"
  },
  {
    "text": "arguments to add debug to set the debugger capabilities into a system I",
    "start": "1341910",
    "end": "1348030"
  },
  {
    "text": "set the zero to enable a serial output for a kernel boot and our D equal md0",
    "start": "1348030",
    "end": "1354720"
  },
  {
    "text": "which means a system please boot from the RAM disk itself the next thing is",
    "start": "1354720",
    "end": "1360750"
  },
  {
    "text": "guys alarm again it's not really required for dual boot but it's really nice that we can boot the system with",
    "start": "1360750",
    "end": "1368820"
  },
  {
    "text": "not relegated kernel it's easy to spot just look for kernel - % a string",
    "start": "1368820",
    "end": "1376140"
  },
  {
    "text": "reference and we will find the code that asked except to provide like eight bytes",
    "start": "1376140",
    "end": "1384600"
  },
  {
    "text": "it in our case it's a random get bytes so after random good bytes will see the",
    "start": "1384600",
    "end": "1390120"
  },
  {
    "text": "calculation of where is a larger tailslide and physical slide in my case it's x8 get pivotal slide and X 19 get a",
    "start": "1390120",
    "end": "1399300"
  },
  {
    "text": "physical slide unfortunately there is like in a in a release kernel and",
    "start": "1399300",
    "end": "1406500"
  },
  {
    "text": "release I boot there's no easy way to disable KLR this Apple just rip out the",
    "start": "1406500",
    "end": "1411900"
  },
  {
    "text": "code that respect guys a lot of boot argument but what we can do we can relocate it with a zero offset so in my",
    "start": "1411900",
    "end": "1419730"
  },
  {
    "start": "1415000",
    "end": "1431000"
  },
  {
    "text": "case I just put 0 in X 8 index 18 and not out the rest which means that kernel",
    "start": "1419730",
    "end": "1425670"
  },
  {
    "text": "will be relocated with zero offset and stay in the same address all right",
    "start": "1425670",
    "end": "1432870"
  },
  {
    "start": "1431000",
    "end": "1486000"
  },
  {
    "text": "go so the go command as I said that's a way how I boot can boot different",
    "start": "1432870",
    "end": "1439500"
  },
  {
    "text": "diagnostic images and there is a check there is a check for payload type that",
    "start": "1439500",
    "end": "1448170"
  },
  {
    "text": "get upload over the USB so for example if you look for se bi string you'll find",
    "start": "1448170",
    "end": "1454020"
  },
  {
    "text": "a char array with all the supported tags in a case of iOS 12.1 is like seven",
    "start": "1454020",
    "end": "1461550"
  },
  {
    "text": "seven tags are supported and what this function going to do it's",
    "start": "1461550",
    "end": "1466640"
  },
  {
    "text": "going to like read the payload tag and compare with one to support it so this",
    "start": "1466640",
    "end": "1473120"
  },
  {
    "text": "is it to fix just make sure we pass zero instead of pointer to array and we buy",
    "start": "1473120",
    "end": "1478220"
  },
  {
    "text": "zero as a count of different support attacks which means no tag is supported",
    "start": "1478220",
    "end": "1484250"
  },
  {
    "text": "which mean like every tag is supported the next thing since the last one for I",
    "start": "1484250",
    "end": "1490430"
  },
  {
    "start": "1486000",
    "end": "1594000"
  },
  {
    "text": "boot is KT RR or like Colonel textured on the region that the specific mitigation that Apple introduced in",
    "start": "1490430",
    "end": "1496670"
  },
  {
    "text": "iPhone 7 and the idea is I will get their own custom memory controller and",
    "start": "1496670",
    "end": "1504070"
  },
  {
    "text": "Apple set up the region with the kernel will map it on and run the kernel it map",
    "start": "1504070",
    "end": "1509090"
  },
  {
    "text": "it and finish all the initialization process this region will be locked so which means there is no way to write to",
    "start": "1509090",
    "end": "1516380"
  },
  {
    "text": "this region as the log made on a harder level in addition to this the mm you get",
    "start": "1516380",
    "end": "1523960"
  },
  {
    "text": "configure it that no code can be executed outside of the region so that's",
    "start": "1524110",
    "end": "1529880"
  },
  {
    "text": "pretty nice mitigation to prevent the jail breaks but again if we if we control the bootloader we can we can",
    "start": "1529880",
    "end": "1536510"
  },
  {
    "text": "disable it the good thing Apple for some reason Apple still respect and safe",
    "start": "1536510",
    "end": "1543890"
  },
  {
    "text": "Colonel text boot argument I don't know why because like we we can set any new",
    "start": "1543890",
    "end": "1553850"
  },
  {
    "text": "boot argument as they are hard-coded anyway just a nice way for us to define the code as we see if unsafe cannot text",
    "start": "1553850",
    "end": "1561890"
  },
  {
    "text": "boot argument is set then we skip the security set coterra region",
    "start": "1561890",
    "end": "1567080"
  },
  {
    "text": "otherwise the KTR region begin and lands will be set up so what we can do we can",
    "start": "1567080",
    "end": "1575060"
  },
  {
    "text": "jump it out knock it out or even inject unsafe kernel text again I believe that",
    "start": "1575060",
    "end": "1581540"
  },
  {
    "text": "this code is part of the some debug it like it's left for some debug purposes",
    "start": "1581540",
    "end": "1587480"
  },
  {
    "text": "is it stupid out in Aroldis kernels but for some reason not stupid in the I boot",
    "start": "1587480",
    "end": "1594940"
  },
  {
    "start": "1594000",
    "end": "1608000"
  },
  {
    "text": "the same story for kpp it's like previous version of kernel patch protector the secure monitor just looked",
    "start": "1594940",
    "end": "1602080"
  },
  {
    "text": "for monitor to large string and will find the code that just loaded not without and we're good to go",
    "start": "1602080",
    "end": "1609630"
  },
  {
    "start": "1608000",
    "end": "1664000"
  },
  {
    "text": "as you can see there's maybe a lot of fun to reverse engineer the Apple",
    "start": "1610000",
    "end": "1615040"
  },
  {
    "text": "founders especially with their obfuscated logs and no symbols so what",
    "start": "1615040",
    "end": "1623740"
  },
  {
    "text": "I'm gonna do next I'm going to switch to xnu it will be like less assembly code and more C code as likely the source code is",
    "start": "1623740",
    "end": "1632140"
  },
  {
    "text": "available so 4x in new patches the first",
    "start": "1632140",
    "end": "1638380"
  },
  {
    "text": "thing is tasks for Pete that's the way how all the jailbreaks export the kernel task port and the car",
    "start": "1638380",
    "end": "1645160"
  },
  {
    "text": "not a sports is the rifle easily read write and even allocate memory in the kernel of course there is a explicit",
    "start": "1645160",
    "end": "1653050"
  },
  {
    "text": "check if we trying to like request ask for the support for kernel if b ID",
    "start": "1653050",
    "end": "1659620"
  },
  {
    "text": "equals 0 return Colonel Fowler just if we can patch the kernel just patch it out there is more additional mitigation",
    "start": "1659620",
    "end": "1667780"
  },
  {
    "start": "1664000",
    "end": "1728000"
  },
  {
    "text": "starting from is ten point three so now Apple edge tasks conversion evaluation",
    "start": "1667780",
    "end": "1674230"
  },
  {
    "text": "code which mean if abilities code added to mitigate iron beer exploit chains the",
    "start": "1674230",
    "end": "1684340"
  },
  {
    "text": "idea is if we trying to achieve the cannot ask a port it's gonna return now",
    "start": "1684340",
    "end": "1689530"
  },
  {
    "text": "or if we're trying to get the task port of any other process and we are not",
    "start": "1689530",
    "end": "1694930"
  },
  {
    "text": "running as a platform plication and gonna return can ability security as well so make sure you patch it out as",
    "start": "1694930",
    "end": "1701260"
  },
  {
    "text": "well next one the code sign there's a",
    "start": "1701260",
    "end": "1706290"
  },
  {
    "text": "ton of ways to disable code sign if we can patch the kernel and one of the ways is what which I prefer is be a can has",
    "start": "1706290",
    "end": "1713740"
  },
  {
    "text": "the bugger the DES function that basically enable globally enable",
    "start": "1713740",
    "end": "1720670"
  },
  {
    "text": "debugger capabilities for kernel and for all the Karen extensions and it just",
    "start": "1720670",
    "end": "1727120"
  },
  {
    "text": "refer to debug enable it variable so we",
    "start": "1727120",
    "end": "1732850"
  },
  {
    "start": "1728000",
    "end": "1739000"
  },
  {
    "text": "can patch it the back in able to one or always buy HP I can hiss debugger to always return one",
    "start": "1732850",
    "end": "1739890"
  },
  {
    "start": "1739000",
    "end": "1783000"
  },
  {
    "text": "so KTR are even if we disable KTR are in",
    "start": "1739890",
    "end": "1745000"
  },
  {
    "text": "i boot their release kernels they still like there's hard-coded code that's",
    "start": "1745000",
    "end": "1750550"
  },
  {
    "text": "always set up the kernel text read on the region so there are few things that",
    "start": "1750550",
    "end": "1757210"
  },
  {
    "text": "we need to patch just look for MCC so MCC it's one of the name of the Vice",
    "start": "1757210",
    "end": "1766060"
  },
  {
    "text": "three entries that gets parsed by by a kernel and this thing is like all this",
    "start": "1766060",
    "end": "1771160"
  },
  {
    "text": "code is just part of the device through entry and setup read on the region begin",
    "start": "1771160",
    "end": "1776530"
  },
  {
    "text": "and read on the region and variables all we need to do make sure this code is",
    "start": "1776530",
    "end": "1781750"
  },
  {
    "text": "never get executed in occur off the second part for Katie RR is read on the",
    "start": "1781750",
    "end": "1787570"
  },
  {
    "text": "region lockdown so this is where the kernel already set it up get initialize it and this is where the region get",
    "start": "1787570",
    "end": "1794620"
  },
  {
    "text": "locket so in our case it's log MCC and lock MMO this code is it a spot for",
    "start": "1794620",
    "end": "1801820"
  },
  {
    "text": "iPhone 7 just look for 0 x 7 ec magic",
    "start": "1801820",
    "end": "1806890"
  },
  {
    "text": "and you will find a bunch of MS ours that we need to patch out so in other",
    "start": "1806890",
    "end": "1812560"
  },
  {
    "text": "words the region will be not never locked out and in other words it will not enable one last thing with the KTR",
    "start": "1812560",
    "end": "1820630"
  },
  {
    "start": "1818000",
    "end": "1857000"
  },
  {
    "text": "are so there is a lower set vectorbase get decoded get executed when device",
    "start": "1820630",
    "end": "1826960"
  },
  {
    "text": "awake from a sleep mode and this code is chicken if read on the region begin and",
    "start": "1826960",
    "end": "1832270"
  },
  {
    "text": "end is like more or equal to 0 if it's equal to 0 just it's keeping the caterer",
    "start": "1832270",
    "end": "1838690"
  },
  {
    "text": "if it's not it just set up again the HR our region lower l1 upper l1 and final",
    "start": "1838690",
    "end": "1845830"
  },
  {
    "text": "look yell one so our need is just to",
    "start": "1845830",
    "end": "1851200"
  },
  {
    "text": "like knock it out or make sure that read on the region begin and end are always 0",
    "start": "1851200",
    "end": "1857460"
  },
  {
    "start": "1857000",
    "end": "1891000"
  },
  {
    "text": "even if we disable KTR are the respond saying in 810 devices so Apple called it",
    "start": "1857460",
    "end": "1864730"
  },
  {
    "text": "static mappings so there is and now that page tables itself they are allocated in",
    "start": "1864730",
    "end": "1870990"
  },
  {
    "text": "to read only region so data cons will be writable where the page tables will be allocated",
    "start": "1870990",
    "end": "1877840"
  },
  {
    "text": "to and when it's done this region will be set up to be read-only and on top of",
    "start": "1877840",
    "end": "1883690"
  },
  {
    "text": "it the KTR region will be locked as well so even if you disable key to our region you still need to deal with the static",
    "start": "1883690",
    "end": "1890530"
  },
  {
    "text": "mappings but if you can patch a kernel we can disable it during like our VM",
    "start": "1890530",
    "end": "1896620"
  },
  {
    "start": "1891000",
    "end": "1946000"
  },
  {
    "text": "protein it or our vm prot finalized in my case I just remember the region to be",
    "start": "1896620",
    "end": "1903400"
  },
  {
    "text": "readable writable and executable a few more things that we can patch it's not",
    "start": "1903400",
    "end": "1908740"
  },
  {
    "text": "really required but it's a nice one like Mac mount the easily remount file system",
    "start": "1908740",
    "end": "1915220"
  },
  {
    "text": "to be readable writable or unfit code directory is an entrust cash so that's a",
    "start": "1915220",
    "end": "1922060"
  },
  {
    "text": "way how one of the kernel extension check is the binary we are running is it",
    "start": "1922060",
    "end": "1928510"
  },
  {
    "text": "trust it or not and if it's trusted it will be automatically get platform application capabilities so we can patch",
    "start": "1928510",
    "end": "1934540"
  },
  {
    "text": "it to one that any binary will be a platform application for example and set",
    "start": "1934540",
    "end": "1939790"
  },
  {
    "text": "UID to easily attack escalate privileges from from user mode but as I say it's",
    "start": "1939790",
    "end": "1944890"
  },
  {
    "text": "not really required all right we going back to our boot chain so we already",
    "start": "1944890",
    "end": "1951730"
  },
  {
    "start": "1946000",
    "end": "2027000"
  },
  {
    "text": "made a patches for a bootloader we made a patches for a kernel now it's time for the RAM disk patches and the idea is we",
    "start": "1951730",
    "end": "1958540"
  },
  {
    "text": "just take a restore Ram disk unwrap it grow its size a little and find the",
    "start": "1958540",
    "end": "1964240"
  },
  {
    "text": "restored external service and there's the external service that they want if you'll be executed when the kernel like",
    "start": "1964240",
    "end": "1971590"
  },
  {
    "text": "general will start execute the binaries and the language e will agree cute it in other words that the one that we need to",
    "start": "1971590",
    "end": "1978580"
  },
  {
    "text": "replace we need to replace with our service and that will start USB device",
    "start": "1978580",
    "end": "1984100"
  },
  {
    "text": "MUX and spawn the drug dealer so we can connect to the device our de SSH and the",
    "start": "1984100",
    "end": "1993040"
  },
  {
    "text": "tricky one here is that we need to sign our fake demon with the same application IDs because",
    "start": "1993040",
    "end": "2000440"
  },
  {
    "text": "there's one of the mitigation from is 10 the lines D now get hard-coded list of",
    "start": "2000440",
    "end": "2007050"
  },
  {
    "text": "the IDS that Kanak execute and if our IDs one not one of them it will be",
    "start": "2007050",
    "end": "2012210"
  },
  {
    "text": "prevented as well as we need to provide the entitlements that get access to to",
    "start": "2012210",
    "end": "2018150"
  },
  {
    "text": "get a test to USB device smoke service finally wrap everything back and cyanus",
    "start": "2018150",
    "end": "2025080"
  },
  {
    "text": "ram this container so this is how the our store at external demon may look",
    "start": "2025080",
    "end": "2031890"
  },
  {
    "text": "like parts of this code is already open source it and the basic idea is to the",
    "start": "2031890",
    "end": "2037320"
  },
  {
    "text": "22 start USB MOOC service migrating USB",
    "start": "2037320",
    "end": "2043260"
  },
  {
    "text": "device descriptor with the type USB moocs only and then set USB device",
    "start": "2043260",
    "end": "2050389"
  },
  {
    "text": "controller USB device description several the idea is that to calculate it",
    "start": "2050390",
    "end": "2056490"
  },
  {
    "text": "you the idea of the device and set it as a serial or USB device description",
    "start": "2056490",
    "end": "2063440"
  },
  {
    "text": "finally create use be the best controller and set the debug level in",
    "start": "2063440",
    "end": "2068879"
  },
  {
    "text": "one of the services at 7:00 I don't want to focus on it case there is a source available and there is a link at the end",
    "start": "2068880",
    "end": "2074790"
  },
  {
    "text": "of the presentation if you want to know how it works the idea is to set the USB and this bound the drug builds SSH station device",
    "start": "2074790",
    "end": "2084960"
  },
  {
    "start": "2082000",
    "end": "2133000"
  },
  {
    "text": "3 that's it's optional patch that it's required so what we need to do is",
    "start": "2084960",
    "end": "2090210"
  },
  {
    "text": "disable the feasible storage and the physical storage is a special place where the data protection keys are",
    "start": "2090210",
    "end": "2096450"
  },
  {
    "text": "stored and to prevent the collisions between this two system we need to",
    "start": "2096450",
    "end": "2102780"
  },
  {
    "text": "disable the feasible storage as you see here that's part of Apple ipfs text and",
    "start": "2102780",
    "end": "2109820"
  },
  {
    "text": "we see if the Noah feasible storage entry exists the Apple key store will",
    "start": "2109820",
    "end": "2119580"
  },
  {
    "text": "disable the physical storage and switch back to fake keys that's what we need to make sure to not gonna overwrite the",
    "start": "2119580",
    "end": "2125310"
  },
  {
    "text": "original keys yeah again just add no visible storage entry",
    "start": "2125310",
    "end": "2130940"
  },
  {
    "text": "to device three and we're good to go farmer or the trust cash it's optional",
    "start": "2130940",
    "end": "2138400"
  },
  {
    "start": "2133000",
    "end": "2169000"
  },
  {
    "text": "just say nice way to disable the code sign Apple change a little bit the",
    "start": "2138400",
    "end": "2145010"
  },
  {
    "text": "format of trust cache entries now the introduced trust cache entry name with",
    "start": "2145010",
    "end": "2150650"
  },
  {
    "text": "one the only difference it's now get the",
    "start": "2150650",
    "end": "2156170"
  },
  {
    "text": "hash type and some of the Flex so the idea is we just need to add the new cache entry trust cache entry and make",
    "start": "2156170",
    "end": "2163040"
  },
  {
    "text": "sure we change the number of entries in a trust cache model and to be good to go",
    "start": "2163040",
    "end": "2169570"
  },
  {
    "start": "2169000",
    "end": "2200000"
  },
  {
    "text": "so like if you made all the patches to boot chain how to combine it all",
    "start": "2169570",
    "end": "2175910"
  },
  {
    "text": "together so we bootstrap our modified tile back from I boot for example from",
    "start": "2175910",
    "end": "2181490"
  },
  {
    "text": "another bootloader we upload each of the components over the USB device three kernel trust cache one of the RAM disks",
    "start": "2181490",
    "end": "2189670"
  },
  {
    "text": "set the commands to bootloader to like create these corresponding images and",
    "start": "2189670",
    "end": "2196850"
  },
  {
    "text": "finally boot the whole system with the boutique's we will get the restore and",
    "start": "2196850",
    "end": "2203870"
  },
  {
    "start": "2200000",
    "end": "2249000"
  },
  {
    "text": "is booted with like minimal OS version and SSH access so we can use for example",
    "start": "2203870",
    "end": "2209990"
  },
  {
    "text": "disappear oleh to connect to device over the USB but as I say some of the key",
    "start": "2209990",
    "end": "2217430"
  },
  {
    "text": "locks dangers are not started yet so we need like for them to start but that's",
    "start": "2217430",
    "end": "2224720"
  },
  {
    "text": "enough that's enough that we can take the current data partition and separated",
    "start": "2224720",
    "end": "2230660"
  },
  {
    "text": "to into two new partition one for as a new system partition and another astiz a new data partition then upload the root",
    "start": "2230660",
    "end": "2238880"
  },
  {
    "text": "of s over the USB and I like variety to an end",
    "start": "2238880",
    "end": "2243920"
  },
  {
    "text": "finally patch that I boot or I back to boot from the new partition hello it's",
    "start": "2243920",
    "end": "2250610"
  },
  {
    "start": "2249000",
    "end": "2760000"
  },
  {
    "text": "sounds a little like complicated there's too many things so I just wanted to show like a demo how how this stuff works",
    "start": "2250610",
    "end": "2259750"
  },
  {
    "text": "so in this case I want to show the is eleven point four point one I'm gonna",
    "start": "2263160",
    "end": "2269800"
  },
  {
    "text": "run it from my Mac and device is already in a parade jailbroken state so one of",
    "start": "2269800",
    "end": "2276460"
  },
  {
    "text": "the boot loaders its weights and other battles to be uploaded so what I'm going to do I'm going to use the mini column",
    "start": "2276460",
    "end": "2282100"
  },
  {
    "text": "and to connect to a device over G zero and start uploading one of my modified",
    "start": "2282100",
    "end": "2291220"
  },
  {
    "text": "with holders in our recovery - dish chef and if if the boot loaders in recovery",
    "start": "2291220",
    "end": "2299290"
  },
  {
    "text": "mode we can send our own stuff so in this case I send I boot with disabled",
    "start": "2299290",
    "end": "2306960"
  },
  {
    "text": "KLR and with disabled caterer alright",
    "start": "2306960",
    "end": "2313420"
  },
  {
    "text": "you get booted so here we get is eleven point four point one release a boot",
    "start": "2313420",
    "end": "2320010"
  },
  {
    "text": "let's check that we're really running the recovery mode okay and now we can",
    "start": "2320010",
    "end": "2332020"
  },
  {
    "text": "set our modified components back to a bootloader so I upload the RAM disk and",
    "start": "2332020",
    "end": "2339210"
  },
  {
    "text": "set i recovery there see ram disk to force a bootloader to like close",
    "start": "2339210",
    "end": "2345400"
  },
  {
    "text": "modified rom disk and as we see here",
    "start": "2345400",
    "end": "2351820"
  },
  {
    "text": "it's already uploaded the same now the",
    "start": "2351820",
    "end": "2358420"
  },
  {
    "text": "same for device tree we send the device three force boot loader to load it okay",
    "start": "2358420",
    "end": "2369480"
  },
  {
    "text": "i recovered to see device three and",
    "start": "2369480",
    "end": "2374770"
  },
  {
    "text": "finally kernel so I send the colonel with disabled KLR and with disabled KTR",
    "start": "2374770",
    "end": "2382300"
  },
  {
    "text": "our kernel text read on the region which is really enough to play with some herbs",
    "start": "2382300",
    "end": "2390400"
  },
  {
    "text": "exploits and forget about the mitigations finally I boot the system using I",
    "start": "2390400",
    "end": "2396249"
  },
  {
    "text": "recover juicy boutiques the system get",
    "start": "2396249",
    "end": "2406390"
  },
  {
    "text": "booted and as we see here that's showing the running server so it's running to",
    "start": "2406390",
    "end": "2412539"
  },
  {
    "text": "the drug beer server and now we can connect to device over the AC stage over",
    "start": "2412539",
    "end": "2418779"
  },
  {
    "text": "the USB in the shell and yep that's is",
    "start": "2418779",
    "end": "2427509"
  },
  {
    "text": "hello and point four point one on - seven let's prove that kernel is not",
    "start": "2427509",
    "end": "2433029"
  },
  {
    "text": "relocated so I use one of the tools and it's looking for a kernel in the memory and we see the kernel address is not",
    "start": "2433029",
    "end": "2439989"
  },
  {
    "text": "relocated which means the Geisel RS disabled next time when I showed it does",
    "start": "2439989",
    "end": "2445690"
  },
  {
    "text": "forbid zero it's really working by reading some part of the kernel memory for example header and finally try to",
    "start": "2445690",
    "end": "2454900"
  },
  {
    "text": "write some like for example for bite into a kernel memory usually if Castle R",
    "start": "2454900",
    "end": "2461980"
  },
  {
    "text": "is not disabled it's gonna panic a device so write the four bytes and now",
    "start": "2461980",
    "end": "2474670"
  },
  {
    "text": "let's try to read them back so yeah as we see we cannot write the four bytes of the kernel and there is no panic for is",
    "start": "2474670",
    "end": "2485859"
  },
  {
    "text": "12 it's a little bit different story I played add more mitigation and is 12 and",
    "start": "2485859",
    "end": "2492960"
  },
  {
    "text": "change the boot a little bit but the idea is exactly the same we upload our own bootloader which going to bootstrap",
    "start": "2492960",
    "end": "2499869"
  },
  {
    "text": "our own kernel our own device tree our own ram disk and the boot the rest of the system so I connect to a device",
    "start": "2499869",
    "end": "2509579"
  },
  {
    "text": "using the serial cable",
    "start": "2509579",
    "end": "2513509"
  },
  {
    "text": "proof is it we really run it in a recovery mode in this case I just",
    "start": "2519240",
    "end": "2534670"
  },
  {
    "text": "disabled KTR are but not disabled the Chi is LR so Canada will be still",
    "start": "2534670",
    "end": "2539920"
  },
  {
    "text": "relocated because there is some random panics that I see on is 12.1 so I",
    "start": "2539920",
    "end": "2545680"
  },
  {
    "text": "decided to leave it as it is so we are",
    "start": "2545680",
    "end": "2550720"
  },
  {
    "text": "in recovery mode now it's time to send our modified food chain the first is",
    "start": "2550720",
    "end": "2564430"
  },
  {
    "text": "device 3 it's pretty much the same as iOS 11 device true get loaded now we",
    "start": "2564430",
    "end": "2579040"
  },
  {
    "text": "send ROM disk it may take some time it's usually like 300 megabytes",
    "start": "2579040",
    "end": "2588720"
  },
  {
    "text": "and we send I recovered there see ramdisk to the force with loader to",
    "start": "2593960",
    "end": "2601650"
  },
  {
    "text": "execute it and now we see a difference",
    "start": "2601650",
    "end": "2610190"
  },
  {
    "text": "check that you get executed okay Ramdas",
    "start": "2610190",
    "end": "2615330"
  },
  {
    "text": "get loaded so now we see a difference between a boots in iOS 11 is 12 so now",
    "start": "2615330",
    "end": "2621170"
  },
  {
    "text": "the trust care the trust static trust cache is required to be uploaded by I boot so we use the same our recovery the",
    "start": "2621170",
    "end": "2628440"
  },
  {
    "text": "chef to upload the static thrust cache and to force boot loader to load it in a",
    "start": "2628440",
    "end": "2634260"
  },
  {
    "text": "memory using I recovered RC fiber ok and",
    "start": "2634260",
    "end": "2642960"
  },
  {
    "text": "finally let's boot it colonel",
    "start": "2642960",
    "end": "2648200"
  },
  {
    "text": "I recovered there see boutiques and we",
    "start": "2656360",
    "end": "2662750"
  },
  {
    "text": "got our system booted so it's all similar to is 11.4 we got the drug",
    "start": "2662750",
    "end": "2670880"
  },
  {
    "text": "dealer running now we can SSH to our device for example accusing disappeared",
    "start": "2670880",
    "end": "2676910"
  },
  {
    "text": "early to bind local port to remote port",
    "start": "2676910",
    "end": "2683289"
  },
  {
    "text": "okay okay we'll get a show so it's is",
    "start": "2689860",
    "end": "2698630"
  },
  {
    "text": "twelve point one seven so in this case I",
    "start": "2698630",
    "end": "2705650"
  },
  {
    "text": "say I did not disable the Kaiser Lars or the kernel still relegated in the memory but kernel text redundant region is",
    "start": "2705650",
    "end": "2712970"
  },
  {
    "text": "disabled so we can easily modify and the kernel memory including the kernel text",
    "start": "2712970",
    "end": "2718370"
  },
  {
    "text": "region so I'll read the kernel header in",
    "start": "2718370",
    "end": "2724040"
  },
  {
    "text": "the same as in the previous demo and I'll right try to write the eight bytes",
    "start": "2724040",
    "end": "2731530"
  },
  {
    "text": "in a kernel header to prove that HRR is disabled okay okay so yeah as we see no",
    "start": "2731530",
    "end": "2749930"
  },
  {
    "text": "panic and we can read the same bites back so Katie RR is disabled on twelve",
    "start": "2749930",
    "end": "2757130"
  },
  {
    "text": "point one so this was a damn of the like",
    "start": "2757130",
    "end": "2764450"
  },
  {
    "start": "2760000",
    "end": "2980000"
  },
  {
    "text": "dual boot of having like two multiple layers on the same device using the bootloader",
    "start": "2764450",
    "end": "2769790"
  },
  {
    "text": "and of course there are some issues the main issues is there some and compatibility on sapphire side so",
    "start": "2769790",
    "end": "2776330"
  },
  {
    "text": "seppius is like operating systems that run in as separate physical CPU and we",
    "start": "2776330",
    "end": "2784970"
  },
  {
    "text": "don't really have a control how we can update the step bias mean there's some incompatibility for",
    "start": "2784970",
    "end": "2790950"
  },
  {
    "text": "example is 11 and is 12 they have a different protocol how the step is",
    "start": "2790950",
    "end": "2797279"
  },
  {
    "text": "communicate with a kernel which we can't really dull boot 11 and 12 but we still",
    "start": "2797279",
    "end": "2802349"
  },
  {
    "text": "can do 11 and 11 and 12 and 12 so like the major version still work again we",
    "start": "2802349",
    "end": "2809519"
  },
  {
    "text": "don't really control the step update process is we need some code execution on the step aside and even if we do we",
    "start": "2809519",
    "end": "2818339"
  },
  {
    "text": "need somehow to dump the SAP and replay document there is some research made on",
    "start": "2818339",
    "end": "2823470"
  },
  {
    "text": "it but it's still still not complete but",
    "start": "2823470",
    "end": "2828539"
  },
  {
    "text": "what we can do is to load the custom drivers for the custom kernel extensions",
    "start": "2828539",
    "end": "2834210"
  },
  {
    "text": "on a 10 as we see with disabled kernel textured on the region we can map our",
    "start": "2834210",
    "end": "2840059"
  },
  {
    "text": "own memory we can write our own drivers and that's it and one of the plans that",
    "start": "2840059",
    "end": "2847140"
  },
  {
    "text": "I got to make some low-level boot a manager for is for example like as a wrapper for I boot to easily switch",
    "start": "2847140",
    "end": "2853259"
  },
  {
    "text": "between two operating systems I think we still have some time I want to get a",
    "start": "2853259",
    "end": "2861000"
  },
  {
    "text": "quick overview what the is hikin will be so the last year Apple introduced a 12",
    "start": "2861000",
    "end": "2868559"
  },
  {
    "text": "SOC and it definitely rise at some bar on a security and particularly many of",
    "start": "2868559",
    "end": "2874500"
  },
  {
    "text": "you hear about pointer and if occasion code that Apple introduced in the newer",
    "start": "2874500",
    "end": "2880160"
  },
  {
    "text": "iOS and the newer devices and we know that it exists in the kernel safe itself",
    "start": "2880160",
    "end": "2885869"
  },
  {
    "text": "and in a user mode but the bad news it's not just there it now it's an eye boot",
    "start": "2885869",
    "end": "2891299"
  },
  {
    "text": "it's in a kernel cache it is in user mode into step is in a man step user mode level",
    "start": "2891299",
    "end": "2897900"
  },
  {
    "text": "additionally they add some software CFI in critical boot component as well as",
    "start": "2897900",
    "end": "2905609"
  },
  {
    "text": "add the new secure storage where the SAP interpolate okay now stored so that's",
    "start": "2905609",
    "end": "2912990"
  },
  {
    "text": "that's interesting they made some mitigation on like static",
    "start": "2912990",
    "end": "2918839"
  },
  {
    "text": "trust caches so the now the start across cache as I said it's get loaded by I boot itself it's not a part of caramel",
    "start": "2918839",
    "end": "2925380"
  },
  {
    "text": "anymore the dynamic trust cache now moved to IMG for container so they drop completely mg3 container types they made",
    "start": "2925380",
    "end": "2934320"
  },
  {
    "text": "some refactoring on a way how kernel perform the code sanity check by introducing the core trust and finally",
    "start": "2934320",
    "end": "2942030"
  },
  {
    "text": "even in a WebKit there is some hardening including usage of pointer notification",
    "start": "2942030",
    "end": "2947970"
  },
  {
    "text": "codes so we add it's like a 12 jailbreaking may be a tricky one now",
    "start": "2947970",
    "end": "2955880"
  },
  {
    "text": "here's the list of references that I use it during my research I really highly",
    "start": "2956150",
    "end": "2961170"
  },
  {
    "text": "recommend to read the syrup right up about I boot exploit for 5s for off",
    "start": "2961170",
    "end": "2969840"
  },
  {
    "text": "sorry for 32-bit devices which can be ported to 5s and for example using the",
    "start": "2969840",
    "end": "2976230"
  },
  {
    "text": "same step that I do do the dual boot and here's a number of folks who help me do",
    "start": "2976230",
    "end": "2986070"
  },
  {
    "start": "2980000",
    "end": "3038000"
  },
  {
    "text": "my research I just want to say thanks yeah I think we still have time for",
    "start": "2986070",
    "end": "2992340"
  },
  {
    "text": "questions thank you",
    "start": "2992340",
    "end": "2996590"
  },
  {
    "text": "no questions",
    "start": "3002039",
    "end": "3005430"
  },
  {
    "text": "okay even I'll be around if you have a",
    "start": "3017210",
    "end": "3022290"
  },
  {
    "text": "question you can catch me somewhere in a coffee area or in a hole so I think yeah",
    "start": "3022290",
    "end": "3027900"
  },
  {
    "text": "we saved ten minutes Adam [Applause]",
    "start": "3027900",
    "end": "3039520"
  }
]