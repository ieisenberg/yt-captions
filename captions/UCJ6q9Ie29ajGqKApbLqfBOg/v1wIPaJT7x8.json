[
  {
    "text": "welcome to the presentation I'm John Chen and I'm focused on back hunting and fing in",
    "start": "2520",
    "end": "8920"
  },
  {
    "text": "Android iot and Apple products I'm shidan and my ID is flanker",
    "start": "8920",
    "end": "15080"
  },
  {
    "text": "and the director and the chief security researcher of the down security lab of j.com and I mainly focus on the security",
    "start": "15080",
    "end": "22000"
  },
  {
    "text": "AR architecture and bar hunting of mobile and col native security",
    "start": "22000",
    "end": "28480"
  },
  {
    "text": "uh I will do a brief introduction of our lab if you are haven't heard about it and our lab the Don security lab the",
    "start": "30320",
    "end": "38079"
  },
  {
    "text": "security La of the information security division of jd.com and we have found",
    "start": "38079",
    "end": "44200"
  },
  {
    "text": "more than 200 cves in Google Apple Samsung and Huawei and Etc uh our",
    "start": "44200",
    "end": "51719"
  },
  {
    "text": "members consist consisting of previously Pon and Def count CTF winners and we",
    "start": "51719",
    "end": "58120"
  },
  {
    "text": "want the pony award 20 the uh 22 for the best privilege escalation the Mystic",
    "start": "58120",
    "end": "64360"
  },
  {
    "text": "bark and here's our Twitter and our blog if you're interested you can have a look",
    "start": "64360",
    "end": "70000"
  },
  {
    "text": "there okay have a switch okay I was focused on Android",
    "start": "70000",
    "end": "77720"
  },
  {
    "text": "back hunting and uh I switched from Android to Apple for viability research",
    "start": "77720",
    "end": "83200"
  },
  {
    "text": "because of the better vulnerability disclosure policy and higher back bounties and the most important thing is",
    "start": "83200",
    "end": "90600"
  },
  {
    "text": "I build a system using AFL and unicor to simulate to simulate and fast Android",
    "start": "90600",
    "end": "96200"
  },
  {
    "text": "trusted applications by building a custom cysco API it can be adapted for",
    "start": "96200",
    "end": "101439"
  },
  {
    "text": "micos and iOS so my goals are simple I want to",
    "start": "101439",
    "end": "106520"
  },
  {
    "text": "analyze and explore M userland vulnerabilities to identify fing targets",
    "start": "106520",
    "end": "112520"
  },
  {
    "text": "and I want to byass all user space security mechanisms to gain full control",
    "start": "112520",
    "end": "117680"
  },
  {
    "text": "over the of the computer now over 40 logical vulnerabilities have been",
    "start": "117680",
    "end": "123079"
  },
  {
    "text": "discovered since July 2023 I planed to disclose 16",
    "start": "123079",
    "end": "129160"
  },
  {
    "text": "vulnerabilities but Apple responded that they cannot fix it more so I have to",
    "start": "129160",
    "end": "134200"
  },
  {
    "text": "Omit some details in this presentation first of all we need to",
    "start": "134200",
    "end": "139760"
  },
  {
    "text": "talk about some security protections on Mac OS the first one is sip AKA rootless",
    "start": "139760",
    "end": "147640"
  },
  {
    "text": "as we can see here it can limit the actions that the root user can perform on protected parts of the Mac OS for",
    "start": "147640",
    "end": "156120"
  },
  {
    "text": "example it prevents modification of system files and disable unsign col",
    "start": "156120",
    "end": "161440"
  },
  {
    "text": "extension loading the second one is TCC TCC Works",
    "start": "161440",
    "end": "166800"
  },
  {
    "text": "similarly to Android permissions we need to apply foren when needed and general",
    "start": "166800",
    "end": "172640"
  },
  {
    "text": "TC bypass volubility is more valuable than userland rout LP so my goals are simple I want to uh",
    "start": "172640",
    "end": "181120"
  },
  {
    "text": "achieve RC and LP I categorized the remote attack",
    "start": "181120",
    "end": "187040"
  },
  {
    "text": "services on Mac OS into this three different ways in this presentation I",
    "start": "187040",
    "end": "192360"
  },
  {
    "text": "will focus on the third one I will try to use a m document to achieve rce it",
    "start": "192360",
    "end": "198640"
  },
  {
    "text": "means I need to escape from the office sense box in section two I will introduce a",
    "start": "198640",
    "end": "205599"
  },
  {
    "text": "general applications and box Escape approach on Macos if we want to escape",
    "start": "205599",
    "end": "212280"
  },
  {
    "text": "from the applications and box we have three different ways in this presentation I will focus on the third",
    "start": "212280",
    "end": "218959"
  },
  {
    "text": "one too I will try to escape from the applications and box by launching a",
    "start": "218959",
    "end": "224519"
  },
  {
    "text": "fully controlled nonsense boox app this is the simplest app structure",
    "start": "224519",
    "end": "230400"
  },
  {
    "text": "we only need to create the hollow. app contents Macos folder and place an",
    "start": "230400",
    "end": "236159"
  },
  {
    "text": "executable file under MOS folder micos supplies supports different",
    "start": "236159",
    "end": "243480"
  },
  {
    "text": "executable file formats depending on the ship architecture and in this talk all pox",
    "start": "243480",
    "end": "250159"
  },
  {
    "text": "tested on Intel Macbook so if you want to test them in onbook you may need to",
    "start": "250159",
    "end": "255879"
  },
  {
    "text": "do some little changes actually Macos has some security",
    "start": "255879",
    "end": "261239"
  },
  {
    "text": "protections on this attack service any file Modified by a Sandbox app is assign",
    "start": "261239",
    "end": "267280"
  },
  {
    "text": "the quarantine attribute quarantine preent prevents prevents harmful files",
    "start": "267280",
    "end": "273160"
  },
  {
    "text": "from being executed or opened it without user consent quarantine contains four parts",
    "start": "273160",
    "end": "280360"
  },
  {
    "text": "and I believe the most important part of quarantine is the first part quantin",
    "start": "280360",
    "end": "286759"
  },
  {
    "text": "Flags if we download a file with a safari the file will be tagged with quantin",
    "start": "286759",
    "end": "292680"
  },
  {
    "text": "attributes if we try to launch the quarantined app gatekeeper plocks is",
    "start": "292680",
    "end": "297960"
  },
  {
    "text": "launch we need to to system settings to allow the operation after we click the",
    "start": "297960",
    "end": "304080"
  },
  {
    "text": "open anyway button a new dialogue pops up we need to click the open button once",
    "start": "304080",
    "end": "309680"
  },
  {
    "text": "again after this the app finally launches system Pur demon adds its cting",
    "start": "309680",
    "end": "315840"
  },
  {
    "text": "flag with Z X4 Z so the next time when we launch the",
    "start": "315840",
    "end": "321479"
  },
  {
    "text": "user permitted app system Pary demon will not prevent his launch because the",
    "start": "321479",
    "end": "327080"
  },
  {
    "text": "quantin flags contains zero x for zero another situation is launching a",
    "start": "327080",
    "end": "333560"
  },
  {
    "text": "trusted app only a single additional click is required to launch the notorized St so let's make a summary",
    "start": "333560",
    "end": "341800"
  },
  {
    "text": "regardless of whether the app is trusted or untrusted at least an additional",
    "start": "341800",
    "end": "347160"
  },
  {
    "text": "click is required to launch it it is a nice security protection effectively",
    "start": "347160",
    "end": "352919"
  },
  {
    "text": "mitigate the one click RC attack surface so a question can we launch an",
    "start": "352919",
    "end": "358880"
  },
  {
    "text": "executable file file without modifying its cting flag yes we can use an app folder that",
    "start": "358880",
    "end": "365960"
  },
  {
    "text": "doesn't set the kenting attribute to wrap the executable file it is a nice Fe nice feature I",
    "start": "365960",
    "end": "373319"
  },
  {
    "text": "found so if there is a vulnerability that allows us to create an app folder",
    "start": "373319",
    "end": "379520"
  },
  {
    "text": "without curring attribute can we use it to bypass the sandbox have a try but",
    "start": "379520",
    "end": "386880"
  },
  {
    "text": "failed it appears that MOS applies different security policies based on the",
    "start": "386880",
    "end": "392520"
  },
  {
    "text": "specific quarantine Flags if the quarantine flag is not equal to 86 the",
    "start": "392520",
    "end": "397800"
  },
  {
    "text": "quantin need app is launchable I believe the design of quarantine incoporates the concept of",
    "start": "397800",
    "end": "405080"
  },
  {
    "text": "whether the user has permitted this operation if the operation is not is",
    "start": "405080",
    "end": "410319"
  },
  {
    "text": "authorized any right operation to file will be assign a flag other than HX the",
    "start": "410319",
    "end": "416680"
  },
  {
    "text": "system will handle it in a soft way but if the operation is not authorized the",
    "start": "416680",
    "end": "423080"
  },
  {
    "text": "system will use the strictest policies to handle this file as we can see here there are there",
    "start": "423080",
    "end": "430319"
  },
  {
    "text": "are four different quantin flags like download sbox hard and user user",
    "start": "430319",
    "end": "436960"
  },
  {
    "text": "approved here is a demo of how Apple uses this quarantine apis to generate the quarantine attributes as we can see",
    "start": "436960",
    "end": "444560"
  },
  {
    "text": "in the picture on the right the quantin colal extension generates the attribute so we need to analyze the cting kernel",
    "start": "444560",
    "end": "453680"
  },
  {
    "text": "extension the kenting kernel extension is packed into the kernel catch so we",
    "start": "453680",
    "end": "459080"
  },
  {
    "text": "need to download the fanware first the kernel catch is in m4p format so we need",
    "start": "459080",
    "end": "464960"
  },
  {
    "text": "to use some scripts to extract its content here is a demo after this we can",
    "start": "464960",
    "end": "471720"
  },
  {
    "text": "just use IDE Pro to analiz the banner a Sandbox app is not allowed it",
    "start": "471720",
    "end": "478120"
  },
  {
    "text": "to modify files crany attribute and if the input flag doesn't",
    "start": "478120",
    "end": "483680"
  },
  {
    "text": "contain Z X4 Z and the lower list two bytes are non Zer the final curring flag",
    "start": "483680",
    "end": "489800"
  },
  {
    "text": "is equal to input flag pipe 0 x 80 so 81",
    "start": "489800",
    "end": "495879"
  },
  {
    "text": "it means download 82 sunbox 83 sunbox plus download 86 sunbox plus hard if we",
    "start": "495879",
    "end": "505240"
  },
  {
    "text": "try to launch a quarantine need app which quarantine flag is equal to 86 quarantine Cel extension will block the",
    "start": "505240",
    "end": "512080"
  },
  {
    "text": "operation because the operation is not authorized so my high processes is",
    "start": "512080",
    "end": "518440"
  },
  {
    "text": "correct if we want to achieve SPX through launching a nonon box laab we",
    "start": "518440",
    "end": "523959"
  },
  {
    "text": "need to do two things one identify avilability that allows the creation of",
    "start": "523959",
    "end": "530240"
  },
  {
    "text": "an a folder without the conting attribute two find a way to change the",
    "start": "530240",
    "end": "535519"
  },
  {
    "text": "executable files Curren in flag here is the first vulnerability can",
    "start": "535519",
    "end": "541000"
  },
  {
    "text": "help us create an a folder without the quantin attribute on Apple platforms there are",
    "start": "541000",
    "end": "548000"
  },
  {
    "text": "two kinds of containers application container and group container below MOS 15 the group",
    "start": "548000",
    "end": "555160"
  },
  {
    "text": "containers of third party apps are not protected and behave differently compared to",
    "start": "555160",
    "end": "561760"
  },
  {
    "text": "iOS container manager doesn't doesn't automatically create group containers",
    "start": "561760",
    "end": "567240"
  },
  {
    "text": "for an app upon its first launch they're only created when the user calls the",
    "start": "567240",
    "end": "573399"
  },
  {
    "text": "API and there is a past traversal avability in group container folder creation process the created folder",
    "start": "573399",
    "end": "580760"
  },
  {
    "text": "isn't tucked with the cting attribute the patch is simple now the OPI the the API only",
    "start": "580760",
    "end": "589040"
  },
  {
    "text": "Returns the URL and doesn't perform folder creation now we need to focus on the",
    "start": "589040",
    "end": "594720"
  },
  {
    "text": "Second Challenge actually it spend me more time on the first one",
    "start": "594720",
    "end": "600040"
  },
  {
    "text": "in fact micos has significant issues when determin if an operation is user",
    "start": "600040",
    "end": "606079"
  },
  {
    "text": "approved I will introduce four different roads to achieve this rout one privilege",
    "start": "606079",
    "end": "613360"
  },
  {
    "text": "entitlement as long as the app declar the enement any operation on files will",
    "start": "613360",
    "end": "619240"
  },
  {
    "text": "be marked as a two curreny flag regardless of whether the app actually",
    "start": "619240",
    "end": "625040"
  },
  {
    "text": "has redir permissions for the download folder this entitlement is widely used",
    "start": "625040",
    "end": "630320"
  },
  {
    "text": "in mailing applications such as Apple messages Apple Mail WhatsApp we chat and",
    "start": "630320",
    "end": "637760"
  },
  {
    "text": "telegram so for this apps we only need a varability that allows the creation of",
    "start": "637760",
    "end": "643839"
  },
  {
    "text": "arbitary folders to achieve SPX obviously it has limitations like",
    "start": "643839",
    "end": "650639"
  },
  {
    "text": "Microsoft Word and many other applications don't declare the enement so we need to find another way to",
    "start": "650639",
    "end": "657760"
  },
  {
    "text": "exploit them here comes to Ru two we can abuse user",
    "start": "657760",
    "end": "663160"
  },
  {
    "text": "selected feature so what is user selected feature if terminal attempts to open",
    "start": "663160",
    "end": "670360"
  },
  {
    "text": "flat. txt with text edit it will be denied because neither the requesting",
    "start": "670360",
    "end": "676360"
  },
  {
    "text": "terminal nor the handling text edit has access to it however if we double click",
    "start": "676360",
    "end": "682839"
  },
  {
    "text": "flator txt in finder text edit will be able to load the file correctly this is",
    "start": "682839",
    "end": "689560"
  },
  {
    "text": "because the user explicitly wants to use Tex edit to open flat. txt so the",
    "start": "689560",
    "end": "696240"
  },
  {
    "text": "operation system will fully Grant file access to text edit this is called user",
    "start": "696240",
    "end": "702040"
  },
  {
    "text": "selected feature from a system design perspective user selected feature is one",
    "start": "702040",
    "end": "707959"
  },
  {
    "text": "of the most powerful functions on Mac only root and sip can limit Its Behavior",
    "start": "707959",
    "end": "714040"
  },
  {
    "text": "and the most important them is the design of quarantine in cooperates the",
    "start": "714040",
    "end": "719399"
  },
  {
    "text": "concept of whether the user has permitted this operation so can we use",
    "start": "719399",
    "end": "725320"
  },
  {
    "text": "the user selected feature to change the cting flag yes if an action is approved",
    "start": "725320",
    "end": "732200"
  },
  {
    "text": "by the user it will not be marked with cting flag hard for example if we",
    "start": "732200",
    "end": "738959"
  },
  {
    "text": "receive a documents in wchat and then double click it to open with Microsoft",
    "start": "738959",
    "end": "744120"
  },
  {
    "text": "Word word will have full control over the document any subsequent file",
    "start": "744120",
    "end": "749519"
  },
  {
    "text": "operations performed by word on this document will be tucked with A2 curring flag instead of",
    "start": "749519",
    "end": "756639"
  },
  {
    "text": "A6 so under mic uh 14 14.0 if you want",
    "start": "756639",
    "end": "762240"
  },
  {
    "text": "to escape from the Microsoft Word s box we only need to inject the payout into",
    "start": "762240",
    "end": "767959"
  },
  {
    "text": "the received document and sit the previously created nonsense box apps",
    "start": "767959",
    "end": "773560"
  },
  {
    "text": "executable file as a symbolic link pointing to this modified document here",
    "start": "773560",
    "end": "778720"
  },
  {
    "text": "is a",
    "start": "778720",
    "end": "781120"
  },
  {
    "text": "more open with Microsoft",
    "start": "793959",
    "end": "798240"
  },
  {
    "text": "Word as we can see I have escaped from the Microsoft Word s",
    "start": "805600",
    "end": "811399"
  },
  {
    "text": "box I developed this exploit on August 20 last year during the transation",
    "start": "811399",
    "end": "817639"
  },
  {
    "text": "between mosos 13 and mosos 14 after updated to mosos 14 the initial exploit",
    "start": "817639",
    "end": "823920"
  },
  {
    "text": "steps still executed as expected but the maners nons and box app failed to launch",
    "start": "823920",
    "end": "831519"
  },
  {
    "text": "why why was this happened just because Mac Osos 14 introduced the new TCC up",
    "start": "831519",
    "end": "838600"
  },
  {
    "text": "data this was the first time I truly experienced the impact of secur security",
    "start": "838600",
    "end": "844279"
  },
  {
    "text": "protections on exploit development below Mac 14 any nons sunbox",
    "start": "844279",
    "end": "851360"
  },
  {
    "text": "process could access a private container containers of any c party app such as",
    "start": "851360",
    "end": "856759"
  },
  {
    "text": "whatsapps and telegrams the new TCC effectively closes this attack surface",
    "start": "856759",
    "end": "863320"
  },
  {
    "text": "this is a nice security protection and it makes the security of desktop operation system closer to mobile",
    "start": "863320",
    "end": "870360"
  },
  {
    "text": "operation system for example if the executable file is a sh script bsh would execute",
    "start": "870360",
    "end": "878839"
  },
  {
    "text": "this script but it doesn't have access to private container folder of wichat",
    "start": "878839",
    "end": "885079"
  },
  {
    "text": "which would prevent the script from lunching but hold on a question arises",
    "start": "885079",
    "end": "890839"
  },
  {
    "text": "check the picture on the left first if the executable file is a regular file",
    "start": "890839",
    "end": "895920"
  },
  {
    "text": "the h. app is launchable however if the executable file is a symbolic",
    "start": "895920",
    "end": "902000"
  },
  {
    "text": "link as shown in the picture on the right the hollow. app is unlaunchable why the file hello is in",
    "start": "902000",
    "end": "909639"
  },
  {
    "text": "the hell Max private container folder too so why can bsh access it even it is",
    "start": "909639",
    "end": "915920"
  },
  {
    "text": "protected by app data TCC just because micos has an exception",
    "start": "915920",
    "end": "921399"
  },
  {
    "text": "rule for accessing for accessor directories and the door app if a pass",
    "start": "921399",
    "end": "927560"
  },
  {
    "text": "matches this pattern all apps can directly access these contents regardless of whether the directory is",
    "start": "927560",
    "end": "934319"
  },
  {
    "text": "protected by TCC now we cannot use the vulnerability to access files in some sensitive",
    "start": "934319",
    "end": "941800"
  },
  {
    "text": "directories but we can still launch apps from protected directories it seems that",
    "start": "941800",
    "end": "948519"
  },
  {
    "text": "Apple wants to keep the exception for launching apps now we need to find",
    "start": "948519",
    "end": "953680"
  },
  {
    "text": "another way to modify the Quentin flag here comes to comes to Ro three we can",
    "start": "953680",
    "end": "960519"
  },
  {
    "text": "abuse open file Apple events user selected feature is a",
    "start": "960519",
    "end": "966720"
  },
  {
    "text": "crucial feature MOS should ensure that managers applications cannot emulate",
    "start": "966720",
    "end": "972000"
  },
  {
    "text": "click events or trigger the permission granty mechanism without user interaction but if we execute open-",
    "start": "972000",
    "end": "980639"
  },
  {
    "text": "flag.txt open- app app ID H h. txt the operation",
    "start": "980639",
    "end": "986839"
  },
  {
    "text": "will make the specific app open h txt subsequent operations on the input",
    "start": "986839",
    "end": "992880"
  },
  {
    "text": "file will be treated as user approved and will attack the file with a two quarantine flag instead of",
    "start": "992880",
    "end": "1000560"
  },
  {
    "text": "H6 so we only need to execute open- a Microsoft Word executable file and then",
    "start": "1000560",
    "end": "1007800"
  },
  {
    "text": "inject the payout to the executable file this operation CH changes the executable",
    "start": "1007800",
    "end": "1014040"
  },
  {
    "text": "files cting flag directly obviously it has a limited to",
    "start": "1014040",
    "end": "1020160"
  },
  {
    "text": "the exploit opens a new UI so the attack is noticeable to the user which is not",
    "start": "1020160",
    "end": "1027120"
  },
  {
    "text": "ideal for weaponization and if an application has notlimited the open file and open files",
    "start": "1027120",
    "end": "1034678"
  },
  {
    "text": "interfaces this method will not work so is there a more General silent and",
    "start": "1034679",
    "end": "1041480"
  },
  {
    "text": "weaponize approach we can use yes what kind of abuse",
    "start": "1041480",
    "end": "1046839"
  },
  {
    "text": "clipboard we first discuss flow in clipboard on Mac OS the clipboard",
    "start": "1046839",
    "end": "1052120"
  },
  {
    "text": "component on Macos doesn't protect it every process can access the universal",
    "start": "1052120",
    "end": "1057640"
  },
  {
    "text": "clipbot including Sandbox Apps the copy operation on any file will will share",
    "start": "1057640",
    "end": "1064880"
  },
  {
    "text": "the file access with other process therefore if we are a Sandbox",
    "start": "1064880",
    "end": "1070160"
  },
  {
    "text": "stab we can monitor the clipbot and modify the content if the copy D ter is a file here is a demo I will use the M",
    "start": "1070160",
    "end": "1079240"
  },
  {
    "text": "SBX step to steal and modify the copy",
    "start": "1079240",
    "end": "1084000"
  },
  {
    "text": "item the original content is flag just trigger the copy as we can see",
    "start": "1085120",
    "end": "1093600"
  },
  {
    "text": "here the M sendbox app has stolen the flag.txt",
    "start": "1093600",
    "end": "1099480"
  },
  {
    "text": "and the original content has been modified the clipbot not only breaks the",
    "start": "1100799",
    "end": "1107840"
  },
  {
    "text": "sandbox restriction but also allows us to use Mac OS as a stepping stone to compromise iOS device",
    "start": "1107840",
    "end": "1115679"
  },
  {
    "text": "by abusing handle feature we can monitor hijack and modify clipboard data on iOS",
    "start": "1115679",
    "end": "1122080"
  },
  {
    "text": "for example if we want to modify the copied Bitcoin wallet address on iOS do",
    "start": "1122080",
    "end": "1127840"
  },
  {
    "text": "we need a iOS zero day no we just need a Mac OS Z day if a hacker aims to steal",
    "start": "1127840",
    "end": "1135440"
  },
  {
    "text": "data from your iOS device but finds the attack surface too narrow targeting mic",
    "start": "1135440",
    "end": "1140799"
  },
  {
    "text": "OS May provide a better solution therefore if you use both mic OS and iOS",
    "start": "1140799",
    "end": "1147280"
  },
  {
    "text": "and own highly sensitive data it is recommended to disable hands off micros",
    "start": "1147280",
    "end": "1153600"
  },
  {
    "text": "15 introduces a new function iPhone mirror the function sounds risky because",
    "start": "1153600",
    "end": "1160000"
  },
  {
    "text": "take over my Mac could mean take over my iPhone silently the demand for M Zer day",
    "start": "1160000",
    "end": "1165640"
  },
  {
    "text": "exploits may increase in the future and we can abuse the clipboard to",
    "start": "1165640",
    "end": "1171360"
  },
  {
    "text": "achieve SP SPX because the copy operation are mistakenly assumed to have",
    "start": "1171360",
    "end": "1176760"
  },
  {
    "text": "user consent if a file has a curring flag of it of ag6 we only need to copy this file",
    "start": "1176760",
    "end": "1184840"
  },
  {
    "text": "and then modify its content this operation directly changes its cting",
    "start": "1184840",
    "end": "1190120"
  },
  {
    "text": "flag to A2 now I have achieved SPX through ning",
    "start": "1190120",
    "end": "1196240"
  },
  {
    "text": "non box St so let's make a summary traditionally an arbit F",
    "start": "1196240",
    "end": "1202840"
  },
  {
    "text": "creation vulnerability is considered harmless and cannot lead to any exploitable outcome however on Mac OS it",
    "start": "1202840",
    "end": "1211240"
  },
  {
    "text": "is universal sandbox Escape I first discovered the arit food creation",
    "start": "1211240",
    "end": "1216720"
  },
  {
    "text": "vulnerability and spent two weeks figuring out how to how to exploit it so",
    "start": "1216720",
    "end": "1222320"
  },
  {
    "text": "please do not ignore any useless vulnerabilities especially when analyzing a new operation system",
    "start": "1222320",
    "end": "1229840"
  },
  {
    "text": "and I believe the system still contains many apis that allow for unauthorized",
    "start": "1229840",
    "end": "1235200"
  },
  {
    "text": "fotter creation so enjoy good luck for your B hunting gge found the SPX vulnerability",
    "start": "1235200",
    "end": "1242559"
  },
  {
    "text": "to and the answer is yes but we need to do a bit more if we want to achieve a",
    "start": "1242559",
    "end": "1248000"
  },
  {
    "text": "general sbox Escape now I have achieved rce so let's",
    "start": "1248000",
    "end": "1253760"
  },
  {
    "text": "talk about others I want to talk about the AB data",
    "start": "1253760",
    "end": "1259400"
  },
  {
    "text": "TCC because it hinders our previous exploit but before that we first need to",
    "start": "1259400",
    "end": "1266000"
  },
  {
    "text": "understand the crucial permission granty mechanism on Macos it is Mac AB data TCC",
    "start": "1266000",
    "end": "1272480"
  },
  {
    "text": "is based on Mac a so what does the Mach look like for",
    "start": "1272480",
    "end": "1278279"
  },
  {
    "text": "example TT edit doesn't have permission to access flat. txt but if we double",
    "start": "1278279",
    "end": "1284720"
  },
  {
    "text": "click flag.txt in finder Tex edit games access to flag.txt so what happened I",
    "start": "1284720",
    "end": "1292600"
  },
  {
    "text": "believe a permission granty mechanism is at work here imagine that if we as a",
    "start": "1292600",
    "end": "1299240"
  },
  {
    "text": "developer there are two different ways to limit file access one use a database",
    "start": "1299240",
    "end": "1305200"
  },
  {
    "text": "to record who can access a file two Mark the file with some properties the second",
    "start": "1305200",
    "end": "1311240"
  },
  {
    "text": "one is most suitable for for precise control over file access permissions and upon analyze Macos uses",
    "start": "1311240",
    "end": "1319720"
  },
  {
    "text": "the second one the operation system will tag the file with a Mac attribute which",
    "start": "1319720",
    "end": "1325480"
  },
  {
    "text": "contains all authorized process that can access a file here is the first varability and",
    "start": "1325480",
    "end": "1332480"
  },
  {
    "text": "the viability had had existed for years finder uses the default app to",
    "start": "1332480",
    "end": "1339880"
  },
  {
    "text": "open the file based on its uniform type identifier and Mac OS generates a Mac",
    "start": "1339880",
    "end": "1345720"
  },
  {
    "text": "attribute to allow the default app to access the file after this finder",
    "start": "1345720",
    "end": "1351440"
  },
  {
    "text": "informs the app to open the file for example if we execute open- text edit",
    "start": "1351440",
    "end": "1358080"
  },
  {
    "text": "flag.txt we will get an error but if we execute open- finder flat",
    "start": "1358080",
    "end": "1365720"
  },
  {
    "text": "TT text edit can open the file so if we can replace a default file Handler we",
    "start": "1365720",
    "end": "1373000"
  },
  {
    "text": "can trck finder automatically granting our application access to any file when",
    "start": "1373000",
    "end": "1378240"
  },
  {
    "text": "it op the file we can use this method to access the history. DB of safari chat.db",
    "start": "1378240",
    "end": "1384840"
  },
  {
    "text": "of messages except we cannot access a tc. DB the maners app can register items in",
    "start": "1384840",
    "end": "1392600"
  },
  {
    "text": "this way and we can use a swift default apps to change the default F handlers",
    "start": "1392600",
    "end": "1399200"
  },
  {
    "text": "here is a demo we don't have the FDA and I will",
    "start": "1399200",
    "end": "1408000"
  },
  {
    "text": "use the app to access a chat.db of",
    "start": "1408000",
    "end": "1413320"
  },
  {
    "text": "messages success as long as a file is tucked with ma your attribute even if it is",
    "start": "1413400",
    "end": "1421039"
  },
  {
    "text": "protected by TCC a permitted app can still access the file I planning to disclose more but",
    "start": "1421039",
    "end": "1428760"
  },
  {
    "text": "they're under PN so I will disclose them in the future session so in section two it's time to",
    "start": "1428760",
    "end": "1435919"
  },
  {
    "text": "introduce app data TCC when a Sandbox tab launches SE init",
    "start": "1435919",
    "end": "1441880"
  },
  {
    "text": "demon request container manager demon to create a private container folder based on its bundle ID the data folder is the",
    "start": "1441880",
    "end": "1449919"
  },
  {
    "text": "actual private container folder for the app so how does the operation system",
    "start": "1449919",
    "end": "1455240"
  },
  {
    "text": "generates the Mac attribute I will take a dive into Mac a",
    "start": "1455240",
    "end": "1460320"
  },
  {
    "text": "based on Mac OS 14.5 SE init demon register the app",
    "start": "1460320",
    "end": "1465880"
  },
  {
    "text": "container and apply Mac a to to the data folder there are two different roles to",
    "start": "1465880",
    "end": "1472039"
  },
  {
    "text": "generate the ma attributes one trusted process can access its private container",
    "start": "1472039",
    "end": "1477679"
  },
  {
    "text": "folder two apps developed by the same developer can access its private",
    "start": "1477679",
    "end": "1483120"
  },
  {
    "text": "container folder here is a demo for Route One as we can see here we type can",
    "start": "1483120",
    "end": "1489679"
  },
  {
    "text": "access which as private container folder for rout two it will obtain the",
    "start": "1489679",
    "end": "1495320"
  },
  {
    "text": "team ID of the launching sbox stab and the register exceptions that allow all apps and installation packages from the",
    "start": "1495320",
    "end": "1502279"
  },
  {
    "text": "same team to access the folder the sandbox current extension handles the CIS",
    "start": "1502279",
    "end": "1507799"
  },
  {
    "text": "call it has some verifications and it will generate the Mac attribute based on different types",
    "start": "1507799",
    "end": "1515919"
  },
  {
    "text": "here is a demo of type two type three and type four actually this ma this",
    "start": "1515919",
    "end": "1524240"
  },
  {
    "text": "macro generation strategies are essentially similar all involving sh 256",
    "start": "1524240",
    "end": "1529360"
  },
  {
    "text": "has calculations with some differences in the details so now we have know that",
    "start": "1529360",
    "end": "1535640"
  },
  {
    "text": "s ini demon grants lunching Sandbox Apps access to specific folders two Mac can",
    "start": "1535640",
    "end": "1542799"
  },
  {
    "text": "bypass all TCC all file TCC limitations so if we can exploit app data TCC we can",
    "start": "1542799",
    "end": "1551039"
  },
  {
    "text": "access arbitary files with nearly FDA level permissions except we cannot",
    "start": "1551039",
    "end": "1556600"
  },
  {
    "text": "modify T.B so here is the first",
    "start": "1556600",
    "end": "1561640"
  },
  {
    "text": "vulnerability if the data folder is a symbolic link init demon will still",
    "start": "1561640",
    "end": "1567279"
  },
  {
    "text": "update the destination folders ma attribute when the launching apps with the launching apps team",
    "start": "1567279",
    "end": "1573919"
  },
  {
    "text": "ID now if the data folder is a symbolic link container manager will stop the",
    "start": "1573919",
    "end": "1580559"
  },
  {
    "text": "operation here is a second avability the container manager first creates a",
    "start": "1580559",
    "end": "1586760"
  },
  {
    "text": "temporary folder under the lab stag folder after creation it renam the fer",
    "start": "1586760",
    "end": "1592600"
  },
  {
    "text": "to the destination but the library stag fer was not protected by TCC so before renaming",
    "start": "1592600",
    "end": "1600399"
  },
  {
    "text": "we could replace a data fooder with a symbolic link as should as a result the",
    "start": "1600399",
    "end": "1606279"
  },
  {
    "text": "victim fer would be tged with the maler sbox apps ma",
    "start": "1606279",
    "end": "1611440"
  },
  {
    "text": "attribute now the staging folder is protected by TCC the third vulnerability is is a",
    "start": "1611440",
    "end": "1618520"
  },
  {
    "text": "secur patch bypass vulnerability which allows us to bypass a patch for the previous two vulnerabilities Apple patch",
    "start": "1618520",
    "end": "1626120"
  },
  {
    "text": "this viability 10 days ago so now it is a one- day viability the initialization process of",
    "start": "1626120",
    "end": "1633039"
  },
  {
    "text": "the apps sandbox container is very complex involving many high privilege process and Frameworks such as SE inited",
    "start": "1633039",
    "end": "1640919"
  },
  {
    "text": "demon app container F sunbox container manager demand and sunbox Cel extension",
    "start": "1640919",
    "end": "1646919"
  },
  {
    "text": "complicated often means box first SE init demon request container manager",
    "start": "1646919",
    "end": "1653080"
  },
  {
    "text": "demon to create the app container folder after this it will request sbox kernel",
    "start": "1653080",
    "end": "1659000"
  },
  {
    "text": "extension to update the Mac attribute of the data folder and there is a timing",
    "start": "1659000",
    "end": "1665080"
  },
  {
    "text": "window between the unprotect and protected status we can exploit it we",
    "start": "1665080",
    "end": "1671360"
  },
  {
    "text": "can just monitor the data folder creation monitor the data folder",
    "start": "1671360",
    "end": "1676559"
  },
  {
    "text": "creation if found replace it with a symbolic link but at this time container",
    "start": "1676559",
    "end": "1683039"
  },
  {
    "text": "manager demand prevents the launch of the man manager sandbox St due to the PCH but SE init demon still request",
    "start": "1683039",
    "end": "1691679"
  },
  {
    "text": "sandbox kernel extension to update the data fers ma attribute as a result the",
    "start": "1691679",
    "end": "1697600"
  },
  {
    "text": "folder pointed to by the symbolic link has been assigned the ma attribute So",
    "start": "1697600",
    "end": "1703880"
  },
  {
    "text": "currently we cannot continue the exploit because of the PCH will prevent the app",
    "start": "1703880",
    "end": "1709399"
  },
  {
    "text": "from luning however a crucial detail is that the victim folder has been tucked",
    "start": "1709399",
    "end": "1715279"
  },
  {
    "text": "with the managers ma attribute so then we need to replace a symbolic link with",
    "start": "1715279",
    "end": "1722000"
  },
  {
    "text": "a normal dater folder so that the next time we launch the manager SBX stab",
    "start": "1722000",
    "end": "1727320"
  },
  {
    "text": "container manager demon won't block it after this the manager SBX step launch",
    "start": "1727320",
    "end": "1733320"
  },
  {
    "text": "but we will find that it cannot access the food victim fooder due to the Sun box restrictions if a if a Sandbox app",
    "start": "1733320",
    "end": "1741760"
  },
  {
    "text": "wants to access some resources sandbox kernel extension will first check is",
    "start": "1741760",
    "end": "1746880"
  },
  {
    "text": "sandbox restrictions if allowed TCC demon will check if the pro process has",
    "start": "1746880",
    "end": "1752840"
  },
  {
    "text": "access to the protected further therefore when we compile the app we",
    "start": "1752840",
    "end": "1757960"
  },
  {
    "text": "need to register the sbpl to break the sandbox restrictions here is a demo",
    "start": "1757960",
    "end": "1767120"
  },
  {
    "text": "we cannot access a library Safar folder now",
    "start": "1770399",
    "end": "1776840"
  },
  {
    "text": "exploit failed sleep 10 seconds and try",
    "start": "1777799",
    "end": "1782919"
  },
  {
    "text": "again success as we can see here we can access access the library saire folder now now",
    "start": "1793480",
    "end": "1801320"
  },
  {
    "text": "there are three relevant vulnerabilities two of them has been ped and the rest one is under Pion so I may disclose them",
    "start": "1801320",
    "end": "1809000"
  },
  {
    "text": "later in MOS 15 the group containers of the party apps are protected by appd",
    "start": "1809000",
    "end": "1815640"
  },
  {
    "text": "tcct Additionally the library group container folder is not writable a question have you identified",
    "start": "1815640",
    "end": "1824200"
  },
  {
    "text": "an attack service in app data TCC the purpose of app data TCC is to",
    "start": "1824200",
    "end": "1831519"
  },
  {
    "text": "protect the data of third party apps logically this approach is sound because",
    "start": "1831519",
    "end": "1837480"
  },
  {
    "text": "it has an allow list to limit access only trusted applications can access a",
    "start": "1837480",
    "end": "1842760"
  },
  {
    "text": "protected container folder but it doesn't provide developers with an",
    "start": "1842760",
    "end": "1847880"
  },
  {
    "text": "option to create a blog list from assistant design perspective",
    "start": "1847880",
    "end": "1853600"
  },
  {
    "text": "the purpose of an allow list is different from that of a block list",
    "start": "1853600",
    "end": "1858639"
  },
  {
    "text": "if you only have an allow list without a block list what happens if the if a",
    "start": "1858639",
    "end": "1864240"
  },
  {
    "text": "trusted app is no longer trusted what happens if any trusted application has",
    "start": "1864240",
    "end": "1870919"
  },
  {
    "text": "an end vulnerability the attacker can download the old version achieve LP and",
    "start": "1870919",
    "end": "1876600"
  },
  {
    "text": "then access access access the sensitive files of the latest app a vulnerability",
    "start": "1876600",
    "end": "1882600"
  },
  {
    "text": "that only affected specific versions has turned it into a persistent issue that",
    "start": "1882600",
    "end": "1888039"
  },
  {
    "text": "developers cannot fix the developer can configure the allow list to limit who can access the",
    "start": "1888039",
    "end": "1894559"
  },
  {
    "text": "folder but it it cannot block this exploit because whatever the",
    "start": "1894559",
    "end": "1901120"
  },
  {
    "text": "configuration is the Sandbox app itself can still access the private container",
    "start": "1901120",
    "end": "1906559"
  },
  {
    "text": "folder even if the allow list works it only compares the team might in the",
    "start": "1906559",
    "end": "1912240"
  },
  {
    "text": "allow list the vulnerable old version of the sandbox step has a valid team",
    "start": "1912240",
    "end": "1918399"
  },
  {
    "text": "so you cannot block this uh block its launch so to Red teams we can connect",
    "start": "1918399",
    "end": "1924880"
  },
  {
    "text": "this vulnerable old version apps and to Apple there are two suggestions one",
    "start": "1924880",
    "end": "1931960"
  },
  {
    "text": "create a block list two if the current running app version is lower than the",
    "start": "1931960",
    "end": "1937279"
  },
  {
    "text": "version that was last wrong prompt the user prompt the user with an alert",
    "start": "1937279",
    "end": "1944159"
  },
  {
    "text": "actually TCC demon has a similar attack service Apple has introduced several",
    "start": "1944159",
    "end": "1949760"
  },
  {
    "text": "security mechanisms but this mechanism currently Focus mainly on the security",
    "start": "1949760",
    "end": "1956000"
  },
  {
    "text": "of Apple apps and don't yet cover third party apps now I have achieved rce and I can R",
    "start": "1956000",
    "end": "1964639"
  },
  {
    "text": "right arbitary files so I should talk about the root LP General T bypass sip",
    "start": "1964639",
    "end": "1971559"
  },
  {
    "text": "bypass here is a demo of General TCC bypass on the latest Macos 15.0",
    "start": "1971559",
    "end": "1979720"
  },
  {
    "text": "we don't have the FDA and the camera T",
    "start": "1984399",
    "end": "1990399"
  },
  {
    "text": "now",
    "start": "1991880",
    "end": "1994880"
  },
  {
    "text": "exploit the original T.B has been modified just take a",
    "start": "1997559",
    "end": "2004760"
  },
  {
    "text": "picture success and check the access",
    "start": "2004840",
    "end": "2010600"
  },
  {
    "text": "again terminal has the camera TCC now I planning to disclose some relevant",
    "start": "2015639",
    "end": "2021880"
  },
  {
    "text": "vulnerabilities but they're under Pion so I will disclose them in the future",
    "start": "2021880",
    "end": "2027240"
  },
  {
    "text": "session okay now flanker will make a summary and share some experance on",
    "start": "2027240",
    "end": "2032519"
  },
  {
    "text": "other operation systems I will give a brief summary and",
    "start": "2032519",
    "end": "2038919"
  },
  {
    "text": "the ideas of Defense uh from a blue team's perspective that how to detect or",
    "start": "2038919",
    "end": "2044480"
  },
  {
    "text": "prevent this kind of attacks and uh first you can see that your previous exploit use lots of uh stive senstive",
    "start": "2044480",
    "end": "2052599"
  },
  {
    "text": "apis such as the uh the arguments that contains uh directory traversal the dot",
    "start": "2052599",
    "end": "2060280"
  },
  {
    "text": "dot for the container U for Security application group identifier and you can",
    "start": "2060280",
    "end": "2066040"
  },
  {
    "text": "modify uh you can monitor the this API usage however due to the limitations of",
    "start": "2066040",
    "end": "2071118"
  },
  {
    "text": "the IP you cannot uh do this detection on your employees end points and you",
    "start": "2071119",
    "end": "2077240"
  },
  {
    "text": "have to like do it in your sandbox in your modified environment for example you have a dynamic sandbox in your",
    "start": "2077240",
    "end": "2083679"
  },
  {
    "text": "corporation M Gateway and you can use it to detect if there is a malicious attachment that tries to exploit this",
    "start": "2083679",
    "end": "2090800"
  },
  {
    "text": "vulnerability and uh for the edrs and the TOs based on the endpoint security framework you can monitor symbol link to",
    "start": "2090800",
    "end": "2098200"
  },
  {
    "text": "sensitive locations so the takeway for this talk",
    "start": "2098200",
    "end": "2104119"
  },
  {
    "text": "that we found an that orbitary folder Recreation vulnerability on micos is",
    "start": "2104119",
    "end": "2110119"
  },
  {
    "text": "actually equivalent to finding a Sandbox Escape vulnerability and the ma attribute uh feature the security",
    "start": "2110119",
    "end": "2117320"
  },
  {
    "text": "feature in the micros and and this usage and this vulnerabilities and the newly",
    "start": "2117320",
    "end": "2123079"
  },
  {
    "text": "introduced the security features update TCC and everything you want to you need to know about it and how we exploit it",
    "start": "2123079",
    "end": "2130440"
  },
  {
    "text": "and uh finally that we found that we can actually abuse abuse and vulnerabilities",
    "start": "2130440",
    "end": "2136720"
  },
  {
    "text": "in outdated version of third party applications to bypass the TCC also during our research I comp we",
    "start": "2136720",
    "end": "2144560"
  },
  {
    "text": "compared the Apple's operating system with other operating system such as Android and the F new operating",
    "start": "2144560",
    "end": "2151319"
  },
  {
    "text": "operating system the Harmony osness and the Privacy protection and the sand books mechanism actually Android use uh",
    "start": "2151319",
    "end": "2158560"
  },
  {
    "text": "two approaches for the sandbox the MSA approach based Onex and the DSA approach",
    "start": "2158560",
    "end": "2164240"
  },
  {
    "text": "based on the user ID go ID isolation just like traditional Linux and the",
    "start": "2164240",
    "end": "2169680"
  },
  {
    "text": "Android application access to to privacy and incentive information is enforced by",
    "start": "2169680",
    "end": "2175680"
  },
  {
    "text": "an XML based permission and a signature that application need to declare the",
    "start": "2175680",
    "end": "2182160"
  },
  {
    "text": "access in the Android manifest and they have to uh get the users consent and the",
    "start": "2182160",
    "end": "2187800"
  },
  {
    "text": "sandbox processes especially the uh Chrome renderers sandbox process it",
    "start": "2187800",
    "end": "2193040"
  },
  {
    "text": "runes in isolated context and has a very limited access to resources such as",
    "start": "2193040",
    "end": "2198119"
  },
  {
    "text": "driver service disc cost and uh for attackers if you want to escape like the",
    "start": "2198119",
    "end": "2203560"
  },
  {
    "text": "Chrome sandbox the iso sandbox you have to attack the BND driver and some",
    "start": "2203560",
    "end": "2208720"
  },
  {
    "text": "limited C CIS C or you can attack the application relevant ipcs for example",
    "start": "2208720",
    "end": "2215000"
  },
  {
    "text": "the Chrome ipcs from the host process to the render process or vice",
    "start": "2215000",
    "end": "2221960"
  },
  {
    "text": "versa so finally uh there's the new operating system by hway The harmonyos",
    "start": "2221960",
    "end": "2227240"
  },
  {
    "text": "Nest is actually a new operating system that is totally not Android or n it have",
    "start": "2227240",
    "end": "2233240"
  },
  {
    "text": "some new Concepts for privacy protection and the sandbox like the a the ability",
    "start": "2233240",
    "end": "2239560"
  },
  {
    "text": "PIV level in this operating system uh the applications and permissions have",
    "start": "2239560",
    "end": "2245160"
  },
  {
    "text": "three categories for their AP the normal system basic and system core and",
    "start": "2245160",
    "end": "2250839"
  },
  {
    "text": "permissions can be granted in two ways the user Grant and system Grant the user",
    "start": "2250839",
    "end": "2256000"
  },
  {
    "text": "Grant means that this permission need to promote for users consent and the system",
    "start": "2256000",
    "end": "2261280"
  },
  {
    "text": "Grant means that this is a non stive permissions and it can be automatically granted if a loss and the permission the",
    "start": "2261280",
    "end": "2269920"
  },
  {
    "text": "requirements the permission requirement is that uh the application cannot apply",
    "start": "2269920",
    "end": "2275599"
  },
  {
    "text": "for permission that has higher APR levels and uh this can be dynamically",
    "start": "2275599",
    "end": "2281800"
  },
  {
    "text": "overridden by ACR if the permission has a declaration or attributes of ACR",
    "start": "2281800",
    "end": "2287800"
  },
  {
    "text": "enable is true but this requires a certain certificate and signing from the",
    "start": "2287800",
    "end": "2293560"
  },
  {
    "text": "hua's app uh app store for example for the factory reset and the capture screen",
    "start": "2293560",
    "end": "2299839"
  },
  {
    "text": "this kind of very sensitive permissions so this is our comparation",
    "start": "2299839",
    "end": "2305119"
  },
  {
    "text": "with the other familiar and the popular operating systems on this uh TC like",
    "start": "2305119",
    "end": "2312040"
  },
  {
    "text": "mechanism and sandbox mechanism and we hope that it could help the researchers to get similar insights in it so I think",
    "start": "2312040",
    "end": "2320319"
  },
  {
    "text": "that's our talk and thank you for coming and uh I think we can get come to the QA",
    "start": "2320319",
    "end": "2326440"
  },
  {
    "text": "session [Applause]",
    "start": "2326440",
    "end": "2333639"
  }
]