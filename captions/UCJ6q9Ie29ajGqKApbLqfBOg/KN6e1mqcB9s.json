[
  {
    "start": "0",
    "end": "116000"
  },
  {
    "text": "my name is dr. John Griffin and it is my great pleasure to introduce you to the session today on preventing",
    "start": "30",
    "end": "5960"
  },
  {
    "text": "authentication bypass a tale of two researchers that will be presented by three researchers Ravi jaiswal teri Jong",
    "start": "5960",
    "end": "14250"
  },
  {
    "text": "and Bron Chan please help me in welcoming these gentlemen to the stage",
    "start": "14250",
    "end": "19759"
  },
  {
    "text": "good afternoon everyone today we are here to tell you a story a story of",
    "start": "34130",
    "end": "41040"
  },
  {
    "text": "collaboration between two researchers and Microsoft on how they found a",
    "start": "41040",
    "end": "46680"
  },
  {
    "text": "critical vulnerability in Outlook Web App and this is also a story about close",
    "start": "46680",
    "end": "52649"
  },
  {
    "text": "and collaboration which spanned continents to help protect the customers",
    "start": "52649",
    "end": "59579"
  },
  {
    "text": "and the data so in this story we have following characters first we have Teddy",
    "start": "59579",
    "end": "67380"
  },
  {
    "text": "Zhang who is co-founder of the fan and specialists in breaking identity who was",
    "start": "67380",
    "end": "73650"
  },
  {
    "text": "working independently of Ron Chan an independent security researcher who was",
    "start": "73650",
    "end": "81409"
  },
  {
    "text": "concurrently with Terry investigating an issue in Outlook Web App as you all know",
    "start": "81409",
    "end": "88710"
  },
  {
    "text": "Outlook Web App or OVA is a mail service created by Microsoft and it has millions",
    "start": "88710",
    "end": "95340"
  },
  {
    "text": "of users all over the world I am Ravi Jaiswal an engineering manager in",
    "start": "95340",
    "end": "101820"
  },
  {
    "text": "Outlook Web App and with primary focus on authentication and security so this",
    "start": "101820",
    "end": "110310"
  },
  {
    "text": "story starts with a discovery and to talk more about it here is study Thank",
    "start": "110310",
    "end": "118259"
  },
  {
    "start": "116000",
    "end": "443000"
  },
  {
    "text": "You Ravi and good afternoon everyone I'm Terry and I'm so glad to be here to",
    "start": "118259",
    "end": "124020"
  },
  {
    "text": "heckle one stage to share some ideas about how I found this critical issue on",
    "start": "124020",
    "end": "129479"
  },
  {
    "text": "Microsoft specific long outlook service and also about how ask like these issues step-by-step to",
    "start": "129479",
    "end": "136080"
  },
  {
    "text": "make it even more critical so okay let's get it so the so the first discovery was",
    "start": "136080",
    "end": "144090"
  },
  {
    "text": "sometime before March 24th this year and",
    "start": "144090",
    "end": "149210"
  },
  {
    "text": "one thing I found there is a new option a new switch on Outlook Enterprise Service that support like user to switch",
    "start": "149210",
    "end": "156600"
  },
  {
    "text": "to the new UI so after I switched to the new UI I used perhaps ooh to intercept",
    "start": "156600",
    "end": "162330"
  },
  {
    "text": "the request and I found there's a new option and it's re new API endpoint that",
    "start": "162330",
    "end": "167760"
  },
  {
    "text": "I'd never seen before and it had a action called get access token for",
    "start": "167760",
    "end": "173970"
  },
  {
    "text": "resource that sounds pretty interesting in my doing some kind of token exchange",
    "start": "173970",
    "end": "179310"
  },
  {
    "text": "or session exchange work and it turns out indeed this endpoint will return a JSON web token that is unsigned so we",
    "start": "179310",
    "end": "188820"
  },
  {
    "text": "can see in this screenshot that the algorithm part is none and we got a lot",
    "start": "188820",
    "end": "193860"
  },
  {
    "text": "of information a lot of data in the payload part which we will get to it and a few slides later and later I found",
    "start": "193860",
    "end": "201480"
  },
  {
    "text": "this token was only used by the application itself to assess some kind",
    "start": "201480",
    "end": "207510"
  },
  {
    "text": "of internal preview api's like product tips like what's new like status check",
    "start": "207510",
    "end": "214920"
  },
  {
    "text": "some kind of you know will return some kind of useless data so but I just have",
    "start": "214920",
    "end": "220560"
  },
  {
    "text": "this feeling that I think this token can do much more than these so I I note it down and move forward and then I came",
    "start": "220560",
    "end": "228060"
  },
  {
    "text": "across this restful official restful api on Outlook and normally to use these",
    "start": "228060",
    "end": "234350"
  },
  {
    "text": "restful api a third party client or applications need to be registered on a",
    "start": "234350",
    "end": "240570"
  },
  {
    "text": "third cloud and then that user go through an oid c flow or an ID connect",
    "start": "240570",
    "end": "245760"
  },
  {
    "text": "flow to get users authorization to grant it for some certain permissions from on",
    "start": "245760",
    "end": "253290"
  },
  {
    "text": "this application so that this application can retrieve a JSON web token and that token is definitely",
    "start": "253290",
    "end": "260579"
  },
  {
    "text": "signed so those two screenshots one is the unsigned token from the internal API",
    "start": "260580",
    "end": "266950"
  },
  {
    "text": "and one is the sign token we got from the OID C flow so and also those tokens",
    "start": "266950",
    "end": "274900"
  },
  {
    "text": "just in totally different data structure so it's kind of irrelevant at the first",
    "start": "274900",
    "end": "280720"
  },
  {
    "text": "time totally irrelevant but why not give a try so I just place these set these",
    "start": "280720",
    "end": "288940"
  },
  {
    "text": "unsigned token to the authorization header and the standard request to one",
    "start": "288940",
    "end": "294040"
  },
  {
    "text": "of the basic restful api and then suddenly the reach the server side just",
    "start": "294040",
    "end": "300310"
  },
  {
    "text": "to return that user's profile back so that means that the outlook server side",
    "start": "300310",
    "end": "305380"
  },
  {
    "text": "was happy to consume our unsigned token and return that user's profile back so",
    "start": "305380",
    "end": "310830"
  },
  {
    "text": "this is awesome like I just have this feeling or",
    "start": "310830",
    "end": "316150"
  },
  {
    "text": "confidence like I can't find something from it so before we move on let's take",
    "start": "316150",
    "end": "323440"
  },
  {
    "text": "a take a look at some key details of the token and there there is a why D which",
    "start": "323440",
    "end": "331600"
  },
  {
    "text": "referred to country users UID where user ID and there's a SMTP which refer to con",
    "start": "331600",
    "end": "338470"
  },
  {
    "text": "users email address and there's a scoop which refer to current permissions cook",
    "start": "338470",
    "end": "343750"
  },
  {
    "text": "that grant and for this token as we can see there's a who assess as exchange",
    "start": "343750",
    "end": "349000"
  },
  {
    "text": "which means that this token got food permissions granted and there's another actor token that is",
    "start": "349000",
    "end": "356130"
  },
  {
    "text": "that is another JSON web token and this token is sign and this token is contains",
    "start": "356130",
    "end": "364210"
  },
  {
    "text": "current tenant infer continent ID so there's another tid which refer to the",
    "start": "364210",
    "end": "369430"
  },
  {
    "text": "tenant ID either so we got some key details of the token so the very first",
    "start": "369430",
    "end": "374860"
  },
  {
    "text": "thing I've tried is to change the OID to another users that under the same tenant",
    "start": "374860",
    "end": "381670"
  },
  {
    "text": "so that users profile just returned right back so that means I found the",
    "start": "381670",
    "end": "389650"
  },
  {
    "text": "authentication bypass on outlook enterprise service that can you know I",
    "start": "389650",
    "end": "394810"
  },
  {
    "text": "can fully control any other users account that under the same tenant",
    "start": "394810",
    "end": "400660"
  },
  {
    "text": "yeah because I can do whatever I want basically I can do whatever I want like just as far as the RESTful API supports",
    "start": "400660",
    "end": "408430"
  },
  {
    "text": "which the rest of API is pretty powerful so but there is a limitation in in this",
    "start": "408430",
    "end": "416230"
  },
  {
    "text": "case that as I mentioned before there was actor token which is signed and",
    "start": "416230",
    "end": "422290"
  },
  {
    "text": "contained current tenant ID so we can change that we can modify that because",
    "start": "422290",
    "end": "427390"
  },
  {
    "text": "it is signed so we can only exploit this issue under the same tenant for",
    "start": "427390",
    "end": "433240"
  },
  {
    "text": "enterprise and then I remind consumer",
    "start": "433240",
    "end": "438400"
  },
  {
    "text": "outlook so what about consumer outlook so basically consumer outlook service in",
    "start": "438400",
    "end": "446380"
  },
  {
    "text": "the same as and price just running on different domain like for enterprise is",
    "start": "446380",
    "end": "451510"
  },
  {
    "text": "running on outlook to office calm and for personnel running on Outlook to live",
    "start": "451510",
    "end": "456880"
  },
  {
    "text": "talking or mail to live calm and both services support these special endpoint",
    "start": "456880",
    "end": "463090"
  },
  {
    "text": "get assessed open for resource and also there is interesting thing that I've learned from consumer outlook service in",
    "start": "463090",
    "end": "470080"
  },
  {
    "text": "that after I comparing to JSON web token unsigned the JSON web token that is from",
    "start": "470080",
    "end": "476530"
  },
  {
    "text": "two of my test personal test accounts and I've learned that all personal",
    "start": "476530",
    "end": "481560"
  },
  {
    "text": "Outlook account share the same tint ID so that means no matter you use live",
    "start": "481560",
    "end": "487270"
  },
  {
    "text": "ComNet or like Outlook calm or hotmail calm your accounts are under the same",
    "start": "487270",
    "end": "492970"
  },
  {
    "text": "tenant so that's wonderful because in this case we can modify the tenant ID",
    "start": "492970",
    "end": "498280"
  },
  {
    "text": "and now we don't have to because all that personal Kansa use the same tenant",
    "start": "498280",
    "end": "503820"
  },
  {
    "text": "so quickly I change the OID to another personal accounts and that users profile",
    "start": "503820",
    "end": "510460"
  },
  {
    "text": "just returned back and then there's still a little issue need to be cleared",
    "start": "510460",
    "end": "515860"
  },
  {
    "text": "out like like I can't find a way I can find an easy way to get any other users",
    "start": "515860",
    "end": "522039"
  },
  {
    "text": "or ID like it is in UUID format and it is kind of impossible to enumerate or to",
    "start": "522039",
    "end": "528850"
  },
  {
    "text": "brute force but like I need to know any others oh I",
    "start": "528850",
    "end": "534310"
  },
  {
    "text": "so I started to play around with these token and again again finally I managed",
    "start": "534310",
    "end": "541990"
  },
  {
    "text": "to find a way to only use any other users email address just email address",
    "start": "541990",
    "end": "547660"
  },
  {
    "text": "no user ID and no daddy no user ID to exploit this issue that can affect on",
    "start": "547660",
    "end": "552939"
  },
  {
    "text": "any other you know personal accounts so I made a demo video for this so that it",
    "start": "552939",
    "end": "558399"
  },
  {
    "text": "can demonstrate the critical impact so",
    "start": "558399",
    "end": "565059"
  },
  {
    "text": "we've found the same end point on outlook consumer outlook service get access token for resource and then we",
    "start": "565059",
    "end": "571870"
  },
  {
    "text": "got a return JSON web token that unsigned and then let's take a look at",
    "start": "571870",
    "end": "578439"
  },
  {
    "text": "this token we can see the algorithm parties none and we got a lot of information and the tid down here will",
    "start": "578439",
    "end": "586870"
  },
  {
    "text": "always be this value between different personnel accounts so there we place",
    "start": "586870",
    "end": "592149"
  },
  {
    "text": "these token to the authorization header",
    "start": "592149",
    "end": "597399"
  },
  {
    "text": "in the send to one of the basic API endpoint official official API endpoint and that user's profile just returned",
    "start": "597399",
    "end": "604029"
  },
  {
    "text": "back and then we do some modification we change the OID to no and we change the",
    "start": "604029",
    "end": "610899"
  },
  {
    "text": "PID to empty string and the same with the CID or to empty string and then",
    "start": "610899",
    "end": "617110"
  },
  {
    "text": "somehow magic happen now the server-side will only use the SMTP value that which",
    "start": "617110",
    "end": "623529"
  },
  {
    "text": "is the user's identity which in the users email address as users identity to",
    "start": "623529",
    "end": "628899"
  },
  {
    "text": "return that users data back so that's that is make this issue just more",
    "start": "628899",
    "end": "634930"
  },
  {
    "text": "straight and you know no requirement and a no user interaction at all so we can",
    "start": "634930",
    "end": "641290"
  },
  {
    "text": "see we are not just to only get their profile back we can just read their email content and we can do a lot more",
    "start": "641290",
    "end": "647079"
  },
  {
    "text": "just you know a lot of all the things that the official API supports we can do",
    "start": "647079",
    "end": "653379"
  },
  {
    "text": "it on behalf of that targeted user so in this video I'll just also demonstrate",
    "start": "653379",
    "end": "658420"
  },
  {
    "text": "like how can how I can you know read or write on behalf of you so just use your",
    "start": "658420",
    "end": "665709"
  },
  {
    "text": "email address no other requirement and this will show like I can send email",
    "start": "665709",
    "end": "673930"
  },
  {
    "text": "on your behalf without you know I'll discover you okay I think so far this",
    "start": "673930",
    "end": "682000"
  },
  {
    "text": "demo video has already made made a good point for its critical impact so I'll just move on okay so this is the final",
    "start": "682000",
    "end": "691720"
  },
  {
    "start": "690000",
    "end": "750000"
  },
  {
    "text": "result like first I found an authentication bypass on outlook enterprise service and to make even more",
    "start": "691720",
    "end": "698800"
  },
  {
    "text": "critical I finally asked late this issue from Enterprise within the same teen and - - that can affect all personnel",
    "start": "698800",
    "end": "707170"
  },
  {
    "text": "Outlook accounts no matter you use live comm hotmail calm or outlook calm and",
    "start": "707170",
    "end": "713160"
  },
  {
    "text": "finally I managed to find a way that only use the email address no other",
    "start": "713160",
    "end": "718780"
  },
  {
    "text": "requirements and no user interaction at all so after that I quickly wrote a report and send to M SRC and then I just",
    "start": "718780",
    "end": "725590"
  },
  {
    "text": "lay back and started to imagine my bounty ring because I'm pretty sure this is a critical issue so and it turns out",
    "start": "725590",
    "end": "733480"
  },
  {
    "text": "that I'm not the only one who found it so I passed - wrong - a for his second discovery thank you Thank You Terry",
    "start": "733480",
    "end": "748560"
  },
  {
    "text": "I'm Ron Chen I'm currently working as a security analyst in entity and this",
    "start": "748560",
    "end": "757060"
  },
  {
    "start": "750000",
    "end": "1227000"
  },
  {
    "text": "story starts a few months ago back in April this year I saw every tweet from",
    "start": "757060",
    "end": "764320"
  },
  {
    "text": "Microsoft Security Response Twitter it said hey we have better bounties now we",
    "start": "764320",
    "end": "770740"
  },
  {
    "text": "have quick advantage now and we now pay through hacker one as I'm familiar with",
    "start": "770740",
    "end": "776380"
  },
  {
    "text": "Hector one platform so I thought to myself why not take a look so I did what most part",
    "start": "776380",
    "end": "785380"
  },
  {
    "text": "hunters with the a used web suite to have a look at the Outlook Web and I",
    "start": "785380",
    "end": "792040"
  },
  {
    "text": "tried many things I try to look for XSS sequel injection CSRF and most of them",
    "start": "792040",
    "end": "800830"
  },
  {
    "text": "are gone thank I cannot find anything until I got",
    "start": "800830",
    "end": "805990"
  },
  {
    "text": "lucky by seeing this two highlighted requests these two requests highlighted",
    "start": "805990",
    "end": "814960"
  },
  {
    "text": "because I got I previously installed a plug-in called JSON web token attacker",
    "start": "814960",
    "end": "822490"
  },
  {
    "text": "plug-in and what it does is it will automatically highlight anything that",
    "start": "822490",
    "end": "828880"
  },
  {
    "text": "has a jadibooti header in the request so this time I got lucky by noticing them",
    "start": "828880",
    "end": "837190"
  },
  {
    "text": "these two because are highlighted because they got jadibooti header in the request and the reason I",
    "start": "837190",
    "end": "844530"
  },
  {
    "text": "chose to install this plug-in is that whenever we see a JWT",
    "start": "844530",
    "end": "851560"
  },
  {
    "text": "header we have to look for its signature and algorithm if the algorithm is none",
    "start": "851560",
    "end": "858310"
  },
  {
    "text": "then it means that we can do something with this JWT token and impersonate",
    "start": "858310",
    "end": "865210"
  },
  {
    "text": "other user depending on the scenario so let's have a look at this jadibooti",
    "start": "865210",
    "end": "871480"
  },
  {
    "text": "token that our look was using at that moment at the first sight it seems that",
    "start": "871480",
    "end": "878980"
  },
  {
    "text": "this is just another jadibooti sending a request to an API endpoint that has no",
    "start": "878980",
    "end": "886540"
  },
  {
    "text": "use to me it seems that this is just searching for something and I don't know",
    "start": "886540",
    "end": "893020"
  },
  {
    "text": "what it does to be honest but then I use that plug-in to took a closer look to",
    "start": "893020",
    "end": "900160"
  },
  {
    "text": "the JWT header payload and the signature part and this is the first screen shot",
    "start": "900160",
    "end": "909130"
  },
  {
    "text": "of the JWT in this screenshot I used the",
    "start": "909130",
    "end": "914200"
  },
  {
    "text": "JSON web token attacker in this for this attack and if you have paid attention",
    "start": "914200",
    "end": "921840"
  },
  {
    "text": "for three slides you should notice that for this slide for this screenshot that I'm having now",
    "start": "921840",
    "end": "928750"
  },
  {
    "text": "the algorithm is rs.25 six but in Paris screenshot is",
    "start": "928750",
    "end": "935230"
  },
  {
    "text": "that algorithm is none it is because at",
    "start": "935230",
    "end": "940330"
  },
  {
    "text": "the moment of the discovery I forgot to take a screenshot so I took this fuchsia",
    "start": "940330",
    "end": "947700"
  },
  {
    "text": "after I know that I have to prepare for this talk so this is why the screenshot",
    "start": "947700",
    "end": "953410"
  },
  {
    "text": "is like this and but just imagine the algorithm here should be none okay so",
    "start": "953410",
    "end": "960780"
  },
  {
    "text": "this is the next payload the payload of this JWT is nothing special again but",
    "start": "960780",
    "end": "968980"
  },
  {
    "text": "something special about this is that it got mail we write permission so this is",
    "start": "968980",
    "end": "975820"
  },
  {
    "text": "very powerful JWT and finally we can see that in the",
    "start": "975820",
    "end": "981910"
  },
  {
    "text": "basic civil signature part of this JWT it has nothing it means that this JWT",
    "start": "981910",
    "end": "989500"
  },
  {
    "text": "is unsigned and I quickly thought to",
    "start": "989500",
    "end": "996460"
  },
  {
    "text": "myself here's what I am going to do first I need to figure out what",
    "start": "996460",
    "end": "1002100"
  },
  {
    "text": "parameter that the API uses to identify Ron is wrong in this JWT token and then",
    "start": "1002100",
    "end": "1010500"
  },
  {
    "text": "I will change that parameter to impersonate other users and finally",
    "start": "1010500",
    "end": "1016440"
  },
  {
    "text": "after changing the parameter I will apply this JWT token to as many",
    "start": "1016440",
    "end": "1023390"
  },
  {
    "text": "endpoints as possible to see what can I do with this JWT token and I tried many",
    "start": "1023390",
    "end": "1032069"
  },
  {
    "text": "stuff and only one parameter works it is the OID parameter but how do we get a",
    "start": "1032070",
    "end": "1041400"
  },
  {
    "text": "why D of other users since as you can see in this screenshot it is highlighted",
    "start": "1041400",
    "end": "1048300"
  },
  {
    "text": "in red it is a long teacher UUID that no one can prove us and you cannot",
    "start": "1048300",
    "end": "1055530"
  },
  {
    "text": "enumerate that so naturally as a hunter",
    "start": "1055530",
    "end": "1060690"
  },
  {
    "text": "we have to read a lot of documentation so I consulted the API documentation",
    "start": "1060690",
    "end": "1067910"
  },
  {
    "text": "from soft and see hey is that a way for me to",
    "start": "1067910",
    "end": "1073860"
  },
  {
    "text": "retrieve all ID of other people and then it turns out there is a exact endpoint",
    "start": "1073860",
    "end": "1082500"
  },
  {
    "text": "that you can cure and then it will return there oh ID to you without any",
    "start": "1082500",
    "end": "1089460"
  },
  {
    "text": "user interaction so it means that now with this JWT I can get other people's",
    "start": "1089460",
    "end": "1097560"
  },
  {
    "text": "body without their interaction so my next plan is to substitute their body",
    "start": "1097560",
    "end": "1104600"
  },
  {
    "text": "into my JWT token and then the final",
    "start": "1104600",
    "end": "1110640"
  },
  {
    "text": "step is using this updated JWT token to",
    "start": "1110640",
    "end": "1116330"
  },
  {
    "text": "curate the mail reading API endpoints and see if I can read their email and of",
    "start": "1116330",
    "end": "1125010"
  },
  {
    "text": "course I did I can read anyone's email",
    "start": "1125010",
    "end": "1131910"
  },
  {
    "text": "using this technique as long as they are inside the same tenant it means that if",
    "start": "1131910",
    "end": "1137340"
  },
  {
    "text": "you guys are inside the same organization then you can use this to",
    "start": "1137340",
    "end": "1143700"
  },
  {
    "text": "with anyone that works for this company as well to conclude first I saw a retweet from",
    "start": "1143700",
    "end": "1153660"
  },
  {
    "text": "Microsoft and then I took a look at Outlook and then I discovered that I can",
    "start": "1153660",
    "end": "1160350"
  },
  {
    "text": "get an unsigned JWT and then I can use the same Jade ability to get another",
    "start": "1160350",
    "end": "1166980"
  },
  {
    "text": "person's body and then I will replace that person's body in my JWT that I got",
    "start": "1166980",
    "end": "1176130"
  },
  {
    "text": "from Microsoft's and then at this point I'm impersonating that person so now the",
    "start": "1176130",
    "end": "1183630"
  },
  {
    "text": "final step is I will send it to the mail surface and then I can read and write on",
    "start": "1183630",
    "end": "1193800"
  },
  {
    "text": "behalf of any user using this technique if they are in the same organization at",
    "start": "1193800",
    "end": "1199980"
  },
  {
    "text": "this point I stopped every testing because I think this is cute enough for",
    "start": "1199980",
    "end": "1205740"
  },
  {
    "text": "the impact so I contacted Microsoft security and then here's the end and now",
    "start": "1205740",
    "end": "1216299"
  },
  {
    "text": "I would pass through Rafi to complete the rest of the story thank you",
    "start": "1216299",
    "end": "1222200"
  },
  {
    "text": "Thank You Terry Adan so let's talk about the response from Microsoft that",
    "start": "1225950",
    "end": "1231990"
  },
  {
    "start": "1227000",
    "end": "1665000"
  },
  {
    "text": "followed these reports so as Teddy mentioned some time on March 24th",
    "start": "1231990",
    "end": "1239639"
  },
  {
    "text": "Microsoft Security Response Center received a que the case from Teddy which",
    "start": "1239639",
    "end": "1247379"
  },
  {
    "text": "was then triaged and then case for remediation so Outlook Web App team at",
    "start": "1247379",
    "end": "1253259"
  },
  {
    "text": "this time started looking for fixes and mitigations without impacting major",
    "start": "1253259",
    "end": "1258809"
  },
  {
    "text": "functionality in Outlook because the it was a critical EP API soon a few days",
    "start": "1258809",
    "end": "1266669"
  },
  {
    "text": "later ron's report followed and since this was a second discovery of the same volume",
    "start": "1266669",
    "end": "1272879"
  },
  {
    "text": "ility in few days time Microsoft Security Response sister center declared",
    "start": "1272879",
    "end": "1279029"
  },
  {
    "text": "sir soap is a process that Microsoft follows to handle elevated attacks on",
    "start": "1279029",
    "end": "1286830"
  },
  {
    "text": "customers so as a result Microsoft Outlook Web App team started looking for",
    "start": "1286830",
    "end": "1293340"
  },
  {
    "text": "fixes which accelerated fixes and mitigations so at at this point of time",
    "start": "1293340",
    "end": "1301080"
  },
  {
    "text": "what we were thinking is we have to stop this as soon as possible even if the",
    "start": "1301080",
    "end": "1306899"
  },
  {
    "text": "with trade-offs of loss of some functionality because you don't know how it could be exploited so in a couple of",
    "start": "1306899",
    "end": "1315480"
  },
  {
    "text": "days time Microsoft over an over team rolled out a mitigation and turned off",
    "start": "1315480",
    "end": "1321539"
  },
  {
    "text": "get access to confer resource API which immediately stopped the clients from getting a partially signed access token",
    "start": "1321539",
    "end": "1330740"
  },
  {
    "text": "this also meant there was a trade-off that and we I will talk about more in",
    "start": "1330740",
    "end": "1336210"
  },
  {
    "text": "the so let's go dig a bit more in the details of the mitigation so as you can",
    "start": "1336210",
    "end": "1343480"
  },
  {
    "text": "see we have our client which is running in the browser on the user's computer and it's talks to a service endpoint",
    "start": "1343480",
    "end": "1350830"
  },
  {
    "text": "which is the primary endpoint where in our client talks to and like all web",
    "start": "1350830",
    "end": "1357700"
  },
  {
    "text": "apps it uses cookie based authentication to talk to the OA service endpoint",
    "start": "1357700",
    "end": "1363600"
  },
  {
    "text": "however our client also talks to a common outlook rest endpoint for some",
    "start": "1363600",
    "end": "1369940"
  },
  {
    "text": "common outlook spera wide functionalities like search and other",
    "start": "1369940",
    "end": "1375129"
  },
  {
    "text": "miscellaneous options and this endpoint does not support cookie-based auth and",
    "start": "1375129",
    "end": "1381519"
  },
  {
    "text": "it works on header based authentication so in order to get that token our client",
    "start": "1381519",
    "end": "1388149"
  },
  {
    "text": "makes a get access token resource for API call to the server the server then",
    "start": "1388149",
    "end": "1393340"
  },
  {
    "text": "used to mint a partially signed token and return it to the client which which",
    "start": "1393340",
    "end": "1400119"
  },
  {
    "text": "is the token that Terry and Ron showed you earlier the client would then make the call using this token to the outlook",
    "start": "1400119",
    "end": "1407019"
  },
  {
    "text": "rest endpoint and to perform user actions so so the first so to mitigate",
    "start": "1407019",
    "end": "1414159"
  },
  {
    "text": "it we immediately turned off a flight or",
    "start": "1414159",
    "end": "1419649"
  },
  {
    "text": "a switch as we call it to stop gate access token API from returning any kind",
    "start": "1419649",
    "end": "1425230"
  },
  {
    "text": "of access this partially sign token to the client which also meant all the",
    "start": "1425230",
    "end": "1430929"
  },
  {
    "text": "Clower calls to outlook rest endpoint would fail especially search and search",
    "start": "1430929",
    "end": "1436179"
  },
  {
    "text": "since it's very very critical for any meaningful experience our team rerouted",
    "start": "1436179",
    "end": "1442299"
  },
  {
    "text": "search back to the outlook input endpoint which was not optimal but it",
    "start": "1442299",
    "end": "1448450"
  },
  {
    "text": "made the client work nonetheless there was some minor functionality losses but we were ok with at this stage but the",
    "start": "1448450",
    "end": "1456429"
  },
  {
    "text": "most important thing at this point of time was this issue could not be exploited any more mu and in back-end",
    "start": "1456429",
    "end": "1465759"
  },
  {
    "text": "and in parallel our team also was working on a we'll fix so that when we enable get",
    "start": "1465759",
    "end": "1472650"
  },
  {
    "text": "access to confer API the client could not get a partial sign token and instead get a fully sign user permission tokens",
    "start": "1472650",
    "end": "1480150"
  },
  {
    "text": "and it is important to note that because of surf and the incident response that",
    "start": "1480150",
    "end": "1488070"
  },
  {
    "text": "we Microsoft was following our team was never scrambling ever for like what",
    "start": "1488070",
    "end": "1493950"
  },
  {
    "text": "should we do and and things like that there was a proper communication and coordination between the teams which",
    "start": "1493950",
    "end": "1499890"
  },
  {
    "text": "greatly help in mitigating the issue we're quickly so let's go a bit more",
    "start": "1499890",
    "end": "1507750"
  },
  {
    "text": "into details of the fix that we made so as in the previous case our client would",
    "start": "1507750",
    "end": "1515730"
  },
  {
    "text": "still talk to our service endpoint using cookie based authentication and it would",
    "start": "1515730",
    "end": "1522420"
  },
  {
    "text": "still make the call to get a great access token API to get the token here instead of using a library in process to",
    "start": "1522420",
    "end": "1530430"
  },
  {
    "text": "maintain token was service would then call token service to get the token so",
    "start": "1530430",
    "end": "1538110"
  },
  {
    "text": "token service is a was an existing service that we have and which is protected by and controlled by a",
    "start": "1538110",
    "end": "1546900"
  },
  {
    "text": "configuration for each of the app and the scenario so the these configurations",
    "start": "1546900",
    "end": "1552180"
  },
  {
    "text": "are unloaded when new scenarios are written and these policies are applied",
    "start": "1552180",
    "end": "1558000"
  },
  {
    "text": "at runtime whenever a token is requested for that scenario so once our service",
    "start": "1558000",
    "end": "1564480"
  },
  {
    "text": "endpoint gets a token and in this case a user level permission token it it then",
    "start": "1564480",
    "end": "1571440"
  },
  {
    "text": "calls the outlook rest endpoint with that new user permission token the",
    "start": "1571440",
    "end": "1577650"
  },
  {
    "text": "search was rerouted back and all the functionalities that were disabled we're enabled again and the service was",
    "start": "1577650",
    "end": "1585140"
  },
  {
    "text": "back running in the normal state as it was before the same day my to a",
    "start": "1585140",
    "end": "1592740"
  },
  {
    "text": "Microsoft Security Response Center also confirmed with Teddy and Ron that they were not able to reproduce the issue",
    "start": "1592740",
    "end": "1598320"
  },
  {
    "text": "anymore and also confirm with them that we would be paying but",
    "start": "1598320",
    "end": "1604610"
  },
  {
    "text": "and Microsoft elected to increase the bounty amount considering the severity",
    "start": "1604610",
    "end": "1609860"
  },
  {
    "text": "of the issue as well as the impact that it had and the high quality of reports",
    "start": "1609860",
    "end": "1616100"
  },
  {
    "text": "that were submitted to us we thank both of you a lot for this partnership in",
    "start": "1616100",
    "end": "1621500"
  },
  {
    "text": "keeping the customers protected so the outcome of this story is what you would",
    "start": "1621500",
    "end": "1627890"
  },
  {
    "text": "hope for the researchers reported a issue to Microsoft and Microsoft quickly",
    "start": "1627890",
    "end": "1635780"
  },
  {
    "text": "responded by meeting by mitigating the issue and turning off the affected call",
    "start": "1635780",
    "end": "1641600"
  },
  {
    "text": "call path followed soon by a comprehensive fix which mitigated the",
    "start": "1641600",
    "end": "1649250"
  },
  {
    "text": "issue which fixed the issue actually and returned the service to the normal state",
    "start": "1649250",
    "end": "1654940"
  },
  {
    "text": "the researchers were paid bounty rewards for their partnership and customers were",
    "start": "1654940",
    "end": "1661670"
  },
  {
    "text": "protected so in the final part of the",
    "start": "1661670",
    "end": "1667190"
  },
  {
    "text": "story we would like to share some of the learnings that we derived from this",
    "start": "1667190",
    "end": "1673870"
  },
  {
    "text": "incident and some of which can be applied to other developers and cloud service providers as well so from the",
    "start": "1673870",
    "end": "1684680"
  },
  {
    "start": "1682000",
    "end": "1845000"
  },
  {
    "text": "developers perspective it is very very important that we follow if the",
    "start": "1684680",
    "end": "1689900"
  },
  {
    "text": "principle of least privilege and we can achieve that this by promoting resource",
    "start": "1689900",
    "end": "1696590"
  },
  {
    "text": "scope and one-time tokens this this was the biggest learning that we derived",
    "start": "1696590",
    "end": "1702950"
  },
  {
    "text": "from here and it helps greatly in improving the security and helps minimizing the attack surface secondly",
    "start": "1702950",
    "end": "1711200"
  },
  {
    "text": "while it is very very important to like adopt newer tools and technologies and",
    "start": "1711200",
    "end": "1716500"
  },
  {
    "text": "like adopt newer flows in terms of security it is equally important to",
    "start": "1716500",
    "end": "1722080"
  },
  {
    "text": "support and like to drive and deprecated end of to a deprecated and to drive and",
    "start": "1722080",
    "end": "1729550"
  },
  {
    "text": "support for legacy token types and power and and systems so this not only will",
    "start": "1729550",
    "end": "1736490"
  },
  {
    "text": "help you in ready using the attack surface but also in",
    "start": "1736490",
    "end": "1741820"
  },
  {
    "text": "general as a general good software practice will reduce your overhead in",
    "start": "1741820",
    "end": "1748129"
  },
  {
    "text": "terms of maintenance as well as like may India biggest thing is like it will",
    "start": "1748129",
    "end": "1754639"
  },
  {
    "text": "reduce your overhead of maintenance so and thirdly it's very important to have",
    "start": "1754639",
    "end": "1762379"
  },
  {
    "text": "like security policies in place for token issuance because with the rise of",
    "start": "1762379",
    "end": "1768409"
  },
  {
    "text": "micro services based architecture the usage of service to service tokens and",
    "start": "1768409",
    "end": "1773899"
  },
  {
    "text": "climb to service tokens have like increased dramatically like there are so many service and you need so many tokens",
    "start": "1773899",
    "end": "1779269"
  },
  {
    "text": "to talk to a different services so so having policies in place and like having",
    "start": "1779269",
    "end": "1785450"
  },
  {
    "text": "configuration and having this decided that the scenario onboarding time of",
    "start": "1785450",
    "end": "1790700"
  },
  {
    "text": "what kind of sort oaken's are needed and what kind of tokens are issued and enforcing those policies at runtime it's",
    "start": "1790700",
    "end": "1797299"
  },
  {
    "text": "very very important and it's very its it is it's always a good idea to have a",
    "start": "1797299",
    "end": "1803480"
  },
  {
    "text": "common team for to which manages this policy because as developers we always",
    "start": "1803480",
    "end": "1809359"
  },
  {
    "text": "try to choose the most straightforward path to implement the feature and like get it out to the users but so and this",
    "start": "1809359",
    "end": "1818330"
  },
  {
    "text": "straight forward path might not be the most secure path this having a common",
    "start": "1818330",
    "end": "1823909"
  },
  {
    "text": "team also helps us you know reducing the compile so that helps us and make",
    "start": "1823909",
    "end": "1832190"
  },
  {
    "text": "feature teams not aware of the complexities of authentications and token handling and things like that like",
    "start": "1832190",
    "end": "1837590"
  },
  {
    "text": "that which is also one more area where things can go wrong so from the cloud",
    "start": "1837590",
    "end": "1846379"
  },
  {
    "start": "1845000",
    "end": "2058000"
  },
  {
    "text": "service providers perspective it's very critical to have your incident response",
    "start": "1846379",
    "end": "1851409"
  },
  {
    "text": "process ready and in place so all the",
    "start": "1851409",
    "end": "1857779"
  },
  {
    "text": "teams normally have a process wherein when they receive a we receive a report",
    "start": "1857779",
    "end": "1863029"
  },
  {
    "text": "or a bug or issue they try to remediate it they work on a fix and then they",
    "start": "1863029",
    "end": "1869149"
  },
  {
    "text": "deploy the fix worldwide to solve the problem however",
    "start": "1869149",
    "end": "1874710"
  },
  {
    "text": "there are scenarios where a standard process is not enough you need an",
    "start": "1874710",
    "end": "1880470"
  },
  {
    "text": "accelerated process in cases like this where you need to immediately do something to stop things from going back",
    "start": "1880470",
    "end": "1888510"
  },
  {
    "text": "to worse and so so whenever any issue",
    "start": "1888510",
    "end": "1893700"
  },
  {
    "text": "arises you should the team should decide should they follow a standard process to",
    "start": "1893700",
    "end": "1899970"
  },
  {
    "text": "mitigate it or should they follow an accelerated process in an accelerated process you the team should look to",
    "start": "1899970",
    "end": "1907340"
  },
  {
    "text": "mitigate the issue as soon as possible even if it means there might be some",
    "start": "1907340",
    "end": "1912780"
  },
  {
    "text": "functionality lost here and there and that is a judgment call that need team needs to make make and in parallel that",
    "start": "1912780",
    "end": "1919320"
  },
  {
    "text": "there should be dedicated engineers who work on long-term correct fix that needs",
    "start": "1919320",
    "end": "1924660"
  },
  {
    "text": "to be made and then the last part is then deploying those fix to all the",
    "start": "1924660",
    "end": "1930690"
  },
  {
    "text": "servers in the world to restore the state so if you if you have a few",
    "start": "1930690",
    "end": "1935970"
  },
  {
    "text": "servers then it's okay but if you are working with servers and the order of hundreds of thousands that having that",
    "start": "1935970",
    "end": "1943110"
  },
  {
    "text": "process in place helps and having a the incident response place response plan",
    "start": "1943110",
    "end": "1948510"
  },
  {
    "text": "also helps in like in terms of communication and collaboration between the teams in finding other issues that",
    "start": "1948510",
    "end": "1954570"
  },
  {
    "text": "might be affected because of or and finding other similary issues so",
    "start": "1954570",
    "end": "1959960"
  },
  {
    "text": "incident response plan is very very important secondly have and have like review the",
    "start": "1959960",
    "end": "1969120"
  },
  {
    "text": "your scenarios not only during the design time but also periodically as part of periodic scenario audits because",
    "start": "1969120",
    "end": "1976830"
  },
  {
    "text": "you you at the design time it might pass the security review and everything looks",
    "start": "1976830",
    "end": "1982410"
  },
  {
    "text": "good but over a period of time as we all know things change and the systems change and what was intended initially",
    "start": "1982410",
    "end": "1989040"
  },
  {
    "text": "might not be how it is running right now so periodic audit helps a lot in that",
    "start": "1989040",
    "end": "1994200"
  },
  {
    "text": "you know in that area third is always",
    "start": "1994200",
    "end": "2000350"
  },
  {
    "text": "keep learning from your past reports and bugs as well as leading in this and like",
    "start": "2000350",
    "end": "2006279"
  },
  {
    "text": "following good industry practices to improve the security flow of your",
    "start": "2006279",
    "end": "2011320"
  },
  {
    "text": "systems and lastly but very important it",
    "start": "2011320",
    "end": "2016750"
  },
  {
    "text": "is to partner with the security community to find flaws every every team",
    "start": "2016750",
    "end": "2021850"
  },
  {
    "text": "or every normally a company can have internal security researchers and teams",
    "start": "2021850",
    "end": "2026950"
  },
  {
    "text": "to find to find issues in their system but it is also equally important to",
    "start": "2026950",
    "end": "2033059"
  },
  {
    "text": "partner with a community to to like so that both complement each other and find",
    "start": "2033059",
    "end": "2039820"
  },
  {
    "text": "their problems and if someone finds a problem or an issue you should have a",
    "start": "2039820",
    "end": "2045580"
  },
  {
    "text": "way or I they should know that these securities such as know how to report",
    "start": "2045580",
    "end": "2050800"
  },
  {
    "text": "this issue to you and you have a plan in place to manage the fix and roll out the",
    "start": "2050800",
    "end": "2056200"
  },
  {
    "text": "fix so there are a few learnings from",
    "start": "2056200",
    "end": "2062530"
  },
  {
    "text": "the researchers perspective as well which Terry and Ron would share okay Thank You Ravi and I just got two quick",
    "start": "2062530",
    "end": "2069520"
  },
  {
    "text": "tips for bag hunters or what has the first one is always use the application",
    "start": "2069520",
    "end": "2074888"
  },
  {
    "text": "where you face a target always use it just like a normal user at the first time no hurry to test no hurry to like",
    "start": "2074889",
    "end": "2080980"
  },
  {
    "text": "spread your payload everywhere to save it if it can trigger somewhere that that is really not helpful for your skills",
    "start": "2080980",
    "end": "2086589"
  },
  {
    "text": "and just especially it is helpful when you like I will look for like",
    "start": "2086589",
    "end": "2092560"
  },
  {
    "text": "authentication authorization issue or privacy issue or logic issue it is really helpful when you totally",
    "start": "2092560",
    "end": "2098890"
  },
  {
    "text": "understand the application understand the target even more familiar than their own part of manager so that is first tip",
    "start": "2098890",
    "end": "2106810"
  },
  {
    "text": "and the second is always monitor the update of the target like no matter you use some technique to monitor their like",
    "start": "2106810",
    "end": "2114010"
  },
  {
    "text": "static files like JavaScript files or you can just assembly use RSS reader is",
    "start": "2114010",
    "end": "2119470"
  },
  {
    "text": "really helpful like you can review the the new attack surface at the very first",
    "start": "2119470",
    "end": "2124780"
  },
  {
    "text": "time than everyone else so that's my tips and for my part I would say that I",
    "start": "2124780",
    "end": "2133630"
  },
  {
    "text": "got lucky this time because I got great too me for this bug so my suggestion is keep",
    "start": "2133630",
    "end": "2142109"
  },
  {
    "text": "improving your tool box say in my example I got lucky I installed it that",
    "start": "2142109",
    "end": "2148050"
  },
  {
    "text": "Jason web token attacker so it automatically highlighted the request",
    "start": "2148050",
    "end": "2153270"
  },
  {
    "text": "that I would not have been looking at it at all so always improve your tool box that",
    "start": "2153270",
    "end": "2161940"
  },
  {
    "text": "fits your need and the second one obviously is make sure to document and",
    "start": "2161940",
    "end": "2168300"
  },
  {
    "text": "screenshot your work because I forgot to do that at the time of discovery that's",
    "start": "2168300",
    "end": "2174660"
  },
  {
    "text": "why I have to use the updated version of JW the fixed version but the reason for",
    "start": "2174660",
    "end": "2183140"
  },
  {
    "text": "researcher to always screenshot and document your finding is that in this",
    "start": "2183140",
    "end": "2188339"
  },
  {
    "text": "way you can learn it from the past and also you can always keep evidence and",
    "start": "2188339",
    "end": "2195240"
  },
  {
    "text": "keep up your work for future use like you don't know what when do you need",
    "start": "2195240",
    "end": "2200790"
  },
  {
    "text": "them and yep so this is my final tip make sure the document I screenshot your",
    "start": "2200790",
    "end": "2206250"
  },
  {
    "text": "work thank you thank you okay yeah so",
    "start": "2206250",
    "end": "2211380"
  },
  {
    "start": "2209000",
    "end": "2246000"
  },
  {
    "text": "here are just about the resources that we talked about during our talk here so",
    "start": "2211380",
    "end": "2217829"
  },
  {
    "text": "you can download Bob sweet from Portugal tech and read a bit more about Outlook",
    "start": "2217829",
    "end": "2224069"
  },
  {
    "text": "REST API is from Doc stock Microsoft comm and you can read the wonderful",
    "start": "2224069",
    "end": "2229290"
  },
  {
    "text": "black blog of mmm SRC if you are interested in developing an incident",
    "start": "2229290",
    "end": "2234480"
  },
  {
    "text": "response plan for your own team and company and yeah so that's all from us",
    "start": "2234480",
    "end": "2240810"
  },
  {
    "text": "thank you thank you [Applause]",
    "start": "2240810",
    "end": "2247899"
  }
]