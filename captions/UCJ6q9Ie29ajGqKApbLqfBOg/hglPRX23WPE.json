[
  {
    "start": "0",
    "end": "56000"
  },
  {
    "text": "all right so hi and thanks for joining",
    "start": "0",
    "end": "2100"
  },
  {
    "text": "my sock in breaking the attack graph I'm",
    "start": "2100",
    "end": "5370"
  },
  {
    "text": "Rena Simcoe and I am security researcher",
    "start": "5370",
    "end": "7950"
  },
  {
    "text": "at Microsoft in the ATA slash adder ATT",
    "start": "7950",
    "end": "11490"
  },
  {
    "text": "group and today I want to talk to you",
    "start": "11490",
    "end": "13620"
  },
  {
    "text": "about how defenders can leverage graphs",
    "start": "13620",
    "end": "15870"
  },
  {
    "text": "in order to create a more secure domain",
    "start": "15870",
    "end": "17970"
  },
  {
    "text": "environment so let's see our agenda for",
    "start": "17970",
    "end": "21630"
  },
  {
    "text": "this talk I'll begin with discussing a",
    "start": "21630",
    "end": "23490"
  },
  {
    "text": "few attack tools today that use graphs",
    "start": "23490",
    "end": "25650"
  },
  {
    "text": "and graph theory such as bloodhound and",
    "start": "25650",
    "end": "28289"
  },
  {
    "text": "go fetch and then we'll see how",
    "start": "28289",
    "end": "30000"
  },
  {
    "text": "defenders can be using graphs for",
    "start": "30000",
    "end": "32279"
  },
  {
    "text": "different security purposes starting",
    "start": "32279",
    "end": "34559"
  },
  {
    "text": "from attack prevention we'll see how we",
    "start": "34559",
    "end": "36780"
  },
  {
    "text": "can reduce the attack surface in our",
    "start": "36780",
    "end": "38579"
  },
  {
    "text": "environment to begin with we'll see how",
    "start": "38579",
    "end": "40739"
  },
  {
    "text": "we can detect various attacks which",
    "start": "40739",
    "end": "42840"
  },
  {
    "text": "might be performing reconnaissance or",
    "start": "42840",
    "end": "45329"
  },
  {
    "text": "lateral movement activities in our",
    "start": "45329",
    "end": "46770"
  },
  {
    "text": "environment and finally we'll see how",
    "start": "46770",
    "end": "48719"
  },
  {
    "text": "they can be very helpful for attack",
    "start": "48719",
    "end": "50579"
  },
  {
    "text": "investigation as well so very brief",
    "start": "50579",
    "end": "54570"
  },
  {
    "text": "overview of bloodhound",
    "start": "54570",
    "end": "56370"
  },
  {
    "start": "56000",
    "end": "56000"
  },
  {
    "text": "so bloodhound was a tool which was",
    "start": "56370",
    "end": "58559"
  },
  {
    "text": "originally created for attackers but it",
    "start": "58559",
    "end": "61410"
  },
  {
    "text": "can be very useful for defenders as well",
    "start": "61410",
    "end": "63449"
  },
  {
    "text": "and what it does is it constructs a",
    "start": "63449",
    "end": "66390"
  },
  {
    "text": "graph it shows path which would lead",
    "start": "66390",
    "end": "68670"
  },
  {
    "text": "from less privileged domain accounts to",
    "start": "68670",
    "end": "71130"
  },
  {
    "text": "domain admins so it started by scanning",
    "start": "71130",
    "end": "73830"
  },
  {
    "text": "the environment to gather as much",
    "start": "73830",
    "end": "75509"
  },
  {
    "text": "information as possible to construct the",
    "start": "75509",
    "end": "77610"
  },
  {
    "text": "graph so that information includes local",
    "start": "77610",
    "end": "80369"
  },
  {
    "text": "administrators and domain computers",
    "start": "80369",
    "end": "82259"
  },
  {
    "text": "domain group memberships active sessions",
    "start": "82259",
    "end": "85080"
  },
  {
    "text": "on the machines access control lists and",
    "start": "85080",
    "end": "87600"
  },
  {
    "text": "a few more and then it uses all that",
    "start": "87600",
    "end": "90750"
  },
  {
    "text": "information in order to construct that",
    "start": "90750",
    "end": "93000"
  },
  {
    "text": "graph which reveals paths that lead from",
    "start": "93000",
    "end": "95400"
  },
  {
    "text": "less privileged domain accounts to",
    "start": "95400",
    "end": "97409"
  },
  {
    "text": "domain admins so if you're not familiar",
    "start": "97409",
    "end": "99659"
  },
  {
    "text": "with this tool I definitely recommend",
    "start": "99659",
    "end": "101520"
  },
  {
    "text": "that you check it out and see all the",
    "start": "101520",
    "end": "102840"
  },
  {
    "text": "features that it has another cool tool",
    "start": "102840",
    "end": "106920"
  },
  {
    "text": "is go fetch what go fetch does is it",
    "start": "106920",
    "end": "109530"
  },
  {
    "start": "107000",
    "end": "107000"
  },
  {
    "text": "takes as an input path generated by Vlad",
    "start": "109530",
    "end": "112710"
  },
  {
    "text": "hound and it automates the entire",
    "start": "112710",
    "end": "114570"
  },
  {
    "text": "lateral movement process so it moves",
    "start": "114570",
    "end": "117149"
  },
  {
    "text": "from one node to the next extracting the",
    "start": "117149",
    "end": "119700"
  },
  {
    "text": "credentials of the next user and so on",
    "start": "119700",
    "end": "122460"
  },
  {
    "text": "until reaching the final node of path",
    "start": "122460",
    "end": "124920"
  },
  {
    "text": "where it extracts the credentials of the",
    "start": "124920",
    "end": "127140"
  },
  {
    "text": "domain admin and returns them to the",
    "start": "127140",
    "end": "129810"
  },
  {
    "text": "attacker so as you can see once you have",
    "start": "129810",
    "end": "132450"
  },
  {
    "text": "the entire process autumn a",
    "start": "132450",
    "end": "133970"
  },
  {
    "text": "attackers don't need to necessarily have",
    "start": "133970",
    "end": "136220"
  },
  {
    "text": "the shortest path possible any path",
    "start": "136220",
    "end": "138590"
  },
  {
    "text": "which would lead them to domain admin",
    "start": "138590",
    "end": "140450"
  },
  {
    "text": "credentials is good enough a short",
    "start": "140450",
    "end": "144710"
  },
  {
    "start": "144000",
    "end": "144000"
  },
  {
    "text": "comparison between what attackers are",
    "start": "144710",
    "end": "146960"
  },
  {
    "text": "doing today versus what defenders can be",
    "start": "146960",
    "end": "149420"
  },
  {
    "text": "doing",
    "start": "149420",
    "end": "149840"
  },
  {
    "text": "so when attackers are scanning the",
    "start": "149840",
    "end": "152000"
  },
  {
    "text": "network to gather the information",
    "start": "152000",
    "end": "153830"
  },
  {
    "text": "they're using limited privileges they're",
    "start": "153830",
    "end": "155960"
  },
  {
    "text": "using that initial account that they",
    "start": "155960",
    "end": "157580"
  },
  {
    "text": "were able to compromise since the entire",
    "start": "157580",
    "end": "159740"
  },
  {
    "text": "purpose is to find a path that would",
    "start": "159740",
    "end": "161540"
  },
  {
    "text": "lead them to high privileged account",
    "start": "161540",
    "end": "163240"
  },
  {
    "text": "defenders however can use any",
    "start": "163240",
    "end": "165560"
  },
  {
    "text": "permissions that they want now as a",
    "start": "165560",
    "end": "168410"
  },
  {
    "text": "result attackers have limited access to",
    "start": "168410",
    "end": "170750"
  },
  {
    "text": "network resources so this is something",
    "start": "170750",
    "end": "173000"
  },
  {
    "text": "that depends on the configuration and",
    "start": "173000",
    "end": "175370"
  },
  {
    "text": "hardening of the environment since a lot",
    "start": "175370",
    "end": "177830"
  },
  {
    "text": "of the data gathering methods require",
    "start": "177830",
    "end": "179780"
  },
  {
    "text": "that you have administrative privileges",
    "start": "179780",
    "end": "181310"
  },
  {
    "text": "on the target machine so attackers would",
    "start": "181310",
    "end": "183950"
  },
  {
    "text": "not be able to retrieve the information",
    "start": "183950",
    "end": "185840"
  },
  {
    "text": "from all the computers again defenders",
    "start": "185840",
    "end": "188720"
  },
  {
    "text": "can access any resources that they want",
    "start": "188720",
    "end": "191890"
  },
  {
    "text": "now even though attackers have limited",
    "start": "191890",
    "end": "194750"
  },
  {
    "text": "access they're still able to construct a",
    "start": "194750",
    "end": "197000"
  },
  {
    "text": "graph based on the information that they",
    "start": "197000",
    "end": "198890"
  },
  {
    "text": "were able to retrieve so that graph",
    "start": "198890",
    "end": "200989"
  },
  {
    "text": "would be a partial graph the feathers",
    "start": "200989",
    "end": "204020"
  },
  {
    "text": "however can create full graphs which",
    "start": "204020",
    "end": "206900"
  },
  {
    "text": "contains any date data and network",
    "start": "206900",
    "end": "209420"
  },
  {
    "text": "resources that they want even though",
    "start": "209420",
    "end": "212600"
  },
  {
    "text": "it's a KERS are only working with a",
    "start": "212600",
    "end": "214760"
  },
  {
    "text": "partial graph they we just saw with the",
    "start": "214760",
    "end": "216890"
  },
  {
    "text": "bloodhound how they can use that graph",
    "start": "216890",
    "end": "218810"
  },
  {
    "text": "to gain very valuable insight into our",
    "start": "218810",
    "end": "221150"
  },
  {
    "text": "environment and find complex attack",
    "start": "221150",
    "end": "223489"
  },
  {
    "text": "paths which would lead them to",
    "start": "223489",
    "end": "224959"
  },
  {
    "text": "compromise one of our domain",
    "start": "224959",
    "end": "226880"
  },
  {
    "text": "administrators",
    "start": "226880",
    "end": "227920"
  },
  {
    "text": "well if attackers are using those",
    "start": "227920",
    "end": "230540"
  },
  {
    "text": "limited permissions and data sources and",
    "start": "230540",
    "end": "232940"
  },
  {
    "text": "are still able to leverage graphs to",
    "start": "232940",
    "end": "234920"
  },
  {
    "text": "their benefit the question is what can",
    "start": "234920",
    "end": "237200"
  },
  {
    "text": "we as defenders do with our unlimited",
    "start": "237200",
    "end": "239600"
  },
  {
    "text": "permissions and data sources and use",
    "start": "239600",
    "end": "241820"
  },
  {
    "text": "graphs to defend our environment so this",
    "start": "241820",
    "end": "243980"
  },
  {
    "text": "is exactly what I'll be covering in this",
    "start": "243980",
    "end": "245690"
  },
  {
    "text": "session today so how can we use graphs",
    "start": "245690",
    "end": "249410"
  },
  {
    "start": "247000",
    "end": "247000"
  },
  {
    "text": "well first of all we can see how we can",
    "start": "249410",
    "end": "252050"
  },
  {
    "text": "use them to prevent attacks we'll see",
    "start": "252050",
    "end": "253850"
  },
  {
    "text": "how we can reduce the attack surface how",
    "start": "253850",
    "end": "256400"
  },
  {
    "text": "we can detect the most vulnerable nodes",
    "start": "256400",
    "end": "258320"
  },
  {
    "text": "that we have in our environment which",
    "start": "258320",
    "end": "260030"
  },
  {
    "text": "can be either users and computers and",
    "start": "260030",
    "end": "262490"
  },
  {
    "text": "then we'll see how we can disconnect",
    "start": "262490",
    "end": "264080"
  },
  {
    "text": "them from the",
    "start": "264080",
    "end": "265030"
  },
  {
    "text": "check that next we'll see how we can use",
    "start": "265030",
    "end": "268270"
  },
  {
    "text": "them for attack detection see how to",
    "start": "268270",
    "end": "270100"
  },
  {
    "text": "study love and patterns of users and",
    "start": "270100",
    "end": "272740"
  },
  {
    "text": "detect anomalies which might indicate",
    "start": "272740",
    "end": "275040"
  },
  {
    "text": "reconnaissance or lateral movement",
    "start": "275040",
    "end": "276940"
  },
  {
    "text": "activities and finally very briefly",
    "start": "276940",
    "end": "280450"
  },
  {
    "text": "we'll see how they can help us with",
    "start": "280450",
    "end": "282250"
  },
  {
    "text": "attack investigation as well we'll see",
    "start": "282250",
    "end": "284590"
  },
  {
    "text": "how it can help us gain insights into",
    "start": "284590",
    "end": "286990"
  },
  {
    "text": "the attack path maybe understand what",
    "start": "286990",
    "end": "289090"
  },
  {
    "text": "the attack source was and even find",
    "start": "289090",
    "end": "291370"
  },
  {
    "text": "additional accounts which may have been",
    "start": "291370",
    "end": "293500"
  },
  {
    "text": "compromised during the attack right",
    "start": "293500",
    "end": "297070"
  },
  {
    "start": "297000",
    "end": "297000"
  },
  {
    "text": "before diving into every one of the",
    "start": "297070",
    "end": "299110"
  },
  {
    "text": "stages that we just seen let's see which",
    "start": "299110",
    "end": "301270"
  },
  {
    "text": "data sources we'll be using",
    "start": "301270",
    "end": "303180"
  },
  {
    "text": "first thing that we need are the domain",
    "start": "303180",
    "end": "305620"
  },
  {
    "text": "group memberships we need to understand",
    "start": "305620",
    "end": "307450"
  },
  {
    "text": "who are the high privileged accounts in",
    "start": "307450",
    "end": "309340"
  },
  {
    "text": "our environment those are the accounts",
    "start": "309340",
    "end": "311770"
  },
  {
    "text": "that are members of those high",
    "start": "311770",
    "end": "313930"
  },
  {
    "text": "privileges built-in groups in Active",
    "start": "313930",
    "end": "315430"
  },
  {
    "text": "Directory then we need to get the local",
    "start": "315430",
    "end": "318430"
  },
  {
    "text": "group memberships on the domain",
    "start": "318430",
    "end": "319930"
  },
  {
    "text": "computers in order to understand who has",
    "start": "319930",
    "end": "322390"
  },
  {
    "text": "administrative privileges on every",
    "start": "322390",
    "end": "324250"
  },
  {
    "text": "domain machine and last and most",
    "start": "324250",
    "end": "326950"
  },
  {
    "text": "important piece of the puzzle would be",
    "start": "326950",
    "end": "328840"
  },
  {
    "text": "the existing credentials on every domain",
    "start": "328840",
    "end": "331120"
  },
  {
    "text": "machine so when I say credentials I mean",
    "start": "331120",
    "end": "333669"
  },
  {
    "text": "either the ntlm hash of the user or the",
    "start": "333669",
    "end": "336220"
  },
  {
    "text": "Kerberos ticket as defenders we can get",
    "start": "336220",
    "end": "339729"
  },
  {
    "text": "that information either from login",
    "start": "339729",
    "end": "342370"
  },
  {
    "text": "events which are usually collected to a",
    "start": "342370",
    "end": "344530"
  },
  {
    "text": "sim in most environments or from network",
    "start": "344530",
    "end": "347229"
  },
  {
    "text": "traffic that comes to the domain",
    "start": "347229",
    "end": "348760"
  },
  {
    "text": "controller now for most organizations it",
    "start": "348760",
    "end": "351460"
  },
  {
    "text": "would be probably easier to use login",
    "start": "351460",
    "end": "353590"
  },
  {
    "text": "events however I already had the",
    "start": "353590",
    "end": "355570"
  },
  {
    "text": "Kerberos traffic parsed so I use the",
    "start": "355570",
    "end": "357880"
  },
  {
    "text": "combination of the two so what I did is",
    "start": "357880",
    "end": "359800"
  },
  {
    "text": "in order to cover the Kerberos I think",
    "start": "359800",
    "end": "361990"
  },
  {
    "text": "occasions I looked into successful a s",
    "start": "361990",
    "end": "364900"
  },
  {
    "text": "and TGS request to the domain controller",
    "start": "364900",
    "end": "367090"
  },
  {
    "text": "so if there was a computer from which",
    "start": "367090",
    "end": "369700"
  },
  {
    "text": "there was a successful ASO TGS request",
    "start": "369700",
    "end": "372190"
  },
  {
    "text": "it means that that computer now holds",
    "start": "372190",
    "end": "374440"
  },
  {
    "text": "the credentials of the user so that",
    "start": "374440",
    "end": "376870"
  },
  {
    "text": "covers kevro site indications since the",
    "start": "376870",
    "end": "379539"
  },
  {
    "text": "ntlm traffic is encrypted",
    "start": "379539",
    "end": "381490"
  },
  {
    "text": "I used a dedicated event which can be",
    "start": "381490",
    "end": "384250"
  },
  {
    "text": "located on the domain controller which",
    "start": "384250",
    "end": "386320"
  },
  {
    "text": "states both the source computer the",
    "start": "386320",
    "end": "388630"
  },
  {
    "text": "target computer and also the",
    "start": "388630",
    "end": "390370"
  },
  {
    "text": "authenticated user so by using the",
    "start": "390370",
    "end": "392800"
  },
  {
    "text": "domain controller as the main source of",
    "start": "392800",
    "end": "395500"
  },
  {
    "text": "information I was able to map",
    "start": "395500",
    "end": "397610"
  },
  {
    "text": "all the credentials that are present on",
    "start": "397610",
    "end": "399229"
  },
  {
    "text": "the environment the good thing about",
    "start": "399229",
    "end": "400550"
  },
  {
    "text": "this is that we don't need to query all",
    "start": "400550",
    "end": "402979"
  },
  {
    "text": "the machines to get the active sessions",
    "start": "402979",
    "end": "404719"
  },
  {
    "text": "all the time since it's something that",
    "start": "404719",
    "end": "406759"
  },
  {
    "text": "is constantly changing and we're also",
    "start": "406759",
    "end": "408949"
  },
  {
    "text": "not creating any additional load on our",
    "start": "408949",
    "end": "411080"
  },
  {
    "text": "network simply using the domain",
    "start": "411080",
    "end": "413120"
  },
  {
    "text": "controller in order to map all the",
    "start": "413120",
    "end": "415159"
  },
  {
    "text": "credentials all right now we know which",
    "start": "415159",
    "end": "419000"
  },
  {
    "text": "data sources we're using let's see how",
    "start": "419000",
    "end": "420979"
  },
  {
    "text": "we can use this data let's start with",
    "start": "420979",
    "end": "422870"
  },
  {
    "text": "the tag prevention so here our goal",
    "start": "422870",
    "end": "425330"
  },
  {
    "text": "would be to reduce the attack surface in",
    "start": "425330",
    "end": "427340"
  },
  {
    "text": "the environment we'll see how we can",
    "start": "427340",
    "end": "429139"
  },
  {
    "text": "discover the most vulnerable nodes that",
    "start": "429139",
    "end": "431419"
  },
  {
    "text": "we have in our network and then we'll",
    "start": "431419",
    "end": "433250"
  },
  {
    "text": "see different ways in which we can",
    "start": "433250",
    "end": "434539"
  },
  {
    "text": "disconnect them from as many attack",
    "start": "434539",
    "end": "436610"
  },
  {
    "text": "paths as we can the biggest problem with",
    "start": "436610",
    "end": "439699"
  },
  {
    "text": "this approach is that computing all the",
    "start": "439699",
    "end": "442279"
  },
  {
    "text": "attack paths is a hard task so if you",
    "start": "442279",
    "end": "444590"
  },
  {
    "text": "have a large environment it will require",
    "start": "444590",
    "end": "446750"
  },
  {
    "text": "a lot of running time resources and also",
    "start": "446750",
    "end": "449090"
  },
  {
    "text": "the attack graph is constantly changing",
    "start": "449090",
    "end": "450919"
  },
  {
    "text": "you have constantly new sessions added",
    "start": "450919",
    "end": "453139"
  },
  {
    "text": "or removed from the environment so the",
    "start": "453139",
    "end": "455360"
  },
  {
    "text": "solution would be that we would not be",
    "start": "455360",
    "end": "457129"
  },
  {
    "text": "computing the entire attack graph any",
    "start": "457129",
    "end": "459199"
  },
  {
    "text": "stage will only be computing the last",
    "start": "459199",
    "end": "461839"
  },
  {
    "text": "layers on the graph and will try to",
    "start": "461839",
    "end": "463969"
  },
  {
    "text": "disconnect one of the last edges in",
    "start": "463969",
    "end": "466219"
  },
  {
    "text": "those layers let's see what I mean by",
    "start": "466219",
    "end": "468169"
  },
  {
    "text": "that here you can see an example of a",
    "start": "468169",
    "end": "471560"
  },
  {
    "text": "graph generated by bloodhound you can",
    "start": "471560",
    "end": "474020"
  },
  {
    "text": "see different paths which lead from less",
    "start": "474020",
    "end": "476599"
  },
  {
    "text": "privileged domain accounts on the left",
    "start": "476599",
    "end": "478610"
  },
  {
    "text": "to the main admins on the right now",
    "start": "478610",
    "end": "481339"
  },
  {
    "text": "there can be different types of paths",
    "start": "481339",
    "end": "483440"
  },
  {
    "text": "however most of them would end in a",
    "start": "483440",
    "end": "486020"
  },
  {
    "text": "similar pattern",
    "start": "486020",
    "end": "486830"
  },
  {
    "text": "the most common ending of the path would",
    "start": "486830",
    "end": "489139"
  },
  {
    "text": "be that you would have a less privileged",
    "start": "489139",
    "end": "491419"
  },
  {
    "text": "domain account which has administrative",
    "start": "491419",
    "end": "494120"
  },
  {
    "text": "privileges on a machine with a session",
    "start": "494120",
    "end": "496789"
  },
  {
    "text": "of a domain admin in that case if that",
    "start": "496789",
    "end": "499969"
  },
  {
    "text": "less privileged domain account is",
    "start": "499969",
    "end": "501379"
  },
  {
    "text": "compromised it can be used to connect to",
    "start": "501379",
    "end": "503300"
  },
  {
    "text": "that vulnerable machine and extract the",
    "start": "503300",
    "end": "505699"
  },
  {
    "text": "credentials of the domain administrator",
    "start": "505699",
    "end": "507159"
  },
  {
    "text": "so I will try to do is we'll focus on",
    "start": "507159",
    "end": "510620"
  },
  {
    "text": "the last part of the graph only on the",
    "start": "510620",
    "end": "514010"
  },
  {
    "text": "last layers and we'll try to disconnect",
    "start": "514010",
    "end": "516140"
  },
  {
    "text": "as many edges as we can that intersect",
    "start": "516140",
    "end": "518810"
  },
  {
    "text": "with one of the vertical red lines so",
    "start": "518810",
    "end": "521479"
  },
  {
    "text": "notice that by removing those edges",
    "start": "521479",
    "end": "523669"
  },
  {
    "text": "we'll also be affecting paths of longer",
    "start": "523669",
    "end": "525829"
  },
  {
    "text": "length as well since those would",
    "start": "525829",
    "end": "527720"
  },
  {
    "text": "eventually merge into one of the",
    "start": "527720",
    "end": "529610"
  },
  {
    "text": "shortest",
    "start": "529610",
    "end": "531640"
  },
  {
    "text": "okay so our goal is to find the notes",
    "start": "531640",
    "end": "534260"
  },
  {
    "start": "532000",
    "end": "532000"
  },
  {
    "text": "that are part of the most attacked path",
    "start": "534260",
    "end": "536600"
  },
  {
    "text": "so let's see a definition a vulnerable",
    "start": "536600",
    "end": "539720"
  },
  {
    "text": "node is a node which has a high",
    "start": "539720",
    "end": "541610"
  },
  {
    "text": "probability of being compromised during",
    "start": "541610",
    "end": "543590"
  },
  {
    "text": "an attack and it can be either a",
    "start": "543590",
    "end": "545540"
  },
  {
    "text": "computer or a user node a vulnerable",
    "start": "545540",
    "end": "549560"
  },
  {
    "text": "computer is a computer which has a",
    "start": "549560",
    "end": "551270"
  },
  {
    "text": "session of at least one high privileged",
    "start": "551270",
    "end": "553520"
  },
  {
    "text": "account and it has many low privileged",
    "start": "553520",
    "end": "555980"
  },
  {
    "text": "accounts that have local admin",
    "start": "555980",
    "end": "557930"
  },
  {
    "text": "privileges at this machine so this means",
    "start": "557930",
    "end": "560480"
  },
  {
    "text": "that if any one of those low privileged",
    "start": "560480",
    "end": "562880"
  },
  {
    "text": "accounts is compromised it can be used",
    "start": "562880",
    "end": "564800"
  },
  {
    "text": "to connect to the vulnerable machine and",
    "start": "564800",
    "end": "566390"
  },
  {
    "text": "extract the credentials of the domain",
    "start": "566390",
    "end": "568340"
  },
  {
    "text": "admin so if a computer has more",
    "start": "568340",
    "end": "571510"
  },
  {
    "text": "administrative sessions and more low",
    "start": "571510",
    "end": "574220"
  },
  {
    "text": "privileged accounts that have local",
    "start": "574220",
    "end": "575960"
  },
  {
    "text": "admin privileges we would consider the",
    "start": "575960",
    "end": "577820"
  },
  {
    "text": "computer to be more vulnerable second",
    "start": "577820",
    "end": "581960"
  },
  {
    "text": "type of vulnerable node is the user node",
    "start": "581960",
    "end": "584000"
  },
  {
    "text": "so this is a node that represents a user",
    "start": "584000",
    "end": "587000"
  },
  {
    "text": "that has high privileges in the",
    "start": "587000",
    "end": "589040"
  },
  {
    "text": "environment and it has a session on at",
    "start": "589040",
    "end": "591170"
  },
  {
    "text": "least one vulnerable computer so if the",
    "start": "591170",
    "end": "593900"
  },
  {
    "text": "user has more sessions on more",
    "start": "593900",
    "end": "596120"
  },
  {
    "text": "vulnerable computers will consider the",
    "start": "596120",
    "end": "598160"
  },
  {
    "text": "user as more vulnerable in the",
    "start": "598160",
    "end": "599870"
  },
  {
    "text": "environment something which is important",
    "start": "599870",
    "end": "604190"
  },
  {
    "text": "to state is that the status of a node",
    "start": "604190",
    "end": "605870"
  },
  {
    "text": "can change over time so if a node is",
    "start": "605870",
    "end": "607850"
  },
  {
    "text": "considered to be vulnerable today it",
    "start": "607850",
    "end": "609410"
  },
  {
    "text": "will not be necessary for being",
    "start": "609410",
    "end": "611240"
  },
  {
    "text": "considered vulnerable tomorrow as well",
    "start": "611240",
    "end": "612770"
  },
  {
    "text": "so this is something which depends on",
    "start": "612770",
    "end": "614720"
  },
  {
    "text": "the user behavior every day user",
    "start": "614720",
    "end": "616790"
  },
  {
    "text": "connects different computers and also on",
    "start": "616790",
    "end": "619070"
  },
  {
    "text": "computer configurations so a user can",
    "start": "619070",
    "end": "621470"
  },
  {
    "text": "constantly add or remove local admins",
    "start": "621470",
    "end": "624020"
  },
  {
    "text": "from the machine so in order to find the",
    "start": "624020",
    "end": "626300"
  },
  {
    "text": "nodes that pose the largest risk in our",
    "start": "626300",
    "end": "629030"
  },
  {
    "text": "environment we need to track the status",
    "start": "629030",
    "end": "630950"
  },
  {
    "text": "of the nodes over time so since we're",
    "start": "630950",
    "end": "633440"
  },
  {
    "text": "collecting the sessions and we know the",
    "start": "633440",
    "end": "635600"
  },
  {
    "text": "local admins on the computer we can",
    "start": "635600",
    "end": "637580"
  },
  {
    "text": "compute what percentage of the time is",
    "start": "637580",
    "end": "639770"
  },
  {
    "text": "the node actually considered vulnerable",
    "start": "639770",
    "end": "641450"
  },
  {
    "text": "that would allow us to detect whether",
    "start": "641450",
    "end": "643880"
  },
  {
    "text": "we're dealing with a constant issue in",
    "start": "643880",
    "end": "646040"
  },
  {
    "text": "the environment thus node is constantly",
    "start": "646040",
    "end": "647960"
  },
  {
    "text": "part of many attack paths in the attack",
    "start": "647960",
    "end": "650180"
  },
  {
    "text": "graph or just one-time occurrence that",
    "start": "650180",
    "end": "652520"
  },
  {
    "text": "we might not need to do anything with so",
    "start": "652520",
    "end": "655640"
  },
  {
    "text": "by computing this and adding the",
    "start": "655640",
    "end": "657260"
  },
  {
    "text": "criteria from the previous slide we can",
    "start": "657260",
    "end": "659690"
  },
  {
    "text": "create a ranking of the nodes by",
    "start": "659690",
    "end": "661370"
  },
  {
    "text": "vulnerabilities to detect",
    "start": "661370",
    "end": "663050"
  },
  {
    "text": "which are the most problematic user and",
    "start": "663050",
    "end": "665360"
  },
  {
    "text": "computer nodes in our environment once",
    "start": "665360",
    "end": "668060"
  },
  {
    "text": "we found those we need to secure them",
    "start": "668060",
    "end": "670160"
  },
  {
    "text": "somehow how can we secure those nodes",
    "start": "670160",
    "end": "672320"
  },
  {
    "text": "well we can either use the ception",
    "start": "672320",
    "end": "674840"
  },
  {
    "text": "we can plant traps in our environment",
    "start": "674840",
    "end": "677270"
  },
  {
    "text": "and hope that the attacker would fall",
    "start": "677270",
    "end": "678800"
  },
  {
    "text": "into one of those so if you want to hear",
    "start": "678800",
    "end": "680840"
  },
  {
    "text": "more about this I recommend that you",
    "start": "680840",
    "end": "682850"
  },
  {
    "text": "check out Tom sell a stock from Def Con",
    "start": "682850",
    "end": "684890"
  },
  {
    "text": "last year where he explained this",
    "start": "684890",
    "end": "687190"
  },
  {
    "text": "basically what what they do is they",
    "start": "687190",
    "end": "690140"
  },
  {
    "text": "create new attack paths and hope that",
    "start": "690140",
    "end": "692300"
  },
  {
    "text": "the attacker would choose one of those",
    "start": "692300",
    "end": "694190"
  },
  {
    "text": "and then they'll be able to detect them",
    "start": "694190",
    "end": "696640"
  },
  {
    "text": "another thing that we can do is this can",
    "start": "696640",
    "end": "699170"
  },
  {
    "text": "simply disconnect the vulnerable nodes",
    "start": "699170",
    "end": "700940"
  },
  {
    "text": "from the attack graph so in both methods",
    "start": "700940",
    "end": "703190"
  },
  {
    "text": "we are changing the attack graph in one",
    "start": "703190",
    "end": "706010"
  },
  {
    "text": "of them were simply adding new attack",
    "start": "706010",
    "end": "708140"
  },
  {
    "text": "paths and in the second one we're",
    "start": "708140",
    "end": "710030"
  },
  {
    "text": "removing existing paths so I'll be",
    "start": "710030",
    "end": "712010"
  },
  {
    "text": "focusing on the next method in the next",
    "start": "712010",
    "end": "714500"
  },
  {
    "text": "slide right so now that we found the",
    "start": "714500",
    "end": "719090"
  },
  {
    "start": "717000",
    "end": "717000"
  },
  {
    "text": "most vulnerable nodes the question is",
    "start": "719090",
    "end": "721220"
  },
  {
    "text": "how can we disconnect them from the",
    "start": "721220",
    "end": "723290"
  },
  {
    "text": "attack graph well first thing that we",
    "start": "723290",
    "end": "725690"
  },
  {
    "text": "can do is perform configuration changes",
    "start": "725690",
    "end": "728390"
  },
  {
    "text": "on the vulnerable computers so we need",
    "start": "728390",
    "end": "730820"
  },
  {
    "text": "to examine the local admins on those",
    "start": "730820",
    "end": "732980"
  },
  {
    "text": "vulnerable computers and their log and",
    "start": "732980",
    "end": "735110"
  },
  {
    "text": "patterns and remove any redundant",
    "start": "735110",
    "end": "736940"
  },
  {
    "text": "members so the solution would be most",
    "start": "736940",
    "end": "739550"
  },
  {
    "text": "common for scenarios with vulnerable",
    "start": "739550",
    "end": "742490"
  },
  {
    "text": "machines that have constantly many high",
    "start": "742490",
    "end": "744770"
  },
  {
    "text": "privileged sessions but also many",
    "start": "744770",
    "end": "746720"
  },
  {
    "text": "inactive local admins so this shows us",
    "start": "746720",
    "end": "748880"
  },
  {
    "text": "that maybe that is the miss",
    "start": "748880",
    "end": "750410"
  },
  {
    "text": "configuration and that local admins",
    "start": "750410",
    "end": "752240"
  },
  {
    "text": "should not be present there so this is a",
    "start": "752240",
    "end": "753860"
  },
  {
    "text": "pretty simple change and remember that",
    "start": "753860",
    "end": "756080"
  },
  {
    "text": "every time you have a less privileged",
    "start": "756080",
    "end": "757970"
  },
  {
    "text": "domain account that has local admin",
    "start": "757970",
    "end": "759800"
  },
  {
    "text": "privileges on a vulnerable machine you",
    "start": "759800",
    "end": "761630"
  },
  {
    "text": "are adding additional attack paths in",
    "start": "761630",
    "end": "764030"
  },
  {
    "text": "the underlying graph now second thing",
    "start": "764030",
    "end": "767510"
  },
  {
    "text": "that we can do is both the easiest and",
    "start": "767510",
    "end": "769970"
  },
  {
    "text": "the hardest solution so it's easiest",
    "start": "769970",
    "end": "771500"
  },
  {
    "text": "because it doesn't require any extreme",
    "start": "771500",
    "end": "773870"
  },
  {
    "text": "changes to the environment however it",
    "start": "773870",
    "end": "776360"
  },
  {
    "text": "does deal with human behavior which",
    "start": "776360",
    "end": "778220"
  },
  {
    "text": "might be a bit trickier to change so",
    "start": "778220",
    "end": "780560"
  },
  {
    "text": "this one has to do with what our admins",
    "start": "780560",
    "end": "782630"
  },
  {
    "text": "doing the environment when they're",
    "start": "782630",
    "end": "783890"
  },
  {
    "text": "connecting to the vulnerable machines",
    "start": "783890",
    "end": "785590"
  },
  {
    "text": "first thing that we would like them to",
    "start": "785590",
    "end": "787820"
  },
  {
    "text": "do is to do it by using a network logon",
    "start": "787820",
    "end": "790220"
  },
  {
    "text": "and not for example interactive logon",
    "start": "790220",
    "end": "792320"
  },
  {
    "text": "in order to not expose the credentials",
    "start": "792320",
    "end": "794420"
  },
  {
    "text": "on the vulnerable machine that way the",
    "start": "794420",
    "end": "796820"
  },
  {
    "text": "credit",
    "start": "796820",
    "end": "797089"
  },
  {
    "text": "would not be stored on the target",
    "start": "797089",
    "end": "798860"
  },
  {
    "text": "machine another thing is simply log on",
    "start": "798860",
    "end": "802160"
  },
  {
    "text": "to the vulnerable machine by using a",
    "start": "802160",
    "end": "803749"
  },
  {
    "text": "less privileged domain account there are",
    "start": "803749",
    "end": "805639"
  },
  {
    "text": "many other local admins there perhaps",
    "start": "805639",
    "end": "807740"
  },
  {
    "text": "another one can be used to connect to",
    "start": "807740",
    "end": "809449"
  },
  {
    "text": "the computer",
    "start": "809449",
    "end": "810220"
  },
  {
    "text": "also when connecting by using remote",
    "start": "810220",
    "end": "813290"
  },
  {
    "text": "desktop use remote credential guard",
    "start": "813290",
    "end": "815240"
  },
  {
    "text": "again in that way the credentials of the",
    "start": "815240",
    "end": "817160"
  },
  {
    "text": "high privileged account would not be",
    "start": "817160",
    "end": "819110"
  },
  {
    "text": "stored on the target computer well as I",
    "start": "819110",
    "end": "822379"
  },
  {
    "text": "said this might be a bit trickier to",
    "start": "822379",
    "end": "824240"
  },
  {
    "text": "implement however if we create a ranking",
    "start": "824240",
    "end": "826519"
  },
  {
    "text": "which shows us which users are the most",
    "start": "826519",
    "end": "828920"
  },
  {
    "text": "problematic ones in the environment this",
    "start": "828920",
    "end": "831139"
  },
  {
    "text": "is something that might inspire a change",
    "start": "831139",
    "end": "832910"
  },
  {
    "text": "for those problematic admins now last",
    "start": "832910",
    "end": "837110"
  },
  {
    "text": "one is more of a side note which is",
    "start": "837110",
    "end": "838699"
  },
  {
    "text": "mostly relevant for security solutions",
    "start": "838699",
    "end": "840800"
  },
  {
    "text": "that have admin privileges on the",
    "start": "840800",
    "end": "842809"
  },
  {
    "text": "machine and what they can do is monitor",
    "start": "842809",
    "end": "845120"
  },
  {
    "text": "the sessions on the vulnerable computer",
    "start": "845120",
    "end": "847279"
  },
  {
    "text": "and disconnect any inactive sessions of",
    "start": "847279",
    "end": "849589"
  },
  {
    "text": "high privileged accounts in order to",
    "start": "849589",
    "end": "851480"
  },
  {
    "text": "remove them from the logon session and",
    "start": "851480",
    "end": "853129"
  },
  {
    "text": "delete it from the computer's memory now",
    "start": "853129",
    "end": "855230"
  },
  {
    "text": "this would be a bit trickier to",
    "start": "855230",
    "end": "857240"
  },
  {
    "text": "implement it requires a bit more work",
    "start": "857240",
    "end": "858740"
  },
  {
    "text": "but the first two are actually very easy",
    "start": "858740",
    "end": "861139"
  },
  {
    "text": "to implement you can do it in any",
    "start": "861139",
    "end": "862699"
  },
  {
    "text": "environment and just by implementing",
    "start": "862699",
    "end": "864740"
  },
  {
    "text": "those first two you will be removing the",
    "start": "864740",
    "end": "867110"
  },
  {
    "text": "vast majority of the attack path in the",
    "start": "867110",
    "end": "869420"
  },
  {
    "text": "underlying graph so I suggest that you",
    "start": "869420",
    "end": "871040"
  },
  {
    "text": "try to implement as many of those as",
    "start": "871040",
    "end": "873139"
  },
  {
    "text": "possible especially for the most",
    "start": "873139",
    "end": "875329"
  },
  {
    "text": "vulnerable notes that you find now we",
    "start": "875329",
    "end": "878629"
  },
  {
    "text": "know that no matter how much we try to",
    "start": "878629",
    "end": "880639"
  },
  {
    "text": "reduce the attack surface will not be",
    "start": "880639",
    "end": "883490"
  },
  {
    "text": "able to remove it entirely we'll still",
    "start": "883490",
    "end": "885649"
  },
  {
    "text": "have high privileged accounts logging",
    "start": "885649",
    "end": "887509"
  },
  {
    "text": "into computers that it shouldn't be",
    "start": "887509",
    "end": "889069"
  },
  {
    "text": "logging into or will have miss",
    "start": "889069",
    "end": "891740"
  },
  {
    "text": "configuration where a user adds local",
    "start": "891740",
    "end": "894379"
  },
  {
    "text": "admin to a vulnerable machine that",
    "start": "894379",
    "end": "895790"
  },
  {
    "text": "should have been present there the",
    "start": "895790",
    "end": "897230"
  },
  {
    "text": "question is what can we do with the",
    "start": "897230",
    "end": "899240"
  },
  {
    "text": "remaining attack path well we can hope",
    "start": "899240",
    "end": "901850"
  },
  {
    "text": "to detect them first let's begin with a",
    "start": "901850",
    "end": "905809"
  },
  {
    "text": "few definition before seeing the",
    "start": "905809",
    "end": "908179"
  },
  {
    "start": "908000",
    "end": "908000"
  },
  {
    "text": "detection itself so first we have a",
    "start": "908179",
    "end": "910850"
  },
  {
    "text": "logon graph so a logon graph is a graph",
    "start": "910850",
    "end": "913759"
  },
  {
    "text": "which consists of vertices which",
    "start": "913759",
    "end": "916069"
  },
  {
    "text": "represent the domain computers and the",
    "start": "916069",
    "end": "918740"
  },
  {
    "text": "edges represent the session between",
    "start": "918740",
    "end": "920480"
  },
  {
    "text": "those computers so every time a user",
    "start": "920480",
    "end": "923029"
  },
  {
    "text": "connects from source computer to a",
    "start": "923029",
    "end": "925129"
  },
  {
    "text": "target computer we would add a",
    "start": "925129",
    "end": "926990"
  },
  {
    "text": "corresponding directed edge in the graph",
    "start": "926990",
    "end": "929960"
  },
  {
    "text": "and add a label to the edge representing",
    "start": "929960",
    "end": "932480"
  },
  {
    "text": "the user which made that connection for",
    "start": "932480",
    "end": "935150"
  },
  {
    "text": "example here you can see that user one",
    "start": "935150",
    "end": "937550"
  },
  {
    "text": "connected from computer one to computer",
    "start": "937550",
    "end": "939770"
  },
  {
    "text": "three sorry computer two and then from",
    "start": "939770",
    "end": "941780"
  },
  {
    "text": "computer to computer three ok next and",
    "start": "941780",
    "end": "946370"
  },
  {
    "start": "945000",
    "end": "945000"
  },
  {
    "text": "last definition is the weighted logon",
    "start": "946370",
    "end": "948110"
  },
  {
    "text": "graph so this is the same as the",
    "start": "948110",
    "end": "950300"
  },
  {
    "text": "previous graph with addition an",
    "start": "950300",
    "end": "952100"
  },
  {
    "text": "additional parameter on the edge we're",
    "start": "952100",
    "end": "954650"
  },
  {
    "text": "adding a weight to every edge in the",
    "start": "954650",
    "end": "956510"
  },
  {
    "text": "graph and that edge and that weight",
    "start": "956510",
    "end": "959210"
  },
  {
    "text": "represents the probability of that user",
    "start": "959210",
    "end": "961520"
  },
  {
    "text": "performing that connection so we still",
    "start": "961520",
    "end": "964280"
  },
  {
    "text": "don't know how we compute this",
    "start": "964280",
    "end": "965450"
  },
  {
    "text": "probability this is just a definition",
    "start": "965450",
    "end": "966800"
  },
  {
    "text": "for example here you can see that the",
    "start": "966800",
    "end": "969110"
  },
  {
    "text": "probability of user one connecting from",
    "start": "969110",
    "end": "971510"
  },
  {
    "text": "computer one to computer - it's pretty",
    "start": "971510",
    "end": "973250"
  },
  {
    "text": "high it's zero point nine however the",
    "start": "973250",
    "end": "976310"
  },
  {
    "text": "probability of the same user connecting",
    "start": "976310",
    "end": "978110"
  },
  {
    "text": "from computer to computer three it's",
    "start": "978110",
    "end": "980150"
  },
  {
    "text": "pretty low it's just zero point zero",
    "start": "980150",
    "end": "981800"
  },
  {
    "text": "five okay so this is just an example",
    "start": "981800",
    "end": "984770"
  },
  {
    "text": "let's see how those definitions have",
    "start": "984770",
    "end": "987020"
  },
  {
    "text": "anything to do with detecting an attack",
    "start": "987020",
    "end": "990370"
  },
  {
    "text": "alright so first thing that we need to",
    "start": "990370",
    "end": "992660"
  },
  {
    "text": "do is to compute a weighted log on graph",
    "start": "992660",
    "end": "995120"
  },
  {
    "text": "so this is something which would be",
    "start": "995120",
    "end": "996860"
  },
  {
    "text": "constructed based on the logon",
    "start": "996860",
    "end": "998810"
  },
  {
    "text": "activities of the users in our",
    "start": "998810",
    "end": "1000760"
  },
  {
    "text": "environment during some learning period",
    "start": "1000760",
    "end": "1002920"
  },
  {
    "text": "so we'll have a month or two month in",
    "start": "1002920",
    "end": "1005290"
  },
  {
    "text": "which we study the behavior of all the",
    "start": "1005290",
    "end": "1007090"
  },
  {
    "text": "users and then we compute the weight of",
    "start": "1007090",
    "end": "1010180"
  },
  {
    "text": "the end of every edge based on the",
    "start": "1010180",
    "end": "1012730"
  },
  {
    "text": "activities of that users between the two",
    "start": "1012730",
    "end": "1014560"
  },
  {
    "text": "computers meaning if the user frequently",
    "start": "1014560",
    "end": "1017200"
  },
  {
    "text": "connects from one computer to the other",
    "start": "1017200",
    "end": "1019120"
  },
  {
    "text": "the corresponding edge would get a high",
    "start": "1019120",
    "end": "1021760"
  },
  {
    "text": "probability and if there's a connection",
    "start": "1021760",
    "end": "1024010"
  },
  {
    "text": "that the user rarely makes or he never",
    "start": "1024010",
    "end": "1026920"
  },
  {
    "text": "connected to the machine then the",
    "start": "1026920",
    "end": "1028480"
  },
  {
    "text": "corresponding edge would be given a low",
    "start": "1028480",
    "end": "1030910"
  },
  {
    "text": "or a zero probability second thing we",
    "start": "1030910",
    "end": "1035260"
  },
  {
    "text": "need is the daily log on RAM so this is",
    "start": "1035260",
    "end": "1037540"
  },
  {
    "text": "something that is constructed based on",
    "start": "1037540",
    "end": "1039310"
  },
  {
    "text": "the logon activities of all the users on",
    "start": "1039310",
    "end": "1041500"
  },
  {
    "text": "a given day after the learning period so",
    "start": "1041500",
    "end": "1044380"
  },
  {
    "text": "first stage that we do is we take all",
    "start": "1044380",
    "end": "1046420"
  },
  {
    "text": "the logon activities during that day and",
    "start": "1046420",
    "end": "1048490"
  },
  {
    "text": "construct a regular logon graph so every",
    "start": "1048490",
    "end": "1051430"
  },
  {
    "text": "time user connects to a machine",
    "start": "1051430",
    "end": "1052990"
  },
  {
    "text": "we had a corresponding edge in the graph",
    "start": "1052990",
    "end": "1055030"
  },
  {
    "text": "in the second stage we will remove all",
    "start": "1055030",
    "end": "1058300"
  },
  {
    "text": "the edges which were aside a high weight",
    "start": "1058300",
    "end": "1060940"
  },
  {
    "text": "in the weighted graph that we computed",
    "start": "1060940",
    "end": "1062620"
  },
  {
    "text": "in a previous stage basically we want to",
    "start": "1062620",
    "end": "1064750"
  },
  {
    "text": "remove all the edges that we expect to",
    "start": "1064750",
    "end": "1067060"
  },
  {
    "text": "see on the given on a given day and only",
    "start": "1067060",
    "end": "1069130"
  },
  {
    "text": "be left with the edges that are less",
    "start": "1069130",
    "end": "1070720"
  },
  {
    "text": "likely to appear in our environment and",
    "start": "1070720",
    "end": "1072940"
  },
  {
    "text": "on that graph you try to detect",
    "start": "1072940",
    "end": "1074950"
  },
  {
    "text": "anomalies which might indicate that an",
    "start": "1074950",
    "end": "1077080"
  },
  {
    "text": "attack might be going on right then then",
    "start": "1077080",
    "end": "1080980"
  },
  {
    "text": "as I said we'll try to detect anomalies",
    "start": "1080980",
    "end": "1082780"
  },
  {
    "text": "based on that graph so which structures",
    "start": "1082780",
    "end": "1087190"
  },
  {
    "text": "should we be looking for in that graph",
    "start": "1087190",
    "end": "1089550"
  },
  {
    "text": "first interesting structure is a star",
    "start": "1089550",
    "end": "1092560"
  },
  {
    "text": "structures so that would be a computer",
    "start": "1092560",
    "end": "1094210"
  },
  {
    "text": "with many outgoing edges to other",
    "start": "1094210",
    "end": "1096820"
  },
  {
    "text": "computers all right so this is something",
    "start": "1096820",
    "end": "1102400"
  },
  {
    "text": "that might indicate reconnaissance",
    "start": "1102400",
    "end": "1104260"
  },
  {
    "text": "activities an attacker that is scanning",
    "start": "1104260",
    "end": "1106180"
  },
  {
    "text": "the network trying to access to as many",
    "start": "1106180",
    "end": "1108550"
  },
  {
    "text": "computers as possible and gather as much",
    "start": "1108550",
    "end": "1111250"
  },
  {
    "text": "information from other domain machines",
    "start": "1111250",
    "end": "1112990"
  },
  {
    "text": "for example if you run bloodhound this",
    "start": "1112990",
    "end": "1115960"
  },
  {
    "text": "is the structure that you'll expect to",
    "start": "1115960",
    "end": "1117730"
  },
  {
    "text": "see in the graph so in that case all the",
    "start": "1117730",
    "end": "1121390"
  },
  {
    "text": "edges would be assigned a label that",
    "start": "1121390",
    "end": "1123250"
  },
  {
    "text": "correspond to the same user also it can",
    "start": "1123250",
    "end": "1126430"
  },
  {
    "text": "be a main attack machine that the",
    "start": "1126430",
    "end": "1128140"
  },
  {
    "text": "attacker is using to connect to more",
    "start": "1128140",
    "end": "1129910"
  },
  {
    "text": "domain computers extract more",
    "start": "1129910",
    "end": "1131800"
  },
  {
    "text": "credentials and use them to connect to",
    "start": "1131800",
    "end": "1134290"
  },
  {
    "text": "other machines now in that case every",
    "start": "1134290",
    "end": "1136330"
  },
  {
    "text": "edge might get a user which might get a",
    "start": "1136330",
    "end": "1139630"
  },
  {
    "text": "label which represents a different user",
    "start": "1139630",
    "end": "1143640"
  },
  {
    "text": "next interesting structures that will",
    "start": "1143670",
    "end": "1146020"
  },
  {
    "text": "search for are suspicious chains so",
    "start": "1146020",
    "end": "1149230"
  },
  {
    "text": "those are consecutive edges which were",
    "start": "1149230",
    "end": "1151660"
  },
  {
    "text": "assigned a low probability so for",
    "start": "1151660",
    "end": "1155110"
  },
  {
    "text": "example this might indicate lateral",
    "start": "1155110",
    "end": "1157030"
  },
  {
    "text": "movement activities going on in our",
    "start": "1157030",
    "end": "1158770"
  },
  {
    "text": "environment and if you run go fetch this",
    "start": "1158770",
    "end": "1160780"
  },
  {
    "text": "is the structure that you'll expect to",
    "start": "1160780",
    "end": "1162430"
  },
  {
    "text": "see in the graph or it can be also a",
    "start": "1162430",
    "end": "1166240"
  },
  {
    "text": "combination of the two it can be an",
    "start": "1166240",
    "end": "1167740"
  },
  {
    "text": "attacker that started with",
    "start": "1167740",
    "end": "1169720"
  },
  {
    "text": "reconnaissance and then moving on to",
    "start": "1169720",
    "end": "1171970"
  },
  {
    "text": "perform lateral and movement activities",
    "start": "1171970",
    "end": "1173770"
  },
  {
    "text": "from one of the computers alright so",
    "start": "1173770",
    "end": "1176620"
  },
  {
    "text": "that was a lot of theoretical talk let's",
    "start": "1176620",
    "end": "1178480"
  },
  {
    "text": "see an example from a real environment",
    "start": "1178480",
    "end": "1180960"
  },
  {
    "text": "so here you can see the daily logon",
    "start": "1180960",
    "end": "1183700"
  },
  {
    "start": "1181000",
    "end": "1181000"
  },
  {
    "text": "graph that I got from a real environment",
    "start": "1183700",
    "end": "1185770"
  },
  {
    "text": "those are only the edges that happen",
    "start": "1185770",
    "end": "1188740"
  },
  {
    "text": "during a day that were signed a low",
    "start": "1188740",
    "end": "1190930"
  },
  {
    "text": "probability and as you can see there's",
    "start": "1190930",
    "end": "1193390"
  },
  {
    "text": "two",
    "start": "1193390",
    "end": "1193779"
  },
  {
    "text": "data here it's hard to find anomalies",
    "start": "1193779",
    "end": "1195279"
  },
  {
    "text": "based on this graph and we need to find",
    "start": "1195279",
    "end": "1197559"
  },
  {
    "text": "a way to filter out the benign",
    "start": "1197559",
    "end": "1199029"
  },
  {
    "text": "activities now let's see different ways",
    "start": "1199029",
    "end": "1201129"
  },
  {
    "text": "in which we can do this first thing that",
    "start": "1201129",
    "end": "1205149"
  },
  {
    "text": "we can do is remove connected components",
    "start": "1205149",
    "end": "1207489"
  },
  {
    "text": "that consists of only two nodes so those",
    "start": "1207489",
    "end": "1210759"
  },
  {
    "text": "will be the cases where we just have two",
    "start": "1210759",
    "end": "1212679"
  },
  {
    "text": "nodes connected by a single edge without",
    "start": "1212679",
    "end": "1215080"
  },
  {
    "text": "any additional connection so it's a very",
    "start": "1215080",
    "end": "1217210"
  },
  {
    "text": "counter for user to connect to at least",
    "start": "1217210",
    "end": "1219039"
  },
  {
    "text": "one new resource on a given day so",
    "start": "1219039",
    "end": "1221320"
  },
  {
    "text": "that's not very interesting however as",
    "start": "1221320",
    "end": "1224109"
  },
  {
    "text": "you can see we still have too much data",
    "start": "1224109",
    "end": "1226330"
  },
  {
    "text": "and we need to keep filtering it out",
    "start": "1226330",
    "end": "1229289"
  },
  {
    "text": "next thing that I did is I decided to",
    "start": "1229289",
    "end": "1231999"
  },
  {
    "text": "use different features for every",
    "start": "1231999",
    "end": "1234249"
  },
  {
    "text": "structure that I was looking for so here",
    "start": "1234249",
    "end": "1236169"
  },
  {
    "text": "I'll show you how I was able to find the",
    "start": "1236169",
    "end": "1238359"
  },
  {
    "text": "suspicious chain in the environment and",
    "start": "1238359",
    "end": "1240099"
  },
  {
    "text": "in order to do that I removed all the",
    "start": "1240099",
    "end": "1242649"
  },
  {
    "text": "star structures that were not leading to",
    "start": "1242649",
    "end": "1244629"
  },
  {
    "text": "any lateral movement activity again as",
    "start": "1244629",
    "end": "1247359"
  },
  {
    "text": "you can see we still need to keep",
    "start": "1247359",
    "end": "1248769"
  },
  {
    "text": "filtering the data so let's see some",
    "start": "1248769",
    "end": "1250929"
  },
  {
    "text": "more ways in which we can do this so",
    "start": "1250929",
    "end": "1253719"
  },
  {
    "text": "some more things that I did is take into",
    "start": "1253719",
    "end": "1255820"
  },
  {
    "text": "account new users and computers which",
    "start": "1255820",
    "end": "1258009"
  },
  {
    "text": "are added to the environment also take a",
    "start": "1258009",
    "end": "1260440"
  },
  {
    "text": "look at the computer resource popularity",
    "start": "1260440",
    "end": "1262599"
  },
  {
    "text": "meaning how many users connect to the",
    "start": "1262599",
    "end": "1264489"
  },
  {
    "text": "computer on a given day and all those",
    "start": "1264489",
    "end": "1266889"
  },
  {
    "text": "high privileged users or not also I took",
    "start": "1266889",
    "end": "1270129"
  },
  {
    "text": "into account peers behavior so peers are",
    "start": "1270129",
    "end": "1273009"
  },
  {
    "text": "users that have similar permissions and",
    "start": "1273009",
    "end": "1275229"
  },
  {
    "text": "access similar resources so if the user",
    "start": "1275229",
    "end": "1277899"
  },
  {
    "text": "accesses a resource whose peers",
    "start": "1277899",
    "end": "1280119"
  },
  {
    "text": "constantly access as well it would not",
    "start": "1280119",
    "end": "1282190"
  },
  {
    "text": "be considered as suspicious so as you",
    "start": "1282190",
    "end": "1284710"
  },
  {
    "text": "can see when using those features I was",
    "start": "1284710",
    "end": "1286690"
  },
  {
    "text": "able to get a graph which looks a lot",
    "start": "1286690",
    "end": "1288489"
  },
  {
    "text": "better however it's still not good",
    "start": "1288489",
    "end": "1290440"
  },
  {
    "text": "enough since we can't start",
    "start": "1290440",
    "end": "1291879"
  },
  {
    "text": "investigating every edge here so since",
    "start": "1291879",
    "end": "1294700"
  },
  {
    "text": "we're looking for suspicious change",
    "start": "1294700",
    "end": "1296379"
  },
  {
    "text": "those are the ones that might represent",
    "start": "1296379",
    "end": "1298269"
  },
  {
    "text": "a lateral movement activity this is the",
    "start": "1298269",
    "end": "1300999"
  },
  {
    "text": "last feature that really sealed the deal",
    "start": "1300999",
    "end": "1303119"
  },
  {
    "text": "so only considered connection when the",
    "start": "1303119",
    "end": "1306190"
  },
  {
    "text": "user that performs a connection is a",
    "start": "1306190",
    "end": "1308109"
  },
  {
    "text": "local admin on the target computer this",
    "start": "1308109",
    "end": "1310659"
  },
  {
    "text": "would be usually the case when we're",
    "start": "1310659",
    "end": "1312159"
  },
  {
    "text": "talking about lateral movement",
    "start": "1312159",
    "end": "1313479"
  },
  {
    "text": "activities and as you can see the data",
    "start": "1313479",
    "end": "1315789"
  },
  {
    "text": "looks a lot better we only have two sub",
    "start": "1315789",
    "end": "1318429"
  },
  {
    "text": "graphs left so the one on the top is",
    "start": "1318429",
    "end": "1320619"
  },
  {
    "text": "benign and it's not it's not a",
    "start": "1320619",
    "end": "1322599"
  },
  {
    "text": "suspicious change simply to computers",
    "start": "1322599",
    "end": "1324249"
  },
  {
    "text": "connecting to the same one so that could",
    "start": "1324249",
    "end": "1325929"
  },
  {
    "text": "be easily filtered",
    "start": "1325929",
    "end": "1327280"
  },
  {
    "text": "out and the second one is a chain as a",
    "start": "1327280",
    "end": "1331210"
  },
  {
    "text": "species chain which consists of two",
    "start": "1331210",
    "end": "1332950"
  },
  {
    "text": "edges and this was actually a lateral",
    "start": "1332950",
    "end": "1335830"
  },
  {
    "text": "movement activity which was performed in",
    "start": "1335830",
    "end": "1338230"
  },
  {
    "text": "the environment as part of a testing",
    "start": "1338230",
    "end": "1339760"
  },
  {
    "text": "scenario and we found a credentials",
    "start": "1339760",
    "end": "1342280"
  },
  {
    "text": "dumping tool on the computer in the",
    "start": "1342280",
    "end": "1344320"
  },
  {
    "text": "middle so that was pretty cool so in a",
    "start": "1344320",
    "end": "1346900"
  },
  {
    "text": "very similar way you can either use all",
    "start": "1346900",
    "end": "1349300"
  },
  {
    "text": "the features a part of them add some new",
    "start": "1349300",
    "end": "1351820"
  },
  {
    "text": "ones and also detect suspicious star",
    "start": "1351820",
    "end": "1354310"
  },
  {
    "text": "structures in the environment as well so",
    "start": "1354310",
    "end": "1357700"
  },
  {
    "start": "1357000",
    "end": "1357000"
  },
  {
    "text": "what are the pros and cons of this",
    "start": "1357700",
    "end": "1359500"
  },
  {
    "text": "approach first of all some of the pros",
    "start": "1359500",
    "end": "1361840"
  },
  {
    "text": "in order to fully avoid detection",
    "start": "1361840",
    "end": "1363570"
  },
  {
    "text": "attackers need to be aware of all the",
    "start": "1363570",
    "end": "1365980"
  },
  {
    "text": "behavior of all the entities in the",
    "start": "1365980",
    "end": "1367870"
  },
  {
    "text": "environment in order to not generate",
    "start": "1367870",
    "end": "1369610"
  },
  {
    "text": "those edges which would be assigned a",
    "start": "1369610",
    "end": "1371680"
  },
  {
    "text": "low probability so this is pretty hard",
    "start": "1371680",
    "end": "1373660"
  },
  {
    "text": "for an attacker also it allows us to",
    "start": "1373660",
    "end": "1376450"
  },
  {
    "text": "detect paths which involve multiple",
    "start": "1376450",
    "end": "1378610"
  },
  {
    "text": "users I've either in the start",
    "start": "1378610",
    "end": "1380860"
  },
  {
    "text": "structures or in the chain structures it",
    "start": "1380860",
    "end": "1383950"
  },
  {
    "text": "can help us detect both outsider and",
    "start": "1383950",
    "end": "1386080"
  },
  {
    "text": "insider threats so it can be a user that",
    "start": "1386080",
    "end": "1388060"
  },
  {
    "text": "starts accessing resources that he",
    "start": "1388060",
    "end": "1390250"
  },
  {
    "text": "shouldn't be accessing and last thing is",
    "start": "1390250",
    "end": "1393250"
  },
  {
    "text": "that it can be in corporate incorporated",
    "start": "1393250",
    "end": "1395620"
  },
  {
    "text": "with data that we have from the",
    "start": "1395620",
    "end": "1397150"
  },
  {
    "text": "endpoints in order to strengthen our",
    "start": "1397150",
    "end": "1399460"
  },
  {
    "text": "certainty in the signal and understand",
    "start": "1399460",
    "end": "1402040"
  },
  {
    "text": "whether we are dealing with a benign",
    "start": "1402040",
    "end": "1403810"
  },
  {
    "text": "activity or an actual attack so we can",
    "start": "1403810",
    "end": "1407440"
  },
  {
    "text": "take a look at what was going on and",
    "start": "1407440",
    "end": "1409000"
  },
  {
    "text": "that source of the start structure or",
    "start": "1409000",
    "end": "1411070"
  },
  {
    "text": "any machine in the suspicious chain to",
    "start": "1411070",
    "end": "1413050"
  },
  {
    "text": "understand what exactly happened some of",
    "start": "1413050",
    "end": "1416050"
  },
  {
    "text": "the cons first of all if the attack",
    "start": "1416050",
    "end": "1417820"
  },
  {
    "text": "responds to an entity's usual behavior",
    "start": "1417820",
    "end": "1419800"
  },
  {
    "text": "it would be harder to detect since we",
    "start": "1419800",
    "end": "1422020"
  },
  {
    "text": "are relying on the fact that we would",
    "start": "1422020",
    "end": "1423670"
  },
  {
    "text": "have edges that would be assigned a low",
    "start": "1423670",
    "end": "1425320"
  },
  {
    "text": "probability second is regarding the wait",
    "start": "1425320",
    "end": "1428230"
  },
  {
    "text": "threshold which edges do we want to keep",
    "start": "1428230",
    "end": "1430720"
  },
  {
    "text": "in our daily logon graph so if we set it",
    "start": "1430720",
    "end": "1433000"
  },
  {
    "text": "to be too high we might get more false",
    "start": "1433000",
    "end": "1435640"
  },
  {
    "text": "positives if we set it too low we might",
    "start": "1435640",
    "end": "1437980"
  },
  {
    "text": "miss real attacks so we need to find the",
    "start": "1437980",
    "end": "1439660"
  },
  {
    "text": "ideal value here for your environment",
    "start": "1439660",
    "end": "1441990"
  },
  {
    "text": "last thing is that it's harder to detect",
    "start": "1441990",
    "end": "1445150"
  },
  {
    "text": "scattered attacks cases in which an",
    "start": "1445150",
    "end": "1447520"
  },
  {
    "text": "attacker connects from one computer to",
    "start": "1447520",
    "end": "1449290"
  },
  {
    "text": "another by using one user then",
    "start": "1449290",
    "end": "1451780"
  },
  {
    "text": "connecting from a completely unrelated",
    "start": "1451780",
    "end": "1453640"
  },
  {
    "text": "machine to another computer by using",
    "start": "1453640",
    "end": "1455200"
  },
  {
    "text": "another user so those are less common",
    "start": "1455200",
    "end": "1457600"
  },
  {
    "text": "but they're still possible and need to",
    "start": "1457600",
    "end": "1459580"
  },
  {
    "text": "be aware of those",
    "start": "1459580",
    "end": "1461080"
  },
  {
    "text": "well if we weren't able to detect an",
    "start": "1461080",
    "end": "1464180"
  },
  {
    "text": "attack by using this method no method",
    "start": "1464180",
    "end": "1466040"
  },
  {
    "text": "can detect everything what can we do",
    "start": "1466040",
    "end": "1468140"
  },
  {
    "text": "well we can always use graphs to help us",
    "start": "1468140",
    "end": "1470660"
  },
  {
    "text": "investigate what happened so just very",
    "start": "1470660",
    "end": "1473600"
  },
  {
    "text": "briefly what we can do is take all the",
    "start": "1473600",
    "end": "1476900"
  },
  {
    "start": "1474000",
    "end": "1474000"
  },
  {
    "text": "known compromised machines and users and",
    "start": "1476900",
    "end": "1479800"
  },
  {
    "text": "construct a logon graph based on those",
    "start": "1479800",
    "end": "1482360"
  },
  {
    "text": "entities so that can help us understand",
    "start": "1482360",
    "end": "1485210"
  },
  {
    "text": "what was the attack path the attacker",
    "start": "1485210",
    "end": "1487490"
  },
  {
    "text": "took maybe discover the source of the",
    "start": "1487490",
    "end": "1490280"
  },
  {
    "text": "attack and even discover additional",
    "start": "1490280",
    "end": "1491990"
  },
  {
    "text": "accounts which may have been compromised",
    "start": "1491990",
    "end": "1494030"
  },
  {
    "text": "during the attack since we know which",
    "start": "1494030",
    "end": "1495950"
  },
  {
    "text": "users were logged on to every computer",
    "start": "1495950",
    "end": "1498290"
  },
  {
    "text": "at that time alright let's see some of",
    "start": "1498290",
    "end": "1502640"
  },
  {
    "text": "the conclusions we know that attackers",
    "start": "1502640",
    "end": "1505100"
  },
  {
    "text": "have access to limited data sources",
    "start": "1505100",
    "end": "1507380"
  },
  {
    "text": "however they're still able to leverage",
    "start": "1507380",
    "end": "1509900"
  },
  {
    "text": "graphs and create a partial graph which",
    "start": "1509900",
    "end": "1512540"
  },
  {
    "text": "would help them to gain very valuable",
    "start": "1512540",
    "end": "1514340"
  },
  {
    "text": "insights into our environment and help",
    "start": "1514340",
    "end": "1516710"
  },
  {
    "text": "them find a path that would allow them",
    "start": "1516710",
    "end": "1518960"
  },
  {
    "text": "to compromise high privileged accounts",
    "start": "1518960",
    "end": "1520880"
  },
  {
    "text": "so even though they're working with",
    "start": "1520880",
    "end": "1522980"
  },
  {
    "text": "limited data and permissions they're",
    "start": "1522980",
    "end": "1524990"
  },
  {
    "text": "still able to target those domain",
    "start": "1524990",
    "end": "1527210"
  },
  {
    "text": "administrative accounts in our",
    "start": "1527210",
    "end": "1528530"
  },
  {
    "text": "environment as we've seen however",
    "start": "1528530",
    "end": "1530510"
  },
  {
    "text": "defenders have access to unlimited data",
    "start": "1530510",
    "end": "1533180"
  },
  {
    "text": "sources so we have so much more data and",
    "start": "1533180",
    "end": "1535520"
  },
  {
    "text": "we need to use it accordingly we saw how",
    "start": "1535520",
    "end": "1538040"
  },
  {
    "text": "this data can be used to create much",
    "start": "1538040",
    "end": "1540350"
  },
  {
    "text": "more informative graphs that can help us",
    "start": "1540350",
    "end": "1542570"
  },
  {
    "text": "in attack prevention we saw how we can",
    "start": "1542570",
    "end": "1545330"
  },
  {
    "text": "detect the most vulnerable nodes that we",
    "start": "1545330",
    "end": "1546950"
  },
  {
    "text": "have in our environment and disconnect",
    "start": "1546950",
    "end": "1548630"
  },
  {
    "text": "them from the attack graph we saw how it",
    "start": "1548630",
    "end": "1551150"
  },
  {
    "text": "can help us for detecting an attack",
    "start": "1551150",
    "end": "1553310"
  },
  {
    "text": "which might be performing reconnaissance",
    "start": "1553310",
    "end": "1555260"
  },
  {
    "text": "or lateral movement activities and",
    "start": "1555260",
    "end": "1557120"
  },
  {
    "text": "finally we saw how they can help us for",
    "start": "1557120",
    "end": "1559730"
  },
  {
    "text": "investigating an attack so hopefully you",
    "start": "1559730",
    "end": "1562190"
  },
  {
    "text": "can start looking into how you can",
    "start": "1562190",
    "end": "1563420"
  },
  {
    "text": "incorporate some of those ideas in your",
    "start": "1563420",
    "end": "1565580"
  },
  {
    "text": "environment thank you",
    "start": "1565580",
    "end": "1568460"
  },
  {
    "text": "[Applause]",
    "start": "1568460",
    "end": "1569930"
  },
  {
    "text": "[Music]",
    "start": "1569930",
    "end": "1572140"
  },
  {
    "text": "[Applause]",
    "start": "1572140",
    "end": "1575859"
  }
]