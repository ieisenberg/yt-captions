[
  {
    "text": "this is Augustus five and six with home invasion version 2 point 0 attacking",
    "start": "0",
    "end": "5069"
  },
  {
    "text": "network controlled hardware by Daniel Crowley David Bryan and Jennifer savage",
    "start": "5069",
    "end": "10260"
  },
  {
    "text": "hi everybody so we're going to be talking about we're gonna be talking about smart home technologies and for",
    "start": "10260",
    "end": "16680"
  },
  {
    "text": "those not familiar with the term it's basically just sort of a blanket term describing technologies that hook hook",
    "start": "16680",
    "end": "23640"
  },
  {
    "text": "up sort of non-traditional stuff in your home to a network so things like door",
    "start": "23640",
    "end": "29760"
  },
  {
    "text": "locks all lights garage doors window blinds things like that so whereas home",
    "start": "29760",
    "end": "35700"
  },
  {
    "text": "invasion 1 point 0 would be some guy busting in your window and unlocking your door and stealing your stuff home",
    "start": "35700",
    "end": "42480"
  },
  {
    "text": "invasion version 2.0 is you know remote it's not physical or maybe there is a",
    "start": "42480",
    "end": "49800"
  },
  {
    "text": "physical aspect but we'll get more into that as the talk progresses so first we want to talk about who we are and why",
    "start": "49800",
    "end": "55590"
  },
  {
    "text": "you should listen to us as opposed to some guy off the street who's selling water bottles so my name is Daniel",
    "start": "55590",
    "end": "62969"
  },
  {
    "text": "Crowley and I'm a managing consultant with the spiderlabs team at trustwave",
    "start": "62969",
    "end": "68119"
  },
  {
    "text": "and I'm Jennifer savage i work at tabbed",
    "start": "68119",
    "end": "75180"
  },
  {
    "text": "out in the software engineer and security person there we make a mobile app that lets you pay your bar tab with",
    "start": "75180",
    "end": "81630"
  },
  {
    "text": "your cell phone I'm David Bryan senior",
    "start": "81630",
    "end": "87270"
  },
  {
    "text": "security consultant for Trustwave spiderlabs I do pen testing and all sorts of fun stuff for a living so so",
    "start": "87270",
    "end": "96360"
  },
  {
    "text": "why are we here what are we doing here what's the point of us being up on stage well like I said we're talking about the",
    "start": "96360",
    "end": "102750"
  },
  {
    "text": "smart home and so there's a there's a couple different types of science fiction but one of my favorite is the",
    "start": "102750",
    "end": "109200"
  },
  {
    "text": "dystopian science fiction and dystopian science fiction refers to a type of science fiction that is about how",
    "start": "109200",
    "end": "116610"
  },
  {
    "text": "technology can go wrong either technology that exists or technology that has yet to exist and one thing",
    "start": "116610",
    "end": "122640"
  },
  {
    "text": "about science fiction is that science fiction almost always precede science fact nearly all you have a cell phone in",
    "start": "122640",
    "end": "128879"
  },
  {
    "text": "your pocket right now and that was preceded by the Star Trek commune Decatur's and so that if the guy who",
    "start": "128879",
    "end": "136200"
  },
  {
    "text": "invented the cell phone actually cited that as a part of the reason that he made came up with the idea of the cell",
    "start": "136200",
    "end": "142500"
  },
  {
    "text": "phone so science fiction often precedes science fact sometimes the warnings",
    "start": "142500",
    "end": "149850"
  },
  {
    "text": "provided by science fiction dystopian science fiction are well heated and sometimes they're not and unfortunately",
    "start": "149850",
    "end": "156330"
  },
  {
    "text": "in this case it seems like people aren't paying attention to the to the warnings",
    "start": "156330",
    "end": "162480"
  },
  {
    "text": "here we took a look at a bunch of different devices not all of the devices",
    "start": "162480",
    "end": "168120"
  },
  {
    "text": "on the market because there are a lot of them and there's a lot of ground to cover but we just took a sampling of",
    "start": "168120",
    "end": "173580"
  },
  {
    "text": "them and we found flaws in nearly everything we took a look at but some of the notable things that we didn't take",
    "start": "173580",
    "end": "178800"
  },
  {
    "text": "that we that we won't be covering in this talk there's an android-powered oven out there there are smart TVs and",
    "start": "178800",
    "end": "186270"
  },
  {
    "text": "there are actually talks that cover those that I think already happened and then IP security cameras things like",
    "start": "186270",
    "end": "193410"
  },
  {
    "text": "that so there's a bunch of different stuff out there that we didn't talk about so this is just a sampling but so",
    "start": "193410",
    "end": "200670"
  },
  {
    "text": "yeah we tried to just pick things that would be in different rooms in a modern smart home so a few of the things that",
    "start": "200670",
    "end": "210750"
  },
  {
    "text": "are out there now our locks thermostats there's even a fridge there's a toilet lights and toys but in the future there",
    "start": "210750",
    "end": "220110"
  },
  {
    "text": "will be entire smart cities they're working on one now it's called Songdo it's in south korea cisco is building it",
    "start": "220110",
    "end": "227660"
  },
  {
    "text": "then the networking for it it's being built from the ground up to be a smart city you'll be able to walk up to a",
    "start": "227660",
    "end": "233850"
  },
  {
    "text": "window press a button and call your kids at home it'll be a playground for",
    "start": "233850",
    "end": "239790"
  },
  {
    "text": "hackers so I want to talk today about a",
    "start": "239790",
    "end": "245970"
  },
  {
    "text": "toy that was in my daughter's room for some number of months I found this thing on binky and I thought it was really",
    "start": "245970",
    "end": "252030"
  },
  {
    "text": "cute and it would be extremely useful it has a video camera a microphone so you",
    "start": "252030",
    "end": "260640"
  },
  {
    "text": "can check on your kids it has speakers plays music it can wake you up in the morning it has an RF",
    "start": "260640",
    "end": "266510"
  },
  {
    "text": "d chip and they sell little accessory bunny rabbits that are have RFID chips",
    "start": "266510",
    "end": "273800"
  },
  {
    "text": "in them that you can hold up to the RFID reader on the on the bunny and it'll respond it also has ears that move and",
    "start": "273800",
    "end": "280520"
  },
  {
    "text": "an LED in its belly button eventually I",
    "start": "280520",
    "end": "293870"
  },
  {
    "text": "realized I should probably evaluate the security of this toy that was in my daughter's room and what I found was",
    "start": "293870",
    "end": "301430"
  },
  {
    "text": "that there was so first of all I knew this at the time that I downloaded the the Wi-Fi setup script but there was",
    "start": "301430",
    "end": "307340"
  },
  {
    "text": "exposure of my Wi-Fi network credentials unencrypted to the carrot servers in",
    "start": "307340",
    "end": "312500"
  },
  {
    "text": "order to download the Wi-Fi setup script you have to go to their website enter in your SSID and password and then it",
    "start": "312500",
    "end": "319130"
  },
  {
    "text": "generates the setup script and downloads it in order to communicate with the",
    "start": "319130",
    "end": "325910"
  },
  {
    "text": "carrot servers it uses completely plain text API calls no ssl whatsoever so they",
    "start": "325910",
    "end": "334370"
  },
  {
    "text": "can B's dropped on the setup package download also happens unencrypted the",
    "start": "334370",
    "end": "339410"
  },
  {
    "text": "code is signed but there's a way around the signing using a technique I call python module hijacking and I'll go over",
    "start": "339410",
    "end": "346760"
  },
  {
    "text": "that in a moment so here we have an example of eavesdropping on one of the",
    "start": "346760",
    "end": "353030"
  },
  {
    "text": "API calls you can see here that this is getting the webcam action so webcam ?",
    "start": "353030",
    "end": "361490"
  },
  {
    "text": "action equals video and then after that you see a token that token is one time",
    "start": "361490",
    "end": "367190"
  },
  {
    "text": "use it's from start till you send a stop packet and then every time you want to",
    "start": "367190",
    "end": "374120"
  },
  {
    "text": "connect and use the API again you have to talk the carrot servers and get any token however if you are eavesdropping",
    "start": "374120",
    "end": "381560"
  },
  {
    "text": "on the communication because it doesn't happen over SSL you can just steal the token and access the video feed in your",
    "start": "381560",
    "end": "391220"
  },
  {
    "text": "web browser where's the okay all right so I'll show you a video that in a",
    "start": "391220",
    "end": "397520"
  },
  {
    "text": "moment so here's the Python module hijacking explanation so Python module hijacking",
    "start": "397520",
    "end": "403010"
  },
  {
    "text": "it works very similar to LD preload or DLL hijacking so essentially in Python",
    "start": "403010",
    "end": "409820"
  },
  {
    "text": "you have something called the Python path and it's a list of directories that Python will look for the modules in in",
    "start": "409820",
    "end": "417740"
  },
  {
    "text": "order to load them so if you have a module that you're using in your Python",
    "start": "417740",
    "end": "423230"
  },
  {
    "text": "script it will first look in the current directory of the script that is being",
    "start": "423230",
    "end": "429170"
  },
  {
    "text": "run and then it'll look in a series of other directories listed in the pie pythonpath most languages have fixed",
    "start": "429170",
    "end": "439040"
  },
  {
    "text": "this bub a lot of languages were doing this for instance for with DLL hijacking",
    "start": "439040",
    "end": "445100"
  },
  {
    "text": "actually the operating windows operating system was doing this their fix was to move the current working directory to",
    "start": "445100",
    "end": "451310"
  },
  {
    "text": "the end of the path of the the search path so anyway all you have to do to",
    "start": "451310",
    "end": "458060"
  },
  {
    "text": "perform a python module hijacking attack is create a python script that's the name of the module place it in the same",
    "start": "458060",
    "end": "464600"
  },
  {
    "text": "directory as the scripting question and when the script executes it will execute your module instead of the intended one",
    "start": "464600",
    "end": "471580"
  },
  {
    "text": "now the carrots autorun Wi-Fi script has a reference to simple JSON in in the",
    "start": "471580",
    "end": "479300"
  },
  {
    "text": "imports and so you just create a in the case of the carrier to create a simple JSON PI file in the same directory as",
    "start": "479300",
    "end": "485810"
  },
  {
    "text": "the autorun Wi-Fi script and at the time that somebody sets up their carrots it will run that instead and you'll get",
    "start": "485810",
    "end": "494990"
  },
  {
    "text": "code execution on the device and since you download the autorun wifis script",
    "start": "494990",
    "end": "500410"
  },
  {
    "text": "over an unencrypted connection you can men in the middle the connection and replace their download with yours so",
    "start": "500410",
    "end": "507440"
  },
  {
    "text": "it's a kind of remote code execution if you can get it at the time of download",
    "start": "507440",
    "end": "514789"
  },
  {
    "text": "of the setup script and it like i said the code for that was signed but the",
    "start": "514790",
    "end": "520219"
  },
  {
    "text": "signing doesn't check for the library so it defeats their code signing so just to",
    "start": "520220",
    "end": "528680"
  },
  {
    "text": "recap the an attacker could man in the middle the insta your connection to the carrots server replace the users download with the",
    "start": "528680",
    "end": "535190"
  },
  {
    "text": "malicious version use a vulnerability to make the carrots from their own code and get a bunny botnet additionally",
    "start": "535190",
    "end": "542650"
  },
  {
    "text": "additionally for the home user that has a carrots right now if you're good with coding you can sort of do a bunny break",
    "start": "542650",
    "end": "549050"
  },
  {
    "text": "and have it run your own code instead using this vulnerability parents app for",
    "start": "549050",
    "end": "562730"
  },
  {
    "text": "the iphone the carrots controller app and i'm going to move and carrots his ears using the app this will send a",
    "start": "562730",
    "end": "570200"
  },
  {
    "text": "request via the carrots api to carrots server and then the ears respond by",
    "start": "570200",
    "end": "575870"
  },
  {
    "text": "moving now i'm having to be eavesdropping on that request over here",
    "start": "575870",
    "end": "581300"
  },
  {
    "text": "and if i look at the request itself I can grab from it an authentication token",
    "start": "581300",
    "end": "587660"
  },
  {
    "text": "um it's a one-time use token but what I've found is that I can reuse this",
    "start": "587660",
    "end": "593600"
  },
  {
    "text": "actually and you just capture video instead so I'm going to grab the interactive ID and the time is choking",
    "start": "593600",
    "end": "602440"
  },
  {
    "text": "copy it go over here to my web browser paste it",
    "start": "602440",
    "end": "611130"
  },
  {
    "text": "in and change the action so here it says the action is a year thing we're going",
    "start": "611130",
    "end": "617460"
  },
  {
    "text": "to change the action to webcam and let's",
    "start": "617460",
    "end": "623760"
  },
  {
    "text": "seems to be webcam action bullis video",
    "start": "623760",
    "end": "628790"
  },
  {
    "text": "can't Venter and now on the machine that I'm used to eavesdrop on the carrots I",
    "start": "633440",
    "end": "640260"
  },
  {
    "text": "get a handy-dandy webcam feed hi guys then so this is eavesdropping on the",
    "start": "640260",
    "end": "650160"
  },
  {
    "text": "carrots 'as toys webcam alright so next",
    "start": "650160",
    "end": "666360"
  },
  {
    "text": "up we're going to talk about a product from the from belkin in the Wemo product",
    "start": "666360",
    "end": "672480"
  },
  {
    "text": "line the Wemo product line is a series of smart home products there's this product which is basically a box you",
    "start": "672480",
    "end": "678780"
  },
  {
    "text": "plug into an electrical outlet plug something into that the the Wemo switch and then you can turn whatever you've",
    "start": "678780",
    "end": "684150"
  },
  {
    "text": "plugged into it on and off over the network or over the internet if you set up remote access so we took a look at",
    "start": "684150",
    "end": "691680"
  },
  {
    "text": "this there are other products in the line there's a baby monitor there's a motion sensor we didn't take a look at those we just we just took a look at",
    "start": "691680",
    "end": "697950"
  },
  {
    "text": "this particular device and so first off this has a this is controlled via upnp",
    "start": "697950",
    "end": "706160"
  },
  {
    "text": "through an iphone app that you download and use this to set the thing up connect",
    "start": "706160",
    "end": "712410"
  },
  {
    "text": "it to your Wi-Fi network and then issue it the commands to turn on and off from your from your phone but the version of",
    "start": "712410",
    "end": "720630"
  },
  {
    "text": "libya pnp in use is vulnerable so it's it's a remote pre off boom that gets you",
    "start": "720630",
    "end": "728070"
  },
  {
    "text": "route so you can route this thing and then have a point of persistence with in someone's network that a forensics",
    "start": "728070",
    "end": "733800"
  },
  {
    "text": "investigator for instance would probably not look to as the source of attacks in",
    "start": "733800",
    "end": "738840"
  },
  {
    "text": "a breach scenario so but if if all you want to do is to",
    "start": "738840",
    "end": "743860"
  },
  {
    "text": "turn this thing on and off rooting it would be doing it the hard way because what you can actually do is just use",
    "start": "743860",
    "end": "749800"
  },
  {
    "text": "upnp to turn this on and off the thing about the upnp protocol while it's well known as far as automatic network",
    "start": "749800",
    "end": "757690"
  },
  {
    "text": "configuration for embedded devices and software and things like that it's actually a generic remote procedure call",
    "start": "757690",
    "end": "764140"
  },
  {
    "text": "protocol so in this case it's being used to trigger the whatever is connected it",
    "start": "764140",
    "end": "769870"
  },
  {
    "text": "to it to turn on or off so that's using the set binary state action so you can",
    "start": "769870",
    "end": "776650"
  },
  {
    "text": "turn it on and off on the network local network no authentication you can also change the name of it so if you have",
    "start": "776650",
    "end": "781750"
  },
  {
    "text": "multiple we most witches in your house each of them will bear a name that you've given it so if I have access to",
    "start": "781750",
    "end": "788350"
  },
  {
    "text": "your home network I could switch around the names so that you know you think you're turning on and off one device and",
    "start": "788350",
    "end": "794230"
  },
  {
    "text": "you're really toggling the state of another I can also push new firmware over upnp and while the firmware is",
    "start": "794230",
    "end": "801610"
  },
  {
    "text": "signed it's there's a potential for pushing on old firmware where the lib upnp vuln is still open so so that's",
    "start": "801610",
    "end": "810550"
  },
  {
    "text": "interesting so belkin addressed as as I alluded to just a moment ago belkin addressed the vulnerable version of lube",
    "start": "810550",
    "end": "816520"
  },
  {
    "text": "upnp and they did not add authentication",
    "start": "816520",
    "end": "821560"
  },
  {
    "text": "to the upnp interface but what they did is put a little notification in the",
    "start": "821560",
    "end": "826960"
  },
  {
    "text": "iphone app that just says if you're using this on a network with people you don't trust be aware that they can turn",
    "start": "826960",
    "end": "833230"
  },
  {
    "text": "whatever you have connected to this on and off so at least they're letting",
    "start": "833230",
    "end": "838330"
  },
  {
    "text": "people know about it but here's a quick demo on that so we're going to talk",
    "start": "838330",
    "end": "847540"
  },
  {
    "text": "about the belkin wemo i'm going to show you how to turn this on and off from your computer so the mimo is electrical",
    "start": "847540",
    "end": "856480"
  },
  {
    "text": "eyelid that you can control over the network protocol involved it's called upnp so nmap has a nice NSE script",
    "start": "856480",
    "end": "864700"
  },
  {
    "text": "called broadcast upnp info which tells us all the hosts within multicast range",
    "start": "864700",
    "end": "870850"
  },
  {
    "text": "that will respond to you pnp queries so it gives us the descriptor",
    "start": "870850",
    "end": "876199"
  },
  {
    "text": "XML file for each one so I'm going to take that and feed that to a tool here",
    "start": "876199",
    "end": "883360"
  },
  {
    "text": "by the way this tool using invite you now it is a custom script which I will and this app so that goes to and",
    "start": "886750",
    "end": "892519"
  },
  {
    "text": "enumerates all the devices services and actions and organizes them into various",
    "start": "892519",
    "end": "900250"
  },
  {
    "text": "directories so we want the basic event service that has things that we want",
    "start": "900250",
    "end": "907310"
  },
  {
    "text": "like set binary stick which turns the Wemo on and off so we're going to cat",
    "start": "907310",
    "end": "914120"
  },
  {
    "text": "set binary state and this gives us the",
    "start": "914120",
    "end": "920180"
  },
  {
    "text": "post request that the upnp request generator has made and we're going to give that to burp repeater so that we",
    "start": "920180",
    "end": "928160"
  },
  {
    "text": "can make that request and I need to change this to either a one or a zero see it's boolean here we can see by the",
    "start": "928160",
    "end": "935870"
  },
  {
    "text": "fact that there's no all right so the",
    "start": "935870",
    "end": "941540"
  },
  {
    "text": "demo gods must really hate me originally I was planning a live demo of this but that little box just died on me about",
    "start": "941540",
    "end": "948260"
  },
  {
    "text": "two hours ago and now the video cuts short so needless to say the demo gods",
    "start": "948260",
    "end": "956000"
  },
  {
    "text": "hate me but I do just going to have to trust me that you can turn this on and off from the network so next we're going",
    "start": "956000",
    "end": "964130"
  },
  {
    "text": "to talk about the sonos bridge so the sonos is a sound system you can purchase",
    "start": "964130",
    "end": "969139"
  },
  {
    "text": "at places like target and it's this is the bridge for it which is the little",
    "start": "969139",
    "end": "974180"
  },
  {
    "text": "device that all of the speakers connect to wirelessly and that the controller software connects you you can you can",
    "start": "974180",
    "end": "980389"
  },
  {
    "text": "run this controller software on your laptop or your cell phone anything that",
    "start": "980389",
    "end": "985939"
  },
  {
    "text": "you have your music collection on you you install the controller software onto and then feed the music to the sonos",
    "start": "985939",
    "end": "992930"
  },
  {
    "text": "bridge and it goes out to your speakers the problem with the sonos is that it",
    "start": "992930",
    "end": "998630"
  },
  {
    "text": "has a web server on it and whenever a controller connects to it there's a",
    "start": "998630",
    "end": "1003730"
  },
  {
    "text": "ridiculous amount of information disclosure about the controller so your laptop information",
    "start": "1003730",
    "end": "1008839"
  },
  {
    "text": "about your laptop is exposed in the web interface without authentication on on",
    "start": "1008839",
    "end": "1014119"
  },
  {
    "text": "the bridge and so just to give you an idea here's a list of all of my network",
    "start": "1014119",
    "end": "1019189"
  },
  {
    "text": "shares their permissions the uuid in the group IDs here's a netstat output again",
    "start": "1019189",
    "end": "1026899"
  },
  {
    "text": "available without authentication here's a process list from my laptop here is",
    "start": "1026899",
    "end": "1034579"
  },
  {
    "text": "the current date time and a list of users on the machine here is I have",
    "start": "1034579",
    "end": "1041178"
  },
  {
    "text": "config and Who am I so I mean there's no legitimate reason that this sound system",
    "start": "1041179",
    "end": "1048288"
  },
  {
    "text": "needs this information about my machine and there's absolutely no legitimate reason that it needs to be exposed",
    "start": "1048289",
    "end": "1053720"
  },
  {
    "text": "without authentication to everybody that's on the same network it's ridiculous so we hacked a toilet in",
    "start": "1053720",
    "end": "1067220"
  },
  {
    "text": "directly mind you it's a six thousand dollar toilet that we would have to get shipped from Japan so we didn't we",
    "start": "1067220",
    "end": "1073369"
  },
  {
    "text": "didn't order this toilet but it does have its controlled via bluetooth",
    "start": "1073369",
    "end": "1079460"
  },
  {
    "text": "through an Android application that anybody can download so we took a look at it we all did it and what we found",
    "start": "1079460",
    "end": "1087129"
  },
  {
    "text": "among other things like this wonderful image which is part of the app this this",
    "start": "1087129",
    "end": "1094039"
  },
  {
    "text": "is actually taken from the app I understand why it's a poo I can",
    "start": "1094039",
    "end": "1099500"
  },
  {
    "text": "understand why it has arms and legs because it's from Japan I don't understand the police hat",
    "start": "1099500",
    "end": "1106628"
  },
  {
    "text": "some sort of cool Eastman I don't know but they're there they're a bunch of",
    "start": "1107170",
    "end": "1112700"
  },
  {
    "text": "images like this different anyway I don't want to get too much into it but it's it was weird and I just had to",
    "start": "1112700",
    "end": "1118460"
  },
  {
    "text": "include this in the slides but what we found besides these images of policemen",
    "start": "1118460",
    "end": "1124090"
  },
  {
    "text": "was a default a hard-coded Bluetooth pin there is no there is no place to put in",
    "start": "1124090",
    "end": "1131690"
  },
  {
    "text": "a username and password when working with the application but there was some Bluetooth routines that paired with the",
    "start": "1131690",
    "end": "1138559"
  },
  {
    "text": "saddest toilet using a hard-coded pin of 0000 there's no buttons on the interface",
    "start": "1138559",
    "end": "1145309"
  },
  {
    "text": "that we could find in the user manual to initiate a bluetooth pairing so it just there's no there's really there's a",
    "start": "1145309",
    "end": "1152450"
  },
  {
    "text": "couple of buttons that control various features but so what can you do with this application well you can play music",
    "start": "1152450",
    "end": "1159740"
  },
  {
    "text": "on the toilet you can open and shut the lid you can control the flushing",
    "start": "1159740",
    "end": "1165770"
  },
  {
    "text": "mechanism and it also has a bday which you can control from the android application so just just imagine for a",
    "start": "1165770",
    "end": "1173720"
  },
  {
    "text": "moment that you're sitting on doing your business and the toilet starts screaming",
    "start": "1173720",
    "end": "1179000"
  },
  {
    "text": "and spraying water at you from underneath that's a pretty bad day and",
    "start": "1179000",
    "end": "1184340"
  },
  {
    "text": "obviously this isn't this isn't as bad as as some other things that we're going to be talking about but it was a week we",
    "start": "1184340",
    "end": "1190640"
  },
  {
    "text": "couldn't leave this out of the slides so so the next thing good sorry all right",
    "start": "1190640",
    "end": "1196210"
  },
  {
    "text": "so next we'll talk about the instahub the insta hub is basically a home",
    "start": "1196210",
    "end": "1202309"
  },
  {
    "text": "automation gateway is everybody know what a home automation gateway is few of you guys all right so home automation",
    "start": "1202309",
    "end": "1207530"
  },
  {
    "text": "gateway is basically sit on your network and will allow you to talk to your",
    "start": "1207530",
    "end": "1212750"
  },
  {
    "text": "devices such as lights garage doors alarm systems motion detectors etc etc",
    "start": "1212750",
    "end": "1220540"
  },
  {
    "text": "and act as a bridge between the your internet or your network and your home",
    "start": "1220540",
    "end": "1227210"
  },
  {
    "text": "automation devices the one that I tested was the Insteon hub and what actually",
    "start": "1227210",
    "end": "1233540"
  },
  {
    "text": "happened was they released this product last year and I ordered one in December",
    "start": "1233540",
    "end": "1239429"
  },
  {
    "text": "of 2012 got it installed it configured it got it set up and then I went all",
    "start": "1239429",
    "end": "1246389"
  },
  {
    "text": "right you know I'm a security person I should probably make sure that this is a decent decently secure component or app",
    "start": "1246389",
    "end": "1252779"
  },
  {
    "text": "right downloaded the app and sold the app configured it view of my Wi-Fi my",
    "start": "1252779",
    "end": "1258539"
  },
  {
    "text": "home Wi-Fi turned off the Wi-Fi ran TCP dump on my firewall and then initiated a",
    "start": "1258539",
    "end": "1265259"
  },
  {
    "text": "connection what I saw really disturbed me first and foremost there was no",
    "start": "1265259",
    "end": "1270690"
  },
  {
    "text": "encryption right so anybody who was in between my connection could see that traffic going across the Internet what",
    "start": "1270690",
    "end": "1277049"
  },
  {
    "text": "if I'm in a coffee shop or wherever I might be second thing there was no authentication or authorization to run",
    "start": "1277049",
    "end": "1282989"
  },
  {
    "text": "commands to turn on and off lights that disturbed me we we had a reporter that",
    "start": "1282989",
    "end": "1295590"
  },
  {
    "text": "we were talking with last week from Forbes that published an image on her",
    "start": "1295590",
    "end": "1302129"
  },
  {
    "text": "article this is the image from that article this is someone's house where they've named their their house with",
    "start": "1302129",
    "end": "1308190"
  },
  {
    "text": "their last name and you can basically go in and essentially control all of their",
    "start": "1308190",
    "end": "1313739"
  },
  {
    "text": "their lights whatever it might be and",
    "start": "1313739",
    "end": "1317960"
  },
  {
    "text": "the reason you can find that or one of the things that that I discovered was",
    "start": "1319070",
    "end": "1325019"
  },
  {
    "text": "there's a time zone setting in these devices through this web interface and this web interface is open to anybody on",
    "start": "1325019",
    "end": "1330690"
  },
  {
    "text": "the Internet it's also open anybody to run API commands against that but the",
    "start": "1330690",
    "end": "1335970"
  },
  {
    "text": "web interface allows you to set a time zone so you can configure sunrise and",
    "start": "1335970",
    "end": "1341519"
  },
  {
    "text": "sunset so your devices will go on at sunset or off at sunrise those kinds of things but within that you can actually",
    "start": "1341519",
    "end": "1348720"
  },
  {
    "text": "tell it what city you're in right so if you can tell it what city you're in and someone names it maybe by their street",
    "start": "1348720",
    "end": "1355710"
  },
  {
    "text": "address or their last name there's a pretty good chance you're going to be able to look up where this device is",
    "start": "1355710",
    "end": "1360960"
  },
  {
    "text": "located besides the fact that a lot of IP addresses are geocoded or geo-located",
    "start": "1360960",
    "end": "1367559"
  },
  {
    "text": "right so talking about an attacker attacking someone's home this should be pretty",
    "start": "1367559",
    "end": "1373830"
  },
  {
    "text": "simple to find where they live and maybe even gain access or gain control of",
    "start": "1373830",
    "end": "1379020"
  },
  {
    "text": "their garage door opener a door lock etc",
    "start": "1379020",
    "end": "1383990"
  },
  {
    "text": "yeah I mean really it's you know controlling all the things or all the Internet of Things so the one thing I",
    "start": "1384080",
    "end": "1392940"
  },
  {
    "text": "will mention is they did do a product replacement or what I would call a",
    "start": "1392940",
    "end": "1399050"
  },
  {
    "text": "recall basically I got a call from them and March saying hey we want to replace",
    "start": "1399050",
    "end": "1406020"
  },
  {
    "text": "your device what what oh but I'm give a talk on this device I can't replace this",
    "start": "1406020",
    "end": "1411150"
  },
  {
    "text": "device and they insisted that I replace it I said all right fine still haven't",
    "start": "1411150",
    "end": "1417270"
  },
  {
    "text": "returned the old one but I got a new one right so the new one i sat down plugged",
    "start": "1417270",
    "end": "1423600"
  },
  {
    "text": "it in and started working on it there's still lack of TLS ssl so all the",
    "start": "1423600",
    "end": "1429180"
  },
  {
    "text": "connections at all the connectivity isn't unencrypted however they're using basic HTTP off which is super secure",
    "start": "1429180",
    "end": "1436500"
  },
  {
    "text": "right because base64 is not encryption remember that so one thing I discovered",
    "start": "1436500",
    "end": "1444630"
  },
  {
    "text": "is they're using hard coded tokens once you set up this device it actually does",
    "start": "1444630",
    "end": "1450960"
  },
  {
    "text": "have authentication on it which is good however the password that they're using",
    "start": "1450960",
    "end": "1456360"
  },
  {
    "text": "for the hard-coded authentication is the Insteon ID which is also the last three",
    "start": "1456360",
    "end": "1462510"
  },
  {
    "text": "octet so the mac address so if you're on the same network you can totally break in any one of these guys or if you have",
    "start": "1462510",
    "end": "1469050"
  },
  {
    "text": "enough time you can start through so throwing 16 million combinations at these oh and there's no back off right",
    "start": "1469050",
    "end": "1475530"
  },
  {
    "text": "so that means that anybody can run a script hitting the web server as many times as they want for as long as they",
    "start": "1475530",
    "end": "1481500"
  },
  {
    "text": "want and it's never going to stop responding so I call that a security fail and remember that remember that",
    "start": "1481500",
    "end": "1489450"
  },
  {
    "text": "remember that this hub connects or has the potential to connect to things like door locks & garage doors and alarm",
    "start": "1489450",
    "end": "1496650"
  },
  {
    "text": "systems and carbon monoxide detectors and water sensors and fire sensors",
    "start": "1496650",
    "end": "1503040"
  },
  {
    "text": "just like all sorts of things that are a big risk if they big problem I think I",
    "start": "1503040",
    "end": "1508320"
  },
  {
    "text": "compromised so another another device much like this that we're going to talk",
    "start": "1508320",
    "end": "1514440"
  },
  {
    "text": "about is the me casa verde very light so like a funny story about this this is by",
    "start": "1514440",
    "end": "1522540"
  },
  {
    "text": "far the most broken product in the entire talk I would say it's pretty bad",
    "start": "1522540",
    "end": "1529140"
  },
  {
    "text": "and my colleague just just came in for her death on just just today and he was",
    "start": "1529140",
    "end": "1537000"
  },
  {
    "text": "telling me that on the taxi ride to the pond the guy started asking him the",
    "start": "1537000",
    "end": "1542520"
  },
  {
    "text": "standard security questions like you know is X website safe how easy is it to",
    "start": "1542520",
    "end": "1550320"
  },
  {
    "text": "hack someone's email what's the best antivirus and then you know he said oh",
    "start": "1550320",
    "end": "1556440"
  },
  {
    "text": "by the way I have a home automation business that I'm running on the side",
    "start": "1556440",
    "end": "1562050"
  },
  {
    "text": "and my colleagues like oh really yeah it's like yeah just you know I'm curious",
    "start": "1562050",
    "end": "1568800"
  },
  {
    "text": "I don't know if you would know this at all but I was wondering how secure home automation systems are and he's like",
    "start": "1568800",
    "end": "1574800"
  },
  {
    "text": "well you know my my colleague dan crowley he's talking about him at this con and which one are you talking about",
    "start": "1574800",
    "end": "1581430"
  },
  {
    "text": "and the guys looks at him and says oh the the be Casa Verde varilight and he just he just had to like keep himself",
    "start": "1581430",
    "end": "1588360"
  },
  {
    "text": "from laughing because he already knew like I like showed him a preview version of this talk and so let's let's dive in",
    "start": "1588360",
    "end": "1594780"
  },
  {
    "text": "so here's here's what's going on with this so first of all first of all the",
    "start": "1594780",
    "end": "1600630"
  },
  {
    "text": "web console has no authentication by default so that's that's you know mistake number one if you do want to set",
    "start": "1600630",
    "end": "1609660"
  },
  {
    "text": "up authenticate authentication on it you can enable that but it has some problems so let's let's talk about the separation",
    "start": "1609660",
    "end": "1617700"
  },
  {
    "text": "of privileges for a moment so there's an information only user a guest user and",
    "start": "1617700",
    "end": "1622830"
  },
  {
    "text": "an admin user information only means you can see the status of devices guest means you can turn the devices on and",
    "start": "1622830",
    "end": "1628560"
  },
  {
    "text": "off and admin means you have full control of the unit can change settings save settings set",
    "start": "1628560",
    "end": "1634960"
  },
  {
    "text": "so there are three ways that I found and there's probably more but these is three that I found to bypass that actually the",
    "start": "1634960",
    "end": "1642309"
  },
  {
    "text": "past reversal is another way so there's four so first of all you can update the",
    "start": "1642309",
    "end": "1647590"
  },
  {
    "text": "firmware as a guest so and it's just a non the firmware is not signed it's in a",
    "start": "1647590",
    "end": "1654640"
  },
  {
    "text": "squash FS package so you can with freely available tools take apart the firmware",
    "start": "1654640",
    "end": "1659830"
  },
  {
    "text": "add a backdoor you know something like that and then put it back together upload the firmware to the device as a",
    "start": "1659830",
    "end": "1667840"
  },
  {
    "text": "guest so you can get root that way there is a settings back up where you can",
    "start": "1667840",
    "end": "1673360"
  },
  {
    "text": "download an unencrypted archive of various settings files on the device",
    "start": "1673360",
    "end": "1678940"
  },
  {
    "text": "this includes etsy password which in the version of Linux that's running on the varilight contains password hashes so",
    "start": "1678940",
    "end": "1686289"
  },
  {
    "text": "you can crack the root password and then use the ssh the ssh interface on the",
    "start": "1686289",
    "end": "1692380"
  },
  {
    "text": "device to log in its root this one's my personal favorite test Lua code so as a",
    "start": "1692380",
    "end": "1698320"
  },
  {
    "text": "guest you can run just any Lua code you want on the device so it's like code",
    "start": "1698320",
    "end": "1703840"
  },
  {
    "text": "execution as a feature and the best part is it runs as roof and you can you can",
    "start": "1703840",
    "end": "1710529"
  },
  {
    "text": "drop to a shell so you can just do OS execute whatever shell command you want and it'll run as root and it's amazing",
    "start": "1710529",
    "end": "1718289"
  },
  {
    "text": "so there's also a path traversal flaw so as any as a guest user or higher you can",
    "start": "1718289",
    "end": "1725140"
  },
  {
    "text": "pull any sis file you want off of the varilight and the web server runs as",
    "start": "1725140",
    "end": "1732070"
  },
  {
    "text": "root of course so you can pull any file you want including NC password cracked",
    "start": "1732070",
    "end": "1737289"
  },
  {
    "text": "hashes is ssh to get in so there's a cross-site request forgery flaw as well",
    "start": "1737289",
    "end": "1743770"
  },
  {
    "text": "which you can use to execute several of these attacks so again this uses upnp",
    "start": "1743770",
    "end": "1751390"
  },
  {
    "text": "and there's just no authentication on upnp and what this device actually exposes via upnp is a control interface",
    "start": "1751390",
    "end": "1759850"
  },
  {
    "text": "for all the devices hooked up to it which again can include things like door locks and we actually have a door lock",
    "start": "1759850",
    "end": "1766270"
  },
  {
    "text": "here that we're going to unlock from the podium real quick so so there's",
    "start": "1766270",
    "end": "1772419"
  },
  {
    "text": "no authentication on the upnp damon and the best part about that is that the run lua there there's an action on there",
    "start": "1772419",
    "end": "1778090"
  },
  {
    "text": "called run lua which does the same thing as the you know code execution as a",
    "start": "1778090",
    "end": "1783309"
  },
  {
    "text": "feature so and it again it runs this route so even if you have the web",
    "start": "1783309",
    "end": "1789549"
  },
  {
    "text": "interface password protected even if there weren't the issues that there were with the web interface there's still a",
    "start": "1789549",
    "end": "1794710"
  },
  {
    "text": "way to just run code as root as an unauthenticated user as long as you're on the same network now the thing about",
    "start": "1794710",
    "end": "1801580"
  },
  {
    "text": "upnp is it is rife with potential for",
    "start": "1801580",
    "end": "1807820"
  },
  {
    "text": "cross protocol exploitation because it's basically just HTTP and the other thing is there's no standard port for the",
    "start": "1807820",
    "end": "1813880"
  },
  {
    "text": "control the control messages sent with upnp so what you can do is craft a web",
    "start": "1813880",
    "end": "1821019"
  },
  {
    "text": "page to do a CSRF style attack against",
    "start": "1821019",
    "end": "1826240"
  },
  {
    "text": "the varilight and just add some sort of back door as root just tell the the",
    "start": "1826240",
    "end": "1831460"
  },
  {
    "text": "system to grab them interpreter payload and run it something like that so you",
    "start": "1831460",
    "end": "1837279"
  },
  {
    "text": "don't need to necessarily have to be on some of these home network to execute some of these attacks on top of all that",
    "start": "1837279",
    "end": "1844539"
  },
  {
    "text": "the version of the lib upnp that they're using is vulnerable to the same attack that we talked about with the Belkin",
    "start": "1844539",
    "end": "1851590"
  },
  {
    "text": "Wemo switch now departing from all the remote code execution stuff there's a",
    "start": "1851590",
    "end": "1858370"
  },
  {
    "text": "server-side request forgery bug and this this is a bit odd to put at the end of all this stuff but you'll see why this",
    "start": "1858370",
    "end": "1864639"
  },
  {
    "text": "is relevant in a moment there's a script called proxy SH on the varilight where",
    "start": "1864639",
    "end": "1869649"
  },
  {
    "text": "basically you give the URL it fetches the contents of that URL and returns the contents to you so you essentially it's",
    "start": "1869649",
    "end": "1876700"
  },
  {
    "text": "a proxy it is exactly what it advertises now let's talk for a bit about the",
    "start": "1876700",
    "end": "1882220"
  },
  {
    "text": "remote architect the remote access architecture on the varilight the varilight remote access architecture",
    "start": "1882220",
    "end": "1888250"
  },
  {
    "text": "works with a broker server so you can traverse nap so each viewer light unit",
    "start": "1888250",
    "end": "1893500"
  },
  {
    "text": "connects via ssh to the forwarding servers and forwards a port back from",
    "start": "1893500",
    "end": "1900340"
  },
  {
    "text": "the forwarding server to the web interface on the verra now what this means is anybody who can",
    "start": "1900340",
    "end": "1906880"
  },
  {
    "text": "bypass the firewall in place on the forwarding servers can access and control every single installed varilight",
    "start": "1906880",
    "end": "1913450"
  },
  {
    "text": "unit connected to the internet which is mostly what people are doing so this",
    "start": "1913450",
    "end": "1921430"
  },
  {
    "text": "doesn't require you know it doesn't necessarily require a compromise of the forwarding server although that would",
    "start": "1921430",
    "end": "1926740"
  },
  {
    "text": "work you could just find some way to bypass the firewall you could find some",
    "start": "1926740",
    "end": "1933340"
  },
  {
    "text": "way to compromise the firewall you can find a way to compromise a server that isn't you know it's on the same network",
    "start": "1933340",
    "end": "1939820"
  },
  {
    "text": "segment so you're not firewalled there's a whole bunch of things but what's",
    "start": "1939820",
    "end": "1945100"
  },
  {
    "text": "concerning and what might be a problem is that there is a script on each forwarding server called proxy SH PHP",
    "start": "1945100",
    "end": "1953640"
  },
  {
    "text": "which takes a URL as a parameter fetches it and gives it to you it gives the",
    "start": "1953640",
    "end": "1959110"
  },
  {
    "text": "response to you now I can't test because of the CFAA I can't test that this is",
    "start": "1959110",
    "end": "1965890"
  },
  {
    "text": "has the same exact flaw but when it's named the same thing plus a dot PHP takes the exact same arguments in the",
    "start": "1965890",
    "end": "1973090"
  },
  {
    "text": "exact same format and appears to do the exact same thing there's a good chance that this is just copied and pasted code",
    "start": "1973090",
    "end": "1979630"
  },
  {
    "text": "and that the same vulnerability that exists on the varilight exists on the forwarding service which means you can",
    "start": "1979630",
    "end": "1985720"
  },
  {
    "text": "ask the forwarding servers if this is if this is actually the case you can ask the forwarding servers to request a page",
    "start": "1985720",
    "end": "1993250"
  },
  {
    "text": "from themselves on a particular port a high port which is likely to be used by a forward import to a varilight so like",
    "start": "1993250",
    "end": "2003450"
  },
  {
    "text": "I said we can't test this because we haven't received authorization from the manufacturer but it's it is concerning",
    "start": "2003450",
    "end": "2010860"
  },
  {
    "text": "so just to recap three methods of authentication bypass seven to seven different methods to get root two of",
    "start": "2010860",
    "end": "2018180"
  },
  {
    "text": "these attacks being remotely exploitable using social engineering techniques and a potential for every varilight to be",
    "start": "2018180",
    "end": "2027750"
  },
  {
    "text": "compromised about with a very it's just like a glass of water on the edge of a",
    "start": "2027750",
    "end": "2034020"
  },
  {
    "text": "table just all it takes is just something small so it's a really bad scene and now we'd",
    "start": "2034020",
    "end": "2040460"
  },
  {
    "text": "like to do some demonstrations for you with some of the products that we talked about so first we're going to do a",
    "start": "2040460",
    "end": "2047750"
  },
  {
    "text": "demonstration with the carrot so Jen maybe you can explain what's going on I don't explain what's going on go ahead",
    "start": "2047750",
    "end": "2054379"
  },
  {
    "text": "and go from the mic awful this so uh can you move away from the LED with your",
    "start": "2054380",
    "end": "2060800"
  },
  {
    "text": "feeders thank you so I have pre-loaded",
    "start": "2060800",
    "end": "2065870"
  },
  {
    "text": "the malicious code via the LOL mp3 file",
    "start": "2065870",
    "end": "2071810"
  },
  {
    "text": "onto USB Drive that presumably was something that you downloaded at the",
    "start": "2071810",
    "end": "2078020"
  },
  {
    "text": "time of downloading the setup script and right now it's loading up the carrots OS and it's checking out the fact that",
    "start": "2078020",
    "end": "2085129"
  },
  {
    "text": "there is a USB Drive and the funny spot through the internet right now it thinks it's trying to connect the internet it",
    "start": "2085130",
    "end": "2090260"
  },
  {
    "text": "thinks is trying to run the autorun Wi-Fi and instead of tuna run my mp3",
    "start": "2090260",
    "end": "2095419"
  },
  {
    "text": "file because that's what I told descriptive too but you could potentially have it take pictures on a",
    "start": "2095420",
    "end": "2102470"
  },
  {
    "text": "regular basis send them back to your server you know all sorts of things that are very bad jermichael are actually no",
    "start": "2102470",
    "end": "2114140"
  },
  {
    "text": "I'll go oh yeah all right so next we",
    "start": "2114140",
    "end": "2121670"
  },
  {
    "text": "have the Insteon devil so remember how I said there's no authentication",
    "start": "2121670",
    "end": "2126800"
  },
  {
    "text": "authorization all that fun stuff what do we have to do to zoom in on this guy",
    "start": "2126800",
    "end": "2132430"
  },
  {
    "text": "what do if you do to zoom control and scroll all right so here's the get",
    "start": "2132430",
    "end": "2141950"
  },
  {
    "text": "request that we have to send it basically embedded in this get request I think it's this guy right here that's",
    "start": "2141950",
    "end": "2149390"
  },
  {
    "text": "the device ID and I'm I'm basically telling the insead hey turn this device",
    "start": "2149390",
    "end": "2154400"
  },
  {
    "text": "on right this message right here is the on code right and so I should be able to",
    "start": "2154400",
    "end": "2162860"
  },
  {
    "text": "say well it's on all right right so if I oh no",
    "start": "2162860",
    "end": "2167869"
  },
  {
    "text": "oh did it really ya know okay that's all",
    "start": "2167869",
    "end": "2172999"
  },
  {
    "text": "right i think phil i think we're doing",
    "start": "2172999",
    "end": "2180950"
  },
  {
    "text": "okay on time so we should be able to set it back up all right let me just relaunch burp real quick we're gonna do",
    "start": "2180950",
    "end": "2191869"
  },
  {
    "text": "a little dance while we wait for the burp suite to start up again carrots",
    "start": "2191869",
    "end": "2196910"
  },
  {
    "text": "went out last night and had a bit of a rough time at its party and came home",
    "start": "2196910",
    "end": "2203660"
  },
  {
    "text": "with the DEF CON tattoo i don't know if you guys noticed it might have to have a",
    "start": "2203660",
    "end": "2211369"
  },
  {
    "text": "talking to you with it",
    "start": "2211369",
    "end": "2214268"
  },
  {
    "text": "100 so which one is it one gets 100 100",
    "start": "2232790",
    "end": "2238980"
  },
  {
    "text": "0 cuz it yeah cuz okay so let's uh yeah",
    "start": "2238980",
    "end": "2245849"
  },
  {
    "text": "grab bono home alright so now we can",
    "start": "2245849",
    "end": "2251670"
  },
  {
    "text": "turn the sucker off yay no authentication okay let's go ahead and",
    "start": "2251670",
    "end": "2260430"
  },
  {
    "text": "turn it back on again here just so that we can have a little light alright so",
    "start": "2260430",
    "end": "2266040"
  },
  {
    "text": "that's the Insteon I yeah go ahead so the next thing we're going to do they",
    "start": "2266040",
    "end": "2273089"
  },
  {
    "text": "say that if you put a gun on the table in act 1 you must fire the gun by Act",
    "start": "2273089",
    "end": "2278640"
  },
  {
    "text": "three here we have a door lock and I",
    "start": "2278640",
    "end": "2286410"
  },
  {
    "text": "mentioned door lock several times so what I'm going to do is to unlock this door lock from my computer once i get",
    "start": "2286410",
    "end": "2296550"
  },
  {
    "text": "everything set back yeah so basically he's got to go back he's got the PHP",
    "start": "2296550",
    "end": "2301650"
  },
  {
    "text": "script that he's written the custom custom code that will go through and enumerate the upnp components once he",
    "start": "2301650",
    "end": "2308990"
  },
  {
    "text": "basically enumerates those components pulls all of the upnp areas down he can",
    "start": "2308990",
    "end": "2315450"
  },
  {
    "text": "then go and grab those throw them into burp suite and then basically use the repeater function i mean we could do",
    "start": "2315450",
    "end": "2322950"
  },
  {
    "text": "this with tell that if we wanted to but it would take us a long time to manipulate it so we just use burp suite to make it quicker you know pastor for",
    "start": "2322950",
    "end": "2330240"
  },
  {
    "text": "us and essentially what it you know ideally if it works it should open the",
    "start": "2330240",
    "end": "2336270"
  },
  {
    "text": "door lock right right",
    "start": "2336270",
    "end": "2339800"
  },
  {
    "text": "I believe the SIP 101 right think it's 101 yeah and property or whatever so so",
    "start": "2350109",
    "end": "2358989"
  },
  {
    "text": "this is what the upnp request looks like it's a just a soap request so you have",
    "start": "2358989",
    "end": "2366160"
  },
  {
    "text": "just the control URL of the action in the soap action header here so there's",
    "start": "2366160",
    "end": "2372160"
  },
  {
    "text": "toggle state for the door lock so that means that it's locked it's like it unlocks it and vice versa and so it",
    "start": "2372160",
    "end": "2379299"
  },
  {
    "text": "takes no arguments oh I'm I should just be able to hit go here and the lock",
    "start": "2379299",
    "end": "2387190"
  },
  {
    "text": "unlocks wait so so this is useful within",
    "start": "2387190",
    "end": "2396339"
  },
  {
    "text": "a particular time particular time window but kind of a volunteer from the audience please just raise it raise a",
    "start": "2396339",
    "end": "2403450"
  },
  {
    "text": "hand if you're willing to volunteer steadily I get you with the camera I'd",
    "start": "2403450",
    "end": "2410440"
  },
  {
    "text": "like you to just give me a four-digit number any four-digit number 5 389 so",
    "start": "2410440",
    "end": "2420130"
  },
  {
    "text": "we'll try that on this lock five 389 no",
    "start": "2420130",
    "end": "2426489"
  },
  {
    "text": "dice but we have a solution for that so there is also a an action available off",
    "start": "2426489",
    "end": "2435309"
  },
  {
    "text": "for this device which adds a pin to the door lock yeah I know it's incredible so",
    "start": "2435309",
    "end": "2449470"
  },
  {
    "text": "we need door lock door lock set in so",
    "start": "2449470",
    "end": "2458440"
  },
  {
    "text": "this takes a couple arguments the first one is the first one is a JSON which I",
    "start": "2458440",
    "end": "2470440"
  },
  {
    "text": "have no idea what the JSON us or to be perfectly transparent but if you just put an empty json string it doesn't seem",
    "start": "2470440",
    "end": "2477160"
  },
  {
    "text": "to mind user code name again it doesn't seem to mind if you put I think it's",
    "start": "2477160",
    "end": "2482470"
  },
  {
    "text": "just a descriptive thing the web interface so i'm going to put black hat briefings 2013 and for the pin",
    "start": "2482470",
    "end": "2494160"
  },
  {
    "text": "53 89 we hit go thing says okay it",
    "start": "2494160",
    "end": "2500500"
  },
  {
    "text": "communicates from the door lock and now 53 89 and I believe that's all we have",
    "start": "2500500",
    "end": "2517180"
  },
  {
    "text": "for you today so the basically the conclusions are that we've got all these devices right this internet of things",
    "start": "2517180",
    "end": "2522400"
  },
  {
    "text": "they're all connected together and people are using them right people are using their homes there's a really good",
    "start": "2522400",
    "end": "2528850"
  },
  {
    "text": "chance that mom and pop we're going to start using them and people don't really understand the security that that they",
    "start": "2528850",
    "end": "2534790"
  },
  {
    "text": "really don't have around these devices right I think it's really important to go back to the manufacturers and say",
    "start": "2534790",
    "end": "2540340"
  },
  {
    "text": "what are you doing you're you're deploying products without authentication or authorization now this",
    "start": "2540340",
    "end": "2546400"
  },
  {
    "text": "goes back to if you think about it in terms of breaking in if someone breaks into your house forcibly with a brick",
    "start": "2546400",
    "end": "2552970"
  },
  {
    "text": "with a hammer with a lock pick those are ways that you can identify that someone's broken into your house right",
    "start": "2552970",
    "end": "2558640"
  },
  {
    "text": "you have forced entry there's a chance you can go to the insurance company get money for that if someone breaks in your",
    "start": "2558640",
    "end": "2564160"
  },
  {
    "text": "house and there's no signs of forced entry how are you need your insurance money back right those are those are the",
    "start": "2564160",
    "end": "2569470"
  },
  {
    "text": "questions that we really have to ask ask ourselves is this technology really worth it I think you know from a",
    "start": "2569470",
    "end": "2575710"
  },
  {
    "text": "perspective of controlling lights and things like that yes from the perspective of controlling door locks",
    "start": "2575710",
    "end": "2580840"
  },
  {
    "text": "it's way too immature to be able to trust so all right I think that's that's what we have so thank you very much",
    "start": "2580840",
    "end": "2589170"
  },
  {
    "text": "so at this point I'd like to open up for questions if anybody has make sure you a badge out and give us a survey if you",
    "start": "2593370",
    "end": "2600270"
  },
  {
    "text": "leavin questions you I'm sorry can you",
    "start": "2600270",
    "end": "2618050"
  },
  {
    "text": "yeah so it exposes the city based on the fact that there's a time zone right so",
    "start": "2619550",
    "end": "2626130"
  },
  {
    "text": "that's the unauthenticated version essentially no so the NCN hub does not",
    "start": "2626130",
    "end": "2636090"
  },
  {
    "text": "have any Wi-Fi component to it all it's it's just ethernet based so what it has is a 900 megahertz insteon bridge",
    "start": "2636090",
    "end": "2644730"
  },
  {
    "text": "essentially so that it can talk to the Insteon devices over 915 megahertz but",
    "start": "2644730",
    "end": "2651180"
  },
  {
    "text": "no no Wi-Fi component in it at all what I did say with the mac address right the",
    "start": "2651180",
    "end": "2656490"
  },
  {
    "text": "mac address if you if you're on the same network you could identify the the new authentication just by knowing the mac",
    "start": "2656490",
    "end": "2663000"
  },
  {
    "text": "address does that make sense okay yeah",
    "start": "2663000",
    "end": "2677960"
  },
  {
    "text": "yeah and it's it's limited to two official belkin firmwares i sorry I",
    "start": "2682520",
    "end": "2689520"
  },
  {
    "text": "should have made it more clear that I'm I have not tried to downgrade the firmware yeah and we didn't even have to",
    "start": "2689520",
    "end": "2701760"
  },
  {
    "text": "talk to you guys about these these are fixed before we could even start to reach out to you guys so thank you yeah",
    "start": "2701760",
    "end": "2707070"
  },
  {
    "text": "you guys are feel good have a question",
    "start": "2707070",
    "end": "2713359"
  },
  {
    "text": "not the latest green energy populaces so",
    "start": "2713359",
    "end": "2729769"
  },
  {
    "text": "bluetooth is a lot harder I mean I haven't done a lot of research on the Bluetooth flow of energy but I know that the prior versions of Bluetooth were a",
    "start": "2729769",
    "end": "2737539"
  },
  {
    "text": "lot more difficult to brute force but it's not impossible right I know if you",
    "start": "2737539",
    "end": "2743690"
  },
  {
    "text": "have anything to add to that not having touch them myself I I can only really",
    "start": "2743690",
    "end": "2750529"
  },
  {
    "text": "speculate but I can say that all of this has made me very uncomfortable about hooking things that could potentially be",
    "start": "2750529",
    "end": "2758779"
  },
  {
    "text": "dangerous if compromised up to the network's even personal area networks you know clearly there's you're not",
    "start": "2758779",
    "end": "2766099"
  },
  {
    "text": "hooking it up to the internet so there's like a whole range of threat actors that aren't aren't involved here but I just",
    "start": "2766099",
    "end": "2775190"
  },
  {
    "text": "don't feel good about booking door locks up to never it the difference between putting a physical key in or putting a",
    "start": "2775190",
    "end": "2781789"
  },
  {
    "text": "phone up to it I would rather just use a key I'm a little more ballsy I would probably use it if I test it and",
    "start": "2781789",
    "end": "2788509"
  },
  {
    "text": "confined a bug you PM me so there are",
    "start": "2788509",
    "end": "2802549"
  },
  {
    "text": "actual actually there are several tools that will help enumerate upnp devices",
    "start": "2802549",
    "end": "2807619"
  },
  {
    "text": "the one that I used is an nmap script which just it's called broadcast you can",
    "start": "2807619",
    "end": "2814999"
  },
  {
    "text": "p dash info there's also one that's a unicast version in case you're scanning over the internet and just hoping that",
    "start": "2814999",
    "end": "2821839"
  },
  {
    "text": "it will actually respond over the internet which is not supposed to but broadcast the upnp info and upnp info",
    "start": "2821839",
    "end": "2829940"
  },
  {
    "text": "there's also I believe it's a Windows tool called Intel universal control",
    "start": "2829940",
    "end": "2835519"
  },
  {
    "text": "point there is a python script called Miranda which also which does the",
    "start": "2835519",
    "end": "2842539"
  },
  {
    "text": "discovery and the description phase and also allows you to do some control stuff it's a little bit buggy I notice",
    "start": "2842539",
    "end": "2850589"
  },
  {
    "text": "it crashes on me a lot and you also can't issue control requests without doing the discovery first so if you're",
    "start": "2850589",
    "end": "2858329"
  },
  {
    "text": "going across the internet miranda is entirely useless to you which is part of",
    "start": "2858329",
    "end": "2864210"
  },
  {
    "text": "why i wrote my script but that's those are those are a couple upnp tools that",
    "start": "2864210",
    "end": "2869369"
  },
  {
    "text": "you can use also metasploit metasploit has a upnp discovery module and that one",
    "start": "2869369",
    "end": "2875700"
  },
  {
    "text": "I think will actually check to see if the version of lib do pnp is vulnerable or not sure go ahead I will be it will",
    "start": "2875700",
    "end": "2890309"
  },
  {
    "text": "be on the github the spiderlabs github",
    "start": "2890309",
    "end": "2894890"
  },
  {
    "text": "you can buy them on thinking if you want I would um I no longer use the bunny we",
    "start": "2900230",
    "end": "2908789"
  },
  {
    "text": "leave it unplugged my daughter loves the bunny so we leave it in her room",
    "start": "2908789",
    "end": "2914460"
  },
  {
    "text": "unplugged but you know I I would no",
    "start": "2914460",
    "end": "2919950"
  },
  {
    "text": "longer use it the vendor simply did not respond to the disclosure",
    "start": "2919950",
    "end": "2928759"
  },
  {
    "text": "what that was I think that was a different version of it but yeah the carrots is essentially the successor to",
    "start": "2930240",
    "end": "2935860"
  },
  {
    "text": "the namaz tag yep a requester and just",
    "start": "2935860",
    "end": "2943750"
  },
  {
    "text": "got your hand up up in my I'm saying things I don't you so there's art",
    "start": "2943750",
    "end": "2948820"
  },
  {
    "text": "there's a lot of privacy concerns you know with these devices some of them do",
    "start": "2948820",
    "end": "2955420"
  },
  {
    "text": "upload their data to the cloud you know we you know for obvious reasons were",
    "start": "2955420",
    "end": "2961720"
  },
  {
    "text": "unable to test any of the servers on belonging to these companies so we don't",
    "start": "2961720",
    "end": "2967930"
  },
  {
    "text": "know if they're secure even if you get one of these devices and you can test it yourself and you feel reasonably secure",
    "start": "2967930",
    "end": "2974410"
  },
  {
    "text": "about it if it's connected to you somebody else's server and controllable through their server than if their",
    "start": "2974410",
    "end": "2980080"
  },
  {
    "text": "server gets owned you know that's a problem so these are all things that I",
    "start": "2980080",
    "end": "2985810"
  },
  {
    "text": "think the security community needs to be proactive about consumer advocacy and",
    "start": "2985810",
    "end": "2991980"
  },
  {
    "text": "doing this testing ourselves question",
    "start": "2991980",
    "end": "2999130"
  },
  {
    "text": "out there",
    "start": "2999130",
    "end": "3001279"
  },
  {
    "text": "so the question if I remember if I heard this red do we find any potentially dangerous items such as taps labelled",
    "start": "3007290",
    "end": "3018370"
  },
  {
    "text": "water taps the home automation gateways can be hooked up to hvac systems and David made a good point the other day",
    "start": "3018370",
    "end": "3023800"
  },
  {
    "text": "about you know they lives in minnesota in minneapolis cold like it's very cold",
    "start": "3023800",
    "end": "3029610"
  },
  {
    "text": "and so if you were to shut off somebody's heat in the middle of the winter it could burst the pipes so there",
    "start": "3029610",
    "end": "3035980"
  },
  {
    "text": "is some potential for it but it's a maybe a bit of a doomsday scenario I mean the other thing is you know I in",
    "start": "3035980",
    "end": "3042550"
  },
  {
    "text": "doing some of the reconnaissance you would see people it would have hot tubs or you know heating elements or",
    "start": "3042550",
    "end": "3047890"
  },
  {
    "text": "something hooked up to their their smart home right and you know that could cause",
    "start": "3047890",
    "end": "3053140"
  },
  {
    "text": "a either either a house fire or potentially right or a really high",
    "start": "3053140",
    "end": "3059080"
  },
  {
    "text": "electric bill I you know but don't I don't think we want to go in the direction of fat right so we talked",
    "start": "3059080",
    "end": "3065170"
  },
  {
    "text": "about things that we tested and leave it at that yeah we didn't manage to cause any fires within the course of our",
    "start": "3065170",
    "end": "3070990"
  },
  {
    "text": "testing there's its question right right",
    "start": "3070990",
    "end": "3088450"
  },
  {
    "text": "well so the internet enabled thermostats you can turn on and off or auto I don't",
    "start": "3088450",
    "end": "3096550"
  },
  {
    "text": "know if they have a setting that says if they go below 50 degrees that they will turn on again especially if they're in",
    "start": "3096550",
    "end": "3103900"
  },
  {
    "text": "the off mode",
    "start": "3103900",
    "end": "3106109"
  },
  {
    "text": "that's good to know now an attacker come along and say no over i right I mean",
    "start": "3122579",
    "end": "3128589"
  },
  {
    "text": "I've done so I've done SCADA system audits where you know I've been talking to a guy I'm like hey you know can you",
    "start": "3128589",
    "end": "3134560"
  },
  {
    "text": "get to your stuff and he's like no I can't get to it but that's all right because the system goes into auto mode unless you have admin override turned on",
    "start": "3134560",
    "end": "3142020"
  },
  {
    "text": "so a lot of these things will potentially still have some sort of admin override code and that that may",
    "start": "3142020",
    "end": "3149200"
  },
  {
    "text": "still exist inside of a consumer thermostat but you know I guess we have to test would have some stalls from that",
    "start": "3149200",
    "end": "3155410"
  },
  {
    "text": "right so you also have to think about the possibility of what happens when the device fails potentially and there's I I",
    "start": "3155410",
    "end": "3163300"
  },
  {
    "text": "think that that's a possibility yeah we actually wanted to test the Nest",
    "start": "3163300",
    "end": "3169089"
  },
  {
    "text": "Learning Thermostat but variables a guy hold of one in time there's just so much",
    "start": "3169089",
    "end": "3174400"
  },
  {
    "text": "stuff out there so any other questions",
    "start": "3174400",
    "end": "3180960"
  },
  {
    "text": "thank you very much",
    "start": "3181530",
    "end": "3184950"
  }
]