[
  {
    "text": "hey hello everyone I'm really happy to be here this is my presentation that I'm going to talk about Wi-Fi direct first a",
    "start": "0",
    "end": "8300"
  },
  {
    "text": "brief introduction of myself my name is Andres Blanco I usually like to reverse",
    "start": "8300",
    "end": "14120"
  },
  {
    "text": "perform network research and privacy and I usually enjoy doing Wi-Fi research and",
    "start": "14120",
    "end": "21990"
  },
  {
    "text": "I'm not a native speaker so someone has a problem listening please question at",
    "start": "21990",
    "end": "28050"
  },
  {
    "text": "the end of the presentation so what we were going to talk about here so what if",
    "start": "28050",
    "end": "34350"
  },
  {
    "text": "I detect a Wi-Fi peer-to-peer it's not a specification that defines an facilitate",
    "start": "34350",
    "end": "41550"
  },
  {
    "text": "the device to device connectivity based it on a toe 2.11 infrastructure mode",
    "start": "41550",
    "end": "47840"
  },
  {
    "text": "this this specification will release on april 2010 and at that moment there were",
    "start": "47840",
    "end": "55980"
  },
  {
    "text": "no so many devices are supported so it it's not really known by most people but",
    "start": "55980",
    "end": "62129"
  },
  {
    "text": "nowadays Wi-Fi Alliance that I'm going to talk about later has thirteen",
    "start": "62129",
    "end": "67650"
  },
  {
    "text": "thousand two hundred and eighty devices certified with this protocol so a lot of devices have support for this and I'm",
    "start": "67650",
    "end": "75090"
  },
  {
    "text": "sure that we can find someone nearby and who is the waffle irons well the Wi-Fi Alliance is an",
    "start": "75090",
    "end": "81210"
  },
  {
    "text": "organization that create different Wi-Fi protocols and they also promote the",
    "start": "81210",
    "end": "87659"
  },
  {
    "text": "usage of Wi-Fi and as you may have be similar see here we have four different",
    "start": "87659",
    "end": "93619"
  },
  {
    "text": "specification that Wi-Fi Alliance release it a couple of years ago WPS",
    "start": "93619",
    "end": "99540"
  },
  {
    "text": "that most of us here on a security conference know that was a really bad decision and Wi-Fi display hotspot 2.0",
    "start": "99540",
    "end": "108060"
  },
  {
    "text": "that this is a new one that many devices nowadays support for example Apple devices and then Wi-Fi direct that is",
    "start": "108060",
    "end": "114810"
  },
  {
    "text": "the one we are going to talk today so why why I decided to do this research",
    "start": "114810",
    "end": "120290"
  },
  {
    "text": "well I usually don't need too many reasons to look into 802 2.11",
    "start": "120290",
    "end": "126710"
  },
  {
    "text": "technologies because I like Wi-Fi and I like the idea of anyone being able to connect to a",
    "start": "126710",
    "end": "133220"
  },
  {
    "text": "device or try to do something with the device we'd only been near to the device",
    "start": "133220",
    "end": "138620"
  },
  {
    "text": "okay we don't need any privilege we don't need to be plug into a cable we shall send some Frenchy to the air and",
    "start": "138620",
    "end": "144380"
  },
  {
    "text": "someone they are going to process it but here I put three reasons that motivate",
    "start": "144380",
    "end": "150140"
  },
  {
    "text": "me to do this to do this research and is that this protocol extends the 802 the",
    "start": "150140",
    "end": "155750"
  },
  {
    "text": "tellurian attack surface and what this means is that if your device support this this protocol is going to have some",
    "start": "155750",
    "end": "163190"
  },
  {
    "text": "support on the finger on the kernel and new zealand applications so these extended opportunities for attackers to",
    "start": "163190",
    "end": "169730"
  },
  {
    "text": "perform some type of attack on a device there are a lot of out of scope @ly",
    "start": "169730",
    "end": "176330"
  },
  {
    "text": "notes on the specification that forces the the vendors to implement some type",
    "start": "176330",
    "end": "182720"
  },
  {
    "text": "of solution that they have to implement it as they like or as they or the way",
    "start": "182720",
    "end": "188420"
  },
  {
    "text": "they find to solve to make a solution for this because for example I want to mention I'm gonna mention some of them",
    "start": "188420",
    "end": "195340"
  },
  {
    "text": "in next slides and then the last reason",
    "start": "195340",
    "end": "200750"
  },
  {
    "text": "is that we have 13,000 and 280 devices so there are a lot of devices around that support this protocol and I'm",
    "start": "200750",
    "end": "208730"
  },
  {
    "text": "probably sure that not many people know about this protocol and in fact there a lot of devices that have build-in sorry",
    "start": "208730",
    "end": "216050"
  },
  {
    "text": "default support for this and maybe they are not about it so the specification",
    "start": "216050",
    "end": "222290"
  },
  {
    "text": "can be divided into four to four sorry four parts we have the appeal to peer discovery the peer to peer group",
    "start": "222290",
    "end": "228890"
  },
  {
    "text": "operations power management and managed at peer to peer device operations I'm",
    "start": "228890",
    "end": "234890"
  },
  {
    "text": "gonna specifically specifically talk about this first - the the third one is",
    "start": "234890",
    "end": "240920"
  },
  {
    "text": "what not or my interest because I thought that nothing about security can be related to power management I know",
    "start": "240920",
    "end": "247070"
  },
  {
    "text": "there are some type of attacks but it was not my interest and the third one and the fourth one is really interested",
    "start": "247070",
    "end": "252709"
  },
  {
    "text": "but I was not able to get a device that support this four part so I was not able",
    "start": "252709",
    "end": "258350"
  },
  {
    "text": "to do practical attacks or tests so I didn't saw that so we're going to",
    "start": "258350",
    "end": "265100"
  },
  {
    "text": "start talking about what is infrastructure mode so infertile mode is",
    "start": "265100",
    "end": "272000"
  },
  {
    "text": "what we usually use Wi-Fi or how we use it okay here in this conference we have access points that provide us access to",
    "start": "272000",
    "end": "278180"
  },
  {
    "text": "our network and us with different stations connect and associate to the",
    "start": "278180",
    "end": "283640"
  },
  {
    "text": "network and use the network that the access point is providing to us is the most common mode usually we use this",
    "start": "283640",
    "end": "290180"
  },
  {
    "text": "model and we don't play with our small but we have a dock for example a vocational mode that let devices connect",
    "start": "290180",
    "end": "297440"
  },
  {
    "text": "each other okay these two modes are defined on a tow 2.11 standard and this",
    "start": "297440",
    "end": "303380"
  },
  {
    "text": "one is really not common to see on devices we don't see the two this this type of mode using usage by devices on",
    "start": "303380",
    "end": "310790"
  },
  {
    "text": "in the wild okay so this was a good idea to implement two devices to connect each",
    "start": "310790",
    "end": "317630"
  },
  {
    "text": "other but it didn't it didn't work a band or didn't implement it and it's not",
    "start": "317630",
    "end": "323570"
  },
  {
    "text": "being used and that's where Wi-Fi direct come into play so Wi-Fi Alliance they",
    "start": "323570",
    "end": "330440"
  },
  {
    "text": "decided to make something similar to a dock but without an HEC and hence in a dog but using the infrastructure mode",
    "start": "330440",
    "end": "337370"
  },
  {
    "text": "that I talked in the at the beginning so how does this work is as you can see here this is really similar to the first",
    "start": "337370",
    "end": "344210"
  },
  {
    "text": "graphic I showed that we have an access point in this case is called peer to peer group owner then we have the",
    "start": "344210",
    "end": "351200"
  },
  {
    "text": "stations that in this case they are called peer-to-peer clients and finally we have a peer to peer group that is the",
    "start": "351200",
    "end": "357830"
  },
  {
    "text": "network itself so this is its basis as I mentioned before this protocol is based",
    "start": "357830",
    "end": "362960"
  },
  {
    "text": "on infrastructure mode the difference is that in this case I put a printer there but any of the peer-to-peer clients can",
    "start": "362960",
    "end": "371300"
  },
  {
    "text": "take the peer to peer group old owner drawl okay this peer to peer group owner",
    "start": "371300",
    "end": "377600"
  },
  {
    "text": "is sucked in like an access point but who is gonna be the access point or the",
    "start": "377600",
    "end": "383210"
  },
  {
    "text": "peer to peer group owner is decided at some moment of the negotiation of this",
    "start": "383210",
    "end": "388760"
  },
  {
    "text": "protocol okay so any of these can take an access control so there are two key components",
    "start": "388760",
    "end": "396140"
  },
  {
    "text": "in this in this episode that I think is really",
    "start": "396140",
    "end": "401280"
  },
  {
    "text": "important and concerns security is that the first one is called peer-to-peer a",
    "start": "401280",
    "end": "407490"
  },
  {
    "text": "concurrent device appear to be a concurrent device can be connected as an",
    "start": "407490",
    "end": "412500"
  },
  {
    "text": "ax station to a wireless network and at the same time we a PI appear to be a",
    "start": "412500",
    "end": "418410"
  },
  {
    "text": "group owner for other peer-to-peer devices to connect to him so in this case my printer is connected wirelessly",
    "start": "418410",
    "end": "425550"
  },
  {
    "text": "to my network and at the same time has another computer that is connected directly to the printer and the other",
    "start": "425550",
    "end": "432900"
  },
  {
    "text": "component that is really important is no known as cross connection and what is",
    "start": "432900",
    "end": "438090"
  },
  {
    "text": "close connection is if you're a peer to peer group owner have support for cross connection it can let peer to peer",
    "start": "438090",
    "end": "445290"
  },
  {
    "text": "clients to talk and communicate directly to peer to peer to stations and I am the",
    "start": "445290",
    "end": "450540"
  },
  {
    "text": "access point itself so you can use the printer as a bridge to connect to the",
    "start": "450540",
    "end": "455700"
  },
  {
    "text": "devices the to the printer - sorry - a network the printer is using so these",
    "start": "455700",
    "end": "460980"
  },
  {
    "text": "two components are really important to take note because we are going to talk later there are some devices they don't",
    "start": "460980",
    "end": "467790"
  },
  {
    "text": "have a really good implementation and then because in the specification again",
    "start": "467790",
    "end": "473580"
  },
  {
    "text": "they say that cross how cross connection is implemented is out of the scope of",
    "start": "473580",
    "end": "478920"
  },
  {
    "text": "the specification this type of things can happen if the vendor doesn't take a",
    "start": "478920",
    "end": "484190"
  },
  {
    "text": "really good choice or a really good approach to make a solution for this the",
    "start": "484190",
    "end": "490650"
  },
  {
    "text": "printers nowadays a qualify wire they have lot of supports in this case a printer can be connected through a wire",
    "start": "490650",
    "end": "497220"
  },
  {
    "text": "and you can say that if you're not using Wi-Fi you don't care because your your network is wire so you are not in danger",
    "start": "497220",
    "end": "503820"
  },
  {
    "text": "but maybe if your printer supports peer to peer and someone is able to connect",
    "start": "503820",
    "end": "509130"
  },
  {
    "text": "to your printer and support cross connection you couldn't end up being able by the",
    "start": "509130",
    "end": "515159"
  },
  {
    "text": "attacker could be able to connect and use your wire network so this these two components are really important so now",
    "start": "515160",
    "end": "524070"
  },
  {
    "text": "I'm going to start talking about the discovery okay",
    "start": "524070",
    "end": "528920"
  },
  {
    "text": "the discovery process to start talking about peer-to-peer discovery first I have to explain a little bit about how",
    "start": "529180",
    "end": "535510"
  },
  {
    "text": "802 11 discovery works this is quite easy many people maybe know this but I",
    "start": "535510",
    "end": "543040"
  },
  {
    "text": "have to splain it to understand the following but you have an access point and the exit point is sending beacon",
    "start": "543040",
    "end": "548560"
  },
  {
    "text": "frames transmitting beacon frames to the air and the stations can process this beacon frames and identify and found",
    "start": "548560",
    "end": "555460"
  },
  {
    "text": "final network this is the main method call a passive scanning okay",
    "start": "555460",
    "end": "561460"
  },
  {
    "text": "without the station being a transmute in any frame the station can detect different beacon frames from the river",
    "start": "561460",
    "end": "568360"
  },
  {
    "text": "different access point that are here for example and identify all the options that they have to connect or network",
    "start": "568360",
    "end": "575820"
  },
  {
    "text": "then we have the active scanning okay that beam scanning the station sent",
    "start": "575910",
    "end": "581320"
  },
  {
    "text": "proof request frames to axon and a specific access point or they can send broadcast access probe request frames",
    "start": "581320",
    "end": "588070"
  },
  {
    "text": "and then the excess fondant respond this frame or once they process the prayer",
    "start": "588070",
    "end": "593500"
  },
  {
    "text": "request they will send up respond frame to a station with all the information of the network so the client can decide if",
    "start": "593500",
    "end": "600010"
  },
  {
    "text": "they want to connect or not to add network in both cases the network interface is sweeping through all the",
    "start": "600010",
    "end": "606279"
  },
  {
    "text": "channels the card support to find all the access points they can connect to a",
    "start": "606279",
    "end": "614310"
  },
  {
    "text": "Wi-Fi sorry Wi-Fi direct specification and the peer",
    "start": "614310",
    "end": "619779"
  },
  {
    "text": "to peer group owner remember I mentioned that appear to be a group owner is almost as the same as an access point",
    "start": "619779",
    "end": "625570"
  },
  {
    "text": "well the access point usually use the beacon frame to announce a network well",
    "start": "625570",
    "end": "630820"
  },
  {
    "text": "the appeal to group owner is gonna also use the beacon frame to to announce the",
    "start": "630820",
    "end": "636640"
  },
  {
    "text": "network so this is station that here it doesn't say a peer-to-peer device with a",
    "start": "636640",
    "end": "642070"
  },
  {
    "text": "normal station just like any machine you can have here is gonna be able to find the peer to peer group owner because",
    "start": "642070",
    "end": "648940"
  },
  {
    "text": "it's the same as an access point so if you sometimes so a network does it says",
    "start": "648940",
    "end": "654310"
  },
  {
    "text": "direct - something that is appear to be a group owner so if you have ever seen",
    "start": "654310",
    "end": "659560"
  },
  {
    "text": "that you already have a some contact with peer-to-peer device and the Wi-Fi direct specification but",
    "start": "659560",
    "end": "666850"
  },
  {
    "text": "there are devices that they are not being a peer to peer group owner remember that peer to peer group owners",
    "start": "666850",
    "end": "672160"
  },
  {
    "text": "is the access point of Wi-Fi direct well are they some devices they don't have to",
    "start": "672160",
    "end": "678459"
  },
  {
    "text": "be on a peer-to-peer group owner they want to negotiate who is gonna be the the group owner so there are devices",
    "start": "678459",
    "end": "686440"
  },
  {
    "text": "that they are on different states we have listened state and search state so",
    "start": "686440",
    "end": "692649"
  },
  {
    "text": "here you have two peer-to-peer devices and one peer-to-peer device will send a probe request frame the bill to be",
    "start": "692649",
    "end": "699399"
  },
  {
    "text": "otherwise is going to process the frame that has to have certain specific characteristics to work and then if this",
    "start": "699399",
    "end": "707380"
  },
  {
    "text": "frame is a piece off I did add a Wi-Fi direct search or scan then the",
    "start": "707380",
    "end": "715029"
  },
  {
    "text": "peer-to-peer device is going to send a report response frame the only thing",
    "start": "715029",
    "end": "720100"
  },
  {
    "text": "here that is a little difficult to understand is that both devices are sweeping the channels at the same time",
    "start": "720100",
    "end": "726370"
  },
  {
    "text": "so sometimes it take a little more time to discover a device because usually a",
    "start": "726370",
    "end": "732850"
  },
  {
    "text": "access points they are fix it on a channel they don't sweep so in this case they are gonna have shipping channels",
    "start": "732850",
    "end": "738940"
  },
  {
    "text": "and they try to find each other so at one moment one device is on a listen",
    "start": "738940",
    "end": "744970"
  },
  {
    "text": "state and it's waiting for proof requests and then it switches to an active a state to a search state and it",
    "start": "744970",
    "end": "751690"
  },
  {
    "text": "will send probe request frames so he can announce he is there to other peer-to-peer devices so it's important",
    "start": "751690",
    "end": "758980"
  },
  {
    "text": "to understand that to do this we have to do active scanning so passive scanning tools are not going to work for for many",
    "start": "758980",
    "end": "765250"
  },
  {
    "text": "peer-to-peer devices so here is a probe request frame we can see here that it's",
    "start": "765250",
    "end": "771639"
  },
  {
    "text": "a broadcast it does it cast a destination address broadcast an SSID broadcast and we have here the SSID that",
    "start": "771639",
    "end": "779920"
  },
  {
    "text": "casts a white card this worker is the Wi-Fi direct worker and here we come",
    "start": "779920",
    "end": "785459"
  },
  {
    "text": "weps and peer-to-peer information elements information elements are containers that go inside management",
    "start": "785459",
    "end": "792069"
  },
  {
    "text": "frames on 802 dot 11 frames and the information in this case these two",
    "start": "792069",
    "end": "798760"
  },
  {
    "text": "information elements and the SSID are the characteristics peer-to-peer the",
    "start": "798760",
    "end": "803950"
  },
  {
    "text": "devices require to be able to find each other once the device that is listening",
    "start": "803950",
    "end": "811360"
  },
  {
    "text": "receive this beacon for a request frame it will it will send this prove response",
    "start": "811360",
    "end": "816550"
  },
  {
    "text": "frame this proposed frame is directed only to the they want the the appeal device that is searching and it will",
    "start": "816550",
    "end": "824500"
  },
  {
    "text": "cover the SSID the discussed the peer-to-peer Weicker the WPS and",
    "start": "824500",
    "end": "829990"
  },
  {
    "text": "peer-to-peer information element and I was only putting this here just to show that one of the it costs a lot of",
    "start": "829990",
    "end": "838000"
  },
  {
    "text": "different information inside information element but the peer-to-peer at one part the casa device name this is the device",
    "start": "838000",
    "end": "844510"
  },
  {
    "text": "name that will indentify this this device there is also a note in the",
    "start": "844510",
    "end": "849760"
  },
  {
    "text": "specification if someone else is someone after the talk wants to talk about the specification I have a copy here my mug",
    "start": "849760",
    "end": "856420"
  },
  {
    "text": "so we I can show you there are lot of things that they are out of the coppa specification for example appear to be a",
    "start": "856420",
    "end": "863320"
  },
  {
    "text": "device name are not unique so if you come to TVs that have the same name",
    "start": "863320",
    "end": "869050"
  },
  {
    "text": "you are not going to be able to identify what TV you you you want to connect so in the specification it says that maybe",
    "start": "869050",
    "end": "875019"
  },
  {
    "text": "you should try several times to connect to device until you find what you want this is a specification of a protocol",
    "start": "875019",
    "end": "881110"
  },
  {
    "text": "not not someone trying to cook something and then we have the service discovery",
    "start": "881110",
    "end": "888670"
  },
  {
    "text": "okay that is another functionality that peer-to-peer device has that is able to",
    "start": "888670",
    "end": "896320"
  },
  {
    "text": "discover for a specific service let's say I want to find out a peer-to-peer device that has printing functionality",
    "start": "896320",
    "end": "901839"
  },
  {
    "text": "because I want to put in something so you can send some in this case they are",
    "start": "901839",
    "end": "907209"
  },
  {
    "text": "action frames they are also management frames you can say as send a service discovery query frame to a specific p2p",
    "start": "907209",
    "end": "914889"
  },
  {
    "text": "device and his gonna reply with a service discovery response frame the",
    "start": "914889",
    "end": "919959"
  },
  {
    "text": "interesting thing here is these frames are not encrypted because they are management frames and we are not even",
    "start": "919959",
    "end": "926649"
  },
  {
    "text": "associated or authenticated to the device because we are talking about discovery discovery part",
    "start": "926649",
    "end": "932560"
  },
  {
    "text": "okay so all this is unencrypted and cannot be encrypted and the funny thing",
    "start": "932560",
    "end": "938110"
  },
  {
    "text": "here is that the content of this of the suction frames is usually a part of",
    "start": "938110",
    "end": "945550"
  },
  {
    "text": "another protocol so these suction frames use OPM P whenever some plug-and-play Bonjour printer services and different",
    "start": "945550",
    "end": "953950"
  },
  {
    "text": "protocols die they have content inside these frames so we can know what type of",
    "start": "953950",
    "end": "960279"
  },
  {
    "text": "service someone is looking okay now if we know that we can also say okay hi I'm",
    "start": "960279",
    "end": "965829"
  },
  {
    "text": "a printer connect to me so you can try to impersonate otherwise but not not",
    "start": "965829",
    "end": "970930"
  },
  {
    "text": "also that these these depending on the implementation of these of these service",
    "start": "970930",
    "end": "976870"
  },
  {
    "text": "discovery these frames can be grabbed from here like this portion of the frame",
    "start": "976870",
    "end": "982329"
  },
  {
    "text": "can be taken and the device is gonna insert an ipv6 frame inside the device",
    "start": "982329",
    "end": "988690"
  },
  {
    "text": "okay inside like if someone is connected to him and it will insert the the",
    "start": "988690",
    "end": "993850"
  },
  {
    "text": "protocol that he identified there so depending on implementation this could be quite dangerous because we are a cop",
    "start": "993850",
    "end": "1000750"
  },
  {
    "text": "sound like permeability between the network that is authenticated and otherwise that is not that indicated",
    "start": "1000750",
    "end": "1006959"
  },
  {
    "text": "that could be even able to inject some type of frames inside the network so I",
    "start": "1006959",
    "end": "1014430"
  },
  {
    "text": "like to talk about theory but it's fun oh it's better to talk about practical",
    "start": "1014430",
    "end": "1020310"
  },
  {
    "text": "things or yes practic so I'm going to talk about how you can do all the things",
    "start": "1020310",
    "end": "1026400"
  },
  {
    "text": "that they are quite easy the first thing is if you know about a network cards",
    "start": "1026400",
    "end": "1031980"
  },
  {
    "text": "wireless network card you should know this card is really cheap and it works really really good and it could be used",
    "start": "1031980",
    "end": "1038550"
  },
  {
    "text": "to play around with Wi-Fi direct protocol so if you don't have that car",
    "start": "1038550",
    "end": "1044819"
  },
  {
    "text": "and you want to know if you can again do things with Wi-Fi direct you should run this common on a Linux",
    "start": "1044819",
    "end": "1050190"
  },
  {
    "text": "machine and I will show a lot of information of your interface and if the supporting interface mode has",
    "start": "1050190",
    "end": "1057210"
  },
  {
    "text": "peer-to-peer client and peer to peer group owner you're going to be able to do Wi-Fi direct",
    "start": "1057210",
    "end": "1065090"
  },
  {
    "text": "let's but how how you can interact with this protocol well in Linux machines you",
    "start": "1065240",
    "end": "1070920"
  },
  {
    "text": "should use you should use WEP a supplicant okay it more distribution",
    "start": "1070920",
    "end": "1076400"
  },
  {
    "text": "this has no building a peer-to-peer support or Wi-Fi direct support they",
    "start": "1076400",
    "end": "1081780"
  },
  {
    "text": "don't have it building so you should download the source code and build it yourself it's quite easy you should read",
    "start": "1081780",
    "end": "1087030"
  },
  {
    "text": "the documentation it's really easy you don't need too much stuff to do it once you do that you have to build a",
    "start": "1087030",
    "end": "1093360"
  },
  {
    "text": "peer-to-peer configuration that is again really quick and really easy I will show the end of the conference I'm releasing",
    "start": "1093360",
    "end": "1100260"
  },
  {
    "text": "some tools and some examples you can look on in there and here I'm running on",
    "start": "1100260",
    "end": "1105750"
  },
  {
    "text": "peer and repeat client that is a client that connect to a supplicant I'm running peer-to-peer find that will perform the",
    "start": "1105750",
    "end": "1113040"
  },
  {
    "text": "discovery I mentioned before and I give up five seconds timeout as you can see here I found at least I find three",
    "start": "1113040",
    "end": "1120300"
  },
  {
    "text": "devices two printers and one one Samsung Smart TV you can use also Android",
    "start": "1120300",
    "end": "1126990"
  },
  {
    "text": "Android cast Wi-Fi direct support from Android 4 so you can go to your Wi-Fi",
    "start": "1126990",
    "end": "1133050"
  },
  {
    "text": "advanced configuration and you can use Wi-Fi direct from there it's quite easy and you can connect to a printer with",
    "start": "1133050",
    "end": "1139080"
  },
  {
    "text": "your phone and use all the printers services it's it's really easy to use but you have a lot of limitations unless",
    "start": "1139080",
    "end": "1145950"
  },
  {
    "text": "you start playing with the Android UI P so you can you can do something about and then the last thing I want to",
    "start": "1145950",
    "end": "1153300"
  },
  {
    "text": "mention is if you use tools like kismet or use tools as error dump you're going",
    "start": "1153300",
    "end": "1158460"
  },
  {
    "text": "to be able to see these devices as I mentioned before these are peer to peer group owners so peer to peer group",
    "start": "1158460",
    "end": "1164760"
  },
  {
    "text": "owners you are gonna be able to find them and also connect them because they support legacy devices so you can",
    "start": "1164760",
    "end": "1170670"
  },
  {
    "text": "connect the peer to peer group owners one day appear to be grow group has been built if there's no peer to peer group",
    "start": "1170670",
    "end": "1177540"
  },
  {
    "text": "build only peer to peer devices can connect each other and this is a tool",
    "start": "1177540",
    "end": "1184410"
  },
  {
    "text": "that again I'm gonna put at the end of the slides is a tool I I called it in",
    "start": "1184410",
    "end": "1190140"
  },
  {
    "text": "Python that is able to execute the peer-to-peer discovery without requiring",
    "start": "1190140",
    "end": "1195840"
  },
  {
    "text": "a specific card if car support injection and monitor mode you're gonna be able to use these and you will get a lot more information not",
    "start": "1195840",
    "end": "1203220"
  },
  {
    "text": "only the capabilities and another information we are here in the information element but also the WPS",
    "start": "1203220",
    "end": "1209639"
  },
  {
    "text": "information and you will get serial numbers or manufacturer on different things so let's talk about group",
    "start": "1209639",
    "end": "1217590"
  },
  {
    "text": "formation as I mentioned unless one device is already in a peer-to-peer a",
    "start": "1217590",
    "end": "1223109"
  },
  {
    "text": "group owner role devices will try to find each other and then they are gonna form a peer to peer group to form this",
    "start": "1223109",
    "end": "1229979"
  },
  {
    "text": "group we need to negotiate who is gonna be the access point okay so we have a three-way handshake here we send the",
    "start": "1229979",
    "end": "1237599"
  },
  {
    "text": "negotiation request frame then we say the negotiation respond frame and finally the confirm frame in this frame",
    "start": "1237599",
    "end": "1243749"
  },
  {
    "text": "it's important to know that there are two important things that they are",
    "start": "1243749",
    "end": "1248940"
  },
  {
    "text": "defined here who is gonna be the access point that the device is send a specific",
    "start": "1248940",
    "end": "1255109"
  },
  {
    "text": "specific value on the frames that is the desire for them to be the access point so they discussed that and then they",
    "start": "1255109",
    "end": "1263249"
  },
  {
    "text": "define what channel they are gonna use what channel they are gonna be listening so once they decided this they say okay",
    "start": "1263249",
    "end": "1271019"
  },
  {
    "text": "I'm gonna be on channel 9 and then they appear to be a group owner is gonna be it's gonna set his Chris Network in the",
    "start": "1271019",
    "end": "1277440"
  },
  {
    "text": "fridge from channel 9 and it's gonna turn him into an access point once this",
    "start": "1277440",
    "end": "1283109"
  },
  {
    "text": "the peer to peer group group owners has been define it will start sending beacon frames and then any client any station",
    "start": "1283109",
    "end": "1290609"
  },
  {
    "text": "that has support for Wi-Fi 802 dot 11mm infrastructure mode is gonna be able to",
    "start": "1290609",
    "end": "1296549"
  },
  {
    "text": "use this device the important here is the provisioning is how these devices share the credentials how they",
    "start": "1296549",
    "end": "1303720"
  },
  {
    "text": "authenticate each other well in that case they are going to use WPS the",
    "start": "1303720",
    "end": "1309419"
  },
  {
    "text": "protocol I mentioned before that was design by Wi-Fi Alliance the protocol has several issues if you look in the",
    "start": "1309419",
    "end": "1316049"
  },
  {
    "text": "internet there's I think two of two or three years ago there was some guy that",
    "start": "1316049",
    "end": "1322049"
  },
  {
    "text": "discovered how to do perform a pin brute-force attack and it broke most of",
    "start": "1322049",
    "end": "1328409"
  },
  {
    "text": "the YC most of access point I'll cut WPA support so using the EPS could be an",
    "start": "1328409",
    "end": "1334890"
  },
  {
    "text": "issue in this case also how we can monitor Wi-Fi direct as I mentioned before",
    "start": "1334890",
    "end": "1342410"
  },
  {
    "text": "devices are sweeping channel from channel and if you want to get all the traffic from this peer-to-peer devices",
    "start": "1342410",
    "end": "1348990"
  },
  {
    "text": "even in the negotiation phase you're going to be a you you need to support monitoring several channels at the same",
    "start": "1348990",
    "end": "1354630"
  },
  {
    "text": "time I'm not going to talk too much about how to do that but it's important",
    "start": "1354630",
    "end": "1360210"
  },
  {
    "text": "to know that may sometimes put in like twelve or fifteen or twenty USB card it",
    "start": "1360210",
    "end": "1366900"
  },
  {
    "text": "is not going to work so you should look for other solutions but monitoring several channels at the same time is an",
    "start": "1366900",
    "end": "1372990"
  },
  {
    "text": "important thing here when we are talking about peer to peer to peer to peer",
    "start": "1372990",
    "end": "1378450"
  },
  {
    "text": "devices monitoring so I'm not going to talk talk about some attacks that I have",
    "start": "1378450",
    "end": "1385500"
  },
  {
    "text": "here first I'm going to talk about HP",
    "start": "1385500",
    "end": "1391500"
  },
  {
    "text": "printers so HP printers that had support for Wi-Fi direct that if you go to the",
    "start": "1391500",
    "end": "1398010"
  },
  {
    "text": "web page of HP there are a lot of new models I think two years from now you",
    "start": "1398010",
    "end": "1403650"
  },
  {
    "text": "know Twitter announced or two years back there there are starts they start",
    "start": "1403650",
    "end": "1411630"
  },
  {
    "text": "releasing new models and these models have Wi-Fi direct support by default so what's the issue of kind Wi-Fi direct by",
    "start": "1411630",
    "end": "1418950"
  },
  {
    "text": "by default is not an issue in itself the problem is how they implement it so this",
    "start": "1418950",
    "end": "1426660"
  },
  {
    "text": "is the configuration of the printer Wi-Fi direct is enabled by default and the issue here is this one they have the",
    "start": "1426660",
    "end": "1434940"
  },
  {
    "text": "printer by default it starts a peer to peer group you don't need to look for",
    "start": "1434940",
    "end": "1441060"
  },
  {
    "text": "for for a peer-to-peer device and start the negotiation and say ok printer",
    "start": "1441060",
    "end": "1446310"
  },
  {
    "text": "you're gonna be the group owner the printer by default is gonna set appear to be a group and it's gonna be the",
    "start": "1446310",
    "end": "1452700"
  },
  {
    "text": "group owner without any peer-to-peer client needed to do that and then you",
    "start": "1452700",
    "end": "1458280"
  },
  {
    "text": "have the connection method to automatic the issue here is that when you have this in automatic you",
    "start": "1458280",
    "end": "1464460"
  },
  {
    "text": "two issues the first one is that the Wi-Fi direct passphrase that is the passphrase of the access point that the",
    "start": "1464460",
    "end": "1471059"
  },
  {
    "text": "printer is providing is one two three four five six seven eight",
    "start": "1471059",
    "end": "1476490"
  },
  {
    "text": "that is a password so anyone nearby can connect to a printer with any device",
    "start": "1476490",
    "end": "1482789"
  },
  {
    "text": "because as I mentioned before this is already a peer to peer group formation sorry appear to be a group already form",
    "start": "1482789",
    "end": "1490559"
  },
  {
    "text": "by the printer so any device you don't need even to use a peer-to-peer device that to connect to the printer once you",
    "start": "1490559",
    "end": "1498240"
  },
  {
    "text": "are connected to a printer you cob you can print you can scan you can use in fact the web server that has no",
    "start": "1498240",
    "end": "1504419"
  },
  {
    "text": "authentication and you can disable femural updates set a proxy server for",
    "start": "1504419",
    "end": "1510659"
  },
  {
    "text": "the printer or even try to attack that nice attacks the world lease I think the",
    "start": "1510659",
    "end": "1517889"
  },
  {
    "text": "first part of the year of the last year last year that you can attack the Shedd",
    "start": "1517889",
    "end": "1523200"
  },
  {
    "text": "printer port I think nine nine thousand one hundred and you can try to read the",
    "start": "1523200",
    "end": "1528450"
  },
  {
    "text": "memory of the printer to see what were they printer before before we get access to the printer that is the first problem",
    "start": "1528450",
    "end": "1534720"
  },
  {
    "text": "the second problem is that also appeared to be our device when when the automatic mode is is the enable any peer-to-peer",
    "start": "1534720",
    "end": "1542309"
  },
  {
    "text": "device can connect directly with no authentication and no notification and",
    "start": "1542309",
    "end": "1547320"
  },
  {
    "text": "no at all for the user so maybe you have your printer there and someone is you city and you will never know this let's",
    "start": "1547320",
    "end": "1555960"
  },
  {
    "text": "say you change the connection metal because you say okay connection met on automatic is really a bad hot choice",
    "start": "1555960",
    "end": "1561360"
  },
  {
    "text": "let's change it to manual and use the generate button here to generate me a new well here apparently the",
    "start": "1561360",
    "end": "1568409"
  },
  {
    "text": "implementation confuse the Wi-Fi pass phrase that is used on one dual EPA and",
    "start": "1568409",
    "end": "1574379"
  },
  {
    "text": "the VA to within the pin of duly PS the pin of the rupiah's is limited to eight",
    "start": "1574379",
    "end": "1580499"
  },
  {
    "text": "chars and only digits the passphrase is not limited to that is limited to 64",
    "start": "1580499",
    "end": "1586110"
  },
  {
    "text": "characters so every time you push generate or you change to manual it will generate really see to crack passphrase",
    "start": "1586110",
    "end": "1593759"
  },
  {
    "text": "for the network so if you grab the contract between a printer and a value legitimate device you're going to be",
    "start": "1593759",
    "end": "1599980"
  },
  {
    "text": "able to crack these in two or three minutes with any computer so it's really",
    "start": "1599980",
    "end": "1605500"
  },
  {
    "text": "bad so Sam Soon decided to something",
    "start": "1605500",
    "end": "1610540"
  },
  {
    "text": "similar and some some printer costs and again used by default a network II that",
    "start": "1610540",
    "end": "1615970"
  },
  {
    "text": "is limited to H characters and only digits so again if you grab the",
    "start": "1615970",
    "end": "1621100"
  },
  {
    "text": "handshake it's gonna be really really easy to crack the the car the the",
    "start": "1621100",
    "end": "1626140"
  },
  {
    "text": "handshake and get access to the printer remember that this printer is providing the access point so you will never",
    "start": "1626140",
    "end": "1632049"
  },
  {
    "text": "notice something we're inside your network because no one is connecting to your network is someone connected to",
    "start": "1632049",
    "end": "1638169"
  },
  {
    "text": "your printer directly not going through your network so any IDs IPS or anything",
    "start": "1638169",
    "end": "1643630"
  },
  {
    "text": "else you have it is not gonna be able to detect this because this is another access point this is similar to a rogue",
    "start": "1643630",
    "end": "1649360"
  },
  {
    "text": "access point on a network that is Wi-Fi direct more or less and there's another",
    "start": "1649360",
    "end": "1654880"
  },
  {
    "text": "good demonstration that I will show you now that I put fishing for a printer",
    "start": "1654880",
    "end": "1661210"
  },
  {
    "text": "because it's more or less like an efficient attack because we know that",
    "start": "1661210",
    "end": "1667150"
  },
  {
    "text": "usually people when they work near printers or when they work if you go to",
    "start": "1667150",
    "end": "1673179"
  },
  {
    "text": "print something on your on your office and you go they are the printer is having LEDs everywhere I'm flashing and",
    "start": "1673179",
    "end": "1679030"
  },
  {
    "text": "what is my sheet of paper I don't find my print shop work and you stop written all the only all the bouton sudden",
    "start": "1679030",
    "end": "1685299"
  },
  {
    "text": "something happens so that is how printer works in this case oh sorry I will show",
    "start": "1685299",
    "end": "1695530"
  },
  {
    "text": "you here I have the Lippe supplicant",
    "start": "1695530",
    "end": "1704530"
  },
  {
    "text": "running here with my network interface appear to be a configuration file the driver here have a client this is a",
    "start": "1704530",
    "end": "1711460"
  },
  {
    "text": "three different terminals wait and here I have a root terminal so I can show you",
    "start": "1711460",
    "end": "1718270"
  },
  {
    "text": "then what what is going on so I will run the peer-to-peer find to look for",
    "start": "1718270",
    "end": "1724059"
  },
  {
    "text": "peer-to-peer devices and we put four seconds timeout",
    "start": "1724059",
    "end": "1730050"
  },
  {
    "text": "I'm never able to find it the printer there so this is a samsung printer I",
    "start": "1733409",
    "end": "1741089"
  },
  {
    "text": "will copy the peer-to-peer device address that just justice' as a note the",
    "start": "1741089",
    "end": "1748209"
  },
  {
    "text": "peer-to-peer device address is not the same as the peer remember when I talk about concurrent operations that the",
    "start": "1748209",
    "end": "1755019"
  },
  {
    "text": "printer can be connected into your wireless network and also provide appear to be a group owner the MAC address is",
    "start": "1755019",
    "end": "1760749"
  },
  {
    "text": "different so again if you are looking for some sometimes when we are looking for soft a piece or roll-up s we are",
    "start": "1760749",
    "end": "1768129"
  },
  {
    "text": "gonna we are gonna look for the same mcalary's of the device we have connected to our network or something",
    "start": "1768129",
    "end": "1773649"
  },
  {
    "text": "similar well this is different so sometimes it's hard to detect so I'm going to execute",
    "start": "1773649",
    "end": "1780639"
  },
  {
    "text": "the peer-to-peer connect command with a peer-to-peer device address finally I",
    "start": "1780639",
    "end": "1787089"
  },
  {
    "text": "will set these to use the push button configuration they do it is one of the",
    "start": "1787089",
    "end": "1793719"
  },
  {
    "text": "methods that WPS provides to authenticate to a device you can use push photon configuration you can use",
    "start": "1793719",
    "end": "1800079"
  },
  {
    "text": "NFC if you are near a device that has an F an NFC tag and you can use a a pin",
    "start": "1800079",
    "end": "1806229"
  },
  {
    "text": "number in this case I'm going to use the push photon configuration and finally I",
    "start": "1806229",
    "end": "1811329"
  },
  {
    "text": "gonna set this value to join and that is because as I mentioned before the",
    "start": "1811329",
    "end": "1816969"
  },
  {
    "text": "printer already have a peer to peer group owner is appeared to be a group",
    "start": "1816969",
    "end": "1822489"
  },
  {
    "text": "owner so they appear to be a group is already built so I have to join this peer to peer group so I will run this",
    "start": "1822489",
    "end": "1831419"
  },
  {
    "text": "and then we start seeing what is going on in the printer so this is my printer",
    "start": "1831989",
    "end": "1838869"
  },
  {
    "text": "I'm near by the Pioneer the printer and the printer is gonna do this you're",
    "start": "1838869",
    "end": "1845739"
  },
  {
    "text": "gonna start blinking this led this led here and it's hard to see here but if",
    "start": "1845739",
    "end": "1852489"
  },
  {
    "text": "you see here the printer is gonna start the motors and has got to start making noise so once I see the motor here and",
    "start": "1852489",
    "end": "1862929"
  },
  {
    "text": "blinking on the LEDs I say what is going on with my printer or or I don't know what is going on but",
    "start": "1862929",
    "end": "1868759"
  },
  {
    "text": "this button that says WPS I don't know what this means but it's flashing so I had to push it because is then easy",
    "start": "1868759",
    "end": "1876109"
  },
  {
    "text": "thing I have to do so I go there and push the button okay it is stopped doing",
    "start": "1876109",
    "end": "1885409"
  },
  {
    "text": "noise so this is good I can still use my printer and now I I gave access to",
    "start": "1885409",
    "end": "1891679"
  },
  {
    "text": "someone okay someone cause connecting now directly to my printer I gonna show you here that I can not only ping the",
    "start": "1891679",
    "end": "1898549"
  },
  {
    "text": "printer but I can also use the services",
    "start": "1898549",
    "end": "1903619"
  },
  {
    "text": "provided by the printer usually all the information all the implementations I",
    "start": "1903619",
    "end": "1909139"
  },
  {
    "text": "saw the same services that they are provided when the device is connected to a network are the same services that",
    "start": "1909139",
    "end": "1914779"
  },
  {
    "text": "they are provided to the peer-to-peer device interface so I'm gonna to execute",
    "start": "1914779",
    "end": "1920090"
  },
  {
    "text": "an nmap just to see what I have or what options I have I can see here I have J",
    "start": "1920090",
    "end": "1925639"
  },
  {
    "text": "direct and different services and I have a TCP server sorry web server so I'm",
    "start": "1925639",
    "end": "1935330"
  },
  {
    "text": "going to connect to the web server so",
    "start": "1935330",
    "end": "1940690"
  },
  {
    "text": "that's all I can connect to a printer and use whatever I want I can print with the printer I can connect I try to",
    "start": "1945650",
    "end": "1951740"
  },
  {
    "text": "configure the printer I can do anything so the interesting thing here is if you",
    "start": "1951740",
    "end": "1957559"
  },
  {
    "text": "if you think of yourself what would you do if you have a printer that is doing",
    "start": "1957559",
    "end": "1963500"
  },
  {
    "text": "this crazy thing noise and everything",
    "start": "1963500",
    "end": "1968140"
  },
  {
    "text": "like five times in a row okay five minutes the printer is doing is letting",
    "start": "1969370",
    "end": "1976880"
  },
  {
    "text": "lets all you want to say what is going on with this printer you're gonna go there and press a button so this is fishing with a printer okay so you",
    "start": "1976880",
    "end": "1984890"
  },
  {
    "text": "started sending sending fragment in someone near the printer is gonna say what is going on with this I press this",
    "start": "1984890",
    "end": "1990080"
  },
  {
    "text": "button all stops great I'll go back to my to my place and that's all",
    "start": "1990080",
    "end": "1996380"
  },
  {
    "text": "so that is our fishing for a printer the issue here to understand what is going on is that when you use PA push photon",
    "start": "1996380",
    "end": "2003670"
  },
  {
    "text": "configuration the WPS a specification mentions that are both on that can be",
    "start": "2003670",
    "end": "2010450"
  },
  {
    "text": "physical button or a butyl button is going to be displayed on both devices and you have to click both devices to",
    "start": "2010450",
    "end": "2016960"
  },
  {
    "text": "authenticate that the devices want to connect each other in this case you're going to brute force and send unlimited",
    "start": "2016960",
    "end": "2022770"
  },
  {
    "text": "push required push button request to the printer until someone pushes the button and you get access to the printer once",
    "start": "2022770",
    "end": "2029770"
  },
  {
    "text": "you had access to the printer you have to chain another attack explained the printer to try to get access to a",
    "start": "2029770",
    "end": "2036429"
  },
  {
    "text": "network or the network the printer is connected to if not you are gonna try to attack the printer itself so let's talk",
    "start": "2036429",
    "end": "2046330"
  },
  {
    "text": "a little bit about Smart TVs this is Samsung Smart TVs I know that I",
    "start": "2046330",
    "end": "2053260"
  },
  {
    "text": "have some discussion with some guys because they told me most Smart TVs do the same implementation of Samsung but I",
    "start": "2053260",
    "end": "2059919"
  },
  {
    "text": "only get access to some go to Samsung TVs and a sanity onion panel researcher",
    "start": "2059919",
    "end": "2064960"
  },
  {
    "text": "I'm not able to buy 10 different TVs so this is a TV I have am at home I",
    "start": "2064960",
    "end": "2070179"
  },
  {
    "text": "attacked my own TV that's all I can do but apparently the same issue is",
    "start": "2070179",
    "end": "2076929"
  },
  {
    "text": "presented on a lot of different devices so some of them are to be has Wi-Fi",
    "start": "2076929",
    "end": "2083320"
  },
  {
    "text": "direct support again but default they are different with HP printers and some",
    "start": "2083320",
    "end": "2088360"
  },
  {
    "text": "some printers is that here the TV is not a peer to peer group it doesn't have a it doesn't build",
    "start": "2088360",
    "end": "2094659"
  },
  {
    "text": "appear to be a good for default by default so if you go around with your computer using kismet or any other",
    "start": "2094660",
    "end": "2101500"
  },
  {
    "text": "monitoring tools such as airdrop airdrop sorry there are the IRA lamp or any",
    "start": "2101500",
    "end": "2106660"
  },
  {
    "text": "other tool your we you're not going to be able to find this TVs this TV is",
    "start": "2106660",
    "end": "2112150"
  },
  {
    "text": "gonna be like in is as I mentioned before in the listen state the TV is",
    "start": "2112150",
    "end": "2117280"
  },
  {
    "text": "waiting for approval request specifically for a peer-to-peer device that is looking for a TV so the TV is",
    "start": "2117280",
    "end": "2125020"
  },
  {
    "text": "gonna be silently there waiting for someone to find it once you find the TV",
    "start": "2125020",
    "end": "2130170"
  },
  {
    "text": "the TV has a again another issue I",
    "start": "2130170",
    "end": "2135910"
  },
  {
    "text": "mentioned on the first slide is the peer-to-peer specification isn't define",
    "start": "2135910",
    "end": "2141910"
  },
  {
    "text": "how how we can connect several time to the same peer-to-peer device without",
    "start": "2141910",
    "end": "2147630"
  },
  {
    "text": "authenticating every time we want to connect to device so because that is out of the scope of the pacification samsung",
    "start": "2147630",
    "end": "2154300"
  },
  {
    "text": "decided to use a whitelist blacklist scheme so they have a multimedia device",
    "start": "2154300",
    "end": "2161260"
  },
  {
    "text": "monitor on your TV that usually nobody finds because it's like in the manual",
    "start": "2161260",
    "end": "2166270"
  },
  {
    "text": "really hide and once you have for example a tablet that was already",
    "start": "2166270",
    "end": "2172000"
  },
  {
    "text": "connected to a TV once it will say okay I will allow this tablet to connect several more times because I come i I",
    "start": "2172000",
    "end": "2179590"
  },
  {
    "text": "the target was authenticated the first time I've now trust the tablet II is a good person okay so I will explain",
    "start": "2179590",
    "end": "2188770"
  },
  {
    "text": "everything and then finally I will explain what is issue the first time you try to connect with your device you will",
    "start": "2188770",
    "end": "2194470"
  },
  {
    "text": "have something like this this appear on your screen it will say fake peer-to-peer device name is attempting",
    "start": "2194470",
    "end": "2201100"
  },
  {
    "text": "to connect here is the real peer-to-peer device is attempting to connect or TV and with your remote control that is a",
    "start": "2201100",
    "end": "2208810"
  },
  {
    "text": "really secure component that cannot be impersonated ever the TV is gonna be the user of the",
    "start": "2208810",
    "end": "2218290"
  },
  {
    "text": "TV or owner is gonna select allow or deny to have access to this device",
    "start": "2218290",
    "end": "2224100"
  },
  {
    "text": "finally when you already are in there in the whitelist your device is gonna be every time you connect to a device it's",
    "start": "2224100",
    "end": "2230620"
  },
  {
    "text": "only gonna show this connecting to and the device name okay so what the issue",
    "start": "2230620",
    "end": "2237100"
  },
  {
    "text": "here is that they use mud filtering okay the way to authenticate the device that",
    "start": "2237100",
    "end": "2243520"
  },
  {
    "text": "was once validated that is a real device and you trust on the device you are",
    "start": "2243520",
    "end": "2249970"
  },
  {
    "text": "using the MAC address of the device that is really really easy to modify your",
    "start": "2249970",
    "end": "2255520"
  },
  {
    "text": "network to your MAC address for um for example my mom my computer here I can",
    "start": "2255520",
    "end": "2261130"
  },
  {
    "text": "change the MAC address wait so the device connect to the TV I grab a frame",
    "start": "2261130",
    "end": "2266380"
  },
  {
    "text": "I say okay this is a frame of a valid client I will with set that to my computer I disconnect there the legit",
    "start": "2266380",
    "end": "2273880"
  },
  {
    "text": "device and then I connect to the device and let's say we come back here let's",
    "start": "2273880",
    "end": "2279280"
  },
  {
    "text": "say I change my device name okay because maybe the guy if he seen something like",
    "start": "2279280",
    "end": "2285360"
  },
  {
    "text": "connecting to tablet and he wouldn't say ok but my tablet is there it's off how",
    "start": "2285360",
    "end": "2290770"
  },
  {
    "text": "kids can be connected maybe he turns like something weirds going on ok so in",
    "start": "2290770",
    "end": "2296320"
  },
  {
    "text": "this case you can change the device name because it's not used on there and the whitelist ok so you can put something",
    "start": "2296320",
    "end": "2302740"
  },
  {
    "text": "like connecting to and you replace the device name for the internet so your",
    "start": "2302740",
    "end": "2307840"
  },
  {
    "text": "TV's gonna show a message here that is connecting to the internet so that is a really common why I I will not get too",
    "start": "2307840",
    "end": "2314740"
  },
  {
    "text": "paranoid if my TV saying ok and connecting to the internet maybe something went wrong I don't know if he",
    "start": "2314740",
    "end": "2320200"
  },
  {
    "text": "connected so all this is really confusing for the client and if the guy",
    "start": "2320200",
    "end": "2325480"
  },
  {
    "text": "doesn't know what is going on this will go by and he never noticed that someone",
    "start": "2325480",
    "end": "2330490"
  },
  {
    "text": "is using the TV hey sorry this worried",
    "start": "2330490",
    "end": "2336630"
  },
  {
    "text": "finally I'm gonna talk about the value TV was traditional TV like that is the",
    "start": "2336630",
    "end": "2342460"
  },
  {
    "text": "worst implementation I I saw so far",
    "start": "2342460",
    "end": "2347490"
  },
  {
    "text": "but it's important to mention before I finish this Martinique has a lot of services okay so you can use a lot of",
    "start": "2347500",
    "end": "2354220"
  },
  {
    "text": "services with the TV once you are connected through peer-to-peer this is the worst but it affected me a lot",
    "start": "2354220",
    "end": "2361240"
  },
  {
    "text": "because I bought this device a lot of years ago and I use it in my house a lot",
    "start": "2361240",
    "end": "2366820"
  },
  {
    "text": "like one year and I never noticed that there was a perfect bridge to someone to",
    "start": "2366820",
    "end": "2372460"
  },
  {
    "text": "connect to my network and I will never notice this device no it's in the trash",
    "start": "2372460",
    "end": "2378130"
  },
  {
    "text": "I throw in a way but it's important to to to understand that the implementation",
    "start": "2378130",
    "end": "2384400"
  },
  {
    "text": "here is really bad and it changed with another attack okay again every time we",
    "start": "2384400",
    "end": "2390490"
  },
  {
    "text": "talk about Wi-Fi direct I only talk in abusing of the protocol to get access to the device how you exploit them to get",
    "start": "2390490",
    "end": "2397000"
  },
  {
    "text": "access to their network it depends on the configuration so once you connect to",
    "start": "2397000",
    "end": "2403180"
  },
  {
    "text": "the WB Western Digital TV live you have a lot of services you have someone for",
    "start": "2403180",
    "end": "2408850"
  },
  {
    "text": "example someone will let you interact with the device and all the mass storage devices that are plugged to the device",
    "start": "2408850",
    "end": "2415000"
  },
  {
    "text": "with read and write permission so anyone can write anything on any device",
    "start": "2415000",
    "end": "2420580"
  },
  {
    "text": "connected to the the media center it's also Casa this port that has a",
    "start": "2420580",
    "end": "2425740"
  },
  {
    "text": "proprietary protocol to use as remote control so you can remote control the device and for example make him to",
    "start": "2425740",
    "end": "2432970"
  },
  {
    "text": "navigate a specific website or do something like that and also Casa web server the issue with the web server is",
    "start": "2432970",
    "end": "2439480"
  },
  {
    "text": "that at least it has at least one or two remote code execution without authentication so the chain attack here",
    "start": "2439480",
    "end": "2447790"
  },
  {
    "text": "is I have the Western Digital TV plug on my computer someone is going to connect",
    "start": "2447790",
    "end": "2452980"
  },
  {
    "text": "and then we we is gonna talk the web",
    "start": "2452980",
    "end": "2457990"
  },
  {
    "text": "server of the Samba server and he's gonna write me some malware on my uma media on my mass storage device and I",
    "start": "2457990",
    "end": "2464530"
  },
  {
    "text": "will then grab it and put it on my computer or he's gonna lose something and he end up on in my network so this",
    "start": "2464530",
    "end": "2471640"
  },
  {
    "text": "was a really really bad implementation of Wi-Fi direct in everybody fault and no authentication and no notification so",
    "start": "2471640",
    "end": "2479590"
  },
  {
    "text": "I can be looking movie and I will never notice something is using my device to people and connect to my network finally I want to talk a",
    "start": "2479590",
    "end": "2487730"
  },
  {
    "text": "little bit about Android really quickly this implementation now is working fine",
    "start": "2487730",
    "end": "2494560"
  },
  {
    "text": "104 that was the first implementation it cuts on issues but this is a good",
    "start": "2494560",
    "end": "2499670"
  },
  {
    "text": "example of how complex is the implementation of a stack of a protocol when you're talking about a totally",
    "start": "2499670",
    "end": "2506750"
  },
  {
    "text": "sorry 802 hate o 2.11 you're talking about code on the film were running on",
    "start": "2506750",
    "end": "2514610"
  },
  {
    "text": "your network arm you have a kernel a driver or kernel module or kernel",
    "start": "2514610",
    "end": "2520190"
  },
  {
    "text": "extension depending on your operation system and then you have user space application that they also are",
    "start": "2520190",
    "end": "2525650"
  },
  {
    "text": "interacting with the wireless frames in this case we are going to go ended up",
    "start": "2525650",
    "end": "2530780"
  },
  {
    "text": "going to talk about the Alypius supplicant and how a frame that goes through all these layers end up male",
    "start": "2530780",
    "end": "2538010"
  },
  {
    "text": "sending an invalid frame disembodied frame ends up sending an invalid he bent",
    "start": "2538010",
    "end": "2543860"
  },
  {
    "text": "to the under framework and it will crush the device so here we have the Android",
    "start": "2543860",
    "end": "2550370"
  },
  {
    "text": "implementation on 104 this is quite old but again it's a really good example to show the complexity of a protocol and",
    "start": "2550370",
    "end": "2557840"
  },
  {
    "text": "how you know not only can attack bad implementations at a logic level but",
    "start": "2557840",
    "end": "2563990"
  },
  {
    "text": "also exploiting something below so here if we receive an event from the",
    "start": "2563990",
    "end": "2571760"
  },
  {
    "text": "supplicant and is malformed it will throw this exception to the to the to",
    "start": "2571760",
    "end": "2579590"
  },
  {
    "text": "the Wi-Fi monitor this is that this in an hour class but nobody handle this this event you know when the candle is",
    "start": "2579590",
    "end": "2586460"
  },
  {
    "text": "this deception so on a handle exception on Android that ends up sending to the",
    "start": "2586460",
    "end": "2592310"
  },
  {
    "text": "dalvik it will end up like restarting the dalvik machine so I only",
    "start": "2592310",
    "end": "2598250"
  },
  {
    "text": "want sending one frame to to an Android device a Wi-Fi direct frame crashes the device okay I will try to",
    "start": "2598250",
    "end": "2605240"
  },
  {
    "text": "show a demo so this is really quick",
    "start": "2605240",
    "end": "2612230"
  },
  {
    "text": "I got three different devices three different network cards three different kernels but what happened I sent",
    "start": "2612230",
    "end": "2620329"
  },
  {
    "text": "malformed frame the Motorola was the first one to crash then it's going to crush the solution again it remembers",
    "start": "2620329",
    "end": "2627380"
  },
  {
    "text": "it's only starting the dalvik VM and finally the the Samsung tablet is gonna",
    "start": "2627380",
    "end": "2634730"
  },
  {
    "text": "be restarted the important here as you can see is we are talking the last layer",
    "start": "2634730",
    "end": "2640579"
  },
  {
    "text": "of the implementation of the protocol implementation were able to bypass fewer",
    "start": "2640579",
    "end": "2649130"
  },
  {
    "text": "and kernel implementations so",
    "start": "2649130",
    "end": "2657549"
  },
  {
    "text": "conclusions our ability so Wi-Fi direct is there anyone can find it anyone can",
    "start": "2658720",
    "end": "2666050"
  },
  {
    "text": "use it as you can see here main vendors they have bad implementations some of",
    "start": "2666050",
    "end": "2671300"
  },
  {
    "text": "them refuse to fix them they say that there is no dangerous because Wi-Fi you",
    "start": "2671300",
    "end": "2677150"
  },
  {
    "text": "have to be near to attack Wi-Fi so I mean it doesn't matter for me it's a",
    "start": "2677150",
    "end": "2683510"
  },
  {
    "text": "problem then confusion we saw on the printer and another implementation smart",
    "start": "2683510",
    "end": "2689540"
  },
  {
    "text": "TV user maybe he doesn't know what is going on the printer get crazy a start making noises I go I press a button stop",
    "start": "2689540",
    "end": "2697310"
  },
  {
    "text": "making noises I'm ok but maybe you should give access to someone to your to printer or maybe you just someone is",
    "start": "2697310",
    "end": "2703339"
  },
  {
    "text": "connecting a new scenario Smart TV because it's not clear how this is working on how to use it",
    "start": "2703339",
    "end": "2709510"
  },
  {
    "text": "weakest link if I send a printer brute-force attack I know someone is",
    "start": "2709510",
    "end": "2715430"
  },
  {
    "text": "getting tired of the printer making noises so he's gonna pack it out of the network or plug it out of the net of the",
    "start": "2715430",
    "end": "2722170"
  },
  {
    "text": "current or keys he's gonna press the button something is going to happen but the printing is not going to be making",
    "start": "2722170",
    "end": "2729020"
  },
  {
    "text": "noises and flashing LEDs for hours and finally these devices can be a bridge to",
    "start": "2729020",
    "end": "2735349"
  },
  {
    "text": "a secure network so you can have the best IPS the best ideas you can be have",
    "start": "2735349",
    "end": "2741200"
  },
  {
    "text": "a really hard pass phrase you can be really really read about your while and network but",
    "start": "2741200",
    "end": "2747340"
  },
  {
    "text": "then someone put a new printer on the office and you are in trouble okay that",
    "start": "2747340",
    "end": "2754000"
  },
  {
    "text": "was the WTB for me one year expose it attack surface attack surfaces again",
    "start": "2754000",
    "end": "2762280"
  },
  {
    "text": "every time and the specification is applied to a new device so I might like",
    "start": "2762280",
    "end": "2767950"
  },
  {
    "text": "us something new this is a risk every time something some new feature is added",
    "start": "2767950",
    "end": "2773560"
  },
  {
    "text": "to your device it has to be implemented at a filmer level at a waist level and a",
    "start": "2773560",
    "end": "2779260"
  },
  {
    "text": "userland level so you have a lot of layer two attacks to attack and in fact if you see this year there were a lot of",
    "start": "2779260",
    "end": "2785110"
  },
  {
    "text": "Broadcom vulnerabilities find by project zero and and Nitai that presented a black hat USA all these warranties were",
    "start": "2785110",
    "end": "2791980"
  },
  {
    "text": "as protein Broadcom fewer broken femur cross implemented Wi-Fi peer-to-peer so",
    "start": "2791980",
    "end": "2797440"
  },
  {
    "text": "again these are extent attack and give more opportunity to attackers to abuse",
    "start": "2797440",
    "end": "2802750"
  },
  {
    "text": "or implementation and finally I start doing new research on on Wi-Fi direct",
    "start": "2802750",
    "end": "2809410"
  },
  {
    "text": "and I start seeing different components that they are putting inside and Bailey devices or IOT devices that cast Wi-Fi",
    "start": "2809410",
    "end": "2817900"
  },
  {
    "text": "direct support so I think that this is going to get bigger he's not gonna get smaller so thank you thank everyone for",
    "start": "2817900",
    "end": "2828070"
  },
  {
    "text": "listening to my presentation I hope you liked it and here is a big",
    "start": "2828070",
    "end": "2835630"
  },
  {
    "text": "hub repository where I said some tools and I have more information but if",
    "start": "2835630",
    "end": "2841600"
  },
  {
    "text": "someone wants to see a live demo I know that this here in this in this place there are a couple of Wi-Fi direct",
    "start": "2841600",
    "end": "2847630"
  },
  {
    "text": "devices so I can show you a live demo or anything after the presentation of you",
    "start": "2847630",
    "end": "2853060"
  },
  {
    "text": "have any questions I will be happy to answer it",
    "start": "2853060",
    "end": "2857700"
  },
  {
    "text": "[Applause]",
    "start": "2858390",
    "end": "2868579"
  },
  {
    "text": "no question too confusing too quick so",
    "start": "2870280",
    "end": "2875890"
  },
  {
    "text": "what is worst Wi-Fi direct or Bluetooth",
    "start": "2878710",
    "end": "2884420"
  },
  {
    "text": "or Bluetooth Bluetooth was a mock on occasion so I will first turn bluetooth",
    "start": "2884420",
    "end": "2891350"
  },
  {
    "text": "out and then I will turn off Wi-Fi direct on how many devices could you",
    "start": "2891350",
    "end": "2905090"
  },
  {
    "text": "actually or how many devices could you actually use as a bridge from Wi-Fi direct into the internal network without",
    "start": "2905090",
    "end": "2910760"
  },
  {
    "text": "having to exploit anything further you should find you should search for the",
    "start": "2910760",
    "end": "2916580"
  },
  {
    "text": "cross cross connection that is a capability of the peer to peer group I",
    "start": "2916580",
    "end": "2921760"
  },
  {
    "text": "saw that there are some Sony TVs that cause this enable so when you build",
    "start": "2921760",
    "end": "2927980"
  },
  {
    "text": "appear to be a group you could use to connect without abusing or exploiting",
    "start": "2927980",
    "end": "2932990"
  },
  {
    "text": "the TV in itself but I only have a Samsung TV and the devices I have doesn't have cross connection enable so",
    "start": "2932990",
    "end": "2940610"
  },
  {
    "text": "to turn that on I have to route the device or modify the implementation myself like maybe I didn't express",
    "start": "2940610",
    "end": "2950540"
  },
  {
    "text": "myself clearly on how many devices were you able to enter the network where the",
    "start": "2950540",
    "end": "2957520"
  },
  {
    "text": "TV for example is connected by wire over",
    "start": "2957520",
    "end": "2962660"
  },
  {
    "text": "Wi-Fi direct was this possible at all I didn't have any device to try that but",
    "start": "2962660",
    "end": "2968840"
  },
  {
    "text": "again it is not specified on there on the on the specification how to who to",
    "start": "2968840",
    "end": "2975170"
  },
  {
    "text": "do that so it's out of the scope so as you saw on the Samsung Smart TV they",
    "start": "2975170",
    "end": "2980900"
  },
  {
    "text": "don't have a solution for the problem they have and implementing themself something it depends on implementation I",
    "start": "2980900",
    "end": "2987170"
  },
  {
    "text": "haven't found a device that I could test on because I don't own it but it depends",
    "start": "2987170",
    "end": "2993530"
  },
  {
    "text": "on the moment ation I'm not I can at this time zero devices because I was",
    "start": "2993530",
    "end": "2998830"
  },
  {
    "text": "unable to test it",
    "start": "2998830",
    "end": "3001790"
  },
  {
    "text": "oh thank you for your talk are we merely talking about",
    "start": "3008960",
    "end": "3014690"
  },
  {
    "text": "implementation flaws or is there something wrong with the protocol as well no I only saw implementation issues I",
    "start": "3014690",
    "end": "3023270"
  },
  {
    "text": "didn't see any flaw on the on the specification itself I think that they",
    "start": "3023270",
    "end": "3028819"
  },
  {
    "text": "flow in the specification is leaving a lot of things out of scope so the vendor",
    "start": "3028819",
    "end": "3033980"
  },
  {
    "text": "have to make their own solutions and sometimes they are really reusing other",
    "start": "3033980",
    "end": "3040250"
  },
  {
    "text": "things for example the dual EPS generation button that generates pins instead of passphrase",
    "start": "3040250",
    "end": "3045950"
  },
  {
    "text": "I think this because they already have that Phinney functionality and they reuse it so I think that it's more",
    "start": "3045950",
    "end": "3052569"
  },
  {
    "text": "leaving so much things out of the scope that is this the issue with the specification itself thank you",
    "start": "3052569",
    "end": "3060910"
  },
  {
    "text": "Oh so after connecting to the Wi-Fi direct connection to the TV using Wi-Fi",
    "start": "3066930",
    "end": "3074250"
  },
  {
    "text": "direct what could you do like you just could first an easy thing you can do is",
    "start": "3074250",
    "end": "3079650"
  },
  {
    "text": "is put something in the screen because you can mirror the screen so you can use",
    "start": "3079650",
    "end": "3085020"
  },
  {
    "text": "your device and mirror or something on the screen so you can take control of what is it's playing on the screen but that is not a really interesting",
    "start": "3085020",
    "end": "3091500"
  },
  {
    "text": "attack for me so you should they start looking and two other attacks again this",
    "start": "3091500",
    "end": "3098220"
  },
  {
    "text": "is only like a wolf at directing I'm not talking about plugging the whole device and a chain attack but again there was",
    "start": "3098220",
    "end": "3106200"
  },
  {
    "text": "some talk I think this year about a guy talking about some some Smart TVs that he found several exploits on the on the",
    "start": "3106200",
    "end": "3114240"
  },
  {
    "text": "TV once you are able to connect directly on the same network so if you change that with this you are able to attack it",
    "start": "3114240",
    "end": "3121260"
  },
  {
    "text": "remotely you didn't have to be insane the same network once you have connected what for Wi-Fi direct you're going to be",
    "start": "3121260",
    "end": "3126839"
  },
  {
    "text": "able to exploit this this vulnerabilities hey just a quick",
    "start": "3126839",
    "end": "3134279"
  },
  {
    "text": "question from the from the attacks that you exposed the one that it's forcing",
    "start": "3134279",
    "end": "3141720"
  },
  {
    "text": "the user or tricking the user to press the the VPS button and so on and the other one that you said that you",
    "start": "3141720",
    "end": "3149160"
  },
  {
    "text": "were able to clone to the to the map to capture the handshake and see the MAC",
    "start": "3149160",
    "end": "3155579"
  },
  {
    "text": "address and cloning have you been able to reproduce this yourself I do it I do",
    "start": "3155579",
    "end": "3161430"
  },
  {
    "text": "it on my own TV with my own phone yes you can do it but you need a device to",
    "start": "3161430",
    "end": "3167789"
  },
  {
    "text": "connect to the TV so if in that case if nobody is using the Wi-Fi direct functionality you're not going to be",
    "start": "3167789",
    "end": "3174480"
  },
  {
    "text": "able to exploit it because you need a legit it device in the whitelist okay so",
    "start": "3174480",
    "end": "3179819"
  },
  {
    "text": "in the in that case you're not going to be able to plug it is no one is using the service it's like the same as it",
    "start": "3179819",
    "end": "3187109"
  },
  {
    "text": "happens with Wi-Fi Mac filtering I don't know in the 90s with people say okay I",
    "start": "3187109",
    "end": "3192180"
  },
  {
    "text": "only said my MAC address on my network until you see the valid net the device connecting to a network you're not gonna",
    "start": "3192180",
    "end": "3198029"
  },
  {
    "text": "be able to connect to the device but basic hello okay so basically you're",
    "start": "3198029",
    "end": "3207119"
  },
  {
    "text": "just hoping at the best for someone to actually grant you itself actually oh",
    "start": "3207119",
    "end": "3214170"
  },
  {
    "text": "you're on the team you're waiting for someone to connect yes and even for the VPS you're still trying to work waiting",
    "start": "3214170",
    "end": "3221190"
  },
  {
    "text": "for someone to push the button hey I'm allowing you on a tux I just tried to like brute force the VPS or something",
    "start": "3221190",
    "end": "3227460"
  },
  {
    "text": "like that no I haven't but this is something you could try because it",
    "start": "3227460",
    "end": "3233970"
  },
  {
    "text": "depends on implementation again the UPS implementation on on access point has evolved a lot and nowadays is card -",
    "start": "3233970",
    "end": "3241040"
  },
  {
    "text": "bloop - Lu up in brute-force attack it's supposed to be that in the specification",
    "start": "3241040",
    "end": "3246480"
  },
  {
    "text": "it says that you cannot connect to other a Wi-Fi detect device you seen a pin",
    "start": "3246480",
    "end": "3252680"
  },
  {
    "text": "this is really clarified on the under specification one of the things I wanted",
    "start": "3252680",
    "end": "3258329"
  },
  {
    "text": "to test it and I didn't have time is to try to use a pin that is on my printer and try to use that pin to connect using",
    "start": "3258329",
    "end": "3265530"
  },
  {
    "text": "Wi-Fi direct if that is possible you have another issue because some some",
    "start": "3265530",
    "end": "3271349"
  },
  {
    "text": "printers also has an NFC tag on the printer the gossipin in the in the NFC tag so if",
    "start": "3271349",
    "end": "3279839"
  },
  {
    "text": "you are able to the call house that is generated or the WPS implementation is not not not really good and that doesn't",
    "start": "3279839",
    "end": "3288089"
  },
  {
    "text": "prevent brute-force attack you're gonna be able to do up in both floors attack on a printer or a TV or anything but it",
    "start": "3288089",
    "end": "3294300"
  },
  {
    "text": "depends on how they implemented WPS I haven't tested that I hope it's good as",
    "start": "3294300",
    "end": "3301020"
  },
  {
    "text": "the last access point implementations",
    "start": "3301020",
    "end": "3305420"
  },
  {
    "text": "here",
    "start": "3306500",
    "end": "3309500"
  },
  {
    "text": "mean did you try and so fasiq fussing yeah I",
    "start": "3317480",
    "end": "3324400"
  },
  {
    "text": "play a little bit not too much I the last thing I was starting to do is",
    "start": "3324400",
    "end": "3329800"
  },
  {
    "text": "passing the the service discovery because I was interested on seeing what",
    "start": "3329800",
    "end": "3336550"
  },
  {
    "text": "goes on when I start standing like we're frames and if it's ended it to an",
    "start": "3336550",
    "end": "3342100"
  },
  {
    "text": "internal service of the printer some process running inside the printer but I didn't have too much time to do",
    "start": "3342100",
    "end": "3349750"
  },
  {
    "text": "that but this is something I really want to do start passing the implementations",
    "start": "3349750",
    "end": "3356010"
  },
  {
    "text": "that's all thank you very much [Applause]",
    "start": "3361590",
    "end": "3368089"
  }
]