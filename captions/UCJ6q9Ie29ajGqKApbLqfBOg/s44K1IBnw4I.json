[
  {
    "text": "[Music]",
    "start": "1130",
    "end": "14699"
  },
  {
    "text": "hi everyone",
    "start": "22560",
    "end": "24160"
  },
  {
    "text": "thanks so much for coming",
    "start": "24160",
    "end": "25920"
  },
  {
    "text": "today i'm going to talk about remote",
    "start": "25920",
    "end": "27599"
  },
  {
    "text": "eavesdropping vulnerabilities in mobile",
    "start": "27599",
    "end": "29760"
  },
  {
    "text": "messaging applications",
    "start": "29760",
    "end": "32558"
  },
  {
    "text": "i'm natalie slovanovic and i'm a member",
    "start": "32559",
    "end": "35360"
  },
  {
    "text": "of project xero at google",
    "start": "35360",
    "end": "37600"
  },
  {
    "text": "and i've become a bit of a messaging",
    "start": "37600",
    "end": "40079"
  },
  {
    "text": "enthusiast so today i'm going to share",
    "start": "40079",
    "end": "42640"
  },
  {
    "text": "my latest research on mobile messaging",
    "start": "42640",
    "end": "45520"
  },
  {
    "text": "applications",
    "start": "45520",
    "end": "48000"
  },
  {
    "text": "you might remember that about two years",
    "start": "48000",
    "end": "50480"
  },
  {
    "text": "ago there was the group facetime",
    "start": "50480",
    "end": "53360"
  },
  {
    "text": "vulnerability",
    "start": "53360",
    "end": "55199"
  },
  {
    "text": "and this was a really unusual",
    "start": "55199",
    "end": "57199"
  },
  {
    "text": "vulnerability",
    "start": "57199",
    "end": "59039"
  },
  {
    "text": "that um the way it worked was that you",
    "start": "59039",
    "end": "62480"
  },
  {
    "text": "could start a group facetime call",
    "start": "62480",
    "end": "64960"
  },
  {
    "text": "and then if you added someone to the",
    "start": "64960",
    "end": "68080"
  },
  {
    "text": "call again it would automatically",
    "start": "68080",
    "end": "70240"
  },
  {
    "text": "connect the call so the end effect of",
    "start": "70240",
    "end": "73040"
  },
  {
    "text": "this was that",
    "start": "73040",
    "end": "74640"
  },
  {
    "text": "you could force a call with someone else",
    "start": "74640",
    "end": "76880"
  },
  {
    "text": "without them ever touching their phone",
    "start": "76880",
    "end": "79840"
  },
  {
    "text": "so you could listen to their",
    "start": "79840",
    "end": "81280"
  },
  {
    "text": "surroundings without their consent",
    "start": "81280",
    "end": "84560"
  },
  {
    "text": "and this vulnerability was unusual in a",
    "start": "84560",
    "end": "87759"
  },
  {
    "text": "few ways",
    "start": "87759",
    "end": "89360"
  },
  {
    "text": "one was that it was available through",
    "start": "89360",
    "end": "91200"
  },
  {
    "text": "the user interface",
    "start": "91200",
    "end": "92960"
  },
  {
    "text": "so it was actually reported by a number",
    "start": "92960",
    "end": "96159"
  },
  {
    "text": "of people including some middle",
    "start": "96159",
    "end": "98840"
  },
  {
    "text": "schoolers and um you didn't need any",
    "start": "98840",
    "end": "101920"
  },
  {
    "text": "special equipment or to modify your",
    "start": "101920",
    "end": "104399"
  },
  {
    "text": "phone to use it which actually made it",
    "start": "104399",
    "end": "106479"
  },
  {
    "text": "quite a severe vulnerability it even led",
    "start": "106479",
    "end": "109200"
  },
  {
    "text": "to a downtime of great group facetime",
    "start": "109200",
    "end": "111680"
  },
  {
    "text": "because they immediately took down the",
    "start": "111680",
    "end": "113040"
  },
  {
    "text": "feature while they fixed the bug but",
    "start": "113040",
    "end": "115520"
  },
  {
    "text": "what was also unusual about this bug was",
    "start": "115520",
    "end": "117840"
  },
  {
    "text": "its impact",
    "start": "117840",
    "end": "119920"
  },
  {
    "text": "well there have been exploits in the",
    "start": "119920",
    "end": "121600"
  },
  {
    "text": "past which use memory corruption to",
    "start": "121600",
    "end": "124479"
  },
  {
    "text": "escalate privileges and then eventually",
    "start": "124479",
    "end": "126960"
  },
  {
    "text": "turn on the microphone",
    "start": "126960",
    "end": "128640"
  },
  {
    "text": "so that an attacker can listen to a",
    "start": "128640",
    "end": "130479"
  },
  {
    "text": "remote party",
    "start": "130479",
    "end": "131840"
  },
  {
    "text": "i'd never seen a vulnerability where",
    "start": "131840",
    "end": "134239"
  },
  {
    "text": "there's a logic bug that allows this",
    "start": "134239",
    "end": "136720"
  },
  {
    "text": "directly",
    "start": "136720",
    "end": "138560"
  },
  {
    "text": "and this is what i'm focusing on in this",
    "start": "138560",
    "end": "140319"
  },
  {
    "text": "talk",
    "start": "140319",
    "end": "141280"
  },
  {
    "text": "i wanted to think more about",
    "start": "141280",
    "end": "144400"
  },
  {
    "text": "this um",
    "start": "144400",
    "end": "145599"
  },
  {
    "text": "in my opinion unprecedented",
    "start": "145599",
    "end": "146879"
  },
  {
    "text": "vulnerability type",
    "start": "146879",
    "end": "148640"
  },
  {
    "text": "where there are logic bugs in a calling",
    "start": "148640",
    "end": "150640"
  },
  {
    "text": "state machine that allows um access to",
    "start": "150640",
    "end": "153840"
  },
  {
    "text": "remote audio video on a device",
    "start": "153840",
    "end": "157120"
  },
  {
    "text": "and figure out how they happen",
    "start": "157120",
    "end": "159840"
  },
  {
    "text": "and whether they exist in other",
    "start": "159840",
    "end": "162879"
  },
  {
    "text": "applications",
    "start": "162879",
    "end": "164800"
  },
  {
    "text": "so i started off by trying to figure out",
    "start": "164800",
    "end": "167040"
  },
  {
    "text": "how this bug class works and then i",
    "start": "167040",
    "end": "169599"
  },
  {
    "text": "investigated other apps for similar bugs",
    "start": "169599",
    "end": "173680"
  },
  {
    "text": "so",
    "start": "173680",
    "end": "174640"
  },
  {
    "text": "how does audio and video conferencing",
    "start": "174640",
    "end": "176720"
  },
  {
    "text": "work in general",
    "start": "176720",
    "end": "178879"
  },
  {
    "text": "well most applications use something",
    "start": "178879",
    "end": "181280"
  },
  {
    "text": "called webrtc",
    "start": "181280",
    "end": "183360"
  },
  {
    "text": "webrtc",
    "start": "183360",
    "end": "184879"
  },
  {
    "text": "is both a protocol with specification",
    "start": "184879",
    "end": "188319"
  },
  {
    "text": "and a specific audio and video",
    "start": "188319",
    "end": "190560"
  },
  {
    "text": "conferencing library maintained by",
    "start": "190560",
    "end": "192480"
  },
  {
    "text": "google so it's an overloaded term",
    "start": "192480",
    "end": "195519"
  },
  {
    "text": "but in terms of google's webrtc library",
    "start": "195519",
    "end": "198640"
  },
  {
    "text": "it's used by all major browsers",
    "start": "198640",
    "end": "201760"
  },
  {
    "text": "and most mobile applications",
    "start": "201760",
    "end": "204879"
  },
  {
    "text": "the only two video conferencing",
    "start": "204879",
    "end": "206560"
  },
  {
    "text": "implementations that i'm aware of that",
    "start": "206560",
    "end": "209040"
  },
  {
    "text": "don't use webrtc",
    "start": "209040",
    "end": "210959"
  },
  {
    "text": "are whatsapp and facetime but regardless",
    "start": "210959",
    "end": "214640"
  },
  {
    "text": "the alternatives they use have the same",
    "start": "214640",
    "end": "216959"
  },
  {
    "text": "design their protocols are very similar",
    "start": "216959",
    "end": "219519"
  },
  {
    "text": "to webrtc even though they don't use",
    "start": "219519",
    "end": "222400"
  },
  {
    "text": "google's libwebrtc",
    "start": "222400",
    "end": "225360"
  },
  {
    "text": "so how does this work",
    "start": "225360",
    "end": "227040"
  },
  {
    "text": "well on a high level webrtc works by",
    "start": "227040",
    "end": "230000"
  },
  {
    "text": "starting off a call with signaling and",
    "start": "230000",
    "end": "232560"
  },
  {
    "text": "signaling is where information is",
    "start": "232560",
    "end": "235519"
  },
  {
    "text": "exchanged between the two peers and the",
    "start": "235519",
    "end": "238239"
  },
  {
    "text": "sort of information that will be",
    "start": "238239",
    "end": "240239"
  },
  {
    "text": "exchanged is things like cryptographic",
    "start": "240239",
    "end": "242879"
  },
  {
    "text": "keys and what codecs they support",
    "start": "242879",
    "end": "245680"
  },
  {
    "text": "and then once they've agreed on these",
    "start": "245680",
    "end": "249519"
  },
  {
    "text": "then there'll be a peer-to-peer",
    "start": "249519",
    "end": "250799"
  },
  {
    "text": "connection and this is the second stage",
    "start": "250799",
    "end": "253280"
  },
  {
    "text": "of the connection",
    "start": "253280",
    "end": "255360"
  },
  {
    "text": "and my thinking was that when you think",
    "start": "255360",
    "end": "257919"
  },
  {
    "text": "of these vulnerabilities that allow",
    "start": "257919",
    "end": "260400"
  },
  {
    "text": "remote eavesdropping",
    "start": "260400",
    "end": "262240"
  },
  {
    "text": "they should be errors in the signaling",
    "start": "262240",
    "end": "264160"
  },
  {
    "text": "stage what's actually going wrong here",
    "start": "264160",
    "end": "267680"
  },
  {
    "text": "is that this peer-to-peer media",
    "start": "267680",
    "end": "270000"
  },
  {
    "text": "connection is being set up",
    "start": "270000",
    "end": "272639"
  },
  {
    "text": "basically before the user is ready",
    "start": "272639",
    "end": "275199"
  },
  {
    "text": "and that's an error in signaling",
    "start": "275199",
    "end": "278639"
  },
  {
    "text": "so",
    "start": "278639",
    "end": "279600"
  },
  {
    "text": "how signaling works in more detail",
    "start": "279600",
    "end": "282400"
  },
  {
    "text": "is that for a two-person call typically",
    "start": "282400",
    "end": "285600"
  },
  {
    "text": "there's a caller and there's a callee",
    "start": "285600",
    "end": "288479"
  },
  {
    "text": "and the caller's device will send an sdp",
    "start": "288479",
    "end": "291360"
  },
  {
    "text": "offer and the callee will return an",
    "start": "291360",
    "end": "293919"
  },
  {
    "text": "answer",
    "start": "293919",
    "end": "294880"
  },
  {
    "text": "sdp is a session description protocol",
    "start": "294880",
    "end": "298320"
  },
  {
    "text": "and it's basically just a text format",
    "start": "298320",
    "end": "300160"
  },
  {
    "text": "that can contain all sorts of",
    "start": "300160",
    "end": "302320"
  },
  {
    "text": "information like crypto keys and codec",
    "start": "302320",
    "end": "305039"
  },
  {
    "text": "types",
    "start": "305039",
    "end": "306160"
  },
  {
    "text": "so this information gets exchanged",
    "start": "306160",
    "end": "309039"
  },
  {
    "text": "and then the devices will exchange what",
    "start": "309039",
    "end": "311280"
  },
  {
    "text": "are called candidates",
    "start": "311280",
    "end": "312960"
  },
  {
    "text": "and these are possible ways for the",
    "start": "312960",
    "end": "315360"
  },
  {
    "text": "devices to connect",
    "start": "315360",
    "end": "316800"
  },
  {
    "text": "so it might be the device's udp address",
    "start": "316800",
    "end": "319280"
  },
  {
    "text": "their tcp address some various nat stun",
    "start": "319280",
    "end": "322639"
  },
  {
    "text": "turn addresses",
    "start": "322639",
    "end": "324639"
  },
  {
    "text": "and these are done after they offer an",
    "start": "324639",
    "end": "327199"
  },
  {
    "text": "answer and there can actually be more",
    "start": "327199",
    "end": "329280"
  },
  {
    "text": "than one exchanged because these often",
    "start": "329280",
    "end": "331840"
  },
  {
    "text": "take time for the device to determine",
    "start": "331840",
    "end": "334320"
  },
  {
    "text": "but something important to keep in mind",
    "start": "334320",
    "end": "335840"
  },
  {
    "text": "is offers and answers can also have",
    "start": "335840",
    "end": "337440"
  },
  {
    "text": "candidates in them so if there's",
    "start": "337440",
    "end": "339440"
  },
  {
    "text": "something that the device knows right",
    "start": "339440",
    "end": "340800"
  },
  {
    "text": "away like it's udp",
    "start": "340800",
    "end": "343280"
  },
  {
    "text": "ip address that can be in the offer or",
    "start": "343280",
    "end": "346080"
  },
  {
    "text": "the answer",
    "start": "346080",
    "end": "347680"
  },
  {
    "text": "but once separation has been exchanged",
    "start": "347680",
    "end": "350240"
  },
  {
    "text": "then there can be a p2p media connection",
    "start": "350240",
    "end": "354000"
  },
  {
    "text": "and this is where audio and video can be",
    "start": "354000",
    "end": "356000"
  },
  {
    "text": "sent",
    "start": "356000",
    "end": "357600"
  },
  {
    "text": "but there's one more feature that",
    "start": "357600",
    "end": "359120"
  },
  {
    "text": "actually makes this work",
    "start": "359120",
    "end": "360960"
  },
  {
    "text": "and this is called tracks",
    "start": "360960",
    "end": "362960"
  },
  {
    "text": "tracks is the programming construct in",
    "start": "362960",
    "end": "365600"
  },
  {
    "text": "webrtc",
    "start": "365600",
    "end": "366960"
  },
  {
    "text": "that represents a camera or a microphone",
    "start": "366960",
    "end": "370880"
  },
  {
    "text": "and this needs to be added to the peer",
    "start": "370880",
    "end": "372720"
  },
  {
    "text": "connection before any input is streamed",
    "start": "372720",
    "end": "375680"
  },
  {
    "text": "from these devices",
    "start": "375680",
    "end": "377280"
  },
  {
    "text": "and this can be done at any time during",
    "start": "377280",
    "end": "379039"
  },
  {
    "text": "a call even if the p2p connection hasn't",
    "start": "379039",
    "end": "382000"
  },
  {
    "text": "been established so this could be done",
    "start": "382000",
    "end": "383840"
  },
  {
    "text": "at the beginning and then as soon as the",
    "start": "383840",
    "end": "385440"
  },
  {
    "text": "connection is established the media will",
    "start": "385440",
    "end": "387520"
  },
  {
    "text": "be sent or the pdp connection can be set",
    "start": "387520",
    "end": "390720"
  },
  {
    "text": "up and then the track can be enabled or",
    "start": "390720",
    "end": "392720"
  },
  {
    "text": "disabled later this can even be done in",
    "start": "392720",
    "end": "395039"
  },
  {
    "text": "the middle of the call and this is often",
    "start": "395039",
    "end": "397759"
  },
  {
    "text": "how mute functionality is implemented",
    "start": "397759",
    "end": "400800"
  },
  {
    "text": "by either",
    "start": "400800",
    "end": "402720"
  },
  {
    "text": "disabling a track or by removing it",
    "start": "402720",
    "end": "405330"
  },
  {
    "text": "[Music]",
    "start": "405330",
    "end": "407199"
  },
  {
    "text": "so then what causes these",
    "start": "407199",
    "end": "408319"
  },
  {
    "text": "vulnerabilities i posited that this was",
    "start": "408319",
    "end": "411919"
  },
  {
    "text": "due to the state machines that are used",
    "start": "411919",
    "end": "415039"
  },
  {
    "text": "to",
    "start": "415039",
    "end": "415759"
  },
  {
    "text": "handle offers answers candidates and",
    "start": "415759",
    "end": "418000"
  },
  {
    "text": "tracks i thought these bugs were",
    "start": "418000",
    "end": "420240"
  },
  {
    "text": "probably caused by that type of",
    "start": "420240",
    "end": "421759"
  },
  {
    "text": "vulnerability",
    "start": "421759",
    "end": "423120"
  },
  {
    "text": "and i didn't actually look into the face",
    "start": "423120",
    "end": "425599"
  },
  {
    "text": "time bug or well i did but i never quite",
    "start": "425599",
    "end": "427840"
  },
  {
    "text": "figured out what caused it",
    "start": "427840",
    "end": "430720"
  },
  {
    "text": "but based on my understanding of how",
    "start": "430720",
    "end": "432400"
  },
  {
    "text": "video conferencing works i think this is",
    "start": "432400",
    "end": "434319"
  },
  {
    "text": "how the majority of bugs like this would",
    "start": "434319",
    "end": "436160"
  },
  {
    "text": "work",
    "start": "436160",
    "end": "438240"
  },
  {
    "text": "and i think",
    "start": "438240",
    "end": "439360"
  },
  {
    "text": "as far as root cause goes there's a few",
    "start": "439360",
    "end": "441360"
  },
  {
    "text": "ways this could happen",
    "start": "441360",
    "end": "442960"
  },
  {
    "text": "one possibility",
    "start": "442960",
    "end": "444560"
  },
  {
    "text": "is that the developers make a mistake in",
    "start": "444560",
    "end": "446720"
  },
  {
    "text": "their state machine",
    "start": "446720",
    "end": "448240"
  },
  {
    "text": "they either don't realize there's this",
    "start": "448240",
    "end": "450400"
  },
  {
    "text": "edge case where they call it could",
    "start": "450400",
    "end": "451680"
  },
  {
    "text": "connect or they have a good state",
    "start": "451680",
    "end": "454240"
  },
  {
    "text": "machine but they make a mistake in the",
    "start": "454240",
    "end": "456000"
  },
  {
    "text": "code and it doesn't work correctly",
    "start": "456000",
    "end": "458639"
  },
  {
    "text": "but i also think it's possible that",
    "start": "458639",
    "end": "460639"
  },
  {
    "text": "developers misunderstand the webrtc",
    "start": "460639",
    "end": "462479"
  },
  {
    "text": "contra constructs",
    "start": "462479",
    "end": "464400"
  },
  {
    "text": "their theoretical understanding of",
    "start": "464400",
    "end": "465759"
  },
  {
    "text": "webrtct",
    "start": "465759",
    "end": "467120"
  },
  {
    "text": "is not how it really works so they end",
    "start": "467120",
    "end": "469599"
  },
  {
    "text": "up introducing bugs that way",
    "start": "469599",
    "end": "472080"
  },
  {
    "text": "and finally i think it's possible that",
    "start": "472080",
    "end": "473759"
  },
  {
    "text": "webrtc itself will have bugs that can",
    "start": "473759",
    "end": "476720"
  },
  {
    "text": "cause this type of eavesdropping problem",
    "start": "476720",
    "end": "479199"
  },
  {
    "text": "i haven't actually seen this",
    "start": "479199",
    "end": "481520"
  },
  {
    "text": "any bug that is caused by a bug in",
    "start": "481520",
    "end": "483840"
  },
  {
    "text": "webrtc but i do think it's at least",
    "start": "483840",
    "end": "486000"
  },
  {
    "text": "theoretically possible",
    "start": "486000",
    "end": "487599"
  },
  {
    "text": "that there are bugs in webrtc that could",
    "start": "487599",
    "end": "490319"
  },
  {
    "text": "cause signaling not to work as expected",
    "start": "490319",
    "end": "492630"
  },
  {
    "text": "[Music]",
    "start": "492630",
    "end": "494000"
  },
  {
    "text": "so then i decided i was going to go",
    "start": "494000",
    "end": "495919"
  },
  {
    "text": "about and try and find some",
    "start": "495919",
    "end": "498240"
  },
  {
    "text": "vulnerabilities in state machines i",
    "start": "498240",
    "end": "500319"
  },
  {
    "text": "started off by trying to understand the",
    "start": "500319",
    "end": "503039"
  },
  {
    "text": "state machine",
    "start": "503039",
    "end": "504560"
  },
  {
    "text": "and then i thought about possible",
    "start": "504560",
    "end": "507520"
  },
  {
    "text": "problems the state machines could have",
    "start": "507520",
    "end": "509599"
  },
  {
    "text": "and then finally i tested the problems",
    "start": "509599",
    "end": "512719"
  },
  {
    "text": "to see whether i could actually",
    "start": "512719",
    "end": "514320"
  },
  {
    "text": "reproduce the vulnerabilities i thought",
    "start": "514320",
    "end": "516000"
  },
  {
    "text": "these state machines had",
    "start": "516000",
    "end": "518800"
  },
  {
    "text": "so to start off i tried to understand",
    "start": "518800",
    "end": "520800"
  },
  {
    "text": "the state machines",
    "start": "520800",
    "end": "522640"
  },
  {
    "text": "and um",
    "start": "522640",
    "end": "524240"
  },
  {
    "text": "in some situations it was really easy",
    "start": "524240",
    "end": "526880"
  },
  {
    "text": "some projects such as signal and",
    "start": "526880",
    "end": "528560"
  },
  {
    "text": "telegram",
    "start": "528560",
    "end": "529839"
  },
  {
    "text": "especially signal document their state",
    "start": "529839",
    "end": "531760"
  },
  {
    "text": "machines very well",
    "start": "531760",
    "end": "533440"
  },
  {
    "text": "and my opinion is that all projects",
    "start": "533440",
    "end": "535279"
  },
  {
    "text": "should do this",
    "start": "535279",
    "end": "536880"
  },
  {
    "text": "even if it's a closed source project i",
    "start": "536880",
    "end": "538720"
  },
  {
    "text": "think this is a good idea for developers",
    "start": "538720",
    "end": "540800"
  },
  {
    "text": "to do",
    "start": "540800",
    "end": "542080"
  },
  {
    "text": "it make sure that the developers",
    "start": "542080",
    "end": "544240"
  },
  {
    "text": "understand the state machines and how",
    "start": "544240",
    "end": "546240"
  },
  {
    "text": "they work and i think it's very possible",
    "start": "546240",
    "end": "549200"
  },
  {
    "text": "that you can find vulnerabilities just",
    "start": "549200",
    "end": "551519"
  },
  {
    "text": "by learning more about the state machine",
    "start": "551519",
    "end": "554560"
  },
  {
    "text": "but of course this wasn't possible",
    "start": "554560",
    "end": "556240"
  },
  {
    "text": "especially for closed source projects so",
    "start": "556240",
    "end": "558720"
  },
  {
    "text": "what i did is i used frida to hook",
    "start": "558720",
    "end": "561920"
  },
  {
    "text": "signaling on an android device",
    "start": "561920",
    "end": "564160"
  },
  {
    "text": "i would hook the code that",
    "start": "564160",
    "end": "566720"
  },
  {
    "text": "handled offers answers candidates and",
    "start": "566720",
    "end": "569600"
  },
  {
    "text": "tracks so this is incoming and then i'd",
    "start": "569600",
    "end": "571839"
  },
  {
    "text": "manipulate the user interface i would",
    "start": "571839",
    "end": "575279"
  },
  {
    "text": "make a call",
    "start": "575279",
    "end": "576640"
  },
  {
    "text": "and then answer it on the other side and",
    "start": "576640",
    "end": "579200"
  },
  {
    "text": "then i'd make an incoming call and",
    "start": "579200",
    "end": "580959"
  },
  {
    "text": "answer it",
    "start": "580959",
    "end": "582080"
  },
  {
    "text": "and just see what order of things",
    "start": "582080",
    "end": "583839"
  },
  {
    "text": "happened in",
    "start": "583839",
    "end": "585040"
  },
  {
    "text": "this did allow me to right away",
    "start": "585040",
    "end": "588080"
  },
  {
    "text": "exclude some apps there were some apps",
    "start": "588080",
    "end": "590560"
  },
  {
    "text": "where when you made a call",
    "start": "590560",
    "end": "592399"
  },
  {
    "text": "absolutely nothing happened until the",
    "start": "592399",
    "end": "594480"
  },
  {
    "text": "user on the other side picked up the",
    "start": "594480",
    "end": "596080"
  },
  {
    "text": "call",
    "start": "596080",
    "end": "596880"
  },
  {
    "text": "and in that case um",
    "start": "596880",
    "end": "599279"
  },
  {
    "text": "it's very unlikely that that app has",
    "start": "599279",
    "end": "601440"
  },
  {
    "text": "this type",
    "start": "601440",
    "end": "602640"
  },
  {
    "text": "of vulnerability because this type of",
    "start": "602640",
    "end": "605040"
  },
  {
    "text": "vulnerability happens before the user is",
    "start": "605040",
    "end": "607120"
  },
  {
    "text": "interacted with the device and if the",
    "start": "607120",
    "end": "608560"
  },
  {
    "text": "user has to interact with the device in",
    "start": "608560",
    "end": "610560"
  },
  {
    "text": "order to have any attack surface at all",
    "start": "610560",
    "end": "613680"
  },
  {
    "text": "the sort of bug probably doesn't exist",
    "start": "613680",
    "end": "616720"
  },
  {
    "text": "but most applications did do some things",
    "start": "616720",
    "end": "619200"
  },
  {
    "text": "before the user picked up the call",
    "start": "619200",
    "end": "621920"
  },
  {
    "text": "so then i would look further into it",
    "start": "621920",
    "end": "624160"
  },
  {
    "text": "and",
    "start": "624160",
    "end": "624880"
  },
  {
    "text": "after that i uh would sometimes",
    "start": "624880",
    "end": "627440"
  },
  {
    "text": "decompile the app with apk tool and see",
    "start": "627440",
    "end": "630160"
  },
  {
    "text": "what webrtc natives were called",
    "start": "630160",
    "end": "632880"
  },
  {
    "text": "sometimes people will use tools to",
    "start": "632880",
    "end": "634720"
  },
  {
    "text": "recompile the smallie in java i didn't",
    "start": "634720",
    "end": "637920"
  },
  {
    "text": "do this i just looked at the smallie",
    "start": "637920",
    "end": "639279"
  },
  {
    "text": "directly and figured out basically when",
    "start": "639279",
    "end": "642800"
  },
  {
    "text": "all the functions that",
    "start": "642800",
    "end": "645279"
  },
  {
    "text": "handled offers or answers candidates or",
    "start": "645279",
    "end": "647839"
  },
  {
    "text": "tracks was called",
    "start": "647839",
    "end": "649360"
  },
  {
    "text": "and",
    "start": "649360",
    "end": "650240"
  },
  {
    "text": "wrote down what i thought the state",
    "start": "650240",
    "end": "651279"
  },
  {
    "text": "machine was and then thought about it",
    "start": "651279",
    "end": "655040"
  },
  {
    "text": "so",
    "start": "655040",
    "end": "655839"
  },
  {
    "text": "what sort of problems could happen with",
    "start": "655839",
    "end": "657839"
  },
  {
    "text": "a state machine",
    "start": "657839",
    "end": "659360"
  },
  {
    "text": "well you typically have a message flow",
    "start": "659360",
    "end": "661440"
  },
  {
    "text": "from one peer to the other",
    "start": "661440",
    "end": "663440"
  },
  {
    "text": "that's supposed to happen in an expected",
    "start": "663440",
    "end": "664880"
  },
  {
    "text": "order",
    "start": "664880",
    "end": "665839"
  },
  {
    "text": "so some things you can do is you can",
    "start": "665839",
    "end": "668160"
  },
  {
    "text": "send extra messages",
    "start": "668160",
    "end": "670160"
  },
  {
    "text": "you can draw messages you can not send",
    "start": "670160",
    "end": "673760"
  },
  {
    "text": "specific messages that are expected",
    "start": "673760",
    "end": "676800"
  },
  {
    "text": "you can send messages in the wrong order",
    "start": "676800",
    "end": "679040"
  },
  {
    "text": "and i think this was the most",
    "start": "679040",
    "end": "680160"
  },
  {
    "text": "interesting one sending messages in the",
    "start": "680160",
    "end": "682880"
  },
  {
    "text": "wrong direction",
    "start": "682880",
    "end": "684480"
  },
  {
    "text": "so basically sometimes there are message",
    "start": "684480",
    "end": "686560"
  },
  {
    "text": "types that are intended to go from",
    "start": "686560",
    "end": "689680"
  },
  {
    "text": "caller to cali",
    "start": "689680",
    "end": "691120"
  },
  {
    "text": "you know what if you sent them from",
    "start": "691120",
    "end": "692640"
  },
  {
    "text": "colleen to caller instead",
    "start": "692640",
    "end": "695040"
  },
  {
    "text": "and finally sometimes there were what",
    "start": "695040",
    "end": "697920"
  },
  {
    "text": "i'll call secret message types sometimes",
    "start": "697920",
    "end": "700560"
  },
  {
    "text": "there were types of messages that were",
    "start": "700560",
    "end": "702480"
  },
  {
    "text": "sent from one peer to the other",
    "start": "702480",
    "end": "705760"
  },
  {
    "text": "and um",
    "start": "705760",
    "end": "707920"
  },
  {
    "text": "they were not documented they were just",
    "start": "707920",
    "end": "709680"
  },
  {
    "text": "like special types that didn't show up",
    "start": "709680",
    "end": "712160"
  },
  {
    "text": "in the course of a normal call",
    "start": "712160",
    "end": "714480"
  },
  {
    "text": "but um could happen",
    "start": "714480",
    "end": "716880"
  },
  {
    "text": "and just be clear um what i mean by uh",
    "start": "716880",
    "end": "719440"
  },
  {
    "text": "messages here",
    "start": "719440",
    "end": "720959"
  },
  {
    "text": "most state machines are set up with some",
    "start": "720959",
    "end": "724000"
  },
  {
    "text": "type of peer-to-peer signaling message",
    "start": "724000",
    "end": "726800"
  },
  {
    "text": "usually this is actually the message",
    "start": "726800",
    "end": "728639"
  },
  {
    "text": "type used by the application",
    "start": "728639",
    "end": "730639"
  },
  {
    "text": "so for example in facebook it's a",
    "start": "730639",
    "end": "732800"
  },
  {
    "text": "facebook message",
    "start": "732800",
    "end": "734399"
  },
  {
    "text": "and in signal it's a signal message and",
    "start": "734399",
    "end": "736959"
  },
  {
    "text": "usually these apps will set up calls by",
    "start": "736959",
    "end": "739120"
  },
  {
    "text": "sending a series of messages to each",
    "start": "739120",
    "end": "741040"
  },
  {
    "text": "other that include the offer and the",
    "start": "741040",
    "end": "742639"
  },
  {
    "text": "answer and the candidates to set up the",
    "start": "742639",
    "end": "744880"
  },
  {
    "text": "call",
    "start": "744880",
    "end": "745300"
  },
  {
    "text": "[Music]",
    "start": "745300",
    "end": "746800"
  },
  {
    "text": "so now i'm going to go through a few",
    "start": "746800",
    "end": "748800"
  },
  {
    "text": "vulnerabilities i found and explain what",
    "start": "748800",
    "end": "751360"
  },
  {
    "text": "actually caused them in the state",
    "start": "751360",
    "end": "753040"
  },
  {
    "text": "machine",
    "start": "753040",
    "end": "754240"
  },
  {
    "text": "to start off i found two similar",
    "start": "754240",
    "end": "757680"
  },
  {
    "text": "vulnerabilities",
    "start": "757680",
    "end": "759519"
  },
  {
    "text": "in signal messenger",
    "start": "759519",
    "end": "761760"
  },
  {
    "text": "and facebook messenger and these were",
    "start": "761760",
    "end": "764399"
  },
  {
    "text": "both due to state mismanagement",
    "start": "764399",
    "end": "767839"
  },
  {
    "text": "the signal vulnerability i reported and",
    "start": "767839",
    "end": "770240"
  },
  {
    "text": "it was fixed in 2019 and the root cause",
    "start": "770240",
    "end": "773120"
  },
  {
    "text": "was",
    "start": "773120",
    "end": "773920"
  },
  {
    "text": "was confusion between the caller and the",
    "start": "773920",
    "end": "775440"
  },
  {
    "text": "cauli state so there was a message that",
    "start": "775440",
    "end": "777279"
  },
  {
    "text": "was supposed to go from caller to collee",
    "start": "777279",
    "end": "778959"
  },
  {
    "text": "but instead i sent it from kali to",
    "start": "778959",
    "end": "780880"
  },
  {
    "text": "caller",
    "start": "780880",
    "end": "782000"
  },
  {
    "text": "i found a similar bug in facebook",
    "start": "782000",
    "end": "784399"
  },
  {
    "text": "messenger which was reported and fixed",
    "start": "784399",
    "end": "786480"
  },
  {
    "text": "in 2020",
    "start": "786480",
    "end": "788000"
  },
  {
    "text": "and it was a similar root cause",
    "start": "788000",
    "end": "790240"
  },
  {
    "text": "involving state mismanagement but in",
    "start": "790240",
    "end": "792720"
  },
  {
    "text": "this case it was that i could send a",
    "start": "792720",
    "end": "794880"
  },
  {
    "text": "message that was only supposed to be",
    "start": "794880",
    "end": "797200"
  },
  {
    "text": "sent when the call was established",
    "start": "797200",
    "end": "799200"
  },
  {
    "text": "before the call was established",
    "start": "799200",
    "end": "801440"
  },
  {
    "text": "and both of these vulnerabilities",
    "start": "801440",
    "end": "803279"
  },
  {
    "text": "allowed audio to be transmitted without",
    "start": "803279",
    "end": "805360"
  },
  {
    "text": "user consent so i could make a call to",
    "start": "805360",
    "end": "807600"
  },
  {
    "text": "another device and listen to their",
    "start": "807600",
    "end": "809360"
  },
  {
    "text": "surroundings",
    "start": "809360",
    "end": "810959"
  },
  {
    "text": "and here's how this signal vulnerability",
    "start": "810959",
    "end": "812959"
  },
  {
    "text": "worked the call setup is pretty typical",
    "start": "812959",
    "end": "816000"
  },
  {
    "text": "so",
    "start": "816000",
    "end": "816800"
  },
  {
    "text": "the caller sends the sdp offer you get",
    "start": "816800",
    "end": "819199"
  },
  {
    "text": "the answer back you exchange candidates",
    "start": "819199",
    "end": "821680"
  },
  {
    "text": "and then p2p media is set up and this is",
    "start": "821680",
    "end": "824480"
  },
  {
    "text": "fairly typical",
    "start": "824480",
    "end": "825920"
  },
  {
    "text": "this is how a lot of webrtc calls get",
    "start": "825920",
    "end": "828639"
  },
  {
    "text": "set up",
    "start": "828639",
    "end": "829600"
  },
  {
    "text": "and then the phone would be ringing on",
    "start": "829600",
    "end": "832240"
  },
  {
    "text": "the cali side and then the callee",
    "start": "832240",
    "end": "834079"
  },
  {
    "text": "presses the button to answer the call on",
    "start": "834079",
    "end": "836160"
  },
  {
    "text": "the kali side that just adds the track",
    "start": "836160",
    "end": "838000"
  },
  {
    "text": "directly but on the caller side it would",
    "start": "838000",
    "end": "840399"
  },
  {
    "text": "send this one last message to say yes i",
    "start": "840399",
    "end": "843360"
  },
  {
    "text": "am connected and then um",
    "start": "843360",
    "end": "846880"
  },
  {
    "text": "the track would be added on the caller",
    "start": "846880",
    "end": "848399"
  },
  {
    "text": "side and the call would be officially",
    "start": "848399",
    "end": "850560"
  },
  {
    "text": "started",
    "start": "850560",
    "end": "852000"
  },
  {
    "text": "but what if you do this",
    "start": "852000",
    "end": "854480"
  },
  {
    "text": "what if you send this message from",
    "start": "854480",
    "end": "855920"
  },
  {
    "text": "caller to cali what this would do is it",
    "start": "855920",
    "end": "858160"
  },
  {
    "text": "would add the track before the colleague",
    "start": "858160",
    "end": "860000"
  },
  {
    "text": "had picked up the call so this would",
    "start": "860000",
    "end": "861600"
  },
  {
    "text": "just immediately establish a call",
    "start": "861600",
    "end": "864320"
  },
  {
    "text": "yes this was an interesting bug",
    "start": "864320",
    "end": "866800"
  },
  {
    "text": "and i do want to mention the signal",
    "start": "866800",
    "end": "869279"
  },
  {
    "text": "since then has vastly changed how their",
    "start": "869279",
    "end": "871040"
  },
  {
    "text": "calling state machine works",
    "start": "871040",
    "end": "873120"
  },
  {
    "text": "and now if you don't have someone in",
    "start": "873120",
    "end": "874800"
  },
  {
    "text": "your contacts you actually need to",
    "start": "874800",
    "end": "877360"
  },
  {
    "text": "interact with the phone before the offer",
    "start": "877360",
    "end": "879680"
  },
  {
    "text": "is even sent and that's a really big",
    "start": "879680",
    "end": "881680"
  },
  {
    "text": "improvement but this is how the state",
    "start": "881680",
    "end": "883519"
  },
  {
    "text": "machine worked in 2019",
    "start": "883519",
    "end": "886880"
  },
  {
    "text": "so here's another vulnerability i found",
    "start": "886880",
    "end": "889120"
  },
  {
    "text": "and this was in it was basically the",
    "start": "889120",
    "end": "891360"
  },
  {
    "text": "exact same vulnerability occurred in two",
    "start": "891360",
    "end": "893920"
  },
  {
    "text": "applications geochat which is popular in",
    "start": "893920",
    "end": "896800"
  },
  {
    "text": "india and mocha which is popular in",
    "start": "896800",
    "end": "900079"
  },
  {
    "text": "vietnam",
    "start": "900079",
    "end": "901440"
  },
  {
    "text": "and both of these",
    "start": "901440",
    "end": "903839"
  },
  {
    "text": "were caused by the developers not",
    "start": "903839",
    "end": "906079"
  },
  {
    "text": "understanding",
    "start": "906079",
    "end": "907440"
  },
  {
    "text": "that",
    "start": "907440",
    "end": "908399"
  },
  {
    "text": "candidates can occur in offers so this",
    "start": "908399",
    "end": "910399"
  },
  {
    "text": "was just a pure misunderstanding",
    "start": "910399",
    "end": "912720"
  },
  {
    "text": "a webrtc",
    "start": "912720",
    "end": "914160"
  },
  {
    "text": "features and they both allowed audio and",
    "start": "914160",
    "end": "916639"
  },
  {
    "text": "video to be transmitted without consent",
    "start": "916639",
    "end": "918639"
  },
  {
    "text": "so it would basically pick up a video",
    "start": "918639",
    "end": "920240"
  },
  {
    "text": "call",
    "start": "920240",
    "end": "922560"
  },
  {
    "text": "so the way this worked is these were",
    "start": "923440",
    "end": "924800"
  },
  {
    "text": "actually server mediated",
    "start": "924800",
    "end": "927360"
  },
  {
    "text": "so and actually all of these bugs are",
    "start": "927360",
    "end": "929519"
  },
  {
    "text": "but in this case the server's behavior",
    "start": "929519",
    "end": "932079"
  },
  {
    "text": "is actually relevant",
    "start": "932079",
    "end": "934160"
  },
  {
    "text": "so the device would exchange an offer",
    "start": "934160",
    "end": "936720"
  },
  {
    "text": "and an answer",
    "start": "936720",
    "end": "938320"
  },
  {
    "text": "but of course the offer would be sent to",
    "start": "938320",
    "end": "940959"
  },
  {
    "text": "a server and then the server would send",
    "start": "940959",
    "end": "942480"
  },
  {
    "text": "it to the device and then the callee",
    "start": "942480",
    "end": "944399"
  },
  {
    "text": "would send their answer to the server",
    "start": "944399",
    "end": "945920"
  },
  {
    "text": "which and then the server would send it",
    "start": "945920",
    "end": "947120"
  },
  {
    "text": "to the caller",
    "start": "947120",
    "end": "948639"
  },
  {
    "text": "but here's where it gets interesting",
    "start": "948639",
    "end": "951120"
  },
  {
    "text": "then both sides would start exchanging",
    "start": "951120",
    "end": "952880"
  },
  {
    "text": "candidates but the server wouldn't share",
    "start": "952880",
    "end": "955120"
  },
  {
    "text": "them the server would just um keep them",
    "start": "955120",
    "end": "958959"
  },
  {
    "text": "and then the phone is ringing",
    "start": "958959",
    "end": "961519"
  },
  {
    "text": "and the",
    "start": "961519",
    "end": "963440"
  },
  {
    "text": "callee would eventually hit the accept",
    "start": "963440",
    "end": "965759"
  },
  {
    "text": "button",
    "start": "965759",
    "end": "966800"
  },
  {
    "text": "and then the server would let all the",
    "start": "966800",
    "end": "968800"
  },
  {
    "text": "candidates free",
    "start": "968800",
    "end": "970079"
  },
  {
    "text": "and give them to the other side and then",
    "start": "970079",
    "end": "972720"
  },
  {
    "text": "this would call cause the call to",
    "start": "972720",
    "end": "974800"
  },
  {
    "text": "connect and then you can actually in",
    "start": "974800",
    "end": "976320"
  },
  {
    "text": "webrtc put an event on p2p media",
    "start": "976320",
    "end": "979440"
  },
  {
    "text": "connecting",
    "start": "979440",
    "end": "980880"
  },
  {
    "text": "and this is where the track was actually",
    "start": "980880",
    "end": "983040"
  },
  {
    "text": "added in geochat",
    "start": "983040",
    "end": "985920"
  },
  {
    "text": "and the problem here",
    "start": "985920",
    "end": "987839"
  },
  {
    "text": "is that um what if you have an offer",
    "start": "987839",
    "end": "990800"
  },
  {
    "text": "with candidates you know what if you can",
    "start": "990800",
    "end": "992000"
  },
  {
    "text": "kind of guess what some of them will be",
    "start": "992000",
    "end": "993600"
  },
  {
    "text": "and then send them then this immediately",
    "start": "993600",
    "end": "995600"
  },
  {
    "text": "connects right it's offer answer that's",
    "start": "995600",
    "end": "997920"
  },
  {
    "text": "all they need to connect and then it",
    "start": "997920",
    "end": "999279"
  },
  {
    "text": "will trigger this event and it'll add",
    "start": "999279",
    "end": "1000720"
  },
  {
    "text": "the track",
    "start": "1000720",
    "end": "1001839"
  },
  {
    "text": "and a video will be sent",
    "start": "1001839",
    "end": "1003920"
  },
  {
    "text": "and this was the vulnerability",
    "start": "1003920",
    "end": "1007920"
  },
  {
    "text": "and",
    "start": "1007920",
    "end": "1009600"
  },
  {
    "text": "you might ask",
    "start": "1009600",
    "end": "1011199"
  },
  {
    "text": "why did they design it this way",
    "start": "1011199",
    "end": "1013519"
  },
  {
    "text": "i think the reason they did this",
    "start": "1013519",
    "end": "1016399"
  },
  {
    "text": "was that you always have this problem",
    "start": "1016399",
    "end": "1018880"
  },
  {
    "text": "with webrtc where you have to make a",
    "start": "1018880",
    "end": "1021120"
  },
  {
    "text": "security trade-off either you set up the",
    "start": "1021120",
    "end": "1023440"
  },
  {
    "text": "p2p connection",
    "start": "1023440",
    "end": "1025520"
  },
  {
    "text": "before the user picks up the call and",
    "start": "1025520",
    "end": "1027438"
  },
  {
    "text": "then there's always the risk that an",
    "start": "1027439",
    "end": "1029120"
  },
  {
    "text": "attacker sends media",
    "start": "1029120",
    "end": "1031199"
  },
  {
    "text": "and that attack surface is available",
    "start": "1031199",
    "end": "1034000"
  },
  {
    "text": "and of course you can wait until after",
    "start": "1034000",
    "end": "1036319"
  },
  {
    "text": "the call has been answered to send the",
    "start": "1036319",
    "end": "1038240"
  },
  {
    "text": "offer and the answer",
    "start": "1038240",
    "end": "1040000"
  },
  {
    "text": "and that works as well but that has a",
    "start": "1040000",
    "end": "1041678"
  },
  {
    "text": "performance cost because once the users",
    "start": "1041679",
    "end": "1043520"
  },
  {
    "text": "picked up the call they have to wait for",
    "start": "1043520",
    "end": "1045038"
  },
  {
    "text": "it to connect so i think this was a way",
    "start": "1045039",
    "end": "1048160"
  },
  {
    "text": "to try and have the best of both worlds",
    "start": "1048160",
    "end": "1051840"
  },
  {
    "text": "and set up some of the connection but",
    "start": "1051840",
    "end": "1053440"
  },
  {
    "text": "not all of the connection and have it",
    "start": "1053440",
    "end": "1056080"
  },
  {
    "text": "both have a low attack surface and be",
    "start": "1056080",
    "end": "1058720"
  },
  {
    "text": "fast to set up",
    "start": "1058720",
    "end": "1060720"
  },
  {
    "text": "but unfortunately it didn't work",
    "start": "1060720",
    "end": "1063600"
  },
  {
    "text": "and i think this should also be a",
    "start": "1063600",
    "end": "1064880"
  },
  {
    "text": "warning that it's not a good idea to",
    "start": "1064880",
    "end": "1066880"
  },
  {
    "text": "come up with creative ways to make",
    "start": "1066880",
    "end": "1069679"
  },
  {
    "text": "webrtc more efficient",
    "start": "1069679",
    "end": "1071679"
  },
  {
    "text": "there are documented ways to set up",
    "start": "1071679",
    "end": "1073679"
  },
  {
    "text": "calls in webrtc",
    "start": "1073679",
    "end": "1075600"
  },
  {
    "text": "and it's the most secure choice to stick",
    "start": "1075600",
    "end": "1077919"
  },
  {
    "text": "to them and accept that you do have to",
    "start": "1077919",
    "end": "1079520"
  },
  {
    "text": "make a security trade-off",
    "start": "1079520",
    "end": "1081520"
  },
  {
    "text": "and decide whether you want to reduce",
    "start": "1081520",
    "end": "1083679"
  },
  {
    "text": "the remote attack surface of your",
    "start": "1083679",
    "end": "1085120"
  },
  {
    "text": "application or have it connect quickly",
    "start": "1085120",
    "end": "1089360"
  },
  {
    "text": "so finally i found this vulnerability in",
    "start": "1089360",
    "end": "1091840"
  },
  {
    "text": "google duo and this was found and fixed",
    "start": "1091840",
    "end": "1094559"
  },
  {
    "text": "in 2020",
    "start": "1094559",
    "end": "1096960"
  },
  {
    "text": "and um its root cause is increment",
    "start": "1096960",
    "end": "1099919"
  },
  {
    "text": "incorrect asynchronous logic which is",
    "start": "1099919",
    "end": "1101919"
  },
  {
    "text": "what a lot of people would call a race",
    "start": "1101919",
    "end": "1103919"
  },
  {
    "text": "condition and it was kind of interesting",
    "start": "1103919",
    "end": "1105919"
  },
  {
    "text": "because it didn't allow audio or video",
    "start": "1105919",
    "end": "1108320"
  },
  {
    "text": "to be transmitted it just allowed a few",
    "start": "1108320",
    "end": "1111600"
  },
  {
    "text": "frames of video to be transmitted",
    "start": "1111600",
    "end": "1114720"
  },
  {
    "text": "and this is i guess not as useful as say",
    "start": "1114720",
    "end": "1117440"
  },
  {
    "text": "turning on video for a long time",
    "start": "1117440",
    "end": "1120000"
  },
  {
    "text": "but still you know the ability to turn",
    "start": "1120000",
    "end": "1121440"
  },
  {
    "text": "on someone's camera",
    "start": "1121440",
    "end": "1122960"
  },
  {
    "text": "and take a few photos and then turn it",
    "start": "1122960",
    "end": "1124880"
  },
  {
    "text": "off again is still fairly concerning",
    "start": "1124880",
    "end": "1128720"
  },
  {
    "text": "so how did this work",
    "start": "1128720",
    "end": "1130400"
  },
  {
    "text": "well the way um duo would exchange their",
    "start": "1130400",
    "end": "1134559"
  },
  {
    "text": "offer answering candidates",
    "start": "1134559",
    "end": "1136720"
  },
  {
    "text": "is fairly typical",
    "start": "1136720",
    "end": "1138720"
  },
  {
    "text": "except that",
    "start": "1138720",
    "end": "1140799"
  },
  {
    "text": "they would add the track to video and",
    "start": "1140799",
    "end": "1144400"
  },
  {
    "text": "then",
    "start": "1144400",
    "end": "1145200"
  },
  {
    "text": "as soon as the sdp offer is received",
    "start": "1145200",
    "end": "1148240"
  },
  {
    "text": "they would turn it off using this",
    "start": "1148240",
    "end": "1149600"
  },
  {
    "text": "function called",
    "start": "1149600",
    "end": "1151520"
  },
  {
    "text": "sender.set parameters and normally this",
    "start": "1151520",
    "end": "1154320"
  },
  {
    "text": "would work fine",
    "start": "1154320",
    "end": "1155840"
  },
  {
    "text": "but notice that these are asynchronous",
    "start": "1155840",
    "end": "1157679"
  },
  {
    "text": "calls but still in a normal situation",
    "start": "1157679",
    "end": "1160160"
  },
  {
    "text": "you send the offer you turn off the",
    "start": "1160160",
    "end": "1161919"
  },
  {
    "text": "video you send back the answer",
    "start": "1161919",
    "end": "1164000"
  },
  {
    "text": "candidates get sent media is set up and",
    "start": "1164000",
    "end": "1166640"
  },
  {
    "text": "then the user accepts and then the same",
    "start": "1166640",
    "end": "1168320"
  },
  {
    "text": "function is used to turn the track back",
    "start": "1168320",
    "end": "1170480"
  },
  {
    "text": "on",
    "start": "1170480",
    "end": "1171679"
  },
  {
    "text": "here's what could happen",
    "start": "1171679",
    "end": "1173200"
  },
  {
    "text": "what if this is very very slow",
    "start": "1173200",
    "end": "1176480"
  },
  {
    "text": "and it turned out that i found a way to",
    "start": "1176480",
    "end": "1178320"
  },
  {
    "text": "do this",
    "start": "1178320",
    "end": "1179520"
  },
  {
    "text": "it turns out that the thread cue used",
    "start": "1179520",
    "end": "1182000"
  },
  {
    "text": "for this call to set parameters was",
    "start": "1182000",
    "end": "1184799"
  },
  {
    "text": "actually the same thread queue that was",
    "start": "1184799",
    "end": "1187440"
  },
  {
    "text": "used for incoming sctp data in webrtc",
    "start": "1187440",
    "end": "1192960"
  },
  {
    "text": "so i made something that would exchange",
    "start": "1192960",
    "end": "1194799"
  },
  {
    "text": "the offer and the answer and the",
    "start": "1194799",
    "end": "1196080"
  },
  {
    "text": "candidates and set up the pdp media",
    "start": "1196080",
    "end": "1198720"
  },
  {
    "text": "and then received a lot of data and then",
    "start": "1198720",
    "end": "1200799"
  },
  {
    "text": "i would just send this over and over and",
    "start": "1200799",
    "end": "1202480"
  },
  {
    "text": "over again with more and more data",
    "start": "1202480",
    "end": "1204080"
  },
  {
    "text": "queuing up and eventually i was able to",
    "start": "1204080",
    "end": "1206080"
  },
  {
    "text": "get it in a situation where this set",
    "start": "1206080",
    "end": "1208400"
  },
  {
    "text": "parameters was called really really late",
    "start": "1208400",
    "end": "1211440"
  },
  {
    "text": "and sometimes you get into the situation",
    "start": "1211440",
    "end": "1213840"
  },
  {
    "text": "where the media was actually",
    "start": "1213840",
    "end": "1215120"
  },
  {
    "text": "transmitting before it was turned off",
    "start": "1215120",
    "end": "1217039"
  },
  {
    "text": "and this meant that the video would turn",
    "start": "1217039",
    "end": "1218799"
  },
  {
    "text": "on for a few frames send them and turn",
    "start": "1218799",
    "end": "1220640"
  },
  {
    "text": "off",
    "start": "1220640",
    "end": "1221520"
  },
  {
    "text": "and that turned out to be kind of a cool",
    "start": "1221520",
    "end": "1223600"
  },
  {
    "text": "bug",
    "start": "1223600",
    "end": "1225840"
  },
  {
    "text": "so how did i test these vulnerabilities",
    "start": "1225840",
    "end": "1228720"
  },
  {
    "text": "well it was a bit painful if they were",
    "start": "1228720",
    "end": "1231280"
  },
  {
    "text": "open source apps that was great",
    "start": "1231280",
    "end": "1234559"
  },
  {
    "text": "i would",
    "start": "1234559",
    "end": "1236080"
  },
  {
    "text": "recompile them change what they do",
    "start": "1236080",
    "end": "1238480"
  },
  {
    "text": "and set all the messages i want",
    "start": "1238480",
    "end": "1240480"
  },
  {
    "text": "otherwise i would use frida to change",
    "start": "1240480",
    "end": "1242720"
  },
  {
    "text": "the state machine call flow",
    "start": "1242720",
    "end": "1244880"
  },
  {
    "text": "and this was painful especially since",
    "start": "1244880",
    "end": "1247120"
  },
  {
    "text": "most of these apps were obfuscated you",
    "start": "1247120",
    "end": "1248960"
  },
  {
    "text": "know i'd call a dot a dot a dot b",
    "start": "1248960",
    "end": "1251520"
  },
  {
    "text": "and then get the wrong one and call it",
    "start": "1251520",
    "end": "1253200"
  },
  {
    "text": "again but with enough work i'd figured",
    "start": "1253200",
    "end": "1255120"
  },
  {
    "text": "out how to call to send the messages and",
    "start": "1255120",
    "end": "1257200"
  },
  {
    "text": "then call them in frida",
    "start": "1257200",
    "end": "1259120"
  },
  {
    "text": "and um reproduce all these issues and",
    "start": "1259120",
    "end": "1261280"
  },
  {
    "text": "for all of them i had frieda scripts",
    "start": "1261280",
    "end": "1262799"
  },
  {
    "text": "that would actually work",
    "start": "1262799",
    "end": "1264799"
  },
  {
    "text": "but this did require an extra step in",
    "start": "1264799",
    "end": "1268000"
  },
  {
    "text": "facebook messenger and i just wanted to",
    "start": "1268000",
    "end": "1269360"
  },
  {
    "text": "share this because i thought it was a",
    "start": "1269360",
    "end": "1271360"
  },
  {
    "text": "bit cool",
    "start": "1271360",
    "end": "1272799"
  },
  {
    "text": "so facebook messenger uses something",
    "start": "1272799",
    "end": "1275039"
  },
  {
    "text": "called facebook thrift and it's open",
    "start": "1275039",
    "end": "1277120"
  },
  {
    "text": "source you can find it on github it's a",
    "start": "1277120",
    "end": "1279280"
  },
  {
    "text": "branch of thrift",
    "start": "1279280",
    "end": "1280960"
  },
  {
    "text": "and thrift is a format where you provide",
    "start": "1280960",
    "end": "1284320"
  },
  {
    "text": "a protocol definition",
    "start": "1284320",
    "end": "1286799"
  },
  {
    "text": "and then the code is generated so that",
    "start": "1286799",
    "end": "1290159"
  },
  {
    "text": "you can decode and encode messages",
    "start": "1290159",
    "end": "1292720"
  },
  {
    "text": "and",
    "start": "1292720",
    "end": "1293520"
  },
  {
    "text": "this is how",
    "start": "1293520",
    "end": "1295039"
  },
  {
    "text": "a lot of messages in facebook messenger",
    "start": "1295039",
    "end": "1297120"
  },
  {
    "text": "especially the mobile versions work",
    "start": "1297120",
    "end": "1299840"
  },
  {
    "text": "and i looked at how facebook thrift",
    "start": "1299840",
    "end": "1302000"
  },
  {
    "text": "worked and it turns out that they call",
    "start": "1302000",
    "end": "1304799"
  },
  {
    "text": "this function right field begin every",
    "start": "1304799",
    "end": "1306880"
  },
  {
    "text": "time they start writing an object so",
    "start": "1306880",
    "end": "1309120"
  },
  {
    "text": "this is um an object being encoded",
    "start": "1309120",
    "end": "1311360"
  },
  {
    "text": "before it's sent",
    "start": "1311360",
    "end": "1312799"
  },
  {
    "text": "so i went through and i found this in",
    "start": "1312799",
    "end": "1314799"
  },
  {
    "text": "source",
    "start": "1314799",
    "end": "1315840"
  },
  {
    "text": "but",
    "start": "1315840",
    "end": "1316720"
  },
  {
    "text": "then i looked at where it was called",
    "start": "1316720",
    "end": "1318480"
  },
  {
    "text": "and it was kind of interesting it turns",
    "start": "1318480",
    "end": "1320240"
  },
  {
    "text": "out that when",
    "start": "1320240",
    "end": "1322320"
  },
  {
    "text": "thrift is compiled in c it actually",
    "start": "1322320",
    "end": "1325760"
  },
  {
    "text": "writes the field name of",
    "start": "1325760",
    "end": "1328880"
  },
  {
    "text": "the field that it's writing even though",
    "start": "1328880",
    "end": "1331280"
  },
  {
    "text": "in the serialization format that",
    "start": "1331280",
    "end": "1333039"
  },
  {
    "text": "facebook uses this will never actually",
    "start": "1333039",
    "end": "1335039"
  },
  {
    "text": "end up in the packet or the message but",
    "start": "1335039",
    "end": "1337600"
  },
  {
    "text": "it'll still write this string",
    "start": "1337600",
    "end": "1340320"
  },
  {
    "text": "for some reason so you can actually read",
    "start": "1340320",
    "end": "1343600"
  },
  {
    "text": "the name of the fields in the definition",
    "start": "1343600",
    "end": "1346640"
  },
  {
    "text": "right out of the binary so you can see",
    "start": "1346640",
    "end": "1348799"
  },
  {
    "text": "in this one there's the x map and then",
    "start": "1348799",
    "end": "1350640"
  },
  {
    "text": "there's the id and the uri",
    "start": "1350640",
    "end": "1353120"
  },
  {
    "text": "and for example for the uri there's the",
    "start": "1353120",
    "end": "1355440"
  },
  {
    "text": "eight and the two and one of these is",
    "start": "1355440",
    "end": "1356960"
  },
  {
    "text": "the field id and the other",
    "start": "1356960",
    "end": "1359440"
  },
  {
    "text": "is the type of the field and i used this",
    "start": "1359440",
    "end": "1363039"
  },
  {
    "text": "to create the schema and then i was able",
    "start": "1363039",
    "end": "1366559"
  },
  {
    "text": "to go through",
    "start": "1366559",
    "end": "1368240"
  },
  {
    "text": "and find the entire format of a p2p",
    "start": "1368240",
    "end": "1371360"
  },
  {
    "text": "message",
    "start": "1371360",
    "end": "1372559"
  },
  {
    "text": "in facebook thrift which is a facebook",
    "start": "1372559",
    "end": "1374880"
  },
  {
    "text": "messenger's message format this took",
    "start": "1374880",
    "end": "1377280"
  },
  {
    "text": "quite a long time",
    "start": "1377280",
    "end": "1378880"
  },
  {
    "text": "this ended up being a roughly 300 line",
    "start": "1378880",
    "end": "1382000"
  },
  {
    "text": "definition in facebook thrift",
    "start": "1382000",
    "end": "1384880"
  },
  {
    "text": "but i was able to do some cool things",
    "start": "1384880",
    "end": "1387440"
  },
  {
    "text": "with it",
    "start": "1387440",
    "end": "1388640"
  },
  {
    "text": "i",
    "start": "1388640",
    "end": "1390320"
  },
  {
    "text": "was first able to",
    "start": "1390320",
    "end": "1393840"
  },
  {
    "text": "compile it in c",
    "start": "1393840",
    "end": "1395600"
  },
  {
    "text": "and then load that compilation into ida",
    "start": "1395600",
    "end": "1398880"
  },
  {
    "text": "so that i could read the packet types",
    "start": "1398880",
    "end": "1401360"
  },
  {
    "text": "out of",
    "start": "1401360",
    "end": "1403760"
  },
  {
    "text": "read the packet types in ida and figure",
    "start": "1403760",
    "end": "1405520"
  },
  {
    "text": "out how the packets were handled i was",
    "start": "1405520",
    "end": "1407679"
  },
  {
    "text": "also able to compile this with",
    "start": "1407679",
    "end": "1410559"
  },
  {
    "text": "thrift in python and i was able to load",
    "start": "1410559",
    "end": "1412880"
  },
  {
    "text": "that python into frida",
    "start": "1412880",
    "end": "1415600"
  },
  {
    "text": "and then what was cool about that is",
    "start": "1415600",
    "end": "1417039"
  },
  {
    "text": "that i could use this to create my own",
    "start": "1417039",
    "end": "1419360"
  },
  {
    "text": "facebook thrift messages and send them",
    "start": "1419360",
    "end": "1421520"
  },
  {
    "text": "and this is how i decoded this",
    "start": "1421520",
    "end": "1424559"
  },
  {
    "text": "facebook thrift message and i want to",
    "start": "1424559",
    "end": "1426640"
  },
  {
    "text": "say that this was something that took a",
    "start": "1426640",
    "end": "1428400"
  },
  {
    "text": "huge amount of time it took about a",
    "start": "1428400",
    "end": "1430240"
  },
  {
    "text": "month to figure out how to do this and i",
    "start": "1430240",
    "end": "1432480"
  },
  {
    "text": "actually tried two other times and spent",
    "start": "1432480",
    "end": "1435039"
  },
  {
    "text": "two weeks and then gave up",
    "start": "1435039",
    "end": "1437120"
  },
  {
    "text": "so just in case you're wondering is it",
    "start": "1437120",
    "end": "1439200"
  },
  {
    "text": "possible to figure out some of these",
    "start": "1439200",
    "end": "1440799"
  },
  {
    "text": "custom formats for messaging",
    "start": "1440799",
    "end": "1442320"
  },
  {
    "text": "applications and use them to find this",
    "start": "1442320",
    "end": "1444400"
  },
  {
    "text": "type of bug yes it is though it's time",
    "start": "1444400",
    "end": "1446559"
  },
  {
    "text": "consuming",
    "start": "1446559",
    "end": "1447840"
  },
  {
    "text": "but in the end i did manage to",
    "start": "1447840",
    "end": "1450159"
  },
  {
    "text": "be able to decode and create these",
    "start": "1450159",
    "end": "1452159"
  },
  {
    "text": "message types well enough that",
    "start": "1452159",
    "end": "1454559"
  },
  {
    "text": "i could",
    "start": "1454559",
    "end": "1456240"
  },
  {
    "text": "find and reproduce this issue",
    "start": "1456240",
    "end": "1458480"
  },
  {
    "text": "in facebook messenger",
    "start": "1458480",
    "end": "1460720"
  },
  {
    "text": "so what's the root causes of these types",
    "start": "1460720",
    "end": "1462400"
  },
  {
    "text": "of issues i think the main one is lack",
    "start": "1462400",
    "end": "1464559"
  },
  {
    "text": "of understanding of this vulnerability",
    "start": "1464559",
    "end": "1466320"
  },
  {
    "text": "type",
    "start": "1466320",
    "end": "1467360"
  },
  {
    "text": "it",
    "start": "1467360",
    "end": "1468240"
  },
  {
    "text": "was unprecedented until that face time",
    "start": "1468240",
    "end": "1470559"
  },
  {
    "text": "bug occurred so i think part of the",
    "start": "1470559",
    "end": "1472720"
  },
  {
    "text": "problem is just developers don't know",
    "start": "1472720",
    "end": "1474720"
  },
  {
    "text": "that this can happen they don't know",
    "start": "1474720",
    "end": "1476720"
  },
  {
    "text": "they need to be careful about it and",
    "start": "1476720",
    "end": "1479440"
  },
  {
    "text": "they don't know that they need to test",
    "start": "1479440",
    "end": "1480960"
  },
  {
    "text": "their state machines for this sort of",
    "start": "1480960",
    "end": "1482720"
  },
  {
    "text": "thing",
    "start": "1482720",
    "end": "1483600"
  },
  {
    "text": "i also think that",
    "start": "1483600",
    "end": "1485520"
  },
  {
    "text": "some developers don't understand all the",
    "start": "1485520",
    "end": "1488080"
  },
  {
    "text": "webrtc features",
    "start": "1488080",
    "end": "1490159"
  },
  {
    "text": "and honestly they aren't always well",
    "start": "1490159",
    "end": "1491919"
  },
  {
    "text": "documented though that's getting better",
    "start": "1491919",
    "end": "1494320"
  },
  {
    "text": "and this leads to these vulnerabilities",
    "start": "1494320",
    "end": "1497039"
  },
  {
    "text": "and finally there is this design choice",
    "start": "1497039",
    "end": "1499279"
  },
  {
    "text": "of whether you set up the pdp connection",
    "start": "1499279",
    "end": "1501919"
  },
  {
    "text": "before the call is answered and i went",
    "start": "1501919",
    "end": "1504000"
  },
  {
    "text": "over with what the trade-offs are but",
    "start": "1504000",
    "end": "1505679"
  },
  {
    "text": "just a reminder if you don't do anything",
    "start": "1505679",
    "end": "1508080"
  },
  {
    "text": "before a call is answered there's no",
    "start": "1508080",
    "end": "1510320"
  },
  {
    "text": "attack surface",
    "start": "1510320",
    "end": "1512080"
  },
  {
    "text": "and then there is basically no chance of",
    "start": "1512080",
    "end": "1515039"
  },
  {
    "text": "fully remote vulnerability zero click",
    "start": "1515039",
    "end": "1516799"
  },
  {
    "text": "vulnerabilities because the user has to",
    "start": "1516799",
    "end": "1518559"
  },
  {
    "text": "click for there to be any attack surface",
    "start": "1518559",
    "end": "1521039"
  },
  {
    "text": "and that's the most secure design even",
    "start": "1521039",
    "end": "1523120"
  },
  {
    "text": "though there are downsides with regards",
    "start": "1523120",
    "end": "1525360"
  },
  {
    "text": "to performance",
    "start": "1525360",
    "end": "1527840"
  },
  {
    "text": "um in conclusion",
    "start": "1527840",
    "end": "1529840"
  },
  {
    "text": "video conferencing signaling state bugs",
    "start": "1529840",
    "end": "1532240"
  },
  {
    "text": "are common",
    "start": "1532240",
    "end": "1534159"
  },
  {
    "text": "i looked at several applications and",
    "start": "1534159",
    "end": "1536799"
  },
  {
    "text": "basically every application i looked at",
    "start": "1536799",
    "end": "1538799"
  },
  {
    "text": "had this bug",
    "start": "1538799",
    "end": "1540240"
  },
  {
    "text": "when the facetime bug came out it seemed",
    "start": "1540240",
    "end": "1542080"
  },
  {
    "text": "special and unique but it was really",
    "start": "1542080",
    "end": "1543919"
  },
  {
    "text": "because no one had looked for this type",
    "start": "1543919",
    "end": "1545440"
  },
  {
    "text": "of bug",
    "start": "1545440",
    "end": "1547039"
  },
  {
    "text": "and most apps i looked at were",
    "start": "1547039",
    "end": "1548640"
  },
  {
    "text": "vulnerable",
    "start": "1548640",
    "end": "1550159"
  },
  {
    "text": "some of these problems can be attributed",
    "start": "1550159",
    "end": "1551600"
  },
  {
    "text": "to webrtc",
    "start": "1551600",
    "end": "1553200"
  },
  {
    "text": "it's designed as documentation but a lot",
    "start": "1553200",
    "end": "1555840"
  },
  {
    "text": "of them can't most of them it was",
    "start": "1555840",
    "end": "1557919"
  },
  {
    "text": "actually the application developers that",
    "start": "1557919",
    "end": "1560320"
  },
  {
    "text": "made the mistake",
    "start": "1560320",
    "end": "1562080"
  },
  {
    "text": "so i think it's important that",
    "start": "1562080",
    "end": "1563440"
  },
  {
    "text": "developers be careful when they design",
    "start": "1563440",
    "end": "1564960"
  },
  {
    "text": "their calling state machines it's",
    "start": "1564960",
    "end": "1566720"
  },
  {
    "text": "important that people be aware of this",
    "start": "1566720",
    "end": "1568000"
  },
  {
    "text": "type of bug",
    "start": "1568000",
    "end": "1569440"
  },
  {
    "text": "and people be aware",
    "start": "1569440",
    "end": "1571279"
  },
  {
    "text": "that their state machines don't just",
    "start": "1571279",
    "end": "1572960"
  },
  {
    "text": "need to work they need to consider the",
    "start": "1572960",
    "end": "1574880"
  },
  {
    "text": "possibility that attackers are going to",
    "start": "1574880",
    "end": "1578159"
  },
  {
    "text": "try and use it to connect a call without",
    "start": "1578159",
    "end": "1579919"
  },
  {
    "text": "a user's consent and finally i just want",
    "start": "1579919",
    "end": "1582159"
  },
  {
    "text": "to say that this is an area that needs",
    "start": "1582159",
    "end": "1584000"
  },
  {
    "text": "more research",
    "start": "1584000",
    "end": "1585600"
  },
  {
    "text": "so i only looked at one-on-one calls in",
    "start": "1585600",
    "end": "1588159"
  },
  {
    "text": "this i only looked at calls where one",
    "start": "1588159",
    "end": "1590000"
  },
  {
    "text": "person calls another person and they",
    "start": "1590000",
    "end": "1591440"
  },
  {
    "text": "answer i didn't even look at group calls",
    "start": "1591440",
    "end": "1594720"
  },
  {
    "text": "and this was the number of",
    "start": "1594720",
    "end": "1595600"
  },
  {
    "text": "vulnerabilities i found so i think if",
    "start": "1595600",
    "end": "1597520"
  },
  {
    "text": "someone looks at this even more debt in",
    "start": "1597520",
    "end": "1599360"
  },
  {
    "text": "even more depth there's probably even",
    "start": "1599360",
    "end": "1601919"
  },
  {
    "text": "more bugs like that so i'm hoping that",
    "start": "1601919",
    "end": "1604480"
  },
  {
    "text": "this talk can be a starting point",
    "start": "1604480",
    "end": "1606880"
  },
  {
    "text": "and other people can think more about",
    "start": "1606880",
    "end": "1608880"
  },
  {
    "text": "this and find other cool calling mistake",
    "start": "1608880",
    "end": "1611600"
  },
  {
    "text": "machines bugs",
    "start": "1611600",
    "end": "1614159"
  },
  {
    "text": "so that's it",
    "start": "1614159",
    "end": "1615520"
  },
  {
    "text": "thanks a lot we'll now have time for",
    "start": "1615520",
    "end": "1617679"
  },
  {
    "text": "questions and if i don't get to your",
    "start": "1617679",
    "end": "1619840"
  },
  {
    "text": "question feel free to check out our blog",
    "start": "1619840",
    "end": "1622480"
  },
  {
    "text": "or feel free to contact me i love",
    "start": "1622480",
    "end": "1625600"
  },
  {
    "text": "answering questions from people thanks a",
    "start": "1625600",
    "end": "1627679"
  },
  {
    "text": "lot",
    "start": "1627679",
    "end": "1630679"
  }
]