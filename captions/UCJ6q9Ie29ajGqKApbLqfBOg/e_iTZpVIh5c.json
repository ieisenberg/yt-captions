[
  {
    "text": "well first thank you everybody for attending today called deep dive into a an ICS firewall before we start let us",
    "start": "60",
    "end": "9870"
  },
  {
    "text": "introduce ourselves so I'm Julian woth I'm a member of the security evaluation",
    "start": "9870",
    "end": "15030"
  },
  {
    "text": "team of Airbus where I do evaluate both IT IT systems and embedded systems and I",
    "start": "15030",
    "end": "21840"
  },
  {
    "text": "do mostly reverse engineering and vulnerability research and I also have to admit that Linux is my kryptonite",
    "start": "21840",
    "end": "31070"
  },
  {
    "text": "hello everyone I am Binaca Adam and I'm also security evaluator in working in",
    "start": "31070",
    "end": "37170"
  },
  {
    "text": "the same team as Julian I mainly my day-to-day job is to mainly perform an",
    "start": "37170",
    "end": "42780"
  },
  {
    "text": "embedded system audit and pen test and my main interest is everything that is",
    "start": "42780",
    "end": "48870"
  },
  {
    "text": "related to linux and the network and for the guys in the back of the room i'm not",
    "start": "48870",
    "end": "54539"
  },
  {
    "text": "small it's just very tall okay so you",
    "start": "54539",
    "end": "66000"
  },
  {
    "text": "know and I am are not really ice ICS specialists but but evaluation",
    "start": "66000",
    "end": "72869"
  },
  {
    "text": "specialists so today the purpose of this talk is to share with you the results we have along with the the metallurgy we",
    "start": "72869",
    "end": "80460"
  },
  {
    "text": "used so this presentation will be about the evolution of a file which is dedicated to protect industrial systems",
    "start": "80460",
    "end": "87600"
  },
  {
    "text": "and it's called the trophy Knox enum if it were its it's manufactured by PI",
    "start": "87600",
    "end": "92759"
  },
  {
    "text": "builder so all the vulnerabilities you'll see today were responsibly disclosed to the vendor who has issued",
    "start": "92759",
    "end": "99240"
  },
  {
    "text": "the framework in November 2017 to fix the vulnerabilities and three of those",
    "start": "99240",
    "end": "104310"
  },
  {
    "text": "reliabilities were assigned series and will they tell them later in this presentation so to this presentation",
    "start": "104310",
    "end": "113790"
  },
  {
    "text": "I'll outline will be the following so first we'll describe the threats and constraints of the ICS environments then",
    "start": "113790",
    "end": "121500"
  },
  {
    "text": "we'll present the trophy noms in on the firewall we have evaluated then the evolution of black chips we had the",
    "start": "121500",
    "end": "128769"
  },
  {
    "text": "the N lines we followed in the middle so the methodology we followed then the elimin I work we had to achieve to get",
    "start": "128769",
    "end": "135849"
  },
  {
    "text": "to the internals of the equipment to to conduct the evaluation in the proper conditions then the evaluation results",
    "start": "135849",
    "end": "143799"
  },
  {
    "text": "the results and finally we'll conclude",
    "start": "143799",
    "end": "148049"
  },
  {
    "text": "okay so first what do we mean by ICS systems so we'd say that that's everything that is controlling in Israel",
    "start": "150659",
    "end": "157689"
  },
  {
    "text": "processes so there are many kinds of industrial control systems they are",
    "start": "157689",
    "end": "163209"
  },
  {
    "text": "categorized by the Trojan model in in a in three different category for three",
    "start": "163209",
    "end": "169780"
  },
  {
    "text": "different levels from level 3 to level 0 where the closer you are the lower the level is the closer you are from the",
    "start": "169780",
    "end": "176200"
  },
  {
    "text": "industrial process so what's important for you to keep in mind here is that the",
    "start": "176200",
    "end": "181780"
  },
  {
    "text": "the file you have evaluated is meant to be deployed between level 2 equipments like HD nice or SCARA and level 1",
    "start": "181780",
    "end": "189760"
  },
  {
    "text": "equipments like PLC's so first a few few",
    "start": "189760",
    "end": "195340"
  },
  {
    "text": "figures regarding the vulnerabilities which were identified in 2017 figures",
    "start": "195340",
    "end": "200379"
  },
  {
    "text": "from Kaspersky Lab ics-cert so we can see that 322 vulnerabilities were",
    "start": "200379",
    "end": "206760"
  },
  {
    "text": "identified and we identified and we roughly 60% of them at the SIF cbss go",
    "start": "206760",
    "end": "213489"
  },
  {
    "text": "higher than 60% which means that there were quite severe vulnerabilities we can",
    "start": "213489",
    "end": "218919"
  },
  {
    "text": "also see that the the sector's effectively affected are crucial for our",
    "start": "218919",
    "end": "224470"
  },
  {
    "text": "day-to-day lives which makes makes this topic very very concerning when what's also concerning is that those systems",
    "start": "224470",
    "end": "230889"
  },
  {
    "text": "tend to be more and more connected to the to the outside world so one of the",
    "start": "230889",
    "end": "237729"
  },
  {
    "text": "main constraints of the ICS systems is availability and there's a very good",
    "start": "237729",
    "end": "243430"
  },
  {
    "text": "reason for that first because malfunctions of those system can have significant impacts for",
    "start": "243430",
    "end": "250629"
  },
  {
    "text": "people working in the fields there but also that the down tank downtime costs",
    "start": "250629",
    "end": "255790"
  },
  {
    "text": "of the of the system are very very very high so here we are facing some kind of",
    "start": "255790",
    "end": "261600"
  },
  {
    "text": "dilemma because on one hand you have some systems who are running which",
    "start": "261600",
    "end": "267890"
  },
  {
    "text": "vulnerable sometimes they are quite old and and sixes are not available and even",
    "start": "267890",
    "end": "274290"
  },
  {
    "text": "when they are you have very rare occasions to stop the system and to apply the patches and on the other hand",
    "start": "274290",
    "end": "281100"
  },
  {
    "text": "they are the the dose system faith threats and and real world attacks do",
    "start": "281100",
    "end": "287610"
  },
  {
    "text": "happen and we saw them in the inner treatment talk this morning which was a good talk by the way so to answer this",
    "start": "287610",
    "end": "296370"
  },
  {
    "text": "dilemma and this this this business need dedicated system that have come to the",
    "start": "296370",
    "end": "302190"
  },
  {
    "text": "markets which are meant to be to be deployed in front of vulnerable ICS",
    "start": "302190",
    "end": "308130"
  },
  {
    "text": "systems and they are meant to stop the attack by filtering network packets in to ensure that that that that only valid",
    "start": "308130",
    "end": "316230"
  },
  {
    "text": "packets which potential potentially vulnerable equipments to to protect them",
    "start": "316230",
    "end": "321570"
  },
  {
    "text": "and invalid packets are meant to be dropped so our objective we are whether",
    "start": "321570",
    "end": "329750"
  },
  {
    "text": "what to objectives here the first one is kind of obvious it's it's you we wanted",
    "start": "329750",
    "end": "336300"
  },
  {
    "text": "to answer the question how effective are this this this equipment to protect the",
    "start": "336300",
    "end": "341450"
  },
  {
    "text": "ICS systems and the other one is is there any vulnerability inside the file",
    "start": "341450",
    "end": "347850"
  },
  {
    "text": "itself that may be introduced in the network by deploying it so we had a few",
    "start": "347850",
    "end": "354660"
  },
  {
    "text": "constraints the first one which is a very important one is that we were not allowed to physically on tamper with the",
    "start": "354660",
    "end": "362190"
  },
  {
    "text": "equipment's which means we were not able to open it and unfold all the flash for example so we were limited to software",
    "start": "362190",
    "end": "369060"
  },
  {
    "text": "only attacks and we had I would not say",
    "start": "369060",
    "end": "374640"
  },
  {
    "text": "limited but we have a few inputs which were few more updates available on from",
    "start": "374640",
    "end": "380130"
  },
  {
    "text": "the vendor website the user guides and of course the appliances itself to to play with it so our approach was the",
    "start": "380130",
    "end": "387990"
  },
  {
    "text": "following with all who first listed all the features that the equipment has then we're talking",
    "start": "387990",
    "end": "394320"
  },
  {
    "text": "configure consideration the French network and information security agency security profile for this kind of ICS",
    "start": "394320",
    "end": "401460"
  },
  {
    "text": "firewalls and we'll detail them later and finally we from with this profiles",
    "start": "401460",
    "end": "408090"
  },
  {
    "text": "we we kept all the most relevant and the most certain features and all and we had",
    "start": "408090",
    "end": "414330"
  },
  {
    "text": "the lists of those which had to be abbreviated and then we averted them the",
    "start": "414330",
    "end": "419940"
  },
  {
    "text": "offensive way ok so now we are going to",
    "start": "419940",
    "end": "425430"
  },
  {
    "text": "present the Tofino magazine on system from a finalist from a final user point of view so it is a fire also it has to",
    "start": "425430",
    "end": "434490"
  },
  {
    "text": "be located in front of you ICS of your network of ICS it will physically",
    "start": "434490",
    "end": "440700"
  },
  {
    "text": "segregate the open world that is represented by the by the control",
    "start": "440700",
    "end": "447419"
  },
  {
    "text": "network that where the attack come from and the secure zone that is containing your ICS systems but from a logical",
    "start": "447419",
    "end": "455460"
  },
  {
    "text": "point of view it is free transparent and does not even an IP address meaning that",
    "start": "455460",
    "end": "460950"
  },
  {
    "text": "if you buy a trophy no Z no system you do not have to change your network",
    "start": "460950",
    "end": "466380"
  },
  {
    "text": "configuration you do not have to change your network addressing it has been designed to be free plug and play and to",
    "start": "466380",
    "end": "473100"
  },
  {
    "text": "have the least possible impact on your existing system now the filtering is",
    "start": "473100",
    "end": "478620"
  },
  {
    "text": "done at two different levels first classic one which is based on network",
    "start": "478620",
    "end": "484380"
  },
  {
    "text": "parameters like protocol port and destination sauce and more ICS oriented",
    "start": "484380",
    "end": "490650"
  },
  {
    "text": "one who has the trophy no system will deeply inspect the content of the application layer of the ICS packets and",
    "start": "490650",
    "end": "499320"
  },
  {
    "text": "according the the content it will allow or not the packets to go through the",
    "start": "499320",
    "end": "504419"
  },
  {
    "text": "file they are three different protocols that are entered by the Tofino appliance the",
    "start": "504419",
    "end": "512099"
  },
  {
    "text": "Modbus TCP protocol the eternal GP and the OPC classic as Julian say previously",
    "start": "512099",
    "end": "519750"
  },
  {
    "text": "a very important thing in ICS environment is a availability and for that tough you know",
    "start": "519750",
    "end": "528439"
  },
  {
    "text": "they've worked two different modes for the appliance the first one is a test model where packets that should have",
    "start": "528439",
    "end": "535309"
  },
  {
    "text": "been roughed only locked and not really dropped and once you are in line with",
    "start": "535309",
    "end": "542389"
  },
  {
    "text": "your configuration you can switch to an operational mode whereas the packet will",
    "start": "542389",
    "end": "547459"
  },
  {
    "text": "be really dropped if they do not match a favor a favor whole room now I'm going",
    "start": "547459",
    "end": "554120"
  },
  {
    "text": "to describe the two main components of the Tofino the first one is a security",
    "start": "554120",
    "end": "559670"
  },
  {
    "text": "appliance the small box that you will install in your network so it has been",
    "start": "559670",
    "end": "565819"
  },
  {
    "text": "physically designed to fit in a safety critical environment and the box as two",
    "start": "565819",
    "end": "571990"
  },
  {
    "text": "Ethernet ports one for the open zone and one for the secure zone colleague feature your ICS systems there is also a",
    "start": "571990",
    "end": "580670"
  },
  {
    "text": "USB port that is used to push filtering configuration to push new upgrades or to",
    "start": "580670",
    "end": "588079"
  },
  {
    "text": "retrieve some log of the appliance now",
    "start": "588079",
    "end": "595279"
  },
  {
    "text": "there is also the configurator which is a software part it's the only official way to configure one or more appliance",
    "start": "595279",
    "end": "603459"
  },
  {
    "text": "it's Windows which client and it allow",
    "start": "603459",
    "end": "608749"
  },
  {
    "text": "to define the filtering rules to customize the DPI level of priciest",
    "start": "608749",
    "end": "614569"
  },
  {
    "text": "protocols and once you are in line with the configuration you have two different",
    "start": "614569",
    "end": "621230"
  },
  {
    "text": "ways to apply this configuration the first one is using the network network protocols that is that has been",
    "start": "621230",
    "end": "627709"
  },
  {
    "text": "customized by Tofino and that we will describe in a few slides and the other way is to generate an encrypted file",
    "start": "627709",
    "end": "634610"
  },
  {
    "text": "that you can store in a USB stick so now",
    "start": "634610",
    "end": "642110"
  },
  {
    "text": "a bit more about the evolution objectives the guidelines we followed so",
    "start": "642110",
    "end": "649670"
  },
  {
    "text": "in those guidelines they make a few assumptions - first regarding the ICS file equipments the first one is",
    "start": "649670",
    "end": "655939"
  },
  {
    "text": "regarding its locations so they consider it's not necessarily stored in a location where there is a street control",
    "start": "655939",
    "end": "661580"
  },
  {
    "text": "access which means that an attacker may have physical access to the equipment's",
    "start": "661580",
    "end": "666590"
  },
  {
    "text": "for a few minutes also regarding the dimensioning of the equipment's which means that it's it's properly dimensions",
    "start": "666590",
    "end": "673850"
  },
  {
    "text": "for its tasks in order in other words that floating attacks are not relevant and also that an attacker can purchase",
    "start": "673850",
    "end": "683810"
  },
  {
    "text": "the equipment to search for vulnerabilities prior to launching the attack and with disregard what Wenhua",
    "start": "683810",
    "end": "689240"
  },
  {
    "text": "and I did during this evaluation is very representative of this kind of attack up",
    "start": "689240",
    "end": "694310"
  },
  {
    "text": "of files so as I said the attacker can can access for a few minutes to the",
    "start": "694310",
    "end": "699950"
  },
  {
    "text": "Clipper but this it's considered that it cannot open up and open the box and and",
    "start": "699950",
    "end": "706490"
  },
  {
    "text": "perform physical attacks on the equipment so the security objectives we",
    "start": "706490",
    "end": "713390"
  },
  {
    "text": "summed up this all the security objectives that are described in the guidelines and we kept those are very",
    "start": "713390",
    "end": "719240"
  },
  {
    "text": "relevant for our equipments so the first most important security objective I",
    "start": "719240",
    "end": "724400"
  },
  {
    "text": "would say is the firewall security objective so first policy of enforcement like what's the basic firewall functions",
    "start": "724400",
    "end": "731900"
  },
  {
    "text": "and also protocol confirm at immediate analysis which is the packet inspection also the administration because you will",
    "start": "731900",
    "end": "740060"
  },
  {
    "text": "consider that the mayor must have secure authentication and also proper access",
    "start": "740060",
    "end": "746330"
  },
  {
    "text": "control to the equipment's on both USB and network in our case and also on the",
    "start": "746330",
    "end": "752330"
  },
  {
    "text": "upgrade because we consider the the upgrades most the firmware must be",
    "start": "752330",
    "end": "757940"
  },
  {
    "text": "properly signed on both here once again on both USB and networking because both",
    "start": "757940",
    "end": "763880"
  },
  {
    "text": "can be can be uploaded both ways so now",
    "start": "763880",
    "end": "770000"
  },
  {
    "text": "the the preliminary what we had to achieve to get to the internals of the equipment the weapon why and I work we",
    "start": "770000",
    "end": "777080"
  },
  {
    "text": "is the following we usually like to have access to the code of the equipment's either the source code when it's",
    "start": "777080",
    "end": "782750"
  },
  {
    "text": "available or the binary code of the the firmware to do with engineering so we tried it this in this approach but in",
    "start": "782750",
    "end": "790100"
  },
  {
    "text": "fortunately first the firmware are fully encrypted and decryption keys are stored inside the appliance and disciplines is was kind of",
    "start": "790100",
    "end": "797810"
  },
  {
    "text": "off black box so and as I said we were not able to unsolved and soldier the",
    "start": "797810",
    "end": "803240"
  },
  {
    "text": "flash to extract the the decryption key so this did this way was was a dead end",
    "start": "803240",
    "end": "808400"
  },
  {
    "text": "so we looked at the way the the the USB configuration is applied but as Benoit's",
    "start": "808400",
    "end": "813440"
  },
  {
    "text": "had previously it's also encrypted and the decryption keys are also stored inside the appliance so this was added",
    "start": "813440",
    "end": "819440"
  },
  {
    "text": "into so the the the last way of doing for us was was was with the custom",
    "start": "819440",
    "end": "826490"
  },
  {
    "text": "protocol that that's that to configure it our use uses to to configure the",
    "start": "826490",
    "end": "831800"
  },
  {
    "text": "appliance so what we did we reverse-engineer the configurator to understand the packet format and the",
    "start": "831800",
    "end": "838010"
  },
  {
    "text": "crypto scheme that is used to authenticate to come to - to",
    "start": "838010",
    "end": "843020"
  },
  {
    "text": "administrate the the security appliances that that's what I'm showing you right now so as we know I said the appliance",
    "start": "843020",
    "end": "849650"
  },
  {
    "text": "doesn't even have an IP address so there must be a way for the configurator to know how where is located the appliance",
    "start": "849650",
    "end": "858410"
  },
  {
    "text": "inside the network so basically what's the and that's the purpose of the discovery protocol so what the Tofino",
    "start": "858410",
    "end": "864710"
  },
  {
    "text": "Tofino did is that the the configurator is sending a piece of data here to two",
    "start": "864710",
    "end": "871280"
  },
  {
    "text": "ICS systems and as the appliance in standing somewhere in between the ICS systems and the configurator",
    "start": "871280",
    "end": "877490"
  },
  {
    "text": "it will receive the CD packet coming it will intercept this packet this packet contains it contains a piece of data",
    "start": "877490",
    "end": "884210"
  },
  {
    "text": "encrypted with a 3k H where H stands for uploaded and this key is are coded in",
    "start": "884210",
    "end": "890270"
  },
  {
    "text": "both the appliance from the configurator so the appliance received this packet decrypt the data and if the the data",
    "start": "890270",
    "end": "896720"
  },
  {
    "text": "inside this packet is meaningful it means that v knows knows it's being discovered and unserved",
    "start": "896720",
    "end": "902450"
  },
  {
    "text": "knowledge is the discovery packet then the configurators knows the appliance",
    "start": "902450",
    "end": "907550"
  },
  {
    "text": "instant ending is somewhere here on this network pass so is now sending an authentication packet with another piece",
    "start": "907550",
    "end": "914030"
  },
  {
    "text": "of data and proceed with the two other keys k2 and k3 those keys are not",
    "start": "914030",
    "end": "919130"
  },
  {
    "text": "outputted but shared between the appliance and the configurator so when the appliance received this packet and",
    "start": "919130",
    "end": "924620"
  },
  {
    "text": "manages to decrypt the packets its it knows it's sharing k2 and k3 with the configurator this way it authenticates",
    "start": "924620",
    "end": "931370"
  },
  {
    "text": "the configurator and so it opens an an SSH port for the photo configurator to",
    "start": "931370",
    "end": "937190"
  },
  {
    "text": "connect to it so what we did basically first we reverse-engineer the the the",
    "start": "937190",
    "end": "943520"
  },
  {
    "text": "protocol through to to understand that and we also implemented our own version",
    "start": "943520",
    "end": "948890"
  },
  {
    "text": "of the client in Python we extracted the default is k2 k3 and also the the sshd",
    "start": "948890",
    "end": "954040"
  },
  {
    "text": "to implement our one client in python and we are able to open na to connect to",
    "start": "954040",
    "end": "960530"
  },
  {
    "text": "the clients with over SSH so we got an SS root shell because on",
    "start": "960530",
    "end": "966440"
  },
  {
    "text": "the undies on your pants everything is is run in running as root it's an",
    "start": "966440",
    "end": "971600"
  },
  {
    "text": "unfortunate it's still quite common on the embedded systems so this was a major",
    "start": "971600",
    "end": "977060"
  },
  {
    "text": "step forward for us because from now on the client was not anymore a black box",
    "start": "977060",
    "end": "982250"
  },
  {
    "text": "so we understood that it was a Linux operating system running on top of a",
    "start": "982250",
    "end": "987350"
  },
  {
    "text": "PowerPC architecture and we had access to the all filesystem content the internal configuration the AP type of",
    "start": "987350",
    "end": "994400"
  },
  {
    "text": "rules and we were also able to do live debugging to understand how the all the appliance works so now we are moving to",
    "start": "994400",
    "end": "1003160"
  },
  {
    "text": "the evaluation path where we will path where will we with everything all the",
    "start": "1003160",
    "end": "1008320"
  },
  {
    "text": "all the features and to see if the the evolution the security objectives are met or not ok so now when you have you",
    "start": "1008320",
    "end": "1018760"
  },
  {
    "text": "first install Tofino appliance on your network you can use any configurator in",
    "start": "1018760",
    "end": "1024130"
  },
  {
    "text": "order to connect and configure it because by default or every appliance",
    "start": "1024130",
    "end": "1029680"
  },
  {
    "text": "are sharing the same default keys so the first thing that you you will want to do is to",
    "start": "1029680",
    "end": "1037269"
  },
  {
    "text": "restrict this access to you configurator and not the other ones this phase is",
    "start": "1037269",
    "end": "1043449"
  },
  {
    "text": "called the association phase it consists in generating new keys on the",
    "start": "1043449",
    "end": "1048459"
  },
  {
    "text": "configurator and sends them to the appliance once this association phase is",
    "start": "1048459",
    "end": "1054100"
  },
  {
    "text": "done you are the only configurator that is able to connect to the appliance",
    "start": "1054100",
    "end": "1059789"
  },
  {
    "text": "because the knowledge of k2 and k3 is mandatory in order to do the",
    "start": "1059789",
    "end": "1065440"
  },
  {
    "text": "authentication part of the protocol however your appliance can still be",
    "start": "1065440",
    "end": "1071230"
  },
  {
    "text": "discovered by other configurator because the discovery part is using the KH key which is not changed during the",
    "start": "1071230",
    "end": "1078190"
  },
  {
    "text": "association phase so we have audited the code that is doing this custom protocol",
    "start": "1078190",
    "end": "1083710"
  },
  {
    "text": "and we didn't find any vulnerability so for us it wins at the network",
    "start": "1083710",
    "end": "1089620"
  },
  {
    "text": "authentication objective of the two final easements now now what about the",
    "start": "1089620",
    "end": "1096490"
  },
  {
    "text": "Tofino upgrade mechanism it can be done using two different ways the first is to",
    "start": "1096490",
    "end": "1102010"
  },
  {
    "text": "use the configurator and the network protocol it is well designed and well",
    "start": "1102010",
    "end": "1107710"
  },
  {
    "text": "implemented and the other one is using a USB stick a usb update is in fact a zip",
    "start": "1107710",
    "end": "1114880"
  },
  {
    "text": "archive containing two different files the first is an update script and the second one is a data file containing a",
    "start": "1114880",
    "end": "1122919"
  },
  {
    "text": "Linux kernel and a file system both files are encrypted using the the AES",
    "start": "1122919",
    "end": "1129250"
  },
  {
    "text": "algorithm and the key use for encryption is shared among every appliance but at",
    "start": "1129250",
    "end": "1135669"
  },
  {
    "text": "the very beginning we didn't know these keys so we were not able to dig through it to the framer but once we get the",
    "start": "1135669",
    "end": "1143110"
  },
  {
    "text": "shell the shell and shell access on the appliance we were able to extract",
    "start": "1143110",
    "end": "1149110"
  },
  {
    "text": "stretched cut this key and then to decrypt the ephemeral but the major",
    "start": "1149110",
    "end": "1155169"
  },
  {
    "text": "issue here is that only the update script is signed and the data file is",
    "start": "1155169",
    "end": "1161110"
  },
  {
    "text": "not signed meaning that if you modify the data file the toffee-nosed system as",
    "start": "1161110",
    "end": "1167860"
  },
  {
    "text": "no way to know that an unauthorized of modification has been applied so when",
    "start": "1167860",
    "end": "1176950"
  },
  {
    "text": "you first plug you you will be stitch in order to upgrade the Tofino it decrypts and check the signature of the script",
    "start": "1176950",
    "end": "1184059"
  },
  {
    "text": "and if it is correct it takes acute the script the script then decrypt the data",
    "start": "1184059",
    "end": "1191860"
  },
  {
    "text": "file and write the Linux kernel and the file system into the Tofino flash memory",
    "start": "1191860",
    "end": "1199049"
  },
  {
    "text": "so an attacker can connect to the toughen website retrieve a valid",
    "start": "1199049",
    "end": "1204910"
  },
  {
    "text": "firmware decrypt is the data file because it has access to the key that is",
    "start": "1204910",
    "end": "1211030"
  },
  {
    "text": "shared among every appliance change the content for example to backdoor the",
    "start": "1211030",
    "end": "1216040"
  },
  {
    "text": "Linux kernel to change some binaries in the file system or whatever riri encrypt the file and then store it",
    "start": "1216040",
    "end": "1224049"
  },
  {
    "text": "in the USB key and plug it into the Tofino the trophy no won't have any way",
    "start": "1224049",
    "end": "1230230"
  },
  {
    "text": "to know that this camera has been modified so if you are an attacker and",
    "start": "1230230",
    "end": "1238240"
  },
  {
    "text": "if you have a physical access to the appliance it's game over if you are able",
    "start": "1238240",
    "end": "1244240"
  },
  {
    "text": "to plug a USB stick into the appliance it's it's over the impact of the",
    "start": "1244240",
    "end": "1250929"
  },
  {
    "text": "appliance is a full compromise and so our security objective about the future",
    "start": "1250929",
    "end": "1257230"
  },
  {
    "text": "from my signature is not met because the data file is not signed",
    "start": "1257230",
    "end": "1262710"
  },
  {
    "text": "so this bug was reported to the vendor and a CV has been assigned and it was",
    "start": "1262710",
    "end": "1268780"
  },
  {
    "text": "patched in the latest firmware now we are going to describe the file internals",
    "start": "1268780",
    "end": "1276280"
  },
  {
    "text": "of the Tofino appliance so because the underlying operating system is Linux",
    "start": "1276280",
    "end": "1281410"
  },
  {
    "text": "without any surprise the filtering is done using net filter that filter will",
    "start": "1281410",
    "end": "1287470"
  },
  {
    "text": "do the filtering using network parameters but it is also responsible",
    "start": "1287470",
    "end": "1292780"
  },
  {
    "text": "for forwarding packets for forwarding ICS packets to three user on modules",
    "start": "1292780",
    "end": "1299980"
  },
  {
    "text": "one for each photo car that is handled by the trophy no appliance those models",
    "start": "1299980",
    "end": "1305320"
  },
  {
    "text": "have the responsibility to pass analyzed and according some rules that we will",
    "start": "1305320",
    "end": "1310510"
  },
  {
    "text": "describe later to say if the packet is allowed or not to go through the",
    "start": "1310510",
    "end": "1316750"
  },
  {
    "text": "firewall okay so now I'm going to",
    "start": "1316750",
    "end": "1322450"
  },
  {
    "text": "describe a quite tricky bug that we will use in our final final attack but first",
    "start": "1322450",
    "end": "1329350"
  },
  {
    "text": "I need to detail what is happening when an animist traitor want to enforce the GPI filtering while",
    "start": "1329350",
    "end": "1336279"
  },
  {
    "text": "there is already established ICS communications let's take an example you",
    "start": "1336279",
    "end": "1342940"
  },
  {
    "text": "are an administrator you have installed a Tofino appliance on your network it is",
    "start": "1342940",
    "end": "1349059"
  },
  {
    "text": "in test mode you are in line with this configuration the rugs are saying that everything is ok so you want to switch",
    "start": "1349059",
    "end": "1356200"
  },
  {
    "text": "to operational mode to really drop bad packets but at the same time in your",
    "start": "1356200",
    "end": "1362019"
  },
  {
    "text": "company you have a Nashua is that is communicating with the PLC when the PLC",
    "start": "1362019",
    "end": "1368230"
  },
  {
    "text": "will send its response and when the administrator will push the button in order to really filter the packets the",
    "start": "1368230",
    "end": "1374639"
  },
  {
    "text": "PLC response may be dropped because it is not yet related to attract connection",
    "start": "1374639",
    "end": "1381010"
  },
  {
    "text": "and in an ICS environment availability is crucial and it must not",
    "start": "1381010",
    "end": "1386649"
  },
  {
    "text": "happen so to avoid this problem to fin or develop a workaround that allow for",
    "start": "1386649",
    "end": "1394419"
  },
  {
    "text": "30 seconds when a configuration have just been applied the arrow every ICS",
    "start": "1394419",
    "end": "1400570"
  },
  {
    "text": "responds and for that they implement a twisting kernel module a crystal net",
    "start": "1400570",
    "end": "1406600"
  },
  {
    "text": "filter module that is adding a kind of time to live parameters to firewall",
    "start": "1406600",
    "end": "1412299"
  },
  {
    "text": "rules and those rules that we have called time the rules when they are",
    "start": "1412299",
    "end": "1418600"
  },
  {
    "text": "applied the timer is started and they match packet only if the timer has not",
    "start": "1418600",
    "end": "1425110"
  },
  {
    "text": "have not expired so if we come back to our case when the PLC will send",
    "start": "1425110",
    "end": "1432129"
  },
  {
    "text": "it spoons the packet will be yellow not because it is related to attract",
    "start": "1432129",
    "end": "1437360"
  },
  {
    "text": "connection but because it is in the 30-second time frame it's a compromise between availability and security but",
    "start": "1437360",
    "end": "1447590"
  },
  {
    "text": "because it's a compromise it means that for an attacker it's a window opportunity for 30 seconds to bypass the",
    "start": "1447590",
    "end": "1456140"
  },
  {
    "text": "firewall to bypass the classic firewall so the impact is high because you are 30",
    "start": "1456140",
    "end": "1465380"
  },
  {
    "text": "seconds just after applying a configuration to bypass the classic filtering but the impact is quite low",
    "start": "1465380",
    "end": "1472010"
  },
  {
    "text": "because it hardly happens when there is a new configuration however even if you",
    "start": "1472010",
    "end": "1479600"
  },
  {
    "text": "can bypass the classic filtering the deep packet inspection still upright on your packets keep in mind this problem",
    "start": "1479600",
    "end": "1487940"
  },
  {
    "text": "because we will use it in a few slides okay so when I showed you the path or",
    "start": "1487940",
    "end": "1496280"
  },
  {
    "text": "the network packet through IP table rules to dpi modules for filtering so now we will talk about what's taught the",
    "start": "1496280",
    "end": "1502460"
  },
  {
    "text": "DPR modules are doing because that's the the real added value of those equipments and that the core of their technology so",
    "start": "1502460",
    "end": "1509600"
  },
  {
    "text": "they are doing the packet inspection at two levels the first one is a packet format so basically what they are doing",
    "start": "1509600",
    "end": "1515630"
  },
  {
    "text": "is that they are ensuring that the packets we are meant to go through the firewall respects to specifications and",
    "start": "1515630",
    "end": "1522580"
  },
  {
    "text": "well-formed if they are not they will be dropped to avoid any passing on ICS",
    "start": "1522580",
    "end": "1529760"
  },
  {
    "text": "equipments and triggering any vulnerability that's the first level the second level is content filtering what",
    "start": "1529760",
    "end": "1536510"
  },
  {
    "text": "does an Ethernet IP have a master slave model when you where the master sends",
    "start": "1536510",
    "end": "1541789"
  },
  {
    "text": "commands and expect he expects response and those comments are actions you want",
    "start": "1541789",
    "end": "1547460"
  },
  {
    "text": "to perform on the target equipments like reading memory writing memory programming and things like that so the",
    "start": "1547460",
    "end": "1552980"
  },
  {
    "text": "the the file has the ability to to restrict the set of commands that are",
    "start": "1552980",
    "end": "1558980"
  },
  {
    "text": "allowed inside the packet even though the packet format is correct so now I",
    "start": "1558980",
    "end": "1564980"
  },
  {
    "text": "will show two example of this featuring so the first one is the packet",
    "start": "1564980",
    "end": "1570540"
  },
  {
    "text": "format filtering is an example an extract from the specification and that's just an example",
    "start": "1570540",
    "end": "1575670"
  },
  {
    "text": "so the function cut number one is a command to read data from from from from",
    "start": "1575670",
    "end": "1581370"
  },
  {
    "text": "the equipment so they are one byte for for the command two bytes for the address where we want to read from and",
    "start": "1581370",
    "end": "1588090"
  },
  {
    "text": "two to two bytes for the quantity 1 theta T we want to read so the the DPM",
    "start": "1588090",
    "end": "1593550"
  },
  {
    "text": "we'll do is basically add the address and the quantity to check if there is another ananova flow and it will also",
    "start": "1593550",
    "end": "1599100"
  },
  {
    "text": "answer ensure that the quantity is below the maximum authorized by the specification so just an example there",
    "start": "1599100",
    "end": "1606180"
  },
  {
    "text": "are many many many of those kind of checking in the modules the other one",
    "start": "1606180",
    "end": "1612060"
  },
  {
    "text": "here is that the the content filtering that the restriction on the allowed commands so from the tofu new",
    "start": "1612060",
    "end": "1618600"
  },
  {
    "text": "configurator when was talk to you about to slide to go you can you can you you",
    "start": "1618600",
    "end": "1623730"
  },
  {
    "text": "have an interface when you can apply predefined profiles to say I want to respect to read-only commands readwrite",
    "start": "1623730",
    "end": "1629220"
  },
  {
    "text": "etc and you also have an advanced menu and you can cherry-pick which which commands you want to to to allow or not",
    "start": "1629220",
    "end": "1637070"
  },
  {
    "text": "so now I will describe all of the filters the three filters we have coded it starting with Ethernet IP so this is",
    "start": "1637070",
    "end": "1644130"
  },
  {
    "text": "only on one slide it will be very quick we had to make decisions regarding the time we had so if the net IP protocol is",
    "start": "1644130",
    "end": "1651720"
  },
  {
    "text": "running on top of TCP or UDP and it's conveying the control in this well",
    "start": "1651720",
    "end": "1657450"
  },
  {
    "text": "protocol se see IP messages so we found a bug here but unfortunately for us as",
    "start": "1657450",
    "end": "1663090"
  },
  {
    "text": "an attacker it's only on the on replies may a meaning from from slave to masters",
    "start": "1663090",
    "end": "1668850"
  },
  {
    "text": "because from safe to masters the modules are also doing the packet inspection so",
    "start": "1668850",
    "end": "1675000"
  },
  {
    "text": "it in fact it was an out of bone right inside in the in the DPI when it's",
    "start": "1675000",
    "end": "1680130"
  },
  {
    "text": "passing the packets but we were not able to to use it for code execution",
    "start": "1680130",
    "end": "1685350"
  },
  {
    "text": "execution or memory corruption inside the inside the filters memory we just",
    "start": "1685350",
    "end": "1693060"
  },
  {
    "text": "used it to bypass the sanity check the paddle packet sanity verification that",
    "start": "1693060",
    "end": "1698190"
  },
  {
    "text": "our data turn on the my messages so this was reported and patched by the vendor and that we didn't",
    "start": "1698190",
    "end": "1704000"
  },
  {
    "text": "ask for a Syrian issue number on this one just for you to know that we also audited this this module now we're",
    "start": "1704000",
    "end": "1712850"
  },
  {
    "text": "moving to the boost filter which is the reasons are slightly more interesting so",
    "start": "1712850",
    "end": "1718340"
  },
  {
    "text": "the modest commands or function codes are conveying inside the application",
    "start": "1718340",
    "end": "1724490"
  },
  {
    "text": "data units you have an example here on the screen so it's composed of error and",
    "start": "1724490",
    "end": "1730100"
  },
  {
    "text": "also protocol data unit which contains the function code you you're sending to",
    "start": "1730100",
    "end": "1735140"
  },
  {
    "text": "the equipment's along with the data and the format of the data depends of the function code you're sending",
    "start": "1735140",
    "end": "1740840"
  },
  {
    "text": "what's interesting to note here that the length of the protocol data unit is stored inside there so the first thing",
    "start": "1740840",
    "end": "1747770"
  },
  {
    "text": "we noticed is that the the data flow allows packets that contain multiples",
    "start": "1747770",
    "end": "1754630"
  },
  {
    "text": "application that I units inside the network frame even though this with not explicit explicitly defined inside the",
    "start": "1754630",
    "end": "1761450"
  },
  {
    "text": "mode boost angle and it's really really interesting so what's the model the",
    "start": "1761450",
    "end": "1766760"
  },
  {
    "text": "filter is doing for each data application that a unit so if check you will check whether the function code is",
    "start": "1766760",
    "end": "1773570"
  },
  {
    "text": "autorized regarding the the profiles that are applied and also that the sanity check are correct so all the",
    "start": "1773570",
    "end": "1780050"
  },
  {
    "text": "sanity checks on the the first will ensure that the application that I unit lens is is in below the my above the",
    "start": "1780050",
    "end": "1790190"
  },
  {
    "text": "minimum and below the maximum authorized by the by the specification 7 and 2048",
    "start": "1790190",
    "end": "1796010"
  },
  {
    "text": "bytes and they will also also do sanity check under that the data that are",
    "start": "1796010",
    "end": "1801830"
  },
  {
    "text": "specific to the function code but there they missed here's very important thing they didn't check that the lens stored",
    "start": "1801830",
    "end": "1807950"
  },
  {
    "text": "inside the header is below the maximum authorized by the standard 2048 bytes",
    "start": "1807950",
    "end": "1813140"
  },
  {
    "text": "and that's very important so now let's see what's happening when when when the",
    "start": "1813140",
    "end": "1820370"
  },
  {
    "text": "filter is is violating a packet which contains multi multiple data units so it",
    "start": "1820370",
    "end": "1825710"
  },
  {
    "text": "will first it's done in the loop you have the pseudo code out of the loop implemented inside the filter here so",
    "start": "1825710",
    "end": "1832420"
  },
  {
    "text": "the filter is first checking that the the the application the technique is correct if it's correct it will use the",
    "start": "1832420",
    "end": "1839920"
  },
  {
    "text": "lens stored inside the error to compute the offset of the next data unit and then it will do the check again on the",
    "start": "1839920",
    "end": "1846520"
  },
  {
    "text": "next one and it will do it in a loop and at the end of the loop if all the data needs are correct the frame is considered valid and can go",
    "start": "1846520",
    "end": "1853809"
  },
  {
    "text": "through the firewall but what happens in",
    "start": "1853809",
    "end": "1859540"
  },
  {
    "text": "case of an invalid lens is convene inside the first application that I made here so the first that I mean it is",
    "start": "1859540",
    "end": "1866740"
  },
  {
    "text": "checked so he has to be correct you go through the firewall then it will the filter will use the incorrect lens from",
    "start": "1866740",
    "end": "1873970"
  },
  {
    "text": "the header to compute the offset and the funny thing here is that you will see that something is going wrong so it will",
    "start": "1873970",
    "end": "1880720"
  },
  {
    "text": "exit the loop and at the end of the loop it will do another check and here is",
    "start": "1880720",
    "end": "1887260"
  },
  {
    "text": "there is a logical issue because if even if if I even if the size incorrect it",
    "start": "1887260",
    "end": "1893620"
  },
  {
    "text": "returns frame valid instead of frame invalid which means that we'll we'll stop the verification and we allow the",
    "start": "1893620",
    "end": "1899650"
  },
  {
    "text": "frame to go through the firewall and that's that's that's a major issue but",
    "start": "1899650",
    "end": "1905830"
  },
  {
    "text": "still we have to to have the first application that you need that is correct",
    "start": "1905830",
    "end": "1910870"
  },
  {
    "text": "and for that we in our test we chose the function code number seven here because it's a one one only one by PU and it's",
    "start": "1910870",
    "end": "1918460"
  },
  {
    "text": "in all predefined predefined list of",
    "start": "1918460",
    "end": "1925030"
  },
  {
    "text": "allow L allowed comments so we and as we can see on this packet here if if the",
    "start": "1925030",
    "end": "1930520"
  },
  {
    "text": "first return it is correct with the packet containing aquatred attack and we",
    "start": "1930520",
    "end": "1935559"
  },
  {
    "text": "can we can go through the firewall so that that's as I said a major issue",
    "start": "1935559",
    "end": "1942730"
  },
  {
    "text": "because it is enough a universal bypass of the Modbus filter because this way with and we send the packets contain by",
    "start": "1942730",
    "end": "1949630"
  },
  {
    "text": "length and also arbitrary data across the firewall and you can have an important impact of the ICS system and",
    "start": "1949630",
    "end": "1955090"
  },
  {
    "text": "it's exactly the kind of thing the the file is is is meant to protect protected",
    "start": "1955090",
    "end": "1960490"
  },
  {
    "text": "protect us against so the security objective of the model filters",
    "start": "1960490",
    "end": "1965570"
  },
  {
    "text": "you're adding conformity analysis objective is not meant and this this this book was assigned a CD and was was",
    "start": "1965570",
    "end": "1973639"
  },
  {
    "text": "was reported to to the to the vendor",
    "start": "1973639",
    "end": "1977919"
  },
  {
    "text": "okay now we are going to describe the OPC classic filter which is filtering",
    "start": "1978999",
    "end": "1984259"
  },
  {
    "text": "OPC protocol this protocol is based is based on Microsoft come they come technology and has a specificity to use",
    "start": "1984259",
    "end": "1992029"
  },
  {
    "text": "multiple TCP connection using dynamic pots if you have a look on the diagram",
    "start": "1992029",
    "end": "1997970"
  },
  {
    "text": "below so when the client open a TCP connection on the static pot one three",
    "start": "1997970",
    "end": "2003070"
  },
  {
    "text": "five after a while the server will ask the client to use a new TCP connection",
    "start": "2003070",
    "end": "2008440"
  },
  {
    "text": "and this new TCP connection will be done on a port that is inside the application",
    "start": "2008440",
    "end": "2016479"
  },
  {
    "text": "layer of the packets so when the clients receive this packet it opens this new",
    "start": "2016479",
    "end": "2021849"
  },
  {
    "text": "connection but of course this new TCP connection has to be allowed by the firewall and you can't guess the dynamic",
    "start": "2021849",
    "end": "2031299"
  },
  {
    "text": "TCP port so it is a responsibility of the OPC filtering to pass this kind of",
    "start": "2031299",
    "end": "2037090"
  },
  {
    "text": "packets and to dynamically add this rule to allow the new TCP connection it's",
    "start": "2037090",
    "end": "2042549"
  },
  {
    "text": "exactly what is done on FTP with FTP data and connection but there is a bug",
    "start": "2042549",
    "end": "2049648"
  },
  {
    "text": "when the OPC filter is passing the packet it is not checking the state",
    "start": "2049649",
    "end": "2057700"
  },
  {
    "text": "machine meaning that if you're the client you send a request and you can't send a response to your request the OPC",
    "start": "2057700",
    "end": "2066730"
  },
  {
    "text": "filtering is not checking if the response is coming from the PLC so you can send the request and the response",
    "start": "2066730",
    "end": "2072190"
  },
  {
    "text": "and the consequence will be that a new",
    "start": "2072190",
    "end": "2077260"
  },
  {
    "text": "filtering rule will be added allowing a connection from the PLC through the",
    "start": "2077260",
    "end": "2083349"
  },
  {
    "text": "attacker which is not the most interesting for an attacker so the impact is quite close but what is",
    "start": "2083349",
    "end": "2089648"
  },
  {
    "text": "important is that you can as an attacker dynamically add a rule whenever you want",
    "start": "2089649",
    "end": "2097210"
  },
  {
    "text": "and it will have some very interesting impact in in the following slides another vulnerability",
    "start": "2097210",
    "end": "2104500"
  },
  {
    "text": "that we are fun on the opposite field is the way that the filter is handling",
    "start": "2104500",
    "end": "2109780"
  },
  {
    "text": "small packets I hope I see either is is composed of 19",
    "start": "2109780",
    "end": "2115569"
  },
  {
    "text": "bytes and if the filter received a packet smaller than 19 bytes it is",
    "start": "2115569",
    "end": "2122589"
  },
  {
    "text": "considered it considers this packet as invalid because too small but there is a",
    "start": "2122589",
    "end": "2130930"
  },
  {
    "text": "logical flow as you can see on the right side of the slide in the episode of code",
    "start": "2130930",
    "end": "2137079"
  },
  {
    "text": "the return value is set to 1 and the passing is done only if the size is",
    "start": "2137079",
    "end": "2144310"
  },
  {
    "text": "greater than 19 and if it is not the case the packet is not passed but the",
    "start": "2144310",
    "end": "2149980"
  },
  {
    "text": "return value is not changed you are never going to the else branch so this invalid packet will be allowed",
    "start": "2149980",
    "end": "2157420"
  },
  {
    "text": "to go through the file and unfortunately OPC protocol is on top of TCP meaning",
    "start": "2157420",
    "end": "2164290"
  },
  {
    "text": "that you can use TCP fragmentation you can take a big bad packet split it in",
    "start": "2164290",
    "end": "2170589"
  },
  {
    "text": "very small packets send every small packet to your target the OPC filtering",
    "start": "2170589",
    "end": "2177069"
  },
  {
    "text": "will allow or this small packet to go through and when the target will receive",
    "start": "2177069",
    "end": "2182079"
  },
  {
    "text": "all the small pocket it will reel some everything to get the big bad packet so using TCP fragmentation you are able to",
    "start": "2182079",
    "end": "2189730"
  },
  {
    "text": "fully bypass the de packet inspection of OPC protocol and so the OPC protocol",
    "start": "2189730",
    "end": "2196810"
  },
  {
    "text": "conformity is not met because of this flow now we have seen many low impact or",
    "start": "2196810",
    "end": "2206230"
  },
  {
    "text": "low potential et bugs we will try to put it together another in order to get a higher impact on the firewall but first",
    "start": "2206230",
    "end": "2214569"
  },
  {
    "text": "I will just do a brief summary of findings that we will combine the first",
    "start": "2214569",
    "end": "2220780"
  },
  {
    "text": "one is the time of inner abilities that allow you to bypass the classic",
    "start": "2220780",
    "end": "2225790"
  },
  {
    "text": "filtering for 30 seconds but only when a configuration is applied the other one",
    "start": "2225790",
    "end": "2231849"
  },
  {
    "text": "is the capability for an attacker to dynamically add a firewall and the last",
    "start": "2231849",
    "end": "2237940"
  },
  {
    "text": "one is the one that I have just described is a capability to bypass opacity packet inspection by using TCP",
    "start": "2237940",
    "end": "2245920"
  },
  {
    "text": "fragmentation in addition to this burg the Tofino developer we are not aware of",
    "start": "2245920",
    "end": "2253450"
  },
  {
    "text": "a very specific netfilter behavior when you add a rule in that filter this rule",
    "start": "2253450",
    "end": "2260230"
  },
  {
    "text": "is added to a set of existing rule meaning that if you add a rule",
    "start": "2260230",
    "end": "2267930"
  },
  {
    "text": "everywhere will be applied again including time the rule and when a time",
    "start": "2267930",
    "end": "2273940"
  },
  {
    "text": "rule is applied the timer is reset so the potentiality of the time rule",
    "start": "2273940",
    "end": "2280210"
  },
  {
    "text": "vulnerability was low but in fact because of this very specific netfilter",
    "start": "2280210",
    "end": "2286150"
  },
  {
    "text": "behavior it happens if every time you add a rule so whenever our attacker",
    "start": "2286150",
    "end": "2292900"
  },
  {
    "text": "wants but there is still the deep packet",
    "start": "2292900",
    "end": "2299950"
  },
  {
    "text": "inspection inspection that is done on this on this packet but you can bypass",
    "start": "2299950",
    "end": "2306370"
  },
  {
    "text": "it using TCP fragmentation so in this slide I will describe the different",
    "start": "2306370",
    "end": "2312220"
  },
  {
    "text": "steps in order to run a complete attack for bypassing filtering of the Tofino",
    "start": "2312220",
    "end": "2320800"
  },
  {
    "text": "file we use a Linux target we will open",
    "start": "2320800",
    "end": "2326230"
  },
  {
    "text": "the net service this telnet service was not allowed by the firewall the only",
    "start": "2326230",
    "end": "2331780"
  },
  {
    "text": "thing that was allowed between the attacker and the target was the opposite protocol so you first have to open an",
    "start": "2331780",
    "end": "2340510"
  },
  {
    "text": "OPC connection on a static port 1 3 5 then send a request and the response to",
    "start": "2340510",
    "end": "2347920"
  },
  {
    "text": "your target string telling the targets that you want to use a new TCP",
    "start": "2347920",
    "end": "2352960"
  },
  {
    "text": "connection on a new dynamic port when the OPC filtering will pass this packet",
    "start": "2352960",
    "end": "2359560"
  },
  {
    "text": "it will add the rule and the consequence will be that every",
    "start": "2359560",
    "end": "2365980"
  },
  {
    "text": "rules will be applied again including time rules so the timer will be reset so",
    "start": "2365980",
    "end": "2371140"
  },
  {
    "text": "you have a 30 seconds opportunity to bypass the classic filtering and to open",
    "start": "2371140",
    "end": "2376900"
  },
  {
    "text": "a TCP connection on your telnet service using a soft spot matching the OPC",
    "start": "2376900",
    "end": "2382869"
  },
  {
    "text": "service just to be interpreted as an ICS response and finally Center fragmented",
    "start": "2382869",
    "end": "2389109"
  },
  {
    "text": "data to use the certain net service in",
    "start": "2389109",
    "end": "2395950"
  },
  {
    "text": "conclusion if OPC filter is enabled between two device the world filtering",
    "start": "2395950",
    "end": "2404470"
  },
  {
    "text": "the word Tofino filtering can be bypassed this was patch in the latest",
    "start": "2404470",
    "end": "2410650"
  },
  {
    "text": "firmware version and CV has been assigned to whisper okay so we've been",
    "start": "2410650",
    "end": "2418900"
  },
  {
    "text": "through all the security objectives of the equipment so it's now time for us to",
    "start": "2418900",
    "end": "2424480"
  },
  {
    "text": "conclude regarding this evaluation so what we can say that before trusting any",
    "start": "2424480",
    "end": "2431260"
  },
  {
    "text": "security projects we have to perform a deep evaluation of the product and and",
    "start": "2431260",
    "end": "2437470"
  },
  {
    "text": "following a no and recognize referential or guidelines is a very good idea for",
    "start": "2437470",
    "end": "2444369"
  },
  {
    "text": "example and when I were not IC specialists but following this this and NSSI guidelines at a salat what we can",
    "start": "2444369",
    "end": "2454570"
  },
  {
    "text": "say regarding the TOEFL okay so there are good points they use open source and reliable components the our design is",
    "start": "2454570",
    "end": "2460960"
  },
  {
    "text": "quite module which means that when you have a vulnerability inside a dpi filter",
    "start": "2460960",
    "end": "2466450"
  },
  {
    "text": "you can patch it quite easily without costing modification to your software architecture the most of the",
    "start": "2466450",
    "end": "2473680"
  },
  {
    "text": "vulnerabilities are implanted in implementation issues that the Modbus",
    "start": "2473680",
    "end": "2479920"
  },
  {
    "text": "bug here is a very good example of that because instead of our tongue if the patch to return one by region 0 the the",
    "start": "2479920",
    "end": "2485859"
  },
  {
    "text": "bag is not present anymore and what's also very interesting is that the very good way reaction of the vendor",
    "start": "2485859",
    "end": "2492580"
  },
  {
    "text": "regarding a responsible disclosure because we had the very constructive dialogue with they were very responsive they did not",
    "start": "2492580",
    "end": "2499800"
  },
  {
    "text": "try it might not do impact of the bugs and they were very very very very good",
    "start": "2499800",
    "end": "2505340"
  },
  {
    "text": "there is still room for improvement though because as we we've seen that",
    "start": "2505340",
    "end": "2511110"
  },
  {
    "text": "everything is on route and I think in still the case so it see there is a still lack of uh turning of the of the",
    "start": "2511110",
    "end": "2518400"
  },
  {
    "text": "operating system so now we've done the the evaluation so the we know the",
    "start": "2518400",
    "end": "2524160"
  },
  {
    "text": "limitations of the products and we we we could we could deploy it safely after",
    "start": "2524160",
    "end": "2529320"
  },
  {
    "text": "applying the patches but if we take",
    "start": "2529320",
    "end": "2534330"
  },
  {
    "text": "another step back and think about what are could be two takeaways of this",
    "start": "2534330",
    "end": "2539430"
  },
  {
    "text": "presentation so the first one is that architecture design risk analysis and",
    "start": "2539430",
    "end": "2547460"
  },
  {
    "text": "those things are very are crucial because without those you will never end",
    "start": "2547460",
    "end": "2552630"
  },
  {
    "text": "up having secure products but still you do have to check the implementation this",
    "start": "2552630",
    "end": "2559080"
  },
  {
    "text": "big because minor bugs can break your security down and that's things that do Noah and I see every day in our internal",
    "start": "2559080",
    "end": "2566520"
  },
  {
    "text": "evaluations and the the good way for for checking is implementation is doing a",
    "start": "2566520",
    "end": "2573180"
  },
  {
    "text": "deep evolution of the polish which which means you we have to spend time on it because that's the only way for forever",
    "start": "2573180",
    "end": "2580770"
  },
  {
    "text": "thoughts like us to to find the treaty back and everything about the time rule time of nobility and the Christian",
    "start": "2580770",
    "end": "2587970"
  },
  {
    "text": "kummel model this one was a real tricky and finally have to say that most",
    "start": "2587970",
    "end": "2593570"
  },
  {
    "text": "interesting attacks usually come from the combination of multiple bugs that if",
    "start": "2593570",
    "end": "2599700"
  },
  {
    "text": "they are taken separately they will they would seem to have very low impacts but",
    "start": "2599700",
    "end": "2604890"
  },
  {
    "text": "when you put all them together and you chain them you end up having a very",
    "start": "2604890",
    "end": "2610560"
  },
  {
    "text": "significant impact and very interesting attacks and the obvious here the OPC",
    "start": "2610560",
    "end": "2615750"
  },
  {
    "text": "filter box below I've presented you is very very good example so now now that's",
    "start": "2615750",
    "end": "2624300"
  },
  {
    "text": "that's at the end of this presentation we want to thank our colleagues at Ibis for that",
    "start": "2624300",
    "end": "2629980"
  },
  {
    "text": "very supports we want also to thank the vendor because they were very positive",
    "start": "2629980",
    "end": "2635770"
  },
  {
    "text": "about us speaking here at blackhat and we know it's not always the case and",
    "start": "2635770",
    "end": "2641339"
  },
  {
    "text": "of course thank you very much for listening to this plantation and we sincerely hope that you enjoyed it thank",
    "start": "2641339",
    "end": "2648670"
  },
  {
    "text": "you very much [Applause]",
    "start": "2648670",
    "end": "2658030"
  }
]