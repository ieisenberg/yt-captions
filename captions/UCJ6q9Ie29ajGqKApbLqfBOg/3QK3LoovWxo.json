[
  {
    "start": "0",
    "end": "38000"
  },
  {
    "text": "well good morning everybody and thank you very much for coming out to our talk today we're going to be presenting breaking access controls with ble key",
    "start": "240",
    "end": "8679"
  },
  {
    "text": "and just a quick synopsis of what we're going to talk about is that most access controls really suck uh a lot of the",
    "start": "8679",
    "end": "15599"
  },
  {
    "text": "systems used for gaining access to buildings card readers fobs they're using very old technology clear text",
    "start": "15599",
    "end": "23199"
  },
  {
    "text": "protocols and uh you still find them everywhere even in modern buildings and",
    "start": "23199",
    "end": "28400"
  },
  {
    "text": "we realized this is an old protocol that no one's really looked at in a lot in a while it would be pretty easy to exploit",
    "start": "28400",
    "end": "33840"
  },
  {
    "text": "with Modern Hardware so we decided to build something and what we're going to do is",
    "start": "33840",
    "end": "41600"
  },
  {
    "start": "38000",
    "end": "65000"
  },
  {
    "text": "tell you about the tool that we built b key but before that we're going to explain sort of the state of RFID access",
    "start": "41600",
    "end": "50160"
  },
  {
    "text": "controls how we use that knowledge to build the tool how the tool can be used to pull off some physical attacks and",
    "start": "50160",
    "end": "57960"
  },
  {
    "text": "how you can prevent these attacks and help your company or uh someone you're Contracting for deal with uh preventing",
    "start": "57960",
    "end": "64360"
  },
  {
    "text": "this type of thing so a little bit about us uh my name is Eric evanchick I'm an embedded",
    "start": "64360",
    "end": "70520"
  },
  {
    "start": "65000",
    "end": "101000"
  },
  {
    "text": "systems architect at a new automotive company called Faraday future uh come from Toronto Canada along with my",
    "start": "70520",
    "end": "77400"
  },
  {
    "text": "partner here Mark thanks Eric okay I'm Mark bagio uh I'm a managing principal",
    "start": "77400",
    "end": "83520"
  },
  {
    "text": "consultant with a company out of the States called Optive we're from Canada though uh and uh my team does Tack and",
    "start": "83520",
    "end": "90400"
  },
  {
    "text": "penetration work so we do Network penetration uh social engineering and of",
    "start": "90400",
    "end": "96600"
  },
  {
    "text": "course uh physical audits physical penetration as well so a little bit",
    "start": "96600",
    "end": "102159"
  },
  {
    "start": "101000",
    "end": "140000"
  },
  {
    "text": "about why uh or how this talk came about uh what you see up here is a big Bank in",
    "start": "102159",
    "end": "108399"
  },
  {
    "text": "Canada and um also a Refinery uh these",
    "start": "108399",
    "end": "113960"
  },
  {
    "text": "are two places that uh you'll find controls like these that that control access or or are supposed to properly",
    "start": "113960",
    "end": "120000"
  },
  {
    "text": "control access now um just last month I was here in Rotterdam I was at another",
    "start": "120000",
    "end": "125640"
  },
  {
    "text": "big company that that used these controls uh I've been to Asia all across Asia you see these controls there as",
    "start": "125640",
    "end": "132120"
  },
  {
    "text": "well and of course all across North America so um they all use these really",
    "start": "132120",
    "end": "137560"
  },
  {
    "text": "vulnerable access controls and here you see Eric at actually Pearson International Airport",
    "start": "137560",
    "end": "144040"
  },
  {
    "start": "140000",
    "end": "197000"
  },
  {
    "text": "in Toronto uh with a rebadged hid uh access control system now were picking",
    "start": "144040",
    "end": "150200"
  },
  {
    "text": "on hid but they're the dominant player in the marketplace uh as you see a lot of other companies will will Rebrand",
    "start": "150200",
    "end": "156800"
  },
  {
    "text": "their products uh white label them uh but there's also other other uh",
    "start": "156800",
    "end": "161840"
  },
  {
    "text": "manufacturers that use the same protocol uh that that we're going to be discussing",
    "start": "161840",
    "end": "167959"
  },
  {
    "text": "today uh so we decided to make the device because you know no matter where I went customers were very surprised",
    "start": "167959",
    "end": "174599"
  },
  {
    "text": "when I said yeah these don't work right basically this card I can clone it",
    "start": "174599",
    "end": "180519"
  },
  {
    "text": "uh you know contrl C control V basically with a $30 cloner from off of eBay from",
    "start": "180519",
    "end": "187319"
  },
  {
    "text": "Asia uh AliExpress is usually the place where where we get those ones uh so",
    "start": "187319",
    "end": "194360"
  },
  {
    "text": "first I want to actually tell you a little bit more about how access control systems work so here's a typical hid uh",
    "start": "194360",
    "end": "202360"
  },
  {
    "start": "197000",
    "end": "245000"
  },
  {
    "text": "reader H and uh first you have the reader it sits on the wall and uh it",
    "start": "202360",
    "end": "207560"
  },
  {
    "text": "sends out RF and the uh before there's a card present uh you have nothing so uh",
    "start": "207560",
    "end": "215319"
  },
  {
    "text": "the card reader is a bit lonely it's got no cards so uh when we introduce a card",
    "start": "215319",
    "end": "222000"
  },
  {
    "text": "to the mix the card reader energizes the card and then the card sends out a",
    "start": "222000",
    "end": "228400"
  },
  {
    "text": "bitstream uh that the reader uh reads picks up and uh is quite happy about so",
    "start": "228400",
    "end": "237319"
  },
  {
    "text": "now that the reader has the data it has to do something with this data and",
    "start": "237319",
    "end": "242560"
  },
  {
    "text": "here's what we're attacking today the reader sends the data to a",
    "start": "242560",
    "end": "249079"
  },
  {
    "start": "245000",
    "end": "258000"
  },
  {
    "text": "backend or Upstream controller uh and and this is the part that is is weaned and uh this is the",
    "start": "249079",
    "end": "256639"
  },
  {
    "text": "part that we exploit and this is what we're interested in today so uh wegan is in clear text it's",
    "start": "256639",
    "end": "265720"
  },
  {
    "text": "been around for decades and I mean since the Apollo 11 era since we put a man on",
    "start": "265720",
    "end": "270960"
  },
  {
    "text": "the moon we've been using this protocol uh we'll go more into the actual protocol a little bit later uh",
    "start": "270960",
    "end": "277360"
  },
  {
    "start": "277000",
    "end": "289000"
  },
  {
    "text": "first I'm going to let uh actually first this is the whole",
    "start": "277360",
    "end": "283960"
  },
  {
    "text": "uh the whole system kind of in one slide just in case uh I went too fast for you there uh first and now I'm going to let",
    "start": "283960",
    "end": "290600"
  },
  {
    "start": "289000",
    "end": "459000"
  },
  {
    "text": "Eric explain a little bit more about uh the different reader Technologies over the year and how they've evolved and how",
    "start": "290600",
    "end": "297240"
  },
  {
    "text": "they all still pretty much use weekened okay thanks uh so we showed there's",
    "start": "297240",
    "end": "302639"
  },
  {
    "text": "three main parts of these systems you have the reader which sits in the middle of a card and a Upstream controller so",
    "start": "302639",
    "end": "311199"
  },
  {
    "text": "there's different things that you can attack here right you can attack the communication between the card and the reader and the reader and the Upstream",
    "start": "311199",
    "end": "316919"
  },
  {
    "text": "controller so we're just going to talk about uh the readers that have been used and the cards that have been used and",
    "start": "316919",
    "end": "322960"
  },
  {
    "text": "what's bad about them so hid procs is the Legacy uh Legacy technology but",
    "start": "322960",
    "end": "330639"
  },
  {
    "text": "you'll still find it all over the place again this exact reader with a different badge on it was at International Airport",
    "start": "330639",
    "end": "338440"
  },
  {
    "text": "uh you'll see the one on the left all over the place as well there's also smaller versions of these now they're",
    "start": "338440",
    "end": "344759"
  },
  {
    "text": "very very cheap which makes them quite popular they're about 20 years old",
    "start": "344759",
    "end": "350560"
  },
  {
    "text": "they're resold by other companies so it might not say hiid but it is and",
    "start": "350560",
    "end": "356560"
  },
  {
    "text": "somebody in this room probably has one of these cards in their pocket they're just so prevalent for not only offices",
    "start": "356560",
    "end": "362440"
  },
  {
    "text": "but apartment access and uh really anything you can imagine you're trying",
    "start": "362440",
    "end": "368000"
  },
  {
    "text": "to lock down uh these are so easy to write that you can buy a $30 tool with",
    "start": "368000",
    "end": "374240"
  },
  {
    "text": "two buttons on it one says copy so you hold this tool up to a card and you hit the copy button it beeps you then take a",
    "start": "374240",
    "end": "381360"
  },
  {
    "text": "writable card and hold the tool up to it and hit the paste button and then you have cloned a card it's uh it's very",
    "start": "381360",
    "end": "388599"
  },
  {
    "text": "easy the cards they only have 44 bits of data on them uh and whenever they send this",
    "start": "388599",
    "end": "396479"
  },
  {
    "text": "across to the reader uh there's only two supported formats for sending it up to",
    "start": "396479",
    "end": "401840"
  },
  {
    "text": "the the Upstream door controller those formats are wean which is the most prevalent one and another clear text",
    "start": "401840",
    "end": "408560"
  },
  {
    "text": "protocol called clock and data it's just a different way of putting the same data on two wires uh inside the reader",
    "start": "408560",
    "end": "415080"
  },
  {
    "text": "there's actually just different terminal blocks you plug wires into to choose which protocol",
    "start": "415080",
    "end": "420240"
  },
  {
    "text": "so it's always clear text there's there's nothing good going on here security wise some of these have a two-",
    "start": "420240",
    "end": "427560"
  },
  {
    "text": "Factor authentication you're looking at the pin pad here and thinking well this is better because now I need to know",
    "start": "427560",
    "end": "433240"
  },
  {
    "text": "both the pin and have the card that sounds good the only problem is that the",
    "start": "433240",
    "end": "438280"
  },
  {
    "text": "way that this works is when you push a button it just sends that number over the clear text wegan uh line so if",
    "start": "438280",
    "end": "445080"
  },
  {
    "text": "you're connected between the reader and the door controller you're going to be able to get that data anyway so yes it",
    "start": "445080",
    "end": "451080"
  },
  {
    "text": "is two Factor but it's it's very weak so lots of problems with hid procs uh just",
    "start": "451080",
    "end": "458000"
  },
  {
    "text": "everything's unencrypted so the next step was hid I class and this did in",
    "start": "458000",
    "end": "464479"
  },
  {
    "start": "459000",
    "end": "551000"
  },
  {
    "text": "introduce a form of encryption it used desks and the encryption is very broken",
    "start": "464479",
    "end": "470440"
  },
  {
    "text": "the reason being that the way that hid did this was they encrypted the data on",
    "start": "470440",
    "end": "475560"
  },
  {
    "text": "the cards and then they used a key a symmetric key inside the read to decrypt that value so first off all the data",
    "start": "475560",
    "end": "483400"
  },
  {
    "text": "sent over those wean lines to the controller Upstream it's still clear text there's no encryption there it's",
    "start": "483400",
    "end": "489080"
  },
  {
    "text": "just between the card and the reader the second problem is that the key they used",
    "start": "489080",
    "end": "494840"
  },
  {
    "text": "was globally the same for all of the readers they sold and back in",
    "start": "494840",
    "end": "500280"
  },
  {
    "text": "2010 uh someone by the name of milosc managed to recover that symmetric Key by",
    "start": "500280",
    "end": "505680"
  },
  {
    "text": "dumping the firmware out of a reader and of course once he had the symmetric key out of the reader you could then create",
    "start": "505680",
    "end": "512039"
  },
  {
    "text": "keys or sorry create cards that look like valid cards even though they were",
    "start": "512039",
    "end": "517279"
  },
  {
    "text": "not uh there is a feature called iclass Elite which means you pay more money for",
    "start": "517279",
    "end": "523039"
  },
  {
    "text": "it and you get a unique key to your site H ID manages all of this for you you",
    "start": "523039",
    "end": "529240"
  },
  {
    "text": "can't really have any visibility into that but still on that back end between the reader and the Upstream controller",
    "start": "529240",
    "end": "536440"
  },
  {
    "text": "there's still no security uh uh so really I mean this",
    "start": "536440",
    "end": "541600"
  },
  {
    "text": "seemed good uh when it came out but unfortunately they're still using these",
    "start": "541600",
    "end": "547160"
  },
  {
    "text": "terms like enhanced security Mutual authentication very encryption today in 2015 on their website and uh it's just",
    "start": "547160",
    "end": "555320"
  },
  {
    "start": "551000",
    "end": "694000"
  },
  {
    "text": "not true anymore like it's it's been broken for for a good number of years uh so this brings us to iclass se which is",
    "start": "555320",
    "end": "562320"
  },
  {
    "text": "the newest thing that you can buy from hid today and it still does wean and it",
    "start": "562320",
    "end": "568600"
  },
  {
    "text": "still does encrypted weekend all these years later but it supports a new",
    "start": "568600",
    "end": "574480"
  },
  {
    "text": "Upstream protocol with the help of some additional Hardware called open supervised device protocol or",
    "start": "574480",
    "end": "581720"
  },
  {
    "text": "osdp osdp is a uh two-way communication",
    "start": "581720",
    "end": "586920"
  },
  {
    "text": "so it's based on rs485 and it allows not only the reader to talk to the Upstream controller but",
    "start": "586920",
    "end": "592680"
  },
  {
    "text": "also the Upstream controller to talk to the reader and that gives you just a lot more things that you can do in terms of",
    "start": "592680",
    "end": "598440"
  },
  {
    "text": "securing that exchange so they there is a AES uh protocol or a way of using AES",
    "start": "598440",
    "end": "606519"
  },
  {
    "text": "over osdp called secure Channel protocol and if all of these things are implemented that will give you a secured",
    "start": "606519",
    "end": "614000"
  },
  {
    "text": "uh communication from the reader to the Upstream controller one of the big issues though is that we haven't been",
    "start": "614000",
    "end": "620600"
  },
  {
    "text": "able to actually buy any of the hardware that does this because it doesn't appear to be available yet so there are better",
    "start": "620600",
    "end": "628120"
  },
  {
    "text": "Solutions coming but uh I was on the phone with hid about a month ago and they admitted that only one manufacturer",
    "start": "628120",
    "end": "634440"
  },
  {
    "text": "actually makes a door controller that speaks the protocol and uh so you're not going to see a very widespread adoption",
    "start": "634440",
    "end": "640880"
  },
  {
    "text": "of this especially when buildings are usually more than uh you know decades old right and this reader has another",
    "start": "640880",
    "end": "648760"
  },
  {
    "text": "issue which is in very small font uh at the bottom it says multiclass and this means that this",
    "start": "648760",
    "end": "655079"
  },
  {
    "text": "reader will by default out of the box read any card technology so even if somebody's using a much more",
    "start": "655079",
    "end": "663000"
  },
  {
    "text": "secure uh iclass SE card they can still uh be compromised by somebody coming",
    "start": "663000",
    "end": "670000"
  },
  {
    "text": "along with a procs card which is the old technology that's really easy to read and write no encryption putting the",
    "start": "670000",
    "end": "676959"
  },
  {
    "text": "right stream of bits on it and then this reader will just assume it's a valid card because it's designed to work be",
    "start": "676959",
    "end": "682440"
  },
  {
    "text": "backwards compatible with all these old old Technologies so we we hope this is a",
    "start": "682440",
    "end": "689320"
  },
  {
    "text": "more secure solution but we haven't actually been able to look at it too much because it's hard to get your hands",
    "start": "689320",
    "end": "694800"
  },
  {
    "start": "694000",
    "end": "733000"
  },
  {
    "text": "on so does anybody use these readers in their office or to get into a building",
    "start": "694800",
    "end": "700880"
  },
  {
    "text": "apartment there's probably a couple they're very very popular in the US they're somewhat popular here this",
    "start": "700880",
    "end": "706800"
  },
  {
    "text": "building appears to have uh the iclass readers on some of the doors it looks like a rebranded iclass RW 300 which can",
    "start": "706800",
    "end": "714079"
  },
  {
    "text": "actually be turned into a writer as well so they're all over the place and and pretty prevalent",
    "start": "714079",
    "end": "719839"
  },
  {
    "text": "um but really what we're talking about is the back end between that reader and the Upstream Upstream controller and so",
    "start": "719839",
    "end": "726680"
  },
  {
    "text": "Mark's going to take it from here to explain how that protocol Works in detail and how we can exploit it thanks",
    "start": "726680",
    "end": "733199"
  },
  {
    "start": "733000",
    "end": "892000"
  },
  {
    "text": "Eric so John R wegan discovered a a wire that was embedded into cards and and",
    "start": "733199",
    "end": "740199"
  },
  {
    "text": "these cards were called wegan cards uh the cards are very similar to Magnetic",
    "start": "740199",
    "end": "745560"
  },
  {
    "text": "stripe cards but they're more durable because the wire was either embedded if",
    "start": "745560",
    "end": "751240"
  },
  {
    "text": "there was a one in in the data stream or or there was a lack of of wire for a zero so it was a a series of wires and",
    "start": "751240",
    "end": "758720"
  },
  {
    "text": "as you pulled the card through a reader you could get the data stream of ones and zeros now uh that's that's wean wire",
    "start": "758720",
    "end": "767120"
  },
  {
    "text": "but the protocol that was used to transmit the data was also called the wean protocol and so that's where we get",
    "start": "767120",
    "end": "773880"
  },
  {
    "text": "uh the protocol name but also um the limitation on the number of bits that",
    "start": "773880",
    "end": "780240"
  },
  {
    "text": "that we see on the cards today 44 bits which uh isn't very many and and all that's the entire",
    "start": "780240",
    "end": "788399"
  },
  {
    "text": "authentication control application is stored in those 44 bits of card data so uh it was patented",
    "start": "788399",
    "end": "796079"
  },
  {
    "text": "in 1974 and uh this is where we see you know the the cycle of a vicious cycle of",
    "start": "796079",
    "end": "803120"
  },
  {
    "text": "backwards compatibility people it was it was put into the product so people used it uh people were using it so then",
    "start": "803120",
    "end": "810560"
  },
  {
    "text": "people continued to use it in their next product and here we are uh you know 40 years later and we still have this",
    "start": "810560",
    "end": "817680"
  },
  {
    "text": "protocol uh in our buildings so we want to I want to show",
    "start": "817680",
    "end": "823279"
  },
  {
    "text": "you how easy it is uh to read wegan with uh Modern Hardware like an Arduino which",
    "start": "823279",
    "end": "829240"
  },
  {
    "text": "is you know $20 uh or so uh in the states so what you see here is kind of a",
    "start": "829240",
    "end": "836120"
  },
  {
    "text": "fact simile of what you would see in a um a logic analyzer program so we have",
    "start": "836120",
    "end": "842199"
  },
  {
    "text": "two wires data zero and data one for the wean protocol and also ground but for",
    "start": "842199",
    "end": "847920"
  },
  {
    "text": "this purposes we're looking at basically two wires the vertical axis here uh is volts so 0 to 5 volts and the lines are",
    "start": "847920",
    "end": "857000"
  },
  {
    "text": "on on wegan are normally held high at 5 volts when they want to send a bit they",
    "start": "857000",
    "end": "862720"
  },
  {
    "text": "drop the line to Zer volts and there you go so you if it's on the it's on the",
    "start": "862720",
    "end": "867839"
  },
  {
    "text": "Zero line there you have zero and if it's on the one line you have a one and as time goes on you just read the where",
    "start": "867839",
    "end": "874959"
  },
  {
    "text": "zero volts is and you've got your Midstream of 44 B of 44 bits uh this as",
    "start": "874959",
    "end": "881320"
  },
  {
    "text": "well as the the the number of bits in in the in the card format is all you need",
    "start": "881320",
    "end": "887079"
  },
  {
    "text": "to authenticate to to one of these readers to send to the back end and you're",
    "start": "887079",
    "end": "892399"
  },
  {
    "start": "892000",
    "end": "957000"
  },
  {
    "text": "in so here is an actual screenshot of the wegan protocol from the SL logic uh",
    "start": "892399",
    "end": "900680"
  },
  {
    "text": "program and I'll go through it just so you can see visually what a card looks like so there's the entire this is a",
    "start": "900680",
    "end": "907800"
  },
  {
    "text": "26-bit card there's different formats 26 32 uh some some of the cards have eight",
    "start": "907800",
    "end": "913199"
  },
  {
    "text": "bits for the facility code so the facility code is 0 to 256 and then your card code which is usually printed on",
    "start": "913199",
    "end": "919440"
  },
  {
    "text": "the card is 0 to 65,000 500 whatever uh",
    "start": "919440",
    "end": "924959"
  },
  {
    "text": "so we'll see here we've got the first eight bits is a",
    "start": "924959",
    "end": "932120"
  },
  {
    "text": "facility code of 21 and then the remainder of the 16 bits",
    "start": "932120",
    "end": "937600"
  },
  {
    "text": "we have a card code of 29,6 44 so those two things along with the the the the",
    "start": "937600",
    "end": "944800"
  },
  {
    "text": "format of the card 26 bits is all we need to get access so this is when Eric and I started putting our heads together",
    "start": "944800",
    "end": "950199"
  },
  {
    "text": "and thinking wow let's make a little device uh so we can put it in the wall and and compromise this",
    "start": "950199",
    "end": "957399"
  },
  {
    "start": "957000",
    "end": "1025000"
  },
  {
    "text": "protocol so so this is a bit of a face pal as well and just kind of shows you",
    "start": "957399",
    "end": "963000"
  },
  {
    "text": "uh a little bit of an indication of of some of the silliness that goes on in this industry so this is a dual",
    "start": "963000",
    "end": "969360"
  },
  {
    "text": "technology card so this works with the old readers Eric told you about and the newer eyeclass reader so it's got two",
    "start": "969360",
    "end": "976440"
  },
  {
    "text": "physical antennas in there and it's got two chips and uh it actually has the",
    "start": "976440",
    "end": "982480"
  },
  {
    "text": "same authentication data on both sides of the card so if I'm you know an evil",
    "start": "982480",
    "end": "988680"
  },
  {
    "text": "attacker person uh I want to get your your card access information I can come",
    "start": "988680",
    "end": "993920"
  },
  {
    "text": "by with a reader and read it off your belt even though you your your building may just be using encrypted",
    "start": "993920",
    "end": "1000600"
  },
  {
    "text": "technology uh you're still transmitting un encrypted the other face palm uh",
    "start": "1000600",
    "end": "1006480"
  },
  {
    "text": "about this card is that in yellow you'll see 270 that's the card code and 05 994",
    "start": "1006480",
    "end": "1014560"
  },
  {
    "text": "that's the facility code so all the data you need to authenticate is pretty much written right on the",
    "start": "1014560",
    "end": "1021360"
  },
  {
    "text": "card which is kind of dumb we think and so we brought this up to to hid and they",
    "start": "1021360",
    "end": "1027280"
  },
  {
    "start": "1025000",
    "end": "1065000"
  },
  {
    "text": "say that're they're recommending that people use different um different codes on on both sides of the card now for the",
    "start": "1027280",
    "end": "1033400"
  },
  {
    "text": "for this technology but it's just something to be aware of that most people are completely oblivious",
    "start": "1033400",
    "end": "1038600"
  },
  {
    "text": "about as well you know with these cards this is taken for a month ago or two months ago from hid's website you see",
    "start": "1038600",
    "end": "1045000"
  },
  {
    "text": "enhanced privacy you know communicates no traceable identifiers during card sessions to prevent card data from being",
    "start": "1045000",
    "end": "1050640"
  },
  {
    "text": "divulged or cloned by unauthorized parties but we know given what I just told you that that's not really true so",
    "start": "1050640",
    "end": "1056880"
  },
  {
    "text": "it may be true for the encrypted side uh which hasn't really been audited properly yet but it's it's definitely",
    "start": "1056880",
    "end": "1062760"
  },
  {
    "text": "not for the unencrypted side of the card so the moral of the story here is",
    "start": "1062760",
    "end": "1069480"
  },
  {
    "start": "1065000",
    "end": "1074000"
  },
  {
    "text": "that physical access uh to these readers is winning now we just want to give some",
    "start": "1069480",
    "end": "1076159"
  },
  {
    "start": "1074000",
    "end": "1178000"
  },
  {
    "text": "people some props uh we're not the first people to realize this uh this has been",
    "start": "1076159",
    "end": "1081400"
  },
  {
    "text": "around for 20 years as we've said a number of times uh and there's a number of great people on the internet that",
    "start": "1081400",
    "end": "1086600"
  },
  {
    "text": "helped us uh by you know releasing their code uh guy named pagac has some code on",
    "start": "1086600",
    "end": "1093520"
  },
  {
    "text": "the internet that uh was the original Arduino code that I used to to to start",
    "start": "1093520",
    "end": "1098840"
  },
  {
    "text": "decoding wegend and it's still there today if you Google for it uh Carl from prox clone is another great resource",
    "start": "1098840",
    "end": "1105799"
  },
  {
    "text": "he's done a lot of stuff with iclass up to completely uh um cloning or completely",
    "start": "1105799",
    "end": "1113799"
  },
  {
    "text": "he's got a piece of Hardware that pretends it's an eyeclass card and can dynamically uh adapt given if you give",
    "start": "1113799",
    "end": "1121240"
  },
  {
    "text": "it information it will pretend to a reader and the reader it looks like an eyeclass card he's done some really neat stuff and uh of course there's a device",
    "start": "1121240",
    "end": "1128720"
  },
  {
    "text": "called the gecko which was uh presented at 2008 in Black Hat by a gentleman",
    "start": "1128720",
    "end": "1133880"
  },
  {
    "text": "named Zach Franken now it did something very similar it sat on the wegan lines",
    "start": "1133880",
    "end": "1139039"
  },
  {
    "text": "uh and uh collected data but there was no means to retrieve the data other than",
    "start": "1139039",
    "end": "1144159"
  },
  {
    "text": "maybe flashing an LED of the reader or to uh automatically you know replay the",
    "start": "1144159",
    "end": "1150080"
  },
  {
    "text": "data so we thought okay we're here a number of years later now we've got this great B technology that's you know",
    "start": "1150080",
    "end": "1156400"
  },
  {
    "text": "literally 10 bucks a module uh let's make this attack much more practical so we can you know we can walk up with a",
    "start": "1156400",
    "end": "1163080"
  },
  {
    "text": "cell phone to a door and and open it or get the data we need to create a to",
    "start": "1163080",
    "end": "1168880"
  },
  {
    "text": "really show clients that uh you know if you really want a secure system you need",
    "start": "1168880",
    "end": "1174679"
  },
  {
    "text": "to switch away from these and back to Eric and so we built a",
    "start": "1174679",
    "end": "1181799"
  },
  {
    "start": "1178000",
    "end": "1349000"
  },
  {
    "text": "thing the b key with a Canadian quarter for scale but just in case you're not",
    "start": "1181799",
    "end": "1187400"
  },
  {
    "text": "familiar with the Canadian quar it's about this big uh so that's the actual device uh device that we built there uh",
    "start": "1187400",
    "end": "1193480"
  },
  {
    "text": "18 by 30 mm and uh yeah so it's based",
    "start": "1193480",
    "end": "1199039"
  },
  {
    "text": "mostly on this uh Nordic NRF 51822 system on chip which is a really cool",
    "start": "1199039",
    "end": "1204760"
  },
  {
    "text": "chip that you find used in all sorts of peripherals for iPhone and Android because it has a 2.4 GHz radio as well",
    "start": "1204760",
    "end": "1213159"
  },
  {
    "text": "as a cortex m0r microcontroller all in the same package so that one piece of",
    "start": "1213159",
    "end": "1219200"
  },
  {
    "text": "silicon does your Bluetooth and your application logic we get it in this module format this red uh red module and",
    "start": "1219200",
    "end": "1227840"
  },
  {
    "text": "nice thing about that is it has all the uh the approvals so we don't have to deal with that and we don't have to do antenna matching and all those fun",
    "start": "1227840",
    "end": "1235280"
  },
  {
    "text": "things uh the other big part of it is this black box down at the bottom uh",
    "start": "1235280",
    "end": "1240520"
  },
  {
    "text": "that is an insulation displacement connector or a punchdown connector and what's convenient about that is to",
    "start": "1240520",
    "end": "1246600"
  },
  {
    "text": "install this device you really just need a punchdown tool and you can get the wegan wires place them in and punch down",
    "start": "1246600",
    "end": "1254320"
  },
  {
    "text": "and that will make an electrical connection and it does so without breaking the wire so the reader will",
    "start": "1254320",
    "end": "1260559"
  },
  {
    "text": "continue working just like it was before nobody knows that you've done this but",
    "start": "1260559",
    "end": "1266280"
  },
  {
    "text": "you're now sitting on those wegan lines uh the other parts of this is",
    "start": "1266280",
    "end": "1271360"
  },
  {
    "text": "really some level shifting logic Crystal to support the module and some pinouts",
    "start": "1271360",
    "end": "1277000"
  },
  {
    "text": "for doing programming and debugging runs on a CR1632 coin cell so",
    "start": "1277000",
    "end": "1282960"
  },
  {
    "text": "in the back there you just pop in pop in the coin cell uh it was developed using some",
    "start": "1282960",
    "end": "1288240"
  },
  {
    "text": "state-of-the-art uh equipment here uh this really isn't isn't hard Hardware to",
    "start": "1288240",
    "end": "1293440"
  },
  {
    "text": "develop if you want to get into developing Hardware uh it's you know stuff that is relatively inexpensive",
    "start": "1293440",
    "end": "1301200"
  },
  {
    "text": "nowadays you can get all the tools off uh off suppliers uh for really reasonable",
    "start": "1301200",
    "end": "1309039"
  },
  {
    "text": "prices but also you can get the hardware built for really reasonable prices as well sites like Digi key can provide you",
    "start": "1309039",
    "end": "1314880"
  },
  {
    "text": "with every component you could ever need so we've really reached a point where you know building this kind of Hardware",
    "start": "1314880",
    "end": "1320120"
  },
  {
    "text": "that you're going to embed into a device maybe years ago that was considered to",
    "start": "1320120",
    "end": "1325320"
  },
  {
    "text": "be something that would be you know really expensive and really high tech and sure enough whenever these devices",
    "start": "1325320",
    "end": "1332159"
  },
  {
    "text": "were originally built and put into buildings I'm sure that this was beyond the ability of you know some guys",
    "start": "1332159",
    "end": "1339000"
  },
  {
    "text": "sitting with the beer uh in in someone's house but nowadays it's just become so",
    "start": "1339000",
    "end": "1345120"
  },
  {
    "text": "simple with the uh the amount of stuff out there and it's simple enough that the entire schematic fits onto one slide",
    "start": "1345120",
    "end": "1352320"
  },
  {
    "text": "uh which is great so really again it's the module on there on the left there",
    "start": "1352320",
    "end": "1357440"
  },
  {
    "text": "with a crystal and the pin outs the main thing are Level shifters because uh they",
    "start": "1357440",
    "end": "1363240"
  },
  {
    "text": "actually sorry are just fets used to pull down those weaned wires so those wires as we said they're normally pulled",
    "start": "1363240",
    "end": "1369159"
  },
  {
    "text": "High to 5 volts we just connect them to ground through a uh uh through a fet",
    "start": "1369159",
    "end": "1374679"
  },
  {
    "text": "there and that gives us control over the wire and we also do a little resistive divider so that we can get that 5 volts",
    "start": "1374679",
    "end": "1381880"
  },
  {
    "text": "down to a lower voltage because the module only takes uh up to 3.3 volts on its IO or else it will uh not be a",
    "start": "1381880",
    "end": "1389919"
  },
  {
    "text": "Bluetooth module anymore uh then there's just pin outs an ledd that's that's all",
    "start": "1389919",
    "end": "1395279"
  },
  {
    "text": "there is to it it's it's quite simple we used uh Kad or kead to design this to do",
    "start": "1395279",
    "end": "1402760"
  },
  {
    "text": "the schematic as well as the PCB and we actually went through two Hardware",
    "start": "1402760",
    "end": "1408440"
  },
  {
    "text": "revision versions um first one which we actually have over here is significantly",
    "start": "1408440",
    "end": "1415200"
  },
  {
    "start": "1410000",
    "end": "1479000"
  },
  {
    "text": "larger it's uh it was just done as a V1 we just wanted to get all the components down on the uh on the board and test it",
    "start": "1415200",
    "end": "1422240"
  },
  {
    "text": "out to see if it worked and once that was done we did another uh really just a",
    "start": "1422240",
    "end": "1428080"
  },
  {
    "text": "different PCB uh layout in order to get it down to the tiny size and we",
    "start": "1428080",
    "end": "1433279"
  },
  {
    "text": "originally did the Assembly of these with a hot air rework station on Mark's kitchen table uh it was annoying but it",
    "start": "1433279",
    "end": "1441559"
  },
  {
    "text": "worked Mark's much better at the hot air rework than I am I was just like you know having the components fly all over",
    "start": "1441559",
    "end": "1446919"
  },
  {
    "text": "the place but once you get the air speed right and you get the like solder on there well you can assemble these by",
    "start": "1446919",
    "end": "1452720"
  },
  {
    "text": "hand it's just quite frustrating so we wanted to make a few of them so we sent a bill of materials and the design files",
    "start": "1452720",
    "end": "1460279"
  },
  {
    "text": "off to a a fabrication house and they came back with fully assembled",
    "start": "1460279",
    "end": "1465360"
  },
  {
    "text": "individually packaged modules and for again a pretty reasonable price our uh",
    "start": "1465360",
    "end": "1470880"
  },
  {
    "text": "you know bomb cost on these modules somewhere around $10 which is it's all right um so we did make a pretty",
    "start": "1470880",
    "end": "1479960"
  },
  {
    "start": "1479000",
    "end": "1535000"
  },
  {
    "text": "interesting mistake during the development of this though and it's it makes for a good story uh when we were",
    "start": "1479960",
    "end": "1485399"
  },
  {
    "text": "doing development uh we had like five of these things kicking around in uh Mark's",
    "start": "1485399",
    "end": "1490600"
  },
  {
    "text": "office and you know when you're connected to one you don't necessarily know because they all have the same Bluetooth name so you'll see b key b key",
    "start": "1490600",
    "end": "1497840"
  },
  {
    "text": "and you want to know which one is sitting in front of you and which one you're actually working with uh so what you do with Bluetooth devices and",
    "start": "1497840",
    "end": "1504159"
  },
  {
    "text": "development if you've ever developed a Bluetooth device you've probably given it some random name so that you can tell",
    "start": "1504159",
    "end": "1510320"
  },
  {
    "text": "which one's which now what you're supposed to do is when you send the firmware off for manufacturing you want",
    "start": "1510320",
    "end": "1516320"
  },
  {
    "text": "to switch that name back to the real name of your device now Mark uh",
    "start": "1516320",
    "end": "1521799"
  },
  {
    "text": "was QA Department okay we didn't have QA Mark was debugging one and uh getting",
    "start": "1521799",
    "end": "1528000"
  },
  {
    "text": "all ready and he sent the firmware off it was like last minute okay let's send the firmware off to this Boardhouse",
    "start": "1528000",
    "end": "1533760"
  },
  {
    "text": "which who were in China and they came back with an email that said we have the update successful but the B name is BL",
    "start": "1533760",
    "end": "1542440"
  },
  {
    "start": "1535000",
    "end": "1565000"
  },
  {
    "text": "penis now Mark's company opave actually made 200 of these and gave them out at",
    "start": "1542440",
    "end": "1547520"
  },
  {
    "text": "black hat uh us and thankfully we emailed this guy you're like no no no no",
    "start": "1547520",
    "end": "1552840"
  },
  {
    "text": "please can you update the firmware again we don't want his company giving these out and everyone yeah getting them so",
    "start": "1552840",
    "end": "1559520"
  },
  {
    "text": "thanks to uh oops uh thanks to those guys for solving that um but yeah once",
    "start": "1559520",
    "end": "1566919"
  },
  {
    "start": "1565000",
    "end": "1599000"
  },
  {
    "text": "you have it and it has the right Bluetooth name um you can put it in a pro reader this is actually the reader",
    "start": "1566919",
    "end": "1572880"
  },
  {
    "text": "that we have mounted up there which we'll be doing some demos on and it fits in there with like tons of room to spare",
    "start": "1572880",
    "end": "1579200"
  },
  {
    "text": "you can get the cover back on no one would ever know that that you put it in uh it's quite simple some other readers",
    "start": "1579200",
    "end": "1586000"
  },
  {
    "text": "they're quite a bit thinner but they're often mounted onto junction boxes so there's often space behind to mount the",
    "start": "1586000",
    "end": "1592799"
  },
  {
    "text": "the the b key just depends on exactly what reader you're on so we decided to",
    "start": "1592799",
    "end": "1599159"
  },
  {
    "start": "1599000",
    "end": "1694000"
  },
  {
    "text": "do a speed run and see how fast we could uh do it and this is that so I challenged Mark to",
    "start": "1599159",
    "end": "1607279"
  },
  {
    "text": "do it in a minute and what he's doing now is just taking the top cover off this only took five",
    "start": "1607279",
    "end": "1614080"
  },
  {
    "text": "takes and uh there's four screws",
    "start": "1614080",
    "end": "1619600"
  },
  {
    "text": "that comes off so that's the reader there and this is actually how you'll often see them hooked up just four wires",
    "start": "1619919",
    "end": "1626200"
  },
  {
    "text": "power ground wean data one and wean data zero and we need three of those wires uh",
    "start": "1626200",
    "end": "1633080"
  },
  {
    "text": "the wegan wires so two of them as well as ground because we need to be able to pull the ground and they're always the same color",
    "start": "1633080",
    "end": "1640720"
  },
  {
    "text": "green and white yeah it's actually labeled right on that white uh piece of plastic like wegan data zero green it's",
    "start": "1640720",
    "end": "1649240"
  },
  {
    "text": "quite convenient uh so he puts all those",
    "start": "1649240",
    "end": "1654559"
  },
  {
    "text": "in punches down so yeah the real key with the the",
    "start": "1654559",
    "end": "1660720"
  },
  {
    "text": "the punch down connector is you just you don't have to cut you don't have to splice you just hit it with the tool and",
    "start": "1660720",
    "end": "1666039"
  },
  {
    "text": "that goes in and he did it in a minute and then the door still works is sort of the purpose of that and in this case we",
    "start": "1666039",
    "end": "1672600"
  },
  {
    "text": "were using a phone and now we can replay uh replay cards but we'll",
    "start": "1672600",
    "end": "1680640"
  },
  {
    "text": "show this live uh live here I I'll let I'll let him do it until",
    "start": "1680640",
    "end": "1686440"
  },
  {
    "text": "the door opens no card and send and the door opens so once",
    "start": "1686440",
    "end": "1692960"
  },
  {
    "text": "that device is in there and was shown how to get it in you're probably wondering what the point was and that's",
    "start": "1692960",
    "end": "1698039"
  },
  {
    "start": "1694000",
    "end": "1709000"
  },
  {
    "text": "why we'll go through a few different attacks that you can do once once the device has been put in and Mark's going to uh sort of do the",
    "start": "1698039",
    "end": "1706720"
  },
  {
    "text": "demonstration I'm going to talk through what he's doing so the first thing is quite simple it's recording uh recording",
    "start": "1706720",
    "end": "1714440"
  },
  {
    "start": "1709000",
    "end": "1747000"
  },
  {
    "text": "the card data so what we're going to do for this is a situation where we have a",
    "start": "1714440",
    "end": "1720880"
  },
  {
    "text": "person named Alice she has a legitimate card she's going to tap that card on the reader Eve though has already installed",
    "start": "1720880",
    "end": "1728279"
  },
  {
    "text": "this b key and so Eve is going to be able to recover that data over Bluetooth",
    "start": "1728279",
    "end": "1733960"
  },
  {
    "text": "once Eve has that uh that string of of bits uh she'll be able to actually create a",
    "start": "1733960",
    "end": "1740360"
  },
  {
    "text": "cloned card that is going to look exactly like Alice's and nobody can tell the difference",
    "start": "1740360",
    "end": "1746559"
  },
  {
    "text": "so first thing to show here have",
    "start": "1746559",
    "end": "1751880"
  },
  {
    "start": "1747000",
    "end": "1879000"
  },
  {
    "text": "to so we have a Serial terminal it's not normally uh hooked up to a Serial",
    "start": "1751880",
    "end": "1757360"
  },
  {
    "text": "terminal but for the purposes of uh this event we thought it would be useful uh to show you kind of some debug output",
    "start": "1757360",
    "end": "1764320"
  },
  {
    "text": "that we use while we're while we were developing so that Eric switching to that right now",
    "start": "1764320",
    "end": "1769840"
  },
  {
    "text": "and there you go so the output that we see here is uh you know we received 36",
    "start": "1769840",
    "end": "1776440"
  },
  {
    "text": "bytes there it is as binary and uh it got cut off there there's too much text",
    "start": "1776440",
    "end": "1781840"
  },
  {
    "text": "and we received another card it's a 26 uh sorry 26 bit card uh and there's the",
    "start": "1781840",
    "end": "1787039"
  },
  {
    "text": "raw and uh data as hex from from that bit stream so again this was just sort",
    "start": "1787039",
    "end": "1792679"
  },
  {
    "text": "of using debugging so we could see oh we got a card here's the bits but it's less",
    "start": "1792679",
    "end": "1797919"
  },
  {
    "text": "interesting to do that when the device is in a reader because odds are you can't connect a Serial terminal when you want to get the data out",
    "start": "1797919",
    "end": "1805159"
  },
  {
    "text": "so we did some Bluetooth stuff so uh this utility is going to allow us",
    "start": "1805159",
    "end": "1812679"
  },
  {
    "text": "to do the same same stuff over Bluetooth I don't know if we're connected we are we are connected yeah",
    "start": "1812679",
    "end": "1820240"
  },
  {
    "text": "so this is a python utility just uses the Linux uh Gat tools uh it's a wrapper",
    "start": "1820240",
    "end": "1826000"
  },
  {
    "text": "because there's no really good pyth module for this but uh so it's a little bit clug but uh nonetheless it it works",
    "start": "1826000",
    "end": "1833080"
  },
  {
    "text": "and we're not going to be demoing with a phone today because it's a bit crazy with all of the fitbits and whatnot in",
    "start": "1833080",
    "end": "1839399"
  },
  {
    "text": "the audience to try to do that so we have a white list and we're only connecting with my computer so the read",
    "start": "1839399",
    "end": "1845279"
  },
  {
    "text": "card demonstration is really simple we've read a few cards while we're setting this up and it does take a",
    "start": "1845279",
    "end": "1851399"
  },
  {
    "text": "minute to do it but there's all those numbers and if you grab that uh procs Mark tool over there",
    "start": "1851399",
    "end": "1858120"
  },
  {
    "text": "uh that tool there uh with one of those and that number you'll be able to clone",
    "start": "1858120",
    "end": "1864039"
  },
  {
    "text": "all those cards doesn't matter if they're uh iclass or procs because the encryption is broken on iclass so you",
    "start": "1864039",
    "end": "1870880"
  },
  {
    "text": "can just encrypt the number and do it again and that's the first really simple",
    "start": "1870880",
    "end": "1876559"
  },
  {
    "text": "obvious attack that you can do um the next one is replaying so this",
    "start": "1876559",
    "end": "1883919"
  },
  {
    "text": "is a situation where somebody with a valid card Alice she used her card and",
    "start": "1883919",
    "end": "1888960"
  },
  {
    "text": "door has been opened she goes in and then Eve is trying to tailgate but maybe the company is good about tailgating",
    "start": "1888960",
    "end": "1896240"
  },
  {
    "text": "policies so can't just walk through the door so the door is locked but that",
    "start": "1896240",
    "end": "1901840"
  },
  {
    "text": "doesn't matter because using a Bluetooth request which is TX",
    "start": "1901840",
    "end": "1907720"
  },
  {
    "start": "1902000",
    "end": "1936000"
  },
  {
    "text": "believe we can just open the door uh this can be done from a phone it can be done from an Apple Watch that we need to",
    "start": "1907720",
    "end": "1914880"
  },
  {
    "text": "make that client work uh anything that can talk Bluetooth low energy can just",
    "start": "1914880",
    "end": "1920440"
  },
  {
    "text": "ask the door to send or ask the last card to be sent the door pops open so these are the two really obvious things",
    "start": "1920440",
    "end": "1926559"
  },
  {
    "text": "it's you know you can clone people's credentials and you can just walk into the facility already it's like okay these",
    "start": "1926559",
    "end": "1933679"
  },
  {
    "text": "are not not highly secure uh ways of locking down your building but we wanted",
    "start": "1933679",
    "end": "1939880"
  },
  {
    "start": "1936000",
    "end": "2034000"
  },
  {
    "text": "to have more fun and we realized that we were connected to these wegend lines and because they're normally pulled high if",
    "start": "1939880",
    "end": "1946279"
  },
  {
    "text": "we just pulled them low all the time nobody could unlock the door not even the real reader and that seemed like a",
    "start": "1946279",
    "end": "1951840"
  },
  {
    "text": "fun idea so in this case you're going to have your uh your attacker Eve here",
    "start": "1951840",
    "end": "1958440"
  },
  {
    "text": "who's going to use a control card so a card with a predefined number this one is Ox dead beef and whenever that",
    "start": "1958440",
    "end": "1966679"
  },
  {
    "text": "happens the b key in the device is first going to replay on wegan the last valid",
    "start": "1966679",
    "end": "1972399"
  },
  {
    "text": "card and then it's also going to pull both lines low and at that point there's no no getting in",
    "start": "1972399",
    "end": "1979840"
  },
  {
    "text": "so we're going to show this one this is a the other tab just go back oh yeah I",
    "start": "1979840",
    "end": "1985880"
  },
  {
    "text": "want this tab there you go so this is started by the Control Card Mark has",
    "start": "1985880",
    "end": "1990919"
  },
  {
    "text": "there and it's going to say 20 seconds and now even with oh it opens once there",
    "start": "1990919",
    "end": "1996200"
  },
  {
    "text": "we go now it's locked out and even with a valid card uh there's no getting in so now you can run around the building and",
    "start": "1996200",
    "end": "2002799"
  },
  {
    "text": "I don't know steal some servers or whatever you want to do uh is it practical I mean if it would be",
    "start": "2002799",
    "end": "2009559"
  },
  {
    "text": "kind of funny because people would have to go get the hard key for that door and that could take them quite a while in",
    "start": "2009559",
    "end": "2015559"
  },
  {
    "text": "some in some facilities so those are the uh I I like to wave at customers through their",
    "start": "2015559",
    "end": "2021080"
  },
  {
    "text": "server room uh window those are the uh simple attacks there I'm just going to switch this back can I ask a question",
    "start": "2021080",
    "end": "2028960"
  },
  {
    "text": "absolutely you run it on one uh right now it's he asked how long",
    "start": "2028960",
    "end": "2035159"
  },
  {
    "start": "2034000",
    "end": "2079000"
  },
  {
    "text": "the battery lasts basically so right now it's about 2 to 3 days there's absolutely no energy optimization to our",
    "start": "2035159",
    "end": "2042480"
  },
  {
    "text": "code because we wanted to get it ready for the presentation uh so but it could feasibly",
    "start": "2042480",
    "end": "2048240"
  },
  {
    "text": "go to 30 days or even 3 months with this coin cell yeah we've seen uh there are",
    "start": "2048240",
    "end": "2055358"
  },
  {
    "text": "devices that use the same uh same Hardware running for three months on on a coin cell this is the just",
    "start": "2055359",
    "end": "2062440"
  },
  {
    "text": "optimization uh if it's all right uh if we can just get through and do save question the end unless something's",
    "start": "2062440",
    "end": "2069200"
  },
  {
    "text": "really relevant to this uh so the last attack uh type that we looked at was the",
    "start": "2069200",
    "end": "2075240"
  },
  {
    "text": "skimmer and this is something that Mark's",
    "start": "2075240",
    "end": "2080320"
  },
  {
    "start": "2079000",
    "end": "2181000"
  },
  {
    "text": "actually done a whole bunch on sites and it works really well basically you get yourself a maxi Pro reader which is the",
    "start": "2080320",
    "end": "2087200"
  },
  {
    "text": "big one that you see used for uh parking garages two times two times this size",
    "start": "2087200",
    "end": "2093520"
  },
  {
    "text": "height and width so it's 12 in 30 C we didn't bring one because they're they're",
    "start": "2093520",
    "end": "2099160"
  },
  {
    "text": "interesting to fly with uh they they don't look so great in the X-ray but uh it's yeah but this big and it can read a",
    "start": "2099160",
    "end": "2105320"
  },
  {
    "text": "card at about three feet or a meter away I don't have to do Imperial here which is nice uh so what you do is you take",
    "start": "2105320",
    "end": "2112480"
  },
  {
    "text": "that and you hide it in a backpack and you stick a BL key in it you need to give it 12 volts for power but you can",
    "start": "2112480",
    "end": "2118040"
  },
  {
    "text": "buy a 12volt battery pack or uh get some lithium cells connect them together and",
    "start": "2118040",
    "end": "2124280"
  },
  {
    "text": "plug it in that way so now you have a totally battery powered system and you can walk around and if you get within uh",
    "start": "2124280",
    "end": "2131520"
  },
  {
    "text": "one meter of somebody and they have a card it will read it and once you do that you can then take the data off",
    "start": "2131520",
    "end": "2137560"
  },
  {
    "text": "clone the card and get inside uh I've even heard of people doing things for physical penetration testing like",
    "start": "2137560",
    "end": "2144320"
  },
  {
    "text": "walking into the building and saying oh I am with it we are doing an audit of badges could you please scan it on this",
    "start": "2144320",
    "end": "2150960"
  },
  {
    "text": "reader and they do and then you have their card information and we didn't come up with this attack uh guys from",
    "start": "2150960",
    "end": "2157280"
  },
  {
    "text": "Bishop Fox uh released the tastic RFID Thief uh but with the ble key you can",
    "start": "2157280",
    "end": "2162839"
  },
  {
    "text": "sit there with push notifications to your cell phone walking around and you can you know which cards you've grabbed",
    "start": "2162839",
    "end": "2168800"
  },
  {
    "text": "if you're in an elevator for example yeah so it's kind of just the next step of that skimming attack that the people",
    "start": "2168800",
    "end": "2174800"
  },
  {
    "text": "have been doing but it turns out to be a really great way to get people's credentials and get around",
    "start": "2174800",
    "end": "2181280"
  },
  {
    "start": "2181000",
    "end": "2212000"
  },
  {
    "text": "buildings so uh most of the time where we've spoken to people about this that use these system and rely on them",
    "start": "2181280",
    "end": "2187680"
  },
  {
    "text": "they're surprised uh because they were sold something by a company that does",
    "start": "2187680",
    "end": "2193400"
  },
  {
    "text": "usually the company selling it is the company that does the installations they don't really have a security background they're more like electrical wiring type",
    "start": "2193400",
    "end": "2200760"
  },
  {
    "text": "people uh so they just don't know and we've gotten a lot of that kind of",
    "start": "2200760",
    "end": "2206480"
  },
  {
    "text": "reaction so Mark's going to go through uh what you can do if that's your face right",
    "start": "2206480",
    "end": "2211839"
  },
  {
    "text": "now great uh so the first tactic of course is is to enable your tamper",
    "start": "2211839",
    "end": "2218040"
  },
  {
    "start": "2212000",
    "end": "2253000"
  },
  {
    "text": "detection and tamper detection is uh on most readers a tiny switch uh on on the",
    "start": "2218040",
    "end": "2224160"
  },
  {
    "text": "newer readers it's Optical as well so it'll sense uh so you can't defeat the switch as easy You by holding it down",
    "start": "2224160",
    "end": "2231000"
  },
  {
    "text": "it'll sense any light but of course you know you if you were tricky you could figure out ways around that as well now",
    "start": "2231000",
    "end": "2237960"
  },
  {
    "text": "one of the problems with this is we found that most installers to save money don't actually run phys enough physical",
    "start": "2237960",
    "end": "2245000"
  },
  {
    "text": "copper lines to the readers to even hook up a tamper detect uh and the second problem with",
    "start": "2245000",
    "end": "2251160"
  },
  {
    "text": "this is that uh most people don't watch the logs so the tempered detect is not",
    "start": "2251160",
    "end": "2257880"
  },
  {
    "start": "2253000",
    "end": "2300000"
  },
  {
    "text": "going to be very useful for you uh if uh you're the computer is sitting for",
    "start": "2257880",
    "end": "2263720"
  },
  {
    "text": "example in a cafeteria uh where i' I've actually seen an access control computer",
    "start": "2263720",
    "end": "2268880"
  },
  {
    "text": "at a uh a chemical plant before so uh definitely take a look at the logs uh",
    "start": "2268880",
    "end": "2277240"
  },
  {
    "text": "you should probably even do heuristics uh so if you have that capability and you know that Joe comes in every morning",
    "start": "2277240",
    "end": "2284359"
  },
  {
    "text": "at 9:00 a.m. and uses uh three certain doors and all of a sudden Joe's card is",
    "start": "2284359",
    "end": "2290079"
  },
  {
    "text": "used at 2 a.m. uh on a back door that it's never been used on before uh that",
    "start": "2290079",
    "end": "2295560"
  },
  {
    "text": "should probably um light off light off an alarm Bell somewhere uh the other thing and this is",
    "start": "2295560",
    "end": "2302760"
  },
  {
    "text": "kind of after the fact is you since the if you're going to use this system and",
    "start": "2302760",
    "end": "2308880"
  },
  {
    "text": "you're really concerned about security um you probably want to have it camera trained on all the doors that you're",
    "start": "2308880",
    "end": "2314640"
  },
  {
    "text": "you're really concerned about because uh you're going to need to do face verification as well to make sure that",
    "start": "2314640",
    "end": "2320400"
  },
  {
    "text": "the person that used the card is actually the person's card in the log as well uh and and one really interesting",
    "start": "2320400",
    "end": "2326800"
  },
  {
    "text": "thing when we saw in Vegas because we got invited by the folks at MGM to go back into their key room where they do",
    "start": "2326800",
    "end": "2333599"
  },
  {
    "text": "all of the key rooms for the entire Pro or the keys for the entire property property including RFID cards and whatnot is",
    "start": "2333599",
    "end": "2340760"
  },
  {
    "text": "they've actually chosen to install readers behind the drywall so you don't even see the reader uh you have no",
    "start": "2340760",
    "end": "2347200"
  },
  {
    "text": "indication it's there it obviously unless you're going to punch a hole in the wall you won't get access to the",
    "start": "2347200",
    "end": "2352800"
  },
  {
    "text": "physical wires behind it so it's it's an interesting tactic to avoid uh this this",
    "start": "2352800",
    "end": "2358920"
  },
  {
    "text": "type of attack and even giving someone an indication that there might be something uh important behind the door",
    "start": "2358920",
    "end": "2366000"
  },
  {
    "text": "there so I I liked that one personally myself and I should say you know these readers do provide some security we're",
    "start": "2366000",
    "end": "2372440"
  },
  {
    "text": "not saying it's it's this is accessible to everyone although it's we think that we've made it pretty easy we think that",
    "start": "2372440",
    "end": "2378880"
  },
  {
    "text": "the the security that they provide is about the same as a standard key because you can take a camera like this take a",
    "start": "2378880",
    "end": "2384280"
  },
  {
    "text": "picture of a key and uh make a copy now and it's about the same with the tools",
    "start": "2384280",
    "end": "2390200"
  },
  {
    "text": "that we talked about and uh and and the b key uh so in closing I guess uh I don't",
    "start": "2390200",
    "end": "2397640"
  },
  {
    "text": "have my slide notes up right now but I think that I just want to say uh thanks to everyone uh it's time to change from",
    "start": "2397640",
    "end": "2403839"
  },
  {
    "start": "2400000",
    "end": "2443000"
  },
  {
    "text": "wegan to some other protocol uh and uh we're really appreciative to to be here",
    "start": "2403839",
    "end": "2409160"
  },
  {
    "text": "speaking today thanks for coming and thanks to blackhead for having us [Applause]",
    "start": "2409160",
    "end": "2416239"
  },
  {
    "text": "and and we have about how long do we have yeah we got a",
    "start": "2417680",
    "end": "2424079"
  },
  {
    "text": "20 minutes for questions 20 minutes for questions we ins start uh I don't see a",
    "start": "2424079",
    "end": "2429280"
  },
  {
    "text": "hand back there I'm sorry for shutting whoever that was down yeah we got a question right",
    "start": "2429280",
    "end": "2435520"
  },
  {
    "text": "here service yep denial of service the building uh I suppose most",
    "start": "2436720",
    "end": "2445359"
  },
  {
    "start": "2443000",
    "end": "2511000"
  },
  {
    "text": "buildings have uh motion sensors on one side that will activate a remote exit",
    "start": "2445359",
    "end": "2451359"
  },
  {
    "text": "switch which I believe will circumvent the uh the readers wean but it's I guess",
    "start": "2451359",
    "end": "2458440"
  },
  {
    "text": "theoretically it's possible uh",
    "start": "2458440",
    "end": "2463680"
  },
  {
    "text": "sorry yes right for safety regulations there typically has to be a override",
    "start": "2463680",
    "end": "2470079"
  },
  {
    "text": "either motion sensor or physical switch uh for or and this is what you see most",
    "start": "2470079",
    "end": "2475839"
  },
  {
    "text": "often there's the door handle just opens the door uh so that's what you usually see from the inside because like like",
    "start": "2475839",
    "end": "2482560"
  },
  {
    "text": "you said health and safety if the building catches fire you don't want people to be stuck because the you know reader got disconnected that's an",
    "start": "2482560",
    "end": "2489000"
  },
  {
    "text": "interesting question though I never thought that that Vector over here yeah",
    "start": "2489000",
    "end": "2494359"
  },
  {
    "text": "I've previously worked at places that use the the hid system but I currently work somewhere that doesn't but I'm",
    "start": "2494359",
    "end": "2500440"
  },
  {
    "text": "going to guess that other manufacturers have possibly used wegan and maybe have",
    "start": "2500440",
    "end": "2505760"
  },
  {
    "text": "simar vulnerability you looked at other systems and to get a feel for so the",
    "start": "2505760",
    "end": "2511800"
  },
  {
    "start": "2511000",
    "end": "2578000"
  },
  {
    "text": "first thing so the question was uh there are other companies and this gentlemen saying he now works at a company that",
    "start": "2511800",
    "end": "2518319"
  },
  {
    "text": "uses something different um so the first thing about these different readers is it turns out a lot of them are actually",
    "start": "2518319",
    "end": "2524839"
  },
  {
    "text": "owned by hid uh hid has bought out a lot of people over the last 20 years um so",
    "start": "2524839",
    "end": "2531319"
  },
  {
    "text": "there there's a chance that it is actually owned by hid and for example indala indala is a a good example of",
    "start": "2531319",
    "end": "2537119"
  },
  {
    "text": "that they use a similar technology and they use wegan on the back end they use wean so and companies that aren't hid",
    "start": "2537119",
    "end": "2542640"
  },
  {
    "text": "there are still some out there using uh using wegan the reason being that the Upstream door controller which",
    "start": "2542640",
    "end": "2548880"
  },
  {
    "text": "we didn't really show stuck behind here it's not specific to the readers that",
    "start": "2548880",
    "end": "2554480"
  },
  {
    "text": "guy uh so you can buy a readers from one company and a door controller for",
    "start": "2554480",
    "end": "2560440"
  },
  {
    "text": "another and often they'll work together because it's just weaned and it's just become sort of this accepted standard uh",
    "start": "2560440",
    "end": "2567680"
  },
  {
    "text": "there are some more Secure Solutions like we were saying osdp and secure Channel protocol but we haven't seen any",
    "start": "2567680",
    "end": "2574880"
  },
  {
    "text": "in North America I'm not sure there's companies doing that here yeah I've seen some other weird examples uh like when",
    "start": "2574880",
    "end": "2580760"
  },
  {
    "text": "you when you have myair for example where all of the decision is made on the lock itself everything is stored there",
    "start": "2580760",
    "end": "2587240"
  },
  {
    "text": "uh they're insecure for other reasons but um uh it's that's the other thing is it's really hard for Security",
    "start": "2587240",
    "end": "2593319"
  },
  {
    "text": "Professionals to get access to this type of technology for example even to get the server software for the back end is",
    "start": "2593319",
    "end": "2600319"
  },
  {
    "text": "difficult any of this Hardware this I got on eBay for $200 but it's originally",
    "start": "2600319",
    "end": "2606119"
  },
  {
    "text": "I think a $600 controller and uh so to get access to the wide variety of stuff",
    "start": "2606119",
    "end": "2611599"
  },
  {
    "text": "that's out there is difficult and to know to learn the industry is it takes a lot of uh footwork leg work so to",
    "start": "2611599",
    "end": "2619558"
  },
  {
    "text": "speak here yeah I've got two questions actually uh first of all would it be able to parasite power of basically the",
    "start": "2620400",
    "end": "2628119"
  },
  {
    "text": "door controller lines yes so the question was could we just grab power off the door controller lines uh we",
    "start": "2628119",
    "end": "2634960"
  },
  {
    "start": "2630000",
    "end": "2722000"
  },
  {
    "text": "looked at it the the so it should theoretically be possible the issue",
    "start": "2634960",
    "end": "2640800"
  },
  {
    "text": "being though that it's pulled up through a 10 kohm resistor um so you'd have to sip power like really carefully",
    "start": "2640800",
    "end": "2648359"
  },
  {
    "text": "otherwise you'd end up pulling the lines low and after kind of looking at that we",
    "start": "2648359",
    "end": "2653720"
  },
  {
    "text": "went we really don't want to make something that you install and then it like breaks that you know we wanted to",
    "start": "2653720",
    "end": "2659680"
  },
  {
    "text": "avoid breaking the actual installation um so that's why we end up going with the battery is it possible probably if",
    "start": "2659680",
    "end": "2665839"
  },
  {
    "text": "you had some kind of like Ultra cap or something and you trickle charged it off the lines because one line is always",
    "start": "2665839",
    "end": "2671760"
  },
  {
    "text": "high so as long as you could ride out those transience it should be possible um 12 12 volts is available to the",
    "start": "2671760",
    "end": "2679240"
  },
  {
    "text": "controller as well but we made a decision not to include that because of potential line Noise by pulling it so",
    "start": "2679240",
    "end": "2684520"
  },
  {
    "text": "far down to 3.5 3.3 well that one was we we did look at the 12vt line for power",
    "start": "2684520",
    "end": "2690960"
  },
  {
    "text": "but really in order to make it small enough that would have been putting a switching regulator inside the reader",
    "start": "2690960",
    "end": "2696400"
  },
  {
    "text": "and the reader already does some RF stuff at like for procs it's like around it's in the 100 khz so 25 or it's 25 for",
    "start": "2696400",
    "end": "2703839"
  },
  {
    "text": "yeah 125 125 so you know if you have a 20 khz switching converter with 125 khz",
    "start": "2703839",
    "end": "2710760"
  },
  {
    "text": "card it could be could be a bad time how would this deal with an anti paath back system is that something controlled by",
    "start": "2710760",
    "end": "2717280"
  },
  {
    "text": "door controll or something you would find on the actual reader so the question was about anti",
    "start": "2717280",
    "end": "2723839"
  },
  {
    "start": "2722000",
    "end": "2781000"
  },
  {
    "text": "Passback uh so uh the ones that I've seen for that it's typically the door controller programming because the",
    "start": "2723839",
    "end": "2730119"
  },
  {
    "text": "readers are quite dumb uh so if you're trying to replay the exact same card",
    "start": "2730119",
    "end": "2735480"
  },
  {
    "text": "right after that could be an issue but if you let the thing sit there for a day and collect a whole ream of cards uh",
    "start": "2735480",
    "end": "2742880"
  },
  {
    "text": "there is a feature that uh we didn't demonstrate that's pretty much the replay but you pass it an argument of",
    "start": "2742880",
    "end": "2748319"
  },
  {
    "text": "how many cards back you want to go so you know if you know you have 100 cards and you just choose back 50 cards and",
    "start": "2748319",
    "end": "2755599"
  },
  {
    "text": "the send the variable to the B you just select if you just say TX it'll send the",
    "start": "2755599",
    "end": "2761079"
  },
  {
    "text": "last one if you say tx5 it'll send the the card number five in the list yeah so",
    "start": "2761079",
    "end": "2766839"
  },
  {
    "text": "it's it's better but uh not not totally a solution any other comments back here",
    "start": "2766839",
    "end": "2775559"
  },
  {
    "text": "mentions would it be possible to for uh so proof forcing we there's a",
    "start": "2775559",
    "end": "2782359"
  },
  {
    "start": "2781000",
    "end": "2846000"
  },
  {
    "text": "first of all there is an attack using the Pro clone and an antenna to root force uh and I think that uh with the B",
    "start": "2782359",
    "end": "2790319"
  },
  {
    "text": "we haven't actually implemented it yet but it would be a lot faster using direct access to the wegan lines of",
    "start": "2790319",
    "end": "2795559"
  },
  {
    "text": "course uh the pulse length is 50 milliseconds I believe between um each",
    "start": "2795559",
    "end": "2801640"
  },
  {
    "text": "bit so we we haven't experimented with trying to compress it down but I believe that it would probably work because the",
    "start": "2801640",
    "end": "2807920"
  },
  {
    "text": "controller is not going to care about how much space is as long as as long as it's running fast enough to read the the",
    "start": "2807920",
    "end": "2813760"
  },
  {
    "text": "uh us pulling it down so yeah theoretically you could probably do a pretty fast Brute Force I think for a",
    "start": "2813760",
    "end": "2819119"
  },
  {
    "text": "26-bit card you know if you know if you know a card code and you just want to figure out the facility code which is",
    "start": "2819119",
    "end": "2825400"
  },
  {
    "text": "not usually printed on the card it would only take 256 attempts right it wouldn't take much so it's just software and this",
    "start": "2825400",
    "end": "2832040"
  },
  {
    "text": "is by the way this is all open source it's on GitHub um if you add one of us on there",
    "start": "2832040",
    "end": "2838000"
  },
  {
    "text": "we can or tweet us or whatever we'll send it to you the link uh but yeah you can you can add",
    "start": "2838000",
    "end": "2844280"
  },
  {
    "text": "that to the firmware please but the the real interesting thing with the denial of service would be the case",
    "start": "2844280",
    "end": "2849880"
  },
  {
    "text": "where you have a uh card code but not the facility code and that comes up quite a bit uh I was in one facility",
    "start": "2849880",
    "end": "2856640"
  },
  {
    "text": "where they had a fire lock box for Keys which had a glass front on it and in",
    "start": "2856640",
    "end": "2862839"
  },
  {
    "text": "this fire lock box was a card with the numbers facing at the glass panel so you",
    "start": "2862839",
    "end": "2869559"
  },
  {
    "text": "could read the card code by just walking up to the their Lobby's Firebox and and looking at the card uh so in in that",
    "start": "2869559",
    "end": "2876000"
  },
  {
    "text": "case yeah 256 tries later and you're in the door yep are you also able to inter the",
    "start": "2876000",
    "end": "2883680"
  },
  {
    "text": "PIN code uh we don't have that in software right now but we've looked at the pin readers and it literally just",
    "start": "2883680",
    "end": "2889640"
  },
  {
    "text": "adds some bits the only issue right now is that we time out because we wanted to be able to do it really fast we we time",
    "start": "2889640",
    "end": "2895400"
  },
  {
    "text": "out pretty quickly you'd have to increase that timeout length so on hid procs that's the cas on iclass the pin",
    "start": "2895400",
    "end": "2902280"
  },
  {
    "text": "is a bit different uh so it's done on the actual card data stored there we",
    "start": "2902280",
    "end": "2908359"
  },
  {
    "text": "have to look into that more not 100% on the iass so that that's one thing worth mentioning is that iclass does have uh",
    "start": "2908359",
    "end": "2915240"
  },
  {
    "text": "their more secure uh what's called bio class as well which is those fingerprint Raider versions uh it sounds better one",
    "start": "2915240",
    "end": "2923720"
  },
  {
    "text": "of the big issues with this though is that the actual biometric data is stored on the card and if you're using those",
    "start": "2923720",
    "end": "2930559"
  },
  {
    "text": "the non- elite version which is using that Global leaked key desk key somebody",
    "start": "2930559",
    "end": "2935880"
  },
  {
    "text": "could take a card and then en encode their own biometric data onto that card",
    "start": "2935880",
    "end": "2941359"
  },
  {
    "text": "but then change the facility code and the uh card code so now they can walk up",
    "start": "2941359",
    "end": "2947040"
  },
  {
    "text": "use this card it has a different card code or it has a fake card code use their own finger for the fingerprint",
    "start": "2947040",
    "end": "2952880"
  },
  {
    "text": "reader the verification is done at the reader and then it sends that over weend back that just the card code back so",
    "start": "2952880",
    "end": "2960040"
  },
  {
    "text": "those more secure bioc class devices are still vulnerable to faking wegan data and also you can the cards but it's more",
    "start": "2960040",
    "end": "2968960"
  },
  {
    "text": "complex yep uh we we are going to do another",
    "start": "2969079",
    "end": "2974880"
  },
  {
    "text": "production run I think we've had a lot of people asking because they don't want to they don't want to do it themselves or Slaughter it which is fair so we just",
    "start": "2974880",
    "end": "2982599"
  },
  {
    "start": "2975000",
    "end": "3024000"
  },
  {
    "text": "we're probably going to make up another hundred and sell it for you know just around our cost and we're not interested",
    "start": "2982599",
    "end": "2987799"
  },
  {
    "text": "in you know making cash or anything off of it and it is open source uh with the the Kad files are on the or in the",
    "start": "2987799",
    "end": "2994680"
  },
  {
    "text": "GitHub repo as well so if you do want to make it please some people have uh and",
    "start": "2994680",
    "end": "2999880"
  },
  {
    "text": "some people have also emailed saying I made one and soldering it really sucked so maybe we we should do another run uh",
    "start": "2999880",
    "end": "3007799"
  },
  {
    "text": "we we'll look into it when we get back to Canada how about have",
    "start": "3007799",
    "end": "3012079"
  },
  {
    "text": "that you good okay well thanks again everyone",
    "start": "3012880",
    "end": "3020280"
  },
  {
    "text": "really appreciate it",
    "start": "3020280",
    "end": "3026799"
  }
]