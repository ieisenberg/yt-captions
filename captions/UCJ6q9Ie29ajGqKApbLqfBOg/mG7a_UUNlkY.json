[
  {
    "text": "conduit Comcast Intel download Center Accenture Mecha service while some of",
    "start": "1600",
    "end": "9480"
  },
  {
    "text": "these names might seem familiar and some may not but all of these websites and many many many others have in common is",
    "start": "9480",
    "end": "17119"
  },
  {
    "text": "the fact that they're all built on the foundations of modern web application",
    "start": "17119",
    "end": "22199"
  },
  {
    "text": "Frameworks Frameworks such as.net and mono Frameworks that make use of",
    "start": "22199",
    "end": "27840"
  },
  {
    "text": "components called serers side web controls and that means that day and",
    "start": "27840",
    "end": "34040"
  },
  {
    "text": "other websites which are using the same Technologies may be vulnerable to the attack that I'm about to",
    "start": "34040",
    "end": "39960"
  },
  {
    "text": "present so hello everybody my name is Shai I'm the city of a group called hectics which is an advanced security",
    "start": "39960",
    "end": "47039"
  },
  {
    "text": "Center of erang hectics used to be privately held Boutique company but it was bought byang in",
    "start": "47039",
    "end": "52960"
  },
  {
    "text": "2011 and since then joined the worldwide group of erest and young security centers over the past three years h has",
    "start": "52960",
    "end": "60199"
  },
  {
    "text": "been involved in development of several midscale and large scale open source",
    "start": "60199",
    "end": "65360"
  },
  {
    "text": "open source projects and you can check them up online and I here to present a new open source project that hatic has",
    "start": "65360",
    "end": "71119"
  },
  {
    "text": "been developing for the past year or so which is currently nicknamed skip an",
    "start": "71119",
    "end": "76240"
  },
  {
    "text": "acronym that stands for Server control invisibility Purge an oasp zap extension",
    "start": "76240",
    "end": "82720"
  },
  {
    "text": "designed specifically to assess the security of asp.net and mono and do need",
    "start": "82720",
    "end": "90040"
  },
  {
    "text": "with it now instead of diving to the mechanics of this attack directly I want to give you a short demonstration that",
    "start": "90040",
    "end": "96759"
  },
  {
    "text": "really emphasizes exactly what is this attack what does it do and how do we as",
    "start": "96759",
    "end": "101880"
  },
  {
    "text": "pent testers benefit from it so what you see in our nice",
    "start": "101880",
    "end": "109000"
  },
  {
    "text": "application our nice demo application is how two users view the",
    "start": "109000",
    "end": "114600"
  },
  {
    "text": "application view the same page in the same application on the left side you see how an admin",
    "start": "114600",
    "end": "120759"
  },
  {
    "text": "user a high privileged user views the application and on the right side you see how a low privileged US user views",
    "start": "120759",
    "end": "127280"
  },
  {
    "text": "the same application and you'll notice that the admin user has an extra button the red button which initializes account",
    "start": "127280",
    "end": "134879"
  },
  {
    "text": "passwords now if we check the HTML of the admin the admin presentation you'll",
    "start": "134879",
    "end": "140680"
  },
  {
    "text": "see that the name of that button is button two okay and if we'll search for the same button in the low privilege",
    "start": "140680",
    "end": "148239"
  },
  {
    "text": "user presentation you see that it doesn't exist there isn't such a button",
    "start": "148239",
    "end": "153480"
  },
  {
    "text": "which means that sp. net doesn't even renders the button in the client side presentation however using a tool such",
    "start": "153480",
    "end": "161440"
  },
  {
    "text": "as skip simply by calling zap proxy while the skip extension is installed",
    "start": "161440",
    "end": "168080"
  },
  {
    "text": "you can immediately see that this page contains an invisible control which is",
    "start": "168080",
    "end": "174599"
  },
  {
    "text": "exploitable furthermore by right clicking on the page and activating skip in a matter of",
    "start": "174599",
    "end": "182440"
  },
  {
    "text": "seconds you can enumerate the name of the server s control and execute the",
    "start": "182440",
    "end": "189560"
  },
  {
    "text": "server side event which is an administrative event Associated to that",
    "start": "189560",
    "end": "196840"
  },
  {
    "text": "control B statements I know but by the end of this presentation you'll",
    "start": "197720",
    "end": "203280"
  },
  {
    "text": "understand why it's all to now this feature initialized the password of users and that's exactly what would have",
    "start": "203280",
    "end": "209200"
  },
  {
    "text": "happened if I would have ex would have executed that same operation for from",
    "start": "209200",
    "end": "214519"
  },
  {
    "text": "the admin interface okay so what do we have here we have a collection of attack that",
    "start": "214519",
    "end": "222080"
  },
  {
    "text": "we currently classify under the name ODC execution of dormant server side events",
    "start": "222080",
    "end": "228879"
  },
  {
    "text": "and controls and what can we do with it well we can execute operations or",
    "start": "228879",
    "end": "235040"
  },
  {
    "text": "activities that were designed for high privileged users such as administrators we can gain access to dment code in sp.",
    "start": "235040",
    "end": "244159"
  },
  {
    "text": "net mono and similar applications that was designed for testing purposes it may be vulnerable to attacks that the rest",
    "start": "244159",
    "end": "250519"
  },
  {
    "text": "of the application is not vulnerable to so we might have a button which is a test feature button or whatever which is",
    "start": "250519",
    "end": "257959"
  },
  {
    "text": "a vulnerable to es injection the rest of of the application is not vulnerable to it and the developer decided to protect",
    "start": "257959",
    "end": "264320"
  },
  {
    "text": "that button by turning it invisible we'll be able to detect it and exploit it and execute the event itself we can",
    "start": "264320",
    "end": "270600"
  },
  {
    "text": "gain access to testing features that can corrupt the data and so on and so on and so on so where does ADC where does this",
    "start": "270600",
    "end": "278919"
  },
  {
    "text": "attack fit in the puzzle D is penetration testing these days modern web",
    "start": "278919",
    "end": "284800"
  },
  {
    "text": "application Frameworks such as SP and mono have a lot going for them in terms of security let's take asp.net for",
    "start": "284800",
    "end": "291960"
  },
  {
    "text": "example as.net has numerous security features it has the event validation",
    "start": "291960",
    "end": "298440"
  },
  {
    "text": "mechanism that can turn given a simple parameter manipulation attack into a nearly impossible task it has digital",
    "start": "298440",
    "end": "304840"
  },
  {
    "text": "signatures and mac message authentication code that can prevent the attacker or the potential attacker from",
    "start": "304840",
    "end": "311199"
  },
  {
    "text": "sending values from the client side that the developer did not intend him to send there's built-in regular expressions in",
    "start": "311199",
    "end": "317800"
  },
  {
    "text": "controls there's a built-in xss filter that prevents most of the xss pedots from actually working so we as pent",
    "start": "317800",
    "end": "326039"
  },
  {
    "text": "testers need an edge when assessing the security of those PL platforms and I believe that that edge is the increased",
    "start": "326039",
    "end": "333199"
  },
  {
    "text": "a stack surface that this application have while normal standard web",
    "start": "333199",
    "end": "338360"
  },
  {
    "text": "application platform such as sp3 PHP have entry points such as web pages web",
    "start": "338360",
    "end": "344759"
  },
  {
    "text": "service methods and Global modules such as filters reach web applications modern",
    "start": "344759",
    "end": "351400"
  },
  {
    "text": "web application Frameworks Frameworks with server side web controls such as sp. net and mono have an additional",
    "start": "351400",
    "end": "358520"
  },
  {
    "text": "independent entry point and that's the events Associated to server side web",
    "start": "358520",
    "end": "365319"
  },
  {
    "text": "controls so what is a serers side web control a server side web control in",
    "start": "365319",
    "end": "371720"
  },
  {
    "text": "general is a control a server side control which is implemented in both the",
    "start": "371720",
    "end": "377319"
  },
  {
    "text": "client side and the server side in the client side it's usually represented in",
    "start": "377319",
    "end": "382440"
  },
  {
    "text": "some sort of HTML or control or set of HTML controls and in the server",
    "start": "382440",
    "end": "387880"
  },
  {
    "text": "side it's a Associated to a separated code segment a separated event which is",
    "start": "387880",
    "end": "394720"
  },
  {
    "text": "independent from the rest of the page or almost independent so the way it's",
    "start": "394720",
    "end": "400160"
  },
  {
    "text": "implemented the client side will have some sort of HTML control that has a",
    "start": "400160",
    "end": "405680"
  },
  {
    "text": "JavaScript event that calls the do Post back or the call back method which in turn will send three parameters to the",
    "start": "405680",
    "end": "413800"
  },
  {
    "text": "server or mainly three parameters the event Target which generally states which controls to execute the event",
    "start": "413800",
    "end": "421560"
  },
  {
    "text": "argument which generally states which arguments to deliver to the server side",
    "start": "421560",
    "end": "426759"
  },
  {
    "text": "event and the view state which is a base 64 serialized object that contains all",
    "start": "426759",
    "end": "434160"
  },
  {
    "text": "the properties that the page originally had now this field has a Mac on it a m",
    "start": "434160",
    "end": "442360"
  },
  {
    "text": "message authentication code which is designed to prevent users from altering the content of it it's like a signature",
    "start": "442360",
    "end": "449759"
  },
  {
    "text": "okay and to actually Implement that protection the platform has an optional",
    "start": "449759",
    "end": "455479"
  },
  {
    "text": "feature called the event validation now the event validation is another hidden HTML field which is very similar in",
    "start": "455479",
    "end": "463080"
  },
  {
    "text": "structure to the view State field it's a base 64 serialized object but this time",
    "start": "463080",
    "end": "469159"
  },
  {
    "text": "instead of containing Properties or values it contains the hash codes of",
    "start": "469159",
    "end": "474520"
  },
  {
    "text": "every single visible control presented to the user so any visible control",
    "start": "474520",
    "end": "481120"
  },
  {
    "text": "control that isn't is visible will have its hash code included in the event validation field in addition to the hash",
    "start": "481120",
    "end": "488360"
  },
  {
    "text": "code of the view State itself okay which is the first one here",
    "start": "488360",
    "end": "493720"
  },
  {
    "text": "now this field also by default has a Mac on it so nobody will temper with it and",
    "start": "493720",
    "end": "500039"
  },
  {
    "text": "that's really the main difference net has against the execution of",
    "start": "500039",
    "end": "505960"
  },
  {
    "text": "invisible events events associated with invisible controls so if I'm trying to",
    "start": "505960",
    "end": "512039"
  },
  {
    "text": "send the name of a button in the event Target to execute its event and I don't see that button in my presentation layer",
    "start": "512039",
    "end": "519599"
  },
  {
    "text": "net will know that that event is unauthorized because the hash code will not appear in theet validation okay and",
    "start": "519599",
    "end": "528240"
  },
  {
    "text": "I am not supposed to be able to alter that content due to the mac and that's",
    "start": "528240",
    "end": "533680"
  },
  {
    "text": "was the first punchline of this presentation comes into place since that actual format causes the platform to",
    "start": "533680",
    "end": "540959"
  },
  {
    "text": "reveal the existence of invisible controls when there isn't any invisible",
    "start": "540959",
    "end": "547640"
  },
  {
    "text": "control in sp. net and mono the viewed feed won't contain anything interesting",
    "start": "547640",
    "end": "552680"
  },
  {
    "text": "however when some control is turned invisible using Code level assignments",
    "start": "552680",
    "end": "558040"
  },
  {
    "text": "server side code level assignments The View state will contain a visible equal false property and you can actually know",
    "start": "558040",
    "end": "565640"
  },
  {
    "text": "how many invisible controls the page has not only that it it contains visible or",
    "start": "565640",
    "end": "571160"
  },
  {
    "text": "invisible or disabled controls okay so simply by using skip to CW the",
    "start": "571160",
    "end": "577760"
  },
  {
    "text": "application you'll get exactly which Pages have invisible",
    "start": "577760",
    "end": "584120"
  },
  {
    "text": "controls in them and you we exploit exactly that behavior to tell you which",
    "start": "584120",
    "end": "590560"
  },
  {
    "text": "uh Pages have such controls so what is an invisible control",
    "start": "590560",
    "end": "596640"
  },
  {
    "text": "what do we consider to be a dormant event there's several archetypes okay",
    "start": "596640",
    "end": "602480"
  },
  {
    "text": "and we're going to go over them just so we'll know what we're going to crack later on okay so the simplest form of an",
    "start": "602480",
    "end": "609279"
  },
  {
    "text": "invisible control which isn't really invisible is a commented out control a commented out control I mean html",
    "start": "609279",
    "end": "616240"
  },
  {
    "text": "commented out control is generally any server side control in which the developer placed HTML comments before",
    "start": "616240",
    "end": "623079"
  },
  {
    "text": "that okay before the control place the control in the context of an HTML comment but there's plenty of reasons",
    "start": "623079",
    "end": "629240"
  },
  {
    "text": "developers do that they want to delete the controll and they don't understand that net ignores HTML comments and",
    "start": "629240",
    "end": "636800"
  },
  {
    "text": "renders the control both in the client side and the server side normally the second type is more dormant than",
    "start": "636800",
    "end": "644480"
  },
  {
    "text": "invisible that's a disabled control and I mean server side disabled control okay",
    "start": "644480",
    "end": "650360"
  },
  {
    "text": "and that's generally control that had the enabled property set to false in the server side and that causes a number of",
    "start": "650360",
    "end": "657600"
  },
  {
    "text": "things to happen a the control is grade out it has the disabled property in the",
    "start": "657600",
    "end": "663560"
  },
  {
    "text": "client side on okay and you can't click it and even if we delete the disabled property that control is not associated",
    "start": "663560",
    "end": "670880"
  },
  {
    "text": "as you see to a doost back ho there isn't any JavaScript event so even if we",
    "start": "670880",
    "end": "675959"
  },
  {
    "text": "click it nothing happens or nothing happens in the client side at least Okay",
    "start": "675959",
    "end": "681079"
  },
  {
    "text": "the third type is the real deal that it's that's a truly invisible control a control that had the visible property",
    "start": "681079",
    "end": "688160"
  },
  {
    "text": "turned or turn to false in the server side and that control isn't even rendered in the client side except for",
    "start": "688160",
    "end": "694680"
  },
  {
    "text": "the disclosure in the view State I just demonstrated okay the last type is an",
    "start": "694680",
    "end": "700639"
  },
  {
    "text": "optional event of an existing control certain sp. net controls can be",
    "start": "700639",
    "end": "706680"
  },
  {
    "text": "Associated to more than one server event take calendar for example the calendar",
    "start": "706680",
    "end": "711880"
  },
  {
    "text": "control can be Associated to two events change month and change day okay so in",
    "start": "711880",
    "end": "718720"
  },
  {
    "text": "general General to abuse this functionality to execute ODC attacks we",
    "start": "718720",
    "end": "724160"
  },
  {
    "text": "generally play around with discs okay we play around with the various features of dormant and invisible server controls",
    "start": "724160",
    "end": "731440"
  },
  {
    "text": "and the simplest method to begin with is of course on commenting them the first",
    "start": "731440",
    "end": "737720"
  },
  {
    "text": "type of invisible control was a commented out control and that's not really invisible and the simplest thing",
    "start": "737720",
    "end": "743519"
  },
  {
    "text": "you can do to cck it is simply to uncomment it now that attack will work",
    "start": "743519",
    "end": "748920"
  },
  {
    "text": "regardless of the view State Mark and regardless of the event validation mechanism so let's see a live example",
    "start": "748920",
    "end": "754920"
  },
  {
    "text": "let's use be proxy in this demonstration so w think I'm completely sold out only",
    "start": "754920",
    "end": "760240"
  },
  {
    "text": "on oap okay I'm being fair here",
    "start": "760240",
    "end": "765880"
  },
  {
    "text": "so I have a page here that contains a commented out control I'm going to follow the communication through burp",
    "start": "765880",
    "end": "773279"
  },
  {
    "text": "and intercept it okay just so I'll be able to",
    "start": "773279",
    "end": "779600"
  },
  {
    "text": "remove the HTML comments of the surrounding the control in the response",
    "start": "779600",
    "end": "785600"
  },
  {
    "text": "and you'll immediately see that a yellow control was added to the presentation",
    "start": "785600",
    "end": "790920"
  },
  {
    "text": "layer before I'm going to execute that yellow control I'm going to show you just to verify that that page the first",
    "start": "790920",
    "end": "799199"
  },
  {
    "text": "page page one section one had has the event validation feature on and the view",
    "start": "799199",
    "end": "804720"
  },
  {
    "text": "State feature on okay view State Mark and executing that commented out event",
    "start": "804720",
    "end": "810959"
  },
  {
    "text": "will still work okay nice neat trick but that's honestly not really considered",
    "start": "810959",
    "end": "818079"
  },
  {
    "text": "hacking it becomes a bit more interesting in the second type which is a disabled",
    "start": "818079",
    "end": "824959"
  },
  {
    "text": "control so when trying to uh defeat the",
    "start": "830279",
    "end": "835920"
  },
  {
    "text": "disability property okay we have to do something with which is very similar to uncommenting controls but this time we",
    "start": "835920",
    "end": "842639"
  },
  {
    "text": "have to forge a doost back call in advance in addition to that now that",
    "start": "842639",
    "end": "848759"
  },
  {
    "text": "attack works again regardless of the view State Mark and the event validation",
    "start": "848759",
    "end": "854519"
  },
  {
    "text": "mechanis mechanism that's because the this ability feature isn't really",
    "start": "854519",
    "end": "860279"
  },
  {
    "text": "supposed to be a security feature it works in s.net cleanly and it works in mono if you delete the view State field",
    "start": "860279",
    "end": "868000"
  },
  {
    "text": "completely okay so let's see that in action we'll",
    "start": "868000",
    "end": "873160"
  },
  {
    "text": "do the same attack using burp in the same page there's a button here which is",
    "start": "873160",
    "end": "878440"
  },
  {
    "text": "disabled the send event notification button you're going to forward the communication to burp again",
    "start": "878440",
    "end": "884880"
  },
  {
    "text": "okay and in the response we're going to delete the disabled property so it won't",
    "start": "884880",
    "end": "891959"
  },
  {
    "text": "be disabled from both the text box and the button and we going we're going to",
    "start": "891959",
    "end": "897440"
  },
  {
    "text": "forge a doos back all and that's not really as complicated as it sounds all you have to do is generally copy and",
    "start": "897440",
    "end": "903399"
  },
  {
    "text": "onclick event and instead of sending the original name of the control you're going to send the name of the current",
    "start": "903399",
    "end": "909320"
  },
  {
    "text": "control in this case button three okay just by doing that despite the fact that",
    "start": "909320",
    "end": "915160"
  },
  {
    "text": "event validation is active and view State Market is active the server side",
    "start": "915160",
    "end": "920759"
  },
  {
    "text": "event Associated to that to that control will",
    "start": "920759",
    "end": "925920"
  },
  {
    "text": "work okay piece of cake now we can do that",
    "start": "925959",
    "end": "931120"
  },
  {
    "text": "manually or we can do skip skip the same way it detects invisible controls",
    "start": "931120",
    "end": "936800"
  },
  {
    "text": "detects commented out controls and disabled controls okay right clicking on a page will present exactly which",
    "start": "936800",
    "end": "944199"
  },
  {
    "text": "controls which are that are commented or disabled it contains and we'll be able to execute their event okay the same",
    "start": "944199",
    "end": "952800"
  },
  {
    "text": "way it becomes much more difficult to perform",
    "start": "952800",
    "end": "958040"
  },
  {
    "text": "those attacks when we're facing an invisible control which is a much tougher opponent in",
    "start": "958040",
    "end": "965279"
  },
  {
    "text": "general so the invisible control or the invisible property is the real deal",
    "start": "970279",
    "end": "977560"
  },
  {
    "text": "that's what actually was supposed to be a security feature in.net and mono okay",
    "start": "977560",
    "end": "982720"
  },
  {
    "text": "nobody relied on commented out controls or disabled controls nobody educated Developers for years to use the disabled",
    "start": "982720",
    "end": "990240"
  },
  {
    "text": "properties however we did educate Developers for years to use the visible property for security and there are many",
    "start": "990240",
    "end": "999120"
  },
  {
    "text": "ways in which we can execute invisible controls but let's start with the simplest ways and that's when one of the",
    "start": "999120",
    "end": "1006120"
  },
  {
    "text": "security features that net already has is disabled if you remember earlier I",
    "start": "1006120",
    "end": "1011600"
  },
  {
    "text": "discussed two main security features The View State Mac and the event validation both designed specifically to to prevent",
    "start": "1011600",
    "end": "1019240"
  },
  {
    "text": "attacks such as execution of in events that are associated to Invisible controls what happens when one of those",
    "start": "1019240",
    "end": "1026959"
  },
  {
    "text": "features is disabled so let's start with the first scenario in which the event",
    "start": "1026959",
    "end": "1032199"
  },
  {
    "text": "validation is on and the view State Mark is off the event validation is off and the view State Mark is on if the event",
    "start": "1032199",
    "end": "1039678"
  },
  {
    "text": "validation is on it doesn't really matter that there's a Mac because the server doesn't perform any verification",
    "start": "1039679",
    "end": "1047079"
  },
  {
    "text": "we've just disabled it so the attack will be very similar to what we did with",
    "start": "1047079",
    "end": "1052360"
  },
  {
    "text": "disabled controls just instead of forging an event we'll Forge an entire",
    "start": "1052360",
    "end": "1057600"
  },
  {
    "text": "control let's see that in action let's do the same let's take a",
    "start": "1057600",
    "end": "1062919"
  },
  {
    "text": "page that has the mark enabled and the event",
    "start": "1062919",
    "end": "1069640"
  },
  {
    "text": "validation disabled let's verify that in the code page number three event",
    "start": "1069640",
    "end": "1075039"
  },
  {
    "text": "validation disabled Mac enabled okay we're going to intercept the request",
    "start": "1075039",
    "end": "1081880"
  },
  {
    "text": "intercept the response and add an entire control now assuming we guessed the name",
    "start": "1081880",
    "end": "1087799"
  },
  {
    "text": "of the control and I'm going to get to how later on there's a very good way to",
    "start": "1087799",
    "end": "1092919"
  },
  {
    "text": "Guess that name assuming we guess that there is an",
    "start": "1092919",
    "end": "1098559"
  },
  {
    "text": "invisible button to in this page all we have to do is really Forge an entire control with a do Post",
    "start": "1098559",
    "end": "1105039"
  },
  {
    "text": "back proper IDs and some sort of alas",
    "start": "1105039",
    "end": "1110360"
  },
  {
    "text": "that will recognize such as evil evil evil okay the only thing we have left to do",
    "start": "1110360",
    "end": "1115840"
  },
  {
    "text": "is click it and since the event validation is off there isn't any server side",
    "start": "1115840",
    "end": "1121520"
  },
  {
    "text": "verification and the attack is performed normally if we do the same from the admin",
    "start": "1121520",
    "end": "1127520"
  },
  {
    "text": "browser we'll get the same result okay so that's the first method",
    "start": "1127520",
    "end": "1134760"
  },
  {
    "text": "and it's pretty common because there's plenty of reasons that developers disable the event validation field like",
    "start": "1134760",
    "end": "1142600"
  },
  {
    "text": "anytime a developer wants to make a list box or a combo box which is a server",
    "start": "1142600",
    "end": "1148200"
  },
  {
    "text": "side control more Dynamic alter the content from the client side without sending the request to the server he'll",
    "start": "1148200",
    "end": "1154760"
  },
  {
    "text": "need to disable the event validation many templates in the internet that Implement custom control actually",
    "start": "1154760",
    "end": "1160799"
  },
  {
    "text": "disable the event validation in those controls and that's in the entire page and so on and so on but the complex the",
    "start": "1160799",
    "end": "1167960"
  },
  {
    "text": "the process becomes much much more complicated when it's the other way around when the event validation is on",
    "start": "1167960",
    "end": "1175880"
  },
  {
    "text": "but the view State Mark is off if the event validation in on is on it means that net verifies the structure of the",
    "start": "1175880",
    "end": "1183480"
  },
  {
    "text": "event validation feed it verifies that the type or name of control that we sent",
    "start": "1183480",
    "end": "1189640"
  },
  {
    "text": "from the client side the hash code of that control is included in the event validation field so in order to actually",
    "start": "1189640",
    "end": "1195840"
  },
  {
    "text": "execute the server side event of an invisible control will need to reconstruct the event validation field",
    "start": "1195840",
    "end": "1202440"
  },
  {
    "text": "now obviously I don't see many pentesters these days that do that manually I mean Computing the hash code",
    "start": "1202440",
    "end": "1208840"
  },
  {
    "text": "of every control you want to execute that's a tough that's a tough job even if you know the formula okay however",
    "start": "1208840",
    "end": "1215400"
  },
  {
    "text": "skip that does that for us we can use a tool such as skip to",
    "start": "1215400",
    "end": "1222120"
  },
  {
    "text": "immediately recompute The View State field for us and the event validation field by accessing a page that has the",
    "start": "1222120",
    "end": "1230679"
  },
  {
    "text": "event validation turned on and the view State mark off okay skip already",
    "start": "1230679",
    "end": "1237400"
  },
  {
    "text": "identifies those scenarios we can enumerate the name of the control and I'm going to touch on that in a",
    "start": "1237400",
    "end": "1242919"
  },
  {
    "text": "second and Skip will recompute the event validation field for",
    "start": "1242919",
    "end": "1249320"
  },
  {
    "text": "us and include the name we're trying to execute within it so the platform when",
    "start": "1249320",
    "end": "1254400"
  },
  {
    "text": "it verifies the event validation fields we field will execute the event since there's no",
    "start": "1254400",
    "end": "1261640"
  },
  {
    "text": "Mark there's no actual signature we'll be able to do that okay so how do we",
    "start": "1261640",
    "end": "1268320"
  },
  {
    "text": "actually enumerate the name of the control that",
    "start": "1268320",
    "end": "1273400"
  },
  {
    "text": "process can rely on another very interesting net Behavior which is",
    "start": "1273400",
    "end": "1279640"
  },
  {
    "text": "actually I don't know it's pre-ordered I guess we couldn't have hoped for anything better net has a very",
    "start": "1279640",
    "end": "1286360"
  },
  {
    "text": "interesting behavior when you send the name of a control that exists in the",
    "start": "1286360",
    "end": "1291559"
  },
  {
    "text": "page is invisible and you're not permitted to execute it net will draw an",
    "start": "1291559",
    "end": "1297480"
  },
  {
    "text": "exception okay let's see that behavior in action if we have a page",
    "start": "1297480",
    "end": "1303440"
  },
  {
    "text": "let's say page two okay it had has the event validation turned on okay we intercept the",
    "start": "1303440",
    "end": "1312840"
  },
  {
    "text": "request right now and execute a control that we're not supposed to execute button two burp doesn't reconstruct the",
    "start": "1312840",
    "end": "1319679"
  },
  {
    "text": "event validation field okay remember button two is an invisible control I cannot see and is not included in the",
    "start": "1319679",
    "end": "1325840"
  },
  {
    "text": "event validation field and what net will respond with is an exception an invalid",
    "start": "1325840",
    "end": "1331840"
  },
  {
    "text": "postback exception to be EXA however if I'm going to try and execute a control",
    "start": "1331840",
    "end": "1337480"
  },
  {
    "text": "that does not exist in the page at all such as part my German button",
    "start": "1337480",
    "end": "1345360"
  },
  {
    "text": "999999999 okay nothing going to happen there won't be any exception whatsoever",
    "start": "1345360",
    "end": "1352559"
  },
  {
    "text": "so we're actually able to abuse this Behavior to know it exactly what's the name of the control and net actually",
    "start": "1352559",
    "end": "1359440"
  },
  {
    "text": "makes it even easier for us due to the existence of naming conventions we're",
    "start": "1359440",
    "end": "1364760"
  },
  {
    "text": "going to touch on that later on even if there isn't any error based response we",
    "start": "1364760",
    "end": "1370880"
  },
  {
    "text": "can still enumerate the existence of specific controls using a blind approach",
    "start": "1370880",
    "end": "1376760"
  },
  {
    "text": "just by comparing the responses in a similar way to what crowbar or jba do do",
    "start": "1376760",
    "end": "1382960"
  },
  {
    "text": "those of you are who know those tools okay now um the naming Convention of as.net",
    "start": "1382960",
    "end": "1391880"
  },
  {
    "text": "makes it very easy as for us to execute those events now remember if we executed",
    "start": "1391880",
    "end": "1399120"
  },
  {
    "text": "an event or enumerated its existing using the error based approach there isn't any risk because we haven't",
    "start": "1399120",
    "end": "1405200"
  },
  {
    "text": "actually executed the event we just found out it's it's there but when we do it in a blind approach there is some",
    "start": "1405200",
    "end": "1412240"
  },
  {
    "text": "sort of risk in in the perspective of testing because we execute the event so if it deletes the database or whatever",
    "start": "1412240",
    "end": "1418600"
  },
  {
    "text": "whatever the cause does that enumeration method will cause it to actually happen now the naming convention in in net is",
    "start": "1418600",
    "end": "1425799"
  },
  {
    "text": "very simple that makes the process even simpler than running a tool such as deerb deerb which enumerates the files",
    "start": "1425799",
    "end": "1432960"
  },
  {
    "text": "and directories okay since the naming Convention of controls by default is the",
    "start": "1432960",
    "end": "1438159"
  },
  {
    "text": "type and some sort of some sort of sequential number such as button one button two button three text box one",
    "start": "1438159",
    "end": "1444360"
  },
  {
    "text": "text box two ITC okay and even if it gets more complicated such as in certain",
    "start": "1444360",
    "end": "1451400"
  },
  {
    "text": "versions in net or when you use a Master page the convention is still something",
    "start": "1451400",
    "end": "1457159"
  },
  {
    "text": "that we can predict and in the worst case scenario when it's a custom convention we simply",
    "start": "1457159",
    "end": "1463559"
  },
  {
    "text": "do dictionary attack just like we do in Deer Buster nothing that is impossible so it's a lot easier to enumerate those",
    "start": "1463559",
    "end": "1470600"
  },
  {
    "text": "controls so what do we have for so far so far we executed the events of",
    "start": "1470600",
    "end": "1476720"
  },
  {
    "text": "commented out controls and disabled controls when all the security features were turned on and we executed the",
    "start": "1476720",
    "end": "1484000"
  },
  {
    "text": "events of invisible controls when the protection mechanisms when one of the",
    "start": "1484000",
    "end": "1490919"
  },
  {
    "text": "protection mechanisms was turned off the the same applies to optional event of",
    "start": "1490919",
    "end": "1497120"
  },
  {
    "text": "optional events of controls the same restrictions well if we'll take an event",
    "start": "1497120",
    "end": "1503159"
  },
  {
    "text": "of a control which is associated with more than one event such as a calendar event the only difference is that we'll",
    "start": "1503159",
    "end": "1509600"
  },
  {
    "text": "have to fuz an additional parameter okay so far we fed the event Target parameter",
    "start": "1509600",
    "end": "1516279"
  },
  {
    "text": "which signifies which control to execute when trying to select which event to",
    "start": "1516279",
    "end": "1521360"
  },
  {
    "text": "execute we'll have to fast the event argument so in the calendar example when we'll send a capital V in the beginning",
    "start": "1521360",
    "end": "1529320"
  },
  {
    "text": "of the event argument parameter it will execute the change month event when you",
    "start": "1529320",
    "end": "1534720"
  },
  {
    "text": "will send it without a capital V it will change the it will execute the change Day event okay and the convention",
    "start": "1534720",
    "end": "1541120"
  },
  {
    "text": "obviously changes from one control to another so the problem here that so far",
    "start": "1541120",
    "end": "1547039"
  },
  {
    "text": "we had some serious restrictions although some of those misconfigurations are common we still are limited to",
    "start": "1547039",
    "end": "1553520"
  },
  {
    "text": "executing invisible controls only when the developer make made some sort of",
    "start": "1553520",
    "end": "1558840"
  },
  {
    "text": "serious M misconfiguration mistake okay but in reality I probably wouldn't be here in Black at presenting if I didn't",
    "start": "1558840",
    "end": "1565880"
  },
  {
    "text": "have any method to bypass that okay so some NE tricks for a nightmare mode okay",
    "start": "1565880",
    "end": "1572520"
  },
  {
    "text": "some NE tricks for a nightmare mode the a mode in which all the security features are turned on both the view",
    "start": "1572520",
    "end": "1579640"
  },
  {
    "text": "State Mac and the event validation there's a couple of ways to bypass those",
    "start": "1579640",
    "end": "1585039"
  },
  {
    "text": "security mechanisms and one of those it actually relies on a vulnerability that",
    "start": "1585039",
    "end": "1590880"
  },
  {
    "text": "all of us classify as a low severity vulnerability caching those of you who perform",
    "start": "1590880",
    "end": "1597760"
  },
  {
    "text": "penetration testing and deliver reports to customer usually put that way below in your findings tables okay and caching",
    "start": "1597760",
    "end": "1606200"
  },
  {
    "text": "actually in net contains a very very interesting information for us as",
    "start": "1606200",
    "end": "1611640"
  },
  {
    "text": "hackers when a page is cashed either in the browser of an administrative user or",
    "start": "1611640",
    "end": "1617159"
  },
  {
    "text": "in an indexed page it was indexed by Google or Wayback machine or whatever or",
    "start": "1617159",
    "end": "1622640"
  },
  {
    "text": "in a proxy which is somewhere along the way just by getting the view State and",
    "start": "1622640",
    "end": "1628679"
  },
  {
    "text": "the vent H argument fields of another user of or of an obsolete version of the",
    "start": "1628679",
    "end": "1634840"
  },
  {
    "text": "page in which the control was",
    "start": "1634840",
    "end": "1639158"
  },
  {
    "text": "visible we are able to um do something very interesting we are",
    "start": "1640159",
    "end": "1646480"
  },
  {
    "text": "able to replace our own Fields with the fields of the other user",
    "start": "1646480",
    "end": "1651640"
  },
  {
    "text": "of the or of the obsolete page and we'll be able to execute any control that user",
    "start": "1651640",
    "end": "1658399"
  },
  {
    "text": "was able to execute in our context let's see that in action again if you have the",
    "start": "1658399",
    "end": "1664640"
  },
  {
    "text": "admin page right here okay let's go to a page it has all",
    "start": "1664640",
    "end": "1671399"
  },
  {
    "text": "the security features turned on page one let's hope the demo will work this",
    "start": "1671399",
    "end": "1676519"
  },
  {
    "text": "time this page page one has all the security",
    "start": "1676519",
    "end": "1682240"
  },
  {
    "text": "features turned on let's just verify that event validation true Mac true and",
    "start": "1682240",
    "end": "1688360"
  },
  {
    "text": "we won't steal that user session instead we'll steal the event validation field",
    "start": "1688360",
    "end": "1694799"
  },
  {
    "text": "and view State Mark field from the cache something we can do in a number of ways even using application Level attack such",
    "start": "1694799",
    "end": "1700600"
  },
  {
    "text": "as click jacking course side scripting Whatever by gaining those fields and",
    "start": "1700600",
    "end": "1706000"
  },
  {
    "text": "replacing my own field with",
    "start": "1706000",
    "end": "1709760"
  },
  {
    "text": "them I'll be able to execute anything any control in the same page that that",
    "start": "1711240",
    "end": "1717240"
  },
  {
    "text": "me can let's intercept the response again",
    "start": "1717240",
    "end": "1723039"
  },
  {
    "text": "to that page let's replace the view State field",
    "start": "1723039",
    "end": "1728240"
  },
  {
    "text": "and the event validation field that I currently have with those I I got from the admin",
    "start": "1728240",
    "end": "1735278"
  },
  {
    "text": "cach",
    "start": "1736399",
    "end": "1739399"
  },
  {
    "text": "you'll notice the view state of the admin is much smaller because there isn't any visible equal false",
    "start": "1746679",
    "end": "1752840"
  },
  {
    "text": "property we'll replace the event validation field the same way this time it will be a bit",
    "start": "1752840",
    "end": "1760679"
  },
  {
    "text": "bigger okay now all we really have to do",
    "start": "1760679",
    "end": "1768960"
  },
  {
    "text": "is execute the event that we plan to execute we're going to execute button",
    "start": "1768960",
    "end": "1776000"
  },
  {
    "text": "two and voila the server side operation is being performed simply by stealing",
    "start": "1781399",
    "end": "1787360"
  },
  {
    "text": "somebody's cash okay but then again I have to steal somebody's cash I have to",
    "start": "1787360",
    "end": "1792519"
  },
  {
    "text": "go and get the cash from an index page in Google that's a lot of work it can be",
    "start": "1792519",
    "end": "1798080"
  },
  {
    "text": "even simpler than that if the developer is using something gold called callbacks",
    "start": "1798080",
    "end": "1804919"
  },
  {
    "text": "instead of postbacks callbacks is a very similar mechanism to a postback mechanism only there's a couple of",
    "start": "1804919",
    "end": "1811480"
  },
  {
    "text": "differences a the Callback ID and callback param parameters are used instead of the event Target and event",
    "start": "1811480",
    "end": "1818159"
  },
  {
    "text": "argument and they mean the same generally me callback ID is which control event and call back param is",
    "start": "1818159",
    "end": "1823960"
  },
  {
    "text": "which parameters to deliver to that event however in the case of callbacks the developer",
    "start": "1823960",
    "end": "1830360"
  },
  {
    "text": "is actually implementing the entire callback event in the server side including the event validation so if for",
    "start": "1830360",
    "end": "1838320"
  },
  {
    "text": "whatever reason he wanted to make list box or the combo boxes Dynamic he had some exception in for the Advent",
    "start": "1838320",
    "end": "1845240"
  },
  {
    "text": "validation feature is the one causing them if the developer either comments or delete the code level validation the",
    "start": "1845240",
    "end": "1853399"
  },
  {
    "text": "attack will work regardless of any configuration in that page so we may see",
    "start": "1853399",
    "end": "1859399"
  },
  {
    "text": "a page that has the event validation active and the H view State ma active",
    "start": "1859399",
    "end": "1865039"
  },
  {
    "text": "but since the developer is using callbacks and disable some sort of line",
    "start": "1865039",
    "end": "1870559"
  },
  {
    "text": "of code the attack will still work we'll be able to execute the events of invisible controls despite any security",
    "start": "1870559",
    "end": "1877880"
  },
  {
    "text": "mechanism that the system has which means that in real life scenarios",
    "start": "1877880",
    "end": "1883320"
  },
  {
    "text": "honestly I don't see how invisible controls can really survive an encounter with a real real life",
    "start": "1883320",
    "end": "1891158"
  },
  {
    "text": "hacker yep so that was IDK fa by the way how only people know what that is ID KFA",
    "start": "1906440",
    "end": "1912279"
  },
  {
    "text": "hands up oh not many Doom fans T tough audience so anyway so what can we do to",
    "start": "1912279",
    "end": "1920039"
  },
  {
    "text": "mitigate the risk from these controls in any platform sp. net or whatever by the way two weeks before the conference we",
    "start": "1920039",
    "end": "1926519"
  },
  {
    "text": "prove that this technology works as is on JSF as well okay I have demo movies here I won't probably won't have time to",
    "start": "1926519",
    "end": "1932600"
  },
  {
    "text": "to show them but anyone that wants to see them can come and talk to me later on so in order to mitigate the risk for",
    "start": "1932600",
    "end": "1939559"
  },
  {
    "text": "uh from this attack we can do a number of FS a we cannot rely on the security",
    "start": "1939559",
    "end": "1945559"
  },
  {
    "text": "of disabled controls and the same thing applies for commented out controls it's not a security feature it wasn't really",
    "start": "1945559",
    "end": "1951960"
  },
  {
    "text": "designed to be a security feature okay and as a result we have to REM remove",
    "start": "1951960",
    "end": "1957159"
  },
  {
    "text": "any unnecessary dormant events from the page delete them the one of the most effective",
    "start": "1957159",
    "end": "1964320"
  },
  {
    "text": "counter measures we can do that's the fourth one is to implement code level",
    "start": "1964320",
    "end": "1969399"
  },
  {
    "text": "privilege validations in the event itself usually we perform privilege",
    "start": "1969399",
    "end": "1975240"
  },
  {
    "text": "validations at the upper section of a page but we can add an EV validation",
    "start": "1975240",
    "end": "1980559"
  },
  {
    "text": "code for privileges in each and every event of controls and that will H",
    "start": "1980559",
    "end": "1986960"
  },
  {
    "text": "prevent any single one of the attack instances as I presented just that just",
    "start": "1986960",
    "end": "1992399"
  },
  {
    "text": "doing that okay so that's probably the most efficient security measure that we",
    "start": "1992399",
    "end": "1998200"
  },
  {
    "text": "can take in addition it couldn't harm actually enabling net security uh",
    "start": "1998200",
    "end": "2004279"
  },
  {
    "text": "configurations such as enabling the ma and the validation which is what we supposed to do anyway and since caching",
    "start": "2004279",
    "end": "2011519"
  },
  {
    "text": "becomes a bigger issue in net it's probably wise to disable it in any page that contains code that can do",
    "start": "2011519",
    "end": "2018799"
  },
  {
    "text": "significant things okay so we can disable the cach for a browser or a proxy using the sample code you see here",
    "start": "2018799",
    "end": "2026279"
  },
  {
    "text": "and we might want to do the same for search engines by using the robots file",
    "start": "2026279",
    "end": "2031880"
  },
  {
    "text": "okay right here prevent them from crawling our application and indexing the various pages at least for platform",
    "start": "2031880",
    "end": "2038120"
  },
  {
    "text": "such as sp. net and mon okay so the skip",
    "start": "2038120",
    "end": "2043799"
  },
  {
    "text": "project can do a number of Fe for us in general we learned that we can always",
    "start": "2043799",
    "end": "2049118"
  },
  {
    "text": "execute the events of commented and disabled controls regardless of any security features except the code level",
    "start": "2049119",
    "end": "2056320"
  },
  {
    "text": "validations I just demonstrated okay I just presented we can do the same for invisible controls and optional events",
    "start": "2056320",
    "end": "2064158"
  },
  {
    "text": "when either the Mac or a the ma is disabled or the event validation disabled and we can even do that when",
    "start": "2064159",
    "end": "2072398"
  },
  {
    "text": "they are both enabled if either we can gain the cash of a high privileged user of of an obsolete version of the page",
    "start": "2072399",
    "end": "2079760"
  },
  {
    "text": "that had the controls or the developer made the Fatal mistake of using callbo",
    "start": "2079760",
    "end": "2085158"
  },
  {
    "text": "and disabling the event validation line okay in any one of those we can do that",
    "start": "2085159",
    "end": "2091480"
  },
  {
    "text": "there's an additional scenario we can do that in that I haven't presented in in this uh",
    "start": "2091480",
    "end": "2097640"
  },
  {
    "text": "H talk because it's a really farfetch if you have a shared hosting model we're",
    "start": "2097640",
    "end": "2102760"
  },
  {
    "text": "actually using the same machine key so if we have our own net application on a server that host several we can do the",
    "start": "2102760",
    "end": "2109200"
  },
  {
    "text": "same using the machine key okay but it's really farfetch so I won't discuss this one the skip project can be downloaded",
    "start": "2109200",
    "end": "2116240"
  },
  {
    "text": "from its Google code homepage and furthermore we can also go download it",
    "start": "2116240",
    "end": "2122359"
  },
  {
    "text": "from the neat new zap feature called Marketplace or zap has a buil-in",
    "start": "2122359",
    "end": "2129440"
  },
  {
    "text": "Marketplace for extensions you can actually check for updates download extensions and Skip is already in there",
    "start": "2129440",
    "end": "2135880"
  },
  {
    "text": "it's super convenient and I can't express how much I like this feature okay I can say plenty of things about it",
    "start": "2135880",
    "end": "2142160"
  },
  {
    "text": "but again I'm trying to be uh as objective as I can",
    "start": "2142160",
    "end": "2148000"
  },
  {
    "text": "okay so skip currently does a number of things it locates the the existence of a",
    "start": "2148000",
    "end": "2156200"
  },
  {
    "text": "invisible controls commented out controls and disabled controls in addition to that it enables us to",
    "start": "2156200",
    "end": "2161400"
  },
  {
    "text": "execute all those scenarios we have demonstrated and it even enumerates the",
    "start": "2161400",
    "end": "2166599"
  },
  {
    "text": "name of controls in error based scenarios and those dictionaries are files they're customizable you can",
    "start": "2166599",
    "end": "2172839"
  },
  {
    "text": "custom the files and check for additional instances that we haven't figured out H we have haven't thought of",
    "start": "2172839",
    "end": "2180560"
  },
  {
    "text": "however only in the next version we'll be able to do the blind numeration because we need to integrate the project",
    "start": "2180560",
    "end": "2186160"
  },
  {
    "text": "with and other project we we are currently developing with a feature that diviner has to really do a very good",
    "start": "2186160",
    "end": "2193520"
  },
  {
    "text": "blind de me method okay so in the next version we'll probably be able to enumerate using blide enumeration as",
    "start": "2193520",
    "end": "2200640"
  },
  {
    "text": "well okay those of you are interested in the subject I can highly recommend the",
    "start": "2200640",
    "end": "2206640"
  },
  {
    "text": "blog of James Jardine an awesome security expert it has plenty of amazing",
    "start": "2206640",
    "end": "2211880"
  },
  {
    "text": "content on the subject okay you got plenty of idas from James Jardine and the rest of them are",
    "start": "2211880",
    "end": "2217200"
  },
  {
    "text": "really things we discovered during the research and uh that's pretty much it pretty much it any",
    "start": "2217200",
    "end": "2224880"
  },
  {
    "text": "questions yes if you're doing the um cach reuse but the view stat en TI to",
    "start": "2224880",
    "end": "2231319"
  },
  {
    "text": "the session it break uh yes it will break okay but by default there isn't",
    "start": "2231319",
    "end": "2237760"
  },
  {
    "text": "any tie the developer has to implement the tie to the session ID okay okay that",
    "start": "2237760",
    "end": "2244520"
  },
  {
    "text": "can cause also that can also cause functional problems if you're using so such as a a mechanism such as persistent",
    "start": "2244520",
    "end": "2250960"
  },
  {
    "text": "cookie or whatever okay so there's number of reason why people want do that",
    "start": "2250960",
    "end": "2256119"
  },
  {
    "text": "any other questions was I that",
    "start": "2256119",
    "end": "2262000"
  },
  {
    "text": "good well thank you thank you very much everyone and enjoy the rest of the conference",
    "start": "2267880",
    "end": "2274960"
  }
]