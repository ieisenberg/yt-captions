[
  {
    "text": "all right hello and uh welcome everybody to my talk nakatomi space lateral",
    "start": "2280",
    "end": "8280"
  },
  {
    "text": "movement as level one post exploitation in operational technology so my name is yes wetzels and I'm a",
    "start": "8280",
    "end": "14820"
  },
  {
    "text": "security researcher with forescout where I focus on operational technology iot and embedded systems in general I joined",
    "start": "14820",
    "end": "21539"
  },
  {
    "text": "forescout in 2018 through the acquisition of security matters which is an OT focused cyber security vendor and",
    "start": "21539",
    "end": "28320"
  },
  {
    "text": "previously I was a researcher at the University of tuente in the Netherlands where I focused on the protection of critical infrastructure and I've spoken",
    "start": "28320",
    "end": "35340"
  },
  {
    "text": "at various conferences about this subject so I want to focus a little bit today on",
    "start": "35340",
    "end": "40680"
  },
  {
    "text": "lateral movement in operational technology so how many people here just to get a feeling are familiar with the",
    "start": "40680",
    "end": "46320"
  },
  {
    "text": "Purdue model in operational technology so that's that's a few people so for those who are not familiar uh the Purdue",
    "start": "46320",
    "end": "52680"
  },
  {
    "text": "model is a high level conceptual way to think about the organization of networks",
    "start": "52680",
    "end": "58199"
  },
  {
    "text": "in operational technology environments so at level four or five you have the Enterprise and the internet DMZ level",
    "start": "58199",
    "end": "65280"
  },
  {
    "text": "then at level three and a half you typically have a DMZ to the OT Network then at level three you have a control",
    "start": "65280",
    "end": "72540"
  },
  {
    "text": "center typically at level two and a half you have the DMZ until the site area or",
    "start": "72540",
    "end": "77760"
  },
  {
    "text": "cell network where you might have different remote sites at level two of the site you have the area supervisory",
    "start": "77760",
    "end": "84540"
  },
  {
    "text": "level which is where your local hmis for the scada management lift the engineering workstation these servers",
    "start": "84540",
    "end": "91140"
  },
  {
    "text": "the Gateway stuff like that and then at level one which is what we're going to focus on today you have your control",
    "start": "91140",
    "end": "96659"
  },
  {
    "text": "devices so that's your plc your art to use your nested devices and these can be",
    "start": "96659",
    "end": "102840"
  },
  {
    "text": "more complex than typically envisioned so typically you're not just dealing with one PLC that is talking to a scada",
    "start": "102840",
    "end": "109380"
  },
  {
    "text": "server but you're talking with nested networks so behind that Master Level PLC there might be a nested field bus",
    "start": "109380",
    "end": "115740"
  },
  {
    "text": "network of multiple plcs and behind that there might be filbus networks talking to sensors and and actuators or you",
    "start": "115740",
    "end": "123720"
  },
  {
    "text": "might be communicating over industrial wireless networks with various spread out sensors and devices or even to",
    "start": "123720",
    "end": "130380"
  },
  {
    "text": "third-party packaged units which we'll delve into a little bit later now there's been a lot of focus on lateral",
    "start": "130380",
    "end": "137760"
  },
  {
    "text": "movement in OT towards the classical perimeters so that is the segmentation with the it networks as well as the",
    "start": "137760",
    "end": "144840"
  },
  {
    "text": "level two and a half segmentation and there's also been a little bit of focus on Upstream hacking so that's you know",
    "start": "144840",
    "end": "151140"
  },
  {
    "text": "an attacker who has control over the lower levels hacking their way up to the scada but what's been traditionally",
    "start": "151140",
    "end": "157260"
  },
  {
    "text": "ignored is Downstream hacking so going going down into this uh deep level one",
    "start": "157260",
    "end": "162959"
  },
  {
    "text": "networks or going east and west uh between these these different sites and",
    "start": "162959",
    "end": "168060"
  },
  {
    "text": "that's what we want to focus on today so from where the title nakatomi space",
    "start": "168060",
    "end": "174780"
  },
  {
    "text": "so this is a concept that comes from from architecture in OG you find a lot",
    "start": "174780",
    "end": "180720"
  },
  {
    "text": "of what I like to call Network crawl space so these are highly complex systems of systems and there might be",
    "start": "180720",
    "end": "186900"
  },
  {
    "text": "networks between and inside of these systems that you don't have visibility into that you don't have control over",
    "start": "186900",
    "end": "193580"
  },
  {
    "text": "and if you're able to move through these networks in unforeseen ways it's a little bit like the movie Die Hard where",
    "start": "193580",
    "end": "200099"
  },
  {
    "text": "Bruce Willis crawl stroll defense in the tunnels that are unseen in order to get around uh the building and there is a",
    "start": "200099",
    "end": "207239"
  },
  {
    "text": "lot of stuff beyond the typical ethernet networks there might be field bus networks like trophy bus and profinet",
    "start": "207239",
    "end": "212819"
  },
  {
    "text": "can open there might be RF networks like Wireless Hearts proprietary 900",
    "start": "212819",
    "end": "218220"
  },
  {
    "text": "megahertz RF networks Tetra wide area networks that might be point-to-point",
    "start": "218220",
    "end": "223379"
  },
  {
    "text": "links to third-party systems um yeah and typically there is no ability to detect malicious activity in",
    "start": "223379",
    "end": "229560"
  },
  {
    "text": "these Networks so the central focus of this talk is how",
    "start": "229560",
    "end": "234659"
  },
  {
    "text": "to move laterally between different network segments and types of networks at Purdue level one",
    "start": "234659",
    "end": "240659"
  },
  {
    "text": "as we discussed after all it's fairly common for level one devices to be",
    "start": "240659",
    "end": "245879"
  },
  {
    "text": "connected to different types of network links and you can see a little bit in the picture what that looks like these",
    "start": "245879",
    "end": "251159"
  },
  {
    "text": "may be nested filbert networks or third-party connectivity um and and we want to see how we can",
    "start": "251159",
    "end": "256440"
  },
  {
    "text": "move down but in order to be able to move down you might need to go through these devices and that will require code",
    "start": "256440",
    "end": "262620"
  },
  {
    "text": "execution on these level 1 devices and this has been demonstrated against many vendors now and you can see some of them",
    "start": "262620",
    "end": "268919"
  },
  {
    "text": "on the picture and there has been some exploratory work in the post exploitation of these devices with",
    "start": "268919",
    "end": "274320"
  },
  {
    "text": "regards to persistence privilege escalation evasion exfiltration and so-called operational technology",
    "start": "274320",
    "end": "280560"
  },
  {
    "text": "payloads which will impair the process control or inhibit a safety response but basically nothing for lateral movement",
    "start": "280560",
    "end": "287040"
  },
  {
    "text": "at level one now why bother with this you know many people will say as soon as you are in",
    "start": "287040",
    "end": "292680"
  },
  {
    "text": "level one it's all insecure by Design anyway uh why why bother with this stuff you can do what you want well that's not",
    "start": "292680",
    "end": "299400"
  },
  {
    "text": "completely true for one you might need to move across a hardened or unacknowledged perimeters and if a",
    "start": "299400",
    "end": "305400"
  },
  {
    "text": "device is multi-homed between different zones and that includes multi-homing through serial or radio frequency links",
    "start": "305400",
    "end": "312180"
  },
  {
    "text": "then it is a perimeter device even if it exists that deep down in the network",
    "start": "312180",
    "end": "317280"
  },
  {
    "text": "and a great example of this is the architectures for interfacing and integrating the basic process control",
    "start": "317280",
    "end": "323820"
  },
  {
    "text": "system and Safety instrumented Systems so how many people here are familiar with an SIS or bpcs",
    "start": "323820",
    "end": "331139"
  },
  {
    "text": "now a lot of people so basically a bpcs is the basic process control system that",
    "start": "331139",
    "end": "336600"
  },
  {
    "text": "automates and controls an industrial process or an infrastructural facility and the safety instrumented system is",
    "start": "336600",
    "end": "342840"
  },
  {
    "text": "there to ensure that the operations occur within safe boundaries so if something goes wrong if it detects you",
    "start": "342840",
    "end": "348780"
  },
  {
    "text": "know over pressure or something the safety system kicks in and ensures that you know safety measures are taken and",
    "start": "348780",
    "end": "354539"
  },
  {
    "text": "traditionally you want these to be completely separate and they used to be air-gapped but increasingly for various",
    "start": "354539",
    "end": "360600"
  },
  {
    "text": "reasons they have become integrated and there's two main models that this has followed one of them is the integrated",
    "start": "360600",
    "end": "366120"
  },
  {
    "text": "architecture where you essentially put a firewall at level two and you allow them to communicate through inter ethernet",
    "start": "366120",
    "end": "372720"
  },
  {
    "text": "links and the other one is the interfaced architecture where you just have a simple point-to-point link",
    "start": "372720",
    "end": "378780"
  },
  {
    "text": "clicked into the bpcs PLC and clicked into the sis PLC and it speaks maybe a",
    "start": "378780",
    "end": "384419"
  },
  {
    "text": "Serial protocol maybe an Ethernet protocol but what's key is that this is a non-routable point-to-point link",
    "start": "384419",
    "end": "391740"
  },
  {
    "text": "so there's obvious reasons why an attacker might want to move into the sis but a commonly overlooked one is abusing",
    "start": "391740",
    "end": "399539"
  },
  {
    "text": "as is bypasses so for those who don't know there's often a legitimate need to",
    "start": "399539",
    "end": "404759"
  },
  {
    "text": "bypass safety function functions in a industrial process during process startup because it will be operating",
    "start": "404759",
    "end": "411419"
  },
  {
    "text": "under abnormal conditions as it's starting up during transitions when it's Transit making a transition from one",
    "start": "411419",
    "end": "417479"
  },
  {
    "text": "process phase to another process phase or doing maintenance and that allows you to basically say ignore the inputs from",
    "start": "417479",
    "end": "424319"
  },
  {
    "text": "this safety sensor ignore the outputs to that particular actuator or ignore this entire safety function and obviously as",
    "start": "424319",
    "end": "430800"
  },
  {
    "text": "an attacker that's very interesting because that means that I can shut down the safety functions if I'm able to",
    "start": "430800",
    "end": "436080"
  },
  {
    "text": "access that functionality now typically this kind of functionality is engineered as you see on on the diagram where you",
    "start": "436080",
    "end": "443039"
  },
  {
    "text": "have a simplified function block and you have an activation signal and this is coming in from the HMI where you're",
    "start": "443039",
    "end": "449460"
  },
  {
    "text": "typically on the control side are able to say enable activate this particular bypass and this this might come in",
    "start": "449460",
    "end": "456060"
  },
  {
    "text": "through this this particular link but there's also an enablement signal and before you're able to enable this bypass",
    "start": "456060",
    "end": "462419"
  },
  {
    "text": "you typically have to flip a Hardware switch so even if you have full control over the the basic process control",
    "start": "462419",
    "end": "468000"
  },
  {
    "text": "system you might not be able to enable this bypass yet there might also be timeouts so you're able to bypass a",
    "start": "468000",
    "end": "474900"
  },
  {
    "text": "safety function but after a certain amount of time it will be enabled again so as an attacker I will need to figure",
    "start": "474900",
    "end": "481139"
  },
  {
    "text": "out a way to enable these bypasses and bypass these timeouts so I can make sure that my attack is not being messed up by",
    "start": "481139",
    "end": "488639"
  },
  {
    "text": "the safety system now a second interesting perspective for",
    "start": "488639",
    "end": "493860"
  },
  {
    "text": "lateral movement at OT and are level one at nod our so-called packaged units",
    "start": "493860",
    "end": "499979"
  },
  {
    "text": "um and these are essentially Black Box control systems with a very specific function like HVAC control chemical",
    "start": "499979",
    "end": "506160"
  },
  {
    "text": "injection an entire water treatment facility or a complete gas turbine and these can range from a simple subsystem",
    "start": "506160",
    "end": "512339"
  },
  {
    "text": "to an entire plant and these are typically delivered by a third party so they're not under the control or the",
    "start": "512339",
    "end": "518219"
  },
  {
    "text": "maintenance of the asset owner themselves and in many cases they will be interfacing their own control system",
    "start": "518219",
    "end": "524399"
  },
  {
    "text": "or or their own PCN and scada interface with these third-party units that might",
    "start": "524399",
    "end": "529740"
  },
  {
    "text": "have remote maintenance functionality so you might be hooking up your control system to a third-party control system",
    "start": "529740",
    "end": "535620"
  },
  {
    "text": "that has a wireless or cellular modem that they use for remote maintenance and might present an entryway into your",
    "start": "535620",
    "end": "542580"
  },
  {
    "text": "control system through level one and this interface that you have no visibility into so that that is the",
    "start": "542580",
    "end": "547920"
  },
  {
    "text": "second reason why it's interesting to look into this lateral move so as an example of how this is",
    "start": "547920",
    "end": "554700"
  },
  {
    "text": "typically regulated for these packaged units they typically do that through field bus couplers and field bus",
    "start": "554700",
    "end": "560399"
  },
  {
    "text": "couplers are essentially devices that are very simplified gateways so they have a range of inputs and a range of",
    "start": "560399",
    "end": "567000"
  },
  {
    "text": "outputs that are mapped to each other on both Master sides so you have a master PLC on one system you have a master PLC",
    "start": "567000",
    "end": "573959"
  },
  {
    "text": "on the other system and there's a very simple coupler in between that says inputs A to B you know from one side are",
    "start": "573959",
    "end": "580740"
  },
  {
    "text": "mapped to input C to D from the other side and that allows you to basically copy these inputs and these outputs now",
    "start": "580740",
    "end": "587279"
  },
  {
    "text": "historically these were considered a sufficient perimeter because they used to be dumb devices there was very little",
    "start": "587279",
    "end": "593220"
  },
  {
    "text": "software running on them no capabilities and there's only a few inputs and outputs being copied so if it's just a",
    "start": "593220",
    "end": "598800"
  },
  {
    "text": "simple sensor measurement value you can move laterally across these barriers but increasingly these are smart devices",
    "start": "598800",
    "end": "605880"
  },
  {
    "text": "that have firmer update functionality that have protocol parsing Stacks so now you have these abilities to take control",
    "start": "605880",
    "end": "612420"
  },
  {
    "text": "of these devices and then move Beyond these devices into other networks hooked up to them and that presents a new",
    "start": "612420",
    "end": "619320"
  },
  {
    "text": "Avenue of infiltration into Control Systems From Below Ascension",
    "start": "619320",
    "end": "624360"
  },
  {
    "text": "so the second reason why I want to bother with lateral movement that these low levels is granular control and this",
    "start": "624360",
    "end": "629760"
  },
  {
    "text": "is something that's often very misunderstood um because even if I'm able to talk at level one to a Master Level PLC that",
    "start": "629760",
    "end": "637260"
  },
  {
    "text": "doesn't necessarily expose all the things I need to get control over as an attacker so if you look at the slide I",
    "start": "637260",
    "end": "643860"
  },
  {
    "text": "have the attacker on the left of the slide and he's able to talk to the PLC and that Master PLC has a couple of",
    "start": "643860",
    "end": "649079"
  },
  {
    "text": "links to other plcs that act as slaves behind it and these plcs might control you know a valve setting and then only",
    "start": "649079",
    "end": "655860"
  },
  {
    "text": "expose the status or a valve measurement to the master PLC and in turn the master PLC might only expose the status and the",
    "start": "655860",
    "end": "663959"
  },
  {
    "text": "same goes for the communications all the way down to the packaged unit the master PLC will not allow you to make",
    "start": "663959",
    "end": "669600"
  },
  {
    "text": "modifications to this motor Drive controller they might not be able",
    "start": "669600",
    "end": "674640"
  },
  {
    "text": "to influence the valve settings so if as an attacker I want to do that I will need to move through the master PLC",
    "start": "674640",
    "end": "681000"
  },
  {
    "text": "through the slave plcs to get to these hooked up devices now there's various",
    "start": "681000",
    "end": "686040"
  },
  {
    "text": "limitations here uh these links might be routable in some cases because many OT Protocols are deeply routable but in",
    "start": "686040",
    "end": "692399"
  },
  {
    "text": "some cases the links might be non-routeable they might be a simple modbus link that doesn't allow me to",
    "start": "692399",
    "end": "697680"
  },
  {
    "text": "Route these communications deep into these networks also just because I'm able to write a set point in an OT",
    "start": "697680",
    "end": "704519"
  },
  {
    "text": "network doesn't mean I can do everything I want if I say for example a pressure",
    "start": "704519",
    "end": "709680"
  },
  {
    "text": "value needs to be up until this level then the devices will make sanity checks",
    "start": "709680",
    "end": "715320"
  },
  {
    "text": "internally to say look this can never be the same value I'm not going to do that for you so if I want to bypass that as",
    "start": "715320",
    "end": "721140"
  },
  {
    "text": "an attacker I will need to make modifications to the firmware of these devices and I'm able to do that I will",
    "start": "721140",
    "end": "726420"
  },
  {
    "text": "need to hop deeper into these Networks and this is actually very common in",
    "start": "726420",
    "end": "731459"
  },
  {
    "text": "automotive exploitation where you very similarly need to move deeply into these networks of AI and electronic control",
    "start": "731459",
    "end": "738959"
  },
  {
    "text": "units because usually you first get access to a multimedia unit main processor and then I have a can command",
    "start": "738959",
    "end": "746160"
  },
  {
    "text": "filter that restricts what kind of can commands I can send to the canvas and I'm also not able to talk maybe to the",
    "start": "746160",
    "end": "752519"
  },
  {
    "text": "canvas I want I might need to compromise a Gateway in order to enable access to different kinds of can buses for",
    "start": "752519",
    "end": "758519"
  },
  {
    "text": "different kinds of sub networks of ecu's so here you see that this kind of stuff has been explored extensively in",
    "start": "758519",
    "end": "764700"
  },
  {
    "text": "automotive but not so much in in OT so what do vendors and standards say",
    "start": "764700",
    "end": "770700"
  },
  {
    "text": "about this stuff well recent leaders become a general acceptance of the integrated interface and common",
    "start": "770700",
    "end": "775740"
  },
  {
    "text": "architecture so increasingly safety and and bpcs are not as separate anymore as they used to be and then they give the",
    "start": "775740",
    "end": "781920"
  },
  {
    "text": "usual segmentation advice put a firewall in there you know do the segmentation etc etc but it seems that most of them",
    "start": "781920",
    "end": "789180"
  },
  {
    "text": "consider non-routeable or serial point-to-point links as sufficiently segmented by themselves and we'll delve",
    "start": "789180",
    "end": "795300"
  },
  {
    "text": "into a why that is a bad idea in a little bit so in order to illustrate some of these",
    "start": "795300",
    "end": "801779"
  },
  {
    "text": "principles that we talked about we developed a proof of concept scenario which will delve into first and then",
    "start": "801779",
    "end": "807240"
  },
  {
    "text": "show a little bit of a demonstration video so the scenario in question is moved is",
    "start": "807240",
    "end": "812760"
  },
  {
    "text": "modeled after a movable Bridge infrastructures uh consider a bascule bridge which you can see on the right of",
    "start": "812760",
    "end": "818399"
  },
  {
    "text": "the slide this is a type of movable bridge where the bridge Leaf moves up and has a counterweight that moves down",
    "start": "818399",
    "end": "824459"
  },
  {
    "text": "into the pit and essentially holds it there after it's moved up and then it's able to to close again and when it",
    "start": "824459",
    "end": "830760"
  },
  {
    "text": "closes it has a lock bar that is inside of the bridge and then slides out to make sure that the leaf is in place with",
    "start": "830760",
    "end": "838200"
  },
  {
    "text": "the bridge so there's a few cyber physical attack scenarios that come to mind in attacking these kind of bridges",
    "start": "838200",
    "end": "844440"
  },
  {
    "text": "the first is opening or closing the bridge as traffic is passing under it which is particularly worrisome if this",
    "start": "844440",
    "end": "850500"
  },
  {
    "text": "is dangerous cargo like chemical trains or fpsos and LNG ships the second",
    "start": "850500",
    "end": "855720"
  },
  {
    "text": "scenario concerns attempting to close the bridge essentially at full speed and hit the bearings possibly with the lock",
    "start": "855720",
    "end": "862139"
  },
  {
    "text": "bar driven before the bridge closes which will mean you don't only damage the bearings but the lock bar will hit",
    "start": "862139",
    "end": "867899"
  },
  {
    "text": "the uh the road that's connected to it and possibly damage that as well and the third scenario if you're unable to do",
    "start": "867899",
    "end": "873959"
  },
  {
    "text": "that is triggering an emergency stop as the bridge is closing on Full Speed just when it's reached maximum velocity",
    "start": "873959",
    "end": "880199"
  },
  {
    "text": "because that is not graceful and because the inertia of the counterweight to cause large movable forces through the",
    "start": "880199",
    "end": "886620"
  },
  {
    "text": "bridge Leaf which either after one or multiple attempts will cause structural damage to the leaf of the bridge now",
    "start": "886620",
    "end": "893880"
  },
  {
    "text": "these scenarios are typically not very easy or sometimes just impossible to carry out if you only have control over",
    "start": "893880",
    "end": "900779"
  },
  {
    "text": "the scada layer so let's look into that a little bit",
    "start": "900779",
    "end": "905959"
  },
  {
    "text": "so on the slide I hope it's a little bit readable on the slide you see at the top an example bridge closing sequence",
    "start": "908519",
    "end": "915360"
  },
  {
    "text": "so what happens here is as the bridge is closing you know obviously it first checks you know are all the traffic",
    "start": "915360",
    "end": "921360"
  },
  {
    "text": "signals and traffic lights and the measurements or the enabled is everything good okay then we can start closing the bridge and as it is closing",
    "start": "921360",
    "end": "928620"
  },
  {
    "text": "it will hit progressively different limit switches and you can see on the middle and the right of the slide the",
    "start": "928620",
    "end": "934260"
  },
  {
    "text": "limit switch is essentially just the switch that as it is closed has different kind of closing positions that",
    "start": "934260",
    "end": "939899"
  },
  {
    "text": "you can see on the left of the slide that will say I'm almost closed or I'm fully closed and when the bridge is near",
    "start": "939899",
    "end": "946440"
  },
  {
    "text": "being closed it will send a signal to the motor to slow down to creep speed because you don't want the leave to hit",
    "start": "946440",
    "end": "953160"
  },
  {
    "text": "the bearings at full speed so it will say start slowing down you know before it actually is fully closed and only",
    "start": "953160",
    "end": "959100"
  },
  {
    "text": "when it is fully closed it will allow the lock bar to slide out of the bridge and close itself so this is something as",
    "start": "959100",
    "end": "965160"
  },
  {
    "text": "an attacker you want to be able to bypass now the same thing holds for the bridge",
    "start": "965160",
    "end": "971459"
  },
  {
    "text": "closing sequence as I mentioned and also for the opening sequence the bridge will only open when the lock bar is",
    "start": "971459",
    "end": "977459"
  },
  {
    "text": "completely slid back into the bridge because if that's not happening you can see on the right of the slide what",
    "start": "977459",
    "end": "982800"
  },
  {
    "text": "happens if the bridge tries to open with the lock bar being driven it will bend or even break the lock bar which causes",
    "start": "982800",
    "end": "988500"
  },
  {
    "text": "significant damage and will take the bridge out of commission for at least a couple of days and if it's a cyber",
    "start": "988500",
    "end": "994079"
  },
  {
    "text": "incident probably much more because a forensics follow-up so the attack scenarios we want to",
    "start": "994079",
    "end": "999600"
  },
  {
    "text": "explore close the bridge at full speed and hit the bearings that means we will need to bypass this deceleration to",
    "start": "999600",
    "end": "1005360"
  },
  {
    "text": "creep speed because otherwise we we don't hit fast enough we want to be able to drive the lock bar before the closing",
    "start": "1005360",
    "end": "1012079"
  },
  {
    "text": "so we need to bypass these switches in the second scenario if we want to close at full speed and Trigger the emergency",
    "start": "1012079",
    "end": "1017779"
  },
  {
    "text": "stop we will need to wait until maximum velocity which means that we will need to measure when we've reached maximum",
    "start": "1017779",
    "end": "1024558"
  },
  {
    "text": "velocity and done trigger the emergency stop so we need very granular control over these signals and we also need to",
    "start": "1024559",
    "end": "1031459"
  },
  {
    "text": "bypass the creep speed obviously so on this slide you can see a a high",
    "start": "1031459",
    "end": "1037100"
  },
  {
    "text": "level architecture for a scada system managing multiple uh different kind of",
    "start": "1037100",
    "end": "1042199"
  },
  {
    "text": "movable Bridges it's based on real world architectures where you have a Central scada Command Center at the bottom and",
    "start": "1042199",
    "end": "1049820"
  },
  {
    "text": "they talk through a coupler device which acts as a Gateway essentially to a wide area network to different Bridges and",
    "start": "1049820",
    "end": "1055820"
  },
  {
    "text": "these bridges are managed by maybe local municipalities local operators but there",
    "start": "1055820",
    "end": "1060919"
  },
  {
    "text": "are different party than maybe the central government agency that controls the bridges and this interface is very",
    "start": "1060919",
    "end": "1066380"
  },
  {
    "text": "limited the people at the scada control system don't control things like this feed with which a bridge closes they",
    "start": "1066380",
    "end": "1072260"
  },
  {
    "text": "only are able to say start closing The Bridge start opening the bridge so as an attacker if I want to carry out the",
    "start": "1072260",
    "end": "1078020"
  },
  {
    "text": "scenarios that I just discussed I can just compromise the scada center I will need to move deeper into these",
    "start": "1078020",
    "end": "1083419"
  },
  {
    "text": "individual Bridges and we're going to do that through the following attack path we're first trying to get code execution",
    "start": "1083419",
    "end": "1088700"
  },
  {
    "text": "on the coupler device and we'll get an authentication bypass on the object PLC which controls the bridge get code",
    "start": "1088700",
    "end": "1095179"
  },
  {
    "text": "execution on the object PLC and once we have that we're able to talk directly to",
    "start": "1095179",
    "end": "1100400"
  },
  {
    "text": "the field bus systems that talk to these Bridge systems and were able to talk to the point-to-point link to the safety",
    "start": "1100400",
    "end": "1106340"
  },
  {
    "text": "system now we try to hop across the point-to-point link get code execution on the safety PLC and then enable this",
    "start": "1106340",
    "end": "1113419"
  },
  {
    "text": "safety bypass across the back plane of the safety bills",
    "start": "1113419",
    "end": "1118640"
  },
  {
    "text": "so in our scenario the coupler is a Wago 750 series while the object PLC is a Schneider Electric m340 PLC so the first",
    "start": "1118640",
    "end": "1126860"
  },
  {
    "text": "step is getting remote code execution on the coupler because I can't talk directly to the m340 right I only have",
    "start": "1126860",
    "end": "1133100"
  },
  {
    "text": "limited modbus mappings no no TDA routing and stuff like that so for this particular coupler there's a",
    "start": "1133100",
    "end": "1138620"
  },
  {
    "text": "pre-authentication stack buffer overflow in the FTP Daemon that we discovered as part of the nucleus 13 vulnerabilities a",
    "start": "1138620",
    "end": "1145460"
  },
  {
    "text": "few years ago after gaining code execution on the coupler using this vulnerability we hook its modbus Handler",
    "start": "1145460",
    "end": "1152720"
  },
  {
    "text": "to act as a proxy so now we talk to the coupler and a couple will forward the modbus package that we sent to the",
    "start": "1152720",
    "end": "1159080"
  },
  {
    "text": "coupler to the Schneider PLC that is behind it and then we're able to communicate directly in a more",
    "start": "1159080",
    "end": "1165919"
  },
  {
    "text": "comprehensive fashion with this PLC um we we don't need to do a lot of post",
    "start": "1165919",
    "end": "1172280"
  },
  {
    "text": "exploitation because we immediately run in supervisor mode there's no mitigations there's no task separation",
    "start": "1172280",
    "end": "1178160"
  },
  {
    "text": "in the nucleus real-time operating system and we have read write execute memory areas for our implant",
    "start": "1178160",
    "end": "1185360"
  },
  {
    "text": "so explaining the vulnerability a little bit um yeah it's a very simple stack buffer overflow in the ftpd that exists in the",
    "start": "1185360",
    "end": "1192140"
  },
  {
    "text": "user command which makes it nicely pre-authenticated what they essentially do is they check the string length for",
    "start": "1192140",
    "end": "1197840"
  },
  {
    "text": "the command but then copy up until the uh carriage return character so what we can",
    "start": "1197840",
    "end": "1204080"
  },
  {
    "text": "do is we insert a fake null byte it thinks the swing is you know this long but you know it copies much longer that",
    "start": "1204080",
    "end": "1210140"
  },
  {
    "text": "allows us if you look at the um yeah the right of the slide allows us to overwrite the FTP event structure which",
    "start": "1210140",
    "end": "1217940"
  },
  {
    "text": "is a linked list that exists after the user buffer and then once we disconnect after sending that payload it will",
    "start": "1217940",
    "end": "1224720"
  },
  {
    "text": "trigger a linked list unlink which gives us a write four primitive that allows us to write a d word almost anywhere in",
    "start": "1224720",
    "end": "1231679"
  },
  {
    "text": "memory luckily for us there's a read write executable BSS area that we can put our Shell Code in so we write our",
    "start": "1231679",
    "end": "1238820"
  },
  {
    "text": "Shell Code pointer to a function pointer that's called span process packet that's initially not enabled but once we",
    "start": "1238820",
    "end": "1245419"
  },
  {
    "text": "override that span process packet function this will get triggered once a LLC packet will be received by the Wago",
    "start": "1245419",
    "end": "1253760"
  },
  {
    "text": "coupler so then we create a new FTP session we override the buffer pointer with our Shell Code pointer write our",
    "start": "1253760",
    "end": "1260120"
  },
  {
    "text": "Shell Code in the subsequent FTP data and then send our LLC frame to trigger our initial shell code to the",
    "start": "1260120",
    "end": "1266600"
  },
  {
    "text": "overwritten spend process packet function where like I mentioned in supervisor mode no task separation so no",
    "start": "1266600",
    "end": "1272960"
  },
  {
    "text": "further exploitation required so what does the firmware look like when",
    "start": "1272960",
    "end": "1278120"
  },
  {
    "text": "we analyzed it it's a simple firmware zip it has a hex file which is the Intel hex format that easily gives you the",
    "start": "1278120",
    "end": "1285799"
  },
  {
    "text": "Base address of the firmware it runs nucleus rtos on the arm architecture we",
    "start": "1285799",
    "end": "1291200"
  },
  {
    "text": "don't have symbols but what we can do is if we have nucleus rtos on arm images",
    "start": "1291200",
    "end": "1296900"
  },
  {
    "text": "from other firmers then we can use tools like bindiff and diaphora and debug",
    "start": "1296900",
    "end": "1302240"
  },
  {
    "text": "strings to make inferences about likely function names so we get a little bit more knowledge about the structure of",
    "start": "1302240",
    "end": "1308419"
  },
  {
    "text": "the firmware and you can see on the right of the slide what that looks like with the different protocol stacks and components as part of this firmware if",
    "start": "1308419",
    "end": "1316400"
  },
  {
    "text": "we want to stabilize our implant we can simply create a new nucleus task which will run our implant as the equivalent",
    "start": "1316400",
    "end": "1323419"
  },
  {
    "text": "of a process on the real-time operating system which runs in the background yeah we can simply hook the modbus TCP",
    "start": "1323419",
    "end": "1329360"
  },
  {
    "text": "Handler to proxy the incoming function code 0x5a to the Schneider PLC that's behind this",
    "start": "1329360",
    "end": "1336559"
  },
  {
    "text": "so for the object PLC which is a Schneider Electric PLC we want to abuse",
    "start": "1336559",
    "end": "1342440"
  },
  {
    "text": "the UMass protocol so how many people are familiar with UMass here yeah I want to",
    "start": "1342440",
    "end": "1349400"
  },
  {
    "text": "um so UMass is a proprietary engineering protocol by Schneider Electric So within",
    "start": "1349400",
    "end": "1355520"
  },
  {
    "text": "the modbus protocol you have a function code indicator that allows you to essentially have a proprietary protocol",
    "start": "1355520",
    "end": "1361820"
  },
  {
    "text": "hidden under that function code and they have their entire engineering protocol here that allows you to start and stop",
    "start": "1361820",
    "end": "1367460"
  },
  {
    "text": "the PLC download the logic do all that fun stuff there's been much prior work on it it's well reversed up to a certain",
    "start": "1367460",
    "end": "1373400"
  },
  {
    "text": "point historically it was unauthenticated but they introduced an application password fairly recently and",
    "start": "1373400",
    "end": "1380120"
  },
  {
    "text": "you can see what this looks like the structure of the protocol pdu on the bottom of the slide so you have a",
    "start": "1380120",
    "end": "1386120"
  },
  {
    "text": "function code 0x5a and you have a reservation ID you have your Yuma service ID which indicates what kind of",
    "start": "1386120",
    "end": "1391820"
  },
  {
    "text": "engineering service you want to talk to in your message data now historically people already found an",
    "start": "1391820",
    "end": "1399080"
  },
  {
    "text": "authentication bypass for this application password um actually five people found it",
    "start": "1399080",
    "end": "1405140"
  },
  {
    "text": "independently so that says quite a lot and the way it worked was you as an engineering workstation asked the PLC",
    "start": "1405140",
    "end": "1412159"
  },
  {
    "text": "give me your secret and the secret is the base64 of assault and the base64 of the hash of the salt and the password",
    "start": "1412159",
    "end": "1418159"
  },
  {
    "text": "then you exchange nonsense with the PLC then you take a reservation which says",
    "start": "1418159",
    "end": "1423559"
  },
  {
    "text": "you know reservation over to do nonsense and the secret and then you can send your authenticated requests uh together",
    "start": "1423559",
    "end": "1429740"
  },
  {
    "text": "with two signed messages obviously if you can ask the PLC for the secret you",
    "start": "1429740",
    "end": "1435740"
  },
  {
    "text": "know there's no actual authentication going on Schneider fix this however even since",
    "start": "1435740",
    "end": "1441860"
  },
  {
    "text": "you can no longer ask for this secret there are still two major ways in which you can bypass this mechanism the first",
    "start": "1441860",
    "end": "1448340"
  },
  {
    "text": "is a reservation replay because what happens is if I as an attacker can sniff this traffic I can see a legitimate",
    "start": "1448340",
    "end": "1454400"
  },
  {
    "text": "session the nonsense will be exchanged the legitimate session will send an authentication hash get the reservation",
    "start": "1454400",
    "end": "1460159"
  },
  {
    "text": "ID I sniff the authentication hash and then replay it because these nonsense",
    "start": "1460159",
    "end": "1465200"
  },
  {
    "text": "that are being exchanged they're globals they don't differ they do not coupled to",
    "start": "1465200",
    "end": "1470539"
  },
  {
    "text": "a session they're just Global variables in the memory of this PLC and if I as an",
    "start": "1470539",
    "end": "1475820"
  },
  {
    "text": "attacker then don't do a new non's exchange the same nonsense will still live in memory so I can just replay the",
    "start": "1475820",
    "end": "1482059"
  },
  {
    "text": "authentication hash and get the reservation ID even better um if I sniff a legitimate session I can",
    "start": "1482059",
    "end": "1488659"
  },
  {
    "text": "sniff the nonsense and the reservation ID and then Forge the authentication request because as you can see in the",
    "start": "1488659",
    "end": "1494000"
  },
  {
    "text": "previous slide there's no freshness like the only signing that happens in the authenticated request is a sha hash over",
    "start": "1494000",
    "end": "1501860"
  },
  {
    "text": "a publicly known Hardware ID and announces that are publicly known so there's no no actually signing going on",
    "start": "1501860",
    "end": "1507620"
  },
  {
    "text": "there and I can forge these requests after sniffing so now that I can talk without",
    "start": "1507620",
    "end": "1514039"
  },
  {
    "text": "restrictions to this proprietary engineering interface I'm going to get code execution on this object PLC now",
    "start": "1514039",
    "end": "1519440"
  },
  {
    "text": "there have been different approaches and prior work one of them is just downloading new PLC logic to it which is",
    "start": "1519440",
    "end": "1525679"
  },
  {
    "text": "essentially assembled arm code there have been people exploiting vulnerable messages vulnerabilities in the TCP IP",
    "start": "1525679",
    "end": "1531740"
  },
  {
    "text": "stack but we wanted a method that works on a fully updated PLC and also allows",
    "start": "1531740",
    "end": "1537080"
  },
  {
    "text": "for hot batching so we don't want to use the download logic method because that will require the PLC to restart and if",
    "start": "1537080",
    "end": "1543559"
  },
  {
    "text": "it restarts the logic will restart the process will be disrupted and that will raise alarms going out to the scada and",
    "start": "1543559",
    "end": "1549799"
  },
  {
    "text": "that's something we want to avoid we also want a method that's very hostile to forensics so you know you can see",
    "start": "1549799",
    "end": "1555320"
  },
  {
    "text": "project Jackson's changing no changes in the source and we wanted to use an obscure protocol feature to evade most",
    "start": "1555320",
    "end": "1561559"
  },
  {
    "text": "intrusion detection systems so a little bit of background um Schneider Electric plcs they have the",
    "start": "1561559",
    "end": "1568039"
  },
  {
    "text": "modicon application binary file format the apx format and that is a format that",
    "start": "1568039",
    "end": "1573080"
  },
  {
    "text": "is used as part of the project files to organize the internal memory of the PLC so all of the internal memory of the PLC",
    "start": "1573080",
    "end": "1579320"
  },
  {
    "text": "is divided in different areas which have certain sections and these sections are organized according to index size and",
    "start": "1579320",
    "end": "1587299"
  },
  {
    "text": "attributes and within a section you have different data blocks and a data block can hold just data it can hold",
    "start": "1587299",
    "end": "1592700"
  },
  {
    "text": "executable code it can hold function block data it can hold constants all the kind of things that a PLC needs to",
    "start": "1592700",
    "end": "1598580"
  },
  {
    "text": "function and these data blocks are organized in a relocation table where you have a relocation table entry number",
    "start": "1598580",
    "end": "1605000"
  },
  {
    "text": "an area section offset size attributes and so on so this is essentially the",
    "start": "1605000",
    "end": "1610159"
  },
  {
    "text": "internal memory organization of the plc now we found the unexplored UMass CSA",
    "start": "1610159",
    "end": "1616159"
  },
  {
    "text": "request at service code 0x50 to the best of my knowledge this hasn't been discussed anywhere else before and it's",
    "start": "1616159",
    "end": "1622460"
  },
  {
    "text": "a very complex service request that allows you to essentially create virtual pages in the memory of this PLC and you",
    "start": "1622460",
    "end": "1629179"
  },
  {
    "text": "can fill these virtual pages with a proprietary command set that's undocumented but there are commands that",
    "start": "1629179",
    "end": "1634820"
  },
  {
    "text": "allow you to directly operate on these blocks that I discussed so you can read from these blocks you can write to these",
    "start": "1634820",
    "end": "1640159"
  },
  {
    "text": "blocks you can copy these blocks and all of this happens live any modifications you make to the block they don't require",
    "start": "1640159",
    "end": "1645679"
  },
  {
    "text": "restarts on the PLC they show no changes in the project checksum and you see no",
    "start": "1645679",
    "end": "1651559"
  },
  {
    "text": "differences in the source so in order to get rce we first thought",
    "start": "1651559",
    "end": "1658039"
  },
  {
    "text": "why not write directly to an executable block well that's that's disallowed but we can copy from data blocks to code",
    "start": "1658039",
    "end": "1664580"
  },
  {
    "text": "blocks because the permissions check there is set to ignore for the copy operation so what we do is we write our",
    "start": "1664580",
    "end": "1670159"
  },
  {
    "text": "Shell Code payload to a data block and then issue a copy command from the data block to the executable block and when",
    "start": "1670159",
    "end": "1676159"
  },
  {
    "text": "that executable block will be executed as part of the normal PLC logic our Shell Code that was just copied will get",
    "start": "1676159",
    "end": "1682520"
  },
  {
    "text": "executed so now we need to understand a little bit about the firmware in depth before",
    "start": "1682520",
    "end": "1687860"
  },
  {
    "text": "we can develop our implant so the firmer format it's initially very simple it's just a zip file that within that they",
    "start": "1687860",
    "end": "1694340"
  },
  {
    "text": "have the unity M binary which is a proprietary binary format that organizes the um yeah the PLC firmware it runs",
    "start": "1694340",
    "end": "1702380"
  },
  {
    "text": "vxworks 6.4 on ARM version force or there's no not even Hardware support for",
    "start": "1702380",
    "end": "1707659"
  },
  {
    "text": "non-executable bits so that's that's nice uh you have to manually reconstruct the symbol table from vxworks and then",
    "start": "1707659",
    "end": "1714919"
  },
  {
    "text": "once you execute as part of the runtime logic we execute within the context of",
    "start": "1714919",
    "end": "1720980"
  },
  {
    "text": "that particular scan runtime so we still need to make a little bit of a bypass because that runtime will check are you",
    "start": "1720980",
    "end": "1727340"
  },
  {
    "text": "executing too long and if so it will trigger a watchdog which will cause the PLC to go in a fault so we'll need to x",
    "start": "1727340",
    "end": "1733159"
  },
  {
    "text": "escape from that runtime in order to be able to execute our Shell Code reliably and we do that by hooking a triggerable",
    "start": "1733159",
    "end": "1739700"
  },
  {
    "text": "function and I'm pointing that to our Shell Code triggering that function then we'll execute outside of the context of",
    "start": "1739700",
    "end": "1745760"
  },
  {
    "text": "the runtime and the Watchdog won't bother us anymore so yeah we have this initial stage",
    "start": "1745760",
    "end": "1751760"
  },
  {
    "text": "repayload the Stager payload will set up a new vxworks task and the task will run",
    "start": "1751760",
    "end": "1757279"
  },
  {
    "text": "our implant and that implant allows us to talk to all these different things like the can open device driver it",
    "start": "1757279",
    "end": "1763039"
  },
  {
    "text": "allows us to talk to the bridge systems like the rotary encoders and the motor drives as well as the TCP IP stack which",
    "start": "1763039",
    "end": "1768919"
  },
  {
    "text": "allows us to communicate across the point-to-point link to the safety plc",
    "start": "1768919",
    "end": "1774200"
  },
  {
    "text": "um once we can talk to these these field devices we can talk uh truly can open API within the PLC and we can abuse",
    "start": "1774200",
    "end": "1781220"
  },
  {
    "text": "functionality that is part of the can in automation uh standard and this has a",
    "start": "1781220",
    "end": "1786380"
  },
  {
    "text": "lot of different functions uh you talk to these devices through something called the sdos and the sdos have",
    "start": "1786380",
    "end": "1792200"
  },
  {
    "text": "different indexes corresponding to a different function and there's sdos for example for executing a operating system",
    "start": "1792200",
    "end": "1798799"
  },
  {
    "text": "command or downloading a program or doing program control all different ways that allow you to then move towards code",
    "start": "1798799",
    "end": "1805820"
  },
  {
    "text": "execution on these field devices like the rotary encoders and the motor drives and the nice thing is that in many cases",
    "start": "1805820",
    "end": "1812059"
  },
  {
    "text": "these are in band so they're you know across can open you know you don't need to put them in a specific",
    "start": "1812059",
    "end": "1817419"
  },
  {
    "text": "device firmware update mode and if there is any authentication at all it's",
    "start": "1817419",
    "end": "1822500"
  },
  {
    "text": "typically a static 32-bit value that's in the manual so no authentication this",
    "start": "1822500",
    "end": "1828440"
  },
  {
    "text": "now if we want to move to the safety plc's ethernet module we'll need to do a",
    "start": "1828440",
    "end": "1834260"
  },
  {
    "text": "couple of things so this link is typically non-routeable like I mentioned so there's only modbus TCP traffic I",
    "start": "1834260",
    "end": "1840440"
  },
  {
    "text": "can't talk the zip protocol because that's that's disabled on this link and it runs an explicit protected mode so",
    "start": "1840440",
    "end": "1848000"
  },
  {
    "text": "we'll need to exploit an end a vulnerability in the TCP IP stack in order to get code execution on this",
    "start": "1848000",
    "end": "1853899"
  },
  {
    "text": "ethernet module and then from the ethernet module Hub to the rest of the safety instrument system so in our case",
    "start": "1853899",
    "end": "1860600"
  },
  {
    "text": "we we use the Ellen Bradley guard logic safety PLC with a 1756 N2 TD ethernet",
    "start": "1860600",
    "end": "1867020"
  },
  {
    "text": "module the firmware uh yeah we'll discuss in a bit the vulnerability is one of the",
    "start": "1867020",
    "end": "1873500"
  },
  {
    "text": "Urgent 11 vulnerabilities in the VX Works real-time operating system and we send more formed IP options with the",
    "start": "1873500",
    "end": "1879559"
  },
  {
    "text": "multiple SSR options they generate an icmp error response but during the",
    "start": "1879559",
    "end": "1885080"
  },
  {
    "text": "copying of this uh options uh trivial stack buffer overflow occurs as you can",
    "start": "1885080",
    "end": "1890779"
  },
  {
    "text": "see on the right of the slide exploiting this is is not completely straightforward because you need to pick",
    "start": "1890779",
    "end": "1897080"
  },
  {
    "text": "these SSR options to align in the algorithm as it's doing the copying but eventually that will give you a write",
    "start": "1897080",
    "end": "1903620"
  },
  {
    "text": "for primitive that allows you to do rough chain construction and a fix up so",
    "start": "1903620",
    "end": "1908899"
  },
  {
    "text": "then your execution continues there is a large unused read write executable load",
    "start": "1908899",
    "end": "1914539"
  },
  {
    "text": "segment that you can then write your payload through through this right for primitive and copy the Shell Code in",
    "start": "1914539",
    "end": "1920000"
  },
  {
    "text": "chunks of four to this area and then return to it through the ROP chain now this this has been previously exploited",
    "start": "1920000",
    "end": "1925880"
  },
  {
    "text": "on a variant of this module and there were only slight differences in constructing our exploit chain again no",
    "start": "1925880",
    "end": "1933260"
  },
  {
    "text": "need for further privilege escalation because you can do almost anything once you have code execution",
    "start": "1933260",
    "end": "1939500"
  },
  {
    "text": "so the firmer of this particular module again was a zip file and has a proprietary binary format that hides an",
    "start": "1939500",
    "end": "1946580"
  },
  {
    "text": "elf binary so that's that's great means the segments all come pre-loaded you do need to manually reconstruct the symbol",
    "start": "1946580",
    "end": "1952640"
  },
  {
    "text": "table though once I have code execution on this Gateway module uh I can or this",
    "start": "1952640",
    "end": "1960080"
  },
  {
    "text": "Communications module I can talk to the rest of the safety system through the back plane so these modules are hooked",
    "start": "1960080",
    "end": "1966380"
  },
  {
    "text": "up to a backplane and this backplane is based essentially on control net which again in turn is based on Sip and that",
    "start": "1966380",
    "end": "1973880"
  },
  {
    "text": "allows me to talk to the back plane and send sip messages to these different modules and that allows me for example",
    "start": "1973880",
    "end": "1979640"
  },
  {
    "text": "to enable the sys bypass that I'm looking for in order in order to bypass the safety functionality that might be",
    "start": "1979640",
    "end": "1986000"
  },
  {
    "text": "in the way of my attack in order to illustrate this we have a little bit of a video I'm not sure if",
    "start": "1986000",
    "end": "1991520"
  },
  {
    "text": "it's going to automatically play or if I'm going to uh yeah I'll uh pop it up on my laptop",
    "start": "1991520",
    "end": "1999519"
  },
  {
    "text": "in this video we will demonstrate how to move laterally through OT systems at",
    "start": "2002799",
    "end": "2007960"
  },
  {
    "text": "level one don't think it's coming up uh let me check",
    "start": "2007960",
    "end": "2016018"
  },
  {
    "text": "I think it has to do with the screen sharing",
    "start": "2017860",
    "end": "2021778"
  },
  {
    "text": "in order to gain deep access to nested control systems and cross-restricted perimeters between different security",
    "start": "2030279",
    "end": "2037179"
  },
  {
    "text": "zones the demo setup shown consists of a Wago 750 ethernet coupler offering a limited",
    "start": "2037179",
    "end": "2044320"
  },
  {
    "text": "Gateway interface to a nested Snyder m340 plc the m340 PLC is in turn connected to it",
    "start": "2044320",
    "end": "2052658"
  },
  {
    "text": "Allen Bradley guard logic safety PLC via a restricted point-to-point link to its",
    "start": "2052659",
    "end": "2058658"
  },
  {
    "text": "ethernet module none of these plcs are conventionally reachable from the",
    "start": "2058659",
    "end": "2063878"
  },
  {
    "text": "attacker's initial point of access the attacker starts by exploiting a nucleus",
    "start": "2063879",
    "end": "2069520"
  },
  {
    "text": "13 vulnerability for remote code execution on the Wago coupler Gateway",
    "start": "2069520",
    "end": "2075220"
  },
  {
    "text": "once the implant is in place the attacker can move beyond the coupler's restricted interface into the nested",
    "start": "2075220",
    "end": "2081638"
  },
  {
    "text": "networks behind it in order to reach the nested Snyder m340 PLC the attacker will instruct the",
    "start": "2081639",
    "end": "2089020"
  },
  {
    "text": "implant to forward their Snyder UMass traffic in addition the attacker will instruct",
    "start": "2089020",
    "end": "2094658"
  },
  {
    "text": "the implant to sniff Snyder UMass authentication traffic meanwhile an",
    "start": "2094659",
    "end": "2099880"
  },
  {
    "text": "unsuspecting engineer authenticates to the m340 PLC as part of regular",
    "start": "2099880",
    "end": "2105220"
  },
  {
    "text": "operations having sniffed the engineer's nonses the attacker will now reuse them to send",
    "start": "2105220",
    "end": "2112180"
  },
  {
    "text": "forged but seemingly authenticated UMass traffic to the nested m340 PLC the",
    "start": "2112180",
    "end": "2119200"
  },
  {
    "text": "attacker now forges requests containing the undocumented CSA commands in order",
    "start": "2119200",
    "end": "2124300"
  },
  {
    "text": "to gain code execution on the PLC itself without disrupting its logic meanwhile",
    "start": "2124300",
    "end": "2130839"
  },
  {
    "text": "the engineering workstation cannot tell that anything's changed as the software shows everything's still okay granting",
    "start": "2130839",
    "end": "2138160"
  },
  {
    "text": "the attacker a high degree of stealth once their implant resides on the m340",
    "start": "2138160",
    "end": "2143980"
  },
  {
    "text": "PLC the attacker can Now launch additional exploits on previously unreachable interfaces such as the",
    "start": "2143980",
    "end": "2151480"
  },
  {
    "text": "restricted point-to-point link between the m340 PLC and the guard logic safety",
    "start": "2151480",
    "end": "2157180"
  },
  {
    "text": "PLC in order to gain full control over the safety PLC the attacker launches one",
    "start": "2157180",
    "end": "2163599"
  },
  {
    "text": "of the Urgent 11 exploits from its implant on the m340 PLC once the",
    "start": "2163599",
    "end": "2169420"
  },
  {
    "text": "attacker has code execution on the safety PLC ethernet module they can talk",
    "start": "2169420",
    "end": "2174940"
  },
  {
    "text": "directly to device drivers offering access to the PLC backplane and module",
    "start": "2174940",
    "end": "2180099"
  },
  {
    "text": "peripherals as shown by manipulating the module's display in wider controller LEDs similarly the attacker's",
    "start": "2180099",
    "end": "2188140"
  },
  {
    "text": "unconstrained access to the m340 plc's internals as shown by manipulating the",
    "start": "2188140",
    "end": "2193599"
  },
  {
    "text": "CPU modules LEDs allows them granular access to local and remote field devices",
    "start": "2193599",
    "end": "2199359"
  },
  {
    "text": "connected to the can bus or backplane demonstrating how lateral movement at",
    "start": "2199359",
    "end": "2204700"
  },
  {
    "text": "level 1 grants attackers deep access to complex control systems [Music]",
    "start": "2204700",
    "end": "2213169"
  },
  {
    "text": "yeah there it is again right so regarding the disclosure we had",
    "start": "2215520",
    "end": "2221260"
  },
  {
    "text": "a coordinated disclosure process with Schneider Electric uh these issues were first reported in April and July of 2022",
    "start": "2221260",
    "end": "2228640"
  },
  {
    "text": "respectively advisories for this were released in January 2023 and updated in",
    "start": "2228640",
    "end": "2234220"
  },
  {
    "text": "March of 2023 for the remote code execution exploit remediations are available for the m580 excluding the",
    "start": "2234220",
    "end": "2241480"
  },
  {
    "text": "safety version of it and the m1e but mitigations are available for all the other ones so as far as I know currently",
    "start": "2241480",
    "end": "2248020"
  },
  {
    "text": "there's there's no remediations for for the other plcs in this in this family the authentication bypass currently only",
    "start": "2248020",
    "end": "2255460"
  },
  {
    "text": "mitigations are available we suggested a retrofit fix which it could rate or fit",
    "start": "2255460",
    "end": "2260560"
  },
  {
    "text": "on the existing protocol by using the secure remote password protocol in combination with an hmac so the",
    "start": "2260560",
    "end": "2266859"
  },
  {
    "text": "authenticated user to the PLC with SRP which is a zero knowledge and middle",
    "start": "2266859",
    "end": "2272440"
  },
  {
    "text": "resistant and discrete log based protocol then derive and age Mac key from the shared SRP key and then sign",
    "start": "2272440",
    "end": "2279520"
  },
  {
    "text": "messages with that age Mac to tie the authentication of the messages to the initial authentication with the PLC but",
    "start": "2279520",
    "end": "2286359"
  },
  {
    "text": "whether that is going to be implemented or not that I I don't know so some mitigation detection and",
    "start": "2286359",
    "end": "2292240"
  },
  {
    "text": "forensics response advice in order to detect the Wago 750 implant it would be",
    "start": "2292240",
    "end": "2297880"
  },
  {
    "text": "good to alert on any UMass traffic to our non-moticon devices and monitor the modbus TCP statistics on these",
    "start": "2297880",
    "end": "2304660"
  },
  {
    "text": "particular couplers in order to detect the Yuma's authentication bypass make sure that you restrict humus flows only",
    "start": "2304660",
    "end": "2310839"
  },
  {
    "text": "to the engineering workstation through IP ACLS and firewalling also look for authentication authenticated requests",
    "start": "2310839",
    "end": "2317920"
  },
  {
    "text": "without the non's exchange first happening that's a good sign of this exploit in order to detect the remote",
    "start": "2317920",
    "end": "2323500"
  },
  {
    "text": "code execution be sure you can alert on the UMass CSA command which is service",
    "start": "2323500",
    "end": "2329140"
  },
  {
    "text": "code 0x50 monitor any Watchdog errors happening because an attacker with a",
    "start": "2329140",
    "end": "2334180"
  },
  {
    "text": "broken implant might trigger those and if you want to do forensics you can try to upload the PLC project and then",
    "start": "2334180",
    "end": "2340599"
  },
  {
    "text": "extract and carve the apx format and look for malicious arm Shell Code that was running in memory because if an",
    "start": "2340599",
    "end": "2346300"
  },
  {
    "text": "attacker has not taken care to clean that up and relocate the implant towards the firmware memory you might be able to",
    "start": "2346300",
    "end": "2352480"
  },
  {
    "text": "find something there for the remote code execution on the ethernet module on the",
    "start": "2352480",
    "end": "2358359"
  },
  {
    "text": "safety PLC monitor the IP and assert statistics as you can see on the bottom",
    "start": "2358359",
    "end": "2364660"
  },
  {
    "text": "right of the slide it will go have a web server that shows you how many errors in",
    "start": "2364660",
    "end": "2369940"
  },
  {
    "text": "the IP parsing happen and you can also see what tasks are running as part of the real-time operating system in this",
    "start": "2369940",
    "end": "2375940"
  },
  {
    "text": "web server on the left of the slide and you might see if there's anything out of the ordinary there for full details we",
    "start": "2375940",
    "end": "2382780"
  },
  {
    "text": "have put out a report that will show at the end of the slide so in conclusion there's likely a lot of",
    "start": "2382780",
    "end": "2388599"
  },
  {
    "text": "crawl space that's not on your radar Within These deep OG networks if a level 1 device sits between segments it needs",
    "start": "2388599",
    "end": "2396280"
  },
  {
    "text": "a perimeter security protocol even if it is that beep down in the network stop treating certain kinds of links like",
    "start": "2396280",
    "end": "2402339"
  },
  {
    "text": "serial links point-to-point links couplers non-routable links all that stuff as if they're magically immune to",
    "start": "2402339",
    "end": "2407740"
  },
  {
    "text": "the kind of problems that arise in links that you see more at higher levels and",
    "start": "2407740",
    "end": "2413800"
  },
  {
    "text": "the impact of a compromise is not limited to the explicit capabilities of the link or only the devices that are",
    "start": "2413800",
    "end": "2419500"
  },
  {
    "text": "directly connected to it but also the devices that are connected to it within degrees of order and with deep access to",
    "start": "2419500",
    "end": "2426339"
  },
  {
    "text": "this system Things become possible that might have been considered impossible before so the potential impact of an",
    "start": "2426339",
    "end": "2432579"
  },
  {
    "text": "attack changes if you look at it from this perspective and that's that thank you for listening",
    "start": "2432579",
    "end": "2437920"
  },
  {
    "text": "if you're interested to read up on this research a little more uh the details are in the link in the report on the",
    "start": "2437920",
    "end": "2443140"
  },
  {
    "text": "bottom of the slide and if there's any questions I'll uh take them now thank you [Applause]",
    "start": "2443140",
    "end": "2455170"
  },
  {
    "text": "I'll also be available for questions just after the talk or to my email contact so let me know",
    "start": "2456880",
    "end": "2463300"
  },
  {
    "text": "I see a question there",
    "start": "2463300",
    "end": "2466200"
  },
  {
    "text": "online filtration test or something along those",
    "start": "2480520",
    "end": "2487240"
  },
  {
    "text": "lines especially without touching the emergency devices",
    "start": "2487240",
    "end": "2492720"
  },
  {
    "text": "yeah from an assessment perspective right yeah so I think the first thing that",
    "start": "2494320",
    "end": "2500200"
  },
  {
    "text": "that's important to consider is that this is a relatively Advanced attack chain so this is depending on the",
    "start": "2500200",
    "end": "2505839"
  },
  {
    "text": "maturity of the organization they should probably not be at the topic of a priority if you're very immature in your",
    "start": "2505839",
    "end": "2511300"
  },
  {
    "text": "OT security there's other things you have to worry about but for those organizations that are a little bit further along on a maturity scale or",
    "start": "2511300",
    "end": "2518140"
  },
  {
    "text": "might have a much more heightened um risk profile thinking about this kind",
    "start": "2518140",
    "end": "2523900"
  },
  {
    "text": "of attack chains mostly consists of how you conceptualize your risk so it's not",
    "start": "2523900",
    "end": "2529000"
  },
  {
    "text": "so much about trying to find every little vulnerability that allows this deep movement but having a good",
    "start": "2529000",
    "end": "2535300"
  },
  {
    "text": "architectural overview of what is actually hooked up to my system what does it actually look like do we have",
    "start": "2535300",
    "end": "2541839"
  },
  {
    "text": "visibility Beyond you know that that first level one do we have visibility into our links to the outside how many",
    "start": "2541839",
    "end": "2548560"
  },
  {
    "text": "black box devices just say you know uh gas turbine and then we don't know",
    "start": "2548560",
    "end": "2553900"
  },
  {
    "text": "anything that is inside of it that might be connected remotely inside the gas turbine getting that good picture of the",
    "start": "2553900",
    "end": "2560980"
  },
  {
    "text": "various Pathways that you can move through you can already do a lot from a paper assessment that has a good",
    "start": "2560980",
    "end": "2567660"
  },
  {
    "text": "dynamically updated asset inventory on the site for comparison then start from",
    "start": "2567660",
    "end": "2573099"
  },
  {
    "text": "there and if there are doubts about the exploitability of your particular vulnerability or a pathway you can delve",
    "start": "2573099",
    "end": "2578980"
  },
  {
    "text": "into that a little bit more detail saying look we have this one device this one Gateway that might be a problem do",
    "start": "2578980",
    "end": "2584800"
  },
  {
    "text": "we have a copy of that in the lab where we can test this vulnerability in the lab and then you know translate that to",
    "start": "2584800",
    "end": "2591160"
  },
  {
    "text": "the real situation or do we maybe have a maintenance window coming up in the future during which we can put out a",
    "start": "2591160",
    "end": "2598720"
  },
  {
    "text": "control test during that window so you don't damage anything but definitely you you don't want to be doing this stuff in",
    "start": "2598720",
    "end": "2605020"
  },
  {
    "text": "in any production environments so yeah that's how I'd look at it foreign",
    "start": "2605020",
    "end": "2611700"
  },
  {
    "text": "yeah yeah I'd say that's that's starting point one you know just trying to get more visibility and don't stop at your",
    "start": "2612579",
    "end": "2618700"
  },
  {
    "text": "you know level three control room don't stop at your level to scada system try to go as deep as possible and and first",
    "start": "2618700",
    "end": "2625119"
  },
  {
    "text": "make a good map because otherwise you you can defend",
    "start": "2625119",
    "end": "2629819"
  },
  {
    "text": "yeah so there's there's a couple of ways to go about it and historically one of the ways especially with you know the",
    "start": "2640720",
    "end": "2646359"
  },
  {
    "text": "the conservatism in in OT regarding you know touching things um passive Solutions have been quite",
    "start": "2646359",
    "end": "2652900"
  },
  {
    "text": "great so depending on where you are in the network you always have some sort of a switch and it might have a span point",
    "start": "2652900",
    "end": "2658900"
  },
  {
    "text": "at this level and you have passive solutions that see the network communications going on and based on",
    "start": "2658900",
    "end": "2664599"
  },
  {
    "text": "that are able to extract asset information um and some of sometimes you can take a",
    "start": "2664599",
    "end": "2669700"
  },
  {
    "text": "few regular engineering actions to collect a little bit additional information and then you build a map like that increasingly however there um",
    "start": "2669700",
    "end": "2678280"
  },
  {
    "text": "there are many capabilities that do active probing so for some protocols",
    "start": "2678280",
    "end": "2683319"
  },
  {
    "text": "there have been active probes developed where you can do a relatively robust query where you can say this is fully",
    "start": "2683319",
    "end": "2689619"
  },
  {
    "text": "protocol conformant it's not you know touching all these devices at the same time you can say only query this",
    "start": "2689619",
    "end": "2696099"
  },
  {
    "text": "particular device and not its redundant you know brother and query it you know only in a safe protocol conformant way",
    "start": "2696099",
    "end": "2703180"
  },
  {
    "text": "and you can get some information like that so there are solutions and and forescout you know has these",
    "start": "2703180",
    "end": "2708700"
  },
  {
    "text": "capabilities to be able to see that kind of visibility in these networks at different layers but um yeah it's it's",
    "start": "2708700",
    "end": "2714880"
  },
  {
    "text": "certainly one of the bigger challenges cheers",
    "start": "2714880",
    "end": "2720040"
  },
  {
    "text": "any any other questions",
    "start": "2720040",
    "end": "2723480"
  },
  {
    "text": "all right and thank you",
    "start": "2725200",
    "end": "2729480"
  }
]