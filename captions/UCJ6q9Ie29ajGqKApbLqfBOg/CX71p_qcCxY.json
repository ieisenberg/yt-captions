[
  {
    "start": "0",
    "end": "70000"
  },
  {
    "text": "good afternoon welcome to chip glitching",
    "start": "0",
    "end": "5400"
  },
  {
    "text": "the silicon of the connected world this is Lagoon JKL",
    "start": "5400",
    "end": "10800"
  },
  {
    "text": "and our speakers are josh co and thomas roth - hello welcome to chip top failure",
    "start": "10800",
    "end": "23070"
  },
  {
    "text": "so to get started who are we so we had team of three persons unfortunately only",
    "start": "23070",
    "end": "29039"
  },
  {
    "text": "two of us can be here today we have Dimitri neat auspice off with a PhD in chip security if Josh stetko and myself",
    "start": "29039",
    "end": "37649"
  },
  {
    "text": "Thomas Roth and yeah before we start we have some special thanks to Colin or",
    "start": "37649",
    "end": "43680"
  },
  {
    "text": "Flynn who helped us out with a ton of questions on the details and really on what are we doing",
    "start": "43680",
    "end": "49140"
  },
  {
    "text": "he's a hardware blockchain expert you should totally check out his talk later today he's also an author of circuits",
    "start": "49140",
    "end": "55289"
  },
  {
    "text": "summer so if you want to get your copy signed he'll be happy to do it for you and he's also the Builder of the chip",
    "start": "55289",
    "end": "62070"
  },
  {
    "text": "Whisperer which is a wonderful device for for glitching for differential power analysis and so on in this talk we want",
    "start": "62070",
    "end": "71189"
  },
  {
    "start": "70000",
    "end": "70000"
  },
  {
    "text": "to give you three core takeaways first off glitching is easier than you think so 9 months ago I never a glitch the",
    "start": "71189",
    "end": "78630"
  },
  {
    "text": "chip and now we've glitched a couple of them and you really don't need to know",
    "start": "78630",
    "end": "83729"
  },
  {
    "text": "much about hardware it's really easy to do if you get the basics down and it can",
    "start": "83729",
    "end": "89880"
  },
  {
    "text": "also become part of your software and hardware development life cycle we don't need to rely on other people to tell you whether your chip is susceptible to",
    "start": "89880",
    "end": "96180"
  },
  {
    "text": "glitching but we want to show you how can how you can do it yourself and how you can do it yourself cheaply yeah why",
    "start": "96180",
    "end": "104280"
  },
  {
    "text": "are we here so we all do a lot of hardware and software security consulting and we suddenly see chips",
    "start": "104280",
    "end": "110640"
  },
  {
    "text": "being considered as part of the threat model and if we talk about the threat of glitching a lot of people seem to think",
    "start": "110640",
    "end": "117270"
  },
  {
    "text": "that glitching is magic and that it's really hard to do and that it's not a realistic attack scenario and we want to",
    "start": "117270",
    "end": "124020"
  },
  {
    "text": "change this we want to make it more accessible we want to to really show how easy it is to do and why is this getting",
    "start": "124020",
    "end": "130739"
  },
  {
    "text": "more important and why is this interesting well you can basically apply the methodology of hack once and break-in",
    "start": "130739",
    "end": "137040"
  },
  {
    "start": "131000",
    "end": "131000"
  },
  {
    "text": "everywhere if you manage to break break at single-chip you can break any device that's based on this chip and you",
    "start": "137040",
    "end": "142650"
  },
  {
    "text": "basically have a general O'Day that is unfixable without the new hardware version we also think that security",
    "start": "142650",
    "end": "149340"
  },
  {
    "text": "devices are essential for a lot of use cases and so we want to see chip vendors and also developers improve their",
    "start": "149340",
    "end": "156450"
  },
  {
    "text": "protections against glitching and also as you will see even chips that claim",
    "start": "156450",
    "end": "162270"
  },
  {
    "text": "they are very secure might not be as secure as you would want them to be so",
    "start": "162270",
    "end": "168209"
  },
  {
    "text": "if you start off what is Fault injections so fault injection is a term mainly used by professionals who we in",
    "start": "168209",
    "end": "175110"
  },
  {
    "text": "the hacker community just call it glitching and the idea behind glitching is you basically introduce faults into",
    "start": "175110",
    "end": "182400"
  },
  {
    "text": "your chips so for example you cut the power for a very very short amount of time and see how the chip behaves you",
    "start": "182400",
    "end": "188880"
  },
  {
    "text": "change the period of the clock signal or if you're calling you start injecting electromagnetic shocks",
    "start": "188880",
    "end": "194940"
  },
  {
    "text": "basically pointing a laser at your processor what we'll talk about today is",
    "start": "194940",
    "end": "201300"
  },
  {
    "text": "mainly voltage glitching and so the idea behind voltage glitching is that we cut the power to the chip for a very very",
    "start": "201300",
    "end": "207989"
  },
  {
    "text": "short amount of time and at a very very precisely timed moment and this can cause undefined behavior and so for",
    "start": "207989",
    "end": "214769"
  },
  {
    "text": "example if you look at the data sheet of the chip it defines the safe operating area in which you basically see how with",
    "start": "214769",
    "end": "221670"
  },
  {
    "text": "the chip is stable in these conditions but what happens if we go beyond these",
    "start": "221670",
    "end": "227340"
  },
  {
    "text": "conditions and start doing some interesting stuff so for example we could as shown on this video introduce a",
    "start": "227340",
    "end": "235410"
  },
  {
    "text": "very short drop in the power pulse and this can cause a lot of strange behavior and so just to summarize the basic idea",
    "start": "235410",
    "end": "242310"
  },
  {
    "text": "behind glitching is you wait for a trigger event you wait for a certain delay and then you run your glitch and",
    "start": "242310",
    "end": "248130"
  },
  {
    "text": "then you hope to do something interesting so for example if you do this on a device you might trigger on",
    "start": "248130",
    "end": "254070"
  },
  {
    "text": "device boot you wait until you're right in the bootloader you glitch during the firmware validation check and you might",
    "start": "254070",
    "end": "260370"
  },
  {
    "text": "be able to do the modified firmware and some very susceptible parts in the chip",
    "start": "260370",
    "end": "266340"
  },
  {
    "text": "are for example flash reads basically if you if you read flash data it takes a lot of power in the chip now",
    "start": "266340",
    "end": "273340"
  },
  {
    "start": "268000",
    "end": "268000"
  },
  {
    "text": "we can interrupt this power and if that happens we basically get back undefined or garbled data so for example here we",
    "start": "273340",
    "end": "280210"
  },
  {
    "text": "have a power trace of a boot up of a chip basically this area is where the boot ROM the the code that is embedded",
    "start": "280210",
    "end": "288130"
  },
  {
    "text": "in the chip is ran and we can see there's a huge power spike where the flash loads start and we can do the same",
    "start": "288130",
    "end": "295000"
  },
  {
    "text": "with RAM so let's for example say we have a bootloader that has a method we call to check whether the firmware that",
    "start": "295000",
    "end": "301810"
  },
  {
    "start": "296000",
    "end": "296000"
  },
  {
    "text": "is on the device is valid and then we have a simple boolean check if firmware is valid then we boot our our firmware",
    "start": "301810",
    "end": "309510"
  },
  {
    "text": "but if we manage to insert the glitch write it as this check if we manage to",
    "start": "309510",
    "end": "314919"
  },
  {
    "text": "flip a single bit the boolean condition will evaluate to true and suddenly we are able to boot for example a",
    "start": "314919",
    "end": "321039"
  },
  {
    "text": "compromised firmware so yeah how do you",
    "start": "321039",
    "end": "326800"
  },
  {
    "text": "actually do this my colleague Josh is kind of walk you through it",
    "start": "326800",
    "end": "332130"
  },
  {
    "text": "all right so we're gonna talk about the three steps to success so what are the",
    "start": "332130",
    "end": "339430"
  },
  {
    "start": "337000",
    "end": "337000"
  },
  {
    "text": "three methods that we have to do to apply the method of looking at a new target and getting ready well there's",
    "start": "339430",
    "end": "344889"
  },
  {
    "text": "always a prepare step so that's step number one then we have to write some firmware so unfortunately if your",
    "start": "344889",
    "end": "350740"
  },
  {
    "text": "Hardware person this this is the part you don't like or if you're a firmware person this is what you would like to do but we have to write some firmware and",
    "start": "350740",
    "end": "356860"
  },
  {
    "text": "then we hook it up and butch it so part 1 prepping the device so in this part we",
    "start": "356860",
    "end": "365139"
  },
  {
    "start": "365000",
    "end": "365000"
  },
  {
    "text": "have to do some research about the target that we're interested in and we have to read the datasheet and get some",
    "start": "365139",
    "end": "371169"
  },
  {
    "text": "information specifically for voltage glitching we're very interested in how the power demeans are set up and most",
    "start": "371169",
    "end": "380610"
  },
  {
    "text": "modern microcontrollers are going to have multiple different voltages especially as they migrate into systems",
    "start": "380610",
    "end": "386620"
  },
  {
    "text": "on shipping and get more complicated for example there could be a main VCC if 3.3",
    "start": "386620",
    "end": "392710"
  },
  {
    "text": "volts that also could be the mean and logic i/o so that also could be 3.3 volts however the CPU core and the logic",
    "start": "392710",
    "end": "400210"
  },
  {
    "text": "for the CPU may run at a lower of Oh point seven to 1.2 volts and depending on the chip that may either be",
    "start": "400210",
    "end": "406660"
  },
  {
    "text": "fed in externally or it's internally regulated lastly if there's a radio like",
    "start": "406660",
    "end": "413440"
  },
  {
    "text": "Wi-Fi or Bluetooth or something that may require a different voltage so all this is we are just doing this reconnaissance",
    "start": "413440",
    "end": "419020"
  },
  {
    "text": "trying to gather information about the chip we're trying to talk understand the power domains so if we look at you know",
    "start": "419020",
    "end": "426190"
  },
  {
    "text": "the datasheet we may see something like this this is the NRF I believe and NRF",
    "start": "426190",
    "end": "432070"
  },
  {
    "text": "52 which is a popular Bluetooth chip found the many IOT devices and this is",
    "start": "432070",
    "end": "437860"
  },
  {
    "text": "just a diagram explaining how some of the internal power circuitry works and this is really useful because we really",
    "start": "437860",
    "end": "444160"
  },
  {
    "text": "going to need this information to help build out the glitcher so let's make",
    "start": "444160",
    "end": "450760"
  },
  {
    "text": "block diagrams because block diagrams are fun and so let's take the microcontroller and we were kind of",
    "start": "450760",
    "end": "455860"
  },
  {
    "text": "using this example a CPU core Wi-Fi IP block and GPIO we have these three",
    "start": "455860",
    "end": "462840"
  },
  {
    "text": "voltages in this hypothetical example there all right now they're being fed by",
    "start": "462840",
    "end": "468310"
  },
  {
    "text": "three three but internally they're doing different things and that makes a difference because well internally we",
    "start": "468310",
    "end": "475630"
  },
  {
    "text": "may want to be touching different parts of the logic so there's could be this core regulator that comes in two three",
    "start": "475630",
    "end": "481480"
  },
  {
    "text": "three the feed the CPU core there could be also a different voltage regulator to drop the voltage down to one point three",
    "start": "481480",
    "end": "488850"
  },
  {
    "text": "and so we're just kind of building out the block diagram here and so then also",
    "start": "488850",
    "end": "494890"
  },
  {
    "text": "three three might just have no regulator because it's going right to the GPIO IP block so that's all useful information",
    "start": "494890",
    "end": "502030"
  },
  {
    "text": "well you know now we know how and we have a hypothesis how the internal IP voltage and power systems work let's now",
    "start": "502030",
    "end": "510430"
  },
  {
    "text": "look externally so externally the chip we have this capacitor and so that those",
    "start": "510430",
    "end": "516729"
  },
  {
    "text": "two lines there on that thing is just the electrical symbol for capacitor and it's external to the chip and this is",
    "start": "516729",
    "end": "524229"
  },
  {
    "text": "often recommended by microcontrollers if you look in the reference design and",
    "start": "524229",
    "end": "529300"
  },
  {
    "text": "because what this external capacitor does is to use the software example if you are",
    "start": "529300",
    "end": "535889"
  },
  {
    "text": "familiar with databases you know you've got MongoDB but that's it's really expensive to go talk to MongoDB so what",
    "start": "535889",
    "end": "541319"
  },
  {
    "text": "do you need from that obviously you need memcached so memcache acts as this little cache that's quicker to access",
    "start": "541319",
    "end": "546810"
  },
  {
    "text": "than going all these back to kind of a similar idea with external capacitors you can go all the way back",
    "start": "546810",
    "end": "552300"
  },
  {
    "text": "to the power source and get that voltage but if you have an external capacitor there kind of acts like a little bit of",
    "start": "552300",
    "end": "557459"
  },
  {
    "text": "a cache and so if you take those external capacitors off it's stable I",
    "start": "557459",
    "end": "564329"
  },
  {
    "text": "mean we're getting 3.3 volts but it's very fuzzy and so that very fuzzy signal is indicative that there's lots of",
    "start": "564329",
    "end": "570660"
  },
  {
    "text": "ripple in the power supply this is the fact we're going to exploit when we do the glitch but this this isn't what if",
    "start": "570660",
    "end": "577259"
  },
  {
    "text": "you're trying to build something this is really not what you want you want the capacitor there to get a nice clean",
    "start": "577259",
    "end": "584220"
  },
  {
    "text": "three point three single trace so for glitching though give her those caps now",
    "start": "584220",
    "end": "590730"
  },
  {
    "text": "the other thing that's interesting is you know in we've done over Conesus we look at this datasheet we're trying to",
    "start": "590730",
    "end": "597000"
  },
  {
    "text": "glitch the logic what's nice about this block diagram is that that logic pin",
    "start": "597000",
    "end": "603029"
  },
  {
    "text": "that's coming out external to the capacitor that bypasses this core regulators and so what's really nice is",
    "start": "603029",
    "end": "610920"
  },
  {
    "text": "when we remove that capacitor take it out of place we can potentially access",
    "start": "610920",
    "end": "616199"
  },
  {
    "text": "that that voltage to that logic port directly and so that's going to be very useful for us later on and so sometimes",
    "start": "616199",
    "end": "625319"
  },
  {
    "text": "this is called BDD core there could be different names on the datasheet but the",
    "start": "625319",
    "end": "630959"
  },
  {
    "text": "the key insight here is that we have a nice direct access to the internal CPU core we don't have to provide just three",
    "start": "630959",
    "end": "636870"
  },
  {
    "text": "three because that voltage regulator is kind of in the way it's going to be messing things up and now we can supply",
    "start": "636870",
    "end": "642029"
  },
  {
    "text": "voltage directly to the CPU recorder so this we're sticking with the NRF example",
    "start": "642029",
    "end": "648329"
  },
  {
    "text": "this is just the NRF 52 on kind of a breakout board in a slightly productized",
    "start": "648329",
    "end": "653850"
  },
  {
    "text": "form and this is again we look at the ditch the method is look at the data",
    "start": "653850",
    "end": "659250"
  },
  {
    "text": "sheet get some information we now we know there's external capacitors that we may want to remove to get better access",
    "start": "659250",
    "end": "664680"
  },
  {
    "text": "so those things in red are those external capacitors they're in the way you know",
    "start": "664680",
    "end": "672180"
  },
  {
    "text": "we want to get rid of those however this is the point where you know trying to do",
    "start": "672180",
    "end": "677820"
  },
  {
    "start": "674000",
    "end": "674000"
  },
  {
    "text": "it ghost attack is also I should say more art than science there's a lot of factors that can cause an issue one of",
    "start": "677820",
    "end": "685380"
  },
  {
    "text": "which is if the manufacturer is recommending that you add capacitors to make your system be more stable removing",
    "start": "685380",
    "end": "693570"
  },
  {
    "text": "them makes them more unstable some chips may not boot without them so kind of",
    "start": "693570",
    "end": "698970"
  },
  {
    "text": "depends on the chip but if you take those out may not run stable however so",
    "start": "698970",
    "end": "705900"
  },
  {
    "text": "for a VD core we can overcome this and we can provide a nice clean VDD core",
    "start": "705900",
    "end": "712110"
  },
  {
    "text": "directly with an external power supply so we're big fans of these cheap",
    "start": "712110",
    "end": "717870"
  },
  {
    "text": "programmable external power supplies you basically cut a wall work you wire it up",
    "start": "717870",
    "end": "723210"
  },
  {
    "text": "and then you've got a nice custom wall power supply and there's even open firmware for this and it has a serial",
    "start": "723210",
    "end": "730380"
  },
  {
    "text": "interface if you dig around and you can control it externally so relatively cheap and super fun if you need extra",
    "start": "730380",
    "end": "737730"
  },
  {
    "text": "volt power supply so this is kind of our go-to power supply and yeah so the",
    "start": "737730",
    "end": "743280"
  },
  {
    "text": "insight then again is we don't want to glitch 3.34 this microcontroller because",
    "start": "743280",
    "end": "749070"
  },
  {
    "text": "that poor regulators in the way regulator is going to be fighting the glitch we want to go directly to the",
    "start": "749070",
    "end": "754140"
  },
  {
    "text": "logic or so that's mainly where the interesting things are happening so we",
    "start": "754140",
    "end": "759270"
  },
  {
    "text": "provide that external voltage and we that's where we conclude and if you look",
    "start": "759270",
    "end": "765500"
  },
  {
    "text": "this is basically you know we took the this board remove the capacitor soldered",
    "start": "765500",
    "end": "771120"
  },
  {
    "text": "or wire and now we're directly where we want to be we've got tapped to the Vedic or the media core in this case and so",
    "start": "771120",
    "end": "779250"
  },
  {
    "text": "this is basically and that's all the prep that you have to do so so it's a lot of paperwork I mean a lot of reading",
    "start": "779250",
    "end": "784830"
  },
  {
    "text": "the paperwork it's a lot of you know learning about the chip but the actual physical hands-on prep for this one was",
    "start": "784830",
    "end": "790500"
  },
  {
    "text": "just once you have figured out where that is remove the capacitors at the wire",
    "start": "790500",
    "end": "795820"
  },
  {
    "text": "okay so this is now we're going to be talking about what's the test firmware that we have to write and so this is not",
    "start": "795820",
    "end": "804290"
  },
  {
    "text": "unlike traditional embedded development where we have to do us to bring up so",
    "start": "804290",
    "end": "809360"
  },
  {
    "text": "it's very dependent on the manufacturer of the chip and this is where you it's either super easy if someone else has",
    "start": "809360",
    "end": "815899"
  },
  {
    "text": "done it and you copy the project win or you actually have to download the vendors that's okay and then figure out",
    "start": "815899",
    "end": "821360"
  },
  {
    "text": "why that doesn't compile and fight through lots of problems of why you can't get the blue key to work so but",
    "start": "821360",
    "end": "828279"
  },
  {
    "text": "basically we're trying to keep the firmware very simple we really just want to initialize the system we need to",
    "start": "828279",
    "end": "834800"
  },
  {
    "text": "provide a good clean trigger for the glitcher to work and we need to also",
    "start": "834800",
    "end": "839899"
  },
  {
    "text": "know when we're done so we know what does this look like when we build this firmware so if we kind of think about an",
    "start": "839899",
    "end": "846470"
  },
  {
    "text": "Arduino example so Arduino is a nice simple API it's pretty clear you know",
    "start": "846470",
    "end": "852769"
  },
  {
    "text": "when here we're gonna walk through basically this example firmware and this is all you would need to write for a",
    "start": "852769",
    "end": "858529"
  },
  {
    "text": "test target or something similar so and the device has the boot you know so the",
    "start": "858529",
    "end": "864889"
  },
  {
    "text": "boot rom is going to take care of that for us and then it's going to launch user code and then once we get into user",
    "start": "864889",
    "end": "871550"
  },
  {
    "text": "space we have to do things like perhaps configure clocks so whatever clock speed",
    "start": "871550",
    "end": "877190"
  },
  {
    "text": "you want to write enable or disable the Breanna detector configure some pins and here we're setting these two pins to the",
    "start": "877190",
    "end": "882949"
  },
  {
    "text": "output then we have to set the pin to trigger as a high so in the kind of you",
    "start": "882949",
    "end": "889310"
  },
  {
    "text": "know where we're at is we're kind of talking about generic approach to glitching a glitching a chip and this",
    "start": "889310",
    "end": "895490"
  },
  {
    "text": "stage we're talking about making just kind of the generic firmware and so to make it easy on ourselves we just toggle",
    "start": "895490",
    "end": "900620"
  },
  {
    "text": "the GPIO high and we can have a nice clean trigger for any system and that's exactly what we do then the you know",
    "start": "900620",
    "end": "909860"
  },
  {
    "text": "what it is that to get this indicator of success what we're looking at is we're looking at a flash lead and so we're",
    "start": "909860",
    "end": "915709"
  },
  {
    "text": "gonna be talking into it that's that's interesting because there's code there and there could be a secrets there and",
    "start": "915709",
    "end": "922370"
  },
  {
    "text": "so we're particularly interested to see if our glitch effect affected a flash read so basically what",
    "start": "922370",
    "end": "930470"
  },
  {
    "text": "we do is we loop we have something known in the flash I'm that could be data that you sucked in there could be some of the",
    "start": "930470",
    "end": "936800"
  },
  {
    "text": "code somehow you know what's interpret what the flash reads should be and we just loop around and then eventually",
    "start": "936800",
    "end": "944350"
  },
  {
    "text": "when we're going to apply the glitch if it's not what's expected we went right",
    "start": "944350",
    "end": "950720"
  },
  {
    "text": "so the glitch was successful you would expect my controller to always consistently read the same thing from",
    "start": "950720",
    "end": "955850"
  },
  {
    "text": "flash right so you would think this you know shouldn't exit but it does when we apply a bunch and so what does this look",
    "start": "955850",
    "end": "964399"
  },
  {
    "text": "like on an oscilloscope and so this is just an example these are the two traces",
    "start": "964399",
    "end": "969589"
  },
  {
    "text": "of those two GPIO pins we were previously talking about and let's just go through those steps of what you would",
    "start": "969589",
    "end": "975110"
  },
  {
    "text": "expect to see on a sillas cope which is very helpful when you're trying to do this kind of attack so you start off the",
    "start": "975110",
    "end": "982819"
  },
  {
    "text": "microcontroller has booted now in this section it's preparing the system clocks doing all that system bring up stuff",
    "start": "982819",
    "end": "989089"
  },
  {
    "text": "that we just have to do in order to run our to run our code so here's where the",
    "start": "989089",
    "end": "995029"
  },
  {
    "text": "more interesting bits start we have to trigger the event for the Glitter so this is just we artificially in this",
    "start": "995029",
    "end": "1000970"
  },
  {
    "text": "case meet at the GPIO high on a real target this could be something else and",
    "start": "1000970",
    "end": "1007050"
  },
  {
    "text": "then there's but one of the key parameters and the Glitter is how much to delay right so we're trying to we're",
    "start": "1007050",
    "end": "1014860"
  },
  {
    "text": "trying to glitch that flash free that happened in that loop so the glitcher takes this thomas mentioned there's this",
    "start": "1014860",
    "end": "1021360"
  },
  {
    "text": "programmable delay that we can take and this is what we see in the next scope trace then we insert the glitch and so",
    "start": "1021360",
    "end": "1028630"
  },
  {
    "text": "this is where we're hoping that we get that exact precise moment to trigger the glitch or if the insert the glitch and",
    "start": "1028630",
    "end": "1034949"
  },
  {
    "text": "what happens well that depends on what your indicator of success was so in this",
    "start": "1034949",
    "end": "1040900"
  },
  {
    "text": "case yeah so that could be you know we've got another GPIO signal we've broken out something happen on serial",
    "start": "1040900",
    "end": "1046928"
  },
  {
    "text": "but however you set up that system that's the indicator and so yeah part",
    "start": "1046929",
    "end": "1053049"
  },
  {
    "text": "three of this is talking about you know what is the culture that we made",
    "start": "1053049",
    "end": "1058430"
  },
  {
    "text": "okay so the chip that fell glitcher consists of mainly three main components",
    "start": "1058430",
    "end": "1063860"
  },
  {
    "start": "1059000",
    "end": "1059000"
  },
  {
    "text": "there is this FPGA and so we were using the digital and C mod a seven so it's",
    "start": "1063860",
    "end": "1070920"
  },
  {
    "text": "just a Arctic's FPGA it's about 70 US dollars it's has one Piemonte connector",
    "start": "1070920",
    "end": "1079230"
  },
  {
    "text": "has a nice USB UART pretty small we need a the other component that were",
    "start": "1079230",
    "end": "1086640"
  },
  {
    "text": "using is we were talking about there's lots of signals we want to be able to drop the voltage so there's a couple",
    "start": "1086640",
    "end": "1091680"
  },
  {
    "text": "different techniques for that the thing that we're using is an analog switch or a multiplexer and that's what the middle",
    "start": "1091680",
    "end": "1098940"
  },
  {
    "text": "board is so that multiplexer costs about a dollar eighty in single quantity and",
    "start": "1098940",
    "end": "1104750"
  },
  {
    "text": "that goes on the Piemonte connector there and then we need that DPS 3003",
    "start": "1104750",
    "end": "1111270"
  },
  {
    "text": "power supply because which is about twenty bucks and that's going to help feed in the",
    "start": "1111270",
    "end": "1116580"
  },
  {
    "text": "voltages that we want and so yeah the nice things about using an FPGA is we get super precise timing timing down to",
    "start": "1116580",
    "end": "1123750"
  },
  {
    "start": "1119000",
    "end": "1119000"
  },
  {
    "text": "the so we can control individual clock cycles which isn't I mean we get that clock cycle precision running at 100",
    "start": "1123750",
    "end": "1130650"
  },
  {
    "text": "megahertz and yeah part of this as we're gonna be really seeing the Vera log for",
    "start": "1130650",
    "end": "1136020"
  },
  {
    "text": "this project as well and so the P mod specifically is using the max 4619 it's",
    "start": "1136020",
    "end": "1144330"
  },
  {
    "start": "1139000",
    "end": "1139000"
  },
  {
    "text": "a three channel analog switch and it has a nice Pima it has a nice it's a",
    "start": "1144330",
    "end": "1150600"
  },
  {
    "text": "standard Pima header on one end on the other jumper is a standard point one inch header easy for bread boarding we",
    "start": "1150600",
    "end": "1158250"
  },
  {
    "text": "do have PCBs with us so I brought like 200 or some so if you see me afterwards",
    "start": "1158250",
    "end": "1164370"
  },
  {
    "text": "if I'll happily give you a PCB and this is now we're just you know what is this analog switch for those that are you",
    "start": "1164370",
    "end": "1170550"
  },
  {
    "text": "know I'm familiar with how this works basically so there's there's three channels right now we're just talking",
    "start": "1170550",
    "end": "1176160"
  },
  {
    "text": "about one channel Channel X and so channel for any channel X that being the",
    "start": "1176160",
    "end": "1182070"
  },
  {
    "text": "output there could be two different inputs so typically what we our inputs",
    "start": "1182070",
    "end": "1187680"
  },
  {
    "text": "are usually some voltage level and ground so X zero would be 1.2 volts for a VDD core x1",
    "start": "1187680",
    "end": "1194400"
  },
  {
    "text": "will be ground and what we want to do is switch between them and so the way that works with an analog switch is you apply",
    "start": "1194400",
    "end": "1200130"
  },
  {
    "text": "power or it's also called enable signal and it'll switch over and so it's a",
    "start": "1200130",
    "end": "1206429"
  },
  {
    "text": "three channel so all that is when you do that in three channels is it looks like this and so now there's a lot of wires",
    "start": "1206429",
    "end": "1211890"
  },
  {
    "text": "going on there but it's one channel multiplying and yeah that power supply",
    "start": "1211890",
    "end": "1218520"
  },
  {
    "text": "we talked about immediately we're using it to supply VDD core like I said control about UART which is super nice",
    "start": "1218520",
    "end": "1225030"
  },
  {
    "text": "get them on you can get them on Amazon and when you hook up all this together you have the FPGA so we're using that as",
    "start": "1225030",
    "end": "1231990"
  },
  {
    "start": "1228000",
    "end": "1228000"
  },
  {
    "text": "the main so there's a post software that's driving this with Python talking to the FPGA over UART and then it has",
    "start": "1231990",
    "end": "1239070"
  },
  {
    "text": "the trigger pin to know when to trigger the glitch it has this a success indicator and so that you know depends",
    "start": "1239070",
    "end": "1245850"
  },
  {
    "text": "on what the particular target is we have the power an able signal going to them the MUX to switch between the two",
    "start": "1245850",
    "end": "1251610"
  },
  {
    "text": "voltages there's also the glitch an evil signal that is doing the same thing into VDD core and all of us going to your",
    "start": "1251610",
    "end": "1258480"
  },
  {
    "text": "device under test and yeah so we're gonna put this all together and I've",
    "start": "1258480",
    "end": "1263790"
  },
  {
    "text": "since wasn't a big believer in 3d modeling things first because it's like",
    "start": "1263790",
    "end": "1268950"
  },
  {
    "text": "I make the PCB get everything hooked up then see what it looks like afterwards sometimes I'm starting to learn that",
    "start": "1268950",
    "end": "1275580"
  },
  {
    "text": "it's useful to do a 3d modeling before because sometimes you have some fails like when you have the P mod and the",
    "start": "1275580",
    "end": "1282900"
  },
  {
    "start": "1281000",
    "end": "1281000"
  },
  {
    "text": "glitcher now you have to stack them vertically and it kind of sticks up like a nice L connector so protip 3d model",
    "start": "1282900",
    "end": "1290790"
  },
  {
    "text": "it's getting easier with lots of different CAD tools you'll see embarrassment on slides and now we're",
    "start": "1290790",
    "end": "1297630"
  },
  {
    "text": "ready to glitch awesome yes so um thanks Josh so you know that we know all the",
    "start": "1297630",
    "end": "1304230"
  },
  {
    "text": "components that are involved in glitch in your board let's actually go about doing it so you asset for the FPGA we",
    "start": "1304230",
    "end": "1310530"
  },
  {
    "start": "1310000",
    "end": "1310000"
  },
  {
    "text": "need a minute a bit stream which is basically the firmware of an FPGA and our FPGA bitstream provides a very",
    "start": "1310530",
    "end": "1317490"
  },
  {
    "text": "simple serial interface that lets you adjust the settings such as the pulse width the power reset the delay between",
    "start": "1317490",
    "end": "1324809"
  },
  {
    "text": "trigger and the glitch and also some other options such as whether you want to power cycle the device on on every",
    "start": "1324809",
    "end": "1330330"
  },
  {
    "text": "glitch attempt and inspired by the new chip Whisperer we actually build a full control library in Jupiter notebook so",
    "start": "1330330",
    "end": "1338190"
  },
  {
    "start": "1335000",
    "end": "1335000"
  },
  {
    "text": "this is super easy to use as basically self-documenting so you just open the",
    "start": "1338190",
    "end": "1343289"
  },
  {
    "text": "jupiter notebook you configure the serial port and then you can write a really really simple admitting software",
    "start": "1343289",
    "end": "1350279"
  },
  {
    "start": "1349000",
    "end": "1349000"
  },
  {
    "text": "in like I don't know 20 lines of code and basically all you have to do to configure the glitcher is you set up",
    "start": "1350279",
    "end": "1357600"
  },
  {
    "text": "power pools which is basically how long do you need to cut the power to fully power of the device because sometimes",
    "start": "1357600",
    "end": "1363990"
  },
  {
    "text": "you will get stuck and you need to reboot it and so on then we basically just have a success indicator we iterate",
    "start": "1363990",
    "end": "1371999"
  },
  {
    "text": "over a delay range so for example you the key to glitching is trying a million different delays trying a million",
    "start": "1371999",
    "end": "1378749"
  },
  {
    "text": "different pulls with and so on and you can automate this really easy in a couple of lines you just do a loop",
    "start": "1378749",
    "end": "1384539"
  },
  {
    "text": "between delay from and delay to you set the command to set that delay to you the",
    "start": "1384539",
    "end": "1390029"
  },
  {
    "text": "glitching board we just have a success indicator to break later on and then we",
    "start": "1390029",
    "end": "1395730"
  },
  {
    "text": "just iterate over a range of pulses and so basically what this does is it's just it says how long is the each pulse",
    "start": "1395730",
    "end": "1401909"
  },
  {
    "text": "actually active and this varies massively depending on your target so for example if your chip is running",
    "start": "1401909",
    "end": "1407129"
  },
  {
    "text": "really really quickly at 100 megahertz you want this to be really really short but if you're targeting a slower chip",
    "start": "1407129",
    "end": "1413009"
  },
  {
    "text": "such as one that we will see later this can be also really really long value and then you basically just send a view to",
    "start": "1413009",
    "end": "1419940"
  },
  {
    "text": "come on to the board you wait a couple of minutes and then you for example in this case we just check the status of",
    "start": "1419940",
    "end": "1426419"
  },
  {
    "text": "the GPIO whether our success pin went high and if you did we print a nice success message and that's it so how",
    "start": "1426419",
    "end": "1433499"
  },
  {
    "text": "does this look in action so once you found some good values this is how the Glitter runs so you basically just hit",
    "start": "1433499",
    "end": "1439649"
  },
  {
    "text": "run on the jupiter notebook you can see the progress bar indicating the range of the pulse we are in and on top of that",
    "start": "1439649",
    "end": "1446789"
  },
  {
    "text": "is the delay and in this case we can see that with just roughly 200 attempts we successfully glitch the chip and that's",
    "start": "1446789",
    "end": "1453179"
  },
  {
    "text": "really all it took you so you basically take the fpga they take a multiplexer",
    "start": "1453179",
    "end": "1458309"
  },
  {
    "text": "you hook that all up into Python and you're ready to glitch no magic no expensive equipment it's really really",
    "start": "1458309",
    "end": "1463860"
  },
  {
    "text": "trivial and so let's our goals for this",
    "start": "1463860",
    "end": "1469830"
  },
  {
    "text": "we're basically two to five targets there are commonly used in IOT devices because we think this is where Musa of",
    "start": "1469830",
    "end": "1477210"
  },
  {
    "text": "the new security issues will be happening and it should be a modern ship it shouldn't be a ten-year-old ship that",
    "start": "1477210",
    "end": "1484039"
  },
  {
    "text": "doesn't have any protections anyway and we wanted to test many different vendors that we commonly see and so we went down",
    "start": "1484039",
    "end": "1491970"
  },
  {
    "text": "through the list of four main targets so the first one is the NRF 50 to 84 zero",
    "start": "1491970",
    "end": "1497850"
  },
  {
    "text": "which is a ship that is very commonly used in Bluetooth devices variables and so on so for example something like a",
    "start": "1497850",
    "end": "1504299"
  },
  {
    "text": "dash button might use it then we have the ESP 32 which is a super common Wi-Fi Bluetooth chip we have this ml 11 which",
    "start": "1504299",
    "end": "1511679"
  },
  {
    "text": "is a high security microcontroller and then the stm32 f2 and others from the",
    "start": "1511679",
    "end": "1516990"
  },
  {
    "text": "series and our goals for this were to compute the chips in real-world",
    "start": "1516990",
    "end": "1522240"
  },
  {
    "text": "conditions and just identify whether chip is susceptible to glitching attacks so the idea is not to necessarily have a",
    "start": "1522240",
    "end": "1528960"
  },
  {
    "text": "fully exploit for chips but just to give a very simple way of checking whether the chip you are going to use in your",
    "start": "1528960",
    "end": "1535080"
  },
  {
    "text": "product is susceptible to glitching or not and we also want to be able to test the chips in situ so for example we just",
    "start": "1535080",
    "end": "1541049"
  },
  {
    "text": "order bread basic development board solder off some capacitors and then we",
    "start": "1541049",
    "end": "1546150"
  },
  {
    "text": "go ahead and good chip without having to design a custom board without having to solder a lot of stuff all you need is a",
    "start": "1546150",
    "end": "1552059"
  },
  {
    "text": "hot air gun and the soldering iron and that's it so let's start with the Nordic",
    "start": "1552059",
    "end": "1557370"
  },
  {
    "text": "NRF 50 to 80 for zero so for this one we",
    "start": "1557370",
    "end": "1562530"
  },
  {
    "text": "basically use the make a diary micro dev kit which is pretty nice cassette you can you get everything but portable and",
    "start": "1562530",
    "end": "1570330"
  },
  {
    "text": "it's very commonly used in small IOT sensors and in this case as we've seen earlier the target preparation that we",
    "start": "1570330",
    "end": "1576900"
  },
  {
    "text": "need to do is really just remove a couple of capacitors so in this case it's just these six",
    "start": "1576900",
    "end": "1583760"
  },
  {
    "text": "add a crude jumper wire and now we are ready to glitch and so what we did is we",
    "start": "1583760",
    "end": "1589140"
  },
  {
    "text": "wrote a very simple test firmware that does what we saw basically you boot the chip it puts a trigger line high and then we ditch a",
    "start": "1589140",
    "end": "1596580"
  },
  {
    "start": "1591000",
    "end": "1591000"
  },
  {
    "text": "fast read and we check if we are successful in this case on the NR 52 we were successful after 1.5 hours we had a",
    "start": "1596580",
    "end": "1604950"
  },
  {
    "start": "1603000",
    "end": "1603000"
  },
  {
    "text": "successful digitech we were able to glitch application code and we managed to get this glitch attempt really stable",
    "start": "1604950",
    "end": "1611730"
  },
  {
    "text": "at roughly 100 attempts for a successful glitch we tested this against a couple of demo firmwares and we were able to",
    "start": "1611730",
    "end": "1617670"
  },
  {
    "text": "find some critical vulnerabilities in a very short amount of time using this and yeah very trivial to do and will release",
    "start": "1617670",
    "end": "1625140"
  },
  {
    "text": "both the schematic to do this and also the test firmware on our github I guess later this week the next one",
    "start": "1625140",
    "end": "1633630"
  },
  {
    "text": "that I think is really interesting is the ESP 32 because this CPU is really fast so compared to our FPGA which runs",
    "start": "1633630",
    "end": "1641220"
  },
  {
    "text": "at 100 megahertz this chip can run at 162 240 megahertz and it has Bluetooth",
    "start": "1641220",
    "end": "1647220"
  },
  {
    "text": "and Wi-Fi and it's very very commonly found in new IOT products so for example we had multiple customers who use this",
    "start": "1647220",
    "end": "1653760"
  },
  {
    "text": "chip and if you use the secure boot features of this chip and so this was a really interesting target to us and so",
    "start": "1653760",
    "end": "1660140"
  },
  {
    "text": "as we've mentioned before we need to find out which power rails do we need to attack so all you need to do is you look",
    "start": "1660140",
    "end": "1666390"
  },
  {
    "text": "into the datasheet and you find the embedded power supply and you see that there are a couple of of caps you need",
    "start": "1666390",
    "end": "1672780"
  },
  {
    "text": "to remove but unfortunately in the case of the ESP 32 you also need to get rid of this stick and and you can see that",
    "start": "1672780",
    "end": "1679170"
  },
  {
    "text": "kind of messed up the board while doing it and just sold it on some magnet wires to the weak core parts right here and",
    "start": "1679170",
    "end": "1685670"
  },
  {
    "text": "yeah and we are ready to go basically to write our test from where in the case of",
    "start": "1685670",
    "end": "1690990"
  },
  {
    "text": "the ESP 32 we actually decided to write the test former in Arduino because it's",
    "start": "1690990",
    "end": "1696540"
  },
  {
    "text": "really simple and it allows you to really simply select different clock speeds and you can see our sketch for",
    "start": "1696540",
    "end": "1701730"
  },
  {
    "text": "just testing the glitches like 30 lines or so and we basically just do a fluff",
    "start": "1701730",
    "end": "1707100"
  },
  {
    "text": "read on an address where we know the value and then once that value changes we set up a successful and committed",
    "start": "1707100",
    "end": "1714960"
  },
  {
    "text": "without glitch and to drive the board we put it in one of those nice programmer",
    "start": "1714960",
    "end": "1720240"
  },
  {
    "text": "boards which provide the 3.3 volts needed for the chip and allow us to really easily also",
    "start": "1720240",
    "end": "1725460"
  },
  {
    "text": "switch out chips after we broke them because sometimes you will break chips during doing this so yeah",
    "start": "1725460",
    "end": "1732169"
  },
  {
    "text": "oops sorry in this case we got our first successful attack after three hours and",
    "start": "1732169",
    "end": "1737190"
  },
  {
    "start": "1734000",
    "end": "1734000"
  },
  {
    "text": "so this was a day where we managed to glitch three different chips in a single day which is really amazing because it's",
    "start": "1737190",
    "end": "1742980"
  },
  {
    "text": "it takes no time to set up it takes no time to to to try anything because it",
    "start": "1742980",
    "end": "1748500"
  },
  {
    "text": "will just run on on its own we slightly have to adjust that because basically the ESP takes a very long time to boot",
    "start": "1748500",
    "end": "1755520"
  },
  {
    "text": "up and so we needed to have an enter this loop where we always push up the trigger and we couldn't just reboot it",
    "start": "1755520",
    "end": "1761460"
  },
  {
    "text": "on every test so we had to adjust the test logic a bit but you will see that in the jupiter notebooks will be releasing for the ESP now we got this",
    "start": "1761460",
    "end": "1768000"
  },
  {
    "text": "yes p32 is stable within roughly 10,000 attempts and this has some interesting",
    "start": "1768000",
    "end": "1773399"
  },
  {
    "text": "impact especially when you when you look at the secure boot features of the chip",
    "start": "1773399",
    "end": "1780350"
  },
  {
    "text": "so this chip I'm super excited about microchips ml 11 so this chip is a world",
    "start": "1780350",
    "end": "1789390"
  },
  {
    "text": "class out for low-power MCU for IOT and security and it's so secure it literally",
    "start": "1789390",
    "end": "1796919"
  },
  {
    "text": "won the best contribution to IOT security and if you just search for the word secure on the website you will find",
    "start": "1796919",
    "end": "1803700"
  },
  {
    "text": "57 minutes so this chip is 57 times more secure than some of the other chips and",
    "start": "1803700",
    "end": "1810529"
  },
  {
    "text": "if we read the datasheet one of the things that that really set us off was",
    "start": "1810529",
    "end": "1815820"
  },
  {
    "text": "basically there's a factory calibrated brownout detector on VDD core and so the",
    "start": "1815820",
    "end": "1820950"
  },
  {
    "text": "idea behind the brownout detector is it issues on the power lines and so for example if your voltage drops too low",
    "start": "1820950",
    "end": "1827130"
  },
  {
    "text": "the brownout detector will for example reboot your chip or reset your device or whatever and so we were kind of curious",
    "start": "1827130",
    "end": "1834179"
  },
  {
    "text": "whether we can glitch it and it was very surprising he said the first time we",
    "start": "1834179",
    "end": "1839490"
  },
  {
    "text": "thought we actually messed it up because we had success literally after 5 minutes so it's super susceptible to voltage",
    "start": "1839490",
    "end": "1847590"
  },
  {
    "text": "glitching it's one of it's a secure chip and what's an issue for us is basically",
    "start": "1847590",
    "end": "1853289"
  },
  {
    "text": "we have customers coming to us that want to use this chip as an HSM as a heresy",
    "start": "1853289",
    "end": "1859110"
  },
  {
    "text": "he module besides their mainship because it's so it helps so many security features but then once you start looking",
    "start": "1859110",
    "end": "1865529"
  },
  {
    "text": "at it it gets really really really easy to bypass and so for example we found a bypass of the secure reference",
    "start": "1865529",
    "end": "1872010"
  },
  {
    "text": "bootloader which runs on trap zone and basically allows you to write a validated firmware the disclosure of",
    "start": "1872010",
    "end": "1878880"
  },
  {
    "text": "that is in progress we hope to be able to release it soon and some more fun stuff on this chip and just one of the",
    "start": "1878880",
    "end": "1886590"
  },
  {
    "text": "things so just how easy is it to glitch so I come from an from South Germany and",
    "start": "1886590",
    "end": "1891600"
  },
  {
    "text": "we are really really really cheap so $100 for glitcher sounds really expensive like I don't know how many",
    "start": "1891600",
    "end": "1898470"
  },
  {
    "text": "beers that is but it's a lot so and so the idea was how cheap can we get this",
    "start": "1898470",
    "end": "1904889"
  },
  {
    "text": "glitch and so we built the five dollar picture basically we take one of the",
    "start": "1904889",
    "end": "1911220"
  },
  {
    "start": "1907000",
    "end": "1907000"
  },
  {
    "text": "cheapest microcontrollers you can find on the geeky and AAT tiny 85 the",
    "start": "1911220",
    "end": "1916409"
  },
  {
    "text": "multiplexer and you end up with roughly three or four dollars of equipment to which this high-security chip using very",
    "start": "1916409",
    "end": "1923460"
  },
  {
    "text": "sophisticated lab setup on a breadboard so yeah that's how you break the very",
    "start": "1923460",
    "end": "1931980"
  },
  {
    "text": "secure trust zone enabled microcontroller for five dollars and I",
    "start": "1931980",
    "end": "1936990"
  },
  {
    "text": "will last but not least the stm32 f2 which we call the million dollar microcontroller you will see why in just",
    "start": "1936990",
    "end": "1943919"
  },
  {
    "text": "a moment okay so now we're going to talk about the stm32 f2 a5 so some of you may",
    "start": "1943919",
    "end": "1954000"
  },
  {
    "text": "have seen her talk at well it fail we presented this at cccc last December and",
    "start": "1954000",
    "end": "1960139"
  },
  {
    "text": "we talked about all the different things mainly breaking Bitcoin hardware wallets",
    "start": "1960139",
    "end": "1965309"
  },
  {
    "text": "I promise if the word Bitcoin trig triggers you you can just think smart",
    "start": "1965309",
    "end": "1970529"
  },
  {
    "text": "fridge we're not gonna get into the application so so don't don't worry",
    "start": "1970529",
    "end": "1976080"
  },
  {
    "text": "about the word cryptocurrency Bitcoin you can just replace that in your head and all this still applies but yeah so",
    "start": "1976080",
    "end": "1983220"
  },
  {
    "text": "we did this talk there was lots of previous work on this there was a one",
    "start": "1983220",
    "end": "1989370"
  },
  {
    "start": "1985000",
    "end": "1985000"
  },
  {
    "text": "the papers had not yet been released believe it was how to apply at all the",
    "start": "1989370",
    "end": "1995550"
  },
  {
    "text": "verifying code read out protection claims and so that's that's now public so you can go read that paper and yeah",
    "start": "1995550",
    "end": "2002390"
  },
  {
    "text": "so let's now deep dive on the stm32 so the sem 32 F 205 is a general-purpose",
    "start": "2002390",
    "end": "2008570"
  },
  {
    "text": "microcontroller it's an arm cortex-m 3 a very popular chip for there's a lots of",
    "start": "2008570",
    "end": "2016070"
  },
  {
    "text": "oh it's a just general-purpose microcontroller can be used in all sorts of things it's also used as one of the",
    "start": "2016070",
    "end": "2022820"
  },
  {
    "text": "main reference designs for a Bitcoin cryptocurrency wallet in this product",
    "start": "2022820",
    "end": "2028280"
  },
  {
    "text": "called the treasurer so you know Thomas looked at 11 we saw the security 57",
    "start": "2028280",
    "end": "2034550"
  },
  {
    "text": "times secure so we want to look at the data sheet for the stm32 and see how many times it mentions security not many",
    "start": "2034550",
    "end": "2042440"
  },
  {
    "text": "times so I mean this is we got the nice frowny face trying to find the word security and that's because this is a",
    "start": "2042440",
    "end": "2049669"
  },
  {
    "text": "general-purpose microcontroller it's not meant for the doesn't even mention",
    "start": "2049669",
    "end": "2055490"
  },
  {
    "text": "security and the thing but it does have an interesting feature of readout protection and so in this family of",
    "start": "2055490",
    "end": "2062419"
  },
  {
    "text": "microcontrollers this is the from the SD micros website there's different ones",
    "start": "2062419",
    "end": "2067940"
  },
  {
    "text": "for different configurations and different cortexes m0 core m3 m4 and now",
    "start": "2067940",
    "end": "2075740"
  },
  {
    "text": "basically there is a boot ROM or glitches clutch attacks for these",
    "start": "2075740",
    "end": "2081230"
  },
  {
    "text": "susceptible chips to this family and and yeah so that's the crosses are starting",
    "start": "2081230",
    "end": "2088220"
  },
  {
    "text": "to stack up and this one is yeah so and then yeah that for the four would also",
    "start": "2088220",
    "end": "2095090"
  },
  {
    "text": "be an interesting one the seeks that's also when it's not yet done but that one has like a mega flash and is also very",
    "start": "2095090",
    "end": "2100940"
  },
  {
    "text": "popular as well and the SD and micro family so we talked about previously we",
    "start": "2100940",
    "end": "2106520"
  },
  {
    "text": "have to do some research we have to kind of figure out about the attack we want to do and if the firmware is pretty",
    "start": "2106520",
    "end": "2113180"
  },
  {
    "text": "decent we may not be able to get an application level glitch so a few years ago I gave a talk at DEFCON tried to",
    "start": "2113180",
    "end": "2118880"
  },
  {
    "text": "glitch the treasure application code was unsuccessful and so when we all teamed up we knew we had",
    "start": "2118880",
    "end": "2124430"
  },
  {
    "text": "to move to the bootrom and so the bootrom the only really security feature",
    "start": "2124430",
    "end": "2129589"
  },
  {
    "text": "the stm32 has is this readout protection and it's not in the main data sheet",
    "start": "2129589",
    "end": "2134869"
  },
  {
    "start": "2132000",
    "end": "2132000"
  },
  {
    "text": "there's this app known you have to find but basically there's three levels of readout protection readout protection -",
    "start": "2134869",
    "end": "2140510"
  },
  {
    "text": "so now I'm just going to say RDP - now we all know the acronym our ITP 2 is the as the highest the highest security",
    "start": "2140510",
    "end": "2148280"
  },
  {
    "text": "which means you have no access our DP 0 means full access so at least secure and our DP 1 is this kind of in-between",
    "start": "2148280",
    "end": "2155240"
  },
  {
    "text": "state and what's interesting about this particular chip is how they implemented",
    "start": "2155240",
    "end": "2161030"
  },
  {
    "text": "this so there's justice if al you we're looking for and it has to be a a for our",
    "start": "2161030",
    "end": "2167420"
  },
  {
    "text": "DP 0 CC far - B - and it's not a or CC",
    "start": "2167420",
    "end": "2172880"
  },
  {
    "text": "and you're an RDP 1 so that means if we can make that not be that value we can",
    "start": "2172880",
    "end": "2180020"
  },
  {
    "text": "downgrade from our DB 2 to our DP 1 and so the way to do this is basically - so",
    "start": "2180020",
    "end": "2188420"
  },
  {
    "start": "2187000",
    "end": "2187000"
  },
  {
    "text": "look at the bootloader suite so we were able to dump the boot ROM and one of the things we were interested so we have the",
    "start": "2188420",
    "end": "2194240"
  },
  {
    "text": "hypothesis you know does already p only get read on the boot rom and so you know",
    "start": "2194240",
    "end": "2200240"
  },
  {
    "text": "we looked through all the code did some reverse engineering of the boot ROM and which is readable we had to do some open",
    "start": "2200240",
    "end": "2207410"
  },
  {
    "text": "OCD tricks but then we found essentially that the there was no checks found so as",
    "start": "2207410",
    "end": "2215030"
  },
  {
    "text": "all these checks are only for our DP 0 and so now let's take the methodology",
    "start": "2215030",
    "end": "2221450"
  },
  {
    "text": "that we were showing before of how to do a glitch and kind of apply it post facto",
    "start": "2221450",
    "end": "2226790"
  },
  {
    "text": "to what we did because when we originally did this it was a lot of floating around and it took three months",
    "start": "2226790",
    "end": "2232849"
  },
  {
    "text": "of just coordinated effort the glitcher didn't run for three months but it that's a much much time of us redoing it",
    "start": "2232849",
    "end": "2238549"
  },
  {
    "start": "2234000",
    "end": "2234000"
  },
  {
    "text": "but now post facto we can make it look easy apply the method and you win so",
    "start": "2238549",
    "end": "2244510"
  },
  {
    "text": "like this happens in the boot ROM so we're interested in in analyzing the blue boot ROM for the boot ROM glitch so",
    "start": "2244510",
    "end": "2251569"
  },
  {
    "start": "2246000",
    "end": "2246000"
  },
  {
    "text": "first thing that happens is the power on reset event after the power on said event the microcontroller is going",
    "start": "2251569",
    "end": "2258359"
  },
  {
    "text": "to go into the boot ROM and that it's going to run the code that's in the boot rom so that boot rom could be doing different things depending on different",
    "start": "2258359",
    "end": "2265199"
  },
  {
    "text": "pins but after the boot run is done and and specifically it's going to be reading RDP that's what we're interested",
    "start": "2265199",
    "end": "2271229"
  },
  {
    "text": "in but then it's gonna launch user code and so we know that the boot rom it's",
    "start": "2271229",
    "end": "2277259"
  },
  {
    "text": "going to read RDP from this internal flash so that's where we need to insert the glitch so this is super stool on",
    "start": "2277259",
    "end": "2286439"
  },
  {
    "start": "2285000",
    "end": "2285000"
  },
  {
    "text": "that investigative phase we're still trying to learn about the target so what we now recommend is that you know before",
    "start": "2286439",
    "end": "2291900"
  },
  {
    "text": "you move on to a new target you study the boot process with an oscilloscope and figure out some timing information",
    "start": "2291900",
    "end": "2298619"
  },
  {
    "text": "because that's going to help you figure out your delay and your where to apply the picture so we're looking at the",
    "start": "2298619",
    "end": "2303959"
  },
  {
    "text": "oscilloscope of the supply voltage on the top an i/o pin on the bottom and",
    "start": "2303959",
    "end": "2309359"
  },
  {
    "text": "here we're just trying to measure the time to user code which is about 1.8 milliseconds so that's how long it takes",
    "start": "2309359",
    "end": "2316619"
  },
  {
    "text": "to get boot it into user code and then we can tell that because you know",
    "start": "2316619",
    "end": "2321660"
  },
  {
    "text": "there's lots of interesting activity and yeah and so here then we also have the",
    "start": "2321660",
    "end": "2327209"
  },
  {
    "text": "supply voltage and a reset pin and now we're trying to show that yep so what",
    "start": "2327209",
    "end": "2333049"
  },
  {
    "text": "was so one of the most important things is the the problem we had with this chip is that they the pawn takes different",
    "start": "2333049",
    "end": "2339929"
  },
  {
    "text": "amounts of time every every time you boot it and so basically the the PLL's and so on me to synchronize and some",
    "start": "2339929",
    "end": "2346619"
  },
  {
    "text": "capacitors charge up or whatever but basically the first 1.4 milliseconds of",
    "start": "2346619",
    "end": "2352019"
  },
  {
    "text": "the boot nothing happens and we couldn't get a reliable trigger because it was always moving every time that the",
    "start": "2352019",
    "end": "2358079"
  },
  {
    "text": "execution speed was different but then we found out at one point four milliseconds roughly in the boot process the reception shoots high and we can use",
    "start": "2358079",
    "end": "2365640"
  },
  {
    "text": "that as the perfect trigger of when the boot rom starts executing so all right",
    "start": "2365640",
    "end": "2370910"
  },
  {
    "text": "Thank You Thomas and then and for the power consumption the technique is",
    "start": "2370910",
    "end": "2377369"
  },
  {
    "start": "2375000",
    "end": "2375000"
  },
  {
    "text": "basically using a shot measurement so we have a shunt resistor to measure the power and we're in the boot ROM we were",
    "start": "2377369",
    "end": "2384299"
  },
  {
    "text": "were interested in again you got the reset also looking at the power consumption with the shunt",
    "start": "2384299",
    "end": "2390120"
  },
  {
    "text": "resistor and we see when the bootrom starts execution we're also in what",
    "start": "2390120",
    "end": "2395970"
  },
  {
    "text": "we're trying to find is when these flash option bytes are going to be read and so",
    "start": "2395970",
    "end": "2402240"
  },
  {
    "text": "when we look at that power trace we see a lot more activity once the flash",
    "start": "2402240",
    "end": "2408090"
  },
  {
    "text": "starts get into a book and get getting involved and we can pair that up with our app application application in",
    "start": "2408090",
    "end": "2414150"
  },
  {
    "text": "execution and now we have a nice map of where everything happens so this is what",
    "start": "2414150",
    "end": "2419460"
  },
  {
    "text": "it this is how we started right through took the FPGA the analog switch now we've seen these a few times here we",
    "start": "2419460",
    "end": "2425700"
  },
  {
    "text": "have a debugger that's a new component because now we're interested in reading when we have access to the when our DP",
    "start": "2425700",
    "end": "2432870"
  },
  {
    "text": "one's downgraded and in this case our target is to tresor and this is inserting the glitch so we saw an",
    "start": "2432870",
    "end": "2440790"
  },
  {
    "text": "example of that before and this is this was the glitch on the stm32 and we we",
    "start": "2440790",
    "end": "2448560"
  },
  {
    "text": "did this over about three months of the active glitching different parts of the world all actively running this",
    "start": "2448560",
    "end": "2453630"
  },
  {
    "text": "collision setup so it was very much a very much team effort eventually we were able to insert the glitch into the boot",
    "start": "2453630",
    "end": "2459360"
  },
  {
    "text": "ROM and we were able to connect with a debugger and a dunk rated so we were now",
    "start": "2459360",
    "end": "2465480"
  },
  {
    "text": "even though we set our DP to and that was set in the flash we are now at RDP 1",
    "start": "2465480",
    "end": "2471530"
  },
  {
    "text": "so the key to doing this and the key to kind of making this cool to know the",
    "start": "2471530",
    "end": "2477090"
  },
  {
    "start": "2473000",
    "end": "2473000"
  },
  {
    "text": "parameters of the clutch and so so now after working with traceur we're happy",
    "start": "2477090",
    "end": "2483030"
  },
  {
    "text": "to release these parameters and so these numbers are essentially clock cycles at a hundred megahertz so the delay is that",
    "start": "2483030",
    "end": "2490580"
  },
  {
    "text": "17900 clock cycles with a pulse of 50 clock cycles and yeah we're gonna put",
    "start": "2490580",
    "end": "2496530"
  },
  {
    "text": "this up on github and this again it we were this particular device was the",
    "start": "2496530",
    "end": "2501780"
  },
  {
    "text": "treasurer but it's also applicable to anything that runs in stm32 f2 and we",
    "start": "2501780",
    "end": "2507900"
  },
  {
    "text": "think it was pretty reliable so we did a scatterplot of what our success looks like and these were all the successful",
    "start": "2507900",
    "end": "2515130"
  },
  {
    "text": "collisions at exactly that delay so this is about 120 attempts and all of them",
    "start": "2515130",
    "end": "2520880"
  },
  {
    "text": "hit pretty much at the same spot so this is a pretty reliable glitch for the stm32 f2 have a 2:05 and in this case",
    "start": "2520880",
    "end": "2530810"
  },
  {
    "text": "the application was this again a cryptocurrency wallet so what do you do with that glitch when you're in RDP one",
    "start": "2530810",
    "end": "2537680"
  },
  {
    "start": "2531000",
    "end": "2531000"
  },
  {
    "text": "well you can read SRAM is that interesting depends on the application it is interesting if you ever use SRAM",
    "start": "2537680",
    "end": "2544310"
  },
  {
    "text": "which seems to be popular on microcontrollers so if you put secrets in there you can read them out if those",
    "start": "2544310",
    "end": "2551480"
  },
  {
    "text": "secrets are a cryptocurrency seed that basically equals money then so that's as much as I'll get into cryptocurrency",
    "start": "2551480",
    "end": "2557680"
  },
  {
    "text": "Photowall at that fail if you're if you're interested in more of the exploit we originally made this butcher now it's",
    "start": "2557680",
    "end": "2564230"
  },
  {
    "start": "2561000",
    "end": "2561000"
  },
  {
    "text": "very specific for the stm32 so I have some of these unpopulated PCBs with me but this is very targeted with a socket",
    "start": "2564230",
    "end": "2571610"
  },
  {
    "text": "for the stm32 and basically for the motivation of that we wanted to kind of",
    "start": "2571610",
    "end": "2578000"
  },
  {
    "text": "generalize this and that's what we hope to show with that methodology and the how to adapt it to other part lines and",
    "start": "2578000",
    "end": "2585500"
  },
  {
    "text": "so you know we're talking about basically attacking here and glitching",
    "start": "2585500",
    "end": "2590600"
  },
  {
    "start": "2589000",
    "end": "2589000"
  },
  {
    "text": "and so you know what what can we do about it so one thing you could do is during the design component time is just",
    "start": "2590600",
    "end": "2597320"
  },
  {
    "text": "choose a component that has glitch monitors so you know if you're searching for a part and it doesn't mention",
    "start": "2597320",
    "end": "2603980"
  },
  {
    "text": "security or doesn't mention voltage protection you know and if that's important to your design you may",
    "start": "2603980",
    "end": "2610400"
  },
  {
    "text": "want to look for something else the brownout detector is not necessarily glitch defense so parent detector is",
    "start": "2610400",
    "end": "2616190"
  },
  {
    "text": "generally there for power monitoring not necessarily for coaching so that you",
    "start": "2616190",
    "end": "2621320"
  },
  {
    "text": "know most likely it's not going to see you other thing you consider is active tamper basically don't let someone",
    "start": "2621320",
    "end": "2626570"
  },
  {
    "text": "physically get access to your design out to the chip depending on the situation this may or",
    "start": "2626570",
    "end": "2632240"
  },
  {
    "text": "may not be applicable but if they can't get access to the chip it's going to be hard to insert the glitch right next to",
    "start": "2632240",
    "end": "2638450"
  },
  {
    "text": "the park if you're building the product you should test your design so hopefully",
    "start": "2638450",
    "end": "2644030"
  },
  {
    "text": "we now we all know that it can be done very cheaply cheap amount of components",
    "start": "2644030",
    "end": "2649340"
  },
  {
    "text": "you know we recommend that you test your design for glitching before you release it and lastly there are some tricks the",
    "start": "2649340",
    "end": "2655640"
  },
  {
    "text": "right glitch resistant software they but none of that helps if the software is",
    "start": "2655640",
    "end": "2661040"
  },
  {
    "text": "burned into the boot rom so not much you can do there and then we'll let Thomas",
    "start": "2661040",
    "end": "2666950"
  },
  {
    "start": "2666000",
    "end": "2666000"
  },
  {
    "text": "yeah so just as a conclusion chips with your pet wait for really glitch able",
    "start": "2666950",
    "end": "2672290"
  },
  {
    "text": "there are some more chips that we looked at such as the 80s MD 21 and so on and",
    "start": "2672290",
    "end": "2677590"
  },
  {
    "text": "they they all are very trivial to glitch basically and it can be done really on",
    "start": "2677590",
    "end": "2683660"
  },
  {
    "text": "the cheap and on the very very cheap as you've seen before and but also just because the chip is literal that's not",
    "start": "2683660",
    "end": "2689570"
  },
  {
    "text": "equal and exploit you still need to be able to get your glitter stable enough so just because your chip is susceptible",
    "start": "2689570",
    "end": "2696710"
  },
  {
    "text": "to VHS does not necessarily mean it's trivial to exploit it just means that there's a high risk of somebody maybe",
    "start": "2696710",
    "end": "2703520"
  },
  {
    "text": "being able to get a stable glitch and they you should really have a deep look at your design and see why your",
    "start": "2703520",
    "end": "2709940"
  },
  {
    "text": "protection strategies for that chip releases on chip not fail will release",
    "start": "2709940",
    "end": "2717200"
  },
  {
    "text": "the firmware or will the bitstream and very lock for the chip fail glitter glitter in this case oops I will release",
    "start": "2717200",
    "end": "2723650"
  },
  {
    "text": "all the PCBs we talked about so for the max for the RT glitter for the trsor and all the target tests for where we",
    "start": "2723650",
    "end": "2731360"
  },
  {
    "text": "also will release some tools for Diedre to make Goodrem reverse engineering much easier yeah so thank you we hope to get",
    "start": "2731360",
    "end": "2739820"
  },
  {
    "text": "our website life either today or later this week you can reach us on crypto",
    "start": "2739820",
    "end": "2744860"
  },
  {
    "text": "Tronics dot-com and levity thank you very much and yeah thank you",
    "start": "2744860",
    "end": "2752370"
  },
  {
    "text": "[Applause]",
    "start": "2752370",
    "end": "2755800"
  }
]