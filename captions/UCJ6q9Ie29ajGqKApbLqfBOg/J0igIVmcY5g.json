[
  {
    "text": "awesome thank you very much for introduction and thanks to everyone here that's decided to get up early and make",
    "start": "0",
    "end": "6299"
  },
  {
    "text": "it to our talk this is pretty exciting we're both really excited to be here and to be sharing some of our research and",
    "start": "6299",
    "end": "12150"
  },
  {
    "text": "during this talk we'll give you a rare insight into a state-sponsored surveillance we're campaign its",
    "start": "12150",
    "end": "19410"
  },
  {
    "text": "operations and all the context around it so who are we",
    "start": "19410",
    "end": "25230"
  },
  {
    "text": "my name is Michael Foxman I head up lookouts read intelligence team joined",
    "start": "25230",
    "end": "30420"
  },
  {
    "text": "by Andrew Blake who heads up device intelligence and you might remember it's from research into interesting families",
    "start": "30420",
    "end": "37800"
  },
  {
    "text": "I like NSA's surveillance we're tools for Pegasus for iOS called Pegasus and",
    "start": "37800",
    "end": "43620"
  },
  {
    "text": "for Android called kreisau and we've also done research into a number of",
    "start": "43620",
    "end": "49460"
  },
  {
    "text": "different malware families out there so late last year we released a report with the Electronic Frontier Foundation",
    "start": "49460",
    "end": "56690"
  },
  {
    "text": "around an actor called dark era coal that we ultimately tracked back to a",
    "start": "56690",
    "end": "61800"
  },
  {
    "text": "building in downtown Beirut that ended up being Lebanese intelligence the",
    "start": "61800",
    "end": "67530"
  },
  {
    "text": "General Directorate of general security of the gdgs and that part of the world is pretty interesting we're seeing a lot",
    "start": "67530",
    "end": "74220"
  },
  {
    "text": "of threats coming out of there and as a result we've done a lot of research into other families that have been active and",
    "start": "74220",
    "end": "81090"
  },
  {
    "text": "that are being deployed in the Middle East so things like Viper app frozen cell does the Scorpion and I suppose you",
    "start": "81090",
    "end": "89790"
  },
  {
    "text": "know it's definitely not just the Middle East where we're seeing a lot of activity probably no surprise for many",
    "start": "89790",
    "end": "95790"
  },
  {
    "text": "of you here to know that there's a lot of stuff also coming out of Asia so we've also reported on in the past about",
    "start": "95790",
    "end": "101729"
  },
  {
    "text": "families like x-ray and Titan that have connections to nation state governments",
    "start": "101729",
    "end": "107070"
  },
  {
    "text": "I won't name names but check out the reports yeah so what we're really",
    "start": "107070",
    "end": "112890"
  },
  {
    "text": "interesting around all these families is definitely the capabilities of what they're able to do when they're on",
    "start": "112890",
    "end": "118290"
  },
  {
    "text": "devices but kind of more broadly than that the wider context of who's actually",
    "start": "118290",
    "end": "124860"
  },
  {
    "text": "behind them why are they deploying these tools so which regions of the world are they using them in who are they going",
    "start": "124860",
    "end": "131879"
  },
  {
    "text": "after and in some cases like the one that will see you today it's really exciting to come",
    "start": "131879",
    "end": "138480"
  },
  {
    "text": "across operational security mistakes from the people running these campaigns where they've kind of tripped up when it",
    "start": "138480",
    "end": "145470"
  },
  {
    "text": "comes to securing their infrastructure and as a result inadvertently exposed a lot of the content that they've stolen",
    "start": "145470",
    "end": "151170"
  },
  {
    "text": "from targets and that you know really helps give us a better insight into not only who they are but who they're",
    "start": "151170",
    "end": "157230"
  },
  {
    "text": "targeting as well so for this particular",
    "start": "157230",
    "end": "162870"
  },
  {
    "text": "talk we'll start off by going back a few years and kind of getting everyone up to",
    "start": "162870",
    "end": "168570"
  },
  {
    "text": "speed on this particular actor it's basically not their first rodeo so they've been in this game for a long",
    "start": "168570",
    "end": "174240"
  },
  {
    "text": "time they've been deploying surveillance where for a number of years so we'll",
    "start": "174240",
    "end": "180720"
  },
  {
    "text": "cover a bit of that before diving into the Android tool cornstalk mango and",
    "start": "180720",
    "end": "186480"
  },
  {
    "text": "then we'll take a look at the infrastructure the mistakes they made and how that resulted in not only a lot of exfiltrated content being publicly",
    "start": "186480",
    "end": "193470"
  },
  {
    "text": "accessible but also in their actual identity is being tied to this",
    "start": "193470",
    "end": "199080"
  },
  {
    "text": "particular campaign and one of the other things that we found was that not only",
    "start": "199080",
    "end": "204810"
  },
  {
    "text": "were there deploying an Android tool they also have an iOS capability as well called tangelo now so we'll go into that",
    "start": "204810",
    "end": "210870"
  },
  {
    "text": "before looking at some of the attack vectors that that they used to compromise their targets so back in 2016",
    "start": "210870",
    "end": "222959"
  },
  {
    "text": "proof point and Trend Micro both released reports on campaigns that the",
    "start": "222959",
    "end": "228000"
  },
  {
    "text": "Aged referred to as operation C major and transparent tribe and what these were essentially about were they",
    "start": "228000",
    "end": "235320"
  },
  {
    "text": "highlighted a long-running pakistani-based actor that was conducting attacks against members of",
    "start": "235320",
    "end": "242700"
  },
  {
    "text": "the indian government and some of the things that came out of that was that they were highly successful they'd been",
    "start": "242700",
    "end": "249090"
  },
  {
    "text": "running this operation for a number of years using tools that were designed to compromise both mobile endpoints as well",
    "start": "249090",
    "end": "255870"
  },
  {
    "text": "as desktops and they're really successful despite being pretty low slow sophistication in terms of techniques",
    "start": "255870",
    "end": "262079"
  },
  {
    "text": "and capabilities so they relied primarily on social",
    "start": "262080",
    "end": "267180"
  },
  {
    "text": "Engineering and this is pretty typical this techniques been recycled for it's been in in the worlds for at least 20",
    "start": "267180",
    "end": "274110"
  },
  {
    "text": "years but it's still highly effective so what this actor was doing was sending you know the standard spearfishing",
    "start": "274110",
    "end": "280680"
  },
  {
    "text": "playbook type emails to members of the Indian governments in embassies in",
    "start": "280680",
    "end": "285960"
  },
  {
    "text": "places like Astana and Kazakhstan as well as Riyadh in Saudi Arabia and",
    "start": "285960",
    "end": "291020"
  },
  {
    "text": "essentially enticing people to open an attachment that would result in malware",
    "start": "291020",
    "end": "296100"
  },
  {
    "text": "running on their system so nothing too novel there at all in conjunction with that they also had a",
    "start": "296100",
    "end": "302250"
  },
  {
    "text": "watering hole hosting a lot of Indian military themed content things like pay",
    "start": "302250",
    "end": "308009"
  },
  {
    "text": "cuts accommodation issues people on trial and like with the email contents",
    "start": "308009",
    "end": "314070"
  },
  {
    "text": "each of these pages came with a malicious document and if you clicked on it you'd have a bad time a few of the",
    "start": "314070",
    "end": "323849"
  },
  {
    "text": "main takeaways that stood out to me and probably a lot of other people in the research community and when reading this was that they were really successful",
    "start": "323849",
    "end": "330389"
  },
  {
    "text": "they got 16 gigabytes of data from a fairly small target group was only 160",
    "start": "330389",
    "end": "336530"
  },
  {
    "text": "victims that were identified I think my favorite quote here that highlights just",
    "start": "336530",
    "end": "342210"
  },
  {
    "text": "how unsophisticated they were was this targeted attack campaign is amateur at",
    "start": "342210",
    "end": "347220"
  },
  {
    "text": "best sloppy at worst ouch shots fired from the researchers at that company I",
    "start": "347220",
    "end": "352380"
  },
  {
    "text": "think I guess it's no surprise that threat actors sometimes don't read our reports when we put things like that",
    "start": "352380",
    "end": "360320"
  },
  {
    "text": "highlighting their their sophistication so how sloppy is sloppy well turns out",
    "start": "360320",
    "end": "366960"
  },
  {
    "text": "it pretty bad so not only do these guys have a lot of their exfiltrated content",
    "start": "366960",
    "end": "372389"
  },
  {
    "text": "poorly secured on their infrastructure so anyone could just if they knew the right URL path they can access at all",
    "start": "372389",
    "end": "379159"
  },
  {
    "text": "but like a lot of companies out there they were also dogfooding their product",
    "start": "379159",
    "end": "384780"
  },
  {
    "text": "which is a little embarrassing when you combine that with having all that content exposed so they were testing out",
    "start": "384780",
    "end": "390900"
  },
  {
    "text": "their own products on their mobile phones and their desktops and as a result as we can see here on the right",
    "start": "390900",
    "end": "396150"
  },
  {
    "text": "some of the exfiltrated content include their personal information and then could be directly connected to that",
    "start": "396150",
    "end": "403229"
  },
  {
    "text": "campaign so kind of awkward for them no doubt and as we can see here there's",
    "start": "403229",
    "end": "409259"
  },
  {
    "text": "a screenshot of a conversation with one of the developers called CG dick Bowl it",
    "start": "409259",
    "end": "414660"
  },
  {
    "text": "has this number his name and using that information we can identify his email",
    "start": "414660",
    "end": "420060"
  },
  {
    "text": "address various domains that he's also registered using those that information",
    "start": "420060",
    "end": "425930"
  },
  {
    "text": "and then also out of this exfiltrated content there was a direct link to an individual profile Hanif so moving",
    "start": "425930",
    "end": "436650"
  },
  {
    "text": "forward if we look at what publicly available information can be accessed",
    "start": "436650",
    "end": "442110"
  },
  {
    "text": "about these individuals there's a fair amount of content out there they haven't really covered their tracks we can see",
    "start": "442110",
    "end": "449370"
  },
  {
    "text": "that faisal is definitely more active on the infrastructure side of things he's",
    "start": "449370",
    "end": "454409"
  },
  {
    "text": "got a background in VoIP technology and is definitely more responsible for running all domain registration and that",
    "start": "454409",
    "end": "461819"
  },
  {
    "text": "kind of thing and on the right suji's profile pretty much pins him as the app",
    "start": "461819",
    "end": "467430"
  },
  {
    "text": "developer and and that's kind of his role so that you can see that they both",
    "start": "467430",
    "end": "473159"
  },
  {
    "text": "worked at a place called VOC p.m. at some point in the past what's really surprising to me is that as we saw that",
    "start": "473159",
    "end": "480360"
  },
  {
    "text": "their personal information was highlighted in an apt report they didn't",
    "start": "480360",
    "end": "485789"
  },
  {
    "text": "really care they just kept pretty much going about business as usual and as a result we can tie them to the use of",
    "start": "485789",
    "end": "492960"
  },
  {
    "text": "commercial surveillance where tools like Andra wrap a bespoke surveillance tool called smash-up and then on the shady",
    "start": "492960",
    "end": "499500"
  },
  {
    "text": "side of things they've also been connected to a number of spouse by companies like rings to track cozies",
    "start": "499500",
    "end": "504960"
  },
  {
    "text": "stealthGenie the one spy if you're unfamiliar with what that's where as",
    "start": "504960",
    "end": "510060"
  },
  {
    "text": "it's promoted as a tool that you has someone in a loving and caring",
    "start": "510060",
    "end": "515550"
  },
  {
    "text": "relationship would go about and install on the device of your partner so that's",
    "start": "515550",
    "end": "521490"
  },
  {
    "text": "that's what love is and like since then they've kind of",
    "start": "521490",
    "end": "528060"
  },
  {
    "text": "continued to carry on with with this kind of development so they're their most recent startup is called super",
    "start": "528060",
    "end": "534240"
  },
  {
    "text": "innovative and it's got some potentially legitimate work there like VoIP",
    "start": "534240",
    "end": "539340"
  },
  {
    "text": "communication secure communication but they're also doing that their standard",
    "start": "539340",
    "end": "545580"
  },
  {
    "text": "sort of spouse wear tool is being offered through this company and they have some really weird stock photos that",
    "start": "545580",
    "end": "551700"
  },
  {
    "text": "don't quite make sense so outside of",
    "start": "551700",
    "end": "557610"
  },
  {
    "text": "that and really quite recently what our research focuses on is the Android their",
    "start": "557610",
    "end": "563970"
  },
  {
    "text": "latest Android sales we're tool called stealth mango and later on in this talk we'll get to their iOS tool core tangelo",
    "start": "563970",
    "end": "571100"
  },
  {
    "text": "the first off just looking at stealth mango I think a lot of the capabilities here are really representative of what",
    "start": "571100",
    "end": "578430"
  },
  {
    "text": "you would expect to find in pretty much any sort of tool designed to gather",
    "start": "578430",
    "end": "583500"
  },
  {
    "text": "information from targets of interests so we're seeing functionality like being able to record audio either when a",
    "start": "583500",
    "end": "590580"
  },
  {
    "text": "threat actor triggers and instructs a compromised device to do so so they can",
    "start": "590580",
    "end": "595770"
  },
  {
    "text": "do that at any time for example if the targets in a meeting or surrounded or talking to people of interest it's also",
    "start": "595770",
    "end": "603060"
  },
  {
    "text": "capable of recording audio whenever a target device makes a call or receives a call and then in addition to that",
    "start": "603060",
    "end": "610190"
  },
  {
    "text": "there's functionality that looks for whether whatsapp is running in the foreground if it recognizes that it is",
    "start": "610190",
    "end": "616620"
  },
  {
    "text": "it will try and actually do screen grabs and collect that information as well and",
    "start": "616620",
    "end": "622620"
  },
  {
    "text": "a lot of the other functionality we can see here is is pretty stock standard",
    "start": "622620",
    "end": "628400"
  },
  {
    "text": "spouse wear functionality and surveillance where functionality so the ability to track the device location and",
    "start": "628400",
    "end": "634500"
  },
  {
    "text": "the rate at which this information is gathered can be tuned and specified by",
    "start": "634500",
    "end": "640710"
  },
  {
    "text": "an attacker so they can make it quite frequent and they can track a targets every letter every location and then",
    "start": "640710",
    "end": "648870"
  },
  {
    "text": "we're also seeing the capability to actually export rates anything on external storage so things like pictures",
    "start": "648870",
    "end": "654660"
  },
  {
    "text": "images video content user might have downloaded to external",
    "start": "654660",
    "end": "660780"
  },
  {
    "text": "storage and in addition to this we're also seeing the capability to exfiltrate",
    "start": "660780",
    "end": "667080"
  },
  {
    "text": "device metadata beings like you know it is a target on Wi-Fi or are they using",
    "start": "667080",
    "end": "673200"
  },
  {
    "text": "cellular data what's the battery level and these things might seem kind of trivial but I",
    "start": "673200",
    "end": "680010"
  },
  {
    "text": "think it's it's worth keeping in mind that a lot of this a lot of this",
    "start": "680010",
    "end": "685800"
  },
  {
    "text": "functionality for example like knowing how much battery percentage a device actually has can really help out an",
    "start": "685800",
    "end": "692670"
  },
  {
    "text": "adversary when it comes to them determining whether they should for example kick off a battery intensive",
    "start": "692670",
    "end": "699710"
  },
  {
    "text": "process like potentially recording audio so I guess a good example is if a target",
    "start": "699710",
    "end": "705420"
  },
  {
    "text": "has say 10% battery life it's unlikely you'd see them deciding to do some sort",
    "start": "705420",
    "end": "711600"
  },
  {
    "text": "of battery intensive process that might tip a target off into knowing that their device was compromised we also have the",
    "start": "711600",
    "end": "722160"
  },
  {
    "text": "capability to record screenshots record also log keystrokes and collect a lot of personal",
    "start": "722160",
    "end": "729360"
  },
  {
    "text": "information such as contact data and associated information so email addresses names the amount of times that",
    "start": "729360",
    "end": "737720"
  },
  {
    "text": "calls have been made to these people so pretty much the main takeaway is that if",
    "start": "737720",
    "end": "743640"
  },
  {
    "text": "it's on your device it's pretty much got access to your key information that an attacker would find useful in terms of",
    "start": "743640",
    "end": "752820"
  },
  {
    "text": "hiding itself it's as you can tell pretty low sophistication all it does is hide its icon so nothing too fancy there",
    "start": "752820",
    "end": "761210"
  },
  {
    "text": "and we haven't mentioned anything about exports that's because hey these guys don't really need it the bar has been",
    "start": "761660",
    "end": "769440"
  },
  {
    "text": "raised high enough for them to actually need to resort to that kind of",
    "start": "769440",
    "end": "774870"
  },
  {
    "text": "capability and make those kinds of investments they've been getting a lot of mileage out of fishing as have a lot",
    "start": "774870",
    "end": "780420"
  },
  {
    "text": "of other actors that we see simply asking users to enable and allow an app",
    "start": "780420",
    "end": "787500"
  },
  {
    "text": "to have certain permissions is often more than enough and we see this there all the time surprising how",
    "start": "787500",
    "end": "794320"
  },
  {
    "text": "effective it is I think one of the ways",
    "start": "794320",
    "end": "802750"
  },
  {
    "text": "that the developers behind this actually tried to hide that tool is more definitely low sophistication but it's",
    "start": "802750",
    "end": "809050"
  },
  {
    "text": "focusing on hiding it through attempting to appear like legitimate applications",
    "start": "809050",
    "end": "815410"
  },
  {
    "text": "so if a user goes to have a look at what what applications are installed on their device with packages like you know comma",
    "start": "815410",
    "end": "825220"
  },
  {
    "text": "dot update dot system and a app title that system it's I think it's fair to say that a lot of users when you're",
    "start": "825220",
    "end": "831970"
  },
  {
    "text": "scrolling through a wave of applications that are installed on your Android device you'd probably be a little",
    "start": "831970",
    "end": "837460"
  },
  {
    "text": "hesitant to ton install something like that and that's kind of like a reoccurring theme we've seen around all",
    "start": "837460",
    "end": "845320"
  },
  {
    "text": "the applications that this act has raised so we've seen 42 known samples as",
    "start": "845320",
    "end": "850510"
  },
  {
    "text": "of May we haven't seen they're there tooling surface since we released our",
    "start": "850510",
    "end": "856480"
  },
  {
    "text": "report but given previous behavior from these guys I think it's quite likely",
    "start": "856480",
    "end": "861850"
  },
  {
    "text": "we'll see them pretty soon so just looking at how communication works and",
    "start": "861850",
    "end": "868780"
  },
  {
    "text": "how that takes place as you can guess takes place over HTTP because why not",
    "start": "868780",
    "end": "875130"
  },
  {
    "text": "maybe that'll change we'll see but basically when a device is initially",
    "start": "875130",
    "end": "881020"
  },
  {
    "text": "compromised it first off sends the device ie so the device identifier along",
    "start": "881020",
    "end": "887050"
  },
  {
    "text": "with the tag to command and control infrastructure and and these tags are basically associated the hard-coded tags",
    "start": "887050",
    "end": "894130"
  },
  {
    "text": "are all strings and their associated we believe two specific campaigns so it",
    "start": "894130",
    "end": "899950"
  },
  {
    "text": "looks like this actor has been running in the past multiple campaigns each with a specific identifier so when the server",
    "start": "899950",
    "end": "908950"
  },
  {
    "text": "gets this information at you know responds with the status message in this case it's 280k user already exists and",
    "start": "908950",
    "end": "916510"
  },
  {
    "text": "then it but the remainder of the content is around what modules should be enabled",
    "start": "916510",
    "end": "922150"
  },
  {
    "text": "so we can see that things like SMS is set to 1 so basically saying can",
    "start": "922150",
    "end": "928900"
  },
  {
    "text": "you enable that module and go about an export rate or let users text messages we can see pictures is set to 1 so it's",
    "start": "928900",
    "end": "936670"
  },
  {
    "text": "gathering all that content as well and then in addition to this there's the instruction to record audio for a really",
    "start": "936670",
    "end": "944170"
  },
  {
    "text": "long time between 10 a.m. and 2 p.m. which is interesting to see and then",
    "start": "944170",
    "end": "950560"
  },
  {
    "text": "once this gets kicked back to a client the infected device actually goes about and handles that so it responds responds",
    "start": "950560",
    "end": "956920"
  },
  {
    "text": "with its irony first off text messages any lat/long information that it can provide with that followed by call",
    "start": "956920",
    "end": "964750"
  },
  {
    "text": "history a list of packages that have been installed that's not all the",
    "start": "964750",
    "end": "972010"
  },
  {
    "text": "packages obviously had to reduce this down to actually fit on one slide but then we're also seeing all that device",
    "start": "972010",
    "end": "979420"
  },
  {
    "text": "metadata that I mentioned so things like how much storage is there the name of the device etc so during this",
    "start": "979420",
    "end": "993700"
  },
  {
    "text": "investigation it was kind of interesting because we're actually able to get limited access to c2 infrastructure and",
    "start": "993700",
    "end": "1000060"
  },
  {
    "text": "we could have a look at the scripts that they had created to actually handle a lot of this content as you can see",
    "start": "1000060",
    "end": "1006150"
  },
  {
    "text": "there's a whole bunch of comments and this this script was designed to handle",
    "start": "1006150",
    "end": "1012080"
  },
  {
    "text": "requests or post requests being made from infected devices it's several",
    "start": "1012080",
    "end": "1017460"
  },
  {
    "text": "hundred lines long originally 80% of those are comments so it's a bit of a",
    "start": "1017460",
    "end": "1024089"
  },
  {
    "text": "mess but when we clean it up it's it's",
    "start": "1024090",
    "end": "1030089"
  },
  {
    "text": "fairly straightforward so we can see that these guys have set up a number of different arrays to handle various",
    "start": "1030090",
    "end": "1035339"
  },
  {
    "text": "pieces of user input there then go about populating all that information into those arrays and then it's really quite",
    "start": "1035340",
    "end": "1042660"
  },
  {
    "text": "simple and just iterating through that all creating objects that represent each of those pieces of information and",
    "start": "1042660",
    "end": "1047939"
  },
  {
    "text": "saving them to a local database so message data text messages call records",
    "start": "1047940",
    "end": "1055760"
  },
  {
    "text": "all that information is being is being inserted into a local database it's nothing too complicated on the",
    "start": "1055760",
    "end": "1062429"
  },
  {
    "text": "backend thankfully a lot of the",
    "start": "1062429",
    "end": "1068730"
  },
  {
    "text": "applications we analyze kind of have a mix of obfuscation so some malware",
    "start": "1068730",
    "end": "1074789"
  },
  {
    "text": "developers I know that their tools are eventually going to fall into their hands of people like us that will try",
    "start": "1074789",
    "end": "1080730"
  },
  {
    "text": "and pull them apart and understand them and it's a slow us down what we see from a lot of them is that they'll use",
    "start": "1080730",
    "end": "1086460"
  },
  {
    "text": "different techniques to make our jobs increasingly more time-consuming in the",
    "start": "1086460",
    "end": "1093419"
  },
  {
    "text": "case of these guys they didn't do any of that so it was really quite easy to to pull apart so yeah thanks for saving us",
    "start": "1093419",
    "end": "1100590"
  },
  {
    "text": "time but what we can see here is a screenshot of their capability around",
    "start": "1100590",
    "end": "1108389"
  },
  {
    "text": "handling text messages out-of-band and what that means is that they stealth",
    "start": "1108389",
    "end": "1113789"
  },
  {
    "text": "mango will process all inbound text messages looking for certain key words and if it finds any of those key words",
    "start": "1113789",
    "end": "1120269"
  },
  {
    "text": "it will then kick off specific functionality so in this case we've got",
    "start": "1120269",
    "end": "1125509"
  },
  {
    "text": "two piece of two key words start Mike bug you can see an M @ IC 8k what's",
    "start": "1125509",
    "end": "1133259"
  },
  {
    "text": "curious about this is that you know start Mike bug is a fairly common heuristic or string sequence but the",
    "start": "1133259",
    "end": "1141389"
  },
  {
    "text": "other sequence that's highlighted there out of 50 million applications that we have it appears only in stealth mango",
    "start": "1141389",
    "end": "1147840"
  },
  {
    "text": "and the ones bite which is a commercial space portal so we thought that was more",
    "start": "1147840",
    "end": "1154230"
  },
  {
    "text": "than just a coincidence and actually if we go back in time far enough what we",
    "start": "1154230",
    "end": "1159720"
  },
  {
    "text": "can see is that it looks like at some point the developers behind stealth mango forked the one spy and started",
    "start": "1159720",
    "end": "1167070"
  },
  {
    "text": "their own development so that's led to a lot of code reuse we can see that recorded information",
    "start": "1167070",
    "end": "1174779"
  },
  {
    "text": "recorded audio is stored on external storage in the same place in both the stealth mango and the one spy but then",
    "start": "1174779",
    "end": "1181379"
  },
  {
    "text": "there's also a lot of dead code that the developers behind the one spy we're",
    "start": "1181379",
    "end": "1186779"
  },
  {
    "text": "thinking of implementing around about the time that stealth mango forked",
    "start": "1186779",
    "end": "1192030"
  },
  {
    "text": "and that's kind of just sat around in stealth mango samples in the one spy they've gone on to actually implement it",
    "start": "1192030",
    "end": "1198140"
  },
  {
    "text": "but you can see it doesn't really make sense so in terms of functionality so",
    "start": "1198140",
    "end": "1203700"
  },
  {
    "text": "there's what I mean by that is that in the stealth mango sample and in the one spy we can see that there's",
    "start": "1203700",
    "end": "1208770"
  },
  {
    "text": "functionality to disable texting if a device is determined to be on the road",
    "start": "1208770",
    "end": "1214800"
  },
  {
    "text": "so if he uses driving it doesn't really make sense for surveillance where for the one spy espouse we're potentially",
    "start": "1214800",
    "end": "1222680"
  },
  {
    "text": "but these aren't the only isolated cases there's there's code reuse like",
    "start": "1222680",
    "end": "1228270"
  },
  {
    "text": "throughout stealth mango and they're",
    "start": "1228270",
    "end": "1233280"
  },
  {
    "text": "also a lot of references on the iOS side to the one spy which we'll get into a little bit later and if we actually take",
    "start": "1233280",
    "end": "1240960"
  },
  {
    "text": "a look for a second at who's behind the ones by its company called oxygen that based in Sydney Australia but",
    "start": "1240960",
    "end": "1248100"
  },
  {
    "text": "interestingly they've got developers in Lahore Pakistan which will make a bit more sense later on in this talk so why",
    "start": "1248100",
    "end": "1256650"
  },
  {
    "text": "are they operating from what is their structure look like I'll hand off to Andrew to cover that part thanks yeah so",
    "start": "1256650",
    "end": "1264450"
  },
  {
    "text": "we talked a bit about the malware now this is the interesting part about where it was talking to where the servers were located and kind of how we sort of",
    "start": "1264450",
    "end": "1270570"
  },
  {
    "text": "linked everything together to kind of figure out as much as we could the infrastructure and who was behind this",
    "start": "1270570",
    "end": "1275700"
  },
  {
    "text": "sort of stuff so primarily um kind of a world map the main server that existed",
    "start": "1275700",
    "end": "1281220"
  },
  {
    "text": "was actually hosted in France they should be down at this point if they pop up again that'll be pretty interesting but right now they've been taken down at",
    "start": "1281220",
    "end": "1287070"
  },
  {
    "text": "the time of the investigation closed in May but what was interesting was they had the main server but what they did",
    "start": "1287070",
    "end": "1293130"
  },
  {
    "text": "was in different samples they assign different jump boxes that these samples would talk to and then those jump boxes",
    "start": "1293130",
    "end": "1298980"
  },
  {
    "text": "but essentially didn't talk to the main servers as well that was hosted in France at one point so there was one",
    "start": "1298980",
    "end": "1304530"
  },
  {
    "text": "main one that was used the 158 one that was based in Canada was the primary one that was used most the time which is",
    "start": "1304530",
    "end": "1311160"
  },
  {
    "text": "unfortunate not on the map right now but that's just an error but most samples",
    "start": "1311160",
    "end": "1316950"
  },
  {
    "text": "use that one with a few other ones that they were testing around with different functionality to go to different jump boxes in order to track and see how",
    "start": "1316950",
    "end": "1323310"
  },
  {
    "text": "those things are operating so we looked a little kind of cleaned up multigo graph here a little bit nicer li",
    "start": "1323310",
    "end": "1328809"
  },
  {
    "text": "designed there's a lot of different domain names that we correlate it",
    "start": "1328809",
    "end": "1333879"
  },
  {
    "text": "together with some Whois information so and a little bit will explain what the fi9 tech at gmail.com email address",
    "start": "1333879",
    "end": "1339669"
  },
  {
    "text": "means but basically that's a for hire development group that is based in Pakistan that does have linkages to all",
    "start": "1339669",
    "end": "1346629"
  },
  {
    "text": "the other people we talked about earlier and some additional people as well later so at one point in there and either",
    "start": "1346629",
    "end": "1353169"
  },
  {
    "text": "currently during the investigation or in the past the Whois information we saw that they had used this email address as",
    "start": "1353169",
    "end": "1358899"
  },
  {
    "text": "well as a linkable phone number as well that kind of correlated through all this all these domains what was curious that",
    "start": "1358899",
    "end": "1364629"
  },
  {
    "text": "we didn't notice was that there was a series of things that we talked about where they were actively pursuing the",
    "start": "1364629",
    "end": "1370629"
  },
  {
    "text": "development of iPhone spying tools as well which when we look at the ones buying things there is capabilities among that and we'll talk a bit about",
    "start": "1370629",
    "end": "1376809"
  },
  {
    "text": "what the capabilities are on the iOS side shortly but additionally they had a lot of other different domains as well they had developed for not only this",
    "start": "1376809",
    "end": "1385450"
  },
  {
    "text": "surveillance type of work that they were doing but also they are developers they do develop apps for other companies",
    "start": "1385450",
    "end": "1391690"
  },
  {
    "text": "because they are contractors that are legitimate that are not surveillance apps so they kind of but they do intermix a lot of their infrastructure",
    "start": "1391690",
    "end": "1397209"
  },
  {
    "text": "and development and code all across the place and additionally though this was the linkages that we had between another",
    "start": "1397209",
    "end": "1403329"
  },
  {
    "text": "email address that will show in a second which links to all the other people but these are all the different server IPS",
    "start": "1403329",
    "end": "1408339"
  },
  {
    "text": "that came across as well that were not behind domains they were just on the IPS themself that LinkedIn and then they all",
    "start": "1408339",
    "end": "1413619"
  },
  {
    "text": "essentially funneled into that one main server which was the main c2 that we conducted our investigation on now what",
    "start": "1413619",
    "end": "1419979"
  },
  {
    "text": "was really interesting about the c2 at Michael mentioned was is that we did have some good insight into some of the excel that was coming and early on in",
    "start": "1419979",
    "end": "1426129"
  },
  {
    "text": "the investigation they made the mistake of having directory and nixing enabled",
    "start": "1426129",
    "end": "1432519"
  },
  {
    "text": "right so we could we could we could figure out where the actual directory was and we could see what things were being collected and gets it insight into that partially through the investigation",
    "start": "1432519",
    "end": "1439089"
  },
  {
    "text": "actually they ended up shutting that down and noticing that that should be that that was open and they cut it off",
    "start": "1439089",
    "end": "1444149"
  },
  {
    "text": "however as we continue to probe the c2 infrastructure we noticed that the Box",
    "start": "1444149",
    "end": "1450299"
  },
  {
    "text": "through one way or another had a wso web shell on it if you're not familiar you might be familiar with you're not",
    "start": "1450299",
    "end": "1456129"
  },
  {
    "text": "familiar web shell basically gives you full administrative control over your server through a web panel",
    "start": "1456129",
    "end": "1461880"
  },
  {
    "text": "however commonly it does require a login to get in right and that would be a violation to see if a we tried to guess",
    "start": "1461880",
    "end": "1467710"
  },
  {
    "text": "that but however if you you can guess a URL it actually would bypass the login",
    "start": "1467710",
    "end": "1472870"
  },
  {
    "text": "and get you directly into the student to the actual web shell access and we saw over time as they were you know at one",
    "start": "1472870",
    "end": "1479140"
  },
  {
    "text": "point it was fully open and they kind of restricted it certain points and what files would be available but it did give us good insight into the exfiltration",
    "start": "1479140",
    "end": "1484510"
  },
  {
    "text": "data that was there where things were being collected from and then eventually we'll show you kind of where the logins",
    "start": "1484510",
    "end": "1490000"
  },
  {
    "text": "that were coming from for the administrative consoles that were there as well what was happening though as well as there was kind of a mixture of",
    "start": "1490000",
    "end": "1495940"
  },
  {
    "text": "data that was going to buckets and folders as well as there was some data that was going to Mike sequel databases as well as we saw kind of with the PHP",
    "start": "1495940",
    "end": "1503049"
  },
  {
    "text": "scripts that was collecting a lot more of the textual information and not the media data now we weren't sure whether",
    "start": "1503049",
    "end": "1508600"
  },
  {
    "text": "this was placed by an attacker that was just scanning the Internet and notice the vulnerability and they deployed the",
    "start": "1508600",
    "end": "1513820"
  },
  {
    "text": "web shell or whether the developers had this habit of trying to use this to",
    "start": "1513820",
    "end": "1518830"
  },
  {
    "text": "administer the system's because they thought there was a login page and there wasn't a way to get past it recently we",
    "start": "1518830",
    "end": "1524980"
  },
  {
    "text": "were probing against some of the infrastructure and we discovered another server by them that had another web shell access box on it so it might be",
    "start": "1524980",
    "end": "1532870"
  },
  {
    "text": "common that they are using this as their administrative tool what was interesting about this second server though is that there wasn't really any surveillance for",
    "start": "1532870",
    "end": "1538929"
  },
  {
    "text": "on it but it was kind of their development box where they were doing all their other app development all their all their testing all their",
    "start": "1538929",
    "end": "1544659"
  },
  {
    "text": "back-end server infrastructure stuff of deploying a number of different apps that are that are related to a number of",
    "start": "1544659",
    "end": "1550179"
  },
  {
    "text": "different names that they use things like App Store Tech mobile care and stealth agent as well that they've been",
    "start": "1550179",
    "end": "1556059"
  },
  {
    "text": "using so this this seemed to be a theme that we were encountering with them as well which provided great insight into what was happening there so we talked",
    "start": "1556059",
    "end": "1564309"
  },
  {
    "text": "about that what were they actually able to get what did the excellent rated data look like so we'd have a look we have some stats and some examples of that",
    "start": "1564309",
    "end": "1569950"
  },
  {
    "text": "kind of data but highlights you know letters and internal government communications so people like to take a",
    "start": "1569950",
    "end": "1576850"
  },
  {
    "text": "lot of pictures of of physical letters if they get and they just store them in their phones and a lot of that stuff was sucked up by people that were being",
    "start": "1576850",
    "end": "1582870"
  },
  {
    "text": "spied on some of those documents were things about travel information on diplomats that were coming in now at the",
    "start": "1582870",
    "end": "1588580"
  },
  {
    "text": "country there was a fair amount of picture IDs and passports that we'll get to in a moment that was curious about those and then a",
    "start": "1588580",
    "end": "1595210"
  },
  {
    "text": "lot of the metadata that we can get out of the pictures right so these pictures that were saved we're not scrubbed than any of the metadata so we actually could",
    "start": "1595210",
    "end": "1600879"
  },
  {
    "text": "go through the exif data and find out where the pictures were taken in order to give us a bit of insight about where the targets were located potentially and",
    "start": "1600879",
    "end": "1608379"
  },
  {
    "text": "there's a lot of medical documents as well and also because these were developing boxes they were being used developers dog food their own food as",
    "start": "1608379",
    "end": "1614919"
  },
  {
    "text": "Michael mentioned they took a lot of pictures of development stuff things like all their account emails and",
    "start": "1614919",
    "end": "1620409"
  },
  {
    "text": "passwords for their very different mobile app store logins and things like that as well as whiteboard sessions",
    "start": "1620409",
    "end": "1626710"
  },
  {
    "text": "where they were diagramming the server architecture infrastructure and how they were going to do so I mean their developers right I mean probably if you",
    "start": "1626710",
    "end": "1633039"
  },
  {
    "text": "work in an enterprise there's a good chance one of your developers has done the exact same thing it's just the fact that this was the developers of",
    "start": "1633039",
    "end": "1638769"
  },
  {
    "text": "surveillance where that was doing it so think about that if there's a mobile phone in the room taking pictures of whiteboards and then finally there was a",
    "start": "1638769",
    "end": "1646299"
  },
  {
    "text": "decent amount of imagery from military government and related officials as well including some US Army personnel that",
    "start": "1646299",
    "end": "1652480"
  },
  {
    "text": "was um they weren't directly targeted but because they were in rooms or had communications that went through people that were targeted kind of got picked up",
    "start": "1652480",
    "end": "1658899"
  },
  {
    "text": "in the sort of thing oh go back if it lets me go back it's luck yeah and so",
    "start": "1658899",
    "end": "1666070"
  },
  {
    "text": "the types of XML data we saw the majority the data the big purple one if you can't read the text on the bottom was images a lot of images that were",
    "start": "1666070",
    "end": "1672009"
  },
  {
    "text": "collected with the rest of the data kind of being just video and some audio surrounds that was happening as well from our perspective now how much did",
    "start": "1672009",
    "end": "1678909"
  },
  {
    "text": "they get they got about 30 gigabytes of data last before everything kind of shut",
    "start": "1678909",
    "end": "1684279"
  },
  {
    "text": "down and if you can kind of see those they there were essentially slow rolling this out kind of in December January and",
    "start": "1684279",
    "end": "1689499"
  },
  {
    "text": "then sort of in May it really spiked they started to deploy it on more devices we saw a lot more data sort of",
    "start": "1689499",
    "end": "1695409"
  },
  {
    "text": "flow in from a lot of different um different individuals out there as well so at the end at the end of all of it there's about 300,000 plus images as",
    "start": "1695409",
    "end": "1702669"
  },
  {
    "text": "well as 6,000 call recordings variety videos and a couple dozen environmental recordings basically means like they as",
    "start": "1702669",
    "end": "1708879"
  },
  {
    "text": "Mike mentioned they just hop Mike they just said hey phone record during these hours and go forward from there it was",
    "start": "1708879",
    "end": "1715600"
  },
  {
    "text": "pretty it was it was able to get a lot of data as we talked about without any sort of exploits just simply asking permission fishing the user and get it to install",
    "start": "1715600",
    "end": "1722580"
  },
  {
    "text": "where was the data located it was essentially regional around Stan so in terms of different types of",
    "start": "1722580",
    "end": "1728020"
  },
  {
    "text": "areas of Pakistan as well as Afghanistan India and a couple over in the UAE as",
    "start": "1728020",
    "end": "1734050"
  },
  {
    "text": "well as where they were essentially operating or collect the targets were that were being infected with malware so",
    "start": "1734050",
    "end": "1739150"
  },
  {
    "text": "it was very much regional based spy that what's happening there now it's for some highlight that some of the types of data",
    "start": "1739150",
    "end": "1745090"
  },
  {
    "text": "that was there we had one government communication that had come actually from a US official inviting someone in",
    "start": "1745090",
    "end": "1754540"
  },
  {
    "text": "Afghanistan to come over to the US for military conference and at the time that this data had come in the conference had",
    "start": "1754540",
    "end": "1760510"
  },
  {
    "text": "not happened yet so this was something that had come in had gotten taking a picture of and then exfiltrated up to the server but had not actually occurred",
    "start": "1760510",
    "end": "1767440"
  },
  {
    "text": "yet at the point in time which we were looking at it there was also some very blunt communications that had come",
    "start": "1767440",
    "end": "1772930"
  },
  {
    "text": "across where someone was expressing their concerns about a foreign secretary we saw this and we saw this in the data",
    "start": "1772930",
    "end": "1781330"
  },
  {
    "text": "actually before it went live so this letter is live if you try to Google some of the key words and we'll come across",
    "start": "1781330",
    "end": "1787230"
  },
  {
    "text": "but what it did come across the data that we saw before it actually was a lot of communication so there are people",
    "start": "1787230",
    "end": "1792580"
  },
  {
    "text": "taking these pictures that are going on there but it was interesting to see kind of help blunt some people are in government with their feelings on people",
    "start": "1792580",
    "end": "1799290"
  },
  {
    "text": "we also had some stuff it's a little bit redacted but this is essentially travel information for Australian and German",
    "start": "1799290",
    "end": "1805330"
  },
  {
    "text": "diplomats who they were traveling with when they were coming when they were going and kind of all that tracking",
    "start": "1805330",
    "end": "1810850"
  },
  {
    "text": "detail that would be going around in the country as well and that was all sitting up on the server as well there were",
    "start": "1810850",
    "end": "1816250"
  },
  {
    "text": "pictures of you know military weapon shows and on artillery stuff that was happening kind of at the Air Force bases",
    "start": "1816250",
    "end": "1821860"
  },
  {
    "text": "their internal meetings with a variety of different individuals different sorts of military patches and things like",
    "start": "1821860",
    "end": "1827500"
  },
  {
    "text": "there were awards were given but also essentially closed-door meetings that were happening more closed-door meetings",
    "start": "1827500",
    "end": "1833290"
  },
  {
    "text": "with different individuals we've tried to blur as best we can everything that looked for linkable on linkable there",
    "start": "1833290",
    "end": "1839260"
  },
  {
    "text": "was some other sorts of meetings that were happening on a kind of big floor maps that they were using giant sticks to move things around I think the",
    "start": "1839260",
    "end": "1845530"
  },
  {
    "text": "variety of different areas as well different individuals and different kind of governments gathering there as well",
    "start": "1845530",
    "end": "1850660"
  },
  {
    "text": "as and we talked about the GPS information in pictures but also they were doing GPS tracking of the devices this for example is a phone that was",
    "start": "1850660",
    "end": "1858040"
  },
  {
    "text": "infected that she was someone that was traveling into the Ministry of Defence with in",
    "start": "1858040",
    "end": "1863549"
  },
  {
    "text": "Afghanistan so this was kind of their target pool that they were going after and this is someone that actually did work within there and the GPS",
    "start": "1863549",
    "end": "1869220"
  },
  {
    "text": "information of where they were going another interesting thing and we talked about IDs and passport photos is that",
    "start": "1869220",
    "end": "1874860"
  },
  {
    "text": "when we looked in some of the metadata on there was a cluster of passport photos that we saw on the exfil when we",
    "start": "1874860",
    "end": "1880559"
  },
  {
    "text": "looked at the X when we looked at the GPS coordinates they all essentially mapped over the Kandahar Airport which we thought was very interesting and they",
    "start": "1880559",
    "end": "1886140"
  },
  {
    "text": "were all essentially Iranian diplomats I believe in that cluster that we're all",
    "start": "1886140",
    "end": "1892200"
  },
  {
    "text": "taken there so someone either knowingly or non knowingly was infected with stealth mango at the time and was um",
    "start": "1892200",
    "end": "1898380"
  },
  {
    "text": "taking pictures of these passports not sure why but they were and the data was getting exfiltrated as well up to the c2",
    "start": "1898380",
    "end": "1903510"
  },
  {
    "text": "server that was there I don't know if to Michael to kind of close out a little bit the identities were cool so we've",
    "start": "1903510",
    "end": "1912540"
  },
  {
    "text": "seen a lot of a lot of reoccurring identities pop up here and they kind of",
    "start": "1912540",
    "end": "1918450"
  },
  {
    "text": "tend to lead back to this one group based in based in Pakistan called fi9",
    "start": "1918450",
    "end": "1923790"
  },
  {
    "text": "texts so we saw their email address before and it turns out that some of the",
    "start": "1923790",
    "end": "1929640"
  },
  {
    "text": "people that have worked for this group has spent time at vuoi p.m. which if you remember if we go way back to the public",
    "start": "1929640",
    "end": "1935460"
  },
  {
    "text": "information about some of the key players behind this they also spend some time there and and pretty much they you",
    "start": "1935460",
    "end": "1944580"
  },
  {
    "text": "can see that they're operate for 50 US dollars an hour this is this is really cheap to get your hands on these kinds",
    "start": "1944580",
    "end": "1950669"
  },
  {
    "text": "of capabilities and it's something that we continually see I think as researchers we often overestimate what",
    "start": "1950669",
    "end": "1957059"
  },
  {
    "text": "attackers need to do to compromise endpoints and there are a lot of low",
    "start": "1957059",
    "end": "1962400"
  },
  {
    "text": "sophistication attacks that we've just seen it's still really highly successful",
    "start": "1962400",
    "end": "1967610"
  },
  {
    "text": "so in addition to people from VoIP um having connections to this fi9 tech",
    "start": "1967850",
    "end": "1974010"
  },
  {
    "text": "group a lot of them also have history at places like apps attacks such as sagine",
    "start": "1974010",
    "end": "1979460"
  },
  {
    "text": "oxygen there's that connection and then super innovative which we saw earlier",
    "start": "1979460",
    "end": "1985429"
  },
  {
    "text": "[Music] yeah so we've kinda already covered this faisal his role hasn't really changed",
    "start": "1985680",
    "end": "1991530"
  },
  {
    "text": "he's still responsible all for the infrastructure side of things Sajid he's still really good at",
    "start": "1991530",
    "end": "1999809"
  },
  {
    "text": "including his personal content and exfiltrated data as we can see here so that's a letter of reference from his",
    "start": "1999809",
    "end": "2007190"
  },
  {
    "text": "previous job saying he does a really good job hi him and then he's also including",
    "start": "2007190",
    "end": "2014090"
  },
  {
    "text": "personal information in a lot of the c2 domains as we can see in the middle in the Whois I dotted there and then the",
    "start": "2014090",
    "end": "2020929"
  },
  {
    "text": "picture on the right is taken from some of the conference's that he talks at as a developer she could be interesting to",
    "start": "2020929",
    "end": "2027710"
  },
  {
    "text": "go to and then one of the identities that we haven't yet covered came out of",
    "start": "2027710",
    "end": "2034039"
  },
  {
    "text": "looking at the phishing content that was being used in this campaign so if the",
    "start": "2034039",
    "end": "2039259"
  },
  {
    "text": "mobile tooling fails these guys also will try to fish our credentials so they've set up a number of different",
    "start": "2039259",
    "end": "2044299"
  },
  {
    "text": "pages that look legitimate as we can here see here we've got a Google sign-in page that might seem",
    "start": "2044299",
    "end": "2051618"
  },
  {
    "text": "legitimate but if we look at the source code it's a little awkward there are a",
    "start": "2051619",
    "end": "2057770"
  },
  {
    "text": "lot of a lot of email addresses just littered about so this person has",
    "start": "2057770",
    "end": "2063020"
  },
  {
    "text": "decided to essentially copy save this page despite a containing personal",
    "start": "2063020",
    "end": "2068628"
  },
  {
    "text": "metadata connecting to them and if we search around that there's a nice little",
    "start": "2068629",
    "end": "2074810"
  },
  {
    "text": "Adidas tutorial on YouTube that actually contains their Facebook ID and hey buddy",
    "start": "2074810",
    "end": "2084888"
  },
  {
    "text": "what's that guy I'm so where these",
    "start": "2084889",
    "end": "2091128"
  },
  {
    "text": "people actually logging into these systems from enhance cool so as Andrew",
    "start": "2091129",
    "end": "2102020"
  },
  {
    "text": "mentioned as we have access to some of the some of the key information on on",
    "start": "2102020",
    "end": "2107930"
  },
  {
    "text": "the command and control server we can actually see where admins are logging into these systems from and in this case",
    "start": "2107930",
    "end": "2113740"
  },
  {
    "text": "all logging connections were coming from the g8 District in Pakistan and this is",
    "start": "2113740",
    "end": "2120170"
  },
  {
    "text": "heavily populated with government buildings in this case it says the",
    "start": "2120170",
    "end": "2125450"
  },
  {
    "text": "Ministry of Education is where this ipag locates too but I",
    "start": "2125450",
    "end": "2130990"
  },
  {
    "text": "think just broadly it's worth noting that since high areas is government",
    "start": "2130990",
    "end": "2136700"
  },
  {
    "text": "facilities so it's that general region basically cool so we've covered the",
    "start": "2136700",
    "end": "2144170"
  },
  {
    "text": "identities the Android pays some of the exfil we'll just wrap up now with the",
    "start": "2144170",
    "end": "2149210"
  },
  {
    "text": "connection to the iOS side of the house thanks yeah so we talked a bit about the",
    "start": "2149210",
    "end": "2154670"
  },
  {
    "text": "Android piece throughout the investigation and the exfil data we looked at we come back to metadata we",
    "start": "2154670",
    "end": "2160070"
  },
  {
    "text": "come back to exit data and that is the metadata in the images we noticed a lot of the images that we saw high",
    "start": "2160070",
    "end": "2166280"
  },
  {
    "text": "percentage of them actually were from iPhone devices and we thought that was very curious because we at the time we",
    "start": "2166280",
    "end": "2171320"
  },
  {
    "text": "only had the Android samples and we're like this is interesting is there and I are they making information or how are",
    "start": "2171320",
    "end": "2176450"
  },
  {
    "text": "they trading this data back and forth or through phones some apps that we would think that they were doing it would be stripping out the EXIF data so we got us",
    "start": "2176450",
    "end": "2184340"
  },
  {
    "text": "thinking about this and we kept searching and searching and searching and eventually we found a sample that",
    "start": "2184340",
    "end": "2190460"
  },
  {
    "text": "linked back to a lot of what these guys were doing that's called tan jello actually and it actually is called tan jello in the",
    "start": "2190460",
    "end": "2196520"
  },
  {
    "text": "actual manifest now it's important to note about tangelos iOS implant is that it's not it's not an app it's",
    "start": "2196520",
    "end": "2203420"
  },
  {
    "text": "essentially a debian package that would install on a already jailbroken phone so in this case it the type of data that",
    "start": "2203420",
    "end": "2209480"
  },
  {
    "text": "they want to get after they still need a jailbroken phone to go after the device so and this is this is a common approach",
    "start": "2209480",
    "end": "2215240"
  },
  {
    "text": "that we see spouse we're makers actually doing is that they'll say hey here's the Android piece but the iOS piece it's it's better if you have a jailbroken",
    "start": "2215240",
    "end": "2221210"
  },
  {
    "text": "phone and you can install this debian pack and you go forward from that and that kind of flows through a lot of what we know and have seen them develop as",
    "start": "2221210",
    "end": "2226970"
  },
  {
    "text": "well but it goes up the same types of data call recording video the gallery",
    "start": "2226970",
    "end": "2232280"
  },
  {
    "text": "images as well audio surroundings as well as the SMS data coordinates blah blah blah and it also specifically goes",
    "start": "2232280",
    "end": "2239060"
  },
  {
    "text": "after similar types of app data that it would get from the shared store on Android things like whatsapp data viber",
    "start": "2239060",
    "end": "2245360"
  },
  {
    "text": "Skype and line were the four main apps that it was going after within the implant itself now some of the",
    "start": "2245360",
    "end": "2252500"
  },
  {
    "text": "interesting stuff that we saw obviously the codename with ken jell-o that was in there so that's why we have mango as the Android side well we did find a noticing",
    "start": "2252500",
    "end": "2259850"
  },
  {
    "text": "was at the comm new ID comm mobile care which will show in a second does link to other apps that",
    "start": "2259850",
    "end": "2265850"
  },
  {
    "text": "these developers have built in the past for a company called mobile care that was some some of it with surveillance",
    "start": "2265850",
    "end": "2271430"
  },
  {
    "text": "but other stuff they were just using Azure development bundle ID that was there as well but from this we could get the team ID which helps us track down",
    "start": "2271430",
    "end": "2277730"
  },
  {
    "text": "other apps that they might have developed under this persona and stuff like that additionally though it had similar",
    "start": "2277730",
    "end": "2283730"
  },
  {
    "text": "heuristics to the one spot as we saw on the Android side further link providing that linkage as well on that stuff but",
    "start": "2283730",
    "end": "2289640"
  },
  {
    "text": "it is important to note that the primary stuff that we did see with the c2 was all Android based within these campaigns",
    "start": "2289640",
    "end": "2296350"
  },
  {
    "text": "the tangelos stuff it may have been a mixture of development and stuff that they might have used out because they",
    "start": "2296350",
    "end": "2301730"
  },
  {
    "text": "definitely had a weird structure to their debian where they had kind of two separate copies of the implant and different folders in the package with",
    "start": "2301730",
    "end": "2307940"
  },
  {
    "text": "different types of files that were there some test images as well that they were collecting what was helpful though was",
    "start": "2307940",
    "end": "2313190"
  },
  {
    "text": "that they had left their development probe developer profile in the actual sample that they uploaded to win their c2 servers which you know gives us good",
    "start": "2313190",
    "end": "2319880"
  },
  {
    "text": "insight into what who's developing this what's the team ideas but also additionally you know when you share this with the appropriate people what",
    "start": "2319880",
    "end": "2326060"
  },
  {
    "text": "devices are being used based on those unique Goodes that are there so that's further threat until I OSI sharing that",
    "start": "2326060",
    "end": "2331190"
  },
  {
    "text": "can happen help track down where else these guys are operating what else they're doing because this is all registered with the development portal",
    "start": "2331190",
    "end": "2337220"
  },
  {
    "text": "that's there what kind of footprint that this have on the phone basically you would install locations that you can",
    "start": "2337220",
    "end": "2343220"
  },
  {
    "text": "only get to if you have a pre compromised phone so things like and actually they would call the app I notifier so if you are looking for this",
    "start": "2343220",
    "end": "2349790"
  },
  {
    "text": "in your data set that's kind of what it would be called and they would have you know they would install things in the",
    "start": "2349790",
    "end": "2355070"
  },
  {
    "text": "launch Damian's so that it would launch up when they the phone would get rebooted run the daemons to listen and exfiltrate data but also a variety of",
    "start": "2355070",
    "end": "2361670"
  },
  {
    "text": "different other runtime installation footprints where they were essentially copying database across the temporary storage in order to read them process",
    "start": "2361670",
    "end": "2368060"
  },
  {
    "text": "them and then send them up to the c2 servers as well wasn't very sophisticated this is kind of a common approach you see in this sort of stuff",
    "start": "2368060",
    "end": "2373730"
  },
  {
    "text": "but this and this is the approach that they took and this and then you know the kind of the stuff that we saw through",
    "start": "2373730",
    "end": "2379520"
  },
  {
    "text": "you know just throwing it in Ida doing some analysis on it we see the strings you know there are linkages to the ones",
    "start": "2379520",
    "end": "2384860"
  },
  {
    "text": "lab is seen here with the URLs and domains it exists as well as a couple other servers that are not related to the One SPY that I'm going to link back",
    "start": "2384860",
    "end": "2391100"
  },
  {
    "text": "to these developers as well and their infrastructure that we we found there another thing was so",
    "start": "2391100",
    "end": "2398960"
  },
  {
    "text": "you'll see this the et identifiers in some of these objective-c methods that they're doing is this is believed to be",
    "start": "2398960",
    "end": "2404359"
  },
  {
    "text": "a framework that they develop with another one of their other companies called apps or tech they just essentially abbreviate everything with a",
    "start": "2404359",
    "end": "2410540"
  },
  {
    "text": "T but it kind of does all of their collection of data and processing stuff so they developed a framework in order",
    "start": "2410540",
    "end": "2416270"
  },
  {
    "text": "to do all this stuff and helpfully abbreviated it which helped with just easy to kind of pull out and track and find if you're looking at other samples",
    "start": "2416270",
    "end": "2422450"
  },
  {
    "text": "as well out there this is just an example of the code that they would do for kind of grabbing the SMS data",
    "start": "2422450",
    "end": "2428000"
  },
  {
    "text": "basically then we just copied the database to another area of the device process it and then send it up instead",
    "start": "2428000",
    "end": "2434210"
  },
  {
    "text": "of actually doing any other interesting stuff there now we meant to some of those C twos before and they we",
    "start": "2434210",
    "end": "2439580"
  },
  {
    "text": "mentioned that they do they are doing legitimate app development however",
    "start": "2439580",
    "end": "2445220"
  },
  {
    "text": "they're sloppy they reuse an infrastructure a number of things and this is one of the apps that they had",
    "start": "2445220",
    "end": "2450410"
  },
  {
    "text": "built that they actually ended up reusing some of their malicious c2 infrastructure for down there we don't",
    "start": "2450410",
    "end": "2457070"
  },
  {
    "text": "believe the app is malicious it's actually just using it's pinging that URL on that c2 server in this Capps case",
    "start": "2457070",
    "end": "2464930"
  },
  {
    "text": "just to essentially register for push notification so that they can register and get and do all the stuff that the",
    "start": "2464930",
    "end": "2470030"
  },
  {
    "text": "apps doing however we highlighted in the report and also in here to say like you know they are reusing is this is using a malicious",
    "start": "2470030",
    "end": "2476060"
  },
  {
    "text": "case in some time so if it were to pop up kind of in your IDs or something like that this is the reason why that is",
    "start": "2476060",
    "end": "2482810"
  },
  {
    "text": "there but they are sloppy they do reuse a lot of their legitimate information infrastructure as well as for their spyware stuff as well and finally they",
    "start": "2482810",
    "end": "2489830"
  },
  {
    "text": "kind of wrap up let's get into attack vectors how were they actually doing this and we actually have some interesting images so what they did was",
    "start": "2489830",
    "end": "2496520"
  },
  {
    "text": "put the Android side they set up a a fake Android third-party app store in",
    "start": "2496520",
    "end": "2503930"
  },
  {
    "text": "this case there is there is there is a third-party app store called apk monk this is not it but they did a",
    "start": "2503930",
    "end": "2509300"
  },
  {
    "text": "one-for-one representation recreation of that site all the links are clickable but they all redirect back to this same",
    "start": "2509300",
    "end": "2516140"
  },
  {
    "text": "app in the same location they even cut they even have actually detailed information and quote-unquote comments",
    "start": "2516140",
    "end": "2521240"
  },
  {
    "text": "at the bottom to make it look like a legitimate site to get someone to go and click their link how is this stuff",
    "start": "2521240",
    "end": "2527180"
  },
  {
    "text": "actually delivered through long-term spearfishing right so they actually set up a profile one of",
    "start": "2527180",
    "end": "2533190"
  },
  {
    "text": "the names is on the domaine sauna and we'll show that in a second but they would essentially do this have a",
    "start": "2533190",
    "end": "2540210"
  },
  {
    "text": "conversation with them and eventually get them to go click the link and go forward and install this and it was highly successful based on the data that",
    "start": "2540210",
    "end": "2545580"
  },
  {
    "text": "we've seen there as well what is interesting about this persona and I believe this stuff has been taken down",
    "start": "2545580",
    "end": "2550860"
  },
  {
    "text": "at this point this actually is a real person's name in a real picture but the per the profile",
    "start": "2550860",
    "end": "2556110"
  },
  {
    "text": "that's there this is not their profile and there were some reports after the report came out that kind of documented",
    "start": "2556110",
    "end": "2561900"
  },
  {
    "text": "a bit of this but they had a sense just taking all this information made their own essentially soft puppet and use this",
    "start": "2561900",
    "end": "2568290"
  },
  {
    "text": "information so that they can go ahead and fish the on the attackers out there and this is what the installation path",
    "start": "2568290",
    "end": "2574290"
  },
  {
    "text": "looks like in this case actually this was an already infected device like how do we have the screenshots it was an already infected device that was",
    "start": "2574290",
    "end": "2580590"
  },
  {
    "text": "receiving an update to the examples they reef ish them to get an update on that on the device and so we can kind of see",
    "start": "2580590",
    "end": "2585780"
  },
  {
    "text": "what the process would be and in this case because there's no new permissions the user just goes and installs and goes slower through there but the app itself",
    "start": "2585780",
    "end": "2592290"
  },
  {
    "text": "doesn't really have anything interesting in that on what this launched and then finally there was one interesting",
    "start": "2592290",
    "end": "2598590"
  },
  {
    "text": "infection vector where we speculate there was some physical access involved where based on the name that we saw kind",
    "start": "2598590",
    "end": "2604200"
  },
  {
    "text": "of this package coming to and from from a repair shop that they may have someone",
    "start": "2604200",
    "end": "2610560"
  },
  {
    "text": "may have been operating out of the repair shop actually installing us on phones and sending it back to them as well in some cases so you may get your",
    "start": "2610560",
    "end": "2617400"
  },
  {
    "text": "phone fix but it comes back with a little something extra which you may or may not want so if you send your phone out to repair maybe do a scan on it",
    "start": "2617400",
    "end": "2623670"
  },
  {
    "text": "before he started up again and then finally know as Mike mentioned they were",
    "start": "2623670",
    "end": "2629100"
  },
  {
    "text": "doing credential fishing as well they did have Gmail but they were also doing Facebook credential fishing as well and",
    "start": "2629100",
    "end": "2634410"
  },
  {
    "text": "then finally they had several different the APK fishing sites that they were",
    "start": "2634410",
    "end": "2639810"
  },
  {
    "text": "using they were all hope they were all hosting them but they've all been taken down at this point so they were yeah we",
    "start": "2639810",
    "end": "2646050"
  },
  {
    "text": "did have an interesting bomb when we did the takedown initially to get the site off you know the developer gets reached",
    "start": "2646050",
    "end": "2651900"
  },
  {
    "text": "out by the people owning the server and they say okay you know malicious stuff has been found please take this off the site they literally just replaced it",
    "start": "2651900",
    "end": "2658170"
  },
  {
    "text": "with a different sample which they didn't actually do anything to change the same put a new sample up and we just issued",
    "start": "2658170",
    "end": "2664350"
  },
  {
    "text": "another takedown and eventually the whole system went down at that point which was interesting so yeah so kind of",
    "start": "2664350",
    "end": "2671040"
  },
  {
    "text": "just to wrap up a bit about this sometime there so we have Android iOS and plants and important to know Android",
    "start": "2671040",
    "end": "2676200"
  },
  {
    "text": "we call stealth mango it's also known as stealth agent which was a project that they had also tried to run at some point",
    "start": "2676200",
    "end": "2681420"
  },
  {
    "text": "in time based on indicators that we saw in the the server-side code there was well iOS was 10 jello and during the",
    "start": "2681420",
    "end": "2691620"
  },
  {
    "text": "course is active active active investigation you know they were also very active in developing they were releasing new samples you know we saw",
    "start": "2691620",
    "end": "2696750"
  },
  {
    "text": "there was 42 samples that were released in the span of three months they were also very active at updating their server code they were changing how",
    "start": "2696750",
    "end": "2703050"
  },
  {
    "text": "things are working they were added new features they are their developers right they're doing QA they were finding",
    "start": "2703050",
    "end": "2708540"
  },
  {
    "text": "they're adding functionality based on customer demands so that they were kind of doing that as far as targets go the",
    "start": "2708540",
    "end": "2713670"
  },
  {
    "text": "primary ones really were activists governments government officials and members of the military based in",
    "start": "2713670",
    "end": "2718860"
  },
  {
    "text": "Pakistan Afghanistan India Iraq and the UAE and the secondary stuff we've mentioned as you saw on some of the",
    "start": "2718860",
    "end": "2723930"
  },
  {
    "text": "images there was secondary collection from individuals from other countries as well that were out there",
    "start": "2723930",
    "end": "2729660"
  },
  {
    "text": "and then finally you know based on a lot of the linkages we've had with kind of past supports and all the data that we saw in this in this report and this this",
    "start": "2729660",
    "end": "2736110"
  },
  {
    "text": "investigation we can confidently link it to kind of the group that you know a group operating or part of the Pakistani",
    "start": "2736110",
    "end": "2742530"
  },
  {
    "text": "military based on all the other signals that we've seen is as Mike mentioned you know they didn't really take much opportunity to hide themselves or change",
    "start": "2742530",
    "end": "2748260"
  },
  {
    "text": "their identities or infrastructure or anything like that it kind of just reuse they just deployed a different technique at this point in time and to wrap up you",
    "start": "2748260",
    "end": "2755670"
  },
  {
    "text": "know the slides are available but number of different reports you can read so we have our full report it's about 6070",
    "start": "2755670",
    "end": "2761250"
  },
  {
    "text": "pages on has a lot of information and if you're interested learning more about the details in parallel that this investigation was going on",
    "start": "2761250",
    "end": "2767940"
  },
  {
    "text": "we got notified that amnesty was also working on something similar coming at it from a different angle so you can also read their report and learn more",
    "start": "2767940",
    "end": "2773910"
  },
  {
    "text": "about that side of the hells and they talked to some individuals that were actually targeted with this directly so",
    "start": "2773910",
    "end": "2779190"
  },
  {
    "text": "it could be interesting if you want to learn more about that these actors prior works through the",
    "start": "2779190",
    "end": "2784350"
  },
  {
    "text": "Trend Micro or the Proofpoint pool the Proofpoint reports as well and with that",
    "start": "2784350",
    "end": "2789870"
  },
  {
    "text": "if you want to contact on Twitter or you have any interesting stuff please email us with that thank you very much",
    "start": "2789870",
    "end": "2795760"
  },
  {
    "text": "like open up for any questions or we can chat after thank you [Applause]",
    "start": "2795760",
    "end": "2808139"
  }
]