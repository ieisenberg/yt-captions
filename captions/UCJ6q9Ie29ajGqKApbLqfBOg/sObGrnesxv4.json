[
  {
    "text": "all right so we're gonna start now hi everyone good morning thank you for",
    "start": "30",
    "end": "7200"
  },
  {
    "text": "being here and we're pretty happy to be talking about a research we did in the past few months about a ufi rootkit we found in",
    "start": "7200",
    "end": "14730"
  },
  {
    "text": "the wild and what makes this thing very very interesting is that it was actually the first one that was found in the",
    "start": "14730",
    "end": "20220"
  },
  {
    "text": "world weary found an infection that was and then I could I was using this UEFI rootkit to target their other victims",
    "start": "20220",
    "end": "27689"
  },
  {
    "text": "right so before we dive in I just wanted to introduce ourselves so my name is Ryan good time and together with my",
    "start": "27689",
    "end": "34680"
  },
  {
    "text": "colleague Phil aggression we are both malware researcher we're both based in Montreal we work as more",
    "start": "34680",
    "end": "40710"
  },
  {
    "text": "researcher for an security firm called ESET and we do maori research as as a",
    "start": "40710",
    "end": "48360"
  },
  {
    "text": "work right so we do reverse engineering mostly and we try to piece together our different campaigns so if you looked at",
    "start": "48360",
    "end": "54930"
  },
  {
    "text": "our title or you saw that we actually attribute these this UFO rootkit to a threat actor we called Senate but it",
    "start": "54930",
    "end": "62219"
  },
  {
    "text": "also goes with different names so a fancy bear a PT 28 strontium C all aliases for the same group and before we",
    "start": "62219",
    "end": "69570"
  },
  {
    "text": "dive in into the tools these guys are using I just want to make sure that you are familiar with this is channel truth",
    "start": "69570",
    "end": "76619"
  },
  {
    "text": "so just let me let me ask you a question first how many people know of this trial actor and ok cool so about half people",
    "start": "76619",
    "end": "85049"
  },
  {
    "text": "probably so it's an espionage true so they don't do cyber crime for really",
    "start": "85049",
    "end": "91200"
  },
  {
    "text": "money they do it to gain information on the victim system right they've been active since the early 2000 and they",
    "start": "91200",
    "end": "97860"
  },
  {
    "text": "were very visible in the past few years because they did some very notorious hack so I'm just gonna highlight some of",
    "start": "97860",
    "end": "103320"
  },
  {
    "text": "them so maybe you remember the act of the Democratic National Committee or the DNC that happened in 2016 it was leading",
    "start": "103320",
    "end": "111119"
  },
  {
    "text": "to the u.s. presidential election and they compromised a lot of systems and they were able to leak emails and leak",
    "start": "111119",
    "end": "118140"
  },
  {
    "text": "them online and a lot of people were seeing the conversation happening inside again see the other act that happened",
    "start": "118140",
    "end": "124680"
  },
  {
    "text": "recently is the world anti-doping agency or wada so these guys are literally behind this",
    "start": "124680",
    "end": "130590"
  },
  {
    "text": "actually were able again to compromise systems deal email signal information and they",
    "start": "130590",
    "end": "135689"
  },
  {
    "text": "also leaked it online under hack since were close to friends here maybe some of you noticed TV five moment which is a",
    "start": "135689",
    "end": "142590"
  },
  {
    "text": "French broadcaster that air program throughout the world and this group is again allegedly behind a hack and they",
    "start": "142590",
    "end": "148890"
  },
  {
    "text": "were able to cut their signal down for a couple of hours and there's a lot of other hacks that these guys did and",
    "start": "148890",
    "end": "155569"
  },
  {
    "text": "isolated Lee because at he said we don't do attribution so what we call the Senate group is Murli campaigns that",
    "start": "155569",
    "end": "161700"
  },
  {
    "text": "these guys are doing or tools that these guys are using in their campaigns but other groups actually try to to",
    "start": "161700",
    "end": "169620"
  },
  {
    "text": "attribute these attacks to a specific group and there was something very interesting that happened last July",
    "start": "169620",
    "end": "175170"
  },
  {
    "text": "which is an indictment from the United States Department of Justice where they",
    "start": "175170",
    "end": "181170"
  },
  {
    "text": "were naming specific people and they were and this one actually saying that these guys were behind be DN C AK so",
    "start": "181170",
    "end": "188010"
  },
  {
    "text": "this is of course another hint that these guys were linked to this and why",
    "start": "188010",
    "end": "193439"
  },
  {
    "text": "it's important for us is because they are actually naming a lot of the backdoors that the Senate operators are",
    "start": "193439",
    "end": "199470"
  },
  {
    "text": "using and the backdoors that we are seeing and that are targeting our customers right so this is one another",
    "start": "199470",
    "end": "205889"
  },
  {
    "text": "proof that these guys are behind these hacks and there was another one quite recently in October this year where",
    "start": "205889",
    "end": "212099"
  },
  {
    "text": "there was also linking this group to the water hack as well as other hack and naming people and naming the tools the",
    "start": "212099",
    "end": "218699"
  },
  {
    "text": "backdoor said these guys were using so as the last step I just want to show you how they are operating so they usually",
    "start": "218699",
    "end": "225870"
  },
  {
    "text": "use email so this is an example with phishing email that would send to the targets you can see here the email says",
    "start": "225870",
    "end": "232319"
  },
  {
    "text": "that your personal data has been found on Google and then there's a link that if you click on it you know if you",
    "start": "232319",
    "end": "238169"
  },
  {
    "text": "direct it to the real Google server you're in fact redirected to a page that is owned by the Senate group right this",
    "start": "238169",
    "end": "245729"
  },
  {
    "text": "is an example of the type of phishing page that you would see if the user goes ahead and enter their credentials it",
    "start": "245729",
    "end": "252599"
  },
  {
    "text": "will then be actual traded to the same it operators which can then reuse them of course they're not only using",
    "start": "252599",
    "end": "258239"
  },
  {
    "text": "phishing emails they're also using emails to try to distribute their malware so they will have an attachment",
    "start": "258239",
    "end": "264240"
  },
  {
    "text": "another such attachment that will try to install one of his tools they use to spy on on their",
    "start": "264240",
    "end": "270000"
  },
  {
    "text": "victims right so that you can think of backdoors keyloggers screenshot capture all type of tools",
    "start": "270000",
    "end": "275490"
  },
  {
    "text": "that allow them to know what is going on on a victim and steal information from them so this kind of brings us to our",
    "start": "275490",
    "end": "283169"
  },
  {
    "text": "main topic which is the UFO rootkit so not only are they they have sophisticated backdoors that are trying",
    "start": "283169",
    "end": "290100"
  },
  {
    "text": "to be persistent but through our research what we found is that they actually also have a very sophisticated",
    "start": "290100",
    "end": "295639"
  },
  {
    "text": "ufi rootkit and not only they had this but they also had the tooling to install",
    "start": "295639",
    "end": "300990"
  },
  {
    "text": "it remotely on a computer so of course if you have physical access to computer it's actually quite easier to reflash",
    "start": "300990",
    "end": "308639"
  },
  {
    "text": "the firmware to install these type of UFO rootkit in that case as we will show you they actually use a software tool to",
    "start": "308639",
    "end": "315690"
  },
  {
    "text": "patch it framework so this concludes our introduction so what we're gonna see today is first what is LoJack so I will",
    "start": "315690",
    "end": "322770"
  },
  {
    "text": "explain why it is important to look at this anti-theft software and we're going to take a quick look at the past research on insecurities and",
    "start": "322770",
    "end": "329250"
  },
  {
    "text": "probabilities that were found in this in this software and then we'll read I will",
    "start": "329250",
    "end": "334770"
  },
  {
    "text": "begin the meat of the presentation where how we found this UEFI rootkit also we",
    "start": "334770",
    "end": "340080"
  },
  {
    "text": "will show you the analysis of all the components how its works and also finally we will do some remediation so",
    "start": "340080",
    "end": "346440"
  },
  {
    "text": "how you can protect yourself from this threat so LoJack it's an anti-theft software it wasn't only for us compute",
    "start": "346440",
    "end": "353250"
  },
  {
    "text": "race maybe a lot of people here know about this this software it's made by a company called absolute software and",
    "start": "353250",
    "end": "360030"
  },
  {
    "text": "it's present in a lot of laptops so there's a good possibility that on your",
    "start": "360030",
    "end": "365070"
  },
  {
    "text": "laptop you have this tool and install in the on your system and what it does is",
    "start": "365070",
    "end": "371010"
  },
  {
    "text": "that if you laptop is ever stolen or you lose it it has different services to try",
    "start": "371010",
    "end": "376740"
  },
  {
    "text": "to locate it using Wi-Fi sing or GPS vacation you can also send different",
    "start": "376740",
    "end": "381930"
  },
  {
    "text": "commands so you can try to lock your computer you can also try to wipe it",
    "start": "381930",
    "end": "387479"
  },
  {
    "text": "remotely so that a hardware tap will not result in to a data leak and you can try",
    "start": "387479",
    "end": "393330"
  },
  {
    "text": "to read to locate it through this this computer through this software and you",
    "start": "393330",
    "end": "398610"
  },
  {
    "text": "need to activate it and it's usually use Bourg to make sure that he can track back some of their laptops should it be stolen",
    "start": "398610",
    "end": "405270"
  },
  {
    "text": "right and there was a lot of past research on this why because of course if you have an anti-theft software like",
    "start": "405270",
    "end": "410550"
  },
  {
    "text": "this one you want to make it as persistent as possible so how these guys were doing it is that",
    "start": "410550",
    "end": "416130"
  },
  {
    "text": "they had a UEFI module that will put back the agent if the thief would go",
    "start": "416130",
    "end": "421710"
  },
  {
    "text": "ahead and reinstall windows or replace the artist let's say so if they do go ahead and do that well the system is",
    "start": "421710",
    "end": "428610"
  },
  {
    "text": "starting up the UEFI module was able to still reinstall the agent that could locate the laptop to the first research",
    "start": "428610",
    "end": "436380"
  },
  {
    "text": "that I want to show you is this one it was presented at blackhat us in 2009 so as you can see this is pretty old",
    "start": "436380",
    "end": "441600"
  },
  {
    "text": "research and I want to stress that out right now like the vulnerabilities that we will outline today for this software is",
    "start": "441600",
    "end": "448919"
  },
  {
    "text": "reload runner abilities the newer version of the software does not have this insecurities built in but still as",
    "start": "448919",
    "end": "456150"
  },
  {
    "text": "we will see the old version we use to come from I systems right so in this",
    "start": "456150",
    "end": "462240"
  },
  {
    "text": "research they expose design vulnerabilities in the agent insecurities and it also document and",
    "start": "462240",
    "end": "467910"
  },
  {
    "text": "the architecture of the LoJack solution and I want to show it to you because as",
    "start": "467910",
    "end": "473310"
  },
  {
    "text": "you will see later on the Senate operators actually make quite a bit the architecture will see right now so the",
    "start": "473310",
    "end": "479849"
  },
  {
    "text": "first step is of course the bias or the ufi module so it contains the agent in",
    "start": "479849",
    "end": "484889"
  },
  {
    "text": "its dropper and it will go ahead and replace a file called Auto Check the THC that is present on all Windows system",
    "start": "484889",
    "end": "492060"
  },
  {
    "text": "you might know what to check the techs he is it's basically an integrity check for our disk so as Windows is booting up",
    "start": "492060",
    "end": "498900"
  },
  {
    "text": "you will see sometimes a percentage on your boot up screen and this is this auto type it will check the integrity",
    "start": "498900",
    "end": "505050"
  },
  {
    "text": "but what LoJack is doing is that it will replace it so that it can actually install its own agent which is the",
    "start": "505050",
    "end": "511020"
  },
  {
    "text": "second step which is only the the main idea is to install the small agent as a",
    "start": "511020",
    "end": "516450"
  },
  {
    "text": "service once the service started in step 3 you have the small agent and the role",
    "start": "516450",
    "end": "522000"
  },
  {
    "text": "of the small agent is to make sure that the full recovery agent is always running on the system and how it does",
    "start": "522000",
    "end": "528750"
  },
  {
    "text": "this is that if it's not there it has the ability to connect to a distance server some code and then execute it so you can",
    "start": "528750",
    "end": "536090"
  },
  {
    "text": "see right away the vulnerability that could happen if someone could actually control how the agent is where the agent",
    "start": "536090",
    "end": "544310"
  },
  {
    "text": "is connecting itself to and how we'll do it is also very strange in terms of a",
    "start": "544310",
    "end": "550990"
  },
  {
    "text": "legitimate software because how you'll do it is that it will first pawn a services process then inject the DLL",
    "start": "550990",
    "end": "557330"
  },
  {
    "text": "inside then from there we'll spawn an Internet Explorer process inject the DLL",
    "start": "557330",
    "end": "562790"
  },
  {
    "text": "again and we'll use this as a point to reach out to its distant server which is",
    "start": "562790",
    "end": "569330"
  },
  {
    "text": "not something we see regularly in editing software in fact this is something we see all the time in malware right so this is kind of a strange",
    "start": "569330",
    "end": "576530"
  },
  {
    "text": "behavior for legitimate software and then the last step which is a fourth one is a normal operation the record the",
    "start": "576530",
    "end": "582410"
  },
  {
    "text": "recovery agent is running on the system and you have basically the mean - to",
    "start": "582410",
    "end": "588500"
  },
  {
    "text": "locate and recover and at the laptop so you might wonder how the small agent is actually trying or to reach out to the",
    "start": "588500",
    "end": "595640"
  },
  {
    "text": "server how can it know the distance server domain name or IP address well it has a configuration file embedded in its",
    "start": "595640",
    "end": "602930"
  },
  {
    "text": "code and this is the part of the small agent code that contains it and it's encrypted as you can see we cannot see",
    "start": "602930",
    "end": "608900"
  },
  {
    "text": "anything but the encryption is actually pretty bad in terms of security because",
    "start": "608900",
    "end": "614030"
  },
  {
    "text": "it's a single by just or key so it's very easy to decrypt it and you can see here the domain name which is search",
    "start": "614030",
    "end": "621710"
  },
  {
    "text": "name query comm which is legitimate absolute software domain name that is used to send and that the agent will",
    "start": "621710",
    "end": "628130"
  },
  {
    "text": "connect to and try to get will be able",
    "start": "628130",
    "end": "633740"
  },
  {
    "text": "to have commands such as the lock command that we've seen a bit earlier on and the four bytes preceding this domain",
    "start": "633740",
    "end": "639530"
  },
  {
    "text": "is actually an IP address so the bad thing about this one is that there's no integrity check so the file is not",
    "start": "639530",
    "end": "644720"
  },
  {
    "text": "signed so anyone that has access to your to your system and is able to override",
    "start": "644720",
    "end": "649910"
  },
  {
    "text": "this configuration file can actually make the small agent connect to a server of its choosing right and I'm only",
    "start": "649910",
    "end": "656240"
  },
  {
    "text": "showing this particular vulnerability to you because it's the only one that matters in our case because this is how the Senate operator actually did it so",
    "start": "656240",
    "end": "664360"
  },
  {
    "text": "although these vulnerabilities quite also we saw the research was in",
    "start": "664360",
    "end": "670160"
  },
  {
    "text": "2009 we didn't see widespread use of disparate ability in the wild until May",
    "start": "670160",
    "end": "675880"
  },
  {
    "text": "2018 where the cert team from our networks published this blog post which",
    "start": "675880",
    "end": "681649"
  },
  {
    "text": "was called a title LoJack becomes a double agent in this in this blog post what they found is that there were a lot",
    "start": "681649",
    "end": "688519"
  },
  {
    "text": "of small agent modifications in the wild where the attackers would change the",
    "start": "688519",
    "end": "694190"
  },
  {
    "text": "configuration file to point to a domain that they own an IP address and what was very interesting is that these domains",
    "start": "694190",
    "end": "700220"
  },
  {
    "text": "these IPS were already seen before in fact they were used by some Senate tools",
    "start": "700220",
    "end": "706160"
  },
  {
    "text": "so that's how that's what the first link was that this small agent might be related to to to Senate right so we we",
    "start": "706160",
    "end": "715550"
  },
  {
    "text": "saw this and we thought okay so what's the most likely hypothesis that this",
    "start": "715550",
    "end": "722060"
  },
  {
    "text": "small agent would come in a system and if we go back to the architecture slide of course sub-tree is a likely scenario",
    "start": "722060",
    "end": "728990"
  },
  {
    "text": "where we already know that Senate operators have a lot of backdoors order disposal so they could only use these",
    "start": "728990",
    "end": "735320"
  },
  {
    "text": "backdoors to just drop a small agent so of course you don't benefit from all the persistence mechanism that the or the",
    "start": "735320",
    "end": "741800"
  },
  {
    "text": "total solution of LoJack is giving you you don't have the ufi module but since",
    "start": "741800",
    "end": "747050"
  },
  {
    "text": "you're only changing a few bytes and small agent and that it is legitimate software you're still benefiting from",
    "start": "747050",
    "end": "752660"
  },
  {
    "text": "the fact that a lot of EDS are actually white listing this the small agent so it's it's like it's a likely scenario",
    "start": "752660",
    "end": "759050"
  },
  {
    "text": "that they would just rely on the small agent and that's it but at that time we just began our",
    "start": "759050",
    "end": "764839"
  },
  {
    "text": "telemetry and try to find out what exactly we could find and how big this",
    "start": "764839",
    "end": "770300"
  },
  {
    "text": "thing was right so this is a configuration file and that I showed you earlier and what we found is that all",
    "start": "770300",
    "end": "776630"
  },
  {
    "text": "these small agent that will link to the LoJack's campaign were based on the same",
    "start": "776630",
    "end": "782810"
  },
  {
    "text": "small agent so it was all small aged and compiled in 2008 and all they were doing was changing configuration file in a",
    "start": "782810",
    "end": "789980"
  },
  {
    "text": "couple of bytes ear and there but in in totality the vast majority of the changes was only in the configuration",
    "start": "789980",
    "end": "796100"
  },
  {
    "text": "file but it allowed us to retry and do a white spray and try to find who he was targeted and we found some",
    "start": "796100",
    "end": "803690"
  },
  {
    "text": "organizations that were targeted by this LoJack's campaign so they were mostly in the Balkans Central and Eastern European",
    "start": "803690",
    "end": "809570"
  },
  {
    "text": "victims and there were only a few organizations and I want to stress that out because we know let's send it is",
    "start": "809570",
    "end": "815420"
  },
  {
    "text": "targeting a lot of people a lot of organizations worldwide but what we found is that it's only a subset of",
    "start": "815420",
    "end": "822500"
  },
  {
    "text": "these targets that were actually targeted by the hello.tex campaign it was mostly military and diplomatic",
    "start": "822500",
    "end": "827680"
  },
  {
    "text": "organizations which is in line with the target that the Senate group usually targets and what's interesting is that",
    "start": "827680",
    "end": "835130"
  },
  {
    "text": "in all of these organizations we were also able to find traces of other Senate",
    "start": "835130",
    "end": "841100"
  },
  {
    "text": "tools which reinforces our thinking that this tool is really linked to send it so",
    "start": "841100",
    "end": "847780"
  },
  {
    "text": "we're now at the point where we're wondering okay like is it the end of it",
    "start": "847780",
    "end": "853580"
  },
  {
    "text": "is it only the small agent or we're actually going to find something better or something more deeper than that right",
    "start": "853580",
    "end": "860330"
  },
  {
    "text": "so before we dive in it was I want to show you an interesting blog post which was published in Virus Bulletin by",
    "start": "860330",
    "end": "866450"
  },
  {
    "text": "cousin ryu the director of great kaspersky where is saying that it's",
    "start": "866450",
    "end": "871820"
  },
  {
    "text": "wondering where all where are all the a is an apt and of course a main advanced",
    "start": "871820",
    "end": "876920"
  },
  {
    "text": "and what he says is that there are many cool research going on in the security",
    "start": "876920",
    "end": "882500"
  },
  {
    "text": "industry and that no nation state actor has actually used it and one of them is actually this one which says we have yet",
    "start": "882500",
    "end": "889250"
  },
  {
    "text": "to observe a real-world UEFI malware and what's funny because we were about to publish our report and this is",
    "start": "889250",
    "end": "895670"
  },
  {
    "text": "definitely something we knew that would probably be crossed out pretty soon so before we look at the different tools",
    "start": "895670",
    "end": "903020"
  },
  {
    "text": "that we found that led us to the ufi rootkit I just want to show you this tool so it's called readwrite everything",
    "start": "903020",
    "end": "909170"
  },
  {
    "text": "it's a tool that is available online that read write everything calm and it's basically a tool that allows you to read",
    "start": "909170",
    "end": "915470"
  },
  {
    "text": "and write the name is the pretty convenient it allows you to read and write a lot of information about your",
    "start": "915470",
    "end": "920930"
  },
  {
    "text": "hard work so you have access to platform configuration registers and it gives you",
    "start": "920930",
    "end": "925940"
  },
  {
    "text": "a whole lot of information about the the art where that is that your system is",
    "start": "925940",
    "end": "931100"
  },
  {
    "text": "using and how it does this well it needs a kernel driver right and of course when newer version",
    "start": "931100",
    "end": "936920"
  },
  {
    "text": "of Windows all required the kernel driver to be signed so this is the legitimate code sign certificate that is",
    "start": "936920",
    "end": "942920"
  },
  {
    "text": "used by the kernel driver and we found this specific driver in a lot of the",
    "start": "942920",
    "end": "950570"
  },
  {
    "text": "networks that we investigated in length with the LoJack's campaign and it's funny because it's not the first time",
    "start": "950570",
    "end": "956270"
  },
  {
    "text": "that this driver is reused for nefarious purposes but in in in our case it was really the first hint that they were",
    "start": "956270",
    "end": "962840"
  },
  {
    "text": "really maybe after the odd way sell the firmware so the first tool that I want",
    "start": "962840",
    "end": "968360"
  },
  {
    "text": "to show you is this one was called info EFI @hc and it's using the kernel driver and it was just dumping a lot of",
    "start": "968360",
    "end": "974840"
  },
  {
    "text": "information on a platform logging it in a log file here I'm only showing a small excerpt of it but the log file would be",
    "start": "974840",
    "end": "981920"
  },
  {
    "text": "very big compared to that and as you might know if you are trying to target",
    "start": "981920",
    "end": "988880"
  },
  {
    "text": "the system framework you need to have a lot of information of detail information on the platform itself so by running a",
    "start": "988880",
    "end": "995420"
  },
  {
    "text": "tool like this you get information on the manufacturer of the of the firm of the motherboard and it can allows you to",
    "start": "995420",
    "end": "1001930"
  },
  {
    "text": "see whether there are some known vulnerabilities and there are some miss configuration that can then reuse to",
    "start": "1001930",
    "end": "1007780"
  },
  {
    "text": "actually patch the firmware so if we go back to the architecture style so we already know that step 3",
    "start": "1007780",
    "end": "1013480"
  },
  {
    "text": "could have been where would it what these guys were doing just using a regular backdoor to install the small",
    "start": "1013480",
    "end": "1020050"
  },
  {
    "text": "agent but let's see what is the step before that it's actually this to check the THC so the the executable that is",
    "start": "1020050",
    "end": "1027790"
  },
  {
    "text": "responsible to check integrity and that was used by logic to replace my logic to",
    "start": "1027790",
    "end": "1033310"
  },
  {
    "text": "install the the small agent so we went in and tried to find something similar",
    "start": "1033310",
    "end": "1038410"
  },
  {
    "text": "something that would tell us that these guys might be after the the firmware itself and we found an interesting file",
    "start": "1038410",
    "end": "1044740"
  },
  {
    "text": "so instead of being caught to check the THC it was Auto cheap the THC so only",
    "start": "1044740",
    "end": "1050230"
  },
  {
    "text": "one letter change but the behavior of the executable was very similar so you can see here it's installing a service",
    "start": "1050230",
    "end": "1057220"
  },
  {
    "text": "with this name so this is the same name that the LoJack solution is using a service and we'll then point to the the",
    "start": "1057220",
    "end": "1066100"
  },
  {
    "text": "location of the executable of the small agent suitable so from there the behavior of",
    "start": "1066100",
    "end": "1071110"
  },
  {
    "text": "this touchy the THC and the LoJack replaced Auto check the ticks is very",
    "start": "1071110",
    "end": "1076299"
  },
  {
    "text": "similar but there was one difference that really caught our eyes which is which you can see here so it's building",
    "start": "1076299",
    "end": "1082419"
  },
  {
    "text": "a string and this string is actually the default value of this registry key so",
    "start": "1082419",
    "end": "1087730"
  },
  {
    "text": "the boot executes one that you see in the bottom and this is actually the registry key that all the path to the",
    "start": "1087730",
    "end": "1094000"
  },
  {
    "text": "auto check the THC so we didn't know what was the value before that but we know that this at Uchee the THC is",
    "start": "1094000",
    "end": "1100299"
  },
  {
    "text": "actually putting it back to its default value probably an attempt to I'd that it",
    "start": "1100299",
    "end": "1105400"
  },
  {
    "text": "was ever changed right so that was at that point we knew that they were at",
    "start": "1105400",
    "end": "1111309"
  },
  {
    "text": "least trying to get to the framework because you don't do all of this you don't go through all this trouble if you",
    "start": "1111309",
    "end": "1116950"
  },
  {
    "text": "did not have something in mind so we kept on digging and then we found the jackpot so this is a tool called every",
    "start": "1116950",
    "end": "1123910"
  },
  {
    "text": "writer read the THC and it's a tool that is used to dump the SPI flash memory and write it to this right it still uses the",
    "start": "1123910",
    "end": "1132299"
  },
  {
    "text": "readwrite everything driver and uses this for ioctl code to writes to write",
    "start": "1132299",
    "end": "1138370"
  },
  {
    "text": "in read memory mapped i/o and also to read and write a configuration configuration register so if the the",
    "start": "1138370",
    "end": "1145450"
  },
  {
    "text": "attacker will use this tool to dump the firmware of the machine so we of course",
    "start": "1145450",
    "end": "1150850"
  },
  {
    "text": "reverse engineer that there were a lot of debug strings actually so it kind of indicate that this tool was probably",
    "start": "1150850",
    "end": "1157480"
  },
  {
    "text": "under every development but it also helps us because as reverse engineers you have debug strings it makes your",
    "start": "1157480",
    "end": "1163450"
  },
  {
    "text": "life a lot easier so it consists of mainly three operations so it will first log the information of bias control",
    "start": "1163450",
    "end": "1170049"
  },
  {
    "text": "register and Fredrik will explain you why is doing this and why it's important for the attacker to have this",
    "start": "1170049",
    "end": "1175480"
  },
  {
    "text": "information then it will locate the bias region base address and will finally read the ufi for more content and dump",
    "start": "1175480",
    "end": "1183040"
  },
  {
    "text": "it to a file so it does not have the capability to actually upload the file to a malicious server but as senator",
    "start": "1183040",
    "end": "1190150"
  },
  {
    "text": "operators already have a lot of different backdoors at their disposal they could actually just pull the file out without the need for this tool to",
    "start": "1190150",
    "end": "1197770"
  },
  {
    "text": "actually being able to communicate with a C&C server and just want to show you really quickly how",
    "start": "1197770",
    "end": "1204160"
  },
  {
    "text": "it reads the year flash memory so this is very common this is how you basically interact with the SPI flash memory you",
    "start": "1204160",
    "end": "1211480"
  },
  {
    "text": "first just initiate the transaction you will say to the chip that you want to read it",
    "start": "1211480",
    "end": "1216640"
  },
  {
    "text": "how much byte you want to read it how much in the blog that you want to read and then you will just cycle through the",
    "start": "1216640",
    "end": "1222460"
  },
  {
    "text": "OL memory map region and be able to recover all the firmware on the on the",
    "start": "1222460",
    "end": "1228160"
  },
  {
    "text": "chip and then dump it to disk so this is how this tool was working so now lyric",
    "start": "1228160",
    "end": "1233410"
  },
  {
    "text": "will talk to you about the other tool we found okay so I'm the one of the tools",
    "start": "1233410",
    "end": "1240310"
  },
  {
    "text": "that we found on some compromised machine is called re writer binary and it is very similar to re write your read",
    "start": "1240310",
    "end": "1247420"
  },
  {
    "text": "as its name suggests so it also contains a lot of debug strings it also uses RW everything's driver and",
    "start": "1247420",
    "end": "1255280"
  },
  {
    "text": "it does basically two things the first thing it will do is that it will add the UEFI rootkit to the previously dumped",
    "start": "1255280",
    "end": "1262210"
  },
  {
    "text": "from work and it will write it back to the spi flash memory so let's look at",
    "start": "1262210",
    "end": "1270670"
  },
  {
    "text": "the patching of the UEFI firmware so before before we dig into this subject",
    "start": "1270670",
    "end": "1275800"
  },
  {
    "text": "there's just a couple things here doesn't want to introduce just just to make sure that we're on the same page the first thing I want to talk about is",
    "start": "1275800",
    "end": "1282640"
  },
  {
    "text": "UEFI so UEFI stands for unified extensible firmware interface and it is",
    "start": "1282640",
    "end": "1289540"
  },
  {
    "text": "a standardized specification that defines the software interface that exists between the operating system and",
    "start": "1289540",
    "end": "1297070"
  },
  {
    "text": "the firmware so a UEFI compliant system will provide a set of services to UEFI",
    "start": "1297070",
    "end": "1304240"
  },
  {
    "text": "applications here read operating system loader there could be some other UEFI",
    "start": "1304240",
    "end": "1309640"
  },
  {
    "text": "application but usually it is an operating system loader so one of these",
    "start": "1309640",
    "end": "1314740"
  },
  {
    "text": "services are the boot services so these services are available to the firmware but once the operating system is loaded",
    "start": "1314740",
    "end": "1321750"
  },
  {
    "text": "these services are not available anymore and there are the runtime services which",
    "start": "1321750",
    "end": "1326860"
  },
  {
    "text": "are some other type services that are also available to the firmware but when",
    "start": "1326860",
    "end": "1332260"
  },
  {
    "text": "the operating system is is running these services are still running so a kernel driver for instance can make calls into",
    "start": "1332260",
    "end": "1340149"
  },
  {
    "text": "these services and from a security standpoint what's interesting with UEFI is that there's no more Master Boot",
    "start": "1340149",
    "end": "1347350"
  },
  {
    "text": "Record or volume Boot Record involved so there's no easy way to hijack the the",
    "start": "1347350",
    "end": "1353950"
  },
  {
    "text": "boot control flow so okay the second thing I want to talk about are the",
    "start": "1353950",
    "end": "1360760"
  },
  {
    "text": "driver execution driver execution environment drivers so the so-called XE",
    "start": "1360760",
    "end": "1366039"
  },
  {
    "text": "drivers so the XE drivers are PE cough images so basically windows executables and there are kind of the core of UEFI",
    "start": "1366039",
    "end": "1374139"
  },
  {
    "text": "firmware so they can do many things some of them will be used if straggly hardware some of them will be used to",
    "start": "1374139",
    "end": "1379360"
  },
  {
    "text": "produce the UEFI standard interface so the boot services and the runtime services that I just spoke about and",
    "start": "1379360",
    "end": "1386100"
  },
  {
    "text": "they can also be used by firm or vendor to extend the firmware by adding by",
    "start": "1386100",
    "end": "1391419"
  },
  {
    "text": "registering new services the so-called protocols in the UEFI specification the",
    "start": "1391419",
    "end": "1397269"
  },
  {
    "text": "XE drivers are loaded during the Dixie phase of the platform initialization and",
    "start": "1397269",
    "end": "1402549"
  },
  {
    "text": "they are loaded by the exe dispatcher that will also refer to as the hexa core",
    "start": "1402549",
    "end": "1407860"
  },
  {
    "text": "in this presentation the last thing I want to introduce for now is the UEFI",
    "start": "1407860",
    "end": "1413559"
  },
  {
    "text": "firmware layout so the UEFI firmware is located in the bias region of DSP a flash memory and the bias region",
    "start": "1413559",
    "end": "1421000"
  },
  {
    "text": "contains multiple volumes let's look at it in a bit more detail in UEFI - which",
    "start": "1421000",
    "end": "1427240"
  },
  {
    "text": "is an open source tool for manipulating UEFI images so here I loaded the typical",
    "start": "1427240",
    "end": "1433809"
  },
  {
    "text": "content of a spi flash memory dump and UEFI - and yeah let's look at what we",
    "start": "1433809",
    "end": "1439419"
  },
  {
    "text": "have so the first thing that we see here is the descriptor region which contains metadata about the remaining of the data",
    "start": "1439419",
    "end": "1445360"
  },
  {
    "text": "and the SPI flash memory then we have the ME region which contains the Intel",
    "start": "1445360",
    "end": "1451659"
  },
  {
    "text": "management and join firmware and finally we have the bias region which is really what we're interested in today as I",
    "start": "1451659",
    "end": "1459070"
  },
  {
    "text": "mentioned the bias region contains multiple volumes so let's look at one volume in a little bit more details so",
    "start": "1459070",
    "end": "1465669"
  },
  {
    "text": "here we have a volume which is of type firmware file system v2 and so this volume",
    "start": "1465669",
    "end": "1473200"
  },
  {
    "text": "contains multiple multiple files these files are identified by by googas that's",
    "start": "1473200",
    "end": "1479230"
  },
  {
    "text": "what we can see under the name column and with if we look at what's inside the file well in a file there are multiple",
    "start": "1479230",
    "end": "1486970"
  },
  {
    "text": "sections one of these section will be the actual UEFI executable image but",
    "start": "1486970",
    "end": "1493090"
  },
  {
    "text": "there are other sections like the Dixie dependency section which allows to define dependencies for this specific",
    "start": "1493090",
    "end": "1499210"
  },
  {
    "text": "UEFI executable and we also see here a version section as well as a user",
    "start": "1499210",
    "end": "1504879"
  },
  {
    "text": "interface section so the user interface section is used to give a human readable name for for the file instead of the the",
    "start": "1504879",
    "end": "1511000"
  },
  {
    "text": "gooood and that's what we can see under the text column here ok so now now that",
    "start": "1511000",
    "end": "1517659"
  },
  {
    "text": "we have all this in mind let's go back to re-write your binary and look at at",
    "start": "1517659",
    "end": "1523389"
  },
  {
    "text": "what it does so re-read your binary will parse all of the firmware volumes that it that it finds in the bias region of",
    "start": "1523389",
    "end": "1530710"
  },
  {
    "text": "the UEFI firmware and it will look for for specific files it looks for IP for",
    "start": "1530710",
    "end": "1536409"
  },
  {
    "text": "Dexy NTFS dec c SMI flash and the hexa core so why does it look for IP foredeck",
    "start": "1536409",
    "end": "1544240"
  },
  {
    "text": "C and D DX e core well these files are used to define the firmware volume where",
    "start": "1544240",
    "end": "1550419"
  },
  {
    "text": "to install the UEFI rootkit so usually in a you fi firmware all of the taxi",
    "start": "1550419",
    "end": "1556120"
  },
  {
    "text": "drivers will be in the same firmware volume so when the tool finds IP Ford XE",
    "start": "1556120",
    "end": "1562120"
  },
  {
    "text": "it knows that it is currently parsing the volume will the Dixie drivers on it so it will keep the this volume as a",
    "start": "1562120",
    "end": "1569169"
  },
  {
    "text": "candidate for the UEFI will get installation and in some UEFI firmware the DEXA core maybe in a different",
    "start": "1569169",
    "end": "1576279"
  },
  {
    "text": "volume than the taxi drivers so when it finds the Dixie chord will also keep the",
    "start": "1576279",
    "end": "1581710"
  },
  {
    "text": "volume where it is located as a candidate for the you if I root kit installation and finally it will choose",
    "start": "1581710",
    "end": "1588429"
  },
  {
    "text": "the volume where there is enough free space available in it so NTFS sexy NTFS",
    "start": "1588429",
    "end": "1596620"
  },
  {
    "text": "lexi is the American Megatron incorporated in TFS driver and the reason why it looks for it is",
    "start": "1596620",
    "end": "1602740"
  },
  {
    "text": "as we'll see later during this talk the UEFI rootkit comes with its own ntfs",
    "start": "1602740",
    "end": "1608620"
  },
  {
    "text": "driver so to avoid any conflict it just removes the American megatrend ntfs",
    "start": "1608620",
    "end": "1613779"
  },
  {
    "text": "driver and finally SMI flash so the tool",
    "start": "1613779",
    "end": "1619720"
  },
  {
    "text": "the version of the tool that we analyzed looks for this specific driver it keeps",
    "start": "1619720",
    "end": "1625720"
  },
  {
    "text": "some metadata in a structure about it but it never uses uses it in in the tool",
    "start": "1625720",
    "end": "1631720"
  },
  {
    "text": "so what we believe is that signal spreader might have been fiddling with some kind of exploit for this well what",
    "start": "1631720",
    "end": "1638950"
  },
  {
    "text": "I forget to mention is that this exe driver is actually vulnerable so yeah",
    "start": "1638950",
    "end": "1645490"
  },
  {
    "text": "what we believe is that settings' operator might have been fiddling with some exploit for this vulnerable Dexy driver in order to be able to bypass",
    "start": "1645490",
    "end": "1652149"
  },
  {
    "text": "write protection mechanism to the spi flash memory so now that it has found",
    "start": "1652149",
    "end": "1658600"
  },
  {
    "text": "the volume were to install the rootkit the next thing is to add the rootkit to the to the volume so what I will do is",
    "start": "1658600",
    "end": "1665860"
  },
  {
    "text": "that it will create a firmware file system file header and then it will happen the rootkit file to it so the",
    "start": "1665860",
    "end": "1673059"
  },
  {
    "text": "rootkit file is a compressed section that contains two sections one of these sections is the actual UEFI be the",
    "start": "1673059",
    "end": "1679480"
  },
  {
    "text": "curable and the other one is a user interface section defining the name for this root case of the rootkit is called",
    "start": "1679480",
    "end": "1685390"
  },
  {
    "text": "SEC exe and then it will write this file at the end of the selected volume ok so",
    "start": "1685390",
    "end": "1696210"
  },
  {
    "text": "now that the UEFI rootkit is inside of the UEFI firmware the next step is to",
    "start": "1696210",
    "end": "1702190"
  },
  {
    "text": "write it back to the SPI flash memory once again there's there are a couple",
    "start": "1702190",
    "end": "1707230"
  },
  {
    "text": "things that I want to introduce here so I want to talk about bias write",
    "start": "1707230",
    "end": "1712630"
  },
  {
    "text": "protection mechanisms so the platform read here the chipset exposed is write",
    "start": "1712630",
    "end": "1718720"
  },
  {
    "text": "protection mechanisms that need to be properly configured by the firmware so there are no such thing as write",
    "start": "1718720",
    "end": "1725470"
  },
  {
    "text": "protection mechanism enable by default it's really the the firmware job to configure them today will only cover",
    "start": "1725470",
    "end": "1733870"
  },
  {
    "text": "relevant protection mechanisms to our search so we'll only cover the prediction mechanism that are checked",
    "start": "1733870",
    "end": "1739750"
  },
  {
    "text": "for by re re writer binary when the the",
    "start": "1739750",
    "end": "1745809"
  },
  {
    "text": "production mechanism we'll talk about are exposed via D bias control register",
    "start": "1745809",
    "end": "1751830"
  },
  {
    "text": "so if you want to write to the bias region of the SPI flash memory the first thing that you need to do is to set the",
    "start": "1751830",
    "end": "1759039"
  },
  {
    "text": "bias right enable field of the bias control register to one and then you can write to the B to the T bias right I'm",
    "start": "1759039",
    "end": "1767919"
  },
  {
    "text": "sorry to the bias region without any problem but of course you don't want any kernel driver to be able to mess with",
    "start": "1767919",
    "end": "1774700"
  },
  {
    "text": "the content of the spi flash and potentially corrupt it so there's a protection mechanism here which is",
    "start": "1774700",
    "end": "1780279"
  },
  {
    "text": "another field in the bias control register and this field is called bias lock enable and it allows to lock bias",
    "start": "1780279",
    "end": "1788740"
  },
  {
    "text": "right enable to zero and this field is readable and right locked once right",
    "start": "1788740",
    "end": "1794740"
  },
  {
    "text": "lock once means that once the firmware has set this this bit to one there are no other way to set it back to zero than",
    "start": "1794740",
    "end": "1801220"
  },
  {
    "text": "performing a full platform I reset but there's a problem here the problem is",
    "start": "1801220",
    "end": "1806590"
  },
  {
    "text": "that the implementation of bias lock enable is actually vulnerable so how it",
    "start": "1806590",
    "end": "1812649"
  },
  {
    "text": "works is if if ble is activated and a",
    "start": "1812649",
    "end": "1817720"
  },
  {
    "text": "kernel driver tries to set bias right enable to one bias right enable will be",
    "start": "1817720",
    "end": "1824200"
  },
  {
    "text": "set to one for shorter short amount of time and then the platform will issue a",
    "start": "1824200",
    "end": "1829629"
  },
  {
    "text": "system management interrupt and the SMI handler will set by us right enabled",
    "start": "1829629",
    "end": "1834879"
  },
  {
    "text": "back to zero let's not hear that the SMI handler must be implemented by the",
    "start": "1834879",
    "end": "1839980"
  },
  {
    "text": "firmware otherwise this mechanism is worthless but that's not the biggest issue here but maybe you've guessed it",
    "start": "1839980",
    "end": "1846909"
  },
  {
    "text": "but what happens if we write to the spi flash memory before the SMI handler sets",
    "start": "1846909",
    "end": "1852279"
  },
  {
    "text": "by us right enable to zero so there's a race condition vulnerability here there's a paper about it which is called",
    "start": "1852279",
    "end": "1858940"
  },
  {
    "text": "a speed racer and it is trivial to exploit how you do it is you have one thread that continuously set by us right",
    "start": "1858940",
    "end": "1865779"
  },
  {
    "text": "enable to one while another thread tries to read the data to the SP a flash memory and according to due",
    "start": "1865779",
    "end": "1872230"
  },
  {
    "text": "to the Speed Racer vapor it works on multi-core processors as well as on",
    "start": "1872230",
    "end": "1877560"
  },
  {
    "text": "single core processors with hyper-threading enabled so Intel came up",
    "start": "1877560",
    "end": "1883210"
  },
  {
    "text": "with a fix for for this vulnerability and what they did is that they added a field in the bias control register and",
    "start": "1883210",
    "end": "1891430"
  },
  {
    "text": "it was introducing the platform controller hub family of Intel chipsets around 2008 so this field is called SMM",
    "start": "1891430",
    "end": "1899050"
  },
  {
    "text": "bias write-protect disabled the name is a bit misleading but if you remove disable that's actually what it does so",
    "start": "1899050",
    "end": "1907120"
  },
  {
    "text": "how it works is if this mechanism is activated it won't be possible to write",
    "start": "1907120",
    "end": "1912910"
  },
  {
    "text": "to develop to the bias region unless all of the cores of the processor are running in system management mode and",
    "start": "1912910",
    "end": "1920040"
  },
  {
    "text": "once again this this bit must be set by by the firmware okay so now let's go",
    "start": "1920040",
    "end": "1928390"
  },
  {
    "text": "back to our ear ITER binary so of course if I introduce all of these mechanisms it's because re writer binary checks for",
    "start": "1928390",
    "end": "1934780"
  },
  {
    "text": "them so it will check if the platform is properly configured and it implements",
    "start": "1934780",
    "end": "1940060"
  },
  {
    "text": "the exploit for for the race condition ok let's look at the writing process",
    "start": "1940060",
    "end": "1946900"
  },
  {
    "text": "decision tree so the first thing that our a writer will I write or binary will",
    "start": "1946900",
    "end": "1952450"
  },
  {
    "text": "little check for is biased right enable so it will check if it is activated and",
    "start": "1952450",
    "end": "1957820"
  },
  {
    "text": "if it is activated there's nothing nothing stopping it from writing to writing to the SPI flash memory so it",
    "start": "1957820",
    "end": "1964150"
  },
  {
    "text": "will just write the Trojan Eyes UEFI image but if it is not set to one then",
    "start": "1964150",
    "end": "1971380"
  },
  {
    "text": "it will check is bias lock enable activated and if it is not activated then it will just flip by us write",
    "start": "1971380",
    "end": "1977080"
  },
  {
    "text": "enable to 1 and then it will write the UEFI image and finally it will also",
    "start": "1977080",
    "end": "1983950"
  },
  {
    "text": "check for SMM bias right product and if it is not set it will exploit the race",
    "start": "1983950",
    "end": "1989830"
  },
  {
    "text": "condition that we just spoke about otherwise it will just fail so we spoke",
    "start": "1989830",
    "end": "1995320"
  },
  {
    "text": "about the SMI flash the vulnerable exe driver so yeah",
    "start": "1995320",
    "end": "2003110"
  },
  {
    "text": "we believe that sudden it's operator might have been fiddling with an exploit for for this specific driver to be able",
    "start": "2003110",
    "end": "2008900"
  },
  {
    "text": "here not to fail if everything is properly configured but to be able to write to the SPI flash memory even if",
    "start": "2008900",
    "end": "2014990"
  },
  {
    "text": "you know everything is the firmware does the job correctly so this tool only",
    "start": "2014990",
    "end": "2020960"
  },
  {
    "text": "works on either fairly old system or misconfigured system so as you can see",
    "start": "2020960",
    "end": "2027860"
  },
  {
    "text": "here if firm or vendors would have done their job correctly the tool would have fail at flashing the malicious Mouse",
    "start": "2027860",
    "end": "2035570"
  },
  {
    "text": "just firmware and it would have required way more resources from the attackers side to be able to deploy their and",
    "start": "2035570",
    "end": "2042770"
  },
  {
    "text": "their rootkit okay so now let's look very quickly at how you write to the SPI",
    "start": "2042770",
    "end": "2050300"
  },
  {
    "text": "flash memory it's kind of the standard way of doing this so the first thing that you need to do is to set up the",
    "start": "2050300",
    "end": "2057770"
  },
  {
    "text": "right operation and then you can write all you just loop around these operation",
    "start": "2057770",
    "end": "2063830"
  },
  {
    "text": "and write each data block one after the other to the SPI flash until you you",
    "start": "2063830",
    "end": "2069350"
  },
  {
    "text": "have your whole firmware flashing to the SPI flash memory so here let's take a",
    "start": "2069350",
    "end": "2076340"
  },
  {
    "text": "step back and look at what we're looking at so what we have here is a software",
    "start": "2076340",
    "end": "2081710"
  },
  {
    "text": "implementation to deploy UEFI rootkit and flash it in to the spi flash memory",
    "start": "2081710",
    "end": "2088460"
  },
  {
    "text": "remotely post exploitation so that's really something it's very convenient",
    "start": "2088460",
    "end": "2094368"
  },
  {
    "text": "for for for the attackers to use that kind of that kind of tool so they can",
    "start": "2094369",
    "end": "2099500"
  },
  {
    "text": "just begin to infect the victim the way they will usually do it for instance by sending a phishing email and once they",
    "start": "2099500",
    "end": "2105770"
  },
  {
    "text": "have a foothold on the machine they can use this tool to deploy their the rootkit what do we knew about in the past was",
    "start": "2105770",
    "end": "2112880"
  },
  {
    "text": "hacking teams UEFI rootkit and as far as we know it required physical access to",
    "start": "2112880",
    "end": "2118609"
  },
  {
    "text": "be deployed so once again it's so much more convenient to be able to do it remotely it's not here that there's no",
    "start": "2118609",
    "end": "2127280"
  },
  {
    "text": "proof of hacking teams rootkit being used in a cyberattack it has never been found on a victim's machine or at least",
    "start": "2127280",
    "end": "2135109"
  },
  {
    "text": "it if it has it been publicly disclosed so what we did then is that we extracted the UEFI",
    "start": "2135109",
    "end": "2142240"
  },
  {
    "text": "rootkit from re writer binary and we looked at ESET UEFI scanner telemetry",
    "start": "2142240",
    "end": "2148270"
  },
  {
    "text": "and yeah turns out that we found the rootkit in the SPI flash memory of a of",
    "start": "2148270",
    "end": "2154030"
  },
  {
    "text": "a system making it the first publicly known UEFI rootkit to be used in a cyberattack and at this point yeah we're",
    "start": "2154030",
    "end": "2161200"
  },
  {
    "text": "pretty confident that would be accepted the blackhat to share our research with",
    "start": "2161200",
    "end": "2166359"
  },
  {
    "text": "you guys so yeah here we are right so if we go back to customs Ray",
    "start": "2166359",
    "end": "2174930"
  },
  {
    "text": "statement where he said that we have yet to observe real-world UEFI malware well",
    "start": "2174930",
    "end": "2181390"
  },
  {
    "text": "we can cross that one out okay so let's go back to the technical part",
    "start": "2181390",
    "end": "2186880"
  },
  {
    "text": "of this presentation and look at the UEFI rootkit itself so the if I rootkit",
    "start": "2186880",
    "end": "2193780"
  },
  {
    "text": "is a taxi driver that is loaded by the DEXA dispatcher every time the machine",
    "start": "2193780",
    "end": "2198940"
  },
  {
    "text": "will boot it's finally means sec dixie as we've already seen and here i put the",
    "start": "2198940",
    "end": "2204549"
  },
  {
    "text": "file good for future reference so now let's look at the UEFI rootkit workflow",
    "start": "2204549",
    "end": "2211200"
  },
  {
    "text": "so a EFI firmware will go through multiple phases when it boots so the first phase it will go to is the",
    "start": "2211200",
    "end": "2217420"
  },
  {
    "text": "security phase and then we'll go through the pre fi initialization phase and then it will go through the driver execution",
    "start": "2217420",
    "end": "2224140"
  },
  {
    "text": "environment phase and that's when that's when it it gets interesting for us so",
    "start": "2224140",
    "end": "2230950"
  },
  {
    "text": "that's that's when the DEXA core is running and all of the exe drivers will be loaded so one of these the XE drivers",
    "start": "2230950",
    "end": "2237970"
  },
  {
    "text": "will be the UEFI rootkit and what it will do at this point is that it will create an event attached to the efi even",
    "start": "2237970",
    "end": "2245289"
  },
  {
    "text": "group ready to boot and it will bind a notify function which is basically a callback containing the malicious code",
    "start": "2245289",
    "end": "2253079"
  },
  {
    "text": "so when the firmware will go to the next phase the boot device selection phase",
    "start": "2253079",
    "end": "2258640"
  },
  {
    "text": "the boot manager will run and at some point it will signal the efi even group",
    "start": "2258640",
    "end": "2263710"
  },
  {
    "text": "ready to boot event and at this point the notify function will be called",
    "start": "2263710",
    "end": "2270040"
  },
  {
    "text": "so none of the Phi function does three things the first thing it will do is that it will install in an NTFS driver",
    "start": "2270040",
    "end": "2277520"
  },
  {
    "text": "then it will use this ntfs driver to drop out to cheated Xin our PC net period eggsy and finally it will patch a",
    "start": "2277520",
    "end": "2284210"
  },
  {
    "text": "value in the Windows registry for persistent purposes so the ntfs driver",
    "start": "2284210",
    "end": "2291260"
  },
  {
    "text": "well the ntfs driver is is needed to get file based access to Windows partition",
    "start": "2291260",
    "end": "2296630"
  },
  {
    "text": "and said net separator did not write their own ntfs driver what did it is",
    "start": "2296630",
    "end": "2302450"
  },
  {
    "text": "that they took hacking teams ntfs driver from hacking teams leak and they compile",
    "start": "2302450",
    "end": "2307790"
  },
  {
    "text": "their own version that they bundle with the UEFI boot kit now here's the code",
    "start": "2307790",
    "end": "2314690"
  },
  {
    "text": "responsible for dropping the two files so here we have the code dropping our PC",
    "start": "2314690",
    "end": "2320150"
  },
  {
    "text": "net Peter digsy and here the code wrapping up to chi that exit and finally",
    "start": "2320150",
    "end": "2327050"
  },
  {
    "text": "it will patch if a value in the Windows registry so how it does that is that it",
    "start": "2327050",
    "end": "2332300"
  },
  {
    "text": "will open the file backing the htlm system registry hive and it doesn't have",
    "start": "2332300",
    "end": "2338330"
  },
  {
    "text": "all the logic to to be able to parse windows to do structures so what it does",
    "start": "2338330",
    "end": "2343370"
  },
  {
    "text": "is that it will look for a text I textual pattern and this textual pattern is AutoCheck a to check and star and",
    "start": "2343370",
    "end": "2350030"
  },
  {
    "text": "when it finds it it will change it for us to check out to chi start and it happens to be to be modifying the boot",
    "start": "2350030",
    "end": "2356450"
  },
  {
    "text": "execute key that Ryan spoke about earlier so what will happen then is that",
    "start": "2356450",
    "end": "2363430"
  },
  {
    "text": "the operating system will will be loaded and at some point it will run a to",
    "start": "2363430",
    "end": "2369080"
  },
  {
    "text": "chittering Z instead of to check that exit a note achieve will drop our vicinity and so on but what's",
    "start": "2369080",
    "end": "2377270"
  },
  {
    "text": "interesting here is that o to cheery vert back the modification in the Windows registry so it will change o to",
    "start": "2377270",
    "end": "2384020"
  },
  {
    "text": "chip back to auto check so that as a end user for instance if I look in in the",
    "start": "2384020",
    "end": "2391130"
  },
  {
    "text": "registry Keys I won't see that any modification happen so that's a pretty",
    "start": "2391130",
    "end": "2396560"
  },
  {
    "text": "interesting stealth mechanism that is that is enabled by the fact that the",
    "start": "2396560",
    "end": "2401780"
  },
  {
    "text": "malware is coming from the firmware ok so now we have a little demo for you just get there it's",
    "start": "2401780",
    "end": "2415749"
  },
  {
    "text": "not a live demo sorry",
    "start": "2415749",
    "end": "2418949"
  },
  {
    "text": "I'll make it",
    "start": "2427900",
    "end": "2431349"
  },
  {
    "text": "there it is okay let's really really",
    "start": "2445430",
    "end": "2452010"
  },
  {
    "text": "used to work with your trackpad I'll",
    "start": "2452010",
    "end": "2458700"
  },
  {
    "text": "just restart it real quick okay so here",
    "start": "2458700",
    "end": "2469170"
  },
  {
    "text": "we have a Windows 10 machine this machine is is clean and it has a clean",
    "start": "2469170",
    "end": "2474660"
  },
  {
    "text": "firmware so the first thing I'll show here is just that Oh to cheat that eggs and RPC not PR not on the file system",
    "start": "2474660",
    "end": "2481380"
  },
  {
    "text": "just to prove that it is clean so it's going to sis 1264 and looking for our PC",
    "start": "2481380",
    "end": "2489750"
  },
  {
    "text": "net P and as we can hopefully see our PC net P is not it's not there then I'm",
    "start": "2489750",
    "end": "2497430"
  },
  {
    "text": "going into system 32 showing that to cheetah diggsy is not there either",
    "start": "2497430",
    "end": "2505430"
  },
  {
    "text": "okay so the next step then I'll I'll go into VMware directory to where the UEFI",
    "start": "2505579",
    "end": "2514200"
  },
  {
    "text": "firmware is located and I'll change the firmware the clean firmware for and",
    "start": "2514200",
    "end": "2519900"
  },
  {
    "text": "infected for more with the UEFI rootkit so just to show that I'll I'm opening it",
    "start": "2519900",
    "end": "2527190"
  },
  {
    "text": "in UEFI tool and I'm just showing that second xcd UEFI rootkit is really in the",
    "start": "2527190",
    "end": "2533359"
  },
  {
    "text": "UEFI firmware as we can see it is right here and then I'll yeah I'll change the",
    "start": "2533359",
    "end": "2544109"
  },
  {
    "text": "firmware so this one is the clean firmware so I'll just rename it and I'll put the infected for more instead of it",
    "start": "2544109",
    "end": "2553578"
  },
  {
    "text": "okay so now I'll just shut down the Windows 10 machine and start it all over again just",
    "start": "2558020",
    "end": "2565250"
  },
  {
    "text": "so and so that the machine will boot and the UEFI boot kit will be loaded and it will do all these and nasty things okay",
    "start": "2565250",
    "end": "2573500"
  },
  {
    "text": "but here there's another machine which is a Linux machine which is on the same network and it act as a gateway for the",
    "start": "2573500",
    "end": "2580460"
  },
  {
    "text": "windows 10 machine and also as a DNS server and it also has an HTTP server on",
    "start": "2580460",
    "end": "2587180"
  },
  {
    "text": "it so I'll go Andy in the Linux machine",
    "start": "2587180",
    "end": "2593330"
  },
  {
    "text": "and I'll start a network capture there",
    "start": "2593330",
    "end": "2598210"
  },
  {
    "text": "and then I'll just keep it a bit so when",
    "start": "2599080",
    "end": "2606020"
  },
  {
    "text": "Windows will be boarded booted we'll see that it will make the malware will make",
    "start": "2606020",
    "end": "2611540"
  },
  {
    "text": "a query to its commanding control server",
    "start": "2611540",
    "end": "2617080"
  },
  {
    "text": "should happen soon okay so yeah there",
    "start": "2620380",
    "end": "2625670"
  },
  {
    "text": "was a DNS request was performed for remote PF net which is a command control",
    "start": "2625670",
    "end": "2631670"
  },
  {
    "text": "server and there was also an HTTP POST requests with the wholesaler set to",
    "start": "2631670",
    "end": "2638540"
  },
  {
    "text": "remote PX dotnet so just to show that everything happen as expected I'll go",
    "start": "2638540",
    "end": "2645619"
  },
  {
    "text": "back in the Windows 10 machine and show that the files were properly dropped and",
    "start": "2645619",
    "end": "2651290"
  },
  {
    "text": "that there's also a process running there so I'm going to see Windows 6 12",
    "start": "2651290",
    "end": "2661490"
  },
  {
    "text": "64 so I'm looking for RPC net P here so",
    "start": "2661490",
    "end": "2667220"
  },
  {
    "text": "as we can see our PC net P is there there's a dealer and in executable the reason for that is that the executable",
    "start": "2667220",
    "end": "2674210"
  },
  {
    "text": "once it's runs it drops itself ID as a DLL so that's why there's another file there and then yeah as we can see how to",
    "start": "2674210",
    "end": "2681590"
  },
  {
    "text": "cheap is is there too alongside so to check and finally I'll",
    "start": "2681590",
    "end": "2687350"
  },
  {
    "text": "go in this task manager just to show that there's a process running there",
    "start": "2687350",
    "end": "2693400"
  },
  {
    "text": "and yeah as we can see there's our PC net thief running there so yeah that's",
    "start": "2695680",
    "end": "2701420"
  },
  {
    "text": "pretty much it for the for the demo",
    "start": "2701420",
    "end": "2705670"
  },
  {
    "text": "okay so the last thing that I want to talk about today is prevention",
    "start": "2718720",
    "end": "2726010"
  },
  {
    "text": "remediation so what can you do to prevent such an ad and attack from from",
    "start": "2726010",
    "end": "2731480"
  },
  {
    "text": "happening and also if you find out that you're compromised with a you if I would kit what can you do right okay so prevention",
    "start": "2731480",
    "end": "2740720"
  },
  {
    "text": "the first thing in probably the most important thing is that you should really keep your UEFI for more up to",
    "start": "2740720",
    "end": "2748070"
  },
  {
    "text": "date so that all of the latest patches are available on your system yeah so",
    "start": "2748070",
    "end": "2755030"
  },
  {
    "text": "that's probably the most accessible and most important thing to do then you",
    "start": "2755030",
    "end": "2761240"
  },
  {
    "text": "should enable secure boot but let's not hear that secure boot would not have protected against this specific attack",
    "start": "2761240",
    "end": "2767330"
  },
  {
    "text": "and the reason for that is that secure boot takes the content of the SPI flash memory as its root of trust so",
    "start": "2767330",
    "end": "2774110"
  },
  {
    "text": "everything that is inside the SPI flash memory is not subject for for validation",
    "start": "2774110",
    "end": "2780020"
  },
  {
    "text": "so what is it you're used for then well it will validate what's coming from outside of the SPI flash memory namely",
    "start": "2780020",
    "end": "2786200"
  },
  {
    "text": "the option roms and most importantly the operating system loader so what can we",
    "start": "2786200",
    "end": "2791690"
  },
  {
    "text": "do then well what we need is a hardware root of trust so we need a root of trust that is in a one-time programmable chip",
    "start": "2791690",
    "end": "2800290"
  },
  {
    "text": "that is programmed during manufacturing time and that cannot be written to ever",
    "start": "2800290",
    "end": "2806590"
  },
  {
    "text": "after and such technologies exist an example of that would be Intel boot",
    "start": "2806590",
    "end": "2811790"
  },
  {
    "text": "guard but also Apple's t2 security chip has a or hardware root of trust then you",
    "start": "2811790",
    "end": "2821510"
  },
  {
    "text": "kind of need to hope that your firmware configures your the security mechanism properly there's not much you can do",
    "start": "2821510",
    "end": "2827950"
  },
  {
    "text": "well if you updated your UEFI firmware there's not much you can do but",
    "start": "2827950",
    "end": "2836680"
  },
  {
    "text": "thankfully there are for more security assessment tools available out there and",
    "start": "2836680",
    "end": "2841910"
  },
  {
    "text": "an example of that would be Intel chipset so you can put this tool on on a",
    "start": "2841910",
    "end": "2848180"
  },
  {
    "text": "USB stick and run it on your machine and this tool will check for all of the security mechanism that we spoke about",
    "start": "2848180",
    "end": "2854839"
  },
  {
    "text": "today in even more of them and also it will check for the this specific UEFI",
    "start": "2854839",
    "end": "2861349"
  },
  {
    "text": "rootkit so if you have it and solve until chip sack will we'll find it",
    "start": "2861349",
    "end": "2867818"
  },
  {
    "text": "and yeah the last thing that I want to talk about is remediation it's a pretty",
    "start": "2868269",
    "end": "2875869"
  },
  {
    "text": "short part the only thing you can do is really reflash your UEFI firmwares we",
    "start": "2875869",
    "end": "2882619"
  },
  {
    "text": "kind of need an SPI programmer and to be able to you know you need to have a clean version of the firmware and write",
    "start": "2882619",
    "end": "2890149"
  },
  {
    "text": "it to the SPI flash memory yourself it's definitely not something that is easy to do for anybody but yeah that is pretty",
    "start": "2890149",
    "end": "2899630"
  },
  {
    "text": "much with with you you can do otherwise it's not an option for you well you can",
    "start": "2899630",
    "end": "2905329"
  },
  {
    "text": "just get rid of your I have computer basically and get a new one so that's how serious this this attack",
    "start": "2905329",
    "end": "2913819"
  },
  {
    "text": "is now in conclusion our research shows",
    "start": "2913819",
    "end": "2921709"
  },
  {
    "text": "that UEFI rootkit are not toys for researchers to play with that they are real-world threats use in actual cyber",
    "start": "2921709",
    "end": "2929449"
  },
  {
    "text": "attacks so it might be something that you want to keep in mind the next time you'll be finding your threat model and",
    "start": "2929449",
    "end": "2936609"
  },
  {
    "text": "yeah we won't stress this enough a firmware must be built with security in mind from the bottom up and things are",
    "start": "2936609",
    "end": "2943789"
  },
  {
    "text": "getting better because there are more and more security researchers looking into this and reporting the issues that they find but there are still still work",
    "start": "2943789",
    "end": "2951709"
  },
  {
    "text": "to do there and yeah also hopefully this talk helps you to know how to prevent",
    "start": "2951709",
    "end": "2958459"
  },
  {
    "text": "and mitigate this kind this kind of attack so that's pretty much it for us",
    "start": "2958459",
    "end": "2965209"
  },
  {
    "text": "so thank you for having us last thing I want to mention is that if you're interested to know more to have more",
    "start": "2965209",
    "end": "2971119"
  },
  {
    "text": "details about our research the white paper is available at we live security that come and unfortunately we won't",
    "start": "2971119",
    "end": "2979789"
  },
  {
    "text": "have time for question here but it's still early in the conference so we'll be",
    "start": "2979789",
    "end": "2984980"
  },
  {
    "text": "for the next two days so only shy just come come see us and ask a question if",
    "start": "2984980",
    "end": "2991040"
  },
  {
    "text": "you have any so thank you very much [Applause]",
    "start": "2991040",
    "end": "2998199"
  }
]