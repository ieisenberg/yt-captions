[
  {
    "text": "good morning everybody uh my name is Kyle Wilho i am a threat researcher at Trend Micro and today I'm going to cover",
    "start": "160",
    "end": "6960"
  },
  {
    "text": "who's really attacking your ICS devices this talk isn't going to cover um",
    "start": "6960",
    "end": "12559"
  },
  {
    "text": "vulnerabilities really um or any new exploits or OAS or anything like that with ICS systems what this talk is going",
    "start": "12559",
    "end": "19520"
  },
  {
    "text": "to cover um is first uh kind of an overview of IC itself and then I'm going",
    "start": "19520",
    "end": "25920"
  },
  {
    "text": "to get into a story about a couple different attacks that occurred in IC environments for those of you that",
    "start": "25920",
    "end": "31760"
  },
  {
    "text": "aren't familiar with IC or SCADA this talk can still be directly applicable to you guys so don't worry um if you don't",
    "start": "31760",
    "end": "38719"
  },
  {
    "text": "really have any familiarity with SCADA IC anything like that this should still be directly applicable and still be",
    "start": "38719",
    "end": "44480"
  },
  {
    "text": "interesting for those uh for those of you that aren't familiar before we get started I'm going to go ahead and go into a little bit about who I am um",
    "start": "44480",
    "end": "50960"
  },
  {
    "text": "again I'm a threat researcher at Trend Micro um primarily I research and blog on the criminal underground persistent",
    "start": "50960",
    "end": "57440"
  },
  {
    "text": "threats um malware based espionage those sorts of things um bachelor's and masters in computer science um currently",
    "start": "57440",
    "end": "64559"
  },
  {
    "text": "pursuing my PhD and my research areas uh traditionally focus in malware detection",
    "start": "64559",
    "end": "69760"
  },
  {
    "text": "reverse engineering persistent threats and again malware based espionage IC and",
    "start": "69760",
    "end": "76400"
  },
  {
    "text": "SCADA security and how kind of those two areas play into that as well as vulnerabilities in the underground um",
    "start": "76400",
    "end": "82640"
  },
  {
    "text": "again kind of all four of those areas play uh together and a lot of this is going to be focused on",
    "start": "82640",
    "end": "90360"
  },
  {
    "text": "that what the presentation is going to focus on first of all it's going to focus on concerns and overview of IC",
    "start": "90360",
    "end": "96320"
  },
  {
    "text": "security it's also going to cover IC in general so for those of you that aren't necessarily involved with IC or SCA",
    "start": "96320",
    "end": "102400"
  },
  {
    "text": "every day it's still going to give you a good primer at least to understand some of the concepts I'm discussing during the talk also it's going to discuss how",
    "start": "102400",
    "end": "109439"
  },
  {
    "text": "terrible the security profiles of ICS devices and architectures are it's going to discuss that in fairly good depth so",
    "start": "109439",
    "end": "116479"
  },
  {
    "text": "again for those of you that aren't necessarily familiar it's going to be uh getting a little bit in depth on how those profiles of ICS devices are and",
    "start": "116479",
    "end": "123280"
  },
  {
    "text": "how bad they're traditionally deployed it's going to cover how are ICS devices attacked we get in pretty depth here",
    "start": "123280",
    "end": "130399"
  },
  {
    "text": "during uh the story time that I go into um and that's where we start to go in depth on more of that and then also who",
    "start": "130399",
    "end": "137040"
  },
  {
    "text": "attacks ICS devices that's going to be covered a little bit later on as well quick agenda IC overview so just a",
    "start": "137040",
    "end": "146080"
  },
  {
    "text": "quick uh look into what ICS is typical ICS deployment so that's going to include architecture um how they're",
    "start": "146080",
    "end": "152720"
  },
  {
    "text": "traditionally deployed and we'll note a couple things during that time overview of two SCADA protocols the two most",
    "start": "152720",
    "end": "159280"
  },
  {
    "text": "common SCA protocols we're going to cover today there are multiple but we're going to just cover two ics",
    "start": "159280",
    "end": "165319"
  },
  {
    "text": "vulnerabilities that's traditionally ICS devices and SCADA devices that are vulnerable sca on the internet i know a",
    "start": "165319",
    "end": "172959"
  },
  {
    "text": "lot of you have heard about uh showdan uh e- rip all the services that allow you to profile devices on the internet",
    "start": "172959",
    "end": "179680"
  },
  {
    "text": "skated devices are no different and in fact um there are a lot of devices that are internet facing in a skated",
    "start": "179680",
    "end": "184959"
  },
  {
    "text": "environment so we're going to cover some of that as well then we get into the story i'm not much of a storyteller so I apologize but it should be interesting",
    "start": "184959",
    "end": "191800"
  },
  {
    "text": "nonetheless then we get into the findings from the actual story the attacker profile from the story and then",
    "start": "191800",
    "end": "197519"
  },
  {
    "text": "recommendations on how to prevent some of these uh attacks from occurring so for those of you that are in ICS SCADA",
    "start": "197519",
    "end": "204000"
  },
  {
    "text": "um that can help out some on how to mitigate some of these uh attacks that that are",
    "start": "204000",
    "end": "209799"
  },
  {
    "text": "found so first things first what is ICS um ICS is essentially used in everything",
    "start": "209799",
    "end": "218000"
  },
  {
    "text": "uh in virtually everywhere during the manufacturing process so it's used in water gas energy automobile",
    "start": "218000",
    "end": "224640"
  },
  {
    "text": "manufacturing you name it if there's any type of manufacturing process built IC",
    "start": "224640",
    "end": "229920"
  },
  {
    "text": "devices are very typically going to be used in that environment they're notoriously insecure in every way um I",
    "start": "229920",
    "end": "236720"
  },
  {
    "text": "say this very loosely meaning that whenever I say they're notoriously insecure I'm saying that there are",
    "start": "236720",
    "end": "242080"
  },
  {
    "text": "published vulnerabilities that exist with uh seammen's controllers for instance there are exploits that exist",
    "start": "242080",
    "end": "248400"
  },
  {
    "text": "in the ICS SCA environment those do exist also uh tied around that same",
    "start": "248400",
    "end": "253439"
  },
  {
    "text": "thing with notoriously insecure is the architecture of ICS traditionally speaking IC is deployed in a very",
    "start": "253439",
    "end": "259840"
  },
  {
    "text": "antiquated way meaning that these devices are deployed 20 30 years ago",
    "start": "259840",
    "end": "265840"
  },
  {
    "text": "before security was really a thought in this environment in the manufacturing environment so the notoriously insecure",
    "start": "265840",
    "end": "272160"
  },
  {
    "text": "not only plays in with vulnerabilities exploits but also in the actual architecture and deployment of these",
    "start": "272160",
    "end": "277360"
  },
  {
    "text": "devices so it's kind of a two-fold insecure uh scenario software is sometimes embedded sometimes",
    "start": "277360",
    "end": "283440"
  },
  {
    "text": "not a lot of that depends upon the actual uh device manufacturer and the purpose of the device um so for instance",
    "start": "283440",
    "end": "290160"
  },
  {
    "text": "if the ICS controller is made to control um a belt for instance um in an",
    "start": "290160",
    "end": "296880"
  },
  {
    "text": "automobile automobile manufacturing system uh that will more than likely have embedded software because it has a very",
    "start": "296880",
    "end": "303360"
  },
  {
    "text": "dedicated purpose and function meaning it has one thing to do and that's it doesn't have to worry about uh",
    "start": "303360",
    "end": "309680"
  },
  {
    "text": "connecting out to the internet for instance it doesn't have to worry about um sending traffic elsewhere and also uh",
    "start": "309680",
    "end": "316160"
  },
  {
    "text": "the ICS devices are traditionally and typically proprietary meaning that these devices have a dedicated purpose and",
    "start": "316160",
    "end": "323280"
  },
  {
    "text": "they're proprietary to the manufacturer of those products so a Simeon a seaman's controller for instance is actually",
    "start": "323280",
    "end": "329120"
  },
  {
    "text": "going to be running traditionally speaking seammensbased software",
    "start": "329120",
    "end": "335680"
  },
  {
    "text": "what does a typical ICS network look like like this for those of you that aren't familiar SCADA the common term",
    "start": "335680",
    "end": "342720"
  },
  {
    "text": "SCADA is what sits on top that's the supervisory network the control system network sit below that there's a couple",
    "start": "342720",
    "end": "348720"
  },
  {
    "text": "things to note the SCA the supervisory network or SCA network communicates directly into the control system network",
    "start": "348720",
    "end": "354479"
  },
  {
    "text": "the control system network in this case is what's controlling uh the belt speeds that's what's controlling um anything",
    "start": "354479",
    "end": "360960"
  },
  {
    "text": "that's going to be involved on that IC RCA system the supervisory network is what issues",
    "start": "360960",
    "end": "367120"
  },
  {
    "text": "those commands so that's typically the hands behind the keyboard that's going to be the individual going out typing on a keyboard to say \"I want to speed up",
    "start": "367120",
    "end": "373919"
  },
  {
    "text": "this belt to whatever RPM.\" Couple things to note here first of all you're going to notice there's no",
    "start": "373919",
    "end": "379600"
  },
  {
    "text": "security that's not because I forgot to put it in the diagram it's because this is a traditional deployment i worked at",
    "start": "379600",
    "end": "385039"
  },
  {
    "text": "a very large industry or very large energy company uh in a past life and this is almost directly mimicked from",
    "start": "385039",
    "end": "391520"
  },
  {
    "text": "that energy company there's no firewalls there's no IDS IPS there's really no",
    "start": "391520",
    "end": "397520"
  },
  {
    "text": "security to speak in this environment and again it's not because I forgot it's because that is a traditional deployment",
    "start": "397520",
    "end": "403600"
  },
  {
    "text": "really doesn't uh exist so to really understand how a",
    "start": "403600",
    "end": "408880"
  },
  {
    "text": "typical IC device or IC network works you have to dive into a couple different protocols the first is DNP3 it's used to",
    "start": "408880",
    "end": "416479"
  },
  {
    "text": "send and receive messages and is traditionally very complex um there's a couple iterations of DNP3 there's a",
    "start": "416479",
    "end": "422400"
  },
  {
    "text": "secure DNP3 protocol that was developed somewhat recently um but the problem with that is again it's hard to go back",
    "start": "422400",
    "end": "429440"
  },
  {
    "text": "and actually redeploy ICS devices that are antiquated it's difficult to do that so in this case it's very complex",
    "start": "429440",
    "end": "436800"
  },
  {
    "text": "there's no authentication no encryption really no surprise there and there's several published vulnerabilities one of",
    "start": "436800",
    "end": "443280"
  },
  {
    "text": "those vulnerabilities is actually inherent to the protocol itself there's an inherent trust that exists that DMP3",
    "start": "443280",
    "end": "450080"
  },
  {
    "text": "traffic is going to actually be sourced in the same subnet meaning fundamentally",
    "start": "450080",
    "end": "456240"
  },
  {
    "text": "it's said that in DNP3 if a device is actually communicating with another device it's always going to be in the",
    "start": "456240",
    "end": "462639"
  },
  {
    "text": "same subnet as we know that's 99.9% of the time not the case so that's one of",
    "start": "462639",
    "end": "470160"
  },
  {
    "text": "the largest vulnerabilities that exists with DNP3 next protocol is Modbus this is the",
    "start": "470160",
    "end": "476960"
  },
  {
    "text": "oldest ICS protocol it's the first real ICS protocol that can that you can think of it controls input and output for uh",
    "start": "476960",
    "end": "485599"
  },
  {
    "text": "different controls itself that's mostly what it does it does do other functionality but most of the time it's",
    "start": "485599",
    "end": "492080"
  },
  {
    "text": "just to control input output there's no authentication or encryption no surprise there there's no broadcast suppression",
    "start": "492080",
    "end": "498720"
  },
  {
    "text": "which is an interesting uh scenario so if you're interested in going out onto an IC or SCANA network and do some",
    "start": "498720",
    "end": "504240"
  },
  {
    "text": "sniffing you're not going to have much of a problem there and there are vulnerabilities published uh with Modbus",
    "start": "504240",
    "end": "509280"
  },
  {
    "text": "as well a couple things that I wanted to cover as well are the security concerns",
    "start": "509280",
    "end": "514880"
  },
  {
    "text": "with ICS versus traditional IT systems ics for the most part and again I'm",
    "start": "514880",
    "end": "521279"
  },
  {
    "text": "using this as kind of a broad direction so keep in mind that some IT shops or some security individuals in in the IT",
    "start": "521279",
    "end": "527360"
  },
  {
    "text": "organization in security they might have different priorities they are worried about you know protecting the data",
    "start": "527360",
    "end": "533440"
  },
  {
    "text": "protecting communication channels and limiting interruptions those are really the three that I view as being very",
    "start": "533440",
    "end": "539040"
  },
  {
    "text": "important again it might differ in your particular organization or your particular function but as a broad",
    "start": "539040",
    "end": "544240"
  },
  {
    "text": "generality that's pretty important from an IC standpoint you're going to notice something no",
    "start": "544240",
    "end": "550680"
  },
  {
    "text": "security productivity is the number one uptime is the second reliability of data",
    "start": "550680",
    "end": "555760"
  },
  {
    "text": "is the third you're going to notice that those three all revolve around ensuring that the system and the actual data gets",
    "start": "555760",
    "end": "562560"
  },
  {
    "text": "to where it's destined and to make sure that functionality doesn't get interrupted there's really no security",
    "start": "562560",
    "end": "567760"
  },
  {
    "text": "built in so that's kind of I I wanted to be able to compare what the difference between a traditional security IT shop",
    "start": "567760",
    "end": "574320"
  },
  {
    "text": "would be thinking about security and IC kind of what you would think about as a traditional",
    "start": "574320",
    "end": "581120"
  },
  {
    "text": "engineer as I discussed earlier um there are some IC vulnerabilities this is not",
    "start": "581320",
    "end": "586560"
  },
  {
    "text": "uh this isn't a new you know this isn't a new topic in 2012 alone there was 171",
    "start": "586560",
    "end": "592640"
  },
  {
    "text": "unique vulnerabilities affecting IC products there's 55 vendors in total that were affected it's an interesting",
    "start": "592640",
    "end": "598720"
  },
  {
    "text": "statistic and on top of that 26% of those devices or those vulnerabilities",
    "start": "598720",
    "end": "604080"
  },
  {
    "text": "revolved around internetf facing infrastructure and devices and included in that 26% was",
    "start": "604080",
    "end": "610560"
  },
  {
    "text": "water you'll understand the significance between behind why I mentioned water in just a couple",
    "start": "610560",
    "end": "617120"
  },
  {
    "text": "minutes and again most of you have heard about Showdown you've heard about you know using Google Fu to go out and",
    "start": "618120",
    "end": "624160"
  },
  {
    "text": "actually look for devices that are vulnerable and SCADA is no different ics devices are no different unfortunately",
    "start": "624160",
    "end": "631040"
  },
  {
    "text": "again whenever they're whenever ICS architectures were deployed and created it was created and deployed in a very",
    "start": "631040",
    "end": "636800"
  },
  {
    "text": "antiquated fashion they didn't really think about the internet they didn't really think about devices facing the internet and they didn't really think",
    "start": "636800",
    "end": "642399"
  },
  {
    "text": "about um locking down protocols that were internetf facing they were looking for the ease of going out and performing",
    "start": "642399",
    "end": "648560"
  },
  {
    "text": "their job function meaning if they go out and say an engineer goes home he doesn't like getting called at 2 in the",
    "start": "648560",
    "end": "654399"
  },
  {
    "text": "morning because a belt went down i don't particularly care for it either what they have the problem of doing is",
    "start": "654399",
    "end": "659839"
  },
  {
    "text": "opening up those communication channels to the internet so while they're sitting at home they can just log into the belt",
    "start": "659839",
    "end": "664959"
  },
  {
    "text": "modify what they need to correct what the issue is and get it back up and running they didn't really think about individuals going out and looking at",
    "start": "664959",
    "end": "671200"
  },
  {
    "text": "these devices and attacking them couple examples here u the first one I just used showdan and typed in vx works you",
    "start": "671200",
    "end": "678640"
  },
  {
    "text": "can see that it's a pretty staggering number now keep in mind that not all of these devices are necessarily insecure",
    "start": "678640",
    "end": "684240"
  },
  {
    "text": "etc But you can see the number alone um the top country for instance is China with 19,000 plus devices and United",
    "start": "684240",
    "end": "690800"
  },
  {
    "text": "States is second with 12,000 plus devices etc but again keep in mind that's not necessarily saying that those",
    "start": "690800",
    "end": "696399"
  },
  {
    "text": "devices are vulnerable it's just saying that they're interfacing it's an attack platform it's a large uh foundation for",
    "start": "696399",
    "end": "702240"
  },
  {
    "text": "attack to go out and at least look second piece over there is um an actual Google query that I performed and you're",
    "start": "702240",
    "end": "708800"
  },
  {
    "text": "going to see some interesting stuff the first thing it says is meter information and you can see some statistics underneath that it shows",
    "start": "708800",
    "end": "717560"
  },
  {
    "text": "120.00120.00 system etc etc that's actually a water pump in San Francisco",
    "start": "717560",
    "end": "723120"
  },
  {
    "text": "California that's wide open you can click on that go in do whatever you want to it um it's no longer that way i had",
    "start": "723120",
    "end": "730320"
  },
  {
    "text": "gone out and disclosed that but that is wide open at the time performing a simple query in Google you'll easily",
    "start": "730320",
    "end": "736160"
  },
  {
    "text": "find that stuff another example a couple examples paste bin uh e-rip in Twitter pulled a",
    "start": "736160",
    "end": "744320"
  },
  {
    "text": "couple examples for each of those uh the first one is from anonymous just listing out some different dorks and things to",
    "start": "744320",
    "end": "750959"
  },
  {
    "text": "be able to find ICS SCADA systems so easy to go out and try to you know find an attack profile attack footprint with",
    "start": "750959",
    "end": "757600"
  },
  {
    "text": "that um pace bin so you're going to see USA governmentowned SCADA systems power",
    "start": "757600",
    "end": "762959"
  },
  {
    "text": "and meter transducer SCA systems and then they go through and they list IPs they list host names of those devices",
    "start": "762959",
    "end": "769360"
  },
  {
    "text": "i'd gone out looked at those devices and again not surprisingly they're a large majority of them are unlocked open can",
    "start": "769360",
    "end": "776240"
  },
  {
    "text": "do pretty much whatever you want large number of those are also universities uh worldwide same thing there um",
    "start": "776240",
    "end": "782480"
  },
  {
    "text": "universities in the SCADA environment have a surprisingly insecure deployment",
    "start": "782480",
    "end": "788079"
  },
  {
    "text": "so you're going to notice uh if you ever find that list um still a lot of those that are open and then RIP is kind of",
    "start": "788079",
    "end": "794720"
  },
  {
    "text": "similar to Showdan uh gives you a good ability again to cross reference what you find in showdan and do the same type",
    "start": "794720",
    "end": "800320"
  },
  {
    "text": "of query in e- rip and then tie the two together and say okay realistically what does the attack profile look like what",
    "start": "800320",
    "end": "805920"
  },
  {
    "text": "could I target so now that we have a foundation of these actual devices and and kind of",
    "start": "805920",
    "end": "811920"
  },
  {
    "text": "the protocols etc the goal wasn't to go in really depth on on some of this goal",
    "start": "811920",
    "end": "817200"
  },
  {
    "text": "is now to discuss the actual story itself is about a small town in rural",
    "start": "817200",
    "end": "823519"
  },
  {
    "text": "America I actually took that photo as I was driving on highway it's a water pump controlling",
    "start": "823519",
    "end": "829040"
  },
  {
    "text": "water pressure and availability in this small town it's about 18,000 people roughly give or take and that water",
    "start": "829040",
    "end": "835760"
  },
  {
    "text": "tower itself is what actually controls the water pressure the water availability for that town that pump",
    "start": "835760",
    "end": "843480"
  },
  {
    "text": "itself the water pressure systems internet facing no no firewall security measures in place at all and could cause",
    "start": "843480",
    "end": "850720"
  },
  {
    "text": "cat cause catastrophic water pressure failures really no different than any other",
    "start": "850720",
    "end": "855920"
  },
  {
    "text": "device that we've discussed right internet facing device no security implemented really nothing",
    "start": "855920",
    "end": "862360"
  },
  {
    "text": "there the bad thing is it was attacked several times during quarter 3 quarter 4 of 2012 attackers successfully gained",
    "start": "862360",
    "end": "869760"
  },
  {
    "text": "access this hasn't been made public yet and this isn't a story it's a real life event so this actually happened it",
    "start": "869760",
    "end": "876639"
  },
  {
    "text": "happened during Q3 Q4 2012 the only difference is it happened in my basement",
    "start": "876639",
    "end": "883519"
  },
  {
    "text": "i set up now what's considered a honeypot in a multitude of honeypotss in",
    "start": "883519",
    "end": "888720"
  },
  {
    "text": "my basement as well as scattered throughout uh the the USA looking for who really does attack",
    "start": "888720",
    "end": "896160"
  },
  {
    "text": "these devices with that um surprising amount of attacks came about and we'll get into",
    "start": "896160",
    "end": "903279"
  },
  {
    "text": "depth on some of those but this is where it kind of starts to get interesting the first thing that I'll do",
    "start": "903279",
    "end": "908800"
  },
  {
    "text": "is kind of discuss the actual overview of the architecture etc i am going to leave out some detail this research is",
    "start": "908800",
    "end": "914240"
  },
  {
    "text": "still actively going on so I am going to leave out some detail if there is additional detail that you're looking for feel free to talk to me afterwards",
    "start": "914240",
    "end": "921360"
  },
  {
    "text": "or contact me with the information at the end of the slides and and I can give you more detail based on that there's",
    "start": "921360",
    "end": "927440"
  },
  {
    "text": "two low interaction honeyotss and one high interaction honeypot for those of you that aren't familiar a low interaction honeypot is traditionally",
    "start": "927440",
    "end": "934240"
  },
  {
    "text": "viewed as a softwarebased honeypot something that would be a service emulation so it goes out and emulates a",
    "start": "934240",
    "end": "940399"
  },
  {
    "text": "service that's traditionally um uh valid meaning if I'm going to go out I would",
    "start": "940399",
    "end": "945920"
  },
  {
    "text": "emulate HTTP for instance that's a low interaction a high interaction is going out and actually utilizing physical",
    "start": "945920",
    "end": "954199"
  },
  {
    "text": "infrastructure and building out a honeypot that looks almost identical to a real production",
    "start": "954199",
    "end": "960120"
  },
  {
    "text": "environment it ran for 28 days in total and again it's still currently running but the testing period for which I",
    "start": "960120",
    "end": "966000"
  },
  {
    "text": "gathered the the statistics that you're going to see coming up is for 28 days it was the low interaction honeypot",
    "start": "966000",
    "end": "973440"
  },
  {
    "text": "environment as well as the high interaction honeypot was deployed on a combination of a Windows server uh 2008",
    "start": "973440",
    "end": "978959"
  },
  {
    "text": "box and two YUbuntu 1204 servers so really nothing too complex there i mean freely available pretty much anywhere",
    "start": "978959",
    "end": "984560"
  },
  {
    "text": "you go you're going to notice a couple things these two screenshots are directly from the actual website that I",
    "start": "984560",
    "end": "990160"
  },
  {
    "text": "created and frontended for this honeypot architecture you're going to notice a couple things and I did this on purpose",
    "start": "990160",
    "end": "995279"
  },
  {
    "text": "first thing is you're going to see on the bottom picture it says this is a production unit which it's obviously not",
    "start": "995279",
    "end": "1000480"
  },
  {
    "text": "making changes will violate the integrity of the water monitoring system and could adversely affect water containment i wanted to make it very",
    "start": "1000480",
    "end": "1006560"
  },
  {
    "text": "clear to whoever this was that if they modify this system or attempt to modify this system it could accurately and",
    "start": "1006560",
    "end": "1013120"
  },
  {
    "text": "cause catastrophic uh issues to the water containment you also notice that on the",
    "start": "1013120",
    "end": "1019279"
  },
  {
    "text": "uh top side it says submitting changes made versus affect systems so these are both very clearly outlined and I'd",
    "start": "1019279",
    "end": "1025438"
  },
  {
    "text": "actually gone back based on some of the attack statistics that I was seeing and added translations directly for this on",
    "start": "1025439",
    "end": "1030558"
  },
  {
    "text": "the page directly under that um I added it for I think Chinese Spanish uh French",
    "start": "1030559",
    "end": "1036480"
  },
  {
    "text": "and a couple other uh languages that way there was no excuse that some of these attackers couldn't read it in in in",
    "start": "1036480",
    "end": "1041760"
  },
  {
    "text": "their native language so I was trying to go that route this is what the attackers see whenever they go out and actually",
    "start": "1041760",
    "end": "1047918"
  },
  {
    "text": "look for the honeypot the attacker denoted by uh the little red guy over there just going out through the",
    "start": "1047919",
    "end": "1053840"
  },
  {
    "text": "internet sees an external IP and that's what's mimicking the control system and then the PLC sits on the back side so",
    "start": "1053840",
    "end": "1059440"
  },
  {
    "text": "I'll go in depth a little bit here the external IP or the mimicking control system is what you can consider the",
    "start": "1059440",
    "end": "1065919"
  },
  {
    "text": "device that's controlling the backend infrastructure right so that's where you issue commands that actually get",
    "start": "1065919",
    "end": "1071120"
  },
  {
    "text": "executed on the PLC that would cause the issue with the device with whatever device is in this case it's a water",
    "start": "1071120",
    "end": "1077760"
  },
  {
    "text": "pressure meter so if someone's going out and hitting this external IP it actually if they execute a command",
    "start": "1077760",
    "end": "1083280"
  },
  {
    "text": "or attempt to execute a command it's going to go back and modify the PLC which would in turn modify the actual uh",
    "start": "1083280",
    "end": "1089840"
  },
  {
    "text": "water containment system couple things to note here as well is that the external IP that's listed I also had",
    "start": "1089840",
    "end": "1096799"
  },
  {
    "text": "purchased um the host a host name that was very similar to the city that I had",
    "start": "1096799",
    "end": "1101840"
  },
  {
    "text": "gone out and mimicked what I had done at that point as well is and I'll get into a little",
    "start": "1101840",
    "end": "1106960"
  },
  {
    "text": "bit more depth about this but what I done also is gone out and actually um registered uh a valid email address etc",
    "start": "1106960",
    "end": "1114080"
  },
  {
    "text": "to be able to have contact information that looks valid and I included that on the actual sites themselves we'll get",
    "start": "1114080",
    "end": "1119520"
  },
  {
    "text": "into that again a little bit this is kind of just a rough overview of the high interaction architecture again",
    "start": "1119520",
    "end": "1124720"
  },
  {
    "text": "there's some modifications to this and I left out some pieces as well just because this is ongoing research and",
    "start": "1124720",
    "end": "1130160"
  },
  {
    "text": "again if you have questions about this feel free to talk to me offline the external facing URL sits on",
    "start": "1130160",
    "end": "1136559"
  },
  {
    "text": "what I consider at that point a physical host it's a Dell DL360 so a couple thousand US bucks i think remote",
    "start": "1136559",
    "end": "1143919"
  },
  {
    "text": "management was achieved um outside of that there's two administrative",
    "start": "1143919",
    "end": "1149120"
  },
  {
    "text": "functions that pipe out to two different devices the first was a Nano 10 PLC this is a consumer grade or just kind of a",
    "start": "1149120",
    "end": "1155760"
  },
  {
    "text": "testing device that individuals typically per uh purchase to modify very",
    "start": "1155760",
    "end": "1160799"
  },
  {
    "text": "small organizations or very small environments um in this case I purchased it obviously to to set up a honeypot and",
    "start": "1160799",
    "end": "1167120"
  },
  {
    "text": "then I also used a Seaman Sematic S71200 you can buy these on eBay I think 600 US",
    "start": "1167120",
    "end": "1173360"
  },
  {
    "text": "so very cheap and that's what I deem the control system network then I have a physical host",
    "start": "1173360",
    "end": "1180000"
  },
  {
    "text": "which again is a DL360 and I put salted docs now whenever I say salted docs I'm not referring to",
    "start": "1180000",
    "end": "1185280"
  },
  {
    "text": "the traditional term salted what I'm saying um and we'll get into depth a little here coming up on this but",
    "start": "1185280",
    "end": "1191840"
  },
  {
    "text": "whenever I say salted docs I'm referring to documents that I controlled that I was looking for someone to attempt to go",
    "start": "1191840",
    "end": "1198400"
  },
  {
    "text": "out and take so what I was doing was making it very enticing for these individuals if they compromise the system I made it very",
    "start": "1198400",
    "end": "1205039"
  },
  {
    "text": "enticing for them to not go out and access these documents and not exfiltrate them that was the",
    "start": "1205039",
    "end": "1211240"
  },
  {
    "text": "goal low interaction honeypot you're going to see it's pretty similar to the high interaction not a",
    "start": "1211240",
    "end": "1217440"
  },
  {
    "text": "lot of difference the only difference is that I utilize the cloud pretty extensively i also utilize some physical infrastructure as well but a lot of",
    "start": "1217440",
    "end": "1223760"
  },
  {
    "text": "cloud infrastructure and this is kind of where service emulation comes into place so the first Amazon EC2 instance and the",
    "start": "1223760",
    "end": "1230240"
  },
  {
    "text": "reasoning behind using Amazon is is cheap pretty much it and it's very easy to spin up and spin down EC2 instances",
    "start": "1230240",
    "end": "1237280"
  },
  {
    "text": "in a matter of seconds um again in this case an external IP it's mimicking the control",
    "start": "1237280",
    "end": "1242880"
  },
  {
    "text": "system with the URL um then I used the honeywall which is virtual networking it allowed me to virtually network between",
    "start": "1242880",
    "end": "1249360"
  },
  {
    "text": "several different virtual instances um of operating systems and then I had a",
    "start": "1249360",
    "end": "1254720"
  },
  {
    "text": "fake IC controller sitting on the backside which is what I deemed the control system network i did service emulation i",
    "start": "1254720",
    "end": "1261360"
  },
  {
    "text": "created a couple different ways to create what appeared to be valid network traffic for DNP3 and Modbus so this",
    "start": "1261360",
    "end": "1268159"
  },
  {
    "text": "traffic to an attacker to someone that would even be familiar with an IC or SCADA device communicating would look at",
    "start": "1268159",
    "end": "1274400"
  },
  {
    "text": "that traffic and find it to be very uh similar in fact they would have a very hard time not knowing that that was not",
    "start": "1274400",
    "end": "1280320"
  },
  {
    "text": "necessarily valid commands the purpose behind that and the thinking behind that is if an attacker would go out and",
    "start": "1280320",
    "end": "1286559"
  },
  {
    "text": "actually start sniffing that traffic and be able to try to then man the middle it or try to modify the traffic before it",
    "start": "1286559",
    "end": "1292240"
  },
  {
    "text": "goes to the control system network if they knew enough about DNP3 or Modbus they would not be concerned that it",
    "start": "1292240",
    "end": "1299039"
  },
  {
    "text": "could be that it wouldn't throw a red flag essentially then again I have the salted",
    "start": "1299039",
    "end": "1304559"
  },
  {
    "text": "documents that kind of sit off on their own area and again that is for a separate function that we'll get",
    "start": "1304559",
    "end": "1310600"
  },
  {
    "text": "into some of the tools that I use and again keep in mind that this isn't necessarily every tool that I use this",
    "start": "1310600",
    "end": "1315679"
  },
  {
    "text": "is just a collection of them um for other reasons I can't necessarily disclose all of the resources that were",
    "start": "1315679",
    "end": "1321679"
  },
  {
    "text": "used but nonetheless this is a good sampling of those um I used Amazon EC2 I",
    "start": "1321679",
    "end": "1327520"
  },
  {
    "text": "used Dell servers uh Seammen's controllers I used Snort which was very heavily used um and then I used what's",
    "start": "1327520",
    "end": "1332960"
  },
  {
    "text": "called a quick draw signature which I took Snort signatures that were created",
    "start": "1332960",
    "end": "1338240"
  },
  {
    "text": "in the past uh somebody a company had done some some pretty rigorous um uh",
    "start": "1338240",
    "end": "1343760"
  },
  {
    "text": "development work on creating u snort signatures for ICS devices traditionally",
    "start": "1343760",
    "end": "1349919"
  },
  {
    "text": "for DMP3 and Modbus in this case uh for quick draw I took those rule sets I",
    "start": "1349919",
    "end": "1355280"
  },
  {
    "text": "deployed those traditionally and then I modified some of those as well and created my own rule sets so in between",
    "start": "1355280",
    "end": "1360400"
  },
  {
    "text": "snort and um quick draw I was able to go out and actually see and and really create custom rule sets um and then I",
    "start": "1360400",
    "end": "1368720"
  },
  {
    "text": "also use Diona for being able to collect malware samples uh there was a lot of script kitty action we'll get into that",
    "start": "1368720",
    "end": "1374799"
  },
  {
    "text": "here shortly but there was a lot of script kitty action but I wanted to see if there was any interesting malware that was dropped on the box or attempted",
    "start": "1374799",
    "end": "1379840"
  },
  {
    "text": "to drop uh something along those lines so what vulnerabilities did I",
    "start": "1379840",
    "end": "1386120"
  },
  {
    "text": "present first was just SNMP vulnerabilities traditional read write SNMP packet sniffing IP spoofing all the",
    "start": "1386120",
    "end": "1392799"
  },
  {
    "text": "traditional SNMP vulnerabilities that we that you would see if you were out doing a vulnerability scan so this is nothing",
    "start": "1392799",
    "end": "1400080"
  },
  {
    "text": "too new here if you're going out performing a vulnerability scan those of you that are familiar know what vulnerabilities I'm speaking about",
    "start": "1400080",
    "end": "1406400"
  },
  {
    "text": "they're very antiquated SNMP old um authentication limitations",
    "start": "1406400",
    "end": "1412159"
  },
  {
    "text": "and what I mean by that is that I had secure areas of these particular websites these secure areas in some",
    "start": "1412159",
    "end": "1419120"
  },
  {
    "text": "instances I put admin admin just as username password and I also did admin and and then a more complex password and",
    "start": "1419120",
    "end": "1426159"
  },
  {
    "text": "then in other cases I actually used the traditional default username and password configuration for control",
    "start": "1426159",
    "end": "1432840"
  },
  {
    "text": "devices seeing that if someone was looking for a device and they noticed that it was a Seammen's S7 device would",
    "start": "1432840",
    "end": "1440000"
  },
  {
    "text": "they then go out and Google what's the default username password for that device if they would then that obviously",
    "start": "1440000",
    "end": "1445440"
  },
  {
    "text": "shows that they're getting more interested and I wouldn't say targeted but at least they're getting more interested in that particular device and",
    "start": "1445440",
    "end": "1451760"
  },
  {
    "text": "they're wanting to go out and compromise that in some fashion or another i also presented limits of",
    "start": "1451760",
    "end": "1457120"
  },
  {
    "text": "Modbus and DMP3 authentication encryption if you remember back to earlier slides um I didn't you know DMP3",
    "start": "1457120",
    "end": "1464640"
  },
  {
    "text": "and Modbus don't have authentication they don't have encryption there are iterations again that have then support",
    "start": "1464640",
    "end": "1470240"
  },
  {
    "text": "those technologies but in this case it's not supported so it's vulnerable to spoofing it's vulnerable to sniffing the",
    "start": "1470240",
    "end": "1477039"
  },
  {
    "text": "actual traffic etc i also presented a VX works vulnerability which is utilizing just",
    "start": "1477039",
    "end": "1482159"
  },
  {
    "text": "FTP um wide open on that and then I also configured default username passwords etc and then open access for certain ICS",
    "start": "1482159",
    "end": "1489919"
  },
  {
    "text": "modifications so in this case it would have been fan speed temperature utilization and containment of the water",
    "start": "1489919",
    "end": "1496200"
  },
  {
    "text": "system so I know at this point a lot of you are saying \"Okay this is all fine and dandy and I like that.\" But what do",
    "start": "1496200",
    "end": "1502480"
  },
  {
    "text": "you consider an attack right you have to define what an attack is in this case i'm not counting an attack something",
    "start": "1502480",
    "end": "1508880"
  },
  {
    "text": "that would be a driveby i don't care about that i don't care about script kitties going out and end mapping the system it none of that stuff matters",
    "start": "1508880",
    "end": "1514400"
  },
  {
    "text": "because I'm looking for who is really going out and looking at these devices to attack them i don't care about somebody trying to go out and",
    "start": "1514400",
    "end": "1520840"
  },
  {
    "text": "remotely you know try to exploit a system that doesn't even exist it doesn't matter so I was I'm referring to",
    "start": "1520840",
    "end": "1526880"
  },
  {
    "text": "only attacks that were targeted so whenever I'm referring to the numbers coming up I'm referring to attacks that were directly targeted at these systems",
    "start": "1526880",
    "end": "1532799"
  },
  {
    "text": "i'm also looking at attempted modification of pump systems meaning that they went out utilized FTP Telnet",
    "start": "1532799",
    "end": "1538320"
  },
  {
    "text": "Modbus DMP3 any of those uh protocols or services and directly tried to interact",
    "start": "1538320",
    "end": "1544159"
  },
  {
    "text": "with those devices and compromise them in some way or the other uh then again as I said only",
    "start": "1544159",
    "end": "1549840"
  },
  {
    "text": "attempted modification via Modbus and DMP3 so point 2 and three are very closely tied together and then DOSs and",
    "start": "1549840",
    "end": "1557440"
  },
  {
    "text": "DOS attacks will be considered depending on the scenario in this case there wasn't any DOS or DOS attempts but I",
    "start": "1557440",
    "end": "1563520"
  },
  {
    "text": "wanted to include that just in case that um it was attempted for you know for",
    "start": "1563520",
    "end": "1568640"
  },
  {
    "text": "whatever reason so this is the actual attack profile these are the attacking",
    "start": "1568640",
    "end": "1574960"
  },
  {
    "text": "countries that I had seen from an overall standpoint one point is that I didn't just utilize IPs to gain this",
    "start": "1574960",
    "end": "1581520"
  },
  {
    "text": "information so don't just think that I went out and did a who is on an IP and said oh yeah it's a IP in you know in",
    "start": "1581520",
    "end": "1587600"
  },
  {
    "text": "the Netherlands that is trying to compromise the system there was more detail involved in that i can't",
    "start": "1587600",
    "end": "1592880"
  },
  {
    "text": "necessarily discuss it now but again talk with me afterwards and I'll be happy to talk with you about how I ascertain more uh detail behind that",
    "start": "1592880",
    "end": "1600000"
  },
  {
    "text": "couple things to note here um you're going to notice the countries on the left and the actual number of attempted",
    "start": "1600000",
    "end": "1605760"
  },
  {
    "text": "attacks are on the right couple things to note here um again these are attacks",
    "start": "1605760",
    "end": "1610960"
  },
  {
    "text": "that I consider targeted these are attacks that would traditionally affect these systems in one way or the other",
    "start": "1610960",
    "end": "1617360"
  },
  {
    "text": "may not be full uh compromise of the water system it may not be that the system brings itself down completely",
    "start": "1617360",
    "end": "1622720"
  },
  {
    "text": "it's just a targeted attack of some sort what I can say is out of this entire collection of attacks there were 12",
    "start": "1622720",
    "end": "1628720"
  },
  {
    "text": "attacks that were directly applicable to causing damage to this water pressure system in one way or the other it would",
    "start": "1628720",
    "end": "1634880"
  },
  {
    "text": "have been uh affecting water pressure contamination it would have been could have been any number of things but there",
    "start": "1634880",
    "end": "1640000"
  },
  {
    "text": "were that number of attacks that directly affected these systems um so in",
    "start": "1640000",
    "end": "1645200"
  },
  {
    "text": "this case uh China is the first in 17 with 17 US uh USA with nine and then",
    "start": "1645200",
    "end": "1651360"
  },
  {
    "text": "Laos with six couple other interesting ones um is North Korea so after some of",
    "start": "1651360",
    "end": "1657679"
  },
  {
    "text": "the uh there's been some recent for those of you that may be familiar there's been some recent political things that have been kind of stirring",
    "start": "1657679",
    "end": "1663120"
  },
  {
    "text": "up with North Korea and I started to see an attack pretty quickly thereafter against uh this honeypot system and then",
    "start": "1663120",
    "end": "1670640"
  },
  {
    "text": "also there were some other uh you know smattering of attacks throughout the throughout the",
    "start": "1670640",
    "end": "1676440"
  },
  {
    "text": "world an attack overview so this kind of gives you a decent idea of what you're looking for vx works exploitation",
    "start": "1676440",
    "end": "1683679"
  },
  {
    "text": "attempt there was two of those so that would have been someone going out probably attempting an endmap scan",
    "start": "1683679",
    "end": "1689520"
  },
  {
    "text": "something like that seeing that VX works was running and then attempted to actually exploit that particular",
    "start": "1689520",
    "end": "1696679"
  },
  {
    "text": "service then there was 12 attempts to shut down the pump system i'm using that as a catch-all or or essentially just a",
    "start": "1696679",
    "end": "1703960"
  },
  {
    "text": "category whenever I say there's an attempt to shut down the pump system that can be from someone gaining access",
    "start": "1703960",
    "end": "1709279"
  },
  {
    "text": "through the admin site and clicking shutdown and submitting it or it could be someone going out and actively",
    "start": "1709279",
    "end": "1716240"
  },
  {
    "text": "modifying DMP3 or Modbus to shut down the system so I use that as a broad category to cover everything that was",
    "start": "1716240",
    "end": "1723600"
  },
  {
    "text": "attempting to shut down that pump modifying temperature output this was an interesting one um what I wanted",
    "start": "1723600",
    "end": "1730799"
  },
  {
    "text": "to try I thought if I was an attacker what would I want to do that would really cause some mayhem yeah yeah shutting down the pump system is pretty",
    "start": "1730799",
    "end": "1735840"
  },
  {
    "text": "cool and yeah people are without water but how cool would it be to be able to then go out and instead of shutting down the system but distribute and dispense",
    "start": "1735840",
    "end": "1742960"
  },
  {
    "text": "boiling water to people if they turn on the cold water lever i included that and essentially there were seven attacks",
    "start": "1742960",
    "end": "1749120"
  },
  {
    "text": "against that that I mean it's not really funny if it would happen of course but nonetheless something I wanted to",
    "start": "1749120",
    "end": "1754440"
  },
  {
    "text": "consider modify the pump pressure and this is the case if someone uh were to go out and try to turn on you know their",
    "start": "1754440",
    "end": "1760320"
  },
  {
    "text": "their water their tap and nothing came out or too much water came out or too quickly something along those lines",
    "start": "1760320",
    "end": "1767360"
  },
  {
    "text": "there was five attacks on that secured area access attempt there was nine and",
    "start": "1767360",
    "end": "1772559"
  },
  {
    "text": "by access attempt I'm referring to they were able to gain access to secure area of the website based on default",
    "start": "1772559",
    "end": "1778799"
  },
  {
    "text": "credentials of that control device or B um actual access just via admin admin or",
    "start": "1778799",
    "end": "1786080"
  },
  {
    "text": "something along those lines so it was someone going out and actively attempting that mod bus traffic modification there",
    "start": "1786080",
    "end": "1793520"
  },
  {
    "text": "was two of those which that's surprising i honestly didn't expect to see anybody really attempt to do any Modbus traffic",
    "start": "1793520",
    "end": "1799799"
  },
  {
    "text": "modification primarily because to do any Modbus traffic modification in any fashion you really have to understand",
    "start": "1799799",
    "end": "1805679"
  },
  {
    "text": "the protocol it's not something that you can really go out and just say \"Yeah I'm going to I I know what Modbus is i'm going to Google it.\" You you really",
    "start": "1805679",
    "end": "1811679"
  },
  {
    "text": "should and you really have to understand the protocol to be able to modify it and attempt to modify it so that was an",
    "start": "1811679",
    "end": "1817840"
  },
  {
    "text": "interesting statistic that I didn't honestly expect to see and then modification of CPU fan",
    "start": "1817840",
    "end": "1823279"
  },
  {
    "text": "speed that's the actual device which essentially could have caused catastrophic failure in the water pump pump system so any type of modification",
    "start": "1823279",
    "end": "1830080"
  },
  {
    "text": "to the CPU fan system on the device that's where this kind of fits",
    "start": "1830080",
    "end": "1835520"
  },
  {
    "text": "in all right so now kind of just a quick overview of Snort findings for those of",
    "start": "1837320",
    "end": "1842960"
  },
  {
    "text": "you that are really familiar with uh with Snort again I use digital bonds quickdraw uh ska snort signatures as",
    "start": "1842960",
    "end": "1849679"
  },
  {
    "text": "well as custom created signatures on my own to quickly identify what exactly is",
    "start": "1849679",
    "end": "1854880"
  },
  {
    "text": "being uh targeted this was again not necessarily used as like the sale so I didn't go out and say oh yeah snort said",
    "start": "1854880",
    "end": "1860880"
  },
  {
    "text": "that DMP3 was unauthorized read request to a PLC i used that as a foundation to then be able to go out and look further",
    "start": "1860880",
    "end": "1867039"
  },
  {
    "text": "into what was attempted so from that you're going to see several different rules were triggered there was Modbus TCP several",
    "start": "1867039",
    "end": "1873840"
  },
  {
    "text": "of those which kind of relates to the the prior slide um unauthorized write",
    "start": "1873840",
    "end": "1879039"
  },
  {
    "text": "request and unauthorized read request so it's someone really actually going out trying to sniff the traffic or trying to",
    "start": "1879039",
    "end": "1884640"
  },
  {
    "text": "write traffic either or and then DNP3 I included three as well a lot of those",
    "start": "1884640",
    "end": "1890240"
  },
  {
    "text": "were false positives i didn't see any active DNP3 modifications and I attributed that because to the fact that",
    "start": "1890240",
    "end": "1896320"
  },
  {
    "text": "it's more than likely a very you know it's a complex protocol so in my eyes it was probably the fact that it's more",
    "start": "1896320",
    "end": "1902159"
  },
  {
    "text": "difficult to find a targeted attacker that really understands DMP3 so all of that is is pretty",
    "start": "1902159",
    "end": "1908480"
  },
  {
    "text": "interesting but in the back of your mind if you if it was me I would be saying okay what about those salted documents",
    "start": "1908480",
    "end": "1913840"
  },
  {
    "text": "that you're talking about again it's not the traditional salted method that I'm referring to this is where it gets even more",
    "start": "1913840",
    "end": "1920080"
  },
  {
    "text": "interesting so again I set up a valid email address",
    "start": "1920080",
    "end": "1925840"
  },
  {
    "text": "valid website everything valid but the interesting thing is I put",
    "start": "1925840",
    "end": "1931120"
  },
  {
    "text": "city works with an X because I just wanted to make it a little bit different to maybe flag someone as being a you",
    "start": "1931120",
    "end": "1937519"
  },
  {
    "text": "know just a change and then I did the host name of our country.com or the city.com i included the actual uh the",
    "start": "1937519",
    "end": "1944399"
  },
  {
    "text": "email that they sent i didn't include initially I included the header information if you want that feel free",
    "start": "1944399",
    "end": "1950240"
  },
  {
    "text": "to talk to me and I can give all that to you says you know hello sir I am the and they spoofed the name of the city",
    "start": "1950240",
    "end": "1956240"
  },
  {
    "text": "administrator so they had gone out to this website of this city taken the city administrator's name and used it",
    "start": "1956240",
    "end": "1962559"
  },
  {
    "text": "directly in this email and like the attached statistics filled out and sent back to me you're going to notice that",
    "start": "1962559",
    "end": "1967679"
  },
  {
    "text": "the attached statistics so it's obviously uh there's an attached document first kindly send me the doc and also",
    "start": "1967679",
    "end": "1974240"
  },
  {
    "text": "advise if you have questions look forward you look forward you hear from you soon So a little bit of issue there",
    "start": "1974240",
    "end": "1980039"
  },
  {
    "text": "right and then it said Mr city administrator name so he had again used in two times the city the valid city",
    "start": "1980039",
    "end": "1987360"
  },
  {
    "text": "administrator's name of that city so I took the document and ran it",
    "start": "1987360",
    "end": "1993360"
  },
  {
    "text": "the document was called city request.doc for those of you that are interested i'll provide that to you as well the actual malware",
    "start": "1993360",
    "end": "1998919"
  },
  {
    "text": "itself whenever you actually open the doc it's just a bunch of ones so pretty traditional and pretty generic whenever",
    "start": "1998919",
    "end": "2005600"
  },
  {
    "text": "it comes to malware not too nothing too advanced there looking at a little bit further city request.d do it dumps two",
    "start": "2005600",
    "end": "2013519"
  },
  {
    "text": "files on the system itself file GH.exe which is essentially just a local",
    "start": "2013519",
    "end": "2018960"
  },
  {
    "text": "password hash dump and then AI.exe it shovels a shell back to a to an actual",
    "start": "2018960",
    "end": "2024240"
  },
  {
    "text": "dump server to be able to exfiltrate documents that's it um I went out and actually was able to interact directly",
    "start": "2024240",
    "end": "2030960"
  },
  {
    "text": "with the malware itself once I pulled those two executables out um the malware is communicating to a drop server the",
    "start": "2030960",
    "end": "2036880"
  },
  {
    "text": "CNC server in China and it's exploiting uh the CVE 2012158 so for those of you that are",
    "start": "2036880",
    "end": "2043760"
  },
  {
    "text": "familiar that's a pretty common uh exploited Word doc nothing too crazy",
    "start": "2043760",
    "end": "2049878"
  },
  {
    "text": "there execution of the malware you're going to see an email address",
    "start": "2049879",
    "end": "2055960"
  },
  {
    "text": "tombkeeper126.com with uh some fairly uh generic characters there",
    "start": "2055960",
    "end": "2064040"
  },
  {
    "text": "once I executed cityrequest.doc file started leaving the server in question after 5 days so it",
    "start": "2064240",
    "end": "2069919"
  },
  {
    "text": "took 5 days for this to be executed and for them to actually go out and realize that there was activity",
    "start": "2069919",
    "end": "2075560"
  },
  {
    "text": "happening there was really four things that were that were of interest that left the first was a fake VPN config",
    "start": "2075560",
    "end": "2082760"
  },
  {
    "text": "file second was a network statistics dump SAM database dump and gain persistence via process migration so I",
    "start": "2082760",
    "end": "2089520"
  },
  {
    "text": "watched process migration occur for persistence purposes and then I included a SAM database dump or they included a",
    "start": "2089520",
    "end": "2095919"
  },
  {
    "text": "SAM database dump as well to ensure that then they could start cracking passwords if there was anything else in that domain it won't execute on Office 2010",
    "start": "2095919",
    "end": "2103839"
  },
  {
    "text": "so that's an interesting statistic there there's some interesting stuff about these documents that allowed me to then",
    "start": "2103839",
    "end": "2109520"
  },
  {
    "text": "ascertain who exactly uh were the threat actors in the case that I was wanting to again profile some of these uh",
    "start": "2109520",
    "end": "2116320"
  },
  {
    "text": "individual actors as well as countries i'm not going to get into that in this talk that's outside of the scope of it",
    "start": "2116320",
    "end": "2122560"
  },
  {
    "text": "but there are some interesting details there some of the malware features",
    "start": "2122560",
    "end": "2128640"
  },
  {
    "text": "monitors registration keys for value changes so again it goes out just like any other traditional malware monitors",
    "start": "2128640",
    "end": "2134640"
  },
  {
    "text": "registration keys uh creates guard pages so this is for um going out and",
    "start": "2134640",
    "end": "2140320"
  },
  {
    "text": "attempting to uh prevent any type of reverse engineering and or AV type of engine interaction anti anti virus",
    "start": "2140320",
    "end": "2147119"
  },
  {
    "text": "engine interaction anything like that communicates to two C2 IPs so it's",
    "start": "2147119",
    "end": "2152480"
  },
  {
    "text": "actually actively communicated to two separate C2 IPs it creates files on the actual system itself so it goes out and",
    "start": "2152480",
    "end": "2158400"
  },
  {
    "text": "actively creates several files obviously the two executables are two files but it also creates other files so it's not",
    "start": "2158400",
    "end": "2164000"
  },
  {
    "text": "just those two and it creates a fake document and opens it there's some functionality behind that um that's",
    "start": "2164000",
    "end": "2170720"
  },
  {
    "text": "fairly interesting to make the user actually appear as though they're opening that city request document and",
    "start": "2170720",
    "end": "2175839"
  },
  {
    "text": "it's actually behaving the way that they expect it to i created a couple diagrams that",
    "start": "2175839",
    "end": "2182320"
  },
  {
    "text": "cover um how the attack went down to to better visualize it so this is days one",
    "start": "2182320",
    "end": "2189200"
  },
  {
    "text": "through four the first step was that the attacker",
    "start": "2189200",
    "end": "2196560"
  },
  {
    "text": "sent a spearfished email to the actual administrator where I had SMTP",
    "start": "2196560",
    "end": "2202200"
  },
  {
    "text": "running from there the attachment was opened and I opened that on the salted document server for the purpose of being",
    "start": "2202200",
    "end": "2209200"
  },
  {
    "text": "able to then see if the individual attacker would be interested in going out and then exfiltrating any of those files that appeared to be",
    "start": "2209200",
    "end": "2215160"
  },
  {
    "text": "important the third step was that a back door was shoveled to the attacker themselves and then the fourth was",
    "start": "2215160",
    "end": "2220480"
  },
  {
    "text": "process migration on that server so once the shell was back once the uh back door was shoveled the actual attacker then",
    "start": "2220480",
    "end": "2226079"
  },
  {
    "text": "went out accessed the device and did process migration then for persistency",
    "start": "2226079",
    "end": "2231520"
  },
  {
    "text": "purposes days 5 through 17 it's pretty clear on this one that",
    "start": "2231560",
    "end": "2237839"
  },
  {
    "text": "the attacker connects back in at uh 10:00 Central Standard Time and then data exfiltration uh occurs directly",
    "start": "2237839",
    "end": "2244480"
  },
  {
    "text": "thereafter and that's where those four files were actually starting to then uh go out and start to exfiltrate so you",
    "start": "2244480",
    "end": "2251760"
  },
  {
    "text": "know that this is an interesting step that it took them an amount of time to realize that the actual box itself was",
    "start": "2251760",
    "end": "2258400"
  },
  {
    "text": "compromised and then they started to then shovel that information back and then days 18 on",
    "start": "2258400",
    "end": "2265480"
  },
  {
    "text": "um this is where we're obviously at now so we're actively running this um and",
    "start": "2265480",
    "end": "2271200"
  },
  {
    "text": "we're actively gathering intelligence and statistics based on what's happening right now on these devices um I can say",
    "start": "2271200",
    "end": "2278720"
  },
  {
    "text": "that it has increased um and I have subsequently added more uh I guess",
    "start": "2278720",
    "end": "2285680"
  },
  {
    "text": "infrastructure to the environment to see what else will happen in the environment itself so I've added not only just",
    "start": "2285680",
    "end": "2291119"
  },
  {
    "text": "traditional ICS and SCADA devices but I've also added other traditional devices that you would see database server etc i added those devices as well",
    "start": "2291119",
    "end": "2298079"
  },
  {
    "text": "just to see if there was any interest in those in addition to the SCADA IC",
    "start": "2298079",
    "end": "2303320"
  },
  {
    "text": "devices so I'm going to kind of quickly go into the attacker profile i'm going to keep this very very high level again",
    "start": "2303320",
    "end": "2309599"
  },
  {
    "text": "because some of this data I can't u necessarily give out right now so I",
    "start": "2309599",
    "end": "2314800"
  },
  {
    "text": "chose the most uh prevalent attackers i profiled poked and researched who who they were a lot of the malware was just",
    "start": "2314800",
    "end": "2320160"
  },
  {
    "text": "code reuse but the interesting thing was I went out and actually started to look at who the attackers were and who these individuals were that were looking into",
    "start": "2320160",
    "end": "2326400"
  },
  {
    "text": "our systems the interesting thing was is one of the C2 servers was actually wide open had no security what behind it",
    "start": "2326400",
    "end": "2333280"
  },
  {
    "text": "whatsoever so I could actually hop on to the actual server itself and see the documents that they pulled from my",
    "start": "2333280",
    "end": "2339800"
  },
  {
    "text": "server on that box so they were using it as a dumping ground essentially so I was",
    "start": "2339800",
    "end": "2345040"
  },
  {
    "text": "able to access the server see what was there and see my files sitting there ready to be pulled off by whatever",
    "start": "2345040",
    "end": "2350320"
  },
  {
    "text": "entity is actually interacting with that server that was kind of an interesting scenario and I've never been um I've never seen it from that angle so it was",
    "start": "2350320",
    "end": "2356560"
  },
  {
    "text": "pretty cool and then on there there was other statistics as well and other compromised systems that were",
    "start": "2356560",
    "end": "2361680"
  },
  {
    "text": "communicating back so it wasn't just this honeypot environment it was also uh some governmental agencies etc that was",
    "start": "2361680",
    "end": "2367839"
  },
  {
    "text": "one central point for all of these drop documents you know everybody's going to be talking",
    "start": "2367839",
    "end": "2374000"
  },
  {
    "text": "and everybody asks and they have asked \"Is this targeted?\" I mean I can say that the attacks were targeted but I",
    "start": "2374000",
    "end": "2380240"
  },
  {
    "text": "can't say 100% you know I'm not going to throw out AP i'm not going to throw out any of that stuff because you don't",
    "start": "2380240",
    "end": "2386480"
  },
  {
    "text": "really know i can't really go out and say 100% what it is but what I can say is I put together this really cool vin",
    "start": "2386480",
    "end": "2393160"
  },
  {
    "text": "diagram and uh it's hard to establish what the motivation was right",
    "start": "2393160",
    "end": "2398560"
  },
  {
    "text": "persistence in my eyes was kind of the central point in this whole architecture in this whole environment persistence",
    "start": "2398560",
    "end": "2403599"
  },
  {
    "text": "was really the main thing and in this case all of the other areas around that are really the big piece so inflict",
    "start": "2403599",
    "end": "2410400"
  },
  {
    "text": "damage was a big part of this right we saw pump modifications we saw all these things happening so inflicting damage",
    "start": "2410400",
    "end": "2416240"
  },
  {
    "text": "was an obvious piece of the puzzle that was that was very important reconnaissance was a big piece i did see",
    "start": "2416240",
    "end": "2422320"
  },
  {
    "text": "a lot of reconnaissance activity so I would see for instance um someone probing the system one day two days may",
    "start": "2422320",
    "end": "2429520"
  },
  {
    "text": "go by um and then a slow scan of the system might occur as well so the attacker might go out do a slow scan on",
    "start": "2429520",
    "end": "2436160"
  },
  {
    "text": "port you know on common ports 1 to 1024 and then they might wait 2 days and then they might come back and look at it",
    "start": "2436160",
    "end": "2442480"
  },
  {
    "text": "again so it was very slow so there was a lot of reconnaissance work that was",
    "start": "2442480",
    "end": "2447520"
  },
  {
    "text": "occurring on this steel data was obviously the third major section because again there's data xfiltration",
    "start": "2447520",
    "end": "2453359"
  },
  {
    "text": "and there's still data xfiltration that's attempting to occur as we speak the interesting thing is is that I have",
    "start": "2453359",
    "end": "2458480"
  },
  {
    "text": "to log on to these systems under the honeypot environment and generate valid traffic to make it look as though it's",
    "start": "2458480",
    "end": "2463520"
  },
  {
    "text": "really valid if for instance if it's an IC environment and you know nothing is",
    "start": "2463520",
    "end": "2469119"
  },
  {
    "text": "going on that's going to throw a red flag to the actual attackers themselves so I have to log in every day generate a",
    "start": "2469119",
    "end": "2474319"
  },
  {
    "text": "bunch of random for lack of a better term crap because I just want to generate traffic to make it look like",
    "start": "2474319",
    "end": "2479520"
  },
  {
    "text": "there's things happening to keep the attackers interested and then the three intersecting points activist group",
    "start": "2479520",
    "end": "2486560"
  },
  {
    "text": "espionage and cyber crime i can't really at this point say where does that fit right i mean I can say what happened i",
    "start": "2486560",
    "end": "2493680"
  },
  {
    "text": "can't establish motivation i can just present out what I've seen and what it",
    "start": "2493680",
    "end": "2499359"
  },
  {
    "text": "could be and then persistence is the main point in my eyes because I keep seeing it i keep seeing it across the",
    "start": "2499359",
    "end": "2504960"
  },
  {
    "text": "entire environment they're process migrating they're uh putting going in and doing registry edits they're going",
    "start": "2504960",
    "end": "2510560"
  },
  {
    "text": "in and doing the things that you traditionally see when any type of persistence is actually going out and being gained so again this isn't",
    "start": "2510560",
    "end": "2517200"
  },
  {
    "text": "necessarily saying that these attacks are targeted i I I don't know what I'm saying is the motivation is hard to establish and this is a good baseline to",
    "start": "2517200",
    "end": "2523520"
  },
  {
    "text": "try to say what could it be i threw in this diagram just to show",
    "start": "2523520",
    "end": "2529440"
  },
  {
    "text": "from an AP standpoint and I use AP loosely out of the six steps there was four steps that I view as being active",
    "start": "2529440",
    "end": "2537440"
  },
  {
    "text": "the first was intelligence gathering that's fairly generic right you can say intelligence gathered could be anything i mean it depends on what your your",
    "start": "2537440",
    "end": "2544000"
  },
  {
    "text": "loose term is point of entry so it's delivered via social engineering attack",
    "start": "2544000",
    "end": "2549599"
  },
  {
    "text": "i think that's obvious based on the email right and based on the document itself no doubt about that command and",
    "start": "2549599",
    "end": "2555599"
  },
  {
    "text": "control communication that's obvious as well considering I was able to go out ascertain the actual uh data itself from",
    "start": "2555599",
    "end": "2562800"
  },
  {
    "text": "the servers that it was dropped on lateral movement i'm seeing some of",
    "start": "2562800",
    "end": "2568000"
  },
  {
    "text": "that but not to the point where I would feel comfortable saying that I'm seeing it enough it looks to be maybe um at this point happen stance that they're",
    "start": "2568000",
    "end": "2573599"
  },
  {
    "text": "just saying oh well let's just hop over here and look around it's not doesn't appear to be dedicated lateral movement and saying you know yes",
    "start": "2573599",
    "end": "2580760"
  },
  {
    "text": "100% asset data discovery um this is again going you know just going out and looking for other devices there is some",
    "start": "2580760",
    "end": "2587200"
  },
  {
    "text": "of that but I wouldn't feel comfortable saying 100% it's targeted in that case and then data excfiltration that's",
    "start": "2587200",
    "end": "2592480"
  },
  {
    "text": "obvious based on the fact again I watched the data leave and then I was able to go out and actually see the server itself",
    "start": "2592480",
    "end": "2600319"
  },
  {
    "text": "so now for those of you that are in ICS and SCADA um or or utilize these devices or look into these devices on a daily",
    "start": "2600319",
    "end": "2606720"
  },
  {
    "text": "basis I'm going to throw out about 10 different recommendations based on experience in the past working at the",
    "start": "2606720",
    "end": "2613440"
  },
  {
    "text": "large energy company that I did and then working for on this side saying okay what are the attacks that I'm seeing and",
    "start": "2613440",
    "end": "2618800"
  },
  {
    "text": "how could you go out and um you know help change this disable internet access",
    "start": "2618800",
    "end": "2624240"
  },
  {
    "text": "to all your trusted resources i say where possible but I mean come on just disable it you you shouldn't need",
    "start": "2624240",
    "end": "2629599"
  },
  {
    "text": "internet access your engineers they they have to have access but you know do it via SSLVPN do it via something that's",
    "start": "2629599",
    "end": "2636400"
  },
  {
    "text": "more secure don't just have these protocols open to the internet that's ridiculous maintain trusted resources at",
    "start": "2636400",
    "end": "2642240"
  },
  {
    "text": "the latest patch levels this is a point of contention with a lot of ICS SCA guys",
    "start": "2642240",
    "end": "2647640"
  },
  {
    "text": "because it's very difficult to shut these systems down it's very hard to go out and say and and and pitch from a",
    "start": "2647640",
    "end": "2653839"
  },
  {
    "text": "security standpoint to go in and say \"Hey I need to take down um this critical server in the SKA network to be",
    "start": "2653839",
    "end": "2660240"
  },
  {
    "text": "able to patch it.\" As you saw earlier it really doesn't matter who says that me",
    "start": "2660240",
    "end": "2666480"
  },
  {
    "text": "as a security engineer at my prior company they didn't they didn't care about that they said \"Well is it going to affect downtime is it going to affect",
    "start": "2666480",
    "end": "2672079"
  },
  {
    "text": "production is it going to are you going to stop coal from coming out of the ground?\" If the answer is yes sorry",
    "start": "2672079",
    "end": "2677440"
  },
  {
    "text": "you're out of luck you're just that's the way it is so this is a very target-rich environment require username and",
    "start": "2677440",
    "end": "2683920"
  },
  {
    "text": "password and two-factor authentication if possible and where applicable for all systems including those deemed not",
    "start": "2683920",
    "end": "2689200"
  },
  {
    "text": "trusted anything that you can view as an escada or control network should be two-factor authenticated in my opinion",
    "start": "2689200",
    "end": "2695440"
  },
  {
    "text": "no doubt about it control contractor access this is a common issue in most",
    "start": "2695440",
    "end": "2700960"
  },
  {
    "text": "engineering and mining companies contractor access is massive there's a lot of contractors that come in and out",
    "start": "2700960",
    "end": "2706480"
  },
  {
    "text": "there's not a lot of native intelligence and not a not not a native um instruction set in an organization in a",
    "start": "2706480",
    "end": "2713200"
  },
  {
    "text": "mining organization particularly so they have to bring in a lot of contractors and access these resources and and they",
    "start": "2713200",
    "end": "2718960"
  },
  {
    "text": "really don't pay attention to accounts that they create they don't go out and modify these with GPOs they don't control access in these things so",
    "start": "2718960",
    "end": "2725599"
  },
  {
    "text": "control contractor access utilize SSL TLS for",
    "start": "2725599",
    "end": "2731359"
  },
  {
    "text": "communications um that's I mean common I think for pretty much anything control",
    "start": "2731359",
    "end": "2736640"
  },
  {
    "text": "access to trusted devices um again that kind of goes back to the same concept of",
    "start": "2736640",
    "end": "2742079"
  },
  {
    "text": "controlling access from a contractor standpoint so use a bastion host with",
    "start": "2742079",
    "end": "2747280"
  },
  {
    "text": "alles and whenever I say a bastion host I'm referring to device to a central server that is actually in between uh",
    "start": "2747280",
    "end": "2753680"
  },
  {
    "text": "two different WAN segments so between a skater segment and um a PLC segment put",
    "start": "2753680",
    "end": "2759200"
  },
  {
    "text": "a bastion host and that's the only host that can gain access into that network that is used with great success and for",
    "start": "2759200",
    "end": "2764480"
  },
  {
    "text": "those of you that are tasked with going out and trying to improve security very quickly a quick win is going out and",
    "start": "2764480",
    "end": "2769920"
  },
  {
    "text": "deploying a bastion host concept and say only that host can access only those devices so utilize that concept it's",
    "start": "2769920",
    "end": "2776800"
  },
  {
    "text": "very quick and it's a good win improve logging on trusted environments this is a huge issue right i mean logging is a",
    "start": "2776800",
    "end": "2782480"
  },
  {
    "text": "massive issue pretty much in any security organization as it is but it's very important in ICS SCADA environments",
    "start": "2782480",
    "end": "2790160"
  },
  {
    "text": "primarily because from a forensic point of view for forensication purposes it it",
    "start": "2790160",
    "end": "2796000"
  },
  {
    "text": "is invaluable knowing what happened is invaluable in that case and then utilize zoning infrastructure such as a business",
    "start": "2796000",
    "end": "2802480"
  },
  {
    "text": "LAN a wireless LAN and a SCADA segment and then control rigorously between",
    "start": "2802480",
    "end": "2807680"
  },
  {
    "text": "those three segments with firewall uh rules with you know ensure that IPS or IDS is deployed there you know go out",
    "start": "2807680",
    "end": "2815200"
  },
  {
    "text": "and make sure that logging is in there and it's pretty simple and then finally develop a threat modeling system to your",
    "start": "2815200",
    "end": "2821280"
  },
  {
    "text": "organization understand who's attacking you and why understand why they're looking at your organization understand",
    "start": "2821280",
    "end": "2826800"
  },
  {
    "text": "what they would find understand if they were interested in looking at you as a company understand why do you have",
    "start": "2826800",
    "end": "2832319"
  },
  {
    "text": "something that they want do they do you have something do you have data do you have uh geospatial information is a big",
    "start": "2832319",
    "end": "2838480"
  },
  {
    "text": "one understand why and finally remember these attacks",
    "start": "2838480",
    "end": "2844480"
  },
  {
    "text": "are happening they're attacking obviously in the USA they're happening in other places as",
    "start": "2844480",
    "end": "2850599"
  },
  {
    "text": "well pretty simple and we're still seeing that research happen this is my contact information",
    "start": "2850599",
    "end": "2857440"
  },
  {
    "text": "and again for any of the information that you are looking for in addition to the data that I presented feel free to",
    "start": "2857440",
    "end": "2862880"
  },
  {
    "text": "contact me afterwards um and I'll be happy to share that with you thank you",
    "start": "2862880",
    "end": "2869799"
  },
  {
    "text": "[Applause]",
    "start": "2873110",
    "end": "2875559"
  }
]