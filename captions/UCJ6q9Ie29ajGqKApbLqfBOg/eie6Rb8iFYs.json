[
  {
    "start": "0",
    "end": "138000"
  },
  {
    "text": "before we will start our presentation i would like to first introduce myself",
    "start": "5759",
    "end": "11679"
  },
  {
    "text": "uh my name is griegos viper i'm living in poland so i'm currently working around 15 years in",
    "start": "11679",
    "end": "19199"
  },
  {
    "text": "ide i in the past i had different positions like network",
    "start": "19199",
    "end": "26320"
  },
  {
    "text": "engineer architect also developer for both back end and frontman",
    "start": "26320",
    "end": "31679"
  },
  {
    "text": "and different applications then i move to the security field",
    "start": "31679",
    "end": "38160"
  },
  {
    "text": "i am one of the author of the raiden that will be presented",
    "start": "38160",
    "end": "43520"
  },
  {
    "text": "today i also had a pleasure to present in different conferences",
    "start": "43520",
    "end": "49840"
  },
  {
    "text": "uh usa like hardware io or in europe and in poland",
    "start": "49840",
    "end": "58239"
  },
  {
    "text": "and now uh i can present on the blackhead which is",
    "start": "58239",
    "end": "64640"
  },
  {
    "text": "also pleasure and nice nomination other than that",
    "start": "65439",
    "end": "72880"
  },
  {
    "text": "i mostly focused on the software and hardware side when doing security tests",
    "start": "72880",
    "end": "81200"
  },
  {
    "text": "i hold master degree and i don't have currently any certifications but in the past i had",
    "start": "81200",
    "end": "87840"
  },
  {
    "text": "also ccie from uh cisco when i was working worked as a network engineer",
    "start": "87840",
    "end": "95040"
  },
  {
    "text": "for now my current position is senior security consultant for ibm exposred",
    "start": "95040",
    "end": "104320"
  },
  {
    "text": "thank you and i'm adam laurie i also work for ibm",
    "start": "105200",
    "end": "111520"
  },
  {
    "text": "xbox red as the lead hardware hacker and i'm an associate partner here i've been",
    "start": "111520",
    "end": "118320"
  },
  {
    "text": "in this industry for over 30 years and i started in the defensive side of",
    "start": "118320",
    "end": "123920"
  },
  {
    "text": "the house the blue team and more recently have moved over to the red team",
    "start": "123920",
    "end": "129520"
  },
  {
    "text": "doing offensive security specializing in hardware and embedded systems",
    "start": "129520",
    "end": "136959"
  },
  {
    "start": "138000",
    "end": "388000"
  },
  {
    "text": "so before we begin we should talk a bit about what is raiden and actually what is",
    "start": "139680",
    "end": "146400"
  },
  {
    "text": "glitching so raiden is a glitching tool and glitching",
    "start": "146400",
    "end": "151840"
  },
  {
    "text": "is the process of introducing a fault",
    "start": "151840",
    "end": "156879"
  },
  {
    "text": "but a very precisely controlled call so normally it's done to the clock or the",
    "start": "156879",
    "end": "163840"
  },
  {
    "text": "power lines on the check but it can be induced via emp",
    "start": "163840",
    "end": "169280"
  },
  {
    "text": "or light or heat or anything that causes the device to malfunction",
    "start": "169280",
    "end": "177040"
  },
  {
    "text": "but power and clock are the most easy to control very precisely so that's where you",
    "start": "177040",
    "end": "182879"
  },
  {
    "text": "normally see it so basically what it's doing as you can see on this oscilloscope",
    "start": "182879",
    "end": "188319"
  },
  {
    "text": "trace here uh you're introducing very very short glitches or",
    "start": "188319",
    "end": "196319"
  },
  {
    "text": "drops in power at a very precisely controlled moment so if you do it precisely enough you can",
    "start": "196319",
    "end": "204080"
  },
  {
    "text": "actually corrupt a single instruction so for example if a value is being",
    "start": "204080",
    "end": "211040"
  },
  {
    "text": "loaded from memory from say flash ram into memory on the chip",
    "start": "211040",
    "end": "220080"
  },
  {
    "text": "if you glitch at just the right moment you potentially can corrupt that value so if that value is being used to check",
    "start": "220080",
    "end": "227440"
  },
  {
    "text": "um security decision like a password or a yes no um state then if you corrupt it at just",
    "start": "227440",
    "end": "235519"
  },
  {
    "text": "the right moment you can potentially override that decision and change the outcome",
    "start": "235519",
    "end": "241360"
  },
  {
    "text": "if you glitch too hard or at the wrong time essentially you can just crash the",
    "start": "241360",
    "end": "246400"
  },
  {
    "text": "device altogether so what we need is a tool that's very",
    "start": "246400",
    "end": "252319"
  },
  {
    "text": "precise and easy to control so the plan when we started looking at",
    "start": "252319",
    "end": "257840"
  },
  {
    "text": "raiden we looked at tools that were available on the market and some of them were expensive or over",
    "start": "257840",
    "end": "264960"
  },
  {
    "text": "complicated and so we wanted to just create something",
    "start": "264960",
    "end": "270400"
  },
  {
    "text": "that did everything we needed to do um but was very low cost and i'm a great",
    "start": "270400",
    "end": "276320"
  },
  {
    "text": "believer in open source i wanted to open source it happily we've been allowed to do that",
    "start": "276320",
    "end": "283280"
  },
  {
    "text": "from our employer so we will be publishing the code after this uh so yeah we wanted very low",
    "start": "283280",
    "end": "290720"
  },
  {
    "text": "cost open source um and so to do that we settled on a",
    "start": "290720",
    "end": "296320"
  },
  {
    "text": "very simple fpga design but that also means it's very easy because we're using standard verilog it's very",
    "start": "296320",
    "end": "303199"
  },
  {
    "text": "easy to port that onto other hardware so if you need a faster glitcher or a more powerful",
    "start": "303199",
    "end": "310800"
  },
  {
    "text": "processor or whatever you can just switch to a different platform and it should port pretty easily we also wanted it to be",
    "start": "310800",
    "end": "318639"
  },
  {
    "text": "independent of the um the final delivery mechanism",
    "start": "318639",
    "end": "323680"
  },
  {
    "text": "so um that the glitcher is purely for timing purposes it's not um delivering the",
    "start": "323680",
    "end": "331919"
  },
  {
    "text": "actual uh fault into the device so it controls either a power amp",
    "start": "331919",
    "end": "337039"
  },
  {
    "text": "or a power switch or an emfi uh injector or whatever um so it's only job",
    "start": "337039",
    "end": "344320"
  },
  {
    "text": "is to do the logic of when you want to glitch how often you want to glitch",
    "start": "344320",
    "end": "349600"
  },
  {
    "text": "and the width of the pulse and so on so for the hardware we settled on this",
    "start": "349600",
    "end": "356560"
  },
  {
    "text": "guy the xilinx arctic 7 known as the rt",
    "start": "356560",
    "end": "362479"
  },
  {
    "text": "very low cost very powerful board and um very easy to program",
    "start": "362560",
    "end": "370160"
  },
  {
    "text": "and to hook up you know it's got loads of as you can see it's got a",
    "start": "370160",
    "end": "375199"
  },
  {
    "text": "whole bunch of gpio ports um so very easy to connect",
    "start": "375199",
    "end": "380560"
  },
  {
    "text": "and turn greg was just gonna talk more about the actual detail of what goes on inside",
    "start": "380560",
    "end": "395840"
  },
  {
    "start": "388000",
    "end": "720000"
  },
  {
    "text": "okay let's look inside raiden so here on the screen you can see vivado",
    "start": "399280",
    "end": "404400"
  },
  {
    "text": "studio this is kind of the um that that we used to",
    "start": "404400",
    "end": "411120"
  },
  {
    "text": "create uh raiden and very low code because the the very rock is the core of the raiden",
    "start": "411120",
    "end": "418880"
  },
  {
    "text": "um the first file that i would like to show is constraints file this file this",
    "start": "418880",
    "end": "426400"
  },
  {
    "text": "defines different signals and that are used by a verilog so we can treat it as like a",
    "start": "426400",
    "end": "434720"
  },
  {
    "text": "variable name or something for standard programming languages uh but this is just an a",
    "start": "434720",
    "end": "441199"
  },
  {
    "text": "signal name that we use in uh our uh code some of the signals as we see have",
    "start": "441199",
    "end": "448000"
  },
  {
    "text": "uh additional configuration for a pull-up",
    "start": "448000",
    "end": "453280"
  },
  {
    "text": "which is required to handle correctly the signals",
    "start": "453280",
    "end": "460080"
  },
  {
    "text": "the top module is a module that has ins that has instances of different",
    "start": "461360",
    "end": "468160"
  },
  {
    "text": "um of different modules and",
    "start": "468160",
    "end": "476000"
  },
  {
    "text": "here we have definition of our output and input signals based on the",
    "start": "476000",
    "end": "482080"
  },
  {
    "text": "constraint file we have some wires that",
    "start": "482080",
    "end": "488479"
  },
  {
    "text": "wire our signals with with the registers here we have like commands module",
    "start": "488479",
    "end": "496319"
  },
  {
    "text": "which is responsible to to handle all the commands and over uart uh to the raiden",
    "start": "496319",
    "end": "504800"
  },
  {
    "text": "and it's getting some inputs and giving some outputs that are used by different modules",
    "start": "504800",
    "end": "510319"
  },
  {
    "text": "like the most one imported which is a glitch module here so the glitch",
    "start": "510319",
    "end": "518080"
  },
  {
    "text": "glitch is instance of the glitch module and it gets like delay with count the gap",
    "start": "518080",
    "end": "525279"
  },
  {
    "text": "restart marks and other register values that are handled inside",
    "start": "525279",
    "end": "533519"
  },
  {
    "text": "and based on the values that we are uh want to want to send and use in",
    "start": "533519",
    "end": "539839"
  },
  {
    "text": "radian uh modulus responsing responding on that in the inner state machine",
    "start": "539839",
    "end": "548160"
  },
  {
    "text": "uh this is just a pwm uh instances just for lead indication",
    "start": "548160",
    "end": "554959"
  },
  {
    "text": "and some kind of uh debugging what's going on so",
    "start": "554959",
    "end": "562800"
  },
  {
    "text": "top module as i mentioned have in instances of the modules but if we",
    "start": "562800",
    "end": "569120"
  },
  {
    "text": "look on on specific modules like command we can see that it also",
    "start": "569120",
    "end": "577120"
  },
  {
    "text": "have some other instances from the receive and transmit",
    "start": "577120",
    "end": "582160"
  },
  {
    "text": "uh modules these these are uh created by chiptradis",
    "start": "582160",
    "end": "587519"
  },
  {
    "text": "and modified by us uh for for our uh needs so we didn't like",
    "start": "587519",
    "end": "594160"
  },
  {
    "text": "create a wheel from from from the beginning again",
    "start": "594160",
    "end": "600399"
  },
  {
    "text": "and invented the wheel of course so the command module role is to get",
    "start": "600800",
    "end": "610480"
  },
  {
    "text": "python sent commands which are represent by numbers",
    "start": "610480",
    "end": "618560"
  },
  {
    "text": "and based on the numbers we are uh starting proper",
    "start": "618560",
    "end": "625279"
  },
  {
    "text": "uh action in the in the state machine uh some um commands uh",
    "start": "625279",
    "end": "632000"
  },
  {
    "text": "also uh get additional data uh to be processed like for example",
    "start": "632000",
    "end": "639360"
  },
  {
    "text": "with or delay you need to specify how how much delay or what should be the bleach width",
    "start": "639360",
    "end": "645279"
  },
  {
    "text": "or glitch count and so on in order to to make your glitching attack",
    "start": "645279",
    "end": "654959"
  },
  {
    "text": "and command module has a big uh state machine that is actually",
    "start": "654959",
    "end": "661360"
  },
  {
    "text": "just handling or the all the commands",
    "start": "661360",
    "end": "667279"
  },
  {
    "text": "the glitch module itself uh it's more complicated uh because it has some",
    "start": "667279",
    "end": "675839"
  },
  {
    "text": "signals that needs to match specific condition in order to",
    "start": "677120",
    "end": "682320"
  },
  {
    "text": "to be set and we don't have enough time to discuss",
    "start": "682320",
    "end": "688079"
  },
  {
    "text": "everything what's in the glitch module but from the top",
    "start": "688079",
    "end": "693920"
  },
  {
    "text": "uh view uh this is how the the raden was created we have command module glitch module uh",
    "start": "693920",
    "end": "702800"
  },
  {
    "text": "and actually these are the the most important ones that are our core",
    "start": "702800",
    "end": "713440"
  },
  {
    "text": "and that's all about inner side of the writing thank you",
    "start": "714320",
    "end": "731839"
  },
  {
    "start": "720000",
    "end": "1036000"
  },
  {
    "text": "okay so let's look on the front and side of the raiden so this is our python api um",
    "start": "733120",
    "end": "740399"
  },
  {
    "text": "this is the core module uh which is which is not long i mean we",
    "start": "740399",
    "end": "746800"
  },
  {
    "text": "our goal was to create very simple uh python um code available for for",
    "start": "746800",
    "end": "753519"
  },
  {
    "text": "everyone uh to easily understand and use raiden",
    "start": "753519",
    "end": "758959"
  },
  {
    "text": "so uh here we have a class raiden uh with an indeed function which",
    "start": "758959",
    "end": "764320"
  },
  {
    "text": "actually actually just creates an uart connection the serial connection here we just specify",
    "start": "764320",
    "end": "771200"
  },
  {
    "text": "when we are creating instance of this class specify",
    "start": "771200",
    "end": "776800"
  },
  {
    "text": "serial port we want to connect if you want to have some debug output",
    "start": "777279",
    "end": "785040"
  },
  {
    "text": "to track what's going on and the ticks uh define if you want to use um clock ticks",
    "start": "785040",
    "end": "792000"
  },
  {
    "text": "um to set some values or we want to use that in seconds",
    "start": "792000",
    "end": "800720"
  },
  {
    "text": "here we have a dictionary with all available uh commands and earlier i presented",
    "start": "800720",
    "end": "808639"
  },
  {
    "text": "numbers that represent commands and this is actually a front end that has exactly the same uh information so",
    "start": "808639",
    "end": "815600"
  },
  {
    "text": "the value is just a number uh that we are sending and it triggers the proper",
    "start": "815600",
    "end": "820720"
  },
  {
    "text": "uh command handling on on the back end of the raiden",
    "start": "820720",
    "end": "825839"
  },
  {
    "text": "uh here we have a function to send rating uh commands um",
    "start": "825839",
    "end": "833120"
  },
  {
    "text": "some of the some of the commands are just an ascii that that we want to to receive",
    "start": "833120",
    "end": "839600"
  },
  {
    "text": "and we have one byte command handling and four byte command handling",
    "start": "839600",
    "end": "845519"
  },
  {
    "text": "um these are um the key values from from the dictionary",
    "start": "845519",
    "end": "851920"
  },
  {
    "text": "uh that use a single byte command so we are just packing them as a single byte and send them over",
    "start": "851920",
    "end": "858160"
  },
  {
    "text": "the wire to raiden and here we have four byte commands uh handling",
    "start": "858160",
    "end": "866880"
  },
  {
    "text": "where we are sending four bytes over wire and these are specific",
    "start": "867199",
    "end": "872560"
  },
  {
    "text": "commands um what else uh we have also",
    "start": "872560",
    "end": "877600"
  },
  {
    "text": "possibilities for some commands to set the value like glitch delay or",
    "start": "877600",
    "end": "882720"
  },
  {
    "text": "count or restart or max or whatever if they are actually if they are",
    "start": "882720",
    "end": "891440"
  },
  {
    "text": "yeah and this is the arm so if you want to actually",
    "start": "892880",
    "end": "899440"
  },
  {
    "text": "arm our radian to be ready to for glitching",
    "start": "899440",
    "end": "907519"
  },
  {
    "text": "possibility to set target power on off um this is just kind of the flux that",
    "start": "907600",
    "end": "914399"
  },
  {
    "text": "was spending and checking the our uh flux and actually it's it's all the last one is just a build",
    "start": "914399",
    "end": "921279"
  },
  {
    "text": "time when we want to receive the latest information about the code and when it when it were",
    "start": "921279",
    "end": "928800"
  },
  {
    "text": "compiled okay",
    "start": "928800",
    "end": "932720"
  },
  {
    "text": "if we here we have bunch of examples for different applications we use raiding for um",
    "start": "933920",
    "end": "941759"
  },
  {
    "text": "here are interesting one with the usb and this actually used the file whisperer",
    "start": "941759",
    "end": "949759"
  },
  {
    "text": "here i have it um so it's ui uh hardware usb trigger",
    "start": "949759",
    "end": "957519"
  },
  {
    "text": "and it actually works perfectly with with a raiden uh and uh enabling the raid itself",
    "start": "957519",
    "end": "964720"
  },
  {
    "text": "very very um very simple we just set params first we",
    "start": "964720",
    "end": "971279"
  },
  {
    "text": "like arming to zero which means we don't we disarm actually",
    "start": "971279",
    "end": "977120"
  },
  {
    "text": "uh raiden reset all the parameter states and everything from from uh from fpga then we are sending",
    "start": "977120",
    "end": "985120"
  },
  {
    "text": "whatever commands we want arm it we can use to use it to power on power",
    "start": "985120",
    "end": "991120"
  },
  {
    "text": "off and this is just five whisperer called and we just wait in the loop until we're",
    "start": "991120",
    "end": "998480"
  },
  {
    "text": "right then it's not finished uh his cycle just passing and when waiting until the trigger uh triggering",
    "start": "998480",
    "end": "1007199"
  },
  {
    "text": "actually trigger right into to set a glitching based on",
    "start": "1007199",
    "end": "1014079"
  },
  {
    "text": "this um trigger condition saved by the f5 uh whisperer we also use it standalone",
    "start": "1014079",
    "end": "1021040"
  },
  {
    "text": "adam major will present uh in his demo",
    "start": "1021040",
    "end": "1026160"
  },
  {
    "text": "and yeah that's that's all about um raiden",
    "start": "1026160",
    "end": "1033918"
  },
  {
    "start": "1036000",
    "end": "1171000"
  },
  {
    "text": "frontend now let's talk about writing pinout so if we look on the writing board um",
    "start": "1036839",
    "end": "1045520"
  },
  {
    "text": "we decide to utilize basically input and output connections to",
    "start": "1045520",
    "end": "1052880"
  },
  {
    "text": "external shields like arduino because they are easily accessible and they have also",
    "start": "1052880",
    "end": "1059760"
  },
  {
    "text": "protected resistors so it's",
    "start": "1059760",
    "end": "1064640"
  },
  {
    "text": "it's better to to utilize this io first let's talk about external",
    "start": "1064799",
    "end": "1073120"
  },
  {
    "text": "connections um this is where we can",
    "start": "1073120",
    "end": "1078960"
  },
  {
    "text": "get a trigger in to the raiden and glitch based on the",
    "start": "1079440",
    "end": "1086400"
  },
  {
    "text": "signal received on io29 um other ios we see that",
    "start": "1086400",
    "end": "1093919"
  },
  {
    "text": "like reset out or invert glitch they are used for other applications",
    "start": "1093919",
    "end": "1101200"
  },
  {
    "text": "that we will also talk about later",
    "start": "1101200",
    "end": "1105600"
  },
  {
    "text": "but the most important is triggering uh in this case uh here we have a connection with",
    "start": "1106240",
    "end": "1114400"
  },
  {
    "text": "internal trigger we call it integer trigger but this is actually the reset out signal",
    "start": "1114400",
    "end": "1119840"
  },
  {
    "text": "send and generate from the raiden to the target board",
    "start": "1119840",
    "end": "1126880"
  },
  {
    "text": "reset signal actually mostly so in this connection",
    "start": "1126880",
    "end": "1134000"
  },
  {
    "text": "what is required is to connect 3.3 volt output pin available on the raden to the",
    "start": "1134000",
    "end": "1141440"
  },
  {
    "text": "triggering um directly so we are creating here like",
    "start": "1141440",
    "end": "1146480"
  },
  {
    "text": "a bridge um and the reset out signal needs to be connected to the",
    "start": "1146480",
    "end": "1153440"
  },
  {
    "text": "reset of the target device this will allow us to",
    "start": "1153440",
    "end": "1159360"
  },
  {
    "text": "uh create our own internal reset out and based on that we can make an",
    "start": "1159360",
    "end": "1165919"
  },
  {
    "text": "actions uh to perform glitching",
    "start": "1165919",
    "end": "1171440"
  },
  {
    "start": "1171000",
    "end": "1479000"
  },
  {
    "text": "so uh if we look on the raiden",
    "start": "1171440",
    "end": "1176639"
  },
  {
    "text": "applications uh the first one is a connection to the",
    "start": "1176840",
    "end": "1182559"
  },
  {
    "text": "max four six one nine cpe uh it's very common uh switch uh",
    "start": "1182559",
    "end": "1189280"
  },
  {
    "text": "used uh in many other solutions like uh cheap fair guys uh project",
    "start": "1189280",
    "end": "1197600"
  },
  {
    "text": "this is our glitching front end and in order for it to work uh what",
    "start": "1197600",
    "end": "1204080"
  },
  {
    "text": "which what is required is our proper connections so um we need two power supplies",
    "start": "1204080",
    "end": "1212320"
  },
  {
    "text": "um or one power supply with a lot of uh available",
    "start": "1212320",
    "end": "1220240"
  },
  {
    "text": "signals but we utilize here two power supplies in this setup",
    "start": "1221280",
    "end": "1229600"
  },
  {
    "text": "and one power supply is providing",
    "start": "1229600",
    "end": "1234720"
  },
  {
    "text": "target core vdd and the second one is used for the glitch signal that we can",
    "start": "1235360",
    "end": "1241440"
  },
  {
    "text": "handle and the amplitude of the signal so whenever we'll drop or raise up",
    "start": "1241440",
    "end": "1250159"
  },
  {
    "text": "voltage on power supply one this is how it should be affected on the oscilloscope",
    "start": "1250159",
    "end": "1255840"
  },
  {
    "text": "and also in the glitch signal uh finally uh watching which what also",
    "start": "1255840",
    "end": "1262640"
  },
  {
    "text": "is required here is a connection of the uh out signal",
    "start": "1262640",
    "end": "1269840"
  },
  {
    "text": "which is basically our glitch out signal is on um io15",
    "start": "1269840",
    "end": "1276000"
  },
  {
    "text": "on the pin 15 actually on the on the max and it's when we are connecting it",
    "start": "1276000",
    "end": "1281120"
  },
  {
    "text": "somewhere to the uh core voltage of the glitch",
    "start": "1281120",
    "end": "1286880"
  },
  {
    "text": "device the glitch out signal io 41 is connected to pin 10",
    "start": "1286960",
    "end": "1294400"
  },
  {
    "text": "and il 29 triggering is connected to the trigger out signal",
    "start": "1294400",
    "end": "1299520"
  },
  {
    "text": "of the target board",
    "start": "1299520",
    "end": "1304720"
  },
  {
    "text": "uh other connections uh that we tested and support this connection to the emfi device like ui",
    "start": "1304720",
    "end": "1310720"
  },
  {
    "text": "chip shelter and in order to utilize it um we need to use advanced breakout",
    "start": "1310720",
    "end": "1317760"
  },
  {
    "text": "board and of course have a cheap shower available but i tested this signal on one",
    "start": "1317760",
    "end": "1324480"
  },
  {
    "text": "this setup on the one of the projects and it worked perfectly giving a nice results so",
    "start": "1324480",
    "end": "1332559"
  },
  {
    "text": "uh in this case what is required we first need to power all somehow power on the board we can do it",
    "start": "1332559",
    "end": "1339200"
  },
  {
    "text": "from a right end from the 3.3 volt outage signal available or from some other external",
    "start": "1339200",
    "end": "1346960"
  },
  {
    "text": "power supply we need to connect io 38 it's important 38 which is inverting our",
    "start": "1346960",
    "end": "1354320"
  },
  {
    "text": "glitch which which is required actually for the chip shelter to handle it correctly",
    "start": "1354320",
    "end": "1360159"
  },
  {
    "text": "and we are connecting into the hardware triggering",
    "start": "1360159",
    "end": "1365120"
  },
  {
    "text": "sorry we are connecting the hs2 in which is basically a clock in",
    "start": "1365360",
    "end": "1371200"
  },
  {
    "text": "on the advanced breakup board and we need to open this pin on the switch",
    "start": "1371200",
    "end": "1378000"
  },
  {
    "text": "available on the breakout board i will show that in a minute on the next slide and from",
    "start": "1378000",
    "end": "1385120"
  },
  {
    "text": "available out port which is",
    "start": "1386159",
    "end": "1391310"
  },
  {
    "text": "[Music] we we connected to the trigger in hardware triggering on the new",
    "start": "1391310",
    "end": "1397840"
  },
  {
    "text": "chip shutter in this setup we are not utilizing like a cpu uh possibility of the new eye",
    "start": "1397840",
    "end": "1406080"
  },
  {
    "text": "instead using the codes um on the on the cpu we're just using a chip shelter",
    "start": "1406080",
    "end": "1412400"
  },
  {
    "text": "as pure emfi uh device right with",
    "start": "1412400",
    "end": "1419679"
  },
  {
    "text": "emfi pro this is basically actually our probe and internally the trigger hardware",
    "start": "1419679",
    "end": "1425120"
  },
  {
    "text": "triggering is connected directly to the um to the",
    "start": "1425120",
    "end": "1431360"
  },
  {
    "text": "out probe of the emfi and this is a breakout board here we see the yellow cable uh is",
    "start": "1431360",
    "end": "1438640"
  },
  {
    "text": "connecting io38 to hs2 on cheap chip whisperer",
    "start": "1438640",
    "end": "1446640"
  },
  {
    "text": "side let's say of the breaker board and here on the switch we are opening hs2",
    "start": "1446640",
    "end": "1455679"
  },
  {
    "text": "to provide connection from here over the switch",
    "start": "1456159",
    "end": "1463760"
  },
  {
    "text": "to uh this connection out which is connecting to",
    "start": "1463760",
    "end": "1469520"
  },
  {
    "text": "uh to the cheap shoulder and yeah that's all about",
    "start": "1469520",
    "end": "1477679"
  },
  {
    "start": "1479000",
    "end": "1691000"
  },
  {
    "text": "connections",
    "start": "1484840",
    "end": "1487840"
  },
  {
    "text": "one of the things you need to be able to do is actually see if your glitch is having an effect",
    "start": "1491520",
    "end": "1498000"
  },
  {
    "text": "so one thing you can do is um create code that runs on a chip and play with",
    "start": "1498000",
    "end": "1505200"
  },
  {
    "text": "it before you actually attack a target so this is um a little",
    "start": "1505200",
    "end": "1511520"
  },
  {
    "text": "sort of mini application that i wrote that runs on the lpc11u24",
    "start": "1511520",
    "end": "1517360"
  },
  {
    "text": "and it gives you a little menu and you can do stuff like um set the code protection level and",
    "start": "1517360",
    "end": "1523679"
  },
  {
    "text": "dump out the boot rom and stuff like that a few useful little things",
    "start": "1523679",
    "end": "1529120"
  },
  {
    "text": "but the main purpose is this glitch test so basically what the glitch test does",
    "start": "1529120",
    "end": "1534880"
  },
  {
    "text": "is it gives you a way of checking if your glitch is actually having an effect",
    "start": "1534880",
    "end": "1541600"
  },
  {
    "text": "so if i go into glitch test mode um what it's doing is it's reading um",
    "start": "1541600",
    "end": "1548720"
  },
  {
    "text": "the crp value from flash which at the moment is not set it's all s",
    "start": "1548720",
    "end": "1554240"
  },
  {
    "text": "but for the purpose of testing you really don't care what you're changing it from or to you're just checking that you can change",
    "start": "1554240",
    "end": "1561200"
  },
  {
    "text": "it so um if i if i read anything other than fff",
    "start": "1561200",
    "end": "1567360"
  },
  {
    "text": "from the flash then i'd successfully glitched so when you're actually running the test",
    "start": "1567360",
    "end": "1573039"
  },
  {
    "text": "what it does is every time you hit a g every time you send a g over the serial",
    "start": "1573039",
    "end": "1578880"
  },
  {
    "text": "it will bring a gpio line high which you can use um synchronize your",
    "start": "1578880",
    "end": "1584799"
  },
  {
    "text": "glitcher to actually trigger your glitcher it'll then do the comparison and then it will",
    "start": "1584799",
    "end": "1590320"
  },
  {
    "text": "bring it low again so you can write a script that basically does that sends a g",
    "start": "1590320",
    "end": "1596240"
  },
  {
    "text": "glitches at an offset from when that line goes high uh and checks the the response to see if",
    "start": "1596240",
    "end": "1602799"
  },
  {
    "text": "you get a match or a mismatch so if i hit g i'll just get dots because it's always",
    "start": "1602799",
    "end": "1608880"
  },
  {
    "text": "going to match because i'm not currently glitching but if we automate that process and i've",
    "start": "1608880",
    "end": "1614799"
  },
  {
    "text": "got a script here which is just going to do that in a loop",
    "start": "1614799",
    "end": "1621279"
  },
  {
    "text": "so with a bunch of different settings so different delays number of ticks from",
    "start": "1621279",
    "end": "1627520"
  },
  {
    "text": "when the line goes high different number of um pulses in the glitch",
    "start": "1627520",
    "end": "1633600"
  },
  {
    "text": "and different widths of pulse just going to try a few things until it",
    "start": "1633600",
    "end": "1638960"
  },
  {
    "text": "gets a positive response from the glitch test if i come out of here and actually run",
    "start": "1638960",
    "end": "1646000"
  },
  {
    "text": "that what we should see on the scope um",
    "start": "1646000",
    "end": "1655520"
  },
  {
    "text": "what we should see on the scope is um you see the pulses uh changing number of pulses that we're",
    "start": "1655520",
    "end": "1661840"
  },
  {
    "text": "sending so as we send each glitch we can see that we're actually having an effect and",
    "start": "1661840",
    "end": "1667760"
  },
  {
    "text": "at some point we we get success so at a delay of 10",
    "start": "1667760",
    "end": "1673520"
  },
  {
    "text": "with a width of three and a count of six pulses we successfully corrupted that memory",
    "start": "1673520",
    "end": "1680640"
  },
  {
    "text": "and the comparison failed so we successfully glitched our check",
    "start": "1680640",
    "end": "1697840"
  },
  {
    "start": "1691000",
    "end": "1929000"
  },
  {
    "text": "so right in the battle i would like to show you one of the interesting findings this",
    "start": "1703679",
    "end": "1710159"
  },
  {
    "text": "year it was part of the research we've done with major",
    "start": "1710159",
    "end": "1715440"
  },
  {
    "text": "and it was about usb stack security last year",
    "start": "1715440",
    "end": "1722320"
  },
  {
    "text": "ui company released um a great hardwood trigger called file whisperer and",
    "start": "1722320",
    "end": "1730399"
  },
  {
    "text": "it it put our attention on it and we started figure out how we can use it",
    "start": "1730399",
    "end": "1736799"
  },
  {
    "text": "and utilize it together with raiden to get something interesting research",
    "start": "1736799",
    "end": "1746080"
  },
  {
    "text": "so we started with selecting a target and",
    "start": "1746080",
    "end": "1754080"
  },
  {
    "text": "our choice um go for stm32 the wb 55",
    "start": "1754080",
    "end": "1761679"
  },
  {
    "text": "it's popular nuclear ostn board it's the newest one that supports also",
    "start": "1761679",
    "end": "1767600"
  },
  {
    "text": "bluetooth zb and stuff like that and we start in searching uh",
    "start": "1767600",
    "end": "1775440"
  },
  {
    "text": "information what usb stock it's using and we found that entire line of stm",
    "start": "1775440",
    "end": "1785279"
  },
  {
    "text": "32 microcontrollers use the same usb stack so if there will be any issue",
    "start": "1785279",
    "end": "1791440"
  },
  {
    "text": "there this will probably affect more than just one micro controller",
    "start": "1791440",
    "end": "1799600"
  },
  {
    "text": "uh here we of course see um a screen showing that that we connected",
    "start": "1800080",
    "end": "1806960"
  },
  {
    "text": "device to pc and we also uploaded the code",
    "start": "1806960",
    "end": "1814240"
  },
  {
    "text": "to microcontroller to simulate for example a joystick or whatever usb",
    "start": "1814240",
    "end": "1821600"
  },
  {
    "text": "device we wanted so before we'll go um to the details of",
    "start": "1821600",
    "end": "1829279"
  },
  {
    "text": "our finding we want to first show some information",
    "start": "1829279",
    "end": "1834880"
  },
  {
    "text": "about usb descriptors because this is the very important point of the research",
    "start": "1834880",
    "end": "1842720"
  },
  {
    "text": "so usb descriptor descriptors are just small messages sent of the",
    "start": "1842720",
    "end": "1847840"
  },
  {
    "text": "over a usb bus and they are used for different uh things",
    "start": "1847840",
    "end": "1855279"
  },
  {
    "text": "one of them is just sending control messages and other also can be used to to send some data",
    "start": "1855279",
    "end": "1863519"
  },
  {
    "text": "and the most important field in the usb descriptor is wland field",
    "start": "1863519",
    "end": "1871600"
  },
  {
    "text": "it's it has 16 bits which mean uh potentially we should be",
    "start": "1871600",
    "end": "1879279"
  },
  {
    "text": "able to send up to six five sixty five thousand five thirty five uh",
    "start": "1879279",
    "end": "1887120"
  },
  {
    "text": "bytes but mostly uh we don't need",
    "start": "1887120",
    "end": "1895039"
  },
  {
    "text": "this amount of data when we are just sending um when the w length field is calculated",
    "start": "1895039",
    "end": "1902799"
  },
  {
    "text": "of the usb descriptor message so we started looking",
    "start": "1902799",
    "end": "1909840"
  },
  {
    "text": "for a code for any queries or points where",
    "start": "1909840",
    "end": "1917919"
  },
  {
    "text": "this length is checked or not checked and how it's used",
    "start": "1917919",
    "end": "1924080"
  },
  {
    "text": "by a code and we found",
    "start": "1924480",
    "end": "1931679"
  },
  {
    "text": "very interesting point it was under usb",
    "start": "1931679",
    "end": "1938720"
  },
  {
    "text": "uh heat descriptor class and also for the the same",
    "start": "1938720",
    "end": "1945440"
  },
  {
    "text": "actually was for the other dfu",
    "start": "1945440",
    "end": "1952080"
  },
  {
    "text": "class and if you look on the line 499 try and",
    "start": "1952080",
    "end": "1959440"
  },
  {
    "text": "zoom that a little bit uh we can see a min function and also on the line",
    "start": "1959440",
    "end": "1967159"
  },
  {
    "text": "500 0 5 which actually it's trying to get the",
    "start": "1967159",
    "end": "1973200"
  },
  {
    "text": "minimum value between the volunt that is read from a packet",
    "start": "1973200",
    "end": "1979279"
  },
  {
    "text": "and some configured",
    "start": "1979279",
    "end": "1984399"
  },
  {
    "text": "static variable uh defined in the code so where is the problem well",
    "start": "1984720",
    "end": "1994000"
  },
  {
    "text": "if we look on the code itself it doesn't it doesn't look bad right because we have some meaning",
    "start": "1994000",
    "end": "1999440"
  },
  {
    "text": "function that is doing this this check what if we'll be able to corrupt this",
    "start": "1999440",
    "end": "2006320"
  },
  {
    "text": "function we have a code um so nothing stop us",
    "start": "2006320",
    "end": "2011600"
  },
  {
    "text": "from for example selecting one of the io ports",
    "start": "2011600",
    "end": "2016840"
  },
  {
    "text": "on the target board use it to set the trigger",
    "start": "2016840",
    "end": "2022720"
  },
  {
    "text": "just a little bit after or before the the one or the second function",
    "start": "2022720",
    "end": "2029440"
  },
  {
    "text": "and try to to to send a glitch that will finally",
    "start": "2029440",
    "end": "2036000"
  },
  {
    "text": "corrupt this function and maybe uh the the size we will send and craft",
    "start": "2036000",
    "end": "2042640"
  },
  {
    "text": "in our usb message will overwrite whatever",
    "start": "2042640",
    "end": "2048480"
  },
  {
    "text": "whatever was before so let's look on the research setup",
    "start": "2048639",
    "end": "2056638"
  },
  {
    "text": "so here we see bunch of the devices starting from the left left top corner",
    "start": "2056639",
    "end": "2065520"
  },
  {
    "text": "we can see raspberry pi it could be also pc is just used to connect file whisperer",
    "start": "2065520",
    "end": "2072320"
  },
  {
    "text": "and other devices like our raiden",
    "start": "2072320",
    "end": "2078240"
  },
  {
    "text": "chip shouter to to together right to give it the power",
    "start": "2078240",
    "end": "2085440"
  },
  {
    "text": "uart access and so on so um",
    "start": "2085440",
    "end": "2091118"
  },
  {
    "text": "in the earlier slides i presented the option how we can connect emfi",
    "start": "2091119",
    "end": "2096638"
  },
  {
    "text": "device and this is this is one of the setup so we know already how to connect over",
    "start": "2096639",
    "end": "2102079"
  },
  {
    "text": "breakout board the chip shelter to the raiden and",
    "start": "2102079",
    "end": "2109520"
  },
  {
    "text": "this is and additionally we added five whisperer for usb triggering because we want to",
    "start": "2109520",
    "end": "2114800"
  },
  {
    "text": "trigger on specific usb messages",
    "start": "2114800",
    "end": "2121839"
  },
  {
    "text": "before we were actually glitch in the point where we want um",
    "start": "2121920",
    "end": "2128480"
  },
  {
    "text": "under the mean function so let's uh let's look",
    "start": "2128480",
    "end": "2135520"
  },
  {
    "text": "how how it worked i mean i recorded",
    "start": "2135520",
    "end": "2141920"
  },
  {
    "text": "a video uh because you know from from reaching is unpredictable i mean it",
    "start": "2142800",
    "end": "2148560"
  },
  {
    "text": "could take 10 minutes it could take one hour it could take days so",
    "start": "2148560",
    "end": "2154640"
  },
  {
    "text": "um i pre i pre-recorded and actually just cut out um",
    "start": "2154640",
    "end": "2161440"
  },
  {
    "text": "the most important part of the of the glitching process because um",
    "start": "2161440",
    "end": "2168640"
  },
  {
    "text": "otherwise the video could be too long so let's go for it i will now",
    "start": "2168640",
    "end": "2177119"
  },
  {
    "start": "2173000",
    "end": "2567000"
  },
  {
    "text": "run it",
    "start": "2179839",
    "end": "2187839"
  },
  {
    "text": "and here we can see at the beginning an exception control transfer",
    "start": "2191520",
    "end": "2199760"
  },
  {
    "text": "error no such device and it was this disconnected this these are these are just resets",
    "start": "2199760",
    "end": "2206000"
  },
  {
    "text": "uh sent from phi uh whisperer uh to the target board for because each",
    "start": "2206000",
    "end": "2212720"
  },
  {
    "text": "time the glitch is not success we want to restart device and start from scratch",
    "start": "2212720",
    "end": "2217760"
  },
  {
    "text": "so in the here um on the bottom we can see delay",
    "start": "2217760",
    "end": "2226640"
  },
  {
    "text": "some delay set with and repeat and this delay will change",
    "start": "2226640",
    "end": "2233359"
  },
  {
    "text": "during um test process now it's like 3402",
    "start": "2233359",
    "end": "2240640"
  },
  {
    "text": "and we go go go forward until we finally hit",
    "start": "2240640",
    "end": "2248160"
  },
  {
    "text": "our um io under the mean function that that we",
    "start": "2248160",
    "end": "2256480"
  },
  {
    "text": "configured and here we get like 6 5 65 000 bytes of the data",
    "start": "2256480",
    "end": "2264160"
  },
  {
    "text": "so if we will just do a quick hex dump",
    "start": "2264160",
    "end": "2270800"
  },
  {
    "text": "on on this of the information we just received we can see a bunch of good bytes which",
    "start": "2270800",
    "end": "2277599"
  },
  {
    "text": "means we corrupted the mean function and actually we received more data than we expected",
    "start": "2277599",
    "end": "2285200"
  },
  {
    "text": "over usb and this data could be anything",
    "start": "2285200",
    "end": "2291200"
  },
  {
    "text": "um it could be some information about secret secret key stored",
    "start": "2291200",
    "end": "2299520"
  },
  {
    "text": "the the severity of the problem uh depends on what was after the usb descriptors",
    "start": "2300160",
    "end": "2308720"
  },
  {
    "text": "structures so if there is some memory chart there and there will be",
    "start": "2308720",
    "end": "2315200"
  },
  {
    "text": "uh sensitive information it will be speed out over uh usb and that's that's definitely",
    "start": "2315200",
    "end": "2322720"
  },
  {
    "text": "a vulnerability that that we can",
    "start": "2322720",
    "end": "2327838"
  },
  {
    "text": "that we can use okay so let's now uh",
    "start": "2328079",
    "end": "2334400"
  },
  {
    "text": "look on on the code i mean because i mentioned earlier that",
    "start": "2334400",
    "end": "2340480"
  },
  {
    "text": "integration between raden and all the third party devices is easy and i want to to prove it on on python",
    "start": "2341200",
    "end": "2348720"
  },
  {
    "text": "on simple python script that actually executed what we were able to",
    "start": "2348720",
    "end": "2354000"
  },
  {
    "text": "see on the recorded video so let me quickly go to the terminal",
    "start": "2354000",
    "end": "2364560"
  },
  {
    "text": "and let's look on the code so here we have a function i utilized",
    "start": "2364560",
    "end": "2372720"
  },
  {
    "text": "here file whisperer possibility to to make",
    "start": "2372720",
    "end": "2377760"
  },
  {
    "text": "restarts i mean power on power of device uh here we have a radian a configuration",
    "start": "2377760",
    "end": "2386000"
  },
  {
    "text": "for a uart here we have chip shelter uart connectivity and",
    "start": "2386000",
    "end": "2393839"
  },
  {
    "text": "um also we have configuration for the file whisperer so",
    "start": "2393839",
    "end": "2401359"
  },
  {
    "text": "what is most important uh in this setup is that everything needs to be in the",
    "start": "2401359",
    "end": "2407119"
  },
  {
    "text": "correct order so we first like reset all the state of the",
    "start": "2407119",
    "end": "2412480"
  },
  {
    "text": "radam um put required parameters we want to use during um glitching there is some information",
    "start": "2412480",
    "end": "2420480"
  },
  {
    "text": "that should be printed as as a debug uh when",
    "start": "2420480",
    "end": "2425680"
  },
  {
    "text": "when the glitch is is going it was not on the video because i mean this this addition to the code",
    "start": "2425680",
    "end": "2432160"
  },
  {
    "text": "was written later than the video was recorded here we have setup for the file",
    "start": "2432160",
    "end": "2439040"
  },
  {
    "text": "whisperer and the most important part is a pattern",
    "start": "2439040",
    "end": "2444400"
  },
  {
    "text": "so these are just divides on the usb buys if there will be seen it",
    "start": "2444400",
    "end": "2451440"
  },
  {
    "text": "will it will be triggered the fireworks will be triggered uh i o four high",
    "start": "2451440",
    "end": "2458800"
  },
  {
    "text": "which will also trigger our raiden and of course um",
    "start": "2458800",
    "end": "2465200"
  },
  {
    "text": "it will be for this uh this will be forwarded to the emfi which will inject um",
    "start": "2465200",
    "end": "2473119"
  },
  {
    "text": "electromagnetic field changes so here we are arming uh file whisperer",
    "start": "2473119",
    "end": "2481599"
  },
  {
    "text": "and this is the packet we are sending so uh we are",
    "start": "2481599",
    "end": "2488240"
  },
  {
    "text": "sending this usb message and we are requesting this this length so normally this will not be",
    "start": "2488240",
    "end": "2495440"
  },
  {
    "text": "accepted but during the bleaching literal success we were able to see actually that",
    "start": "2495440",
    "end": "2501599"
  },
  {
    "text": "we can get this amount of data that we request we request over",
    "start": "2501599",
    "end": "2508160"
  },
  {
    "text": "usb back to us and here we have like infinite loop",
    "start": "2508160",
    "end": "2514000"
  },
  {
    "text": "waiting until ryden would not finish its cycle if it's not success then we",
    "start": "2514000",
    "end": "2519520"
  },
  {
    "text": "pass and start start over so we can see that it's very easy to to",
    "start": "2519520",
    "end": "2526960"
  },
  {
    "text": "to actually use with python three devices fire whisperer ship",
    "start": "2526960",
    "end": "2532800"
  },
  {
    "text": "shelter and the raiden and they perfectly synchronized to to do",
    "start": "2532800",
    "end": "2538720"
  },
  {
    "text": "their job okay um so that's that's about this",
    "start": "2538720",
    "end": "2545280"
  },
  {
    "text": "vulnerability we of course have cve4 and after we release after release",
    "start": "2545280",
    "end": "2554160"
  },
  {
    "text": "rating code we also release these examples and they will be publicly available",
    "start": "2554160",
    "end": "2561680"
  },
  {
    "text": "thank you",
    "start": "2561680",
    "end": "2565838"
  }
]