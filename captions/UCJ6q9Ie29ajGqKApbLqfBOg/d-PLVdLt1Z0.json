[
  {
    "start": "0",
    "end": "0"
  },
  {
    "text": "[Music]",
    "start": "860",
    "end": "9599"
  },
  {
    "text": "hi everyone my name is taoi and today i'm going to introduce our new research about the windows repairs points our",
    "start": "9599",
    "end": "15920"
  },
  {
    "text": "topic name is from logic to memory winning a solid tire in replace points you may not be unfamiliar with logic",
    "start": "15920",
    "end": "22880"
  },
  {
    "text": "issues in our points actually there are many far redirection bugs in recent years but",
    "start": "22880",
    "end": "29039"
  },
  {
    "text": "today we are going to talk something new solid tire here is a perm which has two",
    "start": "29039",
    "end": "34079"
  },
  {
    "text": "minutes the first is the default card game on windows we will introduce how we win the card game in pantone 2021 the",
    "start": "34079",
    "end": "41760"
  },
  {
    "text": "second is gemstone memory corruption issues in replace points are also a gemstone mine for researchers we'll",
    "start": "41760",
    "end": "48960"
  },
  {
    "text": "introduce all details about this new attack surface we are security researchers from pallet",
    "start": "48960",
    "end": "55760"
  },
  {
    "text": "networks we do new attack surface and system internals research from both offensive and defensive perspectives",
    "start": "55760",
    "end": "63199"
  },
  {
    "text": "we are msrc top 10 researchers and we got several hundred cves in",
    "start": "63199",
    "end": "68400"
  },
  {
    "text": "different applications we are pontoon winners and have spoken in many top different conferences",
    "start": "68400",
    "end": "75680"
  },
  {
    "text": "besides we are also patent inventors for new defense and detection techniques",
    "start": "75680",
    "end": "82479"
  },
  {
    "text": "here's our agenda there are two main parts the logic back in replace point",
    "start": "82479",
    "end": "88159"
  },
  {
    "text": "for pontoon and the memory corruption back in parts",
    "start": "88159",
    "end": "93439"
  },
  {
    "text": "points the first part will show a zero geological vulnerability which bypass",
    "start": "93439",
    "end": "99280"
  },
  {
    "text": "all current mitigations with undisclosed exploit techniques techniques and wins",
    "start": "99280",
    "end": "105759"
  },
  {
    "text": "windows eop category in ponton 2021 all details including finding the bug in",
    "start": "105759",
    "end": "111680"
  },
  {
    "text": "one day with a unique vulnerability discovery strategy root cause analysis",
    "start": "111680",
    "end": "117200"
  },
  {
    "text": "winning a seemingly impossible risk window stably as well as how to make the exploit stable enough",
    "start": "117200",
    "end": "123920"
  },
  {
    "text": "for the pantone context will be covered the second part will introduce our new",
    "start": "123920",
    "end": "128959"
  },
  {
    "text": "discoveries on this never disclosed attack service for memory corruption eop backs in",
    "start": "128959",
    "end": "135520"
  },
  {
    "text": "repulse points including the new attack service internals the interesting memory corruption",
    "start": "135520",
    "end": "142319"
  },
  {
    "text": "vulnerability examples as well as future accounting insights in repulse points",
    "start": "142319",
    "end": "150000"
  },
  {
    "start": "150000",
    "end": "150000"
  },
  {
    "text": "first what is repulse point it is a collection of user-defined data",
    "start": "150000",
    "end": "157680"
  },
  {
    "text": "which understood by application which stated the data and a file system filter",
    "start": "157680",
    "end": "164959"
  },
  {
    "text": "which read and process the data every replace point data has a reports tag",
    "start": "164959",
    "end": "172000"
  },
  {
    "text": "which represents a type of repulse point you can use device io control to get set",
    "start": "172000",
    "end": "178800"
  },
  {
    "text": "and delete replace points there are two famous repulse points symbol link and a",
    "start": "178800",
    "end": "186400"
  },
  {
    "text": "mount point there are many file redirection bugs",
    "start": "186400",
    "end": "191440"
  },
  {
    "text": "by using those two replace points it is firstly inspired by a gems for",
    "start": "191440",
    "end": "199280"
  },
  {
    "text": "show and in recent years there are over hundreds of fire redirection",
    "start": "199280",
    "end": "204640"
  },
  {
    "text": "vulnerabilities and overtaking the wild vulnerabilities",
    "start": "204640",
    "end": "211040"
  },
  {
    "text": "from from them",
    "start": "211040",
    "end": "214400"
  },
  {
    "start": "214000",
    "end": "214000"
  },
  {
    "text": "here is a classical redirection file redirection attack you can see low every",
    "start": "216400",
    "end": "222000"
  },
  {
    "text": "low privilege application communicated with high privilege application with alpc rpc and com",
    "start": "222000",
    "end": "229920"
  },
  {
    "text": "in high privilege high privilege application to file",
    "start": "229920",
    "end": "234959"
  },
  {
    "text": "operations with high privilege on low privileged user controllable files or",
    "start": "234959",
    "end": "240720"
  },
  {
    "text": "directories if they are redirected to high privileged",
    "start": "240720",
    "end": "246400"
  },
  {
    "text": "user controllable files or directories such as into system file then low",
    "start": "246400",
    "end": "251920"
  },
  {
    "text": "privilege privilege application can operate anti-system file indirectly",
    "start": "251920",
    "end": "258720"
  },
  {
    "text": "this will lead to elevation of privilege info league and the dos vulnerabilities",
    "start": "258720",
    "end": "266560"
  },
  {
    "start": "266000",
    "end": "266000"
  },
  {
    "text": "since there are too many file redirection bugs microsoft put huge",
    "start": "266560",
    "end": "271680"
  },
  {
    "text": "efforts to develop kinds of mitigations to cue these bad class",
    "start": "271680",
    "end": "277600"
  },
  {
    "text": "first diminish the attack surface cut off the connection between low",
    "start": "277600",
    "end": "282960"
  },
  {
    "text": "privileged applications and high privileged applications",
    "start": "282960",
    "end": "288400"
  },
  {
    "text": "second operate the file correctly either by operating the file handle directly or",
    "start": "288400",
    "end": "295199"
  },
  {
    "text": "with correct correct impersonation or verify if the file has a symbol link",
    "start": "295199",
    "end": "302160"
  },
  {
    "text": "third prevent the file redirection techniques directly you can see there are many",
    "start": "302160",
    "end": "308400"
  },
  {
    "text": "restrictions for soft link command point and hurling creation",
    "start": "308400",
    "end": "314400"
  },
  {
    "text": "it's very effective even all mitigations mentioned before",
    "start": "314400",
    "end": "319759"
  },
  {
    "text": "are bypassed low privileged application can operate anti-system file",
    "start": "319759",
    "end": "327280"
  },
  {
    "text": "but microsoft also did some mitigations to queue existing easy ways to execute",
    "start": "327520",
    "end": "333759"
  },
  {
    "text": "the code with system such as queue the ad agent method in diagnosis",
    "start": "333759",
    "end": "339120"
  },
  {
    "text": "service i have to say the microsoft strategy of",
    "start": "339120",
    "end": "344639"
  },
  {
    "start": "341000",
    "end": "341000"
  },
  {
    "text": "making exploitation harder is on the right way microsoft took actions in each step in",
    "start": "344639",
    "end": "351360"
  },
  {
    "text": "the full exploit chain after combination of all mitigations",
    "start": "351360",
    "end": "356800"
  },
  {
    "text": "logic backs in repressed points are decreased a lot and the exploitation of",
    "start": "356800",
    "end": "362720"
  },
  {
    "text": "logic back become more and more difficult so is it still possible for",
    "start": "362720",
    "end": "369199"
  },
  {
    "text": "a stable exploitation of the logical vulnerability in repulse points to win",
    "start": "369199",
    "end": "374800"
  },
  {
    "text": "ponchon the answer is yes although it's very hard",
    "start": "374800",
    "end": "380560"
  },
  {
    "text": "let's start the whole journey for pantone 2021 and see what kinds of magic",
    "start": "380560",
    "end": "386240"
  },
  {
    "text": "over there unique vulnerability discovery strategy",
    "start": "386240",
    "end": "391840"
  },
  {
    "start": "388000",
    "end": "388000"
  },
  {
    "text": "generates unique vulnerabilities as early as six or seven years ago we found",
    "start": "391840",
    "end": "397840"
  },
  {
    "text": "an interesting thing that engineers are not good at with doing things they make mistakes when they doing",
    "start": "397840",
    "end": "406400"
  },
  {
    "text": "revert repair reinstall redefinition reset and so on so forth",
    "start": "406400",
    "end": "411840"
  },
  {
    "text": "in the past there are several hundred critical vulnerabilities in",
    "start": "411840",
    "end": "417280"
  },
  {
    "text": "different applications in this bad class for example ie browser renderer engine",
    "start": "417280",
    "end": "423039"
  },
  {
    "text": "under redo rcu vulnerabilities we found over 100 use of the free",
    "start": "423039",
    "end": "428880"
  },
  {
    "text": "vulnerabilities from them besides",
    "start": "428880",
    "end": "434080"
  },
  {
    "text": "the flash action script browser javascript engine redefinition",
    "start": "434080",
    "end": "440000"
  },
  {
    "text": "rce vulnerabilities also a lot of vulnerabilities from this",
    "start": "440000",
    "end": "446560"
  },
  {
    "text": "and there are also eop vulnerabilities in this bad class a classical example is",
    "start": "446560",
    "end": "453280"
  },
  {
    "text": "windows installer revert eop vulnerability a patched five times",
    "start": "453280",
    "end": "459440"
  },
  {
    "text": "eop vulnerability with five cves we believe there are still many redo",
    "start": "459440",
    "end": "465280"
  },
  {
    "text": "bugs now and in the future with this unique bug hunting strategy we",
    "start": "465280",
    "end": "472080"
  },
  {
    "text": "found a reset back in microsoft solid tire collection in one day",
    "start": "472080",
    "end": "478319"
  },
  {
    "text": "you can see when we open app settings for solid tire there's a reset button",
    "start": "478319",
    "end": "484879"
  },
  {
    "text": "after we clicking the reset button ipvx service will do some interesting",
    "start": "484879",
    "end": "491360"
  },
  {
    "start": "485000",
    "end": "485000"
  },
  {
    "text": "file operations under user directory with the system",
    "start": "491360",
    "end": "498160"
  },
  {
    "text": "the file operations are from set name secret info",
    "start": "499199",
    "end": "505199"
  },
  {
    "text": "and it operates the user controllable normal user",
    "start": "505199",
    "end": "512080"
  },
  {
    "text": "controllable directory with the system so we confirm it is a vulnerable for",
    "start": "512080",
    "end": "520640"
  },
  {
    "text": "directory redirection attack for root cause abbax service will call add package data",
    "start": "520640",
    "end": "529440"
  },
  {
    "start": "523000",
    "end": "523000"
  },
  {
    "text": "access helper function to deal with the reset",
    "start": "529440",
    "end": "534880"
  },
  {
    "text": "operation it will firstly impersonate itself as system",
    "start": "534880",
    "end": "540640"
  },
  {
    "text": "and then call this function finally it will call apply security",
    "start": "540640",
    "end": "546080"
  },
  {
    "text": "descriptor function in this function genome secret info will be first called",
    "start": "546080",
    "end": "551680"
  },
  {
    "text": "to get the acl for a normal user controllable directory",
    "start": "551680",
    "end": "558560"
  },
  {
    "text": "and then attach some ecls",
    "start": "558560",
    "end": "563839"
  },
  {
    "text": "to the existing pcls after that",
    "start": "563839",
    "end": "569440"
  },
  {
    "text": "apply the updated scl back into the same directory with the",
    "start": "569440",
    "end": "574959"
  },
  {
    "text": "surname secret info if we redirect this directory to other",
    "start": "574959",
    "end": "580320"
  },
  {
    "text": "places cnm screeninfo can override the acl of a b3 directory",
    "start": "580320",
    "end": "589800"
  },
  {
    "text": "let's review the vulnerability from the",
    "start": "591279",
    "end": "597040"
  },
  {
    "text": "exploitation perspective to see if it is exploitable",
    "start": "597040",
    "end": "603360"
  },
  {
    "text": "you can see in the app user application if we reset the solid tire you can and and the fpvx service",
    "start": "603600",
    "end": "612079"
  },
  {
    "text": "will call get name screeninfo and send sending screen info so the direct",
    "start": "612079",
    "end": "617519"
  },
  {
    "text": "exploitation strategy is due for redirection in the right time just between canyon",
    "start": "617519",
    "end": "624480"
  },
  {
    "text": "screen info and the surname secret info but there and then",
    "start": "624480",
    "end": "631360"
  },
  {
    "text": "cnm screen4 will override the acl of the redirected",
    "start": "631360",
    "end": "636880"
  },
  {
    "text": "target file into system file but there are two challenges",
    "start": "636880",
    "end": "643760"
  },
  {
    "text": "the first is there a way to redirect the directory",
    "start": "643760",
    "end": "649040"
  },
  {
    "text": "to a file second is there a way to win the shot",
    "start": "649040",
    "end": "655200"
  },
  {
    "text": "release window stably upload could be an option but can we",
    "start": "655200",
    "end": "660640"
  },
  {
    "text": "trigger our block just after get name security info and do file redirection in",
    "start": "660640",
    "end": "666399"
  },
  {
    "text": "the upload callback before sending security info after more investigations we found two",
    "start": "666399",
    "end": "673839"
  },
  {
    "start": "671000",
    "end": "671000"
  },
  {
    "text": "challenges we we found more challenges for the file reduction we don't know if",
    "start": "673839",
    "end": "681600"
  },
  {
    "text": "currently existing file reduction trick can be used for directory to file redirection",
    "start": "681600",
    "end": "688480"
  },
  {
    "text": "besides we are not sure get name secret info and a synonym screening for",
    "start": "688480",
    "end": "694399"
  },
  {
    "text": "work for both file and the directory at the same time",
    "start": "694399",
    "end": "699600"
  },
  {
    "text": "for risk condition no upload type can block read attributes",
    "start": "699600",
    "end": "705760"
  },
  {
    "text": "on directory by gangnam secret info besides we cannot change one point",
    "start": "705760",
    "end": "711279"
  },
  {
    "text": "inside the upload callback when it is in use and last we need to run the exploit",
    "start": "711279",
    "end": "718800"
  },
  {
    "text": "automatically not just manually click the reset button",
    "start": "718800",
    "end": "725360"
  },
  {
    "start": "725000",
    "end": "725000"
  },
  {
    "text": "to overcome all challenges mentioned above we need to revisit the vulnerability and check all file",
    "start": "725360",
    "end": "732240"
  },
  {
    "text": "operation precisely first let's take a look at the",
    "start": "732240",
    "end": "737360"
  },
  {
    "text": "exploitation of the running part the reset button has a corresponding",
    "start": "737360",
    "end": "745519"
  },
  {
    "text": "powershot command to do the same thing we said ebbx package",
    "start": "745519",
    "end": "750639"
  },
  {
    "text": "but it is only supported on future windows versions the good news is we figure out",
    "start": "750639",
    "end": "760160"
  },
  {
    "text": "the reset operation is e-code",
    "start": "760160",
    "end": "765760"
  },
  {
    "text": "uninstall and reinstall the better news is we can split file operations",
    "start": "765760",
    "end": "771120"
  },
  {
    "text": "precisely by splitting reset into uninstall and reinstall",
    "start": "771120",
    "end": "778000"
  },
  {
    "start": "777000",
    "end": "777000"
  },
  {
    "text": "we extract important file operations in uninstall and reinstall in uninstall",
    "start": "778000",
    "end": "784480"
  },
  {
    "text": "there are there is only one file operation deleted directory in reinstall there are three file operations create",
    "start": "784480",
    "end": "791360"
  },
  {
    "text": "directory canon screen info and the synonym secret info to avoid the noisy file operations we",
    "start": "791360",
    "end": "799040"
  },
  {
    "text": "start our thread after uninstall and try to win the risk when finding",
    "start": "799040",
    "end": "805519"
  },
  {
    "text": "vulnerable directory creation so there are three possibilities the risk threat will be in",
    "start": "805519",
    "end": "813279"
  },
  {
    "text": "with windows 0 1 and 2. you can see the wrist window 0 is",
    "start": "813279",
    "end": "818880"
  },
  {
    "text": "relative long and the wrist window 1 is very short since there are much more",
    "start": "818880",
    "end": "824320"
  },
  {
    "text": "code between credit directory and gangnam security info then between getting secret info and a synonym secret",
    "start": "824320",
    "end": "831600"
  },
  {
    "text": "info as we just saw there's only one function calculate scale between get and set",
    "start": "831600",
    "end": "838560"
  },
  {
    "text": "so the possibility that the risk threat is increased window zero is much higher",
    "start": "838560",
    "end": "844639"
  },
  {
    "text": "than in risk window one besides because we added the critical priority for the risk",
    "start": "844639",
    "end": "851440"
  },
  {
    "text": "threat the prob the probability that the risk thread is in risk window 2 is very very",
    "start": "851440",
    "end": "859279"
  },
  {
    "text": "low so we only need to deal with a risk window",
    "start": "859279",
    "end": "864480"
  },
  {
    "text": "zero and a risk window one let's firstly focus on the risk window one when the wrist thread is in wrist",
    "start": "864480",
    "end": "871920"
  },
  {
    "start": "867000",
    "end": "867000"
  },
  {
    "text": "window one it is perfect situation we expected the only change we challenge we",
    "start": "871920",
    "end": "878560"
  },
  {
    "text": "need to solve is directory to file reduction the good news is the existing mount",
    "start": "878560",
    "end": "884959"
  },
  {
    "text": "point and the object symboling trick works for directory to file redirection the only",
    "start": "884959",
    "end": "891920"
  },
  {
    "text": "thing the only change we need to do is to create point for the parent directory",
    "start": "891920",
    "end": "900160"
  },
  {
    "text": "of the vulnerable directory besides get name screen 4 and send them",
    "start": "900160",
    "end": "905440"
  },
  {
    "text": "secret info do not differentiate object name it means",
    "start": "905440",
    "end": "912560"
  },
  {
    "text": "both file and the directory work for those two functions at the same time",
    "start": "912560",
    "end": "919360"
  },
  {
    "text": "it is perfect for file redirection attacks",
    "start": "919360",
    "end": "924079"
  },
  {
    "text": "after solving the risk window 1 let's see how we overcome all challenges",
    "start": "924639",
    "end": "930480"
  },
  {
    "text": "and bypass current mitigations and finally set the upload successfully and get a 100 success rate in which window",
    "start": "930480",
    "end": "937920"
  },
  {
    "text": "zero we need to redirect the same vulnerable directory to different targets in",
    "start": "937920",
    "end": "944240"
  },
  {
    "text": "different time we can create a mount point for the directory if it is not empty or in use",
    "start": "944240",
    "end": "951920"
  },
  {
    "text": "so we use a dangling mount point technique it's like the dangling file",
    "start": "951920",
    "end": "957920"
  },
  {
    "text": "pointer in use of free exploitation we can point it to any",
    "start": "957920",
    "end": "963279"
  },
  {
    "text": "different location in any time we want",
    "start": "963279",
    "end": "968480"
  },
  {
    "text": "the first reduction happens when creating the vulnerable directory the vulnerable directory will be created",
    "start": "968480",
    "end": "975199"
  },
  {
    "text": "under a fake publisher application directory after redirection",
    "start": "975199",
    "end": "980800"
  },
  {
    "text": "we will show other redirections in the following slides to succeed to set the upload for the",
    "start": "980800",
    "end": "987519"
  },
  {
    "text": "gangnam screenflow we need to redirect the directory to the file otherwise all our block",
    "start": "987519",
    "end": "995120"
  },
  {
    "text": "will not work for gnm secret info we did the redirection in the wrist",
    "start": "995120",
    "end": "1000480"
  },
  {
    "text": "thread since it is running the release window 0 we can finish the redirection",
    "start": "1000480",
    "end": "1007920"
  },
  {
    "text": "successfully before get named screen 4 is called",
    "start": "1007920",
    "end": "1013440"
  },
  {
    "text": "since get named screen info use read attributes to open the file we found two",
    "start": "1013440",
    "end": "1020320"
  },
  {
    "text": "types of uploads level one and a batch of block can block file operation when opening",
    "start": "1020320",
    "end": "1027600"
  },
  {
    "text": "the file with read attributes so we can succeed to set the level one",
    "start": "1027600",
    "end": "1034640"
  },
  {
    "text": "upload on the fixed file beforehand and the wing get m secret info is called the",
    "start": "1034640",
    "end": "1041438"
  },
  {
    "text": "upload callback will be triggered and do the third time file redirection to",
    "start": "1041439",
    "end": "1047678"
  },
  {
    "text": "redirect the vulnerable directory to the target into system file",
    "start": "1047679",
    "end": "1052720"
  },
  {
    "text": "then synonym screen4 will override the acl of the target file with normal user fully",
    "start": "1052720",
    "end": "1059280"
  },
  {
    "text": "control privilege this is the whole view of how to win a",
    "start": "1059280",
    "end": "1064960"
  },
  {
    "text": "seemingly impossible risk window by redirecting the vulnerable directory to",
    "start": "1064960",
    "end": "1070000"
  },
  {
    "text": "different targets for three times first for create create directory second",
    "start": "1070000",
    "end": "1076960"
  },
  {
    "text": "for genome screen for in the wrist thread second third",
    "start": "1076960",
    "end": "1083679"
  },
  {
    "text": "for synonym secret info in upload callback",
    "start": "1083679",
    "end": "1089360"
  },
  {
    "start": "1089000",
    "end": "1089000"
  },
  {
    "text": "now we have 100 success rate for the risk window zero and a one",
    "start": "1089360",
    "end": "1094799"
  },
  {
    "text": "and the probability of risk window zero is very high so the exploit success rate is very high even",
    "start": "1094799",
    "end": "1102320"
  },
  {
    "text": "for one time running actually the exploits succeed in one trial in most of time in a vm",
    "start": "1102320",
    "end": "1109919"
  },
  {
    "text": "with a two-car cpu after we succeed to override the ac air",
    "start": "1109919",
    "end": "1116880"
  },
  {
    "text": "of the nt-system file we need to find a way to execute the code system",
    "start": "1116880",
    "end": "1122000"
  },
  {
    "text": "there are two known tricks left after mitigations print config and the type",
    "start": "1122000",
    "end": "1127600"
  },
  {
    "text": "lib file sysfx ui since both both of them are existing",
    "start": "1127600",
    "end": "1133840"
  },
  {
    "text": "techniques we are not putting more time under on them today",
    "start": "1133840",
    "end": "1139679"
  },
  {
    "start": "1139000",
    "end": "1139000"
  },
  {
    "text": "now we can elevate the privileged system but the stability is one of the most",
    "start": "1139679",
    "end": "1145120"
  },
  {
    "text": "important things in ponton because you only have three chances to try",
    "start": "1145120",
    "end": "1150720"
  },
  {
    "text": "we use a rerun until success strategy in our exploit it continually",
    "start": "1150720",
    "end": "1157440"
  },
  {
    "text": "uninstall and reinstall the solid tire application there are lots of things need to take",
    "start": "1157440",
    "end": "1164080"
  },
  {
    "text": "care for example we need to put the initial setup thing information into a",
    "start": "1164080",
    "end": "1170880"
  },
  {
    "text": "config file otherwise we cannot get them anymore afterwards",
    "start": "1170880",
    "end": "1176080"
  },
  {
    "text": "besides we need carefully deal with each field situation and",
    "start": "1176080",
    "end": "1182400"
  },
  {
    "text": "do the uh correctly uh cleanup",
    "start": "1182400",
    "end": "1188080"
  },
  {
    "text": "for all of open things like handle symbol link mount point",
    "start": "1188080",
    "end": "1195200"
  },
  {
    "text": "thread directory upload and so on so forth and last we also need to",
    "start": "1195200",
    "end": "1201679"
  },
  {
    "text": "deal with many corner cases to make sure our exploit can handle everything",
    "start": "1201679",
    "end": "1209840"
  },
  {
    "text": "under all of current mitigations the exploitation logic is very very complicated you can see there are many",
    "start": "1209840",
    "end": "1217280"
  },
  {
    "text": "modules in our exploitation but it works elegantly and perfectly",
    "start": "1217280",
    "end": "1226240"
  },
  {
    "text": "today we are not going to explain all details in our in each module",
    "start": "1226400",
    "end": "1232720"
  },
  {
    "text": "only two things want to mention the first the first we have a module to verify if the",
    "start": "1232720",
    "end": "1240799"
  },
  {
    "text": "acl overriding is successful if not we will wrong we run the whole uh",
    "start": "1240799",
    "end": "1247120"
  },
  {
    "text": "process until it's success the",
    "start": "1247120",
    "end": "1252240"
  },
  {
    "text": "second thing is the we have a reason thread it is very important because the success rate",
    "start": "1252240",
    "end": "1260720"
  },
  {
    "text": "depends on if the wrist thread enters into the right release window",
    "start": "1260720",
    "end": "1268000"
  },
  {
    "text": "talk is cheap show me the demo you can see",
    "start": "1268159",
    "end": "1275039"
  },
  {
    "text": "you can see uh it is a windows version prepare for pongtong",
    "start": "1275120",
    "end": "1281600"
  },
  {
    "text": "and we are running the xy under normal user and run our",
    "start": "1281600",
    "end": "1288960"
  },
  {
    "text": "exploitation on installing and",
    "start": "1288960",
    "end": "1294320"
  },
  {
    "text": "read thread is running reinstall and success",
    "start": "1294320",
    "end": "1300480"
  },
  {
    "text": "you can see a system a cmd pop-up",
    "start": "1300480",
    "end": "1305840"
  },
  {
    "text": "if we check the pro command you can see a a system notepad is",
    "start": "1306080",
    "end": "1313039"
  },
  {
    "text": "running under section zero and this is the system cmd rounder",
    "start": "1313039",
    "end": "1319200"
  },
  {
    "text": "running under session two current session our exploitation only wrong once and",
    "start": "1319200",
    "end": "1327039"
  },
  {
    "text": "succeed perfectly",
    "start": "1327039",
    "end": "1331320"
  },
  {
    "text": "we have introduced many interesting interesting things for logic issues in reports points but the story does not",
    "start": "1336880",
    "end": "1343600"
  },
  {
    "text": "end here microsoft stopped granting bhagavantis to the file rejection bug",
    "start": "1343600",
    "end": "1349600"
  },
  {
    "text": "class and it is releasing more and more mitigations to kill the backlash fully",
    "start": "1349600",
    "end": "1355280"
  },
  {
    "text": "it seems to be the end of the repulse point year but things are not always",
    "start": "1355280",
    "end": "1361919"
  },
  {
    "text": "that easy we found a new realm which is never publicly deeply discussed before",
    "start": "1361919",
    "end": "1367679"
  },
  {
    "text": "the memory corruption plus in replace points",
    "start": "1367679",
    "end": "1372960"
  },
  {
    "text": "let's start from the new text surface internals first",
    "start": "1373600",
    "end": "1378960"
  },
  {
    "text": "pass point operation as we mentioned before divisor control can be used to set get and delete your",
    "start": "1378960",
    "end": "1386320"
  },
  {
    "text": "press points by setting the corresponding device out control code",
    "start": "1386320",
    "end": "1393120"
  },
  {
    "text": "and there are other arguments in vessel control function input buffer output buffer let's see the",
    "start": "1393120",
    "end": "1400320"
  },
  {
    "start": "1400000",
    "end": "1400000"
  },
  {
    "text": "repairs data structure first there is a four bytes replace tag which",
    "start": "1400320",
    "end": "1406480"
  },
  {
    "text": "represents the type of replace point data and then",
    "start": "1406480",
    "end": "1411760"
  },
  {
    "text": "two bytes of data lens two by three observed after that",
    "start": "1411760",
    "end": "1416880"
  },
  {
    "text": "there are undocumented data buffer for generic reports buffer",
    "start": "1416880",
    "end": "1424720"
  },
  {
    "start": "1424000",
    "end": "1424000"
  },
  {
    "text": "actually there are 54 repulse point tags totally",
    "start": "1424720",
    "end": "1430640"
  },
  {
    "text": "one point and the symbol link on only two of them there are others",
    "start": "1430640",
    "end": "1435760"
  },
  {
    "text": "uh other interesting report reverse point tags uh such as wci",
    "start": "1435760",
    "end": "1442840"
  },
  {
    "text": "which are designed for windows container it is a relatively",
    "start": "1442840",
    "end": "1449679"
  },
  {
    "text": "new thing on windows for the left 52 price points tags",
    "start": "1449679",
    "end": "1455360"
  },
  {
    "text": "what are they used for who use them and where they are used is there any unit",
    "start": "1455360",
    "end": "1461440"
  },
  {
    "text": "new attack surface among them we will see in the following slides before exploring",
    "start": "1461440",
    "end": "1467600"
  },
  {
    "start": "1465000",
    "end": "1465000"
  },
  {
    "text": "more details we create a vulnerability model first you can see",
    "start": "1467600",
    "end": "1473600"
  },
  {
    "text": "a low privileged application communicated with high privileged application by alpc rpc com same with before",
    "start": "1473600",
    "end": "1482960"
  },
  {
    "text": "high privilege applications has a module to process",
    "start": "1482960",
    "end": "1489120"
  },
  {
    "text": "uh repulse point data it will firstly read repulse point",
    "start": "1489120",
    "end": "1494400"
  },
  {
    "text": "on low privileged user controllable files or directories",
    "start": "1494400",
    "end": "1500880"
  },
  {
    "text": "and then if low privileged user application write the repository data",
    "start": "1500880",
    "end": "1508400"
  },
  {
    "text": "to those files or directories then low pre-privileged user controllable",
    "start": "1508400",
    "end": "1515600"
  },
  {
    "text": "data will be written into high privileged applications as data input",
    "start": "1515600",
    "end": "1521440"
  },
  {
    "text": "if high privilege applications do not process",
    "start": "1521440",
    "end": "1526480"
  },
  {
    "text": "we passpoint data correctly or carefully there are",
    "start": "1526480",
    "end": "1531600"
  },
  {
    "text": "memory corruption bugs possibly and it will crash",
    "start": "1531600",
    "end": "1538880"
  },
  {
    "text": "high private privilege applications there is a way to write data from low privileged",
    "start": "1538880",
    "end": "1544960"
  },
  {
    "text": "application to high privilege application it is where the new attack service is",
    "start": "1544960",
    "end": "1551520"
  },
  {
    "start": "1551000",
    "end": "1551000"
  },
  {
    "text": "after creating the vulnerability model we start to find some targets to diving",
    "start": "1551520",
    "end": "1559519"
  },
  {
    "text": "there are two ways to find the targets dynamic and static for dynamic",
    "start": "1559760",
    "end": "1566400"
  },
  {
    "text": "method we use progmon to monitor some system events if we find",
    "start": "1566400",
    "end": "1574159"
  },
  {
    "text": "a process with a system a system process",
    "start": "1574159",
    "end": "1580080"
  },
  {
    "text": "access a normal user controllable directory of file",
    "start": "1580080",
    "end": "1585200"
  },
  {
    "text": "with open repose point option it is suspicious",
    "start": "1585200",
    "end": "1590880"
  },
  {
    "text": "and worse to take a closer look at to see if there's a",
    "start": "1590880",
    "end": "1596960"
  },
  {
    "text": "we pass point data processing module to process replace point data",
    "start": "1596960",
    "end": "1602960"
  },
  {
    "text": "for static we we write a adder python script to find",
    "start": "1602960",
    "end": "1608080"
  },
  {
    "text": "the following code pattern in the code it's very simple to",
    "start": "1608080",
    "end": "1613279"
  },
  {
    "text": "understand create file first and uh call director control to",
    "start": "1613279",
    "end": "1619360"
  },
  {
    "text": "get uh your passport and data and check the type",
    "start": "1619360",
    "end": "1624880"
  },
  {
    "text": "process the replace point data sometimes we need",
    "start": "1624880",
    "end": "1630880"
  },
  {
    "text": "women you combine static method and a dynamic method to find and confirm the",
    "start": "1630880",
    "end": "1636559"
  },
  {
    "text": "targets after finding the targets we can do bug hunting by clear review of",
    "start": "1636559",
    "end": "1642080"
  },
  {
    "text": "fuzzing we have some interesting findings with only some initial investigations it is a",
    "start": "1642080",
    "end": "1650080"
  },
  {
    "start": "1643000",
    "end": "1643000"
  },
  {
    "text": "total total new realm the code for replace points data processing is not",
    "start": "1650080",
    "end": "1655679"
  },
  {
    "text": "well evaluated and the vulnerability are very straightforward we pick some",
    "start": "1655679",
    "end": "1661440"
  },
  {
    "text": "interesting memory corruption but examples to show today there's a one function containing three",
    "start": "1661440",
    "end": "1669039"
  },
  {
    "text": "types of vulnerabilities integer flow out of bounds rate and a",
    "start": "1669039",
    "end": "1674799"
  },
  {
    "text": "risk condition more interestingly the similar code pattern appear in multiple modules",
    "start": "1674799",
    "end": "1682799"
  },
  {
    "start": "1682000",
    "end": "1682000"
  },
  {
    "text": "the vulnerable function can be triggered by desktop bridge activation",
    "start": "1682799",
    "end": "1688240"
  },
  {
    "text": "you can see desktop ad breach activation app communicated with app info service",
    "start": "1688240",
    "end": "1694559"
  },
  {
    "text": "infoservicewith.com and here's a call stack for a client client com client and a com",
    "start": "1694559",
    "end": "1702240"
  },
  {
    "text": "server we use the following code to create client",
    "start": "1702240",
    "end": "1708159"
  },
  {
    "start": "1703000",
    "end": "1703000"
  },
  {
    "text": "create.com client to communicate with with the app info service",
    "start": "1708159",
    "end": "1713760"
  },
  {
    "text": "there's a com class named desktop ebbx activator and there's an",
    "start": "1713760",
    "end": "1719440"
  },
  {
    "text": "interesting interface in them in under that interface there are two",
    "start": "1719440",
    "end": "1725039"
  },
  {
    "text": "methods we call activate method with local bridge and microsoft office hub",
    "start": "1725039",
    "end": "1732000"
  },
  {
    "text": "as parameters you can see in appian for service",
    "start": "1732000",
    "end": "1737200"
  },
  {
    "start": "1733000",
    "end": "1733000"
  },
  {
    "text": "there's a function named launch process with identity to",
    "start": "1737200",
    "end": "1745760"
  },
  {
    "text": "deal with a com request then it will finally call wcp or",
    "start": "1745760",
    "end": "1752080"
  },
  {
    "text": "passpoint this function will read the replace point data on the",
    "start": "1752080",
    "end": "1758799"
  },
  {
    "text": "normal user controllable directory local cache with the system",
    "start": "1758799",
    "end": "1764320"
  },
  {
    "text": "more details for wcp reader passpoint function you can see firstly",
    "start": "1764480",
    "end": "1770240"
  },
  {
    "text": "create file for local cache normal user controllable",
    "start": "1770240",
    "end": "1776399"
  },
  {
    "text": "and called device or control to get a replace point data into a fixed",
    "start": "1776399",
    "end": "1782399"
  },
  {
    "text": "um output buffer to be mentioned this",
    "start": "1782399",
    "end": "1787440"
  },
  {
    "text": "the this output buffer is a fixed sized hip with a size",
    "start": "1787440",
    "end": "1793039"
  },
  {
    "text": "zero zero zero zero we will introduce later how it leads to a lot of bounds read vulnerability",
    "start": "1793039",
    "end": "1799520"
  },
  {
    "text": "after that the code will check the type you can see here and then process the data",
    "start": "1799520",
    "end": "1806720"
  },
  {
    "text": "so we can set the repository data",
    "start": "1806720",
    "end": "1812159"
  },
  {
    "text": "with a following code and we set a reposit tag",
    "start": "1812159",
    "end": "1817840"
  },
  {
    "text": "with the wci link and then only two bytes of normal value",
    "start": "1817840",
    "end": "1825840"
  },
  {
    "text": "and we will see how a literal out of bounds write a vulnerability",
    "start": "1825840",
    "end": "1832240"
  },
  {
    "text": "wci really requires point data function is responsible to process through",
    "start": "1832960",
    "end": "1838080"
  },
  {
    "text": "passport data here is",
    "start": "1838080",
    "end": "1843600"
  },
  {
    "text": "the replacement data read from the local cache directory",
    "start": "1843840",
    "end": "1851279"
  },
  {
    "text": "and then here is where the integer overflow happens",
    "start": "1851279",
    "end": "1858880"
  },
  {
    "text": "there's a plus operation",
    "start": "1858880",
    "end": "1864480"
  },
  {
    "text": "and uh for fff plus one six but the",
    "start": "1864480",
    "end": "1870480"
  },
  {
    "text": "the buffer lens variable is two bytes so it will",
    "start": "1870480",
    "end": "1875600"
  },
  {
    "text": "generate a very small value 1 5 then the code will allocate a heap with this size",
    "start": "1875600",
    "end": "1881360"
  },
  {
    "text": "1 5 and put that that",
    "start": "1881360",
    "end": "1886880"
  },
  {
    "text": "heap as a destination buffer of the memory copy very small heap",
    "start": "1886880",
    "end": "1894960"
  },
  {
    "text": "but the memory copies size is controllable in the",
    "start": "1894960",
    "end": "1900640"
  },
  {
    "text": "passport and data it is set to ffffff so obviously this",
    "start": "1900640",
    "end": "1908000"
  },
  {
    "text": "memory copy operation will lead to out of bounds right vulnerability",
    "start": "1908000",
    "end": "1914159"
  },
  {
    "text": "in the crashing fall we can see more clearly the destination buffer size 1 5",
    "start": "1914159",
    "end": "1921840"
  },
  {
    "text": "the copy size is fff obviously",
    "start": "1921840",
    "end": "1927600"
  },
  {
    "text": "it will crash at a memory copy if we use a following code",
    "start": "1929600",
    "end": "1937760"
  },
  {
    "start": "1933000",
    "end": "1933000"
  },
  {
    "text": "to set a replace point data",
    "start": "1938559",
    "end": "1942080"
  },
  {
    "text": "we'll see how it can lead to a lot of bonds read the vulnerability nothing special we",
    "start": "1943840",
    "end": "1951440"
  },
  {
    "text": "previously called only slightly change the two bytes of normal",
    "start": "1951440",
    "end": "1957760"
  },
  {
    "text": "value the same function same uh",
    "start": "1957760",
    "end": "1964159"
  },
  {
    "text": "also wcp read the repository to read the replacement data and here is a fix for the integer flow",
    "start": "1964159",
    "end": "1972799"
  },
  {
    "text": "and pay attention here the saucer dress soft",
    "start": "1972799",
    "end": "1977840"
  },
  {
    "text": "buffer is a fixed hey fixed size hip with a size uh f",
    "start": "1977840",
    "end": "1983840"
  },
  {
    "text": "of 4 000 as we mentioned before",
    "start": "1983840",
    "end": "1989600"
  },
  {
    "text": "as a for the memory copy but the copy size is also controllable in",
    "start": "1989600",
    "end": "1995840"
  },
  {
    "text": "the replacement data we set it to ff10 so if through the",
    "start": "1995840",
    "end": "2002960"
  },
  {
    "text": "memory copy it will be out of bounds read the vulnerability",
    "start": "2002960",
    "end": "2008960"
  },
  {
    "text": "if we check check the crash info we can see also see more clear",
    "start": "2008960",
    "end": "2015679"
  },
  {
    "start": "2009000",
    "end": "2009000"
  },
  {
    "text": "you can see the source buffer size of memory copy is",
    "start": "2015679",
    "end": "2022399"
  },
  {
    "text": "four zero zero zero but the copies size is ff one zero",
    "start": "2022399",
    "end": "2027840"
  },
  {
    "text": "will lead to other fonts read vulnerability it's a",
    "start": "2027840",
    "end": "2033360"
  },
  {
    "start": "2032000",
    "end": "2032000"
  },
  {
    "text": "risk condition it's a payday that we can't talk more details about it because it is",
    "start": "2033360",
    "end": "2038799"
  },
  {
    "text": "still vulnerable we may feel the slides for this part when we get the chance in the future we",
    "start": "2038799",
    "end": "2046240"
  },
  {
    "text": "have seen one function containing three types of vulnerabilities but more interestingly the similar code pattern",
    "start": "2046240",
    "end": "2052800"
  },
  {
    "text": "about the repulse point data processing appear in multiple different modules",
    "start": "2052800",
    "end": "2059440"
  },
  {
    "text": "abbx deployment server wci and so on so forth",
    "start": "2059440",
    "end": "2064560"
  },
  {
    "start": "2064000",
    "end": "2064000"
  },
  {
    "text": "we reported our findings to microsoft some of the cases got a fast response",
    "start": "2064560",
    "end": "2069839"
  },
  {
    "text": "and highly evaluated with back bounty since they are totally new and valuable",
    "start": "2069839",
    "end": "2075440"
  },
  {
    "text": "to microsoft but in the meantime they also silently patch some of our cases maybe your",
    "start": "2075440",
    "end": "2082960"
  },
  {
    "text": "also have similar experiences from microsoft",
    "start": "2082960",
    "end": "2088398"
  },
  {
    "start": "2087000",
    "end": "2087000"
  },
  {
    "text": "the impact under this new attack surface almost all current and the future",
    "start": "2088399",
    "end": "2093520"
  },
  {
    "text": "mitigations for logic bugs in price points are useless because memory",
    "start": "2093520",
    "end": "2098880"
  },
  {
    "text": "corruption bugs and logic bugs are from totally different dimensions in",
    "start": "2098880",
    "end": "2104560"
  },
  {
    "text": "addition the memory corruption bug has the native code execution capability no",
    "start": "2104560",
    "end": "2109760"
  },
  {
    "text": "matter the vulnerable code are executed with system impersonation or not in the",
    "start": "2109760",
    "end": "2115760"
  },
  {
    "text": "system services and a successful exploitation lead to privileged elevation to system",
    "start": "2115760",
    "end": "2122560"
  },
  {
    "text": "directly for future bug hunting i think we should a good example in our",
    "start": "2122560",
    "end": "2130079"
  },
  {
    "start": "2125000",
    "end": "2125000"
  },
  {
    "text": "topic find the target curve view of fuzzy create a",
    "start": "2130079",
    "end": "2135520"
  },
  {
    "text": "once a new attack surface is open there are always many low hunting fruits it is",
    "start": "2135520",
    "end": "2142000"
  },
  {
    "text": "much easier to find easy bugs under a new attack surface than finding an",
    "start": "2142000",
    "end": "2148079"
  },
  {
    "text": "interesting new attack service itself we believe there are still many not well",
    "start": "2148079",
    "end": "2154400"
  },
  {
    "text": "evaluated code left in this new attack surface",
    "start": "2154400",
    "end": "2160000"
  },
  {
    "start": "2159000",
    "end": "2159000"
  },
  {
    "text": "to summarize our we intrigue we introduced a story of",
    "start": "2160079",
    "end": "2166000"
  },
  {
    "text": "two solid tires in our topic in the pontoon journey we introduced a unique",
    "start": "2166000",
    "end": "2171280"
  },
  {
    "text": "bank hunting strategy we use it to find the microsoft solid tire you set back in",
    "start": "2171280",
    "end": "2176880"
  },
  {
    "text": "one day and it can also be used to find more redo bugs in different applications",
    "start": "2176880",
    "end": "2183280"
  },
  {
    "text": "and components in the in the exploitation part we introduce some useful and universal",
    "start": "2183280",
    "end": "2190320"
  },
  {
    "text": "exploit techniques which can be applied to similar exploits for mitigation bypass in the future",
    "start": "2190320",
    "end": "2197119"
  },
  {
    "text": "in the other part we introduce a less recognized solid tire",
    "start": "2197119",
    "end": "2202720"
  },
  {
    "text": "the new attack surface for memory corruption bugs in repulse points",
    "start": "2202720",
    "end": "2207760"
  },
  {
    "text": "hope you can get some inspirations from our topic and win your own solitaire in",
    "start": "2207760",
    "end": "2214000"
  },
  {
    "text": "the reverse points in the future thanks",
    "start": "2214000",
    "end": "2219040"
  },
  {
    "text": "for the amazing previous work maybe not all of them are listed here but thanks",
    "start": "2219040",
    "end": "2224640"
  },
  {
    "text": "to all also thank you for listening and attending",
    "start": "2224640",
    "end": "2229920"
  },
  {
    "text": "questions [Music]",
    "start": "2229920",
    "end": "2241720"
  }
]