[
  {
    "text": "[Music]",
    "start": "0",
    "end": "15410"
  },
  {
    "text": "welcome to black hat Windows 2K security held February 14th through the 15th 2011",
    "start": "18880",
    "end": "24680"
  },
  {
    "text": "in Las Vegas Nevada the following videotape was recorded live at the conference and produced by the sound of",
    "start": "24680",
    "end": "30400"
  },
  {
    "text": "knowledge Incorporated this is videotape number 13 deep knowledge track falling",
    "start": "30400",
    "end": "39120"
  },
  {
    "text": "dominoes I think we're about as full as we're going to get and everybody's been sitting here patiently long enough um",
    "start": "45039",
    "end": "50320"
  },
  {
    "text": "this presentation part of the deep knowledge uh falling dominoes going to",
    "start": "50320",
    "end": "56559"
  },
  {
    "text": "be an in-depth look at Lotus Notes and notes and Domino BAS security vulnerabilities my name's Chris gogins",
    "start": "56559",
    "end": "62519"
  },
  {
    "text": "and I'm here with Kevin mCP and bter akima they're from trust Factory I'm from security design International and",
    "start": "62519",
    "end": "68600"
  },
  {
    "text": "over the next well that's going to be guy over there I",
    "start": "68600",
    "end": "75079"
  },
  {
    "text": "suppose you know I could sit here and",
    "start": "77439",
    "end": "82040"
  },
  {
    "text": "go okay one two I think this one's on well",
    "start": "84360",
    "end": "91200"
  },
  {
    "text": "all right okay is that any",
    "start": "91200",
    "end": "98880"
  },
  {
    "text": "better so I'll stand over here and pretend oh now now you turn that one on I see what you're",
    "start": "98880",
    "end": "104799"
  },
  {
    "text": "doing okay here you guys hold on to that one I'll stand over here is this on test test test",
    "start": "104799",
    "end": "114399"
  },
  {
    "text": "okay how about now can everybody hear all you B all you",
    "start": "114399",
    "end": "120399"
  },
  {
    "text": "bad kids in the back of the room you can hear okay um go ahead and pop it up to the",
    "start": "120399",
    "end": "126320"
  },
  {
    "text": "next one Bor the basic format of this talk is going to sort of go in a couple of",
    "start": "126320",
    "end": "131800"
  },
  {
    "text": "different parts um start off with a quick introduction then sort of go into uh straight into Lotus Notes and Domino",
    "start": "131800",
    "end": "139160"
  },
  {
    "text": "security covering a whole range of vulnerabilities some of them some of them known some of them documented most",
    "start": "139160",
    "end": "144640"
  },
  {
    "text": "of them not known or documented done this presentation couple of times before",
    "start": "144640",
    "end": "150040"
  },
  {
    "text": "first time was at uh black hat last year or at Defcon last year rather and uh",
    "start": "150040",
    "end": "155400"
  },
  {
    "text": "since then uh everybody's missed the point of the vulnerabilities no one's fixed the vulnerabilities everybody's",
    "start": "155400",
    "end": "160920"
  },
  {
    "text": "ignored the vulnerabilities so that sort of leads us into the second part where I'm going to conveniently leave the",
    "start": "160920",
    "end": "167440"
  },
  {
    "text": "state and uh and our friends from Holland over",
    "start": "167440",
    "end": "172640"
  },
  {
    "text": "here will uh show you why these things are a",
    "start": "172640",
    "end": "178599"
  },
  {
    "text": "problem so so after that uh leave it open for discussion uh arrest warrants",
    "start": "178599",
    "end": "184319"
  },
  {
    "text": "what have you so just to start off in setting a lot of this stuff up",
    "start": "184319",
    "end": "191280"
  },
  {
    "text": "trust Factory's main objective in doing a lot of things is to establish trust between objects on networks what have",
    "start": "191280",
    "end": "197640"
  },
  {
    "text": "you but to verify that they're really true and in sort of doing this they're doing some work on Lotus Notes which is",
    "start": "197640",
    "end": "204000"
  },
  {
    "text": "their primary specialty and in digging around within notes discovered some things that looked a little OD",
    "start": "204000",
    "end": "210720"
  },
  {
    "text": "about that time um an old high school friend of mine Kevin mCP called me up and said hey we've got this stuff and it",
    "start": "210720",
    "end": "217760"
  },
  {
    "text": "looks pretty serious but we want someone to take a look at it just to make sure that we're all not",
    "start": "217760",
    "end": "223000"
  },
  {
    "text": "insane and that's where I stepped in from security design International we decided to say yeah we'll go in there",
    "start": "223000",
    "end": "229760"
  },
  {
    "text": "we'll take a look at it and lo and behold these guys had found some stuff which basically uh renders Lotus Notes",
    "start": "229760",
    "end": "236560"
  },
  {
    "text": "useless now a lot of stuff that you'll read in the Press will lead you to believe that uh you have to have",
    "start": "236560",
    "end": "243120"
  },
  {
    "text": "physical access it can't be done remotely you have to have Supreme",
    "start": "243120",
    "end": "248319"
  },
  {
    "text": "knowledge of programming skills and in-depth little bits and bites inside Lotus Notes and that's just not true",
    "start": "248319",
    "end": "255400"
  },
  {
    "text": "with some very basic disassembly uh people can very easily figure out some of the stuff that was discovered and",
    "start": "255400",
    "end": "261720"
  },
  {
    "text": "with a lot of extra playing and learning about Lotus script and other things you can make notes do some really horrible",
    "start": "261720",
    "end": "267320"
  },
  {
    "text": "things so at Defcon we did this presentation and it created a lot of",
    "start": "267320",
    "end": "272960"
  },
  {
    "text": "stir and at that point our our goal was to disclose everything but not give away",
    "start": "272960",
    "end": "280759"
  },
  {
    "text": "the tools still not giving away the tools because we figure anybody who wants to take the time to research this can",
    "start": "280759",
    "end": "286280"
  },
  {
    "text": "figure it out based upon what what we've said and the white paper that we'll be writing hopefully this",
    "start": "286280",
    "end": "291800"
  },
  {
    "text": "weekend so um sort of the difference between um you know your typical CT",
    "start": "291800",
    "end": "299000"
  },
  {
    "text": "advisory and complete unfettered uh Reckless",
    "start": "299000",
    "end": "304240"
  },
  {
    "text": "disclosure during the time of doing this we'd actually talk to Lotus engaged them in multiple dialogues tried to explain",
    "start": "304240",
    "end": "310880"
  },
  {
    "text": "the seriousness of their vulnerabilities and what basically ended up happening",
    "start": "310880",
    "end": "316199"
  },
  {
    "text": "was Lotus went into spend doctor mode where the IBM people just sort of put out a bunch of releases and some stuff",
    "start": "316199",
    "end": "321400"
  },
  {
    "text": "that basically said oh yeah well you know this is really a problem and here's why but none of that's true and we'll",
    "start": "321400",
    "end": "329759"
  },
  {
    "text": "explain that and you'll see how why that is as we go into the talk so",
    "start": "329759",
    "end": "338120"
  },
  {
    "text": "um okay so for those of you who don't know I can't imagine that you'd be in here if you didn't know what Lotus Notes",
    "start": "338360",
    "end": "343759"
  },
  {
    "text": "was but for those of you who uh just staggered out of the cold Lotus Notes is basically a secure groupware application",
    "start": "343759",
    "end": "350600"
  },
  {
    "text": "it's got email it's got database functionality uh it's got a web interface it's got a lot of neat things",
    "start": "350600",
    "end": "356400"
  },
  {
    "text": "that sort of make it easy for a lot of people to share information in a off of a particular server it's got its own",
    "start": "356400",
    "end": "362000"
  },
  {
    "text": "development language it's got its own scripting language it has hooks into C with its own API it can make calls",
    "start": "362000",
    "end": "368960"
  },
  {
    "text": "directly native uh from Microsoft using Olay it supports uh JavaScript it",
    "start": "368960",
    "end": "375199"
  },
  {
    "text": "supports a lot of different things so it's a very very powerful tool that you can use to do a lot of complex",
    "start": "375199",
    "end": "380599"
  },
  {
    "text": "operations on databases without having to be some sort of super highle DBA now to give you an idea about how",
    "start": "380599",
    "end": "388440"
  },
  {
    "text": "big Lotus Notes is um there's about 60 million corporate users worldwide and you know mo Lotus",
    "start": "388440",
    "end": "397280"
  },
  {
    "text": "Notes is never been really that sexy for people to go attack mainly because Lotus has announced it from the beginning as",
    "start": "397280",
    "end": "404080"
  },
  {
    "text": "this is a secure operating platform it it has RSA encryption natively embedded",
    "start": "404080",
    "end": "409479"
  },
  {
    "text": "in the communications protocol between the client and server uh it's got strong authentication and good non-repudiation",
    "start": "409479",
    "end": "415879"
  },
  {
    "text": "of data and all sorts of stuff so no one really took a poke at it everybody just took it you know at uh face value saying",
    "start": "415879",
    "end": "422560"
  },
  {
    "text": "oh well you know if they've they've Incorporated public key into it well then it's probably going to be kind of hard to break well they they implemented",
    "start": "422560",
    "end": "429759"
  },
  {
    "text": "it wrong now the major releases 4546 and 50 it's up to 506a right um to give you",
    "start": "429759",
    "end": "439360"
  },
  {
    "text": "an idea about some of the places that you'll find notes this sort of drives home about how serious these problems",
    "start": "439360",
    "end": "444759"
  },
  {
    "text": "are in the government since it meets the defense messaging uh requirements the",
    "start": "444759",
    "end": "450080"
  },
  {
    "text": "government uses it you'll find it in most military agencies you'll find it in most state and federal government bodies",
    "start": "450080",
    "end": "457440"
  },
  {
    "text": "uh the CIA is the world's largest user of Lotus Notes to keep track of things including stuff like uh open case files",
    "start": "457440",
    "end": "465520"
  },
  {
    "text": "and and things of this nature most major multinational corporations use it a lot",
    "start": "465520",
    "end": "470879"
  },
  {
    "text": "of people use it primarily for email but a lot of people are also doing all sorts of stuff with the database functionality",
    "start": "470879",
    "end": "476520"
  },
  {
    "text": "for example in in banking and accounting uh a lot of people will set up databases that that using notes so that people can",
    "start": "476520",
    "end": "483800"
  },
  {
    "text": "update forms and submit particular values or fill out uh any fill out basic",
    "start": "483800",
    "end": "490720"
  },
  {
    "text": "things having to do with customer financials and what have you um I just left a large company in Florida just a",
    "start": "490720",
    "end": "497479"
  },
  {
    "text": "few days ago where I was doing the Consulting engagement they use notes so that all of their all of their people in",
    "start": "497479",
    "end": "503720"
  },
  {
    "text": "the field can fill out incident reports uh do payroll tracking and what have you",
    "start": "503720",
    "end": "509520"
  },
  {
    "text": "all of that was controlled by notes you know so everybody uses it but it just never got that sexy you don't really see",
    "start": "509520",
    "end": "515039"
  },
  {
    "text": "that many people trying to attack it now again the reason people went to",
    "start": "515039",
    "end": "521039"
  },
  {
    "text": "notes in the first place is because notes was touted as a secure operating environment as I said before they've",
    "start": "521039",
    "end": "526640"
  },
  {
    "text": "they implemented public key it's got its own basic pki structure U that provides",
    "start": "526640",
    "end": "532320"
  },
  {
    "text": "strong authentication so that you're when you're logging in with your notes ID it's doing a basic key exchange and",
    "start": "532320",
    "end": "538480"
  },
  {
    "text": "so you're really doing a secure authentication and it's got encryption built in using the same functionality so",
    "start": "538480",
    "end": "545399"
  },
  {
    "text": "that your database is going to be protected from prying from prying eyes ostensibly it also has different levels",
    "start": "545399",
    "end": "551519"
  },
  {
    "text": "of Access Control down to the tune of you can have server-based access control you can have document based Access",
    "start": "551519",
    "end": "557480"
  },
  {
    "text": "Control you can have even individual fields or views in a particular document can be restricted to certain people so",
    "start": "557480",
    "end": "563839"
  },
  {
    "text": "it has a really really high level of granularity that you can get to when you want to try to block people from looking",
    "start": "563839",
    "end": "569240"
  },
  {
    "text": "at certain things and because of the way it's used and because of who its client base are I",
    "start": "569240",
    "end": "575880"
  },
  {
    "text": "mean a lot of people said well gee you know if the CIA uses it it must be secure because certainly they would have taken a look at it a little bit so it's",
    "start": "575880",
    "end": "582920"
  },
  {
    "text": "enjoyed for a long time a very very strong reputation for being",
    "start": "582920",
    "end": "588440"
  },
  {
    "text": "secure now just to give you an idea about what things it runs on uh release",
    "start": "588720",
    "end": "593760"
  },
  {
    "text": "four ran on basically everything that you could put it on release five they've sort of Knocked Down the clients to",
    "start": "593760",
    "end": "600000"
  },
  {
    "text": "they've stopped development on clients for os2 and Sun Solaris probably because there just wasn't that big of a market",
    "start": "600000",
    "end": "605079"
  },
  {
    "text": "anymore focusing primarily now on the Windows environment for clients on the server side um pretty much drops support",
    "start": "605079",
    "end": "613240"
  },
  {
    "text": "for netwar and os2 again trying to focus primarily on the window side but still",
    "start": "613240",
    "end": "619079"
  },
  {
    "text": "continuing on with Unix based support as well as support for as 400s now what",
    "start": "619079",
    "end": "625680"
  },
  {
    "text": "you'll see for some of the attacks that that occur server really doesn't matter",
    "start": "625680",
    "end": "631279"
  },
  {
    "text": "you could be running your server on an mvs on on an os390 system it doesn't matter it doesn't matter the attacks",
    "start": "631279",
    "end": "637880"
  },
  {
    "text": "that we'll demonstrate it's irrespective of what whatever server the thing's running on all has to do with the way",
    "start": "637880",
    "end": "644040"
  },
  {
    "text": "that you connect to it with the client that you're using now to sort of do a handoff",
    "start": "644040",
    "end": "650000"
  },
  {
    "text": "here the first part of our two-part series is broken into two parts if that",
    "start": "650000",
    "end": "655399"
  },
  {
    "text": "makes any sense um that should probably say part A and Part",
    "start": "655399",
    "end": "661200"
  },
  {
    "text": "B but you'll get you'll get the basic idea Kevin's going to talk a little bit about the basic functionality of note",
    "start": "661200",
    "end": "668079"
  },
  {
    "text": "security starting off with Access Control list and how those are applied or misapplied in most cases talk about",
    "start": "668079",
    "end": "673680"
  },
  {
    "text": "the the construction of server IDs and and user IDs as well as the passwords associated with them talk about things",
    "start": "673680",
    "end": "680000"
  },
  {
    "text": "that are vulnerable within the Domino portion the HTTP web server and talk",
    "start": "680000",
    "end": "685600"
  },
  {
    "text": "about some of the fields that exist in the names and address book and what you can do with them then voucher is going to pick it up and talk about some more",
    "start": "685600",
    "end": "691600"
  },
  {
    "text": "advanced attacks using stored forms talk about bypassing Lotus Notes execution control list by by making your own",
    "start": "691600",
    "end": "698880"
  },
  {
    "text": "particular kinds of attacks talk about the Lotus Notes password hash and how that can be broken and then talk about",
    "start": "698880",
    "end": "705279"
  },
  {
    "text": "how to steal people's identities using Lotus Notes so with that I'll hand it over to",
    "start": "705279",
    "end": "711760"
  },
  {
    "text": "Kevin okay all right can y'all hear me okay with",
    "start": "717440",
    "end": "723360"
  },
  {
    "text": "this okay if y'all want this you feel free to grab it um how many of y'all are actually",
    "start": "723360",
    "end": "730680"
  },
  {
    "text": "running Lotus Notes or how many of you actually have done consultancy against somebody who's",
    "start": "730680",
    "end": "737199"
  },
  {
    "text": "got notes okay do y all how how often do y'all actually check the access control",
    "start": "737199",
    "end": "743399"
  },
  {
    "text": "list y'all do that frequently on all the databases no one okay",
    "start": "743399",
    "end": "751160"
  },
  {
    "text": "I actually asked this this question at Def coton and we only had one guy who raised his hand um this is really",
    "start": "751800",
    "end": "757600"
  },
  {
    "text": "crucial and now I understand I I I really uh to to to steal a quote from",
    "start": "757600",
    "end": "763360"
  },
  {
    "text": "somebody I really feel your pain in checking the access control list uh in",
    "start": "763360",
    "end": "769800"
  },
  {
    "text": "notes I know it's extremely time consuming task because they don't really",
    "start": "769800",
    "end": "775360"
  },
  {
    "text": "have a really good interface on how to do that in mass and release five the administration client it is kind of",
    "start": "775360",
    "end": "781800"
  },
  {
    "text": "improved it's still got its problems but since notes comes with a possibility of",
    "start": "781800",
    "end": "787720"
  },
  {
    "text": "having up to 58 default databases installed this is really crucial and",
    "start": "787720",
    "end": "792880"
  },
  {
    "text": "this is one of the things in doing our research that we're just seeing Time and Time and Time Again people are just",
    "start": "792880",
    "end": "798079"
  },
  {
    "text": "leaving this stuff wide open for a variety of reasons uh everything from",
    "start": "798079",
    "end": "803680"
  },
  {
    "text": "you know the server was used as a staging server or a development server and got slammed into production so the",
    "start": "803680",
    "end": "811199"
  },
  {
    "text": "ACL databases didn't get checked while all the databases were actually being developed by developers and we all know",
    "start": "811199",
    "end": "817639"
  },
  {
    "text": "how the developers like to have their access um but we we we see this again and again and this this goes for all the",
    "start": "817639",
    "end": "824839"
  },
  {
    "text": "databases and I don't think that one of the things that we've tried to really nail everyone down on is that there is",
    "start": "824839",
    "end": "830279"
  },
  {
    "text": "so much information in each one of these databases which is really crucial to uh",
    "start": "830279",
    "end": "835519"
  },
  {
    "text": "protecting your environment or from an attacker's perspective really crucial for footprinting the",
    "start": "835519",
    "end": "843040"
  },
  {
    "text": "server go ahead now in regards to some of these databases we've got a couple of examples",
    "start": "843320",
    "end": "849560"
  },
  {
    "text": "up here and and these are are believe it or not the names and the names and address book as it was called in four",
    "start": "849560",
    "end": "857040"
  },
  {
    "text": "release four and release 5 they they've changed the terminology and it's now called the directory um it's the same",
    "start": "857040",
    "end": "864440"
  },
  {
    "text": "thing it's the same database it's the names.nsf database and I would probably",
    "start": "864440",
    "end": "869759"
  },
  {
    "text": "dare to say that about 60% of all the servers I look at this database is at",
    "start": "869759",
    "end": "875800"
  },
  {
    "text": "least readable across the internet using a standard web browser I",
    "start": "875800",
    "end": "881880"
  },
  {
    "text": "don't need a notes client I can actually just and it's since it's in the default data directory I don't have to try to",
    "start": "881880",
    "end": "887720"
  },
  {
    "text": "hunt down the path um this is really bad and one of the why this is really bad is that this",
    "start": "887720",
    "end": "893759"
  },
  {
    "text": "is where all your user information your server information uh communication",
    "start": "893759",
    "end": "899759"
  },
  {
    "text": "profiles between the servers and and between different notes networks all this is actually stored in that one",
    "start": "899759",
    "end": "907360"
  },
  {
    "text": "database uh one of the things that we're actually vter is going to do a demonstration later on is uh you'll",
    "start": "907360",
    "end": "914000"
  },
  {
    "text": "actually see how we can actually recover information uh in in user ID files or",
    "start": "914000",
    "end": "920000"
  },
  {
    "text": "server ID files from this database if it's readable we can we can pull anything from that",
    "start": "920000",
    "end": "925959"
  },
  {
    "text": "database um another one and I think that this one is a really nasty one which I'm",
    "start": "925959",
    "end": "932839"
  },
  {
    "text": "going to do a little demonstration on here in a little bit which is the catalog database if you're not familiar",
    "start": "932839",
    "end": "938160"
  },
  {
    "text": "with the catalog databas is I don't want to give you a course in Lotus how Lotus Notes Administration but the catalog the",
    "start": "938160",
    "end": "944240"
  },
  {
    "text": "catalog database will actually stores uh references to where all the",
    "start": "944240",
    "end": "949639"
  },
  {
    "text": "individual other databases are actually located at now in release 5 they' they've gone a bit further to try to Aid",
    "start": "949639",
    "end": "957160"
  },
  {
    "text": "administrators and they're actually storing Access Control information in",
    "start": "957160",
    "end": "962240"
  },
  {
    "text": "that database so if I can read this database I can actually find out which where the",
    "start": "962240",
    "end": "968920"
  },
  {
    "text": "databases are in the file system so if there if somebody's moved a database",
    "start": "968920",
    "end": "974079"
  },
  {
    "text": "three directories down nested it several directories down uh I I can look in this",
    "start": "974079",
    "end": "979440"
  },
  {
    "text": "one single database find out exactly where it is and what Access Control rights are set to",
    "start": "979440",
    "end": "984639"
  },
  {
    "text": "it so I know which one's now to Target the Dom config big database I think it",
    "start": "984639",
    "end": "989839"
  },
  {
    "text": "was LOF that had actually done this a couple of years ago in release 4 and this is not quite so important for",
    "start": "989839",
    "end": "996399"
  },
  {
    "text": "release 5 but there's there's still a lot of four servers release four release 4 five and release 4 six servers uh",
    "start": "996399",
    "end": "1003839"
  },
  {
    "text": "which have this wide open and this actually allows uh administrators or if",
    "start": "1003839",
    "end": "1009199"
  },
  {
    "text": "it's wide open uh somebody to use a web browser to create virtual servers on",
    "start": "1009199",
    "end": "1014279"
  },
  {
    "text": "your Domino server if it's running as a web server the log. NSF this is another one",
    "start": "1014279",
    "end": "1021240"
  },
  {
    "text": "that we see often a lot this now this is the same thing as your system logs under",
    "start": "1021240",
    "end": "1027079"
  },
  {
    "text": "Unix we under NT this this stores all the information everything that Domino",
    "start": "1027079",
    "end": "1033558"
  },
  {
    "text": "server is doing everything even direct output from the server console is stored",
    "start": "1033559",
    "end": "1038839"
  },
  {
    "text": "in here and if this is open if it's ridable uh somebody who's attacking your Domino server can cover us",
    "start": "1038839",
    "end": "1046720"
  },
  {
    "text": "tracks um what we've actually seen is there's this and we actually don't have",
    "start": "1046720",
    "end": "1051880"
  },
  {
    "text": "it up here and we should add this is there's another another uh database which stores uh HTTP request logs for",
    "start": "1051880",
    "end": "1059760"
  },
  {
    "text": "the web server and that's called the Dom log. NSF and typically when we are",
    "start": "1059760",
    "end": "1064799"
  },
  {
    "text": "actually doing incident response or something usually what attackers will do will just flood these two",
    "start": "1064799",
    "end": "1070559"
  },
  {
    "text": "databases to the point of where they corrupt the database because it runs out of space on the file system and usually",
    "start": "1070559",
    "end": "1077280"
  },
  {
    "text": "you're you start talking about databases is it ranged from 2 to four gigs by this time so we've we've actually seen this a",
    "start": "1077280",
    "end": "1084120"
  },
  {
    "text": "lot and actually uh this this actually happened with the Dutch police where they got",
    "start": "1084120",
    "end": "1091120"
  },
  {
    "text": "hacked and the way they hacked them was they actually overr just flooded their their Dom log uh database and it just",
    "start": "1091120",
    "end": "1099159"
  },
  {
    "text": "ended up something massive and even the police couldn't open up the data database anymore it's completely",
    "start": "1099159",
    "end": "1104520"
  },
  {
    "text": "corrupted server ID this this one is a really",
    "start": "1104520",
    "end": "1111159"
  },
  {
    "text": "controversial one um and the reason it's controversial is",
    "start": "1111159",
    "end": "1117679"
  },
  {
    "text": "because Lotus and Lotus documentation it actually will talk",
    "start": "1117679",
    "end": "1122880"
  },
  {
    "text": "about having automatic restarts of the Domino server uh and the reason you have",
    "start": "1122880",
    "end": "1128039"
  },
  {
    "text": "this is if the Domino server crashes in release 5 there's some new features in",
    "start": "1128039",
    "end": "1133480"
  },
  {
    "text": "there which which Domo the parent process will try to kill off all the children process and restart start",
    "start": "1133480",
    "end": "1139000"
  },
  {
    "text": "itself after a crash um other type of scenarios where you might have is actually a hardware Watchdog on your",
    "start": "1139000",
    "end": "1145799"
  },
  {
    "text": "server so if if you actually so it's actually pulling the Domino server and",
    "start": "1145799",
    "end": "1151120"
  },
  {
    "text": "and the operating system and if it sees a crash on one of those it will actually either restart the Domino server or the",
    "start": "1151120",
    "end": "1157600"
  },
  {
    "text": "whole operating system now to do this in the ID file there's there's two ways to",
    "start": "1157600",
    "end": "1164080"
  },
  {
    "text": "do this one is to put no password on the server ID file",
    "start": "1164080",
    "end": "1169360"
  },
  {
    "text": "the other way to do it which we've we starting to see now that people are putting passwords on the server ID files",
    "start": "1169360",
    "end": "1175760"
  },
  {
    "text": "they still want the automatic restart and you can actually feed the password to the server at startup by using a name",
    "start": "1175760",
    "end": "1183960"
  },
  {
    "text": "pipe so they've got a the password stored in a clear text file on the file system and they're redirecting that",
    "start": "1183960",
    "end": "1191159"
  },
  {
    "text": "through a pipe uh into the when they start the server process to get it",
    "start": "1191159",
    "end": "1196679"
  },
  {
    "text": "running um and and that's that just kind of defeats the whole purpose of having the password in the first",
    "start": "1196679",
    "end": "1202400"
  },
  {
    "text": "place and and what we like to recommend or or what we tell everybody if if you're really concerned about the uptime",
    "start": "1202400",
    "end": "1208720"
  },
  {
    "text": "of your server then you need to make sure that those passwords are in those ID files and install some clustered",
    "start": "1208720",
    "end": "1216600"
  },
  {
    "text": "servers now that's not always the cheapest option but if that's if that's what you're going for that's basically",
    "start": "1216600",
    "end": "1221679"
  },
  {
    "text": "what you're going to be faced with what and one of the reasons why",
    "start": "1221679",
    "end": "1227400"
  },
  {
    "text": "this is really so important I don't think a lot of people understand this if I can get this if I can retrieve that server ID",
    "start": "1227400",
    "end": "1233520"
  },
  {
    "text": "file uh and this is actually possible with the the directory traversal exploit which came out not too",
    "start": "1233520",
    "end": "1240320"
  },
  {
    "text": "long ago um you can we anyone can retrieve that ID file and because people take the",
    "start": "1240320",
    "end": "1247720"
  },
  {
    "text": "defaults when they when they install a server they take the default file name for the ID file which is server. ID they",
    "start": "1247720",
    "end": "1256039"
  },
  {
    "text": "don't bother to rename it or if they rename it they rename it after the name of their note server which is web server",
    "start": "1256039",
    "end": "1264120"
  },
  {
    "text": "01 so it it it becomes very easy to find out what the file name of this this ID",
    "start": "1264120",
    "end": "1269720"
  },
  {
    "text": "file is and uh retrieve",
    "start": "1269720",
    "end": "1274480"
  },
  {
    "text": "that the the notes ID file is actually the whole notes infrastructure is actually based on I'm sorry if you",
    "start": "1277960",
    "end": "1284679"
  },
  {
    "text": "didn't hear his question you were asking what the uh how the ID file is actually based what it's actually based on a",
    "start": "1284679",
    "end": "1291480"
  },
  {
    "text": "public key infrastructure uh very similar to pgp uh we'll go a little bit",
    "start": "1291480",
    "end": "1296679"
  },
  {
    "text": "more into detail about that later on if you can just hold on because we're going we're going to do some stuff with ID files and we'll go further into that but",
    "start": "1296679",
    "end": "1303120"
  },
  {
    "text": "it is very similar to pgp uh or something some or pki",
    "start": "1303120",
    "end": "1308880"
  },
  {
    "text": "pki um so if I if I can actually retrieve that file uh from the server ID",
    "start": "1308880",
    "end": "1315120"
  },
  {
    "text": "file I can now go off and and create my own uh server using your ID file and start",
    "start": "1315120",
    "end": "1322640"
  },
  {
    "text": "replicating with your other Domino servers and start pulling databases",
    "start": "1322640",
    "end": "1327919"
  },
  {
    "text": "across and once I have them local those databases are mine for the taking it",
    "start": "1327919",
    "end": "1335279"
  },
  {
    "text": "doesn't actually and this is something that's also kind of a misconception if you encrypt your",
    "start": "1335279",
    "end": "1340679"
  },
  {
    "text": "database on your server when I go off and make a new replica it actually decrypts it and sends me the information",
    "start": "1340679",
    "end": "1349039"
  },
  {
    "text": "unencrypted so when I'm storing that new replica unless I've chosen the option to encrypt that database it won't come to",
    "start": "1349039",
    "end": "1355679"
  },
  {
    "text": "me encrypted so this is how we can get around in this and when we're doing uh security",
    "start": "1355679",
    "end": "1363039"
  },
  {
    "text": "evaluations now here's here's something that a lot of you may have actually seen we didn't we didn't actually discover a",
    "start": "1365640",
    "end": "1371840"
  },
  {
    "text": "lot of these uh but they are out there and they are important and a lot of people aren't taking them",
    "start": "1371840",
    "end": "1377440"
  },
  {
    "text": "seriously and this is where we can use a domino server that's running the web server process and do various different",
    "start": "1377440",
    "end": "1384799"
  },
  {
    "text": "attacks using uh crafted Ural con constructs and I'm sure you've probably",
    "start": "1384799",
    "end": "1390200"
  },
  {
    "text": "seen the first couple the the Dollar open now Lo Lotus Notes actually did fix",
    "start": "1390200",
    "end": "1395279"
  },
  {
    "text": "this this was fixed in in the Domino release 5 because in in previous",
    "start": "1395279",
    "end": "1400799"
  },
  {
    "text": "versions in 45 and 46 it used to come along and the default was so that you could actually browse the entire file",
    "start": "1400799",
    "end": "1407200"
  },
  {
    "text": "system of the Domino server in the data directory uh they did turn that off by",
    "start": "1407200",
    "end": "1412600"
  },
  {
    "text": "default but we're still seeing this in release five servers and and our",
    "start": "1412600",
    "end": "1418200"
  },
  {
    "text": "only uh assumption that we can make on that is that that during a development",
    "start": "1418200",
    "end": "1424159"
  },
  {
    "text": "process people are turning that back on and they're go forgetting to go back and check this and so their server is",
    "start": "1424159",
    "end": "1430760"
  },
  {
    "text": "completely browsable across the internet and we can just hunt click and",
    "start": "1430760",
    "end": "1436120"
  },
  {
    "text": "pick which databases we want to try to access so this is a really bad thing you need to make sure that this is uh directory",
    "start": "1436120",
    "end": "1443320"
  },
  {
    "text": "browsing is turned off um the dollar default nav question",
    "start": "1443320",
    "end": "1448440"
  },
  {
    "text": "open Navigator you actually don't have to have the question mark open Navigator just the dollar default nav is enough um",
    "start": "1448440",
    "end": "1455520"
  },
  {
    "text": "this will actually allow you to bypass any customized views in in a notes database if a developer has gone off and",
    "start": "1455520",
    "end": "1462559"
  },
  {
    "text": "and created some special views a view for uh graphic developers uh or graph",
    "start": "1462559",
    "end": "1469360"
  },
  {
    "text": "people and another another view for uh Anonymous users another view for",
    "start": "1469360",
    "end": "1474919"
  },
  {
    "text": "salespeople all over the web interface using this you can bypass all",
    "start": "1474919",
    "end": "1480640"
  },
  {
    "text": "those and going back to the default Navigator and we'll show this to you here in a little bit um you can actually",
    "start": "1480640",
    "end": "1486880"
  },
  {
    "text": "then click point and click and choose which view you want to look at and see documents in there which weren't",
    "start": "1486880",
    "end": "1492559"
  },
  {
    "text": "actually meant for uh your eyes uh we see this a lot uh an example would be",
    "start": "1492559",
    "end": "1498440"
  },
  {
    "text": "like a head hunter who's got a website he's got a mailin database where he people can actually send in an email for",
    "start": "1498440",
    "end": "1505600"
  },
  {
    "text": "for those you don't who don't know a mailin database is basically just a standard notes database that's receiving",
    "start": "1505600",
    "end": "1511480"
  },
  {
    "text": "emails the emails get sent into the mail mailin database and automatically",
    "start": "1511480",
    "end": "1516679"
  },
  {
    "text": "processed by an agent it detaches uh the attachments of the email uh and stores",
    "start": "1516679",
    "end": "1522480"
  },
  {
    "text": "those and and notes documents for later retrieval from somebody internal in the organization",
    "start": "1522480",
    "end": "1528919"
  },
  {
    "text": "those types of databases like the example I'm using with a head hunter uh",
    "start": "1528919",
    "end": "1534679"
  },
  {
    "text": "they've got this on a on a web server and somebody could go along and start plucking those documents out a competing",
    "start": "1534679",
    "end": "1541799"
  },
  {
    "text": "Head Hunter could start retrieving those documents the resumés of all these other people which have signed up with this",
    "start": "1541799",
    "end": "1546919"
  },
  {
    "text": "one head hunter um so this is a really bad thing to have there's actually ways to filter",
    "start": "1546919",
    "end": "1553000"
  },
  {
    "text": "this out if if you're not sure if you haven't if you don't know about this one of the things you can do to filter this out",
    "start": "1553000",
    "end": "1559080"
  },
  {
    "text": "is to go into a file which is it's a text file that's in the data directory it's called",
    "start": "1559080",
    "end": "1564360"
  },
  {
    "text": "httpd do CNF and you can actually use that that's where your mime associations actually",
    "start": "1564360",
    "end": "1570840"
  },
  {
    "text": "are stored and you can actually create a filter that redirects to a document that says you're not allowed to use this",
    "start": "1570840",
    "end": "1577399"
  },
  {
    "text": "construct this URL construct and that's a really good way of filtering this out",
    "start": "1577399",
    "end": "1583039"
  },
  {
    "text": "uh you can also use that same filter for the the directory traversal which is right underneath there if you haven't",
    "start": "1583039",
    "end": "1589360"
  },
  {
    "text": "seen this directory traversal this is actually affects everything up till 56 or",
    "start": "1589360",
    "end": "1596559"
  },
  {
    "text": "56a well I think they fixed it in 56a I have to actually go",
    "start": "1596559",
    "end": "1602799"
  },
  {
    "text": "check yeah there's the only the only fixes the work around the propos fixes the ACD plan yeah okay all right so well",
    "start": "1602799",
    "end": "1610520"
  },
  {
    "text": "then you need to go in there and actually create an entry in in that httpd CNF file and you should actually",
    "start": "1610520",
    "end": "1617799"
  },
  {
    "text": "have uh everything that we've got listed up here in that file already filtering out",
    "start": "1617799",
    "end": "1623840"
  },
  {
    "text": "and redirecting to a page which is keeping people from performing these commands uh because there's no",
    "start": "1623840",
    "end": "1630440"
  },
  {
    "text": "legitimate use for any of these URL constructs uh with the exception of the",
    "start": "1630440",
    "end": "1636279"
  },
  {
    "text": "the directory traversal these are actually considered by lotus to be",
    "start": "1636279",
    "end": "1642520"
  },
  {
    "text": "features um and and I and we can't really find a valid use for these these",
    "start": "1642919",
    "end": "1649039"
  },
  {
    "text": "features uh so you need to you need to make sure you're filtering these out the",
    "start": "1649039",
    "end": "1654600"
  },
  {
    "text": "bottom one The View dollar read view entries uh this is a really interesting",
    "start": "1654600",
    "end": "1660760"
  },
  {
    "text": "one I don't think too many people are really familiar yet with yet this will actually allow you to retrieve your the",
    "start": "1660760",
    "end": "1668880"
  },
  {
    "text": "entire database in an XML pars uh response so if I actually open",
    "start": "1668880",
    "end": "1675360"
  },
  {
    "text": "up a database with that query or I open up even a view I will get all the",
    "start": "1675360",
    "end": "1681000"
  },
  {
    "text": "information parsed back in XML and this really becomes interesting because with the XML you can actually find",
    "start": "1681000",
    "end": "1689159"
  },
  {
    "text": "information quicker and navigate through the structure of the database with a fewer request going to the web server uh",
    "start": "1689159",
    "end": "1697440"
  },
  {
    "text": "this is also very interesting because most most administrators going back to the Dom log",
    "start": "1697440",
    "end": "1703399"
  },
  {
    "text": "which is the the logging file for uh the web server uh what a lot administrators",
    "start": "1703399",
    "end": "1709120"
  },
  {
    "text": "actually do are build customized views for different types of request they'll",
    "start": "1709120",
    "end": "1715320"
  },
  {
    "text": "actually filter out because they'll only want to see how many actual hits they're actually getting and which Pages they're",
    "start": "1715320",
    "end": "1721000"
  },
  {
    "text": "looking at they don't necessarily want to see all the jpegs and everything else so they'll they'll make a filter in",
    "start": "1721000",
    "end": "1727760"
  },
  {
    "text": "there for their view which will say just show me only a view of only HTML request",
    "start": "1727760",
    "end": "1734039"
  },
  {
    "text": "HTM and HTML documents so that there excludes jpegs gifs Java classes",
    "start": "1734039",
    "end": "1741519"
  },
  {
    "text": "anything like that because that's not so interesting to administrator want to see how many logs how many hits he's got by",
    "start": "1741519",
    "end": "1747559"
  },
  {
    "text": "doing the XML request you can just peruse the database and since you're actually requesting XML this won't show",
    "start": "1747559",
    "end": "1754880"
  },
  {
    "text": "up in his view of his Dom log so he won't actually even know that you're you're running around through databases",
    "start": "1754880",
    "end": "1760840"
  },
  {
    "text": "on his web server you going to do a thing of that um yeah we're going to come to it here",
    "start": "1760840",
    "end": "1766360"
  },
  {
    "text": "in a little bit I'm going to do a demonstration on on this um database issues here again going",
    "start": "1766360",
    "end": "1774320"
  },
  {
    "text": "back to something I said a little bit earlier uh the user IDs this is this is this is a really really nasty one and uh",
    "start": "1774320",
    "end": "1784440"
  },
  {
    "text": "as I as I said earlier vouter is going to show some stuff with this one of the reasons why these user",
    "start": "1784440",
    "end": "1790919"
  },
  {
    "text": "IDs end up in the names an address book is because notes administrators uh already have a pretty",
    "start": "1790919",
    "end": "1796600"
  },
  {
    "text": "rough job as it is they're having to create new users depending upon the size of the",
    "start": "1796600",
    "end": "1802679"
  },
  {
    "text": "organization if it's a pretty large one they're probably having to create a couple of new users every",
    "start": "1802679",
    "end": "1808679"
  },
  {
    "text": "week one of the features of domino or of the notes client is when you're",
    "start": "1808720",
    "end": "1814279"
  },
  {
    "text": "registering a user you have a choice of where where do you want to store the ID",
    "start": "1814279",
    "end": "1819799"
  },
  {
    "text": "file on your file system or in the names and address book and and this is",
    "start": "1819799",
    "end": "1824840"
  },
  {
    "text": "actually featured from lowest notes and the principal idea behind it is is that by storing in the names and address",
    "start": "1824840",
    "end": "1831640"
  },
  {
    "text": "book you can just go to your new your new employee and say you know there's the uh in installer on the the netware",
    "start": "1831640",
    "end": "1839279"
  },
  {
    "text": "file server just go run that fill in your name follow the little prompt boxes",
    "start": "1839279",
    "end": "1845399"
  },
  {
    "text": "and you'll get your ID file then and what notes actually goes off and does is when he does run the installer it will",
    "start": "1845399",
    "end": "1851240"
  },
  {
    "text": "query him for his username so he'll type in Chris goggin at SDI they don't use",
    "start": "1851240",
    "end": "1858440"
  },
  {
    "text": "notes by the way but he'll fill out his name and",
    "start": "1858440",
    "end": "1865000"
  },
  {
    "text": "notes will go off in the name and address book and look for the ID file and retrieve that and ask him where does",
    "start": "1865000",
    "end": "1871519"
  },
  {
    "text": "he want to deposit that on his local file system and this is a handy feature for",
    "start": "1871519",
    "end": "1877440"
  },
  {
    "text": "internal Administration until you get to an environment that has a shared uh installation between external",
    "start": "1877440",
    "end": "1885200"
  },
  {
    "text": "and internal environments and this this is this is where it gets",
    "start": "1885200",
    "end": "1891039"
  },
  {
    "text": "really bad because the name and address book is up there on the web and",
    "start": "1891039",
    "end": "1896880"
  },
  {
    "text": "it's do we need to call on emblems",
    "start": "1897000",
    "end": "1901960"
  },
  {
    "text": "no you okay all right um this is this where this is",
    "start": "1902919",
    "end": "1909960"
  },
  {
    "text": "really bad is is those ID files are presented when you actually open up the person document and the names and",
    "start": "1909960",
    "end": "1916279"
  },
  {
    "text": "address book it's right there at the bottom and and just like if you were to open up the names and address book and",
    "start": "1916279",
    "end": "1921720"
  },
  {
    "text": "the notes client you get the same view in the web browser notes has Lotus has",
    "start": "1921720",
    "end": "1926960"
  },
  {
    "text": "actually done a really fine job of of creating the same type or very similar interface over the web that you get with",
    "start": "1926960",
    "end": "1934679"
  },
  {
    "text": "the notes client so it's almost really client independent whichever one you choose you you basically get the same",
    "start": "1934679",
    "end": "1941039"
  },
  {
    "text": "information the same functionality and if you can see that ID file all you have to do is click and it will download to",
    "start": "1941039",
    "end": "1947440"
  },
  {
    "text": "your your local file system the other interesting thing is is",
    "start": "1947440",
    "end": "1953679"
  },
  {
    "text": "this is actually also another feature at the same time you're registering a user you have the ability to set the the HTTP",
    "start": "1953679",
    "end": "1962360"
  },
  {
    "text": "password to be the same as the ID file and this is this was one of the",
    "start": "1962360",
    "end": "1967559"
  },
  {
    "text": "things that we we released when we were at Devcon and we're still seeing a lot of this we're still seeing people out",
    "start": "1967559",
    "end": "1974240"
  },
  {
    "text": "there sharing the same password between the ID file and the the one stored in the",
    "start": "1974240",
    "end": "1979279"
  },
  {
    "text": "directory and where this gets really bad is we've got a little tool where if those passwords are the same we can then",
    "start": "1979279",
    "end": "1986960"
  },
  {
    "text": "compromise that person's identification because the the password",
    "start": "1986960",
    "end": "1992840"
  },
  {
    "text": "as it's stored and actually both the the uh the directory the ID file is using an",
    "start": "1992840",
    "end": "1999360"
  },
  {
    "text": "unsalted hash this is the same problem that Unix went through and painfully",
    "start": "1999360",
    "end": "2004679"
  },
  {
    "text": "discovered 15 years ago Windows discovered it went through it I think with Loft about five years ago now Lotus",
    "start": "2004679",
    "end": "2012480"
  },
  {
    "text": "is having to relearn the same lesson next",
    "start": "2012480",
    "end": "2018639"
  },
  {
    "text": "slide as I mentioned earlier the catalog database this is where it stores full",
    "start": "2019039",
    "end": "2024360"
  },
  {
    "text": "listing of all the databases with all the current acl's we've got a full it's it documents the full path to the",
    "start": "2024360",
    "end": "2030760"
  },
  {
    "text": "database so we know where it's at if we can view this database we'll know your entire file system contents",
    "start": "2030760",
    "end": "2038600"
  },
  {
    "text": "um next slide I kind of already talked about this one I think I got kind of",
    "start": "2038600",
    "end": "2044120"
  },
  {
    "text": "ahead of myself okay um we'll just whiz through these real quick uh yeah here's",
    "start": "2044120",
    "end": "2051240"
  },
  {
    "text": "another one and this is this is kind of really interesting notes notes kind of has something similar to the Unix Chron",
    "start": "2051240",
    "end": "2057638"
  },
  {
    "text": "tab it's called the admin Administration request database and administrators and and in",
    "start": "2057639",
    "end": "2063760"
  },
  {
    "text": "some instances a user can actually make a request it has to be authorized by the administrator but you can make a request",
    "start": "2063760",
    "end": "2070158"
  },
  {
    "text": "to the admin the the uh Administration request database and that principle idea behind",
    "start": "2070159",
    "end": "2076960"
  },
  {
    "text": "this if if you're wanting to do various tasks in a domino environment anything from uh full text full text indexing a",
    "start": "2076960",
    "end": "2084800"
  },
  {
    "text": "database to creating new replicas the the administrator doesn't want to tie up his notes client creating",
    "start": "2084800",
    "end": "2091919"
  },
  {
    "text": "a whole bunch of new replicas uh from one server to another especially when they're going across",
    "start": "2091919",
    "end": "2097720"
  },
  {
    "text": "ISDN connections or low bandwidth connections so the idea behind this is you can actually submit the request to",
    "start": "2097720",
    "end": "2104200"
  },
  {
    "text": "the administration database and then that will take care of the task that you've assigned it now we're seeing that",
    "start": "2104200",
    "end": "2112000"
  },
  {
    "text": "this database again is open on the web this means anybody who can browse this",
    "start": "2112000",
    "end": "2118200"
  },
  {
    "text": "and has right access to this can either delete the administration request in",
    "start": "2118200",
    "end": "2123440"
  },
  {
    "text": "there or make up some new ones so this is a really bad one as",
    "start": "2123440",
    "end": "2130280"
  },
  {
    "text": "well they they typically run as",
    "start": "2132200",
    "end": "2136359"
  },
  {
    "text": "admin the statistics of and events database this is another one this is",
    "start": "2137640",
    "end": "2143760"
  },
  {
    "text": "there is some redundancy in between this and and the logs the logging",
    "start": "2143760",
    "end": "2149040"
  },
  {
    "text": "databases but what this also does is watching for different types of events",
    "start": "2149040",
    "end": "2154359"
  },
  {
    "text": "if somebody changes an ACL on a server this is a little bit more compared to uh",
    "start": "2154359",
    "end": "2159960"
  },
  {
    "text": "although it does have some logging facilities in it it's almost kind of like a a miniaturized trip wire database",
    "start": "2159960",
    "end": "2166119"
  },
  {
    "text": "so you can configure to watch for particular events and take appropriate action if an ACL is changed on a",
    "start": "2166119",
    "end": "2172920"
  },
  {
    "text": "database send send an alert to the administrator if a user is logged in with a new new version client or is",
    "start": "2172920",
    "end": "2180160"
  },
  {
    "text": "running an old client send send an alert or take some other appropriate",
    "start": "2180160",
    "end": "2186040"
  },
  {
    "text": "action and there's a lot of people who set up and they'll take the time and they'll go off and they'll create a whole bunch of events to watch for ACL",
    "start": "2186040",
    "end": "2192640"
  },
  {
    "text": "changes and everything else and they forget to time the ACL of this",
    "start": "2192640",
    "end": "2198040"
  },
  {
    "text": "database so then so then the hacker or the attacker takes a look at this",
    "start": "2198040",
    "end": "2203200"
  },
  {
    "text": "database he's got right access to it he looks at the alerts that are triggered just goes right down the list and",
    "start": "2203200",
    "end": "2208240"
  },
  {
    "text": "deletes all of them before he starts doing a",
    "start": "2208240",
    "end": "2212480"
  },
  {
    "text": "penetration there are up to 58 possible default databases are installed with",
    "start": "2214160",
    "end": "2219240"
  },
  {
    "text": "every Domino server up to doesn't mean that depends on what you're actually configuring at",
    "start": "2219240",
    "end": "2225440"
  },
  {
    "text": "the installation if you're going to be running ldap if you're going to be running uh a POP 3 server um there's",
    "start": "2225440",
    "end": "2232960"
  },
  {
    "text": "various ways you can configure a domino server but there depending upon how you do that decides how many default",
    "start": "2232960",
    "end": "2240079"
  },
  {
    "text": "databases you're actually going to have installed most of those do not have the proper ACLS and this has actually been a",
    "start": "2240079",
    "end": "2247720"
  },
  {
    "text": "big issue I believe it was also lofted about three years ago who who made uh a",
    "start": "2247720",
    "end": "2254760"
  },
  {
    "text": "a small advisory about this discussing the the pro having the proper ACLS",
    "start": "2254760",
    "end": "2261160"
  },
  {
    "text": "although theirs was more catered towards the Dom config database Lotus actually only tackled that one database they",
    "start": "2261160",
    "end": "2267960"
  },
  {
    "text": "didn't bother to go back and look at their default installation or default acl's of all the other databases and",
    "start": "2267960",
    "end": "2275400"
  },
  {
    "text": "Lotus like all these big companies microsof off as well are are massive marketing machines they want you to get",
    "start": "2275400",
    "end": "2281040"
  },
  {
    "text": "in the driver's seat of their software and take it for a test drive before you",
    "start": "2281040",
    "end": "2286480"
  },
  {
    "text": "actually deploy it so it's why everything's wide open dur during the",
    "start": "2286480",
    "end": "2292119"
  },
  {
    "text": "install um they don't actually mean for you to go out and run it this way that",
    "start": "2292119",
    "end": "2297800"
  },
  {
    "text": "is not the intention but people are doing this and out of I would I would",
    "start": "2297800",
    "end": "2303160"
  },
  {
    "text": "dare to say out of 75% of all the systems out there we can get through most of them just using a standard web",
    "start": "2303160",
    "end": "2311920"
  },
  {
    "text": "browser all right I'm just going to give you a very quick little puny demonstration",
    "start": "2313520",
    "end": "2320119"
  },
  {
    "text": "here and and on oh let me let me explain what we've got here we we kind of had to tone it",
    "start": "2320119",
    "end": "2326079"
  },
  {
    "text": "down uh we have a serious lack of laptops in our company we tend to be too hardcore users",
    "start": "2326079",
    "end": "2333079"
  },
  {
    "text": "for those but so we actually brought a machine all the way from Holland uh it's",
    "start": "2333079",
    "end": "2338319"
  },
  {
    "text": "got everything on it we are actually running a release 5 server on here a",
    "start": "2338319",
    "end": "2344000"
  },
  {
    "text": "503 um and we've over here we've actually got uh just a little",
    "start": "2344000",
    "end": "2351400"
  },
  {
    "text": "Linux 586 dinky thing uh with hardly anything on here but I just wanted to",
    "start": "2351400",
    "end": "2358359"
  },
  {
    "text": "show this just as kind of a little proof of concept what we can actually do now",
    "start": "2358359",
    "end": "2363640"
  },
  {
    "text": "what we are actually going to do and what I was talking about earlier the catalog database there's all sorts of",
    "start": "2363640",
    "end": "2368760"
  },
  {
    "text": "information in there which is extremely valuable and what we can do is actually",
    "start": "2368760",
    "end": "2376200"
  },
  {
    "text": "think I still have this is the server running it is okay",
    "start": "2376200",
    "end": "2381640"
  },
  {
    "text": "what we're going to do is I've got a little script here which is",
    "start": "2381640",
    "end": "2386960"
  },
  {
    "text": "uh yeah pull up the server console just let them see one of the things on the server",
    "start": "2387240",
    "end": "2393520"
  },
  {
    "text": "console if you're doing if you're doing a request on there and you actually request something something that's not there you don't have access to if you're",
    "start": "2393520",
    "end": "2400119"
  },
  {
    "text": "requesting a a a notes database you'll actually see errors come up so if you're",
    "start": "2400119",
    "end": "2405359"
  },
  {
    "text": "trying to find uh notes databases that might or might not be",
    "start": "2405359",
    "end": "2411920"
  },
  {
    "text": "installed uh let's say just the Dom log and you're trying to figure out if they",
    "start": "2411920",
    "end": "2417119"
  },
  {
    "text": "actually even have the Dom log turned on and have a Dom log database it will actually produce errors coming up on",
    "start": "2417119",
    "end": "2423880"
  },
  {
    "text": "this the server console screen that you'll actually see here um and to give you an",
    "start": "2423880",
    "end": "2431720"
  },
  {
    "text": "example I just do this real",
    "start": "2433280",
    "end": "2437599"
  },
  {
    "text": "quick what I'll do is I'll request a database that's not actually even there just so you can see this error",
    "start": "2442839",
    "end": "2451520"
  },
  {
    "text": "message because you're ugly",
    "start": "2451560",
    "end": "2456400"
  },
  {
    "text": "oh crap I don't excuse me I don't even have netcat on here this is how slim down this",
    "start": "2458520",
    "end": "2464560"
  },
  {
    "text": "system is yeah okay we'll just do it here browser",
    "start": "2464560",
    "end": "2471480"
  },
  {
    "text": "so if we actually request this you see on the server screen at the very bottom line",
    "start": "2493359",
    "end": "2499720"
  },
  {
    "text": "the file does not exist so this will actually tip off an administrator that's watching the this the console or is",
    "start": "2499720",
    "end": "2506800"
  },
  {
    "text": "looking through the log. NSF this will actually show up there in the log NSF database it'll come up because the login",
    "start": "2506800",
    "end": "2513560"
  },
  {
    "text": "SF actually logs the server console and he'll see somebody was actually trying to probe for databases which may or may",
    "start": "2513560",
    "end": "2519640"
  },
  {
    "text": "have not been there so using a little script here",
    "start": "2519640",
    "end": "2525359"
  },
  {
    "text": "which is instead going to request an XML produced document from the catalog",
    "start": "2525359",
    "end": "2532200"
  },
  {
    "text": "database if you now look over here you're going to see a whole bunch of fun stuff come",
    "start": "2532200",
    "end": "2538640"
  },
  {
    "text": "up and this is the XML and I've just parsed it out to make it more readable",
    "start": "2538640",
    "end": "2544520"
  },
  {
    "text": "you've got the name of the catalog database I'm actually going to stop this this is going to produce a whole ton of",
    "start": "2544520",
    "end": "2549960"
  },
  {
    "text": "stuff but I want to give you a description of what you got here this is actually right here is the notes server",
    "start": "2549960",
    "end": "2556359"
  },
  {
    "text": "or the notes database name and then down here is the actual database file name",
    "start": "2556359",
    "end": "2562880"
  },
  {
    "text": "and the path and in this case this is actually a database template and what I'm doing is I'm",
    "start": "2562880",
    "end": "2568400"
  },
  {
    "text": "actually parsing the XML and I'm I'm actually adding a bit stuff a little bit of stuff in here so",
    "start": "2568400",
    "end": "2574960"
  },
  {
    "text": "if I was running this say under gnome under l and a gome terminal I would actually",
    "start": "2574960",
    "end": "2580319"
  },
  {
    "text": "that would even be clickable and that's how how quickly I could go into a notes database so I could click on that and",
    "start": "2580319",
    "end": "2586839"
  },
  {
    "text": "pop it open in Netscape and go right to it this is also the notes ID right here of that database or the replica ID of",
    "start": "2586839",
    "end": "2593920"
  },
  {
    "text": "the database and we also get the creation date and time of the database which server is on and the reason that",
    "start": "2593920",
    "end": "2601559"
  },
  {
    "text": "this is important is because in in various environments it's that uh one",
    "start": "2601559",
    "end": "2609680"
  },
  {
    "text": "environment will share one massive catalog database so although we could request this information from in this",
    "start": "2609680",
    "end": "2616359"
  },
  {
    "text": "case the wind NT server this might be on another server their web server or their Solaris server U and not on the",
    "start": "2616359",
    "end": "2623200"
  },
  {
    "text": "particular data the particular server that we're quering so we would then end",
    "start": "2623200",
    "end": "2628559"
  },
  {
    "text": "up with this information and know we'd have to go to a different server to get access to that",
    "start": "2628559",
    "end": "2633800"
  },
  {
    "text": "database underneath that you can see that Anonymous is set to designer uh this is pretty much a",
    "start": "2633800",
    "end": "2641160"
  },
  {
    "text": "standard installation of this the Domino server we haven't really changed anything on here I think maybe one or",
    "start": "2641160",
    "end": "2646760"
  },
  {
    "text": "two databases for some other stuff we're going to do later but this is all pretty much standard and I'm actually only",
    "start": "2646760",
    "end": "2654000"
  },
  {
    "text": "pulling up anything that is marked I'm going to do this and let it run now I'm",
    "start": "2654000",
    "end": "2659160"
  },
  {
    "text": "I'm only pulling up stuff which is set for default and Anonymous",
    "start": "2659160",
    "end": "2664400"
  },
  {
    "text": "access so if we let this run you'll see how many databases that we could actually get to in a notes",
    "start": "2664400",
    "end": "2670520"
  },
  {
    "text": "environment and this this is a really slow little lenux laptop but this is actually only issuing also again uh I'm",
    "start": "2670520",
    "end": "2677800"
  },
  {
    "text": "actually retrieving all this information from three three U HTTP",
    "start": "2677800",
    "end": "2684319"
  },
  {
    "text": "request so we're not having to create a flurry of entries in their Domino server",
    "start": "2684319",
    "end": "2689760"
  },
  {
    "text": "log that would tip off an administrator and in all likelihood he's actually got everything but HTML request fil filtered",
    "start": "2689760",
    "end": "2697319"
  },
  {
    "text": "out anyway so he'll never actually see this unless he's very aware of this and is going off to look for",
    "start": "2697319",
    "end": "2705078"
  },
  {
    "text": "this and yeah as you see over here there's nothing over here on the server console but we are getting the full path",
    "start": "2706680",
    "end": "2713119"
  },
  {
    "text": "you can actually see the different subdirectories down in here so we know exactly where every database is on is on",
    "start": "2713119",
    "end": "2719640"
  },
  {
    "text": "on that",
    "start": "2719640",
    "end": "2722039"
  },
  {
    "text": "server not yet okay we're go we're we've we're we're",
    "start": "2724960",
    "end": "2730480"
  },
  {
    "text": "now uh discussing that internally we're probably going to make everything available in the next few months probably at black hat",
    "start": "2730480",
    "end": "2738200"
  },
  {
    "text": "July um this actually isn't a patch this isn't something really to patch for this",
    "start": "2738440",
    "end": "2743680"
  },
  {
    "text": "is this is just general stupidity don't mean to insult anybody",
    "start": "2743680",
    "end": "2750160"
  },
  {
    "text": "with that but that's you know basically we we've pulled up everything there that's on that server I'm sorry",
    "start": "2750160",
    "end": "2758920"
  },
  {
    "text": "the riew riew",
    "start": "2762920",
    "end": "2766318"
  },
  {
    "text": "entries we can do",
    "start": "2769040",
    "end": "2772520"
  },
  {
    "text": "that you know what yeah",
    "start": "2777880",
    "end": "2784319"
  },
  {
    "text": "uh actually I forgot okay",
    "start": "2787440",
    "end": "2792558"
  },
  {
    "text": "yeah yeah Access Control by it yeah",
    "start": "2795040",
    "end": "2800200"
  },
  {
    "text": "okay Netscape doesn't actually understand XML but it will conveniently open it for us",
    "start": "2813559",
    "end": "2819559"
  },
  {
    "text": "and explore and there you go that's that's actually all I'm",
    "start": "2819559",
    "end": "2825960"
  },
  {
    "text": "parsing and I'm just making it more",
    "start": "2825960",
    "end": "2830000"
  },
  {
    "text": "readable and everyone's familiar with what you can do with the directory traversal attack show that anyway yeah",
    "start": "2832960",
    "end": "2841040"
  },
  {
    "text": "yeah that's really cool down we actually were just doing",
    "start": "2841040",
    "end": "2846880"
  },
  {
    "text": "doing it a second ago with this and there is a clear Distinction on this what we actually recommend and we",
    "start": "2846880",
    "end": "2853599"
  },
  {
    "text": "actually had recommended this prior before this actually came out when we're doing client",
    "start": "2853599",
    "end": "2858880"
  },
  {
    "text": "consultancy is it's typical for a lot of people to install",
    "start": "2858880",
    "end": "2864040"
  },
  {
    "text": "um the binaries on a separate Drive usually on C drive with where their their window andt installation is and",
    "start": "2864040",
    "end": "2870920"
  },
  {
    "text": "install all the the notes data directories on a raid five on Drive D or something uh but we we actually",
    "start": "2870920",
    "end": "2877280"
  },
  {
    "text": "recommend that you stick the binaries on another partition on Drive D and use",
    "start": "2877280",
    "end": "2882400"
  },
  {
    "text": "Drive e for your data directory and that could be raid five or whatever the reason for this",
    "start": "2882400",
    "end": "2887880"
  },
  {
    "text": "is in the directory traversal attack um it it's actually you can Traverse the",
    "start": "2887880",
    "end": "2894240"
  },
  {
    "text": "directory of where the binaries are actually installed in so in this case our installation here our demo",
    "start": "2894240",
    "end": "2900040"
  },
  {
    "text": "installation we didn't quite follow our own example for this but uh we actually have the binaries",
    "start": "2900040",
    "end": "2906400"
  },
  {
    "text": "installed on Drive C and with that we can actually issue the",
    "start": "2906400",
    "end": "2913599"
  },
  {
    "text": "request we'll go save",
    "start": "2913599",
    "end": "2917319"
  },
  {
    "text": "it yeah give you give you a basic rundown basically the Domino interface doesn't",
    "start": "2920359",
    "end": "2927319"
  },
  {
    "text": "parse correctly any request that begins with NSF so by specifying something that",
    "start": "2927319",
    "end": "2935119"
  },
  {
    "text": "that's NSF followed by by you know dot do do do do Dot and then whatever",
    "start": "2935119",
    "end": "2941280"
  },
  {
    "text": "whatever directory you want to that's in that same file system so on here what",
    "start": "2941280",
    "end": "2946799"
  },
  {
    "text": "Kevin's done is done dowin win.ini but that could just as",
    "start": "2946799",
    "end": "2952440"
  },
  {
    "text": "easily have been do do do do lusata uh notes.ini or notes data",
    "start": "2952440",
    "end": "2961480"
  },
  {
    "text": "server. ID or uh repair yeah so you can grab yes rest oh",
    "start": "2961480",
    "end": "2969480"
  },
  {
    "text": "yeah yeah yeah basically anything like I said if if the binaries are actually",
    "start": "2969480",
    "end": "2974599"
  },
  {
    "text": "installed on Drive C then you can pull anything off Drive",
    "start": "2974599",
    "end": "2980240"
  },
  {
    "text": "C I'm sorry yeah yeah domino domino actually",
    "start": "2982440",
    "end": "2989559"
  },
  {
    "text": "has to be installed as the system and the system user now also understand that that that doesn't work on uh Unix based",
    "start": "2989559",
    "end": "2998599"
  },
  {
    "text": "servers or uh os400 or mvs based servers",
    "start": "2998599",
    "end": "3004599"
  },
  {
    "text": "but you know most of them are in anyway so yeah okay that's it I'm one handed",
    "start": "3004599",
    "end": "3012920"
  },
  {
    "text": "over oh we're going to actually break no no that shouldn't be in there",
    "start": "3012920",
    "end": "3018440"
  },
  {
    "text": "oh that was your quick break between part one and part two of part one okay so I'm going to turn it over to valter",
    "start": "3018440",
    "end": "3025280"
  },
  {
    "text": "now a",
    "start": "3025280",
    "end": "3028640"
  },
  {
    "text": "uh yeah probably about at black hat July is when we're looking at that's not",
    "start": "3030920",
    "end": "3036040"
  },
  {
    "text": "definitive yet we're still discussing it internally and trying to figure out part of the problem is that when we actually",
    "start": "3036040",
    "end": "3042839"
  },
  {
    "text": "released all this stuff uh a year ago at Defcon um as as Chris kind of mentioned",
    "start": "3042839",
    "end": "3048760"
  },
  {
    "text": "this before we looked at this and because the consequences of of going public with all the stuff that we've",
    "start": "3048760",
    "end": "3054240"
  },
  {
    "text": "done we felt was going to cause way too much chaos out there we do believe in",
    "start": "3054240",
    "end": "3059599"
  },
  {
    "text": "full disclosure but yet at the same time we had to consider the CIA and everybody",
    "start": "3059599",
    "end": "3064640"
  },
  {
    "text": "else is running Domino uh the reason there's there's actually a good reason for this um there's actually the",
    "start": "3064640",
    "end": "3071480"
  },
  {
    "text": "Department of Defense outlined some specs uh it was called the defense messaging system and they were a set of",
    "start": "3071480",
    "end": "3078000"
  },
  {
    "text": "requirements for anybody in the intelligence Community or the dod uh had to meet or the software had to meet",
    "start": "3078000",
    "end": "3085160"
  },
  {
    "text": "these specs in order to comply with the defense messaging system and it was supposed to be the say standards for",
    "start": "3085160",
    "end": "3091480"
  },
  {
    "text": "secure messaging and all that there only two platforms which actually meet those requirements it may have changed in the",
    "start": "3091480",
    "end": "3097599"
  },
  {
    "text": "last year I actually haven't checked it but I I feel that probably hasn't changed uh and the only two products",
    "start": "3097599",
    "end": "3104000"
  },
  {
    "text": "which met it was trusted Solaris and Lotus Notes and we felt that if we' gone with",
    "start": "3104000",
    "end": "3110400"
  },
  {
    "text": "full disclosure there was too too much that could have gone wrong and too many script kitties who may have taken",
    "start": "3110400",
    "end": "3116760"
  },
  {
    "text": "advantage of this this is why we actually employed why we called up Chris and his company and said let's do kind",
    "start": "3116760",
    "end": "3123440"
  },
  {
    "text": "of a limited disclosure with third party validation so we contacted them we sent",
    "start": "3123440",
    "end": "3129480"
  },
  {
    "text": "them all the stuff they looked at they said sure enough we can reproduce all this and they stuck their name behind",
    "start": "3129480",
    "end": "3135359"
  },
  {
    "text": "everything that we had discovered and we jointly made the presentation it however now has been 9 months and Lotus really",
    "start": "3135359",
    "end": "3143280"
  },
  {
    "text": "kind of although we had informed Lotus even way before defc con last year six",
    "start": "3143280",
    "end": "3148920"
  },
  {
    "text": "months before yeah about 6 months before that all this stuff was coming out um after Defcon we we had actually",
    "start": "3148920",
    "end": "3157200"
  },
  {
    "text": "even invited him to attend at Defcon and they uh politely turned us down but we",
    "start": "3157200",
    "end": "3162960"
  },
  {
    "text": "we kind of felt that we had we had a really good working relationship with them um and that we weren't trying to attack each other at after Defcon they",
    "start": "3162960",
    "end": "3170799"
  },
  {
    "text": "released a whole PR and really played spin doctor as Chris said and they were you know like yeah that happened and",
    "start": "3170799",
    "end": "3177040"
  },
  {
    "text": "it's not really you know these are features and blah blah blah blah and just really played the whole thing down",
    "start": "3177040",
    "end": "3184640"
  },
  {
    "text": "so people are still running completely vulnerable and we're going to do in the",
    "start": "3184640",
    "end": "3189680"
  },
  {
    "text": "second half of the presentation we're really going to show you yeah the second half of the second",
    "start": "3189680",
    "end": "3195720"
  },
  {
    "text": "half of the presentation uh we're going to show you some examples of this some",
    "start": "3195720",
    "end": "3202119"
  },
  {
    "text": "some real online examples of this you think it's ironic a d",
    "start": "3202119",
    "end": "3209640"
  },
  {
    "text": "more I'm sorry well I yeah my my uh my my father",
    "start": "3209640",
    "end": "3217480"
  },
  {
    "text": "was a general in the air force uh I have an uncle who was a former joint Chief of Staff so I'm I'm sensitive to the to",
    "start": "3217480",
    "end": "3225599"
  },
  {
    "text": "their uh needs and everything else he said does it it's ironic that a",
    "start": "3225599",
    "end": "3233040"
  },
  {
    "text": "Dutch resident an American resident living in Holland is a more more sensitive to the needs than IBM are the",
    "start": "3233040",
    "end": "3238599"
  },
  {
    "text": "security needs of the intelligence community so yeah I mean I'm I'm sensitive towards it and and I Chris",
    "start": "3238599",
    "end": "3246319"
  },
  {
    "text": "Chris does a lot of Government Contracting as well too and you know we had to kind of look at what was the best",
    "start": "3246319",
    "end": "3251359"
  },
  {
    "text": "for the world and our clients and we tried to find a balance there and the point was that Lotus was given has been",
    "start": "3251359",
    "end": "3257520"
  },
  {
    "text": "given ample time and all they've responded with was press releases rather",
    "start": "3257520",
    "end": "3262760"
  },
  {
    "text": "than fixes and you know you reach a point to where you say okay you want to work with a vendor you want to make sure that",
    "start": "3262760",
    "end": "3268760"
  },
  {
    "text": "everybody's protected and everybody can get in get workarounds in place before",
    "start": "3268760",
    "end": "3274359"
  },
  {
    "text": "you actually go out and start releasing source code to tools that can open up any note server well coming up in July",
    "start": "3274359",
    "end": "3281040"
  },
  {
    "text": "it'll be a full year and at that point you just kind of have to shake your head and say well long enough maybe you'll take it",
    "start": "3281040",
    "end": "3288000"
  },
  {
    "text": "seriously now so so we're we're now we're unless unless we can come up with",
    "start": "3288000",
    "end": "3293799"
  },
  {
    "text": "some reason not to in the next couple of months before black hat July we're probably be cleaning up the source code",
    "start": "3293799",
    "end": "3300079"
  },
  {
    "text": "and everything else everything we've done up till now and we will release",
    "start": "3300079",
    "end": "3305400"
  },
  {
    "text": "it so this point I'm going to turn over to valter",
    "start": "3305400",
    "end": "3311960"
  },
  {
    "text": "yeah I'm probably no I'm probably going to sit there you're going to there thanks",
    "start": "3311960",
    "end": "3320440"
  },
  {
    "text": "correct exactly correct well you'll see the special stuff right now we're slowly",
    "start": "3328559",
    "end": "3333839"
  },
  {
    "text": "building up be patient you'll be glad you did it's it's it's gets it's a slow burn but",
    "start": "3333839",
    "end": "3341240"
  },
  {
    "text": "it has a nice Crescendo if if we just went straight into the hardcore tools for the people who's here are not",
    "start": "3341240",
    "end": "3346480"
  },
  {
    "text": "familiar with notes and Domo they would be like what the heck are we doing so we're trying to take it kind of slow and easy and explain a lot of the concepts",
    "start": "3346480",
    "end": "3352920"
  },
  {
    "text": "behind this before we get into it did you put that stuff in between by the way what you found on okay um",
    "start": "3352920",
    "end": "3361160"
  },
  {
    "text": "anybody can hear me okay um we're now going to do some uh stuff that uh well",
    "start": "3361160",
    "end": "3367520"
  },
  {
    "text": "issue number six out of the the eight or nine I believe in total is uh is also a known",
    "start": "3367520",
    "end": "3373680"
  },
  {
    "text": "vulnerability uh and before I can explain that a bit I have to go a little bit deeper into a not database structure",
    "start": "3373680",
    "end": "3380480"
  },
  {
    "text": "if you look at a not database structure it basically consists of data uh",
    "start": "3380480",
    "end": "3385599"
  },
  {
    "text": "structure data Rich Text HTML Etc and forms or Design",
    "start": "3385599",
    "end": "3391280"
  },
  {
    "text": "Elements but for the purpose of the stored form vulnerability I will restrict it to just",
    "start": "3391280",
    "end": "3397720"
  },
  {
    "text": "forms this better I think he's going to turn it up yeah you want to hold the",
    "start": "3402440",
    "end": "3408440"
  },
  {
    "text": "mic uh that's a bit inconvenient if I start doing",
    "start": "3408440",
    "end": "3413520"
  },
  {
    "text": "uh blah blah blah blah blah blah blah this better testing 1 two 3 oh yeah that's",
    "start": "3413520",
    "end": "3421599"
  },
  {
    "text": "okay thank you um so data and Design Elements SL",
    "start": "3421599",
    "end": "3427799"
  },
  {
    "text": "forms forms are used to render that data in a database forms also consist of",
    "start": "3427799",
    "end": "3434280"
  },
  {
    "text": "programmable events such as a document open Event a post open query open",
    "start": "3434280",
    "end": "3439440"
  },
  {
    "text": "document close Etc and you can program either formula language load script or",
    "start": "3439440",
    "end": "3444599"
  },
  {
    "text": "Java into it now the deal with stor forms is as follows um suppose you want to make data",
    "start": "3444599",
    "end": "3452480"
  },
  {
    "text": "remotely available there's a very powerful feature in Lotus noes and that's email so you can email a piece of",
    "start": "3452480",
    "end": "3459400"
  },
  {
    "text": "data towards a remote user but he will have a problem in looking at that data",
    "start": "3459400",
    "end": "3465039"
  },
  {
    "text": "because the the form that is used to render that data is not available in his mail file so therefore Lotus has",
    "start": "3465039",
    "end": "3471920"
  },
  {
    "text": "implemented the fut stor form where you can send off an email that consist of the data plus the form definition into",
    "start": "3471920",
    "end": "3479599"
  },
  {
    "text": "it and if you send that off to a remote user the user can open that document",
    "start": "3479599",
    "end": "3484720"
  },
  {
    "text": "with that stored form a little bit background the the",
    "start": "3484720",
    "end": "3491440"
  },
  {
    "text": "issue of the stored forms was reported uh in 1996 at least that's the first",
    "start": "3491440",
    "end": "3496559"
  },
  {
    "text": "occurrence I could find the vulnerability by itself is is much older I think um and I actually found an",
    "start": "3496559",
    "end": "3504280"
  },
  {
    "text": "article in uh in their speak uh which dealt with it and Lotus implemented the uh the ecl the execution",
    "start": "3504280",
    "end": "3511000"
  },
  {
    "text": "control list in release 45 to to uh deal with that",
    "start": "3511000",
    "end": "3516079"
  },
  {
    "text": "situation four years later well five years now uh what we see out there in",
    "start": "3516079",
    "end": "3521960"
  },
  {
    "text": "the market is that very few people have the ecl set up properly and almost everybody is",
    "start": "3521960",
    "end": "3528920"
  },
  {
    "text": "allowing stor forms in their email and that's dangerous now with release 502 things",
    "start": "3528920",
    "end": "3536200"
  },
  {
    "text": "become a bit different but I'll go into that deeper later on another interesting thing is what what Chris pointed out to",
    "start": "3536200",
    "end": "3542359"
  },
  {
    "text": "me is you found uh in Bure what was it yeah someone put out an",
    "start": "3542359",
    "end": "3547960"
  },
  {
    "text": "advisory two weeks ago that he uh he discovered the wheel again he said oh gee there's a vulnerability in with stor",
    "start": "3547960",
    "end": "3554200"
  },
  {
    "text": "forms in loaded nose",
    "start": "3554200",
    "end": "3559440"
  },
  {
    "text": "amazing um the purpose again of of stor forms is is very handy in in work flow",
    "start": "3559920",
    "end": "3566440"
  },
  {
    "text": "applications and it's also very handy uh for client Administration if you have to",
    "start": "3566440",
    "end": "3571720"
  },
  {
    "text": "to do something on a client you can send off a St form which executes particular things to to modify the client",
    "start": "3571720",
    "end": "3579520"
  },
  {
    "text": "install and the problem with it is that stor form feature is enabled by default",
    "start": "3579520",
    "end": "3585319"
  },
  {
    "text": "in every database that is deployed so you have to switch it off in order to disable",
    "start": "3585319",
    "end": "3591680"
  },
  {
    "text": "it and if you program the query open event then you end up with a situation",
    "start": "3591680",
    "end": "3597680"
  },
  {
    "text": "where you can make the client perform actions without user interaction and I",
    "start": "3597680",
    "end": "3603400"
  },
  {
    "text": "think that is kind of interesting because of uh what was it Bubble Boy was the first fires that the people were so",
    "start": "3603400",
    "end": "3610039"
  },
  {
    "text": "frustrated about well loot of notes had it way",
    "start": "3610039",
    "end": "3614960"
  },
  {
    "text": "before and very interesting uh and I'm not sure whether that still goes for release five but in in releas four",
    "start": "3615079",
    "end": "3622680"
  },
  {
    "text": "environments St forms were transmittable over SM P so you could basically send a St form",
    "start": "3622680",
    "end": "3631440"
  },
  {
    "text": "to any mail user that is using notes over the",
    "start": "3631440",
    "end": "3637440"
  },
  {
    "text": "Internet no exactly as as soon as you open he doesn't even have to do anything",
    "start": "3642200",
    "end": "3647440"
  },
  {
    "text": "all he has to do is open his mail boom no picking on attachments no nothing just the mere fact of viewing that piece",
    "start": "3647440",
    "end": "3654520"
  },
  {
    "text": "of mail will cause the the form element to execute if you've constructed it right and that's what voucher is about",
    "start": "3654520",
    "end": "3660000"
  },
  {
    "text": "to do um again the setup we have a 503 uh Domino server and I have uh three",
    "start": "3660000",
    "end": "3667559"
  },
  {
    "text": "clients one is Mr in Breer which is Dutch for Intruder uh and I have a r46 user that",
    "start": "3667559",
    "end": "3674680"
  },
  {
    "text": "is a client that will act as a victim and he's using a 4.6 notes client and I",
    "start": "3674680",
    "end": "3681359"
  },
  {
    "text": "have another user which is running an R5 client as a victim",
    "start": "3681359",
    "end": "3686480"
  },
  {
    "text": "now let me switch to the perspective of the Intruder Mr in",
    "start": "3686480",
    "end": "3693119"
  },
  {
    "text": "Breer and uh I've prepared my homework a little by designing a form that will act",
    "start": "3693119",
    "end": "3699319"
  },
  {
    "text": "as a stored form and what I will do is",
    "start": "3699319",
    "end": "3704839"
  },
  {
    "text": "uh create an a message with that stored",
    "start": "3704960",
    "end": "3710838"
  },
  {
    "text": "form and uh we will fire it off against that release 4 six user now before we do",
    "start": "3711240",
    "end": "3718920"
  },
  {
    "text": "that again the purpose of this of of this demonstration is to show that from",
    "start": "3718920",
    "end": "3725200"
  },
  {
    "text": "remote we can make him do things that we that we want as an attacker at this",
    "start": "3725200",
    "end": "3732480"
  },
  {
    "text": "moment I don't have access on his mail file his his mail file is properly configured from ACL so if I try to look",
    "start": "3732480",
    "end": "3739960"
  },
  {
    "text": "at it with a web browser I will be prompted with a password yeah and as an",
    "start": "3739960",
    "end": "3745319"
  },
  {
    "text": "intruder you don't have the username and password for this mail file so you don't have access to",
    "start": "3745319",
    "end": "3752520"
  },
  {
    "text": "it now there something that can be done about it namely if you send a stored",
    "start": "3752520",
    "end": "3760079"
  },
  {
    "text": "form put some stuff in here and send that stor form",
    "start": "3762240",
    "end": "3768359"
  },
  {
    "text": "to the victim okay there you go it's been sent now in",
    "start": "3768359",
    "end": "3774640"
  },
  {
    "text": "order to look at what's going to happen from the victim perspective I will shut down the",
    "start": "3774640",
    "end": "3779680"
  },
  {
    "text": "not five client and start up a 46 client as the",
    "start": "3779680",
    "end": "3785279"
  },
  {
    "text": "victim I think this is his nail file the victim has to log in",
    "start": "3800000",
    "end": "3807760"
  },
  {
    "text": "okay here you see he's got several other emails but this is the email that was sent",
    "start": "3814079",
    "end": "3819400"
  },
  {
    "text": "today so now what's what happens as soon as I press enter I only press enter to",
    "start": "3819400",
    "end": "3824839"
  },
  {
    "text": "open the email and that is something you cannot blame a user yeah just opening the email so I'm going to open it we can",
    "start": "3824839",
    "end": "3831880"
  },
  {
    "text": "look at email and scy yeah it must have pressed delete instead of",
    "start": "3831880",
    "end": "3838559"
  },
  {
    "text": "enter cuz there's nothing in here he didn't send anything yeah to",
    "start": "3838559",
    "end": "3845920"
  },
  {
    "text": "something from December 12th but there's there's nothing the email disappeared from his",
    "start": "3845920",
    "end": "3852160"
  },
  {
    "text": "inbox so nothing happened he must have made a mistake let's go back to the Intruder and see what the result is from",
    "start": "3852160",
    "end": "3860640"
  },
  {
    "text": "this action so I have to start up the release five client",
    "start": "3860640",
    "end": "3867720"
  },
  {
    "text": "noes and we're going to read his email and as you can see he",
    "start": "3881400",
    "end": "3888440"
  },
  {
    "text": "just received an email from the victim and if we open that email",
    "start": "3888440",
    "end": "3897480"
  },
  {
    "text": "what you will see is Their audience I have just granted manager access to the Intruder and he also attached the URL to",
    "start": "3897480",
    "end": "3904799"
  },
  {
    "text": "his mail file so if we go to that mail file now what you will notice is that uh",
    "start": "3904799",
    "end": "3912839"
  },
  {
    "text": "there is no longer a password required in fact Anonymous was manage",
    "start": "3912839",
    "end": "3919839"
  },
  {
    "text": "you now one of the important things to note about this is that this is just one",
    "start": "3919839",
    "end": "3925240"
  },
  {
    "text": "simple basic example by using Lotus script voucher could have just as easily",
    "start": "3925240",
    "end": "3931160"
  },
  {
    "text": "formatted the guy's hard drive granted access to every database that this guy had access to send every copy of that",
    "start": "3931160",
    "end": "3937880"
  },
  {
    "text": "guy's email box back or he could have sent over a copy of back orifice",
    "start": "3937880",
    "end": "3943760"
  },
  {
    "text": "executed that and the user would never know anything he would have never clicked on an attachment he would have",
    "start": "3943760",
    "end": "3949920"
  },
  {
    "text": "never done anything so the whole you know you can reimplement a combination of I love you and Bubble Boy and one",
    "start": "3949920",
    "end": "3956640"
  },
  {
    "text": "nasty virus targeted at Lotus Notes and there's nothing anybody can do about it if they have stored forms turned",
    "start": "3956640",
    "end": "3962520"
  },
  {
    "text": "on and and I have to interject one thing one of the reasons they have stored forums enabled and the notes database is",
    "start": "3962520",
    "end": "3969799"
  },
  {
    "text": "that there's a lot of third-party applications document management uh Quality Management Systems which are uh",
    "start": "3969799",
    "end": "3977799"
  },
  {
    "text": "used under Lotus Notes that actually take advantage of that functionality and it it's required for",
    "start": "3977799",
    "end": "3983960"
  },
  {
    "text": "document processing and everything else internal in the organization so lotus's response is if you don't need you know",
    "start": "3983960",
    "end": "3991559"
  },
  {
    "text": "you if if you're worried about this go turn off stored forms but if you do that then you break all these third party",
    "start": "3991559",
    "end": "3997319"
  },
  {
    "text": "applications which you've just spent you know thousands maybe even hundreds of thousands of dollars to buy from a Lotus",
    "start": "3997319",
    "end": "4003400"
  },
  {
    "text": "business partner to run on your not in your notes environment which was the whole idea of why you went to notes from",
    "start": "4003400",
    "end": "4009400"
  },
  {
    "text": "exchange anyway so [Music]",
    "start": "4009400",
    "end": "4017650"
  },
  {
    "text": "okay um so this were all documented and known",
    "start": "4022359",
    "end": "4028440"
  },
  {
    "text": "vulnerabilities and we've done some research ourselves as well for the past two and a half years and uh I'm going to",
    "start": "4028440",
    "end": "4036160"
  },
  {
    "text": "talk about that um well we've we've dealt with this",
    "start": "4036160",
    "end": "4043279"
  },
  {
    "text": "Devcon what we are going to discuss is research on these areas Design Elements",
    "start": "4043279",
    "end": "4051039"
  },
  {
    "text": "the bypassing of the execution control list the uh F5 function key clear user",
    "start": "4051039",
    "end": "4059400"
  },
  {
    "text": "preferences password hashing and ID file",
    "start": "4059400",
    "end": "4064400"
  },
  {
    "text": "validation if you look at the noes Design Elements the we we find that they are",
    "start": "4065319",
    "end": "4072359"
  },
  {
    "text": "stored in obscure locations within a notes database if you access Design Elements as regular",
    "start": "4072359",
    "end": "4080559"
  },
  {
    "text": "notes documents then the only thing you require to manipulate the design of an",
    "start": "4080559",
    "end": "4087000"
  },
  {
    "text": "application is editor access instead of designer access",
    "start": "4087000",
    "end": "4093440"
  },
  {
    "text": "yeah to give an example the stort form feature that I just uh",
    "start": "4093440",
    "end": "4098920"
  },
  {
    "text": "demonstrated is a feature that you can enable or disable on a database well we",
    "start": "4098920",
    "end": "4104560"
  },
  {
    "text": "discovered that it is is nothing more than a lowercase f character in the dollar Flags item of the icon document",
    "start": "4104560",
    "end": "4112080"
  },
  {
    "text": "of a database and for all mail files that are created",
    "start": "4112080",
    "end": "4119120"
  },
  {
    "text": "of a single notes template we find that all the note IDs",
    "start": "4119120",
    "end": "4126400"
  },
  {
    "text": "for the do for the for the icon documents are identical so if you have a",
    "start": "4126400",
    "end": "4131679"
  },
  {
    "text": "m5. ntf template and you deploy 200 m",
    "start": "4131679",
    "end": "4137278"
  },
  {
    "text": "files then all those 200 m files can be accessed yeah the not the icon documents",
    "start": "4137279",
    "end": "4144159"
  },
  {
    "text": "can be accessed as a document by going for that note ID that's a known",
    "start": "4144159",
    "end": "4149798"
  },
  {
    "text": "function in loader script and then you do a replace item value on the dollar",
    "start": "4149799",
    "end": "4154920"
  },
  {
    "text": "Flags item and you can reenable stored forms although they were disabled and",
    "start": "4154920",
    "end": "4160640"
  },
  {
    "text": "then you back to zero and the same goes for the database script",
    "start": "4160640",
    "end": "4166238"
  },
  {
    "text": "who doesn't know what a database script is good that's positive",
    "start": "4166239",
    "end": "4172920"
  },
  {
    "text": "um what I show with a stor form is a user a victim that is opening a a single",
    "start": "4172920",
    "end": "4179960"
  },
  {
    "text": "document you can do the same thing but then worse if you manipulate the",
    "start": "4179960",
    "end": "4185520"
  },
  {
    "text": "database script of his M file because then the only thing that you need him to do is open his mail",
    "start": "4185520",
    "end": "4192359"
  },
  {
    "text": "file but you can modify the DB script by",
    "start": "4192359",
    "end": "4197800"
  },
  {
    "text": "in the back end don't give the the user control yet but see if there is any mail document",
    "start": "4197800",
    "end": "4204719"
  },
  {
    "text": "that arrived from the attacker if there has detached all the payloads and executed delete the mail in there and",
    "start": "4204719",
    "end": "4212080"
  },
  {
    "text": "then give control back to the user so you have a very automated remote",
    "start": "4212080",
    "end": "4218280"
  },
  {
    "text": "whatever mechanism the execution control list",
    "start": "4218280",
    "end": "4226199"
  },
  {
    "text": "as I said it is introduced in release 4.5 to to coment the stored form",
    "start": "4226199",
    "end": "4231520"
  },
  {
    "text": "issue and basically how it works is uh you have three types of entries that you",
    "start": "4231520",
    "end": "4237560"
  },
  {
    "text": "can specify in the E there is the default entry there is",
    "start": "4237560",
    "end": "4245239"
  },
  {
    "text": "the no signature entry and there is trusted signatures let me let me quickly",
    "start": "4245239",
    "end": "4250920"
  },
  {
    "text": "give you a look um preferences user preferences Security Options here is",
    "start": "4250920",
    "end": "4257760"
  },
  {
    "text": "where you can find it for the default and the no",
    "start": "4257760",
    "end": "4263440"
  },
  {
    "text": "signature you can specify what types of functionality is",
    "start": "4263440",
    "end": "4269040"
  },
  {
    "text": "allowed and you can also add particular signatures and specify what they can do",
    "start": "4269040",
    "end": "4274760"
  },
  {
    "text": "you can do that for workstation Security Java and JavaScript",
    "start": "4274760",
    "end": "4281400"
  },
  {
    "text": "so depending on the code or depending on the signature with",
    "start": "4287640",
    "end": "4292920"
  },
  {
    "text": "which Lotus Notes uh Design Elements were signed you can specify what is allowed",
    "start": "4292920",
    "end": "4298800"
  },
  {
    "text": "and what is not allowed the issue with the ecl is that",
    "start": "4298800",
    "end": "4305320"
  },
  {
    "text": "up until release 502 so not including 502 the default settings in the ecl",
    "start": "4305320",
    "end": "4313159"
  },
  {
    "text": "allowed World access for the default and the no signature",
    "start": "4313159",
    "end": "4318400"
  },
  {
    "text": "entries which means that if your victim does not have",
    "start": "4318400",
    "end": "4324120"
  },
  {
    "text": "your signature specified in his ecl you can do anything with his",
    "start": "4324120",
    "end": "4330000"
  },
  {
    "text": "client now because of uh our our talks with lotus they have changed that in",
    "start": "4330000",
    "end": "4335159"
  },
  {
    "text": "release 502 and they have reversed the situation now nothing is possible unless",
    "start": "4335159",
    "end": "4341920"
  },
  {
    "text": "you specify it so there's lots of companies out there that end up in trouble when they upgrade from a release",
    "start": "4341920",
    "end": "4350480"
  },
  {
    "text": "5 to a release 502 or a higher because their application failed to function and",
    "start": "4350480",
    "end": "4355920"
  },
  {
    "text": "they have to quickly start deploying",
    "start": "4355920",
    "end": "4360480"
  },
  {
    "text": "[Music] ecls without a functioning e stuff like Melissa and loveb is",
    "start": "4361440",
    "end": "4369159"
  },
  {
    "text": "possible with lotus nose as well all you need to do is look at the",
    "start": "4369159",
    "end": "4374600"
  },
  {
    "text": "source code for the love bu and what it says hook into Outlook hook into notes",
    "start": "4374600",
    "end": "4380040"
  },
  {
    "text": "and you're done the problems that we see in at our",
    "start": "4380040",
    "end": "4387840"
  },
  {
    "text": "customers and in the market is that there's very few users and administrators that understand the ecl",
    "start": "4387840",
    "end": "4396040"
  },
  {
    "text": "concept and like Design Elements ecl settings are also",
    "start": "4396040",
    "end": "4401520"
  },
  {
    "text": "stored in obscure locations there's two types of ecl settings there",
    "start": "4401520",
    "end": "4408560"
  },
  {
    "text": "is uh workstation execution control settings which are stored in your",
    "start": "4408560",
    "end": "4413719"
  },
  {
    "text": "desktop. dsk but there is also administrative ecls which are stored in the names.nsf",
    "start": "4413719",
    "end": "4423040"
  },
  {
    "text": "they they won't appear in the view but they do have a note ID and if you",
    "start": "4423040",
    "end": "4428400"
  },
  {
    "text": "sequentially go through the documents you will find the E documents and again you can manipulate",
    "start": "4428400",
    "end": "4434719"
  },
  {
    "text": "them with editor access and as I said before before release 502 they allow",
    "start": "4434719",
    "end": "4439920"
  },
  {
    "text": "World access we have noticed that there are",
    "start": "4439920",
    "end": "4445400"
  },
  {
    "text": "two ways to reset the e at a client the first one is the uh the",
    "start": "4445400",
    "end": "4452440"
  },
  {
    "text": "reference ecl formula which is normally used to deploy",
    "start": "4452440",
    "end": "4457639"
  },
  {
    "text": "administrative ecls to your clients if you specify A non-existing",
    "start": "4457639",
    "end": "4463719"
  },
  {
    "text": "administrative EC in this formula then it will cause the client to",
    "start": "4463719",
    "end": "4469040"
  },
  {
    "text": "reset its e and in release 4.6 that means wide",
    "start": "4469040",
    "end": "4477000"
  },
  {
    "text": "open and a second option to uh reset that ecl is to remove a line called ecl",
    "start": "4477000",
    "end": "4482960"
  },
  {
    "text": "setup equals 3 from the notes. ini the next time the user starts up his",
    "start": "4482960",
    "end": "4488040"
  },
  {
    "text": "client he's got a reset e",
    "start": "4488040",
    "end": "4492800"
  },
  {
    "text": "no it depends of course with the formula",
    "start": "4501560",
    "end": "4506679"
  },
  {
    "text": "um with the formula it depends excuse me on the uh ecl settings at that",
    "start": "4506679",
    "end": "4514520"
  },
  {
    "text": "moment yeah but there's if if that is the case then you could also go in from",
    "start": "4514560",
    "end": "4521159"
  },
  {
    "text": "a file level access and remove that line from the file",
    "start": "4521159",
    "end": "4526960"
  },
  {
    "text": "the interesting thing starts where uh we discovered that the notes API calls are",
    "start": "4530719",
    "end": "4537320"
  },
  {
    "text": "not being intercepted by the execution controllers and this is where it gets",
    "start": "4537320",
    "end": "4542639"
  },
  {
    "text": "extremely dangerous because the implementation of Olay is built on top",
    "start": "4542639",
    "end": "4548239"
  },
  {
    "text": "of that API so it means that if we make an oay call into the not client the ecl",
    "start": "4548239",
    "end": "4555000"
  },
  {
    "text": "won't notice [Music] it good",
    "start": "4555000",
    "end": "4562120"
  },
  {
    "text": "translation so that that just to give you an idea things that use Olay are going to be your Visual Basic scripts",
    "start": "4562120",
    "end": "4569159"
  },
  {
    "text": "running in a web browser uh hooks in from Microsoft Office documents or",
    "start": "4569159",
    "end": "4574600"
  },
  {
    "text": "native C code using the notes cap API as well exactly so macr viruses",
    "start": "4574600",
    "end": "4581280"
  },
  {
    "text": "anyone dig VB script on a web page anyone",
    "start": "4581280",
    "end": "4586400"
  },
  {
    "text": "um I've I've built a little demonstration for this purpose as well and",
    "start": "4586400",
    "end": "4593040"
  },
  {
    "text": "uh let's go back to the Intruder and this time we will create a regular email",
    "start": "4593040",
    "end": "4599639"
  },
  {
    "text": "message to release 503 client which is called uh",
    "start": "4599639",
    "end": "4608880"
  },
  {
    "text": "uh yeah this is him uh demo via",
    "start": "4609360",
    "end": "4616840"
  },
  {
    "text": "HTML and I will attach an HTML file called AO demo.",
    "start": "4623280",
    "end": "4631960"
  },
  {
    "text": "HTM and obviously that HTML file contains some VB",
    "start": "4631960",
    "end": "4637400"
  },
  {
    "text": "script to make a oay hook into the notes client and we're going to send it to the",
    "start": "4637400",
    "end": "4644520"
  },
  {
    "text": "victim okay now in order to see what happens at",
    "start": "4644520",
    "end": "4652159"
  },
  {
    "text": "the victim I will restart my notes 5",
    "start": "4652159",
    "end": "4656679"
  },
  {
    "text": "client oh um and I want to be another user or five",
    "start": "4663040",
    "end": "4671440"
  },
  {
    "text": "years that's what I said five years okay he's got an email as well and there",
    "start": "4672960",
    "end": "4681440"
  },
  {
    "text": "it is he received an email and notice by the way that we see a paperclip here so there is a there's an",
    "start": "4681440",
    "end": "4688440"
  },
  {
    "text": "attachment that paperclip was not there when we send the stored",
    "start": "4688440",
    "end": "4693678"
  },
  {
    "text": "form um let's take a look at the execution control list for this",
    "start": "4695239",
    "end": "4703120"
  },
  {
    "text": "victim and you will see the default and no signature are not allowed",
    "start": "4703280",
    "end": "4710920"
  },
  {
    "text": "anything so this is according to Lotus",
    "start": "4710920",
    "end": "4715800"
  },
  {
    "text": "recommendation now if I'm going to launch this page in Internet",
    "start": "4719760",
    "end": "4726600"
  },
  {
    "text": "Explorer obviously Internet Explorer is is going to present a warning for",
    "start": "4726600",
    "end": "4733440"
  },
  {
    "text": "active and I didn't do any effort in trying to get rid of that warning the thing that I want to show you guys is",
    "start": "4733440",
    "end": "4740040"
  },
  {
    "text": "that the ecl is not intercepting the LA calls I'm not trying",
    "start": "4740040",
    "end": "4745840"
  },
  {
    "text": "to demonstrate that I can hack Internet Explorer and get rid of the active fix warning so but in order to make some fun",
    "start": "4745840",
    "end": "4752840"
  },
  {
    "text": "let just put a prompt in before telling the user that he should press the yes button if he gets that",
    "start": "4752840",
    "end": "4760760"
  },
  {
    "text": "warning you see here's here's the warning so",
    "start": "4760760",
    "end": "4766400"
  },
  {
    "text": "what this demo file will do is it will make a connection to the mail file of",
    "start": "4766400",
    "end": "4771480"
  },
  {
    "text": "the client and give an overview of all the documents that he has in his mail",
    "start": "4771480",
    "end": "4779159"
  },
  {
    "text": "file hear it this is just a representation of his",
    "start": "4781639",
    "end": "4788960"
  },
  {
    "text": "inbox okay [Music]",
    "start": "4788960",
    "end": "4796619"
  },
  {
    "text": "let me show you the Inbox and the fact that it is identical okay so nothing",
    "start": "4797560",
    "end": "4806600"
  },
  {
    "text": "spectacular let's go back to the",
    "start": "4806679",
    "end": "4812560"
  },
  {
    "text": "Intruder and see if we have some",
    "start": "4812560",
    "end": "4816480"
  },
  {
    "text": "result here's the M file of the Intruder and whoopy the victim fired off an",
    "start": "4818440",
    "end": "4826199"
  },
  {
    "text": "email now according to the ecl settings that should not be",
    "start": "4826199",
    "end": "4832000"
  },
  {
    "text": "allowed nothing was allowed and if I open this",
    "start": "4832000",
    "end": "4838199"
  },
  {
    "text": "email here's what you see this victim granted manager access",
    "start": "4838199",
    "end": "4843920"
  },
  {
    "text": "as well that was not allowed according to the ecl he sent me his HTTP password",
    "start": "4843920",
    "end": "4853360"
  },
  {
    "text": "hash and he sent me his ID file and what I can do with this I will",
    "start": "4853360",
    "end": "4860520"
  },
  {
    "text": "show that to you later I'm",
    "start": "4860520",
    "end": "4866880"
  },
  {
    "text": "sorry I didn't understand you does lootus say this as a feature as well Lotus recognized this as a problem but",
    "start": "4868239",
    "end": "4875600"
  },
  {
    "text": "they said well that's really kind of a a Microsoft problem because it's an Olay",
    "start": "4875600",
    "end": "4882639"
  },
  {
    "text": "problem I said well but it's your but it's your call it's your Ola call it's",
    "start": "4882639",
    "end": "4887960"
  },
  {
    "text": "what is it what's the what's the call it's like at um well there's there's three calls right now uh with release",
    "start": "4887960",
    "end": "4893960"
  },
  {
    "text": "five because they implemented Dom Domino object model kind of thing they you have the with the release four client you",
    "start": "4893960",
    "end": "4900719"
  },
  {
    "text": "have the notes. not session notes. not session yeah and the notes. notes UE",
    "start": "4900719",
    "end": "4905800"
  },
  {
    "text": "workspace so you can also do stuff in front end with laay and with L 5 they also created the lotus. node session",
    "start": "4905800",
    "end": "4913320"
  },
  {
    "text": "which is meant for the server to to deal with ASP active server pages but there",
    "start": "4913320",
    "end": "4918400"
  },
  {
    "text": "is as a matter of fact it's a nice question because IBM has produced an entire red book on the combination of FB",
    "start": "4918400",
    "end": "4925719"
  },
  {
    "text": "and Lotus Notes so you might want to look into that book and see what it does",
    "start": "4925719",
    "end": "4932199"
  },
  {
    "text": "for",
    "start": "4932199",
    "end": "4934400"
  },
  {
    "text": "you okay the next subject is about uh clearing user pref",
    "start": "4940040",
    "end": "4946080"
  },
  {
    "text": "references and that in combination with the feature in your ID",
    "start": "4946080",
    "end": "4952000"
  },
  {
    "text": "file that you can share the password within your ID file with uh API based",
    "start": "4952000",
    "end": "4959599"
  },
  {
    "text": "programs I have a demonstration for that as well so and this time let's uh attack",
    "start": "4962480",
    "end": "4968600"
  },
  {
    "text": "the attacker um in going to the ID file properties",
    "start": "4968600",
    "end": "4975199"
  },
  {
    "text": "there's a little box here that says Don't prompt for a password from other notes based",
    "start": "4976199",
    "end": "4982760"
  },
  {
    "text": "programs and I will show you what does what this does normally if uh I don't",
    "start": "4982920",
    "end": "4991600"
  },
  {
    "text": "share that password this is what you're going to end up with if I use a",
    "start": "4991600",
    "end": "4997040"
  },
  {
    "text": "program notp speak who is not familiar with not speak okay not speak is a is a problem",
    "start": "4997040",
    "end": "5004600"
  },
  {
    "text": "program that you can use to uh analyze notes databases and it is distributed by",
    "start": "5004600",
    "end": "5010360"
  },
  {
    "text": "the Lotus website and it's a it's a simple program that uses the noes",
    "start": "5010360",
    "end": "5016199"
  },
  {
    "text": "API and the reason why I use it here is because it's publicly available everybody can download it and it it",
    "start": "5016199",
    "end": "5022040"
  },
  {
    "text": "proves my point about the API what you will see is",
    "start": "5022040",
    "end": "5028719"
  },
  {
    "text": "that I think I have to start it up again you probably already authenticated once",
    "start": "5028719",
    "end": "5034080"
  },
  {
    "text": "before",
    "start": "5034080",
    "end": "5036440"
  },
  {
    "text": "yeah so I have to close it down that's getting",
    "start": "5041560",
    "end": "5047000"
  },
  {
    "text": "tricky that's what I thought don't question on me",
    "start": "5047000",
    "end": "5052920"
  },
  {
    "text": "now um Clos",
    "start": "5052920",
    "end": "5060120"
  },
  {
    "text": "it no speak okay let's try and see what happens if we want to open",
    "start": "5060639",
    "end": "5067120"
  },
  {
    "text": "that server there you go this is what I",
    "start": "5067120",
    "end": "5072800"
  },
  {
    "text": "wanted to show so because my Lotus Notes ID file is not sharing a password with",
    "start": "5072800",
    "end": "5081440"
  },
  {
    "text": "addin programs I will be prompted with this box to provide my password which is",
    "start": "5081440",
    "end": "5088000"
  },
  {
    "text": "which can be very irritating especially if you have a third party program that continuously goes into your notes client",
    "start": "5088000",
    "end": "5093360"
  },
  {
    "text": "because then you keep on typing your password",
    "start": "5093360",
    "end": "5101360"
  },
  {
    "text": "okay now here's the trick if I start sharing that",
    "start": "5103719",
    "end": "5111960"
  },
  {
    "text": "password okay I now can",
    "start": "5114239",
    "end": "5120079"
  },
  {
    "text": "work on the server with an API program not PE and I will not be prompted for a",
    "start": "5122239",
    "end": "5129639"
  },
  {
    "text": "password start it up again yeah okay I'll start it up",
    "start": "5129639",
    "end": "5137920"
  },
  {
    "text": "again you'll see I am not being prompted which is uh this is behavior which is",
    "start": "5143560",
    "end": "5149280"
  },
  {
    "text": "meant to be because the user wanted to share his password",
    "start": "5149280",
    "end": "5154960"
  },
  {
    "text": "now let's take a look at what happens if I go for a coffee break then",
    "start": "5154960",
    "end": "5162679"
  },
  {
    "text": "normally and this is recommended uh you want to press F5 and you see in the",
    "start": "5162679",
    "end": "5169159"
  },
  {
    "text": "bottom area that private user information has been cleared so this",
    "start": "5169159",
    "end": "5174480"
  },
  {
    "text": "feature is built in so that other people cannot go to your keyboard and send off",
    "start": "5174480",
    "end": "5180400"
  },
  {
    "text": "email on your behalf because as soon as you try to do anything on the client it",
    "start": "5180400",
    "end": "5186320"
  },
  {
    "text": "will prompt you for the ID file password here it is",
    "start": "5186320",
    "end": "5193040"
  },
  {
    "text": "okay but if you use notp on a floppy disc or any other",
    "start": "5193040",
    "end": "5199239"
  },
  {
    "text": "API based program that you developed and you go to his workstation stick it in his Drive start the",
    "start": "5199239",
    "end": "5205960"
  },
  {
    "text": "program then and I always make a mistake with",
    "start": "5205960",
    "end": "5211199"
  },
  {
    "text": "this demo let me try it",
    "start": "5211199",
    "end": "5217199"
  },
  {
    "text": "again what is",
    "start": "5219639",
    "end": "5222840"
  },
  {
    "text": "it there you go press F5 user information is cleared yeah go back to nor",
    "start": "5226159",
    "end": "5234800"
  },
  {
    "text": "Peak and it doesn't work I think I'm make a mistake you got to to pull up Sesame and turn the bit",
    "start": "5234800",
    "end": "5240560"
  },
  {
    "text": "back on yeah you're right sorry about that forgot one step okay",
    "start": "5240560",
    "end": "5248080"
  },
  {
    "text": "um the password is now not being shared and the user is pressing",
    "start": "5250880",
    "end": "5257280"
  },
  {
    "text": "F5 we have seen that if he shares his password then you can continue working",
    "start": "5257280",
    "end": "5263119"
  },
  {
    "text": "without the password prompt and what we saw what we noticed in the memory of the",
    "start": "5263119",
    "end": "5269520"
  },
  {
    "text": "notes process is that the sharing flag for that password is just a bit in",
    "start": "5269520",
    "end": "5277760"
  },
  {
    "text": "memory so if you flip that bit you can reenable the sharing of that",
    "start": "5277760",
    "end": "5284119"
  },
  {
    "text": "password and that's uh that's for that purpose we we wrote a little program which is called",
    "start": "5284119",
    "end": "5289520"
  },
  {
    "text": "Sesame um which is also not working now",
    "start": "5289520",
    "end": "5294679"
  },
  {
    "text": "see there we",
    "start": "5294960",
    "end": "5298320"
  },
  {
    "text": "go okay",
    "start": "5302080",
    "end": "5306080"
  },
  {
    "text": "here you can see that we can uh flip that bit in the memory by making it not",
    "start": "5308560",
    "end": "5315080"
  },
  {
    "text": "shared or shared yeah and by doing",
    "start": "5315080",
    "end": "5322520"
  },
  {
    "text": "that I should now be able with not speak to open that server without a",
    "start": "5322520",
    "end": "5331280"
  },
  {
    "text": "password and does okay so I'm now in the mail file of the",
    "start": "5332800",
    "end": "5342400"
  },
  {
    "text": "victim while he thinks he is secure when he goes for",
    "start": "5342400",
    "end": "5349719"
  },
  {
    "text": "coffee so what this proves is that by using a simple program to manipulate",
    "start": "5349719",
    "end": "5355520"
  },
  {
    "text": "that memory and by implementing some API calls into uh that notes client you can",
    "start": "5355520",
    "end": "5363159"
  },
  {
    "text": "get to his information where you should not be able [Music]",
    "start": "5363159",
    "end": "5369949"
  },
  {
    "text": "to let's get rid of [Music]",
    "start": "5373000",
    "end": "5379199"
  },
  {
    "text": "this so the another thing is that the",
    "start": "5379199",
    "end": "5384560"
  },
  {
    "text": "password remains cached in memory after the user has pressed",
    "start": "5384560",
    "end": "5390080"
  },
  {
    "text": "F5 so it's not clearing his user preferences it is just just flipping a",
    "start": "5390080",
    "end": "5397920"
  },
  {
    "text": "bit the flag can be changed from an external program which means that the F5 key is",
    "start": "5398679",
    "end": "5406080"
  },
  {
    "text": "limited to the notes GUI the notes interface the notes client",
    "start": "5406080",
    "end": "5411480"
  },
  {
    "text": "only after to the next subject the HTTP password",
    "start": "5413080",
    "end": "5418199"
  },
  {
    "text": "hash um we found that this is a based of a modified rc4",
    "start": "5418199",
    "end": "5424840"
  },
  {
    "text": "implementation and uh the passwords are not being salted so what this means is",
    "start": "5424840",
    "end": "5432040"
  },
  {
    "text": "that a password of password will always result in a hash that starts with 355e",
    "start": "5432040",
    "end": "5440400"
  },
  {
    "text": "Etc same goes for secret same go well for any combination so what makes it vulnerable",
    "start": "5441080",
    "end": "5447800"
  },
  {
    "text": "to do is is brute force or dictionary attacks if I can",
    "start": "5447800",
    "end": "5454040"
  },
  {
    "text": "get a view on HTTP hashes on a names and address book I can try and guess some passwords",
    "start": "5454040",
    "end": "5462239"
  },
  {
    "text": "up your user view on oh yeah yeah I can I can show something about",
    "start": "5462239",
    "end": "5468320"
  },
  {
    "text": "that here is a an occasion",
    "start": "5468400",
    "end": "5473840"
  },
  {
    "text": "where I was able to look at a names and address book from the web that consisted of",
    "start": "5473840",
    "end": "5479679"
  },
  {
    "text": "974 users um",
    "start": "5479679",
    "end": "5485280"
  },
  {
    "text": "and I've created this small little database where I could import that particular view into this database and",
    "start": "5485280",
    "end": "5493239"
  },
  {
    "text": "calculate some simple passwords first name last name first character of the first name plus the last name email",
    "start": "5493239",
    "end": "5499280"
  },
  {
    "text": "address Etc just five or six basic password",
    "start": "5499280",
    "end": "5504840"
  },
  {
    "text": "calculations and see here are all the documents I've anonymized it a",
    "start": "5505360",
    "end": "5512480"
  },
  {
    "text": "bit and what I found was uh 1 2 3 4 five nine documents that I",
    "start": "5512480",
    "end": "5520719"
  },
  {
    "text": "could immediately identify the password that's 1% too",
    "start": "5520719",
    "end": "5527440"
  },
  {
    "text": "much pull up the user view in a web browser okay just so they can see what that really looks like you can see it",
    "start": "5527440",
    "end": "5533800"
  },
  {
    "text": "over the web if I go to the uh server here and go",
    "start": "5533800",
    "end": "5540280"
  },
  {
    "text": "to the names. NSF",
    "start": "5540280",
    "end": "5544039"
  },
  {
    "text": "there is uh all kinds of views here but the view that I like most for this",
    "start": "5547719",
    "end": "5552840"
  },
  {
    "text": "information is the dollar users view because what it does it's a Hidden View but it gives us",
    "start": "5552840",
    "end": "5560159"
  },
  {
    "text": "the names of the users and if we go way to the right you'll see the list name and the",
    "start": "5560159",
    "end": "5565560"
  },
  {
    "text": "full name again the full name the list name Mill server M file Mill domain his",
    "start": "5565560",
    "end": "5572960"
  },
  {
    "text": "short name which is his HTTP login name and guess what comes up here HTTP password",
    "start": "5572960",
    "end": "5582239"
  },
  {
    "text": "hes okay and as I told you I can immediately see that this is password",
    "start": "5583199",
    "end": "5590840"
  },
  {
    "text": "password so what I did is is uh let me let me interrupt you real quick where this is actually kind of important if",
    "start": "5592199",
    "end": "5598440"
  },
  {
    "text": "you actually only have reader access to the name and address book and Domino and you all you've got is reader ad reader",
    "start": "5598440",
    "end": "5605560"
  },
  {
    "text": "access if you've ever noticed when in the HTTP password field it's actually hidden so you can't actually see it the",
    "start": "5605560",
    "end": "5613159"
  },
  {
    "text": "same format if you pull it up why don't you show them the the default what I'm talking about uh and just click on a",
    "start": "5613159",
    "end": "5619600"
  },
  {
    "text": "people no just click on people yeah and this is a faster one because otherwise you get all these Java okay this is",
    "start": "5619600",
    "end": "5626600"
  },
  {
    "text": "a regular view that you yeah and just click on one of the users go for the",
    "start": "5626600",
    "end": "5632480"
  },
  {
    "text": "Intruder so this is what it actually looks like so you don't actually even see the password with only reader access",
    "start": "5632480",
    "end": "5639280"
  },
  {
    "text": "we would have to actually go in and click on edit to see the HTTP password",
    "start": "5639280",
    "end": "5644440"
  },
  {
    "text": "hash then it would appear but what he did with the the dollar users view entry since it's a Hidden",
    "start": "5644440",
    "end": "5651000"
  },
  {
    "text": "View or supposed to be a Hidden View uh that reveals all that clear text so then we can get the password hash with even",
    "start": "5651000",
    "end": "5657560"
  },
  {
    "text": "if if the the maximum access we have is reader so we just bypass the uh the",
    "start": "5657560",
    "end": "5663119"
  },
  {
    "text": "field security that Lotus had actually",
    "start": "5663119",
    "end": "5666960"
  },
  {
    "text": "implemented and if you use the read view entries on that particular view what",
    "start": "5674080",
    "end": "5679920"
  },
  {
    "text": "Kevin explained before then actually what you're getting is a very nice XML",
    "start": "5679920",
    "end": "5686840"
  },
  {
    "text": "structure where you can immediately parse those HTTP hashes into your noes client and perform your calculations",
    "start": "5686840",
    "end": "5695600"
  },
  {
    "text": "by instead of using question mark open for you do riew",
    "start": "5698840",
    "end": "5704800"
  },
  {
    "text": "entries so once you have the XML since it's kind of it's a better defined structure you can import that into",
    "start": "5704800",
    "end": "5711400"
  },
  {
    "text": "anything else and and do a dictionary a Brute Force attack and run that against combinations of what their username is",
    "start": "5711400",
    "end": "5717960"
  },
  {
    "text": "since we've all seen that in the past if if you if you've seen if you saw the uh",
    "start": "5717960",
    "end": "5723840"
  },
  {
    "text": "found Stone's terminal server demonstration one of the things they remarked was that they're saying terminal servers Exposed on the web",
    "start": "5723840",
    "end": "5730400"
  },
  {
    "text": "people aren't setting passwords all these things it's it's the same thing in Domino where we're seeing the same exact",
    "start": "5730400",
    "end": "5736719"
  },
  {
    "text": "freaking thing everybody's using you know stupid passwords made up of the first initial last name you know",
    "start": "5736719",
    "end": "5743480"
  },
  {
    "text": "variations on that okay",
    "start": "5743480",
    "end": "5749760"
  },
  {
    "text": "[Music]",
    "start": "5750020",
    "end": "5753739"
  },
  {
    "text": "yeah he's got a [Music] question I'm",
    "start": "5756400",
    "end": "5763159"
  },
  {
    "text": "[Music] sorry I don't think you can it is already",
    "start": "5764250",
    "end": "5771599"
  },
  {
    "text": "hidden restri webs yeah what what you should do indeed is is to restrict access from a",
    "start": "5775159",
    "end": "5782040"
  },
  {
    "text": "web browser because there's no use in in looking at that view HTTP can't exactly",
    "start": "5782040",
    "end": "5787639"
  },
  {
    "text": "in httpd CNF file I would uh create a redirect for that",
    "start": "5787639",
    "end": "5794360"
  },
  {
    "text": "yes",
    "start": "5795840",
    "end": "5798840"
  },
  {
    "text": "even yeah but uh here's here's the interesting thing if you look at the names.nsf that view is already hidden in",
    "start": "5801360",
    "end": "5808639"
  },
  {
    "text": "the design",
    "start": "5808639",
    "end": "5811800"
  },
  {
    "text": "okay um hold on can I do that see",
    "start": "5817520",
    "end": "5823159"
  },
  {
    "text": "[Music]",
    "start": "5825100",
    "end": "5829419"
  },
  {
    "text": "design come on few design oh I'm not I'm not manager",
    "start": "5831520",
    "end": "5837719"
  },
  {
    "text": "here go to administrator",
    "start": "5837719",
    "end": "5842000"
  },
  {
    "text": "[Music]",
    "start": "5851720",
    "end": "5856069"
  },
  {
    "text": "oh this is not it where's the Fel here here here we are okay now if we scroll",
    "start": "5857440",
    "end": "5862960"
  },
  {
    "text": "down to the Views scroll down more and",
    "start": "5862960",
    "end": "5868040"
  },
  {
    "text": "here here's the okay",
    "start": "5868040",
    "end": "5874870"
  },
  {
    "text": "[Music] hold on there you go okay you want to go",
    "start": "5874870",
    "end": "5884639"
  },
  {
    "text": "here why don't you come over here and and because I don't know what you let's to see the design properties of that",
    "start": "5887520",
    "end": "5892960"
  },
  {
    "text": "view I think is what he's saying so if you go back up",
    "start": "5892960",
    "end": "5898760"
  },
  {
    "text": "one go back yeah go back to where you were before this okay",
    "start": "5898800",
    "end": "5904199"
  },
  {
    "text": "there you go yes and this one third one this",
    "start": "5904199",
    "end": "5913199"
  },
  {
    "text": "one yeah okay this",
    "start": "5914840",
    "end": "5921159"
  },
  {
    "text": "canot and you can see how easy that is can't see okay but let me first test this yeah",
    "start": "5921360",
    "end": "5928920"
  },
  {
    "text": "CU if you're right then this should no longer be possible let's see what",
    "start": "5928920",
    "end": "5935199"
  },
  {
    "text": "happens no uses question mark open view right",
    "start": "5935199",
    "end": "5941960"
  },
  {
    "text": "okay now do it with the",
    "start": "5941960",
    "end": "5945599"
  },
  {
    "text": "[Music] redirect okay that's interesting did I",
    "start": "5947620",
    "end": "5952679"
  },
  {
    "text": "lose power yeah here check here see if it's",
    "start": "5952679",
    "end": "5958080"
  },
  {
    "text": "still on might have turned off in your pocket",
    "start": "5958080",
    "end": "5962360"
  },
  {
    "text": "I think the battery died he gave us another battery we lost the battery",
    "start": "5966040",
    "end": "5973199"
  },
  {
    "text": "[Music] here um I think that would help but um as",
    "start": "5973470",
    "end": "5981639"
  },
  {
    "text": "soon as I know the version as soon as I know the version of your Domino server uh I think I still could get into it uh",
    "start": "5981639",
    "end": "5991199"
  },
  {
    "text": "because if I know the template yeah look at the views here we go to the dollar",
    "start": "5991199",
    "end": "5996880"
  },
  {
    "text": "user view um where is it here it is go to the properties and what you will see here is",
    "start": "5996880",
    "end": "6003599"
  },
  {
    "text": "the note ID of that particular view so I can still I can use the note ID probably",
    "start": "6003599",
    "end": "6010280"
  },
  {
    "text": "to to get in there okay let's let's go back to the",
    "start": "6010280",
    "end": "6018480"
  },
  {
    "text": "presentation okay you go to the",
    "start": "6020599",
    "end": "6027440"
  },
  {
    "text": "view let's let's take this view for instance uh sorry I have to go back and",
    "start": "6027440",
    "end": "6035239"
  },
  {
    "text": "so you stay here go to the design properties and on the third tab you can hide a design element for web",
    "start": "6035239",
    "end": "6042840"
  },
  {
    "text": "browsers here's here's what it says hide design element from web browsers",
    "start": "6042840",
    "end": "6050079"
  },
  {
    "text": "never seen anybody configure that yeah that's that's yeah it's actually a new one for us",
    "start": "6053360",
    "end": "6059960"
  },
  {
    "text": "but okay good good point thank you but here again this is just this is",
    "start": "6068080",
    "end": "6075360"
  },
  {
    "text": "a standard installation of the names and address and and they've got them all enabled",
    "start": "6075360",
    "end": "6081960"
  },
  {
    "text": "so um okay yeah what is important to to understand is that",
    "start": "6082040",
    "end": "6088719"
  },
  {
    "text": "uh from the outside yeah you might want to restrict your names. NSF with ACL and",
    "start": "6088719",
    "end": "6096920"
  },
  {
    "text": "with your your view property but what about all your internal users all the",
    "start": "6096920",
    "end": "6102280"
  },
  {
    "text": "internal users must have at least read access to your names and netw book",
    "start": "6102280",
    "end": "6109119"
  },
  {
    "text": "so any user can go to the people View and look at the document of a colleague",
    "start": "6109119",
    "end": "6116440"
  },
  {
    "text": "and if you go to the document properties and take a look at the fields in that",
    "start": "6116440",
    "end": "6122080"
  },
  {
    "text": "document what do you see here I see the HTTP hash",
    "start": "6122080",
    "end": "6128960"
  },
  {
    "text": "so all internal users can access all your HTTP",
    "start": "6128960",
    "end": "6134000"
  },
  {
    "text": "hashes and remote users via the web can do it if you make a mistake in your in",
    "start": "6134000",
    "end": "6139639"
  },
  {
    "text": "your Access Control",
    "start": "6139639",
    "end": "6143199"
  },
  {
    "text": "if during the no no if you install a new user if",
    "start": "6148480",
    "end": "6157080"
  },
  {
    "text": "you register a new user you uh you enter the password for that user ID file and",
    "start": "6157080",
    "end": "6162599"
  },
  {
    "text": "you also get a prompt whether you want to assign an HTTP password as well and if you do then you will end up with a",
    "start": "6162599",
    "end": "6168840"
  },
  {
    "text": "situation where the HTTP password is identical to the password that you gave to that ID file",
    "start": "6168840",
    "end": "6175118"
  },
  {
    "text": "yes keep going to the next one I think some of this will become clearer because that's one of that's actually one of the recommendations that we give to combat",
    "start": "6187960",
    "end": "6194719"
  },
  {
    "text": "the next problem it's 12",
    "start": "6194719",
    "end": "6202639"
  },
  {
    "text": "okay yeah should speed up a bit you guys getting hungry um okay the ID file is the next",
    "start": "6203360",
    "end": "6210920"
  },
  {
    "text": "subject if you look at the contents of an ID file uh okay what does the ID file",
    "start": "6210920",
    "end": "6216679"
  },
  {
    "text": "deliver it delivers authentication for exess control it delivers the digital signature and some encryption",
    "start": "6216679",
    "end": "6224400"
  },
  {
    "text": "right if you look at the contents of an ID file what you will see is an encrypted private and public key you'll",
    "start": "6224400",
    "end": "6230360"
  },
  {
    "text": "see some user information in there an expiration date and some internal Integrity checks and as we've all",
    "start": "6230360",
    "end": "6236560"
  },
  {
    "text": "discussed it's been used by the Domino server it's been used by the notes client and by API based",
    "start": "6236560",
    "end": "6243199"
  },
  {
    "text": "programs there are several features that are built into lootus noes to protect the ID file and there's no way you can",
    "start": "6243199",
    "end": "6250239"
  },
  {
    "text": "Brute Force the password because anytime you enter a wrong password there's an",
    "start": "6250239",
    "end": "6255280"
  },
  {
    "text": "increment in time that you have to wait the digest of uh of the ID is checked",
    "start": "6255280",
    "end": "6261000"
  },
  {
    "text": "against the server naap um we' seen the F5 and auto log off",
    "start": "6261000",
    "end": "6266400"
  },
  {
    "text": "feature Which is less valuable than some people believe and we've talked about ID",
    "start": "6266400",
    "end": "6273920"
  },
  {
    "text": "sharing we've also shown that ID theft can occur from inside your network or",
    "start": "6275000",
    "end": "6280679"
  },
  {
    "text": "outside your network and we shown that with the uh stored forum and the HTML sample using",
    "start": "6280679",
    "end": "6286920"
  },
  {
    "text": "Olay and uh let's use that example and see if what we can do with that ID F",
    "start": "6286920",
    "end": "6293480"
  },
  {
    "text": "would you mind hold it yeah sure's",
    "start": "6293480",
    "end": "6301080"
  },
  {
    "text": "newy okay in order to show what we can do",
    "start": "6305840",
    "end": "6312360"
  },
  {
    "text": "with the ID file we've have our program",
    "start": "6312360",
    "end": "6318280"
  },
  {
    "text": "Sesame and in order to make sure we work we uh want to share that ID file and",
    "start": "6320719",
    "end": "6327280"
  },
  {
    "text": "click on okay and I have another button here which says",
    "start": "6327280",
    "end": "6333080"
  },
  {
    "text": "password okay and we can either enter",
    "start": "6333400",
    "end": "6338560"
  },
  {
    "text": "the hash corresponding to the ID file into this box or since we're live now we can add a",
    "start": "6338560",
    "end": "6345840"
  },
  {
    "text": "new password so if I use a password a b",
    "start": "6345840",
    "end": "6351679"
  },
  {
    "text": "c and click okay I have now assigned a new password to this",
    "start": "6351679",
    "end": "6357520"
  },
  {
    "text": "user yeah if I can still use my password but you",
    "start": "6357520",
    "end": "6365599"
  },
  {
    "text": "can also type in a b",
    "start": "6365599",
    "end": "6369800"
  },
  {
    "text": "c and there you go you're a validated user yeah if I go back to the to the",
    "start": "6371840",
    "end": "6379239"
  },
  {
    "text": "position of the Intruder what you will see",
    "start": "6379239",
    "end": "6384719"
  },
  {
    "text": "is that in his mail file the victim sent him the ID file which is here and the",
    "start": "6385599",
    "end": "6393520"
  },
  {
    "text": "HTTP hash if we Supply that into",
    "start": "6393520",
    "end": "6399360"
  },
  {
    "text": "Sesame we have validated that ID file without a",
    "start": "6399360",
    "end": "6404960"
  },
  {
    "text": "password without knowing the password switch to that to to do the",
    "start": "6404960",
    "end": "6412040"
  },
  {
    "text": "example switch to that user ID and we don't know the password for that",
    "start": "6412040",
    "end": "6417920"
  },
  {
    "text": "okay then I will uh exit the client go to",
    "start": "6417920",
    "end": "6425920"
  },
  {
    "text": "here I need to restart the client not verion five",
    "start": "6431719",
    "end": "6439760"
  },
  {
    "text": "okay here it says that we have to enter a password which we don't",
    "start": "6443880",
    "end": "6450840"
  },
  {
    "text": "have see okay share that ID",
    "start": "6451800",
    "end": "6458400"
  },
  {
    "text": "file okay new",
    "start": "6458480",
    "end": "6464280"
  },
  {
    "text": "password 111 sure",
    "start": "6464320",
    "end": "6470599"
  },
  {
    "text": "okay one one one okay so basically what's happened right",
    "start": "6470760",
    "end": "6478080"
  },
  {
    "text": "here is that that that hash and that user ID can be used in combination by taking",
    "start": "6478080",
    "end": "6485239"
  },
  {
    "text": "that hash and plugging it into a known memory register inside the client's memory space when notes is going to",
    "start": "6485239",
    "end": "6491520"
  },
  {
    "text": "verify whether or not it has the right information to open up that that usri",
    "start": "6491520",
    "end": "6497119"
  },
  {
    "text": "which is essentially like opening up your secret key when you type in your passphrase in pgp you open up your secret key to get that to get those",
    "start": "6497119",
    "end": "6502800"
  },
  {
    "text": "primes right same sort of things happening here what you're doing is tricking the client into thinking that",
    "start": "6502800",
    "end": "6508679"
  },
  {
    "text": "the hash that you've placed in that memory location is a valid one and therefore it",
    "start": "6508679",
    "end": "6515040"
  },
  {
    "text": "will open up that open up that ID allowing you to become that user the passphrase that you type anywhere that's",
    "start": "6515040",
    "end": "6520920"
  },
  {
    "text": "just that the only thing that that does is open up that user ID all your hidden credentials and all the things that make",
    "start": "6520920",
    "end": "6526080"
  },
  {
    "text": "you important and make you you under notes are the RSA keys that are that are locked into that user ID so by tricking",
    "start": "6526080",
    "end": "6533679"
  },
  {
    "text": "the client into opening it by falsifying the memory information that it's going to use to do that comparison to say yes",
    "start": "6533679",
    "end": "6540760"
  },
  {
    "text": "this is the right password by forcing it to open up that user ID you've now bypassed that sort of hidden layer and",
    "start": "6540760",
    "end": "6547719"
  },
  {
    "text": "the reason this works in notes is because notes keeps that little bit of",
    "start": "6547719",
    "end": "6552760"
  },
  {
    "text": "information that little hash in a fixed memory register that you can go in and look for you know you you would think",
    "start": "6552760",
    "end": "6559760"
  },
  {
    "text": "that you could use the same sort of attack against other uh other public key implementations like pgp but Phil",
    "start": "6559760",
    "end": "6565760"
  },
  {
    "text": "Zimmerman was a little smarter than that and so that his credentials you know you have like X number of seconds before",
    "start": "6565760",
    "end": "6571599"
  },
  {
    "text": "your key expires well in those X number of seconds that your passphrase information the thing that it uses to",
    "start": "6571599",
    "end": "6577840"
  },
  {
    "text": "check against is moving around in memory so you're not going to be able to isolate it well notes just shoves it in",
    "start": "6577840",
    "end": "6583800"
  },
  {
    "text": "a shoves it in a particular register and leaves it there and you you use if you use a regular memory debugger and you",
    "start": "6583800",
    "end": "6591440"
  },
  {
    "text": "just can find in the no memory process try to find your HTTP hash and you will locate it and go three characters back",
    "start": "6591440",
    "end": "6598599"
  },
  {
    "text": "and you will find the ID share in",
    "start": "6598599",
    "end": "6601760"
  },
  {
    "text": "flag no no if if I can show that to you yeah I press F5 if I now go to file",
    "start": "6605360",
    "end": "6611800"
  },
  {
    "text": "tools ID I have to provide my password and remember the other password",
    "start": "6611800",
    "end": "6618400"
  },
  {
    "text": "was 111 and this is so it's still",
    "start": "6618400",
    "end": "6624239"
  },
  {
    "text": "there so the US doesn't know no and since but also the victim",
    "start": "6624239",
    "end": "6632520"
  },
  {
    "text": "has sent his ID file and hash way across the ocean towards the Intruder without his knowledge so you now have a notes",
    "start": "6632520",
    "end": "6639480"
  },
  {
    "text": "client on the other side of the ocean that is able to authenticate against your Domino server as the validated",
    "start": "6639480",
    "end": "6644800"
  },
  {
    "text": "authenticated user so you can see how this stuff sort of dobes tail together dubv Tales together because of improper",
    "start": "6644800",
    "end": "6650440"
  },
  {
    "text": "permission set on the default user View and improper ACLS on names and address books and people still leaving IDs set",
    "start": "6650440",
    "end": "6657639"
  },
  {
    "text": "on person documents all this stuff adds together to lead you to the ability to steal an ID steal a hash file and then",
    "start": "6657639",
    "end": "6665000"
  },
  {
    "text": "become that user I mean it all sort of plays into each other and with this particular",
    "start": "6665000",
    "end": "6670679"
  },
  {
    "text": "vulnerability the way they're checking the hashes in here there's no easy fix",
    "start": "6670679",
    "end": "6676199"
  },
  {
    "text": "uh it's going to involve a redesign when they come out with version six you just watch me here on just did",
    "start": "6676199",
    "end": "6683239"
  },
  {
    "text": "here when when you're making this password hash change are you actually poking into the memory and changing the",
    "start": "6683239",
    "end": "6690040"
  },
  {
    "text": "hash in that memory location yes yes then when the lus user is loging in when",
    "start": "6690040",
    "end": "6695679"
  },
  {
    "text": "the victim is logging in he's actually autha against the not server itself well all you're you're sort of",
    "start": "6695679",
    "end": "6703040"
  },
  {
    "text": "missing missing one piece here what what you do when you enter that password in on your notes client is unlock that ID",
    "start": "6703040",
    "end": "6709480"
  },
  {
    "text": "file you don't authenticate against the server then uses that data in the ID",
    "start": "6709480",
    "end": "6714760"
  },
  {
    "text": "file when it connects to the server there's like right right that's all it's doing",
    "start": "6714760",
    "end": "6720400"
  },
  {
    "text": "is unlocking that what we're doing is tricking the client into unlocking that it's sort of like it it's sort of",
    "start": "6720400",
    "end": "6726679"
  },
  {
    "text": "like me guessing your pgp passphrase your passphrase doesn't have anything to do with pgp it it's just unlocking your",
    "start": "6726679",
    "end": "6734760"
  },
  {
    "text": "your your key file key which is where your RSA information store which you know is like a bunch of long numbers so",
    "start": "6734760",
    "end": "6740800"
  },
  {
    "text": "all we've done is Trick this thing in into opening up the file where all those long numbers are stored and then when it",
    "start": "6740800",
    "end": "6746920"
  },
  {
    "text": "we go request something from the server that file is unlocked so it sends the right set of long numbers back out to that server does that make more sense",
    "start": "6746920",
    "end": "6755560"
  },
  {
    "text": "okay thanks okay you want to take over from",
    "start": "6755560",
    "end": "6763800"
  },
  {
    "text": "this point I can do it so like like we were saying from this as you as you",
    "start": "6763800",
    "end": "6769280"
  },
  {
    "text": "hopefully picked up from this there's a lot of stuff going on with notes a lot of vulnerabilities",
    "start": "6769280",
    "end": "6775000"
  },
  {
    "text": "exist ranging from basic misconfigurations from install to serious problems in their implementation",
    "start": "6775000",
    "end": "6781800"
  },
  {
    "text": "of of encryption technology to the mechanism in which they manage which they perform Key Management I mean",
    "start": "6781800",
    "end": "6788639"
  },
  {
    "text": "there's some serious un serious flaws in the underlying development of security in Lotus Notes and there's ways to",
    "start": "6788639",
    "end": "6795239"
  },
  {
    "text": "combat this but they're a little difficult we keep going on um obviously for the the server",
    "start": "6795239",
    "end": "6803639"
  },
  {
    "text": "security uh you want to make sure that you're blocking out particular things and URLs in the HTTP comp file there's",
    "start": "6803639",
    "end": "6811320"
  },
  {
    "text": "no reason why you should be able to uh do particular views there's no reason why you should look for NSF with no with",
    "start": "6811320",
    "end": "6817199"
  },
  {
    "text": "no value there's no reason why you should be able to look for uh default Navigator views Etc on server ID files",
    "start": "6817199",
    "end": "6823840"
  },
  {
    "text": "they recommend no password that's just ludicrous if I can steal your server ID file like we said can use that to pull",
    "start": "6823840",
    "end": "6829480"
  },
  {
    "text": "down and local locally replicate copies of databases Etc um some of the other problems with",
    "start": "6829480",
    "end": "6836920"
  },
  {
    "text": "oh this is just a summary of the problems execution of malicious code etc etc keep keep going to the yeah keep",
    "start": "6836920",
    "end": "6842920"
  },
  {
    "text": "going up to the the final recommendations here we go um rather than fog a dead horse since we're eating in everybody's lunchtime obviously you",
    "start": "6842920",
    "end": "6849960"
  },
  {
    "text": "want to restrict access to the web you want to restrict views from particular particular uh URLs like we were saying",
    "start": "6849960",
    "end": "6856960"
  },
  {
    "text": "you want to make sure that you don't store user IDs in the names and address book because anybody can get them and",
    "start": "6856960",
    "end": "6862880"
  },
  {
    "text": "while you may try to block access to the names and address book over the Internet the vast majority of your problems aren't going to come from the internet",
    "start": "6862880",
    "end": "6869199"
  },
  {
    "text": "they're going to come from the guy down the hall who's going to have access to your names and address book I mean let's",
    "start": "6869199",
    "end": "6874840"
  },
  {
    "text": "face it do you think the cia's notes servers are on the internet no are they accessible to most people who are sitting out there in Langley well yeah I",
    "start": "6874840",
    "end": "6882159"
  },
  {
    "text": "mean your your problem comes from inside and you and like you were saying like",
    "start": "6882159",
    "end": "6887199"
  },
  {
    "text": "this gentleman back in the back was saying you want to probably choose different passwords for your ID and for",
    "start": "6887199",
    "end": "6893520"
  },
  {
    "text": "the HTTP password hash because that way the thing that you're using to unlock your ID file is in no way represented by",
    "start": "6893520",
    "end": "6900360"
  },
  {
    "text": "the information that you can gain out of out of an HTV password hash one good thing that some most",
    "start": "6900360",
    "end": "6907079"
  },
  {
    "text": "people don't do is you might want to just store your user ID on removable media use it when you log in and then",
    "start": "6907079",
    "end": "6912320"
  },
  {
    "text": "pop it out that way someone can't steal it off your machine by you executing malicious code no one's going to do that",
    "start": "6912320",
    "end": "6919960"
  },
  {
    "text": "but if you really want to make sure that no one one's going to steal your ID by you executing or visiting a web page or",
    "start": "6919960",
    "end": "6926679"
  },
  {
    "text": "opening up a mail attachment hitting a stored form that's really one of your only ways to combat that one of the",
    "start": "6926679",
    "end": "6932679"
  },
  {
    "text": "things that Lotus has recommended is using what they call the strong internet password hash which obfuscates the",
    "start": "6932679",
    "end": "6938320"
  },
  {
    "text": "password Hash a little bit more what they've done is they've taken broken rc4 and sort of put another little wrapper",
    "start": "6938320",
    "end": "6944480"
  },
  {
    "text": "on top of it to give it that seed uh it's looking like uh yeah it's it's like",
    "start": "6944480",
    "end": "6950400"
  },
  {
    "text": "it's it's some sort of Bas 64 in code and you know I would imagine probably by the time summer rolls around we'll have",
    "start": "6950400",
    "end": "6955639"
  },
  {
    "text": "that too but that's it's still just an extra step",
    "start": "6955639",
    "end": "6961040"
  },
  {
    "text": "but it at least obscures that data from prying eyes looking at names and address books um since we know that the sharing",
    "start": "6961040",
    "end": "6968199"
  },
  {
    "text": "of uh since F5 doesn't really clear out user credentials log out if you're going to get coffee shut down your shut down",
    "start": "6968199",
    "end": "6975119"
  },
  {
    "text": "your notes browser don't leave any of that stuff resident in memory um don't click on any email attachments obviously",
    "start": "6975119",
    "end": "6982599"
  },
  {
    "text": "and unfortunately sometimes don't open email uh you want to enforce strong ACLS",
    "start": "6982599",
    "end": "6989079"
  },
  {
    "text": "on all your databases uh you definitely want to restrict anonymous anonymous",
    "start": "6989079",
    "end": "6994440"
  },
  {
    "text": "browsing on all your databases because there's no reason why someone who hasn't authenticated to your server should be able to look at your catalog should be",
    "start": "6994440",
    "end": "7000599"
  },
  {
    "text": "able to look at your log files should be able to look at the names and address book Etc also you want to make sure and this",
    "start": "7000599",
    "end": "7006840"
  },
  {
    "text": "is most important is you disable stored forms on your Mail databases because why why make it any",
    "start": "7006840",
    "end": "7013400"
  },
  {
    "text": "easier I mean it's it just baffles me and probably everyone in this room at this point that we haven't seen the same",
    "start": "7013400",
    "end": "7020199"
  },
  {
    "text": "kind of massive email attacks against Lotus Notes that since it's so much easier to do under notes than it is",
    "start": "7020199",
    "end": "7026520"
  },
  {
    "text": "under under windows it's so much easier people don't even have to click they just have to open thanks to stored forms",
    "start": "7026520",
    "end": "7033199"
  },
  {
    "text": "so first thing you want to do is go home and make sure those things are turned off on all your Mail databases um you",
    "start": "7033199",
    "end": "7038719"
  },
  {
    "text": "want to enforce strong ecls for all unsigned and untrusted documents uh there are ways that we showed that",
    "start": "7038719",
    "end": "7044199"
  },
  {
    "text": "you can set those back but again it involves other steps and if you take all these recommendations and put them into play you're going to make it a lot",
    "start": "7044199",
    "end": "7050239"
  },
  {
    "text": "harder for people to take advantage of your notes environment but it takes a lot of work um and finally ensure strong",
    "start": "7050239",
    "end": "7057000"
  },
  {
    "text": "host level security on your notes servers you know all of this stuff is geared towards operating in the notes",
    "start": "7057000",
    "end": "7062159"
  },
  {
    "text": "environment but if you're on an NT server and someone whacks you because you're administrator account on the NT servers",
    "start": "7062159",
    "end": "7067840"
  },
  {
    "text": "administrator well then they'll just go in the notes data directory and steal stuff without ever having to talk to notes same thing goes if you're running",
    "start": "7067840",
    "end": "7074119"
  },
  {
    "text": "under Solaris you know shut down all those Superfluous services and just run notes on it um you know there's so many",
    "start": "7074119",
    "end": "7080960"
  },
  {
    "text": "times that we've broken into notes installations without even having to go through the esoteric problems with notes",
    "start": "7080960",
    "end": "7086440"
  },
  {
    "text": "you just sort of sneak around and hit n or hit son or hit somebody else and sneak in through the back way and steal",
    "start": "7086440",
    "end": "7091599"
  },
  {
    "text": "the files natively now for for other",
    "start": "7091599",
    "end": "7097440"
  },
  {
    "text": "recommendations Lotus has a bunch of stuff on their web page that offers a lot of security security advice suggest",
    "start": "7097440",
    "end": "7103360"
  },
  {
    "text": "that you use them and keep a breast of things on the security Zone and you know keep watching for stuff like this as as",
    "start": "7103360",
    "end": "7110079"
  },
  {
    "text": "we said we're we're supposed to be working on a paper this weekend hopefully it'll be out soon that we'll sort of detail this on much much greater",
    "start": "7110079",
    "end": "7116599"
  },
  {
    "text": "information and outline the fixes a lot better than we're able to cover in 90 minutes but you should also take some",
    "start": "7116599",
    "end": "7122920"
  },
  {
    "text": "initiative on your own and assess your own level of security and look for other people who are if you're not that",
    "start": "7122920",
    "end": "7128520"
  },
  {
    "text": "comfortable in notes look to have other people in notes come in and help you out these guys here are probably two of the best Note Security Experts in the world",
    "start": "7128520",
    "end": "7135320"
  },
  {
    "text": "so if you're interested in having someone take a look at your environment should call them and hit it",
    "start": "7135320",
    "end": "7142520"
  },
  {
    "text": "again and this is this is where we are their trust Factory I'm with SDI and we",
    "start": "7142520",
    "end": "7148400"
  },
  {
    "text": "all know who Lotus is so I think now we can go eat",
    "start": "7148400",
    "end": "7152960"
  },
  {
    "text": "lunch just just so that everybody knows back",
    "start": "7156360",
    "end": "7161920"
  }
]