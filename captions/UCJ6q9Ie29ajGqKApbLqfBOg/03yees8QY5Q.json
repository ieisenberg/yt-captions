[
  {
    "text": "[Music]",
    "start": "40",
    "end": "3419"
  },
  {
    "text": "[Music]",
    "start": "5530",
    "end": "24860"
  },
  {
    "text": "yes [Music]",
    "start": "28960",
    "end": "46670"
  },
  {
    "text": "couple announcements before uh Jed gets started um first uh Hacker Court is at",
    "start": "50960",
    "end": "56520"
  },
  {
    "text": "uh 6:30 it's going to be in Palace 3 not in Palace 1 um so anybody wanted to go to that it's",
    "start": "56520",
    "end": "62760"
  },
  {
    "text": "uh next door the other way um also black Hat's happy to announce that they have",
    "start": "62760",
    "end": "67880"
  },
  {
    "text": "their uh feedback server up um the info is on these pink sheets they've got them taped all over the walls uh outside the",
    "start": "67880",
    "end": "74479"
  },
  {
    "text": "doors here um they should also have some up at the regge desk by the time you get out of here um they also have the uh",
    "start": "74479",
    "end": "81400"
  },
  {
    "text": "Wireless uh Network info um so make sure you pick these up you need um you need a",
    "start": "81400",
    "end": "87520"
  },
  {
    "text": "username and password to get on the feedback server they are on your receipt uh right where it says your",
    "start": "87520",
    "end": "94399"
  },
  {
    "text": "receipt down on the bottom you got a username and a password um so they'd like for you to",
    "start": "94399",
    "end": "100079"
  },
  {
    "text": "check out the feedback server and I haven't seen it yet but I'm self-explanatory um so that's it for the",
    "start": "100079",
    "end": "107680"
  },
  {
    "text": "announcements and uh here's uh Jed hail he's uh lead security architect at Nitro",
    "start": "107680",
    "end": "113439"
  },
  {
    "text": "Data Systems and he's uh doing his presentation on [Music]",
    "start": "113439",
    "end": "118840"
  },
  {
    "text": "hogwash yeah I'm Jed hail from Nitro Data",
    "start": "118840",
    "end": "124200"
  },
  {
    "text": "Systems uh my normal full-time job is building uh data management solutions",
    "start": "124200",
    "end": "130319"
  },
  {
    "text": "for uh large scale uh security information databases in other words if",
    "start": "130319",
    "end": "135560"
  },
  {
    "text": "you're generating lots of security data from firewalls and intrusion detection systems Etc I specialize in helping you",
    "start": "135560",
    "end": "142360"
  },
  {
    "text": "capture and and keep and analyze all that data but what I'm here to talk about today is Gateway intrusion",
    "start": "142360",
    "end": "147640"
  },
  {
    "text": "detection systems so what's a Gateway IDs a Gateway",
    "start": "147640",
    "end": "153200"
  },
  {
    "text": "intrusion detection system is an intrusion detection system that behaves as a network Gateway in",
    "start": "153200",
    "end": "160239"
  },
  {
    "text": "other words it sits at the entrance to a network and analyzes the traffic as it",
    "start": "160239",
    "end": "166280"
  },
  {
    "text": "goes through and the idea behind a Gateway IDs is it goes a little Beyond a firewall firewall is able to look at at",
    "start": "166280",
    "end": "174640"
  },
  {
    "text": "you know at at at the destination and and the destination port and where it's coming from those sorts of things and",
    "start": "174640",
    "end": "181200"
  },
  {
    "text": "make a decision on whether or not the packets allowed to pass through the firewall a Gateway intrusion detection",
    "start": "181200",
    "end": "186360"
  },
  {
    "text": "system's goal is to do deeper inspection on the packet to actually analyze the packet from malicious content or other",
    "start": "186360",
    "end": "193280"
  },
  {
    "text": "content that you don't want to allow into your network if it finds that sort of content it should drop the",
    "start": "193280",
    "end": "198720"
  },
  {
    "text": "packet so ideally a Gateway IDs should be able to",
    "start": "198720",
    "end": "204440"
  },
  {
    "text": "drop any attacks on your network now obviously we're far from perfect there but you know that's the general goal is",
    "start": "204440",
    "end": "211360"
  },
  {
    "text": "to be able to stop all known exploits uh I could say right now the state-of-the-art in in Gateway intrusion",
    "start": "211360",
    "end": "217400"
  },
  {
    "text": "detection systems you can get you can basically reliably stop any known exploit if there's an exploit floating",
    "start": "217400",
    "end": "223599"
  },
  {
    "text": "around out there it is possible to detect it and stop it uh of course it's really difficult to",
    "start": "223599",
    "end": "230879"
  },
  {
    "text": "stop a tax that you don't know about and you know that's when you have to rely on on good system administration",
    "start": "230879",
    "end": "237040"
  },
  {
    "text": "policy proper networking policies proper system configuration you know and all those other",
    "start": "237040",
    "end": "244400"
  },
  {
    "text": "things so here's some comparisons between a Gateway intrusion detection system and a network intrusion detection",
    "start": "244400",
    "end": "251000"
  },
  {
    "text": "system a Gateway intrusion detection system again acts as a network Gateway it decides what enters or leaves your",
    "start": "251000",
    "end": "257600"
  },
  {
    "text": "network uh a network intrusion detection system on the other hand can only",
    "start": "257600",
    "end": "263199"
  },
  {
    "text": "observe Network traffic it sits in parallel to your traffic it watches the traffic go by it analyzes it it",
    "start": "263199",
    "end": "268479"
  },
  {
    "text": "generates alerts all that stuff a Gateway IDs will will stop packets that it doesn't like a network",
    "start": "268479",
    "end": "275720"
  },
  {
    "text": "intrusion detection system will generate an alert and will log the packet but it can't stop the packets in general now",
    "start": "275720",
    "end": "283080"
  },
  {
    "text": "there are a few intrusion detection systems that have some sort of active response mechanism where they attempt to modify a firewall rule or they'll or",
    "start": "283080",
    "end": "290600"
  },
  {
    "text": "they'll send spoofed resets or things like that to try and tear the connection down but that's not 100% reliable and",
    "start": "290600",
    "end": "296800"
  },
  {
    "text": "and there's a lot of problems associated with that approach a Gateway IDs should be able to prevent",
    "start": "296800",
    "end": "303560"
  },
  {
    "text": "most successful intrusions it's particularly useful for for dealing with with things like worms like uh if you",
    "start": "303560",
    "end": "309479"
  },
  {
    "text": "had a large Network full of uh of IIs web servers and this is where hogwash got very popular back in the code red",
    "start": "309479",
    "end": "317440"
  },
  {
    "text": "days people would have these large networks full especially service providers or people like that where they",
    "start": "317440",
    "end": "322800"
  },
  {
    "text": "had a bunch of I systems that they didn't own you know they were someone else actually owned the system they were just providing the network and the",
    "start": "322800",
    "end": "330039"
  },
  {
    "text": "infrastructure and a lot of those people were lazy and wouldn't necessarily patch their machines so that code red wouldn't",
    "start": "330039",
    "end": "336000"
  },
  {
    "text": "get them and it created a terrible problem on their Network and so one of the things that that got really popular",
    "start": "336000",
    "end": "341080"
  },
  {
    "text": "is they would only use hogwash just to stop code red and that's that was a great that was",
    "start": "341080",
    "end": "347319"
  },
  {
    "text": "a tremendous value just there for a lot of people a network contusion detection system can tell you you've had a",
    "start": "347319",
    "end": "353440"
  },
  {
    "text": "successful attack it could tell you code Red's owned one of your systems but it can't stop it it's up you know it's up",
    "start": "353440",
    "end": "360039"
  },
  {
    "text": "to the CIS admin or or the network admin or somebody to do something about it which means you have a lot of quite",
    "start": "360039",
    "end": "365919"
  },
  {
    "text": "often a lot of lag time between when the intrusion is detected and when something's actually done about it now",
    "start": "365919",
    "end": "373440"
  },
  {
    "text": "on the downside on a Gateway IDs false positives are a very very very bad thing",
    "start": "373440",
    "end": "378759"
  },
  {
    "text": "if you have a rule that's dropping packets and it shouldn't drop then you're breaking stuff you know",
    "start": "378759",
    "end": "388199"
  },
  {
    "text": "you're going to you're going to break C Services it's hard to say you know exactly what might break now on a",
    "start": "388199",
    "end": "393400"
  },
  {
    "text": "network IDs if you have false positives it can be a real burden for the analyst or the for for the person that has to to",
    "start": "393400",
    "end": "399280"
  },
  {
    "text": "look at all the data that the system's generating but the odds are it's not going to actually break any network",
    "start": "399280",
    "end": "405880"
  },
  {
    "text": "Services that's a very important difference and for a long time people really thought that uh Gateway intrusion",
    "start": "405880",
    "end": "411720"
  },
  {
    "text": "detection would not be practical because of the false positive problem now uh in in our",
    "start": "411720",
    "end": "418520"
  },
  {
    "text": "experience we we've discovered that if you very carefully configure your system if you're very careful about the rules",
    "start": "418520",
    "end": "424879"
  },
  {
    "text": "you allow in your system you know if you really if you really use rules that you only know are truly accurate then",
    "start": "424879",
    "end": "431680"
  },
  {
    "text": "they're an extremely valuable asset to have on your network so here's hogwash a little more",
    "start": "431680",
    "end": "438000"
  },
  {
    "text": "in depth about it it's based on the snort intrusion detection system it's actually more of of a",
    "start": "438000",
    "end": "444520"
  },
  {
    "text": "wrapper around snort so the way hogwash is built snort sits at the core of the system and hogwash is a bunch of",
    "start": "444520",
    "end": "450639"
  },
  {
    "text": "bridging code and and other code and it's also extends the snort rules language so that it can make drop",
    "start": "450639",
    "end": "459039"
  },
  {
    "text": "instructions and things like that we'll get a little deeper in that in a moment the operation is very similar to a bridging firewall it it has two",
    "start": "459039",
    "end": "465080"
  },
  {
    "text": "interfaces in it it sits on your network packets go in and out two interfaces and hogwash makes a decision about",
    "start": "465080",
    "end": "471280"
  },
  {
    "text": "forwarding the packets back and forth yes sir it does not no it the question was",
    "start": "471280",
    "end": "478240"
  },
  {
    "text": "does it use the SN flexible response module it uses a different mechanism um",
    "start": "478240",
    "end": "484639"
  },
  {
    "text": "since since a Gateway IDs lives directly in line it touches every packet has to",
    "start": "484639",
    "end": "489720"
  },
  {
    "text": "pass through the system so you don't have to spoof a response you have control of the stream so all you have to",
    "start": "489720",
    "end": "494800"
  },
  {
    "text": "do is say I'm not going to let this stream happen anymore you know or you just have to say this this packet",
    "start": "494800",
    "end": "500159"
  },
  {
    "text": "doesn't go anywhere and you don't allow it to be bridged and and it will generate and send resets back but it",
    "start": "500159",
    "end": "506159"
  },
  {
    "text": "does not use it does not use the flexible resp response",
    "start": "506159",
    "end": "511599"
  },
  {
    "text": "stuff so the basic idea is you can write snort rules using the normal snort rules language that you know more likely than",
    "start": "512599",
    "end": "518719"
  },
  {
    "text": "not if you work in intrusion detection you're familiar with snort and its rules language the only difference is is now",
    "start": "518719",
    "end": "524640"
  },
  {
    "text": "you can you can write rules that say instead of saying alert or log you can write rules that say drop and I'll show",
    "start": "524640",
    "end": "530240"
  },
  {
    "text": "you some examples hogwash is compatible with a lot of the snort plugins uh particularly it's compatible",
    "start": "530240",
    "end": "537440"
  },
  {
    "text": "with a lot of the output plugins there are some problems with hogwash and P and",
    "start": "537440",
    "end": "543320"
  },
  {
    "text": "and a lot of the pre-processors that actually alter or re-inject content into the packet stream so all the decoder",
    "start": "543320",
    "end": "550360"
  },
  {
    "text": "plugins like HTP decode and the telet normalization stuff stream for frag 2 a",
    "start": "550360",
    "end": "556399"
  },
  {
    "text": "lot of important snort plugins don't work with hogwash now I've addressed that and and uh we'll get to that later",
    "start": "556399",
    "end": "562360"
  },
  {
    "text": "in the presentation hogwash is freely available under the GPL it's got a s it out at",
    "start": "562360",
    "end": "570760"
  },
  {
    "text": "sourceforge.net and the URLs in the presentation here towards the",
    "start": "570760",
    "end": "576839"
  },
  {
    "text": "end so the basic Theory just to summarize it's like a bridging firewall in a lot of respects it is a system",
    "start": "577000",
    "end": "583680"
  },
  {
    "text": "that's capable of making forward and drop decisions and like an intrusion detection system hogwash can examine",
    "start": "583680",
    "end": "589959"
  },
  {
    "text": "every part of the packet it can examine the ethernet header the IP header you know the TCP header the UDP header",
    "start": "589959",
    "end": "597040"
  },
  {
    "text": "whatever sort of header is next and it can it can examine all the flags you can examine the payload the whole packet you",
    "start": "597040",
    "end": "602800"
  },
  {
    "text": "know anything that snort rules language gives you access to you can use as part of your decision-making",
    "start": "602800",
    "end": "609320"
  },
  {
    "text": "process here's a typical installation I strongly recommend that you keep your",
    "start": "609320",
    "end": "614480"
  },
  {
    "text": "firewall hogwash was not designed to behave as a firewall was designed to behave as an intrusion detection system",
    "start": "614480",
    "end": "620560"
  },
  {
    "text": "what that means is it doesn't really have a lot of the features that you're used to having in a firewall you know it doesn't understand it doesn't understand",
    "start": "620560",
    "end": "626920"
  },
  {
    "text": "making routing decisions and things like that doesn't do that it doesn't do a lot of those sorts of things so you'll still",
    "start": "626920",
    "end": "632519"
  },
  {
    "text": "need a firewall all it's really good for is examining packet content making a decision if that packet should be",
    "start": "632519",
    "end": "638639"
  },
  {
    "text": "allowed to progress or not so in this diagram you can see some people will put hogwash in front of their firewall and",
    "start": "638639",
    "end": "645560"
  },
  {
    "text": "that way you can write rules that will protect machines on your DMZ and machines on your internal Network that's",
    "start": "645560",
    "end": "650839"
  },
  {
    "text": "a really popular deployment model for people have a DMZ full of mail servers and web servers and things like that",
    "start": "650839",
    "end": "656760"
  },
  {
    "text": "because then they can protect their web servers from code red or from command. exe attempts or you know from the",
    "start": "656760",
    "end": "664399"
  },
  {
    "text": "various PHP exploits that are floating around and all those sorts of",
    "start": "664399",
    "end": "669240"
  },
  {
    "text": "things so here's the new keywords that make all the that make all this functionality more or less apparent to",
    "start": "670560",
    "end": "675920"
  },
  {
    "text": "the user there's drop and this will kind of get back to your question sir drop",
    "start": "675920",
    "end": "681079"
  },
  {
    "text": "will take it will drop the packet if the if the drop rule uh Rings it will drop",
    "start": "681079",
    "end": "687120"
  },
  {
    "text": "the packet it'll send a reset in both dire dire to tear the session down and it logs the packet so you can analyze",
    "start": "687120",
    "end": "693079"
  },
  {
    "text": "the packet and make sure that packet was the kind of packet you actually wanted to drop ignore will drop the packet but it",
    "start": "693079",
    "end": "700120"
  },
  {
    "text": "does not send a reset okay so if you wish for some reason to to drop the packet quietly and",
    "start": "700120",
    "end": "707040"
  },
  {
    "text": "not reset the connection you can use an ignore Rule now what srop does is it will drop the packet and it'll send a",
    "start": "707040",
    "end": "713920"
  },
  {
    "text": "reset to tear down the connection but it doesn't generate an alert and it doesn't log the packet now that's desirable if",
    "start": "713920",
    "end": "720360"
  },
  {
    "text": "you have for instance code Red's another great example if you had a code red rule that was shutting down code red you",
    "start": "720360",
    "end": "726800"
  },
  {
    "text": "didn't necessarily want that thing to generate 50,000 alerts a day saying hey I dropped more code red I dropped more",
    "start": "726800",
    "end": "732079"
  },
  {
    "text": "code red you know that just clogs your logs up you really don't want to know all you care about is knowing that code",
    "start": "732079",
    "end": "737320"
  },
  {
    "text": "Red's being broken so srop will silently drop the packet it won't log the packet it won't generate aler or anything it",
    "start": "737320",
    "end": "743399"
  },
  {
    "text": "just does its job and goes on no logging which is uh really nice for for things",
    "start": "743399",
    "end": "748519"
  },
  {
    "text": "that you know you want to drop and you really don't care to log it okay I mentioned earlier that we",
    "start": "748519",
    "end": "755839"
  },
  {
    "text": "can't do traditional stream reassembly what that means is a normal",
    "start": "755839",
    "end": "763440"
  },
  {
    "text": "IDs there's a certain likelihood that an exploit or the signature you're looking for will be divided in across multiple",
    "start": "763440",
    "end": "770199"
  },
  {
    "text": "packets in the Stream and snort is a packet based detection engine in other words it examines one packet at a time",
    "start": "770199",
    "end": "776440"
  },
  {
    "text": "looks at the packet says is there anything bad in this packet no is there anything bad in this packet on and on and on like that one packet at a time",
    "start": "776440",
    "end": "782480"
  },
  {
    "text": "well to get around that snort does some stream reassembly where it'll take packets according to certain rules and",
    "start": "782480",
    "end": "788760"
  },
  {
    "text": "put them together into a super packet basically that super packet then goes through the IDS and is also checked and",
    "start": "788760",
    "end": "794959"
  },
  {
    "text": "in normal snort if if one of these reassembled packets generates an alert",
    "start": "794959",
    "end": "801040"
  },
  {
    "text": "then then you alert well that's not going to work because hogwash you can't take this new packet this reinjected",
    "start": "801040",
    "end": "807480"
  },
  {
    "text": "packet that snorts created and stick it back on your network that's no good you can't drop it because you're",
    "start": "807480",
    "end": "812639"
  },
  {
    "text": "not actually dropping the offending packet you WR the offending packet is is some other packet that was reassembled",
    "start": "812639",
    "end": "819279"
  },
  {
    "text": "in this big one so there's a fundamental problem there and our original solution in hogwash is this uh what hogwash will",
    "start": "819279",
    "end": "826360"
  },
  {
    "text": "do is it'll watch for a partial match in a packet and it looks for it at the end of",
    "start": "826360",
    "end": "831720"
  },
  {
    "text": "the packet you know so if it sees a partial content match at the end of the packet they'll say oh I've got a partial",
    "start": "831720",
    "end": "837480"
  },
  {
    "text": "match here it'll save the packet and then each time another packet comes in that happens to match the previous one",
    "start": "837480",
    "end": "844120"
  },
  {
    "text": "sequence wise Etc it'll put those two together and take a look and see if if",
    "start": "844120",
    "end": "850079"
  },
  {
    "text": "the full if the full uh if the full string is matched or not if it is matched it drops the second packet you",
    "start": "850079",
    "end": "856360"
  },
  {
    "text": "know and by dropping the second packet You' still broken you still broken the attempted exploit because only half only",
    "start": "856360",
    "end": "861959"
  },
  {
    "text": "half the payload got",
    "start": "861959",
    "end": "864920"
  },
  {
    "text": "through so this is something I like to refer to as opportunistic stream reassembly you're not reassembling every",
    "start": "867040",
    "end": "872800"
  },
  {
    "text": "stream all the time you're only reassembling your packet stream when you",
    "start": "872800",
    "end": "878120"
  },
  {
    "text": "have some indication in the in the packet content itself that you need to do some",
    "start": "878120",
    "end": "883480"
  },
  {
    "text": "reassembly this code actually happens to be uh pretty efficient we've it it has a",
    "start": "883480",
    "end": "889120"
  },
  {
    "text": "big circular cache and it's it's configurable by the user to say okay here's how many packets I want to keep cashed in memory for comparison by",
    "start": "889120",
    "end": "896160"
  },
  {
    "text": "default it holds 65,000 of them and uh we found in a lot of places these partial matches are are really quite",
    "start": "896160",
    "end": "902880"
  },
  {
    "text": "exceedingly rare unless somebody's really trying to mess around with you so it will keep we've seen a lot of",
    "start": "902880",
    "end": "909639"
  },
  {
    "text": "installations where these cached packets will actually stay in this circular buffer for days at a time before they",
    "start": "909639",
    "end": "915560"
  },
  {
    "text": "finally before the before the ring buffer goes around and overwrites them again so it works really well unless",
    "start": "915560",
    "end": "921160"
  },
  {
    "text": "somebody's deliberately trying to screw it up that's true for any IDs they",
    "start": "921160",
    "end": "926839"
  },
  {
    "text": "generally work really well unless someone's deliberately trying to screw it up defeating Port scans this is",
    "start": "926839",
    "end": "933360"
  },
  {
    "text": "another important thing you know if a bad guy is going to attack your network the first thing he's going to try and do",
    "start": "933360",
    "end": "939120"
  },
  {
    "text": "is uh condu conduct some reconnaissance on your network he's going to go through and he's going to see what machines are",
    "start": "939120",
    "end": "945240"
  },
  {
    "text": "there what services are offered on what machines he's going to try and deduce you know what version of the services",
    "start": "945240",
    "end": "951000"
  },
  {
    "text": "are running he's going to try and deduce what sort of os is running and you know he's going to try and gather as much",
    "start": "951000",
    "end": "957000"
  },
  {
    "text": "data as possible about your networ work before he actually perpetrates his",
    "start": "957000",
    "end": "963480"
  },
  {
    "text": "attack well ideally you'd be able to defeat this port scanner and make it so",
    "start": "964440",
    "end": "969959"
  },
  {
    "text": "that he could not could not even conduct reconnaissance on your network you'd make it so that it's impossible for him",
    "start": "969959",
    "end": "976399"
  },
  {
    "text": "to walk through your network and detail all your services so I wrote a port scan detector",
    "start": "976399",
    "end": "983360"
  },
  {
    "text": "it's in hogwash it's also part of snort and this uh this port scan detor",
    "start": "983360",
    "end": "988560"
  },
  {
    "text": "detector is a session based Port scanner so each time a new session is initiated by by somebody outside your network it",
    "start": "988560",
    "end": "995519"
  },
  {
    "text": "makes a note of where it came from and where it was going okay and and if you",
    "start": "995519",
    "end": "1001720"
  },
  {
    "text": "think about it when you do a port scan if we're using a very simple uh session where basically you define a session as",
    "start": "1001720",
    "end": "1007560"
  },
  {
    "text": "being a packet going from here to here from you know to this Source IP on this",
    "start": "1007560",
    "end": "1013160"
  },
  {
    "text": "Source Port then you have a very rudimentary session engine",
    "start": "1013160",
    "end": "1019199"
  },
  {
    "text": "and so each time we see one of these we make a note of it and then we track all sessions coming from a host until that",
    "start": "1019199",
    "end": "1025160"
  },
  {
    "text": "host goes idle for 60 seconds so if you send a bunch of packets and then you go idle for 60 seconds all his old sessions",
    "start": "1025160",
    "end": "1031558"
  },
  {
    "text": "will time out and they'll flush out of memory the point is is as long as he",
    "start": "1031559",
    "end": "1038000"
  },
  {
    "text": "keeps sending packets even if he's only sending one packet every 60 seconds you'll continue to store his all his",
    "start": "1038000",
    "end": "1043640"
  },
  {
    "text": "connection history and uh the basic algorithm is if you see 20",
    "start": "1043640",
    "end": "1049039"
  },
  {
    "text": "unique connections to Ports or five unique connections you know five connections to Unique targets then he's",
    "start": "1049039",
    "end": "1055400"
  },
  {
    "text": "tagged as being a port scanner or if it's some combination of those two you know maybe he hits four ports on five",
    "start": "1055400",
    "end": "1062039"
  },
  {
    "text": "targets and that or five ports on four targets that adds up to 20 ports yes",
    "start": "1062039",
    "end": "1068320"
  },
  {
    "text": "sir yeah his question was do those have to be complete connections or can they",
    "start": "1072160",
    "end": "1077280"
  },
  {
    "text": "just be a single s package the answer is yeah just a single packet sufficient it the way the way the tracking system",
    "start": "1077280",
    "end": "1083640"
  },
  {
    "text": "works it it knows okay you send a send packet to Port 80 you send a send packet",
    "start": "1083640",
    "end": "1088679"
  },
  {
    "text": "to Port 25 you send a send packet to Port 22 then you go around and you do that those hit those same three pack",
    "start": "1088679",
    "end": "1094360"
  },
  {
    "text": "those same three ports all over again it will only show up as three sessions it wouldn't show up as six it show up as",
    "start": "1094360",
    "end": "1100120"
  },
  {
    "text": "three but it still count they count yes they count sends count pings it",
    "start": "1100120",
    "end": "1106760"
  },
  {
    "text": "keeps track of icmp TCP and UDP so even if he does so even if he",
    "start": "1106760",
    "end": "1114320"
  },
  {
    "text": "just comes in and does a ping sweep of your network as soon as he's ping the first five machines he's going to get blocked so that's that's basically what",
    "start": "1114320",
    "end": "1120840"
  },
  {
    "text": "happens as soon as this guy has triggered one of these one of these conditions it'll start dropping all",
    "start": "1120840",
    "end": "1125919"
  },
  {
    "text": "subsequent packets from that Port scanner in the",
    "start": "1125919",
    "end": "1131760"
  },
  {
    "text": "back how is the block based it is based by IP address yes",
    "start": "1132039",
    "end": "1140320"
  },
  {
    "text": "[Music] yeah there's a denial of service possibility now the IDE idea is as soon",
    "start": "1144070",
    "end": "1149360"
  },
  {
    "text": "as unlike a lot of systems where these sorts of things happen that other people written systems like this but when when",
    "start": "1149360",
    "end": "1155320"
  },
  {
    "text": "the port scans are triggered they actually alter a firewall Rule and the firewall rule remains in effect for some",
    "start": "1155320",
    "end": "1160600"
  },
  {
    "text": "period of time the goal and if he spoofs from multiple sources he's going to have to spoof enough from each multiple",
    "start": "1160600",
    "end": "1166240"
  },
  {
    "text": "source to make each of those sources individually appear as a port scanner right he can't do one from one from",
    "start": "1166240",
    "end": "1173080"
  },
  {
    "text": "Source a and one from Source B and one from Source C cuz the port scan detector will see each of those as an individual",
    "start": "1173080",
    "end": "1179360"
  },
  {
    "text": "attempt I mean it won't correlate to say oh those are all from the same",
    "start": "1179360",
    "end": "1184840"
  },
  {
    "text": "guy five packets from each could be enough these uh these these Val these",
    "start": "1184919",
    "end": "1190159"
  },
  {
    "text": "thresholds are configurable at runtime uh and again you have to remember that as soon as he goes idle as soon as any",
    "start": "1190159",
    "end": "1196120"
  },
  {
    "text": "one of those goes idle for 60 seconds it quits dropping and you're back to normal so he's going to have to",
    "start": "1196120",
    "end": "1201799"
  },
  {
    "text": "constantly sustain this sort of effort to keep you shut down as soon as he quits and you could trim that down to 10",
    "start": "1201799",
    "end": "1207000"
  },
  {
    "text": "seconds if you wanted because your your timeout is configurable also so if you're worried about that sort of thing",
    "start": "1207000",
    "end": "1212360"
  },
  {
    "text": "trim it to 5 Seconds you know so he has to stay really act active I found 60 seconds to be a pretty good compromise",
    "start": "1212360",
    "end": "1218799"
  },
  {
    "text": "between catching the slow scanners and not being too badly uh too adversely",
    "start": "1218799",
    "end": "1224120"
  },
  {
    "text": "affected by denial service attempts but in the interest of of knowing that Network's different I made it",
    "start": "1224120",
    "end": "1229400"
  },
  {
    "text": "configurable so if you only want 5 Seconds of timeout you'll get 5 Seconds of",
    "start": "1229400",
    "end": "1234840"
  },
  {
    "text": "timeout if you look in if you look in the current CVS of snort the question was is this using the same port scan",
    "start": "1238280",
    "end": "1243840"
  },
  {
    "text": "detector that's in snort the answer is sort of there's I wrote a new port scan",
    "start": "1243840",
    "end": "1251159"
  },
  {
    "text": "detector if you guys keep current with snort CVS there's port scan 2 in there port scan 2 is a new port scan detector",
    "start": "1251159",
    "end": "1257360"
  },
  {
    "text": "that I wrote that is much much much more accurate than the original port scan detector and",
    "start": "1257360",
    "end": "1263440"
  },
  {
    "text": "you can actually configure and run both of them if you want but this stuff uses port scan",
    "start": "1263440",
    "end": "1269200"
  },
  {
    "text": "too yeah and there is an ignore variable so so like for instance the question was",
    "start": "1276400",
    "end": "1282200"
  },
  {
    "text": "it had to do with DNS servers and things like that triggering specifical",
    "start": "1282200",
    "end": "1288880"
  },
  {
    "text": "Global DNS reest right his question is you know Global DNS requests will",
    "start": "1288880",
    "end": "1294120"
  },
  {
    "text": "trigger this sort of port scan detection thing there is an ignore line so you can say you know ignore my DNS server ignore",
    "start": "1294120",
    "end": "1301120"
  },
  {
    "text": "things that you find are troublemakers for instance a lot of people have an auditing system that goes out and does",
    "start": "1301120",
    "end": "1307360"
  },
  {
    "text": "pings you know to make sure everything in the networks's up you want to put him in the ignore line so he doesn't get",
    "start": "1307360",
    "end": "1313360"
  },
  {
    "text": "marked",
    "start": "1317039",
    "end": "1320039"
  },
  {
    "text": "well yeah but they're always going to hit the same port on the DNS server so they're not going they're not going to you know",
    "start": "1327720",
    "end": "1334279"
  },
  {
    "text": "unless you have six DNS servers on your network and they're hitting all six of them you know they're not going to trigger because it's always going to be",
    "start": "1334279",
    "end": "1340520"
  },
  {
    "text": "traffic back and forth between the same the same ports on the same Target yeah you know so that one",
    "start": "1340520",
    "end": "1347520"
  },
  {
    "text": "triggers a port scan now you will quite frequently see because of the nature of the way a DNS server behaves if you",
    "start": "1347520",
    "end": "1353799"
  },
  {
    "text": "don't ignore your DNS server it may interpret the DNS server as Port scanning because he's going off",
    "start": "1353799",
    "end": "1359840"
  },
  {
    "text": "and talking on all sorts of different ports to different people so so things like you know all",
    "start": "1359840",
    "end": "1365880"
  },
  {
    "text": "your servers you'll probably want to ignore because obviously if your security is good if you haven't been owned your servers shouldn't be doing",
    "start": "1365880",
    "end": "1372080"
  },
  {
    "text": "Port scanning conne",
    "start": "1372080",
    "end": "1379320"
  },
  {
    "text": "it logs all the",
    "start": "1379320",
    "end": "1382240"
  },
  {
    "text": "connections okay how many different connection being made his question was",
    "start": "1384679",
    "end": "1389840"
  },
  {
    "text": "are you able to statistically monitor the uh the connection data so that you",
    "start": "1389840",
    "end": "1395000"
  },
  {
    "text": "can generate statistical information on on Trends is that more or less what you",
    "start": "1395000",
    "end": "1400120"
  },
  {
    "text": "said there there is code in uh in the conversation engine the engine that",
    "start": "1400120",
    "end": "1406039"
  },
  {
    "text": "keeps track of all these states that is designed to to basically dump a line per",
    "start": "1406039",
    "end": "1411360"
  },
  {
    "text": "connection of the pertinent data you know what source source destination Source Port destination Port duration of",
    "start": "1411360",
    "end": "1418880"
  },
  {
    "text": "the connection the number of bytes that removed the number of packets that removed it is possible to log that data",
    "start": "1418880",
    "end": "1424039"
  },
  {
    "text": "and then you can pump it into a database or or write some analysis program and and analyze that data yeah that's some",
    "start": "1424039",
    "end": "1429559"
  },
  {
    "text": "future work I want to do is is engineer some better analysis tools for that data because it's very valuable data arus or",
    "start": "1429559",
    "end": "1436320"
  },
  {
    "text": "use Argus SE",
    "start": "1436320",
    "end": "1442240"
  },
  {
    "text": "R it does not no the question was can you run separate rule sets for inside and outside interfaces now you can",
    "start": "1443200",
    "end": "1449440"
  },
  {
    "text": "basically in your rules you can say you know in your rules the rules are configured such that you have a source",
    "start": "1449440",
    "end": "1454840"
  },
  {
    "text": "and a destination if you want you know so you could actually run duplicate sets of the rules where one set you know one",
    "start": "1454840",
    "end": "1461880"
  },
  {
    "text": "set is set up so as to monitor your your internal Network and the other set's set up to monitor your external network and",
    "start": "1461880",
    "end": "1468039"
  },
  {
    "text": "then that would effectively watch either interface over",
    "start": "1468039",
    "end": "1473520"
  },
  {
    "text": "here no it wouldn't because a conversation engine would Mark the it's stateful enough to understand the return",
    "start": "1480840",
    "end": "1487159"
  },
  {
    "text": "session saying oh you know that's just it keeps State like that just like a like a stateful firewall does",
    "start": "1487159",
    "end": "1494240"
  },
  {
    "text": "[Music] sir",
    "start": "1494240",
    "end": "1499760"
  },
  {
    "text": "possibly the question was do I have plans on making log data compatible with the uh database logging in snort uh I'm",
    "start": "1505720",
    "end": "1513480"
  },
  {
    "text": "a busy guy I do I do actually you know professionally I do full-time database development of that nature uh although",
    "start": "1513480",
    "end": "1520360"
  },
  {
    "text": "I'm not the same Jed as the Jed who wrote the database plugin for snort that's Jed pel and I'm I'm Jed hail uh",
    "start": "1520360",
    "end": "1526919"
  },
  {
    "text": "funny name coll but I've considered doing it yes if it's",
    "start": "1526919",
    "end": "1532200"
  },
  {
    "text": "a it's a time and an energy [Music]",
    "start": "1532200",
    "end": "1540099"
  },
  {
    "text": "issue yeah he he was pointing out that there are tools on on uh using flow export to export a lot of this sort of",
    "start": "1550960",
    "end": "1557880"
  },
  {
    "text": "data that that the gentleman over here is interested in any other questions on this going back",
    "start": "1557880",
    "end": "1565080"
  },
  {
    "text": "aard or something so people can write plug for example if you don't want to do it maybe somebody can just write aard PL",
    "start": "1565080",
    "end": "1573440"
  },
  {
    "text": "write my yes um I have preliminary support for unified output his question",
    "start": "1573440",
    "end": "1579880"
  },
  {
    "text": "was will this write a unified output format file that barnyard can read and uh it's coming very shortly I have the",
    "start": "1579880",
    "end": "1587080"
  },
  {
    "text": "code I just haven't completely got all the Kinks worked out of it but yeah that will be available real soon I've been",
    "start": "1587080",
    "end": "1592799"
  },
  {
    "text": "very busy lately on a bunch of new functionality and we'll get to that here in a little bit any other questions on",
    "start": "1592799",
    "end": "1600159"
  },
  {
    "text": "this okay great how are we doing all",
    "start": "1600159",
    "end": "1604720"
  },
  {
    "text": "right and I if I have time at the end I'll actually demonstrate how this how how this port scan stuff",
    "start": "1605399",
    "end": "1612320"
  },
  {
    "text": "works okay content replacement I work with the honey net project and and uh this this technology",
    "start": "1612320",
    "end": "1619120"
  },
  {
    "text": "is actually being used as as a as the access control device on the honey net",
    "start": "1619120",
    "end": "1624360"
  },
  {
    "text": "and if you guys attend the honey net Presentation tomorrow I'll talk a little bit about how we're applying this",
    "start": "1624360",
    "end": "1629760"
  },
  {
    "text": "technology to Honey Nets and how it's useful there uh and this is some this",
    "start": "1629760",
    "end": "1634880"
  },
  {
    "text": "content replacement is something I wrote specifically for the Honey Nut project and what it gives you the ability to do",
    "start": "1634880",
    "end": "1640600"
  },
  {
    "text": "is actually since the packets are flowing through this device it has the ability to rewrite content on the packet",
    "start": "1640600",
    "end": "1647200"
  },
  {
    "text": "it can rewrite packets and so I added a replace a replace keyword to the rules language",
    "start": "1647200",
    "end": "1654320"
  },
  {
    "text": "and the replace it allows you to to take to take a chunk of the payload in the packet and",
    "start": "1654320",
    "end": "1661799"
  },
  {
    "text": "replace it with some other chunk that you choose there's an example rule there",
    "start": "1661799",
    "end": "1667519"
  },
  {
    "text": "and uh it's you know it's looking for traffic going to your IIs servers on Port 80 and it's specifically looking",
    "start": "1667519",
    "end": "1673919"
  },
  {
    "text": "for the content command. exe now normally you would hope hopefully never see anyone accessing command. Exe on",
    "start": "1673919",
    "end": "1680640"
  },
  {
    "text": "your web server this rule is not perfect it's but it's a simple example to make it perfect I'd have to make it more",
    "start": "1680640",
    "end": "1686120"
  },
  {
    "text": "complicated and uh can ruins the educational value so anyhow all this does is it simply looks for the content",
    "start": "1686120",
    "end": "1692360"
  },
  {
    "text": "command. exe in the in in a packet going to a web server on Port 80 and if it sees it it will replace it with YY y. YY",
    "start": "1692360",
    "end": "1702039"
  },
  {
    "text": "y so what what the web server at the other end would actually see it wouldn't see command. EX",
    "start": "1702039",
    "end": "1708000"
  },
  {
    "text": "the web server would see a get request for YY y.y you know which breaks the exploit",
    "start": "1708000",
    "end": "1714760"
  },
  {
    "text": "you know that's the goal and and we did this so that we didn't if you have someone that's attacking you and you",
    "start": "1714760",
    "end": "1720480"
  },
  {
    "text": "don't want to tip them off that you're dropping your packets but you don't want his exploit to be effective you rewrite",
    "start": "1720480",
    "end": "1726559"
  },
  {
    "text": "the exploit so it's broken and that way the packet goes on through and then he just sees he sees you know uh he sees",
    "start": "1726559",
    "end": "1734840"
  },
  {
    "text": "the the page come back from web server saying I don't know what that is and uh the hacker is none the wiser that that",
    "start": "1734840",
    "end": "1740760"
  },
  {
    "text": "you're interfering that's the goal and it works very nicely and uh any any content in the",
    "start": "1740760",
    "end": "1749159"
  },
  {
    "text": "payload can be replaced and it doesn't have to be asky content it will work on binary content also so you can feed it a",
    "start": "1749159",
    "end": "1754840"
  },
  {
    "text": "binary string and if it matches that binary string you can feed at some other string to replace the",
    "start": "1754840",
    "end": "1760240"
  },
  {
    "text": "content uh it's it's pretty nifty functionality",
    "start": "1760240",
    "end": "1765760"
  },
  {
    "text": "I I like it a lot and it has a lot of applicability if you're doing a honey net type of application where you don't",
    "start": "1765760",
    "end": "1772480"
  },
  {
    "text": "want the hacker in your honey net going out and hacking somebody else but you also don't want him to know that he's in",
    "start": "1772480",
    "end": "1777679"
  },
  {
    "text": "a honey net so this is a way of of breaking his exploits in a way that's very very difficult to detect CU it's",
    "start": "1777679",
    "end": "1783679"
  },
  {
    "text": "I'm like huh why do my connection keep getting reset when I know there's a web server there it's like must not be",
    "start": "1783679",
    "end": "1790480"
  },
  {
    "text": "vulnerable okay here's the basics for running",
    "start": "1790919",
    "end": "1795398"
  },
  {
    "text": "hogwash basically a lot some of the rules options look like normal snort some",
    "start": "1796320",
    "end": "1803000"
  },
  {
    "text": "don't you run hogwash minus C is where you're going to point at your configuration",
    "start": "1803000",
    "end": "1808399"
  },
  {
    "text": "file minus I is you know is a pointer to your internal interface minus E is you",
    "start": "1808399",
    "end": "1815720"
  },
  {
    "text": "know that's your device name for so like the eth0 and eth1 on",
    "start": "1815720",
    "end": "1820840"
  },
  {
    "text": "Linux minus L is your logging directory if you want to configure a logging directory uh minus minus n is a no rules",
    "start": "1820840",
    "end": "1827919"
  },
  {
    "text": "mode and this is just if you if you run hog if you run hogwash minus n and give it an internal external interface it'll",
    "start": "1827919",
    "end": "1834240"
  },
  {
    "text": "run without any rules which means it'll just sit there and behave like a bridge and it'll Bridge pack us back and forth",
    "start": "1834240",
    "end": "1839760"
  },
  {
    "text": "and back and forth and back and forth so if you want to test the bridging code in hogwash you can run it that way and",
    "start": "1839760",
    "end": "1845120"
  },
  {
    "text": "it'll just happily sit there and Bridge packets back and forth and you can try to break it",
    "start": "1845120",
    "end": "1851080"
  },
  {
    "text": "um minus K is for a uh NS control file I'm not going to go into that today",
    "start": "1851080",
    "end": "1858039"
  },
  {
    "text": "basically an S control file enables enables a protocol that lets you actually remotely control the hogwash",
    "start": "1858039",
    "end": "1864360"
  },
  {
    "text": "box without using a TC without without actually having an interface open but",
    "start": "1864360",
    "end": "1870039"
  },
  {
    "text": "it's a little involved and I decided not to get into it today because I have some other stuff I want to talk about so here at the bottom of the screen is an",
    "start": "1870039",
    "end": "1876159"
  },
  {
    "text": "example of how you would get hogwash running it's pretty simple if you run snort it's not hard at all to make",
    "start": "1876159",
    "end": "1882679"
  },
  {
    "text": "hogwash run okay here's the new stuff I want to",
    "start": "1882679",
    "end": "1888799"
  },
  {
    "text": "talk about one of the big nightmares I've been I've been working with Jason lson",
    "start": "1888799",
    "end": "1893880"
  },
  {
    "text": "and some of the other hogwash Developers for for the past year we actually introduced hogwash to the world last",
    "start": "1893880",
    "end": "1900080"
  },
  {
    "text": "year at Defcon we took a red hat 62 box and stuck it on the capture the flag",
    "start": "1900080",
    "end": "1906399"
  },
  {
    "text": "Network and we put a hogwash box in front of it and it was a brand new it was a little compact a nice little box",
    "start": "1906399",
    "end": "1912760"
  },
  {
    "text": "and we told everyone there on the capture of the flag Network that if they could break into the red hat 62 box I'd give give them that box that was a",
    "start": "1912760",
    "end": "1919000"
  },
  {
    "text": "challenge we left it on the capture of the flag Network for uh they didn't know that I'd spent the previous two months",
    "start": "1919000",
    "end": "1924679"
  },
  {
    "text": "finding every exploit I knew of for uh for uh Red Hat 62 and had written",
    "start": "1924679",
    "end": "1930840"
  },
  {
    "text": "signatures for it and uh it was a default Red Hat install though",
    "start": "1930840",
    "end": "1937278"
  },
  {
    "text": "yeah no it just sent resets it it just sent",
    "start": "1939039",
    "end": "1944840"
  },
  {
    "text": "resets yeah no I was just setting connections but the great part was at that point I didn't have port scan",
    "start": "1944840",
    "end": "1950760"
  },
  {
    "text": "detection working so the hackers could port scan the Box they could end map it and they say oh it's red hat 62 and it's",
    "start": "1950760",
    "end": "1956399"
  },
  {
    "text": "got every service known to God running and they say great this is an e easy Target and they'd go and they'd fire all",
    "start": "1956399",
    "end": "1961840"
  },
  {
    "text": "their exploits at it and they'd break and it was tremendously frustrating it was so funny so I we sat we had it there",
    "start": "1961840",
    "end": "1970200"
  },
  {
    "text": "for three days and we watched hackers hit the thing and hit the thing and hit the thing and uh they never got through",
    "start": "1970200",
    "end": "1977039"
  },
  {
    "text": "it survived 3 days on the capture of the flag Network I I thought that was a pretty good pretty good result anyhow",
    "start": "1977039",
    "end": "1983000"
  },
  {
    "text": "going back to it so so hogwash has been around more or less for a year and I've spoken at a couple conferences about it",
    "start": "1983000",
    "end": "1988919"
  },
  {
    "text": "the big problem with hogwash is it's currently architectured is hogwash is a wrapper around snort and",
    "start": "1988919",
    "end": "1997480"
  },
  {
    "text": "it's not officially supported or worked on by any of the snort development team besides myself I I'm a snort developer",
    "start": "1997480",
    "end": "2003480"
  },
  {
    "text": "I'm also a hogwash developer so I'm already wearing two hats",
    "start": "2003480",
    "end": "2008960"
  },
  {
    "text": "and the big problem I had was every time the snort I had to make enough changes down inside the snort source code that",
    "start": "2009799",
    "end": "2015600"
  },
  {
    "text": "it wouldn't cleanly it wouldn't cleanly patch back with snort CVS so anytime stuff changed i' have to go in and",
    "start": "2015600",
    "end": "2021840"
  },
  {
    "text": "manually backport it into hogwash and it was very timeconsuming a really slow development down because I was spending",
    "start": "2021840",
    "end": "2027000"
  },
  {
    "text": "more time trying to keep up with all the changes in snort and didn't have a lot of time to update hogwash and Jason the",
    "start": "2027000",
    "end": "2033279"
  },
  {
    "text": "other developer stayed really busy with the bridging code and and it turns out that writing good bridging code is a",
    "start": "2033279",
    "end": "2038399"
  },
  {
    "text": "really problematic thing and making good bridging code this crossplatform is even more Troublesome and so we we've we've",
    "start": "2038399",
    "end": "2045679"
  },
  {
    "text": "had our share of pro problems with the with the project and so a couple weeks ago I finally got tired of maintaining",
    "start": "2045679",
    "end": "2051599"
  },
  {
    "text": "compatibility between the two and convince the rest of the snort development team that I can add all the features and",
    "start": "2051599",
    "end": "2058200"
  },
  {
    "text": "integrate them cleanly into snort and basically make snort capable of running in an inline mode so here's what we do",
    "start": "2058200",
    "end": "2064960"
  },
  {
    "text": "we got inline snort now we've taken the course hogwash functionality ability to drop the ability to do s drops the",
    "start": "2064960",
    "end": "2071158"
  },
  {
    "text": "ability to ignores the port scan detection stuff the content replacement stuff all these core features I've spent",
    "start": "2071159",
    "end": "2076440"
  },
  {
    "text": "the last half hour talking about and put them all into snort cleanly merge them into",
    "start": "2076440",
    "end": "2082440"
  },
  {
    "text": "snort and this gives us the following advantages first of all one of the big",
    "start": "2082440",
    "end": "2087560"
  },
  {
    "text": "problems with hogwash is we've never been able to find someone for the project who would do rules maintenance for us and make sure that we always had",
    "start": "2087560",
    "end": "2093480"
  },
  {
    "text": "a rules file with all the current snort rules and you know that we had a set of rules have been well tested and we knew",
    "start": "2093480",
    "end": "2098640"
  },
  {
    "text": "they were reliable and we knew they wouldn't break your network and all that other stuff that's a lot of work well",
    "start": "2098640",
    "end": "2103960"
  },
  {
    "text": "snort. org already has a very well-developed rules effort going on and I've been working with Brian Caswell and",
    "start": "2103960",
    "end": "2110160"
  },
  {
    "text": "the other snort and the other developers to to generate official snort. org rules",
    "start": "2110160",
    "end": "2117640"
  },
  {
    "text": "database support for an inline snort so in other words if you want a set of drop rules that you know will work reliably",
    "start": "2117640",
    "end": "2124720"
  },
  {
    "text": "without being you know without breaking your network you'll be able to go to sn.org and get one and it'll be up to",
    "start": "2124720",
    "end": "2129880"
  },
  {
    "text": "date so that's the first big Advantage we'll have that the second Advantage is",
    "start": "2129880",
    "end": "2134920"
  },
  {
    "text": "is now that all this stuff's merged into snort if there's a bug it's now a snort bug and all the other snort developers",
    "start": "2134920",
    "end": "2140520"
  },
  {
    "text": "will feel Duty bound to help me fix it any of them here no they they don't",
    "start": "2140520",
    "end": "2147760"
  },
  {
    "text": "like to hear me act they go to the other stuff um some of the honeynut guys are",
    "start": "2147760",
    "end": "2153079"
  },
  {
    "text": "here uh so we have a larger pool of of developers which is great the big",
    "start": "2153079",
    "end": "2158839"
  },
  {
    "text": "Advantage for all you CIS admins and people who are actually running these things is now there's only you just have",
    "start": "2158839",
    "end": "2164560"
  },
  {
    "text": "to keep snort current you don't have to worry about keeping snort current and keeping hogwash current they're one and",
    "start": "2164560",
    "end": "2169640"
  },
  {
    "text": "the same and and now snort you either run snort as a as a Gateway IDs or you run snort as you always have done which",
    "start": "2169640",
    "end": "2176640"
  },
  {
    "text": "is as a network intrusion detection system and also the technology is is uh",
    "start": "2176640",
    "end": "2184280"
  },
  {
    "text": "is not as radically different from snort as hogwash is so it's even easier for all you snort users to understand how it",
    "start": "2184280",
    "end": "2190760"
  },
  {
    "text": "works and get up and running you know you don't have to remember two websites you don't have to remember two different sets of developers and all those other",
    "start": "2190760",
    "end": "2196960"
  },
  {
    "text": "things it's all the same effort now so I I'm really excited about this I worked pretty hard on it the last couple weeks",
    "start": "2196960",
    "end": "2202520"
  },
  {
    "text": "getting it all all done now I'm the only I'm the other as far as I know I I",
    "start": "2202520",
    "end": "2207560"
  },
  {
    "text": "haven't really spoken much with the other hogwash developers I believe there will still be a parallel effort and",
    "start": "2207560",
    "end": "2213040"
  },
  {
    "text": "they'll still be doing stuff with hogwash but they have some different goals they're trying to add more router likee functionality and and some stuff",
    "start": "2213040",
    "end": "2219119"
  },
  {
    "text": "like that to hogwash and I wasn't as interested in doing that I was interested in making hogwash more snort",
    "start": "2219119",
    "end": "2224520"
  },
  {
    "text": "likee so in some sense it might be a fork but if you're if you're using hogwash don't despair the the rest of",
    "start": "2224520",
    "end": "2231000"
  },
  {
    "text": "the development team is still still doing hogwash and I'm now working with the snort team on on getting as much of",
    "start": "2231000",
    "end": "2237599"
  },
  {
    "text": "this functionality as possible into snort one of the things I did was I threw away all the bridging code",
    "start": "2237599",
    "end": "2243920"
  },
  {
    "text": "because it was too hard to move so here's how it works inline snort now uses net filter",
    "start": "2243920",
    "end": "2251720"
  },
  {
    "text": "now net filter is is a is a generic name for IP tables which is the Linux",
    "start": "2251720",
    "end": "2257240"
  },
  {
    "text": "firewall and net filter has a really really neat feature and that really really neat feature is called",
    "start": "2257240",
    "end": "2263280"
  },
  {
    "text": "ipq ipq gives you the ability your firewall will will receive a packet and",
    "start": "2263280",
    "end": "2268920"
  },
  {
    "text": "then before it makes a final decision it hands that packet to some application in user space that application in user",
    "start": "2268920",
    "end": "2275839"
  },
  {
    "text": "space is now snort okay so so your IP tables firewall get it it can run it",
    "start": "2275839",
    "end": "2281200"
  },
  {
    "text": "through all its normal firewall rules that you have configured and then if it decides it's going to forward the packet",
    "start": "2281200",
    "end": "2286560"
  },
  {
    "text": "it can go to snort and the snort can do all of its an analysis and it goes back and tells IP tables what's decision is",
    "start": "2286560",
    "end": "2292960"
  },
  {
    "text": "you know if the decision's forward or drop so that's the general idea so now",
    "start": "2292960",
    "end": "2298920"
  },
  {
    "text": "so now you have IP tables doing what IP tables is good at which is bridging and firewalling and you have snort doing",
    "start": "2298920",
    "end": "2305119"
  },
  {
    "text": "what snort is good at which is is detecting",
    "start": "2305119",
    "end": "2309160"
  },
  {
    "text": "intrusions yeah yeah the question was you can change your rule set to work on the",
    "start": "2313280",
    "end": "2319119"
  },
  {
    "text": "basis of ports there's a lot of synergies in here that we're finding where the combination of Ip tables and",
    "start": "2319119",
    "end": "2325640"
  },
  {
    "text": "snort are tremendously powerful another great thing is a lot of people have asked me for a hogwash box that can can",
    "start": "2325640",
    "end": "2331640"
  },
  {
    "text": "do natting well there's no way in the world I wanted to attempt to write Gat code for hogwash well now you just",
    "start": "2331640",
    "end": "2337200"
  },
  {
    "text": "configure you know you just configure your cues on IP table you configure your chains I should say to do n and it'll",
    "start": "2337200",
    "end": "2344240"
  },
  {
    "text": "nap for you it'll nap you know just like IP tables has always done or any of those other little bits of firewall",
    "start": "2344240",
    "end": "2349920"
  },
  {
    "text": "functionality that you'd like your gateway IDs to do but I was never going to get it coded you know and this also",
    "start": "2349920",
    "end": "2357040"
  },
  {
    "text": "gives us the advantage there's there's I don't know there's scads and scads of people using net filter and using IP",
    "start": "2357040",
    "end": "2362599"
  },
  {
    "text": "tables that code is solid uh there's not as many people using hogw watch and and the bridging code still had some some",
    "start": "2362599",
    "end": "2368960"
  },
  {
    "text": "quirky little bits to it there's just lots of special cases you have to work out to make sure bridging always works",
    "start": "2368960",
    "end": "2374359"
  },
  {
    "text": "perfectly and uh now now the IP tables guys can worry about that and I can just worry about making the actual detection",
    "start": "2374359",
    "end": "2380440"
  },
  {
    "text": "core work as well as possible another beautiful thing about this is is I got to rearchitecturing",
    "start": "2380440",
    "end": "2388760"
  },
  {
    "text": "[Music] defrag 2 Works um what are some the others HTTP",
    "start": "2394510",
    "end": "2402119"
  },
  {
    "text": "decode works the telet normalization stuff it all works figured out a way to make all that stuff work and it's",
    "start": "2402119",
    "end": "2407920"
  },
  {
    "text": "transparent to the user so you don't have to use these multi rules anymore you don't have to use the multi content rules you just write your rules and you",
    "start": "2407920",
    "end": "2414560"
  },
  {
    "text": "count on the stream reassembler to to do the stream reassembly and the defragmentation and all that stuff for",
    "start": "2414560",
    "end": "2420800"
  },
  {
    "text": "you so it makes your job as a rules writer a lot easier you don't have to say now which of these rules might be in",
    "start": "2420800",
    "end": "2425880"
  },
  {
    "text": "fragmented or or in separate packets just let the stream reassembler take care of it for",
    "start": "2425880",
    "end": "2432560"
  },
  {
    "text": "you the big disadvantage is it's Linux only right now uh if you want to use this elsewhere we need ipq support there",
    "start": "2432560",
    "end": "2440800"
  },
  {
    "text": "any open yeah I'll get to that in a moment to build okay it's a little it's",
    "start": "2440800",
    "end": "2446119"
  },
  {
    "text": "a little harder to build this guy normal hogwash just builds pretty much for anyone as long as you have lib peap and",
    "start": "2446119",
    "end": "2452720"
  },
  {
    "text": "lib net installed to build inline snort is a little a little trick here first of all you have to enable inline mode so",
    "start": "2452720",
    "end": "2459599"
  },
  {
    "text": "you'd run a configure like you normally do when you build stuff and you pass a configure option to enable inline and then I'll go",
    "start": "2459599",
    "end": "2467079"
  },
  {
    "text": "through and it builds and enable all the inline functionality as part of snort I chose to make it a compile time option",
    "start": "2467079",
    "end": "2472880"
  },
  {
    "text": "so people wouldn't accidentally turn it on and uh and then have goofy stuff happening you have to intentionally",
    "start": "2472880",
    "end": "2478359"
  },
  {
    "text": "enable it and then you run make and it should build correctly if you have lib",
    "start": "2478359",
    "end": "2483760"
  },
  {
    "text": "ipq installed and uh we'll go in to how you how you get that in a moment Red Hat",
    "start": "2483760",
    "end": "2489800"
  },
  {
    "text": "73 does have ipq support in the kernel so if you're running a red hat 73 box and I think it works in 72 and maybe",
    "start": "2489800",
    "end": "2496280"
  },
  {
    "text": "even 71 I'm not sure I'm using it a 73 and it works just fine but you have to",
    "start": "2496280",
    "end": "2501480"
  },
  {
    "text": "have ipq uh compiled into the kernel and that's down underneath the net filter",
    "start": "2501480",
    "end": "2506800"
  },
  {
    "text": "options or the IP table options when you're building the kernel you can go in there and enable ipq if it's not in your",
    "start": "2506800",
    "end": "2513480"
  },
  {
    "text": "kernel it's a fairly you know pretty simple thing to change and you'll also need to have libnet",
    "start": "2513480",
    "end": "2518800"
  },
  {
    "text": "installed because it still does use libnet to craft the reset",
    "start": "2518800",
    "end": "2524599"
  },
  {
    "text": "packets okay if you don't have lib ipq on your system to make it build you need",
    "start": "2525000",
    "end": "2530119"
  },
  {
    "text": "the development libraries and to get those go to net filter.org and you get a current IP tables in tarball and then to",
    "start": "2530119",
    "end": "2537800"
  },
  {
    "text": "install it you don't have to rebuild all your IP table stuff if you unar it all you have to do is go in and do a make",
    "start": "2537800",
    "end": "2542960"
  },
  {
    "text": "install devel and that what that does is it install STS all the IP tables development stuff and then that'll give",
    "start": "2542960",
    "end": "2550200"
  },
  {
    "text": "that'll give snort what it needs to build so all you have to do is that and then you can go to to packet factory.",
    "start": "2550200",
    "end": "2556960"
  },
  {
    "text": "net and uh Mike's not here download Mike's wonderful library libnet and",
    "start": "2556960",
    "end": "2562880"
  },
  {
    "text": "install it okay so to configure IP tables",
    "start": "2562880",
    "end": "2569480"
  },
  {
    "text": "there's there's one little magic thing you have to do to make the queue happen and that is you have to instruct the",
    "start": "2569480",
    "end": "2574520"
  },
  {
    "text": "firewall to pass the packets through through this Q because there's this Q that's beating snort so first of all",
    "start": "2574520",
    "end": "2580640"
  },
  {
    "text": "you're going to you're going to you're going to you're going to load the kernel module that handles IP queing and so you do a mod probe ipq and then you're going",
    "start": "2580640",
    "end": "2588200"
  },
  {
    "text": "to add to your input chain for instance a minus JQ so that says you know after",
    "start": "2588200",
    "end": "2594599"
  },
  {
    "text": "you've got gotten done going through your input Q jump to jump to the uh to",
    "start": "2594599",
    "end": "2600200"
  },
  {
    "text": "the que to the IP q and at that point it takes care of passing the packet into",
    "start": "2600200",
    "end": "2605359"
  },
  {
    "text": "snort now an important thing to realize is if you enable this functionality if you put that if you put Q onto your IP",
    "start": "2605359",
    "end": "2611720"
  },
  {
    "text": "table's firewall it will drop packets until you have an application running at",
    "start": "2611720",
    "end": "2617440"
  },
  {
    "text": "the other end of that queue like inline snort that makes decisions on those packets it'll just start dropping them",
    "start": "2617440",
    "end": "2623400"
  },
  {
    "text": "so if you're going to if you're going to enable this and all a sudden your firewall breaks it's because you haven't fired up snort yet so you have to enable",
    "start": "2623400",
    "end": "2630440"
  },
  {
    "text": "this on your firewall and then immediately fire up snort and then it'll start moving packets again",
    "start": "2630440",
    "end": "2636680"
  },
  {
    "text": "I have a basic IP table script at at snort. org uh all this like I said I've",
    "start": "2636680",
    "end": "2644559"
  },
  {
    "text": "really put all this together in the last couple weeks and I'm still working with the rest of the snort team to get everything formalized but real soon this",
    "start": "2644559",
    "end": "2651160"
  },
  {
    "text": "will have its own dedicated webspace out at sn.org and we'll put documents and all the other stuff out there yes",
    "start": "2651160",
    "end": "2658880"
  },
  {
    "text": "sir this is this is working with snort one9 this is this is The Cutting Edge",
    "start": "2658920",
    "end": "2664480"
  },
  {
    "text": "development stuff yeah [Music]",
    "start": "2664480",
    "end": "2669650"
  },
  {
    "text": "okay now what so what do we do next well you're going to configure your rules file like you normally would if any of",
    "start": "2670720",
    "end": "2677000"
  },
  {
    "text": "you who who use snort you're going to go through and and you can you're free to use any configuration options you want they should all work with the exception",
    "start": "2677000",
    "end": "2683599"
  },
  {
    "text": "of a log TCP dump it's got a small problem but I'll have that fixed probably",
    "start": "2683599",
    "end": "2690200"
  },
  {
    "text": "tonight um you change alerts any any alerts that",
    "start": "2690200",
    "end": "2696760"
  },
  {
    "text": "where you actually wanted to be drops you change those to drops and then you you run you run start",
    "start": "2696760",
    "end": "2702400"
  },
  {
    "text": "with a minus capital Q and the minus capital Q will enable the inline mode so if you run snort with a minus Q you",
    "start": "2702400",
    "end": "2708640"
  },
  {
    "text": "don't you don't give it an interface name you don't do like the minus I et0 or anything so it's not looking for an",
    "start": "2708640",
    "end": "2714200"
  },
  {
    "text": "interface anymore snort is going to acquire its packets from IP tables so basically that minus Q substitutes for",
    "start": "2714200",
    "end": "2720640"
  },
  {
    "text": "your interface argument and the minus Q says get your packets from from IP",
    "start": "2720640",
    "end": "2727800"
  },
  {
    "text": "tables and it should run at that point here's a couple sample rules kind of",
    "start": "2727800",
    "end": "2733160"
  },
  {
    "text": "thing you do you can see these look like normal snort rules with the exception of",
    "start": "2733160",
    "end": "2738280"
  },
  {
    "text": "a drop at the front instead of an alert uh the first rule up there would just drop any incoming Port 80",
    "start": "2738280",
    "end": "2746039"
  },
  {
    "text": "connections so if you're wanting to be really rude and deny Port 80 connections that's how you do it the second one",
    "start": "2746280",
    "end": "2752880"
  },
  {
    "text": "would drop any command. exe attempts to your we to uh on coming you know coming",
    "start": "2752880",
    "end": "2758040"
  },
  {
    "text": "into your Port your network on Port 80 those are simple rules I wouldn't really recommend running those on your network",
    "start": "2758040",
    "end": "2764040"
  },
  {
    "text": "they're they're intended to be examples okay more what's coming in the future this has yet to merge into",
    "start": "2764040",
    "end": "2772319"
  },
  {
    "text": "CVS it's happening I've got a couple of the other guys reviewing everything I've done just to make sure I haven't done",
    "start": "2772319",
    "end": "2777920"
  },
  {
    "text": "anything really boneheaded uh and then we're going to merge it into CVS and so if you do a CVS",
    "start": "2777920",
    "end": "2783319"
  },
  {
    "text": "update all the code will be in there um the rules database is something that",
    "start": "2783319",
    "end": "2790559"
  },
  {
    "text": "we're earing development on right now so that's coming documentation I've already got a couple volunteers to help me with",
    "start": "2790559",
    "end": "2796040"
  },
  {
    "text": "the documentation and also since the honey net Project's going to be using this stuff they've got a document it for",
    "start": "2796040",
    "end": "2802040"
  },
  {
    "text": "all the honey Nets so I've got I I kind of get I get some great help from there too the other thing do I have any open",
    "start": "2802040",
    "end": "2809559"
  },
  {
    "text": "BSD developers here please I really want to add I've heard a",
    "start": "2809559",
    "end": "2814640"
  },
  {
    "text": "rumor that open BSD packet filter is adding Q support for packet filter just",
    "start": "2814640",
    "end": "2821160"
  },
  {
    "text": "like IP tables does but I've not been able to verify and I haven't able to find an open BSD developer to ask about",
    "start": "2821160",
    "end": "2826200"
  },
  {
    "text": "it I know they're floating around the conference so if any of you guys know of a developers here Point them my way and i' if if I can if I can find out how",
    "start": "2826200",
    "end": "2833599"
  },
  {
    "text": "this works in open BSD I will I will make snort support open BSD as well in this mode and there's a lot of other new",
    "start": "2833599",
    "end": "2839440"
  },
  {
    "text": "features that we're working on important things to remember in the",
    "start": "2839440",
    "end": "2844920"
  },
  {
    "text": "end Gateway intrusion detection system will bust the living hell out of your network if you're not very",
    "start": "2844920",
    "end": "2850319"
  },
  {
    "text": "careful okay uh test test test test test one of",
    "start": "2850319",
    "end": "2855760"
  },
  {
    "text": "the great things about this is you can write your rules first as alerts you write your rules as alerts let them run",
    "start": "2855760",
    "end": "2863000"
  },
  {
    "text": "and make sure that the alerts are you know when when the thing alerts look at it and make sure that the alerts are",
    "start": "2863000",
    "end": "2868160"
  },
  {
    "text": "alerting on what you expect it to alert on and not doing something goofy once you're happy that the alert R rule is",
    "start": "2868160",
    "end": "2873839"
  },
  {
    "text": "working properly change it to a drop you don't have to write a drop rule and put it out there cold you know so so write",
    "start": "2873839",
    "end": "2880520"
  },
  {
    "text": "it as an alert first and then change it to a drop once you're satisfied it works right inline snort or hogwash both still",
    "start": "2880520",
    "end": "2887319"
  },
  {
    "text": "understand alert they still understand all the normal snort stuff you just have some extra functionality and again I'm a big",
    "start": "2887319",
    "end": "2894599"
  },
  {
    "text": "advocate of Defense in depth it's this is not a replacement for for a real full-blown dedicated firewall admin by a",
    "start": "2894599",
    "end": "2902240"
  },
  {
    "text": "competent firewall admin it's not it's not a replacement for an intrusion detection system doing a lot of the",
    "start": "2902240",
    "end": "2908559"
  },
  {
    "text": "other things that intrusion detection systems normally do which are more along the lines of analysis and health keeping",
    "start": "2908559",
    "end": "2914400"
  },
  {
    "text": "and that sort of thing it's definitely not a a replacement for proper system patching and taking care of your systems",
    "start": "2914400",
    "end": "2921280"
  },
  {
    "text": "you know you got to keep taking care of all that stuff just because you have another art tool in Your Arsenal doesn't mean you abandon all the others that",
    "start": "2921280",
    "end": "2927200"
  },
  {
    "text": "have served you well here's some references hogwash",
    "start": "2927200",
    "end": "2932520"
  },
  {
    "text": "sourceforge.net is is where you can get",
    "start": "2932520",
    "end": "2937640"
  },
  {
    "text": "hogwash uh the second URL is where I have a tarball of of the latest stuff",
    "start": "2937640",
    "end": "2943920"
  },
  {
    "text": "we've been playing with it the whole conference I've been Lance has been running it on his virtual honey net",
    "start": "2943920",
    "end": "2949520"
  },
  {
    "text": "stuff um you have two Rick and uh a couple",
    "start": "2949520",
    "end": "2956040"
  },
  {
    "text": "other people are playing with it here so if you want to wander by the honey net desk we have it in action there I'm going to do a quick demonstration since",
    "start": "2956040",
    "end": "2961960"
  },
  {
    "text": "we have a few minutes left of some of the some of the basic functionality I have a I have an article up on security",
    "start": "2961960",
    "end": "2968000"
  },
  {
    "text": "Focus about about how we used hogwash to secure an old I3 system that had a bunch",
    "start": "2968000",
    "end": "2974839"
  },
  {
    "text": "of uh had some vulnerabilities that Microsoft was refusing to patch they",
    "start": "2974839",
    "end": "2980160"
  },
  {
    "text": "told us to upgrade to I4 uh upgrading ISS 4 wasn't an option",
    "start": "2980160",
    "end": "2985799"
  },
  {
    "text": "because the the application that was running that web server was written with a whole bunch of is sappi that was",
    "start": "2985799",
    "end": "2991160"
  },
  {
    "text": "unique to I3 and there was a company depending on that application it was their main source of income so we had to",
    "start": "2991160",
    "end": "2999680"
  },
  {
    "text": "basically protect that machine from getting rooted until uh until they could",
    "start": "2999680",
    "end": "3004720"
  },
  {
    "text": "rewrite the application to a more sane architecture so that's that's that part",
    "start": "3004720",
    "end": "3011720"
  },
  {
    "text": "I'm going to put the mic down for a second and jump out of VMware here and try and demonstrate some hogwash function or some inline snort",
    "start": "3011720",
    "end": "3018079"
  },
  {
    "text": "functionality one [Music]",
    "start": "3018079",
    "end": "3023640"
  },
  {
    "text": "second",
    "start": "3024440",
    "end": "3027440"
  },
  {
    "text": "for okay I have running",
    "start": "3054440",
    "end": "3061640"
  },
  {
    "text": "here we'll stop it real quick I have running here inline",
    "start": "3061640",
    "end": "3068359"
  },
  {
    "text": "snort oh",
    "start": "3068599",
    "end": "3071799"
  },
  {
    "text": "lovely no denied that's looking a little",
    "start": "3074559",
    "end": "3080720"
  },
  {
    "text": "better now I can see it too okay",
    "start": "3080720",
    "end": "3086640"
  },
  {
    "text": "yeah let me see if I can make the font a little bigger so that all you poor people with eyes as bad as mine can see",
    "start": "3086640",
    "end": "3093839"
  },
  {
    "text": "it uh font try huge is that any better are we off the",
    "start": "3093839",
    "end": "3101720"
  },
  {
    "text": "side there I can move Windows around so everyone can",
    "start": "3101720",
    "end": "3106400"
  },
  {
    "text": "see let's nudge them over some that's somewhat better down a bit",
    "start": "3108839",
    "end": "3117359"
  },
  {
    "text": "okay so what you guys see here on uh on your left is how I how I might run",
    "start": "3117480",
    "end": "3124920"
  },
  {
    "text": "snort I've already got I've already got IP tables",
    "start": "3124920",
    "end": "3131720"
  },
  {
    "text": "enabled this is the basic IP tables in the window on the right this is the script that I gave the URL",
    "start": "3132760",
    "end": "3140440"
  },
  {
    "text": "to it's very simple you can see uh I I put a couple modules in I turn on IP",
    "start": "3141240",
    "end": "3149559"
  },
  {
    "text": "forwarding actually that's not the one I want to show you hang on a second",
    "start": "3149559",
    "end": "3154680"
  },
  {
    "text": "here where' it go that one [Music]",
    "start": "3158160",
    "end": "3169199"
  },
  {
    "text": "that's well this last part's the relevant part you can see right here where where I'm turning on",
    "start": "3169520",
    "end": "3178240"
  },
  {
    "text": "queuing and you can see I I set all my other firewall policies basically to just default let stuff in okay",
    "start": "3178240",
    "end": "3188160"
  },
  {
    "text": "that's I'm not sure where I put the other one I'm not sure where I put the one that actually stuck up on snort. org but",
    "start": "3196559",
    "end": "3203559"
  },
  {
    "text": "it's on in here somewhere and I'm just scatter brain to find it right now",
    "start": "3203559",
    "end": "3209440"
  },
  {
    "text": "okay so I'm going to run snort over here it's off and going and you can see going",
    "start": "3209440",
    "end": "3215799"
  },
  {
    "text": "up through it I've got frag 2 running and I've got stream 4 running I've got htdp decode",
    "start": "3215799",
    "end": "3224079"
  },
  {
    "text": "running uh conversation engine that's that's a session engine that that actually makes the port scan that feeds",
    "start": "3224079",
    "end": "3231079"
  },
  {
    "text": "sessions to the port scan detector port scan 2 is running and I've got 12200 snort Ru 12200 snort rules loaded I have",
    "start": "3231079",
    "end": "3239079"
  },
  {
    "text": "it right now it just Echoes crap whenever it sees packets and we're doing great there at",
    "start": "3239079",
    "end": "3246559"
  },
  {
    "text": "seeing packets we can take a look at my rules",
    "start": "3246559",
    "end": "3251640"
  },
  {
    "text": "file real quick if that's going to interest",
    "start": "3251640",
    "end": "3255440"
  },
  {
    "text": "you and this is just the default snort rules file and I've just you can see I've got my home net",
    "start": "3258040",
    "end": "3264920"
  },
  {
    "text": "set set right",
    "start": "3264920",
    "end": "3268640"
  },
  {
    "text": "here which is my IP address um going down I defined external",
    "start": "3269960",
    "end": "3276440"
  },
  {
    "text": "net to be anybody and I I set a bunch of these other variables just to make sure all",
    "start": "3276440",
    "end": "3282680"
  },
  {
    "text": "the rules were happy set my rule path right oops right here so I can find the rest",
    "start": "3282680",
    "end": "3289440"
  },
  {
    "text": "of rules file some other junk uh frag two should be on we saw",
    "start": "3289440",
    "end": "3296720"
  },
  {
    "text": "that it's right there so you can see this is normal snort",
    "start": "3296720",
    "end": "3303318"
  },
  {
    "text": "configuration stream 4 is on right here HTP decoding is",
    "start": "3303480",
    "end": "3312079"
  },
  {
    "text": "on the back back orifice detector on now I haven't gone through all the",
    "start": "3312079",
    "end": "3319359"
  },
  {
    "text": "detectors yet and hook them up so that they'll drop when they detect stuff I'm still in the process of doing that the",
    "start": "3319359",
    "end": "3324720"
  },
  {
    "text": "most important ones are done and and we'll get through the rest of them here shortly uh okay here's port scan 2 I",
    "start": "3324720",
    "end": "3332000"
  },
  {
    "text": "mentioned that you can set up ignoring here's how you set it up to ignore a machine I basically set it up you know",
    "start": "3332000",
    "end": "3338039"
  },
  {
    "text": "to ignore my IP address so that you know when I'm out surfing the web and accessing my email and doing all that",
    "start": "3338039",
    "end": "3344039"
  },
  {
    "text": "other stuff I'm not going to Mark myself as a port scanner because I've made too many connections you know here's where I have",
    "start": "3344039",
    "end": "3350319"
  },
  {
    "text": "it logging full alerts",
    "start": "3350319",
    "end": "3356720"
  },
  {
    "text": "okay and then from there I have all the rules files included now if we look at one of the rules",
    "start": "3356720",
    "end": "3363480"
  },
  {
    "text": "files",
    "start": "3363480",
    "end": "3366480"
  },
  {
    "text": "um let's see do I have scanned on you can see I've just taken actually we just",
    "start": "3369400",
    "end": "3375440"
  },
  {
    "text": "use a little said script to do this because I was I'm being really honory about it and enabling all the rules I",
    "start": "3375440",
    "end": "3380839"
  },
  {
    "text": "just took a little said script that took all the alerts and rewrote them as drops",
    "start": "3380839",
    "end": "3386799"
  },
  {
    "text": "so there's a bunch you can see all these rules are drop rules so it's ready to drop all kinds of garbage is anybody",
    "start": "3386799",
    "end": "3392599"
  },
  {
    "text": "else on the wireless network here um okay hang on a",
    "start": "3392599",
    "end": "3399160"
  },
  {
    "text": "second well we're going to check the log files here in a moment yeah well Hang on we're going to",
    "start": "3407839",
    "end": "3414480"
  },
  {
    "text": "do that here in a",
    "start": "3414480",
    "end": "3417119"
  },
  {
    "text": "second let's watch log files okay oops actually helps if you tell why they want",
    "start": "3419520",
    "end": "3425440"
  },
  {
    "text": "to tail hey somebody Port scann me when was that 1833 yeah okay um",
    "start": "3425440",
    "end": "3435240"
  },
  {
    "text": "and okay on the left hand screen we're watching the alert file you know so if",
    "start": "3439359",
    "end": "3445319"
  },
  {
    "text": "something happens that that snort detects we'll see on the leftand screen",
    "start": "3445319",
    "end": "3451400"
  },
  {
    "text": "an alert generated on the right hand screen we're we're monitoring the scan log and what it does is if a port scan's",
    "start": "3451400",
    "end": "3458720"
  },
  {
    "text": "detected every subsequent packet that happens we'll we'll we'll put some statistics of of what we saw happen in",
    "start": "3458720",
    "end": "3466079"
  },
  {
    "text": "that file and that just kind of gives us a way to see what the port scanner was actually trying to to to touch as he was",
    "start": "3466079",
    "end": "3471599"
  },
  {
    "text": "Port scanning you like those Bo oh yeah oh this is a different yeah let",
    "start": "3471599",
    "end": "3478200"
  },
  {
    "text": "me do that here he wanted me to make the fonts larger like",
    "start": "3478200",
    "end": "3484839"
  },
  {
    "text": "that I wonder do you think white on black would look any black on white would look",
    "start": "3484839",
    "end": "3491720"
  },
  {
    "text": "better is this good okay um my IP address is uh let's see",
    "start": "3492359",
    "end": "3499960"
  },
  {
    "text": "here it's not there okay",
    "start": "3499960",
    "end": "3506720"
  },
  {
    "text": "[Music] okay there I am 17216 2.88 someone get ready to port",
    "start": "3509720",
    "end": "3516839"
  },
  {
    "text": "scan me and I'll tell you to go and we can watch the uh we can see what happens have I got a taker somewhere you",
    "start": "3516839",
    "end": "3523079"
  },
  {
    "text": "don't even have to stick your hand up but okay okay 17216 2.88 and we'll watch the log files",
    "start": "3523079",
    "end": "3530440"
  },
  {
    "text": "here oh we're going okay so on the left we see the alerts",
    "start": "3530440",
    "end": "3536880"
  },
  {
    "text": "generating and that stuff's all getting dropped and on the right you can see me",
    "start": "3536880",
    "end": "3543680"
  },
  {
    "text": "logging all the packets as are coming in and those packets should all be getting",
    "start": "3543680",
    "end": "3550720"
  },
  {
    "text": "dropped getting anything back",
    "start": "3553920",
    "end": "3560680"
  },
  {
    "text": "okay you're running nesus great so he's running nessus it's",
    "start": "3561640",
    "end": "3569079"
  },
  {
    "text": "17216",
    "start": "3569079",
    "end": "3572079"
  },
  {
    "text": "2.88 okay let me make sure that my uh let make sure everything's running",
    "start": "3574160",
    "end": "3579400"
  },
  {
    "text": "here you are getting some uh SSH and",
    "start": "3579400",
    "end": "3584640"
  },
  {
    "text": "ldap yeah let's make sure",
    "start": "3584640",
    "end": "3590960"
  },
  {
    "text": "that yeah let's see",
    "start": "3592839",
    "end": "3596640"
  },
  {
    "text": "2.88 it's actually you can see my IP address right there it's",
    "start": "3600280",
    "end": "3606599"
  },
  {
    "text": "highlighted I need to figure out if I make sure I'm running the right rules file",
    "start": "3608000",
    "end": "3613839"
  },
  {
    "text": "here I'm seeing we're seeing a lot of traffic how's how's nessus",
    "start": "3613839",
    "end": "3620720"
  },
  {
    "text": "doing yeah typical has anyone tried end map against me yet",
    "start": "3622760",
    "end": "3628760"
  },
  {
    "text": "is that what you did did you do end map",
    "start": "3628760",
    "end": "3636119"
  },
  {
    "text": "okay let's see we're I take a year.",
    "start": "3639680",
    "end": "3647240"
  },
  {
    "text": "74 who's 239 are you 239 over there",
    "start": "3650520",
    "end": "3656520"
  },
  {
    "text": "you may not want to see what your IP address is I don't know how friendly the crowd is",
    "start": "3658280",
    "end": "3663440"
  },
  {
    "text": "here there you are so you think you're getting some",
    "start": "3669799",
    "end": "3676720"
  },
  {
    "text": "results back huh no now one of the things one of the",
    "start": "3676720",
    "end": "3684799"
  },
  {
    "text": "things I've noticed and we've been playing with this sum a lot of scanners get confused because I'm dropping the",
    "start": "3684799",
    "end": "3690240"
  },
  {
    "text": "packets so I'm not sending resets and they'll retry and and in fact I've had a",
    "start": "3690240",
    "end": "3695480"
  },
  {
    "text": "couple people try to end map end map me using a full connects and it actually",
    "start": "3695480",
    "end": "3700599"
  },
  {
    "text": "will starve their system resources and make a crash because it doesn't reset any of",
    "start": "3700599",
    "end": "3707160"
  },
  {
    "text": "the connections you getting anywhere yet say",
    "start": "3707160",
    "end": "3714599"
  },
  {
    "text": "Port no open ports yeah yeah it should be very effective at dropping this sort of",
    "start": "3714599",
    "end": "3721359"
  },
  {
    "text": "traffic again I'll probably I'll if you if any you guys if if any of you are more interested in seeing this stuff in",
    "start": "3723079",
    "end": "3729440"
  },
  {
    "text": "action or asking more questions I'll probably be over at the honey net Booth most of tomorrow I'll be at black hat or",
    "start": "3729440",
    "end": "3736359"
  },
  {
    "text": "at Defcon a lot of the time probably sitting on the capture the flag Network somewhere just watching people pick on",
    "start": "3736359",
    "end": "3742079"
  },
  {
    "text": "it and uh we'll see if anyone finds the way through",
    "start": "3742079",
    "end": "3747119"
  },
  {
    "text": "yeah it should perform just as well snort does on a high volume Network you",
    "start": "3749680",
    "end": "3754720"
  },
  {
    "text": "know the main question IP tables is known to perform extremely well at high volumes and uh snort is generally",
    "start": "3754720",
    "end": "3761720"
  },
  {
    "text": "considered good to at least a couple hundred megabits and some of the some of the",
    "start": "3761720",
    "end": "3767760"
  },
  {
    "text": "more recent snort stuff uh Marty and the Gang have been doing a lot to improve the performance and I think that on the",
    "start": "3767760",
    "end": "3773880"
  },
  {
    "text": "right kind of system you're good for for close to a gigabit",
    "start": "3773880",
    "end": "3778839"
  },
  {
    "text": "now yeah rules the more rules you have the the more your performance is going",
    "start": "3784680",
    "end": "3790000"
  },
  {
    "text": "to hurt now my configuration here is probably really extreme I would not because I've just I've got a whole bunch",
    "start": "3790000",
    "end": "3795520"
  },
  {
    "text": "of the rules turned on a lot of those rules are known for not being particularly accurate Etc so the rule",
    "start": "3795520",
    "end": "3802079"
  },
  {
    "text": "set I'm running a more reasonable are typical rule set on hogwash was two to",
    "start": "3802079",
    "end": "3807680"
  },
  {
    "text": "500 rules the rule sets are usually quite small because there's not that many rules that are are extremely",
    "start": "3807680",
    "end": "3813079"
  },
  {
    "text": "accurate a lot of the rules in snort are more informational than they are actually they are actually detecting",
    "start": "3813079",
    "end": "3821200"
  },
  {
    "text": "real problems",
    "start": "3821200",
    "end": "3827760"
  },
  {
    "text": "what's the question is what sort of latency do we see I haven't tested it yet this I honestly got a bunch of this",
    "start": "3829440",
    "end": "3836079"
  },
  {
    "text": "stuff working just the day or two before I came here kind of",
    "start": "3836079",
    "end": "3842400"
  },
  {
    "text": "configuration G I can't really his question is what sort of configuration are you talking",
    "start": "3842400",
    "end": "3848680"
  },
  {
    "text": "about for gigabit I can't really answer that too well the place to ask would be on the snort users list or or ask the",
    "start": "3848680",
    "end": "3855559"
  },
  {
    "text": "snort developers list or or even call Source fire or someone like that and talk to them about it uh I I've never I",
    "start": "3855559",
    "end": "3862279"
  },
  {
    "text": "don't have any personal experience with it well I think we're we're pretty pretty",
    "start": "3862279",
    "end": "3867440"
  },
  {
    "text": "close to out of time let's try and get any L questions in I mean actually got some responses could",
    "start": "3867440",
    "end": "3873480"
  },
  {
    "text": "it be that he got the first 20 packets yes it's in now if especially if you're",
    "start": "3873480",
    "end": "3879359"
  },
  {
    "text": "using a targeted Port scanner his question was perhaps he got the first 20 packets that's true if you write a port",
    "start": "3879359",
    "end": "3887038"
  },
  {
    "text": "scanner it detected Neds interesting",
    "start": "3889079",
    "end": "3894839"
  },
  {
    "text": "uh Nessa says HTTP nids evasion stuff detected something like that so it figured out there's some sort of nids in",
    "start": "3894839",
    "end": "3901079"
  },
  {
    "text": "the way there um I'm not sure exactly what it saw I'll have to look at nessus and see what that's doing uh you made a",
    "start": "3901079",
    "end": "3908079"
  },
  {
    "text": "very valid point you could write a custom port scan detector",
    "start": "3908079",
    "end": "3913680"
  },
  {
    "text": "where if you're targeting I mean there's always a way around this sort of stuff if you wrot a port scan detector that",
    "start": "3913680",
    "end": "3918960"
  },
  {
    "text": "hits up front immediately 10 packets you know the 10 ports you're most interested in and you fire it boom you hit someone",
    "start": "3918960",
    "end": "3926559"
  },
  {
    "text": "you wait 60 seconds boom you hit the next guy boom you're going to circumvent it you know until",
    "start": "3926559",
    "end": "3931960"
  },
  {
    "text": "it until you know until uh until I notice in some other way you're doing it",
    "start": "3931960",
    "end": "3937119"
  },
  {
    "text": "and tighten my constraints or or just you know there's there's always other ways",
    "start": "3937119",
    "end": "3943279"
  },
  {
    "text": "it's it's a constant War when you're doing this stuff you know someone will come up a away to circumvent all this and we'll come up with ways to break",
    "start": "3943279",
    "end": "3948880"
  },
  {
    "text": "their circumvention and goes back and forth it keeps it interesting I've also",
    "start": "3948880",
    "end": "3956078"
  },
  {
    "text": "yeah in fact um when I've used nmap against this myself it might take it upwards to 40 40 minutes to an hour to",
    "start": "3958720",
    "end": "3965319"
  },
  {
    "text": "complete and then I'll get a dozen ports that I know aren't open back so that's really that's not at all unusual and are",
    "start": "3965319",
    "end": "3971160"
  },
  {
    "text": "you you're using Windows based scan you say f- scan yeah yeah it's not very accurate a lot of times I I don't know I",
    "start": "3971160",
    "end": "3977880"
  },
  {
    "text": "don't know what's going on in there I've not I've never had very good luck with any of the windows based scanners except",
    "start": "3977880",
    "end": "3984440"
  },
  {
    "text": "getting blue screens but I don't use I I don't use Windows much either what's that that's",
    "start": "3984440",
    "end": "3990960"
  },
  {
    "text": "probably a feature yes yes well thank you everyone for coming I I hope this was",
    "start": "3990960",
    "end": "3997880"
  },
  {
    "text": "useful let's go get some free",
    "start": "3999880",
    "end": "4003798"
  },
  {
    "text": "beer",
    "start": "4013000",
    "end": "4016000"
  }
]