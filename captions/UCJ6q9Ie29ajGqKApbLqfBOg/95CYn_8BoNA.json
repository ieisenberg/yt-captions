[
  {
    "text": "so we're going to start off here uh just real quick my background two second slide I work in trustwave spider Labs",
    "start": "80",
    "end": "6839"
  },
  {
    "text": "I'm the mod security project leader uh some other organizations I work with and Shameless plug for my upcoming book we",
    "start": "6839",
    "end": "13240"
  },
  {
    "text": "have web application Defender cookbook coming out later this year great and my",
    "start": "13240",
    "end": "18840"
  },
  {
    "text": "name is Greg veski and I'm a a certified ethical hacker and uh I work for",
    "start": "18840",
    "end": "26710"
  },
  {
    "text": "[Music] Microsoft and uh uh I work at Microsoft security",
    "start": "26710",
    "end": "34640"
  },
  {
    "text": "Response Center and uh I do different kind of security",
    "start": "34640",
    "end": "41320"
  },
  {
    "text": "research all right so real quick before we jump into mod security and the new um versions that we have we just wanted to",
    "start": "41600",
    "end": "48360"
  },
  {
    "text": "make sure everybody was on the same page as far as why do you need something like mod security right what is it useful for",
    "start": "48360",
    "end": "55280"
  },
  {
    "text": "um so looking at web- based vulnerabilities that's one of the things we do on trustway spider Labs uh we do web assessments pen tests code reviews",
    "start": "55280",
    "end": "61879"
  },
  {
    "text": "we find vulnerabilities so once your organization knows you have vulnerabilities in your web apps what",
    "start": "61879",
    "end": "67200"
  },
  {
    "text": "are you going to do about it so then you shift to remediation hopefully you have access to source code developers and all",
    "start": "67200",
    "end": "73159"
  },
  {
    "text": "that stuff and you can fix it in the code it's the way you should do it um however we're finding there's a lot of different scenarios where depending on",
    "start": "73159",
    "end": "79720"
  },
  {
    "text": "the application you may be have some constraints and you can't actually do that um so we actually took a survey",
    "start": "79720",
    "end": "85840"
  },
  {
    "text": "this was through OAS to figure out people that are using virtual patching that we'll talk about here in a second",
    "start": "85840",
    "end": "91520"
  },
  {
    "text": "um why are you using that and these are some different responses for again it depends on the application but why you",
    "start": "91520",
    "end": "97399"
  },
  {
    "text": "can't actually go in and fix the code so for some reasons it could be it's third party Outsource code you know it's a",
    "start": "97399",
    "end": "102960"
  },
  {
    "text": "black box essentially or your developers have moved on to another project so you actually don't have them to fix it you'd",
    "start": "102960",
    "end": "108920"
  },
  {
    "text": "have to reallocate them also contractual language is a big problem where you know",
    "start": "108920",
    "end": "114079"
  },
  {
    "text": "the outsourc code they were contracted to fix the vulnerability or to write the code according to the specific",
    "start": "114079",
    "end": "120520"
  },
  {
    "text": "if you find security defects that really wasn't covered so look looking at this slide if",
    "start": "120520",
    "end": "127320"
  },
  {
    "text": "you're following the dots right you have these vulnerabilities you can't fix them in the code what do you think is going",
    "start": "127320",
    "end": "132360"
  },
  {
    "text": "to happen that means you're going to get uh hacked right so this is another project that we run at the web",
    "start": "132360",
    "end": "138440"
  },
  {
    "text": "application security Consortium wasque uh called the web hacking incident database where we track real world web",
    "start": "138440",
    "end": "144560"
  },
  {
    "text": "compromises so we're not looking at vulnerabilities we're seeing at the end goal which is an application did",
    "start": "144560",
    "end": "149959"
  },
  {
    "text": "actually get hacked and then how did they do it so this is just a real highlevel view of putting it into two",
    "start": "149959",
    "end": "155160"
  },
  {
    "text": "different categories why are people hacking these applications to begin with so on the left side you have profit",
    "start": "155160",
    "end": "160280"
  },
  {
    "text": "driven hackers you know they're looking to make money of course the right side is activism so just tying those all",
    "start": "160280",
    "end": "166000"
  },
  {
    "text": "together I know this is the turbo talk view so we're running through it quick but obviously you got to fix these vulnerabilities",
    "start": "166000",
    "end": "172599"
  },
  {
    "text": "somehow so that moves into why mod security why is it such a popular tool",
    "start": "172599",
    "end": "178280"
  },
  {
    "text": "um so really this is is a a key point that we want to bring up specifically for this talk and also for why trustwave",
    "start": "178280",
    "end": "184400"
  },
  {
    "text": "and Microsoft msrc joined together for this this project and that is virtual",
    "start": "184400",
    "end": "189560"
  },
  {
    "text": "patching as a process okay virtual patching is different it's not quote unquote wff right where you're buying an",
    "start": "189560",
    "end": "195799"
  },
  {
    "text": "appliance or a box and it does a lot of things automatically virtual patching this is a definition we have uh that we",
    "start": "195799",
    "end": "201400"
  },
  {
    "text": "created from oasp so the key point is here is that you have to know about a vulnerability that's where it starts",
    "start": "201400",
    "end": "207680"
  },
  {
    "text": "then you figure out how to go back and do some remediation efforts okay so mod security why is it",
    "start": "207680",
    "end": "213519"
  },
  {
    "text": "such a great tool for this um uh it's been around for a decade now right it's it's well tested uh protecting millions",
    "start": "213519",
    "end": "220480"
  },
  {
    "text": "of websites we really don't have a lot of metrics on the actual number of installs that's kind of hard for us to track we can track source code downloads",
    "start": "220480",
    "end": "228159"
  },
  {
    "text": "uh and you can see there we've had over 275,000 downloads of the source code um lots of good uh feature set which comes",
    "start": "228159",
    "end": "235159"
  },
  {
    "text": "in real Handy for doing virtual patches that we'll show and also the licensing being open source ASL",
    "start": "235159",
    "end": "241319"
  },
  {
    "text": "V2 all right so uh you know probably you know you have seen why Apache is is so",
    "start": "241319",
    "end": "248079"
  },
  {
    "text": "good and uh uh but the problem was that Apache was good uh the mode security was",
    "start": "248079",
    "end": "254040"
  },
  {
    "text": "good uh on Apache so but what about the other platforms and the most recent",
    "start": "254040",
    "end": "259359"
  },
  {
    "text": "statistics show that Apache covers maybe about 60% uh of the servers uh and and",
    "start": "259359",
    "end": "266600"
  },
  {
    "text": "even less domains that are served out there uh so what about what about the rest and that's why we we thought that",
    "start": "266600",
    "end": "273479"
  },
  {
    "text": "it would be great idea to bring mod security to IIs and and next because uh",
    "start": "273479",
    "end": "279919"
  },
  {
    "text": "with that coverage we would be able to cover more than 90% of of the internet",
    "start": "279919",
    "end": "285400"
  },
  {
    "text": "uh and uh and there are many advantages of this approach the one one which is",
    "start": "285400",
    "end": "290560"
  },
  {
    "text": "kind of obvious is that you could use a a single protection layer in the form of",
    "start": "290560",
    "end": "296919"
  },
  {
    "text": "of mod security configuration files uh to your entire data center or uh entire",
    "start": "296919",
    "end": "302880"
  },
  {
    "text": "web Farm uh covering all the servers that you have and although you know the",
    "start": "302880",
    "end": "308440"
  },
  {
    "text": "the the way you include the uh because the platforms are very different so the way you include the configuration file",
    "start": "308440",
    "end": "314479"
  },
  {
    "text": "is different the configuration itself the protection logic that you define it's one and the same uh so on IIs the",
    "start": "314479",
    "end": "322520"
  },
  {
    "text": "the the mod security experience is slightly different than on apachi uh you start with a typical uh Windows install",
    "start": "322520",
    "end": "330039"
  },
  {
    "text": "you install it on on the Windows server and then after installation you",
    "start": "330039",
    "end": "335280"
  },
  {
    "text": "have to add it to your uh to your configuration file uh and usually it's",
    "start": "335280",
    "end": "341440"
  },
  {
    "text": "much bigger than on this example uh and uh then you recycle the the application",
    "start": "341440",
    "end": "348120"
  },
  {
    "text": "pool and then you have it running and you see in the in the Windows Server event log that that the M mod security",
    "start": "348120",
    "end": "354240"
  },
  {
    "text": "was loaded uh on engine X it's yet another experience because like I said",
    "start": "354240",
    "end": "359720"
  },
  {
    "text": "the the platforms are very different um so you have to compile uh compile mode security into a",
    "start": "359720",
    "end": "367880"
  },
  {
    "text": "library and then engx does not does not let uh modules being loaded during",
    "start": "367880",
    "end": "373720"
  },
  {
    "text": "runtime so you have to compile your own engine X binary with Mod security and",
    "start": "373720",
    "end": "378919"
  },
  {
    "text": "then you are ready to go uh once you add the mod security configuration file in",
    "start": "378919",
    "end": "384160"
  },
  {
    "text": "your engine X config file uh you you will see in the engine X log that that",
    "start": "384160",
    "end": "389800"
  },
  {
    "text": "the module was loaded and it's ready to go uh so so Ryan mentioned about uh why",
    "start": "389800",
    "end": "396240"
  },
  {
    "text": "are we doing this and about the virtual patching so uh how we have a few two",
    "start": "396240",
    "end": "402199"
  },
  {
    "text": "examples of how how the virtual patching with Mod security can be used on",
    "start": "402199",
    "end": "407720"
  },
  {
    "text": "IIs and the first example is a vulnerability from December 2011 and it",
    "start": "407720",
    "end": "413919"
  },
  {
    "text": "was a collision in um in hash table uh in asp.net",
    "start": "413919",
    "end": "420240"
  },
  {
    "text": "uh component of the server and uh with just a 1 Megabyte big",
    "start": "420240",
    "end": "425599"
  },
  {
    "text": "payload sent to the server and ataker could could uh make uh 30,000 cores uh",
    "start": "425599",
    "end": "432840"
  },
  {
    "text": "busy using 1 GB of of bandwidth and uh that was leading to a",
    "start": "432840",
    "end": "439199"
  },
  {
    "text": "to a serious denial of service condition uh so uh normally this this this this was",
    "start": "439199",
    "end": "447800"
  },
  {
    "text": "this was fixed in a kind of in a in an emergency mode because because the vulnerability was serious uh but uh",
    "start": "447800",
    "end": "456759"
  },
  {
    "text": "without the fix you could you could using mod security you could protect yourself uh using using uh different",
    "start": "456759",
    "end": "463240"
  },
  {
    "text": "types of mitigations and here are the for examples and uh the mod security had uh",
    "start": "463240",
    "end": "470479"
  },
  {
    "text": "rules created for all four of them so here I have example of uh one of",
    "start": "470479",
    "end": "477000"
  },
  {
    "text": "the rule it's a it's a rule that detects repetitive payload in IIs requests uh",
    "start": "477000",
    "end": "483879"
  },
  {
    "text": "it's very complicated it's uh it would be difficult to implement in uh in other",
    "start": "483879",
    "end": "489840"
  },
  {
    "text": "like simple simple scanning tools and when the rule is added to the",
    "start": "489840",
    "end": "495000"
  },
  {
    "text": "configuration file and the the proof of concept attack that was published is launched the the uh the the page access",
    "start": "495000",
    "end": "503840"
  },
  {
    "text": "is blocked with access denied and this this kind of event lock is uh is locked",
    "start": "503840",
    "end": "509080"
  },
  {
    "text": "in the in the Windows Server event Lo",
    "start": "509080",
    "end": "514159"
  },
  {
    "text": "um so the second example is a cross side scripting vulnerability that was patched",
    "start": "514159",
    "end": "520479"
  },
  {
    "text": "in July and it's it's a typical reflected cross-side scripting where uh under in",
    "start": "520479",
    "end": "527279"
  },
  {
    "text": "certain uh circumstances attacker could could just put a script in the sections",
    "start": "527279",
    "end": "534240"
  },
  {
    "text": "parameter of of the of the URL and uh it was very bad it was it was",
    "start": "534240",
    "end": "540959"
  },
  {
    "text": "one of the most critical web security vulnerabilities that can be because the",
    "start": "540959",
    "end": "546440"
  },
  {
    "text": "attacker could run the the code in the in the context of the user on the server",
    "start": "546440",
    "end": "552200"
  },
  {
    "text": "and just still do everything that the user can do and and more so like still all the documents and and everything",
    "start": "552200",
    "end": "557920"
  },
  {
    "text": "else and that's obviously is very bad um but fortunately uh there is a way",
    "start": "557920",
    "end": "565519"
  },
  {
    "text": "with m security there was a way um as opposed to the the previous",
    "start": "565519",
    "end": "570920"
  },
  {
    "text": "rules that we showed for the hash dos which is a little bit more non-traditional from a virtual patching",
    "start": "570920",
    "end": "576079"
  },
  {
    "text": "perspective if you want to take more of a traditional input validation right injection context uh two different",
    "start": "576079",
    "end": "582399"
  },
  {
    "text": "approaches right you have blacklisting approach which is looking for what's bad what should not be there so you can do",
    "start": "582399",
    "end": "589000"
  },
  {
    "text": "that if you know in the sections parameter like what what's the payload supposed to be in the first place or in this case knowing if you're doing cross-",
    "start": "589000",
    "end": "595399"
  },
  {
    "text": "site scripting okay the angle you know greater than less than tick mark Mar certain the parentheses look for those",
    "start": "595399",
    "end": "601680"
  },
  {
    "text": "things that shouldn't be there so in the blacklisting approach that's what we're doing up here at the top essentially I",
    "start": "601680",
    "end": "606800"
  },
  {
    "text": "don't know if this is going to work if you can see my cursor here right so we want to look for that specific uh URL",
    "start": "606800",
    "end": "612519"
  },
  {
    "text": "and then we're looking only in the sections parameter and then in this case we're using a fast pattern match so it's",
    "start": "612519",
    "end": "617800"
  },
  {
    "text": "not a regular expression just says if you see any of those meta characters in there at all that's a match so you can",
    "start": "617800",
    "end": "623720"
  },
  {
    "text": "go that route blacklisting approach now it's not quite as strong as you'd like it to be from an input validation perspective ideally you do want to know",
    "start": "623720",
    "end": "631320"
  },
  {
    "text": "what is sections parameter supposed to have like is it supposed to be digits what's it supposed to be so that's",
    "start": "631320",
    "end": "636839"
  },
  {
    "text": "optionally down here the Whit listing approach the beginning is exactly the same you're looking in the same",
    "start": "636839",
    "end": "642160"
  },
  {
    "text": "injection point but then down here uh if you've never really looked at mod security rules or looked at them that",
    "start": "642160",
    "end": "647399"
  },
  {
    "text": "much um here we are doing a regular expression we do some anchoring to make sure that it only contains uh you know",
    "start": "647399",
    "end": "654200"
  },
  {
    "text": "word characters so alpha numeric I think like underscore things like that now the reason why this is a whitelisting",
    "start": "654200",
    "end": "660920"
  },
  {
    "text": "approach is with the mod security syntax if you put the exclamation point at the beginning that mean that inverts the",
    "start": "660920",
    "end": "666720"
  },
  {
    "text": "logic so what you want to do in regular expression is Define what should have been there in the code in the first",
    "start": "666720",
    "end": "672320"
  },
  {
    "text": "place right what the developer should have been doing and in this case you just say if it's not this that's a problem",
    "start": "672320",
    "end": "679959"
  },
  {
    "text": "okay uh so typical event log now so you can see all that stuff funnels there so you can get all your events and see",
    "start": "680639",
    "end": "686240"
  },
  {
    "text": "which stuff is triggered Okay so uh mod security",
    "start": "686240",
    "end": "691800"
  },
  {
    "text": "2.7.0 uh we have release candidate version two out right now so we've been testing certain things with it um in mod",
    "start": "691800",
    "end": "698680"
  },
  {
    "text": "security like the core itself but then also with these new versions for I and engine X so 2.7.0 is the first",
    "start": "698680",
    "end": "705519"
  },
  {
    "text": "multiplatform uh supported version that we have uh you can go download it today if",
    "start": "705519",
    "end": "711600"
  },
  {
    "text": "you go out it's currently hosted on our source Forge uh repository uh so the top URL is where you get to the regular bot",
    "start": "711600",
    "end": "718079"
  },
  {
    "text": "Security Source Code if if you're only an IIs user and you just want to grab the MSI and install it got the link down",
    "start": "718079",
    "end": "724360"
  },
  {
    "text": "there at the bottom you can do that turn it back to great and uh from the Microsoft",
    "start": "724360",
    "end": "731880"
  },
  {
    "text": "perspective we uh we expect to to use mod Security in the our uh response",
    "start": "731880",
    "end": "737760"
  },
  {
    "text": "process uh as you can imagine the the the the uh availability of mod security",
    "start": "737760",
    "end": "744000"
  },
  {
    "text": "for IIs give us possibility to to publish uh rules that would that would",
    "start": "744000",
    "end": "751199"
  },
  {
    "text": "let let our customers be uh protected from any vulnerabilities that are being uh either uh disclosed to us or",
    "start": "751199",
    "end": "760040"
  },
  {
    "text": "disclosed publicly and we also expect that uh the community work will will",
    "start": "760040",
    "end": "767320"
  },
  {
    "text": "start on creating uh the rules that will be specific to to ASP asp.net and IIs",
    "start": "767320",
    "end": "776120"
  },
  {
    "text": "environment so so uh summarizing we we have the mod security has entered a new",
    "start": "777800",
    "end": "784079"
  },
  {
    "text": "new uh new stage uh we have uh we have it available on three platforms uh uh we",
    "start": "784079",
    "end": "791880"
  },
  {
    "text": "encourage you to to learn more about this about the effort uh you can even look at the source code it's right now",
    "start": "791880",
    "end": "797480"
  },
  {
    "text": "it's in the experimental Branch uh on the on the source Forge and uh we will publish uh blogs",
    "start": "797480",
    "end": "805720"
  },
  {
    "text": "about the release uh tomorrow and and uh there there a number",
    "start": "805720",
    "end": "810880"
  },
  {
    "text": "of people who contributed to the effort uh so uh you could find some of those",
    "start": "810880",
    "end": "816560"
  },
  {
    "text": "people uh most of those people you can find them here at the black hat uh this",
    "start": "816560",
    "end": "823920"
  },
  {
    "text": "year and we have one more thing coming all right yeah so because this was a turbo talk and obviously we couldn't do",
    "start": "823920",
    "end": "830399"
  },
  {
    "text": "all of the demonstrations that we would have liked to uh fortunately we did get some slots in Arsenal so if you know",
    "start": "830399",
    "end": "836040"
  },
  {
    "text": "where the Arsenal area is at 3:30 today we're going to be there for an hour and also tomorrow at 10:15 so if you do want",
    "start": "836040",
    "end": "842880"
  },
  {
    "text": "to come by see mon security as a whole or want to see some of these different versions stop by Q&A see some more demos",
    "start": "842880",
    "end": "849360"
  },
  {
    "text": "and I think that's it so thank",
    "start": "849360",
    "end": "853160"
  },
  {
    "text": "you uh well good afternoon thank you for coming we are Matias scat and maximan",
    "start": "858880",
    "end": "866079"
  },
  {
    "text": "Sol we are talking about HT exploit and how to bypass the hxis",
    "start": "866079",
    "end": "873279"
  },
  {
    "text": "restrictions come on okay Matias cat see if you want to",
    "start": "873279",
    "end": "882680"
  },
  {
    "text": "introduce yourself go ahead okay Maas is a penetration testing has a company",
    "start": "882680",
    "end": "888160"
  },
  {
    "text": "named mkit Argentina and it's specialized in web",
    "start": "888160",
    "end": "893240"
  },
  {
    "text": "application security also do pation Tes me I I live in Buenos I work for a",
    "start": "893240",
    "end": "901600"
  },
  {
    "text": "bank as security analyzed okay basic concept this is for",
    "start": "901600",
    "end": "907920"
  },
  {
    "text": "introduce everything and everyone to the Bing concept um HT access is protect",
    "start": "907920",
    "end": "915959"
  },
  {
    "text": "access and basically is a confination fight to Wi directives that is to use to",
    "start": "915959",
    "end": "924720"
  },
  {
    "text": "config H directory or F for example you can use the HT axis to",
    "start": "924720",
    "end": "932399"
  },
  {
    "text": "redirection uh urly redirection and directory listing protection you",
    "start": "932399",
    "end": "939120"
  },
  {
    "text": "rewriting and authorization authentication this is the main of this",
    "start": "939120",
    "end": "945519"
  },
  {
    "text": "T okay why attack this type of protected",
    "start": "945519",
    "end": "951120"
  },
  {
    "text": "H director the the the common uh things to",
    "start": "951120",
    "end": "957399"
  },
  {
    "text": "to to get are backups files configurations and update versions H new",
    "start": "957399",
    "end": "965040"
  },
  {
    "text": "developments because some uh we have developers or admin C admin that put all",
    "start": "965040",
    "end": "972800"
  },
  {
    "text": "your backups in this protect H the",
    "start": "972800",
    "end": "978240"
  },
  {
    "text": "director the tool the tool is naming HTT exploit and the meaning is HX a exploit",
    "start": "978639",
    "end": "986920"
  },
  {
    "text": "is a tool right in Python that exploit a weakness in the in the",
    "start": "986920",
    "end": "993720"
  },
  {
    "text": "way that HT axis are configuration I conf um for example you will be able",
    "start": "993720",
    "end": "1000120"
  },
  {
    "text": "with this tool to bypass this authentication",
    "start": "1000120",
    "end": "1005959"
  },
  {
    "text": "process the main features of this tool is free and open source if you want you",
    "start": "1006560",
    "end": "1012440"
  },
  {
    "text": "can collaborate is user friendly flexible has a lot of uh um",
    "start": "1012440",
    "end": "1020440"
  },
  {
    "text": "modalizing is integrating with measure tools in the next version will be integrating with mmat um met",
    "start": "1020440",
    "end": "1029240"
  },
  {
    "text": "exploit uh has a a fny report we",
    "start": "1029240",
    "end": "1036280"
  },
  {
    "text": "building uh this is an old weakness no",
    "start": "1036280",
    "end": "1041839"
  },
  {
    "text": "it's not now it's no new story uh we haven't no not having found currently",
    "start": "1041839",
    "end": "1050080"
  },
  {
    "text": "exploited by other tools a lot of websites um recommending",
    "start": "1050080",
    "end": "1055880"
  },
  {
    "text": "how to implement HT access vulnerable and from fun on",
    "start": "1055880",
    "end": "1063600"
  },
  {
    "text": "profit what is not H HT exploit it's not a one one click page tool it's not a",
    "start": "1063600",
    "end": "1071320"
  },
  {
    "text": "replacement for other web happing tools and it's not completely integrating with",
    "start": "1071320",
    "end": "1076960"
  },
  {
    "text": "other tools",
    "start": "1076960",
    "end": "1080840"
  },
  {
    "text": "okay this is the common configuration for protect H",
    "start": "1082520",
    "end": "1088360"
  },
  {
    "text": "directory have you ever seen this type of configuration yeah",
    "start": "1088360",
    "end": "1094600"
  },
  {
    "text": "okay at the first line This is the HD pass w",
    "start": "1094600",
    "end": "1101200"
  },
  {
    "text": "w out name authentication basic this will be others if you you want could be",
    "start": "1101200",
    "end": "1108520"
  },
  {
    "text": "for example dishes dases um this is the directive limit",
    "start": "1108520",
    "end": "1116120"
  },
  {
    "text": "with get and post go",
    "start": "1116120",
    "end": "1123000"
  },
  {
    "text": "ahead okay we uh have found a lot of University recommend this type of",
    "start": "1124480",
    "end": "1131080"
  },
  {
    "text": "configuration but this type of configuration are vulnerable or has a",
    "start": "1131080",
    "end": "1137600"
  },
  {
    "text": "weakness demo okay hi uh we've been as we've been",
    "start": "1137720",
    "end": "1145360"
  },
  {
    "text": "in Arsenal uh at 10:00 a.m. and people have come around our booth and asked us",
    "start": "1145360",
    "end": "1151840"
  },
  {
    "text": "to show them the demo and we have presented them with this HT access configuration and we have been asking",
    "start": "1151840",
    "end": "1157960"
  },
  {
    "text": "them if they would upload this HT access to their production servers about",
    "start": "1157960",
    "end": "1163960"
  },
  {
    "text": "95% of the people that uh saw this configuration said yes",
    "start": "1163960",
    "end": "1169559"
  },
  {
    "text": "this is very typical configuration for HT access because because it limits the",
    "start": "1169559",
    "end": "1174799"
  },
  {
    "text": "methods available for uh usage of the directory just forget and post so that",
    "start": "1174799",
    "end": "1181039"
  },
  {
    "text": "you won't be able to perform an options or a trace or whatever that's a very common very typical and very chosen",
    "start": "1181039",
    "end": "1188360"
  },
  {
    "text": "configuration for HT access some people said okay maybe I wouldn't use basic I",
    "start": "1188360",
    "end": "1193600"
  },
  {
    "text": "would use digest somebody said I won't use HD passwd because is too standard I would",
    "start": "1193600",
    "end": "1200000"
  },
  {
    "text": "personalize the file that's okay uh some said they would use TLS that's okay too",
    "start": "1200000",
    "end": "1206679"
  },
  {
    "text": "that doesn't matter for this exploit even if you use digest even if you change the the password file even even",
    "start": "1206679",
    "end": "1212760"
  },
  {
    "text": "if you use uh TLS yeah even if you use digest even if it's only one valid user",
    "start": "1212760",
    "end": "1218320"
  },
  {
    "text": "instead of any valid user you would still be vulnerable",
    "start": "1218320",
    "end": "1225480"
  },
  {
    "text": "so uh many of these universities and also uh hosting providers and Cloud",
    "start": "1226280",
    "end": "1232919"
  },
  {
    "text": "providers and companies and our customers and whatever they have all uh",
    "start": "1232919",
    "end": "1238760"
  },
  {
    "text": "recommended this type of HT access this exact type of HT access uh and this is a",
    "start": "1238760",
    "end": "1245799"
  },
  {
    "text": "vulnerable HT access configuration so what stroke us down was that about",
    "start": "1245799",
    "end": "1252840"
  },
  {
    "text": "95% of the websites available online we're recommending users to use this",
    "start": "1252840",
    "end": "1258360"
  },
  {
    "text": "kind of HD access so I would encourage you to go check your servers If You're",
    "start": "1258360",
    "end": "1263520"
  },
  {
    "text": "vulnerable or not after seeing this demo because a h high percentage of you will",
    "start": "1263520",
    "end": "1268840"
  },
  {
    "text": "be Verner vulnerable so let's see the tool I have a server",
    "start": "1268840",
    "end": "1274400"
  },
  {
    "text": "here it has a private directory which is protected of course if I try to access",
    "start": "1274400",
    "end": "1280159"
  },
  {
    "text": "it it would go to the demo of",
    "start": "1280159",
    "end": "1284640"
  },
  {
    "text": "course okay it asks for password this site is",
    "start": "1287520",
    "end": "1292559"
  },
  {
    "text": "is protected by an HT axis with the vulnerable one so we can exploit it so",
    "start": "1292559",
    "end": "1297640"
  },
  {
    "text": "what the tool does is quite",
    "start": "1297640",
    "end": "1301880"
  },
  {
    "text": "simple right",
    "start": "1312559",
    "end": "1319159"
  },
  {
    "text": "there it is tool is quite simple it's written in pythons open source will be publishing open source uh it has many",
    "start": "1319159",
    "end": "1326679"
  },
  {
    "text": "modules to to charart you can use the deck module which is the standards",
    "start": "1326679",
    "end": "1331720"
  },
  {
    "text": "that's what we're going to use uh you can redirect the output to wherever you",
    "start": "1331720",
    "end": "1337440"
  },
  {
    "text": "want but the main uh the main parameter that you need to express is the URL the",
    "start": "1337440",
    "end": "1343000"
  },
  {
    "text": "URL is the only one required that's the URL that you want to exploit so in that in this case we want to exploit the",
    "start": "1343000",
    "end": "1349880"
  },
  {
    "text": "server that I just showed you so we're going to",
    "start": "1349880",
    "end": "1354440"
  },
  {
    "text": "use private and let's set it to veros mode so what the tool will do is try to",
    "start": "1358120",
    "end": "1364840"
  },
  {
    "text": "download index PHP inside the same private directory SL private index PHP",
    "start": "1364840",
    "end": "1373360"
  },
  {
    "text": "so it could download it it what it what the tool is shown is that the directory",
    "start": "1373360",
    "end": "1379360"
  },
  {
    "text": "is exploitable so what the tool can do now is perform what it's called a full",
    "start": "1379360",
    "end": "1384960"
  },
  {
    "text": "scan the full scan will take um a word list that is provided with our tool but",
    "start": "1384960",
    "end": "1392039"
  },
  {
    "text": "you can use your own and bear in mind this is not a dictionary attack on the passwords this is not a password",
    "start": "1392039",
    "end": "1398000"
  },
  {
    "text": "cracking tool the war list is just",
    "start": "1398000",
    "end": "1404520"
  },
  {
    "text": "for files what we have put here in the word list is the typical default uh",
    "start": "1405400",
    "end": "1412840"
  },
  {
    "text": "pages that are available in WordPress jumbla and whatever and that's what we're relying on you can use your own",
    "start": "1412840",
    "end": "1419799"
  },
  {
    "text": "War list and if you have a war list of 2,000 different forms you can use it but that this it's not a password cracking",
    "start": "1419799",
    "end": "1426559"
  },
  {
    "text": "tool several people have told me that during Arsenal it's not that you're bypassing the authentication so if we do",
    "start": "1426559",
    "end": "1434159"
  },
  {
    "text": "that with the full list and it starts the full scan it will try to download each of the",
    "start": "1434159",
    "end": "1441080"
  },
  {
    "text": "files in the war list so we will try to download and at the end it would say",
    "start": "1441080",
    "end": "1447080"
  },
  {
    "text": "that 52 files were downloaded out of 750 with a 60% success",
    "start": "1447080",
    "end": "1452919"
  },
  {
    "text": "rate that means that 52 files from the server from the protected directory",
    "start": "1452919",
    "end": "1459400"
  },
  {
    "text": "server have been downloaded to our computer and now it's locally on our on",
    "start": "1459400",
    "end": "1464720"
  },
  {
    "text": "our server or on our computer but uh the the main functionality of this uh",
    "start": "1464720",
    "end": "1471440"
  },
  {
    "text": "tool is the link scanner module the link scanner module will try to download will download all the files and then read",
    "start": "1471440",
    "end": "1478679"
  },
  {
    "text": "inside of them and search for links and each time you check for link it tries to",
    "start": "1478679",
    "end": "1483880"
  },
  {
    "text": "download that site also from the server so if I run the link detect scan module",
    "start": "1483880",
    "end": "1489799"
  },
  {
    "text": "I will run it and for each one of them it will show all of the links found for",
    "start": "1489799",
    "end": "1496480"
  },
  {
    "text": "instance in article.php we have found 23 links articles. php1 index php1 and that's it and after",
    "start": "1496480",
    "end": "1504600"
  },
  {
    "text": "removing duplicates we find 23 new links found that's without knowing the",
    "start": "1504600",
    "end": "1510840"
  },
  {
    "text": "internal structure of the site that's without using the war list the worldless was was just the first the first step of",
    "start": "1510840",
    "end": "1517200"
  },
  {
    "text": "the of the of the process now the tool is reading from inside the server from",
    "start": "1517200",
    "end": "1522640"
  },
  {
    "text": "inside the the the directory and checking for links and downloading that link those links so so now that the 23",
    "start": "1522640",
    "end": "1530360"
  },
  {
    "text": "links were found you can run a new thread of HT exploit with those new",
    "start": "1530360",
    "end": "1536279"
  },
  {
    "text": "files and download those also by growing horizontally and trying to make the the",
    "start": "1536279",
    "end": "1543440"
  },
  {
    "text": "report the final report bigger so we're going to find we're going to download those",
    "start": "1543440",
    "end": "1549240"
  },
  {
    "text": "files and it check index PHP has been downloaded blah blah blah blah external",
    "start": "1549240",
    "end": "1555240"
  },
  {
    "text": "links are skipped blah blah blah blah blah and there were seven new files",
    "start": "1555240",
    "end": "1560440"
  },
  {
    "text": "downloaded out of 20 and now you can rerun the link detect scan on this new",
    "start": "1560440",
    "end": "1567760"
  },
  {
    "text": "result this is a recursive proced procedure that would end only when you",
    "start": "1567760",
    "end": "1573240"
  },
  {
    "text": "have successfully downloaded each and every file on the server and would recursively try again and try again and",
    "start": "1573240",
    "end": "1580080"
  },
  {
    "text": "download and Le detect and download and Le detect until it's finished so we're going to do yes he's going to download",
    "start": "1580080",
    "end": "1587399"
  },
  {
    "text": "and he the tool found 66 new links so we're going to run a new H hdf Floy",
    "start": "1587399",
    "end": "1594559"
  },
  {
    "text": "thread to download those and now the tool downloaded 59",
    "start": "1594559",
    "end": "1600039"
  },
  {
    "text": "more files and now we're going to run a link de Tex",
    "start": "1600039",
    "end": "1605200"
  },
  {
    "text": "scan now it found 619 new links this per",
    "start": "1605480",
    "end": "1610679"
  },
  {
    "text": "this this uh enables us to to grow the the the size of the report the final",
    "start": "1610679",
    "end": "1617240"
  },
  {
    "text": "report we're going to run a new HT exploit now it full scan completed no",
    "start": "1617240",
    "end": "1623960"
  },
  {
    "text": "new files are downloaded that's means that we have successfully sucked everything from the server and we can go",
    "start": "1623960",
    "end": "1630120"
  },
  {
    "text": "home happy so 115 total files after four iterations and the report the final",
    "start": "1630120",
    "end": "1636880"
  },
  {
    "text": "report is right here so if you open up",
    "start": "1636880",
    "end": "1641200"
  },
  {
    "text": "that open at the report directory and we have a nice HTML report that",
    "start": "1645559",
    "end": "1652159"
  },
  {
    "text": "lists all the files found on the server those are 114",
    "start": "1652159",
    "end": "1658200"
  },
  {
    "text": "files can't say what it says 115 and shows 114 maybe a small bug but if you",
    "start": "1658200",
    "end": "1664880"
  },
  {
    "text": "access these files you can access the actual information chocolate Dalmation and we",
    "start": "1664880",
    "end": "1672240"
  },
  {
    "text": "access that and that's it so what are we looking at right here the the tool the",
    "start": "1672240",
    "end": "1678760"
  },
  {
    "text": "the vulnerability in Apache only allows us to download PHP files it won't download HTML it won't download jpeg it",
    "start": "1678760",
    "end": "1686159"
  },
  {
    "text": "won't download stylesheets it only will download PHP files so you won't get any",
    "start": "1686159",
    "end": "1691519"
  },
  {
    "text": "fancy output but you will get the data which is the most important one the most important part we now have the entire",
    "start": "1691519",
    "end": "1699159"
  },
  {
    "text": "content of the server that if we access it correctly it's nice coffee rocks uh",
    "start": "1699159",
    "end": "1709240"
  },
  {
    "text": "site for maybe a a local business or something and articles you can't all the",
    "start": "1709240",
    "end": "1715240"
  },
  {
    "text": "Articles and then there are all the types of coffee and this is the same information black ey. PHP we're going to",
    "start": "1715240",
    "end": "1722960"
  },
  {
    "text": "look for black ey black ey. PHP and that's exactly the",
    "start": "1722960",
    "end": "1731480"
  },
  {
    "text": "same just without the the graphics and the fonts and the Styles and the",
    "start": "1731480",
    "end": "1736679"
  },
  {
    "text": "whatever but the data is on our computer right here for each",
    "start": "1736679",
    "end": "1742840"
  },
  {
    "text": "downloaded file we get a local copy with all the information we need with a nice",
    "start": "1742840",
    "end": "1750159"
  },
  {
    "text": "full report to show to our customers or",
    "start": "1750159",
    "end": "1755679"
  },
  {
    "text": "whatever well that's it that's the demo that's them that's the",
    "start": "1755679",
    "end": "1761120"
  },
  {
    "text": "demo",
    "start": "1767039",
    "end": "1770039"
  },
  {
    "text": "Shing okay do you hear me yeah",
    "start": "1776440",
    "end": "1781720"
  },
  {
    "text": "okay the winess this is the most important part the problem decid how to",
    "start": "1781720",
    "end": "1787440"
  },
  {
    "text": "the HTTP request are being limited the following statement for example is limit",
    "start": "1787440",
    "end": "1794640"
  },
  {
    "text": "get post require valid user and limit this indicate that only the only applies",
    "start": "1794640",
    "end": "1802440"
  },
  {
    "text": "to get and post method uh what happens we generate another non sard metal for",
    "start": "1802440",
    "end": "1809919"
  },
  {
    "text": "example potato potato potato okay when PHP PHP receives the",
    "start": "1809919",
    "end": "1817240"
  },
  {
    "text": "nonstandard method it's process it like a get downloading the Rus",
    "start": "1817240",
    "end": "1825398"
  },
  {
    "text": "F so the thing is that Apache can handle the",
    "start": "1826600",
    "end": "1832519"
  },
  {
    "text": "methods that you have yeah the method that you have disabled Apache can't handle them so uh",
    "start": "1832519",
    "end": "1840600"
  },
  {
    "text": "but if you use a method that is not common to Apache Apache will pass it along and send it to PHP and say hey PHP",
    "start": "1840600",
    "end": "1848039"
  },
  {
    "text": "maybe you know how to deal with this that's how you bypass a pachy and then when PHP gets the request if pH if",
    "start": "1848039",
    "end": "1856399"
  },
  {
    "text": "PHP gets a request with the method that it doesn't know it treats it like a",
    "start": "1856399",
    "end": "1862639"
  },
  {
    "text": "get so you bypass you bypass the required valid user because you're not",
    "start": "1862639",
    "end": "1869120"
  },
  {
    "text": "using neither get nor post so it doesn't require valid user for those limits so aanch is sensing along directly and then",
    "start": "1869120",
    "end": "1876320"
  },
  {
    "text": "when PHP gets it it treats it like a get and you get the [Music]",
    "start": "1876320",
    "end": "1882970"
  },
  {
    "text": "files Poss Solutions improve the HT access configuration and I model",
    "start": "1883000",
    "end": "1889039"
  },
  {
    "text": "experimental and the PHP code okay from the HT access configuration you will be",
    "start": "1889039",
    "end": "1897000"
  },
  {
    "text": "use um for example the limit get and post and also the limit except get and",
    "start": "1897000",
    "end": "1903720"
  },
  {
    "text": "post the N this H say that the Restriction Access Control to all the HTTP methods except",
    "start": "1903720",
    "end": "1911279"
  },
  {
    "text": "to all ones specific above",
    "start": "1911279",
    "end": "1916480"
  },
  {
    "text": "um if the with the limit except you are also uh disabling anything that is not",
    "start": "1916480",
    "end": "1923600"
  },
  {
    "text": "get post because if it's if it is get and or post you would require a valid user but if it's it's not if it's not",
    "start": "1923600",
    "end": "1930919"
  },
  {
    "text": "neither get nor post it would deny all and that's it that's how you can treat it from the HT AIS",
    "start": "1930919",
    "end": "1939158"
  },
  {
    "text": "itself aach model mode allow methods this is an experimental model um",
    "start": "1940320",
    "end": "1946600"
  },
  {
    "text": "basically restrict only to the HTTP method that can be used on the server it's important to say that is Cas",
    "start": "1946600",
    "end": "1954639"
  },
  {
    "text": "sensitive and was righten to replace the",
    "start": "1954639",
    "end": "1960080"
  },
  {
    "text": "C implementation of a limit and limit except",
    "start": "1960080",
    "end": "1965200"
  },
  {
    "text": "but experimental if you are Developer in",
    "start": "1965200",
    "end": "1971440"
  },
  {
    "text": "your PHP code you will check for example the PHP out user",
    "start": "1971440",
    "end": "1978480"
  },
  {
    "text": "and then you must to check for example server request method and see",
    "start": "1978480",
    "end": "1984880"
  },
  {
    "text": "um if use get or post you will be only",
    "start": "1984880",
    "end": "1990840"
  },
  {
    "text": "Pro um Pro accept the request if you have another one you will say uh you",
    "start": "1990840",
    "end": "1998519"
  },
  {
    "text": "will show a r message that is to prevent the the default fall back from a from PHP you",
    "start": "1998519",
    "end": "2005639"
  },
  {
    "text": "can process it through the to the first through the filters and if PHP detects",
    "start": "2005639",
    "end": "2011399"
  },
  {
    "text": "it's not neither yet nor post it would disallow the the connection okay um and",
    "start": "2011399",
    "end": "2018320"
  },
  {
    "text": "works is not enough to declare the traditional HTTP method you must to",
    "start": "2018320",
    "end": "2026360"
  },
  {
    "text": "restrict the access to to those methods know or wanted um",
    "start": "2026360",
    "end": "2033880"
  },
  {
    "text": "you must to to do the perform necessary Security",
    "start": "2033880",
    "end": "2040240"
  },
  {
    "text": "checks okay what is our gold map uh of course the tool has been written in",
    "start": "2041880",
    "end": "2047320"
  },
  {
    "text": "Python so it's open source uh the tool has already been published now we'll give you the link so you can download it",
    "start": "2047320",
    "end": "2054398"
  },
  {
    "text": "uh it's also uh going to be run on of course anything that runs P python",
    "start": "2054399",
    "end": "2059440"
  },
  {
    "text": "Windows Mac Linux whatever and it's going to be in the next versions of uh Matrix and Samurai you will be able to",
    "start": "2059440",
    "end": "2066520"
  },
  {
    "text": "uh find them the tool there and what is the road map the our next release is",
    "start": "2066520",
    "end": "2071599"
  },
  {
    "text": "going to be the 1.0 which includes the link scanner that we have shown uh during the demo and it will also include",
    "start": "2071599",
    "end": "2078679"
  },
  {
    "text": "the uh remote file inclusion local file Fusion S injection that would be next",
    "start": "2078679",
    "end": "2083760"
  },
  {
    "text": "month on our site now you can download the version that 0.7 it's a beta version",
    "start": "2083760",
    "end": "2090320"
  },
  {
    "text": "that works that works perfectly fine you can download it now and try it on and",
    "start": "2090320",
    "end": "2095358"
  },
  {
    "text": "we're working to integrate the tool with either met mety for gel injection and map for detection of other directories",
    "start": "2095359",
    "end": "2102920"
  },
  {
    "text": "other servers other web services in other ports and doing a more horizontal",
    "start": "2102920",
    "end": "2108800"
  },
  {
    "text": "growth of the tool right now from the root for each directory it does a",
    "start": "2108800",
    "end": "2113920"
  },
  {
    "text": "subdirectory and so on and so forth for each and every file of the directory and",
    "start": "2113920",
    "end": "2119599"
  },
  {
    "text": "uh with the new Integrations on on the newest version we will be able to uh cross it with an nmap result and get",
    "start": "2119599",
    "end": "2126200"
  },
  {
    "text": "different web services from the same IP address and also uh robots. txt",
    "start": "2126200",
    "end": "2132640"
  },
  {
    "text": "detection so it will maybe look more like a pwnage tool so we don't want that",
    "start": "2132640",
    "end": "2139440"
  },
  {
    "text": "but we're working hard not making it look like a ponage tool but it will try to inte we will try to integrate it with",
    "start": "2139440",
    "end": "2145640"
  },
  {
    "text": "enap and metal spoy for gel injection but we will all we already have developed these modules and they're",
    "start": "2145640",
    "end": "2151960"
  },
  {
    "text": "working but the code is still a little bit dirty and patchy so we won't uh publish it for the next month but you",
    "start": "2151960",
    "end": "2158359"
  },
  {
    "text": "can now download um the version 0.7 beta",
    "start": "2158359",
    "end": "2164760"
  },
  {
    "text": "from this URL mk.com Arabs slhd exploit uh you can download",
    "start": "2164760",
    "end": "2172359"
  },
  {
    "text": "it right now it's published before our talk so these are the references from",
    "start": "2172359",
    "end": "2177520"
  },
  {
    "text": "all the research that led to this tool we haven't found any tool that did this",
    "start": "2177520",
    "end": "2183480"
  },
  {
    "text": "before our investigation so we decided to make a new one uh so if you find one",
    "start": "2183480",
    "end": "2188960"
  },
  {
    "text": "maybe you can email us with that tool maybe we can cross reference and see how to improve our tool oh we can stop our",
    "start": "2188960",
    "end": "2195760"
  },
  {
    "text": "investigation Al together because we don't want to reinvent the wheel but uh we haven't found one so these are all",
    "start": "2195760",
    "end": "2201359"
  },
  {
    "text": "the references for the investigation that led to our tool so questions any questions",
    "start": "2201359",
    "end": "2210040"
  },
  {
    "text": "yeah other PHP like ASP or JSP or any",
    "start": "2210040",
    "end": "2216520"
  },
  {
    "text": "other unfortunately it doesn't work the the fallback that allows you to get the",
    "start": "2216520",
    "end": "2221640"
  },
  {
    "text": "files it's a flaw in how PHP is developed but it's not it's not a pat",
    "start": "2221640",
    "end": "2227319"
  },
  {
    "text": "it's not a fault that has a cve that needs a patch you won't see a patch actually this relability is very old",
    "start": "2227319",
    "end": "2234880"
  },
  {
    "text": "it's old old and uh there hasn't been a patch um a patch you can upgrade it to",
    "start": "2234880",
    "end": "2240680"
  },
  {
    "text": "the newest version PHP also it's not it's not a patch requiring uh vulnerability it's a weakness in",
    "start": "2240680",
    "end": "2247119"
  },
  {
    "text": "configur Mis configuration if you go and add limit except to your HT access that's it",
    "start": "2247119",
    "end": "2253599"
  },
  {
    "text": "so anything that uses HT access with PHP is vulnerable not IIs but everything",
    "start": "2253599",
    "end": "2260400"
  },
  {
    "text": "that uses HT access if you have PHP behind yes is",
    "start": "2260400",
    "end": "2267880"
  },
  {
    "text": "this or no it's OS independent if you install a Pache on a Windows Server it",
    "start": "2269359",
    "end": "2275000"
  },
  {
    "text": "will exp exploit it yeah we good we're good okay thank you very",
    "start": "2275000",
    "end": "2281319"
  },
  {
    "text": "much thank you woohoo all",
    "start": "2281319",
    "end": "2287400"
  },
  {
    "text": "right and everyone's eager to go on the next talk so we'll do this fast keep everything on time uh so we're to talk",
    "start": "2287400",
    "end": "2293200"
  },
  {
    "text": "about live injection today and if you're looking to uh follow along you can go to this website the slides are somewhere",
    "start": "2293200",
    "end": "2299240"
  },
  {
    "text": "down there and you check it out okay who am I I'm one of the",
    "start": "2299240",
    "end": "2305599"
  },
  {
    "text": "directors of engineering at Etsy Etsy is a Online Marketplace um my my specialty",
    "start": "2305599",
    "end": "2311839"
  },
  {
    "text": "is sort of Enterprise related features fraud security email infrastructure fun so what I'm going to",
    "start": "2311839",
    "end": "2319280"
  },
  {
    "text": "talk about is a C library which is actually easy to port to other languages and my previous sort of embedded C",
    "start": "2319280",
    "end": "2325079"
  },
  {
    "text": "library is actually used um in just about every ad server in the world it's used in the Chrome browser it's also",
    "start": "2325079",
    "end": "2330839"
  },
  {
    "text": "open source you can check that out as well but just to give you some background on",
    "start": "2330839",
    "end": "2336440"
  },
  {
    "text": "development okay so next 14 minutes we're going to go through like why detecting SQL injections hard uh and why",
    "start": "2336440",
    "end": "2344920"
  },
  {
    "text": "certain other algorithms and methods don't work very well um we're going to talk about the algorithm that is sort of",
    "start": "2344920",
    "end": "2350400"
  },
  {
    "text": "newly developed and produced here and uh the results and then some next steps on how to move forward with it and use it",
    "start": "2350400",
    "end": "2356520"
  },
  {
    "text": "in your application or to develop new tools from it all right so actually turns out",
    "start": "2356520",
    "end": "2362000"
  },
  {
    "text": "detecting SQL injection from user input is a hard problem and the reason is is",
    "start": "2362000",
    "end": "2368359"
  },
  {
    "text": "uh it's really easy to get started with regular Expressions it's like hey it's just a union all thing and I know at",
    "start": "2368359",
    "end": "2374119"
  },
  {
    "text": "least two open source web firewalls use this and seen from the exploits done uh",
    "start": "2374119",
    "end": "2379960"
  },
  {
    "text": "and the workarounds done it looks like a number of the commercial ones do it as well the faults sort of indicate they're",
    "start": "2379960",
    "end": "2385400"
  },
  {
    "text": "not really um they're too trivial that there must be regular Expressions uh so",
    "start": "2385400",
    "end": "2392400"
  },
  {
    "text": "SQL is also huge um if you ever sort of looked at it the actual spec from 92",
    "start": "2392400",
    "end": "2398520"
  },
  {
    "text": "which you can sort of download it's 600 pages of plain text just describing how it works the 2003 spec just the BNF form",
    "start": "2398520",
    "end": "2406800"
  },
  {
    "text": "is 128 Pages um no one does it exact and everyone has like extensions and things",
    "start": "2406800",
    "end": "2413240"
  },
  {
    "text": "uh associated with it it's a really big language it's also Turing complete so",
    "start": "2413240",
    "end": "2418319"
  },
  {
    "text": "basically you can go write web servers just using SQL and things like that just using regular Expressions to capture",
    "start": "2418319",
    "end": "2424480"
  },
  {
    "text": "that richness of a language is is going to be tough and it's actually a lot more complicated",
    "start": "2424480",
    "end": "2429880"
  },
  {
    "text": "than you think uh postgress is got recursive or nested commenting rules um",
    "start": "2429880",
    "end": "2435839"
  },
  {
    "text": "a single number has so many different forms you can't use a single regular expression for it it's really Loosely",
    "start": "2435839",
    "end": "2442319"
  },
  {
    "text": "typed you know there conversions going on all the all over the place and for Strings you think you know you have no",
    "start": "2442319",
    "end": "2449720"
  },
  {
    "text": "idea the exceptions are incredible and I'm going to be talking a lot more of this at Defcon at 4:20 on Friday so if",
    "start": "2449720",
    "end": "2456720"
  },
  {
    "text": "you're interested more sort of analysis of sort of new exploits uh come check it out anyway uh so what happens is um a",
    "start": "2456720",
    "end": "2465800"
  },
  {
    "text": "lot of the web application firewalls have sort of ended up using uh what I call regular expression soup this is",
    "start": "2465800",
    "end": "2471079"
  },
  {
    "text": "actually part of the regular Expressions uh used in uh PHP IDs uh mod security is",
    "start": "2471079",
    "end": "2478200"
  },
  {
    "text": "some similar sort of rules it's impossible to debug and test",
    "start": "2478200",
    "end": "2483440"
  },
  {
    "text": "against um and in fact uh in black hat 2005 um Hansen Patterson had this great",
    "start": "2483440",
    "end": "2491000"
  },
  {
    "text": "article that or theorem actually it said that regular Expressions matter what you do it's going to miss something and",
    "start": "2491000",
    "end": "2497880"
  },
  {
    "text": "something that you don't want is going to be flagged as a false positive and it's a pretty interesting article it's a",
    "start": "2497880",
    "end": "2503359"
  },
  {
    "text": "little technical but worth it's definitely worth checking out and existing web application",
    "start": "2503359",
    "end": "2510000"
  },
  {
    "text": "firewalls just going back to the regx soup uh some of these if I had a pointer I can point out some by inspection if",
    "start": "2510000",
    "end": "2516560"
  },
  {
    "text": "you stare at at long enough you see bugs or things are hardwired oh can't be more than 10 characters um you know can't be",
    "start": "2516560",
    "end": "2522880"
  },
  {
    "text": "followed by a certain character and it turns out they can um so I didn't see a",
    "start": "2522880",
    "end": "2528319"
  },
  {
    "text": "whole lot of testing either on the forward case or in the negative case for false positives I don't know what it's",
    "start": "2528319",
    "end": "2534119"
  },
  {
    "text": "detecting and not detecting and that's just for open source closed Source no one knows what it does and nor they have",
    "start": "2534119",
    "end": "2540319"
  },
  {
    "text": "any responsibility to disclose what they're detecting or not detecting okay so can we do better",
    "start": "2540319",
    "end": "2548319"
  },
  {
    "text": "hence the talk here we are so the main thing is when SQL injection occurs it's",
    "start": "2548319",
    "end": "2554240"
  },
  {
    "text": "from user input from the Cory string from post from a cookie whatever it is",
    "start": "2554240",
    "end": "2559599"
  },
  {
    "text": "it's getting injected or dropped in place in a SQL query so a SQL injection",
    "start": "2559599",
    "end": "2565400"
  },
  {
    "text": "tag is really like could the input actually be parsed as a SQL snippet and the thing is the whole thing has to for",
    "start": "2565400",
    "end": "2572720"
  },
  {
    "text": "a SQL injection to work the entire query has to be valid SQL so really this hard",
    "start": "2572720",
    "end": "2578160"
  },
  {
    "text": "question sort of boils down to is could the user input be the start of a SQL",
    "start": "2578160",
    "end": "2584040"
  },
  {
    "text": "sort of snippet you don't necessarily need to look at the whole thing and",
    "start": "2584040",
    "end": "2589319"
  },
  {
    "text": "there's only just a few ways you can really do SQL injection you got some other new ways I'd love to hear it it's",
    "start": "2589319",
    "end": "2594680"
  },
  {
    "text": "dropped in as is it's dropped in expecting it to be in part of a single",
    "start": "2594680",
    "end": "2600000"
  },
  {
    "text": "quoted string or as a double qued string pain if you're MySQL or not you could",
    "start": "2600000",
    "end": "2605359"
  },
  {
    "text": "possibly put things in a comment but we can't we can't fix",
    "start": "2605359",
    "end": "2610720"
  },
  {
    "text": "everyone okay so then this is turns into a slightly different problem is how do you detect if user input is SQL you know",
    "start": "2611400",
    "end": "2620040"
  },
  {
    "text": "good input what is it so like my phone number is that my phone number and",
    "start": "2620040",
    "end": "2625119"
  },
  {
    "text": "arithm expression is my Twitter handle you know Twitter handle or is it actually a SQL variable and so trying to",
    "start": "2625119",
    "end": "2631400"
  },
  {
    "text": "disambiguate these things turns out to be a little bit of a hard problem and I",
    "start": "2631400",
    "end": "2636680"
  },
  {
    "text": "looked at some existing SQL parsers and they only really pars their particular flavor of",
    "start": "2636680",
    "end": "2642000"
  },
  {
    "text": "SQL um they're not really designed to handle partial bits hard to extend and",
    "start": "2642000",
    "end": "2648359"
  },
  {
    "text": "they're very worried about correctness I'm not as worried about correctness so I rote my own which sounds crazy but it",
    "start": "2648359",
    "end": "2653559"
  },
  {
    "text": "turns out to be pretty straightforward and not too bad if you don't actually need it to run SQL so what this thing",
    "start": "2653559",
    "end": "2660599"
  },
  {
    "text": "does it converts input into a stream of tokens um there's a master list of keywords and functions which is combined",
    "start": "2660599",
    "end": "2667720"
  },
  {
    "text": "against all the major databases there's only you know a few hundred of them it's not completely intractable and handles",
    "start": "2667720",
    "end": "2674480"
  },
  {
    "text": "all sort of the comments strings literals and and all the weird cases and things like that we'll get to some",
    "start": "2674480",
    "end": "2680160"
  },
  {
    "text": "examples in just a second ah maybe right here so here's an example of something",
    "start": "2680160",
    "end": "2685319"
  },
  {
    "text": "that sort of got uh pooped out of SQL map um and it sort of turns this whole",
    "start": "2685319",
    "end": "2691720"
  },
  {
    "text": "thing into sort of a stream of tokens as you can see it's in this case it sort of it checked to see that oh",
    "start": "2691720",
    "end": "2698520"
  },
  {
    "text": "it's the first part's in a single quoted string context and then from there it sort of kept going on onward okay so now",
    "start": "2698520",
    "end": "2706400"
  },
  {
    "text": "you end up with a stream of tokens and there's a bunch of them there's maybe about you know 12 I don't know 16 of",
    "start": "2706400",
    "end": "2711960"
  },
  {
    "text": "them these are all the different type of things that sort of come by and this has been sort of a a refined list over U",
    "start": "2711960",
    "end": "2719440"
  },
  {
    "text": "many iterations of sort of the algorithm based on real real attacks and benign",
    "start": "2719440",
    "end": "2724640"
  },
  {
    "text": "input so you get this whole stream of tokens coming out then there's another step which",
    "start": "2724640",
    "end": "2732000"
  },
  {
    "text": "disambiguates specializes and merges tokens together um so like is not turns",
    "start": "2732000",
    "end": "2737960"
  },
  {
    "text": "into a single operator natural join turns into a single operator uh you know",
    "start": "2737960",
    "end": "2743760"
  },
  {
    "text": "is the operator unary or is it an arithmetic operator and the last one's slightly interesting um if you see like",
    "start": "2743760",
    "end": "2751800"
  },
  {
    "text": "you know cosos the cosine function I'm an old math guy so that's sort of what happens I use math exam examples uh",
    "start": "2751800",
    "end": "2758040"
  },
  {
    "text": "cosine followed by a number well cosine is a function but if it's not followed by parentheses it's actually not a",
    "start": "2758040",
    "end": "2764280"
  },
  {
    "text": "function it's just some bare word floating around in there so it goes through this whole step and sort of disambiguates stuff merges tokens",
    "start": "2764280",
    "end": "2770720"
  },
  {
    "text": "specializes merges strings together does all the stuff it needs to do and then it does one last step which is really",
    "start": "2770720",
    "end": "2778440"
  },
  {
    "text": "designed to reduce false positives and that if it sees like a bunch of arithmetic operations together it just",
    "start": "2778440",
    "end": "2783520"
  },
  {
    "text": "merges them all together my phone number just just returns into one we don't actually care",
    "start": "2783520",
    "end": "2789319"
  },
  {
    "text": "what the value is cuz SQL injection doesn't care what the value is it's just there's a number there same thing with",
    "start": "2789319",
    "end": "2795319"
  },
  {
    "text": "multiple nested parentheses just get rid of them it it's not important for its SQL injection",
    "start": "2795319",
    "end": "2800640"
  },
  {
    "text": "part so what's interesting is so far uh it",
    "start": "2800640",
    "end": "2805720"
  },
  {
    "text": "knows a little bit about SQL but right now I've gotten to the point where it doesn't know anything about SQL injection it's just parsing SQL and",
    "start": "2805720",
    "end": "2812800"
  },
  {
    "text": "that's great because you can actually fully test this you can go through the whole thing pound it with different",
    "start": "2812800",
    "end": "2818839"
  },
  {
    "text": "inputs and you know the answer to the result so it's actually a good way of like writing tests and some other stuff",
    "start": "2818839",
    "end": "2824880"
  },
  {
    "text": "it doesn't know anything about SQL I which is great because it's always evolving people are coming up with new new tricks so um here's another example",
    "start": "2824880",
    "end": "2832920"
  },
  {
    "text": "of here's an actual another example of something that came out of a SQL map um and it turns it into sort of a",
    "start": "2832920",
    "end": "2840119"
  },
  {
    "text": "stream of tokens and in this case um you can see the example it turns into a string a",
    "start": "2840119",
    "end": "2845839"
  },
  {
    "text": "union operator keyword word a number a comma and it could keep going on from there and so what I did is let's now",
    "start": "2845839",
    "end": "2852920"
  },
  {
    "text": "generate this stream of tokens on real world data that's $5 Zan",
    "start": "2852920",
    "end": "2859160"
  },
  {
    "text": "um so from this can we actually distinguish what's benign and what's SQL",
    "start": "2859160",
    "end": "2866200"
  },
  {
    "text": "I and again so what I did is I grabbed every SQL map uh type of thing there",
    "start": "2866200",
    "end": "2872960"
  },
  {
    "text": "mole SQL ninja all sorts of different things made a fake F web server had them",
    "start": "2872960",
    "end": "2878559"
  },
  {
    "text": "pound my pound my fake site does It capture all their output I got about",
    "start": "2878559",
    "end": "2883680"
  },
  {
    "text": "32,000 samples doing this um certainly I could squeeze a lot more data from them it'd be a great project if someone's",
    "start": "2883680",
    "end": "2889839"
  },
  {
    "text": "interested to help out and then uh I trained on real input I grabbed etsy's",
    "start": "2889839",
    "end": "2896559"
  },
  {
    "text": "logs they were nice enough to let me use them hundreds of millions of user inputs uh Etsy if you're not familiar with it",
    "start": "2896559",
    "end": "2902400"
  },
  {
    "text": "is actually a fairly large site it's a top 50 website in the United States it's been around 6 years which means the",
    "start": "2902400",
    "end": "2909640"
  },
  {
    "text": "application's pretty big lots of different ways of processing and parsing user input and we have a full Tech",
    "start": "2909640",
    "end": "2916040"
  },
  {
    "text": "search where people enter all sorts of crazy stuff they're looking for it's it's great uh real world",
    "start": "2916040",
    "end": "2922880"
  },
  {
    "text": "stuff so ran this through looked at SQL",
    "start": "2922880",
    "end": "2927920"
  },
  {
    "text": "looked at benign inputs how many how much input do I need to look at in order",
    "start": "2927920",
    "end": "2933000"
  },
  {
    "text": "to see if it's benign or sqi and the magic answer is five once the tokenizer",
    "start": "2933000",
    "end": "2939400"
  },
  {
    "text": "gets five SQL tokens it can distinguish between if it's SQL I or if it's this",
    "start": "2939400",
    "end": "2945119"
  },
  {
    "text": "benign input that's really interesting compared to regular expression which is going to be parsing the entire input you",
    "start": "2945119",
    "end": "2951400"
  },
  {
    "text": "have a 10 Meg post input it's going to be parsing 10 Megs of data this as soon as it hits five tokens done so that's",
    "start": "2951400",
    "end": "2959000"
  },
  {
    "text": "that was a surprising result and here's sort of a sample of them out of a million or so using my sort of",
    "start": "2959000",
    "end": "2965480"
  },
  {
    "text": "methodology of of of possible fingerprints only 480 are actually SQL",
    "start": "2965480",
    "end": "2971400"
  },
  {
    "text": "ey um it's possible I might add some more tokens later to help reduce false positives but that's that's it those are",
    "start": "2971400",
    "end": "2979200"
  },
  {
    "text": "that is your template for sqi as we know it um the title of the talk was using it",
    "start": "2979200",
    "end": "2985720"
  },
  {
    "text": "for offense and defense this is a great way of mining to see things I'm missing",
    "start": "2985720",
    "end": "2990760"
  },
  {
    "text": "this is all based on real world data there's lots of things you can actually look at and go hey you know what people",
    "start": "2990760",
    "end": "2996280"
  },
  {
    "text": "use the number there but we can actually throw in a variable instead so I'm sure it's missing things and it'd be a great",
    "start": "2996280",
    "end": "3002599"
  },
  {
    "text": "little project to find areas it's missing anyway um one other thing about",
    "start": "3002599",
    "end": "3009359"
  },
  {
    "text": "this I'm just going to mention is because it's matching token types it doesn't really matter what the function",
    "start": "3009359",
    "end": "3016000"
  },
  {
    "text": "is what the string is if it's a number you know it's it's generic so if someone does some crazy blind arithmetic thing",
    "start": "3016000",
    "end": "3023359"
  },
  {
    "text": "it uses some new math operators to sort of work around things doesn't matter because all all I see is a function it's",
    "start": "3023359",
    "end": "3029160"
  },
  {
    "text": "a keyword it's a function I'm not actually looking at the value of the SQL",
    "start": "3029160",
    "end": "3034400"
  },
  {
    "text": "itself so the library itself I did it in see only because I wanted to see uh how",
    "start": "3034400",
    "end": "3041359"
  },
  {
    "text": "fast it could run and also I really am curious and getting this embedded in some other systems I'm really going to be excited to work with uh hopefully mod",
    "start": "3041359",
    "end": "3048440"
  },
  {
    "text": "security to make it a a Lua call out for them uh logic's under 100, lines of",
    "start": "3048440",
    "end": "3054160"
  },
  {
    "text": "codee it's not very big there's Maybe a few K of data associated with it there's",
    "start": "3054160",
    "end": "3059520"
  },
  {
    "text": "no memory allocation fixed fixed stack usage no threads and I'm pretty sure we can make",
    "start": "3059520",
    "end": "3065880"
  },
  {
    "text": "this go 2x faster if we needed to um more so this is sort of the basic thing",
    "start": "3065880",
    "end": "3071319"
  },
  {
    "text": "for C people it's that simple you make your variable have your user input pass",
    "start": "3071319",
    "end": "3077040"
  },
  {
    "text": "it in it will tell you metadata on the function including the list of tokens it",
    "start": "3077040",
    "end": "3082240"
  },
  {
    "text": "found and what matched is actually in the structure uh s filter up top",
    "start": "3082240",
    "end": "3087440"
  },
  {
    "text": "might change the names but it's it's really quite simple to use um test cases all the test cases",
    "start": "3087440",
    "end": "3094200"
  },
  {
    "text": "32,000 inputs I'm using all my false positive I use in developing this um",
    "start": "3094200",
    "end": "3099599"
  },
  {
    "text": "they're all included code coverage reports The Works um I started out originally programming in Python it's",
    "start": "3099599",
    "end": "3106000"
  },
  {
    "text": "not quite up to date to the main algorithm but I will get to it um and we're working on it and it runs quite",
    "start": "3106000",
    "end": "3111880"
  },
  {
    "text": "fast actually if you're familiar with piie you're doing maybe 50,000 a second it's pretty pretty",
    "start": "3111880",
    "end": "3118440"
  },
  {
    "text": "decent um here's another way you could do that if you're not really interested in detecting SQL ey or maybe you have an",
    "start": "3118440",
    "end": "3124400"
  },
  {
    "text": "existing set of regular Expressions you can actually use this to make it a SQL normalizer strip out all the quotes",
    "start": "3124400",
    "end": "3131839"
  },
  {
    "text": "lower you know just make everything normalized various numbers just converted to one all these different",
    "start": "3131839",
    "end": "3137160"
  },
  {
    "text": "things it actually will make existing regular expression uh detectors work",
    "start": "3137160",
    "end": "3143880"
  },
  {
    "text": "better great for fuzzers again those temp templates are actually what you can use to generate valid SQL injection",
    "start": "3143880",
    "end": "3151240"
  },
  {
    "text": "attempts from all those different fingerprints and it's available now um",
    "start": "3151240",
    "end": "3157760"
  },
  {
    "text": "website's got not only this these set of slides the sources on GitHub the links over there uh BSD license I might move",
    "start": "3157760",
    "end": "3165520"
  },
  {
    "text": "that to MIT BSD is only there to see who uses it and um there's lots of",
    "start": "3165520",
    "end": "3171319"
  },
  {
    "text": "interesting stuff to work on here um I'm going really fast because it's only 15 minutes so if you're said come on by um",
    "start": "3171319",
    "end": "3178760"
  },
  {
    "text": "I really am looking for someone who's more familiar with Oracle in Microsoft and reporting to some other",
    "start": "3178760",
    "end": "3184680"
  },
  {
    "text": "languages which really is not too bad to do and as I mentioned uh Friday if you",
    "start": "3184680",
    "end": "3190440"
  },
  {
    "text": "want to see like all the variations of Sequel and things that you know you never thought possible this Friday 4:20",
    "start": "3190440",
    "end": "3196480"
  },
  {
    "text": "I didn't make this up at the Rio and here we go thank you very much",
    "start": "3196480",
    "end": "3202079"
  },
  {
    "text": "for sticking around",
    "start": "3202079",
    "end": "3207810"
  },
  {
    "text": "[Applause]",
    "start": "3207810",
    "end": "3210840"
  }
]