[
  {
    "text": "hello everyone Welcome to our talk in today's presentation we're going to Showcase a vulnerability research we",
    "start": "2679",
    "end": "9320"
  },
  {
    "text": "conducted at Clarity team 82 in this vulnerability research we",
    "start": "9320",
    "end": "14679"
  },
  {
    "text": "managed to find vulnerabilities in reg's Cloud infrastructure that allowed us to",
    "start": "14679",
    "end": "20439"
  },
  {
    "text": "exploit them and attack devices from a remote",
    "start": "20439",
    "end": "25599"
  },
  {
    "text": "location my name is to and this is n my colleague we are both both part of the",
    "start": "25599",
    "end": "30679"
  },
  {
    "text": "clarity team 82 research group at clarity's Team 82 research group we",
    "start": "30679",
    "end": "37000"
  },
  {
    "text": "conduct reability research on critical infrastructure which consists of devices",
    "start": "37000",
    "end": "42840"
  },
  {
    "text": "all sorts of types for example um devices used in operational technology",
    "start": "42840",
    "end": "49440"
  },
  {
    "text": "devices that are used in medical um settings and also iot devices such as",
    "start": "49440",
    "end": "54840"
  },
  {
    "text": "the device we're going to Showcase today so I wanted to start off this",
    "start": "54840",
    "end": "61039"
  },
  {
    "text": "presentation with something that I want to share with you all I've got that this",
    "start": "61039",
    "end": "66840"
  },
  {
    "text": "peculiar hobby of scrolling through the Wi-Fi lists on my phone and seeing what",
    "start": "66840",
    "end": "73159"
  },
  {
    "text": "kinds of names are popping up often I find myself asking the",
    "start": "73159",
    "end": "80439"
  },
  {
    "text": "question could I hack them if I didn't have the password to those networks and",
    "start": "80439",
    "end": "86200"
  },
  {
    "text": "would I be able to infiltrate these networks well well obviously the answer",
    "start": "86200",
    "end": "91400"
  },
  {
    "text": "is yes this is what I do on a daily basis when I'm going to job to my",
    "start": "91400",
    "end": "96520"
  },
  {
    "text": "workplace I'm finding vulnerabilities and exploit vulnerabilities on devices and I managed to hack them and exploit",
    "start": "96520",
    "end": "104479"
  },
  {
    "text": "their vulnerabilities but essentially we're asking the the question today how so in",
    "start": "104479",
    "end": "112640"
  },
  {
    "text": "our case with regg the quite obvious answer was the cloud and in our case",
    "start": "112640",
    "end": "120719"
  },
  {
    "text": "this was exactly what we did we managed to exploit vulnerabilities in the cloud infrastructure of ruigi and we were able",
    "start": "120719",
    "end": "128039"
  },
  {
    "text": "to exploit vulnerabilities on the devices that are remote to us and so we",
    "start": "128039",
    "end": "133560"
  },
  {
    "text": "were able to do this exploit chain in order to attack a device from a remote",
    "start": "133560",
    "end": "138680"
  },
  {
    "text": "location from a remote network but not only that we did manage",
    "start": "138680",
    "end": "144800"
  },
  {
    "text": "to do it with the cloud infrastructure against all of the other devices",
    "start": "144800",
    "end": "150440"
  },
  {
    "text": "because of that bridge that is called the cloud platform and that's what actually we're",
    "start": "150440",
    "end": "157360"
  },
  {
    "text": "going to show you today so let's talk about our",
    "start": "157360",
    "end": "162840"
  },
  {
    "text": "Target in this slide you can see a access point provided by RI the",
    "start": "162840",
    "end": "168560"
  },
  {
    "text": "manufacturer of network appliances RI networks is a company providing solutions for",
    "start": "168560",
    "end": "174959"
  },
  {
    "text": "network and offices and a lot lot more settings",
    "start": "174959",
    "end": "181360"
  },
  {
    "text": "that are provided here in the slide their devices are mainly used for",
    "start": "181360",
    "end": "187159"
  },
  {
    "text": "networking and for management of networks in different",
    "start": "187159",
    "end": "192519"
  },
  {
    "text": "settings you may see the their device when you're walking through a stadium",
    "start": "192519",
    "end": "197599"
  },
  {
    "text": "maybe in this venue here maybe in a terminal and you may even notice them",
    "start": "197599",
    "end": "203400"
  },
  {
    "text": "when you're trying to connect to the network on your Wi-Fi device and when you're walking there",
    "start": "203400",
    "end": "210640"
  },
  {
    "text": "you won't even notice that this device is actually providing a large area with network accessibility well that is",
    "start": "210640",
    "end": "217799"
  },
  {
    "text": "actually enabled because of the mesh configuration technology that allows several devices to also share the common",
    "start": "217799",
    "end": "226640"
  },
  {
    "text": "Network so these devices actually provide the feature of cloud",
    "start": "226640",
    "end": "232439"
  },
  {
    "text": "connectivity and also provide the Wi-Fi accessibility and when we are talking",
    "start": "232439",
    "end": "238439"
  },
  {
    "text": "about our Target for research today which is in this specific scenario the",
    "start": "238439",
    "end": "244200"
  },
  {
    "text": "access point we are actually talking about an embedded research and usually",
    "start": "244200",
    "end": "249799"
  },
  {
    "text": "when we are talking about an embedded research we are starting our investigation or analysis with trying to",
    "start": "249799",
    "end": "258120"
  },
  {
    "text": "find the attack surface that is exposed to us the attackers or the researchers and so most of the times we",
    "start": "258120",
    "end": "265560"
  },
  {
    "text": "will look for the exposed services that are actually accessible for us the",
    "start": "265560",
    "end": "270840"
  },
  {
    "text": "attacker in our case it could be a web interface that is exposed a FTP server",
    "start": "270840",
    "end": "278320"
  },
  {
    "text": "or maybe even an SNMP interface that can be utilized and can be researched in",
    "start": "278320",
    "end": "284400"
  },
  {
    "text": "order to find vulnerabilities that we can exploit in order to actually exploit the device and be able to overtake",
    "start": "284400",
    "end": "292000"
  },
  {
    "text": "it well this is all fine but we want more",
    "start": "292000",
    "end": "297680"
  },
  {
    "text": "because you see in our scenario we are actually attacking a device from a Lo local network in the scenario I",
    "start": "297680",
    "end": "305360"
  },
  {
    "text": "just provided you the attacker is sitting on the same network as the device and is exposed an accessible to",
    "start": "305360",
    "end": "311759"
  },
  {
    "text": "the services I just talked about but we want more as I stated and so we want the",
    "start": "311759",
    "end": "318919"
  },
  {
    "text": "ability to be an attacker on a different network and be able to actually exploit",
    "start": "318919",
    "end": "324199"
  },
  {
    "text": "the device that is sitting on a remote location on a remote Network without even being in physical proximity or with",
    "start": "324199",
    "end": "331800"
  },
  {
    "text": "being in a network that is not the same network and you see in this scenario as",
    "start": "331800",
    "end": "337720"
  },
  {
    "text": "the attacker we are not actually accessible to the services that are provided by that device we are sitting",
    "start": "337720",
    "end": "343960"
  },
  {
    "text": "on the different network on the one whereas the device our Target the regi",
    "start": "343960",
    "end": "349600"
  },
  {
    "text": "access point is sitting on a Land network and is actually segregated from the wide area network or the internet",
    "start": "349600",
    "end": "357840"
  },
  {
    "text": "using a router that provides not functionality or a firewall and so we are actually blocked",
    "start": "357840",
    "end": "365400"
  },
  {
    "text": "in our accessibility to those Services most of the times but there is a solution so don't",
    "start": "365400",
    "end": "372080"
  },
  {
    "text": "worry we have the cloud that is actually an interface that allows us to",
    "start": "372080",
    "end": "377560"
  },
  {
    "text": "communicate with devices from a remote location this is perfect for us so let's talk about the reg Cloud",
    "start": "377560",
    "end": "385680"
  },
  {
    "text": "platform well as a lot of vendors do the Cloud platform is provided by roui to",
    "start": "385680",
    "end": "392599"
  },
  {
    "text": "their customers that use their devices in their networks you see for example if",
    "start": "392599",
    "end": "400280"
  },
  {
    "text": "I were to be an a CIS admin or a network manager and I were to go to a uh let's",
    "start": "400280",
    "end": "407120"
  },
  {
    "text": "say a vacation I would like the ability to solve problems that might occur when",
    "start": "407120",
    "end": "412319"
  },
  {
    "text": "I'm not around and so this platform allows me to configure devices from",
    "start": "412319",
    "end": "418000"
  },
  {
    "text": "remote location to mon monor the network and to actually provide solutions from a",
    "start": "418000",
    "end": "423120"
  },
  {
    "text": "remote location and yeah when I go to the web interface and watch what can I do with",
    "start": "423120",
    "end": "429639"
  },
  {
    "text": "the device I own I can see that I can use the log history to watch the logs I",
    "start": "429639",
    "end": "434840"
  },
  {
    "text": "can use the configuration to configure the device from a remote location and all of this thanks to the cloud platform",
    "start": "434840",
    "end": "441319"
  },
  {
    "text": "this is amazing and it's nice to have and it's also amazing for us the",
    "start": "441319",
    "end": "446800"
  },
  {
    "text": "researchers because it's a platform that allows to interact with with the device from a remote",
    "start": "446800",
    "end": "451960"
  },
  {
    "text": "location so let's discuss a little bit about the initialization of a device",
    "start": "451960",
    "end": "457840"
  },
  {
    "text": "inside our network with regards to the cloud connectivity the first stage when",
    "start": "457840",
    "end": "463000"
  },
  {
    "text": "a device is connected to a network will be the device provisioning stage the device will state hello and",
    "start": "463000",
    "end": "470159"
  },
  {
    "text": "will connect back to the cloud um service and when it's connected to our",
    "start": "470159",
    "end": "475960"
  },
  {
    "text": "Network it will try to connect back once it connects to the server of the",
    "start": "475960",
    "end": "481960"
  },
  {
    "text": "cloud it will provide a serial number which is an identifying value that is",
    "start": "481960",
    "end": "487479"
  },
  {
    "text": "unique to the device once it goes out from the manufacturing facility so the regi R Cloud platform",
    "start": "487479",
    "end": "496960"
  },
  {
    "text": "will check and verify the serial number that is provided by the device it will",
    "start": "496960",
    "end": "502440"
  },
  {
    "text": "make sure that it's a real device and that it's actually",
    "start": "502440",
    "end": "507720"
  },
  {
    "text": "um a valid serial number and so once the",
    "start": "507720",
    "end": "512959"
  },
  {
    "text": "serial number is digested the cloud service will approve it and the device",
    "start": "512959",
    "end": "518120"
  },
  {
    "text": "will be provisioned well that's only the first stage because then we as the owner",
    "start": "518120",
    "end": "524000"
  },
  {
    "text": "of the device we really want to be the only one that a are able to interact",
    "start": "524000",
    "end": "529279"
  },
  {
    "text": "with our device so as the device owner the first thing I will do when I connect",
    "start": "529279",
    "end": "535760"
  },
  {
    "text": "the device to the network is to go to the web interface using my account and",
    "start": "535760",
    "end": "541120"
  },
  {
    "text": "the first thing I will do will go to the add device feature there I will be prompted with a serial number form that",
    "start": "541120",
    "end": "548320"
  },
  {
    "text": "I can provide a serial number of a device I want to to claim as my own I will go to the device I will flip it",
    "start": "548320",
    "end": "555200"
  },
  {
    "text": "around I will show you right now the label of our device as you see it's not",
    "start": "555200",
    "end": "562360"
  },
  {
    "text": "the whole serial number because I don't want you to use my device but I can use this serial number and put it inside",
    "start": "562360",
    "end": "569360"
  },
  {
    "text": "inside our serial number form and voila we've got the device provisioned and",
    "start": "569360",
    "end": "574560"
  },
  {
    "text": "claimed and we can also utilize it from a remote location that is actually the",
    "start": "574560",
    "end": "581680"
  },
  {
    "text": "wonderful feature that we are able to use with that cloud Platform One intriguing thing with that",
    "start": "581680",
    "end": "590440"
  },
  {
    "text": "well what is actually the communication between the device and the regi Cloud",
    "start": "590440",
    "end": "595560"
  },
  {
    "text": "interface in our case it's quite simple the device sends notification about its status and the cloud infrastructure",
    "start": "595560",
    "end": "602480"
  },
  {
    "text": "allows me as the owner of the device to configure it over the air to send",
    "start": "602480",
    "end": "607680"
  },
  {
    "text": "upgrades to the firmware and to monitor its state so",
    "start": "607680",
    "end": "613959"
  },
  {
    "text": "great we've got uh the basic premise of the device and Cloud interactions we",
    "start": "613959",
    "end": "620000"
  },
  {
    "text": "know what the device does when it's initially connected to our network but we need to dig deeper and that's why",
    "start": "620000",
    "end": "626240"
  },
  {
    "text": "we're here so digg deeper in our case would be to",
    "start": "626240",
    "end": "631399"
  },
  {
    "text": "go to the vendor site and to download the fare of the device from their",
    "start": "631399",
    "end": "637240"
  },
  {
    "text": "site this was quite easy and we actually found it very quickly which was nice",
    "start": "637240",
    "end": "642720"
  },
  {
    "text": "thank you for IGI and we were quite stumbled when we tried",
    "start": "642720",
    "end": "649920"
  },
  {
    "text": "to analyze that firmware image and to extract the file system from it well as you see the entropy is quite high of the",
    "start": "649920",
    "end": "657800"
  },
  {
    "text": "firmware image file and it's quite flat just to make sure that everyone are on",
    "start": "657800",
    "end": "664079"
  },
  {
    "text": "the same page entropy means that there is disorder in the information that is provided by that file so in our case the",
    "start": "664079",
    "end": "672279"
  },
  {
    "text": "file is not actually um it's not that easy to extract a file",
    "start": "672279",
    "end": "678399"
  },
  {
    "text": "system from that file and that is because it doesn't have constructs that allow us to infer what kind of",
    "start": "678399",
    "end": "684720"
  },
  {
    "text": "information are in there so it could be either that the file is packed or either",
    "start": "684720",
    "end": "690839"
  },
  {
    "text": "it is encrypted and in our case it was encrypted this is actually um because",
    "start": "690839",
    "end": "696959"
  },
  {
    "text": "our analysis we concluded this to this conclusion because we couldn't find any",
    "start": "696959",
    "end": "702760"
  },
  {
    "text": "constructs that allow us to tear down the uh wrapper of the packing and actually gain access to the file system",
    "start": "702760",
    "end": "710800"
  },
  {
    "text": "so yeah it was actually encrypted so how do we continue from",
    "start": "710800",
    "end": "716279"
  },
  {
    "text": "here well we've got three options well well you see most",
    "start": "716279",
    "end": "721320"
  },
  {
    "text": "vendors actually don't ship their device or Market their device initially with an",
    "start": "721320",
    "end": "726440"
  },
  {
    "text": "encrypted fror this is actually a feature that is quite relevant and quite",
    "start": "726440",
    "end": "731760"
  },
  {
    "text": "new so we could infer that some devices had",
    "start": "731760",
    "end": "737160"
  },
  {
    "text": "the firmware unencrypted at some point of time so this means that we can",
    "start": "737160",
    "end": "742320"
  },
  {
    "text": "actually go to that specific firmware version maybe use the Wayback machine",
    "start": "742320",
    "end": "747480"
  },
  {
    "text": "maybe go to the vendor site and see if there are any older firmware versions",
    "start": "747480",
    "end": "752639"
  },
  {
    "text": "and we can actually use dis to go to the firmware version that was the actual",
    "start": "752639",
    "end": "759199"
  },
  {
    "text": "version that inte integrated the encryption scheme into the firmware of the device so this means that once we",
    "start": "759199",
    "end": "768279"
  },
  {
    "text": "gain access to that frameware which is actually the switch frameware I call it we can actually roll back the encryption",
    "start": "768279",
    "end": "774959"
  },
  {
    "text": "scheme and have a access to the firmware that are encrypted",
    "start": "774959",
    "end": "780440"
  },
  {
    "text": "well this is only this first option the second option will be to use Hardware",
    "start": "780440",
    "end": "786000"
  },
  {
    "text": "hacking to solder off the flash chip that contains the firmware that is unencrypted",
    "start": "786000",
    "end": "791480"
  },
  {
    "text": "decrypted and to extract the firmware file system from it this is also a",
    "start": "791480",
    "end": "796920"
  },
  {
    "text": "viable option the third option which is the option we decided is to actually find a",
    "start": "796920",
    "end": "804360"
  },
  {
    "text": "vulnerability from a local network not a very intricate vulnerability that allows",
    "start": "804360",
    "end": "809920"
  },
  {
    "text": "us to run code or to run command shells on the device and to play around with",
    "start": "809920",
    "end": "815959"
  },
  {
    "text": "the device we own so as I stated we actually chose this and 3 hours later",
    "start": "815959",
    "end": "823639"
  },
  {
    "text": "more or less we managed to find a vulnerability that allowed us to actually interact with the device not a",
    "start": "823639",
    "end": "830160"
  },
  {
    "text": "very um intricate vulnerability as I stated but it allowed us to run commands",
    "start": "830160",
    "end": "836920"
  },
  {
    "text": "on the device from a local interface and this was amazing because now we can interact with the device and we can",
    "start": "836920",
    "end": "843360"
  },
  {
    "text": "actually start our research let's say handson so we did want to actually be",
    "start": "843360",
    "end": "851079"
  },
  {
    "text": "able to decrypt the firmwares anyway so we managed to find the RG upgrade crypto",
    "start": "851079",
    "end": "856399"
  },
  {
    "text": "component that allowed us evidently to continue our research so let's talk",
    "start": "856399",
    "end": "863440"
  },
  {
    "text": "about this component an analysis of the component called RG upgrade crypto which I don't",
    "start": "863440",
    "end": "869720"
  },
  {
    "text": "think I already stated is an actual elf binary we found this PEC string upgrade",
    "start": "869720",
    "end": "876360"
  },
  {
    "text": "Crypt V1 which was very interesting and also very familiar in fact it was very familiar",
    "start": "876360",
    "end": "883839"
  },
  {
    "text": "because we already saw it we saw it inside the encrypted firmware image this",
    "start": "883839",
    "end": "889560"
  },
  {
    "text": "was the actual Smoking Gun we found our Target we found the component that actually decrypts the firware",
    "start": "889560",
    "end": "896320"
  },
  {
    "text": "image so further analysis of that component we managed to find the",
    "start": "896320",
    "end": "901959"
  },
  {
    "text": "encryption scheme it wasn't that difficult and the symmetric the encryption scheme is actually symmetric",
    "start": "901959",
    "end": "908839"
  },
  {
    "text": "a rolling sore plus shift so at this point we had two options we could either try to roll back",
    "start": "908839",
    "end": "917240"
  },
  {
    "text": "the encryption scheme reverse engineer it write our own python script in order to extract airas or secondly and what we",
    "start": "917240",
    "end": "925839"
  },
  {
    "text": "decided to emulate the binary and that's it's actually quite simple we created an",
    "start": "925839",
    "end": "932040"
  },
  {
    "text": "environment that is similar to the environment inside the device downloaded all the necessary libraries used",
    "start": "932040",
    "end": "939680"
  },
  {
    "text": "qmu and we were able to emulate that",
    "start": "939680",
    "end": "945120"
  },
  {
    "text": "binary as you can see we show a screenshot you can see a posix star",
    "start": "945120",
    "end": "951680"
  },
  {
    "text": "archive that is actually the encrypted content and so we were successful we",
    "start": "951680",
    "end": "957519"
  },
  {
    "text": "managed to gain hold of content of the firmware and actually when we extracted",
    "start": "957519",
    "end": "963040"
  },
  {
    "text": "the components inside that t archive we were glad to see that we are actually",
    "start": "963040",
    "end": "968800"
  },
  {
    "text": "able to access the control file which is a hardware version used by the device to",
    "start": "968800",
    "end": "973839"
  },
  {
    "text": "verify that is a viable version for the corresponding physical device the root",
    "start": "973839",
    "end": "981120"
  },
  {
    "text": "uh file system that is actually the fast system we want and the Kel of the device",
    "start": "981120",
    "end": "987800"
  },
  {
    "text": "I will make make it clear that actually the most interest interesting part of this was the actual root file system the",
    "start": "987800",
    "end": "995120"
  },
  {
    "text": "squashfs file system this is because it's containing the all components that are relevant to the logic of the device",
    "start": "995120",
    "end": "1002000"
  },
  {
    "text": "and are actually the proprietary um implementation of the things we want to",
    "start": "1002000",
    "end": "1007319"
  },
  {
    "text": "understand which is in our case the cloud",
    "start": "1007319",
    "end": "1011959"
  },
  {
    "text": "interactions perfect so now we have access to both a real life working",
    "start": "1014279",
    "end": "1019480"
  },
  {
    "text": "device and also the file system containing all the different files everything we need so what's next what",
    "start": "1019480",
    "end": "1025000"
  },
  {
    "text": "our next goal you see our goal now is to understand how do Dei how does a device",
    "start": "1025000",
    "end": "1030520"
  },
  {
    "text": "connect to the cloud meaning what protocol what endpoints everything about recling that and to understand what it",
    "start": "1030520",
    "end": "1037959"
  },
  {
    "text": "actually does behind the scenes how it authenticates to the cloud what kind of apis exist all of that sorts and to do",
    "start": "1037959",
    "end": "1044839"
  },
  {
    "text": "that we need to do the first step that is always the same and it is to actually identify the cloud binary that handles",
    "start": "1044839",
    "end": "1051720"
  },
  {
    "text": "all Cloud communication now sadly there's no magic bullet into doing it because we're talking about finding one",
    "start": "1051720",
    "end": "1058440"
  },
  {
    "text": "binary in an entire file system we have no idea what it's named what it does nothing so let's go through what I",
    "start": "1058440",
    "end": "1065240"
  },
  {
    "text": "usually do when I try to find a cloud binary uh in a new device that I hacked into so the first step is to look at",
    "start": "1065240",
    "end": "1073120"
  },
  {
    "text": "startup skip you see like toer told you this device immediately calls back to",
    "start": "1073120",
    "end": "1078679"
  },
  {
    "text": "the the cloud to the vendor's Cloud immediately when it boots up and want to do a cloud pairing meaning this needs to",
    "start": "1078679",
    "end": "1085480"
  },
  {
    "text": "be ran This Cloud script or Cloud binary needs to be run on boot now this",
    "start": "1085480",
    "end": "1091640"
  },
  {
    "text": "actually depends on different Linux distributions it could be in D it could be systemd however usually we will find",
    "start": "1091640",
    "end": "1098039"
  },
  {
    "text": "vendor specific code in the startup scripts that allow them to connect back and call back to the cloud whenever they",
    "start": "1098039",
    "end": "1104280"
  },
  {
    "text": "get booed up next I simply look for different strings if for for example I know the domain that the cloud the",
    "start": "1104280",
    "end": "1111360"
  },
  {
    "text": "vendors cloud is hosted on or even just the top level domain I can try and look and graph and find binaries that",
    "start": "1111360",
    "end": "1118039"
  },
  {
    "text": "contains this string and lastly if all fails I try and look for different configuration files because you many",
    "start": "1118039",
    "end": "1124880"
  },
  {
    "text": "times vendors do not hard code their endpoints or their strings secrets into",
    "start": "1124880",
    "end": "1130400"
  },
  {
    "text": "their binaries and instead they use a configuration file and by finding the configuration file that is probably used",
    "start": "1130400",
    "end": "1136080"
  },
  {
    "text": "by the cloud binary I can find who opens it and who interacts with it and after a",
    "start": "1136080",
    "end": "1141159"
  },
  {
    "text": "short investigation we found it in our case mq l.f is the binary that handles",
    "start": "1141159",
    "end": "1147080"
  },
  {
    "text": "all Cloud communication next our job is to understand how it actually works and how it holds back to the cloud now once",
    "start": "1147080",
    "end": "1154640"
  },
  {
    "text": "again there's no one specific way it needs to do that because there are tons and tons of different protocols and each",
    "start": "1154640",
    "end": "1161080"
  },
  {
    "text": "vendor simply pick and chooses what they want and how they want to do their Cloud communication API what I usually do is I",
    "start": "1161080",
    "end": "1167440"
  },
  {
    "text": "once again I try and look for strings or libraries to help me identify what kind of protocol is used for cloud",
    "start": "1167440",
    "end": "1174600"
  },
  {
    "text": "communication for example if we know that the vendor is using uh mqtt for",
    "start": "1174600",
    "end": "1179840"
  },
  {
    "text": "their Cloud communication I would find strings about common libraries used by mqtt clients like poo or mosquito in our",
    "start": "1179840",
    "end": "1187720"
  },
  {
    "text": "case as you can see we found tons and tons of string showcasing the vendor used mosquito which is a very popular",
    "start": "1187720",
    "end": "1194400"
  },
  {
    "text": "library for mqtt clients and this help us concluded that they use mqtt for",
    "start": "1194400",
    "end": "1199640"
  },
  {
    "text": "their Cloud communication so what is mqtt you might be asking well mqtt is a very very",
    "start": "1199640",
    "end": "1206440"
  },
  {
    "text": "popular protocol for device communication between iot devices and the cloud platform of the vendor it is",
    "start": "1206440",
    "end": "1213880"
  },
  {
    "text": "basically a messaging protocol meaning its sole purpose is to distribute messages to different clients and it",
    "start": "1213880",
    "end": "1220360"
  },
  {
    "text": "works by all clients connecting to one Central as entity which is the broker",
    "start": "1220360",
    "end": "1225440"
  },
  {
    "text": "and then they start sending messages over something that's called channels or name topics in mqtt which are basically",
    "start": "1225440",
    "end": "1232400"
  },
  {
    "text": "strings that relevant and showcase which messages should be distributed to which clients now mqt is a publisher",
    "start": "1232400",
    "end": "1239520"
  },
  {
    "text": "subscriber protocol meaning the entire terminology is working on if you want to send a message you will publish it and",
    "start": "1239520",
    "end": "1246039"
  },
  {
    "text": "if you want to receive messages from a specific topic you would subscribe to it and that way the broker knows which",
    "start": "1246039",
    "end": "1252960"
  },
  {
    "text": "messages should get to which clients so we know our Cloud binary in",
    "start": "1252960",
    "end": "1258280"
  },
  {
    "text": "the case of of roui uses mqtt so let's find out what we need to build our own client and What roui needs to help them",
    "start": "1258280",
    "end": "1265840"
  },
  {
    "text": "H connect their devices to their Cloud platform and the first thing is quite obvious you need to know the broker's",
    "start": "1265840",
    "end": "1272679"
  },
  {
    "text": "address now as you can see in the configuration files of ruigi we have this address right here which is their",
    "start": "1272679",
    "end": "1278960"
  },
  {
    "text": "Global broker this means that all Cloud all rigi devices all around the world",
    "start": "1278960",
    "end": "1284919"
  },
  {
    "text": "connect to this broker and send messages over it next we need the ca certificate",
    "start": "1284919",
    "end": "1291200"
  },
  {
    "text": "of this broker now you can think of it a bit like uh certificate pinning if",
    "start": "1291200",
    "end": "1296679"
  },
  {
    "text": "you're aware of this term basically they need to make sure that their devices only connect to the real CA and no kind",
    "start": "1296679",
    "end": "1304480"
  },
  {
    "text": "of attacks can be H for example a man in the- Middle attack could actually expose their devices to different risks now",
    "start": "1304480",
    "end": "1311799"
  },
  {
    "text": "when we Implement our client we don't need to have the ca certificate because we can simply say yeah I trust it I know",
    "start": "1311799",
    "end": "1318240"
  },
  {
    "text": "the risks and I can simply uh use that the certificate that I get from the TLs",
    "start": "1318240",
    "end": "1324520"
  },
  {
    "text": "endpoint and lastly I need to this to do some sort of authentication now mqtt",
    "start": "1324520",
    "end": "1331159"
  },
  {
    "text": "offer a wide range of authentication schemes and the two most common ones are either mtls meaning Mutual TLS where",
    "start": "1331159",
    "end": "1339320"
  },
  {
    "text": "both client and server authenticate using a private key and a certificate or of course username password credential",
    "start": "1339320",
    "end": "1346159"
  },
  {
    "text": "spare now in the case of ruigi no mtls was configured meaning it's quite easy all we need to do is to generate a valid",
    "start": "1346159",
    "end": "1353520"
  },
  {
    "text": "mqtt credentials and then we are able to authenticate to the ruigi cloud cool so let's see how we generate",
    "start": "1353520",
    "end": "1360960"
  },
  {
    "text": "them so we started reverse engineering the cloud binary mq link. LF and the first thing we noticed is that whenever",
    "start": "1360960",
    "end": "1367720"
  },
  {
    "text": "the device tries to connect to the mqt broker it uses its serial number as the",
    "start": "1367720",
    "end": "1373840"
  },
  {
    "text": "username for the mqtt credentials now you see the seral number is a hardware identified that is actually imprinted on",
    "start": "1373840",
    "end": "1380080"
  },
  {
    "text": "the chip of the device during the manufacturing and to read that they simply read a different Pro one specific",
    "start": "1380080",
    "end": "1386279"
  },
  {
    "text": "prop Ming mapping uh in order to get access to the serial number of the device and use it as is as the username",
    "start": "1386279",
    "end": "1394080"
  },
  {
    "text": "next we wanted to understand how the actual password generation was performed and once again the device relies on its",
    "start": "1394080",
    "end": "1401559"
  },
  {
    "text": "harder identifier the serial number and this is the sylized procedure you see they take the serial number do string",
    "start": "1401559",
    "end": "1408480"
  },
  {
    "text": "reverse functionality on it meaning flip it up to the other way around and then",
    "start": "1408480",
    "end": "1413679"
  },
  {
    "text": "perform shot 256 and use it as is as the mqtt password now we know how the actual",
    "start": "1413679",
    "end": "1420640"
  },
  {
    "text": "client credentials are generated and all we need is a serial number now this is usually a question I ask myself how do I",
    "start": "1420640",
    "end": "1427919"
  },
  {
    "text": "get the serial number of a real device well luckily for me I have YouTube you",
    "start": "1427919",
    "end": "1433520"
  },
  {
    "text": "see one thing people love do is show up their cool new Gadget that they just bought and they love doing an unboxing",
    "start": "1433520",
    "end": "1440679"
  },
  {
    "text": "or a setup and tutorial and usually what people would do is Showcase the device from all different angles and like toer",
    "start": "1440679",
    "end": "1448400"
  },
  {
    "text": "told you on the back of the device there is its our identifiers including the serial number and Mac so I'll did I",
    "start": "1448400",
    "end": "1454600"
  },
  {
    "text": "search on YouTube ruigi unboxing and ruigi setup and people showcase to me",
    "start": "1454600",
    "end": "1460159"
  },
  {
    "text": "their devices serial number now because ruigi uses the serial number which is",
    "start": "1460159",
    "end": "1467000"
  },
  {
    "text": "according to people that simply showcase it on the internet not as secure",
    "start": "1467000",
    "end": "1472399"
  },
  {
    "text": "identifier by leaking their device serial number people actually leak to me and anyone with YouTube",
    "start": "1472399",
    "end": "1479159"
  },
  {
    "text": "access access to their device credentials so this means that by",
    "start": "1479159",
    "end": "1484480"
  },
  {
    "text": "knowing a device serial number I can simply log in on its behalf so that's",
    "start": "1484480",
    "end": "1489520"
  },
  {
    "text": "exactly what I did I implemented a very simple python script that connects to R's mqtt broker and W bam I got",
    "start": "1489520",
    "end": "1497640"
  },
  {
    "text": "connection back zero meaning my connection was accepted I'm in I am now a",
    "start": "1497640",
    "end": "1503720"
  },
  {
    "text": "device perfect so what's next next we wanted to understand and reverse engineer and know what kind of",
    "start": "1503720",
    "end": "1510760"
  },
  {
    "text": "communication is done on top of rigi's Cloud now you see like I told before",
    "start": "1510760",
    "end": "1516360"
  },
  {
    "text": "mqtt is a publish subscribe protocol so first we look at all the topics that device published data to now we",
    "start": "1516360",
    "end": "1524279"
  },
  {
    "text": "discovered four different topics however the gist of it is that by publishing data on these topics devices actually",
    "start": "1524279",
    "end": "1531840"
  },
  {
    "text": "alert The Cloud of different events that occur to them for example if I have a status notification or I keep alive I",
    "start": "1531840",
    "end": "1538279"
  },
  {
    "text": "want to make sure the cloud knows I'm good or if I have a topology change for example a new client authenticated to me",
    "start": "1538279",
    "end": "1545080"
  },
  {
    "text": "my configuration was changed anything like that and by sending publishing",
    "start": "1545080",
    "end": "1550200"
  },
  {
    "text": "messages over these topics devices are able to alert The Cloud of everything that happens to",
    "start": "1550200",
    "end": "1556039"
  },
  {
    "text": "them next we have the topics that devices actually subscribed to you see",
    "start": "1556039",
    "end": "1562480"
  },
  {
    "text": "every device has a unique topic which is device serial number which is once again unique to its serial number that all",
    "start": "1562480",
    "end": "1570240"
  },
  {
    "text": "theice that this device actually subscribes to and then whenever the clouds the cloud wants to send com",
    "start": "1570240",
    "end": "1576919"
  },
  {
    "text": "commands to this device for example do this configuration change or do a f",
    "start": "1576919",
    "end": "1582480"
  },
  {
    "text": "upgrade a command in sent over this topic and the device simply does what",
    "start": "1582480",
    "end": "1587640"
  },
  {
    "text": "it's told cool so now that we have a basic understanding of rigi's mqt architecture",
    "start": "1587640",
    "end": "1594279"
  },
  {
    "text": "we are now able to do some vulnerability research and the first thing we did is",
    "start": "1594279",
    "end": "1599360"
  },
  {
    "text": "asked ourself the obvious question can we actually subscribe to topics that",
    "start": "1599360",
    "end": "1604960"
  },
  {
    "text": "device publish data to you see if we would be able to subscribe to these topics which which are just four topics",
    "start": "1604960",
    "end": "1611760"
  },
  {
    "text": "for all devices around the world we would be be able to get all status events alerts from all devices all",
    "start": "1611760",
    "end": "1619679"
  },
  {
    "text": "around the world so we simply took our client subscribe and once again wam it",
    "start": "1619679",
    "end": "1626000"
  },
  {
    "text": "simply worked now we have access to every alert that every device sends to",
    "start": "1626000",
    "end": "1631880"
  },
  {
    "text": "ruyi's Cloud platform all around the world however the keened eye in you",
    "start": "1631880",
    "end": "1637360"
  },
  {
    "text": "probably noticed something very very interesting you see in every message there is this field right here which is",
    "start": "1637360",
    "end": "1644320"
  },
  {
    "text": "the actual device serial number because we are talking about centralized topics meaning all devices send the data",
    "start": "1644320",
    "end": "1651159"
  },
  {
    "text": "to one specific topic the clouds need to be able to somehow know what divine sent what device sent the alert and in order",
    "start": "1651159",
    "end": "1657960"
  },
  {
    "text": "to do that RI simply sent the serial number in each message this means that we compos a very big list of all",
    "start": "1657960",
    "end": "1665120"
  },
  {
    "text": "messages we received we took the Cal number from each message and then one unique sort and Sublime command after we",
    "start": "1665120",
    "end": "1671679"
  },
  {
    "text": "have all serial numbers of all devices all around the world around 50,000 or so",
    "start": "1671679",
    "end": "1679600"
  },
  {
    "text": "now at this point we understood that we have something big because be because we have all all serial numbers of all",
    "start": "1679600",
    "end": "1687000"
  },
  {
    "text": "devices all around the world and RI relies on this serial number to authenticate and validate devices we now",
    "start": "1687000",
    "end": "1694399"
  },
  {
    "text": "are able to authenticate and impersonate every device all around the world meaning we are able to connect on its",
    "start": "1694399",
    "end": "1700440"
  },
  {
    "text": "behalf send falsifies data for for example hey I'm good or I'm bad I'm",
    "start": "1700440",
    "end": "1706120"
  },
  {
    "text": "crooked I'm down whatever and we are able to basically Doss the entire system",
    "start": "1706120",
    "end": "1711399"
  },
  {
    "text": "both by sending falsified data and by disconnecting the real device however one like Tom told you before we want",
    "start": "1711399",
    "end": "1717919"
  },
  {
    "text": "more we are not good with just dossing this whole situation so we asked ourselves how can",
    "start": "1717919",
    "end": "1724159"
  },
  {
    "text": "we achieve RC and to do that we once again looked",
    "start": "1724159",
    "end": "1729919"
  },
  {
    "text": "at the other kind of topics that device interact with which is the device serial",
    "start": "1729919",
    "end": "1735240"
  },
  {
    "text": "number now because we compos the we composed the list of all possible serial",
    "start": "1735240",
    "end": "1740360"
  },
  {
    "text": "numbers we now had the ability to subscribe to every device you need topic",
    "start": "1740360",
    "end": "1745799"
  },
  {
    "text": "to see what kind of cloud of commands does the rui cloud platform send it",
    "start": "1745799",
    "end": "1751600"
  },
  {
    "text": "however that's quite a hassle I don't like doing a lot of work and it will take some time to actually do and keep",
    "start": "1751600",
    "end": "1757960"
  },
  {
    "text": "alive 50,000 subscribers so we as I asked ourselves hey can I maybe improve it and to do that I need to understand",
    "start": "1757960",
    "end": "1765559"
  },
  {
    "text": "how mqtt topics are actually constructed so by this point I told you that a topic",
    "start": "1765559",
    "end": "1771200"
  },
  {
    "text": "is simply a string a name however it is actually composed of different level",
    "start": "1771200",
    "end": "1776360"
  },
  {
    "text": "where each level is separated by the delimiter mqtt chose which is a slash however luckily for us re uh mqtt",
    "start": "1776360",
    "end": "1784600"
  },
  {
    "text": "actually offers wild card it offers two kind two flavors of wild cards either a",
    "start": "1784600",
    "end": "1789840"
  },
  {
    "text": "single level Wild Card which is the plus command basically telling the broker hey I want to subscribe to anything that",
    "start": "1789840",
    "end": "1795720"
  },
  {
    "text": "matches this specific level or we have we have a multi-level Wild Card which basically is do give me",
    "start": "1795720",
    "end": "1802000"
  },
  {
    "text": "anything and this is exactly what we did we use the Wild Card the plus wild card",
    "start": "1802000",
    "end": "1807200"
  },
  {
    "text": "to subscribe to device plus meaning we subscribe to all topics of all devices",
    "start": "1807200",
    "end": "1813640"
  },
  {
    "text": "and we were able to get all commands sent by the ruigi cloud platform to devices around the world and once again",
    "start": "1813640",
    "end": "1822039"
  },
  {
    "text": "tons and tons of different messages because whenever a user clicks on a device whenever he does some kind of",
    "start": "1822039",
    "end": "1827399"
  },
  {
    "text": "configuration changes anything we get the actual call back and we get all of it identifiable",
    "start": "1827399",
    "end": "1834000"
  },
  {
    "text": "information when we parsed it however we found something even more interesting you see this is the actual structure of",
    "start": "1834000",
    "end": "1840600"
  },
  {
    "text": "a command sent by rouis C platform to devices and as it turns out it is simply",
    "start": "1840600",
    "end": "1846480"
  },
  {
    "text": "an OS command meaning R's Cloud simply tells devices hey please execute this OS",
    "start": "1846480",
    "end": "1852120"
  },
  {
    "text": "command and send me the output and this is how they handle everything meaning we want to do a configuration change do a",
    "start": "1852120",
    "end": "1859399"
  },
  {
    "text": "device config set you want to do a film upgrade fetch it with W get and run it",
    "start": "1859399",
    "end": "1865360"
  },
  {
    "text": "and because of that this means that behind the scenes we have full RC",
    "start": "1865360",
    "end": "1870600"
  },
  {
    "text": "capabilities if we are able to send commands to devices so we ask the obious",
    "start": "1870600",
    "end": "1876440"
  },
  {
    "text": "question can we actually send commands to devices so I span up my python script",
    "start": "1876440",
    "end": "1882200"
  },
  {
    "text": "added one simple line of an example command and of course it worked we are",
    "start": "1882200",
    "end": "1887639"
  },
  {
    "text": "now able to execute code on any device however like Tomo told you before",
    "start": "1887639",
    "end": "1894440"
  },
  {
    "text": "because we have the cloud and we have 50,000 serial numbers we are able to not only execute code on one device however",
    "start": "1894440",
    "end": "1902039"
  },
  {
    "text": "on all devices all around the world which is pretty",
    "start": "1902039",
    "end": "1907679"
  },
  {
    "text": "huge perfect now let's talk about another kind of attack scenario you see",
    "start": "1907679",
    "end": "1913120"
  },
  {
    "text": "if you would give me the ability to execute code on 50,000 devices I wouldn't know what to do with it and",
    "start": "1913120",
    "end": "1919120"
  },
  {
    "text": "frankly sometimes that's not the best option you see if I want to do a more covert operation and attack and pinpoint",
    "start": "1919120",
    "end": "1926559"
  },
  {
    "text": "attack one specific client that I have interest in it would be way cooler think about it so let's show this kind of",
    "start": "1926559",
    "end": "1934159"
  },
  {
    "text": "attack so let's say about this attack scenario I'm at an airport and I want to hack into the internal airport Wi-Fi now",
    "start": "1934159",
    "end": "1942799"
  },
  {
    "text": "once again I'm out I'm not inside that Network so I can't simply interact with this device",
    "start": "1942799",
    "end": "1948679"
  },
  {
    "text": "however luckily for me I am able to have this uh vulnerability that showcased me",
    "start": "1948679",
    "end": "1954480"
  },
  {
    "text": "before uh so I could hack the device if I get its serial number so here is the",
    "start": "1954480",
    "end": "1961080"
  },
  {
    "text": "scenario I'm at the airport and I a hacker so let's show how I can do it so",
    "start": "1961080",
    "end": "1968120"
  },
  {
    "text": "what we did is actually sniff row Wi-Fi beacons you see whenever you open your phone and try and see what kind of Wi-Fi",
    "start": "1968120",
    "end": "1975840"
  },
  {
    "text": "networks are near you you will find a very big list of everything that's new and how it's done is that behind the",
    "start": "1975840",
    "end": "1981919"
  },
  {
    "text": "scenes every device that distributes Wi-Fi sends something called Wi-Fi Beacon message which is basically a",
    "start": "1981919",
    "end": "1989000"
  },
  {
    "text": "broadcast message over the Wi-Fi wavelength that tells devices hey this is my name this is my specification feel",
    "start": "1989000",
    "end": "1996600"
  },
  {
    "text": "free to connect to me and when we looked at Beacon message sent by roui devices",
    "start": "1996600",
    "end": "2002880"
  },
  {
    "text": "we discovered this interesting thing in the vendor specific data field of the Wi-Fi message now this feed basically",
    "start": "2002880",
    "end": "2010240"
  },
  {
    "text": "allowed the vendors to put whatever they want in it and luckily enough and strangely enough ruigi chose to put the",
    "start": "2010240",
    "end": "2017159"
  },
  {
    "text": "actual access point serial number in the vendor specific data meaning all I need",
    "start": "2017159",
    "end": "2022919"
  },
  {
    "text": "to do is simply sniff Wi-Fi beacons and I get the access to the to the device serial number and I can hack it so we",
    "start": "2022919",
    "end": "2030600"
  },
  {
    "text": "built this interesting open sesame attack where by being physically close to a device let's say I want to hack",
    "start": "2030600",
    "end": "2036399"
  },
  {
    "text": "into an office I simply we go by the office then I sniff the row Wi-Fi beacons lick the serial numbers invoke",
    "start": "2036399",
    "end": "2043320"
  },
  {
    "text": "the cloud vulnerabilities I showcased to before on this pinpoint device and voila I'm in I have access to the internal",
    "start": "2043320",
    "end": "2049638"
  },
  {
    "text": "network of this device cool so that's exactly what we did and then we decided to do the good",
    "start": "2049639",
    "end": "2058118"
  },
  {
    "text": "thing and do the responsible disclosure so we took the entire thing that I showcased to you as far along with a few",
    "start": "2058119",
    "end": "2064320"
  },
  {
    "text": "other vulnerabilities and reported it to ruigi uh luckily for us they took us",
    "start": "2064320",
    "end": "2069398"
  },
  {
    "text": "very seriously uh and implemented a fix basically as soon as possible uh so I",
    "start": "2069399",
    "end": "2075118"
  },
  {
    "text": "can tell you that if you wanted to exploit it sadly you can't uh too bad look for new vulnerabilities there are",
    "start": "2075119",
    "end": "2081638"
  },
  {
    "text": "always some cool so before we finish let's do some very very short takeaways uh",
    "start": "2081639",
    "end": "2088878"
  },
  {
    "text": "basically I believe that the black box that is an iot device that people always",
    "start": "2088879",
    "end": "2093919"
  },
  {
    "text": "said yeah we don't know what's running there we don't know what kind of vulnerabilities are in there it's still there however because of the",
    "start": "2093919",
    "end": "2100520"
  },
  {
    "text": "use of uh vendor specific Cloud platforms sometimes attackers are not need to not need to be actually",
    "start": "2100520",
    "end": "2107000"
  },
  {
    "text": "accessible to devices meaning they don't need to be internet exposed in order to attack the devices by hacking into the",
    "start": "2107000",
    "end": "2113800"
  },
  {
    "text": "vendor's Cloud platform they can reach back and get access to organizations Network which is basically a not bypass",
    "start": "2113800",
    "end": "2120480"
  },
  {
    "text": "vulnerability giving attackers a front door into your network once again",
    "start": "2120480",
    "end": "2126440"
  },
  {
    "text": "because uh we one common vulnerability we find in iot devices is that while",
    "start": "2126440",
    "end": "2132440"
  },
  {
    "text": "user authentication is very good we have all of these platforms device authentication is actually quite hard",
    "start": "2132440",
    "end": "2137960"
  },
  {
    "text": "because device doesn't have an email doesn't have a phone an OTP so vendors should rely on better Secrets than just",
    "start": "2137960",
    "end": "2144800"
  },
  {
    "text": "a device serial number which is easily guessable perfect so I hope you enjoyed",
    "start": "2144800",
    "end": "2150319"
  },
  {
    "text": "our talk H if you have any questions feel free to go into the center of the stage and ask away thank you very much",
    "start": "2150319",
    "end": "2157730"
  },
  {
    "text": "[Applause]",
    "start": "2157730",
    "end": "2165520"
  },
  {
    "text": "hi uh thank you for the great SE now um what was the vendor patch for the device",
    "start": "2165520",
    "end": "2171160"
  },
  {
    "text": "provisioning problem that you guys discovered so some vulnerabilities are simple fixes like for example the uh",
    "start": "2171160",
    "end": "2178280"
  },
  {
    "text": "wild card or the ability to send messages impersonating the cloud this is an easy fix which is simply doing ACL",
    "start": "2178280",
    "end": "2185440"
  },
  {
    "text": "some vulnerabilities are a little bit harder because they architectural designs H there were some fixes",
    "start": "2185440",
    "end": "2192400"
  },
  {
    "text": "regarding the actual architecture they're still relying on some how to identifiers however they do it more",
    "start": "2192400",
    "end": "2198359"
  },
  {
    "text": "securely uh uh I cannot say exactly what",
    "start": "2198359",
    "end": "2203800"
  },
  {
    "text": "was the change uh because I'm not aware of their internal infrastructure they still do rely on",
    "start": "2203800",
    "end": "2209880"
  },
  {
    "text": "hard identifiers in at some point of Point yeah thank you one last question um the other CVS that you guys found um",
    "start": "2209880",
    "end": "2217680"
  },
  {
    "text": "they also using the same mqtt channel to exploit other type of commands that you",
    "start": "2217680",
    "end": "2222960"
  },
  {
    "text": "could send except the CMD so the other CVS it's wide range some vulnerabilities",
    "start": "2222960",
    "end": "2228119"
  },
  {
    "text": "are on the device for example the local RC that toer showed you uh some vulnerabilities are uh in the device",
    "start": "2228119",
    "end": "2234720"
  },
  {
    "text": "Cloud communication protocol uh and some CVS are for the ability to wir tap the",
    "start": "2234720",
    "end": "2241200"
  },
  {
    "text": "actually all Cloud messages so it's it's a wide range uh basically the main main",
    "start": "2241200",
    "end": "2248359"
  },
  {
    "text": "command type is OS commands to devices so we did not issue multiple CVS on that",
    "start": "2248359",
    "end": "2253920"
  },
  {
    "text": "regard thank you very much app thank you another question",
    "start": "2253920",
    "end": "2260520"
  },
  {
    "text": "someone perfect so I hope you enjoyed our talk and thank you very much",
    "start": "2261760",
    "end": "2267960"
  }
]