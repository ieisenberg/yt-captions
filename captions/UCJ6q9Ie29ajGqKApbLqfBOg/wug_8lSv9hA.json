[
  {
    "text": "thanks everyone for coming back after dinner or lunch even we appreciate people being here so we're here to talk",
    "start": "299",
    "end": "7770"
  },
  {
    "text": "about a bunch of if I research that we did and this is actually a recently updated version of the work we release",
    "start": "7770",
    "end": "14849"
  },
  {
    "text": "some of this back in October time and we've updated a lot of this for the high",
    "start": "14849",
    "end": "20760"
  },
  {
    "text": "sierra release and a lot of the changes that came in with 10:13 so a bunch of new content in here today as well as a",
    "start": "20760",
    "end": "27000"
  },
  {
    "text": "bunch of analysis on some of the API is that we released to help with some of the problems that we've identified and",
    "start": "27000",
    "end": "32279"
  },
  {
    "text": "we can get a lot of information out from the uses of those API is that we hope is",
    "start": "32279",
    "end": "37829"
  },
  {
    "text": "going to be interesting as well so hey Wally hi everyone my name's Tim",
    "start": "37829",
    "end": "43110"
  },
  {
    "text": "Pangburn I'm an iron key engineer with duo I work in the dual apps group I do R&D",
    "start": "43110",
    "end": "49489"
  },
  {
    "text": "obviously because my title like to reverse engineer and break things that are Apple specifically Mac OS stuff also",
    "start": "49489",
    "end": "57120"
  },
  {
    "text": "we're recovering Mac admin which explains why I want to break Macs and I",
    "start": "57120",
    "end": "62219"
  },
  {
    "text": "also maintain a couple of open source tools that are used pretty frequently along among the mag admin crowd and my",
    "start": "62219",
    "end": "70080"
  },
  {
    "text": "name rich Smith a little bit easier to remember them the pines name as you can tell by my accent I spend my time",
    "start": "70080",
    "end": "75720"
  },
  {
    "text": "between New York Detroit and Reykjavik so actually the first time I came back to the UK in many many years so it's",
    "start": "75720",
    "end": "82320"
  },
  {
    "text": "nice to be back at least for like 36 hours for a run away again so I'm director of R&D at dual apps I do",
    "start": "82320",
    "end": "88380"
  },
  {
    "text": "laps it's the research arm of duo security which you probably know for kind of do a push in a lot of multi-factor authentication stuff also",
    "start": "88380",
    "end": "95549"
  },
  {
    "text": "co-founder of cinders which is a red team company out of Iceland's my research tends to be around post",
    "start": "95549",
    "end": "102420"
  },
  {
    "text": "exploitation a lot of frameworks in that space I enjoy firmware obviously Python",
    "start": "102420",
    "end": "107909"
  },
  {
    "text": "and like some large-scale internet scale research studies where we're looking at empirical data so enough about us",
    "start": "107909",
    "end": "114149"
  },
  {
    "text": "actually get into the work so before we dig into the details what's kind of the TLDR like what was in our heads when we",
    "start": "114149",
    "end": "119969"
  },
  {
    "text": "started this work when we actually start to put a lot of time into this so accomplices like blackhat like Def Con",
    "start": "119969",
    "end": "126079"
  },
  {
    "text": "CCC there's been loads of great efi vulnerabilities that have been worked on lots of great offensive work that has",
    "start": "126079",
    "end": "132569"
  },
  {
    "text": "been done find lots of problems we were interested in then how are those for vendor responses",
    "start": "132569",
    "end": "137830"
  },
  {
    "text": "that address those problems making it in reality like who was actually patching",
    "start": "137830",
    "end": "142990"
  },
  {
    "text": "the issues that had been found and when those patches were released how well were they getting applied into the real",
    "start": "142990",
    "end": "148240"
  },
  {
    "text": "world so that was really what started our work here and led the approach that",
    "start": "148240",
    "end": "153430"
  },
  {
    "text": "we took and really extending out from EFI security we really wanted to extend",
    "start": "153430",
    "end": "159970"
  },
  {
    "text": "a lot of questions that we had around how firmware security mapped up against software security so over the last",
    "start": "159970",
    "end": "167320"
  },
  {
    "text": "number of years there's been a lot of mantra around kind of keep things patched pushing on vendors to actually",
    "start": "167320",
    "end": "172600"
  },
  {
    "text": "release updates in a timely manner and you know the mantra that a lot of people get is if you're keeping your things up-to-date you're going to be running",
    "start": "172600",
    "end": "178870"
  },
  {
    "text": "faster than most bears you're going to be okay if you're going to do nothing else keep things up today we wanted to",
    "start": "178870",
    "end": "184330"
  },
  {
    "text": "measure how well that actually Maps who firmware space so we favor software",
    "start": "184330",
    "end": "189430"
  },
  {
    "text": "Security's got to a much better place than it has been in terms of the availability and how well people are",
    "start": "189430",
    "end": "196030"
  },
  {
    "text": "going about installing patches we wanted to I said a lot of the similar questions about firmware security and see whether",
    "start": "196030",
    "end": "201850"
  },
  {
    "text": "it was kind of on par with software security or it was fallen well behind so the super Tod are on a lot of the",
    "start": "201850",
    "end": "208120"
  },
  {
    "text": "research that we did we analyzed all of the OS security updates that Apple had",
    "start": "208120",
    "end": "214000"
  },
  {
    "text": "released really over the last three to four years from ten ten through to ten thirteen this gives us an insight into",
    "start": "214000",
    "end": "219400"
  },
  {
    "text": "what was being fixed at the efi and firmware layer then we also got data",
    "start": "219400",
    "end": "225220"
  },
  {
    "text": "from more than 73,000 real-world systems and then we were able to map the efficacy of what Apple had released to",
    "start": "225220",
    "end": "233620"
  },
  {
    "text": "what was actually deployed in the wild and as we'll go into how Apple releases its efi updates is very closely bound to",
    "start": "233620",
    "end": "240850"
  },
  {
    "text": "the software updates that it releases so we should have a one-to-one mapping between the expected state of security",
    "start": "240850",
    "end": "246520"
  },
  {
    "text": "software and the expected state of the security of the firmware and we found quite divergent States in that what",
    "start": "246520",
    "end": "251560"
  },
  {
    "text": "that's what led to a lot of our other work but this was really the TLDR for what drive a lot of our research the",
    "start": "251560",
    "end": "257680"
  },
  {
    "text": "comparison between firmware security and software security and trying to make sure that we understood how well patches",
    "start": "257680",
    "end": "263440"
  },
  {
    "text": "that had been released were actually landing on real boxes which brings us to our next question why",
    "start": "263440",
    "end": "269620"
  },
  {
    "text": "Apple like why are we ragging on Apple for this well we're not in in reality it turns out with pretty lazy researchers",
    "start": "269620",
    "end": "276540"
  },
  {
    "text": "Apple controls the whole stack so they control Hardware right away through to software obviously including the",
    "start": "276540",
    "end": "283150"
  },
  {
    "text": "firmware in between and this vertical integration that Apple controls gives us a much more manageable data set to",
    "start": "283150",
    "end": "288669"
  },
  {
    "text": "answer some of these questions by on the wind cell side of the world it's definitely more fragmented it's a much",
    "start": "288669",
    "end": "295300"
  },
  {
    "text": "more heterogeneous environment and and that just means that the data and analysis that we do is much more complex",
    "start": "295300",
    "end": "301690"
  },
  {
    "text": "so we got lazy we start off with the easy data set there is nothing to say that the work that we've done doesn't",
    "start": "301690",
    "end": "306910"
  },
  {
    "text": "apply equally to the wind tail world and from the small amount of work that we've done in a wind tail space we believe",
    "start": "306910",
    "end": "313360"
  },
  {
    "text": "strongly believe that the state of EFI security in the winter world is much",
    "start": "313360",
    "end": "318610"
  },
  {
    "text": "much much worse than in the Apple world we spoke with Apple from the earliest",
    "start": "318610",
    "end": "323830"
  },
  {
    "text": "days of our findings so way back in kind of June of this year they've been great to work with they've responded very well",
    "start": "323830",
    "end": "329889"
  },
  {
    "text": "they've built up a world-class firmware security team at Apple so we actually believe despite some of the issues that",
    "start": "329889",
    "end": "335650"
  },
  {
    "text": "we have found they're actually leading the way with the way that vendors are thinking about efi security in",
    "start": "335650",
    "end": "341380"
  },
  {
    "text": "particular and the way that they're going about trying to keep their firmware in in lockstep with their",
    "start": "341380",
    "end": "347560"
  },
  {
    "text": "software and with respect to security so yeah we write down apple but that wasn't really the point in the reason that we",
    "start": "347560",
    "end": "354220"
  },
  {
    "text": "focused on Apple was it was the easiest dataset for us to analyze so quick",
    "start": "354220",
    "end": "359770"
  },
  {
    "text": "overview of what we're going to cover we're going to take you through kind of an EFI 101 where we're a whether or not",
    "start": "359770",
    "end": "364810"
  },
  {
    "text": "everybody is super super familiar with EFI we're going to talk about some apple specifics on efi as well how the updates",
    "start": "364810",
    "end": "371979"
  },
  {
    "text": "are applied how things are we flushed and just essentially give you some context around which the work is based",
    "start": "371979",
    "end": "377590"
  },
  {
    "text": "then we're going to dig into the newer work you know what we did what we found what you can do and things that we've",
    "start": "377590",
    "end": "383650"
  },
  {
    "text": "released to try and make your lives a little bit easier and gather more information about the problem as well in",
    "start": "383650",
    "end": "389139"
  },
  {
    "text": "the course of that so / 2 / pine so hopefully I don't have to go into too",
    "start": "389139",
    "end": "396789"
  },
  {
    "text": "much to great detail as far as what if I does what it stands for former interface so we run three days",
    "start": "396789",
    "end": "404390"
  },
  {
    "text": "pretty quickly I want to focus on how Apple has been using this so far so I",
    "start": "404390",
    "end": "410510"
  },
  {
    "text": "think we're pretty aware that EFI is running on a lot of devices nowadays as part of the the lower level management",
    "start": "410510",
    "end": "416660"
  },
  {
    "text": "systems that are part of many systems these days so Intel start working on",
    "start": "416660",
    "end": "424400"
  },
  {
    "text": "their their version of EFI to mid-1990s to replace the aging and severely",
    "start": "424400",
    "end": "430760"
  },
  {
    "text": "lacking bios lacking for a number of reasons 32-bit had very limited storage",
    "start": "430760",
    "end": "436940"
  },
  {
    "text": "capabilities it was generally time for a replacement they worked enough for a little bit and then in 2005 the UEFI standard was was",
    "start": "436940",
    "end": "446840"
  },
  {
    "text": "initiated Intel joined the ufi group to add that work that they had already done",
    "start": "446840",
    "end": "453290"
  },
  {
    "text": "to come up with the unified efi standard and apple as such started using efi for",
    "start": "453290",
    "end": "461390"
  },
  {
    "text": "their own products in 2006 why was that why did apple actually need to switch or",
    "start": "461390",
    "end": "467060"
  },
  {
    "text": "chose to switch so 2006 if you remember is also the year that the first Intel",
    "start": "467060",
    "end": "472280"
  },
  {
    "text": "powered Mac shipped so Apple needed to make some other major changes besides the the lower level systems they were",
    "start": "472280",
    "end": "478910"
  },
  {
    "text": "using they could no longer use open firmware which was at that point a PowerPC legend like legacy so they",
    "start": "478910",
    "end": "485570"
  },
  {
    "text": "couldn't really make that work that was in part of the Intel platform so they switched to EFI first models a chip iMac",
    "start": "485570",
    "end": "493670"
  },
  {
    "text": "MacBook Pro and that quickly spread to all the other systems and it needs to",
    "start": "493670",
    "end": "498800"
  },
  {
    "text": "support a number of Mac specific things like net boot which is where you hold on",
    "start": "498800",
    "end": "503870"
  },
  {
    "text": "a key and it will actually find a network boot very similar to a pixie and also internet restore which is a sort of",
    "start": "503870",
    "end": "510740"
  },
  {
    "text": "an internet powered version of that and it is just like open firmware in any",
    "start": "510740",
    "end": "517070"
  },
  {
    "text": "other of these systems where in the past it is entirely visible to end user so they most users are not aware that this",
    "start": "517070",
    "end": "522229"
  },
  {
    "text": "is even a thing or something they they need to to care about why should they",
    "start": "522229",
    "end": "527510"
  },
  {
    "text": "care so why should they care good question so from an attackers perspective why is EFI even an interesting target to attack",
    "start": "527510",
    "end": "534980"
  },
  {
    "text": "and kind of for me breaks down into these three areas earlier there was an earlier talk today with discussing a lot",
    "start": "534980",
    "end": "541850"
  },
  {
    "text": "of the Intel Emmy background and there was a much prettier pyramid on that talking about the various levels of the",
    "start": "541850",
    "end": "548570"
  },
  {
    "text": "system interface with respect to EFI that the important thing is is this here",
    "start": "548570",
    "end": "554060"
  },
  {
    "text": "like where this sits beneath the applications in the OS and even the hypervisor so ring three and brings",
    "start": "554060",
    "end": "559610"
  },
  {
    "text": "arrow or the traditional Intel protection rings that we've that we've heard about these kind of made-up rings",
    "start": "559610",
    "end": "564620"
  },
  {
    "text": "rings - one - two - three depending on whose model that you're using really are",
    "start": "564620",
    "end": "569720"
  },
  {
    "text": "just indicating layers of the system which operate beneath the traditional protection ring layers and the lower",
    "start": "569720",
    "end": "576710"
  },
  {
    "text": "down this stack you go the more information that you can get from the upper layers anything lowdown should be able to with a small number of caveats",
    "start": "576710",
    "end": "583250"
  },
  {
    "text": "access anything above it there are interfaces that are allow higher levels",
    "start": "583250",
    "end": "589130"
  },
  {
    "text": "to get access to some of the information from the lower level level interfaces but they tend to be much more",
    "start": "589130",
    "end": "595160"
  },
  {
    "text": "restrictive so if you've successfully attacked EFI if you've managed to get your code running in EFI this means that",
    "start": "595160",
    "end": "602450"
  },
  {
    "text": "you can affect and interrogate anything at the layer above it to the TLDR of this would be you can affect effectively",
    "start": "602450",
    "end": "609560"
  },
  {
    "text": "read or write any memory location room any disk location with a couple of caveats around SMM Intel Emmy within the",
    "start": "609560",
    "end": "619010"
  },
  {
    "text": "stack so if you've run in and compromised efi you've kind of got keys to the kingdom so from an attackers perspective you can",
    "start": "619010",
    "end": "625850"
  },
  {
    "text": "do most anything if you manage to get your code running in the efi level that's that's pretty cool then there's",
    "start": "625850",
    "end": "633020"
  },
  {
    "text": "these two other aspects which are actually really quite key to this that the stealth aspect of efi is if you",
    "start": "633020",
    "end": "639440"
  },
  {
    "text": "compromise somebody's efi it's actually incredibly difficult for them to tell it's not impossible but the amount of",
    "start": "639440",
    "end": "644570"
  },
  {
    "text": "work that's required to determine that you have compromised the FI is significant a lot of that becomes the",
    "start": "644570",
    "end": "650839"
  },
  {
    "text": "security software that people are using or it is either happening at ring-ring three o-rings zero from those layers",
    "start": "650839",
    "end": "656060"
  },
  {
    "text": "essentially efi running at two layers beneath that can lie any introspection that will be coming from those layers of",
    "start": "656060",
    "end": "662660"
  },
  {
    "text": "the system if i if it's trying to be evasive could could lie to those higher-level layer",
    "start": "662660",
    "end": "668060"
  },
  {
    "text": "the system and enables it to be very stealthy if you pull the chip off the",
    "start": "668060",
    "end": "673280"
  },
  {
    "text": "board and interrogate the contents of the SP flesh then yep you could start to diff out and see that you were running",
    "start": "673280",
    "end": "679370"
  },
  {
    "text": "code that you probably weren't expecting to but that level of introspection requires physical access to a system you",
    "start": "679370",
    "end": "685760"
  },
  {
    "text": "know very very difficult compared to most other compromisers to realize that you run in compromise there efi code and",
    "start": "685760",
    "end": "691640"
  },
  {
    "text": "then equally the the persistence part if i've managed to get my attack code in",
    "start": "691640",
    "end": "698240"
  },
  {
    "text": "for the efi layer it's pretty difficult to remove me so often people will say things like you know reinstall your OS",
    "start": "698240",
    "end": "704780"
  },
  {
    "text": "well that's not going to remove me from from the efi portion because i'm in spy flash it's also if you completely rip",
    "start": "704780",
    "end": "712700"
  },
  {
    "text": "out the disk and put a new disk in I'm still in the flesh so the persistence level combined with the stealth level",
    "start": "712700",
    "end": "718190"
  },
  {
    "text": "combined with the ability to access most every aspect of the system actually makes efi attract attacks very",
    "start": "718190",
    "end": "725660"
  },
  {
    "text": "attractive for sophisticated adversaries and this is why we've seen a lot of research in the space because once",
    "start": "725660",
    "end": "731960"
  },
  {
    "text": "you've got this it kind of is keys to the kingdom but the caveat really is who would want to attack efi this is this is",
    "start": "731960",
    "end": "739400"
  },
  {
    "text": "not a script kiddie situation we're not going to see this as part of drive-by",
    "start": "739400",
    "end": "744830"
  },
  {
    "text": "web browser attacks there's seen in well-funded adversaries from the same breath that were saying kind of nation-states and industrial",
    "start": "744830",
    "end": "751250"
  },
  {
    "text": "espionage this is the kind of tool sophisticated targeted attacks we're not talking about just indiscriminate",
    "start": "751250",
    "end": "757190"
  },
  {
    "text": "internet wide attacks so in terms of threat model often at these kind of conferences people like to stand up and",
    "start": "757190",
    "end": "763430"
  },
  {
    "text": "say you know disguise falling and whatever we found is like the worst thing in the world ever and try and get some press out of it specifically with",
    "start": "763430",
    "end": "770000"
  },
  {
    "text": "this level of attack really is focused on sophisticated adversaries and expect",
    "start": "770000",
    "end": "775130"
  },
  {
    "text": "they're not included within your threat model if your threat model doesn't need to compensate for my set probably not",
    "start": "775130",
    "end": "781580"
  },
  {
    "text": "going to lose sleep over the fact that the efi is not being updated in the way",
    "start": "781580",
    "end": "787130"
  },
  {
    "text": "that we would expect and we dig in to that more later but having the context of the threat model is important when",
    "start": "787130",
    "end": "792200"
  },
  {
    "text": "you're thinking about new work that's being discussed so we've spoken a little bit about the",
    "start": "792200",
    "end": "798620"
  },
  {
    "text": "historically if I work that other done the it's like the highest-level quickest overview of some of the biggest work",
    "start": "798620",
    "end": "805940"
  },
  {
    "text": "that's been in the space kind of all started with snare a us black cat back",
    "start": "805940",
    "end": "811160"
  },
  {
    "text": "in 2012 he did some of the first work showing that a doctored Thunderbolt",
    "start": "811160",
    "end": "816230"
  },
  {
    "text": "adapter could be used to overwrite and inject arbitrary code into EFI this was the first work that I'm aware of at",
    "start": "816230",
    "end": "822980"
  },
  {
    "text": "least and it took to start to take place there and then we're kind of jumping around in timeline so sonic screwdriver",
    "start": "822980",
    "end": "829910"
  },
  {
    "text": "this was out earlier this year as part of the Volks 7 kind of WikiLeaks dump it is common is that commonly believed",
    "start": "829910",
    "end": "837590"
  },
  {
    "text": "knowledge that this dump reflects something that came out of the CIA and also from all the analysis that have",
    "start": "837590",
    "end": "844010"
  },
  {
    "text": "been done on the areas it people believe that this work that the sonic",
    "start": "844010",
    "end": "849500"
  },
  {
    "text": "screwdriver work was really a weaponized implementation of what snare spoke about in 2012 then we start to get like a",
    "start": "849500",
    "end": "856250"
  },
  {
    "text": "couple of years head trauma Hudson is going nuts with Thunder strike one really extending on a lot of what snare",
    "start": "856250",
    "end": "863540"
  },
  {
    "text": "did Thunder strike two took it to a whole new level because now this was a software based attack up until this",
    "start": "863540",
    "end": "869150"
  },
  {
    "text": "point a sonic screwdriver Thunder strike one schnauzer original work this all",
    "start": "869150",
    "end": "874310"
  },
  {
    "text": "required physical access to the system to plug something in abuse some DNA privileges take advantage of some",
    "start": "874310",
    "end": "880370"
  },
  {
    "text": "problems with AFI and then get your code running in the efi thunderstruck to to bank the software domain you didn't need",
    "start": "880370",
    "end": "887180"
  },
  {
    "text": "to have physical access to the system you could do it all from software space which is pretty incredible at Stram or",
    "start": "887180",
    "end": "895010"
  },
  {
    "text": "Zeno Cova quarry kallenberg check out the work it's a it's an incredibly",
    "start": "895010",
    "end": "900110"
  },
  {
    "text": "elegant piece of research and this tucked into the software space and really at this point and papaya will go",
    "start": "900110",
    "end": "906380"
  },
  {
    "text": "into this a little bit more later thunderstrike tube was a point in time that Apple significantly changed the way",
    "start": "906380",
    "end": "911870"
  },
  {
    "text": "that they approached patching efi and how seriously they took AFI security so it's definitely a line in the sand all",
    "start": "911870",
    "end": "918800"
  },
  {
    "text": "frisk was also done some amazing work PCI leach and a lot of the DMA attacks less focus specifically on attacking efi",
    "start": "918800",
    "end": "927230"
  },
  {
    "text": "itself be using some misconfigurations and some some aspects of the efi to get",
    "start": "927230",
    "end": "933410"
  },
  {
    "text": "what he needed to do Don really this work the PCI a PCI DMA attack work enabled him to extract a",
    "start": "933410",
    "end": "941689"
  },
  {
    "text": "firewall to key from the disk I'm so essentially circumventing full full volume encryption that the standard full",
    "start": "941689",
    "end": "950329"
  },
  {
    "text": "volume encryption that comes shipping with max loads of other cool EFI research as well definitely check out",
    "start": "950329",
    "end": "955670"
  },
  {
    "text": "Pedro's work but if you want a background on on EFI security and a lot",
    "start": "955670",
    "end": "961309"
  },
  {
    "text": "of the research that's been done so far like check out these references it's all fantastic work this was a background",
    "start": "961309",
    "end": "966829"
  },
  {
    "text": "against which we wanted to measure how well patches were actually being implemented in the wild so now we have a",
    "start": "966829",
    "end": "976639"
  },
  {
    "text": "little bit of a background of what we're trying to protect against then why is important we wanted to you know understand how apple patches their",
    "start": "976639",
    "end": "983959"
  },
  {
    "text": "systems against all this so like rich said 2015 was kind of a watershed moment",
    "start": "983959",
    "end": "989959"
  },
  {
    "text": "for Apple they needed to be get a lot more serious about if I updates prior to that if I updates were manual process",
    "start": "989959",
    "end": "997269"
  },
  {
    "text": "there was a separate applications the end user downloads runs it gives instructions on shutting the Mac down",
    "start": "997269",
    "end": "1004240"
  },
  {
    "text": "surrounding it back up holding holding down a power button waiting for a long beep etc etc that is not very scalable",
    "start": "1004240",
    "end": "1010540"
  },
  {
    "text": "when you manage the tens or thousands of of Macs and it was mostly ignored by",
    "start": "1010540",
    "end": "1016509"
  },
  {
    "text": "most folks that that that either home users or anyone who manages Mac fleets because it's kind of cumbersome and not",
    "start": "1016509",
    "end": "1023199"
  },
  {
    "text": "really it doesn't it didn't get a lot of attention from Apple 2015 or the after",
    "start": "1023199",
    "end": "1029860"
  },
  {
    "text": "thunderstrike era so I like to call it Apple needed to make some changes because they needed to get this stuff",
    "start": "1029860",
    "end": "1034928"
  },
  {
    "text": "out there and not just wait for for users to go through this system so since",
    "start": "1034929",
    "end": "1040480"
  },
  {
    "text": "then Apple has shipped EFI from our updates together with OS and security updates how that works is that they",
    "start": "1040480",
    "end": "1046390"
  },
  {
    "text": "embed a separate standard Apple pkg a package installer inside the OS installer that contains all of the efi",
    "start": "1046390",
    "end": "1054520"
  },
  {
    "text": "bundles either escaped or FD bundles in the process of applying an OS or security update this this update are",
    "start": "1054520",
    "end": "1062049"
  },
  {
    "text": "also runs and through a number of implications of",
    "start": "1062049",
    "end": "1067090"
  },
  {
    "text": "tools that are built for this EFI update is one it actually lines up it checks",
    "start": "1067090",
    "end": "1072460"
  },
  {
    "text": "whether an update needs to be done and it lines up an update if so and in a",
    "start": "1072460",
    "end": "1077860"
  },
  {
    "text": "more graphical explanation of this scan how that works so the larger OS install",
    "start": "1077860",
    "end": "1084960"
  },
  {
    "text": "fires off the firmware update kicks off in post installed that does the work of",
    "start": "1084960",
    "end": "1090100"
  },
  {
    "text": "determining whether an update is required and uses the blast command to set some NVRAM variables as well as",
    "start": "1090100",
    "end": "1096250"
  },
  {
    "text": "copying the updated if I firmware payload to the ESP volume called",
    "start": "1096250",
    "end": "1102760"
  },
  {
    "text": "volumes efi on Mac OS and once that's all done it waits for a reboot in the next reboot a if I update our",
    "start": "1102760",
    "end": "1110409"
  },
  {
    "text": "application actually boots and does the work important to to note here that this",
    "start": "1110409",
    "end": "1116049"
  },
  {
    "text": "is a one-time deal so the updater gets one chance and if it doesn't doesn't work as we see later",
    "start": "1116049",
    "end": "1121779"
  },
  {
    "text": "there is not much not much visibility into that so how does that updater",
    "start": "1121779",
    "end": "1130510"
  },
  {
    "text": "actually figure out what to install I said there's a number of files from our payloads that ship how does the updater",
    "start": "1130510",
    "end": "1137500"
  },
  {
    "text": "figure out how that works so they have to ship a lot of these payloads there's every model have its own file how does",
    "start": "1137500",
    "end": "1143529"
  },
  {
    "text": "this work so somehow the efi payload contain this info and how does the updater know so a",
    "start": "1143529",
    "end": "1150909"
  },
  {
    "text": "real quick breeze through how apple can tell models apart so you may know of the",
    "start": "1150909",
    "end": "1156130"
  },
  {
    "text": "slightly more consumer-friendly way of identifying Mac's they use a model name",
    "start": "1156130",
    "end": "1163840"
  },
  {
    "text": "and that name number that kind of picks up with either the generations so 17",
    "start": "1163840",
    "end": "1169570"
  },
  {
    "text": "comma 1 in this example name a new comma 2 comma 3 depending on sometimes screen sizes sometimes some other CPU",
    "start": "1169570",
    "end": "1176440"
  },
  {
    "text": "configurations but that was overlap they may they may refer to multiple different",
    "start": "1176440",
    "end": "1182200"
  },
  {
    "text": "generations of hardware so what Apple uses internally is called the board ID which is a NATO or 16 character hex",
    "start": "1182200",
    "end": "1189130"
  },
  {
    "text": "string with the maca - and those are actually you need to every not model that they",
    "start": "1189130",
    "end": "1194340"
  },
  {
    "text": "ship so that that is how Apple keeps track of what what models and when you see when you look down here you can",
    "start": "1194340",
    "end": "1201570"
  },
  {
    "text": "actually see that the iMac used to have a laser anyway",
    "start": "1201570",
    "end": "1206850"
  },
  {
    "text": "I max Amini comma one actually covers three different board IDs so it's important to know that that is not",
    "start": "1206850",
    "end": "1213450"
  },
  {
    "text": "specific enough so how does the you fire up data actually figure out what to use so if I pay low it actually contains",
    "start": "1213450",
    "end": "1220470"
  },
  {
    "text": "board IDs in a specific goo it so in this case this good here we just cracked",
    "start": "1220470",
    "end": "1226740"
  },
  {
    "text": "open EF eyes and started looking for references and that is where they are stored so there's a header there and it",
    "start": "1226740",
    "end": "1232920"
  },
  {
    "text": "by chunks are basically used to record the the compatible board IDs for these",
    "start": "1232920",
    "end": "1239550"
  },
  {
    "text": "which are done grabbed by the IO registry API and if a match is found",
    "start": "1239550",
    "end": "1244680"
  },
  {
    "text": "between the system the updater is running on and that which is contained in DF I payload we have a match and the",
    "start": "1244680",
    "end": "1252590"
  },
  {
    "text": "there's a little caveat here in that some models to different physical models",
    "start": "1252590",
    "end": "1258120"
  },
  {
    "text": "use the same efi bundle and that is covered by the fact that the this particular GU it can hold up to 15 board",
    "start": "1258120",
    "end": "1264900"
  },
  {
    "text": "IDs so if there's more than one listed that same single payload file actually",
    "start": "1264900",
    "end": "1270000"
  },
  {
    "text": "applies to multiple multiple models so that is how they kind of try to constrain how many actual physical files",
    "start": "1270000",
    "end": "1277170"
  },
  {
    "text": "they need to to ship for QA reasons we find out later that that can also get",
    "start": "1277170",
    "end": "1282990"
  },
  {
    "text": "into some trouble visually speaking this is kinda how this works so the the the",
    "start": "1282990",
    "end": "1289200"
  },
  {
    "text": "the tool runs does a check of the board idea of the running system in rates over",
    "start": "1289200",
    "end": "1294570"
  },
  {
    "text": "the EFI files figures out which one is the matching one and does the rest of the work of assigning to EFI firmware",
    "start": "1294570",
    "end": "1301190"
  },
  {
    "text": "which ultimately ends in a reboot and application of the firmware we updated",
    "start": "1301190",
    "end": "1309180"
  },
  {
    "text": "this this research also a little bit with some some of the new new things found in 1013 regarding efi so apples",
    "start": "1309180",
    "end": "1315900"
  },
  {
    "text": "shipping a new tool called if I check this tool is not meant to actually check",
    "start": "1315900",
    "end": "1322250"
  },
  {
    "text": "version mismatches it is an integrity checking to see no Cova which was mentioned before it's now",
    "start": "1322250",
    "end": "1328610"
  },
  {
    "text": "on the other side of the fence he now works for Apple trying to improve that EFI picture and this is one of the first",
    "start": "1328610",
    "end": "1334399"
  },
  {
    "text": "things that he that he worked out he actually had a pretty lengthy tweet",
    "start": "1334399",
    "end": "1339769"
  },
  {
    "text": "storm before he had to probably delete it where he tried to explain what this",
    "start": "1339769",
    "end": "1345110"
  },
  {
    "text": "sort of like inscrutable dialogue that may come up on your on your Mac under 10:13 XA means so if I check has a",
    "start": "1345110",
    "end": "1352070"
  },
  {
    "text": "whitelist bundle of checksums of all known if I to Apple and it turns out",
    "start": "1352070",
    "end": "1358249"
  },
  {
    "text": "Apple knows about a lot more reifies I mean we know about if that checks them somehow doesn't match you get a dialog",
    "start": "1358249",
    "end": "1365149"
  },
  {
    "text": "as seen below there that says you haven't might have a potential problem would you like to submit this Apple that",
    "start": "1365149",
    "end": "1370759"
  },
  {
    "text": "will actually submit the checksum to Apple so that they might augment their",
    "start": "1370759",
    "end": "1375769"
  },
  {
    "text": "data or possibly because there is code in there that's not expected but generally speaking Apple is working on",
    "start": "1375769",
    "end": "1381259"
  },
  {
    "text": "making this you know getting more visibility as well as making this a higher priority showing that efi is",
    "start": "1381259",
    "end": "1387440"
  },
  {
    "text": "actually on their on their list of things to worry about so you ax not great yet hopefully this",
    "start": "1387440",
    "end": "1393679"
  },
  {
    "text": "will get better over time if they have some privacy issues to deal with as well they can't just grab this data and exel",
    "start": "1393679",
    "end": "1398990"
  },
  {
    "text": "trait that without telling you so that's that's what they're doing because of",
    "start": "1398990",
    "end": "1404119"
  },
  {
    "text": "10:13 a PFS was rolled out across the board they had to update some models that had not seen any updates since 2015",
    "start": "1404119",
    "end": "1411200"
  },
  {
    "text": "so they needed to ship and update it for an additional DXE driver essentially in",
    "start": "1411200",
    "end": "1417860"
  },
  {
    "text": "order before you fight to actually be able to read from a PFA PFS all Yume's so this means that a couple of models",
    "start": "1417860",
    "end": "1423379"
  },
  {
    "text": "that so far have not gotten updates yet gotten updates the model their older",
    "start": "1423379",
    "end": "1428570"
  },
  {
    "text": "iMac MacBook Pro and the Mac Pro Mac Pro is a special special case because it is",
    "start": "1428570",
    "end": "1434299"
  },
  {
    "text": "not able to be updated automatically it actually has to fall back to the manual of the manual procedure that I reference",
    "start": "1434299",
    "end": "1440990"
  },
  {
    "text": "to before what this means is that when you install Mac OS 10 10 13 on these",
    "start": "1440990",
    "end": "1447559"
  },
  {
    "text": "machines they will actually show this dialog below that make you go through the manual system again so you actually",
    "start": "1447559",
    "end": "1452690"
  },
  {
    "text": "have to click the shutdown button hold down the power button on it and wait for the beep so it kind of",
    "start": "1452690",
    "end": "1459020"
  },
  {
    "text": "falls back to that but that's a one-time thing doesn't quite scale as well either so we'll see how that works out in the",
    "start": "1459020",
    "end": "1464540"
  },
  {
    "text": "field and it just basically goes through detects the model check see a 5 version loads a a plugin that deals with this",
    "start": "1464540",
    "end": "1471170"
  },
  {
    "text": "and then does the same blessing as before but it is a manual process those are some of the new things in in 1013",
    "start": "1471170",
    "end": "1478010"
  },
  {
    "text": "that we that we found we didn't find any security updates that we can tell in those if I update sort of older models",
    "start": "1478010",
    "end": "1483830"
  },
  {
    "text": "purely aimed at a PFS compatibility which I was a lot of vfi backgrounds as",
    "start": "1483830",
    "end": "1492530"
  },
  {
    "text": "well as Apple EFI background and we realize that it's kind of like a blitz so get back over the slides and kind of",
    "start": "1492530",
    "end": "1498500"
  },
  {
    "text": "dig in on particular goods if you're into so now we've got the context out",
    "start": "1498500",
    "end": "1504320"
  },
  {
    "text": "the way what the hell did we do so like I said a lot of what we were looking at was to shine some light into my security",
    "start": "1504320",
    "end": "1511010"
  },
  {
    "text": "else as opposed to software security it's like a lot of you know any research starts out with hypotheses and questions",
    "start": "1511010",
    "end": "1517430"
  },
  {
    "text": "and these are a bunch of our questions in a pine walked us through how the EFI",
    "start": "1517430",
    "end": "1523540"
  },
  {
    "text": "updates are contained within the larger OS and security updates released from Apple do they work you know when we try",
    "start": "1523540",
    "end": "1531980"
  },
  {
    "text": "and install them do they take every time our equivalent efi updates released for",
    "start": "1531980",
    "end": "1537080"
  },
  {
    "text": "all support hardware or is some hardware treated differently than others similarly are some versions of the OS",
    "start": "1537080",
    "end": "1542240"
  },
  {
    "text": "treated differently than other versions of the OS an EFI is independent of the OS so there's no reason that if Vanar",
    "start": "1542240",
    "end": "1549200"
  },
  {
    "text": "abilities being addressed in EFI for for a particular problem that's been found",
    "start": "1549200",
    "end": "1554330"
  },
  {
    "text": "that should be equally delivered across you know any version of the OS so Apple is continues support and then obviously",
    "start": "1554330",
    "end": "1562070"
  },
  {
    "text": "you know we can see what Apple is releasing based on different hardware types based on different OS types what",
    "start": "1562070",
    "end": "1570050"
  },
  {
    "text": "we're also interested in is then the real world when people have actually you know updated to whatever version of the",
    "start": "1570050",
    "end": "1575390"
  },
  {
    "text": "OS they what is the state of their efi so it does a real world match the ideal world and if any of the answers to these",
    "start": "1575390",
    "end": "1582830"
  },
  {
    "text": "things above returnin know then how easy is it for users or administrators of",
    "start": "1582830",
    "end": "1588530"
  },
  {
    "text": "Apple fleets to actually work out that they're AFI is divergent and possibly vulnerable and then kind of what to do",
    "start": "1588530",
    "end": "1595100"
  },
  {
    "text": "about it so these are like a lot of the high-level research questions that we entered thing entered into the work with",
    "start": "1595100",
    "end": "1600500"
  },
  {
    "text": "and that led kind of that led our direction of where we walk through things so what was the analysis that we",
    "start": "1600500",
    "end": "1606950"
  },
  {
    "text": "conducted in words that go off the bottom of the slide we analyzed every",
    "start": "1606950",
    "end": "1613610"
  },
  {
    "text": "single OS security and firmware update that Apple released since 10:10 so that's like three and a bit years worth",
    "start": "1613610",
    "end": "1619970"
  },
  {
    "text": "of updates and we extracted all of those updates out and then from that package",
    "start": "1619970",
    "end": "1626150"
  },
  {
    "text": "that papain mentioned earlier the firmware PKG within that package there can be tens to hundreds of efi updates",
    "start": "1626150",
    "end": "1632360"
  },
  {
    "text": "within that in parallel with this we also got real-world data from over",
    "start": "1632360",
    "end": "1637550"
  },
  {
    "text": "73,000 systems obviously apple systems so that we could see the state of efi",
    "start": "1637550",
    "end": "1644950"
  },
  {
    "text": "actually installed in the real world and then compare and contrast this idealized data set to the real world data set and",
    "start": "1644950",
    "end": "1652520"
  },
  {
    "text": "we also have many many conversations with all sorts of people including Apple themselves to try and both understand",
    "start": "1652520",
    "end": "1658370"
  },
  {
    "text": "and verify the results that we were seeing because we were quite surprised by some of those results and in a more",
    "start": "1658370",
    "end": "1664520"
  },
  {
    "text": "graphical form we extracted out all of the updates from the efi updates from the OS and security updates then we",
    "start": "1664520",
    "end": "1672170"
  },
  {
    "text": "built a data set of triplicates so the build number the build number is a way to uniquely identify any particular",
    "start": "1672170",
    "end": "1678230"
  },
  {
    "text": "version of OS 10 or MacOS the numbers that you will hear thrown around more",
    "start": "1678230",
    "end": "1684710"
  },
  {
    "text": "often like 10 12 6 i'll find when that is the most recent version of the OS so",
    "start": "1684710",
    "end": "1690110"
  },
  {
    "text": "apple is supporting as soon as it flips into security updates so now 10 13 is",
    "start": "1690110",
    "end": "1695390"
  },
  {
    "text": "out 10 12 is flipped into security updates so it's version number wolf forever set at 10 12 6 it will be 10 12",
    "start": "1695390",
    "end": "1701810"
  },
  {
    "text": "6 and then security update 20 1700 1 a build number will identify exactly which",
    "start": "1701810",
    "end": "1708830"
  },
  {
    "text": "patch level you're on so from we extracted the build number the board ID as papaya also mentioned",
    "start": "1708830",
    "end": "1715880"
  },
  {
    "text": "earlier the board ID is the only way that we can specifically identify the",
    "start": "1715880",
    "end": "1720890"
  },
  {
    "text": "the model of hardware which is being referenced by the efi up fi is very very specific to the hardware",
    "start": "1720890",
    "end": "1727730"
  },
  {
    "text": "so if he took one EFI and try to install it on a different system you would likely break that system and it wouldn't reboot so we have the OS build number",
    "start": "1727730",
    "end": "1734480"
  },
  {
    "text": "that specifically identifies that iOS version we've got the board ID which this typically identifies the hardware version and then we've got the EFI",
    "start": "1734480",
    "end": "1741200"
  },
  {
    "text": "version and it's that triplicate between those three that we build up a dataset from each of each of these for a",
    "start": "1741200",
    "end": "1748850"
  },
  {
    "text": "particular version of the OS on a particular model of hardware there should be a single version of EFI which",
    "start": "1748850",
    "end": "1755299"
  },
  {
    "text": "is the most recent version that there should install and we can declare that because those versions of EFI shipped in",
    "start": "1755299",
    "end": "1761299"
  },
  {
    "text": "the OS and the security updates which ties them one-to-one to a particular build number again this is what makes",
    "start": "1761299",
    "end": "1767720"
  },
  {
    "text": "the analysis on the Apple side much much easier than on the windows side so once we've got that data set and the first",
    "start": "1767720",
    "end": "1773809"
  },
  {
    "text": "step of analysis that we do is we really we look for anomalies in the EFI firmware the Apple head release and we",
    "start": "1773809",
    "end": "1779869"
  },
  {
    "text": "found a number of them the second phase of research is then gathering a similar data set from real-world systems so",
    "start": "1779869",
    "end": "1786110"
  },
  {
    "text": "again we're building up exactly the same triplica we'll get in the build number from the real world Mac what what",
    "start": "1786110",
    "end": "1792830"
  },
  {
    "text": "version of the iOS is it running what's this board ID what's its hardware version and then what version of the EFI is running now we've got two comparable",
    "start": "1792830",
    "end": "1799340"
  },
  {
    "text": "data sets we compare those data sets and the second step of analysis is looking for discrepancies between these two data",
    "start": "1799340",
    "end": "1804860"
  },
  {
    "text": "sets then there's some profit or conclusions and then the plant names are",
    "start": "1804860",
    "end": "1810529"
  },
  {
    "text": "happy so building up a detail picture",
    "start": "1810529",
    "end": "1816860"
  },
  {
    "text": "like I said there's these triplicates this is a typical build number this is ten twelve six I think the first two",
    "start": "1816860",
    "end": "1823549"
  },
  {
    "text": "digits are the the major version of the the OS and then the last ones the last three are really just an incrementing",
    "start": "1823549",
    "end": "1830360"
  },
  {
    "text": "build number Mac model and board ID as the pine also explained earlier and then",
    "start": "1830360",
    "end": "1836450"
  },
  {
    "text": "the EFI version there's no you know is the naming of the EFI files is often",
    "start": "1836450",
    "end": "1844340"
  },
  {
    "text": "named to match a particular model of hardware but as was mentioned some some",
    "start": "1844340",
    "end": "1849889"
  },
  {
    "text": "EFI BIOS will actually apply to more than one Mac model if they're essentially internally the same so",
    "start": "1849889",
    "end": "1858140"
  },
  {
    "text": "there's a good rule of thumb but not to be not to be completely trusted and in like human language this is 1012 627",
    "start": "1858140",
    "end": "1867080"
  },
  {
    "text": "inch 5k late 2014 iMac running EFI version 0 to 0-7 bill 29 so these are",
    "start": "1867080",
    "end": "1873980"
  },
  {
    "text": "the these are the triplicates that we built up and then we tabulated this is",
    "start": "1873980",
    "end": "1879350"
  },
  {
    "text": "just like a snippet as more of this data in the paper that we released but we tablet tabulated up all of these",
    "start": "1879350",
    "end": "1885830"
  },
  {
    "text": "triplicates over all of the updates and all of the versions of Apple hardware",
    "start": "1885830",
    "end": "1891760"
  },
  {
    "text": "over the period that we were looking at which is 10 10 10 11 10 12 and 10 13 and",
    "start": "1891760",
    "end": "1897649"
  },
  {
    "text": "we use these kind of bigger state assets to start to look for the anomalies some of it was pretty manual some of it was",
    "start": "1897649",
    "end": "1904309"
  },
  {
    "text": "automated the second phase now we are looking into analyzing data from the",
    "start": "1904309",
    "end": "1911240"
  },
  {
    "text": "real world system the first phase was just looking at what Apple had released the second phase is looking at what's",
    "start": "1911240",
    "end": "1916490"
  },
  {
    "text": "out there so through friends three friends of papain we managed to get data",
    "start": "1916490",
    "end": "1922880"
  },
  {
    "text": "from century over 73,000 systems of those 73,000 systems 54 or almost 55",
    "start": "1922880",
    "end": "1930830"
  },
  {
    "text": "thousand of them were run in 10 10 10 11 or 10 12 at the point in time when we were doing this research earlier in the",
    "start": "1930830",
    "end": "1936380"
  },
  {
    "text": "year these were the 10 12 was the most recent version of our scent or MacOS and",
    "start": "1936380",
    "end": "1941419"
  },
  {
    "text": "10 11 and 10 10 with the versions that were still seen as security supported by Apple so we constrained the real world data",
    "start": "1941419",
    "end": "1948350"
  },
  {
    "text": "set to systems that were run in 10 10 10 11 or 10 12 quite honestly if you're running a version of iOS 10 that's older",
    "start": "1948350",
    "end": "1955789"
  },
  {
    "text": "than 10 10 EFI secure is the least of your problems so we cut down this data set to about 55 thousands and like we",
    "start": "1955789",
    "end": "1964159"
  },
  {
    "text": "say because of this one-to-one pairing because the efi versions are included within the OS objector itself if you're",
    "start": "1964159",
    "end": "1972049"
  },
  {
    "text": "running iOS version let's say 10 12 6 we know exactly which efi version should be",
    "start": "1972049",
    "end": "1978110"
  },
  {
    "text": "running on 10 12 6 because it was bundled with the OS update so we can start to ask questions around from this",
    "start": "1978110",
    "end": "1986120"
  },
  {
    "text": "data set which combinations of OS and hardware are run an unexpected version of efi because",
    "start": "1986120",
    "end": "1991820"
  },
  {
    "text": "there's no reason that if I should not have updated because it came bundled with the OS and so we have two similar",
    "start": "1991820",
    "end": "1998870"
  },
  {
    "text": "data sets we compare and contrast we did things like big visualizations to try and help us given the size of the data",
    "start": "1998870",
    "end": "2005560"
  },
  {
    "text": "sets we're working with this is just supposed to be pretty the yellow bulbs are like the areas that",
    "start": "2005560",
    "end": "2013000"
  },
  {
    "text": "were being highlighted that we then dug in and did more manual analysis on so",
    "start": "2013000",
    "end": "2018270"
  },
  {
    "text": "what did we find everything is cool no",
    "start": "2018270",
    "end": "2023350"
  },
  {
    "text": "problems everyone go home no we found some things so we found a number of",
    "start": "2023350",
    "end": "2028900"
  },
  {
    "text": "things first of all real works real-world systems are out of date or out of sync as far as what they what",
    "start": "2028900",
    "end": "2034330"
  },
  {
    "text": "they are expected to be also we notice that the security updates that are sent",
    "start": "2034330",
    "end": "2039490"
  },
  {
    "text": "out after after OS after the OS version shifts a full number also gradually",
    "start": "2039490",
    "end": "2046600"
  },
  {
    "text": "drops the if I model support that comes with it it's not not something that's really publicized by Apple also quite",
    "start": "2046600",
    "end": "2054040"
  },
  {
    "text": "failures like a visibility so like I said before if it doesn't if it doesn't go through there's no way of finding out",
    "start": "2054040",
    "end": "2059290"
  },
  {
    "text": "other than go going to look for the information and we also find found someone explained update for questions",
    "start": "2059290",
    "end": "2065169"
  },
  {
    "text": "where Apple seemed to ship the wrong things at the wrong time so successful",
    "start": "2065170",
    "end": "2070899"
  },
  {
    "text": "update does not mean successful former update as said the the if I up data gets",
    "start": "2070900",
    "end": "2077590"
  },
  {
    "text": "one chance to get it right and if that doesn't go through it simply it simply gets gets out of sync so we",
    "start": "2077590",
    "end": "2086200"
  },
  {
    "text": "gathered data from various edu enterprise organizations who are who submitted to us as the data as mentioned",
    "start": "2086200",
    "end": "2094470"
  },
  {
    "text": "anonymized there was really no way we pushed it all together into one data set and we got the the data that would help",
    "start": "2094470",
    "end": "2101620"
  },
  {
    "text": "us compare that and then we we measured some some non-compliant to records there",
    "start": "2101620",
    "end": "2107620"
  },
  {
    "text": "and the question was which model X with OS version Y has any a5 version that is",
    "start": "2107620",
    "end": "2112870"
  },
  {
    "text": "older than it should be according to our according to our lookup table and we found that overall across all models and",
    "start": "2112870",
    "end": "2120730"
  },
  {
    "text": "OS versions 4.2 percent we're running an incorrect efi version meaning older than what they should be it's a",
    "start": "2120730",
    "end": "2127339"
  },
  {
    "text": "pretty significant number it's not mind-blowing but it's also not in the the very low tenths of a percent so four",
    "start": "2127339",
    "end": "2135980"
  },
  {
    "text": "point two percent and this breaks out across the board kind of differently most out of date model was actually a",
    "start": "2135980",
    "end": "2143780"
  },
  {
    "text": "pretty recent iMac model that was almost forty three percent those were out of date and the den current OS at the time",
    "start": "2143780",
    "end": "2150650"
  },
  {
    "text": "that when isolated for just 1012 was actually ten percent out of date which you know goes up in in on the on the",
    "start": "2150650",
    "end": "2157369"
  },
  {
    "text": "concerning scale and then ten eleven was out of date two point one percent and",
    "start": "2157369",
    "end": "2162680"
  },
  {
    "text": "ten ten three point four so it seems to kind of go back and forth as far as out-of-date numbers and this is this is",
    "start": "2162680",
    "end": "2171410"
  },
  {
    "text": "a capture from from from our paper it's all listed in there so feel free to go",
    "start": "2171410",
    "end": "2176630"
  },
  {
    "text": "check that out as well but this lists by Nava by model number the most",
    "start": "2176630",
    "end": "2181970"
  },
  {
    "text": "out-of-date systems and if you look here you can see that actually as some of these some of these are pretty new",
    "start": "2181970",
    "end": "2188089"
  },
  {
    "text": "numbers of models especially the MacBook Pro 13 comma 2 which is the 2016 touch",
    "start": "2188089",
    "end": "2193339"
  },
  {
    "text": "bar MacBook Pro this is particularly out of date for for unknown reasons really",
    "start": "2193339",
    "end": "2199450"
  },
  {
    "text": "rich so the previous set of findings",
    "start": "2199450",
    "end": "2204770"
  },
  {
    "text": "indicated that there's some problems with the way that the firmware update bundle is getting installed or not",
    "start": "2204770",
    "end": "2209990"
  },
  {
    "text": "getting installed so the OS update that worked the efi version is not at the",
    "start": "2209990",
    "end": "2215059"
  },
  {
    "text": "expected level because for some reason that if I update didn't take but we can",
    "start": "2215059",
    "end": "2220520"
  },
  {
    "text": "also be in a different different way of being insecure there's a different state that we can be in which is software secure but firmware vulnerable so as",
    "start": "2220520",
    "end": "2227089"
  },
  {
    "text": "mentioned Apple tends to support the current latest version if its OS and then the previous two so right now 10 13",
    "start": "2227089",
    "end": "2235250"
  },
  {
    "text": "is the most recent 10 12 and 10 11 a kit considered still under security support and being stolen as a security support",
    "start": "2235250",
    "end": "2242720"
  },
  {
    "text": "they will get issued security patches so that's these security updates that you see being released alongside 10 13 1",
    "start": "2242720",
    "end": "2249170"
  },
  {
    "text": "will also come out with a security update for 10 12 and the security update to 10 11 so is this kind of like an - to",
    "start": "2249170",
    "end": "2257720"
  },
  {
    "text": "rule and this deprecation cycle Apple don't",
    "start": "2257720",
    "end": "2263210"
  },
  {
    "text": "really officially say that this is what they do but this is what they've been doing for years and this is what people expect so the question was around kind",
    "start": "2263210",
    "end": "2270890"
  },
  {
    "text": "of if you're still supported in terms of getting security updates for Apple in",
    "start": "2270890",
    "end": "2276610"
  },
  {
    "text": "your on I'm one of these n minus 1 or n minus 2 OS versions are you still",
    "start": "2276610",
    "end": "2281660"
  },
  {
    "text": "getting firmware updates and so we ran the numbers on that and the numbers are",
    "start": "2281660",
    "end": "2288320"
  },
  {
    "text": "pretty damning are we are we fair so if we're looking at models of Mac so these",
    "start": "2288320",
    "end": "2293720"
  },
  {
    "text": "big green numbers are the models of Mac that received an EFI update within that",
    "start": "2293720",
    "end": "2300200"
  },
  {
    "text": "firmware update bundle within the OS update so we can see at the time this",
    "start": "2300200",
    "end": "2305330"
  },
  {
    "text": "analysis 10-12 was the latest version so we can see that within the latest version of 10 12 6 and these are the two",
    "start": "2305330",
    "end": "2311870"
  },
  {
    "text": "security updates there were 43 models of Mac that received an EFI update there",
    "start": "2311870",
    "end": "2317630"
  },
  {
    "text": "were 31 models of Magnet received an EFI update for 1011 and there was only one model of Magne received in the FI update",
    "start": "2317630",
    "end": "2323900"
  },
  {
    "text": "to 1010 so to our question are all versions of OS treated equally absolutely not",
    "start": "2323900",
    "end": "2330380"
  },
  {
    "text": "they're older your OS they're less likely is that you're able to see or you will receive efi updates I'm going to",
    "start": "2330380",
    "end": "2335990"
  },
  {
    "text": "dig a little bit more into that in a bit so this is this is quite worrying",
    "start": "2335990",
    "end": "2341150"
  },
  {
    "text": "there's no reason that your samithy should not receive an EFI update because",
    "start": "2341150",
    "end": "2346880"
  },
  {
    "text": "the efi is independent of the OS so it's a something to change here there's no reason that it shouldn't be across the",
    "start": "2346880",
    "end": "2352430"
  },
  {
    "text": "board for all support os's this is just one snapshot I'm pretty much every update saw this trend and followed that",
    "start": "2352430",
    "end": "2359660"
  },
  {
    "text": "trend and a patch 1 doesn't mean a patch for all so digging in for that more well",
    "start": "2359660",
    "end": "2366830"
  },
  {
    "text": "cool you know there may only be you know 31 versions models of Mac that are",
    "start": "2366830",
    "end": "2372530"
  },
  {
    "text": "seeing an EFI update for 10 11 but what how does that really map against real-world Vanar abilities so",
    "start": "2372530",
    "end": "2378970"
  },
  {
    "text": "coming back to the research that we cited earlier we pulled out these four CVEs these four CVEs are specific",
    "start": "2378970",
    "end": "2385130"
  },
  {
    "text": "against no near five owner abilities done strike one Thunder strike two Ulfric DMA attack and",
    "start": "2385130",
    "end": "2391940"
  },
  {
    "text": "another tech Boise no Cova that hasn't got a snappy name it was basically just being able to abuse unused EFI functions",
    "start": "2391940",
    "end": "2400130"
  },
  {
    "text": "so when we mapped these four CVEs to the updates that were being released by",
    "start": "2400130",
    "end": "2405380"
  },
  {
    "text": "Apple we wanted to see which models were being we're receiving updates to address these vulnerabilities and these big",
    "start": "2405380",
    "end": "2414230"
  },
  {
    "text": "numbers here now are the number of models that did not receive an EFI update to address these vulnerabilities",
    "start": "2414230",
    "end": "2420320"
  },
  {
    "text": "so founder strike one which is the the oldest one discussed there were 47 models of mac that never received an EFI",
    "start": "2420320",
    "end": "2426350"
  },
  {
    "text": "update to address that vulnerability 31-foot Thunderstrike 225 fuzzy no covers misuse of unused AFI functions",
    "start": "2426350",
    "end": "2433310"
  },
  {
    "text": "and 22 for elf risks DMA DMA attacks so",
    "start": "2433310",
    "end": "2438590"
  },
  {
    "text": "again this is quite surprising right these are these are public vulnerabilities that have got a CVE number the Apple have patched for some",
    "start": "2438590",
    "end": "2445790"
  },
  {
    "text": "systems but not for others and the kicker here is that while the release",
    "start": "2445790",
    "end": "2451190"
  },
  {
    "text": "notes for an OS update or a security if they're coming from Apple will reference these CDs will say that there are fixes",
    "start": "2451190",
    "end": "2457760"
  },
  {
    "text": "included there they don't actually tell you which model that they're included for and then if we break down to the",
    "start": "2457760",
    "end": "2463940"
  },
  {
    "text": "previous slides where we discussing the differences between versions of EFI that will be impact on different OSS now we",
    "start": "2463940",
    "end": "2471470"
  },
  {
    "text": "can see why we needed these triplicates of hardware version OS version and it",
    "start": "2471470",
    "end": "2476540"
  },
  {
    "text": "wasn't here if I update released so you know this is this is pretty worried and",
    "start": "2476540",
    "end": "2482000"
  },
  {
    "text": "we were surprised by this we were expecting a much more consistent level of patches to be released when it was a",
    "start": "2482000",
    "end": "2487820"
  },
  {
    "text": "known security vulnerability as opposed to just maybe some some bug or some",
    "start": "2487820",
    "end": "2492920"
  },
  {
    "text": "update to the EFI environment itself and we also isolated a number of models that",
    "start": "2492920",
    "end": "2500180"
  },
  {
    "text": "we call a Fi orphans what that means is that up till 1012 the build numbers the",
    "start": "2500180",
    "end": "2507710"
  },
  {
    "text": "last part of the of the efi version here the build number would steadily tick up into the 2030s there a number of models",
    "start": "2507710",
    "end": "2516380"
  },
  {
    "text": "that ship from the factory generally speaking with low build numbers 0 0 0 1 we found a number of models that",
    "start": "2516380",
    "end": "2524220"
  },
  {
    "text": "over the course of their their life never changed the build number so other other models would slowly get increasing",
    "start": "2524220",
    "end": "2530579"
  },
  {
    "text": "build numbers you know ostensibly because the patches were included these",
    "start": "2530579",
    "end": "2535619"
  },
  {
    "text": "models never saw anything other than what they ship from the factory with and we we broke that down to models that",
    "start": "2535619",
    "end": "2543900"
  },
  {
    "text": "didn't receive any if I did so they were still at build zero zero or they stayed the same across the across the the",
    "start": "2543900",
    "end": "2551250"
  },
  {
    "text": "timeline more models with only five versions of factory or EFI version so",
    "start": "2551250",
    "end": "2556490"
  },
  {
    "text": "the measured at when they actually shipped to the world those versions also didn't change so sixteen of those models",
    "start": "2556490",
    "end": "2564210"
  },
  {
    "text": "were never received anything you fought dates and then the 18 were we're left",
    "start": "2564210",
    "end": "2570990"
  },
  {
    "text": "with their factory have five urgence it's it could be because Apple didn't deemed them necessary to get updates or",
    "start": "2570990",
    "end": "2577440"
  },
  {
    "text": "simply because they were left behind it's hard to tell but there were quite a few that that never never saw updates",
    "start": "2577440",
    "end": "2584339"
  },
  {
    "text": "there and this is so this is an overview of that of that table so these these",
    "start": "2584339",
    "end": "2591270"
  },
  {
    "text": "numbers are based on based on real word data this is a snippet from the FME",
    "start": "2591270",
    "end": "2596790"
  },
  {
    "text": "paper as well we have a full data set in there so you're welcome to we'll check that out in greater detail and then of",
    "start": "2596790",
    "end": "2603240"
  },
  {
    "text": "course because these updates are silent they'll also fail silently as we as we said before because Apple needed this",
    "start": "2603240",
    "end": "2610140"
  },
  {
    "text": "this to work at at opportune times when users already are rebooting because there's an OS update they they rolled it",
    "start": "2610140",
    "end": "2617250"
  },
  {
    "text": "into a sort of a slipstream system but this also means that it gets one shot and if it fails there's no no messaging",
    "start": "2617250",
    "end": "2624780"
  },
  {
    "text": "to the user that anything was wrong in fact they will go and check to see if their OS version is now one more than it",
    "start": "2624780",
    "end": "2631140"
  },
  {
    "text": "should be or or whatever it said when they ran it they see oh my version is up to date it must be cool let's move on so",
    "start": "2631140",
    "end": "2637890"
  },
  {
    "text": "that is it's it's a deceptive well not deceptive in a malicious way but deceptive in that you can't really tell",
    "start": "2637890",
    "end": "2643290"
  },
  {
    "text": "if anything happened unless you know what to go look for and then it's not",
    "start": "2643290",
    "end": "2648510"
  },
  {
    "text": "something an end user definitely will will go look for because it is an unknown system and really anyone who",
    "start": "2648510",
    "end": "2654839"
  },
  {
    "text": "isn't digging into this will we'll never know to to make this a case so often if I as",
    "start": "2654839",
    "end": "2661910"
  },
  {
    "text": "we see from our numbers GFI is is out of date and then we also found some QA",
    "start": "2661910",
    "end": "2667610"
  },
  {
    "text": "issues rich well we believe there were queue issues that's what we're saying passe through all of that offline",
    "start": "2667610",
    "end": "2673820"
  },
  {
    "text": "analysis of all of the FI updates that were included with the various OS updates and security updates as we were",
    "start": "2673820",
    "end": "2680780"
  },
  {
    "text": "tabulating these things out there was there was this particular security",
    "start": "2680780",
    "end": "2685940"
  },
  {
    "text": "update so security update 2017 zero zero one so the first security update of this",
    "start": "2685940",
    "end": "2690950"
  },
  {
    "text": "calendar year for ten ten and ten eleven we exploded out those bundles to look at",
    "start": "2690950",
    "end": "2697460"
  },
  {
    "text": "the efi versions that were contained and we found that the efi that was included",
    "start": "2697460",
    "end": "2703640"
  },
  {
    "text": "in this these security updates was actually older than the previous version",
    "start": "2703640",
    "end": "2708980"
  },
  {
    "text": "that apple had released so essentially they were shipping deprecated versions of efi with a newer security patch level",
    "start": "2708980",
    "end": "2715780"
  },
  {
    "text": "and the updates that were included in this in the 2017 0:01 were actually",
    "start": "2715780",
    "end": "2722420"
  },
  {
    "text": "exactly the same efi versions and I mean code for code we did two check sums over everything as the releases the efi is",
    "start": "2722420",
    "end": "2729770"
  },
  {
    "text": "that were released with security update 2016 zero zero two so they're essentially ship two regression and this",
    "start": "2729770",
    "end": "2736010"
  },
  {
    "text": "is like again pulled from the paper we can see really the the b number here is",
    "start": "2736010",
    "end": "2741380"
  },
  {
    "text": "what you're wanting to look at we can see let's say an imac 13 comma one we",
    "start": "2741380",
    "end": "2747020"
  },
  {
    "text": "can see in 2017 zero zero one it's got a build number of zero nine for the",
    "start": "2747020",
    "end": "2752690"
  },
  {
    "text": "previous patch 2016 zero zero two three it had ten and then in the the previous",
    "start": "2752690",
    "end": "2758120"
  },
  {
    "text": "but one patch zero zero two is back at nine so basically the firmware update package that was released with these",
    "start": "2758120",
    "end": "2764810"
  },
  {
    "text": "security updates was exactly the same firmware update package it was released two versions before so it's a regression",
    "start": "2764810",
    "end": "2771640"
  },
  {
    "text": "we were surprised at this from our conversations with apple they seemed relatively surprised as well the last",
    "start": "2771640",
    "end": "2778880"
  },
  {
    "text": "time that we checked these updates still actually come contain the old EFI firmware we reckon it's a QA issue kind",
    "start": "2778880",
    "end": "2787070"
  },
  {
    "text": "of it was just a model on the back end you know the wrong at the best of times QA on firmware I'm sure it's harder the the next question",
    "start": "2787070",
    "end": "2795830"
  },
  {
    "text": "that should be popping up on your head is like well if anybody were installed 27001 the date downgrade their efi to an",
    "start": "2795830",
    "end": "2804200"
  },
  {
    "text": "older version that potentially was vulnerable well luckily not but not through apple trying so when you",
    "start": "2804200",
    "end": "2810800"
  },
  {
    "text": "installed this you went through the exact same process that Popeye now tried earlier then in particular correctly if",
    "start": "2810800",
    "end": "2817580"
  },
  {
    "text": "I was identified it was dumped into the efi partition it was blessed some NVRAM",
    "start": "2817580",
    "end": "2823430"
  },
  {
    "text": "updates were done reboot was issued and then controllers passed back to efi so",
    "start": "2823430",
    "end": "2828620"
  },
  {
    "text": "efi is only ever updated from efi you never actually update air five from the OS itself so the whole update process",
    "start": "2828620",
    "end": "2836900"
  },
  {
    "text": "had put the old firmware file in place ready for it to be flashed however in",
    "start": "2836900",
    "end": "2842000"
  },
  {
    "text": "the efi preview environment where the update actually takes place it does a",
    "start": "2842000",
    "end": "2847010"
  },
  {
    "text": "variety of other validation and checks one of the validations it does is code signing making sure the efi bundle that",
    "start": "2847010",
    "end": "2853160"
  },
  {
    "text": "you're looking to flesh is actually authored by apple you know that's always a good thing before you flush your efi",
    "start": "2853160",
    "end": "2859030"
  },
  {
    "text": "it also does a date check or a version check deliberately to stop you being",
    "start": "2859030",
    "end": "2865100"
  },
  {
    "text": "able to roll back to an old version so while this these old versions of efi",
    "start": "2865100",
    "end": "2870650"
  },
  {
    "text": "were set to be installed some of the security characteristics of the efi",
    "start": "2870650",
    "end": "2877460"
  },
  {
    "text": "update process itself saved us from kind of rolling back you can set there's a parameter you can set within an AFI",
    "start": "2877460",
    "end": "2883640"
  },
  {
    "text": "update environment the basically says don't allow rollback the reason that you wouldn't want to allow rollback why this is a good thing for security is for",
    "start": "2883640",
    "end": "2890930"
  },
  {
    "text": "example if i had compromised the system i could then go through the standard",
    "start": "2890930",
    "end": "2896390"
  },
  {
    "text": "apple efi update process to install an old version of verify that i know it's got a vulnerability so then i can",
    "start": "2896390",
    "end": "2902950"
  },
  {
    "text": "exploit that vulnerability and you know get my code into efi so the rollback",
    "start": "2902950",
    "end": "2908480"
  },
  {
    "text": "protection is a great security protection and and protected users in this case from not installing old",
    "start": "2908480",
    "end": "2914660"
  },
  {
    "text": "versions of the efi so the regressions shipped but it didn't actually have a negative impact for the users because of",
    "start": "2914660",
    "end": "2922430"
  },
  {
    "text": "the checks that were actually in if I update environment itself so not a big security issue definitely interested",
    "start": "2922430",
    "end": "2929350"
  },
  {
    "text": "in terms of looking at apples QA process",
    "start": "2929350",
    "end": "2934650"
  },
  {
    "text": "yep I guess that's that's the slide that says words that I've just said with my mouth so we'll slip we'll skip by that",
    "start": "2937110",
    "end": "2945180"
  },
  {
    "text": "mitigations it's spoken about a lot of problems the pine is going to tell you how to fix things and make everything",
    "start": "2945180",
    "end": "2951040"
  },
  {
    "text": "right yeah so because we kind of wanted to look at what is being done by Apple",
    "start": "2951040",
    "end": "2957040"
  },
  {
    "text": "about these these issues what can we you know what can we do about actually helping folks to to discover this and do",
    "start": "2957040",
    "end": "2965350"
  },
  {
    "text": "some medication so we'll go through this real quick here so upgrading to Mac OS 10 10 13 is a is a good first step",
    "start": "2965350",
    "end": "2972610"
  },
  {
    "text": "logging reporting running updates out of and and also some of the things Apple's doing is helping and it's a refers back",
    "start": "2972610",
    "end": "2979240"
  },
  {
    "text": "to a if I check as well so of course the first thing you can do because of after mentioned requirement for a PFS to have",
    "start": "2979240",
    "end": "2985870"
  },
  {
    "text": "efi support if you upgrade to 1013 you will get another shot at you know",
    "start": "2985870",
    "end": "2992830"
  },
  {
    "text": "running your efi updates as well as you'll get the if I check functionality",
    "start": "2992830",
    "end": "2998200"
  },
  {
    "text": "as well to keep a closer eye on its on its integrity as well I hear you're",
    "start": "2998200",
    "end": "3004320"
  },
  {
    "text": "thinking 10 13 is that the one where you can get easy root access yes it is Apple has pads that so they're kind of",
    "start": "3004320",
    "end": "3011940"
  },
  {
    "text": "in a crappy situation where right now 1013 is not looking so so great but I",
    "start": "3011940",
    "end": "3018660"
  },
  {
    "text": "would say it is still your best bet as far as like support for ef5 dates and",
    "start": "3018660",
    "end": "3024120"
  },
  {
    "text": "various other mitigations for other issues that are outside of efi to to",
    "start": "3024120",
    "end": "3029700"
  },
  {
    "text": "deploy this and actually we notice that apple start those started shipping these eo5 dates with a PFS support back in",
    "start": "3029700",
    "end": "3036150"
  },
  {
    "text": "10125 actually before 10:13 released and as well again in ten twelve six are our",
    "start": "3036150",
    "end": "3042240"
  },
  {
    "text": "assumption or are sort of what we assume here is which another word for",
    "start": "3042240",
    "end": "3047340"
  },
  {
    "text": "assumption is that Apple knew that these updates don't always take and if someone runs 1013 and then if I doesn't get",
    "start": "3047340",
    "end": "3054810"
  },
  {
    "text": "updated they're basically stuck in the mud PFS now cannot be booted from so they started to kind of proceed",
    "start": "3054810",
    "end": "3060870"
  },
  {
    "text": "these eo5 dates in the previous OS in the hopes that they would cover more systems before 10:13 went live in full",
    "start": "3060870",
    "end": "3068240"
  },
  {
    "text": "you can use a number of tools out there to actually get this information I've listed a few here os query popular",
    "start": "3068240",
    "end": "3074940"
  },
  {
    "text": "puppet chef you can also use a good old shell script if you have a way to send",
    "start": "3074940",
    "end": "3080250"
  },
  {
    "text": "those out to get the same information want to point out that the the folks",
    "start": "3080250",
    "end": "3086040"
  },
  {
    "text": "that trail of bits are actually working on a an extension for OS query that will",
    "start": "3086040",
    "end": "3091530"
  },
  {
    "text": "check against the API that we will talk about in a minute they are working on",
    "start": "3091530",
    "end": "3098160"
  },
  {
    "text": "this go check that out there's a there's a branch being worked on right now a very useful tool to get this information",
    "start": "3098160",
    "end": "3104850"
  },
  {
    "text": "across a larger fleet so what can you do you can reinstall the OS social security update if you install the same one that",
    "start": "3104850",
    "end": "3111270"
  },
  {
    "text": "was previously installed you will not break anything you'll just get another shot at installing the the efi you can",
    "start": "3111270",
    "end": "3118710"
  },
  {
    "text": "do the yellow option and and create your own standalone installer this is not something Apple recommends so I will not recommend it in case you",
    "start": "3118710",
    "end": "3125610"
  },
  {
    "text": "break it and come to me but it is a way to to do this as well there's a link down there as well for a a popular",
    "start": "3125610",
    "end": "3132470"
  },
  {
    "text": "system management tool that actually runs you through the third process rich tools and API releases so rather than",
    "start": "3132470",
    "end": "3140790"
  },
  {
    "text": "just finding problems we also like to try and help people get to a better State so we wrote a bunch of tools and",
    "start": "3140790",
    "end": "3146430"
  },
  {
    "text": "have really some open source they come into the name effigy can't take any",
    "start": "3146430",
    "end": "3151620"
  },
  {
    "text": "credit for that that's that's all papain the focus of effigy was and as we saw",
    "start": "3151620",
    "end": "3157800"
  },
  {
    "text": "our as we've seen from the data analysis that we did it can be both difficult to",
    "start": "3157800",
    "end": "3163410"
  },
  {
    "text": "get ax at the versions of the data that you want as well as then to infer is",
    "start": "3163410",
    "end": "3169620"
  },
  {
    "text": "this the correct version of the efi that i'm running or am i running an out-of-date possibly vulnerable version you know took two researchers a good",
    "start": "3169620",
    "end": "3176820"
  },
  {
    "text": "good three months there kind of compiled and chunk through this data most teams much assisted means don't have that",
    "start": "3176820",
    "end": "3182970"
  },
  {
    "text": "layer a level of time and would just like something easier so we built a bunch of tools to to help with that",
    "start": "3182970",
    "end": "3188600"
  },
  {
    "text": "really at its core effigy is just a RESTful API that encapsulates the data set that we've built up and I'm",
    "start": "3188600",
    "end": "3194849"
  },
  {
    "text": "continuing to add to on the back end and there's a small client that queries that",
    "start": "3194849",
    "end": "3200489"
  },
  {
    "text": "sense of the right version numbers so you can get back are you running the expected version of EFI etc so it's",
    "start": "3200489",
    "end": "3207059"
  },
  {
    "text": "pretty straightforward to kind of identifies what version of EFI you should be running compared to the version of EFI that you are running",
    "start": "3207059",
    "end": "3213469"
  },
  {
    "text": "certain particular combinations of hardware software that we know have EFI problems should be flagged up new stuffs",
    "start": "3213469",
    "end": "3220979"
  },
  {
    "text": "getting added to it all the time it's on github so we'll send you the link another its own slide in a minute if if",
    "start": "3220979",
    "end": "3227160"
  },
  {
    "text": "and when you find bugs please just raise them to us and we'll try and get them fixed it's quick as we can it now",
    "start": "3227160",
    "end": "3232890"
  },
  {
    "text": "supports 1010 through 1013 1013 is a recent addition because we didn't have that data until recently we built a lot",
    "start": "3232890",
    "end": "3241229"
  },
  {
    "text": "of the tooling around trying to help Mac admins and deal with this at scale so if you're if you're dealing with you know",
    "start": "3241229",
    "end": "3247499"
  },
  {
    "text": "hundreds thousands tens of thousands of Mac systems and you're asking the question which of them are running out",
    "start": "3247499",
    "end": "3253680"
  },
  {
    "text": "of date vulnerable efi that can be a pretty big task so we want to build the tooling to try and help those system ins",
    "start": "3253680",
    "end": "3259469"
  },
  {
    "text": "kind of deal with it at scale so how does it work really we're just pulling",
    "start": "3259469",
    "end": "3264630"
  },
  {
    "text": "out five key bits of information the efi ROM version so that's the the efi version that we've been speaking of our",
    "start": "3264630",
    "end": "3270809"
  },
  {
    "text": "west build number that we've mentioned before the system board ID so now we've got that triplica this is the triplicate",
    "start": "3270809",
    "end": "3277079"
  },
  {
    "text": "that then we compare to the data set we're also grabbing the SMS SMC ROM",
    "start": "3277079",
    "end": "3282390"
  },
  {
    "text": "version we're hoping to extend our research out into SMC work in future so",
    "start": "3282390",
    "end": "3287729"
  },
  {
    "text": "we want to start to build up a dataset of that and then we also include that hash justinyu ID tag we wanted to call",
    "start": "3287729",
    "end": "3293700"
  },
  {
    "text": "this out because people can sometimes get a little bit nervous about sis UID because it uniquely identifies a hardware platform we wanted to do this",
    "start": "3293700",
    "end": "3301019"
  },
  {
    "text": "so we could aid analysis on the back end so we could see repeat people calling the API in and disambiguate them so we",
    "start": "3301019",
    "end": "3308729"
  },
  {
    "text": "essentially blind hashed the system UID so we take the system's MAC address we",
    "start": "3308729",
    "end": "3313920"
  },
  {
    "text": "concatenate with the system UID and then we sha-256 it this means that we're going to get unique values so we can",
    "start": "3313920",
    "end": "3319579"
  },
  {
    "text": "disambiguate the data on the back end but we have no visibility to rather the secret salt that's used or to",
    "start": "3319579",
    "end": "3326160"
  },
  {
    "text": "the UID so it's soon anonymous and and this enables our data analysis but doesn't infringe any any PII or any",
    "start": "3326160",
    "end": "3334320"
  },
  {
    "text": "identifiable information the API server itself isn't really a server it's it's a",
    "start": "3334320",
    "end": "3341760"
  },
  {
    "text": "big chunk of Python built on top of an idea it's a big fat AWS lamda really",
    "start": "3341760",
    "end": "3346950"
  },
  {
    "text": "built on top of the cellists framework if you're not familiar with each other's framework check it out super cool allows",
    "start": "3346950",
    "end": "3352590"
  },
  {
    "text": "you to take a big chunk of Python and make it into a server that automatically scales so that's nice and we've got like",
    "start": "3352590",
    "end": "3358650"
  },
  {
    "text": "a pretty nice back-end tool flow where all of that analysis and extraction of",
    "start": "3358650",
    "end": "3364500"
  },
  {
    "text": "the efi updates from the OS updates and security updates kind of happens automatically and we've got it for the",
    "start": "3364500",
    "end": "3371400"
  },
  {
    "text": "point that really the server code is actually written as an output from that analysis itself so things are just",
    "start": "3371400",
    "end": "3377640"
  },
  {
    "text": "running in the background new server code is being spat out all the time and the restful api is like super",
    "start": "3377640",
    "end": "3383910"
  },
  {
    "text": "straightforward so if you look at the client on github it is super super straightforward you could easily write",
    "start": "3383910",
    "end": "3389010"
  },
  {
    "text": "your own client the pine mentioned there's an OS query module being built to direct your query against the API and",
    "start": "3389010",
    "end": "3395940"
  },
  {
    "text": "not have to use the effigy client it's got a command line version which looks really exciting you know you'll see",
    "start": "3395940",
    "end": "3403200"
  },
  {
    "text": "what's been sent up and then various checks that are being done there's a GUI version if people that click the Clive",
    "start": "3403200",
    "end": "3411360"
  },
  {
    "text": "version is much better for it scale the GUI version is great if people just want to kind of check their own home instance",
    "start": "3411360",
    "end": "3417350"
  },
  {
    "text": "there's also a web app version that's great for the same thing and this is",
    "start": "3417350",
    "end": "3422730"
  },
  {
    "text": "something that we want to share the the API data we've been gathering on the",
    "start": "3422730",
    "end": "3429840"
  },
  {
    "text": "backend specifically to answer some questions of you know was initial real world data reflective of like most",
    "start": "3429840",
    "end": "3437670"
  },
  {
    "text": "normal people use of it so over at the time that we've released the API we've had about 100 33,000 queries which is",
    "start": "3437670",
    "end": "3444330"
  },
  {
    "text": "pretty good data set from about 9,000 unique endpoints so that's nine",
    "start": "3444330",
    "end": "3450000"
  },
  {
    "text": "thousands of those pseudonymous identify us the interesting thing here and this is probably the big takeaway and we were",
    "start": "3450000",
    "end": "3456090"
  },
  {
    "text": "expecting number four point two percent was the average that we cited earlier that was",
    "start": "3456090",
    "end": "3461580"
  },
  {
    "text": "out date from our real-world data set from the effigy data that we're getting it's actually looking more like twenty",
    "start": "3461580",
    "end": "3466890"
  },
  {
    "text": "percent is the average number of people that are run in unexpected versions of EFI given their hardware version than",
    "start": "3466890",
    "end": "3472619"
  },
  {
    "text": "their OS version this is much higher than we we had expected and it has some specifics about which model and OS is",
    "start": "3472619",
    "end": "3479250"
  },
  {
    "text": "like most out of wack interestingly the the number of systems",
    "start": "3479250",
    "end": "3486300"
  },
  {
    "text": "running 1013 is actually much lower than we expected so here's some pretty graphs can see that 10.6 is the most installed",
    "start": "3486300",
    "end": "3494070"
  },
  {
    "text": "version of the OS is hitting the API and it drops off pretty rapidly from there with with the most recent version of",
    "start": "3494070",
    "end": "3500550"
  },
  {
    "text": "1011 following we don't hit 1013 until around here these are this is across",
    "start": "3500550",
    "end": "3506550"
  },
  {
    "text": "build numbers again this is just showing that 10 12 6 the latest security update",
    "start": "3506550",
    "end": "3511710"
  },
  {
    "text": "for 10 12 6 is the most prevalent the most out-of-date model of Mac is a",
    "start": "3511710",
    "end": "3518400"
  },
  {
    "text": "MacBook Pro from about 2015 I think microcode 12:1 this is a better",
    "start": "3518400",
    "end": "3525810"
  },
  {
    "text": "distribution but you can see a huge deviation between some models that seem to have incredibly consistent API sorry",
    "start": "3525810",
    "end": "3532740"
  },
  {
    "text": "efi versions based on that hardware on their OS and then some that are far more divergent we can't explain why efi",
    "start": "3532740",
    "end": "3540710"
  },
  {
    "text": "updates well and installs well on some systems and not on others we can just",
    "start": "3540710",
    "end": "3546000"
  },
  {
    "text": "observe the the empirical data of that is happening we don't know what the problem is that's possibly inhibiting",
    "start": "3546000",
    "end": "3552030"
  },
  {
    "text": "these efi installs landing correctly and then this is this is a different cut of",
    "start": "3552030",
    "end": "3557880"
  },
  {
    "text": "data across which is the most prevalently mismatched efi version we're",
    "start": "3557880",
    "end": "3565109"
  },
  {
    "text": "going to release all this data so you can dig in and click around so conclusions we've covered a lot I think",
    "start": "3565109",
    "end": "3572880"
  },
  {
    "text": "one of the key things that I know certainly if you're working for a vendor here being transparent with what you are",
    "start": "3572880",
    "end": "3578550"
  },
  {
    "text": "and are patching is key especially in the firmware space is invisible to most users and if you're not really explicit",
    "start": "3578550",
    "end": "3584970"
  },
  {
    "text": "about what you are and aren't patching the the users not going to no one's going to have to do a huge amount of work like we did we",
    "start": "3584970",
    "end": "3591840"
  },
  {
    "text": "can absolutely be in states where with software secure but firmware vulnerable not all hardware is treated equally by",
    "start": "3591840",
    "end": "3597540"
  },
  {
    "text": "manufacturers so don't fall into the trap of that if one system was patched all other systems will be patched QA is",
    "start": "3597540",
    "end": "3603150"
  },
  {
    "text": "clearly hard regressions will ship and think about efi less like a bios and",
    "start": "3603150",
    "end": "3608460"
  },
  {
    "text": "more like a full mini OS in almost every instance the way that you would define an operating system if i meets that",
    "start": "3608460",
    "end": "3615150"
  },
  {
    "text": "definition it's essentially a mini OS the boots before it then hands over control to your follow us so if we think",
    "start": "3615150",
    "end": "3621690"
  },
  {
    "text": "of it like a mini OS we need to treat it like a mini OS one I'm thinking about patching and applying security updates",
    "start": "3621690",
    "end": "3628320"
  },
  {
    "text": "to it and again just to reiterate we actually believe apples taking the efi security really seriously i'm doing a",
    "start": "3628320",
    "end": "3635220"
  },
  {
    "text": "great job compared to many other vendors despite the problems that we found so there's a paper so this link here is",
    "start": "3635220",
    "end": "3644220"
  },
  {
    "text": "going to be the latest version of the paper which is updated for the 10:13 data we've got a blog post and the FEG",
    "start": "3644220",
    "end": "3651630"
  },
  {
    "text": "tooling if you just go to effigy io you'll find everything that you need think that's a lot thank you",
    "start": "3651630",
    "end": "3658760"
  }
]