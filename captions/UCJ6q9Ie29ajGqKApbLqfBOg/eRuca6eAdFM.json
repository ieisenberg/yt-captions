[
  {
    "start": "0",
    "end": "0"
  },
  {
    "text": "all right we're going to get started",
    "start": "120",
    "end": "1560"
  },
  {
    "text": "thanks for coming out to this last",
    "start": "1560",
    "end": "3040"
  },
  {
    "text": "session of the day I uh appreciate you",
    "start": "3040",
    "end": "5040"
  },
  {
    "text": "all being here so real quick before I",
    "start": "5040",
    "end": "7640"
  },
  {
    "text": "get started let me just introduce myself",
    "start": "7640",
    "end": "9480"
  },
  {
    "text": "my name is Ian hen uh I'm currently a",
    "start": "9480",
    "end": "12120"
  },
  {
    "text": "security researcher at synopsis working",
    "start": "12120",
    "end": "14960"
  },
  {
    "text": "on City static analysis tool and other",
    "start": "14960",
    "end": "17640"
  },
  {
    "text": "application security tools um prior to",
    "start": "17640",
    "end": "20800"
  },
  {
    "text": "synopsis I got my PhD at UC Berkeley",
    "start": "20800",
    "end": "23720"
  },
  {
    "text": "mathematics and I've also been a",
    "start": "23720",
    "end": "25599"
  },
  {
    "text": "professional software developer for",
    "start": "25599",
    "end": "27119"
  },
  {
    "text": "about 9 years um if after the talk you",
    "start": "27119",
    "end": "30039"
  },
  {
    "text": "guys want to get in touch with me I'm on",
    "start": "30039",
    "end": "31439"
  },
  {
    "text": "Twitter and oldfashioned email works as",
    "start": "31439",
    "end": "33879"
  },
  {
    "text": "well so should be easy to get a hold of",
    "start": "33879",
    "end": "36800"
  },
  {
    "text": "So today we're talking about full dis",
    "start": "36800",
    "end": "38640"
  },
  {
    "text": "encryption so for anyone that doesn't",
    "start": "38640",
    "end": "41000"
  },
  {
    "text": "know exactly what that means that is",
    "start": "41000",
    "end": "42800"
  },
  {
    "text": "exactly what it sounds like it's",
    "start": "42800",
    "end": "44079"
  },
  {
    "text": "encrypting an entire disc or volume and",
    "start": "44079",
    "end": "47199"
  },
  {
    "text": "it's usually handled at a very low level",
    "start": "47199",
    "end": "49800"
  },
  {
    "text": "with a driver or at the operating system",
    "start": "49800",
    "end": "52280"
  },
  {
    "text": "level so that it will transparently",
    "start": "52280",
    "end": "54160"
  },
  {
    "text": "decrypts all of the drive contents for",
    "start": "54160",
    "end": "57160"
  },
  {
    "text": "all the applications and services um the",
    "start": "57160",
    "end": "60960"
  },
  {
    "text": "services are usually totally unaware",
    "start": "60960",
    "end": "63160"
  },
  {
    "text": "that the drive itself is actually",
    "start": "63160",
    "end": "64559"
  },
  {
    "text": "encrypted so this isn't meant to protect",
    "start": "64559",
    "end": "66799"
  },
  {
    "text": "against remote attacks by the time any",
    "start": "66799",
    "end": "70240"
  },
  {
    "text": "application that's sending out data",
    "start": "70240",
    "end": "72159"
  },
  {
    "text": "remotely sees it it's already in clear",
    "start": "72159",
    "end": "74240"
  },
  {
    "text": "text so this is specifically meant to",
    "start": "74240",
    "end": "77159"
  },
  {
    "text": "protect against uh threats with physical",
    "start": "77159",
    "end": "80600"
  },
  {
    "text": "access so this talk is very specifically",
    "start": "80600",
    "end": "82520"
  },
  {
    "text": "going to be about how you can attack",
    "start": "82520",
    "end": "84560"
  },
  {
    "text": "full dis encryption assuming that you",
    "start": "84560",
    "end": "86600"
  },
  {
    "text": "have physical access whether that means",
    "start": "86600",
    "end": "88840"
  },
  {
    "text": "that there is a stolen laptop or a",
    "start": "88840",
    "end": "91600"
  },
  {
    "text": "laptop that's been lost or someone is",
    "start": "91600",
    "end": "94640"
  },
  {
    "text": "picking up a laptop that's been left in",
    "start": "94640",
    "end": "96240"
  },
  {
    "text": "a hotel room it we're going to assume",
    "start": "96240",
    "end": "98920"
  },
  {
    "text": "that the attacker has access to the",
    "start": "98920",
    "end": "101280"
  },
  {
    "text": "device so this talk specifically is",
    "start": "101280",
    "end": "103799"
  },
  {
    "start": "102000",
    "end": "102000"
  },
  {
    "text": "about Microsoft bit Locker which is",
    "start": "103799",
    "end": "105759"
  },
  {
    "text": "Microsoft's proprietary full dis",
    "start": "105759",
    "end": "107920"
  },
  {
    "text": "encryption Solution that's been built",
    "start": "107920",
    "end": "109920"
  },
  {
    "text": "into all versions of Windows since Vista",
    "start": "109920",
    "end": "112840"
  },
  {
    "text": "um and it's specifically been built into",
    "start": "112840",
    "end": "114360"
  },
  {
    "text": "the professional Enterprise versions and",
    "start": "114360",
    "end": "117719"
  },
  {
    "text": "it has been built to use the trust Ed",
    "start": "117719",
    "end": "120159"
  },
  {
    "text": "platform module that's available on lots",
    "start": "120159",
    "end": "122159"
  },
  {
    "text": "of devices um and that uh is something",
    "start": "122159",
    "end": "126039"
  },
  {
    "text": "that I'm going to go into detail in a",
    "start": "126039",
    "end": "127399"
  },
  {
    "text": "second but the TPM in this case is used",
    "start": "127399",
    "end": "130000"
  },
  {
    "text": "to store that Master encryption key so",
    "start": "130000",
    "end": "133000"
  },
  {
    "text": "this physical chip that lives on the",
    "start": "133000",
    "end": "134760"
  },
  {
    "text": "device is what's responsible for keeping",
    "start": "134760",
    "end": "136720"
  },
  {
    "text": "that",
    "start": "136720",
    "end": "137760"
  },
  {
    "text": "secret so the TPM is an open",
    "start": "137760",
    "end": "140760"
  },
  {
    "text": "specification for an API that can do a",
    "start": "140760",
    "end": "143560"
  },
  {
    "text": "lot of different things and if you're",
    "start": "143560",
    "end": "144959"
  },
  {
    "text": "interested in trusted Computing there's",
    "start": "144959",
    "end": "146640"
  },
  {
    "text": "a lot of sort of very cool and uh",
    "start": "146640",
    "end": "149840"
  },
  {
    "text": "specialized applications but it's sort",
    "start": "149840",
    "end": "151519"
  },
  {
    "text": "of a fairly General API where you can do",
    "start": "151519",
    "end": "153519"
  },
  {
    "text": "a lot of things with it but in our case",
    "start": "153519",
    "end": "156519"
  },
  {
    "text": "what we're really interested in is how",
    "start": "156519",
    "end": "158080"
  },
  {
    "text": "the TPM can be used to store secrets and",
    "start": "158080",
    "end": "160480"
  },
  {
    "text": "specifically in this case the disk",
    "start": "160480",
    "end": "162480"
  },
  {
    "text": "encryption",
    "start": "162480",
    "end": "163720"
  },
  {
    "text": "key so a TPM has a number of platform",
    "start": "163720",
    "end": "167760"
  },
  {
    "start": "164000",
    "end": "164000"
  },
  {
    "text": "configuration registers called pcrs and",
    "start": "167760",
    "end": "170720"
  },
  {
    "text": "the specification has like 24 of them",
    "start": "170720",
    "end": "173560"
  },
  {
    "text": "and Microsoft bit Locker uses about four",
    "start": "173560",
    "end": "175879"
  },
  {
    "text": "by default and so I'm not going to go",
    "start": "175879",
    "end": "178200"
  },
  {
    "text": "into the specifics too much done what",
    "start": "178200",
    "end": "180080"
  },
  {
    "text": "each one is used for but the idea is",
    "start": "180080",
    "end": "181920"
  },
  {
    "text": "that you can load in information to",
    "start": "181920",
    "end": "183720"
  },
  {
    "text": "these registers about the configuration",
    "start": "183720",
    "end": "186159"
  },
  {
    "text": "and status of the device and each stage",
    "start": "186159",
    "end": "190319"
  },
  {
    "text": "of the boot process is responsible for",
    "start": "190319",
    "end": "192720"
  },
  {
    "text": "making some hash of the next stage",
    "start": "192720",
    "end": "194840"
  },
  {
    "text": "whether that's the master boot record or",
    "start": "194840",
    "end": "196560"
  },
  {
    "text": "the boot loader and putting that value",
    "start": "196560",
    "end": "199120"
  },
  {
    "text": "into a",
    "start": "199120",
    "end": "200680"
  },
  {
    "text": "PCR and so when a machine is first",
    "start": "200680",
    "end": "203360"
  },
  {
    "text": "booted up it initially has zero in all",
    "start": "203360",
    "end": "205640"
  },
  {
    "text": "of these registers and whenever any uh",
    "start": "205640",
    "end": "209239"
  },
  {
    "text": "API call is sent to the TPM to update",
    "start": "209239",
    "end": "211480"
  },
  {
    "text": "the value it never sets the values",
    "start": "211480",
    "end": "213799"
  },
  {
    "text": "directly it always takes the old value",
    "start": "213799",
    "end": "216040"
  },
  {
    "text": "concatenates it with the new one hashes",
    "start": "216040",
    "end": "218280"
  },
  {
    "text": "that and puts that result into the PCR",
    "start": "218280",
    "end": "221239"
  },
  {
    "text": "and this is really important and this is",
    "start": "221239",
    "end": "223000"
  },
  {
    "text": "sort of very critical to how the TPM is",
    "start": "223000",
    "end": "225319"
  },
  {
    "text": "able to store secret safely because you",
    "start": "225319",
    "end": "228360"
  },
  {
    "text": "can't set arbitrary values to the PCR",
    "start": "228360",
    "end": "230720"
  },
  {
    "text": "even if you have like kernel level",
    "start": "230720",
    "end": "232640"
  },
  {
    "text": "access to the device the TPM just",
    "start": "232640",
    "end": "235400"
  },
  {
    "text": "doesn't expose the functionality to set",
    "start": "235400",
    "end": "237680"
  },
  {
    "text": "a value directly so only the so after a",
    "start": "237680",
    "end": "242439"
  },
  {
    "text": "value is already set in there you can't",
    "start": "242439",
    "end": "243879"
  },
  {
    "text": "set a new one so only that original boot",
    "start": "243879",
    "end": "245799"
  },
  {
    "text": "process where each piece is responsible",
    "start": "245799",
    "end": "248159"
  },
  {
    "text": "for hashing the next and putting that in",
    "start": "248159",
    "end": "250000"
  },
  {
    "text": "a PCR can reproduce those same values in",
    "start": "250000",
    "end": "253640"
  },
  {
    "text": "the",
    "start": "253640",
    "end": "254560"
  },
  {
    "text": "pcrs so when the TPM is told to store a",
    "start": "254560",
    "end": "258359"
  },
  {
    "text": "secret in this case our dis encryption",
    "start": "258359",
    "end": "260519"
  },
  {
    "text": "key you have the option of sealing it",
    "start": "260519",
    "end": "263240"
  },
  {
    "text": "and when you do that you specify some of",
    "start": "263240",
    "end": "265040"
  },
  {
    "text": "the pcrs to use as parameters to that",
    "start": "265040",
    "end": "267400"
  },
  {
    "text": "ceiling operation and after a key is",
    "start": "267400",
    "end": "270360"
  },
  {
    "text": "sealed by the TPM it's only going to",
    "start": "270360",
    "end": "272720"
  },
  {
    "text": "unseal that key if the same PCR values",
    "start": "272720",
    "end": "276280"
  },
  {
    "text": "exist as when it was originally sealed",
    "start": "276280",
    "end": "278800"
  },
  {
    "text": "so when bit Locker is setting itself up",
    "start": "278800",
    "end": "281680"
  },
  {
    "text": "and first encrypting the drive it looks",
    "start": "281680",
    "end": "283280"
  },
  {
    "text": "at the current values in the pcrs and",
    "start": "283280",
    "end": "286479"
  },
  {
    "text": "then only when the machine has been",
    "start": "286479",
    "end": "288479"
  },
  {
    "text": "rebooted through the same boot process",
    "start": "288479",
    "end": "291120"
  },
  {
    "text": "will it ever unlock that key so",
    "start": "291120",
    "end": "293360"
  },
  {
    "text": "effectively what this means is even if",
    "start": "293360",
    "end": "295880"
  },
  {
    "text": "you have physical access of a device if",
    "start": "295880",
    "end": "298039"
  },
  {
    "text": "you boot into some attach haor",
    "start": "298039",
    "end": "299960"
  },
  {
    "text": "controlled operating system it cannot",
    "start": "299960",
    "end": "302280"
  },
  {
    "text": "ask the TPM for the key that's been",
    "start": "302280",
    "end": "304479"
  },
  {
    "text": "sealed and that's a very sort of",
    "start": "304479",
    "end": "307919"
  },
  {
    "text": "powerful uh feature of the way this dis",
    "start": "307919",
    "end": "310560"
  },
  {
    "text": "encryption works and it's also going to",
    "start": "310560",
    "end": "312280"
  },
  {
    "text": "be sort of just important to understand",
    "start": "312280",
    "end": "314320"
  },
  {
    "text": "that point that this allows you to",
    "start": "314320",
    "end": "318039"
  },
  {
    "text": "securely keep a secret in the TPM",
    "start": "318039",
    "end": "320400"
  },
  {
    "text": "without actually having to specify",
    "start": "320400",
    "end": "321880"
  },
  {
    "text": "password because it's just looking at",
    "start": "321880",
    "end": "323919"
  },
  {
    "text": "these PCR values to believe that it is",
    "start": "323919",
    "end": "327080"
  },
  {
    "text": "the original boot process asking for",
    "start": "327080",
    "end": "329199"
  },
  {
    "text": "that key feedb",
    "start": "329199",
    "end": "330400"
  },
  {
    "start": "330000",
    "end": "330000"
  },
  {
    "text": "back so bit Locker has the option of",
    "start": "330400",
    "end": "333759"
  },
  {
    "text": "using either a pin or a key saved on a",
    "start": "333759",
    "end": "337080"
  },
  {
    "text": "USB drive but these are optional if",
    "start": "337080",
    "end": "340520"
  },
  {
    "text": "you're using a TPM because it can just",
    "start": "340520",
    "end": "342840"
  },
  {
    "text": "rely on those PCR values to verify that",
    "start": "342840",
    "end": "346440"
  },
  {
    "text": "it is bit Locker asking for the key so",
    "start": "346440",
    "end": "349520"
  },
  {
    "text": "in its recommended configuration bit",
    "start": "349520",
    "end": "351440"
  },
  {
    "text": "Locker works transparently you don't",
    "start": "351440",
    "end": "353120"
  },
  {
    "text": "need to put in any sort of password or",
    "start": "353120",
    "end": "355080"
  },
  {
    "text": "pin and you can just turn on a machine",
    "start": "355080",
    "end": "357280"
  },
  {
    "text": "that's been encrypted and it will",
    "start": "357280",
    "end": "358560"
  },
  {
    "text": "decrypt the drive on boot and start",
    "start": "358560",
    "end": "360479"
  },
  {
    "text": "serving up clear text to Windows so if",
    "start": "360479",
    "end": "364639"
  },
  {
    "text": "you have bit Locker enabled this way you",
    "start": "364639",
    "end": "366680"
  },
  {
    "text": "might not even realize that dis",
    "start": "366680",
    "end": "368160"
  },
  {
    "text": "encryption has been enabled because it's",
    "start": "368160",
    "end": "369880"
  },
  {
    "text": "happening completely transparently when",
    "start": "369880",
    "end": "371639"
  },
  {
    "text": "you turn the machine on so the picture",
    "start": "371639",
    "end": "374639"
  },
  {
    "text": "of what this boot process looks like is",
    "start": "374639",
    "end": "376800"
  },
  {
    "text": "something like this and again this is",
    "start": "376800",
    "end": "378680"
  },
  {
    "text": "sort of a simplified thing because the",
    "start": "378680",
    "end": "380680"
  },
  {
    "text": "details here aren't too important for",
    "start": "380680",
    "end": "382720"
  },
  {
    "text": "where I'm going but the first part of",
    "start": "382720",
    "end": "384800"
  },
  {
    "text": "the boot process either the BIOS or the",
    "start": "384800",
    "end": "386759"
  },
  {
    "text": "EFI will read in the next part of the",
    "start": "386759",
    "end": "389080"
  },
  {
    "text": "boot stage hash that and put it in a PCR",
    "start": "389080",
    "end": "392560"
  },
  {
    "text": "in the TPM it then passes off control",
    "start": "392560",
    "end": "395960"
  },
  {
    "text": "and this is going to happen a few times",
    "start": "395960",
    "end": "397440"
  },
  {
    "text": "down the chain of control when it boots",
    "start": "397440",
    "end": "400039"
  },
  {
    "text": "but eventually when you get to the last",
    "start": "400039",
    "end": "401520"
  },
  {
    "text": "part of the boot process it's going to",
    "start": "401520",
    "end": "403199"
  },
  {
    "text": "ask the TPM to unseal the key and it's",
    "start": "403199",
    "end": "406440"
  },
  {
    "text": "going to put that key in the ram so that",
    "start": "406440",
    "end": "408240"
  },
  {
    "text": "the operating system in the future can",
    "start": "408240",
    "end": "410199"
  },
  {
    "text": "transparently encrypt and decrypt data",
    "start": "410199",
    "end": "412599"
  },
  {
    "text": "off of the physical drive so once that",
    "start": "412599",
    "end": "415879"
  },
  {
    "text": "key has been pulled out of the tpr then",
    "start": "415879",
    "end": "418039"
  },
  {
    "text": "it hands off control to the r regular",
    "start": "418039",
    "end": "419720"
  },
  {
    "text": "operating system which then begins",
    "start": "419720",
    "end": "421479"
  },
  {
    "text": "running as",
    "start": "421479",
    "end": "422919"
  },
  {
    "text": "usual so in this picture if you're",
    "start": "422919",
    "end": "425639"
  },
  {
    "text": "interested in attacking full dis",
    "start": "425639",
    "end": "427360"
  },
  {
    "text": "encryption there's sort of three",
    "start": "427360",
    "end": "429240"
  },
  {
    "text": "different boxes that I think of that you",
    "start": "429240",
    "end": "431400"
  },
  {
    "text": "could potentially attack so one is the",
    "start": "431400",
    "end": "435360"
  },
  {
    "text": "early stages of the boot process either",
    "start": "435360",
    "end": "437599"
  },
  {
    "text": "the BIOS or the EFI or one of these",
    "start": "437599",
    "end": "439759"
  },
  {
    "text": "early parts of the boot system there are",
    "start": "439759",
    "end": "442360"
  },
  {
    "text": "potentially bugs in there where you",
    "start": "442360",
    "end": "444319"
  },
  {
    "text": "could cause it to do something it's not",
    "start": "444319",
    "end": "446520"
  },
  {
    "text": "meant to do if the uh plat form isn't",
    "start": "446520",
    "end": "450120"
  },
  {
    "text": "set up to require signed firmware you",
    "start": "450120",
    "end": "452840"
  },
  {
    "text": "could put your own firmware on there and",
    "start": "452840",
    "end": "454680"
  },
  {
    "text": "do something malicious um there's the",
    "start": "454680",
    "end": "457720"
  },
  {
    "text": "physical Hardware that you could",
    "start": "457720",
    "end": "459080"
  },
  {
    "text": "potentially manipulate so there's",
    "start": "459080",
    "end": "461599"
  },
  {
    "text": "potential to do a cold boot attack on",
    "start": "461599",
    "end": "463879"
  },
  {
    "text": "the ram um there's also been known",
    "start": "463879",
    "end": "466039"
  },
  {
    "text": "attacks on TPMS and I'll say a bit more",
    "start": "466039",
    "end": "468080"
  },
  {
    "text": "about that in a second and then there's",
    "start": "468080",
    "end": "470000"
  },
  {
    "text": "the operating system obviously the",
    "start": "470000",
    "end": "472400"
  },
  {
    "text": "operating system is the biggest thing",
    "start": "472400",
    "end": "474360"
  },
  {
    "text": "here it's got a very large attack",
    "start": "474360",
    "end": "476560"
  },
  {
    "text": "surface so that's where I'm going going",
    "start": "476560",
    "end": "479440"
  },
  {
    "text": "to end up targeting this attack um this",
    "start": "479440",
    "end": "482720"
  },
  {
    "text": "is saying a lot of basically the same",
    "start": "482720",
    "end": "484360"
  },
  {
    "text": "things but there have been known attacks",
    "start": "484360",
    "end": "485879"
  },
  {
    "text": "on the hardware so I mentioned cold boot",
    "start": "485879",
    "end": "488039"
  },
  {
    "text": "is uh previously known attack where um",
    "start": "488039",
    "end": "491919"
  },
  {
    "text": "if you lower the ram temperature to",
    "start": "491919",
    "end": "494800"
  },
  {
    "text": "sufficiently low temperature it's not",
    "start": "494800",
    "end": "496240"
  },
  {
    "text": "going to lose its memory across a reboot",
    "start": "496240",
    "end": "499599"
  },
  {
    "text": "so since the TPM has already released",
    "start": "499599",
    "end": "502879"
  },
  {
    "text": "its key and the and bit Locker has put",
    "start": "502879",
    "end": "505400"
  },
  {
    "text": "that in the ram you could potentially",
    "start": "505400",
    "end": "507560"
  },
  {
    "text": "reboot into an attacker controlled",
    "start": "507560",
    "end": "509240"
  },
  {
    "text": "printing system and dump out those Ram",
    "start": "509240",
    "end": "511360"
  },
  {
    "text": "values uh before they get cleared from",
    "start": "511360",
    "end": "514360"
  },
  {
    "text": "memory so that's a known attack that",
    "start": "514360",
    "end": "516399"
  },
  {
    "text": "people have shown is somewhat effective",
    "start": "516399",
    "end": "520399"
  },
  {
    "text": "um there was also a vulnerability",
    "start": "520399",
    "end": "523120"
  },
  {
    "text": "discovered in old versions of the TPM",
    "start": "523120",
    "end": "525080"
  },
  {
    "text": "specification where you could actually",
    "start": "525080",
    "end": "526600"
  },
  {
    "text": "ground some of the pins on the physical",
    "start": "526600",
    "end": "528760"
  },
  {
    "text": "chip and it would C cause the PCR",
    "start": "528760",
    "end": "531440"
  },
  {
    "text": "registers to get cleared and go back to",
    "start": "531440",
    "end": "533279"
  },
  {
    "text": "zero and then a malicious operating",
    "start": "533279",
    "end": "535839"
  },
  {
    "text": "system could then spoof other PCR values",
    "start": "535839",
    "end": "538519"
  },
  {
    "text": "and you could then ask it to unseal a",
    "start": "538519",
    "end": "540160"
  },
  {
    "text": "key uh modern versions of the TPM spec",
    "start": "540160",
    "end": "543240"
  },
  {
    "text": "have fixed that flaw um but sort of all",
    "start": "543240",
    "end": "547160"
  },
  {
    "text": "I'm saying here is that it's not uh unw",
    "start": "547160",
    "end": "550160"
  },
  {
    "text": "warranted to worry about other potential",
    "start": "550160",
    "end": "551920"
  },
  {
    "text": "hardware issues um but as I said where",
    "start": "551920",
    "end": "555640"
  },
  {
    "text": "I'm going with this is we're going to",
    "start": "555640",
    "end": "557200"
  },
  {
    "text": "attack the operating system itself so if",
    "start": "557200",
    "end": "560560"
  },
  {
    "text": "bit Locker is set up to boot in this",
    "start": "560560",
    "end": "562240"
  },
  {
    "text": "transparent way then you turn on the",
    "start": "562240",
    "end": "565440"
  },
  {
    "text": "machine and it boots up to a login",
    "start": "565440",
    "end": "568279"
  },
  {
    "text": "screen so it's going to look something",
    "start": "568279",
    "end": "569640"
  },
  {
    "text": "like this so that means that logging in",
    "start": "569640",
    "end": "573040"
  },
  {
    "text": "to the Windows machine is then our",
    "start": "573040",
    "end": "575440"
  },
  {
    "text": "attack surface if you can get through",
    "start": "575440",
    "end": "577480"
  },
  {
    "text": "this screen then you are logged in as",
    "start": "577480",
    "end": "579160"
  },
  {
    "text": "the user and you have access to that",
    "start": "579160",
    "end": "580680"
  },
  {
    "text": "user's data so we're going to attack",
    "start": "580680",
    "end": "583480"
  },
  {
    "text": "Windows",
    "start": "583480",
    "end": "584959"
  },
  {
    "text": "authentication so to do that I'm going",
    "start": "584959",
    "end": "587160"
  },
  {
    "text": "to talk a little bit about how Windows",
    "start": "587160",
    "end": "588600"
  },
  {
    "text": "authentication works so the thing to",
    "start": "588600",
    "end": "591600"
  },
  {
    "text": "note from this screen where you're about",
    "start": "591600",
    "end": "593880"
  },
  {
    "text": "to log in is that there is something",
    "start": "593880",
    "end": "595680"
  },
  {
    "text": "that you probably recognize here which",
    "start": "595680",
    "end": "597360"
  },
  {
    "text": "is that it is showing a login for a user",
    "start": "597360",
    "end": "599680"
  },
  {
    "text": "on a domain and that means that this",
    "start": "599680",
    "end": "603160"
  },
  {
    "text": "machine is going to try to talk to a",
    "start": "603160",
    "end": "605000"
  },
  {
    "text": "domain controller and ask for that",
    "start": "605000",
    "end": "606560"
  },
  {
    "text": "domain controller to supply credentials",
    "start": "606560",
    "end": "608760"
  },
  {
    "text": "to authorize logging into this machine",
    "start": "608760",
    "end": "611279"
  },
  {
    "text": "so that means that again there is some",
    "start": "611279",
    "end": "613440"
  },
  {
    "text": "complexity involved and there's an",
    "start": "613440",
    "end": "614920"
  },
  {
    "text": "attack surface for us to try to get",
    "start": "614920",
    "end": "616600"
  },
  {
    "text": "through this login screen so Windows",
    "start": "616600",
    "end": "619959"
  },
  {
    "text": "authentication is H handled by the local",
    "start": "619959",
    "end": "622240"
  },
  {
    "text": "security Authority and that delegates",
    "start": "622240",
    "end": "625399"
  },
  {
    "text": "its authentication procedure to",
    "start": "625399",
    "end": "627000"
  },
  {
    "text": "different security subsystem providers",
    "start": "627000",
    "end": "629480"
  },
  {
    "text": "and one of those is used for client",
    "start": "629480",
    "end": "631200"
  },
  {
    "text": "domain authentication and it uses the",
    "start": "631200",
    "end": "633360"
  },
  {
    "text": "cerose protocol so when attacking full",
    "start": "633360",
    "end": "637680"
  },
  {
    "text": "dis encryption we're assuming that we",
    "start": "637680",
    "end": "639440"
  },
  {
    "text": "have physical access to the device so if",
    "start": "639440",
    "end": "642200"
  },
  {
    "text": "I'm carrying this laptop that's been uh",
    "start": "642200",
    "end": "645600"
  },
  {
    "text": "encrypted I can plug it into my own",
    "start": "645600",
    "end": "648160"
  },
  {
    "text": "network and run my own domain control on",
    "start": "648160",
    "end": "650920"
  },
  {
    "text": "that Network and force the login process",
    "start": "650920",
    "end": "653320"
  },
  {
    "text": "to talk to that domain",
    "start": "653320",
    "end": "655880"
  },
  {
    "text": "controller so when you log into a work",
    "start": "655880",
    "end": "659120"
  },
  {
    "start": "656000",
    "end": "656000"
  },
  {
    "text": "station that's connected to a domain the",
    "start": "659120",
    "end": "661519"
  },
  {
    "text": "first thing that's going to happen is",
    "start": "661519",
    "end": "664320"
  },
  {
    "text": "the machine is going to request for",
    "start": "664320",
    "end": "666240"
  },
  {
    "text": "What's called the ticket granting ticket",
    "start": "666240",
    "end": "667959"
  },
  {
    "text": "from the domain controller this is part",
    "start": "667959",
    "end": "670079"
  },
  {
    "text": "of the keros protocol and the ticket",
    "start": "670079",
    "end": "674160"
  },
  {
    "text": "granting ticket that the domain",
    "start": "674160",
    "end": "675360"
  },
  {
    "text": "controller will respond with is",
    "start": "675360",
    "end": "676839"
  },
  {
    "text": "basically a session token that's going",
    "start": "676839",
    "end": "678720"
  },
  {
    "text": "to last for the lifetime of that login",
    "start": "678720",
    "end": "681399"
  },
  {
    "text": "and this is what's used as part of this",
    "start": "681399",
    "end": "683279"
  },
  {
    "text": "sort of single sign on on Windows domain",
    "start": "683279",
    "end": "685720"
  },
  {
    "text": "so that you don't have to type in your",
    "start": "685720",
    "end": "687120"
  },
  {
    "text": "password when you log into any other",
    "start": "687120",
    "end": "688680"
  },
  {
    "text": "server",
    "start": "688680",
    "end": "690200"
  },
  {
    "text": "and what's returned with that ticket",
    "start": "690200",
    "end": "691880"
  },
  {
    "text": "granting ticket is also a secret that's",
    "start": "691880",
    "end": "693720"
  },
  {
    "text": "been encrypted with the user's password",
    "start": "693720",
    "end": "696000"
  },
  {
    "text": "it's assume that both that the domain",
    "start": "696000",
    "end": "698360"
  },
  {
    "text": "controller has a hash of the user's",
    "start": "698360",
    "end": "700680"
  },
  {
    "text": "password and when you type in the",
    "start": "700680",
    "end": "702639"
  },
  {
    "text": "password to the local computer then",
    "start": "702639",
    "end": "704440"
  },
  {
    "text": "there's also a copy of that password",
    "start": "704440",
    "end": "706399"
  },
  {
    "text": "temporarily on that computer so the",
    "start": "706399",
    "end": "709600"
  },
  {
    "text": "domain controller is going to respond",
    "start": "709600",
    "end": "711399"
  },
  {
    "text": "with a secret that's been encrypted with",
    "start": "711399",
    "end": "713160"
  },
  {
    "text": "the user password and then the local",
    "start": "713160",
    "end": "715120"
  },
  {
    "text": "machine will verify that it can decrypt",
    "start": "715120",
    "end": "717160"
  },
  {
    "text": "that secret using the password you just",
    "start": "717160",
    "end": "719079"
  },
  {
    "text": "typed in so this is something that we",
    "start": "719079",
    "end": "721880"
  },
  {
    "text": "can completely reproduce with our mock",
    "start": "721880",
    "end": "724720"
  },
  {
    "text": "domain controller we can set whatever",
    "start": "724720",
    "end": "727440"
  },
  {
    "text": "password we want on the domain",
    "start": "727440",
    "end": "728920"
  },
  {
    "text": "controller to use for encrypting this",
    "start": "728920",
    "end": "730560"
  },
  {
    "text": "secret and we can type in that same",
    "start": "730560",
    "end": "732360"
  },
  {
    "text": "thing right here with this device that",
    "start": "732360",
    "end": "734120"
  },
  {
    "text": "we're physically in front of so we can",
    "start": "734120",
    "end": "736360"
  },
  {
    "text": "use the same password in both places and",
    "start": "736360",
    "end": "738800"
  },
  {
    "text": "there's nothing wrong with reproducing",
    "start": "738800",
    "end": "740480"
  },
  {
    "text": "this part of the login process but",
    "start": "740480",
    "end": "743000"
  },
  {
    "text": "there's a second part of this curos",
    "start": "743000",
    "end": "744800"
  },
  {
    "text": "protocol that allows you to actually uh",
    "start": "744800",
    "end": "747959"
  },
  {
    "text": "authenticate that you have permission to",
    "start": "747959",
    "end": "749440"
  },
  {
    "text": "log into this particular",
    "start": "749440",
    "end": "751399"
  },
  {
    "text": "machine so after you have that ticket",
    "start": "751399",
    "end": "753720"
  },
  {
    "text": "granting ticket and the secret you then",
    "start": "753720",
    "end": "755680"
  },
  {
    "text": "need to request for an actual service",
    "start": "755680",
    "end": "757800"
  },
  {
    "text": "ticket that gives you permission to log",
    "start": "757800",
    "end": "760040"
  },
  {
    "text": "into that machine so you send the ticket",
    "start": "760040",
    "end": "762920"
  },
  {
    "text": "granting ticket and something encrypt",
    "start": "762920",
    "end": "764600"
  },
  {
    "text": "with that secret s to the domain",
    "start": "764600",
    "end": "766279"
  },
  {
    "text": "controller the domain controller does",
    "start": "766279",
    "end": "767800"
  },
  {
    "text": "some work and sends back a ticket and",
    "start": "767800",
    "end": "770600"
  },
  {
    "text": "then the local machine has to verify",
    "start": "770600",
    "end": "772800"
  },
  {
    "text": "that that is a valid ticket allowing",
    "start": "772800",
    "end": "775480"
  },
  {
    "text": "this user to log into this machine and",
    "start": "775480",
    "end": "777760"
  },
  {
    "text": "again this is something that we can try",
    "start": "777760",
    "end": "779079"
  },
  {
    "text": "and reproduce with our mock domain",
    "start": "779079",
    "end": "781399"
  },
  {
    "text": "controller but there's a complication",
    "start": "781399",
    "end": "784199"
  },
  {
    "text": "and that's machine passwords so just",
    "start": "784199",
    "end": "786480"
  },
  {
    "text": "like your user account has a password",
    "start": "786480",
    "end": "789040"
  },
  {
    "text": "every machine that's registered with a",
    "start": "789040",
    "end": "790800"
  },
  {
    "text": "domain controller also has a password",
    "start": "790800",
    "end": "792880"
  },
  {
    "text": "associated with that machine account so",
    "start": "792880",
    "end": "795360"
  },
  {
    "text": "when you first join the network with",
    "start": "795360",
    "end": "797480"
  },
  {
    "text": "when a machine first joins the domain it",
    "start": "797480",
    "end": "800639"
  },
  {
    "text": "generates a secret key and exchanges",
    "start": "800639",
    "end": "803600"
  },
  {
    "text": "that key with the domain controller so",
    "start": "803600",
    "end": "805320"
  },
  {
    "text": "is it so just like your user account has",
    "start": "805320",
    "end": "808079"
  },
  {
    "text": "a shared sec in the form of your",
    "start": "808079",
    "end": "809680"
  },
  {
    "text": "password each machine also has a shared",
    "start": "809680",
    "end": "812199"
  },
  {
    "text": "secret and because this device is",
    "start": "812199",
    "end": "814839"
  },
  {
    "text": "encrypted we don't know what that secret",
    "start": "814839",
    "end": "817360"
  },
  {
    "text": "is we can't just read it off the hard",
    "start": "817360",
    "end": "819680"
  },
  {
    "text": "drive and so we can't set up our domain",
    "start": "819680",
    "end": "822279"
  },
  {
    "text": "controller with that same secret so we",
    "start": "822279",
    "end": "824600"
  },
  {
    "text": "can try and generate this service ticket",
    "start": "824600",
    "end": "826600"
  },
  {
    "text": "T but that's supposed to be signed with",
    "start": "826600",
    "end": "828680"
  },
  {
    "text": "this machine password and so if we send",
    "start": "828680",
    "end": "831920"
  },
  {
    "text": "a service ticket that isn't signed with",
    "start": "831920",
    "end": "833800"
  },
  {
    "text": "the right machine passwords you get this",
    "start": "833800",
    "end": "836399"
  },
  {
    "text": "error message when you try to log in and",
    "start": "836399",
    "end": "838320"
  },
  {
    "text": "you can't really read it there but what",
    "start": "838320",
    "end": "839800"
  },
  {
    "text": "that says is the trust relationship",
    "start": "839800",
    "end": "841759"
  },
  {
    "text": "between this workstation and a primary",
    "start": "841759",
    "end": "843560"
  },
  {
    "text": "domain has failed so if you try to set",
    "start": "843560",
    "end": "846880"
  },
  {
    "text": "up your mock domain controller you set",
    "start": "846880",
    "end": "848560"
  },
  {
    "text": "any sort of arbitrary machine password",
    "start": "848560",
    "end": "851480"
  },
  {
    "text": "this is what's going to happen so this",
    "start": "851480",
    "end": "852839"
  },
  {
    "text": "isn't going to get you through the login",
    "start": "852839",
    "end": "855000"
  },
  {
    "text": "screen but the thing I haven't described",
    "start": "855000",
    "end": "857440"
  },
  {
    "text": "yet is what happens when the domain",
    "start": "857440",
    "end": "859800"
  },
  {
    "text": "controller isn't available let's say",
    "start": "859800",
    "end": "862040"
  },
  {
    "text": "you're at a conference and you're using",
    "start": "862040",
    "end": "863480"
  },
  {
    "text": "your laptop during someone's talk you",
    "start": "863480",
    "end": "865839"
  },
  {
    "text": "can still log in with your domain",
    "start": "865839",
    "end": "867600"
  },
  {
    "text": "password and that's because whenever the",
    "start": "867600",
    "end": "870920"
  },
  {
    "text": "uh keros SSP verifies that you have",
    "start": "870920",
    "end": "874079"
  },
  {
    "text": "logged into the machine it will cash",
    "start": "874079",
    "end": "876040"
  },
  {
    "text": "those credentials and allow you to log",
    "start": "876040",
    "end": "878360"
  },
  {
    "text": "in using those same credentials in the",
    "start": "878360",
    "end": "880320"
  },
  {
    "text": "future if it can authenticate with a",
    "start": "880320",
    "end": "882160"
  },
  {
    "text": "domain controller so that local cache",
    "start": "882160",
    "end": "886000"
  },
  {
    "text": "has to be updated anytime your password",
    "start": "886000",
    "end": "888519"
  },
  {
    "text": "has potentially changed so anytime it",
    "start": "888519",
    "end": "890639"
  },
  {
    "text": "sees a valid authentication or anytime",
    "start": "890639",
    "end": "893320"
  },
  {
    "text": "it sees that your password has been",
    "start": "893320",
    "end": "894920"
  },
  {
    "text": "changed it will update its cache so if",
    "start": "894920",
    "end": "898440"
  },
  {
    "text": "we could change the password from the",
    "start": "898440",
    "end": "900440"
  },
  {
    "text": "login screen that would allow us to",
    "start": "900440",
    "end": "902440"
  },
  {
    "text": "poison the cache with a different",
    "start": "902440",
    "end": "904600"
  },
  {
    "text": "attacker known password so if we could",
    "start": "904600",
    "end": "907680"
  },
  {
    "text": "only change the password on the login",
    "start": "907680",
    "end": "910480"
  },
  {
    "text": "screen well fortunately there is a",
    "start": "910480",
    "end": "912759"
  },
  {
    "text": "situation where that becomes possible if",
    "start": "912759",
    "end": "915160"
  },
  {
    "text": "the domain controller tells you that",
    "start": "915160",
    "end": "916920"
  },
  {
    "text": "your password has expired it will then",
    "start": "916920",
    "end": "919399"
  },
  {
    "text": "prompt you to change your password and",
    "start": "919399",
    "end": "922279"
  },
  {
    "text": "after that password change has been",
    "start": "922279",
    "end": "924199"
  },
  {
    "start": "924000",
    "end": "924000"
  },
  {
    "text": "completed that local cache gets poisoned",
    "start": "924199",
    "end": "927639"
  },
  {
    "text": "and you can log in with new password so",
    "start": "927639",
    "end": "930480"
  },
  {
    "text": "you are through the login screen and you",
    "start": "930480",
    "end": "932279"
  },
  {
    "text": "have access to all of that user's",
    "start": "932279",
    "end": "935160"
  },
  {
    "text": "data so what do you do after that well I",
    "start": "935160",
    "end": "938440"
  },
  {
    "text": "mean you're logged in if you have local",
    "start": "938440",
    "end": "940639"
  },
  {
    "text": "administrative uh rights you can dump",
    "start": "940639",
    "end": "943000"
  },
  {
    "text": "the bit locker key out of Kernel memory",
    "start": "943000",
    "end": "946079"
  },
  {
    "text": "um although it's kind of mood at this",
    "start": "946079",
    "end": "947440"
  },
  {
    "text": "point you already have access to all the",
    "start": "947440",
    "end": "948920"
  },
  {
    "text": "users data um so you can dig through",
    "start": "948920",
    "end": "951440"
  },
  {
    "text": "whatever data is on there you can drop",
    "start": "951440",
    "end": "953680"
  },
  {
    "text": "in malware if uh this was just",
    "start": "953680",
    "end": "956279"
  },
  {
    "text": "temporarily accessing someone's device",
    "start": "956279",
    "end": "959279"
  },
  {
    "text": "um you can basically do whatever you",
    "start": "959279",
    "end": "961199"
  },
  {
    "text": "want so now let's try to do a demo so",
    "start": "961199",
    "end": "965959"
  },
  {
    "text": "this is my encrypted machine um I don't",
    "start": "965959",
    "end": "970199"
  },
  {
    "text": "know the password on it if I just try",
    "start": "970199",
    "end": "972399"
  },
  {
    "text": "and log in it's not going to let me so",
    "start": "972399",
    "end": "976519"
  },
  {
    "text": "I'm going to set up my mock domain",
    "start": "976519",
    "end": "978880"
  },
  {
    "text": "controller using this super cool package",
    "start": "978880",
    "end": "981959"
  },
  {
    "text": "you may never have heard of called",
    "start": "981959",
    "end": "985120"
  },
  {
    "text": "sambba you oh well what did I",
    "start": "986480",
    "end": "991160"
  },
  {
    "text": "do all right I didn't properly invoke",
    "start": "992759",
    "end": "996319"
  },
  {
    "text": "the demo",
    "start": "996319",
    "end": "997560"
  },
  {
    "text": "Gods",
    "start": "997560",
    "end": "999800"
  },
  {
    "text": "uh oh right I think I know it's just",
    "start": "999800",
    "end": "1002279"
  },
  {
    "text": "because I haven't actually configured it",
    "start": "1002279",
    "end": "1004079"
  },
  {
    "text": "yet all right so let's configure it to",
    "start": "1004079",
    "end": "1006360"
  },
  {
    "text": "be a domain",
    "start": "1006360",
    "end": "1008759"
  },
  {
    "text": "controller um there it is so I've",
    "start": "1008759",
    "end": "1011839"
  },
  {
    "text": "already set this in so that the defaults",
    "start": "1011839",
    "end": "1013680"
  },
  {
    "text": "will match the domain that you can just",
    "start": "1013680",
    "end": "1016319"
  },
  {
    "text": "read off the login screen",
    "start": "1016319",
    "end": "1020199"
  },
  {
    "text": "and then I'm setting an admin password",
    "start": "1020199",
    "end": "1022279"
  },
  {
    "text": "on this new domain it doesn't matter",
    "start": "1022279",
    "end": "1024000"
  },
  {
    "text": "what it",
    "start": "1024000",
    "end": "1026360"
  },
  {
    "text": "is and it does a lot of work apparently",
    "start": "1028439",
    "end": "1030798"
  },
  {
    "text": "domains are",
    "start": "1030799",
    "end": "1032760"
  },
  {
    "text": "complicated uh so then I'm going to",
    "start": "1032760",
    "end": "1035760"
  },
  {
    "text": "restart my SBA",
    "start": "1035760",
    "end": "1038400"
  },
  {
    "text": "service and then set a password for this",
    "start": "1038400",
    "end": "1042640"
  },
  {
    "text": "user account in a way that it will show",
    "start": "1042640",
    "end": "1045120"
  },
  {
    "text": "up as being expired so here's the big",
    "start": "1045120",
    "end": "1048679"
  },
  {
    "text": "long command to do it I'm noting the",
    "start": "1048679",
    "end": "1050919"
  },
  {
    "text": "current date I'm setting the date to",
    "start": "1050919",
    "end": "1052919"
  },
  {
    "text": "2001 I set a password on a new account",
    "start": "1052919",
    "end": "1056160"
  },
  {
    "text": "and then I set the date back to",
    "start": "1056160",
    "end": "1058520"
  },
  {
    "text": "normal there it's done all right so",
    "start": "1058520",
    "end": "1061240"
  },
  {
    "text": "there's my expired user account and now",
    "start": "1061240",
    "end": "1064039"
  },
  {
    "text": "let me connect this machine to the",
    "start": "1064039",
    "end": "1067679"
  },
  {
    "text": "network where it will discover that the",
    "start": "1067679",
    "end": "1070480"
  },
  {
    "text": "the miskatonic domain controller is on",
    "start": "1070480",
    "end": "1072320"
  },
  {
    "text": "the network and try to contact it to log",
    "start": "1072320",
    "end": "1076600"
  },
  {
    "text": "in and I didn't actually spell password",
    "start": "1076600",
    "end": "1079080"
  },
  {
    "text": "correctly let's try it",
    "start": "1079080",
    "end": "1080640"
  },
  {
    "text": "again so there I'm logging in with that",
    "start": "1080640",
    "end": "1084080"
  },
  {
    "text": "password I just set on the command line",
    "start": "1084080",
    "end": "1086039"
  },
  {
    "text": "my password's expired let's change it to",
    "start": "1086039",
    "end": "1088000"
  },
  {
    "text": "something else like password",
    "start": "1088000",
    "end": "1091520"
  },
  {
    "text": "122 yep there it",
    "start": "1091520",
    "end": "1095000"
  },
  {
    "text": "is so all right my password has been",
    "start": "1095000",
    "end": "1098039"
  },
  {
    "text": "changed awesome I still can't log in",
    "start": "1098039",
    "end": "1100760"
  },
  {
    "text": "because there's no computer account for",
    "start": "1100760",
    "end": "1102200"
  },
  {
    "text": "this workstation on the domain",
    "start": "1102200",
    "end": "1103880"
  },
  {
    "text": "controller which is true I didn't",
    "start": "1103880",
    "end": "1105799"
  },
  {
    "text": "actually set up a machine account for",
    "start": "1105799",
    "end": "1107880"
  },
  {
    "text": "this work station but I'm just going to",
    "start": "1107880",
    "end": "1110159"
  },
  {
    "text": "take it back off the network so that it",
    "start": "1110159",
    "end": "1112080"
  },
  {
    "text": "uses the",
    "start": "1112080",
    "end": "1113880"
  },
  {
    "text": "cache and there's that new password I",
    "start": "1113880",
    "end": "1116360"
  },
  {
    "text": "just",
    "start": "1116360",
    "end": "1117440"
  },
  {
    "text": "set and it's logging me",
    "start": "1117440",
    "end": "1120570"
  },
  {
    "text": "[Applause]",
    "start": "1120570",
    "end": "1124460"
  },
  {
    "text": "[Music]",
    "start": "1124460",
    "end": "1126559"
  },
  {
    "text": "in so whatever the user has on there you",
    "start": "1126559",
    "end": "1129880"
  },
  {
    "text": "can read",
    "start": "1129880",
    "end": "1132280"
  },
  {
    "text": "it so what does this apply to so like I",
    "start": "1132799",
    "end": "1136440"
  },
  {
    "text": "said this applies to bit Locker if you",
    "start": "1136440",
    "end": "1138559"
  },
  {
    "text": "don't have preboot authentication",
    "start": "1138559",
    "end": "1140360"
  },
  {
    "text": "enabled so as long as uh you didn't set",
    "start": "1140360",
    "end": "1143159"
  },
  {
    "text": "a pin or USB key on it you can boot up",
    "start": "1143159",
    "end": "1145880"
  },
  {
    "text": "to login screen and you can run this",
    "start": "1145880",
    "end": "1147440"
  },
  {
    "text": "attack obviously this assumes that there",
    "start": "1147440",
    "end": "1150120"
  },
  {
    "text": "is a domain account on that machine that",
    "start": "1150120",
    "end": "1152039"
  },
  {
    "text": "you're logging in as so it needs to be",
    "start": "1152039",
    "end": "1153520"
  },
  {
    "text": "attached to a domain you have to have",
    "start": "1153520",
    "end": "1155280"
  },
  {
    "text": "logged into it before with that account",
    "start": "1155280",
    "end": "1157679"
  },
  {
    "text": "um if you're talking about like a laptop",
    "start": "1157679",
    "end": "1159760"
  },
  {
    "text": "this is pretty likely that this is the",
    "start": "1159760",
    "end": "1161679"
  },
  {
    "text": "way it's set up I tested this on every",
    "start": "1161679",
    "end": "1164280"
  },
  {
    "text": "version of Windows that's currently out",
    "start": "1164280",
    "end": "1166000"
  },
  {
    "text": "there I even test it on XP and Windows 2",
    "start": "1166000",
    "end": "1168280"
  },
  {
    "text": "000 which is sort of moot because bit",
    "start": "1168280",
    "end": "1171080"
  },
  {
    "text": "Locker wasn't added until Vista but um",
    "start": "1171080",
    "end": "1174039"
  },
  {
    "text": "the point is that this flaw in the",
    "start": "1174039",
    "end": "1176080"
  },
  {
    "text": "Authentication Protocol has always been",
    "start": "1176080",
    "end": "1179760"
  },
  {
    "text": "there um so obviously this is a bypass",
    "start": "1179760",
    "end": "1183320"
  },
  {
    "text": "to authentication this isn't really bit",
    "start": "1183320",
    "end": "1185320"
  },
  {
    "text": "Locker specific but it's really",
    "start": "1185320",
    "end": "1187520"
  },
  {
    "text": "interesting in the context where bit",
    "start": "1187520",
    "end": "1189360"
  },
  {
    "text": "Locker is enabled because if bit Locker",
    "start": "1189360",
    "end": "1191240"
  },
  {
    "text": "isn't enabled then you could just boot",
    "start": "1191240",
    "end": "1193280"
  },
  {
    "text": "into an attacker OS and reset passwords",
    "start": "1193280",
    "end": "1195679"
  },
  {
    "text": "anyway um but it does potentially have",
    "start": "1195679",
    "end": "1198280"
  },
  {
    "text": "have other valid attack scenarios so if",
    "start": "1198280",
    "end": "1200320"
  },
  {
    "text": "someone's locked their computer and",
    "start": "1200320",
    "end": "1201640"
  },
  {
    "text": "walked away from it and you're looking",
    "start": "1201640",
    "end": "1203360"
  },
  {
    "text": "for an attack that gets you past the",
    "start": "1203360",
    "end": "1205000"
  },
  {
    "text": "lock screen a little faster than",
    "start": "1205000",
    "end": "1206559"
  },
  {
    "text": "rebooting into your own operating system",
    "start": "1206559",
    "end": "1209000"
  },
  {
    "text": "you can execute this attack in a matter",
    "start": "1209000",
    "end": "1210760"
  },
  {
    "text": "of seconds um you know sort of I had",
    "start": "1210760",
    "end": "1213559"
  },
  {
    "text": "this setup where I had to read off the",
    "start": "1213559",
    "end": "1215120"
  },
  {
    "text": "domain off of the login screen and set",
    "start": "1215120",
    "end": "1216760"
  },
  {
    "text": "my thing up but the domain and the",
    "start": "1216760",
    "end": "1219640"
  },
  {
    "text": "username is all transmitted in clear",
    "start": "1219640",
    "end": "1221720"
  },
  {
    "text": "text so you can set up a do or a piece",
    "start": "1221720",
    "end": "1225400"
  },
  {
    "text": "of software that will act as a domain",
    "start": "1225400",
    "end": "1227080"
  },
  {
    "text": "controller and just automat atically",
    "start": "1227080",
    "end": "1228840"
  },
  {
    "text": "reply as so as that domain controller",
    "start": "1228840",
    "end": "1230440"
  },
  {
    "text": "you don't have to run a full Samba to ex",
    "start": "1230440",
    "end": "1232880"
  },
  {
    "text": "execute this um so mitigations you could",
    "start": "1232880",
    "end": "1237400"
  },
  {
    "text": "use some form of pre-boot authentication",
    "start": "1237400",
    "end": "1239400"
  },
  {
    "text": "you can follow ta's advice and use a pin",
    "start": "1239400",
    "end": "1242400"
  },
  {
    "text": "um personally if uh on my machine I like",
    "start": "1242400",
    "end": "1245559"
  },
  {
    "text": "using preboot authentication I like that",
    "start": "1245559",
    "end": "1247600"
  },
  {
    "text": "added security but deploying this",
    "start": "1247600",
    "end": "1250200"
  },
  {
    "text": "Corporation wide if you're talking about",
    "start": "1250200",
    "end": "1252280"
  },
  {
    "text": "like a Enterprise corporate Network",
    "start": "1252280",
    "end": "1254520"
  },
  {
    "text": "where there's thousands of laptops in",
    "start": "1254520",
    "end": "1256360"
  },
  {
    "text": "the system that is something that is",
    "start": "1256360",
    "end": "1258480"
  },
  {
    "text": "really hard to sell um this is from some",
    "start": "1258480",
    "end": "1262760"
  },
  {
    "text": "quotes from Microsoft's techet",
    "start": "1262760",
    "end": "1264799"
  },
  {
    "text": "documentation basically explaining why",
    "start": "1264799",
    "end": "1267039"
  },
  {
    "text": "it's A Hard Sell to have pre-boot",
    "start": "1267039",
    "end": "1269039"
  },
  {
    "text": "authentication you physically have to be",
    "start": "1269039",
    "end": "1270880"
  },
  {
    "text": "at machines to reboot them and so if",
    "start": "1270880",
    "end": "1273120"
  },
  {
    "text": "you're talking about remote",
    "start": "1273120",
    "end": "1275120"
  },
  {
    "text": "workstations uh you know servers as",
    "start": "1275120",
    "end": "1277799"
  },
  {
    "text": "opposed to laptops um if you reboot it",
    "start": "1277799",
    "end": "1280919"
  },
  {
    "text": "someone has to go into the data center",
    "start": "1280919",
    "end": "1282600"
  },
  {
    "text": "to enter a pin that's not really",
    "start": "1282600",
    "end": "1284080"
  },
  {
    "text": "acceptable and even if you're talking",
    "start": "1284080",
    "end": "1285960"
  },
  {
    "text": "about someone's laptop if if uh they",
    "start": "1285960",
    "end": "1289240"
  },
  {
    "text": "forget their pin in the middle of a trip",
    "start": "1289240",
    "end": "1291240"
  },
  {
    "text": "like they can't reset it until they get",
    "start": "1291240",
    "end": "1293279"
  },
  {
    "text": "back on the domain Network to get a",
    "start": "1293279",
    "end": "1294880"
  },
  {
    "text": "recovery key from the domain controller",
    "start": "1294880",
    "end": "1297480"
  },
  {
    "text": "so Microsoft recommends not using",
    "start": "1297480",
    "end": "1299919"
  },
  {
    "text": "preboot",
    "start": "1299919",
    "end": "1301320"
  },
  {
    "text": "authentication so the good news is that",
    "start": "1301320",
    "end": "1304320"
  },
  {
    "text": "Microsoft has released a patch to fix",
    "start": "1304320",
    "end": "1306559"
  },
  {
    "text": "this bypass it landed 3 days ago so uh",
    "start": "1306559",
    "end": "1311120"
  },
  {
    "text": "update your workstations the patch",
    "start": "1311120",
    "end": "1313520"
  },
  {
    "text": "requires that after it does the old",
    "start": "1313520",
    "end": "1316480"
  },
  {
    "text": "password reset protocol it does do a",
    "start": "1316480",
    "end": "1318320"
  },
  {
    "text": "full authentication with the machine",
    "start": "1318320",
    "end": "1321120"
  },
  {
    "text": "password to make sure that the domain",
    "start": "1321120",
    "end": "1323360"
  },
  {
    "text": "controller also is giving you access",
    "start": "1323360",
    "end": "1325360"
  },
  {
    "text": "this machine before it updates the cache",
    "start": "1325360",
    "end": "1327840"
  },
  {
    "text": "so I do want to give an acknowledgement",
    "start": "1327840",
    "end": "1329480"
  },
  {
    "text": "to the Microsoft security Response",
    "start": "1329480",
    "end": "1331120"
  },
  {
    "text": "Center who are really proactive about",
    "start": "1331120",
    "end": "1333200"
  },
  {
    "text": "working with me to get a patch out for",
    "start": "1333200",
    "end": "1335799"
  },
  {
    "text": "this",
    "start": "1335799",
    "end": "1336720"
  },
  {
    "text": "issue so in just a few minutes that I",
    "start": "1336720",
    "end": "1339520"
  },
  {
    "start": "1337000",
    "end": "1337000"
  },
  {
    "text": "have left I also want to just kind of",
    "start": "1339520",
    "end": "1341400"
  },
  {
    "text": "reflect on why this attack works like I",
    "start": "1341400",
    "end": "1344320"
  },
  {
    "text": "said this bypass works even in Windows",
    "start": "1344320",
    "end": "1346799"
  },
  {
    "text": "2000 this is something that's always",
    "start": "1346799",
    "end": "1348919"
  },
  {
    "text": "been part of the protocol and the way it",
    "start": "1348919",
    "end": "1350799"
  },
  {
    "text": "works and when this thing was designed",
    "start": "1350799",
    "end": "1354440"
  },
  {
    "text": "back in",
    "start": "1354440",
    "end": "1355840"
  },
  {
    "text": "2000 uh physical access was Total Access",
    "start": "1355840",
    "end": "1359520"
  },
  {
    "text": "full dis encryption wasn't common place",
    "start": "1359520",
    "end": "1363039"
  },
  {
    "text": "and I don't think this kind of a threat",
    "start": "1363039",
    "end": "1365120"
  },
  {
    "text": "model existed as part of the protocol",
    "start": "1365120",
    "end": "1366960"
  },
  {
    "text": "design where you can physically access",
    "start": "1366960",
    "end": "1369720"
  },
  {
    "text": "the workstation and the network and you",
    "start": "1369720",
    "end": "1371799"
  },
  {
    "text": "control the DC and somehow you're still",
    "start": "1371799",
    "end": "1374240"
  },
  {
    "text": "attacking the local machine that wasn't",
    "start": "1374240",
    "end": "1375760"
  },
  {
    "text": "part of the threat model but uh as hun",
    "start": "1375760",
    "end": "1379320"
  },
  {
    "text": "said in the keynote yesterday we need to",
    "start": "1379320",
    "end": "1382120"
  },
  {
    "text": "reexamine Old truths threat models",
    "start": "1382120",
    "end": "1384279"
  },
  {
    "text": "change and this is a perfect example",
    "start": "1384279",
    "end": "1386720"
  },
  {
    "text": "where old assumptions don't apply",
    "start": "1386720",
    "end": "1388919"
  },
  {
    "text": "anymore",
    "start": "1388919",
    "end": "1390440"
  },
  {
    "text": "so uh I think that's just a good lesson",
    "start": "1390440",
    "end": "1393279"
  },
  {
    "text": "in this context and others to remember",
    "start": "1393279",
    "end": "1397520"
  },
  {
    "text": "so um these are the black hat sound",
    "start": "1397520",
    "end": "1400440"
  },
  {
    "start": "1398000",
    "end": "1398000"
  },
  {
    "text": "bites for the talk uh there's a defects",
    "start": "1400440",
    "end": "1402799"
  },
  {
    "text": "in Windows domain authentication which",
    "start": "1402799",
    "end": "1404720"
  },
  {
    "text": "means bit Locker Under the right",
    "start": "1404720",
    "end": "1407000"
  },
  {
    "text": "conditions can be to bypassed all of its",
    "start": "1407000",
    "end": "1409279"
  },
  {
    "text": "protections gone but there is an update",
    "start": "1409279",
    "end": "1412000"
  },
  {
    "text": "that fixes this so patch your machines",
    "start": "1412000",
    "end": "1414200"
  },
  {
    "text": "that's always the thing that you should",
    "start": "1414200",
    "end": "1415720"
  },
  {
    "text": "remember security right deploy your",
    "start": "1415720",
    "end": "1418480"
  },
  {
    "text": "updates um and then the last point that",
    "start": "1418480",
    "end": "1420799"
  },
  {
    "text": "threat models change so you need to",
    "start": "1420799",
    "end": "1423480"
  },
  {
    "text": "constantly be re-evaluating old",
    "start": "1423480",
    "end": "1425360"
  },
  {
    "text": "decisions and I think that's also in a",
    "start": "1425360",
    "end": "1427440"
  },
  {
    "text": "way good news for us because I think it",
    "start": "1427440",
    "end": "1428960"
  },
  {
    "text": "means that we're never going to be done",
    "start": "1428960",
    "end": "1430760"
  },
  {
    "text": "with our work so there's always a job",
    "start": "1430760",
    "end": "1432600"
  },
  {
    "text": "for us so that's it uh there's about 5",
    "start": "1432600",
    "end": "1435880"
  },
  {
    "text": "minutes for questions if you guys have",
    "start": "1435880",
    "end": "1437440"
  },
  {
    "text": "them thank you for",
    "start": "1437440",
    "end": "1440320"
  },
  {
    "text": "coming any",
    "start": "1447039",
    "end": "1450278"
  },
  {
    "text": "questions all right uh",
    "start": "1451679",
    "end": "1455679"
  },
  {
    "text": "yes",
    "start": "1455679",
    "end": "1457360"
  },
  {
    "text": "loal uh he asked if it's possible to",
    "start": "1457360",
    "end": "1460039"
  },
  {
    "text": "disable the local cache and yes it is um",
    "start": "1460039",
    "end": "1464520"
  },
  {
    "text": "that means though that you have to",
    "start": "1464520",
    "end": "1466320"
  },
  {
    "text": "contact the domain controller to log in",
    "start": "1466320",
    "end": "1468559"
  },
  {
    "text": "so it means that there's no way to take",
    "start": "1468559",
    "end": "1470039"
  },
  {
    "text": "your laptop to a coffee shop and then be",
    "start": "1470039",
    "end": "1471840"
  },
  {
    "text": "able to log into it you can't take it to",
    "start": "1471840",
    "end": "1474360"
  },
  {
    "text": "a conference you can't take it on a trip",
    "start": "1474360",
    "end": "1475799"
  },
  {
    "text": "so uh it is possible but most people",
    "start": "1475799",
    "end": "1478720"
  },
  {
    "text": "don't because of that",
    "start": "1478720",
    "end": "1481200"
  },
  {
    "text": "reason",
    "start": "1481200",
    "end": "1484200"
  },
  {
    "text": "yes um he's he asked if there's any",
    "start": "1488799",
    "end": "1491559"
  },
  {
    "text": "special consideration for setting up the",
    "start": "1491559",
    "end": "1493200"
  },
  {
    "text": "domain controller um other than the",
    "start": "1493200",
    "end": "1495279"
  },
  {
    "text": "domain name and the KDC realm match in",
    "start": "1495279",
    "end": "1498520"
  },
  {
    "text": "uh no you just have to type in those",
    "start": "1498520",
    "end": "1500440"
  },
  {
    "text": "right things that you sort",
    "start": "1500440",
    "end": "1502640"
  },
  {
    "text": "of yeah user account domain has to match",
    "start": "1502640",
    "end": "1505840"
  },
  {
    "text": "that's it I didn't have to patch Soma at",
    "start": "1505840",
    "end": "1508320"
  },
  {
    "text": "all when I first started down this",
    "start": "1508320",
    "end": "1509960"
  },
  {
    "text": "project I was patching Soma all over the",
    "start": "1509960",
    "end": "1512240"
  },
  {
    "text": "place to always reply yeah that's the",
    "start": "1512240",
    "end": "1513720"
  },
  {
    "text": "right password yeah you got it right um",
    "start": "1513720",
    "end": "1515960"
  },
  {
    "text": "and then I found out that I didn't have",
    "start": "1515960",
    "end": "1517039"
  },
  {
    "text": "to do any of that it is a completely",
    "start": "1517039",
    "end": "1519320"
  },
  {
    "text": "off-the-shelf version of Samba that I'm",
    "start": "1519320",
    "end": "1522880"
  },
  {
    "text": "using all right I don't see any other",
    "start": "1524919",
    "end": "1527440"
  },
  {
    "text": "question question I'm going to be around",
    "start": "1527440",
    "end": "1528960"
  },
  {
    "text": "if anyone oh there's one",
    "start": "1528960",
    "end": "1532080"
  },
  {
    "text": "yes I'll try I'll see see if I can break",
    "start": "1540159",
    "end": "1543399"
  },
  {
    "text": "the patch later I don't know now they",
    "start": "1543399",
    "end": "1546000"
  },
  {
    "text": "know about the issue so it's going to be",
    "start": "1546000",
    "end": "1548279"
  },
  {
    "text": "harder all right I'm going to be around",
    "start": "1548279",
    "end": "1550279"
  },
  {
    "text": "if people have other questions so thank",
    "start": "1550279",
    "end": "1552960"
  },
  {
    "text": "you",
    "start": "1552960",
    "end": "1555158"
  },
  {
    "text": "again",
    "start": "1555279",
    "end": "1558279"
  }
]