[
  {
    "start": "0",
    "end": "54000"
  },
  {
    "text": "all right good afternoon everybody we had a little bit of technical difficulties but we're up ready to go everything should be good um this is",
    "start": "80",
    "end": "7240"
  },
  {
    "text": "amsi how Windows 10 plans to stop script-based attacks and how well it does it with nikil Matel I'm sorry M",
    "start": "7240",
    "end": "15840"
  },
  {
    "text": "that's M um you are in uh manderlay bay GH just got a couple of quick",
    "start": "15840",
    "end": "22560"
  },
  {
    "text": "announcements um if you haven't already stopped by the business Hall in the Bayside AB that's that's uh downstairs",
    "start": "22560",
    "end": "28880"
  },
  {
    "text": "uh anytime during the day or especially during the welcome registra reception from 1730 to 1900 also the black hat",
    "start": "28880",
    "end": "35600"
  },
  {
    "text": "Arsenal is on the palm foyer on level three a lot of good stuff to check out up there uh and then join us for the",
    "start": "35600",
    "end": "41800"
  },
  {
    "text": "pony Awards in Mandalay Bay BCD at 18:30 and if you haven't already please take a",
    "start": "41800",
    "end": "47960"
  },
  {
    "text": "minute to set your phone on silent so that it doesn't interrupt the presentation thank you",
    "start": "47960",
    "end": "54039"
  },
  {
    "start": "54000",
    "end": "64000"
  },
  {
    "text": "go thank you very much uh thank you all for coming welcome to the session where",
    "start": "54039",
    "end": "59600"
  },
  {
    "text": "we discuss amsi U let's get started couple of things about me",
    "start": "59600",
    "end": "66720"
  },
  {
    "start": "64000",
    "end": "131000"
  },
  {
    "text": "first my name is nikil ml that you all know up to now uh you can find me on Twitter as n i k h i lore Mt I a sucker",
    "start": "66720",
    "end": "76479"
  },
  {
    "text": "for Twitter follower so please go there follow me uh I blog on lab of a penetration tester.com you can check",
    "start": "76479",
    "end": "83560"
  },
  {
    "text": "that out well out as well all of the things which I work on I generally like to U write a blog about them",
    "start": "83560",
    "end": "90520"
  },
  {
    "text": "uh I maintained two open source toolkits of which I think are useful for penetration testes and good attackers",
    "start": "90520",
    "end": "97280"
  },
  {
    "text": "cila and nishang cotilla is a toolkit which you can use for using human interface devices in penetration t uh",
    "start": "97280",
    "end": "105840"
  },
  {
    "text": "and then there is nishang a tool which could be used to which is a collection",
    "start": "105840",
    "end": "111119"
  },
  {
    "text": "of offensive power shell scripts scripts which you can use in penetration tests",
    "start": "111119",
    "end": "116320"
  },
  {
    "text": "and Red Team operations uh I'm a penetration tester and trainer by job I'm an associate consultant with not so",
    "start": "116320",
    "end": "122880"
  },
  {
    "text": "secure I've spoken at a couple of conferences before as well Defcon can",
    "start": "122880",
    "end": "128160"
  },
  {
    "text": "West sheon and actually a few more so are going to discuss in the",
    "start": "128160",
    "end": "135080"
  },
  {
    "start": "131000",
    "end": "186000"
  },
  {
    "text": "class uh script based attacks what are they how attackers use it why they are",
    "start": "135080",
    "end": "141280"
  },
  {
    "text": "used that's that's going to be the start of the class then uh I'll introduce you to amsi",
    "start": "141280",
    "end": "148920"
  },
  {
    "text": "what amsi is why it was involved or included in Windows 10 what are the",
    "start": "148920",
    "end": "155599"
  },
  {
    "text": "benefits of it we'll see its detection capabilities detection capabilities of",
    "start": "155599",
    "end": "161080"
  },
  {
    "text": "amsi uh we'll see what were the fielded attempts when I experimented with bypassing it so I experimented it",
    "start": "161080",
    "end": "169280"
  },
  {
    "text": "blindly as well as with some mind applying to it so results May VAR and",
    "start": "169280",
    "end": "175959"
  },
  {
    "text": "then we'll see how we can actually bypass amsi what are the ways how we can avoid it bypass it unload it things like",
    "start": "175959",
    "end": "184000"
  },
  {
    "text": "that and that would be the end of the talk so script based",
    "start": "184000",
    "end": "189239"
  },
  {
    "start": "186000",
    "end": "435000"
  },
  {
    "text": "attacks amsi generally wants to Target three kind of things po shell VB script",
    "start": "189239",
    "end": "194519"
  },
  {
    "text": "jscript I am more interested in Powershell I got started with my affair",
    "start": "194519",
    "end": "201080"
  },
  {
    "text": "with amsi started when I was testing couple of my scripts on a Windows 10",
    "start": "201080",
    "end": "206159"
  },
  {
    "text": "machine and they were still getting detected in memory so as any good",
    "start": "206159",
    "end": "211680"
  },
  {
    "text": "attacker uh I generally avoid to touch discs so if the attack script gets",
    "start": "211680",
    "end": "218360"
  },
  {
    "text": "detected in memory that's really heartbreak you know you try to stay in memory just to avoid detection but you",
    "start": "218360",
    "end": "224000"
  },
  {
    "text": "still get detected so that the kind of feeling of the Betrayal which I C by the",
    "start": "224000",
    "end": "230360"
  },
  {
    "text": "hands of Windows that's that's where I started to look more seriously into amsi U poers shell I specifically want",
    "start": "230360",
    "end": "238400"
  },
  {
    "text": "to focus on because this is the most modern thing or the latest hot thing in",
    "start": "238400",
    "end": "245360"
  },
  {
    "text": "the windows post exploitation scenario and that's why it's it's really",
    "start": "245360",
    "end": "250640"
  },
  {
    "text": "imperative to fun how uh learn to use it that's that's what I'm doing right now",
    "start": "250640",
    "end": "256120"
  },
  {
    "text": "second if there's something which comes between you and your beloved Powershell then just eliminate that thing U why do",
    "start": "256120",
    "end": "262680"
  },
  {
    "text": "we use Powershell first of all low rate of detection still even after amsi",
    "start": "262680",
    "end": "268040"
  },
  {
    "text": "compare any execu cable and a corresponding power shell script and you'll know what I'm trying to convey",
    "start": "268040",
    "end": "274639"
  },
  {
    "text": "here if you can use a Powershell Port of any tool you have or just use some",
    "start": "274639",
    "end": "281039"
  },
  {
    "text": "awesome scripts out there to load your executables in memory of other processes using power shell and then use it so",
    "start": "281039",
    "end": "288039"
  },
  {
    "text": "that's one thing because of really low rate of detection that's that's the first part and then U Powershell attacks",
    "start": "288039",
    "end": "296240"
  },
  {
    "text": "are very effective it is something which is already there on all modern Windows operating Machines of Windows vist",
    "start": "296240",
    "end": "302680"
  },
  {
    "text": "onwards you won't find any Windows machine which has which has not uh which",
    "start": "302680",
    "end": "307960"
  },
  {
    "text": "has no Powershell in it they all come preloaded with Powershell different versions so that's that's it about it",
    "start": "307960",
    "end": "315720"
  },
  {
    "text": "another thing with why I like to use Powershell it is used by System administrators that means uh you can",
    "start": "315720",
    "end": "323120"
  },
  {
    "text": "actually try and stay off the radar because you may mix with the actual",
    "start": "323120",
    "end": "329080"
  },
  {
    "text": "normal traffic in environment or normal scripts which are being used so that's",
    "start": "329080",
    "end": "335080"
  },
  {
    "text": "the second reason uh it provides access to a lot of os and network of things for",
    "start": "335080",
    "end": "342199"
  },
  {
    "text": "example using Powershell you can access wmi net Registries Windows API do not",
    "start": "342199",
    "end": "348000"
  },
  {
    "text": "net regist is my bad Windows registry net classes or other machines on the",
    "start": "348000",
    "end": "353240"
  },
  {
    "text": "network you can interact with so many other machines on the network using Powershell remoting or using WM from",
    "start": "353240",
    "end": "359240"
  },
  {
    "text": "within power power shell you can interact with so there are certificate stores on Windows machines that you can",
    "start": "359240",
    "end": "365600"
  },
  {
    "text": "interact with using Powershell file system what not com object so many things are there U um it is the future",
    "start": "365600",
    "end": "373120"
  },
  {
    "text": "of Windows Administration uh I think in Windows 2016 CTP if you run a nano",
    "start": "373120",
    "end": "380319"
  },
  {
    "text": "server uh that's that's I believe that it is possible only to manage it using",
    "start": "380319",
    "end": "386039"
  },
  {
    "text": "Powershell remoting so that's why another thing that the last one is",
    "start": "386039",
    "end": "391720"
  },
  {
    "text": "actually why I started using Powershell antivirus vendors usually up to couple",
    "start": "391720",
    "end": "397639"
  },
  {
    "text": "of years back no one actually cared about Powershell at least the def on the defender side uh on the on the endpoint",
    "start": "397639",
    "end": "405080"
  },
  {
    "text": "security side no was no one was actually wondering why Powers shell is being used there were scripts me and other guys who",
    "start": "405080",
    "end": "412800"
  },
  {
    "text": "who used to of right Powershell scripts our scripts were not getting detected at",
    "start": "412800",
    "end": "417960"
  },
  {
    "text": "all at least for me there was no detection I was feeling ignored but then it turned out that they didn't care care",
    "start": "417960",
    "end": "424800"
  },
  {
    "text": "for anyone so these are the reasons why me personally and some of the good",
    "start": "424800",
    "end": "431720"
  },
  {
    "text": "attackers I know love to use Powershell how do we use",
    "start": "431720",
    "end": "437319"
  },
  {
    "start": "435000",
    "end": "582000"
  },
  {
    "text": "it first uh way is to execute scripts from this but as soon as you touch discs",
    "start": "437319",
    "end": "444680"
  },
  {
    "text": "in any during any uh good penetration test or attack you risk getting detected",
    "start": "444680",
    "end": "451960"
  },
  {
    "text": "as soon as you touch this it's it's like you're inviting counter measures to come and see you that hey I'm here can you",
    "start": "451960",
    "end": "458240"
  },
  {
    "text": "see me so that's that's the kind of thing you are doing as soon as you touch this then there are ways of executing",
    "start": "458240",
    "end": "464840"
  },
  {
    "text": "Powershell scripts or any kind of attack from memory Powershell provides you some really interesting ways of doing all the",
    "start": "464840",
    "end": "471599"
  },
  {
    "text": "attacks just from memory so one for once there is an encoded command option which",
    "start": "471599",
    "end": "478000"
  },
  {
    "text": "comes with Powershell you can actually use it to load Powershell scripts and",
    "start": "478000",
    "end": "483039"
  },
  {
    "text": "commands in memory in Bas 64 encoded form so you have a good chance of",
    "start": "483039",
    "end": "488080"
  },
  {
    "text": "avoiding detection generally at least by traditional antiviruses and endpoint security measures then there is a",
    "start": "488080",
    "end": "494639"
  },
  {
    "text": "download string credle which I believe actually uh triggered the you the",
    "start": "494639",
    "end": "500000"
  },
  {
    "text": "introduction of amsi so there's something like which I think I show you as well if everything is fine I had a",
    "start": "500000",
    "end": "506680"
  },
  {
    "text": "problem with this machine connecting to the projector so U then there is a",
    "start": "506680",
    "end": "512200"
  },
  {
    "text": "there's a thing called download string credles where you can actually pull a",
    "start": "512200",
    "end": "517479"
  },
  {
    "text": "script from somewhere from the Internet or a web server loaded it completely in memory as a string and execute it so",
    "start": "517479",
    "end": "523959"
  },
  {
    "text": "that's that's the most abused part of Powershell and net interaction and I",
    "start": "523959",
    "end": "529760"
  },
  {
    "text": "frankly believe that's one of the triggers why MSI was introduced just because this thing was going out of hand",
    "start": "529760",
    "end": "536080"
  },
  {
    "text": "and then there is reflection which many of you may know uh but I'm not going to discuss it I'm not well versed with it",
    "start": "536080",
    "end": "542000"
  },
  {
    "text": "actually and that's that's what we are not going to cover in the in the talk as",
    "start": "542000",
    "end": "547120"
  },
  {
    "text": "well so uh with all this thing one thing is clear that detection is easier for",
    "start": "547120",
    "end": "552839"
  },
  {
    "text": "disk obviously when you touch dis if you save your scripts on the targets disk",
    "start": "552839",
    "end": "557920"
  },
  {
    "text": "there are so many ways they can be detected you know there may be I don't know of anyone but there may be any some",
    "start": "557920",
    "end": "563560"
  },
  {
    "text": "antiviruses which run your scripts in a sandbox power shell scripts I'm unaware of any if if any of if is doing it but",
    "start": "563560",
    "end": "570720"
  },
  {
    "text": "since uh there are so many ways it can be done that's easy that's just something we are not going to discuss",
    "start": "570720",
    "end": "577760"
  },
  {
    "text": "how do we stop execution of scripts from memory that's that's the question and that's uh where MSI steps in so",
    "start": "577760",
    "end": "585519"
  },
  {
    "start": "582000",
    "end": "715000"
  },
  {
    "text": "according to to Microsoft so this has been pulled out from different blog posts about MSI from Microsoft they are",
    "start": "585519",
    "end": "592839"
  },
  {
    "text": "the references are there in the slide notes uh so U as per Microsoft amsi",
    "start": "592839",
    "end": "598519"
  },
  {
    "text": "provides five memory and stream scanning content Source URL IP reputation checks and",
    "start": "598519",
    "end": "604839"
  },
  {
    "text": "other techniques so because it is not really well documented up to now the developer documentation is there but the",
    "start": "604839",
    "end": "612120"
  },
  {
    "text": "user documentation is at least as far as I know is not extensive up to now so I don't know what these other techniques",
    "start": "612120",
    "end": "618920"
  },
  {
    "text": "are but still uh at least I have messed up with this stream and memory scanning",
    "start": "618920",
    "end": "625680"
  },
  {
    "text": "I've seen this thing that's that's the thing we are after U so so also according to the blog posts by Microsoft",
    "start": "625680",
    "end": "633320"
  },
  {
    "text": "guys it can be integrated into any application and any application can call",
    "start": "633320",
    "end": "639279"
  },
  {
    "text": "the amsi call the amsi can call the amsi functions and they they in turn can call",
    "start": "639279",
    "end": "646279"
  },
  {
    "text": "whatever the endpoint prodection mechanism in being used so that's that's the idea how it works uh uh it is also",
    "start": "646279",
    "end": "652560"
  },
  {
    "text": "claimed that it includes additional calls for scripts that use off officiation or layer Dynam code",
    "start": "652560",
    "end": "659880"
  },
  {
    "text": "evaluation that means that if you use any kind of officiation it should be less helpful",
    "start": "659880",
    "end": "667399"
  },
  {
    "text": "which in my experiments turned out to be interesting actually as of now when I was writing this slide on 21st of July",
    "start": "667399",
    "end": "674560"
  },
  {
    "text": "only Windows Defender and AVG some version Post 10 only those three two",
    "start": "674560",
    "end": "680360"
  },
  {
    "text": "things were using the amsi so there's one interesting thing there are certain",
    "start": "680360",
    "end": "685920"
  },
  {
    "text": "antiviruses or endpoint security measures which use stream scanning already uh amsi is sort of a game",
    "start": "685920",
    "end": "692639"
  },
  {
    "text": "changer because it comes turned on by default on Windows 10 so as soon as something is by default on Windows it's",
    "start": "692639",
    "end": "700079"
  },
  {
    "text": "something which is widespread so if we can if we cannot bypass amsi then I may",
    "start": "700079",
    "end": "705959"
  },
  {
    "text": "be uh you know looking for some other job being a Powershell guy if I'm getting caught in the very first step",
    "start": "705959",
    "end": "712160"
  },
  {
    "text": "step of my penetration test that's a disaster for me so this is how msi's architecture",
    "start": "712160",
    "end": "719079"
  },
  {
    "text": "looks look like uh the only thing I want you to look at right now is this one where so it's Source from Powers shells",
    "start": "719079",
    "end": "726720"
  },
  {
    "text": "the source is there uh Source from Microsoft my bad so from Powershell if",
    "start": "726720",
    "end": "732360"
  },
  {
    "text": "you try to execute a script or a command which amsi think so this is the",
    "start": "732360",
    "end": "738199"
  },
  {
    "text": "scripting engine of Powershell there are calls to the amsi and then whatever the endpoint security",
    "start": "738199",
    "end": "746560"
  },
  {
    "text": "mechanism is there that can have a look at the unced script which was submitted",
    "start": "746560",
    "end": "752279"
  },
  {
    "text": "by the Powershell scripting host here which in English is whatever the input",
    "start": "752279",
    "end": "759160"
  },
  {
    "text": "method is whether it is interactive or you load it from disk or from memory or",
    "start": "759160",
    "end": "766240"
  },
  {
    "text": "whatever way when the script goes to the scripting host unencrypted unisc plain",
    "start": "766240",
    "end": "773160"
  },
  {
    "text": "clear code then it is submitted to the antivirus or endpoint security mechanism",
    "start": "773160",
    "end": "778279"
  },
  {
    "text": "in use which as per Microsoft as per the blog post from",
    "start": "778279",
    "end": "784360"
  },
  {
    "text": "Microsoft I've not talked with Microsoft directly uh which as per the claims made",
    "start": "784360",
    "end": "789600"
  },
  {
    "text": "already should be measured on signatures as well as Behavior if it is encoded if",
    "start": "789600",
    "end": "797160"
  },
  {
    "text": "there are any interesting things which it is trying to do so that's that's what it has",
    "start": "797160",
    "end": "802600"
  },
  {
    "text": "done uh also because of this thing if you use system. automation. dll that is",
    "start": "802600",
    "end": "809519"
  },
  {
    "text": "uh you do not use powershell.exe actually to execute Powershell scripts and commands so that sounds a bit weird",
    "start": "809519",
    "end": "816399"
  },
  {
    "text": "but that's uh that's used by so many tools and that's perfectly all right you",
    "start": "816399",
    "end": "822199"
  },
  {
    "text": "can actually execute Powershell scripts and commands without having to use powershell.exe even if you do that uh",
    "start": "822199",
    "end": "830399"
  },
  {
    "text": "amsi steps in and catches a scripts uh and because of the claim I have found",
    "start": "830399",
    "end": "836600"
  },
  {
    "text": "this less help from offer a bit weird I mean uh basic ofation was it was not",
    "start": "836600",
    "end": "843079"
  },
  {
    "text": "possible to bypass things using basic ofation uh and if we go back to this",
    "start": "843079",
    "end": "848680"
  },
  {
    "text": "slide uh it claims that uh it includes additional calls for scripts that use of",
    "start": "848680",
    "end": "856320"
  },
  {
    "text": "fation uh which made me write this but when after writing this slide I tested",
    "start": "856320",
    "end": "862759"
  },
  {
    "text": "things in detail some of the results were a bit more interesting than I expected so uh",
    "start": "862759",
    "end": "869839"
  },
  {
    "start": "868000",
    "end": "1124000"
  },
  {
    "text": "let's have a look at the amsi detection in what we are going to have a look at in this demonstration is I'll turn off",
    "start": "869839",
    "end": "876360"
  },
  {
    "text": "amsi onto the VM on my box and then I'll",
    "start": "876360",
    "end": "881440"
  },
  {
    "text": "try to pull in workk mimik cats from a local web server it should get detected it should not get detected then I'll",
    "start": "881440",
    "end": "887759"
  },
  {
    "text": "turn out turn on amsi and then I'll try to pull that script and it should get detected so that's the idea about of",
    "start": "887759",
    "end": "894240"
  },
  {
    "text": "this demonstration so",
    "start": "894240",
    "end": "901040"
  },
  {
    "text": "okay so what I'm going to do now is using this command let which we are going to discuss later on as well so I'm",
    "start": "902199",
    "end": "908519"
  },
  {
    "text": "not going to increase the Fone size that's for me not for you so uh I'm going to disable",
    "start": "908519",
    "end": "917680"
  },
  {
    "text": "amsi or temporarily disable it that's that's the",
    "start": "917680",
    "end": "923399"
  },
  {
    "text": "point okay",
    "start": "924120",
    "end": "930959"
  },
  {
    "text": "if the machine cooperates with me come on demog gods",
    "start": "934279",
    "end": "941639"
  },
  {
    "text": "okay so uh what this command does it disables",
    "start": "941639",
    "end": "947560"
  },
  {
    "text": "ioav protection that's whatever you whatever the memory scanning is being done by uh Windows Defender that's",
    "start": "947560",
    "end": "954240"
  },
  {
    "text": "that's we have disabled that uh I need a minute here uh let me just",
    "start": "954240",
    "end": "959519"
  },
  {
    "text": "run yeah so now if I that's a local web server please do not for it that that's",
    "start": "959519",
    "end": "965759"
  },
  {
    "text": "really poor one so if I now try to",
    "start": "965759",
    "end": "971199"
  },
  {
    "text": "access this script from memory",
    "start": "971199",
    "end": "979920"
  },
  {
    "text": "up uh let me copy",
    "start": "981000",
    "end": "984759"
  },
  {
    "text": "this so we won't see anything interesting just that invoke M gets",
    "start": "987920",
    "end": "994759"
  },
  {
    "text": "executed gets executed no problem the thing which we are interested in right now here is this was there a threat",
    "start": "994759",
    "end": "1002680"
  },
  {
    "text": "detection let's have a look at that so let's have a look at the latest",
    "start": "1002680",
    "end": "1010399"
  },
  {
    "text": "threat so now so the time on this machine is 9:56 I don't know on what time zone this machine is but the last",
    "start": "1012560",
    "end": "1018959"
  },
  {
    "text": "detection was uh on some other date altogether that means there was no",
    "start": "1018959",
    "end": "1025399"
  },
  {
    "text": "detection and if I turn the disable back that's I turn it on",
    "start": "1027839",
    "end": "1035199"
  },
  {
    "text": "back and try the same command from a new service or new",
    "start": "1036799",
    "end": "1045120"
  },
  {
    "text": "session",
    "start": "1047840",
    "end": "1050840"
  },
  {
    "text": "okay so now if I try to run the same command from a new bell",
    "start": "1056400",
    "end": "1063640"
  },
  {
    "text": "session you can see that so this is for you so I can increase the phone size",
    "start": "1064760",
    "end": "1071480"
  },
  {
    "text": "now so here you can see that uh we got a message that this script contains",
    "start": "1073960",
    "end": "1079960"
  },
  {
    "text": "malicious content and has been blocked by your antivirus software which is quite good and if we go here and see the",
    "start": "1079960",
    "end": "1086880"
  },
  {
    "text": "detection I think it I believe it's updated already uh you can see that we have a",
    "start": "1086880",
    "end": "1093600"
  },
  {
    "text": "detection on this state at this time and have a please have a look at",
    "start": "1093600",
    "end": "1099880"
  },
  {
    "text": "this resources module it's amsi which caught us so this was actually the first time where I saw amsi okay don't want to",
    "start": "1099880",
    "end": "1108799"
  },
  {
    "text": "s anything uh this was first time I saw amsi in action",
    "start": "1108799",
    "end": "1114400"
  },
  {
    "text": "actually so this means that as soon as we turn on amsi back again there was a",
    "start": "1114400",
    "end": "1121799"
  },
  {
    "text": "detection U so let's just stick at this one demonstration here so now what if so this was a really",
    "start": "1121799",
    "end": "1130240"
  },
  {
    "start": "1124000",
    "end": "1189000"
  },
  {
    "text": "liame uh execution just from an interactive console we tried to execute",
    "start": "1130240",
    "end": "1135360"
  },
  {
    "text": "script and that was caught what if power scripts are loaded from unusual places",
    "start": "1135360",
    "end": "1141200"
  },
  {
    "text": "like wmi namespaces you can actually save scripts in wmi namespaces or from registry keys or what if you are loading",
    "start": "1141200",
    "end": "1149559"
  },
  {
    "text": "scripts from event logs you know using some existing logs which you know get",
    "start": "1149559",
    "end": "1154799"
  },
  {
    "text": "created you store a script in chunks in event logs load that load it back from",
    "start": "1154799",
    "end": "1159880"
  },
  {
    "text": "event logs and try to execute it uh traditional antiviruses during my tests",
    "start": "1159880",
    "end": "1166280"
  },
  {
    "text": "were unable were it was not possible for them to detect these things for obvious reasons but amsi still caught it caught",
    "start": "1166280",
    "end": "1174679"
  },
  {
    "text": "these things because no matter what the script came from was what what was the place or the method of input because it",
    "start": "1174679",
    "end": "1181520"
  },
  {
    "text": "was submitted in clear text to the scripting host at that time uh amsi",
    "start": "1181520",
    "end": "1186760"
  },
  {
    "text": "stabbed in and detected these things uh now that was unusual storage",
    "start": "1186760",
    "end": "1192919"
  },
  {
    "start": "1189000",
    "end": "1259000"
  },
  {
    "text": "what if we talk about unusual execution unusual execution means U",
    "start": "1192919",
    "end": "1199280"
  },
  {
    "text": "uh without using powershell.exe there are tools like NPS pwn shell Etc which",
    "start": "1199280",
    "end": "1204760"
  },
  {
    "text": "use system. automation. dll or other methods to execute Powershell scripts",
    "start": "1204760",
    "end": "1211880"
  },
  {
    "text": "without using powershell.exe will they be CAU yes they were caught as well then reflection even in case of",
    "start": "1211880",
    "end": "1218559"
  },
  {
    "text": "reflection U where I use existing tools because I suck at the context of U",
    "start": "1218559",
    "end": "1224840"
  },
  {
    "text": "basics of Reflections I used ready to use tools for that in that case as well",
    "start": "1224840",
    "end": "1229880"
  },
  {
    "text": "uh detection was there and then there are application wh listing bypasses I recently was worked on these things um",
    "start": "1229880",
    "end": "1237840"
  },
  {
    "text": "KY Smith worked on these things I just copied these things so um I tried on",
    "start": "1237840",
    "end": "1244240"
  },
  {
    "text": "that on these things as well once again detection was there just because as soon as there",
    "start": "1244240",
    "end": "1250240"
  },
  {
    "text": "was something sent to the scripting host that amsi stepped in detected it and uh",
    "start": "1250240",
    "end": "1258280"
  },
  {
    "text": "I was was not a happy panda it was a Sad Panda so let's have a look at one of these things If U let's skip that I",
    "start": "1258280",
    "end": "1265679"
  },
  {
    "start": "1259000",
    "end": "1289000"
  },
  {
    "text": "think I'll over if if I don't overshoot I'll come back to this so what was I",
    "start": "1265679",
    "end": "1271520"
  },
  {
    "text": "plan to do here was I'll create a SCT file which pulls once again invoke MIM",
    "start": "1271520",
    "end": "1278120"
  },
  {
    "text": "cats and then I will use reg svr 32 to execute that s u just to try if AMS I could be",
    "start": "1278120",
    "end": "1285840"
  },
  {
    "text": "bypassed you can guess that it was not possible to do that so as a red",
    "start": "1285840",
    "end": "1292559"
  },
  {
    "text": "teamer uh I was not really happy I started looking for different",
    "start": "1292559",
    "end": "1297760"
  },
  {
    "text": "ways to bypass amsi and uh interestingly it's it's not me who came up with the",
    "start": "1297760",
    "end": "1302880"
  },
  {
    "text": "smarter ways of bypassing thing it's the other guys I'm just going to uh talk about it so still if you use Powershell",
    "start": "1302880",
    "end": "1309919"
  },
  {
    "text": "version to if you have a look at the version of Powershell which comes up in Windows 10 that's I think on my box it's",
    "start": "1309919",
    "end": "1317520"
  },
  {
    "text": "V5 on a Windows version 5 box if you are",
    "start": "1317520",
    "end": "1323159"
  },
  {
    "text": "uh if you have the capability of running Powershell version two uh amsi has no way of stepping in if",
    "start": "1323159",
    "end": "1331240"
  },
  {
    "text": "you're using Powershell version 2 and that's a known thing the only uh drawback of this thing is that not that",
    "start": "1331240",
    "end": "1338320"
  },
  {
    "text": "needs net 3.0 which does not come enabled or",
    "start": "1338320",
    "end": "1343440"
  },
  {
    "text": "installed by default on Windows 10 boxes um I have seen couple of windows boxes",
    "start": "1343440",
    "end": "1349799"
  },
  {
    "text": "in Enterprise environments during my penetration tests many times there is net 3.0 installed for what's the one",
    "start": "1349799",
    "end": "1357600"
  },
  {
    "text": "word which makes Microsoft's products suck security",
    "start": "1357600",
    "end": "1363799"
  },
  {
    "text": "wise exactly so it's backward compatibility because of some",
    "start": "1363799",
    "end": "1369159"
  },
  {
    "text": "application which could not work so I I love Microsoft's uh has how Microsoft",
    "start": "1369159",
    "end": "1375080"
  },
  {
    "text": "responds to things I'm going to talk about it as well when how Microsoft's guys and",
    "start": "1375080",
    "end": "1381440"
  },
  {
    "text": "Engineers response once you trying to break their things it's awesome it's been a great change for me as at least",
    "start": "1381440",
    "end": "1388960"
  },
  {
    "text": "so because of backward compatibility I have seen net 3.0 installed on so many",
    "start": "1388960",
    "end": "1394000"
  },
  {
    "text": "of Windows stand machines but still because it is not there by default we can assume uh it's not fair to say that",
    "start": "1394000",
    "end": "1401679"
  },
  {
    "text": "we can bypass or we can use Powershell version to that's that's okay another way is to significantly change signature",
    "start": "1401679",
    "end": "1409440"
  },
  {
    "text": "of your scripts if you have the capability of writing the same functionality with different signature",
    "start": "1409440",
    "end": "1415760"
  },
  {
    "text": "every time that would be awesome but uh that's generally not possible so and the",
    "start": "1415760",
    "end": "1421039"
  },
  {
    "text": "third way is to just disable it all together go really brute on it unload it kill it disable it that's that's the",
    "start": "1421039",
    "end": "1427039"
  },
  {
    "text": "third way so these are the three ways we are going to discuss first way signature bypass so",
    "start": "1427039",
    "end": "1434960"
  },
  {
    "start": "1431000",
    "end": "1576000"
  },
  {
    "text": "when I started working on amsi I thought very high of it because all of my",
    "start": "1434960",
    "end": "1440880"
  },
  {
    "text": "payloads were getting detected but when I started testing it turned out that this thing is still created by Mortals",
    "start": "1440880",
    "end": "1448360"
  },
  {
    "text": "uh it is still possible to bypass things on on amsi uh this was actually really",
    "start": "1448360",
    "end": "1455760"
  },
  {
    "text": "interesting I was uh discussing this with my colleague Anand couple of days back and shout out to him if Anand is",
    "start": "1455760",
    "end": "1462720"
  },
  {
    "text": "here it's it's his idea to do this off officiation thing manually",
    "start": "1462720",
    "end": "1469080"
  },
  {
    "text": "and uh it was possible for us to spot that what exact signatures amsi uses at",
    "start": "1469080",
    "end": "1476600"
  },
  {
    "text": "least in case of one of the scripts and how we can just simply change the functionality or remove the",
    "start": "1476600",
    "end": "1482080"
  },
  {
    "text": "functionality and still see what amsi is looking for so this is how manual",
    "start": "1482080",
    "end": "1487799"
  },
  {
    "text": "officiation goes remove the help section uh office skate function and",
    "start": "1487799",
    "end": "1493360"
  },
  {
    "text": "variable names maybe just replace them by some weird characters or just by numbers",
    "start": "1493360",
    "end": "1499039"
  },
  {
    "text": "then encode parts of script I that was actually surprising for me because it was claimed that amsi",
    "start": "1499039",
    "end": "1506679"
  },
  {
    "text": "actually have additional calls maybe that I understood that uh in",
    "start": "1506679",
    "end": "1512559"
  },
  {
    "text": "a different way but it was claim that if there are additional there are additional calls if there are",
    "start": "1512559",
    "end": "1519039"
  },
  {
    "text": "officiation or encoding techniques being used but that's that's the third thing",
    "start": "1519039",
    "end": "1524720"
  },
  {
    "text": "and then profit script will not get detected so there is one way of doing",
    "start": "1524720",
    "end": "1532080"
  },
  {
    "text": "that's just use manual officiation do it manually but it is really not possible for huge scripts uh what I found out",
    "start": "1532080",
    "end": "1539600"
  },
  {
    "text": "ready to use was there is an isse isse is the editor which comes built in for",
    "start": "1539600",
    "end": "1546039"
  },
  {
    "text": "Powershell scripts so there is an add-on for ISC called ISC steroids there is an",
    "start": "1546039",
    "end": "1551320"
  },
  {
    "text": "offer skate functionality built into that just use that and you're good to go at least before the anniversary edition",
    "start": "1551320",
    "end": "1557720"
  },
  {
    "text": "I've not tested is these things on the anniversary edition so please do not stand up after the talk and say that",
    "start": "1557720",
    "end": "1563080"
  },
  {
    "text": "these things don't work on the anniversary edition not tested freezed everything every testing was frozen I",
    "start": "1563080",
    "end": "1569200"
  },
  {
    "text": "think on 15th or 16th of July and even I don't think the university Edition was there at the time okay so this is a",
    "start": "1569200",
    "end": "1578279"
  },
  {
    "text": "screenshot of how off looks like I think this was not the manual one but from the",
    "start": "1578279",
    "end": "1583880"
  },
  {
    "text": "I steroids and this is for one of the scripts from my from the tool which which I have written nishang so this was",
    "start": "1583880",
    "end": "1591480"
  },
  {
    "text": "not caught by amsi uh I would like to demonstrate this",
    "start": "1591480",
    "end": "1597440"
  },
  {
    "text": "first so still okay so what I'm going to do now",
    "start": "1597440",
    "end": "1603960"
  },
  {
    "text": "I'm going to disable Windows Defender so that I can pull invoke mimik ads. PS1",
    "start": "1603960",
    "end": "1610240"
  },
  {
    "text": "onto the disk I will officiate the script and then reenable Windows Defender and we'll see that the original",
    "start": "1610240",
    "end": "1617120"
  },
  {
    "text": "one the unated one gets detected but hopefully the unated one doesn't get",
    "start": "1617120",
    "end": "1622760"
  },
  {
    "text": "detected so let me quickly do that so what I'm looking for is Powershell",
    "start": "1622760",
    "end": "1630440"
  },
  {
    "text": "isse and meanwhile it loads let me disable realtime production at",
    "start": "1633360",
    "end": "1641240"
  },
  {
    "text": "all so real I'm dising real time monitor",
    "start": "1643520",
    "end": "1650159"
  },
  {
    "text": "okay it's gone now let me quickly pull in work mimik so you can see that there is a notification to the",
    "start": "1652159",
    "end": "1659799"
  },
  {
    "text": "user okay so I'm now downloading invoke mcats",
    "start": "1664000",
    "end": "1670799"
  },
  {
    "text": "and it's there on the desk here it is okay so there's an kit",
    "start": "1670799",
    "end": "1678480"
  },
  {
    "text": "in one already let me remove",
    "start": "1678480",
    "end": "1681640"
  },
  {
    "text": "that uh now I'm loading the ISC",
    "start": "1683679",
    "end": "1688679"
  },
  {
    "text": "steroids so that's the automated one U after this I think we have time I'll",
    "start": "1689440",
    "end": "1696200"
  },
  {
    "text": "show you the uh the UN automated one as well how we spotted that it can been",
    "start": "1696200",
    "end": "1701880"
  },
  {
    "text": "done manually as well at least for smaller scripts so tools offer skate just use",
    "start": "1701880",
    "end": "1709600"
  },
  {
    "text": "the default options just try to save offer skate to script so it feels quite script is that you're just using the a",
    "start": "1709600",
    "end": "1716720"
  },
  {
    "text": "tool if you want I can explain it to you later on so this is the off skated",
    "start": "1716720",
    "end": "1722519"
  },
  {
    "text": "one let's close",
    "start": "1722519",
    "end": "1726159"
  },
  {
    "text": "this and let's turn this thing back",
    "start": "1728960",
    "end": "1735720"
  },
  {
    "text": "on and now let's wait if anything gets",
    "start": "1737039",
    "end": "1742760"
  },
  {
    "text": "detected or maybe let's just try to load this these things and see if Windows",
    "start": "1742760",
    "end": "1748240"
  },
  {
    "text": "Defender has a problem with any of any of these so",
    "start": "1748240",
    "end": "1754480"
  },
  {
    "text": "downloads let me try to load invoke mimik cats first okay it found it not letting me",
    "start": "1754480",
    "end": "1761799"
  },
  {
    "text": "load it okay",
    "start": "1761799",
    "end": "1770039"
  },
  {
    "text": "so I try to load invoke mimik",
    "start": "1772960",
    "end": "1779840"
  },
  {
    "text": "cads PS1 so this is not from amsi this is",
    "start": "1781360",
    "end": "1787320"
  },
  {
    "text": "from Windows Defender you can tell it from the error message but if I try to load the offed",
    "start": "1787320",
    "end": "1794000"
  },
  {
    "text": "one it will get executed so that was actually",
    "start": "1794000",
    "end": "1799039"
  },
  {
    "text": "really interesting so because we are not running with administrative privileges we are not able to see",
    "start": "1799039",
    "end": "1805640"
  },
  {
    "text": "anything here no I don't want to send anything because it was not we are not",
    "start": "1805640",
    "end": "1812000"
  },
  {
    "text": "running with administrative privileges we were not able to see anything but you can see that mimicat was at least",
    "start": "1812000",
    "end": "1817440"
  },
  {
    "text": "executed here uh which is very interesting because once again the claim was that if you employ aisc there would",
    "start": "1817440",
    "end": "1825120"
  },
  {
    "text": "be more calls uh it could be me but the the kind of why I got it from it was",
    "start": "1825120",
    "end": "1831200"
  },
  {
    "text": "that if you use officiation like this these the thing which we have used here you use base 64 encoding for various",
    "start": "1831200",
    "end": "1838519"
  },
  {
    "text": "functions there should be something special there uh turned out it was not",
    "start": "1838519",
    "end": "1843720"
  },
  {
    "text": "uh and for the manual one let me see if I can quickly show you that as",
    "start": "1843720",
    "end": "1850519"
  },
  {
    "text": "well so there is this script in in the tool which I wrote nishang this is",
    "start": "1850519",
    "end": "1855679"
  },
  {
    "text": "called G back door that means a secret back door so U let me quickly pull that onto that",
    "start": "1855679",
    "end": "1864559"
  },
  {
    "text": "machine and if I try to pull it using the command I hope it's still",
    "start": "1865120",
    "end": "1873559"
  },
  {
    "text": "there so it gets detected as a malicious script but",
    "start": "1879279",
    "end": "1885039"
  },
  {
    "text": "interestingly so I'm assuming that in this case case it could be because I I'm going to remove all the functionality",
    "start": "1885039",
    "end": "1891000"
  },
  {
    "text": "just to zero in on a signature so if I just remove all the help from",
    "start": "1891000",
    "end": "1897960"
  },
  {
    "text": "here and all the functionality as well so what we have right now is just",
    "start": "1897960",
    "end": "1905159"
  },
  {
    "text": "the function name and two variable names so now so this is really",
    "start": "1905159",
    "end": "1911720"
  },
  {
    "text": "inefficient but uh I like to do it this way now I'm going to remove the file from this place and copy it back",
    "start": "1911720",
    "end": "1919880"
  },
  {
    "text": "there so now if I run this it still gets detected",
    "start": "1919880",
    "end": "1927399"
  },
  {
    "text": "but let me replace this with 1 2 3 4 5 6 7 8 9",
    "start": "1927399",
    "end": "1933240"
  },
  {
    "text": "0 11122 33 7788 99 that's it let's let's Now",
    "start": "1933240",
    "end": "1941240"
  },
  {
    "text": "quickly test this once",
    "start": "1941240",
    "end": "1944360"
  },
  {
    "text": "again now if we run this it doesn't get",
    "start": "1946840",
    "end": "1953120"
  },
  {
    "text": "detected that that's how you spot onto the screen that's really basic of fustion basics of I'm mean I'm I'm not",
    "start": "1953120",
    "end": "1959240"
  },
  {
    "text": "really good at these things this is the first time I'm doing these things just to bypass emsi that means uh that most",
    "start": "1959240",
    "end": "1966720"
  },
  {
    "text": "probably if even if you imply off forcation or encoding amsi up to now it",
    "start": "1966720",
    "end": "1973440"
  },
  {
    "text": "doesn't care or uh when AMS submits it to Windows",
    "start": "1973440",
    "end": "1979240"
  },
  {
    "text": "Defender maybe it's Windows Defender who do does not have signature for these things that's the thing actually I was",
    "start": "1979240",
    "end": "1985159"
  },
  {
    "text": "unable to zero in on I tried a lot but couldn't make out why this thing uh was",
    "start": "1985159",
    "end": "1990679"
  },
  {
    "text": "happening so maybe if any of anyone of you knows better than me on this obviously there are guys just catch me",
    "start": "1990679",
    "end": "1996919"
  },
  {
    "text": "after the class and please educate me on this so uh in any case using this these",
    "start": "1996919",
    "end": "2003000"
  },
  {
    "start": "2000000",
    "end": "2391000"
  },
  {
    "text": "simple ready to use officiation or uh just simplification",
    "start": "2003000",
    "end": "2008440"
  },
  {
    "text": "we it was possible to bypass or avoid amsi now there are three more ways one",
    "start": "2008440",
    "end": "2014679"
  },
  {
    "text": "which we have seen already set MP preference uh that is using the that's",
    "start": "2014679",
    "end": "2020960"
  },
  {
    "text": "specific for Windows Defender that is the built-in command LS which are there",
    "start": "2020960",
    "end": "2027159"
  },
  {
    "text": "for managing of Windows Defender you just use them and you're good then",
    "start": "2027159",
    "end": "2033080"
  },
  {
    "text": "unload it from current process that's from uh Matt I can't pronounce it second that's why I call him Matt Matthew this",
    "start": "2033080",
    "end": "2039880"
  },
  {
    "text": "the guy who wrote Papa plit awesome guy so that's that's from him I can't even ask if he's in the class um he's in the",
    "start": "2039880",
    "end": "2046960"
  },
  {
    "text": "sorry he in the talk and then uh this is by another friend",
    "start": "2046960",
    "end": "2053040"
  },
  {
    "text": "uh whose name also I can't pronounce properly so that we are going to have a look at as well first of all if we use",
    "start": "2053040",
    "end": "2060079"
  },
  {
    "text": "set MP preference so that's the built-in Powershell command light for playing",
    "start": "2060079",
    "end": "2066720"
  },
  {
    "text": "with Windows Defender and that's the thing which we used just now that is disabled realtime monitoring",
    "start": "2066720",
    "end": "2074240"
  },
  {
    "text": "if it is said to true then what happens obviously real time monitoring gets turned off",
    "start": "2074240",
    "end": "2080960"
  },
  {
    "text": "Tada but it shows a notification to the user and that we saw already that",
    "start": "2080960",
    "end": "2086560"
  },
  {
    "text": "there's a notification to the user that please turn on your antivirus security things with these it needs",
    "start": "2086560",
    "end": "2093079"
  },
  {
    "text": "elevated privileges which is actually not a thing we are discussing almost a post exploitation scenario",
    "start": "2093079",
    "end": "2098320"
  },
  {
    "text": "and getting administrator access in Windows environment is not really something which needs a lot of hard work",
    "start": "2098320",
    "end": "2106800"
  },
  {
    "text": "U but there's a thing with the Powershell version 5 or I should say WF",
    "start": "2106800",
    "end": "2113160"
  },
  {
    "text": "version 5 that it loves to log a lot of things not in this one here because we",
    "start": "2113160",
    "end": "2120320"
  },
  {
    "text": "are disabling a feature or a protection of Windows Defender there will be a log",
    "start": "2120320",
    "end": "2126359"
  },
  {
    "text": "in Microsoft Windows Windows Defender operational event ID 51",
    "start": "2126359",
    "end": "2131680"
  },
  {
    "text": "and it clearly says Windows Defender realtime production was disabled which is not a good thing I mean it's it's",
    "start": "2131680",
    "end": "2137960"
  },
  {
    "text": "almost equivalent to writing things on dis and trying it out now there is another way that's the",
    "start": "2137960",
    "end": "2144200"
  },
  {
    "text": "one that's the thing which we used in the very first uh example that's to disable ioav protection setting it to",
    "start": "2144200",
    "end": "2152400"
  },
  {
    "text": "true that allows us to do interesting stuff as well that we saw already",
    "start": "2152400",
    "end": "2158800"
  },
  {
    "text": "uh this doesn't show any notification to the user a bit more stealy once again needs elevated privileges that's fine uh",
    "start": "2158800",
    "end": "2167720"
  },
  {
    "text": "once again there is an event ID in the Windows Defender locks which which which we do not want so the log says Defender",
    "start": "2167720",
    "end": "2174720"
  },
  {
    "text": "realtime production feature configuration has changed so in almost all organization both of these events",
    "start": "2174720",
    "end": "2180000"
  },
  {
    "text": "will trigger an alert now comes a really interesting method this one is which Matt",
    "start": "2180000",
    "end": "2188319"
  },
  {
    "text": "okay I forgot to add the screenshot it's there uh this one is by Matt and this actually unloads amsi from the current",
    "start": "2188319",
    "end": "2196599"
  },
  {
    "text": "process without administrative privileges so this is something which I found really interesting once again uh",
    "start": "2196599",
    "end": "2204240"
  },
  {
    "text": "no notification to the user and no logs by Windows Defender or anything but here",
    "start": "2204240",
    "end": "2210880"
  },
  {
    "text": "here's where here's when the automatic logging uh feature in WF 5 Steps in",
    "start": "2210880",
    "end": "2216839"
  },
  {
    "text": "because this thing is interesting it gets logged by default and that's that's",
    "start": "2216839",
    "end": "2223040"
  },
  {
    "text": "something uh which which is a bit of a headache if your organization or any of",
    "start": "2223040",
    "end": "2228119"
  },
  {
    "text": "your clients organization or whatever you are responsible for have logs logs",
    "start": "2228119",
    "end": "2233319"
  },
  {
    "text": "these things and then analyze these things then you may still catch someone",
    "start": "2233319",
    "end": "2239240"
  },
  {
    "text": "who's using this method the interesting thing with this method is once again you do not even need administrative",
    "start": "2239240",
    "end": "2244920"
  },
  {
    "text": "privileges that's for one that makes it I ideal to be used with client side attacks that is you may not have I wish",
    "start": "2244920",
    "end": "2254040"
  },
  {
    "text": "as an attacker that it was possible to have people running their Ms word or",
    "start": "2254040",
    "end": "2260800"
  },
  {
    "text": "Excel or other Office Products or their browsers with administrative privileges but that's not the case that's a sad reality so this thing allows us to",
    "start": "2260800",
    "end": "2269040"
  },
  {
    "text": "execute different interesting attacks from client side thatx as well no administrative access",
    "start": "2269040",
    "end": "2274520"
  },
  {
    "text": "required but automatic logging steps in so what should The Next Step shall we bypass the automatic logging I'm not",
    "start": "2274520",
    "end": "2281640"
  },
  {
    "text": "going to discuss that in the class sorry for raising your hopes peing your interest we are not going to discuss",
    "start": "2281640",
    "end": "2286720"
  },
  {
    "text": "that in the class in the talk sorry I just did a four days of class so I keep saying class and class again and again",
    "start": "2286720",
    "end": "2293200"
  },
  {
    "text": "I'm so sorry about that so uh another method of unloading amsi is uh was",
    "start": "2293200",
    "end": "2300400"
  },
  {
    "text": "discovered by a friend Coralis depl and it is implementing in his tool pound",
    "start": "2300400",
    "end": "2306119"
  },
  {
    "text": "shell so I have that on on the that machine but I'm not going to demonstrate it I want to save some time for",
    "start": "2306119",
    "end": "2312640"
  },
  {
    "text": "questions and answers I believe there would be some interesting ones uh what this uh technique does it moves",
    "start": "2312640",
    "end": "2319599"
  },
  {
    "text": "powershell.exe to a directory from where the tool is loaded and executes it from",
    "start": "2319599",
    "end": "2325000"
  },
  {
    "text": "there as soon as a powershell.exe is called it looks for a dll called no",
    "start": "2325000",
    "end": "2330560"
  },
  {
    "text": "points for guessing MSI in the current working directory this tool provides a fake fake dll to that which just loads",
    "start": "2330560",
    "end": "2338359"
  },
  {
    "text": "and exits that's it amsi does not uh step in anymore for this",
    "start": "2338359",
    "end": "2345480"
  },
  {
    "text": "tool now here's the thing with this once again this WF 5's automatic script block",
    "start": "2345480",
    "end": "2352960"
  },
  {
    "text": "logging steps in because this what this tool does is it has picked up some",
    "start": "2352960",
    "end": "2358599"
  },
  {
    "text": "really interesting uh scripts from so many open source Powershell tools and",
    "start": "2358599",
    "end": "2364359"
  },
  {
    "text": "load them as soon as uh load them into the memory as soon as amsi is off it is",
    "start": "2364359",
    "end": "2372200"
  },
  {
    "text": "possible for it to load all those scripts as soon as those scripts are logged this log is for those scripts but",
    "start": "2372200",
    "end": "2378839"
  },
  {
    "text": "in any case there is logging for this once again so this is actually something",
    "start": "2378839",
    "end": "2385359"
  },
  {
    "text": "which I expect the audiences to do for me bypass the automatic logging so uh now what I'm going to try",
    "start": "2385359",
    "end": "2392680"
  },
  {
    "start": "2391000",
    "end": "2421000"
  },
  {
    "text": "to do is run a client side attack and see if it is possible to bypass amsi",
    "start": "2392680",
    "end": "2398599"
  },
  {
    "text": "from client side attack so that's that's something which as an attacker I would I would always like to",
    "start": "2398599",
    "end": "2405839"
  },
  {
    "text": "do that is U so there's no need to uh go about",
    "start": "2405839",
    "end": "2413040"
  },
  {
    "text": "more and more about client side attacks it's generally the thing which provides us the foothold machine in any good",
    "start": "2413040",
    "end": "2419800"
  },
  {
    "text": "penetration test so let me quickly do this uh real quick if if my K box is",
    "start": "2419800",
    "end": "2426680"
  },
  {
    "start": "2421000",
    "end": "2679000"
  },
  {
    "text": "still alive okay all my machines are dead okay so I have let me do this",
    "start": "2426680",
    "end": "2433680"
  },
  {
    "text": "really quick I have this",
    "start": "2433680",
    "end": "2441000"
  },
  {
    "text": "okay so I'm going to start a metas listener real quick and try to get a metap session back on that Windows 10",
    "start": "2447079",
    "end": "2454280"
  },
  {
    "text": "machine simultaneously bypassing amsi so that's what I'm trying to do",
    "start": "2454280",
    "end": "2460318"
  },
  {
    "text": "now so meanwhile it loads let me see if I have the setup",
    "start": "2464520",
    "end": "2470400"
  },
  {
    "text": "there",
    "start": "2471520",
    "end": "2474520"
  },
  {
    "text": "okay so uh trust me that I have created this word file using the command pasted",
    "start": "2477200",
    "end": "2484319"
  },
  {
    "text": "in the notepad I'm not going to do it again I need to save time so I hope you guys trust me that this is",
    "start": "2484319",
    "end": "2490800"
  },
  {
    "text": "a proper one created using one of okay I'll do it no need to explain it that",
    "start": "2490800",
    "end": "2496920"
  },
  {
    "text": "much so let me copy this real quick and I'm going to load this uh",
    "start": "2496920",
    "end": "2504560"
  },
  {
    "text": "client side attack utility from nishang okay outward which generates uh",
    "start": "2504560",
    "end": "2513640"
  },
  {
    "text": "weaponized or loaded word file so if you can see here here what I'm doing",
    "start": "2513640",
    "end": "2519440"
  },
  {
    "text": "is using Ma's method of bypassing amsi and then pulling this msf p. PSR from my",
    "start": "2519440",
    "end": "2527520"
  },
  {
    "text": "local web server and executing it so we have a file called called",
    "start": "2527520",
    "end": "2535760"
  },
  {
    "text": "salary details do do",
    "start": "2535760",
    "end": "2540000"
  },
  {
    "text": "here okay the font is tomorrow I'll just okay",
    "start": "2542240",
    "end": "2548119"
  },
  {
    "text": "set payload Windows x64",
    "start": "2548119",
    "end": "2555920"
  },
  {
    "text": "metor reverse",
    "start": "2556000",
    "end": "2559599"
  },
  {
    "text": "TCP and oops and let me set the lhost real quick",
    "start": "2566119",
    "end": "2573480"
  },
  {
    "text": "that is going to be 192 168 230",
    "start": "2573480",
    "end": "2579119"
  },
  {
    "text": "154 okay it should be it so we have a listener here and if I",
    "start": "2581920",
    "end": "2590440"
  },
  {
    "text": "try this try to open this on this target machine so uh let me see if I have msf",
    "start": "2590440",
    "end": "2596960"
  },
  {
    "text": "payload PS1 here so there is this warning which no one",
    "start": "2596960",
    "end": "2602400"
  },
  {
    "text": "reads yeah okay that's good let me enable that content and",
    "start": "2602400",
    "end": "2608960"
  },
  {
    "text": "let's see if we have anything",
    "start": "2608960",
    "end": "2612359"
  },
  {
    "text": "here okay meanwhile the session loads let's see if there was a",
    "start": "2616319",
    "end": "2622359"
  },
  {
    "text": "detection so uh where is a detection one let's see so it's 4:13 a.m. on that",
    "start": "2623960",
    "end": "2630680"
  },
  {
    "text": "machine and the last detection was at 42 a.m. that means it was not detected and",
    "start": "2630680",
    "end": "2636040"
  },
  {
    "text": "hopefully uh so it could be oh it's it's a wrong",
    "start": "2636040",
    "end": "2644599"
  },
  {
    "text": "payload it's wrong payload uh it was supposed to be oops",
    "start": "2644599",
    "end": "2651240"
  },
  {
    "text": "reverse https",
    "start": "2651240",
    "end": "2654400"
  },
  {
    "text": "actually okay let me try this real quick once again okay it's there so that's",
    "start": "2656359",
    "end": "2662160"
  },
  {
    "text": "230.6 so now what we have here is a met on a Windows 10 machine that's the",
    "start": "2662160",
    "end": "2668280"
  },
  {
    "text": "latest bill at the time of writing on a latest Bill we bypassed amsi and that's",
    "start": "2668280",
    "end": "2675079"
  },
  {
    "text": "all I think we could do while bypassing amsi that was it couple of words about W",
    "start": "2675079",
    "end": "2682680"
  },
  {
    "start": "2679000",
    "end": "2794000"
  },
  {
    "text": "F5 Auto logging it's now hard to execute a PO shell attack on any Windows 10",
    "start": "2682680",
    "end": "2689079"
  },
  {
    "text": "machine or any machine which has this running so this is a big compliment it is I don't think it is really possible",
    "start": "2689079",
    "end": "2695240"
  },
  {
    "text": "there are ways to bypass it I know a couple of guys who can still do it uh to not leave a fingerprint and still",
    "start": "2695240",
    "end": "2702920"
  },
  {
    "text": "perform a powerwell attack that's really not possible and apparently all the officiation technique it boils down to",
    "start": "2702920",
    "end": "2708960"
  },
  {
    "text": "bypassing this log and if someone is monitoring logs that's that's going to be an interesting thing u a quick 10",
    "start": "2708960",
    "end": "2716599"
  },
  {
    "text": "seconds thanks to guys from msrc and I don't know if I can take names that's why I'm not not taking names here a",
    "start": "2716599",
    "end": "2722319"
  },
  {
    "text": "couple of guys from Microsoft more than two guys talk to me on Twitter about",
    "start": "2722319",
    "end": "2727520"
  },
  {
    "text": "this a very good response very forthcoming so that's a big change at",
    "start": "2727520",
    "end": "2733200"
  },
  {
    "text": "least for me so we can conclude that amsi is is still a big step forward when",
    "start": "2733200",
    "end": "2738240"
  },
  {
    "text": "it comes to Windows security at least things are going in the right direction but it is still possible to avoid amsi",
    "start": "2738240",
    "end": "2745400"
  },
  {
    "text": "or avoid detection using already known methods and techniques and that's something of a downer here and it is on",
    "start": "2745400",
    "end": "2753119"
  },
  {
    "text": "it's no Silver Bullet it's only useful when someone is monitoring the logs and use or follow the basic of Enterprise",
    "start": "2753119",
    "end": "2760960"
  },
  {
    "text": "security measures and and that's all these are my contact informations and all of the slides or whatever code I",
    "start": "2760960",
    "end": "2767640"
  },
  {
    "text": "have would be available on my GitHub repository that's all thank you very",
    "start": "2767640",
    "end": "2774318"
  },
  {
    "text": "much questions no insults",
    "start": "2777920",
    "end": "2783599"
  },
  {
    "text": "please well so if you have no question that means either the session was really good or really bad so I I would like to",
    "start": "2784359",
    "end": "2790680"
  },
  {
    "text": "assume that it was really good thank you very much",
    "start": "2790680",
    "end": "2796440"
  }
]