[
  {
    "text": "okay so uh thank you for coming before anything uh before we get started uh",
    "start": "240",
    "end": "7000"
  },
  {
    "text": "couple things please I'm going to ask you to give a warm round of applaud to all the volunteers like Angelo people",
    "start": "7000",
    "end": "14040"
  },
  {
    "text": "helping the staff and the blackout [Applause]",
    "start": "14040",
    "end": "20749"
  },
  {
    "text": "organization now how many of you have ever used windows I don't believe you you didn't",
    "start": "20800",
    "end": "27840"
  },
  {
    "text": "get the question how many of you ever used Windows okay that's everybody how many",
    "start": "27840",
    "end": "33480"
  },
  {
    "text": "of you have ever done a penetration test okay that's like half of you how",
    "start": "33480",
    "end": "39840"
  },
  {
    "text": "many of you have done a penetration test on a Windows Network all of the previous ones okay",
    "start": "39840",
    "end": "46760"
  },
  {
    "text": "you should have seen what we're going to show you because it's so trivial and also so",
    "start": "46760",
    "end": "53320"
  },
  {
    "text": "interesting so where are we uh so my name is Jonathan bruss",
    "start": "55359",
    "end": "61000"
  },
  {
    "text": "um I've been presenting here a few times if you like lowlevel hacking",
    "start": "61000",
    "end": "68600"
  },
  {
    "text": "reverse engineering and things like this we run a couple conferences in uh Paris and Hawaii so feel free to",
    "start": "68600",
    "end": "74920"
  },
  {
    "text": "submit uh so yeah I'm part of the program program Committee of shakacon and mo.com it's a new reverse",
    "start": "74920",
    "end": "82119"
  },
  {
    "text": "engineering platform I'm setting up if you want to uh trade out for free um just sign up it's invite only but if you",
    "start": "82119",
    "end": "89439"
  },
  {
    "text": "come from Black we approve it right so uh I'm Horas I'm a security",
    "start": "89439",
    "end": "95720"
  },
  {
    "text": "engineer at Salesforce as well um this is my first St at black hat so fingers crossed it goes",
    "start": "95720",
    "end": "101360"
  },
  {
    "text": "okay um I'd like to point out that we are",
    "start": "101360",
    "end": "106439"
  },
  {
    "text": "breaking Windows 10 kind of sort of but yeah it is uh breaking Windows 10 breaking Microsoft Edge uh released 5",
    "start": "106439",
    "end": "112280"
  },
  {
    "text": "days ago so good luck with that um yeah that's about",
    "start": "112280",
    "end": "117680"
  },
  {
    "text": "it right so agenda uh what we're going to go through today uh basically we're going to do",
    "start": "117680",
    "end": "124399"
  },
  {
    "text": "like an introduction to what SMB is uh what kind of previous work is done for relaying smv hashes uh uh smv relay",
    "start": "124399",
    "end": "133280"
  },
  {
    "text": "rebooted which is basically us our attack uh yeah we have a couple of interesting attack names uh courtesy",
    "start": "133280",
    "end": "140000"
  },
  {
    "text": "Jonathan uh French Kiss attack the syphilis attack which includes malware obviously uh Minaj atwa and how do we",
    "start": "140000",
    "end": "147280"
  },
  {
    "text": "mitigate against it uh you want to give the IBM okay so uh",
    "start": "147280",
    "end": "153959"
  },
  {
    "text": "let's imagine for a second we back in like 1984 and we all work for",
    "start": "153959",
    "end": "159159"
  },
  {
    "text": "IBM so we're working on this uh awesome operating system called os2 with a small",
    "start": "159159",
    "end": "164680"
  },
  {
    "text": "setup called Microsoft I don't know if you guys have heard of them um so basically we we trained to on this",
    "start": "164680",
    "end": "172800"
  },
  {
    "text": "operating system which is uh not even in protected mode yet so it's real mode 16",
    "start": "172800",
    "end": "178040"
  },
  {
    "text": "16 bit meaning that we have one megabyte of memory at Max we don't have multitasking and what we're trying to do",
    "start": "178040",
    "end": "184720"
  },
  {
    "text": "is file sharing so doing file sharing without multitasking is a challenge in itself because like doing TCP",
    "start": "184720",
    "end": "190560"
  },
  {
    "text": "connections and things is super difficult but essentially that's where we are and the big question mark is all",
    "start": "190560",
    "end": "196959"
  },
  {
    "text": "about Security in 1984 uh because that's where SMB and C",
    "start": "196959",
    "end": "204200"
  },
  {
    "text": "the fight system were actually um invented um if you consider that in 95",
    "start": "204200",
    "end": "210120"
  },
  {
    "text": "uh when Microsoft first shipped Windows 95 the shares were actually open um because the irrational behind it",
    "start": "210120",
    "end": "217400"
  },
  {
    "text": "was that if you buy a computer is to put it in a corporate Network and you want to be able to share files with all of",
    "start": "217400",
    "end": "224280"
  },
  {
    "text": "your colleagues without entering passwords so now if we go back to 1984 like obviously there would be even",
    "start": "224280",
    "end": "231159"
  },
  {
    "text": "less security right and that's where all the problems we're going to discuss today are",
    "start": "231159",
    "end": "237879"
  },
  {
    "text": "rooted right um so a quick demo of what exactly has been done",
    "start": "237879",
    "end": "243640"
  },
  {
    "text": "previously um forgive the video because it requires a lan to do",
    "start": "243640",
    "end": "250640"
  },
  {
    "text": "this right so what we have here is basically um a cool piece of software",
    "start": "250640",
    "end": "256440"
  },
  {
    "text": "from core security which does SMB reaying I'll explain more about that later on um we have a unsuspecting",
    "start": "256440",
    "end": "264000"
  },
  {
    "text": "victim who's going to browse to some internet website which is basically in the Lan and this website has got an",
    "start": "264000",
    "end": "270680"
  },
  {
    "text": "image tag in it which basically is going to do like some magic in the background or something like that we'll explain that more later on but what is happening",
    "start": "270680",
    "end": "277120"
  },
  {
    "text": "over here is this browser sent ntlm creds off the",
    "start": "277120",
    "end": "284520"
  },
  {
    "text": "victim automatically to a unknown source which is mindboggling in itself I",
    "start": "284520",
    "end": "291759"
  },
  {
    "text": "mean why would you do that but fine it's over the Internet so you would assume okay fine whoever's in your landan is",
    "start": "291759",
    "end": "297960"
  },
  {
    "text": "kind of sort of safe as you can see over here it's basically the admin creds have been sent and over here you have like we",
    "start": "297960",
    "end": "305560"
  },
  {
    "text": "uploading some kind of malare payload so fantastic so we upload malware we run it we get a reverse shell Bob's your uncle",
    "start": "305560",
    "end": "311759"
  },
  {
    "text": "and whatever right so that is what has been done previously so a quick walk through",
    "start": "311759",
    "end": "319600"
  },
  {
    "text": "what exactly is smv uh it's basically file sharing on your windows network uh",
    "start": "319600",
    "end": "324919"
  },
  {
    "text": "it's uh server message block protocol whatever you can call it Linux calls it samb",
    "start": "324919",
    "end": "330600"
  },
  {
    "text": "um it requires authentication back in the day there used to be basic authentication which was basically sending your creds in plain text then uh",
    "start": "330600",
    "end": "338680"
  },
  {
    "text": "it improved uh by doing land manager which was basically md4 of your uh credentials which could be broken easily",
    "start": "338680",
    "end": "346000"
  },
  {
    "text": "uh then it improved again with doing ntlm V1 which was basically md4 and hmac",
    "start": "346000",
    "end": "351759"
  },
  {
    "text": "md5 and they would basically break the password into two parts which you could break that really easily the thing is",
    "start": "351759",
    "end": "358400"
  },
  {
    "text": "they came up with ntlmv2 and ntlmv2 is what we're going to be attacking as well today and it was",
    "start": "358400",
    "end": "364080"
  },
  {
    "text": "designed for local networks um ntlmv2 like I mentioned it's a server client challenge response kind of protocol",
    "start": "364080",
    "end": "370400"
  },
  {
    "text": "basically uh hmac md5 with uh md4 hash of your password is used to sign all the",
    "start": "370400",
    "end": "376160"
  },
  {
    "text": "messages the good thing about this is it cannot be replayed apparently um SMB relay which I actually",
    "start": "376160",
    "end": "382560"
  },
  {
    "text": "showed you in the demo today basically it's a really really old exploit was found really I mean like what 14 years",
    "start": "382560",
    "end": "388680"
  },
  {
    "text": "ago in 2001 by uh sistic of CDC um the tool that I showed you right now is basically from",
    "start": "388680",
    "end": "395280"
  },
  {
    "text": "core security it's smv relay X you can download it from online there's a metasite module so skides can use this",
    "start": "395280",
    "end": "401000"
  },
  {
    "text": "fantastic um what it does is basically it replays a hash from one machine to another machine and that's about it uh",
    "start": "401000",
    "end": "407880"
  },
  {
    "text": "it authenticates using that um the original TX scenario is very",
    "start": "407880",
    "end": "413000"
  },
  {
    "text": "limited it's basically only on the internet uh those of you who have done penetration testing for Windows networks",
    "start": "413000",
    "end": "419120"
  },
  {
    "text": "will definitely have done this before uh basically set up a rogue website and it'll start relaying hashes all",
    "start": "419120",
    "end": "426960"
  },
  {
    "text": "across uh limits of this attack we'd like to stress this a lot not possible",
    "start": "426960",
    "end": "432120"
  },
  {
    "text": "over the Internet this is the mitigating Factor apparently for this exploit I",
    "start": "432120",
    "end": "438000"
  },
  {
    "text": "mean the rational behind it was that U the initial protocol was never meant to be exposed to anything like the internet",
    "start": "438000",
    "end": "445840"
  },
  {
    "text": "it was built from the very start to create like corporate Networks uh and the first exploits being um um",
    "start": "445840",
    "end": "452960"
  },
  {
    "text": "affecting only local network people assume that you know the attacks we're going to show you today I just B not",
    "start": "452960",
    "end": "459720"
  },
  {
    "text": "possible right so there was a partial fix basically you cannot replay the credentials to the same machine again",
    "start": "459720",
    "end": "466000"
  },
  {
    "text": "and that's it uh you could break the hash you could relay to another machine you could do whatever you want with it",
    "start": "466000",
    "end": "473280"
  },
  {
    "text": "um so uh interesting thing the slide came up because I was telling Jonathan like when we were doing this research",
    "start": "473280",
    "end": "478879"
  },
  {
    "text": "like uh we basically repeating what everyone else is doing only remotely over the internet and John is just like",
    "start": "478879",
    "end": "484120"
  },
  {
    "text": "looking at me like did you realize what he just said you're doing it over the Internet man what the hell anyways so smv relay",
    "start": "484120",
    "end": "491919"
  },
  {
    "text": "rebooted um yeah demo time okay so we're going to start with",
    "start": "491919",
    "end": "498000"
  },
  {
    "text": "demos all the time and then we will explain you like what's going on underneath",
    "start": "498000",
    "end": "504240"
  },
  {
    "text": "okay so this is the attacker machine we're setting up a",
    "start": "510400",
    "end": "515599"
  },
  {
    "text": "relay we're going to set where your Shar just to uh see what's going on in the",
    "start": "515599",
    "end": "520919"
  },
  {
    "text": "background so packet sniffer and we're going to load a page",
    "start": "520919",
    "end": "529839"
  },
  {
    "text": "using I and we can see that there is actually some traffic going on and this",
    "start": "529839",
    "end": "535000"
  },
  {
    "text": "is happening over the Internet so that's just not supposed to happen at all",
    "start": "535000",
    "end": "541440"
  },
  {
    "text": "uh you can also see over here that we have a received Challenge and a received authentication that we relayed over just",
    "start": "543000",
    "end": "549040"
  },
  {
    "text": "to prove that we actually doing the replaying anyways back to the",
    "start": "549040",
    "end": "556000"
  },
  {
    "text": "slides right so all windows versions are affected uh back from I guess 95 maybe",
    "start": "556640",
    "end": "563920"
  },
  {
    "text": "all the way to Windows 10 uh Edge this is all default out of the box what I'm",
    "start": "563920",
    "end": "569120"
  },
  {
    "text": "trying to say out here is that your machine is sending ntlm creds over the",
    "start": "569120",
    "end": "574200"
  },
  {
    "text": "internet without doing any user interaction ever so basically you visit",
    "start": "574200",
    "end": "579519"
  },
  {
    "text": "a website that's it done you have",
    "start": "579519",
    "end": "583360"
  },
  {
    "text": "owned it's fantastic right um this is another fantastic slide uh",
    "start": "584640",
    "end": "590720"
  },
  {
    "text": "basically Microsoft has a great uh mitigation blog on SMB relaying uh this",
    "start": "590720",
    "end": "596079"
  },
  {
    "text": "was published way back in like 2009 or something but they say over here that the issue is not severe mainly because",
    "start": "596079",
    "end": "602160"
  },
  {
    "text": "it's limited only to the local internet and I don't think so they ever verified that but",
    "start": "602160",
    "end": "609399"
  },
  {
    "text": "sure um okay so uh if we look at iie there is",
    "start": "609399",
    "end": "614959"
  },
  {
    "text": "actually a setting um to get to choose like where you're supposed to authenticate using",
    "start": "614959",
    "end": "621320"
  },
  {
    "text": "SMB um so you can do Anonymous log on the default is to log on on the internet",
    "start": "621320",
    "end": "627000"
  },
  {
    "text": "zone so what I just described you suppose basically it's leveraging single sign on so when you using active",
    "start": "627000",
    "end": "633440"
  },
  {
    "text": "directory and you're connecting to the shares of somebody else inside your company you don't have to enter your credentials",
    "start": "633440",
    "end": "639320"
  },
  {
    "text": "again um so this is the default and there is also automatic Lon with current",
    "start": "639320",
    "end": "645279"
  },
  {
    "text": "username and password and prompt for username and password uh what is interesting is that",
    "start": "645279",
    "end": "650920"
  },
  {
    "text": "none of this actually works uh if we look at the a trigger so the trigger is",
    "start": "650920",
    "end": "656079"
  },
  {
    "text": "really trivial it's basically like you redirect um um through an image tag or something",
    "start": "656079",
    "end": "662000"
  },
  {
    "text": "like that uh if you are attacking via HTML you redirect via this image tag to",
    "start": "662000",
    "end": "667519"
  },
  {
    "text": "a remote share on the internet and that's it that is the",
    "start": "667519",
    "end": "672920"
  },
  {
    "text": "trigger uh so we saw we saw that uh SMB traffic is actually going on which is",
    "start": "672920",
    "end": "678639"
  },
  {
    "text": "not supposed to happen right because the defaults were um connecting only over",
    "start": "678639",
    "end": "684560"
  },
  {
    "text": "the internet and not like sending new credentials all over to the internet to anybody asking it",
    "start": "684560",
    "end": "691240"
  },
  {
    "text": "okay and if we look at the packets like we can see the username in plain text uh we can",
    "start": "694639",
    "end": "700360"
  },
  {
    "text": "see uh yeah the DNS a whole bunch of stuff and there is actually um um um a",
    "start": "700360",
    "end": "706760"
  },
  {
    "text": "derivative of your password which is not like what we call the hash as in a pass the hash attack but which is like yeah",
    "start": "706760",
    "end": "713760"
  },
  {
    "text": "derive nlm hash from your original password so a hacker can get that from",
    "start": "713760",
    "end": "720440"
  },
  {
    "text": "the internet uh let's look a little bit at like why is this",
    "start": "720440",
    "end": "725760"
  },
  {
    "text": "happening uh so we've been looking at okay this is just uh the the setting box",
    "start": "725760",
    "end": "732200"
  },
  {
    "text": "of uh Windows uh if we look like you know inside the debugger like which thread is",
    "start": "732200",
    "end": "738240"
  },
  {
    "text": "actually running like we find that one and then looking a bit like poking",
    "start": "738240",
    "end": "743880"
  },
  {
    "text": "around we actually find the vulnerable uh dll so you can see on the right hand",
    "start": "743880",
    "end": "749680"
  },
  {
    "text": "side that this is the uh the menu corresponding to the previous one what is interesting up there is that this dll",
    "start": "749680",
    "end": "756199"
  },
  {
    "text": "is actually not an Internet Explorer dll it's a dll which is in the system directory and it's actually shared by",
    "start": "756199",
    "end": "763120"
  },
  {
    "text": "many more applications and not just I and we're going to see what the impact",
    "start": "763120",
    "end": "769040"
  },
  {
    "text": "of that um so then uh we so we took this Windows setting we",
    "start": "769040",
    "end": "775680"
  },
  {
    "text": "took a snapshot of the registry we changed the setting to another one uh for instance like you know prompt for",
    "start": "775680",
    "end": "782800"
  },
  {
    "text": "username and passwords every time we took another snapshot of the registry and this is a diff so basically the",
    "start": "782800",
    "end": "789560"
  },
  {
    "text": "setting is actually stored in the registry and this is working but if we look at a trace um of",
    "start": "789560",
    "end": "799199"
  },
  {
    "text": "uh you know running AE and connecting uh to a remote share using exploit uh we can see in the next slide",
    "start": "799199",
    "end": "807240"
  },
  {
    "text": "yeah sorry uh uh we can see that it's actually querying all those uh registry",
    "start": "807240",
    "end": "813120"
  },
  {
    "text": "keys so when you connect from the internet to a remote share all those all",
    "start": "813120",
    "end": "819079"
  },
  {
    "text": "those keys are are probed and none of them works or actually does",
    "start": "819079",
    "end": "824560"
  },
  {
    "text": "anything so we learned a few things uh out of this uh we learned like which registry key is actually uh",
    "start": "825959",
    "end": "832920"
  },
  {
    "text": "involved uh we learned that uh the the applications which fetch urls",
    "start": "832920",
    "end": "840240"
  },
  {
    "text": "I mean unless you're writing your own TCP IP stack basically you're leveraging the one of Windows and if you do",
    "start": "840240",
    "end": "847160"
  },
  {
    "text": "leverage uh the URL mechanism of Windows you are vulnerable whichever application",
    "start": "847160",
    "end": "853360"
  },
  {
    "text": "you use because this is coming from the system Windows directory",
    "start": "853360",
    "end": "859880"
  },
  {
    "text": "um okay let's go for another uh demo so this time we're going to leverage this",
    "start": "859880",
    "end": "865959"
  },
  {
    "text": "trigger and actually push a malware from the internet so it's assuming a couple things uh it's",
    "start": "865959",
    "end": "872519"
  },
  {
    "text": "assuming that you I mean the corporation you're attacking the machine is domain",
    "start": "872519",
    "end": "879000"
  },
  {
    "text": "joined and that there is an SMB server exposed to the internet to relay",
    "start": "879000",
    "end": "885800"
  },
  {
    "text": "to belonging to that company that's a pretty big assumption for the time",
    "start": "885800",
    "end": "891759"
  },
  {
    "text": "being so so you can see the thing like we put the attacker in green",
    "start": "894519",
    "end": "901040"
  },
  {
    "text": "green we asking the web browser to brow to attack a control web",
    "start": "902079",
    "end": "908480"
  },
  {
    "text": "page and that's essentially",
    "start": "908480",
    "end": "912600"
  },
  {
    "text": "it and if we go back to the um command and control we got a a new",
    "start": "913600",
    "end": "921240"
  },
  {
    "text": "shell in know met pretor so we're going to pivote to like another process ID in",
    "start": "921240",
    "end": "926880"
  },
  {
    "text": "memory and then we're just going to p mware into this same",
    "start": "926880",
    "end": "932639"
  },
  {
    "text": "machine okay so it's migrated successfully inside another process running in the memory of the target",
    "start": "933199",
    "end": "940399"
  },
  {
    "text": "victim and now we can actually so we have a shell on the machine like we can you know lease directories Bros",
    "start": "945880",
    "end": "952480"
  },
  {
    "text": "directories whatever",
    "start": "952480",
    "end": "956480"
  },
  {
    "text": "from the",
    "start": "959360",
    "end": "961920"
  },
  {
    "text": "internet all right so why exactly do we call it the cilis attack first of all uh this was made up about 1 hour ago when",
    "start": "965160",
    "end": "972759"
  },
  {
    "text": "we decided like okay we sending malare over the Internet um basically we set up",
    "start": "972759",
    "end": "979000"
  },
  {
    "text": "just a any website uh people know how difficult it is to set up a website nowadays apparently uh you can set it up",
    "start": "979000",
    "end": "986480"
  },
  {
    "text": "on r/ netc full users just saying check out these brand new exploits um they visit with iie I guess if you're on net",
    "start": "986480",
    "end": "993360"
  },
  {
    "text": "SEC you don't use iie but uh you can visit it with iie if we get your creds we attack your domain controller we",
    "start": "993360",
    "end": "999079"
  },
  {
    "text": "upload malware all of this with readymade tools and apparently this is not supposed to happen still I like to",
    "start": "999079",
    "end": "1005040"
  },
  {
    "text": "keep emphasizing that point um but just uh malware upload is not",
    "start": "1005040",
    "end": "1011160"
  },
  {
    "text": "enough apparently um what about ntlm using HTTP server Authentication",
    "start": "1011160",
    "end": "1018959"
  },
  {
    "text": "first I'd like to say some attack limitations to this first uh SMB signing has to be disabled uh this was one of",
    "start": "1018959",
    "end": "1025480"
  },
  {
    "text": "the mitigations proposed by Microsoft which doesn't allow you to upload any",
    "start": "1025480",
    "end": "1030918"
  },
  {
    "text": "files to anything using SMB without SMB signing um it is disabled by default uh",
    "start": "1030919",
    "end": "1038640"
  },
  {
    "text": "unless you're on the domain controller people recommend to disable it because it's a huge performance impact it's like",
    "start": "1038640",
    "end": "1043798"
  },
  {
    "text": "a 20% performance 30% performance impact um and you need outbound on all of your",
    "start": "1043799",
    "end": "1050559"
  },
  {
    "text": "machines from the firewall uh this is an interesting slide uh SMB signing must be disabled for",
    "start": "1050559",
    "end": "1057000"
  },
  {
    "text": "certain corporate firewalls to be to work properly my yeah okay uh but yeah",
    "start": "1057000",
    "end": "1063440"
  },
  {
    "text": "so fantastic the one mitigation that's there is uh disabled by default or whatever sure not a big problem okay uh",
    "start": "1063440",
    "end": "1071200"
  },
  {
    "text": "another one that is basically so people always say like why",
    "start": "1071200",
    "end": "1077799"
  },
  {
    "text": "uh okay so it's not a big deal you have to have smv ports open it doesn't matter I have uh complete firewall security I",
    "start": "1077799",
    "end": "1083760"
  },
  {
    "text": "don't all Ingress firewall security is all set up properly but not many people",
    "start": "1083760",
    "end": "1090320"
  },
  {
    "text": "know that you can do RDP or HTP apparently uh it's a new feature in Windows Server so here's a little quick",
    "start": "1090320",
    "end": "1097480"
  },
  {
    "text": "demo of how it actually works",
    "start": "1097480",
    "end": "1104320"
  },
  {
    "text": "uh so we'll give you the demo and then we'll explain what's actually going",
    "start": "1106600",
    "end": "1112080"
  },
  {
    "text": "on so yeah here we this is just showing RDP or HTTP working in the normal happy",
    "start": "1112440",
    "end": "1118200"
  },
  {
    "text": "scenario where you don't have where you have the creds and",
    "start": "1118200",
    "end": "1122320"
  },
  {
    "text": "everything so this is a Windows RDP Gateway uh basically you can set up apps you can set up RDP connections you can",
    "start": "1124159",
    "end": "1131320"
  },
  {
    "text": "see there's uh pow shell calculator we're just going to launch calculator for",
    "start": "1131320",
    "end": "1136520"
  },
  {
    "text": "now so you download the connection SC RP and if you dou double click on it you get connected and in this case we choose",
    "start": "1136520",
    "end": "1142760"
  },
  {
    "text": "to like just execute a calculator yep um so just one interesting thing out here",
    "start": "1142760",
    "end": "1149280"
  },
  {
    "text": "the authentication that you saw over here on this web page ntlm Auto HTTP so",
    "start": "1149280",
    "end": "1154880"
  },
  {
    "text": "great so this solve the problem of going back to the network once you sniffed a hash or when you want a relay because",
    "start": "1154880",
    "end": "1162480"
  },
  {
    "text": "inste you know uh let's say I have your hash I'm on the internet if I want to connect to you know a machine inside",
    "start": "1162480",
    "end": "1168440"
  },
  {
    "text": "your then I still have to pierce your firewall so instead of piercing your firewall over SMB which is you know",
    "start": "1168440",
    "end": "1174840"
  },
  {
    "text": "quite likely not going to happen because people don't allow incoming traffic using SMB when they're",
    "start": "1174840",
    "end": "1180240"
  },
  {
    "text": "reasonable however this still the problem because we can just relay it to RDP over",
    "start": "1180240",
    "end": "1185840"
  },
  {
    "text": "HTTP and like if your servers are this enable like that's how it works there is nothing to",
    "start": "1185840",
    "end": "1192799"
  },
  {
    "text": "pierce so uh for this to work we need to first uh sniff a hash then we need to",
    "start": "1195840",
    "end": "1202720"
  },
  {
    "text": "crack the hash to get like your proper um um yeah your proper credentials essentially the username is always sent",
    "start": "1202720",
    "end": "1209240"
  },
  {
    "text": "in plain text uh but the crash the hash needs to be cracked for that we need to",
    "start": "1209240",
    "end": "1214360"
  },
  {
    "text": "uh we Lage gpus we have a r machine with like five gpus uh it's using a very standard tool",
    "start": "1214360",
    "end": "1221360"
  },
  {
    "text": "for hash cracking Kash cat and we cracking at two to four billion a second um so that's what the looks",
    "start": "1221360",
    "end": "1231080"
  },
  {
    "text": "like um yep and so this key space we used for demoing was like a key space of",
    "start": "1232039",
    "end": "1238360"
  },
  {
    "text": "68 characters so a mix of uppercase lower case alpha numeric and those",
    "start": "1238360",
    "end": "1243640"
  },
  {
    "text": "special characters uh assuming you have a password length of eight or less we can",
    "start": "1243640",
    "end": "1249440"
  },
  {
    "text": "break that in less than 3 days and of course like if you have a million hashes",
    "start": "1249440",
    "end": "1255240"
  },
  {
    "text": "breaking this million hash this million of hashes is not going to take longer like hashcat can um you know do all of",
    "start": "1255240",
    "end": "1262799"
  },
  {
    "text": "it in a parallel way so if we look at you know I was like",
    "start": "1262799",
    "end": "1268799"
  },
  {
    "text": "but who's actually using this uh uh authentication of SMB over HTTP I was",
    "start": "1268799",
    "end": "1274440"
  },
  {
    "text": "like probably nobody so I gave it a show Dan search and no actually a fa bit of people the first one being Sony in Asia",
    "start": "1274440",
    "end": "1281960"
  },
  {
    "text": "I'll let you draw your own conclusions",
    "start": "1281960",
    "end": "1285840"
  },
  {
    "text": "right so the impact of this so what exactly did we do over here right now um",
    "start": "1293240",
    "end": "1299039"
  },
  {
    "text": "we can retrieve your user credentials great uh we need a hash tracking machine to do that uh that's no problem uh we",
    "start": "1299039",
    "end": "1306440"
  },
  {
    "text": "have remote code execution uh if you have SMB signing disabled but yeah",
    "start": "1306440",
    "end": "1311600"
  },
  {
    "text": "that's always done because of performance or fire Reon anyway yeah um",
    "start": "1311600",
    "end": "1317760"
  },
  {
    "text": "the main users of IE are corporate environments uh Banks uh your bank always uses IE uh so great for us I",
    "start": "1317760",
    "end": "1326559"
  },
  {
    "text": "guess all your money is gone um however this is not the only trigger",
    "start": "1326559",
    "end": "1332840"
  },
  {
    "text": "that we found um there are other triggers against uh that create SMB connections like we already mentioned",
    "start": "1332840",
    "end": "1338400"
  },
  {
    "text": "that this one dll it's not just used by IE it's used by literally everything in Windows for doing ntlm a so Inc plc. DL",
    "start": "1338400",
    "end": "1347080"
  },
  {
    "text": "if you link again that you are",
    "start": "1347080",
    "end": "1350519"
  },
  {
    "text": "vulnerable right so video trigger so let's try to uh instead of just using a",
    "start": "1352240",
    "end": "1358960"
  },
  {
    "text": "as a trigger um we're going to we're going to try to you know use different clients so",
    "start": "1358960",
    "end": "1365240"
  },
  {
    "text": "for instance we can leverage um a media player Windows Media Player",
    "start": "1365240",
    "end": "1372240"
  },
  {
    "text": "to redirect to uh HTTP this is just cuz it's funny uh I actually took a malware",
    "start": "1372240",
    "end": "1378080"
  },
  {
    "text": "was do it and I just happen to change the url uh this is a supported feature",
    "start": "1378080",
    "end": "1383320"
  },
  {
    "text": "of Windows um media videos um yeah you can embid an URL",
    "start": "1383320",
    "end": "1389360"
  },
  {
    "text": "which gets open automatically when you play the video and if you do that like yeah you can redirect this particular",
    "start": "1389360",
    "end": "1395120"
  },
  {
    "text": "page to SMB and you're set um so the rest of the demo is essentially the same",
    "start": "1395120",
    "end": "1400799"
  },
  {
    "text": "thing we got a metor",
    "start": "1400799",
    "end": "1404000"
  },
  {
    "text": "shell maybe yeah here we go we migrating to a new PID process ID in",
    "start": "1406080",
    "end": "1413919"
  },
  {
    "text": "memory and this is it we enjoying all shell so what the user did was basically",
    "start": "1413919",
    "end": "1419120"
  },
  {
    "text": "open a video and period any",
    "start": "1419120",
    "end": "1426799"
  },
  {
    "text": "questions cool",
    "start": "1432000",
    "end": "1436000"
  },
  {
    "text": "right so let's go to the real thing uh so this attack is called a men and instead of breaking the hash",
    "start": "1438559",
    "end": "1445840"
  },
  {
    "text": "like with the RP um uh demo uh we actually going to relay over the",
    "start": "1445840",
    "end": "1451960"
  },
  {
    "text": "internet to a server which is listening with the same kind of connectors uh",
    "start": "1451960",
    "end": "1457840"
  },
  {
    "text": "accepting SMB authentication over HTTP uh so instead of using rgp we",
    "start": "1457840",
    "end": "1463720"
  },
  {
    "text": "actually going to attack an exchange server I mean many many people you know",
    "start": "1463720",
    "end": "1470760"
  },
  {
    "text": "have have uh exchange servers when they're using uh Microsoft clients um so",
    "start": "1470760",
    "end": "1477279"
  },
  {
    "text": "like yeah it seems like a reasonable",
    "start": "1477279",
    "end": "1480679"
  },
  {
    "text": "setup so omr is going to start in the background a small service which uh will",
    "start": "1482760",
    "end": "1489880"
  },
  {
    "text": "listen for incoming",
    "start": "1489880",
    "end": "1495200"
  },
  {
    "text": "SMB and the trigger is actually just Outlook so you view an",
    "start": "1496080",
    "end": "1502760"
  },
  {
    "text": "email and just the fact of viewing this email you didn't click on any picture or anything it's actually sending your",
    "start": "1502760",
    "end": "1510080"
  },
  {
    "text": "credentials um over the internet to SMB server listening and this SMB server is",
    "start": "1510080",
    "end": "1516440"
  },
  {
    "text": "relaying it to exchange to the point that we're downloading your entire mailbox this is not one email this was",
    "start": "1516440",
    "end": "1522559"
  },
  {
    "text": "your entire mailbox that you can see over there",
    "start": "1522559",
    "end": "1530080"
  },
  {
    "text": "maybe y here we go so we download like the entire mailbox in XML and from a user",
    "start": "1530080",
    "end": "1536559"
  },
  {
    "text": "perspective like this extremely little interaction you basically received an email and open the email and that's",
    "start": "1536559",
    "end": "1544080"
  },
  {
    "text": "it it gets viewed by default like when you open Outlook anyway so interaction",
    "start": "1544520",
    "end": "1549640"
  },
  {
    "text": "can be like absolutely zero C I think we",
    "start": "1549640",
    "end": "1556919"
  },
  {
    "text": "call fine uh just like the point out over",
    "start": "1556919",
    "end": "1562720"
  },
  {
    "text": "here you can see the name of the sender you can see the email IDs you can see um",
    "start": "1563440",
    "end": "1570360"
  },
  {
    "text": "basically the subject of anything so this is your entire mailbox over here um",
    "start": "1570360",
    "end": "1575960"
  },
  {
    "text": "that's it so you we spam you emails and we get your entire mailbox how many people use exchange servers over",
    "start": "1575960",
    "end": "1583480"
  },
  {
    "text": "here so this is very close to be warable right because once once you download",
    "start": "1584760",
    "end": "1590080"
  },
  {
    "text": "like the uh XML file um from a user a corporate user you have access to most",
    "start": "1590080",
    "end": "1596600"
  },
  {
    "text": "of their password but you also have access to all of their contacts and things like this and we could use that to you know send more emails",
    "start": "1596600",
    "end": "1604799"
  },
  {
    "text": "basically okay so uh if we look back at like those demos uh we've been doing it",
    "start": "1609880",
    "end": "1615799"
  },
  {
    "text": "over azur and AWS so if you have either clients or servers on any of those you",
    "start": "1615799",
    "end": "1622080"
  },
  {
    "text": "are basically vulnerable they don't do uh SMB erress",
    "start": "1622080",
    "end": "1627520"
  },
  {
    "text": "filtering um so like we saw with The Showdown query there's actually thousands of servers uh allowing SMB",
    "start": "1627520",
    "end": "1634760"
  },
  {
    "text": "connection over HTTP and the defaults aren't safe like extending protection is not enabled by",
    "start": "1634760",
    "end": "1640880"
  },
  {
    "text": "default which is the only thing which would actually prevent this class of attack uh even if you have packet",
    "start": "1640880",
    "end": "1646520"
  },
  {
    "text": "signing enabled since we're relaying over HTTP um it it's not going to protect you",
    "start": "1646520",
    "end": "1654679"
  },
  {
    "text": "however extended protection would but it's extremely hard to configure and it's enabled nowhere by",
    "start": "1654679",
    "end": "1661440"
  },
  {
    "text": "default it wouldn't prevent you from in any case sniffing packets it's all about",
    "start": "1661840",
    "end": "1669000"
  },
  {
    "text": "relaying so how to protect yourself um so like we said the first mitigation is",
    "start": "1669559",
    "end": "1675039"
  },
  {
    "text": "at some point you need to exit you need to have an SMB packet which is exiting to the",
    "start": "1675039",
    "end": "1680559"
  },
  {
    "text": "internet um so the first layer of mitigation is absolutely to drop SMB at firewall level um um you know in",
    "start": "1680559",
    "end": "1688159"
  },
  {
    "text": "corporate environment this is actually the preferred remediation offered by Microsoft and also it sucks why because",
    "start": "1688159",
    "end": "1694840"
  },
  {
    "text": "if you don't jooy it on a laptop and you bring your laptop home well then you do",
    "start": "1694840",
    "end": "1700279"
  },
  {
    "text": "remain vulnerable so instead of you know Doing Network like in the '90s like you",
    "start": "1700279",
    "end": "1705840"
  },
  {
    "text": "know like a egg hard outside and soft inside I much prefer a solution which is host based hardening so instead of",
    "start": "1705840",
    "end": "1712840"
  },
  {
    "text": "relaying on your corporate firewall I would strongly recommend you actually",
    "start": "1712840",
    "end": "1717919"
  },
  {
    "text": "use your windows personal firewall to do the same thing which is essentially dropping SMB traffic to public IPS you",
    "start": "1717919",
    "end": "1724880"
  },
  {
    "text": "can like if you want to keep the functionality within your network that's probably fine but I don't see any",
    "start": "1724880",
    "end": "1730279"
  },
  {
    "text": "legitimate reason to send SMB packets over the Internet or you're doing something insane like exposing SMB uh",
    "start": "1730279",
    "end": "1736880"
  },
  {
    "text": "servers anyway um so you might want to enable packet signing uh which um you know prevents it",
    "start": "1736880",
    "end": "1745760"
  },
  {
    "text": "doesn't it won't prevent the packets from leaking and your hashes to be leaked to the internet but if a hacker",
    "start": "1745760",
    "end": "1752279"
  },
  {
    "text": "gets your hashes it will prevent them from basically coming back to your network uh and push malware like we",
    "start": "1752279",
    "end": "1758519"
  },
  {
    "text": "first did um uh if you're using um yeah if he's relating to an SMB server this",
    "start": "1758519",
    "end": "1765840"
  },
  {
    "text": "will have I mean packet signing is not going to prevent uh um the uh leak of",
    "start": "1765840",
    "end": "1772399"
  },
  {
    "text": "your credentials basically does kill the connection but once the credentials have been sent so in terms of you know",
    "start": "1772399",
    "end": "1778760"
  },
  {
    "text": "preventing hash leakage it doesn't work and of course uh enable extended",
    "start": "1778760",
    "end": "1784080"
  },
  {
    "text": "protection if you",
    "start": "1784080",
    "end": "1786720"
  },
  {
    "text": "can right so what's the takeaway over here um we managed to get the",
    "start": "1791000",
    "end": "1796360"
  },
  {
    "text": "credentials over the Internet that's one uh it's super simple to do uh you have",
    "start": "1796360",
    "end": "1802200"
  },
  {
    "text": "readymade tools to do it for you uh literally if you didn't do like crazy",
    "start": "1802200",
    "end": "1807679"
  },
  {
    "text": "amount of coding for this it was all it's a lot of readymade stuff out there um it is not supposed to work according",
    "start": "1807679",
    "end": "1815519"
  },
  {
    "text": "to Microsoft uh we reported it about 9 months ago they don't want to fix it uh because it's defense in depth you need",
    "start": "1815519",
    "end": "1821919"
  },
  {
    "text": "uh like we said you need to uh have egress filters on your firewall um we managed to steal your",
    "start": "1821919",
    "end": "1829080"
  },
  {
    "text": "credentials through a variety of ways uh through a website uh through an email um",
    "start": "1829080",
    "end": "1834320"
  },
  {
    "text": "spam users download their mailbox through a video uh my mom and dad would definitely open up a video easily I",
    "start": "1834320",
    "end": "1840679"
  },
  {
    "text": "could easily convince them to do that uh steal their credentials that way um you could upload",
    "start": "1840679",
    "end": "1846960"
  },
  {
    "text": "malware uh you up you relayed from SMB to exchange um this is just a small tip",
    "start": "1846960",
    "end": "1855919"
  },
  {
    "text": "of the iceberg kind of thing that uses nlms SP I mean literally every Windows service uses ntlm in the background to",
    "start": "1855919",
    "end": "1864120"
  },
  {
    "text": "freaking authenticate everything um people use uh Kerberos nowadays but keros is limited because you have to be",
    "start": "1864120",
    "end": "1870799"
  },
  {
    "text": "in the domain to do that so ntlm is still being used widely um we showed",
    "start": "1870799",
    "end": "1877480"
  },
  {
    "text": "that we did it on Windows 10 uh great news for that Windows 10 Windows Edge completely patched nothing is going to",
    "start": "1877480",
    "end": "1883880"
  },
  {
    "text": "block it um and it was all done remotely",
    "start": "1883880",
    "end": "1889480"
  },
  {
    "text": "fantastic in terms of triggers uh so we thank [Applause]",
    "start": "1889480",
    "end": "1898519"
  },
  {
    "text": "you so in interestingly enough we stumbled upon this when we were actually working with ser and Shan who are",
    "start": "1898519",
    "end": "1905799"
  },
  {
    "text": "presenting tomorrow on another class of attack uh which is like a derivation of",
    "start": "1905799",
    "end": "1911919"
  },
  {
    "text": "xxe um we saw like this year many attacks on xxc and an interesting one",
    "start": "1911919",
    "end": "1917240"
  },
  {
    "text": "from an interesting post from Silence was absolutely related to what we're doing first of they were working on xxc",
    "start": "1917240",
    "end": "1924000"
  },
  {
    "text": "and they realized that when you can man in the middle updates locally many um",
    "start": "1924000",
    "end": "1930080"
  },
  {
    "text": "many software actually can be uh can be forced to do an SMB connection instead",
    "start": "1930080",
    "end": "1935480"
  },
  {
    "text": "of just um I mean from from an xxe so from an XML file essentially um",
    "start": "1935480",
    "end": "1941360"
  },
  {
    "text": "vulnerable software include like a a huge variety of software which are linked against the library we discovered",
    "start": "1941360",
    "end": "1948159"
  },
  {
    "text": "they include like things like iTunes major antivirus major clients for you",
    "start": "1948159",
    "end": "1953559"
  },
  {
    "text": "know typical um um um I mean web protocols uh so yeah uh the three we've",
    "start": "1953559",
    "end": "1960399"
  },
  {
    "text": "shown like belong to Microsoft but a lot of third bodyy software are going to be affected by this basically if you can",
    "start": "1960399",
    "end": "1966399"
  },
  {
    "text": "put an URL anywhere and this URL resoled to SMB you are vulnerable",
    "start": "1966399",
    "end": "1973240"
  },
  {
    "text": "period uh on that note we'd like to say thank you to msrc for working us with this",
    "start": "1973320",
    "end": "1979840"
  },
  {
    "text": "oh uh I'd also like to point out uh 14 years since this vulnerability has been",
    "start": "1982480",
    "end": "1987880"
  },
  {
    "text": "found and nobody's done packet sniffing on ntlm Mo over HTTP I'm pretty sure",
    "start": "1987880",
    "end": "1993679"
  },
  {
    "text": "somebody's using it out there just fii any questions so I started by asking",
    "start": "1993679",
    "end": "1999919"
  },
  {
    "text": "like who's done like you know Network assessments against Windows networks or",
    "start": "1999919",
    "end": "2005600"
  },
  {
    "text": "did you miss this this is so obvious any questions we go to",
    "start": "2005600",
    "end": "2013480"
  },
  {
    "text": "Mike yeah for um I noticed in your exploit that you were remotely getting",
    "start": "2013480",
    "end": "2019799"
  },
  {
    "text": "the username and password or sorry the username and domain name uh over HTTP",
    "start": "2019799",
    "end": "2024840"
  },
  {
    "text": "and the sniffs that you showed they're coming through in the clear so that's a pretty big breach in itself right",
    "start": "2024840",
    "end": "2030080"
  },
  {
    "text": "because we're leaking the users credentials not their password but I mean you've got something to C password",
    "start": "2030080",
    "end": "2036080"
  },
  {
    "text": "are in plain text and you get hash of the credentials essentially that you need to have to to break or relay so",
    "start": "2036080",
    "end": "2043080"
  },
  {
    "text": "that's a pretty big like uh way to identify that user perpetually right and",
    "start": "2043080",
    "end": "2048638"
  },
  {
    "text": "sure uh it leaks something about the internal structure the name of the company they're from they're coming off of like an anonymizer or something um if",
    "start": "2048639",
    "end": "2055599"
  },
  {
    "text": "I'm using Chrome is that an effect of mitigation um Chrome does actually uh",
    "start": "2055599",
    "end": "2060800"
  },
  {
    "text": "mitigate it because it asks you before sending any credentials we haven't checked third",
    "start": "2060800",
    "end": "2065919"
  },
  {
    "text": "party player I mean we haven't checked like like you know plugins media players and stuff like that within Chrome which",
    "start": "2065919",
    "end": "2071520"
  },
  {
    "text": "could very well be leveraging the very same API as a web browser by itself yes",
    "start": "2071520",
    "end": "2076878"
  },
  {
    "text": "you're right Chrome is not vable in the way I is uh coming to your um you know",
    "start": "2076879",
    "end": "2082398"
  },
  {
    "text": "the question in regards to essentially information disclosure uh in regards to um um you know what's happening inside",
    "start": "2082399",
    "end": "2089240"
  },
  {
    "text": "the network when you try to CL inside um a user I don't think we care so much about information disclosure when we got",
    "start": "2089240",
    "end": "2096000"
  },
  {
    "text": "shells like you know if the attack works you get a shell inside the network so like mapping the network like you don't",
    "start": "2096000",
    "end": "2102640"
  },
  {
    "text": "there is nothing to guess basically you are inside the network any other question yeah so in",
    "start": "2102640",
    "end": "2110640"
  },
  {
    "text": "that case that you just said oh you don't care because oh you're getting a shell but you know in my Enterprise maybe I don't have uh anything exposed",
    "start": "2110640",
    "end": "2117079"
  },
  {
    "text": "over SMB or RDP or anything I'm you're still leaking my name which I don't want to change really it's pain that's",
    "start": "2117079",
    "end": "2123160"
  },
  {
    "text": "absolutely correct that's absolutely correct yep",
    "start": "2123160",
    "end": "2128200"
  },
  {
    "text": "uh just to be clear if you're using a firewall on your computer on your router you're not vulnerable right to this",
    "start": "2128200",
    "end": "2133839"
  },
  {
    "text": "attack if uh by default you are vulnerable even if you're using a firewall",
    "start": "2133839",
    "end": "2139880"
  },
  {
    "text": "absolutely you need to block certain ports to mitigate but that's not the",
    "start": "2139880",
    "end": "2145040"
  },
  {
    "text": "default right like you install your Windows machine like you're not you're not safe basically you need to configure",
    "start": "2145040",
    "end": "2151560"
  },
  {
    "text": "your own firewall uh to block SMB traffic to public IPS otherwise you're going to break like file sharing Within",
    "start": "2151560",
    "end": "2157839"
  },
  {
    "text": "your land which might be you know what you want uh but but by default just because you have like you know xps2 are",
    "start": "2157839",
    "end": "2165359"
  },
  {
    "text": "better and that a firewall is embedded since it's not configured to block it like yeah you are",
    "start": "2165359",
    "end": "2172240"
  },
  {
    "text": "vable I wanted to ask if you guys had explored uh you mentioned one of the major mitigating factors was outbound",
    "start": "2172240",
    "end": "2177839"
  },
  {
    "text": "SNB have you explored webdav or the new features within Windows to have Port",
    "start": "2177839",
    "end": "2183000"
  },
  {
    "text": "specifications on the outbound connections so we tried within a large corporation I won't mention uh to come",
    "start": "2183000",
    "end": "2189800"
  },
  {
    "text": "back inside your own network um by creating um basically holes and I tried",
    "start": "2189800",
    "end": "2195599"
  },
  {
    "text": "mostly with FTP uh passive FTP uh but we didn't try web da and all that uh I",
    "start": "2195599",
    "end": "2200920"
  },
  {
    "text": "would say you know every Technique we know to Pi firewalls apply if this is really the way you want to go back",
    "start": "2200920",
    "end": "2207079"
  },
  {
    "text": "inside the network yeah you could do that any other question uh to to make",
    "start": "2207079",
    "end": "2215880"
  },
  {
    "text": "this uh attack work uh the you users have to log on as administrator or just",
    "start": "2215880",
    "end": "2224319"
  },
  {
    "text": "any account in administrators group because of the USU as far as I know any",
    "start": "2224319",
    "end": "2231839"
  },
  {
    "text": "account any account yeah okay and any account can relate to r r Oh you mean",
    "start": "2231839",
    "end": "2241079"
  },
  {
    "text": "when you re uh what are you talking about like leaking hashes to the internet or where can we execute and",
    "start": "2241079",
    "end": "2247119"
  },
  {
    "text": "relay stuff exe execute any any uh program so to leak stuff on the internet",
    "start": "2247119",
    "end": "2253040"
  },
  {
    "text": "yeah any account is vulnerable like you log with your machine um uh if we if if",
    "start": "2253040",
    "end": "2258200"
  },
  {
    "text": "basically you can browse the web uh you are vulnerable period when it comes to relaying back so it kind of depends the",
    "start": "2258200",
    "end": "2265280"
  },
  {
    "text": "exchange stuff we've seen if you have a mabox on Exchange your own period um no there is I see where you're going uh you",
    "start": "2265280",
    "end": "2272200"
  },
  {
    "text": "asking me are every user about able to to RDP and no it's not the case Okay so",
    "start": "2272200",
    "end": "2279079"
  },
  {
    "text": "thank you right agreed one more can you put that mitigation slide back up real quick and",
    "start": "2279079",
    "end": "2285480"
  },
  {
    "text": "then what what was that dll again that you were speaking of I don't think it's on",
    "start": "2285480",
    "end": "2290920"
  },
  {
    "text": "that slide but okay it's in more white paper anyway uh which you you you should have access",
    "start": "2290920",
    "end": "2297440"
  },
  {
    "text": "to but the uh the dll is called inet C",
    "start": "2297440",
    "end": "2304240"
  },
  {
    "text": "plc. and it's under uh C Windows",
    "start": "2304240",
    "end": "2310240"
  },
  {
    "text": "directory there we go okay any other questions",
    "start": "2312800",
    "end": "2322319"
  },
  {
    "text": "[Music] yep in your initial Repro there where",
    "start": "2327700",
    "end": "2332920"
  },
  {
    "text": "you were using iie with an image tag were you then redirecting HTTP to an SMB URL or how are you getting it to do an",
    "start": "2332920",
    "end": "2338640"
  },
  {
    "text": "smv connection uh the image tag automatically sends an smv connection",
    "start": "2338640",
    "end": "2343960"
  },
  {
    "text": "that's it we don't do any redirect nothing oh okay you put an image tag it doesb was it HTTP URL uh yes",
    "start": "2343960",
    "end": "2353318"
  },
  {
    "text": "okay good question thank you any other questions have one I have",
    "start": "2354000",
    "end": "2361119"
  },
  {
    "text": "one I have one yeah yeah Tim yeah so is it your",
    "start": "2361119",
    "end": "2366359"
  },
  {
    "text": "understanding from communication with Microsoft that if that D was implemented",
    "start": "2366359",
    "end": "2371520"
  },
  {
    "text": "correctly it would be paying attention to the registry flags and not doing SMB off or is that something that Microsoft",
    "start": "2371520",
    "end": "2377720"
  },
  {
    "text": "says as intended functionality I don't work for Microsoft I don't know you you might need to to to add them like oh",
    "start": "2377720",
    "end": "2384560"
  },
  {
    "text": "they want to patch this and what what is the deal have they acknowledged that that is a flaw in that dll they have",
    "start": "2384560",
    "end": "2392240"
  },
  {
    "text": "acknowledged there is a problem they are investigating and they are for 9 month",
    "start": "2392240",
    "end": "2399319"
  },
  {
    "text": "one more question",
    "start": "2401960",
    "end": "2404880"
  },
  {
    "text": "yeah so you're talking about the very first demo where we actually pushing malware yeah you need to be able to uh",
    "start": "2418520",
    "end": "2425000"
  },
  {
    "text": "connect back to SMB that the problem we we we discussed right so either it's exposed straight away on the",
    "start": "2425000",
    "end": "2431240"
  },
  {
    "text": "internet uh and it has a public IP and no firewall and and you're basically",
    "start": "2431240",
    "end": "2436400"
  },
  {
    "text": "connecting uh otherwise like yeah you cannot P mware that way uh and if you",
    "start": "2436400",
    "end": "2442520"
  },
  {
    "text": "have packet signing you cannot push malware anyway um uh but that's why we have this enhancement which is basically",
    "start": "2442520",
    "end": "2449280"
  },
  {
    "text": "relaying over um SMB of HTTP and then there is zero mitigation um also I'd like to point out",
    "start": "2449280",
    "end": "2456160"
  },
  {
    "text": "that SMB allows you to up Lo files and execute them as services so",
    "start": "2456160",
    "end": "2463520"
  },
  {
    "text": "yeah any other question yeah uh have you checked anything on Windows phones or",
    "start": "2464319",
    "end": "2470880"
  },
  {
    "text": "tablets we I actually have you yeah it doesn't work on that okay it doesn't work uh SMB is not a protocol supported",
    "start": "2470880",
    "end": "2477040"
  },
  {
    "text": "by Windows phones apparently as far as I know just say excellent",
    "start": "2477040",
    "end": "2483599"
  },
  {
    "text": "question one more question we set for today h one more",
    "start": "2483599",
    "end": "2491599"
  },
  {
    "text": "yeah I don't assume so not really um wait I haven't tested but I I mean in",
    "start": "2493040",
    "end": "2500000"
  },
  {
    "text": "terms of doing the HTTP connection for sure no like the connection happens via",
    "start": "2500000",
    "end": "2505040"
  },
  {
    "text": "the proxy uh then what happens when the proxy is trying to um resolve the uh SMB",
    "start": "2505040",
    "end": "2512400"
  },
  {
    "text": "share that is that is the the real question I don't know I don't I wouldn't assume that uh HTTP proxy settings apply",
    "start": "2512400",
    "end": "2520160"
  },
  {
    "text": "to other protocols but it's worth checking um I'd like to answer like add",
    "start": "2520160",
    "end": "2527680"
  },
  {
    "text": "more to that basically your proxy is going to replay most proxies do that they kind of have either set credentials",
    "start": "2527680",
    "end": "2533440"
  },
  {
    "text": "so they have they replay the same credentials over because ntlm works on the uh basically it authorizes your TCP",
    "start": "2533440",
    "end": "2539200"
  },
  {
    "text": "stream it doesn't authorize like that one particular request only so it has it cannot it it so ntlm ends at the proxy",
    "start": "2539200",
    "end": "2545280"
  },
  {
    "text": "and then proxy creates another ntlm um authentication to whatever it's trying to",
    "start": "2545280",
    "end": "2551160"
  },
  {
    "text": "get no more questions one more if you run SMB",
    "start": "2551359",
    "end": "2557440"
  },
  {
    "text": "signing does it works then sorry so we discussed SMB signing uh tremendously",
    "start": "2557440",
    "end": "2564079"
  },
  {
    "text": "right I yes I missed it a bit earlier I did you get a question I can't",
    "start": "2564079",
    "end": "2570079"
  },
  {
    "text": "hear you H then it's was nothing it's okay I ask if it works with SMB in",
    "start": "2570079",
    "end": "2577520"
  },
  {
    "text": "because I didn't see it before uh was a bit late um yeah it does the malware",
    "start": "2577520",
    "end": "2583200"
  },
  {
    "text": "upload doesn't work with smv signing but you can still download exchange",
    "start": "2583200",
    "end": "2588000"
  },
  {
    "text": "mailboxes any more question okay I guess we're good for today thank you very much for your",
    "start": "2590720",
    "end": "2596680"
  },
  {
    "text": "attention [Applause]",
    "start": "2596680",
    "end": "2603949"
  }
]