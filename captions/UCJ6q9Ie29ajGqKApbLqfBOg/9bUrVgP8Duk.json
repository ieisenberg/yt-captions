[
  {
    "start": "0",
    "end": "192000"
  },
  {
    "text": "good afternoon welcome to fantastic Red Team attacks and how to find them in",
    "start": "0",
    "end": "6000"
  },
  {
    "text": "South Seas a B e with Casey Smith and Ross wolf before we begin and as people",
    "start": "6000",
    "end": "13380"
  },
  {
    "text": "are sitting down I'll give you a few brief announcements make sure you stop by the business hall in Mandalay Bay",
    "start": "13380",
    "end": "19320"
  },
  {
    "text": "Oceanside and shoreline ballrooms on level two the blackhat arsenal is also",
    "start": "19320",
    "end": "24660"
  },
  {
    "text": "in the business hall on level two don't forget the merchandise store on level two and the session recordings",
    "start": "24660",
    "end": "31410"
  },
  {
    "text": "from source of knowledge they have a desk on every level please and thank you for putting your phone on",
    "start": "31410",
    "end": "39000"
  },
  {
    "text": "vibrate it makes us easier for the rest of us to ignore the ringing while we wait for your voicemail to pick it up let's give",
    "start": "39000",
    "end": "46559"
  },
  {
    "text": "it up for Ross and Casey [Applause]",
    "start": "46559",
    "end": "53500"
  },
  {
    "text": "good afternoon thanks for coming out to our talk a couple of things that we want to talk about here is take a question",
    "start": "55880",
    "end": "62510"
  },
  {
    "text": "based approach so some of the questions we want to address today are are the tools and methodology that you use today",
    "start": "62510",
    "end": "68270"
  },
  {
    "text": "working how would you know and can you detect attacks that are known and also",
    "start": "68270",
    "end": "74270"
  },
  {
    "text": "can you attack detect attacks that are unknown and so we're gonna be sharing some free and open source tools that you",
    "start": "74270",
    "end": "80210"
  },
  {
    "text": "could use help answer the questions that you're interested in your environment so my name is Casey Smith I'm the director",
    "start": "80210",
    "end": "87350"
  },
  {
    "text": "of Applied Research at red Canary you can connect with me on Twitter at subti I also worked on the atomic red team",
    "start": "87350",
    "end": "92540"
  },
  {
    "text": "project we'll be talking about today and I'm Ross wolf I'm a researcher end-game I created our event query language we're",
    "start": "92540",
    "end": "98030"
  },
  {
    "text": "going to talk about today as well have a lot of our detection x' and our detection system and i'm on twitter as",
    "start": "98030",
    "end": "103910"
  },
  {
    "text": "well RW underscore access so real quick so you have an agenda we're gonna be",
    "start": "103910",
    "end": "109009"
  },
  {
    "text": "talking about really four major themes during this talk we're gonna share a little bit about atomic red team what it is how we see defenders using atomic red",
    "start": "109009",
    "end": "115759"
  },
  {
    "text": "team then we're going to take a deep dive into the event query language or equal and we're going to look at the",
    "start": "115759",
    "end": "120920"
  },
  {
    "text": "syntax structure and how to build queries to search through in point data and then we're gonna go through an exercise which is red vs. blue that ross",
    "start": "120920",
    "end": "127729"
  },
  {
    "text": "and i created in order to test some of these theories we had and we're gonna be we're showcasing a attack that based on",
    "start": "127729",
    "end": "135019"
  },
  {
    "text": "our research hasn't been seen before but we were able to work through that data set and locate it so and then we'll come",
    "start": "135019",
    "end": "140810"
  },
  {
    "text": "to some conclusions about what we learned along the way so we've put a couple of links for follow up after the talk so one of the reasons we're here is",
    "start": "140810",
    "end": "148730"
  },
  {
    "text": "defenders want to know that their tools and their methodology is working and the question we have is well how do you know",
    "start": "148730",
    "end": "154280"
  },
  {
    "text": "unless you actually test and observe outcomes so how are you actually testing your defenses and a lot of defenders",
    "start": "154280",
    "end": "162200"
  },
  {
    "text": "don't know necessarily how to start testing or they may not be testing well so one of the things we're gonna dive in",
    "start": "162200",
    "end": "168380"
  },
  {
    "text": "today is when we start looking at behavior based detection that takes a different different way to exercise or",
    "start": "168380",
    "end": "174080"
  },
  {
    "text": "creates a lemon tree to make sure your detection czar working and so one of the reasons we created atomic Red Team was",
    "start": "174080",
    "end": "179780"
  },
  {
    "text": "help teams have at least a tool that they could use to begin understanding or test some of their detections",
    "start": "179780",
    "end": "187530"
  },
  {
    "text": "some of you may have heard of atomic red team for those of you haven't it is a free open-source project for testing",
    "start": "187530",
    "end": "194020"
  },
  {
    "start": "192000",
    "end": "192000"
  },
  {
    "text": "security controls it's really primarily focused on the endpoint so we're able to",
    "start": "194020",
    "end": "199030"
  },
  {
    "text": "exercise various tasks all of the tests that we've written are based in yamo we",
    "start": "199030",
    "end": "205360"
  },
  {
    "text": "have source code in binaries that back that up all of its map to mitre attack so that if you want to look at a",
    "start": "205360",
    "end": "211750"
  },
  {
    "text": "particular mitre attack ID you could go find the source code that backs up that particular test and as a shout-out to",
    "start": "211750",
    "end": "217660"
  },
  {
    "text": "Chris Gates he helped us as team started using atomic in an automated way Yama was a good way to describe test many of",
    "start": "217660",
    "end": "225070"
  },
  {
    "text": "the tests in atomic Red Team are single command line or minimal dependencies to set up a binary a command line a local",
    "start": "225070",
    "end": "233200"
  },
  {
    "text": "or remote script and so that's very helpful for small security teams up to larger teams that may be consuming or",
    "start": "233200",
    "end": "239500"
  },
  {
    "text": "taking a dependency on using atomic read team one of the reasons we created it was to demystify attacks so by providing",
    "start": "239500",
    "end": "246730"
  },
  {
    "text": "code and example so if you read about a particular attack on mitre miters taxonomy which is a really great",
    "start": "246730",
    "end": "252370"
  },
  {
    "text": "repository but you don't want to know that details like what API is calls are made or what files are written to disk",
    "start": "252370",
    "end": "258579"
  },
  {
    "text": "or what file structure is reference this helps you as a defender draw your own conclusions about observation and",
    "start": "258580",
    "end": "264880"
  },
  {
    "text": "detection and and and of course I just wanted mention this well we use the term atomic we're thinking in terms of",
    "start": "264880",
    "end": "270400"
  },
  {
    "text": "discrete or small components we're not we're not replacing a human red team that can do adversary emulation and",
    "start": "270400",
    "end": "277210"
  },
  {
    "text": "adaptation and so we still see tremendous value that will come out in this talk today we use that particular term just to say this is one way you can",
    "start": "277210",
    "end": "284320"
  },
  {
    "text": "begin exercising some tests and generating telemetry what does an atomic",
    "start": "284320",
    "end": "289750"
  },
  {
    "start": "288000",
    "end": "288000"
  },
  {
    "text": "test look like well this is an example of the ML structure and we can see here we're referencing miter a technique t11",
    "start": "289750",
    "end": "297130"
  },
  {
    "text": "1/8 which is a whitelisting bypass called install util and we can see we have some data that surrounds that",
    "start": "297130",
    "end": "303730"
  },
  {
    "text": "particular test that can describe with descriptions or references ultimately though we have what command do you need",
    "start": "303730",
    "end": "310150"
  },
  {
    "text": "to execute to exercise this test so in this test install util we'll load a dotnet assembly it will find the help",
    "start": "310150",
    "end": "317680"
  },
  {
    "text": "text method and execute that so a number of adversaries have used this we'll talk about in a moment",
    "start": "317680",
    "end": "322710"
  },
  {
    "text": "and you could change some of the filename properties so here you see we have a file name and it is replaced in",
    "start": "322710",
    "end": "328710"
  },
  {
    "text": "the command line so you can customize these as you need to those are arbitrary it's up to you to use one of the",
    "start": "328710",
    "end": "336389"
  },
  {
    "start": "336000",
    "end": "336000"
  },
  {
    "text": "benefits of actually describing tasks and yeah Mille for automation is it actually helps you chain tests together or put sequences of tests",
    "start": "336389",
    "end": "343139"
  },
  {
    "text": "together we like to call them chain reactions but essentially we can take a sequence of tests and we can then put",
    "start": "343139",
    "end": "349860"
  },
  {
    "text": "them in an array and then call this is an example of our power shell function and we can call get it get the technique",
    "start": "349860",
    "end": "354900"
  },
  {
    "text": "and then invoke the technique and so a majority of our tests are benign in terms of the they may just pop calc or",
    "start": "354900",
    "end": "361699"
  },
  {
    "text": "write a file to disk but you can customize those to be as aggressive as you may need for your testing what are",
    "start": "361699",
    "end": "370620"
  },
  {
    "text": "some of the observations that we've learned from teams that may be using atomic read to so one of the use cases for atomic is team is one of validate",
    "start": "370620",
    "end": "378449"
  },
  {
    "text": "collection did collection of their telemetry and detection logic so we've seen for example teams identified miss",
    "start": "378449",
    "end": "384030"
  },
  {
    "text": "configuration because they run a test and they were expecting their you know analysis engine to analyze the command",
    "start": "384030",
    "end": "390150"
  },
  {
    "text": "line and it never got there there was a miss configuration on the network or on the endpoint so it can help drive or",
    "start": "390150",
    "end": "395580"
  },
  {
    "text": "identify gaps in that respect it can also help you understand what data sources you have so if you're expecting",
    "start": "395580",
    "end": "400830"
  },
  {
    "text": "to understand process relationships go ahead and let's test that if you're expecting an adversary to break process",
    "start": "400830",
    "end": "406860"
  },
  {
    "text": "relationships a parent child you can also exercise that as well helps you understand your environment a lot of the",
    "start": "406860",
    "end": "413130"
  },
  {
    "text": "tools that we'll talk about in a moment are built-in tools to the operating system and so helping you understand how our normal tool is used and how it could",
    "start": "413130",
    "end": "419820"
  },
  {
    "text": "they be abused by an adversary and then lastly some people just want to know do I have coverage for this particular",
    "start": "419820",
    "end": "425520"
  },
  {
    "text": "technique that I saw or read about so some of the frequently mess mitre attack",
    "start": "425520",
    "end": "432000"
  },
  {
    "start": "429000",
    "end": "429000"
  },
  {
    "text": "techniques that we've observed are things that are related to native OS tools and so you have a few of them here",
    "start": "432000",
    "end": "438330"
  },
  {
    "text": "I'm gonna call out we're gonna really focus in this talk on two of them but just to go through a few that we've seen teams that missed these so masquerading",
    "start": "438330",
    "end": "444960"
  },
  {
    "text": "is a common one so you may not be familiar with that particular ID but a masquerading attack would be like",
    "start": "444960",
    "end": "451080"
  },
  {
    "text": "just renaming a binary or copying it to a location that's writable by the attacker so that's that's a commonly",
    "start": "451080",
    "end": "457500"
  },
  {
    "text": "missed test the windows management instrumentation there's another area that has about some gaps of visibility",
    "start": "457500",
    "end": "464750"
  },
  {
    "text": "process injection these are really just things that we've observed talking to teams that are using the tool and",
    "start": "464750",
    "end": "469860"
  },
  {
    "text": "providing us feedback one that we'll talk about today in depth a little bit more is install util and we'll also take",
    "start": "469860",
    "end": "476879"
  },
  {
    "text": "a deep dive into some trusted developer tools because these are often signed by legitimate companies but they have",
    "start": "476879",
    "end": "482159"
  },
  {
    "text": "really powerful capabilities built into them MSHDA script hosts and you know",
    "start": "482159",
    "end": "488550"
  },
  {
    "text": "we're on arbitrary you know VB script a script still being missed by a lot of teams and then of course XSL script",
    "start": "488550",
    "end": "494849"
  },
  {
    "text": "processing so if you haven't heard of this is would be using sort of non-standard things that can run style",
    "start": "494849",
    "end": "501000"
  },
  {
    "text": "sheet scripting so things like women and format tables and things like that",
    "start": "501000",
    "end": "506029"
  },
  {
    "text": "okay so why do we do these tests well primarily because these tests are then",
    "start": "506029",
    "end": "512578"
  },
  {
    "start": "510000",
    "end": "510000"
  },
  {
    "text": "seen in actual incidents so I put two references here for you to look at and the first one is a reference of an",
    "start": "512579",
    "end": "519268"
  },
  {
    "text": "adversary using install util and the second one is a reference to attackers using msbuild so both of those for",
    "start": "519269",
    "end": "525930"
  },
  {
    "text": "example in the window space will ship by default the operating system adversaries can use those if you're operating in a",
    "start": "525930",
    "end": "531690"
  },
  {
    "text": "constrained and whitelisting environment because they're already there they may already be trusted so that's why we'd like to run these",
    "start": "531690",
    "end": "536940"
  },
  {
    "text": "tests so you can be prepared for the actual incidents so ultimately the",
    "start": "536940",
    "end": "542430"
  },
  {
    "start": "540000",
    "end": "540000"
  },
  {
    "text": "atomic red team is could you know may help organizations prepare by running small benign examples and letting teams",
    "start": "542430",
    "end": "547680"
  },
  {
    "text": "test practice iterate their response the coverage and hunting what the reality is",
    "start": "547680",
    "end": "552959"
  },
  {
    "text": "all of these things that we've talked about so far they're really known so an attacker may decide to do something that",
    "start": "552959",
    "end": "558870"
  },
  {
    "text": "is not in the miter attack matrix and they're not something that has been seen before so we wanted to explore the",
    "start": "558870",
    "end": "564360"
  },
  {
    "text": "question of how would you want to see if you could find something unknown so I ended to Ross yeah so looking for those",
    "start": "564360",
    "end": "572490"
  },
  {
    "text": "known known threats if you will like the own atomic tests that we have aren't as bad once you understand and once you can",
    "start": "572490",
    "end": "579029"
  },
  {
    "text": "detonate and look at the data they generate but like if you want to find those known unknowns like",
    "start": "579029",
    "end": "584269"
  },
  {
    "text": "if you know there's gonna be an adversary how can you still find it what do we still know in general and they're",
    "start": "584269",
    "end": "589730"
  },
  {
    "text": "still like that mo right the there's going to be privilege escalation in a",
    "start": "589730",
    "end": "595309"
  },
  {
    "text": "lot of our movement and we can focus on those higher-level behaviors select behaviors I mean like the things that",
    "start": "595309",
    "end": "601100"
  },
  {
    "text": "they're doing to accomplish their goal they'd be in like adversary and the",
    "start": "601100",
    "end": "606910"
  },
  {
    "text": "focus we can intake instead of on tools is we can focus on events right so",
    "start": "606910",
    "end": "612410"
  },
  {
    "text": "events logging like state changes and things happening so if those behaviors are more complex and spend multiple",
    "start": "612410",
    "end": "617689"
  },
  {
    "text": "events um what if we could change them together and see oh there's a state change something happened here that was",
    "start": "617689",
    "end": "622819"
  },
  {
    "text": "new that's that might tip our hand to finding an adversary and I'm gonna go through some eql to answers and to ask",
    "start": "622819",
    "end": "630589"
  },
  {
    "text": "and answer some of those behavioral questions so eql is a language we released it's free it's open source it's",
    "start": "630589",
    "end": "637699"
  },
  {
    "start": "632000",
    "end": "632000"
  },
  {
    "text": "supposed to be really easy and intuitive and simple to use at least I'd like to think and but also complete enough to",
    "start": "637699",
    "end": "645920"
  },
  {
    "text": "ask to answer those complex questions looking for things happening in a certain sequence or even tracking like",
    "start": "645920",
    "end": "651379"
  },
  {
    "text": "process ancestry it natively supports like process lineage like I could ask",
    "start": "651379",
    "end": "657559"
  },
  {
    "text": "like oh is this a descendant of that and that's supported like right out of the box you don't have to do multiple queries a row and also looking for",
    "start": "657559",
    "end": "665689"
  },
  {
    "text": "sequences of events happening but but we often need to sort through a tremendous",
    "start": "665689",
    "end": "671449"
  },
  {
    "text": "amount of data when you're talking millions and billions events and they're trying to get to like a couple hundred you need some way of looking for the",
    "start": "671449",
    "end": "679459"
  },
  {
    "text": "outliers and so we have pipes for that and it's more than just like this language and spec if you want to start",
    "start": "679459",
    "end": "685369"
  },
  {
    "text": "using it we'll get into later like how you can use it yourself but there is this dynamic shell you can load up your",
    "start": "685369",
    "end": "691100"
  },
  {
    "text": "own data play around with it so it's also a tool not just the language um so what's it look like at the most basic",
    "start": "691100",
    "end": "697040"
  },
  {
    "start": "695000",
    "end": "695000"
  },
  {
    "text": "level you can look for a single event and that's some event type where some condition is true that's simple it looks",
    "start": "697040",
    "end": "702740"
  },
  {
    "text": "kind of like Python as far as those operators ago like the and or not lower case equal signs and you can compare",
    "start": "702740",
    "end": "709519"
  },
  {
    "text": "strings you can use wildcards as well one query example might look like this so maybe I'm looking for a weird SVC",
    "start": "709519",
    "end": "716360"
  },
  {
    "text": "host I know SVC house normally has a - cake and it comes from services and so I could express that in",
    "start": "716360",
    "end": "722860"
  },
  {
    "text": "EQ all this way here's a process that looks like this and has these fields matching so I can take that simple",
    "start": "722860",
    "end": "730690"
  },
  {
    "text": "component that event query I can actually stack them together into a sequence so I can look for multiple events in a row that look a certain way",
    "start": "730690",
    "end": "736210"
  },
  {
    "start": "732000",
    "end": "732000"
  },
  {
    "text": "and so that kind of follows this template we've got a sequence over some time span if that's relevant and then",
    "start": "736210",
    "end": "742870"
  },
  {
    "text": "between the brackets you've got that event query again so you have multiple events that look a certain way and you",
    "start": "742870",
    "end": "748000"
  },
  {
    "text": "can even say that have share properties in common so maybe you're looking for like privilege escalation what about a",
    "start": "748000",
    "end": "753520"
  },
  {
    "text": "file that was written by an on system user that ran a system later like that sounds like professed to me there's",
    "start": "753520",
    "end": "759820"
  },
  {
    "text": "potentially it could be adversarial it could just be software it's being installed this is how you could express",
    "start": "759820",
    "end": "765520"
  },
  {
    "text": "that in eql and you can note that the file path from the file event is matched against the process path processes so",
    "start": "765520",
    "end": "771490"
  },
  {
    "text": "you can do like those kind of sequel like joins in a way and speaking of there's also joint so sometimes you",
    "start": "771490",
    "end": "777820"
  },
  {
    "text": "don't always know the order things happen but you know that they're gonna exist and so you could say I'm just",
    "start": "777820",
    "end": "783010"
  },
  {
    "text": "looking for a pair of things or maybe five events that look a certain weight have things in common so this is that",
    "start": "783010",
    "end": "789880"
  },
  {
    "text": "career it looks similar to the sequence but a little simpler one example is looking for a file event that created",
    "start": "789880",
    "end": "795850"
  },
  {
    "text": "like a task and then a registry event creating a run once key so this would match only if both of those are met",
    "start": "795850",
    "end": "801930"
  },
  {
    "text": "another example of a join would be maybe looking for like lateral movement between two hosts right so the source IP",
    "start": "801930",
    "end": "807670"
  },
  {
    "text": "and the desk type P matching and then seeing those ports for RDP RPC in SMB which are those common windows built-in",
    "start": "807670",
    "end": "813940"
  },
  {
    "text": "protocols for lateral movement we can also do stateful and really complex",
    "start": "813940",
    "end": "819910"
  },
  {
    "text": "questions really easily and we using process lineage so I could say maybe I",
    "start": "819910",
    "end": "826060"
  },
  {
    "text": "wanna look for a spearfishing document that came from office came from word",
    "start": "826060",
    "end": "831460"
  },
  {
    "text": "then it was a power stall that reached out and made an overt connection I could actually express that just like this so",
    "start": "831460",
    "end": "836620"
  },
  {
    "text": "it's a network event coming from PowerShell and it's a descendant of office and one of the final things we",
    "start": "836620",
    "end": "843100"
  },
  {
    "start": "842000",
    "end": "842000"
  },
  {
    "text": "can do is we can actually sort through the data to find outliers so there's a handful of pipes already there if you",
    "start": "843100",
    "end": "848260"
  },
  {
    "text": "wanted to you could even like fork the repo and extend them yourself want to add new chen allottee here's one example of",
    "start": "848260",
    "end": "854260"
  },
  {
    "text": "pipes one question i thought was what processes are unique for a specific user so my thought was well there's a lot",
    "start": "854260",
    "end": "861070"
  },
  {
    "text": "that are unique to systems let's just ignore that but for a particular user we could remove the duplicates and then",
    "start": "861070",
    "end": "867400"
  },
  {
    "text": "count how many are left and then you've got like a distinct account and you see how many are matched to exactly one user um so that's like a bit of some of the",
    "start": "867400",
    "end": "874810"
  },
  {
    "text": "features so now I'm gonna like to switch over to to a demo so here yes all right",
    "start": "874810",
    "end": "882400"
  },
  {
    "text": "so let's run equal so it's got this built-in shell and so this is gonna run I can type in help to see what's",
    "start": "882400",
    "end": "888640"
  },
  {
    "text": "available the first thing I want to do that was load that data set the case he gave me and so he just gave me this",
    "start": "888640",
    "end": "893710"
  },
  {
    "text": "fantastic a tax data set we'll talk about that in just a minute so right now it's loading that set looking at all the",
    "start": "893710",
    "end": "900400"
  },
  {
    "text": "events in there to figure out what the schema is right like what are the event types worth the fields what types are",
    "start": "900400",
    "end": "905650"
  },
  {
    "text": "the fields and so it loaded that up and now it knows oh I've got processed events and here the fields so as I start",
    "start": "905650",
    "end": "912460"
  },
  {
    "text": "typing a query it's actually Auto completing my queries and I can even like tap complete and syntax",
    "start": "912460",
    "end": "918250"
  },
  {
    "text": "highlighting so I mean I think it's fun so right now here's just like the hello",
    "start": "918250",
    "end": "923710"
  },
  {
    "text": "world query right look for a Who am I so we've got JSON output that's not super",
    "start": "923710",
    "end": "928750"
  },
  {
    "text": "friendly to read it's kind of actually hard so maybe I'd have better luck looking at a table of this so we could",
    "start": "928750",
    "end": "935110"
  },
  {
    "text": "pick the fields and those are again also Auto calculated and so we can see that",
    "start": "935110",
    "end": "940210"
  },
  {
    "text": "table okay that's a lot friendlier so now I can actually imagine how you'd have a workflow you're going through",
    "start": "940210",
    "end": "946020"
  },
  {
    "text": "running multiple queries in a row and seeing those results without needing to have to worry about like a back-end",
    "start": "946020",
    "end": "952120"
  },
  {
    "text": "maybe if you just have that JSON file you can go I can also just ask high-level questions of the data how",
    "start": "952120",
    "end": "958450"
  },
  {
    "text": "many events are there and there's 350,000 maybe once you break down by event type just to see where the high",
    "start": "958450",
    "end": "965530"
  },
  {
    "text": "volume is so right here there's a lot of image load events and file events",
    "start": "965530",
    "end": "971040"
  },
  {
    "text": "process events aren't even 2% of this data and I'm and that's actually something that I care about so we're",
    "start": "971040",
    "end": "977200"
  },
  {
    "text": "already gonna be focusing on those so if I go back from from this demo quick",
    "start": "977200",
    "end": "983290"
  },
  {
    "text": "I'm gonna pass this over to Casey and he can tell us more about what's in this data set how I built it yeah so what you",
    "start": "983290",
    "end": "988630"
  },
  {
    "text": "saw Ross was profiling a data set called fantastic red team's JSON and so what we wanted to do was an exercise to test",
    "start": "988630",
    "end": "995140"
  },
  {
    "text": "some of our theories like about giving give Ross a dataset that he had not seen before and see if he could use equal to",
    "start": "995140",
    "end": "1001740"
  },
  {
    "text": "uncover a novel threat that I introduced into that endpoint so what was going on on this workstation we kept it small in",
    "start": "1001740",
    "end": "1008580"
  },
  {
    "start": "1005000",
    "end": "1005000"
  },
  {
    "text": "terms to really focus on the power of the language but essentially we have an endpoint with system on installed with",
    "start": "1008580",
    "end": "1014250"
  },
  {
    "text": "Windows we feel like it's a very good way to start learning how to express endpoint telemetry relationships or",
    "start": "1014250",
    "end": "1020430"
  },
  {
    "text": "processes and other data types we wanted to introduce real background noise I let this run for a while and installed",
    "start": "1020430",
    "end": "1026490"
  },
  {
    "text": "several tools on it and so that Ross would have to decide what was real what was false positive",
    "start": "1026490",
    "end": "1032250"
  },
  {
    "text": "so in this data said there are really four things there's normal user activity there were some specific atomic tests I",
    "start": "1032250",
    "end": "1040550"
  },
  {
    "text": "executed a real adversary emulation test and then I executed a test that to mine",
    "start": "1040550",
    "end": "1047010"
  },
  {
    "text": "are saying no one has seen before so the Red Team objective in this situation so the in point we're targeting was a",
    "start": "1047010",
    "end": "1053010"
  },
  {
    "text": "developer in point because they have a lot of neat tools and a lot of things that may be interesting for us to look at and so we wanted to the mission so to",
    "start": "1053010",
    "end": "1059940"
  },
  {
    "text": "speak for this Red Team exercise was to go find a way to attack that system in a unique and novel way and I wanted to",
    "start": "1059940",
    "end": "1066480"
  },
  {
    "text": "figure out could I actually find Casey could I find the red team so like there's the unknown attack there's a",
    "start": "1066480",
    "end": "1072540"
  },
  {
    "text": "known attack could I also find the false positives and while avoiding all of that normal noise so going into that like",
    "start": "1072540",
    "end": "1079950"
  },
  {
    "start": "1079000",
    "end": "1079000"
  },
  {
    "text": "what was the process that I had in general and the first thing is I need to get something to look at right so we",
    "start": "1079950",
    "end": "1085770"
  },
  {
    "text": "need to gather some initial set up suspicious activity if you have alerts you can go off of those but this was all",
    "start": "1085770",
    "end": "1091680"
  },
  {
    "text": "unknown data I didn't have anything to go off of and so I just said okay I'm not gonna cheat use any alerts so I want",
    "start": "1091680",
    "end": "1097920"
  },
  {
    "text": "to figure out how to hunt how can I use those behavioral questions to look for evidence of a compromise and while doing",
    "start": "1097920",
    "end": "1104070"
  },
  {
    "text": "that I need to refine my queries and try to reduce the data set till it's like a reasonable size like I need to be",
    "start": "1104070",
    "end": "1110040"
  },
  {
    "text": "looking at this in my eyes to make a decision so I can't do that for 350,000 events so we need",
    "start": "1110040",
    "end": "1116310"
  },
  {
    "text": "get that down to a reasonable size I also wanted triage as I see results this s are these good or bad and part of that",
    "start": "1116310",
    "end": "1122790"
  },
  {
    "text": "process also involves scoping like in this is this in a process tree that traces back to somewhere weird what",
    "start": "1122790",
    "end": "1128130"
  },
  {
    "text": "happened next did identify what all the adversaries or Casey did and so that",
    "start": "1128130",
    "end": "1133890"
  },
  {
    "text": "first step like if i'm gathering that suspicious activity what what's my approach what am i gonna do is so the",
    "start": "1133890",
    "end": "1139830"
  },
  {
    "text": "thought is like i'm thinking first like what does he adversary do and what can i do in response what can I look for so",
    "start": "1139830",
    "end": "1146250"
  },
  {
    "text": "like the first thing is like an attacker is probably going to need to survive reboots so they're gonna need to make it",
    "start": "1146250",
    "end": "1152670"
  },
  {
    "text": "persistence so I could look for new persistence locations but at the same time if I'm looking they're hiding right",
    "start": "1152670",
    "end": "1158730"
  },
  {
    "text": "so they're gonna try to hide from my defenses so are there potentially like unusual parent-child relationships like",
    "start": "1158730",
    "end": "1165360"
  },
  {
    "text": "they're using an SVC host to hide like that example earlier or were there other",
    "start": "1165360",
    "end": "1170550"
  },
  {
    "text": "attempts to blend in because they want me to think that things are normal and operating right but eventually if",
    "start": "1170550",
    "end": "1178740"
  },
  {
    "text": "there's any hands on keyboard is gonna need to be some call back at some point either whether that's DNS or network",
    "start": "1178740",
    "end": "1184830"
  },
  {
    "text": "traffic or something else and so I can ask like what processes started making",
    "start": "1184830",
    "end": "1190500"
  },
  {
    "text": "network connections maybe for the first time what's new or was there like outgoing lateral movement to a host and",
    "start": "1190500",
    "end": "1195750"
  },
  {
    "text": "so like those are some of the questions I'm thinking of in my head as to guide my approach for this so I'm kind of",
    "start": "1195750",
    "end": "1200880"
  },
  {
    "text": "using those adversary goals with things that are relevant to my environment and that's helped me avoid things that are",
    "start": "1200880",
    "end": "1207480"
  },
  {
    "text": "universally evil we're already contextualized and it saves Sue's us a lot of effort so the first thing I",
    "start": "1207480",
    "end": "1214170"
  },
  {
    "text": "thought was like okay knowing atomic read team a good bit like a lot of us using built-in windows tools",
    "start": "1214170",
    "end": "1220380"
  },
  {
    "text": "maybe some were renamed maybe he thought my command lines weren't that great or I was a little too brittle to overfit it",
    "start": "1220380",
    "end": "1226800"
  },
  {
    "text": "so maybe Casey renamed a tool so I used Nordic we're looking for the original",
    "start": "1226800",
    "end": "1232350"
  },
  {
    "text": "file name inside that PE header mismatching what's on disk and just for",
    "start": "1232350",
    "end": "1238110"
  },
  {
    "text": "a handful of known tools that have been renamed before and then just removed any duplicates because I don't need to see",
    "start": "1238110",
    "end": "1243930"
  },
  {
    "text": "every single time it runs so I try that I didn't find any results so I had to like back up again it's like okay well",
    "start": "1243930",
    "end": "1249390"
  },
  {
    "text": "nothing was renamed maybe something was actually used so maybe those no and binary it's like that it's all Utila MSHDA",
    "start": "1249390",
    "end": "1255500"
  },
  {
    "text": "maybe they made callbacks so I look for a sequence in equal to say give me the",
    "start": "1255500",
    "end": "1261260"
  },
  {
    "text": "process event for any of these known tools but also it had to make a network",
    "start": "1261260",
    "end": "1266480"
  },
  {
    "text": "event and by converting this to a sequence I have the command line and the destination IP at the same time that's kind of nice for for triaging so I had",
    "start": "1266480",
    "end": "1274100"
  },
  {
    "text": "actually had eight results and this is like the first page of results but before diving into that I'm going to",
    "start": "1274100",
    "end": "1279230"
  },
  {
    "text": "back up again so that what's our process for triaging then however my determining what's good what's bad some of those",
    "start": "1279230",
    "end": "1286279"
  },
  {
    "start": "1285000",
    "end": "1285000"
  },
  {
    "text": "questions they're like is the path formal is this looking like a Windows binary but maybe like but not quite like",
    "start": "1286279",
    "end": "1293750"
  },
  {
    "text": "L SAS with 3 s's I guess before or like was it signed if something signed by not",
    "start": "1293750",
    "end": "1301610"
  },
  {
    "text": "signed by Google up by Google but claiming to be Google update you should probably take a look or if it was a",
    "start": "1301610",
    "end": "1307669"
  },
  {
    "text": "legitimate product that's probably gonna tear my hand more towards like this is a false positive and if something's been",
    "start": "1307669",
    "end": "1313070"
  },
  {
    "text": "publicly reported you should always make that like that's an urgent it's kind of a no-brainer so coming back to those results I",
    "start": "1313070",
    "end": "1319370"
  },
  {
    "text": "actually saw a lot of atomic red team in there and so I was like okay I can assess this I we know that we did an",
    "start": "1319370",
    "end": "1324919"
  },
  {
    "text": "atomic test because in your environment you're probably knowing when you're doing your own testing so I can mark that that's good that's clean you know",
    "start": "1324919",
    "end": "1331909"
  },
  {
    "text": "there's the Amazon assistant thing at the top and I did some research it actually does use MSHDA under the hood",
    "start": "1331909",
    "end": "1337789"
  },
  {
    "text": "and make network connections so if you try to make a detection like this you're probably run to this F P as well so",
    "start": "1337789",
    "end": "1343429"
  },
  {
    "text": "we're still one left but there's still more results to get to as well so you see more atomic Red Team at the top I",
    "start": "1343429",
    "end": "1349730"
  },
  {
    "text": "was like okay we can whitelist that we kind of nobody Tom tested it matched up and then there's also some Microsoft's",
    "start": "1349730",
    "end": "1357019"
  },
  {
    "text": "and legit windows reaching out to things that it normally reaches out to me so I ruled that out so now I have a few results left we've already reduced that",
    "start": "1357019",
    "end": "1363230"
  },
  {
    "text": "said down to four things so now let's start pulling some threads I'm gonna pick that power show up first so for",
    "start": "1363230",
    "end": "1369889"
  },
  {
    "text": "that power saw command I'm wondering amid a network connection but what else to do so like were there any other",
    "start": "1369889",
    "end": "1375350"
  },
  {
    "start": "1374000",
    "end": "1374000"
  },
  {
    "text": "descendant processes from that PowerShell and so with equal I just said was there any descendant events any",
    "start": "1375350",
    "end": "1381380"
  },
  {
    "text": "processes from that PowerShell me the network connection and I actually have 43 results like okay since it's",
    "start": "1381380",
    "end": "1389600"
  },
  {
    "text": "gonna be fun so buckle up so here's some other results but thankfully their atomic red team as you can see I've",
    "start": "1389600",
    "end": "1395809"
  },
  {
    "text": "bolded it in this event this validates backed like was this our actual testing yes and we can go through like the full",
    "start": "1395809",
    "end": "1401540"
  },
  {
    "text": "page all of this was atomic testing so I'm at this point you can say like the power",
    "start": "1401540",
    "end": "1406670"
  },
  {
    "text": "sub process is atomic so we can rule that out but there's still the next thing I left this invoke mimikatz maybe",
    "start": "1406670",
    "end": "1412790"
  },
  {
    "text": "I probably should have started there so let's look at that and see what's going on here and it reads straight out to",
    "start": "1412790",
    "end": "1417860"
  },
  {
    "text": "github IX it's like this looks totally fine so where'd this come from what",
    "start": "1417860",
    "end": "1423559"
  },
  {
    "text": "loaded this powerful process who caused this to execute so I usually equal C sequence to say give me a process event",
    "start": "1423559",
    "end": "1431360"
  },
  {
    "text": "take it spit and match that to the peep it of the Power Cell processor random ocarina cats",
    "start": "1431360",
    "end": "1436610"
  },
  {
    "text": "so I ran that I got one result so that one results the pair right we have the parent plus a child and this is what it",
    "start": "1436610",
    "end": "1442550"
  },
  {
    "text": "was the parent was of course atomic read TV it can be really loud if you have like good detection to place okay so",
    "start": "1442550",
    "end": "1450260"
  },
  {
    "text": "that's good we can rule that out there's still one left this install util coming from Explorer",
    "start": "1450260",
    "end": "1455720"
  },
  {
    "text": "which itself is kind of odd and then making a network connection like how do you get that command line coming from",
    "start": "1455720",
    "end": "1461450"
  },
  {
    "text": "Explorer something that I'm also wondering so what is that but then Casey",
    "start": "1461450",
    "end": "1467210"
  },
  {
    "text": "said earlier there was like some adversary emulation and this is a known technique so this is that adversary",
    "start": "1467210",
    "end": "1472460"
  },
  {
    "text": "emulation so this is known Red Team behavior so moving on I was like okay fine a lot of PowerShell",
    "start": "1472460",
    "end": "1477679"
  },
  {
    "text": "what other PowerShell commands were there so it's like what PowerShell commands were run with any arguments",
    "start": "1477679",
    "end": "1483710"
  },
  {
    "text": "like at least one argument besides that PowerShell so I just did like star space star like there's a",
    "start": "1483710",
    "end": "1489350"
  },
  {
    "text": "space somewhere in there so there's arguments and just like remove the duplicates and tell me how many see per",
    "start": "1489350",
    "end": "1494960"
  },
  {
    "text": "command line so I actually found three unique results that way once again we",
    "start": "1494960",
    "end": "1500300"
  },
  {
    "text": "look to see atomic Red Team all over so like okay cool this is great we have visibility into atomic Red Team but I",
    "start": "1500300",
    "end": "1506870"
  },
  {
    "text": "didn't find anything so I'm still trying to figure out what's going on I was like okay maybe I can bring back that question earlier maybe Casey's new novel",
    "start": "1506870",
    "end": "1514130"
  },
  {
    "text": "technique is pros escalation so maybe drop the file did some crazy not magic",
    "start": "1514130",
    "end": "1522090"
  },
  {
    "text": "to get it to run a system so we can take that example earlier from our sequence and look for a file event created by non",
    "start": "1522090",
    "end": "1528630"
  },
  {
    "text": "system user but then ran a system but that's not work either so there could be",
    "start": "1528630",
    "end": "1533850"
  },
  {
    "text": "a pro best technique but this didn't find it maybe though maybe there's still",
    "start": "1533850",
    "end": "1539900"
  },
  {
    "text": "some new type of situ so maybe some process reached out made a network connection for the first time oh that's",
    "start": "1539900",
    "end": "1546480"
  },
  {
    "text": "a new processor old I don't know and so I was like just for every network connection tell me the 15 most recent",
    "start": "1546480",
    "end": "1554130"
  },
  {
    "text": "ones to make their first network and of course that returned 15 results so",
    "start": "1554130",
    "end": "1560370"
  },
  {
    "text": "there's a lot here but I'll save you the pain a lot of these from Microsoft and Visual Studio and all that checked out",
    "start": "1560370",
    "end": "1566550"
  },
  {
    "text": "so there's still a few left I looked at another page of results the remaining seven or eight and that's more Visual",
    "start": "1566550",
    "end": "1572850"
  },
  {
    "text": "Studio and its Visual Studio reaching out to Microsoft servers that have like",
    "start": "1572850",
    "end": "1578010"
  },
  {
    "text": "Microsoft cert since like ok this is Microsoft doing Microsoft things it's like we could go down that rabbit hole but if there's something else here I'm",
    "start": "1578010",
    "end": "1584700"
  },
  {
    "text": "just wasting my time stick ok this is Visual Studio so we still just a few",
    "start": "1584700",
    "end": "1590190"
  },
  {
    "text": "results left but that install util we already saw earlier we said that was probably that adversary emulation Red",
    "start": "1590190",
    "end": "1595560"
  },
  {
    "text": "Team so now I'm wondering what's this debug serve and you know notepad making",
    "start": "1595560",
    "end": "1600600"
  },
  {
    "text": "a network connection I don't think that's normal functionality I think there's a something going on here so I'm",
    "start": "1600600",
    "end": "1606210"
  },
  {
    "text": "trying to figure out where did this notepad come from and what the hell is going on so wise notepad making network",
    "start": "1606210",
    "end": "1614550"
  },
  {
    "start": "1611000",
    "end": "1611000"
  },
  {
    "text": "connection so I wrote an equal query looking for notepad making a process event and then your network connection",
    "start": "1614550",
    "end": "1620190"
  },
  {
    "text": "so now I've got the command line the parent plus the destination port this is like everything I think I need but",
    "start": "1620190",
    "end": "1626520"
  },
  {
    "text": "actually found two results here so before it was unique to now we can see all of them and we see the parent",
    "start": "1626520",
    "end": "1631890"
  },
  {
    "text": "process path this debug serve I think we saw that a second ago so what else did",
    "start": "1631890",
    "end": "1638040"
  },
  {
    "text": "this debug serve do or dbg survey I don't know what some folks are yet what else did it do so I used an equal",
    "start": "1638040",
    "end": "1645960"
  },
  {
    "text": "query we can actually search multiple that types at once so if use like any event type we'll search anything and then there's a",
    "start": "1645960",
    "end": "1651810"
  },
  {
    "text": "field called a vet type so I can say anywhere event type is a process network bot registry and the process name was",
    "start": "1651810",
    "end": "1657270"
  },
  {
    "text": "debug serve and then I don't really all just get the first one for each and so I unique them so there's seven results",
    "start": "1657270",
    "end": "1663620"
  },
  {
    "text": "there's a handful of different pits here so this happened multiple times as I looked at the first one I see the",
    "start": "1663620",
    "end": "1668880"
  },
  {
    "text": "command line actually matches with the network connection so okay there's network traffic and it lines up with",
    "start": "1668880",
    "end": "1675330"
  },
  {
    "text": "that but it came from Explorer again how does how does Explorer have this full command line is that a shortcut is it",
    "start": "1675330",
    "end": "1681450"
  },
  {
    "text": "Thomas is something else going on but then at the bottom we see this remote",
    "start": "1681450",
    "end": "1686640"
  },
  {
    "text": "debug msdnaa comm happened twice no network but then eventually it did make",
    "start": "1686640",
    "end": "1693030"
  },
  {
    "text": "a network connection back to the same IP so at this point I'm like what's going on why is this reaching out to port 22",
    "start": "1693030",
    "end": "1699510"
  },
  {
    "text": "why is notepad a child process why is this making a network connection just what's going I think I found the new",
    "start": "1699510",
    "end": "1705090"
  },
  {
    "text": "technique but I don't know what I'm looking at so KC can you tell us yeah yeah so that was like as we went as we",
    "start": "1705090",
    "end": "1711360"
  },
  {
    "text": "worked through that data set that was an interesting thing so I want to talk a little bit about what debug serve is why",
    "start": "1711360",
    "end": "1716370"
  },
  {
    "text": "it would be interesting and really the story though it's not necessarily about the novelty of a new attack it's really about how we were able to find that with",
    "start": "1716370",
    "end": "1722010"
  },
  {
    "start": "1722000",
    "end": "1722000"
  },
  {
    "text": "equals so pretty interesting tool some of you may have heard of it before in my research though I haven't found anybody",
    "start": "1722010",
    "end": "1727530"
  },
  {
    "text": "using this in a malicious way but it could certainly be used this way on constraint system so functionally it",
    "start": "1727530",
    "end": "1733170"
  },
  {
    "text": "gives you the capability of a reverse TCP connection and then you're able to remotely debug a process and that's",
    "start": "1733170",
    "end": "1739290"
  },
  {
    "text": "functionally equivalent to like whitelist evasion and process hollowing did talk with MS RFC about this and",
    "start": "1739290",
    "end": "1744570"
  },
  {
    "text": "again this is a binary working as design it's not an exploit it's also not default but it's super interesting for",
    "start": "1744570",
    "end": "1750300"
  },
  {
    "text": "potentially an attacker targeting a developer system because it may already be there so I was trying to find a",
    "start": "1750300",
    "end": "1755850"
  },
  {
    "text": "debugger tool or some tool that was already installed on a developer system that he that it would be abused in a way",
    "start": "1755850",
    "end": "1762120"
  },
  {
    "start": "1756000",
    "end": "1756000"
  },
  {
    "text": "that he hasn't seen so I started looking at tools that were installed when I set up the data set like visual studio debugger tools and then I was reading",
    "start": "1762120",
    "end": "1769230"
  },
  {
    "text": "through MSD and really just went to the director had started asking myself what is each of these tools that's already on this dev system and how could I use it",
    "start": "1769230",
    "end": "1775590"
  },
  {
    "text": "to execute code really was the question and so you see two commands you see the server side in this situation I just",
    "start": "1775590",
    "end": "1781980"
  },
  {
    "text": "bought notepad testing the the theory here but you could also spawn you could attach to another process or you could attach to a",
    "start": "1781980",
    "end": "1789010"
  },
  {
    "text": "kid and you can see on the client side we can see where there's a connection made network connection made back using",
    "start": "1789010",
    "end": "1795280"
  },
  {
    "text": "the arbitrary port now you can use domain names etc so so how would an attacker actually abuse this so once",
    "start": "1795280",
    "end": "1800650"
  },
  {
    "text": "they get debug served to execute on the target now you can use a debugger a couple of debugger commands and this can",
    "start": "1800650",
    "end": "1807790"
  },
  {
    "text": "be automated I'll take you through it in a manual process but it's kind of interesting because once I get control for that system from a trusted signed",
    "start": "1807790",
    "end": "1814120"
  },
  {
    "text": "binary I can simply allocate a region in memory DV Alec I can then load my",
    "start": "1814120",
    "end": "1819670"
  },
  {
    "text": "shellcode to the address that I get back from DV Alec change the instruction pointer and execute the code so all",
    "start": "1819670",
    "end": "1825370"
  },
  {
    "text": "within the constraints of a V trusted process or a process that I've attached to remotely so let's take a look at a",
    "start": "1825370",
    "end": "1831370"
  },
  {
    "text": "demo of this again the the code here some of this is going to be manual copy",
    "start": "1831370",
    "end": "1836920"
  },
  {
    "text": "and paste really just for demonstration so that it's clear what I'm doing since we're setting up a server to",
    "start": "1836920",
    "end": "1844030"
  },
  {
    "text": "receive our shellcode callback so we'll go ahead and set up this box here there's really three systems in play the attacker Kali box and then we'll have",
    "start": "1844030",
    "end": "1851290"
  },
  {
    "text": "two systems the newt's box or the target essentially so here we're gonna see",
    "start": "1851290",
    "end": "1856450"
  },
  {
    "text": "we're gonna run debug serve here and we're going to then catch the callback you can see debug serve is not running",
    "start": "1856450",
    "end": "1863560"
  },
  {
    "text": "neither is notepad currently and here we are we're gonna receive the connection from new to developer workstation so got",
    "start": "1863560",
    "end": "1871150"
  },
  {
    "text": "our session running everything is confirmed now we're gonna go ahead and launch the attack so here I was trying to break I thought Ross might try and",
    "start": "1871150",
    "end": "1877240"
  },
  {
    "text": "hunt for weird process relationship so I was trying to change that I was using com object so actually ran this with a",
    "start": "1877240",
    "end": "1882550"
  },
  {
    "text": "script host and then I chained it up to Explorer instead of being chained up to see script or W script and that effect",
    "start": "1882550",
    "end": "1889150"
  },
  {
    "text": "you still found it but essentially we see debug server is now running and we see notepad running in pit 4380 so if",
    "start": "1889150",
    "end": "1895450"
  },
  {
    "text": "you've worked with debuggers before this is now on my attacker controlled system and i'm going to direct commands down",
    "start": "1895450",
    "end": "1901360"
  },
  {
    "text": "into the target so pretty interesting capability first we'll go ahead and break point in the process notepad we're",
    "start": "1901360",
    "end": "1906730"
  },
  {
    "text": "working on drop-in DV alec he gives us a read write execute region and then we'll go ahead and take the address we get",
    "start": "1906730",
    "end": "1912790"
  },
  {
    "text": "back like I said all of this can be fully automated I just wanted to clear about what what the commands were",
    "start": "1912790",
    "end": "1918289"
  },
  {
    "text": "doing so we're gonna load our shellcode remotely change the instruction pointer just like you would do in various",
    "start": "1918289",
    "end": "1923840"
  },
  {
    "text": "debugging capacities and then execute or call back so at this point now we've piped our shellcode down into notepad a",
    "start": "1923840",
    "end": "1930350"
  },
  {
    "text": "trusted process from deeper debug server also trusted there we see pid' 4380 just",
    "start": "1930350",
    "end": "1936110"
  },
  {
    "text": "to go back and confirm that our callback came in from that particular host we'll just go and look at our sessions and",
    "start": "1936110",
    "end": "1942350"
  },
  {
    "text": "confirm that the paid is where we thought we'd landed and from here you have a lot of options you could migrate",
    "start": "1942350",
    "end": "1947840"
  },
  {
    "text": "you could do different things so that was really the story there was you know find something that no one has seen",
    "start": "1947840",
    "end": "1953870"
  },
  {
    "text": "before and see if these detection methodologies and queries still lead you back to the trail so again really the",
    "start": "1953870",
    "end": "1961220"
  },
  {
    "text": "story here is not necessarily the the power of debug SAR being needed novel it's how could you find that using these",
    "start": "1961220",
    "end": "1968090"
  },
  {
    "text": "methodologies and query language that Ross just took us through so if you want a specific detection for debug serve you",
    "start": "1968090",
    "end": "1974659"
  },
  {
    "text": "can see we've got a sequence here where we're looking for things like any process with a named debug serve or original file name attackers might",
    "start": "1974659",
    "end": "1981230"
  },
  {
    "text": "choose to rename it outbound network connections and child processes or cross process communication",
    "start": "1981230",
    "end": "1986870"
  },
  {
    "text": "so but what roster goes through was pretty manual so if we if we're going to",
    "start": "1986870",
    "end": "1994159"
  },
  {
    "text": "do this at scale how would we actually find some of these things with larger data sets and a larger volume so I'll",
    "start": "1994159",
    "end": "2001000"
  },
  {
    "text": "let Ross take a little bit take us through like how you might find these at scale with equal I think's Casey so",
    "start": "2001000",
    "end": "2006700"
  },
  {
    "text": "we've got a lot of analytics just like that one that we've compiled together into a library so even library of analytics written in",
    "start": "2006700",
    "end": "2013269"
  },
  {
    "start": "2011000",
    "end": "2011000"
  },
  {
    "text": "eql and like that schema we saw earlier it wasn't totally anything it wasn't sis",
    "start": "2013269",
    "end": "2019929"
  },
  {
    "text": "mam so we've got our own schema there and you can normalize to it everything's mapped to attack as well so the cool",
    "start": "2019929",
    "end": "2026230"
  },
  {
    "text": "thing about that is like if let's say you're not using system on and you're using something else you just tell it oh",
    "start": "2026230",
    "end": "2031299"
  },
  {
    "text": "this field goes to there and it over in your career on their data set anyway and",
    "start": "2031299",
    "end": "2037480"
  },
  {
    "text": "so one example of an analytic in this library like that debug serve one this",
    "start": "2037480",
    "end": "2042610"
  },
  {
    "text": "is what that would look like this is a looking for debug serve remote debugger the technique here that's tagged within",
    "start": "2042610",
    "end": "2048960"
  },
  {
    "text": "is that trusted developer utilities and then on the right we can see there's the sequence there's that query that we ran so we've got all the sequence tied to",
    "start": "2048960",
    "end": "2055050"
  },
  {
    "text": "metadata and the cool thing about that is that we can actually take all of these and just run them at once like all",
    "start": "2055050",
    "end": "2060240"
  },
  {
    "text": "those things I asked earlier it's like let's just Rich's run like those types of queries and so I just ran a ton of them on on a data set and this is the",
    "start": "2060240",
    "end": "2067138"
  },
  {
    "text": "type of results you'll see but like earlier we'll still run into false",
    "start": "2067139",
    "end": "2072570"
  },
  {
    "text": "positives right so these aren't always finely tuned and some of those you have to tailor to your environment so we have",
    "start": "2072570",
    "end": "2079320"
  },
  {
    "text": "to get a good sense of how do you identify true and false positives so if you if you do want to take take any of",
    "start": "2079320",
    "end": "2085648"
  },
  {
    "start": "2081000",
    "end": "2081000"
  },
  {
    "text": "these lessons and turn them into like those highly actionable your positives you're probably want a good baseline of",
    "start": "2085649",
    "end": "2091440"
  },
  {
    "text": "your environment and you want to update that regularly like what sugar this detection before and how has that",
    "start": "2091440",
    "end": "2096990"
  },
  {
    "text": "changed since the last time so you're looking at those deltas understanding change and then also paying attention to",
    "start": "2096990",
    "end": "2102980"
  },
  {
    "text": "what shows up multiple times like we saw a debug server meaning network but also notepad like neither of them had ever",
    "start": "2102980",
    "end": "2108869"
  },
  {
    "text": "made a network connection before the debug serve process never ran before so if we had another one for the first time",
    "start": "2108869",
    "end": "2114750"
  },
  {
    "text": "it was run or dropped and executed then network like there's several things you could do to layer those detection",
    "start": "2114750",
    "end": "2120060"
  },
  {
    "text": "together to get like a more complete story and and by that I mean like does this does this feel like an adversary",
    "start": "2120060",
    "end": "2127440"
  },
  {
    "text": "does this look like oh it came from Outlook its injecting it's moving it's",
    "start": "2127440",
    "end": "2133530"
  },
  {
    "text": "okay at some point you gain confidence like this looks bad but there are some",
    "start": "2133530",
    "end": "2139109"
  },
  {
    "start": "2138000",
    "end": "2138000"
  },
  {
    "text": "things to avoid if you're trying to write your own detection and scale all this up is that like false positives are",
    "start": "2139109",
    "end": "2147559"
  },
  {
    "text": "everywhere like administrators background software especially things that are like in your gold image that's",
    "start": "2148099",
    "end": "2154440"
  },
  {
    "text": "gonna be on every machine so you probably should have a good way to unique them and to keep your ratio of false positives to true positives low",
    "start": "2154440",
    "end": "2162440"
  },
  {
    "text": "and also as you're seeing things like getting getting that context like what was a processed tree when this happened",
    "start": "2162440",
    "end": "2168300"
  },
  {
    "text": "what was the user running who else was on the box like having those questions were ready to go and you see anything",
    "start": "2168300",
    "end": "2173690"
  },
  {
    "text": "but nother thing to to know is that like we have those atomic tests we don't have to wait for like a red team to test our",
    "start": "2173690",
    "end": "2180390"
  },
  {
    "text": "posture there are ways that we can and so talks as well unlike purple teaming and so we can do that to kind of",
    "start": "2180390",
    "end": "2186430"
  },
  {
    "text": "short-circuit a bit of that process and and then the final thing is avoiding",
    "start": "2186430",
    "end": "2192490"
  },
  {
    "text": "like over reactions to trending things and that can be tricky it's like do we",
    "start": "2192490",
    "end": "2197619"
  },
  {
    "text": "detect this and sometimes that's the thing you have to like have an answer for but like so no one's gonna be asking",
    "start": "2197619",
    "end": "2203920"
  },
  {
    "text": "you tomorrow like do we detect a bug sir I don't know if maybe but there's still like do you detect credential jumping",
    "start": "2203920",
    "end": "2210760"
  },
  {
    "text": "from Alsace like that is still like a large threat like make sure you have like a good sense to prioritize someone",
    "start": "2210760",
    "end": "2217570"
  },
  {
    "text": "passes back to Casey to wrap this up yeah so a couple of things there as far as looking at you know we talked about how to generate some atomic tests how do",
    "start": "2217570",
    "end": "2224740"
  },
  {
    "text": "we structure our queries and then we wanted to leave you with a few things about what can you can do to kind of put",
    "start": "2224740",
    "end": "2230410"
  },
  {
    "text": "some of this together to really drive finding gaps or assessing coverage before you're facing an actual test or",
    "start": "2230410",
    "end": "2237070"
  },
  {
    "text": "an adversary so a couple things that you can do to kind of get started and again this is not replacing the full blown",
    "start": "2237070",
    "end": "2242320"
  },
  {
    "start": "2240000",
    "end": "2240000"
  },
  {
    "text": "like red team scope we're just saying like these are things that you can do today to start testing because it's really much better to find a miss",
    "start": "2242320",
    "end": "2248140"
  },
  {
    "text": "configuration or gap before something actually happens and so installing if",
    "start": "2248140",
    "end": "2253180"
  },
  {
    "text": "you're running it wondering where do I get started with some of these techniques that we show today in the Windows environment we've got setting up",
    "start": "2253180",
    "end": "2258820"
  },
  {
    "text": "system on there's there various configurations we've referenced here that'll be available after the talk where you can go and configure that lots",
    "start": "2258820",
    "end": "2265390"
  },
  {
    "text": "of different event types looking at atomic tests they're not just related to Windows we do have atomic text for Mac",
    "start": "2265390",
    "end": "2271030"
  },
  {
    "text": "and Linux of your testing notes as well then extracting those events putting them into that JSON format so then you",
    "start": "2271030",
    "end": "2277000"
  },
  {
    "text": "can begin running equal so installing equal is really just a couple of command lines really the dependency there is",
    "start": "2277000",
    "end": "2283330"
  },
  {
    "text": "Python only and then using the shell we would love to get feedback you know for raw so I'm like using the shell getting",
    "start": "2283330",
    "end": "2288820"
  },
  {
    "text": "you know ways to improve or how you're actually using it and then lastly just start piping the data into equal and",
    "start": "2288820",
    "end": "2294730"
  },
  {
    "text": "begin practicing those queries or building out your detection and testing them against known datasets so what are",
    "start": "2294730",
    "end": "2301480"
  },
  {
    "text": "some of the things that we can kind of wrap up or conclude as we're thinking about like understanding what data",
    "start": "2301480",
    "end": "2307839"
  },
  {
    "start": "2306000",
    "end": "2306000"
  },
  {
    "text": "sources you have is very important and there's a talk yesterday by Katie and Ryan about you know mitre",
    "start": "2307839",
    "end": "2313480"
  },
  {
    "text": "attacking how to use it how to get started there's some really good things in there about understanding data sources so I would definitely check out that talk if you hadn't seen it focusing",
    "start": "2313480",
    "end": "2320950"
  },
  {
    "text": "on the commonly seen behaviors debug serve is new it's novel to my understanding no one's using it or abusing it but this year the prevalence",
    "start": "2320950",
    "end": "2327609"
  },
  {
    "text": "of that being very low like if you went back today and searched your environment that is very likely zero instances of it",
    "start": "2327609",
    "end": "2333430"
  },
  {
    "text": "running but it's worth going to look and see if anyone has a music is sometimes you're not the first one to find a thing",
    "start": "2333430",
    "end": "2338490"
  },
  {
    "text": "and then practice on those known known data sets and then scale up so really practicing the detection coverage",
    "start": "2338490",
    "end": "2345040"
  },
  {
    "text": "against something that you instrument with test data like you saw Ross entering through the the queries and",
    "start": "2345040",
    "end": "2350710"
  },
  {
    "text": "while he was finding the atomic and it was a lot of noise we are still able to actually validate that the yes this is",
    "start": "2350710",
    "end": "2357280"
  },
  {
    "text": "what I would expect to see parent-child processes testing early and often as much as you can and then knowing with",
    "start": "2357280",
    "end": "2363820"
  },
  {
    "text": "resources both of these are free resource projects on github so we would love to get feedback and how you're",
    "start": "2363820",
    "end": "2369609"
  },
  {
    "text": "using it ways to improve etc so we put together a few references for you so if",
    "start": "2369609",
    "end": "2375520"
  },
  {
    "text": "you're curious about some of the things we've talked about in this talk we talked about minor attack we've talked",
    "start": "2375520",
    "end": "2380590"
  },
  {
    "text": "about atomic read team the event query language and all the references we also put a lot of this together on the blank there you see in",
    "start": "2380590",
    "end": "2387490"
  },
  {
    "text": "the lower left corner so we do have a little bit of time for some questions I think but maybe just one or two",
    "start": "2387490",
    "end": "2393160"
  },
  {
    "text": "questions and then we'll probably move over to the the wrap-up room but just a couple shout outs for people that helped",
    "start": "2393160",
    "end": "2399100"
  },
  {
    "text": "us as we prepared the talk paul devon mike and adam work with us as we prepare our content here so at this point i will",
    "start": "2399100",
    "end": "2407200"
  },
  {
    "text": "says we just have a couple minutes if anybody does have a question i'll go ahead and ask if anyone has a question we could take it okay if you would like",
    "start": "2407200",
    "end": "2416680"
  },
  {
    "text": "to continue the conversation we'll really heavy into the south CH room for the wrap-up so thank you for your time today and appreciate your attention",
    "start": "2416680",
    "end": "2424890"
  }
]