[
  {
    "text": "[Music]",
    "start": "5860",
    "end": "9019"
  },
  {
    "text": "[Music]",
    "start": "14100",
    "end": "20680"
  },
  {
    "text": "[Music]",
    "start": "31100",
    "end": "48610"
  },
  {
    "text": "oh yeah I forgot to introduce ourselves my name is Jeremiah Grossman I am the CEO of white hat security Inc",
    "start": "54920",
    "end": "61480"
  },
  {
    "text": "this is Bill Pennington senior security engineer for white hat security collectively we uh do a lot of uh R&D",
    "start": "61480",
    "end": "67560"
  },
  {
    "text": "and web application security and get to uh tell you all about what we know about the uh areas of web application security",
    "start": "67560",
    "end": "73920"
  },
  {
    "text": "hope you enjoy if anytime you have questions during the talks about whatever just let us know we'd be happy",
    "start": "73920",
    "end": "79159"
  },
  {
    "text": "to uh answer whatever you have so the three topics we're covering today will",
    "start": "79159",
    "end": "84240"
  },
  {
    "text": "be web server fingerprinting how to determine uh remotely what uh what web",
    "start": "84240",
    "end": "89439"
  },
  {
    "text": "app what type of web server is running remotely and the techniques to do so",
    "start": "89439",
    "end": "95079"
  },
  {
    "text": "we'll be talking about a relatively new issue called cross-site tracing a variant of cross-site scripting and also",
    "start": "95079",
    "end": "101640"
  },
  {
    "text": "a web application forensics how to determine what's being done to your web application from uh an outsider done uh",
    "start": "101640",
    "end": "109320"
  },
  {
    "text": "to your web application by an outsider so we'll be uh covering those topics and or starting with a web application",
    "start": "109320",
    "end": "117079"
  },
  {
    "text": "fingerprinting so before we get into all the why fingerprinting type of thing I",
    "start": "117079",
    "end": "124159"
  },
  {
    "text": "mean before we get into fingerprinting like the technical discussions why fingerprint in",
    "start": "124159",
    "end": "129200"
  },
  {
    "text": "general well we see a lot of web web servers out there where the banner is being removed the banner being changed",
    "start": "129200",
    "end": "136959"
  },
  {
    "text": "uh on publicly available web servers yet when doing penetration tests or patch Delivery Systems on those particular",
    "start": "136959",
    "end": "143440"
  },
  {
    "text": "types of web servers it's helpful to know or to be able to determine what type of web server is actually running",
    "start": "143440",
    "end": "149599"
  },
  {
    "text": "so there's one reason so you you may also want to uh determine the configuration settings of a particular",
    "start": "149599",
    "end": "155800"
  },
  {
    "text": "web server also to further develop techniques on how to counter uh on how",
    "start": "155800",
    "end": "161640"
  },
  {
    "text": "to counter finger different fingerprinting techniques as they come out and it also makes a patch delivery",
    "start": "161640",
    "end": "168440"
  },
  {
    "text": "easier now how do we go about actually fingerprinting a web server well the uh",
    "start": "168440",
    "end": "175280"
  },
  {
    "text": "the method that we came up with was use a standard set or one HTTP request that",
    "start": "175280",
    "end": "182040"
  },
  {
    "text": "is standard and supported by all web servers that give you varied responses",
    "start": "182040",
    "end": "188200"
  },
  {
    "text": "dep on between web servers on each particular version so if you're able to send a request you can actually start",
    "start": "188200",
    "end": "195400"
  },
  {
    "text": "signatur in each different web server response and be able to determine the",
    "start": "195400",
    "end": "200440"
  },
  {
    "text": "differences so we got this from Netcraft back in January on the breakdown of web servers in the wild we'd use this as",
    "start": "200440",
    "end": "207480"
  },
  {
    "text": "what we wanted to be able to fingerprint out there so we have to go to you know fingerprinting like weird web servers",
    "start": "207480",
    "end": "213080"
  },
  {
    "text": "that rarely any nobody uses so we stick to these main four",
    "start": "213080",
    "end": "219000"
  },
  {
    "text": "so looking at the protocol in HTTP we uh can see highlighted in red",
    "start": "219000",
    "end": "226680"
  },
  {
    "text": "the server banner and as part of this request at the very",
    "start": "226680",
    "end": "232120"
  },
  {
    "text": "top there um that's not highlighted there's an options star request http/1.1 and we're targeting eBay",
    "start": "232120",
    "end": "241200"
  },
  {
    "text": "and click it I sorry back so we use the option star request",
    "start": "241200",
    "end": "249560"
  },
  {
    "text": "and we can see the server Banner highlighted in red and there's some other interesting headers in the actual request like public options Trace get",
    "start": "249560",
    "end": "256680"
  },
  {
    "text": "remember that particular header there's some other servers that don't have banners okay you know wire",
    "start": "256680",
    "end": "263080"
  },
  {
    "text": "trip in particular so we did a head request on wi trip and it didn't give us any uh any",
    "start": "263080",
    "end": "269720"
  },
  {
    "text": "server Banner so these are the types of servers when we talk about you know we need to fingerprint them to know what they're",
    "start": "269720",
    "end": "275759"
  },
  {
    "text": "running so it's a duplicate slide but we'll go over it again so we sent this particular question Ops and star with a",
    "start": "275759",
    "end": "281759"
  },
  {
    "text": "host header very easy and we got the following response with a Microsoft I4 server Banner so this is would be our",
    "start": "281759",
    "end": "288199"
  },
  {
    "text": "first way to Signature so click down so we have the",
    "start": "288199",
    "end": "293800"
  },
  {
    "text": "uh the public header highlighted in red and we'll jump to the next one we did",
    "start": "293800",
    "end": "299479"
  },
  {
    "text": "the same particular type of request on is5 and got this",
    "start": "299479",
    "end": "304720"
  },
  {
    "text": "output I believe this was uh Dell Dell Dell runs i5 and there's two headers on",
    "start": "304720",
    "end": "311520"
  },
  {
    "text": "this and we see the server banner up there is5 and there's now a public header and an allow header with uh the",
    "start": "311520",
    "end": "318199"
  },
  {
    "text": "same set of values but it was different from the iis4 values okay same HTTP",
    "start": "318199",
    "end": "323520"
  },
  {
    "text": "request different output so to do a quick check",
    "start": "323520",
    "end": "330560"
  },
  {
    "text": "we see a quick uh analysis between the two if you're able to send an options star request to a web server that",
    "start": "330560",
    "end": "336880"
  },
  {
    "text": "doesn't give up a banner or the banner might be lying to you you can use an option star request and distinguish",
    "start": "336880",
    "end": "342600"
  },
  {
    "text": "between what's I4 and what's I-5 very very simply so in uh in Apache there's the uh",
    "start": "342600",
    "end": "350960"
  },
  {
    "text": "the same problem if you will you send an option star to Apache 13 you get get",
    "start": "350960",
    "end": "356080"
  },
  {
    "text": "head options Trace in that order when we go to a a 2.0 server we get get",
    "start": "356080",
    "end": "363960"
  },
  {
    "text": "head poach options Trace but you notice there's no spaces between the values so now you can see the output is actually",
    "start": "363960",
    "end": "371319"
  },
  {
    "text": "different we're able to distinguish between not Apache 132 and also I4 and is50 one request one",
    "start": "371319",
    "end": "381440"
  },
  {
    "text": "request standard on all web servers so we this uh I like to use this",
    "start": "381440",
    "end": "389599"
  },
  {
    "text": "particular side because I got this uh from Tim Mullen when I did a a talk on",
    "start": "389599",
    "end": "394720"
  },
  {
    "text": "on web application security tools back in uh New Orleans I was uh doing a",
    "start": "394720",
    "end": "400120"
  },
  {
    "text": "little presentation and I used a particular tool on uh on Tim Mullen site trying to mess with it and this he's",
    "start": "400120",
    "end": "406720"
  },
  {
    "text": "changed his Ser server Banner to an HTML tag which ended up making a spinning skull in my tool during my presentation",
    "start": "406720",
    "end": "412560"
  },
  {
    "text": "so that was nice of him and uh but using the public and un allow headers that he",
    "start": "412560",
    "end": "418360"
  },
  {
    "text": "put in there I was able to dis still determine what the uh what the particular web server he was running in this case it was I-5 even though he did",
    "start": "418360",
    "end": "425360"
  },
  {
    "text": "a little bit of a registry hack and changed the server Banner to",
    "start": "425360",
    "end": "429879"
  },
  {
    "text": "HTML so here's the variances in uh also Netscape",
    "start": "430440",
    "end": "435879"
  },
  {
    "text": "36 starts the the order is different between you know the previous ones that we saw and and between I and Apache so",
    "start": "435879",
    "end": "445240"
  },
  {
    "text": "Netscape 36 they have just the public header in this one head get postp put head get put post and 41 how the allow",
    "start": "445240",
    "end": "453639"
  },
  {
    "text": "they use the allow header in 4.1 with a lot more uh values in the request in the",
    "start": "453639",
    "end": "459840"
  },
  {
    "text": "allowed index make dur remove dur whole bunch of craziness so we also have Netscape 6",
    "start": "459840",
    "end": "466479"
  },
  {
    "text": "which is actually exactly the same between 41 and 60 so you need another particular htw HTTP request to tell the",
    "start": "466479",
    "end": "473919"
  },
  {
    "text": "difference between Apache 4 and Apache 6 so with one simple requests we're able",
    "start": "473919",
    "end": "480280"
  },
  {
    "text": "to we have enough entropy in the major web servers out there to determine what the major version of a web server is",
    "start": "480280",
    "end": "486280"
  },
  {
    "text": "running it doesn't help us get the the minor version yet with one request but",
    "start": "486280",
    "end": "491720"
  },
  {
    "text": "just be able to tell the the major version is uh pretty good at this point so for uh for reference here's our",
    "start": "491720",
    "end": "501000"
  },
  {
    "text": "you know here are the major uh web servers out there and what the response is to an option star request so if you",
    "start": "501000",
    "end": "506080"
  },
  {
    "text": "ever run across a server that you think might be a lying to you or you want to find out what it is throw it an option",
    "start": "506080",
    "end": "511120"
  },
  {
    "text": "star match it up with the list here and you should be able to determine what it is it's kind of interesting out",
    "start": "511120",
    "end": "516919"
  },
  {
    "text": "there so what can we conclude if the web server supports options",
    "start": "516919",
    "end": "522518"
  },
  {
    "text": "star we can uh for the most part determine what the what the major version of the web server is it's a very",
    "start": "522519",
    "end": "528320"
  },
  {
    "text": "nice little technique so uh to get the minor version",
    "start": "528320",
    "end": "533640"
  },
  {
    "text": "we were we're still doing R&D on to get the minor version of uh of Apache we",
    "start": "533640",
    "end": "538800"
  },
  {
    "text": "have some uh pretty decent internal tools hopefully we're releasing in the next couple of months that help out",
    "start": "538800",
    "end": "544200"
  },
  {
    "text": "tracking uh web servers down to a very fine degree what exactly they are",
    "start": "544200",
    "end": "549560"
  },
  {
    "text": "running what exactly the configs are running because every web server will react just a little bit differently to",
    "start": "549560",
    "end": "554760"
  },
  {
    "text": "the right HTTP request sending so you don't have to stick to option star if you have some time you want to look",
    "start": "554760",
    "end": "560200"
  },
  {
    "text": "through change logs or patch differences you can uh send your own responses and track the differences between a Apache",
    "start": "560200",
    "end": "567040"
  },
  {
    "text": "or Apache I whatever what have you so the research you know it's not complete it's really just begun U",
    "start": "567040",
    "end": "574120"
  },
  {
    "text": "fingerprinting web servers we're want to get a a large good pool of HTTP requests",
    "start": "574120",
    "end": "579560"
  },
  {
    "text": "to fingerprint maybe 20 to 30 or so that are standard across all uh web",
    "start": "579560",
    "end": "585680"
  },
  {
    "text": "servers generally that are very very hard to change or configure out of the system without a lot of work so we want",
    "start": "585680",
    "end": "591680"
  },
  {
    "text": "to make sure we have a good set way to Signature a web server so what are the countermeasures",
    "start": "591680",
    "end": "598240"
  },
  {
    "text": "to uh this particular type of Technology what can you do to make sure somebody can't fingerprint you well we have Micro",
    "start": "598240",
    "end": "605360"
  },
  {
    "text": "for IIs we have URL scan we also have secure I and a commercial product by",
    "start": "605360",
    "end": "610519"
  },
  {
    "text": "Port software called server mask on the Apache side of the world we have mody right some H uh some configuration",
    "start": "610519",
    "end": "617519"
  },
  {
    "text": "changes and also you can modify the source and we'll cover a little these in depth so",
    "start": "617519",
    "end": "623000"
  },
  {
    "text": "uh for the most part in a functional web application environment you really don't need the options request method so you",
    "start": "623000",
    "end": "631079"
  },
  {
    "text": "can spe using URL scan you can specifically deny it okay using uh those particular options however word of",
    "start": "631079",
    "end": "637839"
  },
  {
    "text": "caution you know Mullen was trying to thort me and goes okay I'm not going to allow I'm not going to allow anything but get her post so uh he ended up",
    "start": "637839",
    "end": "645079"
  },
  {
    "text": "breaking his corporate Outlook web access server because it needed search and everything else so you can set up a",
    "start": "645079",
    "end": "650839"
  },
  {
    "text": "quick deny on options and it'll give you a little bit of a Distance on the Apache side of uh the",
    "start": "650839",
    "end": "657279"
  },
  {
    "text": "house there is uh the htpd comp file using mod rewrite you can uh set a rule",
    "start": "657279",
    "end": "662560"
  },
  {
    "text": "to deny option star request using a rewrite rule is there any questions on uh",
    "start": "662560",
    "end": "669720"
  },
  {
    "text": "fingerprinting so far or is it pretty straightforward oh G down oh",
    "start": "669720",
    "end": "676120"
  },
  {
    "text": "yes I haven't seen that one",
    "start": "684760",
    "end": "689440"
  },
  {
    "text": "uh the the gentleman said actually if I can repeat it other countermeasures to",
    "start": "690800",
    "end": "696320"
  },
  {
    "text": "uh fingerprinting they're sending a reset like a TCP",
    "start": "696320",
    "end": "701519"
  },
  {
    "text": "reset is that what what product would that be or could okay uh particularly mtv.com is",
    "start": "702480",
    "end": "710399"
  },
  {
    "text": "that right has this Behavior I want to check that out uh anybody else yes sir",
    "start": "710399",
    "end": "719199"
  },
  {
    "text": "um like I said we tested we tested we weren't entirely sure to begin with and option star was like somewhat of a",
    "start": "722920",
    "end": "728880"
  },
  {
    "text": "rudimentary uh HTTP request we found in RC 1.1 and uh it looks like there it was",
    "start": "728880",
    "end": "734279"
  },
  {
    "text": "just implemented in web servers as a way to tell what the web server supports and",
    "start": "734279",
    "end": "739440"
  },
  {
    "text": "uh that particular request really only does that we haven't seen much variances like at all some web servers free ones",
    "start": "739440",
    "end": "746240"
  },
  {
    "text": "and offbeat ones they don't support it too well like a public file doesn't support it but uh the major web servers",
    "start": "746240",
    "end": "753000"
  },
  {
    "text": "that we deal with on a day daily basis um pachy IIs I Planet all support it",
    "start": "753000",
    "end": "758560"
  },
  {
    "text": "just fine and uh it's very very consistent on any installation that you",
    "start": "758560",
    "end": "764399"
  },
  {
    "text": "see okay so we're going to to uh jump to the",
    "start": "765480",
    "end": "771199"
  },
  {
    "text": "next topic cross- site tracing uh might have seen the banter going going back and forth on bug track so uh just take",
    "start": "771199",
    "end": "778279"
  },
  {
    "text": "the opportunity to try to describe what what this is it's very esoteric I'll do my best to describe it and uh hopefully",
    "start": "778279",
    "end": "785480"
  },
  {
    "text": "there'll be questions on this and how exactly it works and in case I did do a bad job presenting",
    "start": "785480",
    "end": "792160"
  },
  {
    "text": "it so there's also going to be a a code demo at the end so you can see how the code actually works cross- site tracing",
    "start": "792800",
    "end": "800040"
  },
  {
    "text": "what is it to begin with it's a close variation of cross-site scripting but it's somewhat removed from that",
    "start": "800040",
    "end": "805880"
  },
  {
    "text": "particular type of attack now what does cross-site tracing",
    "start": "805880",
    "end": "810959"
  },
  {
    "text": "give you that cross-site scripting doesn't okay I personally I don't like the term cross-site scripting but it's",
    "start": "810959",
    "end": "816440"
  },
  {
    "text": "stuck out there and that's what we have to use so it can bypass ie's new HTTP",
    "start": "816440",
    "end": "822880"
  },
  {
    "text": "only cookie uh security the HB only cookie security method was implemented uh I think in just IE where uh if the",
    "start": "822880",
    "end": "831839"
  },
  {
    "text": "server set a cookie with HTTP only JavaScript or any any client side scripting language cannot access the",
    "start": "831839",
    "end": "838480"
  },
  {
    "text": "document cookie object the cookie object in the browser so if your particular website did not use any legitimate",
    "start": "838480",
    "end": "846040"
  },
  {
    "text": "JavaScript to uh access the cookie data you can actually enforce it in the browser so it's a little uh increased",
    "start": "846040",
    "end": "853320"
  },
  {
    "text": "security measure that uh to to try to prevent cross-site scripting from only",
    "start": "853320",
    "end": "858519"
  },
  {
    "text": "the cookie stealing attacks so it's a nice little step by that Microsoft gave you can access the basic authentication",
    "start": "858519",
    "end": "866040"
  },
  {
    "text": "credentials in uh in the browser which is to the best of my knowledge not before possible so this is when you you",
    "start": "866040",
    "end": "872880"
  },
  {
    "text": "know go to like a some kind of router or some kind of site using basic off you have to type in your username and password and it's Bas 64 encoded and",
    "start": "872880",
    "end": "879880"
  },
  {
    "text": "it's in a header below previously no web client technology was able to access this information cross-site tracing now",
    "start": "879880",
    "end": "886360"
  },
  {
    "text": "gives you ability to do so very similar access to anti landman credentials very",
    "start": "886360",
    "end": "891519"
  },
  {
    "text": "cool little attack so what cross- site tracing has",
    "start": "891519",
    "end": "898040"
  },
  {
    "text": "a to perform it cross-site scripting you know to",
    "start": "898040",
    "end": "903320"
  },
  {
    "text": "perform cross-site scripting you needed a vulnerable web application that to cross-site scripting this is no longer",
    "start": "903320",
    "end": "909880"
  },
  {
    "text": "true with cross- sight tracing all you need is a web server that supports trace and they all do by default all the major",
    "start": "909880",
    "end": "916560"
  },
  {
    "text": "versions so here where we jump to the requirements I'm giving you a little background knowledge so we can track the",
    "start": "916560",
    "end": "922800"
  },
  {
    "text": "interaction so what we need for cross site scripting is a vulnerable web application a user that will click",
    "start": "922800",
    "end": "929519"
  },
  {
    "text": "or view malicious content on a web page okay those are the requirements cross-site tracing requirements are",
    "start": "929519",
    "end": "935519"
  },
  {
    "text": "different all we need is a web server that supports a trace request a place to host the cross- site tracing code and if",
    "start": "935519",
    "end": "943759"
  },
  {
    "text": "you want to cross the domain on a particular Tac you need a cross domain browser bug which is not entirely in",
    "start": "943759",
    "end": "951279"
  },
  {
    "text": "uncommon so to just step back for a minute and just briefly go over the",
    "start": "951279",
    "end": "956519"
  },
  {
    "text": "steps of cross-site scripting on what happens in a SE an attacker inserts code into a site or",
    "start": "956519",
    "end": "963360"
  },
  {
    "text": "sends malicious HTML an malicious HTML link to a user that bean",
    "start": "963360",
    "end": "968519"
  },
  {
    "text": "malians oh wow so next the user views malicious",
    "start": "968519",
    "end": "975839"
  },
  {
    "text": "views the malicious content or clicks on the link okay that's the user action the malicious code then is executed in the",
    "start": "975839",
    "end": "982600"
  },
  {
    "text": "hosting domain wherever you got the script from or it's being loaded from and if you're doing a cookie stealing",
    "start": "982600",
    "end": "988959"
  },
  {
    "text": "attack the cookie data or whatever data the script is grabbing is then passed off to a third party so it's really",
    "start": "988959",
    "end": "994040"
  },
  {
    "text": "about a four-step process so cross- site tracing is",
    "start": "994040",
    "end": "1000120"
  },
  {
    "text": "somewhat different in the way it loops around so it's good to see this in action so the attacker sends code to the",
    "start": "1000120",
    "end": "1007079"
  },
  {
    "text": "Target site okay so this is this is probably going to get confusing so somebody you know please ask questions",
    "start": "1007079",
    "end": "1013199"
  },
  {
    "text": "if you don't get this the user then views the malicious code on the site okay",
    "start": "1013199",
    "end": "1019600"
  },
  {
    "text": "that code is that web page with the with the uh scripted code will re return to the victim's browser",
    "start": "1019600",
    "end": "1026520"
  },
  {
    "text": "okay the code then directs the browser via some you know cross- site scripting via some client site technology to send",
    "start": "1026520",
    "end": "1033558"
  },
  {
    "text": "an arbitrary HTTP Trace request to a Target domain be it passport.com",
    "start": "1033559",
    "end": "1041319"
  },
  {
    "text": "bankofamerica.com whatever whatever domain you want to attack and get their credentials from the basic off stuff",
    "start": "1041559",
    "end": "1046798"
  },
  {
    "text": "their cookies whatever you want okay now the the victim at this point",
    "start": "1046799",
    "end": "1053799"
  },
  {
    "text": "has has had their browser without their knowledge sent an HTTP request a trace request to The Domain at that point the",
    "start": "1053799",
    "end": "1060880"
  },
  {
    "text": "script now has access to the you know to like I said the basic auth credentials all the cookie information and then can",
    "start": "1060880",
    "end": "1067679"
  },
  {
    "text": "be made to send another request to the attacker passing all that information off",
    "start": "1067679",
    "end": "1072960"
  },
  {
    "text": "site okay I know I got a lost some is this is it is there a question so far",
    "start": "1072960",
    "end": "1079760"
  },
  {
    "text": "okay well let's go forward so before I get into the code",
    "start": "1079760",
    "end": "1084840"
  },
  {
    "text": "demo and I'll show this in action this is a multiplatform multi-technology issue it's not just going to be ActiveX",
    "start": "1084840",
    "end": "1092080"
  },
  {
    "text": "it's not just going to be flash it's going to be every client side technology that's that the browser",
    "start": "1092080",
    "end": "1099640"
  },
  {
    "text": "supports it's also not just one browser issue it's going to be in we have test",
    "start": "1099640",
    "end": "1106200"
  },
  {
    "text": "running in uh IE Mozilla using Java and ActiveX so it's multiplatform multi",
    "start": "1106200",
    "end": "1112320"
  },
  {
    "text": "technology and we're not even entirely certain where the best fix is but the general remedies and I I'll try to cover them the best I",
    "start": "1112320",
    "end": "1118640"
  },
  {
    "text": "can the best remedies we can come up come up with after talking with merer C",
    "start": "1118640",
    "end": "1124159"
  },
  {
    "text": "other experts in the field to trying to you know help us through the mess was uh patch all web servers patch all web",
    "start": "1124159",
    "end": "1130480"
  },
  {
    "text": "browsers I should say against do domain restriction bypass this way you can limit the cross- site tracing problem to",
    "start": "1130480",
    "end": "1137559"
  },
  {
    "text": "The Domain that they load the cross site tracing code from okay this is very very important now before it was just minor",
    "start": "1137559",
    "end": "1145240"
  },
  {
    "text": "things this gets very important at this point so you also are able to to",
    "start": "1145240",
    "end": "1151960"
  },
  {
    "text": "disallow Trace requests on the web server so if the script tries to send a trace request to an off domain server",
    "start": "1151960",
    "end": "1159799"
  },
  {
    "text": "hopefully that server will not allow Trace to the best you know what we've seen out there there's no reason to have trace on your web server you know by on",
    "start": "1159799",
    "end": "1166480"
  },
  {
    "text": "by default but uh that was easier set said than done in you know most uh most ways to try to turn Trace off so web Ser",
    "start": "1166480",
    "end": "1173559"
  },
  {
    "text": "web server vendors to also update their packages we think to uh have Trace turned off by default and have it an",
    "start": "1173559",
    "end": "1179960"
  },
  {
    "text": "option to turn it back on so well and uh",
    "start": "1179960",
    "end": "1185080"
  },
  {
    "text": "let skip at number five there ActiveX controls or any client side technology should fiercely restrict their ability",
    "start": "1185080",
    "end": "1192840"
  },
  {
    "text": "to have the browser send arbitrary HTTP requests that's a whole lot of uh Power to put in the browser",
    "start": "1192840",
    "end": "1200640"
  },
  {
    "text": "so here's some again the code demo will be coming promise so server specific issues uh that you can uh use to fix I",
    "start": "1202840",
    "end": "1210080"
  },
  {
    "text": "URL scan Apache you can modify the source some mod rewrite rules that RFP",
    "start": "1210080",
    "end": "1215360"
  },
  {
    "text": "uh gave us and uh the limit directive that we were trying to play with in Apache didn't work work the way we would",
    "start": "1215360",
    "end": "1221200"
  },
  {
    "text": "like so the only way to to limit Trace uh in this in the in the code is",
    "start": "1221200",
    "end": "1226400"
  },
  {
    "text": "actually uh to do a mod rewrite hack really so the uh URL scan configs deny deny the",
    "start": "1226400",
    "end": "1235039"
  },
  {
    "text": "verb trace and uh once again it might affect some uh front page",
    "start": "1235039",
    "end": "1242039"
  },
  {
    "text": "stuff uh skip all this so the demo uh can you switch give us one",
    "start": "1242039",
    "end": "1249960"
  },
  {
    "text": "minute so we can switch machines so any any questions so far",
    "start": "1249960",
    "end": "1255720"
  },
  {
    "text": "we'll get to the code demo in a second but good is",
    "start": "1255720",
    "end": "1263880"
  },
  {
    "text": "it okay we're actually going to try to make a live HTP request to AET and show",
    "start": "1268120",
    "end": "1273760"
  },
  {
    "text": "the uh show it the demo in action however the wireless network has been",
    "start": "1273760",
    "end": "1279120"
  },
  {
    "text": "not kind to us",
    "start": "1279120",
    "end": "1282760"
  },
  {
    "text": "what's going",
    "start": "1300480",
    "end": "1302880"
  },
  {
    "text": "on okay looks like we're having technical difficulties yeah okay all right so",
    "start": "1311799",
    "end": "1319919"
  },
  {
    "text": "we're going to skip over this while I solve the the problems here sorry about",
    "start": "1319919",
    "end": "1324759"
  },
  {
    "text": "that all right while someone's messing with their Windows laptop we're going to talk about the exciting and really cool",
    "start": "1343760",
    "end": "1350720"
  },
  {
    "text": "field of web application forensics now um whoa let me blow",
    "start": "1350720",
    "end": "1356000"
  },
  {
    "text": "everybody's ears away first so the forensics basically everybody's kind of familiar with the term everybody's",
    "start": "1356000",
    "end": "1361320"
  },
  {
    "text": "familiar with what you do generally speaking most forensics people these days will run uh some sort of cool tool",
    "start": "1361320",
    "end": "1367080"
  },
  {
    "text": "like Inc case DD and the majority of the forensics people out there are like sitting around looking for Kitty porn",
    "start": "1367080",
    "end": "1373240"
  },
  {
    "text": "kind of that kind of stuff really not so cool stuff to look at so I got interested in forensics basically um not",
    "start": "1373240",
    "end": "1379760"
  },
  {
    "text": "to go do that stuff but uh to look at basically network based attacks and application based",
    "start": "1379760",
    "end": "1385679"
  },
  {
    "text": "attacks so I couldn't find any really good tools if I was looking to see if someone was attacking a web application or a web server there's no good uh log",
    "start": "1385679",
    "end": "1393039"
  },
  {
    "text": "analysis that I could find I only found really one document that was talking about web application forensics and how",
    "start": "1393039",
    "end": "1398840"
  },
  {
    "text": "to determine if people were attacking your web application it was from a company called sanctum and basically it was really short one page said buy their",
    "start": "1398840",
    "end": "1405400"
  },
  {
    "text": "product one two into that and uh I was bored I was on a Consulting gig sitting",
    "start": "1405400",
    "end": "1410880"
  },
  {
    "text": "at my hotel room said hey what am I going to do let's code up some really nasty Pearl code and see if I get this",
    "start": "1410880",
    "end": "1416080"
  },
  {
    "text": "thing to work so very simple typical web server environment what the area we're going to",
    "start": "1416080",
    "end": "1422919"
  },
  {
    "text": "be focusing on today is the web server itself and we there's um you also have logs in the application server and the",
    "start": "1422919",
    "end": "1429440"
  },
  {
    "text": "database server and these are going to become very important as we'll see so what kind of web attacks are we",
    "start": "1429440",
    "end": "1435559"
  },
  {
    "text": "talking about we're going to be talking about SQL injection cross it scripting attacks uh parameter tampering directory",
    "start": "1435559",
    "end": "1441480"
  },
  {
    "text": "traversal attacks and uh we can also detect various web server flaws being executed or attempted to be executed",
    "start": "1441480",
    "end": "1447880"
  },
  {
    "text": "such as Unicode double dcode and SSL overflows basically anything that makes a request to a web browser we're going",
    "start": "1447880",
    "end": "1454159"
  },
  {
    "text": "to try to detect so again Avenues of attack everybody has a website Port 80 clear",
    "start": "1454159",
    "end": "1460960"
  },
  {
    "text": "attacks it's easy to watch with an IDS system so I could theoretically build IDs rules to watch for some of these",
    "start": "1460960",
    "end": "1466679"
  },
  {
    "text": "attacks if anybody out here uses s you know you're probably getting beeped every 5 minutes about someone trying to do a Unicode double decode attack or",
    "start": "1466679",
    "end": "1473399"
  },
  {
    "text": "something like that pretty straightforward the problem we want interrupt with web applications is",
    "start": "1473399",
    "end": "1480000"
  },
  {
    "text": "99.9% of the time they're going to be running over SSL right how do I get my IDs box to look at SSL yeah I can put",
    "start": "1480000",
    "end": "1486360"
  },
  {
    "text": "the CT there I can do all kinds of stuff there but most of the time it's not happening all right so if you um we're",
    "start": "1486360",
    "end": "1494120"
  },
  {
    "text": "not going to delve in depth on how an HTTP request looks and how it's formed but you have basically a git request",
    "start": "1494120",
    "end": "1500159"
  },
  {
    "text": "gets a object or file from a web server it's pretty easy to to par and look at everything is logged post request only",
    "start": "1500159",
    "end": "1507080"
  },
  {
    "text": "thing that's logged is the path which is kind of a bummer for what we're going to be trying to do because I can't tell what they're sending into my",
    "start": "1507080",
    "end": "1513399"
  },
  {
    "text": "application so again traditional Network IDs doesn't work it's almost impossible to detect certain attacks with network",
    "start": "1513399",
    "end": "1519240"
  },
  {
    "text": "IDs uh there's some web Attack rules for snort out there basically they're looking for command. exe looking for",
    "start": "1519240",
    "end": "1525200"
  },
  {
    "text": "password files going over your network it's really not what we're talking talking about here and um again they can",
    "start": "1525200",
    "end": "1531440"
  },
  {
    "text": "detect code red nimda for you all day long so the only method we have of",
    "start": "1531440",
    "end": "1538360"
  },
  {
    "text": "looking at a web server or web application attack is with log files and we have the uh is log files generally",
    "start": "1538360",
    "end": "1545799"
  },
  {
    "text": "kept in when in system 32 logs um and that's what we take a look at here and then we have U the log file",
    "start": "1545799",
    "end": "1553200"
  },
  {
    "text": "format so this is the uh the standard IIs log file format get username",
    "start": "1553200",
    "end": "1558919"
  },
  {
    "text": "username user IP username date time service all kinds of good information we can look at now IIs 5 goes to the w3c",
    "start": "1558919",
    "end": "1567039"
  },
  {
    "text": "extended format and um and the NCSA common file format they both are supported so this is one of the",
    "start": "1567039",
    "end": "1573360"
  },
  {
    "text": "limitations you'll see in my tool coming up so we can also DET tell by the name",
    "start": "1573360",
    "end": "1578840"
  },
  {
    "text": "of the file what type of log it is if the file name starts with i in it's an I log file format if it starts with ex",
    "start": "1578840",
    "end": "1585720"
  },
  {
    "text": "it's a w3c extended log file format which means all bets are off on the format because I can customize that to",
    "start": "1585720",
    "end": "1591159"
  },
  {
    "text": "include whatever data I want to at whatever time and then we have the NCSA log files and they begin with NC I've",
    "start": "1591159",
    "end": "1597679"
  },
  {
    "text": "never actually seen anybody use NCSA log file format on an i server before patchy log files man all bets are",
    "start": "1597679",
    "end": "1605440"
  },
  {
    "text": "off right every Unix guy in the world wants to put his log files in some crazy directory somewhere along the line okay",
    "start": "1605440",
    "end": "1611720"
  },
  {
    "text": "generally they're access log accessor log something along those lines the first thing that first thing you're",
    "start": "1611720",
    "end": "1616919"
  },
  {
    "text": "probably going to have to do is find the http.com https.com whichever file they're using find out where they're",
    "start": "1616919",
    "end": "1622320"
  },
  {
    "text": "stowing the log files so again by default they're the NCSA common format or the combined log",
    "start": "1622320",
    "end": "1629360"
  },
  {
    "text": "file format the nice thing about this is the common file format and the combined",
    "start": "1629360",
    "end": "1634720"
  },
  {
    "text": "log file format that are default and Apache both have the same set of headers in the beginning so my tool can be",
    "start": "1634720",
    "end": "1640360"
  },
  {
    "text": "pretty stupid when it goes and looks at those so quick performance tip if you",
    "start": "1640360",
    "end": "1646480"
  },
  {
    "text": "separate your log files on physical from your disc content you can significantly well I wouldn't say significantly you",
    "start": "1646480",
    "end": "1651960"
  },
  {
    "text": "can probably pretty well increase performance right you're not reading static data off of the same place you're trying to write data to on the log file",
    "start": "1651960",
    "end": "1658679"
  },
  {
    "text": "every request that comes to your web server is getting written to dis somewhere move that to a separate disk serve your static content off a uh serve",
    "start": "1658679",
    "end": "1665200"
  },
  {
    "text": "all your other content off another hard drive it's preferably another uh scuzzy disc Channel another ID channel",
    "start": "1665200",
    "end": "1670360"
  },
  {
    "text": "depending on what you're doing so what are the problems with web server logs right so they're generally",
    "start": "1670360",
    "end": "1676120"
  },
  {
    "text": "like really really big they can a ND a lot of non security related entries",
    "start": "1676120",
    "end": "1681559"
  },
  {
    "text": "right I got like everybody that request a JPEG or a PDF from my file I got to deal with that it's in there uh post",
    "start": "1681559",
    "end": "1687279"
  },
  {
    "text": "data is rarely logged we'll get into some tools that log post data but uh I I've never seen one deployed in the wild",
    "start": "1687279",
    "end": "1693240"
  },
  {
    "text": "that actually logs Post data uh and again so many attacks occur via the post request and uh some of the attacks that",
    "start": "1693240",
    "end": "1699240"
  },
  {
    "text": "we talked about you simply cannot determine you're being attacked using a particular attack in a web server",
    "start": "1699240",
    "end": "1706320"
  },
  {
    "text": "log so let's take a look some log file sizes the immensely popular whitehat sec.com had about 4 thou 466,000 uh hits",
    "start": "1706320",
    "end": "1716320"
  },
  {
    "text": "between January 22nd and February 19th an e-com online gaming company that I used to work for between February 1st",
    "start": "1716320",
    "end": "1722919"
  },
  {
    "text": "and February 7th had 1.1 million requests to their Bank of uh web",
    "start": "1722919",
    "end": "1728000"
  },
  {
    "text": "applications so if I'm a poor forensics guy I'm going in and trying to figure out what's going on when someone attacked my server I'm going to have to",
    "start": "1728000",
    "end": "1733880"
  },
  {
    "text": "peel through 1.1 million lines of log files for the web server alone that's what prompted me to write uh this",
    "start": "1733880",
    "end": "1740200"
  },
  {
    "text": "little interesting tool so we we'll take a look at U what we have here from the white hat side",
    "start": "1740200",
    "end": "1746279"
  },
  {
    "text": "so vast majority 41,000 are images we had some PDF files up there we have HTML",
    "start": "1746279",
    "end": "1752159"
  },
  {
    "text": "files CGI files casting stylesheets and then the two one at the top the odd request and the odd URL is what we",
    "start": "1752159",
    "end": "1758840"
  },
  {
    "text": "pulled out from uh using my tool so what really defines a bad",
    "start": "1758840",
    "end": "1764919"
  },
  {
    "text": "request well we have the the response codes from HTTP that we can look at so 401 tells me somebody required",
    "start": "1764919",
    "end": "1771039"
  },
  {
    "text": "authentication on the HTTP level so we talked about HTTP basic authentication at the beginning this is the Response",
    "start": "1771039",
    "end": "1776440"
  },
  {
    "text": "Code I get back if I try to request a protected resource 500 response codes can be particularly nasty basically",
    "start": "1776440",
    "end": "1783200"
  },
  {
    "text": "there's server error if you're getting a lot of 500 response codes in your web server log files it's very possible you",
    "start": "1783200",
    "end": "1789640"
  },
  {
    "text": "have one a broken CGI or two someone's trying to attack you with a SQL injection assume you have a SQL back end",
    "start": "1789640",
    "end": "1795399"
  },
  {
    "text": "and all that kind of good stuff 200 response code is the standard Response Code for everything is cool and when",
    "start": "1795399",
    "end": "1800840"
  },
  {
    "text": "you're talking about security that could be the worst thing of all so if someone's making a request doing SQL injection they're getting a 200 back",
    "start": "1800840",
    "end": "1806960"
  },
  {
    "text": "that means they've success successfully exploited your server so got some weird characters here",
    "start": "1806960",
    "end": "1813840"
  },
  {
    "text": "so some things generally you should not find in a URL greater than less than apostrophe",
    "start": "1813840",
    "end": "1819880"
  },
  {
    "text": "Aster you generally don't find these things in a get request URL I like to do with the blue hair at the bottom these",
    "start": "1819880",
    "end": "1825919"
  },
  {
    "text": "are all Google Images searches by the way how I populate all my slides so then we have some odd request methods",
    "start": "1825919",
    "end": "1831960"
  },
  {
    "text": "generally 99.9% of the applications you're only going to see request methods either get or post you know why is someone trying to send me a head request",
    "start": "1831960",
    "end": "1839000"
  },
  {
    "text": "why is Jeremiah doing option star in my web server what's going on",
    "start": "1839000",
    "end": "1844679"
  },
  {
    "text": "here why is my presentation stopped that's a good question so let's take a look at some odd request methods again",
    "start": "1846440",
    "end": "1851840"
  },
  {
    "text": "head just Returns the uh the server header doesn't return the actual data option star used to fingerprint by my",
    "start": "1851840",
    "end": "1857720"
  },
  {
    "text": "good every body Jeremiah here Trace requests he's going to be doing those as well and all the web dab methods it gets",
    "start": "1857720",
    "end": "1863559"
  },
  {
    "text": "really really freaky right prop find all kinds of bizarre stuff in ow so I came up with a tool called",
    "start": "1863559",
    "end": "1870760"
  },
  {
    "text": "hillbilly I called it Hillbilly because I was stuck in a hotel room feeling really stupid right in the toool so it's",
    "start": "1870760",
    "end": "1877519"
  },
  {
    "text": "not an an it's not an analysis tool it's not going to say this dude hacked me at this time with this exploit that's not",
    "start": "1877519",
    "end": "1883679"
  },
  {
    "text": "what it does it's merely a tool to reduce the amount of data I have to look through if I'm doing an investigation",
    "start": "1883679",
    "end": "1890000"
  },
  {
    "text": "okay searches for odd URL request 500 errors and strange request",
    "start": "1890000",
    "end": "1895639"
  },
  {
    "text": "methods so here's the nasty syntax because I'm the worst Pearl coder in the world so we have- D what type of file is",
    "start": "1895639",
    "end": "1902840"
  },
  {
    "text": "it- L the log file- F where I want my results to go out DG to look for the odd",
    "start": "1902840",
    "end": "1908679"
  },
  {
    "text": "get request uh- P to look for 500 errors and- o to look for just the plain odd",
    "start": "1908679",
    "end": "1914240"
  },
  {
    "text": "request methods all right so basic basically the odd request or odd URL search just",
    "start": "1914240",
    "end": "1921559"
  },
  {
    "text": "performs a um most people probably call it a simple rex that took me like four hours to cook",
    "start": "1921559",
    "end": "1927600"
  },
  {
    "text": "up and it like never hardly worked for quite some time till I talked to somebody that actually knew how to write them and it's written in long hand and",
    "start": "1927600",
    "end": "1934480"
  },
  {
    "text": "anybody that knows minutes yeah it's pretty bad so basically it's going to look for car for",
    "start": "1934480",
    "end": "1940360"
  },
  {
    "text": "a requests that contain any characters other than those listed up there so anything that doesn't have has anything",
    "start": "1940360",
    "end": "1945679"
  },
  {
    "text": "other than any alpha numeric character a period a question mark U perent 20s a",
    "start": "1945679",
    "end": "1951880"
  },
  {
    "text": "URL encoded space uh some equal signs underscores Amper Sands and dashes so",
    "start": "1951880",
    "end": "1957679"
  },
  {
    "text": "those are all the things that I said hey these things probably generally occur in most URLs so if I'm getting anything",
    "start": "1957679",
    "end": "1963559"
  },
  {
    "text": "that contains something other than these it might be an attack okay so it pretty rapidly finds your unic code double",
    "start": "1963559",
    "end": "1969080"
  },
  {
    "text": "dcode cross-site scripting attacks SQL injection directory traversal all these things assuming they're over a get",
    "start": "1969080",
    "end": "1976159"
  },
  {
    "text": "request so here's what what happens when you uh run it through a a log file we'll see uh the IP addresses up there and",
    "start": "1976159",
    "end": "1982880"
  },
  {
    "text": "this is from the uh the white hat web server here so you see I have the top two or three they have offending uh",
    "start": "1982880",
    "end": "1988799"
  },
  {
    "text": "Slash on the end we got a good old Unicode attack there and there that's a double decode attack in the middle there",
    "start": "1988799",
    "end": "1994440"
  },
  {
    "text": "uh I don't know what the guy in the middle there is doing requesting a text file with an at Local Host thing on the",
    "start": "1994440",
    "end": "1999919"
  },
  {
    "text": "end um another weird request there so all these kind of weird requests come in",
    "start": "1999919",
    "end": "2005440"
  },
  {
    "text": "there's a guy looking for a formale vulnerability a couple there that's nice good spammer guy for male CGI like",
    "start": "2005440",
    "end": "2012399"
  },
  {
    "text": "that's going to be out there so here's some of the uh the reductions we get here so I run the um common log file",
    "start": "2012399",
    "end": "2018840"
  },
  {
    "text": "looking for odd request I get 107 entries if I do that against um the straight log file again it's 466,000 so",
    "start": "2018840",
    "end": "2026639"
  },
  {
    "text": "I got a p a significant difference in the amount of log file data I have to look",
    "start": "2026639",
    "end": "2032000"
  },
  {
    "text": "through okay so in the e-commerce site basically the log file reduction was a little bit more dramatic it came from",
    "start": "2032000",
    "end": "2037799"
  },
  {
    "text": "1.1 million to 285,000 still a lot of data to look through but now I have significantly less to look",
    "start": "2037799",
    "end": "2045279"
  },
  {
    "text": "through so 500 errors again looking for request any request that generates a 500",
    "start": "2045279",
    "end": "2050398"
  },
  {
    "text": "error could be indicative of SQL injection attack uh if you get a large number of them in a row over a short",
    "start": "2050399",
    "end": "2055919"
  },
  {
    "text": "period of time again you either have a broken ASP page CGI script or someone's trying to poke at your uh database back",
    "start": "2055919",
    "end": "2062358"
  },
  {
    "text": "in so in this case this is when we need to expand a little bit further from my my web application or my my web server",
    "start": "2062359",
    "end": "2068280"
  },
  {
    "text": "log I need to go back and look at the backend the SQL Server database or if I have a three- tier environment the",
    "start": "2068280",
    "end": "2073358"
  },
  {
    "text": "application server to see what's going on there and a little hint your time is synced right so you know everything is",
    "start": "2073359",
    "end": "2079000"
  },
  {
    "text": "what's happening on all your servers so in the OD request types from um I got",
    "start": "2079000",
    "end": "2084200"
  },
  {
    "text": "from the e-commerce site basically 1.1 million reduced to zero so they were getting no 500 errors on their site",
    "start": "2084200",
    "end": "2089638"
  },
  {
    "text": "which is probably uh pretty indicative that uh they're writing good code and they're good wrri they're writing good",
    "start": "2089639",
    "end": "2094960"
  },
  {
    "text": "filters on the front end so they're not letting any a request in so anything other than getting post we",
    "start": "2094960",
    "end": "2101200"
  },
  {
    "text": "can look at that by slashing on the o the- o on the end so basically what we're looking for here is probing",
    "start": "2101200",
    "end": "2106560"
  },
  {
    "text": "request or someone firing another odd HTP client at me so basically when we",
    "start": "2106560",
    "end": "2112640"
  },
  {
    "text": "ran that against the e-commerce site we got it reduced from 1.1 million to 2,000 so pretty nice reduction there now I",
    "start": "2112640",
    "end": "2119680"
  },
  {
    "text": "have no idea if that was actually right or not I just like stripped out a bunch of random characters oo tough crowd all right so",
    "start": "2119680",
    "end": "2127040"
  },
  {
    "text": "let's prepare for the worst so we need to configure our log server files we need to know where they are what they're doing and what they're logging we can uh",
    "start": "2127040",
    "end": "2133880"
  },
  {
    "text": "pop on some additional tools we've been pimping URL scan all day so might as well keep doing that uh mod protect",
    "start": "2133880",
    "end": "2139200"
  },
  {
    "text": "which is an Apache module that will actually log post request and we have code Seeker which is uh up on the OAS",
    "start": "2139200",
    "end": "2144720"
  },
  {
    "text": "site it's a web application firewall you can also use that to limit request limit request and uh probably log post",
    "start": "2144720",
    "end": "2151760"
  },
  {
    "text": "data so the other logs you need to look at are SQL Server logs because again if",
    "start": "2151760",
    "end": "2157119"
  },
  {
    "text": "I'm getting 500 request I should be logging on my SQL Server your DBA will whine incessantly about performance if",
    "start": "2157119",
    "end": "2162560"
  },
  {
    "text": "you do this and uh application server logs if you're using a three- tier environment make sure they're on make sure you understand what they're",
    "start": "2162560",
    "end": "2168960"
  },
  {
    "text": "saying and again you got your time synced right everybody has that I shouldn't even worry about that all your",
    "start": "2168960",
    "end": "2174200"
  },
  {
    "text": "time is correct so H an IDs this is something I",
    "start": "2174200",
    "end": "2179720"
  },
  {
    "text": "cooked up um probably after not a lot of sleep with Apache you can do a custom log file you can actually run it through",
    "start": "2179720",
    "end": "2186400"
  },
  {
    "text": "my Pearl script out put it to another log probably the worst thing you could do to your website but I want to throw it out there cuz I thought it was",
    "start": "2186400",
    "end": "2193240"
  },
  {
    "text": "cool all right so future plans for Hillbilly write some code that actually other people can read and use uh we're",
    "start": "2193240",
    "end": "2199160"
  },
  {
    "text": "going to release it and you can take a look at it but it's a little flaky so recognize and automatically parse web",
    "start": "2199160",
    "end": "2204920"
  },
  {
    "text": "server logs IIs if you're using w3c extended actually puts the format of log file on top of the log file so we should",
    "start": "2204920",
    "end": "2211680"
  },
  {
    "text": "be able to parse that quickly fill in where we need to fill in and and take a look at the log files another thing",
    "start": "2211680",
    "end": "2218000"
  },
  {
    "text": "right now that hillbilly doesn't do is it will pars look for all the odd requests whether they were successful",
    "start": "2218000",
    "end": "2223040"
  },
  {
    "text": "requests or not so if someone requested something it gave me a 44 error if it gave me uh some other error other than",
    "start": "2223040",
    "end": "2229880"
  },
  {
    "text": "200 or other than 500 I throw it up there anyways I don't really care right so it's probably you could throw on an",
    "start": "2229880",
    "end": "2236200"
  },
  {
    "text": "option that only looked for successful requests and limit the amount of data you have to look through tremendously",
    "start": "2236200",
    "end": "2241319"
  },
  {
    "text": "and again some sort of magic to profile the log um and actually look for truly deviant request uh this this might not",
    "start": "2241319",
    "end": "2248000"
  },
  {
    "text": "work so well on a on a live Internet site but what I'm thinking here is if you could take your Dev environment run",
    "start": "2248000",
    "end": "2253880"
  },
  {
    "text": "log files from your Dev environment through this then run your production log files you can see the truly deviant",
    "start": "2253880",
    "end": "2259359"
  },
  {
    "text": "request coming out of your log file I got hooked up on basy and filters for spam filtering for a while so this is",
    "start": "2259359",
    "end": "2264640"
  },
  {
    "text": "where I was trying to go and then I looked at that and figured out I was way too stupid to be dealing with that",
    "start": "2264640",
    "end": "2269760"
  },
  {
    "text": "pretty output right now it's really horrible output so anybody have any questions",
    "start": "2269760",
    "end": "2275640"
  },
  {
    "text": "like Kingo yeah I don't know I don't even know where I found",
    "start": "2275640",
    "end": "2281720"
  },
  {
    "text": "that have any questions we roll through that really quickly you have your demo up all right we're going to give this a",
    "start": "2281720",
    "end": "2287520"
  },
  {
    "text": "shot again",
    "start": "2287520",
    "end": "2290839"
  },
  {
    "text": "all right this is a uh a restored install from this is a Sony vile here so this is the uh very the first XB that",
    "start": "2328160",
    "end": "2334839"
  },
  {
    "text": "you get on the machine it's a clean uh install um I'm going to for those that are not",
    "start": "2334839",
    "end": "2340760"
  },
  {
    "text": "entirely familiar with JavaScript um I just post I just put in the JavaScript that we're using behind the three",
    "start": "2340760",
    "end": "2346440"
  },
  {
    "text": "buttons so the normal cookie button don't click on it yet um it sets the it",
    "start": "2346440",
    "end": "2352000"
  },
  {
    "text": "sets a cookie from in the Local Host domain to cookie name the cookie name as the cookie name and the cookie value as",
    "start": "2352000",
    "end": "2358359"
  },
  {
    "text": "the cookie value and then proceeds to alert you to show that the cookie actually got set so tag the button so we",
    "start": "2358359",
    "end": "2365200"
  },
  {
    "text": "see that a cookie got made and uh it alerted it so you can close that now",
    "start": "2365200",
    "end": "2370960"
  },
  {
    "text": "we're going to take a look at the uh IE only uh security mechanism for HTTP only",
    "start": "2370960",
    "end": "2376480"
  },
  {
    "text": "it's a little option you know kind of like pers persistent cookies or secure cookies you put HTP only at the end you",
    "start": "2376480",
    "end": "2382920"
  },
  {
    "text": "do the same type of a cookie set hit and you notice that the string",
    "start": "2382920",
    "end": "2388520"
  },
  {
    "text": "returns empty okay so HP only prevents JavaScript from actually reading the cookie data when HTTP only is on it's",
    "start": "2388520",
    "end": "2396240"
  },
  {
    "text": "interesting to note some weird Behavior I saw I saw that uh IE would not let you read the data but you could actually",
    "start": "2396240",
    "end": "2402240"
  },
  {
    "text": "still overwrite the data I don't know exactly what that means yet but it was kind of interesting so hit the show",
    "start": "2402240",
    "end": "2408400"
  },
  {
    "text": "cookie once and so we can see that the cookie is still being protected by HTP only so",
    "start": "2408400",
    "end": "2413720"
  },
  {
    "text": "we'll skip on down to the bottom here's where cross-site tracing comes into play the first function up on top there uses",
    "start": "2413720",
    "end": "2419599"
  },
  {
    "text": "an active X object Microsoft xmlhttp some very simple uh active X control to",
    "start": "2419599",
    "end": "2425200"
  },
  {
    "text": "send a trace request to a web server that's actually on this particular box okay and after it sends the request it",
    "start": "2425200",
    "end": "2432560"
  },
  {
    "text": "takes the response text from the you know from the web server that you get and alerts it so we'll see an output",
    "start": "2432560",
    "end": "2439040"
  },
  {
    "text": "from the web server after we sent the trace request so we sent the trace to the web",
    "start": "2439040",
    "end": "2445160"
  },
  {
    "text": "server it popped back okay and we're actually able to see the cookie data",
    "start": "2445160",
    "end": "2450440"
  },
  {
    "text": "even though it's being protected by HTTP only so we actually bypassed the HTP only protection using a Trace requ",
    "start": "2450440",
    "end": "2457920"
  },
  {
    "text": "since this is what actually came back from the server okay one sec hit it",
    "start": "2457920",
    "end": "2463680"
  },
  {
    "text": "again now had we authenticated to the particular Local Host web server via uh",
    "start": "2463680",
    "end": "2469599"
  },
  {
    "text": "basic authentication basic authentication headers would have been in that alert just like the your nlm",
    "start": "2469599",
    "end": "2476240"
  },
  {
    "text": "stuff and uh everything else everything that the server will respond with is in this so we no longer need",
    "start": "2476240",
    "end": "2482680"
  },
  {
    "text": "document.cookie to grab cookie data we can now access B basic authentication CR IAL all using uh ActiveX flash or",
    "start": "2482680",
    "end": "2491599"
  },
  {
    "text": "whatever you want anything that allows you to send an arbitrary HTTP request okay here's where it gets",
    "start": "2491599",
    "end": "2497920"
  },
  {
    "text": "infinitely more dangerous okay because that particular code can reside on any",
    "start": "2497920",
    "end": "2503079"
  },
  {
    "text": "public web server so let's say you're you know you're able to host content on a",
    "start": "2503079",
    "end": "2508640"
  },
  {
    "text": "large portal there's a lot of them and you can get somebody to see your page you can actually pick up any of their",
    "start": "2508640",
    "end": "2514000"
  },
  {
    "text": "cookies basic off credentials anything you want when you're able to read somebody's page and view this code which",
    "start": "2514000",
    "end": "2521800"
  },
  {
    "text": "uses a a uh a known known domain restriction bypass bug it will actually",
    "start": "2521800",
    "end": "2528079"
  },
  {
    "text": "connect don't touch it don't touch it it will actually connect to uh CNET and",
    "start": "2528079",
    "end": "2533960"
  },
  {
    "text": "send a trace request to them and you'll see what comes back no not yet not yet let's go to cnet.com in the other",
    "start": "2533960",
    "end": "2539359"
  },
  {
    "text": "browser window on the taskbar and just hit reload so CET when you go to cet.com it",
    "start": "2539359",
    "end": "2546240"
  },
  {
    "text": "sends you a it cookies you automatically so we know we have a cookie in the system so jump back over the other",
    "start": "2546240",
    "end": "2552319"
  },
  {
    "text": "browser and hit the cross site Trace wait uh actually one second hit show cookie",
    "start": "2552319",
    "end": "2557400"
  },
  {
    "text": "again so we're still not able to uh see the cookie data using JavaScript so hit",
    "start": "2557400",
    "end": "2564160"
  },
  {
    "text": "hit the button now you yeah I'm sure positive no um so right now using this page we're",
    "start": "2564160",
    "end": "2573240"
  },
  {
    "text": "actually able to send a cross site Trace domain restriction bypass bug bypass the",
    "start": "2573240",
    "end": "2580359"
  },
  {
    "text": "HP only cookie security and grab CET cookie using a trace request because CET",
    "start": "2580359",
    "end": "2587040"
  },
  {
    "text": "was nice enough to send it back after sending them a trace request Everybody follow",
    "start": "2587040",
    "end": "2595280"
  },
  {
    "text": "along okay so this is where this particular tag gets dangerous you can now you don't",
    "start": "2595280",
    "end": "2603000"
  },
  {
    "text": "okay at this point I reiterate you do not to cross-site script if you want to call this a cross site scripting attack",
    "start": "2603000",
    "end": "2608200"
  },
  {
    "text": "you do not need a vulnerable web application so over the last four years most of us has spent way too much time",
    "start": "2608200",
    "end": "2614520"
  },
  {
    "text": "trying to kill off vulnerable web applications uh you know actually kill off vulnerabilities to cross site",
    "start": "2614520",
    "end": "2620000"
  },
  {
    "text": "scripting our apps the problem with this one is we no longer going to need a vulnerable web app to perform a cross-site trace all we need is a trace",
    "start": "2620000",
    "end": "2626000"
  },
  {
    "text": "supporting web server so it gets very very dangerous now that's roughly it that's really all",
    "start": "2626000",
    "end": "2633200"
  },
  {
    "text": "there is to it will thats",
    "start": "2633200",
    "end": "2639880"
  },
  {
    "text": "cat at current patch levels um if you had a live domain restriction bug and",
    "start": "2639880",
    "end": "2644920"
  },
  {
    "text": "they come up like every couple of weeks it's the same type of attack it's not just remember it's not just active X or",
    "start": "2644920",
    "end": "2650119"
  },
  {
    "text": "IE if flash will allow you to do it if Java will allow you to do it it's really just an arbitrary Trace request and",
    "start": "2650119",
    "end": "2655680"
  },
  {
    "text": "it'll Echo back so it's not just like this particular code this is just how I coded one as a proof of concept",
    "start": "2655680",
    "end": "2662440"
  },
  {
    "text": "really um I'm not up to like you know the current IE bugs out there this is just one that I knew",
    "start": "2662440",
    "end": "2668599"
  },
  {
    "text": "worked",
    "start": "2668599",
    "end": "2671599"
  },
  {
    "text": "so right oh I'm sorry he asked if uh this",
    "start": "2676680",
    "end": "2682359"
  },
  {
    "text": "if if this particular current this particular current attack um works with",
    "start": "2682359",
    "end": "2688640"
  },
  {
    "text": "current patch levels the attack methodology Works whether or not using this particular",
    "start": "2688640",
    "end": "2694640"
  },
  {
    "text": "implementation of the attack probably not they might have fixed it I really couldn't say for sure um but as I was",
    "start": "2694640",
    "end": "2701760"
  },
  {
    "text": "commenting you could still use Flash still use Java another I control if you want anything that it supports it's just",
    "start": "2701760",
    "end": "2709280"
  },
  {
    "text": "HTTP at that point and there yes",
    "start": "2709280",
    "end": "2715760"
  },
  {
    "text": "sir all of them by default it's uh in the HTTP 1.1 RFC except for public",
    "start": "2717480",
    "end": "2725839"
  },
  {
    "text": "file um um so the trace Trace request it's it's really just an HTTP Echo you",
    "start": "2725839",
    "end": "2731920"
  },
  {
    "text": "send a trace request with whatever you want and it echoes back with whatever you gave it it's very simple so you just",
    "start": "2731920",
    "end": "2737240"
  },
  {
    "text": "bypassing I don't longer need docent do cookie to get whatever I want you have a",
    "start": "2737240",
    "end": "2745200"
  },
  {
    "text": "question see this is like a matter of like some concern some controversy I guess um I spoke to a lot of people",
    "start": "2752200",
    "end": "2757960"
  },
  {
    "text": "trying to figure out where the fix is whose problem it is and it might be the browser's problem it might be the",
    "start": "2757960",
    "end": "2763359"
  },
  {
    "text": "Technology's problem it might be the web server problem and it also might be the rfc's problem in the end the best",
    "start": "2763359",
    "end": "2769160"
  },
  {
    "text": "solution I could figure out you know with a with consensus is to distill out Trace because if you could fix it on the",
    "start": "2769160",
    "end": "2775359"
  },
  {
    "text": "browser side all day where where the basic problem is you're relying on the client side security at that point to",
    "start": "2775359",
    "end": "2781040"
  },
  {
    "text": "secure your uh to make sure you're secure not the pos position I want to be in personally",
    "start": "2781040",
    "end": "2787480"
  },
  {
    "text": "once the Ser yeah it's it's over the wire it's",
    "start": "2787480",
    "end": "2793000"
  },
  {
    "text": "there anybody else okay I think you know we're I'm sorry we're way we we're way under time",
    "start": "2793000",
    "end": "2800480"
  },
  {
    "text": "and uh yes sir like in the log it looks just like a",
    "start": "2800480",
    "end": "2805599"
  },
  {
    "text": "a oh the question from the back was what does it look like in the logs it just looks like a well most logs don't don't",
    "start": "2805599",
    "end": "2813000"
  },
  {
    "text": "log headers in the log file so you know you get like a get slash nor htb 1.1 it",
    "start": "2813000",
    "end": "2818319"
  },
  {
    "text": "just looks like a trace slash you know whatever you want to give it it just it",
    "start": "2818319",
    "end": "2823440"
  },
  {
    "text": "says Trace I mean you could see people are tracing you yeah my will find it so yeah so it yeah it just looks like a",
    "start": "2823440",
    "end": "2829720"
  },
  {
    "text": "trace request any other",
    "start": "2829720",
    "end": "2834920"
  },
  {
    "text": "questions all right um yeah if you any questions uh actually do we have like materials up somewhere yeah so materials",
    "start": "2834920",
    "end": "2841160"
  },
  {
    "text": "will be up on our website www.wi hat.com soon as we get down to the valley yeah as soon as we get back home so it be",
    "start": "2841160",
    "end": "2846559"
  },
  {
    "text": "next week um and if you have any questionss email is good dude it's my spot",
    "start": "2846559",
    "end": "2853240"
  },
  {
    "text": "sorry so um I'm sure you all going to want to get a video cassette copy of or a CD ROM of our riveting performance so",
    "start": "2853240",
    "end": "2860119"
  },
  {
    "text": "sound of knowledge has them outside we've been asked to announce that and there's a big shind dig at 6:00 on the",
    "start": "2860119",
    "end": "2865520"
  },
  {
    "text": "30 some floor top of the building so you can now that we've cut short time you",
    "start": "2865520",
    "end": "2871040"
  },
  {
    "text": "can go upstairs you can shower you can relax and then come down and drink heavily so thank you everybody for",
    "start": "2871040",
    "end": "2876960"
  },
  {
    "text": "coming we appreciate being [Applause]",
    "start": "2876960",
    "end": "2884380"
  },
  {
    "text": "here e",
    "start": "2905760",
    "end": "2909760"
  }
]