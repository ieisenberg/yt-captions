[
  {
    "text": "good morning um um thanks to be here in in this track",
    "start": "120",
    "end": "8679"
  },
  {
    "text": "um we are going to to talk about um HTTP",
    "start": "8679",
    "end": "14040"
  },
  {
    "text": "s trans for security and well something that that I have uh discovered",
    "start": "14040",
    "end": "22080"
  },
  {
    "text": "um my name is Jose and I I have been working in the security industry for the",
    "start": "22080",
    "end": "29400"
  },
  {
    "text": "last uh 10 years mainly in a in a penetration testing role and well some",
    "start": "29400",
    "end": "37000"
  },
  {
    "text": "years ago in other different fields uh I'm um uh I'm quite involved with the with",
    "start": "37000",
    "end": "45079"
  },
  {
    "text": "the S Institute uh as well I'm a a community instructor for the penetration",
    "start": "45079",
    "end": "51239"
  },
  {
    "text": "testing cses and uh well those are my my Twitter",
    "start": "51239",
    "end": "56840"
  },
  {
    "text": "account and my personal blog uh uh just in case you you would like to to to",
    "start": "56840",
    "end": "63680"
  },
  {
    "text": "follow me uh I strongly recommend you to follow if you want to choose one I I",
    "start": "63680",
    "end": "68960"
  },
  {
    "text": "recommend you to follow my Twitter because my blog is uh almost 100%",
    "start": "68960",
    "end": "74280"
  },
  {
    "text": "written in Spanish so if you can read Spanish probably you are going to to prefer to to follow my Twitter that is",
    "start": "74280",
    "end": "81840"
  },
  {
    "text": "90% written in English",
    "start": "81840",
    "end": "87280"
  },
  {
    "text": "so uh first of all I would like to to point out that uh well we are going to",
    "start": "87280",
    "end": "94399"
  },
  {
    "text": "talk today about some well some a technique that I have been testing but",
    "start": "94399",
    "end": "100000"
  },
  {
    "text": "uh well this is not a a silver bullet it's not a vulnerability that you can use to to own the whole internet uh but",
    "start": "100000",
    "end": "108880"
  },
  {
    "text": "it's still interesting and in the certain circumstances you can use them",
    "start": "108880",
    "end": "114079"
  },
  {
    "text": "in order to to bypass the HTTP uh sck Transport Security so what I have what I",
    "start": "114079",
    "end": "120960"
  },
  {
    "text": "have found with my research is what I would like to share with",
    "start": "120960",
    "end": "126038"
  },
  {
    "text": "you so let's go this is the uh the road map of the the speak uh",
    "start": "126360",
    "end": "134519"
  },
  {
    "text": "probably well some parts of the of the uh of the Road M are hidden because it's",
    "start": "134519",
    "end": "141120"
  },
  {
    "text": "a a surprise and uh well I would like to to make a brief uh review of of some",
    "start": "141120",
    "end": "149440"
  },
  {
    "text": "different techniques that people have used in the past for bypassing well SSL because I know that probably most of you",
    "start": "149440",
    "end": "156080"
  },
  {
    "text": "are Security Experts but I prefer to just spend three minutes in this part",
    "start": "156080",
    "end": "163319"
  },
  {
    "text": "and uh because if there are people that are not experts in this field uh it's",
    "start": "163319",
    "end": "169319"
  },
  {
    "text": "going to be useful to have to set the context of uh that we are going to talk",
    "start": "169319",
    "end": "175800"
  },
  {
    "text": "about so probably the oldest one is the uh to use a a self signed uh certificate",
    "start": "176319",
    "end": "183560"
  },
  {
    "text": "this is uh uh well a technique that is really uh quick and and Dy and warning",
    "start": "183560",
    "end": "192400"
  },
  {
    "text": "message is shown but users usually accepted I have been doing penetration",
    "start": "192400",
    "end": "199640"
  },
  {
    "text": "testing services for the last 10 years and still today I'm surprised that how many people just click accept so it's a",
    "start": "199640",
    "end": "208959"
  },
  {
    "text": "a useful bypassing technique uh still today we have seen uh attacks against PK",
    "start": "208959",
    "end": "219599"
  },
  {
    "text": "pki um different ways uh certification authorities that that has been",
    "start": "219599",
    "end": "226439"
  },
  {
    "text": "compromised and well other uh collisions in the in the uh signature of the",
    "start": "226439",
    "end": "233120"
  },
  {
    "text": "certificates and other kind of of attacks that are other way to attack the",
    "start": "233120",
    "end": "239480"
  },
  {
    "text": "uh the SSL we have seen some design weaknesses",
    "start": "239480",
    "end": "245959"
  },
  {
    "text": "and those one uh well it's the the first time that I saw those techniques",
    "start": "245959",
    "end": "251760"
  },
  {
    "text": "especially what crime breach uh that made me recall the um the film the",
    "start": "251760",
    "end": "258680"
  },
  {
    "text": "second part of Terminator 2 have you seen the second part of Terminator 2 the",
    "start": "258680",
    "end": "263960"
  },
  {
    "text": "J JN corner is is hacking an ATM and is uh getting digit by digit the",
    "start": "263960",
    "end": "270320"
  },
  {
    "text": "the pin the p uh and this is something that when I",
    "start": "270320",
    "end": "275360"
  },
  {
    "text": "saw the film I I I I thought it never happens you need the the the whole war",
    "start": "275360",
    "end": "280440"
  },
  {
    "text": "in order to try the whole War once and another time and on the next war and you can you can find a password character by",
    "start": "280440",
    "end": "287800"
  },
  {
    "text": "character and this is like hacking like in the movies right and well some cool",
    "start": "287800",
    "end": "297199"
  },
  {
    "text": "techniques we I I think this this was the the year of the the weaknesses in",
    "start": "297759",
    "end": "305840"
  },
  {
    "text": "implementation weaknesses in in SSL uh you know the her bed and the the Apple",
    "start": "305840",
    "end": "312720"
  },
  {
    "text": "go to fail um also known as the the Apple developer that thought he was coding",
    "start": "312720",
    "end": "320080"
  },
  {
    "text": "Python and um the kind of attacks that we are going to to focus today is the",
    "start": "322039",
    "end": "328160"
  },
  {
    "text": "stripping attacks uh it's completely different it's a completely different approach than the other ones the other",
    "start": "328160",
    "end": "334039"
  },
  {
    "text": "ones for example the design and and implementation that we have seen um the",
    "start": "334039",
    "end": "340720"
  },
  {
    "text": "the key point is to uh break the the encryption and with a stripping attacks",
    "start": "340720",
    "end": "348360"
  },
  {
    "text": "what an attacker tries is to to bypass uh not to allow to the uh an encryption",
    "start": "348360",
    "end": "354960"
  },
  {
    "text": "an encrypted channel so how it works",
    "start": "354960",
    "end": "361280"
  },
  {
    "text": "when the when the client makes a an HTTP connection then the the response is um",
    "start": "361280",
    "end": "369680"
  },
  {
    "text": "intercepted by the attacker and all the https links are written into",
    "start": "369680",
    "end": "376880"
  },
  {
    "text": "http1 there there are only other changes uh for example in the cookies properties",
    "start": "377680",
    "end": "383960"
  },
  {
    "text": "and and so on uh but the the goal is to",
    "start": "383960",
    "end": "389039"
  },
  {
    "text": "to keep the user using HTTP I mean if you visit a website and all the https",
    "start": "389039",
    "end": "395120"
  },
  {
    "text": "links are written into HTTP ones when you click other links you are always in",
    "start": "395120",
    "end": "402280"
  },
  {
    "text": "HTTP so it's a way to avoid connecting in a secure",
    "start": "402280",
    "end": "408440"
  },
  {
    "text": "way so uh what is HTTP strict Transport",
    "start": "408440",
    "end": "414599"
  },
  {
    "text": "Security well I discovered this while I was doing a a security SD assessment uh",
    "start": "414599",
    "end": "420479"
  },
  {
    "text": "some years ago um it was published around 2 years ago uh well it's hsts and",
    "start": "420479",
    "end": "428319"
  },
  {
    "text": "we are going to uh talk about hsts in in the in the talk because it's shorter and",
    "start": "428319",
    "end": "435840"
  },
  {
    "text": "the goal of this protection is to prevent uh mainly two things one is to",
    "start": "435840",
    "end": "440919"
  },
  {
    "text": "prevent the user from um uh browsing using HTTP uh for some hosts and the other one",
    "start": "440919",
    "end": "448479"
  },
  {
    "text": "is prevent the user from accepting self-signed certificates right",
    "start": "448479",
    "end": "454360"
  },
  {
    "text": "um it the there is a new uh header that is called stct Transport Security that",
    "start": "454360",
    "end": "460319"
  },
  {
    "text": "is the that is used for this um security",
    "start": "460319",
    "end": "465440"
  },
  {
    "text": "feature but who uses hsts well the at first side you see and statistic like",
    "start": "466840",
    "end": "475039"
  },
  {
    "text": "that and say well you are you have been researching about the security feature",
    "start": "475039",
    "end": "480759"
  },
  {
    "text": "that nobody uses right and say well if you look it's true that if you look at",
    "start": "480759",
    "end": "487080"
  },
  {
    "text": "the Alexa Lis for for example um most uh",
    "start": "487080",
    "end": "492639"
  },
  {
    "text": "most observers uh don't use this this protection and uh even well I I had a",
    "start": "492639",
    "end": "502000"
  },
  {
    "text": "quick look on the on the um well I'm I'm from Spain and I I look uh so the banks",
    "start": "502000",
    "end": "508520"
  },
  {
    "text": "in Spain that are companies that should be as as well protected as possible and",
    "start": "508520",
    "end": "515000"
  },
  {
    "text": "they don't use it but so um you can think well who cares about St Transport",
    "start": "515000",
    "end": "522680"
  },
  {
    "text": "Security if nobody uses well the point is that just a few servers in the web",
    "start": "522680",
    "end": "528320"
  },
  {
    "text": "servers in the internet use uh stick tort security but um the key uh service",
    "start": "528320",
    "end": "536279"
  },
  {
    "text": "and software providers in the internet use uh this protection so it's uh now",
    "start": "536279",
    "end": "542959"
  },
  {
    "text": "it's a bit more interesting",
    "start": "542959",
    "end": "546600"
  },
  {
    "text": "right how it works well the it's uh it's pretty easy when there's a https",
    "start": "548680",
    "end": "556519"
  },
  {
    "text": "connection um the client makes a request the server respondes with uh the header",
    "start": "556519",
    "end": "562600"
  },
  {
    "text": "stick security and well some parameters one of the parameters says that uh what",
    "start": "562600",
    "end": "568399"
  },
  {
    "text": "amount of time the browser uh should force the user to browse in",
    "start": "568399",
    "end": "574279"
  },
  {
    "text": "HTTPS uh for example if uh if I have my website.com uh and I send 3 million",
    "start": "574279",
    "end": "582279"
  },
  {
    "text": "seconds around 3 million seconds to the to the client then the the the user are not",
    "start": "582279",
    "end": "589040"
  },
  {
    "text": "going to be able to browse my site in a using via HTTP because even if they type",
    "start": "589040",
    "end": "596760"
  },
  {
    "text": "if he types um with HTTP uh mysite.com",
    "start": "596760",
    "end": "603279"
  },
  {
    "text": "the B is going to to use",
    "start": "603279",
    "end": "608480"
  },
  {
    "text": "https but of course well the there are there are two two main parameters Max H that is",
    "start": "609720",
    "end": "616839"
  },
  {
    "text": "the the amount of seconds that the the the policy is going to to be enabled the",
    "start": "616839",
    "end": "623920"
  },
  {
    "text": "we have a special value that is Max H zero that means uh that the policy",
    "start": "623920",
    "end": "629720"
  },
  {
    "text": "should be deleted uh of course a only accept this this header if uh if if we",
    "start": "629720",
    "end": "638040"
  },
  {
    "text": "are uh requesting the well if the request is in",
    "start": "638040",
    "end": "643440"
  },
  {
    "text": "BPS and well maxage is mandatory and there there is another optional parameter that is includes subdomains",
    "start": "643440",
    "end": "650839"
  },
  {
    "text": "that if if it's present it means that if in not present it means that the policy applies just to the the site that you",
    "start": "650839",
    "end": "657839"
  },
  {
    "text": "are visiting and if it's if it appears it means that uh the policy applies to",
    "start": "657839",
    "end": "664639"
  },
  {
    "text": "the that website and all the subdomains okay I have used well a small",
    "start": "664639",
    "end": "671399"
  },
  {
    "text": "script that I'm going to publish hsds catcher that is just gets the the the",
    "start": "671399",
    "end": "678320"
  },
  {
    "text": "head that head it's easy than than use bar or any other",
    "start": "678320",
    "end": "684880"
  },
  {
    "text": "proxy but of course the the the SEC this persu",
    "start": "685760",
    "end": "691120"
  },
  {
    "text": "protection is not not just um sending a a header uh in fact the the browser uh",
    "start": "691120",
    "end": "699480"
  },
  {
    "text": "makes all the hard work in fact so the browser should support it and and know",
    "start": "699480",
    "end": "705880"
  },
  {
    "text": "how to manage that head uh most major um",
    "start": "705880",
    "end": "711920"
  },
  {
    "text": "desktop browers support this this feature uh Internet Explorer as far as I",
    "start": "711920",
    "end": "720040"
  },
  {
    "text": "know is going to support it by the in the version",
    "start": "720040",
    "end": "725160"
  },
  {
    "text": "12 but not now as far as I know and well there are another browers",
    "start": "725160",
    "end": "732000"
  },
  {
    "text": "mobile browers um I have focused on on desktop browsers because uh I thought",
    "start": "732000",
    "end": "739079"
  },
  {
    "text": "that uh in the mobile phones people are using more the application instead of",
    "start": "739079",
    "end": "745000"
  },
  {
    "text": "the the browser for connecting to Twitter or Gmail or what",
    "start": "745000",
    "end": "750880"
  },
  {
    "text": "server so we have an https connection the",
    "start": "752160",
    "end": "759120"
  },
  {
    "text": "policy uh is set and we have that the user are is going to be uh quite well",
    "start": "759120",
    "end": "767320"
  },
  {
    "text": "protected uh during the following 3 million seconds right around 3 million seconds so we can reach him the US the",
    "start": "767320",
    "end": "776000"
  },
  {
    "text": "user is quite feels quite safe quite well well protected",
    "start": "776000",
    "end": "781600"
  },
  {
    "text": "right but there is even uh another",
    "start": "784399",
    "end": "790560"
  },
  {
    "text": "security feature in the uh in the STI t Security there's a a preloaded list of",
    "start": "790560",
    "end": "799360"
  },
  {
    "text": "of hosts uh that host those hosts are well Google Twitter PayPal the most",
    "start": "799360",
    "end": "806440"
  },
  {
    "text": "wellknown uh host and the the point of this protection is that uh",
    "start": "806440",
    "end": "814199"
  },
  {
    "text": "well if you install the browser for the first time or you clean the cats then um",
    "start": "814199",
    "end": "820959"
  },
  {
    "text": "the it's clean as well the the like the the catch of stick Transport Security uh",
    "start": "820959",
    "end": "828000"
  },
  {
    "text": "so there is a a period of time from that point to the first stps connection uh",
    "start": "828000",
    "end": "835040"
  },
  {
    "text": "when the the the user is going to be uh vulnerable to to to a stripping attack",
    "start": "835040",
    "end": "841880"
  },
  {
    "text": "so PR hsds is the the answer of of process such as fifox or Chrome to to",
    "start": "841880",
    "end": "848720"
  },
  {
    "text": "that to that thread so well we know now how hsds",
    "start": "848720",
    "end": "858279"
  },
  {
    "text": "works so let's see some weaknesses or some or the weakness that they have",
    "start": "858279",
    "end": "863440"
  },
  {
    "text": "found well there are some others one of them is to use a a low",
    "start": "863440",
    "end": "869880"
  },
  {
    "text": "value uh when I when I was seeing I don't know if you PID attention to a uh",
    "start": "869880",
    "end": "876320"
  },
  {
    "text": "to that slide uh the max AG of paper it's uh",
    "start": "876320",
    "end": "883399"
  },
  {
    "text": "it's quite low",
    "start": "883399",
    "end": "888639"
  },
  {
    "text": "so if it's uh 14,000 or something like like that",
    "start": "889160",
    "end": "897560"
  },
  {
    "text": "seconds okay so it's uh this amount of seconds",
    "start": "897680",
    "end": "903560"
  },
  {
    "text": "are around for well around no are uh exactly for ORS so what happen if you",
    "start": "903560",
    "end": "910240"
  },
  {
    "text": "use a a short value for Max H it means that if a user visits paper and is not",
    "start": "910240",
    "end": "918440"
  },
  {
    "text": "visiting Pap in the following four hours the next connection is not going to be",
    "start": "918440",
    "end": "923839"
  },
  {
    "text": "protected by this feature uh so in uh at night time well if you leave",
    "start": "923839",
    "end": "931800"
  },
  {
    "text": "your office uh in the afternoon and then you when you arrive at the morning you are vulnerable to stripping",
    "start": "931800",
    "end": "938480"
  },
  {
    "text": "attacks uh well even maybe well know even in a Spanish L time L time is not",
    "start": "938480",
    "end": "944440"
  },
  {
    "text": "enough time but in night time is enough for attacking so you don't need another",
    "start": "944440",
    "end": "950560"
  },
  {
    "text": "bypass you just need to to wait to the following",
    "start": "950560",
    "end": "956279"
  },
  {
    "text": "day there is another technique this guy is called Leonard is an old friend and",
    "start": "956279",
    "end": "962399"
  },
  {
    "text": "an old work mate and he presented at at uh black hat Asia a few months ago um a",
    "start": "962399",
    "end": "971480"
  },
  {
    "text": "technique that well you know that that the the protection is based on the name",
    "start": "971480",
    "end": "977160"
  },
  {
    "text": "of the host so what they what he do what what he did was to um to uh look for a a",
    "start": "977160",
    "end": "986600"
  },
  {
    "text": "host name for example in the in in his demo um he used Google because the",
    "start": "986600",
    "end": "993079"
  },
  {
    "text": "mail.google.com is protected by hsds but the main Google website is not so what",
    "start": "993079",
    "end": "1001440"
  },
  {
    "text": "he did was to to SL slightly change the name of the links in the main website in",
    "start": "1001440",
    "end": "1007920"
  },
  {
    "text": "Google for example if you are going to be redirected to accounts.google.com",
    "start": "1007920",
    "end": "1013319"
  },
  {
    "text": "uh he changed the name to to accounts with three C instead of two and this is",
    "start": "1013319",
    "end": "1021279"
  },
  {
    "text": "a completely different host the user probably are is seeing the the same in",
    "start": "1021279",
    "end": "1026319"
  },
  {
    "text": "the in the browser but the it's a completely different host and is not protected by",
    "start": "1026319",
    "end": "1032558"
  },
  {
    "text": "hsds so this was a technique that he uses he",
    "start": "1032559",
    "end": "1038678"
  },
  {
    "text": "used so this is not there just a couple of examples but the the technique that",
    "start": "1038679",
    "end": "1044558"
  },
  {
    "text": "we are going to to focus on is uh different and this is something that this is what",
    "start": "1044559",
    "end": "1051720"
  },
  {
    "text": "I I was seeing while I was uh researching that uh sometimes you are",
    "start": "1051720",
    "end": "1056840"
  },
  {
    "text": "too close to the problem and you see the wall and the wall and try to see a hole in the wall and there isn't any hole in",
    "start": "1056840",
    "end": "1063400"
  },
  {
    "text": "the wall and you don't know what to do uh but sometimes it helps if you just",
    "start": "1063400",
    "end": "1070440"
  },
  {
    "text": "step back because sometimes when you step back there is a door uh and you are",
    "start": "1070440",
    "end": "1075799"
  },
  {
    "text": "a pck loock master so you have you have have uh the know the knowledge to do",
    "start": "1075799",
    "end": "1081559"
  },
  {
    "text": "some things with that and that what happened with this",
    "start": "1081559",
    "end": "1087360"
  },
  {
    "text": "vulnerability so the our situation the Waldo is uh",
    "start": "1087360",
    "end": "1095520"
  },
  {
    "text": "feeling uh quite safe behind the wall and we can reach him right but what",
    "start": "1095520",
    "end": "1102080"
  },
  {
    "text": "happened if we could if we had a time machine and we could um get in the time",
    "start": "1102080",
    "end": "1109679"
  },
  {
    "text": "machine uh both or Target and us and go to the Future far enough uh to make the",
    "start": "1109679",
    "end": "1119720"
  },
  {
    "text": "to far enough than that 3 million seconds right the there's a the the HS",
    "start": "1119840",
    "end": "1127960"
  },
  {
    "text": "catch will expire right so it's easy you just need a we just need a time",
    "start": "1127960",
    "end": "1135200"
  },
  {
    "text": "machine Okay so if we have that time",
    "start": "1135320",
    "end": "1142679"
  },
  {
    "text": "machine we can go to the Future and then everything is going to spire and",
    "start": "1145480",
    "end": "1151640"
  },
  {
    "text": "Waldo is going to be quite worried now right because he's within",
    "start": "1151640",
    "end": "1158559"
  },
  {
    "text": "range okay but what happens with we say that",
    "start": "1158600",
    "end": "1163720"
  },
  {
    "text": "there is a an additional protection they pre-loaded h hsd list",
    "start": "1163720",
    "end": "1170080"
  },
  {
    "text": "right um what we say says about this is that the host that are in in that list",
    "start": "1170080",
    "end": "1178520"
  },
  {
    "text": "are configured out of the box uh but they they don't specify",
    "start": "1178520",
    "end": "1184320"
  },
  {
    "text": "exactly how it works or any other details just say that they just did",
    "start": "1184320",
    "end": "1192799"
  },
  {
    "text": "that Firefox says um more or less the same says that hsds that that those host",
    "start": "1193280",
    "end": "1201480"
  },
  {
    "text": "are HSS enforced by default uh but so",
    "start": "1201480",
    "end": "1206559"
  },
  {
    "text": "when when I when I read this for the first time what I thought was the well",
    "start": "1206559",
    "end": "1211720"
  },
  {
    "text": "this is like similar to um like a certificate pinning right it's uh",
    "start": "1211720",
    "end": "1218440"
  },
  {
    "text": "everything um it's going to be protected those host are going to be protective forever because it's like her code",
    "start": "1218440",
    "end": "1226320"
  },
  {
    "text": "right even if when when I um uh when I uh told to talk to to",
    "start": "1226320",
    "end": "1235600"
  },
  {
    "text": "people about the the max age time uh What uh what they told me was that uh",
    "start": "1235600",
    "end": "1242480"
  },
  {
    "text": "the same as fir Fox they is not it's not a worry for uh it's",
    "start": "1242480",
    "end": "1247799"
  },
  {
    "text": "not a problem for for them to to use a l value because um payal is in the in the",
    "start": "1247799",
    "end": "1254880"
  },
  {
    "text": "preloaded list so it's enforced by default and the that value uh doesn't",
    "start": "1254880",
    "end": "1261440"
  },
  {
    "text": "matter right well they they told me another thing that I don't understand",
    "start": "1261440",
    "end": "1266840"
  },
  {
    "text": "very well as a security feature at every page in the paypal.com domain is render over",
    "start": "1266840",
    "end": "1272480"
  },
  {
    "text": "HPS I don't know if it's an important to make a bridge between HTTP and",
    "start": "1272480",
    "end": "1278799"
  },
  {
    "text": "https but the real truth is that um the pre-loaded hsds list uh are",
    "start": "1278799",
    "end": "1287279"
  },
  {
    "text": "pre-loaded not static uh it seems It's s the same but it's an an important",
    "start": "1287279",
    "end": "1294200"
  },
  {
    "text": "difference there uh when a host is configured in the hsds",
    "start": "1294200",
    "end": "1301000"
  },
  {
    "text": "list um there's a a default value that is loaded in the in the cats but they're",
    "start": "1301000",
    "end": "1309919"
  },
  {
    "text": "going to be that value is going to be updated and it's going to be outdated in",
    "start": "1309919",
    "end": "1315039"
  },
  {
    "text": "the same way that a dynamic one right it's exactly the",
    "start": "1315039",
    "end": "1320520"
  },
  {
    "text": "same in fact um if we look at the chromium",
    "start": "1320520",
    "end": "1326080"
  },
  {
    "text": "source code for example uh well I'm not 100% sure that this is the proper piece",
    "start": "1326080",
    "end": "1331720"
  },
  {
    "text": "of code because I haven't set a worko there but uh I did uh some keyword I",
    "start": "1331720",
    "end": "1340039"
  },
  {
    "text": "searched for some keywords and it seems that I'm pretty sure that this is",
    "start": "1340039",
    "end": "1345720"
  },
  {
    "text": "the the the piece of code the proper piece of code",
    "start": "1345720",
    "end": "1351520"
  },
  {
    "text": "and uh well as you can see the when when a host is uh preload in",
    "start": "1351520",
    "end": "1360799"
  },
  {
    "text": "the preloaded list it's uh the it's like uh using a max age of uh thousand uh a",
    "start": "1360799",
    "end": "1367960"
  },
  {
    "text": "thousand days right so it's not forever it's forever is Thousand Days right you",
    "start": "1367960",
    "end": "1375720"
  },
  {
    "text": "can tell your girlfriends and forever is a thousand days um uh no don't tell",
    "start": "1375720",
    "end": "1383480"
  },
  {
    "text": "don't tell her please so there is an",
    "start": "1383480",
    "end": "1388640"
  },
  {
    "text": "exception there it's uh Apple Safari Apple Safari there's a a file hsts",
    "start": "1388640",
    "end": "1397440"
  },
  {
    "text": "pist uh and there's a special value that I I have never seen before that is the",
    "start": "1397440",
    "end": "1406000"
  },
  {
    "text": "the INF or minus INF uh and I can tell you the difference",
    "start": "1406000",
    "end": "1412880"
  },
  {
    "text": "I I don't know the difference between one and the other but what I what I can tell you is that a host that is um",
    "start": "1412880",
    "end": "1420120"
  },
  {
    "text": "protected with this value is uh protected forever",
    "start": "1420120",
    "end": "1426080"
  },
  {
    "text": "right so let's see a AO about this I",
    "start": "1426400",
    "end": "1432200"
  },
  {
    "text": "have uh I have a and un to box",
    "start": "1432200",
    "end": "1441880"
  },
  {
    "text": "here okay I don't know if well more or",
    "start": "1443760",
    "end": "1448520"
  },
  {
    "text": "less we are going to configure an EP table",
    "start": "1450840",
    "end": "1456840"
  },
  {
    "text": "rule to intercept the HTTP connections uh to a fake",
    "start": "1456840",
    "end": "1463120"
  },
  {
    "text": "website and now",
    "start": "1463120",
    "end": "1469080"
  },
  {
    "text": "we're going to see what dat is it we are going to visit a website may.",
    "start": "1469080",
    "end": "1478080"
  },
  {
    "text": "google.com for",
    "start": "1478080",
    "end": "1481158"
  },
  {
    "text": "example HS https right because it's protected and now we are going to do",
    "start": "1483480",
    "end": "1491159"
  },
  {
    "text": "something uh we're going to do the test and we are going to",
    "start": "1491159",
    "end": "1496440"
  },
  {
    "text": "change the time 3 years in the future",
    "start": "1496440",
    "end": "1503000"
  },
  {
    "text": "right no 3 years in the future",
    "start": "1503000",
    "end": "1510399"
  },
  {
    "text": "okay and now let's see what happens this is a highrisk demo because",
    "start": "1511000",
    "end": "1517600"
  },
  {
    "text": "I'm using the internet so if not okay have you SE the",
    "start": "1517600",
    "end": "1525080"
  },
  {
    "text": "difference what the difference has one okay can you see the difference now we",
    "start": "1525080",
    "end": "1530720"
  },
  {
    "text": "are bring HTTP the",
    "start": "1530720",
    "end": "1536240"
  },
  {
    "text": "the well the HD the H SS protection has aspir",
    "start": "1536240",
    "end": "1543520"
  },
  {
    "text": "right we're going to see another demo later",
    "start": "1543520",
    "end": "1550200"
  },
  {
    "text": "so well but this is uh really useful because I have access to the to the",
    "start": "1552440",
    "end": "1557840"
  },
  {
    "text": "desktop so if you can change my my clock in this way hsts is the less that I'm",
    "start": "1557840",
    "end": "1565120"
  },
  {
    "text": "worry about but uh could we do something like that uh across the",
    "start": "1565120",
    "end": "1572840"
  },
  {
    "text": "network yeah because uh almost the all the computers all the desktop computers uh",
    "start": "1573600",
    "end": "1580919"
  },
  {
    "text": "nowadays use NTV for time synchronization so um the protocol",
    "start": "1580919",
    "end": "1588120"
  },
  {
    "text": "supports some kind of authentication and but it's not used by default in most",
    "start": "1588120",
    "end": "1594440"
  },
  {
    "text": "major operating system so it's easy to the how it works",
    "start": "1594440",
    "end": "1602360"
  },
  {
    "text": "uh when uh when your your laptop is saying hey it's that time and the the",
    "start": "1602360",
    "end": "1607919"
  },
  {
    "text": "server is answering with a with a current date or well",
    "start": "1607919",
    "end": "1614320"
  },
  {
    "text": "right so uh this is the uh the packet we have different fields",
    "start": "1614320",
    "end": "1622240"
  },
  {
    "text": "right and well there are two kind of dates 32 bits",
    "start": "1622240",
    "end": "1628760"
  },
  {
    "text": "and and 62 64 bits uh first half for second second half for",
    "start": "1628760",
    "end": "1635679"
  },
  {
    "text": "fractions just information about ntp uh here you have an an example the packets",
    "start": "1635679",
    "end": "1641559"
  },
  {
    "text": "for um requests and response are uh the same but there are some uh fields that",
    "start": "1641559",
    "end": "1649960"
  },
  {
    "text": "only the server is going to pay attention and another that going to pay attention the the the",
    "start": "1649960",
    "end": "1656720"
  },
  {
    "text": "server so what the the man in the mid attack will be if when the victim asks",
    "start": "1656720",
    "end": "1663440"
  },
  {
    "text": "for request a a Time synchronization we are going to answer with a f different",
    "start": "1663440",
    "end": "1669000"
  },
  {
    "text": "date for example that one",
    "start": "1669000",
    "end": "1673799"
  },
  {
    "text": "right so when I look for man man in the middle tools for",
    "start": "1676039",
    "end": "1682080"
  },
  {
    "text": "ntp I haven't found I haven't find from anything uh so we have I had two options",
    "start": "1682080",
    "end": "1689919"
  },
  {
    "text": "to use a modified ntp server or to program a new tool so what I did is to",
    "start": "1689919",
    "end": "1696039"
  },
  {
    "text": "to prr a tool that is called dorean and you have it's in that link um now it's a",
    "start": "1696039",
    "end": "1704360"
  },
  {
    "text": "private link but I'm going to to make it public in the following hours or tomorrow or something like that",
    "start": "1704360",
    "end": "1712398"
  },
  {
    "text": "okay uh you have um the default um the",
    "start": "1712440",
    "end": "1718320"
  },
  {
    "text": "default uh way of work is uh the DeLorean is going to to",
    "start": "1718320",
    "end": "1724880"
  },
  {
    "text": "find a date at least uh a thousand day in the future that will be the the same",
    "start": "1724880",
    "end": "1731519"
  },
  {
    "text": "day in the month than today and the same week day than today because sometimes in some operating system in the system",
    "start": "1731519",
    "end": "1737480"
  },
  {
    "text": "clock is shown some of this uh information and if not you can set up",
    "start": "1737480",
    "end": "1742799"
  },
  {
    "text": "you can use um a step that is like a relative jump into the future I want to",
    "start": "1742799",
    "end": "1749399"
  },
  {
    "text": "be I want you to answer always 10 10 days in the future or you can to choose",
    "start": "1749399",
    "end": "1754799"
  },
  {
    "text": "a static day I want that you answer always that day and time",
    "start": "1754799",
    "end": "1761760"
  },
  {
    "text": "okay so we're going to make the demo to see",
    "start": "1761760",
    "end": "1767120"
  },
  {
    "text": "if if it works I'm going to",
    "start": "1767120",
    "end": "1772159"
  },
  {
    "text": "use a no a maos",
    "start": "1772159",
    "end": "1777720"
  },
  {
    "text": "x where's the MOs x what where's the maos",
    "start": "1777840",
    "end": "1783720"
  },
  {
    "text": "X okay so I will talk and talk but it's",
    "start": "1783720",
    "end": "1792360"
  },
  {
    "text": "uh but it's even more fun if if well what's hacking with music sing",
    "start": "1792360",
    "end": "1798480"
  },
  {
    "text": "[Music]",
    "start": "1798480",
    "end": "1814900"
  },
  {
    "text": "[Applause] [Music]",
    "start": "1814900",
    "end": "1825518"
  },
  {
    "text": "right [Music]",
    "start": "1826240",
    "end": "1836460"
  },
  {
    "text": "[Music]",
    "start": "1838720",
    "end": "1841809"
  },
  {
    "text": "[Music]",
    "start": "1847770",
    "end": "1856029"
  },
  {
    "text": "oh [Music]",
    "start": "1856240",
    "end": "1945039"
  },
  {
    "text": "oh",
    "start": "1946080",
    "end": "1949080"
  },
  {
    "text": "[Music] so this is the",
    "start": "1951720",
    "end": "1957360"
  },
  {
    "text": "[Music] demo so it seems that it works",
    "start": "1957360",
    "end": "1967159"
  },
  {
    "text": "[Applause] right okay so I told you that the is an a super bullet right right right um why",
    "start": "1971020",
    "end": "1978760"
  },
  {
    "text": "I told you that because there are the time synchronization Works in a different way in different operating",
    "start": "1978760",
    "end": "1984320"
  },
  {
    "text": "systems uh for example in and sometimes it works and sometimes not um for",
    "start": "1984320",
    "end": "1990960"
  },
  {
    "text": "example in un to Linux uh uh the time synchronization is is done uh it's",
    "start": "1990960",
    "end": "1997000"
  },
  {
    "text": "network connection or a time so you have to be there when uh well if you have the",
    "start": "1997000",
    "end": "2002919"
  },
  {
    "text": "control of the physical layer you can just uh Force the the user to uh",
    "start": "2002919",
    "end": "2009240"
  },
  {
    "text": "disconnect and then wait for them for him to reconnect Fedora it's uh it's easy",
    "start": "2009240",
    "end": "2017440"
  },
  {
    "text": "because it's uh there's a ntp demon that is uh synchronizing each minute you have",
    "start": "2017440",
    "end": "2023039"
  },
  {
    "text": "to wait for 11 minutes because there are another process that is uh well the demon is writing in a file and there",
    "start": "2023039",
    "end": "2029440"
  },
  {
    "text": "another process that is reading that that file only each 11 minutes but it's",
    "start": "2029440",
    "end": "2034760"
  },
  {
    "text": "pretty easy mosx lion synchron it's nine uh",
    "start": "2034760",
    "end": "2041000"
  },
  {
    "text": "minutes lion and I think all",
    "start": "2041000",
    "end": "2045519"
  },
  {
    "text": "praver uh Mavericks uh with Mavericks there's a uh",
    "start": "2047520",
    "end": "2053240"
  },
  {
    "text": "it's slightly different because the they use a a drift file similar to Fedora uh",
    "start": "2053240",
    "end": "2059919"
  },
  {
    "text": "and there's another service that is called um pacemaker uh but there are lot of people",
    "start": "2059919",
    "end": "2066638"
  },
  {
    "text": "are in the internet because well I try different uh different packets different",
    "start": "2066639",
    "end": "2072200"
  },
  {
    "text": "times and it didn't work but there are a lot of people that are arguing that the time synchronization in",
    "start": "2072200",
    "end": "2079679"
  },
  {
    "text": "Mavericks is not working uh and it's true it's not working but there are those people are",
    "start": "2079679",
    "end": "2088118"
  },
  {
    "text": "um using copying or copying the the lion binary or the or comping the the open",
    "start": "2088119",
    "end": "2095960"
  },
  {
    "text": "source ntpd uh so those people will be vulnerable the same way than the lion",
    "start": "2095960",
    "end": "2103720"
  },
  {
    "text": "user this uh well this uh attack surface even if you have uh um uh default",
    "start": "2104000",
    "end": "2113119"
  },
  {
    "text": "configure uh Mavericks that is that when you um when you boot up uh there's a uh",
    "start": "2113119",
    "end": "2121280"
  },
  {
    "text": "I don't know if you can see it's a sntp um command there yeah",
    "start": "2121280",
    "end": "2128040"
  },
  {
    "text": "so the ntpd is uh that doesn't work really well but the sntp works uh",
    "start": "2128040",
    "end": "2135000"
  },
  {
    "text": "really uh works well so you can exploit uh this first",
    "start": "2135000",
    "end": "2143560"
  },
  {
    "text": "synchronization there is even another other ways like if you open the",
    "start": "2143640",
    "end": "2149240"
  },
  {
    "text": "preferences uh then the time is synchronized automatically you don't need to press any button just opening",
    "start": "2149240",
    "end": "2156079"
  },
  {
    "text": "the preferences is uh it's enough and the windows is the the the design of the",
    "start": "2156079",
    "end": "2164319"
  },
  {
    "text": "windows time synchronization is the securest one because it's synchronizing each seven days and and uh uh Drift from",
    "start": "2164319",
    "end": "2173640"
  },
  {
    "text": "more more than 15 hours is not accepted so it's uh it's quite",
    "start": "2173640",
    "end": "2181240"
  },
  {
    "text": "um uh quite well protected now we have the w32 two time service that is the",
    "start": "2181240",
    "end": "2187760"
  },
  {
    "text": "service that is uh configured to synchronize the the time and that amount",
    "start": "2187760",
    "end": "2192920"
  },
  {
    "text": "of time 15 hours is uh well it's not a hard code value is in the in the regist",
    "start": "2192920",
    "end": "2198000"
  },
  {
    "text": "in in Max post pH corrector and Max pH correction and",
    "start": "2198000",
    "end": "2203880"
  },
  {
    "text": "um it can change in different situations for for example in servers are 48",
    "start": "2203880",
    "end": "2210359"
  },
  {
    "text": "hours right in older servers can be even",
    "start": "2210359",
    "end": "2215400"
  },
  {
    "text": "uh exad decimal f f f f f uh and that means that there is any",
    "start": "2215400",
    "end": "2221160"
  },
  {
    "text": "protection with her but there are lot of people that are",
    "start": "2221160",
    "end": "2229359"
  },
  {
    "text": "uh saying in the internet that my windows is synchronizing uh um my",
    "start": "2229359",
    "end": "2235760"
  },
  {
    "text": "windows is synchronizing just uh once a week and I want uh faster often more often",
    "start": "2235760",
    "end": "2244440"
  },
  {
    "text": "synchronization and are people lots on lots of tutorials that say how to configure uh task schedule uh a schedule",
    "start": "2244440",
    "end": "2251400"
  },
  {
    "text": "task to synchronize uh more often even five minutes so what happens if a user",
    "start": "2251400",
    "end": "2259240"
  },
  {
    "text": "configure his windows box to synchronize the time uh each five minutes we have if",
    "start": "2259240",
    "end": "2266160"
  },
  {
    "text": "if um if you configure your windows box to synchronize the time in well in a",
    "start": "2266160",
    "end": "2272040"
  },
  {
    "text": "lower value than the that Max post face uh",
    "start": "2272040",
    "end": "2277880"
  },
  {
    "text": "um the time what what we can do is to jump just a few seconds before the next",
    "start": "2277880",
    "end": "2286240"
  },
  {
    "text": "jump so we can make a jump and then another jump and then another jump and another jump uh reach the time in the",
    "start": "2286240",
    "end": "2293640"
  },
  {
    "text": "future that we want okay so I call it time scheming attack because it's similar to a stone",
    "start": "2293640",
    "end": "2300760"
  },
  {
    "text": "scheming right and there are another ways if the user clicks uh update now but",
    "start": "2300760",
    "end": "2309200"
  },
  {
    "text": "uh but it's uh more difficult than in macosx because the user has to click uh",
    "start": "2309200",
    "end": "2314720"
  },
  {
    "text": "update now well Windows of my members has uh used a uh signature in this uh",
    "start": "2314720",
    "end": "2323160"
  },
  {
    "text": "packet but it's something that uh I can it's something that I'm researching now so I can tell you a lot of things about",
    "start": "2323160",
    "end": "2329680"
  },
  {
    "text": "that I have another demo uh but this in in video because uh we need uh it uh uh",
    "start": "2329680",
    "end": "2337000"
  },
  {
    "text": "it takes some time so I have use a video",
    "start": "2337000",
    "end": "2342520"
  },
  {
    "text": "for that I use a video for that uh we're going to jump 10 seconds before it's 15 hours",
    "start": "2342520",
    "end": "2351119"
  },
  {
    "text": "right so I going I'm going to speed up",
    "start": "2351119",
    "end": "2358400"
  },
  {
    "text": "because okay let's",
    "start": "2358720",
    "end": "2363880"
  },
  {
    "text": "see well now we are now in the fast forward mode if you see the time and if we focus on the on the time",
    "start": "2363880",
    "end": "2373560"
  },
  {
    "text": "see how it we are jumping and",
    "start": "2373560",
    "end": "2380800"
  },
  {
    "text": "jumping into the future another jump and another jump and another jump where there are some misses that I am working",
    "start": "2380800",
    "end": "2387800"
  },
  {
    "text": "on it right and at the end uh in 2 hours we are a month in the",
    "start": "2387800",
    "end": "2395400"
  },
  {
    "text": "future okay it's a attack that can improve a lot but it works",
    "start": "2395400",
    "end": "2404559"
  },
  {
    "text": "okay uh",
    "start": "2404640",
    "end": "2410119"
  },
  {
    "text": "so whose fault is it because",
    "start": "2412319",
    "end": "2417640"
  },
  {
    "text": "um well operating systems say well everybody knows that time is not a a a",
    "start": "2417839",
    "end": "2425480"
  },
  {
    "text": "data that usual trust so and it's not an issue for us so if the if you as an",
    "start": "2425480",
    "end": "2431960"
  },
  {
    "text": "application developer you want to trust it uh it's your problem right but the",
    "start": "2431960",
    "end": "2439000"
  },
  {
    "text": "the browsers developers can say well but you have all the the uh you are perfect",
    "start": "2439000",
    "end": "2448240"
  },
  {
    "text": "you can do it in a secure way and I don't need to make uh an additional",
    "start": "2448240",
    "end": "2453960"
  },
  {
    "text": "effort for it so it's a difficult to say okay or",
    "start": "2453960",
    "end": "2460760"
  },
  {
    "text": "not um this is uh I try to to to talk with Google about this um because uh",
    "start": "2460760",
    "end": "2468200"
  },
  {
    "text": "well Google is a a a company that is uh really committed with uh securing um",
    "start": "2468200",
    "end": "2476119"
  },
  {
    "text": "their us his uses um but the I got the",
    "start": "2476119",
    "end": "2481160"
  },
  {
    "text": "the the answer that I I expected is that well it's this is a uh",
    "start": "2481160",
    "end": "2487000"
  },
  {
    "text": "um uh operating system matter so it's not anything that that we are going to",
    "start": "2487000",
    "end": "2493599"
  },
  {
    "text": "to fix that we have some references there and that's all thank you so much",
    "start": "2493599",
    "end": "2500400"
  },
  {
    "text": "for your",
    "start": "2500400",
    "end": "2502799"
  },
  {
    "text": "[Applause] attention any question yes what would you propose like",
    "start": "2507640",
    "end": "2515079"
  },
  {
    "text": "we all use",
    "start": "2515079",
    "end": "2518240"
  },
  {
    "text": "the solution",
    "start": "2521839",
    "end": "2528599"
  },
  {
    "text": "and well I I haven't gone in dep in the in",
    "start": "2534720",
    "end": "2540440"
  },
  {
    "text": "the option to to secure uh the ntp there are well",
    "start": "2540440",
    "end": "2546760"
  },
  {
    "text": "to to have a a max value of the of the",
    "start": "2546760",
    "end": "2552599"
  },
  {
    "text": "the time synchronization jump as Windows uh does is uh is uh is fine and",
    "start": "2552599",
    "end": "2559720"
  },
  {
    "text": "of course there are in the protocol isself you have the uh signature that",
    "start": "2559720",
    "end": "2565280"
  },
  {
    "text": "makes or should make more difficult to to change the time and um there are",
    "start": "2565280",
    "end": "2570880"
  },
  {
    "text": "another protections I think well there are a lot of things that that you can do for to to make uh the time",
    "start": "2570880",
    "end": "2578960"
  },
  {
    "text": "synchronization uh secure but I I can tell you the four kind of protection",
    "start": "2578960",
    "end": "2584680"
  },
  {
    "text": "because I haven't gone in depth in the in the protections any other",
    "start": "2584680",
    "end": "2591319"
  },
  {
    "text": "question you correctly the main problem is days that ised in the code yeah not",
    "start": "2591319",
    "end": "2601000"
  },
  {
    "text": "simp un yeah yeah yeah yeah I agree with you",
    "start": "2601000",
    "end": "2608720"
  },
  {
    "text": "uh that's the what Apple Safari does it's for for Safari seems that it's",
    "start": "2608720",
    "end": "2614319"
  },
  {
    "text": "forever if you are one of these providers you are protected forever and that's all but I don't know",
    "start": "2614319",
    "end": "2623400"
  },
  {
    "text": "they the people in in in Google and and and",
    "start": "2623400",
    "end": "2628839"
  },
  {
    "text": "moila uh did in that way I don't know but I agree with",
    "start": "2628839",
    "end": "2635079"
  },
  {
    "text": "you any other",
    "start": "2635079",
    "end": "2639040"
  },
  {
    "text": "question uh well I did a I tried to with",
    "start": "2650520",
    "end": "2656040"
  },
  {
    "text": "my well I um I tried with my my Ubuntu my virtual",
    "start": "2656040",
    "end": "2662680"
  },
  {
    "text": "Ubuntu to from the VMware to disconnect and then reconnect and it works I have",
    "start": "2662680",
    "end": "2671800"
  },
  {
    "text": "what no not with windows with Windows if you reconnect uh it's once a week no",
    "start": "2671800",
    "end": "2679800"
  },
  {
    "text": "there's another other way",
    "start": "2679800",
    "end": "2686079"
  },
  {
    "text": "question this new stand for and it probably has the same problem",
    "start": "2689280",
    "end": "2694480"
  },
  {
    "text": "because it's the IDE seconds the head and you cannot set that",
    "start": "2694480",
    "end": "2699920"
  },
  {
    "text": "for INF because you have you have to you know the public",
    "start": "2699920",
    "end": "2707079"
  },
  {
    "text": "pinning standard it's quite new and it is a similar idea than HPS so you can",
    "start": "2707079",
    "end": "2712680"
  },
  {
    "text": "pin for a public key on htps connection um it probably has the same",
    "start": "2712680",
    "end": "2719839"
  },
  {
    "text": "problem and you cannot set that to an infin dat because you have to",
    "start": "2719839",
    "end": "2727880"
  },
  {
    "text": "yeah well I I can see I can see that that there can be some problems with the with setting up setting it up forever",
    "start": "2727920",
    "end": "2735359"
  },
  {
    "text": "because what if uh tomorrow you are not going to use H uh https then the users can use your your",
    "start": "2735359",
    "end": "2744119"
  },
  {
    "text": "website but uh well I think it's uh uh uh you can uh install an update of the",
    "start": "2744119",
    "end": "2751680"
  },
  {
    "text": "hsts list in the in the following update of your browser or something like that I don't know if there is a um a problem",
    "start": "2751680",
    "end": "2759760"
  },
  {
    "text": "that I that I can see in in that um maybe maybe I don't",
    "start": "2759760",
    "end": "2767480"
  },
  {
    "text": "know any other question no okay thank you so",
    "start": "2767480",
    "end": "2774710"
  },
  {
    "text": "[Applause] much",
    "start": "2774710",
    "end": "2780880"
  }
]