[
  {
    "text": "good afternoon everybody we're glad you're here for this session this is my favorite session of the day my favorite",
    "start": "30",
    "end": "6330"
  },
  {
    "text": "session of blackhat in fact one note in advance please silence all of your mobile devices if there are too many",
    "start": "6330",
    "end": "12900"
  },
  {
    "text": "interruptions from calls during the talk we're gonna lock the doors and start again from scratch since we're recording this we're going to get a nice good",
    "start": "12900",
    "end": "18449"
  },
  {
    "text": "recording if you haven't yet stopped by the business hall located in Mandalay Bay Oceanside and shoreline ballrooms on",
    "start": "18449",
    "end": "25680"
  },
  {
    "text": "level two I think you're pretty much out of time you'll need to run over there at the end of the talk but I think you have a little bit more time to stop by the",
    "start": "25680",
    "end": "32099"
  },
  {
    "text": "merchandise store on level two and on every level including right outside here you can get the session recordings from",
    "start": "32099",
    "end": "39030"
  },
  {
    "text": "s okay my name is dr. John Griffin and it is my distinct pleasure to welcome",
    "start": "39030",
    "end": "45120"
  },
  {
    "text": "you to the Islander AI ballroom hopefully you're in the right place for today's talk on everybody be cool this",
    "start": "45120",
    "end": "51840"
  },
  {
    "text": "is a robbery as you know not every black hat talk has a title as cool as that so I'm expecting the talk will be just as",
    "start": "51840",
    "end": "57270"
  },
  {
    "text": "good and is my great pleasure to introduce to you Jon batiste bedroom and galia Gabriel company",
    "start": "57270",
    "end": "65780"
  },
  {
    "text": "[Applause]",
    "start": "65780",
    "end": "69859"
  },
  {
    "text": "hi everyone I am Jon batiste this is Gabrielle and today we'll talk about the",
    "start": "87560",
    "end": "93620"
  },
  {
    "text": "security of HSN so we must walk at the dojo",
    "start": "93620",
    "end": "99470"
  },
  {
    "text": "which is a religious security team and our daily job is to assess the security of our products and also to evaluate the",
    "start": "99470",
    "end": "108320"
  },
  {
    "text": "security of these of the products that are integrated in our solutions they can be third party products and for this",
    "start": "108320",
    "end": "115010"
  },
  {
    "text": "reason we had to evaluate an HSN and we",
    "start": "115010",
    "end": "121399"
  },
  {
    "text": "will present today the results of this evaluation so first I will explain",
    "start": "121399",
    "end": "129070"
  },
  {
    "text": "briefly what what is an HSN hardware security module and I will detail the",
    "start": "129070",
    "end": "135770"
  },
  {
    "text": "specificities of the HSM we assess then most of our as most of our research is",
    "start": "135770",
    "end": "142370"
  },
  {
    "text": "about the pse pse 11 the Europe the HSM I will explain I will detail the",
    "start": "142370",
    "end": "148310"
  },
  {
    "text": "standard we had to develop a few tools to have a better understanding of the",
    "start": "148310",
    "end": "155150"
  },
  {
    "text": "internals of the device and to is the even our which is discovery and the",
    "start": "155150",
    "end": "161450"
  },
  {
    "text": "expectation we will present them briefly and we'll talk about the vulnerability",
    "start": "161450",
    "end": "166610"
  },
  {
    "text": "discovery and exploitation eventually we will show how we broke the integrity of",
    "start": "166610",
    "end": "175010"
  },
  {
    "text": "the device our winners to install any firmware on the HSM and how to implant a",
    "start": "175010",
    "end": "182180"
  },
  {
    "text": "persistent backdoor does that survive a firmware upgrade so let's go so what is",
    "start": "182180",
    "end": "192440"
  },
  {
    "text": "an HSN the goal of an HSM is to protect you your keys your encryption keys so it",
    "start": "192440",
    "end": "200180"
  },
  {
    "text": "is a security and cloud that is able to generate to stop and to use your secrets",
    "start": "200180",
    "end": "206000"
  },
  {
    "text": "to perform cryptographic operations with them so the main idea is that the keys",
    "start": "206000",
    "end": "212870"
  },
  {
    "text": "never leave the device they stay always most all most of the time actually in",
    "start": "212870",
    "end": "218750"
  },
  {
    "text": "in the memory on the of the hsm or on the person storage of the device so this",
    "start": "218750",
    "end": "224990"
  },
  {
    "text": "an HSM can be either an internal card like a PCI Express card these are",
    "start": "224990",
    "end": "231910"
  },
  {
    "text": "external device such as a network appliance most of the time and it's",
    "start": "231910",
    "end": "237050"
  },
  {
    "text": "composed of standard components plus one or more crypto processes to speed up",
    "start": "237050",
    "end": "245960"
  },
  {
    "text": "cryptographic operations or to make them more secure to avoid side-channel attacks things like that and most of",
    "start": "245960",
    "end": "253820"
  },
  {
    "text": "them also have anti tempering called contra measles that means that if you try to attack the hsm physically it will",
    "start": "253820",
    "end": "261260"
  },
  {
    "text": "delete itself it will delete all of its secrets and you will get nothing so when",
    "start": "261260",
    "end": "268970"
  },
  {
    "text": "this device are used actually when your keys I are highly sensitive the major",
    "start": "268970",
    "end": "277310"
  },
  {
    "text": "example is the public infrastructure so actually all of your certificate",
    "start": "277310",
    "end": "284150"
  },
  {
    "text": "authorities use HSM to deliver certificates so private key of the",
    "start": "284150",
    "end": "290030"
  },
  {
    "text": "certificate authorities is always stored in HSM and that will be this device that",
    "start": "290030",
    "end": "296870"
  },
  {
    "text": "will generate the certificates that will sign the certificates they can be also",
    "start": "296870",
    "end": "302840"
  },
  {
    "text": "used in banking banking environments to personalize the credit your credit card",
    "start": "302840",
    "end": "310850"
  },
  {
    "text": "or to verify your CVV or your PIN Collinson and so can can be also used in",
    "start": "310850",
    "end": "318520"
  },
  {
    "text": "telecom operators for example there they are always used in by operators actually",
    "start": "318520",
    "end": "326600"
  },
  {
    "text": "to authenticate you on the mobile network so so almost everywhere in",
    "start": "326600",
    "end": "336590"
  },
  {
    "text": "corporate environments when you have to manage long term keys but they are not were studied in security why I'd say for",
    "start": "336590",
    "end": "345530"
  },
  {
    "text": "two reasons the first one is that this is an expensive device so I'm a research",
    "start": "345530",
    "end": "351440"
  },
  {
    "text": "lab cannot by a device just for testing and the",
    "start": "351440",
    "end": "356510"
  },
  {
    "text": "second one is that there are most of the time in production and they are often",
    "start": "356510",
    "end": "361790"
  },
  {
    "text": "disconnected from from the corporate network and they contain long time",
    "start": "361790",
    "end": "368720"
  },
  {
    "text": "secrets that cannot be erased so so most of the time out of the scope during pen",
    "start": "368720",
    "end": "373820"
  },
  {
    "text": "test because if you attack it's a bit too much all of its secrets will be",
    "start": "373820",
    "end": "379010"
  },
  {
    "text": "deleted and that's not a good thing for for companies obviously so here is the",
    "start": "379010",
    "end": "385850"
  },
  {
    "text": "hsm we assess this is a PCI Express card you can see it on the right which is",
    "start": "385850",
    "end": "391640"
  },
  {
    "text": "sensor card in red on the right and what you can see is that you using your finger clearly it's fully black why",
    "start": "391640",
    "end": "399620"
  },
  {
    "text": "because it is coated in epoxy resin so all the components are coated and you cannot access them directly",
    "start": "399620",
    "end": "406880"
  },
  {
    "text": "this HSM is certified FIPS 140-2 level 3",
    "start": "406880",
    "end": "412180"
  },
  {
    "text": "I'd say a bit later what it is and the same model also exists as a network",
    "start": "412180",
    "end": "419030"
  },
  {
    "text": "reply appliance so the only difference between the two models is that the this",
    "start": "419030",
    "end": "425630"
  },
  {
    "text": "model does not have internet connector and budget as a it's not controller so I",
    "start": "425630",
    "end": "431930"
  },
  {
    "text": "think also G also applies on the network appliance version of the HSM but we are",
    "start": "431930",
    "end": "439220"
  },
  {
    "text": "not sure this so installed the card in a standard linux server install the tools",
    "start": "439220",
    "end": "445580"
  },
  {
    "text": "provided by the vendor confirm our current modules and command line utilities and we started our analysis so",
    "start": "445580",
    "end": "453620"
  },
  {
    "text": "looking at the source code of the drivers to understand the communication between the host the linux server and",
    "start": "453620",
    "end": "460760"
  },
  {
    "text": "the HSM so actually the the communication is done by reading and",
    "start": "460760",
    "end": "466040"
  },
  {
    "text": "writing to share DRAM which is talk which is on the PCI card on the on the",
    "start": "466040",
    "end": "471320"
  },
  {
    "text": "HSN card and by reading and writing data you can have a",
    "start": "471320",
    "end": "477810"
  },
  {
    "text": "basic communication stuff so all the communication is initiated by the host by the server the hsm received this",
    "start": "477810",
    "end": "486389"
  },
  {
    "text": "buffer process it and write its response to join the buffer and send it back",
    "start": "486389",
    "end": "492570"
  },
  {
    "text": "which is read back by the server so it can be seen as cry standard crying",
    "start": "492570",
    "end": "498060"
  },
  {
    "text": "server communication I will now make a small demo of what we did we are in the",
    "start": "498060",
    "end": "506580"
  },
  {
    "text": "context when an attacker controls the host the Linux server and it can",
    "start": "506580",
    "end": "511919"
  },
  {
    "text": "communicate with the PCI crack card but she has no logging information so actually can normally do nothing on the",
    "start": "511919",
    "end": "519390"
  },
  {
    "text": "on the HSM so here it is you can see on",
    "start": "519390",
    "end": "526650"
  },
  {
    "text": "the on the left the shell of the attack attacker and on the right a tool a",
    "start": "526650",
    "end": "532680"
  },
  {
    "text": "monitoring tool we we wrote to understand what's going on a bit on the HSM so you can see on the on the right",
    "start": "532680",
    "end": "539610"
  },
  {
    "text": "that the authentication that always failed because the attacker has no real",
    "start": "539610",
    "end": "544950"
  },
  {
    "text": "information and is now running an exploit so you start to do a bit of",
    "start": "544950",
    "end": "552300"
  },
  {
    "text": "weaknesses in event stuff and manages to",
    "start": "552300",
    "end": "557330"
  },
  {
    "text": "take a bit of control of the of the HSM you can see now that shellcode has been",
    "start": "557330",
    "end": "563520"
  },
  {
    "text": "executed on the SSM and the login authentication on the right succeeded",
    "start": "563520",
    "end": "569010"
  },
  {
    "text": "now finally a new module is uploaded on",
    "start": "569010",
    "end": "575760"
  },
  {
    "text": "the HSM we upload some code on it and the HSM is a reset source ah no",
    "start": "575760",
    "end": "581400"
  },
  {
    "text": "communication with it now once it has been reset a new module has been loaded",
    "start": "581400",
    "end": "587610"
  },
  {
    "text": "and the attacker has no full control of the device you can now for example list",
    "start": "587610",
    "end": "593400"
  },
  {
    "text": "the processes on it and we can see that you can run these commands with root",
    "start": "593400",
    "end": "599640"
  },
  {
    "text": "privileges so this is a full takeover of the device and we will explain later",
    "start": "599640",
    "end": "606000"
  },
  {
    "text": "what can we what we can do with the wizard so as I said before our HSM is certified",
    "start": "606000",
    "end": "613800"
  },
  {
    "text": "and actually the standard is doesn't give much information doesn't give much",
    "start": "613800",
    "end": "622050"
  },
  {
    "text": "guarantee about the security of this software running on the device because it level 1 certification just means that",
    "start": "622050",
    "end": "628260"
  },
  {
    "text": "your device as an approved encryption algorithm so if it does like AES",
    "start": "628260",
    "end": "635399"
  },
  {
    "text": "correctly it can be certified the above levels just mean that your device is",
    "start": "635399",
    "end": "643790"
  },
  {
    "text": "protected against physical attacks so if you try to attack physically you use a",
    "start": "643790",
    "end": "649950"
  },
  {
    "text": "device usually with a certain probability this attack will be detected",
    "start": "649950",
    "end": "655680"
  },
  {
    "text": "and all the sensitive data will be erased from the device so this is not a",
    "start": "655680",
    "end": "662279"
  },
  {
    "text": "certification about software attacks",
    "start": "662279",
    "end": "666649"
  },
  {
    "text": "so that's I will now explain PCCs 11 as as I said before most of our",
    "start": "667850",
    "end": "674040"
  },
  {
    "text": "research is about the standard so what is ptcs 11 it is a generic interface to",
    "start": "674040",
    "end": "679529"
  },
  {
    "text": "communicate with a cryptographic device this device can be either our smart card for example an HSM actually any device",
    "start": "679529",
    "end": "687089"
  },
  {
    "text": "that is able to perform cryptographic operations and this standard defines a possible API which is called crypto key",
    "start": "687089",
    "end": "694050"
  },
  {
    "text": "and this API tells us gives us is the",
    "start": "694050",
    "end": "699510"
  },
  {
    "text": "ability to perform cryptographic operations on the device like encrypting data or decrypting data generating",
    "start": "699510",
    "end": "706820"
  },
  {
    "text": "generating digital signatures and so on so the API in itself is not very rich so",
    "start": "706820",
    "end": "714899"
  },
  {
    "text": "a few few dozen functions like 70 functions but most of these functions",
    "start": "714899",
    "end": "720839"
  },
  {
    "text": "can can be parameterized using mechanisms and there are lot of mechanisms more than 300 in the standard",
    "start": "720839",
    "end": "729089"
  },
  {
    "text": "and vendors also add their own mechanisms to enrich the API so this",
    "start": "729089",
    "end": "737270"
  },
  {
    "text": "actually gives us good attacks good attack surface for for the device",
    "start": "737270",
    "end": "743069"
  },
  {
    "text": "so what are mechanisms mechanisms define how to perform a cryptographic operations so the mechanism for",
    "start": "743069",
    "end": "750579"
  },
  {
    "text": "encryption decryption jutted natural killer key in the relation children generation and son and these mechanisms",
    "start": "750579",
    "end": "758790"
  },
  {
    "text": "depend on the device so for example on a smart card you will have a few mechanism",
    "start": "758790",
    "end": "764470"
  },
  {
    "text": "to one on one auto mechanism to encrypt data for example use AES or Frida's or",
    "start": "764470",
    "end": "770110"
  },
  {
    "text": "to general one mechanism to generate an RSA key and one mechanism to sign with",
    "start": "770110",
    "end": "775899"
  },
  {
    "text": "this recipe and that's mainly everything you have on a smart card on the contrary",
    "start": "775899",
    "end": "782350"
  },
  {
    "text": "on the HSN you will have a lot of mechanisms because it's a device which",
    "start": "782350",
    "end": "788350"
  },
  {
    "text": "is far more rich you will have mechanisms for authentication encryption",
    "start": "788350",
    "end": "793379"
  },
  {
    "text": "like for extensions for typo operators extensions for the banking world and so",
    "start": "793379",
    "end": "798579"
  },
  {
    "text": "on so actually the the attacks of ice is quite huge as well as we will see later",
    "start": "798579",
    "end": "805709"
  },
  {
    "text": "these mechanisms walk on objects what are objects there are three kinds of",
    "start": "805709",
    "end": "813189"
  },
  {
    "text": "objects defined by the standard then they can be either keys these are certificates or is a data data data is",
    "start": "813189",
    "end": "820569"
  },
  {
    "text": "not that much interesting so often domain parameters for GSA or ECDSA what's interesting for us obviously are",
    "start": "820569",
    "end": "827920"
  },
  {
    "text": "the keys and mainly the private keys and the secret keys so the objects are not",
    "start": "827920",
    "end": "835439"
  },
  {
    "text": "manipulated directly by PT PT she has 11 clients there are manipulated to say",
    "start": "835439",
    "end": "841509"
  },
  {
    "text": "handle we explain now how cryptographic operation is done on the HSM so first on",
    "start": "841509",
    "end": "848079"
  },
  {
    "text": "the left you have a client that's well that want to encrypt that data with a key first it will ask the HSM to",
    "start": "848079",
    "end": "855339"
  },
  {
    "text": "generate a key the HSM with generate this key and store is value in his",
    "start": "855339",
    "end": "862180"
  },
  {
    "text": "memory then it will return return handle to the client the client sir then we",
    "start": "862180",
    "end": "869709"
  },
  {
    "text": "will start an encryption operation using this handle it will then send the data to be",
    "start": "869709",
    "end": "876480"
  },
  {
    "text": "encrypted and the HSM will return the encrypted data so as you can see the key",
    "start": "876480",
    "end": "882240"
  },
  {
    "text": "is never revealed to the clients it stays in the HSM space and we will see",
    "start": "882240",
    "end": "889680"
  },
  {
    "text": "that normally there's no way to extract it in certain conditions the object is",
    "start": "889680",
    "end": "896100"
  },
  {
    "text": "actually composed of several attributes each objects as a class in that case",
    "start": "896100",
    "end": "902459"
  },
  {
    "text": "this is a private key and it has virus attributes that depends on that class",
    "start": "902459",
    "end": "908670"
  },
  {
    "text": "for example the value of the keys and attributes it has also an attribute",
    "start": "908670",
    "end": "915000"
  },
  {
    "text": "telling that this key can be used to sign data it has no attribute to say",
    "start": "915000",
    "end": "921560"
  },
  {
    "text": "that says that that key can be used to encrypt data so actually this is just a",
    "start": "921560",
    "end": "927209"
  },
  {
    "text": "signing key and this is more example and what I want to say here it does is that",
    "start": "927209",
    "end": "934589"
  },
  {
    "text": "attributes are actually critical for security I will mention free attributes",
    "start": "934589",
    "end": "941009"
  },
  {
    "text": "now the first one is the private attribute if an object has this attribute it means that it cannot be",
    "start": "941009",
    "end": "949709"
  },
  {
    "text": "accessed until a user is authenticated",
    "start": "949709",
    "end": "954380"
  },
  {
    "text": "now this sensitive attribute if an object is sensitive that means its value",
    "start": "954949",
    "end": "960029"
  },
  {
    "text": "which is often the secret value for a key means that this value cannot be",
    "start": "960029",
    "end": "966990"
  },
  {
    "text": "extracted directly it must be wrought that means encapsulated using another encryption key which is usually stored",
    "start": "966990",
    "end": "974279"
  },
  {
    "text": "on the HSM so the plaintext value of the key is never revealed from the outside",
    "start": "974279",
    "end": "980189"
  },
  {
    "text": "of the HSM then I'll talk about the extractable attributes if that attribute",
    "start": "980189",
    "end": "987569"
  },
  {
    "text": "is set that means is not that that means that the value of the key cannot be",
    "start": "987569",
    "end": "993300"
  },
  {
    "text": "extracted at all even Rutte so it stays in the memory and of the HSM and it",
    "start": "993300",
    "end": "998639"
  },
  {
    "text": "cannot be sent to a client so it's every",
    "start": "998639",
    "end": "1007080"
  },
  {
    "text": "eggs are bound to a to a token actually when the client connects to the HSM or",
    "start": "1007080",
    "end": "1012840"
  },
  {
    "text": "to a smart card it will open the slot and will get access to a token every",
    "start": "1012840",
    "end": "1020970"
  },
  {
    "text": "object belong to token and when a user connect to a token he has only access to",
    "start": "1020970",
    "end": "1027390"
  },
  {
    "text": "the objects that are present in the in that token so for example if a user",
    "start": "1027390",
    "end": "1033810"
  },
  {
    "text": "connects to the token on the Left you will not be able to access to the",
    "start": "1033810",
    "end": "1040170"
  },
  {
    "text": "objects that have stolen the deterrent a token of on the right so I was a logical",
    "start": "1040170",
    "end": "1045930"
  },
  {
    "text": "separation between between objects in the standard that allows us to define a",
    "start": "1045930",
    "end": "1052140"
  },
  {
    "text": "threat model for the HSM basic basic threat model so for example an attacker who does not vote indicates it to the",
    "start": "1052140",
    "end": "1059370"
  },
  {
    "text": "HSA is not able to extract private objects and attica that connects to us",
    "start": "1059370",
    "end": "1064470"
  },
  {
    "text": "given thread must not be able to connect to other slots and so on but we will consider much simpler model we will tell",
    "start": "1064470",
    "end": "1072570"
  },
  {
    "text": "we will consider this a case where an attacker is not authenticated and we",
    "start": "1072570",
    "end": "1078090"
  },
  {
    "text": "want to be able to dump out all these secrets for all the objects and all of",
    "start": "1078090",
    "end": "1083490"
  },
  {
    "text": "these secrets from all the slots so the",
    "start": "1083490",
    "end": "1089550"
  },
  {
    "text": "security of crypto key has been extensively extensively detailed in the",
    "start": "1089550",
    "end": "1096690"
  },
  {
    "text": "past but our contribution is a bit different is it quite different actually we do not concentrate on the standard",
    "start": "1096690",
    "end": "1103880"
  },
  {
    "text": "but on a specific implementation and we also detail the internals of an HSM",
    "start": "1103880",
    "end": "1110550"
  },
  {
    "text": "which I think has not as never been done before",
    "start": "1110550",
    "end": "1115580"
  },
  {
    "text": "so let's do with the vulnerability research and exploitation so we consider",
    "start": "1115580",
    "end": "1122220"
  },
  {
    "text": "the case where an attacker is able to communicate with the HSM has taken control of zeroes for example by",
    "start": "1122220",
    "end": "1128940"
  },
  {
    "text": "exploiting a service exposing the host and so something like that",
    "start": "1128940",
    "end": "1134010"
  },
  {
    "text": "we started our analysis by analyzing these tools provided by rabbis",
    "start": "1134010",
    "end": "1142179"
  },
  {
    "text": "even though there was an interesting documentation which was fairly complete one for the developers one for the",
    "start": "1142179",
    "end": "1148870"
  },
  {
    "text": "administrators and a few examples and so on but what was really interesting for us was that there was a few more date",
    "start": "1148870",
    "end": "1156130"
  },
  {
    "text": "provided by the vendor and that fimo update was just signed not encrypted and",
    "start": "1156130",
    "end": "1161890"
  },
  {
    "text": "it was quite easy easy to extract first thing thing we saw is that it was",
    "start": "1161890",
    "end": "1167860"
  },
  {
    "text": "running and not Linux scanner whirring released ten years ago so we were quite",
    "start": "1167860",
    "end": "1174039"
  },
  {
    "text": "sure that not everything was up to date on this device the device as if my was",
    "start": "1174039",
    "end": "1181360"
  },
  {
    "text": "composed of very few binary reason only one executable thing and the quite big",
    "start": "1181360",
    "end": "1186940"
  },
  {
    "text": "crypto library cryptic a library that contains all the crypto key implementation and the code was not very",
    "start": "1186940",
    "end": "1196090"
  },
  {
    "text": "difficult to understand but it was quite sure so huge so we spent quite several",
    "start": "1196090",
    "end": "1201970"
  },
  {
    "text": "weeks to really understand it one of the",
    "start": "1201970",
    "end": "1210220"
  },
  {
    "text": "unexpected option on this HSM we were quite happy with that with that is that",
    "start": "1210220",
    "end": "1217210"
  },
  {
    "text": "this HSM can rot can run from party code you can upload modules on it that will",
    "start": "1217210",
    "end": "1224890"
  },
  {
    "text": "be executed on the device so this is not reality at all it's really a feature and",
    "start": "1224890",
    "end": "1231480"
  },
  {
    "text": "it requires I need privileges to to load code on it the standard use for this is",
    "start": "1231480",
    "end": "1238899"
  },
  {
    "text": "to add new mechanisms for example or to isolate code from from the host if you have a super-secret I've read them and",
    "start": "1238899",
    "end": "1244929"
  },
  {
    "text": "you don't want to be exposed on the host you upload it on the HSM in it will be directly executed on the device and",
    "start": "1244929",
    "end": "1252669"
  },
  {
    "text": "never revealed to to the host modules actually libraries that are",
    "start": "1252669",
    "end": "1258880"
  },
  {
    "text": "loaded by the main exactly executable of the HSM and they run on the on the",
    "start": "1258880",
    "end": "1264700"
  },
  {
    "text": "context of the main executable as I said there was",
    "start": "1264700",
    "end": "1270550"
  },
  {
    "text": "senior binary on the device are we quite no thing for us and we wanted to have a",
    "start": "1270550",
    "end": "1275980"
  },
  {
    "text": "better understanding of the internals of the device so the first model we developed was a modified version of the",
    "start": "1275980",
    "end": "1283570"
  },
  {
    "text": "box that was able to run on the device so we modified the input and output of",
    "start": "1283570",
    "end": "1291280"
  },
  {
    "text": "the utilities so they pass through the crypto key Channel and that's what and",
    "start": "1291280",
    "end": "1297810"
  },
  {
    "text": "we saw that the main process was running as root and this was quite good and we",
    "start": "1297810",
    "end": "1305680"
  },
  {
    "text": "saw also that was only one processor running on on the device we were quite",
    "start": "1305680",
    "end": "1312970"
  },
  {
    "text": "sure I think just the sheriff was would not be enough room for exploitation so",
    "start": "1312970",
    "end": "1321280"
  },
  {
    "text": "we decided to also develop a debugger for the HSM also in module and we",
    "start": "1321280",
    "end": "1328930"
  },
  {
    "text": "modified gdb server for it we lap to gdb server and it was quite tricky because the only communication",
    "start": "1328930",
    "end": "1334930"
  },
  {
    "text": "channel is ensured by by the main process with with the host so if you debug the main process obviously there",
    "start": "1334930",
    "end": "1341710"
  },
  {
    "text": "will be no communication at all with the outside and you will be stuck so we had to develop a new communication mechanism",
    "start": "1341710",
    "end": "1348430"
  },
  {
    "text": "with the outside world using against Raja Ram that was quite tricky but that",
    "start": "1348430",
    "end": "1354820"
  },
  {
    "text": "finally walked from all of this we were",
    "start": "1354820",
    "end": "1360460"
  },
  {
    "text": "happy because we were able to debug the hsm run common indeed it was almost user",
    "start": "1360460",
    "end": "1368380"
  },
  {
    "text": "friendly and we saw also that everything was running as root and what was super",
    "start": "1368380",
    "end": "1375340"
  },
  {
    "text": "interesting for us is that there was no secure boot on the device that means that if we are able to modify as if you",
    "start": "1375340",
    "end": "1381010"
  },
  {
    "text": "are stored on the HSM it will reboot as",
    "start": "1381010",
    "end": "1386410"
  },
  {
    "text": "no secure boot so let's see if you would on the storage so already this purpose",
    "start": "1386410",
    "end": "1393490"
  },
  {
    "text": "and storage is on the flash memory and that flash memory cannot be accessed directly as I said it's",
    "start": "1393490",
    "end": "1401100"
  },
  {
    "text": "by epoxy resin and if you try to to dump it you have hundred percent chances that",
    "start": "1401100",
    "end": "1408510"
  },
  {
    "text": "it will erase itself when very interesting partition on this fresh on",
    "start": "1408510",
    "end": "1414750"
  },
  {
    "text": "this flash flash storage is the one that contains the crypto key as a pcs 11",
    "start": "1414750",
    "end": "1421289"
  },
  {
    "text": "objects they contain all the keys if you would on the storage actually this",
    "start": "1421289",
    "end": "1428100"
  },
  {
    "text": "partition uses a proprietary file system I think this is to ensure secure",
    "start": "1428100",
    "end": "1434940"
  },
  {
    "text": "deletion of the of the object this as it is a flash device as I wanted to make",
    "start": "1434940",
    "end": "1440700"
  },
  {
    "text": "sure that if you really if you delete an pixels 11 elect it is really deleted",
    "start": "1440700",
    "end": "1446429"
  },
  {
    "text": "from from the flash so actually on the flat on this partition object or stop",
    "start": "1446429",
    "end": "1451679"
  },
  {
    "text": "plaintext but sensitive attributes are encrypted so if you don't need a flash",
    "start": "1451679",
    "end": "1458159"
  },
  {
    "text": "you will not get access to the to the objects right to the interesting value",
    "start": "1458159",
    "end": "1463350"
  },
  {
    "text": "of the objects actually the encryption key is thought stored on an external",
    "start": "1463350",
    "end": "1468450"
  },
  {
    "text": "memory and that memory that component only holds the encryption key and this",
    "start": "1468450",
    "end": "1475980"
  },
  {
    "text": "is this component that is immediately deleted when you try to access the HSM",
    "start": "1475980",
    "end": "1481320"
  },
  {
    "text": "physically so to be able to dump all the objects from an HSM from this HSM you",
    "start": "1481320",
    "end": "1489059"
  },
  {
    "text": "have to them both the key and the partition of the flash what we can say",
    "start": "1489059",
    "end": "1495419"
  },
  {
    "text": "also is that there's no logical separation across the HSM slots so if",
    "start": "1495419",
    "end": "1500549"
  },
  {
    "text": "you are able to dump the flush and the key you have access to all the objects",
    "start": "1500549",
    "end": "1506460"
  },
  {
    "text": "on the device as everything Rinna's root we can be almost sure that a single code",
    "start": "1506460",
    "end": "1513690"
  },
  {
    "text": "execution on on the device allows to dump all of the secrets and that's what",
    "start": "1513690",
    "end": "1520730"
  },
  {
    "text": "Gabrielle will present now thanks to",
    "start": "1520730",
    "end": "1527429"
  },
  {
    "text": "properties you know everything about ages and internals and we know explain",
    "start": "1527429",
    "end": "1532710"
  },
  {
    "text": "how we did and RD venerability research and how",
    "start": "1532710",
    "end": "1537779"
  },
  {
    "text": "about exploit so we first started by looking for usual vulnerabilities such",
    "start": "1537779",
    "end": "1546570"
  },
  {
    "text": "as Stack Overflow we did a quick manual analysis we thought for mem copy calls",
    "start": "1546570",
    "end": "1553139"
  },
  {
    "text": "with viable size parameters mem copy",
    "start": "1553139",
    "end": "1558809"
  },
  {
    "text": "calls inside crypto key functions because these functions I can usually be",
    "start": "1558809",
    "end": "1564210"
  },
  {
    "text": "called from the host there is only one function that was on arrival which is",
    "start": "1564210",
    "end": "1570269"
  },
  {
    "text": "miners derive which is Nathan ocation algorithm found in universal mobile",
    "start": "1570269",
    "end": "1577169"
  },
  {
    "text": "telecommunication system here is a pure code of this function I think as you can",
    "start": "1577169",
    "end": "1585000"
  },
  {
    "text": "see there is a call to mem copy with a size with no check on the with no limits",
    "start": "1585000",
    "end": "1593629"
  },
  {
    "text": "with no check on the size the value is",
    "start": "1593629",
    "end": "1599580"
  },
  {
    "text": "copied into the stack and the value is controlled by the attacker which can put",
    "start": "1599580",
    "end": "1605909"
  },
  {
    "text": "an arbitrary data in the inside this value thanks to a call to create secret",
    "start": "1605909",
    "end": "1611490"
  },
  {
    "text": "key so using a few calls to crypto key functions gaining code execution is",
    "start": "1611490",
    "end": "1617820"
  },
  {
    "text": "trivial because there is no mitigations at all there is no stack cookie and no a seller",
    "start": "1617820",
    "end": "1624059"
  },
  {
    "text": "for instance however there are a few drawbacks for instance or assuming",
    "start": "1624059",
    "end": "1632100"
  },
  {
    "text": "execution is tricky because the critical",
    "start": "1632100",
    "end": "1638730"
  },
  {
    "text": "data on the stack is overwritten during the stack overflow moreover the called who create secret",
    "start": "1638730",
    "end": "1645750"
  },
  {
    "text": "key requires to be authenticated this algorithm is only present in recent",
    "start": "1645750",
    "end": "1651840"
  },
  {
    "text": "version of the family so we started to look for beta buggs we try to automate",
    "start": "1651840",
    "end": "1660750"
  },
  {
    "text": "this process thanks to 13 architecture",
    "start": "1660750",
    "end": "1666149"
  },
  {
    "text": "we set up damn phasers we mutated messages are",
    "start": "1666149",
    "end": "1673129"
  },
  {
    "text": "sent from the host to the hsn.we we",
    "start": "1673129",
    "end": "1679729"
  },
  {
    "text": "created a destitute thanks to the crypto key user usage examples which cover",
    "start": "1679729",
    "end": "1685729"
  },
  {
    "text": "almost every calls to crypto key as I said 13 strategy is already trivial we",
    "start": "1685729",
    "end": "1695330"
  },
  {
    "text": "just mutate random byte from the messenger messages we face two main",
    "start": "1695330",
    "end": "1701149"
  },
  {
    "text": "challenges the first one is that the host kernel module that transfers a",
    "start": "1701149",
    "end": "1706220"
  },
  {
    "text": "messages to the HSM is not super robust actually a few messages make this model",
    "start": "1706220",
    "end": "1714619"
  },
  {
    "text": "crash which isn't it convenient to have an automated further so we had to filter",
    "start": "1714619",
    "end": "1722749"
  },
  {
    "text": "these messages also a my surgeries triggered out of memory situation on the",
    "start": "1722749",
    "end": "1728269"
  },
  {
    "text": "HSM so once again we had to use one of the modules that we developed before to",
    "start": "1728269",
    "end": "1735799"
  },
  {
    "text": "modify the configuration of the Linux OS which is running on the HSM finally we",
    "start": "1735799",
    "end": "1745759"
  },
  {
    "text": "had completely automated fads in architecture we found about 15 lunar",
    "start": "1745759",
    "end": "1753019"
  },
  {
    "text": "abilities all of them being a memory corruption bags so in the next part of",
    "start": "1753019",
    "end": "1760249"
  },
  {
    "text": "the presentation I will explain two tubes that we found the first one is",
    "start": "1760249",
    "end": "1768109"
  },
  {
    "text": "very close to hardly using crypto key",
    "start": "1768109",
    "end": "1773359"
  },
  {
    "text": "calls we can create objects on the HSM we can also set attributes and retrieve",
    "start": "1773359",
    "end": "1780200"
  },
  {
    "text": "attributes from from these objects here is the observer code of the function of",
    "start": "1780200",
    "end": "1788029"
  },
  {
    "text": "a function that is variable there is a call to malloc in order to allocate the",
    "start": "1788029",
    "end": "1795559"
  },
  {
    "text": "memory representing the data of an attribute if you look closely at Cisco at this",
    "start": "1795559",
    "end": "1804200"
  },
  {
    "text": "code you will notice that the size given to mark and the sides given to mem copy",
    "start": "1804200",
    "end": "1811610"
  },
  {
    "text": "are different that means that if these",
    "start": "1811610",
    "end": "1817070"
  },
  {
    "text": "two sides are different some part of the data that is copied into the value of",
    "start": "1817070",
    "end": "1823309"
  },
  {
    "text": "the attribute will not be fully initialized so we develop quick exploits",
    "start": "1823309",
    "end": "1830000"
  },
  {
    "text": "and we can see the output of the exploits on the right an attacker is",
    "start": "1830000",
    "end": "1836809"
  },
  {
    "text": "able to leak as a heap of the HSM we",
    "start": "1836809",
    "end": "1841970"
  },
  {
    "text": "managed to leak for instance the password of the administrator we think",
    "start": "1841970",
    "end": "1847610"
  },
  {
    "text": "that depending on the layout of the memory we can leak sensitive data sets",
    "start": "1847610",
    "end": "1853760"
  },
  {
    "text": "such as cryptographic key however once",
    "start": "1853760",
    "end": "1859789"
  },
  {
    "text": "again an authentication is required so we looked for other bags as FSL found a",
    "start": "1859789",
    "end": "1876710"
  },
  {
    "text": "crash in another crypto key function the",
    "start": "1876710",
    "end": "1883940"
  },
  {
    "text": "HS and many plates digest using crypto key functions there are two calls get",
    "start": "1883940",
    "end": "1890720"
  },
  {
    "text": "operation state and set operation state state that can be that can be used to",
    "start": "1890720",
    "end": "1896150"
  },
  {
    "text": "retrieve the state of a digest object and also to write to restore the state",
    "start": "1896150",
    "end": "1902780"
  },
  {
    "text": "later the mutates the serialized data",
    "start": "1902780",
    "end": "1910900"
  },
  {
    "text": "before restoring it I think that this mechanism is really close to what is",
    "start": "1910900",
    "end": "1917510"
  },
  {
    "text": "called serialization on languages such as such as PHP or Python so we had a",
    "start": "1917510",
    "end": "1927049"
  },
  {
    "text": "crash because of single bytes mutated by",
    "start": "1927049",
    "end": "1932210"
  },
  {
    "text": "ow the root cause of the crash looks like Nelda wrath which is pretty",
    "start": "1932210",
    "end": "1939080"
  },
  {
    "text": "meaningless but the stock price was unusual so we did some reverse",
    "start": "1939080",
    "end": "1945590"
  },
  {
    "text": "engineering and some dynamic analysis thanks to the debugger is the bagasse",
    "start": "1945590",
    "end": "1951050"
  },
  {
    "text": "that we developed before and we found out that it is actually a confirmed type",
    "start": "1951050",
    "end": "1959390"
  },
  {
    "text": "confusion bug the bytes which is modified by the phasor describes as a",
    "start": "1959390",
    "end": "1966530"
  },
  {
    "text": "type of the of the digests object so if we modify these bytes we can call an",
    "start": "1966530",
    "end": "1972980"
  },
  {
    "text": "expected method of on digest object object we then transformed this this bug",
    "start": "1972980",
    "end": "1983150"
  },
  {
    "text": "into useful exploits primitives the first one is a memory leak in order to",
    "start": "1983150",
    "end": "1989450"
  },
  {
    "text": "retrieve interesting addresses from the heap and the stack the second primitives",
    "start": "1989450",
    "end": "1995420"
  },
  {
    "text": "that we gain is a relative right primitive which oles to write arbitrary",
    "start": "1995420",
    "end": "2001930"
  },
  {
    "text": "data after a given object so we spent we",
    "start": "2001930",
    "end": "2007060"
  },
  {
    "text": "spend some time to develop an exploit it isn't straightforward at all because we",
    "start": "2007060",
    "end": "2014850"
  },
  {
    "text": "we faced many challenges but at the end we we had a reliable reliable exploit",
    "start": "2014850",
    "end": "2022800"
  },
  {
    "text": "which provide us arbitrary code execution but the game is not over",
    "start": "2022800",
    "end": "2030460"
  },
  {
    "text": "because we still have to find a useful payload in contrary to usual target we",
    "start": "2030460",
    "end": "2038560"
  },
  {
    "text": "were not allowed to execute just a shell or something like that simply because",
    "start": "2038560",
    "end": "2045970"
  },
  {
    "text": "there is no interesting binary on the HSM for instance the original shell",
    "start": "2045970",
    "end": "2051000"
  },
  {
    "text": "nothing like last like that even if they even wear a shell",
    "start": "2051000",
    "end": "2057070"
  },
  {
    "text": "we wouldn't be able to communicate with the host because the reason",
    "start": "2057070",
    "end": "2063608"
  },
  {
    "text": "no Network mechanism Frances so we step back did something easier we patch the",
    "start": "2063609",
    "end": "2072908"
  },
  {
    "text": "the code that he's running on the HSN to disable the pin verification function",
    "start": "2072909",
    "end": "2079269"
  },
  {
    "text": "that allows an attacker to login as admin without knowing any credentials",
    "start": "2079269",
    "end": "2085319"
  },
  {
    "text": "once it is done we can install a custom module which for instance dump the",
    "start": "2085319",
    "end": "2092799"
  },
  {
    "text": "entire memory of the hsm and also the decryption key so here is a quick",
    "start": "2092799",
    "end": "2099509"
  },
  {
    "text": "demonstration for the sake of the demo",
    "start": "2099509",
    "end": "2114190"
  },
  {
    "text": "let's say that the administrator on the HSN hosts install some secret keys then",
    "start": "2114190",
    "end": "2122859"
  },
  {
    "text": "the attacker logs into the HSN and thanks to the exploit that we developed",
    "start": "2122859",
    "end": "2129730"
  },
  {
    "text": "before dump the entire memory of the HSM and along the encryption key so that is",
    "start": "2129730",
    "end": "2137380"
  },
  {
    "text": "toured into a file flash that beam that the attacker copies on his server and",
    "start": "2137380",
    "end": "2147819"
  },
  {
    "text": "from this moment the attacker doesn't need access to the HSM anymore",
    "start": "2147819",
    "end": "2153730"
  },
  {
    "text": "everything can be done of fine so using some tools he can extract the files from",
    "start": "2153730",
    "end": "2160869"
  },
  {
    "text": "the dump of the flash memory for it for instance here he he lists every files",
    "start": "2160869",
    "end": "2167980"
  },
  {
    "text": "that are stored on the first float on the ATM then given the encryption key he",
    "start": "2167980",
    "end": "2178710"
  },
  {
    "text": "he will dump every secrets of the object it's worth noting that the object the",
    "start": "2178710",
    "end": "2186700"
  },
  {
    "text": "attributes are marked as sensitive a non extract able but knowing this encryption",
    "start": "2186700",
    "end": "2194049"
  },
  {
    "text": "key he can steal the freedom so that's it an attacker can dump and",
    "start": "2194049",
    "end": "2200700"
  },
  {
    "text": "decrypt every every secrets that are told on the ATM",
    "start": "2200700",
    "end": "2206690"
  },
  {
    "text": "[Applause]",
    "start": "2207680",
    "end": "2214280"
  },
  {
    "text": "so we found a few memory corruption beds and we wondered if it was possible to",
    "start": "2214280",
    "end": "2221940"
  },
  {
    "text": "gain persistence on the HSN so we found a logical burg thermal signature bypass",
    "start": "2221940",
    "end": "2229680"
  },
  {
    "text": "that can be exploited after having gained gained code",
    "start": "2229680",
    "end": "2235559"
  },
  {
    "text": "execution of the ageism first I will",
    "start": "2235559",
    "end": "2242640"
  },
  {
    "text": "explain how custom modules are installed on the HSM because it is pretty similar",
    "start": "2242640",
    "end": "2248550"
  },
  {
    "text": "to how firm ware is a dating first certificate is generated on the client",
    "start": "2248550",
    "end": "2256589"
  },
  {
    "text": "machine locally then the public key of the certificate is sent to the 80s to",
    "start": "2256589",
    "end": "2263160"
  },
  {
    "text": "the HSM the HSM sent back the handle of the certificate and the client sends the",
    "start": "2263160",
    "end": "2271710"
  },
  {
    "text": "binary of the module along the signature of the module the HSM verifies the",
    "start": "2271710",
    "end": "2279210"
  },
  {
    "text": "signature of the module and if it is valid then the module is written into",
    "start": "2279210",
    "end": "2284309"
  },
  {
    "text": "the flash memory of the age of the HSM and the HSM reboots the thermal a date",
    "start": "2284309",
    "end": "2292770"
  },
  {
    "text": "is really similar but Sarris the",
    "start": "2292770",
    "end": "2299250"
  },
  {
    "text": "certificate that he's used to signed the update isn't known by the client there",
    "start": "2299250",
    "end": "2305700"
  },
  {
    "text": "is only a public key that he is installed that is hard-coded into the former firmware updates are available on",
    "start": "2305700",
    "end": "2314460"
  },
  {
    "text": "the vendor websites and can be installed using an admin account just using a",
    "start": "2314460",
    "end": "2321210"
  },
  {
    "text": "single command so the difference is that",
    "start": "2321210",
    "end": "2327119"
  },
  {
    "text": "the HSM will first search for the certificate thanks to a specific",
    "start": "2327119",
    "end": "2333300"
  },
  {
    "text": "attribute this attribute cannot be set by your client to buy a client it's it's",
    "start": "2333300",
    "end": "2341280"
  },
  {
    "text": "not possible so thanks to these attributes the hsm retrieves the",
    "start": "2341280",
    "end": "2346590"
  },
  {
    "text": "certificate and the client using the handle sends the banner a date binary",
    "start": "2346590",
    "end": "2353880"
  },
  {
    "text": "and if the signature is valid then the HSN install the update and reboot",
    "start": "2353880",
    "end": "2361970"
  },
  {
    "text": "however there is a logical flow because an attacker can install random",
    "start": "2361970",
    "end": "2368550"
  },
  {
    "text": "certificates without any attribute without any specific attribute or using",
    "start": "2368550",
    "end": "2377100"
  },
  {
    "text": "the handle of the certificates the a date mechanism will work without any",
    "start": "2377100",
    "end": "2384660"
  },
  {
    "text": "check so that's all that's actually pretty simple it allows us to install a",
    "start": "2384660",
    "end": "2391620"
  },
  {
    "text": "malicious updates as I will show in the in the next part that will allow us to",
    "start": "2391620",
    "end": "2398690"
  },
  {
    "text": "to gain persistence I think that gaining",
    "start": "2398690",
    "end": "2406470"
  },
  {
    "text": "persistence a HSM is obviously interesting for an attacker because he",
    "start": "2406470",
    "end": "2413670"
  },
  {
    "text": "will access the HSM after reboot or even after a legitimate fam'ly upgrade so how",
    "start": "2413670",
    "end": "2423120"
  },
  {
    "text": "can we found a place to write a backdoor well the only assitant memory that",
    "start": "2423120",
    "end": "2430380"
  },
  {
    "text": "exists on the HSM is a flash memory because it's survived the memory is not",
    "start": "2430380",
    "end": "2436560"
  },
  {
    "text": "reset across a reboot this flash memory contains almost everything the",
    "start": "2436560",
    "end": "2442740"
  },
  {
    "text": "bootloader the firmware obviously as a data of the HSM the HSM",
    "start": "2442740",
    "end": "2449520"
  },
  {
    "text": "operating system has read and write access to this memory an attacker can",
    "start": "2449520",
    "end": "2455790"
  },
  {
    "text": "reuse this primitive to write its backdoor into the into the file system",
    "start": "2455790",
    "end": "2463340"
  },
  {
    "text": "so writing the back door is actually not straightforward because there are two",
    "start": "2465210",
    "end": "2471280"
  },
  {
    "text": "constraints the first one is there is not much memory available",
    "start": "2471280",
    "end": "2476440"
  },
  {
    "text": "not much ram memory available on the HSN so we cannot upload a lot of tools to do",
    "start": "2476440",
    "end": "2484720"
  },
  {
    "text": "whatever we want we already have to to to keep a really",
    "start": "2484720",
    "end": "2492700"
  },
  {
    "text": "small back door additionally there is no second chance because if we fail at",
    "start": "2492700",
    "end": "2499060"
  },
  {
    "text": "writing a valid image into the flash memory the HSM will not boot any more",
    "start": "2499060",
    "end": "2505390"
  },
  {
    "text": "and there is no way to make it work again so that means that we have to buy",
    "start": "2505390",
    "end": "2510610"
  },
  {
    "text": "a new HSM if we fail at writing a crack backdoor that's pretty expensive so we",
    "start": "2510610",
    "end": "2518050"
  },
  {
    "text": "must be very careful so we once we gain a deep understanding",
    "start": "2518050",
    "end": "2526990"
  },
  {
    "text": "of the update mechanism we were able to write our backdoor it is a shared",
    "start": "2526990",
    "end": "2535030"
  },
  {
    "text": "library that is preloaded into the main process of the HSM during during the",
    "start": "2535030",
    "end": "2540850"
  },
  {
    "text": "startup this implant those two things the first one is to hook the update",
    "start": "2540850",
    "end": "2547870"
  },
  {
    "text": "mechanism to survive across legitimate updates and also to hook some piggies at",
    "start": "2547870",
    "end": "2554290"
  },
  {
    "text": "some critical functions for instance to backdoor the random generator and we",
    "start": "2554290",
    "end": "2564790"
  },
  {
    "text": "continue on a quick demo this is the source code of a program that is",
    "start": "2564790",
    "end": "2571330"
  },
  {
    "text": "executed on the host and we can see a call to generate random which is made on",
    "start": "2571330",
    "end": "2579250"
  },
  {
    "text": "the host which is actually done on the HSM to retrieve some random data",
    "start": "2579250",
    "end": "2586830"
  },
  {
    "text": "so here is the source code of this program so there is a back door that is",
    "start": "2592240",
    "end": "2598810"
  },
  {
    "text": "installed on the ageism we ran this program to get one byte of random memory",
    "start": "2598810",
    "end": "2605800"
  },
  {
    "text": "or 4 bytes 16 bytes or more data 128",
    "start": "2605800",
    "end": "2612610"
  },
  {
    "text": "bytes and I think that you noticed a pattern the data is not random at all",
    "start": "2612610",
    "end": "2619800"
  },
  {
    "text": "that's because we back doors a random generator we just patched the one of the",
    "start": "2619800",
    "end": "2626560"
  },
  {
    "text": "function of the crypto key table so this part of the backdoor is trivial the",
    "start": "2626560",
    "end": "2633750"
  },
  {
    "text": "difficult part is writing the backdoor to the filesystem",
    "start": "2633750",
    "end": "2640290"
  },
  {
    "text": "to sum it up we did a vulnerability research to to find vulnerabilities that",
    "start": "2645840",
    "end": "2654520"
  },
  {
    "text": "allows us to gain arbitrary code execution without any credential on the",
    "start": "2654520",
    "end": "2659680"
  },
  {
    "text": "HSM that is a pre authentication exploit there is still an open question we don't",
    "start": "2659680",
    "end": "2666550"
  },
  {
    "text": "know if our expert will work against Network HSM we think so but we don't",
    "start": "2666550",
    "end": "2672880"
  },
  {
    "text": "have any network version of this HSM confirmed as that hypothesis once we",
    "start": "2672880",
    "end": "2682150"
  },
  {
    "text": "gain arbitrary code execution we are able to dump the whole flash memory along the encryption key and that allows",
    "start": "2682150",
    "end": "2690100"
  },
  {
    "text": "an attacker to decrypt every secrets of the ageism we also found a vulnerability",
    "start": "2690100",
    "end": "2700840"
  },
  {
    "text": "that allows to bypass farmer signature",
    "start": "2700840",
    "end": "2706980"
  },
  {
    "text": "which breaks entirely the hsm integrity and an attacker to gain persistence and",
    "start": "2706980",
    "end": "2714550"
  },
  {
    "text": "the ageism we reported every vulnerability to the",
    "start": "2714550",
    "end": "2720720"
  },
  {
    "text": "vendor who issue a new firmware update after a few weeks we would like to",
    "start": "2720720",
    "end": "2728040"
  },
  {
    "text": "highlight that these updates is available for the latest model of the",
    "start": "2728040",
    "end": "2734340"
  },
  {
    "text": "HSM but also for models that aren't supported anymore because the",
    "start": "2734340",
    "end": "2740070"
  },
  {
    "text": "vulnerabilities are critical so obviously pay attention to your valid",
    "start": "2740070",
    "end": "2745710"
  },
  {
    "text": "security advisories finally we'd like to",
    "start": "2745710",
    "end": "2752270"
  },
  {
    "text": "remain remind that it is not an exhaustive study we only assess the",
    "start": "2752270",
    "end": "2759540"
  },
  {
    "text": "security of a single model of HSM of a specific vendor we will be very curious",
    "start": "2759540",
    "end": "2767100"
  },
  {
    "text": "about the security of other models and other vendors we hope that it gives us a",
    "start": "2767100",
    "end": "2775260"
  },
  {
    "text": "methodology to look for vulnerabilities for other security researchers that we",
    "start": "2775260",
    "end": "2780750"
  },
  {
    "text": "will see all those chilies in diffusional and finally HSM are",
    "start": "2780750",
    "end": "2788190"
  },
  {
    "text": "certified against hardware attacks but it doesn't make much sense if the",
    "start": "2788190",
    "end": "2793710"
  },
  {
    "text": "software running on HSN is insecure so we would love to see initiative about",
    "start": "2793710",
    "end": "2802190"
  },
  {
    "text": "you to have secure software running on ageism obviously thank you very much for",
    "start": "2802190",
    "end": "2809940"
  },
  {
    "text": "your attention [Applause]",
    "start": "2809940",
    "end": "2814760"
  },
  {
    "text": "thank you and if you like to ask questions we have a few minutes for that just please use the microphones in the",
    "start": "2818480",
    "end": "2824550"
  },
  {
    "text": "middle of the room hi I was curious did",
    "start": "2824550",
    "end": "2840990"
  },
  {
    "text": "the hsm audit logs record any of your attempts so the question is is any logs",
    "start": "2840990",
    "end": "2851340"
  },
  {
    "text": "of expert atoms on the axes of I would",
    "start": "2851340",
    "end": "2856800"
  },
  {
    "text": "say no because our experts are only",
    "start": "2856800",
    "end": "2866180"
  },
  {
    "text": "cryptokey calls it is expected so",
    "start": "2866180",
    "end": "2871370"
  },
  {
    "text": "ex-wife doesn't leave any trace on the HSN logs okay thank you thank you for",
    "start": "2871370",
    "end": "2883470"
  },
  {
    "text": "joining the session if any further questions you could please meet the presenters in the wrap-up room thank you",
    "start": "2883470",
    "end": "2891320"
  },
  {
    "text": "[Applause]",
    "start": "2891360",
    "end": "2894719"
  }
]