[
  {
    "start": "0",
    "end": "80000"
  },
  {
    "text": "foreign",
    "start": "1979",
    "end": "4159"
  },
  {
    "text": "this talk is about as you can see here we have placed a lot of devices so we'll",
    "start": "9540",
    "end": "14940"
  },
  {
    "text": "try to explain everything in a moment but in in summary we are going to talk a different approach on how to bypass the",
    "start": "14940",
    "end": "22199"
  },
  {
    "text": "secure boat on on a specific Qualcomm stock in this case we we are going to present",
    "start": "22199",
    "end": "29400"
  },
  {
    "text": "how can we try to achieve this goal without knowing anything about the the software is running inside the sock",
    "start": "29400",
    "end": "35820"
  },
  {
    "text": "anything about how the secure boot has been implemented or any particular if instruction we want to to escape or",
    "start": "35820",
    "end": "42600"
  },
  {
    "text": "something like that this is the the that the reason we name blind glitch because we are blind we don't know anything and",
    "start": "42600",
    "end": "49379"
  },
  {
    "text": "we are trying to bypass this so I'll start talking about us so my name is Hector Marco I am the founder of cyber",
    "start": "49379",
    "end": "56039"
  },
  {
    "text": "intelligence it's a company based in Spain and my colleague is vicent now is Hardware security researcher so we have",
    "start": "56039",
    "end": "63660"
  },
  {
    "text": "been working in in smartphone security for a while I've been working in cyber security for more than 15 years right",
    "start": "63660",
    "end": "70200"
  },
  {
    "text": "now and as I say we are working in both server and cyber security at the company so today we are going to talk just about",
    "start": "70200",
    "end": "76920"
  },
  {
    "text": "Hardware but we are also doing software stuff so right now we are working in a project",
    "start": "76920",
    "end": "82740"
  },
  {
    "start": "80000",
    "end": "80000"
  },
  {
    "text": "this project is basically named the X5 project so in this project the one of",
    "start": "82740",
    "end": "88799"
  },
  {
    "text": "the main goals is to be able to access to data I store it in modern smartphones",
    "start": "88799",
    "end": "93840"
  },
  {
    "text": "so as you can imagine so right now it's not an easy task because everything is encrypted we have the trusted Zone we",
    "start": "93840",
    "end": "100619"
  },
  {
    "text": "have a lot of crypto devices so one of the main goals is be able to access to",
    "start": "100619",
    "end": "107520"
  },
  {
    "text": "this data in in order to provide this critical evidences in criminal cases",
    "start": "107520",
    "end": "113340"
  },
  {
    "text": "right so we want somehow to access to that evidences so the main goals is fun ways so we need",
    "start": "113340",
    "end": "121380"
  },
  {
    "text": "to find ways but at the same time we need strong security for users but we also need to provide mechanisms to",
    "start": "121380",
    "end": "127320"
  },
  {
    "text": "access to this to this data okay in for especially in order to to solve criminal",
    "start": "127320",
    "end": "132840"
  },
  {
    "text": "cases so as you can imagine we have Sovereign and Hardware approaches for that",
    "start": "132840",
    "end": "137940"
  },
  {
    "text": "so in this talk we are going to just talk about uh Hardware methods okay",
    "start": "137940",
    "end": "145379"
  },
  {
    "text": "and basically we are going to create and develop tools to improve reverse engineering means that we are going to",
    "start": "145379",
    "end": "151739"
  },
  {
    "text": "try to go beyond the state of the art in order to provide the last method and Technologies in order to be able to",
    "start": "151739",
    "end": "158340"
  },
  {
    "text": "retrieve data for this encrypted smartphones so about this talk so the main goals as",
    "start": "158340",
    "end": "164640"
  },
  {
    "text": "I say is bypass the secure boot all right in real Hardwares bfu will means",
    "start": "164640",
    "end": "171000"
  },
  {
    "text": "before the first usage which means you have the smartphone something like that",
    "start": "171000",
    "end": "176040"
  },
  {
    "text": "and then you just need to press the power button and this is the only thing you have you don't have the code running",
    "start": "176040",
    "end": "182220"
  },
  {
    "text": "you don't have privileges you cannot inject anything we are assuming that we don't have any vulnerability or at least",
    "start": "182220",
    "end": "188580"
  },
  {
    "text": "we don't know any vulnerability so we are blind so how can we approach that",
    "start": "188580",
    "end": "194099"
  },
  {
    "text": "so the second main goal is is not only by passing the security route we need to to have the smartphone in a stable way",
    "start": "194099",
    "end": "201239"
  },
  {
    "text": "so we want to run code with maximum privileges so it means el3 in irm",
    "start": "201239",
    "end": "207659"
  },
  {
    "text": "and why not let's try to provide a genetic method so we are blind we can",
    "start": "207659",
    "end": "213060"
  },
  {
    "text": "not run any code we want Maxim Privileges and on top of that we will like these method to be applied to other",
    "start": "213060",
    "end": "218760"
  },
  {
    "text": "smartphones or other devices so why not so to start with we just pick this",
    "start": "218760",
    "end": "225180"
  },
  {
    "text": "device under test which is the one we have in here in the in the table we have three of them one of them is already",
    "start": "225180",
    "end": "231720"
  },
  {
    "text": "running the assembly explain a minute later on about that so this is the dragon board basically we",
    "start": "231720",
    "end": "237060"
  },
  {
    "text": "started with a development board because we don't we didn't want to start with a super hard stuff we just started with",
    "start": "237060",
    "end": "243720"
  },
  {
    "text": "Dragon Ball uh for DC which uses the MSM 8916 sock is the one",
    "start": "243720",
    "end": "251220"
  },
  {
    "text": "you can see on the screen all right so as you can imagine the dragon bar is",
    "start": "251220",
    "end": "257760"
  },
  {
    "start": "254000",
    "end": "254000"
  },
  {
    "text": "just in the Qualcomm security boot is following that that uh let's say that standard so this board comes with the",
    "start": "257760",
    "end": "264479"
  },
  {
    "text": "security boot disabled so this could strange to you but don't worry I'll spend a minute so",
    "start": "264479",
    "end": "271500"
  },
  {
    "text": "one thing you need to confuse is that we have two main things we have the secure",
    "start": "271500",
    "end": "276960"
  },
  {
    "text": "Boot and we have the has verification means that if you try because I have heard about many guys working in",
    "start": "276960",
    "end": "283139"
  },
  {
    "text": "different industry cars and so on that they are just dumping the firmware modifying us couple of bits loading the",
    "start": "283139",
    "end": "290580"
  },
  {
    "text": "filter again and then running it and then you will get errors why because this is a cube root sometimes this is",
    "start": "290580",
    "end": "296699"
  },
  {
    "text": "not the real reason sometimes it's because there is a hash verification so you need to at least know how this has",
    "start": "296699",
    "end": "303060"
  },
  {
    "text": "and secure boot works at least a high level okay so this is what I'm saying here right so",
    "start": "303060",
    "end": "309000"
  },
  {
    "text": "modifying the boots rather modifying any code in the field word will result in a fail not because the security rule but",
    "start": "309000",
    "end": "314100"
  },
  {
    "text": "because it has at least in this board so the first thing we did was enable the secure boot right so that means that we",
    "start": "314100",
    "end": "321660"
  },
  {
    "text": "have the keys means that we can create our own firmware and then run it in the board right but this is just for the",
    "start": "321660",
    "end": "328320"
  },
  {
    "text": "initial steps right so the final goal is we will be blind we will have zero information about what is going there so",
    "start": "328320",
    "end": "334080"
  },
  {
    "text": "we are not going to use anything in order to bypass the security boot later on okay",
    "start": "334080",
    "end": "339960"
  },
  {
    "text": "so if we want to buy bicycle of this kind of devices right so first we need",
    "start": "339960",
    "end": "345360"
  },
  {
    "text": "to know in which point because you can do it at different levels you can do in what the system is fully running you can",
    "start": "345360",
    "end": "351660"
  },
  {
    "text": "try to glitch an application glitch the kernel gives the monitor gets whatever right",
    "start": "351660",
    "end": "357960"
  },
  {
    "text": "so we think I will find a minute that in some cases the earlier the better so we",
    "start": "357960",
    "end": "363600"
  },
  {
    "text": "aim to bypass during the boot process so even in that point if you are looking",
    "start": "363600",
    "end": "368820"
  },
  {
    "text": "forward to bypass the security boot when the system is booting what your smartphone is built in and this makes sense because remember we are in the BF",
    "start": "368820",
    "end": "375720"
  },
  {
    "text": "view before first usage mean that we have the smartphone but the smartphone is completely off so you don't know the",
    "start": "375720",
    "end": "382620"
  },
  {
    "text": "pin you don't know the pattern you cannot attack once the kernel or the full application of the device has been",
    "start": "382620",
    "end": "388380"
  },
  {
    "text": "unlocked so we are aim our aim is to bypass it during the boot process right",
    "start": "388380",
    "end": "394020"
  },
  {
    "text": "so I'll explain a minute one means pbl sbl and edl maybe some of you already know but just to ensure that we are all",
    "start": "394020",
    "end": "400680"
  },
  {
    "text": "in the same page so the primary boot rather is the first thing you will you will execute when you press the the",
    "start": "400680",
    "end": "407580"
  },
  {
    "text": "power on in your smartphone also name or known as bootron probably you know so it",
    "start": "407580",
    "end": "413220"
  },
  {
    "text": "is the first code to be executed in a smartphone so the second is the secondary button I'll explain that in a",
    "start": "413220",
    "end": "420479"
  },
  {
    "text": "minute so which is in charge of what next layers next stages",
    "start": "420479",
    "end": "425699"
  },
  {
    "text": "but there is an important mode which is edl which is emergency download mode",
    "start": "425699",
    "end": "431100"
  },
  {
    "text": "that basically is the one that if something happens that suppose that you",
    "start": "431100",
    "end": "436319"
  },
  {
    "text": "know you are trying to repair your smartphone and then you remove the flash or the M emmc or ufs",
    "start": "436319",
    "end": "442319"
  },
  {
    "text": "what will happen in that case or probably you have seen a lot of people trying to reflect devices when",
    "start": "442319",
    "end": "449520"
  },
  {
    "text": "your smartphone even doesn't bought that doesn't boot right so the idea is there is an emergency mode that in case you",
    "start": "449520",
    "end": "456240"
  },
  {
    "text": "have your your flash or your flash partitions super damage or whatever you",
    "start": "456240",
    "end": "461699"
  },
  {
    "text": "can always have some communication with the device this is the emergency download mode align a minute",
    "start": "461699",
    "end": "467759"
  },
  {
    "text": "okay so this emergency download mode can be basically uh you can just connect a",
    "start": "467759",
    "end": "473160"
  },
  {
    "text": "USB cable to your smartphone so you can just remove the flash then you you can just press the power button button and",
    "start": "473160",
    "end": "480300"
  },
  {
    "text": "then what you will see is that the phone is on different state so from that point on you can talk via USB to that phone",
    "start": "480300",
    "end": "487259"
  },
  {
    "text": "right even if you don't have flash so this code is inside the the pbl and",
    "start": "487259",
    "end": "492840"
  },
  {
    "text": "this is called the emergency download mode so in that point you can actually send call same programmers and stuff to their",
    "start": "492840",
    "end": "500160"
  },
  {
    "text": "to the smartphone and the smartphone will love this code but if this code is",
    "start": "500160",
    "end": "506099"
  },
  {
    "text": "actually sign it so that's the challenge right so we will see in a minute this is",
    "start": "506099",
    "end": "511139"
  },
  {
    "text": "useful when partitions are corrupted so this is what I say and the good thing is that for this",
    "start": "511139",
    "end": "516479"
  },
  {
    "text": "board in that mode as you can expect it's running with",
    "start": "516479",
    "end": "522419"
  },
  {
    "text": "maximum privileges means that you should be able to reflash all partitions right you should be able to do whatever you",
    "start": "522419",
    "end": "529380"
  },
  {
    "text": "want but as you can imagine this has been only allowed to for for Qualcomm the stuff so that means that either you",
    "start": "529380",
    "end": "536339"
  },
  {
    "text": "have an image verification you have an image with the proper signature with the",
    "start": "536339",
    "end": "541380"
  },
  {
    "text": "proper stuff so otherwise the edl will reject that right so you can tell me whatever you want but you need to sign",
    "start": "541380",
    "end": "548399"
  },
  {
    "text": "this kind of tab you are sending me to me so our attack I'll find a minute",
    "start": "548399",
    "end": "553980"
  },
  {
    "text": "bypasses exactly that so let's put the the the smartphone in a strange State",
    "start": "553980",
    "end": "559740"
  },
  {
    "text": "let's try to force an error then we'll go to the major scene download mode and then in that point we will send some",
    "start": "559740",
    "end": "566040"
  },
  {
    "text": "code to be executed why the smartphone will try to verify that",
    "start": "566040",
    "end": "571200"
  },
  {
    "text": "if we manage to do the glitch exactly in that point that is doing this verification then we should be able to",
    "start": "571200",
    "end": "577080"
  },
  {
    "text": "run arbitrary code with maximum privileges right again the attack doesn't depend on flash",
    "start": "577080",
    "end": "583800"
  },
  {
    "text": "partition so I don't care Android version I don't care about the budweather version I don't care about anything you just need to tell me which",
    "start": "583800",
    "end": "590880"
  },
  {
    "text": "is the sock you are using your phone and this attack will be reproducible among all other devices using that so I don't",
    "start": "590880",
    "end": "597240"
  },
  {
    "text": "care about any version about anything like that so just to to refresh you guys so we",
    "start": "597240",
    "end": "602459"
  },
  {
    "text": "have in modern smartphone we have the secure world and we have the normal World remember in here in the normal in",
    "start": "602459",
    "end": "608820"
  },
  {
    "text": "the in the normal worries when we are running Android and all the stuff and this is running in background let's say that",
    "start": "608820",
    "end": "614700"
  },
  {
    "text": "so what happened is that when you press the power on button so the first thing is the the first call to be executed is",
    "start": "614700",
    "end": "622200"
  },
  {
    "text": "the boot room you already know that we also know as a pbl primary bootloader",
    "start": "622200",
    "end": "628800"
  },
  {
    "text": "okay so the next steps are to load the secure svl we are still in the secure",
    "start": "628800",
    "end": "636540"
  },
  {
    "text": "world right so this code is also let's say trustworthy for us",
    "start": "636540",
    "end": "642959"
  },
  {
    "text": "okay and from that point the next step is load the non-secure svl and also all",
    "start": "642959",
    "end": "650040"
  },
  {
    "text": "the stuff related with trusted Sun trusted operating system trusted libraries trusted applications okay the",
    "start": "650040",
    "end": "657000"
  },
  {
    "text": "communication the monitor all the stuff involved in the trusted Zone that you probably know so we don't care about",
    "start": "657000",
    "end": "662760"
  },
  {
    "text": "that but just to let you know this is in the normal world and as you can see also all of this",
    "start": "662760",
    "end": "669480"
  },
  {
    "text": "stuff is in the flash memory right and all this stuff is in the wrong",
    "start": "669480",
    "end": "676920"
  },
  {
    "text": "so that's interesting for us because if we can manage to try to",
    "start": "676920",
    "end": "682320"
  },
  {
    "text": "fail or produce an error or to force to enter the phone in this emergency",
    "start": "682320",
    "end": "688620"
  },
  {
    "text": "download mode means that we are still in Rome right so that means that you will be able to",
    "start": "688620",
    "end": "695600"
  },
  {
    "text": "somehow be in the maximum privileges in a mode that doesn't depend on the file",
    "start": "695600",
    "end": "701399"
  },
  {
    "text": "system on the version Android on anything like that okay so that's the idea that's that's the",
    "start": "701399",
    "end": "708420"
  },
  {
    "text": "main idea so remember when we are in edl mode so the next step is through USB you",
    "start": "708420",
    "end": "714060"
  },
  {
    "text": "can send a programmer right but this program has to be signed by Qualcomm",
    "start": "714060",
    "end": "719459"
  },
  {
    "text": "right and from that point this is like like a loop waiting for command so you can actually talk to this programmer you",
    "start": "719459",
    "end": "726839"
  },
  {
    "text": "have just sent through via USB that's the main idea all right so",
    "start": "726839",
    "end": "732120"
  },
  {
    "text": "power on for an error send a programmer wait for commands the problem is if you",
    "start": "732120",
    "end": "738839"
  },
  {
    "text": "use a liquid Signet programming on the internet you will be very restricted",
    "start": "738839",
    "end": "744720"
  },
  {
    "text": "about the things you can do you will not be able to down memory you will not be able to write any random memory or",
    "start": "744720",
    "end": "750180"
  },
  {
    "text": "something like that means which that means that it's not useful for us because our main idea is let's try to",
    "start": "750180",
    "end": "755820"
  },
  {
    "text": "run code in that place right so we can for example dump",
    "start": "755820",
    "end": "762060"
  },
  {
    "text": "the pbl the boot room right so that will be the first step towards uh not being blind let's say",
    "start": "762060",
    "end": "768480"
  },
  {
    "text": "that okay that's the main idea so this is exactly the point we are",
    "start": "768480",
    "end": "774660"
  },
  {
    "text": "trying to glitch right we want to bypass this signature",
    "start": "774660",
    "end": "780420"
  },
  {
    "text": "verification again the attack doesn't depend on the flash partitions",
    "start": "780420",
    "end": "786240"
  },
  {
    "text": "so the first question we we did ourselves is all right so how we've worked this verification so I'll explain",
    "start": "786240",
    "end": "792300"
  },
  {
    "text": "in a minute so this is how it looks the programmer we are sending through the USB so basically it's a regular elf with",
    "start": "792300",
    "end": "801420"
  },
  {
    "start": "793000",
    "end": "793000"
  },
  {
    "text": "a special segment let's say that in this inspection segment you'll see that there",
    "start": "801420",
    "end": "806700"
  },
  {
    "text": "is a hash table header a couple of hashes a signature and also a couple of",
    "start": "806700",
    "end": "813300"
  },
  {
    "text": "certificates summarizing all these houses are to ensure that",
    "start": "813300",
    "end": "819300"
  },
  {
    "text": "those parts aren't touched so if you change one single bit here means that",
    "start": "819300",
    "end": "825060"
  },
  {
    "text": "this has will be different right if this is completely different this",
    "start": "825060",
    "end": "830279"
  },
  {
    "text": "will be a mismatch or if you keep that hand the signature will fail so basically this is how the secure boot",
    "start": "830279",
    "end": "836519"
  },
  {
    "text": "has been implemented or how the signature verification has been implemented right",
    "start": "836519",
    "end": "841740"
  },
  {
    "text": "so if we expand this signature uh the certificate stuff we will see three",
    "start": "841740",
    "end": "848040"
  },
  {
    "text": "certificates so the good news is that that the the bottom one is only take",
    "start": "848040",
    "end": "854279"
  },
  {
    "text": "against the root key has there is no uh decryption plus uh let's say basically",
    "start": "854279",
    "end": "861240"
  },
  {
    "text": "we are not verifying this root certificate as we are doing in the in those steps because here what is",
    "start": "861240",
    "end": "867660"
  },
  {
    "text": "basically born in the in the fuses here is just a has right so basically we are",
    "start": "867660",
    "end": "873240"
  },
  {
    "text": "getting the hash value of this certificate and then comparing it again that has that has been uh born in the",
    "start": "873240",
    "end": "880800"
  },
  {
    "text": "fuses of the boards right so it's it looked like the similar but it is not",
    "start": "880800",
    "end": "886079"
  },
  {
    "text": "because in that case basically uh what you want to do is you want to to decrypt",
    "start": "886079",
    "end": "891420"
  },
  {
    "text": "and compare the hats with the verification the classical verification operation but in that case it's only just a comparison",
    "start": "891420",
    "end": "898440"
  },
  {
    "text": "so it looks easier to try to bypass this than try to bypass the other",
    "start": "898440",
    "end": "904320"
  },
  {
    "text": "so we have as I say multiple opportunities one is the one I just mentioned but we could also try to",
    "start": "904320",
    "end": "910920"
  },
  {
    "text": "bypass the this step means that when uh means that you can change this and this",
    "start": "910920",
    "end": "916800"
  },
  {
    "text": "and this try to do contain from here to to apps but at the end of the day if you",
    "start": "916800",
    "end": "922800"
  },
  {
    "text": "do that you need to keep that or you will fail so in summarizing you will have a lot of places when you can glitch",
    "start": "922800",
    "end": "928920"
  },
  {
    "text": "and you can bypass okay but is which one we should choose as I say it's",
    "start": "928920",
    "end": "933959"
  },
  {
    "text": "much more or it simply simplifies the attack if you choose the first one another explain a minute why when we see",
    "start": "933959",
    "end": "939420"
  },
  {
    "text": "the power traces okay so why this simplifies the attack why is is is is is",
    "start": "939420",
    "end": "944760"
  },
  {
    "text": "the very is better to do that well Alex in a minute but as I said the goal",
    "start": "944760",
    "end": "951540"
  },
  {
    "start": "947000",
    "end": "947000"
  },
  {
    "text": "is bypass the first verification so just to to refresh you about what we are talking about how we obtain the this",
    "start": "951540",
    "end": "958980"
  },
  {
    "text": "code in order to do the reverse engineering in order to know that it's better to do this first attempt or we",
    "start": "958980",
    "end": "966839"
  },
  {
    "text": "didn't so we don't know right so we are blind and we don't know what",
    "start": "966839",
    "end": "972660"
  },
  {
    "text": "we are glitching right that's that's the point so and then how do you know where you should glitch if you don't have the",
    "start": "972660",
    "end": "978899"
  },
  {
    "text": "code and you cannot expect it this is the if in here is doing the hash comparison I want to glitch in here so",
    "start": "978899",
    "end": "984180"
  },
  {
    "text": "this is what you will find everywhere so do the glitch here we don't know we don't have the code if we have the code",
    "start": "984180",
    "end": "990720"
  },
  {
    "text": "we don't need to do that right but we can guess a probably timing",
    "start": "990720",
    "end": "996360"
  },
  {
    "text": "area we can guess okay more or less should be around this area so that's that's our approach also in a minute",
    "start": "996360",
    "end": "1002600"
  },
  {
    "text": "okay and how can we determine this is the area whether it's a easy trick that",
    "start": "1002600",
    "end": "1007699"
  },
  {
    "text": "we find that basically we can just send two programmers one with a valid root key means that",
    "start": "1007699",
    "end": "1014779"
  },
  {
    "text": "this is the original one sign it by Qualcomm which have limited capabilities is not useful for us but you can just",
    "start": "1014779",
    "end": "1021500"
  },
  {
    "text": "send it right you will get a success let's say that right but if you just slightly modify",
    "start": "1021500",
    "end": "1029178"
  },
  {
    "text": "the the parameter with a wrong key then this parameter will be rejected",
    "start": "1029179",
    "end": "1034579"
  },
  {
    "text": "but this will leave some power traces that's the point right so in here we",
    "start": "1034579",
    "end": "1041178"
  },
  {
    "text": "will see on the left a Power Trace when we are sending a valid programmer okay",
    "start": "1041179",
    "end": "1046880"
  },
  {
    "text": "to the edl with a valid root key nothing happens",
    "start": "1046880",
    "end": "1053660"
  },
  {
    "text": "but on the right we'll see that the same Power Trace when trying to load a programmer with a wrong key",
    "start": "1053660",
    "end": "1061220"
  },
  {
    "text": "let's say that so what do we expect from here",
    "start": "1061220",
    "end": "1067760"
  },
  {
    "text": "well we you can just look at this we don't know exactly where but we can",
    "start": "1067760",
    "end": "1074000"
  },
  {
    "text": "say that it will be around here because otherwise we will see more Power Trace",
    "start": "1074000",
    "end": "1080660"
  },
  {
    "text": "right okay we don't know where we didn't see the code we know this more or less around this area right",
    "start": "1080660",
    "end": "1088640"
  },
  {
    "text": "so I'll show you this full attack overview and later on this end will give",
    "start": "1088640",
    "end": "1093740"
  },
  {
    "text": "you a a more precise details about the equipment we have used and we will do a real demo about we are presenting here",
    "start": "1093740",
    "end": "1101000"
  },
  {
    "text": "today so we have our computer okay we have also a USB a sniffer which is we are",
    "start": "1101000",
    "end": "1106880"
  },
  {
    "text": "using the Beagle but you can use uh different stuff we have the glitch generator okay we are using this Peri",
    "start": "1106880",
    "end": "1112940"
  },
  {
    "text": "Nano but this is something later on and we have a power supply we basically is powering the board okay so the first",
    "start": "1112940",
    "end": "1119960"
  },
  {
    "text": "step is send a crafter programmer so it means that you get you can download the",
    "start": "1119960",
    "end": "1126140"
  },
  {
    "text": "programmer from Qualcomm right you can add the code you want the one",
    "start": "1126140",
    "end": "1131360"
  },
  {
    "text": "they're perfect for you with pig and pork read right whatever execute the extraction whatever you want to do and",
    "start": "1131360",
    "end": "1137179"
  },
  {
    "text": "then you are going to send this programmer to the board but we'll go through the USB as nifer",
    "start": "1137179",
    "end": "1143660"
  },
  {
    "text": "right until reach the board but",
    "start": "1143660",
    "end": "1149240"
  },
  {
    "text": "we will detect when this program is Going Through the Wire",
    "start": "1149240",
    "end": "1154240"
  },
  {
    "text": "and when we see this parameter Going Through the Wire what we're going to do is to do this glitch we will do a sort",
    "start": "1154520",
    "end": "1160880"
  },
  {
    "text": "of the b d in the in the board right so basically we are going to send the",
    "start": "1160880",
    "end": "1166940"
  },
  {
    "text": "programmer and trying to predict this area I showed you before and then reduce",
    "start": "1166940",
    "end": "1172520"
  },
  {
    "text": "the voltage we are powering the board right if we",
    "start": "1172520",
    "end": "1177559"
  },
  {
    "text": "fail we just need to try again we will cook the power and we will restore the power",
    "start": "1177559",
    "end": "1182900"
  },
  {
    "text": "and we will try again okay that's the main idea so now descent is going to",
    "start": "1182900",
    "end": "1188000"
  },
  {
    "text": "explain you the equipment we use and we will do the the real demo in here thank",
    "start": "1188000",
    "end": "1193460"
  },
  {
    "text": "you okay so thank you very much sector um okay so as actor explained earlier uh",
    "start": "1193460",
    "end": "1199880"
  },
  {
    "text": "we have the PC that's our main control uh then our fpga the one we're going to",
    "start": "1199880",
    "end": "1205640"
  },
  {
    "text": "use to actually glitch the device is the cheap Whisperer Nano uh this is",
    "start": "1205640",
    "end": "1210919"
  },
  {
    "text": "obviously controlled uh thanks to RPC but it's going to be triggered by our",
    "start": "1210919",
    "end": "1216580"
  },
  {
    "text": "USB sniffer in this case is the the Beagle um and the way we reset the the board is",
    "start": "1216580",
    "end": "1226160"
  },
  {
    "text": "thanks to relay that really is connected to the power supply of the board and with our PC what we're going to do is",
    "start": "1226160",
    "end": "1233260"
  },
  {
    "text": "activate the relay cut power and then restart the the board very simple",
    "start": "1233260",
    "end": "1240080"
  },
  {
    "text": "obviously our device under test is the the dragon board as we have in talking",
    "start": "1240080",
    "end": "1246260"
  },
  {
    "start": "1246000",
    "end": "1246000"
  },
  {
    "text": "so the first step is activated security boot because it comes disabled by by",
    "start": "1246260",
    "end": "1252559"
  },
  {
    "text": "default uh thankfully Qualcomm has Tools in order to to activate secure boot you",
    "start": "1252559",
    "end": "1258620"
  },
  {
    "text": "can find them in the development section of their web uh it's really under the",
    "start": "1258620",
    "end": "1264679"
  },
  {
    "text": "Windows 10 iot core section but there you will find a",
    "start": "1264679",
    "end": "1269780"
  },
  {
    "text": "SEC tools which is the the set of tools used to activate secure boot it's in",
    "start": "1269780",
    "end": "1274820"
  },
  {
    "text": "Python and there are some batch scripts so you can run it on Linux and the customization guide is the actual PDF",
    "start": "1274820",
    "end": "1282140"
  },
  {
    "text": "with instructions to activate the good route in your board so with that out of the way we have to",
    "start": "1282140",
    "end": "1289400"
  },
  {
    "text": "first generate our own Keys those are the keys that we are going to burn into the stock and we also have to take into",
    "start": "1289400",
    "end": "1297440"
  },
  {
    "text": "account that in these devices the the serial number of them is different to",
    "start": "1297440",
    "end": "1305980"
  },
  {
    "text": "that one the one that Qualcomm user expects so we have to modify several",
    "start": "1305980",
    "end": "1311600"
  },
  {
    "text": "files in this case here is the the the number we have to take into account",
    "start": "1311600",
    "end": "1317120"
  },
  {
    "text": "when activity is equipped because l0 are going to have some problems where while loading your own uh",
    "start": "1317120",
    "end": "1325400"
  },
  {
    "text": "programmer or active Institute in general so once we have a security building",
    "start": "1325400",
    "end": "1330679"
  },
  {
    "start": "1329000",
    "end": "1329000"
  },
  {
    "text": "activated we are going to actually touch the device why we need a way to access",
    "start": "1330679",
    "end": "1338140"
  },
  {
    "text": "that uh Power rail we need a way to affect that that core and for that",
    "start": "1338140",
    "end": "1345080"
  },
  {
    "text": "reason we need a clear line a career area inside that that lane for that what",
    "start": "1345080",
    "end": "1351140"
  },
  {
    "text": "we're going to do is remove capacitors from that same Lane uh in order to to",
    "start": "1351140",
    "end": "1357799"
  },
  {
    "text": "expose that that rail what we are going to do is remove c228 the reason why we",
    "start": "1357799",
    "end": "1365299"
  },
  {
    "text": "remove this capacitor is a bit it's convoluted it's it's uh it's quite",
    "start": "1365299",
    "end": "1371500"
  },
  {
    "text": "there has been a lot of research behind a lot of time but we",
    "start": "1371500",
    "end": "1378440"
  },
  {
    "text": "only removing this one we managed to affect the device if you want uh if you want we can explain it later if you have",
    "start": "1378440",
    "end": "1384799"
  },
  {
    "text": "any questions you can come to us and we'll explain in a little more detail later if you want so once we have that",
    "start": "1384799",
    "end": "1391039"
  },
  {
    "text": "removed as you will see there in the left hand side of your screen that's more or less",
    "start": "1391039",
    "end": "1397100"
  },
  {
    "text": "the the schematics of the capacitors that's with the capacitor removed and",
    "start": "1397100",
    "end": "1402200"
  },
  {
    "text": "the upper part is the one connected to the APC rail",
    "start": "1402200",
    "end": "1407360"
  },
  {
    "text": "as you can see that's the same capacitor we soldered a copper wire that goes",
    "start": "1407360",
    "end": "1413179"
  },
  {
    "text": "straight to the cheap Whisperer and that's the one doing our glitches as we explained uh before",
    "start": "1413179",
    "end": "1421280"
  },
  {
    "start": "1421000",
    "end": "1421000"
  },
  {
    "text": "so uh let's go to a very important step daddy that is uh trying to characterize",
    "start": "1421280",
    "end": "1427580"
  },
  {
    "text": "the device try to learn uh what's the the best uh the best glitching",
    "start": "1427580",
    "end": "1433220"
  },
  {
    "text": "parameters in order to affect the device properly in this case",
    "start": "1433220",
    "end": "1438980"
  },
  {
    "text": "if you wins if we insert a very long pulse if we short the line uh for a very",
    "start": "1438980",
    "end": "1445280"
  },
  {
    "text": "long time we will get a restart the the board is going to reboot but we do know",
    "start": "1445280",
    "end": "1450320"
  },
  {
    "text": "the state of that bomb it may be it can crash or it can reboot fully uh",
    "start": "1450320",
    "end": "1455840"
  },
  {
    "text": "nevertheless if we are very short with our timing uh we might not affect the",
    "start": "1455840",
    "end": "1462500"
  },
  {
    "text": "device so the objective is to find a nice spot and Optimum spot in where we",
    "start": "1462500",
    "end": "1469760"
  },
  {
    "text": "can affect the normal behavior of the device but do not crush it or otherwise",
    "start": "1469760",
    "end": "1476299"
  },
  {
    "text": "affect the the continuity the normal activity of the board",
    "start": "1476299",
    "end": "1482000"
  },
  {
    "text": "so uh we activate the security mode so we have the keys in in this in this this",
    "start": "1482000",
    "end": "1487820"
  },
  {
    "text": "step is quite fairly easy we can build our our programmer we are going to see",
    "start": "1487820",
    "end": "1492919"
  },
  {
    "text": "in a minute why we did to graduate this board so with the case that we activated we",
    "start": "1492919",
    "end": "1498860"
  },
  {
    "text": "can load uh we can load them and we can sign sorry the programmer load that",
    "start": "1498860",
    "end": "1504500"
  },
  {
    "text": "programmer in the board and we in this case we modified a function it's called funeral write firmware write is not used",
    "start": "1504500",
    "end": "1511100"
  },
  {
    "text": "in the programmer well it is used but it's only invoked when you send that command via the USB so it's untouched so",
    "start": "1511100",
    "end": "1519140"
  },
  {
    "text": "we can use it uh whenever we want in this case what we did was take the",
    "start": "1519140",
    "end": "1525799"
  },
  {
    "text": "the normal uh programmer we put our gradation code inside one of the",
    "start": "1525799",
    "end": "1531620"
  },
  {
    "text": "segments and then we resigned everything thanks to the Qualcomm provided tools",
    "start": "1531620",
    "end": "1538480"
  },
  {
    "text": "this is the the actual code of the of the of the of the code that we modified",
    "start": "1538480",
    "end": "1545659"
  },
  {
    "text": "there we have the modify function is firmware right in order to trigger a",
    "start": "1545659",
    "end": "1551000"
  },
  {
    "text": "little bit better we had a trigger high in order to see where our",
    "start": "1551000",
    "end": "1556360"
  },
  {
    "text": "Loop is happening in this case the loop is a it's a double nested Loop we want a",
    "start": "1556360",
    "end": "1564500"
  },
  {
    "text": "really big area in order to try to inject glitches in there to see if we are",
    "start": "1564500",
    "end": "1571100"
  },
  {
    "text": "affecting the device or not uh that big area is uh",
    "start": "1571100",
    "end": "1577400"
  },
  {
    "text": "surrounded by a trigger high-end sugar low so we can see where that's happening and then we return to Strings via via",
    "start": "1577400",
    "end": "1586520"
  },
  {
    "text": "USB if the value is expected we return unexpected but if something happened if",
    "start": "1586520",
    "end": "1592279"
  },
  {
    "text": "the value that we are trying to compute if the value that we're expecting is not there or is different that would mean",
    "start": "1592279",
    "end": "1598039"
  },
  {
    "text": "that somehow we affected the device so we are going to return a success this will be the Power Trace of the of",
    "start": "1598039",
    "end": "1606200"
  },
  {
    "text": "the whole operation it's you can see it clearly here but here we will have the",
    "start": "1606200",
    "end": "1612860"
  },
  {
    "text": "lowering of the trigger and here we will have the the rising of the trigger",
    "start": "1612860",
    "end": "1618020"
  },
  {
    "text": "uh in this case there's the the rising Edge and there's the the other Edge so",
    "start": "1618020",
    "end": "1625220"
  },
  {
    "text": "we can see clearly that this is our region so we are going to try to inject the glitch in that region taking into",
    "start": "1625220",
    "end": "1632120"
  },
  {
    "text": "account these timings so what happens contribution made our lives easier in order to advance",
    "start": "1632120",
    "end": "1639260"
  },
  {
    "text": "but okay okay we are going to face devices where we do not have the keys we will we will not be able to cartwrite",
    "start": "1639260",
    "end": "1646279"
  },
  {
    "text": "the device because we don't have the case the the all this uh talk or all these or main objective is to approach a",
    "start": "1646279",
    "end": "1653480"
  },
  {
    "text": "device uh without the keys characterization is still doable it will",
    "start": "1653480",
    "end": "1659240"
  },
  {
    "text": "depend on the device and the different uh triggers and the characteristics of",
    "start": "1659240",
    "end": "1664820"
  },
  {
    "text": "device but it's still doable in this case we took this approach in order to better explain what we did and how we",
    "start": "1664820",
    "end": "1671419"
  },
  {
    "text": "did it and to help us know the best parameters parameters sorry in for this",
    "start": "1671419",
    "end": "1678380"
  },
  {
    "text": "device but now that we know the best solution parameters and we it's time to",
    "start": "1678380",
    "end": "1684260"
  },
  {
    "text": "focus on the real stuff in this case and as we explained we do",
    "start": "1684260",
    "end": "1690020"
  },
  {
    "start": "1685000",
    "end": "1685000"
  },
  {
    "text": "not have the keys of the device we would not up against the device uh so we cannot run this gravitational step",
    "start": "1690020",
    "end": "1695419"
  },
  {
    "text": "but we can um we have the we can have the best",
    "start": "1695419",
    "end": "1702919"
  },
  {
    "text": "parameters and we can modify a programmer as we did in order to load and run all the attack",
    "start": "1702919",
    "end": "1709640"
  },
  {
    "text": "so in this case our main goal is to glitch",
    "start": "1709640",
    "end": "1715940"
  },
  {
    "text": "the edl when a sector explained when it's verifying this this root",
    "start": "1715940",
    "end": "1721760"
  },
  {
    "text": "certificate so we have a couple steps first is getting timing right as we as actors",
    "start": "1721760",
    "end": "1727820"
  },
  {
    "text": "playing uh we already see where the program is is",
    "start": "1727820",
    "end": "1732919"
  },
  {
    "text": "Going Through the Wire so we can trigger on that but we also know more or less where the root key hash verification is",
    "start": "1732919",
    "end": "1740539"
  },
  {
    "text": "happening so we have a very clear uh a very clear window on where to start",
    "start": "1740539",
    "end": "1746419"
  },
  {
    "text": "applying your glitches so as we have seen we already more or",
    "start": "1746419",
    "end": "1751760"
  },
  {
    "text": "less know where that's happening if we take into account that we can see what's happening through their USB wire we can",
    "start": "1751760",
    "end": "1758000"
  },
  {
    "text": "set uh clearly defined glitching area uh so there we go to the next step of",
    "start": "1758000",
    "end": "1766580"
  },
  {
    "text": "our of our bypassing attempts in this case we are modifying this programmer uh",
    "start": "1766580",
    "end": "1773000"
  },
  {
    "text": "this is the same function that we modified earlier in this case uh we are",
    "start": "1773000",
    "end": "1778700"
  },
  {
    "text": "we just want to see if we are able to run code so we are just trying to print",
    "start": "1778700",
    "end": "1784220"
  },
  {
    "text": "via USB uh uh a simple string in this case server intelligence 2022 we are",
    "start": "1784220",
    "end": "1790880"
  },
  {
    "text": "executing code so the main idea as we explain is to",
    "start": "1790880",
    "end": "1796460"
  },
  {
    "text": "generate a new keys in this key in this case these keys are different to the ones that are burned into the device",
    "start": "1796460",
    "end": "1803799"
  },
  {
    "text": "they they will make the device reject our programmer but that's why we are",
    "start": "1803799",
    "end": "1810500"
  },
  {
    "text": "trying to pass in this case if we put everything together we know we thanks to the",
    "start": "1810500",
    "end": "1816559"
  },
  {
    "text": "calculation step we will know the best parameter to glitch we also know the",
    "start": "1816559",
    "end": "1821659"
  },
  {
    "text": "best timing window in order to apply your glitches and we have our modify programmer so it's time to to start glitching",
    "start": "1821659",
    "end": "1829120"
  },
  {
    "text": "both advantages and some challenges the way the USB start works on the",
    "start": "1829899",
    "end": "1837140"
  },
  {
    "text": "device we still don't know that because it's a black box so we have uh Jitter in there we don't know what what",
    "start": "1837140",
    "end": "1846020"
  },
  {
    "text": "we don't know what the timings of the of that process of the of this packet so uh",
    "start": "1846020",
    "end": "1852559"
  },
  {
    "text": "or time anchors are not precise and furthermore we also",
    "start": "1852559",
    "end": "1858080"
  },
  {
    "text": "not every glitch injected will be a success so there's a little bit of",
    "start": "1858080",
    "end": "1863419"
  },
  {
    "text": "Randomness to it so we have to try uh several times in order to first uh",
    "start": "1863419",
    "end": "1869059"
  },
  {
    "text": "achieve a success but in this case we can apply a",
    "start": "1869059",
    "end": "1874520"
  },
  {
    "text": "generator methodology to you to the to the devices once we know uh the these",
    "start": "1874520",
    "end": "1880700"
  },
  {
    "text": "parameters and in this case we will not have uh the need to reverse engineer to",
    "start": "1880700",
    "end": "1887779"
  },
  {
    "text": "try to find a code or leaks in uh for our devices because we can do this via",
    "start": "1887779",
    "end": "1894200"
  },
  {
    "text": "power choices or inferring some information as we said so if you remember correctly from the",
    "start": "1894200",
    "end": "1900799"
  },
  {
    "text": "first slides this will be two of our main objectives um and we are going to see if we manage",
    "start": "1900799",
    "end": "1907940"
  },
  {
    "text": "them successfully here is the results of our experiments",
    "start": "1907940",
    "end": "1915500"
  },
  {
    "text": "in this case we left this run uh 125 times in 15 hours and the average",
    "start": "1915500",
    "end": "1923000"
  },
  {
    "text": "time that we achieved to bypass the secure boot is 7.25 minutes we have a",
    "start": "1923000",
    "end": "1931399"
  },
  {
    "text": "couple of layers in fact we had some serious ones or some 90 minutes with a",
    "start": "1931399",
    "end": "1937039"
  },
  {
    "text": "success some 50 something minutes without success but generally the the",
    "start": "1937039",
    "end": "1942500"
  },
  {
    "text": "windows I mean window that we're expecting is between a minute and maybe 10 or 10 or 15 minutes",
    "start": "1942500",
    "end": "1950480"
  },
  {
    "text": "here we have a another plot that will help you see where the average time is",
    "start": "1950480",
    "end": "1956480"
  },
  {
    "text": "is is is is located so now we are going to try to see I'm",
    "start": "1956480",
    "end": "1962000"
  },
  {
    "text": "here in the relay uh uh still triggering so maybe it's possible that we do not",
    "start": "1962000",
    "end": "1967880"
  },
  {
    "text": "have a success which is weird because uh thankfully thankfully we have a video and you will see that in this video uh",
    "start": "1967880",
    "end": "1975860"
  },
  {
    "text": "the success is achieved quite rapidly in this case we are going to check but yeah",
    "start": "1975860",
    "end": "1981140"
  },
  {
    "text": "this is still running so we are going to cancel this well in fact we are going to",
    "start": "1981140",
    "end": "1986240"
  },
  {
    "text": "try and keep it running and see if eventually we get something but basically the the demo of the video",
    "start": "1986240",
    "end": "1993080"
  },
  {
    "text": "is the the same as we explained we run our our script our script uh keeps uh",
    "start": "1993080",
    "end": "2000519"
  },
  {
    "text": "running these these this Loop it's a bit it's it's not the best quality but it it",
    "start": "2000519",
    "end": "2008740"
  },
  {
    "text": "works I hope you can see this so here we see it's it's it's running the video is",
    "start": "2008740",
    "end": "2014320"
  },
  {
    "text": "barely two minutes long so we are going to advance this uh it's",
    "start": "2014320",
    "end": "2020620"
  },
  {
    "text": "running running running running and there sorry we get a uh one of our",
    "start": "2020620",
    "end": "2025659"
  },
  {
    "text": "successes we will you will see that uh in the screen in a minute after success time 1.5 minutes it's 1.6 sorry minutes",
    "start": "2025659",
    "end": "2034720"
  },
  {
    "text": "it's quite nice it's a very nice timing so we can know that the pros the program",
    "start": "2034720",
    "end": "2039760"
  },
  {
    "text": "is loaded we can start sending uh other commands in this case our modify command",
    "start": "2039760",
    "end": "2046120"
  },
  {
    "text": "is firmware firmware right as we mentioned and If eventually we can see how uh in",
    "start": "2046120",
    "end": "2052839"
  },
  {
    "text": "here how we let me move the camera because we are executing code with that",
    "start": "2052839",
    "end": "2058960"
  },
  {
    "text": "string that we mentioned earlier so actor if you want to we have to",
    "start": "2058960",
    "end": "2065800"
  },
  {
    "text": "conclude uh by basically the conclusion we have one minute time so uh we're",
    "start": "2065800",
    "end": "2070839"
  },
  {
    "text": "really think that both technologies have powerful technique so uh this technique",
    "start": "2070839",
    "end": "2076960"
  },
  {
    "text": "that we have presented today is not the glitching itself is a combination of stuff it's like an approach a technique",
    "start": "2076960",
    "end": "2083020"
  },
  {
    "text": "a methodology so in this methodology we do not require the pvl we don't need to know the ROM we just need to send a",
    "start": "2083020",
    "end": "2089080"
  },
  {
    "text": "parameter with babalita root key so we will see those differences so we we will get the probably area",
    "start": "2089080",
    "end": "2095138"
  },
  {
    "text": "so we don't need to know how security is implemented we need to know the design right because you I I showed you the the",
    "start": "2095139",
    "end": "2101800"
  },
  {
    "text": "verification stuff but I didn't look at the code right I don't I didn't I don't know today if there is if condition I",
    "start": "2101800",
    "end": "2109000"
  },
  {
    "text": "don't know maybe the first certificate is I don't know I have no idea how the implementation has been done I just need",
    "start": "2109000",
    "end": "2114460"
  },
  {
    "text": "to know high level the Qualcomm documentation about okay there is an L file this is this verification super",
    "start": "2114460",
    "end": "2121180"
  },
  {
    "text": "high level I don't need to to have the code right so we successfully bypassed the secure route of this Dragon board",
    "start": "2121180",
    "end": "2127780"
  },
  {
    "text": "right so basically as as uh be Sensei we just modify a Qualcomm signing",
    "start": "2127780",
    "end": "2132880"
  },
  {
    "text": "programmer and we just resign it with our keys and then sign it to the board and eventually we will get success uh on",
    "start": "2132880",
    "end": "2140079"
  },
  {
    "text": "average 7.25 minutes which is a very nice approach we were happy when less than",
    "start": "2140079",
    "end": "2145599"
  },
  {
    "text": "one hour we are happy usually so seven minutes is super nice so the important stuff as we also",
    "start": "2145599",
    "end": "2151359"
  },
  {
    "text": "created a more advanced uh is not just a string we also create a software a pbl",
    "start": "2151359",
    "end": "2156640"
  },
  {
    "text": "able to read and write memory so we dumped the pbl the boot ROM so this is a mechanism to basically dump boot ROMs so",
    "start": "2156640",
    "end": "2163599"
  },
  {
    "text": "you can use this approach if you want to to the the boot rooms so we compared the",
    "start": "2163599",
    "end": "2168700"
  },
  {
    "text": "pvl right with the previous one when the security boot was not enabled and they were exactly the same this is proving us",
    "start": "2168700",
    "end": "2175540"
  },
  {
    "text": "that the the attack is not only successful but the board is stable enough to operate normally right",
    "start": "2175540",
    "end": "2183400"
  },
  {
    "text": "so with the boond ROM so we are not blind anymore which was one of one of the goals so silver vulnerability is the",
    "start": "2183400",
    "end": "2190660"
  },
  {
    "text": "next step so now that you have the wood room you can now apply all your technical fasting your everyday stuff",
    "start": "2190660",
    "end": "2196720"
  },
  {
    "text": "you have in order to go beyond that and then probably next time you don't need to do this you don't need to exploit boot ROM with universal vulnerabilities",
    "start": "2196720",
    "end": "2203260"
  },
  {
    "text": "but when you are blindfully blind this is an approach you can actually use",
    "start": "2203260",
    "end": "2209020"
  },
  {
    "text": "and that's all if you have any questions we have one minute",
    "start": "2209020",
    "end": "2215640"
  },
  {
    "text": "thank you",
    "start": "2215800",
    "end": "2218280"
  },
  {
    "text": "[Music]",
    "start": "2225730",
    "end": "2228840"
  }
]