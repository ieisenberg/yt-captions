[
  {
    "text": "hi everyone I'm orange I'm sorry I have to give this presentation in this format",
    "start": "2600",
    "end": "8920"
  },
  {
    "text": "but I can only do this because the US didn't give me a Visa but still iess at all of you who",
    "start": "8920",
    "end": "17720"
  },
  {
    "text": "choose to be here even if this is a pre-recorded video also I don't know if",
    "start": "17720",
    "end": "24880"
  },
  {
    "text": "there are actually any people in the audience no matter what I have invited",
    "start": "24880",
    "end": "31279"
  },
  {
    "text": "our CEO alen our company provides the most professional rating services in",
    "start": "31279",
    "end": "38920"
  },
  {
    "text": "Asia so if you are interested feel free to come up and chat with alen after the",
    "start": "38920",
    "end": "46559"
  },
  {
    "text": "talk now let's get started with today's",
    "start": "46559",
    "end": "51960"
  },
  {
    "text": "presentation first I want to ask is there anyone here who hasn't heard of",
    "start": "51960",
    "end": "58199"
  },
  {
    "text": "the patch HTTP server before if so please raise your",
    "start": "58199",
    "end": "65239"
  },
  {
    "text": "hand well I guess I cannot see your hands but I believe I can skip the",
    "start": "65240",
    "end": "72680"
  },
  {
    "text": "introduction but let's still give you a quick overview first off a patch is an open-",
    "start": "72680",
    "end": "79280"
  },
  {
    "text": "source project that nearly 30 years old it might be older than some of you",
    "start": "79280",
    "end": "86640"
  },
  {
    "text": "here and because it has existed since the early death of the internet it has",
    "start": "86640",
    "end": "93560"
  },
  {
    "text": "accumulated a lot of technical depth another key point is that a patch",
    "start": "93560",
    "end": "100759"
  },
  {
    "text": "enabled CGI by default which greatly increases the potential attack",
    "start": "100759",
    "end": "108439"
  },
  {
    "text": "surface lastly a patch is the only web server that can perfectly integrate with",
    "start": "108439",
    "end": "116719"
  },
  {
    "text": "PHP because of its high integr with PHP how many ways do you think",
    "start": "116719",
    "end": "123719"
  },
  {
    "text": "there are to set up a PHP",
    "start": "123719",
    "end": "127960"
  },
  {
    "text": "environment there are numberous configurations available there are over",
    "start": "129039",
    "end": "134360"
  },
  {
    "text": "10 methods just for faster CGI alone which includes five different smers",
    "start": "134360",
    "end": "141120"
  },
  {
    "text": "doing the similar thing this doesn't even count for CGI",
    "start": "141120",
    "end": "146519"
  },
  {
    "text": "combinations and the process manager like PHP",
    "start": "146519",
    "end": "151840"
  },
  {
    "text": "pfpn especially since each merger has its own directive all of this multiply",
    "start": "152680",
    "end": "159440"
  },
  {
    "text": "the complexity of setting up a PHP moreover some directives not only",
    "start": "159440",
    "end": "167680"
  },
  {
    "text": "look very similar but also have identical usage and effects which can",
    "start": "167680",
    "end": "174400"
  },
  {
    "text": "lead to potential confusion so if you don't understand",
    "start": "174400",
    "end": "179879"
  },
  {
    "text": "understand the intention behind each directive it's easy to make mistakes and",
    "start": "179879",
    "end": "186080"
  },
  {
    "text": "create security risks for example when the say admin",
    "start": "186080",
    "end": "194640"
  },
  {
    "text": "want to set out the PHP on his machine he might come across two common",
    "start": "194640",
    "end": "201560"
  },
  {
    "text": "directives at Handler and at type so which one do you think is",
    "start": "201560",
    "end": "209480"
  },
  {
    "text": "correct correct actually both are correct both",
    "start": "209480",
    "end": "217400"
  },
  {
    "text": "meth can get the PHP running properly so does this mean both Meers",
    "start": "217400",
    "end": "225200"
  },
  {
    "text": "are equally good firstly being correct does not mean",
    "start": "225200",
    "end": "233879"
  },
  {
    "text": "being secure and under certain con conditions",
    "start": "233879",
    "end": "240280"
  },
  {
    "text": "at type has been proven to be vulnerable that allowing attackers to disclose the",
    "start": "240280",
    "end": "247400"
  },
  {
    "text": "PHP source code remotely as for why I will discuss the",
    "start": "247400",
    "end": "253560"
  },
  {
    "text": "reasons later and the last I believe the most",
    "start": "253560",
    "end": "260320"
  },
  {
    "text": "important thing is no offense but from my ears working in offensive security I",
    "start": "260320",
    "end": "268520"
  },
  {
    "text": "have observed that s admin who use a patch tend to have more massive",
    "start": "268520",
    "end": "278080"
  },
  {
    "text": "environments also I can't think any reason to use a patch other than for",
    "start": "278080",
    "end": "284320"
  },
  {
    "text": "CGI in practice many a patch servers are hosting a lot of thirdparty services",
    "start": "284320",
    "end": "292080"
  },
  {
    "text": "like Java web server or engine X locally they often use rewrite L to",
    "start": "292080",
    "end": "299759"
  },
  {
    "text": "remap the traffic to them and usually the file syon on the server is also a",
    "start": "299759",
    "end": "306240"
  },
  {
    "text": "mess with last of stranger files sitting on the web",
    "start": "306240",
    "end": "312680"
  },
  {
    "text": "loot today I will showare manying techniques for example here is a common",
    "start": "313600",
    "end": "319960"
  },
  {
    "text": "password protected manager interface I will tell you how to bypass",
    "start": "319960",
    "end": "326759"
  },
  {
    "text": "it and I will also tell you how to to identify problematic rewrite rules in",
    "start": "326759",
    "end": "334240"
  },
  {
    "text": "practice s adamine love to write a lot of config like this is the L to hide",
    "start": "334240",
    "end": "340759"
  },
  {
    "text": "fire extensions it's vulnerable and you will learn how to break it",
    "start": "340759",
    "end": "348560"
  },
  {
    "text": "today lastly I will introduce the brand new exploitation",
    "start": "348600",
    "end": "354319"
  },
  {
    "text": "technique here is a simple CGI and how can this CGI might be",
    "start": "354319",
    "end": "361720"
  },
  {
    "text": "exploited first you may think of using CRF injection for",
    "start": "361720",
    "end": "367880"
  },
  {
    "text": "xss but unfortunately we are not interested in CLI side",
    "start": "367880",
    "end": "373919"
  },
  {
    "text": "vulnerability can you think of any other attacks some people might consider",
    "start": "373919",
    "end": "380599"
  },
  {
    "text": "attack like smuggling but there's no middle box here so attacks like desync or cach poisoning",
    "start": "380599",
    "end": "389800"
  },
  {
    "text": "are not feasible in such scenario many Buck Hunters would typically report it us",
    "start": "389800",
    "end": "400319"
  },
  {
    "text": "excesses it is really a waste but today you will learn a new",
    "start": "401120",
    "end": "407280"
  },
  {
    "text": "awesome way to explorate this this bug has the potential to become",
    "start": "407280",
    "end": "415120"
  },
  {
    "text": "RC before we dive into the topic let me introduce my self hi an orange and currently and the",
    "start": "415360",
    "end": "424120"
  },
  {
    "text": "principal security researcher at death cor I have spoken at many hacker",
    "start": "424120",
    "end": "430199"
  },
  {
    "text": "conferences like blackhead death Kong and hitcon my research has also got numerous",
    "start": "430199",
    "end": "438440"
  },
  {
    "text": "honors such as the first PR in top 10 web techniques P champion and ping",
    "start": "438440",
    "end": "447360"
  },
  {
    "text": "Awards so first why FOC on a patch at the beginning of this year I started to",
    "start": "447360",
    "end": "455160"
  },
  {
    "text": "explore some open source projects with widespread internet impact such as a",
    "start": "455160",
    "end": "461440"
  },
  {
    "text": "patch web server PHP or engine X I have even delved into ifcs to deepen my",
    "start": "461440",
    "end": "470520"
  },
  {
    "text": "understanding after a cross review of the patch source code I smell something",
    "start": "470520",
    "end": "476199"
  },
  {
    "text": "bad in es coding Style primary a patch comprises over 100 modes",
    "start": "476199",
    "end": "484120"
  },
  {
    "text": "that have to work together the source code includes 136",
    "start": "484120",
    "end": "491599"
  },
  {
    "text": "Maes and about half of them are either Ena or commonly used by six admins by",
    "start": "491599",
    "end": "501479"
  },
  {
    "text": "default what's more surprising is that they all share a very large structure",
    "start": "501759",
    "end": "508440"
  },
  {
    "text": "while working Gator the slid shows what the structure",
    "start": "508440",
    "end": "515120"
  },
  {
    "text": "looks like including all elements needed to handle an HTTP",
    "start": "515120",
    "end": "521440"
  },
  {
    "text": "request all Mees rely on this huge structure to synchronized communicate",
    "start": "521440",
    "end": "529080"
  },
  {
    "text": "and even exchange data an HTTP request will pass through",
    "start": "529080",
    "end": "536320"
  },
  {
    "text": "several phes mes are Act team like players in a game of catch passing the",
    "start": "536320",
    "end": "543760"
  },
  {
    "text": "structure from one to another when on a mous turn it focuses on completing its",
    "start": "543760",
    "end": "551519"
  },
  {
    "text": "own task and once done it passes the stru structure to the next this type of",
    "start": "551519",
    "end": "559360"
  },
  {
    "text": "collaboration is a common pattern in software engineering if all maners perform their",
    "start": "559360",
    "end": "566440"
  },
  {
    "text": "work properly the user can enjoy the service provided by the apach HTTP",
    "start": "566440",
    "end": "575079"
  },
  {
    "text": "server however any marer can modify any value in this structure based on its own",
    "start": "575399",
    "end": "583120"
  },
  {
    "text": "prevalence while this might be fine with just a few MERS however if there are over 100",
    "start": "583120",
    "end": "591079"
  },
  {
    "text": "moders today without any good standard or guideline can they really work",
    "start": "591079",
    "end": "597560"
  },
  {
    "text": "together thus our research is focusing on the",
    "start": "597560",
    "end": "604320"
  },
  {
    "text": "relationships and interactions between these modes each mod is implemented by",
    "start": "604320",
    "end": "611519"
  },
  {
    "text": "different people and subjected to ears of iterations and corre factors do they",
    "start": "611519",
    "end": "620200"
  },
  {
    "text": "really know what they are doing even if they do what about the",
    "start": "620200",
    "end": "627000"
  },
  {
    "text": "implementation details of other MERS they need to collaborate with",
    "start": "627000",
    "end": "634279"
  },
  {
    "text": "others if a maer accidentally modifies the field it consider",
    "start": "634279",
    "end": "640839"
  },
  {
    "text": "unimportant but the other modu think is important it could affect the decisions",
    "start": "640839",
    "end": "647360"
  },
  {
    "text": "of that Ma moreover if they have any",
    "start": "647360",
    "end": "652519"
  },
  {
    "text": "misunderstanding on any field of the structure it can lead to security risks",
    "start": "652519",
    "end": "661240"
  },
  {
    "text": "starting from the cooperation and understanding among MERS we identified",
    "start": "661720",
    "end": "668800"
  },
  {
    "text": "three different type of confusion attacks which are fil name confusion",
    "start": "668800",
    "end": "675279"
  },
  {
    "text": "document loot confusion and Handler",
    "start": "675279",
    "end": "680440"
  },
  {
    "text": "confusion as this is a completely new attack surface the first person to delve",
    "start": "680600",
    "end": "687680"
  },
  {
    "text": "into it can of C find the most box easily this confusion attacks led me to",
    "start": "687680",
    "end": "696079"
  },
  {
    "text": "discover nine new vulnerabilities making me the person currently holding the most CVS from a",
    "start": "696079",
    "end": "704240"
  },
  {
    "text": "patch HTTP server also because these",
    "start": "704240",
    "end": "710560"
  },
  {
    "text": "vulnerabilities are based on Legacy architectural issues many patches are",
    "start": "710560",
    "end": "717040"
  },
  {
    "text": "not Backward Compatible updating to the latest version might",
    "start": "717040",
    "end": "723000"
  },
  {
    "text": "break all configurations and causes many side",
    "start": "723000",
    "end": "728360"
  },
  {
    "text": "effects therefore for many production machines simply updating to the latest",
    "start": "728360",
    "end": "735079"
  },
  {
    "text": "version is not a good idea all right let's dive into our main",
    "start": "735079",
    "end": "743880"
  },
  {
    "text": "topic first I would like to discuss the attack code fil name",
    "start": "743880",
    "end": "749920"
  },
  {
    "text": "confusion this attack occurs when different MERS handle the F field using",
    "start": "749920",
    "end": "757480"
  },
  {
    "text": "different standards literally the fied file name sh represent a file system",
    "start": "757480",
    "end": "765160"
  },
  {
    "text": "pass however some MERS treat this field as a",
    "start": "765160",
    "end": "770560"
  },
  {
    "text": "URL this inconsistency in how Mees used the F can lead to vulnerabilities",
    "start": "770560",
    "end": "779600"
  },
  {
    "text": "so which Mees treated it as a",
    "start": "779600",
    "end": "784279"
  },
  {
    "text": "URL the first is rewrite modu which allows this admin to easily redirect a",
    "start": "784920",
    "end": "791480"
  },
  {
    "text": "URL patn to any file pass or URL I believe this feature is designed",
    "start": "791480",
    "end": "798959"
  },
  {
    "text": "for enhancing user experience however this convenience also",
    "start": "798959",
    "end": "805639"
  },
  {
    "text": "introduce certain issues such as the reite Moder Chace the target as the URL",
    "start": "805639",
    "end": "813240"
  },
  {
    "text": "in all cases for example if a six admin sets a",
    "start": "813240",
    "end": "819839"
  },
  {
    "text": "lure to Target the username right after the past user it FES its corresponding",
    "start": "819839",
    "end": "826920"
  },
  {
    "text": "profile in the file sy so when you access SL user SL orang the manager will",
    "start": "826920",
    "end": "834639"
  },
  {
    "text": "open and print out the file SLV SL user orange profile",
    "start": "834639",
    "end": "842639"
  },
  {
    "text": "Dy however what if you add one more question mark",
    "start": "843120",
    "end": "848199"
  },
  {
    "text": "today present 3F is the URL included format for",
    "start": "848199",
    "end": "854759"
  },
  {
    "text": "it during the N translation phase the reite modu will first merge it into this",
    "start": "854759",
    "end": "864720"
  },
  {
    "text": "pass and after that even if the destination is the file pass reite modu",
    "start": "864800",
    "end": "872199"
  },
  {
    "text": "will Chade all of them as the URL and separate the Cory part by the",
    "start": "872199",
    "end": "879399"
  },
  {
    "text": "question mark so the first primitive is pass Tran",
    "start": "879399",
    "end": "887199"
  },
  {
    "text": "truncation you can use a cross to Tran the pass and access on intended files",
    "start": "887199",
    "end": "895519"
  },
  {
    "text": "for here we use this transaction to access the the secret which is normally",
    "start": "895519",
    "end": "903320"
  },
  {
    "text": "inaccessible and who else check the F name as the",
    "start": "903720",
    "end": "908880"
  },
  {
    "text": "URL the proxy maer does two at first grance this seems logical because the",
    "start": "908880",
    "end": "915839"
  },
  {
    "text": "purpose of a proxy is to transfer the request to another",
    "start": "915839",
    "end": "921320"
  },
  {
    "text": "URL so when we consider this behavior on its own it doesn't appear to be a",
    "start": "921320",
    "end": "928360"
  },
  {
    "text": "problem however if your Sy relied on the file",
    "start": "928360",
    "end": "934440"
  },
  {
    "text": "best access control it can be risky for example using the fails directive to",
    "start": "934440",
    "end": "942399"
  },
  {
    "text": "prevent unauthorized users from accessing admin.php",
    "start": "942399",
    "end": "948880"
  },
  {
    "text": "this type of authentication can be bypassed by default when the target is",
    "start": "948880",
    "end": "955680"
  },
  {
    "text": "running under the PHP fpn when you visit a URL like this today",
    "start": "955680",
    "end": "964399"
  },
  {
    "text": "admin.php question mark o.",
    "start": "964399",
    "end": "970399"
  },
  {
    "text": "PHP first during the sess control phase the authentication manager comp pass",
    "start": "970720",
    "end": "977360"
  },
  {
    "text": "your file name to admin.php which is totally",
    "start": "977360",
    "end": "982720"
  },
  {
    "text": "different so naturally a patch didn't think you need Authentication",
    "start": "982720",
    "end": "990079"
  },
  {
    "text": "and then to support various protocols like HTTP or FTP the proxy manager",
    "start": "990079",
    "end": "997880"
  },
  {
    "text": "transform the file name into a URL and sends it to the backend PHP",
    "start": "997880",
    "end": "1006959"
  },
  {
    "text": "service to adapt this Behavior the backend PHP also implements some dirty",
    "start": "1007680",
    "end": "1015240"
  },
  {
    "text": "hacks to handle this unusual file n it uses a question mark to ignore the cor",
    "start": "1015240",
    "end": "1023519"
  },
  {
    "text": "stream and passes the original file name for",
    "start": "1023519",
    "end": "1029760"
  },
  {
    "text": "execution the original authentication required interface can be bypassed with",
    "start": "1030000",
    "end": "1036678"
  },
  {
    "text": "just a single question mark of course it's not just admin. PHP",
    "start": "1036679",
    "end": "1043880"
  },
  {
    "text": "here are more real world cases such as the PHP info which is only as a SP",
    "start": "1043880",
    "end": "1050160"
  },
  {
    "text": "locally and AD minor which is brought by",
    "start": "1050160",
    "end": "1055640"
  },
  {
    "text": "default all of this can be bypassed by playing the",
    "start": "1055880",
    "end": "1061280"
  },
  {
    "text": "inconsistency between the assess control and proxy modu that was our first confusion attack",
    "start": "1061280",
    "end": "1069960"
  },
  {
    "text": "it's just an appetizer are you ready for",
    "start": "1069960",
    "end": "1075120"
  },
  {
    "text": "more the next attack I will introduce is confusion on document",
    "start": "1075120",
    "end": "1081840"
  },
  {
    "text": "loot first consider this common rewrite L what file do you think a patch will",
    "start": "1081840",
    "end": "1089120"
  },
  {
    "text": "open for the URL is it the about. HTML under the loot",
    "start": "1089120",
    "end": "1095200"
  },
  {
    "text": "folder or the file in SLV slle w/",
    "start": "1095200",
    "end": "1103158"
  },
  {
    "text": "HTML the answer is both will be assess amazing right this is also our second",
    "start": "1103840",
    "end": "1114200"
  },
  {
    "text": "confusion for any given rewrite L A Patch always tries to assess both the",
    "start": "1114720",
    "end": "1122440"
  },
  {
    "text": "version with and result document",
    "start": "1122440",
    "end": "1127480"
  },
  {
    "text": "Loop this allows us to intentionally assess the files outside",
    "start": "1128520",
    "end": "1134720"
  },
  {
    "text": "the web loot especially the loot folder",
    "start": "1134720",
    "end": "1140640"
  },
  {
    "text": "you might be wondering does this mean we can assist SL Etc SL",
    "start": "1141799",
    "end": "1148919"
  },
  {
    "text": "passwd yes but not",
    "start": "1148919",
    "end": "1154519"
  },
  {
    "text": "entirely we can indeed sess but the request get denied half away by the",
    "start": "1154880",
    "end": "1161960"
  },
  {
    "text": "building assess control module however the building as ass",
    "start": "1161960",
    "end": "1169000"
  },
  {
    "text": "controll by default allows the access to the folder SL USR SL share therefore we",
    "start": "1169000",
    "end": "1177679"
  },
  {
    "text": "have a limited escap from the web",
    "start": "1177679",
    "end": "1182399"
  },
  {
    "text": "loot for example we can use this escap to access documentations under SL USR SL",
    "start": "1183520",
    "end": "1192280"
  },
  {
    "text": "share to learn how to use SSH however we are still restricted",
    "start": "1192280",
    "end": "1199159"
  },
  {
    "text": "by the file extension. HTML you might want to",
    "start": "1199159",
    "end": "1205520"
  },
  {
    "text": "ask can you access the files outside.",
    "start": "1205520",
    "end": "1210600"
  },
  {
    "text": "HTML of course we can I'm not sure if any of you have had an idea pop out in",
    "start": "1210600",
    "end": "1217120"
  },
  {
    "text": "your mind but we can combine what we learned",
    "start": "1217120",
    "end": "1222240"
  },
  {
    "text": "earlier in F name confusion using a question mark to trat the p",
    "start": "1222240",
    "end": "1229880"
  },
  {
    "text": "so theoretically if the prefix of a rewrite rule is controllable we can access all",
    "start": "1229880",
    "end": "1238200"
  },
  {
    "text": "files under the slash USR SL",
    "start": "1238200",
    "end": "1244039"
  },
  {
    "text": "share even the tutorial on the official aach website has problematic",
    "start": "1244080",
    "end": "1251360"
  },
  {
    "text": "examples so what can we do with this",
    "start": "1251360",
    "end": "1256799"
  },
  {
    "text": "attack first we we can discuss arbitary Ser size source code since a patch",
    "start": "1257080",
    "end": "1264039"
  },
  {
    "text": "decided whether to execute a script or not based on the current virtual host as",
    "start": "1264039",
    "end": "1271840"
  },
  {
    "text": "the S the for pass through a virtual host that doesn't support PHP allows us",
    "start": "1271840",
    "end": "1278679"
  },
  {
    "text": "to easily expose its source code and since we have broken the chust",
    "start": "1278679",
    "end": "1287120"
  },
  {
    "text": "of only s accessing the document loot the entire SL USR SL share has now",
    "start": "1287120",
    "end": "1295840"
  },
  {
    "text": "become our platform so the next step is to find out",
    "start": "1295840",
    "end": "1301360"
  },
  {
    "text": "what files under this folder we can exploit we can leverage existing",
    "start": "1301360",
    "end": "1308039"
  },
  {
    "text": "tutorial examples uni tests and even packages from programming",
    "start": "1308039",
    "end": "1316278"
  },
  {
    "text": "language so this is how developers imagine the library and how I actually",
    "start": "1316679",
    "end": "1323440"
  },
  {
    "text": "use it our first gadet we are going to demonstrate is leveraging the library",
    "start": "1323440",
    "end": "1331400"
  },
  {
    "text": "office which is installed on yubu desktop by default we use this he manual for",
    "start": "1331400",
    "end": "1341600"
  },
  {
    "text": "xss and we can quickly pop out an alert",
    "start": "1342520",
    "end": "1348880"
  },
  {
    "text": "or we can discr sensitive information for example if you have a web Su d",
    "start": "1349400",
    "end": "1356520"
  },
  {
    "text": "installed the demon will by default provide an example file called d.php you",
    "start": "1356520",
    "end": "1365640"
  },
  {
    "text": "can directly access this file to print out environment",
    "start": "1365640",
    "end": "1371159"
  },
  {
    "text": "variables and similarly the default web loots for JY and engine X are also",
    "start": "1371159",
    "end": "1379120"
  },
  {
    "text": "located under the SL USR SL share you can steal data from this web servers",
    "start": "1379120",
    "end": "1386600"
  },
  {
    "text": "easily by a simple rewrite lle here we demonstrate how we execute",
    "start": "1386600",
    "end": "1394720"
  },
  {
    "text": "PHP info to link sensitive information by Dav",
    "start": "1394720",
    "end": "1401120"
  },
  {
    "text": "K even some PHP or frontend package like",
    "start": "1402240",
    "end": "1407400"
  },
  {
    "text": "Z quy macpie or JP graph have tutorials",
    "start": "1407400",
    "end": "1412640"
  },
  {
    "text": "or debug console that can be leveraged as",
    "start": "1412640",
    "end": "1418200"
  },
  {
    "text": "well for example we use the tutorial from Deora feed to read upur file",
    "start": "1418200",
    "end": "1427080"
  },
  {
    "text": "content by now you can see that the possibilities of this primitive are huge",
    "start": "1427080",
    "end": "1434520"
  },
  {
    "text": "local gadgets are endless and all that REM is to find more powerful or more",
    "start": "1434520",
    "end": "1442679"
  },
  {
    "text": "Universal gadgets but you might be curious and",
    "start": "1442679",
    "end": "1449440"
  },
  {
    "text": "asking can you jump out of/ USR sure of",
    "start": "1449440",
    "end": "1454679"
  },
  {
    "text": "course we can a patch allows following symbolic",
    "start": "1454679",
    "end": "1460559"
  },
  {
    "text": "links by default so that is our third primitive that allows us to J break from",
    "start": "1460559",
    "end": "1468600"
  },
  {
    "text": "SL USR sh also the folder is theoretically just",
    "start": "1468600",
    "end": "1475679"
  },
  {
    "text": "a read only copy the symbolic link inside can still be useful for",
    "start": "1475679",
    "end": "1482840"
  },
  {
    "text": "Earth for example the symbolic link in cacti s or even red M can be used to",
    "start": "1482840",
    "end": "1491080"
  },
  {
    "text": "jump out of/ USR sh here we demonstrate an R CE on red M",
    "start": "1491080",
    "end": "1500000"
  },
  {
    "text": "through a double half jump there's an instance folder that can jump to SLB",
    "start": "1500000",
    "end": "1506880"
  },
  {
    "text": "bar/ library on the red M and within the directory the config folder can also",
    "start": "1506880",
    "end": "1515039"
  },
  {
    "text": "jump to the SLC SL redmine which contains red M's database configuration",
    "start": "1515039",
    "end": "1522960"
  },
  {
    "text": "and secet key so by using an insert secure reite L",
    "start": "1522960",
    "end": "1530279"
  },
  {
    "text": "we can access the SEC key used by redm through a double hop",
    "start": "1530279",
    "end": "1537278"
  },
  {
    "text": "junk since redm is a lubian rails application the content of security. txt",
    "start": "1537559",
    "end": "1545200"
  },
  {
    "text": "is actually the encryption key used by rubyan rails and the next step is obvious",
    "start": "1545200",
    "end": "1552520"
  },
  {
    "text": "invading malicious pel into cookies then encrypting and signing them with the",
    "start": "1552520",
    "end": "1558440"
  },
  {
    "text": "know key and get code execution through server side",
    "start": "1558440",
    "end": "1564120"
  },
  {
    "text": "deserialization that was our second attack are you",
    "start": "1564120",
    "end": "1569960"
  },
  {
    "text": "enjoying now let's introduce the last confusion andol",
    "start": "1571080",
    "end": "1577720"
  },
  {
    "text": "confusion first back to our initial question why can both directives one for",
    "start": "1578960",
    "end": "1585600"
  },
  {
    "text": "aiding a Handler and one for aiding a content type can run PHP",
    "start": "1585600",
    "end": "1592600"
  },
  {
    "text": "properly this is actually due to a Lexi conversion in a patch or you can say",
    "start": "1593520",
    "end": "1600200"
  },
  {
    "text": "it's part of its technical depth before a patch enters the main",
    "start": "1600200",
    "end": "1606399"
  },
  {
    "text": "Handler for processing the HTTP if the Handler field is empath a",
    "start": "1606399",
    "end": "1613760"
  },
  {
    "text": "patch Will T the value in a field of content type as the",
    "start": "1613760",
    "end": "1621080"
  },
  {
    "text": "Handler so our third Handler confusion is playing around this",
    "start": "1621720",
    "end": "1628399"
  },
  {
    "text": "behavior in a patch sometimes the content type can be transform into the",
    "start": "1628399",
    "end": "1635360"
  },
  {
    "text": "Handler that a patch sqs internally so how can this do let's show",
    "start": "1635360",
    "end": "1644080"
  },
  {
    "text": "you something fun first imagine that your server is running PHP",
    "start": "1644080",
    "end": "1652080"
  },
  {
    "text": "using add type and you access the file config.php",
    "start": "1652080",
    "end": "1658559"
  },
  {
    "text": "since the file extension is. PHP during the TP tracker face a patch will assign",
    "start": "1658559",
    "end": "1667039"
  },
  {
    "text": "the corresponding value to the content type field based on your",
    "start": "1667039",
    "end": "1672480"
  },
  {
    "text": "directive and the PHP knows is his responsibility to handle this",
    "start": "1672480",
    "end": "1680120"
  },
  {
    "text": "request the normal process works well however before entering the wrong",
    "start": "1680559",
    "end": "1687120"
  },
  {
    "text": "Handler face the Legacy conversion we mentioned earlier will convert the",
    "start": "1687120",
    "end": "1693039"
  },
  {
    "text": "content type into Handler this explains why both at type and AD Handler are",
    "start": "1693039",
    "end": "1701880"
  },
  {
    "text": "effective but what if any maer accidentally overwrites the content type",
    "start": "1701880",
    "end": "1708600"
  },
  {
    "text": "before reaching the wrong Handler face for example by triggering and",
    "start": "1708600",
    "end": "1716240"
  },
  {
    "text": "filter error in mode security at that moment mode security",
    "start": "1716240",
    "end": "1722440"
  },
  {
    "text": "think it has met some mistakes and want to send out some errors since the error",
    "start": "1722440",
    "end": "1729159"
  },
  {
    "text": "format is in HTML it says the current content type to HTML",
    "start": "1729159",
    "end": "1737039"
  },
  {
    "text": "2 and now the config which was supposed to be as to as PHP is treated as a plan",
    "start": "1737039",
    "end": "1745240"
  },
  {
    "text": "HT andl exposing all the sensitive content to",
    "start": "1745240",
    "end": "1751880"
  },
  {
    "text": "outside this is also our first PRM for Handler Confusion by abusing old Handler",
    "start": "1751880",
    "end": "1759760"
  },
  {
    "text": "conversion mechanism we can discour any PHP Source Code by overring the content",
    "start": "1759760",
    "end": "1767039"
  },
  {
    "text": "type theoretically all directives based on content type are affected by this",
    "start": "1767039",
    "end": "1775640"
  },
  {
    "text": "issue but if we think deeper the nature of this issue is",
    "start": "1775640",
    "end": "1782640"
  },
  {
    "text": "actually there are no clear guidelines for the use of the field content timee",
    "start": "1782640",
    "end": "1788720"
  },
  {
    "text": "it can be set by a config directive during the request phase or used as the",
    "start": "1788720",
    "end": "1795640"
  },
  {
    "text": "content type header in the server response a patch cannot distinguish",
    "start": "1795640",
    "end": "1802480"
  },
  {
    "text": "which one it is while you're using the field ideally if we can control the",
    "start": "1802480",
    "end": "1808919"
  },
  {
    "text": "content type we can invoke arbitrary handle so can we really do that it's",
    "start": "1808919",
    "end": "1817840"
  },
  {
    "text": "very promising but in reality the situation is not as simple",
    "start": "1817840",
    "end": "1825240"
  },
  {
    "text": "as it seems in practice all the code paths that can modify the content type",
    "start": "1825240",
    "end": "1832799"
  },
  {
    "text": "are all after the Legacy transformation thus even if we can",
    "start": "1832799",
    "end": "1838960"
  },
  {
    "text": "modify the content type through the server response it turns out to be",
    "start": "1838960",
    "end": "1844960"
  },
  {
    "text": "useless so what can we do next don't worry we turn to the RFC to",
    "start": "1844960",
    "end": "1854000"
  },
  {
    "text": "sets RFC 3875 is the spe specification for",
    "start": "1854000",
    "end": "1859720"
  },
  {
    "text": "CGI and the section 6.2.2 introduces the local redirect",
    "start": "1859720",
    "end": "1867960"
  },
  {
    "text": "response the local redirect response works like this if the CGI returns a",
    "start": "1867960",
    "end": "1874279"
  },
  {
    "text": "status of 200 and include a location",
    "start": "1874279",
    "end": "1880559"
  },
  {
    "text": "header instead of handling it as a client side redirect by the browser the",
    "start": "1881000",
    "end": "1887200"
  },
  {
    "text": "CGI Chas this location Target as a server side",
    "start": "1887200",
    "end": "1894080"
  },
  {
    "text": "redirect a patch is implementation of this server side redirect will open a",
    "start": "1895080",
    "end": "1901559"
  },
  {
    "text": "new HTTP left cycle copying the original field of content type to this new",
    "start": "1901559",
    "end": "1909799"
  },
  {
    "text": "structure so for example if you can control the response headers through CGI",
    "start": "1909799",
    "end": "1916480"
  },
  {
    "text": "that means you can control the content type field when a patch sees a status of 200",
    "start": "1916480",
    "end": "1925600"
  },
  {
    "text": "it performs the Ser side redirect and starts a new round of HTTP",
    "start": "1925600",
    "end": "1933200"
  },
  {
    "text": "processing in this new run the content type haer returns by the earlier CGI is",
    "start": "1933240",
    "end": "1940559"
  },
  {
    "text": "pressed into the structure and after the Legacy content",
    "start": "1940559",
    "end": "1945720"
  },
  {
    "text": "typ to handle a conversion the content type you provided becomes the Handler",
    "start": "1945720",
    "end": "1952760"
  },
  {
    "text": "allowing you to invoke AR",
    "start": "1952760",
    "end": "1957919"
  },
  {
    "text": "handle so our second primitive is the ability to coar",
    "start": "1958679",
    "end": "1966960"
  },
  {
    "text": "Handler basically the entire CGI family follows this feature including but not",
    "start": "1968080",
    "end": "1976279"
  },
  {
    "text": "limited to the W SGI fast CGI and",
    "start": "1976279",
    "end": "1982720"
  },
  {
    "text": "uwsgi as for how to trigger this server side redirect here we provide two",
    "start": "1984440",
    "end": "1991840"
  },
  {
    "text": "scenarios one is the CRF injection and the other is the ssrf that can fully",
    "start": "1991840",
    "end": "1999480"
  },
  {
    "text": "control the response header we will use crf1 as the example",
    "start": "1999480",
    "end": "2006440"
  },
  {
    "text": "below first if you overwrite a content type",
    "start": "2006440",
    "end": "2013840"
  },
  {
    "text": "with a name code server",
    "start": "2013840",
    "end": "2018320"
  },
  {
    "text": "status then you can L sensitive information that should only be",
    "start": "2019480",
    "end": "2025559"
  },
  {
    "text": "accessible from Local",
    "start": "2025559",
    "end": "2029120"
  },
  {
    "text": "Host you can also easily transform an image into your PHP backd door",
    "start": "2031080",
    "end": "2038399"
  },
  {
    "text": "by setting the content type to",
    "start": "2038399",
    "end": "2042639"
  },
  {
    "text": "PHP you can even achieve ssrf through the proxy",
    "start": "2044519",
    "end": "2051760"
  },
  {
    "text": "modu and this ssrf allows you to control reest haters and can read all the",
    "start": "2052679",
    "end": "2062638"
  },
  {
    "text": "response super thanks to the convenient brought by the proxy maer the most",
    "start": "2062639",
    "end": "2068398"
  },
  {
    "text": "awesome things about this SSI is that it can also access the local Unix domain",
    "start": "2068399",
    "end": "2076720"
  },
  {
    "text": "ciruits so lastly let's demonstrate how to turn this SSI into a",
    "start": "2076720",
    "end": "2085320"
  },
  {
    "text": "RC here we use a common trick in CTF the official PHP darker image by default",
    "start": "2086399",
    "end": "2094280"
  },
  {
    "text": "comes with p a PHP extension manager the P command is the engine",
    "start": "2094280",
    "end": "2101200"
  },
  {
    "text": "Point used to manager the packages and we can leverage this ssrf",
    "start": "2101200",
    "end": "2108480"
  },
  {
    "text": "to ask you the peer command to do further exploitation for example we explo a",
    "start": "2108480",
    "end": "2116280"
  },
  {
    "text": "command injection in the run test",
    "start": "2116280",
    "end": "2121200"
  },
  {
    "text": "command and we can get a reverse share easily to asku AB",
    "start": "2122359",
    "end": "2129079"
  },
  {
    "text": "Ms here my presentation is almost coming to the end but I want to",
    "start": "2129079",
    "end": "2135400"
  },
  {
    "text": "say maintaining open source is really challenging especially for a project",
    "start": "2135400",
    "end": "2142119"
  },
  {
    "text": "that has been around for nearly 30 years you have to make it convenient for end",
    "start": "2142119",
    "end": "2148359"
  },
  {
    "text": "users and compatible with all versions the entire development process is built",
    "start": "2148359",
    "end": "2155520"
  },
  {
    "text": "up a PIR of Legacy code and Technical depth so if there are any apach",
    "start": "2155520",
    "end": "2163480"
  },
  {
    "text": "developers in the audience today I want to say thank you for all of your hard",
    "start": "2163480",
    "end": "2171040"
  },
  {
    "text": "work before we finish let's have a few Tech ways first the question mark is really",
    "start": "2171040",
    "end": "2179200"
  },
  {
    "text": "powerful that allows you to chunat arbitary pass you can bypass access",
    "start": "2179200",
    "end": "2185200"
  },
  {
    "text": "control and authentication easily by playing the inconsistency between",
    "start": "2185200",
    "end": "2191880"
  },
  {
    "text": "modules and next the reite rule contains a hidden chap that allows access to the",
    "start": "2191880",
    "end": "2199000"
  },
  {
    "text": "syon loot lastly by coning the response headers you can invoke arit internal",
    "start": "2199000",
    "end": "2207440"
  },
  {
    "text": "handle through the Legacy conversion",
    "start": "2207440",
    "end": "2212440"
  },
  {
    "text": "mechanism there are also some future works for example different",
    "start": "2212640",
    "end": "2218040"
  },
  {
    "text": "distributions have different configurations so exploring such as the",
    "start": "2218040",
    "end": "2224640"
  },
  {
    "text": "fbsd or even on Prem applications could reveal more Low by default SCS local",
    "start": "2224640",
    "end": "2233400"
  },
  {
    "text": "gures and symbolic links finally due to time constraints",
    "start": "2233400",
    "end": "2240200"
  },
  {
    "text": "I'm not able to introduce the real world cases I have find but you can imagine",
    "start": "2240200",
    "end": "2247720"
  },
  {
    "text": "there must be countless re Ro to figure out AC errors to be bypassed and hidden",
    "start": "2247720",
    "end": "2255640"
  },
  {
    "text": "C eyes out there applying all the techniques we discuss today to Bak",
    "start": "2255640",
    "end": "2262560"
  },
  {
    "text": "bounty hunting is now your",
    "start": "2262560",
    "end": "2266680"
  },
  {
    "text": "mission this is the end of my presentation if you have any questions",
    "start": "2267680",
    "end": "2273119"
  },
  {
    "text": "here is my contact information thank you for being here again thanks",
    "start": "2273119",
    "end": "2280920"
  }
]