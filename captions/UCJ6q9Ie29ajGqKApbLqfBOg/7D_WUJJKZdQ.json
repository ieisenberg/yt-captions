[
  {
    "start": "0",
    "end": "37000"
  },
  {
    "text": "good afternoon everybody and welcome to adventures in the Underland the CQ forensic toolkit as a unique weapon",
    "start": "0",
    "end": "7080"
  },
  {
    "text": "against hackers you are in Laguna JKL right now and today Palo Janusz kovitch will be delivering this",
    "start": "7080",
    "end": "13830"
  },
  {
    "text": "talk to you just a couple of comments before we get started don't forget to stop by the business hall it's located",
    "start": "13830",
    "end": "19320"
  },
  {
    "text": "in Mandalay Bay Oceanside and shoreline ballrooms also the black matte but blackhat Arsenal is in the business hall",
    "start": "19320",
    "end": "26310"
  },
  {
    "text": "in Oceanside and one last reminder to make sure to silence your phones and with that Paula take away yes lovely",
    "start": "26310",
    "end": "34550"
  },
  {
    "text": "[Applause] good afternoon everyone how is everybody doing good yes good to hear that okay so",
    "start": "34550",
    "end": "43260"
  },
  {
    "start": "37000",
    "end": "85000"
  },
  {
    "text": "as you see I'm Paula J and they're just a couple of words for the introduction and then we're going to get immediately",
    "start": "43260",
    "end": "48780"
  },
  {
    "text": "to the subject we've got 50 intense minutes about forensics so basically I'm",
    "start": "48780",
    "end": "54149"
  },
  {
    "text": "the CEO of secure so it's a company that I've established 11 years ago we are right now in New York Dubai Switzerland",
    "start": "54149",
    "end": "61829"
  },
  {
    "text": "and Poland performing penetration tests forensic investigations and also",
    "start": "61829",
    "end": "66869"
  },
  {
    "text": "education and myself even though you've got this funky roll over there Microsoft",
    "start": "66869",
    "end": "72119"
  },
  {
    "text": "Regional Director you might be wondering am I actually working for Microsoft and I'm not so why this is over that it's",
    "start": "72119",
    "end": "78720"
  },
  {
    "text": "just like I'm not Microsoft I'm not even a directory so am i regional then yes",
    "start": "78720",
    "end": "84320"
  },
  {
    "text": "this is actually the role of someone that Microsoft gifts including actually",
    "start": "84320",
    "end": "89939"
  },
  {
    "start": "85000",
    "end": "168000"
  },
  {
    "text": "access to the source code of Windows to someone that does something innovative in technology so apparently this is it",
    "start": "89939",
    "end": "97549"
  },
  {
    "text": "but my background is very straightforward enjoying my consultants",
    "start": "97549",
    "end": "103619"
  },
  {
    "text": "life and this is basically my background visiting customers and figuring out if",
    "start": "103619",
    "end": "108869"
  },
  {
    "text": "it's possible to get inside my team as well as lots of research so that's",
    "start": "108869",
    "end": "114000"
  },
  {
    "text": "pretty much what this also session is going to be about so we're going to be discussing the C key forensic tool kit",
    "start": "114000",
    "end": "119670"
  },
  {
    "text": "it's different types of tools that within our team we use them for forensics we share them with you for",
    "start": "119670",
    "end": "125939"
  },
  {
    "text": "free so that's very important to mention and you are able to download them from our blog secure academy",
    "start": "125939",
    "end": "132030"
  },
  {
    "text": "home slash blog and these are the tools that eventually we figured that we need to have them because during the projects",
    "start": "132030",
    "end": "139350"
  },
  {
    "text": "we simply needed them and this is how they were created so we hope and I hope that this session and this is my",
    "start": "139350",
    "end": "146400"
  },
  {
    "text": "personal golfer today it's gonna bring your forensics if you're doing the one to the next level",
    "start": "146400",
    "end": "151860"
  },
  {
    "text": "we're gonna be discussing today things like data protection API because our team fully reverse engineer the whole",
    "start": "151860",
    "end": "157830"
  },
  {
    "text": "crypto platform in Windows and we shared lots of different tools about that so it's gonna be able about this it's gonna",
    "start": "157830",
    "end": "163530"
  },
  {
    "text": "be all about information instruction from Windows so this is what's gonna happen in this 50 minutes I'm also on",
    "start": "163530",
    "end": "170670"
  },
  {
    "start": "168000",
    "end": "195000"
  },
  {
    "text": "Twitter sharing different types of information there so feel free to check and we are good to go if it's about of",
    "start": "170670",
    "end": "179220"
  },
  {
    "text": "course my engagements with in the different types of events and if you will be searching for more information",
    "start": "179220",
    "end": "184319"
  },
  {
    "text": "absolutely please do that within our team it's not only myself speaking from",
    "start": "184319",
    "end": "189780"
  },
  {
    "text": "our team you are able to find lots of different types of tools written by our team members out there yes so that would",
    "start": "189780",
    "end": "195870"
  },
  {
    "start": "195000",
    "end": "258000"
  },
  {
    "text": "be a bit for the introduction let's have a look at the whole context so before we",
    "start": "195870",
    "end": "201360"
  },
  {
    "text": "actually start at the presentation I would like to share with you one of my favorite stories and this is my favorite",
    "start": "201360",
    "end": "207450"
  },
  {
    "text": "story because it shows different kinds of looks on cybersecurity that we've got it doesn't have to be only a technology",
    "start": "207450",
    "end": "213870"
  },
  {
    "text": "can be also something else and the story is related with our customer in Switzerland when I was supposed to do",
    "start": "213870",
    "end": "220739"
  },
  {
    "text": "that social engineering project and they are supposed to do the whole analysis that were related with it so long story",
    "start": "220739",
    "end": "227850"
  },
  {
    "text": "short my job was to get inside the building and still some data whatever that way would be right so I do start",
    "start": "227850",
    "end": "235920"
  },
  {
    "text": "the project like this that I'm like seeing the customer building there is like the entrance so you are able",
    "start": "235920",
    "end": "241829"
  },
  {
    "text": "basically to either like use the card to eat and the door will open or you can",
    "start": "241829",
    "end": "247440"
  },
  {
    "text": "type the pin but I don't have either of those or you can call them there's like this big boba camera and they're gonna",
    "start": "247440",
    "end": "253320"
  },
  {
    "text": "see you which if you want to do a social engineering this is probably the last choice that you would pick right",
    "start": "253320",
    "end": "259269"
  },
  {
    "start": "258000",
    "end": "310000"
  },
  {
    "text": "so at the end what I did there was just this door at the very beginning to the elevator area I stick to some nice guys",
    "start": "259269",
    "end": "265960"
  },
  {
    "text": "back and don't get me wrong I'm gonna be very open with you sorry about that being a woman in a guy's industry helps",
    "start": "265960",
    "end": "272740"
  },
  {
    "text": "a little bit and blonde also adds a little bit of that so I like to talk",
    "start": "272740",
    "end": "278199"
  },
  {
    "text": "really with everybody everywhere in the elevator especially I like to meet",
    "start": "278199",
    "end": "283870"
  },
  {
    "text": "people so this is very nice and social engineering project is something that I also doing that within our team so this",
    "start": "283870",
    "end": "290440"
  },
  {
    "text": "is a little bit of a funky combination that allows me to get inside it organ to",
    "start": "290440",
    "end": "295539"
  },
  {
    "text": "get into different types of situations right so anyway I'm in the elevator area because I did something that we call",
    "start": "295539",
    "end": "301090"
  },
  {
    "text": "tailgating just in case this guy turns back or something I could always smile",
    "start": "301090",
    "end": "306669"
  },
  {
    "text": "her stupidly and he's gonna believe it right so this is this is the situation",
    "start": "306669",
    "end": "312430"
  },
  {
    "start": "310000",
    "end": "352000"
  },
  {
    "text": "now I mean the elevators area yeah and the situation is that we've got an elevator a and D and in between those",
    "start": "312430",
    "end": "320199"
  },
  {
    "text": "you've got a pod and you are able to type like the just to press the floor",
    "start": "320199",
    "end": "325539"
  },
  {
    "text": "number that you want to go to so this particular customer was spread it across three floors six seven or eight so I'm",
    "start": "325539",
    "end": "332259"
  },
  {
    "text": "waiting for someone to actually press four six or seven because I know that on the floor eight that was that reception",
    "start": "332259",
    "end": "338590"
  },
  {
    "text": "and I don't want to be seen over there so I'm leveraging a bit of a surreal type of a girl",
    "start": "338590",
    "end": "344380"
  },
  {
    "text": "we've got always like big bags with like lots of things inside again I mean it fits in the thing to the stereotype some",
    "start": "344380",
    "end": "351130"
  },
  {
    "text": "kind of using it and I'm observing at the same time is there someone pressing the floor six or seven and there is this",
    "start": "351130",
    "end": "357940"
  },
  {
    "text": "guy again it's a it's a real story so I'm oh I was enjoying it this project",
    "start": "357940",
    "end": "364210"
  },
  {
    "text": "actually so there's this guy and he's actually quite handsome score so he",
    "start": "364210",
    "end": "370270"
  },
  {
    "text": "presses the floor six door is opening what I'm doing I'm jumping to the back",
    "start": "370270",
    "end": "376120"
  },
  {
    "text": "side of the elevator quite quickly and immediately and door closes we are",
    "start": "376120",
    "end": "381159"
  },
  {
    "text": "together in the elevator of this guy and the question to you guys is why did I jump to the back side of the elevator",
    "start": "381159",
    "end": "387279"
  },
  {
    "text": "what do you think let's pick out some suggestions put yourself in a yeah he might not",
    "start": "387279",
    "end": "396400"
  },
  {
    "text": "notice me right so I can be like how do I want to be noticed but okay that could be actually one of the situations right",
    "start": "396400",
    "end": "402670"
  },
  {
    "text": "he might not notice me what else make",
    "start": "402670",
    "end": "408610"
  },
  {
    "text": "him Luke oh so that he's kind of natural yet could be I could be pretending that",
    "start": "408610",
    "end": "413980"
  },
  {
    "start": "411000",
    "end": "492000"
  },
  {
    "text": "I'm supposed to beat her yeah it's a couple of other things I could read his mobile phone and so on totally yes but",
    "start": "413980",
    "end": "419920"
  },
  {
    "text": "what happened is that when the door closed we started this conversation right and the conversation was",
    "start": "419920",
    "end": "425410"
  },
  {
    "text": "I'm just asking me a question how are you doing and I'm smiling you know like you know that encourages people to smile",
    "start": "425410",
    "end": "432040"
  },
  {
    "text": "back so he smiles back and he's like I'm fine how are you doing and I'm making a",
    "start": "432040",
    "end": "438250"
  },
  {
    "text": "little bit of a poser because poser makes people to expect you some that you're gonna say something so",
    "start": "438250",
    "end": "443890"
  },
  {
    "text": "it's like this tension is increasing so I'm waiting and smiling and looking and",
    "start": "443890",
    "end": "449260"
  },
  {
    "text": "I'm saying nice to see you again - and he's like again so basically",
    "start": "449260",
    "end": "460140"
  },
  {
    "text": "whenever we are thinking about the whole concept yeah he's feeling that we've",
    "start": "460140",
    "end": "465520"
  },
  {
    "text": "even known each other before yeah so at the end whenever we are just continuing",
    "start": "465520",
    "end": "471340"
  },
  {
    "text": "this conversation I decided to bring the conversation to the next level and I said you know what you smell very well",
    "start": "471340",
    "end": "478770"
  },
  {
    "text": "yeah it's kind of over think right and then he's like and then he's like do you",
    "start": "478770",
    "end": "483790"
  },
  {
    "text": "think so I'm like mm-hmm why did I do that to make him feel good",
    "start": "483790",
    "end": "489550"
  },
  {
    "text": "hey sorry this is brutal I know but who cares about that it's a project to be done right so second part",
    "start": "489550",
    "end": "496870"
  },
  {
    "start": "492000",
    "end": "576000"
  },
  {
    "text": "is that he wants to show off a little bit so when we go to the floor and the door opened he took his card he came out",
    "start": "496870",
    "end": "504130"
  },
  {
    "text": "first that's why I was second an elevator he did the TIC he opened the door and he sat with the lowered voice",
    "start": "504130",
    "end": "509229"
  },
  {
    "text": "ladies first Sumeet again yeah and my job is to steal",
    "start": "509229",
    "end": "514780"
  },
  {
    "text": "data so long story short what was quite interesting I was just going around and",
    "start": "514780",
    "end": "520300"
  },
  {
    "text": "I was wondering where am I able to down and get the data out of someone's",
    "start": "520300",
    "end": "525320"
  },
  {
    "text": "computer and because this was a financial organization there was like traders floors so team of traders they",
    "start": "525320",
    "end": "531529"
  },
  {
    "text": "stood up and they left the room without locking their desktops tons of the boring but I decided to steal the data",
    "start": "531529",
    "end": "537620"
  },
  {
    "text": "so you plug in whatever you is Vista kiff they're allowed not allowed in this case they were allowed I copied some",
    "start": "537620",
    "end": "543050"
  },
  {
    "text": "data around some code and I'm done with my job so later on their job was to",
    "start": "543050",
    "end": "549620"
  },
  {
    "text": "figure out actually what happened and in general my point for everything is that there are so many aspects to take into",
    "start": "549620",
    "end": "556520"
  },
  {
    "text": "consideration when we are doing the forensic investigation as we all know but the question is as well do we have",
    "start": "556520",
    "end": "561709"
  },
  {
    "text": "good tools to investigate what actually happened and this is what this session is about about all these details",
    "start": "561709",
    "end": "568310"
  },
  {
    "text": "interesting places interesting ways of extracting data that will allow us to",
    "start": "568310",
    "end": "573320"
  },
  {
    "text": "bring the investigation to the next level now we're gonna start with a very",
    "start": "573320",
    "end": "578870"
  },
  {
    "start": "576000",
    "end": "670000"
  },
  {
    "text": "interesting tool because we're in our projects as I mentioned we do a lots of",
    "start": "578870",
    "end": "584240"
  },
  {
    "text": "different types of analysis and that interesting tool is going to be related with extracting of the EVT X files from",
    "start": "584240",
    "end": "591380"
  },
  {
    "text": "the memory so we were in the need at the customer site to actually perform the memory dam perform the disk dump but",
    "start": "591380",
    "end": "598339"
  },
  {
    "text": "when we were wondering how and what type of information s else is actually in the memory dump and one of the things that",
    "start": "598339",
    "end": "605209"
  },
  {
    "text": "our team did it took us over six months to do it we have reverse-engineered EVT x format so the even log format which",
    "start": "605209",
    "end": "612320"
  },
  {
    "text": "sounds very easy because it's like XML kind of but eventually it's not easy because in the XML in the EVD experiment",
    "start": "612320",
    "end": "619579"
  },
  {
    "text": "you've got a lots of different types of chunks that are digitally signed and the big chunks are also digitally signed so",
    "start": "619579",
    "end": "626600"
  },
  {
    "text": "when you're a small thing being changed and then the file is corrupted so we technically wrote a tool that not only",
    "start": "626600",
    "end": "633200"
  },
  {
    "text": "makes your files fixed so if you get a corrupted EVT X then we can fix it for you and that's a and B we are able to",
    "start": "633200",
    "end": "640040"
  },
  {
    "text": "extract from the memory of the operating system that even log part that is not",
    "start": "640040",
    "end": "645200"
  },
  {
    "text": "yet written into the EVT X file so if there is even generated we are able to",
    "start": "645200",
    "end": "651589"
  },
  {
    "text": "make a snapshot of it and then build a consistent EVT X file on the top",
    "start": "651589",
    "end": "656660"
  },
  {
    "text": "of that let me show you it's actually very easy to do and I would like to show you that extraction on the live dump so",
    "start": "656660",
    "end": "664070"
  },
  {
    "text": "that at the end you are able to do the same story when you perform your memory",
    "start": "664070",
    "end": "669620"
  },
  {
    "text": "dump so have a look first command that I ran over here it's that I'm using volatility from the analyze analyze DMP",
    "start": "669620",
    "end": "677960"
  },
  {
    "start": "670000",
    "end": "787000"
  },
  {
    "text": "let me just change this particular file over here so we're gonna have to analyze TMP to get information to that dll list",
    "start": "677960",
    "end": "687530"
  },
  {
    "text": "dot txt and within the DLL list dot txt I will be able to see as you see this is",
    "start": "687530",
    "end": "693740"
  },
  {
    "text": "that this is the case different type of output and I already have the file where we are able to see different types of",
    "start": "693740",
    "end": "700880"
  },
  {
    "text": "dll's loaded within the dump why am i doing this because if I would like to extract a VTX files that are",
    "start": "700880",
    "end": "707870"
  },
  {
    "text": "managed by the even block service then even lock service is actually nothing",
    "start": "707870",
    "end": "713390"
  },
  {
    "text": "but the SVC host and you've got one you got a memory dump as you've got many SVC",
    "start": "713390",
    "end": "718490"
  },
  {
    "text": "holes so how do you know which SVC hose hosts windows even lock service by the",
    "start": "718490",
    "end": "723890"
  },
  {
    "text": "DLL loaded in it right so we're going to be searching in this particular dump that DLL that is representing our win in",
    "start": "723890",
    "end": "734060"
  },
  {
    "text": "Windows even lock service so I got that thing so I got here 848 this is the SVC",
    "start": "734060",
    "end": "740900"
  },
  {
    "text": "host protis ID why this is interesting for me because I've got over here wev T SVC in it so this is how you",
    "start": "740900",
    "end": "749180"
  },
  {
    "text": "recognize appropriate windows even block fine now what we're gonna do we're going to extract data from the handles that",
    "start": "749180",
    "end": "757370"
  },
  {
    "text": "this particular SVC host is pointing to so let's do that and we're gonna run",
    "start": "757370",
    "end": "762950"
  },
  {
    "text": "that by leveraging another command so let's just let's just do that so we've got here analyze the empty profile and",
    "start": "762950",
    "end": "770150"
  },
  {
    "text": "then we're going to do you dump files dump files and we're going to do you -",
    "start": "770150",
    "end": "776690"
  },
  {
    "text": "and to preserve the names we're going to do - protists ID 848 it was and then",
    "start": "776690",
    "end": "782810"
  },
  {
    "text": "we're going to do - capital D hand and folder and this is a place where",
    "start": "782810",
    "end": "788479"
  },
  {
    "start": "787000",
    "end": "950000"
  },
  {
    "text": "you're going to be extracting files to which SDC host and also and that's going to be the base for us to work to extract",
    "start": "788479",
    "end": "795679"
  },
  {
    "text": "data from EVT x funds now these EVT X files are not consistent",
    "start": "795679",
    "end": "801439"
  },
  {
    "text": "alright and this is what I would like to show you basically so what we're gonna do over here this is this folder and as",
    "start": "801439",
    "end": "807769"
  },
  {
    "text": "you see we are getting the data in the folder so we don't need more because it's already it's already what we need",
    "start": "807769",
    "end": "813949"
  },
  {
    "text": "so what am i searching for over here it's simply application log and we're",
    "start": "813949",
    "end": "820009"
  },
  {
    "text": "gonna find this this guy why this one because it's big and it would be nice that you guys can see that that's what",
    "start": "820009",
    "end": "825499"
  },
  {
    "text": "we are able to recover what is this this is a part of an Eevee TX found that was actually in the operating systems memory",
    "start": "825499",
    "end": "832729"
  },
  {
    "text": "and that's quite cool I'm gonna take this file and what I'm gonna do I'm gonna paste it into my arm tool over",
    "start": "832729",
    "end": "840439"
  },
  {
    "text": "here so that at the end we are able to see how we are able to of course recover",
    "start": "840439",
    "end": "846199"
  },
  {
    "text": "this type of data so let me show you the whole structure of the demonstration",
    "start": "846199",
    "end": "851449"
  },
  {
    "text": "right so I'm pasting this particular application a log file over here so this",
    "start": "851449",
    "end": "856999"
  },
  {
    "text": "is this one I'm gonna show it in GUI because at the very beginning it's gonna be a little bit more convenient just to",
    "start": "856999",
    "end": "863149"
  },
  {
    "text": "show that this file does not actually open yeah so I'm just gonna press enter",
    "start": "863149",
    "end": "868159"
  },
  {
    "text": "on it and in the meantime I'm gonna see on my screen so let me just move it that this one says that the even log file is",
    "start": "868159",
    "end": "874339"
  },
  {
    "text": "corrupted yes because that's pretty much how they are they're very sensitive so",
    "start": "874339",
    "end": "879559"
  },
  {
    "text": "I'm going to just gonna say okay fine and I in this folder I've got also folder out which is empty",
    "start": "879559",
    "end": "885559"
  },
  {
    "text": "and this particular folder will contain our fixed AVG X so let's just have a",
    "start": "885559",
    "end": "891769"
  },
  {
    "text": "look how simple our tool is at the end in order to fix this type of a situation",
    "start": "891769",
    "end": "897529"
  },
  {
    "text": "so I'm gonna get into this particular tool and the tool works like this cqe",
    "start": "897529",
    "end": "902929"
  },
  {
    "text": "VTX recovery dot exe and we specify on the input folder with the broken data",
    "start": "902929",
    "end": "908239"
  },
  {
    "text": "and we specify output folder here we go where the data should be stored so in in",
    "start": "908239",
    "end": "913249"
  },
  {
    "text": "out enter and then it tells me that it successfully recovered 17 records yeah",
    "start": "913249",
    "end": "919210"
  },
  {
    "text": "and in this particular out folder we are able to see that this is this application file and this application",
    "start": "919210",
    "end": "926820"
  },
  {
    "text": "file we will be able to open basically in our even lock it just takes a little",
    "start": "926820",
    "end": "932380"
  },
  {
    "text": "bit of time so it's just loading it so in a moment I will show you and then",
    "start": "932380",
    "end": "937420"
  },
  {
    "text": "eventually we'll be able to read of what was what was happening with this particular file yeah so this is our",
    "start": "937420",
    "end": "944050"
  },
  {
    "text": "application lock that we are able to technically get access to here we go not",
    "start": "944050",
    "end": "949120"
  },
  {
    "text": "this one this one here we go so here we go so we've got here that information meaning records because they are like",
    "start": "949120",
    "end": "955480"
  },
  {
    "text": "chunks of data so this these are the events that application log a contained",
    "start": "955480",
    "end": "960700"
  },
  {
    "text": "before actually flashing them to the drive just to make sure you don't miss out maybe there is something important",
    "start": "960700",
    "end": "967360"
  },
  {
    "text": "maybe not but lots of files like that may contain some useful useful information ok guys so what we are",
    "start": "967360",
    "end": "974710"
  },
  {
    "text": "discussing that is there any other tool is there any other place that could help",
    "start": "974710",
    "end": "979810"
  },
  {
    "text": "us out to get more information about what's going on yeah if someone gives you a disk for forensics we are",
    "start": "979810",
    "end": "986410"
  },
  {
    "text": "wondering ok like now state is yours what type of information we're gonna be extracting us on Journal of course we're",
    "start": "986410",
    "end": "992620"
  },
  {
    "text": "gonna be getting into prefetch which I'll show you in a moment we're going to be getting into impossibly hashes of the",
    "start": "992620",
    "end": "998530"
  },
  {
    "text": "users profile related information so the list is big but there are a couple of places that are quite unusual to search",
    "start": "998530",
    "end": "1005730"
  },
  {
    "text": "and this is something that I would like to I would like to show you one of the first things that we're gonna get to",
    "start": "1005730",
    "end": "1011180"
  },
  {
    "text": "it's one of our favorite tools which is related with extracting the passwords",
    "start": "1011180",
    "end": "1016770"
  },
  {
    "text": "from these service accounts and this is something that we're going to be getting to if within the services you will find",
    "start": "1016770",
    "end": "1023130"
  },
  {
    "text": "out in a security hive in the registry of that machine that you've got some secrets in the registry hive that is",
    "start": "1023130",
    "end": "1031079"
  },
  {
    "text": "basically security then we get into policy secrets and then we are able to",
    "start": "1031080",
    "end": "1036689"
  },
  {
    "text": "see basically if there are some secrets stored so you can simply see that then",
    "start": "1036690",
    "end": "1042600"
  },
  {
    "text": "our job is going to be to extract maybe some then chose of that particular user so",
    "start": "1042600",
    "end": "1047880"
  },
  {
    "text": "let me show you what do we mean by this yeah so and what kind of secrets we are referring to if we do Rech edit here we",
    "start": "1047880",
    "end": "1054360"
  },
  {
    "text": "go and we are right now in this path that I was mentioning so we are in the",
    "start": "1054360",
    "end": "1059600"
  },
  {
    "text": "security hive right now and we are in a policy and then there is this folder",
    "start": "1059600",
    "end": "1065370"
  },
  {
    "text": "that is actually called secrets I wonder what it contains and we are able to see here that there is lots of data",
    "start": "1065370",
    "end": "1071550"
  },
  {
    "text": "prediction API secrets but then there is also or could be a secret that is related with the particular service",
    "start": "1071550",
    "end": "1078120"
  },
  {
    "text": "account yes and what do we mean by this so let's let's have a look and so this is basically the entrance if we do have",
    "start": "1078120",
    "end": "1085350"
  },
  {
    "text": "a look at the service accounts so we get into the services.msc yeah and I find over here some kind of a service so",
    "start": "1085350",
    "end": "1092130"
  },
  {
    "text": "we've got a pool of service logon and I will just to create some kind of the secrets over here it doesn't matter",
    "start": "1092130",
    "end": "1098760"
  },
  {
    "text": "which account we are using I'm just typing something it could be whatever we type in over here fantastic then if we",
    "start": "1098760",
    "end": "1105810"
  },
  {
    "text": "do refresh this yeah then basically we're gonna see over here that there is",
    "start": "1105810",
    "end": "1111150"
  },
  {
    "text": "actually a secret and this is how you recognize it that is called pj service and from that secret offline we are able",
    "start": "1111150",
    "end": "1118710"
  },
  {
    "text": "to extract the password for the service accounts so quite a straightforward operation and we do it basically like",
    "start": "1118710",
    "end": "1126000"
  },
  {
    "text": "this so we go to the secu secret dumper and then you just specify the service",
    "start": "1126000",
    "end": "1131010"
  },
  {
    "text": "name and in this case plus a pj service and then you were able to see the password coming out it might be a useful",
    "start": "1131010",
    "end": "1136770"
  },
  {
    "text": "information yeah so it is actually a tool that our customers are also using",
    "start": "1136770",
    "end": "1141930"
  },
  {
    "text": "just to figure out what are the passwords for the service accounts but it also could be used for that reason",
    "start": "1141930",
    "end": "1147600"
  },
  {
    "text": "yeah okay so what else do we have we are we have as well one interesting tool and",
    "start": "1147600",
    "end": "1154200"
  },
  {
    "text": "let's just show it but eventually it is actually quite a lightweight tool which is related with extracting information",
    "start": "1154200",
    "end": "1160500"
  },
  {
    "start": "1160000",
    "end": "1480000"
  },
  {
    "text": "from the windows prefetch so let's have a look guys like how this particular tool will work out so if we have a look",
    "start": "1160500",
    "end": "1168840"
  },
  {
    "text": "at the operating system in Windows we've got something like prefetch prefetch",
    "start": "1168840",
    "end": "1174150"
  },
  {
    "text": "when its own contains information about what ever executed in our books yes so it",
    "start": "1174150",
    "end": "1180920"
  },
  {
    "text": "clutters history about whatever was executed so if you did not delete it it",
    "start": "1180920",
    "end": "1186020"
  },
  {
    "text": "will contain the whole history since you pretty much installed Windows you are able to see over here that you had",
    "start": "1186020",
    "end": "1191809"
  },
  {
    "text": "certain type of executive all that executed that many times at that time",
    "start": "1191809",
    "end": "1196970"
  },
  {
    "text": "and it contained different types of dll's loaded let me show you basically how we are able to extract information",
    "start": "1196970",
    "end": "1203480"
  },
  {
    "text": "from this PF files and actually make it useful so when you wondered how do I",
    "start": "1203480",
    "end": "1209360"
  },
  {
    "text": "know that our infrastructure has been compromised let's have a look at the prefetch could hacker delete a prefetch of course that",
    "start": "1209360",
    "end": "1216890"
  },
  {
    "text": "could be always some kind of a fun done around all this evidence everything VTX",
    "start": "1216890",
    "end": "1223100"
  },
  {
    "text": "though it's very hard to play with you can always delete it though but prefetch is quite straightforward to",
    "start": "1223100",
    "end": "1229040"
  },
  {
    "text": "edit but hopefully this wasn't changed which maybe you can change in a check in aus and journal to let's have a look at",
    "start": "1229040",
    "end": "1235850"
  },
  {
    "text": "one executive all this the cool bit is and I'm gonna do over here shift right",
    "start": "1235850",
    "end": "1241400"
  },
  {
    "text": "click and then we're gonna do copy as path and within our toolkit we've got a",
    "start": "1241400",
    "end": "1246470"
  },
  {
    "text": "simple tool which is called CQ prefetch parser that I'm pretty sure you guys might enjoy it because the only thing we",
    "start": "1246470",
    "end": "1253040"
  },
  {
    "text": "specify over here it's the - F file and then we do - a for analysis and this",
    "start": "1253040",
    "end": "1258590"
  },
  {
    "text": "shows us fully not only the list of the modules so dll's and some other files loaded in that",
    "start": "1258590",
    "end": "1265690"
  },
  {
    "text": "ended process but also how many times someone has been running it so in this",
    "start": "1265690",
    "end": "1272150"
  },
  {
    "text": "case you're able to see that it has been six to eight times plus these are the times that this file has been actually",
    "start": "1272150",
    "end": "1278720"
  },
  {
    "text": "running so it's quite nice because it shows you the history of particular executables in operating system now this",
    "start": "1278720",
    "end": "1285860"
  },
  {
    "text": "is fun but at the end what if for example we're gonna have run count one and this is what we are looking for so",
    "start": "1285860",
    "end": "1293330"
  },
  {
    "text": "it could be called notepad which by name because it doesn't have a digital signature it doesn't sounds very juicy",
    "start": "1293330",
    "end": "1299720"
  },
  {
    "text": "but if you see that run count for note but is one that's already suspicious and",
    "start": "1299720",
    "end": "1305870"
  },
  {
    "text": "you might have a look father maybe in Windows indexing service maybe newest and journal maybe in a cache of compatibility and a",
    "start": "1305870",
    "end": "1313039"
  },
  {
    "text": "couple of other places if this file has been actually there what does it do etc so quite an interesting perspective now",
    "start": "1313039",
    "end": "1320679"
  },
  {
    "text": "whenever we are thinking about all this data the prefetch is quite popular but",
    "start": "1320679",
    "end": "1326450"
  },
  {
    "text": "is there something unusual that can contain useful information that might be",
    "start": "1326450",
    "end": "1332989"
  },
  {
    "text": "a might be containing something that could indicate that something happened in this box yes",
    "start": "1332989",
    "end": "1339019"
  },
  {
    "text": "one of the interesting things that we've been looking at is actually related with",
    "start": "1339019",
    "end": "1344269"
  },
  {
    "text": "extracting data from the remote desktop cache and in order to extract data from",
    "start": "1344269",
    "end": "1351619"
  },
  {
    "text": "the remote desktop cache what you need to do is to get first cache file of course and then have a tool that will",
    "start": "1351619",
    "end": "1359899"
  },
  {
    "text": "allow you to work on this particular cache file and that is something that we've written probably this is the most",
    "start": "1359899",
    "end": "1366019"
  },
  {
    "text": "ugly tool that you were ever see from us because the GUI is literally non-existent and the tool itself is",
    "start": "1366019",
    "end": "1372649"
  },
  {
    "text": "actually quite quite funny but what is the beauty of the tool is that remote",
    "start": "1372649",
    "end": "1378859"
  },
  {
    "text": "desktop in general it's a it's a protocol that is relying on the grid so",
    "start": "1378859",
    "end": "1385070"
  },
  {
    "text": "when you connect for example remotely to the server using the RDP you download",
    "start": "1385070",
    "end": "1391789"
  },
  {
    "text": "and they get different grids and you kind of stuck it on the top of the cache file and this is something that I would",
    "start": "1391789",
    "end": "1397700"
  },
  {
    "text": "like to show you guys so what do we do to get this particular cache so let's",
    "start": "1397700",
    "end": "1403129"
  },
  {
    "text": "have a look our tools name if we have a look over here it's called actually a",
    "start": "1403129",
    "end": "1408440"
  },
  {
    "text": "security cache and within the security cache you are able to load this one this",
    "start": "1408440",
    "end": "1415970"
  },
  {
    "text": "is for hiding files we've got this one and we just do load and over here I'm",
    "start": "1415970",
    "end": "1422269"
  },
  {
    "text": "loading the cache from sample user administrator update I look on Microsoft Terminal Server client cache we do open",
    "start": "1422269",
    "end": "1429619"
  },
  {
    "text": "here we go and we can do the code now depending on the remote desktop clients version that agreed might have a",
    "start": "1429619",
    "end": "1436730"
  },
  {
    "text": "different size so this one we are specifying on 32 so it's gonna be a 64",
    "start": "1436730",
    "end": "1442220"
  },
  {
    "text": "size and then we do their coat and that looks a little bit better and a question to",
    "start": "1442220",
    "end": "1447570"
  },
  {
    "text": "you guys is what did someone see what is this yeah it is well it's not a snapshot",
    "start": "1447570",
    "end": "1457049"
  },
  {
    "text": "it's like degree that we have stucked in but of course it's not a puzzle it's so you cannot build logic on the top of",
    "start": "1457049",
    "end": "1463620"
  },
  {
    "text": "that because it's just stuck so if someone moves window around women already pee it's gonna be just like in",
    "start": "1463620",
    "end": "1469590"
  },
  {
    "text": "this weird way putting the grete that the squares on the top of the log house so what did someone see what is this",
    "start": "1469590",
    "end": "1478380"
  },
  {
    "text": "what is this console about is exactly thank you yeah so we were able to see that someone could see IAS and this file",
    "start": "1478380",
    "end": "1485970"
  },
  {
    "start": "1480000",
    "end": "1557000"
  },
  {
    "text": "is big so you can move in in kind of snapshots yeah in the file to observe",
    "start": "1485970",
    "end": "1491880"
  },
  {
    "text": "how what was actually happening within the remote desktop session so this is a whole history of ever happens whatever",
    "start": "1491880",
    "end": "1498929"
  },
  {
    "text": "happens within the remote desktop session yes so it's somewhat like recording but you were able to see that",
    "start": "1498929",
    "end": "1504809"
  },
  {
    "text": "by the square little pictures yeah so a little bit of that now whenever we are",
    "start": "1504809",
    "end": "1509970"
  },
  {
    "text": "thinking of course about different types of files being deleted because maybe",
    "start": "1509970",
    "end": "1515070"
  },
  {
    "text": "someone could delete this file is it possible in an easy way to recover files",
    "start": "1515070",
    "end": "1520110"
  },
  {
    "text": "yes we actually got a tool that is called CQ undelete that i would like to",
    "start": "1520110",
    "end": "1525720"
  },
  {
    "text": "show you because there's a couple of ways how we are able to delete the files but the funky part about the tool is",
    "start": "1525720",
    "end": "1532230"
  },
  {
    "text": "that with the super-easy perspective it allows us to recover files also from the",
    "start": "1532230",
    "end": "1538470"
  },
  {
    "text": "MFT and small files up to approximately 700 bytes when you delete them and even",
    "start": "1538470",
    "end": "1546090"
  },
  {
    "text": "though when you do it with shift and even though when you overwrite the disk there will be still stored in a clear",
    "start": "1546090",
    "end": "1552059"
  },
  {
    "text": "text in MFT and our tool allows you to recover that kind of data yeah so this",
    "start": "1552059",
    "end": "1557639"
  },
  {
    "start": "1557000",
    "end": "1791000"
  },
  {
    "text": "is basically what I would like to show you so let's have a look at that after at this situation right so I've got over",
    "start": "1557639",
    "end": "1563970"
  },
  {
    "text": "here a certain certain of type of a partition so let me just mount it within",
    "start": "1563970",
    "end": "1569669"
  },
  {
    "text": "the powershell so that you can see that we are doing it in a fresh way so this is it so we've got a certain path where",
    "start": "1569669",
    "end": "1576950"
  },
  {
    "text": "mounting the partition here we go and then this is our X Drive over here so let me take this and what we're going to",
    "start": "1576950",
    "end": "1583940"
  },
  {
    "text": "do over here in the moment so this is also our power shell case I'm going to create on this particular partition lots",
    "start": "1583940",
    "end": "1589940"
  },
  {
    "text": "of different types of files that eventually I'm going to delete and so this is their this is the demonstration",
    "start": "1589940",
    "end": "1596360"
  },
  {
    "text": "let me just pull it out yes so I have created these files so we've got a wipe me wipe me out me so what I'm gonna do",
    "start": "1596360",
    "end": "1602659"
  },
  {
    "text": "shift right-click so I'm just gonna select all these files shits right-click",
    "start": "1602659",
    "end": "1607700"
  },
  {
    "text": "and we're gonna do delete fantastic yes we got it so fast are deleted what else",
    "start": "1607700",
    "end": "1614059"
  },
  {
    "text": "I'm gonna do I'm gonna overwrite yeah here that particular partition so just",
    "start": "1614059",
    "end": "1620750"
  },
  {
    "text": "to make sure the data isn't there etc and then with our toe I'm gonna list all",
    "start": "1620750",
    "end": "1626480"
  },
  {
    "text": "the possibilities of what eventually we are able to recover so even though this",
    "start": "1626480",
    "end": "1633139"
  },
  {
    "text": "data has been deleted and overwritten we are still able to do a little bit more",
    "start": "1633139",
    "end": "1638210"
  },
  {
    "text": "about about that that's recovery and basically when we have a look at the",
    "start": "1638210",
    "end": "1644210"
  },
  {
    "text": "whole concept is it possible to recover a file I've got here another command with the C key undelete or from the",
    "start": "1644210",
    "end": "1651139"
  },
  {
    "text": "volume X when we are under leting the file that is called wipe me 8 txt and we",
    "start": "1651139",
    "end": "1656840"
  },
  {
    "text": "are doing the output into the wipe me a txt let's have a look I got a file",
    "start": "1656840",
    "end": "1662510"
  },
  {
    "text": "already like this because I've been practicing before the demonstration so let's delete it which would be even better because we'll be able to see that",
    "start": "1662510",
    "end": "1668929"
  },
  {
    "text": "it actually worked out here we go or we can change the output name that's fine too",
    "start": "1668929",
    "end": "1674179"
  },
  {
    "text": "here we go and then our wipe me txt is actually the file that contains the",
    "start": "1674179",
    "end": "1680539"
  },
  {
    "text": "certain type of the content yeah so very easy way to undelete files not only the",
    "start": "1680539",
    "end": "1686330"
  },
  {
    "text": "ones that are stored inside the MFT but also the fan that has been just deleted yeah so quite an easy tool but very very",
    "start": "1686330",
    "end": "1693799"
  },
  {
    "text": "handy especially even for your private use when you are deleting the file that you would like to get access to back ok",
    "start": "1693799",
    "end": "1700909"
  },
  {
    "text": "fantastic so what else is interesting now we're going to get into the subject that is absolutely exciting because",
    "start": "1700909",
    "end": "1707720"
  },
  {
    "text": "there are plenty of places that contain information but what is the most difficult part of that it's a data",
    "start": "1707720",
    "end": "1714499"
  },
  {
    "text": "protection API and our team has fully reversed data protection API so full",
    "start": "1714499",
    "end": "1720080"
  },
  {
    "text": "crypto platform in Windows and we've got all of that different have the tools over actually 40 tools that are",
    "start": "1720080",
    "end": "1726139"
  },
  {
    "text": "cooperating with data protection API forensically to give you the data back so what I would like to present to you",
    "start": "1726139",
    "end": "1732859"
  },
  {
    "text": "today it's an interesting scenario where our job is going to be to get access to",
    "start": "1732859",
    "end": "1738649"
  },
  {
    "text": "the information that is stored by the user in an encrypted way and our job is",
    "start": "1738649",
    "end": "1746720"
  },
  {
    "text": "going to be to decrypt it and get access to the users secrets so which scenario does this apply to all",
    "start": "1746720",
    "end": "1754159"
  },
  {
    "text": "of the scenarios where user is stirring password in the browser storing passwords in Outlook storing private",
    "start": "1754159",
    "end": "1760970"
  },
  {
    "text": "keys storing for example passwords were in keep us if the key pass is relying on",
    "start": "1760970",
    "end": "1767179"
  },
  {
    "text": "the Data Protection API remote desktop connection manager and any other lead to",
    "start": "1767179",
    "end": "1772399"
  },
  {
    "text": "the application that uses data protection API and there's a plenty of those so let's have a look because this",
    "start": "1772399",
    "end": "1777919"
  },
  {
    "text": "scenario it's not only important forensically but it's also important for ourselves if you ever wondered if I do",
    "start": "1777919",
    "end": "1784549"
  },
  {
    "text": "store some kind of a secret in my laptop is it safe and let's answer that question if you don't mind so what we're",
    "start": "1784549",
    "end": "1792559"
  },
  {
    "text": "gonna do here we got a user that is actually Windows 10 let's just use that",
    "start": "1792559",
    "end": "1799129"
  },
  {
    "text": "and I'm gonna log on to the Windows 10 box let's have a look as Freddie and",
    "start": "1799129",
    "end": "1805720"
  },
  {
    "text": "bring it on we're gonna log on as Freddie using the password password yeah I'm showing you this because it's",
    "start": "1805720",
    "end": "1811759"
  },
  {
    "text": "gonna be quite important information let's do that so we got it we can just minimize that I have no access to the",
    "start": "1811759",
    "end": "1817580"
  },
  {
    "text": "internet with this machine there's no vulnerability that we are overusing over here that's how it works and this is how",
    "start": "1817580",
    "end": "1823249"
  },
  {
    "text": "it has been working for all time our team has reverse engineers so that we are able to decrypt everything that",
    "start": "1823249",
    "end": "1828769"
  },
  {
    "text": "moves pretty much that belongs to the user let's see this is called data prediction API classic what we're going",
    "start": "1828769",
    "end": "1834919"
  },
  {
    "text": "to pre be presenting because an alternative for that it's a data prediction API and G which we can also",
    "start": "1834919",
    "end": "1840649"
  },
  {
    "text": "touch the base on while we are for example trying to recover thus it protected pfx files which are",
    "start": "1840649",
    "end": "1847009"
  },
  {
    "text": "available since Windows Server 2012 r2 so let's have a look so we've got the",
    "start": "1847009",
    "end": "1852590"
  },
  {
    "text": "following situation yeah let's go to the scenario first we've got Freddie Freddie being a user stored passwords in Chrome",
    "start": "1852590",
    "end": "1861080"
  },
  {
    "text": "yeah we might disagree if it's good or bad it doesn't matter because chrome is also leveraging the P API and this is",
    "start": "1861080",
    "end": "1867919"
  },
  {
    "text": "the prediction API secrets of the user bank what do we see over here and I'm using the use of tool chrome pass for",
    "start": "1867919",
    "end": "1874100"
  },
  {
    "text": "that and that's okay is a password password yeah so this is a password stored in a browser not a rocket science",
    "start": "1874100",
    "end": "1880279"
  },
  {
    "text": "no what our job is gonna be is to get access to this password but as an",
    "start": "1880279",
    "end": "1886879"
  },
  {
    "text": "outsider and let me explain first if you don't mind how data prediction API works",
    "start": "1886879",
    "end": "1892909"
  },
  {
    "start": "1891000",
    "end": "2152000"
  },
  {
    "text": "in order to basically get this particular data out first of all data",
    "start": "1892909",
    "end": "1898820"
  },
  {
    "text": "prediction API in general allows us to encrypt data in windows and that's a fact now it is used by many many",
    "start": "1898820",
    "end": "1907070"
  },
  {
    "text": "different types of applications in a different way and in order to be able to get access to the data protection API",
    "start": "1907070",
    "end": "1913009"
  },
  {
    "text": "secrets you have to do it in two ways and one way it's if you are a local user",
    "start": "1913009",
    "end": "1919190"
  },
  {
    "text": "and another way if you are in a domain user now this might not be super clearly",
    "start": "1919190",
    "end": "1924320"
  },
  {
    "text": "readable but absolutely have a look but I would like to use my artistic skills so that you can guys see by the picture",
    "start": "1924320",
    "end": "1931549"
  },
  {
    "text": "and I'm gonna paint with my finger what is the difference in between local user and the domain user let's do that here",
    "start": "1931549",
    "end": "1939200"
  },
  {
    "text": "we go so story goes like this we've got over here local user and we've got over here",
    "start": "1939200",
    "end": "1944269"
  },
  {
    "text": "domain user yeah now I'm gonna be obvious for the moment just for the purpose of",
    "start": "1944269",
    "end": "1950359"
  },
  {
    "text": "explanation of this we've got a user that logged on with the username and the password and if it's a local user of",
    "start": "1950359",
    "end": "1956749"
  },
  {
    "text": "course we are calculating md4 on the top of that which we compare with the some",
    "start": "1956749",
    "end": "1962090"
  },
  {
    "text": "database this is clear now here's funky part password we are calculating on the",
    "start": "1962090",
    "end": "1968059"
  },
  {
    "text": "top of the password choix one and that schewe one is used to encrypt master key",
    "start": "1968059",
    "end": "1975620"
  },
  {
    "text": "that we store in the master key container and that master key indirectly",
    "start": "1975620",
    "end": "1981110"
  },
  {
    "text": "but still this is quite linear situation is used to encrypt or decrypt our secret",
    "start": "1981110",
    "end": "1987110"
  },
  {
    "text": "our secret let's say could the chrome password or Outlook password doesn't really matter so we can easily get into",
    "start": "1987110",
    "end": "1994010"
  },
  {
    "text": "the conclusion that our secrets if we are a local user are as safe as",
    "start": "1994010",
    "end": "1999650"
  },
  {
    "text": "our password strength is yeah so that's it because data prediction API being a good",
    "start": "1999650",
    "end": "2006669"
  },
  {
    "text": "mechanism in this case relies on our password strength M now whenever we are",
    "start": "2006669",
    "end": "2012130"
  },
  {
    "text": "thinking about the domain user though let's change the perspective here it is",
    "start": "2012130",
    "end": "2017409"
  },
  {
    "text": "working in an interesting way because we've got over here a username and the password and I'm gonna shorten of course",
    "start": "2017409",
    "end": "2024610"
  },
  {
    "text": "the whole authentication process because it's not important right now so when the user logs on we've got of",
    "start": "2024610",
    "end": "2030279"
  },
  {
    "text": "course calculated md4 on the top of that eventually we authenticate to the domain",
    "start": "2030279",
    "end": "2036370"
  },
  {
    "text": "and that nd4 so there is a difference it's used to encrypt master key 1 from",
    "start": "2036370",
    "end": "2043779"
  },
  {
    "text": "the master key container that is used to encrypt a secret that's fine but what",
    "start": "2043779",
    "end": "2050950"
  },
  {
    "text": "else it's you over here so master key - it's something that we call in general",
    "start": "2050950",
    "end": "2057608"
  },
  {
    "text": "at the key that is used within the domain and the master key - it's the same there",
    "start": "2057609",
    "end": "2063010"
  },
  {
    "text": "equal that is also used to encrypt the secret but master key - it's encrypted",
    "start": "2063010",
    "end": "2069450"
  },
  {
    "text": "by the public key of the domain here we",
    "start": "2069450",
    "end": "2075070"
  },
  {
    "text": "go so master key 1 by our password hash master key - by the public here the",
    "start": "2075070",
    "end": "2081429"
  },
  {
    "text": "domain what is the question that we need to ask over here in order to get access",
    "start": "2081429",
    "end": "2086770"
  },
  {
    "text": "to the master key - where is the private key who stores the private key and",
    "start": "2086770",
    "end": "2093628"
  },
  {
    "text": "there's good news and bad news well actually both news or bad but eventually",
    "start": "2093629",
    "end": "2099130"
  },
  {
    "text": "one is better than the other so bad news is that there is only one public key",
    "start": "2099130",
    "end": "2105839"
  },
  {
    "text": "across the whole so if you are working in a hundred thousand people company public key its",
    "start": "2105839",
    "end": "2113650"
  },
  {
    "text": "encrypting master key to for every single user being a domain member what does it mean it means that whoever has",
    "start": "2113650",
    "end": "2120819"
  },
  {
    "text": "access to the private key is actually able to eventually decrypt all of the",
    "start": "2120819",
    "end": "2127720"
  },
  {
    "text": "people's secrets stored in their profiles so being that person it's a bit of a powerful role",
    "start": "2127720",
    "end": "2135520"
  },
  {
    "text": "isn't it so let's play this role for the moment to learn what our toolkit can",
    "start": "2135520",
    "end": "2140950"
  },
  {
    "text": "help you with but at the same time it could be also dangerous depends on who's",
    "start": "2140950",
    "end": "2146530"
  },
  {
    "text": "who is actually using it so what we're gonna do we're gonna do this scenario like that so I'm gonna be back to the",
    "start": "2146530",
    "end": "2153940"
  },
  {
    "text": "Windows 10 client box and in order to keep this demo linear I'm gonna allow",
    "start": "2153940",
    "end": "2159880"
  },
  {
    "text": "myself to use offline access just to keep it straight but we can do it both online and offline",
    "start": "2159880",
    "end": "2166180"
  },
  {
    "text": "to edit different types of data that I'm gonna be editing over here so I'm just gonna do it like this because it's quite",
    "start": "2166180",
    "end": "2172630"
  },
  {
    "text": "straightforward so let me restart this box because what we're gonna do we're",
    "start": "2172630",
    "end": "2178000"
  },
  {
    "text": "gonna overwrite cache logon data so something that people call cache credentials but I have nothing to do",
    "start": "2178000",
    "end": "2183970"
  },
  {
    "text": "with credentials and we're gonna log on to this box with a different password so",
    "start": "2183970",
    "end": "2189940"
  },
  {
    "text": "that we've got a different passwords hash so that first you guys can see that if we are using a different password we",
    "start": "2189940",
    "end": "2197290"
  },
  {
    "text": "are not able to get access to the users data and that's positive but of course we would not be on a black hat if it",
    "start": "2197290",
    "end": "2203920"
  },
  {
    "text": "ended up like that so let's continue this scenario of something a little bit more dramatic so let's overwrite cache logon data",
    "start": "2203920",
    "end": "2211540"
  },
  {
    "text": "first we're gonna go repair your computer here we go and then we're gonna get into a scenario",
    "start": "2211540",
    "end": "2219310"
  },
  {
    "text": "where we're gonna do troubleshoot common prompt and then we've got our common problem let me just quickly increase the",
    "start": "2219310",
    "end": "2225819"
  },
  {
    "text": "font so that the guys in the back can see - bang and let's get into C key",
    "start": "2225819",
    "end": "2232270"
  },
  {
    "text": "tools over here and let's get into that key we secure Edition and let's go to",
    "start": "2232270",
    "end": "2237310"
  },
  {
    "text": "the because of the Benjamin sitting over here there you go but this is our secure additional swell",
    "start": "2237310",
    "end": "2244300"
  },
  {
    "text": "so if you drop it to the virustotal it's not recognized by antivirus by the way and we're gonna do like this and let's",
    "start": "2244300",
    "end": "2250839"
  },
  {
    "text": "say dump cache and we are overriding cache logon data so we do D windows",
    "start": "2250839",
    "end": "2258790"
  },
  {
    "text": "system32 config and we are right now System overriding a cache loggin data so",
    "start": "2258790",
    "end": "2265210"
  },
  {
    "text": "that we can log on with a different password eventually different passwords hash so that we will try to get access",
    "start": "2265210",
    "end": "2271450"
  },
  {
    "text": "to our secrets stored in Chrome but we won't be able to well let's have a look so we've got a system 32 and we're gonna",
    "start": "2271450",
    "end": "2278079"
  },
  {
    "text": "do security and then we're gonna do QE to override cache load on data bank now",
    "start": "2278079",
    "end": "2285220"
  },
  {
    "text": "every let's see what we got system 32 oh my bad convict of course this is what's",
    "start": "2285220",
    "end": "2291430"
  },
  {
    "text": "missing so I made a small typo come on but let's correct ourselves it's not security but it's still config and then",
    "start": "2291430",
    "end": "2298150"
  },
  {
    "text": "we've got security that works fantastic now in order to be able to log on with the cache logon data what we need to do",
    "start": "2298150",
    "end": "2305410"
  },
  {
    "text": "is to disconnect ourselves from the network so this is also simulation of a",
    "start": "2305410",
    "end": "2310569"
  },
  {
    "text": "forensic activity when someone gives you the drive and you are supposed to analyze that data offline so let's take",
    "start": "2310569",
    "end": "2318910"
  },
  {
    "text": "this off and right now I'm on the client machine I'm not booting it from any CD",
    "start": "2318910",
    "end": "2324880"
  },
  {
    "text": "DVD which is gonna log on as Freddie but we're gonna log on with a different password by knowing how cache logon data",
    "start": "2324880",
    "end": "2331839"
  },
  {
    "text": "works and the cache logon data allows us eventually to log on to this particular",
    "start": "2331839",
    "end": "2338589"
  },
  {
    "text": "box with a different password just for the reference if someone is interested what we actually did underneath we have",
    "start": "2338589",
    "end": "2345369"
  },
  {
    "text": "overeaten cache Logan data by leveraging the knowledge about the Microsoft's",
    "start": "2345369",
    "end": "2350530"
  },
  {
    "text": "implementation of the msec to where you were actually using the function pbkdf2 that takes a bunch of parameters yes one",
    "start": "2350530",
    "end": "2358210"
  },
  {
    "text": "is the H mark Schwahn so let's say somewhat random value this is c1 which is nothing but a username",
    "start": "2358210",
    "end": "2364450"
  },
  {
    "text": "stick to users passwords hash so user name MD for so passwords hash",
    "start": "2364450",
    "end": "2370510"
  },
  {
    "text": "and on the top of that we calculate md4 and that is what DC c1 is and then we've",
    "start": "2370510",
    "end": "2376630"
  },
  {
    "text": "got a username 10240 iterations on the 16 blocks so this is what the cash flow",
    "start": "2376630",
    "end": "2382510"
  },
  {
    "text": "con data was we didn't break it we just overwritten it that's it so once we are on our client box again now try",
    "start": "2382510",
    "end": "2390670"
  },
  {
    "text": "to log on with the password password here we go and Bank as you see does not",
    "start": "2390670",
    "end": "2398500"
  },
  {
    "text": "work out and our password is gonna be this time me me guts so let's just to",
    "start": "2398500",
    "end": "2404200"
  },
  {
    "start": "2399000",
    "end": "2469000"
  },
  {
    "text": "enter and then basically we are able to log on to the Freddy Krueger's box let's",
    "start": "2404200",
    "end": "2409510"
  },
  {
    "text": "have a look immediately into the secret tools if we are able to get access to this chrome pass and we are firing up",
    "start": "2409510",
    "end": "2416410"
  },
  {
    "text": "this right now in order to see if we are able to get access to that user secret and that takes time why because we are",
    "start": "2416410",
    "end": "2423010"
  },
  {
    "text": "using master keys we are trying to decrypt master keys with the current password hash and we cannot do that and",
    "start": "2423010",
    "end": "2429220"
  },
  {
    "text": "unfortunately that takes time but eventually we can see that unfortunately",
    "start": "2429220",
    "end": "2434230"
  },
  {
    "text": "were not able to get access to the users passwords because the current password hash did not decrypt master key 1 right",
    "start": "2434230",
    "end": "2441790"
  },
  {
    "text": "okay let's start fun so I would like to get access to the secret remotes more I",
    "start": "2441790",
    "end": "2448150"
  },
  {
    "text": "would like to get access to the secret of every single person working in this company so what do I do so I do the following first of all yeah",
    "start": "2448150",
    "end": "2455860"
  },
  {
    "text": "I have no access to this into the internet here so let's just take it out first of all what we do we get into a DC",
    "start": "2455860",
    "end": "2464280"
  },
  {
    "text": "this is the guy where we extract the",
    "start": "2464280",
    "end": "2469630"
  },
  {
    "start": "2469000",
    "end": "2578000"
  },
  {
    "text": "something that our team has called a gold certificate or master certificate",
    "start": "2469630",
    "end": "2474690"
  },
  {
    "text": "that protected particular certificate is actually stored in the NTDs toadette and",
    "start": "2474690",
    "end": "2482460"
  },
  {
    "text": "you are not able to find it in the regular certificate store of the server and that particular certificate in order",
    "start": "2482460",
    "end": "2489280"
  },
  {
    "text": "to be extracted and let's have a look at this one we need to have appropriate",
    "start": "2489280",
    "end": "2494980"
  },
  {
    "text": "tool for that so we've got a cql so secrets dumper and CQ also secrets",
    "start": "2494980",
    "end": "2500290"
  },
  {
    "text": "dumper allows us to specify it simply as parameter a file and we do exported pfx",
    "start": "2500290",
    "end": "2507390"
  },
  {
    "text": "where we are able to get this private key out now who can get access to this",
    "start": "2507390",
    "end": "2513810"
  },
  {
    "text": "key anybody who is domain admin okay so it could be a case of a domain admin",
    "start": "2513810",
    "end": "2519810"
  },
  {
    "text": "that you don't trust that basically extract that it could be also extracted in an attack but that's a different",
    "start": "2519810",
    "end": "2526020"
  },
  {
    "text": "story and anybody who has privilege of replicating directory changes all and",
    "start": "2526020",
    "end": "2532920"
  },
  {
    "text": "that is quite interesting because in the time of a sharepoint 2003 there was",
    "start": "2532920",
    "end": "2539130"
  },
  {
    "text": "actually a book release that contained a mistake which was recommending administrators of sharepoint for the",
    "start": "2539130",
    "end": "2545660"
  },
  {
    "text": "prove the profile replication accounts to give this particular privilege so",
    "start": "2545660",
    "end": "2552900"
  },
  {
    "text": "that eventually sharepoint accounts even they could be at regular domain users this is something that i personally",
    "start": "2552900",
    "end": "2558540"
  },
  {
    "text": "looking for in the infrastructure to verify if i'm able from this particular",
    "start": "2558540",
    "end": "2563550"
  },
  {
    "text": "account to replicate the data to myself yeah now all these attacks DC sync dis",
    "start": "2563550",
    "end": "2570510"
  },
  {
    "text": "shud this is shadow and so on they also allow allowing us to get this particular key so let's get to see what this key is",
    "start": "2570510",
    "end": "2578850"
  },
  {
    "start": "2578000",
    "end": "2663000"
  },
  {
    "text": "about exported pfx next next and next and here it asks you to provide the",
    "start": "2578850",
    "end": "2584250"
  },
  {
    "text": "password password is secure so our team's name and then we move forward and then if we do have a look here and if we",
    "start": "2584250",
    "end": "2591540"
  },
  {
    "text": "do cert MGR dot MSC we are able to see in personal certificates and this that",
    "start": "2591540",
    "end": "2598260"
  },
  {
    "text": "we've got a certificate that is very useful for someone who is about to",
    "start": "2598260",
    "end": "2605570"
  },
  {
    "text": "recover data from the users profiles but it's kind of funny too because we've got",
    "start": "2605570",
    "end": "2611760"
  },
  {
    "text": "issued to nobody issued to by by nobody it's only valid for a year so if you for",
    "start": "2611760",
    "end": "2618510"
  },
  {
    "text": "example change your domain upgrade or if you do whatever this certificate does",
    "start": "2618510",
    "end": "2623640"
  },
  {
    "text": "not get renewed when you get a Kerberos stick as you can reset them every night but not that certificate and that's a",
    "start": "2623640",
    "end": "2630690"
  },
  {
    "text": "bit of a problem so technically if you had set up your domain in 2003 and even though you did a bunch",
    "start": "2630690",
    "end": "2638529"
  },
  {
    "text": "of upgrades this certificate is dated to down to 2003 and what's kind of funny is",
    "start": "2638529",
    "end": "2644440"
  },
  {
    "text": "that if you have a look at the parameters of that certificate just to be absolutely fair yeah this is this is",
    "start": "2644440",
    "end": "2650680"
  },
  {
    "text": "a 2048-bit ski that is used over there including so on which is kind of sad but",
    "start": "2650680",
    "end": "2656140"
  },
  {
    "text": "that's the reality so you like it or not that's the fact so that's certificate each of you have",
    "start": "2656140",
    "end": "2662829"
  },
  {
    "text": "now that certificate can be used by someone and I would like to show you how in order to get access to the users",
    "start": "2662829",
    "end": "2671170"
  },
  {
    "text": "personal data let's start this process so right now I'm back on the client machine and I'm gonna start up a common",
    "start": "2671170",
    "end": "2678640"
  },
  {
    "text": "prompt as a regular user we don't need any be you we don't need any particular privileges here and in order to be able",
    "start": "2678640",
    "end": "2685210"
  },
  {
    "text": "to learn which master key is actually used for Chrome I'm gonna use one",
    "start": "2685210",
    "end": "2691119"
  },
  {
    "text": "forensic tool that we've written but first let me give you a little bit of a background so that we all are on the",
    "start": "2691119",
    "end": "2697599"
  },
  {
    "text": "same page in the data protection API so master keys are stored for everybody in",
    "start": "2697599",
    "end": "2704499"
  },
  {
    "text": "the same folder they are stored in the Freddie in the users Freddy's folder",
    "start": "2704499",
    "end": "2710890"
  },
  {
    "text": "we've got up data roaming we've got Microsoft and then we've got",
    "start": "2710890",
    "end": "2716349"
  },
  {
    "text": "protect and then we've got Sid and then we've got master keys stored over here",
    "start": "2716349",
    "end": "2721869"
  },
  {
    "text": "now which of those is to use for a chrome I have no idea but we know how to check okay so how do we check for that",
    "start": "2721869",
    "end": "2729700"
  },
  {
    "start": "2727000",
    "end": "2945000"
  },
  {
    "text": "and this is by the way my little favorite tool that we got because it shows you a lot forensically",
    "start": "2729700",
    "end": "2736480"
  },
  {
    "text": "I love it let me show you so here we go we got it like this if we get into the CQ tools we've got a 2 DP API that is",
    "start": "2736480",
    "end": "2746259"
  },
  {
    "text": "called CQ DP API block searcher and CQ DP API block searcher it's just a simple",
    "start": "2746259",
    "end": "2753640"
  },
  {
    "text": "no very useful searcher across the data prediction API blobs so if you ever wondered do I have any secrets in my",
    "start": "2753640",
    "end": "2759999"
  },
  {
    "text": "laptop that I that I don't know about that our DP API that would too will tell you this and you can always",
    "start": "2759999",
    "end": "2765559"
  },
  {
    "text": "maybe delete that yeah so here we go we've got parameters - f - R that I'm",
    "start": "2765559",
    "end": "2772279"
  },
  {
    "text": "gonna - D for folder - R - oh so let's use this yes as simple as it could be so",
    "start": "2772279",
    "end": "2777889"
  },
  {
    "text": "we've got a - D where the chrome data is stored in the users Freddie up data",
    "start": "2777889",
    "end": "2784089"
  },
  {
    "text": "local here we go and then we've got Google and then we got Chrome bang and",
    "start": "2784089",
    "end": "2789919"
  },
  {
    "text": "we've got another one which is our four recursive and then we've got all four",
    "start": "2789919",
    "end": "2795049"
  },
  {
    "text": "output where we specify our secu tools and that's it and I'm gonna string the output into DP txt it's gonna take a",
    "start": "2795049",
    "end": "2802849"
  },
  {
    "text": "couple of seconds and I'm looking in the Google Chrome folder for all the identifiers of the data protection API",
    "start": "2802849",
    "end": "2809389"
  },
  {
    "text": "blobs so that I can get the master key out so that I can decrypt the user secret let's have a look we've got a DP",
    "start": "2809389",
    "end": "2815989"
  },
  {
    "text": "txt it's a little small but let me enlarge it and I already see the key that we are interested in bring it on",
    "start": "2815989",
    "end": "2822709"
  },
  {
    "text": "that's this b55 yeah and we can see that this identifier master key guiit it's",
    "start": "2822709",
    "end": "2829129"
  },
  {
    "text": "actually the one that is used by chrome including using Schwann and Triple DES that's a different story",
    "start": "2829129",
    "end": "2834469"
  },
  {
    "text": "okay let's move forward so we've got b55 nice good to know some let me minimize",
    "start": "2834469",
    "end": "2840709"
  },
  {
    "text": "that and I'm gonna go over here to this folder to search for B 55 and I found it",
    "start": "2840709",
    "end": "2846799"
  },
  {
    "text": "that's this guy so what I'm gonna do I'm gonna work on it shift right click copy as path lovely so let's get into the",
    "start": "2846799",
    "end": "2854779"
  },
  {
    "text": "console first of all what I'm gonna do here is to generate my current password hash and my current password is mimikatz",
    "start": "2854779",
    "end": "2862819"
  },
  {
    "text": "and my current password hash will be used to encrypt back master key so that",
    "start": "2862819",
    "end": "2869179"
  },
  {
    "text": "I can use it life alright we're going to decrypt it with the pfx and encrypted back with our current password hash",
    "start": "2869179",
    "end": "2875779"
  },
  {
    "text": "simple operation so let's do that we're gonna be using for that secure another",
    "start": "2875779",
    "end": "2881059"
  },
  {
    "text": "tool master key ID absolutely nice tool that allows us to specify a master key",
    "start": "2881059",
    "end": "2887509"
  },
  {
    "text": "that we are working on pfx that we've got from the domain and then new hash",
    "start": "2887509",
    "end": "2893619"
  },
  {
    "text": "that we are actually getting from the simple calculation over here let's get",
    "start": "2893619",
    "end": "2899039"
  },
  {
    "text": "that here we go enter and then we've got over here created a new key ad modified this one",
    "start": "2899039",
    "end": "2907980"
  },
  {
    "text": "ad modified is encrypted with our current password hash so this guy we can name good because eventually we did not",
    "start": "2907980",
    "end": "2915150"
  },
  {
    "text": "have access to it but this one we should have access to it because we have decrypted it with the pfx and encrypt it",
    "start": "2915150",
    "end": "2922230"
  },
  {
    "text": "with the current password hash there's one more thing guys that I have to do I have to use the a trip command to",
    "start": "2922230",
    "end": "2929339"
  },
  {
    "text": "actually set it to system and hidden bank and eventually what we're getting",
    "start": "2929339",
    "end": "2934529"
  },
  {
    "text": "over here f5 it's the password of the user so thank you thank you",
    "start": "2934529",
    "end": "2943250"
  },
  {
    "start": "2945000",
    "end": "3140000"
  },
  {
    "text": "thanks a lot so basically this is something that you can do 200,000",
    "start": "2945470",
    "end": "2950789"
  },
  {
    "text": "peoples that might be working for you because there's only one key that everything relies on and can you tell",
    "start": "2950789",
    "end": "2957000"
  },
  {
    "text": "that your users in the company are not storing passwords in a browser and if you say no then there is still old book",
    "start": "2957000",
    "end": "2962760"
  },
  {
    "text": "there is still private key there's still applications so all the different types of secret that we got like this now",
    "start": "2962760",
    "end": "2968630"
  },
  {
    "text": "cherry on the top is if you've got any type of other type of data like this",
    "start": "2968630",
    "end": "2974970"
  },
  {
    "text": "like for example it could be a coupie things like key pass and so on what I",
    "start": "2974970",
    "end": "2980640"
  },
  {
    "text": "would like to show you is that eventually you are able to pull any type",
    "start": "2980640",
    "end": "2985799"
  },
  {
    "text": "of application and if it uses data protection API as well you are able to get access to these types of Secrets too",
    "start": "2985799",
    "end": "2992700"
  },
  {
    "text": "so once we've got this reversed then you are able to move forward and eventually",
    "start": "2992700",
    "end": "2999289"
  },
  {
    "text": "decrypt that type of data so please have a look what I'm gonna do here so here",
    "start": "2999289",
    "end": "3005480"
  },
  {
    "text": "I've got the following situation I've got to keep us we can just close it they keep us from here here we go let's do it",
    "start": "3005480",
    "end": "3011990"
  },
  {
    "text": "and I got the following keep us here yeah so this is basically what we're gonna be getting to I'm gonna delete",
    "start": "3011990",
    "end": "3017450"
  },
  {
    "text": "this file so we've got a C Q base and this is the file that if I do type a",
    "start": "3017450",
    "end": "3023210"
  },
  {
    "text": "secure over here which is the password that we are using and I do ok this",
    "start": "3023210",
    "end": "3028320"
  },
  {
    "text": "password doesn't work right so funny part we would like to get access to the key bus so what do we do when we were",
    "start": "3028320",
    "end": "3035400"
  },
  {
    "text": "decrypting this master key of the user we are also able with our toolkit to put",
    "start": "3035400",
    "end": "3041040"
  },
  {
    "text": "it in a clear text eventually it has to be in a clear text to be encrypted the back of our password hush so what I'm",
    "start": "3041040",
    "end": "3047040"
  },
  {
    "text": "doing over here have a look I'm actually using the entropy of the key bus which",
    "start": "3047040",
    "end": "3052320"
  },
  {
    "text": "is the same for wall to keep us then I'm using blob that I'm gonna be working on so this is for the keep us protected",
    "start": "3052320",
    "end": "3058590"
  },
  {
    "text": "user key bin so it's a file that is actually protecting the key past database and then I'm using the master",
    "start": "3058590",
    "end": "3064770"
  },
  {
    "text": "key which you can extract as we mentioned from basically our toolkit so",
    "start": "3064770",
    "end": "3071250"
  },
  {
    "text": "that this is this master key that we've been talking about so master key one for example so once we got that we are able",
    "start": "3071250",
    "end": "3078000"
  },
  {
    "text": "to get the key over here that is purely used to decrypt the key past database",
    "start": "3078000",
    "end": "3083490"
  },
  {
    "text": "have a look guys that's going to be super quick demonstration our toolkit over here which has a lovely name of a seek UDP",
    "start": "3083490",
    "end": "3090420"
  },
  {
    "text": "API key pass davidic Ripper so is it you remember it has two values K and F let's",
    "start": "3090420",
    "end": "3098220"
  },
  {
    "text": "clear it out and let's use it so we're gonna be using K and that's this key",
    "start": "3098220",
    "end": "3103290"
  },
  {
    "text": "that I have decrypted and we're going to be using f4 see analysis CQ base that we",
    "start": "3103290",
    "end": "3109230"
  },
  {
    "text": "could not get access to enter what it says successfully savory encrypted file",
    "start": "3109230",
    "end": "3114600"
  },
  {
    "text": "to that CQ base and let's have a look so that's basically this file here and I'm",
    "start": "3114600",
    "end": "3119670"
  },
  {
    "text": "gonna open it up double click let's just close this keeper that we got there we",
    "start": "3119670",
    "end": "3125550"
  },
  {
    "text": "go and then this guy comes a place we are this stung specifically is specifying the password secure because",
    "start": "3125550",
    "end": "3132000"
  },
  {
    "text": "by Rhian crypting it we are able to do that and then ok and this is how you",
    "start": "3132000",
    "end": "3137130"
  },
  {
    "text": "managed to get access to the key path database so so that's what you got when",
    "start": "3137130",
    "end": "3142560"
  },
  {
    "start": "3140000",
    "end": "3251000"
  },
  {
    "text": "you are able to reverse data protection API and within our team we're providing",
    "start": "3142560",
    "end": "3148080"
  },
  {
    "text": "full toolkit to decrypt data the data protection API secrets that you guys",
    "start": "3148080",
    "end": "3155670"
  },
  {
    "text": "might find during your forensic investigation that's what I mean by bringing friends and investigation to the next level",
    "start": "3155670",
    "end": "3162290"
  },
  {
    "text": "you're working with the data blobs that you can identify as a DP API secrets and",
    "start": "3162290",
    "end": "3167570"
  },
  {
    "text": "then what's next and this is exactly what we are referring to so this is a toolkit that is related to the DP API",
    "start": "3167570",
    "end": "3174110"
  },
  {
    "text": "major token there is much much more than that and this is also part of our forensic tool kits that you guys may",
    "start": "3174110",
    "end": "3181220"
  },
  {
    "text": "want to have a look at so as you see and let's get into the summary we were able",
    "start": "3181220",
    "end": "3187280"
  },
  {
    "text": "to decrypt different types of data by leveraging our toolkits hopefully you",
    "start": "3187280",
    "end": "3193220"
  },
  {
    "text": "guys maybe it will be able to download it we are sharing all the tools and knowledge for free so we've got a C Q",
    "start": "3193220",
    "end": "3199580"
  },
  {
    "text": "dot r e forensic tool kit so make sure that you will not miss out after the",
    "start": "3199580",
    "end": "3205280"
  },
  {
    "text": "black hat and at the end of course I would like to invite you to our team squeeze our team is absolutely loving to",
    "start": "3205280",
    "end": "3213950"
  },
  {
    "text": "know more and if you want to know more there's no registration over here this is the quiz when you learn so you answer",
    "start": "3213950",
    "end": "3220400"
  },
  {
    "text": "questions and if you answer it wrongly we tell you immediately what's wrong this is a cybersecurity quiz our 4.0",
    "start": "3220400",
    "end": "3226430"
  },
  {
    "text": "release that we release pretty much every year for everybody that like cybersecurity if you want to have more",
    "start": "3226430",
    "end": "3233420"
  },
  {
    "text": "information of course at the end we've got our block and this is a secure",
    "start": "3233420",
    "end": "3241070"
  },
  {
    "text": "academy.com which you can see on the right side where we also share the tools and this presentation thank you so much",
    "start": "3241070",
    "end": "3247730"
  },
  {
    "text": "for coming I hope it was useful for you",
    "start": "3247730",
    "end": "3251830"
  }
]