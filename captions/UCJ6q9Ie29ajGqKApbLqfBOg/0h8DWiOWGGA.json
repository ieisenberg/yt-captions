[
  {
    "text": "good afternoon everybody uh welcome to poning your Java messaging with deserialization vulnerabilities in",
    "start": "120",
    "end": "6799"
  },
  {
    "text": "Mandalay BCD with Matias Kaiser before we get started I have a few brief",
    "start": "6799",
    "end": "13440"
  },
  {
    "text": "announcements uh you are invited to stop by the business Hall located in Bayside AB during the day and for the welcome",
    "start": "13440",
    "end": "20560"
  },
  {
    "text": "reception from 1730 to 1900 tonight uh blackhe hat Arsenal is on in the Palm",
    "start": "20560",
    "end": "27880"
  },
  {
    "text": "foyer on level three and join us for the pony Awards in this room Mandalay Bay",
    "start": "27880",
    "end": "34840"
  },
  {
    "text": "BCD at 18:30 uh please put your phone on vibrate now it makes it much easier for",
    "start": "34840",
    "end": "42440"
  },
  {
    "text": "the rest of us to ignore the ringing while you wait for it to go to voicemail and at the end of the",
    "start": "42440",
    "end": "48480"
  },
  {
    "text": "presentation there will be time for questions please come up to one of the microphones in the aisles to ask your",
    "start": "48480",
    "end": "53800"
  },
  {
    "text": "question so that we can capture it for the video thank you very much Matias",
    "start": "53800",
    "end": "59000"
  },
  {
    "text": "Kaiser thanks a lot",
    "start": "59000",
    "end": "66280"
  },
  {
    "text": "thanks I also would like to welcome you to my talk ping your Java messaging with dation",
    "start": "66520",
    "end": "72240"
  },
  {
    "text": "vulnerabilities before we start I would like to take the chance to introduce myself a little bit more um I'm Matias",
    "start": "72240",
    "end": "79040"
  },
  {
    "text": "Kaiser I'm currently the head of vulnerability research at code white in own we are small security startup we are",
    "start": "79040",
    "end": "85320"
  },
  {
    "text": "doing a lot of red team pen testing long-term engagements with our Blue Chip",
    "start": "85320",
    "end": "90400"
  },
  {
    "text": "customers and we are based in om which is between Munich and stutgart so",
    "start": "90400",
    "end": "95759"
  },
  {
    "text": "whenever you want to go to the October Fest just let us know and come by um I used to work as a software architect in",
    "start": "95759",
    "end": "103479"
  },
  {
    "text": "the past and also software developer mainly in the Java world for a company called airus or Aus military and since",
    "start": "103479",
    "end": "112119"
  },
  {
    "text": "seven years I'm joining the technical security stuff and offensive security um since of my past somehow specialized in",
    "start": "112119",
    "end": "118719"
  },
  {
    "text": "Java security I found a lot of bugs in Enterprise products of Oracle IBM BM the sap",
    "start": "118719",
    "end": "126200"
  },
  {
    "text": "redhead and so on but all most of them are serers side or locals but recently I'm looking more",
    "start": "126200",
    "end": "132920"
  },
  {
    "text": "into the windows world and also client side stuff so it's a different field uh",
    "start": "132920",
    "end": "138680"
  },
  {
    "text": "if you're interested in Java dation at all follow me on Twitter my Nick is maore Kaiser sometimes I drop drop some",
    "start": "138680",
    "end": "146959"
  },
  {
    "text": "zero days but not that often so and now it's time to show you the",
    "start": "146959",
    "end": "152920"
  },
  {
    "text": "agenda for today so I will start with a short motivation why I did this research and why I'm presenting this year then I",
    "start": "152920",
    "end": "159720"
  },
  {
    "text": "want to give you a short introduction what the Java object serialization protocol is Then I then we will go into",
    "start": "159720",
    "end": "166000"
  },
  {
    "text": "what the Java message service service is the most interesting part will be how we",
    "start": "166000",
    "end": "171239"
  },
  {
    "text": "can attack the Java message service I also will introduce to you a tool which",
    "start": "171239",
    "end": "176959"
  },
  {
    "text": "is called jamat and since I'm not a big fan of of showing tools on slides I also",
    "start": "176959",
    "end": "182159"
  },
  {
    "text": "have a demo for you a real life demo and we will end the session with a",
    "start": "182159",
    "end": "189159"
  },
  {
    "text": "conclusion also with questions and answers okay so let's get",
    "start": "189159",
    "end": "194239"
  },
  {
    "text": "started the motivation behind this research is that I spent about let's say",
    "start": "194239",
    "end": "199599"
  },
  {
    "text": "one year into looking into server side products especially for Java dation",
    "start": "199599",
    "end": "205159"
  },
  {
    "text": "vulnerabilities and as from the time when I Was An Architect already knew okay there are a lot of core",
    "start": "205159",
    "end": "211120"
  },
  {
    "text": "Technologies in the Java World which make heavy use of Java's object calization for example the ancient",
    "start": "211120",
    "end": "217239"
  },
  {
    "text": "remote method invocation RMI it's using serialization very heavily and of on on",
    "start": "217239",
    "end": "224400"
  },
  {
    "text": "and on all sorry and on top of the RMI RMI you can find jmx which is the Java",
    "start": "224400",
    "end": "231319"
  },
  {
    "text": "management extension um it's use it's using RMI and there's another core technology",
    "start": "231319",
    "end": "239120"
  },
  {
    "text": "which is the message service which is also using Java",
    "start": "239120",
    "end": "244360"
  },
  {
    "text": "calization I haven't found that many research in the past so there was very",
    "start": "244360",
    "end": "249920"
  },
  {
    "text": "good research from GF s KRA of Mega foundstone in 2014 a pentester guy to",
    "start": "249920",
    "end": "256479"
  },
  {
    "text": "hacking active in Q based applications or JMS applications uh he also released a tool which is called JMS Digger just",
    "start": "256479",
    "end": "263639"
  },
  {
    "text": "as a side note whenever you already using this tool you might think about to update some libraries after my talk um",
    "start": "263639",
    "end": "270800"
  },
  {
    "text": "there's another very good presentation from uh Gori gashev of MWR info security",
    "start": "270800",
    "end": "276680"
  },
  {
    "text": "your Q is my queue it's more about the overall security posture of queuing",
    "start": "276680",
    "end": "282039"
  },
  {
    "text": "products and it's I can only recommend to look at that I haven't found any research",
    "start": "282039",
    "end": "288280"
  },
  {
    "text": "regarding how you can attack jmss based applications using dcz and that's the",
    "start": "288280",
    "end": "295039"
  },
  {
    "text": "reason why I'm here and also to present it so I have a some disclaimers for you",
    "start": "295039",
    "end": "301199"
  },
  {
    "text": "first of all this talk continues on my research uh on Java dation",
    "start": "301199",
    "end": "307160"
  },
  {
    "text": "vulnerabilities um I have already given two talks about this topic in several at",
    "start": "307160",
    "end": "312960"
  },
  {
    "text": "other conferences so I won't cover all the technical details about how you can find Java dation vulnerabilities and how",
    "start": "312960",
    "end": "320479"
  },
  {
    "text": "you can exploit them using gadgets I just will give you a short introduction into the topic if you're more interested",
    "start": "320479",
    "end": "326520"
  },
  {
    "text": "in that topic you there are very good presentations first of all we have one from Chris rof one of the key person in",
    "start": "326520",
    "end": "333440"
  },
  {
    "text": "the whole Java dation thing he presented the presentation at over San Diego 2016",
    "start": "333440",
    "end": "339080"
  },
  {
    "text": "so this year it's these realiz my shorts there's another one from uh Alvaro Muno",
    "start": "339080",
    "end": "345680"
  },
  {
    "text": "and Christen Schneider they presented a RSA serial killer great presentation and",
    "start": "345680",
    "end": "350960"
  },
  {
    "text": "as I said I have already given who I have already given uh two presentations",
    "start": "350960",
    "end": "356479"
  },
  {
    "text": "one at infiltrate and another one at the German conference which is called RC uh",
    "start": "356479",
    "end": "361840"
  },
  {
    "text": "about Java dation overall okay so",
    "start": "361840",
    "end": "368440"
  },
  {
    "text": "let's look at the short introduction on Java's object serialization so first of",
    "start": "368440",
    "end": "373919"
  },
  {
    "text": "all just want to clarify the word serialization dualization so when whenever I'm talking about this I mean",
    "start": "373919",
    "end": "380440"
  },
  {
    "text": "whenever you have an object in the jvm and you want to represent it as a stream of ites using a specific protocol which",
    "start": "380440",
    "end": "387400"
  },
  {
    "text": "is the object serialization protocol I'm talking about serialization and then you can take the bytes and sort for example",
    "start": "387400",
    "end": "393120"
  },
  {
    "text": "in a file or in a database or send it over Network and later on if you deserialize it you just take the stream",
    "start": "393120",
    "end": "399000"
  },
  {
    "text": "of bites and reconstruct the same object again using the object serialization protocol that's serialization and dation",
    "start": "399000",
    "end": "406479"
  },
  {
    "text": "for me and just to give you a short summary what the big problem with Java's",
    "start": "406479",
    "end": "412199"
  },
  {
    "text": "calization is first of all Java provides a serialization API so every class which",
    "start": "412199",
    "end": "418400"
  },
  {
    "text": "wants to get serialized and D serialized needs to implement the Java iio serializable interface it's a taging",
    "start": "418400",
    "end": "424919"
  },
  {
    "text": "interface it doesn't Define any method it's just for taging and whenever you want to write a",
    "start": "424919",
    "end": "432120"
  },
  {
    "text": "serialized object or serialize an object then you invoke the method right object",
    "start": "432120",
    "end": "437319"
  },
  {
    "text": "on the object input stream object output stream class and the bites will go into",
    "start": "437319",
    "end": "442720"
  },
  {
    "text": "an output stream whenever you want to read and serialized object you use any of the",
    "start": "442720",
    "end": "449440"
  },
  {
    "text": "those hundreds input streams as the sers for a object input",
    "start": "449440",
    "end": "454919"
  },
  {
    "text": "stream. readobject call and read object will just return a serializable object",
    "start": "454919",
    "end": "461520"
  },
  {
    "text": "which is read from the input stream and reconstruct reconstruct using Java's object serialization",
    "start": "461520",
    "end": "467479"
  },
  {
    "text": "protocol um the serialization protocol is a binary protocol if you're",
    "start": "467479",
    "end": "472599"
  },
  {
    "text": "interested more you can go to the Oracle web page and there's a very nice",
    "start": "472599",
    "end": "478560"
  },
  {
    "text": "specification there and also a grammar for example if you want to implement a par for that you can use the grammar",
    "start": "478560",
    "end": "484280"
  },
  {
    "text": "from there at this serialization vulnerability happens when we are taking",
    "start": "484280",
    "end": "493159"
  },
  {
    "text": "untrusted input and use it as a input for a object input stream. read object",
    "start": "493159",
    "end": "499360"
  },
  {
    "text": "call so whenever we take bites from untrusted and these realize it that's a",
    "start": "499360",
    "end": "504879"
  },
  {
    "text": "dation vulnerability not more not less for exploiting realization V",
    "start": "504879",
    "end": "510240"
  },
  {
    "text": "vulnerabilities we need to use existing classes which are in the class path of",
    "start": "510240",
    "end": "515599"
  },
  {
    "text": "the target application and we need to find serializable classes that allow us for",
    "start": "515599",
    "end": "522680"
  },
  {
    "text": "example to abuse them and to trigger something like writing files Dynamic",
    "start": "522680",
    "end": "528040"
  },
  {
    "text": "method calls or loading libraries or stuff like that during the process of these uh these",
    "start": "528040",
    "end": "534440"
  },
  {
    "text": "realization such classes exist all the research called all the re",
    "start": "534440",
    "end": "539800"
  },
  {
    "text": "researchers call them gadgets and currently we have about 15 Gadgets in very common libraries and also even in",
    "start": "539800",
    "end": "546680"
  },
  {
    "text": "the jav runtime environment exploiting these realization vulnerabilities can sometimes be as easy",
    "start": "546680",
    "end": "554640"
  },
  {
    "text": "as this we have a HTTP post request here",
    "start": "554640",
    "end": "559680"
  },
  {
    "text": "and we're just sending the post request to the Target server which is by the way Oracle Hyperion AI product of",
    "start": "559680",
    "end": "567040"
  },
  {
    "text": "Oracle and we just use a common collection Gadget here and you might see",
    "start": "567040",
    "end": "572800"
  },
  {
    "text": "it there's a c. exe in there and whenever this gets serialized on the",
    "start": "572800",
    "end": "578160"
  },
  {
    "text": "server site cl.exe pops up in order to make the exploitation of",
    "start": "578160",
    "end": "585160"
  },
  {
    "text": "dation vulnerability easy Chris frof created a great tool which is called",
    "start": "585160",
    "end": "590519"
  },
  {
    "text": "wiso serial you might already know that um it's open source it's hosted on GitHub it serves as a public repository",
    "start": "590519",
    "end": "598720"
  },
  {
    "text": "for all known gadgets and currently we have about or Chris has about 15 gadgets",
    "start": "598720",
    "end": "604880"
  },
  {
    "text": "for example for the famous Apache Commons collections Apache common Bean utils groovy run Java runtime",
    "start": "604880",
    "end": "611800"
  },
  {
    "text": "environment gadgets Bean shell CH from hibernate spring and so on so all the common libraries which you can find on",
    "start": "611800",
    "end": "617959"
  },
  {
    "text": "the server site in the big application servers or in the applications which are",
    "start": "617959",
    "end": "623560"
  },
  {
    "text": "running on application servers in order to use WI material you",
    "start": "623560",
    "end": "629839"
  },
  {
    "text": "just need to run it on the command line you specify as a first parameter the",
    "start": "629839",
    "end": "635839"
  },
  {
    "text": "gadget you want to create the calized object stream for and the command you want to which you want to invoke is the",
    "start": "635839",
    "end": "642120"
  },
  {
    "text": "second parameter and that's it and I've used the hex stum here whenever you see",
    "start": "642120",
    "end": "648800"
  },
  {
    "text": "ACD um you already you you know that it is a serialized object stream okay that was a very short",
    "start": "648800",
    "end": "656440"
  },
  {
    "text": "introduction into the Java dation problem and how you can exploit it uh as",
    "start": "656440",
    "end": "662720"
  },
  {
    "text": "I said if you're interested look at the presentations I mentioned in the very beginning it's worth to",
    "start": "662720",
    "end": "668120"
  },
  {
    "text": "read okay now we will talk about the Java message service the Java message is",
    "start": "668120",
    "end": "675079"
  },
  {
    "text": "one of the core Technologies in the Java world as Oracle or sun writes there the",
    "start": "675079",
    "end": "680800"
  },
  {
    "text": "JMS API is an API for accessing Enterprise messaging systems from java",
    "start": "680800",
    "end": "687240"
  },
  {
    "text": "programs the first version which was adopted by Wenders was version 1.1 it",
    "start": "687240",
    "end": "692880"
  },
  {
    "text": "was released in 2002 the newest version version which is released is the version",
    "start": "692880",
    "end": "699440"
  },
  {
    "text": "2.0 and yeah if you're interested go on the Oracle web page and about 100",
    "start": "699440",
    "end": "707360"
  },
  {
    "text": "Pages just some details about jmss JMS is just an Enterprise messaging",
    "start": "707360",
    "end": "714360"
  },
  {
    "text": "technology some of us call this some of us call it message oriented middle",
    "start": "714360",
    "end": "720079"
  },
  {
    "text": "it's included in the Java platform Enterprise Edition since version 1.4",
    "start": "720079",
    "end": "725399"
  },
  {
    "text": "which is from 2003 I think so and the latest version of java e which is",
    "start": "725399",
    "end": "731959"
  },
  {
    "text": "version 7 includes JMS 2.0 jmss def defines an API for sending",
    "start": "731959",
    "end": "739839"
  },
  {
    "text": "and receiving messages it does not define how the messages are sent and received over the",
    "start": "739839",
    "end": "747839"
  },
  {
    "text": "Via over the network work it's just an API you can use it for programming and what is happening on the wire you do not",
    "start": "747839",
    "end": "755480"
  },
  {
    "text": "need to care there's as with all JMS core",
    "start": "755480",
    "end": "761839"
  },
  {
    "text": "Technologies there's a reference implementation which is called Oracle open mq it's supporting JMS 1.1 and also",
    "start": "761839",
    "end": "769160"
  },
  {
    "text": "JMS 2.0 and just to give you a short impression where Jam is is supported so",
    "start": "769160",
    "end": "777320"
  },
  {
    "text": "first of all we have the message broker which are let's say the data Hub or message Hub of of jmss and we have very",
    "start": "777320",
    "end": "785120"
  },
  {
    "text": "wellknown products like I web mq we have a a appliance from IBM which is called IBM message s we have Oracle open mq we",
    "start": "785120",
    "end": "792440"
  },
  {
    "text": "have py wles SL um wew rabbit mq we have a German company which is I software",
    "start": "792440",
    "end": "799279"
  },
  {
    "text": "Swift mq We have redhead Hornet Q we have apachi active in Q we have aache",
    "start": "799279",
    "end": "804360"
  },
  {
    "text": "Cupid and so on there are sever several other message Brokers out there",
    "start": "804360",
    "end": "810000"
  },
  {
    "text": "we have J2 application servers because as I said je application servers",
    "start": "810000",
    "end": "816160"
  },
  {
    "text": "implement the J standard or specification and JMS is included since",
    "start": "816160",
    "end": "821399"
  },
  {
    "text": "version 1.4 they all need to implement jmss so IBM apps is supporting it oracal",
    "start": "821399",
    "end": "828199"
  },
  {
    "text": "vert logic is supporting it or glassf is supporting redhead Jos is supporting sap at WEA a CH is supporting it pach",
    "start": "828199",
    "end": "835800"
  },
  {
    "text": "Geronimo and also Pachi and we have integration platforms uh",
    "start": "835800",
    "end": "843279"
  },
  {
    "text": "Architects usually call them esbs I call them integration platforms and those",
    "start": "843279",
    "end": "849079"
  },
  {
    "text": "products are usually built on top of je application servers and they're very",
    "start": "849079",
    "end": "854320"
  },
  {
    "text": "well know products like IBM integration bus IBM Ms ESB Oracle service bus red",
    "start": "854320",
    "end": "859519"
  },
  {
    "text": "Jos fuse and ESB moft mule es which is a cloud es Apache service mix and a Apache",
    "start": "859519",
    "end": "867959"
  },
  {
    "text": "camel so all of them are supporting JMS you can send and receive message messages using those",
    "start": "867959",
    "end": "875199"
  },
  {
    "text": "products and just to give you an impression where the software is used so as I said COD is doing a lot of red",
    "start": "875199",
    "end": "881519"
  },
  {
    "text": "teaming and what I've seen in our at our client environments is that especially",
    "start": "881519",
    "end": "887199"
  },
  {
    "text": "in the in Banks insurance companies Telco companies and also in military",
    "start": "887199",
    "end": "894040"
  },
  {
    "text": "environments JMS is used from from AR ure's point of view",
    "start": "894040",
    "end": "899880"
  },
  {
    "text": "JMS is very simple in the middle you have the JMS broker and you have JMS",
    "start": "899880",
    "end": "905720"
  },
  {
    "text": "clients can be one can be 100 can be thousands of jmss clients all jmss clients create a",
    "start": "905720",
    "end": "913480"
  },
  {
    "text": "connection to the broker they initiate the",
    "start": "913480",
    "end": "918800"
  },
  {
    "text": "connection the J broker is just a standard load server it provides all its",
    "start": "921040",
    "end": "927199"
  },
  {
    "text": "JMS clients with connectivity and message storage and delivery it can be implemented in any language can be",
    "start": "927199",
    "end": "934480"
  },
  {
    "text": "Java can be elong can be C++ and it just maintains destinations",
    "start": "934480",
    "end": "940880"
  },
  {
    "text": "which are cues and topics JMS clients are just Java applications they can run",
    "start": "940880",
    "end": "947040"
  },
  {
    "text": "on the server side or on the Cent on the client side they can have two roles they",
    "start": "947040",
    "end": "952440"
  },
  {
    "text": "can be a producer which sends messages and they can be a consumer which just",
    "start": "952440",
    "end": "957720"
  },
  {
    "text": "receive messages and a Java program can also have both rows it can send and receive messages",
    "start": "957720",
    "end": "964560"
  },
  {
    "text": "and they all have a connection to the broker using a specific protocol which",
    "start": "964560",
    "end": "970880"
  },
  {
    "text": "we will see later and to support transaction management something like uh",
    "start": "970880",
    "end": "976920"
  },
  {
    "text": "XA transactions uh JMS also supports the concept of",
    "start": "976920",
    "end": "982959"
  },
  {
    "text": "sessions a message broker hosts destinations we have two types the first",
    "start": "984399",
    "end": "991519"
  },
  {
    "text": "one is the jmss Q which is a one 12 one communication",
    "start": "991519",
    "end": "997040"
  },
  {
    "text": "model so a pro producer which could be a Jaa program or serde program just sends",
    "start": "997040",
    "end": "1002720"
  },
  {
    "text": "a message to a specific q and this message will be distributed to one",
    "start": "1002720",
    "end": "1008800"
  },
  {
    "text": "consumer so it's only a point to-point communication model the other one is the JMS topic",
    "start": "1008800",
    "end": "1016399"
  },
  {
    "text": "where a publisher sends one message to a broker and the broker delivers all the",
    "start": "1016399",
    "end": "1023759"
  },
  {
    "text": "messages to its subscribers so can be 100 Java programs 100 web systems or",
    "start": "1023759",
    "end": "1032240"
  },
  {
    "text": "whatever as I have already mentioned in the very beginning JMS does not define which wire protocols need to be",
    "start": "1032240",
    "end": "1039438"
  },
  {
    "text": "used the wire protocol is just the protocol on the binary level which is",
    "start": "1039439",
    "end": "1044600"
  },
  {
    "text": "used for sending and receiving and in the past most of the JMS Brokers had their own implementation",
    "start": "1044600",
    "end": "1052160"
  },
  {
    "text": "of a protocol and since several years very well-known standard exists for example the amqp advanced message queing",
    "start": "1052160",
    "end": "1058880"
  },
  {
    "text": "protocol which I think was initiated by JP JP Morgan um the mqtt mq Telemetry",
    "start": "1058880",
    "end": "1067160"
  },
  {
    "text": "transport which is used in the field of iot very often there's one which is called stomp streaming text oriented",
    "start": "1067160",
    "end": "1074080"
  },
  {
    "text": "message protocol which you can also use for example using websockets and and the browser",
    "start": "1074080",
    "end": "1079240"
  },
  {
    "text": "and open wire and web sockets and to give you an impression which products",
    "start": "1079240",
    "end": "1084760"
  },
  {
    "text": "are supporting which protocol um most of them have their window specific protocol",
    "start": "1084760",
    "end": "1091120"
  },
  {
    "text": "and the newer ones or let's say the bigger ones also support amqp some of them support open wi open",
    "start": "1091120",
    "end": "1098840"
  },
  {
    "text": "wire some of them support mqtt and most of them support Stomp and",
    "start": "1098840",
    "end": "1104240"
  },
  {
    "text": "also web sockets I marked some cells thread they very interesting because for us",
    "start": "1104240",
    "end": "1111720"
  },
  {
    "text": "because those protocols for the specific product can be used for sending and",
    "start": "1111720",
    "end": "1117120"
  },
  {
    "text": "receiving messages using jmss and that's the way I want to exploit Target",
    "start": "1117120",
    "end": "1122840"
  },
  {
    "text": "system from a programmer's point of view JMS is very simple you need a couple of",
    "start": "1122840",
    "end": "1129559"
  },
  {
    "text": "Co lines of codes first of all you need a connection Factory this class is always Windows specific so and the class",
    "start": "1129559",
    "end": "1136320"
  },
  {
    "text": "name is also Windows specific so in this case I used active mq connection Factory which is from Apache active mq and the",
    "start": "1136320",
    "end": "1144000"
  },
  {
    "text": "connection Factory usually hides all the connection and protocol details and yeah",
    "start": "1144000",
    "end": "1151880"
  },
  {
    "text": "IP address and host name important and stuff like that when we have a factory a",
    "start": "1151880",
    "end": "1156960"
  },
  {
    "text": "connection Factory we can create a connection by calling the create connection method you can either use it",
    "start": "1156960",
    "end": "1163159"
  },
  {
    "text": "without password and username or you can use it with it's up to you it depends on the configuration of the broker",
    "start": "1163159",
    "end": "1169919"
  },
  {
    "text": "afterwards when we have a connection we can create a session and we can have transacted session and non-trans session",
    "start": "1169919",
    "end": "1176520"
  },
  {
    "text": "in this case I used a non-trans acted session U so I used false and all the",
    "start": "1176520",
    "end": "1181679"
  },
  {
    "text": "messages will be Auto acknowledged when we have a session we can get a let's say handle to a que",
    "start": "1181679",
    "end": "1189720"
  },
  {
    "text": "which exists on the broker by using the create Q method on the session and in",
    "start": "1189720",
    "end": "1195600"
  },
  {
    "text": "order to send a message to a queue we need to create an instance instance of a",
    "start": "1195600",
    "end": "1200640"
  },
  {
    "text": "message producer by calling the create producer method on the session and pass the que as a parameter then weart the",
    "start": "1200640",
    "end": "1207919"
  },
  {
    "text": "connection and then we create one of the messages which we want to send in this",
    "start": "1207919",
    "end": "1213039"
  },
  {
    "text": "case I use the text message and I just put a text this is the payload into the message and send it using the producer",
    "start": "1213039",
    "end": "1220039"
  },
  {
    "text": "and then close the connection very simple a few lines of",
    "start": "1220039",
    "end": "1225320"
  },
  {
    "text": "code receiving message is almost the same in the very beginning we need to",
    "start": "1225320",
    "end": "1230960"
  },
  {
    "text": "create again a connection to the broker using the factory and the create connection method and we also need to",
    "start": "1230960",
    "end": "1238840"
  },
  {
    "text": "create a queue and instead of creating a message producer producer we need to create a message",
    "start": "1238840",
    "end": "1244320"
  },
  {
    "text": "consumer in order to receive messages then we invoke the receive method on the",
    "start": "1244320",
    "end": "1251400"
  },
  {
    "text": "consumer and this method will block until the message is received and then we can work on the message and for",
    "start": "1251400",
    "end": "1257000"
  },
  {
    "text": "example check which type it is is and do what we want with it there's another way of uh receiving",
    "start": "1257000",
    "end": "1264000"
  },
  {
    "text": "messages which I call the HP style um",
    "start": "1264000",
    "end": "1269840"
  },
  {
    "text": "umbs are serers side components defined in the je specification specifically in the",
    "start": "1269840",
    "end": "1276640"
  },
  {
    "text": "Enterprise Java Bean specification there are three of them session beans entity entity beans and message riff beans and",
    "start": "1276640",
    "end": "1283440"
  },
  {
    "text": "this piece of code is running inside a je application server like web logic or web here and what I've created here is a",
    "start": "1283440",
    "end": "1292559"
  },
  {
    "text": "message driven Bean which implements the message L message listening interface and this interface just defines one",
    "start": "1292559",
    "end": "1299039"
  },
  {
    "text": "method which is the on message this piece of code is listening for a specific queue which is called cwq and",
    "start": "1299039",
    "end": "1306520"
  },
  {
    "text": "is of type Q and whenever a message is sent to this queue the application",
    "start": "1306520",
    "end": "1313400"
  },
  {
    "text": "server will invoke the on message method on this me message driven Bean",
    "start": "1313400",
    "end": "1320039"
  },
  {
    "text": "JMS messages are pretty simple they only have a header properties and a body the",
    "start": "1320840",
    "end": "1329159"
  },
  {
    "text": "headers are defined in the JMS specification if you're interested look at the class Java X JMS message there",
    "start": "1329159",
    "end": "1335559"
  },
  {
    "text": "are a lot of Getters and Setters and they are used for getting and setting the uh the headers for example",
    "start": "1335559",
    "end": "1341000"
  },
  {
    "text": "destination delivery mode return address and stuff like that application programmers can also",
    "start": "1341000",
    "end": "1347039"
  },
  {
    "text": "use or store properties inside a message it's just a set of key value pairs of",
    "start": "1347039",
    "end": "1353159"
  },
  {
    "text": "primitive types and the most interesting thing about the",
    "start": "1353159",
    "end": "1358720"
  },
  {
    "text": "message is the application data which is in the body jmss currently defines five message",
    "start": "1358720",
    "end": "1366279"
  },
  {
    "text": "types we have a bytes message we have a text message we have a map message we have a stream message and we have a",
    "start": "1366279",
    "end": "1373080"
  },
  {
    "text": "object message which sounds very great and I just took took the",
    "start": "1373080",
    "end": "1379279"
  },
  {
    "text": "definition from the JMS 1.1 specification so stream message is a message where the body just contains a",
    "start": "1379279",
    "end": "1386480"
  },
  {
    "text": "stream of java primitive values in a sequential order a map message is just a",
    "start": "1386480",
    "end": "1392799"
  },
  {
    "text": "message which contains a set of primitive so a set of key value Pairs",
    "start": "1392799",
    "end": "1397960"
  },
  {
    "text": "and all of them are of primitive types a text message just contains a string a",
    "start": "1397960",
    "end": "1403640"
  },
  {
    "text": "bytes message just contains an array of bytes and the object message contains a",
    "start": "1403640",
    "end": "1412159"
  },
  {
    "text": "serializable object so whenever you read Ser realizable in a specification of",
    "start": "1412159",
    "end": "1418559"
  },
  {
    "text": "Oracle you already know what that means",
    "start": "1418559",
    "end": "1423960"
  },
  {
    "text": "boom and if you look at the definition of the object message this interface is very simple",
    "start": "1423960",
    "end": "1430799"
  },
  {
    "text": "it's it only has two methods one to store a object a serializable object in",
    "start": "1430799",
    "end": "1436520"
  },
  {
    "text": "a object message which is called the Z object method and you just use as a first argument the serializable object",
    "start": "1436520",
    "end": "1442880"
  },
  {
    "text": "and then it will be stored in the object message and in order to get a serializable object again from the",
    "start": "1442880",
    "end": "1448440"
  },
  {
    "text": "object message you just invoked the get object method and as you can see from the return value it is",
    "start": "1448440",
    "end": "1454720"
  },
  {
    "text": "serializable and this specific interface needs to be imp implemented by every JMS",
    "start": "1454720",
    "end": "1461440"
  },
  {
    "text": "broker SL render so they all have their own implementation classes for object",
    "start": "1461440",
    "end": "1466799"
  },
  {
    "text": "messages and I mean you already can guess what",
    "start": "1466799",
    "end": "1472000"
  },
  {
    "text": "get object is doing I mean it's serializing data and this will bring us",
    "start": "1472000",
    "end": "1477600"
  },
  {
    "text": "to the interesting part which is attacking JS so the process of vulnerability",
    "start": "1477600",
    "end": "1483159"
  },
  {
    "text": "Discovery was pretty funny so I just thought about okay what is running in the environment of our clients and I",
    "start": "1483159",
    "end": "1490520"
  },
  {
    "text": "thought okay yeah they usually have some Brokers running and J application servers so it might make sense to look",
    "start": "1490520",
    "end": "1495919"
  },
  {
    "text": "at those products and find out if they are vulnerable or not my guess was okay as",
    "start": "1495919",
    "end": "1502360"
  },
  {
    "text": "we've always most of them might be vulnerable uh so the priority was just",
    "start": "1502360",
    "end": "1508360"
  },
  {
    "text": "based on what I have seen most in the client engagement for example IP web sphere and so",
    "start": "1508360",
    "end": "1514880"
  },
  {
    "text": "on um I haven't looked at any integration platform at all because I knew that they are built on top and",
    "start": "1514880",
    "end": "1522480"
  },
  {
    "text": "application server usually and applications servers usually",
    "start": "1522480",
    "end": "1527799"
  },
  {
    "text": "reuse existing Brokers for example redhead EAP and so the latest version is using",
    "start": "1527799",
    "end": "1534960"
  },
  {
    "text": "active inq teus and the older versions are using Hornet Q from redhead IBM web",
    "start": "1534960",
    "end": "1540880"
  },
  {
    "text": "spere application server is using IBM web mq Oracle glassfish is using Oracle",
    "start": "1540880",
    "end": "1546720"
  },
  {
    "text": "op q and as a result all object message implementations I looked at were",
    "start": "1546720",
    "end": "1553840"
  },
  {
    "text": "desizing from unsted input without any",
    "start": "1553840",
    "end": "1558880"
  },
  {
    "text": "validation and just to give you a short impression what that means I will show you a lot of advisories here so the",
    "start": "1558880",
    "end": "1565480"
  },
  {
    "text": "first advisory I sent out was to aache active mq and I was telling them telling",
    "start": "1565480",
    "end": "1571360"
  },
  {
    "text": "them okay you desizing from untrusted input by using a special Library called uh",
    "start": "1571360",
    "end": "1577720"
  },
  {
    "text": "extrem and also object input stream um it was a bunch of lines of codw show",
    "start": "1577720",
    "end": "1583480"
  },
  {
    "text": "them it was in September last year the next one which I sent out was to rad",
    "start": "1583480",
    "end": "1590600"
  },
  {
    "text": "regarding Hornet q and I told them okay the implementation class of the object",
    "start": "1590600",
    "end": "1596440"
  },
  {
    "text": "message dezes in method get object from untrusted input no validation is",
    "start": "1596440",
    "end": "1603679"
  },
  {
    "text": "applied same wording again for Oracle op Q the implementation class of object",
    "start": "1603679",
    "end": "1610559"
  },
  {
    "text": "message dies realizes from untrusted input in get object sent out in March",
    "start": "1610559",
    "end": "1615760"
  },
  {
    "text": "this year same wording for web cmq I don't want to repeat it anymore",
    "start": "1615760",
    "end": "1622600"
  },
  {
    "text": "because ah maybe I should repeat it here um web SPM Q had two ways to trigger not",
    "start": "1622600",
    "end": "1629720"
  },
  {
    "text": "only the get object but also the get object internal which can be triggered by another method next one was Oracle web",
    "start": "1629720",
    "end": "1637320"
  },
  {
    "text": "Logic the funny thing here is that not only the object message is one rable here but also the text message and a",
    "start": "1637320",
    "end": "1645320"
  },
  {
    "text": "special message type which is called XML message so whenever you're using text messages or XML messages or object",
    "start": "1645320",
    "end": "1652679"
  },
  {
    "text": "messages in your software and you read the body of the message in your",
    "start": "1652679",
    "end": "1657720"
  },
  {
    "text": "application You're vulnerable to a dation vulnerability next one was rabit inq",
    "start": "1657720",
    "end": "1665279"
  },
  {
    "text": "also in March same wording the implementation class of object message these realizes from untrusted input in",
    "start": "1665279",
    "end": "1671720"
  },
  {
    "text": "method get object no validation is applied then we have a apply from IBM",
    "start": "1671720",
    "end": "1678960"
  },
  {
    "text": "same wording also get object another implementation class then we have a",
    "start": "1678960",
    "end": "1684000"
  },
  {
    "text": "German software company it's called Swift mq so the product is called Swift",
    "start": "1684000",
    "end": "1689080"
  },
  {
    "text": "mq hopefully the software is not using is not used in Swift environments um and same wording the",
    "start": "1689080",
    "end": "1696039"
  },
  {
    "text": "implementation class of object message um these realizes from unrusted input in method get object another one active in",
    "start": "1696039",
    "end": "1702919"
  },
  {
    "text": "qis it's funny because active in qis is the successor of active mq and Hornet Q",
    "start": "1702919",
    "end": "1710080"
  },
  {
    "text": "so they merg both projects together so they have they are sharing some code or",
    "start": "1710080",
    "end": "1715600"
  },
  {
    "text": "I think most of the code is from active mq and and they incorporate the protocol of hornet q",
    "start": "1715600",
    "end": "1723559"
  },
  {
    "text": "and active mq was patched very early as you will see later on but they did not incorporate the patch into active mq",
    "start": "1723559",
    "end": "1730039"
  },
  {
    "text": "teams which is funny um another one is",
    "start": "1730039",
    "end": "1735720"
  },
  {
    "text": "aachi Cupid they have two Brokers one implemented in",
    "start": "1735720",
    "end": "1741600"
  },
  {
    "text": "Java the other one implemented in C++ same problem method get object is",
    "start": "1741600",
    "end": "1748120"
  },
  {
    "text": "vulnerable to D realization of unrusted input and I also have a cloud provider for you which is Amazon sqs Java",
    "start": "1748120",
    "end": "1755279"
  },
  {
    "text": "messaging and the same problem so we have about 13",
    "start": "1755279",
    "end": "1760399"
  },
  {
    "text": "vulnerabilities I would say it's only one Buck because it's from the specification",
    "start": "1760399",
    "end": "1765919"
  },
  {
    "text": "and all wers implemented it without any validation and just to give you an impression what is patched and what is",
    "start": "1765919",
    "end": "1771240"
  },
  {
    "text": "not patched so Apache um aach active in Q",
    "start": "1771240",
    "end": "1776399"
  },
  {
    "text": "was patched pretty early and they implemented white and black listing so whenever you use this product please use",
    "start": "1776399",
    "end": "1782360"
  },
  {
    "text": "white listing Reddit redhead Hornet Q is not patched Oracle open q is not patched IBM",
    "start": "1782360",
    "end": "1788440"
  },
  {
    "text": "webm Q is not patched Oracle web logic is patched but they implemented blacklisting and The Blacklist can",
    "start": "1788440",
    "end": "1795200"
  },
  {
    "text": "easily be bypassed if you're interested look at my um RX slides I have shown",
    "start": "1795200",
    "end": "1801880"
  },
  {
    "text": "there how you can bypass the Blacklist very easily um IBM message site uh pivotal",
    "start": "1801880",
    "end": "1808159"
  },
  {
    "text": "rabbitmq is not patched IBM message site is patched but the patch looks like this",
    "start": "1808159",
    "end": "1814679"
  },
  {
    "text": "they just deactivated the use of object messages at all so whenever you want to use object messages anymore you need to",
    "start": "1814679",
    "end": "1822200"
  },
  {
    "text": "use a spec or you need to set a specific uh system property which is in my opinion not",
    "start": "1822200",
    "end": "1828039"
  },
  {
    "text": "patch um Apache activ qis is not patch Apache Cupid so both versions are",
    "start": "1828039",
    "end": "1834399"
  },
  {
    "text": "already patched and they implemented the same um strategy like Apache active",
    "start": "1834399",
    "end": "1841440"
  },
  {
    "text": "mq exploitation of those vulnerability is fairly easy you just take the same",
    "start": "1841640",
    "end": "1848120"
  },
  {
    "text": "code which I have shown you in the very beginning for sing messages and what you need to do is you need to create a",
    "start": "1848120",
    "end": "1854320"
  },
  {
    "text": "connection Factory Connection a session and a producer and then you need to",
    "start": "1854320",
    "end": "1859960"
  },
  {
    "text": "create a object message and put a serializable gadget into the object",
    "start": "1859960",
    "end": "1866639"
  },
  {
    "text": "message that's it and then send it to the Target system and if the target system is receiving object messages and",
    "start": "1866639",
    "end": "1874080"
  },
  {
    "text": "invoking the get object method it visualizes from untrusted input and then",
    "start": "1874080",
    "end": "1879399"
  },
  {
    "text": "hopefully we get C there are two exploitation scenarios",
    "start": "1879399",
    "end": "1885320"
  },
  {
    "text": "the first one is the Q exploitation where we as an attacker sent a message an object message containing a",
    "start": "1885320",
    "end": "1891880"
  },
  {
    "text": "serializable gadget and this gadget is distributed using the broker to the Target system",
    "start": "1891880",
    "end": "1899159"
  },
  {
    "text": "and the target is invoking the get object this one is",
    "start": "1899159",
    "end": "1904919"
  },
  {
    "text": "boring the topic exploitation is very interesting because we in AER sent a message it's sent to the broker and the",
    "start": "1904919",
    "end": "1911639"
  },
  {
    "text": "broker will deliver it to all of its subscriber and it might happen that you",
    "start": "1911639",
    "end": "1916840"
  },
  {
    "text": "that you get get a lot of Cs it really depends on which applications are",
    "start": "1916840",
    "end": "1922399"
  },
  {
    "text": "listening on the topic which for example an application server a Java program",
    "start": "1922399",
    "end": "1927720"
  },
  {
    "text": "really depends on I have seen systems for clients maybe 20 systems listening on",
    "start": "1927720",
    "end": "1934440"
  },
  {
    "text": "the same topic so just send in a message and you get 20 CS hopefully",
    "start": "1934440",
    "end": "1942240"
  },
  {
    "text": "and the successful exploitation of this of the topic exploitation really depends",
    "start": "1942240",
    "end": "1948440"
  },
  {
    "text": "on several factors for example which J version is running on the target system if it is an old one we",
    "start": "1948440",
    "end": "1955760"
  },
  {
    "text": "can use JRE gadgets it's a new one it won't work",
    "start": "1955760",
    "end": "1961320"
  },
  {
    "text": "which which libraries are bundle with the application is there a common collection",
    "start": "1961320",
    "end": "1966960"
  },
  {
    "text": "for example in the application or not which libraries are in the class perff of the of the runtime environment for",
    "start": "1966960",
    "end": "1973159"
  },
  {
    "text": "example the application server can be redhe saos whatever does the runtime",
    "start": "1973159",
    "end": "1979320"
  },
  {
    "text": "environment have or has separate a separate class loaders which have a",
    "start": "1979320",
    "end": "1984760"
  },
  {
    "text": "separate resolution scope for example redhead Joss has a very good architecture because they're using osgi",
    "start": "1984760",
    "end": "1991159"
  },
  {
    "text": "and it's not very easy to exploit it some of them and it also depends on if the Java",
    "start": "1991159",
    "end": "1997399"
  },
  {
    "text": "security manager is enabled I haven't seen that very often our engagements two",
    "start": "1997399",
    "end": "2002679"
  },
  {
    "text": "times uh and one one of the most important facts is JMS is asynchronous",
    "start": "2002679",
    "end": "2009600"
  },
  {
    "text": "which means you won't get any feedback you just send the message to the queue",
    "start": "2009600",
    "end": "2015000"
  },
  {
    "text": "or the topic so just send it to the broker and it will distribute and you won't get any stack trays you won't get",
    "start": "2015000",
    "end": "2022679"
  },
  {
    "text": "any reason why it's not working and that was also the reason why I thought okay we need something like a",
    "start": "2022679",
    "end": "2028880"
  },
  {
    "text": "blackbox assessment tool which sends gadgets using p uh",
    "start": "2028880",
    "end": "2035159"
  },
  {
    "text": "object messages and this will bring me to the next part of my presentation which is the tool",
    "start": "2035159",
    "end": "2042919"
  },
  {
    "text": "jet jmet is the Java message exploitation tool it's a command line",
    "start": "2042919",
    "end": "2048200"
  },
  {
    "text": "tool it's open source it's on GitHub it's currently a private repository but it will upit after the session is",
    "start": "2048200",
    "end": "2055000"
  },
  {
    "text": "finished it integrates Chris roof's viso serial to create gadgets it currently",
    "start": "2055000",
    "end": "2061919"
  },
  {
    "text": "supports three exploitation modes the first one is the caliz calization exploitation mode or Gadget exploitation",
    "start": "2061919",
    "end": "2068599"
  },
  {
    "text": "mode I also support a text for XML passes xxe and also custom one but it's",
    "start": "2068599",
    "end": "2073638"
  },
  {
    "text": "not part of this presentation jet can also be um reconfigured and customized",
    "start": "2073639",
    "end": "2079839"
  },
  {
    "text": "using JavaScript and as I said it's on GitHub um it's on my GitHub repository",
    "start": "2079839",
    "end": "2085480"
  },
  {
    "text": "and I will upit after the session currently I'm supporting um most",
    "start": "2085480",
    "end": "2091200"
  },
  {
    "text": "of the JS progress out there except Oracle web logic um Amazon sqs and what is it IB",
    "start": "2091200",
    "end": "2099400"
  },
  {
    "text": "message message site so IB message site and Amazon sqs will follow soon",
    "start": "2099400",
    "end": "2105359"
  },
  {
    "text": "and I don't think that I will support Oracle web logic very soon because in order to send messages or to Oracle web",
    "start": "2105359",
    "end": "2113119"
  },
  {
    "text": "logic as a broker a RMI protocol is used which is called T3 and you might have",
    "start": "2113119",
    "end": "2118760"
  },
  {
    "text": "already heard of it that it is vulnerable and it would also make my tool vulnerable to dation attacks so I",
    "start": "2118760",
    "end": "2125800"
  },
  {
    "text": "don't want to have you guys hacked when you're running my",
    "start": "2125800",
    "end": "2131000"
  },
  {
    "text": "tool using jet is quite simple you just download the J file or compile it with",
    "start": "2131119",
    "end": "2138359"
  },
  {
    "text": "Maven uh when you run it like Java Das J path to the J file you specify the",
    "start": "2138359",
    "end": "2143800"
  },
  {
    "text": "username you specify the password you specify the Q or",
    "start": "2143800",
    "end": "2149520"
  },
  {
    "text": "topic and the implementation which you want to use in this casee I'm using",
    "start": "2149520",
    "end": "2154560"
  },
  {
    "text": "timis which is active in qis and if you want to use the gadget exploitation mode so sending serialized",
    "start": "2154560",
    "end": "2161400"
  },
  {
    "text": "Gadget it just use the dasy parameter and specify the command which you want to invoke on the target system and the",
    "start": "2161400",
    "end": "2169640"
  },
  {
    "text": "target IP or host name and the port and that's it and then you just run it and if you can get a connection to the",
    "start": "2169640",
    "end": "2176640"
  },
  {
    "text": "system then it will look like this and I also have a reward example for you as I",
    "start": "2176640",
    "end": "2182359"
  },
  {
    "text": "said I don't like to show tools on slides um oh no I think I have some",
    "start": "2182359",
    "end": "2189720"
  },
  {
    "text": "stuff which I want to work first so the target system or finding a Target system",
    "start": "2189720",
    "end": "2196520"
  },
  {
    "text": "took some time because usually I think custom build applications are using JS",
    "start": "2196520",
    "end": "2201760"
  },
  {
    "text": "there are some applications out there or some vendors out there they have products which are using JMS and I found",
    "start": "2201760",
    "end": "2208520"
  },
  {
    "text": "one which is from HP which is the HP network node manager I and HP network no node manager I is",
    "start": "2208520",
    "end": "2216200"
  },
  {
    "text": "just a Network management software it's running on top of a Jos 5 which which is pretty old and ancient and as I said",
    "start": "2216200",
    "end": "2223599"
  },
  {
    "text": "already in the beginning haunted Q is used in Jos it supports local and elab",
    "start": "2223599",
    "end": "2230319"
  },
  {
    "text": "authentication so usually you integrate this piece of software with your active directory and it makes heavy use of",
    "start": "2230319",
    "end": "2237119"
  },
  {
    "text": "queing and topics and the process how I found the",
    "start": "2237119",
    "end": "2242280"
  },
  {
    "text": "vulnerability was pretty easy I just took all the jav files I integrated I created a new Eclipse project I",
    "start": "2242280",
    "end": "2249599"
  },
  {
    "text": "integrated all the jav files into my project I used the very well-known uh",
    "start": "2249599",
    "end": "2255119"
  },
  {
    "text": "plugin which is called JD eclipse and I just looked for all classes which",
    "start": "2255119",
    "end": "2260400"
  },
  {
    "text": "implement the message listen interface and I found about 115 classes which are",
    "start": "2260400",
    "end": "2265440"
  },
  {
    "text": "implementing this interface which means we have about 150 message driven beans",
    "start": "2265440",
    "end": "2271079"
  },
  {
    "text": "which is a lot most of them make use of text messages or object messages",
    "start": "2271079",
    "end": "2277480"
  },
  {
    "text": "one of the bad things is that J that uh HP HP network node manager I requires",
    "start": "2277480",
    "end": "2285000"
  },
  {
    "text": "authentication or it's because of hornet Q because they usually require authentication you really need to",
    "start": "2285000",
    "end": "2290200"
  },
  {
    "text": "disable it and another bad thing was that the permissions are pretty good set on all the cues and topics so most of",
    "start": "2290200",
    "end": "2297440"
  },
  {
    "text": "them can only be accessed by users which have the role system most of them but I found",
    "start": "2297440",
    "end": "2304319"
  },
  {
    "text": "one which is a topic it's called the nms discovery configuration poll",
    "start": "2304319",
    "end": "2310160"
  },
  {
    "text": "topic and roles of type system and admin",
    "start": "2310160",
    "end": "2315240"
  },
  {
    "text": "can send and receive messages to this",
    "start": "2315240",
    "end": "2320880"
  },
  {
    "text": "topic and the code which is receiving messages so the the um",
    "start": "2320880",
    "end": "2329760"
  },
  {
    "text": "subscriber is the class demand list now of package whatever and it has an on",
    "start": "2329760",
    "end": "2334839"
  },
  {
    "text": "message method and what is happening inside the on message method is that first of in the very beginning there's a",
    "start": "2334839",
    "end": "2340640"
  },
  {
    "text": "little bit of logging then in that then they will cast a the message to object message and later on they will invoke",
    "start": "2340640",
    "end": "2347160"
  },
  {
    "text": "the get object method on the object message which triggers the process of D",
    "start": "2347160",
    "end": "2354119"
  },
  {
    "text": "dation and that's it and just to give you the real world example here I have",
    "start": "2355040",
    "end": "2363280"
  },
  {
    "text": "a wmware running and you don't see it let's see if I can put it here yooo it",
    "start": "2363280",
    "end": "2369760"
  },
  {
    "text": "works finally okay now I need to typ",
    "start": "2369760",
    "end": "2375440"
  },
  {
    "text": "Blind okay so get it Java D jar so PA to",
    "start": "2379240",
    "end": "2386920"
  },
  {
    "text": "jamet I created a user which is called admin and I just used the simple",
    "start": "2386920",
    "end": "2393359"
  },
  {
    "text": "password admin and and I use the implementation Hornet",
    "start": "2393359",
    "end": "2400720"
  },
  {
    "text": "Q Hornet Q oh I cannot see itbe I should go to full screen mode Hornet que and we",
    "start": "2400720",
    "end": "2409760"
  },
  {
    "text": "want to invoke the command not XT",
    "start": "2409760",
    "end": "2416119"
  },
  {
    "text": "cexc and let me see and the Q name uh the topic name is nms",
    "start": "2416119",
    "end": "2424880"
  },
  {
    "text": "do disc y Discovery do um",
    "start": "2424880",
    "end": "2434520"
  },
  {
    "text": "configuration configuration poll poll and the target IP",
    "start": "2434760",
    "end": "2441400"
  },
  {
    "text": "is this one uh 30 and destination Port is 557",
    "start": "2441400",
    "end": "2450160"
  },
  {
    "text": "4457 and just to and I just press the button and as you can see I've sent a",
    "start": "2450160",
    "end": "2458599"
  },
  {
    "text": "lot of object messages to the Target system um I sent gadgets like commment",
    "start": "2458599",
    "end": "2464040"
  },
  {
    "text": "collection one comments collection two high chk and so on to the specific topic",
    "start": "2464040",
    "end": "2470440"
  },
  {
    "text": "and if you now go to the Target system which is",
    "start": "2470440",
    "end": "2477960"
  },
  {
    "text": "here we see hopefully you guys can see the cards at the system cards let's do it",
    "start": "2477960",
    "end": "2485240"
  },
  {
    "text": "bigger so we we have a lot of cards here the",
    "start": "2485240",
    "end": "2491839"
  },
  {
    "text": "reason behind that is that uh first of all three gadgets are working in the Target system and the way so you have",
    "start": "2491839",
    "end": "2499880"
  },
  {
    "text": "seen there's a cast when the get object is invoked and what will happen is a Class cast exception will occur so what",
    "start": "2499880",
    "end": "2506240"
  },
  {
    "text": "the JMS broker will do is to redeliver the same message again for nine times so 3 multipli by 9 is 27 that's why we have",
    "start": "2506240",
    "end": "2514440"
  },
  {
    "text": "27 system CS okay so that's what that was the real world example HP network network node",
    "start": "2514440",
    "end": "2522079"
  },
  {
    "text": "manage ey now let get back to the presentation okay you have seen this and",
    "start": "2522079",
    "end": "2529079"
  },
  {
    "text": "now it's time for the conclusion so uh with several core",
    "start": "2529079",
    "end": "2537200"
  },
  {
    "text": "Technologies in the Java World JMS suffers from the dation problem all JMS",
    "start": "2537200",
    "end": "2544720"
  },
  {
    "text": "provider I will look look at were vulnerable to D realization of untrusted",
    "start": "2544720",
    "end": "2550440"
  },
  {
    "text": "input JMS topics and q's can be end points for exploitation in Target environments for example in your",
    "start": "2550440",
    "end": "2556559"
  },
  {
    "text": "client's corporate Network the exploitation of jmss Highly",
    "start": "2556559",
    "end": "2562640"
  },
  {
    "text": "depends on which gadgets are in the class path of the target system when serialization is used and jamet is just",
    "start": "2562640",
    "end": "2570079"
  },
  {
    "text": "a tool to make your life easier and to make exploitation easier okay",
    "start": "2570079",
    "end": "2577380"
  },
  {
    "text": "[Applause]",
    "start": "2577380",
    "end": "2582279"
  },
  {
    "text": "thanks thanks again for listening and I'm very happy to answer",
    "start": "2582839",
    "end": "2589599"
  },
  {
    "text": "questions uh you mentioned that JS the protocol doesn't Define the wire protocol uh does any implementation",
    "start": "2591079",
    "end": "2597559"
  },
  {
    "text": "could be vulnerable to ssrf or um to a blind ssrf uh could be yeah",
    "start": "2597559",
    "end": "2605040"
  },
  {
    "text": "could be yeah and any implementation you in mind that could not yet no okay",
    "start": "2605040",
    "end": "2610920"
  },
  {
    "text": "thanks welcome further questions just a quick",
    "start": "2610920",
    "end": "2616240"
  },
  {
    "text": "question regarding mq uh web spere mq yeah uh I see that all the time at some of our clients what's been the vendor",
    "start": "2616240",
    "end": "2623160"
  },
  {
    "text": "response for this vulnerability could you please repeat the web spere mq uh vendor",
    "start": "2623160",
    "end": "2631440"
  },
  {
    "text": "response sorry I didn't get it response from the vendor um I have got an",
    "start": "2631440",
    "end": "2637440"
  },
  {
    "text": "response from them that they received the message but no fix yet I think it's planned for Q3 quarter quarter",
    "start": "2637440",
    "end": "2645800"
  },
  {
    "text": "3 thank you for the zero days uh just a question it's one zero day you had one",
    "start": "2646000",
    "end": "2653400"
  },
  {
    "text": "slide with a couple of cves yeah uh any idea did you have you time did you take",
    "start": "2653400",
    "end": "2658960"
  },
  {
    "text": "the time to look at how they fixed it like using black box versus white box so",
    "start": "2658960",
    "end": "2664400"
  },
  {
    "text": "I mean I'm pretty sure that most of them will Implement something like either deactivated or Implement wide listing",
    "start": "2664400",
    "end": "2671559"
  },
  {
    "text": "but in my opinion this is pretty tough because what it means is that all",
    "start": "2671559",
    "end": "2676920"
  },
  {
    "text": "developers need to be aware of which classes can be sent and received over",
    "start": "2676920",
    "end": "2682280"
  },
  {
    "text": "JMS using object messages so you really have to Define your domain model and find out okay what are the domain",
    "start": "2682280",
    "end": "2688520"
  },
  {
    "text": "objects which I sent around and not more not less and if you think about an application servers usually you have a",
    "start": "2688520",
    "end": "2694359"
  },
  {
    "text": "lot of application Ser uh application running there so it's not easy to find what you can wi list and what you need",
    "start": "2694359",
    "end": "2700720"
  },
  {
    "text": "to what you need to do and that's why I think most of the software developers",
    "start": "2700720",
    "end": "2707079"
  },
  {
    "text": "will not use any white or blacklisting at all and that's why I'm also showed all the vulnerabilities here because I'm",
    "start": "2707079",
    "end": "2713640"
  },
  {
    "text": "pretty sure that this class will exist for many years because nobody knows what",
    "start": "2713640",
    "end": "2720000"
  },
  {
    "text": "is really used in its application or for example in the application server you cannot wi list it very easily",
    "start": "2720000",
    "end": "2726599"
  },
  {
    "text": "and I'm pretty sure they just deactivated and that's why I also want to show to you to you guys that how you",
    "start": "2726599",
    "end": "2732920"
  },
  {
    "text": "can exploit and and that's also the reason why I um released the tool that it can be used in assessment and",
    "start": "2732920",
    "end": "2739160"
  },
  {
    "text": "penetration tests thank you welcome excuse me would",
    "start": "2739160",
    "end": "2747720"
  },
  {
    "text": "you mind putting up the port the slide you had with all the ports listed uh sure let",
    "start": "2747720",
    "end": "2754680"
  },
  {
    "text": "me uh the ports yeah there we go oh",
    "start": "2754680",
    "end": "2761480"
  },
  {
    "text": "no it okay okay something's going wrong let me",
    "start": "2761480",
    "end": "2767359"
  },
  {
    "text": "check uhoh just a second now it should work",
    "start": "2767359",
    "end": "2775760"
  },
  {
    "text": "again yeah so let's get to the ports the parts",
    "start": "2775760",
    "end": "2782079"
  },
  {
    "text": "are sorry something is not working",
    "start": "2782079",
    "end": "2787800"
  },
  {
    "text": "what it was it no there is no I'm too far sorry where is",
    "start": "2793760",
    "end": "2800520"
  },
  {
    "text": "it oh there you go okay okay",
    "start": "2800520",
    "end": "2806880"
  },
  {
    "text": "yeah this one okay I have a question um so for the ones without patches",
    "start": "2806960",
    "end": "2812760"
  },
  {
    "text": "available uh could you advise people to try and remediate this through input validation on the server side or does",
    "start": "2812760",
    "end": "2819599"
  },
  {
    "text": "the very fact that it's deserializing prevent you from doing input validation so so first of all you need",
    "start": "2819599",
    "end": "2827839"
  },
  {
    "text": "need the patched version and then the vendor needs to have the possibility for you to um to specify white list then it",
    "start": "2827839",
    "end": "2835280"
  },
  {
    "text": "can be rendered what you can also do is you can use a Java agent which is called Noto serial and run it but you really",
    "start": "2835280",
    "end": "2842520"
  },
  {
    "text": "need to aware what is happening inside your application because with not so seral you can block for example",
    "start": "2842520",
    "end": "2848160"
  },
  {
    "text": "dations and stuff like that so it you can use it but I wouldn't use it for an",
    "start": "2848160",
    "end": "2854079"
  },
  {
    "text": "application Ser for example because you never know what is happening inside there okay thank you welcome um for the ones that are",
    "start": "2854079",
    "end": "2861400"
  },
  {
    "text": "currently not fixed what is the time frame for them to fix it or did they give you a reason why they haven't yet",
    "start": "2861400",
    "end": "2866960"
  },
  {
    "text": "fixed it so from Amazon sqs I heard that they will address it in future releases",
    "start": "2866960",
    "end": "2873200"
  },
  {
    "text": "so no time frame uh I heard from from a developer of redhead that they won't fix it because redhead is saying it's after",
    "start": "2873200",
    "end": "2880880"
  },
  {
    "text": "authentication it's post authentication so there's no need to fix it which is in my opinion not a good reason and from",
    "start": "2880880",
    "end": "2887720"
  },
  {
    "text": "the others I from IBM I heard they will fix it in Q3 quarter 3 and from the others I haven't heard anything but to",
    "start": "2887720",
    "end": "2894200"
  },
  {
    "text": "be honest I haven't put any pressure of them because I have found about 20 dation vulnerability in the last year",
    "start": "2894200",
    "end": "2901160"
  },
  {
    "text": "and I'm not following all of them thank you welcome",
    "start": "2901160",
    "end": "2906400"
  },
  {
    "text": "all right we are out of time for questions thank you very much Matias thanks a lot for listening thank",
    "start": "2906400",
    "end": "2913200"
  },
  {
    "text": "you",
    "start": "2914119",
    "end": "2917119"
  }
]