[
  {
    "text": "okay I think I'm going to to continue because um I did just one hour and it's",
    "start": "199",
    "end": "6399"
  },
  {
    "text": "just exploit exploit K so I will continue because if not there won't be",
    "start": "6399",
    "end": "12840"
  },
  {
    "text": "time so I will make a short introduction about the PDF uh format the PDF",
    "start": "12840",
    "end": "21520"
  },
  {
    "text": "Basics so it low to the transition to the slide so what we have normally in a",
    "start": "21600",
    "end": "29320"
  },
  {
    "text": "pdfi we have a header where we can see the the version of the PDF file the PDF",
    "start": "29320",
    "end": "36480"
  },
  {
    "text": "uh format I mean then you have like the body of the PDF that it's a a sequence",
    "start": "36480",
    "end": "42120"
  },
  {
    "text": "of of objects then we have a a cross reference table that is like",
    "start": "42120",
    "end": "48280"
  },
  {
    "text": "um uh table of of content of the PDF that you have uh all",
    "start": "48280",
    "end": "54760"
  },
  {
    "text": "these lines saying this object is in this offset and this other object is in",
    "start": "54760",
    "end": "60480"
  },
  {
    "text": "in this other offset and then finally you have the the trailer and the trailer",
    "start": "60480",
    "end": "65960"
  },
  {
    "text": "will tell you for example what's the the first object that the PDF reader has to take a look that's called H the catalog",
    "start": "65960",
    "end": "73320"
  },
  {
    "text": "but I will I will talk about it I think a bit later uh this objects this uh sequence",
    "start": "73320",
    "end": "80880"
  },
  {
    "text": "of objects can be uh can be a number can be um an array can be a dictionary also",
    "start": "80880",
    "end": "88680"
  },
  {
    "text": "but they can be also a special object for the for the PDF files that is called",
    "start": "88680",
    "end": "94399"
  },
  {
    "text": "stream and the streams contain a dictionary and also um some kind of",
    "start": "94399",
    "end": "101520"
  },
  {
    "text": "content between the the TX stream and end stream this content can be",
    "start": "101520",
    "end": "106680"
  },
  {
    "text": "compressed can be um encoded uh with some filters in",
    "start": "106680",
    "end": "113200"
  },
  {
    "text": "this case for example is the a x the code so it's xmal okay but you can you can also put",
    "start": "113200",
    "end": "120880"
  },
  {
    "text": "more filters so you can compress with something and then use this other filter and this other filter so you can do a",
    "start": "120880",
    "end": "127600"
  },
  {
    "text": "change of filters so this is also used in order tocate the the PDF",
    "start": "127600",
    "end": "135040"
  },
  {
    "text": "files uh we can reference an object inside a PDF object with the with his ID",
    "start": "136040",
    "end": "142200"
  },
  {
    "text": "so we can have the ID the generation number and then the the letters of O BJ",
    "start": "142200",
    "end": "150720"
  },
  {
    "text": "and then we have the end tag that is end object we can reference every object",
    "start": "150720",
    "end": "157480"
  },
  {
    "text": "doing for example in this case kids uh this page has just one page I mean this",
    "start": "157480",
    "end": "164200"
  },
  {
    "text": "um object is a Pages object that it means that it contains all the objects",
    "start": "164200",
    "end": "170239"
  },
  {
    "text": "all the pages of the document so in this case it's just referencing one object",
    "start": "170239",
    "end": "175760"
  },
  {
    "text": "the three o r so object three is the only page of of the document it's like a",
    "start": "175760",
    "end": "182159"
  },
  {
    "text": "referencing you can reference inside of an object you can reference another object and chain",
    "start": "182159",
    "end": "189080"
  },
  {
    "text": "it and there is the the catalog what I was talking before the PDF has a like um",
    "start": "189080",
    "end": "196720"
  },
  {
    "text": "root structure three structure where the catalog is the root so that's the the",
    "start": "196720",
    "end": "201840"
  },
  {
    "text": "first thing that the PDF readers are going to read uh they will check the the trailer to know um what is the catalog",
    "start": "201840",
    "end": "208920"
  },
  {
    "text": "object then they will check this object and they will continue getting the the",
    "start": "208920",
    "end": "214680"
  },
  {
    "text": "rest the the other objects okay if um if an object is not",
    "start": "214680",
    "end": "220400"
  },
  {
    "text": "included in the uh in the downward path from the catalog it doesn't exist for a",
    "start": "220400",
    "end": "225560"
  },
  {
    "text": "PDF reader okay so we have that's also suspicious for example we have a PDF",
    "start": "225560",
    "end": "232280"
  },
  {
    "text": "file and we find that an object is part of being big or or small if it's just",
    "start": "232280",
    "end": "239360"
  },
  {
    "text": "like I at it's it's not referen from another object that's suspicious because normally the PDF reader wants to see all",
    "start": "239360",
    "end": "246560"
  },
  {
    "text": "the objects and H handle them so that we will see an ANL an example",
    "start": "246560",
    "end": "253720"
  },
  {
    "text": "later so what we can do is just uh have a text editor here and take a look how",
    "start": "253720",
    "end": "260840"
  },
  {
    "text": "it",
    "start": "260840",
    "end": "262959"
  },
  {
    "text": "looks ah okay I'm going to show yes I almost forgot about",
    "start": "266720",
    "end": "273280"
  },
  {
    "text": "it so what we you you have in the in the",
    "start": "287199",
    "end": "292240"
  },
  {
    "text": "package is uh beta utils installer that's uh some help scripts that I",
    "start": "292240",
    "end": "298240"
  },
  {
    "text": "created uh some time ago uh I didn't check if it really works",
    "start": "298240",
    "end": "304639"
  },
  {
    "text": "but normally there are some distributions with already with p p Liu and P V8 so that shouldn't be a problem",
    "start": "304639",
    "end": "312720"
  },
  {
    "text": "then we have the split kit uh folder where I was before with all the scripts",
    "start": "312720",
    "end": "319639"
  },
  {
    "text": "all the sampleit spage examples and then we have the PDFs with analysis with all",
    "start": "319639",
    "end": "326160"
  },
  {
    "text": "the examp exercises and the fation with just also some examples so that's that's",
    "start": "326160",
    "end": "333039"
  },
  {
    "text": "all I'm saying this because someone was asking me if I could explain like the structure of the of the package",
    "start": "333039",
    "end": "340039"
  },
  {
    "text": "okay H what I wanted to do is going in",
    "start": "340039",
    "end": "346080"
  },
  {
    "text": "here okay let",
    "start": "358280",
    "end": "361639"
  },
  {
    "text": "I will use",
    "start": "366919",
    "end": "369639"
  },
  {
    "text": "this so this is this this will be the the header and",
    "start": "372280",
    "end": "379160"
  },
  {
    "text": "then we have the the body with three objects in this case and for each object",
    "start": "379160",
    "end": "384960"
  },
  {
    "text": "in the cross reference table we have a line and then in the trailer we have",
    "start": "384960",
    "end": "392360"
  },
  {
    "text": "this root that it means that the catalog object is the object number one that is",
    "start": "392360",
    "end": "399120"
  },
  {
    "text": "here and here we can go we can see the pages object and here what I was",
    "start": "399120",
    "end": "405720"
  },
  {
    "text": "commenting before so that's what what you can see normally with a just an editor uh we can",
    "start": "405720",
    "end": "413120"
  },
  {
    "text": "we have um binary code or binary bytes inside the the PDF then we can not see",
    "start": "413120",
    "end": "419960"
  },
  {
    "text": "it with a with just an editor so we need some some tools like",
    "start": "419960",
    "end": "427000"
  },
  {
    "text": "PDF uh also I forgot to mention that um the cross reference table the this thing",
    "start": "428080",
    "end": "435039"
  },
  {
    "text": "where you can have one line per object saying this object is in this offset H",
    "start": "435039",
    "end": "440280"
  },
  {
    "text": "it's not really necessary for a PDF reader so some of the PDF exploits just remove them or they don't include a good",
    "start": "440280",
    "end": "447840"
  },
  {
    "text": "information so if if you you see for example a PDF file without a cross reference table it will work with PDF",
    "start": "447840",
    "end": "453639"
  },
  {
    "text": "reader with Adobe Reader for example but um you can see that suspicious because",
    "start": "453639",
    "end": "458800"
  },
  {
    "text": "normally they should contain this cross reference table okay so to analyze the PDF files I use",
    "start": "458800",
    "end": "466440"
  },
  {
    "text": "the tool that I wrote some some time ago that's called PDF um it's a python tool with a command",
    "start": "466440",
    "end": "473440"
  },
  {
    "text": "line uh you have an interactive console as you have seen before uh with a lot of",
    "start": "473440",
    "end": "479479"
  },
  {
    "text": "commands with colors also and this tool is included in in remn it was included",
    "start": "479479",
    "end": "485560"
  },
  {
    "text": "in in backtrack and now it's in in Cali Linux um so I this these are all the the",
    "start": "485560",
    "end": "494440"
  },
  {
    "text": "commands that we can see that I will explain later so you can execute the I'm",
    "start": "494440",
    "end": "503199"
  },
  {
    "text": "going well I'm going to explain Al later but you can execute the tool like um with the command with saat command that",
    "start": "503199",
    "end": "510280"
  },
  {
    "text": "I showed you for to beautify the the code of the ja of the exploit kits and",
    "start": "510280",
    "end": "515880"
  },
  {
    "text": "you can use it as interactive that is minus I and you can use it like basic just to have a summary of the of a PDF",
    "start": "515880",
    "end": "523599"
  },
  {
    "text": "file a summary analysis uh it contains you can also use",
    "start": "523599",
    "end": "530680"
  },
  {
    "text": "the XML output and I know that it's a all so I will try to include a j output in the",
    "start": "530680",
    "end": "538440"
  },
  {
    "text": "next month so you can incorporate that with another tool and do some kind of automatic",
    "start": "538440",
    "end": "546240"
  },
  {
    "text": "thing I'm trying to to maintain this tool when I have time so it's out of out of work hour so",
    "start": "546240",
    "end": "553680"
  },
  {
    "text": "it's sometimes it's difficult but uh I try to upload changes and a good thing",
    "start": "553680",
    "end": "559320"
  },
  {
    "text": "of of the tool is that I I created an update command so in every moment you",
    "start": "559320",
    "end": "564920"
  },
  {
    "text": "can do update and try to get the the last changes so you don't have to go for",
    "start": "564920",
    "end": "569959"
  },
  {
    "text": "another package you just have the basic and you do minus U and you update the",
    "start": "569959",
    "end": "575240"
  },
  {
    "text": "tool so that's that's also good H it includes JavaScript emulation Sil code",
    "start": "575240",
    "end": "581079"
  },
  {
    "text": "emulation with pemu JavaScript analysis with P V8 and it can check the object streams",
    "start": "581079",
    "end": "588560"
  },
  {
    "text": "that are streams objects that are compressed inside the PDF file uh it can check um uh strings with",
    "start": "588560",
    "end": "597200"
  },
  {
    "text": "parameters in the filters that it's something that you can use also to to Aus skate the",
    "start": "597200",
    "end": "602760"
  },
  {
    "text": "files so it contains a lot of things also it supports encryption so it's",
    "start": "602760",
    "end": "610279"
  },
  {
    "text": "uh it's really nice so here for example I when I change",
    "start": "610279",
    "end": "615680"
  },
  {
    "text": "from spider monkey to I was using before spider monkey for the JavaScript engine and I changed to P",
    "start": "615680",
    "end": "623160"
  },
  {
    "text": "V8 and just because let me check maybe you can see",
    "start": "623160",
    "end": "628440"
  },
  {
    "text": "here so this was the execution with spider monkey and this was the execution with",
    "start": "628440",
    "end": "635560"
  },
  {
    "text": "pv8 so for some reasons it's it's more handful to use P V8 because I can uh",
    "start": "635560",
    "end": "643440"
  },
  {
    "text": "obtain the JavaScript better and I can beautify I can and also in the engine",
    "start": "643440",
    "end": "650000"
  },
  {
    "text": "itself it's for me at least it works better the P V8",
    "start": "650000",
    "end": "656120"
  },
  {
    "text": "okay I I also included um a virus total check so you can check the hash there",
    "start": "663160",
    "end": "669480"
  },
  {
    "text": "you can check just the hash you are not uploading anything to to virus total so if you have like a AP PDF file you can",
    "start": "669480",
    "end": "678000"
  },
  {
    "text": "still use this command because you are not sending anything well you're sending the hash but I think V is not checking",
    "start": "678000",
    "end": "684279"
  },
  {
    "text": "every has that it's search",
    "start": "684279",
    "end": "689560"
  },
  {
    "text": "so what I'm going to do is just here you have in the presentation uh some commands but because I going to do it uh",
    "start": "690760",
    "end": "698399"
  },
  {
    "text": "practical and I'm going to go for each of these commands",
    "start": "698399",
    "end": "705480"
  },
  {
    "text": "uh okay one important thing is that you can use PDF as a library also not just",
    "start": "706680",
    "end": "712040"
  },
  {
    "text": "as a tool you can use the PDF core uh module to create your own scripts so in",
    "start": "712040",
    "end": "718440"
  },
  {
    "text": "this case for example this guy Brandon Dixon wrote a tool to to extract the easily the The Flash well it's a tool",
    "start": "718440",
    "end": "726320"
  },
  {
    "text": "it's it's a script that is using the my PDF code you can see there and just",
    "start": "726320",
    "end": "732880"
  },
  {
    "text": "scanning the objects for the but you cannot see here but it was checking just",
    "start": "732880",
    "end": "738120"
  },
  {
    "text": "the header of the streams so it's if it's like s WF or compressed Flash and",
    "start": "738120",
    "end": "744440"
  },
  {
    "text": "it was extracting them quite basic",
    "start": "744440",
    "end": "749720"
  },
  {
    "text": "um okay so I think I'm going to start already with with this",
    "start": "750440",
    "end": "757079"
  },
  {
    "text": "because if not I will run out of",
    "start": "757079",
    "end": "761399"
  },
  {
    "text": "[Music]",
    "start": "767990",
    "end": "771429"
  },
  {
    "text": "time I will use this version the same that you have",
    "start": "777800",
    "end": "783440"
  },
  {
    "text": "there okay so now PDFs",
    "start": "788839",
    "end": "797600"
  },
  {
    "text": "analysis so this is what I was mention about the a simple execution I'm not",
    "start": "800320",
    "end": "805880"
  },
  {
    "text": "adding any any command so it's just it's just showing the information about",
    "start": "805880",
    "end": "811920"
  },
  {
    "text": "the file in this case it's a really simple and empty object but you can see",
    "start": "811920",
    "end": "818279"
  },
  {
    "text": "already the the information that the tool is giving it's giving the the hashes the the size the version of the",
    "start": "818279",
    "end": "825440"
  },
  {
    "text": "PDF format uh the number of objects that you can see the IDS of these objects uh",
    "start": "825440",
    "end": "832240"
  },
  {
    "text": "which is the catalog of the document that will be important later so you can see this easily you can",
    "start": "832240",
    "end": "839360"
  },
  {
    "text": "also execute well if you have not seen before but I will do first interactive",
    "start": "839360",
    "end": "847040"
  },
  {
    "text": "console so you have the same information at the beginning but you can use the",
    "start": "847040",
    "end": "853399"
  },
  {
    "text": "help command to see all the all the commands that you can use for example some of the basic",
    "start": "853399",
    "end": "859880"
  },
  {
    "text": "commands are offsets so you will see the the physical structure of the of the PDF",
    "start": "859880",
    "end": "866160"
  },
  {
    "text": "file so you have the header and in the offset 9 you have object one and this is",
    "start": "866160",
    "end": "872279"
  },
  {
    "text": "the size this is also important to check if there are really big files and also if",
    "start": "872279",
    "end": "879079"
  },
  {
    "text": "there are for example between this and this there are just three three bites three characters that probably there are",
    "start": "879079",
    "end": "885120"
  },
  {
    "text": "some spaces or some new lines and that's not really interesting but if you see like a huge gap here huge",
    "start": "885120",
    "end": "892759"
  },
  {
    "text": "um space it means that there is something there that maybe the exploit",
    "start": "892759",
    "end": "897920"
  },
  {
    "text": "is using probably a payload or something like that also I have an example about",
    "start": "897920",
    "end": "903839"
  },
  {
    "text": "that um the three command then you can see the the physic no not physical but",
    "start": "903839",
    "end": "910680"
  },
  {
    "text": "the logical structure of the document so you can have here you can see here the",
    "start": "910680",
    "end": "918000"
  },
  {
    "text": "whoa okay I I hope you are heing me",
    "start": "918000",
    "end": "923199"
  },
  {
    "text": "before uh this is the catalog and this is the the root of the structure of the",
    "start": "923199",
    "end": "928480"
  },
  {
    "text": "three structure and then you can see for example all the objects that are in the downward path so",
    "start": "928480",
    "end": "935360"
  },
  {
    "text": "that's what I I was saying if you see here uh another object that's suspicious",
    "start": "935360",
    "end": "942120"
  },
  {
    "text": "okay um I think before I go",
    "start": "942120",
    "end": "950120"
  },
  {
    "text": "on I was already mentioned this a bit but there are some some things so susic",
    "start": "950120",
    "end": "957560"
  },
  {
    "text": "suspicious elements that the the tool is showing that it's for example um the triggers when you open a document you",
    "start": "957560",
    "end": "964440"
  },
  {
    "text": "can trigger some actions and you can do that with the with the open Action element you can do that with the AA",
    "start": "964440",
    "end": "970920"
  },
  {
    "text": "element that's additional action element and also with the action but you can",
    "start": "970920",
    "end": "976160"
  },
  {
    "text": "execute also for example JavaScript code with other elements using this Acro form",
    "start": "976160",
    "end": "981360"
  },
  {
    "text": "or the names so all these things are like highlighted as suspicious when you",
    "start": "981360",
    "end": "986959"
  },
  {
    "text": "when you analyzing a a PDF file so you can see maybe I should take a look at",
    "start": "986959",
    "end": "992319"
  },
  {
    "text": "this okay um it will show also number abilities and I'm adding I'm trying to",
    "start": "992319",
    "end": "1000000"
  },
  {
    "text": "to add some some improvements out the detection of this to avoid false",
    "start": "1000000",
    "end": "1006000"
  },
  {
    "text": "positives okay if if it's a video file that includes encryption and it's it",
    "start": "1010000",
    "end": "1015639"
  },
  {
    "text": "doesn't have the a custom password that's normally really",
    "start": "1015639",
    "end": "1021440"
  },
  {
    "text": "suspicious because so about this about encryption I will I will tell you lat",
    "start": "1021440",
    "end": "1027079"
  },
  {
    "text": "I'm telling you now okay so in in the PDF format you can say this is encrypted",
    "start": "1027079",
    "end": "1033240"
  },
  {
    "text": "but I'm not supplying a a password so that's empty password and what it does",
    "start": "1033240",
    "end": "1038319"
  },
  {
    "text": "really is so you have a padding of I think 32 bytes and if the password is",
    "start": "1038319",
    "end": "1043600"
  },
  {
    "text": "empty then the password is the padding and if you add something then the pading",
    "start": "1043600",
    "end": "1049240"
  },
  {
    "text": "is uh less bites so there is there is a like a default password there so you can",
    "start": "1049240",
    "end": "1054799"
  },
  {
    "text": "just encrypt the the PDF file send it and it's encrypted and when you open it",
    "start": "1054799",
    "end": "1060320"
  },
  {
    "text": "with the Adobe Reader it will it won't say anything it's it will just uh the",
    "start": "1060320",
    "end": "1065400"
  },
  {
    "text": "Crypt automatically because it's using it's checking first the the full",
    "start": "1065400",
    "end": "1071000"
  },
  {
    "text": "password so this is a really good for ofus skate things if you put um B code",
    "start": "1071000",
    "end": "1077280"
  },
  {
    "text": "there Malo japt code you canate it with this and with some tools that are not",
    "start": "1077280",
    "end": "1082919"
  },
  {
    "text": "supporting encryption that can be a problem also for this is what I was",
    "start": "1082919",
    "end": "1090480"
  },
  {
    "text": "mentioned gaps in the in the offsets big objects um characteristic strings this",
    "start": "1090480",
    "end": "1096880"
  },
  {
    "text": "for for antivirus is really harmful if a base exploit has for example a date with",
    "start": "1096880",
    "end": "1103880"
  },
  {
    "text": "hour and seconds some metadata you can use that like a signature to to detect them of",
    "start": "1103880",
    "end": "1111600"
  },
  {
    "text": "course okay so I will continue with the Practical",
    "start": "1112960",
    "end": "1118919"
  },
  {
    "text": "part so I have some offsets three with the info command you can see again the",
    "start": "1118919",
    "end": "1125640"
  },
  {
    "text": "the same summary with the object command you can take a look at the",
    "start": "1125640",
    "end": "1131280"
  },
  {
    "text": "objects and then you can have also row object that in this case it will show",
    "start": "1131280",
    "end": "1137559"
  },
  {
    "text": "the same because you are not seeing any it's not encrypted it's not compressed it's not a stream but um this",
    "start": "1137559",
    "end": "1144679"
  },
  {
    "text": "is useful for example with these filters that you you have seen before with some",
    "start": "1144679",
    "end": "1149760"
  },
  {
    "text": "xmal characters with object you you will see that you will see the content after",
    "start": "1149760",
    "end": "1156080"
  },
  {
    "text": "uh the coding after compressing after decryption and with the RO object file",
    "start": "1156080",
    "end": "1161400"
  },
  {
    "text": "Ro object command or you have also stream and row stream you will see that before all these things before",
    "start": "1161400",
    "end": "1167840"
  },
  {
    "text": "encryption before for the coding so you can have the two views just in case you need it for example if if",
    "start": "1167840",
    "end": "1175360"
  },
  {
    "text": "um if the stream is not decoding correctly it will give an error but you can still see that in the row stream",
    "start": "1175360",
    "end": "1182679"
  },
  {
    "text": "that's an example",
    "start": "1182679",
    "end": "1187720"
  },
  {
    "text": "so uh we can create a",
    "start": "1187760",
    "end": "1194400"
  },
  {
    "text": "command commands file and we can put here some basic",
    "start": "1194400",
    "end": "1201480"
  },
  {
    "text": "commands and this is the the other way to execute the tool like in a batch mode put",
    "start": "1203320",
    "end": "1213360"
  },
  {
    "text": "commands and it's it's executing the commands and just uh",
    "start": "1213360",
    "end": "1219200"
  },
  {
    "text": "stopping okay so this there are like these three",
    "start": "1219200",
    "end": "1225440"
  },
  {
    "text": "modes uh",
    "start": "1225440",
    "end": "1229440"
  },
  {
    "text": "okay so we're going to do to the next",
    "start": "1230520",
    "end": "1235200"
  },
  {
    "text": "one this is a simple file just executing JavaScript code just",
    "start": "1246360",
    "end": "1253480"
  },
  {
    "text": "to for you to see how it's how you can see that in the here",
    "start": "1253480",
    "end": "1259559"
  },
  {
    "text": "and you can see okay this JavaScript code in object four want to execute",
    "start": "1259559",
    "end": "1265240"
  },
  {
    "text": "this like this and then object for you can see the the hello world okay that's",
    "start": "1265240",
    "end": "1273760"
  },
  {
    "text": "the normal execution and you can have some",
    "start": "1273760",
    "end": "1279720"
  },
  {
    "text": "errors at then it won't work by default because it's saying okay I'm detecting",
    "start": "1279799",
    "end": "1286039"
  },
  {
    "text": "this error I cannot follow with the with analysis is but you can use the minus F",
    "start": "1286039",
    "end": "1292559"
  },
  {
    "text": "to to force to continue and ignore the error and you will see the the error",
    "start": "1292559",
    "end": "1297679"
  },
  {
    "text": "here always and that's the it's exactly the",
    "start": "1297679",
    "end": "1303840"
  },
  {
    "text": "same and another way of execute it we have this",
    "start": "1303840",
    "end": "1312400"
  },
  {
    "text": "I don't know",
    "start": "1322559",
    "end": "1325158"
  },
  {
    "text": "why so here H this is malform uh why because there is a tag of to start the",
    "start": "1335440",
    "end": "1343799"
  },
  {
    "text": "the object but there's no end of object uh tag here just here so the tool is",
    "start": "1343799",
    "end": "1350080"
  },
  {
    "text": "thinking that this is just one object and because of that it's just",
    "start": "1350080",
    "end": "1355320"
  },
  {
    "text": "showing one object but we can do another kind of uh parsing and just not look for",
    "start": "1355320",
    "end": "1362520"
  },
  {
    "text": "for the end of tag end of object Tab and that's with the minus",
    "start": "1362520",
    "end": "1368320"
  },
  {
    "text": "l so I always execute the the PDF files with this with minus",
    "start": "1368320",
    "end": "1376360"
  },
  {
    "text": "field so now you can see uh four of them",
    "start": "1376360",
    "end": "1383240"
  },
  {
    "text": "okay [Music] um this is also important I think or at",
    "start": "1385919",
    "end": "1392760"
  },
  {
    "text": "is good to know H you can in the PDF files you can have updates so you can",
    "start": "1392760",
    "end": "1399520"
  },
  {
    "text": "create one PDF file and then modify one object one thing and it will contain uh the old code also the orinal",
    "start": "1399520",
    "end": "1406520"
  },
  {
    "text": "code so in this case for example you have the hello world",
    "start": "1406520",
    "end": "1412240"
  },
  {
    "text": "here but you can see that there are two versions so in object",
    "start": "1412240",
    "end": "1419480"
  },
  {
    "text": "four if you if you execute the command like this object four it's always getting the the latest version but if",
    "start": "1419480",
    "end": "1426440"
  },
  {
    "text": "you um specify the version that you want to see it's object for in the version",
    "start": "1426440",
    "end": "1433840"
  },
  {
    "text": "zero so you will see hidden text and you can say save the first version say save",
    "start": "1433840",
    "end": "1441520"
  },
  {
    "text": "first version k k",
    "start": "1441520",
    "end": "1446960"
  },
  {
    "text": "remember uh and probably it will",
    "start": "1446960",
    "end": "1454879"
  },
  {
    "text": "be here and you will see here the hidden",
    "start": "1454960",
    "end": "1463039"
  },
  {
    "text": "text so this is um a good way to like um extract old versions maybe to find a",
    "start": "1463039",
    "end": "1471159"
  },
  {
    "text": "Content that you want you don't want to publish or something that someone has published the government and it's hidden",
    "start": "1471159",
    "end": "1477279"
  },
  {
    "text": "there or something like",
    "start": "1477279",
    "end": "1480200"
  },
  {
    "text": "that this is funny too so this was like some some years ago when you can when",
    "start": "1484039",
    "end": "1490799"
  },
  {
    "text": "you could use the the lounge you have different actions in a that you can execute in a PDF file you can you use to",
    "start": "1490799",
    "end": "1498399"
  },
  {
    "text": "to be able to launch a command from the system from the PDF file and you can say",
    "start": "1498399",
    "end": "1504240"
  },
  {
    "text": "why I don't know because from the uh perspective of the security is not",
    "start": "1504240",
    "end": "1509360"
  },
  {
    "text": "really useful and also it's really bad but uh it was we could do that some some",
    "start": "1509360",
    "end": "1515279"
  },
  {
    "text": "years ago so someone wrote this PDF file included and execute table and just",
    "start": "1515279",
    "end": "1521320"
  },
  {
    "text": "dropping it to the system and uh starting it so this is the sample the Third",
    "start": "1521320",
    "end": "1530120"
  },
  {
    "text": "exercise and you can see for example so this is what I was mentioned before if the if the information is blue is just",
    "start": "1530120",
    "end": "1537080"
  },
  {
    "text": "informative information if the information is like is yellow orange or",
    "start": "1537080",
    "end": "1542440"
  },
  {
    "text": "a mix of it and it's like it's suspicious so you have to take a look at",
    "start": "1542440",
    "end": "1547720"
  },
  {
    "text": "this H sometimes maybe it's just a false positive but it's good it's good for you",
    "start": "1547720",
    "end": "1553000"
  },
  {
    "text": "to to take a look so in this case for example this is the catalog object and you can see okay",
    "start": "1553000",
    "end": "1559000"
  },
  {
    "text": "there's one action here what is that and also the 13 object you can see also here",
    "start": "1559000",
    "end": "1566039"
  },
  {
    "text": "so you already know that this something that is executing it's executing JavaScript code so you can take a look",
    "start": "1566039",
    "end": "1573360"
  },
  {
    "text": "at the at the object and you can see here export",
    "start": "1573360",
    "end": "1578520"
  },
  {
    "text": "object blah blah blah this is to export and embedded file to the",
    "start": "1578520",
    "end": "1584320"
  },
  {
    "text": "system probably it won't work anymore because I think it's not really",
    "start": "1584320",
    "end": "1590520"
  },
  {
    "text": "secure um so what we can do is for example what is",
    "start": "1590520",
    "end": "1597039"
  },
  {
    "text": "this I'm sorry you can use the search command to",
    "start": "1597480",
    "end": "1603200"
  },
  {
    "text": "search things inside the PDF file okay so it says okay in the",
    "start": "1603200",
    "end": "1609519"
  },
  {
    "text": "version this in the version one you can see this um uh this string in this",
    "start": "1609559",
    "end": "1617679"
  },
  {
    "text": "objects so you can take a look also you can see here this is a launch object a",
    "start": "1617679",
    "end": "1624360"
  },
  {
    "text": "launch uh command so what we can do is take a look at",
    "start": "1624360",
    "end": "1631158"
  },
  {
    "text": "this and what is saying here is if it exist this file go to that directory if",
    "start": "1632600",
    "end": "1639120"
  },
  {
    "text": "it exist that file in this directory go to that directory if it exist go to the",
    "start": "1639120",
    "end": "1645200"
  },
  {
    "text": "directory and then start it so it start in a PDF file that I have exported",
    "start": "1645200",
    "end": "1652080"
  },
  {
    "text": "before but is that a PDF file that's the question so we can check in the embedded",
    "start": "1652080",
    "end": "1658200"
  },
  {
    "text": "files we can go to object n",
    "start": "1658200",
    "end": "1663279"
  },
  {
    "text": "um we can use the references command to see references inside an object and",
    "start": "1663279",
    "end": "1668480"
  },
  {
    "text": "references to an object so you can do for example references",
    "start": "1668480",
    "end": "1674159"
  },
  {
    "text": "to object 10 it's nine you",
    "start": "1674159",
    "end": "1679519"
  },
  {
    "text": "you are seeing this here and references in object nine will be say 10 so this is",
    "start": "1679519",
    "end": "1687640"
  },
  {
    "text": "sometimes useful when you want to go um like back backwards when you see",
    "start": "1687640",
    "end": "1695200"
  },
  {
    "text": "JavaScript and you want to know if it is executed or not like in this case for",
    "start": "1695200",
    "end": "1701240"
  },
  {
    "text": "example we are seeing JavaScript code in object 13 and we can do references to",
    "start": "1701240",
    "end": "1707039"
  },
  {
    "text": "object 13 that's object 8 and that's that was the catalog I was mening before so we know",
    "start": "1707039",
    "end": "1713360"
  },
  {
    "text": "for sure that it's been executed",
    "start": "1713360",
    "end": "1719320"
  },
  {
    "text": "um so we have this we have this",
    "start": "1719640",
    "end": "1726480"
  },
  {
    "text": "this whoop okay so that's doesn't look like a PDF",
    "start": "1726480",
    "end": "1734960"
  },
  {
    "text": "file so what we can do is easily",
    "start": "1734960",
    "end": "1741158"
  },
  {
    "text": "extract for example I want to extract the stream from object uh 12 and I want",
    "start": "1741480",
    "end": "1747559"
  },
  {
    "text": "to store it in a file so the extraction of the of the files or of information",
    "start": "1747559",
    "end": "1754200"
  },
  {
    "text": "from the from the PDF file we can do it with this like bash normal bash R",
    "start": "1754200",
    "end": "1761159"
  },
  {
    "text": "direction we can use also like this to a pen to a file we can use dollar and the",
    "start": "1761159",
    "end": "1768519"
  },
  {
    "text": "redirection to redirect to a variable and we can also use this okay so what we",
    "start": "1768519",
    "end": "1775519"
  },
  {
    "text": "can do for example we going to do two things I'm going to exract this to a variable",
    "start": "1775519",
    "end": "1782279"
  },
  {
    "text": "um PDF for example and I want to extract it also to",
    "start": "1782279",
    "end": "1788440"
  },
  {
    "text": "the uh to",
    "start": "1788440",
    "end": "1792919"
  },
  {
    "text": "this so as usual",
    "start": "1796600",
    "end": "1801559"
  },
  {
    "text": "no so it looks like this is not a PDF file so that was what it was doing",
    "start": "1806679",
    "end": "1813440"
  },
  {
    "text": "extracting the file PDF file to a to on disk and then try to execute it and we",
    "start": "1813440",
    "end": "1819559"
  },
  {
    "text": "have this also in this variable and we can use if I have internet we can use",
    "start": "1819559",
    "end": "1825960"
  },
  {
    "text": "this with a variable BT with",
    "start": "1825960",
    "end": "1831440"
  },
  {
    "text": "this and in theory I have internet so this is shes shes file okay",
    "start": "1831440",
    "end": "1840559"
  },
  {
    "text": "but it's it's nice because you can store information in variables and then use this to to continue with the analysis",
    "start": "1840559",
    "end": "1847760"
  },
  {
    "text": "you have maybe at some point you want to analyze a skates uh of JavaScript and",
    "start": "1847760",
    "end": "1853320"
  },
  {
    "text": "you don't want to use external tools so you can do everything in the inside the tool",
    "start": "1853320",
    "end": "1859880"
  },
  {
    "text": "okay this is really easy here we are seeing the JavaScript",
    "start": "1865480",
    "end": "1871279"
  },
  {
    "text": "code and we are seeing also uh potential vulnerability in object 12 so object 12",
    "start": "1871279",
    "end": "1878320"
  },
  {
    "text": "contain JavaScript code and we can use the command g code",
    "start": "1878320",
    "end": "1884120"
  },
  {
    "text": "to Sol this code okay we can see here the potential vulnerability and all these",
    "start": "1884120",
    "end": "1890919"
  },
  {
    "text": "things by default with the JS an analysis command is going to try to",
    "start": "1890919",
    "end": "1897360"
  },
  {
    "text": "execute the this JavaScript code and if it finds J unescape function it will try",
    "start": "1897360",
    "end": "1904440"
  },
  {
    "text": "to get the content of the the argument sometimes is is not possible but in this",
    "start": "1904440",
    "end": "1910679"
  },
  {
    "text": "case it is so we can do J analyze object",
    "start": "1910679",
    "end": "1916240"
  },
  {
    "text": "12 and we have here the again the JavaScript code and we have the cell",
    "start": "1916240",
    "end": "1921760"
  },
  {
    "text": "code and the cell code we can again store it in a",
    "start": "1921760",
    "end": "1927440"
  },
  {
    "text": "varable and then use the SC test um command that's for emulate the cell code",
    "start": "1927440",
    "end": "1934120"
  },
  {
    "text": "that's pmu so you have to have installed BYU and you can use sest variable",
    "start": "1934120",
    "end": "1942559"
  },
  {
    "text": "sh and it will emulate the the cell code okay you can see here it's getting",
    "start": "1942559",
    "end": "1949919"
  },
  {
    "text": "the the addresses of some functions when SEC exit thre",
    "start": "1949919",
    "end": "1955120"
  },
  {
    "text": "euron and the the funny thing of the good thing of p is that it will try to",
    "start": "1955120",
    "end": "1962120"
  },
  {
    "text": "download also the xay if it finds it so all automatically that is good in this",
    "start": "1962120",
    "end": "1968120"
  },
  {
    "text": "case it's not uh finding anything because the the domains are already offline of course",
    "start": "1968120",
    "end": "1975760"
  },
  {
    "text": "so that was an easy one always is",
    "start": "1978080",
    "end": "1981840"
  },
  {
    "text": "working if you see this and you have not done anything wrong then send me the",
    "start": "1985200",
    "end": "1991440"
  },
  {
    "text": "error please in this case is just an",
    "start": "1991440",
    "end": "1996799"
  },
  {
    "text": "error okay so this is exactly the same as before but containing a different JavaScript code the JavaScript code here",
    "start": "1999559",
    "end": "2006760"
  },
  {
    "text": "is uh this but if we do the exactly the same",
    "start": "2006760",
    "end": "2014000"
  },
  {
    "text": "thing as before try to analyze it we won't get anything really this",
    "start": "2014000",
    "end": "2021320"
  },
  {
    "text": "just showing the original code but it's not doing anything and why is",
    "start": "2021320",
    "end": "2029600"
  },
  {
    "text": "because yes Cod 12",
    "start": "2029600",
    "end": "2034440"
  },
  {
    "text": " so you see here Kate is highlighting the",
    "start": "2054000",
    "end": "2059679"
  },
  {
    "text": "function it's just a function so it's normal that it's not doing anything because it's just a definition of a",
    "start": "2059679",
    "end": "2065480"
  },
  {
    "text": "function but it's not called the function so what you can do is say for",
    "start": "2065480",
    "end": "2071079"
  },
  {
    "text": "example okay so I know this function here but I don't know if",
    "start": "2071079",
    "end": "2076919"
  },
  {
    "text": "it's uh called and where so I can search",
    "start": "2076919",
    "end": "2082520"
  },
  {
    "text": "again and said okay I have this in this",
    "start": "2082520",
    "end": "2087760"
  },
  {
    "text": "objects object one is the catalog and we can see here",
    "start": "2087760",
    "end": "2093240"
  },
  {
    "text": "the open Action so when you open the document it's going to be executed",
    "start": "2093240",
    "end": "2099560"
  },
  {
    "text": "this so now because because you we already have the in the context of the JavaScript engine we have already that",
    "start": "2099560",
    "end": "2105960"
  },
  {
    "text": "function defined you can use you can see that with GH bars with GH bars you can",
    "start": "2105960",
    "end": "2111640"
  },
  {
    "text": "you execute something and you can have access to the JavaScript variables from",
    "start": "2111640",
    "end": "2116760"
  },
  {
    "text": "there so you see that it's it's in the context so you can use Just J",
    "start": "2116760",
    "end": "2123720"
  },
  {
    "text": "analyed code and then you canere your own code new",
    "start": "2123720",
    "end": "2130320"
  },
  {
    "text": "script and it will execute the the function for you this is",
    "start": "2130320",
    "end": "2137000"
  },
  {
    "text": "another uh cell code so we do exactly the same as before we extract it to a",
    "start": "2137000",
    "end": "2142920"
  },
  {
    "text": "variable we do like this and again we have we are trying to",
    "start": "2142920",
    "end": "2150280"
  },
  {
    "text": "download something from a executable and we will later execute",
    "start": "2150280",
    "end": "2156160"
  },
  {
    "text": "it so in this case it was not all automatic but we have to do also some things so analysis",
    "start": "2156160",
    "end": "2162839"
  },
  {
    "text": "thing some manual things so here is the same here we can have we have three",
    "start": "2162839",
    "end": "2168520"
  },
  {
    "text": "objects containing JavaScript code and if we take a look at that this",
    "start": "2168520",
    "end": "2174040"
  },
  {
    "text": "will be PR huge this will be smaller and this will",
    "start": "2174040",
    "end": "2179880"
  },
  {
    "text": "be um okay this is telling me so we have detected automatically because",
    "start": "2179880",
    "end": "2185160"
  },
  {
    "text": "automatically what it does PDF is if there are three different um snippet of",
    "start": "2185160",
    "end": "2190520"
  },
  {
    "text": "code javascrip code it will put it all together and execute it because in this",
    "start": "2190520",
    "end": "2195680"
  },
  {
    "text": "case for example it's really useful and you can say Okay I want to see all and it's not the",
    "start": "2195680",
    "end": "2203079"
  },
  {
    "text": "same so you can have here all the things and you can have the",
    "start": "2203079",
    "end": "2210359"
  },
  {
    "text": "AR so but if you analyze it",
    "start": "2210359",
    "end": "2215920"
  },
  {
    "text": "independently or even if I think if you do like this it says there is an error",
    "start": "2215920",
    "end": "2221640"
  },
  {
    "text": "because the S strr is not defined so you can say okay where is Str",
    "start": "2221640",
    "end": "2227800"
  },
  {
    "text": "Str and Str Str besides the a part of the 36 it's here in",
    "start": "2227800",
    "end": "2235319"
  },
  {
    "text": "35 sorry with us code it will beautify also",
    "start": "2238680",
    "end": "2244440"
  },
  {
    "text": "the code so it's always useful and it's better so so this is the Str Str and Str",
    "start": "2244440",
    "end": "2249599"
  },
  {
    "text": "Str depends on ARR but ARR is not here",
    "start": "2249599",
    "end": "2256200"
  },
  {
    "text": "it's whoop it's in object",
    "start": "2256200",
    "end": "2262720"
  },
  {
    "text": "34 so first you have to execute 34 then you have to execute 35 and then you have",
    "start": "2262720",
    "end": "2268839"
  },
  {
    "text": "to execute 36 to have all in the context of the JavaScript engine so we can do",
    "start": "2268839",
    "end": "2276880"
  },
  {
    "text": "like analyze object 34 then object 35 then object 36 and",
    "start": "2276880",
    "end": "2287880"
  },
  {
    "text": "then you have the next level",
    "start": "2287880",
    "end": "2293079"
  },
  {
    "text": "also what we can do for example is so this is um escape the",
    "start": "2293079",
    "end": "2302440"
  },
  {
    "text": "bytes we can store this in a variable for example",
    "start": "2304599",
    "end": "2310079"
  },
  {
    "text": "my my GS and then do some Replacements we have we have the replace",
    "start": "2310079",
    "end": "2316280"
  },
  {
    "text": "command and we can do some basic Replacements that is really handy I think uh for example uh",
    "start": "2316280",
    "end": "2324280"
  },
  {
    "text": "replace variable my GS and I want to because this is not",
    "start": "2324280",
    "end": "2330839"
  },
  {
    "text": "really useful uh useable I want this to disappear so I have all",
    "start": "2330839",
    "end": "2338640"
  },
  {
    "text": "in all in one line so what I can do is do this I want to H replace this with",
    "start": "2338640",
    "end": "2348400"
  },
  {
    "text": "nothing who mys",
    "start": "2348400",
    "end": "2355160"
  },
  {
    "text": "replace",
    "start": "2355160",
    "end": "2358160"
  },
  {
    "text": "uh h",
    "start": "2362720",
    "end": "2366720"
  },
  {
    "text": "ah okay because with the G analyze if you if you do this if you redirect the",
    "start": "2370359",
    "end": "2376000"
  },
  {
    "text": "output you will redirect the cell code in this case there's no cell code I mean there is cell code but it's not um",
    "start": "2376000",
    "end": "2382640"
  },
  {
    "text": "automatically extractive so what we going we can what we can do really is",
    "start": "2382640",
    "end": "2390839"
  },
  {
    "text": "say J Code no 36",
    "start": "2390839",
    "end": "2397920"
  },
  {
    "text": "and you will extract it to a variable call my yes and I want just the last one",
    "start": "2397920",
    "end": "2407359"
  },
  {
    "text": "and now I'm doing the replacement that should work I'm showing the variable",
    "start": "2407359",
    "end": "2415000"
  },
  {
    "text": "with the command show and I see here this and",
    "start": "2415000",
    "end": "2421839"
  },
  {
    "text": "that's we can work with this we can just copy this",
    "start": "2421839",
    "end": "2428720"
  },
  {
    "text": "and use the G and Escape command now first we're going to create a variable",
    "start": "2428720",
    "end": "2434640"
  },
  {
    "text": "set like Escape it and then we create we paste",
    "start": "2434640",
    "end": "2442920"
  },
  {
    "text": "it and we have that variable there and now with this",
    "start": "2442920",
    "end": "2448280"
  },
  {
    "text": "variable we use the G and Escape",
    "start": "2448280",
    "end": "2452880"
  },
  {
    "text": "command and we have the C code now we can do exactly the same as",
    "start": "2454880",
    "end": "2460560"
  },
  {
    "text": "before put it in a variable and use the S test command to execute it to emulate",
    "start": "2460560",
    "end": "2467520"
  },
  {
    "text": "it okay and you can see the different functions",
    "start": "2467520",
    "end": "2472839"
  },
  {
    "text": "called so this was a bit",
    "start": "2472839",
    "end": "2476920"
  },
  {
    "text": "different um this the catalog this is um a challenge",
    "start": "2478920",
    "end": "2485920"
  },
  {
    "text": "from the H hyet project they put this PDF file and said okay analyze it and send me the",
    "start": "2485920",
    "end": "2493040"
  },
  {
    "text": "the anal the results and it was funny because there",
    "start": "2493040",
    "end": "2499880"
  },
  {
    "text": "was like a uh like a trap because here you can",
    "start": "2499880",
    "end": "2505040"
  },
  {
    "text": "see easily okay in object five there's JavaScript code so this will be there",
    "start": "2505040",
    "end": "2510880"
  },
  {
    "text": "everything so we can take a look at the GS code five",
    "start": "2510880",
    "end": "2517920"
  },
  {
    "text": "and we can see here okay there are something related to annotations this will be the eval",
    "start": "2517920",
    "end": "2526800"
  },
  {
    "text": "code here is getting the annotations of the page zero the first page and here is",
    "start": "2526880",
    "end": "2534920"
  },
  {
    "text": "getting the title when you see something like this this this info title the info",
    "start": "2534920",
    "end": "2542280"
  },
  {
    "text": "object is a metadata object and you can have you can see this here also",
    "start": "2542280",
    "end": "2547760"
  },
  {
    "text": "the info object is the 11 so if we check object 11 this was referencing to info title",
    "start": "2547760",
    "end": "2556880"
  },
  {
    "text": "and in this object we have something that is title and we have object 10",
    "start": "2556880",
    "end": "2562160"
  },
  {
    "text": "which is referencing the object on there so we have something here and it",
    "start": "2562160",
    "end": "2567359"
  },
  {
    "text": "will do something with this okay is getting that content and storing",
    "start": "2567359",
    "end": "2573839"
  },
  {
    "text": "this here so after analyzing this part you can have a a",
    "start": "2573839",
    "end": "2581200"
  },
  {
    "text": "cell code but that's that was not the real cell code why because if you take a look with the with the three command you",
    "start": "2581200",
    "end": "2588640"
  },
  {
    "text": "can see two cataloges in the in the file this was the object",
    "start": "2588640",
    "end": "2595640"
  },
  {
    "text": "five that you can spot easily and this is a vulnerability that's okay but the",
    "start": "2595640",
    "end": "2602240"
  },
  {
    "text": "object 5 is in the downward path of the catalog with ID one",
    "start": "2602240",
    "end": "2608119"
  },
  {
    "text": "however the catalog the real catalog is is the 17 17 27 sorry the 27 so it's not going",
    "start": "2608119",
    "end": "2618720"
  },
  {
    "text": "to execute that Javascript file so we have to take a look at what is",
    "start": "2618720",
    "end": "2625079"
  },
  {
    "text": "here okay and if we take a look",
    "start": "2625079",
    "end": "2630400"
  },
  {
    "text": "again we can see that there is an Acro form there so we can take a look at that",
    "start": "2630400",
    "end": "2636800"
  },
  {
    "text": "c this is normally used to execute JavaScript code so we can take a",
    "start": "2636800",
    "end": "2646880"
  },
  {
    "text": "look this is also really typical for executing to put in",
    "start": "2646880",
    "end": "2653280"
  },
  {
    "text": "the in the xfa form so we can check the object 21 and",
    "start": "2653280",
    "end": "2659440"
  },
  {
    "text": "we can see here a lot of",
    "start": "2659440",
    "end": "2664599"
  },
  {
    "text": " so we can extract this in fact we can exract the just the",
    "start": "2664599",
    "end": "2672000"
  },
  {
    "text": "stream was 21",
    "start": "2672000",
    "end": "2679280"
  },
  {
    "text": "20 so we should have it here",
    "start": "2683119",
    "end": "2690640"
  },
  {
    "text": "okay uh all right 21 yeah I",
    "start": "2690680",
    "end": "2699040"
  },
  {
    "text": "was so",
    "start": "2705680",
    "end": "2713400"
  },
  {
    "text": "y it's a bit slow but you can see here that it's an image th image and this",
    "start": "2714760",
    "end": "2721760"
  },
  {
    "text": "this is base 64 code so what we can do is just have this",
    "start": "2721760",
    "end": "2728640"
  },
  {
    "text": "that base 64 uh chunk and then try to decode it with a with a tool so what I",
    "start": "2728640",
    "end": "2735359"
  },
  {
    "text": "going to do is",
    "start": "2735359",
    "end": "2740680"
  },
  {
    "text": "image uh",
    "start": "2740720",
    "end": "2744040"
  },
  {
    "text": "next it's really slow it's because this this is really",
    "start": "2746599",
    "end": "2753599"
  },
  {
    "text": "huge but even",
    "start": "2753599",
    "end": "2758359"
  },
  {
    "text": "I think it's not doing anything",
    "start": "2773319",
    "end": "2779960"
  },
  {
    "text": "okay I'm trying to remove all the thing if it",
    "start": "2805359",
    "end": "2811400"
  },
  {
    "text": "oh so I want to exactly remove getting with the just obtain the B 64 code but",
    "start": "2838240",
    "end": "2845400"
  },
  {
    "text": "it's because it's really huge in memory I think it's doing it really slow",
    "start": "2845400",
    "end": "2851800"
  },
  {
    "text": "so I think now",
    "start": "2851800",
    "end": "2857079"
  },
  {
    "text": "to work on this okay this going to be",
    "start": "2857079",
    "end": "2866280"
  },
  {
    "text": "easier okay now if I have have done this well should be",
    "start": "2866280",
    "end": "2874359"
  },
  {
    "text": "here B 64 code I will what I can do is use the the code",
    "start": "2874359",
    "end": "2879400"
  },
  {
    "text": "command with the file and store",
    "start": "2879400",
    "end": "2886680"
  },
  {
    "text": "it no and using B",
    "start": "2886680",
    "end": "2891078"
  },
  {
    "text": "64 now we have here a cell code well we have here a some kind of",
    "start": "2892520",
    "end": "2899839"
  },
  {
    "text": "content with out of n that's not SLP so",
    "start": "2899839",
    "end": "2904960"
  },
  {
    "text": "we can store it and and we can execute it and this was the the real malware so",
    "start": "2904960",
    "end": "2913400"
  },
  {
    "text": "this was the the solution not the other one",
    "start": "2913400",
    "end": "2918730"
  },
  {
    "text": "[Music] um okay this is what I was mentioning",
    "start": "2918730",
    "end": "2928160"
  },
  {
    "text": "before about if if you can you find something that is not the downward",
    "start": "2928359",
    "end": "2933960"
  },
  {
    "text": "path of the catalog for example in this case this this is suspicious okay if you do this it's like",
    "start": "2933960",
    "end": "2943000"
  },
  {
    "text": "this is huge okay but this is related to to this",
    "start": "2943000",
    "end": "2949839"
  },
  {
    "text": "vulnerability we have JavaScript code here so we can take a",
    "start": "2949839",
    "end": "2956119"
  },
  {
    "text": "look and it's just keep spraying and it's redirecting to page number",
    "start": "2956119",
    "end": "2963319"
  },
  {
    "text": "two if you take if we take a look at the",
    "start": "2963319",
    "end": "2968559"
  },
  {
    "text": "pages that should [Music]",
    "start": "2968559",
    "end": "2974520"
  },
  {
    "text": "be so there are three pages and we have to go to page number two but two is",
    "start": "2974520",
    "end": "2980280"
  },
  {
    "text": "counting like the zero at the first page so it's will be this",
    "start": "2980280",
    "end": "2985359"
  },
  {
    "text": "one and here we find a reference to object 10",
    "start": "2985359",
    "end": "2991559"
  },
  {
    "text": "that is the the vulnerability but we're going to take a look at this a lonely",
    "start": "2991559",
    "end": "2998640"
  },
  {
    "text": "stream and this in theory it's a stream but if we do like",
    "start": "2998640",
    "end": "3004440"
  },
  {
    "text": "this there's nothing in the Stream so we can take a look with r",
    "start": "3004440",
    "end": "3009960"
  },
  {
    "text": "stream",
    "start": "3010760",
    "end": "3013760"
  },
  {
    "text": "and whop in theory it will be decoded encoded with flight decode that normally",
    "start": "3017040",
    "end": "3023240"
  },
  {
    "text": "it starts with an X here but this is not an X so this is not FL the code this is some something else and you can see like",
    "start": "3023240",
    "end": "3031559"
  },
  {
    "text": "MH with this here a lot of 12s so probably it's it's all with 12 and this",
    "start": "3031559",
    "end": "3038200"
  },
  {
    "text": "looks like maybe a like a binary so what we can do is say okay maybe this is a",
    "start": "3038200",
    "end": "3046079"
  },
  {
    "text": "binary what I going to do is do an X X or root foring against this this roow",
    "start": "3046079",
    "end": "3054559"
  },
  {
    "text": "stream roow stream 12 and I going to look for",
    "start": "3054559",
    "end": "3060839"
  },
  {
    "text": "something it's that it's",
    "start": "3060839",
    "end": "3066799"
  },
  {
    "text": "wh 16 sorry that you normally see in in binaries this program cannot be",
    "start": "3066799",
    "end": "3075559"
  },
  {
    "text": "wrong he's doing the brute force with this stream",
    "start": "3075559",
    "end": "3081040"
  },
  {
    "text": "okay and it's find it that uh with the key 12 you can see something you can see",
    "start": "3087799",
    "end": "3094400"
  },
  {
    "text": "that program uh stream so what you can do is again Ro",
    "start": "3094400",
    "end": "3099880"
  },
  {
    "text": "stream 16 and the key it's 12 and you can store",
    "start": "3099880",
    "end": "3109040"
  },
  {
    "text": "it here",
    "start": "3109040",
    "end": "3113040"
  },
  {
    "text": "so it's the EM the the m is missing but the rest is is okay so this is a really",
    "start": "3124280",
    "end": "3129960"
  },
  {
    "text": "a binary this this was the payload of the of this",
    "start": "3129960",
    "end": "3135280"
  },
  {
    "text": "exploit oh yeah starting flash is is easy also you can search for the just",
    "start": "3140319",
    "end": "3146319"
  },
  {
    "text": "the s swf and you can see okay in version one we have this two objects",
    "start": "3146319",
    "end": "3152319"
  },
  {
    "text": "referencing s swf if you take a look like this it will show you there are",
    "start": "3152319",
    "end": "3158760"
  },
  {
    "text": "four versions it will show you the object um 26 of the latest version but",
    "start": "3158760",
    "end": "3165480"
  },
  {
    "text": "you want the version one so it's like this and this is",
    "start": "3165480",
    "end": "3171559"
  },
  {
    "text": "okay 41 and this is uh",
    "start": "3171559",
    "end": "3178040"
  },
  {
    "text": "a flash file you can take a look with just the the",
    "start": "3178040",
    "end": "3185480"
  },
  {
    "text": "stream two in version one or just re",
    "start": "3186040",
    "end": "3193599"
  },
  {
    "text": "to flash and here you can",
    "start": "3193599",
    "end": "3200400"
  },
  {
    "text": "use uh flash dector with",
    "start": "3200400",
    "end": "3207838"
  },
  {
    "text": "so this is working so it's it's extracting correctly the The Flash okay",
    "start": "3231400",
    "end": "3238440"
  },
  {
    "text": "[Music]",
    "start": "3240550",
    "end": "3244059"
  },
  {
    "text": "this is funny because um this is a loop inside the automatically what it does",
    "start": "3248079",
    "end": "3253839"
  },
  {
    "text": "PDF is analyze the JavaScript emulating it in this case there's a loop with some",
    "start": "3253839",
    "end": "3259200"
  },
  {
    "text": "kind of uh Hipp spring and it's it's not going to to finish so what we use is the",
    "start": "3259200",
    "end": "3267000"
  },
  {
    "text": "minus M",
    "start": "3267000",
    "end": "3270680"
  },
  {
    "text": "uh going to kill it and we can use the minus",
    "start": "3280079",
    "end": "3287440"
  },
  {
    "text": "M thing in order to not not analyze automatically the the JavaScript code so",
    "start": "3287440",
    "end": "3293640"
  },
  {
    "text": "you can see the JavaScript code here",
    "start": "3293640",
    "end": "3298240"
  },
  {
    "text": "here and you can extract",
    "start": "3300799",
    "end": "3306920"
  },
  {
    "text": "it and you can remove the part where where it is the the problem problematic",
    "start": "3307839",
    "end": "3314520"
  },
  {
    "text": "thing so so all this here there are like Loops",
    "start": "3314520",
    "end": "3321240"
  },
  {
    "text": "big Loops so we can remove it just to continue with the analysis",
    "start": "3321240",
    "end": "3328319"
  },
  {
    "text": "I think until here is okay",
    "start": "3330760",
    "end": "3337280"
  },
  {
    "text": "and we can try to analyze it",
    "start": "3337280",
    "end": "3341640"
  },
  {
    "text": "now file and we get this new code and with",
    "start": "3342760",
    "end": "3349119"
  },
  {
    "text": "this we will do exactly the same set to a to a variable",
    "start": "3349119",
    "end": "3356400"
  },
  {
    "text": "and with G and Escape of my variable I will get the cell code",
    "start": "3356400",
    "end": "3365680"
  },
  {
    "text": "again so I think now",
    "start": "3366480",
    "end": "3371920"
  },
  {
    "text": "it's okay this is really nice",
    "start": "3372359",
    "end": "3376480"
  },
  {
    "text": "also we have here this nice uh JavaScript code",
    "start": "3380000",
    "end": "3386640"
  },
  {
    "text": "and because of that we can well we can extract",
    "start": "3386640",
    "end": "3392000"
  },
  {
    "text": "it and this is um well in fact sorry I want to extract it but the original one",
    "start": "3398640",
    "end": "3404799"
  },
  {
    "text": "because if not I will have some some problems not the beautified version if",
    "start": "3404799",
    "end": "3411359"
  },
  {
    "text": "not it won't work so I want to",
    "start": "3411359",
    "end": "3417640"
  },
  {
    "text": "remove all this thing I'm not sure if I have something",
    "start": "3417640",
    "end": "3422720"
  },
  {
    "text": "here that's okay so this is um encoding called GS encode just like this I think",
    "start": "3422720",
    "end": "3432480"
  },
  {
    "text": "and I added a command to to try to decode this because you cannot see",
    "start": "3432480",
    "end": "3438559"
  },
  {
    "text": "anything there really so you can use the JJ the code H JJ and code is called so",
    "start": "3438559",
    "end": "3444520"
  },
  {
    "text": "you can do JJ's s GJ the code file my",
    "start": "3444520",
    "end": "3451960"
  },
  {
    "text": "file and just should work so you have the thing",
    "start": "3451960",
    "end": "3458799"
  },
  {
    "text": "here and again you have the the cell code so you can do exactly the same as",
    "start": "3458799",
    "end": "3464359"
  },
  {
    "text": "before but I'm not going to do it because I think it's already a bit",
    "start": "3464359",
    "end": "3470359"
  },
  {
    "text": "late I will do um",
    "start": "3470359",
    "end": "3474960"
  },
  {
    "text": "so this was about analyzing okay besides the receiving PDF exploits with exploit",
    "start": "3477960",
    "end": "3484160"
  },
  {
    "text": "kits I also was receiving this kind this kind of emails so just putting the PDF",
    "start": "3484160",
    "end": "3490839"
  },
  {
    "text": "exploit there for me it was really um funny because I didn't see it before",
    "start": "3490839",
    "end": "3497599"
  },
  {
    "text": "it's not really targeted or nothing like that it's just Distributing this this and it was dropping like C peer to-peer",
    "start": "3497599",
    "end": "3504119"
  },
  {
    "text": "that it was taking down some months ago so you can also receive exploits with",
    "start": "3504119",
    "end": "3511720"
  },
  {
    "text": "email okay forcation I will give just two some",
    "start": "3511720",
    "end": "3517039"
  },
  {
    "text": "some hints um if you want tocate your exploit that you have created with meta exploit or something like that you can",
    "start": "3517039",
    "end": "3523280"
  },
  {
    "text": "remove all the characteristic strings all the metadata H if you are using for example jaas code inside that string",
    "start": "3523280",
    "end": "3531559"
  },
  {
    "text": "object you can encode it with uh with with octal en coding if you use Exel",
    "start": "3531559",
    "end": "3537960"
  },
  {
    "text": "encoding probably you will be detected really easily because I think the St was",
    "start": "3537960",
    "end": "3543280"
  },
  {
    "text": "including that to to Aus skate the PDF files but then meta exploit did it too",
    "start": "3543280",
    "end": "3548680"
  },
  {
    "text": "so all the antivirus companies added that as a as a signature okay so it's",
    "start": "3548680",
    "end": "3554359"
  },
  {
    "text": "better use the octal coding if you are using an stream to to store the JavaScript code the mcrip code then you",
    "start": "3554359",
    "end": "3561160"
  },
  {
    "text": "can use filters and chain it together use parameters compress it and encrypt",
    "start": "3561160",
    "end": "3566520"
  },
  {
    "text": "it Mal form it so I want to do um a quick test with this out",
    "start": "3566520",
    "end": "3573799"
  },
  {
    "text": "ofation this will be and that's the last thing and and",
    "start": "3573799",
    "end": "3579160"
  },
  {
    "text": "finish I wanted to to show also this but I have time that it was the the P that I",
    "start": "3579160",
    "end": "3587359"
  },
  {
    "text": "received so I will use this",
    "start": "3587559",
    "end": "3592599"
  },
  {
    "text": "[Music] okay you",
    "start": "3593470",
    "end": "3599920"
  },
  {
    "text": "can so I have not mentioned really a lot of commands to modify the the the PDF",
    "start": "3602119",
    "end": "3608720"
  },
  {
    "text": "file but you have also some commands to modify the strings the the filters and also to create a PDF file so in in this",
    "start": "3608720",
    "end": "3616119"
  },
  {
    "text": "case we can create a PDF file with open Action",
    "start": "3616119",
    "end": "3625480"
  },
  {
    "text": "executing was alert like",
    "start": "3626319",
    "end": "3633119"
  },
  {
    "text": "high and I save it like I for example it will",
    "start": "3633119",
    "end": "3641640"
  },
  {
    "text": "be probably",
    "start": "3641680",
    "end": "3647079"
  },
  {
    "text": "y let's check if it works so it's showing High okay so this is really",
    "start": "3647079",
    "end": "3653400"
  },
  {
    "text": "basic now what I can do is encrypt it so first let's take a look at the",
    "start": "3653400",
    "end": "3662000"
  },
  {
    "text": "high this will be the app Alert in fact you",
    "start": "3662559",
    "end": "3670200"
  },
  {
    "text": "could see it here no here that's what we",
    "start": "3670200",
    "end": "3679078"
  },
  {
    "text": "have okay I go again and do and ah sorry sorry sorry",
    "start": "3681799",
    "end": "3687760"
  },
  {
    "text": "sorry I will open the high and just do encrypt you",
    "start": "3687760",
    "end": "3694440"
  },
  {
    "text": "see and save it as in",
    "start": "3694440",
    "end": "3699920"
  },
  {
    "text": "PDF if I execute it it say",
    "start": "3701319",
    "end": "3707319"
  },
  {
    "text": "secured because it's encrypted but is with the default password so it's not asking for a password I it's executing",
    "start": "3707319",
    "end": "3714000"
  },
  {
    "text": "the same thing if you take a look with the with editor this",
    "start": "3714000",
    "end": "3719680"
  },
  {
    "text": "time you see something more weird but that's encrypted if it's a",
    "start": "3721960",
    "end": "3729400"
  },
  {
    "text": "huge M JavaScript code for example you you can hide it easily also now you have",
    "start": "3729400",
    "end": "3735359"
  },
  {
    "text": "an incretion PDF file what you can do is create a simple",
    "start": "3735359",
    "end": "3740520"
  },
  {
    "text": "one with uh simple create PDF simple",
    "start": "3740520",
    "end": "3747760"
  },
  {
    "text": "and save it that's good PDF it's not doing anything",
    "start": "3747760",
    "end": "3756038"
  },
  {
    "text": "really but the good thing is that you can use this good file you can use every",
    "start": "3757880",
    "end": "3763400"
  },
  {
    "text": "PDF that you want in order to embed the malicious one okay so we can do ined",
    "start": "3763400",
    "end": "3771640"
  },
  {
    "text": "minus X the minus X will be to execute the malicious PDF file embedded in the",
    "start": "3771640",
    "end": "3777079"
  },
  {
    "text": "good one okay and we have to say we can we want to embed our encrypted file here",
    "start": "3777079",
    "end": "3783920"
  },
  {
    "text": "and we want to save it",
    "start": "3783920",
    "end": "3788599"
  },
  {
    "text": "Ed so we should see",
    "start": "3789240",
    "end": "3794079"
  },
  {
    "text": "here when we execut it instead of seeing the the good one",
    "start": "3796119",
    "end": "3806079"
  },
  {
    "text": "okay I think it's doing something or I don't know what it's",
    "start": "3806880",
    "end": "3811880"
  },
  {
    "text": "doing all because okay no no no no I",
    "start": "3815400",
    "end": "3823200"
  },
  {
    "text": "will think with this is okay if I execute the PDF",
    "start": "3825119",
    "end": "3832160"
  },
  {
    "text": "file well I don't know why it's not working right",
    "start": "3833520",
    "end": "3838559"
  },
  {
    "text": "now I cannot even close it well you have to believe me if you do this this",
    "start": "3844039",
    "end": "3849720"
  },
  {
    "text": "scripts at home you will see it correctly and this in fact you can see there in the bottom you can see ink PDF",
    "start": "3849720",
    "end": "3857520"
  },
  {
    "text": "secure so we have executed the embedded and it's opening the encrypted",
    "start": "3857520",
    "end": "3863839"
  },
  {
    "text": "one okay so that's one one way that you that you could use tocate the",
    "start": "3863839",
    "end": "3869279"
  },
  {
    "text": "code and now I can not use anymore the",
    "start": "3869279",
    "end": "3874319"
  },
  {
    "text": "slides but I will try",
    "start": "3874960",
    "end": "3878799"
  },
  {
    "text": "to it's just the the last one so",
    "start": "3880559",
    "end": "3886119"
  },
  {
    "text": "IOP whoop whoop that's thank you to some people",
    "start": "3886119",
    "end": "3891400"
  },
  {
    "text": "some people that help me to to get some split kits on PDF exploits thanks to",
    "start": "3891400",
    "end": "3897200"
  },
  {
    "text": "angeloa that helped me with the this is the creator of pemu and when I find a Sil that is not running I said hey",
    "start": "3897200",
    "end": "3904079"
  },
  {
    "text": "Angelo is not working can you help me and normally if he has time is really good guy and he does it of course black",
    "start": "3904079",
    "end": "3911240"
  },
  {
    "text": "hat for let me hear let me come here the Arsenal because I started presenting PDF",
    "start": "3911240",
    "end": "3917400"
  },
  {
    "text": "like some some years ago in the Arsenal it was a really good opportunity and in general the Fox8 the research community",
    "start": "3917400",
    "end": "3926039"
  },
  {
    "text": "that is really nice uh okay thank you thank you very much for for attending",
    "start": "3926039",
    "end": "3931119"
  },
  {
    "text": "and if you have some questions probably we can do it later because probably they are waiting for me already and I can",
    "start": "3931119",
    "end": "3938400"
  },
  {
    "text": "have I have here ah also you you you give me good feedback I will give you a t-shirt now that's that's uh that's not",
    "start": "3938400",
    "end": "3945599"
  },
  {
    "text": "good I have some t-shirt here uh not not too much just like five six in different",
    "start": "3945599",
    "end": "3951839"
  },
  {
    "text": "sizes so if if you want H one I will just leave here independently of the",
    "start": "3951839",
    "end": "3957799"
  },
  {
    "text": "feedback you can put me right there okay thank you thank you very much",
    "start": "3957799",
    "end": "3964400"
  }
]