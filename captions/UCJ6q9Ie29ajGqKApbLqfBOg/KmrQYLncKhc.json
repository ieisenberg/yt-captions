[
  {
    "text": "yeah so hi blackhead first of all many thanks to the blackhead team for having me here today I am incredibly excited to",
    "start": "2840",
    "end": "10840"
  },
  {
    "text": "present my research in front of this amazing audience so what can we expect from this",
    "start": "10840",
    "end": "16960"
  },
  {
    "text": "session well as the title suggests we will delve into the details of Zoom zero",
    "start": "16960",
    "end": "22600"
  },
  {
    "text": "touch provisioning exploring how it operates and how we can abuse it for remote attacks on",
    "start": "22600",
    "end": "28560"
  },
  {
    "text": "endpoints in some I will disclose several vulnerabilities in zoom and",
    "start": "28560",
    "end": "33800"
  },
  {
    "text": "certified Hardware that when combined into an exploit chain enable attackers",
    "start": "33800",
    "end": "39200"
  },
  {
    "text": "to remotely compromise arbitrary devices in addition I will demonstrate",
    "start": "39200",
    "end": "44760"
  },
  {
    "text": "the failures of the certified phone window which allowed unauthorized access to highly sensitive information so",
    "start": "44760",
    "end": "51719"
  },
  {
    "text": "welcome to my talk zero touch P but before we begin allow me to",
    "start": "51719",
    "end": "58519"
  },
  {
    "text": "provide a brief introduction my name is m and I work as a senior it security",
    "start": "58519",
    "end": "63640"
  },
  {
    "text": "consultant for a German company called sus I have a profound interest in",
    "start": "63640",
    "end": "68840"
  },
  {
    "text": "analyzing and hacking nearly everything and my research has been presented at various National and international",
    "start": "68840",
    "end": "75280"
  },
  {
    "text": "hacking and infoset conferences now let's discuss my",
    "start": "75280",
    "end": "80920"
  },
  {
    "text": "motivation for conducting this security research as you may already know the",
    "start": "80920",
    "end": "86880"
  },
  {
    "text": "provisioning and Central management of phones and other endpoints are often insecure allowing attackers in the local",
    "start": "86880",
    "end": "94079"
  },
  {
    "text": "network to extract sensitive information or deploy malicious",
    "start": "94079",
    "end": "99799"
  },
  {
    "text": "configurations however these devices are typically located in dedicated and isolated Network areas which limits",
    "start": "99799",
    "end": "106680"
  },
  {
    "text": "their Tech surface but with the rise of cloud communication providers such as Zoom the",
    "start": "106680",
    "end": "113920"
  },
  {
    "text": "situation has changed significantly these providers have become a fundamental part of our daily",
    "start": "113920",
    "end": "119320"
  },
  {
    "text": "work life and are gradually replacing traditional VI installations in certain scenarios",
    "start": "119320",
    "end": "126600"
  },
  {
    "text": "however a soft client is not enough and Hardware such as desk phones or media",
    "start": "126600",
    "end": "131840"
  },
  {
    "text": "gateways are still needed considering this fact I ask",
    "start": "131840",
    "end": "137400"
  },
  {
    "text": "myself how does this work in modern and state-of-the-art Cloud communication",
    "start": "137400",
    "end": "142440"
  },
  {
    "text": "platforms do they face similar problems and another reason for this",
    "start": "142440",
    "end": "148080"
  },
  {
    "text": "research was if is issues or vulnerabilities will be found it affects a ton of users and therefore there's a",
    "start": "148080",
    "end": "155120"
  },
  {
    "text": "huge potential impact so why did I choose Zoom for this",
    "start": "155120",
    "end": "162239"
  },
  {
    "text": "analysis firstly Zoom offers a feature called zot touch",
    "start": "162239",
    "end": "167319"
  },
  {
    "text": "provisioning which enables straightforward device deployment actually this works",
    "start": "167319",
    "end": "173519"
  },
  {
    "text": "automatically and does not require configuring the device which sounded very interesting to",
    "start": "173519",
    "end": "181360"
  },
  {
    "text": "me moreover Z touch provisioning is supported by many devices including",
    "start": "181360",
    "end": "186400"
  },
  {
    "text": "well-known vendors like audio codes Cisco yink and",
    "start": "186400",
    "end": "191599"
  },
  {
    "text": "more and finally there are lots of devices out there that may be affected if vulnerabilities will be",
    "start": "191599",
    "end": "199920"
  },
  {
    "text": "found so to analyze the provisioning mechanism supported Hardware was required and for this I selected the",
    "start": "200159",
    "end": "208040"
  },
  {
    "text": "audio code c450 HD IP phone for several reasons the firmware is publicly",
    "start": "208040",
    "end": "214280"
  },
  {
    "text": "downloadable it supports a zero touch provisioning and it can also be used as a generic zip phone not limited to",
    "start": "214280",
    "end": "222959"
  },
  {
    "text": "zoom so after getting the device and the necessary licenses I started reading the",
    "start": "222959",
    "end": "228120"
  },
  {
    "text": "docs and gathering information about Z SE touch provisioning concept and after this initial step I",
    "start": "228120",
    "end": "235400"
  },
  {
    "text": "had an understanding of how this mechanism Works which can be Illustrated as",
    "start": "235400",
    "end": "241239"
  },
  {
    "text": "follows firstly an administrator adds a new device within zoom's admin panel and",
    "start": "241239",
    "end": "246879"
  },
  {
    "text": "assigns a configuration template or employee and extension to this",
    "start": "246879",
    "end": "253239"
  },
  {
    "text": "device next Zoom communicates with the corresponding vendor redirect service to",
    "start": "253560",
    "end": "258959"
  },
  {
    "text": "initiate the assignment of the device's serial number or Mech address to zoom's provisioning",
    "start": "258959",
    "end": "265520"
  },
  {
    "text": "server now when a phone is started in its factory settings it contacts the",
    "start": "265919",
    "end": "271039"
  },
  {
    "text": "vendor's hardcoded provisioning server URL to check if it has been assigned to a provisioning",
    "start": "271039",
    "end": "278080"
  },
  {
    "text": "service if there is an assignment the vendor redirect service responds with a redirection to zoom's provisioning",
    "start": "278360",
    "end": "286240"
  },
  {
    "text": "server and finally the phone requests configurations from Zoom which delivers",
    "start": "286240",
    "end": "291360"
  },
  {
    "text": "the necessary configurations and instructions based on assignment and the configured",
    "start": "291360",
    "end": "297840"
  },
  {
    "text": "template so the first part of the analysis will cover the vendor redirect service so without further Ado let's get",
    "start": "298560",
    "end": "306919"
  },
  {
    "text": "started a phone in its factory settings sends an HTTP get request including its",
    "start": "306919",
    "end": "311960"
  },
  {
    "text": "Mech address to the vendor server with the host name redirect audoc codes.com",
    "start": "311960",
    "end": "318400"
  },
  {
    "text": "if an assignment for this Mech address is found the redirect service responds with an HTTP redirect for example to",
    "start": "318400",
    "end": "325919"
  },
  {
    "text": "zoom's provisioning server however no authentication is implemented",
    "start": "325919",
    "end": "332680"
  },
  {
    "text": "allowing us to request redirections for other devices by simply changing the",
    "start": "332680",
    "end": "339520"
  },
  {
    "text": "mess consequently I conducted some spot checks and discovered redirections to other",
    "start": "339840",
    "end": "345639"
  },
  {
    "text": "services and some of which included HTTP",
    "start": "345639",
    "end": "351319"
  },
  {
    "text": "credentials furthermore by following these redirections we can find complete device configuration files containing",
    "start": "351880",
    "end": "358560"
  },
  {
    "text": "sensitive information such as system passwords or credentials for zip",
    "start": "358560",
    "end": "363720"
  },
  {
    "text": "services so I strongly advise users of the audio codes redirection server to",
    "start": "363720",
    "end": "369160"
  },
  {
    "text": "check if their configuration files are protected and if self-hosted properly",
    "start": "369160",
    "end": "374960"
  },
  {
    "text": "secured for example by implementing a client uh certificate based authentication as we will see",
    "start": "374960",
    "end": "382800"
  },
  {
    "text": "later what I also found where configuration files stored on the Windows redirect server self which were",
    "start": "383479",
    "end": "390840"
  },
  {
    "text": "also not protected as a result an unauthenticated attacker is capable of extracting",
    "start": "390840",
    "end": "397680"
  },
  {
    "text": "sensitive information and using it for example to authenticate against external",
    "start": "397680",
    "end": "402800"
  },
  {
    "text": "zip services and therefore initiating and receiving phone calls on behalf of the",
    "start": "402800",
    "end": "409520"
  },
  {
    "text": "victim so this first issue exposure of sensitive information to an unauthorized actor is documented in our security",
    "start": "409520",
    "end": "416479"
  },
  {
    "text": "advisory Su 2022 53 and by the way this and all the other",
    "start": "416479",
    "end": "423199"
  },
  {
    "text": "advisories disclosed in the session will be published and available right after the talk all right so let's",
    "start": "423199",
    "end": "430479"
  },
  {
    "text": "continue during the spot checks I also came across sensitive values that look like",
    "start": "430479",
    "end": "436440"
  },
  {
    "text": "that which seemed to be some sort of encryption or",
    "start": "436440",
    "end": "441879"
  },
  {
    "text": "obfuscation however for the phone to process these values it needs to know the encryption routine and the used keys",
    "start": "441879",
    "end": "450440"
  },
  {
    "text": "so to proceed I downloaded the phone's firware to analyze it and hopefully",
    "start": "450440",
    "end": "455520"
  },
  {
    "text": "reverse engineer the string encryption and while analyzing the F",
    "start": "455520",
    "end": "461240"
  },
  {
    "text": "internus and getting an idea of how the system works I discovered that the functions AC decrypt param and decrypt",
    "start": "461240",
    "end": "468199"
  },
  {
    "text": "string from the shared object file lip AC DS3 are imported into several other",
    "start": "468199",
    "end": "473919"
  },
  {
    "text": "essential binaries so I decided to start analyzing",
    "start": "473919",
    "end": "479000"
  },
  {
    "text": "the share object file lip AC DS3 in gitra so let's move on and going down",
    "start": "479000",
    "end": "484919"
  },
  {
    "text": "the rabbit hole first of all the exported function acdm is just a rer function for the",
    "start": "484919",
    "end": "492520"
  },
  {
    "text": "other interesting looking and exported function decrypt string so let's take a closer look at",
    "start": "492520",
    "end": "499800"
  },
  {
    "text": "decrypt string where a function call is made to DS3 crypt after performing some",
    "start": "499800",
    "end": "505720"
  },
  {
    "text": "operations on the given parameters and input string the function DS3 Crypt on the other hand",
    "start": "505720",
    "end": "512719"
  },
  {
    "text": "generates an architecture dependent key schedule and then cause a triple Des function imported from op",
    "start": "512719",
    "end": "519599"
  },
  {
    "text": "SSL so in regard to the op SSL documentation we can rename some",
    "start": "519599",
    "end": "525519"
  },
  {
    "text": "constants and variables giving us a better understanding of the function call and with this knowledge we can",
    "start": "525519",
    "end": "532959"
  },
  {
    "text": "trace back the pointers to the actual key and IV location so here we can see the",
    "start": "532959",
    "end": "539200"
  },
  {
    "text": "hardcoded IV and key for the Triple desk encryption within the binary lip AC",
    "start": "539200",
    "end": "546120"
  },
  {
    "text": "DS3 next I extracted these values from the binary using DD and wrote a small proof of concept",
    "start": "546800",
    "end": "554000"
  },
  {
    "text": "script to decrypt the encrypted values so here you can see the execution",
    "start": "554000",
    "end": "560200"
  },
  {
    "text": "of the script and the decrypted password from the found configuration file and yes the password quality leaves",
    "start": "560200",
    "end": "567000"
  },
  {
    "text": "much to be desired in addition to device and zip specific",
    "start": "567000",
    "end": "572440"
  },
  {
    "text": "credentials I also found encrypted credentials like this one on the vendor server which I am now able to",
    "start": "572440",
    "end": "580120"
  },
  {
    "text": "decrypt and these credentials appear to be used for audio quote Services itself",
    "start": "580120",
    "end": "586600"
  },
  {
    "text": "which makes the impact of this issue even worse so this use of hardcoded",
    "start": "586600",
    "end": "592519"
  },
  {
    "text": "cryptography key is documented in the shown security advisory but one what I also found in my",
    "start": "592519",
    "end": "599959"
  },
  {
    "text": "spot checks were configuration files that were completely",
    "start": "599959",
    "end": "605040"
  },
  {
    "text": "encrypted however it turned out that a different encription method and key is used for these configuration files",
    "start": "605040",
    "end": "612360"
  },
  {
    "text": "compared to the key shown in the previous slides so to gain a better understanding",
    "start": "612360",
    "end": "618519"
  },
  {
    "text": "I referred to the documentation and found this section here the vendor recommends",
    "start": "618519",
    "end": "624920"
  },
  {
    "text": "encrypting the configuration files using their propietary tool called encryption tool.exe",
    "start": "624920",
    "end": "632480"
  },
  {
    "text": "and the purpose of this encryption is to protect the data from unauthorized access during transmission over unsecure",
    "start": "632480",
    "end": "640839"
  },
  {
    "text": "networks unfortunately I did not have access to the reference tool encryption",
    "start": "640839",
    "end": "645959"
  },
  {
    "text": "tool.exe and therefore I had to dig deeper into the fir interace of the",
    "start": "645959",
    "end": "652680"
  },
  {
    "text": "phone so during this and while analyzing the configuration update process I",
    "start": "652680",
    "end": "658680"
  },
  {
    "text": "discovered a the code section inside the shared object file lip",
    "start": "658680",
    "end": "663920"
  },
  {
    "text": "CGI this code section indicated that the binary decryption tool is used for",
    "start": "663920",
    "end": "669200"
  },
  {
    "text": "decrypting configuration files and even in the initial",
    "start": "669200",
    "end": "674639"
  },
  {
    "text": "exclamation of the decryption tool I observed an openess a key derivation function which indicates that the actual",
    "start": "674639",
    "end": "681920"
  },
  {
    "text": "encryption key is derived from a secret and maybe this could be the",
    "start": "681920",
    "end": "687959"
  },
  {
    "text": "secret well let's have a closer look I started at this instruction where",
    "start": "687959",
    "end": "694320"
  },
  {
    "text": "the interesting looking string is handled and its address stored in register R1 subsequently the string is copied",
    "start": "694320",
    "end": "701320"
  },
  {
    "text": "onto the stack using the M Copy function later in the function the",
    "start": "701320",
    "end": "706680"
  },
  {
    "text": "string is further copied into register R3 which is then passed as forth",
    "start": "706680",
    "end": "712360"
  },
  {
    "text": "argument to another function following this function call we",
    "start": "712360",
    "end": "717480"
  },
  {
    "text": "determine that the string is cover into register R7 which is located on the",
    "start": "717480",
    "end": "723399"
  },
  {
    "text": "stack and later in the function register R7 which holds our interesting string is",
    "start": "723399",
    "end": "729399"
  },
  {
    "text": "passed as fourth argument to the imported op ssf function byes to",
    "start": "729399",
    "end": "735399"
  },
  {
    "text": "key so again in regard to the openi documentation it can be confirmed that",
    "start": "735399",
    "end": "740959"
  },
  {
    "text": "the fourth parameter is the buffer from which the key is derived thus our orig original",
    "start": "740959",
    "end": "747760"
  },
  {
    "text": "assumption was confirmed and a 64 character long string is used to derive the encryption",
    "start": "747760",
    "end": "753639"
  },
  {
    "text": "key so finally we can trace back the location of the hardcoded secret within the",
    "start": "753639",
    "end": "759000"
  },
  {
    "text": "binary extracting it using DD and since Tripes in CBC mode is used",
    "start": "759000",
    "end": "765720"
  },
  {
    "text": "as encryption algorithm we can simply use the open command line tool to derive the key from",
    "start": "765720",
    "end": "771760"
  },
  {
    "text": "the extracted secret and decrypt the configuration for us the concerning aspect here is",
    "start": "771760",
    "end": "779440"
  },
  {
    "text": "that the vendor recommends using this encryption method to protect the configuration files and transmit them",
    "start": "779440",
    "end": "785440"
  },
  {
    "text": "over unsecure networks however users are often misled",
    "start": "785440",
    "end": "790480"
  },
  {
    "text": "into believing they have a secure solution leading them to store sensitive information such as passwords within",
    "start": "790480",
    "end": "797440"
  },
  {
    "text": "these files and if the transmission of these files is then also done in an un",
    "start": "797440",
    "end": "802839"
  },
  {
    "text": "encrypted way for example via tftp or Blain text http it is easy for an",
    "start": "802839",
    "end": "809920"
  },
  {
    "text": "attacker to gain access to this data due to the static encryption",
    "start": "809920",
    "end": "815279"
  },
  {
    "text": "key so with that we have the second use of hardcoded cryptographic",
    "start": "815279",
    "end": "821560"
  },
  {
    "text": "key so now the vendor redirect service seems to be covered and therefore let's",
    "start": "822519",
    "end": "827839"
  },
  {
    "text": "move on to the stage where a phone requests its configuration from",
    "start": "827839",
    "end": "833079"
  },
  {
    "text": "Zoom once the phone is redirected from the vendor service to zoom it sends an",
    "start": "833399",
    "end": "838440"
  },
  {
    "text": "HD get request to the assign zero touch deployment service however unlike the vendor server",
    "start": "838440",
    "end": "845759"
  },
  {
    "text": "Zoom has implemented an authentication mechanism actually it is a certificate",
    "start": "845759",
    "end": "851720"
  },
  {
    "text": "based authentication also known as Mutual TLS and when we attempt to request the",
    "start": "851720",
    "end": "858519"
  },
  {
    "text": "device configurations ourselves we will get an authentication",
    "start": "858519",
    "end": "864000"
  },
  {
    "text": "error we also can observe this Certificate request made by Zoom for the mutual TS authentication in wihar as",
    "start": "864000",
    "end": "872079"
  },
  {
    "text": "well so to further Analyze This I need to obtain a trusted client",
    "start": "872079",
    "end": "877720"
  },
  {
    "text": "certificate fortunately since we can enable SSH access on the phone itself",
    "start": "877720",
    "end": "882920"
  },
  {
    "text": "and have high permissions on it we can extract the device's client certificate and use it for our own",
    "start": "882920",
    "end": "890480"
  },
  {
    "text": "purposes so by providing the device certificate we are able to obtain the phone's",
    "start": "890480",
    "end": "896880"
  },
  {
    "text": "configuration so now now you may be thinking what will happen if we try to",
    "start": "896880",
    "end": "902519"
  },
  {
    "text": "request the configuration of other devices can we uh access configurations",
    "start": "902519",
    "end": "909240"
  },
  {
    "text": "and consequently foreign credentials simply by using the extract the client certificate of my",
    "start": "909240",
    "end": "917000"
  },
  {
    "text": "phone however I must disappoint you it's not that simple and there is more to the",
    "start": "917000",
    "end": "922720"
  },
  {
    "text": "authentication process than just adjust the client certificate in fact in fact the",
    "start": "922720",
    "end": "929120"
  },
  {
    "text": "authentication is only successful if the certificate attributes match the requested configuration suest the",
    "start": "929120",
    "end": "934880"
  },
  {
    "text": "certificate serial number this means it's not possible to request configurations of other devices",
    "start": "934880",
    "end": "941880"
  },
  {
    "text": "unless you possess the correct client certificate and since the certificate",
    "start": "941880",
    "end": "947040"
  },
  {
    "text": "has to be signed by the vendor it's a showstopper and just for further tests I",
    "start": "947040",
    "end": "953440"
  },
  {
    "text": "reimplemented this exact certificate based authentication in my lab so in the examp shown you can see a pseudo engin X",
    "start": "953440",
    "end": "960839"
  },
  {
    "text": "configuration that validates the certificate serial number against the HTTP parameter",
    "start": "960839",
    "end": "967160"
  },
  {
    "text": "serial which could be implemented in a similar way within",
    "start": "967160",
    "end": "972360"
  },
  {
    "text": "Zoom so to conclude this stage it seems to be a secure implementation and",
    "start": "972560",
    "end": "978000"
  },
  {
    "text": "unauthorized access to configuration files is not possible but there is more to have a",
    "start": "978000",
    "end": "984319"
  },
  {
    "text": "closer look on it so let's take a closer look at the first step of the device",
    "start": "984319",
    "end": "990720"
  },
  {
    "text": "deployment to add the device inside zoom's admin panel the mech address of the device has to be entered and a",
    "start": "990720",
    "end": "996959"
  },
  {
    "text": "configuration template can be assigned this template allows for various configurations such as",
    "start": "996959",
    "end": "1003680"
  },
  {
    "text": "customizing keys on the phone's display but also more malicious",
    "start": "1003680",
    "end": "1010000"
  },
  {
    "text": "configurations such as instructions to download a new firmware image from an attacker controled",
    "start": "1010000",
    "end": "1016279"
  },
  {
    "text": "server and to verify this I added my device in the zoom admin panel and",
    "start": "1016279",
    "end": "1021519"
  },
  {
    "text": "assigned this Eva configuration template and now through the zot touch",
    "start": "1021519",
    "end": "1026839"
  },
  {
    "text": "provisioning mechanism my malicious instructions were delivered to the phone and since the settings in the",
    "start": "1026839",
    "end": "1033199"
  },
  {
    "text": "configuration template are added to the end of the complete configuration the malicious firmware update instructions",
    "start": "1033199",
    "end": "1039400"
  },
  {
    "text": "override any previous update instructions so after booting the phone",
    "start": "1039400",
    "end": "1045160"
  },
  {
    "text": "in factory settings I actually received an http request for the fil image from",
    "start": "1045160",
    "end": "1050960"
  },
  {
    "text": "the phone on my server and as you may have",
    "start": "1050960",
    "end": "1056440"
  },
  {
    "text": "noticed the only thing we have to do to enroll malicious configurations to endpoints is to add their Mech addresses",
    "start": "1056440",
    "end": "1063240"
  },
  {
    "text": "inside zo's admin panel so here we can see the vendor redirection before we added this dumy",
    "start": "1063240",
    "end": "1070160"
  },
  {
    "text": "Mech address to our Zoom instance actually there aren't any",
    "start": "1070160",
    "end": "1076720"
  },
  {
    "text": "redirections and here we can see the new redirection after we added the device to",
    "start": "1076720",
    "end": "1081919"
  },
  {
    "text": "zoom this means that I am able to add foreign devices to my zoom",
    "start": "1081919",
    "end": "1087520"
  },
  {
    "text": "instance and another issue that comes with that is that even if the ledit user",
    "start": "1087520",
    "end": "1092880"
  },
  {
    "text": "adds the device afterwards the initial device assignment will not be",
    "start": "1092880",
    "end": "1098480"
  },
  {
    "text": "overwritten and therefore once I have added the device I maintain control over",
    "start": "1098480",
    "end": "1103720"
  },
  {
    "text": "the assignment so the attack scenario becomes",
    "start": "1103720",
    "end": "1108880"
  },
  {
    "text": "clear we add foreign devices via zoom's admin panel the phone will download and",
    "start": "1108880",
    "end": "1114679"
  },
  {
    "text": "execute the instructions from the deployed malicious configuration template and hopefully we can gain",
    "start": "1114679",
    "end": "1121120"
  },
  {
    "text": "remote control over the phone however to deploy malicious",
    "start": "1121120",
    "end": "1126559"
  },
  {
    "text": "firware images we need to determine if there is any firmware signature verification conducted by the",
    "start": "1126559",
    "end": "1133400"
  },
  {
    "text": "device so let's move on to the phone itself to verify if any firmware",
    "start": "1133400",
    "end": "1140000"
  },
  {
    "text": "verification is in place I flipped a bit inside a valid firmware image and uploaded it to the",
    "start": "1140000",
    "end": "1146480"
  },
  {
    "text": "phone unfortunately the phone responded with an error message indicating a fa CC",
    "start": "1146480",
    "end": "1154320"
  },
  {
    "text": "operation so I started analyzing the update process which is handled by this script that executes the executable file",
    "start": "1154440",
    "end": "1161960"
  },
  {
    "text": "named flasher starting analyzing the Flasher binary the extended user of L stands out",
    "start": "1161960",
    "end": "1169960"
  },
  {
    "text": "to me so typically when L is used to jump to different offsets within the firmware",
    "start": "1169960",
    "end": "1177559"
  },
  {
    "text": "it suggests that the firmware consists of different parts or",
    "start": "1177559",
    "end": "1182519"
  },
  {
    "text": "sections so by analyzing the Flasher binary and looking uh at the firm rare",
    "start": "1182840",
    "end": "1188039"
  },
  {
    "text": "in a hexed tutorial at the same time a repeating pattern was",
    "start": "1188039",
    "end": "1193320"
  },
  {
    "text": "observed so here we can see this pattern and after further reverse",
    "start": "1193320",
    "end": "1198480"
  },
  {
    "text": "engineering The Firm rare structure could be reconstructed so the repeated pattern is",
    "start": "1198480",
    "end": "1205000"
  },
  {
    "text": "some sort of a magic value indicating the start of a section it is followed by a 4 by header size the actual section",
    "start": "1205000",
    "end": "1213679"
  },
  {
    "text": "name and the most important part a simple check sum containing the sum of",
    "start": "1213679",
    "end": "1218760"
  },
  {
    "text": "all bytes of a section and after after the fare",
    "start": "1218760",
    "end": "1224760"
  },
  {
    "text": "structure is known the following sections were found inside the analyzed f image of the AIO quotes IP phone a FW",
    "start": "1224760",
    "end": "1231679"
  },
  {
    "text": "header containing meta information such as version build time and so on the boot",
    "start": "1231679",
    "end": "1237159"
  },
  {
    "text": "loader the root file system of the phone another X4 file system the section map",
    "start": "1237159",
    "end": "1243280"
  },
  {
    "text": "of the firmware an updated version of the Flasher binary some release information and an",
    "start": "1243280",
    "end": "1251000"
  },
  {
    "text": "endsection so to test my assumption that a simple check sum is used for fare verification I extracted the root file",
    "start": "1251200",
    "end": "1258440"
  },
  {
    "text": "system resized it mounted it on my local system and created a small file named",
    "start": "1258440",
    "end": "1265159"
  },
  {
    "text": "cp. txt then I unmounted the file system",
    "start": "1265159",
    "end": "1270360"
  },
  {
    "text": "reassembled the fim image and most importantly recalculated the checksum in",
    "start": "1270360",
    "end": "1275600"
  },
  {
    "text": "the root FS section header then I was a little excited while",
    "start": "1275600",
    "end": "1281120"
  },
  {
    "text": "uploading this manipulated fim image to the phone but in fact the update went",
    "start": "1281120",
    "end": "1286760"
  },
  {
    "text": "through without any errors and a previously created file sup. txt can be",
    "start": "1286760",
    "end": "1292039"
  },
  {
    "text": "found on the phone remember the CC errow well there is no CC it's just a",
    "start": "1292039",
    "end": "1300400"
  },
  {
    "text": "simple sum of all bytes of a section so this missing immutable roote",
    "start": "1300400",
    "end": "1306039"
  },
  {
    "text": "of trust is documented in our security advisory suus 2022",
    "start": "1306039",
    "end": "1312200"
  },
  {
    "text": "55 but to make things more sophisticated I created this small script which uses",
    "start": "1312799",
    "end": "1318840"
  },
  {
    "text": "telet for living off the land and creating a revers sh to the ateka server this file is then stored under",
    "start": "1318840",
    "end": "1326279"
  },
  {
    "text": "slh home/ I phone SL scripts so that it is executed by the phone doing system",
    "start": "1326279",
    "end": "1332559"
  },
  {
    "text": "boot this file is then added to the fim image as previously seen and provided on",
    "start": "1332559",
    "end": "1338679"
  },
  {
    "text": "my own server via HTTP the phone's Mech address is then added to zoom and the configuration",
    "start": "1338679",
    "end": "1345760"
  },
  {
    "text": "template is assigned which instructs the phone to download and install the manipulated fil image from my",
    "start": "1345760",
    "end": "1353320"
  },
  {
    "text": "server and after booting the phone in factory settings the firmware was pulled and",
    "start": "1353320",
    "end": "1359279"
  },
  {
    "text": "installed by the phone and finally a root shell pops up on my",
    "start": "1359279",
    "end": "1364440"
  },
  {
    "text": "server so this entire exploit or attack chain can be Illustrated as",
    "start": "1364440",
    "end": "1371039"
  },
  {
    "text": "follows an attacker defines a configuration template that instructs the phone to download malicious firmware",
    "start": "1371039",
    "end": "1377240"
  },
  {
    "text": "from the attacker server then the attacker adds foreign Mac addresses via zoom's admin panel and",
    "start": "1377240",
    "end": "1384559"
  },
  {
    "text": "assigns a configuration template to them Zoom then creates redirections for",
    "start": "1384559",
    "end": "1390480"
  },
  {
    "text": "these devices at the vendor redirect service subsequently when a phone in",
    "start": "1390480",
    "end": "1396320"
  },
  {
    "text": "factory settings requests redirections from the vendor server the redirect",
    "start": "1396320",
    "end": "1401640"
  },
  {
    "text": "server responds with a redirection to zoom then the device requests its",
    "start": "1401640",
    "end": "1407159"
  },
  {
    "text": "configuration from zoom and the configurations including the malicious instructions were",
    "start": "1407159",
    "end": "1414440"
  },
  {
    "text": "delivered the phone then downloads and installs the malicious F image from the attacker controlled",
    "start": "1414440",
    "end": "1421039"
  },
  {
    "text": "server and finally theer gains remote control over the phone without ever",
    "start": "1421039",
    "end": "1426400"
  },
  {
    "text": "physically touching the device or establishing a direct network communication to it",
    "start": "1426400",
    "end": "1432919"
  },
  {
    "text": "beforehand however manually adding Mech addresses in the admin panel is a bit tough but there is a nice solution for",
    "start": "1433600",
    "end": "1441440"
  },
  {
    "text": "this as well we can leverage zo's import function to import a list of Mech",
    "start": "1441440",
    "end": "1448559"
  },
  {
    "text": "addresses so after providing a CSV file containing all the mech addresses we want to",
    "start": "1448559",
    "end": "1453799"
  },
  {
    "text": "import they will appear in the devices list and are assigned to our",
    "start": "1453799",
    "end": "1459600"
  },
  {
    "text": "instance and throughout my research I did not identify any limitations on the number of devices that can be added",
    "start": "1459600",
    "end": "1467039"
  },
  {
    "text": "which was also confirmed by Zoom consequently you can import the",
    "start": "1467039",
    "end": "1472320"
  },
  {
    "text": "complete Mech address space from the supported vendors such as audio quotes in our",
    "start": "1472320",
    "end": "1477919"
  },
  {
    "text": "case this means every time audio quotes device is in factory settings for",
    "start": "1477919",
    "end": "1483440"
  },
  {
    "text": "example a new device or a device that has been reseted can be",
    "start": "1483440",
    "end": "1489840"
  },
  {
    "text": "compromised so finally this unverified ownership in Zoom enables and moreover",
    "start": "1489919",
    "end": "1495679"
  },
  {
    "text": "scales to describe the tech in addition to gaining the reverse shell",
    "start": "1495679",
    "end": "1502600"
  },
  {
    "text": "I've added some more yeah let's say features to the F image for example we",
    "start": "1502600",
    "end": "1508760"
  },
  {
    "text": "obviously can use the device for East dropping or initiating calls on behalf",
    "start": "1508760",
    "end": "1515200"
  },
  {
    "text": "of the victim so now it's time to discuss the",
    "start": "1515200",
    "end": "1520880"
  },
  {
    "text": "potential attack scenarios as we have already seen an external attacker can gain remote",
    "start": "1520880",
    "end": "1527360"
  },
  {
    "text": "control all over the phone but he is also able to eastrop for example on rooms without the victim",
    "start": "1527360",
    "end": "1536799"
  },
  {
    "text": "noticing next and in my opinion the worst attack scenario is",
    "start": "1537000",
    "end": "1542760"
  },
  {
    "text": "pooting typically these devices are located in local networks for example in the internal corporate network of your",
    "start": "1542760",
    "end": "1550440"
  },
  {
    "text": "company and since these devices usually have extensive network communication",
    "start": "1550440",
    "end": "1555679"
  },
  {
    "text": "capabilities an attacker can turn through the compromised devices to attack the Chason",
    "start": "1555679",
    "end": "1562000"
  },
  {
    "text": "Network in practice this could involve attacking the company's active directory infrastructure and launch a ransomware",
    "start": "1562000",
    "end": "1569480"
  },
  {
    "text": "campaign for example additionally an attacker can build a large bot net using compromis",
    "start": "1569480",
    "end": "1578480"
  },
  {
    "text": "devices so it's essential to remember that our anales covered only one certified vendor similar issues may",
    "start": "1578679",
    "end": "1585600"
  },
  {
    "text": "exist in other Zoom certified and approv Hardware which may also could be compromised by the super touch",
    "start": "1585600",
    "end": "1591480"
  },
  {
    "text": "provisioning mechanism so what is the state of the vulnerabilities found for the hardcore",
    "start": "1591480",
    "end": "1598960"
  },
  {
    "text": "key issues the vendor implemented functions to Define individual secrets from which the actual encryption key is",
    "start": "1598960",
    "end": "1605399"
  },
  {
    "text": "then derived from unfortunately for the missing firware verification there isn't a",
    "start": "1605399",
    "end": "1612480"
  },
  {
    "text": "solution provided yet it is not fixed and the vendor responded that it it is",
    "start": "1612480",
    "end": "1617720"
  },
  {
    "text": "on the road map for the end of the [Music] year so what about the exposure of",
    "start": "1617720",
    "end": "1623679"
  },
  {
    "text": "sensitive information to an unauthorized actor well this issue is not completely",
    "start": "1623679",
    "end": "1630480"
  },
  {
    "text": "fixed the vendor implemented a mutual TS authentication for the redirect",
    "start": "1630480",
    "end": "1636640"
  },
  {
    "text": "server however Mutual TS is optional and not enabled by default therefore I recommend enabling",
    "start": "1636640",
    "end": "1644080"
  },
  {
    "text": "this by yourself regardless to that I again recommend checking if configuration",
    "start": "1644080",
    "end": "1650279"
  },
  {
    "text": "files are still remain unprotected on customer service by their",
    "start": "1650279",
    "end": "1656120"
  },
  {
    "text": "own but what about the most important finding the unverified ownership which",
    "start": "1656159",
    "end": "1661200"
  },
  {
    "text": "enables and describe the uh and scales to describe the text",
    "start": "1661200",
    "end": "1667080"
  },
  {
    "text": "scenario well it was a long back and forth in the end Su mentioned that all forms of a client side verification for",
    "start": "1667080",
    "end": "1674559"
  },
  {
    "text": "example in the form of a one-time password or upload loing the client certificates to suum to prove the",
    "start": "1674559",
    "end": "1680159"
  },
  {
    "text": "ownership contradicts the design decision of the zero touch provisioning I also advised suum that",
    "start": "1680159",
    "end": "1687440"
  },
  {
    "text": "sensitive configurations such as downloading firmware from foreign servers should not be",
    "start": "1687440",
    "end": "1693399"
  },
  {
    "text": "allowed and this was finally implemented and confirmed by zum last",
    "start": "1693399",
    "end": "1699600"
  },
  {
    "text": "week zum also told me that they plan to introduce other measures later in the year such as limiting the number of",
    "start": "1699600",
    "end": "1706840"
  },
  {
    "text": "unassigned devices that can be added or monitoring for",
    "start": "1706840",
    "end": "1711840"
  },
  {
    "text": "abuse regardless to that I have two additional major and general recommendations for",
    "start": "1712240",
    "end": "1717720"
  },
  {
    "text": "you if you're using Zoom certified Hardware doesn't matter which vendor it is verify if there is any redirection in",
    "start": "1717720",
    "end": "1725159"
  },
  {
    "text": "place provided by the vendor redirect servers furthermore they only allow the",
    "start": "1725159",
    "end": "1730679"
  },
  {
    "text": "necessary network communications for such devices this means if your device do not",
    "start": "1730679",
    "end": "1736200"
  },
  {
    "text": "need to communicate to these cloud services it should also not be",
    "start": "1736200",
    "end": "1741919"
  },
  {
    "text": "possible so let me conclude this session during the security analysis we identified multiple vulnerabilities in",
    "start": "1742519",
    "end": "1749240"
  },
  {
    "text": "sums and audio quotes provisioning concept as well as in certified Hardware when combined they can be used",
    "start": "1749240",
    "end": "1756600"
  },
  {
    "text": "to remotely take over arbitrary devices given the scalability of this",
    "start": "1756600",
    "end": "1761760"
  },
  {
    "text": "attack it poses a significant security risk in addition we found under",
    "start": "1761760",
    "end": "1767399"
  },
  {
    "text": "protected sensitive data such as credentials which could be accessed even if they are",
    "start": "1767399",
    "end": "1774760"
  },
  {
    "text": "encrypted and now the takeaways first and foremost devices",
    "start": "1775279",
    "end": "1780840"
  },
  {
    "text": "such as desk phones still have an insufficient level of security and every time such devices",
    "start": "1780840",
    "end": "1786720"
  },
  {
    "text": "come across to you especially within exposed or cloud services you should",
    "start": "1786720",
    "end": "1791919"
  },
  {
    "text": "have a closer look at them next automated provisioning services are lucrative targets for",
    "start": "1791919",
    "end": "1798760"
  },
  {
    "text": "attackers and if vulnerable pose a major security risk which should be considered",
    "start": "1798760",
    "end": "1803919"
  },
  {
    "text": "by organizations of all sizes I would also like to point out that this talk of course is not intended",
    "start": "1803919",
    "end": "1811360"
  },
  {
    "text": "uh to blame the manufacturers involved rather I want to show the risks that can",
    "start": "1811360",
    "end": "1816480"
  },
  {
    "text": "arise when traditional devices such as phones are combined with cloud provisioning",
    "start": "1816480",
    "end": "1823000"
  },
  {
    "text": "services and the third takeaway even if you find vulnerabilities that are not rated as a high- risk itself can lead",
    "start": "1823000",
    "end": "1830760"
  },
  {
    "text": "into a significant security issue when combined so finally combine",
    "start": "1830760",
    "end": "1836720"
  },
  {
    "text": "vulnerabilities for the win [Applause]",
    "start": "1836720",
    "end": "1847640"
  },
  {
    "text": "thanks",
    "start": "1847640",
    "end": "1850640"
  }
]