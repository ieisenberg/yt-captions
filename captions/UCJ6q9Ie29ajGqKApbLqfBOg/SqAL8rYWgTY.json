[
  {
    "text": "hello everyone I have encountered issue",
    "start": "5080",
    "end": "8200"
  },
  {
    "text": "with my Visa application therefore I'm",
    "start": "8200",
    "end": "11240"
  },
  {
    "text": "unable to attend the presentation in",
    "start": "11240",
    "end": "13679"
  },
  {
    "text": "person so I pre-record this video and",
    "start": "13679",
    "end": "17760"
  },
  {
    "text": "here we go I'm going to talk about ample",
    "start": "17760",
    "end": "21840"
  },
  {
    "text": "AP ample user FS which means running",
    "start": "21840",
    "end": "25400"
  },
  {
    "text": "file system code in user space I will",
    "start": "25400",
    "end": "28640"
  },
  {
    "text": "give a overview of the implementation of",
    "start": "28640",
    "end": "31480"
  },
  {
    "text": "user fs and share some one vulnerability",
    "start": "31480",
    "end": "35719"
  },
  {
    "text": "that I have discovered in",
    "start": "35719",
    "end": "38360"
  },
  {
    "text": "it I am panting f a security researcher",
    "start": "38360",
    "end": "42399"
  },
  {
    "text": "from andt security ler lab I mainly",
    "start": "42399",
    "end": "45680"
  },
  {
    "text": "focus on iOS and microwave security I",
    "start": "45680",
    "end": "49600"
  },
  {
    "text": "attended black hat in 2021 as a speaker",
    "start": "49600",
    "end": "54000"
  },
  {
    "text": "I'm glad I could attend black hat",
    "start": "54000",
    "end": "57719"
  },
  {
    "text": "again in my previous talk I shared a f",
    "start": "57719",
    "end": "61399"
  },
  {
    "text": "system vulnerabil it is a local",
    "start": "61399",
    "end": "64280"
  },
  {
    "text": "privilege iscap bu since iOS and Mac",
    "start": "64280",
    "end": "68360"
  },
  {
    "text": "share code B I assumed that this SP",
    "start": "68360",
    "end": "71680"
  },
  {
    "text": "should work on iOS to but I was wrong",
    "start": "71680",
    "end": "76680"
  },
  {
    "text": "the same POC doesn't crash iOS now I",
    "start": "76680",
    "end": "80720"
  },
  {
    "text": "noticed that iOS handled F system in a",
    "start": "80720",
    "end": "84400"
  },
  {
    "text": "different manner introducing a new",
    "start": "84400",
    "end": "87520"
  },
  {
    "text": "mechanism called user asss it is",
    "start": "87520",
    "end": "90560"
  },
  {
    "text": "possible that user FS prevents this",
    "start": "90560",
    "end": "94640"
  },
  {
    "text": "vulnerability but it can't be",
    "start": "94640",
    "end": "97880"
  },
  {
    "text": "certain at the time I was unsure whether",
    "start": "97880",
    "end": "101119"
  },
  {
    "text": "this SP affected iOS or not so I ended",
    "start": "101119",
    "end": "105200"
  },
  {
    "text": "it to my Todo list however the real know",
    "start": "105200",
    "end": "108960"
  },
  {
    "text": "too means narrow",
    "start": "108960",
    "end": "111960"
  },
  {
    "text": "to but this time things are a little",
    "start": "111960",
    "end": "115399"
  },
  {
    "text": "different two years later I'm still",
    "start": "115399",
    "end": "118119"
  },
  {
    "text": "curious about why the this buug didn't",
    "start": "118119",
    "end": "120719"
  },
  {
    "text": "work on iOS I finally finally make up my",
    "start": "120719",
    "end": "124439"
  },
  {
    "text": "mind to figure this out I spent some",
    "start": "124439",
    "end": "127479"
  },
  {
    "text": "time studying user FS extensively it",
    "start": "127479",
    "end": "130959"
  },
  {
    "text": "turns out that this buug does indeed",
    "start": "130959",
    "end": "133840"
  },
  {
    "text": "affect OS as well in a different",
    "start": "133840",
    "end": "137440"
  },
  {
    "text": "way all right let's get started on",
    "start": "137440",
    "end": "141440"
  },
  {
    "text": "today's topic user FS firstly uh what",
    "start": "141440",
    "end": "145840"
  },
  {
    "text": "exactly is user FS emple introduced a",
    "start": "145840",
    "end": "149840"
  },
  {
    "text": "file manager app called files in iOS 11",
    "start": "149840",
    "end": "154280"
  },
  {
    "text": "which allows users to access files St on",
    "start": "154280",
    "end": "157879"
  },
  {
    "text": "external USB FL drives according to the",
    "start": "157879",
    "end": "161040"
  },
  {
    "text": "Ione user guide it supports various FY",
    "start": "161040",
    "end": "165080"
  },
  {
    "text": "term forat including the commonly used F",
    "start": "165080",
    "end": "168720"
  },
  {
    "text": "32 F Sy term but when analyzing iOS Cel",
    "start": "168720",
    "end": "173840"
  },
  {
    "text": "cat I found that only apfs and HFS Cort",
    "start": "173840",
    "end": "179280"
  },
  {
    "text": "were PR present there is no Ms do kernel",
    "start": "179280",
    "end": "182879"
  },
  {
    "text": "extension in kernel which is the back",
    "start": "182879",
    "end": "185920"
  },
  {
    "text": "end of fat and ex f file",
    "start": "185920",
    "end": "190120"
  },
  {
    "text": "system instead empo implements the fan",
    "start": "190120",
    "end": "193840"
  },
  {
    "text": "file system as a PL in the form of dite",
    "start": "193840",
    "end": "198239"
  },
  {
    "text": "running in user space you can find all",
    "start": "198239",
    "end": "201280"
  },
  {
    "text": "supported file system plugins under user",
    "start": "201280",
    "end": "204200"
  },
  {
    "text": "F framework but the plins are not the",
    "start": "204200",
    "end": "208000"
  },
  {
    "text": "SLE components of us",
    "start": "208000",
    "end": "210560"
  },
  {
    "text": "F this image provides a comprehensive",
    "start": "210560",
    "end": "214400"
  },
  {
    "text": "overview of user FS including ARS",
    "start": "214400",
    "end": "218519"
  },
  {
    "text": "chronal extension a set of demons xpc",
    "start": "218519",
    "end": "222840"
  },
  {
    "text": "services framework and fyter plins most",
    "start": "222840",
    "end": "227560"
  },
  {
    "text": "of them R in user space user FS is",
    "start": "227560",
    "end": "232920"
  },
  {
    "text": "designed with to work with external",
    "start": "232920",
    "end": "237360"
  },
  {
    "text": "storage devices so let's Begin by",
    "start": "237360",
    "end": "240439"
  },
  {
    "text": "connecting a external hard drive to our",
    "start": "240439",
    "end": "243879"
  },
  {
    "text": "iPhone ma",
    "start": "243879",
    "end": "246360"
  },
  {
    "text": "this our iOS launchd registers a launch",
    "start": "246360",
    "end": "250599"
  },
  {
    "text": "event USB device attached for user FSD G",
    "start": "250599",
    "end": "256040"
  },
  {
    "text": "so when connecting a USB drive to iPhone",
    "start": "256040",
    "end": "259759"
  },
  {
    "text": "launchd detects a i kit event that we",
    "start": "259759",
    "end": "264320"
  },
  {
    "text": "want to add a removable block storage",
    "start": "264320",
    "end": "267440"
  },
  {
    "text": "device to iPhone it then launches user",
    "start": "267440",
    "end": "270720"
  },
  {
    "text": "FSD demon to handle this",
    "start": "270720",
    "end": "274400"
  },
  {
    "text": "event last user FSD STS it registers a",
    "start": "274400",
    "end": "278759"
  },
  {
    "text": "calland for I media matching",
    "start": "278759",
    "end": "281440"
  },
  {
    "text": "notification the X new kernel finishes",
    "start": "281440",
    "end": "284320"
  },
  {
    "text": "creating device file for the USB drive",
    "start": "284320",
    "end": "287520"
  },
  {
    "text": "it will send an i i kit notification",
    "start": "287520",
    "end": "291120"
  },
  {
    "text": "user FSD receives this notification at",
    "start": "291120",
    "end": "294360"
  },
  {
    "text": "new disk named d uh dis three is a t",
    "start": "294360",
    "end": "299600"
  },
  {
    "text": "next the corank function attempts to",
    "start": "299600",
    "end": "302199"
  },
  {
    "text": "mount this dis by calling an Objective C",
    "start": "302199",
    "end": "305479"
  },
  {
    "text": "method called live Mount and disk I",
    "start": "305479",
    "end": "309759"
  },
  {
    "text": "discovered that the M dis method is",
    "start": "309759",
    "end": "312639"
  },
  {
    "text": "simply a delegate method it connects to",
    "start": "312639",
    "end": "315600"
  },
  {
    "text": "an xpc service called uvfs service and",
    "start": "315600",
    "end": "319360"
  },
  {
    "text": "makes a xpc Cod create volumes for the",
    "start": "319360",
    "end": "323199"
  },
  {
    "text": "device to for to perform the mount",
    "start": "323199",
    "end": "327360"
  },
  {
    "text": "operation let's go to the defition of",
    "start": "327360",
    "end": "330120"
  },
  {
    "text": "this method in UV FS Service First it",
    "start": "330120",
    "end": "333759"
  },
  {
    "text": "creates a raw device object RW means",
    "start": "333759",
    "end": "337160"
  },
  {
    "text": "manipulating the device file as a normal",
    "start": "337160",
    "end": "339960"
  },
  {
    "text": "binary file then it numerous plugins",
    "start": "339960",
    "end": "343880"
  },
  {
    "text": "located under user FS framework",
    "start": "343880",
    "end": "346800"
  },
  {
    "text": "directory and the initialized them each",
    "start": "346800",
    "end": "349960"
  },
  {
    "text": "plugin provides a FS Ops struct which",
    "start": "349960",
    "end": "354880"
  },
  {
    "text": "represents the file system operations it",
    "start": "354880",
    "end": "358479"
  },
  {
    "text": "support",
    "start": "358479",
    "end": "360120"
  },
  {
    "text": "the plugin use test routine to determine",
    "start": "360120",
    "end": "363759"
  },
  {
    "text": "if it understands the on disk file",
    "start": "363759",
    "end": "367560"
  },
  {
    "text": "system format if this plugin supports",
    "start": "367560",
    "end": "371199"
  },
  {
    "text": "this RW device and finds a vol volume",
    "start": "371199",
    "end": "374039"
  },
  {
    "text": "with scy volumes routin it proceeds if",
    "start": "374039",
    "end": "377199"
  },
  {
    "text": "not moves on to the next plugin Next",
    "start": "377199",
    "end": "380479"
  },
  {
    "text": "Step ufs service create a mount client",
    "start": "380479",
    "end": "384560"
  },
  {
    "text": "to perform the actual volume mounting",
    "start": "384560",
    "end": "387919"
  },
  {
    "text": "the mount volume m is another remote xpc",
    "start": "387919",
    "end": "392120"
  },
  {
    "text": "Core Lile provider D provides the",
    "start": "392120",
    "end": "395840"
  },
  {
    "text": "implementation of this xpc C so at this",
    "start": "395840",
    "end": "400599"
  },
  {
    "text": "point control is passed to Lile provider",
    "start": "400599",
    "end": "404280"
  },
  {
    "text": "d uh following the cross deack I found a",
    "start": "404280",
    "end": "407840"
  },
  {
    "text": "familiar command line tool s SP mon",
    "start": "407840",
    "end": "412000"
  },
  {
    "text": "however this time the command name is",
    "start": "412000",
    "end": "415120"
  },
  {
    "text": "Mount",
    "start": "415120",
    "end": "416319"
  },
  {
    "text": "RS this tool is a simple m cor ramper it",
    "start": "416319",
    "end": "420680"
  },
  {
    "text": "passes i fs as the file system type",
    "start": "420680",
    "end": "424280"
  },
  {
    "text": "argument for the month this cor I",
    "start": "424280",
    "end": "427039"
  },
  {
    "text": "believe this is the final step in",
    "start": "427039",
    "end": "429840"
  },
  {
    "text": "mounting a USB drive as a user FS",
    "start": "429840",
    "end": "434680"
  },
  {
    "text": "volume finally the ex band volume is",
    "start": "434879",
    "end": "438919"
  },
  {
    "text": "Success successfully mounted the",
    "start": "438919",
    "end": "441759"
  },
  {
    "text": "contents of the dis appears at mobile",
    "start": "441759",
    "end": "444840"
  },
  {
    "text": "Library La files F system. user FSD this",
    "start": "444840",
    "end": "449599"
  },
  {
    "text": "is a special directory all external",
    "start": "449599",
    "end": "453160"
  },
  {
    "text": "storage devices will be mared and here",
    "start": "453160",
    "end": "456800"
  },
  {
    "text": "now we can access files on this EX for",
    "start": "456800",
    "end": "461080"
  },
  {
    "text": "ex fan fored USB hard",
    "start": "461080",
    "end": "463960"
  },
  {
    "text": "drive okay the process of mounting a",
    "start": "463960",
    "end": "466919"
  },
  {
    "text": "user FS volume can be summarized like",
    "start": "466919",
    "end": "469960"
  },
  {
    "text": "like this compared with the classic",
    "start": "469960",
    "end": "473120"
  },
  {
    "text": "mount it is slightly more",
    "start": "473120",
    "end": "476840"
  },
  {
    "text": "complex now that we understand how to",
    "start": "476840",
    "end": "480440"
  },
  {
    "text": "mount a user FS volume let's step",
    "start": "480440",
    "end": "483280"
  },
  {
    "text": "further and study how to access file",
    "start": "483280",
    "end": "485919"
  },
  {
    "text": "where user FS we often write code like",
    "start": "485919",
    "end": "489520"
  },
  {
    "text": "this use open C Cod to get a file",
    "start": "489520",
    "end": "493319"
  },
  {
    "text": "descriptor uh this is the typical",
    "start": "493319",
    "end": "496720"
  },
  {
    "text": "batteries of a open c c where this open",
    "start": "496720",
    "end": "501159"
  },
  {
    "text": "is dispatched to we",
    "start": "501159",
    "end": "505159"
  },
  {
    "text": "open under user FS the process is",
    "start": "505159",
    "end": "509360"
  },
  {
    "text": "similar set that the open SE C is",
    "start": "509360",
    "end": "512839"
  },
  {
    "text": "dispatched to RFS V open the following",
    "start": "512839",
    "end": "517959"
  },
  {
    "text": "is a sud code DEC compiled from the RFS",
    "start": "517959",
    "end": "521680"
  },
  {
    "text": "K extension actually V open is a ramper",
    "start": "521680",
    "end": "526360"
  },
  {
    "text": "for RFS open request let's follow code",
    "start": "526360",
    "end": "531080"
  },
  {
    "text": "and examine is",
    "start": "531080",
    "end": "534560"
  },
  {
    "text": "implementation this function allocates a",
    "start": "534560",
    "end": "537279"
  },
  {
    "text": "request for the open C Cor the copy is",
    "start": "537279",
    "end": "540200"
  },
  {
    "text": "necessary parameters to the request body",
    "start": "540200",
    "end": "543320"
  },
  {
    "text": "it also assigns a unique integer ID to",
    "start": "543320",
    "end": "546480"
  },
  {
    "text": "the request which is an important field",
    "start": "546480",
    "end": "549959"
  },
  {
    "text": "that will be discussed later and next",
    "start": "549959",
    "end": "553519"
  },
  {
    "text": "the function ER FS open sent builds a",
    "start": "553519",
    "end": "558440"
  },
  {
    "text": "mac message and send it to S Port this",
    "start": "558440",
    "end": "561800"
  },
  {
    "text": "port is a Buton through get irf port and",
    "start": "561800",
    "end": "566920"
  },
  {
    "text": "the beginning the message ID is is 0x2",
    "start": "566920",
    "end": "571040"
  },
  {
    "text": "A5 which is another important field uh",
    "start": "571040",
    "end": "575560"
  },
  {
    "text": "after sending the M message this",
    "start": "575560",
    "end": "578680"
  },
  {
    "text": "function slips and V for completion of",
    "start": "578680",
    "end": "582560"
  },
  {
    "text": "the request it then EXs return code from",
    "start": "582560",
    "end": "586440"
  },
  {
    "text": "the response and returns it to the",
    "start": "586440",
    "end": "589760"
  },
  {
    "text": "caller now we need to find the aner for",
    "start": "589760",
    "end": "593760"
  },
  {
    "text": "this request let's sad to the context",
    "start": "593760",
    "end": "597640"
  },
  {
    "text": "process L file provided d i noticed that",
    "start": "597640",
    "end": "601800"
  },
  {
    "text": "leile provider D creates a user client",
    "start": "601800",
    "end": "604959"
  },
  {
    "text": "for RFS Chon extension and trying to set",
    "start": "604959",
    "end": "608839"
  },
  {
    "text": "a notification port on it the",
    "start": "608839",
    "end": "611600"
  },
  {
    "text": "corresponding kernel code is the r FS",
    "start": "611600",
    "end": "615240"
  },
  {
    "text": "set ma Port this port is the Sero Port",
    "start": "615240",
    "end": "619880"
  },
  {
    "text": "mentioned earlier therefore L file",
    "start": "619880",
    "end": "622640"
  },
  {
    "text": "provider D serves the actual Handler for",
    "start": "622640",
    "end": "626800"
  },
  {
    "text": "the open",
    "start": "626800",
    "end": "628040"
  },
  {
    "text": "request",
    "start": "628040",
    "end": "629800"
  },
  {
    "text": "L file provider D does a mix server and",
    "start": "629800",
    "end": "633240"
  },
  {
    "text": "V for incoming request I remember this",
    "start": "633240",
    "end": "636760"
  },
  {
    "text": "message ID the M server dispatcher will",
    "start": "636760",
    "end": "640399"
  },
  {
    "text": "dispatch the open request to the",
    "start": "640399",
    "end": "643320"
  },
  {
    "text": "appropriate Handler Bas on the ID uh",
    "start": "643320",
    "end": "648360"
  },
  {
    "text": "zx25 the me Handler expands Arguments",
    "start": "648360",
    "end": "652360"
  },
  {
    "text": "for openes COD from Mac message then Cur",
    "start": "652360",
    "end": "656560"
  },
  {
    "text": "the function RS sent to resolve the file",
    "start": "656560",
    "end": "661800"
  },
  {
    "text": "handle for the fs node it then CS an",
    "start": "661800",
    "end": "665880"
  },
  {
    "text": "Objective C method R open with mode on",
    "start": "665880",
    "end": "670320"
  },
  {
    "text": "FS project in the reply block it sends",
    "start": "670320",
    "end": "674279"
  },
  {
    "text": "the return code of open request to user",
    "start": "674279",
    "end": "677360"
  },
  {
    "text": "client through this method it is a",
    "start": "677360",
    "end": "679880"
  },
  {
    "text": "ramper for I connect corru",
    "start": "679880",
    "end": "683720"
  },
  {
    "text": "method the respond",
    "start": "683720",
    "end": "687600"
  },
  {
    "text": "responding X method for then connect cor",
    "start": "687600",
    "end": "691440"
  },
  {
    "text": "is the method generic reply the RS",
    "start": "691440",
    "end": "696160"
  },
  {
    "text": "request down with the original open CIS",
    "start": "696160",
    "end": "700040"
  },
  {
    "text": "Coler and tells it the result of user",
    "start": "700040",
    "end": "703920"
  },
  {
    "text": "space",
    "start": "703920",
    "end": "705480"
  },
  {
    "text": "CIS I mentioned earlier that the RFS",
    "start": "705480",
    "end": "710639"
  },
  {
    "text": "open c c SS on the request and the wi",
    "start": "710639",
    "end": "714000"
  },
  {
    "text": "for its completion so now it is woke up",
    "start": "714000",
    "end": "717680"
  },
  {
    "text": "and get the result",
    "start": "717680",
    "end": "719519"
  },
  {
    "text": "opening the target file it can continue",
    "start": "719519",
    "end": "723320"
  },
  {
    "text": "execution and return the result to user",
    "start": "723320",
    "end": "726519"
  },
  {
    "text": "space code that I initiates the open",
    "start": "726519",
    "end": "730600"
  },
  {
    "text": "code it seems that I can attempt to",
    "start": "730600",
    "end": "734279"
  },
  {
    "text": "summarize the control flow open core",
    "start": "734279",
    "end": "736760"
  },
  {
    "text": "under user access it looks like this the",
    "start": "736760",
    "end": "740639"
  },
  {
    "text": "user speed program",
    "start": "740639",
    "end": "742839"
  },
  {
    "text": "initialize access to a file in a user FS",
    "start": "742839",
    "end": "745920"
  },
  {
    "text": "volume using open system Cod and I ifs",
    "start": "745920",
    "end": "749720"
  },
  {
    "text": "chal extension takes over the C forwards",
    "start": "749720",
    "end": "753120"
  },
  {
    "text": "the open request to user space demon",
    "start": "753120",
    "end": "755639"
  },
  {
    "text": "live file rather D the demon Ser serves",
    "start": "755639",
    "end": "759720"
  },
  {
    "text": "as the actual Handler converting the",
    "start": "759720",
    "end": "762680"
  },
  {
    "text": "kernel C to user space c but we there is",
    "start": "762680",
    "end": "767199"
  },
  {
    "text": "another problem I found that the control",
    "start": "767199",
    "end": "770199"
  },
  {
    "text": "the control flow doesn't extend to the",
    "start": "770199",
    "end": "773160"
  },
  {
    "text": "file on the user FS dis so I must to",
    "start": "773160",
    "end": "777680"
  },
  {
    "text": "step further",
    "start": "777680",
    "end": "780519"
  },
  {
    "text": "let's continue with this method it also",
    "start": "780519",
    "end": "784079"
  },
  {
    "text": "act as a delegate this method will be",
    "start": "784079",
    "end": "787079"
  },
  {
    "text": "dispatched to mulle file provider",
    "start": "787079",
    "end": "790240"
  },
  {
    "text": "implementation in the case of user ass",
    "start": "790240",
    "end": "793240"
  },
  {
    "text": "the topic of to this talk actual",
    "start": "793240",
    "end": "796600"
  },
  {
    "text": "implementation is this one and class L",
    "start": "796600",
    "end": "801480"
  },
  {
    "text": "FS volum a method II open with mode is",
    "start": "801480",
    "end": "806800"
  },
  {
    "text": "called resides in the UV FS service",
    "start": "806800",
    "end": "811160"
  },
  {
    "text": "process so what does it do actually I",
    "start": "811160",
    "end": "817079"
  },
  {
    "text": "open is simple the main work open C SC",
    "start": "817079",
    "end": "820839"
  },
  {
    "text": "is implemented in R look up uh resoling",
    "start": "820839",
    "end": "825440"
  },
  {
    "text": "vodde for file path is actually L happy",
    "start": "825440",
    "end": "829560"
  },
  {
    "text": "so I will only discuss this R look up",
    "start": "829560",
    "end": "833519"
  },
  {
    "text": "method remember the fs Ops truct it is",
    "start": "833519",
    "end": "838839"
  },
  {
    "text": "exported by user FS plugin the look up",
    "start": "838839",
    "end": "842600"
  },
  {
    "text": "API from user FS plugin is C and if the",
    "start": "842600",
    "end": "847120"
  },
  {
    "text": "file node and we want is successfully",
    "start": "847120",
    "end": "850240"
  },
  {
    "text": "resolved special uvfs node is returned a",
    "start": "850240",
    "end": "854880"
  },
  {
    "text": "uvfs node is the native representation",
    "start": "854880",
    "end": "858680"
  },
  {
    "text": "of a file in user FS it is equivalent to",
    "start": "858680",
    "end": "863040"
  },
  {
    "text": "the stru we note in the chel then The",
    "start": "863040",
    "end": "866920"
  },
  {
    "text": "Objective C ler will create a ramper",
    "start": "866920",
    "end": "870399"
  },
  {
    "text": "called L FS node right U VFS service",
    "start": "870399",
    "end": "875880"
  },
  {
    "text": "replies to the L file provider D using",
    "start": "875880",
    "end": "879480"
  },
  {
    "text": "this",
    "start": "879480",
    "end": "881959"
  },
  {
    "text": "object uh so all questions about how to",
    "start": "882279",
    "end": "886240"
  },
  {
    "text": "access files",
    "start": "886240",
    "end": "887720"
  },
  {
    "text": "while user f are resolved the plugin e",
    "start": "887720",
    "end": "893160"
  },
  {
    "text": "ex that D does the real job for the file",
    "start": "893160",
    "end": "896839"
  },
  {
    "text": "system is cor I have listed some",
    "start": "896839",
    "end": "900079"
  },
  {
    "text": "functions exported by ex Fant PL for",
    "start": "900079",
    "end": "904560"
  },
  {
    "text": "example API e exent read is responsible",
    "start": "904560",
    "end": "908680"
  },
  {
    "text": "for read system CIS cor AP exent right",
    "start": "908680",
    "end": "912880"
  },
  {
    "text": "is responsible for right CIS score and",
    "start": "912880",
    "end": "915560"
  },
  {
    "text": "so",
    "start": "915560",
    "end": "917240"
  },
  {
    "text": "on okay finally I get four control flow",
    "start": "917240",
    "end": "922079"
  },
  {
    "text": "of open c c or user C if you want to",
    "start": "922079",
    "end": "927399"
  },
  {
    "text": "analyze other user f c c other than open",
    "start": "927399",
    "end": "931839"
  },
  {
    "text": "read write for other type of file system",
    "start": "931839",
    "end": "936120"
  },
  {
    "text": "like EFS and the HFS you can use this",
    "start": "936120",
    "end": "940480"
  },
  {
    "text": "image as a guide I believe it should be",
    "start": "940480",
    "end": "945079"
  },
  {
    "text": "useful okay now that we understand how",
    "start": "945079",
    "end": "949040"
  },
  {
    "text": "user FS Works let's get through some",
    "start": "949040",
    "end": "951680"
  },
  {
    "text": "real world one abilities I found the",
    "start": "951680",
    "end": "954279"
  },
  {
    "text": "user FS",
    "start": "954279",
    "end": "955800"
  },
  {
    "text": "subsystem this is the exploit",
    "start": "955800",
    "end": "959120"
  },
  {
    "text": "chronal I mentioned at the beginning it",
    "start": "959120",
    "end": "961639"
  },
  {
    "text": "is caused by a lack of text on",
    "start": "961639",
    "end": "964040"
  },
  {
    "text": "attributing Entry ofs as a result I can",
    "start": "964040",
    "end": "968079"
  },
  {
    "text": "overwrite some dat out data outside",
    "start": "968079",
    "end": "971920"
  },
  {
    "text": "attribute data area for instance the",
    "start": "971920",
    "end": "974839"
  },
  {
    "text": "control field and header of the",
    "start": "974839",
    "end": "978240"
  },
  {
    "text": "struct this is a for for",
    "start": "978240",
    "end": "982319"
  },
  {
    "text": "vulnerability it is about extended file",
    "start": "982319",
    "end": "985800"
  },
  {
    "text": "attribute however exan file syst ter",
    "start": "985800",
    "end": "989319"
  },
  {
    "text": "doesn't support this feature X new",
    "start": "989319",
    "end": "992160"
  },
  {
    "text": "provides a compatible layer the",
    "start": "992160",
    "end": "994800"
  },
  {
    "text": "wonderful code exist in is compatibility",
    "start": "994800",
    "end": "999600"
  },
  {
    "text": "code the logic is similar in user FS but",
    "start": "999600",
    "end": "1003959"
  },
  {
    "text": "the code is completely Rewritten the",
    "start": "1003959",
    "end": "1007480"
  },
  {
    "text": "corresponding code is shown below if",
    "start": "1007480",
    "end": "1010959"
  },
  {
    "text": "Target file system like ex that doesn't",
    "start": "1010959",
    "end": "1014639"
  },
  {
    "text": "support extended attributes left file",
    "start": "1014639",
    "end": "1017440"
  },
  {
    "text": "will create a compatible layer tool",
    "start": "1017440",
    "end": "1020120"
  },
  {
    "text": "named Apple double",
    "start": "1020120",
    "end": "1022920"
  },
  {
    "text": "manager so the first vulnerability is",
    "start": "1022920",
    "end": "1026199"
  },
  {
    "text": "use the fs version of the c l the",
    "start": "1026199",
    "end": "1029160"
  },
  {
    "text": "relevant logic is found in method load",
    "start": "1029160",
    "end": "1033438"
  },
  {
    "text": "at header or class l f as",
    "start": "1033439",
    "end": "1038280"
  },
  {
    "text": "unable the sud code shows that the",
    "start": "1038280",
    "end": "1041720"
  },
  {
    "text": "invalidation of attribute entry ofet is",
    "start": "1041720",
    "end": "1044678"
  },
  {
    "text": "also insufficient so I can overwrite not",
    "start": "1044679",
    "end": "1048600"
  },
  {
    "text": "data members of utable",
    "start": "1048600",
    "end": "1052480"
  },
  {
    "text": "struct now that I know well enough about",
    "start": "1052480",
    "end": "1056440"
  },
  {
    "text": "user FS I can conclude that this kernel",
    "start": "1056440",
    "end": "1060919"
  },
  {
    "text": "buug also impacts iOS but only the user",
    "start": "1060919",
    "end": "1066760"
  },
  {
    "text": "FS code is",
    "start": "1066760",
    "end": "1068880"
  },
  {
    "text": "affected the user FS verion",
    "start": "1068880",
    "end": "1071600"
  },
  {
    "text": "vulnerability still exists in version",
    "start": "1071600",
    "end": "1075240"
  },
  {
    "text": "below iOS",
    "start": "1075240",
    "end": "1077400"
  },
  {
    "text": "16.2 and uh was not fixed until I",
    "start": "1077400",
    "end": "1082360"
  },
  {
    "text": "reported it again I think the root cause",
    "start": "1082360",
    "end": "1086280"
  },
  {
    "text": "of CV",
    "start": "1086280",
    "end": "1088480"
  },
  {
    "text": "2022 uh 428",
    "start": "1088480",
    "end": "1091840"
  },
  {
    "text": "61 is the B fix for user FS lost",
    "start": "1091840",
    "end": "1097200"
  },
  {
    "text": "synchronization with kernel",
    "start": "1097200",
    "end": "1100960"
  },
  {
    "text": "fs and this is the next vulnerability it",
    "start": "1101159",
    "end": "1105360"
  },
  {
    "text": "was found while I was studying user FS",
    "start": "1105360",
    "end": "1109320"
  },
  {
    "text": "it is another xct B in kernel FS this is",
    "start": "1109320",
    "end": "1114200"
  },
  {
    "text": "the patch for this B we can see an extra",
    "start": "1114200",
    "end": "1118520"
  },
  {
    "text": "check was ended and was ended against",
    "start": "1118520",
    "end": "1122559"
  },
  {
    "text": "the offset of resource Fork entry",
    "start": "1122559",
    "end": "1125559"
  },
  {
    "text": "without this check I can overwrite",
    "start": "1125559",
    "end": "1129000"
  },
  {
    "text": "something",
    "start": "1129000",
    "end": "1130799"
  },
  {
    "text": "like this uh this is part of my bu",
    "start": "1130799",
    "end": "1135520"
  },
  {
    "text": "report the ability of this bu is limited",
    "start": "1135520",
    "end": "1138760"
  },
  {
    "text": "it can only override a fif number of",
    "start": "1138760",
    "end": "1142360"
  },
  {
    "text": "Bath Beyond uh 64 Keb kernal Hep buffer",
    "start": "1142360",
    "end": "1148960"
  },
  {
    "text": "for example I can write One Bite SF to",
    "start": "1148960",
    "end": "1153480"
  },
  {
    "text": "the header of an object following the 64",
    "start": "1153480",
    "end": "1156880"
  },
  {
    "text": "KB K buffer this seems like useless but",
    "start": "1156880",
    "end": "1162120"
  },
  {
    "text": "I just happened to read a",
    "start": "1162120",
    "end": "1166360"
  },
  {
    "text": "slide it is p from the AOS Macos chal",
    "start": "1166360",
    "end": "1172080"
  },
  {
    "text": "Tres the author",
    "start": "1172080",
    "end": "1174799"
  },
  {
    "text": "is this guy",
    "start": "1174799",
    "end": "1177600"
  },
  {
    "text": "dier it introduced an amazing te Mage",
    "start": "1177600",
    "end": "1182200"
  },
  {
    "text": "type confusion PRI which only requires",
    "start": "1182200",
    "end": "1185880"
  },
  {
    "text": "one bit over right with this powerful",
    "start": "1185880",
    "end": "1189080"
  },
  {
    "text": "exploit technique I can exploit the",
    "start": "1189080",
    "end": "1192360"
  },
  {
    "text": "second kernel FS X",
    "start": "1192360",
    "end": "1197080"
  },
  {
    "text": "bar the the image shows that I was able",
    "start": "1197080",
    "end": "1200880"
  },
  {
    "text": "to get a root share on Mac",
    "start": "1200880",
    "end": "1205559"
  },
  {
    "text": "12.0.1 but then primitive was patched in",
    "start": "1205760",
    "end": "1209840"
  },
  {
    "text": "L",
    "start": "1209840",
    "end": "1211679"
  },
  {
    "text": "15.2 makes making it difficult to",
    "start": "1211679",
    "end": "1215240"
  },
  {
    "text": "exploit this bug on Mac version higher",
    "start": "1215240",
    "end": "1219120"
  },
  {
    "text": "than 5.1 and",
    "start": "1219120",
    "end": "1223640"
  },
  {
    "text": "13 of course there is a COR bonding Cor",
    "start": "1223640",
    "end": "1228240"
  },
  {
    "text": "responding user access version of this",
    "start": "1228240",
    "end": "1230640"
  },
  {
    "text": "SP the Warner World code can be found in",
    "start": "1230640",
    "end": "1234000"
  },
  {
    "text": "method loot e header of class lb fs and",
    "start": "1234000",
    "end": "1240039"
  },
  {
    "text": "P the user FS logic is the same as",
    "start": "1240039",
    "end": "1244280"
  },
  {
    "text": "kernel FS lanking text on into offsite",
    "start": "1244280",
    "end": "1249200"
  },
  {
    "text": "therefore the user FS is affected by",
    "start": "1249200",
    "end": "1252400"
  },
  {
    "text": "this bag",
    "start": "1252400",
    "end": "1255280"
  },
  {
    "text": "too many people may Wonder",
    "start": "1255480",
    "end": "1259080"
  },
  {
    "text": "if is possible to exploit kernel wi user",
    "start": "1259080",
    "end": "1265320"
  },
  {
    "text": "effect for user speace will be back the",
    "start": "1265320",
    "end": "1269600"
  },
  {
    "text": "Kel version of them have been proved to",
    "start": "1269600",
    "end": "1272600"
  },
  {
    "text": "be exploitable so in theory they they",
    "start": "1272600",
    "end": "1276159"
  },
  {
    "text": "are exploitable though I haven't tried",
    "start": "1276159",
    "end": "1279840"
  },
  {
    "text": "for FAL speace risk condition B it can",
    "start": "1279840",
    "end": "1283360"
  },
  {
    "text": "be converted to a kernel uef well it is",
    "start": "1283360",
    "end": "1287279"
  },
  {
    "text": "very hard to WR work will exploit for it",
    "start": "1287279",
    "end": "1291200"
  },
  {
    "text": "it is exploitable in theory but I didn't",
    "start": "1291200",
    "end": "1295960"
  },
  {
    "text": "try uh because in iOS the sand box is",
    "start": "1295960",
    "end": "1300520"
  },
  {
    "text": "always on app cannot access",
    "start": "1300520",
    "end": "1303880"
  },
  {
    "text": "RS Kel extension directly to solve the",
    "start": "1303880",
    "end": "1308159"
  },
  {
    "text": "problem we can change the user space the",
    "start": "1308159",
    "end": "1311559"
  },
  {
    "text": "user FS will be back with the kernel",
    "start": "1311559",
    "end": "1314640"
  },
  {
    "text": "back and attack kernel indirectly so I",
    "start": "1314640",
    "end": "1319039"
  },
  {
    "text": "think it is possible to attack kernel wi",
    "start": "1319039",
    "end": "1322760"
  },
  {
    "text": "user effect at least in",
    "start": "1322760",
    "end": "1327000"
  },
  {
    "text": "theory next let's talk about the changes",
    "start": "1327000",
    "end": "1331679"
  },
  {
    "text": "in FY term security model in traditional",
    "start": "1331679",
    "end": "1335600"
  },
  {
    "text": "kernel FS assis cor is handled in kernel",
    "start": "1335600",
    "end": "1339080"
  },
  {
    "text": "by file system extension",
    "start": "1339080",
    "end": "1341440"
  },
  {
    "text": "directly in new user FS R FS kernel modu",
    "start": "1341440",
    "end": "1347000"
  },
  {
    "text": "is very simple do forward the CIS to",
    "start": "1347000",
    "end": "1350400"
  },
  {
    "text": "user speed demons a CIS car is actual",
    "start": "1350400",
    "end": "1354200"
  },
  {
    "text": "actually addled in file system plug in",
    "start": "1354200",
    "end": "1357559"
  },
  {
    "text": "though the Coss stack of file system",
    "start": "1357559",
    "end": "1360320"
  },
  {
    "text": "syore is changed lot as a result the M",
    "start": "1360320",
    "end": "1365000"
  },
  {
    "text": "exploit Target tend is to user space",
    "start": "1365000",
    "end": "1367919"
  },
  {
    "text": "demons in user if a b is is successfully",
    "start": "1367919",
    "end": "1372919"
  },
  {
    "text": "exploited in kernel Affair we could",
    "start": "1372919",
    "end": "1376080"
  },
  {
    "text": "directly obtain kernel redate relish but",
    "start": "1376080",
    "end": "1380520"
  },
  {
    "text": "if a user FS bu is exploited we could",
    "start": "1380520",
    "end": "1385120"
  },
  {
    "text": "only take over a Sandbox",
    "start": "1385120",
    "end": "1388520"
  },
  {
    "text": "SBX user space process so user FS will",
    "start": "1388520",
    "end": "1394480"
  },
  {
    "text": "reduce the impact of FS",
    "start": "1394480",
    "end": "1399919"
  },
  {
    "text": "vulnerability in addition to the",
    "start": "1400440",
    "end": "1403600"
  },
  {
    "text": "benefits of user FS there is also some",
    "start": "1403600",
    "end": "1406840"
  },
  {
    "text": "this the one PES user FS is an extra",
    "start": "1406840",
    "end": "1410919"
  },
  {
    "text": "feature it doesn't replace kernel FS",
    "start": "1410919",
    "end": "1414520"
  },
  {
    "text": "kernel FS is still in kernel the attack",
    "start": "1414520",
    "end": "1418559"
  },
  {
    "text": "surface of FS now kernel FS plus over",
    "start": "1418559",
    "end": "1422440"
  },
  {
    "text": "user plus user FS so the attack surface",
    "start": "1422440",
    "end": "1427360"
  },
  {
    "text": "of FS is actually increased but on iOS",
    "start": "1427360",
    "end": "1432799"
  },
  {
    "text": "only apfs and HFS are kept in Cur ex fat",
    "start": "1432799",
    "end": "1438000"
  },
  {
    "text": "it is forced to be handled by user FS",
    "start": "1438000",
    "end": "1442200"
  },
  {
    "text": "actually Kel fs and user FS have almost",
    "start": "1442200",
    "end": "1447159"
  },
  {
    "text": "identical function functionality but",
    "start": "1447159",
    "end": "1450679"
  },
  {
    "text": "ample need to maintain two code bases",
    "start": "1450679",
    "end": "1453559"
  },
  {
    "text": "now it is a challenge that keep keeps",
    "start": "1453559",
    "end": "1457880"
  },
  {
    "text": "back fix in sync between them and the",
    "start": "1457880",
    "end": "1462559"
  },
  {
    "text": "last as I as I analyzed about there is a",
    "start": "1462559",
    "end": "1467880"
  },
  {
    "text": "xpc everywhere in user FS the core pass",
    "start": "1467880",
    "end": "1472000"
  },
  {
    "text": "of user F system core is very long",
    "start": "1472000",
    "end": "1475559"
  },
  {
    "text": "though what about the",
    "start": "1475559",
    "end": "1477600"
  },
  {
    "text": "performance actually compared to CPU USB",
    "start": "1477600",
    "end": "1482120"
  },
  {
    "text": "disc is too slow I think the performance",
    "start": "1482120",
    "end": "1485960"
  },
  {
    "text": "is",
    "start": "1485960",
    "end": "1488399"
  },
  {
    "text": "acceptable okay at last I would say that",
    "start": "1488399",
    "end": "1492360"
  },
  {
    "text": "more modules more BS introducing new",
    "start": "1492360",
    "end": "1495840"
  },
  {
    "text": "features we're also introducing new tag",
    "start": "1495840",
    "end": "1498799"
  },
  {
    "text": "surf tag surfaces there is a chance to",
    "start": "1498799",
    "end": "1502200"
  },
  {
    "text": "break IOS through user FS but when",
    "start": "1502200",
    "end": "1506080"
  },
  {
    "text": "accessing files stored on USB D diss",
    "start": "1506080",
    "end": "1511159"
  },
  {
    "text": "only user FS takes effect in this case",
    "start": "1511159",
    "end": "1514919"
  },
  {
    "text": "user FS can significantly reduce the",
    "start": "1514919",
    "end": "1518480"
  },
  {
    "text": "impact of file system",
    "start": "1518480",
    "end": "1521159"
  },
  {
    "text": "vulnerability so or speaking I think",
    "start": "1521159",
    "end": "1524360"
  },
  {
    "text": "user FS is a successful effort by",
    "start": "1524360",
    "end": "1529559"
  },
  {
    "text": "Apple okay thank you for watching that's",
    "start": "1529559",
    "end": "1533559"
  },
  {
    "text": "all of my talk today I hope you enjoyed",
    "start": "1533559",
    "end": "1536760"
  },
  {
    "text": "it if you have questions you can find me",
    "start": "1536760",
    "end": "1540320"
  },
  {
    "text": "on Twitter thank",
    "start": "1540320",
    "end": "1543639"
  },
  {
    "text": "you",
    "start": "1546120",
    "end": "1549120"
  }
]