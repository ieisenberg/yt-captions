[
  {
    "start": "0",
    "end": "51000"
  },
  {
    "text": "[Music]",
    "start": "910",
    "end": "9400"
  },
  {
    "text": "hi my name is muu and today I'll talk about the Windows Defender especially",
    "start": "9400",
    "end": "15679"
  },
  {
    "text": "the mistifying and bypassing attack of addiction by understanding the AV",
    "start": "15679",
    "end": "22240"
  },
  {
    "text": "signatures so I I'm a sec security researcher working at the NC which is",
    "start": "22439",
    "end": "28439"
  },
  {
    "text": "the French national cver agency and this is why you heard about my terrible French accent my day job is the audit",
    "start": "28439",
    "end": "36520"
  },
  {
    "text": "Pest and sometime R teaming of semi entities and I previously give some",
    "start": "36520",
    "end": "42079"
  },
  {
    "text": "talks about gation and R Eng",
    "start": "42079",
    "end": "47120"
  },
  {
    "text": "tuning such as am so today the subject is attack",
    "start": "47120",
    "end": "53600"
  },
  {
    "start": "51000",
    "end": "51000"
  },
  {
    "text": "stition uh this is a Microsoft featur uh which tends to reduce vulnerabilities",
    "start": "53600",
    "end": "59239"
  },
  {
    "text": "attack surfaces in your application with intelligent rules that help stop",
    "start": "59239",
    "end": "64760"
  },
  {
    "text": "Mar so here are the different world that you can enable um",
    "start": "64760",
    "end": "72880"
  },
  {
    "text": "so soting to investigate so rules such as",
    "start": "72880",
    "end": "80520"
  },
  {
    "text": "BL Office application from cting executable content or block adob readers from creating child processes we can",
    "start": "80520",
    "end": "88000"
  },
  {
    "text": "easily understand why uh uh these rules can be a good thing for an",
    "start": "88000",
    "end": "95439"
  },
  {
    "text": "Defender so the question is about attack Sur solution should we recommend it in",
    "start": "95439",
    "end": "101240"
  },
  {
    "text": "our audit or does it work actually and",
    "start": "101240",
    "end": "106280"
  },
  {
    "text": "um can we bypass it so the first first thing first uh",
    "start": "106280",
    "end": "112439"
  },
  {
    "text": "where is implemented um we have a few ins on the Microsoft sites like requires",
    "start": "112439",
    "end": "118960"
  },
  {
    "text": "Microsoft and different antivirus or is attacks in the fq um",
    "start": "118960",
    "end": "125920"
  },
  {
    "text": "that R was originally inreased as a measure update to Defender so it's",
    "start": "125920",
    "end": "131160"
  },
  {
    "text": "likely in the interent the Microsoft ENT in the",
    "start": "131160",
    "end": "136959"
  },
  {
    "text": "defender um to be more precise uh if you look at prman on msmp engine which is",
    "start": "136959",
    "end": "143720"
  },
  {
    "text": "the process running the defender Interiors uh we can see some uh",
    "start": "143720",
    "end": "150360"
  },
  {
    "text": "grab of registry entry [Music] on so it's slly implemented in the",
    "start": "150360",
    "end": "157879"
  },
  {
    "text": "Windows Defender and the question is how um they able to block ad reader from",
    "start": "157879",
    "end": "164080"
  },
  {
    "text": "creating sh processes for instance is it a collaboration between Microsoft and",
    "start": "164080",
    "end": "170159"
  },
  {
    "text": "Adobe detecting Adobe processes through sins or TR packages no or just kind of",
    "start": "170159",
    "end": "178480"
  },
  {
    "text": "um Regular expression so we try to find out so first I'll just um give you a bit",
    "start": "178480",
    "end": "187519"
  },
  {
    "start": "183000",
    "end": "183000"
  },
  {
    "text": "of um how to reproduce uh this St and go further so I'm kind of tun then we look",
    "start": "187519",
    "end": "196200"
  },
  {
    "text": "at how ISR are actually implemented uh to answer the the",
    "start": "196200",
    "end": "201599"
  },
  {
    "text": "question which just asked and finally uh all the windows Defenders signatures are",
    "start": "201599",
    "end": "207439"
  },
  {
    "text": "made and what kse can be found in this signat databases so first first to first um I",
    "start": "207439",
    "end": "215920"
  },
  {
    "text": "want to you to be able to reprodu this work and I myself based my work on some",
    "start": "215920",
    "end": "223560"
  },
  {
    "start": "220000",
    "end": "220000"
  },
  {
    "text": "previous ones uh such one which has been already presented at black hat uh",
    "start": "223560",
    "end": "231680"
  },
  {
    "text": "it was focusing on the emulator inside the defender anus",
    "start": "231680",
    "end": "238400"
  },
  {
    "start": "237000",
    "end": "237000"
  },
  {
    "text": "um a lot of of um components in the defender such as the fter driver uh the",
    "start": "238400",
    "end": "246640"
  },
  {
    "text": "early launch antim marel uh some interfaces and engine implementation MP engine DL and some vdm",
    "start": "246640",
    "end": "255920"
  },
  {
    "text": "file that you'll see later which are actually the signatures",
    "start": "255920",
    "end": "261079"
  },
  {
    "text": "base uh a lot of pdvr um Sor public",
    "start": "261079",
    "end": "266440"
  },
  {
    "text": "symbols are available for MP engine uh until the last",
    "start": "266440",
    "end": "271919"
  },
  {
    "text": "year and um if you want to analyze a recent version you can as",
    "start": "271919",
    "end": "278639"
  },
  {
    "text": "Med done done for a recent cvu uh just diff the different updates",
    "start": "278639",
    "end": "284880"
  },
  {
    "text": "and understand uh what are the changes and just",
    "start": "284880",
    "end": "290280"
  },
  {
    "text": "datation totally so if you want to focus on MP",
    "start": "290280",
    "end": "298520"
  },
  {
    "text": "engine without the wall Windows system you can just",
    "start": "298520",
    "end": "304160"
  },
  {
    "text": "emulate it and thanks too which release load Library uh you can actually run",
    "start": "304160",
    "end": "311120"
  },
  {
    "text": "32bits mpng mod Linux uh which is really good to instruments or scrap the use of",
    "start": "311120",
    "end": "317960"
  },
  {
    "text": "MP engine and use GTB debuging so on um so example you have the",
    "start": "317960",
    "end": "325680"
  },
  {
    "text": "link um if you want to actually instrument uh this fer uh in a running",
    "start": "325680",
    "end": "331720"
  },
  {
    "start": "326000",
    "end": "326000"
  },
  {
    "text": "Windows uh you need to perform a few steps the first one is that uh msmp uh",
    "start": "331720",
    "end": "338400"
  },
  {
    "text": "is actually PPL so restricted protected light process so",
    "start": "338400",
    "end": "345880"
  },
  {
    "text": "you can remove this bit for instance using Ms and then the Windows Defender Factor",
    "start": "345880",
    "end": "352479"
  },
  {
    "text": "driver actually register some go back to deny you to actually made some um",
    "start": "352479",
    "end": "358639"
  },
  {
    "text": "changes on the process but you can easily n this this Behavior",
    "start": "358639",
    "end": "363720"
  },
  {
    "text": "using a can or the relative symol that you need to to to change um this is end that you",
    "start": "363720",
    "end": "373520"
  },
  {
    "text": "can also obtain on some cheating forms for instance um and this is uh great to",
    "start": "373520",
    "end": "381280"
  },
  {
    "text": "debug or perform some tring for instance using a dbg TTD time travel deer and",
    "start": "381280",
    "end": "388919"
  },
  {
    "text": "then you can o chain this kind of trust which is a a really nice way to",
    "start": "388919",
    "end": "395400"
  },
  {
    "text": "understand what is actually going on and in once",
    "start": "395400",
    "end": "402240"
  },
  {
    "start": "399000",
    "end": "399000"
  },
  {
    "text": "you have your setup you can test your skills uh for instance I released um a",
    "start": "402240",
    "end": "409800"
  },
  {
    "text": "challenge for recent CTF this year which is named the funders which is actually the goal is to reverse a binary which",
    "start": "409800",
    "end": "416560"
  },
  {
    "text": "has been made to run inside the Windows Defender sandbox is use the emulator",
    "start": "416560",
    "end": "422759"
  },
  {
    "text": "interface um and the emulator environment to to run and you have some",
    "start": "422759",
    "end": "428000"
  },
  {
    "text": "write up on it uh you can also perform some vulnerability research",
    "start": "428000",
    "end": "433960"
  },
  {
    "text": "um or I don't know my M sandboxing etw",
    "start": "433960",
    "end": "440400"
  },
  {
    "text": "events like that so now that you know how to instrument uh Windows Defender you will",
    "start": "440400",
    "end": "447759"
  },
  {
    "text": "be hble to reproduce some of my works so I hope you can um you will learn things",
    "start": "447759",
    "end": "455520"
  },
  {
    "text": "in that way so now um back to our subject or are implemented the attex",
    "start": "455520",
    "end": "461240"
  },
  {
    "text": "first prediction rules um so we are trying to find first um where are the",
    "start": "461240",
    "end": "468879"
  },
  {
    "start": "463000",
    "end": "463000"
  },
  {
    "text": "rule implemented actually um the rule are um designed using a unique uid so I",
    "start": "468879",
    "end": "478599"
  },
  {
    "text": "can search that ID and try to find where it's defined first we can try to find it in",
    "start": "478599",
    "end": "485800"
  },
  {
    "text": "the MP which is the main um D of Windows Defender and we don't found anything yet",
    "start": "485800",
    "end": "493919"
  },
  {
    "text": "so we can try to R search uh them in dvdm file but no more",
    "start": "493919",
    "end": "499280"
  },
  {
    "text": "results but if now if you're looking to for the keyword ASR in the code in the",
    "start": "499280",
    "end": "505400"
  },
  {
    "text": "MP gen we can still find a few related method like scps",
    "start": "505400",
    "end": "514159"
  },
  {
    "text": "managers host in prevention manager uh regarding",
    "start": "514159",
    "end": "520680"
  },
  {
    "text": "ASR so now if you try to find where what is Method Al um Can for",
    "start": "520680",
    "end": "529240"
  },
  {
    "text": "instance use the previous uh T dress that we already down and regarding the",
    "start": "529240",
    "end": "535560"
  },
  {
    "text": "call stack on the call site uh we is we EAS indone that is actually um inside",
    "start": "535560",
    "end": "542160"
  },
  {
    "text": "the Lua engine so it seems that the Lua engine is using uh the is is cing things",
    "start": "542160",
    "end": "550440"
  },
  {
    "text": "regarding the HPS manager and things so if we um dig in a bit uh we'll",
    "start": "550440",
    "end": "560279"
  },
  {
    "text": "see that HPS manager has a load rules from database uh function so this seems",
    "start": "560279",
    "end": "566399"
  },
  {
    "text": "very interesting which is then calling in it scripts uh which are um grabbing get",
    "start": "566399",
    "end": "574680"
  },
  {
    "text": "hold info get monitoring locations get pass exclusion and so on uh from the",
    "start": "574680",
    "end": "581000"
  },
  {
    "text": "databases so what we understand from that is that part of full data must be",
    "start": "581000",
    "end": "586160"
  },
  {
    "text": "inside so in DDM file in the form of L scripts so this is interesting and we'll",
    "start": "586160",
    "end": "593920"
  },
  {
    "text": "try to find them that way so we'll use the WD ract a project",
    "start": "593920",
    "end": "601000"
  },
  {
    "start": "596000",
    "end": "596000"
  },
  {
    "text": "which uh just actually decompress vtm files and now that we have decompress",
    "start": "601000",
    "end": "607760"
  },
  {
    "text": "them we can search um the ID inside the file and now we we found them and what",
    "start": "607760",
    "end": "615560"
  },
  {
    "text": "we just um see um um looking around if that's there is",
    "start": "615560",
    "end": "623640"
  },
  {
    "text": "the Ala 5.1 magic so which is the the the header for for Lu compiled",
    "start": "623640",
    "end": "631480"
  },
  {
    "text": "script um and so this is interesting we have the ID of rle and then the Lua",
    "start": "631480",
    "end": "637959"
  },
  {
    "text": "magic of L script so let's try to extract to",
    "start": "637959",
    "end": "645760"
  },
  {
    "text": "scripts and decompile them uh so the first so we extract the compile script",
    "start": "645760",
    "end": "651720"
  },
  {
    "start": "648000",
    "end": "648000"
  },
  {
    "text": "and uh the common project name to actually DEC compile them uh but is that",
    "start": "651720",
    "end": "660279"
  },
  {
    "text": "uh it's not working uh after some Riv and digging uh this is good ref wants to",
    "start": "660279",
    "end": "666680"
  },
  {
    "text": "reproduce it actually the others are not the one expected by LC that be changed",
    "start": "666680",
    "end": "672959"
  },
  {
    "text": "in the defender project and the data structure size are not the same as",
    "start": "672959",
    "end": "678560"
  },
  {
    "text": "expected by the I don't know why maybe the compilation toing is not actually",
    "start": "678560",
    "end": "685279"
  },
  {
    "text": "the same or it has been um customiz a bit I don't know um but",
    "start": "685279",
    "end": "692480"
  },
  {
    "text": "still um if we made to if we perform to change",
    "start": "692480",
    "end": "697760"
  },
  {
    "text": "and um we can write I convers shet which is open source now and and then we can",
    "start": "697760",
    "end": "706800"
  },
  {
    "text": "decompile them so there is an example of what we can found we here we found that rule is",
    "start": "706800",
    "end": "714200"
  },
  {
    "text": "actually uh so is first uh checking the rule is enable uh if not it returns mp.",
    "start": "714200",
    "end": "722440"
  },
  {
    "text": "claim the thing is you can think as mp. claim as like a written zero or written",
    "start": "722440",
    "end": "730560"
  },
  {
    "text": "false um it's not saying that the the Mal under analyze of the candidate under",
    "start": "730560",
    "end": "737839"
  },
  {
    "text": "analyze is actually clean it just saying uh I don't have any more information",
    "start": "737839",
    "end": "743880"
  },
  {
    "text": "into script uh so for there is trying to",
    "start": "743880",
    "end": "750080"
  },
  {
    "text": "[Music] um test if the r a black executable content from",
    "start": "750080",
    "end": "756760"
  },
  {
    "text": "EMA Cent W mail is enable and then why it has been called and then check the",
    "start": "756760",
    "end": "764079"
  },
  {
    "text": "the header to to check if it is actually a zip file",
    "start": "764079",
    "end": "769279"
  },
  {
    "text": "orse so not that we can understand",
    "start": "769279",
    "end": "775199"
  },
  {
    "start": "770000",
    "end": "770000"
  },
  {
    "text": "um or this rule are actually um um made in the US well we can try to",
    "start": "775199",
    "end": "783000"
  },
  {
    "text": "find our the answer to our question so all the uh block ad Adobe Reader from",
    "start": "783000",
    "end": "790399"
  },
  {
    "text": "cating Child processes is actually implemented the question is how the",
    "start": "790399",
    "end": "795920"
  },
  {
    "text": "realation behind is how Defender know that it is uh Adobe",
    "start": "795920",
    "end": "804240"
  },
  {
    "text": "process and the answer is well it's actually um regular",
    "start": "804240",
    "end": "810920"
  },
  {
    "text": "Expressions so you can see the get info that we saw before which G some basic",
    "start": "810920",
    "end": "817279"
  },
  {
    "text": "information regarding the rule and you have a get monitoring locations which just list uh some about what are the um",
    "start": "817279",
    "end": "827240"
  },
  {
    "text": "process to watch the the the file name of the of the process uh to watch so you",
    "start": "827240",
    "end": "834279"
  },
  {
    "text": "have some um a big list of all uh known uh Adobe Reader executables in their",
    "start": "834279",
    "end": "842959"
  },
  {
    "text": "location on your disk actually we can we could have found",
    "start": "842959",
    "end": "848839"
  },
  {
    "start": "845000",
    "end": "845000"
  },
  {
    "text": "this information um in another way um Microsoft is giving a as test tool that",
    "start": "848839",
    "end": "855519"
  },
  {
    "text": "you can follow this link uh which is made to perform some test um",
    "start": "855519",
    "end": "862360"
  },
  {
    "text": "for for instance uh you can say Okay I want to try the rur block injection by",
    "start": "862360",
    "end": "868360"
  },
  {
    "text": "Office application uh then I want to be in the block mode or audit mode I'll run the scenario and",
    "start": "868360",
    "end": "875040"
  },
  {
    "text": "I see is uh if it is actually detected or not the question is how Microsoft is",
    "start": "875040",
    "end": "881839"
  },
  {
    "text": "implemented uh that test tool in just a few megabytes without giving you Office",
    "start": "881839",
    "end": "889839"
  },
  {
    "text": "application and so on so if we have a look at all it mail",
    "start": "889839",
    "end": "896199"
  },
  {
    "start": "892000",
    "end": "892000"
  },
  {
    "text": "it's a net application easy to reverse and and what we can see is that we have",
    "start": "896199",
    "end": "901639"
  },
  {
    "text": "some list of known Office application name and install",
    "start": "901639",
    "end": "907320"
  },
  {
    "text": "location and the tool is actually just um picking these names um and creating",
    "start": "907320",
    "end": "914759"
  },
  {
    "text": "uh notepad um Notepad application in these uh PS",
    "start": "914759",
    "end": "921720"
  },
  {
    "text": "and launching it uh so we have a notepad running with the excel. XZ name for",
    "start": "921720",
    "end": "928240"
  },
  {
    "text": "instance and then uh it ask this process to",
    "start": "928240",
    "end": "933360"
  },
  {
    "text": "create another one and it will trigger the rules uh if uh",
    "start": "933360",
    "end": "939759"
  },
  {
    "text": "excel. XZ is launching another process for instance and this is how the test",
    "start": "939759",
    "end": "945079"
  },
  {
    "text": "tool is actually implemented so it just confirm that the rules are only using",
    "start": "945079",
    "end": "951480"
  },
  {
    "text": "process names and not um actual uh",
    "start": "951480",
    "end": "956920"
  },
  {
    "text": "unforgeable trust uh packages or something like that so Microsoft is a",
    "start": "956920",
    "end": "962600"
  },
  {
    "text": "rare of this isue and they said that they try to end this",
    "start": "962600",
    "end": "970399"
  },
  {
    "text": "Behavior Uh another thing is that sometimes um office and or adobe",
    "start": "971560",
    "end": "977399"
  },
  {
    "text": "application actually needs to launch uh to know to launch a few processes legitimately so how can they do that if",
    "start": "977399",
    "end": "984839"
  },
  {
    "text": "the rules is unable the way it is implemented is that they use an exclusion list um or it it",
    "start": "984839",
    "end": "993680"
  },
  {
    "text": "can be authorized through script logic so uh if you look at uh what are",
    "start": "993680",
    "end": "1001120"
  },
  {
    "text": "actually exclude uh in the RO description um you can understand that",
    "start": "1001120",
    "end": "1008160"
  },
  {
    "text": "if that if the executable that is launched is in this pass then it is okay",
    "start": "1008160",
    "end": "1015319"
  },
  {
    "text": "you can launch it so for instance this is saying that office can launch Office",
    "start": "1015319",
    "end": "1020440"
  },
  {
    "text": "application or I think it's for ad so Adobe Reader can launch Office",
    "start": "1020440",
    "end": "1025678"
  },
  {
    "text": "application it can also launch Internet Explorer uh it can launch foxy software",
    "start": "1025679",
    "end": "1031038"
  },
  {
    "text": "and so on well it can launch a lot of application actually if you look at it",
    "start": "1031039",
    "end": "1037360"
  },
  {
    "text": "you can laun wi windzip operam Firefox",
    "start": "1037360",
    "end": "1043000"
  },
  {
    "text": "um a few Edge application Live meeting uh video and so on and you have a lot of",
    "start": "1043000",
    "end": "1049640"
  },
  {
    "text": "them like a lot of them not bad and so",
    "start": "1049640",
    "end": "1055480"
  },
  {
    "text": "on so in addition to this Ro you have a lot",
    "start": "1055480",
    "end": "1061720"
  },
  {
    "text": "of exclusion lists and then you can also have exclusion from the from R scripts",
    "start": "1061720",
    "end": "1067600"
  },
  {
    "text": "uh question is as an attacker can we abuse these exclusion list uh so let's have a look at Block",
    "start": "1067600",
    "end": "1075080"
  },
  {
    "text": "office application from creating executable contents uh uh the script",
    "start": "1075080",
    "end": "1080280"
  },
  {
    "text": "relative to this Rule and what we can so the first thing that we see in the",
    "start": "1080280",
    "end": "1086600"
  },
  {
    "text": "script is that checking if the rule is enable if not it's early return then",
    "start": "1086600",
    "end": "1093000"
  },
  {
    "text": "trying to um check if the the if it is actually a Block office an office",
    "start": "1093000",
    "end": "1099559"
  },
  {
    "text": "application so this is the get context Office Pro um that uh are is the implementation",
    "start": "1099559",
    "end": "1107080"
  },
  {
    "text": "so you have a list of um common Office application and they",
    "start": "1107080",
    "end": "1113919"
  },
  {
    "text": "um in made in list so just to say",
    "start": "1113919",
    "end": "1119440"
  },
  {
    "text": "categorized actually so just to say that Excel is in productivity Ro so and Link is a",
    "start": "1119440",
    "end": "1125640"
  },
  {
    "text": "communication tool so if the current um uh process which is launch launching",
    "start": "1125640",
    "end": "1133240"
  },
  {
    "text": "another executable is in is in this list and is in productivity category we",
    "start": "1133240",
    "end": "1139679"
  },
  {
    "text": "continue then we have a list of the actual extension that are checked by the script so if you're",
    "start": "1139679",
    "end": "1148000"
  },
  {
    "text": "create creating an a file which ends with one of these extension this is",
    "start": "1148000",
    "end": "1154520"
  },
  {
    "text": "consider as an executable content creation so you have the common script",
    "start": "1154520",
    "end": "1159600"
  },
  {
    "text": "languages you also have Java file but some of are are missing",
    "start": "1159600",
    "end": "1167480"
  },
  {
    "start": "1167000",
    "end": "1167000"
  },
  {
    "text": "so just to be sure that the rule is actually working there is the command line to enable it then I create some",
    "start": "1169760",
    "end": "1178280"
  },
  {
    "text": "basic macro in Excel just saying okay I want to download file uh this is XZ I'm",
    "start": "1178280",
    "end": "1185559"
  },
  {
    "text": "dropping in on the disk and I'm try then to launch it and when I'm when I try to",
    "start": "1185559",
    "end": "1191919"
  },
  {
    "text": "drop it on the disk um the RS R is triggered and as you can as you can see",
    "start": "1191919",
    "end": "1199440"
  },
  {
    "text": "on the bottom right it just saying okay it has been blocked so as expected and you have the",
    "start": "1199440",
    "end": "1205919"
  },
  {
    "text": "corresponding event so now if we look at uh the exclusion which is in the script",
    "start": "1205919",
    "end": "1212559"
  },
  {
    "start": "1208000",
    "end": "1208000"
  },
  {
    "text": "you can see that uh in addition to the exclusion L that we saw before there are",
    "start": "1212559",
    "end": "1218200"
  },
  {
    "text": "also a few exclusion that are in the script so perform dynamically um some of",
    "start": "1218200",
    "end": "1226960"
  },
  {
    "text": "these exclusion are depends on the actual [Music]",
    "start": "1226960",
    "end": "1232640"
  },
  {
    "text": "um extension that you use so if you're using",
    "start": "1232640",
    "end": "1238120"
  },
  {
    "text": "lnk R is the the logic to authorize some and if you continue to look at it uh if",
    "start": "1238120",
    "end": "1245440"
  },
  {
    "text": "you if the extension is dox and anywhere in the path uh you use uh you have the",
    "start": "1245440",
    "end": "1252919"
  },
  {
    "text": "think cell uh string actually a directory named think",
    "start": "1252919",
    "end": "1259200"
  },
  {
    "text": "cell then it's okay so I just ask myself what is the actual",
    "start": "1259200",
    "end": "1265200"
  },
  {
    "text": "think cell it seems to be a company which is uh actually um making",
    "start": "1265200",
    "end": "1271919"
  },
  {
    "text": "um tools for Excel which are injecting in next in Office application or I don't",
    "start": "1271919",
    "end": "1278200"
  },
  {
    "text": "know they actually looking for reverse Engineers this is a good about what the",
    "start": "1278200",
    "end": "1284159"
  },
  {
    "text": "kind of job they're actually doing but okay it's this is um um authorized for um in Defender uh if",
    "start": "1284159",
    "end": "1293919"
  },
  {
    "text": "you are creating ax file in anywhere in a dictor in",
    "start": "1293919",
    "end": "1300720"
  },
  {
    "text": "anywhere uh where you pass contains directory names things sorry uh then",
    "start": "1300720",
    "end": "1306960"
  },
  {
    "text": "it's so let's check for it um you can see that the I'm creating file in a",
    "start": "1306960",
    "end": "1313600"
  },
  {
    "text": "think cell but with only one l u in it is blocked if you change it and create",
    "start": "1313600",
    "end": "1320559"
  },
  {
    "text": "it in a just a directory named think so then the file is created I can lo in and",
    "start": "1320559",
    "end": "1327720"
  },
  {
    "text": "or is there just D test so hey by um actually there are some other",
    "start": "1327720",
    "end": "1334960"
  },
  {
    "start": "1331000",
    "end": "1331000"
  },
  {
    "text": "bypass that are already documented and links um these bypasses doesn't use the",
    "start": "1334960",
    "end": "1340520"
  },
  {
    "text": "same ID they are more related to um the way uh ISR is actually checking things",
    "start": "1340520",
    "end": "1348200"
  },
  {
    "text": "so for instance uh it's checking that an office application is um creating axz so",
    "start": "1348200",
    "end": "1354600"
  },
  {
    "text": "the goal of the bypass is to uh creating an intermate processes which will then",
    "start": "1354600",
    "end": "1360880"
  },
  {
    "text": "create the file for instance uh this is all well documented if you want to to have a look at that",
    "start": "1360880",
    "end": "1368240"
  },
  {
    "text": "but still um my short conclusion here is that even by B exit I think it's could",
    "start": "1368240",
    "end": "1375000"
  },
  {
    "text": "still block an aler about attack ER ATMs so story is the same thing if you want",
    "start": "1375000",
    "end": "1381880"
  },
  {
    "text": "to see it attackers let's start by just removing uh the ones that we can catch",
    "start": "1381880",
    "end": "1387080"
  },
  {
    "text": "that way remove the the noises",
    "start": "1387080",
    "end": "1393120"
  },
  {
    "start": "1393000",
    "end": "1393000"
  },
  {
    "text": "actually if you look if still look at at the rules are just a few aties that I",
    "start": "1393120",
    "end": "1399000"
  },
  {
    "text": "want to show with you so for instance here the pass exclusion for control folder access R uh you have teams in it",
    "start": "1399000",
    "end": "1407480"
  },
  {
    "text": "the Microsoft teams so it is okay for teams to to make change uh the update the updator of",
    "start": "1407480",
    "end": "1416240"
  },
  {
    "text": "teams is weight listed for the T you have some hidden rules like the AL",
    "start": "1416240",
    "end": "1424080"
  },
  {
    "text": "plat test for ISR ISR um which is likely",
    "start": "1424080",
    "end": "1429919"
  },
  {
    "text": "um a test rule but it is in prodution you can enable it or you are some tests",
    "start": "1429919",
    "end": "1436960"
  },
  {
    "text": "also for few domain test test domain of Microsoft you also have not yet",
    "start": "1436960",
    "end": "1443960"
  },
  {
    "text": "published fors when I performed this work early this year uh the black abuse",
    "start": "1443960",
    "end": "1449440"
  },
  {
    "text": "of in the wild exploited vulnerable signed drivers was a rule which wasn't",
    "start": "1449440",
    "end": "1455120"
  },
  {
    "text": "yet published but already in the in the defender so we can s this world before",
    "start": "1455120",
    "end": "1462799"
  },
  {
    "text": "it was actually presented uh no know it's published so",
    "start": "1462799",
    "end": "1469480"
  },
  {
    "text": "no more uh you can also look at the Block",
    "start": "1469480",
    "end": "1475080"
  },
  {
    "text": "exit table content from email client in Webmail and ask yourself what are what is an web mail for Microsoft Defender",
    "start": "1475080",
    "end": "1484320"
  },
  {
    "text": "and if you look at it's it mail actually there is a method which is nam eway mail",
    "start": "1484320",
    "end": "1491520"
  },
  {
    "text": "download Ur and if you look at it it's actually checking if you are coming from",
    "start": "1491520",
    "end": "1497240"
  },
  {
    "text": "mail. Google or Outlook or Y Mail and if",
    "start": "1497240",
    "end": "1502840"
  },
  {
    "text": "so then your web mail and then it will consider to block",
    "start": "1502840",
    "end": "1508840"
  },
  {
    "text": "executable and um last one uh the block executable fries from running unless",
    "start": "1509799",
    "end": "1516200"
  },
  {
    "text": "they meet a prevalent age or trusted list Criterium actually there is an",
    "start": "1516200",
    "end": "1522120"
  },
  {
    "text": "exclusion uh if you install software using a CH",
    "start": "1522120",
    "end": "1528559"
  },
  {
    "text": "which is implemented in this in this okay so now that we have uh just a early",
    "start": "1528559",
    "end": "1535679"
  },
  {
    "text": "look at all the defender ISR rules have been made uh it",
    "start": "1535679",
    "end": "1542120"
  },
  {
    "text": "seem to be interesting to try to understand more what you can find in it",
    "start": "1542120",
    "end": "1547159"
  },
  {
    "text": "this signature database we just look at the L scrip script that we grab and just",
    "start": "1547159",
    "end": "1554360"
  },
  {
    "text": "de compile but maybe there are other things not not especially related to ISR",
    "start": "1554360",
    "end": "1560320"
  },
  {
    "text": "but maybe related to other um marware signatures for instance or configuration",
    "start": "1560320",
    "end": "1566520"
  },
  {
    "text": "and so okay uh so for now we only scratch the surface and we want to understand uh",
    "start": "1566520",
    "end": "1575320"
  },
  {
    "start": "1568000",
    "end": "1568000"
  },
  {
    "text": "all the signature format is made so the color trust when the signature are",
    "start": "1575320",
    "end": "1583520"
  },
  {
    "text": "passed uh is this one and the idea is that um it will compress the vdm file",
    "start": "1583520",
    "end": "1590159"
  },
  {
    "text": "and then dispatch for each uh signature uh to the",
    "start": "1590159",
    "end": "1595600"
  },
  {
    "text": "the Callback which are made to under them so the basic format is like that",
    "start": "1595600",
    "end": "1601559"
  },
  {
    "text": "you have a c type on one byte and then the size and then the data of the",
    "start": "1601559",
    "end": "1606640"
  },
  {
    "text": "signature so basically here we have the 5c signature type then its size then its",
    "start": "1606640",
    "end": "1613640"
  },
  {
    "text": "relative data to understand what is what",
    "start": "1613640",
    "end": "1618760"
  },
  {
    "text": "the type is corresponding to 5c we have a get S Type function uh in",
    "start": "1618760",
    "end": "1625039"
  },
  {
    "text": "dpdb which declare what are the actually name the debug name for these signatur",
    "start": "1625039",
    "end": "1631279"
  },
  {
    "text": "so for instance d5c is signature type thread begin and it would be useful to",
    "start": "1631279",
    "end": "1637720"
  },
  {
    "text": "understand to understand what the the signator is about the signators are",
    "start": "1637720",
    "end": "1643000"
  },
  {
    "start": "1641000",
    "end": "1641000"
  },
  {
    "text": "distributed in modules uh which each register some callbacks so for instance",
    "start": "1643000",
    "end": "1648039"
  },
  {
    "text": "uh some of the modules are the ufs are in the ufs",
    "start": "1648039",
    "end": "1653360"
  },
  {
    "text": "category which rest is M function like the PDF one this is main function will",
    "start": "1653360",
    "end": "1659720"
  },
  {
    "text": "try to seek for PDF header and then uh if you find it both things and the one",
    "start": "1659720",
    "end": "1666919"
  },
  {
    "text": "we are interested by is the r control type which will uh register a signature",
    "start": "1666919",
    "end": "1674120"
  },
  {
    "text": "type uh the bite we just talk about and sometimes",
    "start": "1674120",
    "end": "1679640"
  },
  {
    "text": "callbacks and these callbacks will be um will be called when uh the vdm files are",
    "start": "1679640",
    "end": "1688080"
  },
  {
    "text": "passed for instance the signature type and script uh will register function",
    "start": "1688080",
    "end": "1694840"
  },
  {
    "text": "name pushp to pass the uh its corresponding entry",
    "start": "1694840",
    "end": "1701080"
  },
  {
    "text": "so we have to so here is a list of all the models that you can find in Defender",
    "start": "1701080",
    "end": "1708120"
  },
  {
    "text": "lot of rcks of course I didn't uh have a look at all them and",
    "start": "1708120",
    "end": "1714760"
  },
  {
    "text": "um just for some give you some statistics there is the repartition of",
    "start": "1714760",
    "end": "1720080"
  },
  {
    "text": "type in the an spiral database so the thing is that for each signat format we",
    "start": "1720080",
    "end": "1726640"
  },
  {
    "text": "have to reverse uh the pring function and to understand what it is looking for",
    "start": "1726640",
    "end": "1731960"
  },
  {
    "text": "and what are what are the data in it uh this is an ongoing work and only made it for a",
    "start": "1731960",
    "end": "1739360"
  },
  {
    "text": "few of them but they'll talk about a bit later uh it's still",
    "start": "1739360",
    "end": "1747559"
  },
  {
    "text": "ongoing work so from what I understand uh each in a vdm file uh you have a lot",
    "start": "1747559",
    "end": "1754159"
  },
  {
    "text": "of uh threats which are designed by type threat and inside the threat you have a",
    "start": "1754159",
    "end": "1762360"
  },
  {
    "text": "different sign type that can be that can belong to a specific version uh",
    "start": "1762360",
    "end": "1768600"
  },
  {
    "text": "which are designed by signat type V check the signature are the same for all",
    "start": "1768600",
    "end": "1774720"
  },
  {
    "text": "different deration and um there are actually specific threats so for instance",
    "start": "1774720",
    "end": "1781919"
  },
  {
    "start": "1777000",
    "end": "1777000"
  },
  {
    "text": "uh you have one fly files threat uh which is made of a lot of Ash which are",
    "start": "1781919",
    "end": "1789559"
  },
  {
    "text": "used to weight list files so there is an example another sweat which is uh",
    "start": "1789559",
    "end": "1796760"
  },
  {
    "text": "actually very important is is the infrastructure shared threats because from what I understand it contains a lot",
    "start": "1796760",
    "end": "1803799"
  },
  {
    "text": "of Commons like the luas script we saw before in ISR uh it also contained the",
    "start": "1803799",
    "end": "1811399"
  },
  {
    "text": "detection logic in the form of signature tree it also contains everything used in",
    "start": "1811399",
    "end": "1816679"
  },
  {
    "text": "the sandbox for emulation and the root set store which is used for instance for certificate checking you also have also",
    "start": "1816679",
    "end": "1824880"
  },
  {
    "text": "a specific threat like uh PDF scan stream fcss pdb must emulate test and",
    "start": "1824880",
    "end": "1832559"
  },
  {
    "text": "things like that so if we get back to what we saw before the Lua signatures we which was",
    "start": "1832559",
    "end": "1840760"
  },
  {
    "start": "1834000",
    "end": "1834000"
  },
  {
    "text": "the one used by ISR if we diging a bit more we think we saw that they actually",
    "start": "1840760",
    "end": "1847159"
  },
  {
    "text": "belonging to categories like infrastructure signature validator uh so",
    "start": "1847159",
    "end": "1853480"
  },
  {
    "text": "I is an example of a signature validator and as is an example of a post accomodation uh which is checking some",
    "start": "1853480",
    "end": "1860919"
  },
  {
    "text": "some Wii parameter and uh this is another one which is checking things in",
    "start": "1860919",
    "end": "1866639"
  },
  {
    "text": "the emulation sandbox another type is the DB VAR which",
    "start": "1866639",
    "end": "1874000"
  },
  {
    "start": "1870000",
    "end": "1870000"
  },
  {
    "text": "which I understand is it as a configuration variables um and which are sometime",
    "start": "1874000",
    "end": "1880440"
  },
  {
    "text": "mixed with vers checks so this version is using this configuration and this version is is using this this",
    "start": "1880440",
    "end": "1887240"
  },
  {
    "text": "configuration so I is an example of the MC process list or another one is the",
    "start": "1887240",
    "end": "1893279"
  },
  {
    "text": "competitive security products you can see that there is a m I think",
    "start": "1893279",
    "end": "1898840"
  },
  {
    "text": "is um you also find things like uh Intel tdt uh configuration which is an Intel",
    "start": "1898840",
    "end": "1906320"
  },
  {
    "text": "confidenti file um is using in the Intel tdt technology don't have the time to",
    "start": "1906320",
    "end": "1913080"
  },
  {
    "text": "introduce it here and you can find the um classif fire which are using it which",
    "start": "1913080",
    "end": "1920880"
  },
  {
    "text": "are using a machine learning classifier you can you can even extract uh the",
    "start": "1920880",
    "end": "1927639"
  },
  {
    "text": "weights and reproduce some of the random Forest uh three that's this is for this",
    "start": "1927639",
    "end": "1935960"
  },
  {
    "text": "is left as an exercise another thing is the HST um signatures which are used to",
    "start": "1935960",
    "end": "1943840"
  },
  {
    "text": "uh just look up for strings in file so for instance uh if can you can look up",
    "start": "1943840",
    "end": "1948880"
  },
  {
    "text": "for command common lines you can look up in office macro it can look up in Java",
    "start": "1948880",
    "end": "1954279"
  },
  {
    "text": "files and so on and this is interesting because we can use it for evasion so for",
    "start": "1954279",
    "end": "1959360"
  },
  {
    "text": "instance if I'm scanning the M scan client which is um stat",
    "start": "1959360",
    "end": "1965039"
  },
  {
    "text": "scanner U it's the MP Defender will say that okay this is a Linux port scan",
    "start": "1965039",
    "end": "1971480"
  },
  {
    "text": "threat so I can look to the corresponding threat I can see that it's actually looking for some of uh strings",
    "start": "1971480",
    "end": "1978799"
  },
  {
    "text": "and just to be sure I'm making a file which just contain these things and uh",
    "start": "1978799",
    "end": "1984559"
  },
  {
    "text": "but actually doing nothing I compile it and if I try to scan it it actually say",
    "start": "1984559",
    "end": "1991320"
  },
  {
    "text": "yes uh I recognize it as a PO scan so we correctly understand understood what is",
    "start": "1991320",
    "end": "1998440"
  },
  {
    "text": "going on but what what I can do now I can easily uh remove just these",
    "start": "1998440",
    "end": "2006399"
  },
  {
    "text": "strings um and if I do that and scan again uh it is no longer recognized as a",
    "start": "2006399",
    "end": "2013840"
  },
  {
    "text": "threat and I can use the the file I just evade the signatures um The Brute Force uh",
    "start": "2013840",
    "end": "2021919"
  },
  {
    "text": "techniques also works of course uh this method is just a bit more",
    "start": "2021919",
    "end": "2027600"
  },
  {
    "start": "2026000",
    "end": "2026000"
  },
  {
    "text": "effective um so another thing interesting is our",
    "start": "2027600",
    "end": "2033600"
  },
  {
    "text": "signatur updates um because the Vim file is very big but actually you also have um near",
    "start": "2033600",
    "end": "2041200"
  },
  {
    "text": "to the base file Bas line file you also have minor updates in delta form um the",
    "start": "2041200",
    "end": "2047679"
  },
  {
    "text": "Delta vdm just contain Delta blob which are actually merged uh in during the",
    "start": "2047679",
    "end": "2054960"
  },
  {
    "text": "passsing so the the process is quite simple the final data to parse is",
    "start": "2054960",
    "end": "2060480"
  },
  {
    "text": "actually made of part from the Baseline and part for the Delta blob he merge",
    "start": "2060480",
    "end": "2066878"
  },
  {
    "text": "them and then he will pass the final data to to to load the databases to",
    "start": "2066879",
    "end": "2075960"
  },
  {
    "text": "fulfill the basis um so during one month I grab all the update I can uh just",
    "start": "2075960",
    "end": "2084118"
  },
  {
    "start": "2077000",
    "end": "2077000"
  },
  {
    "text": "asking uh to to Defender um the updates and AR is is what I got uh the just some",
    "start": "2084119",
    "end": "2094280"
  },
  {
    "text": "statistics on the version uh which is um in the time I have one update almost uh every",
    "start": "2094280",
    "end": "2104440"
  },
  {
    "text": "two hours I think and like that I got some audities while updating sometimes um the the update",
    "start": "2104440",
    "end": "2113400"
  },
  {
    "start": "2106000",
    "end": "2106000"
  },
  {
    "text": "just the update server give me back uh um files that that are already have uh",
    "start": "2113400",
    "end": "2122000"
  },
  {
    "text": "two or three hours um before uh I got one broken update",
    "start": "2122000",
    "end": "2129000"
  },
  {
    "text": "um but um but well it is still working so what we can do with these update we",
    "start": "2129000",
    "end": "2135079"
  },
  {
    "start": "2132000",
    "end": "2132000"
  },
  {
    "text": "can div them and for instance if we diff What are what the file are add or",
    "start": "2135079",
    "end": "2141960"
  },
  {
    "text": "removed in different files so what file were considered as friendly but actually",
    "start": "2141960",
    "end": "2148200"
  },
  {
    "text": "no um you have one example here the file setup which finally um include I think",
    "start": "2148200",
    "end": "2157319"
  },
  {
    "text": "spiral or something like that or another one on a given Set uh we can also look",
    "start": "2157319",
    "end": "2163319"
  },
  {
    "text": "at strategy changes uh there is an example where it was at first a static",
    "start": "2163319",
    "end": "2169680"
  },
  {
    "text": "uh check then a look for Strings and then finally uh look for a",
    "start": "2169680",
    "end": "2175839"
  },
  {
    "text": "path we also can look at what what is actually um what currently interest uh",
    "start": "2175839",
    "end": "2184599"
  },
  {
    "text": "Microsoft Defender team uh just by look at what are the threats being updated so",
    "start": "2184599",
    "end": "2191640"
  },
  {
    "text": "there is an example in the in the recent update there were adding things for",
    "start": "2191640",
    "end": "2196760"
  },
  {
    "text": "miride for instance and removing some of the all the threats uh we can also try",
    "start": "2196760",
    "end": "2205119"
  },
  {
    "start": "2203000",
    "end": "2203000"
  },
  {
    "text": "to find uh CNC so there is an example in the recent updates of uh URL which is",
    "start": "2205119",
    "end": "2212960"
  },
  {
    "text": "checked inside um an office mcro but if",
    "start": "2212960",
    "end": "2218240"
  },
  {
    "text": "we run the the file the actually the actual URL is considered okay and the",
    "start": "2218240",
    "end": "2227160"
  },
  {
    "text": "thetion is also consider fine so it's checking for the macro but not checking",
    "start": "2227160",
    "end": "2235160"
  },
  {
    "text": "for the the UR the actual URL is you",
    "start": "2235160",
    "end": "2240400"
  },
  {
    "start": "2239000",
    "end": "2239000"
  },
  {
    "text": "also have aary changes so for instance some of the Lu script still have their",
    "start": "2240400",
    "end": "2245720"
  },
  {
    "text": "deug name and um from what I understand this is due to",
    "start": "2245720",
    "end": "2250920"
  },
  {
    "text": "the compilation chain the name is moving during checks and uh you you will",
    "start": "2250920",
    "end": "2258960"
  },
  {
    "text": "finally uh get changes but related to to De path so Delta file distributed to the",
    "start": "2258960",
    "end": "2266280"
  },
  {
    "text": "world Planet just for a diff which is actually unary so",
    "start": "2266280",
    "end": "2273160"
  },
  {
    "text": "just to conclude um we just look at how to look at windows Defenders signatures",
    "start": "2273160",
    "end": "2278720"
  },
  {
    "text": "how ISR rules are actually implemented or they are actually",
    "start": "2278720",
    "end": "2284319"
  },
  {
    "text": "checked uh and a deeper look on the signatures and",
    "start": "2284319",
    "end": "2289480"
  },
  {
    "text": "our anterus is actually working I hope you will learn something and I wish you will",
    "start": "2289480",
    "end": "2296920"
  },
  {
    "text": "want to take a look at it uh thank you and uh I think it's time for q&",
    "start": "2296920",
    "end": "2304480"
  },
  {
    "text": "[Music]",
    "start": "2304480",
    "end": "2314059"
  }
]