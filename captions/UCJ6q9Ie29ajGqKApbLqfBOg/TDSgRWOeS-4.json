[
  {
    "text": "foreign",
    "start": "1979",
    "end": "4159"
  },
  {
    "text": "thank you for coming to my talk I'm sorry that I cannot be in person for this great conference but I have my best",
    "start": "11940",
    "end": "19199"
  },
  {
    "text": "on this on this online virtual speech so let's just start so I'm from China and my name",
    "start": "19199",
    "end": "26460"
  },
  {
    "text": "is you can just call me 11. the topic of my presentation is deep into Android",
    "start": "26460",
    "end": "33300"
  },
  {
    "text": "Bluetooth spark hunting attack service and record patterns so next site",
    "start": "33300",
    "end": "40500"
  },
  {
    "text": "so first is some introduce some introduction about myself right now I'm",
    "start": "40500",
    "end": "46680"
  },
  {
    "text": "a security researcher at Oppo Amber security nav uh in recent years I have",
    "start": "46680",
    "end": "52320"
  },
  {
    "text": "many folks on Android vulnerabilities research and also work on iot and workers in my spare time so if you have",
    "start": "52320",
    "end": "60719"
  },
  {
    "text": "any question about this talk or other topics so you can contact me at any time",
    "start": "60719",
    "end": "65820"
  },
  {
    "text": "with Twitter or our email",
    "start": "65820",
    "end": "69680"
  },
  {
    "text": "the printation is divided into formation so in the introduction section I will",
    "start": "71659",
    "end": "79140"
  },
  {
    "text": "talk about some basic information about the Bluetooth and some previous research",
    "start": "79140",
    "end": "84180"
  },
  {
    "text": "and historic vulnerability analysis Android Bluetooth and next I will show",
    "start": "84180",
    "end": "89580"
  },
  {
    "text": "you some uh Tank Service I know and then I will introduce some useful messages including code audit and filing so the",
    "start": "89580",
    "end": "97500"
  },
  {
    "text": "family uh there will be a brief summary and a look for future work",
    "start": "97500",
    "end": "103880"
  },
  {
    "text": "so let's talk about some history of the Android Bluetooth thing",
    "start": "104159",
    "end": "109439"
  },
  {
    "text": "uh before Android before enter 4.2 Google purchase producer which is the",
    "start": "109439",
    "end": "115880"
  },
  {
    "text": "default Bluetooth protocol stack for Linux but but however blue is not",
    "start": "115880",
    "end": "122220"
  },
  {
    "text": "suitable for Android platform therefore about two years later Google and broadcom developed",
    "start": "122220",
    "end": "128840"
  },
  {
    "text": "to be a player to proceed and for Android 6 to Android 13 Google uh",
    "start": "128840",
    "end": "134760"
  },
  {
    "text": "changed the name of the Bluetooth protect stack twice so uh the rapid",
    "start": "134760",
    "end": "140040"
  },
  {
    "text": "iteration and code refactoring a few years makes Android Bluetooth more and more powerful but but on the other hand",
    "start": "140040",
    "end": "148080"
  },
  {
    "text": "it also makes the code more valuable in addition the Bluetooth codes next unit",
    "start": "148080",
    "end": "154020"
  },
  {
    "text": "test and the script audits so making uh its secret ads are wearing low level in",
    "start": "154020",
    "end": "160379"
  },
  {
    "text": "the year years so and moreover Bluetooth has a wide range of application",
    "start": "160379",
    "end": "166500"
  },
  {
    "text": "scenarios and the complex protects so this reason means two constant discovery",
    "start": "166500",
    "end": "172440"
  },
  {
    "text": "of security risk in Android Bluetooth stack",
    "start": "172440",
    "end": "177660"
  },
  {
    "text": "uh look right look at this diagram this diagram shows that Android Bluetooth",
    "start": "178500",
    "end": "183720"
  },
  {
    "text": "architectures it shows this relationship between the different layers they are",
    "start": "183720",
    "end": "189540"
  },
  {
    "text": "five layers so from top and to from top to report those as follows application",
    "start": "189540",
    "end": "197580"
  },
  {
    "text": "framework layer and Bluetooth system service GLI Bluetooth stack and window",
    "start": "197580",
    "end": "202620"
  },
  {
    "text": "and each layer communicates with other layers through the different IPC such as",
    "start": "202620",
    "end": "208500"
  },
  {
    "text": "band IPC and the GI calls uh and based on the principle of least",
    "start": "208500",
    "end": "216140"
  },
  {
    "text": "privilege this architectures reduce the attack damage but on the other hand",
    "start": "216140",
    "end": "221819"
  },
  {
    "text": "among layers also give me more chance to find more attack surface",
    "start": "221819",
    "end": "227819"
  },
  {
    "text": "so next slide so in recent years researchers have also published many",
    "start": "227819",
    "end": "233400"
  },
  {
    "text": "research results on Android Bluetooth the Bluetooth is among the most influencing ones so it is a series of",
    "start": "233400",
    "end": "240420"
  },
  {
    "text": "Bluetooth mind abilities in dangerous multiple operating systems including",
    "start": "240420",
    "end": "245700"
  },
  {
    "text": "Android iOS and windows and Linux and and due to this disclosure of blue",
    "start": "245700",
    "end": "252540"
  },
  {
    "text": "point and more researchers began to focus on Bluetooth security and of",
    "start": "252540",
    "end": "257699"
  },
  {
    "text": "course I'm aware of them so I'm really grateful to This research researchers for publicity for publishing uh their",
    "start": "257699",
    "end": "264419"
  },
  {
    "text": "their real results and I checked uh the statistics of",
    "start": "264419",
    "end": "272580"
  },
  {
    "text": "series of the Bluetooth module in the past six years uh based on the data from",
    "start": "272580",
    "end": "278460"
  },
  {
    "text": "the Android secret proteins so since Anderson no longer published detailed information about media and no",
    "start": "278460",
    "end": "286380"
  },
  {
    "text": "one abilities so the statistics only include high and critical",
    "start": "286380",
    "end": "292800"
  },
  {
    "text": "and you can see the data the data shows and security researchers have found at",
    "start": "292800",
    "end": "298080"
  },
  {
    "text": "least 148 vulnerabilities and including including 1999 high and 49 critical",
    "start": "298080",
    "end": "307500"
  },
  {
    "text": "and finally chart below it can be present almost half of the vulnerability",
    "start": "307500",
    "end": "313199"
  },
  {
    "text": "were discovered in 2018 so this is because many gestures began to Bluetooth",
    "start": "313199",
    "end": "319639"
  },
  {
    "text": "vulnerabilities after the disclosure of blue point and the other reason is the",
    "start": "319639",
    "end": "324960"
  },
  {
    "text": "code quality of the produce Bluetooth module was not high in 2018 so for example almost our protect stand",
    "start": "324960",
    "end": "334380"
  },
  {
    "text": "codes do not check evidence of the input data so this which results are United's",
    "start": "334380",
    "end": "340860"
  },
  {
    "text": "number of memory passing vulnerabilities uh and up to now a most of uh most of",
    "start": "340860",
    "end": "347460"
  },
  {
    "text": "the the bugs are also still memory corrupting type",
    "start": "347460",
    "end": "353539"
  },
  {
    "text": "so next sites so this is the most uh most important section in this talk and",
    "start": "355199",
    "end": "361680"
  },
  {
    "text": "because I think it is necessary that to send out our our possible attack surface",
    "start": "361680",
    "end": "368160"
  },
  {
    "text": "before finding one abilities so this technology and tricks about how to find",
    "start": "368160",
    "end": "373199"
  },
  {
    "text": "vulnerability are just icing on the cake of course uh this is my own way",
    "start": "373199",
    "end": "379759"
  },
  {
    "text": "so before starting to expand I explain the attack surface I will first",
    "start": "379860",
    "end": "385380"
  },
  {
    "text": "literally a Bluetooth architecture diagram for the perspective of the",
    "start": "385380",
    "end": "390539"
  },
  {
    "text": "attack so the diagram is complex so our grants that we realize the content to show you what I know what to know about",
    "start": "390539",
    "end": "397740"
  },
  {
    "text": "what I know about the Bluetooth attack surface so first of all",
    "start": "397740",
    "end": "402900"
  },
  {
    "text": "I activated it into three areas the host the control and the remote the host",
    "start": "402900",
    "end": "410100"
  },
  {
    "text": "error I implements our Bluetooth stacks on the up layer and under the control",
    "start": "410100",
    "end": "417060"
  },
  {
    "text": "error can be simply regard as Bluetooth chip which is used to receiving Banking",
    "start": "417060",
    "end": "424080"
  },
  {
    "text": "and transmitting Bluetooth video data and the remote error is just a Bluetooth",
    "start": "424080",
    "end": "431220"
  },
  {
    "text": "device just like uh but it was hit set bluetooth mouse so and so on and other",
    "start": "431220",
    "end": "439020"
  },
  {
    "text": "other Bluetooth device any things ah so let's come uh this comes the",
    "start": "439020",
    "end": "446340"
  },
  {
    "text": "Bluetooth system applications so which implements most Bluetooth core functions explaining concepts of three modules so",
    "start": "446340",
    "end": "454740"
  },
  {
    "text": "the first module contains multiple bluetooth profiles Java service this",
    "start": "454740",
    "end": "460259"
  },
  {
    "text": "service provides capabilities to update applications through the exposed",
    "start": "460259",
    "end": "466080"
  },
  {
    "text": "interface and some of the more complex Java",
    "start": "466080",
    "end": "471840"
  },
  {
    "text": "service communicate with the Gmail module with the geometry through the Gmail",
    "start": "471840",
    "end": "477180"
  },
  {
    "text": "interface after doing some type of conversation",
    "start": "477180",
    "end": "482220"
  },
  {
    "text": "from Jr to Native will continue to cover the native module named Bluetooth",
    "start": "482220",
    "end": "488280"
  },
  {
    "text": "through the registered interface function and this native module implements the",
    "start": "488280",
    "end": "494400"
  },
  {
    "text": "core functions of the most Bluetooth protects and profiles and most of the",
    "start": "494400",
    "end": "500580"
  },
  {
    "text": "vulnerabilities are also found in this module so let's look at the framework",
    "start": "500580",
    "end": "506759"
  },
  {
    "text": "layer the framework layer there is a Bluetooth managed Java service so this this",
    "start": "506759",
    "end": "514500"
  },
  {
    "text": "JavaScript is resist in the system service process and it burns it depends",
    "start": "514500",
    "end": "520140"
  },
  {
    "text": "a JavaScript of the Bluetooth system application and then it explodes the",
    "start": "520140",
    "end": "525720"
  },
  {
    "text": "public interface to the up to the up-use application",
    "start": "525720",
    "end": "531019"
  },
  {
    "text": "Android also also implements a local native Health sales called uh called",
    "start": "533120",
    "end": "538860"
  },
  {
    "text": "Bluetooth PD but this service is not enabled by default uh on my on any",
    "start": "538860",
    "end": "545220"
  },
  {
    "text": "mobile devices but but according to the public's information I found so I found it will",
    "start": "545220",
    "end": "553680"
  },
  {
    "text": "be enabled enabled on some Linux platforms or other Android TVs so and",
    "start": "553680",
    "end": "560399"
  },
  {
    "text": "Google has also assigned a serial number to these servers so maybe this is uh",
    "start": "560399",
    "end": "566220"
  },
  {
    "text": "need to learn but good attack surface",
    "start": "566220",
    "end": "570500"
  },
  {
    "text": "uh let's go let's go on so so the top uh the top is application application layer",
    "start": "571680",
    "end": "577380"
  },
  {
    "text": "uh activities in uh into untrust unswaster app and and Hardware",
    "start": "577380",
    "end": "584640"
  },
  {
    "text": "applications are based on the privilege level the untrust the untrust application is just it's just a",
    "start": "584640",
    "end": "592320"
  },
  {
    "text": "third-party application that can be done in the Google APB store and other and",
    "start": "592320",
    "end": "598680"
  },
  {
    "text": "other APB store and the hardware application has high privilege so that so that can have this right to call a",
    "start": "598680",
    "end": "606899"
  },
  {
    "text": "hardware service okay next",
    "start": "606899",
    "end": "612660"
  },
  {
    "text": "uh next uh is uh",
    "start": "612660",
    "end": "618440"
  },
  {
    "text": "so let's go on okay the first attack scenario is the",
    "start": "618440",
    "end": "624959"
  },
  {
    "text": "most common one uh named named the money shows Bluetooth video and somebody",
    "start": "624959",
    "end": "630120"
  },
  {
    "text": "speaking it is refused to the malicious Bluetooth data packs sent by Bluetooth device such as headphones and keyboard",
    "start": "630120",
    "end": "638519"
  },
  {
    "text": "so when I talk to Android device I receive these monitors and my formed",
    "start": "638519",
    "end": "644160"
  },
  {
    "text": "data packs and and if the code is not perpendic handled it may cause some",
    "start": "644160",
    "end": "650279"
  },
  {
    "text": "vulnerabilities so in this scenario the test flow is",
    "start": "650279",
    "end": "656519"
  },
  {
    "text": "exist the first a Bluetooth device will send",
    "start": "656519",
    "end": "661860"
  },
  {
    "text": "some Malaysia State Banks and at this moment the Blue Chip will receive it and",
    "start": "661860",
    "end": "668579"
  },
  {
    "text": "transmit uh transmit it to HCI layer through the Canon driver after some",
    "start": "668579",
    "end": "675060"
  },
  {
    "text": "internal process work in the native module the packs will be",
    "start": "675060",
    "end": "680880"
  },
  {
    "text": "unpacked and attracted and distributed distributed to each particular and",
    "start": "680880",
    "end": "687660"
  },
  {
    "text": "profile fulfillment processing and for example the Bluetooth audio data",
    "start": "687660",
    "end": "692940"
  },
  {
    "text": "will be transmitted into every DT and Arc and avct and HTTP for for fielding",
    "start": "692940",
    "end": "700740"
  },
  {
    "text": "parsings",
    "start": "700740",
    "end": "703220"
  },
  {
    "text": "so uh so through through this tracking of the data flow uh they are at least",
    "start": "706380",
    "end": "712920"
  },
  {
    "text": "three vulnerabilities here the chip code maybe I had to do a skill when",
    "start": "712920",
    "end": "718380"
  },
  {
    "text": "processing manage your status and and memory corruption bugs may occur with",
    "start": "718380",
    "end": "723480"
  },
  {
    "text": "the native code passing and the transforms the protocol stack data and the addition the Callback interface of",
    "start": "723480",
    "end": "730740"
  },
  {
    "text": "the gni may have the security risk when processing data that is either large or",
    "start": "730740",
    "end": "736860"
  },
  {
    "text": "short so let's let's look at the six tank",
    "start": "736860",
    "end": "742680"
  },
  {
    "text": "scenariators so that is uh managers and Trust applications so image if a tank",
    "start": "742680",
    "end": "750180"
  },
  {
    "text": "can install an application with no more permission to on the attack device so what attacks can be performed",
    "start": "750180",
    "end": "758760"
  },
  {
    "text": "let's sample follow the address to see the enter calling process",
    "start": "758760",
    "end": "764779"
  },
  {
    "text": "so data will flows through four four module modules and two types of risk are",
    "start": "770639",
    "end": "777360"
  },
  {
    "text": "approach to occur so first with the untrusted applications versus Java",
    "start": "777360",
    "end": "783420"
  },
  {
    "text": "service if some high risk interface do not perform a permission check so it may",
    "start": "783420",
    "end": "789240"
  },
  {
    "text": "need to risk such as unauthorized assist on the user previous leakage and the",
    "start": "789240",
    "end": "797160"
  },
  {
    "text": "second some Bluetooth profiles also allows the user application to do some",
    "start": "797160",
    "end": "802339"
  },
  {
    "text": "initializing initialize the settings so that means the untrust application can",
    "start": "802339",
    "end": "809700"
  },
  {
    "text": "pass some data to the native module so at this point if the native code can",
    "start": "809700",
    "end": "814800"
  },
  {
    "text": "handle the data improperly it may cause some memory corruption when a bit artists",
    "start": "814800",
    "end": "822019"
  },
  {
    "text": "uh so this is uh similar to the previous one and let's look at the flow",
    "start": "822839",
    "end": "831500"
  },
  {
    "text": "so the difference is that the Bluetooth PD service is a native service so it",
    "start": "831600",
    "end": "837240"
  },
  {
    "text": "contains some C and simpler Plus Code so there may be some memory corruption box",
    "start": "837240",
    "end": "842940"
  },
  {
    "text": "if the codes do not check uh the inputed consider if the uh if the input date is",
    "start": "842940",
    "end": "849600"
  },
  {
    "text": "too big or is too small",
    "start": "849600",
    "end": "853279"
  },
  {
    "text": "uh the source unreal is magnesius Hardware application so if an attack has",
    "start": "856860",
    "end": "863940"
  },
  {
    "text": "already gained local privilege uh explanation so then it is possible to",
    "start": "863940",
    "end": "870240"
  },
  {
    "text": "launch a text on the Bluetooth Hardware application how do we uh no no uh",
    "start": "870240",
    "end": "875880"
  },
  {
    "text": "Bluetooth Hardware service this risk",
    "start": "875880",
    "end": "881959"
  },
  {
    "text": "oh sorry so there is this risk here mainly depends on the security of each window",
    "start": "883199",
    "end": "889260"
  },
  {
    "text": "code itself and this most likes why are some risk conditions and out of bounds read and",
    "start": "889260",
    "end": "896820"
  },
  {
    "text": "the right one abilities so I have found some some very bug uh a few days ago but",
    "start": "896820",
    "end": "903480"
  },
  {
    "text": "I cannot give you the details today so the last attack scenarios is",
    "start": "903480",
    "end": "909540"
  },
  {
    "text": "malicious Bluetooth chip so this is because uh in the Bluetooth architectures the host layer and the",
    "start": "909540",
    "end": "916260"
  },
  {
    "text": "control name are separate uh so so uh so in series uh the host",
    "start": "916260",
    "end": "922680"
  },
  {
    "text": "layer should not complete trust and data passed as fast as any data passed by the",
    "start": "922680",
    "end": "928019"
  },
  {
    "text": "control uh so of course uh since it is uh difficult to satisfy the",
    "start": "928019",
    "end": "935060"
  },
  {
    "text": "preconditions so this risk would be small if there is anything",
    "start": "935060",
    "end": "940079"
  },
  {
    "text": "but but I haven't found some some parts in this scenarios",
    "start": "940079",
    "end": "947100"
  },
  {
    "text": "uh the Blue Chip uh just uh passed the data to The Host",
    "start": "947100",
    "end": "952320"
  },
  {
    "text": "the host news was a Keno driver so during passing of the some method even",
    "start": "952320",
    "end": "958380"
  },
  {
    "text": "type data packs memory corruption bugs may occur",
    "start": "958380",
    "end": "963800"
  },
  {
    "text": "so next site okay uh so uh let's pull out the tank",
    "start": "965220",
    "end": "972959"
  },
  {
    "text": "scenarios in one picture so you can see this picture uh so but",
    "start": "972959",
    "end": "981420"
  },
  {
    "text": "but due to the Limit term of this talk I cannot explain all details so I have",
    "start": "981420",
    "end": "987720"
  },
  {
    "text": "marked some three numbers in each module so you so so if you are interested on",
    "start": "987720",
    "end": "993120"
  },
  {
    "text": "this you can check this history vulnerabilities and take a deep div into",
    "start": "993120",
    "end": "998279"
  },
  {
    "text": "this attack service and you uh and you also can contact me",
    "start": "998279",
    "end": "1005920"
  },
  {
    "text": "the next site so in this part uh I will give you a",
    "start": "1006560",
    "end": "1012800"
  },
  {
    "text": "proof a brief uh introduction on how to find these vulnerabilities through this attack service talked before",
    "start": "1012800",
    "end": "1020680"
  },
  {
    "text": "we've used two methods code audit and funding and the code audit allows us to",
    "start": "1022160",
    "end": "1027620"
  },
  {
    "text": "review the whole life scale cycle of Bluetooth spec data but the biggest disadvantage event it will take a lot of",
    "start": "1027620",
    "end": "1035600"
  },
  {
    "text": "Manpower and resource so so therefore I built some weak code patterns and use",
    "start": "1035600",
    "end": "1041298"
  },
  {
    "text": "code scale for automated code audit the other method is fighting so I have used",
    "start": "1041299",
    "end": "1048199"
  },
  {
    "text": "the Thousand technology on other modules such as multiple media file browsing so I often",
    "start": "1048199",
    "end": "1055220"
  },
  {
    "text": "used AFL tools and nip father for testing but however in the Bluetooth",
    "start": "1055220",
    "end": "1060500"
  },
  {
    "text": "module the situation is different so in some previous week researchers usually",
    "start": "1060500",
    "end": "1066860"
  },
  {
    "text": "fast bluetooth remote training but uh in my opinion as this this method is if",
    "start": "1066860",
    "end": "1074539"
  },
  {
    "text": "inefficiently and question and it is hard to combine code coverage",
    "start": "1074539",
    "end": "1080020"
  },
  {
    "text": "to improve the first effect uh so so based on these reasons I decided to use",
    "start": "1080020",
    "end": "1086299"
  },
  {
    "text": "local files with uh simulated simulation also uh before before talk about the",
    "start": "1086299",
    "end": "1094700"
  },
  {
    "text": "technology you need to know uh two types that are frequently used in Bluetooth",
    "start": "1094700",
    "end": "1099740"
  },
  {
    "text": "source code so uh the left side this side the PT HDR",
    "start": "1099740",
    "end": "1105260"
  },
  {
    "text": "structure are used to define the header of each buffer used in the Bluetooth stack as then and the data in the",
    "start": "1105260",
    "end": "1113240"
  },
  {
    "text": "structure as evidence of the input Bank data and the input Bank data buffer",
    "start": "1113240",
    "end": "1118760"
  },
  {
    "text": "advice so the following three codes blocks will come in source code so you",
    "start": "1118760",
    "end": "1125179"
  },
  {
    "text": "can see this code in everywhere and are many used to obtain this star advice and",
    "start": "1125179",
    "end": "1131600"
  },
  {
    "text": "understands of the buffer and in addition we are a series of common macros definition mainly used to",
    "start": "1131600",
    "end": "1140200"
  },
  {
    "text": "extract data from user input you can see the Maxwell in the website these markers",
    "start": "1140200",
    "end": "1147500"
  },
  {
    "text": "themselves have no bounce check so this is important which means that as a",
    "start": "1147500",
    "end": "1153140"
  },
  {
    "text": "column needs to ensure that the bank check are performed before calling these markers so main history uh many historical",
    "start": "1153140",
    "end": "1160880"
  },
  {
    "text": "vulnerabilities have occurred in this Marcus course",
    "start": "1160880",
    "end": "1165520"
  },
  {
    "text": "okay let's talk about some record patterns the first come type is",
    "start": "1166580",
    "end": "1172000"
  },
  {
    "text": "inter-overflow in stream B instrumentalization so let's look at uh",
    "start": "1172000",
    "end": "1178640"
  },
  {
    "text": "some example so this function this function receives and the process incoming data the code using markers to",
    "start": "1178640",
    "end": "1186860"
  },
  {
    "text": "expect one of type answer in the 16 from the untrust data and then it will store",
    "start": "1186860",
    "end": "1194780"
  },
  {
    "text": "it in the number variables then the damper variable is multiport by four",
    "start": "1194780",
    "end": "1199940"
  },
  {
    "text": "understood in the size variable of the same type so uh since the input data is",
    "start": "1199940",
    "end": "1206000"
  },
  {
    "text": "complete controllable so if number is a is a large enough so inter under",
    "start": "1206000",
    "end": "1212480"
  },
  {
    "text": "workflow will occur during calculation of the size so you can see the comment in in this",
    "start": "1212480",
    "end": "1218780"
  },
  {
    "text": "code and make the value of the size smaller than the expected value and then",
    "start": "1218780",
    "end": "1223820"
  },
  {
    "text": "need the size of memory space located by the digital variable is more than they",
    "start": "1223820",
    "end": "1230600"
  },
  {
    "text": "expected and finally it will cause a lot of bounds right vulnerabilities in this for",
    "start": "1230600",
    "end": "1237559"
  },
  {
    "text": "Loop so so also this is a very simple example",
    "start": "1237559",
    "end": "1242840"
  },
  {
    "text": "but it actually Bluetooth code I I did find some some Series so let's just uh",
    "start": "1242840",
    "end": "1250520"
  },
  {
    "text": "try to write a codecare script to check this time back",
    "start": "1250520",
    "end": "1256160"
  },
  {
    "text": "oh okay uh the first step I just we need to find our calls to these macros by",
    "start": "1256160",
    "end": "1263720"
  },
  {
    "text": "filtering only assigned expression type okay you can you can see the uh say the",
    "start": "1263720",
    "end": "1271160"
  },
  {
    "text": "code the left side is the codecare code and the right side is as website is a c",
    "start": "1271160",
    "end": "1277460"
  },
  {
    "text": "plus code and the sixth step is to identify our",
    "start": "1277460",
    "end": "1283760"
  },
  {
    "text": "expression that called the macros and showing the code and you can use insta",
    "start": "1283760",
    "end": "1289400"
  },
  {
    "text": "you can use instead of carrot to achieve this goal so this so this code this",
    "start": "1289400",
    "end": "1295460"
  },
  {
    "text": "codecare code is simple also in this in the third step we need",
    "start": "1295460",
    "end": "1302000"
  },
  {
    "text": "to find the case uh whether this is the serialized value are used in",
    "start": "1302000",
    "end": "1307120"
  },
  {
    "text": "arithmetrical Explorations so uh and which can be done by uh enumerating",
    "start": "1307120",
    "end": "1315020"
  },
  {
    "text": "common Expressions such as safe self self extreme selfies",
    "start": "1315020",
    "end": "1320780"
  },
  {
    "text": "self self increment and audition and",
    "start": "1320780",
    "end": "1325880"
  },
  {
    "text": "multiplication and charging where this deserialize the wine used in this white",
    "start": "1325880",
    "end": "1331520"
  },
  {
    "text": "wine uh so a last Point uh in order to reduce false positives I include the case where",
    "start": "1331520",
    "end": "1338900"
  },
  {
    "text": "there is a very high probability of low overflow such as the situation uh with",
    "start": "1338900",
    "end": "1344539"
  },
  {
    "text": "the maximum value of the left while variable is much quicker than the maximum maximum value of the white wide",
    "start": "1344539",
    "end": "1351260"
  },
  {
    "text": "variable uh this situation you can see in the uh and in the right in the right",
    "start": "1351260",
    "end": "1358899"
  },
  {
    "text": "so the last step uh after running this script on the nipple's library I got a",
    "start": "1361240",
    "end": "1367640"
  },
  {
    "text": "lot of results with quickly however this script is is used and codecode itself",
    "start": "1367640",
    "end": "1373220"
  },
  {
    "text": "has limitations imitation so most of the react are false positive uh such as cold",
    "start": "1373220",
    "end": "1379159"
  },
  {
    "text": "here such as they say code here uh the script can also recognize its relative",
    "start": "1379159",
    "end": "1384620"
  },
  {
    "text": "complex calculation expression but fortunately uh",
    "start": "1384620",
    "end": "1390740"
  },
  {
    "text": "through the fusing menu analysis I also found fourth really secret box",
    "start": "1390740",
    "end": "1397460"
  },
  {
    "text": "so let's just talk one of them so this vulnerability is located in the",
    "start": "1397460",
    "end": "1403820"
  },
  {
    "text": "sdp protect stack the value of the current handle is read from the",
    "start": "1403820",
    "end": "1408860"
  },
  {
    "text": "controllable buffer and it can take on any value from zero to",
    "start": "1408860",
    "end": "1415299"
  },
  {
    "text": "answer in 16 marks and the current handles will participated in multiple",
    "start": "1415299",
    "end": "1422840"
  },
  {
    "text": "subsequent asthmatic calculations and multiple inter overflows may occur",
    "start": "1422840",
    "end": "1428659"
  },
  {
    "text": "which will bypass this check of data data boundaries so finally needs to add",
    "start": "1428659",
    "end": "1434659"
  },
  {
    "text": "out of boundary bugs in the for Loop so I have with some comments in in the",
    "start": "1434659",
    "end": "1441320"
  },
  {
    "text": "code so you can you can look this next site",
    "start": "1441320",
    "end": "1447980"
  },
  {
    "text": "let's talk about another one of the things I found so this is one vulnerability is also the lens check is",
    "start": "1447980",
    "end": "1456320"
  },
  {
    "text": "bypassed due to enter under float this is similar seminar with the",
    "start": "1456320",
    "end": "1462620"
  },
  {
    "text": "previous vulnerabilities and you can give the details from the code",
    "start": "1462620",
    "end": "1468940"
  },
  {
    "text": "okay so uh let's look at the six the way code patents I used R3 due to including",
    "start": "1471919",
    "end": "1478700"
  },
  {
    "text": "error States so the Android Bluetooth implements a simple memory management",
    "start": "1478700",
    "end": "1484419"
  },
  {
    "text": "mechanisms uh the OSI molecule and OSI free function are simple income solution",
    "start": "1484419",
    "end": "1492380"
  },
  {
    "text": "of medical and free functions so uh we have audit the code I found that the",
    "start": "1492380",
    "end": "1498620"
  },
  {
    "text": "pmsg object will be passed in multiple functions especially send others",
    "start": "1498620",
    "end": "1503960"
  },
  {
    "text": "received between different handles for processing through the message Suite so",
    "start": "1503960",
    "end": "1509179"
  },
  {
    "text": "this architecture uh was uh will bring some potential risk",
    "start": "1509179",
    "end": "1515360"
  },
  {
    "text": "after after this object are followed many times some memory securebox approved local such as users are free",
    "start": "1515360",
    "end": "1522919"
  },
  {
    "text": "and double fluid so let's look at let's talk take a look at this simple example",
    "start": "1522919",
    "end": "1530059"
  },
  {
    "text": "so after this P Mastery object is passed into some function uh it will be free",
    "start": "1530059",
    "end": "1537159"
  },
  {
    "text": "under interpret it will be free on the third condition but but the color does",
    "start": "1537159",
    "end": "1543200"
  },
  {
    "text": "not check the return value of some function and directly use the pimentary object later so this this will need uh",
    "start": "1543200",
    "end": "1552080"
  },
  {
    "text": "use a few use of user user free one abilities",
    "start": "1552080",
    "end": "1557120"
  },
  {
    "text": "also so the conclusion is that the code is possible when ability if this if this",
    "start": "1557120",
    "end": "1563240"
  },
  {
    "text": "is a reach ability for between the allocation flow source and this",
    "start": "1563240",
    "end": "1568820"
  },
  {
    "text": "reference sync uh so let's write this code script",
    "start": "1568820",
    "end": "1576500"
  },
  {
    "text": "so this code scale script is slightly more complex than the previous one we",
    "start": "1576500",
    "end": "1581600"
  },
  {
    "text": "will use which ability alliances technology so first we need",
    "start": "1581600",
    "end": "1587179"
  },
  {
    "text": "we need to define the OSI free function in the script here here you can directly",
    "start": "1587179",
    "end": "1594740"
  },
  {
    "text": "use the dialect function which is provide provided by codecode itself and",
    "start": "1594740",
    "end": "1601580"
  },
  {
    "text": "you you can you can field it by the spatial function name you can see I this",
    "start": "1601580",
    "end": "1607700"
  },
  {
    "text": "is the space function the spatial function name here is OSI free and OSI",
    "start": "1607700",
    "end": "1614179"
  },
  {
    "text": "free and received so the next step the next step is to",
    "start": "1614179",
    "end": "1622460"
  },
  {
    "text": "find all expressions and call the OSI free function so here I mainly looked",
    "start": "1622460",
    "end": "1628640"
  },
  {
    "text": "for three types of course in so C code Block in the right",
    "start": "1628640",
    "end": "1634299"
  },
  {
    "text": "the first is directory call analysis is a direct free call with assigned one and",
    "start": "1634299",
    "end": "1642380"
  },
  {
    "text": "the third is Intuit free calls so so uh with this with these three types we can",
    "start": "1642380",
    "end": "1648440"
  },
  {
    "text": "cover most of the case so maybe we we also may include some",
    "start": "1648440",
    "end": "1654020"
  },
  {
    "text": "some situation but uh that's okay so another we need to find the",
    "start": "1654020",
    "end": "1660679"
  },
  {
    "text": "expressions and may uh please reference the object uh the current logic can be then understood by technical blocks on",
    "start": "1660679",
    "end": "1668360"
  },
  {
    "text": "the left and right side uh you can see the left side left is a good care code",
    "start": "1668360",
    "end": "1674179"
  },
  {
    "text": "and the right side is the same bus code so we have used some some API from the",
    "start": "1674179",
    "end": "1682460"
  },
  {
    "text": "clear itself so the last step I just built uh which",
    "start": "1682460",
    "end": "1690679"
  },
  {
    "text": "which ability licensed in addition to in addition to the source function and the",
    "start": "1690679",
    "end": "1696740"
  },
  {
    "text": "sync function we've talked before uh there is also a is battery function so",
    "start": "1696740",
    "end": "1702620"
  },
  {
    "text": "this function is used to fill out double three case so why why as we announced as we all know in the",
    "start": "1702620",
    "end": "1709580"
  },
  {
    "text": "double phase actually a special users are free case so of course you don't",
    "start": "1709580",
    "end": "1714740"
  },
  {
    "text": "have filled out to use the uppercase but uh but I feel hot because I also write a",
    "start": "1714740",
    "end": "1721220"
  },
  {
    "text": "larger script to catch uh use the R3 bug",
    "start": "1721220",
    "end": "1726980"
  },
  {
    "text": "uh after learning this script more than 30 results were generated and after many",
    "start": "1726980",
    "end": "1734120"
  },
  {
    "text": "others after many analysis I found three really secret box so let's check uh let's let's check this",
    "start": "1734120",
    "end": "1741799"
  },
  {
    "text": "one so this vulnerability is located in the bmep or text tank",
    "start": "1741799",
    "end": "1747799"
  },
  {
    "text": "and you can see the code in the left the pnep right buffer function uh is used to",
    "start": "1747799",
    "end": "1754520"
  },
  {
    "text": "send the pnep data packs to the peer devices and but in some special case for",
    "start": "1754520",
    "end": "1761720"
  },
  {
    "text": "example when a large number being impacts incent and Source blocks and",
    "start": "1761720",
    "end": "1767059"
  },
  {
    "text": "Source blocks the Queen the sending will fail at this time and then the internal",
    "start": "1767059",
    "end": "1773480"
  },
  {
    "text": "function Will Will just free P buffer objects but but the band is that the app",
    "start": "1773480",
    "end": "1781220"
  },
  {
    "text": "course includes the errors without and continues to use its release debuff object uh in the in the subscreen code",
    "start": "1781220",
    "end": "1788679"
  },
  {
    "text": "so this Behavior will will cause and use",
    "start": "1788679",
    "end": "1793700"
  },
  {
    "text": "the are free user after free bugs okay so uh in this talk I have talked",
    "start": "1793700",
    "end": "1802220"
  },
  {
    "text": "about two uh record patterns but I except except these two weeks buttons I",
    "start": "1802220",
    "end": "1808520"
  },
  {
    "text": "have read some others you can check you can check in this in this site but but",
    "start": "1808520",
    "end": "1815419"
  },
  {
    "text": "uh given the time is limit so I cannot end debug found by this script have not",
    "start": "1815419",
    "end": "1821539"
  },
  {
    "text": "been fixed so far so I I cannot introduce uh them today",
    "start": "1821539",
    "end": "1827559"
  },
  {
    "text": "but you can you can ask me uh uh with the with the with the email",
    "start": "1827960",
    "end": "1834260"
  },
  {
    "text": "and the in addition to writing critical script I also write some look first based on uh simulate the same missions",
    "start": "1834260",
    "end": "1841340"
  },
  {
    "text": "for some spatial function interface so uh you can see these three functions",
    "start": "1841340",
    "end": "1847220"
  },
  {
    "text": "uh which are used to register our air to cap best provided Cloud Bank functions",
    "start": "1847220",
    "end": "1854000"
  },
  {
    "text": "and by looking up the code to these functions you can quickly look at the",
    "start": "1854000",
    "end": "1859279"
  },
  {
    "text": "entrance of the other projects such as sdp and bnep gntt",
    "start": "1859279",
    "end": "1865360"
  },
  {
    "text": "and ifcom and so on so let's focus on the different donation",
    "start": "1865360",
    "end": "1871520"
  },
  {
    "text": "of the second parameters the member variable in the suite in the right box",
    "start": "1871520",
    "end": "1876799"
  },
  {
    "text": "here points to the data process callback function and we can quickly induct all",
    "start": "1876799",
    "end": "1882140"
  },
  {
    "text": "the code assigned and then assign the member variable by by browsing the",
    "start": "1882140",
    "end": "1887720"
  },
  {
    "text": "online OSP code website so just the sales.android.com",
    "start": "1887720",
    "end": "1894380"
  },
  {
    "text": "so in this talk uh let's just take the sdb protection as an example the SD data",
    "start": "1895100",
    "end": "1902120"
  },
  {
    "text": "in is a data call Bank function which is used to process our sdp data packs",
    "start": "1902120",
    "end": "1907399"
  },
  {
    "text": "received from Air to Cup and two different process function will be called according to the type of the data",
    "start": "1907399",
    "end": "1913880"
  },
  {
    "text": "point and different from the file formal",
    "start": "1913880",
    "end": "1919399"
  },
  {
    "text": "funding we cannot we cannot simply call an interface directly we need to configure some uh",
    "start": "1919399",
    "end": "1926440"
  },
  {
    "text": "nationalization data and then we need to set up different estimations to simulate",
    "start": "1926440",
    "end": "1933500"
  },
  {
    "text": "different Bluetooth connection States so that the father can can reach deeper I",
    "start": "1933500",
    "end": "1939440"
  },
  {
    "text": "thought you can you you can only get nothing so I have posted some main code",
    "start": "1939440",
    "end": "1945860"
  },
  {
    "text": "here uh so and if you are interested in this whole source code just call me I",
    "start": "1945860",
    "end": "1951440"
  },
  {
    "text": "just contact me I will give you the only source code so through this ideas I have discovered",
    "start": "1951440",
    "end": "1959360"
  },
  {
    "text": "a total of 631 abilities in 2022 and",
    "start": "1959360",
    "end": "1964580"
  },
  {
    "text": "among which three have been duplicate site but it has been fixed and the",
    "start": "1964580",
    "end": "1971120"
  },
  {
    "text": "others are still in the process so you can you cannot get all the survey",
    "start": "1971120",
    "end": "1977179"
  },
  {
    "text": "number are indeed in this site finally just uh just to make a summary",
    "start": "1977179",
    "end": "1983539"
  },
  {
    "text": "of today's topic I've introduced to some basic information about Android Bluetooth and",
    "start": "1983539",
    "end": "1990919"
  },
  {
    "text": "analyzed some Bluetooth vulnerabilities in recent years and shared the full attack surface I know and they",
    "start": "1990919",
    "end": "1997399"
  },
  {
    "text": "introduced some vulnerabilities hunting Technologies and that I have used in",
    "start": "1997399",
    "end": "2002860"
  },
  {
    "text": "this years so uh including codecare script and some funding text",
    "start": "2002860",
    "end": "2008760"
  },
  {
    "text": "and analyzed the root cause of some Civic case I found",
    "start": "2008760",
    "end": "2014980"
  },
  {
    "text": "okay the future is future so for the Bluetooth modules so also some partition",
    "start": "2014980",
    "end": "2020559"
  },
  {
    "text": "out of punch read and write vulnerabilities will become next and next but but we can pay attention to",
    "start": "2020559",
    "end": "2028360"
  },
  {
    "text": "this secret risk that may be caused by the design of the architecture itself so",
    "start": "2028360",
    "end": "2034059"
  },
  {
    "text": "such as some some decking points some of this condition in sweet messages and",
    "start": "2034059",
    "end": "2041440"
  },
  {
    "text": "some type confusing in measuring point so I have I have some submit uh some",
    "start": "2041440",
    "end": "2047080"
  },
  {
    "text": "some variables about about this about this",
    "start": "2047080",
    "end": "2052358"
  },
  {
    "text": "uh and uh and annotations so every Majors with",
    "start": "2052359",
    "end": "2057820"
  },
  {
    "text": "your update of Android will also introduce some new Bluetooth features so such as Le audio in Android searching so",
    "start": "2057820",
    "end": "2066658"
  },
  {
    "text": "uh and maybe we can also focus on some some Bluetooth stack implementation of",
    "start": "2066659",
    "end": "2073358"
  },
  {
    "text": "other windows such as the cocom yeah",
    "start": "2073359",
    "end": "2079179"
  },
  {
    "text": "so here are some materials as referred for for writing the site and I",
    "start": "2079179",
    "end": "2085599"
  },
  {
    "text": "appreciate this work uh very much so this is and thank you for taking time",
    "start": "2085599",
    "end": "2092858"
  },
  {
    "text": "to listen any question",
    "start": "2092859",
    "end": "2096720"
  },
  {
    "text": "[Music]",
    "start": "2097960",
    "end": "2101070"
  },
  {
    "text": "[Music]",
    "start": "2104910",
    "end": "2108020"
  }
]