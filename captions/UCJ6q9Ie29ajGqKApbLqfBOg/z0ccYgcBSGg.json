[
  {
    "start": "0",
    "end": "43000"
  },
  {
    "text": "and so without further ado today's speaker is David Litchfield and today's",
    "start": "179",
    "end": "5730"
  },
  {
    "text": "talk is find me in your database hey",
    "start": "5730",
    "end": "12330"
  },
  {
    "text": "good morning everybody thanks for coming I hope you're enjoying",
    "start": "12330",
    "end": "17550"
  },
  {
    "text": "your stay in Las Vegas so far it's just about to get even better so today's talks going to be about index",
    "start": "17550",
    "end": "28140"
  },
  {
    "text": "security in on the oracle database server finding mini database it's",
    "start": "28140",
    "end": "34590"
  },
  {
    "text": "supposed to be a bit funny like I owned you so you can find me any database but also look me up in your database because",
    "start": "34590",
    "end": "40680"
  },
  {
    "text": "it's index pace you know but so let's get on so Who am I I've been kicking",
    "start": "40680",
    "end": "47760"
  },
  {
    "start": "43000",
    "end": "148000"
  },
  {
    "text": "around the industry for probably about 15 years now primarily I'm a vulnerability researcher I started out",
    "start": "47760",
    "end": "54449"
  },
  {
    "text": "in buffer overflow exploitation a long while ago about 15 years ago or probably",
    "start": "54449",
    "end": "61890"
  },
  {
    "text": "about 12 I knew about this thing called buffer overflows it was this magic thing",
    "start": "61890",
    "end": "66960"
  },
  {
    "text": "that I didn't quite understand and I was playing around with the remote",
    "start": "66960",
    "end": "72240"
  },
  {
    "text": "connection manager you know the wrath service on Windows NT and put a long string of A's in the the rants phone",
    "start": "72240",
    "end": "79830"
  },
  {
    "text": "phone book basically and started something often this access violation kicked off address at four one four one",
    "start": "79830",
    "end": "87509"
  },
  {
    "text": "four one reference memory for 141 it's like wow that's one of these buffer overflow things these magic things that",
    "start": "87509",
    "end": "93090"
  },
  {
    "text": "people keep on speaking about so I taught myself how to exploit a buffer",
    "start": "93090",
    "end": "98100"
  },
  {
    "text": "overflow and as I was doing that I wrote a paper on it exploiting Windows NT for",
    "start": "98100",
    "end": "103590"
  },
  {
    "text": "buffer overflow is a tutorial and thing like that and I cringe now when I go back and look at that paper because it's",
    "start": "103590",
    "end": "108990"
  },
  {
    "text": "evident that I don't fully understand the idea I get code execution and everything but you know the whole",
    "start": "108990",
    "end": "114479"
  },
  {
    "text": "concept of overwriting a safe return address and this that no but it's just not in there it's plainly just not there",
    "start": "114479",
    "end": "120780"
  },
  {
    "text": "so yeah I cringe when I go back and read my old papers but it suffice so anyway moving",
    "start": "120780",
    "end": "127670"
  },
  {
    "text": "on from now I started looking at the windows 2003 stack protection stuff and wrote a paper on defeating that and",
    "start": "127670",
    "end": "135520"
  },
  {
    "text": "afterwards I moved into database security I was starting to look at Microsoft sequel server 2000 I",
    "start": "135520",
    "end": "143800"
  },
  {
    "text": "discovered the floor that slammer exploited and presented in May 2002 and",
    "start": "143800",
    "end": "150950"
  },
  {
    "start": "148000",
    "end": "171000"
  },
  {
    "text": "presented some shell code to demonstrate the exploit or how dangerously the floor",
    "start": "150950",
    "end": "156200"
  },
  {
    "text": "was in Sikkim server and then the people who wrote slam took my code and use that as the template so it was it it caused",
    "start": "156200",
    "end": "164239"
  },
  {
    "text": "me to question what I was doing at the time so anyway eventually Larry Ellison tangrams said his product was",
    "start": "164239",
    "end": "170870"
  },
  {
    "text": "unbreakable and I laughed and laughed and after I managed to stop laughing I",
    "start": "170870",
    "end": "176120"
  },
  {
    "text": "started researching there you know the the database and my brother and I between us sent within the 24 hours of",
    "start": "176120",
    "end": "182959"
  },
  {
    "text": "Larry Ellison saying that about 35 36 different flaws that allowed some really",
    "start": "182959",
    "end": "188780"
  },
  {
    "text": "silly ones like a an overly long username will allow you to cause a",
    "start": "188780",
    "end": "195049"
  },
  {
    "text": "stack-based buffer overflow and gain full control of the Oracle database ever",
    "start": "195049",
    "end": "200239"
  },
  {
    "text": "and this is a EA L 4 + certified product at the time so it's sort of just you",
    "start": "200239",
    "end": "206090"
  },
  {
    "text": "know in with far as the Common Criteria is concerned it you just had to read the database protection profile to",
    "start": "206090",
    "end": "211310"
  },
  {
    "text": "understand that you know no real thought had gone into actually securing it I think the protection profile says this",
    "start": "211310",
    "end": "218660"
  },
  {
    "text": "only works if you're on a non-hostile network well you know what's what's that",
    "start": "218660",
    "end": "223910"
  },
  {
    "text": "worth so eventually I get into the best forensics and because I realized that",
    "start": "223910",
    "end": "229430"
  },
  {
    "text": "and no matter what you do at some point you're still going to get owned and I think some of the work done by anonymous",
    "start": "229430",
    "end": "235250"
  },
  {
    "text": "recently has shown that you know we need to understand how to find out when",
    "start": "235250",
    "end": "240260"
  },
  {
    "text": "hackers and what they've done when they've got there how they did it and what we can do",
    "start": "240260",
    "end": "245280"
  },
  {
    "text": "to prevent them from doing it again in the future so I founded a company called Verity and that was recently acquired by",
    "start": "245280",
    "end": "251760"
  },
  {
    "text": "a cue bunch who is my current employment and some other stuff have done I've",
    "start": "251760",
    "end": "257370"
  },
  {
    "text": "written some some books and if you want to follow me on Twitter I sometimes tweet back to security stuff",
    "start": "257370",
    "end": "263220"
  },
  {
    "text": "I sometimes tweet about sharks probably more often to sharks than not and if you",
    "start": "263220",
    "end": "269490"
  },
  {
    "text": "want to contact me about any of this stuff my email address is delish builder hack Iman calm so further ado we can",
    "start": "269490",
    "end": "277560"
  },
  {
    "start": "275000",
    "end": "290000"
  },
  {
    "text": "skip that slide yeah this is the quick overview of what we're going to do today a quick overview of what indexes are in",
    "start": "277560",
    "end": "283680"
  },
  {
    "text": "the database and stuff and then look at some of the weaknesses in the articles version of indexing and then damage some",
    "start": "283680",
    "end": "289320"
  },
  {
    "text": "exploits now unfortunately this was a video which is no longer playing so I'll",
    "start": "289320",
    "end": "296430"
  },
  {
    "start": "290000",
    "end": "335000"
  },
  {
    "text": "describe what happens so there's a weak dog yapping an Oracle says this is an",
    "start": "296430",
    "end": "301710"
  },
  {
    "text": "unauthorized user and then there's a cake and they said this is your data and the cake is on top of a nice table and",
    "start": "301710",
    "end": "308160"
  },
  {
    "text": "though this little dog is trying to get the cake and oracle says we're I'm breakable the dog can't get the cake kind of now it would be so much funnier",
    "start": "308160",
    "end": "315270"
  },
  {
    "text": "if I could show it to you as opposed to me explaining to you but since we have no video you're left with me do I get an",
    "start": "315270",
    "end": "321240"
  },
  {
    "text": "Oscar for that by the way thank you that was my little dog",
    "start": "321240",
    "end": "327140"
  },
  {
    "text": "impression by the way via George George Newman sent me the in this video so I",
    "start": "327140",
    "end": "334460"
  },
  {
    "text": "was going to include it so the the motivations is basically trying to",
    "start": "334460",
    "end": "341000"
  },
  {
    "start": "335000",
    "end": "490000"
  },
  {
    "text": "improve Oracle's you know software or any database",
    "start": "341000",
    "end": "346010"
  },
  {
    "text": "software for that matter including Microsoft including including IBM and everyone so if we look at the flaws that",
    "start": "346010",
    "end": "353420"
  },
  {
    "text": "can be exploited specifically SQL in other words you know we're not interested in the HTTP floors we're not",
    "start": "353420",
    "end": "360590"
  },
  {
    "text": "interested in this and the other were the only ones we're interested in are the ones that are exploitable over ask",
    "start": "360590",
    "end": "365750"
  },
  {
    "text": "you on that okay and the the amount of flaws that Oracle of perhaps oh by the way each one of these is one of that",
    "start": "365750",
    "end": "371330"
  },
  {
    "text": "critical patch updates going back to July 2008 so past four years essentially",
    "start": "371330",
    "end": "376390"
  },
  {
    "text": "so we can see a marked improvement sorry I know nothing it covers an oracle 9i",
    "start": "376390",
    "end": "383090"
  },
  {
    "text": "released through all the way through oracle 11g release to the further you",
    "start": "383090",
    "end": "388850"
  },
  {
    "text": "get to the right the less 9i are to stuff very simply because they D supported it so we can see there a",
    "start": "388850",
    "end": "396290"
  },
  {
    "text": "marked improvement in on the the left hand side which is July 2008 they were",
    "start": "396290",
    "end": "402110"
  },
  {
    "text": "fixing with each critical patch update which comes out every three months you know between well at the worst about 15",
    "start": "402110",
    "end": "409280"
  },
  {
    "text": "floors every every three months just ask you on that ones and other than a few",
    "start": "409280",
    "end": "418100"
  },
  {
    "text": "months ago when they you know had about eleven I think it was they they've done really well so Oracle have done a great",
    "start": "418100",
    "end": "424340"
  },
  {
    "text": "job in terms of things like PL sequel injection flaws they're almost been hunted to extension now there's a couple",
    "start": "424340",
    "end": "430100"
  },
  {
    "text": "things like stack based buffer overflows again they've done a really good job there their data flow tools and analysis",
    "start": "430100",
    "end": "436340"
  },
  {
    "text": "are actually not too bad but they seem to be from what I can infer led by what",
    "start": "436340",
    "end": "443690"
  },
  {
    "text": "the security research part of the industry is doing that's what they'll focus on and make sure that there's",
    "start": "443690",
    "end": "450650"
  },
  {
    "text": "there's few bugs in that area but when the security industry turned over the security researchers site turns to a new",
    "start": "450650",
    "end": "457400"
  },
  {
    "text": "area that nons looked up before suddenly there's a whole bunch of low-hanging fruit again and so like for example a",
    "start": "457400",
    "end": "463880"
  },
  {
    "text": "few years ago I start looking at the Oracle architects re the the Java implementation within the Oracle",
    "start": "463880",
    "end": "469370"
  },
  {
    "text": "database over itself and there was a couple of a couple of fluffy things around there and then people have been",
    "start": "469370",
    "end": "475040"
  },
  {
    "text": "looking at the index side of things and again suddenly there's a whole slew of flaws in fact one of the things we'll be",
    "start": "475040",
    "end": "480770"
  },
  {
    "text": "speaking about which isn't my finding it's someone else's is a whole new class which really hasn't been probably",
    "start": "480770",
    "end": "486950"
  },
  {
    "text": "discussed yet just to give you some context this is Microsoft sequel server",
    "start": "486950",
    "end": "493810"
  },
  {
    "start": "490000",
    "end": "514000"
  },
  {
    "text": "in the same time period covering since sequel server 2000 and up to version 2",
    "start": "493810",
    "end": "501740"
  },
  {
    "text": "or 6 2008 this basically is the amount of flaws so that's how Oracle is doing",
    "start": "501740",
    "end": "508039"
  },
  {
    "text": "that sound Microsoft's doing so that's a pretty good good record so everyone",
    "start": "508039",
    "end": "517760"
  },
  {
    "start": "514000",
    "end": "709000"
  },
  {
    "text": "understands the concept of an index in the back of the book if you don't you should probably be in the kindergarten",
    "start": "517760",
    "end": "523729"
  },
  {
    "text": "class down the road but I'm sure everyone does so an index basically helps us find stuff quickly now the what",
    "start": "523729",
    "end": "531950"
  },
  {
    "text": "happens in Oracle is wonderful or indexes in Oracle are known as b-tree",
    "start": "531950",
    "end": "538580"
  },
  {
    "text": "and what that essentially does is well that's before we even go there so data",
    "start": "538580",
    "end": "544640"
  },
  {
    "text": "in Oracle is stored in blocks so they have a data file which is logically",
    "start": "544640",
    "end": "549709"
  },
  {
    "text": "split up into blocks of data now each block of data has rows within it now",
    "start": "549709",
    "end": "556640"
  },
  {
    "text": "what an index does basically is say which row and in which block you can",
    "start": "556640",
    "end": "562279"
  },
  {
    "text": "find a specific bit of it so let's say we've got a with a trillion records in it so",
    "start": "562279",
    "end": "568449"
  },
  {
    "text": "people's first and second names if we were to if we didn't have an index and we wanted to search for David Litchfield",
    "start": "568449",
    "end": "576190"
  },
  {
    "text": "we would have to go through every single block of data looking to see if David",
    "start": "576190",
    "end": "582430"
  },
  {
    "text": "literal record exists in that one if it's not moved to the next block and so on now what an index will do basically is",
    "start": "582430",
    "end": "587709"
  },
  {
    "text": "its split up those you know like Litchfield into you know a an order so",
    "start": "587709",
    "end": "596680"
  },
  {
    "text": "that say a 2n can be found over here and",
    "start": "596680",
    "end": "602220"
  },
  {
    "text": "and two Zedd can be found over here and so Litchfield is somewhere in between",
    "start": "602220",
    "end": "607870"
  },
  {
    "text": "men there and then the next level down in like it's like a tree node basically",
    "start": "607870",
    "end": "613569"
  },
  {
    "text": "with leaves coming out the next level down will look between like F and L and",
    "start": "613569",
    "end": "619120"
  },
  {
    "text": "so on and then move down until we get to the end node that points basically to where the record from Litchfield can be",
    "start": "619120",
    "end": "626290"
  },
  {
    "text": "found or L ITC and then the remaining records and so on so with only checking",
    "start": "626290",
    "end": "633009"
  },
  {
    "text": "three or four nodes within the index we can quickly locate through trillions and",
    "start": "633009",
    "end": "638560"
  },
  {
    "text": "trillions of records so that's why investors are so good they're created on",
    "start": "638560",
    "end": "644259"
  },
  {
    "text": "pretty much like one or more columns so as I said we we've got a first name and last name we might create an index that",
    "start": "644259",
    "end": "649389"
  },
  {
    "text": "indexes those columns so we can look up based upon that information or we can",
    "start": "649389",
    "end": "654880"
  },
  {
    "text": "have one or more indexes part table and stuff now there can be function based as well now what I mean by that is we might",
    "start": "654880",
    "end": "661269"
  },
  {
    "text": "want to uppercase litchfield or whatever their user name is before doing the search so we could create an index that",
    "start": "661269",
    "end": "667930"
  },
  {
    "text": "has a function in in embedded with it and then there's the main indexes the",
    "start": "667930",
    "end": "672970"
  },
  {
    "text": "main indexes are we're buying we have a complex data type so let's say we have",
    "start": "672970",
    "end": "680019"
  },
  {
    "text": "an error playing an aeroplane has things like a weight as a wingspan has a range and all",
    "start": "680019",
    "end": "687680"
  },
  {
    "text": "of these things might not be straightforward data then for example that there might be blobs there might be",
    "start": "687680",
    "end": "693830"
  },
  {
    "text": "this that or the other now what we can do basically is create our own domain index our own application domain that",
    "start": "693830",
    "end": "700190"
  },
  {
    "text": "allows us to still have indexes that search through these complex data types",
    "start": "700190",
    "end": "705290"
  },
  {
    "text": "so we'll look at some of these in a minute okay as far as privileges are concerned own",
    "start": "705290",
    "end": "712310"
  },
  {
    "start": "709000",
    "end": "752000"
  },
  {
    "text": "indexes to create an index on a table one of the following must be true we",
    "start": "712310",
    "end": "717440"
  },
  {
    "text": "either need to own the table or create any index privileges which typically you",
    "start": "717440",
    "end": "724250"
  },
  {
    "text": "know you will not find on the system or have the index privilege on a given table now remember I spoke about",
    "start": "724250",
    "end": "730370"
  },
  {
    "text": "function based indexes earlier people who know about Oracle should actually be",
    "start": "730370",
    "end": "738320"
  },
  {
    "text": "coming on if it's not already on if we have the index privilege on a table we",
    "start": "738320",
    "end": "743840"
  },
  {
    "text": "might be able to create a function based index on that table and if it's a function based index and it's using",
    "start": "743840",
    "end": "749750"
  },
  {
    "text": "author ID actually miss put this load on I'm jumping ahead okay so see ve 2010 0",
    "start": "749750",
    "end": "757970"
  },
  {
    "text": "9 0 to the this was discovered by a",
    "start": "757970",
    "end": "763880"
  },
  {
    "text": "friend of mine who whose give me permission to talk about this stuff or this specific floor and so basically if",
    "start": "763880",
    "end": "774260"
  },
  {
    "text": "you look at the floor the system user which is a very powerful user on the",
    "start": "774260",
    "end": "781490"
  },
  {
    "text": "oracle database server had two tables OLAP special cubes and OLAP session",
    "start": "781490",
    "end": "787010"
  },
  {
    "text": "things that basically gave public the index mission public is everybody on the day by server now this affected oracle",
    "start": "787010",
    "end": "795200"
  },
  {
    "text": "9i released two all the way through 11g released two and it was fixed in july 2010 but there was never any public",
    "start": "795200",
    "end": "801080"
  },
  {
    "text": "discussion about this now essentially what the problem is if we as public we",
    "start": "801080",
    "end": "807950"
  },
  {
    "text": "obviously as a user system have rights advert like derived",
    "start": "807950",
    "end": "813029"
  },
  {
    "text": "through that granted to public we can create an index on these tables now if",
    "start": "813029",
    "end": "818610"
  },
  {
    "text": "we can create an index on these tables and we create a function based index we can specify what that function is going to be and if we say write a function",
    "start": "818610",
    "end": "827129"
  },
  {
    "text": "that specifies author ID current user that essentially causes that function to",
    "start": "827129",
    "end": "834749"
  },
  {
    "text": "execute as the owner of the table which in this case is system so just a quick background on PL sequel injection by",
    "start": "834749",
    "end": "842519"
  },
  {
    "text": "default oracle pl/sql code which is like the way you develop sequel applications",
    "start": "842519",
    "end": "849420"
  },
  {
    "text": "are non-article by default it will run with the privileges of the definer in other words if I create a PL sequel",
    "start": "849420",
    "end": "855930"
  },
  {
    "text": "procedure or function whatever it will execute with my privileges if however I don't want that I want to execute with",
    "start": "855930",
    "end": "861870"
  },
  {
    "text": "the privileges of the person calling the function you know for security reasons then we can specify when we create the",
    "start": "861870",
    "end": "868740"
  },
  {
    "text": "function or the procedure or the package for that matter that it's to execute as the current user off ID current",
    "start": "868740",
    "end": "875040"
  },
  {
    "text": "underscore user now the thing is if there are P or sequel objects attached",
    "start": "875040",
    "end": "883230"
  },
  {
    "text": "to say a table or an index in this case or whatever it happens to be it will",
    "start": "883230",
    "end": "889230"
  },
  {
    "text": "execute with the privileges of the owner of that table or index or whatever so if we specify author ID current user so as",
    "start": "889230",
    "end": "896189"
  },
  {
    "text": "a nefarious attacker what we will do is basically on these tables create an index with a function based a function",
    "start": "896189",
    "end": "905639"
  },
  {
    "text": "based index that calls for example do you know grant deviate to public or",
    "start": "905639",
    "end": "912389"
  },
  {
    "text": "whatever it happens to be so because it will execute with their systems privileges so I'm give you a quick demo",
    "start": "912389",
    "end": "920610"
  },
  {
    "start": "917000",
    "end": "1014000"
  },
  {
    "text": "on this but in real life having researched this a bit further there's I",
    "start": "920610",
    "end": "925800"
  },
  {
    "text": "found that there's a table actually B dollar ACL which is owned by the X DB",
    "start": "925800",
    "end": "931709"
  },
  {
    "text": "user and if you have an Oracle 9 database server and then",
    "start": "931709",
    "end": "938029"
  },
  {
    "text": "upgraded it to 10 or 11 the permissions that were originally set on the install",
    "start": "938029",
    "end": "943459"
  },
  {
    "text": "scripts for for the X DB the external database stuff it did grant all on this",
    "start": "943459",
    "end": "948889"
  },
  {
    "text": "table to public grant all includes select insert update delete and the index permission now why why is this so",
    "start": "948889",
    "end": "956059"
  },
  {
    "text": "important well if you're running a database with a virtual private database in it and you've done an upgrade from 9",
    "start": "956059",
    "end": "962299"
  },
  {
    "text": "to either 10 or 11 G the permissions allow public to index create an index on",
    "start": "962299",
    "end": "970819"
  },
  {
    "text": "actually bid or a ACL and the X DB",
    "start": "970819",
    "end": "976790"
  },
  {
    "text": "account basically has the permissions to execute DBMS underscore RLS which is",
    "start": "976790",
    "end": "982850"
  },
  {
    "text": "used for defining virtual private databases so as an attack what we can do is come along and basically disable the",
    "start": "982850",
    "end": "988309"
  },
  {
    "text": "virtual private database and gain access to the data we should not be able to",
    "start": "988309",
    "end": "993319"
  },
  {
    "text": "gain access to and that's why it's important and also toad you know it's like a sequel tool and everything like",
    "start": "993319",
    "end": "999619"
  },
  {
    "text": "that I've seen every so often the index permission for public on the toad plan",
    "start": "999619",
    "end": "1006699"
  },
  {
    "text": "table and I'd but I can't work out where it's come from and why that's the case but anyway let's look at a demo we just",
    "start": "1006699",
    "end": "1019059"
  },
  {
    "start": "1014000",
    "end": "1306000"
  },
  {
    "text": "increased",
    "start": "1019059",
    "end": "1021480"
  },
  {
    "text": "okay",
    "start": "1053510",
    "end": "1056510"
  },
  {
    "text": "okay so I'm just going to do the sound first and explain what's going on right",
    "start": "1063290",
    "end": "1070670"
  },
  {
    "text": "so there is a table called Sumerian by the way so let's say system",
    "start": "1070670",
    "end": "1077990"
  },
  {
    "text": "Isis has a table called demo expert table and we will grant the selected",
    "start": "1077990",
    "end": "1084770"
  },
  {
    "text": "index privileges on it and then they",
    "start": "1084770",
    "end": "1093590"
  },
  {
    "text": "commit that so that's how that is set up complete okay so now we're going to connect as this guy right we should not",
    "start": "1093590",
    "end": "1105560"
  },
  {
    "text": "be able to do a set role DBA because we don't have DBA privileges yet okay roll",
    "start": "1105560",
    "end": "1111920"
  },
  {
    "text": "DB has not been granted or does not exist so we're now recall that we have",
    "start": "1111920",
    "end": "1118340"
  },
  {
    "text": "the index permission on the demo exploit table so what we're going to do is actually before we get there let's",
    "start": "1118340",
    "end": "1125180"
  },
  {
    "text": "create the nasty stuff right this function here let's explain what this",
    "start": "1125180",
    "end": "1132890"
  },
  {
    "text": "does quickly okay so we have a function with Craig called Y that takes a",
    "start": "1132890",
    "end": "1138980"
  },
  {
    "text": "parameter food and it returns a type of bar chart now it has to be deterministic",
    "start": "1138980",
    "end": "1145760"
  },
  {
    "text": "in this case if you're creating a function based index the function that's",
    "start": "1145760",
    "end": "1150920"
  },
  {
    "text": "going to be on that index needs to be deterministic now what that means it well it's relevant what that means right now but the key here is pragma",
    "start": "1150920",
    "end": "1158000"
  },
  {
    "text": "autonomous transaction now what that does basically it tells the the POC will",
    "start": "1158000",
    "end": "1163790"
  },
  {
    "text": "compile that everything that this stuff does is fine to execute in its own little transaction space and we're not",
    "start": "1163790",
    "end": "1171050"
  },
  {
    "text": "doing anything up towards nothing to see here move on move on and what we're doing is great granting the DBA mission",
    "start": "1171050",
    "end": "1178400"
  },
  {
    "text": "to the black hat user now I don't need to do a commit but sometimes if I don't",
    "start": "1178400",
    "end": "1183560"
  },
  {
    "text": "do the committed doesn't work so it's in there for safety's sake",
    "start": "1183560",
    "end": "1188080"
  },
  {
    "text": "now going back up here what we do is create this index on the table owned by",
    "start": "1190580",
    "end": "1201529"
  },
  {
    "text": "sis now what we're doing is creating an index called naughty index and we're",
    "start": "1201529",
    "end": "1207779"
  },
  {
    "text": "doing on the demo max white table and what we're telling it to do is execute this black hat white function now",
    "start": "1207779",
    "end": "1213929"
  },
  {
    "text": "remember that's set as author ID current users so when we query the table the",
    "start": "1213929",
    "end": "1221429"
  },
  {
    "text": "demo X book table the index stuff will be called and that function will be called and it will execute this as",
    "start": "1221429",
    "end": "1230340"
  },
  {
    "text": "privileges so that is created the index so now we just need to select from it",
    "start": "1230340",
    "end": "1236419"
  },
  {
    "text": "now as soon as we hit enter this function will be called in the background okay so now our export should",
    "start": "1236419",
    "end": "1245789"
  },
  {
    "text": "have worked out you know we should have executed this function this you know",
    "start": "1245789",
    "end": "1251100"
  },
  {
    "text": "this stuff here so we can do set rule DBA and we've now got DBA privileges so if we do select star from session prints",
    "start": "1251100",
    "end": "1263270"
  },
  {
    "text": "we've got you know every privilege basically whereas we didn't beforehand so if i revoke deviate from black",
    "start": "1263270",
    "end": "1275210"
  },
  {
    "text": "because we're going to do several more",
    "start": "1275330",
    "end": "1279740"
  },
  {
    "text": "and then drop me in this okay so you can",
    "start": "1281450",
    "end": "1287549"
  },
  {
    "text": "see how giving index permissions to a table to public or anyone for that",
    "start": "1287549",
    "end": "1292620"
  },
  {
    "text": "matter is dangerous because essentially gives them the ability to run code as",
    "start": "1292620",
    "end": "1297929"
  },
  {
    "text": "that user so don't do it it's naughty right so moving on to the next stuff",
    "start": "1297929",
    "end": "1305190"
  },
  {
    "text": "okay so I spoke about domain indexes",
    "start": "1305190",
    "end": "1311490"
  },
  {
    "start": "1306000",
    "end": "1426000"
  },
  {
    "text": "earlier it's the same it's extends indexing essentially now the we're doing",
    "start": "1311490",
    "end": "1320220"
  },
  {
    "text": "okay there's a whole bunch of extended indexing on on a default system",
    "start": "1320220",
    "end": "1327179"
  },
  {
    "text": "so both mdc-t access actually be an excellent exif SS all these have their own indexed",
    "start": "1327179",
    "end": "1334799"
  },
  {
    "text": "types that basically describe non-standard data you know in other words non non numbers non varchars and",
    "start": "1334799",
    "end": "1342990"
  },
  {
    "text": "so on so these are used for things like the spatial application and the context",
    "start": "1342990",
    "end": "1348899"
  },
  {
    "text": "application and so on now essentially what is described by this the indexing",
    "start": "1348899",
    "end": "1354720"
  },
  {
    "text": "interface is the oracle date cartridge interface and there are you basically",
    "start": "1354720",
    "end": "1360870"
  },
  {
    "text": "build an index type that have these methods on them and so for example we",
    "start": "1360870",
    "end": "1367679"
  },
  {
    "text": "would have OD CI indexed rate which would fire in the background on the event of an index type an index whether",
    "start": "1367679",
    "end": "1374580"
  },
  {
    "text": "that index type being created or if we dropped an index of that specific index type the ODC I index drop would fire and",
    "start": "1374580",
    "end": "1382049"
  },
  {
    "text": "so on now if you look at every single well I say every single job I've not looked at every single tutorial but the",
    "start": "1382049",
    "end": "1388889"
  },
  {
    "text": "ones I have look at that they all very neatly and nicely show you how to put",
    "start": "1388889",
    "end": "1394679"
  },
  {
    "text": "sequin jets and flaws into your applications you know it's even even the Oracle ones you know",
    "start": "1394679",
    "end": "1400830"
  },
  {
    "text": "the Oracle tutorials have teach you how to put sequel injection flaws in your in your code so if you in your own bespoke",
    "start": "1400830",
    "end": "1409110"
  },
  {
    "text": "or custom applications have created your own index types and stuff like that there's a very high chance that your",
    "start": "1409110",
    "end": "1415320"
  },
  {
    "text": "versions of ODC I index drop and create and so on will be vulnerable to sequel injections so if you're responsible for",
    "start": "1415320",
    "end": "1422429"
  },
  {
    "text": "this kind of stuff go back and take a look highly advise that now if we look",
    "start": "1422429",
    "end": "1428580"
  },
  {
    "start": "1426000",
    "end": "1615000"
  },
  {
    "text": "at another recent floor discovered by Martin Seavey 2011 35:12 basically it's",
    "start": "1428580",
    "end": "1436710"
  },
  {
    "text": "a bunch of special indexes which is this whole domain index stuff and on the event you drop an index you essentially",
    "start": "1436710",
    "end": "1445309"
  },
  {
    "text": "the index have to has to have the arbitrary SQL and the name and you in",
    "start": "1445309",
    "end": "1451190"
  },
  {
    "text": "close it with quotes you can basically",
    "start": "1451190",
    "end": "1456230"
  },
  {
    "text": "execute arbitrary SQL when you do the drop the index because in the background the ODC I index drop happens and that's",
    "start": "1456380",
    "end": "1465210"
  },
  {
    "text": "when it embeds your the name of your index into a block of POC code and",
    "start": "1465210",
    "end": "1470700"
  },
  {
    "text": "execute it now because it's owned by MD says you can't do a direct upgrade to a",
    "start": "1470700",
    "end": "1477899"
  },
  {
    "text": "privilege upgrade to DBA what you have to do is an indirect way basically there's a table system al dollar that",
    "start": "1477899",
    "end": "1486510"
  },
  {
    "text": "has public insert permissions on it and what the MDC Caesar does have is to",
    "start": "1486510",
    "end": "1493110"
  },
  {
    "text": "create any trigger privilege so what we do is correct trigger on this table in the system table for looking for inserts",
    "start": "1493110",
    "end": "1501269"
  },
  {
    "text": "so once we've created the trigger and the trigger calls on the various function which gives us DBA so when we",
    "start": "1501269",
    "end": "1508679"
  },
  {
    "text": "then insert into the system to oil table the trigger fires which cause our function which then grants us DBA",
    "start": "1508679",
    "end": "1514860"
  },
  {
    "text": "privileges now I'm not going to demo that because I'm matched against that of a fully patched",
    "start": "1514860",
    "end": "1521350"
  },
  {
    "text": "at the moment so there's no point in me demoing that one but it was fixed in",
    "start": "1521350",
    "end": "1527050"
  },
  {
    "text": "October 2011 but if we look back in 2006 there were a bunch of flaws in the city",
    "start": "1527050",
    "end": "1535360"
  },
  {
    "text": "exists the main indexing space whereby the same kind of issues were found so",
    "start": "1535360",
    "end": "1542440"
  },
  {
    "text": "for example the ODC I index drop and create and so on you would think if you",
    "start": "1542440",
    "end": "1548950"
  },
  {
    "text": "had a good security process in place that organization would turn around and say what else uses this stuff oh look",
    "start": "1548950",
    "end": "1556300"
  },
  {
    "text": "and assess the artery indexes and the spatial indexes call this stuff look and",
    "start": "1556300",
    "end": "1561309"
  },
  {
    "text": "we're vulnerable to injection here too they shouldn't be more proactive about it and fix it there and then but they did okay this one was patched in April",
    "start": "1561309",
    "end": "1574360"
  },
  {
    "text": "2012 I was hoping they were going to patch the other one which I'm about to speak about which is unpatched but this",
    "start": "1574360",
    "end": "1580059"
  },
  {
    "text": "one essentially is a classic stack based buffer overflow so if we alter an index",
    "start": "1580059",
    "end": "1585429"
  },
  {
    "text": "and rebuild the online parameters and put it basically a long string in there it causes a stack-based buffer overflow",
    "start": "1585429",
    "end": "1593020"
  },
  {
    "text": "and a reporter in 2011 then they actually got a fix really really quickly within a couple of months so not from a",
    "start": "1593020",
    "end": "1599350"
  },
  {
    "text": "hat to Oracle there and I'm again I'm not gonna demo this one because I'm",
    "start": "1599350",
    "end": "1604960"
  },
  {
    "text": "pastor gainst it but yes it's it's boring it's a classic second place by",
    "start": "1604960",
    "end": "1610510"
  },
  {
    "text": "fragra floyd own the system don't tell",
    "start": "1610510",
    "end": "1617290"
  },
  {
    "text": "anybody but this one's not patched so we",
    "start": "1617290",
    "end": "1623710"
  },
  {
    "text": "create table with an a dodgy colony the dodgy being we put a nefarious ester on",
    "start": "1623710",
    "end": "1629320"
  },
  {
    "text": "there we then create an index on the",
    "start": "1629320",
    "end": "1634330"
  },
  {
    "text": "column and then we run DBMS stats against it now DBMS stats goes about",
    "start": "1634330",
    "end": "1640120"
  },
  {
    "text": "doing some of this ovc I stuff for us we then drop the table and then BAM SQL run",
    "start": "1640120",
    "end": "1646660"
  },
  {
    "text": "so it's a second-order sequel injection as sis so yes let me explain that so i",
    "start": "1646660",
    "end": "1654580"
  },
  {
    "text": "on the table i on the index but because it's cysts executing after we run the",
    "start": "1654580",
    "end": "1660250"
  },
  {
    "text": "DBMS that's off on it it's sis own stuff that executes so we we get such",
    "start": "1660250",
    "end": "1666040"
  },
  {
    "text": "privileges directly so yeah well before we get there let's say i created a",
    "start": "1666040",
    "end": "1672010"
  },
  {
    "text": "column called and then quoted in double quotes food single quote bar double",
    "start": "1672010",
    "end": "1678730"
  },
  {
    "text": "quotes what happens is when we come to drop that index after writing DBMS that's on it",
    "start": "1678730",
    "end": "1684010"
  },
  {
    "text": "this is executed now you can see that we've got a single quote double quote",
    "start": "1684010",
    "end": "1691330"
  },
  {
    "text": "single quote so what that's done basically is broken us out of those single quotes and then we can tack on",
    "start": "1691330",
    "end": "1697000"
  },
  {
    "text": "the our arbitrary as well so that's the the anonymous block of PR sequel that's being executed in you know that's that's",
    "start": "1697000",
    "end": "1703540"
  },
  {
    "text": "where the floor lines underneath the covers so if i come back here and then",
    "start": "1703540",
    "end": "1714990"
  },
  {
    "text": "reconnect mmm",
    "start": "1721010",
    "end": "1728740"
  },
  {
    "text": "no it's gonna be wrong",
    "start": "1729090",
    "end": "1733490"
  },
  {
    "text": "okay buying show you trying to set the roll we've not been granted it because",
    "start": "1738289",
    "end": "1745130"
  },
  {
    "text": "remember we dropped the roll from us earlier so now so I've created a table",
    "start": "1745130",
    "end": "1756110"
  },
  {
    "text": "called pone Oracle and you can see here the column name I've created is double",
    "start": "1756110",
    "end": "1764000"
  },
  {
    "text": "quotes we need to enclose it in double quotes food single quote this double can",
    "start": "1764000",
    "end": "1772490"
  },
  {
    "text": "cat well this operator here the double pipe is the cou cats nature operator so basically what we're doing is the",
    "start": "1772490",
    "end": "1778520"
  },
  {
    "text": "results from the black hat X function its concatenated to foo and then we",
    "start": "1778520",
    "end": "1784580"
  },
  {
    "text": "concatenate bar onto the end of that so that's what we're doing here or that's what will happen in our second order",
    "start": "1784580",
    "end": "1789770"
  },
  {
    "text": "sequel injection and it's of type blob basically so we've created that table we",
    "start": "1789770",
    "end": "1796730"
  },
  {
    "text": "then create a an index of type C Texas context that's the index type and we",
    "start": "1796730",
    "end": "1804110"
  },
  {
    "text": "specified the name of the column which is our nasty food black hat stuff so",
    "start": "1804110",
    "end": "1809600"
  },
  {
    "text": "correct index and that's created so now",
    "start": "1809600",
    "end": "1814790"
  },
  {
    "text": "and this is this is the secret recipe or the secret part of the recipe we call a",
    "start": "1814790",
    "end": "1820460"
  },
  {
    "text": "DBMS that's on it gather table statistics now what that does see everyone's taking photographs of the",
    "start": "1820460",
    "end": "1826400"
  },
  {
    "text": "exploit nicely the yeah we basically",
    "start": "1826400",
    "end": "1832670"
  },
  {
    "text": "gather the stats for this table and in the process of doing this it will also",
    "start": "1832670",
    "end": "1837770"
  },
  {
    "text": "generate stats for the index as well so that's that done now when we come to",
    "start": "1837770",
    "end": "1844220"
  },
  {
    "text": "drop the table actually let me go back because I want to show you in action",
    "start": "1844220",
    "end": "1850000"
  },
  {
    "text": "drop table actually this is kind of fire off as now okay right let's just do it",
    "start": "1850000",
    "end": "1856730"
  },
  {
    "text": "right and I'll come back and show you right so essentially what I've got is a function here",
    "start": "1856730",
    "end": "1862919"
  },
  {
    "text": "acts that again it's using that off ID current user granting deviate to public",
    "start": "1862919",
    "end": "1868230"
  },
  {
    "text": "attitudes a black hat and we're calling that X function basically so when I do this that would have executed my X",
    "start": "1868230",
    "end": "1875909"
  },
  {
    "text": "function so I can now go sent role DBA and some DBA again okay so that's thank",
    "start": "1875909",
    "end": "1885359"
  },
  {
    "text": "you see the thing is I feel like a bit",
    "start": "1885359",
    "end": "1891840"
  },
  {
    "text": "of a fraud because I used to like do buffer overflows and now I'm hacking Oracle you know there's a trivial you",
    "start": "1891840",
    "end": "1898379"
  },
  {
    "text": "know I mean it's not like you're honing chromium here or anything like that you",
    "start": "1898379",
    "end": "1903899"
  },
  {
    "text": "know so as I said I feel like a fraud you know so yeah I'll show you this in",
    "start": "1903899",
    "end": "1909529"
  },
  {
    "text": "that's just simply",
    "start": "1909529",
    "end": "1913369"
  },
  {
    "text": "so whoops yeah this is basically just to show you it the error you would get and",
    "start": "1925950",
    "end": "1932490"
  },
  {
    "text": "that's how I you know realize that was going to be exploitable create index",
    "start": "1932490",
    "end": "1945050"
  },
  {
    "text": "yeah but - thank you okay okay see so we",
    "start": "1945050",
    "end": "1963330"
  },
  {
    "text": "get an error basically see him error occurred at recursive level because what it's trying to do embeds that foo single",
    "start": "1963330",
    "end": "1971340"
  },
  {
    "text": "quote bar in there and essentially chops this off making this like an identifier",
    "start": "1971340",
    "end": "1977940"
  },
  {
    "text": "kind of thing there so we get an identifier you know we get a bit of the code coming back up so we can see that it's you know vulnerable to sequel",
    "start": "1977940",
    "end": "1984840"
  },
  {
    "text": "injection and then from that point onwards it's guaranteed we own the system you know okay and we don't for",
    "start": "1984840",
    "end": "1994200"
  },
  {
    "text": "time okay I finished so yeah are there",
    "start": "1994200",
    "end": "2002270"
  },
  {
    "start": "1996000",
    "end": "2119000"
  },
  {
    "text": "any questions on that stuff sure is",
    "start": "2002270",
    "end": "2010400"
  },
  {
    "text": "there a microphone at all no might find that alright could you go",
    "start": "2010400",
    "end": "2017240"
  },
  {
    "text": "up to there and ask the question just so everyone can hear or I'll repeat the question",
    "start": "2017240",
    "end": "2023680"
  },
  {
    "text": "yeah okay so we have a tool that basically unwraps the PL sequel and it's",
    "start": "2027850",
    "end": "2035270"
  },
  {
    "text": "just reading through it but to be fair that's that's one I found just by like",
    "start": "2035270",
    "end": "2042740"
  },
  {
    "text": "playing with the system and dropped at the index and it was like Oh something",
    "start": "2042740",
    "end": "2048580"
  },
  {
    "text": "went wrong there and having to go back and reread through it and then you know so without the DBMS that's one",
    "start": "2048580",
    "end": "2055460"
  },
  {
    "text": "specifically was a just happens to have a stance trying to focus on but normally",
    "start": "2055460",
    "end": "2061639"
  },
  {
    "text": "it's like reading through the code and stuff sure",
    "start": "2061640",
    "end": "2069010"
  },
  {
    "text": "yeah you absolutely are and I just mean",
    "start": "2072570",
    "end": "2078419"
  },
  {
    "text": "sorry yeah oh wait till everyone's gone",
    "start": "2078420",
    "end": "2085020"
  },
  {
    "text": "so yeah the the question was are you leaving any interesting traces behind",
    "start": "2085350",
    "end": "2091000"
  },
  {
    "text": "as far as friends it's concerned yes you are you're creating indexes leaving",
    "start": "2091000",
    "end": "2097120"
  },
  {
    "text": "evidence in the SIS objects they button if you drop them once they're deleted we can still find them again and everything like that it's not so it's not the",
    "start": "2097120",
    "end": "2106240"
  },
  {
    "text": "interesting part though and there's nothing new in that technique which is",
    "start": "2106240",
    "end": "2111250"
  },
  {
    "text": "why it's not in there so any other who",
    "start": "2111250",
    "end": "2116950"
  },
  {
    "text": "wants to know how what did to my hand",
    "start": "2116950",
    "end": "2120480"
  },
  {
    "start": "2119000",
    "end": "2281000"
  },
  {
    "text": "that was the last photograph I took with the camera and when he bit me that's a",
    "start": "2122490",
    "end": "2129490"
  },
  {
    "text": "12-foot great white shark and again that's that's the shot",
    "start": "2129490",
    "end": "2135599"
  },
  {
    "text": "it died I'll show you the camera",
    "start": "2136020",
    "end": "2140520"
  },
  {
    "text": "yep so this was coming up after the dive that was me my great white that was just",
    "start": "2142290",
    "end": "2152350"
  },
  {
    "text": "before a bit so that was it coming around and I was like great it's going to swim over the top I'll get a great",
    "start": "2152350",
    "end": "2157360"
  },
  {
    "text": "shot of its snout and then back and that was my camera on the top and the scratch",
    "start": "2157360",
    "end": "2165880"
  },
  {
    "text": "marks done there underneath so this is a quarter inch alloy and it punctured",
    "start": "2165880",
    "end": "2173650"
  },
  {
    "text": "through that part there and it looked a bit of tooth embedded in there and obviously you can see in there and stuff",
    "start": "2173650",
    "end": "2180670"
  },
  {
    "text": "like that across the you know the housing in there that was a couple of days after yeah",
    "start": "2180670",
    "end": "2187510"
  },
  {
    "text": "that was the shot so but essentially the what happened was when it I didn't",
    "start": "2187510",
    "end": "2194890"
  },
  {
    "text": "actually realize that being bit at the time and you know my girlfriend was in",
    "start": "2194890",
    "end": "2200320"
  },
  {
    "text": "the cage next to me and she was like  idiot you know and so and then",
    "start": "2200320",
    "end": "2208210"
  },
  {
    "text": "I'm taking more photographs this is the the where is it so this here is the the",
    "start": "2208210",
    "end": "2214660"
  },
  {
    "text": "last photograph I took of it now there's a certain you can see the glow around the bottom that's because the camera",
    "start": "2214660",
    "end": "2219790"
  },
  {
    "text": "housing had leaked and it was ruining the camera and I noticed that it was",
    "start": "2219790",
    "end": "2226780"
  },
  {
    "text": "leaking on so I've got damn it so I said to the DM let's go what so we went up and it was only when I got to the",
    "start": "2226780",
    "end": "2233710"
  },
  {
    "text": "surface that my hand actually started bleeding because the water pressure we were down at 60 feet and the water pressure had basically stopped you know",
    "start": "2233710",
    "end": "2239740"
  },
  {
    "text": "any any bleeding under the ball so I was like oh look at me come on up there's a bit of truth and then some either just",
    "start": "2239740",
    "end": "2244810"
  },
  {
    "text": "like this so yeah my camera survived for about ten",
    "start": "2244810",
    "end": "2250080"
  },
  {
    "text": "minutes because it was just a very very slow leak and so the yeah that was the last shot that my camera ever took",
    "start": "2250080",
    "end": "2255530"
  },
  {
    "text": "but the housings I've repaired the housing now a goji clamp and a screwdriver and bit of brute force and",
    "start": "2255530",
    "end": "2262500"
  },
  {
    "text": "yet it's back in back in business so yeah anyway that's the hand was broken",
    "start": "2262500",
    "end": "2267660"
  },
  {
    "text": "before as well but then the shark bit it so it wasn't very nice okay well anyway",
    "start": "2267660",
    "end": "2274110"
  },
  {
    "text": "thank you very much for coming in",
    "start": "2274110",
    "end": "2277220"
  }
]