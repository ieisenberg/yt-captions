[
  {
    "text": "well first of all uh thank you for having me here I'm Jorge I'm a security",
    "start": "1000",
    "end": "6120"
  },
  {
    "text": "consultant from Argentina and I'll be here presenting a kind of Twisted attack",
    "start": "6120",
    "end": "12639"
  },
  {
    "text": "for Internet Explorer you will see why it twisted later",
    "start": "12639",
    "end": "19439"
  },
  {
    "text": "on uh here's a summary of uh what we will be discussing first I'll just",
    "start": "20160",
    "end": "27800"
  },
  {
    "text": "introduce the attack results what an attacker can do by uh by performing the",
    "start": "27800",
    "end": "33160"
  },
  {
    "text": "attack described here in and then we'll move to a brief description of some well",
    "start": "33160",
    "end": "40680"
  },
  {
    "text": "documented uh features of Internet Explorer some mechanisms that uh are",
    "start": "40680",
    "end": "46800"
  },
  {
    "text": "known to to exist and well we designed in such a way that an a programmer a",
    "start": "46800",
    "end": "52280"
  },
  {
    "text": "developer can uh build applications based upon those rules then we will discuss some other",
    "start": "52280",
    "end": "59519"
  },
  {
    "text": "features that are not so well documented but uh they can",
    "start": "59519",
    "end": "64640"
  },
  {
    "text": "be perhaps abused in such a way that uh involves a minor security risk each of",
    "start": "64640",
    "end": "72200"
  },
  {
    "text": "those features in Hand of itself but uh then in the next uh section we will see",
    "start": "72200",
    "end": "79159"
  },
  {
    "text": "how we can Strang all of these features together to build a nsak",
    "start": "79159",
    "end": "84439"
  },
  {
    "text": "vector then we will go in deeper detail about the overall impact that the that",
    "start": "84439",
    "end": "91079"
  },
  {
    "text": "the attack VOR Vector has will show a demo and then we will see the the",
    "start": "91079",
    "end": "97720"
  },
  {
    "text": "possible workarounds for the for the attack vectors",
    "start": "97720",
    "end": "102920"
  },
  {
    "text": "described well uh as a a successful compromise of a Windows Explorer uh user",
    "start": "103680",
    "end": "113520"
  },
  {
    "text": "uh will allow an attacker to uh have a blind but full access to uh every single",
    "start": "113520",
    "end": "120119"
  },
  {
    "text": "file in the big te's local Drive uh by blind I mean uh the attacker",
    "start": "120119",
    "end": "125960"
  },
  {
    "text": "cannot know uh beforehand the exact location of the files uh because it",
    "start": "125960",
    "end": "132120"
  },
  {
    "text": "cannot it has not the ability to brow the the hard drive but uh given the way",
    "start": "132120",
    "end": "138200"
  },
  {
    "text": "Internet Explorer and Windows Explorer itself uh handles its internal files and",
    "start": "138200",
    "end": "143640"
  },
  {
    "text": "how how they handle the user activity you can access most of the sensitive",
    "start": "143640",
    "end": "149319"
  },
  {
    "text": "files uh through these mechanisms uh those in those files",
    "start": "149319",
    "end": "155200"
  },
  {
    "text": "include uh binary files and text files uh you can access also cross domain information such as uh cookies for the",
    "start": "155200",
    "end": "162200"
  },
  {
    "text": "website you're visiting and all of the history files backup files in network",
    "start": "162200",
    "end": "168599"
  },
  {
    "text": "Administration environments has are are really common uh files that the user has",
    "start": "168599",
    "end": "174640"
  },
  {
    "text": "been working with recently uh personal pictures and other files that depending",
    "start": "174640",
    "end": "180319"
  },
  {
    "text": "what what is the the function of the machine the machine that is browsing uh that is being compromised I mean if if",
    "start": "180319",
    "end": "187040"
  },
  {
    "text": "this machine is a an IAS server you can try to access files inside the the web",
    "start": "187040",
    "end": "193920"
  },
  {
    "text": "root folder or configuration files depending on uh on which applications",
    "start": "193920",
    "end": "199480"
  },
  {
    "text": "has the the computer",
    "start": "199480",
    "end": "203920"
  },
  {
    "text": "installed well um every web browser has its own uh design uh patterns that have",
    "start": "205440",
    "end": "213519"
  },
  {
    "text": "been decided at design time by the developers um Internet Explorer has her",
    "start": "213519",
    "end": "220439"
  },
  {
    "text": "uh its uh its design uh patterns and some of these uh some of",
    "start": "220439",
    "end": "227879"
  },
  {
    "text": "these patterns uh are known uh to be there and are well documented so uh",
    "start": "227879",
    "end": "234319"
  },
  {
    "text": "developers can uh build applications uh based upon those rules uh we will be",
    "start": "234319",
    "end": "241560"
  },
  {
    "text": "reviewing here uh the security s shim the Su elevation uh rules for applic for",
    "start": "241560",
    "end": "248959"
  },
  {
    "text": "web applications and the M type detection those are features that are related to the attack we will be",
    "start": "248959",
    "end": "256040"
  },
  {
    "text": "exposing here um well uh the security Z shim allows uh",
    "start": "256040",
    "end": "263680"
  },
  {
    "text": "user or users or administrators to uh classify uh websites uh",
    "start": "263680",
    "end": "270800"
  },
  {
    "text": "to belonging to uh uh one uh subset or",
    "start": "270800",
    "end": "275919"
  },
  {
    "text": "another and each of those subset has different privileges uh regarding to",
    "start": "275919",
    "end": "282160"
  },
  {
    "text": "which Internet Explorer objects it that's that website can",
    "start": "282160",
    "end": "287919"
  },
  {
    "text": "access uh yep I'm wondering",
    "start": "287919",
    "end": "293479"
  },
  {
    "text": "what uh the attack the question is uh for which version of Internet Explorer",
    "start": "293479",
    "end": "300240"
  },
  {
    "text": "theack that does work for every Internet Explorer version are all all of the Internet",
    "start": "300240",
    "end": "306919"
  },
  {
    "text": "Explorer versions share share all of these features that we will be be discussing here you're welcome um well",
    "start": "306919",
    "end": "315759"
  },
  {
    "text": "uh each of these subsets uh has uh a different set of privileges uh depending on how trusty",
    "start": "315759",
    "end": "324199"
  },
  {
    "text": "how trustable is the the the web application the the security zones are",
    "start": "324199",
    "end": "330440"
  },
  {
    "text": "known are the restricted sight Zone the internet Zone the trusted sites uh Zone",
    "start": "330440",
    "end": "336400"
  },
  {
    "text": "the local internet internet and the local machine in an ascending order of",
    "start": "336400",
    "end": "341479"
  },
  {
    "text": "of privileges then there is a a kind of",
    "start": "341479",
    "end": "347000"
  },
  {
    "text": "behavior that a web application or a web page can present uh that is known as solid elevation that is when a when a",
    "start": "347000",
    "end": "355400"
  },
  {
    "text": "given application that belongs to a given Zone tries to load or to reference",
    "start": "355400",
    "end": "360880"
  },
  {
    "text": "content that is actually uh located in a in a higher privileges",
    "start": "360880",
    "end": "369840"
  },
  {
    "text": "Zone uh this this behavior is only allowed uh for uh the restricted site",
    "start": "369840",
    "end": "375479"
  },
  {
    "text": "zones I mean a site located at the restricted site zones could reference eventually an a resource located in the",
    "start": "375479",
    "end": "383080"
  },
  {
    "text": "internet Zone which is a bad idea because uh two couple of years ago uh",
    "start": "383080",
    "end": "389680"
  },
  {
    "text": "the first attack Vector that in in this line of attacks uh abused also of this",
    "start": "389680",
    "end": "396199"
  },
  {
    "text": "feature but uh for example you cannot Elevate privileges from a site located",
    "start": "396199",
    "end": "402360"
  },
  {
    "text": "in the internet to a local machine or to trusted sit that reference uh that kind",
    "start": "402360",
    "end": "408199"
  },
  {
    "text": "of elevation is not allowed uh then there is the MIM type",
    "start": "408199",
    "end": "415759"
  },
  {
    "text": "detection that uh comes to play when when you're accessing using Internet Explorer",
    "start": "415759",
    "end": "422520"
  },
  {
    "text": "you're accessing a web resource uh the the browser has to decide how will be",
    "start": "422520",
    "end": "429000"
  },
  {
    "text": "treated that resource I mean uh if it will be rendered as HTML if it will load",
    "start": "429000",
    "end": "435240"
  },
  {
    "text": "an ActiveX component to to work with it and to determine which uh which action",
    "start": "435240",
    "end": "442520"
  },
  {
    "text": "it will take uh it uses uh an algorithm",
    "start": "442520",
    "end": "448160"
  },
  {
    "text": "that is based on for one on on one hand the on the one hand the the content type",
    "start": "448160",
    "end": "456080"
  },
  {
    "text": "supplied by the server that is serving the content and on the other hand uh it",
    "start": "456080",
    "end": "461720"
  },
  {
    "text": "uh the decision is based upon uh a function that Internet Explorer has internally that is called find MIM from",
    "start": "461720",
    "end": "468800"
  },
  {
    "text": "data that basically scans a small buffer 255 bytes of the the first two uh 155",
    "start": "468800",
    "end": "477199"
  },
  {
    "text": "bytes of the of the object that was retrieved and then it takes the decision that how it will be",
    "start": "477199",
    "end": "484120"
  },
  {
    "text": "treated um if the if the server Supply uh M type",
    "start": "484120",
    "end": "490599"
  },
  {
    "text": "is unknown for the browser uh U the browser will treat uh the the object",
    "start": "490599",
    "end": "496919"
  },
  {
    "text": "that was requested uh uh according to the result from the find mine from data",
    "start": "496919",
    "end": "503319"
  },
  {
    "text": "function I mean if the the file extension is unknown for the browser uh and this function determines that the",
    "start": "503319",
    "end": "510400"
  },
  {
    "text": "content that is being uh trying to render is HTML the browser will treat the the OB the that object as",
    "start": "510400",
    "end": "517959"
  },
  {
    "text": "such and in the case that the MIM type is either or known or or ambiguous uh",
    "start": "517959",
    "end": "526800"
  },
  {
    "text": "the buffer will be scanned anyway because uh the browser will not trust directly to the uh the server suppli uh",
    "start": "526800",
    "end": "534839"
  },
  {
    "text": "content type and if there is a coincidence between the the content type",
    "start": "534839",
    "end": "542120"
  },
  {
    "text": "that the server supplied and the content type the find mind from data function has found uh the browser will take",
    "start": "542120",
    "end": "549880"
  },
  {
    "text": "action according to that to that content type but when there is no coincidence",
    "start": "549880",
    "end": "556519"
  },
  {
    "text": "and the and the server Supply M type is known I mean for example if the object",
    "start": "556519",
    "end": "564079"
  },
  {
    "text": "that the server is serving is an HTML resource is a content type uh text",
    "start": "564079",
    "end": "570360"
  },
  {
    "text": "HTML and uh the find mind from data function cannot uh reliably detect that",
    "start": "570360",
    "end": "577160"
  },
  {
    "text": "this is actually uh HTML content uh it will take an action based",
    "start": "577160",
    "end": "583279"
  },
  {
    "text": "on another thing if there is no conflict between the the base data type of the",
    "start": "583279",
    "end": "590600"
  },
  {
    "text": "base data type of the of the resource uh",
    "start": "590600",
    "end": "595720"
  },
  {
    "text": "where conflict is if the file is detected to be a text or",
    "start": "595720",
    "end": "601320"
  },
  {
    "text": "binary uh file the the provide the server provides the Mind type will be",
    "start": "601320",
    "end": "608720"
  },
  {
    "text": "will be used in that case so if if comp if there is a conflict if",
    "start": "608720",
    "end": "616240"
  },
  {
    "text": "the server supplied content doesn't match uh the the base content type I",
    "start": "616240",
    "end": "622640"
  },
  {
    "text": "mean for example for an HTML file the the find mind from data function",
    "start": "622640",
    "end": "628399"
  },
  {
    "text": "determines this to be a binary file there will be a mismatch so the algorithm will keep trying uh to to",
    "start": "628399",
    "end": "636560"
  },
  {
    "text": "determine uh the file type the actual file type by trying the extension of the",
    "start": "636560",
    "end": "641880"
  },
  {
    "text": "of the file and if there is no coincidence after uh matching the",
    "start": "641880",
    "end": "647600"
  },
  {
    "text": "extension with the with the extensions that Internet Explorer has set in the in the Windows registry uh the content type",
    "start": "647600",
    "end": "655959"
  },
  {
    "text": "will be defaulted to text um I know it is a bit long but uh the point",
    "start": "655959",
    "end": "662440"
  },
  {
    "text": "is that one of the key steps is perhaps the the one in which the server provides",
    "start": "662440",
    "end": "670000"
  },
  {
    "text": "supplies a content type and the find me the fine mind from data function is not",
    "start": "670000",
    "end": "675120"
  },
  {
    "text": "able to determine the the real content type so when there is no conflict the",
    "start": "675120",
    "end": "681720"
  },
  {
    "text": "this the browser will be forced in in a way to render the content uh",
    "start": "681720",
    "end": "689800"
  },
  {
    "text": "as as it is the content type supplied by the server",
    "start": "689800",
    "end": "695440"
  },
  {
    "text": "itself well now let's dig a deep a bit into some other features that Internet",
    "start": "696680",
    "end": "704040"
  },
  {
    "text": "Explorer has uh that have to do with the with the attack itself but those are not so well",
    "start": "704040",
    "end": "710440"
  },
  {
    "text": "documented some of them are known uh uh are even documented in uh a good uh book",
    "start": "710440",
    "end": "718079"
  },
  {
    "text": "that is the browser security handbook that Michael saleski wrote long time",
    "start": "718079",
    "end": "723600"
  },
  {
    "text": "ago um well let's start with the first of these",
    "start": "723600",
    "end": "729440"
  },
  {
    "text": "uh features um Internet Explorer uh has a",
    "start": "729440",
    "end": "736519"
  },
  {
    "text": "way to to track the user activity uh and to to keep their",
    "start": "736519",
    "end": "742160"
  },
  {
    "text": "sessions and their history files uh that is based uh on storing the",
    "start": "742160",
    "end": "748320"
  },
  {
    "text": "those that that information uh in special files and folders located under",
    "start": "748320",
    "end": "754199"
  },
  {
    "text": "the user profile folder um as some kind of",
    "start": "754199",
    "end": "760959"
  },
  {
    "text": "uh innocuous security measure um those files are randomly named the they don't",
    "start": "760959",
    "end": "769000"
  },
  {
    "text": "follow a a at least a an easy to understand pattern the names and and the",
    "start": "769000",
    "end": "775160"
  },
  {
    "text": "names of the files and the folders that Internet Explorer internal uses",
    "start": "775160",
    "end": "780839"
  },
  {
    "text": "and although those names and those those name of the files and those folder names",
    "start": "780920",
    "end": "786519"
  },
  {
    "text": "are random uh there is a map Internet Explorer builds some kind of of map in a",
    "start": "786519",
    "end": "794079"
  },
  {
    "text": "file called index that the and actually there are more than one there are",
    "start": "794079",
    "end": "800320"
  },
  {
    "text": "multiple index that files uh that are intended to track different things some",
    "start": "800320",
    "end": "806600"
  },
  {
    "text": "are for the cookies some are for the user navigation uh and so on there are a",
    "start": "806600",
    "end": "815199"
  },
  {
    "text": "lot but this files uh besides storing",
    "start": "817120",
    "end": "822320"
  },
  {
    "text": "the the information that we have mentioned uh",
    "start": "822320",
    "end": "827600"
  },
  {
    "text": "this information is not the only thing it that they store they store also another type of inter information I",
    "start": "827600",
    "end": "834480"
  },
  {
    "text": "think it is for internal usage of Internet Explorer but the the thing is that the sensitive",
    "start": "834480",
    "end": "840920"
  },
  {
    "text": "information is the the only thing that in the file that seems to be stored in",
    "start": "840920",
    "end": "846320"
  },
  {
    "text": "plain text so uh I think that's not a really good idea and that's a key to",
    "start": "846320",
    "end": "853199"
  },
  {
    "text": "access those ke files as as we'll see later",
    "start": "853199",
    "end": "858079"
  },
  {
    "text": "on well another feature in fact this is a kind of group of features uh Internet",
    "start": "860440",
    "end": "868120"
  },
  {
    "text": "Explorer behaves much like a Windows Explorer in many aspects uh both of them",
    "start": "868120",
    "end": "874279"
  },
  {
    "text": "share the the treat and layout engine that is the one in charge of rendering the the objects once presented in the in",
    "start": "874279",
    "end": "881519"
  },
  {
    "text": "the main window and both of them also supports uh",
    "start": "881519",
    "end": "887600"
  },
  {
    "text": "UNCC pads for accessing smv resources uh This Way um Internet",
    "start": "887600",
    "end": "895440"
  },
  {
    "text": "Explorer lets you uh perform some kind of tricks uh that Windows Explorer also",
    "start": "895440",
    "end": "901279"
  },
  {
    "text": "does as we can see here for example I don't know if he it it can be read what",
    "start": "901279",
    "end": "908519"
  },
  {
    "text": "is in the title if not I'll assume it for example when using uh Windows",
    "start": "908519",
    "end": "916600"
  },
  {
    "text": "Explorer for accessing the history folder uh the the what is shown in there",
    "start": "916600",
    "end": "922560"
  },
  {
    "text": "is not the actual content on the real content of the folder but some kind of sced so the use can try to browse in",
    "start": "922560",
    "end": "930399"
  },
  {
    "text": "that it in that way but if you try to access the same",
    "start": "930399",
    "end": "936240"
  },
  {
    "text": "folder by using by referring to your own computer using your the UNC",
    "start": "936240",
    "end": "941600"
  },
  {
    "text": "notation and accessing the SMB shared administrative resources you will see",
    "start": "941600",
    "end": "947199"
  },
  {
    "text": "what is actually in there uh there is a a file and a",
    "start": "947199",
    "end": "954240"
  },
  {
    "text": "folder as can be seen there as can be seen",
    "start": "954240",
    "end": "960680"
  },
  {
    "text": "here well the the full name is not shown here but uh when Internet Explorer",
    "start": "960680",
    "end": "967720"
  },
  {
    "text": "allows uh accessing it the same way you can access files in that folder",
    "start": "967720",
    "end": "976600"
  },
  {
    "text": "also um well uh another feature that Internet",
    "start": "981839",
    "end": "988079"
  },
  {
    "text": "Explorer uh shares with Windows Explorer it does that it can trigger SMB requests",
    "start": "988079",
    "end": "994680"
  },
  {
    "text": "to any website on the whole internet so if you uh include a tag like this one in",
    "start": "994680",
    "end": "1001839"
  },
  {
    "text": "a web page uh the user visiting that page uh",
    "start": "1001839",
    "end": "1008120"
  },
  {
    "text": "will automatically trigger a uh an SMB request uh towards uh that",
    "start": "1008120",
    "end": "1014959"
  },
  {
    "text": "website and as part of the challenge response negotiation corresponding to",
    "start": "1014959",
    "end": "1020199"
  },
  {
    "text": "that SMB request the user the Windows Explorer will automatically try the",
    "start": "1020199",
    "end": "1025839"
  },
  {
    "text": "first to obtain this resource anonymously and after it fails it will",
    "start": "1025839",
    "end": "1033038"
  },
  {
    "text": "automatically also uh try to authenticate with the current user credentials so the",
    "start": "1033039",
    "end": "1041160"
  },
  {
    "text": "the the remote server can learn from that request the the Windows Explorer",
    "start": "1041160",
    "end": "1047959"
  },
  {
    "text": "username name the domain name the computer name and it will have also the",
    "start": "1047959",
    "end": "1053880"
  },
  {
    "text": "results of the challenge response negotiation that will have place in will have",
    "start": "1053880",
    "end": "1059320"
  },
  {
    "text": "place um that and this also also involves",
    "start": "1059320",
    "end": "1065679"
  },
  {
    "text": "another security risk that is not used used in this attack but an attacker",
    "start": "1065679",
    "end": "1071880"
  },
  {
    "text": "could uh try to crack the challenge response negotiation and try to access",
    "start": "1071880",
    "end": "1077280"
  },
  {
    "text": "the remote the victim computer directly by",
    "start": "1077280",
    "end": "1082400"
  },
  {
    "text": "SMB well uh another of the Internet Explorer",
    "start": "1085919",
    "end": "1092600"
  },
  {
    "text": "features has to do with uh how to classify a a website or a URL to into as",
    "start": "1092600",
    "end": "1101280"
  },
  {
    "text": "as it as if it belongs to a given song um one of the rules that uh",
    "start": "1101280",
    "end": "1109120"
  },
  {
    "text": "can be read in the M sdn documentation is that uh a a UNCC address will be",
    "start": "1109120",
    "end": "1117120"
  },
  {
    "text": "treated as belonging to the Internet Security Zone when the path H written in",
    "start": "1117120",
    "end": "1123120"
  },
  {
    "text": "in in that UNCC address contains the IP address of the target",
    "start": "1123120",
    "end": "1128400"
  },
  {
    "text": "machine and when the name uh if there is not an IP address but a name this name",
    "start": "1128400",
    "end": "1136280"
  },
  {
    "text": "it doesn't have any dots will be treated as belonging to the local internet Zone",
    "start": "1136280",
    "end": "1141320"
  },
  {
    "text": "what makes sense because it is a uh the only way that a name cannot have dots is",
    "start": "1141320",
    "end": "1146720"
  },
  {
    "text": "because it is a a local internet uh name and if it has dots in it in in the",
    "start": "1146720",
    "end": "1155200"
  },
  {
    "text": "middle it uh will be treated as belonging to the internet Zone unless of",
    "start": "1155200",
    "end": "1161000"
  },
  {
    "text": "course added to the restricted SES on or the trusted sites",
    "start": "1161000",
    "end": "1166280"
  },
  {
    "text": "explicitly but uh when referring to your own",
    "start": "1166280",
    "end": "1171440"
  },
  {
    "text": "computer there is a a kind of problem because",
    "start": "1171440",
    "end": "1177240"
  },
  {
    "text": "uh uh referring to backlash backlash your computer name uh will make",
    "start": "1177240",
    "end": "1183799"
  },
  {
    "text": "reference to the local internet in in spite of this being",
    "start": "1183799",
    "end": "1188960"
  },
  {
    "text": "actually your own computer it will be treated as belonging to the local internet Zone and even more",
    "start": "1188960",
    "end": "1195679"
  },
  {
    "text": "uh when referring to it through its IP address through the loack IP address",
    "start": "1195679",
    "end": "1200880"
  },
  {
    "text": "also will be treated as belonging to the internet Zone",
    "start": "1200880",
    "end": "1207360"
  },
  {
    "text": "um this uh feature of Internet Explorer uh fits the rules of",
    "start": "1207360",
    "end": "1214400"
  },
  {
    "text": "uh uh of URL classification that Internet Explorer has documented and",
    "start": "1214400",
    "end": "1220440"
  },
  {
    "text": "shouldn't be a problem inand of itself but uh it's one of the key steps in the",
    "start": "1220440",
    "end": "1226600"
  },
  {
    "text": "attack that will be will be showing here uh we have a lot of uh conference",
    "start": "1226600",
    "end": "1233880"
  },
  {
    "text": "calls with the microsome uh security Response Center",
    "start": "1233880",
    "end": "1239159"
  },
  {
    "text": "and they they are kind of their words are that they are kind of stuck in here",
    "start": "1239159",
    "end": "1245159"
  },
  {
    "text": "because this feature cannot be easily easily fixed to say something because uh",
    "start": "1245159",
    "end": "1252520"
  },
  {
    "text": "they cannot uh assign those addresses to the their uh default corresponding to uh",
    "start": "1252520",
    "end": "1260799"
  },
  {
    "text": "corresponding SS without having impact on already existing",
    "start": "1260799",
    "end": "1266559"
  },
  {
    "text": "applications um well and let's see what why could that be a",
    "start": "1270039",
    "end": "1277200"
  },
  {
    "text": "problem uh that could be a problem because uh according to the the security s",
    "start": "1277200",
    "end": "1282960"
  },
  {
    "text": "Sheen uh a page that is located in a in a given Zone",
    "start": "1282960",
    "end": "1288760"
  },
  {
    "text": "cannot either neither reference or redirect its navigation to a more privileged Zone because it will be a",
    "start": "1288760",
    "end": "1296200"
  },
  {
    "text": "Sone elevation uh issue and it is not allowed but uh if considering the this",
    "start": "1296200",
    "end": "1303240"
  },
  {
    "text": "dialogue between a computer and a random uh server in the",
    "start": "1303240",
    "end": "1309159"
  },
  {
    "text": "internet uh if the server uh redirects the navigation towards a file that is",
    "start": "1309159",
    "end": "1316880"
  },
  {
    "text": "located in the own victim's computer the redirection will be uh will be",
    "start": "1316880",
    "end": "1323960"
  },
  {
    "text": "successful because it doesn't break any rules there it is Accord it is uh it",
    "start": "1323960",
    "end": "1330240"
  },
  {
    "text": "agrees with the with the guidelines of the Internet Explorer uh security Z",
    "start": "1330240",
    "end": "1337279"
  },
  {
    "text": "Sheen so the the redirection will",
    "start": "1337279",
    "end": "1342400"
  },
  {
    "text": "occur there is also another way uh to to bypass or to render uh useless in",
    "start": "1343159",
    "end": "1351760"
  },
  {
    "text": "this case uh the security Zone restrictions that is by basically using another protocol to access the resource",
    "start": "1351760",
    "end": "1359520"
  },
  {
    "text": "uh the remote resource for example if you're using HTTP for accessing a resource that is located in a web server",
    "start": "1359520",
    "end": "1367919"
  },
  {
    "text": "uh that is uh explicitly added to a restricted site uh you if you can access the server",
    "start": "1367919",
    "end": "1375840"
  },
  {
    "text": "the same server by using https or SMB the same resource will be treated as",
    "start": "1375840",
    "end": "1381159"
  },
  {
    "text": "belonging to uh internet so the restrictions applied explicitly will not have",
    "start": "1381159",
    "end": "1388278"
  },
  {
    "text": "effect here you can see uh something that is uh is hardcoded some way in in",
    "start": "1389120",
    "end": "1396440"
  },
  {
    "text": "Windows Behavior the cookies folder here uh is treated always as a restricted",
    "start": "1396440",
    "end": "1403320"
  },
  {
    "text": "site because the content stored in there is considered to be uh some way",
    "start": "1403320",
    "end": "1409600"
  },
  {
    "text": "dangerous but if you access the same file by using the UNCC",
    "start": "1409600",
    "end": "1416679"
  },
  {
    "text": "notation the file is located in a zone that is internet and the restrictions",
    "start": "1416799",
    "end": "1423919"
  },
  {
    "text": "that does not apply",
    "start": "1423919",
    "end": "1427039"
  },
  {
    "text": "anymore well now let's see how uh could manage uh an attacker uh to put some",
    "start": "1430520",
    "end": "1440039"
  },
  {
    "text": "some way uh HTML or scripting code",
    "start": "1440039",
    "end": "1445400"
  },
  {
    "text": "in in client's uh hard drives it can be done uh currently as in",
    "start": "1445400",
    "end": "1453120"
  },
  {
    "text": "every web browser through the navigation history files through cookies or in the",
    "start": "1453120",
    "end": "1458400"
  },
  {
    "text": "case of Internet Explorer also through the mapping files that are the index that files we have discussed",
    "start": "1458400",
    "end": "1466279"
  },
  {
    "text": "before the this is a feature that is common to every web browser and that's",
    "start": "1466559",
    "end": "1471720"
  },
  {
    "text": "okay but the problem here is not in the feature by itself but in the way it is",
    "start": "1471720",
    "end": "1477159"
  },
  {
    "text": "implemented because on the one hand uh those contents sent from the internet",
    "start": "1477159",
    "end": "1484039"
  },
  {
    "text": "are saved on those uh tracking files with little or no sanitization at all",
    "start": "1484039",
    "end": "1491080"
  },
  {
    "text": "so uh if you send something that is uh that can be some way interpreted uh",
    "start": "1491080",
    "end": "1499120"
  },
  {
    "text": "uh as code uh it will be stored as that as it",
    "start": "1499120",
    "end": "1504159"
  },
  {
    "text": "is and also Internet Explorer as most of the web browsers uh allows rendering uh",
    "start": "1504159",
    "end": "1511000"
  },
  {
    "text": "files that are not pure HTML but uh they have HTML Parts as HTML files and they",
    "start": "1511000",
    "end": "1519559"
  },
  {
    "text": "will simply ignore the parts that cannot be",
    "start": "1519559",
    "end": "1524120"
  },
  {
    "text": "rendered for example if uh you request a a page in a server and that that server",
    "start": "1524760",
    "end": "1532720"
  },
  {
    "text": "sets a cookie containing HTML code the cookie content will contain actually uh",
    "start": "1532720",
    "end": "1539279"
  },
  {
    "text": "that HTML",
    "start": "1539279",
    "end": "1542240"
  },
  {
    "text": "code well another feature that is used in this uh Zack Vector is uh abusing of",
    "start": "1545840",
    "end": "1555399"
  },
  {
    "text": "the way Internet Explorer treats uh a given file uh based on the Mind type",
    "start": "1555399",
    "end": "1562279"
  },
  {
    "text": "detection we have discussed before uh as we saw the the decision of of how",
    "start": "1562279",
    "end": "1570399"
  },
  {
    "text": "to treat a given file is based uh mainly upon the the server supplied M type and",
    "start": "1570399",
    "end": "1578840"
  },
  {
    "text": "how this uh and and the result of the find mind from data function after",
    "start": "1578840",
    "end": "1585200"
  },
  {
    "text": "scanning uh a small chunk from the file that that was tried to",
    "start": "1585200",
    "end": "1592559"
  },
  {
    "text": "obtain but there are uh some problems in in this implementation",
    "start": "1594080",
    "end": "1599760"
  },
  {
    "text": "because uh as we discussed that first uh",
    "start": "1599760",
    "end": "1605279"
  },
  {
    "text": "the server the server provide M type will be used uh will be forced when the",
    "start": "1605279",
    "end": "1611279"
  },
  {
    "text": "following conditions are true when there's no positive match obtained from the F mine from data uh",
    "start": "1611279",
    "end": "1619159"
  },
  {
    "text": "scan and and the server provided mind type is known and there is no conflict",
    "start": "1619159",
    "end": "1624720"
  },
  {
    "text": "so the file is not uh is not entirely different from the from the one the",
    "start": "1624720",
    "end": "1631279"
  },
  {
    "text": "server is suggesting and there is also another",
    "start": "1631279",
    "end": "1637399"
  },
  {
    "text": "problem that has been proved that Internet Explorer doesn't behave",
    "start": "1637399",
    "end": "1642880"
  },
  {
    "text": "consistently in the same way when accessing the same resource uh by different means",
    "start": "1642880",
    "end": "1649600"
  },
  {
    "text": "um for example when accessing a resource by direct navigation uh Internet Explorer can",
    "start": "1649600",
    "end": "1657760"
  },
  {
    "text": "render uh uh that resource in a given way but if accessing the same resource",
    "start": "1657760",
    "end": "1663880"
  },
  {
    "text": "through an if reference or through a scripting or through a red Direction the",
    "start": "1663880",
    "end": "1668919"
  },
  {
    "text": "resource can be treated as if it was uh of another type uh that has been also a",
    "start": "1668919",
    "end": "1677000"
  },
  {
    "text": "key to to carry out this this attack",
    "start": "1677000",
    "end": "1681240"
  },
  {
    "text": "Vector uh for example in the first advisory we have published in that line",
    "start": "1683120",
    "end": "1689000"
  },
  {
    "text": "of in this line of attacks um when when a website contains a an",
    "start": "1689000",
    "end": "1696679"
  },
  {
    "text": "object uh an object HTML object um referencing a resource that can be",
    "start": "1696679",
    "end": "1704240"
  },
  {
    "text": "treated as HTML uh the resource is treated as",
    "start": "1704240",
    "end": "1711120"
  },
  {
    "text": "such but the the point here is uh when",
    "start": "1711120",
    "end": "1716360"
  },
  {
    "text": "you try to access a resource to to treat a resource that is not uh HTML and that",
    "start": "1716360",
    "end": "1723640"
  },
  {
    "text": "Internet Explorer will uh find not to be HTML through an object",
    "start": "1723640",
    "end": "1730320"
  },
  {
    "text": "directly uh Internet Explorer will complain and will not allow rendering that object but if you access",
    "start": "1730320",
    "end": "1738000"
  },
  {
    "text": "that object uh through a redirection first referring to a a valid HTML object",
    "start": "1738000",
    "end": "1744720"
  },
  {
    "text": "and then referring to the object that is not HTML Internet Explorer would",
    "start": "1744720",
    "end": "1750320"
  },
  {
    "text": "actually uh render that object as HTML that uh that was uh the key to to",
    "start": "1750320",
    "end": "1757960"
  },
  {
    "text": "perform this first uh",
    "start": "1757960",
    "end": "1761600"
  },
  {
    "text": "attack um well so far we have been just uh exposing some small features that",
    "start": "1763279",
    "end": "1771120"
  },
  {
    "text": "Internet Explorer has um perhaps the is not so obvious the connection between",
    "start": "1771120",
    "end": "1776760"
  },
  {
    "text": "them and what is indeed obvious is that uh some of them or most of them implies",
    "start": "1776760",
    "end": "1784679"
  },
  {
    "text": "uh perhaps small security risk uh I mean for example uh storing uh sensitive",
    "start": "1784679",
    "end": "1791159"
  },
  {
    "text": "information inside index that files as text as raw text perhaps is not a big",
    "start": "1791159",
    "end": "1797600"
  },
  {
    "text": "deal because who who will access those files or perhaps",
    "start": "1797600",
    "end": "1803320"
  },
  {
    "text": "uh uh the classification for the URL depending on if it is an IP address or",
    "start": "1803320",
    "end": "1808840"
  },
  {
    "text": "if it is a name uh when referring to your local machine perhaps is not a big deal uh while uh analyzed uh on its own",
    "start": "1808840",
    "end": "1819519"
  },
  {
    "text": "but let's see how can we combine uh all of those features to uh carry out an",
    "start": "1819519",
    "end": "1826240"
  },
  {
    "text": "attack we'll discuss some uh we'll discuss two scenarios the first one uh will be",
    "start": "1826240",
    "end": "1833399"
  },
  {
    "text": "intended will have less steps and will be uh intended to cover a scenario in a",
    "start": "1833399",
    "end": "1840279"
  },
  {
    "text": "local internet where users have a shared folders to exchanging documents music",
    "start": "1840279",
    "end": "1847240"
  },
  {
    "text": "and so on and the second will be more General uh will cover uh the common",
    "start": "1847240",
    "end": "1853080"
  },
  {
    "text": "internet user directly connected to internet",
    "start": "1853080",
    "end": "1859080"
  },
  {
    "text": "well um the first uh scenario here is has",
    "start": "1859080",
    "end": "1865279"
  },
  {
    "text": "this series of steps the attacker have to manage to put HTML files in the",
    "start": "1865279",
    "end": "1871919"
  },
  {
    "text": "victim shared folders in a network and a local internet environment this is quite common to find uh shared folders with",
    "start": "1871919",
    "end": "1879360"
  },
  {
    "text": "right permissions so uh someone in the network uh could just put an HTML file",
    "start": "1879360",
    "end": "1885279"
  },
  {
    "text": "in there then uh this uh malicious employee in the in",
    "start": "1885279",
    "end": "1892399"
  },
  {
    "text": "the company could send the the the user",
    "start": "1892399",
    "end": "1898480"
  },
  {
    "text": "a click a link to so the user clicks on that link and then a redirection URS",
    "start": "1898480",
    "end": "1906240"
  },
  {
    "text": "towards that file in that way Jer could uh put a a malicious HTML file in",
    "start": "1906240",
    "end": "1916279"
  },
  {
    "text": "the in the Shir resource and after clicking on the link",
    "start": "1916279",
    "end": "1921600"
  },
  {
    "text": "the attacker sent to the victim the the victim gets redirected to the resource",
    "start": "1921600",
    "end": "1927240"
  },
  {
    "text": "uh that the attacker uploaded to the to the victim's computer so if it if this",
    "start": "1927240",
    "end": "1933840"
  },
  {
    "text": "occurs uh the attacker will uh have HTML code and script code running in the",
    "start": "1933840",
    "end": "1940159"
  },
  {
    "text": "context of uh of the victim's local machine but with the Privileges of the",
    "start": "1940159",
    "end": "1947200"
  },
  {
    "text": "of internet as we saw that it is a classification this is actually indeed",
    "start": "1947200",
    "end": "1954120"
  },
  {
    "text": "the the victim's computer but the Privileges of the code running there uh",
    "start": "1954120",
    "end": "1959480"
  },
  {
    "text": "will be as uh if it was a site belonging to the internet",
    "start": "1959480",
    "end": "1966440"
  },
  {
    "text": "Zone well the most General approach is uh a bit more complicated to to be",
    "start": "1966840",
    "end": "1973519"
  },
  {
    "text": "carried out but it is uh easily understandable after seeing uh all of",
    "start": "1973519",
    "end": "1980200"
  },
  {
    "text": "the things we have been discussing so far uh basically uh an attacker just",
    "start": "1980200",
    "end": "1987200"
  },
  {
    "text": "should entice a potential victim to click a link to a malicious",
    "start": "1987200",
    "end": "1993760"
  },
  {
    "text": "website uh the this website uh has to contain an",
    "start": "1993760",
    "end": "2000519"
  },
  {
    "text": "image tag with a UNCC path to the malitia server as we saw before uh so so uh this way the attacker",
    "start": "2000519",
    "end": "2010760"
  },
  {
    "text": "uh could manage to obtain the victims uh actual usern name that username will be",
    "start": "2010760",
    "end": "2017440"
  },
  {
    "text": "needed to to carry out the attack later on uh in the",
    "start": "2017440",
    "end": "2023799"
  },
  {
    "text": "meantime this uh malicious web page the user is visiting uh will write in the",
    "start": "2023799",
    "end": "2030360"
  },
  {
    "text": "victim's computer tracking files uh malicious HTML",
    "start": "2030360",
    "end": "2035960"
  },
  {
    "text": "code then uh the server will be running scripts",
    "start": "2035960",
    "end": "2043679"
  },
  {
    "text": "based on the information it obtained through SMB uh will be running scripts so to",
    "start": "2043679",
    "end": "2050200"
  },
  {
    "text": "build uh the right uh paths to the internal tracking files that as we saw",
    "start": "2050200",
    "end": "2055800"
  },
  {
    "text": "are located inside the user's profile that's why we needed the username so",
    "start": "2055800",
    "end": "2063760"
  },
  {
    "text": "uh this files uh this uh this file the server is building will be a referenced",
    "start": "2063760",
    "end": "2070000"
  },
  {
    "text": "together after a a",
    "start": "2070000",
    "end": "2073000"
  },
  {
    "text": "redirection um at this point",
    "start": "2076839",
    "end": "2082560"
  },
  {
    "text": "uh the the trick here is to force some way",
    "start": "2082560",
    "end": "2088760"
  },
  {
    "text": "to R when redirecting the navigation to this fice the the server",
    "start": "2088760",
    "end": "2094480"
  },
  {
    "text": "Rin uh the the trick is to to force",
    "start": "2094480",
    "end": "2100480"
  },
  {
    "text": "Internet Explorer to render to treat those files as it as if it was HTML",
    "start": "2100480",
    "end": "2107359"
  },
  {
    "text": "code uh this is something that has been done uh many times already and given the",
    "start": "2107359",
    "end": "2116400"
  },
  {
    "text": "the nature of the of the feature itself given that it is not actually a bag but",
    "start": "2116400",
    "end": "2123960"
  },
  {
    "text": "a feature they cannot simply remove it in fact what Microsoft is doing so far",
    "start": "2123960",
    "end": "2129200"
  },
  {
    "text": "is uh just preventing our proof of Concepts from working but every time",
    "start": "2129200",
    "end": "2135839"
  },
  {
    "text": "they did it we managed to find another way to to do it again so this has a lot",
    "start": "2135839",
    "end": "2142440"
  },
  {
    "text": "to do with the complexity of the mind tab detection and well if an attacker",
    "start": "2142440",
    "end": "2149440"
  },
  {
    "text": "manages to to perform that will have the same impact as the the previous scenario",
    "start": "2149440",
    "end": "2154680"
  },
  {
    "text": "that is HTML and scripting code running in the context of the victim's local machine but with internet Z",
    "start": "2154680",
    "end": "2164040"
  },
  {
    "text": "privileges so uh as a result of this attack",
    "start": "2164040",
    "end": "2172200"
  },
  {
    "text": "uh in the process an attacker is able to store HTML and scripting code of their",
    "start": "2172200",
    "end": "2179640"
  },
  {
    "text": "choice of her choice in the victim's computer and by the r ction mechanisms",
    "start": "2179640",
    "end": "2188560"
  },
  {
    "text": "and is forcing the victim's browser to load and render this uh this HTML",
    "start": "2188560",
    "end": "2196079"
  },
  {
    "text": "code and as we said the this code uh is actually running in the internet Zone",
    "start": "2196079",
    "end": "2202560"
  },
  {
    "text": "but is also running in the victim's local computer so it has at least enough",
    "start": "2202560",
    "end": "2209880"
  },
  {
    "text": "privileges to access every single file in the same origin it doesn't violate",
    "start": "2209880",
    "end": "2215480"
  },
  {
    "text": "the same origin policy it doesn't violate the the the security sun machine the sun",
    "start": "2215480",
    "end": "2222280"
  },
  {
    "text": "elevation it's all right it's according to the rules so it can access lot of",
    "start": "2222280",
    "end": "2228800"
  },
  {
    "text": "interesting files as we can see uh we will see this in a in a demonstration",
    "start": "2228800",
    "end": "2235079"
  },
  {
    "text": "right now and well this before anything this this",
    "start": "2235079",
    "end": "2244119"
  },
  {
    "text": "process of uh of forcing internet uh Explorer to treat a file as HTML uh has",
    "start": "2244119",
    "end": "2250920"
  },
  {
    "text": "been done in three advisories so far the last one is being published today and it",
    "start": "2250920",
    "end": "2256720"
  },
  {
    "text": "will be available I think it should be available right now in the car security",
    "start": "2256720",
    "end": "2262319"
  },
  {
    "text": "website uh and the only difference between each",
    "start": "2262319",
    "end": "2267480"
  },
  {
    "text": "of these vectors is the way in which Internet Explorer was tricked into",
    "start": "2267480",
    "end": "2272800"
  },
  {
    "text": "rendering uh those files as HTML and also perhaps the difference was",
    "start": "2272800",
    "end": "2279359"
  },
  {
    "text": "which files were were used in in each of those uh attack vectors in the first one",
    "start": "2279359",
    "end": "2285119"
  },
  {
    "text": "uh I managed to use the cookies for for this purpose and in the latest two the",
    "start": "2285119",
    "end": "2293000"
  },
  {
    "text": "the the file I used uh is the index dat that is used for navigation",
    "start": "2293000",
    "end": "2299960"
  },
  {
    "text": "tracking and as this is the only thing Microsoft is is fixing is and actually",
    "start": "2299960",
    "end": "2306680"
  },
  {
    "text": "it isn't Microsoft isn't fixing it it's just uh twisting it a little bit so this",
    "start": "2306680",
    "end": "2312200"
  },
  {
    "text": "proof of concept doesn't work because they cannot fix something that is not a back is a feature uh that's a",
    "start": "2312200",
    "end": "2319960"
  },
  {
    "text": "problem and that's the reason because uh why we are still doing it over and over",
    "start": "2319960",
    "end": "2329040"
  },
  {
    "text": "again well let's see if it works let's see if it all all I told you it's",
    "start": "2329280",
    "end": "2336160"
  },
  {
    "text": "actually true um for this demo what I uh what I",
    "start": "2336160",
    "end": "2342040"
  },
  {
    "text": "will do here I have built a a module for",
    "start": "2342040",
    "end": "2347119"
  },
  {
    "text": "beef uh beef is a cross side scripting exploitation framework most of you",
    "start": "2347119",
    "end": "2352720"
  },
  {
    "text": "should have heard of it um uh what I will do here",
    "start": "2352720",
    "end": "2360800"
  },
  {
    "text": "is just open Internet Explorer and do what an attacker will do",
    "start": "2360800",
    "end": "2366119"
  },
  {
    "text": "is in this case uh point a victim to a to a",
    "start": "2366119",
    "end": "2371720"
  },
  {
    "text": "malicious",
    "start": "2371720",
    "end": "2374280"
  },
  {
    "text": "website uh if you have used uh B before you will recognize this URL as it is the",
    "start": "2379079",
    "end": "2386520"
  },
  {
    "text": "default connection page for for",
    "start": "2386520",
    "end": "2392839"
  },
  {
    "text": "beef so once once the user us is visiting that page it will automatically",
    "start": "2394000",
    "end": "2400520"
  },
  {
    "text": "be logged and and accessible in the beef console from here an attacker uh we",
    "start": "2400520",
    "end": "2406920"
  },
  {
    "text": "using bi always has been able to send custom JavaScript code and even there",
    "start": "2406920",
    "end": "2414000"
  },
  {
    "text": "are some exploits for browsers available right now well this is the model I have",
    "start": "2414000",
    "end": "2421560"
  },
  {
    "text": "developed uh by pressing this button uh what",
    "start": "2421560",
    "end": "2426880"
  },
  {
    "text": "should happen here is the following uh the web server will send uh the",
    "start": "2426880",
    "end": "2434760"
  },
  {
    "text": "client code uh for appending a dynamic uh SMB",
    "start": "2434760",
    "end": "2441520"
  },
  {
    "text": "referenced image so the the server should uh learn this information from",
    "start": "2441520",
    "end": "2450000"
  },
  {
    "text": "the from the victim okay I have to select it first",
    "start": "2450000",
    "end": "2458000"
  },
  {
    "text": "and let's go",
    "start": "2458000",
    "end": "2460640"
  },
  {
    "text": "again after this uh the server is automatically uh building the files that",
    "start": "2464319",
    "end": "2471240"
  },
  {
    "text": "should be uh targeted right now here if you see",
    "start": "2471240",
    "end": "2478319"
  },
  {
    "text": "the the URL has changed because a red Direction has occurred to another web page which is indeed loading the local",
    "start": "2478319",
    "end": "2486880"
  },
  {
    "text": "index that files from the victim as I wrote a a specific F code in a specific",
    "start": "2486880",
    "end": "2494280"
  },
  {
    "text": "HTML and scripting code in those files uh I have enabled some functions in in",
    "start": "2494280",
    "end": "2500520"
  },
  {
    "text": "that file to access the the client's computer for",
    "start": "2500520",
    "end": "2507800"
  },
  {
    "text": "example here is the folder for upload and let's see if I can get the boot in",
    "start": "2507800",
    "end": "2515280"
  },
  {
    "text": "file from the from the C hard drive if you take a look to the it's",
    "start": "2515280",
    "end": "2521560"
  },
  {
    "text": "difficult to to look at both at the same time but if you take a look at this page this page won't won't change uh it will",
    "start": "2521560",
    "end": "2530000"
  },
  {
    "text": "keep the same because it's just uh submitting a form and receiving a 2006",
    "start": "2530000",
    "end": "2536079"
  },
  {
    "text": "no content response so it will not do anything it will not change this way we",
    "start": "2536079",
    "end": "2542520"
  },
  {
    "text": "can get every file you we want but let's get some interesting files for",
    "start": "2542520",
    "end": "2549359"
  },
  {
    "text": "example documents and",
    "start": "2549359",
    "end": "2553000"
  },
  {
    "text": "settings uh Jorge because this is my username",
    "start": "2554520",
    "end": "2561000"
  },
  {
    "text": "cookies index",
    "start": "2561000",
    "end": "2564800"
  },
  {
    "text": "that then I get this file is it it is",
    "start": "2568040",
    "end": "2573200"
  },
  {
    "text": "here I built a script to to parts this file let me go",
    "start": "2573200",
    "end": "2581200"
  },
  {
    "text": "there uh let's par this file you can read uh the screen",
    "start": "2592200",
    "end": "2599400"
  },
  {
    "text": "right um well let's put it all in a text",
    "start": "2599400",
    "end": "2608079"
  },
  {
    "text": "file and then we can uh try to access directly uh",
    "start": "2621119",
    "end": "2629839"
  },
  {
    "text": "each of these files some of these files perhaps can uh perhaps uh are expired",
    "start": "2629839",
    "end": "2635880"
  },
  {
    "text": "but most of them should be",
    "start": "2635880",
    "end": "2640760"
  },
  {
    "text": "there if I try for example this one let's see what",
    "start": "2641760",
    "end": "2647880"
  },
  {
    "text": "happens it was there actually so uh the cookie is this",
    "start": "2649040",
    "end": "2655960"
  },
  {
    "text": "one and as you can see we managed to get not not the cookies for random domains",
    "start": "2655960",
    "end": "2662599"
  },
  {
    "text": "but the cookies for all of the domains the user has set",
    "start": "2662599",
    "end": "2668000"
  },
  {
    "text": "this way we can also access uh another interesting files for example in local",
    "start": "2668319",
    "end": "2676920"
  },
  {
    "text": "setings uh history history",
    "start": "2677440",
    "end": "2685400"
  },
  {
    "text": "I5 index dat again this is another of the tracking",
    "start": "2685599",
    "end": "2691720"
  },
  {
    "text": "files and it is indeed the one I'm using uh uh with HTML code inside uh and",
    "start": "2691720",
    "end": "2698520"
  },
  {
    "text": "loading that file in the in the victims if you click here you will see here is",
    "start": "2698520",
    "end": "2704319"
  },
  {
    "text": "loaded the file but I just hidden it for uh for",
    "start": "2704319",
    "end": "2710838"
  },
  {
    "text": "Statics then we can parse that file",
    "start": "2711640",
    "end": "2718240"
  },
  {
    "text": "also uh local",
    "start": "2724880",
    "end": "2728960"
  },
  {
    "text": "settings let's put it in history",
    "start": "2730400",
    "end": "2737319"
  },
  {
    "text": "tting let's open it and see what can we get from that",
    "start": "2741319",
    "end": "2748799"
  },
  {
    "text": "computer let's change it a bit so I can access it there",
    "start": "2752839",
    "end": "2757880"
  },
  {
    "text": "directly and we can for example try to get this",
    "start": "2758240",
    "end": "2764599"
  },
  {
    "text": "file which is actually in the desktop but is is in this file because I have",
    "start": "2765359",
    "end": "2770920"
  },
  {
    "text": "accessed it some time ago so it got uh written in the in the",
    "start": "2770920",
    "end": "2779520"
  },
  {
    "text": "tracking file then in the uploads it should be",
    "start": "2779520",
    "end": "2786680"
  },
  {
    "text": "this file that is uh in fact the the white paper I wrote about this with more",
    "start": "2786680",
    "end": "2791920"
  },
  {
    "text": "detail on all of the things we have discussed so",
    "start": "2791920",
    "end": "2796040"
  },
  {
    "text": "far well this way you can access every file that user has been working with uh",
    "start": "2805440",
    "end": "2812280"
  },
  {
    "text": "since the last time he cleaned his browsing history",
    "start": "2812280",
    "end": "2817800"
  },
  {
    "text": "I think that's not not so common at least I don't do that quite",
    "start": "2818400",
    "end": "2826640"
  },
  {
    "text": "often it also includes pictures and even if you get access to the thumb DB files",
    "start": "2827240",
    "end": "2832800"
  },
  {
    "text": "in the my pictures folder you can track all of the files in the in in the current folder and even",
    "start": "2832800",
    "end": "2840119"
  },
  {
    "text": "access the the the thumbnails that are in store in those files for example this",
    "start": "2840119",
    "end": "2847640"
  },
  {
    "text": "is one of my pictures in in my folder with some friends of mine in my",
    "start": "2847640",
    "end": "2853920"
  },
  {
    "text": "hometown um",
    "start": "2856280",
    "end": "2860319"
  },
  {
    "text": "well um when we started uh publishing this this line of attacks we had uh not",
    "start": "2864800",
    "end": "2873319"
  },
  {
    "text": "the full knowledge of what was really going going on because we as Internet Explorer is is a source a close Source",
    "start": "2873319",
    "end": "2880720"
  },
  {
    "text": "product uh it's not easy to to see what is happening behind scenes so we were",
    "start": "2880720",
    "end": "2886960"
  },
  {
    "text": "learning more and more about this uh this problem uh as the time was uh",
    "start": "2886960",
    "end": "2895960"
  },
  {
    "text": "passing so uh in the in the CB uh in the first CV that",
    "start": "2895960",
    "end": "2903359"
  },
  {
    "text": "was published it was treated as it if it was was a Zone elevation issue and as we",
    "start": "2903359",
    "end": "2908680"
  },
  {
    "text": "saw it is not there is no Zone elevation we're not elevating anything it it's",
    "start": "2908680",
    "end": "2914800"
  },
  {
    "text": "just intended functionality abused in a in a way uh and even the",
    "start": "2914800",
    "end": "2923160"
  },
  {
    "text": "the the CV for the for one of the last advisories we published tags it as a",
    "start": "2923160",
    "end": "2929680"
  },
  {
    "text": "cross-domain information disclosure relability which is not uh it is also a",
    "start": "2929680",
    "end": "2935000"
  },
  {
    "text": "cross doain information information vulnerability because you can actually access information of other domains but you can access it actually all of the",
    "start": "2935000",
    "end": "2940920"
  },
  {
    "text": "information in the local drive so it's more than that I think and as we saw along the the",
    "start": "2940920",
    "end": "2947799"
  },
  {
    "text": "presentation both of the problems are the same",
    "start": "2947799",
    "end": "2954280"
  },
  {
    "text": "so let's discuss discuss some workarounds because uh by now uh",
    "start": "2954280",
    "end": "2960440"
  },
  {
    "text": "Internet Explorer is actually vulnerable to this uh attack there is no fix yet",
    "start": "2960440",
    "end": "2966480"
  },
  {
    "text": "yet uh so let's see what we can do about it uh one of the things that can be done",
    "start": "2966480",
    "end": "2974200"
  },
  {
    "text": "is locking down the Internet Explorer Network protocol that is a a seting that",
    "start": "2974200",
    "end": "2980119"
  },
  {
    "text": "you have to set in the in the registry or in the in the internet configuration",
    "start": "2980119",
    "end": "2986760"
  },
  {
    "text": "for your computer from the control panel you should uh basically disable",
    "start": "2986760",
    "end": "2992359"
  },
  {
    "text": "the access to UNCC resources and file ER using his smv resources on Internet",
    "start": "2992359",
    "end": "3000520"
  },
  {
    "text": "Explorer if you're a normal user perhaps it will not affect you that much but",
    "start": "3000520",
    "end": "3007000"
  },
  {
    "text": "that's one of the aliis intern Microsoft has to not to remove",
    "start": "3007000",
    "end": "3013680"
  },
  {
    "text": "that um another uh coun mission that that can be taken is to set the security level",
    "start": "3013680",
    "end": "3021280"
  },
  {
    "text": "for the internet Zone and for the internet Zone also to high which will re",
    "start": "3021280",
    "end": "3026559"
  },
  {
    "text": "be really annoying because you will have to confirm every JavaScript that executes in the internet I think no one",
    "start": "3026559",
    "end": "3033240"
  },
  {
    "text": "wants to do that um also another option is just to",
    "start": "3033240",
    "end": "3038559"
  },
  {
    "text": "disable the active scripting uh for for both of these songs internet and local",
    "start": "3038559",
    "end": "3044440"
  },
  {
    "text": "internet which is uh I I know it's ridiculous but it is a conter meur",
    "start": "3044440",
    "end": "3052040"
  },
  {
    "text": "anyway then another solution is uh uh to run Internet Explorer only in protected",
    "start": "3052040",
    "end": "3057920"
  },
  {
    "text": "mode but that's that will just work in mod operating systems such as Windows 7",
    "start": "3057920",
    "end": "3064720"
  },
  {
    "text": "or Windows Vista and I found uh a protected mode",
    "start": "3064720",
    "end": "3071079"
  },
  {
    "text": "also to be really really annoying I don't know you but I I don't use it in",
    "start": "3071079",
    "end": "3076760"
  },
  {
    "text": "in that way and well another work around that",
    "start": "3076760",
    "end": "3082119"
  },
  {
    "text": "can be suggested is just to use a different web browser browsing somewhere that you don't know what can you",
    "start": "3082119",
    "end": "3091079"
  },
  {
    "text": "find well that's it any",
    "start": "3091799",
    "end": "3097119"
  },
  {
    "text": "questions hased their work for this particular issue or you mentioned previous issues",
    "start": "3099280",
    "end": "3107440"
  },
  {
    "text": "they they for this one for as for for the latest yeah the question is if there",
    "start": "3107440",
    "end": "3114079"
  },
  {
    "text": "are specific workarounds for for this particular issue I'm exposing here the the latest one uh as we said as we said",
    "start": "3114079",
    "end": "3122079"
  },
  {
    "text": "uh all of the issues are actually the same so the mitigation Factor mitigation factors are the same the the counter",
    "start": "3122079",
    "end": "3129319"
  },
  {
    "text": "measures are all the same for the first advisory for the second one for the third one and will be for the fourth one",
    "start": "3129319",
    "end": "3134680"
  },
  {
    "text": "you will see one I promise so so right now your the attack you just did will",
    "start": "3134680",
    "end": "3140040"
  },
  {
    "text": "work y check out sorry have you checked",
    "start": "3140040",
    "end": "3147440"
  },
  {
    "text": "Outlook if I have a a look at Outlook yeah um you mean if Outlook perhaps is",
    "start": "3147440",
    "end": "3154720"
  },
  {
    "text": "vulnerable to to this kind of features also well in fact uh that's something uh",
    "start": "3154720",
    "end": "3160440"
  },
  {
    "text": "funny I got really upset at at first because uh when when I first found this",
    "start": "3160440",
    "end": "3166640"
  },
  {
    "text": "vulnerability to exist the way I was forcing uh Internet Explorer to treat a",
    "start": "3166640",
    "end": "3172640"
  },
  {
    "text": "cookie as an HTML file and render it it was by using a protocol Handler that is",
    "start": "3172640",
    "end": "3178880"
  },
  {
    "text": "mhtml for M HTML right well that GL is",
    "start": "3178880",
    "end": "3184319"
  },
  {
    "text": "actually part of Outlook Outlook Express so they blamed Outlook Express",
    "start": "3184319",
    "end": "3190599"
  },
  {
    "text": "as being the responsible for this feature for this problem but Outlook Express is always installed in every",
    "start": "3190599",
    "end": "3198119"
  },
  {
    "text": "Windows installation you cannot disable it and even so if you choose to not to",
    "start": "3198119",
    "end": "3203319"
  },
  {
    "text": "install Outlook Express in the installation process of Windows the dll",
    "start": "3203319",
    "end": "3209040"
  },
  {
    "text": "will be there anyways will be installed also so I think they tried to minimize the",
    "start": "3209040",
    "end": "3215599"
  },
  {
    "text": "impact of the new one the vulnerability went out but it was the same because we then find found another way to do the",
    "start": "3215599",
    "end": "3223200"
  },
  {
    "text": "same thing without using any",
    "start": "3223200",
    "end": "3226400"
  },
  {
    "text": "dll two questions yep um first one is",
    "start": "3228520",
    "end": "3233880"
  },
  {
    "text": "are there can you or are there any good third party M handlers and the other",
    "start": "3233880",
    "end": "3239960"
  },
  {
    "text": "question is when you mentioned running ID in protected mode are youing dat extion",
    "start": "3239960",
    "end": "3247920"
  },
  {
    "text": "or uh no the the protected mode is actually a component of the operating system that is indicated that Internet",
    "start": "3247920",
    "end": "3255119"
  },
  {
    "text": "Explorer uh when you're using when you're browsing internet with Internet Explorer in either Windows 7 or Windows",
    "start": "3255119",
    "end": "3263240"
  },
  {
    "text": "Vista uh you will see in in the information status part if this mode is",
    "start": "3263240",
    "end": "3268400"
  },
  {
    "text": "activated or not this mode is based upon uh some other components of the operating system as user account control",
    "start": "3268400",
    "end": "3275799"
  },
  {
    "text": "and another kind of features but you have to be using one of those operating",
    "start": "3275799",
    "end": "3281280"
  },
  {
    "text": "system to enable it",
    "start": "3281280",
    "end": "3286400"
  },
  {
    "text": "question way implement the uh builtin mind handling so that it handles uh",
    "start": "3287799",
    "end": "3293240"
  },
  {
    "text": "content types properly and you mean in other browsers in other brows or even this one it seems like you know this is",
    "start": "3293240",
    "end": "3301599"
  },
  {
    "text": "terrible yeah uh the the point is uh the problem",
    "start": "3301599",
    "end": "3307559"
  },
  {
    "text": "arises in the way it is implemented most that in the way it is thought",
    "start": "3307559",
    "end": "3314400"
  },
  {
    "text": "uh in the white paper that will be available in in the blackhe Hat website",
    "start": "3314400",
    "end": "3320480"
  },
  {
    "text": "and also in cor security website uh I I have made also an is uh of a comparison",
    "start": "3320480",
    "end": "3327920"
  },
  {
    "text": "with another web browsers and why those why this kind of attack cannot occur in",
    "start": "3327920",
    "end": "3335000"
  },
  {
    "text": "uh other browsers for example just to to name one that CAU my attention uh",
    "start": "3335000",
    "end": "3343200"
  },
  {
    "text": "when uh for example Firefox when dealing with uh SMB",
    "start": "3343200",
    "end": "3348839"
  },
  {
    "text": "resources it has a a kind of privilege separation regarding to to in which",
    "start": "3348839",
    "end": "3355799"
  },
  {
    "text": "folder is the file that is being rendered for example if you have a folder a and then a folder b a file",
    "start": "3355799",
    "end": "3362480"
  },
  {
    "text": "inside that folder B cannot access a file in the folder a because uh that",
    "start": "3362480",
    "end": "3368520"
  },
  {
    "text": "will be violate as some some sort of same Pol same origin policy but this is",
    "start": "3368520",
    "end": "3374319"
  },
  {
    "text": "not the case in in Internet Explorer as we saw the index. file is inside the",
    "start": "3374319",
    "end": "3380280"
  },
  {
    "text": "profile the user profile folder but I am accessing here every file in the local drive so so the Mind handling is done by",
    "start": "3380280",
    "end": "3388200"
  },
  {
    "text": "ID and not by the operating system it's the Mind handling it's perhaps another",
    "start": "3388200",
    "end": "3394640"
  },
  {
    "text": "of the problems because it's not determining so well the the the content type that has to be used but uh for",
    "start": "3394640",
    "end": "3403599"
  },
  {
    "text": "example Firefox uh doesn't support uh UNCC",
    "start": "3403599",
    "end": "3409280"
  },
  {
    "text": "addresses also so you can access a resource by by SMB using the file colon",
    "start": "3409280",
    "end": "3416000"
  },
  {
    "text": "SL protocol but you cannot use UNC because that's a Microsoft thing that's",
    "start": "3416000",
    "end": "3421319"
  },
  {
    "text": "a Windows Explorer thing and also an Internet Explorer",
    "start": "3421319",
    "end": "3426078"
  },
  {
    "text": "things I don't know if I've answered your question",
    "start": "3426359",
    "end": "3431960"
  },
  {
    "text": "okay how is yourt actually saying the file well would you like to take a look",
    "start": "3431960",
    "end": "3437400"
  },
  {
    "text": "at it I think we have time I'm not quite sure but",
    "start": "3437400",
    "end": "3443799"
  },
  {
    "text": "well that's something that I forgot to mention but it was written",
    "start": "3443799",
    "end": "3449720"
  },
  {
    "text": "here uh another feature that uh Internet Explorer has but I think it is it is",
    "start": "3449720",
    "end": "3457440"
  },
  {
    "text": "good not only for my demonstration purposes but it is something really really good uh the Dum document 3. o uh",
    "start": "3457440",
    "end": "3468280"
  },
  {
    "text": "object uh has the ability to read uh not only text files but either binary files",
    "start": "3468280",
    "end": "3476079"
  },
  {
    "text": "because you can uh load uh load contents from a container into a variable uh and",
    "start": "3476079",
    "end": "3484760"
  },
  {
    "text": "you can set those contents to be binary let's see if I have the source code",
    "start": "3484760",
    "end": "3491960"
  },
  {
    "text": "here it's actually a BB script file because it has some uh as as I said uh",
    "start": "3503720",
    "end": "3510760"
  },
  {
    "text": "the only thing that can access UNCC resources is Microsoft uh Firefox will",
    "start": "3510760",
    "end": "3516160"
  },
  {
    "text": "not do this because it makes no sense in Firefox you cannot use back SLB slash a",
    "start": "3516160",
    "end": "3521799"
  },
  {
    "text": "a computer IP or name",
    "start": "3521799",
    "end": "3527200"
  },
  {
    "text": "and by creating uh this object you can uh create an binary",
    "start": "3527200",
    "end": "3533960"
  },
  {
    "text": "element in in in this XML uh document",
    "start": "3533960",
    "end": "3539400"
  },
  {
    "text": "object then uh you encode this uh content in Bas 64 because uh in another",
    "start": "3539400",
    "end": "3546720"
  },
  {
    "text": "way you could not uh send it to a remote place and that is what we're doing here",
    "start": "3546720",
    "end": "3552760"
  },
  {
    "text": "and then we are just bypassing the same origin policy as everyone does as be does for example that is uh creating a",
    "start": "3552760",
    "end": "3560760"
  },
  {
    "text": "dynamic form and filling that form setting an action the action for that form to to",
    "start": "3560760",
    "end": "3569039"
  },
  {
    "text": "another place and then sending that",
    "start": "3569039",
    "end": "3572599"
  },
  {
    "text": "form something",
    "start": "3578680",
    "end": "3582078"
  },
  {
    "text": "else but that's it so thank you very",
    "start": "3587160",
    "end": "3592599"
  },
  {
    "text": "much",
    "start": "3593079",
    "end": "3596079"
  }
]