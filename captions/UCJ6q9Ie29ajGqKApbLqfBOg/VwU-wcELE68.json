[
  {
    "start": "0",
    "end": "120000"
  },
  {
    "text": "this is the web abst track uh and we have one of the last presentations of",
    "start": "80",
    "end": "5240"
  },
  {
    "text": "the day we have Blended threats and JavaScript to plan for Perman Network compromise uh by Phil perance and Joshua",
    "start": "5240",
    "end": "12440"
  },
  {
    "text": "Basher uh my name is Nathan Hamill I'm the track chair for this track um so if",
    "start": "12440",
    "end": "17520"
  },
  {
    "text": "you see me walking around or uh if you have any questions comments complaints",
    "start": "17520",
    "end": "22720"
  },
  {
    "text": "whatever uh feel free to track me down or maybe if in the future you you're thinking about submitting something to",
    "start": "22720",
    "end": "28240"
  },
  {
    "text": "black hat and you're kind of wondering what we look for I would be more than happy to discuss that with you at length",
    "start": "28240",
    "end": "33559"
  },
  {
    "text": "so without further Ado uh I give you Blended threat and jobos",
    "start": "33559",
    "end": "39440"
  },
  {
    "text": "script Mike's live yet all right thank you everybody I'm",
    "start": "39440",
    "end": "45000"
  },
  {
    "text": "super excited to be here so uh I hope you learn a lot from this presentation I got a lot of stuff to show you um my",
    "start": "45000",
    "end": "50239"
  },
  {
    "text": "name is Phil and this is my colleague Josh and uh we're going to be talking about Blended threats and JavaScript a",
    "start": "50239",
    "end": "55920"
  },
  {
    "text": "plan for permanent Network compromise um bit about ourselves I'm a senior",
    "start": "55920",
    "end": "62280"
  },
  {
    "text": "security consultant at appsc Consulting uh web application security specialist I also do uh um bug bounty hunting for",
    "start": "62280",
    "end": "69759"
  },
  {
    "text": "different companies and you can find me on Twitter at superever and I have a Blog at Super ever.com and this is Josh",
    "start": "69759",
    "end": "76960"
  },
  {
    "text": "hey what's up everybody uh senior security consultant and abset Consulting I specialize in network penetration",
    "start": "76960",
    "end": "82600"
  },
  {
    "text": "testing so I used to get Phill lot of  but um beyond that uh I'm a retro systems nerd Apple 2is whatever um and I",
    "start": "82600",
    "end": "89600"
  },
  {
    "text": "try to be kind of a phone freak but I'm not so great at it anyway um I'm savan 42 on Twitter so a little bit of",
    "start": "89600",
    "end": "98240"
  },
  {
    "text": "background before we get started um so basically cross site scripting csrf all",
    "start": "98240",
    "end": "104640"
  },
  {
    "text": "that basic stuff it's been around pretty much as long as HTML so this is the",
    "start": "104640",
    "end": "109719"
  },
  {
    "text": "proverbial old dog um obviously you're here and I'm here and they're not going to give us a talk on cross- site",
    "start": "109719",
    "end": "115200"
  },
  {
    "text": "scripting again well at least I hope not um so I hope you learned something and um let's go forward so traditional",
    "start": "115200",
    "end": "121920"
  },
  {
    "start": "120000",
    "end": "120000"
  },
  {
    "text": "browser-based attacks often relied on a whole lot of user intervention and as a network penetration tester I could",
    "start": "121920",
    "end": "128560"
  },
  {
    "text": "rarely count on that I mean if the scope's large enough and the client's large enough and there's a few hundred clients then typically you can probably",
    "start": "128560",
    "end": "135280"
  },
  {
    "text": "count on at least one person clicking the link but it requires a lot of mandatory user intervention somebody",
    "start": "135280",
    "end": "140840"
  },
  {
    "text": "actually sticking the proverbial fork in the outlet social engineering Etc user",
    "start": "140840",
    "end": "145879"
  },
  {
    "text": "user user interaction and nowadays I sort of hope that that problem is on its",
    "start": "145879",
    "end": "151160"
  },
  {
    "text": "way to being solved so I consider that as an attack Vector unreliable and perhaps a bit far-fetched",
    "start": "151160",
    "end": "157920"
  },
  {
    "start": "157000",
    "end": "157000"
  },
  {
    "text": "conversely traditional Network exploitation you know with Windows desktops Linux desktops OS 10 Etc has a",
    "start": "157920",
    "end": "165280"
  },
  {
    "text": "sort of uh very predictable attack methodology there's an exploit installed",
    "start": "165280",
    "end": "170879"
  },
  {
    "text": "through social engineering or an unpatched vulnerability from there you exploit that you pivot you persist you",
    "start": "170879",
    "end": "177519"
  },
  {
    "text": "exfiltrate your data you got to do whatever you need to do to get paid bad guys good guys whatever the motivation",
    "start": "177519",
    "end": "183080"
  },
  {
    "text": "is basically the same um but the thing about these types of attacks is that on a long enough timeline they will be",
    "start": "183080",
    "end": "188720"
  },
  {
    "text": "detected by antivirus and and so even though it's an arms race eventually you could expect that this sort of attack is",
    "start": "188720",
    "end": "195000"
  },
  {
    "text": "going to die or morph um and then we get into sort of Blended threats which are not A New Concept but basically you know",
    "start": "195000",
    "end": "202440"
  },
  {
    "start": "197000",
    "end": "197000"
  },
  {
    "text": "Trend Micro Destin uh definitions up there but long story short you use a series of attacks to get the ultimate",
    "start": "202440",
    "end": "209400"
  },
  {
    "text": "goal along the killchain basically whatever it takes multiple techniques to get your systems",
    "start": "209400",
    "end": "216319"
  },
  {
    "text": "exploited so previous to now there has been some amazing research in JavaScript",
    "start": "216319",
    "end": "222760"
  },
  {
    "text": "and browser-based vulnerabilities uh lots of different and novel techniques but one thing I noticed",
    "start": "222760",
    "end": "228799"
  },
  {
    "text": "as a penetration tester is I tend not to rely on these because what I'm most interested is the fastest penetration so",
    "start": "228799",
    "end": "235000"
  },
  {
    "text": "what I can get in and get what matters to the business so there's all these really cool techn IES But ultimately",
    "start": "235000",
    "end": "241360"
  },
  {
    "text": "nobody's really put them together to make them into a badass tactical weapon and I think that that's what we're",
    "start": "241360",
    "end": "246959"
  },
  {
    "text": "trying to do so there's a lot of technologies that other amazing people have pioneered but what we seek what we",
    "start": "246959",
    "end": "253760"
  },
  {
    "text": "seek to do right now is turn them into a leg Lego W weapon of mass destruction a",
    "start": "253760",
    "end": "259440"
  },
  {
    "text": "little okay A little over the top there but you get what I'm saying so the question is how can traditional attacks",
    "start": "259440",
    "end": "265680"
  },
  {
    "text": "and specifically web- based attacks go to the next level we want to break free the browser we don't want to lose our",
    "start": "265680",
    "end": "271639"
  },
  {
    "text": "shell as soon as the browser is closed because the browser is the entryway into the network it is not the end off be I",
    "start": "271639",
    "end": "278880"
  },
  {
    "text": "don't really care about hacking Facebook accounts I care about what getting uh what matters to the corporation as a",
    "start": "278880",
    "end": "284720"
  },
  {
    "text": "penetration tester because at this point the times they are changing and as new",
    "start": "284720",
    "end": "290680"
  },
  {
    "text": "technologies come out there's going to be new classifications of vulnerabilities but more importantly the",
    "start": "290680",
    "end": "295960"
  },
  {
    "text": "old classifications of vulnerabilities are are being reproduced Us in ways that we hadn't figured out there's a rush to",
    "start": "295960",
    "end": "302240"
  },
  {
    "text": "get the newest latest greatest technology out but we're not really learning from our mistakes um so why why",
    "start": "302240",
    "end": "309520"
  },
  {
    "start": "308000",
    "end": "308000"
  },
  {
    "text": "network devices I mean there's lots of multi-function printers there's Voiceover IP phones soft phones Etc um",
    "start": "309520",
    "end": "317520"
  },
  {
    "text": "lots of devices that are are small and generally we don't consider them to be a threat although I think that at the end",
    "start": "317520",
    "end": "324840"
  },
  {
    "text": "of this this discussion hopefully you'll start to see things in a slightly different light um these devices because",
    "start": "324840",
    "end": "331199"
  },
  {
    "text": "they're purpose drill tend to have a non-standard upgrade model if it works out of the box there's very little",
    "start": "331199",
    "end": "336840"
  },
  {
    "text": "reason to check to make sure that there's a firmware update which I think we need to get away from that Paradigm",
    "start": "336840",
    "end": "343000"
  },
  {
    "text": "because they tend to be ignored by users just so long as they keep working set it",
    "start": "343000",
    "end": "349240"
  },
  {
    "text": "and forget it so uh ultimately what this",
    "start": "349240",
    "end": "354400"
  },
  {
    "text": "presentation is about is compromising these network devices using a combination of Blended threats and",
    "start": "354400",
    "end": "363039"
  },
  {
    "text": "JavaScript all right so small office home office routers in your network it's",
    "start": "368520",
    "end": "374080"
  },
  {
    "text": "more likely than you think even in the Enterprise and Josh knows about this",
    "start": "374080",
    "end": "379199"
  },
  {
    "text": "because he's been testing Enterprise equipment for a long time what happens",
    "start": "379199",
    "end": "386520"
  },
  {
    "start": "384000",
    "end": "384000"
  },
  {
    "text": "is home users small businesses they buy these devices because they're quick and",
    "start": "386520",
    "end": "391680"
  },
  {
    "text": "easy and it's something they can quickly set up in their home but they don't want to necessarily configure them",
    "start": "391680",
    "end": "398960"
  },
  {
    "text": "completely same thing with uh inside the Enterprise where they just want to get a quick jump start into whatever they're",
    "start": "400000",
    "end": "406360"
  },
  {
    "text": "trying to do whatever kind of QA testing they're going to perform um so a lot of the time these devices just kind of get",
    "start": "406360",
    "end": "412400"
  },
  {
    "text": "get put onto the network without any kind of um testing beforehand but this isn't just about you",
    "start": "412400",
    "end": "419080"
  },
  {
    "text": "know you know small routers and things like that this this potentially applies to any kind of network",
    "start": "419080",
    "end": "425400"
  },
  {
    "text": "device but we're going to use a few routers as examples here so so so one quick thing to understand is that maybe",
    "start": "425400",
    "end": "432280"
  },
  {
    "text": "maybe you've done the walkthrough and you understand that there are not Nies you know like lower cost Soho devices in",
    "start": "432280",
    "end": "439360"
  },
  {
    "text": "your network but the thing is is over the years I've seen a penetration test where you've got smaller groups you've",
    "start": "439360",
    "end": "444720"
  },
  {
    "text": "got the QA you've got the Rogue engineer whoever basically who doesn't give a crap about about putting in an IT",
    "start": "444720",
    "end": "450560"
  },
  {
    "text": "support ticket every time they need something small for there maybe their miniature lab on their desks just so they can make sure they're bottom line",
    "start": "450560",
    "end": "457039"
  },
  {
    "text": "so believe it or not these devices are out there and you may not see them with a Kismet scan you may not see them",
    "start": "457039",
    "end": "463319"
  },
  {
    "text": "broadcasting ssids or maybe even not but for Mo most often they're actually there",
    "start": "463319",
    "end": "468720"
  },
  {
    "text": "so it's something you really need to take into consideration all right this one to sure",
    "start": "468720",
    "end": "475199"
  },
  {
    "start": "472000",
    "end": "472000"
  },
  {
    "text": "so um in this situation what would be the worst case scenario okay so you've got somebody they forgot that there's",
    "start": "475199",
    "end": "481120"
  },
  {
    "text": "that little lynis under their desk and they figure well if they use corporate Network as their upstream or their their",
    "start": "481120",
    "end": "486400"
  },
  {
    "text": "Gateway from these devices um what's what's the goal right so ultimately what",
    "start": "486400",
    "end": "492159"
  },
  {
    "text": "we want to do is do as much as possible with browser based attacks we want the",
    "start": "492159",
    "end": "497440"
  },
  {
    "text": "end user to do all the work because we're not doing it in a ctitious way with a fishing email or something that",
    "start": "497440",
    "end": "503879"
  },
  {
    "text": "does require some sort of manual intervention just so far as they manag to find our code and we'll get into that",
    "start": "503879",
    "end": "509960"
  },
  {
    "text": "a little bit later but you'd be surprised at how many different opportunities there are to view malicious JavaScript and the interesting",
    "start": "509960",
    "end": "516120"
  },
  {
    "text": "thing about this is it tends to evade detection there are so many ways to op thecate JavaScript that it's almost",
    "start": "516120",
    "end": "522518"
  },
  {
    "text": "impractical for IP IPS and IDs systems and very on the ball Network administrators and blue teams to be able",
    "start": "522519",
    "end": "529600"
  },
  {
    "text": "to understand this stuff and ultimately the end goal is profit if you're a penetration tester you get paid by",
    "start": "529600",
    "end": "535800"
  },
  {
    "text": "showing the corporations what the risk really is and if you're a bad guy the bottom line is get paid get out of",
    "start": "535800",
    "end": "543240"
  },
  {
    "text": "there that's it so this is basically what we",
    "start": "543240",
    "end": "548480"
  },
  {
    "start": "547000",
    "end": "547000"
  },
  {
    "text": "propose uh essentially the first thing we need to do is deployment and I think over the years we've sort of discussed",
    "start": "548480",
    "end": "554560"
  },
  {
    "text": "there's various different ways to deploy it there is the standard email fishing there are you know you could compromise",
    "start": "554560",
    "end": "560600"
  },
  {
    "text": "something internal to to ensure that most people are going to be able to see this device right easy enough deployment",
    "start": "560600",
    "end": "568600"
  },
  {
    "text": "isn't really the issue uh it's a little easier to detect in some cases but it",
    "start": "568600",
    "end": "573680"
  },
  {
    "text": "depends it depends on what the actual attack Vector is the thing is there's so many ways so you can start with ad",
    "start": "573680",
    "end": "580000"
  },
  {
    "text": "networks a while back Yahoo ads was compromised and they didn't realize what they were actually submitting malicious",
    "start": "580000",
    "end": "586320"
  },
  {
    "text": "ads so that's one way you can go into it another one is these file sharing sites mega upload they've had their troubles",
    "start": "586320",
    "end": "592800"
  },
  {
    "text": "but it's not like they're the only one like that what's really cool about sites like this is if you're not willing to",
    "start": "592800",
    "end": "597920"
  },
  {
    "text": "Fork over the dough to have a Platinum account you have to deal with something like this wait you know 60 seconds 30",
    "start": "597920",
    "end": "603839"
  },
  {
    "text": "seconds whatever if you want to download the ratest latest episode of Jersey Shore you're probably going to have to",
    "start": "603839",
    "end": "609240"
  },
  {
    "text": "wait at least a minute unless you're willing to cough up a couple dollars in this case 37 seconds and what's badass",
    "start": "609240",
    "end": "615399"
  },
  {
    "text": "about that is that actually gives us a big enough window more of an enough time to actually execute these",
    "start": "615399",
    "end": "620920"
  },
  {
    "text": "vulnerabilities and the browse or the user is expecting at this point for the browser to be sitting waiting for their",
    "start": "620920",
    "end": "626640"
  },
  {
    "text": "time so they can get the latest episode of Game of Thrones or whatever pick your favorite",
    "start": "626640",
    "end": "632200"
  },
  {
    "text": "show um and another opportunity is these free online surveys so I try to avoid it",
    "start": "632200",
    "end": "638279"
  },
  {
    "text": "but I need Facebook to send piics of my kids to my various family spread all over the country and there's not a week",
    "start": "638279",
    "end": "643360"
  },
  {
    "text": "that goes by but I don't get one of these offers for these damn surveys from these people believing that if they re",
    "start": "643360",
    "end": "648680"
  },
  {
    "text": "re send these this crap to enough people that they're going to get a free iPad out of it or maybe they take 10 minutes",
    "start": "648680",
    "end": "654600"
  },
  {
    "text": "but most of these tend to be malicious and it's a really awesome way to send malicious code because these people",
    "start": "654600",
    "end": "660040"
  },
  {
    "text": "aren't concerned about security they want the iPad another opportunity is of course",
    "start": "660040",
    "end": "666160"
  },
  {
    "text": "social networks at this point there are so many social networks that even though Facebook is arguably one of the biggest",
    "start": "666160",
    "end": "672680"
  },
  {
    "text": "ones out there there's millions of them and and even though Facebook's got a badass bug Bounty right now where people",
    "start": "672680",
    "end": "678519"
  },
  {
    "text": "are spending a lot of time trying to track down these vulnerabilities and let's be honest with them most of them are Java based at set cross site",
    "start": "678519",
    "end": "684920"
  },
  {
    "text": "scripting vulnerabilities but they're not the only one and there there's a lot of them they're a lot of use and then",
    "start": "684920",
    "end": "690880"
  },
  {
    "text": "there's of course there's uh you know malicious search engine optimization there's domain fuzzing so instead of",
    "start": "690880",
    "end": "696480"
  },
  {
    "text": "Myspace it's rny space.com lookalike domains Etc and these things are tend to",
    "start": "696480",
    "end": "701959"
  },
  {
    "text": "be designed to steal your information steal your traffic for ad generation or",
    "start": "701959",
    "end": "707079"
  },
  {
    "text": "in this case we expect to push malicious code so if you don't believe me and I",
    "start": "707079",
    "end": "712440"
  },
  {
    "text": "understand that right but um consider this I assume that at least some of you have a Facebook account even if you",
    "start": "712440",
    "end": "718399"
  },
  {
    "text": "don't want to admit I'm not going to ask you to raise your hands um but think about this on snope.com by itself there",
    "start": "718399",
    "end": "725480"
  },
  {
    "text": "are 180 different entries that revolve around Facebook the whole if you click like uh Bill Gates is going to donate",
    "start": "725480",
    "end": "732680"
  },
  {
    "text": "$1,000 for every like to needy kids and Zab way or whatever right and the same thing goes for Myspace there's at least",
    "start": "732680",
    "end": "739040"
  },
  {
    "text": "30 entries but basically if you spend enough time on a social network you are",
    "start": "739040",
    "end": "744160"
  },
  {
    "text": "invariably going to be inundated with this crap because people have good intentions they want to believe that",
    "start": "744160",
    "end": "749560"
  },
  {
    "text": "it's true I mean consider this all of our families all of our non-technical members and people that we went to high",
    "start": "749560",
    "end": "755639"
  },
  {
    "text": "school they all post this stuff like just last week 90 people sent me if you click this you're going to get a free",
    "start": "755639",
    "end": "761760"
  },
  {
    "text": "trip to Disneyland you know so there's more of enough opportunities for your friends and the people that you trust to",
    "start": "761760",
    "end": "767760"
  },
  {
    "text": "bypass the trust model and get you to click this malicious code so ultimately deployment of this code is fairly",
    "start": "767760",
    "end": "776040"
  },
  {
    "text": "trivial all right so there's millions of ways to get this JavaScript code if you have some malicious code out there to",
    "start": "776760",
    "end": "783360"
  },
  {
    "text": "run on a user's browser all right but the question is once deployed what do you do all right well the key to these",
    "start": "783360",
    "end": "790440"
  },
  {
    "text": "types of attacks is to Target a rich environment you want to get as many people as possible because there's",
    "start": "790440",
    "end": "796160"
  },
  {
    "text": "probably going to be a high failure rate but you want to get the optimal attack service meaning you want to get you know",
    "start": "796160",
    "end": "801320"
  },
  {
    "text": "as many devices and as many users um hit as possible so what do you do once it",
    "start": "801320",
    "end": "808240"
  },
  {
    "text": "starts running there's a lot of uh research out there on network scanning using JavaScript you",
    "start": "808240",
    "end": "813800"
  },
  {
    "text": "know it's been it's been around for a few years if you're not familiar with it basically uh JavaScript based Network",
    "start": "813800",
    "end": "819959"
  },
  {
    "text": "scanners are able to detect uh devices on your network and whether they're live or",
    "start": "819959",
    "end": "826079"
  },
  {
    "text": "not all right there's several known techniques each has their own pros and cons some are faster and some are slower",
    "start": "826079",
    "end": "831759"
  },
  {
    "text": "but it really demonstrates that there's the potential for lightning fast enumeration of network",
    "start": "831759",
    "end": "837199"
  },
  {
    "text": "devices all right so here's one example JS scan it's really great um you know it's just a proof of concept right you",
    "start": "837199",
    "end": "843639"
  },
  {
    "text": "put in an IP address uh on your network and you put in a range and it starts scanning and looking for open ports and",
    "start": "843639",
    "end": "850120"
  },
  {
    "text": "seeing if what's open you know I did this at at my house and it's like oh sure enough Port 80 is up on 1921",
    "start": "850120",
    "end": "857399"
  },
  {
    "text": "16811 here's another great one but this one actually uh uses a couple different techniques um different than the",
    "start": "857399",
    "end": "863079"
  },
  {
    "text": "previous and this is JS Recon and here's one of my favorite Js",
    "start": "863079",
    "end": "869160"
  },
  {
    "text": "land scanner by Gareth Hayes and uh it it actually um is able to detect what",
    "start": "869160",
    "end": "875040"
  },
  {
    "text": "devices you have there all right so so how's this even possible like how can stuff on the",
    "start": "875040",
    "end": "881560"
  },
  {
    "start": "878000",
    "end": "878000"
  },
  {
    "text": "internet find out what devices you have on your internal Network they're supposed to be separate right what web",
    "start": "881560",
    "end": "886600"
  },
  {
    "text": "browsers don't really differentiate between resources located on the internet and resources located on the",
    "start": "886600",
    "end": "892440"
  },
  {
    "text": "internal network if you have a web page that sends a request to an internal IP address 19216811",
    "start": "892440",
    "end": "899560"
  },
  {
    "text": "it sends that request it doesn't really care all right so how would you detect",
    "start": "899560",
    "end": "905160"
  },
  {
    "text": "what's there one way of doing it is with iframes and image and image tags you can",
    "start": "905160",
    "end": "910759"
  },
  {
    "text": "use JavaScript on load and on airor events and that's how you can determine whether the image was there or wasn't or",
    "start": "910759",
    "end": "916680"
  },
  {
    "text": "if the request was responded to or not right you can also take advantage of",
    "start": "916680",
    "end": "924560"
  },
  {
    "text": "HTML 5 features we'll get into more of that later but uh cross origin requests and websockets can really speed things",
    "start": "924560",
    "end": "932000"
  },
  {
    "text": "up all right and here's just an example of what that code looks",
    "start": "932000",
    "end": "937680"
  },
  {
    "text": "like all right so so one of the things that's really cool is by attempting to load multiple resources within a large",
    "start": "937839",
    "end": "944240"
  },
  {
    "text": "range of IP addresses JavaScript can actually determine what hosts are up and which ones are unavailable so if you",
    "start": "944240",
    "end": "951720"
  },
  {
    "text": "have a list of default IP addresses used by the common manufacturers and you're able to recognize that well you're able",
    "start": "951720",
    "end": "958480"
  },
  {
    "text": "to determine a lot more you're you're able to determine what device is actually on that Network right so so there's some",
    "start": "958480",
    "end": "965360"
  },
  {
    "text": "JavaScript based scanners that can use images and other resources to fingerprint the device on your network",
    "start": "965360",
    "end": "971480"
  },
  {
    "text": "for example J I said JS lands scanner was a good one it has a database of nearly 200 devices and it's able to",
    "start": "971480",
    "end": "977959"
  },
  {
    "text": "enumerate them by comparing the existence or absence of certain images on those devices a lot of them might",
    "start": "977959",
    "end": "983560"
  },
  {
    "text": "have/ images link.jpg or net gear.jpg or",
    "start": "983560",
    "end": "988920"
  },
  {
    "text": "or something like that where it's able to see that image without even authenticating and be able being able to",
    "start": "988920",
    "end": "994319"
  },
  {
    "text": "say okay well I know this is a Netgear device or whatever vendor right um and",
    "start": "994319",
    "end": "999480"
  },
  {
    "text": "go from there so an attacker could fine-tune these types of utilities and",
    "start": "999480",
    "end": "1005040"
  },
  {
    "text": "just make them so much better because you know these obviously weren't projects that were paid for or government sponsored or anything like",
    "start": "1005040",
    "end": "1010959"
  },
  {
    "text": "that they were just uh projects done in people's free time but they're really cool proof of",
    "start": "1010959",
    "end": "1016920"
  },
  {
    "text": "Concepts I had a couple ideas on how these could actually be made better you know what are you going to do scan a",
    "start": "1016920",
    "end": "1022480"
  },
  {
    "start": "1017000",
    "end": "1017000"
  },
  {
    "text": "whole range of IP addresses and and hope you're able to get through all of them there's a lot of IP addresses right especially if you assume you have to",
    "start": "1022480",
    "end": "1028918"
  },
  {
    "text": "make the assumption that all these devices are on 192.168.1 if you're a different octet",
    "start": "1028919",
    "end": "1035160"
  },
  {
    "text": "than that then ultimately this attack is nerfed until right so but I found out",
    "start": "1035160",
    "end": "1040199"
  },
  {
    "text": "that some devices you don't necessarily need to log into them using the IP",
    "start": "1040199",
    "end": "1045319"
  },
  {
    "text": "address Netgear routers for example they put in a DNS record so if you go to",
    "start": "1045319",
    "end": "1051720"
  },
  {
    "text": "www.routerlogin.net it redirects you to that internal Network router right so you could use a similar technique",
    "start": "1051720",
    "end": "1058520"
  },
  {
    "text": "instead of putting an IP address there you're putting www.routerlogin.net and testing what you",
    "start": "1058520",
    "end": "1063919"
  },
  {
    "text": "can find there another way to do it is with bonjour often call it mdns or zero",
    "start": "1063919",
    "end": "1071280"
  },
  {
    "text": "configuration and uh what happens with that is the device registers itself on the network gives itself a name and it's",
    "start": "1071280",
    "end": "1077640"
  },
  {
    "text": "it kind of works like a domain name right so uh fras which is a network",
    "start": "1077640",
    "end": "1082880"
  },
  {
    "text": "attached storage system that's available on the internet um it registers as a bonjour service so you can connect to it",
    "start": "1082880",
    "end": "1089760"
  },
  {
    "text": "at free. local that means you don't need to know the IP address to get to it once again so these scanners could also",
    "start": "1089760",
    "end": "1095000"
  },
  {
    "text": "create a list of those kinds of devices and being able to enumerate what's on your network without even trying to",
    "start": "1095000",
    "end": "1100880"
  },
  {
    "text": "guessing the IP address or any worries about you know you're using a strange subnet or something like",
    "start": "1100880",
    "end": "1106720"
  },
  {
    "text": "that but there are some limitations what you can do with JavaScript and I thought I'd go over them a little bit and one of the main ones is that you can't really",
    "start": "1106720",
    "end": "1113200"
  },
  {
    "start": "1108000",
    "end": "1108000"
  },
  {
    "text": "determine the client's internal IP address using JavaScript uh without",
    "start": "1113200",
    "end": "1118320"
  },
  {
    "text": "using like non-javascript code like Java or Flash or something like that and it's",
    "start": "1118320",
    "end": "1123400"
  },
  {
    "text": "easy enough to do with that but this talk we really want to get into the core of what's in the web browser right you",
    "start": "1123400",
    "end": "1129320"
  },
  {
    "text": "don't need to have any kind of extra extensions to do what we're going to go",
    "start": "1129320",
    "end": "1135320"
  },
  {
    "text": "over all right so at that point it's all about gaining",
    "start": "1135679",
    "end": "1141240"
  },
  {
    "text": "control you've you've found victims you've scanned their networks and you've",
    "start": "1141799",
    "end": "1147120"
  },
  {
    "text": "determined what devices they have so how do you maintain your control within that",
    "start": "1147120",
    "end": "1153320"
  },
  {
    "text": "Network one trick about these devices is the authentication on them you may want",
    "start": "1153919",
    "end": "1159440"
  },
  {
    "text": "to do some kind of csrf attack or something like that this is just an example of some of",
    "start": "1159440",
    "end": "1164760"
  },
  {
    "text": "those authentication Pages they're a little bit different some router vendors you know they are Network device vendors they do it right here's an example of",
    "start": "1164760",
    "end": "1171760"
  },
  {
    "text": "one where it explicitly says okay before you can use this set a secure password make sure it has some numbers and",
    "start": "1171760",
    "end": "1178200"
  },
  {
    "text": "special characters in it before you can do anything else but most don't do it",
    "start": "1178200",
    "end": "1184960"
  },
  {
    "text": "right all right router passwords.com awesome website you put in the makeing",
    "start": "1184960",
    "end": "1190440"
  },
  {
    "text": "model and you get the default username and password for that device this stuff is public information it's all available",
    "start": "1190440",
    "end": "1196720"
  },
  {
    "text": "there's huge databases of it so if you're able to do find out what device",
    "start": "1196720",
    "end": "1201840"
  },
  {
    "text": "they have you can make a probable guess of what their password might be another great website let's say you",
    "start": "1201840",
    "end": "1208919"
  },
  {
    "text": "uh let's say their password has been changed and you weren't able to to guess it right away uh router pone.com is",
    "start": "1208919",
    "end": "1216280"
  },
  {
    "text": "another great website where they have proof of concepts for various network devices uh including authentication",
    "start": "1216280",
    "end": "1223159"
  },
  {
    "text": "bypasses where at that point you don't need to worry about the authentication page you can just get around it",
    "start": "1223159",
    "end": "1230640"
  },
  {
    "start": "1232000",
    "end": "1232000"
  },
  {
    "text": "all right so so how does authentication on these devices work most of them use basic",
    "start": "1232320",
    "end": "1238440"
  },
  {
    "text": "authentication uh which sends a special header along with a request it says authorization basic and then it has the",
    "start": "1238440",
    "end": "1244320"
  },
  {
    "text": "username password and it's base 64 encoded another common way is to use",
    "start": "1244320",
    "end": "1250679"
  },
  {
    "text": "traditional form post authentication all right",
    "start": "1250679",
    "end": "1256039"
  },
  {
    "text": "so how would you see srf that how would you cause a user to log into their",
    "start": "1256039",
    "end": "1261320"
  },
  {
    "text": "device because you already know what device it is well you can just create an image tag like",
    "start": "1261320",
    "end": "1266600"
  },
  {
    "text": "this and you set the source to that uh Remote device and you put HTTP col SL",
    "start": "1266600",
    "end": "1274440"
  },
  {
    "text": "slash username password at sign and then the IP address and then if it's",
    "start": "1274440",
    "end": "1280320"
  },
  {
    "text": "successful it will log in okay well what about uh if they're using a form post instead of basic authentication well",
    "start": "1280320",
    "end": "1286279"
  },
  {
    "text": "this is what csrf like for that would look like it can both of these all happen in the",
    "start": "1286279",
    "end": "1291400"
  },
  {
    "text": "background and the victim would be none the wiser of what's going on and another way to do it if there was",
    "start": "1291400",
    "end": "1297919"
  },
  {
    "text": "crossy scripting or another vulnerability like that on the router you could do really cool things like set",
    "start": "1297919",
    "end": "1303799"
  },
  {
    "text": "extra headers you can just simply put an authorization basic header in the next",
    "start": "1303799",
    "end": "1309440"
  },
  {
    "text": "request being sent to the device and maybe you'll try a few of those and see what what kinds of responses you get",
    "start": "1309440",
    "end": "1315080"
  },
  {
    "text": "back so you can see here that I have the uh you see the base 64 is that long ywr",
    "start": "1315080",
    "end": "1321400"
  },
  {
    "text": "string and that's actually admin colon admin in base",
    "start": "1321400",
    "end": "1326480"
  },
  {
    "text": "64 but what if you could Brute Force the device and find out a little bit more",
    "start": "1326720",
    "end": "1332320"
  },
  {
    "text": "about what's on it by guessing the password all right so so what what",
    "start": "1332320",
    "end": "1339360"
  },
  {
    "text": "happens when you actually submit these requests that I just talked about well if the request is successful you get a",
    "start": "1339360",
    "end": "1345000"
  },
  {
    "text": "200 okay right if the request is unsuccessful you get a 4 One unauthorized what happens when you get",
    "start": "1345000",
    "end": "1351520"
  },
  {
    "text": "that you get a dialogue box that asks you to enter in the correct credentials all right right a way that's going to",
    "start": "1351520",
    "end": "1357360"
  },
  {
    "text": "alert the victim that something's going on something's up and at the very least it's going to slow down your",
    "start": "1357360",
    "end": "1363840"
  },
  {
    "text": "attack however I saw this the other day it's a",
    "start": "1363840",
    "end": "1369000"
  },
  {
    "text": "it was a bug report for chromium zoom in there a little bit I'm not sure if you can see it but basically",
    "start": "1369000",
    "end": "1375440"
  },
  {
    "text": "they're saying that it's a generic bug affecting all browsers where there's an issue where most a lot",
    "start": "1375440",
    "end": "1380760"
  },
  {
    "text": "of websites allow you to set arbitrary image source parameters so you can set it anywhere and uh the issue is that if",
    "start": "1380760",
    "end": "1387840"
  },
  {
    "text": "the source parameter refers to a resource that responds with a 401 header just like I said earlier indicating",
    "start": "1387840",
    "end": "1394360"
  },
  {
    "text": "basic off the browser will pop up a dialogue and it might be abused because the user won't be aware of where this",
    "start": "1394360",
    "end": "1400640"
  },
  {
    "text": "information is actually going so if you're on facebook.com and a user sees a dialog box enter your username and password they may think it's asking for",
    "start": "1400640",
    "end": "1407400"
  },
  {
    "text": "their Facebook information but now instead they just sent it to the attacker so I mean it sounds like a",
    "start": "1407400",
    "end": "1413159"
  },
  {
    "text": "legitimate problem right so I found out that with chromium",
    "start": "1413159",
    "end": "1418520"
  },
  {
    "text": "13 they decided to fix this problem blocking HTTP off for sub",
    "start": "1418520",
    "end": "1425039"
  },
  {
    "text": "resource loads basically what they ended up doing is to Res it says to resolve this we've blocked HTTP basic off for",
    "start": "1425039",
    "end": "1431799"
  },
  {
    "text": "subresource loads where the resource origin is different to the top level URL bar origin we also added a command line",
    "start": "1431799",
    "end": "1438120"
  },
  {
    "text": "switch in case you don't like this but what does that mean that means",
    "start": "1438120",
    "end": "1443360"
  },
  {
    "start": "1443000",
    "end": "1443000"
  },
  {
    "text": "that you can send as many requests as you want without ever getting that message saying you put in the wrong",
    "start": "1443360",
    "end": "1448600"
  },
  {
    "text": "password please enter the correct one which is great because you can use a",
    "start": "1448600",
    "end": "1454520"
  },
  {
    "text": "asynchronous JavaScript resource requests to send out thousands of",
    "start": "1454520",
    "end": "1459840"
  },
  {
    "text": "these all right so in a tack example you would have a page it would set up these",
    "start": "1459840",
    "end": "1466640"
  },
  {
    "text": "uh resources and request them and when it found one that actually returned uh an onload event you would stop it from",
    "start": "1466640",
    "end": "1473360"
  },
  {
    "text": "going any further and you would have the correct password all right so um in my",
    "start": "1473360",
    "end": "1478840"
  },
  {
    "text": "testing I was actually able to get Chrome to do about a 100 password attempts against a device uh in about",
    "start": "1478840",
    "end": "1484960"
  },
  {
    "text": "two seconds pretty fast Chrome Chrome's a fast browser right I mean that's that's",
    "start": "1484960",
    "end": "1491720"
  },
  {
    "text": "what it's all about I'm going to give you a demo now of that",
    "start": "1491720",
    "end": "1499320"
  },
  {
    "text": "let me make sure this guy's plugged in I brought with me here a lynis",
    "start": "1500200",
    "end": "1505840"
  },
  {
    "text": "wrt54gl it's a great test device I mean they still sell them you know they haven't patched them",
    "start": "1505840",
    "end": "1512679"
  },
  {
    "text": "in a long time they uh there's a lot of Open Source stuff available for it for you to",
    "start": "1512679",
    "end": "1519399"
  },
  {
    "text": "you know install your own software on it replace it things like that so it's a great little test device and it's",
    "start": "1519399",
    "end": "1525640"
  },
  {
    "text": "important to notice that although we're using this device because it's readily available and fairly common the same",
    "start": "1525640",
    "end": "1530880"
  },
  {
    "text": "technique offers for most of them and in case you're worried cuz we are there were many liquid offerings to the demo",
    "start": "1530880",
    "end": "1537360"
  },
  {
    "text": "Gods over the weekend so hopefully enjoy it yeah we're not Wizards so maybe we pick the easiest one out there but I'm",
    "start": "1537360",
    "end": "1542679"
  },
  {
    "text": "sure there's people out there that can do a lot more complicated stuff than us all right well let me make sure that",
    "start": "1542679",
    "end": "1548399"
  },
  {
    "text": "device is available here I'm going to create a new Chrome private browsing window and try to access it and what I'm",
    "start": "1548399",
    "end": "1556159"
  },
  {
    "text": "showing you here is that we're not logged in device I try to go to it and it says no you need a password to get",
    "start": "1556159",
    "end": "1562559"
  },
  {
    "text": "past this page for1 unauthorized of course so I",
    "start": "1562559",
    "end": "1568080"
  },
  {
    "text": "created a page to go through a whole list of script resource",
    "start": "1568080",
    "end": "1573919"
  },
  {
    "text": "requests with different passwords on them and to kind of better demonstrate",
    "start": "1573919",
    "end": "1578960"
  },
  {
    "text": "this rather than 100 because that only takes two seconds what kind of demo is that I gave it a thousand something",
    "start": "1578960",
    "end": "1585120"
  },
  {
    "text": "requests all right so here's here's my Brute Force technique we're going to load up uh the network",
    "start": "1585120",
    "end": "1591520"
  },
  {
    "text": "browser here so you can see what's going on and when we get the right one it's",
    "start": "1591520",
    "end": "1597440"
  },
  {
    "text": "going to pop up on the on the side over here and if you look down here we've already got about 600 requests these are",
    "start": "1597440",
    "end": "1605120"
  },
  {
    "text": "all areas saying nope didn't load didn't load didn't load didn't load didn't load didn't load about 900 right now like I said I",
    "start": "1605120",
    "end": "1612000"
  },
  {
    "text": "put the correct password near the very end of the uh list oh boom we got it",
    "start": "1612000",
    "end": "1618559"
  },
  {
    "text": "username admin password admin all right so with chrome you can",
    "start": "1618559",
    "end": "1625120"
  },
  {
    "text": "actually get a pretty good technique to Brute Force against a",
    "start": "1625120",
    "end": "1629799"
  },
  {
    "text": "password and it's it's worth noting that if you are a pent tester or someone who's specifically targeting an",
    "start": "1630200",
    "end": "1635760"
  },
  {
    "text": "individual then you can start to do a little bit more open source intelligence gathering and make an intelligent word",
    "start": "1635760",
    "end": "1640799"
  },
  {
    "text": "list so that you're not just throwing the whole dictionary at you're actually increasing your likelihood of penetrating and hopefully under a th000",
    "start": "1640799",
    "end": "1647840"
  },
  {
    "text": "request yep still don't believe me that it worked I'm going to go back to that router page",
    "start": "1647840",
    "end": "1654278"
  },
  {
    "text": "again oh look I'm logged in now which means the attacker is able to access",
    "start": "1654919",
    "end": "1660320"
  },
  {
    "text": "anything that they see when you're logged",
    "start": "1660320",
    "end": "1664000"
  },
  {
    "text": "in so here's that example that I was showing you where it's it's sent about 100 requests and you can look at the time log here and uh on the bottom right",
    "start": "1672200",
    "end": "1679559"
  },
  {
    "text": "you see that 100 requests in just 1.74 seconds it looked like the one that was actually successful took a little bit",
    "start": "1679559",
    "end": "1687720"
  },
  {
    "text": "longer all right so now you're in the device you had the victim log into the",
    "start": "1688559",
    "end": "1694159"
  },
  {
    "text": "device without them ever having to enter the username and password to get you in some of the previous attacks that's",
    "start": "1694159",
    "end": "1700679"
  },
  {
    "text": "pretty much where they stopped and you you know we we had uh uh the user log",
    "start": "1700679",
    "end": "1706080"
  },
  {
    "text": "into their device and then we see usrf them and things like that but we can do all that Auto in an automated fashion so",
    "start": "1706080",
    "end": "1712840"
  },
  {
    "text": "now it's all about how do we exploit this how do we compromise that",
    "start": "1712840",
    "end": "1717960"
  },
  {
    "text": "device Josh yeah so let me just jump in request um with a lot of these devices and you're running a variety of",
    "start": "1717960",
    "end": "1724159"
  },
  {
    "start": "1718000",
    "end": "1718000"
  },
  {
    "text": "operating system based on them there's proprietary systems vxworks there's Linux based firmwares and there's other",
    "start": "1724159",
    "end": "1730679"
  },
  {
    "text": "things multi-function printers Etc that have their own brand but um what I like to pick on to prove the concept right",
    "start": "1730679",
    "end": "1736880"
  },
  {
    "text": "now is Linux BAS firmwares and there's some great tools out there that I cannot recommend highly enough my favorite",
    "start": "1736880",
    "end": "1743799"
  },
  {
    "text": "right now is firmware modkit because it's fairly vendor agnostic it doesn't care if it's lynxis or Cisco not to pick",
    "start": "1743799",
    "end": "1750240"
  },
  {
    "text": "on them but a variety of other firmwares as well and basically what it does is it analyzes the binary it determines things",
    "start": "1750240",
    "end": "1757640"
  },
  {
    "text": "it looks for like lzma compression file systems and just a damn good job of decompressing the devices giving you",
    "start": "1757640",
    "end": "1764760"
  },
  {
    "text": "basically a file system that you're free to tweak as you like and you don't even need to run these in an emulator or have",
    "start": "1764760",
    "end": "1770600"
  },
  {
    "text": "a caros compile tool chain and the majority of these devices are running on common architecture arm myips Etc and",
    "start": "1770600",
    "end": "1778640"
  },
  {
    "text": "then furthermore there are uh WRT54G links to specific devices that if if",
    "start": "1778640",
    "end": "1783960"
  },
  {
    "text": "that's all you're really going after then that's a good way to go and then of course there's DDWRT which is a proper",
    "start": "1783960",
    "end": "1789679"
  },
  {
    "text": "router replacement firmware and it's actually excellent so we're we're going to we're going to pick on them a little bit but not because of anything that",
    "start": "1789679",
    "end": "1796200"
  },
  {
    "text": "they've done wrong just how common and easy they are to modify so how once we",
    "start": "1796200",
    "end": "1801360"
  },
  {
    "text": "have this Rogue firmware that we spent a weekend in a sixpack of beer or more developing okay we've got it great so",
    "start": "1801360",
    "end": "1808320"
  },
  {
    "text": "how do we do the the uh the install all right so a little bit of uh",
    "start": "1808320",
    "end": "1813760"
  },
  {
    "text": "you know if anyone's ever looked into how do I CSRA files over the Internet how do I do that kind of thing you've",
    "start": "1813760",
    "end": "1819880"
  },
  {
    "text": "probably ran in the case that people have done in the past but with flash extensions there's been some bugs in",
    "start": "1819880",
    "end": "1825240"
  },
  {
    "text": "Flash and as far as I know they've been patched up there might be some more but I'm not aware of any open vulnerabilities in there browsers also",
    "start": "1825240",
    "end": "1832600"
  },
  {
    "text": "don't give a lot of control over the request so if you wanted to do csrf of file types and binaries and things like",
    "start": "1832600",
    "end": "1839000"
  },
  {
    "text": "that you're kind of stuck they're not able to correctly handle binaries and for Fields unless",
    "start": "1839000",
    "end": "1844799"
  },
  {
    "text": "they're going through their normal file API and if you try to send it through JavaScript JavaScript completely mangles",
    "start": "1844799",
    "end": "1850960"
  },
  {
    "text": "the binary data well that was until this came along",
    "start": "1850960",
    "end": "1856519"
  },
  {
    "text": "and all the browser vendors decided want to add a lot of features to their browsers",
    "start": "1856519",
    "end": "1862080"
  },
  {
    "text": "woo all right so with all these new features can we take over an entire",
    "start": "1862080",
    "end": "1867799"
  },
  {
    "text": "network by combining JavaScript",
    "start": "1867799",
    "end": "1871679"
  },
  {
    "text": "attacks",
    "start": "1875000",
    "end": "1878000"
  },
  {
    "text": "yes all right so let me just go over the basic steps of deploying the firmware similar to you know we're using using a",
    "start": "1882760",
    "end": "1888399"
  },
  {
    "start": "1883000",
    "end": "1883000"
  },
  {
    "text": "csrf technique right so the victim visits the attack site and the attack",
    "start": "1888399",
    "end": "1894679"
  },
  {
    "text": "site instructs them to access malicious firmware but using these new JavaScript apis we're able to get it to download",
    "start": "1894679",
    "end": "1902000"
  },
  {
    "text": "that firmware and store it in memory and it keeps it there and this is all transparent to the user we're still",
    "start": "1902000",
    "end": "1908120"
  },
  {
    "text": "talking zero user interaction absolutely there's no file download alert or anything like that so the new firmware",
    "start": "1908120",
    "end": "1915399"
  },
  {
    "text": "that you have is going to be stored in memory and then you can resend it wherever you want so in this case we're",
    "start": "1915399",
    "end": "1920840"
  },
  {
    "text": "going to resend it internally to the user Network to the device that we just logged",
    "start": "1920840",
    "end": "1927559"
  },
  {
    "text": "into all right and I have a demo for that",
    "start": "1927639",
    "end": "1931840"
  },
  {
    "text": "too all right for so for this technique um once again we're using the uh linkis",
    "start": "1936120",
    "end": "1941679"
  },
  {
    "text": "WT 54g based on Linux there's the DDWRT software for it that is pretty",
    "start": "1941679",
    "end": "1948399"
  },
  {
    "text": "configurable you're allowed to um uh pretty much do whatever you want with it it adds a bunch of features and things",
    "start": "1948399",
    "end": "1953960"
  },
  {
    "text": "like that but it's great um as a demonstration so I create a little test",
    "start": "1953960",
    "end": "1961440"
  },
  {
    "text": "page",
    "start": "1961440",
    "end": "1963799"
  },
  {
    "text": "here and uh yes clicking the Run attack button can brick devices so you have to be",
    "start": "1967639",
    "end": "1975960"
  },
  {
    "text": "careful and it's important to mentioned that a bad guy looking over looking for return over investment versus a specific",
    "start": "1975960",
    "end": "1982679"
  },
  {
    "text": "targeted attack that is to say that you may not really necessarily want to use these in penetration tests where the",
    "start": "1982679",
    "end": "1988559"
  },
  {
    "text": "scope do not enclo destroying the uh Enterprise Network um but you know bad guys tend to not care about that so let",
    "start": "1988559",
    "end": "1995639"
  },
  {
    "text": "me just remind you what uh that linkis interface looks like so",
    "start": "1995639",
    "end": "2002039"
  },
  {
    "text": "familiar and I'm going to click run attack and of course this can all be done in the background and I have a little bit of information here cool",
    "start": "2002039",
    "end": "2007600"
  },
  {
    "text": "thing about um cross origin resource sharing is you can get information like that you get get that progress bar going",
    "start": "2007600",
    "end": "2014039"
  },
  {
    "text": "on because it's actually getting the information from the attacker domain uh but we can see here that I can actually tell a lot of information even though",
    "start": "2014039",
    "end": "2020519"
  },
  {
    "text": "cross origin resource sharing is supposed to prevent you from doing a lot of things you're not supposed to be able to see the response so it's like how can",
    "start": "2020519",
    "end": "2027639"
  },
  {
    "text": "this kind of stuff work all right so we see the steps downloading malicious firmware malicious firmware received",
    "start": "2027639",
    "end": "2032919"
  },
  {
    "text": "creating a new csrf request and now it's uploading the malicious firmware to the Linkus device all right so this takes a",
    "start": "2032919",
    "end": "2038840"
  },
  {
    "text": "little bit you know it's it's a uh couple Meg download couple Meg upload and right now it's sitting there and",
    "start": "2038840",
    "end": "2044200"
  },
  {
    "text": "waiting for a response and the thing about chors is is the browser and JavaScript without special headers um",
    "start": "2044200",
    "end": "2051079"
  },
  {
    "text": "being provided by this device which it's not going to have because it's an older device before HTML 5 even was a word um",
    "start": "2051079",
    "end": "2059440"
  },
  {
    "text": "it's it's uh not going to be able to see the response but when the request fails",
    "start": "2059440",
    "end": "2064638"
  },
  {
    "text": "it's going to air out and that's going to tell us that it's finished",
    "start": "2064639",
    "end": "2069720"
  },
  {
    "text": "and and one thing to consider is while this appears to be taking a little bit longer and most of us would probably",
    "start": "2069720",
    "end": "2075158"
  },
  {
    "text": "wonder why this is taking so long on sites like mega upload rapid share Etc",
    "start": "2075159",
    "end": "2080440"
  },
  {
    "text": "it's pretty standard requirement to wait make you wait at least 30 seconds so it's it's not like this is ringing any",
    "start": "2080440",
    "end": "2085919"
  },
  {
    "text": "bells right now in those situations absolutely and and once that kind of attack got sent all the way through the",
    "start": "2085919",
    "end": "2091320"
  },
  {
    "text": "wire I know it took a while for it to time out but once it gets all the way sent through I mean you're done at that",
    "start": "2091320",
    "end": "2097079"
  },
  {
    "text": "point you can you know the user can shut down their browser it doesn't matter cuz the attack is over with and the device",
    "start": "2097079",
    "end": "2104040"
  },
  {
    "text": "has been fully compromised so um uh with this device it actually has a little problem where it needs to uh be rebooted",
    "start": "2104040",
    "end": "2110720"
  },
  {
    "text": "here so I'm going to do a quick reboot of it and that's generally specific to these device depending on the make menu",
    "start": "2110720",
    "end": "2117680"
  },
  {
    "text": "manufacturer there are often times apis that will allow you to actually reboot the device silently so for the purposes",
    "start": "2117680",
    "end": "2124240"
  },
  {
    "text": "of this demo we're unplugging it but generally speaking that's not always a",
    "start": "2124240",
    "end": "2130359"
  },
  {
    "text": "limitation we'll give that a minute to boot up",
    "start": "2132839",
    "end": "2137119"
  },
  {
    "text": "here so how's your black cat going so far good yeah good all right s right s",
    "start": "2149079",
    "end": "2156400"
  },
  {
    "text": "right",
    "start": "2156400",
    "end": "2159400"
  },
  {
    "text": "I don't know who this is but I'm totally stealing it takes a while to",
    "start": "2163880",
    "end": "2170000"
  },
  {
    "text": "load I think we're going to move on and then we'll show you in a little bit because uh we got to make sure we stay",
    "start": "2170079",
    "end": "2175880"
  },
  {
    "text": "in time here but what's going to happen is you're going to see the DDWRT software",
    "start": "2175880",
    "end": "2182640"
  },
  {
    "text": "there here's how that works here's some script if if uh once you get these slides later on uh not from the DVD but",
    "start": "2183920",
    "end": "2191800"
  },
  {
    "text": "uh from my website or elsewhere um this is pretty much what's going on we have a uh new xmo HTTP request we um set it to",
    "start": "2191800",
    "end": "2200400"
  },
  {
    "text": "grab the firmware that's the bad firmware.bin of course we set override mime type what that tells it to do is",
    "start": "2200400",
    "end": "2206400"
  },
  {
    "text": "not to mess with the data that comes to it um normally the browser is going to be like oh this is utf8 encoding or some",
    "start": "2206400",
    "end": "2212560"
  },
  {
    "text": "other character set so I'm going to do something weird to it no this tells it don't do anything all right so we send",
    "start": "2212560",
    "end": "2218520"
  },
  {
    "text": "that initial request to the attacker's website which of course gives us permission to see the response um so",
    "start": "2218520",
    "end": "2224680"
  },
  {
    "text": "once you get that response you run another XML HTP request this time you're opening it to the uh Network device um",
    "start": "2224680",
    "end": "2232880"
  },
  {
    "text": "there's a uh flag with credentials if you set that to True any credentials",
    "start": "2232880",
    "end": "2238240"
  },
  {
    "text": "that the user has on that domain are sent along with the request and that includes basic",
    "start": "2238240",
    "end": "2243480"
  },
  {
    "text": "authentication um and then at the at the end you have uh the set the request header and what you're we're doing here",
    "start": "2243480",
    "end": "2249280"
  },
  {
    "text": "is we're actually spoofing what a multi-art um form data request looks",
    "start": "2249280",
    "end": "2255560"
  },
  {
    "text": "like you're able to um have so much control using these types of requests that you can make it look just like you",
    "start": "2255560",
    "end": "2262839"
  },
  {
    "text": "used a form submission and at the end of course we have our image tag which is",
    "start": "2262839",
    "end": "2268079"
  },
  {
    "text": "automatically going to log the user into the device and then once it airs out for whatever reason uh when it finds out",
    "start": "2268079",
    "end": "2275440"
  },
  {
    "text": "that's not a real image in this case that's when it's going to start running the script but the cool thing is you can see",
    "start": "2275440",
    "end": "2282000"
  },
  {
    "text": "all the code for this on GitHub um I put it up there today so I'm calling this a DDWRT install tool because if your",
    "start": "2282000",
    "end": "2289160"
  },
  {
    "text": "friends are like hey I don't know how to get DDWRT installed on my computer you can just say okay go to this website and click",
    "start": "2289160",
    "end": "2295040"
  },
  {
    "text": "Start kind of like using Metasploit for tech support for your family which actually works really well by the",
    "start": "2295040",
    "end": "2301760"
  },
  {
    "text": "way all right so that's github.com super ever DDWRT install tool all right now",
    "start": "2301760",
    "end": "2307680"
  },
  {
    "start": "2307000",
    "end": "2307000"
  },
  {
    "text": "post exploitation this part's really interesting okay so right now what we've explained is basically using uh network",
    "start": "2307680",
    "end": "2313640"
  },
  {
    "text": "devices and for right now our demo is small office home office routers you're like big deal okay one of those gets",
    "start": "2313640",
    "end": "2319960"
  },
  {
    "text": "compromised and we eventually figure it out we throw it out but what's interesting about this is that you've",
    "start": "2319960",
    "end": "2325560"
  },
  {
    "text": "essentially turned in these Soho devices at home in the VPN or in the device in",
    "start": "2325560",
    "end": "2331079"
  },
  {
    "text": "the QA and Engineering lab into a full-blown Linux attack framework and generally speaking it will still look",
    "start": "2331079",
    "end": "2337520"
  },
  {
    "text": "can act the same way um so you start thinking about well okay no big deal I've got Cisco devices right this attack",
    "start": "2337520",
    "end": "2344079"
  },
  {
    "text": "doesn't really matter because for the most part you can't upload firmware for Cisco devices okay fair enough but who",
    "start": "2344079",
    "end": "2351440"
  },
  {
    "text": "knows what happens when you crash or dos a Cisco device typically it'll reboot",
    "start": "2351440",
    "end": "2357200"
  },
  {
    "text": "and it'll go through an order of operations of places to look for backups and one of those backups that it looks for tends to be tftp right okay well now",
    "start": "2357200",
    "end": "2365400"
  },
  {
    "text": "we've got a tftp server that's light as stored on this device and we can ARP at that point so if we know by Network",
    "start": "2365400",
    "end": "2372520"
  },
  {
    "text": "traffic sniffing or man- in-the-middle attacks that Cisco is looking for this one IP address are spoofing they come to",
    "start": "2372520",
    "end": "2379560"
  },
  {
    "text": "us their tftp or their Cisco configuration goes to us and now we could do some cool stuff like opening",
    "start": "2379560",
    "end": "2385760"
  },
  {
    "text": "GRE tunnels to where a tax server in you know some Eastern European country or Etc or you know P testing server um but",
    "start": "2385760",
    "end": "2393440"
  },
  {
    "text": "also if a device like this has a wireless access point and several of them do well then you can start using",
    "start": "2393440",
    "end": "2399640"
  },
  {
    "text": "tools like Airbase NG where you're able to actually clone access points that are listening for every single Beacon",
    "start": "2399640",
    "end": "2406880"
  },
  {
    "text": "request from a client looking for specific favorite listed access point broadcast that and when they communicate",
    "start": "2406880",
    "end": "2413359"
  },
  {
    "text": "number one if they're dual homed on the corporate network over ethernet bang rang but number two once they're using",
    "start": "2413359",
    "end": "2419960"
  },
  {
    "text": "you as an outbound Gateway you can then start doing cool stuff like injecting the ey frames for every single one of",
    "start": "2419960",
    "end": "2425480"
  },
  {
    "text": "these attacks every re that they make and then if they take that home Etc this",
    "start": "2425480",
    "end": "2430800"
  },
  {
    "text": "this code tends to propagate so it's really interesting from a bad guy perspective you insert the payload into",
    "start": "2430800",
    "end": "2436880"
  },
  {
    "text": "all requests and responses and you're good to go furthermore because we own the device at this point logging is out",
    "start": "2436880",
    "end": "2443599"
  },
  {
    "text": "the window there's nothing that we need to worry about anymore um really cool stuff like pivoting via SSH tunnel or an",
    "start": "2443599",
    "end": "2451720"
  },
  {
    "text": "openvpn server Etc basically persistence in a nearly undetect able way okay well",
    "start": "2451720",
    "end": "2458319"
  },
  {
    "text": "now you're saying well no I'm Port scanning these devices obviously there's a port open at 2222 that I did not",
    "start": "2458319",
    "end": "2464960"
  },
  {
    "text": "authorized something's arve right well not necessarily because you already own",
    "start": "2464960",
    "end": "2470160"
  },
  {
    "start": "2469000",
    "end": "2469000"
  },
  {
    "text": "the firmware you can do whatever the hell you want with it it can be some sort of outof band command and control",
    "start": "2470160",
    "end": "2475640"
  },
  {
    "text": "system over IRC for example runs over SSL and let's be honest a lot of the IDS",
    "start": "2475640",
    "end": "2480960"
  },
  {
    "text": "IPS systems out there just have a blind spot for rest of cell and it's sort of",
    "start": "2480960",
    "end": "2486119"
  },
  {
    "text": "the Dirty Little Secret not to say that all of them can't do that but it's a common problem um and then there's",
    "start": "2486119",
    "end": "2492040"
  },
  {
    "text": "reverse Sate shelves and again using non-standard ports over 443 over DNS Etc",
    "start": "2492040",
    "end": "2498280"
  },
  {
    "text": "where common firewalls are expecting outbound traffic from work to go to these ports then uh it tends to be a",
    "start": "2498280",
    "end": "2504440"
  },
  {
    "text": "little bit more surreptitious but let's say you're attacking a remote user maybe",
    "start": "2504440",
    "end": "2509520"
  },
  {
    "text": "uh maybe the CFO likes to work from his Bahamas summer home or whatever and he's got one of these bad boys well we don't",
    "start": "2509520",
    "end": "2516359"
  },
  {
    "text": "have to worry about about port forwarding and stuff anymore because now that we own the edge device in this kit",
    "start": "2516359",
    "end": "2521760"
  },
  {
    "text": "situation we can open up whatever the hell Port we want um and so you could do something a little bit more",
    "start": "2521760",
    "end": "2527440"
  },
  {
    "text": "surreptitious where you don't have to worry about the random script Kitty going through finding it and getting",
    "start": "2527440",
    "end": "2532720"
  },
  {
    "text": "your cover blown because then you can start to implement things like Port knocking Etc where the port the Engish",
    "start": "2532720",
    "end": "2538000"
  },
  {
    "text": "bind Port will never be seen unless you know a secret password and at at that point you know with propagation you're",
    "start": "2538000",
    "end": "2545520"
  },
  {
    "text": "able to do a lot of really cool things things so and don't forget that ipss and",
    "start": "2545520",
    "end": "2551119"
  },
  {
    "text": "ids's are also often controlled through a web interface they may have these problems too exactly what happens if",
    "start": "2551119",
    "end": "2557319"
  },
  {
    "text": "your IDs is compromised and and once you've got these reverse controls we can easily upload our own new functionality",
    "start": "2557319",
    "end": "2564559"
  },
  {
    "text": "and what more is that we can actually disable the built-in firmware upload functionality so we don't even have to",
    "start": "2564559",
    "end": "2570119"
  },
  {
    "text": "worry about the vendor pushing out some new code and uploading it so the client tries to go ahead and fix it we just",
    "start": "2570119",
    "end": "2576359"
  },
  {
    "text": "throw it out we could if you know if you want to get crazy and code this you can rev the version number itself in the the",
    "start": "2576359",
    "end": "2582880"
  },
  {
    "text": "malicious firmware it's up to your imagination and your skill level at that point so at this point ironically the",
    "start": "2582880",
    "end": "2591079"
  },
  {
    "text": "paradigm shift is such that most often the older the software is the more likely you are to be vulnerable but with",
    "start": "2591079",
    "end": "2597720"
  },
  {
    "text": "cross-site file upload and the HTML 5 integration it's a total shift because the more current your browser is the",
    "start": "2597720",
    "end": "2604480"
  },
  {
    "text": "more likely you are to be vulnerable in some of these situ situations IE 10 supports",
    "start": "2604480",
    "end": "2610590"
  },
  {
    "text": "[Music] cores all right so what are what are some of the pros of an attack like this",
    "start": "2610590",
    "end": "2616599"
  },
  {
    "text": "and and once again you know this is just kind of something that can be done that's that's what we want to prove to",
    "start": "2616599",
    "end": "2622079"
  },
  {
    "text": "you guys that you know this could be done if somebody spent enough time and built a large enough toolkit this could",
    "start": "2622079",
    "end": "2628920"
  },
  {
    "text": "be done but some of the pros of it is that doesn't rely on the browser remaining open uh when the attack",
    "start": "2628920",
    "end": "2635119"
  },
  {
    "text": "completes you're compromising another device on that network not that user's computer you can also propagate deeper",
    "start": "2635119",
    "end": "2641680"
  },
  {
    "text": "into that Network once you get there you'll have better persistance you're going to be harder to discover and",
    "start": "2641680",
    "end": "2648200"
  },
  {
    "text": "you're going to be immune to antivirus these devices don't run antivirus so you",
    "start": "2648200",
    "end": "2653680"
  },
  {
    "text": "can pretty much do whatever you want you can change the interface up you can hide elements from the user when they log in",
    "start": "2653680",
    "end": "2659160"
  },
  {
    "text": "furthermore because these devices are never actually written to the client's computer system they typically are not",
    "start": "2659160",
    "end": "2665599"
  },
  {
    "text": "detected by traditional desktop antivirus systems some of the cons out there well",
    "start": "2665599",
    "end": "2673720"
  },
  {
    "start": "2670000",
    "end": "2670000"
  },
  {
    "text": "with so many devices and you know Network equipment out there it it could be difficult to uh build a wide enough",
    "start": "2673720",
    "end": "2681040"
  },
  {
    "text": "range of um exploits for these they're all unique right except a lot of uh um",
    "start": "2681040",
    "end": "2687599"
  },
  {
    "text": "exploit developers they want to program for Windows right it's easy you write it once and it writes on a ton of computers",
    "start": "2687599",
    "end": "2693599"
  },
  {
    "text": "uh it takes a lot of extra extra effort and pre-work to do this and victims may not be running latest browsers maybe",
    "start": "2693599",
    "end": "2699440"
  },
  {
    "text": "they're still running older versions and uh if the devices really do have unique",
    "start": "2699440",
    "end": "2707280"
  },
  {
    "text": "passwords the compromise isn't guaranteed so you may have a pretty low ratio of success um to not without doing",
    "start": "2707280",
    "end": "2715640"
  },
  {
    "text": "the necessary open source intelligence gathering to in order to determine which passwords your target is more likely to",
    "start": "2715640",
    "end": "2721960"
  },
  {
    "text": "use but if you're going for Mass propagation this can tend to be a limiting factor compared to to the",
    "start": "2721960",
    "end": "2727880"
  },
  {
    "text": "windows exploit dour all right so what about mitigation so one thing that kind of stunned me is",
    "start": "2727880",
    "end": "2734520"
  },
  {
    "text": "that site shouldn't be able to access private IP addresses on your network I mean we know what IP addresses the these",
    "start": "2734520",
    "end": "2740960"
  },
  {
    "text": "are because they're in RFC 5735 um cross origin resource sharing",
    "start": "2740960",
    "end": "2746640"
  },
  {
    "text": "maybe it could be even more restrictive I don't think any uh developer is using it in this way today to legitimately",
    "start": "2746640",
    "end": "2753520"
  },
  {
    "text": "send files over the air um without need to see the response and uh of course these devices",
    "start": "2753520",
    "end": "2761559"
  },
  {
    "text": "need csrf protection I mean it's been long time since csrf was you know",
    "start": "2761559",
    "end": "2768760"
  },
  {
    "text": "uh disclosed and they're still not updating their software to take care of it it's not that high enough of a",
    "start": "2768760",
    "end": "2775599"
  },
  {
    "text": "priority a little bit more mitigation on that is these devices what if they had automatic updates you know like why not",
    "start": "2775599",
    "end": "2782359"
  },
  {
    "text": "your your uh windows or your Mac has automatic updates why not your network",
    "start": "2782359",
    "end": "2787440"
  },
  {
    "text": "devices too signed firmware modules that that sounds simple right you want to make",
    "start": "2787440",
    "end": "2793359"
  },
  {
    "text": "sure that the firmware going onto the device came from the manufacturer and uh for Enterprise they",
    "start": "2793359",
    "end": "2800680"
  },
  {
    "text": "may want to look at JavaScript a little bit differently it has a lot of power now that it's getting all these features",
    "start": "2800680",
    "end": "2806319"
  },
  {
    "text": "so you may want to treat it more like a third party plugin like Java and I don't know if it's even",
    "start": "2806319",
    "end": "2812440"
  },
  {
    "text": "possible but you AV vendors may want to create some heris for crossy file",
    "start": "2812440",
    "end": "2817680"
  },
  {
    "text": "uploads so that they can detect it in the wild all right so so really what I want",
    "start": "2817680",
    "end": "2823800"
  },
  {
    "start": "2822000",
    "end": "2822000"
  },
  {
    "text": "you get out of this is four simple facts devices on your network have",
    "start": "2823800",
    "end": "2829520"
  },
  {
    "text": "vulnerabilities and if you don't think so you're kidding yourself your web browser allows",
    "start": "2829520",
    "end": "2835720"
  },
  {
    "text": "attacker attack sites to access those devices all right attackers can use csrf",
    "start": "2835720",
    "end": "2841280"
  },
  {
    "text": "to log into those devices and then once they log in they can replace the operating system system on that device",
    "start": "2841280",
    "end": "2848280"
  },
  {
    "text": "for their malicious purposes and maintain control indefinitely all right so uh this talk",
    "start": "2848280",
    "end": "2856559"
  },
  {
    "text": "it came from a lot of information from a lot of other great researchers so I want to give them credit here a lot of",
    "start": "2856559",
    "end": "2861800"
  },
  {
    "text": "brilliant work you know we we we added a few new things to it we put a few things together but uh there's a lot of good",
    "start": "2861800",
    "end": "2869119"
  },
  {
    "text": "research that went into it beforehand so thanks to these guys wait no specific shout outs go back for a",
    "start": "2869119",
    "end": "2874960"
  },
  {
    "text": "second because I feel like it's worth saying out loud um Jeremiah Grossman's black hat 2006",
    "start": "2874960",
    "end": "2880119"
  },
  {
    "text": "talk the deathcon 17 csrf talk with mck and Bailey um the remote attacks against",
    "start": "2880119",
    "end": "2885960"
  },
  {
    "text": "Soho routers from Hefner in 2010 um and specifically kotowitz is doing some really cool stuff that sort of led to",
    "start": "2885960",
    "end": "2892839"
  },
  {
    "text": "this specific research and there's a lot of other people but seriously we wouldn't be here without them standing",
    "start": "2892839",
    "end": "2897920"
  },
  {
    "text": "on the shoulders of giants so if you guys are in the audience thank you thank you",
    "start": "2897920",
    "end": "2905838"
  },
  {
    "text": "so we have a couple extra minutes for questions and if you're brave enough to stand up and hassle us uh we've got some",
    "start": "2908040",
    "end": "2913079"
  },
  {
    "text": "cool ABS swag you can choose between challenge coins or t-shirts uh any",
    "start": "2913079",
    "end": "2918319"
  },
  {
    "text": "questions um",
    "start": "2918319",
    "end": "2923599"
  },
  {
    "text": "um yes we we just use routers as an example the question was we specifically",
    "start": "2928880",
    "end": "2934319"
  },
  {
    "text": "focused in this use case on routers specifically here Soho routers and is this possible using other devices and",
    "start": "2934319",
    "end": "2941760"
  },
  {
    "text": "the answer is hell yes but we would have spent 50 minutes discussing all the different possibilities and to be quite",
    "start": "2941760",
    "end": "2948000"
  },
  {
    "text": "honest it was the easiest to prove the proof of concept with this but it absolutely is limitation is only your",
    "start": "2948000",
    "end": "2953960"
  },
  {
    "text": "familiarity your skill and your imagination you want you want a coin or you want a",
    "start": "2953960",
    "end": "2959880"
  },
  {
    "text": "shirt there you go man yeah all let's check it out",
    "start": "2959880",
    "end": "2966319"
  },
  {
    "text": "[Applause] there it",
    "start": "2966490",
    "end": "2973599"
  },
  {
    "text": "is y any other questions real fast",
    "start": "2977480",
    "end": "2984119"
  },
  {
    "text": "yeah I'm sorry mobs mobile browser so I",
    "start": "2984119",
    "end": "2989200"
  },
  {
    "text": "I didn't do any testing specifically and uh the question was uh have we done tested this on mobile browsers to see if",
    "start": "2989200",
    "end": "2994680"
  },
  {
    "text": "they have the same problems uh mobile browsers are quickly catching up to the desktop browsers although it was",
    "start": "2994680",
    "end": "3001359"
  },
  {
    "text": "would be inconvenient to me for me to do this kind of testing it's it looks completely possible especially since",
    "start": "3001359",
    "end": "3007400"
  },
  {
    "text": "they want the mobile devices to mirror the desktop ones Shir shter challenge coin yeah okay",
    "start": "3007400",
    "end": "3015920"
  },
  {
    "text": "what",
    "start": "3015920",
    "end": "3018119"
  },
  {
    "text": "size a challenge coin yeah yeah",
    "start": "3021040",
    "end": "3027640"
  },
  {
    "text": "well here I'll show you this is challenge quot good size",
    "start": "3027640",
    "end": "3033559"
  },
  {
    "text": "double size that so the question is is it putting too much effort to put this large package of data onto these devices",
    "start": "3033559",
    "end": "3040160"
  },
  {
    "text": "is that too much effort um I think it's it's a quite a lot of effort but you get it quite a lot back because that device",
    "start": "3040160",
    "end": "3047240"
  },
  {
    "text": "isn't going to be fixed by antivirus it's not going to be caught and in an attack where you had a million users run",
    "start": "3047240",
    "end": "3054400"
  },
  {
    "text": "this code if your database of vulnerable devices and vulnerabilities and firmwares was big enough beforehand you",
    "start": "3054400",
    "end": "3062480"
  },
  {
    "text": "can get a higher rate of success there and once you have uh those devices in",
    "start": "3062480",
    "end": "3067799"
  },
  {
    "text": "your control they stay that way",
    "start": "3067799",
    "end": "3075079"
  },
  {
    "text": "y uh my slides will be available on my website super.com right",
    "start": "3075760",
    "end": "3083318"
  },
  {
    "text": "me okay and yes not there right now but they will be tonight so I think we're uh",
    "start": "3083400",
    "end": "3090200"
  },
  {
    "text": "about ready to get our asses kicked off stage so if you have any other questions um yeah talk to us yeah just follow us I",
    "start": "3090200",
    "end": "3096200"
  },
  {
    "text": "think we're going to walk back to the speaker room yeah we'll walk back to the speaker room and bring all the swag with us thank you very much guys",
    "start": "3096200",
    "end": "3103640"
  }
]