[
  {
    "start": "0",
    "end": "248000"
  },
  {
    "text": "good afternoon welcome to the VoIP ORS the freaker's",
    "start": "30",
    "end": "5130"
  },
  {
    "text": "awaken you're in Mandalay Bay gh and your speaker today is Fatih ahzaab G",
    "start": "5130",
    "end": "12769"
  },
  {
    "text": "before we begin a few brief notes of housekeeping please stop by the business",
    "start": "12769",
    "end": "18630"
  },
  {
    "text": "hall located in Bayside a B if you haven't done that already the blackhat Arsenal is on the palm",
    "start": "18630",
    "end": "26039"
  },
  {
    "text": "foyer on level 3 and of course the Arsenal reception is at 1700 if you",
    "start": "26039",
    "end": "32578"
  },
  {
    "text": "haven't picked up your merchandise today is your last chance to visit the black hat Fagin bookstore so make sure you",
    "start": "32579",
    "end": "38760"
  },
  {
    "text": "take a look at that visit the Kali Linux lab in Mandalay Bay a and thank you also",
    "start": "38760",
    "end": "45539"
  },
  {
    "text": "for putting your phone on vibrate during the presentation and if you look around",
    "start": "45539",
    "end": "50789"
  },
  {
    "text": "there are five microphones so there will be a Q&A at the end of the talk so",
    "start": "50789",
    "end": "56219"
  },
  {
    "text": "please try to step up to a microphone so that we can all hear your question and without further ado I present Bochy",
    "start": "56219",
    "end": "64309"
  },
  {
    "text": "thank you Thanks",
    "start": "64309",
    "end": "70720"
  },
  {
    "text": "my voice is clear for the back robes everybody hears me nice",
    "start": "70720",
    "end": "76860"
  },
  {
    "text": "I'm here to talk about voice over IP but voice over IP is the blind spot of the",
    "start": "76860",
    "end": "83110"
  },
  {
    "text": "current IT security world so I have provided vPro and voice over IP was",
    "start": "83110",
    "end": "89440"
  },
  {
    "text": "researched series in major secret conferences to change this with some",
    "start": "89440",
    "end": "94720"
  },
  {
    "text": "practical attacks so maybe I can get more attention for voice over IP so",
    "start": "94720",
    "end": "100119"
  },
  {
    "text": "voice over IP wars had four different presentations yes it is a Serie just",
    "start": "100119",
    "end": "106270"
  },
  {
    "text": "like the original one but the challenges every presentation",
    "start": "106270",
    "end": "111990"
  },
  {
    "text": "is presented for something else actually sometimes it is for protocols sometimes",
    "start": "111990",
    "end": "119140"
  },
  {
    "text": "it is for a specific product line or cloud services but sometimes it is much more general in this context I will talk",
    "start": "119140",
    "end": "125979"
  },
  {
    "text": "about voice over IP force the freaker's awakened today my name is photos of you",
    "start": "125979",
    "end": "132720"
  },
  {
    "text": "actually I love VoIP and freaking but I also work on mobile applications mobile",
    "start": "132720",
    "end": "139480"
  },
  {
    "text": "devices a network infrastructure a special service provider networks consumer device and etc so I try to",
    "start": "139480",
    "end": "145570"
  },
  {
    "text": "combine almost all these techniques to find new vulnerabilities and new research areas for myself and for my",
    "start": "145570",
    "end": "152320"
  },
  {
    "text": "customers of course and I'm also author of V Pro and voice over IP wars V Pro is",
    "start": "152320",
    "end": "158410"
  },
  {
    "text": "a tool and we will discuss this in our future slides I also had a public",
    "start": "158410",
    "end": "163959"
  },
  {
    "text": "speaking and training sessions in a major security conferences including black at DEFCON and troopers so you may",
    "start": "163959",
    "end": "171310"
  },
  {
    "text": "see the other videos to maybe learn more about some specific",
    "start": "171310",
    "end": "178030"
  },
  {
    "text": "attacks today I will talk about the UC and IMS",
    "start": "178030",
    "end": "183820"
  },
  {
    "text": "fundamentals first so everybody will be on the same page before the presentation",
    "start": "183820",
    "end": "189430"
  },
  {
    "text": "because we need to understand what is unified communications what is IMS and what is voice over IP and how can we",
    "start": "189430",
    "end": "196239"
  },
  {
    "text": "attack using voice over IP or unified communications or targeting the services",
    "start": "196239",
    "end": "201520"
  },
  {
    "text": "themselves so we have a few different points of attacks so I will target the clients I",
    "start": "201520",
    "end": "207630"
  },
  {
    "text": "will target the server's sometimes architecture and I had some shiny demos",
    "start": "207630",
    "end": "213780"
  },
  {
    "text": "in my previous talks as well so sometimes I will refer them also I will",
    "start": "213780",
    "end": "219330"
  },
  {
    "text": "talk about some different designs various implementations of voice over IP and unified communications this includes",
    "start": "219330",
    "end": "225900"
  },
  {
    "text": "cloud security or call center security IMS and service provider networks and I",
    "start": "225900",
    "end": "232230"
  },
  {
    "text": "will talk about the earth security and some design issues or vulnerabilities and after that we will talk about",
    "start": "232230",
    "end": "237360"
  },
  {
    "text": "practical attacks and I will demonstrate a few practical attacks so you will see how they work or not and of course I",
    "start": "237360",
    "end": "246120"
  },
  {
    "text": "will have some suggestions to make it secure in the first communication day we",
    "start": "246120",
    "end": "252060"
  },
  {
    "start": "248000",
    "end": "248000"
  },
  {
    "text": "had a DS and Bob and Alice can call Bob who is a call center agent to discuss",
    "start": "252060",
    "end": "257310"
  },
  {
    "text": "things let's say taking a support from Bob but Alice could talk only through a",
    "start": "257310",
    "end": "264780"
  },
  {
    "text": "traditional system so we had only voice though this changed because we had",
    "start": "264780",
    "end": "272790"
  },
  {
    "text": "another architecture and Alice needed to use",
    "start": "272790",
    "end": "278630"
  },
  {
    "text": "voice over IP and voice over IP had two channels signaling and media signaling",
    "start": "278630",
    "end": "285780"
  },
  {
    "text": "is responsible to handshake with Bob and the service providers and",
    "start": "285780",
    "end": "290990"
  },
  {
    "text": "media transport is required to transfer all the other video but",
    "start": "290990",
    "end": "296480"
  },
  {
    "text": "this had no significant change on a leased world because Alice had",
    "start": "296480",
    "end": "303350"
  },
  {
    "text": "same audio again and maybe she can send SMS message and etc but unified",
    "start": "303350",
    "end": "309720"
  },
  {
    "text": "communications evolved in years so all this had more options these days and she",
    "start": "309720",
    "end": "315360"
  },
  {
    "start": "312000",
    "end": "312000"
  },
  {
    "text": "can send her bill through the same session to Bob to discuss about it Bob",
    "start": "315360",
    "end": "321570"
  },
  {
    "text": "may open a marketing presentation to Alice to get a kind of discount or",
    "start": "321570",
    "end": "327360"
  },
  {
    "text": "something like that or at least can ask Bob's support for a remote desktop",
    "start": "327360",
    "end": "332820"
  },
  {
    "text": "sharing RTP session they are all possible in this unified world and we call it",
    "start": "332820",
    "end": "338550"
  },
  {
    "text": "unified collaboration of course every one of them comes with a new attack",
    "start": "338550",
    "end": "344069"
  },
  {
    "start": "340000",
    "end": "340000"
  },
  {
    "text": "surface and we have too many different attacks here so we can combine all techniques and new techniques to build",
    "start": "344069",
    "end": "350990"
  },
  {
    "text": "successful attacks sometimes it is just like blue boxes or bypassing lines",
    "start": "350990",
    "end": "357330"
  },
  {
    "text": "sometimes adding some called spoofing and adding some additional things and combining them for example cross-site",
    "start": "357330",
    "end": "364650"
  },
  {
    "text": "scripting is possible through the sip calls so just imagine you can send a sip call to someone else including a",
    "start": "364650",
    "end": "371669"
  },
  {
    "text": "cross-site scripting content and waiting for a sort of shell from a phone this",
    "start": "371669",
    "end": "377310"
  },
  {
    "text": "doesn't sound right but it is possible in a kind of major product and it was",
    "start": "377310",
    "end": "383280"
  },
  {
    "text": "your day when I was presenting this in Europe blackhat Europe so there are",
    "start": "383280",
    "end": "389759"
  },
  {
    "text": "different attack surfaces in this context including some RDP attacks through RTP tons as well",
    "start": "389759",
    "end": "396379"
  },
  {
    "start": "396000",
    "end": "396000"
  },
  {
    "text": "let's focus on the basics how sip works and RTP works if Tony wants to call",
    "start": "396379",
    "end": "404819"
  },
  {
    "text": "Formby it needs to register to a sip server with credentials or not after the",
    "start": "404819",
    "end": "410759"
  },
  {
    "text": "registration it needs to send any might request to the server and server will forward this",
    "start": "410759",
    "end": "417000"
  },
  {
    "text": "request to the Kali in this case form B that request must be forwarded because",
    "start": "417000",
    "end": "425729"
  },
  {
    "text": "it will have SDP and XML contact because phone a and Form B must handshake about",
    "start": "425729",
    "end": "432949"
  },
  {
    "text": "audio or video codecs or RTP options and maybe encryption so all these options",
    "start": "432949",
    "end": "440759"
  },
  {
    "text": "must be forwarded to your phone be a bit some filtering we will discuss this in filter slice but foam B can say I am",
    "start": "440759",
    "end": "449069"
  },
  {
    "text": "busy or I accept or I refuse and etc in this context it accepts the call using",
    "start": "449069",
    "end": "454590"
  },
  {
    "text": "200 ok this says that all options are good but I prefer these options so if on",
    "start": "454590",
    "end": "462240"
  },
  {
    "text": "a offered some tank may be a list of options and Formby only picked one of them and",
    "start": "462240",
    "end": "469679"
  },
  {
    "text": "it sends its own response yes it is okay and then from a and B may have a call",
    "start": "469679",
    "end": "478469"
  },
  {
    "text": "call may include audio or video and other stuff and this will be transferred through RTP proxies because for a may",
    "start": "478469",
    "end": "486209"
  },
  {
    "text": "not be able to connect from B sometimes they may be in different locations or",
    "start": "486209",
    "end": "492689"
  },
  {
    "text": "different Network segregation that's why we use RTP proxy all of them comes with",
    "start": "492689",
    "end": "498509"
  },
  {
    "text": "additional attack services for example color and building is transferred through transfer through C patters I",
    "start": "498509",
    "end": "506629"
  },
  {
    "text": "think this microphone doesn't work this one only works",
    "start": "506629",
    "end": "511699"
  },
  {
    "text": "just double-checking of course SDP content is another attack surface in",
    "start": "511699",
    "end": "517649"
  },
  {
    "text": "this case because SDP content has the call options audio codecs sometimes file",
    "start": "517649",
    "end": "524219"
  },
  {
    "text": "transfer options port options encryption options and etc so we can play with them",
    "start": "524219",
    "end": "529380"
  },
  {
    "text": "to convince the remote client moreover RTP content it may have all",
    "start": "529380",
    "end": "536939"
  },
  {
    "text": "your video codecs or some malicious files or some RDP content so we use",
    "start": "536939",
    "end": "544050"
  },
  {
    "text": "sipping RDP both to attack I will focus on the signaling ones and some unified",
    "start": "544050",
    "end": "549569"
  },
  {
    "text": "communications components not RTP in this talk we see these attacks in real life and",
    "start": "549569",
    "end": "556050"
  },
  {
    "start": "553000",
    "end": "553000"
  },
  {
    "text": "sometimes we talk about robocalls getting some sip am we call it vision in",
    "start": "556050",
    "end": "561540"
  },
  {
    "text": "the world world there is a kind of terminology for example smishing is sending Malaysians SMS messages or robo",
    "start": "561540",
    "end": "570509"
  },
  {
    "text": "calls just a robot calling year but they are actual attacks sometimes they are",
    "start": "570509",
    "end": "575759"
  },
  {
    "text": "used in bomb threats sometimes they are just used for toll fraud to get some cash the other challenges also mobile",
    "start": "575759",
    "end": "583769"
  },
  {
    "text": "devices under attack because they use LT LT is a next-generation network with",
    "start": "583769",
    "end": "590189"
  },
  {
    "text": "voice a virtual reality vault ISA it includes IMS a environment but all those",
    "start": "590189",
    "end": "596550"
  },
  {
    "text": "mobile devices basically use sip so things may change because everything is",
    "start": "596550",
    "end": "603690"
  },
  {
    "text": "based on CP in these days you are carrying your phone and by default it uses sip this may change all the game",
    "start": "603690",
    "end": "611750"
  },
  {
    "text": "that's why I had presentations in blackhat and other secret conferences",
    "start": "611750",
    "end": "618210"
  },
  {
    "text": "sometimes I focused on the hardware putting an implant inside the Cisco IP phone and sending it out for a red",
    "start": "618210",
    "end": "624030"
  },
  {
    "text": "teaming exercise or focusing on Cisco you see DMF finding a kind of swap injection or focusing on clients to find",
    "start": "624030",
    "end": "630900"
  },
  {
    "text": "a kind of memory corruption or I provided a toolset to manipulate all the",
    "start": "630900",
    "end": "636720"
  },
  {
    "text": "tenant phones in a kind of cloud environments jailbreaking the environments all of them demonstrated live here",
    "start": "636720",
    "end": "643760"
  },
  {
    "text": "and I had some additional attack surfaces as well and I had additional",
    "start": "643760",
    "end": "649350"
  },
  {
    "text": "practical demos so if you are so keen to learn more about all those attacks they",
    "start": "649350",
    "end": "655290"
  },
  {
    "text": "will be my previous talks but today I will talk about new attacks first of all the larger organizations",
    "start": "655290",
    "end": "662130"
  },
  {
    "start": "660000",
    "end": "660000"
  },
  {
    "text": "should have their own communication system sometimes they use internal",
    "start": "662130",
    "end": "667680"
  },
  {
    "text": "communication this is a kind of corporate communication network but it is not suitable for large organizations",
    "start": "667680",
    "end": "673500"
  },
  {
    "text": "because there will be some servers and avoid a VoIP server as well and they will be a kind of local area network and",
    "start": "673500",
    "end": "680580"
  },
  {
    "text": "the clients sometimes IP phones they will use it the challenge here is",
    "start": "680580",
    "end": "686960"
  },
  {
    "text": "VLAN hoping or a data network and voice Network segregation they have some design issues most of the",
    "start": "686960",
    "end": "695640"
  },
  {
    "text": "time PC ports available on the phones and this may allow us to VLAN hopping or sometimes they a low voice LAN on pc",
    "start": "695640",
    "end": "703200"
  },
  {
    "text": "networks as well or maybe voice LAN and data land are not segregated well those",
    "start": "703200",
    "end": "709650"
  },
  {
    "text": "are issues but they have also longing employees they may need to use those",
    "start": "709650",
    "end": "716630"
  },
  {
    "text": "services the infrastructure so there is open services or",
    "start": "716630",
    "end": "723620"
  },
  {
    "text": "VPN connections and some filtering on the other hand most of the corporations",
    "start": "723620",
    "end": "729090"
  },
  {
    "text": "experience toll fraud because they have opened their voice over IP server in the world and",
    "start": "729090",
    "end": "735259"
  },
  {
    "text": "many people experience this that's why they migrated this to a cloud solution",
    "start": "735259",
    "end": "741889"
  },
  {
    "start": "738000",
    "end": "738000"
  },
  {
    "text": "so nobody cares the cloud itself they just focus on the service itself",
    "start": "741889",
    "end": "747860"
  },
  {
    "text": "phones are connected to the cloud the in integrated servers such as exchange is",
    "start": "747860",
    "end": "754290"
  },
  {
    "text": "also connected to the cloud it is also integrated to the phones and getting voicemails as an email and etc moreover",
    "start": "754290",
    "end": "761940"
  },
  {
    "text": "they may have some different locations and it is also connected to the cloud but the cloud has its own components",
    "start": "761940",
    "end": "769279"
  },
  {
    "text": "first of all some services must be dedicated to the customer the",
    "start": "769279",
    "end": "775889"
  },
  {
    "text": "organization we call it tenant because this environment is multi-tenant the",
    "start": "775889",
    "end": "781680"
  },
  {
    "text": "environment sometimes vendors use full isolation with some",
    "start": "781680",
    "end": "788279"
  },
  {
    "text": "dedicated products but sometimes they share the product or maybe a product",
    "start": "788279",
    "end": "793680"
  },
  {
    "text": "line with some dedicated and shared services in this case tenant environment",
    "start": "793680",
    "end": "798990"
  },
  {
    "text": "is a sandbox for these purposes so sip and major servers call recordings CDRs",
    "start": "798990",
    "end": "805769"
  },
  {
    "text": "or all voice over IP related or unified communications related data are stored",
    "start": "805769",
    "end": "811529"
  },
  {
    "text": "in the tenant services the sandbox itself but most of the time they have also shared services which are the cloud",
    "start": "811529",
    "end": "818130"
  },
  {
    "text": "services client applications management applications and etc they are shared services so if you want to attack those",
    "start": "818130",
    "end": "824670"
  },
  {
    "text": "shared services you may have an opportunity to jailbreak this cloud environment to hijack all phones of all",
    "start": "824670",
    "end": "831240"
  },
  {
    "text": "tenants I have demonstrated this in black at 2014 for Cisco hosted",
    "start": "831240",
    "end": "836639"
  },
  {
    "text": "collaboration sweet and full voice environment with some additional 0 days those days so cloud has its own problems",
    "start": "836639",
    "end": "845010"
  },
  {
    "text": "but these days we are talking about also Federation's because claude is not only solution we need to share this",
    "start": "845010",
    "end": "851850"
  },
  {
    "start": "846000",
    "end": "846000"
  },
  {
    "text": "environment with our partners or maybe just our customers or suppliers it",
    "start": "851850",
    "end": "859680"
  },
  {
    "text": "is just like an email environment our exchange can accept image from",
    "start": "859680",
    "end": "864689"
  },
  {
    "text": "everywhere and it may decide how it can deliver this to the end users or",
    "start": "864689",
    "end": "869690"
  },
  {
    "text": "employees it is same for the Federation environment there will be a network like",
    "start": "869690",
    "end": "877230"
  },
  {
    "text": "this in this Skywalker code do local servers and some local components they",
    "start": "877230",
    "end": "883980"
  },
  {
    "text": "are connected here and there is a kind of small cooperation network but it is not a bit bigger and",
    "start": "883980",
    "end": "890300"
  },
  {
    "text": "there is a partner here it is a Japanese company cannot be called so we have two",
    "start": "890300",
    "end": "896790"
  },
  {
    "text": "different companies here and they have only a partnership they cannot even",
    "start": "896790",
    "end": "902130"
  },
  {
    "text": "force anything to each other this why they need to communicate through internet connections if they called",
    "start": "902130",
    "end": "909390"
  },
  {
    "text": "themselves each other using traditional lines it will be much more expensive this why they prefer to use this",
    "start": "909390",
    "end": "916500"
  },
  {
    "text": "technique federated connections works like check the connections work",
    "start": "916500",
    "end": "922380"
  },
  {
    "text": "like just like that phone ex tries to reach for a and it sends this call",
    "start": "922380",
    "end": "929370"
  },
  {
    "text": "request to its own sip server and sip server for what this requires to the edge server H server is the last server",
    "start": "929370",
    "end": "937080"
  },
  {
    "text": "of Kaname curve but it needs to find which server is responsible to take the call just like email servers in the",
    "start": "937080",
    "end": "944910"
  },
  {
    "text": "email context it looks for an MX record in the DNS it is same for the Federated security and DNS server will have DNS",
    "start": "944910",
    "end": "953370"
  },
  {
    "text": "SRV record for the related domain in this case sky khon and it will expose",
    "start": "953370",
    "end": "958680"
  },
  {
    "text": "the H server of Skywalker curve responsible to take the calls and this",
    "start": "958680",
    "end": "966270"
  },
  {
    "text": "edge server will decide this call is a legit or not should I accept it or not",
    "start": "966270",
    "end": "972080"
  },
  {
    "text": "so H servers have really important responsibilities isolating the core",
    "start": "972080",
    "end": "978839"
  },
  {
    "text": "network from the world and deciding which one is acceptable which calls acceptable if it is acceptable and from",
    "start": "978839",
    "end": "985980"
  },
  {
    "text": "a also accepts the call they will have cheap and RTP connection including some additional video conference solutions or",
    "start": "985980",
    "end": "993450"
  },
  {
    "text": "something like that so basically phone a can call phonics or vice versa",
    "start": "993450",
    "end": "1001470"
  },
  {
    "text": "there is it there's any kind of issue here phone I also can invite phone be without",
    "start": "1001560",
    "end": "1009189"
  },
  {
    "text": "any credentials just using an email or this connection can be shared or Federation security can be established",
    "start": "1009189",
    "end": "1015819"
  },
  {
    "text": "permanently but there are all different scenarios and they depend on the vendor",
    "start": "1015819",
    "end": "1021069"
  },
  {
    "text": "and it changed vendor by vendor the challenge here is edge servers should",
    "start": "1021069",
    "end": "1027788"
  },
  {
    "text": "work just like email servers but in our implementations such as Skype for",
    "start": "1027789",
    "end": "1033280"
  },
  {
    "text": "business or Cisco other vendors they have some limitations for example you",
    "start": "1033280",
    "end": "1039220"
  },
  {
    "text": "need to define which eight servers are federated and etc so the security level is slightly different they don't work",
    "start": "1039220",
    "end": "1045159"
  },
  {
    "text": "just like emails but yeah they try to work like that this is some issues with",
    "start": "1045159",
    "end": "1051730"
  },
  {
    "text": "restrictions of course if we talk about IMS the scenario is",
    "start": "1051730",
    "end": "1057130"
  },
  {
    "start": "1055000",
    "end": "1055000"
  },
  {
    "text": "completely different we are talking about the service provider network this time and the service provider network",
    "start": "1057130",
    "end": "1062860"
  },
  {
    "text": "may have this core IMS Network IMS is IP Multimedia Subsystem and it is a",
    "start": "1062860",
    "end": "1069190"
  },
  {
    "text": "replacement of the next generation of wireless mobile networks so main service",
    "start": "1069190",
    "end": "1075549"
  },
  {
    "text": "providers use IMS in their core LT or voiceover LT environment and try to",
    "start": "1075549",
    "end": "1081909"
  },
  {
    "text": "adjust their cost and management and etc the challenge here is the environment is",
    "start": "1081909",
    "end": "1088049"
  },
  {
    "text": "is a kind of enormous beast there are too many servers responsible",
    "start": "1088049",
    "end": "1093429"
  },
  {
    "text": "to manage all these costs because it's a service provider environment cold session control function is important to",
    "start": "1093429",
    "end": "1099970"
  },
  {
    "text": "manage all the cause just like juggling the cause there are some CSUF servers for this",
    "start": "1099970",
    "end": "1105640"
  },
  {
    "text": "purpose p-cscf is a proxy server getting this request from the outside and",
    "start": "1105640",
    "end": "1111100"
  },
  {
    "text": "delivering to the responsible party ICS CF is responsible for actually it is",
    "start": "1111100",
    "end": "1117460"
  },
  {
    "text": "integrating a se SEF so it is open for queries for example which subscriber is",
    "start": "1117460",
    "end": "1123549"
  },
  {
    "text": "connected which sip server because the location distribution or",
    "start": "1123549",
    "end": "1129299"
  },
  {
    "text": "network may be much more segregated or placed two different locations or",
    "start": "1129299",
    "end": "1135130"
  },
  {
    "text": "countries this way they use also s-cscf it is localized and observers just like",
    "start": "1135130",
    "end": "1140679"
  },
  {
    "text": "in our networks so every sip network is segregated somehow for example different",
    "start": "1140679",
    "end": "1147220"
  },
  {
    "text": "cities each city has s-cscf which is a sip server in this case and that s-cscf",
    "start": "1147220",
    "end": "1155440"
  },
  {
    "text": "also updates this subscriber information to the home subscriber server HSS it",
    "start": "1155440",
    "end": "1161440"
  },
  {
    "text": "starts all the user environment in one single pool so if some for example the",
    "start": "1161440",
    "end": "1170020"
  },
  {
    "text": "user a wants to call user B it says this request to p-cscf p-cscf asks this to",
    "start": "1170020",
    "end": "1177370"
  },
  {
    "text": "ICS CF why should i forward this an ICS CF asks this to",
    "start": "1177370",
    "end": "1183179"
  },
  {
    "text": "HSS guy you have the pool please tell me Bertie's and when it gets the",
    "start": "1183179",
    "end": "1189730"
  },
  {
    "text": "information it exposes or reveals s-cscf address for example detroit server and",
    "start": "1189730",
    "end": "1195909"
  },
  {
    "text": "p-cscf works with that one this is a kind of juggling the cause the other",
    "start": "1195909",
    "end": "1202559"
  },
  {
    "text": "problem here is application server because the application server is responsible to take calls from outside",
    "start": "1202559",
    "end": "1207940"
  },
  {
    "text": "and land them in this core network but it is also a part of this call network and it is also a core network",
    "start": "1207940",
    "end": "1215940"
  },
  {
    "text": "major resource function is another one it is responsible to give dial tones or recorded messages and etc but the most",
    "start": "1215940",
    "end": "1223179"
  },
  {
    "text": "important feature here is it needs to also keep the rooms for the conference and meetings so it has its own features",
    "start": "1223179",
    "end": "1230830"
  },
  {
    "text": "and most of them based on RTP when virtual reality or LT subscribers",
    "start": "1230830",
    "end": "1237250"
  },
  {
    "text": "try to connect it will have p-cscf functions but this must be a bit",
    "start": "1237250",
    "end": "1244200"
  },
  {
    "text": "application server but we'll discuss this now but this network may have also",
    "start": "1244200",
    "end": "1249460"
  },
  {
    "text": "traditional subscribers using DSL cable networks or ambien or fiber networks so",
    "start": "1249460",
    "end": "1254620"
  },
  {
    "text": "we are talking about two different types of customers here actually maybe many of them and application servers should be",
    "start": "1254620",
    "end": "1261250"
  },
  {
    "text": "the handlers for these ones that's why first of all we need to isolate these",
    "start": "1261250",
    "end": "1266720"
  },
  {
    "text": "networks that's why we use session border controllers they are basically smart firewall working on a kind of sip",
    "start": "1266720",
    "end": "1272570"
  },
  {
    "text": "proxy filtering the sip cause sometimes p-cscf has this function",
    "start": "1272570",
    "end": "1277700"
  },
  {
    "text": "sometimes they are independent vendors and core network sorry this core network",
    "start": "1277700",
    "end": "1284330"
  },
  {
    "text": "should be isolated like that and it will transfer the cause an application server needs host",
    "start": "1284330",
    "end": "1291760"
  },
  {
    "text": "home subscriber services HSS to find the users and update their features on HSS",
    "start": "1291760",
    "end": "1298180"
  },
  {
    "text": "because the subscribers the mobile subscribers also",
    "start": "1298180",
    "end": "1303220"
  },
  {
    "text": "belong to the same service provider so they need to be in the same HSS",
    "start": "1303220",
    "end": "1308440"
  },
  {
    "text": "but this also says that there's a design mistake if you are experienced with this IMS there are a few design mistakes here",
    "start": "1308440",
    "end": "1315200"
  },
  {
    "text": "actually they are still dangerous for example application server should be isolated and each different networks",
    "start": "1315200",
    "end": "1321170"
  },
  {
    "text": "should have their own HSS as well if they are isolating two things so I didn't talk about the clients but",
    "start": "1321170",
    "end": "1328640"
  },
  {
    "start": "1327000",
    "end": "1327000"
  },
  {
    "text": "clients under attack because interventricular issues are really dangerous here",
    "start": "1328640",
    "end": "1334180"
  },
  {
    "text": "sometimes service providers use third-party software sometimes they use vendor software some devices are",
    "start": "1334180",
    "end": "1340780"
  },
  {
    "text": "compliant but independent so they can enforce security levels this way",
    "start": "1340780",
    "end": "1346280"
  },
  {
    "text": "insufficient client management comes with additional problems missing security updates vulnerable systems",
    "start": "1346280",
    "end": "1353830"
  },
  {
    "text": "missing security features for example TLS is not supported this is an issue or just using no",
    "start": "1353830",
    "end": "1361970"
  },
  {
    "text": "filtering for the c-pen STP calls so we can use all of them to deploy our attack",
    "start": "1361970",
    "end": "1367460"
  },
  {
    "text": "using the centralized the environment we can call all clients using one single call type for example using a conference",
    "start": "1367460",
    "end": "1375560"
  },
  {
    "text": "call for all numbers start with 100 - let's say 5 million and it will try one",
    "start": "1375560",
    "end": "1383870"
  },
  {
    "text": "by one alkalis and try to call them for the meeting this is also possible so if",
    "start": "1383870",
    "end": "1389930"
  },
  {
    "text": "our attack is successful all these clients will get a kind of successful attack and we will get a sort of shell I",
    "start": "1389930",
    "end": "1396680"
  },
  {
    "text": "will demonstrate this by the way attack services to clients",
    "start": "1396680",
    "end": "1402160"
  },
  {
    "start": "1398000",
    "end": "1398000"
  },
  {
    "text": "there are a few attack surfaces here we already discussed some of them but CPA",
    "start": "1402160",
    "end": "1408080"
  },
  {
    "text": "STP content is the most important one and rich messaging is another one because rich messaging may also include",
    "start": "1408080",
    "end": "1414860"
  },
  {
    "text": "some additional formats and different mime types including RTF HTML or JavaScript or much more modified files",
    "start": "1414860",
    "end": "1421400"
  },
  {
    "text": "or corrupted files cbs-tv content is another one because we can play with the components for example if we know that a",
    "start": "1421400",
    "end": "1428690"
  },
  {
    "text": "simple audio codec library is vulnerable we can only offer that librarian debt collection if the client accepts client",
    "start": "1428690",
    "end": "1435710"
  },
  {
    "text": "needs to use that library and basically our attack will be successful Unified",
    "start": "1435710",
    "end": "1441380"
  },
  {
    "text": "Messaging may come with additional features for us for example file transfers or sharing a presentation so",
    "start": "1441380",
    "end": "1448790"
  },
  {
    "text": "we may have some additional attack surfaces here communication subsystem may have",
    "start": "1448790",
    "end": "1454550"
  },
  {
    "text": "additional ones as well for example : see patters and sometimes rarely use protocols",
    "start": "1454550",
    "end": "1460750"
  },
  {
    "start": "1460000",
    "end": "1460000"
  },
  {
    "text": "test approach how can we use this how can we test this",
    "start": "1460750",
    "end": "1466310"
  },
  {
    "text": "this is not complicated actually first of all you need to find the first contact point sometimes it is a kind of",
    "start": "1466310",
    "end": "1473210"
  },
  {
    "text": "letter invitation letter for a meeting or sometimes just open PBX server and etc if you find this combine all the new",
    "start": "1473210",
    "end": "1479810"
  },
  {
    "text": "techniques for that and use unified communication techniques for your malicious activities again for example",
    "start": "1479810",
    "end": "1486590"
  },
  {
    "text": "ms RTA SPF basically definitions of RTP for Microsoft so you can use even RDP",
    "start": "1486590",
    "end": "1492680"
  },
  {
    "text": "Remote Desktop Protocol through your RTP sessions so why not why you don't use it",
    "start": "1492680",
    "end": "1498770"
  },
  {
    "text": "please try you to peel and plan this attack find the first contact point and",
    "start": "1498770",
    "end": "1504490"
  },
  {
    "text": "work on your attack surfaces if you can find unified communications attacks",
    "start": "1504490",
    "end": "1510410"
  },
  {
    "text": "maybe you can distribute your malware easily and then hide your activities and go back the first step okay",
    "start": "1510410",
    "end": "1519580"
  },
  {
    "start": "1519000",
    "end": "1519000"
  },
  {
    "text": "we need to improve our security testing services but I have skipped some slides",
    "start": "1519580",
    "end": "1524900"
  },
  {
    "text": "from here because my topic is slightly a wide but I have limited that's why those",
    "start": "1524900",
    "end": "1532210"
  },
  {
    "text": "slides available in the final version to be uploaded on the blackhat webpage but I will summarize them here red teaming",
    "start": "1532210",
    "end": "1538690"
  },
  {
    "text": "exercises it will have IP forms it will have some additional conference room a",
    "start": "1538690",
    "end": "1546399"
  },
  {
    "text": "Medicaid phase if so why we do not modify them why we do not intercept the network and why we do not get persistent",
    "start": "1546399",
    "end": "1553630"
  },
  {
    "text": "access it is same for human factor fantastic sending email may need to",
    "start": "1553630",
    "end": "1558909"
  },
  {
    "text": "bypass almost all security measures such as the power filters and etc for a call it's not like that only security",
    "start": "1558909",
    "end": "1566049"
  },
  {
    "text": "measures for VoIP systems available on the our government organizations if you",
    "start": "1566049",
    "end": "1571809"
  },
  {
    "text": "want to call the emergency number you may have a lot of security measures but for a company for a larger organization",
    "start": "1571809",
    "end": "1577419"
  },
  {
    "text": "they have almost none infrastructure analysis is another one",
    "start": "1577419",
    "end": "1583299"
  },
  {
    "text": "because service provider networks may need additional attention for this work network because the segregation may",
    "start": "1583299",
    "end": "1589509"
  },
  {
    "text": "allow us to create persistent toll fraud for us of course the application",
    "start": "1589509",
    "end": "1595000"
  },
  {
    "text": "security assessment is required for almost all client applications and server applications",
    "start": "1595000",
    "end": "1601440"
  },
  {
    "start": "1601000",
    "end": "1601000"
  },
  {
    "text": "but I need to highlight two of them all these services the first one is call center call centers",
    "start": "1601440",
    "end": "1608429"
  },
  {
    "text": "almost all of them ignore the encryption used in the VoIP session so RTP needs a",
    "start": "1608429",
    "end": "1616629"
  },
  {
    "text": "strong encryption but they may use let's say s des I'm sharing the symmetrical",
    "start": "1616629",
    "end": "1622389"
  },
  {
    "text": "key through unencrypted sip session so this will expose the RTP session maybe",
    "start": "1622389",
    "end": "1627460"
  },
  {
    "text": "credit card information in the RTP event so it may be really visible we don't need any decoder for the audio it will",
    "start": "1627460",
    "end": "1634240"
  },
  {
    "text": "be visible there or ideal connections they may expose some additional stuff or they may be vulnerable for TLS attacks",
    "start": "1634240",
    "end": "1640720"
  },
  {
    "text": "most of them important for the PCI DSS regulations but again they are just",
    "start": "1640720",
    "end": "1647110"
  },
  {
    "text": "blind spot it is same for almost all Privacy Act and other obligations as",
    "start": "1647110",
    "end": "1652419"
  },
  {
    "text": "well and that's why we have some issues but in a messy environment we have",
    "start": "1652419",
    "end": "1658659"
  },
  {
    "start": "1654000",
    "end": "1654000"
  },
  {
    "text": "additional issues I am a the environment may have multi vendors some of them for",
    "start": "1658659",
    "end": "1664029"
  },
  {
    "text": "security measure for example a species some of them may be the other ones for example just deploying application",
    "start": "1664029",
    "end": "1670120"
  },
  {
    "text": "servers network and service segregation is important they are not just like working in a kind of bucket or a kind of",
    "start": "1670120",
    "end": "1677230"
  },
  {
    "text": "trusted network we should think about the core network structure now because it will change core network yes it will",
    "start": "1677230",
    "end": "1684640"
  },
  {
    "text": "have different servers but they are not trusted they are coming from different servers different vendors so they may",
    "start": "1684640",
    "end": "1690010"
  },
  {
    "text": "not be compliant you cannot enforce all the security and your security must be let's say sacrificed",
    "start": "1690010",
    "end": "1696390"
  },
  {
    "text": "sometimes you cannot use TLS between the parties and your network will be unencrypted but also open for some",
    "start": "1696390",
    "end": "1703780"
  },
  {
    "text": "additional clients also see headers they are also important because they also carry the caller ID",
    "start": "1703780",
    "end": "1711070"
  },
  {
    "text": "sometimes billing sometimes they just add routing features for example you can",
    "start": "1711070",
    "end": "1716800"
  },
  {
    "text": "pretend that I am a PSA p-cscf a proxy in this CSE F environment would you",
    "start": "1716800",
    "end": "1722140"
  },
  {
    "text": "please give me what I can initiate a free code and I see ACF will redirect",
    "start": "1722140",
    "end": "1727990"
  },
  {
    "text": "you some trusted s-cscf and you can initiate your call just because of a header so you need to add this header",
    "start": "1727990",
    "end": "1735640"
  },
  {
    "text": "and encryption design as I said it is broken but it is also broken for some",
    "start": "1735640",
    "end": "1740680"
  },
  {
    "text": "rarely used protocols for exam for example MSRP requires encryption MSRP is",
    "start": "1740680",
    "end": "1745840"
  },
  {
    "text": "a protocol because for SMS in this service provider environment and by default unencrypted it needs to be",
    "start": "1745840",
    "end": "1752920"
  },
  {
    "text": "forced for the infrastructure so I talked a lot I talked about almost",
    "start": "1752920",
    "end": "1760330"
  },
  {
    "start": "1756000",
    "end": "1756000"
  },
  {
    "text": "everything so the question is how can you test it how can you provide a kind of practical attack surface here vPro is",
    "start": "1760330",
    "end": "1768220"
  },
  {
    "text": "an answer because I'm developing vPro since 2011 an active development and it",
    "start": "1768220",
    "end": "1776170"
  },
  {
    "text": "with a DEFCON obligate come first and etc so it is in the version for now it",
    "start": "1776170",
    "end": "1781300"
  },
  {
    "text": "is available in the webpage vPro comm it has models working on Metasploit",
    "start": "1781300",
    "end": "1786760"
  },
  {
    "text": "framework it is not a kind of independent tool so you can use it comfortably just like a Metasploit model",
    "start": "1786760",
    "end": "1793750"
  },
  {
    "text": "it has my more than 20 models dedicated for class service exploitation for",
    "start": "1793750",
    "end": "1799090"
  },
  {
    "text": "redirections pretending just like a skinny client or a skinny phone impersonating all the calls adding some",
    "start": "1799090",
    "end": "1806019"
  },
  {
    "text": "custom headers to your calls and tasting everything I'm not talking about a kind of traditional testers with some",
    "start": "1806019",
    "end": "1813429"
  },
  {
    "text": "limited options it is very flexible and it does everything almost all so I",
    "start": "1813429",
    "end": "1818590"
  },
  {
    "text": "demonstrated almost everything using this proof of concept modules by the way they're proof of concept modules do not",
    "start": "1818590",
    "end": "1824380"
  },
  {
    "text": "expect the kind of product quality it has still some features and the source code is very dodgy you may get blind if",
    "start": "1824380",
    "end": "1832899"
  },
  {
    "text": "you look at the source code but don't look at it just use it trust me and the other one is B proxy it",
    "start": "1832899",
    "end": "1839679"
  },
  {
    "text": "is required for the MIT M analysis because MIT M is also required we cannot support all features of the clients file",
    "start": "1839679",
    "end": "1846039"
  },
  {
    "text": "transfer features sharing screens and etc they are not possible I cannot implement all of them for my tests",
    "start": "1846039",
    "end": "1852070"
  },
  {
    "text": "that's why I'm using MIT M proxy which is highly customized for this void clients so how can we use these tools I",
    "start": "1852070",
    "end": "1860860"
  },
  {
    "start": "1859000",
    "end": "1859000"
  },
  {
    "text": "have used this for cloud communications I had manipulated the skin calls or IP",
    "start": "1860860",
    "end": "1867429"
  },
  {
    "text": "phones in the cloud environment using XML services of Cisco ICS or I have used",
    "start": "1867429",
    "end": "1873070"
  },
  {
    "text": "this for some voicemail attacks injecting some sip address and etc so it is highly powerful it is first it has a",
    "start": "1873070",
    "end": "1883049"
  },
  {
    "text": "it is focused on signaling services in the first place but it is also expanded now",
    "start": "1883049",
    "end": "1889799"
  },
  {
    "text": "first of all signaling services does not cover do not cover only sip it also",
    "start": "1889799",
    "end": "1896320"
  },
  {
    "text": "covers skin as well so it has modules for almost all of them and the libraries are very flexible so you can use your",
    "start": "1896320",
    "end": "1902350"
  },
  {
    "text": "customized script for example a register is a function registered to the server and initiate invite calls starting from",
    "start": "1902350",
    "end": "1909360"
  },
  {
    "text": "100 to let's say 5 million and it will send the invite request regardless of the server response or not as a kind of",
    "start": "1909360",
    "end": "1916389"
  },
  {
    "text": "dos attack or a kind of spamming it is same for messaging as well you can deploy your messages just like that",
    "start": "1916389",
    "end": "1922289"
  },
  {
    "text": "also the proxy can be used to pretend just like a malicious client and I will",
    "start": "1922289",
    "end": "1927639"
  },
  {
    "text": "use it as well how can we use these two most of large organizations use cloud",
    "start": "1927639",
    "end": "1934360"
  },
  {
    "start": "1929000",
    "end": "1929000"
  },
  {
    "text": "services and some of public service is available involved just like Cisco WebEx Skype for business office 365 or goto",
    "start": "1934360",
    "end": "1941140"
  },
  {
    "text": "meeting so what I did in the first place is how can I test all of them first of",
    "start": "1941140",
    "end": "1946150"
  },
  {
    "text": "all it is not possible you cannot develop a client for all of them I can only support some generic SIP exemptions",
    "start": "1946150",
    "end": "1953160"
  },
  {
    "text": "but Skype for business require some additional stuff and we will get there but first of all people itself can be",
    "start": "1953160",
    "end": "1959770"
  },
  {
    "text": "used as a client so I can send my request to the other parties such as",
    "start": "1959770",
    "end": "1966550"
  },
  {
    "text": "Colley's and destinations so this request is a signaling request looking",
    "start": "1966550",
    "end": "1971770"
  },
  {
    "text": "for a call looking for a message this request may have customized STP",
    "start": "1971770",
    "end": "1977530"
  },
  {
    "text": "description customized see patters or customized protocols such as XMPP is a",
    "start": "1977530",
    "end": "1982570"
  },
  {
    "text": "kind of protocol for used for signaling as well or sometimes messaging so it is",
    "start": "1982570",
    "end": "1988270"
  },
  {
    "text": "also good for us XMPP is pretty good but I have no XMPP support rather than this",
    "start": "1988270",
    "end": "1993460"
  },
  {
    "text": "I have a better one MIT and proxy which is also powerful for search and replace and etc so you can drive also the XMPP",
    "start": "1993460",
    "end": "2000690"
  },
  {
    "text": "client such as cisco jabber anyway I can send these requests using reply and I",
    "start": "2000690",
    "end": "2005820"
  },
  {
    "text": "can manipulate the content I don't need to send a text message I can send customized mime types for example",
    "start": "2005820",
    "end": "2011040"
  },
  {
    "text": "sending an image sending an HTML file with some malicious script JavaScript",
    "start": "2011040",
    "end": "2018090"
  },
  {
    "text": "for example when it is forwarded to the clients clients need to process this data and",
    "start": "2018090",
    "end": "2025830"
  },
  {
    "text": "for what the request the important thing is the form will be ringing right why am",
    "start": "2025830",
    "end": "2031860"
  },
  {
    "text": "bad the decision is based on this STP",
    "start": "2031860",
    "end": "2037350"
  },
  {
    "text": "content that's why the content must be parsed by clients before ringing so I",
    "start": "2037350",
    "end": "2043740"
  },
  {
    "text": "target that link sequence before ringing before parsing as I try to smash the",
    "start": "2043740",
    "end": "2049860"
  },
  {
    "text": "client so without any user interaction I may get shell or a kind of course I",
    "start": "2049860",
    "end": "2054990"
  },
  {
    "text": "scripting or script execution whatever so no user interaction is required here",
    "start": "2054990",
    "end": "2061580"
  },
  {
    "text": "so I have a kind of simple exploit here for the MSRP for the IMSA environment",
    "start": "2061580",
    "end": "2066780"
  },
  {
    "start": "2062000",
    "end": "2062000"
  },
  {
    "text": "the target is an open-source software available in the wild it is an old",
    "start": "2066780",
    "end": "2072419"
  },
  {
    "text": "legacy software but fairly used in the IMS testing environments I saw it in three different vendors and two service",
    "start": "2072419",
    "end": "2079320"
  },
  {
    "text": "providers actually I surprised because it's a kind of",
    "start": "2079320",
    "end": "2085550"
  },
  {
    "text": "not good tool basically but the challenge is there is no other tools supporting MSRP and etc so what I did is",
    "start": "2085550",
    "end": "2093080"
  },
  {
    "text": "sending your customized sip request with an SDP content indicates that I want to",
    "start": "2093080",
    "end": "2098130"
  },
  {
    "text": "use MSRP and I will try to transfer a file to you and file has a longer name",
    "start": "2098130",
    "end": "2103760"
  },
  {
    "text": "and it is not possible to create that file in our demo I am using vPro and",
    "start": "2103760",
    "end": "2111290"
  },
  {
    "text": "in the Metasploit of course and from is my front field which is the Kali color",
    "start": "2111290",
    "end": "2120510"
  },
  {
    "text": "identity in this case I am also setting 2 which is the Kali right side the",
    "start": "2120510",
    "end": "2125700"
  },
  {
    "text": "victim and the server IP address is the remote host so I have no information of",
    "start": "2125700",
    "end": "2131660"
  },
  {
    "text": "the client except the 700 or so when I send this request",
    "start": "2131660",
    "end": "2139250"
  },
  {
    "text": "client crush and when we look at that request we will see the request has a",
    "start": "2139250",
    "end": "2147869"
  },
  {
    "text": "bogus file name in the MSRP file transfer request it and the server",
    "start": "2147869",
    "end": "2152910"
  },
  {
    "text": "cannot identify MSRP supported by the other party or not or file name is long or not or it is a proper HTP request or",
    "start": "2152910",
    "end": "2160740"
  },
  {
    "text": "not so it is also possible through almost every way an MSRP is fairly using",
    "start": "2160740",
    "end": "2165990"
  },
  {
    "text": "SMS messaging and androids and iOS platforms also",
    "start": "2165990",
    "end": "2171440"
  },
  {
    "start": "2166000",
    "end": "2166000"
  },
  {
    "text": "have these features for LTE on both a virtual reality environments so SMS",
    "start": "2171440",
    "end": "2177089"
  },
  {
    "text": "standing may be a problem like that as well well I'm still digging for it there is no vulnerable to like that but if we",
    "start": "2177089",
    "end": "2183930"
  },
  {
    "text": "want to use unified messaging the attacks change because unified messaging may have different file formats for",
    "start": "2183930",
    "end": "2189240"
  },
  {
    "text": "example we can change the message type and message content we can add some additional stuff for example pictures or",
    "start": "2189240",
    "end": "2195210"
  },
  {
    "text": "links and HTML content so it is possible this may allow us to execute someone",
    "start": "2195210",
    "end": "2200680"
  },
  {
    "text": "tries code or skip or something like that or we can use some additional protocols such as MSRP or XMPP or sip",
    "start": "2200680",
    "end": "2207790"
  },
  {
    "text": "message they are also used for messaging so we can combine all these attacks to",
    "start": "2207790",
    "end": "2213550"
  },
  {
    "text": "make it a practical attack if you want to use the original client to attack the target server or the clients we need to",
    "start": "2213550",
    "end": "2221530"
  },
  {
    "start": "2214000",
    "end": "2214000"
  },
  {
    "text": "configure our client in this case I have a attacker client which is official",
    "start": "2221530",
    "end": "2227680"
  },
  {
    "text": "traditional Skype for business and I placed my V proxy is an MIT on proxy",
    "start": "2227680",
    "end": "2232960"
  },
  {
    "text": "there but I need to adjust my client a creating a TLS certificate clone from",
    "start": "2232960",
    "end": "2238119"
  },
  {
    "text": "the remote server to pretend like that I am that one also putting my proxy settings on my client also a disabling",
    "start": "2238119",
    "end": "2245140"
  },
  {
    "text": "encryption using V proxy the proxy disables encryption by the fate sorry not encryption compression",
    "start": "2245140",
    "end": "2250589"
  },
  {
    "text": "is disabled by default in this the proxy version and I will have a kind of online",
    "start": "2250589",
    "end": "2257260"
  },
  {
    "text": "console the requests will be coming or passing through but meanwhile I want to",
    "start": "2257260",
    "end": "2262660"
  },
  {
    "text": "change them this why I have a kind of interactive console here so interactive console may indicate that please use",
    "start": "2262660",
    "end": "2269800"
  },
  {
    "text": "invite with some malicious content to hijack the clients or authorize some",
    "start": "2269800",
    "end": "2275140"
  },
  {
    "text": "calls or something like that so I can eat anything for example a customized see better the I can use alleged client to call",
    "start": "2275140",
    "end": "2282640"
  },
  {
    "text": "voicemail with a customized sip header to indicate that I am the original voicemail opener please open me",
    "start": "2282640",
    "end": "2289140"
  },
  {
    "text": "so this request will be forwarded to the server and the server will forward this",
    "start": "2289140",
    "end": "2294520"
  },
  {
    "text": "to the clients this is the expected scenario but we can use this scenario to attack the server itself or the class",
    "start": "2294520",
    "end": "2300970"
  },
  {
    "text": "the same attack serve the same attack can be used for both in this example",
    "start": "2300970",
    "end": "2306190"
  },
  {
    "text": "left side has a client and official client and might be proxy the proxy is",
    "start": "2306190",
    "end": "2311950"
  },
  {
    "text": "running with some magic words those magic words are attack templates defining the proxy as well so we can use",
    "start": "2311950",
    "end": "2319240"
  },
  {
    "text": "these magic words in the messaging right side right top is the client and bottom is the Skype for business server what I",
    "start": "2319240",
    "end": "2326710"
  },
  {
    "text": "do is defining a rule using the online console in if console and",
    "start": "2326710",
    "end": "2333690"
  },
  {
    "text": "putting RTV RTF file as a kind of message content and I'm sending this",
    "start": "2333690",
    "end": "2340440"
  },
  {
    "text": "after a hi-hi is the initial message so when I",
    "start": "2340440",
    "end": "2346510"
  },
  {
    "text": "sent custom RTF it's a test one two three this is the lock screen of the proxy I'm also logging as we can see",
    "start": "2346510",
    "end": "2354040"
  },
  {
    "text": "this is an RTF container it is legit but it is also forwarded to the client so I can use an RTF attack here right so what",
    "start": "2354040",
    "end": "2361780"
  },
  {
    "text": "I did is sending an RTF file with an image file but it is very very big so it",
    "start": "2361780",
    "end": "2368320"
  },
  {
    "text": "is more than if you make but it is not good for Skype for business this why I",
    "start": "2368320",
    "end": "2374110"
  },
  {
    "text": "will use another rule but this time I will use a customized RTF",
    "start": "2374110",
    "end": "2380220"
  },
  {
    "text": "I'm a bit delayed anyway this context will be an RTF file",
    "start": "2380220",
    "end": "2389440"
  },
  {
    "text": "with a picture but the request will be very very big and will be unfortunately",
    "start": "2389440",
    "end": "2396730"
  },
  {
    "text": "refused by the server because sip server will say that this is a very very long",
    "start": "2396730",
    "end": "2402870"
  },
  {
    "text": "request and it is not accepted but this message will be coming from the ship",
    "start": "2402870",
    "end": "2409030"
  },
  {
    "text": "stack of Skype for business not by the demon not by the filters and",
    "start": "2409030",
    "end": "2414100"
  },
  {
    "text": "not other stuff so we have a sort of needle to dig more to the sieve stack as",
    "start": "2414100",
    "end": "2420580"
  },
  {
    "text": "we can see we sent the file and we get that request entity is too long but we",
    "start": "2420580",
    "end": "2427360"
  },
  {
    "text": "can use other options as I refer to the RTF file if RTF file is transferred and",
    "start": "2427360",
    "end": "2432910"
  },
  {
    "text": "forwarded to the client I can send the malicious RTF file right I've found a",
    "start": "2432910",
    "end": "2438880"
  },
  {
    "text": "vulnerability a published in two years ago yeah yeah two years ago there was a",
    "start": "2438880",
    "end": "2445210"
  },
  {
    "text": "vulnerability in office 2010 and RTF exploit in the Metasploit as well file type exploits I generated in our deep",
    "start": "2445210",
    "end": "2451840"
  },
  {
    "text": "file I was expecting everything is fixed and patched that was true but",
    "start": "2451840",
    "end": "2457800"
  },
  {
    "text": "the challenges the header of RTF file",
    "start": "2457800",
    "end": "2463240"
  },
  {
    "text": "actually artifice was bogus corrupted so the Skype for",
    "start": "2463240",
    "end": "2469000"
  },
  {
    "text": "business should process this RTF forward is to the client this was the expected",
    "start": "2469000",
    "end": "2474400"
  },
  {
    "text": "behavior but the challenge is it didn't it failed somehow and",
    "start": "2474400",
    "end": "2481770"
  },
  {
    "text": "what we are saying sorry what we are seeing here is the log and I will send",
    "start": "2481770",
    "end": "2488470"
  },
  {
    "text": "this request now this is the RTF file it's not so big so I pass the SIP restrictions so it is in",
    "start": "2488470",
    "end": "2496630"
  },
  {
    "text": "somewhere else that somewhere else is I am filter running in the Skype for",
    "start": "2496630",
    "end": "2502720"
  },
  {
    "text": "business environment so Skype or business environment is processing the files extract the sensitive data or",
    "start": "2502720",
    "end": "2508360"
  },
  {
    "text": "message content to forward to the client but it is not expected because there was",
    "start": "2508360",
    "end": "2514570"
  },
  {
    "text": "no filtering enabled in the server as we can see there is a a kind of stack empty message here this is not a vulnerability",
    "start": "2514570",
    "end": "2522180"
  },
  {
    "text": "not exploitable either but this is also a bug and shows that I am filter DLL he",
    "start": "2522180",
    "end": "2528100"
  },
  {
    "text": "is there to parse the mime types different mime types and it fails because it also processes this just like",
    "start": "2528100",
    "end": "2534250"
  },
  {
    "text": "the client this why every file type box including Microsoft Word or Excel and",
    "start": "2534250",
    "end": "2539860"
  },
  {
    "text": "etc every Advisory has also Skype for business paths or Microsoft Lync pass",
    "start": "2539860",
    "end": "2546130"
  },
  {
    "text": "that is the reason because it is parsed and processed by the server as well and that server is also used for Federation",
    "start": "2546130",
    "end": "2552070"
  },
  {
    "start": "2552000",
    "end": "2552000"
  },
  {
    "text": "servers such as office 365 so we have a practical attack here with some",
    "start": "2552070",
    "end": "2558550"
  },
  {
    "text": "additional script execution attacking Skype for business is tricky so I need to implement everything but we pro had",
    "start": "2558550",
    "end": "2566200"
  },
  {
    "text": "no HDL ax and no ntlm support yet because it had some limitations so I'm",
    "start": "2566200",
    "end": "2571780"
  },
  {
    "text": "still working on it a because because the until an authentication also includes some significant signature",
    "start": "2571780",
    "end": "2577030"
  },
  {
    "text": "fields and etc so I could not implement it yet but it will be coming soon on the",
    "start": "2577030",
    "end": "2582220"
  },
  {
    "text": "other hand I can use the official client to manipulate the sip invite and message content and STP contents so if I use",
    "start": "2582220",
    "end": "2588700"
  },
  {
    "text": "this call request if it is modified my OB proxy I can get a code execution script execution that attack was zero",
    "start": "2588700",
    "end": "2597099"
  },
  {
    "text": "day on blackhat Europe 2015 just a few months ago and it was valid on office",
    "start": "2597099",
    "end": "2603069"
  },
  {
    "text": "365 as well and including Federation security so I didn't need any authentication or I can register myself",
    "start": "2603069",
    "end": "2610479"
  },
  {
    "text": "as a kind of user there it a kind of anonymous user and after that I can started attack and I could get all the",
    "start": "2610479",
    "end": "2617529"
  },
  {
    "text": "clients executed my undereyes script so that was expected and microsoft fixed this bug",
    "start": "2617529",
    "end": "2623619"
  },
  {
    "text": "using MS fifteen and one two three so how this word it is and URL filter as",
    "start": "2623619",
    "end": "2633729"
  },
  {
    "text": "well but I've multiplied URL using script basically a basic useless",
    "start": "2633729",
    "end": "2639989"
  },
  {
    "text": "manipulation I love me to bypass the URL filter so I use this moreover I needed a",
    "start": "2639989",
    "end": "2648269"
  },
  {
    "text": "essential basic version of the JavaScript which is the document location here and window location so I",
    "start": "2648269",
    "end": "2655509"
  },
  {
    "text": "use this so the thing is it is valid in the messages right what if I use this in",
    "start": "2655509",
    "end": "2660819"
  },
  {
    "text": "the SIP header it is possible because all invite requests have subject line",
    "start": "2660819",
    "end": "2666390"
  },
  {
    "text": "called MS IR format and at MS I am format is a base64 value make your HTML",
    "start": "2666390",
    "end": "2674680"
  },
  {
    "text": "content so what I did is I put my javascript in an HTML I put HTML to",
    "start": "2674680",
    "end": "2681749"
  },
  {
    "text": "base64 and I put that base64 to the sea patters so it can be forwarded between",
    "start": "2681749",
    "end": "2687130"
  },
  {
    "text": "proxies regard to subscribe for business or not until it hits the correct client it will get addressed script execution",
    "start": "2687130",
    "end": "2694959"
  },
  {
    "text": "so how can I do this and what is the effect I can attack through proxy I",
    "start": "2694959",
    "end": "2700749"
  },
  {
    "text": "can't attack through the class services what I need today is adding a custom chip better I can do this vPro or B",
    "start": "2700749",
    "end": "2707380"
  },
  {
    "text": "proxy so basically if I send my request to see PBX server it will forward this",
    "start": "2707380",
    "end": "2713109"
  },
  {
    "text": "to the Skype for business regardless of I have no access to the Skype for business or the class so the class will",
    "start": "2713109",
    "end": "2721180"
  },
  {
    "text": "receive this message the meeting request and the code will be executed I will demonstrate this just like in a",
    "start": "2721180",
    "end": "2727690"
  },
  {
    "text": "cloud solution so I will have a kind of attacking collide and video",
    "start": "2727690",
    "end": "2732960"
  },
  {
    "text": "sorry a vPro what happened okay I will repeat again",
    "start": "2732960",
    "end": "2738100"
  },
  {
    "text": "the left side my attacking client and the other one is my V Pro and the right",
    "start": "2738100",
    "end": "2744760"
  },
  {
    "text": "side has two different clients what is happening",
    "start": "2744760",
    "end": "2750360"
  },
  {
    "text": "av yes I recovered again and",
    "start": "2751260",
    "end": "2757080"
  },
  {
    "text": "okay I will play this demo and done what I can do is sending my requests",
    "start": "2757080",
    "end": "2764170"
  },
  {
    "text": "through the proxy and hijacking to different clients clients are right side",
    "start": "2764170",
    "end": "2769990"
  },
  {
    "text": "ad victims waiting for any call in this case I am sitting my proxy and I will",
    "start": "2769990",
    "end": "2776980"
  },
  {
    "text": "use only the magic verse in the first place and I will change things after that first of all the clients will be",
    "start": "2776980",
    "end": "2782860"
  },
  {
    "text": "connected through my V proxy so I'm solving all these setup from scratch so",
    "start": "2782860",
    "end": "2788050"
  },
  {
    "text": "you can replicate this action because the tool is available in V procom so we",
    "start": "2788050",
    "end": "2794200"
  },
  {
    "text": "what we need to do is setting our service setting our server interception and",
    "start": "2794200",
    "end": "2799500"
  },
  {
    "text": "manipulating things in the man in the middle so it supports attacking URL as",
    "start": "2799500",
    "end": "2805960"
  },
  {
    "text": "well and this attack URL will be injected to the cause those are the magic words you can use and I am",
    "start": "2805960",
    "end": "2811750"
  },
  {
    "text": "combining this attack with an old Java attack so what I need to do is inviting all",
    "start": "2811750",
    "end": "2819490"
  },
  {
    "text": "these clients to em I think I can get the client list because I am connected to the network just like",
    "start": "2819490",
    "end": "2825880"
  },
  {
    "text": "office 365 or Federation's or I can get a kind of meeting request if I will be joining the meeting my message will be",
    "start": "2825880",
    "end": "2832420"
  },
  {
    "text": "also delivered to the client I'm inviting HEC me to and hit me three and I sent a",
    "start": "2832420",
    "end": "2838630"
  },
  {
    "text": "message and it is waiting we are waiting because the message will be auto accepted unless",
    "start": "2838630",
    "end": "2844720"
  },
  {
    "text": "the client refuses it this is a kind of Skype for business feature the call will",
    "start": "2844720",
    "end": "2850780"
  },
  {
    "text": "be accepted automatically if you do not refuse it when the call will be accepted",
    "start": "2850780",
    "end": "2858000"
  },
  {
    "text": "the code will be executed and VHS but the challenges as you can see Vinita",
    "start": "2858000",
    "end": "2865029"
  },
  {
    "text": "bait for it maybe we should not wait for it we can do something else this was a",
    "start": "2865029",
    "end": "2870549"
  },
  {
    "text": "kind of a meeting injection but we can use some other attacks for example fishing through this content fishing",
    "start": "2870549",
    "end": "2877989"
  },
  {
    "text": "needs user interaction will not work just like the previous one so what I am",
    "start": "2877989",
    "end": "2883089"
  },
  {
    "text": "doing is saying hi I am in while I am standing fix Skype update this is another magic word defined in the bit",
    "start": "2883089",
    "end": "2888880"
  },
  {
    "text": "proxy so it will send updated Microsoft Skype for business servers detected please click that link you can deploy",
    "start": "2888880",
    "end": "2895630"
  },
  {
    "text": "this message everywhere so it is possible normally Skype for business",
    "start": "2895630",
    "end": "2900640"
  },
  {
    "text": "should not allow any links and customized messages like that and the last one and PBX bypass slack see patter injection",
    "start": "2900640",
    "end": "2909489"
  },
  {
    "text": "what we need to do is click on sole access so I am defining this rule on the",
    "start": "2909489",
    "end": "2914799"
  },
  {
    "text": "fly connecting to my proxy back and using the magic vri proxy which enables the",
    "start": "2914799",
    "end": "2921759"
  },
  {
    "text": "console and adding a rule invite subject must be replaced with this content",
    "start": "2921759",
    "end": "2928619"
  },
  {
    "text": "so it will do its magic for base64 and obfuscation and etc when we set this as",
    "start": "2928619",
    "end": "2935410"
  },
  {
    "text": "you can see no user interaction no waiting it will open the browser and we",
    "start": "2935410",
    "end": "2941140"
  },
  {
    "text": "will get script execution this attack can be combined with some additional",
    "start": "2941140",
    "end": "2946450"
  },
  {
    "text": "attacks as well but basically we need to secure the clients as well as",
    "start": "2946450",
    "end": "2953109"
  },
  {
    "start": "2948000",
    "end": "2948000"
  },
  {
    "text": "the server because I have used the server attack and client attack using the same architecture and same reach",
    "start": "2953109",
    "end": "2959650"
  },
  {
    "text": "messaging so using the same technique we can target the server which is a cloud",
    "start": "2959650",
    "end": "2964779"
  },
  {
    "text": "service in this case or the client the proxy is available for all vendors this",
    "start": "2964779",
    "end": "2970299"
  },
  {
    "text": "is this bug for example the code execution bug script execution bug sorry",
    "start": "2970299",
    "end": "2975539"
  },
  {
    "text": "is fixed by Microsoft but the other box they are still out there and I'm still",
    "start": "2975539",
    "end": "2981400"
  },
  {
    "text": "working on them probably I will work with Microsoft to solve them because they need some air filter slice so yeah",
    "start": "2981400",
    "end": "2989460"
  },
  {
    "text": "so this may need some filter work so I will release them soon",
    "start": "2989460",
    "end": "2995380"
  },
  {
    "text": "but on the other hand you can use B proxy for other vendors it also supports this co-driver or some other lines or",
    "start": "2995380",
    "end": "3001500"
  },
  {
    "text": "other ticket lines so you can put the proxy and you can change things on the fly any web tech client will work so you",
    "start": "3001500",
    "end": "3008340"
  },
  {
    "text": "need to secure your design to protect your network and as well as clients of course it can force your security using",
    "start": "3008340",
    "end": "3015960"
  },
  {
    "text": "a species they will filter everything for you it is a servers in this Skype",
    "start": "3015960",
    "end": "3021900"
  },
  {
    "text": "for business context also in for the tenth occasion it is much more important than other things because most of the",
    "start": "3021900",
    "end": "3029120"
  },
  {
    "text": "vulnerabilities are based on authenticated the users and credentials and also intervention figurations",
    "start": "3029120",
    "end": "3036450"
  },
  {
    "text": "important because you need to secure your compatibilities because vendors may",
    "start": "3036450",
    "end": "3042300"
  },
  {
    "text": "enforce you to reduce the security level but don't do this use the secure way and",
    "start": "3042300",
    "end": "3048000"
  },
  {
    "text": "also protect the legacy systems don't expose them to the bt vua or cpu a environments not the subscribers of",
    "start": "3048000",
    "end": "3056810"
  },
  {
    "text": "course protect declines patch declines and monitor them if there's an activity",
    "start": "3056810",
    "end": "3062780"
  },
  {
    "text": "you need to know i'm unit isolated client or the client structure from your",
    "start": "3062780",
    "end": "3068490"
  },
  {
    "text": "network so approval you will have questions we may have some limited time for those",
    "start": "3068490",
    "end": "3074070"
  },
  {
    "start": "3070000",
    "end": "3070000"
  },
  {
    "text": "questions but if you have some time tomorrow DEFCON 24 workshops will have voice over IP boards the live workshop",
    "start": "3074070",
    "end": "3081330"
  },
  {
    "text": "so you can come there you can join me for the live demos and attacks and you will have USB",
    "start": "3081330",
    "end": "3089220"
  },
  {
    "text": "sticks for the vulnerable VMs and be pre-installed VMs to initiate your attacks personally if you have some",
    "start": "3089220",
    "end": "3095790"
  },
  {
    "text": "takeaways including VMs and USBs please join me and there's also black and",
    "start": "3095790",
    "end": "3100860"
  },
  {
    "text": "soundbites which is also important for me unified communications securing unified communications is not securing",
    "start": "3100860",
    "end": "3107790"
  },
  {
    "text": "just like VoIP you are not securing work you are securing all environment you are",
    "start": "3107790",
    "end": "3113400"
  },
  {
    "text": "securing all communication details of course brace yourselves because voice over IP attacks are coming they are in",
    "start": "3113400",
    "end": "3119400"
  },
  {
    "text": "the vault but you don't see them global cost all for us or injections phishing",
    "start": "3119400",
    "end": "3124500"
  },
  {
    "text": "attempts they are all based on voice over IP and of course tailor your communication security it is required to",
    "start": "3124500",
    "end": "3129990"
  },
  {
    "text": "be tailored for your security requirements you want to get this tool and the",
    "start": "3129990",
    "end": "3135420"
  },
  {
    "text": "features vPro comm is a link to provide almost all previous talks and the",
    "start": "3135420",
    "end": "3141300"
  },
  {
    "text": "presentations tools themselves so if you have questions maybe I can take can i okay I can take",
    "start": "3141300",
    "end": "3149220"
  },
  {
    "text": "some questions if you have please hands up for the questions or please take the",
    "start": "3149220",
    "end": "3155070"
  },
  {
    "text": "mic no questions okay thank you",
    "start": "3155070",
    "end": "3161130"
  },
  {
    "text": "[Applause]",
    "start": "3161130",
    "end": "3165449"
  }
]