[
  {
    "start": "0",
    "end": "94000"
  },
  {
    "text": "welcome to recover an RSA private key from a TLS session with perfect forward",
    "start": "240",
    "end": "6399"
  },
  {
    "text": "secrecy in South C CDF with Marco ortisi",
    "start": "6399",
    "end": "11440"
  },
  {
    "text": "before we begin a few brief notes stop by the business Hall located in Bayside",
    "start": "11440",
    "end": "16520"
  },
  {
    "text": "AB during the day and for the welcome reception from 5:30 to 7:00 p.m. tonight",
    "start": "16520",
    "end": "22840"
  },
  {
    "text": "the black hat Arsenal is on the palm foyer on level three join us for the pony Awards in Mandalay Bay BC D at 6:30",
    "start": "22840",
    "end": "32119"
  },
  {
    "text": "p.m. thanks for putting your phone on vibrate it makes it easier for the rest of us to ignore the ringing while you",
    "start": "32120",
    "end": "38760"
  },
  {
    "text": "wait for your voicemail to pick it up and with that we welcome our speaker thank you",
    "start": "38760",
    "end": "45640"
  },
  {
    "text": "Caroline welcome everybody uh that is a really big",
    "start": "45640",
    "end": "50920"
  },
  {
    "text": "audience uh my name is uh Mark ctis I am Senior penetration",
    "start": "50920",
    "end": "57160"
  },
  {
    "text": "tester and I really love buff for vulnerability and I adore exotic bags",
    "start": "57160",
    "end": "63359"
  },
  {
    "text": "like that one that I'm going to introduce in this speech uh another bit of information",
    "start": "63359",
    "end": "70119"
  },
  {
    "text": "about me we are uh now we are approximately",
    "start": "70119",
    "end": "75240"
  },
  {
    "text": "here but I'm coming from here and this is Sicily there is a 9",
    "start": "75240",
    "end": "84240"
  },
  {
    "text": "hours uh jet lag so if I look if I look affected by this glacia you know why so",
    "start": "84240",
    "end": "94040"
  },
  {
    "start": "94000",
    "end": "94000"
  },
  {
    "text": "about the topic as I told you I really like exotic vulnerability and retrieving",
    "start": "94040",
    "end": "101040"
  },
  {
    "text": "a harsa private key just by sniffing the TLs traffic or interacting with a TLS",
    "start": "101040",
    "end": "107200"
  },
  {
    "text": "service looks quite exotic to me and it is done via a side side Channel attack",
    "start": "107200",
    "end": "114000"
  },
  {
    "text": "which is 100% reproducible so what about the road map",
    "start": "114000",
    "end": "121759"
  },
  {
    "start": "118000",
    "end": "118000"
  },
  {
    "text": "I will be giving you uh an historical introduction about this vulnerability showing very soon uh a",
    "start": "121759",
    "end": "130119"
  },
  {
    "text": "demo afterward we will cover uh more detail about the",
    "start": "130120",
    "end": "135319"
  },
  {
    "text": "attack and finally a second demon is shown and at the end will be the time",
    "start": "135319",
    "end": "141280"
  },
  {
    "text": "for greetings and questions if any so let's start from an historical",
    "start": "141280",
    "end": "147959"
  },
  {
    "text": "introduction about the problem exactly 20 years ago Haren lestra wrote a",
    "start": "147959",
    "end": "154160"
  },
  {
    "text": "theoretical Memo by warning that when RSA CRT is used for the calculation of",
    "start": "154160",
    "end": "161120"
  },
  {
    "text": "digital signature and uh an AR fault take place during the computation of",
    "start": "161120",
    "end": "167519"
  },
  {
    "text": "signature actually um this trigger this condition",
    "start": "167519",
    "end": "172599"
  },
  {
    "text": "can uh can trigger a series of events leading to the private key",
    "start": "172599",
    "end": "177840"
  },
  {
    "text": "leakage the RSA is basically an optimization for the",
    "start": "177840",
    "end": "183599"
  },
  {
    "text": "calculation of digital signature and from now on we will Define",
    "start": "183599",
    "end": "189239"
  },
  {
    "text": "we will refer to this attack as the lra attack or the rsac CT",
    "start": "189239",
    "end": "194840"
  },
  {
    "text": "attack so um for this topic is very",
    "start": "194840",
    "end": "200440"
  },
  {
    "start": "195000",
    "end": "195000"
  },
  {
    "text": "important give a brief introduction about how RSA works so a brief",
    "start": "200440",
    "end": "205840"
  },
  {
    "text": "introduction about public key encryption and especially it is very important to",
    "start": "205840",
    "end": "211120"
  },
  {
    "text": "cover the concept of digital signature with RSA we uh hone a couple of keys we",
    "start": "211120",
    "end": "218599"
  },
  {
    "text": "freely distribute our public key uh so that someone can use it to send us an",
    "start": "218599",
    "end": "224720"
  },
  {
    "text": "encrypted message and we use our private key that has the name suggest must be kept secret",
    "start": "224720",
    "end": "231799"
  },
  {
    "text": "to decrypt that message and the private key is not only used for uh decrypting something but",
    "start": "231799",
    "end": "239280"
  },
  {
    "text": "also to to uh sign something and actually signing is the action to generate a digital signature to overs",
    "start": "239280",
    "end": "246560"
  },
  {
    "text": "simplify you can see it as an encryption operation and in this case conversely",
    "start": "246560",
    "end": "253239"
  },
  {
    "text": "the recipient uses our public key to verify the correctness of the signature",
    "start": "253239",
    "end": "258759"
  },
  {
    "text": "and to over simplify again you can see it as a decryption operation so during the uh lra memo and",
    "start": "258759",
    "end": "267360"
  },
  {
    "text": "later on somebody con conjecture that the same attack was also effective",
    "start": "267360",
    "end": "274240"
  },
  {
    "text": "against smart card if the attacker could actually artificially inject uh Hardware",
    "start": "274240",
    "end": "281840"
  },
  {
    "text": "faults during the computation of RSA signature for example by means of",
    "start": "281840",
    "end": "287960"
  },
  {
    "text": "radiations hn voltage or uh um CPU over",
    "start": "287960",
    "end": "293600"
  },
  {
    "text": "eating so with heating and things like that in 2001 sorry I'm going okay in",
    "start": "293600",
    "end": "302120"
  },
  {
    "text": "2001 two researchers actually discover an attack against the open pgp format uh",
    "start": "302120",
    "end": "308600"
  },
  {
    "text": "by exploiting the same principle um described by lenra",
    "start": "308600",
    "end": "314880"
  },
  {
    "text": "forly basically if the attacker could could get the the archive containing the",
    "start": "314880",
    "end": "320199"
  },
  {
    "text": "encrypted private key tampering with it in a certain Manner and subsequently",
    "start": "320199",
    "end": "325680"
  },
  {
    "text": "capturing uh digital signature basically basically or she could drive the private",
    "start": "325680",
    "end": "332240"
  },
  {
    "text": "key of s and until that moment it was believed",
    "start": "332240",
    "end": "337280"
  },
  {
    "text": "that the the attack was possible only if the attacker had physical access to the",
    "start": "337280",
    "end": "343039"
  },
  {
    "text": "Target device or local access to the system only by the end of 2015 so very",
    "start": "343039",
    "end": "350000"
  },
  {
    "text": "recently Florian wmer from Red Dot explained why the lra attack brings",
    "start": "350000",
    "end": "356199"
  },
  {
    "text": "remote impacts and implications but unfortunately to together with this white paper uh he didn't provide any",
    "start": "356199",
    "end": "363600"
  },
  {
    "text": "tools or proof of concept and I will try to fill up this Gap during my",
    "start": "363600",
    "end": "371560"
  },
  {
    "text": "speech so uh normally during TLS session",
    "start": "371560",
    "end": "376840"
  },
  {
    "text": "what is revealed is the public ke server when it send the uh the the publicy",
    "start": "376840",
    "end": "382800"
  },
  {
    "text": "inside the server certificate to the client but sometimes it is also possible",
    "start": "382800",
    "end": "387960"
  },
  {
    "text": "to retrieve the key Beyond without going beyond that red line so I mean in the",
    "start": "387960",
    "end": "394720"
  },
  {
    "text": "preliminary step in the preim preliminary phase of the TLs and the shake before encryption and",
    "start": "394720",
    "end": "401240"
  },
  {
    "text": "anti-tampering C measures take place to do that we require three",
    "start": "401240",
    "end": "407800"
  },
  {
    "start": "405000",
    "end": "405000"
  },
  {
    "text": "preconditions that as we will see later are not so difficult to happen in in real life so basically we require the",
    "start": "407800",
    "end": "415280"
  },
  {
    "text": "presence of RSA signature which is generated with the acrt",
    "start": "415280",
    "end": "421160"
  },
  {
    "text": "optimization it must be applied some values that the attacker knows in plain text and of course it must be faulty I",
    "start": "421160",
    "end": "428800"
  },
  {
    "text": "mean it must must be generated in a in a wrong way by the",
    "start": "428800",
    "end": "434400"
  },
  {
    "text": "seven what if the attack is successful so basically the private key the sever",
    "start": "434400",
    "end": "440120"
  },
  {
    "start": "435000",
    "end": "435000"
  },
  {
    "text": "private key leaks as an attacker we can impersonate the real server or device",
    "start": "440120",
    "end": "446199"
  },
  {
    "text": "and of course we can place any middle many in the middle of attack um without alerting the legitimate",
    "start": "446199",
    "end": "453160"
  },
  {
    "text": "clients and from that to this it makes the difference when an attack is under",
    "start": "453160",
    "end": "461240"
  },
  {
    "text": "way now demo fast as ever and because I feel Brave I want to give you a life",
    "start": "461240",
    "end": "470080"
  },
  {
    "text": "demo I want to show you the effect of the lra attack before to continue with",
    "start": "470080",
    "end": "476360"
  },
  {
    "text": "the technical stuff so basically I have created a tool",
    "start": "476360",
    "end": "482120"
  },
  {
    "text": "called high voltage uh that when the TR precondition that I shown before uh and shown briefly",
    "start": "482120",
    "end": "490120"
  },
  {
    "text": "are met it is able to recover the private key so in my virtual machine I",
    "start": "490120",
    "end": "495759"
  },
  {
    "text": "deployed to uh two different versions of op SSL uh uh one one of this version that",
    "start": "495759",
    "end": "502680"
  },
  {
    "text": "we will call the good one has been actually downloaded by the default repository and the other one that we",
    "start": "502680",
    "end": "509560"
  },
  {
    "text": "will call the bad one has been patched in a way that uh uh irsa digital",
    "start": "509560",
    "end": "516599"
  },
  {
    "text": "signature a fault RSA digital signature is injected during a TLS in the",
    "start": "516599",
    "end": "522440"
  },
  {
    "text": "shake uh in our context the top Windows is the the attacker window and the bottom window is",
    "start": "522440",
    "end": "531000"
  },
  {
    "text": "the the the server window so first of all what I'm going to",
    "start": "531000",
    "end": "536800"
  },
  {
    "text": "do is to generate a new certificate for the uh for the",
    "start": "536800",
    "end": "542880"
  },
  {
    "text": "server and the new private key we use RSA 496 bits so strong",
    "start": "542880",
    "end": "552120"
  },
  {
    "text": "key okay now I'm going to run this other script",
    "start": "561440",
    "end": "570720"
  },
  {
    "text": "that basically execute a TLS",
    "start": "571079",
    "end": "576640"
  },
  {
    "text": "service by using the good version of op SSL and after 11 seconds this service is",
    "start": "576640",
    "end": "583320"
  },
  {
    "text": "killed and it is run again this time with the bad version of openl and this",
    "start": "583320",
    "end": "589880"
  },
  {
    "text": "could simulate the injection of uh faulty sign instead on client side we will use",
    "start": "589880",
    "end": "598399"
  },
  {
    "text": "high voltage and basically we pass to this tool only",
    "start": "598399",
    "end": "604399"
  },
  {
    "text": "to mandatory option which are basically the IP address of",
    "start": "604399",
    "end": "613079"
  },
  {
    "text": "server and the port of the",
    "start": "613240",
    "end": "617160"
  },
  {
    "text": "service okay",
    "start": "618600",
    "end": "622480"
  },
  {
    "text": "so I'm running on S side TLS service and contemporary Iran high",
    "start": "623839",
    "end": "631120"
  },
  {
    "text": "voltage and now the tools start to establish multiple TLS and the",
    "start": "631120",
    "end": "638040"
  },
  {
    "text": "shades until a faulty signature is",
    "start": "638040",
    "end": "643160"
  },
  {
    "text": "detected and apparently there has been a faulty",
    "start": "643160",
    "end": "649440"
  },
  {
    "text": "signature and so apparently the private key of server has been",
    "start": "649440",
    "end": "654760"
  },
  {
    "text": "recovered to verify this",
    "start": "654760",
    "end": "659680"
  },
  {
    "text": "let's see let's compare the two private keys so the private key generated by the tool",
    "start": "659800",
    "end": "666200"
  },
  {
    "text": "and the private key on S",
    "start": "666200",
    "end": "669560"
  },
  {
    "text": "side okay",
    "start": "677760",
    "end": "681760"
  },
  {
    "text": "the name of the uh s key is new one on S",
    "start": "696600",
    "end": "703279"
  },
  {
    "text": "side okay just compare for example the",
    "start": "712320",
    "end": "717639"
  },
  {
    "text": "first three by bites here and here if you can",
    "start": "717639",
    "end": "724240"
  },
  {
    "text": "see they are the same and if you compare any other",
    "start": "724240",
    "end": "730839"
  },
  {
    "text": "bites for example we can go at the end of the key sorry and also here at the end of the",
    "start": "731000",
    "end": "737839"
  },
  {
    "text": "private exponent you can see that also here and here we have a match so",
    "start": "737839",
    "end": "745160"
  },
  {
    "text": "basically the tool has been able to recover the key of",
    "start": "745160",
    "end": "751760"
  },
  {
    "text": "server okay so this is a security bulletin from",
    "start": "760600",
    "end": "766760"
  },
  {
    "text": "Dell and it is a security bulletin for one of their product a firewall solution",
    "start": "766760",
    "end": "772199"
  },
  {
    "text": "which is called sonic wall and was affected by this problem and actually",
    "start": "772199",
    "end": "778680"
  },
  {
    "text": "they said said that this hatack require a highly sophisticated tool which is not",
    "start": "778680",
    "end": "785120"
  },
  {
    "text": "available to the general public but now it is for all of",
    "start": "785120",
    "end": "791240"
  },
  {
    "text": "you okay let's dig a little bit about the prerequisites of this",
    "start": "793959",
    "end": "800079"
  },
  {
    "start": "794000",
    "end": "794000"
  },
  {
    "text": "attack uh firstly we say that we require a RSA signature which is calculated by",
    "start": "800079",
    "end": "807639"
  },
  {
    "text": "using RSA CRT as I told you RS is an optimization for calcul for the",
    "start": "807639",
    "end": "813279"
  },
  {
    "text": "calculation of digital signature because the exponentiation operation of RSA is",
    "start": "813279",
    "end": "818320"
  },
  {
    "text": "computationally heavy especially when we use the private key and uh uh I personally don't know a",
    "start": "818320",
    "end": "827800"
  },
  {
    "text": "single implementation a single crypto Library out there that is not using RSA",
    "start": "827800",
    "end": "833720"
  },
  {
    "text": "CRT for the computational digital signature so we can say that this uh",
    "start": "833720",
    "end": "839199"
  },
  {
    "text": "precondition is always satisfied it not is normally satisfied",
    "start": "839199",
    "end": "844440"
  },
  {
    "start": "843000",
    "end": "843000"
  },
  {
    "text": "so we require a faulty signature and in the context of this pitch we Define the",
    "start": "844440",
    "end": "850240"
  },
  {
    "text": "faulty signature with the letter Y this is a an unpredictable situation",
    "start": "850240",
    "end": "856800"
  },
  {
    "text": "condition so it is something that the attacker cannot control uh but it is something that you",
    "start": "856800",
    "end": "863959"
  },
  {
    "text": "can see very often that happen very often in the embedded device world if if you think about about uh bit squatting",
    "start": "863959",
    "end": "871199"
  },
  {
    "text": "attack basically uh they are using the same principle so sometimes there is some uh",
    "start": "871199",
    "end": "879240"
  },
  {
    "text": "bit flippings it is due to CPU overheating to Ram error stuff like that",
    "start": "879240",
    "end": "886000"
  },
  {
    "text": "and when when this happen actually a faulty signature is generated so even if",
    "start": "886000",
    "end": "892120"
  },
  {
    "text": "if this condition is not uh uh cannot be controlled by the attacker we can say",
    "start": "892120",
    "end": "897360"
  },
  {
    "text": "that sooner or later it will happen happen and the last precondition is that the",
    "start": "897360",
    "end": "905399"
  },
  {
    "start": "901000",
    "end": "901000"
  },
  {
    "text": "signature must be calculated on values the attack is known in plain text this",
    "start": "905399",
    "end": "911120"
  },
  {
    "text": "is very important and we Define the uh value that must be signed with the",
    "start": "911120",
    "end": "917720"
  },
  {
    "text": "letter hex for uh for the purposes of our talk so",
    "start": "917720",
    "end": "925160"
  },
  {
    "text": "basically the digital signature is nothing more that a plain text value",
    "start": "925160",
    "end": "930959"
  },
  {
    "text": "that is hashed then uh padded and at the end it is encrypted with the private key",
    "start": "930959",
    "end": "937920"
  },
  {
    "text": "of the server so from the each of these",
    "start": "937920",
    "end": "944000"
  },
  {
    "text": "passages actually mutate and alter the shape of x uh so from the plain text to the uh",
    "start": "944000",
    "end": "952040"
  },
  {
    "text": "hashed form there is no problem until we know the hashing function that has been",
    "start": "952040",
    "end": "957199"
  },
  {
    "text": "used to generate that hash and it is something that the user know just by",
    "start": "957199",
    "end": "962440"
  },
  {
    "text": "observing the TLs protocol the version of the TLs protocol used but from the",
    "start": "962440",
    "end": "968360"
  },
  {
    "text": "hashing function to the padded form we could experience some problem because uh",
    "start": "968360",
    "end": "973680"
  },
  {
    "text": "the RSA standard defin some not deterministic way to generate padding",
    "start": "973680",
    "end": "979759"
  },
  {
    "text": "such as RSA PSS but likely for the attacker uh from",
    "start": "979759",
    "end": "987199"
  },
  {
    "text": "the version uh of SS cell 3.0 to up to TLS 1.2 actually the pading scheme used",
    "start": "987199",
    "end": "995480"
  },
  {
    "text": "is fully deterministic so it is not randomized and it means that it is",
    "start": "995480",
    "end": "1001480"
  },
  {
    "text": "predictable just to give you an example let's assume that we have this hash and it is our",
    "start": "1001480",
    "end": "1009279"
  },
  {
    "start": "1004000",
    "end": "1004000"
  },
  {
    "text": "payload this is our pkcs one.5 which is",
    "start": "1009279",
    "end": "1014319"
  },
  {
    "text": "the um the default padding scheme used with t",
    "start": "1014319",
    "end": "1020120"
  },
  {
    "text": "as actually how pkcs uh transform how",
    "start": "1020120",
    "end": "1025240"
  },
  {
    "text": "payload as you can see the green bite 00001 is always",
    "start": "1025240",
    "end": "1031760"
  },
  {
    "text": "prepended to the padding bites and 0 0 the black bite is always appended at the",
    "start": "1031760",
    "end": "1038839"
  },
  {
    "text": "end and in the middle there is a long uh more or less Long series or um of ffff",
    "start": "1038839",
    "end": "1047120"
  },
  {
    "text": "of FF bite that basically hard padding and this depend on the side uh sorry on",
    "start": "1047120",
    "end": "1053320"
  },
  {
    "text": "the length of the payload because probably you have to know that the message that this must have the same",
    "start": "1053320",
    "end": "1058880"
  },
  {
    "text": "length of the uh key used to sign the uh",
    "start": "1058880",
    "end": "1064080"
  },
  {
    "text": "the message so as you can see here it is quite predictable it is not randomized",
    "start": "1064080",
    "end": "1069799"
  },
  {
    "text": "and this is uh how pkcs 1.5 transform",
    "start": "1069799",
    "end": "1075960"
  },
  {
    "text": "our payload when uh TLS 1.0 and TLS 1.1",
    "start": "1075960",
    "end": "1081760"
  },
  {
    "text": "is negotiated is used for TLS 1.2 there is a slight different so basically",
    "start": "1081760",
    "end": "1088440"
  },
  {
    "text": "between the black bite and the red part the payload basically it is appended the",
    "start": "1088440",
    "end": "1094960"
  },
  {
    "text": "D encoded form of the object identifier for the hashing algorithm used to",
    "start": "1094960",
    "end": "1100480"
  },
  {
    "text": "generate this this hash so basically there is the negotiation of the hash that is used to generate uh this this",
    "start": "1100480",
    "end": "1110080"
  },
  {
    "text": "hash basically and uh the most important part here is that the Ping scheme is",
    "start": "1110080",
    "end": "1117559"
  },
  {
    "text": "fully deterministic so it is something that we can predict up",
    "start": "1117559",
    "end": "1123840"
  },
  {
    "text": "front and of course we require the presence of digital signature somewhere",
    "start": "1123840",
    "end": "1129600"
  },
  {
    "text": "in the TLs and the shake and this condition is always satisfied if we",
    "start": "1129600",
    "end": "1134799"
  },
  {
    "text": "carefully negotiate the right cyos suit for",
    "start": "1134799",
    "end": "1140679"
  },
  {
    "text": "example uh let's see what happen when we negotiate the cyers so basically RSA",
    "start": "1140679",
    "end": "1146840"
  },
  {
    "start": "1141000",
    "end": "1141000"
  },
  {
    "text": "here is used both for authentication and has a key exchange mechanism AES the",
    "start": "1146840",
    "end": "1153679"
  },
  {
    "text": "symmetric algorithm CBC the mod operation and sha is the hashing algorithm so when the RSA private key is",
    "start": "1153679",
    "end": "1162400"
  },
  {
    "text": "leaked in this context not only the current session but also all those one",
    "start": "1162400",
    "end": "1168480"
  },
  {
    "text": "and established in the past in the future with the same private key are",
    "start": "1168480",
    "end": "1173559"
  },
  {
    "text": "compromised and the certificate message in this case contain a",
    "start": "1173559",
    "end": "1179600"
  },
  {
    "text": "signature but the signature is generated with the private key of the certification Authority or the private",
    "start": "1179600",
    "end": "1185159"
  },
  {
    "text": "key of the server if we have a self- signed certificate but this signature is",
    "start": "1185159",
    "end": "1190799"
  },
  {
    "text": "actually statically embedded and not and not dynamically generated and we can say that this cyers",
    "start": "1190799",
    "end": "1198360"
  },
  {
    "text": "is not good for our purposes What If instead we",
    "start": "1198360",
    "end": "1203559"
  },
  {
    "text": "use this kind of cyers fits so actually helip Cube defon Emeral or defon Emeral",
    "start": "1203559",
    "end": "1211840"
  },
  {
    "text": "only is used as key change mechanism instead RSA is only used for",
    "start": "1211840",
    "end": "1218559"
  },
  {
    "text": "authentication this is very important the rest is the same and doesn't matter so in this case the key change is",
    "start": "1218559",
    "end": "1227880"
  },
  {
    "text": "done by using some private and public key which are generated on the Fly and this is very important because",
    "start": "1227880",
    "end": "1236080"
  },
  {
    "text": "if the private key of a specific TLS session is compromised in this case only",
    "start": "1236080",
    "end": "1242679"
  },
  {
    "text": "that session is compromised not the previous one or the uh that one that are",
    "start": "1242679",
    "end": "1248679"
  },
  {
    "text": "established in the future and this feature is called perfect forward secrecy and perfect forward secrecy",
    "start": "1248679",
    "end": "1255640"
  },
  {
    "text": "actually fit perfectly to us because because when we negotiate this kind of",
    "start": "1255640",
    "end": "1261400"
  },
  {
    "text": "cyers Suite A dynamically generated signature is embedded inside the server",
    "start": "1261400",
    "end": "1269520"
  },
  {
    "text": "key exchange message and this message is only only exchanged when perfect forward",
    "start": "1269520",
    "end": "1276559"
  },
  {
    "text": "secrecy is uh negotiated so this is how high voltage",
    "start": "1276559",
    "end": "1282720"
  },
  {
    "start": "1280000",
    "end": "1280000"
  },
  {
    "text": "the tool that you have seen uh previously basically works so",
    "start": "1282720",
    "end": "1289039"
  },
  {
    "text": "uh it send a TLS client message by negotiating with for secret cyers s",
    "start": "1289039",
    "end": "1296200"
  },
  {
    "text": "only and it takes note by uh 32 by",
    "start": "1296200",
    "end": "1302279"
  },
  {
    "text": "structure which is called the random structure the server H with the DLS",
    "start": "1302279",
    "end": "1307679"
  },
  {
    "text": "server Hilo packet and in this case in this case as well the tool takes note of",
    "start": "1307679",
    "end": "1314600"
  },
  {
    "text": "the uh 32 BYT random structure afterward the Ser send the certificates",
    "start": "1314600",
    "end": "1321919"
  },
  {
    "text": "two pieces of information are very important here hand which is a big semi-",
    "start": "1321919",
    "end": "1327679"
  },
  {
    "text": "prime number and E which is actually a small exponent such as three or",
    "start": "1327679",
    "end": "1335880"
  },
  {
    "text": "65537 together H and D represent the public key of",
    "start": "1336520",
    "end": "1342799"
  },
  {
    "text": "server and finally the server transmit the TLs server keychange packet",
    "start": "1342799",
    "end": "1349159"
  },
  {
    "text": "that actually contain a structure called uh sever parameters which is very",
    "start": "1349159",
    "end": "1355640"
  },
  {
    "text": "important for for our attack and also the tools takes note of the signature",
    "start": "1355640",
    "end": "1361799"
  },
  {
    "text": "which is embedded in this packet and the signature is actually generated on these",
    "start": "1361799",
    "end": "1370039"
  },
  {
    "text": "three pieces calculated on these three pieces of information and this is because the",
    "start": "1370039",
    "end": "1375799"
  },
  {
    "text": "tools collect the tool collect this information because these three pieces of information actually allow us to detect",
    "start": "1375799",
    "end": "1384279"
  },
  {
    "text": "if the signature is valid or not and as I told you previously the presence of a",
    "start": "1384279",
    "end": "1390559"
  },
  {
    "text": "faulty signature is very important so how to detect the faulty",
    "start": "1390559",
    "end": "1395960"
  },
  {
    "text": "signature just looking for them for",
    "start": "1395960",
    "end": "1402120"
  },
  {
    "text": "example with uh TLS 1.1 or TLS uh 1.0",
    "start": "1402120",
    "end": "1408120"
  },
  {
    "text": "basic Al the tools collect all the messages from the client tillo up to the",
    "start": "1408120",
    "end": "1413840"
  },
  {
    "text": "server key exchange message by extracting the information that it",
    "start": "1413840",
    "end": "1419919"
  },
  {
    "text": "needs and it creates actually two sign sorry two hashes hd5 hash and the Shia",
    "start": "1419919",
    "end": "1426640"
  },
  {
    "text": "one hash uh giving has input the collected information and this hashes are actually",
    "start": "1426640",
    "end": "1434279"
  },
  {
    "text": "concatenated together next the tools use the public key of the server to decrypt",
    "start": "1434279",
    "end": "1441799"
  },
  {
    "text": "the digital signature inside the server key exchange message um from there the padding is",
    "start": "1441799",
    "end": "1450320"
  },
  {
    "text": "removed and then the result is compared with the S with the hashes that has been",
    "start": "1450320",
    "end": "1457000"
  },
  {
    "text": "calculated offline if there is a match actually the signature is valid if there is a",
    "start": "1457000",
    "end": "1464679"
  },
  {
    "text": "mismatch it and it is of course the condition that attacking want to happen if the isas mismatch actually it means",
    "start": "1464679",
    "end": "1471520"
  },
  {
    "text": "that the signature is faulty and the attack can continue by applying the original lenra attack of 20",
    "start": "1471520",
    "end": "1480120"
  },
  {
    "text": "years ago with tls1.2 the procedure is basically the same but instead of uh",
    "start": "1480120",
    "end": "1488200"
  },
  {
    "text": "generating md5 and shaan hash actually the hashing algorithm used is specified",
    "start": "1488200",
    "end": "1495720"
  },
  {
    "text": "inside the TLs server keychange",
    "start": "1495720",
    "end": "1500320"
  },
  {
    "text": "message so now we have a faulty digital",
    "start": "1501960",
    "end": "1509960"
  },
  {
    "text": "signature how can we continue with the attack we need to apply the lra attack",
    "start": "1511279",
    "end": "1517919"
  },
  {
    "text": "as I as I told you previously and to understand the specific attack we need also to understand how RSA works and",
    "start": "1517919",
    "end": "1526080"
  },
  {
    "text": "what is the RSA CRT optim optim ization and finally I can I will show you a",
    "start": "1526080",
    "end": "1531200"
  },
  {
    "text": "second demo so RSA is a very simple algorit",
    "start": "1531200",
    "end": "1536679"
  },
  {
    "start": "1533000",
    "end": "1533000"
  },
  {
    "text": "because every operation can can be described in terms of multiplication",
    "start": "1536679",
    "end": "1541960"
  },
  {
    "text": "moduo or uh exponentiation operations for example these are the two",
    "start": "1541960",
    "end": "1548120"
  },
  {
    "text": "formulas used for encryption and decryption and basically here in this",
    "start": "1548120",
    "end": "1553320"
  },
  {
    "text": "context see is the cyer text hem is the message to encrypt and Andy uh represent",
    "start": "1553320",
    "end": "1560559"
  },
  {
    "text": "the public key while he is a little exponent a small number such as three or",
    "start": "1560559",
    "end": "1568159"
  },
  {
    "text": "65,536 H is instead a big semi- prime number that is given by the",
    "start": "1568159",
    "end": "1573960"
  },
  {
    "text": "multiplication of two prime numbers p and Q and the security of RSA rotates",
    "start": "1573960",
    "end": "1581799"
  },
  {
    "text": "entirely the fact that P and Q are unknown to the attacker",
    "start": "1581799",
    "end": "1588480"
  },
  {
    "text": "D instead is the private key which is generated by providing three pieces of",
    "start": "1588480",
    "end": "1593840"
  },
  {
    "text": "information to the inverse modular function which are p q and P so by",
    "start": "1593840",
    "end": "1601360"
  },
  {
    "text": "getting p and Q we can calculate the uh private key of server very easily",
    "start": "1601360",
    "end": "1608240"
  },
  {
    "text": "because e is already a public information",
    "start": "1608240",
    "end": "1613919"
  },
  {
    "start": "1611000",
    "end": "1611000"
  },
  {
    "text": "so if you remember I told you that actually the security of RSA rotate",
    "start": "1613919",
    "end": "1620039"
  },
  {
    "text": "entirely the fact that the prime numbers p and Q are unknown to the attacker but",
    "start": "1620039",
    "end": "1625240"
  },
  {
    "text": "actually it is even worse than this because if the attacker can collect just",
    "start": "1625240",
    "end": "1631360"
  },
  {
    "text": "one of p and Q he or she can actually derive the other prime number and then",
    "start": "1631360",
    "end": "1638600"
  },
  {
    "text": "the private key can be calculated very easily so to understand this concept",
    "start": "1638600",
    "end": "1643880"
  },
  {
    "text": "just reason on a small number for example let's assume that uh the uh the",
    "start": "1643880",
    "end": "1653120"
  },
  {
    "text": "value of hand inside the certificate is 77 and for some",
    "start": "1653120",
    "end": "1658679"
  },
  {
    "text": "reason uh the attacker was able to derive one of the prime factor of N and",
    "start": "1658679",
    "end": "1666440"
  },
  {
    "text": "assume that in this case p is equals to 7 so we can derive the other prime",
    "start": "1666440",
    "end": "1673600"
  },
  {
    "text": "factor Q very easily just by dividing H by p and and if instead the attacker has",
    "start": "1673600",
    "end": "1682919"
  },
  {
    "text": "Q knows the value of Q he can derive P very easily just by dividing Hand by q",
    "start": "1682919",
    "end": "1690080"
  },
  {
    "text": "and of course Q multiplied P give us the value of",
    "start": "1690080",
    "end": "1699480"
  },
  {
    "text": "n so the RSA CT optimization RS CT is basically as I told you is an",
    "start": "1699480",
    "end": "1707159"
  },
  {
    "text": "optimization that speeds up the calculation of digital of RSA digital signature and basically the calculation",
    "start": "1707159",
    "end": "1714640"
  },
  {
    "text": "of RSA is uh broken down into small pieces so if you want to sign something",
    "start": "1714640",
    "end": "1720919"
  },
  {
    "start": "1719000",
    "end": "1719000"
  },
  {
    "text": "with rsrt there are some value that are",
    "start": "1720919",
    "end": "1726320"
  },
  {
    "text": "precomputed and some other values that are generated uh that are calculated on the Fly and especially the calculation",
    "start": "1726320",
    "end": "1733600"
  },
  {
    "text": "of S1 and S S2 is very critical",
    "start": "1733600",
    "end": "1738960"
  },
  {
    "text": "because if there is a fault during the calculation of one of these two uh",
    "start": "1738960",
    "end": "1744600"
  },
  {
    "text": "values basically a faulty signature is generated and a prime factor of n prime",
    "start": "1744600",
    "end": "1752039"
  },
  {
    "text": "factor of the public key can be derived can be calculated by using the greatest",
    "start": "1752039",
    "end": "1758320"
  },
  {
    "text": "common devis devisor function and actually it",
    "start": "1758320",
    "end": "1763640"
  },
  {
    "text": "is the lra oop sorry it is the lestra memo the",
    "start": "1763640",
    "end": "1769600"
  },
  {
    "text": "lestra attack of 1996 and the value that we need to",
    "start": "1769600",
    "end": "1777000"
  },
  {
    "text": "feed this function are actually value that the attacker can uh can get very",
    "start": "1777000",
    "end": "1782640"
  },
  {
    "text": "easily because Y which is the faulty signature can be extracted from the TLs",
    "start": "1782640",
    "end": "1789880"
  },
  {
    "text": "key exchange message e which is the public exponent is is found inside the",
    "start": "1789880",
    "end": "1795919"
  },
  {
    "text": "certificate hex is the original hashed and it is the yes the original value",
    "start": "1795919",
    "end": "1802640"
  },
  {
    "text": "that has been hashed and padded and if you remember PK pkcs 1.5 is a padding",
    "start": "1802640",
    "end": "1808919"
  },
  {
    "text": "scheme deterministic and N is the public key of",
    "start": "1808919",
    "end": "1814519"
  },
  {
    "text": "the server that can be also found inside the certificate so they are all public",
    "start": "1814519",
    "end": "1820279"
  },
  {
    "text": "information so the attack exploited by the tool high voltage that I've created",
    "start": "1820279",
    "end": "1826120"
  },
  {
    "text": "now should be uh uh very clear because basically the tool establish multiple uh",
    "start": "1826120",
    "end": "1833279"
  },
  {
    "start": "1828000",
    "end": "1828000"
  },
  {
    "text": "TLS and the shakes trying to detecting a faulty signature when a faulty signature",
    "start": "1833279",
    "end": "1839399"
  },
  {
    "text": "is detected the lenra attack ER is uh is",
    "start": "1839399",
    "end": "1845000"
  },
  {
    "text": "executed and this allow us to derive one of the prime factor of the public key",
    "start": "1845000",
    "end": "1851960"
  },
  {
    "text": "whatever or P or Q it doesn't matter when we have one prime factor actually",
    "start": "1851960",
    "end": "1857760"
  },
  {
    "text": "we can derive the other one very easily as I shown you previously and once you",
    "start": "1857760",
    "end": "1863880"
  },
  {
    "text": "have both of p and Q you can actually calculate the private key and this is",
    "start": "1863880",
    "end": "1869880"
  },
  {
    "text": "game over so as probably you may uh may have",
    "start": "1869880",
    "end": "1876519"
  },
  {
    "text": "note basically all these pieces of information all the pieces of information that we need",
    "start": "1876519",
    "end": "1882960"
  },
  {
    "text": "to uh um to exploit the L attack are",
    "start": "1882960",
    "end": "1888080"
  },
  {
    "text": "exchanged in clear text over the network so this means that",
    "start": "1888080",
    "end": "1893960"
  },
  {
    "text": "basically uh we can just KN the TLs traffic looking for the information that",
    "start": "1893960",
    "end": "1899480"
  },
  {
    "text": "are useful to us and we can conduct this kind of attack not only actively but",
    "start": "1899480",
    "end": "1905240"
  },
  {
    "text": "also passively sniffing the network and to demonstrate this concept",
    "start": "1905240",
    "end": "1911360"
  },
  {
    "text": "I have created the second tool that I've called pichola and",
    "start": "1911360",
    "end": "1918880"
  },
  {
    "text": "I want to give you a live demo of this other tool as",
    "start": "1918880",
    "end": "1926360"
  },
  {
    "text": "well so basically pichola is composed by two",
    "start": "1934679",
    "end": "1940399"
  },
  {
    "text": "components A bash script and a c application program and it works on traffic dump",
    "start": "1940399",
    "end": "1948720"
  },
  {
    "text": "capture with uh TCP dump or wire sharks basically every traffic dump",
    "start": "1948720",
    "end": "1956200"
  },
  {
    "text": "written inside the pickup file so what we are going to do first of",
    "start": "1956200",
    "end": "1963000"
  },
  {
    "text": "all we have inside this directory uh different uh pickup files",
    "start": "1963000",
    "end": "1969519"
  },
  {
    "text": "first of all we want to uncompress every TCP streams inside this",
    "start": "1969519",
    "end": "1975080"
  },
  {
    "text": "pickup file to do that we use the TCP flow tools or actually we can use the script",
    "start": "1975080",
    "end": "1983000"
  },
  {
    "text": "that make the job for us so basically now inside this",
    "start": "1983000",
    "end": "1988320"
  },
  {
    "text": "directory we have different TCP",
    "start": "1988320",
    "end": "1993799"
  },
  {
    "text": "streams and just we need just to execute pichola by",
    "start": "1993799",
    "end": "2000039"
  },
  {
    "text": "passing the name of the directory containing all the uncompressed",
    "start": "2000039",
    "end": "2005679"
  },
  {
    "text": "streams and actually it start the",
    "start": "2005679",
    "end": "2010080"
  },
  {
    "text": "elaboration and at the end of this uh of the analysis of each TCP streams",
    "start": "2010840",
    "end": "2017480"
  },
  {
    "text": "basically different directory are created for example the incomplete directory",
    "start": "2017480",
    "end": "2023880"
  },
  {
    "text": "contains uh all the TCP streams where only the client payload was detected and",
    "start": "2023880",
    "end": "2031159"
  },
  {
    "text": "not the the sever payload or vice versa the not TLS directory contains all the",
    "start": "2031159",
    "end": "2037799"
  },
  {
    "text": "TCP stream that actually are not referring to uh uh SSL or TLS uh",
    "start": "2037799",
    "end": "2043480"
  },
  {
    "text": "connection the TLs not affected directory actually contain",
    "start": "2043480",
    "end": "2050000"
  },
  {
    "text": "every TCP stream which is a TLS session but for which has not been possible to",
    "start": "2050000",
    "end": "2056118"
  },
  {
    "text": "derive the private key instead the result",
    "start": "2056119",
    "end": "2061598"
  },
  {
    "text": "directory is where um the private key Le have written",
    "start": "2062040",
    "end": "2067760"
  },
  {
    "text": "and so for each session it is created uh a random",
    "start": "2067760",
    "end": "2073960"
  },
  {
    "text": "directory and inside of this directory we can find we can find the stream files",
    "start": "2073960",
    "end": "2081079"
  },
  {
    "text": "describing the communication between client and server and of course we can find the certificate the public key and",
    "start": "2081079",
    "end": "2089158"
  },
  {
    "text": "the private key derived by high voltage Sorry by pichola",
    "start": "2089159",
    "end": "2097599"
  },
  {
    "text": "so what does it mean it means I repeat that basically we can use this kind of",
    "start": "2100359",
    "end": "2106119"
  },
  {
    "text": "attack actively so by uh establishing multiple TLS and the shake or we can",
    "start": "2106119",
    "end": "2112560"
  },
  {
    "text": "just niff the the traffic of our Network so it is a proof of concept I mean pichola is a proof of concept but you",
    "start": "2112560",
    "end": "2119599"
  },
  {
    "text": "might use it to detect for example faulty signature by analyzing your",
    "start": "2119599",
    "end": "2125560"
  },
  {
    "text": "network traffic damp",
    "start": "2125560",
    "end": "2129320"
  },
  {
    "text": "and of course to exploit this vulnerability you require that your",
    "start": "2133640",
    "end": "2138960"
  },
  {
    "text": "application is linked to one of the uh crypto libraries vulnerable and there",
    "start": "2138960",
    "end": "2145760"
  },
  {
    "text": "are plenty of those this is just a brief list of",
    "start": "2145760",
    "end": "2152520"
  },
  {
    "text": "crypto library that has been found vulnerable or for which the vendor",
    "start": "2152520",
    "end": "2157680"
  },
  {
    "text": "declared to be vulnerable",
    "start": "2157680",
    "end": "2164599"
  },
  {
    "start": "2161000",
    "end": "2161000"
  },
  {
    "text": "instead regarding the hardware part basically the affected devices are",
    "start": "2164599",
    "end": "2171240"
  },
  {
    "text": "security devices such as firewall VPN concentrator and uh UTM Solutions and",
    "start": "2171240",
    "end": "2180119"
  },
  {
    "text": "stuff like that that is supposed to protect the boundaries of a company or",
    "start": "2180119",
    "end": "2185480"
  },
  {
    "text": "the privac the privacy of the users and these are this is a brief list not",
    "start": "2185480",
    "end": "2192000"
  },
  {
    "text": "complete list of devices that are affected by the problem and we have other vendor other",
    "start": "2192000",
    "end": "2200119"
  },
  {
    "text": "vendors affected as well it is very difficult especially when you try to to scan the internet to identify",
    "start": "2200119",
    "end": "2208880"
  },
  {
    "text": "specifically uh a version or a model of a vulnerable device because sometimes",
    "start": "2208880",
    "end": "2214960"
  },
  {
    "text": "the exxact model or version is not specified inside the certificate and",
    "start": "2214960",
    "end": "2220440"
  },
  {
    "text": "inside the certificate you can find I don't know some generic uh uh indication",
    "start": "2220440",
    "end": "2226040"
  },
  {
    "text": "for the vendor and the last device that I have found vulnerable is in in June",
    "start": "2226040",
    "end": "2232280"
  },
  {
    "text": "actually is this uh surveillance camera from the link so also surveillance",
    "start": "2232280",
    "end": "2238760"
  },
  {
    "text": "camera and printers are affected by this problem the",
    "start": "2238760",
    "end": "2245400"
  },
  {
    "text": "fix um some crypto allows the user to to disable the CRT",
    "start": "2245400",
    "end": "2252160"
  },
  {
    "text": "the RSA CRT optimization but it is not suggestable it is not advisable for for",
    "start": "2252160",
    "end": "2258319"
  },
  {
    "text": "performance reason and uh of course if you have some",
    "start": "2258319",
    "end": "2263680"
  },
  {
    "text": "uh if you are using a vulnerable Library you can compare the version of the",
    "start": "2263680",
    "end": "2269000"
  },
  {
    "text": "version that you are using with the list that I have uh specified in the slide",
    "start": "2269000",
    "end": "2277280"
  },
  {
    "text": "so now the question is is only TLS affected by this problem",
    "start": "2277880",
    "end": "2284480"
  },
  {
    "text": "the question is no because out there a lot of Protocols are using perect forward secrecy and RSA as",
    "start": "2284480",
    "end": "2293640"
  },
  {
    "text": "algorithms um and I believe that in this sense we require much more research in",
    "start": "2293640",
    "end": "2299240"
  },
  {
    "text": "future I mean in this specific field because there are some assumption that are not revealing so true for example it",
    "start": "2299240",
    "end": "2307280"
  },
  {
    "text": "is believe so far that it is not possible derrive uh a private key from an IPC",
    "start": "2307280",
    "end": "2315200"
  },
  {
    "text": "session just by sniffing the traffic so it is believed that you have to actively",
    "start": "2315200",
    "end": "2321000"
  },
  {
    "text": "interact with uh the hike service in fact hike hike version one is",
    "start": "2321000",
    "end": "2329560"
  },
  {
    "text": "a a really important part of the ipx staff uh stack because allow the peers",
    "start": "2329560",
    "end": "2336599"
  },
  {
    "text": "to negotiate date authentication and the the so-called security associations and actually in the hike",
    "start": "2336599",
    "end": "2343400"
  },
  {
    "text": "version one we can see that during a phase called phase one where authentication and negotiation of",
    "start": "2343400",
    "end": "2350400"
  },
  {
    "text": "security associations of the per is done uh",
    "start": "2350400",
    "end": "2355599"
  },
  {
    "text": "basically two modes are supported by Hike version one which are the main mode",
    "start": "2355599",
    "end": "2360800"
  },
  {
    "text": "of the aggressive mode both of these modes actually support a so-called RSA",
    "start": "2360800",
    "end": "2367400"
  },
  {
    "text": "signature authentication which is based on digital certificate and this is what happen when",
    "start": "2367400",
    "end": "2375160"
  },
  {
    "start": "2373000",
    "end": "2373000"
  },
  {
    "text": "the main mode in hike version one is used as you can see on packet number",
    "start": "2375160",
    "end": "2382800"
  },
  {
    "text": "five basically the initiator which is the attacker must to send a certificate",
    "start": "2382800",
    "end": "2388720"
  },
  {
    "text": "and its signature and this means that the attacker requires a valid certificate if",
    "start": "2388720",
    "end": "2395920"
  },
  {
    "text": "you want to continue uh in the handshake because if it provides uh a bad",
    "start": "2395920",
    "end": "2402480"
  },
  {
    "text": "certificate actually the server should drop the connection or should discard the",
    "start": "2402480",
    "end": "2408280"
  },
  {
    "text": "connection and another problem is that the server transmit the certificate and",
    "start": "2408280",
    "end": "2415000"
  },
  {
    "text": "its signature only on packet six which is actually exchanged inside",
    "start": "2415000",
    "end": "2421079"
  },
  {
    "text": "an encrypted the channel so this is because this is of",
    "start": "2421079",
    "end": "2426200"
  },
  {
    "text": "because of the Assumption that you need to be an active uh",
    "start": "2426200",
    "end": "2432640"
  },
  {
    "text": "attacker in order to derive the private key but what happen if we instead use",
    "start": "2432640",
    "end": "2440520"
  },
  {
    "start": "2439000",
    "end": "2439000"
  },
  {
    "text": "the aggressive mode on with Ike version version one so",
    "start": "2440520",
    "end": "2446440"
  },
  {
    "text": "basically the certificate and the signature of server is used on packet number two so it is used in the very",
    "start": "2446440",
    "end": "2454119"
  },
  {
    "text": "preliminary phase of the end shake and and this exchange happen inside a clear",
    "start": "2454119",
    "end": "2461599"
  },
  {
    "text": "text Channel basically so if we use I version one in aggressive mode with a",
    "start": "2461599",
    "end": "2469040"
  },
  {
    "text": "digital signature with signature authentication basically if all the",
    "start": "2469040",
    "end": "2474359"
  },
  {
    "text": "preconditions are met in just two pockets we can derive the private key of",
    "start": "2474359",
    "end": "2479520"
  },
  {
    "text": "the server uh let me conclude with some",
    "start": "2479520",
    "end": "2485800"
  },
  {
    "text": "special tanks to my colleague Frank Bosman that I Prov has provided the nice",
    "start": "2485800",
    "end": "2491200"
  },
  {
    "text": "drawings that you have seen so far and of course Florian bimer for its pioneering",
    "start": "2491200",
    "end": "2498680"
  },
  {
    "text": "research and also if you if you want to visit Sicily please",
    "start": "2498680",
    "end": "2505040"
  },
  {
    "text": "let me know especially the green and the yellow part if you do that I will offer you a",
    "start": "2505040",
    "end": "2511280"
  },
  {
    "text": "drink and uh if you have any question I'm here I just want to tell you",
    "start": "2511280",
    "end": "2517960"
  },
  {
    "text": "last thing so this year every talk of at blackout is evaluated so you should have",
    "start": "2517960",
    "end": "2525359"
  },
  {
    "text": "received an email and if you enjoyed my talk and if",
    "start": "2525359",
    "end": "2531960"
  },
  {
    "text": "you like to give a good evaluation to my talk I will really appreciate you for",
    "start": "2531960",
    "end": "2538200"
  },
  {
    "text": "that I have concluded thank you [Applause]",
    "start": "2538200",
    "end": "2546230"
  }
]