[
  {
    "text": "[Music]",
    "start": "2970",
    "end": "9309"
  },
  {
    "text": "[Music]",
    "start": "20680",
    "end": "34259"
  },
  {
    "text": "[Music]",
    "start": "37750",
    "end": "41929"
  },
  {
    "text": "[Music]",
    "start": "45670",
    "end": "57660"
  },
  {
    "text": "[Applause] he [Music]",
    "start": "57660",
    "end": "63439"
  },
  {
    "text": "my name is Matt Shannon I work for KPMG as part of the information Risk Management Group uh we do penetration",
    "start": "77520",
    "end": "84880"
  },
  {
    "text": "testing vulnerability assessments General Security work um what I'm going to talk about",
    "start": "84880",
    "end": "91040"
  },
  {
    "text": "today is Microsoft front page and I'm going to talk about a couple I'm going",
    "start": "91040",
    "end": "96439"
  },
  {
    "text": "to cover a couple of different topic areas it's a pretty heavily deployed tool that's not very well known uh I'm",
    "start": "96439",
    "end": "103560"
  },
  {
    "text": "going to cover the protocol uh the backend systems I'm going to cover a",
    "start": "103560",
    "end": "109520"
  },
  {
    "text": "simple Brute Force authentication uh scanning program I put together and I'm",
    "start": "109520",
    "end": "114799"
  },
  {
    "text": "going to talk about uh what to do when you gain front page access I'm going to talk about uh ASP I'm G to talk about",
    "start": "114799",
    "end": "121680"
  },
  {
    "text": "some of the powerful ASP components and tools you can use to gain further access",
    "start": "121680",
    "end": "127439"
  },
  {
    "text": "and then I'm going to wrap it up with uh how to secure front page all of you have",
    "start": "127439",
    "end": "133400"
  },
  {
    "text": "friends relatives girlfriends clients others that insist on running front page",
    "start": "133400",
    "end": "139120"
  },
  {
    "text": "this is how you take the extra steps to prevent the people that attended this conference from doing anything to them",
    "start": "139120",
    "end": "144800"
  },
  {
    "text": "uh and just to get us all on the same page um before we begin we're going to",
    "start": "144800",
    "end": "150400"
  },
  {
    "text": "talk about a lot of tools and techniques in here we all know you've got to use these on machines that you have",
    "start": "150400",
    "end": "156120"
  },
  {
    "text": "permission to use them on so get your written permission ahead of time let's",
    "start": "156120",
    "end": "161280"
  },
  {
    "text": "get started laying the ground one front page Microsoft front page what is it God if I",
    "start": "161280",
    "end": "167800"
  },
  {
    "text": "you have to ask that question you've been under a rock for the last 10 years",
    "start": "167800",
    "end": "173080"
  },
  {
    "text": "uh it's Microsoft's integrated website development tool it's a system for adding basic to Advanced functionality",
    "start": "173080",
    "end": "178720"
  },
  {
    "text": "with little little or no no web page experience in addition it's a integrated Microsoft Office package and in my",
    "start": "178720",
    "end": "185640"
  },
  {
    "text": "personal opinion a security ner it was built by vermier Technologies",
    "start": "185640",
    "end": "191519"
  },
  {
    "text": "in early 1995 vermier was one of those uh explosive firms that they",
    "start": "191519",
    "end": "197519"
  },
  {
    "text": "created front page to capture the web boom following an enormous success they",
    "start": "197519",
    "end": "202640"
  },
  {
    "text": "were bought out by Microsoft in 1996 um the original programming staff",
    "start": "202640",
    "end": "208879"
  },
  {
    "text": "still works for Microsoft although the Management's moved on to new Endeavors as a aside",
    "start": "208879",
    "end": "216000"
  },
  {
    "text": "all dlls all functions within front page start with theore",
    "start": "216000",
    "end": "221519"
  },
  {
    "text": "vti verir Technologies Incorporated decoding the system we're",
    "start": "221519",
    "end": "228159"
  },
  {
    "text": "going to talk a little bit about the HTTP protocol and what's going on behind the scenes when you access it administer",
    "start": "228159",
    "end": "234640"
  },
  {
    "text": "a front page sign it's client server communication very basic um um front",
    "start": "234640",
    "end": "240560"
  },
  {
    "text": "page client talks to the front page server extensions over HTTP put requests",
    "start": "240560",
    "end": "246680"
  },
  {
    "text": "the front page client typically makes requests against author admin shtml do",
    "start": "246680",
    "end": "252720"
  },
  {
    "text": "exe as well as a vti RPC commands we're going to talk about the different uh",
    "start": "252720",
    "end": "258759"
  },
  {
    "text": "dlls the admin dll is typically used for authoring commands uploading uh content",
    "start": "258759",
    "end": "265320"
  },
  {
    "text": "downloading content uh reviewing properties setting",
    "start": "265320",
    "end": "270479"
  },
  {
    "text": "permissions the uh author DL is used like I said for uploading and adding content the vtir RPC and shtml are",
    "start": "270479",
    "end": "279120"
  },
  {
    "text": "typically used for initial uh starting your initial session or beginning",
    "start": "279120",
    "end": "284960"
  },
  {
    "text": "access all right there's a lot put on that slide so I'm going to try to I'm going to try to break it down for you uh",
    "start": "285080",
    "end": "291280"
  },
  {
    "text": "but you can go back and read it at your leisure the the authentication system is kind of interesting Au authenticates you every",
    "start": "291280",
    "end": "298840"
  },
  {
    "text": "single time you do anything when you first make a connection it authenticates when you scan the directory it",
    "start": "298840",
    "end": "304400"
  },
  {
    "text": "authenticates when you pull up a file when you upload or download a file it authenticates what it essentially does",
    "start": "304400",
    "end": "310120"
  },
  {
    "text": "the first half of the authentication is let's determine if this actually is a front page enabled server so the first",
    "start": "310120",
    "end": "317120"
  },
  {
    "text": "request is a client request foror vti inf.",
    "start": "317120",
    "end": "322240"
  },
  {
    "text": "HTML basically this gives us information on server version in other words is this",
    "start": "322240",
    "end": "327440"
  },
  {
    "text": "client compatible with this version it gives me locations for the admin the author exes or dlls whatever case that",
    "start": "327440",
    "end": "333919"
  },
  {
    "text": "may be following this the client takes this information and makes a post to vti",
    "start": "333919",
    "end": "339800"
  },
  {
    "text": "RPC it's kind of a initial session start post it's trying to uh initiate",
    "start": "339800",
    "end": "348080"
  },
  {
    "text": "communication the server will typically respond with a 200 okay the client then",
    "start": "348080",
    "end": "354600"
  },
  {
    "text": "posts to vti author or admin depending on the depending on the uh action in our",
    "start": "354600",
    "end": "361479"
  },
  {
    "text": "example here is author in the case that the Administration has elected to allow",
    "start": "361479",
    "end": "367479"
  },
  {
    "text": "everyone access at this point front page will receive a 200 okay and you will have authenticated otherwise you'll get",
    "start": "367479",
    "end": "374919"
  },
  {
    "text": "kicked back a 4013 authorization required at this point the client knows",
    "start": "374919",
    "end": "382840"
  },
  {
    "text": "it needs a uh the client knows it needs to communicate to the server it needs to authenticate so it takes it's ntlm in",
    "start": "382840",
    "end": "390319"
  },
  {
    "text": "the case of Windows it takes the ntlm username and password builds the ntlm",
    "start": "390319",
    "end": "395599"
  },
  {
    "text": "challenge and sends that back to the server the server will once again respond with a 4013 authorization",
    "start": "395599",
    "end": "402840"
  },
  {
    "text": "required except this time it passes back the challenge for the server side",
    "start": "402840",
    "end": "409039"
  },
  {
    "text": "challenge this point client now having knowing its own username and password and having a specific server challenge",
    "start": "409039",
    "end": "416280"
  },
  {
    "text": "pushes back a challenge response it closes with a 200 it's a very simple",
    "start": "416280",
    "end": "421720"
  },
  {
    "text": "system but it happens again and again and again throughout the process of",
    "start": "421720",
    "end": "427039"
  },
  {
    "text": "accessing front page we'll talk a little bit about vti INF uh this does provide all the",
    "start": "427039",
    "end": "433400"
  },
  {
    "text": "configuration information it's embedded in the comments of the uh vf. HTML if",
    "start": "433400",
    "end": "439759"
  },
  {
    "text": "you were to open that page it would just say front page configuration information",
    "start": "439759",
    "end": "444960"
  },
  {
    "text": "what resides inside that on the other hand is actually the the comments and they show the location of the file they",
    "start": "444960",
    "end": "451240"
  },
  {
    "text": "show the location of the um the the location of the server version information things like that all right",
    "start": "451240",
    "end": "458639"
  },
  {
    "text": "like I said before um vti actually gives us a lot of extra information about the",
    "start": "458639",
    "end": "464120"
  },
  {
    "text": "server itself it tells us it believe it or not tells us the operating system most cases",
    "start": "464120",
    "end": "470879"
  },
  {
    "text": "the dlls andex can help us determine that uh anytime the vti contains author",
    "start": "470879",
    "end": "479000"
  },
  {
    "text": "or admin. exe n out of 10 times you're dealing with an Apache or a Unix box uh",
    "start": "479000",
    "end": "485039"
  },
  {
    "text": "dlls are of course come on the Windows side more importantly the version",
    "start": "485039",
    "end": "490440"
  },
  {
    "text": "information can help us narrow down the OS version uh this is this is important",
    "start": "490440",
    "end": "496800"
  },
  {
    "text": "uh for other attacks I've put together a version information table I've got the",
    "start": "496800",
    "end": "502520"
  },
  {
    "text": "uh I was not able to obtain a Windows me uh personal server uh version",
    "start": "502520",
    "end": "508240"
  },
  {
    "text": "information the I apologized the format and got uh munged uh Windows NT typically it is",
    "start": "508240",
    "end": "516680"
  },
  {
    "text": "a 4.x version pretty easy to remember Windows 2000 and Windows XP both fall under a 5x version although it's Mo most",
    "start": "516680",
    "end": "524880"
  },
  {
    "text": "often than not a much lower subversion number for 2K it's a 51 or a 52 versus a 56 or 58 on",
    "start": "524880",
    "end": "533040"
  },
  {
    "text": "XP I didn't create the name that's vermier but vermier created they call",
    "start": "533040",
    "end": "539399"
  },
  {
    "text": "their packets that they pass back and forth vermier RPC packets uh vermier RPC",
    "start": "539399",
    "end": "546079"
  },
  {
    "text": "packets resemble web services uh they resemble encoded HTML with variables uh",
    "start": "546079",
    "end": "555760"
  },
  {
    "text": "in my opinion it might have been an early precursor to XML the following is a sample vermier",
    "start": "555760",
    "end": "562560"
  },
  {
    "text": "RPC packet uh it contains a large amount of information it's a little clearer I'm sure in your in your on your CD than it",
    "start": "562560",
    "end": "568880"
  },
  {
    "text": "is up here but what you'll see embedded down in there is a physical Drive path to a file you attempt to download H it's",
    "start": "568880",
    "end": "577040"
  },
  {
    "text": "a pretty much a big no no you really don't want to keep a complete Drive physical Drive path to the file and it's",
    "start": "577040",
    "end": "583279"
  },
  {
    "text": "possible to use that kind of information for future Unicode exploits in addition if you climb in and start reviewing the",
    "start": "583279",
    "end": "589839"
  },
  {
    "text": "different information you'll find a lot of different functions or features you know revision level",
    "start": "589839",
    "end": "597480"
  },
  {
    "text": "um additional authorizations and permissions all embedded in those",
    "start": "597480",
    "end": "602600"
  },
  {
    "text": "strings it would be interesting and we made multiple attempts to modify different values and I think there's",
    "start": "602600",
    "end": "607680"
  },
  {
    "text": "still additional uh additional exploits to be had",
    "start": "607680",
    "end": "613279"
  },
  {
    "text": "there let's talk about the uh the back end for a minute um one of the more",
    "start": "616720",
    "end": "622560"
  },
  {
    "text": "interesting things that we were able to do was download a free copy of",
    "start": "622560",
    "end": "627839"
  },
  {
    "text": "Microsoft's uh Windows debugger the wind debug tool it's a free tool Microsoft",
    "start": "627839",
    "end": "632959"
  },
  {
    "text": "gives it away and attach that to a backend running inet info process and",
    "start": "632959",
    "end": "639440"
  },
  {
    "text": "listen as you make as you connect to and make a front page uh session watch what",
    "start": "639440",
    "end": "647079"
  },
  {
    "text": "dlls are being used and what functions the dlls are calling you can download when debug from",
    "start": "647079",
    "end": "654440"
  },
  {
    "text": "Microsoft's debugging site which I've included here when you download this you will also want to enable it to use",
    "start": "654440",
    "end": "660959"
  },
  {
    "text": "Microsoft's symbol server it'll help you translate what functions they're calling",
    "start": "660959",
    "end": "666519"
  },
  {
    "text": "both of these both the access to the symbol server as well as Microsoft debugging tool are completely free and a",
    "start": "666519",
    "end": "672360"
  },
  {
    "text": "really easy way to get an understanding of what's going on under the hot front page server extensions use a",
    "start": "672360",
    "end": "680839"
  },
  {
    "text": "as a partial list of the front page server extension dlls the off uh offl",
    "start": "680839",
    "end": "686639"
  },
  {
    "text": "and awl DLS you'll find are used more often than any of the others uh the",
    "start": "686639",
    "end": "691839"
  },
  {
    "text": "author and admin dlls are almost contain stub like functions that are called in",
    "start": "691839",
    "end": "697480"
  },
  {
    "text": "that are used to call functions in the earlier DL",
    "start": "697480",
    "end": "703200"
  },
  {
    "text": "LLS I don't know the the level of debugging skills but uh debugging is a",
    "start": "703200",
    "end": "709600"
  },
  {
    "text": "is an art as well as a science and it takes time to understand it uh there are multiple guides and tutorials available",
    "start": "709600",
    "end": "716240"
  },
  {
    "text": "on the internet a couple of quick Google searches will point you to to dozens uh when debugs got its own set of help",
    "start": "716240",
    "end": "721800"
  },
  {
    "text": "files uh but I included here the simple commands I I used when I was getting",
    "start": "721800",
    "end": "727639"
  },
  {
    "text": "started uh you can use the BM to set break points and it's kind of",
    "start": "727639",
    "end": "733040"
  },
  {
    "text": "interesting you can give it the dll and a global variable like star in other",
    "start": "733040",
    "end": "738959"
  },
  {
    "text": "words in the example I did fp4 a w bang star it'll essentially set a break point",
    "start": "738959",
    "end": "744440"
  },
  {
    "text": "for every single function in that dll now that's going to hurt because you're going to be stepping through that again",
    "start": "744440",
    "end": "750519"
  },
  {
    "text": "and again and again however what you're going to get get is a list of three 400",
    "start": "750519",
    "end": "756199"
  },
  {
    "text": "functions you can immediately pinpoint and narrow down the functions that seem most interesting to you such as set",
    "start": "756199",
    "end": "762320"
  },
  {
    "text": "permission get permission check authorization things like that BC to",
    "start": "762320",
    "end": "768600"
  },
  {
    "text": "clear those break points once you got your list you print up your list you go back you highlight the on you want to set the break point on and then go back",
    "start": "768600",
    "end": "775440"
  },
  {
    "text": "and run through and step through the code at those points uh G is of course",
    "start": "775440",
    "end": "780720"
  },
  {
    "text": "go once you paused the uh once you pause you hit a break you can restart it with go P pauses the",
    "start": "780720",
    "end": "788440"
  },
  {
    "text": "activity all right what did I discover when I went through it this is just a basic a very brief list but one of the",
    "start": "788440",
    "end": "794880"
  },
  {
    "text": "things that uh that I hit on was the FP uh a w service actually forms a listing",
    "start": "794880",
    "end": "803720"
  },
  {
    "text": "of all documents in the defined web prior to accepting a request it was my",
    "start": "803720",
    "end": "809639"
  },
  {
    "text": "it was my hope that it was coded a little more poorly that it would rate for your request then go and pull the",
    "start": "809639",
    "end": "815959"
  },
  {
    "text": "file and retrieve it for you however the server does pre-query the site and then",
    "start": "815959",
    "end": "821160"
  },
  {
    "text": "create an array a static array listing of these values and then it will reply with what you it will search this list",
    "start": "821160",
    "end": "828279"
  },
  {
    "text": "when you make a request however is there still an opportunity to break out of this list are there opportunities for",
    "start": "828279",
    "end": "833560"
  },
  {
    "text": "the buffer to be overrun sure there are DSP context get file is another one",
    "start": "833560",
    "end": "840040"
  },
  {
    "text": "of the uh get file and get document they're called when downloading uh from Front Page set your break points to",
    "start": "840040",
    "end": "846440"
  },
  {
    "text": "these and you can step through and figure out exactly where that array is getting called and whether or not there are opportunities for buffer",
    "start": "846440",
    "end": "853920"
  },
  {
    "text": "overruns ntdll is used exclusively in the authorization process and we all",
    "start": "853920",
    "end": "859880"
  },
  {
    "text": "know that there were attack vectors on that Microsoft came out and said they will not patch for nt4 do those same",
    "start": "859880",
    "end": "866880"
  },
  {
    "text": "attack Vector Supply via front page page entirely",
    "start": "866880",
    "end": "871720"
  },
  {
    "text": "possible okay taking some of this background information I learned about front page through uh through my job I",
    "start": "872560",
    "end": "881079"
  },
  {
    "text": "went ahead and put together automated tools to grind through accounts to grind",
    "start": "881079",
    "end": "886279"
  },
  {
    "text": "through passwords to grind through client uh front page enabled",
    "start": "886279",
    "end": "892600"
  },
  {
    "text": "servers FP exploiter was what came out of it it's a it's really it's a simple tool it's a front page uh password",
    "start": "892880",
    "end": "900880"
  },
  {
    "text": "grinding and vulnerability scanner built as both command line and uh parole",
    "start": "900880",
    "end": "906639"
  },
  {
    "text": "gtk in other words now that you have a better understanding of how front page works let's find out about finding",
    "start": "906639",
    "end": "912600"
  },
  {
    "text": "vulnerable targets uh this is what brought about the tool the tool locates front page accessible web servers uses",
    "start": "912600",
    "end": "919800"
  },
  {
    "text": "default options in other words tests for the everyone account then follows up using userdefined accounts and passwords",
    "start": "919800",
    "end": "927800"
  },
  {
    "text": "it comes with with the default password list um if I recall it's one of the ones that the uh one of the net bios forums",
    "start": "927800",
    "end": "934199"
  },
  {
    "text": "uses it's a typical uh simple password list it's a pearl gtk and a command line",
    "start": "934199",
    "end": "941639"
  },
  {
    "text": "tool um when you open it under Linux you will see a window pretty similar to",
    "start": "941639",
    "end": "947959"
  },
  {
    "text": "this the scanner works by you provided a Class C range you set targets yeah I",
    "start": "947959",
    "end": "955000"
  },
  {
    "text": "could definitely have made it a lot larger than that but most clients only have a Class C Network and we didn't want to help the script keys out any",
    "start": "955000",
    "end": "961600"
  },
  {
    "text": "more than I had to you can also set the password list uh",
    "start": "961600",
    "end": "968079"
  },
  {
    "text": "like I said before the password list is is created initially with roughly 25 or",
    "start": "968079",
    "end": "973560"
  },
  {
    "text": "30 standard uh administrator passwords very simple things password one two3 admin rout uh the password list can be",
    "start": "973560",
    "end": "981120"
  },
  {
    "text": "modified keep in mind that using an enormous password dictionary something on the tune of tens of thousands of",
    "start": "981120",
    "end": "987880"
  },
  {
    "text": "passwords will will chew up your memory very quickly the default account is set to",
    "start": "987880",
    "end": "994720"
  },
  {
    "text": "administrator this was done on purpose the administrator account does not lock out if the client had set has a has a",
    "start": "994720",
    "end": "1002399"
  },
  {
    "text": "better account for you to use if you know that their web server their web administrator uses the account webmin or",
    "start": "1002399",
    "end": "1008560"
  },
  {
    "text": "web admin or mic then that would be of course the one you would use keep in mind that those accounts can be set to",
    "start": "1008560",
    "end": "1014480"
  },
  {
    "text": "be locked out again you can uh the tool allows you to save the log it",
    "start": "1014480",
    "end": "1020680"
  },
  {
    "text": "wouldn't be very useful to me if all I could do was look at it on the screen so you save the log to text print it up and",
    "start": "1020680",
    "end": "1025798"
  },
  {
    "text": "add it to your scanning reports screen capture during operation they're more interesting ones on the uh on the",
    "start": "1025799",
    "end": "1033480"
  },
  {
    "text": "website now what I didn't cover is that the tool is built for and only runs",
    "start": "1033480",
    "end": "1039360"
  },
  {
    "text": "against i-based uh web servers I didn't make any modifications to support front",
    "start": "1039360",
    "end": "1045120"
  },
  {
    "text": "page Apache as the the authentication system and the processes are very different uh front page Apache uh uses Dez or",
    "start": "1045120",
    "end": "1053840"
  },
  {
    "text": "crypt function on the Unix side however they do store their passwords in individual files many times these",
    "start": "1053840",
    "end": "1060200"
  },
  {
    "text": "password files are accessible so I wouldn't be too surprised if in the next 3 to six weeks you happen to see a",
    "start": "1060200",
    "end": "1066160"
  },
  {
    "text": "version that supports Apache up on the website um there's also an opportunity",
    "start": "1066160",
    "end": "1071720"
  },
  {
    "text": "to to redesign it for generic front page access perhaps um the open Office guys",
    "start": "1071720",
    "end": "1076880"
  },
  {
    "text": "if they're listening are interested Ed in adding front page based access to the open Office Suite um and I'm all for",
    "start": "1076880",
    "end": "1083520"
  },
  {
    "text": "rebuilding it something a little faster than uh Pearl gtk support for uploading content is",
    "start": "1083520",
    "end": "1089679"
  },
  {
    "text": "very close uh there's a few Unicode based uh characters that Microsoft puts in but once all of that's been cleared",
    "start": "1089679",
    "end": "1095840"
  },
  {
    "text": "up I don't see uh I don't see it taking very long all the code is available at the",
    "start": "1095840",
    "end": "1102480"
  },
  {
    "text": "website it's on your Defcon CD but I recommend you go to the website uh tomorrow the code will be on locked once",
    "start": "1102480",
    "end": "1108799"
  },
  {
    "text": "I've got uh access to a console um I recommend you go and download that if you plan on using it that's where the",
    "start": "1108799",
    "end": "1114760"
  },
  {
    "text": "latest uh code will be so let's say you've",
    "start": "1114760",
    "end": "1120760"
  },
  {
    "text": "gained access to front page and you're looking at the next steps in other words",
    "start": "1120760",
    "end": "1127200"
  },
  {
    "text": "where uh where do you go from here the little session we're going to",
    "start": "1127200",
    "end": "1132760"
  },
  {
    "text": "call ASP for hackers uh active server Pages have been around for quite a while",
    "start": "1132760",
    "end": "1138120"
  },
  {
    "text": "um and as you if you ever take the time or taken the time to develop any web- based content ASP is much like PHP it",
    "start": "1138120",
    "end": "1146159"
  },
  {
    "text": "gives you a lot of options gives you a lot of uh areas you can exploit you can build some rather impressive",
    "start": "1146159",
    "end": "1152559"
  },
  {
    "text": "Administration and control system straight from a web page one of the first tools I'm going to talk about is",
    "start": "1152559",
    "end": "1159720"
  },
  {
    "text": "uh tool I discovered out on ASP Alliance uh Michael Brinkley uh developed it real",
    "start": "1159720",
    "end": "1165320"
  },
  {
    "text": "real nice guy his uh tool sets rather uh exensive the SQL Server it's a SQL",
    "start": "1165320",
    "end": "1171120"
  },
  {
    "text": "Server database uh tool if you've ever administered or accessed SQL servers you've gone at them using query analyzer",
    "start": "1171120",
    "end": "1178320"
  },
  {
    "text": "most of us folks are command line driven types and query analyzer allows you to go in and execute all of the",
    "start": "1178320",
    "end": "1184080"
  },
  {
    "text": "administrative queries you would want to do adding accounts removing users uh analyzing the data what SQL",
    "start": "1184080",
    "end": "1193120"
  },
  {
    "text": "ultimate allows you to do is it allows you to run a query analyzer session directly out of your web browser",
    "start": "1193120",
    "end": "1199039"
  },
  {
    "text": "um once you've used your front page exploiter to find a vulnerable server you've logged in and uploaded uh SQL",
    "start": "1199039",
    "end": "1205960"
  },
  {
    "text": "altimate you'll find you're able to access administer and control internal SQL Server databases as most",
    "start": "1205960",
    "end": "1212240"
  },
  {
    "text": "administrators do place the sa account embedded in the ASP code already on their",
    "start": "1212240",
    "end": "1218760"
  },
  {
    "text": "site SQL analyzer to give you some some suggestions some uh some interesting",
    "start": "1218760",
    "end": "1224320"
  },
  {
    "text": "things to try adding SQL users is very simple uh most of the time you are part of the sa role accessing corporate data",
    "start": "1224320",
    "end": "1231840"
  },
  {
    "text": "accessing the back end to web applications can also be very powerful uh you can execute extended store",
    "start": "1231840",
    "end": "1238480"
  },
  {
    "text": "procedures as well as locate application accounts and passwords here's a screen capture uh of",
    "start": "1238480",
    "end": "1246240"
  },
  {
    "text": "SQL ultimate you'll see the query window on the left and the uh resulting window",
    "start": "1246240",
    "end": "1252760"
  },
  {
    "text": "on the right uh go ahead go over to uh asp alliance.com and check out uh check",
    "start": "1252760",
    "end": "1259400"
  },
  {
    "text": "out the stuff that was put together by uh by Michael he's really done a lot of great uh a lot of great work he was very",
    "start": "1259400",
    "end": "1265200"
  },
  {
    "text": "amenable to me putting it up here uh like I said there's the link for",
    "start": "1265200",
    "end": "1270240"
  },
  {
    "text": "the ASP Alliance site let's talk about uh command line",
    "start": "1270240",
    "end": "1278320"
  },
  {
    "text": "ASP this is an old one it's been out for quite a while but there are still some some folks that don't know about it um",
    "start": "1278320",
    "end": "1285200"
  },
  {
    "text": "I'm going to butcher this this poor guy's name uh or girl's name uh m is what I'm going to try uh this",
    "start": "1285200",
    "end": "1291480"
  },
  {
    "text": "tool allows for the execution of simple commands on the command line it's just",
    "start": "1291480",
    "end": "1297559"
  },
  {
    "text": "that basic some of the more interesting things you can do with it to net stat minus a net stat minus n create your own",
    "start": "1297559",
    "end": "1305520"
  },
  {
    "text": "makeshift uh reverse DNS lookup do a net stat minus a get the names do a net stat",
    "start": "1305520",
    "end": "1311039"
  },
  {
    "text": "minus n get the numbers match the ports and you've got kind of a makeshift reverse",
    "start": "1311039",
    "end": "1317039"
  },
  {
    "text": "DNS you can do an IP config you can do a ver you can do a set users you can net",
    "start": "1317039",
    "end": "1322559"
  },
  {
    "text": "users net local group remember that your the account permissions that you have",
    "start": "1322559",
    "end": "1327760"
  },
  {
    "text": "typically on a site are when you when you've cracked a site or something like local system however if you built your",
    "start": "1327760",
    "end": "1334840"
  },
  {
    "text": "own front page site and you set that site to require",
    "start": "1334840",
    "end": "1340279"
  },
  {
    "text": "authentication the account you log in with is the account you execute these",
    "start": "1340279",
    "end": "1345799"
  },
  {
    "text": "as front page exploiter helps us find vulnerable web servers command as. ASP",
    "start": "1345799",
    "end": "1352880"
  },
  {
    "text": "contains custom code to execute simple console commands now like I said before",
    "start": "1352880",
    "end": "1358039"
  },
  {
    "text": "you can use a netstat minus a or a netstat minus a to make a Mak shift",
    "start": "1358039",
    "end": "1363440"
  },
  {
    "text": "reverse DNS you can use net local group and net view to understand drive",
    "start": "1363440",
    "end": "1368760"
  },
  {
    "text": "mappings and groups uh it's very it's a very uh very powerful option in fact",
    "start": "1368760",
    "end": "1373880"
  },
  {
    "text": "many clients in the past have had their web server mapped to multiple internal files file servers to make retrieving",
    "start": "1373880",
    "end": "1379840"
  },
  {
    "text": "documents on the website much easier uh as well as using ping and uh to find",
    "start": "1379840",
    "end": "1385480"
  },
  {
    "text": "additional servers there's a screen capture of the command ASP tool in",
    "start": "1385480",
    "end": "1390559"
  },
  {
    "text": "action uh it's very simple punch in the command and hit go and you'll have the results passed back to you in",
    "start": "1390559",
    "end": "1396960"
  },
  {
    "text": "HTML the code is not available at my side of course it's available at secure",
    "start": "1396960",
    "end": "1403600"
  },
  {
    "text": "team.com ASP code uh uh can be used in conjunction with the with windside",
    "start": "1405480",
    "end": "1411360"
  },
  {
    "text": "controls to provide scanning from the web server what I'm what I'm talking about here is there are a lot of other options i' I've just mentioned two",
    "start": "1411360",
    "end": "1418320"
  },
  {
    "text": "there's a lot of other things you can use uh ASP code for you can upload controls Microsoft as well as a lot of",
    "start": "1418320",
    "end": "1425240"
  },
  {
    "text": "other companies developed web- based controls to do any manner of things and one of which would be a windsock control",
    "start": "1425240",
    "end": "1431559"
  },
  {
    "text": "perhaps programmet scan the internal network uh there's been some really",
    "start": "1431559",
    "end": "1436640"
  },
  {
    "text": "fascinating work being done uh with asp.net for uh samb shares and remote",
    "start": "1436640",
    "end": "1443080"
  },
  {
    "text": "Administration uh you can use that tool to reach out and do the same sorts of rightclick administer sort of uh",
    "start": "1443080",
    "end": "1449440"
  },
  {
    "text": "activities you would do on the internal Network in addition you can use the ASP",
    "start": "1449440",
    "end": "1455880"
  },
  {
    "text": "uh code and an XML HTTP control to proxy surf the intranet this was uh at a",
    "start": "1455880",
    "end": "1462200"
  },
  {
    "text": "previous client this was beneficial as the client had mounted uh web- based",
    "start": "1462200",
    "end": "1467240"
  },
  {
    "text": "cameras in their internet to provide security monitoring for their employees",
    "start": "1467240",
    "end": "1472279"
  },
  {
    "text": "so it was very interesting to be able to watch their employees go about their dailying",
    "start": "1472279",
    "end": "1477880"
  },
  {
    "text": "business we're going to close a little early today I think I want to I want to",
    "start": "1478520",
    "end": "1483720"
  },
  {
    "text": "get the attorney's mad at me um we're going to talk about holding down the Ford uh how do you secure uh front",
    "start": "1483720",
    "end": "1492919"
  },
  {
    "text": "page you use simple simple best practices as in most systems your first",
    "start": "1492919",
    "end": "1499440"
  },
  {
    "text": "last and primary line of defense is your password front page really is no different you want to choose strong",
    "start": "1499440",
    "end": "1506960"
  },
  {
    "text": "passwords consisting of upper and lowercase characters numbers special characters we let's make it something a",
    "start": "1506960",
    "end": "1513640"
  },
  {
    "text": "little more difficult than dog cat password girlfriend's name I prefer you stick with passwords over eight",
    "start": "1513640",
    "end": "1519799"
  },
  {
    "text": "characters in length and we can go into a lengthy discussion about well it only uses the first seven then you know if",
    "start": "1519799",
    "end": "1525480"
  },
  {
    "text": "you have a 14 character password it's really like to that being said passwords eight",
    "start": "1525480",
    "end": "1530919"
  },
  {
    "text": "characters in link typically they're easy enough to remember you've got you have to remember your own phone number",
    "start": "1530919",
    "end": "1536200"
  },
  {
    "text": "and that's seven characters in the length so what's one more change the admin account contrary",
    "start": "1536200",
    "end": "1543000"
  },
  {
    "text": "to popular belief Microsoft actually encourages you to change the administrator the name of the",
    "start": "1543000",
    "end": "1548039"
  },
  {
    "text": "administrator account it will not break all uh functions it won't cause the machine to explode um choose meaningful",
    "start": "1548039",
    "end": "1555919"
  },
  {
    "text": "choose a meaningful admin account but avoid typical choices like rute admin",
    "start": "1555919",
    "end": "1561799"
  },
  {
    "text": "supervisor boss concept of lease privilege only",
    "start": "1561799",
    "end": "1570039"
  },
  {
    "text": "provide the access necessary to get the job done use uh front page roles to",
    "start": "1570039",
    "end": "1576120"
  },
  {
    "text": "assign users uh author rights versus admin rights in fact if there is no",
    "start": "1576120",
    "end": "1582600"
  },
  {
    "text": "reason to have the administrator account have front page access then pull it within front front page there is a the",
    "start": "1582600",
    "end": "1589399"
  },
  {
    "text": "front page has its own set of permissions use the front page permissions tool to add or remove",
    "start": "1589399",
    "end": "1594559"
  },
  {
    "text": "accounts as needed pull the administrator account or reserve it for or reserve the front page Administration",
    "start": "1594559",
    "end": "1600640"
  },
  {
    "text": "rights for specific accounts your best option and this is my personal favorite is remind your",
    "start": "1600640",
    "end": "1606799"
  },
  {
    "text": "employees significant other girlfriend family members that you don't use front",
    "start": "1606799",
    "end": "1611880"
  },
  {
    "text": "page from just anywhere you use it when you are in your corporate office environment VPN",
    "start": "1611880",
    "end": "1618399"
  },
  {
    "text": "um secure area by that I recommend using the IP",
    "start": "1618399",
    "end": "1624799"
  },
  {
    "text": "based restrictions that are native to I go and take the admin author and VPC",
    "start": "1624799",
    "end": "1631480"
  },
  {
    "text": "files and set those to only be allowed uh access from internal IP addresses",
    "start": "1631480",
    "end": "1637320"
  },
  {
    "text": "only uh consider segmenting your web developers onto a separate segment of your network and allowing that group",
    "start": "1637320",
    "end": "1643360"
  },
  {
    "text": "access to those dl's only all right",
    "start": "1643360",
    "end": "1649520"
  },
  {
    "text": "there's the site I don't have a lot of artistic talent unlike uh some of the",
    "start": "1650320",
    "end": "1655440"
  },
  {
    "text": "other folks here so um it's pretty plain but it contains the code and the commentary and the uh all of the tools",
    "start": "1655440",
    "end": "1663600"
  },
  {
    "text": "packaged both in typical tari Zips or RPMs",
    "start": "1663600",
    "end": "1669919"
  },
  {
    "text": "uh I want to thank uh some of the guys who came before me there's a bunch of front page hacking texts out there on",
    "start": "1669919",
    "end": "1675760"
  },
  {
    "text": "the internet some of them are are more uh some of them are more pertinent than",
    "start": "1675760",
    "end": "1681720"
  },
  {
    "text": "others at this point but I've included a link to one of them there the guys over at the Pearl gtk tutorial it had been a",
    "start": "1681720",
    "end": "1687960"
  },
  {
    "text": "long time since i' done anything with gtk it was good to get up to speed and uh Microsoft's put together a pretty big",
    "start": "1687960",
    "end": "1694159"
  },
  {
    "text": "site devoted entirely to um front page it tends to tends to rotate and move around so you got to pay attention to",
    "start": "1694159",
    "end": "1700640"
  },
  {
    "text": "where it is but they've got a lot of the backend processes mapped they talk a lot about uh some of the vti information",
    "start": "1700640",
    "end": "1706840"
  },
  {
    "text": "that gets past back and forth we'll close with the uh thanks of",
    "start": "1706840",
    "end": "1713240"
  },
  {
    "text": "course uh my lovely wife uh my boss uh is a Shameless attempt to get a race um",
    "start": "1713240",
    "end": "1722120"
  },
  {
    "text": "the graphics designer who who did the image uh Mike Deandrea he's a uh",
    "start": "1722120",
    "end": "1727519"
  },
  {
    "text": "resident blender head does a lot of this kind of stuff I could never have come up with anything like that Steve uh ble who did the technical",
    "start": "1727519",
    "end": "1735840"
  },
  {
    "text": "review and the guys over at the yeah gtk tutorial put up with my emails all right if you got any",
    "start": "1735840",
    "end": "1742240"
  },
  {
    "text": "questions otherwise um I I do want to seed the pool that the best question",
    "start": "1742240",
    "end": "1748880"
  },
  {
    "text": "does happen to get one of these cellular PC cards they won't let",
    "start": "1748880",
    "end": "1754519"
  },
  {
    "text": "me keep it so I have to give it out to someone with a informative and entertaining question y you said the",
    "start": "1754519",
    "end": "1762519"
  },
  {
    "text": "authentication system the version of page",
    "start": "1762519",
    "end": "1769320"
  },
  {
    "text": "system it isn't you're close um the difference is the way the information is",
    "start": "1778399",
    "end": "1784279"
  },
  {
    "text": "passed front page uses a has a vti specific header it doesn't use the",
    "start": "1784279",
    "end": "1789720"
  },
  {
    "text": "typical ntlm header so when you go to a website and log in with you say you've got a Microsoft an is site and the site",
    "start": "1789720",
    "end": "1796919"
  },
  {
    "text": "has uh authentication required the author the authorization string is passed back and forth as just an ntlm",
    "start": "1796919",
    "end": "1802640"
  },
  {
    "text": "authorization on the front page side they've got their own bti headers in embedded in that it's from from the",
    "start": "1802640",
    "end": "1809279"
  },
  {
    "text": "standpoint of Technology it's very similar or from the standpoint of uh the headers in the exact style of the",
    "start": "1809279",
    "end": "1814840"
  },
  {
    "text": "information that's passed back and forth it's different good",
    "start": "1814840",
    "end": "1819559"
  },
  {
    "text": "question you know I I wish I could answer that um I haven't had a lot of exposure to theet platform I know that",
    "start": "1823000",
    "end": "1829760"
  },
  {
    "text": "they kept that front pages used uh on both XP and the 2003 server I know the",
    "start": "1829760",
    "end": "1836039"
  },
  {
    "text": "dlls have not changed they're all the same the tool really hasn't changed a lot in the last five or six years and",
    "start": "1836039",
    "end": "1843039"
  },
  {
    "text": "with 32,000 of them deployed on last Google search It's remarkable that it",
    "start": "1843039",
    "end": "1848320"
  },
  {
    "text": "hasn't been more um more followed than it has",
    "start": "1848320",
    "end": "1854600"
  },
  {
    "text": "yeah",
    "start": "1856240",
    "end": "1859240"
  },
  {
    "text": "well then most likely whatever the same the same rules would apply",
    "start": "1865320",
    "end": "1872279"
  },
  {
    "text": "MH",
    "start": "1886159",
    "end": "1889159"
  },
  {
    "text": "well the the biggest uh vulnerability it's good question the question was what's the um what are the what's the",
    "start": "1895440",
    "end": "1902200"
  },
  {
    "text": "real problem besides passwords and access with the front page if I think I've got that right",
    "start": "1902200",
    "end": "1907720"
  },
  {
    "text": "um the real problem is it's typically not configured it's typically deployed right out of the box and the first",
    "start": "1907720",
    "end": "1914639"
  },
  {
    "text": "person to request access for it someone goes in and sets it to access to everyone and immediately within within a",
    "start": "1914639",
    "end": "1921679"
  },
  {
    "text": "few weeks that's forgotten and the site exists it's what's interesting is it's",
    "start": "1921679",
    "end": "1926919"
  },
  {
    "text": "not more heavily scanned for it's not more heavily detected uh the I scanners I think will tell you if there's a front",
    "start": "1926919",
    "end": "1933559"
  },
  {
    "text": "page enabled site but they won't go any further than that they won't tell you if it's got a weak password or missing an account or the everyone account is",
    "start": "1933559",
    "end": "1939919"
  },
  {
    "text": "configured yeah that probably the biggest problem",
    "start": "1939919",
    "end": "1949080"
  },
  {
    "text": "yeah and and and honestly the the guys I wouldn't worry as much about in a professional opinion the guys I wouldn't",
    "start": "1954960",
    "end": "1960320"
  },
  {
    "text": "worry as much about are the guys that go in and modify your site I you know someone goes and modifies my main page I'm probably going to figure that out",
    "start": "1960320",
    "end": "1966120"
  },
  {
    "text": "pretty pretty quickly when my wife significant other family member calls and and asks me what the heck this is",
    "start": "1966120",
    "end": "1972279"
  },
  {
    "text": "but the guys I'm worry more about are the ones that slip copies of some of these asp tools deep down in my site",
    "start": "1972279",
    "end": "1978639"
  },
  {
    "text": "rename them to make them sound like there's something that should be on my site and it takes me weeks or a wellc",
    "start": "1978639",
    "end": "1983679"
  },
  {
    "text": "configured trip wire like configuration to even find them um that's where the that's where the real power is that's",
    "start": "1983679",
    "end": "1989559"
  },
  {
    "text": "where the real uh the real risk is yeah can you speak to of",
    "start": "1989559",
    "end": "1995960"
  },
  {
    "text": "ofab that exage ASAT",
    "start": "1995960",
    "end": "2001799"
  },
  {
    "text": "as yeah there are there are some in the cast you could go to the vti CNF file",
    "start": "2003679",
    "end": "2010120"
  },
  {
    "text": "for each directory and of course it would give you a directory listing it would allow you to to execute different content from there I found though I I",
    "start": "2010120",
    "end": "2017840"
  },
  {
    "text": "went through and one of the links that was in here spoke about a lot of the different a lot of those older exploits",
    "start": "2017840",
    "end": "2023240"
  },
  {
    "text": "however from 2K forward a lot of those rules do not apply any longer and as the majority of the clients I was running",
    "start": "2023240",
    "end": "2029799"
  },
  {
    "text": "into were 2K or we're beta testing 03 um I didn't spend the additional time to go",
    "start": "2029799",
    "end": "2036600"
  },
  {
    "text": "in and review those if you have a client that's on an nt4 or even you know for all extensive purposes an me or Windows",
    "start": "2036600",
    "end": "2042919"
  },
  {
    "text": "98 it might be worthwhile to go back and take a look at that uh however a lot of those rules don't apply any longer so so",
    "start": "2042919",
    "end": "2050320"
  },
  {
    "text": "most of them most of the older vulnerabilities are information Le from",
    "start": "2050320",
    "end": "2055520"
  },
  {
    "text": "what I saw yeah most of the most the older vulnerabilities were there were information leakage or directory scanning or and remember that that what",
    "start": "2055520",
    "end": "2063240"
  },
  {
    "text": "I'm what what I really want to hit on is the tool gets configured in insted and enabled more often than not 32,000 sites",
    "start": "2063240",
    "end": "2070358"
  },
  {
    "text": "on a Google search is enough to kind of make make your head spin and when it's",
    "start": "2070359",
    "end": "2075480"
  },
  {
    "text": "there more often than not it's completely misconfigured what what you'll find what you find I'm sure in",
    "start": "2075480",
    "end": "2081520"
  },
  {
    "text": "doing this kind of work is that it's not so much vulnerabilities in systems as",
    "start": "2081520",
    "end": "2086679"
  },
  {
    "text": "it's vulnerabilities in people's ability to manage systems that cause",
    "start": "2086679",
    "end": "2091919"
  },
  {
    "text": "problems all right",
    "start": "2091960",
    "end": "2097400"
  },
  {
    "text": "it's a good question here you",
    "start": "2097400",
    "end": "2100838"
  },
  {
    "text": "go yeah go on and enjoy Vegas all [Applause]",
    "start": "2106680",
    "end": "2118170"
  },
  {
    "text": "right",
    "start": "2125800",
    "end": "2128800"
  },
  {
    "text": "e",
    "start": "2155800",
    "end": "2158800"
  },
  {
    "text": "e",
    "start": "2215680",
    "end": "2218680"
  },
  {
    "text": "e",
    "start": "2275599",
    "end": "2278599"
  }
]