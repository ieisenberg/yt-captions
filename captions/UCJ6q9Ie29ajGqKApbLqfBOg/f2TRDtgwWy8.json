[
  {
    "start": "0",
    "end": "117000"
  },
  {
    "text": "so with no further ado uh flowers for automated malware analysis uh chen yoo",
    "start": "240",
    "end": "5279"
  },
  {
    "text": "song and paul royal thank you",
    "start": "5279",
    "end": "11519"
  },
  {
    "text": "so",
    "start": "11519",
    "end": "14519"
  },
  {
    "text": "so i'm paul royal i'm a research scientist at the georgia tech information security center this",
    "start": "17760",
    "end": "24160"
  },
  {
    "text": "is ching yu song he's a phd candidate at the college of computing at the georgia institute of technology",
    "start": "24160",
    "end": "30640"
  },
  {
    "text": "under the advisement of dr winky lee and today we are going to talk about",
    "start": "30640",
    "end": "36399"
  },
  {
    "text": "anti-automated malware analysis techniques that if ubiquitously implemented could mean",
    "start": "36399",
    "end": "42960"
  },
  {
    "text": "flowers for automated malware analysis so we're going to start by providing a",
    "start": "42960",
    "end": "48559"
  },
  {
    "text": "very brief overview of modern malware much of the material will probably be remedial for most in the audience",
    "start": "48559",
    "end": "55199"
  },
  {
    "text": "and then we will dive into a history of malware analysis technologies to",
    "start": "55199",
    "end": "60719"
  },
  {
    "text": "determine how defensive tools have responded to changes in the threat landscape",
    "start": "60719",
    "end": "66400"
  },
  {
    "text": "and with that as a motivating segway we will begin talking about the fundamental",
    "start": "66400",
    "end": "72320"
  },
  {
    "text": "nature of the detection detection prevention arms race and the possibility of inverting that model in a way that",
    "start": "72320",
    "end": "79439"
  },
  {
    "text": "again if ubiquitously adopted would permanently disadvantage the process of",
    "start": "79439",
    "end": "84560"
  },
  {
    "text": "automated malware analysis i'll then turn the talk over to",
    "start": "84560",
    "end": "90799"
  },
  {
    "text": "ching yu who will discuss in greater detail the techniques we have devised",
    "start": "90799",
    "end": "97040"
  },
  {
    "text": "and then provide some discussion of them including the particulars of their operational security",
    "start": "97040",
    "end": "102400"
  },
  {
    "text": "as well as potential countermeasures we will then provide briefly some",
    "start": "102400",
    "end": "107680"
  },
  {
    "text": "concluding remarks and open the floor to questions modern malware",
    "start": "107680",
    "end": "114960"
  },
  {
    "text": "is the centerpiece of current threats to the internet it's used to build botnets it's responsible for over 90 percent of",
    "start": "114960",
    "end": "122399"
  },
  {
    "start": "117000",
    "end": "117000"
  },
  {
    "text": "the unsolicited email we receive it's used to steal information and can sometimes directly be involved in the",
    "start": "122399",
    "end": "129200"
  },
  {
    "text": "financial fraud committed using the theft of that information malware is used to build",
    "start": "129200",
    "end": "136000"
  },
  {
    "text": "is used by real criminals to build criminal infrastructure that collectively acts in the domain of",
    "start": "136000",
    "end": "141520"
  },
  {
    "text": "organized crime in what has become a multi-billion dollar shadow economy",
    "start": "141520",
    "end": "146560"
  },
  {
    "text": "there is thus a need pronounced need to understand the behavior of malicious software",
    "start": "146560",
    "end": "152160"
  },
  {
    "start": "149000",
    "end": "149000"
  },
  {
    "text": "to discover to the extent possible automatically new threats to identify assets compromised by those",
    "start": "152160",
    "end": "159040"
  },
  {
    "text": "threats to determine what happened after compromise occurred and ultimately a store affected sorry restore affected",
    "start": "159040",
    "end": "165280"
  },
  {
    "text": "assets back to their benign working condition of course there's a lot of money involved which means that malware",
    "start": "165280",
    "end": "171280"
  },
  {
    "text": "authors have direct financial incentivization to make this process difficult",
    "start": "171280",
    "end": "177840"
  },
  {
    "text": "one of the earliest anti-analysis which is almost more of an anti-reverse engineering technique",
    "start": "178080",
    "end": "183680"
  },
  {
    "text": "is was often referred to as packing more generally obfuscation and",
    "start": "183680",
    "end": "188959"
  },
  {
    "text": "in this overview which is somewhat grossly oversimplified program a which can be malware is run",
    "start": "188959",
    "end": "196720"
  },
  {
    "text": "through an obfuscation tool to produce program a prime and the machine code in program a is encrypted compressed or",
    "start": "196720",
    "end": "203840"
  },
  {
    "text": "otherwise transformed into seemingly benign data and that is coupled together with a small amount of code that at",
    "start": "203840",
    "end": "210480"
  },
  {
    "text": "runtime will reverse this transformation of course uh the actual obfuscation",
    "start": "210480",
    "end": "215680"
  },
  {
    "text": "technique can be considerably more complex and in some cases novel four years ago i and another researcher",
    "start": "215680",
    "end": "222560"
  },
  {
    "text": "participated in defcon 16's race to zero contest this was a contest where",
    "start": "222560",
    "end": "228159"
  },
  {
    "text": "participants were given known detected malware and required to transform it in a way such that it still behaved",
    "start": "228159",
    "end": "234560"
  },
  {
    "text": "maliciously but was no longer detected as malicious for that purpose we created a tool that",
    "start": "234560",
    "end": "240239"
  },
  {
    "text": "we we never released or shared but used to compete in the contest and to",
    "start": "240239",
    "end": "245280"
  },
  {
    "text": "demonstrate the efficacy of this tool i took an old in the wild by froze bot malware sample and uploaded",
    "start": "245280",
    "end": "252319"
  },
  {
    "text": "it to virustotal and as you can see from the screen the sample has almost 100 detections i",
    "start": "252319",
    "end": "259680"
  },
  {
    "text": "then use the zero pack tool we had created to obfuscate the sample and uploaded the zero pack obfuscated",
    "start": "259680",
    "end": "265759"
  },
  {
    "text": "version to virustotal and uh the sample again does not behave",
    "start": "265759",
    "end": "271040"
  },
  {
    "text": "uh in a benign manner it still behaves maliciously just looks different differently enough to the point where detections go from almost 100 percent",
    "start": "271040",
    "end": "277919"
  },
  {
    "text": "down to zero attackers have gotten good at this type of obfuscation they've been able to",
    "start": "277919",
    "end": "284720"
  },
  {
    "text": "automate it uh at the server side it's called server-side polymorphism in the traditional host-based anti-virus",
    "start": "284720",
    "end": "291280"
  },
  {
    "text": "model there's a point in time on the left-most portion of the the top figure of this slide where malware is authored",
    "start": "291280",
    "end": "298000"
  },
  {
    "text": "and then a point in time where it is released and then assuming that it is not automatically detected by existing",
    "start": "298000",
    "end": "303120"
  },
  {
    "text": "signatures or heuristic detections some small amount of time it can be as little as",
    "start": "303120",
    "end": "308240"
  },
  {
    "text": "12 hours or less or as as much as days where detections are created for this",
    "start": "308240",
    "end": "314800"
  },
  {
    "text": "particular malware type or perhaps other members of the same family and detections are pushed out",
    "start": "314800",
    "end": "320320"
  },
  {
    "text": "in server-side polymorphism shortly after mallory is installed on a system the malware sample will",
    "start": "320320",
    "end": "327039"
  },
  {
    "text": "connect to the command and control and request an update and that update won't necessarily behave differently but it",
    "start": "327039",
    "end": "332560"
  },
  {
    "text": "would look differently sometimes dramatically different and so",
    "start": "332560",
    "end": "337680"
  },
  {
    "text": "by the time a given version of malware is detected say version n that version is no longer on people's",
    "start": "337680",
    "end": "344080"
  },
  {
    "text": "systems it's long since updated to version n plus one or n plus two or n plus k for some arbitrarily large",
    "start": "344080",
    "end": "350800"
  },
  {
    "text": "integer k and when this is done professionally by by professional malware authors you",
    "start": "350800",
    "end": "358000"
  },
  {
    "text": "get detections that look a bit like those of the walladec botnet to highlight walladec's use of",
    "start": "358000",
    "end": "363440"
  },
  {
    "text": "server-side polymorphism i collected two waldex samples on different dates but uploaded them to",
    "start": "363440",
    "end": "368720"
  },
  {
    "text": "virustotal on the same day the first sample i collected at the end of 2008 the second sample i collected on the",
    "start": "368720",
    "end": "374800"
  },
  {
    "text": "same day that i uploaded both samples to scan so the first sample is well detected",
    "start": "374800",
    "end": "380400"
  },
  {
    "text": "detections are almost 90 percent second sample uh has much lower detections even though the two samples",
    "start": "380400",
    "end": "386800"
  },
  {
    "text": "as a function of their their execution semantics aren't really any different at all so in this case waldex use of",
    "start": "386800",
    "end": "392720"
  },
  {
    "text": "server-side polymorphism comprises a 60 performan sorry excuse me detection",
    "start": "392720",
    "end": "398000"
  },
  {
    "text": "efficacy delta for traditional host-based antivirus tools",
    "start": "398000",
    "end": "403600"
  },
  {
    "text": "another recent evolution we have seen in terms of obfuscations is the use of isa",
    "start": "403600",
    "end": "408800"
  },
  {
    "text": "virtualization in malware in isa virtualization a again a program",
    "start": "408800",
    "end": "414639"
  },
  {
    "text": "which may be malware is irrevocably transformed as a function of having its",
    "start": "414639",
    "end": "420800"
  },
  {
    "text": "machine code turned into byte code for an unknown arbitrary attacker decided language",
    "start": "420800",
    "end": "428560"
  },
  {
    "text": "so this would be analogous to converting into something that's like flash by code or java by code except you don't know",
    "start": "428560",
    "end": "433840"
  },
  {
    "text": "the execution semantics of the isa this bytecode is coupled together with an interpreter that will execute on the",
    "start": "433840",
    "end": "440160"
  },
  {
    "text": "x86 platform and the original intentions are the intentions of the original program are fulfilled by the interpreter",
    "start": "440160",
    "end": "447680"
  },
  {
    "text": "interpreting the bytecode that has been bundled so now that we have um",
    "start": "447680",
    "end": "454319"
  },
  {
    "text": "now that we're all on the same page with regards to what the parts of the modern threat landscape look like let's uh",
    "start": "454319",
    "end": "460400"
  },
  {
    "text": "let's briefly review how defenders have have handled these evolutions",
    "start": "460400",
    "end": "466080"
  },
  {
    "text": "in the beginning there were in-guest tools that would perform automated analysis of suspect samples or known",
    "start": "466080",
    "end": "472639"
  },
  {
    "text": "malicious samples and given that they were in-guest tools they would reside in the same",
    "start": "472639",
    "end": "477680"
  },
  {
    "text": "environment as their analysis target and in many cases this made them vulnerable to the detection of the monitoring",
    "start": "477680",
    "end": "484160"
  },
  {
    "text": "instrumentation they had to use in order to record and condense the actions of a",
    "start": "484160",
    "end": "491039"
  },
  {
    "text": "sample or process of interest and if you perform one of the most straightforward implementations of say",
    "start": "491039",
    "end": "497680"
  },
  {
    "text": "windows api hooking what you will do is use the windows debugging api to receive notification of",
    "start": "497680",
    "end": "504960"
  },
  {
    "text": "dll load events and uh when you receive that notification and again that's a that's a dll being loaded into the",
    "start": "504960",
    "end": "512080"
  },
  {
    "text": "malware sample as it's executing you will look at the export table of that dll and you will go to each of those",
    "start": "512080",
    "end": "518479"
  },
  {
    "text": "functions that have been exported and place an unconditional jump at the start of them that will trampoline into a",
    "start": "518479",
    "end": "523760"
  },
  {
    "text": "patch of analysis code the problem is that you have created hooks that you cannot hide if you choose the most",
    "start": "523760",
    "end": "530320"
  },
  {
    "text": "straightforward implementation and so what you see on this slide at the bottom is a small block of c code that",
    "start": "530320",
    "end": "537600"
  },
  {
    "text": "will take a function that is likely to be hooked by such tools and it will get",
    "start": "537600",
    "end": "543120"
  },
  {
    "text": "a byte a byte data pointer to the start of that function and then determine whether the",
    "start": "543120",
    "end": "549040"
  },
  {
    "text": "first two bytes correspond to the op codes of an unconditional jump",
    "start": "549040",
    "end": "554240"
  },
  {
    "text": "at some point people determined that they needed to get outside of the guest so that there was no internal monitoring",
    "start": "554720",
    "end": "560959"
  },
  {
    "text": "instrumentation to detect and so they started creating reduced privileged guest virtual machine monitor like",
    "start": "560959",
    "end": "567040"
  },
  {
    "start": "565000",
    "end": "565000"
  },
  {
    "text": "software components which would operate similar to vmware and these",
    "start": "567040",
    "end": "572399"
  },
  {
    "text": "prior to the introduction of hardware virtualization extensions would operate through a combination of sensitive data",
    "start": "572399",
    "end": "577920"
  },
  {
    "text": "structure relocation and binary software translation and the those were both done for reasons",
    "start": "577920",
    "end": "584160"
  },
  {
    "text": "of performance now reduced privileged guest virtual machine monitors are vulnerable to the",
    "start": "584160",
    "end": "589760"
  },
  {
    "text": "side effects they create for the purposes of enhancing performance and as as a concise example older versions of",
    "start": "589760",
    "end": "597279"
  },
  {
    "text": "vmware if you were to execute a program that contained the cis red instruction even if it was executed in ring three",
    "start": "597279",
    "end": "604080"
  },
  {
    "text": "will be treated as a noaa cisrep requires ring zero and thus should generate an exception so in this case",
    "start": "604080",
    "end": "610080"
  },
  {
    "text": "it's the difference of the presence of an exception that can be used to identify a reduced privileged guest",
    "start": "610080",
    "end": "615120"
  },
  {
    "text": "virtual machine monitor simultaneously some people decided to",
    "start": "615120",
    "end": "621680"
  },
  {
    "text": "get outside of the guest by modifying existing whole system emulators and a whole system emulator like qmu",
    "start": "621680",
    "end": "628320"
  },
  {
    "text": "ultimately has the responsibility of emulating the full isa of an x86",
    "start": "628320",
    "end": "633519"
  },
  {
    "text": "processor which is a very complex piece of hardware and the problem is that there are corner",
    "start": "633519",
    "end": "639680"
  },
  {
    "text": "cases where emulation is not correct and you can leverage the difference",
    "start": "639680",
    "end": "645519"
  },
  {
    "text": "to identify instances of what are basically unfaithful cpu emulation what you see at the bottom three panes",
    "start": "645519",
    "end": "653440"
  },
  {
    "text": "of this slide is basically a series of inline assembly that executes the iret d instruction",
    "start": "653440",
    "end": "659680"
  },
  {
    "text": "with the 0x26 prefix 0x26 is not a valid prefix for ira d so the combination of",
    "start": "659680",
    "end": "666160"
  },
  {
    "text": "these bytes when executed should produce an illegal instruction exception the exception will be",
    "start": "666160",
    "end": "673279"
  },
  {
    "text": "will be handed to the structured exception handler which is installed initially",
    "start": "673279",
    "end": "680160"
  },
  {
    "text": "and uh the execution of that structured exception handler begins the actual",
    "start": "680160",
    "end": "685600"
  },
  {
    "text": "execution of the malicious program in qmu something like iret d",
    "start": "685600",
    "end": "690880"
  },
  {
    "text": "is actually executed instead of an illegal instruction exception and the program will actually silently fail and",
    "start": "690880",
    "end": "697279"
  },
  {
    "text": "simply exit with no structured exception handler",
    "start": "697279",
    "end": "702440"
  },
  {
    "text": "so about four years ago people began investigating the use of hardware virtualization extensions to perform",
    "start": "702480",
    "end": "708880"
  },
  {
    "text": "malware analysis and these operate through again extensions to the x86 isa intel's",
    "start": "708880",
    "end": "715600"
  },
  {
    "start": "715000",
    "end": "715000"
  },
  {
    "text": "example is vtx amd's example is svm and uh these are represented as new",
    "start": "715600",
    "end": "721279"
  },
  {
    "text": "instructions like vmwa and vmstart and so forth and",
    "start": "721279",
    "end": "726480"
  },
  {
    "text": "what these effectively created was an additional ring of privilege like a ring negative one there was a vmx root mode",
    "start": "726480",
    "end": "732639"
  },
  {
    "text": "and a vmx non-root mode guess execute in vmx non-root mode and that includes the ability to execute",
    "start": "732639",
    "end": "739680"
  },
  {
    "text": "in ring zero in vmx non-root mode but of course there's a subset of x86",
    "start": "739680",
    "end": "745120"
  },
  {
    "text": "instructions that are fundamentally incompatible with virtualization and when these are executed a special event",
    "start": "745120",
    "end": "751680"
  },
  {
    "text": "will occur that drops back to vmx root mode and that event is called a vm exit",
    "start": "751680",
    "end": "756959"
  },
  {
    "text": "fundamentally if you have vm exits and you are the hypervisor you must handle them correctly and if there are any uh",
    "start": "756959",
    "end": "763120"
  },
  {
    "text": "implementation details you have omitted um that will cause execution inside the guest to fail and as a case in point uh",
    "start": "763120",
    "end": "772639"
  },
  {
    "text": "kvm a popular hardware virtualization extensions based virtualization container",
    "start": "772639",
    "end": "778720"
  },
  {
    "text": "and the version of kvm that shipped for example with debian lenny which was a stable version of debian through",
    "start": "778720",
    "end": "785120"
  },
  {
    "text": "february of last year had a bug in it where if you executed a vm read inside the guest instead of",
    "start": "785120",
    "end": "791839"
  },
  {
    "text": "throwing an exception saying that this should not be supported in sorry without vmx root mode",
    "start": "791839",
    "end": "797279"
  },
  {
    "text": "it or rather the entire guest crashed with an unhandled exception so not only is this a detection attack but it's also a",
    "start": "797279",
    "end": "804480"
  },
  {
    "text": "denial of service so what i've described previously",
    "start": "804480",
    "end": "809839"
  },
  {
    "text": "are really anecdotes that can actually be generalized into transparency",
    "start": "809839",
    "end": "815120"
  },
  {
    "text": "shortcomings and from those generalizations you can create a set of",
    "start": "815120",
    "end": "820639"
  },
  {
    "text": "formal transparency requirements that an analyzer must possess in order to be transparent to the malware that it is",
    "start": "820639",
    "end": "826800"
  },
  {
    "start": "822000",
    "end": "822000"
  },
  {
    "text": "analyzing so i'll briefly cover those the first is higher privilege that simply means that the",
    "start": "826800",
    "end": "833519"
  },
  {
    "text": "analyzer must have or operate at a higher privilege level than the malware is analyzing otherwise the malware can",
    "start": "833519",
    "end": "840480"
  },
  {
    "text": "detect its presence and even attack the analyzer the second requirement states that",
    "start": "840480",
    "end": "845519"
  },
  {
    "text": "basically it's okay to have side effects so long as access to access to them",
    "start": "845519",
    "end": "851680"
  },
  {
    "text": "is through privileged instructions at a higher privilege level that is preemptable by the analyzer",
    "start": "851680",
    "end": "858000"
  },
  {
    "text": "the third is same instruction execution semantics and that basically means that if i if i execute a",
    "start": "858000",
    "end": "864399"
  },
  {
    "text": "block of code inside a virtualization container with an analysis tool present must have the same semantic effect as if",
    "start": "864399",
    "end": "870240"
  },
  {
    "text": "the analyzer was not present the fourth identical exception handling",
    "start": "870240",
    "end": "876000"
  },
  {
    "text": "means that if the sample of interest creates an exception it must be handled and delivered to that sample",
    "start": "876000",
    "end": "882560"
  },
  {
    "text": "in the same way as if the analyzer was not present and the fifth requirement identical",
    "start": "882560",
    "end": "888240"
  },
  {
    "text": "notion of time simply means that there should be no reliably measurable unaccounted gaps in time that the",
    "start": "888240",
    "end": "894320"
  },
  {
    "text": "malware sample could use to infer the presence of an analyzer or an analysis environment",
    "start": "894320",
    "end": "900560"
  },
  {
    "text": "so if we look at how traditional tools stack up in guest tools because the because they reside in the",
    "start": "900560",
    "end": "907519"
  },
  {
    "text": "same environment as their analysis target do not have higher privilege emit",
    "start": "907519",
    "end": "912800"
  },
  {
    "text": "non-privileged side effects and often have exception handling issues due to the associated need for careful",
    "start": "912800",
    "end": "920079"
  },
  {
    "start": "917000",
    "end": "917000"
  },
  {
    "text": "implementation reduced privileged guests virtual machine monitors for reasons of performance often also emit",
    "start": "920079",
    "end": "925519"
  },
  {
    "text": "non-privileged side effects and whole system emulators like qmu or even simx which is a cycle",
    "start": "925519",
    "end": "931279"
  },
  {
    "text": "accurate cpu emulator suffer from a lack of identical instruction",
    "start": "931279",
    "end": "936959"
  },
  {
    "text": "execution semantics to make matters worse",
    "start": "936959",
    "end": "942079"
  },
  {
    "text": "detection techniques previously relegated for more sophisticated forms of malware our more technical malware",
    "start": "942079",
    "end": "947760"
  },
  {
    "text": "authors are now available to any novice cyber criminal and as an example if you look at the",
    "start": "947760",
    "end": "954560"
  },
  {
    "text": "first half of the slide you will see a subsection of a screenshot taken from a point-and-click do-it-yourself remote",
    "start": "954560",
    "end": "961040"
  },
  {
    "text": "access trojan generation kit this is the basically the analysis resistance section of that you can just",
    "start": "961040",
    "end": "967279"
  },
  {
    "text": "point and click your way into detecting a number of different popular virtualization containers used for",
    "start": "967279",
    "end": "972720"
  },
  {
    "text": "malware analysis and even circumvent certain sandboxes if you're a more sophisticated malware",
    "start": "972720",
    "end": "978800"
  },
  {
    "text": "author you may want to defer the process of making sure that you do not execute",
    "start": "978800",
    "end": "984480"
  },
  {
    "text": "an analysis environment to another specialist in the criminal underground who will make a tool that will provide",
    "start": "984480",
    "end": "990240"
  },
  {
    "text": "these detections for you and as an example you could paypal 50 usd to",
    "start": "990240",
    "end": "996320"
  },
  {
    "text": "rdg max at gmail.com and get a copy of rdg taijan crypter which as you can see",
    "start": "996320",
    "end": "1002720"
  },
  {
    "text": "from the screenshot contains detections for about 15 different virtualization containers and analysis environments",
    "start": "1002720",
    "end": "1009519"
  },
  {
    "text": "so the point of these screenshots is that uh malware analysis environment or tool",
    "start": "1009519",
    "end": "1015839"
  },
  {
    "text": "detection is now a standard and commoditized feature it no longer takes the technical",
    "start": "1015839",
    "end": "1021440"
  },
  {
    "text": "expertise it once did and it's very accessible when we look at popular malware",
    "start": "1021440",
    "end": "1028079"
  },
  {
    "text": "we will also find anti-analysis or anti-virtualization associated detections conficker checked",
    "start": "1028079",
    "end": "1034480"
  },
  {
    "text": "for a reload sorry a relocated local descriptor table which would detect reduced privileged guest virtual machine",
    "start": "1034480",
    "end": "1040319"
  },
  {
    "text": "monitors like vmware tdl4 will use the windows wmi query",
    "start": "1040319",
    "end": "1045918"
  },
  {
    "text": "language which is an sql-like language that can be used to interrogate a number of system features including the hardware to identify the presence of",
    "start": "1045919",
    "end": "1053039"
  },
  {
    "text": "device simulation it can be something as simple as a label that says qm your hard drive",
    "start": "1053039",
    "end": "1058240"
  },
  {
    "text": "bretta lab does functionally the same thing by directly interrogating the hard drive via the device i o control windows",
    "start": "1058240",
    "end": "1064960"
  },
  {
    "text": "api so what we've seen thus far",
    "start": "1064960",
    "end": "1072240"
  },
  {
    "text": "as a function of considering that we could actually invert the detection model is that until recently",
    "start": "1072240",
    "end": "1078960"
  },
  {
    "text": "malware was environment analysis aware it would look for a variety of virtualization",
    "start": "1078960",
    "end": "1084720"
  },
  {
    "text": "containers or analysis environments and in the absence of successful detections for those items",
    "start": "1084720",
    "end": "1091600"
  },
  {
    "start": "1088000",
    "end": "1088000"
  },
  {
    "text": "it would assume that it is not in an analysis environment and execute successfully",
    "start": "1091600",
    "end": "1097039"
  },
  {
    "start": "1097000",
    "end": "1097000"
  },
  {
    "text": "however there is no reason why malware could not be analysis environment",
    "start": "1097039",
    "end": "1102320"
  },
  {
    "text": "oblivious the inverted representation of the environment aware model which means that malware will bind",
    "start": "1102320",
    "end": "1109600"
  },
  {
    "text": "to and successfully execute only on the original infected host it will assume",
    "start": "1109600",
    "end": "1115039"
  },
  {
    "text": "any other environment in which it is executing as an analysis environment and will not execute successfully and this",
    "start": "1115039",
    "end": "1121520"
  },
  {
    "text": "exploits the observation that malware is overwhelmingly collected in one environment and executed in another and",
    "start": "1121520",
    "end": "1129919"
  },
  {
    "text": "as a case in point the georgia tech information security uh center which is you know just a small academic center",
    "start": "1129919",
    "end": "1136880"
  },
  {
    "text": "collects over 1 million new malware samples each month and new simply means unique by cryptographic",
    "start": "1136880",
    "end": "1143360"
  },
  {
    "text": "hash and previously unseen it's a very large volume about a hundred thousand of these",
    "start": "1143360",
    "end": "1149600"
  },
  {
    "text": "samples are collected through our own internal collection infrastructure the rest we get from malware exchanges and",
    "start": "1149600",
    "end": "1156960"
  },
  {
    "text": "client submissions and other such things that are effectively a representation of external collection",
    "start": "1156960",
    "end": "1164559"
  },
  {
    "text": "so the question is have we started to see or have we recently seen",
    "start": "1164559",
    "end": "1169679"
  },
  {
    "text": "malware that uses i'll bet even if in a primitive manner this inverted model and the answer is",
    "start": "1169679",
    "end": "1175440"
  },
  {
    "text": "yes flashback a large mac os x botnet which grew to about six hundred thousand",
    "start": "1175440",
    "end": "1181120"
  },
  {
    "text": "systems towards the end was propagated via drive-by downloads the drive by downloaded sorry excuse me the drive by",
    "start": "1181120",
    "end": "1187919"
  },
  {
    "start": "1187000",
    "end": "1187000"
  },
  {
    "text": "download was represented as a malicious jar file which contained two class files",
    "start": "1187919",
    "end": "1194240"
  },
  {
    "text": "which would exploit cve 2012 0507 and a small 40 kilobyte macho binary",
    "start": "1194240",
    "end": "1202000"
  },
  {
    "text": "and that macho binary via the exploit contained in the class files was installed and executed on the system but",
    "start": "1202000",
    "end": "1208960"
  },
  {
    "text": "that's not a full version of flashback that's actually an intermediate download agent",
    "start": "1208960",
    "end": "1214000"
  },
  {
    "text": "that agent would gather the hardware uuid and submit that to the command and control",
    "start": "1214000",
    "end": "1219840"
  },
  {
    "text": "along with a request for the full version the command and control would compute the hash in this case md5 of the",
    "start": "1219840",
    "end": "1226960"
  },
  {
    "text": "hardware uuid and by the way the hardware uuid which is available via a mac osx api uniquely identifies a",
    "start": "1226960",
    "end": "1234000"
  },
  {
    "text": "particular apple device like the laptop from which i'm presenting so it would again it would take the",
    "start": "1234000",
    "end": "1239120"
  },
  {
    "text": "hardware uuid hash it and use the md5sum as a decryption key into an rc string sorry",
    "start": "1239120",
    "end": "1246080"
  },
  {
    "text": "an rc4 stream cipher that would effectively bind the full flashback",
    "start": "1246080",
    "end": "1251120"
  },
  {
    "text": "version to the particular host that was compromised which means that if you were",
    "start": "1251120",
    "end": "1256400"
  },
  {
    "text": "to take a flashback sample from another infected mac and try and run it in a virtual machine or on another physical",
    "start": "1256400",
    "end": "1263360"
  },
  {
    "text": "system it would not run because the hardware uuids don't match the only way to successfully execute a",
    "start": "1263360",
    "end": "1269919"
  },
  {
    "text": "sample collector in that manner is to match the hardware uuid of the original infected system",
    "start": "1269919",
    "end": "1277399"
  },
  {
    "text": "so flashback put into motion a sequence of events",
    "start": "1277919",
    "end": "1283120"
  },
  {
    "text": "that unfortunately can be matured and may eventually become commoditized and",
    "start": "1283120",
    "end": "1288960"
  },
  {
    "text": "even ubiquitous so the question is how bad can things get so we can try and",
    "start": "1288960",
    "end": "1294240"
  },
  {
    "text": "prepare for the coming storm and to talk about some of the specific techniques we found in our exploration of of what",
    "start": "1294240",
    "end": "1301280"
  },
  {
    "text": "future versions of flashback like entities look like use this inverted model i'm going to turn the talk over to",
    "start": "1301280",
    "end": "1307520"
  },
  {
    "text": "my co-speaker ching yusung",
    "start": "1307520",
    "end": "1310960"
  },
  {
    "text": "thank you paul now i'm going to introduce how automated malware analysis can be defeated",
    "start": "1313600",
    "end": "1321200"
  },
  {
    "text": "let me first explain a little bit about our goal so automating malware analysis",
    "start": "1321520",
    "end": "1327200"
  },
  {
    "text": "techniques is basically created to handle the large volume of malware samples collected every day",
    "start": "1327200",
    "end": "1333919"
  },
  {
    "text": "and so our goal is not to make each sample unanalyzable but instead we're only to make this automated uh process",
    "start": "1333919",
    "end": "1342000"
  },
  {
    "text": "ineffective and unscalable and to do so we're going to leverage some techniques that was previously",
    "start": "1342000",
    "end": "1348640"
  },
  {
    "text": "reserved only for digital right management system and this works is because this dim for",
    "start": "1348640",
    "end": "1355360"
  },
  {
    "text": "malware is quite different from drm for legitimate software for legitimate software uh the dlm",
    "start": "1355360",
    "end": "1361600"
  },
  {
    "text": "system has to protect every copy of their protected content",
    "start": "1361600",
    "end": "1366960"
  },
  {
    "text": "and even one copy get cracked that copy can be widely distributed and that means",
    "start": "1366960",
    "end": "1372320"
  },
  {
    "text": "the protection is broken but for malware because every sample is protected by its own dlm",
    "start": "1372320",
    "end": "1379120"
  },
  {
    "text": "system and you have to analyze this every sample that means you have to crack every each sample and if we can",
    "start": "1379120",
    "end": "1386000"
  },
  {
    "text": "make this a cracking process slow enough then you won't be able to handle the",
    "start": "1386000",
    "end": "1392799"
  },
  {
    "text": "hundreds of thousands samples collected every day which means the automated analysis technique is broken",
    "start": "1392799",
    "end": "1401039"
  },
  {
    "text": "and to do so we're going to use a modern cryptography and to use it to bind the",
    "start": "1401039",
    "end": "1406240"
  },
  {
    "text": "malware instance to the host that it originally infected",
    "start": "1406240",
    "end": "1412640"
  },
  {
    "text": "and more specifically we're going to use two techniques the first is the host identity based encryption hre and the",
    "start": "1412640",
    "end": "1419360"
  },
  {
    "text": "second is instruction set localization isl so here is a figure",
    "start": "1419360",
    "end": "1425919"
  },
  {
    "text": "showing how hiv works hiv works very similar to existing packing tools but",
    "start": "1425919",
    "end": "1432000"
  },
  {
    "text": "instead of using a randomly generated encryption key hie will collect",
    "start": "1432000",
    "end": "1437200"
  },
  {
    "text": "information that can use to uniquely identify a host we call it a",
    "start": "1437200",
    "end": "1443120"
  },
  {
    "text": "horse identifier and use this horse identifier to derive an encryption key that we're",
    "start": "1443120",
    "end": "1449919"
  },
  {
    "text": "going to protect the malware binary and because of this similarity where",
    "start": "1449919",
    "end": "1455600"
  },
  {
    "text": "with hie and the existing packing tools we see no difficulty of attackers to",
    "start": "1455600",
    "end": "1461039"
  },
  {
    "text": "adopt this technique or even come up with similar ideas",
    "start": "1461039",
    "end": "1466240"
  },
  {
    "text": "well hiv seems simple there is some details need to further consider",
    "start": "1466880",
    "end": "1471919"
  },
  {
    "text": "reasons considerations sorry and the first thing is what to encrypt",
    "start": "1471919",
    "end": "1476960"
  },
  {
    "text": "a straightforward idea is going to replace existing packing tools which is hie and encrypt the whole binary",
    "start": "1476960",
    "end": "1484480"
  },
  {
    "text": "therefore if there is any difference between the runtime horse identifier and the",
    "start": "1484480",
    "end": "1490080"
  },
  {
    "text": "infection time horse identifier the unpacking will be uh will not be",
    "start": "1490080",
    "end": "1495840"
  },
  {
    "start": "1494000",
    "end": "1494000"
  },
  {
    "text": "successful and the malware were not executed but this may not be a good idea",
    "start": "1495840",
    "end": "1502159"
  },
  {
    "text": "because this field to execute event is very good signal for the analysis uh",
    "start": "1502159",
    "end": "1508559"
  },
  {
    "text": "program you can leverage this signal to speed up the cracking process if you uh",
    "start": "1508559",
    "end": "1513679"
  },
  {
    "text": "you feel familiar with how to crack encrypted binary",
    "start": "1513679",
    "end": "1518799"
  },
  {
    "text": "so instead we suggest using hie as a complementary technique and",
    "start": "1518799",
    "end": "1524240"
  },
  {
    "text": "only use it to encrypt critical mechanisms for example the domain names used to connect to the commander control",
    "start": "1524240",
    "end": "1532000"
  },
  {
    "text": "server all the metadata you use to generate those domain names or ip lists that are used to build up bootstrap pdp",
    "start": "1532000",
    "end": "1539120"
  },
  {
    "text": "bonnets by doing so even if the deep crypt decrypt is not successful so malware is",
    "start": "1539120",
    "end": "1546240"
  },
  {
    "text": "still going to do something and hopefully if the uh analysis program is",
    "start": "1546240",
    "end": "1551840"
  },
  {
    "text": "not clever enough it will treat this information as correct information and",
    "start": "1551840",
    "end": "1558159"
  },
  {
    "text": "be misguided and another thing to think about is what",
    "start": "1558159",
    "end": "1563520"
  },
  {
    "text": "can be used as a horse identifier because there is some difference between",
    "start": "1563520",
    "end": "1568720"
  },
  {
    "text": "malware dim and the legitimate dim malware dm has its own requirement the",
    "start": "1568720",
    "end": "1574159"
  },
  {
    "text": "first requirement is unique the id has to be unique which is uh easy uh unstable and the second requirement is",
    "start": "1574159",
    "end": "1581360"
  },
  {
    "text": "in variant so if the information we use is unstable then these mechanisms can cure malware",
    "start": "1581360",
    "end": "1588720"
  },
  {
    "text": "itself however unlike a legitimate dim system",
    "start": "1588720",
    "end": "1594320"
  },
  {
    "text": "this information needs only to be stable for as long as the malware campaign is",
    "start": "1594320",
    "end": "1600799"
  },
  {
    "text": "so that means it could be just days or weeks and the third requirement is we should",
    "start": "1600799",
    "end": "1606880"
  },
  {
    "text": "be able to collect this information without any privilege because when you are going to effect the system you may",
    "start": "1606880",
    "end": "1613120"
  },
  {
    "text": "not have any special privilege if you collecting those information requires privilege you have to exclude",
    "start": "1613120",
    "end": "1620240"
  },
  {
    "text": "those hosts from your in fact target which is not good and the fourth requirement is the",
    "start": "1620240",
    "end": "1626480"
  },
  {
    "text": "the information should not comes from any special hardware like hardware like uh tpm and the reason is similar to the",
    "start": "1626480",
    "end": "1634320"
  },
  {
    "text": "third requirement here is the list we think uh can be used",
    "start": "1634320",
    "end": "1640080"
  },
  {
    "text": "as the host identifier and the target is windows platform",
    "start": "1640080",
    "end": "1645520"
  },
  {
    "text": "the first piece of information is a subset of process environment block",
    "start": "1645520",
    "end": "1651279"
  },
  {
    "text": "more specifically we're going to use username computer name and cpu identifier",
    "start": "1651279",
    "end": "1657600"
  },
  {
    "text": "the second information we're going to use is mac address the third information is gpinformation",
    "start": "1657600",
    "end": "1663679"
  },
  {
    "text": "and it can be retrieved from a standard api call the last information is the user",
    "start": "1663679",
    "end": "1669200"
  },
  {
    "start": "1668000",
    "end": "1668000"
  },
  {
    "text": "security identifier this is a string randomly generated by the windows os and",
    "start": "1669200",
    "end": "1674720"
  },
  {
    "text": "is unique across the windows domain one thing to notice is we haven't looked",
    "start": "1674720",
    "end": "1680640"
  },
  {
    "text": "into file system and registry yet but we believe there should be more information",
    "start": "1680640",
    "end": "1686159"
  },
  {
    "text": "that can be used as host identifier once the host identifier is collected",
    "start": "1686159",
    "end": "1692559"
  },
  {
    "text": "we're going to feed it into a key derivation function to generate the key",
    "start": "1692559",
    "end": "1698080"
  },
  {
    "text": "the encryption key that we're going to protect the malware binary this uh kdf takes three inputs the first",
    "start": "1698080",
    "end": "1705120"
  },
  {
    "text": "is id which is concatenation of all the information we collected and the second input is the salt",
    "start": "1705120",
    "end": "1712000"
  },
  {
    "text": "which is at least 64 bits it's going to use to",
    "start": "1712000",
    "end": "1717039"
  },
  {
    "text": "prevent rainbow table attack and the last is a iteration number or work facts this is used to control how",
    "start": "1717039",
    "end": "1724480"
  },
  {
    "text": "fast you can derive a key and by using this we can really control how",
    "start": "1724480",
    "end": "1729679"
  },
  {
    "text": "fast this his protection can be cracked for the kdf we suggest using bcrypts",
    "start": "1729679",
    "end": "1735919"
  },
  {
    "text": "with the work facts of at least 10 or the shah hash family with at least",
    "start": "1735919",
    "end": "1742159"
  },
  {
    "text": "100 iterations and the last thing to consider is",
    "start": "1742159",
    "end": "1748000"
  },
  {
    "text": "deployment to deploy a binary that is protected by hie we need",
    "start": "1748000",
    "end": "1755200"
  },
  {
    "text": "to collect the host identifier before we can send the mail out to the client for installation",
    "start": "1755200",
    "end": "1760640"
  },
  {
    "text": "and usually when you attach the computer the share code is short and",
    "start": "1760640",
    "end": "1766159"
  },
  {
    "text": "it is not capable of collecting and submitting those information so as in flashback we have to use some",
    "start": "1766159",
    "end": "1773039"
  },
  {
    "text": "intermediate download agent but one particular problem with the download agent is once the analyst",
    "start": "1773039",
    "end": "1779840"
  },
  {
    "start": "1779000",
    "end": "1779000"
  },
  {
    "text": "captures this download agent you can use this agent to download uh samples that",
    "start": "1779840",
    "end": "1785200"
  },
  {
    "text": "is find it to their analysis environment and analysis analyze it there",
    "start": "1785200",
    "end": "1790559"
  },
  {
    "text": "to solve this problem we propose using short-lived one-time url that it is also",
    "start": "1790559",
    "end": "1796559"
  },
  {
    "text": "used in password reset uh process so by using this one sharecode is only",
    "start": "1796559",
    "end": "1803279"
  },
  {
    "text": "valid to download one and only one intermediate downloader and that downloader is only valid to download one",
    "start": "1803279",
    "end": "1810159"
  },
  {
    "text": "and only one hiv protect malware instance that means uh once the download is used",
    "start": "1810159",
    "end": "1816640"
  },
  {
    "text": "you cannot reuse it again to get another sample",
    "start": "1816640",
    "end": "1821039"
  },
  {
    "text": "his protection has several advantages the first is it uses modern cryptography",
    "start": "1821679",
    "end": "1827679"
  },
  {
    "text": "so knowing how the key is derived does not uh compromises the integrity of its",
    "start": "1827679",
    "end": "1832960"
  },
  {
    "text": "protection and the second is advantage is it's sample independent so even you have if",
    "start": "1832960",
    "end": "1839200"
  },
  {
    "text": "you have two samples from the same malware family uh even it's just a",
    "start": "1839200",
    "end": "1844720"
  },
  {
    "text": "inverse of the same malware binary information collected from cracking the",
    "start": "1844720",
    "end": "1850159"
  },
  {
    "text": "first one will not give you any advantage of cracking the second one",
    "start": "1850159",
    "end": "1856080"
  },
  {
    "start": "1856000",
    "end": "1856000"
  },
  {
    "text": "now i'm going to introduce the second uh technique which is the instruction set localization we introduce uh isl to",
    "start": "1857039",
    "end": "1864240"
  },
  {
    "text": "solve one problem that is pure hospice the protection mechanism is not",
    "start": "1864240",
    "end": "1869440"
  },
  {
    "text": "sufficiently uh resistant to forgery this is also a problem for",
    "start": "1869440",
    "end": "1874480"
  },
  {
    "text": "legitimate drm system and to solve this problem we have uh added one feature",
    "start": "1874480",
    "end": "1880080"
  },
  {
    "text": "called always online and some uh system even uh do it more aggressively they're",
    "start": "1880080",
    "end": "1885760"
  },
  {
    "text": "going to decode some function from the client and put it into the server for example the",
    "start": "1885760",
    "end": "1892480"
  },
  {
    "text": "recently released the game diablo 3. in that game all your character data is",
    "start": "1892480",
    "end": "1898159"
  },
  {
    "text": "stored as blizzard server so even if you can crack the client without being able to successfully",
    "start": "1898159",
    "end": "1905120"
  },
  {
    "text": "authenticate your client to blizzard server the client is not playable",
    "start": "1905120",
    "end": "1911279"
  },
  {
    "text": "so isl is going to do similar things first we will use the cnc server to",
    "start": "1911279",
    "end": "1916480"
  },
  {
    "text": "authenticate the malware client based on both its host identifier and network",
    "start": "1916480",
    "end": "1921600"
  },
  {
    "text": "identifier and secondly we are going to decouple malicious functionality from the binary so",
    "start": "1921600",
    "end": "1928399"
  },
  {
    "text": "any offline analysis is not possible",
    "start": "1928399",
    "end": "1932720"
  },
  {
    "text": "by doing so we think we will tim malwell uh become much like platform as a servings",
    "start": "1933600",
    "end": "1940240"
  },
  {
    "text": "that means the hiv protected binary we send to the client does not have any malicious functionality but only acts as",
    "start": "1940240",
    "end": "1947840"
  },
  {
    "text": "a by-code interpreter and the real malicious functionality will be served as",
    "start": "1947840",
    "end": "1953519"
  },
  {
    "text": "bicarb tasks and by combining the",
    "start": "1953519",
    "end": "1958880"
  },
  {
    "text": "is instruction set architecture ise for their buy code to a specific inspected",
    "start": "1958880",
    "end": "1964240"
  },
  {
    "text": "host if you change the host you will get a",
    "start": "1964240",
    "end": "1969600"
  },
  {
    "text": "a by code that is encoded in ic that is different from the isa that malwa",
    "start": "1970000",
    "end": "1975760"
  },
  {
    "text": "understands so the malicious task will not be interpreted correctly",
    "start": "1975760",
    "end": "1981840"
  },
  {
    "text": "and if you think uh binding ise to a specific heart is host is too complicated we also provided a",
    "start": "1981840",
    "end": "1990159"
  },
  {
    "text": "equivalent to effective way that involves a task encryption and decryption key which i will introduce",
    "start": "1990159",
    "end": "1996399"
  },
  {
    "text": "later so here is a figure explaining how isl",
    "start": "1996399",
    "end": "2001600"
  },
  {
    "text": "works on the first side is the male binary again it has no malicious functionality",
    "start": "2001600",
    "end": "2007760"
  },
  {
    "text": "and is protected by hie we once this uh executable get executed",
    "start": "2007760",
    "end": "2014000"
  },
  {
    "text": "it will collect the horse id and submit it uh to the",
    "start": "2014000",
    "end": "2019039"
  },
  {
    "text": "cnc server and asked for a task on the segment heidi's",
    "start": "2019039",
    "end": "2024399"
  },
  {
    "text": "site is the cnc server it will collect the runtime network id and combine it with the runtime horse id",
    "start": "2024399",
    "end": "2032960"
  },
  {
    "text": "to generate the isa for that malware binary and use this isa to encode the",
    "start": "2032960",
    "end": "2039679"
  },
  {
    "text": "real malicious functionality into buy code and send this back code to the binary to",
    "start": "2039679",
    "end": "2046000"
  },
  {
    "text": "uh to interpret so as you can see if there is any difference between the runtime ids",
    "start": "2046000",
    "end": "2053200"
  },
  {
    "text": "uh from the infection time ids the israel will mismatch and",
    "start": "2053200",
    "end": "2059440"
  },
  {
    "text": "the task will be interpreted incorrectly again",
    "start": "2059440",
    "end": "2064720"
  },
  {
    "text": "we think uh isl is very similar to existing instruction set virtualization",
    "start": "2064720",
    "end": "2070480"
  },
  {
    "text": "uh techniques so we see no difficulty for attackers to adopt this or come up with similar ideas",
    "start": "2070480",
    "end": "2078480"
  },
  {
    "text": "and here is two attributes we think can be used as network ids the first is geolocation we choose it",
    "start": "2079760",
    "end": "2086240"
  },
  {
    "text": "because the ip address is usually not stable enough and we choose to use this information as a graduality of a state",
    "start": "2086240",
    "end": "2094000"
  },
  {
    "text": "or province level so we can tolerance a certain level of mobility and the second attribute we are going to",
    "start": "2094000",
    "end": "2100720"
  },
  {
    "text": "use as complementary is a terminal system number because",
    "start": "2100720",
    "end": "2106000"
  },
  {
    "text": "sometimes the geo location can be out of date or can be incorrect and because this information is",
    "start": "2106000",
    "end": "2112240"
  },
  {
    "text": "collected as a cnc server side we believe is intractably difficult to forge",
    "start": "2112240",
    "end": "2119119"
  },
  {
    "text": "and this is how the task encryption and decryption key works",
    "start": "2119920",
    "end": "2124960"
  },
  {
    "text": "very similar to hie when the malware is going to be installed the server will collect its infection time host id and",
    "start": "2124960",
    "end": "2132720"
  },
  {
    "text": "network id to generate a key which will be embedded into the malware binary we call this key",
    "start": "2132720",
    "end": "2140160"
  },
  {
    "text": "the task decryption key and during the runtime when the cnc server",
    "start": "2140160",
    "end": "2146160"
  },
  {
    "text": "receives the request from the client it will use the runtime id to generate a",
    "start": "2146160",
    "end": "2152000"
  },
  {
    "text": "task encryption key and encrypt the uh the task encoded still encoded in",
    "start": "2152000",
    "end": "2158000"
  },
  {
    "text": "bytecode with this encryption key and send it back to the client the client will then use the embedded",
    "start": "2158000",
    "end": "2164160"
  },
  {
    "text": "decryption key to decrypt the task and begin interpreting it",
    "start": "2164160",
    "end": "2170400"
  },
  {
    "text": "so as binding i say to a specific host if there is any uh deviation in the runtime",
    "start": "2170400",
    "end": "2177280"
  },
  {
    "text": "ids between from the ins in infection time ids",
    "start": "2177280",
    "end": "2183119"
  },
  {
    "text": "the task will be decrypted decrypted correctly and the interpretation will be",
    "start": "2183119",
    "end": "2188880"
  },
  {
    "text": "incorrect and because we now all the keys is generated as a server side we're not",
    "start": "2188880",
    "end": "2195440"
  },
  {
    "text": "going to use the same kdf but we are going to replace it with a key hash or hmac with a key",
    "start": "2195440",
    "end": "2203280"
  },
  {
    "text": "that is kept secret as a server side",
    "start": "2203280",
    "end": "2207359"
  },
  {
    "text": "as hie isa has several advantages too the first advantage is",
    "start": "2208480",
    "end": "2215119"
  },
  {
    "text": "uh the binary sent to the client does not has any uh malicious functionality",
    "start": "2215119",
    "end": "2220160"
  },
  {
    "text": "so even if you can correct his protection you will not be able to analyze this the",
    "start": "2220160",
    "end": "2226480"
  },
  {
    "text": "uh the program because you don't know what this malware is capable of what it's",
    "start": "2226480",
    "end": "2231920"
  },
  {
    "text": "going to do the second advantage is the malicious functionality is uh",
    "start": "2231920",
    "end": "2237680"
  },
  {
    "text": "encoded in uh isa that bind it to that particular host so if you can",
    "start": "2237680",
    "end": "2245280"
  },
  {
    "text": "craft his protection connect to the cnc server and retrieve the",
    "start": "2245280",
    "end": "2250560"
  },
  {
    "start": "2250000",
    "end": "2250000"
  },
  {
    "text": "task if your network id or host id differs from the",
    "start": "2250560",
    "end": "2256480"
  },
  {
    "text": "infection environment you won't be able to interpret that task correctly so you",
    "start": "2256480",
    "end": "2262079"
  },
  {
    "text": "you won't be able to know which what task this malware is going to perform",
    "start": "2262079",
    "end": "2268000"
  },
  {
    "text": "now i've introduced hiv and isl let's talk more about their tech protection",
    "start": "2268720",
    "end": "2274160"
  },
  {
    "text": "both hie and isl is based on modern cryptography so unless you can provide the same",
    "start": "2274160",
    "end": "2280160"
  },
  {
    "text": "execution environment you can you won't be able to bypass the protection",
    "start": "2280160",
    "end": "2285760"
  },
  {
    "text": "and in case you cannot access the original infected environment this means you have to go through the entire",
    "start": "2285760",
    "end": "2292320"
  },
  {
    "text": "configuration space and search for the one that is used by the infection host",
    "start": "2292320",
    "end": "2300079"
  },
  {
    "text": "and because this configuration is controlled by attackers they can choose a arbitrary combination of information",
    "start": "2300079",
    "end": "2307760"
  },
  {
    "text": "and how many information to include this conflicting space can be optionally",
    "start": "2307760",
    "end": "2313040"
  },
  {
    "text": "large which means the searching through it may not be feasible to make things worse",
    "start": "2313040",
    "end": "2318480"
  },
  {
    "text": "some configurations like network id may be impossible to duplicate",
    "start": "2318480",
    "end": "2325200"
  },
  {
    "text": "the second advantage of hie and isls protection is they are insensitive to analysis techniques",
    "start": "2325520",
    "end": "2332400"
  },
  {
    "text": "so the general knowledge of housing works on the does not",
    "start": "2332400",
    "end": "2338400"
  },
  {
    "text": "provide any advantages this is different from knowing how a malware is going to",
    "start": "2338400",
    "end": "2344960"
  },
  {
    "text": "detect your system because once you know how mellow is going to detect your system you can provide fake information",
    "start": "2344960",
    "end": "2352000"
  },
  {
    "text": "to bypass your protection but hie and isl does not have this weakness",
    "start": "2352000",
    "end": "2357760"
  },
  {
    "text": "and regardless of what granularity are going to analyze is",
    "start": "2357760",
    "end": "2363520"
  },
  {
    "text": "the program either by instruction by instruction or a high level uh doing system called trees or network trees",
    "start": "2363520",
    "end": "2369520"
  },
  {
    "start": "2369000",
    "end": "2369000"
  },
  {
    "text": "unless you can provide the same execution environment you will not be able to bypass their protection",
    "start": "2369520",
    "end": "2376960"
  },
  {
    "text": "so now we've talked about the hiv and isl let's talk about some potential",
    "start": "2377839",
    "end": "2383119"
  },
  {
    "text": "matters the first and the most straightforward idea is why not just analyze the",
    "start": "2383119",
    "end": "2390320"
  },
  {
    "text": "malware in the original infected environment well we don't think this is feasible",
    "start": "2390320",
    "end": "2396240"
  },
  {
    "text": "because that means you are going to allow the malware to execute on the client which means you are going to",
    "start": "2396240",
    "end": "2402240"
  },
  {
    "text": "allow otherwise blocked suspicious or malicious functionality to be executed",
    "start": "2402240",
    "end": "2407839"
  },
  {
    "text": "this means this can have a huge impact on the business",
    "start": "2407839",
    "end": "2413359"
  },
  {
    "text": "operation and continuity of the clients you promised to protect and may have complicated the privacy and policy",
    "start": "2413359",
    "end": "2420079"
  },
  {
    "text": "issues and another idea you may think is uh",
    "start": "2420079",
    "end": "2425200"
  },
  {
    "text": "if the infected horse is a high intention honeypot is that okay yes it's okay to analysis the male well",
    "start": "2425200",
    "end": "2432800"
  },
  {
    "text": "analyzes the male well inside the high interaction hard part with high injection honeypot has its own problems",
    "start": "2432800",
    "end": "2440160"
  },
  {
    "text": "first it's hard to maintain and it's not deployed in large scale and you really don't have the control",
    "start": "2440160",
    "end": "2448079"
  },
  {
    "text": "to see when these honeypots are going to be infected and how many malware",
    "start": "2448079",
    "end": "2453280"
  },
  {
    "text": "were in fact this hard part at the same time besides sample collected by high interaction",
    "start": "2453280",
    "end": "2459440"
  },
  {
    "text": "honey pots comprise only a small portion of collective samples every day compared",
    "start": "2459440",
    "end": "2465119"
  },
  {
    "text": "to like a sample submitted by client sample collected by low international",
    "start": "2465119",
    "end": "2470400"
  },
  {
    "text": "honeypot where you don't have any advertising capability and malware exchange from",
    "start": "2470400",
    "end": "2476880"
  },
  {
    "text": "other parties so another idea is if we cannot analyze",
    "start": "2476880",
    "end": "2482319"
  },
  {
    "text": "the malware in the originally infected host can we just",
    "start": "2482319",
    "end": "2487760"
  },
  {
    "text": "collect those information and duplicate those information inside the analysis environment",
    "start": "2487760",
    "end": "2493119"
  },
  {
    "text": "we think this is also infeasible because depending on the information used to",
    "start": "2493119",
    "end": "2498319"
  },
  {
    "text": "generate host id you may have a privacy or policy issues for example the attackers can choose to",
    "start": "2498319",
    "end": "2505119"
  },
  {
    "text": "use your google sound cookie as the host id so will it be a uh willing to",
    "start": "2505119",
    "end": "2512160"
  },
  {
    "text": "submit this to your every uh company just for analysis uh binary collecting on your client",
    "start": "2512160",
    "end": "2518640"
  },
  {
    "text": "and to make things worse to to duplicate the network ideas required",
    "start": "2518640",
    "end": "2525599"
  },
  {
    "text": "to deploy analysis environments at a massive global scale which we have never seen",
    "start": "2525599",
    "end": "2532640"
  },
  {
    "start": "2527000",
    "end": "2527000"
  },
  {
    "text": "before and here is another uh idea is if we cannot",
    "start": "2532640",
    "end": "2540079"
  },
  {
    "text": "duplicate the network id we just uh collect the uh host id and",
    "start": "2540079",
    "end": "2546480"
  },
  {
    "text": "record and replace the networking interaction between the male client and the cnc server",
    "start": "2546480",
    "end": "2553760"
  },
  {
    "text": "without additional protection this can bypass isl but this can be easily mitigated by using",
    "start": "2553760",
    "end": "2561440"
  },
  {
    "text": "ssl because ssl is designed to resistant to lock and replace",
    "start": "2561440",
    "end": "2568720"
  },
  {
    "text": "and the last idea is if we cannot analyze the male well can we just change these protection",
    "start": "2568720",
    "end": "2575520"
  },
  {
    "text": "mechanisms against themselves to do so we are going to launch a large attack",
    "start": "2575520",
    "end": "2580640"
  },
  {
    "text": "that means we're going to make the information used by hie and iso unstable",
    "start": "2580640",
    "end": "2586160"
  },
  {
    "text": "for example and change the mac address or the sid for every uh program execution so",
    "start": "2586160",
    "end": "2593520"
  },
  {
    "text": "the malware won't get executed at all but this but this information the",
    "start": "2593520",
    "end": "2599280"
  },
  {
    "text": "problem is this information is also used by legitimate software so if you",
    "start": "2599280",
    "end": "2605440"
  },
  {
    "text": "provide the unstable information you may break their functionality so the success",
    "start": "2605440",
    "end": "2610640"
  },
  {
    "text": "of this protection mechanism mechanism really depends on whether user will was",
    "start": "2610640",
    "end": "2616319"
  },
  {
    "text": "willing to trade usability over security so in conclusion historically malwa has",
    "start": "2616319",
    "end": "2624720"
  },
  {
    "text": "been analyzing environment a well but recent development has shown malwa can",
    "start": "2624720",
    "end": "2630079"
  },
  {
    "text": "also be analysis environmental oblivious and primitive diamond dim-like",
    "start": "2630079",
    "end": "2635440"
  },
  {
    "text": "techniques like using flashback can be matured into something like hie and isl",
    "start": "2635440",
    "end": "2641680"
  },
  {
    "text": "therefore future work must mitigate these protections or consider alternatives",
    "start": "2641680",
    "end": "2647920"
  },
  {
    "text": "ways to identifying and understanding threats",
    "start": "2647920",
    "end": "2653039"
  },
  {
    "text": "as a reminder please fill out your feedback form your feedback is very important for speakers to improve their",
    "start": "2653599",
    "end": "2659839"
  },
  {
    "text": "presentations and it shapes the very conference you are attending",
    "start": "2659839",
    "end": "2665440"
  },
  {
    "text": "thank you",
    "start": "2665440",
    "end": "2667838"
  },
  {
    "text": "so at this point we would like to open the floor to questions and if you have a question please come",
    "start": "2674240",
    "end": "2680800"
  },
  {
    "text": "up to the front and speak into the microphone if i understand you correctly then this",
    "start": "2680800",
    "end": "2687680"
  },
  {
    "text": "host information gathering and hie happens during the let's say installation process of the malware on",
    "start": "2687680",
    "end": "2694240"
  },
  {
    "text": "the host host machine i'm sorry it's uh it's hard to hear you right now could you speak a little bit",
    "start": "2694240",
    "end": "2699760"
  },
  {
    "text": "louder and a little more slowly if i understand you correctly then all",
    "start": "2699760",
    "end": "2704960"
  },
  {
    "text": "this host information gathering and the hie happens during the let's call it",
    "start": "2704960",
    "end": "2711680"
  },
  {
    "text": "installation process of a malware on the hosts machine that is correct",
    "start": "2711680",
    "end": "2716800"
  },
  {
    "text": "so if i would be able to get a installer of malware then",
    "start": "2716800",
    "end": "2723920"
  },
  {
    "text": "no problems for me well so again the intermediate download agent as well as the shell code will",
    "start": "2723920",
    "end": "2731040"
  },
  {
    "text": "take will contain a one-time use url that is short-lived and so if you're able to capture",
    "start": "2731040",
    "end": "2736960"
  },
  {
    "text": "the intermediate downloader agent if it has already been used even once say to",
    "start": "2736960",
    "end": "2742079"
  },
  {
    "text": "infect the originally infected host you won't be able to use it again because the one-time use url will have been",
    "start": "2742079",
    "end": "2748400"
  },
  {
    "text": "extinguished",
    "start": "2748400",
    "end": "2751039"
  },
  {
    "text": "how about using a tool such as like hp gary's internet responder pro where you could collect the ram on an",
    "start": "2753599",
    "end": "2761200"
  },
  {
    "text": "infected machine before performing remediation you got kind of a static",
    "start": "2761200",
    "end": "2767599"
  },
  {
    "text": "dynamic kind of hybrid uh binary that you can continue analysis on",
    "start": "2767599",
    "end": "2773040"
  },
  {
    "text": "any any ideas for that that should be effective unfortunately it's not scalable",
    "start": "2773040",
    "end": "2778720"
  },
  {
    "text": "the primary purpose of these techniques is to prevent the automated analysis of several hundred thousand samples a day",
    "start": "2778720",
    "end": "2785119"
  },
  {
    "text": "and not so much to prevent a knowledgeable defender or incident responder from",
    "start": "2785119",
    "end": "2791440"
  },
  {
    "text": "being able to understand a particular piece of mail code thanks",
    "start": "2791440",
    "end": "2797280"
  },
  {
    "text": "it seems like the uh basic technique of",
    "start": "2799599",
    "end": "2805680"
  },
  {
    "text": "that was presented here uh seems to skew more towards automated dynamic analysis",
    "start": "2805680",
    "end": "2811920"
  },
  {
    "text": "that's correct okay whereas if um",
    "start": "2811920",
    "end": "2817839"
  },
  {
    "text": "there would have to be an exposed algorithm i would think for either the hie or the isl",
    "start": "2817839",
    "end": "2823920"
  },
  {
    "text": "that would not conform to known industry standards like legitimate drm or a java",
    "start": "2823920",
    "end": "2831359"
  },
  {
    "text": "interpreter or a vb interpreter or something like that which i would think would be",
    "start": "2831359",
    "end": "2837680"
  },
  {
    "text": "vulnerable to automated static analysis being found well i think the the goal is not",
    "start": "2837680",
    "end": "2843599"
  },
  {
    "text": "necessarily to replace conventional obfuscation techniques with hie and isl",
    "start": "2843599",
    "end": "2848800"
  },
  {
    "text": "but use them in complement to hie and isl so you would continue to use",
    "start": "2848800",
    "end": "2853920"
  },
  {
    "text": "traditional obfuscation techniques that would make the malicious portions of program code appears seemingly benign",
    "start": "2853920",
    "end": "2859839"
  },
  {
    "text": "data and you can take again a an off-the-shelf",
    "start": "2859839",
    "end": "2865119"
  },
  {
    "text": "commodity packer or obfuscation tool modify its source code so that automated unpacking tools based on a priori",
    "start": "2865119",
    "end": "2871760"
  },
  {
    "text": "knowledge would not work and then use that as an additional protection in an effort to prevent automated static",
    "start": "2871760",
    "end": "2876960"
  },
  {
    "text": "analysis got it all right thank you",
    "start": "2876960",
    "end": "2881200"
  },
  {
    "text": "regarding the skill level issue you were talking about how about using if you see hashes to",
    "start": "2883680",
    "end": "2889119"
  },
  {
    "text": "identify similar samples that have like this pattern and then uses",
    "start": "2889119",
    "end": "2894480"
  },
  {
    "text": "automatication i'm sorry automatic div of the files to",
    "start": "2894480",
    "end": "2900400"
  },
  {
    "text": "like find um these this kind of samples and like start uh automatic analysis",
    "start": "2900400",
    "end": "2907359"
  },
  {
    "text": "without the um again without combining more traditional obfuscation tools that that probably",
    "start": "2907359",
    "end": "2913119"
  },
  {
    "text": "could be effective but unfortunately you could have uh you know many thousands of distinct malware families all obfuscated",
    "start": "2913119",
    "end": "2919839"
  },
  {
    "text": "by common tools that are subtly modified in a way that a priori knowledge based automated unpacking tools would not work",
    "start": "2919839",
    "end": "2926160"
  },
  {
    "text": "and so that that could be partially successful and would probably depend on the uh the complexity and",
    "start": "2926160",
    "end": "2932480"
  },
  {
    "text": "resourcefulness of the attacker thank you",
    "start": "2932480",
    "end": "2937280"
  },
  {
    "text": "as the analyst what's to stop uh you from having the malware infect your analysis environment",
    "start": "2939920",
    "end": "2947359"
  },
  {
    "text": "well the question is whether you can in the at least the overwhelming majority of cases replicate accurately the",
    "start": "2947359",
    "end": "2953599"
  },
  {
    "text": "circumstances of compromise and so if you were to try and grab an intermediate artifact like the the shell",
    "start": "2953599",
    "end": "2960880"
  },
  {
    "text": "code or the downloader there are one-time use urls and let's say that you were to use a",
    "start": "2960880",
    "end": "2966480"
  },
  {
    "text": "targeted spear phishing attack and a pdf file presumably the shell code",
    "start": "2966480",
    "end": "2971520"
  },
  {
    "text": "executed by the pdf file with whatever exploit it's going to execute would also be one-time use and as jin you mentioned",
    "start": "2971520",
    "end": "2978960"
  },
  {
    "text": "higher in action honeypots if you can replicate the circumstances of compromise would be effective and",
    "start": "2978960",
    "end": "2984720"
  },
  {
    "text": "similarly if defensive organizations can disregard organizational self-interest",
    "start": "2984720",
    "end": "2990559"
  },
  {
    "text": "and uh come together presumably we could create basically a sort of a global alliance of analysis systems where not",
    "start": "2990559",
    "end": "2997200"
  },
  {
    "text": "only can we uh collect and duplicate the host level identifier but also be coming from the",
    "start": "2997200",
    "end": "3003520"
  },
  {
    "text": "same parts of the network namely the same state our province and the same autonomous system number which would",
    "start": "3003520",
    "end": "3008640"
  },
  {
    "text": "correspond to an isp network okay one other one on that",
    "start": "3008640",
    "end": "3013680"
  },
  {
    "text": "when you use like the host name and the computer name and all that that seems like that would make for an easy",
    "start": "3013680",
    "end": "3018880"
  },
  {
    "text": "mitigation task then where you now your system has been infected so go and",
    "start": "3018880",
    "end": "3024000"
  },
  {
    "text": "change all the computer names and the malware won't work anymore that would be a good way and there's obviously an",
    "start": "3024000",
    "end": "3029200"
  },
  {
    "text": "implicit trade-off in in what information you're willing to change on what basis i think it would be considerably harder",
    "start": "3029200",
    "end": "3035680"
  },
  {
    "text": "to change your mac address for every program invocation because obviously the switch would have to recognize the new",
    "start": "3035680",
    "end": "3041200"
  },
  {
    "text": "mac address and permit the associated network connectivity with that change",
    "start": "3041200",
    "end": "3047280"
  },
  {
    "text": "if there are no more additional questions thank you very much for your time",
    "start": "3051280",
    "end": "3057319"
  }
]