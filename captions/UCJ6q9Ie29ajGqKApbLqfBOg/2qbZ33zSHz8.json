[
  {
    "text": "hey everyone and welcome to my talk the Dark Side of EDR repurpose EDR as an",
    "start": "3240",
    "end": "9280"
  },
  {
    "text": "offensive tool my name is Shmo Cohen and I'm excited to be here today and talk about",
    "start": "9280",
    "end": "15320"
  },
  {
    "text": "my recent research and a little bit about myself um I've been working in the cyber security industry for about six",
    "start": "15320",
    "end": "22840"
  },
  {
    "text": "years and currently I'm part of save brid research team H focusing on",
    "start": "22840",
    "end": "28160"
  },
  {
    "text": "vulnerability research and for various products I also used to be part of",
    "start": "28160",
    "end": "33360"
  },
  {
    "text": "checkpoint research group where I conducted Mal research and specializing in AP",
    "start": "33360",
    "end": "40120"
  },
  {
    "text": "groups let's take a look at our agenda for today and we'll begin with our goal",
    "start": "40120",
    "end": "45719"
  },
  {
    "text": "why we are doing this and then we delve into an overview of Cortex",
    "start": "45719",
    "end": "51280"
  },
  {
    "text": "xdr following that I'll demonstrate how I bypassed serval cortex xdr protections",
    "start": "51280",
    "end": "57399"
  },
  {
    "text": "and we will discuss its policy files and why they are important and finally we'll conclude",
    "start": "57399",
    "end": "64119"
  },
  {
    "text": "with some closing remarks as a former malware researcher I constantly observed the ongoing race",
    "start": "64119",
    "end": "71240"
  },
  {
    "text": "between EDR Solutions and evolving malware whenever EDR got more advanced",
    "start": "71240",
    "end": "77840"
  },
  {
    "text": "malood followed the same path and got more sophisticated this led me to wonder is",
    "start": "77840",
    "end": "85000"
  },
  {
    "text": "there a possibility of integrating both EDR and malware functionalities together together in a way that the EDR itself",
    "start": "85000",
    "end": "93040"
  },
  {
    "text": "will be malicious as the title of my talk suggests the answer is",
    "start": "93040",
    "end": "99119"
  },
  {
    "text": "yes if we consider EDR as the guardian of the endpoint what happens when those",
    "start": "99119",
    "end": "105119"
  },
  {
    "text": "Guardians turns against us by transforming an EDR into a malware",
    "start": "105119",
    "end": "111040"
  },
  {
    "text": "attackers gains stealy access and can executed um Can execute sophisticated",
    "start": "111040",
    "end": "116759"
  },
  {
    "text": "attack without the detection this raises The crucial question who will guard the",
    "start": "116759",
    "end": "123560"
  },
  {
    "text": "guards themselves my research goals was twofold",
    "start": "123560",
    "end": "128959"
  },
  {
    "text": "first to develop a malware that integrates seamlessly within the EDR",
    "start": "128959",
    "end": "134239"
  },
  {
    "text": "itself rather than simply bypassing it second to ensure that this malware meets",
    "start": "134239",
    "end": "140599"
  },
  {
    "text": "the criteria of being an AP grade malware this means it must exhibit",
    "start": "140599",
    "end": "146120"
  },
  {
    "text": "properties of persistence stealthiness and high privilege access those",
    "start": "146120",
    "end": "152040"
  },
  {
    "text": "properties are very similar to what EDR already possesses to provide the EDR with the",
    "start": "152040",
    "end": "159239"
  },
  {
    "text": "power to eliminate any threat that is trying to attack the endpoint it's need to have basically um three important",
    "start": "159239",
    "end": "166560"
  },
  {
    "text": "things one it's need to operate with the highest privileges possible second it",
    "start": "166560",
    "end": "172080"
  },
  {
    "text": "need to be temper proof um ensuring user cannot modify its files and lastly it",
    "start": "172080",
    "end": "178959"
  },
  {
    "text": "need to be very very very persistent with this knowledge I started to check top tier edrs on the market and",
    "start": "178959",
    "end": "187000"
  },
  {
    "text": "I wanted an EDR solution that is commonly used within",
    "start": "187000",
    "end": "192760"
  },
  {
    "text": "Enterprises after looking for a while Pao Alto cortex xdr looks like an ideal",
    "start": "193080",
    "end": "198760"
  },
  {
    "text": "candidate um for this uh research it possesses the capability we discussed",
    "start": "198760",
    "end": "204200"
  },
  {
    "text": "earlier and offer cost platform support for Windows Mac OS and Linux environment",
    "start": "204200",
    "end": "210959"
  },
  {
    "text": "but for this research I focused on the Windows agent only with cortex xdr",
    "start": "210959",
    "end": "216879"
  },
  {
    "text": "identified as our case study let's delve into its",
    "start": "216879",
    "end": "222000"
  },
  {
    "text": "working as a starting point I checked which files were written to disk during",
    "start": "222000",
    "end": "227200"
  },
  {
    "text": "the installation of Cortex xdr it seems like there's a lot of",
    "start": "227200",
    "end": "232400"
  },
  {
    "text": "Cortex files um H written into the program data folder and after digging in",
    "start": "232400",
    "end": "238439"
  },
  {
    "text": "I discover this interesting folder that you can see on the screen it's called content it's located within the program",
    "start": "238439",
    "end": "245640"
  },
  {
    "text": "data directory these folders appear to contain policy rules in a form of flua",
    "start": "245640",
    "end": "251079"
  },
  {
    "text": "and python files despite being in clear text and relatively easy to understand",
    "start": "251079",
    "end": "257799"
  },
  {
    "text": "um the large number of this file in this folder motivated me to get a quick H",
    "start": "257799",
    "end": "262800"
  },
  {
    "text": "answer of their purpose and let's be honest guys um today almost everyone has a super",
    "start": "262800",
    "end": "270080"
  },
  {
    "text": "assistant in their pocket and I'm talking of course about Ai and in my case I use gini I asked that what is the",
    "start": "270080",
    "end": "278479"
  },
  {
    "text": "content of Palo Alto cortex xdr content file and he replied me and pretty funny",
    "start": "278479",
    "end": "284440"
  },
  {
    "text": "answer basically saying that due to security considerations sharing the content of those Lua files can assist",
    "start": "284440",
    "end": "291680"
  },
  {
    "text": "malicious actors to craft techniques to bypass detection rules and predict system responses so I thought to myself",
    "start": "291680",
    "end": "299479"
  },
  {
    "text": "wa all the files are already clear texted and they also relatively easy to read",
    "start": "299479",
    "end": "306280"
  },
  {
    "text": "this got me thinking why not taking a hint from Gemini and leverage these",
    "start": "306280",
    "end": "311479"
  },
  {
    "text": "files to craft techniques to bypass detection rules well it sounds like a solid plan to",
    "start": "311479",
    "end": "317039"
  },
  {
    "text": "me so I started to explore the content files and I came across this interesting",
    "start": "317039",
    "end": "322120"
  },
  {
    "text": "one called ransom. Lua and after I read the content of the file I kind of",
    "start": "322120",
    "end": "328720"
  },
  {
    "text": "understood how the Run protection works the main idea is creating hidden",
    "start": "328720",
    "end": "335479"
  },
  {
    "text": "Honeypot files all over around the system and cortex can detect suspicious",
    "start": "335479",
    "end": "340680"
  },
  {
    "text": "attempts to modify those files acting as a clear indicator of possible ransomware",
    "start": "340680",
    "end": "347319"
  },
  {
    "text": "attack now let's take a closer look at how cortex keep things hidden you see",
    "start": "347319",
    "end": "353840"
  },
  {
    "text": "the cortex developer didn't want that any program could see those hyot files for example in imagine you're browsing",
    "start": "353840",
    "end": "360800"
  },
  {
    "text": "through through files with file explorer they don't want you to see all those Honeypot files laying around the system",
    "start": "360800",
    "end": "368199"
  },
  {
    "text": "or maybe you use WinRAR to compress a folder that contains those files no one",
    "start": "368199",
    "end": "373560"
  },
  {
    "text": "wants Honeypot files inside their archives right so to solve that they put",
    "start": "373560",
    "end": "378800"
  },
  {
    "text": "together a list of processes that those Honeypot files will stay hidden from and",
    "start": "378800",
    "end": "384199"
  },
  {
    "text": "guess what the list is clear texted within the ransom. Lua file and we can",
    "start": "384199",
    "end": "390199"
  },
  {
    "text": "easily pick inside this list and see all the processes they've included so now I",
    "start": "390199",
    "end": "396039"
  },
  {
    "text": "have a question for you all guys um with this list in plain site what name would",
    "start": "396039",
    "end": "403080"
  },
  {
    "text": "you give your ransomware let's answer this question in an in a",
    "start": "403080",
    "end": "410120"
  },
  {
    "text": "demo so in this demo we can see um that first I'm showing that every uh",
    "start": "410240",
    "end": "417039"
  },
  {
    "text": "protection and every service of Cortex xdr is enabled and I created a simple",
    "start": "417039",
    "end": "422560"
  },
  {
    "text": "ransomware written in Python and that is going to encryp the entire documents",
    "start": "422560",
    "end": "428039"
  },
  {
    "text": "folder and as we can see we have very important files in this folder now I'm creating a copy of the ransomware inside",
    "start": "428039",
    "end": "435319"
  },
  {
    "text": "the desktop and this ransomware is simply getting in as an input H folder",
    "start": "435319",
    "end": "440720"
  },
  {
    "text": "and its Target is to encrypt the entire folder so I'm providing the documents folder that we want to encrypt and we",
    "start": "440720",
    "end": "448080"
  },
  {
    "text": "can see that as expect Ed cortex xdr prevented us from doing that and um it",
    "start": "448080",
    "end": "453720"
  },
  {
    "text": "prevented us because we have a suspicious um file modifications so the ransom protection Protection work as",
    "start": "453720",
    "end": "461919"
  },
  {
    "text": "expected um and also um cortex quarantine our file but luckily for us I",
    "start": "461919",
    "end": "467680"
  },
  {
    "text": "saved a copy inside the downloads folder now I'm recreating um another copy of",
    "start": "467680",
    "end": "473240"
  },
  {
    "text": "the ransomware inside the desktop but this time I I will rename it to one of the Whit list processes that we",
    "start": "473240",
    "end": "479960"
  },
  {
    "text": "saw now I changed his name run it again and the same uh drill I'm putting the um",
    "start": "479960",
    "end": "488759"
  },
  {
    "text": "documents folder as an input let's see what H what will happen this time and as",
    "start": "488759",
    "end": "494639"
  },
  {
    "text": "we can see all the files H got encrypted inside this folder and let's just double verify it and see that they're actually",
    "start": "494639",
    "end": "501680"
  },
  {
    "text": "encrypted as you can see this file looks pretty encrypted to me so after the successful Ransom",
    "start": "501680",
    "end": "508639"
  },
  {
    "text": "protection bypass I couldn't resist the urge to push further and test cortex responses for more malicious attacks my",
    "start": "508639",
    "end": "516599"
  },
  {
    "text": "next experiment was attempting to do an Elsas memory dump and for those of you",
    "start": "516599",
    "end": "522760"
  },
  {
    "text": "who may not be familiar with Elsas here's a quick summary of why memory dump of Elsas considered a malicious",
    "start": "522760",
    "end": "529680"
  },
  {
    "text": "action essentially Elsas which stands for local security Authority subsystem",
    "start": "529680",
    "end": "535040"
  },
  {
    "text": "service is a crucial system process responsible of managing managing",
    "start": "535040",
    "end": "540279"
  },
  {
    "text": "security policies credentials and authentication on Windows attempting to",
    "start": "540279",
    "end": "545480"
  },
  {
    "text": "dump its memory can potentially expose sensitive information such as usernames",
    "start": "545480",
    "end": "550959"
  },
  {
    "text": "passwords and security tokens making it significant security",
    "start": "550959",
    "end": "556519"
  },
  {
    "text": "risk one common method um used to dump um uh process memory is through a c",
    "start": "556519",
    "end": "562560"
  },
  {
    "text": "internal utility called progam and malicious actor often utilize progam and",
    "start": "562560",
    "end": "568240"
  },
  {
    "text": "to extract memory from the Elsa process I returned to our protected machine and I attempted to execute um",
    "start": "568240",
    "end": "575839"
  },
  {
    "text": "the proam command the pro the program command that you see on the screen and",
    "start": "575839",
    "end": "581320"
  },
  {
    "text": "aiming to dump Elsa's memory into a file and as expected I got prevention",
    "start": "581320",
    "end": "586600"
  },
  {
    "text": "from the xdr and it was kind enough to provide me the exact reason for detection it appears that I was detected",
    "start": "586600",
    "end": "594800"
  },
  {
    "text": "due to a Rex test as you can see in the image to bypass this reject we can simply",
    "start": "594800",
    "end": "601880"
  },
  {
    "text": "insert two quotes in the middle of the command while this won't change the command result at all it will bypass the",
    "start": "601880",
    "end": "608959"
  },
  {
    "text": "re check filled with hopes I executed this modify command and the good news is",
    "start": "608959",
    "end": "616120"
  },
  {
    "text": "I was able to bypass their reject test but the bad news is now I got four",
    "start": "616120",
    "end": "621720"
  },
  {
    "text": "different prevention notifications as you can see and all of them were related to the",
    "start": "621720",
    "end": "627920"
  },
  {
    "text": "mini dump rump function which is a function used to dump Elsa's memory and",
    "start": "627920",
    "end": "633399"
  },
  {
    "text": "I returned to the content files and triy to located those prevention rules and I found them I found them in a file named",
    "start": "633399",
    "end": "641480"
  },
  {
    "text": "DS rules and config Lua as you can see in the red",
    "start": "641480",
    "end": "647519"
  },
  {
    "text": "box one of these rules for instance is titled mini dump rump RPM terminate with",
    "start": "647519",
    "end": "654639"
  },
  {
    "text": "the action to block it at first it appeared like a dead end leaving me unsure sure how can I proceed with",
    "start": "654639",
    "end": "661200"
  },
  {
    "text": "bypassing it and as I continue exploring this file I came across another list",
    "start": "661200",
    "end": "667560"
  },
  {
    "text": "titled as mimicat RPM process whitelist which caught my",
    "start": "667560",
    "end": "672760"
  },
  {
    "text": "attention considering the using of the term RPM I thought it might be related",
    "start": "672760",
    "end": "678360"
  },
  {
    "text": "to the prevention rules that we just review I decided to do an experiment I",
    "start": "678360",
    "end": "683760"
  },
  {
    "text": "tried to rename progam to one of those name in this list and to my surprise it",
    "start": "683760",
    "end": "689320"
  },
  {
    "text": "it worked I successfully managed to dump Elsa's memory let's see a demo of this",
    "start": "689320",
    "end": "696560"
  },
  {
    "text": "bypass so um at first we can see that I'm uh going H to show you again that",
    "start": "697000",
    "end": "703800"
  },
  {
    "text": "every um every service and every protection is enabled as you can see",
    "start": "703800",
    "end": "708880"
  },
  {
    "text": "everything is enabled and running and for first just for sanity test we will",
    "start": "708880",
    "end": "714040"
  },
  {
    "text": "run prog dump um as the the usual command to see what will happen and as",
    "start": "714040",
    "end": "720200"
  },
  {
    "text": "we just saw we got a prevention with the Rex um Rex",
    "start": "720200",
    "end": "728040"
  },
  {
    "text": "test okay so now the next step will be to insert the two quotes that we just talked about and I have another terminal",
    "start": "728040",
    "end": "736480"
  },
  {
    "text": "here and navigating to desktop and running the same command but now this time with the two quotes inside of the",
    "start": "736480",
    "end": "743839"
  },
  {
    "text": "middle of the command we can see that now we have the full preventional uh",
    "start": "743839",
    "end": "748880"
  },
  {
    "text": "rule the preventional notification that we saw now the last check is Will is",
    "start": "748880",
    "end": "754199"
  },
  {
    "text": "Will is um I will try to rename progam to list ds. exe which is one of the",
    "start": "754199",
    "end": "760560"
  },
  {
    "text": "names inside the um this white list and we can see that this time it worked and",
    "start": "760560",
    "end": "767120"
  },
  {
    "text": "I was able to dump completely um Elsas into uh the",
    "start": "767120",
    "end": "773480"
  },
  {
    "text": "desktop so the root cause that enables me to carry out such an attacks was",
    "start": "775160",
    "end": "780480"
  },
  {
    "text": "primarily the fact that the policy content is relatively easy to read with",
    "start": "780480",
    "end": "785880"
  },
  {
    "text": "heavy Reliance on process names while this provide a good starting point I",
    "start": "785880",
    "end": "791519"
  },
  {
    "text": "began to consider what could be done next remember our goal is not just",
    "start": "791519",
    "end": "797440"
  },
  {
    "text": "bypass the EDR but create a malware that operates within the EDR itself this got",
    "start": "797440",
    "end": "804320"
  },
  {
    "text": "me thinking about the possibility of adding or removing my own rules to those",
    "start": "804320",
    "end": "810040"
  },
  {
    "text": "files do you think it's possible to do so let's explore the concept of file",
    "start": "810040",
    "end": "816560"
  },
  {
    "text": "tempering and investigate how cortex xdr protects its files for",
    "start": "816560",
    "end": "822199"
  },
  {
    "text": "modifications so when attempting to modify files even with administrator",
    "start": "822199",
    "end": "827639"
  },
  {
    "text": "privileges I encounter a file access denied er error message this Behavior",
    "start": "827639",
    "end": "833079"
  },
  {
    "text": "led me to suspect that a mini filter driver may be responsible and a mini filter is a known",
    "start": "833079",
    "end": "840079"
  },
  {
    "text": "way for intercepting IO request and um it can block certain request if",
    "start": "840079",
    "end": "846639"
  },
  {
    "text": "necessary with this understanding I started um to reverse engineer and the cortex drivers and while they have",
    "start": "846639",
    "end": "854519"
  },
  {
    "text": "multiple drivers running on the system one in particular caught my intention can you guess",
    "start": "854519",
    "end": "861040"
  },
  {
    "text": "what the Cyber fsfd drival and this one caught my attention and the reason is",
    "start": "861040",
    "end": "867160"
  },
  {
    "text": "because fsfd is usually um short for file system filter",
    "start": "867160",
    "end": "874480"
  },
  {
    "text": "driver and indeed while reverse engineering engineering this driver I observed a list of files and folders",
    "start": "874480",
    "end": "881199"
  },
  {
    "text": "that the mini filter is safeguarding from any modifications but how exactly they are",
    "start": "881199",
    "end": "888360"
  },
  {
    "text": "enforced these protections The Next Step was to investigate the implementation of the mini filter driver",
    "start": "888360",
    "end": "896160"
  },
  {
    "text": "itself and after reversing a little bit more I found the implementation of the mini filter itself and that is",
    "start": "896160",
    "end": "903240"
  },
  {
    "text": "responsible for protecting files from modification and they basically compare",
    "start": "903240",
    "end": "908480"
  },
  {
    "text": "the path names with the protected files when someone try to open a file with the",
    "start": "908480",
    "end": "913720"
  },
  {
    "text": "right permission so think that you are um going um to um open a file with right",
    "start": "913720",
    "end": "919480"
  },
  {
    "text": "permissions any file on the system it will go through the mini filter driver and if the path of the file that you are",
    "start": "919480",
    "end": "926160"
  },
  {
    "text": "trying to modify is um inside the list of their protected files it will um deny",
    "start": "926160",
    "end": "932519"
  },
  {
    "text": "access to access this file so how can we bypass this protection the protection is made with a",
    "start": "932519",
    "end": "940000"
  },
  {
    "text": "path check but path check is uh not good enough and there are other methods to change files and did anyone here heard",
    "start": "940000",
    "end": "948399"
  },
  {
    "text": "about the concept of linking um linking is a method using in operating system to",
    "start": "948399",
    "end": "954079"
  },
  {
    "text": "create um connection between files or directories allowing them to access for",
    "start": "954079",
    "end": "959160"
  },
  {
    "text": "multiple locations by creating a link to one of their protected files from an",
    "start": "959160",
    "end": "964959"
  },
  {
    "text": "unprotected location we can effectively write um into the link file and and this",
    "start": "964959",
    "end": "971240"
  },
  {
    "text": "will gain us the ability to write to the original protected file there's there are different types",
    "start": "971240",
    "end": "977959"
  },
  {
    "text": "of links um including soft links and hard link um let's talk about soft link",
    "start": "977959",
    "end": "983000"
  },
  {
    "text": "softlink is essentially creates a files that points directly to the original file and any attempt to modify the soft",
    "start": "983000",
    "end": "989519"
  },
  {
    "text": "L file is equivalent to try to modifying the original file directly thus we can",
    "start": "989519",
    "end": "996199"
  },
  {
    "text": "we would face again the mini filter driver and it will block us from doing that but unlike soft links which are",
    "start": "996199",
    "end": "1003199"
  },
  {
    "text": "much more like shortcuts pointing to the original file hard links creates what appear to be a distinct file but in",
    "start": "1003199",
    "end": "1010279"
  },
  {
    "text": "reality it's just another reference to the same data on the disk this means",
    "start": "1010279",
    "end": "1015639"
  },
  {
    "text": "that when you make changes to the hardlink file it directly modify the",
    "start": "1015639",
    "end": "1020880"
  },
  {
    "text": "original file so if we could create a hard link from an unprotected location",
    "start": "1020880",
    "end": "1027520"
  },
  {
    "text": "on the disk to one of Cortex protected files we could change the hardlink um",
    "start": "1027520",
    "end": "1033760"
  },
  {
    "text": "file because it's not in protected location but it will eventually change the original",
    "start": "1033760",
    "end": "1039438"
  },
  {
    "text": "file and luckily for us Windows provides a tool called MK link which includes a",
    "start": "1039439",
    "end": "1045438"
  },
  {
    "text": "feature allowing you to create links between files and create hard links between files um one thing to note is",
    "start": "1045439",
    "end": "1053000"
  },
  {
    "text": "you must have right access to the directory where the H where the hard link will be placed and it in in our",
    "start": "1053000",
    "end": "1060280"
  },
  {
    "text": "case it will require an admin privileges but unfortunately for us this",
    "start": "1060280",
    "end": "1065760"
  },
  {
    "text": "attempt to create hard link is still getting block and the question is why I",
    "start": "1065760",
    "end": "1071520"
  },
  {
    "text": "wonder which stage of the hardlink creation process failed and to investigate further I used um another c",
    "start": "1071520",
    "end": "1079360"
  },
  {
    "text": "internal tool and this time prog dump and for those of you who aren't familiar with prog dump is short for process",
    "start": "1079360",
    "end": "1086280"
  },
  {
    "text": "Monitor and it's a powerful tools that enables you that in in in real time to monitor activities including um",
    "start": "1086280",
    "end": "1092520"
  },
  {
    "text": "activities on the file system including m f related actions so I use program and",
    "start": "1092520",
    "end": "1098440"
  },
  {
    "text": "executed the MK link MK link command once more then I Noti is an access",
    "start": "1098440",
    "end": "1103679"
  },
  {
    "text": "denied error assoc associated with the create file operation as you can see in the image",
    "start": "1103679",
    "end": "1110000"
  },
  {
    "text": "this actually makes sense as you may recall the mini filter is preventing us from opening a file with right",
    "start": "1110000",
    "end": "1116640"
  },
  {
    "text": "permissions so this while the MK link is failing so I thought myself how can I",
    "start": "1116640",
    "end": "1123120"
  },
  {
    "text": "solve it and after a quick search I saw this amazing blog called between a rock",
    "start": "1123120",
    "end": "1129120"
  },
  {
    "text": "and a hardlink authored by James forw from Google project zero and in summary",
    "start": "1129120",
    "end": "1134480"
  },
  {
    "text": "his research revealed that it's possible to create hard links with without requiring write attributes so you can do",
    "start": "1134480",
    "end": "1142000"
  },
  {
    "text": "it with read attributes only and he also created a gup repository with",
    "start": "1142000",
    "end": "1148200"
  },
  {
    "text": "implementation of the hardlink creation tool without the need of right",
    "start": "1148200",
    "end": "1153919"
  },
  {
    "text": "attributes and luckily for me it worked I download his creation tool and",
    "start": "1153919",
    "end": "1159880"
  },
  {
    "text": "discovered that it's actually working I successfully created a hard link to one",
    "start": "1159880",
    "end": "1165200"
  },
  {
    "text": "of Cortex content files now the question is when we have",
    "start": "1165200",
    "end": "1171280"
  },
  {
    "text": "the capability of modifying the content files what will be our next",
    "start": "1171280",
    "end": "1176919"
  },
  {
    "text": "step do you remember the DSC rules configs that we saw earlier let's begin",
    "start": "1176919",
    "end": "1182760"
  },
  {
    "text": "with modify it rules um so as you can see in the image I chose to change the",
    "start": "1182760",
    "end": "1188760"
  },
  {
    "text": "detection rule of loading a vulnerable driver and bring your own vulnerable driver attack um named rtic cor",
    "start": "1188760",
    "end": "1196039"
  },
  {
    "text": "64 um and as you can see the action taking H in this rule is to block it so",
    "start": "1196039",
    "end": "1203280"
  },
  {
    "text": "I changed it to allow instead and let's see what happened and if it will work we",
    "start": "1203280",
    "end": "1208640"
  },
  {
    "text": "could load this vulnerable driver this means that we can exploit its vulnerability and it will allow us Kel",
    "start": "1208640",
    "end": "1215559"
  },
  {
    "text": "read and write privileges H Primitives sorry and it looks like it didn't work",
    "start": "1215559",
    "end": "1221679"
  },
  {
    "text": "can someone guess why and the answer is that the problem",
    "start": "1221679",
    "end": "1227679"
  },
  {
    "text": "with this approach is the xdr process is already loaded all those file all those",
    "start": "1227679",
    "end": "1233159"
  },
  {
    "text": "rules and when it started up so any changes to those files won't affect them",
    "start": "1233159",
    "end": "1239039"
  },
  {
    "text": "so I needed a way to somehow restart the cortex xdr process or and make it reload",
    "start": "1239039",
    "end": "1247159"
  },
  {
    "text": "the rules once again and I started to think how can I do it I navigated to the",
    "start": "1247159",
    "end": "1253480"
  },
  {
    "text": "cortex folder and looked for help there and this time I um navigated to to the",
    "start": "1253480",
    "end": "1258919"
  },
  {
    "text": "program uh program files directory and inside the cortex uh folder we we have a",
    "start": "1258919",
    "end": "1264120"
  },
  {
    "text": "tool called SC tool SC tool is a command line utility that allows you to interact with the xdr I started looking at the",
    "start": "1264120",
    "end": "1272000"
  },
  {
    "text": "CLE capabilities and I saw an interesting one called checking and so checking is basically a",
    "start": "1272000",
    "end": "1279679"
  },
  {
    "text": "function used to query the management server for updates including policy updates however when I attempted to",
    "start": "1279679",
    "end": "1286960"
  },
  {
    "text": "perform a check-in the content files were um downloaded um again from the management server overwriting all the",
    "start": "1286960",
    "end": "1294320"
  },
  {
    "text": "changes that I've made and this is an important stage so I wanted to to add um",
    "start": "1294320",
    "end": "1302039"
  },
  {
    "text": "a clarification of exactly what happens and because we will mention the check-in process several times in the upcoming",
    "start": "1302039",
    "end": "1308480"
  },
  {
    "text": "slide so I wanted to make sure everyone got it um so let's see how our process",
    "start": "1308480",
    "end": "1313960"
  },
  {
    "text": "looks like so for start we are modifying the content files as you if you remember change from block to allow and secondly",
    "start": "1313960",
    "end": "1321400"
  },
  {
    "text": "we initiate a check-in process essentially requesting requesting updates from the management",
    "start": "1321400",
    "end": "1327159"
  },
  {
    "text": "server then the management server return us with the latest um update",
    "start": "1327159",
    "end": "1332919"
  },
  {
    "text": "content and finally the new content is written to the content folder replacing",
    "start": "1332919",
    "end": "1338320"
  },
  {
    "text": "the all content files along with our modifications to solve that I wanted to block any connection from the xdr to the",
    "start": "1338320",
    "end": "1346919"
  },
  {
    "text": "management server and see what happens and to do that I needed to know",
    "start": "1346919",
    "end": "1352679"
  },
  {
    "text": "what is the domain of the management server and again luckily for us it's written within the content files so",
    "start": "1352679",
    "end": "1360240"
  },
  {
    "text": "there's a file called core home URL which contains the exact URL for the",
    "start": "1360240",
    "end": "1365720"
  },
  {
    "text": "management server so I simply added um the entry um",
    "start": "1365720",
    "end": "1370840"
  },
  {
    "text": "showing in the image to the host file effectively blocking any connection from the xdr to the management server and",
    "start": "1370840",
    "end": "1377520"
  },
  {
    "text": "after that I attempted to perform checking again and this time it worked",
    "start": "1377520",
    "end": "1383200"
  },
  {
    "text": "although the xdr failed to download content H content files from the management server it still reloaded my",
    "start": "1383200",
    "end": "1391279"
  },
  {
    "text": "modified policy files so let's summarize what we accomplished so far firstly with the",
    "start": "1391279",
    "end": "1399039"
  },
  {
    "text": "ability to read content files we were able to bypass security measures secondly we can now insert",
    "start": "1399039",
    "end": "1406159"
  },
  {
    "text": "remove and change uh rules within the policy files lastly as a proof of",
    "start": "1406159",
    "end": "1412720"
  },
  {
    "text": "concept I ex i' I've exploited um the vulnerability within the RT core 64",
    "start": "1412720",
    "end": "1418600"
  },
  {
    "text": "driver to patch and the cortex administrator password verification function administrator password is used",
    "start": "1418600",
    "end": "1425640"
  },
  {
    "text": "for various task including disabling protections or even completely stop the",
    "start": "1425640",
    "end": "1430720"
  },
  {
    "text": "xdr from running and I modifi that in such a way that any password would work",
    "start": "1430720",
    "end": "1436760"
  },
  {
    "text": "when attempting to interact with the ex SDR and it can also be patched in a way that no password will work making it",
    "start": "1436760",
    "end": "1444080"
  },
  {
    "text": "very very hard H task to remove the xdr from the computer and again for start um let's",
    "start": "1444080",
    "end": "1452400"
  },
  {
    "text": "see let's see a demo of uh this uh this uh",
    "start": "1452400",
    "end": "1458799"
  },
  {
    "text": "bypass and for start we again queried the um cortex xdr to see that everything",
    "start": "1458799",
    "end": "1465360"
  },
  {
    "text": "is up and running as usual and now I will navigate back to my POC",
    "start": "1465360",
    "end": "1471960"
  },
  {
    "text": "folder and I will run the attack and as we can remember what I'm doing here is",
    "start": "1471960",
    "end": "1477679"
  },
  {
    "text": "changing um the policy rules in order to allow me to load this vulnerable",
    "start": "1477679",
    "end": "1484360"
  },
  {
    "text": "driver and for start I'm trying to Echo a wrong password into scol protect disa",
    "start": "1486360",
    "end": "1492880"
  },
  {
    "text": "trying to disabling um um the the protection in the xdr and another test",
    "start": "1492880",
    "end": "1500480"
  },
  {
    "text": "to try to save Rich labs this time to try to disable the xdr completely we saw",
    "start": "1500480",
    "end": "1505520"
  },
  {
    "text": "that both of H this password didn't work now I'm navigating to the PC folder and",
    "start": "1505520",
    "end": "1512320"
  },
  {
    "text": "I'm running the exploit and basically changing uh the",
    "start": "1512320",
    "end": "1517640"
  },
  {
    "text": "rules in Artic core 64 to allow and then initiating a",
    "start": "1517640",
    "end": "1523080"
  },
  {
    "text": "checking this will take a few seconds but after the checking I loaded the rtic",
    "start": "1523080",
    "end": "1528880"
  },
  {
    "text": "core 64 driver and Patch successfully um the driver and now let's navigate back",
    "start": "1528880",
    "end": "1535679"
  },
  {
    "text": "to the cortex folder and we can see that I'm using the same wrong password that I used before to disable protections but",
    "start": "1535679",
    "end": "1543240"
  },
  {
    "text": "this time it works we can see that this uh protection all the protections are now disabled and just for fun another",
    "start": "1543240",
    "end": "1550720"
  },
  {
    "text": "password and this time Ser save Bridge labs to shut down completely the entire xdr and we can see that now um xdr is",
    "start": "1550720",
    "end": "1558799"
  },
  {
    "text": "stopping side server which is the main process of the",
    "start": "1558799",
    "end": "1563398"
  },
  {
    "text": "xdr thank you but disabling edrs or removing",
    "start": "1564000",
    "end": "1572760"
  },
  {
    "text": "protections is a tactic that is been observed in the wild many times however",
    "start": "1572760",
    "end": "1577799"
  },
  {
    "text": "in this research I aim to develop a novel method um that has not been seen",
    "start": "1577799",
    "end": "1583600"
  },
  {
    "text": "before and as a former malw researcher I observed that most most APS groups",
    "start": "1583600",
    "end": "1590000"
  },
  {
    "text": "prioritize and three main objectives stealthiness persistence and elevated",
    "start": "1590000",
    "end": "1595840"
  },
  {
    "text": "Privileges and as you may recall I can modify Lua rules and Lua is actually a",
    "start": "1595840",
    "end": "1602240"
  },
  {
    "text": "programming language so maybe instead of changing the rules perhaps we can insert",
    "start": "1602240",
    "end": "1607679"
  },
  {
    "text": "our own malicious Lua rules H sorry um our own malicious Lua code to run within",
    "start": "1607679",
    "end": "1613480"
  },
  {
    "text": "the xdr and for sanity test I attempted to inser a very simple code that just",
    "start": "1613480",
    "end": "1620039"
  },
  {
    "text": "creates a file on the desktop I inserted this code to one of the lure rules and I",
    "start": "1620039",
    "end": "1626200"
  },
  {
    "text": "initiated a check-in process once again and after the check-in process finished we can see that this code ran and",
    "start": "1626200",
    "end": "1632960"
  },
  {
    "text": "created this file in the desktop and my next step was to write",
    "start": "1632960",
    "end": "1638720"
  },
  {
    "text": "another function that would um let me execute my commands the goal was to",
    "start": "1638720",
    "end": "1644279"
  },
  {
    "text": "confirm that I could run my own commands within s server process however something very strange happened",
    "start": "1644279",
    "end": "1651240"
  },
  {
    "text": "this time when I attempted to run this code the SI server and X which is the main xdr process crashed",
    "start": "1651240",
    "end": "1659640"
  },
  {
    "text": "completely apparently the um I.P openen function um in the Lua code is the line",
    "start": "1659640",
    "end": "1666600"
  },
  {
    "text": "that triggers this behavior I'm not sure why happening and I didn't um investigate it too much but I suspect",
    "start": "1666600",
    "end": "1673720"
  },
  {
    "text": "that this code and that I added invokes an unhandled exeption in a SI server",
    "start": "1673720",
    "end": "1680159"
  },
  {
    "text": "leading to a crush in the SI server process but this is only my guess and I attempted several other techniques to",
    "start": "1680159",
    "end": "1687000"
  },
  {
    "text": "run my code within this L files and including trying to load a malicious dll",
    "start": "1687000",
    "end": "1693159"
  },
  {
    "text": "or using other L commands and such as os. execute and other commands that but",
    "start": "1693159",
    "end": "1698760"
  },
  {
    "text": "but no one and no command or no um technique that I tried worked and but",
    "start": "1698760",
    "end": "1705200"
  },
  {
    "text": "don't worry and this Behavior will come in handy soon um so I passed about um the Lu",
    "start": "1705200",
    "end": "1713840"
  },
  {
    "text": "rules and I remember that during my exploration of the content files I came across some python script as well and um",
    "start": "1713840",
    "end": "1722720"
  },
  {
    "text": "I became curious about their purpose and since I could modify all the content",
    "start": "1722720",
    "end": "1727760"
  },
  {
    "text": "files including those Python scripts I began to wonder what if um cortex will",
    "start": "1727760",
    "end": "1733399"
  },
  {
    "text": "execute them maybe can execute my own python script and python is an easy leg image and I can do almost everything",
    "start": "1733399",
    "end": "1739840"
  },
  {
    "text": "with it and so I thought maybe I can manipulate cortex once again and I",
    "start": "1739840",
    "end": "1746279"
  },
  {
    "text": "started by taking a look of the running cortex processes and as we can see all",
    "start": "1746279",
    "end": "1751559"
  },
  {
    "text": "of those processes are running with the highest PR privileges um as as as as it",
    "start": "1751559",
    "end": "1757320"
  },
  {
    "text": "should be and and we have the main size server process and it seems like he have",
    "start": "1757320",
    "end": "1762799"
  },
  {
    "text": "some workers under him as you can see in the image and another process with with a very interesting name called um cortex",
    "start": "1762799",
    "end": "1770080"
  },
  {
    "text": "xdr payload.exe and I thought to myself what um is this file what is this",
    "start": "1770080",
    "end": "1775760"
  },
  {
    "text": "process what it's supposed to do so I wanted to to check U maybe if it has",
    "start": "1775760",
    "end": "1781080"
  },
  {
    "text": "some arguments um inside of them and as we can see um it has a configuration",
    "start": "1781080",
    "end": "1787600"
  },
  {
    "text": "file it seems like a config file with a path to a file called um service",
    "start": "1787600",
    "end": "1792640"
  },
  {
    "text": "main Json and zooming in we can see um the file path and so so I thought myself",
    "start": "1792640",
    "end": "1798880"
  },
  {
    "text": "let's open this file and see what's uh inside of it maybe I can modify something there and it seemed to be like",
    "start": "1798880",
    "end": "1805080"
  },
  {
    "text": "a configuration files that is describing an argument for a service called servic man. pile and so I thought myself okay",
    "start": "1805080",
    "end": "1813159"
  },
  {
    "text": "serviceman do pile another interesting name let's take a look at this",
    "start": "1813159",
    "end": "1818279"
  },
  {
    "text": "file and these scripts appear to be a service that running in a Non-Stop Loop",
    "start": "1818279",
    "end": "1823760"
  },
  {
    "text": "and fetching pending task from another service and and execute them as you can see in the red arrow and so the good",
    "start": "1823760",
    "end": "1831880"
  },
  {
    "text": "news is with our hard link bypass we can modify the content of these files and",
    "start": "1831880",
    "end": "1837200"
  },
  {
    "text": "insert our own malicious code the bad news is this python script is already loaded inside cortex xdr payload process",
    "start": "1837200",
    "end": "1845000"
  },
  {
    "text": "as we had the same issue before so even modify the script won't affect cortex",
    "start": "1845000",
    "end": "1850240"
  },
  {
    "text": "xdr process so anyone can guess what the first thing that I tried to do well as",
    "start": "1850240",
    "end": "1855919"
  },
  {
    "text": "you can see in the image I try to do um a checking once again and but this check in check in trick didn't help me this",
    "start": "1855919",
    "end": "1862840"
  },
  {
    "text": "time because H just nothing happened um the cortex xdr payload exit didn't load",
    "start": "1862840",
    "end": "1870440"
  },
  {
    "text": "and those modified python python files once again so I thought myself okay what",
    "start": "1870440",
    "end": "1875880"
  },
  {
    "text": "can be done next and the next thing is pretty obvious and you can just um",
    "start": "1875880",
    "end": "1881159"
  },
  {
    "text": "restart the computer or log off the user and it will cause the xdr process to be",
    "start": "1881159",
    "end": "1888679"
  },
  {
    "text": "restarted once the user will log back into the computer once again but actually we already have a better",
    "start": "1888679",
    "end": "1895559"
  },
  {
    "text": "solution under right right under our nose and we can crash s server and",
    "start": "1895559",
    "end": "1901679"
  },
  {
    "text": "restart it immediately as we saw earlier with the I.P open Lua",
    "start": "1901679",
    "end": "1908639"
  },
  {
    "text": "command so few slides back the io dop open command and let us to crush s",
    "start": "1908639",
    "end": "1914320"
  },
  {
    "text": "server process completely and now leveraging this Behavior we can modify service main.py and with our own malitia",
    "start": "1914320",
    "end": "1922200"
  },
  {
    "text": "script and and then crash SI server and starting it back again quickly um this",
    "start": "1922200",
    "end": "1928840"
  },
  {
    "text": "change will allow our malicious code to be executed with Insight server so this",
    "start": "1928840",
    "end": "1934080"
  },
  {
    "text": "is pretty amazing and we can see a demo of this right now so um this will be our final demo",
    "start": "1934080",
    "end": "1942200"
  },
  {
    "text": "and I'm again the last time I'm doing this drill of navigating into cortex",
    "start": "1942200",
    "end": "1947240"
  },
  {
    "text": "folder and show you that every protection and every service is up and",
    "start": "1947240",
    "end": "1952720"
  },
  {
    "text": "running and now I will mod navigate to my PC folder and I will run run as a",
    "start": "1952720",
    "end": "1959960"
  },
  {
    "text": "malware and PC with a reverse shell as an argument so the argument will be",
    "start": "1959960",
    "end": "1965840"
  },
  {
    "text": "injected to servic main. Pi and on my host computer I'm listening",
    "start": "1965840",
    "end": "1972519"
  },
  {
    "text": "to the port of the reverse shell and let's take a look of Cortex X",
    "start": "1972519",
    "end": "1977799"
  },
  {
    "text": "XD p.x with all of Cortex processes I started the attack and we can see that",
    "start": "1977799",
    "end": "1984639"
  },
  {
    "text": "few seconds after um cortex xdr completely crashed and um a moment after",
    "start": "1984639",
    "end": "1991279"
  },
  {
    "text": "he crashing I'm will try to start it once again in my script and we can see",
    "start": "1991279",
    "end": "1996519"
  },
  {
    "text": "that now s server um um went up again and cortex xdr payload also um um",
    "start": "1996519",
    "end": "2004440"
  },
  {
    "text": "started we can see that at the moment that cortex xdr payload started and we got a connection from the reverse shell",
    "start": "2004440",
    "end": "2010760"
  },
  {
    "text": "but I wanted to let the script to finish to bring up SI server completely we can",
    "start": "2010760",
    "end": "2016679"
  },
  {
    "text": "see that we have an anti- authority system privileges on the host machine and just to show you that I'm actually",
    "start": "2016679",
    "end": "2023240"
  },
  {
    "text": "running inside cortex xdr payload I ran a timeout command and you can see that",
    "start": "2023240",
    "end": "2029360"
  },
  {
    "text": "it's under it and just for fun let's say that you want to terminate this process",
    "start": "2029360",
    "end": "2035880"
  },
  {
    "text": "um even with an administrator privilege is you couldn't do it because the xdl protecting it so that's pretty funny as",
    "start": "2035880",
    "end": "2044919"
  },
  {
    "text": "well so um let's review some takeaways from today's session researching",
    "start": "2045440",
    "end": "2051398"
  },
  {
    "text": "endpoint security products for various risk might be even more important than researching the security risk in the",
    "start": "2051399",
    "end": "2057679"
  },
  {
    "text": "operating system itself attackers that that exploit risk in operating system still need to continuously face a",
    "start": "2057679",
    "end": "2065520"
  },
  {
    "text": "guardian however if the Almighty Guardian has been breached by attackers then no entity guards the computer and",
    "start": "2065520",
    "end": "2072878"
  },
  {
    "text": "they will be gifted with a large set of powerful capabilities second the logic of",
    "start": "2072879",
    "end": "2080158"
  },
  {
    "text": "security product should be its deepest secret a simple detection Logics that is",
    "start": "2080159",
    "end": "2085599"
  },
  {
    "text": "keep in secret can be more effective than a disclosed more sophisticated one",
    "start": "2085599",
    "end": "2091358"
  },
  {
    "text": "and when attacker are awes to detection methods and how they Works um they can",
    "start": "2091359",
    "end": "2096960"
  },
  {
    "text": "easily evade them and and evade them and lastly a laow",
    "start": "2096960",
    "end": "2103079"
  },
  {
    "text": "list or block list should be frame a process um or an action based on",
    "start": "2103079",
    "end": "2108200"
  },
  {
    "text": "multiple parameters and that are solid and cannot be manipulated by attackers",
    "start": "2108200",
    "end": "2113280"
  },
  {
    "text": "and adding a process to a laow list based only on its name or detecting a",
    "start": "2113280",
    "end": "2118720"
  },
  {
    "text": "process um process dump with Rex test is just not good enough so throughout this",
    "start": "2118720",
    "end": "2125520"
  },
  {
    "text": "session we've uncovered potential weaknesses in cortex xdr system and",
    "start": "2125520",
    "end": "2130880"
  },
  {
    "text": "those findings those findings were shared with Palo Alto network security team last here and this is their",
    "start": "2130880",
    "end": "2138240"
  },
  {
    "text": "official response I give you a few seconds to read",
    "start": "2138240",
    "end": "2142800"
  },
  {
    "text": "it okay and additionally let me introduce to you um cortex V Vortex um a",
    "start": "2146680",
    "end": "2152680"
  },
  {
    "text": "tool that enables you to test everything that almost everything that we discussed",
    "start": "2152680",
    "end": "2157720"
  },
  {
    "text": "today and including the implementation of both POC demos that we saw including the loading of RTX RT core 64 drivers to",
    "start": "2157720",
    "end": "2166640"
  },
  {
    "text": "patch the administrator password so any password would work and um inserting malicious code to be executed within s",
    "start": "2166640",
    "end": "2173960"
  },
  {
    "text": "server itself feel free to take a picture of this G up repository which will be available after this",
    "start": "2173960",
    "end": "2181200"
  },
  {
    "text": "talk and if anyone have any question feel free to ask me now or if you feel",
    "start": "2181200",
    "end": "2187760"
  },
  {
    "text": "more comfortable to do it later it's also",
    "start": "2187760",
    "end": "2192240"
  },
  {
    "text": "good oh hey sorry hi my name is Kelsey hi um so I do work um in TDR so my",
    "start": "2193359",
    "end": "2199680"
  },
  {
    "text": "question for you would be what are some medications to such issues um because of",
    "start": "2199680",
    "end": "2205119"
  },
  {
    "text": "my sock we also have alerts that will show in um some of our edrs are being tampered with either from like the users",
    "start": "2205119",
    "end": "2212280"
  },
  {
    "text": "end or any end honestly but um what other mitigations uh would you say to to",
    "start": "2212280",
    "end": "2217680"
  },
  {
    "text": "either detect or protect uh protect hold on it's okay it's okay to either um",
    "start": "2217680",
    "end": "2224920"
  },
  {
    "text": "prevent or detect thank you sorry okay so okay first um the first thing that",
    "start": "2224920",
    "end": "2231480"
  },
  {
    "text": "the CeX um theme actually did is block the hardlink creation without the right",
    "start": "2231480",
    "end": "2237480"
  },
  {
    "text": "permissions so any hardlink trying to hardlink to their files will also be",
    "start": "2237480",
    "end": "2242839"
  },
  {
    "text": "failed so um in the most updated cortex um version and and this method will not",
    "start": "2242839",
    "end": "2249280"
  },
  {
    "text": "work as they mitigated this and but maybe there's other ways to hardlink files and you can all continue research",
    "start": "2249280",
    "end": "2255839"
  },
  {
    "text": "about it and the second thing that I think is something very important is to",
    "start": "2255839",
    "end": "2262359"
  },
  {
    "text": "hide those uh content files from any user to just be able to read I mean if",
    "start": "2262359",
    "end": "2268119"
  },
  {
    "text": "those file were encrypted and let's say decrypted inside memory it it will be",
    "start": "2268119",
    "end": "2273560"
  },
  {
    "text": "much harder for researchers to um read those files and understand understand how it how they are working and I think",
    "start": "2273560",
    "end": "2280839"
  },
  {
    "text": "that this will also be a very good mitigation um it won't stop attackers but it will make their life their life",
    "start": "2280839",
    "end": "2288400"
  },
  {
    "text": "much harder which also a good mitigation method um and I think that's it perfect",
    "start": "2288400",
    "end": "2296119"
  },
  {
    "text": "thank you thank you yes uh so you were ding this on the um",
    "start": "2296119",
    "end": "2303720"
  },
  {
    "text": "example of the Polar Alto xdr but there are lots of other xdr the company I work for we also do xdr so would you say that",
    "start": "2303720",
    "end": "2311520"
  },
  {
    "text": "this is a design flow in the concept of xdr where they buil so much self-",
    "start": "2311520",
    "end": "2317720"
  },
  {
    "text": "protection mechanisms into the product that if you basically can exploit you",
    "start": "2317720",
    "end": "2323760"
  },
  {
    "text": "can abuse those self- protection mechanisms to uh use it for your",
    "start": "2323760",
    "end": "2329800"
  },
  {
    "text": "persistence like like you even kill the process exactly exactly that's exactly what I did in this research I leveraged",
    "start": "2329800",
    "end": "2336520"
  },
  {
    "text": "the power of the R itself to run my own code and if I will able to in any other",
    "start": "2336520",
    "end": "2342079"
  },
  {
    "text": "EDR product to run my own code within the EDR process itself I will be um",
    "start": "2342079",
    "end": "2347680"
  },
  {
    "text": "Almighty I can do almost everything on the computer it will be super hard um to",
    "start": "2347680",
    "end": "2353839"
  },
  {
    "text": "remove me from the computer because no one wants an easy method to remove the xdr from the computer so um I think it",
    "start": "2353839",
    "end": "2362240"
  },
  {
    "text": "can be also exploited in other R Solutions I didn't check other R Solutions so I don't want to give like a",
    "start": "2362240",
    "end": "2368640"
  },
  {
    "text": "straight answer about it and but if other solution would you would you think that this is a design problem that the",
    "start": "2368640",
    "end": "2375280"
  },
  {
    "text": "way people think of EDR solution is wrong because they trying to put all the",
    "start": "2375280",
    "end": "2380880"
  },
  {
    "text": "X in the same box so if you just pick one of the X you basically let the whole",
    "start": "2380880",
    "end": "2386960"
  },
  {
    "text": "castle fail bit like would do you think that this is more of a design issue than",
    "start": "2386960",
    "end": "2392359"
  },
  {
    "text": "a particular product issue yeah so I'm not sure it's it's particular product issue I I I",
    "start": "2392359",
    "end": "2398040"
  },
  {
    "text": "I'm not sure if it's it's it's a design issue because edrs are supposed to be very persistent and very protected and",
    "start": "2398040",
    "end": "2405880"
  },
  {
    "text": "but if you do um an ed solution that is very persistent very protected make sure you protect its files and so no one",
    "start": "2405880",
    "end": "2413400"
  },
  {
    "text": "could change its behavior in any other way cool thank you thank",
    "start": "2413400",
    "end": "2419520"
  },
  {
    "text": "you yes hi hi um so I know the cortex agent picks up a reasonable amount of",
    "start": "2419520",
    "end": "2425839"
  },
  {
    "text": "telemetry from the endpoint did you have a look at what the agent itself was logging from what you were doing and see",
    "start": "2425839",
    "end": "2432599"
  },
  {
    "text": "if it would have if you could have detected that beforehand um so actually no I didn't",
    "start": "2432599",
    "end": "2438640"
  },
  {
    "text": "look at the EDR logs of what I'm what I was doing I'm not sure that he was aware",
    "start": "2438640",
    "end": "2445560"
  },
  {
    "text": "aware of that because if it was aware of that and he didn't do anything to prevent it it would be pretty funny it",
    "start": "2445560",
    "end": "2452839"
  },
  {
    "text": "does happen though yeah and but no so to for question no I didn't check it logs",
    "start": "2452839",
    "end": "2459040"
  },
  {
    "text": "and how if it detects me or",
    "start": "2459040",
    "end": "2462839"
  },
  {
    "text": "not one",
    "start": "2467800",
    "end": "2471040"
  },
  {
    "text": "more hi hi uh it's a great great session for sure uh in one the in the demo",
    "start": "2474079",
    "end": "2479200"
  },
  {
    "text": "actually you were loading some malicious drivers uh the question is that was hbci was enabled during that session during",
    "start": "2479200",
    "end": "2486319"
  },
  {
    "text": "that period sorry can you come again HCI uh was okay okay okay okay so about HCI",
    "start": "2486319",
    "end": "2492640"
  },
  {
    "text": "it's a very good good question in this demo I've used um VMS without hbci",
    "start": "2492640",
    "end": "2500160"
  },
  {
    "text": "enabled and it's not it's not a nested virtualization for those of you who aren't familiar with hbci is a",
    "start": "2500160",
    "end": "2506960"
  },
  {
    "text": "mitigation method used in Windows to protect um this driver patching that I was doing",
    "start": "2506960",
    "end": "2513440"
  },
  {
    "text": "and and so I didn't check it um on a real endpoint and which with um HCI",
    "start": "2513440",
    "end": "2521240"
  },
  {
    "text": "enabled um but the main uh purpose of This research is not about the patching",
    "start": "2521240",
    "end": "2527400"
  },
  {
    "text": "of the administrator password but rather of um inserting my own malware to run",
    "start": "2527400",
    "end": "2534200"
  },
  {
    "text": "within the EDR process itself thank you so much thank you great great",
    "start": "2534200",
    "end": "2541400"
  },
  {
    "text": "question okay I think uh thank you all for joining session the",
    "start": "2541640",
    "end": "2547800"
  },
  {
    "text": "Dark Side of EDR repurposing EDR as an offensive tool this is um all my handles",
    "start": "2547800",
    "end": "2553520"
  },
  {
    "text": "to Twitter and Linkedin and mail feel free to contact me and we can also talk",
    "start": "2553520",
    "end": "2559359"
  },
  {
    "text": "uh after this session thank you everyone",
    "start": "2559359",
    "end": "2564318"
  }
]