[
  {
    "text": "[Music]",
    "start": "0",
    "end": "15560"
  },
  {
    "text": "welcome to black hat Windows 2K security held February 14th through the 15th 2001",
    "start": "18720",
    "end": "24480"
  },
  {
    "text": "in Las Vegas Nevada the following video tape was recorded live at the conference and produced by the of knowledge",
    "start": "24480",
    "end": "31040"
  },
  {
    "text": "Incorporated this is videotape number 10 more technical track active and passive",
    "start": "31040",
    "end": "36680"
  },
  {
    "text": "fingerprinting of microsoft-based operating systems using the icmp",
    "start": "36680",
    "end": "43120"
  },
  {
    "text": "protocol myself uh my name is ofir Arin I'm uh as it states here uh the founder",
    "start": "43800",
    "end": "50920"
  },
  {
    "text": "of the C Security Group sounds nice uh uh it's a website carrying all my uh",
    "start": "50920",
    "end": "59160"
  },
  {
    "text": "work which you can go to download all my uh previous",
    "start": "59160",
    "end": "65158"
  },
  {
    "text": "papers um I'm also an active member of the",
    "start": "65159",
    "end": "70600"
  },
  {
    "text": "honey neck project how many of you heard about the honey neck project okay it's",
    "start": "70600",
    "end": "78600"
  },
  {
    "text": "cool when I last had this uh talk back in uh October um in Amsterdam I stated",
    "start": "79320",
    "end": "87880"
  },
  {
    "text": "that rfcs are meant to be red and followed well seems that uh people didn't learn a lesson yet uh was",
    "start": "87880",
    "end": "95479"
  },
  {
    "text": "expecting to see some of the stuff I have found uh Chang and fixed but",
    "start": "95479",
    "end": "101799"
  },
  {
    "text": "apparently um no one",
    "start": "101799",
    "end": "106159"
  },
  {
    "text": "bothered why is it so important or why is it important at all to use icmp to do",
    "start": "110640",
    "end": "117680"
  },
  {
    "text": "active and passive fingerprinting of operating system as a whole and use icmp",
    "start": "117680",
    "end": "122920"
  },
  {
    "text": "for uh host detection Advanced host detection and such",
    "start": "122920",
    "end": "128160"
  },
  {
    "text": "activities well the amount of traffic you have to use with icmp uh is less than with other",
    "start": "128160",
    "end": "136200"
  },
  {
    "text": "protocols um how how many of you know nmap okay nmap um house detection Port",
    "start": "136200",
    "end": "145599"
  },
  {
    "text": "scanner uh active fingerprinting tool written by foda",
    "start": "145599",
    "end": "150959"
  },
  {
    "text": "um sends 28 packets for one port in",
    "start": "150959",
    "end": "156080"
  },
  {
    "text": "order to determine if this uh host is alive and whether or what is the",
    "start": "156080",
    "end": "161640"
  },
  {
    "text": "underlying operating system with icmp as I will show you we will use between one",
    "start": "161640",
    "end": "168599"
  },
  {
    "text": "to three datagrams only in order to determine the underlying operating",
    "start": "168599",
    "end": "175000"
  },
  {
    "text": "system now you might say that sure we block icmp on our uh firewall we do not",
    "start": "175000",
    "end": "182480"
  },
  {
    "text": "let any type of IP query enter our facilities but remember that you have",
    "start": "182480",
    "end": "189560"
  },
  {
    "text": "internal users uh there is a slogan saying um one of the P.A companies for",
    "start": "189560",
    "end": "194879"
  },
  {
    "text": "Linux is saying if we can ping it we can backup it well if I can ping it I can",
    "start": "194879",
    "end": "200200"
  },
  {
    "text": "know what is the operating system a bit about icmp icmp was",
    "start": "200200",
    "end": "208680"
  },
  {
    "text": "defined with RFC 792 a long time ago which a nice RFC 20",
    "start": "208680",
    "end": "214959"
  },
  {
    "text": "pages long later there were some other rfc's which I highly recommend to read in",
    "start": "214959",
    "end": "221400"
  },
  {
    "text": "order to understand host requirements you can read RFC",
    "start": "221400",
    "end": "226480"
  },
  {
    "text": "1122 in order to understand router requirements for version IP version 4",
    "start": "226480",
    "end": "232959"
  },
  {
    "text": "you need to read RFC 1812 there are two goals to the icmp",
    "start": "232959",
    "end": "239079"
  },
  {
    "text": "protocol uh first when a router or a destination host need to inform the source host",
    "start": "239079",
    "end": "246280"
  },
  {
    "text": "about errors in datagram processing and of course um probing the network for um",
    "start": "246280",
    "end": "255159"
  },
  {
    "text": "General characteristic about a network and and determine if systems are alive",
    "start": "255159",
    "end": "260959"
  },
  {
    "text": "and workable icmp is a controversial",
    "start": "260959",
    "end": "267840"
  },
  {
    "text": "protocol uh at least I I think so um I will especially focus on active",
    "start": "267840",
    "end": "276080"
  },
  {
    "text": "and passive fingerprinting of Microsoft operating systems because we are in a Microsoft win2k",
    "start": "276080",
    "end": "282919"
  },
  {
    "text": "conference but if you will download my uh paper icmp usage and scanning from my",
    "start": "282919",
    "end": "288080"
  },
  {
    "text": "website you'll see that I can use icmp for various uh situation and",
    "start": "288080",
    "end": "294120"
  },
  {
    "text": "fingerprinting not only Microsoft based operating systems icmp messages are sent in IP",
    "start": "294120",
    "end": "302039"
  },
  {
    "text": "datagrams uh their goal is not to make uh IP reliable um they report",
    "start": "302039",
    "end": "308720"
  },
  {
    "text": "non-transient error messages um in the uh RFC it states that",
    "start": "308720",
    "end": "314960"
  },
  {
    "text": "the protocol ID for rmp is one it states that the IP type of service field and",
    "start": "314960",
    "end": "321039"
  },
  {
    "text": "the proceeding bits field should be zero if you are a router you will use",
    "start": "321039",
    "end": "326880"
  },
  {
    "text": "the value of 6 or seven as the IP procedings bits value with eror messages",
    "start": "326880",
    "end": "333199"
  },
  {
    "text": "just remind stick it in your head for a bit for later",
    "start": "333199",
    "end": "340160"
  },
  {
    "text": "on if you will look at the icmp protocol uh a regular",
    "start": "340680",
    "end": "346360"
  },
  {
    "text": "datagram will be a combine of a type you can see that here of a code",
    "start": "346360",
    "end": "353520"
  },
  {
    "text": "field uh the type specified the type of uh message we're using we have query and",
    "start": "353520",
    "end": "360440"
  },
  {
    "text": "we have error messages the code field specified a subtype we have some uh IP",
    "start": "360440",
    "end": "368000"
  },
  {
    "text": "messages which which has a a couple of few um subtype",
    "start": "368000",
    "end": "375720"
  },
  {
    "text": "um messages like destination unreachable has a host unreachable Network unreachable like 16 possibilities we",
    "start": "375720",
    "end": "384240"
  },
  {
    "text": "have a header check sum and we have a data which varies according to the",
    "start": "384240",
    "end": "389880"
  },
  {
    "text": "different typee of message there are some uh special",
    "start": "389880",
    "end": "396960"
  },
  {
    "text": "conditions uh regarding icmp most of them uh talk about error messages with",
    "start": "396960",
    "end": "403000"
  },
  {
    "text": "icmp the first one is and the most important one is that no icmp error",
    "start": "403000",
    "end": "408199"
  },
  {
    "text": "message is sent for or sent in response to another icmp error",
    "start": "408199",
    "end": "413720"
  },
  {
    "text": "message uh we do not want to have uh loops on the internet if we have a",
    "start": "413720",
    "end": "421479"
  },
  {
    "text": "fragmented sorry if we have fragmented IP datagrams",
    "start": "421479",
    "end": "427280"
  },
  {
    "text": "then IP messages will always be sent for fragment zero which is the first",
    "start": "427280",
    "end": "432639"
  },
  {
    "text": "fragment we will not send IP messages for datagrams that are destined to a",
    "start": "432639",
    "end": "438840"
  },
  {
    "text": "broadcast or a moodly cast address and never sent in response to datagram sense",
    "start": "438840",
    "end": "445000"
  },
  {
    "text": "as a link layer broadcast we have other",
    "start": "445000",
    "end": "450120"
  },
  {
    "text": "uh conditions uh one of them again no error message or sent in response to igmp",
    "start": "450120",
    "end": "457319"
  },
  {
    "text": "messages and another important one is when icmp message of unknown type is",
    "start": "457319",
    "end": "463639"
  },
  {
    "text": "received we are going to Discord",
    "start": "463639",
    "end": "468000"
  },
  {
    "text": "it if we look at a list of icmp messages and uh list some of the those we can see",
    "start": "472759",
    "end": "480919"
  },
  {
    "text": "that with query messages we have quite a few uh usual people just think about the",
    "start": "480919",
    "end": "488199"
  },
  {
    "text": "pin utility and the icmp echo request but there are other query messages there",
    "start": "488199",
    "end": "495000"
  },
  {
    "text": "is the uh time stamp um er um quer message which we use",
    "start": "495000",
    "end": "500639"
  },
  {
    "text": "for Network latency there is the information request and the address mask",
    "start": "500639",
    "end": "505840"
  },
  {
    "text": "request messages used for net mask and mask of the network the computers reside",
    "start": "505840",
    "end": "513000"
  },
  {
    "text": "on um all the query messages were initially designed to work on the same",
    "start": "513000",
    "end": "520959"
  },
  {
    "text": "network um as the query host as the source host for those uh queries but",
    "start": "520959",
    "end": "527920"
  },
  {
    "text": "apparently we can use them across the internet uh nicely aror messages we have the",
    "start": "527920",
    "end": "534600"
  },
  {
    "text": "destination unreachable Source quench R direct time exceedent and parameter problem",
    "start": "534600",
    "end": "540600"
  },
  {
    "text": "um Source quench if you're sending a host too fast and the information too",
    "start": "540600",
    "end": "546200"
  },
  {
    "text": "fast then the host will issue you back a source quen or message Red Direct will",
    "start": "546200",
    "end": "552320"
  },
  {
    "text": "tell you a router that sits on your Sam network will tell you to use another router on the same network for future",
    "start": "552320",
    "end": "559760"
  },
  {
    "text": "routing to the host you try to route to or time exceeded you have two me two",
    "start": "559760",
    "end": "566720"
  },
  {
    "text": "type of messages here whether the IP time to leave ex uh field value reaches",
    "start": "566720",
    "end": "572399"
  },
  {
    "text": "zero then the time exceeded error message will be issued and when a host",
    "start": "572399",
    "end": "577959"
  },
  {
    "text": "fails to um com um combine fragmented uh pieces of the information",
    "start": "577959",
    "end": "585160"
  },
  {
    "text": "you sent you will get a Time exceeded fragment reassembly time",
    "start": "585160",
    "end": "590480"
  },
  {
    "text": "exceeded uh the last errow message is par met problem which will be issued",
    "start": "590480",
    "end": "596240"
  },
  {
    "text": "when um a field in inside the IP header will have u a bad content such as if we",
    "start": "596240",
    "end": "604120"
  },
  {
    "text": "will play especially with three Fields the uh header length and the total IP",
    "start": "604120",
    "end": "609760"
  },
  {
    "text": "length and with the IP option then we will get back a paret problem error",
    "start": "609760",
    "end": "615040"
  },
  {
    "text": "message just a quick review on those we can use all query message for host",
    "start": "615040",
    "end": "620240"
  },
  {
    "text": "detection whether host answers our queries then he is alive on the internet",
    "start": "620240",
    "end": "627600"
  },
  {
    "text": "and he is there there and we can use more advanced host detection error",
    "start": "627600",
    "end": "634079"
  },
  {
    "text": "messages if we're sending an offending packet that will releaseit back and icmp er message then again we can um just uh",
    "start": "634079",
    "end": "644639"
  },
  {
    "text": "find a host that issued the icmp error message and he is alive there are some dirty tricks with u",
    "start": "644639",
    "end": "651519"
  },
  {
    "text": "with those error messages and packet that initiate",
    "start": "651519",
    "end": "656040"
  },
  {
    "text": "those if we are an attacker on the internet we will look for a certain piece of",
    "start": "658040",
    "end": "665079"
  },
  {
    "text": "information uh we will look for uh what host are available for our attack we",
    "start": "665079",
    "end": "671920"
  },
  {
    "text": "will look for the services that are running on the host uh we will use a port scanner to uh understand what are",
    "start": "671920",
    "end": "680519"
  },
  {
    "text": "the open ports and then we will uh try to fingerprint the operating",
    "start": "680519",
    "end": "686560"
  },
  {
    "text": "system used by the host all this information will give us a clear indication about the host the operating",
    "start": "686560",
    "end": "693200"
  },
  {
    "text": "system and maybe a service which may be vulnerable to an exploit that we can use",
    "start": "693200",
    "end": "698480"
  },
  {
    "text": "and to penetrate into the network again icmp is unique is uh usage",
    "start": "698480",
    "end": "707800"
  },
  {
    "text": "is unique because we are using less and less traffic in order to get to those",
    "start": "707800",
    "end": "713720"
  },
  {
    "text": "results uh all the all the U methods you will see in this presentation where were",
    "start": "713720",
    "end": "719440"
  },
  {
    "text": "discovered by me during my icmp",
    "start": "719440",
    "end": "723519"
  },
  {
    "text": "research for active operating system fingerprinting we can use three types of",
    "start": "725120",
    "end": "730800"
  },
  {
    "text": "data grams we can use a regular icmp query message we can use a crafted icmp",
    "start": "730800",
    "end": "737320"
  },
  {
    "text": "query message and we can use icmp error",
    "start": "737320",
    "end": "743600"
  },
  {
    "text": "messages the first approach is the who answer what approach this means that I",
    "start": "746079",
    "end": "752360"
  },
  {
    "text": "query the host see what he answered for for which kind of query messages build",
    "start": "752360",
    "end": "758320"
  },
  {
    "text": "myself a table or a database holding this information and then when I prob a host",
    "start": "758320",
    "end": "765560"
  },
  {
    "text": "I will try to correlate the information I get with the database of fingerprinting that I",
    "start": "765560",
    "end": "772199"
  },
  {
    "text": "have this uh kind of approach was very useful until Microsoft Windows 20",
    "start": "772199",
    "end": "779399"
  },
  {
    "text": "family of operating system were launched uh Linux and uh the BSD",
    "start": "779399",
    "end": "785199"
  },
  {
    "text": "variants have used uh their default cons uh configuration to answer for icmp",
    "start": "785199",
    "end": "791000"
  },
  {
    "text": "query uh two types uh icmp time request and icmp Echo request now when Microsoft",
    "start": "791000",
    "end": "798760"
  },
  {
    "text": "released wi 2K they do the same they mimic the behavior of BSD and if you'll",
    "start": "798760",
    "end": "805920"
  },
  {
    "text": "see David LeBlanc you will say no way we do not do that but yeah they mimic a bit of the behavior of",
    "start": "805920",
    "end": "811760"
  },
  {
    "text": "the Unix operating systems and I will show you and demonstrate later why I tell this why I say this and they'll do",
    "start": "811760",
    "end": "820000"
  },
  {
    "text": "the same we can use another uh question or",
    "start": "820000",
    "end": "828519"
  },
  {
    "text": "uh I think to build a database which is a question which operating system will answer to queries aim at the broadcast",
    "start": "828519",
    "end": "835560"
  },
  {
    "text": "or the network address of the network they reside on um all the Microsoft based operating",
    "start": "835560",
    "end": "842279"
  },
  {
    "text": "systems except for nt4 which has an SP less than sp4 will not answer for any",
    "start": "842279",
    "end": "850320"
  },
  {
    "text": "broadcast uh attempt um usually those operating systems will be Unix and Unix like",
    "start": "850320",
    "end": "857040"
  },
  {
    "text": "operating systems uh we can uh map with this approach ultrix Linux s Solaris and HP",
    "start": "857040",
    "end": "866199"
  },
  {
    "text": "and X based machines um we can have a",
    "start": "866199",
    "end": "871600"
  },
  {
    "text": "three-step um we can see here a three-step diagram which describes this",
    "start": "871600",
    "end": "877079"
  },
  {
    "text": "approach one of uh the possibilities first we issue an icmp",
    "start": "877079",
    "end": "882920"
  },
  {
    "text": "times Temple request to the broadcast address we are targeting uh Solaris hpu and Linux will",
    "start": "882920",
    "end": "890639"
  },
  {
    "text": "answer our query we will take those IPS and query them with icmp information request again",
    "start": "890639",
    "end": "897880"
  },
  {
    "text": "AED at a broadcast address we will see that hpu based machine will answer us and solarus and",
    "start": "897880",
    "end": "904639"
  },
  {
    "text": "Linux will not we will take a third step and just",
    "start": "904639",
    "end": "910480"
  },
  {
    "text": "query those those IPS with ICP address Mas request a regular one aimed at the",
    "start": "910480",
    "end": "917839"
  },
  {
    "text": "specific IP the reply we will get from saris and Linux will not reply",
    "start": "917839",
    "end": "925160"
  },
  {
    "text": "yes um no you can set it uh and change it but they",
    "start": "926839",
    "end": "933120"
  },
  {
    "text": "did not change that as I",
    "start": "933120",
    "end": "937839"
  },
  {
    "text": "remember all those uh Behavior types are default out of the box",
    "start": "938199",
    "end": "944600"
  },
  {
    "text": "installations and sure you have some um options that you can disable those but",
    "start": "944600",
    "end": "952399"
  },
  {
    "text": "again if your box answer for uh time St or information request aimed at the broadcast address or answer for anything",
    "start": "952399",
    "end": "959880"
  },
  {
    "text": "that aimed at the broadcast address then you have trouble sure the RSC",
    "start": "959880",
    "end": "968120"
  },
  {
    "text": "states that it is not anormal Behavior to answer those",
    "start": "968120",
    "end": "973519"
  },
  {
    "text": "queries um it's also state that it may be silently discarded by a host so this",
    "start": "973519",
    "end": "980920"
  },
  {
    "text": "is not an abnormal behavior and Microsoft behaves correctly well with this one at",
    "start": "980920",
    "end": "987519"
  },
  {
    "text": "least one of my uh favorite IP header Fields",
    "start": "987519",
    "end": "993800"
  },
  {
    "text": "is the IP T to Le field we have to understand that uh we have",
    "start": "993800",
    "end": "999560"
  },
  {
    "text": "basically um two field values used here or two uh numbers used with",
    "start": "999560",
    "end": "1007560"
  },
  {
    "text": "icmp um this field represent the maximum time the datagram is allowed to travel",
    "start": "1007560",
    "end": "1012800"
  },
  {
    "text": "on the internet it was intended to be um um set as the max maximum time this",
    "start": "1012800",
    "end": "1019720"
  },
  {
    "text": "uh datagram will travel so we will not have datagrams traveling older I mean",
    "start": "1019720",
    "end": "1027079"
  },
  {
    "text": "all the time around the internet and nobody will stop those um this field value will be",
    "start": "1027079",
    "end": "1032558"
  },
  {
    "text": "decreased at each point that the internet head the IP header sorry is being",
    "start": "1032559",
    "end": "1037839"
  },
  {
    "text": "processed um it may be longer than a second for a",
    "start": "1037839",
    "end": "1044000"
  },
  {
    "text": "device to process this uh datagram so if you thinking that this is a something that will state how many seconds or how",
    "start": "1044000",
    "end": "1052320"
  },
  {
    "text": "much time it took to a datagram to arrive for one point to another then it's",
    "start": "1052320",
    "end": "1058200"
  },
  {
    "text": "false the RC also states that the maximum uh value we can set is fi to is",
    "start": "1058200",
    "end": "1064799"
  },
  {
    "text": "255 which is equal to 4 2 25",
    "start": "1064799",
    "end": "1071919"
  },
  {
    "text": "minutes okay I talked about that as",
    "start": "1077400",
    "end": "1083440"
  },
  {
    "text": "well IP has two separate values we have to remember that two separate values",
    "start": "1083440",
    "end": "1089919"
  },
  {
    "text": "that are not the same like TCP and UDP one value used for icmp query messages",
    "start": "1089919",
    "end": "1096640"
  },
  {
    "text": "and one value is used for query replies this unique field value help us",
    "start": "1096640",
    "end": "1104240"
  },
  {
    "text": "to identify certain operating systems and group of operating system",
    "start": "1104240",
    "end": "1109679"
  },
  {
    "text": "systems this is as well the simplest way to fingerprint an operating",
    "start": "1109679",
    "end": "1116320"
  },
  {
    "text": "system if we will look at the uh IP query replies at first we can see that",
    "start": "1121720",
    "end": "1129280"
  },
  {
    "text": "the regular values that we will see will be 255 128 64 and",
    "start": "1129280",
    "end": "1135440"
  },
  {
    "text": "32 now those will not be the original assigned values to the datagrams that we",
    "start": "1135440",
    "end": "1141440"
  },
  {
    "text": "be uh get back from the host we query because along the way some uh um",
    "start": "1141440",
    "end": "1147520"
  },
  {
    "text": "stations or some hops decrease this number so how can we uh guess what was",
    "start": "1147520",
    "end": "1153200"
  },
  {
    "text": "the uh initial number assigned to this",
    "start": "1153200",
    "end": "1158039"
  },
  {
    "text": "value we have those values I stated before and if for example I will see 214",
    "start": "1159080",
    "end": "1166000"
  },
  {
    "text": "as the iptl field value it will be um a good uh conclusion to make that it",
    "start": "1166000",
    "end": "1174640"
  },
  {
    "text": "was ver sign with the value of 255 there is a second approach that says",
    "start": "1174640",
    "end": "1181840"
  },
  {
    "text": "that we can use trace route or Trace RT in win 2K uh in order to trace back to the host",
    "start": "1181840",
    "end": "1188960"
  },
  {
    "text": "and know the number of hops between us and the target this is only a good",
    "start": "1188960",
    "end": "1196679"
  },
  {
    "text": "guess we will see that some of the uh people in the security industry use this approach in order to passively map um",
    "start": "1196679",
    "end": "1206480"
  },
  {
    "text": "host for example when someone queries you there is a unique IP TTL field value",
    "start": "1206480",
    "end": "1212320"
  },
  {
    "text": "assigned and they want to see um what is the accurate value it was assigned in uh",
    "start": "1212320",
    "end": "1219840"
  },
  {
    "text": "at first it was it 255 128 64 32 so what they claim is you see the value you get",
    "start": "1219840",
    "end": "1228840"
  },
  {
    "text": "for example 238 which is the IP time to leave field",
    "start": "1228840",
    "end": "1234280"
  },
  {
    "text": "value which I got back from my box in Chicago in the hosting facility you can",
    "start": "1234280",
    "end": "1241679"
  },
  {
    "text": "try to hack it but they kill you um so if you do a quick math you take",
    "start": "1241679",
    "end": "1252200"
  },
  {
    "text": "255 and you take off 2 38 you get",
    "start": "1252440",
    "end": "1259039"
  },
  {
    "text": "17 right so you say 16 hops I will have the Gateway",
    "start": "1259039",
    "end": "1267280"
  },
  {
    "text": "right silence right okay",
    "start": "1267280",
    "end": "1273158"
  },
  {
    "text": "wrong why is wrong here I take the trace RT command and states that it should be",
    "start": "1273440",
    "end": "1279799"
  },
  {
    "text": "using 16 hops only to get back to my website now as you can see after 12 hops",
    "start": "1279799",
    "end": "1287480"
  },
  {
    "text": "I'm getting back to my website now where are those four hops or five",
    "start": "1287480",
    "end": "1293200"
  },
  {
    "text": "hops missing well if you remember a router May process the the dagram more than 1",
    "start": "1293200",
    "end": "1301320"
  },
  {
    "text": "second or in my case I was in Israel and I trace this back to the United",
    "start": "1301320",
    "end": "1308440"
  },
  {
    "text": "States so when the packet traveled from the states to my house and from my house",
    "start": "1308440",
    "end": "1314279"
  },
  {
    "text": "to the United States it takes two different paths",
    "start": "1314279",
    "end": "1319400"
  },
  {
    "text": "this is routing so don't use that especially if",
    "start": "1319400",
    "end": "1325320"
  },
  {
    "text": "you want to passively understand who's the guy behind those pings you",
    "start": "1325320",
    "end": "1331760"
  },
  {
    "text": "get if we make a quick table we can see that we have some unique",
    "start": "1331760",
    "end": "1339080"
  },
  {
    "text": "values Linux based on Corell 2.2 and 2.4 will use",
    "start": "1339080",
    "end": "1344480"
  },
  {
    "text": "255 uh Carell 2.0 and dgu X which is not stated here will use 64 other Unix",
    "start": "1344480",
    "end": "1352480"
  },
  {
    "text": "variance will use 255 and if we look closely at a great",
    "start": "1352480",
    "end": "1357679"
  },
  {
    "text": "implementation from Redmont we will see Microsoft Windows 95 uses 32 instead of",
    "start": "1357679",
    "end": "1364240"
  },
  {
    "text": "128 as the other Microsoft based operating systems now if David LeBlanc",
    "start": "1364240",
    "end": "1370200"
  },
  {
    "text": "was here he was saying yeah but we released win 2 win 95 like ages ago so",
    "start": "1370200",
    "end": "1377760"
  },
  {
    "text": "what but still I have a valid point here I have a unique operating system with a",
    "start": "1377760",
    "end": "1385200"
  },
  {
    "text": "unique value which I can understand what is the operating system I can all Al",
    "start": "1385200",
    "end": "1390880"
  },
  {
    "text": "also group the operating systems according to the initial values assigned",
    "start": "1390880",
    "end": "1396200"
  },
  {
    "text": "the Unix and Unix like variant uh the G which is now a compact",
    "start": "1396200",
    "end": "1402080"
  },
  {
    "text": "264 and Linux 20 and the other Microsoft based operating systems this is simple",
    "start": "1402080",
    "end": "1408840"
  },
  {
    "text": "I'm just issuing ping from my box and I just see this information",
    "start": "1408840",
    "end": "1414559"
  },
  {
    "text": "coming back to me it's not just it's not that hard to",
    "start": "1414559",
    "end": "1420919"
  },
  {
    "text": "do now we have this fun with the request as well again the value we will see when we",
    "start": "1421600",
    "end": "1429520"
  },
  {
    "text": "will see those requests hitting our uh IDS system will not be those who was",
    "start": "1429520",
    "end": "1435360"
  },
  {
    "text": "first assign to the to this field so how we can guess what was the initial value",
    "start": "1435360",
    "end": "1442000"
  },
  {
    "text": "again we know that there are some default values used we can use those or",
    "start": "1442000",
    "end": "1448240"
  },
  {
    "text": "we can use the faulty uh um thing I just uh talked about here well it's better to",
    "start": "1448240",
    "end": "1456120"
  },
  {
    "text": "guess than to do defaulty",
    "start": "1456120",
    "end": "1459919"
  },
  {
    "text": "thing now especially if you are trying to passively fingerprint someone then if",
    "start": "1464559",
    "end": "1470840"
  },
  {
    "text": "you will hit him back he will just understand that someone just understand that he is pinging and he will stop and",
    "start": "1470840",
    "end": "1477440"
  },
  {
    "text": "run away especially if this is a script Kitty with AOL connection you'll not see",
    "start": "1477440",
    "end": "1482960"
  },
  {
    "text": "him again now this message is passive we do not need to do anything",
    "start": "1482960",
    "end": "1490640"
  },
  {
    "text": "active now the nice thing here I will give you the great thing first is the wi",
    "start": "1490640",
    "end": "1497399"
  },
  {
    "text": "Tok family all the other operating system which I have mapped and there is a big",
    "start": "1497399",
    "end": "1502760"
  },
  {
    "text": "list in my uh research paper uh use other values for example",
    "start": "1502760",
    "end": "1508480"
  },
  {
    "text": "Linux 64 Unix and Unix variance 255 all the other Microsoft box 32 and here is",
    "start": "1508480",
    "end": "1515240"
  },
  {
    "text": "Win 2K with 128 why someone has a",
    "start": "1515240",
    "end": "1522399"
  },
  {
    "text": "yes come on I don't know simply",
    "start": "1522399",
    "end": "1528640"
  },
  {
    "text": "128 seems nice to Microsoft so here is",
    "start": "1528640",
    "end": "1533880"
  },
  {
    "text": "128 again we can take this group and you know we have another group",
    "start": "1534559",
    "end": "1544320"
  },
  {
    "text": "here with Linux and with the other unixes and Unix variants and the other",
    "start": "1544320",
    "end": "1549760"
  },
  {
    "text": "Microsoft based operating systems so if we look closely we will",
    "start": "1549760",
    "end": "1555559"
  },
  {
    "text": "see that with a regular win 2K member we see 32 in their request 128 in their",
    "start": "1555559",
    "end": "1563480"
  },
  {
    "text": "reply we see uh some other operating systems with unique values so this is",
    "start": "1563480",
    "end": "1569880"
  },
  {
    "text": "really a dumb thing which you can use in order to actively and passively",
    "start": "1569880",
    "end": "1575760"
  },
  {
    "text": "fingerprint an operating system other stuff are",
    "start": "1575760",
    "end": "1582880"
  },
  {
    "text": "more uh Technical and uh well I had to think about them more than I had to",
    "start": "1582880",
    "end": "1589799"
  },
  {
    "text": "think about the time to live field we have on our IP header a nice",
    "start": "1589799",
    "end": "1596039"
  },
  {
    "text": "field called the type of service bite before before people will jump and say",
    "start": "1596039",
    "end": "1602200"
  },
  {
    "text": "yes it is being uh now uh replaced by the def service and quality of service",
    "start": "1602200",
    "end": "1608919"
  },
  {
    "text": "stuff but only Microsoft wik actually uh implemented this RFC and all the other",
    "start": "1608919",
    "end": "1616360"
  },
  {
    "text": "operating system just uh using the old rfcs and still did not",
    "start": "1616360",
    "end": "1623840"
  },
  {
    "text": "implement the quality of service yet so we have three Fields inside this bite",
    "start": "1623840",
    "end": "1630960"
  },
  {
    "text": "prising field which is used to prioritize IP datagrams the type of",
    "start": "1630960",
    "end": "1637320"
  },
  {
    "text": "service field which describe how the network should make Pras before between",
    "start": "1637320",
    "end": "1642880"
  },
  {
    "text": "throughput delay relability and cost in routing those IP datagram",
    "start": "1642880",
    "end": "1648120"
  },
  {
    "text": "and another nice little bit called it must be zero bit which I like the",
    "start": "1648120",
    "end": "1655520"
  },
  {
    "text": "most there are some rules which RFC 1122 which describe the host requirements",
    "start": "1655799",
    "end": "1662799"
  },
  {
    "text": "States and there are um about uh the way those uh these proceeding bits should be",
    "start": "1662799",
    "end": "1670399"
  },
  {
    "text": "handled well it doesn't say anything it only states that the dod has a special",
    "start": "1670399",
    "end": "1676159"
  },
  {
    "text": "meaning of the usage of of these fields well I asked the dod guys on my training session blessa and they did not know why",
    "start": "1676159",
    "end": "1685760"
  },
  {
    "text": "they did just W this in the first place RFC 1812 requirements for IP",
    "start": "1685760",
    "end": "1693480"
  },
  {
    "text": "version 4 router states that an icmp reply message must have its IP preceding",
    "start": "1693480",
    "end": "1698679"
  },
  {
    "text": "field set to the value as the IP proing filled in the icmp request that provoke",
    "start": "1698679",
    "end": "1704640"
  },
  {
    "text": "their reply I live I love the language provoke the",
    "start": "1704640",
    "end": "1710320"
  },
  {
    "text": "reply okay but if we think about it it has its logic if we just want to prioritize",
    "start": "1710320",
    "end": "1717799"
  },
  {
    "text": "something what we want us what we want this packet or this datagram to come",
    "start": "1717799",
    "end": "1723159"
  },
  {
    "text": "back fast as possible now sure uh I was thinking that it might",
    "start": "1723159",
    "end": "1730480"
  },
  {
    "text": "be more than that here this example with a tool called",
    "start": "1730480",
    "end": "1736080"
  },
  {
    "text": "Sing which is is the Swiss army knife for icmp developed by a Spanish guy",
    "start": "1736080",
    "end": "1741600"
  },
  {
    "text": "called Andreas Alfredo Oma um is being used here I'm sending five datagrams",
    "start": "1741600",
    "end": "1750279"
  },
  {
    "text": "with the type of service bik set to 10028 this means the first bit of the",
    "start": "1750279",
    "end": "1755919"
  },
  {
    "text": "proceeding bit is highlighted to a certain uh IP address of an x43 box as",
    "start": "1755919",
    "end": "1764279"
  },
  {
    "text": "you can see from the reply the type of service which I get back back is 128 this is all nice and well",
    "start": "1764279",
    "end": "1773200"
  },
  {
    "text": "but when I do this the trick with a Microsoft windows-based machine running",
    "start": "1773200",
    "end": "1778799"
  },
  {
    "text": "a win 2K then it all starts to be more",
    "start": "1778799",
    "end": "1784519"
  },
  {
    "text": "nicer see this this is zero why is this",
    "start": "1784519",
    "end": "1790120"
  },
  {
    "text": "zero well according to Microsoft they want to implement the new RFC but I",
    "start": "1790120",
    "end": "1796960"
  },
  {
    "text": "doubt it it we have another operating system who",
    "start": "1796960",
    "end": "1804720"
  },
  {
    "text": "do the same which is ultrix yeah I had actually found an old ultrix box and it",
    "start": "1804720",
    "end": "1810559"
  },
  {
    "text": "really pissed me off to see that it has the same behavioral patter as the win 2K did Microsoft look at the ultrix to",
    "start": "1810559",
    "end": "1817720"
  },
  {
    "text": "understand the behavior I don't think so uh to our rescue there is the IP time",
    "start": "1817720",
    "end": "1823880"
  },
  {
    "text": "to leave field assign 255 who win 2K and sorry 255 with the ulri and 128 with the",
    "start": "1823880",
    "end": "1831360"
  },
  {
    "text": "win2k rescuing us from this",
    "start": "1831360",
    "end": "1835720"
  },
  {
    "text": "problem we have as well changed patterns with this kind of icmp query message",
    "start": "1836960",
    "end": "1842399"
  },
  {
    "text": "type now you have to understand that some operating systems implemented differently the different types of query",
    "start": "1842399",
    "end": "1851559"
  },
  {
    "text": "messages youve been thinking that if I have one query message since we have so much fields that are alike will be",
    "start": "1851559",
    "end": "1858679"
  },
  {
    "text": "implemented the same well again you are wrong if we look at this",
    "start": "1858679",
    "end": "1865279"
  },
  {
    "text": "diagram uh another three-step amazingly drawn visual",
    "start": "1865279",
    "end": "1870679"
  },
  {
    "text": "diagram which I have made we see that if we are using icmp Echo request with the pring bits different than",
    "start": "1870679",
    "end": "1878159"
  },
  {
    "text": "zero we can see that when 2K family and ulri will uh send us zero as this field",
    "start": "1878159",
    "end": "1885960"
  },
  {
    "text": "again we differentiate Windows 2 as I explained before if we will send an ICP",
    "start": "1885960",
    "end": "1892519"
  },
  {
    "text": "time temp time stamp request with this proceeding bit set to a number different than zero to the other IPS of the",
    "start": "1892519",
    "end": "1898679"
  },
  {
    "text": "operating system we wish to understand what they are we will see that Windows",
    "start": "1898679",
    "end": "1904760"
  },
  {
    "text": "98 98 SE me and wind 2K now uh will",
    "start": "1904760",
    "end": "1910399"
  },
  {
    "text": "reply with zero as well as the altrix box and open VMS now since we know that Microsoft",
    "start": "1910399",
    "end": "1916760"
  },
  {
    "text": "Windows 2K from this step and we also understand what is an ultrix box here",
    "start": "1916760",
    "end": "1923559"
  },
  {
    "text": "and we can use again the IP time to leave field we see that we have the open VMS here and the other group of 98 98 SE",
    "start": "1923559",
    "end": "1932279"
  },
  {
    "text": "and me here now the last step will be sending an icmp address Mas request to",
    "start": "1932279",
    "end": "1937880"
  },
  {
    "text": "those machines identifying Microsoft Windows me and the 98 98c group of",
    "start": "1937880",
    "end": "1945039"
  },
  {
    "text": "operating systems again this is a threep uh diagram where I have",
    "start": "1945039",
    "end": "1950880"
  },
  {
    "text": "identified ultrix Microsoft wink open VMS winme and win 98 98c",
    "start": "1950880",
    "end": "1961360"
  },
  {
    "text": "simple so we have another two field here we",
    "start": "1962760",
    "end": "1968279"
  },
  {
    "text": "just cannot let them without any check the type of service uh field has",
    "start": "1968279",
    "end": "1975519"
  },
  {
    "text": "its own way of usage it relates to Arrow messages qu",
    "start": "1975519",
    "end": "1982519"
  },
  {
    "text": "messages and reply messages there is three qus saying what we should do with",
    "start": "1982519",
    "end": "1987919"
  },
  {
    "text": "each of one of those messages error messages should always be",
    "start": "1987919",
    "end": "1993720"
  },
  {
    "text": "sent with the default type of service request messages may be sent with any type of service value and the",
    "start": "1993720",
    "end": "2001559"
  },
  {
    "text": "reply messages should be sent with the same value as the type of Serv field",
    "start": "2001559",
    "end": "2007519"
  },
  {
    "text": "that it was corresponding in the ismp request well it is nice to see that",
    "start": "2007519",
    "end": "2013760"
  },
  {
    "text": "there are rules and again if we will look closely we will see some of the operating system violates",
    "start": "2013760",
    "end": "2022518"
  },
  {
    "text": "[Applause] those this example was produced against the FreeBSD 40 machine again with s we",
    "start": "2023160",
    "end": "2031440"
  },
  {
    "text": "see that I have sent a valid type of service field value which is eight and I",
    "start": "2031440",
    "end": "2036960"
  },
  {
    "text": "receiv received it back from the operating system if I have sent here a non-legit",
    "start": "2036960",
    "end": "2044000"
  },
  {
    "text": "type of service uh value it echoed it back as",
    "start": "2044000",
    "end": "2050240"
  },
  {
    "text": "well as we saw before when 2K has a unique interpretation and again this was the",
    "start": "2050240",
    "end": "2057118"
  },
  {
    "text": "case with this bits again I'm sending a type of service field value of eight and",
    "start": "2057119",
    "end": "2064358"
  },
  {
    "text": "receiving zero",
    "start": "2064359",
    "end": "2068878"
  },
  {
    "text": "if you look again at this again three-step diagram we can see that",
    "start": "2076280",
    "end": "2081440"
  },
  {
    "text": "Orrick and Noel network has the same behavioral patterns as Windows 2K family",
    "start": "2081440",
    "end": "2087560"
  },
  {
    "text": "we can do uh we can divide those according to the iptl and identify all tricks and",
    "start": "2087560",
    "end": "2094158"
  },
  {
    "text": "again use another trick here which is IP time time stamp request with the win box",
    "start": "2094159",
    "end": "2100320"
  },
  {
    "text": "will will reply and the novel box will not novel also answers for icmp Echo",
    "start": "2100320",
    "end": "2107160"
  },
  {
    "text": "request and that's it with the other group of ips we have excuse me we can",
    "start": "2107160",
    "end": "2113320"
  },
  {
    "text": "send an IP time stamp request again with a value different than zero and guess",
    "start": "2113320",
    "end": "2118520"
  },
  {
    "text": "what 98 98c and me will reply with time time of type of service zero we can then",
    "start": "2118520",
    "end": "2125520"
  },
  {
    "text": "again send another icmp arment's request and map between 98 and the Mi",
    "start": "2125520",
    "end": "2132720"
  },
  {
    "text": "boxes the last field within this bite is the unus bit well sure should be zero",
    "start": "2133520",
    "end": "2142320"
  },
  {
    "text": "nobody will set it up but again why not setting it up and see what",
    "start": "2142320",
    "end": "2148160"
  },
  {
    "text": "happens with Unix and Unix variants as we can see here with 3 BSD sending uh",
    "start": "2149000",
    "end": "2155480"
  },
  {
    "text": "this bit lighten up will uh end up with getting him",
    "start": "2155480",
    "end": "2161160"
  },
  {
    "text": "back is this normal I don't know if this according to RFC RFC is not stating the",
    "start": "2161160",
    "end": "2168000"
  },
  {
    "text": "accurate Behavior here but you have expected that this field will not be echoed back and will be",
    "start": "2168000",
    "end": "2176079"
  },
  {
    "text": "zero win 2K again will Zero out this field on the",
    "start": "2176520",
    "end": "2184000"
  },
  {
    "text": "reply all tricks are trength will do the same so how can we",
    "start": "2184000",
    "end": "2192000"
  },
  {
    "text": "differentiate again according to the IP time to live field value we can differentiate between win 2K family and",
    "start": "2192000",
    "end": "2198720"
  },
  {
    "text": "ultrix and again with some other steps we can have open VMS winme me and win",
    "start": "2198720",
    "end": "2207440"
  },
  {
    "text": "9898 now when Microsoft release wik someone from Microsoft stated that they",
    "start": "2207440",
    "end": "2214760"
  },
  {
    "text": "were trying to do a better job at hiding their operating system now if",
    "start": "2214760",
    "end": "2220079"
  },
  {
    "text": "you will meet David lablanc he will say no way but we cannot argue with the",
    "start": "2220079",
    "end": "2225800"
  },
  {
    "text": "facts they were trying to make wi 2K a bit harder to understand what it is and",
    "start": "2225800",
    "end": "2231480"
  },
  {
    "text": "all those methods just highlight when 2K",
    "start": "2231480",
    "end": "2237280"
  },
  {
    "text": "out why this type of service bite is so hard uh or its behavior is not that good",
    "start": "2237280",
    "end": "2245560"
  },
  {
    "text": "with Microsoft well I guess because of this uh registry value",
    "start": "2245560",
    "end": "2253480"
  },
  {
    "text": "if we look at the default TS value it is set to zero there is no uh way to set",
    "start": "2253480",
    "end": "2261800"
  },
  {
    "text": "this uh to something that comes in it just stays zero or you can set it to a",
    "start": "2261800",
    "end": "2268079"
  },
  {
    "text": "value between 0 and 255 we can override and overwritten this",
    "start": "2268079",
    "end": "2275680"
  },
  {
    "text": "uh regist value if we will set the IP uncore type of service uh option as long",
    "start": "2275680",
    "end": "2282960"
  },
  {
    "text": "as the disabled user type of service set settings is not set as well or by",
    "start": "2282960",
    "end": "2288760"
  },
  {
    "text": "enabling the quality of service policy on Windows 2K so",
    "start": "2288760",
    "end": "2295560"
  },
  {
    "text": "apparently nobody at Redmont just bothered to read the",
    "start": "2295560",
    "end": "2301280"
  },
  {
    "text": "RFC another nice thing we can do is setting the don't fragment bit with our",
    "start": "2302359",
    "end": "2308760"
  },
  {
    "text": "requests and see what happens will the operating systems that we query will set",
    "start": "2308760",
    "end": "2314599"
  },
  {
    "text": "this bit and equo actually back to us um if you know there are um three",
    "start": "2314599",
    "end": "2322800"
  },
  {
    "text": "operating systems that will set the don't fragment bit on default when you query them those are sun",
    "start": "2322800",
    "end": "2330640"
  },
  {
    "text": "Solaris a forx and hpu x with a little twist so I was thinking if other",
    "start": "2330640",
    "end": "2340200"
  },
  {
    "text": "operating system Echo other fields why not trying this one this one is a bit more",
    "start": "2340200",
    "end": "2349160"
  },
  {
    "text": "tricky again we just lighten up the DF bit with the IP Echo request the",
    "start": "2349680",
    "end": "2355920"
  },
  {
    "text": "operating systems which do not Echo back the DF bit and they should not if you",
    "start": "2355920",
    "end": "2361680"
  },
  {
    "text": "think about it uh they really should not Echo back our Linux ultrix and novel",
    "start": "2361680",
    "end": "2368560"
  },
  {
    "text": "netware um Linux and ultrix uh vary and the iptl field value and again we can",
    "start": "2368560",
    "end": "2376599"
  },
  {
    "text": "set them away and we have Noel as well the second step will we will do the same trick with",
    "start": "2376599",
    "end": "2385000"
  },
  {
    "text": "just this down with icmp address masks now the operating system that will not Echo back the DF bit will be wind",
    "start": "2385000",
    "end": "2392760"
  },
  {
    "text": "Windows 98 98 SC and ultrix so we have all those operating systems map the last",
    "start": "2392760",
    "end": "2399720"
  },
  {
    "text": "trick here is to send the DF the DF bit with thecmp Tim stamp this time we'll",
    "start": "2399720",
    "end": "2406280"
  },
  {
    "text": "have Linux uh nearly well Microsoft Windows 98 98 me 2K and ultrix do not",
    "start": "2406280",
    "end": "2414599"
  },
  {
    "text": "Echo this value now we identified Linux ultrix Noel win 98 98 and orrix",
    "start": "2414599",
    "end": "2421760"
  },
  {
    "text": "previously then it will leave us with Microsoft Windows me and Microsoft",
    "start": "2421760",
    "end": "2427000"
  },
  {
    "text": "Windows 2K but if you look closely at our replies if you remember whenn 2K",
    "start": "2427000",
    "end": "2432480"
  },
  {
    "text": "will give us the value of 128 as the IP time to lefeld value and again we can",
    "start": "2432480",
    "end": "2438800"
  },
  {
    "text": "differentiate between Microsoft me and win 2K basically we ma 98 98c Microsoft",
    "start": "2438800",
    "end": "2447000"
  },
  {
    "text": "win2k Microsoft me um Linux ultrix and no netware three",
    "start": "2447000",
    "end": "2453720"
  },
  {
    "text": "steps uh just required",
    "start": "2453720",
    "end": "2458319"
  },
  {
    "text": "the next thing I'm going to speak about is what I call the ultimate who is a Windows box machine",
    "start": "2460839",
    "end": "2467960"
  },
  {
    "text": "test uh this was actually my first my first pass to uh",
    "start": "2467960",
    "end": "2473440"
  },
  {
    "text": "Burek um a long time ago uh apparently Microsoft were not thinking this is",
    "start": "2473440",
    "end": "2479839"
  },
  {
    "text": "worthy to change RFC states that when you send an",
    "start": "2479839",
    "end": "2487079"
  },
  {
    "text": "icmp EO request all you need to do when you get the request to your box is to",
    "start": "2487079",
    "end": "2494680"
  },
  {
    "text": "change the type of message to icmp Echo reply this means to change the type of",
    "start": "2494680",
    "end": "2500280"
  },
  {
    "text": "message from 08 to 0 0 recalculate the",
    "start": "2500280",
    "end": "2505319"
  },
  {
    "text": "check sums and send the reply back now I want it to be",
    "start": "2505319",
    "end": "2511720"
  },
  {
    "text": "nasty I took the code field and changed itjust put a value 26 hex instead of",
    "start": "2511720",
    "end": "2518359"
  },
  {
    "text": "zero sent to a Linux machine and I saw that they comply with the RFC this is",
    "start": "2518359",
    "end": "2524920"
  },
  {
    "text": "what nice but again with the w Microsoft Windows uh operating",
    "start": "2524920",
    "end": "2531800"
  },
  {
    "text": "systems they have their own unique Behavior I call it I play God",
    "start": "2531800",
    "end": "2538480"
  },
  {
    "text": "Behavior why sending an icmp echo reply with a code field set to a value",
    "start": "2538599",
    "end": "2544480"
  },
  {
    "text": "different than zero this is the answer I got one day well who tells you have to",
    "start": "2544480",
    "end": "2551319"
  },
  {
    "text": "do that RFC State change the type recalculate the checkm and send it back",
    "start": "2551319",
    "end": "2558240"
  },
  {
    "text": "you are not um you do not have to validate the IP Echo request it's it's",
    "start": "2558240",
    "end": "2564680"
  },
  {
    "text": "simply not your job to do well again they had their own",
    "start": "2564680",
    "end": "2572240"
  },
  {
    "text": "reasons so all the Microsoft based operating system",
    "start": "2572240",
    "end": "2577400"
  },
  {
    "text": "nevertheless whatever they have there which we can say 95 98 98c Microsoft me",
    "start": "2577400",
    "end": "2585000"
  },
  {
    "text": "2K 2K sp1 all those uh hot fixes blah blah blah will do the same all Unix and",
    "start": "2585000",
    "end": "2592880"
  },
  {
    "text": "Unix like operating systems networking devices will leave this code field set",
    "start": "2592880",
    "end": "2599480"
  },
  {
    "text": "to the value will send them which will make Microsoft based operating system",
    "start": "2599480",
    "end": "2605599"
  },
  {
    "text": "alone in the world with this kind of behavior now if you think about the",
    "start": "2605599",
    "end": "2612319"
  },
  {
    "text": "stuff I've shown you until this point you can do combo datagrams as well just",
    "start": "2612319",
    "end": "2618680"
  },
  {
    "text": "let me uh finish this",
    "start": "2618680",
    "end": "2624318"
  },
  {
    "text": "one with icmp timestamp request sending the code feeli different than zero I had",
    "start": "2624880",
    "end": "2631520"
  },
  {
    "text": "a revision or a revelation I I have to say",
    "start": "2631520",
    "end": "2636839"
  },
  {
    "text": "no reply with a regular time step I get from 95 and N4 machines after sp4 and",
    "start": "2636839",
    "end": "2645359"
  },
  {
    "text": "with S4 and above other operating systems if they are not configured",
    "start": "2645359",
    "end": "2650760"
  },
  {
    "text": "otherwise will out of the box will answer now look look at",
    "start": "2650760",
    "end": "2656599"
  },
  {
    "text": "this I will send a time stamp with a code feel different than zero and suddenly all those nice windows boxes",
    "start": "2656599",
    "end": "2664200"
  },
  {
    "text": "will not send me reply someone got an answer for",
    "start": "2664200",
    "end": "2670720"
  },
  {
    "text": "that Microsoft do not have as well so I'm asking why this happens it is an",
    "start": "2670800",
    "end": "2679040"
  },
  {
    "text": "inconsistency because if we are having icmp Echo replies and time stamp replies",
    "start": "2679040",
    "end": "2686520"
  },
  {
    "text": "you think that all the IP header and most of the icmp portion will be the same so if you build your own programs",
    "start": "2686520",
    "end": "2694520"
  },
  {
    "text": "then if you have have similarities then you will be happy because you have much",
    "start": "2694520",
    "end": "2700040"
  },
  {
    "text": "less code to deal with well apparently",
    "start": "2700040",
    "end": "2704920"
  },
  {
    "text": "not this is a Uber uh Mass uh scheme that works with",
    "start": "2707520",
    "end": "2716119"
  },
  {
    "text": "uh what I call dfb echoing with IP error messages all I have spoken about until",
    "start": "2716119",
    "end": "2722920"
  },
  {
    "text": "this point was uh query messages and there there unique replies well you can",
    "start": "2722920",
    "end": "2729160"
  },
  {
    "text": "see much differences between one operating system to another if you are",
    "start": "2729160",
    "end": "2734319"
  },
  {
    "text": "looking into icmp error messages you will see that some of the fields are not",
    "start": "2734319",
    "end": "2740280"
  },
  {
    "text": "being echoed correctly by uh the operating system which is the target of",
    "start": "2740280",
    "end": "2745680"
  },
  {
    "text": "your uh offending packets um if you know",
    "start": "2745680",
    "end": "2751160"
  },
  {
    "text": "nice simp message has to have the offending packet IP header and at least",
    "start": "2751160",
    "end": "2756680"
  },
  {
    "text": "eight bytes of the offending message well this varies as",
    "start": "2756680",
    "end": "2762480"
  },
  {
    "text": "well if we send a DF bit with an offending packet then um error messages",
    "start": "2762480",
    "end": "2771040"
  },
  {
    "text": "which will not Echo the dbit will have listing Linux ultrix Noel no those blah",
    "start": "2771040",
    "end": "2778880"
  },
  {
    "text": "blah Windows based machines now if we look at the echoing Integrity of those",
    "start": "2778880",
    "end": "2784400"
  },
  {
    "text": "machines we will see that all 3 will have the wrong IP ID and the",
    "start": "2784400",
    "end": "2790079"
  },
  {
    "text": "IP header check some is zero and the original check some is zero so it will",
    "start": "2790079",
    "end": "2795319"
  },
  {
    "text": "make a unique distinctions about ultrix Linux will think he is a router and this",
    "start": "2795319",
    "end": "2801319"
  },
  {
    "text": "is thing I'm not understanding I will set the proceeding bits value to uh c0",
    "start": "2801319",
    "end": "2808240"
  },
  {
    "text": "hex if you remember uh one of the first slides states that RFC 1812 which is the",
    "start": "2808240",
    "end": "2813720"
  },
  {
    "text": "rou of requirements tells that a router should set this value to six or seven",
    "start": "2813720",
    "end": "2819440"
  },
  {
    "text": "well I've asked if Linux is a router and still I haven't got any answer well he",
    "start": "2819440",
    "end": "2824760"
  },
  {
    "text": "is a router if you will enable his routing capabilities but other than that he is a simple",
    "start": "2824760",
    "end": "2830359"
  },
  {
    "text": "host if we look at other uh stuff we will see that um certain if we if we",
    "start": "2830359",
    "end": "2838040"
  },
  {
    "text": "send uh a message with more than eight btes of of fending uh",
    "start": "2838040",
    "end": "2843720"
  },
  {
    "text": "data then some oper in systems will uh quote more than 8 bytes of the offending",
    "start": "2843720",
    "end": "2851240"
  },
  {
    "text": "packets original data now HP will stop at 64 while other operating system will",
    "start": "2851240",
    "end": "2858800"
  },
  {
    "text": "quote more now where were left with novel Network and those nice Microsoft boxes",
    "start": "2858800",
    "end": "2867319"
  },
  {
    "text": "if we will send an offending packet that will lit anmp time exceeded our message",
    "start": "2867319",
    "end": "2873240"
  },
  {
    "text": "novel will reply with echoed IP time to refill value zero now this is an",
    "start": "2873240",
    "end": "2879720"
  },
  {
    "text": "implementation error because this is not uh the arrow message we wish to elicit",
    "start": "2879720",
    "end": "2886680"
  },
  {
    "text": "we were talking about um uh fragment uh reassembly uh this",
    "start": "2886680",
    "end": "2893319"
  },
  {
    "text": "thing is talking about fragmental reassembly well I send one half or just",
    "start": "2893319",
    "end": "2898920"
  },
  {
    "text": "one piece of a tegram I want to send and I will look for the reply now when Noel",
    "start": "2898920",
    "end": "2905720"
  },
  {
    "text": "replies for this one with the icmp fragment reassembly error message it's",
    "start": "2905720",
    "end": "2910880"
  },
  {
    "text": "mixed up between the time exceeded with the time to leave field value and send",
    "start": "2910880",
    "end": "2917599"
  },
  {
    "text": "you instead the type correctly about the fragment reassembly time exceeded but",
    "start": "2917599",
    "end": "2923119"
  },
  {
    "text": "the time to Lei value suddenly become zero now if you want to fingerprint Noel",
    "start": "2923119",
    "end": "2930000"
  },
  {
    "text": "you use this dirty trick and you fingerprint H Noel Network operating",
    "start": "2930000",
    "end": "2935079"
  },
  {
    "text": "system box that run on the internet so I'm going to Noel Network's website and",
    "start": "2935079",
    "end": "2940720"
  },
  {
    "text": "saying okay there is support at novel.com sure right sounds uh good no",
    "start": "2940720",
    "end": "2946440"
  },
  {
    "text": "no address okay security at novel.com no one there uh information at novel.com no",
    "start": "2946440",
    "end": "2954559"
  },
  {
    "text": "one uh okay so I'm looking into some uh",
    "start": "2954559",
    "end": "2959880"
  },
  {
    "text": "people that are Noel Centric that will help me send the uh bug to Noel so they can fix it so nobody nobody really",
    "start": "2959880",
    "end": "2967640"
  },
  {
    "text": "understands who's the men in Nel that do security So eventually I sent it to",
    "start": "2967640",
    "end": "2974799"
  },
  {
    "text": "someone and I think it's uh 3 months that I'm waiting for a Noel to say okay",
    "start": "2974799",
    "end": "2979839"
  },
  {
    "text": "we have a problem but I guess it's not a priority there anymore um the other group of operating",
    "start": "2979839",
    "end": "2987960"
  },
  {
    "text": "systems will be all the Microsoft Windows based uh this is a bit complex",
    "start": "2987960",
    "end": "2993440"
  },
  {
    "text": "two-step uh process but eventually it will give us again all the Microsoft based opting systems and if we will look",
    "start": "2993440",
    "end": "3000599"
  },
  {
    "text": "again at the uh uh iptl we can just take out wi 2K again here and differentiate",
    "start": "3000599",
    "end": "3007640"
  },
  {
    "text": "it between um nt4 9898 and me and wi",
    "start": "3007640",
    "end": "3014558"
  },
  {
    "text": "2K before I go into uh passive operting fingerprinting which is the new",
    "start": "3016599",
    "end": "3022880"
  },
  {
    "text": "information that I just saved for blackhead um I just mentioned that we",
    "start": "3022880",
    "end": "3029200"
  },
  {
    "text": "can use uh a combo uh Ultra hexer Ultra mapping uh datagram we can use a lot of",
    "start": "3029200",
    "end": "3036960"
  },
  {
    "text": "stuff together and just send one datagram with it for example we can set",
    "start": "3036960",
    "end": "3042079"
  },
  {
    "text": "the dfb and uh change the uh code field and do other data tricks such as uh",
    "start": "3042079",
    "end": "3047880"
  },
  {
    "text": "change the value inside the type of service and according to the um reply we",
    "start": "3047880",
    "end": "3054000"
  },
  {
    "text": "will get we will have a c clear distinction between the operating system just combine everything send send it out",
    "start": "3054000",
    "end": "3060440"
  },
  {
    "text": "sure it is crafted but hey now we can use the for example the type of service",
    "start": "3060440",
    "end": "3066880"
  },
  {
    "text": "if we say that we use uh for example quality of service nobody will uh be",
    "start": "3066880",
    "end": "3073400"
  },
  {
    "text": "suspicious that we're just faking it or if we will set the dfb with our queries",
    "start": "3073400",
    "end": "3078960"
  },
  {
    "text": "nobody will figure out if we are really a sensal AR HP or an hbox right nobody",
    "start": "3078960",
    "end": "3086920"
  },
  {
    "text": "can say that if we just fake it well we have some stuff we can use",
    "start": "3086920",
    "end": "3093599"
  },
  {
    "text": "passively in order to map a targeted Network and networking host communicating with it uh this technique",
    "start": "3093599",
    "end": "3101079"
  },
  {
    "text": "is called passive fingerprinting um in the open source field it's quite",
    "start": "3101079",
    "end": "3107040"
  },
  {
    "text": "new there are some quite uh nice uh Papers written on this subject I think",
    "start": "3107040",
    "end": "3113520"
  },
  {
    "text": "I've listed some at the end of the um",
    "start": "3113520",
    "end": "3119760"
  },
  {
    "text": "presentation and again different operating system will use different implementation of the tcpip stack uh we",
    "start": "3119760",
    "end": "3126079"
  },
  {
    "text": "will identify those differences and then we can State uh what is the operating",
    "start": "3126079",
    "end": "3131599"
  },
  {
    "text": "system and hopefully uh we can have a clear",
    "start": "3131599",
    "end": "3137920"
  },
  {
    "text": "distinction we will um we will ask a few questions here",
    "start": "3138400",
    "end": "3144960"
  },
  {
    "text": "first which operating systems answer for what kind of Ip query message if we see those uh query and",
    "start": "3144960",
    "end": "3152680"
  },
  {
    "text": "reply messages flame bar the sniff Network we're resigning on we can do",
    "start": "3152680",
    "end": "3158480"
  },
  {
    "text": "that it will give us a nice uh understanding not more than that we",
    "start": "3158480",
    "end": "3164640"
  },
  {
    "text": "will we will not expect someone to use all the methods I've stated here and give us the uh treasure we can also see",
    "start": "3164640",
    "end": "3172520"
  },
  {
    "text": "which uh parting system answer for spatial or crafted icmp queries and how",
    "start": "3172520",
    "end": "3177880"
  },
  {
    "text": "they did that again only if people will use the method I methods I have",
    "start": "3177880",
    "end": "3183119"
  },
  {
    "text": "introduced here then again we will see that we can also look at IP R",
    "start": "3183119",
    "end": "3190839"
  },
  {
    "text": "messages uh it will be uh even better because IP error messages will be sent",
    "start": "3190839",
    "end": "3197480"
  },
  {
    "text": "for uh a lot of er conditions and we can do an analysis of er messages and qu",
    "start": "3197480",
    "end": "3205920"
  },
  {
    "text": "messages now query messages are",
    "start": "3205920",
    "end": "3210200"
  },
  {
    "text": "fun if you look at each operating systems or you go on to uh a look for",
    "start": "3211839",
    "end": "3217760"
  },
  {
    "text": "something that will send you an nice MP Echo request on each operating system",
    "start": "3217760",
    "end": "3222839"
  },
  {
    "text": "you will examine you will see that each operating system should",
    "start": "3222839",
    "end": "3228720"
  },
  {
    "text": "have uh and Implement an add user accessible application interface for",
    "start": "3228720",
    "end": "3233760"
  },
  {
    "text": "sending ICP e request Quire messages to other host well if",
    "start": "3233760",
    "end": "3240440"
  },
  {
    "text": "you uh will look the Ping utility will use this implementation on the various",
    "start": "3240440",
    "end": "3247280"
  },
  {
    "text": "operating systems [Music]",
    "start": "3247280",
    "end": "3252680"
  },
  {
    "text": "um an important note is that ping might use its own default values for several",
    "start": "3252680",
    "end": "3258079"
  },
  {
    "text": "Fields within the IP or equ datagram and not the operating systems this is",
    "start": "3258079",
    "end": "3263960"
  },
  {
    "text": "especially true for Unix and Unix like operating systems while we will see that",
    "start": "3263960",
    "end": "3269240"
  },
  {
    "text": "Microsoft based operating systems we have really fun with",
    "start": "3269240",
    "end": "3274520"
  },
  {
    "text": "those since not all the ICP quer requests are implemented on the various",
    "start": "3274920",
    "end": "3280400"
  },
  {
    "text": "operating system I have decided to look at the quer messages and to use the different ping",
    "start": "3280400",
    "end": "3286119"
  },
  {
    "text": "implementations uh in order to passively map between operating",
    "start": "3286119",
    "end": "3293040"
  },
  {
    "text": "systems which fields we have have that can we that we can use in order to do",
    "start": "3293319",
    "end": "3299160"
  },
  {
    "text": "so we have the type of service bite which includes three fields we have the",
    "start": "3299160",
    "end": "3305880"
  },
  {
    "text": "IP identification which until now nobody even looked at it I I think the dfb",
    "start": "3305880",
    "end": "3314559"
  },
  {
    "text": "Theus beit iptl and IP options which is the IP portion of all of this",
    "start": "3314559",
    "end": "3323160"
  },
  {
    "text": "now only if someone will will set the type of service bite then it will help us only if someone will set the DF bit",
    "start": "3323160",
    "end": "3331839"
  },
  {
    "text": "with its request then we can say okay there is a sensor areas and egg and um",
    "start": "3331839",
    "end": "3338440"
  },
  {
    "text": "hpox uh group if someone will use the unus bit",
    "start": "3338440",
    "end": "3343599"
  },
  {
    "text": "we'll know that this one is crafted iptl will be much of a help here and IP",
    "start": "3343599",
    "end": "3348880"
  },
  {
    "text": "options will be the same but if we look at the icmp portion we will be more than",
    "start": "3348880",
    "end": "3354599"
  },
  {
    "text": "happy to to discover that we have some excellent stuff to work with icmp ID",
    "start": "3354599",
    "end": "3360920"
  },
  {
    "text": "icmp sequence number now RC states that icmp ID should should help us to to",
    "start": "3360920",
    "end": "3369799"
  },
  {
    "text": "differentiate between a stream of Ip query messages sent to one host and to",
    "start": "3369799",
    "end": "3375520"
  },
  {
    "text": "another this means that one host will get assign one number and the other will",
    "start": "3375520",
    "end": "3381440"
  },
  {
    "text": "get assign another the sequence number will have help us to differentiate between a stream of Ip",
    "start": "3381440",
    "end": "3389359"
  },
  {
    "text": "queries aimed at at the same host this means that the combination of icmp ID",
    "start": "3389359",
    "end": "3396640"
  },
  {
    "text": "and icmp sequence number will help us to differentiate between the icmp",
    "start": "3396640",
    "end": "3404000"
  },
  {
    "text": "datagrams questions okay we can look at the icmp data field",
    "start": "3404000",
    "end": "3411000"
  },
  {
    "text": "the RFC states that the amount of uh information with we can put inside this",
    "start": "3411000",
    "end": "3416119"
  },
  {
    "text": "field is uh implementation choice we can look at actually at three uh uh things",
    "start": "3416119",
    "end": "3424400"
  },
  {
    "text": "here offset from the IP header the actual content of this field",
    "start": "3424400",
    "end": "3430880"
  },
  {
    "text": "and the size of this field and if we will look at the size we",
    "start": "3430880",
    "end": "3436160"
  },
  {
    "text": "will look at the total size of the ismp request",
    "start": "3436160",
    "end": "3442480"
  },
  {
    "text": "now if we will look at the Linux IP Echo sorry if we look at the Ping",
    "start": "3442480",
    "end": "3449400"
  },
  {
    "text": "utilities IP Echo request that was compiled under Linux from the ipu teals",
    "start": "3449400",
    "end": "3455920"
  },
  {
    "text": "package under Red Hat Linux with kernel 2.2.14 we can see that we can learn some",
    "start": "3455920",
    "end": "3464400"
  },
  {
    "text": "information from just the information we get we get back from the operating system that we quered for example if you",
    "start": "3464400",
    "end": "3471599"
  },
  {
    "text": "remember the time to leave field here here should state that I'm pinging uh a",
    "start": "3471599",
    "end": "3479000"
  },
  {
    "text": "host on the same network I reside on and that host is a Unix or Unix like",
    "start": "3479000",
    "end": "3484880"
  },
  {
    "text": "operating system I can also see that I'm",
    "start": "3484880",
    "end": "3490119"
  },
  {
    "text": "sending um 56 bytes of data that makes the total size of the datagram of",
    "start": "3490119",
    "end": "3498520"
  },
  {
    "text": "84 I can also see that somehow ping calculated the time it took for the",
    "start": "3498520",
    "end": "3505799"
  },
  {
    "text": "datagram to reach its destination and to come back I can see it here in the round grip",
    "start": "3505799",
    "end": "3512920"
  },
  {
    "text": "minimum average and maximum",
    "start": "3512920",
    "end": "3516838"
  },
  {
    "text": "times now if we will send two icmp Echo request one after the",
    "start": "3520799",
    "end": "3527319"
  },
  {
    "text": "other which if you think when you do use ping utility you just hit ping whatever",
    "start": "3527319",
    "end": "3533160"
  },
  {
    "text": "and don't bother to state the amount of uh e Echo request you wish to send the",
    "start": "3533160",
    "end": "3538799"
  },
  {
    "text": "amount of datagrams we will see several differences we can see that the IP time",
    "start": "3538799",
    "end": "3545720"
  },
  {
    "text": "to leave that was used is 64 type of service 0 ID",
    "start": "3545720",
    "end": "3552119"
  },
  {
    "text": "383 icmp ID is this number and the sequence is",
    "start": "3552119",
    "end": "3557520"
  },
  {
    "text": "zero I can tell you that the first eight bytes here were used as a time stamp in order",
    "start": "3557520",
    "end": "3566640"
  },
  {
    "text": "to calculate the round trip time this means when I send you the IP EO request",
    "start": "3566640",
    "end": "3572920"
  },
  {
    "text": "my operating system or the P utility stamps this uh time stamp and when I received back the reply it was echoed",
    "start": "3572920",
    "end": "3579839"
  },
  {
    "text": "back to me since the RC requires that nothing will be changed in the data",
    "start": "3579839",
    "end": "3585240"
  },
  {
    "text": "portion and I can calculate the amount of time it took for this datagram to travel to the other side and come",
    "start": "3585240",
    "end": "3592799"
  },
  {
    "text": "back another inter interesting thing to see is what is the actual data inside my",
    "start": "3592799",
    "end": "3600680"
  },
  {
    "text": "um datagram here we can see all those symbols and numbers which actually starts right",
    "start": "3600680",
    "end": "3607799"
  },
  {
    "text": "after the time stamp which is here just 09 0809 0 a 0 B",
    "start": "3607799",
    "end": "3616400"
  },
  {
    "text": "and so on which compiles this if we are looking at the second",
    "start": "3616400",
    "end": "3623319"
  },
  {
    "text": "packet what we can see that is changing this is a nitty trick if you see put it in the same",
    "start": "3623319",
    "end": "3629400"
  },
  {
    "text": "place we can see that the IP ID was changed now if you look closely you'll",
    "start": "3629400",
    "end": "3635280"
  },
  {
    "text": "see that there is a a three number gap between one and the second IP ID I can",
    "start": "3635280",
    "end": "3642839"
  },
  {
    "text": "tell you that with Linux the IP ID Gap is one what was else changed was the",
    "start": "3642839",
    "end": "3649160"
  },
  {
    "text": "sequence number the sequence number Gap is 100 HX which is is 256",
    "start": "3649160",
    "end": "3656520"
  },
  {
    "text": "decimal we can also see that the same icmp ID was used for both uh pinks for",
    "start": "3656520",
    "end": "3665760"
  },
  {
    "text": "both IP EO requests if we examine Microsoft Windows",
    "start": "3665760",
    "end": "3672680"
  },
  {
    "text": "2K Servo which IP Echo request we can see other Nifty other Nifty",
    "start": "3672680",
    "end": "3679200"
  },
  {
    "text": "stuff we do ping you use the ping.exe uh utility on Windows which is something",
    "start": "3679200",
    "end": "3687119"
  },
  {
    "text": "Microsoft has built and Microsoft is responsible",
    "start": "3687119",
    "end": "3693680"
  },
  {
    "text": "for they come to hijack me from Microsoft um we see that again we can",
    "start": "3693880",
    "end": "3700319"
  },
  {
    "text": "see the time it took the uh datagram to travel to the Target and to come",
    "start": "3700319",
    "end": "3706520"
  },
  {
    "text": "back um we see the approximate round three times which are really nice 0",
    "start": "3706520",
    "end": "3714599"
  },
  {
    "text": "millisecond is really fast really on my local network it's really good um I",
    "start": "3714599",
    "end": "3722839"
  },
  {
    "text": "think it's a world record we should send this to Guinness um now if we look closely you",
    "start": "3722839",
    "end": "3731480"
  },
  {
    "text": "see that in the reply the replying operating system which is my Linux home boox answered with 255 again the iptl",
    "start": "3731480",
    "end": "3739880"
  },
  {
    "text": "fill value of the Unix and Unix like if we want to look at trace and",
    "start": "3739880",
    "end": "3745000"
  },
  {
    "text": "here I'm using a older version of snort which I recommend to upgrade immediately",
    "start": "3745000",
    "end": "3750799"
  },
  {
    "text": "to 1.7 uh we can see some other stuff first",
    "start": "3750799",
    "end": "3757559"
  },
  {
    "text": "I will look at the data portion now the data portion start with 6 to1 which is hex equivalent to a now you think Unix",
    "start": "3757559",
    "end": "3765359"
  },
  {
    "text": "was using the first eight btes in order to put the time stamp right so where the",
    "start": "3765359",
    "end": "3772279"
  },
  {
    "text": "time stamp go to question someone can answer this has a really good",
    "start": "3772279",
    "end": "3779640"
  },
  {
    "text": "answer into the memory should have been written somewhere in order to provide me with",
    "start": "3779640",
    "end": "3785599"
  },
  {
    "text": "the information right something has to be written in order to allow the operating system to tell me that it took",
    "start": "3785599",
    "end": "3792880"
  },
  {
    "text": "the amazing time of 0o milliseconds for this datagram to come",
    "start": "3792880",
    "end": "3800039"
  },
  {
    "text": "back other stuff that we can see here is",
    "start": "3800039",
    "end": "3805799"
  },
  {
    "text": "uh iptl 128 I stated this before IP ID",
    "start": "3805799",
    "end": "3811880"
  },
  {
    "text": "279 IP ID 512 looks a bit suspicious sequence number this number",
    "start": "3811880",
    "end": "3819440"
  },
  {
    "text": "and it is an echo request if we look again you do this",
    "start": "3819440",
    "end": "3826520"
  },
  {
    "text": "trick yeah like this trick we'll see that the IP ID here the Gap is",
    "start": "3826520",
    "end": "3833279"
  },
  {
    "text": "one the Gap is one and the sequence number again change and the Gap here is",
    "start": "3833279",
    "end": "3839839"
  },
  {
    "text": "256 okay what did not change is the IP",
    "start": "3839839",
    "end": "3846160"
  },
  {
    "text": "ID you think okay IP ID should be the same right no",
    "start": "3846160",
    "end": "3853440"
  },
  {
    "text": "problem if we looking again at Microsoft win2k server with sp1 install and it is",
    "start": "3853839",
    "end": "3862200"
  },
  {
    "text": "important what is the uh version of the server as I will tell you in couple of",
    "start": "3862200",
    "end": "3869480"
  },
  {
    "text": "minutes we use wind damp I used the uh I think it was",
    "start": "3869480",
    "end": "3875400"
  },
  {
    "text": "203 uh written by JD Glazer of uh in the time he was in NTI objectives and not in",
    "start": "3875400",
    "end": "3882279"
  },
  {
    "text": "fanstone and dumped what I've got what I've got back is again here I've got an",
    "start": "3882279",
    "end": "3889119"
  },
  {
    "text": "IP ID which is 768 decimal if if you remember",
    "start": "3889119",
    "end": "3895359"
  },
  {
    "text": "here I I got from a win 2K with ldsp IP ID of one of 512 now here I get",
    "start": "3895359",
    "end": "3904680"
  },
  {
    "text": "768 well I was a bit uh suspicious about this so here I",
    "start": "3904680",
    "end": "3910960"
  },
  {
    "text": "am pinging one operating system one box with a certain IP and here I pinging",
    "start": "3910960",
    "end": "3917640"
  },
  {
    "text": "another so you were thinking that the IP ID must change right because the IP ID",
    "start": "3917640",
    "end": "3923200"
  },
  {
    "text": "help us differentiate between different machines well no Microsoft will use icmp",
    "start": "3923200",
    "end": "3929520"
  },
  {
    "text": "ID as a constant number regardless of what you will do now it will rely upon",
    "start": "3929520",
    "end": "3937160"
  },
  {
    "text": "the ismp sequence number to differentiate between each IP Echo",
    "start": "3937160",
    "end": "3942480"
  },
  {
    "text": "request whenever it was sent to okay I was a bit suspicious so I went",
    "start": "3942480",
    "end": "3951079"
  },
  {
    "text": "and look at the icmp echo request with win NT with sp6 a installed",
    "start": "3951079",
    "end": "3957920"
  },
  {
    "text": "on what I saw here is the TTL",
    "start": "3957920",
    "end": "3963799"
  },
  {
    "text": "32mp ID 256 sequence number 256 and it's Nifty",
    "start": "3963799",
    "end": "3969760"
  },
  {
    "text": "drifty IP ID now if you look closely at the IP ID you will see that there is a",
    "start": "3969760",
    "end": "3975880"
  },
  {
    "text": "gap of 256 between one IP ID and another Well if you remember the win 2K machine",
    "start": "3975880",
    "end": "3982240"
  },
  {
    "text": "it was the gap of one now you'll say yeah you might not be getting uh the",
    "start": "3982240",
    "end": "3988200"
  },
  {
    "text": "accurate or the one gap between one uh packet to another well right but if I",
    "start": "3988200",
    "end": "3993520"
  },
  {
    "text": "will have two packets coming from the same machine if it's not uh above 256 I",
    "start": "3993520",
    "end": "4000799"
  },
  {
    "text": "can say 100% it came from a win 2K box",
    "start": "4000799",
    "end": "4006359"
  },
  {
    "text": "now looking here the sequin have started with 256 and the icmp ID was 256 as well",
    "start": "4006359",
    "end": "4014839"
  },
  {
    "text": "well so we have basically the gap of the IP ID we have the TTL we can use we have",
    "start": "4014839",
    "end": "4022839"
  },
  {
    "text": "the icmp ID here and we have the sequence number we also have regardless",
    "start": "4022839",
    "end": "4028640"
  },
  {
    "text": "to other operating system the data field now we can forge the data field quite",
    "start": "4028640",
    "end": "4035960"
  },
  {
    "text": "easily if we just uh play with one of the U uh ping uh options and state which",
    "start": "4035960",
    "end": "4041960"
  },
  {
    "text": "kind of data we want to add if we look",
    "start": "4041960",
    "end": "4048200"
  },
  {
    "text": "closely at those nice operating systems and then we will look at the IP",
    "start": "4048200",
    "end": "4055480"
  },
  {
    "text": "ID and it took me a while to understand that there is actual uh distinction",
    "start": "4055480",
    "end": "4061240"
  },
  {
    "text": "here Unix and Unix like operating system ipid will Gap will be one Windows except",
    "start": "4061240",
    "end": "4069279"
  },
  {
    "text": "for the windows me and wind 2K family which",
    "start": "4069279",
    "end": "4075039"
  },
  {
    "text": "uh 2K and 2K sp1 we'll use one as the",
    "start": "4075039",
    "end": "4080319"
  },
  {
    "text": "Gap now if we will look at a bigger table describing the all the um",
    "start": "4080319",
    "end": "4088240"
  },
  {
    "text": "different uh values assigned to those uh uh fields we can look that and see",
    "start": "4088240",
    "end": "4095760"
  },
  {
    "text": "sequence numbers with with micros of Windows based operating systems we always start with 256 which is 100 hex",
    "start": "4095760",
    "end": "4104000"
  },
  {
    "text": "now with Unix and Unix like will start with zero the gap between one sequence",
    "start": "4104000",
    "end": "4110359"
  },
  {
    "text": "number to another will be 256 with Microsoft Windows boxes and with Linux",
    "start": "4110359",
    "end": "4117040"
  },
  {
    "text": "and FreeBSD boxes while eggs and sarus and other Unix variants will use the gap",
    "start": "4117040",
    "end": "4122159"
  },
  {
    "text": "of one hex another nice thing to know about is",
    "start": "4122159",
    "end": "4127318"
  },
  {
    "text": "the icmp ID field value which start with a certain number if you look at the Ping",
    "start": "4127319",
    "end": "4133199"
  },
  {
    "text": "uh utility with Unix you will see that the icmp idea is actually the process",
    "start": "4133199",
    "end": "4141159"
  },
  {
    "text": "assigned to ping when you round the command with Microsoft based operating",
    "start": "4141159",
    "end": "4148000"
  },
  {
    "text": "systems those values are constant constant values and we can just",
    "start": "4148000",
    "end": "4155159"
  },
  {
    "text": "differentiate between the variant operating systems for example until sp1 was released Microsoft",
    "start": "4155159",
    "end": "4163838"
  },
  {
    "text": "of me was the only operating systems among the Microsoft based who was using",
    "start": "4163839",
    "end": "4169000"
  },
  {
    "text": "the value of 768 now with sp1 Microsoft changed the",
    "start": "4169000",
    "end": "4174080"
  },
  {
    "text": "behavior they were using 512 as the icmp ID field value for the win 2K family",
    "start": "4174080",
    "end": "4181080"
  },
  {
    "text": "they went and changed it to 768 so I was like asking uh Microsoft guys why you",
    "start": "4181080",
    "end": "4188318"
  },
  {
    "text": "guys have changed that and the answer was no answer now if you look closely we can",
    "start": "4188319",
    "end": "4196280"
  },
  {
    "text": "differentiate between 98 998 boxes and an",
    "start": "4196280",
    "end": "4203560"
  },
  {
    "text": "boxes and even we can differentiate between 2K and um 98 and 98c because of",
    "start": "4203560",
    "end": "4211679"
  },
  {
    "text": "the ipid Gap um we can also see that the icmp",
    "start": "4211679",
    "end": "4220560"
  },
  {
    "text": "ID will be changed when we are talking about about uh Unix and Unix like",
    "start": "4220560",
    "end": "4226280"
  },
  {
    "text": "operating systems and with Microsoft Windows this value will be",
    "start": "4226280",
    "end": "4231320"
  },
  {
    "text": "constant this is an implementation problem this is an RFC",
    "start": "4231320",
    "end": "4236360"
  },
  {
    "text": "misunderstanding um and I had one of the MS guys telling",
    "start": "4236360",
    "end": "4242159"
  },
  {
    "text": "me this this is wrong took me an hour to convince him and we were",
    "start": "4242159",
    "end": "4250198"
  },
  {
    "text": "shouting now this thing was discovered three days",
    "start": "4252040",
    "end": "4257920"
  },
  {
    "text": "ago uh when I installed my lab for the training session this was actually something I did not understood when",
    "start": "4257920",
    "end": "4265760"
  },
  {
    "text": "first uh Jeff Moss and uh Keith there uh installed a a multi-home wi 2K machine",
    "start": "4265760",
    "end": "4273760"
  },
  {
    "text": "for me now I asked them to ping me from that win 2K machine so I can see if all",
    "start": "4273760",
    "end": "4280320"
  },
  {
    "text": "the information I have found correlates and oops I saw that the icmp ID was not 512 it",
    "start": "4280320",
    "end": "4288159"
  },
  {
    "text": "was 256 there is a two Network outs inside that machine so I asked I asked",
    "start": "4288159",
    "end": "4294880"
  },
  {
    "text": "them to remove one of those cards and to pick me again well guess what 768",
    "start": "4294880",
    "end": "4301159"
  },
  {
    "text": "because it was sp1 so we are act like kids putting back the ethernet card pinging again",
    "start": "4301159",
    "end": "4308600"
  },
  {
    "text": "256 take out the card again 768 so as you can see we have a nice uh",
    "start": "4308600",
    "end": "4317000"
  },
  {
    "text": "method in order to differentiate between a multihomed Microsoft box to not a",
    "start": "4317000",
    "end": "4324280"
  },
  {
    "text": "multihomed box you can see that this actually gives you other kind of",
    "start": "4324280",
    "end": "4330719"
  },
  {
    "text": "information if you see ismp ID 256 IP ID Gap",
    "start": "4330719",
    "end": "4337080"
  },
  {
    "text": "one here you go one 2K multi-home machine now it might be the same with",
    "start": "4337080",
    "end": "4344480"
  },
  {
    "text": "other uh variants of Microsoft with multihomed uh network",
    "start": "4344480",
    "end": "4350920"
  },
  {
    "text": "cards um I did not have the time to check it since I don't have my lab here and it",
    "start": "4350920",
    "end": "4357639"
  },
  {
    "text": "was two days ago but think about the possibility of identifying multi-home",
    "start": "4357639",
    "end": "4364440"
  },
  {
    "text": "machines uh by just you know looking at that variant of uh operation just",
    "start": "4364440",
    "end": "4371199"
  },
  {
    "text": "looking at this change and here we go we have a Gateway what is that what Microsoft has oh proxy server",
    "start": "4371199",
    "end": "4379760"
  },
  {
    "text": "Isa server or whatever I can do server so you can identify multi hold home",
    "start": "4379760",
    "end": "4389199"
  },
  {
    "text": "gateways this is another thing I talked about with uh David",
    "start": "4389199",
    "end": "4394440"
  },
  {
    "text": "lablanc um sure uh Microsoft can uh fix some um",
    "start": "4394440",
    "end": "4402520"
  },
  {
    "text": "simple stuff that I have found which are not corresponding to the RC which do not",
    "start": "4402520",
    "end": "4410440"
  },
  {
    "text": "correspond to nothing um but simply uh they have their pride and they will not",
    "start": "4410440",
    "end": "4418120"
  },
  {
    "text": "come and say yeah we were wrong I mean if you look at the icmp ID thing it's",
    "start": "4418120",
    "end": "4423600"
  },
  {
    "text": "like where you guys took that from why do you are doing this and they even",
    "start": "4423600",
    "end": "4430159"
  },
  {
    "text": "don't have the answer for that um eventually each machine each operating",
    "start": "4430159",
    "end": "4437600"
  },
  {
    "text": "system will have its own IP stack uh differences from one to another",
    "start": "4437600",
    "end": "4445159"
  },
  {
    "text": "operating system this is correct but if I can do that with less traffic and if I",
    "start": "4445159",
    "end": "4451280"
  },
  {
    "text": "can do that more efficiently then why use n map if I can",
    "start": "4451280",
    "end": "4457000"
  },
  {
    "text": "ping so you have here a further reading if",
    "start": "4457000",
    "end": "4463120"
  },
  {
    "text": "you you really wish to read all the rfc's you are more than welcome uh if you are developing",
    "start": "4463120",
    "end": "4469920"
  },
  {
    "text": "something then the RFC is your friend uh you can get all the rfc's from the ITF",
    "start": "4469920",
    "end": "4477120"
  },
  {
    "text": "or um version three of my icmp usage and scanning paper will be posted in two",
    "start": "4477120",
    "end": "4482520"
  },
  {
    "text": "weeks to my website uh the guys who were in my training has a final well not that",
    "start": "4482520",
    "end": "4489320"
  },
  {
    "text": "final draft of it uh this are some links to the tools I",
    "start": "4489320",
    "end": "4495320"
  },
  {
    "text": "have used in this presentation I highly recommend them if you want to test your",
    "start": "4495320",
    "end": "4500480"
  },
  {
    "text": "uh systems applications specially thinging and hping 2 will do nearly",
    "start": "4500480",
    "end": "4506600"
  },
  {
    "text": "everything for you you can use snort as your sniffer and intrusion text and system even if it's not that perfect but",
    "start": "4506600",
    "end": "4514440"
  },
  {
    "text": "it will give you a lot of stuff you need and it was uh improved from version 1.6",
    "start": "4514440",
    "end": "4520040"
  },
  {
    "text": "to version 1.7 I'm uh a bit proud to say that some of the stuff I asked for for",
    "start": "4520040",
    "end": "4527520"
  },
  {
    "text": "from Marty Ro were inserted if you have question",
    "start": "4527520",
    "end": "4533760"
  },
  {
    "text": "questions this is the time going on why how about you love",
    "start": "4533760",
    "end": "4542480"
  },
  {
    "text": "Macintosh enjoy your time my",
    "start": "4542480",
    "end": "4546360"
  },
  {
    "text": "friend well if you'll take uh Je uh girl",
    "start": "4550000",
    "end": "4555120"
  },
  {
    "text": "um Macintosh machine will be more than delightful to do that thank you for",
    "start": "4555120",
    "end": "4560960"
  },
  {
    "text": "question Keith yeah actually regarding regarding the",
    "start": "4560960",
    "end": "4568600"
  },
  {
    "text": "extra did you try a third card well I was thinking of putting cards until the",
    "start": "4568600",
    "end": "4575679"
  },
  {
    "text": "machine will blow up um it was kind of interesting to put a",
    "start": "4575679",
    "end": "4580719"
  },
  {
    "text": "quad uh card inside um um I'm trying to have all the gear",
    "start": "4580719",
    "end": "4587040"
  },
  {
    "text": "for doing that since I'm uh just having two computers at home it's a bit of problem uh something I didn't stated",
    "start": "4587040",
    "end": "4594360"
  },
  {
    "text": "that this whole uh research is is being done on my spur time",
    "start": "4594360",
    "end": "4602679"
  },
  {
    "text": "so yes do you expect any difference between B traffic and",
    "start": "4603440",
    "end": "4610560"
  },
  {
    "text": "dial uh not that I have seen sorry the question was if if I will",
    "start": "4610560",
    "end": "4618040"
  },
  {
    "text": "expect to see differences between icmp between dialog connection and an",
    "start": "4618040",
    "end": "4623760"
  },
  {
    "text": "Ethernet card um if you think about it it's just the physical layer uh it",
    "start": "4623760",
    "end": "4631880"
  },
  {
    "text": "shouldn't be um a problem with it but again if you look at the Microsoft case",
    "start": "4631880",
    "end": "4638760"
  },
  {
    "text": "then I don't know what those guys were thinking about one of the options is uh",
    "start": "4638760",
    "end": "4644440"
  },
  {
    "text": "routing but again if you have the IP if you have the IP then I mean I don't",
    "start": "4644440",
    "end": "4650080"
  },
  {
    "text": "think of any anything that is uh worth doing so any other",
    "start": "4650080",
    "end": "4656679"
  },
  {
    "text": "questions thank you I enjoyed being here thank you for your [Applause]",
    "start": "4656679",
    "end": "4665120"
  },
  {
    "text": "time",
    "start": "4665120",
    "end": "4668120"
  }
]