[
  {
    "text": "hello everyone um we are here uh to talk about uh hiding in the familiar",
    "start": "120",
    "end": "5839"
  },
  {
    "text": "steganography and vulnerabilities in popular archive formats my name is Mario",
    "start": "5839",
    "end": "11200"
  },
  {
    "text": "vukan and I'm here with Tomy slin we are founders of reversing Labs uh company",
    "start": "11200",
    "end": "17960"
  },
  {
    "text": "that uh is working on uh uh file analysis and unpacking Frameworks and we",
    "start": "17960",
    "end": "25359"
  },
  {
    "text": "have um let me raise this up uh we have presented last black hat uh open source",
    "start": "25359",
    "end": "32238"
  },
  {
    "text": "engine called open source project called Titan engine that has become a really popular uh tool for uh file",
    "start": "32239",
    "end": "40640"
  },
  {
    "text": "analysis so uh we have been since working on uh some interesting",
    "start": "40640",
    "end": "47360"
  },
  {
    "text": "technology and have in the process discovered some vulnerabilities in uh popular archive formats like uh ZIP RAR",
    "start": "47360",
    "end": "55039"
  },
  {
    "text": "uh gzip cab and 7zip and are here joined with with Brian Carney who is uh CEO of",
    "start": "55039",
    "end": "63879"
  },
  {
    "text": "uh world's leading digital fances company uh access data that has helped",
    "start": "63879",
    "end": "69159"
  },
  {
    "text": "us a lot you know with uh uh putting together uh This research so uh just to move forward on",
    "start": "69159",
    "end": "77040"
  },
  {
    "text": "this uh our goals today is to just give you really brief introduction to steganography as it relates to archives",
    "start": "77040",
    "end": "84920"
  },
  {
    "text": "then to uh uh give you uh some ideas on how we could",
    "start": "84920",
    "end": "91399"
  },
  {
    "text": "uh uh obtain Mal formations inside of uh different file formats and uh talk about",
    "start": "91399",
    "end": "99640"
  },
  {
    "text": "their steganographic implications as well as uh vulnerabilities that are a natural byproduct after that we will",
    "start": "99640",
    "end": "107320"
  },
  {
    "text": "move on to demonstrating uh uh some uh quick and dirty uh hex editing and uh um",
    "start": "107320",
    "end": "117000"
  },
  {
    "text": "how to create your own uh file formats by modifying the VAR stand standard",
    "start": "117000",
    "end": "122079"
  },
  {
    "text": "stuff and we will finish with the uh freeware tool that's going to be available today which we called NY",
    "start": "122079",
    "end": "127720"
  },
  {
    "text": "engine uh which has been specifically designed to detect Mal formations in",
    "start": "127720",
    "end": "133160"
  },
  {
    "text": "standard archive formats and then also to detect all the uh vulnerabilities",
    "start": "133160",
    "end": "138239"
  },
  {
    "text": "that we will be talking today so our principal topic is tonography so what that is many of you",
    "start": "138239",
    "end": "146200"
  },
  {
    "text": "know that just simply getting to the basic the verbiage definition it is the",
    "start": "146200",
    "end": "151599"
  },
  {
    "text": "Art and Science of writing hidden messag messages in such a way that no one apart",
    "start": "151599",
    "end": "156640"
  },
  {
    "text": "from the center and intended recipient suspects the existence of the message uh",
    "start": "156640",
    "end": "161720"
  },
  {
    "text": "it's really a form of uh security through",
    "start": "161720",
    "end": "166760"
  },
  {
    "text": "obscurity it's a concept that's been around for a long time you know we want to talk about you know all its ancient",
    "start": "166760",
    "end": "173080"
  },
  {
    "text": "and uh historic predecessors but really where it comes to digital stuff it comes to this take one image in this case you",
    "start": "173080",
    "end": "180519"
  },
  {
    "text": "know we will uh re uh remove uh uh some bits of the color map the result will be",
    "start": "180519",
    "end": "187000"
  },
  {
    "text": "a black image we will uh change the brightness uh by 85% and then we will",
    "start": "187000",
    "end": "192599"
  },
  {
    "text": "get a hidden message or the image you know that's being buried into it so um",
    "start": "192599",
    "end": "199319"
  },
  {
    "text": "when we talking about stenography it's really images it's been historically audio uh has been more recently video",
    "start": "199319",
    "end": "206120"
  },
  {
    "text": "but today we will really focused on uh archives or ways we can bury really big",
    "start": "206120",
    "end": "212680"
  },
  {
    "text": "payloads into uh standard things steganography or uh shorter uh uh",
    "start": "212680",
    "end": "220680"
  },
  {
    "text": "uh for I think we are is this the next slide or the one before it is the next",
    "start": "220680",
    "end": "226480"
  },
  {
    "text": "or just a I thought we had another slide before that",
    "start": "226480",
    "end": "232680"
  },
  {
    "text": "um oh we missing one slide all right doesn't matter um um anyhow so uh",
    "start": "232680",
    "end": "240519"
  },
  {
    "text": "when it comes to stenography there is a legitimate use and IL legitimate use for",
    "start": "240519",
    "end": "246560"
  },
  {
    "text": "steganography and uh uh stego is the word that you know forensis Community uses for the steganographic uh uh use",
    "start": "246560",
    "end": "254560"
  },
  {
    "text": "when looking for the so-called Contraband but uh uh stenography is also",
    "start": "254560",
    "end": "261359"
  },
  {
    "text": "a feature of you know watermarking the uh uh cap for you know signing movies or",
    "start": "261359",
    "end": "267080"
  },
  {
    "text": "more recently for uh uh uh embedding uh watermarked information inside of the",
    "start": "267080",
    "end": "272440"
  },
  {
    "text": "medical images and uh still uh uh people talk about signography principally for",
    "start": "272440",
    "end": "278919"
  },
  {
    "text": "messages uh hiding text within the text in images media files and uh reason for",
    "start": "278919",
    "end": "285320"
  },
  {
    "text": "pration of this is that you know there are over 600 different tools available today to uh allow you to embed uh",
    "start": "285320",
    "end": "293120"
  },
  {
    "text": "material with different sorts of algorithms many of these things have been open sourced and as such uh",
    "start": "293120",
    "end": "300440"
  },
  {
    "text": "uh there has been PR proliferation of commission private tools U really",
    "start": "300440",
    "end": "306639"
  },
  {
    "text": "focused on total obscurity uh in embedding information uh principally to",
    "start": "306639",
    "end": "312800"
  },
  {
    "text": "uh avade detection that in today's world is done in really two different ways",
    "start": "312800",
    "end": "317880"
  },
  {
    "text": "either you try to inventory all the possible algorithms and are looking for artifacts uh inside of images or media",
    "start": "317880",
    "end": "325240"
  },
  {
    "text": "files or you're just looking for the presence of the tools that do",
    "start": "325240",
    "end": "330600"
  },
  {
    "text": "uh encryption decryption of the data meaning you're looking for hashes of uh these",
    "start": "330600",
    "end": "336360"
  },
  {
    "text": "tools so um as such uh uh I'd like to",
    "start": "336360",
    "end": "341680"
  },
  {
    "text": "invite Brian to to tell you about you know you know how does this look like in real life you know today",
    "start": "341680",
    "end": "348039"
  },
  {
    "text": "thanks so interestingly enough we do quite a bit of work not on identifying tools but opening up the payload of the",
    "start": "348039",
    "end": "354800"
  },
  {
    "text": "results of uh of um sto's files but I as",
    "start": "354800",
    "end": "359919"
  },
  {
    "text": "part of this uh this project working with the reversing Labs team that we went out I set out to try to find some",
    "start": "359919",
    "end": "365520"
  },
  {
    "text": "good stories about steganography and interestingly enough I really couldn't find any good good stories about it",
    "start": "365520",
    "end": "370840"
  },
  {
    "text": "because we had magically gotten files at times at which we needed to look at but um it could be due to the fact that it's",
    "start": "370840",
    "end": "377080"
  },
  {
    "text": "really not that prevalent in the wild I don't totally believe that that it's true but it is obviously a possibility",
    "start": "377080",
    "end": "383720"
  },
  {
    "text": "um it could be that analysts are not really looking so they never find it right it's like there's so many other things you look at a you look at a hard",
    "start": "383720",
    "end": "390400"
  },
  {
    "text": "drive it's got a half a million a million items on there you see a bit map or a wave file you know what are the",
    "start": "390400",
    "end": "397280"
  },
  {
    "text": "chances um it could be that most media uh based approaches have many weaknesses",
    "start": "397280",
    "end": "402479"
  },
  {
    "text": "so the big thing is is that when you start shoving a lot of data in some of the traditional stego carrier files they",
    "start": "402479",
    "end": "409800"
  },
  {
    "text": "start to get a little bit messy so like the images get fuzzier the audio gets more garbled uh and whatnot so you it's",
    "start": "409800",
    "end": "417199"
  },
  {
    "text": "not a good means if you're really trying to take a fair amount of data outside of little bits bits and pieces and stuff",
    "start": "417199",
    "end": "422520"
  },
  {
    "text": "like that um and that right now the best method to identify stego is Define the",
    "start": "422520",
    "end": "427919"
  },
  {
    "text": "tools based off of hashes end of story it's pretty much sort of what they do there's a few different hash databases",
    "start": "427919",
    "end": "433479"
  },
  {
    "text": "out there and a few different tools and stuff like that but uh right now sort of the best method to identify stego on a",
    "start": "433479",
    "end": "440080"
  },
  {
    "text": "machine is to see if there's presence of a stego tool if there's presence of a stego tool there's a possibility that",
    "start": "440080",
    "end": "445599"
  },
  {
    "text": "there's some stego payload or there was some uh potential information that was stego so um or it could be that",
    "start": "445599",
    "end": "452759"
  },
  {
    "text": "steganography is just so effective that nobody really knows um so new paradigms for forensic",
    "start": "452759",
    "end": "460400"
  },
  {
    "text": "really from an investigative perspective obviously we talked about the traditional steganography is thought of",
    "start": "460400",
    "end": "465759"
  },
  {
    "text": "just embedding data in media files audio jpeg bitmap gifs and stuff like that again things get a little bit uh Messy",
    "start": "465759",
    "end": "472879"
  },
  {
    "text": "as you start to increase the payload so um if you're really going to go through the effort of taking stuff you you kind of want to probably take a bunch of",
    "start": "472879",
    "end": "479120"
  },
  {
    "text": "stuff with with you so this really the the the session is really about a new paradigm in stenography which gets used",
    "start": "479120",
    "end": "485960"
  },
  {
    "text": "a lot um but really there will be a shift away from the media files probably",
    "start": "485960",
    "end": "491159"
  },
  {
    "text": "to more of the archive files zip cab szip um like the rest of the team is",
    "start": "491159",
    "end": "496440"
  },
  {
    "text": "talking about so Within These archive files why why it's a big why it's",
    "start": "496440",
    "end": "501639"
  },
  {
    "text": "relevant is because you can start putting more data in there these dat once you put data into these archives",
    "start": "501639",
    "end": "507639"
  },
  {
    "text": "you can still get stuff out so you're like oh it's fine the archive is good uh so it sort of you don't really know",
    "start": "507639",
    "end": "513479"
  },
  {
    "text": "unless you really start to look into these different archive files um and there's also other approaches there's",
    "start": "513479",
    "end": "518839"
  },
  {
    "text": "discussion about a sto file system uh recently uh which is basically a file system and uh which sort of looks like a",
    "start": "518839",
    "end": "525839"
  },
  {
    "text": "true Crypt where you basically open it up with a regular password and then because in the UK they recently passed a",
    "start": "525839",
    "end": "532399"
  },
  {
    "text": "law talking about you have to you have to give up your password so if that's the case they you would go they would",
    "start": "532399",
    "end": "538920"
  },
  {
    "text": "say give me your password You' give them your password it would open up there' be benign files but inside that archive or",
    "start": "538920",
    "end": "544640"
  },
  {
    "text": "that file system is a whole other set of things so f um that was called a sto",
    "start": "544640",
    "end": "549839"
  },
  {
    "text": "file system and then I also just uh read about a another approach where you can take a CD file system the cdfs like file",
    "start": "549839",
    "end": "557160"
  },
  {
    "text": "system with the CD and you can just Jam data into the CD but when you go to read",
    "start": "557160",
    "end": "562800"
  },
  {
    "text": "it looks like a regular play and stuff like that but you need to know to look outside of the sort of uh normal bounds",
    "start": "562800",
    "end": "570160"
  },
  {
    "text": "so uh investigating stego and archives so why this is really relevant from an investigative perspective is one it's",
    "start": "570160",
    "end": "576880"
  },
  {
    "text": "easier to hide larger payloads in plain sight I think the most relevant thing is it's not easy to identify using existing",
    "start": "576880",
    "end": "584079"
  },
  {
    "text": "methods so all the existing methods are like blind anomaly based approach uh looking for things that aren't the",
    "start": "584079",
    "end": "589920"
  },
  {
    "text": "signatures uh image analysis using image filters audio analyzers uh and whatnot",
    "start": "589920",
    "end": "595399"
  },
  {
    "text": "so those are all very much media based approach and then even more so since the",
    "start": "595399",
    "end": "600640"
  },
  {
    "text": "most tra the traditional method is finding these tools by hash everybody's got these different archive file uh",
    "start": "600640",
    "end": "607440"
  },
  {
    "text": "different AR archive tool um Zips and unzips tools on their machines using uh",
    "start": "607440",
    "end": "612720"
  },
  {
    "text": "hashes is is just is silly because it's really pointless because what what what are you going to look for uh per se so",
    "start": "612720",
    "end": "620240"
  },
  {
    "text": "and it also makes you uh always question what side what's inside the archive all",
    "start": "620240",
    "end": "625399"
  },
  {
    "text": "right hey guys my name is Thomas Lain I'm the",
    "start": "625399",
    "end": "632160"
  },
  {
    "text": "chief software architect with the reversing labs and before we continue I'm just going to switch the slides because I'm sure that everything we we",
    "start": "632160",
    "end": "640160"
  },
  {
    "text": "are meant to present till the end of the presentation is in",
    "start": "640160",
    "end": "645360"
  },
  {
    "text": "here yeah move the microphone closer or as people can can hear",
    "start": "645360",
    "end": "650440"
  },
  {
    "text": "you so this is what we already talked about and we're going to continue with",
    "start": "650440",
    "end": "656079"
  },
  {
    "text": "the story about what we discovered and how so uh if you look at the archive",
    "start": "656079",
    "end": "661320"
  },
  {
    "text": "formats usually you're talking about the most popular ones and these are the ones zip RAR cap 7zip and jzip now these are",
    "start": "661320",
    "end": "669200"
  },
  {
    "text": "the files you will normally find on any operating system uh and uh any PC in the world but um if we look at them this way",
    "start": "669200",
    "end": "677680"
  },
  {
    "text": "you will most commonly find these first four on Windows and Unix uh for gzip but",
    "start": "677680",
    "end": "683959"
  },
  {
    "text": "that doesn't mean that's going to be the case because files are just binaries and they're not binded to the operating",
    "start": "683959",
    "end": "689880"
  },
  {
    "text": "system in in any form uh but we selected to split them this way because their",
    "start": "689880",
    "end": "696519"
  },
  {
    "text": "archive processors are commonly built for these uh platforms now first format is zip file",
    "start": "696519",
    "end": "703920"
  },
  {
    "text": "format and it is most common file format in use today uh what's interesting about",
    "start": "703920",
    "end": "708959"
  },
  {
    "text": "it is that it's over 20 years old so it was invented or created in 1986 by Phil",
    "start": "708959",
    "end": "716000"
  },
  {
    "text": "cats for pkzip uh of course the format itself is fully documented and this is very important the documentation for the",
    "start": "716000",
    "end": "723040"
  },
  {
    "text": "this file format is 32k line text file so if you're implementing your own solution you really have to go through",
    "start": "723040",
    "end": "729360"
  },
  {
    "text": "all of that and um even the most popular archive processors such as windzip",
    "start": "729360",
    "end": "734920"
  },
  {
    "text": "haven't implemented all the features so uh you see you can create a file that's uh legal by documentation but it really",
    "start": "734920",
    "end": "743519"
  },
  {
    "text": "really can be open by um a standard tool that we use today so such as the windzip which is the most popular zip Arch",
    "start": "743519",
    "end": "750120"
  },
  {
    "text": "program power zip VR and sem zip course which is the open source",
    "start": "750120",
    "end": "756440"
  },
  {
    "text": "version now this format supports a recovery multi-is spanning encryption and sfx it has multiple compression",
    "start": "756440",
    "end": "763040"
  },
  {
    "text": "algorithms but the default one is deflate now uh the rare fire file format",
    "start": "763040",
    "end": "769079"
  },
  {
    "text": "is a very popular one it was developed by Eugene Rell and it is partially documented it's a technical note you get",
    "start": "769079",
    "end": "776560"
  },
  {
    "text": "with the program and it doesn't really contain everything you need to know about the format but it's a place to",
    "start": "776560",
    "end": "782360"
  },
  {
    "text": "start so uh it is uh it's de compression is supported by wiar of course which is",
    "start": "782360",
    "end": "788440"
  },
  {
    "text": "its native iive processor um you can download an SDK which works with the U",
    "start": "788440",
    "end": "795639"
  },
  {
    "text": "ra archives uh but it only gives you an option to decompress the archives you cannot compress them and these other",
    "start": "795639",
    "end": "802079"
  },
  {
    "text": "programs of course now this format of course supports every cover multid spanning encryption and sfx uh those",
    "start": "802079",
    "end": "809160"
  },
  {
    "text": "those are the most common features we found we find in today's archive",
    "start": "809160",
    "end": "814240"
  },
  {
    "text": "processors uh compression algorithm is a bit different but it's based on LZ n ppmd though it's proprietary so that's",
    "start": "814240",
    "end": "821320"
  },
  {
    "text": "why you need a license for it now the cap file format is a very common installer format um it's very rarely",
    "start": "821320",
    "end": "829160"
  },
  {
    "text": "used by users uh it's created by Microsoft and it's used as um installer",
    "start": "829160",
    "end": "834600"
  },
  {
    "text": "format for their platform it is fully documented uh it has a 20 hpdf file you",
    "start": "834600",
    "end": "839880"
  },
  {
    "text": "can look at uh it's pretty detailed one so uh the Gap file format is of",
    "start": "839880",
    "end": "845079"
  },
  {
    "text": "course supported by many software utilities such as Microsoft Windows who has uh included um compressed folders",
    "start": "845079",
    "end": "851959"
  },
  {
    "text": "and it has support for both zip and cab files um what's interesting is that of",
    "start": "851959",
    "end": "859519"
  },
  {
    "text": "all these tools only Power Archer can compress files into cab archives and",
    "start": "859519",
    "end": "864880"
  },
  {
    "text": "once you create a cap archive you cannot add any more files to it because that's how the specs",
    "start": "864880",
    "end": "871440"
  },
  {
    "text": "work and it supports multi-day spanning dig digital sign signing and sfx uses",
    "start": "871440",
    "end": "877800"
  },
  {
    "text": "four compression algorithms lzx deflate Quantum and mzip szip as we talked it's an open",
    "start": "877800",
    "end": "884839"
  },
  {
    "text": "source uh format it started in 2000 and it was developed by Igor Pavlo uh it is",
    "start": "884839",
    "end": "891959"
  },
  {
    "text": "fully documented it has series of text files you can look at and see how uh the format looks on disk um it's native",
    "start": "891959",
    "end": "899600"
  },
  {
    "text": "processor is 7zip of course all the other tools also support 7zip it has",
    "start": "899600",
    "end": "906360"
  },
  {
    "text": "multi-is spanning encryption and sfx it uh for compression algorithm it uses its own LZ variation called",
    "start": "906360",
    "end": "914639"
  },
  {
    "text": "lzma now the jzip file format is most commonly found in Unix uh it was created",
    "start": "914639",
    "end": "920360"
  },
  {
    "text": "uh in 1992 and it is uh documented just by a few pages and in",
    "start": "920360",
    "end": "927160"
  },
  {
    "text": "96 now it is also supported by every known and most popular archive processor",
    "start": "927160",
    "end": "933680"
  },
  {
    "text": "Now it only supports compressing single file so if you want to compress more files you have to uh bind them together",
    "start": "933680",
    "end": "940480"
  },
  {
    "text": "with another program usually it's star uh and then compress uh the end result",
    "start": "940480",
    "end": "946600"
  },
  {
    "text": "uh it only uses deflate algorithm now since we know all this about these format uh we wanted to",
    "start": "946600",
    "end": "954600"
  },
  {
    "text": "know what kind of what does it all mean it means that all files on the file",
    "start": "954600",
    "end": "959759"
  },
  {
    "text": "system are basically just binaries and if you look at any file I mean doc",
    "start": "959759",
    "end": "965279"
  },
  {
    "text": "PowerPoint presentation movie or an archive it's it's just a binary you can see with heck editor and edit any bites",
    "start": "965279",
    "end": "972759"
  },
  {
    "text": "that you're choosing but to uh edit files successfully you have to know the",
    "start": "972759",
    "end": "978160"
  },
  {
    "text": "the documentation for that particular format in order to modify the file correctly so uh what are our goals when",
    "start": "978160",
    "end": "984639"
  },
  {
    "text": "it comes to Mal forming files from a technography standpoint we we want to hide files or any messages from you and",
    "start": "984639",
    "end": "992440"
  },
  {
    "text": "uh we want to do that uh in a process which can be reversed so once you hidden",
    "start": "992440",
    "end": "997639"
  },
  {
    "text": "something inside an archive you must be able to retrieve it later and from a vulnerability standpoint we don't want",
    "start": "997639",
    "end": "1003440"
  },
  {
    "text": "to hide anything but we want to break an archive processor now this is really neat because uh multiple security",
    "start": "1003440",
    "end": "1010279"
  },
  {
    "text": "vendors have developed their own archive processors and uh since for zip we said",
    "start": "1010279",
    "end": "1016079"
  },
  {
    "text": "the documentation is 32k lines long you bet there are some things they looked over now why does fuzzing doesn't",
    "start": "1016079",
    "end": "1023880"
  },
  {
    "text": "apply to this scenario because uh we don't want to crash the program we just uh want to uh break an archive processor",
    "start": "1023880",
    "end": "1030558"
  },
  {
    "text": "so it just skips over a file and doesn't scan it in full now how is it achieved first and",
    "start": "1030559",
    "end": "1037760"
  },
  {
    "text": "foremost you have to know the documentation nothing can save you from it you have to read the entire documentation and just think uh of",
    "start": "1037760",
    "end": "1044640"
  },
  {
    "text": "certain features such as this is something nobody would Implement and just try that and if that works with",
    "start": "1044640",
    "end": "1052080"
  },
  {
    "text": "archive processor such as windzip uh you might want to try that with security",
    "start": "1052080",
    "end": "1057840"
  },
  {
    "text": "tools now uh documentation itself is not perfect there are some things that are",
    "start": "1057840",
    "end": "1063240"
  },
  {
    "text": "really unclear and if you look at the zip documentation there are sentences that uh really don't make no sense so",
    "start": "1063240",
    "end": "1071000"
  },
  {
    "text": "you can use that to your advantage and think of the ways how anybody would Implement",
    "start": "1071000",
    "end": "1076960"
  },
  {
    "text": "that you can use ra Ed Fields as I said that is basically knowing the documentation very well and you can",
    "start": "1076960",
    "end": "1084440"
  },
  {
    "text": "combine couple of file formats together to create this sort of a weird file we",
    "start": "1084440",
    "end": "1089640"
  },
  {
    "text": "will present later when we combined a zip 64 format with a normal zip uh format and just try to mess with the",
    "start": "1089640",
    "end": "1097480"
  },
  {
    "text": "format identification so not the proper algorithms are used to decompress the archive and of course this try and error",
    "start": "1097480",
    "end": "1104559"
  },
  {
    "text": "method you can just try to change some bites and see how that works or doesn't",
    "start": "1104559",
    "end": "1110640"
  },
  {
    "text": "now stenography is achieved by all of the above and you can also inject more",
    "start": "1110640",
    "end": "1115720"
  },
  {
    "text": "data into the archive now there were some previous Works in this area uh there were some",
    "start": "1115720",
    "end": "1121679"
  },
  {
    "text": "archive malformation tests that were published in 2004 by I defense and their implications are quite nicely put by EET",
    "start": "1121679",
    "end": "1130000"
  },
  {
    "text": "I'm going to read this it says the vulnerability was caused by the fact that some archive compression the compression software including when zip",
    "start": "1130000",
    "end": "1136159"
  },
  {
    "text": "incorrectly handled compress compressed files with deliberately damaged file headers thus in fact allowing creation",
    "start": "1136159",
    "end": "1141799"
  },
  {
    "text": "of damaged archive files that would automatically be repaired on the victim's computer without notifying the user and that's that's what what this is",
    "start": "1141799",
    "end": "1149400"
  },
  {
    "text": "really about this is what we focused our testing on now first thing we wanted to",
    "start": "1149400",
    "end": "1154880"
  },
  {
    "text": "know is how fast and how accurately are we detecting formats this is very",
    "start": "1154880",
    "end": "1160520"
  },
  {
    "text": "important because this is first step in processing any format second one is uh if you get the file you have to know if",
    "start": "1160520",
    "end": "1166760"
  },
  {
    "text": "it's valid or not and if it's corrupted uh you have to know uh what what amount",
    "start": "1166760",
    "end": "1172400"
  },
  {
    "text": "of data you can recover from that and of course if our code was vulnerable to any",
    "start": "1172400",
    "end": "1177679"
  },
  {
    "text": "of the known attacks or the future ones and then stenography came into the",
    "start": "1177679",
    "end": "1183240"
  },
  {
    "text": "picture and we wanted to know the following we know wanted to know is there interesting data between all these",
    "start": "1183240",
    "end": "1188760"
  },
  {
    "text": "files in archives and even so if there is this data can we corrupt it can this",
    "start": "1188760",
    "end": "1193919"
  },
  {
    "text": "data have a self-destruct button now here is what we found in our tests",
    "start": "1193919",
    "end": "1199799"
  },
  {
    "text": "from SE stenography standpoint we found multiple ways of hiding files in formats and we're going to show a couple of",
    "start": "1199799",
    "end": "1206400"
  },
  {
    "text": "those in our demo uh they are quite nice nicely relating to the vulnerabilities we",
    "start": "1206400",
    "end": "1211840"
  },
  {
    "text": "found now from the vulnerability standpoint we found high probability of malver detection evasion so uh antim",
    "start": "1211840",
    "end": "1218559"
  },
  {
    "text": "malver scanners um affected by these 15 reported vulnerabilities with more pending uh were unable to correctly",
    "start": "1218559",
    "end": "1225799"
  },
  {
    "text": "process the entire archive and therefore we're missing some of the malware pack",
    "start": "1225799",
    "end": "1231440"
  },
  {
    "text": "inside it now uh there are few types of Threat Level you can assigned to this",
    "start": "1231440",
    "end": "1237159"
  },
  {
    "text": "you can say it's very high and it's critical because if you are uh at the Gateway and you want to scan all the",
    "start": "1237159",
    "end": "1243280"
  },
  {
    "text": "email and all the files that come to your network you're going to want to be able to scan everything but uh if you",
    "start": "1243280",
    "end": "1249520"
  },
  {
    "text": "are scanning on the desktop or your endpoints there's a low impact because for that malware to execute you still",
    "start": "1249520",
    "end": "1256120"
  },
  {
    "text": "have to extract it and that's where the antim scanners are going to catch it so depending on which uh software security",
    "start": "1256120",
    "end": "1264080"
  },
  {
    "text": "product you are looking at uh the impact is either high or",
    "start": "1264080",
    "end": "1269480"
  },
  {
    "text": "low now uh we're going to go over this technography in the zip file format only",
    "start": "1269480",
    "end": "1275400"
  },
  {
    "text": "uh and it's achieved by uh modifying the name of the compressed file inside",
    "start": "1275400",
    "end": "1280919"
  },
  {
    "text": "headers so basically just by inserting a no character in front of the first",
    "start": "1280919",
    "end": "1287360"
  },
  {
    "text": "letter of the compressor file you are able to hide files from you but that",
    "start": "1287360",
    "end": "1292720"
  },
  {
    "text": "only works for wind raar and other processors will show up empty empty file",
    "start": "1292720",
    "end": "1299640"
  },
  {
    "text": "slot now there are other ways you can successfully hide files from all archive processors such as decreasing the number",
    "start": "1299640",
    "end": "1306679"
  },
  {
    "text": "of packed files inside the header so if you have the last file packed you just decrease the number and the last file",
    "start": "1306679",
    "end": "1312080"
  },
  {
    "text": "will not be registered and we can use extra fields in the zip file documentation to camouflage some of the",
    "start": "1312080",
    "end": "1318880"
  },
  {
    "text": "heer data and we can move the central directory to high data from the start of the archive and we can also inject new",
    "start": "1318880",
    "end": "1325200"
  },
  {
    "text": "data of course now what are the implications of this technography point data can of course be hidden in zip",
    "start": "1325200",
    "end": "1332080"
  },
  {
    "text": "archive uh but data can also be hidden in the O XML file format which is the open Office XML file format used by",
    "start": "1332080",
    "end": "1339240"
  },
  {
    "text": "Microsoft Office uh which is basically uh basically just a zip archive containing lots of XML files so uh since",
    "start": "1339240",
    "end": "1346799"
  },
  {
    "text": "this applies to zip archives it also applies to the Microsoft Office file",
    "start": "1346799",
    "end": "1352080"
  },
  {
    "text": "format now uh this is what is important because if we have injected data inside",
    "start": "1352080",
    "end": "1357320"
  },
  {
    "text": "of it it can self-destruct and it can do that uh by by the actions performed by the user",
    "start": "1357320",
    "end": "1365120"
  },
  {
    "text": "so if I would to hide a file inside the word document and would you would to open that kind of file Microsoft Office",
    "start": "1365120",
    "end": "1371799"
  },
  {
    "text": "would tell you this file was damaged do you want to repair it and as soon as you do the file uh the injected technography",
    "start": "1371799",
    "end": "1377960"
  },
  {
    "text": "data is gone same can be achieved by the anti virus software because if you pack a malware",
    "start": "1377960",
    "end": "1383039"
  },
  {
    "text": "inside it and additionally hide some stego data inside it so if you're inspecting that kind of file and you",
    "start": "1383039",
    "end": "1388120"
  },
  {
    "text": "have an antivirus working it's going to say oh I found a malware in this do you want to clean it and as soon as you do",
    "start": "1388120",
    "end": "1393320"
  },
  {
    "text": "the data is gone so uh from the forensic standpoint if you are inspecting the",
    "start": "1393320",
    "end": "1398520"
  },
  {
    "text": "data uh you must make sure that no other tool is going to interfere with the",
    "start": "1398520",
    "end": "1403640"
  },
  {
    "text": "evidence of course now the implementations we found because we didn't really invent this and",
    "start": "1403640",
    "end": "1410400"
  },
  {
    "text": "we didn't want to create new problems there are some implementations you can see on the internet there's Zips",
    "start": "1410400",
    "end": "1415600"
  },
  {
    "text": "technography by K John uh it's published by SEO license it can hide multiple",
    "start": "1415600",
    "end": "1420679"
  },
  {
    "text": "files uh inside the zip archive which is stored just before the central directory it can also encrypt files with the",
    "start": "1420679",
    "end": "1426679"
  },
  {
    "text": "password and there's another solution we found it's called ZJ mask by Winston Che it's a freeware tool it uh can only hide",
    "start": "1426679",
    "end": "1435880"
  },
  {
    "text": "one file inside either zip or a jpeg file it does that by prepending the file",
    "start": "1435880",
    "end": "1440960"
  },
  {
    "text": "to the archive it also damages the file in the process but it can be decompressed generically so uh if you",
    "start": "1440960",
    "end": "1448480"
  },
  {
    "text": "use software such as winr you will be able to decompress such an archive but",
    "start": "1448480",
    "end": "1453520"
  },
  {
    "text": "since that's not valid archive we really didn't want to bother with that now we're going to disclose the 15",
    "start": "1453520",
    "end": "1460799"
  },
  {
    "text": "vulnerabilities we found now before we do that uh I just want to say that we acted responsibly uh this way and we",
    "start": "1460799",
    "end": "1468000"
  },
  {
    "text": "publ we disclosed all these vulnerabilities to the affected vendors with association",
    "start": "1468000",
    "end": "1474039"
  },
  {
    "text": "with ctfi so uh let's go over them uh most important thing is during",
    "start": "1474039",
    "end": "1481480"
  },
  {
    "text": "our investigation and stuff you're going to see now is mostly related to zip but there's at least one vulnerability for",
    "start": "1481480",
    "end": "1488600"
  },
  {
    "text": "each of the affected file formats so uh most of these are zip the",
    "start": "1488600",
    "end": "1493720"
  },
  {
    "text": "first one is caused by extensive Heather modification so what we did here is we",
    "start": "1493720",
    "end": "1498840"
  },
  {
    "text": "wanted to create our own stenography implementation just T our tool and in the process uh we successfully H have",
    "start": "1498840",
    "end": "1506120"
  },
  {
    "text": "hidden the file but we did extensive modification to the file header and that's uh what caused a problem with",
    "start": "1506120",
    "end": "1512039"
  },
  {
    "text": "some uh security software venders so uh here's what we did uh we used central",
    "start": "1512039",
    "end": "1520000"
  },
  {
    "text": "directory fields to store some information uh which broke the file format",
    "start": "1520000",
    "end": "1525720"
  },
  {
    "text": "intentionally um and replaced the the first name f name of the file with zero",
    "start": "1525720",
    "end": "1531080"
  },
  {
    "text": "and erased the local header content so that's why archive processors in an",
    "start": "1531080",
    "end": "1537720"
  },
  {
    "text": "software didn't really work right the second one was anyone could have thought of this but this was a cool",
    "start": "1537720",
    "end": "1544480"
  },
  {
    "text": "thing to try we partially protected the archive with a password so uh we protected the first file which is just",
    "start": "1544480",
    "end": "1549799"
  },
  {
    "text": "an image with a password and all the other files in an archive weren't protected with the password so you can",
    "start": "1549799",
    "end": "1555880"
  },
  {
    "text": "extract them normally and some antivirus when uh wouldn't correctly process this",
    "start": "1555880",
    "end": "1561000"
  },
  {
    "text": "archive they would find the first file that was password protected and they just thought the whole archive",
    "start": "1561000",
    "end": "1567720"
  },
  {
    "text": "was now uh this one uh next one is the this weird H hybrid uh file method we",
    "start": "1567720",
    "end": "1574320"
  },
  {
    "text": "talked about so uh this is pretty a neat thing to do uh what we did is uh we",
    "start": "1574320",
    "end": "1580240"
  },
  {
    "text": "compressed a config sample and we created a self- extracting executable",
    "start": "1580240",
    "end": "1585799"
  },
  {
    "text": "with a zip and no antivirus in the world had a problem with this okay because um as if it's a specific format when you",
    "start": "1585799",
    "end": "1592600"
  },
  {
    "text": "are identifying the zip archive you are going from the end of the file so what we wanted to do is just Abend another",
    "start": "1592600",
    "end": "1599120"
  },
  {
    "text": "zip file to the end of the AR uh to the end of the sfx file and that's why when you are scanning the archive you will be",
    "start": "1599120",
    "end": "1605559"
  },
  {
    "text": "able only to see the last file which was appended and the sfx content which was extracted normally when you started the",
    "start": "1605559",
    "end": "1611720"
  },
  {
    "text": "sfx program uh the compressed content was malare of course and some uh antivirus",
    "start": "1611720",
    "end": "1618919"
  },
  {
    "text": "venders went and this was the correct way for scanning the the file from the end and that's why they only found the",
    "start": "1618919",
    "end": "1626200"
  },
  {
    "text": "clean archive appended now this one is one of the St",
    "start": "1626200",
    "end": "1634440"
  },
  {
    "text": "implications to the zip archives so there's an extra field uh behind every Central directory entry in the zip file",
    "start": "1634440",
    "end": "1642760"
  },
  {
    "text": "header and if you uh use this data which isn't really commonly used by any of the",
    "start": "1642760",
    "end": "1647840"
  },
  {
    "text": "archiv processors you will be able to hide some data behind it so by damaging",
    "start": "1647840",
    "end": "1653279"
  },
  {
    "text": "the header that like that and just cloaking the next next item in the zip",
    "start": "1653279",
    "end": "1660480"
  },
  {
    "text": "header we were able to uh successfully hide M because antivirus software would just skip over that because they",
    "start": "1660480",
    "end": "1667760"
  },
  {
    "text": "weren't processing the extra fuel correctly now another weird file format",
    "start": "1667760",
    "end": "1674519"
  },
  {
    "text": "uh example is uh which one I mentioned earlier is where we added some fields to",
    "start": "1674519",
    "end": "1681120"
  },
  {
    "text": "the zip archive which uh made it look like a zip 64 but no uh archive",
    "start": "1681120",
    "end": "1686840"
  },
  {
    "text": "processor thought it was Z zip 64 it processed that normally so that was um an error with the identifica the file",
    "start": "1686840",
    "end": "1694440"
  },
  {
    "text": "format itself now uh next one is realigning the",
    "start": "1694440",
    "end": "1699880"
  },
  {
    "text": "file to the 40 hex byes and realigned is quoted because we really didn't realign",
    "start": "1699880",
    "end": "1706799"
  },
  {
    "text": "anything we just prepended bytes and uh that actually breaks the archive but",
    "start": "1706799",
    "end": "1712720"
  },
  {
    "text": "since the uh ZIP file format has both Central and local directories you can",
    "start": "1712720",
    "end": "1717840"
  },
  {
    "text": "also extract this data generically uh and software which does",
    "start": "1717840",
    "end": "1722919"
  },
  {
    "text": "that is WinRAR and it was the only one who was able to do it and that of course even though this",
    "start": "1722919",
    "end": "1729159"
  },
  {
    "text": "isn't a valid archive if it's still extractable by at least one tool",
    "start": "1729159",
    "end": "1735080"
  },
  {
    "text": "antivirus fenders want to support that case as well now uh we use the file common field",
    "start": "1735080",
    "end": "1742320"
  },
  {
    "text": "which is exactly the same like the extra field uh it's just additional data behind every entry in the header uh and",
    "start": "1742320",
    "end": "1749519"
  },
  {
    "text": "since this is rarely used field and we haven't seen any of the files using this",
    "start": "1749519",
    "end": "1755039"
  },
  {
    "text": "uh some antivirus Wenders were just uh confused about where the next header is and didn't really scan the whole",
    "start": "1755039",
    "end": "1763320"
  },
  {
    "text": "archive the next one is also weird kind of format uh it uh relates to bad",
    "start": "1763320",
    "end": "1769720"
  },
  {
    "text": "compression algorithm but it's not really bad because specially crafted zip x file which was introduced in when zip",
    "start": "1769720",
    "end": "1776159"
  },
  {
    "text": "12 version uh it has a new compression for the JPEG files themselves so if you",
    "start": "1776159",
    "end": "1782640"
  },
  {
    "text": "compressed a single image which is jpeg with this new uh zipx version and you",
    "start": "1782640",
    "end": "1788960"
  },
  {
    "text": "just rename the file to zip and use any other tool in the world to add another file inside that particular archive we",
    "start": "1788960",
    "end": "1796240"
  },
  {
    "text": "still have a valid zip file because all old headers are the same between the new file format and the old one but it's",
    "start": "1796240",
    "end": "1803640"
  },
  {
    "text": "only the compression algorithms that have changed so uh when the antivirus software was scanning this they were at",
    "start": "1803640",
    "end": "1810200"
  },
  {
    "text": "the first file and saw the compressional algorithm they don't support and just keep over the whole",
    "start": "1810200",
    "end": "1815880"
  },
  {
    "text": "archive now we've came to raar format and this is an interesting one because",
    "start": "1815880",
    "end": "1823399"
  },
  {
    "text": "uh first file block inside the router file file format defines the whole arive it says if it's a multivolume one or",
    "start": "1823399",
    "end": "1830760"
  },
  {
    "text": "stuff like that but it has a pretty neat feature that you can use to declare a",
    "start": "1830760",
    "end": "1836600"
  },
  {
    "text": "block as temporary one so next time you add an archive to that particular add a",
    "start": "1836600",
    "end": "1842200"
  },
  {
    "text": "file to that particular archive uh that first block will be stripped and since it is stripped the archive is broken so",
    "start": "1842200",
    "end": "1849480"
  },
  {
    "text": "you can use this as uh prevention of modifying data we will show this in the",
    "start": "1849480",
    "end": "1855919"
  },
  {
    "text": "demonstration later but what the problem was uh is that the first eight bytes are used to identify the archive itself but",
    "start": "1855919",
    "end": "1862840"
  },
  {
    "text": "the next uh block itself is pretty much standard so um our best guess is that",
    "start": "1862840",
    "end": "1869039"
  },
  {
    "text": "some of that data was used to identify the file format and that's why uh the scanning didn't work",
    "start": "1869039",
    "end": "1875600"
  },
  {
    "text": "properly now of course just as a zip we tried the password protecting the single file and it also",
    "start": "1875600",
    "end": "1882960"
  },
  {
    "text": "worked now uh every file inside the zip inside the raar uh",
    "start": "1882960",
    "end": "1888679"
  },
  {
    "text": "archive also has a version requirement for the software to extract it and by",
    "start": "1888679",
    "end": "1893880"
  },
  {
    "text": "setting the version requirement to 25 which is the FF and",
    "start": "1893880",
    "end": "1899000"
  },
  {
    "text": "hex we were successfully able to uh prevent uh some software vendors from",
    "start": "1899000",
    "end": "1905480"
  },
  {
    "text": "decompressing such archives of course the first file cannot be decompressed by any of the software that processes uh ra",
    "start": "1905480",
    "end": "1912320"
  },
  {
    "text": "archive but uh the rest of the files in the archive work just fine",
    "start": "1912320",
    "end": "1918960"
  },
  {
    "text": "now uh cap file format what we wanted to do is see if we could increase the the",
    "start": "1918960",
    "end": "1924760"
  },
  {
    "text": "compressed file size so we set that size to 4 GB which is the maximum file size",
    "start": "1924760",
    "end": "1930200"
  },
  {
    "text": "uh Allowed by the cap file format and this doesn't do anything for the cap",
    "start": "1930200",
    "end": "1935240"
  },
  {
    "text": "processors because they don't rely on this information when they're creating the file they're just decompressing data",
    "start": "1935240",
    "end": "1940840"
  },
  {
    "text": "and once they come to the Terminator bite they know the output file size and they just write that but if somebody",
    "start": "1940840",
    "end": "1947639"
  },
  {
    "text": "would to try to allocate all this data of course their archive processor would break or just skip over the file",
    "start": "1947639",
    "end": "1954320"
  },
  {
    "text": "thinking it's too large to contain any kind of malware and just keep scanning",
    "start": "1954320",
    "end": "1960159"
  },
  {
    "text": "it now for G gzip file format we just added the documented extra field it's in",
    "start": "1960159",
    "end": "1965799"
  },
  {
    "text": "the documentation and it's really not commonly used and that's why some",
    "start": "1965799",
    "end": "1970840"
  },
  {
    "text": "software venders had the problem of finding the start of the compressed data which was shifted by a few bytes and uh",
    "start": "1970840",
    "end": "1977159"
  },
  {
    "text": "that's why did the compression didn't work now for 7zip uh it has also just like a ra",
    "start": "1977159",
    "end": "1985480"
  },
  {
    "text": "archive it has several blocks uh which describe the following content and by setting the CRC of the header to an",
    "start": "1985480",
    "end": "1993519"
  },
  {
    "text": "incorrect value you would still have a valid archive which can be decompressed by 7 zip but uh some some security",
    "start": "1993519",
    "end": "2001240"
  },
  {
    "text": "Wenders uh we checking the CRC and uh telling oh this file is broken and we're",
    "start": "2001240",
    "end": "2006440"
  },
  {
    "text": "not going to scan it now uh this uh uh can be implemented uh",
    "start": "2006440",
    "end": "2013679"
  },
  {
    "text": "like this so first Heather which has these four",
    "start": "2013679",
    "end": "2018799"
  },
  {
    "text": "Fields can be set to zero and this only works if if you have a single file in an",
    "start": "2018799",
    "end": "2023840"
  },
  {
    "text": "archive because then uh 7zip will generically try to locate uh that particular compressed file and it will",
    "start": "2023840",
    "end": "2030120"
  },
  {
    "text": "succeed at that and the other archive or processors found in U security software",
    "start": "2030120",
    "end": "2035720"
  },
  {
    "text": "uh wouldn't now what are the conclusions of our",
    "start": "2035720",
    "end": "2040880"
  },
  {
    "text": "testing files can be Mal formatted to carry hidden playload and that hidden playload can uh affect the the way we",
    "start": "2040880",
    "end": "2049118"
  },
  {
    "text": "process archives and uh in case of security uh we won't be able to scan the",
    "start": "2049119",
    "end": "2055398"
  },
  {
    "text": "whole archive now malform files can also be automatically fixed or by adding a",
    "start": "2055399",
    "end": "2062960"
  },
  {
    "text": "generic decompression a generic decompression routines to the archive processor such such as uh WinRAR has for",
    "start": "2062960",
    "end": "2069560"
  },
  {
    "text": "zip file format they can still be decompressed even though they don't look valid to the from the documentation",
    "start": "2069560",
    "end": "2076760"
  },
  {
    "text": "standpoint now of course files can be Mal format to carry additional tonography",
    "start": "2076760",
    "end": "2082398"
  },
  {
    "text": "content and this hidden content has a self-destruct button so if you are not",
    "start": "2082399",
    "end": "2087440"
  },
  {
    "text": "careful enough uh in the process of repairing an archive or modifying anything you would end up with losing",
    "start": "2087440",
    "end": "2094040"
  },
  {
    "text": "the important data now uh that brings us to our first demonstration we're going",
    "start": "2094040",
    "end": "2100320"
  },
  {
    "text": "to do some hex editing we're going to hide existing files inside IN Zip Zip archive we're going to insert some",
    "start": "2100320",
    "end": "2106960"
  },
  {
    "text": "hidden messages we're going to invent our own file format and we're going to show off uh the tool we used to check",
    "start": "2106960",
    "end": "2113400"
  },
  {
    "text": "all this and it's going to U inject some uh sto data inside an existing zip",
    "start": "2113400",
    "end": "2119440"
  },
  {
    "text": "archive so let's do that",
    "start": "2119440",
    "end": "2124319"
  },
  {
    "text": "okay so the first thing is we wanted to show is this particular R archive which",
    "start": "2132920",
    "end": "2138320"
  },
  {
    "text": "is the first uh vssa security advisor we posted so it only has one particular",
    "start": "2138320",
    "end": "2144720"
  },
  {
    "text": "file file in it and it's malare dobin it's uh",
    "start": "2144720",
    "end": "2150359"
  },
  {
    "text": "compressed uh configure sample I believe so uh its",
    "start": "2150359",
    "end": "2156160"
  },
  {
    "text": "header is damaged and you can see that but just by looking at the X",
    "start": "2156160",
    "end": "2162119"
  },
  {
    "text": "output as you see first two bytes are zeros and there're supposed to be the format format signature which is for zip",
    "start": "2163040",
    "end": "2171000"
  },
  {
    "text": "PK we damage that intentionally and at the end we added another file which is",
    "start": "2171000",
    "end": "2178240"
  },
  {
    "text": "hidden and you don't really see it it's called zip Insider if you see that string right",
    "start": "2178240",
    "end": "2184040"
  },
  {
    "text": "here and since that file since that file is hidden and it's not shown in the",
    "start": "2184040",
    "end": "2190359"
  },
  {
    "text": "archive processors that actually confused security software and thought",
    "start": "2190359",
    "end": "2195560"
  },
  {
    "text": "that the archive was broken and didn't scan it in full now some other fields were modified here we're not going to go",
    "start": "2195560",
    "end": "2202240"
  },
  {
    "text": "into that this was documented in our white paper now a tool used to create such an",
    "start": "2202240",
    "end": "2209200"
  },
  {
    "text": "archive is called zip Insider we made uh such an arch uh such a program to test",
    "start": "2209200",
    "end": "2215960"
  },
  {
    "text": "if we are correctly looking for the content and if we are processing these",
    "start": "2215960",
    "end": "2221359"
  },
  {
    "text": "archives correctly now I'm going to demonstrate",
    "start": "2221359",
    "end": "2227319"
  },
  {
    "text": "how it works uh the archive uh in question this one riddle uh already has",
    "start": "2227319",
    "end": "2233040"
  },
  {
    "text": "a hidden content inside it so just by calling uh ZIP",
    "start": "2233040",
    "end": "2242240"
  },
  {
    "text": "Insider we can uh list all files that are hidden in inside that",
    "start": "2242240",
    "end": "2248079"
  },
  {
    "text": "particular Archive of course I remove the",
    "start": "2248079",
    "end": "2254200"
  },
  {
    "text": "hiding so height riddle",
    "start": "2254200",
    "end": "2262160"
  },
  {
    "text": "okay now we see that we have found one file that was hidden it's called file it",
    "start": "2264359",
    "end": "2269680"
  },
  {
    "text": "doesn't have an extension it size is3 bytes has a certain CRC of course now",
    "start": "2269680",
    "end": "2276760"
  },
  {
    "text": "that particular file is Now hidden in the archive because process was reversed and if we",
    "start": "2276760",
    "end": "2283960"
  },
  {
    "text": "wanted to show that particular archive we would modify the archive itself in order to show them show that particular",
    "start": "2283960",
    "end": "2292240"
  },
  {
    "text": "file in any program so now we have modified the",
    "start": "2292240",
    "end": "2299359"
  },
  {
    "text": "archive and we can see that file and that file is particularly text file which",
    "start": "2299359",
    "end": "2306160"
  },
  {
    "text": "says the answer to the hidden riddle is the riddle itself you have to look closer to find your answer this isn't",
    "start": "2306160",
    "end": "2311599"
  },
  {
    "text": "the answer to the question why this file is so special and I actually sent this to a couple of my guys and they were",
    "start": "2311599",
    "end": "2318000"
  },
  {
    "text": "able to find this file but the rest of the puzzle was uh Beyond",
    "start": "2318000",
    "end": "2323599"
  },
  {
    "text": "them so this was uh an example of hiding existing content inside an archive but",
    "start": "2323599",
    "end": "2330960"
  },
  {
    "text": "we have also injected additional content inside the archive itself so if we use extract",
    "start": "2330960",
    "end": "2338800"
  },
  {
    "text": "to get that new content to the dis file has been successfully uh",
    "start": "2340640",
    "end": "2347880"
  },
  {
    "text": "extracted to dis and this is that injected content on the disk as we see the file is passord protected and it's",
    "start": "2347880",
    "end": "2353800"
  },
  {
    "text": "another text file and the password for it is of course",
    "start": "2353800",
    "end": "2358720"
  },
  {
    "text": "riddle and this is the this is the answer to the question why this file is",
    "start": "2359280",
    "end": "2364319"
  },
  {
    "text": "special is because we made it with the tool called Z Insider so as you can see",
    "start": "2364319",
    "end": "2370480"
  },
  {
    "text": "data can successfully be hidden inside an archive and we can do all sorts of",
    "start": "2370480",
    "end": "2375560"
  },
  {
    "text": "stuff uh with our tools to extract them back now uh provided this particular",
    "start": "2375560",
    "end": "2382400"
  },
  {
    "text": "tool both hides and reveals content so it's only aware of its own mechanisms",
    "start": "2382400",
    "end": "2388280"
  },
  {
    "text": "for hiding uh additional data uh we're going to talk about how we",
    "start": "2388280",
    "end": "2394119"
  },
  {
    "text": "can generically detect any kind of hidden cont content a bit later but now",
    "start": "2394119",
    "end": "2399800"
  },
  {
    "text": "we're going to show few more things so another VSA with it it's the",
    "start": "2399800",
    "end": "2405599"
  },
  {
    "text": "111 uh this is the one that use uses the extra Fields so you can see",
    "start": "2405599",
    "end": "2411119"
  },
  {
    "text": "that uh this particular file which is also uh configure sample right here uh",
    "start": "2411119",
    "end": "2418079"
  },
  {
    "text": "its file name is uh B which should be 11 uh long but we only declared it as seven",
    "start": "2418079",
    "end": "2425119"
  },
  {
    "text": "so first seven letters of this word our file name and the rest as defined here",
    "start": "2425119",
    "end": "2431760"
  },
  {
    "text": "is just extra data and by processing the header uh ZIP really needs to know where",
    "start": "2431760",
    "end": "2437040"
  },
  {
    "text": "the next file in the archive is and that's the size of that local header plus the size of the name String plus",
    "start": "2437040",
    "end": "2444079"
  },
  {
    "text": "the size of the extra data plus the size of the file commments now since some software didn't",
    "start": "2444079",
    "end": "2452079"
  },
  {
    "text": "process that correctly they wouldn't be able to find the next file in line or the end of the",
    "start": "2452079",
    "end": "2459800"
  },
  {
    "text": "archive it's the same thing uh with the second version of the same uh",
    "start": "2459839",
    "end": "2465240"
  },
  {
    "text": "vulnerability but here uh we didn't hide the malitia",
    "start": "2465240",
    "end": "2470319"
  },
  {
    "text": "sample we hide hidden we have hidden the file before that so by adding this",
    "start": "2470319",
    "end": "2477160"
  },
  {
    "text": "extra 256 zeros we were uh we were able to break some archive processors",
    "start": "2477160",
    "end": "2484599"
  },
  {
    "text": "because we thought that some of them would generically search for the next uh",
    "start": "2484599",
    "end": "2489839"
  },
  {
    "text": "entry in the central directory so we added some space just test out what",
    "start": "2489839",
    "end": "2495839"
  },
  {
    "text": "what's their tolerance uh for this kind of stuff and it it turns out it's 256",
    "start": "2495839",
    "end": "2504200"
  },
  {
    "text": "bytes now uh talking about zip file format uh this is that particular file",
    "start": "2506280",
    "end": "2512440"
  },
  {
    "text": "asix file we talked about so if I was to open this file with uh let's say",
    "start": "2512440",
    "end": "2519400"
  },
  {
    "text": "WinRAR thing I would find is this image which was appended to the sfix file and",
    "start": "2519400",
    "end": "2526520"
  },
  {
    "text": "that's my good friend donkey now uh if I would to start this",
    "start": "2526520",
    "end": "2532680"
  },
  {
    "text": "sfx file the data that would be extracted to let's say new",
    "start": "2532680",
    "end": "2539119"
  },
  {
    "text": "folder wouldn't be uh picture of my good friend but it",
    "start": "2539319",
    "end": "2545119"
  },
  {
    "text": "would be the malicious payload we compressed so uh that's a new new folder",
    "start": "2545119",
    "end": "2553000"
  },
  {
    "text": "so you see something happened",
    "start": "2553000",
    "end": "2559400"
  },
  {
    "text": "okay so inside the new folder you have malber dobin which is a compressed",
    "start": "2561800",
    "end": "2567480"
  },
  {
    "text": "config sample so the sfx executable itself knows the correct contact de",
    "start": "2567480",
    "end": "2573040"
  },
  {
    "text": "compress but as because we are searching for the this particular cont content from the end of an archive we weren't",
    "start": "2573040",
    "end": "2580400"
  },
  {
    "text": "able to find that pack content we found the picture my good friend now uh we",
    "start": "2580400",
    "end": "2587960"
  },
  {
    "text": "could really go into detail of inventing a r file formats here but we're not going to because we we kind of low on",
    "start": "2587960",
    "end": "2594359"
  },
  {
    "text": "time uh what we're going to show is the modification of the sfix module so uh",
    "start": "2594359",
    "end": "2603040"
  },
  {
    "text": "inside the module of course there's an archive which needs to be decompressed and we changed pretty pretty much everything to the layout of the archive",
    "start": "2603040",
    "end": "2609599"
  },
  {
    "text": "now uh for the sfix module to be able to uh decompress that kind of content it",
    "start": "2609599",
    "end": "2615920"
  },
  {
    "text": "needs to be aware of the file format type so the binary itself the sfix",
    "start": "2615920",
    "end": "2621079"
  },
  {
    "text": "module was changed uh to recognize this new format we invented and if you try to open this",
    "start": "2621079",
    "end": "2628040"
  },
  {
    "text": "sfix executable with any software it's going to tell you that it has no idea",
    "start": "2628040",
    "end": "2634359"
  },
  {
    "text": "what it is of course but if we start it we are able",
    "start": "2634359",
    "end": "2639520"
  },
  {
    "text": "to decompress the protected content and this why this is why",
    "start": "2639520",
    "end": "2647520"
  },
  {
    "text": "no no software that works with archives will be able",
    "start": "2647559",
    "end": "2652960"
  },
  {
    "text": "to successfully decompress it and here again is the configure sample but we",
    "start": "2652960",
    "end": "2659880"
  },
  {
    "text": "were surprised to find that some antivirus fenders were able to scan this particular archive and the way that they",
    "start": "2659880",
    "end": "2666839"
  },
  {
    "text": "did this is they looked for the compressed data itself so we didn't change the compression algorithm or",
    "start": "2666839",
    "end": "2672720"
  },
  {
    "text": "anything like that we just changed how the headers look and some antivirus lenders were able to detect that and",
    "start": "2672720",
    "end": "2679119"
  },
  {
    "text": "decompress data correctly so uh when talking about raar",
    "start": "2679119",
    "end": "2686240"
  },
  {
    "text": "far format this is what we talked about by declaring this first block as a temporary one we can protect this",
    "start": "2686240",
    "end": "2693079"
  },
  {
    "text": "archive from modification so if I was to start this archive it shows a configure sample by just by adding a new file to",
    "start": "2693079",
    "end": "2701359"
  },
  {
    "text": "it we will successfully break it and it's broken so you can protect",
    "start": "2701359",
    "end": "2708599"
  },
  {
    "text": "your archives from being modified like this if you really want to but this process can be reversed I'm going to",
    "start": "2708599",
    "end": "2715760"
  },
  {
    "text": "show you how to do that right now so we just do a little bit of X",
    "start": "2715760",
    "end": "2723040"
  },
  {
    "text": "editing no big deal so we switched off that temporary flag see the new size",
    "start": "2723040",
    "end": "2729160"
  },
  {
    "text": "which is now D it's not 11 so D and we really need",
    "start": "2729160",
    "end": "2734240"
  },
  {
    "text": "to correct the header check some for this particular bit so we confute the",
    "start": "2734240",
    "end": "2739440"
  },
  {
    "text": "hash see that it's cf90 which was the",
    "start": "2739440",
    "end": "2748680"
  },
  {
    "text": "default value and if we save that we will be able to see both",
    "start": "2749599",
    "end": "2757520"
  },
  {
    "text": "the malicious payload and the one we have compressed and the archive of course",
    "start": "2757520",
    "end": "2763040"
  },
  {
    "text": "works so this is",
    "start": "2763040",
    "end": "2766520"
  },
  {
    "text": "reversible okay that's the first demonstration we have another one but we got to got to get there so uh to get",
    "start": "2768720",
    "end": "2776200"
  },
  {
    "text": "there we have to talk about the Nyx engine and that's the tool we are presenting today uh what's important",
    "start": "2776200",
    "end": "2782400"
  },
  {
    "text": "about the Nyx engine is who is NY and why we have we chosen her and so next is",
    "start": "2782400",
    "end": "2788119"
  },
  {
    "text": "the Greek goddess of night and we thought it would be kind of fun if we have a Greek goddess of night watching",
    "start": "2788119",
    "end": "2794000"
  },
  {
    "text": "over our files so what does it do it does archive",
    "start": "2794000",
    "end": "2799599"
  },
  {
    "text": "preprocessing so this isn't an extracting tool though it does have an ability to recover data so uh recovery",
    "start": "2799599",
    "end": "2807079"
  },
  {
    "text": "is done by extracting the data without really extracting so the data you uh",
    "start": "2807079",
    "end": "2812359"
  },
  {
    "text": "recover is still uh in same format as the archive is so if you recover damage",
    "start": "2812359",
    "end": "2818079"
  },
  {
    "text": "files from the zip they're still zipped you have to decompress them later but their headers have been fixed and you",
    "start": "2818079",
    "end": "2824680"
  },
  {
    "text": "can use that kind of files now uh it acts like an exploit shield in the",
    "start": "2824680",
    "end": "2829720"
  },
  {
    "text": "process of building this particular engine uh we wanted to uh have an engine",
    "start": "2829720",
    "end": "2834960"
  },
  {
    "text": "that's able to uh process the entire archive and look for these anomalies and",
    "start": "2834960",
    "end": "2841160"
  },
  {
    "text": "skip over them and make us feel safe because there were some exploits in the wild that um acted",
    "start": "2841160",
    "end": "2850079"
  },
  {
    "text": "like executing remote code in your machine if you were to process this kind of archives so we wanted to be safe from",
    "start": "2850079",
    "end": "2856079"
  },
  {
    "text": "this we also wanted to uh be able to generically detect all hidden data inside it now how can you use it uh it's",
    "start": "2856079",
    "end": "2864800"
  },
  {
    "text": "a free library it comes with with its SDK it's going to be available on our website soon uh it has a NYX console which is an",
    "start": "2864800",
    "end": "2872680"
  },
  {
    "text": "example of how to use an SDK and it's uh we we converted it to a plug-in for total commander and power",
    "start": "2872680",
    "end": "2879480"
  },
  {
    "text": "Archer so uh if they cannot process the archive our plugin is going to step in",
    "start": "2879480",
    "end": "2884520"
  },
  {
    "text": "and enable you to view the content and recover the data now the functional groups are of",
    "start": "2884520",
    "end": "2892520"
  },
  {
    "text": "course uh we support identification of the of these four file formats it's zi",
    "start": "2892520",
    "end": "2897920"
  },
  {
    "text": "RAR cap and gzip we enable uh content browsings",
    "start": "2897920",
    "end": "2904520"
  },
  {
    "text": "which means you can Traverse the archive one file at a time so just by calling get next file for example you would be",
    "start": "2904520",
    "end": "2911200"
  },
  {
    "text": "uh able to go through each and every file we found in the archive you also get all the information possible about",
    "start": "2911200",
    "end": "2918079"
  },
  {
    "text": "the pack content so the compress size decompress size file time file date",
    "start": "2918079",
    "end": "2923960"
  },
  {
    "text": "attributes uh is it password protected is the name unic code everything about",
    "start": "2923960",
    "end": "2929319"
  },
  {
    "text": "the archive does it split to multiple volumes everything about the archive",
    "start": "2929319",
    "end": "2934480"
  },
  {
    "text": "that is present in the headers and valid we give back to the",
    "start": "2934480",
    "end": "2940599"
  },
  {
    "text": "user we also do archive validation so what we wanted to know is if the archive",
    "start": "2940799",
    "end": "2946440"
  },
  {
    "text": "was corrupted and if it was uh corrupted uh Beyond recovering so uh this is a pretty",
    "start": "2946440",
    "end": "2953720"
  },
  {
    "text": "simple process in which we determine if the damage is beyond any any kind of",
    "start": "2953720",
    "end": "2959400"
  },
  {
    "text": "useful data recovery and the output you get is either yes the archive is valid",
    "start": "2959400",
    "end": "2965079"
  },
  {
    "text": "no it's not valid but yes you can fix it or the archive is so broken that there's",
    "start": "2965079",
    "end": "2971799"
  },
  {
    "text": "no use of doing anything with this file now we also did of course uh search",
    "start": "2971799",
    "end": "2977599"
  },
  {
    "text": "for tonography content and we did this generically so the idea behind it is to",
    "start": "2977599",
    "end": "2983920"
  },
  {
    "text": "generically support any kind of sto uh implementation done to the archive and",
    "start": "2983920",
    "end": "2989119"
  },
  {
    "text": "uh we do this uh by basically mapping out the file and uh seeing which parts of the archive are attributed to the",
    "start": "2989119",
    "end": "2995680"
  },
  {
    "text": "pack content if there's anything between the pack content uh then we report that",
    "start": "2995680",
    "end": "3001079"
  },
  {
    "text": "and we check if that's a piece of the same archive or another archive and you you are able to recover that now why",
    "start": "3001079",
    "end": "3008920"
  },
  {
    "text": "this isn't as simple as just adding numbers of the packed files and see if",
    "start": "3008920",
    "end": "3013960"
  },
  {
    "text": "that matches the archive because that doesn't include headers if you were to add the value of the pack",
    "start": "3013960",
    "end": "3021480"
  },
  {
    "text": "file inside an archive and just add them all together and see if that matches the file size you would be still missing",
    "start": "3021480",
    "end": "3027160"
  },
  {
    "text": "quite a few bites that are attributed to the file header itself so by attributing all of the data and seeing what's",
    "start": "3027160",
    "end": "3033680"
  },
  {
    "text": "between that we are able to detect generically any kind of data injection",
    "start": "3033680",
    "end": "3038720"
  },
  {
    "text": "inside the archive itself and of course I failed to mention",
    "start": "3038720",
    "end": "3046079"
  },
  {
    "text": "is that uh unpacked size uh and compressed size don't really matter for",
    "start": "3046079",
    "end": "3051280"
  },
  {
    "text": "some archivers you can have that as a that's not a given information so you",
    "start": "3051280",
    "end": "3057520"
  },
  {
    "text": "can't really rely on that you have to check the data itself now of course if we have found",
    "start": "3057520",
    "end": "3062960"
  },
  {
    "text": "the corrupted uh content we are able to salvage most of",
    "start": "3062960",
    "end": "3068160"
  },
  {
    "text": "it now one of the most uh useful features of this",
    "start": "3068160",
    "end": "3073680"
  },
  {
    "text": "engine besides finding hidden data is pre-processing archives which protects",
    "start": "3073680",
    "end": "3078920"
  },
  {
    "text": "you from all sorts of exploits so if you have an SDK for let's",
    "start": "3078920",
    "end": "3084640"
  },
  {
    "text": "say WinRAR and you use NY engine front of it you are sure uh not to be exploited by something that's not",
    "start": "3084640",
    "end": "3090920"
  },
  {
    "text": "patched by the wender because we check uh the final name length and content because that that was most commonly used",
    "start": "3090920",
    "end": "3097480"
  },
  {
    "text": "to trigger exploits in the in the arch processors because if",
    "start": "3097480",
    "end": "3103599"
  },
  {
    "text": "you have a string that's longer than Max Pat on Windows um you would probably",
    "start": "3103599",
    "end": "3109280"
  },
  {
    "text": "override some buffer and have some sort of an exploit but recently that has been fixed in every every U Arch processor",
    "start": "3109280",
    "end": "3117200"
  },
  {
    "text": "except quick zip which had such an exploit few days ago now we look for suspicious",
    "start": "3117200",
    "end": "3123599"
  },
  {
    "text": "compression rate ratio uh so uh in order to check for archive bombs which are",
    "start": "3123599",
    "end": "3129920"
  },
  {
    "text": "nasty uh we check if the compression Rao matches the actual data so if you have",
    "start": "3129920",
    "end": "3136119"
  },
  {
    "text": "something that's compressed let's say one bite and it says that when it's decompressed it needs 4 GB of space",
    "start": "3136119",
    "end": "3142319"
  },
  {
    "text": "that's of course a bogus information so we check for this kind of attack taxs because we we found that some uh Arch",
    "start": "3142319",
    "end": "3150359"
  },
  {
    "text": "processes would try to allocate all this data and since they were were unable to",
    "start": "3150359",
    "end": "3155480"
  },
  {
    "text": "that would either slow down the machine or just break",
    "start": "3155480",
    "end": "3160519"
  },
  {
    "text": "entirely now we check for the extract algorithm requirements now this doesn't",
    "start": "3160680",
    "end": "3165799"
  },
  {
    "text": "need continuous updates from from our side it's just something that",
    "start": "3165799",
    "end": "3171319"
  },
  {
    "text": "generically detects if if a piece of information is valid or not so if if for",
    "start": "3171319",
    "end": "3176559"
  },
  {
    "text": "example for wind RAR when we said the version 25 is needed to extract this particular file we generically detect",
    "start": "3176559",
    "end": "3182680"
  },
  {
    "text": "that as a bogus information so we don't really need to update that and say the latest version is that everything beyond",
    "start": "3182680",
    "end": "3188160"
  },
  {
    "text": "that is a bogus info we found that uh some checks and",
    "start": "3188160",
    "end": "3195000"
  },
  {
    "text": "tempering is possible which prevents some software when there from decompressing the archive uh if we talk",
    "start": "3195000",
    "end": "3200640"
  },
  {
    "text": "about zip it has a central directory record and a local one and if that data",
    "start": "3200640",
    "end": "3205760"
  },
  {
    "text": "doesn't match and something is off and the way this works is that some uh vendors use the central directory",
    "start": "3205760",
    "end": "3212559"
  },
  {
    "text": "information to De compress data and some local so uh you can have an archive",
    "start": "3212559",
    "end": "3218200"
  },
  {
    "text": "which is which was able to which is able to which is U extractable by some uh",
    "start": "3218200",
    "end": "3224119"
  },
  {
    "text": "programs but not by others because they're using different points of",
    "start": "3224119",
    "end": "3229520"
  },
  {
    "text": "reference now of course there's some stuff you can do to let's say the",
    "start": "3229520",
    "end": "3234960"
  },
  {
    "text": "archive uh split to let's say 20 volumes and when it doesn't we also check for",
    "start": "3234960",
    "end": "3241839"
  },
  {
    "text": "that we check for and this is interesting file entry duplication because nowhere in the specs it says you",
    "start": "3241839",
    "end": "3247880"
  },
  {
    "text": "cannot have two files with the same name and extension in the archive yes the",
    "start": "3247880",
    "end": "3252960"
  },
  {
    "text": "archive programs will not uh enable you to do that but nothing stops you from creating such an archive so if you have",
    "start": "3252960",
    "end": "3259480"
  },
  {
    "text": "a tool that is basically command line and you set it to I will overwrite any file I found uh so F first file uh",
    "start": "3259480",
    "end": "3267119"
  },
  {
    "text": "will be overwritten by the second one which is duplicated and we do all sorts of header",
    "start": "3267119",
    "end": "3274440"
  },
  {
    "text": "checks uh just to make sure that everything is is according to spec but not only according to spec what we have",
    "start": "3274440",
    "end": "3280040"
  },
  {
    "text": "seen that works in the wild as well now for every exploit or",
    "start": "3280040",
    "end": "3286960"
  },
  {
    "text": "vulnerability we find we provide detailed description with the uh link to",
    "start": "3286960",
    "end": "3292079"
  },
  {
    "text": "our advisory which you can read and uh see how the exploit works",
    "start": "3292079",
    "end": "3297480"
  },
  {
    "text": "now uh we've come to the demo of our engine uh we will test the next engine",
    "start": "3297480",
    "end": "3303319"
  },
  {
    "text": "on some of our vsas and uh we will test this on sto implementation and we will",
    "start": "3303319",
    "end": "3310720"
  },
  {
    "text": "show how to recover data so if you cannot see this but you have a laptop in front of you you can go to youtube.com/",
    "start": "3310720",
    "end": "3317400"
  },
  {
    "text": "reversinglabs and see this uh video better",
    "start": "3317400",
    "end": "3323599"
  },
  {
    "text": "so uh first thing we're going to do is we're going to use couple of files to",
    "start": "3335599",
    "end": "3340799"
  },
  {
    "text": "create a zip archive",
    "start": "3340799",
    "end": "3345960"
  },
  {
    "text": "so let's do it like this we're going to compress our my good friend here to a",
    "start": "3345960",
    "end": "3351440"
  },
  {
    "text": "zip archive it doesn't matter which processor processor you use",
    "start": "3351440",
    "end": "3357559"
  },
  {
    "text": "let's say this should work fine and there we have a zip archive that only",
    "start": "3357559",
    "end": "3362680"
  },
  {
    "text": "contains that particular image now uh if we use steganography tools we use we",
    "start": "3362680",
    "end": "3369599"
  },
  {
    "text": "talked about earlier so one of them which seems to work best",
    "start": "3369599",
    "end": "3375240"
  },
  {
    "text": "is Zip zipits technography by Karina John so if we were to open such a file",
    "start": "3375240",
    "end": "3381480"
  },
  {
    "text": "which we just created",
    "start": "3381480",
    "end": "3385400"
  },
  {
    "text": "there we opened it and it only has one file that's my good friend and we will",
    "start": "3401760",
    "end": "3407720"
  },
  {
    "text": "uh add couple more files so let's add Nick's documentation and let's just add",
    "start": "3407720",
    "end": "3413119"
  },
  {
    "text": "it as a hidden file and let's add another file which is let's say the smallware which",
    "start": "3413119",
    "end": "3420240"
  },
  {
    "text": "is a configure sample and by Saving",
    "start": "3420240",
    "end": "3425480"
  },
  {
    "text": "changes we have successfully created an archive which contains hidden content we can valif validate this just by opening",
    "start": "3429880",
    "end": "3436839"
  },
  {
    "text": "an archive and see tell my good friend there and then we can open the same archive with the program again to see if",
    "start": "3436839",
    "end": "3444480"
  },
  {
    "text": "it's able to reverse the process",
    "start": "3444480",
    "end": "3448160"
  },
  {
    "text": "so we just open sto and as we've seen there's a visible",
    "start": "3450160",
    "end": "3457359"
  },
  {
    "text": "file called Onkey GP uh JPEG and two other hidden files",
    "start": "3457359",
    "end": "3463400"
  },
  {
    "text": "inside an archive I'm going to show you how that looks like with the hex",
    "start": "3463400",
    "end": "3469440"
  },
  {
    "text": "editor so the donkey itself is visible but everything else isn't",
    "start": "3469520",
    "end": "3476599"
  },
  {
    "text": "so if you look at the end it only has one particular entry it's dony but if we",
    "start": "3480000",
    "end": "3485559"
  },
  {
    "text": "go uh in reverse and see this all data and just search from beginning for a PK",
    "start": "3485559",
    "end": "3492760"
  },
  {
    "text": "signature there's one this fake this",
    "start": "3492760",
    "end": "3499000"
  },
  {
    "text": "fake okay I think we found it yeah and as we seen there's another local header",
    "start": "3504880",
    "end": "3511559"
  },
  {
    "text": "which called contains mal. bin and that particular data is stored",
    "start": "3511559",
    "end": "3517920"
  },
  {
    "text": "just behind the first compressed file which is donkey and uh the central directory so it's all",
    "start": "3517920",
    "end": "3524720"
  },
  {
    "text": "injected and uh let's see how this stof file is uh processed with our NYX engine",
    "start": "3524720",
    "end": "3535400"
  },
  {
    "text": "so it has a couple of parameters first we want to scan the archive itself to see what's in it and as we see there's a",
    "start": "3548839",
    "end": "3555079"
  },
  {
    "text": "lot of data so what we found is we only have one reported file so total number",
    "start": "3555079",
    "end": "3560839"
  },
  {
    "text": "of files is one that's donkey. zip but we detected some vulnerabilities that's we Ed the possible attack due to",
    "start": "3560839",
    "end": "3567400"
  },
  {
    "text": "presence of non-standard header data that's um the extra field modification the possible vulnerability",
    "start": "3567400",
    "end": "3573920"
  },
  {
    "text": "due to different data in local and Central directory entries and by doing a detailed inspection for stenography",
    "start": "3573920",
    "end": "3580160"
  },
  {
    "text": "content we found the following we found uh detected file unreported by the",
    "start": "3580160",
    "end": "3585359"
  },
  {
    "text": "archive header it starts at that particular offset we can go there in the accelator and see how it looks like",
    "start": "3585359",
    "end": "3594400"
  },
  {
    "text": "and there it is that the head for our document and it says size of the file",
    "start": "3601599",
    "end": "3607200"
  },
  {
    "text": "found and the next one starts at we show that we don't really need to",
    "start": "3607200",
    "end": "3613760"
  },
  {
    "text": "go there anyway so uh the question is once we know it's there what do we do with it now what we do is we do an",
    "start": "3613760",
    "end": "3622400"
  },
  {
    "text": "interactive scan of the archive itself so so we interactively scan stego",
    "start": "3622400",
    "end": "3628720"
  },
  {
    "text": "and it says okay I found the first file do you want to recover it we say yes what do you want to recover it to let's",
    "start": "3628720",
    "end": "3634960"
  },
  {
    "text": "say recover 1.zip find another file they want to recover",
    "start": "3634960",
    "end": "3641720"
  },
  {
    "text": "that yes cover two do",
    "start": "3641720",
    "end": "3647240"
  },
  {
    "text": "zip and the program has finished so let's see that particular file so first",
    "start": "3647240",
    "end": "3652359"
  },
  {
    "text": "one recovered we are are unable at the moment to recover the file name so we",
    "start": "3652359",
    "end": "3658960"
  },
  {
    "text": "use a generic one in case the file name is off fiscated or something like that but the data itself is valid and if we",
    "start": "3658960",
    "end": "3665559"
  },
  {
    "text": "open that we see that this particular file which is a dog file we can open it it's a valid zip file so this thing can",
    "start": "3665559",
    "end": "3672319"
  },
  {
    "text": "be just renamed to the zip archive because that is what it is it's a zip inside a",
    "start": "3672319",
    "end": "3679520"
  },
  {
    "text": "zip can extract that data and see it later of course and for the second one",
    "start": "3679520",
    "end": "3686359"
  },
  {
    "text": "uh if we just view it we see the MZ signature which is default for",
    "start": "3686359",
    "end": "3692200"
  },
  {
    "text": "applications and this is a configure sample so we're not going to extract this onto our disk but as we can see we",
    "start": "3692200",
    "end": "3697559"
  },
  {
    "text": "can recover all",
    "start": "3697559",
    "end": "3700480"
  },
  {
    "text": "data so we can try this uh engine on any of the advisories we gave and it's going",
    "start": "3704839",
    "end": "3711240"
  },
  {
    "text": "to report all the information about the vulnerabilities we just disclosed so let's try this 11 so just scan the",
    "start": "3711240",
    "end": "3721400"
  },
  {
    "text": "file 11 and it says possible stenography detected as a clear data clear Text data",
    "start": "3721720",
    "end": "3729279"
  },
  {
    "text": "and it gives you an offset and the size of the data detected so it's kind of a",
    "start": "3729279",
    "end": "3735039"
  },
  {
    "text": "fuzzy area where stego ends and where vulnerability begins because if it's just stego and it's affecting some",
    "start": "3735039",
    "end": "3741599"
  },
  {
    "text": "software security vendors it's a fuzzy area you can't really declare it as a ability if it's uh in accord to the",
    "start": "3741599",
    "end": "3749599"
  },
  {
    "text": "documentation so we were kind of struggling with some just to um file them as right thing but we",
    "start": "3749599",
    "end": "3757839"
  },
  {
    "text": "are able to detect both vulnerabilities tonography and Corruptions with our",
    "start": "3757839",
    "end": "3763559"
  },
  {
    "text": "Tool uh so uh what's important is that we have embedded not only this 15",
    "start": "3763559",
    "end": "3769480"
  },
  {
    "text": "vulnerabilities we found we bended uh 30 more we found in the process of coding this tool however there's no description",
    "start": "3769480",
    "end": "3776480"
  },
  {
    "text": "for that because we haven't really disclosed them yet you're just going to skip over that content and play like the",
    "start": "3776480",
    "end": "3781760"
  },
  {
    "text": "archive is valid uh once we disclose this and this is going to be this or the following month uh then the tools going",
    "start": "3781760",
    "end": "3788160"
  },
  {
    "text": "to get updated and you will see what the vulnerabilities were but it's a process it's uh 30 30 new vulnerabilities and uh",
    "start": "3788160",
    "end": "3797760"
  },
  {
    "text": "since uh the last uh 15 were patched and uh some of the vendors are still rolling",
    "start": "3797760",
    "end": "3803240"
  },
  {
    "text": "out patches we want to make sure that we have 30 new and not something that was a residue from the old ones so if it was",
    "start": "3803240",
    "end": "3810520"
  },
  {
    "text": "patched it's no good uh what we found is that we were doing testing in",
    "start": "3810520",
    "end": "3816000"
  },
  {
    "text": "association with varle so we were using their scanners to do that and what we found that this wasn't really a good",
    "start": "3816000",
    "end": "3822400"
  },
  {
    "text": "idea because uh some of the security vendors have command line tools there that haven't had their engines updated",
    "start": "3822400",
    "end": "3828400"
  },
  {
    "text": "in a while so what we did now is have our results from virus total and just",
    "start": "3828400",
    "end": "3834359"
  },
  {
    "text": "manually verify that if that's going to affect your desktop solution so the data",
    "start": "3834359",
    "end": "3839839"
  },
  {
    "text": "uh in the vulnerability advisories we get now is much more",
    "start": "3839839",
    "end": "3844960"
  },
  {
    "text": "accurate and that's it for the next engine that's it for our presentation uh we come to the question",
    "start": "3844960",
    "end": "3851839"
  },
  {
    "text": "part so any",
    "start": "3851839",
    "end": "3855039"
  },
  {
    "text": "questions come on guys there's got to be one question how come you're not able to",
    "start": "3858279",
    "end": "3865000"
  },
  {
    "text": "recover the fin was clear in there yeah uh we didn't add that part yet it was short coding period",
    "start": "3865000",
    "end": "3872960"
  },
  {
    "text": "and we only wanted to make the archive valid so you can recover the data file name you can get that from the uh from",
    "start": "3872960",
    "end": "3879400"
  },
  {
    "text": "the archive itself if you want to but we will add that feature in a couple of weeks",
    "start": "3879400",
    "end": "3885480"
  },
  {
    "text": "sure anything else yeah what amount of data",
    "start": "3885480",
    "end": "3890400"
  },
  {
    "text": "can any amount of data if I was to hide a particular file in it I would",
    "start": "3892520",
    "end": "3898079"
  },
  {
    "text": "definitely change the uncompressed size of the file before that and so it all adds up and they you would have",
    "start": "3898079",
    "end": "3903839"
  },
  {
    "text": "absolutely no idea that there's some hidden content in it for cab it even works better because",
    "start": "3903839",
    "end": "3912520"
  },
  {
    "text": "cab uses a single stream to compress all data and uh if you just change the numbers of the uncompressed size it",
    "start": "3912520",
    "end": "3919039"
  },
  {
    "text": "really has no effect at all anything else uh engine tool uh when I'm",
    "start": "3919039",
    "end": "3928799"
  },
  {
    "text": "searching for Data onoken Drive some kind of doesn't matter if it is a drive or",
    "start": "3928799",
    "end": "3935720"
  },
  {
    "text": "device or file this the way how it finds the file similar to what engine uses uh",
    "start": "3935720",
    "end": "3941920"
  },
  {
    "text": "the NX engine opens the file you provided to so uh if you provide a zip archive it identifies that as a zip",
    "start": "3941920",
    "end": "3947640"
  },
  {
    "text": "archive if it is really a zip it doesn't matter which extension it is we do data checks to make sure and then just",
    "start": "3947640",
    "end": "3953960"
  },
  {
    "text": "inspect that content but does it expect Z archive Z archive or as a binary",
    "start": "3953960",
    "end": "3960000"
  },
  {
    "text": "search raow binary searches for the signature and we identify that as either zip Rod gzip or cab which is supported",
    "start": "3960000",
    "end": "3968480"
  },
  {
    "text": "at the moment okay anything else what's if",
    "start": "3968480",
    "end": "3975000"
  },
  {
    "text": "I password protect do this work yes yes you get a response which says this",
    "start": "3975000",
    "end": "3982720"
  },
  {
    "text": "particular file is protected by a password you can see that in in the console um that that's an information we",
    "start": "3982720",
    "end": "3988920"
  },
  {
    "text": "provide with the data about the file because this is an SDK you can embed this anywhere that was the basic idea",
    "start": "3988920",
    "end": "3995200"
  },
  {
    "text": "but it doesn't decrypt files or anything in the process of recovery you really don't need to do that you use another",
    "start": "3995200",
    "end": "4000920"
  },
  {
    "text": "tool to break the passport so if I want to analyze my files if there are some hiden dat in it I need to to or to un uh",
    "start": "4000920",
    "end": "4010039"
  },
  {
    "text": "first you do the recovery part and then it creates totally new archive with a valid header it still stores uh the",
    "start": "4010039",
    "end": "4016039"
  },
  {
    "text": "information about the passport so you are able to use a brute forcer to recover the passwort itself on the newly",
    "start": "4016039",
    "end": "4022160"
  },
  {
    "text": "created but valid archive even if it's if the original one is password yeah it",
    "start": "4022160",
    "end": "4028160"
  },
  {
    "text": "depends on how the stego is implemented because um this particular program we we showed um it embeds new data but still a",
    "start": "4028160",
    "end": "4036079"
  },
  {
    "text": "zip file inside it so when we recover that that's another zip file it doesn't",
    "start": "4036079",
    "end": "4041319"
  },
  {
    "text": "matter but some tools just do injected data they don't compress it they just",
    "start": "4041319",
    "end": "4046920"
  },
  {
    "text": "encrypt it with a random password and you will get a detection from our tool and it's going to say okay there's some",
    "start": "4046920",
    "end": "4052720"
  },
  {
    "text": "data from here to here we have no idea what it is go check yourself and when you do you can either see if that's J",
    "start": "4052720",
    "end": "4059559"
  },
  {
    "text": "junk data plain text or something that looks encrypted and then you can apply your cryptography tools to work with",
    "start": "4059559",
    "end": "4065839"
  },
  {
    "text": "that kind of stuff but the main issue we had is just finding the data because",
    "start": "4065839",
    "end": "4071799"
  },
  {
    "text": "this is all novel and we have absolutely no idea idea how prevalent this is in",
    "start": "4071799",
    "end": "4077240"
  },
  {
    "text": "the wild because nobody really checked yes I'm just trying to get this",
    "start": "4077240",
    "end": "4084640"
  },
  {
    "text": "the whole IDE is let's say someone has your okay then hidden content no matter",
    "start": "4084640",
    "end": "4094960"
  },
  {
    "text": "what",
    "start": "4095759",
    "end": "4098758"
  },
  {
    "text": "IDE uh as I said it works generically so it doesn't matter which which kind of sto tool you use to hide files it will",
    "start": "4101199",
    "end": "4107838"
  },
  {
    "text": "still be able to detect hidden data it won't be able to tell you how it was hidden but it will tell you from here to",
    "start": "4107839",
    "end": "4114400"
  },
  {
    "text": "here there's hidden data and you use a software engineer to check for that data and see what it",
    "start": "4114400",
    "end": "4120080"
  },
  {
    "text": "is and I guess your question was the the you know what do security tools do with it right uh and I mean they would",
    "start": "4120080",
    "end": "4128000"
  },
  {
    "text": "they're then affected by the various vulnerabilities because they're reading the file as a file format trying to figure out the versions and uh you know",
    "start": "4128000",
    "end": "4135480"
  },
  {
    "text": "May detect it or may not depending on how you do the malformation or stego implementation so like for example these",
    "start": "4135480",
    "end": "4142359"
  },
  {
    "text": "from these vulnerabilities and for the for our ftk product we basically made",
    "start": "4142359",
    "end": "4147600"
  },
  {
    "text": "sure that we don't fall sort of as we open up each of the archives we look at it and we're like we don't sort of fall",
    "start": "4147600",
    "end": "4153719"
  },
  {
    "text": "prey to some of those types of things so we'll explore into and we don't say oh this has got this going on it just sort of breaks into the file without sort of",
    "start": "4153719",
    "end": "4161040"
  },
  {
    "text": "being like Oh there's a header that's messed up here oh there's something appended Let's ignore it it just breaks into it so instead of it being a",
    "start": "4161040",
    "end": "4167920"
  },
  {
    "text": "detection mechanism it's more of just get into the data my understanding was this is",
    "start": "4167920",
    "end": "4174480"
  },
  {
    "text": "actually discover any kind of data so we are not worried about any kind of stenography implication because we can",
    "start": "4178679",
    "end": "4184440"
  },
  {
    "text": "generically detect anything so that's what we try to do and from the software",
    "start": "4184440",
    "end": "4189719"
  },
  {
    "text": "security standpoint it really doesn't matter what kind of data is hidden because if the user doesn't know about it it he cannot be infected of",
    "start": "4189719",
    "end": "4197800"
  },
  {
    "text": "course yes is to hide dats yeah of course this but when when",
    "start": "4197800",
    "end": "4205560"
  },
  {
    "text": "youate amount of",
    "start": "4205560",
    "end": "4208960"
  },
  {
    "text": "dat yes it takes account every bite in the file so if if you have one bite that's not accounted for by the archive",
    "start": "4211480",
    "end": "4218520"
  },
  {
    "text": "documentations or the arch file format it's detected and it says okay from here to here there's a bite we don't really",
    "start": "4218520",
    "end": "4224400"
  },
  {
    "text": "we are not sure if it's a part of the file you have no idea you have to check yourself but we've did did a lot of",
    "start": "4224400",
    "end": "4232000"
  },
  {
    "text": "testing and uh We've uh complied with every documentation there is about every",
    "start": "4232000",
    "end": "4238000"
  },
  {
    "text": "format so we are sure that things you are detecting won't be the part of the",
    "start": "4238000",
    "end": "4243159"
  },
  {
    "text": "archive itself it will be something extra",
    "start": "4243159",
    "end": "4247400"
  },
  {
    "text": "injected questions",
    "start": "4249440",
    "end": "4253440"
  },
  {
    "text": "so any more questions guys okay thank you thank you thank you",
    "start": "4258960",
    "end": "4267360"
  }
]