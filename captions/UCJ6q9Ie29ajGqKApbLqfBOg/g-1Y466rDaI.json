[
  {
    "start": "0",
    "end": "166000"
  },
  {
    "text": "welcome to breaking through enough to another side by passing firmware security boundaries from embedded",
    "start": "0",
    "end": "6299"
  },
  {
    "text": "computers controllers in Lagoon thi was Alexandra Gaza and Alex Mastro before we",
    "start": "6299",
    "end": "14400"
  },
  {
    "text": "begin a few brief notes stop by the business hall located in Mandalay Bay",
    "start": "14400",
    "end": "19609"
  },
  {
    "text": "Oceanside and shoreline ballrooms on level 2 the blackhat Arsenal is in the",
    "start": "19609",
    "end": "25230"
  },
  {
    "text": "business hall on level 2 join us for mimosas at 11:50 and ice cream social at",
    "start": "25230",
    "end": "31610"
  },
  {
    "text": "15:20 both in the business hall lunch is in Bayside a B from 1:00 to 2:30",
    "start": "31610",
    "end": "38430"
  },
  {
    "text": "don't forget the merchandise store on level 2 in session recordings from s ok they have a desk on every level thank",
    "start": "38430",
    "end": "46590"
  },
  {
    "text": "you for putting your phone on vibrate it makes it easier for the rest of us to ignore the ringing while you wait for",
    "start": "46590",
    "end": "52170"
  },
  {
    "text": "your voicemail to pick up please use the microphones in the aisle for any questions following the talk and with",
    "start": "52170",
    "end": "58469"
  },
  {
    "text": "that let us welcome our speakers good",
    "start": "58469",
    "end": "63539"
  },
  {
    "text": "morning everyone and thanks for coming this early morning slot especially after",
    "start": "63539",
    "end": "69000"
  },
  {
    "text": "all these crazy parties blackhat yesterday and bypassing former security",
    "start": "69000",
    "end": "74790"
  },
  {
    "text": "boundaries from embedded controller it's our topic for today and I'm Alex Madras",
    "start": "74790",
    "end": "80040"
  },
  {
    "text": "of embedded security lead from from Nvidia and Alexander Gazette from Airbus",
    "start": "80040",
    "end": "87420"
  },
  {
    "text": "cyber security researcher and great reverse engineer so first of all we want",
    "start": "87420",
    "end": "94590"
  },
  {
    "text": "to make small disclaimer because everything which we discover in this",
    "start": "94590",
    "end": "100950"
  },
  {
    "text": "presentation we did all the reverse engineering techniques and methodologies so we can be bronch in some points which",
    "start": "100950",
    "end": "108990"
  },
  {
    "text": "we made in this presentation but maybe not so and we literally spend the five",
    "start": "108990",
    "end": "114240"
  },
  {
    "text": "months of reverse engineering biased guard technology and it's a lot of information about wires guard which has",
    "start": "114240",
    "end": "122159"
  },
  {
    "text": "never been in public before so we have some introduction part about the hardware security part hardware security",
    "start": "122159",
    "end": "128340"
  },
  {
    "text": "boundaries problems what does it mean where the limitations are and how the attack surface looks like",
    "start": "128340",
    "end": "134290"
  },
  {
    "text": "then we will make a deep dive to embedded controller and create some bridges to the buyers guard technology",
    "start": "134290",
    "end": "140469"
  },
  {
    "text": "and of course it will be very a lot of details about the buyers guard itself so",
    "start": "140469",
    "end": "147069"
  },
  {
    "text": "let's start with the security hardware boundaries so how many third-party",
    "start": "147069",
    "end": "153340"
  },
  {
    "text": "components in your laptops nowadays you have its embedded controller its keyboard controller its fingerprint its",
    "start": "153340",
    "end": "161829"
  },
  {
    "text": "touchpad even and all these farmers have their own boundaries so it's a lot of",
    "start": "161829",
    "end": "169030"
  },
  {
    "start": "166000",
    "end": "166000"
  },
  {
    "text": "limitations actually because obvious furs have their own update process",
    "start": "169030",
    "end": "175019"
  },
  {
    "text": "identification and sometimes this components can be out of trade model for",
    "start": "175019",
    "end": "183510"
  },
  {
    "text": "mothers but have a path for attack some other hardware component so very",
    "start": "183510",
    "end": "192849"
  },
  {
    "text": "interesting part many of these companies which we mentioned on the previous slide connected to the buyers and of course",
    "start": "192849",
    "end": "200199"
  },
  {
    "text": "they out of the trade scope on of the buyers itself which is create some interesting room for us of thinking and",
    "start": "200199",
    "end": "208560"
  },
  {
    "text": "security boundaries it's not a summary of all the boundaries on your system basically it's separated from each other",
    "start": "208560",
    "end": "215709"
  },
  {
    "text": "and of course if you can break as example GPM and TPM communicating very",
    "start": "215709",
    "end": "221319"
  },
  {
    "text": "closely with a bias for a lot of security features then you can basically break the security features from the TPM",
    "start": "221319",
    "end": "229000"
  },
  {
    "text": "and for the long time TPM been out of trade modeling for the bus itself and",
    "start": "229000",
    "end": "235180"
  },
  {
    "text": "Jeremy boon actually demonstrated interposer from the last year research",
    "start": "235180",
    "end": "241599"
  },
  {
    "text": "and it was very interesting because he exactly did like that he tried to attack the bias from the TPM itself by",
    "start": "241599",
    "end": "248889"
  },
  {
    "text": "interposing the messages from wires to the TPM and fro TPM to the BIOS and just",
    "start": "248889",
    "end": "255159"
  },
  {
    "text": "manipulating with trauma Watson did very similar work but just physically so",
    "start": "255159",
    "end": "262028"
  },
  {
    "text": "during to the CPM itself very good job and most",
    "start": "262029",
    "end": "269400"
  },
  {
    "text": "reticent one it's a race condition on spy flash read/write which is bypassing",
    "start": "269400",
    "end": "275960"
  },
  {
    "text": "good guard technology and it's also by trauma Hudson and Peter junks which is",
    "start": "275960",
    "end": "283340"
  },
  {
    "text": "this research you've been presented on Hawkins blog this year in the Amsterdam a lot of information already on public",
    "start": "283340",
    "end": "290880"
  },
  {
    "text": "but main message from this research authenticated once it's not means",
    "start": "290880",
    "end": "296660"
  },
  {
    "text": "trusted forever one more good example alexandra gazette and geoffrey journey",
    "start": "296660",
    "end": "304260"
  },
  {
    "text": "did a research on embedded controller o",
    "start": "304260",
    "end": "309440"
  },
  {
    "text": "on BMC which is based management controller it's a different one but also interesting so basically but the",
    "start": "309470",
    "end": "317520"
  },
  {
    "text": "controller responsible for a lot of different flows on servers and it's also",
    "start": "317520",
    "end": "323100"
  },
  {
    "text": "responsible for updating multiple servers include embedded controller management engine and bios itself so",
    "start": "323100",
    "end": "330300"
  },
  {
    "text": "it's direct path to the right to the spy flash so basically if embedded controller is broken it's break or",
    "start": "330300",
    "end": "336570"
  },
  {
    "text": "identification for the bias it's break all identification for the embedded controller update process and the break",
    "start": "336570",
    "end": "344790"
  },
  {
    "text": "security boundaries why we start working",
    "start": "344790",
    "end": "349980"
  },
  {
    "text": "on embedded controller our point of research been on the beginning just go deeper on the bios of our technology but",
    "start": "349980",
    "end": "357540"
  },
  {
    "text": "we found a lot of interesting relations between embedded controller bios guard and the bias so and especially embedded",
    "start": "357540",
    "end": "367230"
  },
  {
    "text": "controller involve involved in authentification process between embedded controller and the bias before",
    "start": "367230",
    "end": "373169"
  },
  {
    "text": "some flow started but we all be geeking this a bit later ok so when we needed to",
    "start": "373169",
    "end": "380580"
  },
  {
    "text": "start distal immunity to discover a  what was actually running on the ability controller we needed to dig into",
    "start": "380580",
    "end": "385890"
  },
  {
    "text": "it so just to give you a quick evaluate already in a midi controller it's a very",
    "start": "385890",
    "end": "391410"
  },
  {
    "text": "small micro controller it will be responsible for many things for you sign on here we will not see it in a",
    "start": "391410",
    "end": "397439"
  },
  {
    "text": "but it was responsible for power management ammerman thermal management also responsible for keyboard the",
    "start": "397439",
    "end": "404309"
  },
  {
    "text": "keyboard press management in the past it has also been involved in many security",
    "start": "404309",
    "end": "409379"
  },
  {
    "text": "feature for example it has been used for the implementation of BIOS supervisor pass throughout the reversion and",
    "start": "409379",
    "end": "415169"
  },
  {
    "text": "variation some code we are inside the embedded controller like like Alex said",
    "start": "415169",
    "end": "420989"
  },
  {
    "text": "we found that it is also responsible for implementing some specific part of the BIOS gap implementation and that's why",
    "start": "420989",
    "end": "426179"
  },
  {
    "text": "we wanted to dig into it and also some things is very important from an ethical point of view is that even if your main",
    "start": "426179",
    "end": "432599"
  },
  {
    "text": "processor your main CPU is is not running the MIDI controller is always running as soon as the power on the",
    "start": "432599",
    "end": "439139"
  },
  {
    "text": "motherboard the elite controller will be ready we have been mostly working on Lenovo",
    "start": "439139",
    "end": "445919"
  },
  {
    "text": "ThinkPad laptops for all this forces laptops the cheap use comes from",
    "start": "445919",
    "end": "451829"
  },
  {
    "text": "microchips make 16 something family the ROM size is a 180 K it's and some",
    "start": "451829",
    "end": "458339"
  },
  {
    "text": "unusual processor which is a compact quite often we find it inside a MIDI",
    "start": "458339",
    "end": "463949"
  },
  {
    "text": "controller the controller can be seen as a collection of logical devices that is",
    "start": "463949",
    "end": "469110"
  },
  {
    "text": "you can think about it as services that are exposed by the embedded controller",
    "start": "469110",
    "end": "474539"
  },
  {
    "text": "the resource about controller services some communication channel with the operating systems for a CPI",
    "start": "474539",
    "end": "480809"
  },
  {
    "text": "a service that expose the internal flash of the embedded controller that's very important because that's where it's from",
    "start": "480809",
    "end": "486029"
  },
  {
    "text": "where is stored and that's something that could be very interesting to hide card or ID something again if you're an",
    "start": "486029",
    "end": "492329"
  },
  {
    "text": "attacker ok now if we place this tablet",
    "start": "492329",
    "end": "499679"
  },
  {
    "text": "controller on the system on chip you can see that it can communicate with the battery stress abuse sometimes it will",
    "start": "499679",
    "end": "505709"
  },
  {
    "text": "authenticate the batteries as that or just get its status it's rather it's not status some this kind of information on",
    "start": "505709",
    "end": "513508"
  },
  {
    "text": "the other side it is connected to the main processor through an LPC no pin code news with the main yes the main",
    "start": "513509",
    "end": "519689"
  },
  {
    "text": "processor and for example if your main processor wants to know the charge level of Shaba tree it will go through the Seger's information and sing like that",
    "start": "519689",
    "end": "528019"
  },
  {
    "text": "so we know there are links and communication between the main processor",
    "start": "528019",
    "end": "533940"
  },
  {
    "text": "mostly you fi bills and Zamalek material and we wanted to map all this communication channel all the endpoints",
    "start": "533940",
    "end": "541230"
  },
  {
    "text": "exposed by the embedded controller from the recomposition we know that logical devices can be exposed on the LPC views",
    "start": "541230",
    "end": "548970"
  },
  {
    "text": "from the EC the PC abuse is itself a radically vice logical device that you",
    "start": "548970",
    "end": "553980"
  },
  {
    "text": "can configure to expose other logical devices and if you want to do that you simply write into memory into special",
    "start": "553980",
    "end": "559710"
  },
  {
    "text": "configuration registers and you say ok I want to expose these logical devices at this address on the NPC booth so from",
    "start": "559710",
    "end": "567270"
  },
  {
    "start": "567000",
    "end": "567000"
  },
  {
    "text": "the as the methodology is quite straight forward on the EC from where we have been reversing a lot a MIDI controller you have small extract on the right we",
    "start": "567270",
    "end": "576240"
  },
  {
    "text": "have been reversing about the embellishment role of yam we're trying to find all the location in the code",
    "start": "576240",
    "end": "581310"
  },
  {
    "text": "where the MIDI controller configure this LPC bus to find all the endpoints it was",
    "start": "581310",
    "end": "586530"
  },
  {
    "text": "exposing on the other side on the UEFI bios side we've been looking for all the",
    "start": "586530",
    "end": "592110"
  },
  {
    "text": "communication with the EC mostly looking for a dedicated protocol from UDK to SDK",
    "start": "592110",
    "end": "597570"
  },
  {
    "text": "and also from specific modules provided by Lenovo name it was ECIL exe",
    "start": "597570",
    "end": "603300"
  },
  {
    "text": "and in CL OS mm which which are responsible for the communication with zc so once you do all that all that rock",
    "start": "603300",
    "end": "611220"
  },
  {
    "text": "you are able to precisely map or the logical devices that are exposed to us and all you can communicate with wisdom",
    "start": "611220",
    "end": "617460"
  },
  {
    "text": "for example if you want to communicate with logical device number two which is a CPI EC zero communication channel 0",
    "start": "617460",
    "end": "624270"
  },
  {
    "text": "with a CPI you will simply talk on IO port 62 and 66 basically and we will",
    "start": "624270",
    "end": "631620"
  },
  {
    "text": "speak more about this because this communication channel can be used to update the embedded controller now let's",
    "start": "631620",
    "end": "639990"
  },
  {
    "text": "switch on some attacks on embedded controller especially on the update process on Lenovo ThinkPad but before we",
    "start": "639990",
    "end": "649980"
  },
  {
    "text": "started digging in our own research we want to highlight a previous research Alex hundred dig in embedded controller",
    "start": "649980",
    "end": "656460"
  },
  {
    "text": "in 2011 from Hitachi and made presentation on every cone where he",
    "start": "656460",
    "end": "662070"
  },
  {
    "text": "exposing some attacks on SMI handlers the embedded controller and break the",
    "start": "662070",
    "end": "668070"
  },
  {
    "text": "keyboard controller to sew and make you Chapman and Hamish coloman did very interesting functional research on it",
    "start": "668070",
    "end": "674040"
  },
  {
    "text": "and provided us a lot of pointers so how you seem firmware update process in",
    "start": "674040",
    "end": "680970"
  },
  {
    "start": "676000",
    "end": "676000"
  },
  {
    "text": "general most of the vendors like gigabyte iso stacks they don't have any identification for embedded controller",
    "start": "680970",
    "end": "686460"
  },
  {
    "text": "farmers's means they just basically allow you from the cost send the sequence of the Commons to the embedded",
    "start": "686460",
    "end": "693570"
  },
  {
    "text": "controller to start start update process so it's just like design issue but they",
    "start": "693570",
    "end": "699360"
  },
  {
    "text": "just don't out indicate the firmware it was like very very surprised about that and they even don't lock the host to",
    "start": "699360",
    "end": "706470"
  },
  {
    "text": "write to this to initiate communication with ECB and actually we was thinking",
    "start": "706470",
    "end": "715020"
  },
  {
    "text": "okay it's open the door for some interesting malicious activities and the",
    "start": "715020",
    "end": "720780"
  },
  {
    "text": "ways to gain persistence actually huge first of all multiple vendors for the",
    "start": "720780",
    "end": "725970"
  },
  {
    "text": "recovery process they didn't lock the GTECH on the board so basically of course it's not soldered but the pins",
    "start": "725970",
    "end": "731640"
  },
  {
    "text": "exist and easy to discover with jiggle-ator what kind of pin out its cuts and sometimes documentation also on",
    "start": "731640",
    "end": "738840"
  },
  {
    "text": "public or leaked many years for similar controllers and you see update tool from",
    "start": "738840",
    "end": "745590"
  },
  {
    "text": "OS usually all everything to communicate with embedded controller and recover all",
    "start": "745590",
    "end": "753000"
  },
  {
    "text": "the sequences of the commands if it's not other bias components involved in",
    "start": "753000",
    "end": "758850"
  },
  {
    "text": "this process so if the bias leaks drivers involved as only no finger pads",
    "start": "758850",
    "end": "764400"
  },
  {
    "text": "so it's also possible to basically attack Dixie driver or SMM driver and",
    "start": "764400",
    "end": "772470"
  },
  {
    "text": "make a second stage which is will be attack directly embedded controller and actually this specific attack",
    "start": "772470",
    "end": "779310"
  },
  {
    "text": "it's out of scope for trade model of embedded controller update process in many vendors so and even if we see image",
    "start": "779310",
    "end": "789810"
  },
  {
    "text": "have identification additional identification on the buyers side it's it's actually separated by design",
    "start": "789810",
    "end": "795930"
  },
  {
    "text": "because you authenticate and weather control your image then sex and sequence",
    "start": "795930",
    "end": "801170"
  },
  {
    "text": "of command for the update process let's raise some questions about possibilities",
    "start": "801170",
    "end": "806360"
  },
  {
    "start": "804000",
    "end": "804000"
  },
  {
    "text": "for the race condition which we will discuss later but what kind of impact in update process identification bypass can",
    "start": "806360",
    "end": "813500"
  },
  {
    "text": "be actually embedded controller it's very interesting place for be a",
    "start": "813500",
    "end": "819560"
  },
  {
    "text": "persistent storage to store some malicious a rootkit and this rootkit can",
    "start": "819560",
    "end": "824630"
  },
  {
    "text": "be signal something to the mine farmer known as bias and load additional",
    "start": "824630",
    "end": "830180"
  },
  {
    "text": "companions to there it's very interesting possibility and most of the teams who think about firmware security",
    "start": "830180",
    "end": "837980"
  },
  {
    "text": "and the biosecurity in the terms of forensics they you can spy that but don't think on a bedded controller as a",
    "start": "837980",
    "end": "844520"
  },
  {
    "text": "place for the persistence our target system for research it's been mainly",
    "start": "844520",
    "end": "851630"
  },
  {
    "text": "lenovo thinkpad we work on the gigabyte and also stack just briefly and it was not interesting",
    "start": "851630",
    "end": "856730"
  },
  {
    "text": "for embedded controller specifically because they just don't out an offical it and we think like ok let's take one",
    "start": "856730",
    "end": "864050"
  },
  {
    "text": "which is used in enterprise and Tapie 40 and P 50 was our main target so for P 50",
    "start": "864050",
    "end": "870770"
  },
  {
    "text": "it's newer chip from microchip 1653 and update tools which only initiate update",
    "start": "870770",
    "end": "881330"
  },
  {
    "text": "process for AC but bias actually have full responsibility for flashing so when",
    "start": "881330",
    "end": "886640"
  },
  {
    "text": "a Dixie driver it CC firmware update Dixie with this grid which is very",
    "start": "886640",
    "end": "892400"
  },
  {
    "start": "892000",
    "end": "892000"
  },
  {
    "text": "interesting place to look but first of all we was like ok how the update package for EC looks like we recover the",
    "start": "892400",
    "end": "898820"
  },
  {
    "text": "structure which is have obvious signature issue on the beginning but after that version file size image size",
    "start": "898820",
    "end": "905990"
  },
  {
    "text": "and which kind of algorithm involved for identification process so and next slide",
    "start": "905990",
    "end": "921530"
  },
  {
    "start": "916000",
    "end": "916000"
  },
  {
    "text": "actually we have Lenovo ThinkPad update process which is",
    "start": "921530",
    "end": "927220"
  },
  {
    "text": "starting from a prating system with the decay Phoenix framework and continue on it's a ma'am driver",
    "start": "927220",
    "end": "934880"
  },
  {
    "text": "which is basically make verification first and then the function responsible",
    "start": "934880",
    "end": "941540"
  },
  {
    "text": "for flesh and update to the embedded controller itself and we'll cover",
    "start": "941540",
    "end": "947000"
  },
  {
    "text": "interesting messages on on update to",
    "start": "947000",
    "end": "953420"
  },
  {
    "text": "from a parroting system level and these two actually have some comments this",
    "start": "953420",
    "end": "959000"
  },
  {
    "text": "system wise on AC firmware update is unsign it it's very interesting point",
    "start": "959000",
    "end": "965089"
  },
  {
    "text": "which is take us in the place where we start looking on TP forty and for us was",
    "start": "965089",
    "end": "972050"
  },
  {
    "text": "surprised GP forty doesn't have any identification its use the same almost the same dixie",
    "start": "972050",
    "end": "978230"
  },
  {
    "text": "driver but don't how to describe firmer itself it just basically take embedded",
    "start": "978230",
    "end": "983690"
  },
  {
    "text": "controller image from the operating system my apt own specific address and then after that Dixie driver read it",
    "start": "983690",
    "end": "991610"
  },
  {
    "text": "from this memory and flash at with this sequence of comments so interesting",
    "start": "991610",
    "end": "997130"
  },
  {
    "text": "right but what's the impact so we have many comments ok how you will be reuse",
    "start": "997130",
    "end": "1004899"
  },
  {
    "start": "999000",
    "end": "999000"
  },
  {
    "text": "the sequence of comments if you have a locked host or how basically it can be",
    "start": "1004899",
    "end": "1011050"
  },
  {
    "text": "used with active good guard and just for a Monday would guard is a technology which is armoring boot sequence",
    "start": "1011050",
    "end": "1018550"
  },
  {
    "text": "basically it's my additional root of trust and hardware for secure boot on your systems and if you want more",
    "start": "1018550",
    "end": "1025270"
  },
  {
    "text": "information here is a link but when interesting point is a boot guard doesn't cover all the Dixie for firmware",
    "start": "1025270",
    "end": "1033100"
  },
  {
    "text": "volume on the p40 and there is a driver which is we've been looking for and this",
    "start": "1033100",
    "end": "1039610"
  },
  {
    "text": "driver is has actually everything to flash embedded controller firmware and I",
    "start": "1039610",
    "end": "1046390"
  },
  {
    "text": "was thinking okay what if you just reuse this driver from you five shell and this",
    "start": "1046390",
    "end": "1052000"
  },
  {
    "text": "particular part was open additional possibilities for the supply chain attacks so but okay but what if we use",
    "start": "1052000",
    "end": "1061360"
  },
  {
    "text": "this driver and quite just one comment in before for basically avoid the identification",
    "start": "1061360",
    "end": "1067809"
  },
  {
    "text": "and take only the flash part for",
    "start": "1067809",
    "end": "1072970"
  },
  {
    "start": "1072000",
    "end": "1072000"
  },
  {
    "text": "embedded controller so let's try deeper",
    "start": "1072970",
    "end": "1078519"
  },
  {
    "text": "a bit how as a signature check on p40 hooks it's take update image weapon OS",
    "start": "1078519",
    "end": "1086980"
  },
  {
    "text": "update to basically update image map to specific address from ass then it's",
    "start": "1086980",
    "end": "1094870"
  },
  {
    "text": "validation for verifications image is correct and secure flash it's specific",
    "start": "1094870",
    "end": "1102279"
  },
  {
    "text": "public key in the capsule update in which with full firmware and includes the bias and it's basically mapped by",
    "start": "1102279",
    "end": "1110019"
  },
  {
    "text": "Dixie driver to the cop corporate specific runtime structure which is kind",
    "start": "1110019",
    "end": "1115210"
  },
  {
    "text": "of a list with structures objects inside the bias runtime so then the Dixie Kong",
    "start": "1115210",
    "end": "1123399"
  },
  {
    "text": "wait the res a verification is correct they use the signature from a modded controller and use this public key which",
    "start": "1123399",
    "end": "1131649"
  },
  {
    "text": "is basically secure flash public key if signature is correct they enable true to boolean variable",
    "start": "1131649",
    "end": "1140559"
  },
  {
    "text": "global boolean variable and if signature true then update process started for",
    "start": "1140559",
    "end": "1146649"
  },
  {
    "text": "flash and the new firmware to the chip so here is the compiled listing and I",
    "start": "1146649",
    "end": "1152019"
  },
  {
    "text": "will collect most interesting parts so basically we get to see image cache verify see image cache and it's two",
    "start": "1152019",
    "end": "1160870"
  },
  {
    "text": "separated false right so and just one on one boolean variable interesting so but",
    "start": "1160870",
    "end": "1167860"
  },
  {
    "text": "what if we separate verify and flash oops like it's kind of state machine",
    "start": "1167860",
    "end": "1175690"
  },
  {
    "text": "which is have possible race condition right so for me it looks like obvious",
    "start": "1175690",
    "end": "1186519"
  },
  {
    "text": "place for race condition but not that fast let's think about how we can attack",
    "start": "1186519",
    "end": "1192909"
  },
  {
    "text": "be 50 and be 50 actually have a stronger security boundaries",
    "start": "1192909",
    "end": "1198980"
  },
  {
    "text": "and especially food guard working correctly that means we don't we can't",
    "start": "1198980",
    "end": "1204919"
  },
  {
    "text": "without disabling the boot guard attack from the five shell the didn't use we",
    "start": "1204919",
    "end": "1211280"
  },
  {
    "text": "use the Dixie driver so let's try harder on P 50s oh ho slash access needs to be",
    "start": "1211280",
    "end": "1217429"
  },
  {
    "text": "enabled just a fall Lenovo maked host right and read from the cost locked and",
    "start": "1217429",
    "end": "1223970"
  },
  {
    "text": "for unlock comment it's used like just simple sequence so we need send this",
    "start": "1223970",
    "end": "1229429"
  },
  {
    "text": "sequence and with a static password which is shared before between wires",
    "start": "1229429",
    "end": "1234830"
  },
  {
    "text": "Dixie driver and DC and after that we unlock the possibility to write is right",
    "start": "1234830",
    "end": "1241309"
  },
  {
    "text": "and what if we just replace the sequence so because also we have a static",
    "start": "1241309",
    "end": "1248330"
  },
  {
    "text": "password you remember maybe one of the first whites were we talking about the connections between bias and embedded",
    "start": "1248330",
    "end": "1254299"
  },
  {
    "text": "controller if America value so you know it's static so basically this static",
    "start": "1254299",
    "end": "1261410"
  },
  {
    "text": "password you just hard coded in the Dixie driver and easy to recover and it's ended just to command to unlock the",
    "start": "1261410",
    "end": "1270890"
  },
  {
    "text": "cost right so can we basically just easy do some replay attack unfortunately not",
    "start": "1270890",
    "end": "1281179"
  },
  {
    "text": "because it's some additional beat set to",
    "start": "1281179",
    "end": "1287570"
  },
  {
    "text": "walk embedded controller before update will be started and basically this lock",
    "start": "1287570",
    "end": "1295780"
  },
  {
    "text": "on early stage bias then bias rebooted",
    "start": "1295780",
    "end": "1301070"
  },
  {
    "text": "on our result vector and only start update after that so authentification",
    "start": "1301070",
    "end": "1310010"
  },
  {
    "text": "normal possible on each sieve is out reset basically",
    "start": "1310010",
    "end": "1316120"
  },
  {
    "start": "1316000",
    "end": "1316000"
  },
  {
    "text": "lanova disclosure timeline so we submit to lino a picture they assign a specific",
    "start": "1322230",
    "end": "1327659"
  },
  {
    "text": "and make with us additional call where we describe of the issue details and",
    "start": "1327659",
    "end": "1333990"
  },
  {
    "text": "after that we agreed about what kind of the directions for Pudge it can be",
    "start": "1333990",
    "end": "1339120"
  },
  {
    "text": "thanks for collaboration with us and we see takeaways so we're working on the",
    "start": "1339120",
    "end": "1344909"
  },
  {
    "start": "1340000",
    "end": "1340000"
  },
  {
    "text": "buyers guard if you marry well your identification is static so basically not very hard to reply this stuff can be",
    "start": "1344909",
    "end": "1355559"
  },
  {
    "text": "abused in some scenarios when you see Road kit is has possibility to be",
    "start": "1355559",
    "end": "1360840"
  },
  {
    "text": "involved and we think we see bars got",
    "start": "1360840",
    "end": "1367259"
  },
  {
    "text": "the female whale you support for this wept appliance it's not fully implemented or it just like try to save",
    "start": "1367259",
    "end": "1375419"
  },
  {
    "text": "some time on this update process for performance reasons we don't know and",
    "start": "1375419",
    "end": "1381230"
  },
  {
    "text": "boot guard does not fully protect from Roush update in runtime as we seen on",
    "start": "1381230",
    "end": "1386940"
  },
  {
    "text": "the p40 in some cases and what the bios guard would have a change so let's make",
    "start": "1386940",
    "end": "1394529"
  },
  {
    "text": "a deep dive to the BIOS guard technology and wise guard technology actually very interesting because this technology been",
    "start": "1394529",
    "end": "1401399"
  },
  {
    "start": "1401000",
    "end": "1401000"
  },
  {
    "text": "introduced it from the Bratva lines and especially it was mostly have some",
    "start": "1401399",
    "end": "1408480"
  },
  {
    "text": "market information from window but not a lot of details so rationally bias guard",
    "start": "1408480",
    "end": "1414960"
  },
  {
    "text": "it's a technology which is armor in spy flash and try to remove responsibility from a semi I'm for it right and read to",
    "start": "1414960",
    "end": "1422970"
  },
  {
    "text": "the spy flash to something else and here's appears like multiple components of this technology will cover",
    "start": "1422970",
    "end": "1429389"
  },
  {
    "text": "on our talk and main thing is they remove write and read to the ACM model",
    "start": "1429389",
    "end": "1436129"
  },
  {
    "start": "1436000",
    "end": "1436000"
  },
  {
    "text": "so why is guard known as a platform flash armor in technology and yeah it's",
    "start": "1436129",
    "end": "1442889"
  },
  {
    "text": "basically control access over ECM and",
    "start": "1442889",
    "end": "1448100"
  },
  {
    "text": "PCH lock the spy flash access not rely on the P fat so wise vacation",
    "start": "1448100",
    "end": "1458419"
  },
  {
    "text": "mostly embedded an ACM model and actually same model for BIOS guard is encrypted by micro code and it is a game",
    "start": "1458419",
    "end": "1468200"
  },
  {
    "text": "over for malicious updates it's interesting question because the",
    "start": "1468200",
    "end": "1473539"
  },
  {
    "text": "technology super complex and you can see on our next part of presentation how and",
    "start": "1473539",
    "end": "1480080"
  },
  {
    "text": "where it can be misconfigured so also we",
    "start": "1480080",
    "end": "1485210"
  },
  {
    "text": "have multiple components involved for the security and the Intel platforms and interesting thing all these technologies",
    "start": "1485210",
    "end": "1494120"
  },
  {
    "text": "and features is disconnected from each other think about boot guard it doesn't",
    "start": "1494120",
    "end": "1499580"
  },
  {
    "text": "communicate with the buyers guard or vfi each other at all so it's totally separated features and when the buyout",
    "start": "1499580",
    "end": "1506179"
  },
  {
    "text": "guard involved in the boot full protection it just transfer control to the next stage to the secure boot but",
    "start": "1506179",
    "end": "1513139"
  },
  {
    "text": "like it's not really well connected so that means security boundaries can be",
    "start": "1513139",
    "end": "1519559"
  },
  {
    "text": "very interesting in this place but let's dig in Tobias guard feature overview so",
    "start": "1519559",
    "end": "1525980"
  },
  {
    "text": "first of all remember this link on the bottom because this white it's basically",
    "start": "1525980",
    "end": "1531980"
  },
  {
    "text": "been found there and very very moved us forward in our understanding how the",
    "start": "1531980",
    "end": "1537590"
  },
  {
    "text": "BIOS guard works so first of all we have a BIOS image where the header and bias",
    "start": "1537590",
    "end": "1542840"
  },
  {
    "text": "guard script script embedded and actually after that sign in server signs",
    "start": "1542840",
    "end": "1550820"
  },
  {
    "text": "this package and creates a bias guard update package and we recover all the format how the bus guard update package",
    "start": "1550820",
    "end": "1557630"
  },
  {
    "text": "loops like so and flash update tools communicate with the same I'm dry verse",
    "start": "1557630",
    "end": "1564200"
  },
  {
    "text": "and after that actually only after that ACM takes control on it and we make",
    "start": "1564200",
    "end": "1571580"
  },
  {
    "text": "active flashin part",
    "start": "1571580",
    "end": "1574630"
  },
  {
    "start": "1576000",
    "end": "1576000"
  },
  {
    "text": "so Lenovo ThinkPad pivot update process use Lenovo GDK tools of course and",
    "start": "1577419",
    "end": "1584320"
  },
  {
    "text": "framework have a pretty similar model when it's mapped on specific address the buyers image trigger buyers guard to",
    "start": "1584320",
    "end": "1591659"
  },
  {
    "text": "over SMI handler which is work visa CPI basically a CPI have specific region",
    "start": "1591659",
    "end": "1600070"
  },
  {
    "text": "which is trigger it's Mike and lyricists contain specific values so after that",
    "start": "1600070",
    "end": "1606989"
  },
  {
    "text": "buyers guard update package basically was mapped to the memory address with",
    "start": "1606989",
    "end": "1612339"
  },
  {
    "text": "the size and your trap address and your trap address actually trigger for the PCH and bios guard s my said the bus",
    "start": "1612339",
    "end": "1621009"
  },
  {
    "text": "guard directory wise guard direct actually huge structure we will talk on the next slide and very interesting so",
    "start": "1621009",
    "end": "1628479"
  },
  {
    "text": "and this directory contain address of ACM and trigger MSR and actually all",
    "start": "1628479",
    "end": "1635799"
  },
  {
    "text": "this MSR is undocumented and we recover over reverse engineering of the Dixie drivers which kind of floats off a",
    "start": "1635799",
    "end": "1642909"
  },
  {
    "text": "massage should be called so and ACM triggers microcode flow to verify and",
    "start": "1642909",
    "end": "1649779"
  },
  {
    "text": "apply bias guard update to reboot machine so you can see here is the",
    "start": "1649779",
    "end": "1654999"
  },
  {
    "text": "compiled it flow for initialization stage of bias guard update process here",
    "start": "1654999",
    "end": "1664629"
  },
  {
    "text": "is resources which we used for the by sub base guard research it's mostly",
    "start": "1664629",
    "end": "1670320"
  },
  {
    "text": "information which is available from window but not directly described all",
    "start": "1670320",
    "end": "1676029"
  },
  {
    "text": "the features which is basically have implemented on the bias guard technology nowadays also very good introduction",
    "start": "1676029",
    "end": "1684839"
  },
  {
    "text": "presentation from the Jason Johnson from Dell firmer security and I briefly look",
    "start": "1684839",
    "end": "1691989"
  },
  {
    "text": "on this bias guard technology in my offensive conan 2018 so of course we did",
    "start": "1691989",
    "end": "1697119"
  },
  {
    "text": "a lot of cross analysis between american megatrends phoenix and it's basically show us some pointers where we should",
    "start": "1697119",
    "end": "1703989"
  },
  {
    "text": "dig in okay no will present to use a recovery we've made on the bios GL",
    "start": "1703989",
    "end": "1709569"
  },
  {
    "text": "interface and start with the benefit are valuable as exposed by Intel processors for this",
    "start": "1709569",
    "end": "1715670"
  },
  {
    "text": "first what we're going to tell here we have as Mysterio and it would be fifty BIOS implementation which is a",
    "start": "1715670",
    "end": "1721370"
  },
  {
    "text": "phoenix-based BIOS and also processor was an Intel skylake family so we have",
    "start": "1721370",
    "end": "1727610"
  },
  {
    "start": "1726000",
    "end": "1726000"
  },
  {
    "text": "the other NTFS exposed by the process off to she brought this BIOS guard feature of course it come it is exposed",
    "start": "1727610",
    "end": "1733460"
  },
  {
    "text": "in the form of a set of MSR that you will manipulate to to activate and to",
    "start": "1733460",
    "end": "1739040"
  },
  {
    "text": "trigger of the feature the first time si will want to interact with is the MSR or X Cee and in this one you will simply",
    "start": "1739040",
    "end": "1746210"
  },
  {
    "text": "find a flag that tell you is a feature is you got it or not by the CP next the next very important reduce MSR register",
    "start": "1746210",
    "end": "1753200"
  },
  {
    "text": "will be MSR 110 in this one it's like your status registers posted by ocr'd feature tube it's especially important",
    "start": "1753200",
    "end": "1760490"
  },
  {
    "text": "the two lowest one one will tell you is the feature is an eval and one we tell you if the feature is locked or not this",
    "start": "1760490",
    "end": "1765980"
  },
  {
    "text": "is a read/write register so you can modify it okay so",
    "start": "1765980",
    "end": "1771740"
  },
  {
    "text": "oh that's BIOS guard world but it has of course always report both on PCH and",
    "start": "1771740",
    "end": "1776990"
  },
  {
    "text": "embedded controller part and when it boots this this controller are locked so",
    "start": "1776990",
    "end": "1783010"
  },
  {
    "text": "at the boot time by BIOS guard feature I will in the module I see in it we",
    "start": "1783010",
    "end": "1789050"
  },
  {
    "text": "believe it is for silicon it will actually generate an ephemeral value using the ne1 institution from the",
    "start": "1789050",
    "end": "1795380"
  },
  {
    "text": "processor itself and this value will be buried in through adware when you write it into MSF 117 and this ephemeral value",
    "start": "1795380",
    "end": "1803660"
  },
  {
    "text": "will also be sent to the embedded controller in the code we have been reversing we didn't follow any use of it",
    "start": "1803660",
    "end": "1809360"
  },
  {
    "text": "on the Edit controller and oh it rocks is that at a later time at runtime when you want to figure the BIOS CAD feature",
    "start": "1809360",
    "end": "1816260"
  },
  {
    "text": "it will the barrios grab a dress you bought will use this ephemeral value to",
    "start": "1816260",
    "end": "1821360"
  },
  {
    "text": "kind of authenticate itself to the PC edge controller if you want if it want to write inside the spy flash to write",
    "start": "1821360",
    "end": "1827570"
  },
  {
    "text": "the BIOS for example authenticate yourself to the EC to prove that the update attempt comes from secure secure",
    "start": "1827570",
    "end": "1836240"
  },
  {
    "text": "origin and yes and once you are returning to this MSR hundred seventeen",
    "start": "1836240",
    "end": "1841460"
  },
  {
    "text": "the value is totally discarded that means that even if you have cut a calyx petition called URL to encode as",
    "start": "1841460",
    "end": "1848850"
  },
  {
    "text": "operating system liver or venomous mm you will not be able to access this value anymore you cannot recover it okay",
    "start": "1848850",
    "end": "1855980"
  },
  {
    "text": "then we have a very important structure that is a BIOS gap platform data table for new literacy that it contains all",
    "start": "1855980",
    "end": "1862680"
  },
  {
    "text": "the platform dependent static configuration of the feature it's a certain pattern feature also it's initialized quite early in the boot",
    "start": "1862680",
    "end": "1869730"
  },
  {
    "text": "process of the processor or the boot sorry and what happens is that it",
    "start": "1869730",
    "end": "1876270"
  },
  {
    "text": "computes a digest of this table what it is set up and it is this digest is returned into a set of four MS are from",
    "start": "1876270",
    "end": "1883230"
  },
  {
    "text": "111 to an Android protein that means that we believe this register ms are",
    "start": "1883230",
    "end": "1888480"
  },
  {
    "text": "being right on e or they are locked once the feature is enabled and not and that means that as soon as you have locked",
    "start": "1888480",
    "end": "1895170"
  },
  {
    "text": "the feature this configuration is immutable you cannot modify it anymore because our support will have the value",
    "start": "1895170",
    "end": "1900960"
  },
  {
    "text": "of the digest and if you try to if you attempt to modify it then it would be able to detect the modification so at",
    "start": "1900960",
    "end": "1908370"
  },
  {
    "text": "this point we are on P I face very early in the boot that means the Biot feature is entirely",
    "start": "1908370",
    "end": "1913710"
  },
  {
    "text": "set up and locked on and then we will see oh we can use it at runtime there",
    "start": "1913710",
    "end": "1919530"
  },
  {
    "start": "1919000",
    "end": "1919000"
  },
  {
    "text": "are two other MSF that will use at right time the first one is a 115 basically in",
    "start": "1919530",
    "end": "1925350"
  },
  {
    "text": "that one you will place a pointer on all the parent of all the arguments of is a call you want to make this a feature we",
    "start": "1925350",
    "end": "1931320"
  },
  {
    "text": "will detail later what are these arguments but phonology says that you place the pointer on the",
    "start": "1931320",
    "end": "1936420"
  },
  {
    "text": "parameter of the pressure on you want to execute in when an MS are 115 and then",
    "start": "1936420",
    "end": "1941700"
  },
  {
    "text": "you want to figure out the feature and we simply write into MSF 116 it's like a",
    "start": "1941700",
    "end": "1946920"
  },
  {
    "text": "Cisco or trigger for the photo BIOS galaxy Emma speaking about the BIOS",
    "start": "1946920",
    "end": "1952350"
  },
  {
    "text": "Kardashian of course we are quite on the boundaries between software Heine where you can seek out the same module as a kind of",
    "start": "1952350",
    "end": "1959250"
  },
  {
    "text": "software plug-in for the AdWords support its it comes as a file inside the BIOS",
    "start": "1959250",
    "end": "1966420"
  },
  {
    "text": "image its formats is quite close to the one that to the boot yard SEM module from all the module we've been able to",
    "start": "1966420",
    "end": "1973980"
  },
  {
    "text": "recover of the sizes always 30k of cod it is sign of cross by Intel",
    "start": "1973980",
    "end": "1979340"
  },
  {
    "text": "and I like it I said it is a free encrypted so for us it's a pure black box still we expect this as a module to",
    "start": "1979340",
    "end": "1986360"
  },
  {
    "text": "implement the BGP TD ash digest verification update package signature",
    "start": "1986360",
    "end": "1991400"
  },
  {
    "text": "check also a fictional scenario on the update package we expected to implement the script interpreter we will tell more",
    "start": "1991400",
    "end": "1997910"
  },
  {
    "text": "about the script later also and also to implement all the flash spy access and",
    "start": "1997910",
    "end": "2003130"
  },
  {
    "text": "the communication with the embedded controller if this feature is used by the implementation and yes this decision",
    "start": "2003130",
    "end": "2010090"
  },
  {
    "text": "modules come as a binary blob provided by Intel to the OEM so that was for the",
    "start": "2010090",
    "end": "2017049"
  },
  {
    "text": "ready address report aware NTFS I know we will look at the software interface of the OEM and this case the novo uses a",
    "start": "2017049",
    "end": "2024460"
  },
  {
    "text": "feature to to implement to secure flash update we have the biosphere directory",
    "start": "2024460",
    "end": "2030340"
  },
  {
    "start": "2028000",
    "end": "2028000"
  },
  {
    "text": "that is the stop people structure that contains all the parameter that you need",
    "start": "2030340",
    "end": "2035770"
  },
  {
    "text": "to pass to request a BIOS guard operation it's very simple it's an array",
    "start": "2035770",
    "end": "2041169"
  },
  {
    "text": "of six pointer on the first one is a pointer of the SI modules second one a pointer of the BGP TT and the third one",
    "start": "2041169",
    "end": "2047260"
  },
  {
    "text": "is a pointer on the update package all the elements you want to write into the spy flash to say simply the service or",
    "start": "2047260",
    "end": "2056530"
  },
  {
    "text": "last a still mostly unknown to us yes they are just a quick quick bit you said",
    "start": "2056530",
    "end": "2062320"
  },
  {
    "text": "if you want to say that one on three one pointer is in the structure is present on it so this is BIOS guard directory",
    "start": "2062320",
    "end": "2069148"
  },
  {
    "start": "2069000",
    "end": "2069000"
  },
  {
    "text": "then we have the BIOS gap platform data table that we've been speaking a spoke already so it contains all the",
    "start": "2069149",
    "end": "2076030"
  },
  {
    "text": "configuration of the static configuration of the protection of the BIOS card feature it contains for example the i/o pots",
    "start": "2076030",
    "end": "2082300"
  },
  {
    "text": "that will be used to communicate with a militant roller and the commands that we suppose are used to perform the update",
    "start": "2082300",
    "end": "2089050"
  },
  {
    "text": "with the embedded controller some very important things also it contains a digest of the public keys that are used",
    "start": "2089050",
    "end": "2095350"
  },
  {
    "text": "to sign the chunk of the BIOS BIOS update camera so that's BIOS so that",
    "start": "2095350",
    "end": "2102520"
  },
  {
    "text": "ability are the same can verify that it's signed with the prop rocky and the cornerstone in this table also",
    "start": "2102520",
    "end": "2109880"
  },
  {
    "text": "filled us farm array so this stretch will describe actually run of protected",
    "start": "2109880",
    "end": "2115180"
  },
  {
    "text": "spy flash ranges by flash addresses and yeah like we saw just before the exist",
    "start": "2115180",
    "end": "2121250"
  },
  {
    "text": "or this configuration is still very early in the boot process so to describe",
    "start": "2121250",
    "end": "2127520"
  },
  {
    "text": "most farm ranges it's just a very simple structure with start address and address and you will describe a set of ranges",
    "start": "2127520",
    "end": "2134690"
  },
  {
    "text": "that you want to protect with the BIOS guard feature and as soon as you",
    "start": "2134690",
    "end": "2139880"
  },
  {
    "text": "describe protected runs like this it means that you will request you can only write inside these countries with signed",
    "start": "2139880",
    "end": "2146660"
  },
  {
    "text": "signed operations and so so interesting to make a question energies of these",
    "start": "2146660",
    "end": "2151790"
  },
  {
    "text": "Franzese with information we can get from the flash map structure to do to",
    "start": "2151790",
    "end": "2156860"
  },
  {
    "text": "analyze what kind of what parts of the BIOS match already protected by sea",
    "start": "2156860",
    "end": "2162260"
  },
  {
    "text": "sponges or example many firmware recovery humouring cetera okay so now we",
    "start": "2162260",
    "end": "2168950"
  },
  {
    "start": "2167000",
    "end": "2167000"
  },
  {
    "text": "have the static who has the configuration of the protection study configuration of the protection and we will want to perform some kind of",
    "start": "2168950",
    "end": "2174830"
  },
  {
    "text": "operation for example to write some processes of the flash freeze or new",
    "start": "2174830",
    "end": "2179930"
  },
  {
    "text": "firmware we will be building up update package which mostly contains four",
    "start": "2179930",
    "end": "2185360"
  },
  {
    "text": "elements first is a header the new script then the buffer that is the data that you want to write into the flash",
    "start": "2185360",
    "end": "2191150"
  },
  {
    "text": "and then at the end the cryptographic material basically the signature of",
    "start": "2191150",
    "end": "2196250"
  },
  {
    "text": "course of the buffer that is coming just before like Alex said the feature you",
    "start": "2196250",
    "end": "2201770"
  },
  {
    "text": "invoke the feature with some scripts scripts can be completed for sign our",
    "start": "2201770",
    "end": "2207530"
  },
  {
    "text": "protected operation dynamically generated at runtime by dedicated module",
    "start": "2207530",
    "end": "2212630"
  },
  {
    "text": "we can find all the templates that are used by the by using an implementation",
    "start": "2212630",
    "end": "2218180"
  },
  {
    "text": "from a novel in a dedicated structure that is appended at the end of the UFA",
    "start": "2218180",
    "end": "2224180"
  },
  {
    "text": "image so we have this I pack directory it comes from the city from the magic of",
    "start": "2224180",
    "end": "2229370"
  },
  {
    "text": "the structure so we have this directory that allows you to find all the files",
    "start": "2229370",
    "end": "2234920"
  },
  {
    "text": "that I use as a template to the fighters in the green products and the directories of the very end in a in",
    "start": "2234920",
    "end": "2240470"
  },
  {
    "text": "purple so we have been reversing the structure and we are able to dump all the files",
    "start": "2240470",
    "end": "2246020"
  },
  {
    "text": "that are described in sexists the first one is mg drug basically just main ufi",
    "start": "2246020",
    "end": "2251660"
  },
  {
    "text": "image the main update that we want to write then we would have had basically a",
    "start": "2251660",
    "end": "2256730"
  },
  {
    "text": "template for the other perp a CRP which is a template for the script website",
    "start": "2256730",
    "end": "2262040"
  },
  {
    "text": "which is a certificate in so template you will embedding the public keys and",
    "start": "2262040",
    "end": "2267280"
  },
  {
    "text": "under signature of the chunk we want to write and pop sign is a big file you just the collection of all the signature",
    "start": "2267280",
    "end": "2274340"
  },
  {
    "text": "for all the chunks of the main images and also the me fight with file a file",
    "start": "2274340",
    "end": "2279530"
  },
  {
    "text": "with the meaning the name seems to come from an artifact from the SDK and there",
    "start": "2279530",
    "end": "2284570"
  },
  {
    "text": "are specific checks into the code that that verifies that this file are not",
    "start": "2284570",
    "end": "2290030"
  },
  {
    "text": "used in production no okay we we found lots of templates into this",
    "start": "2290030",
    "end": "2296450"
  },
  {
    "text": "I pack structure we will detail them return first we have upset that bin so",
    "start": "2296450",
    "end": "2301730"
  },
  {
    "text": "like we said it contains also cryptographic material mostly the public cheese that has been used for the",
    "start": "2301730",
    "end": "2307340"
  },
  {
    "text": "signature it's a signature and try to digest and we have the big placeholder for the scenario you take you so you",
    "start": "2307340",
    "end": "2314750"
  },
  {
    "text": "have the public keys and then the signature I've replaced earlier it is a very turn at one time with signature",
    "start": "2314750",
    "end": "2319790"
  },
  {
    "text": "that is frosted chunk you want to write it with a flash then you have the",
    "start": "2319790",
    "end": "2326300"
  },
  {
    "text": "template for the header most so few informations the most critical one is a",
    "start": "2326300",
    "end": "2332960"
  },
  {
    "text": "flags field inside that one you have specific bits that you have to set to indicate to the bios get the CM that",
    "start": "2332960",
    "end": "2339440"
  },
  {
    "text": "your person you are going to perform either right on your race is actually a sign operation so it needs to check all",
    "start": "2339440",
    "end": "2345350"
  },
  {
    "text": "the stuff check the signature of the buffet all you want to write etc the other field is a platform for us it will",
    "start": "2345350",
    "end": "2350720"
  },
  {
    "text": "be skylake in this process laptop PCT skylake skylake processor but just we",
    "start": "2350720",
    "end": "2357710"
  },
  {
    "text": "this platform have to be quite run between the values field we can find so",
    "start": "2357710",
    "end": "2362960"
  },
  {
    "text": "we have almost irrelevant we need to build a bios gathered aid package so we will have four header the script that",
    "start": "2362960",
    "end": "2369830"
  },
  {
    "text": "will be modified a little we'll see how then rotate buffer the main image is speaking to chunks of 1000 bytes",
    "start": "2369830",
    "end": "2376820"
  },
  {
    "text": "and then at the end we have the signature of these chumps if you request",
    "start": "2376820",
    "end": "2382190"
  },
  {
    "text": "a sign operation and like we said we're able to build certain the BIOS guard",
    "start": "2382190",
    "end": "2387380"
  },
  {
    "text": "directory with a point to us JCM point on the bt PT d point out by using odd update package we take a pointer on this",
    "start": "2387380",
    "end": "2394760"
  },
  {
    "text": "directory we placed it into MSR 115 and we trigger the execution with right",
    "start": "2394760",
    "end": "2400130"
  },
  {
    "text": "inside MSL 116 so we children out the",
    "start": "2400130",
    "end": "2405530"
  },
  {
    "text": "execution of the BIOS got the same what it will does is that BIOS calcium will check some stuff like for example that",
    "start": "2405530",
    "end": "2411710"
  },
  {
    "text": "the bgp TD has not been tampered with check the signature of some parts and in",
    "start": "2411710",
    "end": "2417020"
  },
  {
    "text": "we will start the execution of the script we pass through it as the ACM is",
    "start": "2417020",
    "end": "2424130"
  },
  {
    "text": "free encrypted it's purely block Blackbaud so we only been able to recover some very partial information on",
    "start": "2424130",
    "end": "2430960"
  },
  {
    "text": "about this script languages from what we've been able to recover it seems to be a fixed size instruction set a byte",
    "start": "2430960",
    "end": "2437720"
  },
  {
    "text": "instructions it always start with 0 1 and always end with FF and we have a few",
    "start": "2437720",
    "end": "2444440"
  },
  {
    "text": "instructions that are that we've been able to understand a bit yes so as I want to set the flash address where you",
    "start": "2444440",
    "end": "2451100"
  },
  {
    "text": "want to write and there are instruction to say ok I want to erase some chunks or on assumptions I say ok I want to write",
    "start": "2451100",
    "end": "2456950"
  },
  {
    "text": "that check and like this like the interpreter is in the same or fully",
    "start": "2456950",
    "end": "2462980"
  },
  {
    "text": "encrypted we have no access to it so it's difficult to say like we say before",
    "start": "2462980",
    "end": "2468560"
  },
  {
    "text": "there are two kinds of scripts you cannot dynamically generated script for ensign oppression in this case scripts",
    "start": "2468560",
    "end": "2474680"
  },
  {
    "text": "already basic only for instruction it's a new start set address right and so",
    "start": "2474680",
    "end": "2481040"
  },
  {
    "text": "very basic in case you use complicated scripts for sign oppression then we have",
    "start": "2481040",
    "end": "2486710"
  },
  {
    "text": "a larger program which is 26 instruction we said that this script is a template",
    "start": "2486710",
    "end": "2493130"
  },
  {
    "text": "because the second and third instruction will be modified on the fly will with",
    "start": "2493130",
    "end": "2498380"
  },
  {
    "text": "correct flash address that you want to write into and and the third one you",
    "start": "2498380",
    "end": "2504860"
  },
  {
    "text": "will patch the the chunk size the size of the buffers that you want to write and of course like we said which is",
    "start": "2504860",
    "end": "2512210"
  },
  {
    "text": "really the cornerstone of the prediction is that if you want to write inside SF and described region",
    "start": "2512210",
    "end": "2517310"
  },
  {
    "text": "you need to have sign oppression otherwise it will raise an error",
    "start": "2517310",
    "end": "2522610"
  },
  {
    "text": "yeah we have open questions in this issue edge because we really not understand this example why bio script",
    "start": "2522610",
    "end": "2529550"
  },
  {
    "text": "it can be modified in runtime and from the previous slides you can understand how much possibility for the attacker",
    "start": "2529550",
    "end": "2536510"
  },
  {
    "text": "this bio script has so it's creates really large attack surface in our understanding and also like complexity",
    "start": "2536510",
    "end": "2542930"
  },
  {
    "text": "of technology itself it's kind of impressive also we was thinking ok ACM",
    "start": "2542930",
    "end": "2548030"
  },
  {
    "text": "is encrypted and basically we can control when we load the ACM and also we",
    "start": "2548030",
    "end": "2554810"
  },
  {
    "text": "control the buyer script on our side so it's actually open a lot of possibilities for the black box fastened",
    "start": "2554810",
    "end": "2562010"
  },
  {
    "text": "for ACM itself even it's encrypted we can't dump it because it's actually execute on the lock at hash but we try",
    "start": "2562010",
    "end": "2568850"
  },
  {
    "text": "it our best actually will be described a bit later on experiments right and so not for this research we also found a",
    "start": "2568850",
    "end": "2576020"
  },
  {
    "text": "lot of interesting cards as you can see like bad BP DG and script syntax",
    "start": "2576020",
    "end": "2581120"
  },
  {
    "text": "unexpected opcode all of these error codes actually can be additional pointers for black box fighting and you",
    "start": "2581120",
    "end": "2588740"
  },
  {
    "text": "can basically reduce the scope by understanding what you exactly fast and where you failed so what kind of",
    "start": "2588740",
    "end": "2594650"
  },
  {
    "text": "experiments we did so actually we did a lot of ACM fun honestly so we try it with into hardware",
    "start": "2594650",
    "end": "2601700"
  },
  {
    "text": "debugger DCI access to ACM memory unfortunately you need additional unlocks to debug a CMS on the Intel",
    "start": "2601700",
    "end": "2608900"
  },
  {
    "text": "platform and just normal ACM ad shy doesn't work properly so we can dump",
    "start": "2608900",
    "end": "2614150"
  },
  {
    "text": "decrypted ACM from the memory but it was good try so we try to replace Vice guard ACM on",
    "start": "2614150",
    "end": "2621920"
  },
  {
    "text": "different different versions of the cesium on specific platform and it's",
    "start": "2621920",
    "end": "2627530"
  },
  {
    "text": "with older versions it's temporarily brings a laptop but thanks God it can be",
    "start": "2627530",
    "end": "2633650"
  },
  {
    "text": "refreshed and recovered and because we just have one target platform with research and remove a cm from the update",
    "start": "2633650",
    "end": "2640700"
  },
  {
    "text": "image itself is basically create interesting flow because it starts whoop of weird reboots on s3 which is sleep",
    "start": "2640700",
    "end": "2647780"
  },
  {
    "text": "state and after few tries its recovers the previous state of firmware so and as",
    "start": "2647780",
    "end": "2655640"
  },
  {
    "text": "a conclusion we basically want to make a not-so feature by its guard feature it's",
    "start": "2655640",
    "end": "2663410"
  },
  {
    "text": "very complex it's a lot of different parts which can be something go wrong and strong dependency om when there's",
    "start": "2663410",
    "end": "2671270"
  },
  {
    "text": "two in told because OMS doesn't control ACM and they see em version not very",
    "start": "2671270",
    "end": "2676400"
  },
  {
    "text": "recently yet updated so it's actually we notice many many platforms just use the",
    "start": "2676400",
    "end": "2684740"
  },
  {
    "text": "same ACM and even sometimes newer generation use older ACM version it",
    "start": "2684740",
    "end": "2690620"
  },
  {
    "text": "might be not older adjust not bias guard script evolved so you know by AC support",
    "start": "2690620",
    "end": "2697850"
  },
  {
    "text": "embedded controller support for in familiar value configure generation and",
    "start": "2697850",
    "end": "2704150"
  },
  {
    "text": "also for the bias guard scheme it's not very it's not implement all the features",
    "start": "2704150",
    "end": "2711470"
  },
  {
    "text": "which is intellectually propose it on the public and also it's probably just",
    "start": "2711470",
    "end": "2716870"
  },
  {
    "text": "not follow the reference code or whatever so it's still limited its possibility for other farmers also can",
    "start": "2716870",
    "end": "2725060"
  },
  {
    "text": "be updated more securely with a bias guard but we don't see a disease and",
    "start": "2725060",
    "end": "2730850"
  },
  {
    "text": "many implementation details in hands of AM which is like of miss configuration",
    "start": "2730850",
    "end": "2736010"
  },
  {
    "text": "or supply chain attacks so yeah we're implementation can be failed secure",
    "start": "2736010",
    "end": "2741890"
  },
  {
    "start": "2737000",
    "end": "2737000"
  },
  {
    "text": "flash access regions is Pham which we show to you how it can be mapped to the",
    "start": "2741890",
    "end": "2747350"
  },
  {
    "text": "flash map it can be misconfigured if you miss something so then it can create a",
    "start": "2747350",
    "end": "2752840"
  },
  {
    "text": "room for the attacker to basically use this possibility to basically modify",
    "start": "2752840",
    "end": "2758630"
  },
  {
    "text": "some dixie models or even SMM if om can be filed and also sign at vs",
    "start": "2758630",
    "end": "2766130"
  },
  {
    "text": "and sign a separation this bias guard script create a lot of concerns on our side come occasion between bias and he see",
    "start": "2766130",
    "end": "2772310"
  },
  {
    "text": "implemented correctly but not static session password right so and recovery",
    "start": "2772310",
    "end": "2777920"
  },
  {
    "text": "process of course involved for the bias guard falls - and recovery it's very",
    "start": "2777920",
    "end": "2782960"
  },
  {
    "text": "very difficult to be make it secure so it's also kind of interesting place to",
    "start": "2782960",
    "end": "2788450"
  },
  {
    "text": "look for the future research thanks a lot for everybody who support us in this",
    "start": "2788450",
    "end": "2793970"
  },
  {
    "text": "research and especially we want to thank Seeger and in fact for great support of Ida Pro specially on the ark disassembly",
    "start": "2793970",
    "end": "2801170"
  },
  {
    "text": "part because it's just great thank you",
    "start": "2801170",
    "end": "2806720"
  },
  {
    "text": "everybody [Applause]",
    "start": "2806720",
    "end": "2816610"
  },
  {
    "text": "hi I'm just curious on how you arrived at Lenovo and if you did do any",
    "start": "2820660",
    "end": "2825890"
  },
  {
    "text": "preliminary tests excuse me can you speak a bit more louder because we can't hear you",
    "start": "2825890",
    "end": "2831310"
  },
  {
    "text": "hello there I was wondering at how you arrived at Lenovo and if you did any",
    "start": "2831310",
    "end": "2836600"
  },
  {
    "text": "other preliminary tests with say Dell and HP and if you suspect that they have",
    "start": "2836600",
    "end": "2843350"
  },
  {
    "text": "similar vulnerabilities so probably but we don't look on HP or Dell just because",
    "start": "2843350",
    "end": "2850010"
  },
  {
    "text": "we have an aha so we just use the laptops which we have on our a table for as a target platforms",
    "start": "2850010",
    "end": "2855800"
  },
  {
    "text": "the Ted so it was main purpose but answering on your question because most",
    "start": "2855800",
    "end": "2864770"
  },
  {
    "text": "of the vendors use the same practices probably it can be same problems on the",
    "start": "2864770",
    "end": "2870860"
  },
  {
    "text": "other vendors but we don't know you",
    "start": "2870860",
    "end": "2877310"
  },
  {
    "text": "mentioned that T 540 doesn't have EC authentication no it's just sorry it has",
    "start": "2877310",
    "end": "2886040"
  },
  {
    "text": "easy identification okay for indie boot process unfortunately doesn't have and B",
    "start": "2886040",
    "end": "2892280"
  },
  {
    "text": "50 has okay but I mean in the boot process or when apatite in DC is it",
    "start": "2892280",
    "end": "2900950"
  },
  {
    "text": "which kind of a dedication both excuse me I like for the boot chain does it verify",
    "start": "2900950",
    "end": "2907640"
  },
  {
    "text": "the EC image also or these authentication is for when a PDA TDC de",
    "start": "2907640",
    "end": "2914270"
  },
  {
    "text": "fumer I firmly know we try very detailed asking the questions where is this",
    "start": "2914270",
    "end": "2923630"
  },
  {
    "text": "authentication sorry you mentioned that let's maybe discuss this later in the room visa questions because I think it's",
    "start": "2923630",
    "end": "2930650"
  },
  {
    "text": "need very detailed exploitation we will took like a 5 minutes to explain",
    "start": "2930650",
    "end": "2936220"
  },
  {
    "text": "[Applause]",
    "start": "2948060",
    "end": "2953219"
  }
]