[
  {
    "text": "Louie teon Marcille and he'll be talking",
    "start": "30",
    "end": "2790"
  },
  {
    "text": "about exploiting caching servers please",
    "start": "2790",
    "end": "4620"
  },
  {
    "text": "welcome to the stage all right",
    "start": "4620",
    "end": "14460"
  },
  {
    "text": "so hi everyone will come to blackhat and",
    "start": "14460",
    "end": "17130"
  },
  {
    "text": "thanks for attending this talk so the",
    "start": "17130",
    "end": "19740"
  },
  {
    "text": "title of this talk is edges I'll include",
    "start": "19740",
    "end": "21840"
  },
  {
    "text": "injection amusing caching servers into",
    "start": "21840",
    "end": "23699"
  },
  {
    "text": "server side request forgery and",
    "start": "23699",
    "end": "25260"
  },
  {
    "text": "transparent session hijacking so that's",
    "start": "25260",
    "end": "27840"
  },
  {
    "text": "a pretty long title it's meant to",
    "start": "27840",
    "end": "30060"
  },
  {
    "text": "mention some of the many things that you",
    "start": "30060",
    "end": "31560"
  },
  {
    "text": "can do with edge that includes",
    "start": "31560",
    "end": "32730"
  },
  {
    "text": "especially when you're injecting it so",
    "start": "32730",
    "end": "34980"
  },
  {
    "text": "for the rest of this talk I'll be",
    "start": "34980",
    "end": "36360"
  },
  {
    "text": "referring to ESI when I mean edge table",
    "start": "36360",
    "end": "38940"
  },
  {
    "text": "includes because it's much more",
    "start": "38940",
    "end": "40050"
  },
  {
    "text": "convenient so during this talk we'll be",
    "start": "40050",
    "end": "42719"
  },
  {
    "text": "talking about ESI and the problem that",
    "start": "42719",
    "end": "45030"
  },
  {
    "text": "it was created to solve we'll talk about",
    "start": "45030",
    "end": "47579"
  },
  {
    "text": "the problem that it created and how we",
    "start": "47579",
    "end": "49410"
  },
  {
    "text": "can abuse that and then we'll talk",
    "start": "49410",
    "end": "51149"
  },
  {
    "text": "mitigation and migration so my name is",
    "start": "51149",
    "end": "54180"
  },
  {
    "text": "Louis Jamison I work at go secure in",
    "start": "54180",
    "end": "56460"
  },
  {
    "text": "Montreal and this is where we initially",
    "start": "56460",
    "end": "58739"
  },
  {
    "text": "discovered ESI so to give a bit more",
    "start": "58739",
    "end": "61079"
  },
  {
    "text": "context ESI is basically a new class of",
    "start": "61079",
    "end": "64049"
  },
  {
    "text": "attacks which is targeting ESI enabled",
    "start": "64049",
    "end": "67350"
  },
  {
    "text": "caching servers so we discovered this",
    "start": "67350",
    "end": "70110"
  },
  {
    "text": "vulnerability or this class of attacks",
    "start": "70110",
    "end": "72500"
  },
  {
    "text": "on site a decline so it's actually my",
    "start": "72500",
    "end": "75420"
  },
  {
    "text": "colleague the Honda Sonia who was doing",
    "start": "75420",
    "end": "78119"
  },
  {
    "text": "a caching server configuration review",
    "start": "78119",
    "end": "80460"
  },
  {
    "text": "for one of our largest clients basically",
    "start": "80460",
    "end": "82560"
  },
  {
    "text": "a large is be back in Montreal and they",
    "start": "82560",
    "end": "85320"
  },
  {
    "text": "wanted a security overview of their",
    "start": "85320",
    "end": "86610"
  },
  {
    "text": "caching efforts so basically every edge",
    "start": "86610",
    "end": "88650"
  },
  {
    "text": "server on their infrastructure they",
    "start": "88650",
    "end": "90299"
  },
  {
    "text": "wanted us to look at the configuration",
    "start": "90299",
    "end": "91650"
  },
  {
    "text": "and we kept seeing references to edge",
    "start": "91650",
    "end": "94680"
  },
  {
    "text": "side includes now all of our team is",
    "start": "94680",
    "end": "97530"
  },
  {
    "text": "pretty experienced with web app and",
    "start": "97530",
    "end": "98880"
  },
  {
    "text": "testing and security stuff and no one",
    "start": "98880",
    "end": "100710"
  },
  {
    "text": "has ever heard about that so we started",
    "start": "100710",
    "end": "102780"
  },
  {
    "text": "looking about what is the SI and we",
    "start": "102780",
    "end": "105960"
  },
  {
    "text": "found the first and last",
    "start": "105960",
    "end": "108180"
  },
  {
    "text": "so the initial and last specification",
    "start": "108180",
    "end": "110040"
  },
  {
    "text": "for ESI which dates from 2001 which is",
    "start": "110040",
    "end": "112470"
  },
  {
    "text": "17 years ago and every single vendor",
    "start": "112470",
    "end": "115320"
  },
  {
    "text": "that we analyzed had always some weird",
    "start": "115320",
    "end": "118590"
  },
  {
    "text": "screenshots predating from when I wasn't",
    "start": "118590",
    "end": "122009"
  },
  {
    "text": "even in high school when someone made",
    "start": "122009",
    "end": "123210"
  },
  {
    "text": "this so you have word art in",
    "start": "123210",
    "end": "124649"
  },
  {
    "text": "documentation so we had a pretty bad",
    "start": "124649",
    "end": "126090"
  },
  {
    "text": "feeling because I don't know if you were",
    "start": "126090",
    "end": "127439"
  },
  {
    "text": "doing web development 20 years ago but",
    "start": "127439",
    "end": "129509"
  },
  {
    "text": "security was the least of every",
    "start": "129509",
    "end": "131500"
  },
  {
    "text": "concerned so let's describe yes thought",
    "start": "131500",
    "end": "135130"
  },
  {
    "text": "before talking about exploiting it so",
    "start": "135130",
    "end": "136770"
  },
  {
    "text": "due to a brief overview let's look at a",
    "start": "136770",
    "end": "139270"
  },
  {
    "text": "very primitive webpage example so you",
    "start": "139270",
    "end": "141340"
  },
  {
    "text": "have a weather website now to the",
    "start": "141340",
    "end": "144280"
  },
  {
    "text": "end-user this is a single HTTP response",
    "start": "144280",
    "end": "147100"
  },
  {
    "text": "there's nothing to it but to the ESI",
    "start": "147100",
    "end": "149620"
  },
  {
    "text": "enabled engine this might be multiple",
    "start": "149620",
    "end": "151930"
  },
  {
    "text": "fragments now these fragments are there",
    "start": "151930",
    "end": "154660"
  },
  {
    "text": "for one reason only which is you're able",
    "start": "154660",
    "end": "158230"
  },
  {
    "text": "when you use ESI to invalidate",
    "start": "158230",
    "end": "159940"
  },
  {
    "text": "individual elements of your webpage so",
    "start": "159940",
    "end": "162250"
  },
  {
    "text": "here for example the website has a",
    "start": "162250",
    "end": "164980"
  },
  {
    "text": "graphical interface so you have the",
    "start": "164980",
    "end": "166630"
  },
  {
    "text": "labels but when you think about it these",
    "start": "166630",
    "end": "168700"
  },
  {
    "text": "labels don't have to be invalidated",
    "start": "168700",
    "end": "170290"
  },
  {
    "text": "they're not likely to change anytime",
    "start": "170290",
    "end": "172060"
  },
  {
    "text": "soon whereas the actual forecast data",
    "start": "172060",
    "end": "174280"
  },
  {
    "text": "might change within the hour",
    "start": "174280",
    "end": "176170"
  },
  {
    "text": "so using ESI you're able to invalidate",
    "start": "176170",
    "end": "178780"
  },
  {
    "text": "the cache entry for subsets of a webpage",
    "start": "178780",
    "end": "180760"
  },
  {
    "text": "now of course if you leverage ESI",
    "start": "180760",
    "end": "182830"
  },
  {
    "text": "properly you're gonna have a major",
    "start": "182830",
    "end": "184150"
  },
  {
    "text": "increase in performance and of course",
    "start": "184150",
    "end": "185770"
  },
  {
    "text": "you have now the ability to caching so",
    "start": "185770",
    "end": "187720"
  },
  {
    "text": "it's pretty good technology however",
    "start": "187720",
    "end": "190870"
  },
  {
    "text": "there has to be a way for the",
    "start": "190870",
    "end": "192910"
  },
  {
    "text": "application server to tell the caching",
    "start": "192910",
    "end": "194770"
  },
  {
    "text": "server where individual fragments begin",
    "start": "194770",
    "end": "197080"
  },
  {
    "text": "and where the end and this is done",
    "start": "197080",
    "end": "199150"
  },
  {
    "text": "through fragment markers so fragment",
    "start": "199150",
    "end": "201519"
  },
  {
    "text": "markers are basically XML tags which are",
    "start": "201519",
    "end": "203500"
  },
  {
    "text": "prefixed with ESI now as you can see in",
    "start": "203500",
    "end": "206739"
  },
  {
    "text": "the middle of the slide you have a",
    "start": "206739",
    "end": "208060"
  },
  {
    "text": "simple ESI tag so your action would go",
    "start": "208060",
    "end": "210730"
  },
  {
    "text": "after the column and then you sometimes",
    "start": "210730",
    "end": "212170"
  },
  {
    "text": "have attributes shown in the mix these",
    "start": "212170",
    "end": "214720"
  },
  {
    "text": "tags are in the HTTP response meaning",
    "start": "214720",
    "end": "217420"
  },
  {
    "text": "that they're gonna be parsed by the ESI",
    "start": "217420",
    "end": "219340"
  },
  {
    "text": "engine that is sitting on the caching",
    "start": "219340",
    "end": "221230"
  },
  {
    "text": "server when this response goes to the",
    "start": "221230",
    "end": "223810"
  },
  {
    "text": "server so your HCP surrogate which is",
    "start": "223810",
    "end": "227620"
  },
  {
    "text": "your ESI engine it could be a load",
    "start": "227620",
    "end": "229150"
  },
  {
    "text": "balancer a proxy or any cache server",
    "start": "229150",
    "end": "231390"
  },
  {
    "text": "will often require that you send",
    "start": "231390",
    "end": "233829"
  },
  {
    "text": "specific HTTP handlers to say hey I have",
    "start": "233829",
    "end": "236620"
  },
  {
    "text": "ESI tags please parse them however we",
    "start": "236620",
    "end": "239860"
  },
  {
    "text": "found that if your website is leveraging",
    "start": "239860",
    "end": "241630"
  },
  {
    "text": "es I'll then it's probably enabled",
    "start": "241630",
    "end": "243220"
  },
  {
    "text": "everywhere so injection is pretty easy",
    "start": "243220",
    "end": "245519"
  },
  {
    "text": "so we'll say two features before talking",
    "start": "245519",
    "end": "248290"
  },
  {
    "text": "about exploitation just because it's a",
    "start": "248290",
    "end": "249790"
  },
  {
    "text": "bit obscure right now so the first one",
    "start": "249790",
    "end": "252040"
  },
  {
    "text": "is ESI includes ESI includes here you",
    "start": "252040",
    "end": "254680"
  },
  {
    "text": "have a very brief example so you have",
    "start": "254680",
    "end": "256570"
  },
  {
    "text": "two pages sitting on two different",
    "start": "256570",
    "end": "257950"
  },
  {
    "text": "servers so you have page one that HTML",
    "start": "257950",
    "end": "260169"
  },
  {
    "text": "and then page two that HTML you can see",
    "start": "260169",
    "end": "262479"
  },
  {
    "text": "in page one you have an ESI include",
    "start": "262479",
    "end": "264430"
  },
  {
    "text": "point",
    "start": "264430",
    "end": "264920"
  },
  {
    "text": "to page 2 that HTML now here two things",
    "start": "264920",
    "end": "267800"
  },
  {
    "text": "can happen you can have a cache miss or",
    "start": "267800",
    "end": "270350"
  },
  {
    "text": "you can have a cache hit",
    "start": "270350",
    "end": "271610"
  },
  {
    "text": "so if page two is already known to the",
    "start": "271610",
    "end": "274310"
  },
  {
    "text": "est engine it's just going to replace it",
    "start": "274310",
    "end": "277070"
  },
  {
    "text": "as is by filling the blank so it's gonna",
    "start": "277070",
    "end": "279140"
  },
  {
    "text": "remove the ESI inclu tag and it's gonna",
    "start": "279140",
    "end": "280880"
  },
  {
    "text": "replace it with the entry of the cache",
    "start": "280880",
    "end": "282800"
  },
  {
    "text": "the cache entry for page two if it's a",
    "start": "282800",
    "end": "285020"
  },
  {
    "text": "cache miss meaning the content of page",
    "start": "285020",
    "end": "287300"
  },
  {
    "text": "two is invalid or if the caching servers",
    "start": "287300",
    "end": "289520"
  },
  {
    "text": "never seen that file it's gonna request",
    "start": "289520",
    "end": "292010"
  },
  {
    "text": "this file it's gonna gonna do a get",
    "start": "292010",
    "end": "294920"
  },
  {
    "text": "request on slash API slash",
    "start": "294920",
    "end": "297020"
  },
  {
    "text": "page two of HTML so when you request",
    "start": "297020",
    "end": "299060"
  },
  {
    "text": "page one either way you're gonna have",
    "start": "299060",
    "end": "300680"
  },
  {
    "text": "the content of page two and the HTTP",
    "start": "300680",
    "end": "302690"
  },
  {
    "text": "response now to illustrate how this",
    "start": "302690",
    "end": "304550"
  },
  {
    "text": "works let's look at a very brief diagram",
    "start": "304550",
    "end": "306650"
  },
  {
    "text": "so you have your clients your load",
    "start": "306650",
    "end": "307760"
  },
  {
    "text": "balancers and your application servers",
    "start": "307760",
    "end": "309440"
  },
  {
    "text": "so your clients is gonna send one that",
    "start": "309440",
    "end": "313250"
  },
  {
    "text": "HTML and the caching server since we're",
    "start": "313250",
    "end": "315230"
  },
  {
    "text": "looking at a cache miss is gonna send",
    "start": "315230",
    "end": "317690"
  },
  {
    "text": "their requests upstream now the",
    "start": "317690",
    "end": "319640"
  },
  {
    "text": "application server is gonna respond with",
    "start": "319640",
    "end": "321170"
  },
  {
    "text": "a ESI tag and the HTTP response the",
    "start": "321170",
    "end": "323810"
  },
  {
    "text": "application server since it's an issue",
    "start": "323810",
    "end": "327110"
  },
  {
    "text": "since the ESI tags are in the HTTP",
    "start": "327110",
    "end": "329750"
  },
  {
    "text": "response the load balancer knows to",
    "start": "329750",
    "end": "331640"
  },
  {
    "text": "parse them and the side requests for",
    "start": "331640",
    "end": "333650"
  },
  {
    "text": "page two is sent to the API server now",
    "start": "333650",
    "end": "336320"
  },
  {
    "text": "API response now step five and three can",
    "start": "336320",
    "end": "339410"
  },
  {
    "text": "be concatenated together before sending",
    "start": "339410",
    "end": "341060"
  },
  {
    "text": "it back to the client so this is ESI",
    "start": "341060",
    "end": "343580"
  },
  {
    "text": "foods now let's look at our second",
    "start": "343580",
    "end": "345230"
  },
  {
    "text": "features before delving into",
    "start": "345230",
    "end": "346430"
  },
  {
    "text": "exploitation you have ESI variables so",
    "start": "346430",
    "end": "349340"
  },
  {
    "text": "ESI variables are also pretty easy to",
    "start": "349340",
    "end": "351230"
  },
  {
    "text": "understand they're basically attribute",
    "start": "351230",
    "end": "353360"
  },
  {
    "text": "less ESI tags which will allow you to",
    "start": "353360",
    "end": "356420"
  },
  {
    "text": "expand information about the current",
    "start": "356420",
    "end": "358520"
  },
  {
    "text": "metadata of the HTTP transaction so you",
    "start": "358520",
    "end": "361100"
  },
  {
    "text": "usually have these sort of variables we",
    "start": "361100",
    "end": "363710"
  },
  {
    "text": "have access to HTTP user agent the query",
    "start": "363710",
    "end": "366470"
  },
  {
    "text": "string the cookies and basically this is",
    "start": "366470",
    "end": "369290"
  },
  {
    "text": "going to give you access to all of the",
    "start": "369290",
    "end": "371090"
  },
  {
    "text": "metadata in order to take decisions on",
    "start": "371090",
    "end": "372740"
  },
  {
    "text": "your caching efforts so for example if",
    "start": "372740",
    "end": "374870"
  },
  {
    "text": "you have a cookie for which the name is",
    "start": "374870",
    "end": "377750"
  },
  {
    "text": "language and its value is French then",
    "start": "377750",
    "end": "380270"
  },
  {
    "text": "you should probably do a es I include of",
    "start": "380270",
    "end": "382220"
  },
  {
    "text": "the French level of your organization so",
    "start": "382220",
    "end": "384200"
  },
  {
    "text": "that's just bravery for example so with",
    "start": "384200",
    "end": "386900"
  },
  {
    "text": "this knowledge we can start seeing where",
    "start": "386900",
    "end": "389330"
  },
  {
    "text": "the Bolar vulnerability is lie so we",
    "start": "389330",
    "end": "392030"
  },
  {
    "text": "know two things right now we know that",
    "start": "392030",
    "end": "393770"
  },
  {
    "text": "ESI tags are sent by the application",
    "start": "393770",
    "end": "395450"
  },
  {
    "text": "server we also know that they're sent",
    "start": "395450",
    "end": "397830"
  },
  {
    "text": "through the HTTP surrogate and that this",
    "start": "397830",
    "end": "400349"
  },
  {
    "text": "surrogate is going to parse those and",
    "start": "400349",
    "end": "401910"
  },
  {
    "text": "this leaves us with a very interesting",
    "start": "401910",
    "end": "404400"
  },
  {
    "text": "and dangerous question which is how can",
    "start": "404400",
    "end": "406020"
  },
  {
    "text": "the esight engine tell which tags are",
    "start": "406020",
    "end": "408569"
  },
  {
    "text": "legitimate and which tags are being",
    "start": "408569",
    "end": "410099"
  },
  {
    "text": "injected by a malicious user just like",
    "start": "410099",
    "end": "412530"
  },
  {
    "text": "cross-site scripting and that's a",
    "start": "412530",
    "end": "414300"
  },
  {
    "text": "problem it can't and that's a pretty big",
    "start": "414300",
    "end": "416940"
  },
  {
    "text": "design flaw so if you think about ESI",
    "start": "416940",
    "end": "419250"
  },
  {
    "text": "injection this snippet is vulnerable to",
    "start": "419250",
    "end": "421860"
  },
  {
    "text": "it because everything that is in the",
    "start": "421860",
    "end": "423360"
  },
  {
    "text": "city get parameter gets added to the",
    "start": "423360",
    "end": "425250"
  },
  {
    "text": "HTTP response so if someone puts ESI",
    "start": "425250",
    "end": "428550"
  },
  {
    "text": "variable pointing to the HTTP cookie",
    "start": "428550",
    "end": "430590"
  },
  {
    "text": "session ID",
    "start": "430590",
    "end": "431580"
  },
  {
    "text": "well the HTTP surrogate is going to look",
    "start": "431580",
    "end": "434490"
  },
  {
    "text": "at this and expand it and you're gonna",
    "start": "434490",
    "end": "436139"
  },
  {
    "text": "get that rated that answer back that's",
    "start": "436139",
    "end": "438930"
  },
  {
    "text": "pretty dangerous considering that PHP",
    "start": "438930",
    "end": "440580"
  },
  {
    "text": "session ID if you've done any PHP is",
    "start": "440580",
    "end": "442940"
  },
  {
    "text": "HTTP only cooking meaning you can",
    "start": "442940",
    "end": "446520"
  },
  {
    "text": "probably do session theft so to do that",
    "start": "446520",
    "end": "450240"
  },
  {
    "text": "we'll look at our first ESI",
    "start": "450240",
    "end": "451650"
  },
  {
    "text": "implementation Apache traffic server so",
    "start": "451650",
    "end": "454650"
  },
  {
    "text": "I looked at Apache traffic server for",
    "start": "454650",
    "end": "456659"
  },
  {
    "text": "two reasons",
    "start": "456659",
    "end": "457520"
  },
  {
    "text": "first of all because it's used by",
    "start": "457520",
    "end": "459479"
  },
  {
    "text": "high-profile organizations so that's",
    "start": "459479",
    "end": "461159"
  },
  {
    "text": "always a plus so I know for a fact that",
    "start": "461159",
    "end": "463289"
  },
  {
    "text": "yeah we'll use it and show them also",
    "start": "463289",
    "end": "465599"
  },
  {
    "text": "talked about Apple and Comcast that's",
    "start": "465599",
    "end": "468150"
  },
  {
    "text": "yet to be confirmed so I looked also at",
    "start": "468150",
    "end": "471979"
  },
  {
    "text": "80s for another reason which is they",
    "start": "471979",
    "end": "474960"
  },
  {
    "text": "added all of the ESI specification and",
    "start": "474960",
    "end": "477599"
  },
  {
    "text": "the added bonus features some of her",
    "start": "477599",
    "end": "480180"
  },
  {
    "text": "interesting and one of it one of the",
    "start": "480180",
    "end": "482159"
  },
  {
    "text": "feature is cookie whitelisting which",
    "start": "482159",
    "end": "484020"
  },
  {
    "text": "might sound like a great idea because if",
    "start": "484020",
    "end": "486539"
  },
  {
    "text": "you have ESI injection you can just",
    "start": "486539",
    "end": "488639"
  },
  {
    "text": "refer to the PHP session I mean it's",
    "start": "488639",
    "end": "490590"
  },
  {
    "text": "going to return nothing however by",
    "start": "490590",
    "end": "493259"
  },
  {
    "text": "looking at the documentation you'll also",
    "start": "493259",
    "end": "494639"
  },
  {
    "text": "see that there's a new variable called",
    "start": "494639",
    "end": "496169"
  },
  {
    "text": "HTTP header which allows you to refer to",
    "start": "496169",
    "end": "499530"
  },
  {
    "text": "the HTTP header cookie meaning that you",
    "start": "499530",
    "end": "502199"
  },
  {
    "text": "can effectively bypass they quickly",
    "start": "502199",
    "end": "503940"
  },
  {
    "text": "whitelist thing altogether",
    "start": "503940",
    "end": "505289"
  },
  {
    "text": "so that's a pretty big oversight so that",
    "start": "505289",
    "end": "509009"
  },
  {
    "text": "was report and fix two months ago and it",
    "start": "509009",
    "end": "511020"
  },
  {
    "text": "basically allows you to do the SI",
    "start": "511020",
    "end": "513360"
  },
  {
    "text": "injection leveraging could keep",
    "start": "513360",
    "end": "515839"
  },
  {
    "text": "basically stealing cookies so for that",
    "start": "515839",
    "end": "518399"
  },
  {
    "text": "let's do a proof of concept with Apache",
    "start": "518399",
    "end": "520110"
  },
  {
    "text": "traffic server so I built the following",
    "start": "520110",
    "end": "523380"
  },
  {
    "text": "payload however you can use multiple",
    "start": "523380",
    "end": "524970"
  },
  {
    "text": "pills they're all going to work so I",
    "start": "524970",
    "end": "526650"
  },
  {
    "text": "built an image tag that is pointing to",
    "start": "526650",
    "end": "528660"
  },
  {
    "text": "my attacker enable server so a",
    "start": "528660",
    "end": "530560"
  },
  {
    "text": "local for which the filename that is",
    "start": "530560",
    "end": "533499"
  },
  {
    "text": "going to be requested by the victim's",
    "start": "533499",
    "end": "534939"
  },
  {
    "text": "browser is an ESI tag this tag of course",
    "start": "534939",
    "end": "537699"
  },
  {
    "text": "is basically going to reference to the",
    "start": "537699",
    "end": "540009"
  },
  {
    "text": "victims cookies now once this tag is",
    "start": "540009",
    "end": "542800"
  },
  {
    "text": "sent by the application server to the",
    "start": "542800",
    "end": "544509"
  },
  {
    "text": "traffic server the traffic server is",
    "start": "544509",
    "end": "546579"
  },
  {
    "text": "going to expand it to the user session",
    "start": "546579",
    "end": "548139"
  },
  {
    "text": "cookie and so the browser is gonna",
    "start": "548139",
    "end": "550360"
  },
  {
    "text": "request this file thinking an image is",
    "start": "550360",
    "end": "552550"
  },
  {
    "text": "sitting there so let's look at our first",
    "start": "552550",
    "end": "555730"
  },
  {
    "text": "demonstration so about the videos it's",
    "start": "555730",
    "end": "557589"
  },
  {
    "text": "safer so we have a very basic website",
    "start": "557589",
    "end": "562240"
  },
  {
    "text": "that I built you have two browsers so on",
    "start": "562240",
    "end": "564970"
  },
  {
    "text": "the left hand side you have your victim",
    "start": "564970",
    "end": "566529"
  },
  {
    "text": "on the right hand side you have the",
    "start": "566529",
    "end": "567790"
  },
  {
    "text": "attacker in the middle you have all of",
    "start": "567790",
    "end": "570279"
  },
  {
    "text": "the database content for the messages",
    "start": "570279",
    "end": "572050"
  },
  {
    "text": "because it's a message board so you can",
    "start": "572050",
    "end": "573759"
  },
  {
    "text": "see what the data looks before",
    "start": "573759",
    "end": "575079"
  },
  {
    "text": "transiting through the cache server on",
    "start": "575079",
    "end": "577209"
  },
  {
    "text": "the bottom side you have evil the local",
    "start": "577209",
    "end": "579579"
  },
  {
    "text": "so basically all of the get requests are",
    "start": "579579",
    "end": "581290"
  },
  {
    "text": "gonna be printed there so now our victim",
    "start": "581290",
    "end": "584319"
  },
  {
    "text": "is gonna use the website just to show it",
    "start": "584319",
    "end": "585879"
  },
  {
    "text": "looks the victim sent message now the",
    "start": "585879",
    "end": "589689"
  },
  {
    "text": "attacker is gonna put the payload that",
    "start": "589689",
    "end": "593110"
  },
  {
    "text": "we just looked at so basically our image",
    "start": "593110",
    "end": "596319"
  },
  {
    "text": "tag that is pointing to evil the local",
    "start": "596319",
    "end": "598990"
  },
  {
    "text": "for which the file name is gonna be",
    "start": "598990",
    "end": "600970"
  },
  {
    "text": "anyone's session cookie so we refer to",
    "start": "600970",
    "end": "604329"
  },
  {
    "text": "the HTTP header cookie and we send the",
    "start": "604329",
    "end": "607870"
  },
  {
    "text": "payload and you can see and the database",
    "start": "607870",
    "end": "613329"
  },
  {
    "text": "wants it sent you have the ESI variable",
    "start": "613329",
    "end": "615309"
  },
  {
    "text": "that is going to be stored in the",
    "start": "615309",
    "end": "616420"
  },
  {
    "text": "database as expected now by sending the",
    "start": "616420",
    "end": "619269"
  },
  {
    "text": "payload the attacker effectively",
    "start": "619269",
    "end": "620800"
  },
  {
    "text": "attacked themselves so we're gonna",
    "start": "620800",
    "end": "622360"
  },
  {
    "text": "receive a CPA request right here with",
    "start": "622360",
    "end": "625089"
  },
  {
    "text": "our own session cookie now we're gonna",
    "start": "625089",
    "end": "627819"
  },
  {
    "text": "wait for the victim to refresh the page",
    "start": "627819",
    "end": "630100"
  },
  {
    "text": "so that they attack themselves and we're",
    "start": "630100",
    "end": "635709"
  },
  {
    "text": "gonna get a response back so now we have",
    "start": "635709",
    "end": "639429"
  },
  {
    "text": "the session cookie for the victim and",
    "start": "639429",
    "end": "641199"
  },
  {
    "text": "we're able to take over their session so",
    "start": "641199",
    "end": "643209"
  },
  {
    "text": "we're gonna look at all of our cookies",
    "start": "643209",
    "end": "644740"
  },
  {
    "text": "right now and we confirm that session",
    "start": "644740",
    "end": "646720"
  },
  {
    "text": "cookie is HTTP only meaning that",
    "start": "646720",
    "end": "648550"
  },
  {
    "text": "javascript could not have accessed that",
    "start": "648550",
    "end": "649929"
  },
  {
    "text": "cookie we're gonna replace our own value",
    "start": "649929",
    "end": "653259"
  },
  {
    "text": "with the one that we just stole we're",
    "start": "653259",
    "end": "657459"
  },
  {
    "text": "gonna save and refresh and there you go",
    "start": "657459",
    "end": "664329"
  },
  {
    "text": "we just did JavaScript last session",
    "start": "664329",
    "end": "666160"
  },
  {
    "text": "hijacking using ESI injection okay let's",
    "start": "666160",
    "end": "671619"
  },
  {
    "text": "just go back here okay so yeah so we now",
    "start": "671619",
    "end": "676629"
  },
  {
    "text": "we can now we know we can inject ESI",
    "start": "676629",
    "end": "678160"
  },
  {
    "text": "tags we can leak HTTP only cookies and",
    "start": "678160",
    "end": "680019"
  },
  {
    "text": "we don't even need JavaScript but just",
    "start": "680019",
    "end": "682420"
  },
  {
    "text": "like XSS it's a bit boring because well",
    "start": "682420",
    "end": "685720"
  },
  {
    "text": "we have to wait until the victim reaches",
    "start": "685720",
    "end": "687790"
  },
  {
    "text": "a very specific webpage for example if",
    "start": "687790",
    "end": "690369"
  },
  {
    "text": "you find an XSS on an obscure web pages",
    "start": "690369",
    "end": "692319"
  },
  {
    "text": "which is a feature that no one uses well",
    "start": "692319",
    "end": "694299"
  },
  {
    "text": "you can't exactly leverage this so let's",
    "start": "694299",
    "end": "696670"
  },
  {
    "text": "try to crack the impact up a notch so",
    "start": "696670",
    "end": "699459"
  },
  {
    "text": "the second feature that I looked at is",
    "start": "699459",
    "end": "701350"
  },
  {
    "text": "our cold web cache or Club cache is also",
    "start": "701350",
    "end": "704499"
  },
  {
    "text": "a high profile target to me Oracle and",
    "start": "704499",
    "end": "706709"
  },
  {
    "text": "they also implemented bonus features",
    "start": "706709",
    "end": "709119"
  },
  {
    "text": "some of which are singly dangerous so",
    "start": "709119",
    "end": "712089"
  },
  {
    "text": "the first one that I am that was",
    "start": "712089",
    "end": "714309"
  },
  {
    "text": "interested in interested in is the ESI",
    "start": "714309",
    "end": "716529"
  },
  {
    "text": "online time the e-sign line tag allows",
    "start": "716529",
    "end": "719439"
  },
  {
    "text": "you to take an arbitrary cache entry and",
    "start": "719439",
    "end": "721749"
  },
  {
    "text": "replace its content what could go wrong",
    "start": "721749",
    "end": "724059"
  },
  {
    "text": "so here you have jQuery the jas that is",
    "start": "724059",
    "end": "727959"
  },
  {
    "text": "going to be sent in the ESI online tag",
    "start": "727959",
    "end": "729699"
  },
  {
    "text": "and the content of the tags is the",
    "start": "729699",
    "end": "731980"
  },
  {
    "text": "content that you want inside of that",
    "start": "731980",
    "end": "733660"
  },
  {
    "text": "entry so here two things are gonna",
    "start": "733660",
    "end": "735610"
  },
  {
    "text": "happen right so you have jquery.js",
    "start": "735610",
    "end": "737319"
  },
  {
    "text": "it's gonna get overwritten with the",
    "start": "737319",
    "end": "739360"
  },
  {
    "text": "content here and as you can see the",
    "start": "739360",
    "end": "740919"
  },
  {
    "text": "highlighted payload is basically just an",
    "start": "740919",
    "end": "742419"
  },
  {
    "text": "ajax request",
    "start": "742419",
    "end": "743230"
  },
  {
    "text": "so an a synchronous get request to my",
    "start": "743230",
    "end": "746019"
  },
  {
    "text": "server which is able to local and then",
    "start": "746019",
    "end": "748360"
  },
  {
    "text": "the second thing that's gonna happen is",
    "start": "748360",
    "end": "749649"
  },
  {
    "text": "that every time someone requests a query",
    "start": "749649",
    "end": "751509"
  },
  {
    "text": "that j/s this ESI variable is going to",
    "start": "751509",
    "end": "753879"
  },
  {
    "text": "be expended which is going to be sending",
    "start": "753879",
    "end": "755919"
  },
  {
    "text": "their own session cookie now we don't",
    "start": "755919",
    "end": "758439"
  },
  {
    "text": "have any white listing on this vendor so",
    "start": "758439",
    "end": "760899"
  },
  {
    "text": "don't have to find any tricks to refer",
    "start": "760899",
    "end": "763149"
  },
  {
    "text": "to the cookie so this is gonna be the",
    "start": "763149",
    "end": "765489"
  },
  {
    "text": "URL that every single browser using",
    "start": "765489",
    "end": "767559"
  },
  {
    "text": "their website is gonna send me this is",
    "start": "767559",
    "end": "770499"
  },
  {
    "text": "their session cookie which is HTTP only",
    "start": "770499",
    "end": "772749"
  },
  {
    "text": "once again so let's look at our",
    "start": "772749",
    "end": "774790"
  },
  {
    "text": "demonstration so we basically have the",
    "start": "774790",
    "end": "777579"
  },
  {
    "text": "same website right but now it's super",
    "start": "777579",
    "end": "779619"
  },
  {
    "text": "safe because the system in added HTML",
    "start": "779619",
    "end": "783759"
  },
  {
    "text": "encoding and since it's the same sites",
    "start": "783759",
    "end": "787059"
  },
  {
    "text": "are the same char set the",
    "start": "787059",
    "end": "789199"
  },
  {
    "text": "ESI is no longer violent now you can see",
    "start": "789199",
    "end": "792139"
  },
  {
    "text": "in the Dom we also have jquery.js that",
    "start": "792139",
    "end": "794959"
  },
  {
    "text": "is being requested on every single page",
    "start": "794959",
    "end": "796699"
  },
  {
    "text": "meaning that if I'm able to replace this",
    "start": "796699",
    "end": "798589"
  },
  {
    "text": "file I'm going to attack every single",
    "start": "798589",
    "end": "800389"
  },
  {
    "text": "user of the website so jQuery is working",
    "start": "800389",
    "end": "802879"
  },
  {
    "text": "fine now our attacker is going to look",
    "start": "802879",
    "end": "805459"
  },
  {
    "text": "to see if the HTML char set is available",
    "start": "805459",
    "end": "808660"
  },
  {
    "text": "notice is that now their HTML encoding",
    "start": "808660",
    "end": "811220"
  },
  {
    "text": "so they basically mitigated es I now our",
    "start": "811220",
    "end": "814970"
  },
  {
    "text": "user is going to see that there's a new",
    "start": "814970",
    "end": "816410"
  },
  {
    "text": "feature called the user list so the user",
    "start": "816410",
    "end": "818959"
  },
  {
    "text": "list has a search feature for which",
    "start": "818959",
    "end": "820939"
  },
  {
    "text": "everything that is put into the search",
    "start": "820939",
    "end": "822859"
  },
  {
    "text": "is echoed in the HTTP response so that",
    "start": "822859",
    "end": "825679"
  },
  {
    "text": "could be a good vector for ESI injection",
    "start": "825679",
    "end": "827299"
  },
  {
    "text": "because it's going to go through the",
    "start": "827299",
    "end": "828350"
  },
  {
    "text": "caching server so we're gonna test for",
    "start": "828350",
    "end": "830559"
  },
  {
    "text": "HTML entities and they're not escape so",
    "start": "830559",
    "end": "833149"
  },
  {
    "text": "that's pretty a pretty good example of",
    "start": "833149",
    "end": "834980"
  },
  {
    "text": "where I can do",
    "start": "834980",
    "end": "835910"
  },
  {
    "text": "ESI injection so we're gonna take our",
    "start": "835910",
    "end": "838399"
  },
  {
    "text": "payload which is the same one that we",
    "start": "838399",
    "end": "839809"
  },
  {
    "text": "just looked at so jQuery digest is gonna",
    "start": "839809",
    "end": "842059"
  },
  {
    "text": "be overwritten we put it there and then",
    "start": "842059",
    "end": "844609"
  },
  {
    "text": "we press submit and it should be good",
    "start": "844609",
    "end": "847730"
  },
  {
    "text": "now jQuery digest should be overwritten",
    "start": "847730",
    "end": "849619"
  },
  {
    "text": "so now our victim is going to refresh",
    "start": "849619",
    "end": "851389"
  },
  {
    "text": "the page and you can see the files been",
    "start": "851389",
    "end": "854389"
  },
  {
    "text": "overwritten with the ajax query that we",
    "start": "854389",
    "end": "856160"
  },
  {
    "text": "just looked at now we're gonna make the",
    "start": "856160",
    "end": "858799"
  },
  {
    "text": "victim refresh any page on the website",
    "start": "858799",
    "end": "861220"
  },
  {
    "text": "jquery the JS has now changed so the",
    "start": "861220",
    "end": "864079"
  },
  {
    "text": "cache is invalidated so the user is",
    "start": "864079",
    "end": "865669"
  },
  {
    "text": "going to request the file and we",
    "start": "865669",
    "end": "868129"
  },
  {
    "text": "obtained their cookie so now we can do",
    "start": "868129",
    "end": "870309"
  },
  {
    "text": "basically we can overwrite any file on",
    "start": "870309",
    "end": "872360"
  },
  {
    "text": "the web server and now we just so",
    "start": "872360",
    "end": "873949"
  },
  {
    "text": "basically the recession i'm not going to",
    "start": "873949",
    "end": "875569"
  },
  {
    "text": "go through the whole stealing",
    "start": "875569",
    "end": "878119"
  },
  {
    "text": "intercession changing the cookie because",
    "start": "878119",
    "end": "879379"
  },
  {
    "text": "you saw that already but basically we",
    "start": "879379",
    "end": "881119"
  },
  {
    "text": "just did arbitrary right of caching",
    "start": "881119",
    "end": "885410"
  },
  {
    "text": "trees and also we can leave HTTP cookies",
    "start": "885410",
    "end": "889299"
  },
  {
    "text": "so javascript helped here it's not",
    "start": "889299",
    "end": "891769"
  },
  {
    "text": "required you can use anything basically",
    "start": "891769",
    "end": "893509"
  },
  {
    "text": "you can just do like rewrite index.html",
    "start": "893509",
    "end": "896689"
  },
  {
    "text": "that works fine alright so that's pretty",
    "start": "896689",
    "end": "899839"
  },
  {
    "text": "dangerous so how do you mitigate this so",
    "start": "899839",
    "end": "903619"
  },
  {
    "text": "if you're using not security which",
    "start": "903619",
    "end": "905359"
  },
  {
    "text": "you're probably already using some of",
    "start": "905359",
    "end": "907429"
  },
  {
    "text": "you be sure to have the core rule set",
    "start": "907429",
    "end": "909949"
  },
  {
    "text": "from OS so this is gonna leverage",
    "start": "909949",
    "end": "912079"
  },
  {
    "text": "basically Mott security in order to",
    "start": "912079",
    "end": "914419"
  },
  {
    "text": "escape HTML so",
    "start": "914419",
    "end": "916100"
  },
  {
    "text": "any HTML tag is going to be escaped and",
    "start": "916100",
    "end": "918040"
  },
  {
    "text": "since it's the same char set as ESI well",
    "start": "918040",
    "end": "921079"
  },
  {
    "text": "you're good however you also have to do",
    "start": "921079",
    "end": "924320"
  },
  {
    "text": "proactive escaping when you think about",
    "start": "924320",
    "end": "926990"
  },
  {
    "text": "it a JSON response has no real reason to",
    "start": "926990",
    "end": "930709"
  },
  {
    "text": "have their HTML encoded or escaped",
    "start": "930709",
    "end": "934490"
  },
  {
    "text": "because the browser already knows",
    "start": "934490",
    "end": "936259"
  },
  {
    "text": "through the content type not to evaluate",
    "start": "936259",
    "end": "938389"
  },
  {
    "text": "it but I'm not attacking web servers I'm",
    "start": "938389",
    "end": "941180"
  },
  {
    "text": "not attacking clients I mean I'm",
    "start": "941180",
    "end": "942709"
  },
  {
    "text": "attacking caching servers so I'm able to",
    "start": "942709",
    "end": "945139"
  },
  {
    "text": "put ESI tags in there and some ESI",
    "start": "945139",
    "end": "947660"
  },
  {
    "text": "implementations will let me do that",
    "start": "947660",
    "end": "949579"
  },
  {
    "text": "now here of course have a small problem",
    "start": "949579",
    "end": "951529"
  },
  {
    "text": "meaning I have invalid asi tags because",
    "start": "951529",
    "end": "954709"
  },
  {
    "text": "double quotes right however ESI",
    "start": "954709",
    "end": "957860"
  },
  {
    "text": "implementations have a flexible syntax",
    "start": "957860",
    "end": "960040"
  },
  {
    "text": "so for example how about your traffic",
    "start": "960040",
    "end": "962329"
  },
  {
    "text": "server will allow me to just drop the",
    "start": "962329",
    "end": "963980"
  },
  {
    "text": "little codes and it's just fine so you",
    "start": "963980",
    "end": "966860"
  },
  {
    "text": "can do server side request forgery right",
    "start": "966860",
    "end": "968509"
  },
  {
    "text": "so here's effective arrest API so we",
    "start": "968509",
    "end": "971089"
  },
  {
    "text": "have API slash me for which my full name",
    "start": "971089",
    "end": "973490"
  },
  {
    "text": "has a response is Luigi amatsu",
    "start": "973490",
    "end": "976009"
  },
  {
    "text": "now I can change that value for ESI",
    "start": "976009",
    "end": "978649"
  },
  {
    "text": "include tag without double quotes and",
    "start": "978649",
    "end": "980779"
  },
  {
    "text": "that server is gonna send it back in the",
    "start": "980779",
    "end": "982639"
  },
  {
    "text": "response now since there's a ESI engine",
    "start": "982639",
    "end": "985519"
  },
  {
    "text": "sitting on top of that it's gonna go",
    "start": "985519",
    "end": "987440"
  },
  {
    "text": "fetch this file for me because it thinks",
    "start": "987440",
    "end": "989569"
  },
  {
    "text": "the web cache is being instructed to",
    "start": "989569",
    "end": "992720"
  },
  {
    "text": "query this file mmm so I changed the",
    "start": "992720",
    "end": "996529"
  },
  {
    "text": "content type to HTML just to better",
    "start": "996529",
    "end": "998420"
  },
  {
    "text": "illustrate how that works so you have",
    "start": "998420",
    "end": "999800"
  },
  {
    "text": "the green the green area which is",
    "start": "999800",
    "end": "1001449"
  },
  {
    "text": "basically the JSON payload and then the",
    "start": "1001449",
    "end": "1003279"
  },
  {
    "text": "reddish area is the es I include for",
    "start": "1003279",
    "end": "1005079"
  },
  {
    "text": "which we use to do server side request",
    "start": "1005079",
    "end": "1006730"
  },
  {
    "text": "forgery so to reuse the same graphic",
    "start": "1006730",
    "end": "1008860"
  },
  {
    "text": "this is basically what happened right so",
    "start": "1008860",
    "end": "1010630"
  },
  {
    "text": "we have slash mean for which we had a",
    "start": "1010630",
    "end": "1012910"
  },
  {
    "text": "response with a ESI tag in there the",
    "start": "1012910",
    "end": "1015819"
  },
  {
    "text": "caching server saw that and requested",
    "start": "1015819",
    "end": "1017920"
  },
  {
    "text": "server status status on a different",
    "start": "1017920",
    "end": "1019870"
  },
  {
    "text": "server we got the response back step",
    "start": "1019870",
    "end": "1021910"
  },
  {
    "text": "five and three get concatenated and sent",
    "start": "1021910",
    "end": "1024069"
  },
  {
    "text": "to the user now you have to keep in mind",
    "start": "1024069",
    "end": "1026140"
  },
  {
    "text": "that almost what most ESI engines will",
    "start": "1026140",
    "end": "1030040"
  },
  {
    "text": "only do ESI request for preemptively",
    "start": "1030040",
    "end": "1033850"
  },
  {
    "text": "whitelist at hosts meaning that when you",
    "start": "1033850",
    "end": "1036640"
  },
  {
    "text": "configure ESI you're gonna have to say",
    "start": "1036640",
    "end": "1039220"
  },
  {
    "text": "I'm allowed to do a assign cludes of XYZ",
    "start": "1039220",
    "end": "1042459"
  },
  {
    "text": "server so if you're not requesting XYZ",
    "start": "1042459",
    "end": "1045610"
  },
  {
    "text": "you're not going to",
    "start": "1045610",
    "end": "1046558"
  },
  {
    "text": "anything back however a lot of them are",
    "start": "1046559",
    "end": "1048329"
  },
  {
    "text": "also going to allow you to just do ESI",
    "start": "1048329",
    "end": "1050549"
  },
  {
    "text": "include basically anything such as squid",
    "start": "1050549",
    "end": "1053159"
  },
  {
    "text": "and language specific implementations",
    "start": "1053159",
    "end": "1055320"
  },
  {
    "text": "like no Jess implementations of ESI so",
    "start": "1055320",
    "end": "1058049"
  },
  {
    "text": "to perform manual detection someone on",
    "start": "1058049",
    "end": "1060330"
  },
  {
    "text": "Twitter called addicts myths non came up",
    "start": "1060330",
    "end": "1061860"
  },
  {
    "text": "with a pretty smart solution so he's",
    "start": "1061860",
    "end": "1063570"
  },
  {
    "text": "leveraging ESI comments so if you sent",
    "start": "1063570",
    "end": "1066120"
  },
  {
    "text": "to ESI payload which is a Yi si comment",
    "start": "1066120",
    "end": "1068519"
  },
  {
    "text": "and it gets removed that's a pretty big",
    "start": "1068519",
    "end": "1070919"
  },
  {
    "text": "indication that you're doing with ESI if",
    "start": "1070919",
    "end": "1073169"
  },
  {
    "text": "you want to really confirm that it's an",
    "start": "1073169",
    "end": "1075149"
  },
  {
    "text": "actual ESI server you can do the same",
    "start": "1075149",
    "end": "1077190"
  },
  {
    "text": "thing but instead of ESI but something",
    "start": "1077190",
    "end": "1078990"
  },
  {
    "text": "else you are it doesn't matter if this",
    "start": "1078990",
    "end": "1081570"
  },
  {
    "text": "does come back then you're probably",
    "start": "1081570",
    "end": "1083610"
  },
  {
    "text": "messing with the ESI server and you",
    "start": "1083610",
    "end": "1085440"
  },
  {
    "text": "should start fingerprinting it if you",
    "start": "1085440",
    "end": "1087869"
  },
  {
    "text": "don't want to mess with metal detection",
    "start": "1087869",
    "end": "1089039"
  },
  {
    "text": "you can use either of these three tools",
    "start": "1089039",
    "end": "1090570"
  },
  {
    "text": "I know for a fact that active active",
    "start": "1090570",
    "end": "1093269"
  },
  {
    "text": "scan plus plus in the uploads counter",
    "start": "1093269",
    "end": "1094860"
  },
  {
    "text": "are gonna use this heuristic I can it",
    "start": "1094860",
    "end": "1096659"
  },
  {
    "text": "takes however I don't know how they find",
    "start": "1096659",
    "end": "1098909"
  },
  {
    "text": "it I just know that they claim that they",
    "start": "1098909",
    "end": "1100590"
  },
  {
    "text": "do if you want to use something like ESI",
    "start": "1100590",
    "end": "1105149"
  },
  {
    "text": "but you're not exactly sure that this is",
    "start": "1105149",
    "end": "1108090"
  },
  {
    "text": "a safe solution you can use something",
    "start": "1108090",
    "end": "1110340"
  },
  {
    "text": "that Lucas Rider on Twitter came up with",
    "start": "1110340",
    "end": "1112499"
  },
  {
    "text": "so basically he leveraged clout pair",
    "start": "1112499",
    "end": "1115409"
  },
  {
    "text": "workers clapping workers are a",
    "start": "1115409",
    "end": "1117389"
  },
  {
    "text": "JavaScript file sitting on edge servers",
    "start": "1117389",
    "end": "1119249"
  },
  {
    "text": "of course you have to use cloud player",
    "start": "1119249",
    "end": "1120690"
  },
  {
    "text": "to use this and you can use fragments as",
    "start": "1120690",
    "end": "1123119"
  },
  {
    "text": "well so in your response you're allowed",
    "start": "1123119",
    "end": "1125999"
  },
  {
    "text": "to have fragments so here you have a",
    "start": "1125999",
    "end": "1127799"
  },
  {
    "text": "fragment pointing to footer but the",
    "start": "1127799",
    "end": "1129749"
  },
  {
    "text": "source is not in the response its sent",
    "start": "1129749",
    "end": "1132119"
  },
  {
    "text": "and the HTTP header now if you've done",
    "start": "1132119",
    "end": "1134700"
  },
  {
    "text": "any sort of web app and testing in the",
    "start": "1134700",
    "end": "1136710"
  },
  {
    "text": "past five to ten years you'll know that",
    "start": "1136710",
    "end": "1138559"
  },
  {
    "text": "HTTP response injection is not exactly",
    "start": "1138559",
    "end": "1141720"
  },
  {
    "text": "common it's much harder to do so this is",
    "start": "1141720",
    "end": "1143999"
  },
  {
    "text": "a much safer alternative and it's",
    "start": "1143999",
    "end": "1145440"
  },
  {
    "text": "probably even faster so modern ESI I",
    "start": "1145440",
    "end": "1148860"
  },
  {
    "text": "would call this a modern ESI",
    "start": "1148860",
    "end": "1150419"
  },
  {
    "text": "implementation and it's just a whole lot",
    "start": "1150419",
    "end": "1152549"
  },
  {
    "text": "safer like you can inject variables that",
    "start": "1152549",
    "end": "1155970"
  },
  {
    "text": "leaks your cookies so basically this is",
    "start": "1155970",
    "end": "1158850"
  },
  {
    "text": "a brief introduction to what ESI is",
    "start": "1158850",
    "end": "1161059"
  },
  {
    "text": "obviously there's still a lot of",
    "start": "1161059",
    "end": "1163080"
  },
  {
    "text": "research to be done on the topic you can",
    "start": "1163080",
    "end": "1165240"
  },
  {
    "text": "check our blog post for which we",
    "start": "1165240",
    "end": "1166559"
  },
  {
    "text": "released in April none of this material",
    "start": "1166559",
    "end": "1169350"
  },
  {
    "text": "was covered in the blog post this is",
    "start": "1169350",
    "end": "1170940"
  },
  {
    "text": "merely an extension of this research in",
    "start": "1170940",
    "end": "1173820"
  },
  {
    "text": "our",
    "start": "1173820",
    "end": "1174330"
  },
  {
    "text": "cause I think we looked at six",
    "start": "1174330",
    "end": "1175980"
  },
  {
    "text": "implementations of ESI and some of which",
    "start": "1175980",
    "end": "1178019"
  },
  {
    "text": "are Akamai websphere fastly squid-like",
    "start": "1178019",
    "end": "1181380"
  },
  {
    "text": "hold on to them we found a lot of",
    "start": "1181380",
    "end": "1183630"
  },
  {
    "text": "crashes like null defer answers for",
    "start": "1183630",
    "end": "1186299"
  },
  {
    "text": "squid that we found a header injection",
    "start": "1186299",
    "end": "1188659"
  },
  {
    "text": "for all mitosis filter bypass so there's",
    "start": "1188659",
    "end": "1193080"
  },
  {
    "text": "a lot of interesting stuff to be found",
    "start": "1193080",
    "end": "1194429"
  },
  {
    "text": "with there with this also please",
    "start": "1194429",
    "end": "1198720"
  },
  {
    "text": "remember that if you like exploiting",
    "start": "1198720",
    "end": "1200279"
  },
  {
    "text": "caching servers James kettle is gonna",
    "start": "1200279",
    "end": "1202110"
  },
  {
    "text": "give it a really good talk tomorrow",
    "start": "1202110",
    "end": "1203100"
  },
  {
    "text": "about that so keep that in mind",
    "start": "1203100",
    "end": "1206149"
  },
  {
    "text": "otherwise I could probably close with",
    "start": "1206149",
    "end": "1209250"
  },
  {
    "text": "where we found ESI so it's we found a",
    "start": "1209250",
    "end": "1212370"
  },
  {
    "text": "lot of ESI testing our own clients so I",
    "start": "1212370",
    "end": "1214799"
  },
  {
    "text": "can't exactly talk about that publicly",
    "start": "1214799",
    "end": "1216809"
  },
  {
    "text": "but a lot of newspaper or organizations",
    "start": "1216809",
    "end": "1220470"
  },
  {
    "text": "that became web enabled and like early",
    "start": "1220470",
    "end": "1224010"
  },
  {
    "text": "2000 are still diverging ESI not to say",
    "start": "1224010",
    "end": "1226860"
  },
  {
    "text": "that some are not employing ESI right",
    "start": "1226860",
    "end": "1228450"
  },
  {
    "text": "now it's still fairly popular but like",
    "start": "1228450",
    "end": "1230850"
  },
  {
    "text": "newspaper are usually leveraging yes I",
    "start": "1230850",
    "end": "1232769"
  },
  {
    "text": "for some reason we found IBM commerce",
    "start": "1232769",
    "end": "1236309"
  },
  {
    "text": "leveraging yet side the internals of",
    "start": "1236309",
    "end": "1239460"
  },
  {
    "text": "some Oracle products also use ESI if you",
    "start": "1239460",
    "end": "1243330"
  },
  {
    "text": "go on Twitter some people usually put",
    "start": "1243330",
    "end": "1245549"
  },
  {
    "text": "screenshots of where they find ESI",
    "start": "1245549",
    "end": "1247200"
  },
  {
    "text": "injections also I've had people that",
    "start": "1247200",
    "end": "1249750"
  },
  {
    "text": "work for a major bug Monty's company",
    "start": "1249750",
    "end": "1251760"
  },
  {
    "text": "told me that they've seen ESI injection",
    "start": "1251760",
    "end": "1253789"
  },
  {
    "text": "bug reports coming true so it's out",
    "start": "1253789",
    "end": "1256139"
  },
  {
    "text": "there it's just not exactly popular",
    "start": "1256139",
    "end": "1257789"
  },
  {
    "text": "enough to have a clear picture of where",
    "start": "1257789",
    "end": "1260010"
  },
  {
    "text": "si is used right now so I think we have",
    "start": "1260010",
    "end": "1262679"
  },
  {
    "text": "maybe four or three minutes for",
    "start": "1262679",
    "end": "1264929"
  },
  {
    "text": "questions otherwise if you want to talk",
    "start": "1264929",
    "end": "1267330"
  },
  {
    "text": "to me afterwards I'll be at the concert",
    "start": "1267330",
    "end": "1268710"
  },
  {
    "text": "AG go secure booths in the vendor area",
    "start": "1268710",
    "end": "1271370"
  },
  {
    "text": "so yeah questions there's microphones",
    "start": "1271370",
    "end": "1275580"
  },
  {
    "text": "right there or you can say it out loud",
    "start": "1275580",
    "end": "1278370"
  },
  {
    "text": "and I'll repeat but I'd much prefer you",
    "start": "1278370",
    "end": "1279600"
  },
  {
    "text": "use the microphone okay I'm not sure if",
    "start": "1279600",
    "end": "1284370"
  },
  {
    "text": "yeah if nginx",
    "start": "1284370",
    "end": "1286460"
  },
  {
    "text": "if I test nginx I'm not sure if and our",
    "start": "1286460",
    "end": "1289289"
  },
  {
    "text": "next largest yes I have no idea I",
    "start": "1289289",
    "end": "1290990"
  },
  {
    "text": "wouldn't be surprised that someone came",
    "start": "1290990",
    "end": "1293100"
  },
  {
    "text": "up with a module to leverage ESI on",
    "start": "1293100",
    "end": "1294690"
  },
  {
    "text": "nginx but I know I didn't look at",
    "start": "1294690",
    "end": "1298610"
  },
  {
    "text": "yes yeah",
    "start": "1300690",
    "end": "1305950"
  },
  {
    "text": "so there's burp active scan plus plus",
    "start": "1305950",
    "end": "1307960"
  },
  {
    "text": "burp uploads counter and a kinetics",
    "start": "1307960",
    "end": "1312360"
  },
  {
    "text": "think that's it",
    "start": "1314280",
    "end": "1317680"
  },
  {
    "text": "[Applause]",
    "start": "1317680",
    "end": "1322039"
  }
]