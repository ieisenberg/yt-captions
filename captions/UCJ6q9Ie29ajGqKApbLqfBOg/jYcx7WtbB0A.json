[
  {
    "start": "0",
    "end": "106000"
  },
  {
    "text": "good morning welcome to South Seas if that's not where you intended to",
    "start": "240",
    "end": "7520"
  },
  {
    "text": "be you remember where the door was so you can correct that you are here for a",
    "start": "7520",
    "end": "13799"
  },
  {
    "text": "talk entitled HTTP cookie hijacking in the wild security and privacy",
    "start": "13799",
    "end": "19760"
  },
  {
    "text": "implications and you're going to hear from safan sakorn and Jason",
    "start": "19760",
    "end": "26240"
  },
  {
    "text": "pakus and you guys can introduce your other author yeah uh before we begin a few brief notes be",
    "start": "26240",
    "end": "33399"
  },
  {
    "text": "sure to stop by the business Hall located in Bayside AB remember that the black hat Arsenal",
    "start": "33399",
    "end": "39680"
  },
  {
    "text": "is on in the Palm for you're on level three and of course the Arenal Arsenal reception at 1700 this evening if you",
    "start": "39680",
    "end": "47879"
  },
  {
    "text": "haven't picked up your merchandise today it's your last chance to visit the black hat swag and bookstore spend your",
    "start": "47879",
    "end": "55399"
  },
  {
    "text": "money don't forget to visit the Cali Linux lab in manderlay Bay a",
    "start": "55399",
    "end": "60800"
  },
  {
    "text": "and lastly thank you for putting your phone on vibrate which is a nice way of saying please put your phone on vibrate",
    "start": "60800",
    "end": "69000"
  },
  {
    "text": "because it makes it easier for the rest of us to ignore the ringing that won't occur because your phone is on vibrate",
    "start": "69000",
    "end": "74600"
  },
  {
    "text": "while you wait for your voicemail to pick it up when we get to the question part please do step up to the microphone",
    "start": "74600",
    "end": "80079"
  },
  {
    "text": "the talk is being recorded that way your question will be recorded and they won't have to repeat the question and spend",
    "start": "80079",
    "end": "85520"
  },
  {
    "text": "time doing that so without further Ado your speakers okay uh hi I'm Jason pakis thanks to uh",
    "start": "85520",
    "end": "94399"
  },
  {
    "text": "for attending our talk even though it's pretty early and there were quite a few parties yesterday so this work was done",
    "start": "94399",
    "end": "100360"
  },
  {
    "text": "jointly with suani and in collaboration with Professor Angelos kites that is not",
    "start": "100360",
    "end": "105439"
  },
  {
    "text": "here today so a little bit uh more information about who we are uh suani is",
    "start": "105439",
    "end": "110840"
  },
  {
    "start": "106000",
    "end": "106000"
  },
  {
    "text": "a PhD student uh at Columbia University entering her fourth year now and I spent",
    "start": "110840",
    "end": "116960"
  },
  {
    "text": "the past uh two two and a half years as a post talk are Colombia so we've been working together a lot and I just moved",
    "start": "116960",
    "end": "123719"
  },
  {
    "text": "to Chicago as an assistant professor at UIC so we've worked on uh various",
    "start": "123719",
    "end": "129640"
  },
  {
    "text": "projects of security and privacy uh interest but you might have uh come across our recent briefing at black hat",
    "start": "129640",
    "end": "136800"
  },
  {
    "text": "Asia about our analysis and attacks against Google's recapture system so I'm I'm going to try now and",
    "start": "136800",
    "end": "144280"
  },
  {
    "start": "142000",
    "end": "142000"
  },
  {
    "text": "give some uh like set the tone and the backdrop of uh the talk we're going to give so in the past year of so there's",
    "start": "144280",
    "end": "151440"
  },
  {
    "text": "been a massive public debate about the need for encryption and various entities",
    "start": "151440",
    "end": "156480"
  },
  {
    "text": "of course have been arguing about the need of introducing secure back doors uh in the crypto stuff that we use now of",
    "start": "156480",
    "end": "164040"
  },
  {
    "text": "course a lot of uh Security Professionals have been arguing against that for obvious reasons and at the same",
    "start": "164040",
    "end": "169959"
  },
  {
    "text": "time a lot of security researchers have been demonstrating that it's really hard to get crypto correct in the first place",
    "start": "169959",
    "end": "176360"
  },
  {
    "text": "even without introducing any backos and stuff however the thing is that even though the various attacks against a",
    "start": "176360",
    "end": "182959"
  },
  {
    "text": "cell TLS it Still Remains a fundamental uh tool for protecting our",
    "start": "182959",
    "end": "188280"
  },
  {
    "text": "Communications so is this talk going to be about encryption no it's not I'm sorry if that makes any of you sad but",
    "start": "188280",
    "end": "195920"
  },
  {
    "text": "this is going to be more about the lack of encryption so if we had to give a different title let's say to our work",
    "start": "195920",
    "end": "202040"
  },
  {
    "text": "and we imagined it as a story or a fairy tale I would probably call it web services and the Quest for ubiquitous",
    "start": "202040",
    "end": "208760"
  },
  {
    "text": "encryption now major spoiler this is unfortunately a very sad tell without a happy ending or depending if you're more",
    "start": "208760",
    "end": "216239"
  },
  {
    "text": "optimistic than myself and some stuff that have happened in the past five six days uh at the end of the talk you might",
    "start": "216239",
    "end": "222280"
  },
  {
    "text": "feel that we have a partially happy ending so a small overview of what we're",
    "start": "222280",
    "end": "227599"
  },
  {
    "start": "225000",
    "end": "225000"
  },
  {
    "text": "going to talk about today so at the beginning I'm going to give like a high level description of how some Services",
    "start": "227599",
    "end": "233560"
  },
  {
    "text": "have HTTP and enforce https connections and I'm going to talk about how the",
    "start": "233560",
    "end": "239000"
  },
  {
    "text": "unencrypted connections will actually expose various cookies that we can use and then in the main uh and most",
    "start": "239000",
    "end": "245640"
  },
  {
    "text": "interesting part of the uh talk suani will give you all the NY gritt details",
    "start": "245640",
    "end": "251159"
  },
  {
    "text": "about the services that we audited uh what type of cookie hijacking attacks we did and all the uh sensitive information",
    "start": "251159",
    "end": "257680"
  },
  {
    "text": "and account functionality that we can access and finally I'm going to talk a bit about various mechanisms that uh",
    "start": "257680",
    "end": "265000"
  },
  {
    "text": "have been deployed are accessible to end users that can actually uh prevent cookie hijacking now these defenses",
    "start": "265000",
    "end": "272240"
  },
  {
    "text": "haven't been designed for that per se but are ways that can enforce htps and as a side effect that can actually",
    "start": "272240",
    "end": "278560"
  },
  {
    "text": "prevent uh these HP cookies from being exposed now after I talk about those a bit I'll also talk about how in practice",
    "start": "278560",
    "end": "285440"
  },
  {
    "text": "for various deployment issues they actually fail and we can still uh see cookies being exposed that we can use",
    "start": "285440",
    "end": "291560"
  },
  {
    "text": "for our attacks so apart from uh the stuff that we're going to talk about today uh the",
    "start": "291560",
    "end": "297840"
  },
  {
    "start": "293000",
    "end": "293000"
  },
  {
    "text": "various negative effects of cookies have been explored in the past of course and there's been some really interesting uh",
    "start": "297840",
    "end": "304320"
  },
  {
    "text": "work in the past year so angle heart at all talked about how third-party cookies",
    "start": "304320",
    "end": "310400"
  },
  {
    "text": "uh that can be found on a large number of websites can lead to uh powerful adversaries being able to track users at",
    "start": "310400",
    "end": "316960"
  },
  {
    "text": "a massive scale and in a really interesting paper at usnick security they showed that even if we have cookies",
    "start": "316960",
    "end": "323319"
  },
  {
    "text": "at our set to secure a man in the middle could actually inject cookies through an hcp response which can lead to very",
    "start": "323319",
    "end": "330400"
  },
  {
    "text": "interesting uh attacks so I'm sure most of you are aware of what HP cookie hijacking is but",
    "start": "330400",
    "end": "337479"
  },
  {
    "text": "I'll give you uh a simple description of what uh we see in our paper so let's",
    "start": "337479",
    "end": "342960"
  },
  {
    "text": "consider that we have Bob who's at his favorite coffee shop uh drinking some coffee a sail lat whatever I don't know",
    "start": "342960",
    "end": "349319"
  },
  {
    "text": "they what they drink and he's uh doing some work and visiting his favorite uh",
    "start": "349319",
    "end": "354880"
  },
  {
    "text": "websites now unfortunately uh since this uh coffee shop has a free Wi-Fi everyone",
    "start": "354880",
    "end": "360560"
  },
  {
    "text": "can connect to it and anything that's unencrypted can actually be sniffed by someone so here comes our happy little",
    "start": "360560",
    "end": "367240"
  },
  {
    "text": "hacker who can see the various cookies being uh transported into the clear text",
    "start": "367240",
    "end": "372280"
  },
  {
    "text": "and can actually take them and then uh contact those same web services and append those cookies now the web service",
    "start": "372280",
    "end": "379120"
  },
  {
    "text": "of course will uh use those to identify the user and uh thinking that our attacker is actually Bob it will return",
    "start": "379120",
    "end": "386319"
  },
  {
    "text": "a personalized version of this website and that of course allow the attacker to get access to both very sensitive",
    "start": "386319",
    "end": "392599"
  },
  {
    "text": "information as well as protected account functionality now I know what some of",
    "start": "392599",
    "end": "398039"
  },
  {
    "text": "you might be thinking uh we know h2p cookie hijacking we known about it for years so why are we talking about in",
    "start": "398039",
    "end": "405720"
  },
  {
    "text": "2016 so it's true we've known about it for years especially in 2010 there was",
    "start": "405720",
    "end": "410840"
  },
  {
    "text": "massive publicity with a Fire Ship extension that showed how easy it could be to hijack accounts in services like",
    "start": "410840",
    "end": "417560"
  },
  {
    "text": "Facebook and Twitter and of course all this publicity was really good because it kind of spearheaded a migration to",
    "start": "417560",
    "end": "424599"
  },
  {
    "start": "422000",
    "end": "422000"
  },
  {
    "text": "HPS and lots of popular Services now in a recent uh in a recent study from the",
    "start": "424599",
    "end": "431280"
  },
  {
    "text": "SSO Paul's project they found that out of 140,000 websites that they looked at",
    "start": "431280",
    "end": "437360"
  },
  {
    "text": "approximately 40.5% actually supports htps okay that means it supports it",
    "start": "437360",
    "end": "443319"
  },
  {
    "text": "doesn't mean it has it everywhere on the website and that's something that's really uh important for the rest of the",
    "start": "443319",
    "end": "448599"
  },
  {
    "text": "talk so now I'm going to show a simple workflow of uh how many services tend to",
    "start": "448599",
    "end": "455680"
  },
  {
    "text": "uh enforce encrypted communication so we have our browser here and uh the web",
    "start": "455680",
    "end": "460720"
  },
  {
    "text": "server for one of the websites that we want to go to and let's consider an example for Google so I'll open up my",
    "start": "460720",
    "end": "468440"
  },
  {
    "text": "browser I'll usually just type google.com press enter and by default",
    "start": "468440",
    "end": "473960"
  },
  {
    "text": "the browser will assume that it should connect over HTTP so it's going to issue a get",
    "start": "473960",
    "end": "479560"
  },
  {
    "text": "request now since uh the server does support HPS it will actually send a",
    "start": "479560",
    "end": "485520"
  },
  {
    "text": "redirection code and tell the browser that it should connect over uh",
    "start": "485520",
    "end": "490560"
  },
  {
    "text": "HPS okay so what's going to happen next is we're going to have our communication over HPS everything is secure everything",
    "start": "490560",
    "end": "497599"
  },
  {
    "text": "looks fine however the problem is that the initial communication the initial",
    "start": "497599",
    "end": "502639"
  },
  {
    "text": "get request is sent over HTP so if the browser finds a cookie for that domain",
    "start": "502639",
    "end": "508080"
  },
  {
    "text": "uh in the cookie jar will actually appended and that's where the door opens up for us to be able to do these attacks",
    "start": "508080",
    "end": "514719"
  },
  {
    "text": "now I don't know if it surprises everyone but before we started looking at this uh in my mind I always thought",
    "start": "514719",
    "end": "520919"
  },
  {
    "text": "that this wouldn't happen but maybe I just didn't think of it enough so this is basically uh one of the uh",
    "start": "520919",
    "end": "527480"
  },
  {
    "text": "interesting parts of uh how we can attack services in general most people consider to have uh encryption",
    "start": "527480",
    "end": "534399"
  },
  {
    "start": "534000",
    "end": "534000"
  },
  {
    "text": "everywhere so for this study we actually looked at uh 25 of the most popular",
    "start": "534399",
    "end": "539600"
  },
  {
    "text": "websites out there and they're from different categories so we looked at banking sites uh social networks uh",
    "start": "539600",
    "end": "546040"
  },
  {
    "text": "search engines eCommerce uh media Outlets things like that and we found out out of the 25 15 do support HPS but",
    "start": "546040",
    "end": "555040"
  },
  {
    "text": "don't enforce it everywhere on their domain subdomains and all the URLs okay so this number might not seem that large",
    "start": "555040",
    "end": "562680"
  },
  {
    "text": "but you have to keep in mind these are 25 of the most popular websites in the world okay so this number is pretty bad",
    "start": "562680",
    "end": "570920"
  },
  {
    "text": "now the thing is that in most cases uh apart from not supporting encryption everywhere what they do is that they'll",
    "start": "570920",
    "end": "577360"
  },
  {
    "text": "offer a personalized version of the website and they do that to maximize user engagement so if you go to Amazon",
    "start": "577360",
    "end": "584640"
  },
  {
    "text": "Amazon will not want to like force you to log in right away before you start looking uh let's say at products now the",
    "start": "584640",
    "end": "592360"
  },
  {
    "text": "thing is that all these websites are massive and in many cases they might have a very large number of cookies so",
    "start": "592360",
    "end": "597800"
  },
  {
    "text": "Google I think has close to 50 cookies they use which is crazy uh and of course",
    "start": "597800",
    "end": "603279"
  },
  {
    "text": "you have all this complicated interoperability which can lead to flawed access control and Su is going to",
    "start": "603279",
    "end": "609360"
  },
  {
    "text": "talk about a really interesting uh uh example at least in my case uh of how we",
    "start": "609360",
    "end": "614920"
  },
  {
    "text": "can actually use that to bypass a protection that uh Google has on Google",
    "start": "614920",
    "end": "620240"
  },
  {
    "text": "Maps and finally we'll see what kind of uh sensitive information and account",
    "start": "620240",
    "end": "625600"
  },
  {
    "text": "functionality is actually exposed in all 15 of these services so to make sure that we're all on the",
    "start": "625600",
    "end": "631680"
  },
  {
    "text": "same page uh we consider a very weak adversary for this attack so it's a simple uh passive uh e dropping on the",
    "start": "631680",
    "end": "639040"
  },
  {
    "text": "traffic so we don't have a man in the middle we don't inject anything we just simply listen to the traffic and uh",
    "start": "639040",
    "end": "644720"
  },
  {
    "text": "extract any cookies that we that we see uh so uh Su will now take over and give",
    "start": "644720",
    "end": "650399"
  },
  {
    "text": "you uh some details about our research things all right um can you hear me clearly yes all right awesome so yeah",
    "start": "650399",
    "end": "657440"
  },
  {
    "text": "the Trap model that we consider here is the if dropping which is like the simple test threat in the um traffic Network so",
    "start": "657440",
    "end": "665000"
  },
  {
    "start": "661000",
    "end": "661000"
  },
  {
    "text": "first of course the way we do if if dropping it just like have to access any targeted Network so it could be like any",
    "start": "665000",
    "end": "671279"
  },
  {
    "text": "open wi-fi if you are a powerful attacker you can do y tappings mle boxes work as well or do proxy or even do a t",
    "start": "671279",
    "end": "678839"
  },
  {
    "text": "exip note I mean we we have an experiment on that and Jason going to talk about it in the next few slides so",
    "start": "678839",
    "end": "685079"
  },
  {
    "text": "next we need a two two sniffing so I mean probably you guys already know like TCP whitear these cap two is well known",
    "start": "685079",
    "end": "691639"
  },
  {
    "text": "and like used in our text as well so another thing that we should consider is",
    "start": "691639",
    "end": "697120"
  },
  {
    "text": "um if the if the HTTP connection is coming the fragment you have to make sure that you like do a TCP reassembly",
    "start": "697120",
    "end": "703560"
  },
  {
    "text": "before to maximize the number of connection you're going to have then come to the part where want we",
    "start": "703560",
    "end": "709800"
  },
  {
    "start": "707000",
    "end": "707000"
  },
  {
    "text": "where we want to steal the cookie so of course cookie is in the HTTP connection headers and this what I show is one of",
    "start": "709800",
    "end": "717160"
  },
  {
    "text": "the HTTP request um which basically is going to give you a lot of information",
    "start": "717160",
    "end": "722240"
  },
  {
    "text": "on it but just only the the only thing that we care in the header part is just like the horse and cookies so horse is",
    "start": "722240",
    "end": "729920"
  },
  {
    "text": "basically going to tell you which domain name or which server the WIC te is connecting to why the cookie is the core",
    "start": "729920",
    "end": "737120"
  },
  {
    "text": "of the attack here since it's used to authorize the user to the website so as",
    "start": "737120",
    "end": "742680"
  },
  {
    "text": "I I give an example of here is like a three cookies you can have more or you can have less",
    "start": "742680",
    "end": "747800"
  },
  {
    "text": "definitely another thing that you can take advantage of is by looking at the HTTP response which basically there's",
    "start": "747800",
    "end": "754079"
  },
  {
    "text": "like a fi core set cookie in the header where basically it's going to give you the cookies and also like the H name uh",
    "start": "754079",
    "end": "761240"
  },
  {
    "text": "we not usually we usually not seeing this HTP response so much since like mean this day after the connection",
    "start": "761240",
    "end": "767519"
  },
  {
    "text": "switched to htps they I mean after you lock in you switch to htps they all like",
    "start": "767519",
    "end": "772639"
  },
  {
    "text": "I mean these C respon Is transfer in on hdps but you never know like I mean a site could like do something stupid then",
    "start": "772639",
    "end": "779360"
  },
  {
    "text": "set it on like HTTP and then you can take advantage of that so now we have a",
    "start": "779360",
    "end": "784480"
  },
  {
    "start": "783000",
    "end": "783000"
  },
  {
    "text": "cookies how can we access the data so of course we want to access the user data",
    "start": "784480",
    "end": "790639"
  },
  {
    "text": "so we going to imitate user we can send request at like with the stolen cookie so we going to try or I insist you to",
    "start": "790639",
    "end": "796839"
  },
  {
    "text": "try for both HTTP and htps so the reason is that even if you have this like",
    "start": "796839",
    "end": "802079"
  },
  {
    "text": "non-secure cookie but a lot of cases we found that even if you have nonse cookie you set on HTTP and and it give you",
    "start": "802079",
    "end": "810040"
  },
  {
    "text": "different will different information when you send on htps so this kind of thing is like reveal a lot of access for",
    "start": "810040",
    "end": "816959"
  },
  {
    "text": "in the service that they not do it correctly so uh we request and how do we",
    "start": "816959",
    "end": "823000"
  },
  {
    "text": "know that we get like a personal information out so the easiest way it's just like okay you set a cookie in the browser you open it up and then like see",
    "start": "823000",
    "end": "829920"
  },
  {
    "text": "if there is any like I mean your name username or something like that but the better way to do is and faster is like",
    "start": "829920",
    "end": "836680"
  },
  {
    "text": "by probably sending two requests one quest with cookies and the other without cookie then if you see any differences",
    "start": "836680",
    "end": "844120"
  },
  {
    "text": "like I mean if the size is differences or any elements uh HTML element that",
    "start": "844120",
    "end": "849199"
  },
  {
    "text": "different or any text um difference so you can assume that um if this different",
    "start": "849199",
    "end": "854399"
  },
  {
    "text": "is on the um stolen cookie HTTP request is it could be the case that this could",
    "start": "854399",
    "end": "860519"
  },
  {
    "text": "contain some personal information or any personalization that user have so this",
    "start": "860519",
    "end": "866079"
  },
  {
    "text": "thing will like I mean give you a rough idea of like okay what kind of element you're looking for so of course there",
    "start": "866079",
    "end": "871839"
  },
  {
    "text": "are a lot of two already do that for you like Cur simple one uh if you want to just like I mean get the static I mean",
    "start": "871839",
    "end": "878199"
  },
  {
    "text": "html page out you can do selenium Phantom D which like I mean going to",
    "start": "878199",
    "end": "883360"
  },
  {
    "text": "render some active content for you as well so we already know that and then after we know it we identify the HTML",
    "start": "883360",
    "end": "889639"
  },
  {
    "text": "element that we looking for we can just do like it as like a script and then do it like attack in a real time like collecting the all the information that",
    "start": "889639",
    "end": "896279"
  },
  {
    "text": "leak it out so um um we already uh the tack that I like I mean just uh show it",
    "start": "896279",
    "end": "903160"
  },
  {
    "text": "to you is pretty straightforward and people um know that but the thing is like why is still working on this day",
    "start": "903160",
    "end": "909720"
  },
  {
    "text": "like so the question is like what can we access by just using HTTP cookies okay I",
    "start": "909720",
    "end": "915199"
  },
  {
    "text": "mean on the https site so we take a look at the top search engine here which we",
    "start": "915199",
    "end": "920279"
  },
  {
    "start": "917000",
    "end": "917000"
  },
  {
    "text": "have Google by being and Yahoo which is like I mean the most um search engine in the world and",
    "start": "920279",
    "end": "926720"
  },
  {
    "text": "surprisingly we're able to de anonymize user we about to get user information email profile picture first name and",
    "start": "926720",
    "end": "933600"
  },
  {
    "text": "last name I just want to insist again that we just use HTTP cookies why this m information give out I don't know okay",
    "start": "933600",
    "end": "941240"
  },
  {
    "text": "so another important thing is we also like able to get search all with visited",
    "start": "941240",
    "end": "946839"
  },
  {
    "text": "history as well so for BYU being and Yahoo we simply just get entire information entire search history always",
    "start": "946839",
    "end": "953759"
  },
  {
    "text": "at it so for Google since St a bit carefully but um we still somehow able",
    "start": "953759",
    "end": "960240"
  },
  {
    "text": "to reconstruct it so if attacker have find a keyword or a similar keyword that",
    "start": "960240",
    "end": "966040"
  },
  {
    "text": "user have been prly searched before if there is like a page showing up that",
    "start": "966040",
    "end": "971120"
  },
  {
    "text": "user have been visited before it's going to show the information that okay user have been visited this page how many",
    "start": "971120",
    "end": "976920"
  },
  {
    "text": "time and on a date which is like the default setting on Google so um since Google and Buu being",
    "start": "976920",
    "end": "984240"
  },
  {
    "text": "they all offers like a map Services as well so uh for Buu human being we simply",
    "start": "984240",
    "end": "990199"
  },
  {
    "text": "just get like all the safe and for the location that user have that tie to that",
    "start": "990199",
    "end": "995319"
  },
  {
    "text": "account okay for Google even if we cannot access like HTTP on Google Map",
    "start": "995319",
    "end": "1000399"
  },
  {
    "text": "okay we I mean there are like a FL in Access Control that if you search in the",
    "start": "1000399",
    "end": "1005440"
  },
  {
    "text": "uh search bar of the google.com like home or work it will give you like I mean exact location and also like the",
    "start": "1005440",
    "end": "1012480"
  },
  {
    "text": "map to your house which is like lead to many physical Str like I mean stalking and all kinds of that crazy right so um",
    "start": "1012480",
    "end": "1020199"
  },
  {
    "start": "1018000",
    "end": "1018000"
  },
  {
    "text": "another service that we looking at um is Yahoo so Yahoo have any services and we",
    "start": "1020199",
    "end": "1026438"
  },
  {
    "text": "actually break off of them but except the mail that we didn't have a chance like we didn't get out get in but I mean",
    "start": "1026439",
    "end": "1032240"
  },
  {
    "text": "we have like the side channel that we can do so one of the service that Google oh sorry Yahoo have is like the Yahoo",
    "start": "1032240",
    "end": "1038839"
  },
  {
    "text": "answer and people use it a lot this day so Yahoo give Yahoo answer like I I'm",
    "start": "1038839",
    "end": "1044558"
  },
  {
    "text": "sure that probably you guys like familiar with that but okay after we having the H we able to answer or ask",
    "start": "1044559",
    "end": "1050200"
  },
  {
    "text": "the question as a user we also be able to like I mean since like yahoo answer also give you B give user ability to",
    "start": "1050200",
    "end": "1058440"
  },
  {
    "text": "answer or ask question anonymously we able to review those question even if",
    "start": "1058440",
    "end": "1063559"
  },
  {
    "text": "it's answer or ask anonymously as well so um even if we cannot get into uh",
    "start": "1063559",
    "end": "1070280"
  },
  {
    "text": "yahel so we able to like I mean doing a little attack on here so basically this",
    "start": "1070280",
    "end": "1075440"
  },
  {
    "text": "is like the C the the screenshot from the homepage of Yahoo and what we get if we just have HTTP we able to get like an",
    "start": "1075440",
    "end": "1082159"
  },
  {
    "text": "email notification with the title and a snippet of the message another thing that we also get",
    "start": "1082159",
    "end": "1088799"
  },
  {
    "text": "and it's so surprised that we able to extract the whole contact list that user have on the um WIC te email so um since",
    "start": "1088799",
    "end": "1097960"
  },
  {
    "text": "like Yahoo have like a lot of service like Yahoo news and yahoo sport if you click on a button like I mean they give",
    "start": "1097960",
    "end": "1103919"
  },
  {
    "text": "ability for user to share an article WEA an email address which is like an email",
    "start": "1103919",
    "end": "1109440"
  },
  {
    "text": "from Yahoo if you click that button button is going to pop up this um screenshot and basically it's going to",
    "start": "1109440",
    "end": "1115480"
  },
  {
    "text": "give you like okay what kind of email of the user and also since they have an order complete feature on the two form",
    "start": "1115480",
    "end": "1122600"
  },
  {
    "text": "so if you press just one button you basically get the entire email address that is on the victim so this the so",
    "start": "1122600",
    "end": "1129799"
  },
  {
    "text": "surprise for us and plus we able to send an email as the user as",
    "start": "1129799",
    "end": "1135200"
  },
  {
    "text": "well yeah by uh yeah by just like um using this popup and we also like I mean",
    "start": "1135200",
    "end": "1141679"
  },
  {
    "text": "add some customization message so of course it's going to fac facilitate any fishing or spamming",
    "start": "1141679",
    "end": "1148080"
  },
  {
    "start": "1148000",
    "end": "1148000"
  },
  {
    "text": "attack next we take a look at like the popular e-commerce sites like Amazon eBay Walmart and Target so um",
    "start": "1148080",
    "end": "1155640"
  },
  {
    "text": "fortunately they all support hdps okay but unfortunately they only support hdps",
    "start": "1155640",
    "end": "1162240"
  },
  {
    "text": "over the logged in account and checkout page so it's mean that the rest of the page is on HTTP and it's mean that we",
    "start": "1162240",
    "end": "1168919"
  },
  {
    "text": "can get all the information like I mean username email by just using HTP cookie",
    "start": "1168919",
    "end": "1174240"
  },
  {
    "text": "we also get we we also able to get like and modify item in card wh list recent",
    "start": "1174240",
    "end": "1179360"
  },
  {
    "text": "whe item or any purchase item that user have so this could be like a t an attack where you could like I mean monitor the",
    "start": "1179360",
    "end": "1186080"
  },
  {
    "text": "network and then like seeing like user don't have anything in the card you just add it in this should work as",
    "start": "1186080",
    "end": "1191480"
  },
  {
    "text": "well so um eBay surprisingly also review entire shipping U sorry shipping address",
    "start": "1191480",
    "end": "1199159"
  },
  {
    "text": "so yeah leading to again physical attack another thing that um Amazon and",
    "start": "1199159",
    "end": "1205400"
  },
  {
    "text": "Target offer is like they offer user to uh send like any a recommendation of the",
    "start": "1205400",
    "end": "1210840"
  },
  {
    "text": "product page to any email address so if you have this cookie of Amazon and",
    "start": "1210840",
    "end": "1216400"
  },
  {
    "text": "Target HTTP cookie you're able to use like you're able to send an email as a user as well so again this going to be",
    "start": "1216400",
    "end": "1222360"
  },
  {
    "text": "like ficate any spam or pitching just to update you um I think",
    "start": "1222360",
    "end": "1227720"
  },
  {
    "text": "it feels uh weeks ago so Amazon like announced that they're going to move everything to htps okay but however",
    "start": "1227720",
    "end": "1235919"
  },
  {
    "text": "since like our attch is not really relying on https like Jason say we like the other way around we get HTTP cookie",
    "start": "1235919",
    "end": "1242760"
  },
  {
    "text": "from the first connection then I just check and everything just working fine so any information that we show here s",
    "start": "1242760",
    "end": "1250400"
  },
  {
    "text": "true all right we next we take a look at the app network uh and we already know that there are a lot of work on the app",
    "start": "1250400",
    "end": "1256799"
  },
  {
    "start": "1251000",
    "end": "1251000"
  },
  {
    "text": "Network and we know that all all the app that we all the ad that show to user these day they are or taer to specific",
    "start": "1256799",
    "end": "1264280"
  },
  {
    "text": "like user profile and history of brow um browsing so now we want to see",
    "start": "1264280",
    "end": "1270200"
  },
  {
    "text": "if to get the the ad Network cookie what",
    "start": "1270200",
    "end": "1275480"
  },
  {
    "text": "kind of information that he can get so we set up like a smallart experiment here on the left side we have just like",
    "start": "1275480",
    "end": "1280919"
  },
  {
    "text": "a WIC te with it like a shopping website and then we have the at Network hookie",
    "start": "1280919",
    "end": "1285960"
  },
  {
    "text": "stall into a tagger on the right hand side here and a can go to any website like I mean that have like the these",
    "start": "1285960",
    "end": "1291919"
  },
  {
    "text": "kind ad Network integrated on the site so surprisingly is the ad that show here",
    "start": "1291919",
    "end": "1298799"
  },
  {
    "text": "is not just only reveal user visited P um website but it also like show exact",
    "start": "1298799",
    "end": "1305400"
  },
  {
    "text": "page exact product that user have been visited like I mean it's it's going to be a lot of like privacy leakage here",
    "start": "1305400",
    "end": "1311279"
  },
  {
    "text": "like I mean if wiim is pregnant woman and then it's like attacker just like okay seeing some pregnant product or",
    "start": "1311279",
    "end": "1317559"
  },
  {
    "text": "anything related to baby or something well did he definitely know about this user right so uh we actually take a look",
    "start": "1317559",
    "end": "1325520"
  },
  {
    "start": "1323000",
    "end": "1323000"
  },
  {
    "text": "more like I mean in many services and but since we don't have time to cover",
    "start": "1325520",
    "end": "1331000"
  },
  {
    "text": "that in the presentation so this basic this T table is basically list of the",
    "start": "1331000",
    "end": "1337039"
  },
  {
    "text": "service that we take a look and we suc we able to get some information out of it like the way that we the way that I",
    "start": "1337039",
    "end": "1343279"
  },
  {
    "text": "described previously okay and the right hand side is the cookies that you need",
    "start": "1343279",
    "end": "1348960"
  },
  {
    "text": "okay to be able to get an information that I have shown previously so usually",
    "start": "1348960",
    "end": "1354200"
  },
  {
    "text": "we um I I'll give you out usually it shouldn't but I mean we trust you guys",
    "start": "1354200",
    "end": "1359520"
  },
  {
    "text": "so use it ethically please be nice yeah please be nice about",
    "start": "1359520",
    "end": "1364880"
  },
  {
    "text": "it so next we we also like take a look at the other um Kookie perspective like",
    "start": "1364880",
    "end": "1370480"
  },
  {
    "text": "I mean the browser extension which is like based on HTP and https and also like mobile app these day on the",
    "start": "1370480",
    "end": "1377000"
  },
  {
    "text": "background like they do a lot of HTTP and https requests as well so well we",
    "start": "1377000",
    "end": "1382320"
  },
  {
    "text": "can see that I mean the table is like huge and roughly we can see that there are a lot of like the leakage of HTTP",
    "start": "1382320",
    "end": "1389240"
  },
  {
    "text": "cookie is so common okay not only on the the browser side also we also get on the",
    "start": "1389240",
    "end": "1395120"
  },
  {
    "text": "mobile side as well mobile apps as well so another surprising fighting is we",
    "start": "1395120",
    "end": "1401279"
  },
  {
    "text": "found a lot of like leage on iOS more than a lot of leage compared to Android",
    "start": "1401279",
    "end": "1407919"
  },
  {
    "text": "like with the say app so um this is one thing that we have to take a look at and really have to be careful if you're",
    "start": "1407919",
    "end": "1413960"
  },
  {
    "text": "developer so next I Jason going to speak about attack evaluation and defense so",
    "start": "1413960",
    "end": "1420000"
  },
  {
    "start": "1415000",
    "end": "1415000"
  },
  {
    "text": "yeah this okay so uh of course after we did uh our study and all these websites",
    "start": "1420000",
    "end": "1426559"
  },
  {
    "text": "we wanted to do uh an evaluation of our attack uh an actual evaluation so there",
    "start": "1426559",
    "end": "1432520"
  },
  {
    "text": "were two main aspects that we were afraid that might uh impact the effectiveness of what we wanted to do so",
    "start": "1432520",
    "end": "1438679"
  },
  {
    "text": "on one hand one question that we had was whether users will actually behave differently on when they're connected to",
    "start": "1438679",
    "end": "1446000"
  },
  {
    "text": "a public Wi-Fi so will everyone use a VPN or will they log out of everything or avoid websites that don't have HPS of",
    "start": "1446000",
    "end": "1454080"
  },
  {
    "text": "course that's wishful thinking but nonetheless it's something that we had in our mind and on the other hand of course What mechanisms have already been",
    "start": "1454080",
    "end": "1460400"
  },
  {
    "text": "deployed or adopted that can prevent of the cookie hijacking so what we did is we monitored 15% approximately 15 % of",
    "start": "1460400",
    "end": "1468880"
  },
  {
    "text": "Colombia's public Wi-Fi for one month now of course uh we had to get IRB approval for that now if whoever's not",
    "start": "1468880",
    "end": "1476799"
  },
  {
    "text": "aware of IRB it's something that we have to do in Academia when we do experiments uh with user data or stuff like that",
    "start": "1476799",
    "end": "1483520"
  },
  {
    "text": "where you have to give a description of what you're going to do what the goal is what type of data you're going to collect how you're going to handle it",
    "start": "1483520",
    "end": "1490440"
  },
  {
    "text": "and they're going to do some type of risk benefit analysis and look at the ethical aspects and decide if they'll let you do it or not okay so that kind",
    "start": "1490440",
    "end": "1497520"
  },
  {
    "text": "of prohibits you can actually do in your research but in this case I think it was good enough for us to see how effective",
    "start": "1497520",
    "end": "1505440"
  },
  {
    "text": "our attacks are so we collected the HTP and htps traffic that we saw and for the",
    "start": "1505440",
    "end": "1511200"
  },
  {
    "text": "unencrypted we extracted the URL cookie name and we also kept a hash of the cookie value now for the HPS traffic we",
    "start": "1511200",
    "end": "1518320"
  },
  {
    "text": "just got the Sni which allowed us to uh see which domain the users are connecting to now I'm sure lots of you",
    "start": "1518320",
    "end": "1525159"
  },
  {
    "text": "would prefer if we actually kept uh the cookies value which would allow us to differentiate all the users so even if",
    "start": "1525159",
    "end": "1532600"
  },
  {
    "text": "you connect from multiple devices or for some reason the quickie value changed within the monitoring period we would",
    "start": "1532600",
    "end": "1538760"
  },
  {
    "text": "still be able to get an exact uh number of the users that we saw unfortunately there was no way they would allow us to",
    "start": "1538760",
    "end": "1544880"
  },
  {
    "text": "do that so by keeping a hash we're able to differentiate the user on one device",
    "start": "1544880",
    "end": "1550240"
  },
  {
    "text": "within one service but of course uh the numbers I'm going to show you might be uh over counting some but so I think",
    "start": "1550240",
    "end": "1556919"
  },
  {
    "text": "they're uh large enough to uh be uh pretty uh interesting so Google of",
    "start": "1556919",
    "end": "1563480"
  },
  {
    "start": "1559000",
    "end": "1559000"
  },
  {
    "text": "course was our main target and we were actually able to collect 67,000 uh vulnerable accounts okay so",
    "start": "1563480",
    "end": "1571679"
  },
  {
    "text": "even if we consider that we'll double or triple counting some users it's still a",
    "start": "1571679",
    "end": "1576840"
  },
  {
    "text": "massive number if you think that we just look at part of our University's wireless network for only one month okay",
    "start": "1576840",
    "end": "1583880"
  },
  {
    "text": "so we can imagine how good the attack can be for someone with more resources that can run the attack at a larger scale and of",
    "start": "1583880",
    "end": "1591360"
  },
  {
    "text": "course even other services like Yahoo and Amazon were able to get many thousands of",
    "start": "1591360",
    "end": "1597480"
  },
  {
    "text": "accounts so now I'd like to kind of step back and try and look at uh the wider",
    "start": "1597480",
    "end": "1603240"
  },
  {
    "text": "implications of this attack so of course all of us know that the government lots of governments uh and intelligence",
    "start": "1603240",
    "end": "1610840"
  },
  {
    "text": "agencies and law enforcement agencies are massively collecting uh traffic and",
    "start": "1610840",
    "end": "1616480"
  },
  {
    "text": "of course anything that's unencrypted is really bad now the thing is that we also know that they're massively collecting",
    "start": "1616480",
    "end": "1622399"
  },
  {
    "text": "cookies and they've used that for various reasons trying to identify users that might be using a specific Network",
    "start": "1622399",
    "end": "1628360"
  },
  {
    "text": "which will give them a better uh Target and of course we know that tour users",
    "start": "1628360",
    "end": "1633720"
  },
  {
    "text": "have been targeted many times by uh these agencies so I think you're probably getting the idea of where I'm",
    "start": "1633720",
    "end": "1639840"
  },
  {
    "text": "trying to go uh so we wanted to see what the attack implications are for the tour",
    "start": "1639840",
    "end": "1644880"
  },
  {
    "start": "1640000",
    "end": "1640000"
  },
  {
    "text": "Network now of course everyone I'm sure knows about the toret Network so we're not going to talk about how it works and",
    "start": "1644880",
    "end": "1650559"
  },
  {
    "text": "stuff like that but what is important I think in the context of our attch is that it's used by many privacy conscious",
    "start": "1650559",
    "end": "1656760"
  },
  {
    "text": "uh users many whistleblowers activists so it's people that it's very critical for them to maintain their anonymity",
    "start": "1656760",
    "end": "1663840"
  },
  {
    "text": "okay now the thing is that with the Tour bundle being available has really lowered the threshold of technical",
    "start": "1663840",
    "end": "1670799"
  },
  {
    "text": "literacy you have to have to actually use a Tor Network so that means that lots of people that are using it don't",
    "start": "1670799",
    "end": "1676760"
  },
  {
    "text": "have an awareness of all the threats I might be facing they have a misconception of what the Tor Network might actually be offering them so we",
    "start": "1676760",
    "end": "1683679"
  },
  {
    "text": "know that the tour network is not designed to prevent this type of attacks okay so why would we do an experiment",
    "start": "1683679",
    "end": "1689799"
  },
  {
    "text": "here what is different the thing is that the Tor bundle comes with a Tor Browser of course which has a really interesting",
    "start": "1689799",
    "end": "1696320"
  },
  {
    "text": "extension pre-installed and that's htps everywhere so this is quite popular I think they have several million uh",
    "start": "1696320",
    "end": "1703279"
  },
  {
    "text": "installations and this can actually prevent uh cookie hijacking attacks because the goal is to en Force",
    "start": "1703279",
    "end": "1708519"
  },
  {
    "text": "connections to go over hcps and I'm going to talk about that more uh in a couple slides so for this experiment we",
    "start": "1708519",
    "end": "1714960"
  },
  {
    "text": "monitored uh we monitor monitored uh fresh tour exit node for one month and",
    "start": "1714960",
    "end": "1720440"
  },
  {
    "text": "again we had to get IRB approval of course due to the very sensitive nature of uh traffic on touring for the reasons",
    "start": "1720440",
    "end": "1726679"
  },
  {
    "text": "I said we we kind of opted for a less invasive experiment so we didn't even",
    "start": "1726679",
    "end": "1731799"
  },
  {
    "text": "touch any cookies we just looked at aggregate statistics of how many connections were already p and over HPS",
    "start": "1731799",
    "end": "1740120"
  },
  {
    "text": "towards the sites that we had audited now of course uh this prohibits us from being",
    "start": "1740120",
    "end": "1747200"
  },
  {
    "text": "able to evaluate how many users actually exposed the cookies that we needed but",
    "start": "1747200",
    "end": "1752960"
  },
  {
    "text": "by looking at the amount of unencrypted connections uh going out from uh the toy exit note that we were looking at we",
    "start": "1752960",
    "end": "1759519"
  },
  {
    "text": "found that approximately 75% of all the connections were over HTTP okay so even",
    "start": "1759519",
    "end": "1765159"
  },
  {
    "text": "though we don't have numbers about how many cookies were in that track trffic I think it's safe to assume that many",
    "start": "1765159",
    "end": "1770640"
  },
  {
    "text": "users were actually exposing the themselves to these attacks so if we look uh we can see that for Google and",
    "start": "1770640",
    "end": "1777399"
  },
  {
    "text": "Yahoo okay uh the encrypted connections were slightly higher but there was a massive difference for all the other",
    "start": "1777399",
    "end": "1782880"
  },
  {
    "text": "websites and of course we can see that there's significant traffic for Amazon so I don't think it makes much sense for",
    "start": "1782880",
    "end": "1788880"
  },
  {
    "text": "someone to uh go to Amazon without being logged in and having the goal of buying something so at least in that case I",
    "start": "1788880",
    "end": "1794880"
  },
  {
    "text": "think uh most of those HP connections would be exposing uh cookies so I think",
    "start": "1794880",
    "end": "1800799"
  },
  {
    "text": "that uh this is actually a really practical de anization attack that some entities might try to deploy Against",
    "start": "1800799",
    "end": "1808760"
  },
  {
    "text": "tour and this is a literal deanonymization attack so it's going to",
    "start": "1808760",
    "end": "1814000"
  },
  {
    "text": "tell you who that person is where they live where they work what they look at what they're interested in what they",
    "start": "1814000",
    "end": "1819679"
  },
  {
    "text": "bought on Amazon okay so this is I think it it's really interesting and really uh something that uh Toy users have to keep",
    "start": "1819679",
    "end": "1826600"
  },
  {
    "text": "in mind so now I'm going to talk a bit about the counter measures that are uh that have been deployed that can kind of",
    "start": "1826600",
    "end": "1832919"
  },
  {
    "start": "1827000",
    "end": "1827000"
  },
  {
    "text": "impact uh these attacks so hsts is actually uh gaining a lot of traction",
    "start": "1832919",
    "end": "1839120"
  },
  {
    "text": "and it's a really interesting uh proposal so the idea here is that a server will be able to instruct the",
    "start": "1839120",
    "end": "1845919"
  },
  {
    "text": "user's browser to only connect over acps okay so when you have that",
    "start": "1845919",
    "end": "1851159"
  },
  {
    "text": "redirection there going to there's going to be a header in the response that will tell the browser let's say uh I'm",
    "start": "1851159",
    "end": "1857000"
  },
  {
    "text": "google.com whenever you want to connect to me you'll have to do it over htps okay and this header will contain the",
    "start": "1857000",
    "end": "1863200"
  },
  {
    "text": "max age variable which actually tells a browser for how many seconds it should cash this policy okay so a typical value",
    "start": "1863200",
    "end": "1871200"
  },
  {
    "text": "is like 6 months or one year now the header can also contain two more optional directives the first one is",
    "start": "1871200",
    "end": "1878519"
  },
  {
    "text": "include subdomains so if that's in the header we actually tell the browser if the user is trying to connect let's say",
    "start": "1878519",
    "end": "1884279"
  },
  {
    "text": "to mail.google.com or api. google.com again to enforce an encrypted connection",
    "start": "1884279",
    "end": "1891360"
  },
  {
    "text": "now the second directive is preload which means that this website is either trying to uh is either in submission for",
    "start": "1891360",
    "end": "1898639"
  },
  {
    "text": "getting added to the preload list which I'll tell you in a minute what it is or it's already been added to that list so",
    "start": "1898639",
    "end": "1904519"
  },
  {
    "text": "what is the hsts preload list now this is a hardcoded list of entries that uh",
    "start": "1904519",
    "end": "1910440"
  },
  {
    "text": "is shipped with all major browsers which actually contains these directives these uh policies for various domains",
    "start": "1910440",
    "end": "1918440"
  },
  {
    "text": "and why is the reason that they have that now if you keep in mind the original scenario I talked about of how",
    "start": "1918440",
    "end": "1924320"
  },
  {
    "text": "uh we have this redirection from HP to HPS and that leaves us a door to steal",
    "start": "1924320",
    "end": "1929399"
  },
  {
    "text": "the cookie the same thing happens with hsts so the first connection that the users is going to send before they get",
    "start": "1929399",
    "end": "1935720"
  },
  {
    "text": "that directive before they get uh that uh command to always connect over acps",
    "start": "1935720",
    "end": "1941080"
  },
  {
    "text": "they can still expose a cookie so what does hsts preload do it actually eliminates every R Direction so the",
    "start": "1941080",
    "end": "1948200"
  },
  {
    "text": "browser will look at the any domain or any URL that the us is going to try to connect to and it's going to look within",
    "start": "1948200",
    "end": "1953480"
  },
  {
    "text": "the preload list and if it finds it there it will also do the initial connection over",
    "start": "1953480",
    "end": "1959639"
  },
  {
    "text": "https however there are various deployment issues with hsts that can uh uh allow attackers to still do our",
    "start": "1959639",
    "end": "1967159"
  },
  {
    "start": "1960000",
    "end": "1960000"
  },
  {
    "text": "attacks so on one hand to be able to get into the preload list which is actually managed by the chromium project shied",
    "start": "1967159",
    "end": "1974399"
  },
  {
    "text": "with a Chrome browser and then the other browsers just take that and use use that or a subset of it now the thing is that",
    "start": "1974399",
    "end": "1981159"
  },
  {
    "text": "to get on that list are various requirements and one of them is that you have to support acps on all your",
    "start": "1981159",
    "end": "1987360"
  },
  {
    "text": "subdomains now the thing is that many websites have Legacy uh codebase with",
    "start": "1987360",
    "end": "1992639"
  },
  {
    "text": "Legacy URLs and functionality that doesn't support HPS so the problem is",
    "start": "1992639",
    "end": "1997960"
  },
  {
    "text": "that those websites can't get on the preload list now as I'm going to uh say",
    "start": "1997960",
    "end": "2003000"
  },
  {
    "text": "again at the end of the talk just partially deploying it will not save you it can minimize it can make the attack",
    "start": "2003000",
    "end": "2010000"
  },
  {
    "text": "surface smaller but it will still expose the user in many cases however by not allowing these websites to actually get",
    "start": "2010000",
    "end": "2016480"
  },
  {
    "text": "on the preload list which is like a step in uh a better Direction it's like a good step forward I think it makes it",
    "start": "2016480",
    "end": "2023240"
  },
  {
    "text": "makes things worse uh for everyone now another problem is the partial adoption",
    "start": "2023240",
    "end": "2028399"
  },
  {
    "text": "of hsts so in many cases uh services will not uh protect they won't put the",
    "start": "2028399",
    "end": "2035080"
  },
  {
    "text": "include subdomain directive so they might protect protect their main domain but not protect other domains so in that",
    "start": "2035080",
    "end": "2040919"
  },
  {
    "text": "case again the user will be exposed and I think the most interesting case that we found was Google which actually",
    "start": "2040919",
    "end": "2048079"
  },
  {
    "text": "protects your subdomains but doesn't protect the main google.com domain or any of the uh Regional version so. cuk",
    "start": "2048079",
    "end": "2056240"
  },
  {
    "text": "doit do CN or whatever so if you try to go to Gmail by typing mail.google.com",
    "start": "2056240",
    "end": "2062960"
  },
  {
    "text": "you'll be protected because it's a subdomain but if you go by google.com",
    "start": "2062960",
    "end": "2068040"
  },
  {
    "text": "/ma you won't be protected unfortunately in the past uh",
    "start": "2068040",
    "end": "2073320"
  },
  {
    "text": "five days this was actually fixed but well for sorry fortunately uh",
    "start": "2073320",
    "end": "2079560"
  },
  {
    "text": "in the past five days this was fixed uh and I'll talk about that in a couple slides uh yeah sorry can we delete a",
    "start": "2079560",
    "end": "2086240"
  },
  {
    "text": "video of the unfortunately part that does that shouldn't go up there uh yes",
    "start": "2086240",
    "end": "2091679"
  },
  {
    "text": "unfortunately uh so another problem there was a really interesting study at ndss in 2015 where they did a large",
    "start": "2091679",
    "end": "2098680"
  },
  {
    "text": "scale evaluation of the deployment of uh hsts and hsts preload and certificate",
    "start": "2098680",
    "end": "2103920"
  },
  {
    "text": "pinning and they found that we're still in a very early state of adoption so things are getting better but they still",
    "start": "2103920",
    "end": "2110440"
  },
  {
    "text": "are very very bad and of course in many cases they found that there were many misconfigurations which actually",
    "start": "2110440",
    "end": "2116000"
  },
  {
    "text": "prevented hsts from protecting uh the users and finally there have been a couple of talks about attacks against",
    "start": "2116000",
    "end": "2122920"
  },
  {
    "text": "hsts but you can look those up by yourself you don't have time for that now I'm going to talk a bit about htps",
    "start": "2122920",
    "end": "2129640"
  },
  {
    "text": "everywhere so this is a browser extension that was built by the and the tour project and it actually comes",
    "start": "2129640",
    "end": "2135200"
  },
  {
    "text": "pre-installed in the tour browser now the whole idea is that you have a set of rule sets that try to identify uh cases",
    "start": "2135200",
    "end": "2144320"
  },
  {
    "text": "where with they try to identify the domain that the user is connecting to and see if they can enforce uh a",
    "start": "2144320",
    "end": "2151400"
  },
  {
    "text": "connection to go over ctps okay so the idea is that the uh the extension looks",
    "start": "2151400",
    "end": "2156880"
  },
  {
    "text": "at which domain you're connecting to they use regular Expressions to see if the part you want to go to is supported",
    "start": "2156880",
    "end": "2162960"
  },
  {
    "text": "by support saps or not and then enforce a rewrite so this is actually like the",
    "start": "2162960",
    "end": "2168520"
  },
  {
    "text": "simplest type of uh case where you could find where you have the target host example.com and the rule for",
    "start": "2168520",
    "end": "2174400"
  },
  {
    "text": "modification is just to uh add an S okay now there are various issues because in",
    "start": "2174400",
    "end": "2180760"
  },
  {
    "start": "2179000",
    "end": "2179000"
  },
  {
    "text": "practice things aren't that simple so one of the major problems is that since this is based on a community effort so",
    "start": "2180760",
    "end": "2187560"
  },
  {
    "text": "we have volunteers manually uh looking at websites and creating these rule sets",
    "start": "2187560",
    "end": "2192800"
  },
  {
    "text": "so the thing is that that can of course lead to human arrows now uh this is some ongoing work that we're doing so we",
    "start": "2192800",
    "end": "2199400"
  },
  {
    "text": "can't give you more details for now but you can take our word uh on it so",
    "start": "2199400",
    "end": "2205640"
  },
  {
    "text": "another case of course is as I said not every part of a website will support HS",
    "start": "2205640",
    "end": "2211079"
  },
  {
    "text": "HPS so in those cases of course this extension has to identify them and",
    "start": "2211079",
    "end": "2216200"
  },
  {
    "text": "exclude them from the mat ification role okay so we'll have exclusion patterns that will have a regular expression and",
    "start": "2216200",
    "end": "2222800"
  },
  {
    "text": "try to identify uh the users connecting to something that doesn't support H seps",
    "start": "2222800",
    "end": "2228200"
  },
  {
    "text": "so for example in Amazon if you go over H seps uh on a product page it breaks a",
    "start": "2228200",
    "end": "2233319"
  },
  {
    "text": "functionality of adding the product to your basket so it pretty much makes the website",
    "start": "2233319",
    "end": "2238920"
  },
  {
    "text": "useless and of course another problem is that when you have very large uh very large websites sometimes it becomes far",
    "start": "2238920",
    "end": "2246079"
  },
  {
    "text": "more complicated even if HPS is supported so for example uh Amazon",
    "start": "2246079",
    "end": "2251760"
  },
  {
    "text": "images has a different uh domain uh for the images if you connect over HP or",
    "start": "2251760",
    "end": "2257920"
  },
  {
    "text": "htps so of course keep in mind that these volunteers have to do that manually and identify all these minute",
    "start": "2257920",
    "end": "2264400"
  },
  {
    "text": "cases and of course that shows you that there are many places where this can go wrong nonetheless as we'll see here acps",
    "start": "2264400",
    "end": "2271480"
  },
  {
    "start": "2270000",
    "end": "2270000"
  },
  {
    "text": "everywhere does help a bit so we wanted to do an experiment and see how good it is how much can it help",
    "start": "2271480",
    "end": "2277960"
  },
  {
    "text": "and the idea is to see what if every user that we monitored during our",
    "start": "2277960",
    "end": "2283520"
  },
  {
    "text": "experiment at Colombia actually had that installed how many would be protected so we extracted the URLs and tested them",
    "start": "2283520",
    "end": "2290200"
  },
  {
    "text": "against uh the rule sets and saw how many were actually modified to htps and saw how many of the cookies were",
    "start": "2290200",
    "end": "2296040"
  },
  {
    "text": "actually exposed so we have a different uh uh percentage of reduction across",
    "start": "2296040",
    "end": "2301480"
  },
  {
    "text": "services so for uh Google and yaho approximately 50% uh is uh protected",
    "start": "2301480",
    "end": "2307960"
  },
  {
    "text": "for other websites like eBay or Target there's no rule set so nothing is protected nonetheless over 73% of the",
    "start": "2307960",
    "end": "2316560"
  },
  {
    "text": "accounts remain exposed so it does help everyone should add it but we should",
    "start": "2316560",
    "end": "2322640"
  },
  {
    "text": "know the limitations of this defense as well now disclosure of course we send",
    "start": "2322640",
    "end": "2328880"
  },
  {
    "start": "2325000",
    "end": "2325000"
  },
  {
    "text": "detailed reports to all of the services that we looked that and we got a wide range of",
    "start": "2328880",
    "end": "2334119"
  },
  {
    "text": "responses um so I'm going to show uh my three favorites here because I think",
    "start": "2334119",
    "end": "2339200"
  },
  {
    "text": "they they nicely reflect the mentality of certain uh large websites regarding",
    "start": "2339200",
    "end": "2345400"
  },
  {
    "text": "what we uh try to do uh so in the first case I'll read this because of course I don't remember this by heart uh the",
    "start": "2345400",
    "end": "2352119"
  },
  {
    "text": "related tokens predate the existence of the ACP only setting and have several Legacy applications that do not support",
    "start": "2352119",
    "end": "2358680"
  },
  {
    "text": "the setting on your applications we're working on new session management tokens that will be marked as secure and HP",
    "start": "2358680",
    "end": "2365160"
  },
  {
    "text": "only so this shows that these services do have Legacy codebase and they just",
    "start": "2365160",
    "end": "2371119"
  },
  {
    "text": "accept it they accept a risk they don't care about fixing it uh but don't worry the newer stuff",
    "start": "2371119",
    "end": "2377240"
  },
  {
    "text": "will be secure so everything is fine now uh the second one we have looked at the",
    "start": "2377240",
    "end": "2383560"
  },
  {
    "text": "behavior of uh XXX is the name of the cookie so we don't want to say which service this was of course uh we don't",
    "start": "2383560",
    "end": "2390119"
  },
  {
    "text": "want to get sued but please delete that as well uh so uh the behavior of the cookie hijacking that we reported and we",
    "start": "2390119",
    "end": "2397440"
  },
  {
    "text": "can confirm that this is expected from our service stock okay however keep in",
    "start": "2397440",
    "end": "2403920"
  },
  {
    "text": "mind we do not rely on the cookie for authentication purposes and as such authentication would be required before",
    "start": "2403920",
    "end": "2411800"
  },
  {
    "text": "visiting any sensitive areas of the account so it doesn't matter that all",
    "start": "2411800",
    "end": "2416920"
  },
  {
    "text": "this personal information is leaked since you can't uh gain access to the account and uh do other stuff we're",
    "start": "2416920",
    "end": "2424760"
  },
  {
    "text": "perfectly fine and it's expected it's something that that's expected by the service stock so you tell them about",
    "start": "2424760",
    "end": "2431079"
  },
  {
    "text": "this vulnerability and they don't care to fix it it's like oh yeah we expect that since you can't take over the",
    "start": "2431079",
    "end": "2436760"
  },
  {
    "text": "account everything is fine and my personal favorite uh in this case we found the issue to be invalid as it is",
    "start": "2436760",
    "end": "2443440"
  },
  {
    "text": "an accepted business risk so not only they consider this",
    "start": "2443440",
    "end": "2449160"
  },
  {
    "text": "acceptable uh an acceptable risk for their users because it's not their problem uh for them to make money and to",
    "start": "2449160",
    "end": "2455839"
  },
  {
    "text": "have their business but they also consider the fact that some people do some research for free give them that",
    "start": "2455839",
    "end": "2462920"
  },
  {
    "text": "information on how to fix it and they consider that invalid so I don't know",
    "start": "2462920",
    "end": "2469119"
  },
  {
    "text": "it's it's awesome um so uh this slide was added a couple days",
    "start": "2469119",
    "end": "2475960"
  },
  {
    "start": "2470000",
    "end": "2470000"
  },
  {
    "text": "ago because uh we wanted to say what's the aftermath so we told all these Services back in November so a lot of",
    "start": "2475960",
    "end": "2483440"
  },
  {
    "text": "time has gone by they should fix some stuff and some of the services are working on it they're changing stuff",
    "start": "2483440",
    "end": "2488640"
  },
  {
    "text": "around but our attacks work in every case however Google of course decided five",
    "start": "2488640",
    "end": "2495640"
  },
  {
    "text": "days ago five days before our presentation to deploy hsts on google.com",
    "start": "2495640",
    "end": "2501880"
  },
  {
    "text": "fortunately now uh the thing is though that it's still in testing phase okay so",
    "start": "2501880",
    "end": "2507359"
  },
  {
    "text": "they've set the max age to only one day and it's not in the preload list yet or",
    "start": "2507359",
    "end": "2512920"
  },
  {
    "text": "unless they updated the list and chrome and Shi that out so fast but I I think it's safe to assume that it's not in the",
    "start": "2512920",
    "end": "2518960"
  },
  {
    "text": "preload list yet so that means you can still play around with this attack uh however I think in uh some depth of time",
    "start": "2518960",
    "end": "2526640"
  },
  {
    "text": "this will not be uh it won't be doable on google.com but for now if you get",
    "start": "2526640",
    "end": "2532480"
  },
  {
    "text": "access to the cookie we tested it the attack still works okay but it might be",
    "start": "2532480",
    "end": "2537800"
  },
  {
    "text": "more difficult than just a straightforward uh sniffing at uh whatever your favorite coffee shop so uh",
    "start": "2537800",
    "end": "2546440"
  },
  {
    "start": "2544000",
    "end": "2544000"
  },
  {
    "text": "uh to conclude some takeaways uh which I hope aren't too obvious uh or too silly",
    "start": "2546440",
    "end": "2552720"
  },
  {
    "text": "but uh let's try so I think one uh thing that I took away from this is going back",
    "start": "2552720",
    "end": "2558880"
  },
  {
    "text": "to the basics so let's say if you're a web developer and you're creating this massive websites and you do all the cool",
    "start": "2558880",
    "end": "2566680"
  },
  {
    "text": "uh protection techniques so to prevent crossy scripting and sees Surf and tokens and all that and get Overlook one",
    "start": "2566680",
    "end": "2573119"
  },
  {
    "text": "of the most well-known in simple straightforward attacks then means that you're probably not doing your job that",
    "start": "2573119",
    "end": "2579800"
  },
  {
    "text": "well and of course it's only human okay these websites have awesome Engineers",
    "start": "2579800",
    "end": "2584839"
  },
  {
    "text": "awesome security teams no one doubts that but it's only human to sometimes Overlook something that's so obvious uh",
    "start": "2584839",
    "end": "2593319"
  },
  {
    "text": "so if I was if I was looking at it from our side so an attacker side or an evaluator side I would say always assume",
    "start": "2593319",
    "end": "2600559"
  },
  {
    "text": "the worst so time and time again when we look at services that we want to attack and try to identify design flaws or",
    "start": "2600559",
    "end": "2607119"
  },
  {
    "text": "implementation flaws almost always the initial most simplistic attack that we can think of",
    "start": "2607119",
    "end": "2614800"
  },
  {
    "text": "where the first idea is like there's no way they would do that wrong there's no way this would work in practice many",
    "start": "2614800",
    "end": "2622160"
  },
  {
    "text": "times something so obvious something they missed so always assume the worst or the best depending on how you look at",
    "start": "2622160",
    "end": "2629359"
  },
  {
    "text": "things and try to go for the simple things as well don't always try to go for something super",
    "start": "2629359",
    "end": "2634440"
  },
  {
    "text": "complicated now uh the second one uh is only for web developers or whatever the",
    "start": "2634440",
    "end": "2639960"
  },
  {
    "text": "service is not for the uh attackers but I put that because of the responses that we got so we see that services will",
    "start": "2639960",
    "end": "2647880"
  },
  {
    "text": "actually sacrifice security for usability and for supporting this Legacy codebase however this is exposing users",
    "start": "2647880",
    "end": "2655640"
  },
  {
    "text": "to very significant threats so they should stop accepting the risk and be willing to put in the effort to build uh",
    "start": "2655640",
    "end": "2663000"
  },
  {
    "text": "systems that protect us we have the I'm not talking about everything but for no attacks where we have the defenses we",
    "start": "2663000",
    "end": "2668880"
  },
  {
    "text": "can prevent that they should put in the effort of course this is from uh the",
    "start": "2668880",
    "end": "2674920"
  },
  {
    "text": "point of view of someone that doesn't work in the industry hasn't worked on this team so there might be some massive",
    "start": "2674920",
    "end": "2680720"
  },
  {
    "text": "Insight that I'm missing please come talk to me after the talk if you want to tell me something like that or insult me",
    "start": "2680720",
    "end": "2687160"
  },
  {
    "text": "but uh I I think that at least from my point of view this is something that uh",
    "start": "2687160",
    "end": "2693000"
  },
  {
    "text": "we should be doing and finally halfway is no way way so we have these defenses",
    "start": "2693000",
    "end": "2700119"
  },
  {
    "text": "and we're only partially adopting them and in some cases in some type of attacks a best effort approach is good",
    "start": "2700119",
    "end": "2707240"
  },
  {
    "text": "but in this case it's not because a single HP request is all you need so",
    "start": "2707240",
    "end": "2713040"
  },
  {
    "text": "even if you reduce the attack surface and let's say 90% of a request I'm going to do within a day is protected if the",
    "start": "2713040",
    "end": "2720040"
  },
  {
    "text": "rest of the 10% is exposed you didn't actually prevent anything",
    "start": "2720040",
    "end": "2725240"
  },
  {
    "text": "and uh from an attack 's point of view I would say try to understand the limitations so look at the defenses try",
    "start": "2725240",
    "end": "2731319"
  },
  {
    "text": "to understand how they work and in which cases which corner cases might not be protected and go from there and try to",
    "start": "2731319",
    "end": "2737960"
  },
  {
    "text": "see how you can attack the system or not so uh with that I'd like to thank you",
    "start": "2737960",
    "end": "2743240"
  },
  {
    "start": "2740000",
    "end": "2740000"
  },
  {
    "text": "for paying attention and coming to our talk when there were so many other awesome talks uh at the same time uh",
    "start": "2743240",
    "end": "2749599"
  },
  {
    "text": "feel free to ask us any questions we'll try to answer them send us an email if you want uh buy us a drink afterwards if",
    "start": "2749599",
    "end": "2756000"
  },
  {
    "text": "you like to talk uh if anyone's interested in pursuing a PhD in security and privacy come talk to",
    "start": "2756000",
    "end": "2761559"
  },
  {
    "text": "me uh that's all thank you",
    "start": "2761559",
    "end": "2767440"
  }
]