[
  {
    "start": "0",
    "end": "10000"
  },
  {
    "text": "okay so what we were doing was performing some kind of request to the",
    "start": "30",
    "end": "6150"
  },
  {
    "text": "mud B simulator using MBT get what we are going to do now is use another tool",
    "start": "6150",
    "end": "13410"
  },
  {
    "start": "10000",
    "end": "186000"
  },
  {
    "text": "that is included in Metasploit framework so as it takes a long time to launch",
    "start": "13410",
    "end": "21439"
  },
  {
    "text": "Metasploit in the vm i suggest that you start by typing MSF console right now",
    "start": "21439",
    "end": "29449"
  },
  {
    "text": "okay so these were the commands used to perform might be squeezed and now we're",
    "start": "92290",
    "end": "98440"
  },
  {
    "text": "going to switch to the next one so we're going to launch MSF console and then use",
    "start": "98440",
    "end": "104530"
  },
  {
    "text": "the Madras client which is an auxiliary module",
    "start": "104530",
    "end": "109350"
  },
  {
    "text": "still not loaded",
    "start": "121340",
    "end": "124909"
  },
  {
    "text": "okay so I'm gonna play run a bit and change the values",
    "start": "130970",
    "end": "136130"
  },
  {
    "text": "okay so here I have the Metasploit console is it okay for everyone have you",
    "start": "164099",
    "end": "171870"
  },
  {
    "text": "been able to launch it okay so I will use an auxiliary module that's into",
    "start": "171870",
    "end": "180109"
  },
  {
    "text": "scanner SCADA and then it's best clients by typing in info you can have some",
    "start": "180109",
    "end": "187590"
  },
  {
    "text": "information on the module so there was previously a Madhu's client module that",
    "start": "187590",
    "end": "193439"
  },
  {
    "text": "only allowed people to write values to coils so that was kind of limited so I",
    "start": "193439",
    "end": "199669"
  },
  {
    "text": "let modified it so it's now part of the",
    "start": "199669",
    "end": "204799"
  },
  {
    "text": "part of the Metasploit framework so how to use it first of all you have to take",
    "start": "204799",
    "end": "211169"
  },
  {
    "text": "a look at what kind of action you can do so sure actions I think yes so you can",
    "start": "211169",
    "end": "218939"
  },
  {
    "text": "read coil with the register write to a coil alright to a register so for",
    "start": "218939",
    "end": "224669"
  },
  {
    "text": "example I'm gonna set action to read the value of a register then I'm gonna take",
    "start": "224669",
    "end": "235739"
  },
  {
    "text": "a look at the options so of course you need to set up your target so once again",
    "start": "235739",
    "end": "242459"
  },
  {
    "text": "it's gonna be localized you have to set",
    "start": "242459",
    "end": "248009"
  },
  {
    "text": "the data address where you want to read for example for me let's say I want to",
    "start": "248009",
    "end": "253829"
  },
  {
    "text": "read value at 5 maybe and then you just",
    "start": "253829",
    "end": "260699"
  },
  {
    "text": "type in the run that's how you run the auxiliary modules and as you can see the",
    "start": "260699",
    "end": "267870"
  },
  {
    "text": "value stored at the register number 5 is 4 which is funny because yes ok so let's",
    "start": "267870",
    "end": "281280"
  },
  {
    "text": "try something else the previous address and it's 3 so yes you can see that those",
    "start": "281280",
    "end": "289860"
  },
  {
    "text": "are the values that I queried maybe it's not interesting too",
    "start": "289860",
    "end": "296530"
  },
  {
    "text": "but to let it to spend too much time I'm just going to show you that you can modify the action as well right register",
    "start": "296530",
    "end": "307530"
  },
  {
    "text": "and then I have to set the data let's say I want to write a 1 to 3 data",
    "start": "308820",
    "end": "316780"
  },
  {
    "text": "address is 4 and then I run as you can",
    "start": "316780",
    "end": "322030"
  },
  {
    "text": "see it says that succeeded and it is true",
    "start": "322030",
    "end": "327450"
  },
  {
    "text": "have you been able to do the same for those of you who are following oh ok",
    "start": "327450",
    "end": "336880"
  },
  {
    "text": "sorry ok I'm gonna try to well I do not know",
    "start": "336880",
    "end": "346090"
  },
  {
    "text": "how to make text bigger but it's my best client in one word everything is lowercase I'm sorry",
    "start": "346090",
    "end": "353830"
  },
  {
    "text": "control yeah but",
    "start": "353830",
    "end": "362250"
  },
  {
    "text": "so here it and I'm guessing control- is for lowering the size let's see my",
    "start": "382960",
    "end": "397030"
  },
  {
    "text": "keyboard mapping is very specific anyway",
    "start": "397030",
    "end": "410490"
  },
  {
    "text": "so let me just go back to the slides",
    "start": "416910",
    "end": "421470"
  },
  {
    "text": "yes so that was on the simulator now I think it's time to try to move on to the",
    "start": "428140",
    "end": "433910"
  },
  {
    "start": "430000",
    "end": "597000"
  },
  {
    "text": "the real PLC's there's something very important no you should never never",
    "start": "433910",
    "end": "440360"
  },
  {
    "text": "never perform any tests on a live ICS systems because there are so much at",
    "start": "440360",
    "end": "447560"
  },
  {
    "text": "risk usually what you can do is try to do your tests on a lab like this one or",
    "start": "447560",
    "end": "454760"
  },
  {
    "text": "you can try to do the tests during a maintenance phase of a plant or a factory in my experience most factories",
    "start": "454760",
    "end": "461780"
  },
  {
    "text": "shut down at least one week each year so try to I know it's difficult but you can",
    "start": "461780",
    "end": "468950"
  },
  {
    "text": "try to plan your tests during this specific phase okay so the first phase",
    "start": "468950",
    "end": "476840"
  },
  {
    "text": "would be the Recon so we're going to try to do a port scan and identify the ICS",
    "start": "476840",
    "end": "482030"
  },
  {
    "text": "on the network so I just plugged in a",
    "start": "482030",
    "end": "490430"
  },
  {
    "text": "Wi-Fi access point sorry so here you",
    "start": "490430",
    "end": "496310"
  },
  {
    "text": "have the SSID and the password just try to connect and tell me if it works yeah",
    "start": "496310",
    "end": "503390"
  },
  {
    "text": "it's kind of a funny SSID",
    "start": "503390",
    "end": "506620"
  },
  {
    "text": "is it okay for you did you succeed in connecting if so you can try to ping the",
    "start": "528570",
    "end": "536430"
  },
  {
    "text": "two PLC's here you have the IP addresses its dot five for the Snyder and that 50",
    "start": "536430",
    "end": "541530"
  },
  {
    "text": "for the Simmons they should answer to ping requests",
    "start": "541530",
    "end": "547140"
  },
  {
    "text": "let me try it yeah works for the Snyder",
    "start": "547140",
    "end": "556530"
  },
  {
    "text": "and for the Simmons okay Yolo swag I'm",
    "start": "556530",
    "end": "567090"
  },
  {
    "text": "gonna put it again",
    "start": "567090",
    "end": "569960"
  },
  {
    "text": "okay so let's start with using an map so",
    "start": "596339",
    "end": "601529"
  },
  {
    "start": "597000",
    "end": "949000"
  },
  {
    "text": "an map is the de-facto tool for performing any kind of reconnaissance or",
    "start": "601529",
    "end": "606820"
  },
  {
    "text": "let's port scanning however it can be quite harmful to do so on ICS on a",
    "start": "606820",
    "end": "613089"
  },
  {
    "text": "related subject once I was doing some penetration tests on building automation",
    "start": "613089",
    "end": "619120"
  },
  {
    "text": "and I just did a nmap full tcp port scan of one was kind of a PLC that was",
    "start": "619120",
    "end": "626920"
  },
  {
    "text": "handling the lights and air conditioning of the building and then and map started",
    "start": "626920",
    "end": "633400"
  },
  {
    "text": "hanging and the phone started ringing so when you do a pen test you know that when the phone rings it's never good",
    "start": "633400",
    "end": "639520"
  },
  {
    "text": "never good news so actually all the communication cards just crashed because",
    "start": "639520",
    "end": "645490"
  },
  {
    "text": "most of the time when you're talking ICS the devices have let's say some weak",
    "start": "645490",
    "end": "651750"
  },
  {
    "text": "tcp/ip stack so it's quite easy to take her from a denial of service sometimes",
    "start": "651750",
    "end": "657370"
  },
  {
    "text": "only by performing a an nmap scan you can find on also to interesting stories",
    "start": "657370",
    "end": "664360"
  },
  {
    "text": "from the NIST standard about people trying to perform penetration tests on",
    "start": "664360",
    "end": "670240"
  },
  {
    "text": "ICS in one case the last four five $50,000 of material and on the other",
    "start": "670240",
    "end": "677520"
  },
  {
    "text": "incident penetration tester just made",
    "start": "677520",
    "end": "683850"
  },
  {
    "text": "there was a big problem with gas distribution so for several hours the company was not able to distribute gas",
    "start": "683850",
    "end": "690130"
  },
  {
    "text": "so yeah that was kind of a big deal so what you can do to prevent this kind of",
    "start": "690130",
    "end": "695440"
  },
  {
    "text": "incident you can use the switch scan delay which will really really make the",
    "start": "695440",
    "end": "703360"
  },
  {
    "text": "scan go slower but it's also safer you should do a TCP scan instead of a sin",
    "start": "703360",
    "end": "709779"
  },
  {
    "text": "scan because when you do a sin scan for some devices they will try to keep the",
    "start": "709779",
    "end": "715630"
  },
  {
    "text": "connection open for a long time since you you know never do the full end shake and that's going to crash them and also",
    "start": "715630",
    "end": "723760"
  },
  {
    "text": "try not to use any fingerprinting function and if you have to use some ml plugins",
    "start": "723760",
    "end": "729640"
  },
  {
    "text": "be wise in the selection of those plugins so yeah that's the theory",
    "start": "729640",
    "end": "735190"
  },
  {
    "text": "however here that's on this small lab we're gonna we're gonna try to be quite",
    "start": "735190",
    "end": "748080"
  },
  {
    "text": "fast so I'm gonna fire nmap so you see",
    "start": "748080",
    "end": "757480"
  },
  {
    "text": "if I inputs can get sorry scandal a",
    "start": "757480",
    "end": "762520"
  },
  {
    "text": "equals one and then I'm gonna try to scan the let's see the Simmons yeah also",
    "start": "762520",
    "end": "776740"
  },
  {
    "text": "input use the end switch to prevent DNS rivers looking so as you can see it's",
    "start": "776740",
    "end": "786880"
  },
  {
    "text": "really slow and I'm using a direct Ethernet cable on a local network so",
    "start": "786880",
    "end": "794950"
  },
  {
    "text": "it's really slow but let's say it's safe for today I'm just gonna do a classical",
    "start": "794950",
    "end": "805630"
  },
  {
    "text": "and maps camp",
    "start": "805630",
    "end": "808350"
  },
  {
    "text": "yeah so as you can see the only open",
    "start": "819809",
    "end": "829749"
  },
  {
    "text": "Service Fund was HTTPS that's because we did not perform a full TCP scan so if",
    "start": "829749",
    "end": "836470"
  },
  {
    "text": "you want to actually scan all the ports we have to use the P switch and now I'm",
    "start": "836470",
    "end": "841600"
  },
  {
    "text": "going to do a full TCP scan if it does not take too long too much time that's",
    "start": "841600",
    "end": "850720"
  },
  {
    "text": "quite long so I'm just going to give you the answer yeah so the two ports that",
    "start": "850720",
    "end": "864100"
  },
  {
    "text": "you should be able to see in TCP are four for three that's used for HTTP and",
    "start": "864100",
    "end": "869319"
  },
  {
    "text": "102 that's actually the the proprietary protocol that Siemens uses to",
    "start": "869319",
    "end": "875499"
  },
  {
    "text": "communicate with the programming software if I do the same for the let's",
    "start": "875499",
    "end": "884829"
  },
  {
    "text": "say for the Schneider you should be able to find some FTP HTTP and some might be",
    "start": "884829",
    "end": "892299"
  },
  {
    "text": "sports yes they are all open does that",
    "start": "892299",
    "end": "900009"
  },
  {
    "text": "work for you also",
    "start": "900009",
    "end": "902850"
  },
  {
    "text": "okay so I just cheated because I wanted to get fast on the nmap scan you can",
    "start": "915930",
    "end": "923350"
  },
  {
    "text": "also find online some specific nmap scripts for ICS I know that Digital bond really is some recently I think it's",
    "start": "923350",
    "end": "931029"
  },
  {
    "text": "project called a red point that's that could be a nice resource to take a look",
    "start": "931029",
    "end": "936220"
  },
  {
    "text": "at and now we're going to use a different tool that is specifically",
    "start": "936220",
    "end": "942579"
  },
  {
    "text": "designed for ICS it was made from the",
    "start": "942579",
    "end": "948930"
  },
  {
    "text": "scatter Strangelove team it's called PLC scan so it's not like nmap so it's not",
    "start": "948930",
    "end": "956170"
  },
  {
    "start": "949000",
    "end": "1139000"
  },
  {
    "text": "going to find all the open ports it's just going to focus on the mud base port and the port used by Simmons so it's",
    "start": "956170",
    "end": "963370"
  },
  {
    "text": "only a port scanning two ports but since these are a legitimate request there's",
    "start": "963370",
    "end": "970570"
  },
  {
    "text": "really a low chance that you will crash anything by doing that so what you can",
    "start": "970570",
    "end": "980589"
  },
  {
    "text": "do is go to the tools directory and then you should have PLC scan I think it's a",
    "start": "980589",
    "end": "989560"
  },
  {
    "text": "Python script so you can take a look at the source code if you want take a look",
    "start": "989560",
    "end": "995260"
  },
  {
    "text": "at the help but anyway I'm just going to do a classical scan so I'm going to scan",
    "start": "995260",
    "end": "1003060"
  },
  {
    "text": "the wall range so it 0/24 so as you can",
    "start": "1003060",
    "end": "1010680"
  },
  {
    "text": "see it's not really fast it takes one IP after one IP and tries to communicate",
    "start": "1010680",
    "end": "1016680"
  },
  {
    "text": "with the port 102 or 502 so quite",
    "start": "1016680",
    "end": "1022410"
  },
  {
    "text": "quickly we can see that the schneider plc was detected the unit ID for which",
    "start": "1022410",
    "end": "1031160"
  },
  {
    "text": "there was a response received is 0 or 255 we can see that we have some",
    "start": "1031160",
    "end": "1037558"
  },
  {
    "text": "information about the the hardware modules so actually 2030 is the the",
    "start": "1037559",
    "end": "1045300"
  },
  {
    "text": "model of the cpu so the the scan is still running when it",
    "start": "1045300",
    "end": "1053420"
  },
  {
    "text": "reaches the dot 50 we will have some information about the the Siemens PLC",
    "start": "1053420",
    "end": "1061840"
  },
  {
    "text": "is it working yes okay so I'm not gonna wait",
    "start": "1069330",
    "end": "1075139"
  },
  {
    "text": "I'm just going scanned at 50 and same",
    "start": "1075139",
    "end": "1080429"
  },
  {
    "text": "way for the Siemens you see that some information was already gathered like",
    "start": "1080429",
    "end": "1086940"
  },
  {
    "text": "the femur version or the hardwood version of the of the CPU you should get",
    "start": "1086940",
    "end": "1095460"
  },
  {
    "text": "the same results no okay sorry",
    "start": "1095460",
    "end": "1105749"
  },
  {
    "text": "the the only difference is that I'm using the disc cable and you're using the Wi-Fi so maybe that's the source of",
    "start": "1105749",
    "end": "1112019"
  },
  {
    "text": "the problem did it work for the photo",
    "start": "1112019",
    "end": "1117419"
  },
  {
    "text": "Schneider yes and not for the Siemens okay quite strange",
    "start": "1117419",
    "end": "1124128"
  },
  {
    "text": "no actually it's PLC scans let's say the",
    "start": "1129230",
    "end": "1134279"
  },
  {
    "text": "standard version I downloaded it two weeks ago I think okay so we just saw",
    "start": "1134279",
    "end": "1141419"
  },
  {
    "start": "1139000",
    "end": "1357000"
  },
  {
    "text": "two different ways of identifying PLC's on the network there's a third way which",
    "start": "1141419",
    "end": "1147119"
  },
  {
    "text": "is called SNMP and I'm gonna show you how actually by default the PLC's",
    "start": "1147119",
    "end": "1153330"
  },
  {
    "text": "respond to SNMP requests so in let's in",
    "start": "1153330",
    "end": "1162389"
  },
  {
    "text": "Cali you have a call a tool that is called SNMP check you use the switch T",
    "start": "1162389",
    "end": "1168570"
  },
  {
    "text": "and then you input the IP address so in this case SNMP SNMP check minus T and",
    "start": "1168570",
    "end": "1176489"
  },
  {
    "text": "then the dot five and it's gonna give",
    "start": "1176489",
    "end": "1181590"
  },
  {
    "text": "you a lot of information so if I start",
    "start": "1181590",
    "end": "1188279"
  },
  {
    "text": "you have the hardware version then you have the network configuration and then",
    "start": "1188279",
    "end": "1194220"
  },
  {
    "text": "something that's quite interesting you have the different network routes configured and also all the listening",
    "start": "1194220",
    "end": "1201990"
  },
  {
    "text": "ports on CP and UDP so instead of performing and networks can you just you can just",
    "start": "1201990",
    "end": "1208289"
  },
  {
    "text": "perform an SNMP request and it will tell you what are the parts available that",
    "start": "1208289",
    "end": "1213480"
  },
  {
    "text": "can come nd also I can do the same on the Siemens I think I should get similar",
    "start": "1213480",
    "end": "1221700"
  },
  {
    "text": "results you see that there is three",
    "start": "1221700",
    "end": "1226710"
  },
  {
    "text": "different UDP ports I actually do not know what the last two are used for and",
    "start": "1226710",
    "end": "1235370"
  },
  {
    "text": "I do not have the the list of listening",
    "start": "1235370",
    "end": "1240779"
  },
  {
    "text": "TCP ports so did not have the same level of information but that's kinda",
    "start": "1240779",
    "end": "1246389"
  },
  {
    "text": "interesting to know just by sending a SNMP request you can gather interesting information",
    "start": "1246389",
    "end": "1253190"
  },
  {
    "text": "yes exactly if for example maybe it's a good idea I'm gonna try to do that so I will",
    "start": "1260270",
    "end": "1268680"
  },
  {
    "text": "launch a unity Pro which is neither programming software",
    "start": "1268680",
    "end": "1274640"
  },
  {
    "text": "I'm going to try to connect I guess now",
    "start": "1286120",
    "end": "1291340"
  },
  {
    "text": "I'm connected I'm gonna start the PLC",
    "start": "1291340",
    "end": "1297549"
  },
  {
    "text": "again and then we sit on that five so",
    "start": "1297549",
    "end": "1304990"
  },
  {
    "text": "yes wait that's me that should be me so",
    "start": "1304990",
    "end": "1315370"
  },
  {
    "text": "you actually have the IP address of the programming software and also someone on",
    "start": "1315370",
    "end": "1321820"
  },
  {
    "text": "the FTP yes I do not use it during this",
    "start": "1321820",
    "end": "1330760"
  },
  {
    "text": "demonstration but yes I think it should be a 51 or something VIP between 50 and",
    "start": "1330760",
    "end": "1336039"
  },
  {
    "text": "60 I dunno so apparently someone just put the PLC back in stop mode that's why the lights",
    "start": "1336039",
    "end": "1341980"
  },
  {
    "text": "shut off okay",
    "start": "1341980",
    "end": "1346710"
  },
  {
    "text": "and back on ok so next what we can do is",
    "start": "1354140",
    "end": "1360710"
  },
  {
    "start": "1357000",
    "end": "1804000"
  },
  {
    "text": "try to take a look at those let's say interfaces that we discovered for example the FTP the HTTP try to find",
    "start": "1360710",
    "end": "1368600"
  },
  {
    "text": "some vulnerabilities once again I will everything that I'm gonna demonstrate is already known so no",
    "start": "1368600",
    "end": "1375620"
  },
  {
    "text": "zero day today ok so let's take a look",
    "start": "1375620",
    "end": "1381350"
  },
  {
    "text": "at the web interface actually I think it",
    "start": "1381350",
    "end": "1388790"
  },
  {
    "text": "will not work on the VM because I failed to install the Java material plug-in and",
    "start": "1388790",
    "end": "1395049"
  },
  {
    "text": "web interface of the Sneijder heavily relies on Java applets so as you can see",
    "start": "1395049",
    "end": "1402830"
  },
  {
    "text": "really looks like the one from the Internet and for example if I try to go",
    "start": "1402830",
    "end": "1411890"
  },
  {
    "text": "to the monitoring tab I just have two options that are called data editor I'm",
    "start": "1411890",
    "end": "1417620"
  },
  {
    "text": "gonna click on the standard one and then I have a proverb that asked me to input",
    "start": "1417620",
    "end": "1424280"
  },
  {
    "text": "some password so do you know the password did anyone try to guess the",
    "start": "1424280",
    "end": "1429380"
  },
  {
    "text": "password sorry nope yes and the password nope",
    "start": "1429380",
    "end": "1440020"
  },
  {
    "text": "user user this can be changed of course",
    "start": "1440249",
    "end": "1446789"
  },
  {
    "text": "but yeah so here you can see that you",
    "start": "1446789",
    "end": "1451869"
  },
  {
    "text": "have a nice Java applet that should allow you to perform some kind of modification on the plc you should",
    "start": "1451869",
    "end": "1458499"
  },
  {
    "text": "modify the should be able to modify the on the some data I think the the value",
    "start": "1458499",
    "end": "1465309"
  },
  {
    "text": "of the register and the coils what else do we have basically you can see what",
    "start": "1465309",
    "end": "1474820"
  },
  {
    "text": "the PLC look like if you're not just near the PLC you can see that it's in run mode and then you have an",
    "start": "1474820",
    "end": "1481059"
  },
  {
    "text": "input/output card some information about",
    "start": "1481059",
    "end": "1488259"
  },
  {
    "text": "the the firmware and in the setup menu you can modify some some of the things",
    "start": "1488259",
    "end": "1495399"
  },
  {
    "text": "like the HTTP access rights and specific passwords okay so now what we can do is",
    "start": "1495399",
    "end": "1508830"
  },
  {
    "text": "let me go back here so as I told you there is a lot of several Java applets",
    "start": "1508830",
    "end": "1515110"
  },
  {
    "text": "on this web server if you look in the files directory on the VM there's a",
    "start": "1515110",
    "end": "1520269"
  },
  {
    "text": "subdirectory that is called jars and that contains all the Java applets that",
    "start": "1520269",
    "end": "1525899"
  },
  {
    "text": "I recovered from the from the PLC so",
    "start": "1525899",
    "end": "1536649"
  },
  {
    "text": "what will be interesting to do is try to let Sadie compile those applets or perform any kind of analysis to see what",
    "start": "1536649",
    "end": "1545440"
  },
  {
    "text": "what is in the India plate so the most basic one would be to perform a string query of course so I'm going to look for",
    "start": "1545440",
    "end": "1556090"
  },
  {
    "text": "any word that's longer than six characters in the India plaits",
    "start": "1556090",
    "end": "1564330"
  },
  {
    "text": "and here you can pick whatever you whichever you want I'm gonna try these",
    "start": "1564580",
    "end": "1570060"
  },
  {
    "text": "strings sorry yes it was we're gonna see",
    "start": "1570060",
    "end": "1581050"
  },
  {
    "text": "it i Pappy pipe it into more so as you",
    "start": "1581050",
    "end": "1587320"
  },
  {
    "text": "can see you can find some information and what we are going to look for is",
    "start": "1587320",
    "end": "1592480"
  },
  {
    "text": "maybe I don't know we could grab for password or username things like that",
    "start": "1592480",
    "end": "1598980"
  },
  {
    "text": "anyway you can see that you can recover some kind of information I think you",
    "start": "1598980",
    "end": "1610450"
  },
  {
    "text": "also should have on your VM let's go",
    "start": "1610450",
    "end": "1616360"
  },
  {
    "text": "into the tools directory you should have something that's called Gd guy which is",
    "start": "1616360",
    "end": "1621520"
  },
  {
    "text": "a java decompiler so on my VM it's not working but you should launch it I'm gonna launch it on",
    "start": "1621520",
    "end": "1627070"
  },
  {
    "text": "my host so if I open the same jar file",
    "start": "1627070",
    "end": "1632700"
  },
  {
    "text": "with the java decompiler and i take a look let's say maybe at the i do not",
    "start": "1632700",
    "end": "1640240"
  },
  {
    "text": "remember it is there is a miss key and then global config could be interesting",
    "start": "1640240",
    "end": "1649290"
  },
  {
    "text": "so as you can see there's something called ftp logging and ftp password hard-coded into this java applet so good",
    "start": "1650160",
    "end": "1657850"
  },
  {
    "text": "luck for changing the password and as suggest we try to connect to the FTP",
    "start": "1657850",
    "end": "1663100"
  },
  {
    "text": "service using those credential to see if they really work or if they do not work I think you already know the answer",
    "start": "1663100",
    "end": "1671970"
  },
  {
    "text": "here you can find that the credits the username is CSD AG and the password is factory cast at Schneider so with these",
    "start": "1693570",
    "end": "1706119"
  },
  {
    "text": "two credentials you should be able to connect to the FTP server of the Schneider and then you can try to find",
    "start": "1706119",
    "end": "1712720"
  },
  {
    "text": "all the files that you want you will also be able to find a file that contains the word user which is the",
    "start": "1712720",
    "end": "1719619"
  },
  {
    "text": "username and the password required for the web interface",
    "start": "1719619",
    "end": "1724888"
  },
  {
    "text": "sorry it's too much complex of four password so you can see that of things",
    "start": "1743110",
    "end": "1757300"
  },
  {
    "text": "and in the Arditi directory at the root of the ftp server",
    "start": "1759940",
    "end": "1767630"
  },
  {
    "text": "you can find a file that's called password dot our de I think it's already in the VM and it only contains the word",
    "start": "1767630",
    "end": "1774200"
  },
  {
    "text": "user",
    "start": "1774200",
    "end": "1776470"
  },
  {
    "text": "let's get back to it slide okay so that",
    "start": "1791160",
    "end": "1796930"
  },
  {
    "text": "was a few example of what we can do with the standard interfaces and I think now",
    "start": "1796930",
    "end": "1802330"
  },
  {
    "text": "it's time to to move on to ICS specific protocols and vulnerabilities so yes",
    "start": "1802330",
    "end": "1812370"
  },
  {
    "start": "1804000",
    "end": "1834000"
  },
  {
    "text": "let's say for the Schneider what we can try to do is modify the value of some registers to be able to put the lights",
    "start": "1812370",
    "end": "1820750"
  },
  {
    "text": "on as you can see the only one that is on at the moment I think two additional",
    "start": "1820750",
    "end": "1826320"
  },
  {
    "text": "lamps can be turned on by modifying the web base value and for the Siemens you",
    "start": "1826320",
    "end": "1832300"
  },
  {
    "text": "have in the tools slash scan seven",
    "start": "1832300",
    "end": "1837390"
  },
  {
    "start": "1834000",
    "end": "2284000"
  },
  {
    "text": "directory you have two specific tools that I wrote for the Siemens and you can",
    "start": "1837390",
    "end": "1843190"
  },
  {
    "text": "also read the different values and modify the values so of course if everyone does it at the same time it's",
    "start": "1843190",
    "end": "1849130"
  },
  {
    "text": "going to be a kind of a mess but I think we can try",
    "start": "1849130",
    "end": "1854790"
  },
  {
    "text": "okay so I'm gonna use em bTW get to let's say read values and now I'm gonna",
    "start": "1866380",
    "end": "1895540"
  },
  {
    "text": "try to modify some value so clearly this depends on the way the PLC was",
    "start": "1895540",
    "end": "1900580"
  },
  {
    "text": "programmed so for example in my case I can tell you if you change the value to",
    "start": "1900580",
    "end": "1906460"
  },
  {
    "text": "1 you're justifying the right address and it should but the other lights on I",
    "start": "1906460",
    "end": "1912610"
  },
  {
    "text": "think it's the address 9 maybe yes and there should be another one maybe 8 nope",
    "start": "1912610",
    "end": "1922920"
  },
  {
    "text": "then yes the last one is broken so I'll",
    "start": "1922920",
    "end": "1928060"
  },
  {
    "text": "let you play with it for a few minutes to make sure that it works of course at",
    "start": "1928060",
    "end": "1934540"
  },
  {
    "text": "the same time you should be you could be using wireshark to take a look at the data packets but it's exactly the same",
    "start": "1934540",
    "end": "1939940"
  },
  {
    "text": "as what we've done with the simulator",
    "start": "1939940",
    "end": "1944429"
  },
  {
    "text": "so for example if used the same common but you replace one by zero you should",
    "start": "1954130",
    "end": "1959480"
  },
  {
    "text": "be able to turn one of the light of",
    "start": "1959480",
    "end": "1963400"
  },
  {
    "text": "yes",
    "start": "1976850",
    "end": "1979450"
  },
  {
    "text": "and if we all do it at the same time it's gonna go crazy I have no idea",
    "start": "1983360",
    "end": "1992750"
  },
  {
    "text": "actually it depends on does not depend on the PLC I use some kind of electrical relays",
    "start": "1992750",
    "end": "1999020"
  },
  {
    "text": "because the PLC uses 20 24 volts for the outputs and the lamps only use 12 so I",
    "start": "1999020",
    "end": "2006640"
  },
  {
    "text": "think if we do it all at the same time we in maybe in two or three days we're gonna break the relays because they they",
    "start": "2006640",
    "end": "2013090"
  },
  {
    "text": "have a limited lifespan but that's all the PLC is not going to be broken sorry",
    "start": "2013090",
    "end": "2022800"
  },
  {
    "text": "yes also because that's let's say a home router or so yeah okay so apparently",
    "start": "2022800",
    "end": "2030610"
  },
  {
    "text": "that works then we could also try oh",
    "start": "2030610",
    "end": "2035620"
  },
  {
    "text": "yeah something it's also interesting whatever you do you I think there is one",
    "start": "2035620",
    "end": "2042370"
  },
  {
    "text": "light that you will not be able to to modify why because if during the program",
    "start": "2042370",
    "end": "2049389"
  },
  {
    "text": "that I put in the PLC I said for example this light should be on the PLC as a",
    "start": "2049390",
    "end": "2056080"
  },
  {
    "text": "let's say CPU cycle so every I think it's around 20 or 30 milliseconds it",
    "start": "2056080",
    "end": "2062980"
  },
  {
    "text": "will check in individual let's say reprocess all the program so even if you",
    "start": "2062980",
    "end": "2068260"
  },
  {
    "text": "can turn the value to off 20 milli seconds later is going to turn back to on so you with your eyes you cannot see",
    "start": "2068260",
    "end": "2075669"
  },
  {
    "text": "anything happening ok so now for the for",
    "start": "2075670",
    "end": "2081129"
  },
  {
    "text": "the Siemens if you go into the scan 7 folder you can see sorry that you have",
    "start": "2081130",
    "end": "2086560"
  },
  {
    "text": "several Python scripts that I wrote myself if you use the read new and you",
    "start": "2086560",
    "end": "2097750"
  },
  {
    "text": "input the IP address yes I should be",
    "start": "2097750",
    "end": "2103030"
  },
  {
    "text": "able to see the the values of the input and the output I'm gonna just make a little test and flip the two first",
    "start": "2103030",
    "end": "2111010"
  },
  {
    "text": "switch",
    "start": "2111010",
    "end": "2113400"
  },
  {
    "text": "and if I do it again yes you can see that input zero and it points one now",
    "start": "2117530",
    "end": "2124260"
  },
  {
    "text": "set to one and also the output that depends of course of the programming software does that work for you also for",
    "start": "2124260",
    "end": "2132960"
  },
  {
    "text": "the Siemens because we had problems before with the PLC scan that's exactly",
    "start": "2132960",
    "end": "2141570"
  },
  {
    "text": "the that's the request that's written it's a Python and you use then the script okay great",
    "start": "2141570",
    "end": "2150620"
  },
  {
    "text": "so now as you can see in the directory there is also a script that is called",
    "start": "2151170",
    "end": "2157710"
  },
  {
    "text": "write output so I'm gonna try to use that one and the parameters the first",
    "start": "2157710",
    "end": "2169140"
  },
  {
    "text": "one is the IP address and the other one let's see yeah I'm not a really good",
    "start": "2169140",
    "end": "2175380"
  },
  {
    "text": "programmer so there are five outputs for the this kind of Siemens PLC so here you",
    "start": "2175380",
    "end": "2182340"
  },
  {
    "text": "just have to input a one for each of the outputs you want to put two on and if",
    "start": "2182340",
    "end": "2188370"
  },
  {
    "text": "you put a zero it that's changed to off so I think this one this will shut the",
    "start": "2188370",
    "end": "2196050"
  },
  {
    "text": "lights off and this will shut two or three online yeah three but again anyone",
    "start": "2196050",
    "end": "2203610"
  },
  {
    "text": "doing the same with a different value that's it the last one gets the last word and this time on the Siemens the",
    "start": "2203610",
    "end": "2214440"
  },
  {
    "text": "relays are actually part of the PLC so I'm sure if we all send different comments we can break the actual plc",
    "start": "2214440",
    "end": "2223280"
  },
  {
    "text": "sometimes someday and there is a nice",
    "start": "2223280",
    "end": "2228480"
  },
  {
    "text": "clicking also",
    "start": "2228480",
    "end": "2231200"
  },
  {
    "text": "okay so these streets are not online yet there will be on my github maybe this",
    "start": "2237160",
    "end": "2243050"
  },
  {
    "text": "weekend I don't know of course it depends on the configuration of the PLC I use a",
    "start": "2243050",
    "end": "2249230"
  },
  {
    "text": "specific library also that's called snap seven it was developed to allow third party to develop software that",
    "start": "2249230",
    "end": "2256220"
  },
  {
    "text": "communicates with PLC so I'm just using snap seven and a Python wipe wrapper so",
    "start": "2256220",
    "end": "2263180"
  },
  {
    "text": "it's really a basic script do not look at the source code it's but it works",
    "start": "2263180",
    "end": "2269530"
  },
  {
    "text": "okay so this was for the first part and then I have two other things to show you",
    "start": "2280350",
    "end": "2288960"
  },
  {
    "start": "2284000",
    "end": "2764000"
  },
  {
    "text": "I think someone already tried the first one which is the Metasploit module to put the plc in a stop or start mode",
    "start": "2288960",
    "end": "2297290"
  },
  {
    "text": "it's actually an action that is done and I think in an onion thang ticketed way",
    "start": "2297290",
    "end": "2303270"
  },
  {
    "text": "sorry so I'm hoping I have one msf",
    "start": "2303270",
    "end": "2309660"
  },
  {
    "text": "consult still open and yes okay so this",
    "start": "2309660",
    "end": "2326250"
  },
  {
    "text": "time we're going to use it's also an auxiliary module it's in admin SCADA and",
    "start": "2326250",
    "end": "2331470"
  },
  {
    "text": "then modicon command I think",
    "start": "2331470",
    "end": "2337040"
  },
  {
    "text": "so if you take a look at the info it's actually something that was discovered",
    "start": "2343620",
    "end": "2350140"
  },
  {
    "text": "by Digital bond I suggest by running this module you also run Wireshark I'm gonna do that I'm",
    "start": "2350140",
    "end": "2359590"
  },
  {
    "text": "gonna listen to one of my interface I think it's this one okay so of course I",
    "start": "2359590",
    "end": "2373390"
  },
  {
    "text": "have to set the target it's not this one and they are just type in a run and it",
    "start": "2373390",
    "end": "2387460"
  },
  {
    "text": "shuts down okay so now I'm going to take a look at the wireshark capture okay so",
    "start": "2387460",
    "end": "2398620"
  },
  {
    "text": "as you can see since neck egg and then some not be square is if we take a",
    "start": "2398620",
    "end": "2408550"
  },
  {
    "text": "closer look same as before transaction identifier is",
    "start": "2408550",
    "end": "2415900"
  },
  {
    "text": "zero but that's interesting the comment",
    "start": "2415900",
    "end": "2422020"
  },
  {
    "text": "that I sent actually uses an unknown function code which is 90 or 5a in hex",
    "start": "2422020",
    "end": "2428310"
  },
  {
    "text": "to send specific comments to the Schneider PLC so that's an all",
    "start": "2428310",
    "end": "2433930"
  },
  {
    "text": "venerability to my knowledge it's it has never been fixed and then when you set mode to run",
    "start": "2433930",
    "end": "2444130"
  },
  {
    "text": "you can put the PLC back to run sometimes it will not work right away",
    "start": "2444130",
    "end": "2449850"
  },
  {
    "text": "because there is some kind of reservation mechanism and if I put the PLC in to stop mode I have to wait",
    "start": "2449850",
    "end": "2455830"
  },
  {
    "text": "several minutes to set it to run again depending so that could be also kind of",
    "start": "2455830",
    "end": "2464350"
  },
  {
    "text": "a big deal for your clients because if all the PLC's have shut down and you produce nothing on your plant or factory so",
    "start": "2464350",
    "end": "2471720"
  },
  {
    "text": "okay then the last one I want to show",
    "start": "2478580",
    "end": "2484110"
  },
  {
    "text": "you still in auxiliary admin SCADA so",
    "start": "2484110",
    "end": "2491310"
  },
  {
    "text": "it's called MIDI constructs stacks transfer and there is an underscore ASO version so it's a version that I've",
    "start": "2491310",
    "end": "2498300"
  },
  {
    "text": "modified I think it's in the info as of today it's not part of the Metasploit",
    "start": "2498300",
    "end": "2504090"
  },
  {
    "text": "module because let's say it's not really greatly coded and also it does not work",
    "start": "2504090",
    "end": "2510960"
  },
  {
    "text": "all the time it's a modification of the original module by digital bond because",
    "start": "2510960",
    "end": "2518640"
  },
  {
    "text": "there was some specific issues in the module but Digital bond some of the",
    "start": "2518640",
    "end": "2525090"
  },
  {
    "text": "counter were not right so I just modified some of the code and I also",
    "start": "2525090",
    "end": "2534300"
  },
  {
    "text": "added an action that allows to gather information so let's run that and let's",
    "start": "2534300",
    "end": "2547110"
  },
  {
    "text": "see if it works as do you know the plc is in a stop mode but yes it works so",
    "start": "2547110",
    "end": "2552750"
  },
  {
    "text": "you can recover the plc model project name as you can see it's not correctly",
    "start": "2552750",
    "end": "2558000"
  },
  {
    "text": "decoded you can see that it was done using unity software version 5 and then",
    "start": "2558000",
    "end": "2563310"
  },
  {
    "text": "you can see the comments of the project so that may or may not be interesting",
    "start": "2563310",
    "end": "2569390"
  },
  {
    "text": "what's really interesting is to be able to set the action to download then I",
    "start": "2569390",
    "end": "2577170"
  },
  {
    "text": "just have to put a file name or so I'm gonna say /root slash test a px",
    "start": "2577170",
    "end": "2584990"
  },
  {
    "text": "so this could take some time I'm gonna take a look at Wireshark to see what's going on as you can see more mud boosts",
    "start": "2586920",
    "end": "2596340"
  },
  {
    "text": "TCP requests still using the function cut 90 so I'm actually retrieving the",
    "start": "2596340",
    "end": "2603940"
  },
  {
    "text": "program of the PLC using a mud base command which is an authenticated and an unencrypted ok so apparently it worked",
    "start": "2603940",
    "end": "2618599"
  },
  {
    "text": "it's a problem of a decision that someone made to use an unauthenticated protocol to allows our arbitrary",
    "start": "2627000",
    "end": "2634330"
  },
  {
    "text": "download of the program file yes that's actually not part of the madras protocol at all it's not in the specification yes",
    "start": "2634330",
    "end": "2646690"
  },
  {
    "text": "actually this this specific model of Siemens does not support notice by default so yes I cannot use this",
    "start": "2646690",
    "end": "2652780"
  },
  {
    "text": "vulnerability however in the past I think that someone would present it at blackhat to us in 2011 demonstrated some",
    "start": "2652780",
    "end": "2662560"
  },
  {
    "text": "vulnerabilities like an authenticated start and stop on the Siemens and different kind of denial of service but",
    "start": "2662560",
    "end": "2670600"
  },
  {
    "text": "I'm not sure it was able to download the program and not sure about that so as",
    "start": "2670600",
    "end": "2677020"
  },
  {
    "text": "you can see tests that a Peaks just just a classic fall file let's see we're",
    "start": "2677020",
    "end": "2686320"
  },
  {
    "text": "gonna try to take a look at the hex data so nothing really interesting at least",
    "start": "2686320",
    "end": "2694210"
  },
  {
    "text": "at the beginning",
    "start": "2694210",
    "end": "2696720"
  },
  {
    "text": "here you can see that this is the project name of the program this is the",
    "start": "2699290",
    "end": "2706349"
  },
  {
    "text": "comments that I put in the unity version so I think the the attack worked then",
    "start": "2706349",
    "end": "2717690"
  },
  {
    "text": "you will see a lot of error messages written in French I do not know its if",
    "start": "2717690",
    "end": "2723300"
  },
  {
    "text": "it's in French because Snyder is a French company or because I'm using a French version of the software I have no",
    "start": "2723300",
    "end": "2729660"
  },
  {
    "text": "idea so yes here you can see that we",
    "start": "2729660",
    "end": "2735599"
  },
  {
    "text": "recover the the program the thing is at",
    "start": "2735599",
    "end": "2742290"
  },
  {
    "text": "the moment you do not know how to use it because a px file will not be opened directly by unity probe so what I did to",
    "start": "2742290",
    "end": "2750390"
  },
  {
    "text": "be able to exploit it is create a dummy project in unity Pro archive it and then",
    "start": "2750390",
    "end": "2756690"
  },
  {
    "text": "it's a file with the sta extension then you just rename it to zip you unzip it",
    "start": "2756690",
    "end": "2763260"
  },
  {
    "text": "and you can see what's inside I think I have it on my VM maybe I have to switch",
    "start": "2763260",
    "end": "2776190"
  },
  {
    "text": "to the other VM",
    "start": "2776190",
    "end": "2779030"
  },
  {
    "text": "okay so here on the desktop I should have it",
    "start": "2788640",
    "end": "2796250"
  },
  {
    "text": "yes so here you have a classical STL file so that's an archive of a unity",
    "start": "2796850",
    "end": "2802230"
  },
  {
    "text": "project okay now it's a zip file so you",
    "start": "2802230",
    "end": "2818280"
  },
  {
    "text": "can see that different file if you go to beam up you have been stationed at a px so actually all you have to do is",
    "start": "2818280",
    "end": "2824640"
  },
  {
    "text": "replace this Epix file by the one you just download with the module you will rename it to station that a px and then",
    "start": "2824640",
    "end": "2831390"
  },
  {
    "text": "you can open the project in unity so that means you have let's say the wall source code of the PA of the PLC project",
    "start": "2831390",
    "end": "2837690"
  },
  {
    "text": "on your computer so that's kind of interesting what's also interesting is",
    "start": "2837690",
    "end": "2842940"
  },
  {
    "text": "the vulnerability allows you to perform just the opposite and by the opposite I mean reprogramming the PLC using the",
    "start": "2842940",
    "end": "2849300"
  },
  {
    "text": "same functions so that's also kind of a big deal because you could let's say seriously disrupt the industrial process by doing",
    "start": "2849300",
    "end": "2857940"
  },
  {
    "text": "so so if you want to if you want to use",
    "start": "2857940",
    "end": "2863850"
  },
  {
    "text": "the Metasploit module you can do it but if several people do it at the same time I'm not sure it's going to work but you",
    "start": "2863850",
    "end": "2870030"
  },
  {
    "text": "can try be my guest",
    "start": "2870030",
    "end": "2873050"
  },
  {
    "text": "okay and that leads me to the conclusion of this workshop I think I've",
    "start": "2880980",
    "end": "2887800"
  },
  {
    "start": "2884000",
    "end": "3070000"
  },
  {
    "text": "demonstrated a lot of vulnerabilities of bad behavior in ICS now the question is",
    "start": "2887800",
    "end": "2894070"
  },
  {
    "text": "what can we do about it you can try to do some things you have to do that you",
    "start": "2894070",
    "end": "2899079"
  },
  {
    "text": "have to know that it's not really easy but network segmentation for example as",
    "start": "2899079",
    "end": "2904150"
  },
  {
    "text": "I demonstrated with showed an you can find ICS on the Internet that's not normal I do not understand why it is the",
    "start": "2904150",
    "end": "2911440"
  },
  {
    "text": "case so that's the first step actually actually scan the internet or you",
    "start": "2911440",
    "end": "2916570"
  },
  {
    "text": "shouldn't to find your own ICS and be sure that there are not on the Internet so some of my clients did and they found",
    "start": "2916570",
    "end": "2924460"
  },
  {
    "text": "some interesting things secondly you should also restrict the access from the",
    "start": "2924460",
    "end": "2929829"
  },
  {
    "text": "corporate network to the ICS to prevent attackers from getting in for example when we pair from penetration test like",
    "start": "2929829",
    "end": "2936010"
  },
  {
    "text": "95% of the time we get admin of the windows I've been Active Directory",
    "start": "2936010",
    "end": "2942460"
  },
  {
    "text": "domain so if it's easy to go from the corporate network to the ICS we're going to also be a admin of your ICS that",
    "start": "2942460",
    "end": "2949240"
  },
  {
    "text": "that's that's not acceptable patch when you can so yes even if you do it only",
    "start": "2949240",
    "end": "2955869"
  },
  {
    "text": "once a year try to apply security patches on your PLC's on the Windows",
    "start": "2955869",
    "end": "2961810"
  },
  {
    "text": "machine you can also do the same if you have to just use a dedicated wsus for",
    "start": "2961810",
    "end": "2967060"
  },
  {
    "text": "you ICS that's not a problem it can be done try to apply some corporate best",
    "start": "2967060",
    "end": "2973690"
  },
  {
    "text": "practices so changing default password that's something why well no no yeah not",
    "start": "2973690",
    "end": "2979630"
  },
  {
    "text": "everybody does it on the corporate network but most people do you should try to do the same on your ICS when you",
    "start": "2979630",
    "end": "2985329"
  },
  {
    "text": "can of course for the hard-coded credentials you can't but at least do what you can do the same the same for",
    "start": "2985329",
    "end": "2992109"
  },
  {
    "text": "the services on specific model of PLC you can disable the webserver you can disable the FTP server most of the time",
    "start": "2992109",
    "end": "3000000"
  },
  {
    "text": "nobody use it so just disable it and then the most important point I think",
    "start": "3000000",
    "end": "3005400"
  },
  {
    "text": "it's time to start monitoring the security of the ICS so some IPS have specific signatures for",
    "start": "3005400",
    "end": "3013240"
  },
  {
    "text": "ICS you can also define your own that's not very complicated and in order to be",
    "start": "3013240",
    "end": "3018910"
  },
  {
    "text": "efficient I think we have to start today trying to step-by-step monitoring some part of it and to be able to make it",
    "start": "3018910",
    "end": "3026740"
  },
  {
    "text": "work tomorrow at a broader level and so I was looking for a good conclusion but",
    "start": "3026740",
    "end": "3032200"
  },
  {
    "text": "I did not find any so I just put two funny pictures to remind us that yes we",
    "start": "3032200",
    "end": "3037630"
  },
  {
    "text": "can do some things to secure the ICS but it's really costly and that's also why people do not do it just simply okay do",
    "start": "3037630",
    "end": "3046990"
  },
  {
    "text": "you have any question for me now I think I speak a lot but I'll be happy to",
    "start": "3046990",
    "end": "3052330"
  },
  {
    "text": "answer any question you can also still enjoy the lab for a few minutes if you",
    "start": "3052330",
    "end": "3058480"
  },
  {
    "text": "want to try to crash everything No okay",
    "start": "3058480",
    "end": "3065650"
  },
  {
    "text": "thank you",
    "start": "3065650",
    "end": "3068160"
  }
]