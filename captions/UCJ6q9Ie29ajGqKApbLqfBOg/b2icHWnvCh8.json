[
  {
    "start": "0",
    "end": "384000"
  },
  {
    "text": "hi do we have any iphone or macbook users listening",
    "start": "2320",
    "end": "8480"
  },
  {
    "text": "what about samsung galaxy amazon echo or raspberry pi users",
    "start": "8480",
    "end": "14639"
  },
  {
    "text": "now i can't see you as we're streaming virtually but i'm pretty sure a lot of virtual hands were just raised",
    "start": "14639",
    "end": "22400"
  },
  {
    "text": "now what if i told you that anyone could break into your encrypted wi-fi communication",
    "start": "22640",
    "end": "29519"
  },
  {
    "text": "when you connect to a wpa2 protected encrypted wi-fi network then even without tls on the application",
    "start": "29519",
    "end": "36719"
  },
  {
    "text": "layer no one should be able to read the data exchanged between your device and the wireless access",
    "start": "36719",
    "end": "42840"
  },
  {
    "text": "point but that was not the case because your devices and not only those that i",
    "start": "42840",
    "end": "48160"
  },
  {
    "text": "mentioned had this serious wi-fi vulnerability",
    "start": "48160",
    "end": "53120"
  },
  {
    "text": "that was the discovery of eset's iot research team that's dedicated to finding vulnerabilities in popular devices used",
    "start": "53360",
    "end": "60239"
  },
  {
    "text": "at home and in the enterprise we feel this type of research is really important",
    "start": "60239",
    "end": "66880"
  },
  {
    "text": "we participated on a forester report that went out earlier this year and the conclusions were that consumer",
    "start": "66880",
    "end": "73360"
  },
  {
    "text": "iot devices are expanding the enterprise attack surface now couple that with the fact that most",
    "start": "73360",
    "end": "80799"
  },
  {
    "text": "consumer iot devices can be exploited and it's a disaster waiting to happen",
    "start": "80799",
    "end": "87840"
  },
  {
    "text": "our iot research team found flaws in a bunch of different devices in smart cameras that",
    "start": "88080",
    "end": "94960"
  },
  {
    "text": "allowed an unauthorized adversary to see whatever that camera saw you don't want that right in amazon echo",
    "start": "94960",
    "end": "103119"
  },
  {
    "text": "in insecure smart home hubs by various different manufacturers and smart home hubs are the gateway to",
    "start": "103119",
    "end": "110159"
  },
  {
    "text": "your whole home or potentially your your company if you're using them in a small home office",
    "start": "110159",
    "end": "116560"
  },
  {
    "text": "and the effect of that depends on what's",
    "start": "116560",
    "end": "122640"
  },
  {
    "text": "connected to that smart home so you can use your imagination but crook is our most impactful",
    "start": "122640",
    "end": "128879"
  },
  {
    "text": "discovery yet that's because it goes beyond iot in the sense of cool smart gadgets like your",
    "start": "128879",
    "end": "135840"
  },
  {
    "text": "smart watch or your smart toaster crook affected billions of wi-fi capable devices",
    "start": "135840",
    "end": "142959"
  },
  {
    "text": "including your laptops tablets and phones",
    "start": "142959",
    "end": "147840"
  },
  {
    "text": "i'm robert lipowski he sets senior malware researcher and my co-speaker today is stefan",
    "start": "148560",
    "end": "154000"
  },
  {
    "text": "svodenchik hi he said's head of experimental research and detection",
    "start": "154000",
    "end": "159920"
  },
  {
    "text": "but credit also goes to milos cermak who was the lead researcher behind this discovery",
    "start": "159920",
    "end": "165120"
  },
  {
    "text": "as well as issa researcher martin kalosnik this and other types of threat research",
    "start": "165120",
    "end": "173120"
  },
  {
    "text": "are in eset's dna and it goes hand in hand with our focus for the past 30 years on proactive detection",
    "start": "173120",
    "end": "180319"
  },
  {
    "text": "so this is our agenda for today we'll talk about crook what it is and how it works its impact",
    "start": "180319",
    "end": "187120"
  },
  {
    "text": "how it can affect you and the security of your devices and what you can do about it also",
    "start": "187120",
    "end": "194319"
  },
  {
    "text": "for the first time we're going to disclose our latest findings into vulnerabilities which aren't strictly crook but are similar",
    "start": "194319",
    "end": "203680"
  },
  {
    "text": "now before we get into the specifics of the vulnerability and its impact let's quickly go over some wi-fi",
    "start": "204560",
    "end": "211280"
  },
  {
    "text": "security basics which are needed to understand how crook works",
    "start": "211280",
    "end": "216480"
  },
  {
    "text": "first i'm going to talk about wi-fi associations and disassociations",
    "start": "216799",
    "end": "222000"
  },
  {
    "text": "and the four-way handshake so the first thing that happens when you",
    "start": "222000",
    "end": "227040"
  },
  {
    "text": "connect your device to an access point is called the association basically a",
    "start": "227040",
    "end": "232239"
  },
  {
    "text": "connection for our purpose when talking about crook we're mostly going to be interested in",
    "start": "232239",
    "end": "238159"
  },
  {
    "text": "the reverse disassociation and these happen for a multitude of reasons they can",
    "start": "238159",
    "end": "244159"
  },
  {
    "text": "actually occur naturally for example when a client roams from one wi-fi station to another",
    "start": "244159",
    "end": "250159"
  },
  {
    "text": "and then we're talking about a reassociation or they happen manually simply when you",
    "start": "250159",
    "end": "255840"
  },
  {
    "text": "turn off the wi-fi connection of your device all of these associations and",
    "start": "255840",
    "end": "261000"
  },
  {
    "text": "disassociations are governed by so-called management frames and an important thing",
    "start": "261000",
    "end": "266400"
  },
  {
    "text": "to note these are most often unauthenticated and unencrypted",
    "start": "266400",
    "end": "271440"
  },
  {
    "text": "and also can be triggered manually what could go wrong",
    "start": "271440",
    "end": "276800"
  },
  {
    "text": "the four-way handshake establishes secure wireless communication now without going",
    "start": "277840",
    "end": "284000"
  },
  {
    "text": "into the technical details or the group key used for multicast and broadcast",
    "start": "284000",
    "end": "289520"
  },
  {
    "text": "i'll just mention that the handshake serves two main purposes first it's authentication to ensure that",
    "start": "289520",
    "end": "295680"
  },
  {
    "text": "the client is authorized to connect to the wi-fi for example knows the wi-fi password",
    "start": "295680",
    "end": "301440"
  },
  {
    "text": "and secondly for confidentiality and integrity so a unique per session encryption key",
    "start": "301440",
    "end": "307280"
  },
  {
    "text": "is constructed it's called the pairwise transient key the ptk",
    "start": "307280",
    "end": "313199"
  },
  {
    "text": "and a part of that ptk is the tk which stands for temporal key and this",
    "start": "313199",
    "end": "318880"
  },
  {
    "text": "is used to encrypt unicast data exchanged between the client and the access point",
    "start": "318880",
    "end": "325600"
  },
  {
    "text": "so let's take a closer look at how that tk is used how encryption is done in wpa2 with ccmp",
    "start": "325600",
    "end": "332880"
  },
  {
    "text": "which is the most ubiquitous standard today now i'm going to simplify the scheme not going into the details of",
    "start": "332880",
    "end": "339360"
  },
  {
    "text": "counter mode and cbc mac uh here we have some plain text data",
    "start": "339360",
    "end": "344400"
  },
  {
    "text": "that we are going to transmit and needs to be encrypted the cipher being used in this scheme is",
    "start": "344400",
    "end": "350320"
  },
  {
    "text": "aes so we have that session key the tk which was established in the four-way handshake",
    "start": "350320",
    "end": "357039"
  },
  {
    "text": "we have a so-called nonce a number which is only supposed to be used once this also includes the packet",
    "start": "357039",
    "end": "364160"
  },
  {
    "text": "number these are used to generate the key stream that key stream is then xor with the plaintext data to",
    "start": "364160",
    "end": "371520"
  },
  {
    "text": "get the encrypted data then along with the packet header this is then transmitted into the air",
    "start": "371520",
    "end": "377919"
  },
  {
    "text": "and the decryption is the reverse and shiva will talk about that in his part",
    "start": "377919",
    "end": "384560"
  },
  {
    "start": "384000",
    "end": "800000"
  },
  {
    "text": "so let now that we covered the basics let's get to the main part what is crook aka cve 2019",
    "start": "384560",
    "end": "392639"
  },
  {
    "text": "15 15126",
    "start": "392639",
    "end": "396080"
  },
  {
    "text": "this is a typical wi-fi connection between a device and an access point secured by the wpa2",
    "start": "399440",
    "end": "405680"
  },
  {
    "text": "protocol the communication is encrypted using that tk the pairwise session key that",
    "start": "405680",
    "end": "411360"
  },
  {
    "text": "was established in the handshake so even if someone else captures those wireless",
    "start": "411360",
    "end": "416960"
  },
  {
    "text": "network packets flying through the air they wouldn't be able to decrypt them and read the content",
    "start": "416960",
    "end": "422160"
  },
  {
    "text": "right well the crook vulnerability breaks that",
    "start": "422160",
    "end": "428000"
  },
  {
    "text": "here's an example of how an attacker could exploit the bug they could transmit a crafted",
    "start": "428000",
    "end": "435039"
  },
  {
    "text": "disassociation frame addressed to the victim the victim device accepts it and disassociates and data transmission",
    "start": "435039",
    "end": "442319"
  },
  {
    "text": "stops up to this point everything happened as it should have",
    "start": "442319",
    "end": "448720"
  },
  {
    "text": "but after that disassociation one last fragment of data is transmitted",
    "start": "448720",
    "end": "454240"
  },
  {
    "text": "only this time as you can see it's encrypted with an all zero trans uh transient key and the attacker",
    "start": "454240",
    "end": "461360"
  },
  {
    "text": "can intercept it and easily decrypt the content so how was all that possible well to",
    "start": "461360",
    "end": "468879"
  },
  {
    "text": "answer that let's rewind and take a closer look under the hood of",
    "start": "468879",
    "end": "474720"
  },
  {
    "text": "that vulnerable device spoiler alert this is the culprit behind",
    "start": "474720",
    "end": "481599"
  },
  {
    "text": "crook a full mac wi-fi chip by the way this particular one is from an amazon kindle",
    "start": "481599",
    "end": "488240"
  },
  {
    "text": "and it's only an eighth of an inch wide so taking this photograph was took a bit of an effort stereo tell us",
    "start": "488240",
    "end": "495599"
  },
  {
    "text": "more about these chips",
    "start": "495599",
    "end": "498639"
  },
  {
    "text": "so uh every mobile device your phone your laptop your smart watch",
    "start": "505759",
    "end": "511199"
  },
  {
    "text": "which doesn't stop reminding you that you're gonna probably die tomorrow if you don't make those 10 000 steps today",
    "start": "511199",
    "end": "517039"
  },
  {
    "text": "and even your intelligent vacuum cleaner if there ever be intelligent enough to vacuum properly",
    "start": "517039",
    "end": "522320"
  },
  {
    "text": "everything has its own wi-fi chip which handles all the wi-fi communication",
    "start": "522320",
    "end": "527519"
  },
  {
    "text": "in all reasons mobile device is a full mag chip tend to be the most used kind of chips in the market",
    "start": "527519",
    "end": "533279"
  },
  {
    "text": "full max offer better performance in terms of power consumption and speed and they are easier to",
    "start": "533279",
    "end": "539360"
  },
  {
    "text": "integrate in complete products this is a block diagram of one of them",
    "start": "539360",
    "end": "545200"
  },
  {
    "text": "as you can see it's fairly complicated this one also includes the bluetooth part but we won't bother with it",
    "start": "545200",
    "end": "551680"
  },
  {
    "text": "we'll look only at the small part of it which manages the whole wifi encryption",
    "start": "551680",
    "end": "557360"
  },
  {
    "text": "and this where the magic happens this is a mac",
    "start": "558240",
    "end": "564399"
  },
  {
    "text": "layer short for media access control architecture these are the small parts which handle all the communication encryption",
    "start": "564399",
    "end": "570320"
  },
  {
    "text": "buffers are used to store order communication frames for the time they are being encrypted or decrypted the transmit engine",
    "start": "570320",
    "end": "577360"
  },
  {
    "text": "constitutes the transmit data to and from the transmit buffer receive engine does the same for the",
    "start": "577360",
    "end": "582480"
  },
  {
    "text": "receive buffer the web engine encapsulates all the hardware accelerators to perform the",
    "start": "582480",
    "end": "587519"
  },
  {
    "text": "encryption and encryption it implements all cypher algorithms",
    "start": "587519",
    "end": "592959"
  },
  {
    "text": "s wep wpa wpa2 psm is a microcontroller that is highly",
    "start": "592959",
    "end": "600480"
  },
  {
    "text": "optimized for flow control operation it's also it also determines based on the frame type and association",
    "start": "600480",
    "end": "607279"
  },
  {
    "text": "information the appropriate cipher algorithm to be used",
    "start": "607279",
    "end": "612240"
  },
  {
    "text": "so how the encryption goes as robert explained before every time a device is connected or",
    "start": "613040",
    "end": "618480"
  },
  {
    "text": "reconnected to an access point after authentication and association a session encryption key is generated",
    "start": "618480",
    "end": "625200"
  },
  {
    "text": "which is then used for all the encryption until the session ends",
    "start": "625200",
    "end": "632079"
  },
  {
    "text": "transit buffer is being filled with data frames which need to be",
    "start": "632079",
    "end": "638320"
  },
  {
    "text": "send out web engine encrypts the data per frame with the generated encryption key and",
    "start": "638320",
    "end": "644560"
  },
  {
    "text": "the transit engine sends them away so what happens after the association",
    "start": "644560",
    "end": "650800"
  },
  {
    "text": "occurs the disassociation frame comes through the receive engine to receive buffer",
    "start": "650800",
    "end": "656320"
  },
  {
    "text": "state machine evaluates the frame and sends the information up the ladder there the information is",
    "start": "656320",
    "end": "662560"
  },
  {
    "text": "interpreted as okay we are about to disconnect let's drop all the encryption keys",
    "start": "662560",
    "end": "668160"
  },
  {
    "text": "a command to drop generated session encryption key is then send since in computing you don't erase",
    "start": "668160",
    "end": "674399"
  },
  {
    "text": "anything properly you just replace it with zeros decision encryption key is after dissociation",
    "start": "674399",
    "end": "680959"
  },
  {
    "text": "overwritten by zeros here comes the term all zero encryption",
    "start": "680959",
    "end": "686839"
  },
  {
    "text": "key this is expected behavior as no further data is supposed to be transmitted after the association",
    "start": "686839",
    "end": "693600"
  },
  {
    "text": "and it stays that way until a new session is generated after the new reassociation and the new",
    "start": "693600",
    "end": "698880"
  },
  {
    "text": "four-way handshake but until that happens the transmit buffer still may contain data the",
    "start": "698880",
    "end": "705839"
  },
  {
    "text": "transmit engine needs to send them away and continues to do so as usual",
    "start": "705839",
    "end": "711680"
  },
  {
    "text": "so all data which were left in that buffer after dissociation occurred are now sent away encrypted",
    "start": "711680",
    "end": "717839"
  },
  {
    "text": "with an all zero encryption key",
    "start": "717839",
    "end": "721600"
  },
  {
    "text": "so when you can grab these frames you can easily decrypt them into plugin text data",
    "start": "725200",
    "end": "730240"
  },
  {
    "text": "you know the encryption algorithm you know the encryption key",
    "start": "730240",
    "end": "736959"
  },
  {
    "text": "you get the nouns from the header and you can easily decrypt them then",
    "start": "737120",
    "end": "745839"
  },
  {
    "text": "the question is how do you identify these particular frames in the air the answer is simple you don't you just",
    "start": "746480",
    "end": "753920"
  },
  {
    "text": "try to decrypt everything you see with an all zero key and those frames which after decryption match binary pattern of the plaintext",
    "start": "753920",
    "end": "760480"
  },
  {
    "text": "data frames which is something like aaa03 those are the ones which are formerly",
    "start": "760480",
    "end": "766639"
  },
  {
    "text": "encrypted within all zero key one can ask how much data can you",
    "start": "766639",
    "end": "771920"
  },
  {
    "text": "decrypt after one disassociation well the transit buffer has a memory space of 32 kilobytes",
    "start": "771920",
    "end": "778480"
  },
  {
    "text": "for comparison one kilobyte is a couple of hundred words of plain text so 32 kilobytes will be about 10 to 20",
    "start": "778480",
    "end": "786160"
  },
  {
    "text": "000 words which is quite a few pages of a book but you must understand that the buffer",
    "start": "786160",
    "end": "793120"
  },
  {
    "text": "isn't always full when the dissociation happens it really depends on the timing",
    "start": "793120",
    "end": "800800"
  },
  {
    "start": "800000",
    "end": "974000"
  },
  {
    "text": "so what can an attacker do with this vulnerability well there are two ways to an adversary can eavesdrop on these",
    "start": "800800",
    "end": "806399"
  },
  {
    "text": "frames a passive one and an active one let's begin with the passive one as was",
    "start": "806399",
    "end": "813360"
  },
  {
    "text": "already mentioned the disassociation occurs naturally moving around changing access points low signal",
    "start": "813360",
    "end": "820320"
  },
  {
    "text": "strength or just due to single interference most of the time you won't even notice",
    "start": "820320",
    "end": "826320"
  },
  {
    "text": "because of the quick subsequent reassociation so let's do the math since this issue",
    "start": "826320",
    "end": "831600"
  },
  {
    "text": "concerns many wi-fi chips somewhere where there are many of these mobile devices in one place",
    "start": "831600",
    "end": "837199"
  },
  {
    "text": "like a workspace for example there should be a lot of them vulnerable combining with the fact that natural",
    "start": "837199",
    "end": "843440"
  },
  {
    "text": "dissociation occurs quite often there should be all zero cryptotrains just flying around",
    "start": "843440",
    "end": "849360"
  },
  {
    "text": "and yes they are so let's grab them",
    "start": "849360",
    "end": "854000"
  },
  {
    "text": "so what do you think have we tried to eavesdrow at our workplace of course we did because you know",
    "start": "854480",
    "end": "861199"
  },
  {
    "text": "sticking your own into things of people you know is always interesting and what did you saw first we saw all",
    "start": "861199",
    "end": "869040"
  },
  {
    "text": "vulnerable devices and access points to which they are connecting but then after decryption we saw what",
    "start": "869040",
    "end": "875120"
  },
  {
    "text": "kind of data are actually exposed dns requests tcp http requests",
    "start": "875120",
    "end": "880720"
  },
  {
    "text": "website that people owed you name it actually everything that wasn't tls encrypted because that's",
    "start": "880720",
    "end": "887600"
  },
  {
    "text": "another layer of encryption on the ip level",
    "start": "887600",
    "end": "891680"
  },
  {
    "text": "now when we identified all vulnerable devices we can get them to drop even more than",
    "start": "892800",
    "end": "899519"
  },
  {
    "text": "they would normally give up for free how i can trigger this association between them",
    "start": "899519",
    "end": "905440"
  },
  {
    "text": "and their access points wherever i want",
    "start": "905440",
    "end": "912399"
  },
  {
    "text": "and again and again",
    "start": "912399",
    "end": "919360"
  },
  {
    "text": "and just like captain america i can do this all day",
    "start": "922720",
    "end": "928160"
  },
  {
    "text": "and this is the most dangerous thing about this vulnerability because now you can gather these partial information let me get one",
    "start": "928160",
    "end": "934000"
  },
  {
    "text": "thing straight the nature of the data frames which are eventually only a zero key encrypted and can be eventually",
    "start": "934000",
    "end": "940480"
  },
  {
    "text": "decrypted to plaintext is quite random it really depends on the timing of the dissociation",
    "start": "940480",
    "end": "946800"
  },
  {
    "text": "but if you can now invoke it over and over again the vulnerability will manifest will",
    "start": "946800",
    "end": "952880"
  },
  {
    "text": "manifest itself over and over again and now you're in the information gathering business",
    "start": "952880",
    "end": "958880"
  },
  {
    "text": "just waiting until something interesting pops out and it always does",
    "start": "958880",
    "end": "969839"
  },
  {
    "start": "974000",
    "end": "1191000"
  },
  {
    "text": "as much as i enjoyed those animations let's demonstrate that this stuff really works",
    "start": "974560",
    "end": "980399"
  },
  {
    "text": "so we prepared a little demo in our lab so you can see the attack in action we're going to use a wireless adapter in",
    "start": "980399",
    "end": "987199"
  },
  {
    "text": "a so-called monitor mode now some of you that played around with wireshark",
    "start": "987199",
    "end": "992240"
  },
  {
    "text": "are surely familiar with promiscuous mode which is also used for packet sniffing",
    "start": "992240",
    "end": "997440"
  },
  {
    "text": "monitor mode is similar but it allows packets to be captured without having to be associated with an access point",
    "start": "997440",
    "end": "1004720"
  },
  {
    "text": "in other words an attacker can carry out this attack without knowing the wi-fi password",
    "start": "1004720",
    "end": "1010639"
  },
  {
    "text": "okay so this is our would be victim uses his phone is connected to our work",
    "start": "1010639",
    "end": "1017600"
  },
  {
    "text": "wi-fi see work wi-fi and they're gonna check on their smart home",
    "start": "1017600",
    "end": "1023440"
  },
  {
    "text": "so connect to the smart home command interface enters",
    "start": "1023440",
    "end": "1032400"
  },
  {
    "text": "his credentials clicks on login and if those credentials",
    "start": "1032400",
    "end": "1040640"
  },
  {
    "text": "were correct which they were in a moment he's connected",
    "start": "1040640",
    "end": "1046480"
  },
  {
    "text": "and can check up on his smart home see how his nuclear power plant",
    "start": "1046480",
    "end": "1054320"
  },
  {
    "text": "is doing turn it on off whatever now let's switch over to the",
    "start": "1054320",
    "end": "1059520"
  },
  {
    "text": "perspective of the attacker so the attacker has prepared his script for",
    "start": "1059520",
    "end": "1067440"
  },
  {
    "text": "invoking crook uh the parameters there are the victim's mac address which",
    "start": "1067440",
    "end": "1072480"
  },
  {
    "text": "was uh would have to be known in a different way and also that wi-fi that targeted wi-fi ssid",
    "start": "1072480",
    "end": "1080320"
  },
  {
    "text": "and know that as i mentioned earlier doesn't need to know the wi-fi password uh as you can see uh some packets",
    "start": "1080320",
    "end": "1088400"
  },
  {
    "text": "were captured and we're letting the script run so it's running continuously so uh we're",
    "start": "1088400",
    "end": "1095039"
  },
  {
    "text": "continuing to capture more packets now let's go back",
    "start": "1095039",
    "end": "1100559"
  },
  {
    "text": "and see what happened over there so in the beginning we sent out that the script sent out",
    "start": "1100559",
    "end": "1106880"
  },
  {
    "text": "that disassociation frame to the victim uh now we can see that the victim",
    "start": "1106880",
    "end": "1112080"
  },
  {
    "text": "reconnected to that wi-fi so the disassociation frame was accepted and and it worked and now we figured that",
    "start": "1112080",
    "end": "1118559"
  },
  {
    "text": "the device is vulnerable because we were able to successfully decrypt uh this packet as shitevo mentioned this",
    "start": "1118559",
    "end": "1125679"
  },
  {
    "text": "is that uh magic identifier aaaa03 and now we can see we can read it in",
    "start": "1125679",
    "end": "1131919"
  },
  {
    "text": "plain text that we were able to uh with an all zero key",
    "start": "1131919",
    "end": "1138720"
  },
  {
    "text": "this packet now he's rolled around there's another packet we can choose whichever one is",
    "start": "1138720",
    "end": "1145039"
  },
  {
    "text": "interesting is useful for our needs and more packets continue coming in so let's select",
    "start": "1145039",
    "end": "1153520"
  },
  {
    "text": "this one this http packet wireshark helps us",
    "start": "1153520",
    "end": "1162240"
  },
  {
    "text": "parse some of those fields over there so let's let's select that session id so this",
    "start": "1162240",
    "end": "1167840"
  },
  {
    "text": "particular one contains the session id copy to the clipboard switch over to our browser",
    "start": "1167840",
    "end": "1174559"
  },
  {
    "text": "and then the attacker is able without knowing the password to the smart home interface without",
    "start": "1174559",
    "end": "1181200"
  },
  {
    "text": "knowing password to the wi-fi able to connect to that interface",
    "start": "1181200",
    "end": "1187520"
  },
  {
    "text": "and do whatever malicious mischief and we will be releasing that testing",
    "start": "1187520",
    "end": "1194240"
  },
  {
    "start": "1191000",
    "end": "1404000"
  },
  {
    "text": "script that we used in the demo on our github after the",
    "start": "1194240",
    "end": "1200400"
  },
  {
    "text": "presentation uh but that's not all here's a different",
    "start": "1204840",
    "end": "1210559"
  },
  {
    "text": "scenario where it's the access point that is susceptible to this vulnerability",
    "start": "1210559",
    "end": "1216559"
  },
  {
    "text": "similarly to the previous example an attacker would be able to intercept and encrypt private data that was being",
    "start": "1216559",
    "end": "1223200"
  },
  {
    "text": "addressed from the access point to your decline device even if your client device wasn't vulnerable itself",
    "start": "1223200",
    "end": "1229039"
  },
  {
    "text": "he can still get information about your connection directly from the access point the",
    "start": "1229039",
    "end": "1234080"
  },
  {
    "text": "difference is only that he will get to see only responses now",
    "start": "1234080",
    "end": "1239520"
  },
  {
    "text": "dns and http responses for example or a document being sent to wi-fi printer the fact that wireless",
    "start": "1239520",
    "end": "1247039"
  },
  {
    "text": "routers and access points are also affected by this vulnerability greatly increases the scope of the",
    "start": "1247039",
    "end": "1253039"
  },
  {
    "text": "attack and it's also more difficult to protect protect against it",
    "start": "1253039",
    "end": "1258960"
  },
  {
    "text": "since the security of access points is typically beyond your control a solution to this is to",
    "start": "1258960",
    "end": "1265200"
  },
  {
    "text": "treat even wpa2 protected networks as insecure",
    "start": "1265200",
    "end": "1270480"
  },
  {
    "text": "and make sure you always use encryption on the ip level tls or vpn",
    "start": "1270480",
    "end": "1277840"
  },
  {
    "text": "crook affected devices with cypress and broadcom wi-fi chips and these chips are really",
    "start": "1288080",
    "end": "1294080"
  },
  {
    "text": "prevalent these are just the examples of devices we confirmed to have been vulnerable",
    "start": "1294080",
    "end": "1299679"
  },
  {
    "text": "in our lab but we know there were many more and the total number of affected devices was well over a billion",
    "start": "1299679",
    "end": "1307919"
  },
  {
    "text": "when we were doing our initial crook testing last year we did not see the vulnerability",
    "start": "1307919",
    "end": "1313039"
  },
  {
    "text": "manifest itself on devices with wi-fi chips from other manufacturers like qualcomm realtek raylink or mediatek but we later",
    "start": "1313039",
    "end": "1321200"
  },
  {
    "text": "found out that some of those companies had other similar issues and stefan will tell you more about that in a minute",
    "start": "1321200",
    "end": "1329679"
  },
  {
    "text": "so what happened after that discovery well we work with the affected manufacturers through a",
    "start": "1330720",
    "end": "1336400"
  },
  {
    "text": "responsible disclosure process and considering the complexity of the",
    "start": "1336400",
    "end": "1341679"
  },
  {
    "text": "bug and the two-step patching process involving chip manufacturers and then oems or",
    "start": "1341679",
    "end": "1347840"
  },
  {
    "text": "device manufacturers we agreed on a longer than usual grace period of a 120 days",
    "start": "1347840",
    "end": "1355200"
  },
  {
    "text": "as far as we know most major vendors have released patches",
    "start": "1355200",
    "end": "1360880"
  },
  {
    "text": "now not only would it be difficult for us to communicate with every individual device manufacturer",
    "start": "1360880",
    "end": "1367200"
  },
  {
    "text": "that could possibly be using these chips in their devices it would also be impossible",
    "start": "1367200",
    "end": "1373360"
  },
  {
    "text": "i mean there is no public comprehensive list clients of broadcom and cypress that's",
    "start": "1373360",
    "end": "1379679"
  },
  {
    "text": "proprietary information of broadcom and cyprus and they didn't tell us so what we did",
    "start": "1379679",
    "end": "1385679"
  },
  {
    "text": "in order to ensure that all possibly affected parties became aware of the bug",
    "start": "1385679",
    "end": "1390880"
  },
  {
    "text": "was we work with ikasi an organization that helps coordinate such complicated",
    "start": "1390880",
    "end": "1395919"
  },
  {
    "text": "disclosures and we strongly encourage other researchers in similar situations to do so they were very helpful",
    "start": "1395919",
    "end": "1403840"
  },
  {
    "start": "1404000",
    "end": "1610000"
  },
  {
    "text": "now i'm going to go back in time and explain how our research started but more importantly the connections to",
    "start": "1405679",
    "end": "1411840"
  },
  {
    "text": "previous work i'm sure for a lot of you all of this",
    "start": "1411840",
    "end": "1418320"
  },
  {
    "text": "probably reminds you of other weaknesses in wpa2 from the past such as crack crack being short for key",
    "start": "1418320",
    "end": "1426559"
  },
  {
    "text": "re-installation attacks was researched from 2017 by matthew fanhoff",
    "start": "1426559",
    "end": "1432080"
  },
  {
    "text": "which he also presented at blackhat europe 2017. and the point with crack as the acronym",
    "start": "1432080",
    "end": "1438799"
  },
  {
    "text": "suggests it's all about reinstalling an already in-use encryption key",
    "start": "1438799",
    "end": "1444320"
  },
  {
    "text": "but resetting that nonce that i mentioned in the beginning",
    "start": "1444320",
    "end": "1449200"
  },
  {
    "text": "and in the beginning of our research we discovered that amazon echo the first generation was vulnerable to crack so we did",
    "start": "1449440",
    "end": "1457440"
  },
  {
    "text": "responsible disclosure and while amazon was working on the patch we were looking into the second",
    "start": "1457440",
    "end": "1464000"
  },
  {
    "text": "generation of echo now the second generation was not vulnerable to the original crack attack",
    "start": "1464000",
    "end": "1471360"
  },
  {
    "text": "but it was vulnerable to a modification of that attack",
    "start": "1471360",
    "end": "1476400"
  },
  {
    "text": "and this modification led to an all-zero key being installed and the cause of that was you guessed it",
    "start": "1476400",
    "end": "1484840"
  },
  {
    "text": "crook so we continued our discussions with amazon we continued",
    "start": "1484840",
    "end": "1490559"
  },
  {
    "text": "our research until we came to realize that the problem was actually in the wi-fi chip",
    "start": "1490559",
    "end": "1496559"
  },
  {
    "text": "itself in the case of this device the chip by cyprus",
    "start": "1496559",
    "end": "1501840"
  },
  {
    "text": "now cyprus bought the iot division of broadcom and from our perspective or from the",
    "start": "1501840",
    "end": "1508320"
  },
  {
    "text": "perspective of the crook vulnerability the chips are basically the same but",
    "start": "1508320",
    "end": "1513440"
  },
  {
    "text": "since broadcom chips were so widespread even more so than cyprus that's when we realized the scale of",
    "start": "1513440",
    "end": "1520480"
  },
  {
    "text": "this vulnerability and that's how cracking amazon echo brought us to discovering crook",
    "start": "1520480",
    "end": "1529840"
  },
  {
    "text": "i put together this table to explain how the two are related and how they differ",
    "start": "1530320",
    "end": "1537600"
  },
  {
    "text": "both of them could lead to similar outcomes unauthorized decryption of encrypted",
    "start": "1537600",
    "end": "1543279"
  },
  {
    "text": "wireless traffic but they're also two separate issues",
    "start": "1543279",
    "end": "1548880"
  },
  {
    "text": "crack is an attack an exploit and crook as we've explained is",
    "start": "1548880",
    "end": "1554960"
  },
  {
    "text": "a vulnerability a bug the point with crack is that a nonce is",
    "start": "1554960",
    "end": "1560240"
  },
  {
    "text": "being reused to acquire the key stream with crook it's about data being encrypted with an",
    "start": "1560240",
    "end": "1565919"
  },
  {
    "text": "all zero session key crack is triggered during that four-way handshake",
    "start": "1565919",
    "end": "1571520"
  },
  {
    "text": "crook is triggered after a disassociation as far as the impact crack affected most",
    "start": "1571520",
    "end": "1579039"
  },
  {
    "text": "wi-fi capable devices because it was about the protocols themselves crook affected",
    "start": "1579039",
    "end": "1585520"
  },
  {
    "text": "most most widespread wi-fi chips out there by broadcom and cyprus",
    "start": "1585520",
    "end": "1592080"
  },
  {
    "text": "now the most severe manifestation of crack is the installation of an all-zero key",
    "start": "1592320",
    "end": "1599919"
  },
  {
    "text": "and crook is also one of the possible reasons why encryption with an all-zero key can",
    "start": "1599919",
    "end": "1606240"
  },
  {
    "text": "happen so that's something they have in common too",
    "start": "1606240",
    "end": "1612240"
  },
  {
    "start": "1610000",
    "end": "1869000"
  },
  {
    "text": "i mentioned that our initial scripts for testing crook didn't reveal the vulnerability on other chipsets than broadcom or cypress",
    "start": "1612240",
    "end": "1620720"
  },
  {
    "text": "that was true but we did find something nevertheless and stefan will tell you more",
    "start": "1620720",
    "end": "1627840"
  },
  {
    "text": "so after our former rsa presentation in february the issue was brought to attention of",
    "start": "1632720",
    "end": "1638799"
  },
  {
    "text": "many other chipset manufacturers one of the chips we were looking into aside from broadcom and cyprus were from",
    "start": "1638799",
    "end": "1645200"
  },
  {
    "text": "qualcomm our investigation found that their wifi chips are also vulnerable but the exploit manifests itself",
    "start": "1645200",
    "end": "1652840"
  },
  {
    "text": "differently this is via shark log of a residual",
    "start": "1652840",
    "end": "1658399"
  },
  {
    "text": "frame after the association was invoked on a qualcomm router as you can see",
    "start": "1658399",
    "end": "1663919"
  },
  {
    "text": "protected flag is true and the frame appears to have a ccemp parameter",
    "start": "1663919",
    "end": "1669440"
  },
  {
    "text": "but the data aren't encrypted at all as they should be this frame is an icmp echo from ping",
    "start": "1669440",
    "end": "1675919"
  },
  {
    "text": "command we reported this this the issue to them",
    "start": "1675919",
    "end": "1682000"
  },
  {
    "text": "and they approached it as a crook variant and assigned cve 2020 3702",
    "start": "1682000",
    "end": "1689520"
  },
  {
    "text": "the affected chip was qca 9531 which is a highly integrated and",
    "start": "1689520",
    "end": "1694799"
  },
  {
    "text": "feature-rich system-on-chip for advanced wi-fi platforms it is used mainly in network routers",
    "start": "1694799",
    "end": "1702799"
  },
  {
    "text": "they resolved the issue with updating their proprietary linux driver in july the only problem is that not all devices",
    "start": "1702799",
    "end": "1709440"
  },
  {
    "text": "with qualcomm chips use this proprietary driver in some cases open source linux drivers are also used",
    "start": "1709440",
    "end": "1718399"
  },
  {
    "text": "such as upstream adh9k driver for example so a word of caution",
    "start": "1718399",
    "end": "1724960"
  },
  {
    "text": "that these may or may not be patched yet the good news is the new mobile devices with integrated",
    "start": "1724960",
    "end": "1730960"
  },
  {
    "text": "system on chips specific specifically for android and windows on snapdragon",
    "start": "1730960",
    "end": "1736240"
  },
  {
    "text": "should be not affected by this issue other widespread wi-fi chips that were that we looked into were from mediatek",
    "start": "1736240",
    "end": "1744000"
  },
  {
    "text": "we observed a vulnerable behavior very similar to the one observed on qualcomm devices on an older",
    "start": "1744000",
    "end": "1749679"
  },
  {
    "text": "asus router but what was far more interesting we observed it on the current microsoft azure sphere",
    "start": "1749679",
    "end": "1756159"
  },
  {
    "text": "development kit which uses mediatek mt-3630 microcontroller",
    "start": "1756159",
    "end": "1762159"
  },
  {
    "text": "the mt-3620 is a highly integrated performance iot mcu with the high level of security",
    "start": "1762159",
    "end": "1769279"
  },
  {
    "text": "necessary for modern robust internet connected devices it targets wide range of iot",
    "start": "1769279",
    "end": "1775200"
  },
  {
    "text": "applications including smart homes commercial industrial and many other domains",
    "start": "1775200",
    "end": "1782640"
  },
  {
    "text": "we've contacted mediatek about this discovery discovered vulnerabilities mediatek has informed us that they aware",
    "start": "1782880",
    "end": "1789840"
  },
  {
    "text": "of the issue and reviewed all wi-fi products and the corresponding software patches to",
    "start": "1789840",
    "end": "1795840"
  },
  {
    "text": "impacted projects have been released to different customers around march and april already",
    "start": "1795840",
    "end": "1801679"
  },
  {
    "text": "a separate question remains whether all device manufacturers have implemented these patches",
    "start": "1801679",
    "end": "1807440"
  },
  {
    "text": "with regard to other sphere mt3620 the patch should be integrated into the",
    "start": "1807440",
    "end": "1812559"
  },
  {
    "text": "latest operational system update and how the one liberty manifested",
    "start": "1812559",
    "end": "1818399"
  },
  {
    "text": "itself on mediatek devices very similar as on the qualcomm devices this is a very sharp lock",
    "start": "1818399",
    "end": "1824240"
  },
  {
    "text": "of a residual frame after dissociation was invoked on azure sphere mt-3620",
    "start": "1824240",
    "end": "1831200"
  },
  {
    "text": "as you can see the protected flag is set through but the frame doesn't have any ccmp",
    "start": "1831200",
    "end": "1837600"
  },
  {
    "text": "parameters and the beginning of the data is falsely",
    "start": "1837600",
    "end": "1842799"
  },
  {
    "text": "identified as a wep header here we didn't use icmp echo because of",
    "start": "1842799",
    "end": "1849679"
  },
  {
    "text": "the device limitations but an application which sends udp frames with a simple pattern",
    "start": "1849679",
    "end": "1856240"
  },
  {
    "text": "as you can see the frame isn't encrypted",
    "start": "1856240",
    "end": "1865840"
  },
  {
    "text": "okay let's wrap up first a hat tip to matthew fanhof whose",
    "start": "1867760",
    "end": "1874320"
  },
  {
    "start": "1869000",
    "end": "2091000"
  },
  {
    "text": "great research on crack brought us here in the first place then to all these companies",
    "start": "1874320",
    "end": "1880159"
  },
  {
    "text": "with whom the cooperation went really smoothly and they responded to our disclosures",
    "start": "1880159",
    "end": "1885440"
  },
  {
    "text": "professionally especially amazon the joint effort trying to get to the bottom of what was",
    "start": "1885440",
    "end": "1891200"
  },
  {
    "text": "going on was stellar and there are a lot of other companies with whom we did not have",
    "start": "1891200",
    "end": "1897600"
  },
  {
    "text": "that much cooperation but they also handled the situation well released patches and so on",
    "start": "1897600",
    "end": "1904399"
  },
  {
    "text": "and we've been providing links to any security advisories we could find to our crook web page so what are the",
    "start": "1904399",
    "end": "1911279"
  },
  {
    "text": "takeaways for you the source of crook and the other related vulnerabilities",
    "start": "1911279",
    "end": "1918080"
  },
  {
    "text": "is the wi-fi chip now fortunately you don't have to go and replace the chips on all your",
    "start": "1918080",
    "end": "1924240"
  },
  {
    "text": "devices how would you do that and you don't have to be throwing away your iphones either",
    "start": "1924240",
    "end": "1931200"
  },
  {
    "text": "um no you can mitigate the vulnerabilities with a firmware or driver update",
    "start": "1931200",
    "end": "1937120"
  },
  {
    "text": "the obvious advice that arose from our initial crook discovery was make sure that all of your devices with",
    "start": "1937120",
    "end": "1944480"
  },
  {
    "text": "broadcom or cypress chips are running the latest software versions now that device has its limitations",
    "start": "1944480",
    "end": "1951360"
  },
  {
    "text": "though first as a regular user you often have no way of knowing what vendor made the chip in your device",
    "start": "1951360",
    "end": "1959840"
  },
  {
    "text": "and secondly as it turned out other similar vulnerabilities affected",
    "start": "1959840",
    "end": "1965600"
  },
  {
    "text": "chips by other manufacturers so we're going back to the almighty",
    "start": "1965600",
    "end": "1971440"
  },
  {
    "text": "advice just better to make sure to keep all of your devices up to date",
    "start": "1971440",
    "end": "1977039"
  },
  {
    "text": "and it goes for access points and wi-fi routers too because as stable talked about crook",
    "start": "1977039",
    "end": "1982880"
  },
  {
    "text": "affects those too and it also affects wpa2 enterprise",
    "start": "1982880",
    "end": "1989200"
  },
  {
    "text": "now in case you're a manufacturer of wi-fi capable devices yourself and you're hearing about crook for the",
    "start": "1989200",
    "end": "1995360"
  },
  {
    "text": "first time i highly recommend you get in touch with the wi-fi alliance and your chip manufacturer",
    "start": "1995360",
    "end": "2003200"
  },
  {
    "text": "a final general note many of those devices we talked about that were vulnerable",
    "start": "2003200",
    "end": "2010240"
  },
  {
    "text": "like smartphones they get over-the-air updates automatically or the user is at least",
    "start": "2010240",
    "end": "2015919"
  },
  {
    "text": "prompted to install them but others like some wi-fi routers for",
    "start": "2015919",
    "end": "2021120"
  },
  {
    "text": "example need to be updated manually and this is often problematic it could lead to attack scenarios like",
    "start": "2021120",
    "end": "2028320"
  },
  {
    "text": "those stefan talked about and this is cause for concern in normal situations",
    "start": "2028320",
    "end": "2034240"
  },
  {
    "text": "but even more so when more people are working from home due to covet 19. so these are employees",
    "start": "2034240",
    "end": "2041840"
  },
  {
    "text": "accessing corporate resources that are responsible for their own home wi-fi security so crook is",
    "start": "2041840",
    "end": "2049200"
  },
  {
    "text": "something that company csos definitely need to be paying attention to",
    "start": "2049200",
    "end": "2054878"
  },
  {
    "text": "for more technical details on the crook vulnerability check out our research paper for up-to-date",
    "start": "2056079",
    "end": "2062480"
  },
  {
    "text": "information frequently asked questions the script that we used in the demo",
    "start": "2062480",
    "end": "2067760"
  },
  {
    "text": "and links to vendor advisories go to this web page we created dedicated to crook",
    "start": "2067760",
    "end": "2075839"
  },
  {
    "text": "thank you for watching do make sure to check out our lab's twitter account at eset research and our blog we leave",
    "start": "2076240",
    "end": "2084200"
  },
  {
    "text": "security.com for the latest research updates and now we will take questions if there are any",
    "start": "2084200",
    "end": "2093520"
  }
]