[
  {
    "text": "welcome to black hat window security conference 2002 held February 7th through the 9th in New Orleans",
    "start": "17840",
    "end": "25000"
  },
  {
    "text": "Louisiana the following videotape was recorded live at the conference and produced by the sound of knowledge",
    "start": "25000",
    "end": "32439"
  },
  {
    "text": "Incorporated um because for my internal clock it is still evening",
    "start": "40480",
    "end": "46440"
  },
  {
    "text": "um yeah my name is FX from the German pheno group um just to make sure there",
    "start": "46440",
    "end": "51960"
  },
  {
    "text": "is no misunderstanding this is not a company this is a private research group",
    "start": "51960",
    "end": "57199"
  },
  {
    "text": "for some people just interested in strange stuff and protocols and as you see hopefully on a",
    "start": "57199",
    "end": "65199"
  },
  {
    "text": "title um we want to talk a little bit about the field of protocol attacks evil",
    "start": "65200",
    "end": "72640"
  },
  {
    "text": "routing and general abuse of",
    "start": "72640",
    "end": "78040"
  },
  {
    "text": "protocols so this is the agenda um what are we discussing we have a short",
    "start": "79680",
    "end": "87560"
  },
  {
    "text": "introduction and we will in this introduction cover certain attack",
    "start": "87560",
    "end": "93200"
  },
  {
    "text": "scenarios what can you do in general um why is that important to remember if you",
    "start": "93200",
    "end": "100280"
  },
  {
    "text": "design your infrastructure security and after the introduction we will shortly cover layer 2 protocols",
    "start": "100280",
    "end": "109719"
  },
  {
    "text": "like CDP STP and 802.1 Q",
    "start": "109719",
    "end": "115920"
  },
  {
    "text": "vlans we will also cover the classics like ICM P abuse and AR attacks but just",
    "start": "115920",
    "end": "123079"
  },
  {
    "text": "especially for the AR stuff we skip over that pretty fast because Jonathan has",
    "start": "123079",
    "end": "128239"
  },
  {
    "text": "given a more in-depth discussion of AR later and then we will of course look",
    "start": "128239",
    "end": "134879"
  },
  {
    "text": "into routing protocol attacks which routing protocol exist what can an atier",
    "start": "134879",
    "end": "140160"
  },
  {
    "text": "do with them and yeah finally we look into so-called",
    "start": "140160",
    "end": "148040"
  },
  {
    "text": "tunneling since we started with this kind of",
    "start": "148760",
    "end": "153840"
  },
  {
    "text": "research um even s figured out that this is maybe",
    "start": "153840",
    "end": "160200"
  },
  {
    "text": "something important so um I will read to you what C has to say it is of extreme",
    "start": "160200",
    "end": "167879"
  },
  {
    "text": "concern is the potential of routers being used for dos attacks based on Direct attacks against the routing",
    "start": "167879",
    "end": "173920"
  },
  {
    "text": "protocols that interconnect the networks comprising the internet we believe this",
    "start": "173920",
    "end": "179000"
  },
  {
    "text": "to be an AM and real threat with a potential high",
    "start": "179000",
    "end": "184360"
  },
  {
    "text": "impact well s is right this is a real threat um the question I ask myself",
    "start": "184360",
    "end": "191799"
  },
  {
    "text": "always is like why should you use it for deny of service attack if you can do",
    "start": "191799",
    "end": "197440"
  },
  {
    "text": "more interesting stuff with it and if you can really use it for directly",
    "start": "197440",
    "end": "203360"
  },
  {
    "text": "attacking and taking over systems so maybe they figured that out in half",
    "start": "203360",
    "end": "211680"
  },
  {
    "text": "year infrastructured risks so what threats are we facing here what threat",
    "start": "211680",
    "end": "218599"
  },
  {
    "text": "posts an ateker using protocol based attacks to you using traffic rerouting an eer might",
    "start": "218599",
    "end": "226360"
  },
  {
    "text": "able to sniff data streams he wouldn't normally",
    "start": "226360",
    "end": "231400"
  },
  {
    "text": "see you probably all have switches in your networks for performance reason but",
    "start": "231400",
    "end": "237079"
  },
  {
    "text": "also to prevent sniffing um this can be circumvented um the ataker also could",
    "start": "237079",
    "end": "245720"
  },
  {
    "text": "prevent data from getting from point A to point B data like cslog",
    "start": "245720",
    "end": "252879"
  },
  {
    "text": "authentication um accounting data he could modify the data on the way which",
    "start": "252879",
    "end": "258799"
  },
  {
    "text": "means after valid data was sent from host a it might be invalid when it",
    "start": "258799",
    "end": "265720"
  },
  {
    "text": "receives it is received by host b or he could impersonate Source or destination",
    "start": "265720",
    "end": "273039"
  },
  {
    "text": "host to just give the user or the server or the application for sense of",
    "start": "273039",
    "end": "281280"
  },
  {
    "text": "security so this is a simple Network it's not real life as you can imagine oh",
    "start": "282080",
    "end": "289560"
  },
  {
    "text": "great um we're missing some graphics here hopefully it is on your papers",
    "start": "289560",
    "end": "297400"
  },
  {
    "text": "correctly um on the left side there is a normal office Lan um with several PCS",
    "start": "297400",
    "end": "304800"
  },
  {
    "text": "connected to a hub that is this line here because Hub is like a flat Network",
    "start": "304800",
    "end": "311280"
  },
  {
    "text": "um and these are hooked up to a switch for performance reasons um then we",
    "start": "311280",
    "end": "319080"
  },
  {
    "text": "have two routers here talking hsrp to each",
    "start": "319080",
    "end": "324319"
  },
  {
    "text": "other um this is because first they have this one router and equipped it with",
    "start": "324319",
    "end": "330440"
  },
  {
    "text": "firewalling software iOS firewall feature set or whatever um to secure",
    "start": "330440",
    "end": "336240"
  },
  {
    "text": "This Server we call a Target over here and just to make sure nobody's breaking in from the client side and later on",
    "start": "336240",
    "end": "344400"
  },
  {
    "text": "someone said okay we need higher way ability so they went out asked the next",
    "start": "344400",
    "end": "350080"
  },
  {
    "text": "best reseller they have um okay we need higher way ability what should we do and",
    "start": "350080",
    "end": "355520"
  },
  {
    "text": "they set up this hsrp router here as you see on the graphics normal um things happen you have the",
    "start": "355520",
    "end": "363720"
  },
  {
    "text": "router configured and someone just forgot to load the firing on it but well",
    "start": "363720",
    "end": "369319"
  },
  {
    "text": "it's the backup router so nobody even notices then we have um another router",
    "start": "369319",
    "end": "377599"
  },
  {
    "text": "down here in um in the router segment that is just a flat land where",
    "start": "377599",
    "end": "384520"
  },
  {
    "text": "routers talk to each other um and behind yet another router with a packet filter",
    "start": "384520",
    "end": "390080"
  },
  {
    "text": "is a radio server so we have this guy here we call",
    "start": "390080",
    "end": "395919"
  },
  {
    "text": "him ataker and he could not get a connection to the flat office L of course he would prefer",
    "start": "395919",
    "end": "403280"
  },
  {
    "text": "that just sniffing the passwords and being done um he was connected directly",
    "start": "403280",
    "end": "408800"
  },
  {
    "text": "to the switch and after sniffing for some minutes and just seeing broadcast messages going back and forth he decides",
    "start": "408800",
    "end": "416039"
  },
  {
    "text": "to go for protocol attacks so question is what can he do",
    "start": "416039",
    "end": "421240"
  },
  {
    "text": "this is the normal traffic path as I call it that's just how does the traffic",
    "start": "421240",
    "end": "427039"
  },
  {
    "text": "get from A to B it's going over this flat line here to the switch is",
    "start": "427039",
    "end": "432360"
  },
  {
    "text": "forwarded to the router and then to the over Target same on the way",
    "start": "432360",
    "end": "439199"
  },
  {
    "text": "back this is a modified traffic path the attacker just went for layer two",
    "start": "439639",
    "end": "446199"
  },
  {
    "text": "interception also known as AR poisoning um to get all the traffic in this",
    "start": "446199",
    "end": "452479"
  },
  {
    "text": "broadcast domain here and to sniff the",
    "start": "452479",
    "end": "457879"
  },
  {
    "text": "traffic to actually attack this over Target someone could use what I call",
    "start": "460039",
    "end": "466440"
  },
  {
    "text": "local redirection most people forget about that eer is hopefully administrative",
    "start": "466440",
    "end": "474360"
  },
  {
    "text": "user on his own machine so he can change either the routing or the AR table to",
    "start": "474360",
    "end": "480400"
  },
  {
    "text": "just whatever he wants it to be so he can say okay to forward my traffic use",
    "start": "480400",
    "end": "487639"
  },
  {
    "text": "this router because it's online it is accessible and it can forward traffic so",
    "start": "487639",
    "end": "493599"
  },
  {
    "text": "use this router to forward my traffic and hereby circumventing this firewalling of",
    "start": "493599",
    "end": "500360"
  },
  {
    "text": "course this is a one-way",
    "start": "500360",
    "end": "503918"
  },
  {
    "text": "thing in this scenario EA just just wanted to intercept one Connection in this",
    "start": "505720",
    "end": "511800"
  },
  {
    "text": "broadcast domain simply because doing our poisoning in general um will ring",
    "start": "511800",
    "end": "517959"
  },
  {
    "text": "all possible bells on the IDS system or for bigger networks it just blows off",
    "start": "517959",
    "end": "524399"
  },
  {
    "text": "the network C so to be a little bit more smart he went",
    "start": "524399",
    "end": "530200"
  },
  {
    "text": "for irdp attack and just made himself the default gateway for victim which",
    "start": "530200",
    "end": "536560"
  },
  {
    "text": "means that victim is forwarding the frames to ateker who in turn forwards the frames using this router it was",
    "start": "536560",
    "end": "543600"
  },
  {
    "text": "supposed to be the default gateway so now victim can sniff traffic for this",
    "start": "543600",
    "end": "550360"
  },
  {
    "text": "connection from victim to",
    "start": "550360",
    "end": "554279"
  },
  {
    "text": "Target based on the other attacks shown um eaker decides okay the one way can be",
    "start": "556160",
    "end": "565480"
  },
  {
    "text": "done by local redirection but how do we get silver Target to use the same way",
    "start": "565480",
    "end": "571000"
  },
  {
    "text": "back so we just don't have the F in between anymore and he just uses icmp redirect",
    "start": "571000",
    "end": "578440"
  },
  {
    "text": "they're well known they're very old and they're still very powerful so AA no",
    "start": "578440",
    "end": "587160"
  },
  {
    "text": "firewall as usual aakers not very structured people um he just figured",
    "start": "588000",
    "end": "596200"
  },
  {
    "text": "later on well there is hsrp running so all the efforts with logo redirection",
    "start": "596200",
    "end": "601839"
  },
  {
    "text": "and icmp redirect were just too much he could just force an",
    "start": "601839",
    "end": "608640"
  },
  {
    "text": "hsrp switch over to the backup router which as we know has no firework",
    "start": "608640",
    "end": "615160"
  },
  {
    "text": "configured so he forces the switch over to the unprotected router here and",
    "start": "615160",
    "end": "622320"
  },
  {
    "text": "that's it this stays the same for a long time so he",
    "start": "622320",
    "end": "627440"
  },
  {
    "text": "doesn't have to care about the traffic anymore it's just playing through",
    "start": "627440",
    "end": "634000"
  },
  {
    "text": "it now assumed eek was successful in taking over the server Target which just",
    "start": "634839",
    "end": "641279"
  },
  {
    "text": "disappeared over here um and what he found on this server was like the",
    "start": "641279",
    "end": "647399"
  },
  {
    "text": "configuration files for the Cisco routers so now he thinks okay we can",
    "start": "647399",
    "end": "652720"
  },
  {
    "text": "just lock into the Cisco router and change something or use the the router for whatever we",
    "start": "652720",
    "end": "660279"
  },
  {
    "text": "want which doesn't work because the router is configured as in most bigger",
    "start": "660279",
    "end": "665720"
  },
  {
    "text": "networks to authenticate logins to radio server which is this path here so for",
    "start": "665720",
    "end": "672040"
  },
  {
    "text": "the Tet connection and the Tet connection arrives and ater supplies",
    "start": "672040",
    "end": "677360"
  },
  {
    "text": "username and password this is checked with the radio server and only if the radio server is",
    "start": "677360",
    "end": "684320"
  },
  {
    "text": "not available then the router will refer to the Lo",
    "start": "684320",
    "end": "690240"
  },
  {
    "text": "configured um passwords for tet login so",
    "start": "690240",
    "end": "695680"
  },
  {
    "text": "what ater does is actually fulfilling the requirement and making the radio",
    "start": "695680",
    "end": "701440"
  },
  {
    "text": "server not aailable by using an igp attack here and",
    "start": "701440",
    "end": "708079"
  },
  {
    "text": "introducing either a black hole or a loop route into this router this router is no longer able to",
    "start": "708079",
    "end": "716040"
  },
  {
    "text": "reach the radio server and uses the local store",
    "start": "716040",
    "end": "721519"
  },
  {
    "text": "passwords this slide really needs the pattern that is not visible here that",
    "start": "725560",
    "end": "731600"
  },
  {
    "text": "okay assumed you have a little dotted pattern over here because we talk",
    "start": "731600",
    "end": "738959"
  },
  {
    "text": "all over the place about routing protocols and other protocols running",
    "start": "738959",
    "end": "744399"
  },
  {
    "text": "over M multicast this slide is just here to show you how unpredictable it can be",
    "start": "744399",
    "end": "750639"
  },
  {
    "text": "um I didn't believe that when I saw it first time having this network here you have",
    "start": "750639",
    "end": "756600"
  },
  {
    "text": "the clients and the router and whatever on this side and an",
    "start": "756600",
    "end": "762040"
  },
  {
    "text": "AIX system running a checkpoint 4.1 or 4.0 firewall on top um default",
    "start": "762040",
    "end": "769480"
  },
  {
    "text": "installation so you would assume sitting out here that you don't see any",
    "start": "769480",
    "end": "775880"
  },
  {
    "text": "multicast which is unfortunately not true the multicast domain is actually",
    "start": "775880",
    "end": "781480"
  },
  {
    "text": "the world cable because someone",
    "start": "781480",
    "end": "786720"
  },
  {
    "text": "um thought to be real bright probably at IBM um because multicast frames are not",
    "start": "786720",
    "end": "793600"
  },
  {
    "text": "even given to the fir War software to make sure they fit into the rules so",
    "start": "793600",
    "end": "799920"
  },
  {
    "text": "even if I had configured any any deny over here on the checkpoint I would",
    "start": "799920",
    "end": "805760"
  },
  {
    "text": "see Mast traffic that is why it is highly recommended to read the so-called",
    "start": "805760",
    "end": "811639"
  },
  {
    "text": "red books from IBM before installing a checkpoint on",
    "start": "811639",
    "end": "816560"
  },
  {
    "text": "it so this is how it looks like because if I generate a multicast packet over",
    "start": "816839",
    "end": "821920"
  },
  {
    "text": "here it will actually Reach This",
    "start": "821920",
    "end": "825800"
  },
  {
    "text": "router so we saw some possible attacks question is how do they work in",
    "start": "826959",
    "end": "833399"
  },
  {
    "text": "general hope everyone is familiar with the iso OC model here",
    "start": "833399",
    "end": "839800"
  },
  {
    "text": "um because that is what it boils down to checking the OC",
    "start": "839800",
    "end": "844959"
  },
  {
    "text": "layers each layer has its own addressing layer one is obviously",
    "start": "844959",
    "end": "852040"
  },
  {
    "text": "directly connected I think everyone had the experience of following cables through",
    "start": "852040",
    "end": "858040"
  },
  {
    "text": "some kind of computer room to find out what the layer one addressing was Layer Two is data link addresses",
    "start": "858040",
    "end": "867000"
  },
  {
    "text": "such as ethernet Max or whatever ever Layer Three is well-known IP",
    "start": "867000",
    "end": "873880"
  },
  {
    "text": "addressing layer four has its own addressing and TCP IP that is the protocols and the",
    "start": "873880",
    "end": "880880"
  },
  {
    "text": "ports and all this leads to an application string by modifying one addressing of",
    "start": "880880",
    "end": "888320"
  },
  {
    "text": "one of these layers we can modify the flow of data in",
    "start": "888320",
    "end": "893839"
  },
  {
    "text": "the network means we can modify the traffic path and here hereby",
    "start": "893839",
    "end": "899680"
  },
  {
    "text": "intercepting it changing it whatever so for Layer Two attack it",
    "start": "899680",
    "end": "907320"
  },
  {
    "text": "looks like this you can conduct a man in the middle attack um you give false data link",
    "start": "907320",
    "end": "916720"
  },
  {
    "text": "addresses I was promised a gun for",
    "start": "916720",
    "end": "921120"
  },
  {
    "text": "this okay so um you can give false data link addresses",
    "start": "925240",
    "end": "931160"
  },
  {
    "text": "to both the server and the client um and oops we too far go",
    "start": "931160",
    "end": "939680"
  },
  {
    "text": "back yeah here so and it mostly requires",
    "start": "940759",
    "end": "945959"
  },
  {
    "text": "um access to the broadcast domain means to the cable or at least to the switch",
    "start": "945959",
    "end": "952160"
  },
  {
    "text": "but the biggest Advantage is um that all the things that happen on Layer Two are",
    "start": "952160",
    "end": "959759"
  },
  {
    "text": "untouched that means if you have any kind of um checkin for modifications or",
    "start": "959759",
    "end": "967199"
  },
  {
    "text": "um any kind of checksums any kind of encryption on layer three it is not",
    "start": "967199",
    "end": "972440"
  },
  {
    "text": "affected because you just change the layer two addressing so now to the layer three",
    "start": "972440",
    "end": "978360"
  },
  {
    "text": "attack it is basically the same you give false next hop",
    "start": "978360",
    "end": "984279"
  },
  {
    "text": "information to the systems um server and client and the big",
    "start": "984279",
    "end": "991560"
  },
  {
    "text": "Advantage here is that you can do things remotely you are not limited to be in the same",
    "start": "991560",
    "end": "997759"
  },
  {
    "text": "broadcaster and as the tech scenari showed there are plenty of ways to do it",
    "start": "997759",
    "end": "1003560"
  },
  {
    "text": "and just to make sure you all understand this this presentation is not complete",
    "start": "1003560",
    "end": "1009720"
  },
  {
    "text": "and does not cover all possible ways to use routing protocols okay talking about protocols",
    "start": "1009720",
    "end": "1017160"
  },
  {
    "text": "let's go to the first one one of my favorite Cisco Discovery protocol um is",
    "start": "1017160",
    "end": "1022839"
  },
  {
    "text": "one of these protocols that run on most networks and most people don't even know it or don't bother the issue with this",
    "start": "1022839",
    "end": "1030360"
  },
  {
    "text": "is as far as I see it um it is both useless and",
    "start": "1030360",
    "end": "1037959"
  },
  {
    "text": "dangerous the intention was to make troubleshooting simple for Cisco",
    "start": "1037959",
    "end": "1044079"
  },
  {
    "text": "operators means for whoever doesn't know this protocol it runs directly on Layer",
    "start": "1044079",
    "end": "1050120"
  },
  {
    "text": "Two and a Cisco device is going to broadcast on Layer Two or better ethernet multicast on layer 2",
    "start": "1050120",
    "end": "1057840"
  },
  {
    "text": "information about itself so you're sitting on the next router and you say okay show me the CDP",
    "start": "1057840",
    "end": "1065080"
  },
  {
    "text": "neighbors and you will see routers that aren't configured maybe don't even have",
    "start": "1065080",
    "end": "1070280"
  },
  {
    "text": "an IP address yet but you see that they're there and you",
    "start": "1070280",
    "end": "1075840"
  },
  {
    "text": "can say okay the cable works the router is up I see",
    "start": "1075840",
    "end": "1081520"
  },
  {
    "text": "it this is pretty nice but the protocol has the big disadvantage of informing",
    "start": "1081520",
    "end": "1087640"
  },
  {
    "text": "any kind of eure of the capabilities of this device",
    "start": "1087640",
    "end": "1092760"
  },
  {
    "text": "things like software version platform um what type of device it is native vlans",
    "start": "1092760",
    "end": "1100120"
  },
  {
    "text": "and the list goes on so if you take this information off",
    "start": "1100120",
    "end": "1106720"
  },
  {
    "text": "the cable and yeah sorry this is not in the slide",
    "start": "1106720",
    "end": "1113400"
  },
  {
    "text": "um if you take this information off the cable and just analyze it correctly this is from one two we wrote",
    "start": "1113400",
    "end": "1121520"
  },
  {
    "text": "then you see here you have a device ID that is if you have DNS configured the",
    "start": "1121520",
    "end": "1127559"
  },
  {
    "text": "complete fully qualified domain name otherwise just the device you have the port ID the platform what type it is",
    "start": "1127559",
    "end": "1135600"
  },
  {
    "text": "duplex and if you're nice you can actually ask it what kind of software it",
    "start": "1135600",
    "end": "1140960"
  },
  {
    "text": "is which release who compiled it all the interesting",
    "start": "1140960",
    "end": "1146360"
  },
  {
    "text": "information same holds true for switches this one obviously was sitting",
    "start": "1146520",
    "end": "1151640"
  },
  {
    "text": "at Defcon um you see it announces itself as a layer to switch tells you okay you",
    "start": "1151640",
    "end": "1158520"
  },
  {
    "text": "have a full duplex Uplink this is my platform ID this is my",
    "start": "1158520",
    "end": "1164000"
  },
  {
    "text": "software so if this isn't bad enough um",
    "start": "1164000",
    "end": "1169320"
  },
  {
    "text": "on top of this CDP is vulnerable to a memory exhaustion attack that might",
    "start": "1169320",
    "end": "1176360"
  },
  {
    "text": "negatively influence the performance of your device um as you see here it really",
    "start": "1176360",
    "end": "1183840"
  },
  {
    "text": "doesn't know anymore what it is you can really flood the device with all kinds",
    "start": "1183840",
    "end": "1190440"
  },
  {
    "text": "of CDP information like plenty of random devices you just generate and it will",
    "start": "1190440",
    "end": "1197679"
  },
  {
    "text": "use all aable memory for that remember Cisco iOS is a flat memory",
    "start": "1197679",
    "end": "1204280"
  },
  {
    "text": "motor so I haven't discovered a good use for",
    "start": "1204280",
    "end": "1209440"
  },
  {
    "text": "CDP yet my advice would be to turn it off",
    "start": "1209440",
    "end": "1214559"
  },
  {
    "text": "completely on each and every device you have spanning tree",
    "start": "1214559",
    "end": "1221039"
  },
  {
    "text": "STP um is used to calculate forward paths on Flat Earth networks that means",
    "start": "1221039",
    "end": "1227360"
  },
  {
    "text": "for the situation on the left side here you have two switches and obviously you",
    "start": "1227360",
    "end": "1233080"
  },
  {
    "text": "have a problem because if you have a host sitting over here and this host",
    "start": "1233080",
    "end": "1239039"
  },
  {
    "text": "generates a broadcast frame what happens is this Frame hits both switches they",
    "start": "1239039",
    "end": "1244559"
  },
  {
    "text": "forward it over here so on this cable you suddenly have two broadcast frames they are received by the other",
    "start": "1244559",
    "end": "1252480"
  },
  {
    "text": "switch and forward it again and then you have four broadcast frames and so on if",
    "start": "1252480",
    "end": "1258320"
  },
  {
    "text": "someone wants to try that out just take two switches connect them like here um",
    "start": "1258320",
    "end": "1263919"
  },
  {
    "text": "PLU a Windows machine in there and boot it and you probably have about half a",
    "start": "1263919",
    "end": "1269679"
  },
  {
    "text": "minute before your network is toast so to solve this problem they sent",
    "start": "1269679",
    "end": "1276240"
  },
  {
    "text": "out so-called bpdus Bridge protocol data units to make",
    "start": "1276240",
    "end": "1281880"
  },
  {
    "text": "sure one of them is a logical rule that's what I tried to show over here so",
    "start": "1281880",
    "end": "1287039"
  },
  {
    "text": "S1 becomes The Logical root so S2 will forward frames to S1 just in case so S1",
    "start": "1287039",
    "end": "1294720"
  },
  {
    "text": "decides how many frames are existing on the networks this solves the problem",
    "start": "1294720",
    "end": "1302320"
  },
  {
    "text": "unfortunately there are big switch networks that really rely on this",
    "start": "1302320",
    "end": "1308080"
  },
  {
    "text": "technology and as you can imagine it has no authentication so what an eer could do",
    "start": "1308080",
    "end": "1315000"
  },
  {
    "text": "in larger networks is sending out lot of less or more or less correct",
    "start": "1315000",
    "end": "1321799"
  },
  {
    "text": "bpdus and hereby force all switches to recalculate the tree the spanning tree",
    "start": "1321799",
    "end": "1329679"
  },
  {
    "text": "all the time if you do that with a 100 megabit ethernet frame um you can get",
    "start": "1329679",
    "end": "1335080"
  },
  {
    "text": "the switches pretty busy so they probably have nothing else to do than recalculating the",
    "start": "1335080",
    "end": "1341240"
  },
  {
    "text": "tree and if the etier manages to be somehow more intelligent and create",
    "start": "1341240",
    "end": "1347159"
  },
  {
    "text": "bpdus that make him the root switch like this he could suddenly um be",
    "start": "1347159",
    "end": "1356159"
  },
  {
    "text": "in a very strong position um we have people that told us",
    "start": "1356159",
    "end": "1361679"
  },
  {
    "text": "they tried this on bigger networks successfully which means you become the",
    "start": "1361679",
    "end": "1367320"
  },
  {
    "text": "root in the tree and everything that is not handled locally on the switch is",
    "start": "1367320",
    "end": "1373360"
  },
  {
    "text": "forwarded to you so you have a very good position to sniff and nobody will notice",
    "start": "1373360",
    "end": "1378559"
  },
  {
    "text": "because if you ever try to debug um spending tree failure in a bigger switch Network you probably know that this",
    "start": "1378559",
    "end": "1385320"
  },
  {
    "text": "takes a lot of time i e 802.1 q",
    "start": "1385320",
    "end": "1392640"
  },
  {
    "text": "vlans probably well known um they're used to share vlans between",
    "start": "1392640",
    "end": "1400480"
  },
  {
    "text": "switches so you have trunking this here so you have a router",
    "start": "1400480",
    "end": "1407000"
  },
  {
    "text": "two switches and you have two different vlands the blue one and the green one the green one is VLAN one so the idea is",
    "start": "1407000",
    "end": "1416440"
  },
  {
    "text": "if you have a host on vline one and it sends a frame to the switch the frame",
    "start": "1416440",
    "end": "1421679"
  },
  {
    "text": "forwards it to the router it hits the other switch and is distributed over",
    "start": "1421679",
    "end": "1427520"
  },
  {
    "text": "VLAN one so you can connect multiple switches with multiple vand together and",
    "start": "1427520",
    "end": "1433320"
  },
  {
    "text": "have this um taken care of by the router",
    "start": "1433320",
    "end": "1438840"
  },
  {
    "text": "good idea the frames for the router to um",
    "start": "1438840",
    "end": "1444120"
  },
  {
    "text": "make sure he knows what VLAN they belong to are taged they get an",
    "start": "1444120",
    "end": "1450000"
  },
  {
    "text": "ID hi I'm this and that frame I belong to this and that VLAN and on the other",
    "start": "1450000",
    "end": "1456159"
  },
  {
    "text": "side of on the second side the tag is stripped off and the switch decides",
    "start": "1456159",
    "end": "1461480"
  },
  {
    "text": "which we then gets them now looking at this in detail the taging looks like",
    "start": "1461480",
    "end": "1467440"
  },
  {
    "text": "this we have the Nona destination and source and then we have um this TP ID",
    "start": "1467440",
    "end": "1476760"
  },
  {
    "text": "that actually um tells you that's the tag protocol identifier and it actually tells you",
    "start": "1476760",
    "end": "1483440"
  },
  {
    "text": "what protocol is in there in this case it is ethernet and then we have the tag",
    "start": "1483440",
    "end": "1489240"
  },
  {
    "text": "control information field which includes the user priority",
    "start": "1489240",
    "end": "1494360"
  },
  {
    "text": "over here a canonical format identication which is get a strange thing because it",
    "start": "1494360",
    "end": "1500559"
  },
  {
    "text": "changes its meaning all over the place depending on what protocol is in the",
    "start": "1500559",
    "end": "1506320"
  },
  {
    "text": "Warframe and we have the VLAN ID so after that we have the normal type",
    "start": "1506320",
    "end": "1515000"
  },
  {
    "text": "payload stuff following the obvious ID is to do VLAN",
    "start": "1515000",
    "end": "1520919"
  },
  {
    "text": "hopping um by exploiting the fact that plenty of",
    "start": "1520919",
    "end": "1527159"
  },
  {
    "text": "switches is um already accept taged frames for Cisco it is the default",
    "start": "1527159",
    "end": "1533520"
  },
  {
    "text": "setting if I have VLAN one and VLAN 2 VLAN one is per default enabled to",
    "start": "1533520",
    "end": "1540679"
  },
  {
    "text": "accept already taged frames on every port which",
    "start": "1540679",
    "end": "1546480"
  },
  {
    "text": "means an ater sends out an already tagged frame saying okay this Frame he",
    "start": "1546480",
    "end": "1552880"
  },
  {
    "text": "sitting on VLAN one this Frame is targeted for VLAN 2 of course he needs",
    "start": "1552880",
    "end": "1558679"
  },
  {
    "text": "to know the mech address of Victim Because things like ARP and stuff don't work but assumed he knows",
    "start": "1558679",
    "end": "1566919"
  },
  {
    "text": "that this tag frame is taken as it is forwarded to the router who puts it on",
    "start": "1566919",
    "end": "1573440"
  },
  {
    "text": "the other switch who in turn strips off the tagging and sends the",
    "start": "1573440",
    "end": "1579200"
  },
  {
    "text": "frame so we successfully jump",
    "start": "1579200",
    "end": "1583799"
  },
  {
    "text": "fens Adis resolution protocol ARP I assume everyone knows that pretty good",
    "start": "1585640",
    "end": "1591279"
  },
  {
    "text": "and as I said I raise over that one to give Jonathan something to talk about in",
    "start": "1591279",
    "end": "1598799"
  },
  {
    "text": "detail how it works just in case you need a little bit Refresh on it um host",
    "start": "1598799",
    "end": "1605360"
  },
  {
    "text": "a wants to talk to host B on the network layer figures out the IP on a data link",
    "start": "1605360",
    "end": "1611520"
  },
  {
    "text": "layer figures out he has no idea what data link address to use so he broadcasts the the",
    "start": "1611520",
    "end": "1618520"
  },
  {
    "text": "request host be answers this is my Mech address and here we",
    "start": "1618520",
    "end": "1625679"
  },
  {
    "text": "go so an eer of course sees the broadcast as well",
    "start": "1625720",
    "end": "1634279"
  },
  {
    "text": "so what we do is when he broadcasts eeka appears no",
    "start": "1634279",
    "end": "1640799"
  },
  {
    "text": "first we have the answer then our eer appears",
    "start": "1640799",
    "end": "1645919"
  },
  {
    "text": "and he will send a different data link address for the same requested IP and while it yeah you",
    "start": "1645919",
    "end": "1653440"
  },
  {
    "text": "can as well lie to both parties so the traffic is forwarded through his",
    "start": "1653440",
    "end": "1662320"
  },
  {
    "text": "interface that is very old but still very",
    "start": "1662320",
    "end": "1667720"
  },
  {
    "text": "effective um yeah I saw that some people think it is worth writing a white paper",
    "start": "1668399",
    "end": "1673840"
  },
  {
    "text": "over it just to mention it here um this works the same way for wireless",
    "start": "1673840",
    "end": "1681600"
  },
  {
    "text": "networks pretty simple the risk of it even if it is even",
    "start": "1681600",
    "end": "1687960"
  },
  {
    "text": "it is simple and old and everyone should be aware of it but the risk is that not",
    "start": "1687960",
    "end": "1694600"
  },
  {
    "text": "only sniffing is possible but if you have an Interceptor that is a little bit more intelligent than that he can modify",
    "start": "1694600",
    "end": "1701840"
  },
  {
    "text": "the frames on the way so if you have like accounting information sus",
    "start": "1701840",
    "end": "1708279"
  },
  {
    "text": "information authentication or just let's say a plain email by forwarding the",
    "start": "1708279",
    "end": "1714960"
  },
  {
    "text": "frames you can decide if you forward them where you forward them to and you",
    "start": "1714960",
    "end": "1722120"
  },
  {
    "text": "might change the content of the frame so the risks are pretty high because um you",
    "start": "1722120",
    "end": "1727960"
  },
  {
    "text": "can do oops little power outage okay um you can",
    "start": "1727960",
    "end": "1733960"
  },
  {
    "text": "do next to everything with the traffic um requirements for the eer quite",
    "start": "1733960",
    "end": "1740000"
  },
  {
    "text": "obvious has to be in the ethernet broadcast domain and mostly requires the eek's interface in priscus",
    "start": "1740000",
    "end": "1748360"
  },
  {
    "text": "mode where's my gun okay um DHCP even your trusty DHCP",
    "start": "1750279",
    "end": "1759080"
  },
  {
    "text": "protocol can be used for attacks it's often overlooked everyone uses the HTP",
    "start": "1759080",
    "end": "1764120"
  },
  {
    "text": "because it's so convenient you just connect your PC to Network get an IP address get a default gateway get an",
    "start": "1764120",
    "end": "1771880"
  },
  {
    "text": "DHCP server um and and DNS server so",
    "start": "1771880",
    "end": "1777159"
  },
  {
    "text": "everything is fine um you can do an IP exhaustion attack on",
    "start": "1777159",
    "end": "1785880"
  },
  {
    "text": "the DHCP server IP addresses are a limited resource so if this is the hcp",
    "start": "1785880",
    "end": "1792640"
  },
  {
    "text": "server no longer has any IP address to give away he will not do that",
    "start": "1792640",
    "end": "1797840"
  },
  {
    "text": "that so after this one has no IP addresses",
    "start": "1797840",
    "end": "1804960"
  },
  {
    "text": "anymore and a client requests the IP address to get one you are the only one",
    "start": "1804960",
    "end": "1811960"
  },
  {
    "text": "who can provide an IP address to so the client has the nice choice of eat or die",
    "start": "1811960",
    "end": "1819440"
  },
  {
    "text": "means take this IP address and IP configuration or just don't have network",
    "start": "1819440",
    "end": "1826240"
  },
  {
    "text": "connectivity this is very effective since the configuration we provide",
    "start": "1826240",
    "end": "1833480"
  },
  {
    "text": "should have eer as DNS as well as the default",
    "start": "1833480",
    "end": "1839039"
  },
  {
    "text": "gateway which suddenly makes it very easy to first of all sniff traffic and",
    "start": "1839039",
    "end": "1846080"
  },
  {
    "text": "secondly provide wrong IP addresses for a DNS request which can have very bad",
    "start": "1846080",
    "end": "1853760"
  },
  {
    "text": "effects like for auto updating software and stuff that looks out and says okay I",
    "start": "1853760",
    "end": "1859720"
  },
  {
    "text": "need um updat host. company.com and I have to talk to it and ask if there is a",
    "start": "1859720",
    "end": "1865720"
  },
  {
    "text": "new software version um you provide this name and let's say some IP address that",
    "start": "1865720",
    "end": "1873200"
  },
  {
    "text": "belongs to a server you control um and just upload some kind of software that",
    "start": "1873200",
    "end": "1878919"
  },
  {
    "text": "satisfies this auto update mechanism you can force this host here to just install",
    "start": "1878919",
    "end": "1885840"
  },
  {
    "text": "and run the software this is just one example of course you can make up fake",
    "start": "1885840",
    "end": "1891679"
  },
  {
    "text": "servers or even fake websites so if he connects to",
    "start": "1891679",
    "end": "1897240"
  },
  {
    "text": "www bank.com um and enters his user credentials you get",
    "start": "1897240",
    "end": "1903880"
  },
  {
    "text": "them the thing with the DHCP servers and the IP exhaustion attack is um that",
    "start": "1903880",
    "end": "1910519"
  },
  {
    "text": "especially if you run Microsoft servers um this is very easy because you don't",
    "start": "1910519",
    "end": "1915799"
  },
  {
    "text": "even have to ask for IP to be assigned to you um I assume most people know how",
    "start": "1915799",
    "end": "1922679"
  },
  {
    "text": "DHCP works the so-called Dora concept like um discover offer request and a",
    "start": "1922679",
    "end": "1930880"
  },
  {
    "text": "knowledge if you just sent out plenty of um Discovery frames and asked the server",
    "start": "1930880",
    "end": "1938399"
  },
  {
    "text": "could you like tell me if you can give me ip addresses um Microsoft servers",
    "start": "1938399",
    "end": "1945360"
  },
  {
    "text": "follow the RFC a little bit too tide which is new for Microsoft um the RFC",
    "start": "1945360",
    "end": "1952000"
  },
  {
    "text": "says okay if you offer something you should block this IP",
    "start": "1952000",
    "end": "1957559"
  },
  {
    "text": "address you just offered for a while since if this guy comes back and says okay I request this IP address then you",
    "start": "1957559",
    "end": "1966159"
  },
  {
    "text": "will give it to him anyway so you should block it for a certain period of time which is not specified by sending out",
    "start": "1966159",
    "end": "1973360"
  },
  {
    "text": "plenty of these Discovery frames um the Microsoft servers tend to block all the",
    "start": "1973360",
    "end": "1978720"
  },
  {
    "text": "IP addresses they have available which is kind of funny because you don't see",
    "start": "1978720",
    "end": "1984120"
  },
  {
    "text": "it the lease is not established you don't tell the server I don't want to",
    "start": "1984120",
    "end": "1989480"
  },
  {
    "text": "have it by sending a not a knowledge frame you just don't talk to it at all",
    "start": "1989480",
    "end": "1996120"
  },
  {
    "text": "afterwards that leads to the situation where the Microsoft DHCP sits there",
    "start": "1996120",
    "end": "2002960"
  },
  {
    "text": "having all its available IP addresses blocked um having no active",
    "start": "2002960",
    "end": "2008200"
  },
  {
    "text": "lease and this is I think for 9 minutes or something like that so for 9 minutes",
    "start": "2008200",
    "end": "2016080"
  },
  {
    "text": "nothing happens and the most funny part is that in some way in the registry these",
    "start": "2016080",
    "end": "2025240"
  },
  {
    "text": "IP addresses are stored as potentially lease but in the MMC you don't see",
    "start": "2025240",
    "end": "2033279"
  },
  {
    "text": "them no idea why this happens but this is very Danger dous and it is hard to",
    "start": "2033279",
    "end": "2038480"
  },
  {
    "text": "recover from such an attack if you have a bigger Network and server DHCP",
    "start": "2038480",
    "end": "2045159"
  },
  {
    "text": "servers discovering router what could an eer do to discover routers um of course there's passive and",
    "start": "2045440",
    "end": "2052919"
  },
  {
    "text": "active ways to do that passive is pretty obvious um you listen for multicast traffic or for any kind of",
    "start": "2052919",
    "end": "2060398"
  },
  {
    "text": "advertisements CDP other Discovery protocols um active recovery is a little",
    "start": "2060399",
    "end": "2067800"
  },
  {
    "text": "bit more noisy of course um but can be done remotely you can scan for autonomous",
    "start": "2067800",
    "end": "2074358"
  },
  {
    "text": "systems routing protocols run on autonomous systems so the same routing protocol on the same router can have um",
    "start": "2074359",
    "end": "2081800"
  },
  {
    "text": "sever autonomous systems that run different route distributions just to keep things",
    "start": "2081800",
    "end": "2088679"
  },
  {
    "text": "separated and you have to find out which autonomous system is in use of course so",
    "start": "2088679",
    "end": "2093800"
  },
  {
    "text": "obviously you can scan for them and um you can send out router solicitations",
    "start": "2093800",
    "end": "2100640"
  },
  {
    "text": "and just ask the network um could you give me a way a routers you can use things like normal",
    "start": "2100640",
    "end": "2108880"
  },
  {
    "text": "operating system fingerprinting um provided with nmap or",
    "start": "2108880",
    "end": "2114200"
  },
  {
    "text": "X probe or you just scan for protocols and ports that might give away routing",
    "start": "2114200",
    "end": "2123760"
  },
  {
    "text": "devices and of course if someone is running uh Network management system and",
    "start": "2123760",
    "end": "2129040"
  },
  {
    "text": "has all the configs and all the information on the nms stored just take over the nms you get all the routers for",
    "start": "2129040",
    "end": "2137720"
  },
  {
    "text": "free so this is like an scan of a example Network um the first four lines",
    "start": "2137720",
    "end": "2144440"
  },
  {
    "text": "are passive stuff irdp was seen because it's broadcasted all the time enhan igp",
    "start": "2144440",
    "end": "2151040"
  },
  {
    "text": "was seen nice you get the iOS version included in this Frame and and by actively",
    "start": "2151040",
    "end": "2158560"
  },
  {
    "text": "scanning um you just hook up to the autonomous systems you just found and",
    "start": "2158560",
    "end": "2164200"
  },
  {
    "text": "asked it okay give me the information and you get the information like destination network net mask next toop",
    "start": "2164200",
    "end": "2171359"
  },
  {
    "text": "if any um all the data for the matric um calculation we covered that later you",
    "start": "2171359",
    "end": "2178800"
  },
  {
    "text": "see if it is an external route you see where it came from like the router I got",
    "start": "2178800",
    "end": "2184200"
  },
  {
    "text": "it from um that's his IP here had it as a connected link or in this case here",
    "start": "2184200",
    "end": "2190800"
  },
  {
    "text": "from another enhanced igp router so it's pretty shaty it would tell you next to",
    "start": "2190800",
    "end": "2196960"
  },
  {
    "text": "everything you need to know so there are obviously tooths for",
    "start": "2196960",
    "end": "2202400"
  },
  {
    "text": "that um the we wrote one that we call autonomous system scanner um if you want",
    "start": "2202400",
    "end": "2210200"
  },
  {
    "text": "to try that by hand you can just take etheral or whatever sniffer you prefer",
    "start": "2210200",
    "end": "2216800"
  },
  {
    "text": "and see what information is in rout in the routing protocols antop can be used to see just Central points of",
    "start": "2216800",
    "end": "2224200"
  },
  {
    "text": "communication in the network on and on the way to them you probably hit the",
    "start": "2224200",
    "end": "2229319"
  },
  {
    "text": "most busy routers TCP Dums d e option shows you the data link address and",
    "start": "2229319",
    "end": "2235119"
  },
  {
    "text": "obviously if the destination IP and the destination data link address don't",
    "start": "2235119",
    "end": "2240960"
  },
  {
    "text": "match the data link address is the one of the next HP router as I say nmap can be used for",
    "start": "2240960",
    "end": "2248200"
  },
  {
    "text": "protocol scans um DHCP queries of course if they give you a default router that",
    "start": "2248200",
    "end": "2254200"
  },
  {
    "text": "is probably your next Target and as I said nms databases",
    "start": "2254200",
    "end": "2260200"
  },
  {
    "text": "are good targets icmp router Discovery protocol",
    "start": "2260200",
    "end": "2266319"
  },
  {
    "text": "or irdp um that is again one of these protocols that most people have running",
    "start": "2266319",
    "end": "2272359"
  },
  {
    "text": "on their systems and don't know it um the idea is that routers advertise",
    "start": "2272359",
    "end": "2280400"
  },
  {
    "text": "themselves as possible default gateways and hosts broadcast on boot up like okay",
    "start": "2280400",
    "end": "2287839"
  },
  {
    "text": "is everyone willing to be my default gateway so the router answers and the host is happy and knows where to forward",
    "start": "2287839",
    "end": "2294040"
  },
  {
    "text": "the traffic to of course if you have a fixed routing entry in your host like you conf figured",
    "start": "2294040",
    "end": "2300800"
  },
  {
    "text": "a default gateway it should have um higher priority means a lower Matrix",
    "start": "2300800",
    "end": "2308200"
  },
  {
    "text": "and yeah the router answers are usually in the priority higher than anything",
    "start": "2308200",
    "end": "2314960"
  },
  {
    "text": "else so if you have like another routing protocol running on your host and it does irdp then irdp mostly has priority",
    "start": "2314960",
    "end": "2323440"
  },
  {
    "text": "over it so that's what it is thought for",
    "start": "2323440",
    "end": "2329599"
  },
  {
    "text": "um eek sends irdp updates",
    "start": "2329599",
    "end": "2335520"
  },
  {
    "text": "and just to make sure that he is the only router to do that he has to take off the",
    "start": "2335520",
    "end": "2343040"
  },
  {
    "text": "other router for a short period of time probably by doing CDP overflow attacks",
    "start": "2343040",
    "end": "2349520"
  },
  {
    "text": "as I showed earlier or something like this and then the host will forward the",
    "start": "2349520",
    "end": "2354680"
  },
  {
    "text": "traffic through this one this is especially dangerous with Windows hosts um we cover that in the next",
    "start": "2354680",
    "end": "2362800"
  },
  {
    "text": "slide in general the thing is these hosts believe it they believe everything",
    "start": "2362800",
    "end": "2369520"
  },
  {
    "text": "again this is a protocol that has no authentication um doesn't even care where it comes from it is hard to turn",
    "start": "2369520",
    "end": "2376640"
  },
  {
    "text": "off and you can become the default gateway for a specific host or for the W",
    "start": "2376640",
    "end": "2384040"
  },
  {
    "text": "Network so if the attacker wants to evade the IDS or just doesn't want to be",
    "start": "2384040",
    "end": "2390960"
  },
  {
    "text": "detected well attackers normally want so um",
    "start": "2390960",
    "end": "2397160"
  },
  {
    "text": "he just sends this information to one host instead of the world network works",
    "start": "2397160",
    "end": "2403839"
  },
  {
    "text": "perfect so as I say it can be used targeted or not um the maximum lifetime",
    "start": "2403839",
    "end": "2409280"
  },
  {
    "text": "of this route is 18 hours it's a long time for uh Windows 90 something irdp is",
    "start": "2409280",
    "end": "2418400"
  },
  {
    "text": "enabled all the time you see irdp um on boot up of course router",
    "start": "2418400",
    "end": "2424720"
  },
  {
    "text": "solicitations but it will accept irdp answers all the",
    "start": "2424720",
    "end": "2430760"
  },
  {
    "text": "time and it can be forced to use the attacker route by the preference value",
    "start": "2430760",
    "end": "2437319"
  },
  {
    "text": "as I said normally if you have a fixed configurate configured default gateway and you receive an irdp frame um",
    "start": "2437319",
    "end": "2445400"
  },
  {
    "text": "normally the irdp information is just used if the router is not aable which is for Windows very short",
    "start": "2445400",
    "end": "2452880"
  },
  {
    "text": "period of time for checking if the router is avable means if your real router is a dialup router and he just",
    "start": "2452880",
    "end": "2460880"
  },
  {
    "text": "takes two seconds to um get your ISD end line up this already counts as not",
    "start": "2460880",
    "end": "2467359"
  },
  {
    "text": "weable means if an etier did irdp attacks on you and you try to connect to",
    "start": "2467359",
    "end": "2475880"
  },
  {
    "text": "some remote side and your router is taking up the line and just trying to do",
    "start": "2475880",
    "end": "2481280"
  },
  {
    "text": "PPP with the ISP or whatever um your windows thinks the router is no longer avilable uses",
    "start": "2481280",
    "end": "2487920"
  },
  {
    "text": "e but by setting the preference to 1,000 the following happens Windows receives",
    "start": "2487920",
    "end": "2493440"
  },
  {
    "text": "this IRP advertisement and for some reason I have no idea why um the windows",
    "start": "2493440",
    "end": "2500200"
  },
  {
    "text": "9x implementation is take the preference value um take 1,000 sub subtract the",
    "start": "2500200",
    "end": "2508079"
  },
  {
    "text": "preference value from 1,000 and use this as a matrix obviously if we put 1,000 in",
    "start": "2508079",
    "end": "2514119"
  },
  {
    "text": "there we have the matric of zero which makes access the default router",
    "start": "2514119",
    "end": "2519319"
  },
  {
    "text": "automatically nt4 um performs irdp just some boot um but works basically the",
    "start": "2519319",
    "end": "2526160"
  },
  {
    "text": "same way the good news is Windows 2000 and Linux don't care at all I didn't",
    "start": "2526160",
    "end": "2532680"
  },
  {
    "text": "even find a way to turn it on on these systems so it's just for older operating",
    "start": "2532680",
    "end": "2538640"
  },
  {
    "text": "systems obviously icmp redirects",
    "start": "2538640",
    "end": "2544599"
  },
  {
    "text": "um very old very well known um but still very powerful and very",
    "start": "2544599",
    "end": "2552359"
  },
  {
    "text": "dangerous it was invented to make the routing more effective so just we have",
    "start": "2552359",
    "end": "2558559"
  },
  {
    "text": "this traffic here host a for wats has router one configured as the defa",
    "start": "2558559",
    "end": "2563880"
  },
  {
    "text": "Gateway forwards the frame to router one router one figures oops I forward the same frame on the same subnet same IP um",
    "start": "2563880",
    "end": "2571599"
  },
  {
    "text": "to router 2 so question is why did host a just not",
    "start": "2571599",
    "end": "2577000"
  },
  {
    "text": "send the frame directly to router 2 and he will actually tell this host a host a",
    "start": "2577000",
    "end": "2582520"
  },
  {
    "text": "will accept this information say Okay um I adjust my routing table and so it goes",
    "start": "2582520",
    "end": "2590839"
  },
  {
    "text": "over there something happened with the slides yeah okay so the attack is",
    "start": "2590839",
    "end": "2597559"
  },
  {
    "text": "obvious because that works wise Versa we have this normal tra traffic path here",
    "start": "2597559",
    "end": "2603280"
  },
  {
    "text": "from host a to host B and attacker just tells host a um dude your routing wasn't",
    "start": "2603280",
    "end": "2611839"
  },
  {
    "text": "very effective please use me as your default gateway and host a will do",
    "start": "2611839",
    "end": "2619400"
  },
  {
    "text": "that normally this looks like you have to be on the same cable because normally you have to",
    "start": "2619400",
    "end": "2626400"
  },
  {
    "text": "include at least 64 bit of the original offending packet in the icmp why because",
    "start": "2626400",
    "end": "2633800"
  },
  {
    "text": "host a would like to dis discover okay which host which Port did I try to",
    "start": "2633800",
    "end": "2638880"
  },
  {
    "text": "connect to um so to which connection applies this message so the general",
    "start": "2638880",
    "end": "2645400"
  },
  {
    "text": "assumption is always you have to be on the same segment of course you don't have to you can include this 64 bit",
    "start": "2645400",
    "end": "2652680"
  },
  {
    "text": "information yourself just make up some kind of um IP address this was the",
    "start": "2652680",
    "end": "2658839"
  },
  {
    "text": "source and whatever destination you want to redirect to and send it to the",
    "start": "2658839",
    "end": "2664640"
  },
  {
    "text": "host normally the checks done on IP headers that are normal for normal",
    "start": "2664640",
    "end": "2670720"
  },
  {
    "text": "frames um are not done with the information in the icmp packet ofer makes use of that in the X probe um too",
    "start": "2670720",
    "end": "2678160"
  },
  {
    "text": "because they're usually changed a lot and the operating system doesn't really care it just looks okay what was the",
    "start": "2678160",
    "end": "2685119"
  },
  {
    "text": "destination I used so this is pretty easy and you can",
    "start": "2685119",
    "end": "2691839"
  },
  {
    "text": "do this remotely the very bad news is that we figured out a lot of routers in",
    "start": "2691839",
    "end": "2698920"
  },
  {
    "text": "Internet backbones still accept icmp redirects from any source that means you can go to the",
    "start": "2698920",
    "end": "2705559"
  },
  {
    "text": "router in a backbone and tell okay for reaching this particular host let's say",
    "start": "2705559",
    "end": "2712520"
  },
  {
    "text": "um DDD security Focus com um forward the frame somewhere else and as we see later",
    "start": "2712520",
    "end": "2719359"
  },
  {
    "text": "in a routing protocol attacks you can do this so nobody reaches the host",
    "start": "2719359",
    "end": "2724880"
  },
  {
    "text": "anymore the host reactions for icmp redirect are",
    "start": "2724880",
    "end": "2731440"
  },
  {
    "text": "quite different for Windows 9x um it always accepts icmp",
    "start": "2731440",
    "end": "2738240"
  },
  {
    "text": "redirect and adds them as a host route to the routing table as we can imagine the routing",
    "start": "2738240",
    "end": "2744839"
  },
  {
    "text": "table um uses memory and the more icmp redirect we feed in there the more",
    "start": "2744839",
    "end": "2750240"
  },
  {
    "text": "memory is used we managed to kill some windows hosts using um lots of icmp",
    "start": "2750240",
    "end": "2757040"
  },
  {
    "text": "redirects because they just used all aable memory for Linux hosts or yeah for Linux",
    "start": "2757040",
    "end": "2764480"
  },
  {
    "text": "Host this is different it accepts icmp redirects by default in some",
    "start": "2764480",
    "end": "2770000"
  },
  {
    "text": "distributions like redhead and Suzie",
    "start": "2770000",
    "end": "2775520"
  },
  {
    "text": "distributions um of course you can configure that but the bad news is you",
    "start": "2775520",
    "end": "2780640"
  },
  {
    "text": "don't see them they're not in a routing table they're hidden deeply in um the",
    "start": "2780640",
    "end": "2786480"
  },
  {
    "text": "Colonel's cach tables and you can only discover them by looking in your proc file system so if you're running a Linux",
    "start": "2786480",
    "end": "2794200"
  },
  {
    "text": "host and it accepts icmp redirects you have no easy way to track what happens um and of course there are tools",
    "start": "2794200",
    "end": "2801920"
  },
  {
    "text": "to send these redirects out and test your hosts yourself and this is how it",
    "start": "2801920",
    "end": "2806960"
  },
  {
    "text": "looks like on a Windows 9x machine um you probably can't read it in the in",
    "start": "2806960",
    "end": "2814119"
  },
  {
    "text": "the rows there but the pattern is obviously you have host routes all over",
    "start": "2814119",
    "end": "2820079"
  },
  {
    "text": "the place here and you probably can imagine that it takes a lot of",
    "start": "2820079",
    "end": "2825119"
  },
  {
    "text": "processing power to sort them and to Route stuff if you have a small 9x host",
    "start": "2825119",
    "end": "2830400"
  },
  {
    "text": "and you have like 20,000 routes in",
    "start": "2830400",
    "end": "2835400"
  },
  {
    "text": "there so let's go to the routing protocols itself um interior Gateway",
    "start": "2836240",
    "end": "2841680"
  },
  {
    "text": "routing protocol is a plain Cisco idea",
    "start": "2841680",
    "end": "2847280"
  },
  {
    "text": "it has um 65,535 possible autonomous systems um as",
    "start": "2847280",
    "end": "2853760"
  },
  {
    "text": "I said autonomous systems used to separate routing processes from each other it uses no",
    "start": "2853760",
    "end": "2860680"
  },
  {
    "text": "authentication um it uses delay bandwidth reliability load and hop count",
    "start": "2860680",
    "end": "2866079"
  },
  {
    "text": "to calculate the Matrix um there is the possibility to",
    "start": "2866079",
    "end": "2871440"
  },
  {
    "text": "have Paths of hosts that just listen there and get the information and just don't uh send out routing",
    "start": "2871440",
    "end": "2879599"
  },
  {
    "text": "information and as we can imagine if you make up an update and you can choose",
    "start": "2879599",
    "end": "2886960"
  },
  {
    "text": "these values yourself you are probably able to create a metric that is way",
    "start": "2886960",
    "end": "2892720"
  },
  {
    "text": "better than rear word links why because you can include um the information that",
    "start": "2892720",
    "end": "2899960"
  },
  {
    "text": "your bandwidth exceeds let's say 10 gbits and um you are perfectly reliable",
    "start": "2899960",
    "end": "2907559"
  },
  {
    "text": "and you have no traffic on the link so this results in like the best matric you can",
    "start": "2907559",
    "end": "2914040"
  },
  {
    "text": "get of course everyone who knows Cisco um knows that the",
    "start": "2914040",
    "end": "2920839"
  },
  {
    "text": "network comes from or better the IP address this update comes from has to be enabled as a possible source of Updates",
    "start": "2920839",
    "end": "2928079"
  },
  {
    "text": "this is this um strange Network statement you always have in your router configuration when it comes to routing",
    "start": "2928079",
    "end": "2934599"
  },
  {
    "text": "protocols so um as we will later here in the securing CIS router speech make",
    "start": "2934599",
    "end": "2941720"
  },
  {
    "text": "perfectly sure that this information matches your network and you just don't say each and every network is",
    "start": "2941720",
    "end": "2948960"
  },
  {
    "text": "a possible source for routing updates so by making up these updates what can we do",
    "start": "2948960",
    "end": "2956119"
  },
  {
    "text": "um we could use igop to introduce new",
    "start": "2956119",
    "end": "2961960"
  },
  {
    "text": "new routes or updating existing ones so our Acker down here um wants to",
    "start": "2961960",
    "end": "2971720"
  },
  {
    "text": "use irgp attacks and would like to see the password that is transmitted from",
    "start": "2971720",
    "end": "2977880"
  },
  {
    "text": "host B to this little server over here since this is a routing domain",
    "start": "2977880",
    "end": "2983119"
  },
  {
    "text": "sniffing is not an option and yeah so he decides to go for igp attacks first of",
    "start": "2983119",
    "end": "2991240"
  },
  {
    "text": "all he adds the IP address of the server to his interface face like as a",
    "start": "2991240",
    "end": "2996599"
  },
  {
    "text": "secondary IP address and then enables IP forwarding",
    "start": "2996599",
    "end": "3002280"
  },
  {
    "text": "so if he receives an packet destinated for 10",
    "start": "3002280",
    "end": "3007400"
  },
  {
    "text": "1.1.2 on his 10 1.3.2 interface the operating system will",
    "start": "3007400",
    "end": "3013480"
  },
  {
    "text": "forward the frame so then he tells router one using",
    "start": "3013480",
    "end": "3019720"
  },
  {
    "text": "router 3's IP address um that 10.1.3 two is the",
    "start": "3019720",
    "end": "3026680"
  },
  {
    "text": "absolutely best way to reach 10112 so you tell this router that if",
    "start": "3026680",
    "end": "3032280"
  },
  {
    "text": "you ever receive a frame for 10112 this is the best way to forward",
    "start": "3032280",
    "end": "3039640"
  },
  {
    "text": "it then he tells router 2 over here um using router 1's IP",
    "start": "3039640",
    "end": "3048720"
  },
  {
    "text": "address that um router one is absolutely the best",
    "start": "3048720",
    "end": "3055040"
  },
  {
    "text": "router to reach 10112 so this router gets the",
    "start": "3055040",
    "end": "3061000"
  },
  {
    "text": "information that this way is the best to reach the",
    "start": "3061000",
    "end": "3066440"
  },
  {
    "text": "server so if host B logs into what he thinks is the server he",
    "start": "3066480",
    "end": "3073799"
  },
  {
    "text": "sends the packet to router two router two following his routing table sends it to router one it is sent to the ater's",
    "start": "3073799",
    "end": "3081319"
  },
  {
    "text": "host and hits the fake server on the ater's host",
    "start": "3081319",
    "end": "3087359"
  },
  {
    "text": "if for some reason eeka just wants to prevent communication he can make that using a routing",
    "start": "3088119",
    "end": "3094559"
  },
  {
    "text": "Loop he tells router 3 that the absolutely best way to reach host B is",
    "start": "3094559",
    "end": "3101880"
  },
  {
    "text": "router one and he tells router one that the absolutely best way to reach host be",
    "start": "3101880",
    "end": "3107440"
  },
  {
    "text": "is router three and then he sits back and enjoys seeing the TTL going up and the packet",
    "start": "3107440",
    "end": "3115520"
  },
  {
    "text": "being dropped as I said earlier in the icmp redirect",
    "start": "3115520",
    "end": "3121520"
  },
  {
    "text": "section um you don't have to use routing protocols for that you can use that with icmp",
    "start": "3121520",
    "end": "3127960"
  },
  {
    "text": "redirects the problem here is that bigger networks still accept icmp to",
    "start": "3127960",
    "end": "3133640"
  },
  {
    "text": "redirects on some hosts while you can protect yourself here pretty good um by",
    "start": "3133640",
    "end": "3139760"
  },
  {
    "text": "configuring the three routers correctly and just tell them okay if you receive a",
    "start": "3139760",
    "end": "3145359"
  },
  {
    "text": "routing update on this interface just ignore it whatever it claims whatever IP",
    "start": "3145359",
    "end": "3151760"
  },
  {
    "text": "it claims to come from just ignored for icmp redirects if they're in the default",
    "start": "3151760",
    "end": "3157119"
  },
  {
    "text": "configuration you can't do that so for internet backbones consisting of a lot more than these three routers um people",
    "start": "3157119",
    "end": "3165079"
  },
  {
    "text": "are still able to deny access to certain hosts or host ranges just by sending two",
    "start": "3165079",
    "end": "3172200"
  },
  {
    "text": "icmp packets to two vulnerable routers and and this is done right now in the",
    "start": "3172200",
    "end": "3179880"
  },
  {
    "text": "internet routing information protocol rip um it's probably the oldest one",
    "start": "3181000",
    "end": "3187359"
  },
  {
    "text": "still in use it uses fixed Network sizes and",
    "start": "3187359",
    "end": "3192880"
  },
  {
    "text": "doesn't even have autonomous systems and stuff just runs on top of UDP Port 520",
    "start": "3192880",
    "end": "3199240"
  },
  {
    "text": "um that's pretty much it it heavily depends on broadcast um in the version",
    "start": "3199240",
    "end": "3204640"
  },
  {
    "text": "one and makes it therefore pretty easy to be uh to discover in the network rib",
    "start": "3204640",
    "end": "3212760"
  },
  {
    "text": "version 2 actually already uses multicast and can really cope with",
    "start": "3212760",
    "end": "3218400"
  },
  {
    "text": "variable Network sizes and V2 supports clear text",
    "start": "3218400",
    "end": "3223559"
  },
  {
    "text": "passwords which don't actually help if you have multicast so Cisco even supports",
    "start": "3223559",
    "end": "3230520"
  },
  {
    "text": "md5 um but the problem with that is if you use rib you probably have not only",
    "start": "3230520",
    "end": "3236359"
  },
  {
    "text": "Cisco equipment because then you would use some other protocol and um the md5",
    "start": "3236359",
    "end": "3243240"
  },
  {
    "text": "hashing that Cisco does is not following the RFC because it has a double authentication block so an older device",
    "start": "3243240",
    "end": "3250920"
  },
  {
    "text": "talking rip is unable to process this Frame so it's not likely to be used and",
    "start": "3250920",
    "end": "3257400"
  },
  {
    "text": "I thought I will never again see rip and um this being the Windows security",
    "start": "3257400",
    "end": "3263839"
  },
  {
    "text": "blackhead um do we have people here that have Windows 2000 servers that actually run the rip",
    "start": "3263839",
    "end": "3271319"
  },
  {
    "text": "listener anyone okay that makes me",
    "start": "3271319",
    "end": "3276640"
  },
  {
    "text": "happy I discovered that you can install a rip listener and the Windows 2000 will actually take the rip packets and update",
    "start": "3276640",
    "end": "3284520"
  },
  {
    "text": "its routing table uh which I thought is a real bright idea to support exactly",
    "start": "3284520",
    "end": "3289839"
  },
  {
    "text": "one routing protocol the one that is most insecure okay I mean",
    "start": "3289839",
    "end": "3296359"
  },
  {
    "text": "nobody uses it that makes me happy rip attacks pretty obvious same",
    "start": "3296359",
    "end": "3302599"
  },
  {
    "text": "idea as with igp um you have to watch out for the network classes of course if",
    "start": "3302599",
    "end": "3308240"
  },
  {
    "text": "someone um plays around with rip V1 and has no idea how it works he might try to",
    "start": "3308240",
    "end": "3315359"
  },
  {
    "text": "introduce routes um that require subnet mask and he might take socially down",
    "start": "3315359",
    "end": "3322240"
  },
  {
    "text": "your Bo Network because he didn't figure out how r v want works correctly there is a thing called split",
    "start": "3322240",
    "end": "3329079"
  },
  {
    "text": "Horizon with poison reverse that was thought of to make um routing Loops",
    "start": "3329079",
    "end": "3337240"
  },
  {
    "text": "impossible if a router receives a routing update he sends back to the",
    "start": "3337240",
    "end": "3343319"
  },
  {
    "text": "original sending router a RI frame saying okay I know the route um but he",
    "start": "3343319",
    "end": "3349960"
  },
  {
    "text": "includes the matric 16 which means um this is an infinite High matri trick and",
    "start": "3349960",
    "end": "3356039"
  },
  {
    "text": "you shouldn't use that link helps to prevent routing Loops doesn't protect",
    "start": "3356039",
    "end": "3361280"
  },
  {
    "text": "you if someone really wants to introduce routing Loops in your network with rip",
    "start": "3361280",
    "end": "3366920"
  },
  {
    "text": "it is still possible um and of course if you want to",
    "start": "3366920",
    "end": "3372280"
  },
  {
    "text": "test that there are um older tools like the r probe and um s from Humble the",
    "start": "3372280",
    "end": "3379200"
  },
  {
    "text": "Nemesis rip Center works pretty okay um and of course you can use our as tool to",
    "start": "3379200",
    "end": "3385920"
  },
  {
    "text": "scan that enhanced interior Gateway routing",
    "start": "3385920",
    "end": "3391039"
  },
  {
    "text": "protocol is yet another Cisco idea as you probably figured it has um 2 to the",
    "start": "3391039",
    "end": "3398839"
  },
  {
    "text": "power of 32 possible autonomous systems um which makes it very powerful the",
    "start": "3398839",
    "end": "3404160"
  },
  {
    "text": "funny part is that the iOS system shell suggests only",
    "start": "3404160",
    "end": "3410160"
  },
  {
    "text": "65,535 so I've never seen any network that used a higher number than that one",
    "start": "3410160",
    "end": "3416400"
  },
  {
    "text": "for enhan GP um autonomous systems it still has no",
    "start": "3416400",
    "end": "3421960"
  },
  {
    "text": "authentication as far as I know um or wait a second you can use md5",
    "start": "3421960",
    "end": "3427960"
  },
  {
    "text": "authentication on it um but I'm not sure how many people do that I learned that",
    "start": "3427960",
    "end": "3434599"
  },
  {
    "text": "yesterday from the great guy who actually does the securing Cisco router speech",
    "start": "3434599",
    "end": "3439680"
  },
  {
    "text": "later you use that with md5 does it work correctly",
    "start": "3439680",
    "end": "3446799"
  },
  {
    "text": "okay okay good so I have to update that one um still it uses delay um bandwidth",
    "start": "3452640",
    "end": "3461200"
  },
  {
    "text": "reliability load hop count to use and for calculate matric and for the",
    "start": "3461200",
    "end": "3467960"
  },
  {
    "text": "attacker it is a little bit more different because he has to become a neighbor to exchange routing information",
    "start": "3467960",
    "end": "3474000"
  },
  {
    "text": "with autonomous system system um and again it requires the source Network to",
    "start": "3474000",
    "end": "3480319"
  },
  {
    "text": "be enabled as possible source for Neighbors well yeah despite the fact",
    "start": "3480319",
    "end": "3486119"
  },
  {
    "text": "that authentication is possible it works pretty well by just",
    "start": "3486119",
    "end": "3491799"
  },
  {
    "text": "joining in as a neighbor which is barely visible here these routers talk an ANP",
    "start": "3491799",
    "end": "3498440"
  },
  {
    "text": "and we have this little eer here he joins in and says hi I'm a new router",
    "start": "3498440",
    "end": "3504280"
  },
  {
    "text": "and then he inject rout and just disappears again oops very good way to",
    "start": "3504280",
    "end": "3510520"
  },
  {
    "text": "track that is if you have your Cisco configure to lock neighbor changes in",
    "start": "3510520",
    "end": "3516440"
  },
  {
    "text": "enhanced igp if you see a neighbor appear and disappear all over the place",
    "start": "3516440",
    "end": "3522200"
  },
  {
    "text": "and this IP address doesn't look like one of your routers it's probably someone playing with",
    "start": "3522200",
    "end": "3529838"
  },
  {
    "text": "you H yeah",
    "start": "3531359",
    "end": "3536720"
  },
  {
    "text": "open shortest path first OPF um is a bit more complex as the",
    "start": "3541200",
    "end": "3547520"
  },
  {
    "text": "other protocols which makes it very interesting I don't even know um all the",
    "start": "3547520",
    "end": "3553559"
  },
  {
    "text": "features and all the ways to implement um OPF so if you have specific OPF",
    "start": "3553559",
    "end": "3559480"
  },
  {
    "text": "questions I refer to the securing gred speeches yeah",
    "start": "3559480",
    "end": "3566240"
  },
  {
    "text": "um it basically sends out link State advertisements in so-called Halo packets",
    "start": "3566240",
    "end": "3572280"
  },
  {
    "text": "to a multicast address saying okay hi I'm a router um and this is what I know",
    "start": "3572280",
    "end": "3579480"
  },
  {
    "text": "and the problem is if you design OPF networks they are split up in areas that",
    "start": "3579480",
    "end": "3587079"
  },
  {
    "text": "makes it possible to have um not all routers talk to each other because in OPF every router knows the status of the",
    "start": "3587079",
    "end": "3594640"
  },
  {
    "text": "W area and knows the routes of the W area which is pretty good because it",
    "start": "3594640",
    "end": "3600680"
  },
  {
    "text": "saves you the problem if someone injects routes he has to make that correctly so",
    "start": "3600680",
    "end": "3606359"
  },
  {
    "text": "every router in this area accepts this",
    "start": "3606359",
    "end": "3611720"
  },
  {
    "text": "injection so OPF has a lot more security features than most other routing",
    "start": "3611720",
    "end": "3617839"
  },
  {
    "text": "protocols it even supports in the r cmd5 authentication but on the downside OPF",
    "start": "3617839",
    "end": "3626760"
  },
  {
    "text": "is K complex so many OPF networks I've seen are um flawed by Design and are not",
    "start": "3626760",
    "end": "3635960"
  },
  {
    "text": "correctly implemented and the eer might be lucky just by exploiting this bad",
    "start": "3635960",
    "end": "3644280"
  },
  {
    "text": "configuration since the protocol is complex the attex tend to be kind complex um people try to use OPF senders",
    "start": "3645119",
    "end": "3654039"
  },
  {
    "text": "and just introduce routes into the networks it didn't really work that normally led to deny of service on the",
    "start": "3654039",
    "end": "3660640"
  },
  {
    "text": "world Network it either went down or um just shoked for a minute and then work",
    "start": "3660640",
    "end": "3668839"
  },
  {
    "text": "correctly because forged lsas these link State advertisements um are often challenged",
    "start": "3668839",
    "end": "3676079"
  },
  {
    "text": "by other routers in the area obviously you sent this LSA out and R say no this",
    "start": "3676079",
    "end": "3683119"
  },
  {
    "text": "is not right this is not correct we don't accept that and you have this",
    "start": "3683119",
    "end": "3688200"
  },
  {
    "text": "challenge situation so as an eer you can just introduce a route as simple as it is",
    "start": "3688200",
    "end": "3694440"
  },
  {
    "text": "with rib and so we came up with this sample attack here we have these routers",
    "start": "3694440",
    "end": "3702359"
  },
  {
    "text": "all talking OPF to each other and eeka wants to distribute a new route in this",
    "start": "3702359",
    "end": "3709440"
  },
  {
    "text": "network over here so before router one and router two",
    "start": "3709440",
    "end": "3715119"
  },
  {
    "text": "exchange information which they don't do via multicast but by unicast that is",
    "start": "3715119",
    "end": "3721799"
  },
  {
    "text": "called a database transfer he does a layer two interception using the classic",
    "start": "3721799",
    "end": "3727920"
  },
  {
    "text": "arack and as I said in the AR section you can have interceptors that are a bit",
    "start": "3727920",
    "end": "3734440"
  },
  {
    "text": "more intelligent than just taking the mech addresses and um sending wrong Mech",
    "start": "3734440",
    "end": "3741119"
  },
  {
    "text": "addresses out but you can have a forwarding engine that actually modifies the packets on the way",
    "start": "3741119",
    "end": "3749240"
  },
  {
    "text": "from A to B so that's what he does router one sends out the database",
    "start": "3749240",
    "end": "3754400"
  },
  {
    "text": "transfer um router 2 receives the database transfer but unfortunately with",
    "start": "3754400",
    "end": "3760799"
  },
  {
    "text": "a little bit changed IP address and next toop information and then it goes out to the",
    "start": "3760799",
    "end": "3768319"
  },
  {
    "text": "rest of the area and they will actually believe",
    "start": "3768319",
    "end": "3773359"
  },
  {
    "text": "it border Gateway protocol bgp4 um is very interesting is exterior",
    "start": "3773359",
    "end": "3782720"
  },
  {
    "text": "Gateway protocol and um it's just mentioned here because it's a little bit important it",
    "start": "3782720",
    "end": "3788520"
  },
  {
    "text": "runs the internet as you probably know um bgp has the big advantage of",
    "start": "3788520",
    "end": "3795640"
  },
  {
    "text": "relying on TCP communication to work so",
    "start": "3795640",
    "end": "3801200"
  },
  {
    "text": "um routers to talk pgp to each other have to have a communication way means",
    "start": "3801200",
    "end": "3808480"
  },
  {
    "text": "router one has to reach router B somehow um to actually connect to Port 179 and",
    "start": "3808480",
    "end": "3815880"
  },
  {
    "text": "exchange information we have interior bgp and",
    "start": "3815880",
    "end": "3821039"
  },
  {
    "text": "exterior bgp interior bgp um is normally the better Target because it",
    "start": "3821039",
    "end": "3828480"
  },
  {
    "text": "relies on interior Gateway protocols beginning with static routes up to anoun",
    "start": "3828480",
    "end": "3834240"
  },
  {
    "text": "inside JP or whatever you want to use um to reach the other routers because they're normally not",
    "start": "3834240",
    "end": "3841480"
  },
  {
    "text": "directly connected so the possible attacks just in not just but mostly include bad",
    "start": "3841480",
    "end": "3848760"
  },
  {
    "text": "updates um as shown in the OPF slide or",
    "start": "3848760",
    "end": "3854440"
  },
  {
    "text": "abuse of so-called bgp communities which is get of interesting because um this community can influence a remote router",
    "start": "3854440",
    "end": "3862359"
  },
  {
    "text": "um from what ever source that is configured and everyone uses that um TCP",
    "start": "3862359",
    "end": "3869400"
  },
  {
    "text": "sequence number attacks um since it is a TCP connection can be used but are",
    "start": "3869400",
    "end": "3875119"
  },
  {
    "text": "probably not very successful because if you run bgp on your router you have probably configured it correctly and",
    "start": "3875119",
    "end": "3881079"
  },
  {
    "text": "have the right iOS image so you're no longer very predictable um and the most effective",
    "start": "3881079",
    "end": "3888799"
  },
  {
    "text": "attack um seems to be attacking the igp that lies under intera",
    "start": "3888799",
    "end": "3896000"
  },
  {
    "text": "bgp um I was told last time I had this speech that um there is a",
    "start": "3896000",
    "end": "3902400"
  },
  {
    "text": "bgp4 attack tool out there in the blackhead community that actually exploits some kind of fault in the iOS",
    "start": "3902400",
    "end": "3910200"
  },
  {
    "text": "so there are people that actually can send out bgp route updates to any kind",
    "start": "3910200",
    "end": "3916359"
  },
  {
    "text": "of backbone router um and this backbone router will accept it so this means um",
    "start": "3916359",
    "end": "3924319"
  },
  {
    "text": "there isn't much research done with all the possible attacks but we shouldn't",
    "start": "3924319",
    "end": "3930880"
  },
  {
    "text": "rely on the fact that bgp is",
    "start": "3930880",
    "end": "3934680"
  },
  {
    "text": "secure the hot standby router protocol one of my favorites um it's a Cisco",
    "start": "3936440",
    "end": "3944079"
  },
  {
    "text": "proprietary protocol for High avability um the idea is to have multiple routers",
    "start": "3944079",
    "end": "3951400"
  },
  {
    "text": "and they all share IP address and a Mech address that",
    "start": "3951400",
    "end": "3956720"
  },
  {
    "text": "is bound to whatever router is active the rest of the routers just sits and waits um until the active router dies so",
    "start": "3956720",
    "end": "3965880"
  },
  {
    "text": "it's kid like a big family um you wait till your uncle dies so you can collect the",
    "start": "3965880",
    "end": "3971000"
  },
  {
    "text": "money um yeah the protocol talks over UDP and",
    "start": "3971000",
    "end": "3977279"
  },
  {
    "text": "uses a clear text 8 character authentication password um everything",
    "start": "3977279",
    "end": "3982839"
  },
  {
    "text": "runs on multicast so if you are nearby and you receive multicast packets um you",
    "start": "3982839",
    "end": "3988960"
  },
  {
    "text": "can actually take the password out there and send your own",
    "start": "3988960",
    "end": "3994920"
  },
  {
    "text": "updates and yeah that is basically all the security you can",
    "start": "3994920",
    "end": "4001760"
  },
  {
    "text": "get the attack on that is pretty obvious um here router one has the virtual IP",
    "start": "4003079",
    "end": "4010319"
  },
  {
    "text": "that is the blue Cisco thing over here um and everyone is using router one to",
    "start": "4010319",
    "end": "4017319"
  },
  {
    "text": "forward the traffic because router one helps the virtual IP address so if we go",
    "start": "4017319",
    "end": "4023599"
  },
  {
    "text": "to router one and tell him hey router 2 has a higher priority and it's way better router um that works the problem",
    "start": "4023599",
    "end": "4031960"
  },
  {
    "text": "here is that this communication that runs over multicast for",
    "start": "4031960",
    "end": "4038119"
  },
  {
    "text": "hsrp um is not checked by The Cisco router for the destination address means",
    "start": "4038119",
    "end": "4044279"
  },
  {
    "text": "I sent a packet to router one as a unicast to his IP address and it is",
    "start": "4044279",
    "end": "4050000"
  },
  {
    "text": "still valid for Cisco so eer doesn't have to sit here eer can sit somewhere",
    "start": "4050000",
    "end": "4056400"
  },
  {
    "text": "in the internet and just send the packet and say change of routers new priority",
    "start": "4056400",
    "end": "4063119"
  },
  {
    "text": "switch over so here that is how the switch over",
    "start": "4063119",
    "end": "4070480"
  },
  {
    "text": "worked and of course I can tell them hey I'm the best router um give me the rer",
    "start": "4070480",
    "end": "4077480"
  },
  {
    "text": "IP address and that works as well the bad thing is since it works remotely and doesn't",
    "start": "4077480",
    "end": "4084920"
  },
  {
    "text": "require your destination IP address to be multicast it works across the internet",
    "start": "4084920",
    "end": "4090599"
  },
  {
    "text": "and a lot of people um that run big e-commerce sites have two routers got",
    "start": "4090599",
    "end": "4097520"
  },
  {
    "text": "them from the ISP just say to the ISP we want a high varability and internet connectivity so they get two rout",
    "start": "4097520",
    "end": "4104159"
  },
  {
    "text": "talking hsrp to each other um mostly having the default password which is",
    "start": "4104159",
    "end": "4110838"
  },
  {
    "text": "Cisco um and that's it I mean it works if one",
    "start": "4110839",
    "end": "4116000"
  },
  {
    "text": "router dies the other one takes over but if I send two packets to this side saying H you get a third you got a third",
    "start": "4116000",
    "end": "4123000"
  },
  {
    "text": "router and this one is way the best one these two go into",
    "start": "4123000",
    "end": "4128560"
  },
  {
    "text": "standby end of game yeah so so that's the way the",
    "start": "4128600",
    "end": "4135238"
  },
  {
    "text": "attacker receives the traffic and that's it attacking tunnels after so much",
    "start": "4135239",
    "end": "4142400"
  },
  {
    "text": "routing um I thought i' just give oh yeah vrp um is supposed to be",
    "start": "4142400",
    "end": "4150199"
  },
  {
    "text": "solution to this problem because V can include um authentication headers um",
    "start": "4150199",
    "end": "4155679"
  },
  {
    "text": "such as IP SE does um I was told that it",
    "start": "4155679",
    "end": "4160920"
  },
  {
    "text": "doesn't really work that way and people mostly use V p with md5 hash",
    "start": "4160920",
    "end": "4166278"
  },
  {
    "text": "passwords I didn't implement it myself but V is the solution for",
    "start": "4166279",
    "end": "4173040"
  },
  {
    "text": "that theory of unencrypted tunnel attacks lots of people have um tunnels",
    "start": "4175159",
    "end": "4181960"
  },
  {
    "text": "in place and not all of them are IPS I want to make perfectly sure we're",
    "start": "4181960",
    "end": "4189640"
  },
  {
    "text": "not talking about IP SEC here we're talking about unencrypted unauthentic indicated tunnels um the idea is to",
    "start": "4189640",
    "end": "4197280"
  },
  {
    "text": "attack such a tunnel just generate traffic for the inside Target Network then encapsulate your traffic",
    "start": "4197280",
    "end": "4205640"
  },
  {
    "text": "and send it to one of the tunneling end points and the return path of course",
    "start": "4205640",
    "end": "4212360"
  },
  {
    "text": "pretty much depends on how the router is configured as we see later vulnerable protocols include IP",
    "start": "4212360",
    "end": "4221040"
  },
  {
    "text": "encapsulation ip4 in ip4 generic routing encapsulation and everything else that",
    "start": "4221040",
    "end": "4227560"
  },
  {
    "text": "uses the same idea for GR generic routing",
    "start": "4227560",
    "end": "4233280"
  },
  {
    "text": "encapsulation that looks like this um you can as the name suggests um",
    "start": "4233280",
    "end": "4238600"
  },
  {
    "text": "encapsulate everything in everything because it's just an extension header to IP header",
    "start": "4238600",
    "end": "4245600"
  },
  {
    "text": "um you can have ipv4 and V4 V6 and V4 ipx and V4 whatsoever you have an",
    "start": "4245600",
    "end": "4253080"
  },
  {
    "text": "optional 32-bit tunnel key that is well you sent in all the packets um 32bit is",
    "start": "4253080",
    "end": "4261040"
  },
  {
    "text": "not that much if you have a good internet connectivity it takes a lot of time to send out um all possible tunnel",
    "start": "4261040",
    "end": "4270120"
  },
  {
    "text": "key packets to see which one is the right one but it is possible we tried",
    "start": "4270120",
    "end": "4275560"
  },
  {
    "text": "that it works we have sequence numbers to prevent things like reply attacks and",
    "start": "4275560",
    "end": "4282120"
  },
  {
    "text": "stuff but these are in the RFC not very good documented it just says have",
    "start": "4282120",
    "end": "4288520"
  },
  {
    "text": "sequence numbers and the implementation in iOS is even worse means if one side",
    "start": "4288520",
    "end": "4295880"
  },
  {
    "text": "doesn't use sequence numbers and the other side does nobody cares it works it",
    "start": "4295880",
    "end": "4302199"
  },
  {
    "text": "still talks to each other and even if they fix that in later releases um the",
    "start": "4302199",
    "end": "4308800"
  },
  {
    "text": "sequence number is highly predictable because it starts by one and increases by one",
    "start": "4308800",
    "end": "4314199"
  },
  {
    "text": "so um this is not really an issue but we have S routing in G we can",
    "start": "4314199",
    "end": "4322280"
  },
  {
    "text": "even include Source routing information in the G frame so",
    "start": "4322280",
    "end": "4330199"
  },
  {
    "text": "scenario um that situation is pretty common even in Europe and I learned two weeks ago that it is still sold that way",
    "start": "4330199",
    "end": "4337880"
  },
  {
    "text": "I thought it is um off the portfolios for most providers but unfortunately it isn't",
    "start": "4337880",
    "end": "4344120"
  },
  {
    "text": "the company has an HQ on the right side here with the server and um it has",
    "start": "4344120",
    "end": "4350840"
  },
  {
    "text": "server Branch offices one of them is on the left side here with this little client so the company um",
    "start": "4350840",
    "end": "4358840"
  },
  {
    "text": "used normal um land lines direct lease lines to connect these two offices but",
    "start": "4358840",
    "end": "4364800"
  },
  {
    "text": "they figured this is very expensive and um we could use the internet to get the",
    "start": "4364800",
    "end": "4371639"
  },
  {
    "text": "traffic from A to B and since they had a good Network planning they used RFC 1918",
    "start": "4371639",
    "end": "4377600"
  },
  {
    "text": "IP addresses here um the 10 Network to",
    "start": "4377600",
    "end": "4382880"
  },
  {
    "text": "configure their internal hosts so now they want to save money and ask the ISP",
    "start": "4382880",
    "end": "4389560"
  },
  {
    "text": "okay could you build an VPN for us so",
    "start": "4389560",
    "end": "4395000"
  },
  {
    "text": "the ISP says sure we can we offer the following VPN we set up a g tunnel between your",
    "start": "4395000",
    "end": "4402440"
  },
  {
    "text": "internet rout well um the default gateway for the",
    "start": "4402440",
    "end": "4408320"
  },
  {
    "text": "branch office is this router he will take every traffic put it into the",
    "start": "4408320",
    "end": "4413679"
  },
  {
    "text": "tunnel it goes over there gets decapsulated and reachs the server same for the way back um this is pretty okay",
    "start": "4413679",
    "end": "4422760"
  },
  {
    "text": "um client over here can now talk to the server over here they save money everything fine so since this is a VPN",
    "start": "4422760",
    "end": "4432040"
  },
  {
    "text": "and VPN includes P for private um they had some kind of security configured",
    "start": "4432040",
    "end": "4437719"
  },
  {
    "text": "they just said okay the branch office router um does not allow any",
    "start": "4437719",
    "end": "4443239"
  },
  {
    "text": "traffic on the outside interface other than GRE from the HQ R so it's",
    "start": "4443239",
    "end": "4450440"
  },
  {
    "text": "secure um and he routes all the traffic he gets into this tunnel so nothing",
    "start": "4450440",
    "end": "4457320"
  },
  {
    "text": "leaks to the big bad internet um the HQ router does not allow",
    "start": "4457320",
    "end": "4464280"
  },
  {
    "text": "any incoming connections on the outside interface of course and does only allow",
    "start": "4464280",
    "end": "4469360"
  },
  {
    "text": "G from the bench offices so we should be",
    "start": "4469360",
    "end": "4475239"
  },
  {
    "text": "secure we have this eer down here he has its own network connected to the",
    "start": "4475920",
    "end": "4482120"
  },
  {
    "text": "internet and he wants to attack client",
    "start": "4482120",
    "end": "4487520"
  },
  {
    "text": "system the obvious way would be to send an email with some kind of EES e",
    "start": "4487520",
    "end": "4493520"
  },
  {
    "text": "attachment to this guy because he would probably click on it but assumed that",
    "start": "4493520",
    "end": "4498880"
  },
  {
    "text": "doesn't work um he wants to directly attack and port scan this system so what",
    "start": "4498880",
    "end": "4505800"
  },
  {
    "text": "he does is um he sets up another system that takes care of the G",
    "start": "4505800",
    "end": "4514560"
  },
  {
    "text": "encapsulation so now he makes up the system and sets it",
    "start": "4514560",
    "end": "4522760"
  },
  {
    "text": "as his default gateway instead of that router so whatever traffic eer generates",
    "start": "4522760",
    "end": "4528000"
  },
  {
    "text": "for an outside network is forwarded to this",
    "start": "4528000",
    "end": "4533040"
  },
  {
    "text": "system so now he sends out a frame with the destination 101 5.2 which is",
    "start": "4534360",
    "end": "4540719"
  },
  {
    "text": "obviously the client he wants to attack this is received by this Virtual",
    "start": "4540719",
    "end": "4546480"
  },
  {
    "text": "Router thing here that takes care of the",
    "start": "4546480",
    "end": "4550639"
  },
  {
    "text": "encapsulation it gets encapsulated with the destination IP address of the outside interface this router the GRE",
    "start": "4551600",
    "end": "4559120"
  },
  {
    "text": "header that doesn't do anything in a default configuration it's just two Nyes no",
    "start": "4559120",
    "end": "4564880"
  },
  {
    "text": "four um the encapsulated destination is still this client The Source address obviously",
    "start": "4564880",
    "end": "4573199"
  },
  {
    "text": "is the one from the HQ router and so this router receives the frame and thinks oh nice G encapsulated",
    "start": "4573199",
    "end": "4581600"
  },
  {
    "text": "coming from my HQ router everything here just decapsulated it um and put it on",
    "start": "4581600",
    "end": "4587960"
  },
  {
    "text": "the routing process again then figure out oh 101.5 is inside so forward it to",
    "start": "4587960",
    "end": "4593719"
  },
  {
    "text": "the host over here now this host receives the packet which is bad enough",
    "start": "4593719",
    "end": "4600400"
  },
  {
    "text": "but now he thinks okay we answer this packet maybe it was a soon so we answer",
    "start": "4600400",
    "end": "4605440"
  },
  {
    "text": "soon AK um and what happens is he sends it to the router the router according to",
    "start": "4605440",
    "end": "4613639"
  },
  {
    "text": "the rules encapsulates it sends it into the tunnel to the HQ router HQ router",
    "start": "4613639",
    "end": "4620040"
  },
  {
    "text": "receives it comes from the right Source everything good good so decapsulate the",
    "start": "4620040",
    "end": "4625560"
  },
  {
    "text": "frame then figure out oops this IP address because the inside packet here",
    "start": "4625560",
    "end": "4633840"
  },
  {
    "text": "had as destination this one but as Source the real IP address from eer so we know how to reach that because",
    "start": "4633840",
    "end": "4642639"
  },
  {
    "text": "we're connected to the internet so we just forward it and finally ater is able",
    "start": "4642639",
    "end": "4649040"
  },
  {
    "text": "um to talk to a computer that is first of all using rc98 IP address second",
    "start": "4649040",
    "end": "4656679"
  },
  {
    "text": "sitting behind the router that is supposed to protect him from the internet and this is all possible",
    "start": "4656679",
    "end": "4663120"
  },
  {
    "text": "because of this GRE tunnel so the same works for ip4 um",
    "start": "4663120",
    "end": "4671480"
  },
  {
    "text": "encapsulation and a special esally for IPv6 Islands um how many of you have a",
    "start": "4671480",
    "end": "4677239"
  },
  {
    "text": "IPv6 um six bone Island Uplink something want to do you use",
    "start": "4677239",
    "end": "4685639"
  },
  {
    "text": "G direct connection to",
    "start": "4685639",
    "end": "4689480"
  },
  {
    "text": "the okay I would love to show up at your side",
    "start": "4691239",
    "end": "4697000"
  },
  {
    "text": "um anyway lots of people have V6 islands that use GRE to connect to the six bone",
    "start": "4697000",
    "end": "4704120"
  },
  {
    "text": "because they don't have the luxury of a direct Uplink like you have um so that's",
    "start": "4704120",
    "end": "4710440"
  },
  {
    "text": "how it looks like one side is the six bone the other side is some kind of Island um and since our nice internet is",
    "start": "4710440",
    "end": "4718159"
  },
  {
    "text": "still using V4 mostly you have to encapsulate that in G so you can again",
    "start": "4718159",
    "end": "4724760"
  },
  {
    "text": "use the same attack um to have just V6 as your payload and",
    "start": "4724760",
    "end": "4732000"
  },
  {
    "text": "forward it into this JY tunnel so it gets decapsulated and hits the host",
    "start": "4732000",
    "end": "4738080"
  },
  {
    "text": "you're attacking um good news for the defense site is the way back obviously",
    "start": "4738080",
    "end": "4744120"
  },
  {
    "text": "doesn't work or you have yet another connection somewhere to the six bone um where you",
    "start": "4744120",
    "end": "4751520"
  },
  {
    "text": "actually can receive these six packets so um if you want to test that",
    "start": "4751520",
    "end": "4758199"
  },
  {
    "text": "in your network um we wrote some tools um I",
    "start": "4758199",
    "end": "4763800"
  },
  {
    "text": "mentioned a few of them they're on the website they should be on your CD",
    "start": "4763800",
    "end": "4769719"
  },
  {
    "text": "assumed you already got that um there are other tools to check that um have to",
    "start": "4769719",
    "end": "4775679"
  },
  {
    "text": "mention Nemesis of course but honestly um Nemesis has the issue with not",
    "start": "4775679",
    "end": "4781880"
  },
  {
    "text": "working correctly all the time just some packets like the OPF Center doesn't",
    "start": "4781880",
    "end": "4786960"
  },
  {
    "text": "really work um so the best way to check that out is always having a sniffer",
    "start": "4786960",
    "end": "4793199"
  },
  {
    "text": "handy and see what really happens that's the summary um there are",
    "start": "4793199",
    "end": "4801840"
  },
  {
    "text": "many many ways to Adder a traffic path as I said this is far from being complete um I assume that in the Cisco",
    "start": "4801840",
    "end": "4810120"
  },
  {
    "text": "speech we will hear more ways to add the traffic path and of course more ways to protect",
    "start": "4810120",
    "end": "4816800"
  },
  {
    "text": "yourself against that most routing Protocols are very insufficient protected and if you set up a routing",
    "start": "4816800",
    "end": "4824800"
  },
  {
    "text": "protocol you have to make extra sure that you understand who needs to talk to each other routing protocols and you",
    "start": "4824800",
    "end": "4832440"
  },
  {
    "text": "have to make sure that um updates from other sources are not accepted and of course I hope this is",
    "start": "4832440",
    "end": "4840199"
  },
  {
    "text": "clear by now unencrypted tunneling is very high risk and um especially if",
    "start": "4840199",
    "end": "4848679"
  },
  {
    "text": "you have these so-called private IP addresses and consider that as a security measure um they don't protect",
    "start": "4848679",
    "end": "4858040"
  },
  {
    "text": "you yeah that's it um short thanks um oh yeah the part with the code over here um",
    "start": "4858040",
    "end": "4865360"
  },
  {
    "text": "we started that in blackhead Amsterdam um we have a little per code on this web",
    "start": "4865360",
    "end": "4870440"
  },
  {
    "text": "page over here um that needs to be explained and if someone is bored over",
    "start": "4870440",
    "end": "4876880"
  },
  {
    "text": "two beers or something it doesn't take too long um just send in an explanation and receive one of these words that's",
    "start": "4876880",
    "end": "4883880"
  },
  {
    "text": "pretty much it um thank you for staying",
    "start": "4883880",
    "end": "4888000"
  },
  {
    "text": "awake",
    "start": "4911639",
    "end": "4914639"
  }
]