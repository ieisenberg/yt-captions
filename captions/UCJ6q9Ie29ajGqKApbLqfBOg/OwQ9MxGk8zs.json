[
  {
    "start": "0",
    "end": "48000"
  },
  {
    "text": "complex solutions that include some of those pieces and then we also do your more standard penetration testing and",
    "start": "30",
    "end": "6839"
  },
  {
    "text": "red teaming and other things like that a little bit out of scope for this talk though so we've been working on servers in particular for a couple of different",
    "start": "6839",
    "end": "13559"
  },
  {
    "text": "customers that have unique and interesting use cases and design",
    "start": "13559",
    "end": "19140"
  },
  {
    "text": "requirements and drivers that push",
    "start": "19140",
    "end": "24539"
  },
  {
    "text": "security in the right direction so it's been it's been fun to learn sort of over",
    "start": "24539",
    "end": "31050"
  },
  {
    "text": "the over time about where the vulnerabilities have been and where the problems have been and then seeing it",
    "start": "31050",
    "end": "36360"
  },
  {
    "text": "evolve and seeing it the attack surface shrink and a bunch of other sort of more",
    "start": "36360",
    "end": "41809"
  },
  {
    "text": "maturity minded things that have been occurring and in working through that so",
    "start": "41809",
    "end": "47430"
  },
  {
    "text": "this talk then former cartography what does that even mean what are we talking about so the",
    "start": "47430",
    "end": "53550"
  },
  {
    "start": "48000",
    "end": "139000"
  },
  {
    "text": "point here is we're saying in a modern new server attack surface has been",
    "start": "53550",
    "end": "60570"
  },
  {
    "text": "reduced if configured correctly attack surface has been reduced to such a",
    "start": "60570",
    "end": "66060"
  },
  {
    "text": "degree that we're left with much smaller windows through which we need to do all",
    "start": "66060",
    "end": "72900"
  },
  {
    "text": "the stuff we want to do as attackers in doing so how do you figure that out",
    "start": "72900",
    "end": "78119"
  },
  {
    "text": "right and that's the whole point of this talk it's saying let's pull apart the whole sort of server a modern server",
    "start": "78119",
    "end": "85439"
  },
  {
    "text": "let's we want to talk about it in terms of this is how we approach the problem so there are a lot of talks you know",
    "start": "85439",
    "end": "94560"
  },
  {
    "text": "across across blackhat this year and in prior years that focus in on a lot of",
    "start": "94560",
    "end": "100530"
  },
  {
    "text": "the individual pieces we're gonna use a couple of case studies here in a bit that will talk through that but the idea",
    "start": "100530",
    "end": "107460"
  },
  {
    "text": "here is to explain and cover the attack surface the reasons why you would want to hit up hit these different things the",
    "start": "107460",
    "end": "113070"
  },
  {
    "text": "kind of problems where that exists in these different components and as we get",
    "start": "113070",
    "end": "118950"
  },
  {
    "text": "towards the end will particularly focus on this is this is where it's going right so if you care about security then",
    "start": "118950",
    "end": "125939"
  },
  {
    "text": "you're doing X Y & Z and you're you are configuring your newer servers in certain fashions even when it's for",
    "start": "125939",
    "end": "133440"
  },
  {
    "text": "configured you end up with certain amounts of attack surface and so that's where we enjoy spending a lot of our",
    "start": "133440",
    "end": "138900"
  },
  {
    "text": "time right Amanat server now it's full of many different components right",
    "start": "138900",
    "end": "146070"
  },
  {
    "start": "139000",
    "end": "180000"
  },
  {
    "text": "you've got servers and side servers you get computers and side computers all the way down as I mentioned you know there's",
    "start": "146070",
    "end": "151620"
  },
  {
    "text": "been a lot of talk to the last 15 years UEFI BMC there's constantly new pieces but as it becomes more hardened that",
    "start": "151620",
    "end": "158820"
  },
  {
    "text": "that that attack surface is concentrated into fewer and fewer components you end up will you have gating events where you",
    "start": "158820",
    "end": "165090"
  },
  {
    "text": "need to you need to compromise you know that thing over there first to get all the information that you might want to crowbar open that the attack surface",
    "start": "165090",
    "end": "172380"
  },
  {
    "text": "again and then be able to you know pivot into other components so we'll talk",
    "start": "172380",
    "end": "178650"
  },
  {
    "text": "through all those different areas all right so what's the set that matters here right so we're we're we're being a",
    "start": "178650",
    "end": "185640"
  },
  {
    "start": "180000",
    "end": "199000"
  },
  {
    "text": "little hand wavy on purpose and we are summarizing multiple components into one group to be able to talk about it in in",
    "start": "185640",
    "end": "192480"
  },
  {
    "text": "those fashions so like here's where we got right we've got host SM in BMC peripherals and chipset and we'll walk",
    "start": "192480",
    "end": "197790"
  },
  {
    "text": "through those here in some detail so like starting in the host this is the thing everybody thinks of this is what",
    "start": "197790",
    "end": "203970"
  },
  {
    "start": "199000",
    "end": "610000"
  },
  {
    "text": "it's exactly what it sounds like right this is the your software that's running",
    "start": "203970",
    "end": "209459"
  },
  {
    "text": "on a CPU for a lot of the attack chains that we'll talk about today we kind of",
    "start": "209459",
    "end": "215250"
  },
  {
    "text": "glop what happens inside the host right there's a ton of talks talking about all and you guys know all the loaner",
    "start": "215250",
    "end": "241410"
  },
  {
    "text": "abilities that are related to these platforms in userland on these hosts and that's actually a",
    "start": "241410",
    "end": "248100"
  },
  {
    "text": "gigantic attack surface so it it's relatively unhardened like i was looking",
    "start": "248100",
    "end": "253320"
  },
  {
    "text": "at it and prep for this talk like last week and and take it found to 200 days",
    "start": "253320",
    "end": "258419"
  },
  {
    "text": "like just still out on my lap I think it's a very unreviewed environment and",
    "start": "258419",
    "end": "264060"
  },
  {
    "text": "if this stuff is MIT is meant to you tear down all the walls that we're",
    "start": "264060",
    "end": "269650"
  },
  {
    "text": "saying are important right so like we really like isolation we really like pulling apart components and minimizing",
    "start": "269650",
    "end": "276880"
  },
  {
    "text": "the amount of interactions that they can have so that you have a sort of a choke point you can look at that you can you can make sure while the code that's",
    "start": "276880",
    "end": "283720"
  },
  {
    "text": "processing you know between these interfaces has been hardened it's been reviewed etc whereas a lot of the",
    "start": "283720",
    "end": "290220"
  },
  {
    "text": "systems management types of software you know enterprise pieces that get layered on for any vendor doesn't matter",
    "start": "290220",
    "end": "296440"
  },
  {
    "text": "for any video s actually - so whether we're talking about Windows or Linux or anything else it's it's designed to to",
    "start": "296440",
    "end": "307450"
  },
  {
    "text": "create as many pipes as possible between these different components so they just mentioned that and there are definitely",
    "start": "307450",
    "end": "313090"
  },
  {
    "text": "a security ramifications to it and what it also means is that some of the vulnerabilities that that we that we",
    "start": "313090",
    "end": "321820"
  },
  {
    "text": "find that we use ourselves in testing you know being able to get a greater",
    "start": "321820",
    "end": "327340"
  },
  {
    "text": "viewpoint on a system to be able to to assess it it's been a little while since",
    "start": "327340",
    "end": "333700"
  },
  {
    "text": "I've heard the argument but there there used to be a common argument of well you know you have to have root to do that",
    "start": "333700",
    "end": "339520"
  },
  {
    "text": "right for those kind of things and one getting roots actually not that hard",
    "start": "339520",
    "end": "345460"
  },
  {
    "text": "that said but then even on top of that - there are several cases where these",
    "start": "345460",
    "end": "351730"
  },
  {
    "text": "enterprise management layers are exposing that functionality down to user",
    "start": "351730",
    "end": "357520"
  },
  {
    "text": "land and down to in down and unsafe ways so the like that the issues that just",
    "start": "357520",
    "end": "363040"
  },
  {
    "text": "fell on my lap were related to how well that's secured and who can interact with those things so the other the other",
    "start": "363040",
    "end": "369880"
  },
  {
    "text": "thing to keep in mind is that for the host you're not always running when",
    "start": "369880",
    "end": "375010"
  },
  {
    "text": "you're in hardware so now with the cloud and bare metal hosting there are times when you're gonna be running on a machine that's not yours and you're",
    "start": "375010",
    "end": "382450"
  },
  {
    "text": "gonna be giving your machine out to someone who's not you so in that case you're you're explicitly giving access",
    "start": "382450",
    "end": "387790"
  },
  {
    "text": "to those so it's another sort of twist on the only old the attack model that we",
    "start": "387790",
    "end": "394090"
  },
  {
    "text": "have in mind we're here we're giving up the host keeping in mind that we have these other gates",
    "start": "394090",
    "end": "399820"
  },
  {
    "text": "hopefully keeping keeping the hordes out yeah and you know and I know that the",
    "start": "399820",
    "end": "405100"
  },
  {
    "text": "you know windows in particular has been trying to focus on some of this level of hardening and trying to turn off some of",
    "start": "405100",
    "end": "410230"
  },
  {
    "text": "the like the interfaces that would let you do these things it's certainly at least easily right a lot of the stuff on",
    "start": "410230",
    "end": "416710"
  },
  {
    "text": "Windows it's it's configured in extremely hardened factions and would",
    "start": "416710",
    "end": "421930"
  },
  {
    "text": "often require you to have kernel level execution to be able to get the access you needed it's a lot easier to do on",
    "start": "421930",
    "end": "428560"
  },
  {
    "text": "Linux on a normal say just like a new install you go and download one and install it it's a lot easier um the the",
    "start": "428560",
    "end": "440129"
  },
  {
    "text": "other thing about hosts the the other",
    "start": "440310",
    "end": "445570"
  },
  {
    "text": "thing that's interesting with this too is that the your you end up where I guess the way we view this the way we",
    "start": "445570",
    "end": "451450"
  },
  {
    "text": "view this problems David is that as I just said like in a lot of ways we assume compromise of the host and it",
    "start": "451450",
    "end": "458200"
  },
  {
    "text": "would be our recommendation that everyone assume compromise of the host right like your security designs and the way that you configure these systems",
    "start": "458200",
    "end": "463810"
  },
  {
    "text": "should be in such a way that you assume that if it's doing anything you know",
    "start": "463810",
    "end": "469330"
  },
  {
    "text": "that all of our computers do today there are avenues to get the level of code",
    "start": "469330",
    "end": "474730"
  },
  {
    "text": "execution that you need so then be able to trigger and reach into all the stuff we're going to talk about here and so I",
    "start": "474730",
    "end": "482170"
  },
  {
    "text": "know of environments that will have multiple you know server configurations kind of depending on risk level that",
    "start": "482170",
    "end": "487240"
  },
  {
    "text": "makes a lot of sense and I'm in support of that but you have to you have to do accurately way what the sort of",
    "start": "487240",
    "end": "495430"
  },
  {
    "text": "likelihood of attack is or successful compromise of that server right and so for different servers that could be in",
    "start": "495430",
    "end": "500920"
  },
  {
    "text": "different use cases like if one like this particular server is sitting in the DMZ and it's running you know something",
    "start": "500920",
    "end": "508300"
  },
  {
    "text": "awful and so we think it it very well could get compromised so we isolate it differently than we do one on the",
    "start": "508300",
    "end": "513700"
  },
  {
    "text": "internal network for example but it's worth rethinking that and looking at",
    "start": "513700",
    "end": "520240"
  },
  {
    "text": "what are those what are those use cases that I'm under appreciating the danger",
    "start": "520240",
    "end": "525400"
  },
  {
    "text": "level right because one of the s the starting point from this whole talk is",
    "start": "525400",
    "end": "531280"
  },
  {
    "text": "under the it's from the stand point of when you when you're starting",
    "start": "531280",
    "end": "538439"
  },
  {
    "text": "or like when you're when you consider",
    "start": "538439",
    "end": "547959"
  },
  {
    "text": "what the attack surface of a host like this is if you care about these things",
    "start": "547959",
    "end": "554920"
  },
  {
    "text": "there are is a huge amount you can do to reduce the threats to reduce the vulnerability of a given host and this",
    "start": "554920",
    "end": "563079"
  },
  {
    "text": "is focusing on the pieces that are left over if you don't care about those things and you don't configure it",
    "start": "563079",
    "end": "568559"
  },
  {
    "text": "attempting to reduce attack service and attempting to lock it down then there",
    "start": "568559",
    "end": "574540"
  },
  {
    "text": "then there's like almost no barriers at all it's extremely easy to pivot through to all these different components and",
    "start": "574540",
    "end": "580029"
  },
  {
    "text": "even in the newer stuff like the you know you know for years and years people",
    "start": "580029",
    "end": "586540"
  },
  {
    "text": "beat up on Super Micro because they didn't do anything like firmware signing at all of their bmc's and things like that they started implementing that in",
    "start": "586540",
    "end": "592269"
  },
  {
    "text": "the last few years but and so like that's one example of some of that maturing but even so allowing in band",
    "start": "592269",
    "end": "600939"
  },
  {
    "text": "management with all of that that offers in any sort of a situation where an attacker can get on that host is really",
    "start": "600939",
    "end": "606459"
  },
  {
    "text": "bad so okay so switching gears a little bit right so first thing host also this",
    "start": "606459",
    "end": "613300"
  },
  {
    "start": "610000",
    "end": "647000"
  },
  {
    "text": "is where you know for most you know most threat models we talked about that where most of our attack chain is kind of",
    "start": "613300",
    "end": "618879"
  },
  {
    "text": "start from compromised there what that also means is that for a lot of us what we're talking about is the TAC surface that's exposed to the hosts and so",
    "start": "618879",
    "end": "625740"
  },
  {
    "text": "that's primarily where we focused so we usually start from and then as we begin to compromise other components then you",
    "start": "625740",
    "end": "631300"
  },
  {
    "text": "get different viewpoints into the system and then you can begin to explore the vulnerability of those other sides and",
    "start": "631300",
    "end": "636370"
  },
  {
    "text": "so so that's said we're starting from there and then we'll work through all these different components and sort of the pros and cons of them but then I",
    "start": "636370",
    "end": "643449"
  },
  {
    "text": "guess wherever we're starting from a different place we'll call it out okay so system management mode really like",
    "start": "643449",
    "end": "651429"
  },
  {
    "start": "647000",
    "end": "1021000"
  },
  {
    "text": "there's either the entire talks just about well about every one of these components so we're obviously not going to that level of depth for what matters",
    "start": "651429",
    "end": "658149"
  },
  {
    "text": "here all we're really saying is that it's another place that attacks can be",
    "start": "658149",
    "end": "663279"
  },
  {
    "text": "launched from it is becoming overtime is we more and more of the centralized",
    "start": "663279",
    "end": "670170"
  },
  {
    "text": "location for certain types of Secrets so it is not a secure Enclave like it's not",
    "start": "670170",
    "end": "675250"
  },
  {
    "text": "a TPM it's not you know there's hardware backs secrets a safe place to keep your",
    "start": "675250",
    "end": "681070"
  },
  {
    "text": "secrets and so there's implications to using it that way but it is it is still an improvement so what's happening is",
    "start": "681070",
    "end": "687610"
  },
  {
    "text": "that over time we're like in years past maybe everything was accessible now",
    "start": "687610",
    "end": "692950"
  },
  {
    "text": "we're finding different ways to turn those off so perhaps the attack surface that used to be there all the time",
    "start": "692950",
    "end": "698350"
  },
  {
    "text": "now that attack surface is only there during boot and only when it boots into a certain mode so like you know if",
    "start": "698350",
    "end": "703540"
  },
  {
    "text": "you're if you've updated your your UEFI on your laptop or anything in the last while like all the recent systems the",
    "start": "703540",
    "end": "709780"
  },
  {
    "text": "way that works is differently than it used to and it's observable to you as the user like it it writes to it writes",
    "start": "709780",
    "end": "715870"
  },
  {
    "text": "to a location and then it sets some flags and then it triggers a reboot and then when it's coming back up right it",
    "start": "715870",
    "end": "721390"
  },
  {
    "text": "takes a different path and then it can actually unlock the flash that it needs to unlock and it can do these updates well so that's that sort of change",
    "start": "721390",
    "end": "728710"
  },
  {
    "text": "that's one of the things that's changed we've had several others as well like where there were these different buses that were accessible that are now not",
    "start": "728710",
    "end": "734920"
  },
  {
    "text": "accessible at all except for these time windows or in some cases and what are",
    "start": "734920",
    "end": "740020"
  },
  {
    "text": "our two sort of case studies that we'll go to into detail here in a bit what they're focusing on is these areas where",
    "start": "740020",
    "end": "747340"
  },
  {
    "text": "it was a tack surface that used to be open now we've closed it off and we've tried to figure out how can we make it",
    "start": "747340",
    "end": "752680"
  },
  {
    "text": "so that SMM can still talk to it but nobody else can and so there's a few",
    "start": "752680",
    "end": "757810"
  },
  {
    "text": "places where that really matters like Intel chipset has some attack surface there that is is shut down after boot",
    "start": "757810",
    "end": "766150"
  },
  {
    "text": "except they still need sm them to be able to make certain types of queries against it in band management is another",
    "start": "766150",
    "end": "772330"
  },
  {
    "text": "common one it's a that's our other example that we'll give here to where it was an interface that used to be on all",
    "start": "772330",
    "end": "779920"
  },
  {
    "text": "the time if you want to turn it off you can now except maybe you can't always turn it off and so this is that that corner case and like how they",
    "start": "779920",
    "end": "785470"
  },
  {
    "text": "implemented that solution and then the then other other other use cases right",
    "start": "785470",
    "end": "792040"
  },
  {
    "text": "like um you know you you talk to anyone who's trying to design one of these or like a you know large cloud provider",
    "start": "792040",
    "end": "798370"
  },
  {
    "text": "that's trying to trying to architect the server that would be resilient against these kind of",
    "start": "798370",
    "end": "803530"
  },
  {
    "text": "problems you can't just shut everything off because there's a there are so many",
    "start": "803530",
    "end": "809200"
  },
  {
    "text": "components inside a server now so many flashable components that may need update something could be broken so like",
    "start": "809200",
    "end": "815170"
  },
  {
    "text": "you can't I mean you know there would be physical ways you could like never allow something to be updated again and make",
    "start": "815170",
    "end": "820480"
  },
  {
    "text": "it truly read-only but you can't actually do that in the real world right so you have to have methods to use some",
    "start": "820480",
    "end": "826420"
  },
  {
    "text": "of these privilege busses and privilege interfaces but we've got to figure out how to do it safely and so there have",
    "start": "826420",
    "end": "833050"
  },
  {
    "text": "been some interesting way like neat ways that I've seen that done and so that's",
    "start": "833050",
    "end": "838780"
  },
  {
    "text": "part of what we're talking through but it's a hard problem to solve because some of those things have to be enabled and if there if there if there is a",
    "start": "838780",
    "end": "846990"
  },
  {
    "text": "pathway that can be used then a lot of like what our job is is trying to figure out how to you know crowbar that back",
    "start": "846990",
    "end": "852490"
  },
  {
    "text": "open I said earlier a Simone can be attacked from a number of places like the most common ones are hosts that the",
    "start": "852490",
    "end": "859090"
  },
  {
    "text": "SMI interface is still problematic it's there been a lot of talks about that and they're all better than this one at",
    "start": "859090",
    "end": "866260"
  },
  {
    "text": "covering it go read those there's a lot of interaction between the BMC and SMM so",
    "start": "866260",
    "end": "872290"
  },
  {
    "text": "SMM is often sending requests out to the BMC and then processing those responses",
    "start": "872290",
    "end": "877630"
  },
  {
    "text": "it also is reading data and things out of you know like out of storage in locations either you know efi variables",
    "start": "877630",
    "end": "884380"
  },
  {
    "text": "or like sort of got a stored in flash other things that the BMC can also",
    "start": "884380",
    "end": "890770"
  },
  {
    "text": "influence so there are there are there are paths from once you get root inside",
    "start": "890770",
    "end": "896110"
  },
  {
    "text": "the BMC being able to poison responses that are coming back in and in gain code execution at a higher level generally",
    "start": "896110",
    "end": "901570"
  },
  {
    "text": "you don't need to do that here like in that the the SMI interface is is large enough usually that you can find the",
    "start": "901570",
    "end": "910330"
  },
  {
    "text": "vulnerabilities that you need on that side but and then peripherals are really",
    "start": "910330",
    "end": "915430"
  },
  {
    "text": "interesting so one light as Deanna and I have processed this whole domain and trying",
    "start": "915430",
    "end": "922420"
  },
  {
    "text": "to been trying to figure out how do we take all of this giant amount of work",
    "start": "922420",
    "end": "927670"
  },
  {
    "text": "that's been done and the that we understand about the sort of the modern",
    "start": "927670",
    "end": "934089"
  },
  {
    "text": "you know vectors for these systems how do we boil that down to what really matters and this is one of the areas",
    "start": "934089",
    "end": "941109"
  },
  {
    "text": "that I think is the most interest it's the most interesting to me right now that these other components that are",
    "start": "941109",
    "end": "948779"
  },
  {
    "text": "not always present so we're not talking about like you know Intel chipset stuff or the BMC or these other components",
    "start": "948779",
    "end": "954819"
  },
  {
    "text": "that are always on the motherboard these are components that are used in either",
    "start": "954819",
    "end": "960160"
  },
  {
    "text": "specific use cases like a particular you know particular motherboard has this",
    "start": "960160",
    "end": "965169"
  },
  {
    "text": "this feature to it or whatever and then that's exposed through some bus and but its own processor has all of its own",
    "start": "965169",
    "end": "971649"
  },
  {
    "text": "resources or we're talking about you know components that are plugged into a PCIe slot right and both sides of that",
    "start": "971649",
    "end": "980559"
  },
  {
    "text": "are really interesting the the attack vectors into those devices is pretty",
    "start": "980559",
    "end": "986079"
  },
  {
    "text": "fascinating like oftentimes it's really simple and it's not all that that like fancy I mean it's you know you call the",
    "start": "986079",
    "end": "991839"
  },
  {
    "text": "firmware update function and then you update the farmer on the on the peripheral but it's not always sometimes",
    "start": "991839",
    "end": "997119"
  },
  {
    "text": "it can be it can be getting very complex on that side to of reaching into the device but then once you're on the",
    "start": "997119",
    "end": "1002759"
  },
  {
    "text": "device the attack surf is exposed to you as you're coming back up from the peripheral is also fascinating and",
    "start": "1002759",
    "end": "1007799"
  },
  {
    "text": "there's like a lot of different examples or different different ways that compromised SMM there are common sorry",
    "start": "1007799",
    "end": "1013350"
  },
  {
    "text": "compromised peripheral can get back into SMM and in the host itself all right so",
    "start": "1013350",
    "end": "1023669"
  },
  {
    "start": "1021000",
    "end": "1154000"
  },
  {
    "text": "BMC right again lots of other talks on this so I'll try to gloss over it quickly if you're not familiar with what",
    "start": "1023669",
    "end": "1031230"
  },
  {
    "text": "it is it's an entire Linux system that's sitting there on your motherboard it's asynchronous in that it's like it has",
    "start": "1031230",
    "end": "1037829"
  },
  {
    "text": "its own state it can be turned on or off while the process well the host can be turned on and off it allows for it's",
    "start": "1037829",
    "end": "1045089"
  },
  {
    "text": "useful for persistence right I mean it's they have all of its own resources it has all that there's been a lot of talk talking about that different methods for",
    "start": "1045089",
    "end": "1051210"
  },
  {
    "text": "doing so and then useful for re attacking the host right getting back in it has a lot of attack surface to the",
    "start": "1051210",
    "end": "1058019"
  },
  {
    "text": "host it also has a lot of attack surface to the management network this is one that has been talked about and mentioned",
    "start": "1058019",
    "end": "1063899"
  },
  {
    "text": "several times I don't feel like the the public exploitation or like the red",
    "start": "1063899",
    "end": "1072140"
  },
  {
    "text": "teaming world doesn't really use it we probably should we probably should use",
    "start": "1072140",
    "end": "1078410"
  },
  {
    "text": "it more like the pivot from the host of the B and C is not hard and once you're on the beam see in in highly restrictive",
    "start": "1078410",
    "end": "1086120"
  },
  {
    "text": "environments I mean to me that that's a question for you like to think about are you filtering requests coming out of the",
    "start": "1086120",
    "end": "1092000"
  },
  {
    "text": "BMC and like working those requests go assume that if someone can compromise this BMC assume they can compromise all",
    "start": "1092000",
    "end": "1098180"
  },
  {
    "text": "the BMC's if they can talk to it so like we can do a lot at the network layer to",
    "start": "1098180",
    "end": "1103910"
  },
  {
    "text": "restrict the ability to you know come out of one BMC and then take over all the other ones but you should assume",
    "start": "1103910",
    "end": "1110330"
  },
  {
    "text": "that like if you're sitting on the BMC you know then that means you know all the secrets like you know the whatever the passwords are for ipmi and you know",
    "start": "1110330",
    "end": "1116150"
  },
  {
    "text": "you obviously have vulnerabilities in the BMC you know how to trigger them so like if there's not Network layer",
    "start": "1116150",
    "end": "1121220"
  },
  {
    "text": "controls on the traffic coming out of that then you can you can pivot and laterally move across very large segments like I know you know in in",
    "start": "1121220",
    "end": "1128660"
  },
  {
    "text": "places that do it like you either end up where nobody works to restrict it at all and so they're just on the network just",
    "start": "1128660",
    "end": "1134990"
  },
  {
    "text": "like any other node and okay it's not really that special but in a highly restrictive environment you'll have management networks that are all plugged",
    "start": "1134990",
    "end": "1142010"
  },
  {
    "text": "in to this and they're isolated and you can't get on those networks normally but",
    "start": "1142010",
    "end": "1147920"
  },
  {
    "text": "if you do get on those networks you can get to everything like all of the all of the barriers all go away",
    "start": "1147920",
    "end": "1154360"
  },
  {
    "start": "1154000",
    "end": "1396000"
  },
  {
    "text": "all right so talking about peripherals again a little bit more specifically right this is a broad category for what",
    "start": "1154360",
    "end": "1162500"
  },
  {
    "text": "we're talking about here so this can this does include like anything that that is off you know it's off its off",
    "start": "1162500",
    "end": "1170960"
  },
  {
    "text": "host it's not it's not any other components we're talking about we're kind of like lumping them all together here are what we'll talk about es IO and",
    "start": "1170960",
    "end": "1178090"
  },
  {
    "text": "as a use case here in a minute we kind of categorize that as a peripheral",
    "start": "1178090",
    "end": "1183310"
  },
  {
    "text": "obviously and then anything that plugs in plugs in anywhere if it has a cord that plugs in or it's a card that plugs",
    "start": "1183310",
    "end": "1188390"
  },
  {
    "text": "in it counts the one unique thing about their attack surface is that they have",
    "start": "1188390",
    "end": "1195830"
  },
  {
    "text": "they have varying a you know attack surface like different components will have why",
    "start": "1195830",
    "end": "1201020"
  },
  {
    "text": "we different attack surface so you've got you know the I saw the right up on the Qualcomm chain of bugs like just",
    "start": "1201020",
    "end": "1209210"
  },
  {
    "text": "this week where you know the it was the there's another talk last year it was the first time I'd ever seen someone do",
    "start": "1209210",
    "end": "1215900"
  },
  {
    "text": "it I think but coming in and popping the you know the the Wi-Fi sock itself so like a little tiny ARM chip inside the",
    "start": "1215900",
    "end": "1222920"
  },
  {
    "text": "Wi-Fi card and then being able to pivot from that back into the host that's the same attack surface it kind of work that",
    "start": "1222920",
    "end": "1228740"
  },
  {
    "text": "we're describing here it's just a little bit of a different vector and so like there was another one someone did that to to chain all the way through for",
    "start": "1228740",
    "end": "1234830"
  },
  {
    "text": "Qualcomm just this week and it's getting harder especially on those like those those types of devices where they now",
    "start": "1234830",
    "end": "1242840"
  },
  {
    "text": "are having you know like I think it's a it had a SLR it has some containerization of some sort like it some some isolation so requires multiple",
    "start": "1242840",
    "end": "1250240"
  },
  {
    "text": "chains to get back through but you want to get back you want to do that for all",
    "start": "1250240",
    "end": "1255740"
  },
  {
    "text": "the same reasons that they do like in you would want to do that on a server all the same reasons that they did that on the Qualcomm chip oh and I guess yes",
    "start": "1255740",
    "end": "1264440"
  },
  {
    "text": "so the other one to that to you is we didn't really think about what the",
    "start": "1264440",
    "end": "1269450"
  },
  {
    "text": "attack surface is for for vm's either so think about like your you know your your",
    "start": "1269450",
    "end": "1274700"
  },
  {
    "text": "VMware farms that you've got for like there's a bunch of different use cases where you would want to expose some of",
    "start": "1274700",
    "end": "1281480"
  },
  {
    "text": "this either directly and on purpose or it's exposed indirectly but no one's really looked at it yet so the attack",
    "start": "1281480",
    "end": "1291350"
  },
  {
    "text": "surface of peripherals I think is still is still not well understood or well well researched I'm particularly",
    "start": "1291350",
    "end": "1297650"
  },
  {
    "text": "interested in in some of the the translation that occurs like the there are you know across all the different VN",
    "start": "1297650",
    "end": "1304940"
  },
  {
    "text": "solutions all of them in some fashion are either you're either directly plugging one of these things in like",
    "start": "1304940",
    "end": "1310430"
  },
  {
    "text": "you're here you're mapping it in or it's translating requests for you in some fashion and I know that like I mean I",
    "start": "1310430",
    "end": "1316940"
  },
  {
    "text": "know of multiple scenarios where normal transactions are also what's used for",
    "start": "1316940",
    "end": "1323900"
  },
  {
    "text": "administrative functionality so I think about a drive and how do you update the farmer on the drive well in some cases",
    "start": "1323900",
    "end": "1329180"
  },
  {
    "text": "you use different scuzzy commands well like how tight are",
    "start": "1329180",
    "end": "1334550"
  },
  {
    "text": "all of the proxies of those scuzzy commands actually in real life like our is it is it really terminating their",
    "start": "1334550",
    "end": "1340550"
  },
  {
    "text": "pressing and making a new one is it abstracting it somehow or is it a straight pipe and in what situations and",
    "start": "1340550",
    "end": "1345800"
  },
  {
    "text": "it can get really complex really fast so that's kind of why we don't really know a lot about some of that attack surface but it's it's a it's certainly",
    "start": "1345800",
    "end": "1352880"
  },
  {
    "text": "worthwhile to to look at and as we move forward it's interesting to me because",
    "start": "1352880",
    "end": "1359420"
  },
  {
    "text": "it's one of the things that will still be there right like you're gonna have performance reasons why you're gonna want to slave hardware directly into",
    "start": "1359420",
    "end": "1365960"
  },
  {
    "text": "your guests in some cases and then even from that like you're going to constantly have other peripherals that you need to to allow some level of",
    "start": "1365960",
    "end": "1372650"
  },
  {
    "text": "access to that's hardware on the outside so we're not finding them with you know",
    "start": "1372650",
    "end": "1378860"
  },
  {
    "text": "our standard sort of fuzzing frameworks on these things we're looking at today where we're you know we we fuzz emulated",
    "start": "1378860",
    "end": "1384710"
  },
  {
    "text": "devices a lot but I don't know that we're good at being able to predict how",
    "start": "1384710",
    "end": "1391370"
  },
  {
    "text": "something will be d capsulated all the way down in the hardware on the other end alright",
    "start": "1391370",
    "end": "1397220"
  },
  {
    "start": "1396000",
    "end": "1506000"
  },
  {
    "text": "and then lastly a category of just the this is the catch-all for all all things chipset right so everything like all the",
    "start": "1397220",
    "end": "1403640"
  },
  {
    "text": "Intel stuff and AMD stuff we're talking the PCH SPS all of those pieces it's for",
    "start": "1403640",
    "end": "1413360"
  },
  {
    "text": "the server side is a little bit different from the normal consumer line so like it I'll say it's behind so the",
    "start": "1413360",
    "end": "1422330"
  },
  {
    "text": "the newest features will come out on the user side first and then at some point",
    "start": "1422330",
    "end": "1428510"
  },
  {
    "text": "they will move over on to SPS so like we're talking about like c SME versus SPS and some of those some of those types of differences but the like the",
    "start": "1428510",
    "end": "1435020"
  },
  {
    "text": "architecture for SPS one of these days that's gonna change I don't think it has yet I haven't I haven't looked at it in",
    "start": "1435020",
    "end": "1440780"
  },
  {
    "text": "a little bit someone from Intel probably is in here will tell me but that attack",
    "start": "1440780",
    "end": "1448010"
  },
  {
    "text": "surface is there there have been several great talks about it it's I'll say it's",
    "start": "1448010",
    "end": "1454820"
  },
  {
    "text": "it is due to and due to the changes that have been happening in the last couple years to it is time consuming for re and",
    "start": "1454820",
    "end": "1462620"
  },
  {
    "text": "exploitation we've done it a couple times we've looked at it we've we've written like we've POC vulnerabilities that we",
    "start": "1462620",
    "end": "1468930"
  },
  {
    "text": "found that to have various primitives that would that are useful in these spaces but if it's not well understood although that is changing I know there",
    "start": "1468930",
    "end": "1474870"
  },
  {
    "text": "was a there was a talk on CSN a here yesterday that did covered a lot of the",
    "start": "1474870",
    "end": "1480210"
  },
  {
    "text": "the architecture that they're using now which is great that's wonderful like using modern you know compiler defenses",
    "start": "1480210",
    "end": "1486420"
  },
  {
    "text": "and all those kind of things that's what we want to see and it'll be fun to see that sort of like standardized and you",
    "start": "1486420",
    "end": "1492390"
  },
  {
    "text": "know get pushed into the server lines as well they don't have a tack surface right across those things we're not",
    "start": "1492390",
    "end": "1497850"
  },
  {
    "text": "gonna really talk about chipset very much in here in that it it is an area of continued research in motion right now",
    "start": "1497850",
    "end": "1504390"
  },
  {
    "text": "so right you want to take the rawness",
    "start": "1504390",
    "end": "1509400"
  },
  {
    "text": "part so now we've kind given an overview",
    "start": "1509400",
    "end": "1514830"
  },
  {
    "text": "of our whole map we understand the components in the system the next step is sort of drill down a little further",
    "start": "1514830",
    "end": "1520890"
  },
  {
    "text": "but before we do that we should talk a little bit about quickly how we think about the trend right now and and we",
    "start": "1520890",
    "end": "1528660"
  },
  {
    "text": "think things are going and where it will be useful to look for more bugs and for sort of twisted attack surface we've",
    "start": "1528660",
    "end": "1539370"
  },
  {
    "start": "1536000",
    "end": "1639000"
  },
  {
    "text": "said it a few times maybe five or six modern servers are they're complex there's a bunch of components they're",
    "start": "1539370",
    "end": "1544680"
  },
  {
    "text": "connected together much more like a network than than anything else and there you're only now starting to be",
    "start": "1544680",
    "end": "1551640"
  },
  {
    "text": "treated as networks with complex routing and filtering and as we said we talked a",
    "start": "1551640",
    "end": "1559530"
  },
  {
    "text": "little bit about the host cloud and virtualization changes these things in",
    "start": "1559530",
    "end": "1564540"
  },
  {
    "text": "ways that we the designers of them probably didn't anticipate and because of that our attack service has changed",
    "start": "1564540",
    "end": "1571110"
  },
  {
    "text": "and we're having the back port like I said these filters these ways of",
    "start": "1571110",
    "end": "1576200"
  },
  {
    "text": "ensuring that components are correctly isolated these are things that we never anticipated or you know we still have in",
    "start": "1576200",
    "end": "1583230"
  },
  {
    "text": "the server's a lot of these protocols that are date back to you know is a buses and things like that so clearly",
    "start": "1583230",
    "end": "1590640"
  },
  {
    "text": "we're not we're not moving quickly here to to come up with the latest designs to",
    "start": "1590640",
    "end": "1597060"
  },
  {
    "text": "ensure that we can do this filtering instead what we're trying to do is ensure that we can find fixes in the",
    "start": "1597060",
    "end": "1603180"
  },
  {
    "text": "meantime before we can the other hardware can catch up to the way we think about threats these days the",
    "start": "1603180",
    "end": "1610290"
  },
  {
    "text": "alternative course is to defeat your things and we're seeing that so we've seen customers remove entire physical",
    "start": "1610290",
    "end": "1617970"
  },
  {
    "text": "connections that are usually not there they're usually there and we've seen people very aggressively D featuring",
    "start": "1617970",
    "end": "1626580"
  },
  {
    "text": "UEFI firmware to ensure that things like software SM eyes are missing or no",
    "start": "1626580",
    "end": "1632610"
  },
  {
    "text": "longer yo they are not so prevalent much less attack service and sort of as I",
    "start": "1632610",
    "end": "1642570"
  },
  {
    "start": "1639000",
    "end": "1727000"
  },
  {
    "text": "mentioned before the what we really want to do is try and find a way to secure",
    "start": "1642570",
    "end": "1649140"
  },
  {
    "text": "the components using the hardware that we have using the system's up you have to ensure that that we have some measure",
    "start": "1649140",
    "end": "1655230"
  },
  {
    "text": "of security until we get to the point where we can you know design our perfect system and one of the things we see",
    "start": "1655230",
    "end": "1663000"
  },
  {
    "text": "going forward is this using the SMM as a sort of like a strong clave as Nathan",
    "start": "1663000",
    "end": "1670710"
  },
  {
    "text": "mentioned earlier it's not it's not a TPM it's not trust in it it has a lot of",
    "start": "1670710",
    "end": "1677280"
  },
  {
    "text": "the problems that they didn't Majan and because it wasn't treated like that although there are some chipset features",
    "start": "1677280",
    "end": "1683250"
  },
  {
    "text": "that allow you to for example ensure that the flash can only be written",
    "start": "1683250",
    "end": "1688590"
  },
  {
    "text": "during SMM and certain pins can only be used during SMM it's it's becoming more",
    "start": "1688590",
    "end": "1695790"
  },
  {
    "text": "useful in terms of software protections like I said the back porting these security features to the existing system",
    "start": "1695790",
    "end": "1702620"
  },
  {
    "text": "and we're seeing a lot of that so the upcoming that what we'll talk about next",
    "start": "1702620",
    "end": "1708090"
  },
  {
    "text": "after a short sort of detour will be the deep dive into some of these components",
    "start": "1708090",
    "end": "1713520"
  },
  {
    "text": "that have ported a filter or control",
    "start": "1713520",
    "end": "1718980"
  },
  {
    "text": "into into SMM into the UEFI such that it controls the traffic between the host and some of these other components as I",
    "start": "1718980",
    "end": "1731460"
  },
  {
    "start": "1727000",
    "end": "1837000"
  },
  {
    "text": "said the the trust place in SMM has changed over time so Reed as you if you wonder update from where",
    "start": "1731460",
    "end": "1737560"
  },
  {
    "text": "you would be able to do it without rebooting right you would just ask s mmm through a net software SMI 2 to enable",
    "start": "1737560",
    "end": "1745240"
  },
  {
    "text": "the the rights to the flash and then flash you know your new you new firmware as SMM became less of a boundary i we",
    "start": "1745240",
    "end": "1755230"
  },
  {
    "text": "ended up using more of these features that intel provides such as the the protection registers and things like",
    "start": "1755230",
    "end": "1760600"
  },
  {
    "text": "that that will not allow you to these are you know set once during boot and then you have to reboot to clear them",
    "start": "1760600",
    "end": "1766330"
  },
  {
    "text": "again so as you come up you set these these protection registers and now flash can no longer be turned back on to be",
    "start": "1766330",
    "end": "1773380"
  },
  {
    "text": "writable so to do the firmware update you have to use you have to reboot and do this early in boo so you're not doing",
    "start": "1773380",
    "end": "1780130"
  },
  {
    "text": "it at the time that the us actually has a tak surface to the SMM maybe hopefully",
    "start": "1780130",
    "end": "1788320"
  },
  {
    "text": "we'll see a little bit of this the tide turning some of the some of the ufi defenses now",
    "start": "1788320",
    "end": "1793900"
  },
  {
    "text": "are actually ending up in firmware so things that have been around for two years or so in as example code as a the",
    "start": "1793900",
    "end": "1802660"
  },
  {
    "text": "provide code from vendors are making even the chrome are things like actual page tables and sfm protections provided",
    "start": "1802660",
    "end": "1810480"
  },
  {
    "text": "to ring 0 outside of us mmm from s mmm so ensuring that assam m can't write two pages that are that you wouldn't want it",
    "start": "1810480",
    "end": "1818140"
  },
  {
    "text": "to again it kind of all follow this trend of ensuring that all these",
    "start": "1818140",
    "end": "1823150"
  },
  {
    "text": "components have well-defined boundaries and that it is more of a network than a sort of cooperating system nowadays and",
    "start": "1823150",
    "end": "1829270"
  },
  {
    "text": "you need to ensure that these components have their own boundaries and their own security controls as we said again the",
    "start": "1829270",
    "end": "1842440"
  },
  {
    "text": "very beginning we're trying to hit this from the most we want to think as an",
    "start": "1842440",
    "end": "1847900"
  },
  {
    "text": "attacker starting at the hosts we gave all the reasons why we think we can get there and sometimes we're even provided that access from the the person that is",
    "start": "1847900",
    "end": "1854560"
  },
  {
    "text": "defending against us and coming at this",
    "start": "1854560",
    "end": "1860070"
  },
  {
    "text": "without this knowledge two years ago it was hard to find all of these things that it's a complex system there's tons",
    "start": "1860070",
    "end": "1867310"
  },
  {
    "text": "of acronyms we've tried to define as many as we could without without getting crazy but",
    "start": "1867310",
    "end": "1873020"
  },
  {
    "text": "I'm sure that you know anyone else starting here looking for service and looking for vulnerabilities assessing",
    "start": "1873020",
    "end": "1878210"
  },
  {
    "text": "the security of a motherboard a modern server will have to go through the same trials that we have and I think",
    "start": "1878210",
    "end": "1884750"
  },
  {
    "text": "hopefully I'll provide you a quick laundry list the things that you can go Google later that might help you they",
    "start": "1884750",
    "end": "1893600"
  },
  {
    "start": "1892000",
    "end": "2322000"
  },
  {
    "text": "said things we wish we knew two years ago first you know you hear all these",
    "start": "1893600",
    "end": "1898670"
  },
  {
    "text": "things and if you've been doing software development off or security long enough you may have touched upon them but the",
    "start": "1898670",
    "end": "1907490"
  },
  {
    "text": "main ways in which you're going to talk to these devices these other components from the hosts are going to be memory mapped i/o port i/o or through through",
    "start": "1907490",
    "end": "1918800"
  },
  {
    "text": "it controller through the ice party or through LPC which is also going to be this port i/o so these are the main",
    "start": "1918800",
    "end": "1926150"
  },
  {
    "text": "interfaces that we need to monitor for if we want to reverse engineer any of the systems that that we're trying to",
    "start": "1926150",
    "end": "1932930"
  },
  {
    "text": "assess so dynamic cooling chip sack is",
    "start": "1932930",
    "end": "1938660"
  },
  {
    "text": "sort of the catch-all it has it provides you with the ability to it first of all",
    "start": "1938660",
    "end": "1945890"
  },
  {
    "text": "it has a bunch of modules that will do these dynamic tests for you so you can run its suite of tests against its at",
    "start": "1945890",
    "end": "1951470"
  },
  {
    "text": "various levels of update depending on how how new of a set of you know CPU or",
    "start": "1951470",
    "end": "1956930"
  },
  {
    "text": "chipset that you're using PCH that you're using but it is a great base and it could up gets updated fairly quickly",
    "start": "1956930",
    "end": "1962870"
  },
  {
    "text": "so that that would be my first Google as far as enumeration goes getting a lay of",
    "start": "1962870",
    "end": "1969170"
  },
  {
    "text": "the land from PCI bus would be really useful and it'll tell you what components you can talk to you there which which buses you're going to be",
    "start": "1969170",
    "end": "1976040"
  },
  {
    "text": "able to speak to you from the host and how you're gonna be able to speak to them DM ID code is gonna parse the SM",
    "start": "1976040",
    "end": "1983570"
  },
  {
    "text": "BIOS that ACPI stuff that is provided from bias to the operating system to be able to configure this and to be able to",
    "start": "1983570",
    "end": "1989540"
  },
  {
    "text": "know what peripherals are available for you to test you're not always going to have an accurate view of this and this",
    "start": "1989540",
    "end": "1996680"
  },
  {
    "text": "is also not ground truth DM ID code is only what has been provided to you as an attacker ICRC probe is another",
    "start": "1996680",
    "end": "2006850"
  },
  {
    "text": "tool that will allow you to sort of scan in I squared C bus for anything that'll",
    "start": "2006850",
    "end": "2012399"
  },
  {
    "text": "respond again it's not perfect and it's it's using heuristics to try and do this but it may help provide you some some",
    "start": "2012399",
    "end": "2019809"
  },
  {
    "text": "sort of ground truth there's some some things to follow up one the last piece",
    "start": "2019809",
    "end": "2027850"
  },
  {
    "text": "is the one that I think we found most useful is creating tools that allow you",
    "start": "2027850",
    "end": "2033700"
  },
  {
    "text": "to inspect the traffic that goes along these these interfaces the the first set",
    "start": "2033700",
    "end": "2040090"
  },
  {
    "text": "of tools like straight debugging of things like firmware update tools and",
    "start": "2040090",
    "end": "2046029"
  },
  {
    "text": "then dynamic binary instrumentation tools like Intel pin and Val grind what",
    "start": "2046029",
    "end": "2051429"
  },
  {
    "text": "those will provide you and the types of tools that we've written to use those are tracing mapping of mm IO for these",
    "start": "2051429",
    "end": "2059108"
  },
  {
    "text": "various PCI devices if you have one device that you're targeting you can create a tool that will chase all open",
    "start": "2059109",
    "end": "2067450"
  },
  {
    "text": "system calls looking for an opening of dev mem because oftentimes these firmer update tools are trying to run without",
    "start": "2067450",
    "end": "2073720"
  },
  {
    "text": "any use of the driver and so they'll map dev mem in they'll map the the bar",
    "start": "2073720",
    "end": "2079780"
  },
  {
    "text": "register from PCI and then they'll do straight mm IO register access to do to",
    "start": "2079780",
    "end": "2085210"
  },
  {
    "text": "poke in exactly what they need for their firmware update and if you can trace those you can get a great sort of map of",
    "start": "2085210",
    "end": "2094470"
  },
  {
    "text": "what they're trying to do it's very similar to how you would reverse",
    "start": "2094470",
    "end": "2100480"
  },
  {
    "text": "engineering and network protocol so you would take Wireshark you run Wireshark or TCP dump you'd fit a little bit and",
    "start": "2100480",
    "end": "2107680"
  },
  {
    "text": "then you go look at the track this is exactly the same approach for reverse",
    "start": "2107680",
    "end": "2113589"
  },
  {
    "text": "engineering things like drivers that are doing these I mentioned like the user space flash updated firmware update",
    "start": "2113589",
    "end": "2119200"
  },
  {
    "text": "tools sometimes you'll want to look at the behavior that you're not aware of you don't understand in in the kernel",
    "start": "2119200",
    "end": "2125740"
  },
  {
    "text": "and to do that we've used a tool called fly and they we were taught about this",
    "start": "2125740",
    "end": "2131260"
  },
  {
    "text": "cool tool called mm IO trace which is does exactly what I described but for the colonel for colonel model versus",
    "start": "2131260",
    "end": "2136630"
  },
  {
    "text": "userspace the last thing is this sub poke tool which is a it allows you to",
    "start": "2136630",
    "end": "2142120"
  },
  {
    "text": "build a shared object that can be injected prior to the user space tool",
    "start": "2142120",
    "end": "2147490"
  },
  {
    "text": "running and do exactly what I described for like the the DB I for Intel pan and Val grind but it's really quick it's",
    "start": "2147490",
    "end": "2154030"
  },
  {
    "text": "really nice you should check it out static tolling blow through this pretty quick so we're running out of time here",
    "start": "2154030",
    "end": "2161700"
  },
  {
    "text": "Ida of course to look at the things that",
    "start": "2161700",
    "end": "2166770"
  },
  {
    "text": "any I mean anything that's running on the system we use it for EFI ufi modules",
    "start": "2166920",
    "end": "2172420"
  },
  {
    "text": "we use it for the tools that are running in user space for doing firmer flash",
    "start": "2172420",
    "end": "2178360"
  },
  {
    "text": "updates from our updates and we use it for reverse engineering firmware if we can get it so some of these components",
    "start": "2178360",
    "end": "2183910"
  },
  {
    "text": "will have firmware running on there they're micro micro processors and we can use Ida to reverse engineer this",
    "start": "2183910",
    "end": "2189100"
  },
  {
    "text": "there's a number of plugins that allow you to provide you the ability to mark",
    "start": "2189100",
    "end": "2194530"
  },
  {
    "text": "it up with efi thinks efi information prior looking at it because it's if I requires a lot of data file I think the",
    "start": "2194530",
    "end": "2201040"
  },
  {
    "text": "dynamic we looked up we wrote a bunch of tools in binary ninja that do some of",
    "start": "2201040",
    "end": "2206830"
  },
  {
    "text": "the same things and then you fi tool is a great tool for extracting all of the if I'm you have five modules from a",
    "start": "2206830",
    "end": "2213100"
  },
  {
    "text": "firmware blob we use khatai struts to parse some of these because oftentimes",
    "start": "2213100",
    "end": "2218950"
  },
  {
    "text": "we will have firmware that that is not in like al for something that we can load so sometimes we'll need to either",
    "start": "2218950",
    "end": "2225790"
  },
  {
    "text": "pull the firmware that gets that is embedded in something like a flash update tool from where update tool to pull it out to then put in these other",
    "start": "2225790",
    "end": "2231910"
  },
  {
    "text": "tools and of course grab some general tools general tips as I said oftentimes",
    "start": "2231910",
    "end": "2239290"
  },
  {
    "text": "we're looking at firmware updates and the reason for that is that these firmware update tools are often gonna do",
    "start": "2239290",
    "end": "2246430"
  },
  {
    "text": "things beyond just farmer update they're going to be used in the field to do things like pull debug information too",
    "start": "2246430",
    "end": "2252630"
  },
  {
    "text": "they may embed other tools that that you want to understand then I'll explain",
    "start": "2252630",
    "end": "2259000"
  },
  {
    "text": "more about the the peripheral or the system they're using and then of course Intel PCH data sheets are publicly",
    "start": "2259000",
    "end": "2266230"
  },
  {
    "text": "available unlike some other data sheets and a lot of information we talked about the",
    "start": "2266230",
    "end": "2272920"
  },
  {
    "text": "forum update tools you a file model similar oftentimes there'll be things in SMM that are trying to talk to the",
    "start": "2272920",
    "end": "2281070"
  },
  {
    "text": "component that you're interested in so they're important to look at and I think",
    "start": "2281070",
    "end": "2286150"
  },
  {
    "text": "the last one is going to be if you're looking towards to pivot from the host",
    "start": "2286150",
    "end": "2293140"
  },
  {
    "text": "to SMM we tend to look for things like sm ram read first or a BMC root first",
    "start": "2293140",
    "end": "2299710"
  },
  {
    "text": "the reasoning is that both will provide a lot of information to us about how the system how the firmware in SMM is",
    "start": "2299710",
    "end": "2308350"
  },
  {
    "text": "running if we're curious about the configuration and we can't we can't understand it from the existing image",
    "start": "2308350",
    "end": "2316320"
  },
  {
    "text": "BMC root will ask to do things like turn on logging other very useful things okay",
    "start": "2316320",
    "end": "2324010"
  },
  {
    "start": "2322000",
    "end": "2341000"
  },
  {
    "text": "let's get into a deep drive this is we talked a little bit about the components",
    "start": "2324010",
    "end": "2329080"
  },
  {
    "text": "we talked about why we we think they're important give you a high mile-an-hour a",
    "start": "2329080",
    "end": "2334870"
  },
  {
    "text": "review of all the tools that we use so let's look at one specific interface the",
    "start": "2334870",
    "end": "2339880"
  },
  {
    "text": "interface between the notes in the BMC the hosts of the BMC interface there's",
    "start": "2339880",
    "end": "2347380"
  },
  {
    "text": "this IPMI document a specification that describes these interfaces and the one",
    "start": "2347380",
    "end": "2352960"
  },
  {
    "text": "that we're concerned with is going to be called the system interface IP my",
    "start": "2352960",
    "end": "2358060"
  },
  {
    "text": "defines it and then defines a bunch of ways that a system can expose this interface there are four that they give",
    "start": "2358060",
    "end": "2367180"
  },
  {
    "start": "2363000",
    "end": "2404000"
  },
  {
    "text": "in the spec kcs SMI CBT and SIF in all",
    "start": "2367180",
    "end": "2372610"
  },
  {
    "text": "of my travels I've only seen kc s and s SIF used kcs is I'm not going to get",
    "start": "2372610",
    "end": "2380230"
  },
  {
    "text": "into the detail you can read the spec if you really are curious but but the the main takeaway is that kcs is going to",
    "start": "2380230",
    "end": "2386050"
  },
  {
    "text": "use the LPC bus or by bus to to expose a",
    "start": "2386050",
    "end": "2392920"
  },
  {
    "text": "very simple sort of byte by byte serial interface to the BMC SIF is very similar",
    "start": "2392920",
    "end": "2400960"
  },
  {
    "text": "but it uses I have I squared C buses so if we're on a server and we're",
    "start": "2400960",
    "end": "2409240"
  },
  {
    "start": "2404000",
    "end": "2439000"
  },
  {
    "text": "curious what interface it has one of the things we talked about was this DM ID code command if you run D MIT could one",
    "start": "2409240",
    "end": "2418690"
  },
  {
    "text": "of the things that are often advertised is the the IPMI device and in this example we have a case es an expose or",
    "start": "2418690",
    "end": "2429250"
  },
  {
    "text": "advertise kcs device and the base address is going to be that CC 0 0 c c 0",
    "start": "2429250",
    "end": "2434610"
  },
  {
    "text": "io port the linux kernel provides a",
    "start": "2434610",
    "end": "2443370"
  },
  {
    "text": "driver so you can talk to the IPMI you can talk i PMI to to your vm c and once",
    "start": "2443370",
    "end": "2451810"
  },
  {
    "text": "you modprobe that or in Samad that it's the the DMS is output it will help you",
    "start": "2451810",
    "end": "2457000"
  },
  {
    "text": "understand whether or not that what you saw in the DM ID code is actually actor because like I said before sometimes DM",
    "start": "2457000",
    "end": "2463720"
  },
  {
    "text": "ID code is not accurate when it works it tells you know it's going to especially",
    "start": "2463720",
    "end": "2469930"
  },
  {
    "text": "these last two lines it's going to say that it found the new BMC and that the kcs interface is initialized oftentimes",
    "start": "2469930",
    "end": "2476920"
  },
  {
    "text": "it will be disabled and if it's disabled you won't get those last two lines and none your ipmi tool commands will work",
    "start": "2476920",
    "end": "2482820"
  },
  {
    "text": "so why would you want to disable it well going back to this these system interfaces are not meant to be used or",
    "start": "2482820",
    "end": "2489810"
  },
  {
    "start": "2483000",
    "end": "2561000"
  },
  {
    "text": "at least this boundary between the host and the BMC through these system interfaces is not meant to be privileged",
    "start": "2489810",
    "end": "2496210"
  },
  {
    "text": "so it was it was all kinda key if you're gonna talk to the BMC through these interfaces you're assumed",
    "start": "2496210",
    "end": "2501940"
  },
  {
    "text": "to be able it's assumed that you're allowed to and that the system designed it that way and that was configured in",
    "start": "2501940",
    "end": "2508210"
  },
  {
    "text": "such a way that that they wanted you to do this so what do we do about that this",
    "start": "2508210",
    "end": "2514180"
  },
  {
    "text": "case yes interfaces I hate it I thing we haven't talked about is that this interface and these IPMI commands off",
    "start": "2514180",
    "end": "2520630"
  },
  {
    "text": "often going to provide a huge amount of surface but beyond that they're also going to provide features that allow you",
    "start": "2520630",
    "end": "2526360"
  },
  {
    "text": "to do things like flash the BMC so if you want to prevent if you don't want to",
    "start": "2526360",
    "end": "2532600"
  },
  {
    "text": "trough the hosts and you want to ensure that the host is not allowed to just last BMC whenever at once what can you do",
    "start": "2532600",
    "end": "2539950"
  },
  {
    "text": "well you don't want it right so just get rid of it we'll just throw it out we'll",
    "start": "2539950",
    "end": "2545680"
  },
  {
    "text": "be featuring unfortunately there isn't",
    "start": "2545680",
    "end": "2551170"
  },
  {
    "text": "just one so we saw that advertisement of wine in the DMI decode output but often",
    "start": "2551170",
    "end": "2557589"
  },
  {
    "text": "there's gonna be more than one there's going to be two or three why do we need multiple kcs interfaces why would a BMC",
    "start": "2557589",
    "end": "2564670"
  },
  {
    "start": "2561000",
    "end": "2644000"
  },
  {
    "text": "ever support multiple it's only gonna be plugged into one one bus so why does it",
    "start": "2564670",
    "end": "2571210"
  },
  {
    "text": "where is that more well what we found out is that the SMM might needed to access the BMC to to do things like send",
    "start": "2571210",
    "end": "2580089"
  },
  {
    "text": "a log message about a fatal hardware or a significant hardware and so here we",
    "start": "2580089",
    "end": "2589000"
  },
  {
    "text": "have the again this is that PMI spec showing that they have the all these sensor reading errors that the SMM can",
    "start": "2589000",
    "end": "2595569"
  },
  {
    "text": "provide can send over to the BMC that an administrator can then go look for saying why is my you know why does it",
    "start": "2595569",
    "end": "2602079"
  },
  {
    "text": "turn off every 20 minutes oh it's it's having a thermal problem okay fine so",
    "start": "2602079",
    "end": "2608050"
  },
  {
    "text": "why don't we just turn off the one interface and leave the one for SMM right we have these two interfaces one",
    "start": "2608050",
    "end": "2613510"
  },
  {
    "text": "is exposed to the OS one is meant to be used by SMM but we'll just turn off the Auslan unfortunately it's not that easy",
    "start": "2613510",
    "end": "2619780"
  },
  {
    "text": "because like I said kcs works over this poor I owe and the chipset wasn't designed to prevent access from port Ivo",
    "start": "2619780",
    "end": "2627540"
  },
  {
    "text": "across these things you'd have to know one approach would be to reconfigure your entire LPC controller set up every",
    "start": "2627540",
    "end": "2636550"
  },
  {
    "text": "time you enter an egg is smm not a great approach slow and messy so it's not it's",
    "start": "2636550",
    "end": "2645040"
  },
  {
    "text": "not simple do we give up logging serious hours well we could right and we've seen",
    "start": "2645040",
    "end": "2652119"
  },
  {
    "text": "people approach this in that way you can turn off the you can turn it off you can do it more often we've seen the approach",
    "start": "2652119",
    "end": "2661569"
  },
  {
    "text": "of the ostrich with his head in the sand so often times we'll see people just",
    "start": "2661569",
    "end": "2666700"
  },
  {
    "text": "turn it just not just ignore it ignore it as a problem and I see that because it's not exposed via the",
    "start": "2666700",
    "end": "2672579"
  },
  {
    "text": "DMI decode via the SM bias metadata we",
    "start": "2672579",
    "end": "2677890"
  },
  {
    "text": "won't we won't deal with it it no one will find it it'll be fine",
    "start": "2677890",
    "end": "2683278"
  },
  {
    "text": "that one I'm not a big play enough the other one the second one is this amazon",
    "start": "2683699",
    "end": "2689589"
  },
  {
    "text": "nitrate security chip so maybe we just gave a talk in 2018 at the 2018 reinvent",
    "start": "2689589",
    "end": "2694989"
  },
  {
    "text": "discussing their new nitra architecture and one of the about a third of the",
    "start": "2694989",
    "end": "2700029"
  },
  {
    "text": "middle of talk was talking about this nitro security chip and they mentioned that they maybe they have this filter",
    "start": "2700029",
    "end": "2708999"
  },
  {
    "text": "that they put in this harbor filter that ensures that no non-volatile memory is ever written and they call out in fact",
    "start": "2708999",
    "end": "2715719"
  },
  {
    "text": "the BMC interface saying that you know they need to lock that down so if you're",
    "start": "2715719",
    "end": "2720969"
  },
  {
    "text": "not Amazon and you can't create your own hardware what can you do back to this idea of using SMM and Lenovo took this",
    "start": "2720969",
    "end": "2728909"
  },
  {
    "text": "developers kcs lock feature so this code",
    "start": "2728909",
    "end": "2735189"
  },
  {
    "start": "2731000",
    "end": "2772000"
  },
  {
    "text": "is that is in BIOS and when when you fi is when SMM is triggering the ready to",
    "start": "2735189",
    "end": "2742209"
  },
  {
    "text": "lock event no one ready to lock this call is gonna this callback is gonna get called and what this does is it sends",
    "start": "2742209",
    "end": "2749140"
  },
  {
    "text": "this it generates a random nonce this a 32 bit random value and it sends it",
    "start": "2749140",
    "end": "2758979"
  },
  {
    "text": "across to the to the BMC now this is prior to any OS code any of the host code running this is early early in the",
    "start": "2758979",
    "end": "2765339"
  },
  {
    "text": "early in BIOS once it sends that caseous knots over to the to the BMC then",
    "start": "2765339",
    "end": "2772799"
  },
  {
    "text": "instead of reconfiguring the whole thing every time any time that SMM would want",
    "start": "2772799",
    "end": "2778630"
  },
  {
    "text": "to send one of these admittedly rare events for some hardware failure you",
    "start": "2778630",
    "end": "2783819"
  },
  {
    "text": "know unlock this feature wall is he an S mmm by sending that KC Assange back to",
    "start": "2783819",
    "end": "2788979"
  },
  {
    "text": "the BMC again the BMC would would acknowledge it turn the key CS or lose",
    "start": "2788979",
    "end": "2795309"
  },
  {
    "text": "not turn it on but you know set a flag saying that yes we're now allowing any traffic on this bus to this to this",
    "start": "2795309",
    "end": "2801819"
  },
  {
    "text": "endpoint they would send the normal kcs do perform the normal kcs message",
    "start": "2801819",
    "end": "2809170"
  },
  {
    "text": "and then clear the KCF nots again to ensure that returning from fmm back to the host would leave it in a state where",
    "start": "2809170",
    "end": "2816280"
  },
  {
    "text": "anyone running on the host or any code running was couldn't access this this this feature I think we'll skip this one",
    "start": "2816280",
    "end": "2824700"
  },
  {
    "text": "and go to the to the end but yeah do you",
    "start": "2824700",
    "end": "2832120"
  },
  {
    "text": "want to jump on it yeah sure yeah and the the the the case today that we swayed that we that we skipped over is",
    "start": "2832120",
    "end": "2838360"
  },
  {
    "start": "2833000",
    "end": "2873000"
  },
  {
    "text": "really some of the same story right so it's it's a it's a flash component that's exposed over an interface that it",
    "start": "2838360",
    "end": "2845140"
  },
  {
    "text": "should not have been and then they realized that and so they tried to put a lock on it in that particular case the lock didn't really work and so there",
    "start": "2845140",
    "end": "2852040"
  },
  {
    "text": "were some some CDs for it a little while ago and now that was annotated like the solution was to just remove the door",
    "start": "2852040",
    "end": "2859330"
  },
  {
    "text": "entirely so like now like where it used to be open all the time if you knew the key but then the key didn't really work right and rather than re-engineer all",
    "start": "2859330",
    "end": "2865150"
  },
  {
    "text": "that it's all shut off until except for like that small window during boot so",
    "start": "2865150",
    "end": "2871230"
  },
  {
    "text": "okay so wrapping up like like right what what's interesting what do we care about what's what's interesting to look at in",
    "start": "2871230",
    "end": "2878590"
  },
  {
    "start": "2873000",
    "end": "2967000"
  },
  {
    "text": "the future you mentioned some of this at the beginning though just kind of talk through it again right that the attack",
    "start": "2878590",
    "end": "2884590"
  },
  {
    "text": "chains in really restrictive environments are the most interesting they're the ones who turn on all the security features right they're the ones",
    "start": "2884590",
    "end": "2890290"
  },
  {
    "text": "who who care about security enough to have actually done those things and the attack surface that's left over it's",
    "start": "2890290",
    "end": "2896650"
  },
  {
    "text": "still there and it's it's the it's the sort of the current hardest part you've",
    "start": "2896650",
    "end": "2903640"
  },
  {
    "text": "got to deal with right so that that's interesting the peripherals like as I mentioned earlier it's really it's it's",
    "start": "2903640",
    "end": "2910420"
  },
  {
    "text": "not well understood yet right pivoting back to the host it's something that I think is probably very well understood in certain quiet corners of the world",
    "start": "2910420",
    "end": "2918460"
  },
  {
    "text": "they don't talk about it publicly there's actually not a whole lot there's a very interesting attack surface from VMC's in particular like there's a lot",
    "start": "2918460",
    "end": "2924370"
  },
  {
    "text": "of emulated devices that get exposed up to the hosts that you know it's it's sort of like I keep you like plug in a",
    "start": "2924370",
    "end": "2930100"
  },
  {
    "text": "face dancer into the host or something like if they get hardware types of attacks that you would normally think",
    "start": "2930100",
    "end": "2935500"
  },
  {
    "text": "I'd like I'm gonna walk up at this machine and plug this thing in and then in compromise it that way but you're doing it through the BMC remotely and then the user land stuff at",
    "start": "2935500",
    "end": "2943680"
  },
  {
    "text": "the end I think it needs a lot more focus and it's it's got the same set all of those same problems that I talked about earlier some of them in crazy",
    "start": "2943680",
    "end": "2950099"
  },
  {
    "text": "cases or even exposed out on the network so you end up where like perhaps I can",
    "start": "2950099",
    "end": "2955619"
  },
  {
    "text": "flash your firmware across the network like that's not that shouldn't be that",
    "start": "2955619",
    "end": "2960780"
  },
  {
    "text": "should be a well-defined interface that's like that it's locked out appropriately right that you're doing doing it on purpose and you're not exposing it on accident right so so",
    "start": "2960780",
    "end": "2969119"
  },
  {
    "start": "2967000",
    "end": "3086000"
  },
  {
    "text": "laughs that's yeah so these are hopefully our takeaways the despite all",
    "start": "2969119",
    "end": "2977310"
  },
  {
    "text": "this hardening the attack service remains on modern service we talked through a bunch of the hardening we talked through some of the ways we're",
    "start": "2977310",
    "end": "2982740"
  },
  {
    "text": "trying to defend against it but it's such a complex system and it's such a legacy system that there's always these",
    "start": "2982740",
    "end": "2988470"
  },
  {
    "text": "direct corners that have been forgotten about for fifteen years and I've always worked that way but can no longer work",
    "start": "2988470",
    "end": "2993930"
  },
  {
    "text": "that way securely and reliably the second takeaway is that SMM is not a",
    "start": "2993930",
    "end": "2999060"
  },
  {
    "text": "secure Enclave right we've seen attacks my credential attacks against it we've seen it has all the problems that you",
    "start": "2999060",
    "end": "3005390"
  },
  {
    "text": "would imagine when you're pretending that it is a separate processor but it isn't right it's running on the same the",
    "start": "3005390",
    "end": "3011359"
  },
  {
    "text": "same the same chip as a CPU additionally we have a lot of hardening that go",
    "start": "3011359",
    "end": "3016700"
  },
  {
    "text": "against it but it's all that hardening is hardening a appurtenant not as a TPM",
    "start": "3016700",
    "end": "3023510"
  },
  {
    "text": "not as a secure Enclave so things like a Sun Ram read vulnerabilities they're going to be have a huge impact that they",
    "start": "3023510",
    "end": "3029270"
  },
  {
    "text": "wouldn't have when another another system that was looking at this as",
    "start": "3029270",
    "end": "3034910"
  },
  {
    "text": "holding secrets and then again we're really really hot on this idea of coming",
    "start": "3034910",
    "end": "3043099"
  },
  {
    "text": "into a peripheral and then coming back out of it so persisting a little peripheral and then looking at all the attack service",
    "start": "3043099",
    "end": "3049790"
  },
  {
    "text": "that you've gained there so the idea again of this map using this idea of searching for attack service and then",
    "start": "3049790",
    "end": "3055550"
  },
  {
    "text": "continue in iterating on that so once you have a foothold on something like a you know hard drive or SATA controller",
    "start": "3055550",
    "end": "3062780"
  },
  {
    "text": "now now what happens next can you reinfect the host can you what",
    "start": "3062780",
    "end": "3068089"
  },
  {
    "text": "other sm bus buses do you have access to all these things are really interesting to us and we're out of time so thank you",
    "start": "3068089",
    "end": "3077300"
  },
  {
    "text": "we're gonna if you have any questions gravity says we're walking out or we're walking on our way over to the what's it",
    "start": "3077300",
    "end": "3082520"
  },
  {
    "text": "called the rapper yep it's gonna hear thank you",
    "start": "3082520",
    "end": "3087310"
  }
]