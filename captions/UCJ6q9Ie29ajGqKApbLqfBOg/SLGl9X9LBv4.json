[
  {
    "text": "you are in a session for crash and pay owning and cloning payment devices with Peter Filmore so please give him a warm",
    "start": "40",
    "end": "6680"
  },
  {
    "text": "Round of Applause thank [Applause]",
    "start": "6680",
    "end": "11608"
  },
  {
    "text": "you uh great thank you uh so um today I'll be working on uh contactless",
    "start": "12639",
    "end": "19560"
  },
  {
    "text": "contactless card devices and more specifically uh devices uh where you're",
    "start": "19560",
    "end": "25599"
  },
  {
    "text": "doing payments through them uh so for my agenda for this talk will be going through the basics of a payment",
    "start": "25599",
    "end": "32599"
  },
  {
    "text": "transaction um over contactless um the U what attacks are out there what how they",
    "start": "32600",
    "end": "39680"
  },
  {
    "text": "basically interact quickly um how you can clone a Mastercard or a Visa card uh",
    "start": "39680",
    "end": "46320"
  },
  {
    "text": "the issues in AMV payment uh a little bit on Apple pay uh and try to cover the",
    "start": "46320",
    "end": "53480"
  },
  {
    "text": "tools I've used and the software developed in um how I've learned these uh subjects",
    "start": "53480",
    "end": "60320"
  },
  {
    "text": "so a key thing in this area is the definitions um in payments you get a lot",
    "start": "60320",
    "end": "67520"
  },
  {
    "text": "of uh AC acronyms defined in um how a transaction occurs uh the key ones are",
    "start": "67520",
    "end": "74280"
  },
  {
    "text": "the ATC the application transaction counter uh so this is a monotonic",
    "start": "74280",
    "end": "79439"
  },
  {
    "text": "counter which is uh used to denote uh the number of transactions a card has",
    "start": "79439",
    "end": "84920"
  },
  {
    "text": "produced uh so this is a fairly important number in the payment system uh to track fraud to track the current",
    "start": "84920",
    "end": "92360"
  },
  {
    "text": "use of the card and it's used in the calculation of cryptograms and CVV codes",
    "start": "92360",
    "end": "99680"
  },
  {
    "text": "uh the second definition is the unpredictable number uh so this is a",
    "start": "99680",
    "end": "105640"
  },
  {
    "text": "random number or a counter or a combination of a date and counter uh",
    "start": "105640",
    "end": "112360"
  },
  {
    "text": "used in transactions to try and prevent uh cloning of transactions and cards um",
    "start": "112360",
    "end": "118520"
  },
  {
    "text": "to and generally into ruce security to a device uh and the final one really to uh",
    "start": "118520",
    "end": "125560"
  },
  {
    "text": "note for this talk is the CVV or dynamic CVV codes uh we're all fairly familiar",
    "start": "125560",
    "end": "131239"
  },
  {
    "text": "with CVV codes uh they're what you enter in on a um uh when you're doing an",
    "start": "131239",
    "end": "136360"
  },
  {
    "text": "online purchase uh they're printed on the back of your card uh these codes are used to ensure that the track data",
    "start": "136360",
    "end": "143319"
  },
  {
    "text": "hasn't been changed um and are used uh to prevent um and detect any",
    "start": "143319",
    "end": "151840"
  },
  {
    "text": "fraud okay so now cover a basic payment transaction flow from a card uh so for",
    "start": "152000",
    "end": "158480"
  },
  {
    "text": "this talk I'm going to go more at a higher level than normal for a contactless cards uh the lower level",
    "start": "158480",
    "end": "165080"
  },
  {
    "text": "stuff is similar across all ranges of cards uh you'll find that there's type A",
    "start": "165080",
    "end": "171040"
  },
  {
    "text": "and type B standard ISO cards um at this level with the payment transaction it",
    "start": "171040",
    "end": "176800"
  },
  {
    "text": "doesn't matter what type of card the at this point it is we're going higher level bites uh in a",
    "start": "176800",
    "end": "185560"
  },
  {
    "text": "transaction so the initial transaction is all generated from the terminal uh so the terminal is the opt is the item that",
    "start": "185560",
    "end": "193319"
  },
  {
    "text": "basically drives the payment uh flow uh it tells the card what it needs and what",
    "start": "193319",
    "end": "198560"
  },
  {
    "text": "to do and what to return the card responds back with uh",
    "start": "198560",
    "end": "204360"
  },
  {
    "text": "Fields uh determining on what the actual uh command from the terminal was uh so",
    "start": "204360",
    "end": "210599"
  },
  {
    "text": "this can be for example a list of uh tags uh for information for a",
    "start": "210599",
    "end": "215879"
  },
  {
    "text": "transaction um or uh CVV codes or static records delivered from the",
    "start": "215879",
    "end": "221879"
  },
  {
    "text": "card so on this case you see the initial transaction flow this is the same for",
    "start": "221879",
    "end": "227799"
  },
  {
    "text": "pretty much all EMV payment cards uh so here you've got the select Payment",
    "start": "227799",
    "end": "233560"
  },
  {
    "text": "Systems environment command uh this is standard across all uh MasterCard are uh",
    "start": "233560",
    "end": "241000"
  },
  {
    "text": "American Express cards um in the NFC specification uh this is where the",
    "start": "241000",
    "end": "248680"
  },
  {
    "text": "terminal is indicating it wants to use a payment card um and it wants to use the",
    "start": "248680",
    "end": "253840"
  },
  {
    "text": "payment um system on the card uh the card will respond back with its payment",
    "start": "253840",
    "end": "258919"
  },
  {
    "text": "directory this is indicating what the card supports so it can support uh",
    "start": "258919",
    "end": "265199"
  },
  {
    "text": "normally you'll find a card will only support one type of um uh account account so normally a debit or a credit",
    "start": "265199",
    "end": "271520"
  },
  {
    "text": "account for example but it it is um out there in terms of cards can be a debit",
    "start": "271520",
    "end": "277680"
  },
  {
    "text": "and a credit card integrated into one uh in this case uh this card was only a",
    "start": "277680",
    "end": "283720"
  },
  {
    "text": "credit card so it's basically responding back with the MasterCard I think uh",
    "start": "283720",
    "end": "291039"
  },
  {
    "text": "Aid the terminal then selects that application ID uh and then we send back",
    "start": "291039",
    "end": "296120"
  },
  {
    "text": "a few tags uh required by the terminal uh to undergo and uh verify transaction",
    "start": "296120",
    "end": "303880"
  },
  {
    "text": "details um so this is the FCI the file uh control information uh so that's the",
    "start": "303880",
    "end": "310560"
  },
  {
    "text": "selected application ID uh and the PLL which is a processing data options list",
    "start": "310560",
    "end": "316639"
  },
  {
    "text": "uh so this provides uh a list of a list of data that the terminal needs to send to the card uh to perform a transaction",
    "start": "316639",
    "end": "324919"
  },
  {
    "text": "uh things like what the card supports what the transaction parameters are",
    "start": "324919",
    "end": "331440"
  },
  {
    "text": "following on the get processing options list uses the P doll list uh and the",
    "start": "331440",
    "end": "337680"
  },
  {
    "text": "terminal will glue all these fields together in the case of a MasterCard transaction you'll normally find that's",
    "start": "337680",
    "end": "343960"
  },
  {
    "text": "a zero length field so that's 83000 uh in the case of a Visa card uh",
    "start": "343960",
    "end": "350120"
  },
  {
    "text": "it's a number of other fields in there so generally you're looking at um what the terminal supports in terms of the",
    "start": "350120",
    "end": "356160"
  },
  {
    "text": "transaction uh currency codes uh unpredictable numbers that kind of thing the card responds with the uh",
    "start": "356160",
    "end": "364240"
  },
  {
    "text": "application AIP and the uh application file locator um the AIP is a set of bits",
    "start": "364240",
    "end": "373319"
  },
  {
    "text": "that indicate what the card supports uh so what modes the card support in terms of the verification um does it support",
    "start": "373319",
    "end": "380599"
  },
  {
    "text": "uh backwards compatibility modes that kind of thing uh and after this we generally go and start reading static",
    "start": "380599",
    "end": "387240"
  },
  {
    "text": "records from the card so in this case we're doing the read record 1 one which is short file indicator one uh track",
    "start": "387240",
    "end": "394960"
  },
  {
    "text": "record one um and you can see here that we've got a lot of data coming back from",
    "start": "394960",
    "end": "400680"
  },
  {
    "text": "the card uh so for this selected in the EMB standard normally you'll find this",
    "start": "400680",
    "end": "406840"
  },
  {
    "text": "is where you get your track one data um so your magnetic stripe equivalent data",
    "start": "406840",
    "end": "411880"
  },
  {
    "text": "that kind of thing from the cards all these commands are pretty much",
    "start": "411880",
    "end": "417199"
  },
  {
    "text": "the same across all brands of card so for a MasterCard magstripe",
    "start": "417199",
    "end": "424680"
  },
  {
    "text": "transaction we perform a cryptographic check some after this uh so this is specific for the MasterCard operation uh",
    "start": "424680",
    "end": "432280"
  },
  {
    "text": "a MasterCard mag stripe transaction is a uh legacy mode that we'll discuss",
    "start": "432280",
    "end": "437360"
  },
  {
    "text": "further on where we're trying to integrate a older system into uh a new",
    "start": "437360",
    "end": "445560"
  },
  {
    "text": "EMB system into older payment networks uh so here we're looking at um",
    "start": "445560",
    "end": "450960"
  },
  {
    "text": "generating a cryptographic check sum uh based off the unpredictable number which",
    "start": "450960",
    "end": "456520"
  },
  {
    "text": "is in the red on the terminal so the terminal send out the unpredictable number which is four bytes the card then",
    "start": "456520",
    "end": "464120"
  },
  {
    "text": "sends back the uh CVC 3 which is your Dynamic CVC code and the application",
    "start": "464120",
    "end": "470720"
  },
  {
    "text": "transaction counter so at this point the uh in a magstripe MasterCard magstripe",
    "start": "470720",
    "end": "476479"
  },
  {
    "text": "transaction you finished the payment flow what the terminal then does is bundle all this together um place it",
    "start": "476479",
    "end": "482759"
  },
  {
    "text": "into a track data uh and send it off to your payment processor for",
    "start": "482759",
    "end": "490960"
  },
  {
    "text": "authorization now the second type of uh support mode in a MasterCard is an mchip",
    "start": "491960",
    "end": "498360"
  },
  {
    "text": "support mchip is a cut down version of your card uh your uh EMV or chip card",
    "start": "498360",
    "end": "505520"
  },
  {
    "text": "design uh so here we have to read a lot more information to verif y the uh",
    "start": "505520",
    "end": "510680"
  },
  {
    "text": "transaction um so here we're reading a lot more records uh few more",
    "start": "510680",
    "end": "515760"
  },
  {
    "text": "records and more records these generally you can see here that you're sending public key and",
    "start": "515760",
    "end": "522800"
  },
  {
    "text": "certificates and signed data at this point so here the terminal is requesting",
    "start": "522800",
    "end": "528959"
  },
  {
    "text": "the ICC public key uh the ICC public key is used uh to encrypt uh and create a uh",
    "start": "528959",
    "end": "537519"
  },
  {
    "text": "challenge which is then sent in the transaction as well and verified uh this",
    "start": "537519",
    "end": "542800"
  },
  {
    "text": "ensures that nothing has changed on the card and it's fairly standard uh EMV process uh",
    "start": "542800",
    "end": "551240"
  },
  {
    "text": "overall so the final thing with the mchip Trans mchip transaction is that",
    "start": "551240",
    "end": "556480"
  },
  {
    "text": "you generate the an application cryptogram uh the application cryptogram",
    "start": "556480",
    "end": "561560"
  },
  {
    "text": "is a uh signature performed by the ICC private key and sent to the terminal",
    "start": "561560",
    "end": "568120"
  },
  {
    "text": "for each transaction uh the idea behind this is to ensure that you've got a dynamic signature on",
    "start": "568120",
    "end": "573839"
  },
  {
    "text": "the data sent from the card um and ensure that the transaction amounts",
    "start": "573839",
    "end": "579680"
  },
  {
    "text": "currencies uh the uh application transaction counter are all signed in a",
    "start": "579680",
    "end": "587200"
  },
  {
    "text": "transaction so the issue with this is that you need to have two modes in a",
    "start": "588000",
    "end": "593160"
  },
  {
    "text": "Master Card uh in this case you have a legacy mode and the newer mode uh the",
    "start": "593160",
    "end": "598399"
  },
  {
    "text": "newer mode gen generally is the more safe mode but requires a lot more information to be sent over a",
    "start": "598399",
    "end": "605720"
  },
  {
    "text": "wire so for now I'll go over the different kind of attacks that are out there um in terms of what is realistic",
    "start": "606000",
    "end": "613760"
  },
  {
    "text": "and what is more theoretical uh the key attack is really the one that is the most used is",
    "start": "613760",
    "end": "620720"
  },
  {
    "text": "actually just stealing someone's card out of the mail uh the thing with contactless cards is that uh you don't",
    "start": "620720",
    "end": "626240"
  },
  {
    "text": "generally have the um uh authoriz not the auth authorization but the uh",
    "start": "626240",
    "end": "631560"
  },
  {
    "text": "authentication on whether it's your card or not so you don't have to enter a PIN number for example to use it you just",
    "start": "631560",
    "end": "637600"
  },
  {
    "text": "have to uh swipe it or tap and go to use the money and generally this is the",
    "start": "637600",
    "end": "643279"
  },
  {
    "text": "major form uh we've been hearing about in terms of um police uh being worried",
    "start": "643279",
    "end": "649560"
  },
  {
    "text": "about these cards um however you are limited by the transaction amounts with these kind of",
    "start": "649560",
    "end": "656079"
  },
  {
    "text": "um cards as well so it's 20 in the United Kingdom uh $880 in Australia uh",
    "start": "656079",
    "end": "663720"
  },
  {
    "text": "and in the US I think it's $20 before you have to insert the card so you generally um have a limit of the amount",
    "start": "663720",
    "end": "670560"
  },
  {
    "text": "of losses you can take out of a card the second form of attack is a",
    "start": "670560",
    "end": "676959"
  },
  {
    "text": "relay attack in an EMV uh system you can't uh you don't have any bounding",
    "start": "676959",
    "end": "683120"
  },
  {
    "text": "properties um so someone can read your card and re and have the transaction go",
    "start": "683120",
    "end": "690600"
  },
  {
    "text": "across the continents to another terminal uh these were talked about in",
    "start": "690600",
    "end": "697079"
  },
  {
    "text": "2007 um at 2012 and there's a newer talk in 2015 on how to do relay attacks they",
    "start": "697079",
    "end": "704959"
  },
  {
    "text": "are fairly simple where you're just taking a card uh emulating a terminal sending it through the internet to",
    "start": "704959",
    "end": "712079"
  },
  {
    "text": "another device and then the other person needs to be at the payment device to make that payment at the time uh so you",
    "start": "712079",
    "end": "718800"
  },
  {
    "text": "can't store and forward transactions you need to actually uh do them in real time",
    "start": "718800",
    "end": "724000"
  },
  {
    "text": "to actually perform this kind of fraud uh so it's kind of difficult in terms of um uh being worried about",
    "start": "724000",
    "end": "731160"
  },
  {
    "text": "it those are really the two major types of fraud you see in systems at the",
    "start": "731160",
    "end": "737079"
  },
  {
    "text": "moment um solutions to these kind of things are you want to authenticate the user so on Apple pay with a thumb print",
    "start": "737079",
    "end": "744279"
  },
  {
    "text": "or uh an example is in Australia if uh you do multiple contactless transactions",
    "start": "744279",
    "end": "750800"
  },
  {
    "text": "it'll prompt you for to ENT your PIN uh during that transaction uh another way",
    "start": "750800",
    "end": "756519"
  },
  {
    "text": "is to make the user to insert the card and use the chip interface as well uh",
    "start": "756519",
    "end": "763399"
  },
  {
    "text": "you can also uh block the card just by using uh tin foil or Al foil around the",
    "start": "763399",
    "end": "769120"
  },
  {
    "text": "card um that blocks enough of the signal really that no one really can read it out of your pocket um that's a key thing",
    "start": "769120",
    "end": "774800"
  },
  {
    "text": "with these cards is that you can't turn them off when you or um you've got them",
    "start": "774800",
    "end": "780279"
  },
  {
    "text": "in your wallet you need to Shield them simply or cut a hole in",
    "start": "780279",
    "end": "785639"
  },
  {
    "text": "them so on card cloning uh this talk is really uh inspired by a lot of the um",
    "start": "785639",
    "end": "791959"
  },
  {
    "text": "information coming out uh where people were saying you can clone these cards um",
    "start": "791959",
    "end": "798600"
  },
  {
    "text": "I wanted to basically talk about that in terms of what can you really clone um can you clone them or not uh my thought",
    "start": "798600",
    "end": "805839"
  },
  {
    "text": "was no I thought that there was enough Protections in place um and the cards",
    "start": "805839",
    "end": "810959"
  },
  {
    "text": "are generally well made that you couldn't the reason I thought this is",
    "start": "810959",
    "end": "816279"
  },
  {
    "text": "that the chip card interface and the uh NFC interfaces uh can be thought of a",
    "start": "816279",
    "end": "821600"
  },
  {
    "text": "mini high security module um they're really well tested they've got a low a",
    "start": "821600",
    "end": "827240"
  },
  {
    "text": "small attack surface um and they're pretty heavily lab tested in terms of",
    "start": "827240",
    "end": "832920"
  },
  {
    "text": "the card manufacturing um so you've got semi-formal design side Channel attack analysis uh and very small amount of API",
    "start": "832920",
    "end": "841000"
  },
  {
    "text": "you can access in terms of um fuzzing and that kind of uh",
    "start": "841000",
    "end": "846199"
  },
  {
    "text": "area you've also got uh cryptographic Keys embedded in these cards uh and",
    "start": "846199",
    "end": "851920"
  },
  {
    "text": "these Keys generally are you uh derived for that card um to ensure that uh if",
    "start": "851920",
    "end": "859120"
  },
  {
    "text": "even if you broke open the card and obtain the key you only get the keys for that card not across the whole range of",
    "start": "859120",
    "end": "867199"
  },
  {
    "text": "devices Additionally you got Dynamic signatures on transactions as well so",
    "start": "867519",
    "end": "872759"
  },
  {
    "text": "here is the list of uh different fields used in the uh mchip mode or the um EMV",
    "start": "872759",
    "end": "881000"
  },
  {
    "text": "uh combined data authentication modes um and you can kind of see there's a lot of",
    "start": "881000",
    "end": "886680"
  },
  {
    "text": "information provided and signed in these uh in the information that's sent off for the payment system uh so you've got",
    "start": "886680",
    "end": "893600"
  },
  {
    "text": "amounts unpredictable numbers um transaction areas and dynamic uh numbers",
    "start": "893600",
    "end": "899880"
  },
  {
    "text": "as well in a signature now you do have issues in terms of um uh for the cryptographers",
    "start": "899880",
    "end": "907000"
  },
  {
    "text": "out there with the types of algorithms used uh because these systems were um",
    "start": "907000",
    "end": "913000"
  },
  {
    "text": "proposed and written up uh 15 20 years ago you're looking at",
    "start": "913000",
    "end": "918560"
  },
  {
    "text": "um uh cryptography and hashes that are generally not seen as being ideal for",
    "start": "918560",
    "end": "924360"
  },
  {
    "text": "use so in a card you'll be using Shan hash um and normally the private keys",
    "start": "924360",
    "end": "930560"
  },
  {
    "text": "will be an RSA 1024 bit key uh and that's fairly fixed in the industry uh",
    "start": "930560",
    "end": "936480"
  },
  {
    "text": "and it's probably not the greatest thing but they that can be covered for another",
    "start": "936480",
    "end": "942040"
  },
  {
    "text": "day so I thought well you probably can't do it um the way the standards written",
    "start": "942040",
    "end": "949600"
  },
  {
    "text": "when you go through the um process it seems fairly um well put together in terms of the cryptography and the",
    "start": "949600",
    "end": "956000"
  },
  {
    "text": "operations used but then I found paper by Michael Rolland and a talk which discussed",
    "start": "956000",
    "end": "963199"
  },
  {
    "text": "transaction cloning and more specifically around um how you can store and replay transactions from cards and",
    "start": "963199",
    "end": "970639"
  },
  {
    "text": "especially contactless cards the reason behind this is because you need to have these Legacy modes to",
    "start": "970639",
    "end": "977000"
  },
  {
    "text": "support older networks and payment processes and as such the MasterCard",
    "start": "977000",
    "end": "984519"
  },
  {
    "text": "Visa the large companies uh have implemented these Legacy modes to ensure that uh we can use our cards wherever",
    "start": "984519",
    "end": "992240"
  },
  {
    "text": "without too much hassle and the issue with these Legacy modes is that they're are very",
    "start": "992240",
    "end": "998440"
  },
  {
    "text": "significantly cut down compared to a full chip EMV solution so these Legacy modes in",
    "start": "998440",
    "end": "1005920"
  },
  {
    "text": "MasterCard it's called a magstripe mode uh for Visa it's a dynamic CVV or more a",
    "start": "1005920",
    "end": "1012440"
  },
  {
    "text": "modernly uh CVN 17 uh mode",
    "start": "1012440",
    "end": "1019440"
  },
  {
    "text": "so we go into cloning transactions so how would we clone a transaction on maxst stripe",
    "start": "1019440",
    "end": "1025120"
  },
  {
    "text": "mode you want to generate track data that's similar to a system so in this mode we're basically",
    "start": "1025120",
    "end": "1033438"
  },
  {
    "text": "making a dynamic CVV and inserting that into regular track data and sending that",
    "start": "1033439",
    "end": "1038600"
  },
  {
    "text": "off uh so traditionally you'll have a uh track field as pictured below where",
    "start": "1038600",
    "end": "1046558"
  },
  {
    "text": "you've got name discretionally data the service code in the case of a NFC card",
    "start": "1046559",
    "end": "1052120"
  },
  {
    "text": "you'll find that the name's normally blanked out uh and your discretionary data is used to store the uh values to",
    "start": "1052120",
    "end": "1060200"
  },
  {
    "text": "calculate the dynamic signature with the code so you've got your application",
    "start": "1060200",
    "end": "1065360"
  },
  {
    "text": "transaction counter you've got the unpredictable number um and you have a",
    "start": "1065360",
    "end": "1071280"
  },
  {
    "text": "issuer uh initialization value you encrypt these you uh then truncate it",
    "start": "1071280",
    "end": "1078280"
  },
  {
    "text": "and you fit it into the discretionary data of the track the issue with this track data is that it's a limited field",
    "start": "1078280",
    "end": "1085720"
  },
  {
    "text": "you generally because you're using old systems and old equipment um they will have a fixed length uh normally 80 bytes",
    "start": "1085720",
    "end": "1093760"
  },
  {
    "text": "or so or lower than that depending on how they process transactions so you can't throw a whole heap of information",
    "start": "1093760",
    "end": "1100320"
  },
  {
    "text": "into the track data you kind of need to truncate it and process it so it gets uh",
    "start": "1100320",
    "end": "1106520"
  },
  {
    "text": "performed correctly so the issue with the MasterCard magstripe mode came about",
    "start": "1106520",
    "end": "1112799"
  },
  {
    "text": "because of these limitations so the unpredictable number when I originally",
    "start": "1112799",
    "end": "1118880"
  },
  {
    "text": "thought was Secure I thought that was a binary field where we were fine because",
    "start": "1118880",
    "end": "1124640"
  },
  {
    "text": "we've got four bytes um and you're looking at 4.2 billion or so errors so",
    "start": "1124640",
    "end": "1132440"
  },
  {
    "text": "uh the four this four bytes basically then has to be binary coded",
    "start": "1132440",
    "end": "1137720"
  },
  {
    "text": "decimal so then 10 8 100 million that's",
    "start": "1137720",
    "end": "1142760"
  },
  {
    "text": "fine however the issue is you need to also limit the size of the data in the",
    "start": "1142760",
    "end": "1148840"
  },
  {
    "text": "magnetic stripe what this means is you limited by the number of fields you can",
    "start": "1148840",
    "end": "1154400"
  },
  {
    "text": "use so on this case you've got a un length of two in that case that's 10 to",
    "start": "1154400",
    "end": "1160440"
  },
  {
    "text": "the two values which means they're only 0 to 99 numbers for the unpredictable",
    "start": "1160440",
    "end": "1167360"
  },
  {
    "text": "number and this is is set by the issuer on the card so the issuer sets these fields on the card when they actually",
    "start": "1167360",
    "end": "1173799"
  },
  {
    "text": "generate the area so on this case it's the kraak uh is non zero bits so the",
    "start": "1173799",
    "end": "1179840"
  },
  {
    "text": "total size of the bit minus the uh TR trck which is the number of bits that are been set and that gives you how much",
    "start": "1179840",
    "end": "1187120"
  },
  {
    "text": "room you have for the UN field in the in the discretionary",
    "start": "1187120",
    "end": "1193559"
  },
  {
    "text": "data so this is where the issue comes around because of the fact you're taking",
    "start": "1193559",
    "end": "1199000"
  },
  {
    "text": "what is seen as being a random number and you're reducing the length of it to fit in these older systems it actually",
    "start": "1199000",
    "end": "1205200"
  },
  {
    "text": "introduces the ability to clone transactions and now my click is not",
    "start": "1205200",
    "end": "1212159"
  },
  {
    "text": "looking great okay so how decl a",
    "start": "1212159",
    "end": "1218360"
  },
  {
    "text": "transaction firstly you read and copy the records you can then generate a",
    "start": "1218360",
    "end": "1223640"
  },
  {
    "text": "dictionary based off the compute cryptographic check sum uh so this is where you basically send a whole heap of",
    "start": "1223640",
    "end": "1230200"
  },
  {
    "text": "these uh commands to the card when it's in the reader field um such that you can",
    "start": "1230200",
    "end": "1236480"
  },
  {
    "text": "then generate a dictionary to look up the appropriate field uh in the",
    "start": "1236480",
    "end": "1241520"
  },
  {
    "text": "future this will increment the uh application transaction counter but as",
    "start": "1241520",
    "end": "1247840"
  },
  {
    "text": "I've tested in the actual field you it doesn't actually matter in certain",
    "start": "1247840",
    "end": "1253360"
  },
  {
    "text": "payment processes you then flip the M mchip support bit so so this is tag 82 on the",
    "start": "1253360",
    "end": "1260320"
  },
  {
    "text": "card that indicates that the card only supports a legacy mode in this case so on the Android application I made to do",
    "start": "1260320",
    "end": "1267600"
  },
  {
    "text": "this I just flipped that bit and now it will be defaulting to that area after this I can then go to the",
    "start": "1267600",
    "end": "1274559"
  },
  {
    "text": "terminal and replay the stored records uh so I initiate the transaction hold my",
    "start": "1274559",
    "end": "1279960"
  },
  {
    "text": "phone up the application then looks up the unpredictable number in the dictionary",
    "start": "1279960",
    "end": "1286320"
  },
  {
    "text": "and replays it back for the transaction and then you collect the purchase basically so how long does this normally",
    "start": "1286320",
    "end": "1293240"
  },
  {
    "text": "take to actually clone a c in terms of this uh field in this case I made an application",
    "start": "1293240",
    "end": "1299279"
  },
  {
    "text": "here to actually give you the amount of time it normally takes to do this to calculate these amount of transactions",
    "start": "1299279",
    "end": "1305480"
  },
  {
    "text": "so if you want to do 100 compute cryptographic check sums uh it takes around about 25 seconds or",
    "start": "1305480",
    "end": "1312559"
  },
  {
    "text": "so uh actually less than that 20 seconds um in the case of 10,000 transactions",
    "start": "1312559",
    "end": "1317960"
  },
  {
    "text": "you're looking at 25 minutes so this is each time you add an extra decimal place",
    "start": "1317960",
    "end": "1323039"
  },
  {
    "text": "you're adding a factor a large factor of time on to actually clone the",
    "start": "1323039",
    "end": "1329520"
  },
  {
    "text": "card so hopefully the uh so I record pre-recorded the demo for this um",
    "start": "1329520",
    "end": "1335080"
  },
  {
    "text": "because I didn't want to bring the whole terminal with me um but hopefully this can show you",
    "start": "1335080",
    "end": "1342520"
  },
  {
    "text": "now how quick it is okay right so this is my payment card at home um and the",
    "start": "1342760",
    "end": "1348520"
  },
  {
    "text": "application on here uh so this is just a stock Android phone",
    "start": "1348520",
    "end": "1354640"
  },
  {
    "text": "here um and then I programmed it to do this dictionary so at the moment is generating the dictionary um and storing",
    "start": "1354640",
    "end": "1360919"
  },
  {
    "text": "on the database and once it's done and this is",
    "start": "1360919",
    "end": "1366200"
  },
  {
    "text": "the reader that I bought off eBay um so this is a reader that will only do mag stripe mode um so this will send their",
    "start": "1366200",
    "end": "1371960"
  },
  {
    "text": "random number so I select the card and hope believe it should be",
    "start": "1371960",
    "end": "1381360"
  },
  {
    "text": "okay and when you beat the card it should say all good yeah so that's a",
    "start": "1381679",
    "end": "1387799"
  },
  {
    "text": "transaction simply put that's how quickly you can actually perform this kind of cloning um and the good thing",
    "start": "1387799",
    "end": "1393600"
  },
  {
    "text": "about it about this kind of uh attack is that you get multiple times to use those",
    "start": "1393600",
    "end": "1399080"
  },
  {
    "text": "records as well because as long as the if the terminal sends out a low random",
    "start": "1399080",
    "end": "1404880"
  },
  {
    "text": "number then you're sending the lower application transaction count so I'll found on average I get maybe",
    "start": "1404880",
    "end": "1411919"
  },
  {
    "text": "three goes at it um before it's above the application transaction counter of",
    "start": "1411919",
    "end": "1418200"
  },
  {
    "text": "the current card and so I can't generate it Additionally you can stop the",
    "start": "1418200",
    "end": "1424120"
  },
  {
    "text": "transaction for example and force it and just keep doing transactions over and over till you hit the random number you",
    "start": "1424120",
    "end": "1431440"
  },
  {
    "text": "want for the correct generated CVC",
    "start": "1431440",
    "end": "1435840"
  },
  {
    "text": "code and the is issue with this is that it's actually built into the MasterCard system so this is off the mchip",
    "start": "1436880",
    "end": "1443760"
  },
  {
    "text": "requirements and which was published in 2013 uh and they require that the",
    "start": "1443760",
    "end": "1450679"
  },
  {
    "text": "unpredictable number is only as must be at least two digits uh generally the",
    "start": "1450679",
    "end": "1456880"
  },
  {
    "text": "issue with these kind of um requirements is that you can say two digits but most",
    "start": "1456880",
    "end": "1463679"
  },
  {
    "text": "of the time uh the issuer will probably set it at two digits cuz they read two digits um uh I've seen two three and",
    "start": "1463679",
    "end": "1473159"
  },
  {
    "text": "four normally um four is on a better card you want a four-digit card for",
    "start": "1473159",
    "end": "1479320"
  },
  {
    "text": "example so the fixes for these kind of attacks is that the ATC the application",
    "start": "1479320",
    "end": "1484760"
  },
  {
    "text": "transaction counter will jump um in the uh field this means that you can detect",
    "start": "1484760",
    "end": "1490399"
  },
  {
    "text": "it on the processing side the issuer should prompt for a",
    "start": "1490399",
    "end": "1496120"
  },
  {
    "text": "second factor of authentication if that jumps so if you go if it goes off and tries and do the tries to do the payment it should go",
    "start": "1496120",
    "end": "1504120"
  },
  {
    "text": "back to the terminal and basically asks for the customer to authorize it using some other",
    "start": "1504120",
    "end": "1510759"
  },
  {
    "text": "method and generally the payment processes should",
    "start": "1511120",
    "end": "1516480"
  },
  {
    "text": "basically reject anything that isn't an mchip transaction uh at this stage it",
    "start": "1516480",
    "end": "1522039"
  },
  {
    "text": "shouldn't be that we have to support these Legacy modes simply put so cloning a Visa basically the",
    "start": "1522039",
    "end": "1531159"
  },
  {
    "text": "issue with Visa are that there are a number of different modes that they have",
    "start": "1531159",
    "end": "1536399"
  },
  {
    "text": "implemented over time uh the original legacy mode was the dynamic CVV mode um",
    "start": "1536399",
    "end": "1542679"
  },
  {
    "text": "and this was updated for a the cryptogram uh CBN 17 mode after it was recognized that that was a terribly",
    "start": "1542679",
    "end": "1550080"
  },
  {
    "text": "broken uh form of um generating a uh code these are set by the ttq which is",
    "start": "1550080",
    "end": "1557360"
  },
  {
    "text": "the terminal trans action qualifier and this basically sets these different modes according to what the terminal",
    "start": "1557360",
    "end": "1564000"
  },
  {
    "text": "supports so here we have a terminal telling you what it supports in that area so in the case of a dcvb mode it's",
    "start": "1564000",
    "end": "1571440"
  },
  {
    "text": "a really simple transaction um all we do is the initialization the selection and",
    "start": "1571440",
    "end": "1576840"
  },
  {
    "text": "we then do the uh read record and that will return track data with a CVV code",
    "start": "1576840",
    "end": "1583480"
  },
  {
    "text": "embedded in it uh that's should be dynamic",
    "start": "1583480",
    "end": "1588520"
  },
  {
    "text": "the issue with the D dcv algorithm which was painted is that you can see here",
    "start": "1588520",
    "end": "1594720"
  },
  {
    "text": "there isn't any random number being input into the uh algorithm so here",
    "start": "1594720",
    "end": "1599760"
  },
  {
    "text": "we've got an application transaction counter the primary account number but there's no random number or any",
    "start": "1599760",
    "end": "1605640"
  },
  {
    "text": "Randomness to it what this allows you to do is clone very easily all you have to",
    "start": "1605640",
    "end": "1611480"
  },
  {
    "text": "do is copy the read copy the records uh set your mag stripe bit on the terminal",
    "start": "1611480",
    "end": "1618399"
  },
  {
    "text": "terminal to magstripe mode uh and then you can just have to replay the records you don't have to generate a 100",
    "start": "1618399",
    "end": "1625159"
  },
  {
    "text": "different transactions or have a jump application transaction counters in it so for the demo it's a lot quicker",
    "start": "1625159",
    "end": "1633600"
  },
  {
    "text": "than the other demo um so here is a demo using a common Visa card um so I bought",
    "start": "1633600",
    "end": "1640240"
  },
  {
    "text": "this uh prepaid card um to test with and so naturally doesn't read very",
    "start": "1640240",
    "end": "1647960"
  },
  {
    "text": "well but once it actually get does connect it to the um reader it just works basically it's a",
    "start": "1647960",
    "end": "1654679"
  },
  {
    "text": "lot quicker and the thing with this card is that it's a static CVV as well",
    "start": "1654679",
    "end": "1660200"
  },
  {
    "text": "they're not even dynamically doing the CVV they are they are basically setting it to a",
    "start": "1660200",
    "end": "1666559"
  },
  {
    "text": "static value and in Visa's documentation that was fine um fortunately uh they're phasing out these",
    "start": "1666559",
    "end": "1673480"
  },
  {
    "text": "modes on Visa side um so this was written I think it was 2008 um where",
    "start": "1673480",
    "end": "1680880"
  },
  {
    "text": "they're phasing out the cryptogr version for newer",
    "start": "1680880",
    "end": "1685880"
  },
  {
    "text": "numbers the key thing is the issue of the card can disable these modes so they",
    "start": "1685919",
    "end": "1691000"
  },
  {
    "text": "are disabled generally in a Visa debit card um so the Visa debit cards I have won't actually support mag stripe or",
    "start": "1691000",
    "end": "1697679"
  },
  {
    "text": "Legacy modes additionally they made a newer Mode called CVN 17 um so this is where",
    "start": "1697679",
    "end": "1705240"
  },
  {
    "text": "we are actually generating a uh uh a cryptogram separate which isn't embedded",
    "start": "1705240",
    "end": "1711320"
  },
  {
    "text": "in the track data so we have to send this separate from the",
    "start": "1711320",
    "end": "1716278"
  },
  {
    "text": "command so in these issues generally you have a huge amount of problem with the",
    "start": "1718760",
    "end": "1724559"
  },
  {
    "text": "terminals um the issue with these terminals generally are for contactless terminals for um the Standalone EMV chip",
    "start": "1724559",
    "end": "1732679"
  },
  {
    "text": "terminals is that there's a lack of physical security Protections in them there's a lack of software security",
    "start": "1732679",
    "end": "1738480"
  },
  {
    "text": "Protections in them uh the device I got off eBay in this case um it had exposed",
    "start": "1738480",
    "end": "1744960"
  },
  {
    "text": "JTAG ports uh the manufacturer was nice enough to send me the firmware uh which",
    "start": "1744960",
    "end": "1751320"
  },
  {
    "text": "was uh unencrypted and not signed uh and so I could change anything on that",
    "start": "1751320",
    "end": "1757640"
  },
  {
    "text": "firmware and upload it to the device uh and have it do what I want simply put and this is common across most of the",
    "start": "1757640",
    "end": "1763960"
  },
  {
    "text": "contactless readers you'll see uh they are off-the-shelf processors uh with uh",
    "start": "1763960",
    "end": "1770399"
  },
  {
    "text": "inbuilt debugging uh facilities that are easy to access um there's nothing really",
    "start": "1770399",
    "end": "1775760"
  },
  {
    "text": "to stop you from changing the code on them without any uh undue",
    "start": "1775760",
    "end": "1781919"
  },
  {
    "text": "effort uh additionally unpredictable numbers are a real issue as well uh the",
    "start": "1781919",
    "end": "1787360"
  },
  {
    "text": "these are integral for EMV security um however they're not defined to be from a",
    "start": "1787360",
    "end": "1793960"
  },
  {
    "text": "cryptographic random number Source this was only bought up uh I think it was two years ago where a note was added due to",
    "start": "1793960",
    "end": "1801480"
  },
  {
    "text": "these issues from emvco who uh do the standard for EMV transactions um in that",
    "start": "1801480",
    "end": "1809320"
  },
  {
    "text": "it was suggested maybe you should be taking this from a cryptographic random number Source but even to this day they",
    "start": "1809320",
    "end": "1814600"
  },
  {
    "text": "don't test the source of numbers uh and there's no requirement uh when you're certifying a terminal that it is using a",
    "start": "1814600",
    "end": "1822360"
  },
  {
    "text": "uh proper cryptographic random number Source all right so now I'll cover Apple",
    "start": "1822360",
    "end": "1830320"
  },
  {
    "text": "pay generally um Apple pay as we all know around the last year or so um is",
    "start": "1830320",
    "end": "1836919"
  },
  {
    "text": "the dominant form in the US for your contactless transactions the hardware used is a",
    "start": "1836919",
    "end": "1843559"
  },
  {
    "text": "fairly nice system uh compared to a lot of others I've seen key thing is this",
    "start": "1843559",
    "end": "1850039"
  },
  {
    "text": "nxp 65 V10 chip uh this has a uh processor on there to perform the",
    "start": "1850039",
    "end": "1856600"
  },
  {
    "text": "contactless transactions and separately it also has a secure element chip in the",
    "start": "1856600",
    "end": "1861960"
  },
  {
    "text": "package so the secure element chip holds all your sensitive data so this is where you're putting on your cryptographic",
    "start": "1861960",
    "end": "1867360"
  },
  {
    "text": "keys and information um that is read by the uh contactless processor and sent to",
    "start": "1867360",
    "end": "1873399"
  },
  {
    "text": "the terminal for it and these are all controlled through uh the software",
    "start": "1873399",
    "end": "1879840"
  },
  {
    "text": "on the device so in the case of Apple pay you're going through pit to the Frameworks to the demons uh to the hard",
    "start": "1879840",
    "end": "1888000"
  },
  {
    "text": "W drivers which interact over the um I think it's an iqu C buus to the chip on",
    "start": "1888000",
    "end": "1894159"
  },
  {
    "text": "the device key thing is really that the",
    "start": "1894159",
    "end": "1901000"
  },
  {
    "text": "device here is separate in terms of how it does a transaction it operates on its",
    "start": "1901000",
    "end": "1907679"
  },
  {
    "text": "own as in the transaction all occurs in the chip once the uh once the iOS tells",
    "start": "1907679",
    "end": "1915120"
  },
  {
    "text": "it to do a transaction it'll do it by itself and send back the results and as such you find that it is",
    "start": "1915120",
    "end": "1922360"
  },
  {
    "text": "susceptible to these kind of attacks as well because the device the um apis that",
    "start": "1922360",
    "end": "1928399"
  },
  {
    "text": "I've looked at don't actually indicate any um Protections in them it's all left up to the code that is not written by",
    "start": "1928399",
    "end": "1935080"
  },
  {
    "text": "Apple uh that is actually written by nxp on those chips and that code um I think",
    "start": "1935080",
    "end": "1940279"
  },
  {
    "text": "it was developed in 2010 off the top of my head um based off the uh um sources",
    "start": "1940279",
    "end": "1947279"
  },
  {
    "text": "on the Android area so they're fairly similar in apple you've got a PK payment",
    "start": "1947279",
    "end": "1954159"
  },
  {
    "text": "token as well uh interesting thing about this is that it's a um ECC encrypted",
    "start": "1954159",
    "end": "1959799"
  },
  {
    "text": "token um and you've got EMV data in here so this is what is returned from the uh",
    "start": "1959799",
    "end": "1967519"
  },
  {
    "text": "uh secure element after a transaction um the encrypted payment data is where",
    "start": "1967519",
    "end": "1973440"
  },
  {
    "text": "you've got your token your expiry date and your EMV data and that can be sent over the internet and verified by the",
    "start": "1973440",
    "end": "1980559"
  },
  {
    "text": "issuer as well as a separate uh verification code area uh so you find",
    "start": "1980559",
    "end": "1985639"
  },
  {
    "text": "that um the once you decrypt that payment data it's actually just got EMV",
    "start": "1985639",
    "end": "1991880"
  },
  {
    "text": "tags that has responded back from the device so I was playing around I found",
    "start": "1991880",
    "end": "1997960"
  },
  {
    "text": "this is a command where you can dump the approved AIDS so these are the cards that have been loaded into your secure",
    "start": "1997960",
    "end": "2003639"
  },
  {
    "text": "element um so in this case this is the test cards that were loaded onto the device um when I bought it from the",
    "start": "2003639",
    "end": "2011960"
  },
  {
    "text": "shop thing that's better so it is vulnerable",
    "start": "2017240",
    "end": "2024240"
  },
  {
    "text": "to these attacks um it does depend on the card that's loaded so I'm pretty sure Visa debit cards aren't but other",
    "start": "2024240",
    "end": "2030880"
  },
  {
    "text": "credit cards will be because you need to have these Legacy modes um but the key thing is with the Apple pay system is",
    "start": "2030880",
    "end": "2037039"
  },
  {
    "text": "that it's really hard you need to force someone to do the transaction um you need to enable the card to do the",
    "start": "2037039",
    "end": "2042600"
  },
  {
    "text": "transaction and scan it to perform it um so just don't jailbreak your device",
    "start": "2042600",
    "end": "2049720"
  },
  {
    "text": "um if you want secure payments kind of thing additionally if you're over a",
    "start": "2049720",
    "end": "2055158"
  },
  {
    "text": "contactless limit they offer this consumer device card hollow verification method um which basically gives you a",
    "start": "2055159",
    "end": "2063040"
  },
  {
    "text": "separate method over the Internet which is in conjunction with",
    "start": "2063040",
    "end": "2069200"
  },
  {
    "text": "your traditional CVV codes so that means in magstripe mode can also use this CD",
    "start": "2069200",
    "end": "2074960"
  },
  {
    "text": "CVM um to ensure that they know that transaction's going through uh so generally Apple pay stuff I find it's a",
    "start": "2074960",
    "end": "2082638"
  },
  {
    "text": "lot more secure than your cards uh that have been um sent out to you due to the",
    "start": "2082639",
    "end": "2087960"
  },
  {
    "text": "fact the cards not always on uh so quickly I will go through tools",
    "start": "2087960",
    "end": "2094878"
  },
  {
    "text": "I used so this is a common tool the I got it off eBay um it's a great little",
    "start": "2094879",
    "end": "2100000"
  },
  {
    "text": "reader and I've written a lot of software for it um to emulate C",
    "start": "2100000",
    "end": "2105680"
  },
  {
    "text": "transactions I use the proxmark to sniff transactions and work out lower level stuff uh but generally once you start to",
    "start": "2105680",
    "end": "2113240"
  },
  {
    "text": "do the transaction area it's a lot more fiddly uh and the code for the um uh",
    "start": "2113240",
    "end": "2120040"
  },
  {
    "text": "code for the zmv and NFC payment stuff isn't really there at the",
    "start": "2120040",
    "end": "2125760"
  },
  {
    "text": "moment the best option is is an Android phone with integrated NFC um this was",
    "start": "2125760",
    "end": "2132880"
  },
  {
    "text": "really good in terms of development of this stuff because it offers the card reader and an emulator and additionally",
    "start": "2132880",
    "end": "2140599"
  },
  {
    "text": "uh you get a lot of the support for uh not having to integrate uh the initial",
    "start": "2140599",
    "end": "2147079"
  },
  {
    "text": "transaction of the card so what this gives you is the ability just to send packets uh large bits of data throw it",
    "start": "2147079",
    "end": "2153119"
  },
  {
    "text": "at the um uh at the chip in the uh Android system and that will just",
    "start": "2153119",
    "end": "2158640"
  },
  {
    "text": "emulate it out for you uh in that area uh so software developed over this",
    "start": "2158640",
    "end": "2166000"
  },
  {
    "text": "area is additions for our affidia So Adam and Lor's Tool uh these give you",
    "start": "2166000",
    "end": "2171800"
  },
  {
    "text": "the ability to do transactions and test them for yourself um so this will do a transaction for a magnetic stripe um",
    "start": "2171800",
    "end": "2179280"
  },
  {
    "text": "reader mchip DC VV and it'll spit out all the values and you can start to",
    "start": "2179280",
    "end": "2184359"
  },
  {
    "text": "check and see that the transaction counter increments or something static uh gives you all the information that",
    "start": "2184359",
    "end": "2190319"
  },
  {
    "text": "you might not get from a commercial uh uh card reader out the",
    "start": "2190319",
    "end": "2195839"
  },
  {
    "text": "box another one was a fuzzing program I've made for the um Android as well uh",
    "start": "2195839",
    "end": "2201520"
  },
  {
    "text": "don't think I've actually uploaded it yet but it works pretty well I've got it buzzing and going over and over again um",
    "start": "2201520",
    "end": "2208240"
  },
  {
    "text": "and crashing pretty well um this means that I'm kind of working on it still um",
    "start": "2208240",
    "end": "2214680"
  },
  {
    "text": "but it I'm really happy with at the moment how it's coming",
    "start": "2214680",
    "end": "2219520"
  },
  {
    "text": "out okay so finally looking through uh these areas",
    "start": "2222680",
    "end": "2230280"
  },
  {
    "text": "it really um takes into account the Legacy modes need to be removed from a lot of these systems uh I was able to",
    "start": "2230280",
    "end": "2236960"
  },
  {
    "text": "clone my own card and use it in Australia uh and that was a bit shocking to me considering how much smaller the",
    "start": "2236960",
    "end": "2244359"
  },
  {
    "text": "number of Banks and payment processes we have and the a and how long we've had EMV workflows in our payment system uh",
    "start": "2244359",
    "end": "2252280"
  },
  {
    "text": "that's why I think in the US it's uh concerning for me in that I have a gut",
    "start": "2252280",
    "end": "2258440"
  },
  {
    "text": "feeling that it's a lot more of a issue in the US due to existing technology and",
    "start": "2258440",
    "end": "2265160"
  },
  {
    "text": "the love of Mag stripes in their in the payment systems",
    "start": "2265160",
    "end": "2270599"
  },
  {
    "text": "here so best way of putting it is um key things are that you can't clone cards",
    "start": "2272440",
    "end": "2278839"
  },
  {
    "text": "economically uh but you can clone transactions uh Legacy support reduces",
    "start": "2278839",
    "end": "2285599"
  },
  {
    "text": "your security in terms of transactions um random numbers in these things aren't really random they are uh",
    "start": "2285599",
    "end": "2294119"
  },
  {
    "text": "unfortunately and the current standards do not mitigate the attack",
    "start": "2294119",
    "end": "2300119"
  },
  {
    "text": "sufficiently um my major waries are really around the terminal stuff as well um and how they basically Implement in",
    "start": "2300119",
    "end": "2307040"
  },
  {
    "text": "that area um and unfortunately though I really want to kick Apple pay but I can't um",
    "start": "2307040",
    "end": "2314680"
  },
  {
    "text": "it's one of the best methods I've seen in terms of um implementing these kind of transactions um in that it's very",
    "start": "2314680",
    "end": "2322160"
  },
  {
    "text": "widely supported uh and works excellently uh in terms of",
    "start": "2322160",
    "end": "2327200"
  },
  {
    "text": "um ease of use and generally that's what you need for that area okay so um all",
    "start": "2327200",
    "end": "2333079"
  },
  {
    "text": "good now looking for time okay okay so I think that's all",
    "start": "2333079",
    "end": "2339680"
  },
  {
    "text": "done okay so uh thank you um and does anyone have any questions",
    "start": "2339680",
    "end": "2346240"
  },
  {
    "text": "[Applause]",
    "start": "2346240",
    "end": "2354950"
  }
]