[
  {
    "text": "the CD contains the right presentation okay and the CD is also",
    "start": "8120",
    "end": "13280"
  },
  {
    "text": "again here's my contact information uh if you want to get a updated copy of the um slides from to",
    "start": "13280",
    "end": "20680"
  },
  {
    "text": "from earlier today and from right now as well as some of the demonstrations that that I'm going through then you can go out to this website for those of you",
    "start": "20680",
    "end": "26320"
  },
  {
    "text": "that have the wireless links you can it's not that big it'll be down done downloading before the end of the",
    "start": "26320",
    "end": "31519"
  },
  {
    "text": "presentation okay so um but yes we do know and I have informed Jeff of the",
    "start": "31519",
    "end": "36680"
  },
  {
    "text": "issue with the printing and that will be rectified as soon as we're done today I'm going to email a copy of the the",
    "start": "36680",
    "end": "42399"
  },
  {
    "text": "presentations to Jeff and make sure those get put up on the black hat site are the tools available there also uh",
    "start": "42399",
    "end": "49079"
  },
  {
    "text": "the question was are the tools available now the Pearl scripts that I wrote that I'm using in the demonstrations yes those are available the other tools",
    "start": "49079",
    "end": "55879"
  },
  {
    "text": "since they're available at the CIS inter internal side or they're available at foundstone or available on the resource kit uh I'm not going to include those",
    "start": "55879",
    "end": "62199"
  },
  {
    "text": "and the reason being is it just makes the zip archive a little smaller a little easier to download and you know most of us know where the tools are",
    "start": "62199",
    "end": "69720"
  },
  {
    "text": "anyway okay again that's updated slides and demos now the purpose of this",
    "start": "69720",
    "end": "76200"
  },
  {
    "text": "presentation is to discuss different ways of hiding data I know what the title says and you know to be honest",
    "start": "76200",
    "end": "82360"
  },
  {
    "text": "that's not what I you know I I didn't even originally attend to approach that I'm going to talk about ways you can",
    "start": "82360",
    "end": "87720"
  },
  {
    "text": "hide data on the system I'm also going to talk about ways you can detect this activity okay but what I'm not going to",
    "start": "87720",
    "end": "94360"
  },
  {
    "text": "talk about is hiding data in slack I'm not going to talk about hiding data in boot sectors I'm not going to talk about",
    "start": "94360",
    "end": "100280"
  },
  {
    "text": "maintenance record maintenance tracks on a drive I'm not going to go into that I'm",
    "start": "100280",
    "end": "106600"
  },
  {
    "text": "just predominantly NTFS because actually that's where about",
    "start": "106600",
    "end": "112119"
  },
  {
    "text": "half the presentation comes from is the NTFS file system and what's being hidden what are",
    "start": "112119",
    "end": "118600"
  },
  {
    "text": "we going to hide what kind of data are we going to hide you can hide text output you can hide commands you can",
    "start": "118600",
    "end": "124360"
  },
  {
    "text": "hide binaries you can hide images uh any sequence of ones and",
    "start": "124360",
    "end": "131000"
  },
  {
    "text": "zeros you want to hide some programs um for instance if you have a system that",
    "start": "131000",
    "end": "136040"
  },
  {
    "text": "several people might be using and this might be applic applicable at home you might want to use some of these these",
    "start": "136040",
    "end": "141599"
  },
  {
    "text": "techniques to hide the data from you know those teenage kids that you've got",
    "start": "141599",
    "end": "147000"
  },
  {
    "text": "those curious kids and want to know hey what what happens with this or if you notice your son comes walking in from",
    "start": "147000",
    "end": "152360"
  },
  {
    "text": "school or your daughter even with a latest copy of 2600 you might want to take a look at some of these",
    "start": "152360",
    "end": "158519"
  },
  {
    "text": "techniques also hiding games that sort of thing root kits okay who are we hiding it",
    "start": "158519",
    "end": "166599"
  },
  {
    "text": "from you can hide data from the users not too difficult hide data from",
    "start": "166599",
    "end": "172560"
  },
  {
    "text": "an administrator again really that that's really not too difficult and",
    "start": "172560",
    "end": "178280"
  },
  {
    "text": "that's not a disparaging comment to the system administrators it's just a lot of people aren't familiar with some of",
    "start": "178280",
    "end": "183360"
  },
  {
    "text": "these techniques and some of these techniques I'm going to be talking about are as old as Doss itself some people just aren't familiar",
    "start": "183360",
    "end": "190159"
  },
  {
    "text": "with it and and ultimately uh in the case that somebody may choose to do so hide the data or obscure it from an",
    "start": "190159",
    "end": "197640"
  },
  {
    "text": "investigator or a forensics analyst and there are ways that you can go about doing this and again I want to reiterate",
    "start": "197640",
    "end": "205159"
  },
  {
    "text": "I'm not just presenting this information as a how-to even though it is that it is in fact a how-to I'm also going to be",
    "start": "205159",
    "end": "210840"
  },
  {
    "text": "presenting ways that you can detect this type of activity and one of the simplest ways to hide some data is to Simply change the",
    "start": "210840",
    "end": "217799"
  },
  {
    "text": "file name that's it change the location on the file system change the file name",
    "start": "217799",
    "end": "224599"
  },
  {
    "text": "change the file extension that's pretty simple somebody wants to do a search of the hard drive",
    "start": "224599",
    "end": "230000"
  },
  {
    "text": "of all the jpeg images or all the uh mpegs or MP3s or Avis or whatever the",
    "start": "230000",
    "end": "235640"
  },
  {
    "text": "case may be change the file SE file extension and it's not picked up and however the search is is configured it's",
    "start": "235640",
    "end": "243319"
  },
  {
    "text": "pretty simple also uh we're going to talk about file signatures now this",
    "start": "243319",
    "end": "248360"
  },
  {
    "text": "isn't this actually has to do with the data in the file and it's not necessarily associated with the file name or the file extension everybody",
    "start": "248360",
    "end": "256040"
  },
  {
    "text": "everybody's familiar in here with the fact that file extension information and what Associated programs are maintained",
    "start": "256040",
    "end": "262800"
  },
  {
    "text": "in the registry right so when you double click on an on a particular file based",
    "start": "262800",
    "end": "268360"
  },
  {
    "text": "on its extension there's an ex utable that might be associated with it",
    "start": "268360",
    "end": "273600"
  },
  {
    "text": "okay just a quick example you want to run uh Sam dump PW dump uh the output of",
    "start": "273600",
    "end": "281240"
  },
  {
    "text": "Loft crack whatever the case may be you create a file you move it to a place where it might not be noticed into the",
    "start": "281240",
    "end": "287720"
  },
  {
    "text": "system 32 directory which is full of these little files or big files called",
    "start": "287720",
    "end": "292759"
  },
  {
    "text": "dlls nobody likes to touch those they're just there yeah they're very useful for the",
    "start": "292759",
    "end": "298120"
  },
  {
    "text": "system they're required for the operation of the system but no not very many people want",
    "start": "298120",
    "end": "303639"
  },
  {
    "text": "to go opening up one in a hex editor change the change the file name to Ms odbc 32.dll fairly innocuous kind",
    "start": "303639",
    "end": "311840"
  },
  {
    "text": "of makes sense kind of makes sense that it's part of the system so you know somebody might not want to Al go looking",
    "start": "311840",
    "end": "317520"
  },
  {
    "text": "at it altering the file signature according to the Microsoft website the file signature is defined as uh a",
    "start": "317520",
    "end": "324520"
  },
  {
    "text": "particular string or particular sequence of information that's stored in the first 20 bytes of the file now this is",
    "start": "324520",
    "end": "330800"
  },
  {
    "text": "this is the technique that's used by ENC case the forensics tool as well when it does its file signature analysis it",
    "start": "330800",
    "end": "337919"
  },
  {
    "text": "looks at information in the first 20 bytes of the file and the reason it's in the first 20 bytes is it's it's variable",
    "start": "337919",
    "end": "343639"
  },
  {
    "text": "as to where it actually occurs for instance in an executable file most",
    "start": "343639",
    "end": "348880"
  },
  {
    "text": "often not always but most often the first two characters of an executable",
    "start": "348880",
    "end": "355039"
  },
  {
    "text": "file are cap M cap Z just for those of you that have your",
    "start": "355039",
    "end": "360520"
  },
  {
    "text": "computers open right now just use notepad to open up a dll or exe",
    "start": "360520",
    "end": "366319"
  },
  {
    "text": "file okay and the reason I say most often is because it's not always the first two but it's always cap M cap Z",
    "start": "366319",
    "end": "373560"
  },
  {
    "text": "that denotes an executable file if you get something that's got a dll extension or if you've got something",
    "start": "373560",
    "end": "380240"
  },
  {
    "text": "that's a uh aexe extension and it does not contain MZ in the first couple bytes of the file it is not in",
    "start": "380240",
    "end": "387479"
  },
  {
    "text": "executable uh jpegs and gifts a JPEG has the characters cap",
    "start": "387479",
    "end": "394360"
  },
  {
    "text": "jfi in that space in the first 20 bytes of the file that's what defines a JPEG",
    "start": "394360",
    "end": "399520"
  },
  {
    "text": "file uh GIF images have G 89A or 87a",
    "start": "399520",
    "end": "405960"
  },
  {
    "text": "depending on you know which uh which version um one of the uh scripts",
    "start": "405960",
    "end": "411960"
  },
  {
    "text": "available on my website and I'll be demonstrating today one of the Pearl scripts um is actually a file that",
    "start": "411960",
    "end": "417560"
  },
  {
    "text": "performs signature analysis and I stated this before but for those of you that weren't here for the first half of the presentation I like to use Pearl it's a",
    "start": "417560",
    "end": "424639"
  },
  {
    "text": "very quick very uh very quick language for prototyping certain things and uh",
    "start": "424639",
    "end": "430199"
  },
  {
    "text": "for you know for people like me that like to make it clear as to what's going on and document it and everything it's usually fairly easy to understand what's",
    "start": "430199",
    "end": "436560"
  },
  {
    "text": "going on through the process so a lot of these tools that I write you know for my own use or",
    "start": "436560",
    "end": "442120"
  },
  {
    "text": "whatever I will Prototype them in Pearl so that other people can see what's going on and you know post them on the",
    "start": "442120",
    "end": "447479"
  },
  {
    "text": "web maybe somebody can you know either do it better or or use the tool dos attributes believe it or not",
    "start": "447479",
    "end": "454199"
  },
  {
    "text": "this still works setting the hidden bit with the Atri command still works for hiding data",
    "start": "454199",
    "end": "462599"
  },
  {
    "text": "from not just unsuspecting users but perhaps even from unsuspecting administrators who aren't necessarily",
    "start": "462599",
    "end": "467919"
  },
  {
    "text": "looking for hidden information so using the Atri command you can set or unset that that bit or",
    "start": "467919",
    "end": "475960"
  },
  {
    "text": "that attribute there are setting that you can use in explore that will show you hidden",
    "start": "475960",
    "end": "482319"
  },
  {
    "text": "files there's a switch with the dir command that will show you hidden files",
    "start": "482319",
    "end": "488039"
  },
  {
    "text": "or directories but it's not in there by default you have to actually add that switch",
    "start": "488039",
    "end": "493360"
  },
  {
    "text": "in if you want to like as we talked about in the previous uh presentation if you want to see what what different",
    "start": "493360",
    "end": "499720"
  },
  {
    "text": "switches are associated with the command just type the command follow with for question mark and most often you'll get",
    "start": "499720",
    "end": "505280"
  },
  {
    "text": "some syntax information now some of the functions of pearl like opener read dur and glob it completely ignore dos",
    "start": "505280",
    "end": "512640"
  },
  {
    "text": "attributes so if you use uh a pearl program or if part of what your Pearl program does is open up a directory and",
    "start": "512640",
    "end": "518518"
  },
  {
    "text": "read all the files in it you're going to get every file or every subdirectory listed in there regardless of the fact that it's got a hidden attribute set and",
    "start": "518519",
    "end": "525480"
  },
  {
    "text": "also HF find. exe from the foundstone website will help you find hidden",
    "start": "525480",
    "end": "531839"
  },
  {
    "text": "files but again it's not difficult to to hide a file file splitting this is",
    "start": "531839",
    "end": "537320"
  },
  {
    "text": "something that's um it's not knew at all it's actually been around for quite a long time um since almost the beginnings",
    "start": "537320",
    "end": "544000"
  },
  {
    "text": "of Doss sometimes you'll get a file that's a certain size and it's much bigger than a diset and you want to get it off the",
    "start": "544000",
    "end": "550320"
  },
  {
    "text": "system and you know if you don't have a cdrom burner in it you want to get that file off the system it's not networked",
    "start": "550320",
    "end": "555680"
  },
  {
    "text": "then what you can do is use a file splitter and create segments to that file decompose that file into arbitrary",
    "start": "555680",
    "end": "563000"
  },
  {
    "text": "size segments now when you had when when we originally",
    "start": "563000",
    "end": "568320"
  },
  {
    "text": "had Doss those were mostly command line utilities then as we moved into Windows",
    "start": "568320",
    "end": "574240"
  },
  {
    "text": "95 a lot of that functionality was moved into the shell PR programming so now you can rightclick and you can say you know",
    "start": "574240",
    "end": "580040"
  },
  {
    "text": "I want to split the file depending on what what application you load on your system however like most system",
    "start": "580040",
    "end": "588720"
  },
  {
    "text": "administrator administrator are root utilities that are very functional to the administrator they're also very",
    "start": "588720",
    "end": "594279"
  },
  {
    "text": "functional to the attacker and you can use this uh file splitting technique in combination with",
    "start": "594279",
    "end": "600800"
  },
  {
    "text": "other techniques we're going to look at you can use it for malicious purposes to effectively hide data okay this is",
    "start": "600800",
    "end": "607200"
  },
  {
    "text": "basically a little quick graphic uh just to kind of break up the monotony of continual text slides to kind of show",
    "start": "607200",
    "end": "613000"
  },
  {
    "text": "you what the file splitting looks like now a lot of this stuff um there's no arbitrary set size you can set you can",
    "start": "613000",
    "end": "620120"
  },
  {
    "text": "have a 50k file that you break up into segments of 2K or 5K or just split it in",
    "start": "620120",
    "end": "625279"
  },
  {
    "text": "half based on the file size it's really totally up to you now what you do with it after it's split is also up to",
    "start": "625279",
    "end": "634720"
  },
  {
    "text": "you now for those of you in here that do penetration testing some of this you might be familiar with this you might already use it or you might find it",
    "start": "634720",
    "end": "641959"
  },
  {
    "text": "useful it's an interesting way to to hide some utilities depending on uh where you put the information who in",
    "start": "641959",
    "end": "648560"
  },
  {
    "text": "here is familiar with the touch utility on Unix familiar with touch good okay",
    "start": "648560",
    "end": "655320"
  },
  {
    "text": "the Microsoft API provides for this functionality",
    "start": "655320",
    "end": "660720"
  },
  {
    "text": "now it's not used very often and there are touch utilities out there however most of the executable touch utilities",
    "start": "660720",
    "end": "667440"
  },
  {
    "text": "the exe files that I've come across will only modify the last access and the last",
    "start": "667440",
    "end": "673519"
  },
  {
    "text": "modification times I'm going to show you a demonstration where we can also modify",
    "start": "673519",
    "end": "679720"
  },
  {
    "text": "the creation date as well remember we're talking about hiding data from a whole spectrum of",
    "start": "679720",
    "end": "687519"
  },
  {
    "text": "people when forensics analysts make a bit level copy of the drive one of the things not the only",
    "start": "687519",
    "end": "694880"
  },
  {
    "text": "thing but one of the things they will look for is a timeline of activity if a malicious user",
    "start": "694880",
    "end": "702480"
  },
  {
    "text": "say somebody's got pornography just as an example or security tools like a",
    "start": "702480",
    "end": "708959"
  },
  {
    "text": "sniffer if they can modify the last access time to a date when they weren't",
    "start": "708959",
    "end": "714519"
  },
  {
    "text": "even in the building when they were not even at work say you take a twoe vacation and you modify the last access",
    "start": "714519",
    "end": "720399"
  },
  {
    "text": "time of the file to when you were on vacation the fact that you on vacation that time is documented by the company",
    "start": "720399",
    "end": "727800"
  },
  {
    "text": "the fact that you didn't log on for those two weeks is also should also be documented by the company if they've got the right auditing turned on it may even",
    "start": "727800",
    "end": "734120"
  },
  {
    "text": "be documented on your machine depending on what loads and what's written to the event log when you boot your",
    "start": "734120",
    "end": "739199"
  },
  {
    "text": "machine now imagine what that can do to a forensics",
    "start": "739199",
    "end": "744759"
  },
  {
    "text": "investigation or an instant response investigation this hides the this hides activity from",
    "start": "746199",
    "end": "752560"
  },
  {
    "text": "the use of the dir command and it will also hide the activity because you change the times from the aind command",
    "start": "752560",
    "end": "758959"
  },
  {
    "text": "which is a tool written uh by JD Glazer from foundstone that looks for the last access times uh JD's got a very good",
    "start": "758959",
    "end": "765760"
  },
  {
    "text": "presentation from uh one of the black cats I think 2000 where somebody had broken into one of his boxes via an",
    "start": "765760",
    "end": "772160"
  },
  {
    "text": "exploit in imil and one of the first things he did as as he related in the presentation was look for the last",
    "start": "772160",
    "end": "778320"
  },
  {
    "text": "access time on the file cmd.exe and that last access time was about 2 o'clock in",
    "start": "778320",
    "end": "783639"
  },
  {
    "text": "the morning and he knew he wasn't there so based on that information alone he had plenty to go on at least to get",
    "start": "783639",
    "end": "790600"
  },
  {
    "text": "started to look for what happened in that incident and like I said he gave this in a presentation you can find that",
    "start": "790600",
    "end": "796839"
  },
  {
    "text": "presentation under the uh the black hat archives I believe it's uh I believe it's 2000 um I don't remember the exact title",
    "start": "796839",
    "end": "806480"
  },
  {
    "text": "this is an interesting functionality file bind finding who remembers wack-a-mole",
    "start": "806480",
    "end": "813240"
  },
  {
    "text": "remember remember getting hit by wack-a-mole you know kind of greats on your nerves you're walking up and down",
    "start": "813240",
    "end": "818560"
  },
  {
    "text": "the cube Farm or maybe going along a row of offices and you see people playing wack-a-mole",
    "start": "818560",
    "end": "823880"
  },
  {
    "text": "well as far as I understood anyway file binding was used there's plenty of utilities out there to do file",
    "start": "824079",
    "end": "830320"
  },
  {
    "text": "binding bind a illegitimate or malicious file to a legitimate supposedly",
    "start": "830320",
    "end": "837279"
  },
  {
    "text": "legitimate file in the ex uh you know a game uh a legitimate file",
    "start": "837279",
    "end": "844680"
  },
  {
    "text": "that you know some user is going to double click on and it's going to execute it's also going to execute the other files uh utilities like Elite wrap",
    "start": "844680",
    "end": "853279"
  },
  {
    "text": "uh Saran Wrap and silk rope are actually associated with the B2K when that came out for binding",
    "start": "853279",
    "end": "860040"
  },
  {
    "text": "different files together this is another way of hiding data um now this is something that I",
    "start": "860040",
    "end": "865880"
  },
  {
    "text": "have to be honest with you I really haven't done a lot of research into because uh the the Comm API for Microsoft scares me",
    "start": "865880",
    "end": "873000"
  },
  {
    "text": "and I don't really want to get I'm afraid to know that much about Microsoft and especially the API but",
    "start": "873000",
    "end": "879759"
  },
  {
    "text": "according to the msdn um this is defined as structured storage or compound files or more",
    "start": "879759",
    "end": "886000"
  },
  {
    "text": "Loosely a file system within the file now the information from the Microsoft site says this is predominantly used in",
    "start": "886000",
    "end": "893079"
  },
  {
    "text": "Word documents and it's also used in Excel documents however this this do not",
    "start": "893079",
    "end": "899600"
  },
  {
    "text": "prevent uh somebody knowledgeable of com programming from using it that also",
    "start": "899600",
    "end": "905720"
  },
  {
    "text": "presents some interesting opportunities because if anybody's done any Java programming anybody done Java programming anybody buer buer okay um",
    "start": "905720",
    "end": "915600"
  },
  {
    "text": "Java has a serialization uh some program programming languages Pearl has something similar to this where you can",
    "start": "915600",
    "end": "921880"
  },
  {
    "text": "create an object and serialize it into basically just a stream of bits and using the right API you can reassemble",
    "start": "921880",
    "end": "927920"
  },
  {
    "text": "it at a later date that presents a lot of opportunities for proprietary formats something you define",
    "start": "927920",
    "end": "934839"
  },
  {
    "text": "yourself so if you're targeting if you're say a penetration tester and you're targeting a specific type of",
    "start": "934839",
    "end": "941120"
  },
  {
    "text": "platform you know you you have your toolkit you have the tools that you use if you specialize in say penetrating",
    "start": "941120",
    "end": "946680"
  },
  {
    "text": "Windows 2K systems or IIs systems you'll have you nice little CD full of tools well you might also have that little",
    "start": "946680",
    "end": "952480"
  },
  {
    "text": "root kit or that little uh hacker kit that you've got once you get in you copy",
    "start": "952480",
    "end": "957519"
  },
  {
    "text": "your your tools over and you you progress on from there is using that system as a stepping stone well you might want to use something like this um",
    "start": "957519",
    "end": "965199"
  },
  {
    "text": "uh to further your efforts ah one of my personal favorites",
    "start": "965199",
    "end": "971639"
  },
  {
    "text": "NTFS alternate data streams is anybody familiar with these everybody knows everybody knows all about them right",
    "start": "971639",
    "end": "977800"
  },
  {
    "text": "okay NTFS alternate yeah I see Cory over there smiling he's heard this one before NTFS alternate data streams are a",
    "start": "977800",
    "end": "985639"
  },
  {
    "text": "feature of NTFS the original intent was to support the Macintosh hierarchal file",
    "start": "985639",
    "end": "993000"
  },
  {
    "text": "system uh the micros the Macintosh HFS allows for the storage of information in",
    "start": "993000",
    "end": "998240"
  },
  {
    "text": "in different streams so on the Windows systems in order to support the HFS we have this thing called alternate data",
    "start": "998240",
    "end": "1004040"
  },
  {
    "text": "streams and what this does if we have a u what's referred to as a default or",
    "start": "1004040",
    "end": "1009800"
  },
  {
    "text": "unnamed stream and this is basically my file. text or kernel32.dll or",
    "start": "1009800",
    "end": "1016399"
  },
  {
    "text": "winword.exe we can actually append",
    "start": "1016399",
    "end": "1022319"
  },
  {
    "text": "additional alternate streams to that file if you're familiar with how the",
    "start": "1022319",
    "end": "1028798"
  },
  {
    "text": "information on a particular file is stored in the mft there's different attributes in",
    "start": "1028799",
    "end": "1034038"
  },
  {
    "text": "there and one of the attributes will point to um the place on the hard drive",
    "start": "1034039",
    "end": "1039319"
  },
  {
    "text": "the physical address on the hard drive to the beginning of that file and you can actually have multiple versions of",
    "start": "1039319",
    "end": "1044918"
  },
  {
    "text": "that so you will have the default unnamed stream and then you will have alternate stream all associated with",
    "start": "1044919",
    "end": "1050039"
  },
  {
    "text": "that file but the interesting thing is Microsoft does not provide you with any",
    "start": "1050039",
    "end": "1055880"
  },
  {
    "text": "utilities to view these not an Explorer not in dir not from the command",
    "start": "1055880",
    "end": "1064320"
  },
  {
    "text": "prompt provides an excellent opportunity for somebody with malicious",
    "start": "1064320",
    "end": "1069799"
  },
  {
    "text": "intent to hide something from administrators fairly simple to do now",
    "start": "1069799",
    "end": "1074919"
  },
  {
    "text": "recently in the past two years or so there have been a lot of utilities that come out but again you have to go to",
    "start": "1074919",
    "end": "1080480"
  },
  {
    "text": "another site whether it's uh ht. de it's h y s",
    "start": "1080480",
    "end": "1086120"
  },
  {
    "text": "f.de um that's one of the better tools that I prefer to use foundstone has got a tool called sind in their forensics",
    "start": "1086120",
    "end": "1093799"
  },
  {
    "text": "toolkit so if you go looking for sind you won't find it you have to find the forensics toolkit uh CIS internals has",
    "start": "1093799",
    "end": "1100960"
  },
  {
    "text": "streams. exe and there's a company called crucial",
    "start": "1100960",
    "end": "1106240"
  },
  {
    "text": "security all one word crucial security and they have a free download that's actually a nice little gooey tool and",
    "start": "1106240",
    "end": "1113520"
  },
  {
    "text": "it's it's good to use on the local box you know but if you're doing incident response you might want to have something that spits its output to",
    "start": "1113520",
    "end": "1118559"
  },
  {
    "text": "standard output um so you don't have to to save a file to the local system now the interesting thing about this is not",
    "start": "1118559",
    "end": "1124280"
  },
  {
    "text": "only can you hide stuff in it but you can hide executables and then you can launch",
    "start": "1124280",
    "end": "1129840"
  },
  {
    "text": "those executables from within the alternate data stream about a month ago",
    "start": "1129840",
    "end": "1136080"
  },
  {
    "text": "I found a site I found a page on the web um it really wasn't associated with any sort of computer security or anything",
    "start": "1136080",
    "end": "1142039"
  },
  {
    "text": "like that it was just like an informational page and it said in order to run executables hidden in alternate data streams you have to first copy that",
    "start": "1142039",
    "end": "1149679"
  },
  {
    "text": "executable out of the alternate data stream into a temporary file this is incorrect you do not have to do that you",
    "start": "1149679",
    "end": "1156799"
  },
  {
    "text": "can actually launch it and we're going to talk about uh",
    "start": "1156799",
    "end": "1163679"
  },
  {
    "text": "briefly some differences between NTFS 4 and NTFS 5 a little bit more about creating alternate data streams at the",
    "start": "1163679",
    "end": "1169880"
  },
  {
    "text": "end of this presentation we're actually just like the last presentation we're going to go through some demonstrations those of you with your systems here can",
    "start": "1169880",
    "end": "1175640"
  },
  {
    "text": "follow along and follow along on the screen and we'll walk through some different techniques for alternate data streams I've got a couple other demos to",
    "start": "1175640",
    "end": "1181919"
  },
  {
    "text": "show but uh the alternate data streams are really kind of pretty cool uh the First Command here uh that you can use",
    "start": "1181919",
    "end": "1188360"
  },
  {
    "text": "is simply type you know uh I don't have the full path for notepad you'll need to use that but this is one way of creating",
    "start": "1188360",
    "end": "1194559"
  },
  {
    "text": "an alternate data stream the type command that's it",
    "start": "1194559",
    "end": "1200159"
  },
  {
    "text": "now you can use uh cat or CP or C cp. exe from the resource kit to create",
    "start": "1200159",
    "end": "1207640"
  },
  {
    "text": "alternate data streams move and",
    "start": "1207640",
    "end": "1212840"
  },
  {
    "text": "copy commands that are on your system if you move or copy a file from one",
    "start": "1212840",
    "end": "1219039"
  },
  {
    "text": "partition to another or from One Directory to another the alternate data stream will go along with it as long as",
    "start": "1219039",
    "end": "1225280"
  },
  {
    "text": "it's NTFS ftping from a Microsoft system to",
    "start": "1225280",
    "end": "1230559"
  },
  {
    "text": "another Microsoft system will not preserve the alternate data streams in fact one way to get rid of alternate data streams is to copy the file itself",
    "start": "1230559",
    "end": "1238720"
  },
  {
    "text": "to a disparate operating system or a dispar file system that's one way um you can not",
    "start": "1238720",
    "end": "1246840"
  },
  {
    "text": "only bind to a file but you can also bind to just a straight directory",
    "start": "1246840",
    "end": "1252760"
  },
  {
    "text": "listing you can associate an alternate data stream or a series of alternate data streams with the directory listing",
    "start": "1252760",
    "end": "1258440"
  },
  {
    "text": "and and because these are not necessarily or these cannot be viewed with the default tools on the system",
    "start": "1258440",
    "end": "1264200"
  },
  {
    "text": "they provide a great Avenue for not only administrators hiding things from uh uh from users or from other administrators",
    "start": "1264200",
    "end": "1271240"
  },
  {
    "text": "as the case may be but it also provides an opportunity for malicious use for instance just simply copying a 300K dll",
    "start": "1271240",
    "end": "1277760"
  },
  {
    "text": "over and over and over into into alternate data streams until the file system is",
    "start": "1277760",
    "end": "1282760"
  },
  {
    "text": "full now being an exchange administrator I understand this has a uh very negative effect on Exchange",
    "start": "1285240",
    "end": "1291039"
  },
  {
    "text": "machines okay executing alternate data streams again you do not have to copy",
    "start": "1291039",
    "end": "1297760"
  },
  {
    "text": "the executable out of the alternate data stream in order to run it you run it right from within the alternate data stream now for NTFS 4 those of for those",
    "start": "1297760",
    "end": "1306480"
  },
  {
    "text": "of you familiar with hacking exposed you know I'm I'm big proponent for giving credit where credit is due you know I",
    "start": "1306480",
    "end": "1311840"
  },
  {
    "text": "did not come up with any of this stuff I'm presenting the information the foundstone guys uh with",
    "start": "1311840",
    "end": "1318360"
  },
  {
    "text": "the the first edition of hacking exposed when they talked about streams on NTFS 4 which is basically NT",
    "start": "1318360",
    "end": "1324159"
  },
  {
    "text": "4.0 they have they showed way to execute executables hiding in alternate data",
    "start": "1324159",
    "end": "1330000"
  },
  {
    "text": "streams and that's simply with a start command you you can't just type it at the command prompt but if you type the",
    "start": "1330000",
    "end": "1335480"
  },
  {
    "text": "start command or use the start command you know you can launch those executables now uh zenin",
    "start": "1335480",
    "end": "1343640"
  },
  {
    "text": "and kasperski I'm not even going to I apologize for any Mis mispronunciation of that name um have an article out on",
    "start": "1343640",
    "end": "1350960"
  },
  {
    "text": "the web that lists five five ways to launch executables and VBS scripts from",
    "start": "1350960",
    "end": "1358840"
  },
  {
    "text": "within alternate data streams five different ways so as we",
    "start": "1358840",
    "end": "1365000"
  },
  {
    "text": "progress from NT to 2000 we see well we got this thing that works over here on NT but now we also have more native",
    "start": "1365000",
    "end": "1370799"
  },
  {
    "text": "tools available to us on Windows 2000 so that provides us with greater opportunity to launch some of these",
    "start": "1370799",
    "end": "1376120"
  },
  {
    "text": "things so if you have Administration Scripts if you're you know you like to write scripts in",
    "start": "1376120",
    "end": "1381360"
  },
  {
    "text": "VBS you know hide them in an alternate data stream they're not going to be readily found now the key though to",
    "start": "1381360",
    "end": "1386799"
  },
  {
    "text": "running them is you have to know that they're there and you have to know the name mistype the name it's not going to",
    "start": "1386799",
    "end": "1392520"
  },
  {
    "text": "execute properly now detecting alternate data streams again one of my favorite tools is Lads by Frank Hine we also have",
    "start": "1392520",
    "end": "1400360"
  },
  {
    "text": "sind streams and uh there's a pearl script that I modified uh from Dave",
    "start": "1400360",
    "end": "1405799"
  },
  {
    "text": "Roth's second book uh the reason I modified it is because it only detected alternate data streams associated with",
    "start": "1405799",
    "end": "1412279"
  },
  {
    "text": "files but again you can associate alternate data streams with directory listings",
    "start": "1412279",
    "end": "1418760"
  },
  {
    "text": "okay at this point do we have any questions about alternate data streams you know I I haven't done any",
    "start": "1418760",
    "end": "1424559"
  },
  {
    "text": "exhaustive testing of these for instance I haven't done every possible test I have looked at",
    "start": "1424559",
    "end": "1430240"
  },
  {
    "text": "ftping I have looked at creating an alternate data stream associated with a gif file on an IIs web server with NTFS",
    "start": "1430240",
    "end": "1437520"
  },
  {
    "text": "and then attaching with my browser and downloading the file I've tried that I've tried a couple of the different",
    "start": "1437520",
    "end": "1443600"
  },
  {
    "text": "antivirus tools none of which have actually successfully accessed alternate data",
    "start": "1443600",
    "end": "1448880"
  },
  {
    "text": "streams okay so the you know these are just some of the big questions now I I haven't tried every single possible anti",
    "start": "1448880",
    "end": "1454520"
  },
  {
    "text": "virus tool that's out there I have heard that",
    "start": "1454520",
    "end": "1459919"
  },
  {
    "text": "tripwire for NT in 2000 systems will actually look at alternate data streams hey not bad",
    "start": "1459919",
    "end": "1469158"
  },
  {
    "text": "can't verify it but I I've heard that encryption this is another way of hiding data um usually with tools like pgp",
    "start": "1470039",
    "end": "1476679"
  },
  {
    "text": "there's a big footprint on the system though because they have pgp okay um f Crypt from the anse",
    "start": "1476679",
    "end": "1483760"
  },
  {
    "text": "security. website it's a nice little utility it'll just encrypt the file of course we have the EFS file",
    "start": "1483760",
    "end": "1492840"
  },
  {
    "text": "system we also have some uh utilities available to Pearl uh particularly the Crypt uh triple d triple Dez module this",
    "start": "1493039",
    "end": "1501679"
  },
  {
    "text": "is actually a per module it runs on N uh and 2000 as well as the Linux and Unix",
    "start": "1501679",
    "end": "1506799"
  },
  {
    "text": "operating systems uh it will just take an arbitrarily length or arbitrarily length uh sized segment and just encrypt",
    "start": "1506799",
    "end": "1514279"
  },
  {
    "text": "it you give it a passphrase it encrypts it and you give the pass phrase again",
    "start": "1514279",
    "end": "1519480"
  },
  {
    "text": "you can decrypt it it's very simple very straightforward we use that one of the demonstrations it does take a few",
    "start": "1519480",
    "end": "1525080"
  },
  {
    "text": "minutes or a few seconds to run through depending on the size of the file it may may not be something you want to use but",
    "start": "1525080",
    "end": "1530159"
  },
  {
    "text": "you know if you're using it as something that's operating behind the scenes under the covers then the fact that it takes a",
    "start": "1530159",
    "end": "1535320"
  },
  {
    "text": "second or two really you know may not make such a huge difference but the neat",
    "start": "1535320",
    "end": "1540440"
  },
  {
    "text": "thing about this is is that somebody can use this and because the p phrase is something you can enter in at the",
    "start": "1540440",
    "end": "1545520"
  },
  {
    "text": "command prompt or you can have hidden in your program someplace then um you know",
    "start": "1545520",
    "end": "1550919"
  },
  {
    "text": "obviously you wouldn't be you know you you wouldn't be using a pearl script to try to hide that but the actual pass phrase doesn't need",
    "start": "1550919",
    "end": "1558399"
  },
  {
    "text": "to be on the system at all it could be in your memory uh there's a variety of ways to get the pass phrase uh you can",
    "start": "1558399",
    "end": "1565279"
  },
  {
    "text": "run one of the things that I thought of was uh go out to the web grab a particular file like a gift file and do",
    "start": "1565279",
    "end": "1572520"
  },
  {
    "text": "an md5 check sum on that and use that check some as your passphrase and you can automate",
    "start": "1572520",
    "end": "1578399"
  },
  {
    "text": "that so I I guess that if you find something that might have been encrypted this way or somebody says was encrypted",
    "start": "1578399",
    "end": "1584320"
  },
  {
    "text": "this way if you've read uh applied cryptography from Bruce schne I I think probably the only only way to",
    "start": "1584320",
    "end": "1590640"
  },
  {
    "text": "get that information is the rubber hose technique that he presents pretty effective you know we",
    "start": "1590640",
    "end": "1596320"
  },
  {
    "text": "talked about public caning in the last presentation okay God tough crowd after",
    "start": "1596320",
    "end": "1602520"
  },
  {
    "text": "lunch stenography this is an interesting field I'm not going to go into a lot of detail about how it's done but there are",
    "start": "1602520",
    "end": "1608000"
  },
  {
    "text": "some interesting um steps that have been taken forward particularly by Neil provos since about 30 30th the 31st of",
    "start": "1608000",
    "end": "1614799"
  },
  {
    "text": "August of last year uh Neil's got a nice little website up up at the University of Michigan and",
    "start": "1614799",
    "end": "1621880"
  },
  {
    "text": "on that website he presents some research for instance how do you detect files that have been",
    "start": "1621880",
    "end": "1628360"
  },
  {
    "text": "stoed and basically what he came up with and you know reading his his paper was that if you know which tool was used to",
    "start": "1628360",
    "end": "1637640"
  },
  {
    "text": "stago the file and which technique was used to stago the file and if that tool",
    "start": "1637640",
    "end": "1643200"
  },
  {
    "text": "does not use efforts to infuscate the fact that there's information sto in the",
    "start": "1643200",
    "end": "1648880"
  },
  {
    "text": "file then you can determine the probability that a file was stoed you",
    "start": "1648880",
    "end": "1654240"
  },
  {
    "text": "don't necessarily find that the file was sto you've determine the probability and uh you know you have to thank Neil",
    "start": "1654240",
    "end": "1660279"
  },
  {
    "text": "because he's got that one page and then he's got you know maybe half a dozen articles on how to hide the fact you",
    "start": "1660279",
    "end": "1665960"
  },
  {
    "text": "know how do you randomize the information so it doesn't come up statistically that a file has been stoed so basically when it really comes",
    "start": "1665960",
    "end": "1673200"
  },
  {
    "text": "down to it where the rubber meets the road uh unless you know which tool the person was using because it's on the system you really can't be sure that any",
    "start": "1673200",
    "end": "1679919"
  },
  {
    "text": "file will stay good uh some tools that are useful uh and and pretty popular on the Windows",
    "start": "1679919",
    "end": "1685880"
  },
  {
    "text": "system include S tools 4 it's a very neat utility and uh one of",
    "start": "1685880",
    "end": "1691240"
  },
  {
    "text": "the benefits of it for somebody that's trying to hide data is the fact that if you take a file just a plain file and",
    "start": "1691240",
    "end": "1697279"
  },
  {
    "text": "you open it up in s tools 4 it will automatically prompt you for the P phrase whether that file was",
    "start": "1697279",
    "end": "1703640"
  },
  {
    "text": "stagered or not kind of a neat little uh little thing there it's so you just can't start",
    "start": "1703640",
    "end": "1710279"
  },
  {
    "text": "running files through it and say okay only the ones that pop up a passphrase prompt have been stego it doesn't work that way somebody took some",
    "start": "1710279",
    "end": "1717279"
  },
  {
    "text": "efforts uh registry you can hide information in the registry who like who goes and searches",
    "start": "1717279",
    "end": "1723360"
  },
  {
    "text": "for information on the uh msdn site regularly irregularly when they have to when they're forced to at gunpoint okay",
    "start": "1723360",
    "end": "1731000"
  },
  {
    "text": "um if you deal with any of the articles on there that have to do with the registry who actually reads the little",
    "start": "1731000",
    "end": "1736840"
  },
  {
    "text": "disclaimer at the beginning of the article yes and the disclaimer always says if you mess with the registry if",
    "start": "1736840",
    "end": "1742840"
  },
  {
    "text": "you do something wrong blah blah blah blah blah you'll never be able to boot your box again it's a nice little threat keeps most people out most",
    "start": "1742840",
    "end": "1750080"
  },
  {
    "text": "people anybody that really you know knows about the structure of the registry isn't really it's not the",
    "start": "1750080",
    "end": "1755880"
  },
  {
    "text": "technological mindfield that Microsoft presents it to be sometimes you know and their right to caution people because",
    "start": "1755880",
    "end": "1762279"
  },
  {
    "text": "you can not only screw up your box but if you don't do things right as far as entering the values you actually don't",
    "start": "1762279",
    "end": "1767840"
  },
  {
    "text": "get the functionality that the Q article says because if you create the key in the wrong place or you give it the wrong",
    "start": "1767840",
    "end": "1774600"
  },
  {
    "text": "value you just don't get that functionality also software installation dates uh information about software a",
    "start": "1774600",
    "end": "1781200"
  },
  {
    "text": "lot of people will say I installed this version of this tool I installed Loft crack 2.5 or I installed some unregistered",
    "start": "1781200",
    "end": "1789320"
  },
  {
    "text": "version of some tool I deleted it and when I reinstalled it it still tells me",
    "start": "1789320",
    "end": "1794679"
  },
  {
    "text": "that you know my uh eval date is is since passed so they might be storing some",
    "start": "1794679",
    "end": "1800279"
  },
  {
    "text": "information in an obscured place in the registry okay any questions so far yes",
    "start": "1800279",
    "end": "1807159"
  },
  {
    "text": "up front if a file is then it has changed so the5 check would be different",
    "start": "1807159",
    "end": "1815440"
  },
  {
    "text": "something like would find okay very good the statement not so much a question was",
    "start": "1815440",
    "end": "1821559"
  },
  {
    "text": "if a file was stoed say a graphics file for instance was stoed then the md5 check some would",
    "start": "1821559",
    "end": "1828399"
  },
  {
    "text": "change and you're absolutely right however if I open that file in a",
    "start": "1828399",
    "end": "1834840"
  },
  {
    "text": "graphics editor and I simply change the size I crop out all but the last pixel",
    "start": "1834840",
    "end": "1843000"
  },
  {
    "text": "on one side and the last pixel across the bottom I've then changed the file enough to alter the md5 check sum if I",
    "start": "1843000",
    "end": "1849840"
  },
  {
    "text": "can go into that file into that Graphics file and find a single bit a single",
    "start": "1849840",
    "end": "1855039"
  },
  {
    "text": "Pixel represented by eight bits and flip the last bit I don't do any significant",
    "start": "1855039",
    "end": "1860120"
  },
  {
    "text": "changes to the file but I have altered the md5 check sum because that's how the md5 check sum Works you're absolutely",
    "start": "1860120",
    "end": "1866399"
  },
  {
    "text": "right if the file is STO there will be changes picked up by an md5 check sum however given all the other things that",
    "start": "1866399",
    "end": "1871600"
  },
  {
    "text": "you can do to change the md5 check sum it's not conclusive but yes put it in you know put that little piece of",
    "start": "1871600",
    "end": "1877480"
  },
  {
    "text": "knowledge in the back of your brain and that's something you can have in your toolkit hidden",
    "start": "1877480",
    "end": "1885638"
  },
  {
    "text": "functionality this doesn't mean that what we've done is we've hidden something from the administrator we've",
    "start": "1885679",
    "end": "1891679"
  },
  {
    "text": "simply used functionality that the administrator is not necessarily familiar",
    "start": "1891679",
    "end": "1897760"
  },
  {
    "text": "with registry keys in the other presentation last presentation we talked about various mware and uses the what I",
    "start": "1897760",
    "end": "1905399"
  },
  {
    "text": "refer to is the ubiquitous run key okay there's another there's another uh registry key um I won't I won't you know",
    "start": "1905399",
    "end": "1913440"
  },
  {
    "text": "mention the full path because it only appears once in the registry but the name of the key is its",
    "start": "1913440",
    "end": "1918960"
  },
  {
    "text": "dll is anybody familiar with it at all okay according to the Microsoft Q",
    "start": "1918960",
    "end": "1925559"
  },
  {
    "text": "article on this particular registry key whatever dll is actually listed in this registry key and by default it's blank",
    "start": "1925559",
    "end": "1932799"
  },
  {
    "text": "but whatever dll is in there is automatically loaded into memory whenever a guy application is started",
    "start": "1932799",
    "end": "1940600"
  },
  {
    "text": "it's primarily uh as I understand it primarily used for testing purposes however",
    "start": "1940600",
    "end": "1948000"
  },
  {
    "text": "most administrators look into the registry they want to do a search what tool do they use red jedit red jedit",
    "start": "1948000",
    "end": "1955360"
  },
  {
    "text": "32 and these are guey applications so you could effectively",
    "start": "1955360",
    "end": "1960600"
  },
  {
    "text": "load a key logger into memory open up notepad notepads a",
    "start": "1960600",
    "end": "1967840"
  },
  {
    "text": "gooey so there's hidden functionality on the system autorun.inf is something that",
    "start": "1967960",
    "end": "1973679"
  },
  {
    "text": "worked on uh NT before it was patched it was great because it not only worked for CDs but it worked on local",
    "start": "1973679",
    "end": "1981240"
  },
  {
    "text": "drives when when you most people want to investigate or or look at files on a drive what do you do my computer oh",
    "start": "1981240",
    "end": "1989080"
  },
  {
    "text": "there's the icon for the C drive I'll double click on it okay how many of you actually right clicked on that icon and",
    "start": "1989080",
    "end": "1997279"
  },
  {
    "text": "saw what was in the drop- down box before it was patched which was",
    "start": "1997279",
    "end": "2002760"
  },
  {
    "text": "basically a registry change but before it was patched if you created an auto",
    "start": "2002760",
    "end": "2007919"
  },
  {
    "text": "run.in file in the root of the C drive for instance and you right clicked on the C drive after you rebooted you would",
    "start": "2007919",
    "end": "2015440"
  },
  {
    "text": "see the word auto run and it was highlighted that means that's the default",
    "start": "2015440",
    "end": "2022398"
  },
  {
    "text": "functionality okay so I can put a couple of malicious commands in there if I can",
    "start": "2022600",
    "end": "2027720"
  },
  {
    "text": "get access to the administrator's box put a couple of commands in there somebody comes over to the system",
    "start": "2027720",
    "end": "2034360"
  },
  {
    "text": "administrator logs on double clicks on the drive icon it runs whatever those commands are and the last command I put",
    "start": "2034360",
    "end": "2039840"
  },
  {
    "text": "in the file is to run intern you know to run the Explorer so they might see a slight",
    "start": "2039840",
    "end": "2045120"
  },
  {
    "text": "pause but there's the functionality they expected there's the window it's opened up",
    "start": "2045120",
    "end": "2050878"
  },
  {
    "text": "okay now when I was working uh for Telecom company I never actually saw this but I heard that one of the things",
    "start": "2050879",
    "end": "2057480"
  },
  {
    "text": "people would do if they had user access to their box was report a problem to the help desk and create an autorun INF file",
    "start": "2057480",
    "end": "2065760"
  },
  {
    "text": "in the root of the C drive so that when the help desk came came down as they were coming down they would reboot the box so help desk would come over type in",
    "start": "2065760",
    "end": "2071358"
  },
  {
    "text": "the help desk user type in their password they had administrator access to the box so I got a problem with uh my",
    "start": "2071359",
    "end": "2077560"
  },
  {
    "text": "email it's giving me some kind of warning that it can't find the yodora executable oh okay double click on the C",
    "start": "2077560",
    "end": "2083280"
  },
  {
    "text": "drive bang that person has just gotten somebody with administrator access to",
    "start": "2083280",
    "end": "2089760"
  },
  {
    "text": "add that person's user to the administrator group or done other things",
    "start": "2089760",
    "end": "2094878"
  },
  {
    "text": "loaded a Trojan whatever the case may be okay hidden functionality startup",
    "start": "2094879",
    "end": "2101320"
  },
  {
    "text": "directories are a good place to look we talked at the last presentation",
    "start": "2101320",
    "end": "2106640"
  },
  {
    "text": "when you install office on a system there's this file that's put on the",
    "start": "2106640",
    "end": "2113079"
  },
  {
    "text": "system called Fine fast and as we saw in our PS listing it was running it was you know one of the processes well it's put",
    "start": "2113079",
    "end": "2120079"
  },
  {
    "text": "in the put in one of the startup directories so if somebody malicious wanted to put a Trojan on",
    "start": "2120079",
    "end": "2128320"
  },
  {
    "text": "why make a footprint in the registry at all when all you really have to do is overwrite the fine fast",
    "start": "2128320",
    "end": "2133560"
  },
  {
    "text": "executable you know take the sub seven server call it fine fast and finally U most people familiar",
    "start": "2133560",
    "end": "2141640"
  },
  {
    "text": "with Unix are probably familiar with this and this is actually you know one of those uh one of those techniques you",
    "start": "2141640",
    "end": "2146920"
  },
  {
    "text": "can find on the kitty sites but the host's file is anybody familiar with what this",
    "start": "2146920",
    "end": "2153640"
  },
  {
    "text": "does everybody know okay this is a this is a neat way to like you know play with your kids at home or something you know",
    "start": "2153640",
    "end": "2161160"
  },
  {
    "text": "I don't necessarily recommend it at work but uh if you if you make if you edit the host file appropriately and somebody",
    "start": "2161160",
    "end": "2167359"
  },
  {
    "text": "says goes to Yahoo all the time you know the first thing they do when they come into work they type in www.yahoo.com or or Yahoo is their uh",
    "start": "2167359",
    "end": "2174160"
  },
  {
    "text": "homepage so when they open up uh you know say Netscape it opens to to Yahoo",
    "start": "2174160",
    "end": "2179760"
  },
  {
    "text": "well you go in and you put the IP address to the CNN website in there and you edit the file appropriately it'll",
    "start": "2179760",
    "end": "2185680"
  },
  {
    "text": "say Yahoo initially but it'll automatically map them over to the uh CNN",
    "start": "2185680",
    "end": "2192880"
  },
  {
    "text": "website again that's that's the type of functionality that that I'm talking about hidden functionality it's not",
    "start": "2193000",
    "end": "2198839"
  },
  {
    "text": "necessarily new but it's out there and you know people can use this stuff for",
    "start": "2198839",
    "end": "2204000"
  },
  {
    "text": "malicious purposes so it's best that the administrators and people dealing with these types of situations dealing with",
    "start": "2204000",
    "end": "2209680"
  },
  {
    "text": "these operating systems are familiar just just be familiar with the types of things that can go on out there as I",
    "start": "2209680",
    "end": "2215760"
  },
  {
    "text": "mentioned in the first presentation a lot of the forensics analysts that I talk to when uh you know they have to go",
    "start": "2215760",
    "end": "2221760"
  },
  {
    "text": "to court as an expert witness they're not really questioned so much on the tool that they used did you make a copy",
    "start": "2221760",
    "end": "2227560"
  },
  {
    "text": "with safe back did you use in case in which version no that's not the question the questions they get asked are about",
    "start": "2227560",
    "end": "2234000"
  },
  {
    "text": "methodology do you always look for alternate data streams or in the case of my client was he special something like",
    "start": "2234000",
    "end": "2242880"
  },
  {
    "text": "that okay I used to be an officient a of uh",
    "start": "2243800",
    "end": "2249079"
  },
  {
    "text": "Berkeley breathed anybody familiar with this cartoon Bloom County okay there was",
    "start": "2249079",
    "end": "2256040"
  },
  {
    "text": "actually this is actually taken from uh a 1984 uh strip I think it's four or five panels long it was a poem and I'm",
    "start": "2256040",
    "end": "2264079"
  },
  {
    "text": "not I'm not going to repeat the poem but uh this is the part that I take away from it life is fine when things",
    "start": "2264079",
    "end": "2269640"
  },
  {
    "text": "combined like like ham and beef chaming in this case and there's you take my word for it there's a rhyme there but uh",
    "start": "2269640",
    "end": "2276720"
  },
  {
    "text": "um it's interesting because if we simply combine our techniques say we want to we",
    "start": "2276720",
    "end": "2283680"
  },
  {
    "text": "do file splitting and then we do something else and then we touch the file you know we combine these",
    "start": "2283680",
    "end": "2290160"
  },
  {
    "text": "techniques and you know we ause Kate our activities even",
    "start": "2290160",
    "end": "2296640"
  },
  {
    "text": "further okay now one of the one of the demonstration we've got today it's",
    "start": "2296800",
    "end": "2302319"
  },
  {
    "text": "actually a pearl script and even though I do have it print some stuff to the standard output and the Pearl script is a available in the um in the archive and",
    "start": "2302319",
    "end": "2310760"
  },
  {
    "text": "it will also be available the zipped archive on my website it will also be available through um the blackhead",
    "start": "2310760",
    "end": "2317119"
  },
  {
    "text": "archive which I will send in to Jeff after we're done here today but the idea is I'm going to have some",
    "start": "2317119",
    "end": "2324400"
  },
  {
    "text": "information and I'm going to encrypt the data you know this is something I can do",
    "start": "2324400",
    "end": "2329640"
  },
  {
    "text": "well if it's encrypted it's just a bunch of stuff and it might not necessarily",
    "start": "2329640",
    "end": "2335960"
  },
  {
    "text": "match you know uh depending on the files the the file extension I use like a dll or something it might not necessarily",
    "start": "2335960",
    "end": "2342640"
  },
  {
    "text": "match what other dlls look like remember we said that dll start with MZ in the beginning well how do we get around that",
    "start": "2342640",
    "end": "2349720"
  },
  {
    "text": "well one way is to simply just change the first two characters change the signature okay that's fine what we have",
    "start": "2349720",
    "end": "2356000"
  },
  {
    "text": "to remember to do you know I have to remember to change that back another way to do it is to reach out to a legitimate",
    "start": "2356000",
    "end": "2362920"
  },
  {
    "text": "file and just you know a surate file like colel 32.dll and strip say the first 200 or 300 bytes",
    "start": "2362920",
    "end": "2370200"
  },
  {
    "text": "off of that and just slap it onto the front of ours okay who's really gonna keep reading after about 300",
    "start": "2370200",
    "end": "2375760"
  },
  {
    "text": "bytes you know open it up in a hex editor okay yeah yeah yeah I see the Header information uh does not run in",
    "start": "2375760",
    "end": "2382000"
  },
  {
    "text": "DOS mode blah blah blah blah blah okay now here's all this data good fine whatever nobody's really going to go",
    "start": "2382000",
    "end": "2387319"
  },
  {
    "text": "beyond that most people most people so we can combine the different",
    "start": "2387319",
    "end": "2394400"
  },
  {
    "text": "techniques if we know who we're trying to hide this from if you just want to hide it from a user H maybe a trib plus",
    "start": "2394400",
    "end": "2400880"
  },
  {
    "text": "h will work or moving it moving it to a different location not the default location or changing the path on the",
    "start": "2400880",
    "end": "2406920"
  },
  {
    "text": "system maybe that'll work you know for those of you that have systems at home and have you know you know have",
    "start": "2406920",
    "end": "2413960"
  },
  {
    "text": "these uh Teenage Sons or even teenage daughters that are coming of age and really curious about the the computer and whatnot and they're they're reading",
    "start": "2413960",
    "end": "2420119"
  },
  {
    "text": "stuff on the internet that you know might concern you if you find 2600c in your history file or something um no you",
    "start": "2420119",
    "end": "2427720"
  },
  {
    "text": "might want to use a different technique you might want to use something else or just say hey keep off my",
    "start": "2427720",
    "end": "2433880"
  },
  {
    "text": "system okay now we want to talk briefly about how we're going to detect and or prevent this type of activity from",
    "start": "2433880",
    "end": "2440599"
  },
  {
    "text": "occurring one way is we can react to it and the other way is to to basically",
    "start": "2440599",
    "end": "2446599"
  },
  {
    "text": "observe the activity going on real time now the reactive mode goes back to what we talked about in the first",
    "start": "2446599",
    "end": "2452480"
  },
  {
    "text": "presentation about preparing for an incident what do we have available to us on the system that we can use we're not",
    "start": "2452480",
    "end": "2459560"
  },
  {
    "text": "talking about you know going out and SP spending thousands of dollars for a third party tool let's use what's on the system oh we get user permissions what",
    "start": "2459560",
    "end": "2466720"
  },
  {
    "text": "is the user capable of doing we can modify those to meet our needs uh we've got sackless and dles",
    "start": "2466720",
    "end": "2473920"
  },
  {
    "text": "system access controls and discretionary access controls we can say well the user can't access anything in this directory",
    "start": "2473920",
    "end": "2479240"
  },
  {
    "text": "or the user can't write to this directory it can't create files you know",
    "start": "2479240",
    "end": "2484680"
  },
  {
    "text": "in most cases the user does need to read and execute certain you know files in certain directories just to be able to",
    "start": "2484680",
    "end": "2490440"
  },
  {
    "text": "log on know so you don't want to restrict that but you can use the daal to",
    "start": "2490440",
    "end": "2496359"
  },
  {
    "text": "restrict what they can do like create new files write to registry keys you may",
    "start": "2496359",
    "end": "2501400"
  },
  {
    "text": "even have registry keys on there that you know your testing is shown you don't even want the user to be able to read",
    "start": "2501400",
    "end": "2506760"
  },
  {
    "text": "you don't want them to be able to enumerate keys because the keys don't particularly pertain to any sort of uh",
    "start": "2506760",
    "end": "2512200"
  },
  {
    "text": "uh application information or anything like that maybe it's something proprietary that you put on there for your organization to identify that",
    "start": "2512200",
    "end": "2517440"
  },
  {
    "text": "machine and you don't want them to be able to read it only administrators can okay tools like tripwire are very",
    "start": "2517440",
    "end": "2524960"
  },
  {
    "text": "interesting tools they create md5 check sums they're very you know very valuable tools but the thing about them is they",
    "start": "2524960",
    "end": "2532040"
  },
  {
    "text": "require a baseline because you have to it does no good to Simply generate an md5 check sum",
    "start": "2532040",
    "end": "2538160"
  },
  {
    "text": "on a file unless you're going to compare it to another md5 check sum at a later",
    "start": "2538160",
    "end": "2543558"
  },
  {
    "text": "date so it requires a baseline it requires a little extra work a little extra thought ahead to time how am I",
    "start": "2544280",
    "end": "2550079"
  },
  {
    "text": "going to go about doing this where am I going to store the data how am I going to secure it make sure it's not altered",
    "start": "2550079",
    "end": "2555240"
  },
  {
    "text": "before the next time I have to use it but it is a very effective tool um I know that there's certain military",
    "start": "2555240",
    "end": "2560640"
  },
  {
    "text": "organizations out there that are using md5 checks SS on Solara systems you know whenever they suspect",
    "start": "2560640",
    "end": "2567000"
  },
  {
    "text": "an incident they just run their their trip wire tool it's it's not necessarily trip wire it's a similar tool but that'll help them determine any files",
    "start": "2567000",
    "end": "2573520"
  },
  {
    "text": "that were changed so it's you know it's pretty much run by root it's regardless you know just completely disregards",
    "start": "2573520",
    "end": "2578559"
  },
  {
    "text": "permissions and looks for any files that were changed um actually pretty effective",
    "start": "2578559",
    "end": "2583640"
  },
  {
    "text": "pretty effective but again if you're running it on an NTI or 2000 system you want to make sure it takes certain things like alternate data streams into",
    "start": "2583640",
    "end": "2591839"
  },
  {
    "text": "account I bet you all like that sound of me sipping",
    "start": "2593680",
    "end": "2598319"
  },
  {
    "text": "right okay we also if we're going to use our sackle and dles you're going to have to start monitoring the event log I mean",
    "start": "2600559",
    "end": "2607079"
  },
  {
    "text": "I mean what's the sense of setting these things if you're not going to look for them you want to prevent the activity okay maybe you don't want to log it",
    "start": "2607079",
    "end": "2613079"
  },
  {
    "text": "that's fine you just want to prevent it from happening but maybe for certain users you know you do want to monitor",
    "start": "2613079",
    "end": "2618359"
  },
  {
    "text": "this type of activity you do want to see when it's happening and again there's multiple ways that you can go about",
    "start": "2618359",
    "end": "2623599"
  },
  {
    "text": "collecting this information from systems and you don't have to pay a lot of money to do it or to implement it Pearl is a",
    "start": "2623599",
    "end": "2629040"
  },
  {
    "text": "good way to do it there's third party tools there's free CIS log clients and servers it's great",
    "start": "2629040",
    "end": "2635319"
  },
  {
    "text": "stuff but you have to make sure you enable the appropriate auditing um does anybody here does",
    "start": "2635319",
    "end": "2641359"
  },
  {
    "text": "anybody here check the the Mountain Wave news site you know they got some some news on their website mwave.com",
    "start": "2641359",
    "end": "2648440"
  },
  {
    "text": "okay um it's it's pretty good it's not updated all the time but Mountain wve has a product called cyberwolf which is",
    "start": "2648440",
    "end": "2655839"
  },
  {
    "text": "not so much an IDs as it is a log normalization tool but they will not load their agents",
    "start": "2655839",
    "end": "2664280"
  },
  {
    "text": "on an ntier to or any system really unless certain settings have been made or changed on that system if you do not",
    "start": "2664280",
    "end": "2671280"
  },
  {
    "text": "have auditing turned on they won't load the agent on and why is that it's the old gigo garbage in",
    "start": "2671280",
    "end": "2678839"
  },
  {
    "text": "garbage out principle if you're not auditing and you're not providing your audit infrastructure with information",
    "start": "2678839",
    "end": "2686040"
  },
  {
    "text": "then you're not going to see anything happening okay if you're running a a fat",
    "start": "2686040",
    "end": "2691240"
  },
  {
    "text": "file system and you don't really have any auditing turned on not that you know",
    "start": "2691240",
    "end": "2696359"
  },
  {
    "text": "without the anfs file system you can do a whole lot with a file system but you're just not going to get anything I mean you basically it's a sacrificial",
    "start": "2696359",
    "end": "2702720"
  },
  {
    "text": "box that can be easily used by a malicious user to get in and do all sorts of weird",
    "start": "2702720",
    "end": "2709000"
  },
  {
    "text": "things uh just boggles a mind periodic scans verification scans if you have a",
    "start": "2709000",
    "end": "2715119"
  },
  {
    "text": "way of collecting information such as the the PWC guys talked about yesterday well automate it run it periodically",
    "start": "2715119",
    "end": "2722520"
  },
  {
    "text": "look for changes uh you know write your results from the last scan to a text file",
    "start": "2722520",
    "end": "2727599"
  },
  {
    "text": "that's easy you know Pearl was originally developed to deal with text files Pearl stands for practical",
    "start": "2727599",
    "end": "2733200"
  },
  {
    "text": "extraction and Reporting language well that's I guess one of the things it stands for but it's very powerful when",
    "start": "2733200",
    "end": "2740359"
  },
  {
    "text": "it comes to manipulating text files or looking at text files so you just you go through you do your scan you collect the",
    "start": "2740359",
    "end": "2746000"
  },
  {
    "text": "information save it to a text file keep it on a protected directory on your box at a later time rerun the scan and see",
    "start": "2746000",
    "end": "2751359"
  },
  {
    "text": "what changed see if anything changed you know sometimes no news is good news if you have all these warnings that pop up",
    "start": "2751359",
    "end": "2756440"
  },
  {
    "text": "to say oh file changed file added whatever the case may be then the fact that you don't have anything in your inbox or anything in",
    "start": "2756440",
    "end": "2762880"
  },
  {
    "text": "the report when you get there the next day that that could be a good thing and with the appropriate settings",
    "start": "2762880",
    "end": "2768880"
  },
  {
    "text": "uh you know some of these techniques can be considered real time um however one of the things I found that is real time",
    "start": "2768880",
    "end": "2776200"
  },
  {
    "text": "and actually um looks like it's very beneficial to um",
    "start": "2776200",
    "end": "2782280"
  },
  {
    "text": "replacing or backing up maybe would be a better term uh the file and object",
    "start": "2782280",
    "end": "2788720"
  },
  {
    "text": "access if you you know if you're going to monitor who accesses what files you",
    "start": "2788720",
    "end": "2794640"
  },
  {
    "text": "have to turn on the file and object access auditing and then you have to go to the file and say okay I want to know when somebody read this or somebody did",
    "start": "2794640",
    "end": "2800520"
  },
  {
    "text": "this or somebody did that but even if you just open the file a lot of times you'll get um you know three maybe two",
    "start": "2800520",
    "end": "2807000"
  },
  {
    "text": "or three entries so it's kind of kind of difficult to understand and go through all that information and it you seems",
    "start": "2807000",
    "end": "2812119"
  },
  {
    "text": "like you're inundated you know using the fire hose technique with all this information when somebody just open and closes a file now you can automate going",
    "start": "2812119",
    "end": "2818480"
  },
  {
    "text": "through that you know but we've got other things that we can do as well in real time one of the things I found is a",
    "start": "2818480",
    "end": "2824319"
  },
  {
    "text": "a pro module called 132 and it's advv notify but it stands for advanced",
    "start": "2824319",
    "end": "2830160"
  },
  {
    "text": "notification this uses the Microsoft API that's",
    "start": "2830160",
    "end": "2836559"
  },
  {
    "text": "designed such that if file events when a file is created modified or deleted",
    "start": "2836559",
    "end": "2843319"
  },
  {
    "text": "these file these file events are generated now Microsoft has API for tracking these",
    "start": "2843319",
    "end": "2848640"
  },
  {
    "text": "things and the author of this module has gone through and actually added quite a bit of functionality above and beyond",
    "start": "2848640",
    "end": "2855079"
  },
  {
    "text": "the change notify module which is available through active State and it's actually very very",
    "start": "2855079",
    "end": "2860680"
  },
  {
    "text": "interesting and I'm actually going to include that as part of this part of the demo today um one thing you do want to be",
    "start": "2860680",
    "end": "2867240"
  },
  {
    "text": "careful of and before I go on this is available on my website if you go to the main website there's a link to the Pearl",
    "start": "2867240",
    "end": "2872920"
  },
  {
    "text": "and there's a just a page for Pearl scripts uh it's called fsw which file system Watcher and um it's pretty",
    "start": "2872920",
    "end": "2879520"
  },
  {
    "text": "interesting you just have to be careful when you're implementing things like this if you're going to create a log file because the first file change and",
    "start": "2879520",
    "end": "2887599"
  },
  {
    "text": "and you please take the benefit of my experience with this the first file change that you get writes to the log file well the next file change after",
    "start": "2887599",
    "end": "2894520"
  },
  {
    "text": "that is the log file and if you're not careful you can consume a lot of CPU time and in a",
    "start": "2894520",
    "end": "2900119"
  },
  {
    "text": "couple seconds end up with 5 megabytes of data all because you keep adding entries to that one file so uh be",
    "start": "2900119",
    "end": "2907480"
  },
  {
    "text": "careful using this please um you can also combine it with several other Pearl modules that are",
    "start": "2907480",
    "end": "2913359"
  },
  {
    "text": "available uh Dave rth win32 Damon for creating NT 2000 Services uh if you",
    "start": "2913359",
    "end": "2919319"
  },
  {
    "text": "don't want to store the information on the box and you have a CIS log server already um just send the information out",
    "start": "2919319",
    "end": "2924839"
  },
  {
    "text": "over sis log just take advantage of that uh you know the type of functionality you already have on your",
    "start": "2924839",
    "end": "2931880"
  },
  {
    "text": "network okay at this point throughout this portion of the presentation do we have any questions",
    "start": "2931880",
    "end": "2938400"
  },
  {
    "text": "any questions at all nobody okay all right we're going to go over",
    "start": "2938400",
    "end": "2946040"
  },
  {
    "text": "we're going to take a look at a couple of demonstrations but the first thing I need to do is to really",
    "start": "2946040",
    "end": "2952760"
  },
  {
    "text": "make this meaningful bless you I'm going to open",
    "start": "2952760",
    "end": "2960838"
  },
  {
    "text": "up start running the file system watch it there okay that's the",
    "start": "2963160",
    "end": "2969040"
  },
  {
    "text": "output so far that's all it's done it's going to watch the system 32 directory",
    "start": "2969040",
    "end": "2974400"
  },
  {
    "text": "oh well you know that's a default maybe I don't want to do that so I kill",
    "start": "2974400",
    "end": "2979920"
  },
  {
    "text": "it how about if we watch the entire C drive there we",
    "start": "2979920",
    "end": "2986119"
  },
  {
    "text": "go so basically what this is supposed to do anytime there's a file event generated it'll it'll wake up catch that",
    "start": "2986119",
    "end": "2993119"
  },
  {
    "text": "event and you notice we have this running just for curiosity let me open up the task",
    "start": "2993119",
    "end": "3002079"
  },
  {
    "text": "manager okay oh there you go oh you know with all the stuff running on the system",
    "start": "3002079",
    "end": "3008720"
  },
  {
    "text": "you know we're fluctuating but it's not consuming a whole lot of CPU time I mean it's not",
    "start": "3008720",
    "end": "3015720"
  },
  {
    "text": "not like we have a massive consumption of the CPU or memory just because we started running this okay so that's just going to sit",
    "start": "3015720",
    "end": "3022440"
  },
  {
    "text": "there and it's the program's going to wake up when it needs to all right all right",
    "start": "3022440",
    "end": "3029079"
  },
  {
    "text": "now okay okay who's got the who wants to",
    "start": "3029079",
    "end": "3035520"
  },
  {
    "text": "create some alternate data streams God",
    "start": "3035520",
    "end": "3041559"
  },
  {
    "text": "okay okay you're just going to take my word for it and take the the presentation okay fine I'll do it",
    "start": "3041559",
    "end": "3049079"
  },
  {
    "text": "okay we're going to use a type command n notepad. uh I'll tell you what let's",
    "start": "3049079",
    "end": "3056440"
  },
  {
    "text": "do do this first I like to use Lads look at the current directory",
    "start": "3056440",
    "end": "3061559"
  },
  {
    "text": "that's what lad says see there's the website is where you can get it it says",
    "start": "3061559",
    "end": "3066920"
  },
  {
    "text": "you lad use Lads at your own risk well yeah okay fine it doesn't uh it hasn't messed up anything on my system since",
    "start": "3066920",
    "end": "3072440"
  },
  {
    "text": "I've been using it through the various versions it seems to be pretty stable but it's telling us that in this particular directory we have no alterate",
    "start": "3072440",
    "end": "3079640"
  },
  {
    "text": "data streams okay so let's do this",
    "start": "3079640",
    "end": "3084680"
  },
  {
    "text": "type notepad. exe oops sorry we need to full",
    "start": "3084680",
    "end": "3090880"
  },
  {
    "text": "path that excuse me is",
    "start": "3092359",
    "end": "3099960"
  },
  {
    "text": "it okay just for you we'll go",
    "start": "3103119",
    "end": "3108480"
  },
  {
    "text": "back okay all right jeez you know here I am asking for",
    "start": "3111880",
    "end": "3117480"
  },
  {
    "text": "questions and complain about it you get yeah go",
    "start": "3117480",
    "end": "3122720"
  },
  {
    "text": "figure huh okay let's see what do I want to do with this uh let's",
    "start": "3122720",
    "end": "3130920"
  },
  {
    "text": "see uh I don't know do I want to do that well let's try",
    "start": "3132000",
    "end": "3137279"
  },
  {
    "text": "that okay well okay let's see what we let's see if we really did create an alternate data",
    "start": "3139839",
    "end": "3145640"
  },
  {
    "text": "stream there it is remember it said zero",
    "start": "3145640",
    "end": "3153079"
  },
  {
    "text": "before okay let's try something else oops here we",
    "start": "3153240",
    "end": "3160079"
  },
  {
    "text": "go 1 2 3 4 5 six 7 8 nine 10 there we go",
    "start": "3160079",
    "end": "3167720"
  },
  {
    "text": "wow there we go we got two of them same size all right",
    "start": "3168160",
    "end": "3173440"
  },
  {
    "text": "now do a how are we going to use it you want me to a DI all",
    "start": "3173440",
    "end": "3179640"
  },
  {
    "text": "right there we go I love this it's all noisy and stuff",
    "start": "3180079",
    "end": "3186040"
  },
  {
    "text": "I can't even burp though see there we go myfile.txt I didn't have it in there I created it it's zero",
    "start": "3186040",
    "end": "3193119"
  },
  {
    "text": "bytes but I don't see np. exe anywhere up here but Lads told us that we have two",
    "start": "3193119",
    "end": "3202799"
  },
  {
    "text": "np. Exes in different locations but it's not anywhere up here at all",
    "start": "3202799",
    "end": "3208440"
  },
  {
    "text": "okay I ask for questions I get orders this is great it's not complaining not",
    "start": "3212760",
    "end": "3218880"
  },
  {
    "text": "complaining run Lads again now run Lads again",
    "start": "3218880",
    "end": "3224279"
  },
  {
    "text": "okay there we go whatever properties are associated",
    "start": "3225240",
    "end": "3232280"
  },
  {
    "text": "with the default stream are also associated with the alternate streams the alternate data stream does not have",
    "start": "3232280",
    "end": "3238119"
  },
  {
    "text": "any Mac times in and of its own does not have any permissions Associated solely with that alternate data stream they're",
    "start": "3238119",
    "end": "3243599"
  },
  {
    "text": "all associated with the default unnamed stream of the file cool okay now we have this one",
    "start": "3243599",
    "end": "3253200"
  },
  {
    "text": "alternate data stream what can we do with it run it run it yeah yes sir",
    "start": "3253200",
    "end": "3263559"
  },
  {
    "text": "can sure why not yeah can the question was can you hide a",
    "start": "3263960",
    "end": "3270359"
  },
  {
    "text": "folder full of data now I'm not going to say yes to the actual file structure but",
    "start": "3270359",
    "end": "3275799"
  },
  {
    "text": "anything in the any files in the folder any files in the subfolders yeah you can hide them the same way just it's long as",
    "start": "3275799",
    "end": "3282559"
  },
  {
    "text": "you got the disk space you can dump it in an alternate data stream wherever you want yes sir you said you could create",
    "start": "3282559",
    "end": "3288920"
  },
  {
    "text": "an executable file in the DAT we're going to look at that",
    "start": "3288920",
    "end": "3296839"
  },
  {
    "text": "yeah the question was can you time it to go off on its own yeah if you can execute an arbitrary",
    "start": "3296839",
    "end": "3304160"
  },
  {
    "text": "file which you know we'll do let let's try this tell you what let's start with the technique presented by the guys in",
    "start": "3304160",
    "end": "3309440"
  },
  {
    "text": "found the one that works on NTFS 4 let's start with that let's see hold",
    "start": "3309440",
    "end": "3316480"
  },
  {
    "text": "on okay let's attach it to the",
    "start": "3316480",
    "end": "3320799"
  },
  {
    "text": "directory you think so",
    "start": "3321520",
    "end": "3325880"
  },
  {
    "text": "oh H okay don't worry I believe it I've done this before it's",
    "start": "3327440",
    "end": "3333319"
  },
  {
    "text": "okay okay let's let's try this let's do this C colon back",
    "start": "3333319",
    "end": "3341280"
  },
  {
    "text": "slash what do you think",
    "start": "3345200",
    "end": "3351760"
  },
  {
    "text": "uh why not sure yeah I have",
    "start": "3351760",
    "end": "3358240"
  },
  {
    "text": "well let's try this let's try this let's",
    "start": "3358319",
    "end": "3364240"
  },
  {
    "text": "do type c colon so you made me delete the one I",
    "start": "3364240",
    "end": "3370319"
  },
  {
    "text": "had before made",
    "start": "3370319",
    "end": "3374400"
  },
  {
    "text": "me okay so we run Lads okay we got the both somewh back",
    "start": "3380440",
    "end": "3387559"
  },
  {
    "text": "okay let's try start see",
    "start": "3387559",
    "end": "3393200"
  },
  {
    "text": "colon yeah it's probably my spelling is what did it oops that's not the error",
    "start": "3402520",
    "end": "3409160"
  },
  {
    "text": "message what is that that's Notepad",
    "start": "3409160",
    "end": "3413880"
  },
  {
    "text": "by simply modifying the technique from NTFS 4 simple modification it",
    "start": "3416359",
    "end": "3423880"
  },
  {
    "text": "works now on NTFS 4 we just didn't need the complete path but also on NTFS 4 if if it was",
    "start": "3424880",
    "end": "3431960"
  },
  {
    "text": "associated with the directory listing you could also run it as we just saw we couldn't run it if it was associated",
    "start": "3431960",
    "end": "3438160"
  },
  {
    "text": "with the directory listing but if it's associated with a file we can execute",
    "start": "3438160",
    "end": "3443359"
  },
  {
    "text": "it yes sir to",
    "start": "3443359",
    "end": "3448160"
  },
  {
    "text": "system yeah well let's take a look God I love",
    "start": "3448680",
    "end": "3455319"
  },
  {
    "text": "this now the questions are starting to come up you guys are waking up this is good this is actually something that",
    "start": "3455319",
    "end": "3461680"
  },
  {
    "text": "appeared on uh the vev list we actually talked about this there's a huge thread on this somebody asked somebody started",
    "start": "3461680",
    "end": "3468440"
  },
  {
    "text": "off the question and and the question was how do I hide data on Windows",
    "start": "3468440",
    "end": "3473599"
  },
  {
    "text": "2000 and my my my response that thread it wasn't the first response but my response was well you know I don't want",
    "start": "3473599",
    "end": "3480920"
  },
  {
    "text": "to just post my black hat presentation but you know I just wanted to get in there and this is one of the things we did look at let's take a look at uh",
    "start": "3480920",
    "end": "3488960"
  },
  {
    "text": "let's take a look at task manager okay we'll look at the processes oh first let's look at applications that are running okay it's got notepad",
    "start": "3488960",
    "end": "3497400"
  },
  {
    "text": "running okay let's go look at",
    "start": "3497400",
    "end": "3502318"
  },
  {
    "text": "processes I don't see a I don't see notepad or an np. exe wait",
    "start": "3502480",
    "end": "3508400"
  },
  {
    "text": "a minute what's that that looks doesn't it",
    "start": "3508400",
    "end": "3515960"
  },
  {
    "text": "though yeah that's odd hold on a second let me do",
    "start": "3516200",
    "end": "3523200"
  },
  {
    "text": "this and close this I'll leave notepad running let me go",
    "start": "3523200",
    "end": "3530559"
  },
  {
    "text": "to CD BH demo one remember we took a look at the process listing",
    "start": "3530559",
    "end": "3538039"
  },
  {
    "text": "huh well there it is my file.txt",
    "start": "3538319",
    "end": "3545760"
  },
  {
    "text": "but not notepad",
    "start": "3545760",
    "end": "3551240"
  },
  {
    "text": "H hopefully you're beginning to see why I kind of like this topic of sub alternate data streams this is great",
    "start": "3553440",
    "end": "3561160"
  },
  {
    "text": "stuff now every now and then you'll find somebody on the list that says hey I do penetration testing I use this stuff all the time um a forensics analyst in um uh",
    "start": "3562799",
    "end": "3572960"
  },
  {
    "text": "the UK asked me what does this look like in in case I said I don't know why don't",
    "start": "3572960",
    "end": "3578599"
  },
  {
    "text": "you create an altered data stream and find out next thing I know I get a couple of gift files and that's what he",
    "start": "3578599",
    "end": "3583839"
  },
  {
    "text": "did he went and did scream captures trimmed them down and showed me you know I I created these alternate data streams",
    "start": "3583839",
    "end": "3588920"
  },
  {
    "text": "this is what they look like in in case so with the right tools like Lads and",
    "start": "3588920",
    "end": "3595680"
  },
  {
    "text": "stream and sind and whatnot you're not going to hide them from people that have access to those tools but if those tools",
    "start": "3595680",
    "end": "3601240"
  },
  {
    "text": "aren't available and they're not on the system this is a great way to hide data",
    "start": "3601240",
    "end": "3607079"
  },
  {
    "text": "okay let's take a look at a couple of others I've got a uh kill this notepad",
    "start": "3607079",
    "end": "3612599"
  },
  {
    "text": "first uh let's take a look at I mentioned video uh visual video Visual Basic script VBS scripts okay let's do",
    "start": "3612599",
    "end": "3621640"
  },
  {
    "text": "this W script Tex test",
    "start": "3621640",
    "end": "3629319"
  },
  {
    "text": "PBS can anybody read that can can everybody see that back there it says welcome to Black hat. VBS",
    "start": "3629319",
    "end": "3637160"
  },
  {
    "text": "test file okay great let's see what that file looks like notepad test. VBS okay there",
    "start": "3637160",
    "end": "3646799"
  },
  {
    "text": "it is that's it the entire contents of the file nothing malicious but yeah you know we can write",
    "start": "3646799",
    "end": "3654359"
  },
  {
    "text": "something malicious in there all right now let's do",
    "start": "3654359",
    "end": "3661960"
  },
  {
    "text": "this let's type test.",
    "start": "3661960",
    "end": "3668839"
  },
  {
    "text": "VBS and let's go ahead and add it to my file txt and we'll kill two birds",
    "start": "3668839",
    "end": "3674400"
  },
  {
    "text": "with one stone okay run",
    "start": "3674400",
    "end": "3679520"
  },
  {
    "text": "Lads there we go see one file zero bytes",
    "start": "3679520",
    "end": "3685520"
  },
  {
    "text": "in that file file and yet we've got almost 5100 bytes or",
    "start": "3685520",
    "end": "3691280"
  },
  {
    "text": "51,000 bytes Associated alternate data streams just right",
    "start": "3691280",
    "end": "3696160"
  },
  {
    "text": "there now what are we going to do to run this yes",
    "start": "3697359",
    "end": "3703279"
  },
  {
    "text": "sir don't access name",
    "start": "3703720",
    "end": "3709240"
  },
  {
    "text": "that asile interesting what happens if you",
    "start": "3710599",
    "end": "3716559"
  },
  {
    "text": "name the alternate data stream the same name oh let's take a look let's first",
    "start": "3716559",
    "end": "3721599"
  },
  {
    "text": "take a look at the contents of this",
    "start": "3721599",
    "end": "3724799"
  },
  {
    "text": "file oops let's see what happens huh there we",
    "start": "3732240",
    "end": "3739119"
  },
  {
    "text": "go okay what happens if we just do this",
    "start": "3739119",
    "end": "3744838"
  },
  {
    "text": "zero bytes kind of what we expect right okay let's try let's go back to the type",
    "start": "3746119",
    "end": "3755440"
  },
  {
    "text": "command huh no error message see what Lads has to say there",
    "start": "3759160",
    "end": "3764920"
  },
  {
    "text": "it goes let's try",
    "start": "3764920",
    "end": "3771760"
  },
  {
    "text": "there you go will this also be identified as a",
    "start": "3779160",
    "end": "3785119"
  },
  {
    "text": "process well let's take a look God you I don't have to remember the demos you guys are guiding me right through them",
    "start": "3785119",
    "end": "3790960"
  },
  {
    "text": "this is great okay let's see so we used W script the first time let's try it this time",
    "start": "3790960",
    "end": "3798720"
  },
  {
    "text": "there you go let's see what else is native that we",
    "start": "3806960",
    "end": "3815039"
  },
  {
    "text": "can try.",
    "start": "3815039",
    "end": "3821400"
  },
  {
    "text": "okay see if it cares about extensions yeah let's take a look see if it cares about",
    "start": "3821400",
    "end": "3827119"
  },
  {
    "text": "extensions ah there's no script engine",
    "start": "3831000",
    "end": "3836000"
  },
  {
    "text": "let's try something else let's try this okay W script is native to Windows 2000",
    "start": "3837240",
    "end": "3844880"
  },
  {
    "text": "so is C script",
    "start": "3844880",
    "end": "3850559"
  },
  {
    "text": "huh okay neat",
    "start": "3850559",
    "end": "3858160"
  },
  {
    "text": "okay you're curious where's your box I'm just kidding this is why we're here",
    "start": "3859960",
    "end": "3867720"
  },
  {
    "text": "no script engine same error message all",
    "start": "3868480",
    "end": "3873880"
  },
  {
    "text": "right really you mean the first one or the second one the first one really you",
    "start": "3875640",
    "end": "3883000"
  },
  {
    "text": "think it would make a difference you do that you huh that way when you see it running",
    "start": "3883000",
    "end": "3890760"
  },
  {
    "text": "out there when the system ad it running out there they'll ah",
    "start": "3890760",
    "end": "3896480"
  },
  {
    "text": "yeah there's other ways around that but if I saw a process running called",
    "start": "3896480",
    "end": "3901559"
  },
  {
    "text": "myt I would definitely question you would you would okay I",
    "start": "3901559",
    "end": "3908039"
  },
  {
    "text": "think I I I think I've related this before and Cory knows this because he was there to see it uh we had an",
    "start": "3908039",
    "end": "3913799"
  },
  {
    "text": "individual in a class I was teaching that said uh you know he sat in the front of the class just arms crossed",
    "start": "3913799",
    "end": "3919240"
  },
  {
    "text": "across his chest you can't teach me anything so the lab we decided I decided",
    "start": "3919240",
    "end": "3924520"
  },
  {
    "text": "we didn't use alternate data streams we use other techniques I took netcat nc.",
    "start": "3924520",
    "end": "3929559"
  },
  {
    "text": "exe we copied it onto the system in the system 32 directory called it in info.",
    "start": "3929559",
    "end": "3934640"
  },
  {
    "text": "exe and launched it from the command line listening on Port 80 and the only clue he had was there's",
    "start": "3934640",
    "end": "3941119"
  },
  {
    "text": "a Trojan on the system we didn't I didn't give anybody any tools but at the same time I didn't",
    "start": "3941119",
    "end": "3947240"
  },
  {
    "text": "say you can't use any tools they had internet",
    "start": "3947240",
    "end": "3952359"
  },
  {
    "text": "access okay so this guy opened open up event log task manager I said well you",
    "start": "3952359",
    "end": "3960039"
  },
  {
    "text": "got a trojan on your system he goes look I can see what I've got got a web server",
    "start": "3960039",
    "end": "3965279"
  },
  {
    "text": "really goes yeah it says IET info here that's executable for the web server and",
    "start": "3965279",
    "end": "3971640"
  },
  {
    "text": "netstat tells me Port 80 is open really okay well what services do you have",
    "start": "3971640",
    "end": "3978119"
  },
  {
    "text": "running well oddly enough IIs wasn't listed okay did you tell that to Port 80",
    "start": "3978119",
    "end": "3985599"
  },
  {
    "text": "did you connect to Port 80 with anything tet's already on the system so you know did you connect did you tet to Port 80",
    "start": "3985599",
    "end": "3991880"
  },
  {
    "text": "no okay how do you know you don't have a Trojan on the",
    "start": "3991880",
    "end": "3997920"
  },
  {
    "text": "system actually another interesting question I got from that same class was was actually pretty funny it's why do",
    "start": "3998359",
    "end": "4005760"
  },
  {
    "text": "people do this why do people want to hide data why do people want to break into my system",
    "start": "4005760",
    "end": "4011520"
  },
  {
    "text": "well because they can what's on everybody's system about this time of the year or maybe a month",
    "start": "4011520",
    "end": "4017160"
  },
  {
    "text": "from now everybody yes yeah tax returns if you're using tax",
    "start": "4017160",
    "end": "4025720"
  },
  {
    "text": "cut or something like that lots of information Social Security numbers addresses financial information",
    "start": "4025720",
    "end": "4033000"
  },
  {
    "text": "pictures you know even even home users you know home",
    "start": "4033000",
    "end": "4038799"
  },
  {
    "text": "users have got information uh let's see what's what's one of the more famous home users we that that we're in the news in the past couple years deuts",
    "start": "4038799",
    "end": "4047000"
  },
  {
    "text": "maybe why would somebody wanted to get into his system yeah back there sh yeah yeah former head of the CIA yeah going",
    "start": "4047000",
    "end": "4054920"
  },
  {
    "text": "home on his home system connected to the internet his kids used it come on you know couple all data streams on his",
    "start": "4054920",
    "end": "4061680"
  },
  {
    "text": "system okay let's see what else can we do though I know what if we created a shortcut",
    "start": "4061680",
    "end": "4069599"
  },
  {
    "text": "that's another way that we can launch you know launch executables you know you have a shortcut cuz you can put",
    "start": "4069599",
    "end": "4074839"
  },
  {
    "text": "shortcuts on the desktop you can put shortcuts in the startup directory let's take a look at a shortcut so let's see",
    "start": "4074839",
    "end": "4080240"
  },
  {
    "text": "where did we hide the executable we got okay my file.txt so let's go and create",
    "start": "4080240",
    "end": "4086279"
  },
  {
    "text": "a shortcut on the desktop new shortcut okay go to",
    "start": "4086279",
    "end": "4093039"
  },
  {
    "text": "browse browse there we go go to",
    "start": "4093039",
    "end": "4100560"
  },
  {
    "text": "blacket and go to the demos uh where's my file oh there it is right there",
    "start": "4100560",
    "end": "4106960"
  },
  {
    "text": "okay here we go wait a minute that's not the executable though hold",
    "start": "4106960",
    "end": "4112719"
  },
  {
    "text": "on try that go to next ah all not",
    "start": "4112719",
    "end": "4118880"
  },
  {
    "text": "found I I know let's try this other other thing here I'm not really making this up as I",
    "start": "4118880",
    "end": "4126159"
  },
  {
    "text": "go along okay let's go a and finish it my file.txt",
    "start": "4126159",
    "end": "4133239"
  },
  {
    "text": "okay this looks like a file let's go in",
    "start": "4133839",
    "end": "4139719"
  },
  {
    "text": "to properties and let's",
    "start": "4139719",
    "end": "4145679"
  },
  {
    "text": "see here we go now remember what that icon looked",
    "start": "4145679",
    "end": "4151359"
  },
  {
    "text": "like took it",
    "start": "4155000",
    "end": "4161400"
  },
  {
    "text": "whoa It's kind of neat",
    "start": "4162120",
    "end": "4166600"
  },
  {
    "text": "now if we use soliter obviously you get a different icon right there you",
    "start": "4168480",
    "end": "4174440"
  },
  {
    "text": "go huh okay let's see what else we got what are other ways we can execute it that are native to the Windows 2000",
    "start": "4174440",
    "end": "4181040"
  },
  {
    "text": "platform anybody know have any other ways how about the Run",
    "start": "4181040",
    "end": "4186440"
  },
  {
    "text": "box you know most of most of the time I've seen these presentations up here you know I just use the start menu and",
    "start": "4186440",
    "end": "4192359"
  },
  {
    "text": "go to programs and go to the Doss prompt and you see a lot of people that open up the Run box type CMD and boom they got a command prompt well let's try that let's",
    "start": "4192359",
    "end": "4200360"
  },
  {
    "text": "try something similar to that okay run not shut down",
    "start": "4200360",
    "end": "4208760"
  },
  {
    "text": "okay let's see oops let's try this",
    "start": "4208760",
    "end": "4217640"
  },
  {
    "text": "fi uh",
    "start": "4217640",
    "end": "4221640"
  },
  {
    "text": "okay at this point is anybody in a betting",
    "start": "4226239",
    "end": "4231719"
  },
  {
    "text": "mood okay maybe I should have done this at the beginning since I already knew",
    "start": "4234520",
    "end": "4239560"
  },
  {
    "text": "the answers wow H kind of neat remember this isn't",
    "start": "4239560",
    "end": "4249520"
  },
  {
    "text": "this isn't just working because it's notepad it's working because it's an executable",
    "start": "4249520",
    "end": "4255840"
  },
  {
    "text": "and I'm only using notepad as an example use any arbitrary executable you",
    "start": "4255840",
    "end": "4261880"
  },
  {
    "text": "want the let's take a look at that I'll go",
    "start": "4261960",
    "end": "4268440"
  },
  {
    "text": "open it up again it's in a run box still there I",
    "start": "4268440",
    "end": "4276040"
  },
  {
    "text": "actually yeah yeah I'm going to go there I just got very little space left",
    "start": "4276040",
    "end": "4282679"
  },
  {
    "text": "on my taskbar there there we go let's see there's Elsas service host",
    "start": "4282679",
    "end": "4287800"
  },
  {
    "text": "there SD exe where do we go wayer what extensions allow huh tell",
    "start": "4287800",
    "end": "4297360"
  },
  {
    "text": "your task manager yeah is there no way to tell the task manager that file way",
    "start": "4297360",
    "end": "4303760"
  },
  {
    "text": "out it's but it'si well it's not that's just it the",
    "start": "4303760",
    "end": "4310760"
  },
  {
    "text": "file that the file that's actually it's listed here is txe but the file that's actually running is an exe it's got an",
    "start": "4310760",
    "end": "4318360"
  },
  {
    "text": "exe extension you know with the uh the VBS files we saw with the testing there",
    "start": "4318360",
    "end": "4323760"
  },
  {
    "text": "you know if we change the extension it doesn't find the engine doesn't know what to",
    "start": "4323760",
    "end": "4328480"
  },
  {
    "text": "do okay that",
    "start": "4329440",
    "end": "4335559"
  },
  {
    "text": "aut yes if you put it in and just because it takes you know a little bit",
    "start": "4336920",
    "end": "4342679"
  },
  {
    "text": "of time to go through that you can actually launch these from the Run key in the",
    "start": "4342679",
    "end": "4347760"
  },
  {
    "text": "registry yes did you use this to protect a file from being affected by",
    "start": "4347760",
    "end": "4353960"
  },
  {
    "text": "viruses uh up up until Benny and rder from 29a came out yeah you could they",
    "start": "4353960",
    "end": "4360679"
  },
  {
    "text": "came out with w2k stream it sort of used alternate data",
    "start": "4360679",
    "end": "4366040"
  },
  {
    "text": "streams in the sense that if it was on an NTFS file system it would copy the original file the original executable",
    "start": "4366040",
    "end": "4372480"
  },
  {
    "text": "that infected into the alternate data stream and then infect the other file so",
    "start": "4372480",
    "end": "4378360"
  },
  {
    "text": "it make a copy of the uninfected file and then in infect the default",
    "start": "4378360",
    "end": "4383920"
  },
  {
    "text": "stream well if it hit a fat system there was no an there was no alternate data stream to copy the original file into so",
    "start": "4383920",
    "end": "4390320"
  },
  {
    "text": "it just infected the file so it doesn't really really use alternate data streams",
    "start": "4390320",
    "end": "4396080"
  },
  {
    "text": "in this type of sense but yes it does use alternate data streams so copying files into alternate data streams is not",
    "start": "4396080",
    "end": "4402800"
  },
  {
    "text": "necessarily going to protect the file from from being infected by a virus not",
    "start": "4402800",
    "end": "4408678"
  },
  {
    "text": "anymore okay just one other let's take a look at using um using notepad for instance",
    "start": "4409199",
    "end": "4416960"
  },
  {
    "text": "create a file my file 2.txt",
    "start": "4416960",
    "end": "4425040"
  },
  {
    "text": "okay yeah does it do do you want to create it say yeah okay this this is a",
    "start": "4425040",
    "end": "4433239"
  },
  {
    "text": "file uh pretty simple straight forward save",
    "start": "4433239",
    "end": "4438560"
  },
  {
    "text": "it close it okay di so my file 2.txt is 14 bytes",
    "start": "4438560",
    "end": "4448400"
  },
  {
    "text": "long no pad my file to.",
    "start": "4449800",
    "end": "4455639"
  },
  {
    "text": "txt hidden. txt H you want to create the file sure",
    "start": "4455639",
    "end": "4463040"
  },
  {
    "text": "why not this is and Alternate data",
    "start": "4463040",
    "end": "4469520"
  },
  {
    "text": "stream okay I'm go ahead save the file save close",
    "start": "4470000",
    "end": "4477080"
  },
  {
    "text": "it di my file 2.txt is still 14 bytes",
    "start": "4477080",
    "end": "4485320"
  },
  {
    "text": "long hide a lot of information output of commands all we have to do is put that",
    "start": "4487480",
    "end": "4494679"
  },
  {
    "text": "cold that was in the command line put it in the right place for for the different",
    "start": "4494679",
    "end": "4500280"
  },
  {
    "text": "commands it'll go ahead and use the alternate data stream take take and run Lads one more",
    "start": "4500280",
    "end": "4508480"
  },
  {
    "text": "time there you go got a total of five five alternate data",
    "start": "4508480",
    "end": "4515400"
  },
  {
    "text": "streams any more questions on alter data streams at this point if you put a second colon in there",
    "start": "4517120",
    "end": "4523880"
  },
  {
    "text": "it just for aile let's try",
    "start": "4523880",
    "end": "4529480"
  },
  {
    "text": "it uh what are we going to do uh type",
    "start": "4529480",
    "end": "4535880"
  },
  {
    "text": "tvbs because it's quick my file.txt colon colon like",
    "start": "4535880",
    "end": "4544040"
  },
  {
    "text": "that like that hidden two you spell BBS I did bbsf",
    "start": "4544199",
    "end": "4552920"
  },
  {
    "text": "foran slip sorry okay that look good",
    "start": "4552920",
    "end": "4559360"
  },
  {
    "text": "H parameters incorrect but basically if we just keep changing the",
    "start": "4559360",
    "end": "4564960"
  },
  {
    "text": "name behind the first colon we could just keep adding stuff yeah you know somebody that's somebody",
    "start": "4564960",
    "end": "4571679"
  },
  {
    "text": "that's truly malicious you know might create a little tiny little file that",
    "start": "4571679",
    "end": "4576840"
  },
  {
    "text": "just grabs Colonel 32 dll and starts dumping it in alternate data",
    "start": "4576840",
    "end": "4582000"
  },
  {
    "text": "streams if it happens fast enough fill up your your hard drive boom that's",
    "start": "4582000",
    "end": "4588400"
  },
  {
    "text": "it okay let's move on to a couple the other demonstrations that we've got here I've",
    "start": "4589120",
    "end": "4594840"
  },
  {
    "text": "got uh uh oh I tell you what let's do um let's try the touch one because I I",
    "start": "4594840",
    "end": "4600639"
  },
  {
    "text": "really like to go through that let's see we created we just created myfile.txt and myfile 2.txt on the",
    "start": "4600639",
    "end": "4607719"
  },
  {
    "text": "system okay so what I'm going to do is as you can see from the file listing here I'm going to cheat a little bit",
    "start": "4607719",
    "end": "4613800"
  },
  {
    "text": "because I have a batch file cuz what I did was in order to break it up so that you can see what's going on",
    "start": "4613800",
    "end": "4620840"
  },
  {
    "text": "you know in the pearl script that when you download the uh the zipped archive you'll see that touch one. PL will",
    "start": "4620840",
    "end": "4628560"
  },
  {
    "text": "actually change all three of the Mac times all three of them and then touch",
    "start": "4628560",
    "end": "4633760"
  },
  {
    "text": "two is only going to change the last access and last modified times now I have it print this information out and",
    "start": "4633760",
    "end": "4640080"
  },
  {
    "text": "the reason I have at a batch file is because before and after each touch I have it print out the times on the file",
    "start": "4640080",
    "end": "4647480"
  },
  {
    "text": "as they are currently on the system for that file okay does that make sense to everybody so instead of just having it",
    "start": "4647480",
    "end": "4654400"
  },
  {
    "text": "all in one command I wanted to see I wanted to show it broken out so I've actually got it multiple",
    "start": "4654400",
    "end": "4660880"
  },
  {
    "text": "steps so let's go ahead and",
    "start": "4660880",
    "end": "4664280"
  },
  {
    "text": "run touch and we'll I'll tell you what use my file 2.txt now this was actually",
    "start": "4667000",
    "end": "4673400"
  },
  {
    "text": "an idea I was just going to run it with one step and this is an this the Second Step was an idea I got from Egon Casey",
    "start": "4673400",
    "end": "4679719"
  },
  {
    "text": "because he had this this this mischievous streak in there we go okay there's the output",
    "start": "4679719",
    "end": "4687400"
  },
  {
    "text": "it fits on the screen let's take a walk through it so we run the command the first thing that gets I I didn't turn Echo off so you can kind of see what's",
    "start": "4687400",
    "end": "4693480"
  },
  {
    "text": "going on this is the touch demo for black hat then on the next prompt the",
    "start": "4693480",
    "end": "4698560"
  },
  {
    "text": "first thing we do is we check the current file time and what are the file times associated with it let's see Friday February 8th",
    "start": "4698560",
    "end": "4705360"
  },
  {
    "text": "created at uh 347 and 3 seconds okay yeah that's today uh this is based on you know one",
    "start": "4705360",
    "end": "4711800"
  },
  {
    "text": "time zone so I haven't changed since system time last access well last time",
    "start": "4711800",
    "end": "4718199"
  },
  {
    "text": "we accessed it was you know within a minute okay so then we run the first",
    "start": "4718199",
    "end": "4724920"
  },
  {
    "text": "touch I said all the time so August 20th",
    "start": "4724920",
    "end": "4730000"
  },
  {
    "text": "2005 then I run the second touch and I said all the",
    "start": "4732679",
    "end": "4737760"
  },
  {
    "text": "dates for last access and last modification back to two back to 1999 so according to the current",
    "start": "4737760",
    "end": "4744320"
  },
  {
    "text": "information on this file this file won't be created for another three years but it",
    "start": "4744320",
    "end": "4751320"
  },
  {
    "text": "was just accessed three years ago does that make any",
    "start": "4751320",
    "end": "4756360"
  },
  {
    "text": "sense of course not okay but imagine being a forensics",
    "start": "4756360",
    "end": "4762199"
  },
  {
    "text": "analyst running across this now this actually used uses the the the API the Microsoft",
    "start": "4762199",
    "end": "4768320"
  },
  {
    "text": "API the file times are basically a a",
    "start": "4768320",
    "end": "4773600"
  },
  {
    "text": "64bit long or actually two 32bit numbers that get rammed together and processed",
    "start": "4773600",
    "end": "4780040"
  },
  {
    "text": "but all you need to do is you know just follow documentation on the Microsoft site that's all I did I went to the",
    "start": "4780040",
    "end": "4787480"
  },
  {
    "text": "Microsoft site and I follow the documentation there's actually code out there that shows you how to do this in Visual Basic this is you know working",
    "start": "4787480",
    "end": "4794440"
  },
  {
    "text": "code here's the source how to do it in visual Basics Microsoft provides some information some examples some very",
    "start": "4794440",
    "end": "4800239"
  },
  {
    "text": "simple examples in C++ but none of those examples",
    "start": "4800239",
    "end": "4806239"
  },
  {
    "text": "showed what touch one. PL does which is change all the access times it's one of",
    "start": "4806239",
    "end": "4811360"
  },
  {
    "text": "those things where I've got this functionality that I can do but you know",
    "start": "4811360",
    "end": "4817159"
  },
  {
    "text": "why would I bother changing what what's the legitimate purpose for creating for changing the creation date well you know",
    "start": "4817159",
    "end": "4823400"
  },
  {
    "text": "probably not really any legitimate purpose but you know you look at all the people with illegitimate motives out",
    "start": "4823400",
    "end": "4828679"
  },
  {
    "text": "there with malicious motives so this is something that can be",
    "start": "4828679",
    "end": "4834080"
  },
  {
    "text": "very very easily used just to Simply mask somebody looking for last access times on a system even after the bit",
    "start": "4834080",
    "end": "4840800"
  },
  {
    "text": "image copy of the drive is made okay Egon Casey is gonna is is says",
    "start": "4840800",
    "end": "4847400"
  },
  {
    "text": "he's taking a look at this as far as looking for artifacts Left Behind as yet he hasn't found any I don't know of",
    "start": "4847400",
    "end": "4853239"
  },
  {
    "text": "anybody else that has seen this because I posted it on the net I've talked about it but nobody has yet come up with any",
    "start": "4853239",
    "end": "4859040"
  },
  {
    "text": "artifacts Left Behind to indicate that this activity took place you know other than the utility actually existing on",
    "start": "4859040",
    "end": "4864520"
  },
  {
    "text": "the hard drive but you there's all sorts of removable",
    "start": "4864520",
    "end": "4869360"
  },
  {
    "text": "media now also people in investigating pornography and child pornography cases",
    "start": "4870280",
    "end": "4875800"
  },
  {
    "text": "fraud cases that those type of things nobody has has that I've talked to has yet seen such utility",
    "start": "4875800",
    "end": "4883080"
  },
  {
    "text": "used okay but look there it is right there and again you know I could just be",
    "start": "4883080",
    "end": "4889320"
  },
  {
    "text": "pulling the wool over your eyes but I'll give you the source code to this so you can look at it mess with it tell me I was right tell me I was",
    "start": "4889320",
    "end": "4895800"
  },
  {
    "text": "wrong but there it is okay I've got two more quick demos to run through really quick um the first",
    "start": "4895800",
    "end": "4903719"
  },
  {
    "text": "thing we're going to do is we're going to disassemble or decompose a file we're going to put those contents",
    "start": "4903719",
    "end": "4909960"
  },
  {
    "text": "in an alternate data in alternate data streams and for the sake of the Dem rtion I'm going to use",
    "start": "4909960",
    "end": "4916679"
  },
  {
    "text": "soliter a nice little executable pretty colorful so let's go ahead and run",
    "start": "4916679",
    "end": "4924320"
  },
  {
    "text": "dmpl okay so black ad demonstration there's not really anything to show",
    "start": "4926480",
    "end": "4932000"
  },
  {
    "text": "other than the fact that it's uh decomposing Solitaire and placing in alternate data streams now let's see where those alternate data streams",
    "start": "4932000",
    "end": "4938920"
  },
  {
    "text": "are look at that there they go",
    "start": "4938920",
    "end": "4944639"
  },
  {
    "text": "I chose an arbitrary file size to just to break the files up into and look I just stuck them in sequential alternate",
    "start": "4944639",
    "end": "4950679"
  },
  {
    "text": "data streams okay now before we go on with the second",
    "start": "4950679",
    "end": "4956320"
  },
  {
    "text": "half let's do a directory listing of recycler H fall not",
    "start": "4956320",
    "end": "4964239"
  },
  {
    "text": "found let's run the second",
    "start": "4964239",
    "end": "4968119"
  },
  {
    "text": "half huh where' that come from okay well",
    "start": "4970480",
    "end": "4976159"
  },
  {
    "text": "of course I just could have run it from its default location",
    "start": "4976159",
    "end": "4982480"
  },
  {
    "text": "but I didn't run it from its default location that's where I ran it from from",
    "start": "4983800",
    "end": "4989679"
  },
  {
    "text": "the recycle bin so what I've done with these two scripts that are available in",
    "start": "4989679",
    "end": "4995159"
  },
  {
    "text": "the archive on the website will be available through the black hat site is I've taken Solitaire an arbitrary",
    "start": "4995159",
    "end": "5000800"
  },
  {
    "text": "executable broken it down into arbitrarily sized segments and place those segments around",
    "start": "5000800",
    "end": "5007320"
  },
  {
    "text": "the file system now of course for the purposes of the demonstration it was pretty simple",
    "start": "5007320",
    "end": "5012480"
  },
  {
    "text": "process of you know it would be very easily detected but alternate data streams are",
    "start": "5012480",
    "end": "5018760"
  },
  {
    "text": "not the only places you can hide these segments you can put them in regular files you can put them any place on the system where you can write a string of",
    "start": "5018760",
    "end": "5025280"
  },
  {
    "text": "ones and zeros as long as you can access it and then the the reassembly code just pulls all the little bits and pieces",
    "start": "5025280",
    "end": "5031639"
  },
  {
    "text": "back together that runs fairly quickly it's just grabbing a some bites here and some bites there and ramming them",
    "start": "5031639",
    "end": "5037000"
  },
  {
    "text": "together and it creates the file wherever you want okay so I can do this I can",
    "start": "5037000",
    "end": "5044920"
  },
  {
    "text": "run I can run this again re. PL again okay it launches it now I'm going to",
    "start": "5045040",
    "end": "5050080"
  },
  {
    "text": "leave this running open up another Doss",
    "start": "5050080",
    "end": "5055360"
  },
  {
    "text": "prompt access okay",
    "start": "5055360",
    "end": "5061920"
  },
  {
    "text": "CD black hat pH demo 2 okay oops oops",
    "start": "5062400",
    "end": "5071719"
  },
  {
    "text": "sorry okay there we",
    "start": "5077120",
    "end": "5081639"
  },
  {
    "text": "go there's the process that's running not solitire not so.",
    "start": "5083080",
    "end": "5089760"
  },
  {
    "text": "exe but bhs2 for the purposes of this",
    "start": "5089760",
    "end": "5095320"
  },
  {
    "text": "presentation purpos this utility it's fairly simple fairly",
    "start": "5095320",
    "end": "5102360"
  },
  {
    "text": "straightforward and automated",
    "start": "5102360",
    "end": "5108280"
  },
  {
    "text": "okay I had one other demonstration that was going to run but everybody else is coming in now looks like it's time for the end of this presentation I'll make",
    "start": "5108280",
    "end": "5114440"
  },
  {
    "text": "sure that it's included in the archive that goes up on black hat but basically the idea is if you remember",
    "start": "5114440",
    "end": "5120960"
  },
  {
    "text": "the the slide where we had all the different colors that talked about combining techniques that's exactly what it",
    "start": "5120960",
    "end": "5126199"
  },
  {
    "text": "does it uses Solitaire encrypts it puts the a header from a just any other dll",
    "start": "5126199",
    "end": "5132760"
  },
  {
    "text": "on the top of it and then goes back the second half of the present or the second half of the demonstration strips off",
    "start": "5132760",
    "end": "5138920"
  },
  {
    "text": "that header decrypts it and runs a file okay at this point does anybody",
    "start": "5138920",
    "end": "5145199"
  },
  {
    "text": "have any questions about the information we've covered in the presentation at all yes a yes last of dat created a bunch of",
    "start": "5145199",
    "end": "5153719"
  },
  {
    "text": "dat is each one running individ the question was when I created",
    "start": "5153719",
    "end": "5160000"
  },
  {
    "text": "that last batch of alternate data streams I had all these all these data streams that that had the numbers on the",
    "start": "5160000",
    "end": "5166280"
  },
  {
    "text": "ends right the sequential numbers what you're talking about okay are they running a separate processes well no they're not",
    "start": "5166280",
    "end": "5172719"
  },
  {
    "text": "processes no they're not they're not running at all when I decompose the file into",
    "start": "5172719",
    "end": "5178440"
  },
  {
    "text": "separate segments and place them in alternate data streams there's just a string of of ones and zeros",
    "start": "5178440",
    "end": "5185000"
  },
  {
    "text": "nothing is actually running now when I ran the second half of the demonstration and reassembled them into the recycler",
    "start": "5185000",
    "end": "5190639"
  },
  {
    "text": "bin and then executed it then the overall executable was",
    "start": "5190639",
    "end": "5196239"
  },
  {
    "text": "running okay any other questions all right well thanks a",
    "start": "5196239",
    "end": "5203180"
  },
  {
    "text": "[Applause]",
    "start": "5203180",
    "end": "5209079"
  },
  {
    "text": "lot",
    "start": "5213239",
    "end": "5216239"
  },
  {
    "text": "e",
    "start": "5243119",
    "end": "5246119"
  },
  {
    "text": "e",
    "start": "5273119",
    "end": "5276119"
  },
  {
    "text": "e",
    "start": "5303119",
    "end": "5306119"
  },
  {
    "text": "e",
    "start": "5333040",
    "end": "5336040"
  },
  {
    "text": "e",
    "start": "5363040",
    "end": "5366040"
  },
  {
    "text": "e for",
    "start": "5393040",
    "end": "5397000"
  }
]