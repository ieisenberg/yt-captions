[
  {
    "start": "0",
    "end": "66000"
  },
  {
    "text": "good afternoon and welcome to crippling https with Unholy pack you are in",
    "start": "80",
    "end": "5120"
  },
  {
    "text": "manderlay EF and our speakers today are Isaac Cotler and Amit kleene a couple of",
    "start": "5120",
    "end": "12440"
  },
  {
    "text": "uh uh notes Here we need to um stop by the business Hall located in Bayside AB",
    "start": "12440",
    "end": "17520"
  },
  {
    "text": "during the day and for the welcome reception tonight from 1730 to 1900 also",
    "start": "17520",
    "end": "22720"
  },
  {
    "text": "uh the black hat Arsenal is on the palm foyer level three finally the pon awards",
    "start": "22720",
    "end": "28400"
  },
  {
    "text": "are this evening and they are in Mandalay Bay BCD at 18:30 we also",
    "start": "28400",
    "end": "34480"
  },
  {
    "text": "appreciate everybody making sure that their phones are on uh vibrate we don't need to hear your cool ringtones and",
    "start": "34480",
    "end": "41079"
  },
  {
    "text": "finally there are uh microphones in the audience so when Q&A time comes please",
    "start": "41079",
    "end": "46280"
  },
  {
    "text": "uh go to the microphone to ask your questions since these are being recorded and with that gentlemen it is",
    "start": "46280",
    "end": "52559"
  },
  {
    "text": "yours thank you Kevin um so and um good",
    "start": "52559",
    "end": "58079"
  },
  {
    "text": "afternoon ladies and gentlemen uh to this blackhead talk about crippling htps with Unholy",
    "start": "58079",
    "end": "66559"
  },
  {
    "start": "66000",
    "end": "79000"
  },
  {
    "text": "pack uh with us today is it Cotler who is the CTO and co-founder of",
    "start": "66840",
    "end": "72840"
  },
  {
    "text": "safebridge and uh myself I'm it Klein VP security resarch for safe Bri as",
    "start": "72840",
    "end": "79400"
  },
  {
    "start": "79000",
    "end": "140000"
  },
  {
    "text": "well before we actually begin i' would like to uh give us a little teaser here",
    "start": "79400",
    "end": "86840"
  },
  {
    "text": "and U describe a situation where in you're in potentially malicious Network could be a free Wi-Fi it could be any",
    "start": "86840",
    "end": "94560"
  },
  {
    "text": "guest Network you plug in your computer to or maybe your own corporate land through being compromised by uh an an",
    "start": "94560",
    "end": "102880"
  },
  {
    "text": "infected end point so uh obviously you are a security conscious researcher and",
    "start": "102880",
    "end": "109439"
  },
  {
    "text": "thus you restrict yourself to https uh browsing to hsts sites I remind",
    "start": "109439",
    "end": "115640"
  },
  {
    "text": "you that google.com uh just enabled hsts on their sites last",
    "start": "115640",
    "end": "121119"
  },
  {
    "text": "week or and or using any Force TLS orsl plugin in your uh in your browser uh so",
    "start": "121119",
    "end": "131000"
  },
  {
    "text": "theoretically since all your traffic is encrypted from the first bite you should be secure but are you",
    "start": "131000",
    "end": "139879"
  },
  {
    "start": "140000",
    "end": "187000"
  },
  {
    "text": "indeed so the rest of the presentation will go off uh along the following lines",
    "start": "140160",
    "end": "145519"
  },
  {
    "text": "we'll first uh discuss the pack and wpad uh then we will explain how we can steal",
    "start": "145519",
    "end": "152160"
  },
  {
    "text": "htps URLs over Lan or wireless LAN and why this is uh uh",
    "start": "152160",
    "end": "157800"
  },
  {
    "text": "scary uh then we'll describe another concept a related concept called pack",
    "start": "157800",
    "end": "163159"
  },
  {
    "text": "malware and we'll explain the capabilities uh of the pack M and uh the",
    "start": "163159",
    "end": "168480"
  },
  {
    "text": "and and describe the CNC protocol um we'll also show a pack feature Matrix uh",
    "start": "168480",
    "end": "176319"
  },
  {
    "text": "wherein we'll uh correlate browser div browsers versus the pack features and",
    "start": "176319",
    "end": "184040"
  },
  {
    "text": "we'll conclude with idas for immediation and fix so pack refresher a pack is a",
    "start": "184040",
    "end": "192000"
  },
  {
    "start": "187000",
    "end": "219000"
  },
  {
    "text": "acronym for proxy Auto config it's a file that designates for the browser",
    "start": "192000",
    "end": "197319"
  },
  {
    "text": "which proxy to use uh for each and every URL that the browser is about to navigate to It's a JavaScript based so",
    "start": "197319",
    "end": "204720"
  },
  {
    "text": "the logic is Javascript and the API between the browser and and is the F",
    "start": "204720",
    "end": "211560"
  },
  {
    "text": "proxy for URL function with two arguments that the pack needs to implement and the browser needs to",
    "start": "211560",
    "end": "217480"
  },
  {
    "text": "invoke per each URL this is a textbook example for p",
    "start": "217480",
    "end": "222599"
  },
  {
    "text": "file for it's a very simple one as you can see it implements fine proxy for URL uh the browser needs to invoke this",
    "start": "222599",
    "end": "229680"
  },
  {
    "text": "function with a URL and just the host part for the second argument and what this function does in this case is uh do",
    "start": "229680",
    "end": "237040"
  },
  {
    "text": "a regular expression match uh between the cost and example.com and if the the",
    "start": "237040",
    "end": "243120"
  },
  {
    "text": "match succeeds it returned direct which tells the browser not to go through a proxy however if uh the uh regular",
    "start": "243120",
    "end": "250799"
  },
  {
    "text": "expression does not match uh the proxy the the pack the the pack function the",
    "start": "250799",
    "end": "256440"
  },
  {
    "text": "fine proxy for URL returns a series of proxies to be used uh in the uh in the",
    "start": "256440",
    "end": "263240"
  },
  {
    "text": "format of proxy proxy name or or IP colum Port semicolon separates those es",
    "start": "263240",
    "end": "270000"
  },
  {
    "text": "from each other and the the logic is that the browser needs to fall back from the first one to the second one to until",
    "start": "270000",
    "end": "276520"
  },
  {
    "text": "the last one and and direct tells the the browser to use a direct connection IE not for a",
    "start": "276520",
    "end": "282720"
  },
  {
    "text": "proxy um what is available to the JavaScript uh code in the pack in the",
    "start": "282720",
    "end": "289800"
  },
  {
    "text": "pack context in the execution while while the browser executes the pack logic uh it has no window object and it",
    "start": "289800",
    "end": "296960"
  },
  {
    "text": "has no document object so all the Dome functions we are so used to and love uh",
    "start": "296960",
    "end": "302520"
  },
  {
    "text": "in from for example in cross-site scripting payloads and HTML games and",
    "start": "302520",
    "end": "307840"
  },
  {
    "text": "and attacks are not there for example no XML GTP request no loading of additional",
    "start": "307840",
    "end": "313440"
  },
  {
    "text": "code via script injection no hitting external resources via IMG injection and",
    "start": "313440",
    "end": "318880"
  },
  {
    "text": "so forth and so forth and so forth all these simply are not there what is there apart from the buil-in functions and",
    "start": "318880",
    "end": "326160"
  },
  {
    "text": "objects like math and like evil are set of about a dozen functions that are",
    "start": "326160",
    "end": "332199"
  },
  {
    "text": "specific to pack and are and and we group them into a binary function like",
    "start": "332199",
    "end": "338720"
  },
  {
    "text": "DNS domain is is in net and so forth not too helpful weekday range and date range",
    "start": "338720",
    "end": "343960"
  },
  {
    "text": "and time range that help the coder to do some uh date and time based uh logic and",
    "start": "343960",
    "end": "350880"
  },
  {
    "text": "shell expression match uh the general regular expression uh engine DNS resolve",
    "start": "350880",
    "end": "357639"
  },
  {
    "text": "and is resolvable which are more interesting in our context and they can do their um",
    "start": "357639",
    "end": "364960"
  },
  {
    "text": "the logic is self-explanatory can either resolve into IP address or just tell us if if a host name is resolvable my IP",
    "start": "364960",
    "end": "372039"
  },
  {
    "text": "address is simply the IP address for the current machine and alert which is a non-standard implementation in in a",
    "start": "372039",
    "end": "378400"
  },
  {
    "text": "browser uh May display some message as a",
    "start": "378400",
    "end": "383919"
  },
  {
    "start": "384000",
    "end": "442000"
  },
  {
    "text": "popup and where does the browser obtain the pack file from it's can the browser",
    "start": "384520",
    "end": "390440"
  },
  {
    "text": "has by configuration two options to retrieve a pack file one is a manual uh",
    "start": "390440",
    "end": "396840"
  },
  {
    "text": "pack file configuration in which case the browser one has to tell the browser the URL for the pack file and the other",
    "start": "396840",
    "end": "403720"
  },
  {
    "text": "one is the more automatic uh way of or fashion of obtaining a pack through",
    "start": "403720",
    "end": "409000"
  },
  {
    "text": "another protocol called web proxy autodiscovery or wpad at the right hand side of the screen you can see a",
    "start": "409000",
    "end": "414720"
  },
  {
    "text": "screenshot uh from Windows uh system configuration um which uh in where in h",
    "start": "414720",
    "end": "422199"
  },
  {
    "text": "the checkbox for using wpad which is called in in the windows jargon automatically detect setting is marked",
    "start": "422199",
    "end": "428960"
  },
  {
    "text": "in this it is not in this case it is not checked so the machine here uh is not",
    "start": "428960",
    "end": "434639"
  },
  {
    "text": "configured to use wpad but if you check this box the machine uh will use",
    "start": "434639",
    "end": "441879"
  },
  {
    "text": "wpad and so we need to to discuss wpad so as as we said earlier it requires a",
    "start": "442160",
    "end": "448479"
  },
  {
    "text": "specific checkbox checked in the browser uh it is in fact quite common in",
    "start": "448479",
    "end": "454440"
  },
  {
    "text": "Enterprises and in Windows and large it is the default at least for Windows 10 we check that probably for earlier",
    "start": "454440",
    "end": "461919"
  },
  {
    "text": "operating systems as well and the WW pad semi-standard works is that it provides",
    "start": "461919",
    "end": "469080"
  },
  {
    "text": "the the operating system or the browser with a set of uh fallbacks to find the",
    "start": "469080",
    "end": "475400"
  },
  {
    "text": "pack H to to find the pack or set fallback options to file the pack the first priority is using DHCP it works",
    "start": "475400",
    "end": "481919"
  },
  {
    "text": "only for ipv4 networks and the idea here is that after during DHCP um handshake",
    "start": "481919",
    "end": "489919"
  },
  {
    "text": "the DHCP server provides DHCP uh data such which is called options to the to",
    "start": "489919",
    "end": "496240"
  },
  {
    "text": "the client and one of those options option 252 to be specific uh designates",
    "start": "496240",
    "end": "502000"
  },
  {
    "text": "the pack URL that the DHCP wants the client to use if no DHCP handshake don't",
    "start": "502000",
    "end": "509280"
  },
  {
    "text": "HP Exchange took place or no option 252 is present in the DCP options part uh",
    "start": "509280",
    "end": "516919"
  },
  {
    "text": "the browser and operating system fall back to the second option which is using DNS and in which case the browser and",
    "start": "516919",
    "end": "524320"
  },
  {
    "text": "operating system issue a a DNS query for wad. domain where domain is the present",
    "start": "524320",
    "end": "531160"
  },
  {
    "text": "domain that the browser or that the operating system is configured to use um",
    "start": "531160",
    "end": "536240"
  },
  {
    "text": "if this uh host name is resolved into IP address the browser with an operating",
    "start": "536240",
    "end": "541839"
  },
  {
    "text": "system will then issue a requ an HTTP request to the said uh IP with the",
    "start": "541839",
    "end": "547800"
  },
  {
    "text": "resource requested WP a. this is a hardw uh string and whatever comes out from",
    "start": "547800",
    "end": "555640"
  },
  {
    "text": "this request will be the pack file this scheme this wpad is supported by Windows",
    "start": "555640",
    "end": "561000"
  },
  {
    "text": "and Mac uh we've seen it working well with Edge and Internet Explorer and Firefox Chrome and Safari wed is not",
    "start": "561000",
    "end": "568079"
  },
  {
    "text": "supported by iPhone and Android so now that we laid the background for the first concept we move",
    "start": "568079",
    "end": "575800"
  },
  {
    "text": "to describe this in part one and the concept of htps subversion with malicious",
    "start": "575800",
    "end": "582040"
  },
  {
    "start": "582000",
    "end": "768000"
  },
  {
    "text": "pack and the main idea goes as following uh with first first thing the context is",
    "start": "582040",
    "end": "588399"
  },
  {
    "text": "the scenario in which a malicious sector in your public Wi-Fi or your or your",
    "start": "588399",
    "end": "594000"
  },
  {
    "text": "corporate land uh has has access the sector is resides on on on on on the",
    "start": "594000",
    "end": "599839"
  },
  {
    "text": "landine it has access to the landine what this malicious actor needs to do is to force the browser to use a",
    "start": "599839",
    "end": "606839"
  },
  {
    "text": "malicious pack and how would the malicious seor go on doing that uh if",
    "start": "606839",
    "end": "612800"
  },
  {
    "text": "your operating system uh engages once you plug in your laptop to this SL your",
    "start": "612800",
    "end": "619160"
  },
  {
    "text": "operating system starts a DHCP negotiation to get DHCP parameters the",
    "start": "619160",
    "end": "624600"
  },
  {
    "text": "uh the malicious actor needs to spoof or hijack this speed traffic and provide",
    "start": "624600",
    "end": "630160"
  },
  {
    "text": "its own DHCP response containing an opt option 252 uh pointing at the malicious",
    "start": "630160",
    "end": "635880"
  },
  {
    "text": "URL for p if your operating system um reverts to",
    "start": "635880",
    "end": "643040"
  },
  {
    "text": "using DNS then again the Malaya actor needs to spoof or hijack this uh the DNS traffic and provide uh the an attacker",
    "start": "643040",
    "end": "651160"
  },
  {
    "text": "IP for WP queries the browser then request the pack from the attacker's IP",
    "start": "651160",
    "end": "656399"
  },
  {
    "text": "or URL and now the browser has the malicious pack the browser exposes the https URLs to the pack to the to the",
    "start": "656399",
    "end": "663040"
  },
  {
    "text": "function f proxy for URL uh it's important to stress that this is not an attack against TLS or SSL this the URL",
    "start": "663040",
    "end": "670720"
  },
  {
    "text": "is intercepted before it is serialized as HTTP and encrypted in TLS or SSL so",
    "start": "670720",
    "end": "676480"
  },
  {
    "text": "TLS or SSL versions or features of configuration are simply not relevant and will not help to mitigate this",
    "start": "676480",
    "end": "682040"
  },
  {
    "text": "attack so once the malicious pack logic obtains the uh the URL the h GPS URL the",
    "start": "682040",
    "end": "690880"
  },
  {
    "text": "final step is to xfilter this URL to the to an attacker server cuz right now the",
    "start": "690880",
    "end": "697279"
  },
  {
    "text": "pack the pack file is running in the context of uh of the victim browser it's still on the victim operating system we",
    "start": "697279",
    "end": "704480"
  },
  {
    "text": "need to exfiltrate the URL to the attacker machine and the attacker does that by",
    "start": "704480",
    "end": "710240"
  },
  {
    "text": "employing DNS resolve or is resolvable and that these functions actually go and",
    "start": "710240",
    "end": "715839"
  },
  {
    "text": "do DNS resolution and so they can touch out outside uh external servers uh the",
    "start": "715839",
    "end": "722680"
  },
  {
    "text": "attacker simply do the attacker can do that by chopping the URL into small",
    "start": "722680",
    "end": "728240"
  },
  {
    "text": "chunks that can fit in a DNS query and appending an attacker owned domain like",
    "start": "728240",
    "end": "733560"
  },
  {
    "text": "attacker.com to the host name and then then invoking say DNS resolve uh this",
    "start": "733560",
    "end": "739839"
  },
  {
    "text": "will cause the DNS query to arrive eventually at the uh at the authoritative name server for",
    "start": "739839",
    "end": "746440"
  },
  {
    "text": "attacker.com which can be the ATT uh DNS server and the attacker DNS",
    "start": "746440",
    "end": "752000"
  },
  {
    "text": "server needs to uh collect all those queries and deserialize them uh sorry",
    "start": "752000",
    "end": "758079"
  },
  {
    "text": "and serialize them back and de serialize them into the single uh URL and thus the",
    "start": "758079",
    "end": "763680"
  },
  {
    "text": "attacker obtains the exfiltrated URL here's",
    "start": "763680",
    "end": "769839"
  },
  {
    "start": "768000",
    "end": "1083000"
  },
  {
    "text": "a an outline of how a malicious spack uh may look like uh you can see at the",
    "start": "769839",
    "end": "776440"
  },
  {
    "text": "bottom right part of the screen the function find proxy for URL that the browser invokes uh to clarify uh we we",
    "start": "776440",
    "end": "784839"
  },
  {
    "text": "um split the extration and the actual functionality so first the function the",
    "start": "784839",
    "end": "790880"
  },
  {
    "text": "F proxy for URL invokes X will send with the URL and that X will send as the main",
    "start": "790880",
    "end": "796480"
  },
  {
    "text": "as the name hence takes care of the exfiltration and it returns a direct",
    "start": "796480",
    "end": "801959"
  },
  {
    "text": "string telling the browser to use a direct connection and the XL send is the Workhorse here uh without going into",
    "start": "801959",
    "end": "809680"
  },
  {
    "text": "details what it does is hex encoding each and every bite of the data the URL",
    "start": "809680",
    "end": "815440"
  },
  {
    "text": "in our case um chopping it to slices that can fit at dsquery adding uh adding",
    "start": "815440",
    "end": "824160"
  },
  {
    "text": "the uh um the attacker domain at the end and invoking DNS resolve interestingly",
    "start": "824160",
    "end": "830759"
  },
  {
    "text": "enough if you look at the first line of the um right hand side screenshot you",
    "start": "830759",
    "end": "836759"
  },
  {
    "text": "see that DNS resolve which is is used to exfiltrate and interestingly enough you'll see us adding an empty string to",
    "start": "836759",
    "end": "844639"
  },
  {
    "text": "it and we'll touch that later there's a lot of U Machinery here that needs to be uh implemented in order",
    "start": "844639",
    "end": "852399"
  },
  {
    "text": "for the protocol to be uh resilient and to be a a um fully uh operational with",
    "start": "852399",
    "end": "861079"
  },
  {
    "text": "long URLs and URLs that contains various characters and so forth uh we you'll",
    "start": "861079",
    "end": "866440"
  },
  {
    "text": "have the full implementation in our G repository which whose URL will provide",
    "start": "866440",
    "end": "872199"
  },
  {
    "text": "in a later slide now that we have htps URLs what",
    "start": "872199",
    "end": "878040"
  },
  {
    "text": "can we do with them so htps URLs are very interesting they they may contain",
    "start": "878040",
    "end": "884440"
  },
  {
    "text": "very sensitive information think about uh services that are used to share uh",
    "start": "884440",
    "end": "890720"
  },
  {
    "text": "files or resources between users the way the way a first user shares a file or resource with a second user typically",
    "start": "890720",
    "end": "897800"
  },
  {
    "text": "involves uh having the service either automatically or manually uh send an",
    "start": "897800",
    "end": "903240"
  },
  {
    "text": "email to the user to the second user that we that the first user wants to share the resource with and that email",
    "start": "903240",
    "end": "910680"
  },
  {
    "text": "contains a single URL that once clicked allows the second user access to the resource with privileges assigned by the",
    "start": "910680",
    "end": "917759"
  },
  {
    "text": "first user um now let's say that the second user has this uh malicious pack",
    "start": "917759",
    "end": "924079"
  },
  {
    "text": "loaded to the browser and the and the URLs exfiltrated to the attacker the attacker now obtains those URLs and can",
    "start": "924079",
    "end": "931959"
  },
  {
    "text": "uh put them or can navigate to them with in a with a browser and obtain the same resource the same file with the same",
    "start": "931959",
    "end": "938160"
  },
  {
    "text": "privileges as the second as the second entity uh open ID is another very",
    "start": "938160",
    "end": "944759"
  },
  {
    "text": "interesting case because open ID in the last phase of authentication redirects the users's browser from the",
    "start": "944759",
    "end": "950959"
  },
  {
    "text": "authenticator s to the service site and it does so by providing a URL",
    "start": "950959",
    "end": "956440"
  },
  {
    "text": "redirection to the uh service site to the site that requ that needs authentication uh with some token",
    "start": "956440",
    "end": "963480"
  },
  {
    "text": "parameters the Tok the queer parameters that tells the service site that the user is indeed authenticated and is uh",
    "start": "963480",
    "end": "971199"
  },
  {
    "text": "allowed to use the site uh again pack malicious pack file",
    "start": "971199",
    "end": "976680"
  },
  {
    "text": "in the user users browsers can users browser can exfiltrate this URL to the",
    "start": "976680",
    "end": "982160"
  },
  {
    "text": "attacker and attacker can ride the same session with the user with the same set of privileges password set is of course",
    "start": "982160",
    "end": "989319"
  },
  {
    "text": "another lovely example where in the URL can be uh can be stolen from from the",
    "start": "989319",
    "end": "995639"
  },
  {
    "text": "user and that taka can not only access the the the the uh the account the taka",
    "start": "995639",
    "end": "1001440"
  },
  {
    "text": "can also look out the the genuine user by choosing the attacker's password before the user manages to to click the",
    "start": "1001440",
    "end": "1008920"
  },
  {
    "text": "URL and so um it's even more powerful in such cases uh also keep in mind the uh",
    "start": "1008920",
    "end": "1017000"
  },
  {
    "text": "this scenario where URLs can have username and password as part of the URL",
    "start": "1017000",
    "end": "1022680"
  },
  {
    "text": "before the host name like the https colum username column password at host",
    "start": "1022680",
    "end": "1028678"
  },
  {
    "text": "name this is uh applicable to http and https as well as for FTP although we",
    "start": "1028679",
    "end": "1034240"
  },
  {
    "text": "need to note that for FTP and HTTP not https uh this this kind of credential",
    "start": "1034240",
    "end": "1039360"
  },
  {
    "text": "theft is an optimization because the pack um the malicious pack file can simply direct all traffic to the",
    "start": "1039360",
    "end": "1046240"
  },
  {
    "text": "attacker's uh proxy uh server in which case PL Tex traffic like HTTP and FTP",
    "start": "1046240",
    "end": "1051720"
  },
  {
    "text": "already contains those already contain those their credentials and thus the attacker can obtain those credentials",
    "start": "1051720",
    "end": "1057440"
  },
  {
    "text": "even without URL exfiltration however this is a very",
    "start": "1057440",
    "end": "1063799"
  },
  {
    "text": "inefficient way of doing so but because passing all traffic through a through a proxy is a is a CPU consuming Network",
    "start": "1063799",
    "end": "1071960"
  },
  {
    "text": "consuming and may flag flag the attackers activity uh to any U anomaly",
    "start": "1071960",
    "end": "1078000"
  },
  {
    "text": "detected detection uh logic that exists on the",
    "start": "1078000",
    "end": "1083039"
  },
  {
    "text": "network um we need to know that uh the the concept of a malicious wpad pointing",
    "start": "1083559",
    "end": "1089240"
  },
  {
    "text": "at a malicious spark was discussed by the U respectable researchers from net",
    "start": "1089240",
    "end": "1095760"
  },
  {
    "text": "resek and positive security earlier uh however they do what they uh what they",
    "start": "1095760",
    "end": "1103039"
  },
  {
    "text": "describe is just routing the whole traffic through to a to through a militia proxy which provides access to",
    "start": "1103039",
    "end": "1111080"
  },
  {
    "text": "http uh traffic and FTP traffic perhaps but not to htps traffic because htps",
    "start": "1111080",
    "end": "1116840"
  },
  {
    "text": "traffic is encrypted before it arrives at a",
    "start": "1116840",
    "end": "1121600"
  },
  {
    "start": "1122000",
    "end": "1180000"
  },
  {
    "text": "proxy uh there were some mentions of this uh of this concept of a EUR EUR",
    "start": "1122039",
    "end": "1129960"
  },
  {
    "text": "exfiltration through malicious SP uh by it was very briefly mentioned in an",
    "start": "1129960",
    "end": "1135720"
  },
  {
    "text": "answer by Leon of in stock exchange uh",
    "start": "1135720",
    "end": "1140919"
  },
  {
    "text": "dur which was uh published during our own research to the matter was described",
    "start": "1140919",
    "end": "1147400"
  },
  {
    "text": "very briefly in an M thesis that was published in May 3rd after our uh our",
    "start": "1147400",
    "end": "1152919"
  },
  {
    "text": "own um submission to blackhead by Nicholas",
    "start": "1152919",
    "end": "1158200"
  },
  {
    "text": "gulich uh as well as a Blog by Maxim andreev about this concept back in June",
    "start": "1158200",
    "end": "1165360"
  },
  {
    "text": "again while we were researching this topic uh unfortunately this blog was in Russian so we couldn't really find it by",
    "start": "1165360",
    "end": "1172760"
  },
  {
    "text": "the way Maxim presents in parallel to us so good luck to Maxim on this in his",
    "start": "1172760",
    "end": "1178799"
  },
  {
    "text": "presentation um all those um per art uh",
    "start": "1178799",
    "end": "1185640"
  },
  {
    "text": "cases uh did not really uh expand too much on this concept uh we did we",
    "start": "1185640",
    "end": "1192919"
  },
  {
    "text": "provide full weaponization of this concept including supporting long URLs multiple messages and multiple clients",
    "start": "1192919",
    "end": "1199360"
  },
  {
    "text": "we describe a two-way protocol from the pack from theous pack to an attacker we",
    "start": "1199360",
    "end": "1205600"
  },
  {
    "text": "an attack an attacker server we provide open source and free code that implements all what we talk about uh we",
    "start": "1205600",
    "end": "1212880"
  },
  {
    "text": "also discuss uh a related additional concept called pack malware uh we",
    "start": "1212880",
    "end": "1218799"
  },
  {
    "text": "provide a pack feature Matrix uh and provide all this in",
    "start": "1218799",
    "end": "1225480"
  },
  {
    "start": "1225000",
    "end": "1254000"
  },
  {
    "text": "English so let's see the ingredients that the attacker needs in order to implement this attack so in order the",
    "start": "1225600",
    "end": "1231679"
  },
  {
    "text": "attacker needs some way of spoofing the hcp responses and or DMS responses the",
    "start": "1231679",
    "end": "1237000"
  },
  {
    "text": "attacker then needs to provide a web server to serve the malicious pack and then the attacker also needs the",
    "start": "1237000",
    "end": "1243600"
  },
  {
    "text": "attacker's own uh domain uh controlled with a an author DNS server uh as a",
    "start": "1243600",
    "end": "1250720"
  },
  {
    "text": "command and control server uh with the most important piece",
    "start": "1250720",
    "end": "1257440"
  },
  {
    "text": "in this uh uh in this scheme is the Appling or exfiltration protocol",
    "start": "1257440",
    "end": "1263200"
  },
  {
    "text": "um the DNS and the attacker so first let's see some uh basic concepts uh for",
    "start": "1263200",
    "end": "1270799"
  },
  {
    "text": "DNS saix we the attacker needs a DNS suffix that is owned by the attacker we call it",
    "start": "1270799",
    "end": "1277880"
  },
  {
    "text": "suffix uh each browser needs to have its own unique ID so we can uh split traffic",
    "start": "1277880",
    "end": "1284279"
  },
  {
    "text": "between browsers uh we call it client ID we the uh this unique ID can be random",
    "start": "1284279",
    "end": "1290000"
  },
  {
    "text": "and indeed this is how we implement it and then each message within a browser needs to have a unique ID that can be",
    "start": "1290000",
    "end": "1296159"
  },
  {
    "text": "incremental which we call message ID having this the definition of the protocol is as following we first first",
    "start": "1296159",
    "end": "1303360"
  },
  {
    "text": "we hex and code uh the string that we need to exfiltrate this is not so sufficient uh",
    "start": "1303360",
    "end": "1310400"
  },
  {
    "text": "obviously we can use other schemes to uh encode it in a more sufficient manner",
    "start": "1310400",
    "end": "1315679"
  },
  {
    "text": "but we leave that for for addition uh uh research then we break the message",
    "start": "1315679",
    "end": "1322960"
  },
  {
    "text": "into fragments up to 62 characters because DNS labels are limited to 63 characters then every three or four",
    "start": "1322960",
    "end": "1329880"
  },
  {
    "text": "fragments uh will fill a DNS query but we need to keep the total length less than 253 which is the DNS limit for for",
    "start": "1329880",
    "end": "1338320"
  },
  {
    "text": "host name this forms a chunk and we assign the chunk with a chunk ID number",
    "start": "1338320",
    "end": "1343760"
  },
  {
    "text": "and then we xfilter the chunk via DNS sare so the format as you can see is as following and the last chunk is",
    "start": "1343760",
    "end": "1350640"
  },
  {
    "text": "prepended by X to Mark the end of the message it's demo time right now it's",
    "start": "1350640",
    "end": "1358080"
  },
  {
    "start": "1355000",
    "end": "1564000"
  },
  {
    "text": "think so okay thank very much Amit um so we will present our demo on how we are",
    "start": "1358080",
    "end": "1363679"
  },
  {
    "text": "basically going to infect a Windows 10 machine using the DCP uh method that I",
    "start": "1363679",
    "end": "1369440"
  },
  {
    "text": "me just",
    "start": "1369440",
    "end": "1371840"
  },
  {
    "text": "described so as I M has explained there's a couple different ingredients s in order for us to align this attack the",
    "start": "1374520",
    "end": "1380960"
  },
  {
    "text": "first one is that we need to run a DHCP service which going to offer the uh op",
    "start": "1380960",
    "end": "1386360"
  },
  {
    "text": "code 252 and as you can see as I'm highlighting right now on my screen uh",
    "start": "1386360",
    "end": "1391440"
  },
  {
    "text": "it will basically serve uh the Windows 10 machine with this with this option pointing to this URL obviously we need",
    "start": "1391440",
    "end": "1399080"
  },
  {
    "text": "to run the DHCP service we're going to have a very simple web service that will basically web server sorry that will",
    "start": "1399080",
    "end": "1405720"
  },
  {
    "text": "basically serve the malicious po file to the machine and we have our Command",
    "start": "1405720",
    "end": "1411120"
  },
  {
    "text": "control um um malicious pack ready for action",
    "start": "1411120",
    "end": "1416840"
  },
  {
    "text": "so um here's a very vanilla installation of uh Windows 10 and we have using",
    "start": "1416840",
    "end": "1423360"
  },
  {
    "text": "Chrome version 51 and basically what I'm going to do now is I'm going to switch the machine to the malicious",
    "start": "1423360",
    "end": "1431799"
  },
  {
    "text": "Network and I'm going to re release to renew my uh my",
    "start": "1432480",
    "end": "1440840"
  },
  {
    "text": "DHCP as you can see I've served the machine with a gtcp the machine already",
    "start": "1446440",
    "end": "1451480"
  },
  {
    "text": "accessed my web server and I have hit on the proxy pack file and as you can see",
    "start": "1451480",
    "end": "1457039"
  },
  {
    "text": "also requests are starting to come in so here's our interactive maware there's a",
    "start": "1457039",
    "end": "1462880"
  },
  {
    "text": "couple of very basic commands and we'll show them during the demo right now you can see that there is no your has been",
    "start": "1462880",
    "end": "1470880"
  },
  {
    "text": "captured opening this chrome version 51 let's do a very basic surfing to uh",
    "start": "1475399",
    "end": "1482720"
  },
  {
    "text": "blacket website um let's go into an https",
    "start": "1482720",
    "end": "1492158"
  },
  {
    "text": "URL as you can see everything is uh is very normal there is no change in the UI",
    "start": "1494000",
    "end": "1500880"
  },
  {
    "text": "but at the same time going back you can see that all these different URLs have",
    "start": "1500880",
    "end": "1507760"
  },
  {
    "text": "been captured now as a described earlier if you are using um single sign SSO",
    "start": "1507760",
    "end": "1515480"
  },
  {
    "text": "links or tokens Within These URLs let's make this this one",
    "start": "1515480",
    "end": "1521919"
  },
  {
    "text": "up um basically our mware also has a functionality to search for it",
    "start": "1521919",
    "end": "1529679"
  },
  {
    "text": "sorry so again we can Target and using our proof of concept malware to extract",
    "start": "1548559",
    "end": "1554200"
  },
  {
    "text": "different tokens and different parameters um which are been send in the URLs Amit back to",
    "start": "1554200",
    "end": "1562720"
  },
  {
    "text": "you thank you I um so we are responsible researchers so we need to tell you the",
    "start": "1563520",
    "end": "1569559"
  },
  {
    "start": "1564000",
    "end": "1811000"
  },
  {
    "text": "fine print first the the existing wpad problem uh if we're coming if we're",
    "start": "1569559",
    "end": "1576520"
  },
  {
    "text": "attacking a network that serves typically uh wpad resources already then",
    "start": "1576520",
    "end": "1582880"
  },
  {
    "text": "we need to incorporate this uh this the W the genuine wpad LC in our own",
    "start": "1582880",
    "end": "1588799"
  },
  {
    "text": "malicious logic we can do that by first capturing the the the genuine wpad",
    "start": "1588799",
    "end": "1594360"
  },
  {
    "text": "before the attack and then incorporating the original fine proxy for URL maybe",
    "start": "1594360",
    "end": "1600039"
  },
  {
    "text": "adding something adding a prefix or suffix uh so that it will not be there",
    "start": "1600039",
    "end": "1606000"
  },
  {
    "text": "uh it will differentiate it from the fine proxy for your function that we're",
    "start": "1606000",
    "end": "1611200"
  },
  {
    "text": "about to code and in our fine proxy for URL the last step is to return the",
    "start": "1611200",
    "end": "1616360"
  },
  {
    "text": "calculation made made by the original F proxy for the for URL to the",
    "start": "1616360",
    "end": "1622480"
  },
  {
    "text": "browser uh another case that we need to consider is when we force a network that",
    "start": "1622480",
    "end": "1629080"
  },
  {
    "text": "does not have wpad to or force a browser that's connected to a network that does not have wpad to use a wpad in this in",
    "start": "1629080",
    "end": "1637120"
  },
  {
    "text": "this case Internet Explorer uh makes us face a problem because in",
    "start": "1637120",
    "end": "1644240"
  },
  {
    "text": "Internet Explorer if uh uh if it is configured to use a proxy in general and",
    "start": "1644240",
    "end": "1649559"
  },
  {
    "text": "wpad is is definitely such a configuration and a site is and one one",
    "start": "1649559",
    "end": "1654600"
  },
  {
    "text": "site is or some sites are exempt from being proxied in which which are which",
    "start": "1654600",
    "end": "1660120"
  },
  {
    "text": "is the case when WP returns a direct directive then those sites are automatically considered by Internet",
    "start": "1660120",
    "end": "1666519"
  },
  {
    "text": "Explorer to be interet in the internet Zone which is a problem because for from",
    "start": "1666519",
    "end": "1672440"
  },
  {
    "text": "uh the sites that are in the internet Zone uh have their cookies uh container",
    "start": "1672440",
    "end": "1679399"
  },
  {
    "text": "residing in a different location than sites that that are in the internet zone so whatever the user was used to uh in",
    "start": "1679399",
    "end": "1686919"
  },
  {
    "text": "we of cookies and and so forth will no longer work when the site is now considered in the internet zone so it",
    "start": "1686919",
    "end": "1694080"
  },
  {
    "text": "has some user experience problems uh also in some Internet Explorer versions there is an visual indicator when a site",
    "start": "1694080",
    "end": "1700919"
  },
  {
    "text": "is is considered internet zone so we want to avoid this problem one way of",
    "start": "1700919",
    "end": "1706080"
  },
  {
    "text": "avoiding it is just tell that to return return a proxy value for each and every",
    "start": "1706080",
    "end": "1712960"
  },
  {
    "text": "URL that is that uh for which fine proxy for is involved obviously a non-optimal",
    "start": "1712960",
    "end": "1719200"
  },
  {
    "text": "situation but much better than interrupting or impacting the user",
    "start": "1719200",
    "end": "1725440"
  },
  {
    "text": "experience uh as as mentioned earlier the Ural interception quality varies among browsers U so uh in chroman five",
    "start": "1725440",
    "end": "1734559"
  },
  {
    "text": "in chroman version up to 51 and including and in Firefox the interception quality",
    "start": "1734559",
    "end": "1739919"
  },
  {
    "text": "is good Firefox actually didn't check 48 which was released yesterday uh and in",
    "start": "1739919",
    "end": "1745679"
  },
  {
    "text": "Chrome 52 which was released two weeks ago uh they uh addressed the",
    "start": "1745679",
    "end": "1750799"
  },
  {
    "text": "problem in Internet Explorer and in Ed and in Safari the URL interception quality is pretty bad that is the URLs",
    "start": "1750799",
    "end": "1757519"
  },
  {
    "text": "are trimmed I'll touch I'll touch that in a later slide and thus are almost",
    "start": "1757519",
    "end": "1762640"
  },
  {
    "text": "useless to us uh https and HTP Authentication credentials that those",
    "start": "1762640",
    "end": "1768480"
  },
  {
    "text": "credentials that come before the host name of the at sign um are only",
    "start": "1768480",
    "end": "1774559"
  },
  {
    "text": "intercepted in Firefox and FTP credentials are intercepted in Firefox and T explor 8 and",
    "start": "1774559",
    "end": "1780320"
  },
  {
    "text": "Safari um the Uplink as we said is limited to 100 bytes per DNS query so",
    "start": "1780320",
    "end": "1785640"
  },
  {
    "text": "this is unoptimized we can probably squeeze almost 200 bytes if we do it right and we then the protocol we",
    "start": "1785640",
    "end": "1792880"
  },
  {
    "text": "designed does not handle packet loss and latency issues we can probably add some TCP like functions to it later it's",
    "start": "1792880",
    "end": "1798919"
  },
  {
    "text": "another uh topic for further research as for the down link it will be described",
    "start": "1798919",
    "end": "1804240"
  },
  {
    "text": "in part two and we will'll just hint that we use evil the evil function for maximum",
    "start": "1804240",
    "end": "1810760"
  },
  {
    "text": "flexibility to summarize this part of this of the presentation I think what",
    "start": "1810760",
    "end": "1816000"
  },
  {
    "start": "1811000",
    "end": "1858000"
  },
  {
    "text": "we've demonstrated is that the common belief that htps traffic is secure even when used in hosle network is refuted",
    "start": "1816000",
    "end": "1823720"
  },
  {
    "text": "with the wpad scenario what we've demonstrated is is a way to bypass https",
    "start": "1823720",
    "end": "1829679"
  },
  {
    "text": "uh at least for URLs providing access to htps URLs uh obviously it only works",
    "start": "1829679",
    "end": "1835279"
  },
  {
    "text": "when the browser and Opera system is configured to use wpad uh it assumes that the attacker has access to the",
    "start": "1835279",
    "end": "1841519"
  },
  {
    "text": "local network and the interception quality is browser specific uh we also showed that the",
    "start": "1841519",
    "end": "1848559"
  },
  {
    "text": "https URLs can carry sensitive information like credentials or access tokens and we we touch the topic of FTP",
    "start": "1848559",
    "end": "1856279"
  },
  {
    "text": "credentials now we are moving to part two the PM",
    "start": "1856279",
    "end": "1861399"
  },
  {
    "text": "where it's a related but somewhat different concept and the main idea of pmo is that",
    "start": "1861399",
    "end": "1868360"
  },
  {
    "text": "we have temporary access to the machine it's now it's not a remote attack it's a",
    "start": "1868360",
    "end": "1874519"
  },
  {
    "text": "local attack uh that that can be achieved via malware running once on the machine and",
    "start": "1874519",
    "end": "1881240"
  },
  {
    "text": "then deleting itself or by or manually but by someone having temporary access",
    "start": "1881240",
    "end": "1886799"
  },
  {
    "text": "to the machine um and it turns that in Windows all you need to do in order to",
    "start": "1886799",
    "end": "1891919"
  },
  {
    "text": "configure a machine or a browser to use a prox to pack is to set a registry key",
    "start": "1891919",
    "end": "1898000"
  },
  {
    "text": "uh a single registry key um the pack URL unlike wpad is supported by iPhone and",
    "start": "1898000",
    "end": "1905279"
  },
  {
    "text": "Android at at least in version 50 and above uh interestingly enough the pack",
    "start": "1905279",
    "end": "1911760"
  },
  {
    "text": "URL can be designated by a file scheme in some browsers at least uh and all of",
    "start": "1911760",
    "end": "1917480"
  },
  {
    "text": "them of course support HTTP or https schemes uh the file scheme can be UNC or",
    "start": "1917480",
    "end": "1923080"
  },
  {
    "text": "local file also HTTP or https that the the resource or the the host can be",
    "start": "1923080",
    "end": "1929720"
  },
  {
    "text": "local in which case the malware may want to install its own web server to serve the pack or it can be a remote uh remote",
    "start": "1929720",
    "end": "1938200"
  },
  {
    "text": "destination uh unlike the remote attack a local a local attack can also tck the",
    "start": "1938200",
    "end": "1944720"
  },
  {
    "text": "registry so that Internet Explorer will will not uh use unpro will not assign unox uh",
    "start": "1944720",
    "end": "1952919"
  },
  {
    "text": "destinations to the internet Zone and more interestingly it it is possible to tweak",
    "start": "1952919",
    "end": "1959880"
  },
  {
    "text": "the registry so that Internet Explorer will report each URL in full and we",
    "start": "1959880",
    "end": "1965080"
  },
  {
    "text": "mentioned earlier Internet Explorer is trims the URL so that they are useless",
    "start": "1965080",
    "end": "1971600"
  },
  {
    "text": "uh but if you have access to to Temporary access to the machine and you can change this registry key Internet",
    "start": "1971600",
    "end": "1978639"
  },
  {
    "text": "Explorer will start reporting full URLs um some Financial Mal malware which",
    "start": "1978639",
    "end": "1986880"
  },
  {
    "start": "1983000",
    "end": "2009000"
  },
  {
    "text": "sometimes called Bankers do install malicious packs as as malware but they",
    "start": "1986880",
    "end": "1992720"
  },
  {
    "text": "do so in order to to root the traffic all traffic to their own proxy servers",
    "start": "1992720",
    "end": "1998720"
  },
  {
    "text": "and as we said earlier uh this will provide access this this will grant access to the attacker to HTP traffic",
    "start": "1998720",
    "end": "2005080"
  },
  {
    "text": "but not to htps traffic so what are the pack Mal capabilities",
    "start": "2005080",
    "end": "2012480"
  },
  {
    "start": "2009000",
    "end": "2132000"
  },
  {
    "text": "like I said pack can be installed as local file or UNC file or if we're talking about HTTP or https either Lo on",
    "start": "2012480",
    "end": "2019919"
  },
  {
    "text": "a local machine but then you also have to install web server or on a remote",
    "start": "2019919",
    "end": "2025559"
  },
  {
    "text": "URL uh it is capable of intercepting URLs we can establish a two-way link up",
    "start": "2025559",
    "end": "2032159"
  },
  {
    "text": "link and down link over DNS queries",
    "start": "2032159",
    "end": "2038000"
  },
  {
    "text": "uh we can use the alert messages to display social engineering popups this",
    "start": "2038000",
    "end": "2043039"
  },
  {
    "text": "works only in Internet Explorer we can use evil for maximum flexibility and here's the thing if you have a two-way",
    "start": "2043039",
    "end": "2049398"
  },
  {
    "text": "uh um CNC protocol you can the browser or the pack logic actually can request",
    "start": "2049399",
    "end": "2056638"
  },
  {
    "text": "data from the CNC server now in order to provide maximum flexibility the pack file can download",
    "start": "2056639",
    "end": "2064520"
  },
  {
    "text": "data from the CNC server and then in voke evil on this data so that this data",
    "start": "2064520",
    "end": "2070118"
  },
  {
    "text": "actually is intercept inter inter inter interpreted sorry as code",
    "start": "2070119",
    "end": "2076839"
  },
  {
    "text": "and this provides maximum flexibility so that one day you the the PM can do this",
    "start": "2076839",
    "end": "2082320"
  },
  {
    "text": "and an hour later it can do that all using evil and and flexible JavaScript",
    "start": "2082320",
    "end": "2087440"
  },
  {
    "text": "code that is downloaded from the CNC server one important feature for pack",
    "start": "2087440",
    "end": "2092960"
  },
  {
    "text": "malware that is of interest is that the possibility to uh route data to a",
    "start": "2092960",
    "end": "2099320"
  },
  {
    "text": "proxy this can be used for dos against the remote site you can designate the site by IP address or by port or U to or",
    "start": "2099320",
    "end": "2108680"
  },
  {
    "text": "we can use a denial of service or you can use it as a denial of service locally against specific sites uh for",
    "start": "2108680",
    "end": "2115160"
  },
  {
    "text": "example we can root a download or update doyou antivirus here.com to an IP",
    "start": "2115160",
    "end": "2121720"
  },
  {
    "text": "address which does not return any value or any any response thereby effectively",
    "start": "2121720",
    "end": "2127160"
  },
  {
    "text": "Den denying access from the local machine to those sites the downloading protocol comprises",
    "start": "2127160",
    "end": "2134599"
  },
  {
    "start": "2132000",
    "end": "2165000"
  },
  {
    "text": "of three bytes out of the four returned from from a DNS query and the so",
    "start": "2134599",
    "end": "2140839"
  },
  {
    "text": "messages can be numbered uh and each and when we uh and then the message length",
    "start": "2140839",
    "end": "2147040"
  },
  {
    "text": "is obtained by resolving length. message id. suffix returning three bytes designating the length the message",
    "start": "2147040",
    "end": "2153040"
  },
  {
    "text": "length and then consecutive three bytes of the uh message can be obtained by H",
    "start": "2153040",
    "end": "2159079"
  },
  {
    "text": "looping through them and and requesting number. message id.",
    "start": "2159079",
    "end": "2164880"
  },
  {
    "text": "saix and a second demo by I please thank you Amit",
    "start": "2164880",
    "end": "2172200"
  },
  {
    "start": "2172000",
    "end": "2297000"
  },
  {
    "text": "um so we're going to demonstrate right now some of the features that the has discussed about this m capability um I'm",
    "start": "2172200",
    "end": "2179599"
  },
  {
    "text": "going to attack right now the default um Firefox that uh is coming with Ubuntu 16",
    "start": "2179599",
    "end": "2187880"
  },
  {
    "text": "um .0 the way I'm going to implement this attack is I'm going to create a",
    "start": "2187880",
    "end": "2192960"
  },
  {
    "text": "main midle um to make things easier I've configured this machine DNS to basically be the server of the the pack maware and",
    "start": "2192960",
    "end": "2201920"
  },
  {
    "text": "of course again we're setting up a small web server to sep to serve the pack file itself so right now what we're going to",
    "start": "2201920",
    "end": "2209280"
  },
  {
    "text": "do is we're going to fire up fir Fox and then configure it um to use the um the",
    "start": "2209280",
    "end": "2216000"
  },
  {
    "text": "definition of of the automatic proxy so let's do",
    "start": "2216000",
    "end": "2222000"
  },
  {
    "text": "that switching it from here to here",
    "start": "2227000",
    "end": "2233079"
  },
  {
    "text": "and hold up",
    "start": "2233079",
    "end": "2239280"
  },
  {
    "text": "okay and now we're going to surf again into a just a regular website",
    "start": "2239280",
    "end": "2248359"
  },
  {
    "text": "that website should now be appearing in the list of captures URL and as a m",
    "start": "2248359",
    "end": "2254680"
  },
  {
    "text": "mention one of the capabilities of a pack maware is to prevent access shut down access to different websites we",
    "start": "2254680",
    "end": "2261560"
  },
  {
    "text": "call it triggers in our pack maware and basically what I'm going to do right now is I'm going to shut down any umom",
    "start": "2261560",
    "end": "2270240"
  },
  {
    "text": "websites using the pack maware and going back into our browser uh you can can see",
    "start": "2270240",
    "end": "2276920"
  },
  {
    "text": "that once I'm refreshing blacket no longer working you can see it's happening the same for htps URLs however",
    "start": "2276920",
    "end": "2287400"
  },
  {
    "text": "trying Defcon you can see that it's",
    "start": "2287400",
    "end": "2292560"
  },
  {
    "text": "working Amit back to you thank you I to summarize we've seen",
    "start": "2292560",
    "end": "2299640"
  },
  {
    "start": "2297000",
    "end": "2322000"
  },
  {
    "text": "an unorthodoc installation pack only makes it a bit harder for antivirus products to detect it we've seen that",
    "start": "2299640",
    "end": "2306319"
  },
  {
    "text": "pack Mal is capable of depending on the browser htps URL interception denial of",
    "start": "2306319",
    "end": "2311720"
  },
  {
    "text": "service and distributed Deni of service and we've discussed the fact that we have a two-way command and control",
    "start": "2311720",
    "end": "2317599"
  },
  {
    "text": "protocol via DNS with and flexible execution via eval now here is a metrix describing how",
    "start": "2317599",
    "end": "2328160"
  },
  {
    "start": "2322000",
    "end": "2425000"
  },
  {
    "text": "uh various browsers have H uh how various browsers Implement various pack",
    "start": "2328160",
    "end": "2335520"
  },
  {
    "text": "features um you can see more or less we we've touched all those uh topics but in",
    "start": "2335520",
    "end": "2341599"
  },
  {
    "text": "the uh top left corner we see Internet Explorer uh 11 and Edge and in and",
    "start": "2341599",
    "end": "2347920"
  },
  {
    "text": "Microsoft Edge uh they have file they do not have file support by default but we can turn it on in registry and fine",
    "start": "2347920",
    "end": "2355400"
  },
  {
    "text": "proxy for your Ro invocation frequency is by default trimmed but we can set it up as the full URLs Again by again by a",
    "start": "2355400",
    "end": "2363720"
  },
  {
    "text": "registry settings uh the Safari er uh items and iPhone for fine proxy for your",
    "start": "2363720",
    "end": "2371119"
  },
  {
    "text": "invocation are trimmed at this moment but earlier this year they were providing full URLs uh so this is pretty",
    "start": "2371119",
    "end": "2379319"
  },
  {
    "text": "fresh and note that we uh report on Chrome 51 but uh in Chrome 52 two weeks",
    "start": "2379319",
    "end": "2385440"
  },
  {
    "text": "ago uh the URL is again trimmed and Firefox uh we report on",
    "start": "2385440",
    "end": "2393200"
  },
  {
    "text": "4701 but uh we have not tested yet 48 which was released yesterday uh the DNS",
    "start": "2393200",
    "end": "2399160"
  },
  {
    "text": "resolve bug line at the bottom is interesting we noticed that in all Internet Explorer uh in all Microsoft",
    "start": "2399160",
    "end": "2406359"
  },
  {
    "text": "browsers there's an a funny bug if you invoke DNS resolve without using the",
    "start": "2406359",
    "end": "2411599"
  },
  {
    "text": "result in any calculation it will throw an exception this is why we needed to H to add an empty string to the DNS",
    "start": "2411599",
    "end": "2419160"
  },
  {
    "text": "resolve result in the in the malicious P",
    "start": "2419160",
    "end": "2424839"
  },
  {
    "text": "example so let's discuss ideas for remediation and fix uh remediation first",
    "start": "2424839",
    "end": "2430800"
  },
  {
    "start": "2425000",
    "end": "2480000"
  },
  {
    "text": "uh at the user level we suggest disabling wpad in untrusted networks or in general if possible uh if you do need",
    "start": "2430800",
    "end": "2438839"
  },
  {
    "text": "uh to access an untrusted uh Network we propose that you use a browser that",
    "start": "2438839",
    "end": "2444119"
  },
  {
    "text": "exposes as little as possible of the URL to find proxy for URL that is trimed URLs uh at the corporate level we",
    "start": "2444119",
    "end": "2451359"
  },
  {
    "text": "suggest avoid using wpad which will allow the corporate to turn off w in all",
    "start": "2451359",
    "end": "2456839"
  },
  {
    "text": "the browsers and machines server side we suggest removing security related data",
    "start": "2456839",
    "end": "2462480"
  },
  {
    "text": "or tokens from URLs when possible it's not always possible of course but when it is it's a good idea also to move away",
    "start": "2462480",
    "end": "2469079"
  },
  {
    "text": "from HTTP authentication assuming that it is under TLS in the first place so in general using a sensitive data inside",
    "start": "2469079",
    "end": "2476240"
  },
  {
    "text": "URL is is not a good idea as for a more robust fix we call",
    "start": "2476240",
    "end": "2483160"
  },
  {
    "start": "2480000",
    "end": "2530000"
  },
  {
    "text": "upon ietf to fix a wpad semi and to turn it into a standard by the way and force",
    "start": "2483160",
    "end": "2489200"
  },
  {
    "text": "a secure pack retrieval where in the client identifies or or validates that",
    "start": "2489200",
    "end": "2494400"
  },
  {
    "text": "the pack is is genuine and is provided by by the genuine Network operator uh of",
    "start": "2494400",
    "end": "2500960"
  },
  {
    "text": "course over uh and using a uh transport",
    "start": "2500960",
    "end": "2506119"
  },
  {
    "text": "uh in transit security right now this is not mandated and to standardize the the",
    "start": "2506119",
    "end": "2511480"
  },
  {
    "text": "pack maybe trim the URL to host only or and and or deprecate DNS resolution as",
    "start": "2511480",
    "end": "2518920"
  },
  {
    "text": "for browser vendors we propose restricting the pack functionality by trimming the URL and disabling DNS",
    "start": "2518920",
    "end": "2524480"
  },
  {
    "text": "resolution and some browser vendos indeed started walking this",
    "start": "2524480",
    "end": "2530079"
  },
  {
    "start": "2530000",
    "end": "2625000"
  },
  {
    "text": "path to conclude uh what we saw here in general is that interception of htps",
    "start": "2530079",
    "end": "2536119"
  },
  {
    "text": "URLs uh is has some serious security consequences we talked about credential theft and session hijing and in general",
    "start": "2536119",
    "end": "2542920"
  },
  {
    "text": "loss of privacy additionally pack in can do fishing by invoking alert and denial of",
    "start": "2542920",
    "end": "2551280"
  },
  {
    "text": "service and distributed denial of service specifically to the remote scenario trusting a pack retrieved in",
    "start": "2551280",
    "end": "2558960"
  },
  {
    "text": "the clear from an unverified external source for handling secure meaning https",
    "start": "2558960",
    "end": "2564400"
  },
  {
    "text": "traffic is a problematic concept we believe that this is the root cause for",
    "start": "2564400",
    "end": "2569760"
  },
  {
    "text": "the https uh exfiltration problem uh the remote scenario is also",
    "start": "2569760",
    "end": "2575440"
  },
  {
    "text": "not that the remote scenario is also difficult to detect locally by antiviruses and so forth because it",
    "start": "2575440",
    "end": "2580640"
  },
  {
    "text": "leaves very little uh footprint on the machine the P malare scenario is an",
    "start": "2580640",
    "end": "2586520"
  },
  {
    "text": "unusual Marlo persistance which which is not necessarily detected by all",
    "start": "2586520",
    "end": "2592280"
  },
  {
    "text": "antiviruses uh still it's a very powerful concept it can it can even obtain more than the remote attack",
    "start": "2592280",
    "end": "2599119"
  },
  {
    "text": "because we can tweak the registry to provide more",
    "start": "2599119",
    "end": "2603280"
  },
  {
    "text": "information uh uh it's now time for question and answers but we also remind you uh to fill the feedback",
    "start": "2604920",
    "end": "2613558"
  },
  {
    "text": "form [Applause]",
    "start": "2615359",
    "end": "2622820"
  },
  {
    "text": "okay",
    "start": "2624200",
    "end": "2627200"
  }
]