[
  {
    "start": "0",
    "end": "82000"
  },
  {
    "text": "good morning welcome to Breaking payment points of interaction presented by near vultan and Patrick Watson in manderlay",
    "start": "80",
    "end": "6720"
  },
  {
    "text": "Bay BCD before we begin a few brief notes stop by the business Hall located in",
    "start": "6720",
    "end": "13440"
  },
  {
    "text": "Bayside AB during the day and for the welcome reception from 5:30 to 7:00 p.m.",
    "start": "13440",
    "end": "19039"
  },
  {
    "text": "tonight the black hat Arsenal is on in the Palm for foyer on Level 3 join us",
    "start": "19039",
    "end": "25880"
  },
  {
    "text": "for the pony Awards in Mandalay Bay BCD this room at 6:30",
    "start": "25880",
    "end": "31200"
  },
  {
    "text": "p.m. uh thank you for putting your phones on vibrate it makes it easier for the rest of us to ignore the ringing",
    "start": "31200",
    "end": "36760"
  },
  {
    "text": "while you wait for your voice mael to pick up with that near and",
    "start": "36760",
    "end": "42280"
  },
  {
    "text": "Patrick good afternoon so today we're going to speak",
    "start": "44039",
    "end": "50559"
  },
  {
    "text": "about uh breaking points of interaction it's a pretty cool title so",
    "start": "50559",
    "end": "56440"
  },
  {
    "text": "when we submitted our cfp um we got a respond says are you going to bypass EMV",
    "start": "56440",
    "end": "64080"
  },
  {
    "text": "are you going to bypass chip and pain I just want to make sure that I got it correctly yes we're going to do that in",
    "start": "64080",
    "end": "71040"
  },
  {
    "text": "this talk we have few demos and um you may be pretty much",
    "start": "71040",
    "end": "76360"
  },
  {
    "text": "surprised from the findings that we have here today so before we begin we have a small",
    "start": "76360",
    "end": "83320"
  },
  {
    "start": "82000",
    "end": "164000"
  },
  {
    "text": "challenge the challenge is to introduce ourselves since we like to speak a lot about ourselves we made an XML file that",
    "start": "83320",
    "end": "90720"
  },
  {
    "text": "describes ourselves oh you can't read it ah I",
    "start": "90720",
    "end": "95920"
  },
  {
    "text": "thought you can okay anyway so we just made a shorter version of ourselves and",
    "start": "95920",
    "end": "100960"
  },
  {
    "text": "um so I'm near I'm heading the application security for uh the NCR Corporation I um I spoke at several",
    "start": "100960",
    "end": "109439"
  },
  {
    "text": "conferences including blackhead Dacon besides and um I really like contribute",
    "start": "109439",
    "end": "114640"
  },
  {
    "text": "to open- Source stuff that's me I'll hand it over to Patrick I'm Patrick",
    "start": "114640",
    "end": "119920"
  },
  {
    "text": "Watson I'm a application security architect working with near at NCR my",
    "start": "119920",
    "end": "125000"
  },
  {
    "text": "job is basically to make sure that our systems are nice and secure and I kind",
    "start": "125000",
    "end": "130800"
  },
  {
    "text": "of think of things as if if our systems if we're not supposed to talk about how",
    "start": "130800",
    "end": "135879"
  },
  {
    "text": "they work then that means they're probably not secure enough cuz well you",
    "start": "135879",
    "end": "140920"
  },
  {
    "text": "know the old saying about security through obscurity now this is my second",
    "start": "140920",
    "end": "146440"
  },
  {
    "text": "talk that the first one was yesterday at bside so hoay for me first time at black",
    "start": "146440",
    "end": "151920"
  },
  {
    "text": "hat but I'm sort of on the uh engineering side of things and let's",
    "start": "151920",
    "end": "157879"
  },
  {
    "text": "talk about what our research actually is doing uh the so part of our job like I",
    "start": "157879",
    "end": "166840"
  },
  {
    "start": "164000",
    "end": "286000"
  },
  {
    "text": "said is to make sure that our systems are secure and that means not just the software made by NCR it's also the whole",
    "start": "166840",
    "end": "173959"
  },
  {
    "text": "ecosystem of the site or bank or wherever it is our software is running so we take our software and we",
    "start": "173959",
    "end": "181599"
  },
  {
    "text": "also analyze the devices and Hardware software combinations from the other vendors at the site part of that is that",
    "start": "181599",
    "end": "190720"
  },
  {
    "text": "when we're evaluating those we took some of our software protections turned them",
    "start": "190720",
    "end": "196840"
  },
  {
    "text": "off and said okay let's forget about our software and see how things interact",
    "start": "196840",
    "end": "202040"
  },
  {
    "text": "with the stuff at the site and when we did that kind of a whole bunch of stuff",
    "start": "202040",
    "end": "208280"
  },
  {
    "text": "popped out and we went oh God what is this this is uh some stuff that we",
    "start": "208280",
    "end": "213480"
  },
  {
    "text": "didn't expect to find let's talk about the industry at whole a little bit first",
    "start": "213480",
    "end": "221200"
  },
  {
    "text": "so payments happen all over the place retail Hospitality meaning grow uh",
    "start": "221200",
    "end": "227720"
  },
  {
    "text": "restaurants or hotels petroleum convenience stores taking payments at its very basic",
    "start": "227720",
    "end": "235439"
  },
  {
    "text": "level is sort of the same everywhere but there's little differences and over the",
    "start": "235439",
    "end": "242519"
  },
  {
    "text": "last few years there's been a renewed interest in security there were some kind of Hope high-profile breaches you",
    "start": "242519",
    "end": "249280"
  },
  {
    "text": "may have heard of a couple years ago in retail and they started paying more",
    "start": "249280",
    "end": "254319"
  },
  {
    "text": "attention to it and what would you guys say if I told you that well people are",
    "start": "254319",
    "end": "261759"
  },
  {
    "text": "paying attention to it now we've got this security thing down it it's all fixed we can we don't need the PCI",
    "start": "261759",
    "end": "268199"
  },
  {
    "text": "standard anymore we can just go go home well sort of ridiculous right everybody",
    "start": "268199",
    "end": "274080"
  },
  {
    "text": "here knows that you can't just do a point in time assessment of security you have to keep going with that so that's",
    "start": "274080",
    "end": "282560"
  },
  {
    "text": "why we did this research so now that you know why you did it let us give you some background",
    "start": "282560",
    "end": "290280"
  },
  {
    "start": "286000",
    "end": "437000"
  },
  {
    "text": "about what are we going to attack so um when you deploy managed pin",
    "start": "290280",
    "end": "295960"
  },
  {
    "text": "pads meaning a pin pad that is managed by a point of sale or a payment",
    "start": "295960",
    "end": "301800"
  },
  {
    "text": "application essentially there are two general architecture types I'd like to",
    "start": "301800",
    "end": "307479"
  },
  {
    "text": "give a background about the architecture types in order to explain you later how to how to attack these types of",
    "start": "307479",
    "end": "314360"
  },
  {
    "text": "architecture so the first architecture is kind of a segregator architecture that means that you have the point of",
    "start": "314360",
    "end": "320560"
  },
  {
    "text": "sale or a bunch of Point of Sales in the store then you have a store server and",
    "start": "320560",
    "end": "326080"
  },
  {
    "text": "as part of the functionality of the store server you have a payment application payment application is the",
    "start": "326080",
    "end": "332919"
  },
  {
    "text": "application that eventually communicates with a payment processor but the thing is that you will",
    "start": "332919",
    "end": "338479"
  },
  {
    "text": "have a pin pad and the pin pad can be connected using um um Ethernet cable so",
    "start": "338479",
    "end": "345560"
  },
  {
    "text": "if it's connected using an ethernet cable it may have like you know all the it best practices you have a separate",
    "start": "345560",
    "end": "350680"
  },
  {
    "text": "villan uh maybe it's separate villan in the store or separate villain for across the organization whatever it is it's",
    "start": "350680",
    "end": "357520"
  },
  {
    "text": "connected through Ethernet which means that we can probably look up for the",
    "start": "357520",
    "end": "363759"
  },
  {
    "text": "communication there and you will see that we can do quite interesting stuff with that and based on that you can",
    "start": "363759",
    "end": "372240"
  },
  {
    "text": "generate cool attacks between the payment application and the pin pad so essentially we don't care about the",
    "start": "372240",
    "end": "377919"
  },
  {
    "text": "point of sale the next thing is actually kind of allinone solution which means that you",
    "start": "377919",
    "end": "385319"
  },
  {
    "text": "don't have ethernet cable connected to the pin pad you actually have a Serial Port connect conned to the pin pad that",
    "start": "385319",
    "end": "391240"
  },
  {
    "text": "makes things more difficult because uh you although you can tap the",
    "start": "391240",
    "end": "398000"
  },
  {
    "text": "communication the serial communication is going to be a little more difficult because it's not that scalable as it",
    "start": "398000",
    "end": "403440"
  },
  {
    "text": "should be with ethernet with the um um the ethernet connection but it's still",
    "start": "403440",
    "end": "409639"
  },
  {
    "text": "something that works today so if you heard about memory scrapers memor scrapers like to be on",
    "start": "409639",
    "end": "415400"
  },
  {
    "text": "this point of sales and just look up for the credit card numbers but as I mentioned we don't care about",
    "start": "415400",
    "end": "421720"
  },
  {
    "text": "the point of cell what we are trying to do here is actually to be um more",
    "start": "421720",
    "end": "429000"
  },
  {
    "text": "transparent and and actually less visible by any mod detection",
    "start": "429000",
    "end": "435879"
  },
  {
    "text": "applications so before we go into the flows or the flaws",
    "start": "435879",
    "end": "442240"
  },
  {
    "start": "437000",
    "end": "546000"
  },
  {
    "text": "actually let's talk about how payments work because we'll go through this process several times from now on",
    "start": "442240",
    "end": "450319"
  },
  {
    "text": "so the components that we have are point of sale and we have the payment application the point the point of",
    "start": "450319",
    "end": "455960"
  },
  {
    "text": "interaction which is essentially a pinpad that we brought here and we have the payment processor so the regular the",
    "start": "455960",
    "end": "462240"
  },
  {
    "text": "regular flow works as um you know selling activities which means that you had you add some items to the to your",
    "start": "462240",
    "end": "470240"
  },
  {
    "text": "cart and then eventually you decide to pay so you swipe your card it goes from",
    "start": "470240",
    "end": "476919"
  },
  {
    "text": "the payment application to the point of interaction the payment application requests from",
    "start": "476919",
    "end": "483520"
  },
  {
    "text": "the point of interaction to get the credit card details it can be track on",
    "start": "483520",
    "end": "488639"
  },
  {
    "text": "two data if it's a swipe that you're doing on the pin pad or it can be EMV tags in case you're sticking your card",
    "start": "488639",
    "end": "495159"
  },
  {
    "text": "into the pin pad whatever you get it then if it's a a",
    "start": "495159",
    "end": "501240"
  },
  {
    "text": "pin enabled transaction you will also be required to enter the pin again same",
    "start": "501240",
    "end": "506759"
  },
  {
    "text": "thing goes from the payment application back to the um um back to point for action and back",
    "start": "506759",
    "end": "513680"
  },
  {
    "text": "and backwards and when you've done it then it goes to the payment processor to",
    "start": "513680",
    "end": "520200"
  },
  {
    "text": "process the um the payment if it's online that's great you're going to get the Au the authorization code back",
    "start": "520200",
    "end": "527240"
  },
  {
    "text": "perfect if it's offline well it's quite challenging because you don't have the communication",
    "start": "527240",
    "end": "533200"
  },
  {
    "text": "but you still want to accept the transaction so you store it in most cases in an encrypted matter on the",
    "start": "533200",
    "end": "538440"
  },
  {
    "text": "payment application and then you handle it later so this is pretty much what we are",
    "start": "538440",
    "end": "544200"
  },
  {
    "text": "doing with payment flows the thing is that um we can",
    "start": "544200",
    "end": "550680"
  },
  {
    "start": "546000",
    "end": "624000"
  },
  {
    "text": "exploit the payment flows uh by just exploiting a simple thing in the authentication mechanisms to the point",
    "start": "550680",
    "end": "556640"
  },
  {
    "text": "of interactions so the way that we're going to attack it as I mentioned is",
    "start": "556640",
    "end": "562240"
  },
  {
    "text": "focusing as putting a shim software between the payment application and the point of",
    "start": "562240",
    "end": "568240"
  },
  {
    "text": "interaction it can can be done using um a regular um man in the metal attack it",
    "start": "568240",
    "end": "575600"
  },
  {
    "text": "can be done through a Serial Port monitoring if obviously a software can do that uh then a modware can do that as",
    "start": "575600",
    "end": "582279"
  },
  {
    "text": "well or the best way to do that is actually replacing the payment application dlls or any libraries because if you can",
    "start": "582279",
    "end": "590160"
  },
  {
    "text": "replace it with your functionality there is nothing that will",
    "start": "590160",
    "end": "595519"
  },
  {
    "text": "identify this malware unless you have any kind of Integrity",
    "start": "595519",
    "end": "600720"
  },
  {
    "text": "check but the main idea here is um that when mem scraper runs let's say that you",
    "start": "600720",
    "end": "608120"
  },
  {
    "text": "scan an item you scan an item you hear the bip right with mem scrapers you'll",
    "start": "608120",
    "end": "614120"
  },
  {
    "text": "hear the bip a little bit later because it affects the performance in this case it will not affect the performance you",
    "start": "614120",
    "end": "620399"
  },
  {
    "text": "just replace the functionality that's all so I think that the best thing to do",
    "start": "620399",
    "end": "626519"
  },
  {
    "start": "624000",
    "end": "915000"
  },
  {
    "text": "is start with the basic demos and I'll hand it over to Patrick and near is",
    "start": "626519",
    "end": "632120"
  },
  {
    "text": "going to be my cameraman for this and while he's getting the camera set up let me tell you a little bit about what",
    "start": "632120",
    "end": "638240"
  },
  {
    "text": "we've got up here CU it's a little difficult for you to see this hello blackhe",
    "start": "638240",
    "end": "644040"
  },
  {
    "text": "hat so we've got my laptop running a point of sale simulator that we use for",
    "start": "644040",
    "end": "650480"
  },
  {
    "text": "testing it's literally just a simulator I push button that say add Deli item stuff like that one of our payment",
    "start": "650480",
    "end": "657399"
  },
  {
    "text": "applications that I said earlier has its security features disabled",
    "start": "657399",
    "end": "662800"
  },
  {
    "text": "compiled out that way we can look at the security of the pin pad itself in isolation instead of the security of our",
    "start": "662800",
    "end": "669079"
  },
  {
    "text": "system so over here we've got the pin pad itself because this is we believe a",
    "start": "669079",
    "end": "677160"
  },
  {
    "text": "flaw in sort of the way the payment or uh the ecosystem is working at sites and",
    "start": "677160",
    "end": "684120"
  },
  {
    "text": "not a characteristic of this particular pin pad we're not divulging which",
    "start": "684120",
    "end": "689279"
  },
  {
    "text": "manufacturer this is we basically don't want to unfairly single them out whereas",
    "start": "689279",
    "end": "694560"
  },
  {
    "text": "it's not a problem just with them then we've got a Raspberry Pi 3 here running",
    "start": "694560",
    "end": "700200"
  },
  {
    "text": "our attack code the point of this is that this is kind of overkill for what",
    "start": "700200",
    "end": "706720"
  },
  {
    "text": "we're doing it's a very simple device it's a simple piece of software and you",
    "start": "706720",
    "end": "713760"
  },
  {
    "text": "could get something even smaller than this like a Raspberry Pi zero that costs like five bucks stick some ethernet",
    "start": "713760",
    "end": "720279"
  },
  {
    "text": "connections on it hide it somewhere at a site and Bam you've got yourself a nice little man- inth middle Hardware device",
    "start": "720279",
    "end": "726800"
  },
  {
    "text": "so let's try running a swipe transaction see what we can pull out of this stuff so we'll start a",
    "start": "726800",
    "end": "734680"
  },
  {
    "text": "transaction put a deli item on there and try to ring up a sale",
    "start": "734680",
    "end": "741000"
  },
  {
    "text": "hopefully I can get this swiped swiper to work",
    "start": "741000",
    "end": "746000"
  },
  {
    "text": "good there it goes and you can see we've already got the track data captured on",
    "start": "746680",
    "end": "751800"
  },
  {
    "text": "the uh Raspberry Pi over here we'll complete the transaction on the pin pad you can take your photos but you can't",
    "start": "751800",
    "end": "759160"
  },
  {
    "text": "use this track number it's a test number don't use it",
    "start": "759160",
    "end": "764320"
  },
  {
    "text": "yeah if you do use it somebody will come hunting for you the uh other card we",
    "start": "764320",
    "end": "770160"
  },
  {
    "text": "have that we'll use later is a standard uh test card for EMV cards over here let",
    "start": "770160",
    "end": "776360"
  },
  {
    "text": "me complete the sale fix that the transaction all right",
    "start": "776360",
    "end": "781600"
  },
  {
    "text": "so it completed now this is a passive man in the middle so that's not really uh a surprise that you can complete the",
    "start": "781600",
    "end": "789120"
  },
  {
    "text": "transaction in nobody's a wiser that's fine but let's take a look over here at",
    "start": "789120",
    "end": "794839"
  },
  {
    "text": "what wire shark picked up so here you can see the interaction between the pin",
    "start": "794839",
    "end": "800920"
  },
  {
    "text": "pad the man in the middle and the Man in the middle and our pause Simulator for these two packets uh we",
    "start": "800920",
    "end": "807440"
  },
  {
    "text": "filtered it so you just see the ones involving the track data CU nobody really cares about the rest at least not",
    "start": "807440",
    "end": "813880"
  },
  {
    "text": "yet and here at the bottom of the screen this section is where the track data can",
    "start": "813880",
    "end": "820040"
  },
  {
    "text": "be found and as you can see it's just right there there's no encryption or anything",
    "start": "820040",
    "end": "825959"
  },
  {
    "text": "here now one other important thing to know about this setup is this pin pad is",
    "start": "825959",
    "end": "832160"
  },
  {
    "text": "running production software you could go out to a store and just find this pin",
    "start": "832160",
    "end": "838880"
  },
  {
    "text": "pad running this type of software in the field today and we've made no modifications to it the only difference",
    "start": "838880",
    "end": "846040"
  },
  {
    "text": "that you'd see in a real store would be that they've probably prettied up the graphics a little bit like you might not",
    "start": "846040",
    "end": "851880"
  },
  {
    "text": "have a solid green screen you might have something pretty saying welcome to whatever retailer it is",
    "start": "851880",
    "end": "859040"
  },
  {
    "text": "yes so as you can see the communication wasn't",
    "start": "859040",
    "end": "864759"
  },
  {
    "text": "encrypted the idea is that we actually spoke with one of the vendors and",
    "start": "864759",
    "end": "870160"
  },
  {
    "text": "requested them to um to encrypt the traffic for us and we said okay can you just TLS it for us they said like",
    "start": "870160",
    "end": "880399"
  },
  {
    "text": "why are you sure well it's a security device you need to enable TLS 1.2 the",
    "start": "880399",
    "end": "887199"
  },
  {
    "text": "problem is that it's um it's more a business problem because the point of sales may be too old so they won't be",
    "start": "887199",
    "end": "894279"
  },
  {
    "text": "able to support the tls1 2 well actually in several cases you know uh you have",
    "start": "894279",
    "end": "900839"
  },
  {
    "text": "Windows XP so it may be difficult to implement tls1 to there and on the other",
    "start": "900839",
    "end": "906360"
  },
  {
    "text": "hand um the pin pad may be also um a little bit old so everyone has its own",
    "start": "906360",
    "end": "914199"
  },
  {
    "text": "justification let's see the demo now earlier we had talked about two",
    "start": "915600",
    "end": "920959"
  },
  {
    "text": "different architectures for site setups the segmented architecture where the payment server is off on its own and pin",
    "start": "920959",
    "end": "927120"
  },
  {
    "text": "pads are connected via Ethernet and the sort of integrated architecture where",
    "start": "927120",
    "end": "932560"
  },
  {
    "text": "it's all in one where the pin pads are connected to the point of sell directly usually via serial cable now one of the",
    "start": "932560",
    "end": "939880"
  },
  {
    "text": "things I tend to hear a lot is okay everybody knows how to interset packets to a passive man in the middle whatever",
    "start": "939880",
    "end": "946440"
  },
  {
    "text": "via Ethernet that's old news but serial cables sometimes people are like yeah",
    "start": "946440",
    "end": "952480"
  },
  {
    "text": "it's a Serial cable you have to physically intercept that to actually do anything etc etc",
    "start": "952480",
    "end": "959480"
  },
  {
    "text": "well not completely true here we've got a demo cuz frankly it's kind of hard to",
    "start": "959480",
    "end": "965199"
  },
  {
    "text": "bring multiple pin pads and you can't change configuration easily but this is a pin pad at our office connected via",
    "start": "965199",
    "end": "972839"
  },
  {
    "text": "serial and we've got a Serial Port monitoring software from Elma software",
    "start": "972839",
    "end": "978519"
  },
  {
    "text": "there on the left this is capturing the packets in real time and here we've got",
    "start": "978519",
    "end": "985480"
  },
  {
    "text": "highlighted the packet where we have the track data and and cuz this is extra small we actually captured an image of",
    "start": "985480",
    "end": "992600"
  },
  {
    "text": "that on the next slide that you can see here this is if you can tell pretty much",
    "start": "992600",
    "end": "999839"
  },
  {
    "text": "the exact same packet you saw earlier via Ethernet that's important to note because it really is the same protocol",
    "start": "999839",
    "end": "1007319"
  },
  {
    "text": "via Ethernet or Cal so if you've got software that can intercept seral they",
    "start": "1007319",
    "end": "1012720"
  },
  {
    "text": "can do the exact same things that they can do via Ethernet now that software you saw could",
    "start": "1012720",
    "end": "1021519"
  },
  {
    "text": "intercept serial Port communication obviously because we did it but it can also do interesting things like insert",
    "start": "1021519",
    "end": "1029199"
  },
  {
    "text": "new serial datagrams and stuff so that can kind of lead to a more active attack",
    "start": "1029199",
    "end": "1035438"
  },
  {
    "text": "which we'll talk about soon so we spoke about the long hanging fruits now swiping data wow so many",
    "start": "1035439",
    "end": "1044120"
  },
  {
    "text": "people spoke about it so many people wrote about it that's great we spend like 10 minutes of their time sorry",
    "start": "1044120",
    "end": "1051080"
  },
  {
    "text": "about that but we had to give you the background so let's talk about the",
    "start": "1051080",
    "end": "1056120"
  },
  {
    "text": "really cool stuff how to bypass EMV but before bypassing it I think it's worth",
    "start": "1056120",
    "end": "1061960"
  },
  {
    "text": "mentioning what EMV does and what it doesn't do so let's talk what it",
    "start": "1061960",
    "end": "1068039"
  },
  {
    "text": "does it does prevent stealing your physical card and using it as uh a chip and pain",
    "start": "1068039",
    "end": "1076600"
  },
  {
    "text": "transaction so okay you have something you have you have something you know probably you don't have the no part okay",
    "start": "1076600",
    "end": "1083799"
  },
  {
    "text": "that's great that's it that's what he",
    "start": "1083799",
    "end": "1089640"
  },
  {
    "text": "does let's talk about what he doesn't do EMV let's assume that you stole a",
    "start": "1089640",
    "end": "1095960"
  },
  {
    "text": "credit card number you can capture it in the same way that we'll demonstrate in a few minutes and you got the track",
    "start": "1095960",
    "end": "1103919"
  },
  {
    "text": "data now you can create a card with the same track data",
    "start": "1103919",
    "end": "1109600"
  },
  {
    "text": "and pay it pay with it in different places like you can pay online you don't have chip you can uh pay with manual",
    "start": "1109600",
    "end": "1117640"
  },
  {
    "text": "card entry in case the card isn't working so uh there are multiple ways to",
    "start": "1117640",
    "end": "1124000"
  },
  {
    "text": "pay or maybe you'll go to a store that they don't have a chip and pin supported pin pad also problem the other problem",
    "start": "1124000",
    "end": "1131440"
  },
  {
    "text": "is that with the track two data that you have there is a reason why sometimes you",
    "start": "1131440",
    "end": "1137159"
  },
  {
    "text": "swipe the card and then the pin pad tells you hey sorry you have a chi in pin card please stick the pin",
    "start": "1137159",
    "end": "1143159"
  },
  {
    "text": "inside the reason for that is because there is a number as part of the whole track data that says this is a chip and",
    "start": "1143159",
    "end": "1150159"
  },
  {
    "text": "pin card guess what if you have the number just change it to a swipe card",
    "start": "1150159",
    "end": "1157640"
  },
  {
    "text": "and then um it may be approved or not I will leave it to you I can just say that uh offline modes",
    "start": "1157640",
    "end": "1164840"
  },
  {
    "text": "can be very attractive that's it and the last scenario is actually um",
    "start": "1164840",
    "end": "1173440"
  },
  {
    "text": "falling back to a swipe method which means that if you go to the cashier and let's say that you're sticking your card",
    "start": "1173440",
    "end": "1179559"
  },
  {
    "text": "instead with the chip in in the front you'll just stick it with the chip in the back the cashier will see that it",
    "start": "1179559",
    "end": "1185919"
  },
  {
    "text": "doesn't work what the kir will do fall back to swipe that's exactly",
    "start": "1185919",
    "end": "1191760"
  },
  {
    "text": "what the cashier will do and then again you will be able to bypass EMV so EMV is",
    "start": "1191760",
    "end": "1197400"
  },
  {
    "text": "cool but it's an old standard it's not a secure",
    "start": "1197400",
    "end": "1202960"
  },
  {
    "text": "standard so we spoke about or at least we mentioned that",
    "start": "1202960",
    "end": "1209159"
  },
  {
    "start": "1203000",
    "end": "1549000"
  },
  {
    "text": "we'll be able to get the EMV data for you guess what now we're talking about the real stuff so for the same flow that",
    "start": "1209159",
    "end": "1217440"
  },
  {
    "text": "we have for the same payment flow that we have we just need to take one action",
    "start": "1217440",
    "end": "1224320"
  },
  {
    "text": "before getting exposed to all data first of all get the same software out",
    "start": "1224320",
    "end": "1229640"
  },
  {
    "text": "you're in you're in the man in the middle and now you're performing that transaction obviously getting requesting",
    "start": "1229640",
    "end": "1235679"
  },
  {
    "text": "the credit card information as the like the payment application requested from the point of interaction but it",
    "start": "1235679",
    "end": "1241360"
  },
  {
    "text": "requested through the adversary so the user sticks the card",
    "start": "1241360",
    "end": "1247360"
  },
  {
    "text": "the consumer sticks the card we get the EMV data back it's not rack data we",
    "start": "1247360",
    "end": "1254440"
  },
  {
    "text": "won't see it as we saw it in the previous slides but we'll need to figure out how",
    "start": "1254440",
    "end": "1259960"
  },
  {
    "text": "to get the EMV tags and translate it to track data now you'll see how we do that and",
    "start": "1259960",
    "end": "1266880"
  },
  {
    "text": "eventually once we got that then we'll be able to proceed to the next steps so the best thing to to do is just to",
    "start": "1266880",
    "end": "1274240"
  },
  {
    "text": "demonstrate it I'm the camera man I know",
    "start": "1274240",
    "end": "1279600"
  },
  {
    "text": "yeah oh here it is",
    "start": "1285320",
    "end": "1289919"
  },
  {
    "text": "all right so let's just start a new transaction here start transaction let's add a deli",
    "start": "1291360",
    "end": "1298960"
  },
  {
    "text": "item start the sale we should get a prompt to insert our chip card here momentarily there we",
    "start": "1298960",
    "end": "1307000"
  },
  {
    "text": "go now it's going to ask us to accept the amount",
    "start": "1307559",
    "end": "1313400"
  },
  {
    "text": "yes and if you notice over here on the Raspberry Pi we've already got the track data come in here and hopefully I can",
    "start": "1313400",
    "end": "1319880"
  },
  {
    "text": "type the pin correctly this is also a test card yes and don't is it it's not a",
    "start": "1319880",
    "end": "1325679"
  },
  {
    "text": "good idea to tell anybody your PIN but since this is test card it's 4315 hope I typed that",
    "start": "1325679",
    "end": "1332679"
  },
  {
    "text": "right looks like I did processing approved and it's going to ask me remove",
    "start": "1332679",
    "end": "1339600"
  },
  {
    "text": "the card it should go back to the welcome screen momentarily all right transaction done",
    "start": "1339600",
    "end": "1345480"
  },
  {
    "text": "we've got the track data now what how did we get the track data near cuz this is a EMV card right yeah let's see",
    "start": "1345480",
    "end": "1355600"
  },
  {
    "text": "that so here is a picture of one of the packets that you intercept from that",
    "start": "1359240",
    "end": "1366880"
  },
  {
    "text": "this is kind of obscure a little bit you've got a section right where's the",
    "start": "1366880",
    "end": "1375200"
  },
  {
    "text": "mouse right here with American Express that's because this is what's called an application identifier that says what",
    "start": "1375200",
    "end": "1381760"
  },
  {
    "text": "type of card it is later lower down you've got this weird string right here",
    "start": "1381760",
    "end": "1388559"
  },
  {
    "text": "that's because this is a test card normally someone's name would appear here this just identifies which test",
    "start": "1388559",
    "end": "1394279"
  },
  {
    "text": "card you've got now does anybody see track data just sitting out in the open",
    "start": "1394279",
    "end": "1399520"
  },
  {
    "text": "there yeah me yeah but I know that because I prepared the deck yeah I wouldn't see it",
    "start": "1399520",
    "end": "1405720"
  },
  {
    "text": "but let's give them a hint what about now in most Payment Systems data is",
    "start": "1405720",
    "end": "1412000"
  },
  {
    "text": "transferred usually using aski en coding it it's usually right there out in the open assuming you're not using TLS or",
    "start": "1412000",
    "end": "1418200"
  },
  {
    "text": "something but here it's still not quite obvious enough but if you look over here",
    "start": "1418200",
    "end": "1425000"
  },
  {
    "text": "in the actual hex representation of the binary going back and forth for EMV this",
    "start": "1425000",
    "end": "1430640"
  },
  {
    "text": "is the actual track data and it's sort of in a odd format they actually took",
    "start": "1430640",
    "end": "1436159"
  },
  {
    "text": "the text representation of the track data and then sort of transposed it into so",
    "start": "1436159",
    "end": "1443400"
  },
  {
    "text": "that you'd see the track data when you look at it in HEX form so if",
    "start": "1443400",
    "end": "1449960"
  },
  {
    "text": "we transform that into readable stuff you can see you've got the standard",
    "start": "1449960",
    "end": "1455760"
  },
  {
    "text": "track format there you've got the pan at the front a separator then the",
    "start": "1455760",
    "end": "1461080"
  },
  {
    "text": "expiration date that's what's in purple then the service code that's in sort of a orange-ish yellow color that sometimes",
    "start": "1461080",
    "end": "1468159"
  },
  {
    "text": "does doesn't show up too good then the discretionary data now let's talk about",
    "start": "1468159",
    "end": "1473799"
  },
  {
    "text": "that service code remember how n was talking about you could change one character and then you could use the",
    "start": "1473799",
    "end": "1479919"
  },
  {
    "text": "card uh offline well that's what the service code is you see the two at the",
    "start": "1479919",
    "end": "1485559"
  },
  {
    "text": "very first right here that two means this is a chip",
    "start": "1485559",
    "end": "1491559"
  },
  {
    "text": "card if it's a one that means it's a swipe card so all a attacker has to do",
    "start": "1491559",
    "end": "1498679"
  },
  {
    "text": "is take that track data change the two to a one write it to a magstripe card",
    "start": "1498679",
    "end": "1504279"
  },
  {
    "text": "and then you can use it in offline scenario hosts are supposed to check that when you do a online verification",
    "start": "1504279",
    "end": "1511159"
  },
  {
    "text": "but if you're offline nobody's a wiser okay so now we",
    "start": "1511159",
    "end": "1517919"
  },
  {
    "text": "stole the track data but we still want to purchase online I want to get an RV and I want a",
    "start": "1517919",
    "end": "1525799"
  },
  {
    "text": "credit card for that so we have the full name we have the",
    "start": "1525799",
    "end": "1530880"
  },
  {
    "text": "expiration date we have the track data what else do we",
    "start": "1530880",
    "end": "1537080"
  },
  {
    "text": "need anyone CVV CVV that's",
    "start": "1537120",
    "end": "1543360"
  },
  {
    "text": "right well that's a challenge we'll probably need to bypass",
    "start": "1543360",
    "end": "1548440"
  },
  {
    "text": "it so till now we spoke about the passive",
    "start": "1548440",
    "end": "1553880"
  },
  {
    "start": "1549000",
    "end": "1642000"
  },
  {
    "text": "attacks now we'll need to do something active to get the CVV number",
    "start": "1553880",
    "end": "1559720"
  },
  {
    "text": "so our active men middle attack is um quite",
    "start": "1559720",
    "end": "1565080"
  },
  {
    "text": "interesting in this flow we have again all of the components as we had before",
    "start": "1565080",
    "end": "1571200"
  },
  {
    "text": "but if you see uh the payment flow we request to pay from the point of sell to",
    "start": "1571200",
    "end": "1576840"
  },
  {
    "text": "payment application then the payment application request the gr the credit card from the adversary and uh request",
    "start": "1576840",
    "end": "1584200"
  },
  {
    "text": "it from the point of interaction we get the EMV tags now you know that we know",
    "start": "1584200",
    "end": "1590120"
  },
  {
    "text": "how to GA EMV data and um and when we get EMV taxs",
    "start": "1590120",
    "end": "1595600"
  },
  {
    "text": "back as the adversary before responding to the payment application we inject our",
    "start": "1595600",
    "end": "1601840"
  },
  {
    "text": "own call to the payment to the pin pad the reason for that is because if we'll",
    "start": "1601840",
    "end": "1607360"
  },
  {
    "text": "inject ourselves not in this process the transaction will just not complete",
    "start": "1607360",
    "end": "1612679"
  },
  {
    "text": "successfully but we want the consumer to feel really good with the fact that we're stealing his CV",
    "start": "1612679",
    "end": "1620120"
  },
  {
    "text": "as much as he can so um so the way that we do that we just call a let's call it a um",
    "start": "1620120",
    "end": "1627919"
  },
  {
    "text": "function inside the point point of interaction and this function essentially gets us a number we request",
    "start": "1627919",
    "end": "1636080"
  },
  {
    "text": "a four-digit number with a specific text that's what we can do and that's what we",
    "start": "1636080",
    "end": "1641799"
  },
  {
    "text": "will demonstrate now so cameraman if you please and I'll start up a new",
    "start": "1641799",
    "end": "1648840"
  },
  {
    "start": "1642000",
    "end": "2343000"
  },
  {
    "text": "transaction while you're working on it this time since we're getting close to lunch I'm feeling a little hungry",
    "start": "1648840",
    "end": "1655880"
  },
  {
    "text": "let's put on two Deli items we'll be",
    "start": "1655880",
    "end": "1659880"
  },
  {
    "text": "daring all right so we've got two Deli items so far same as before and click",
    "start": "1661440",
    "end": "1667240"
  },
  {
    "text": "the sale button we'll get prompted for a EMV entry momentarily make sure I get it in the",
    "start": "1667240",
    "end": "1674720"
  },
  {
    "text": "slot please wait now we've got the track data same as before do amount",
    "start": "1674720",
    "end": "1682559"
  },
  {
    "text": "confirmation enter the pin",
    "start": "1682559",
    "end": "1689279"
  },
  {
    "text": "4315 hope I typed it right yep and here's a new screen this is our first of",
    "start": "1689279",
    "end": "1695240"
  },
  {
    "text": "the attack screens and as near mentioned this is a normal builtin prompt we just",
    "start": "1695240",
    "end": "1702440"
  },
  {
    "text": "well it's a normal prompt API we Supply the text say give us a card a a",
    "start": "1702440",
    "end": "1708440"
  },
  {
    "text": "four-digit number and it'll respond back now because this a is a test card it doesn't have a built-in",
    "start": "1708440",
    "end": "1715399"
  },
  {
    "text": "cvv2 assigned to it so I'm just going to enter one two three click enter and if",
    "start": "1715399",
    "end": "1720760"
  },
  {
    "text": "you look over here the Raspberry Pi has got it the pin pad finishes approved should",
    "start": "1720760",
    "end": "1728519"
  },
  {
    "text": "prompt remove card there we go processing and we're done now let's take",
    "start": "1728519",
    "end": "1736440"
  },
  {
    "text": "a look at the wire shark and see if we actually intercepted all",
    "start": "1736440",
    "end": "1742120"
  },
  {
    "text": "that so this is all the swipe data we switch to the prompt entry so what you",
    "start": "1742120",
    "end": "1750240"
  },
  {
    "text": "see right here is all the different prompt responses from the pin pad you",
    "start": "1750240",
    "end": "1756480"
  },
  {
    "text": "see right here that this is 1 two three going from the pin pad to the man in the",
    "start": "1756480",
    "end": "1762720"
  },
  {
    "text": "middle here is a different type of prompt response this is just saying that",
    "start": "1762720",
    "end": "1768440"
  },
  {
    "text": "we finished a form and here is yet another one saying hey we finished a",
    "start": "1768440",
    "end": "1774919"
  },
  {
    "text": "different form so as you can see right here pin pad to man in the middle that's",
    "start": "1774919",
    "end": "1779960"
  },
  {
    "text": "our attack then man in the middle to the pause simulator but not with the cbv",
    "start": "1779960",
    "end": "1786159"
  },
  {
    "text": "this is the data from the uh the finished another transaction this is the",
    "start": "1786159",
    "end": "1792360"
  },
  {
    "text": "original data that we took over yeah",
    "start": "1792360",
    "end": "1798640"
  },
  {
    "text": "Okay so we've got the CVV that's great but we want to get more we",
    "start": "1800919",
    "end": "1807440"
  },
  {
    "text": "actually want to get the pin because that's a sensitive thing that we want to steal and in fact we can do that so with",
    "start": "1807440",
    "end": "1815159"
  },
  {
    "text": "this flow we can actually intercept a little bit differently in the flow in",
    "start": "1815159",
    "end": "1820919"
  },
  {
    "text": "such a way that allows us to get the MV tags as previously but now the payment",
    "start": "1820919",
    "end": "1827080"
  },
  {
    "text": "application will request the encrypted pin before the adversary responds with",
    "start": "1827080",
    "end": "1834320"
  },
  {
    "text": "the encrypted pin to the payment application we inject our own screen and guess what this screen is going to",
    "start": "1834320",
    "end": "1841880"
  },
  {
    "text": "do ask for the pin again let's see that so cameraman if you",
    "start": "1841880",
    "end": "1849519"
  },
  {
    "text": "please yes that's me I know let's start the transaction go ahead and put two grocery",
    "start": "1849519",
    "end": "1856880"
  },
  {
    "text": "items on there this time oh you got it okay there we go ready",
    "start": "1856880",
    "end": "1863399"
  },
  {
    "text": "yeah ready click sale should get the entry",
    "start": "1863399",
    "end": "1869080"
  },
  {
    "text": "prompt There It Is insert the card get the track",
    "start": "1869080",
    "end": "1874799"
  },
  {
    "text": "data now we've got the amount confirmation screen again yes trusty old inner pin screen this is",
    "start": "1874799",
    "end": "1882200"
  },
  {
    "text": "the real one [Music] 4315 now just like pre previously we get",
    "start": "1882200",
    "end": "1889000"
  },
  {
    "text": "a new screen this time reenter pin now if you're a security",
    "start": "1889000",
    "end": "1894440"
  },
  {
    "text": "professional you may notice the difference between these two but because we're able to put whatever text we want",
    "start": "1894440",
    "end": "1901000"
  },
  {
    "text": "on this screen we can also claim that there's a problem or whatever and most",
    "start": "1901000",
    "end": "1906120"
  },
  {
    "text": "consumers are kind of trained if you will to trust a pin pad if it's telling them to enter their pin again they",
    "start": "1906120",
    "end": "1912440"
  },
  {
    "text": "probably assume they typed it wrong now if you look at the Raspberry Pi we've got it un",
    "start": "1912440",
    "end": "1918639"
  },
  {
    "text": "encrypted and if we look at the pin pad it's approved we get the same remove",
    "start": "1918639",
    "end": "1924559"
  },
  {
    "text": "card processing processing back to welcome so",
    "start": "1924559",
    "end": "1931000"
  },
  {
    "text": "the payment application is none the wiser because the man in the middle never told it it was doing that prompt",
    "start": "1931000",
    "end": "1938159"
  },
  {
    "text": "it just took over the flow the transaction so let's say that we've got",
    "start": "1938159",
    "end": "1943840"
  },
  {
    "text": "that the thing is that part of the pinet manufacturers actually uh provide some protection um for the",
    "start": "1943840",
    "end": "1950760"
  },
  {
    "text": "Tex that we can inject there so they have a white list well guess what we don't need to",
    "start": "1950760",
    "end": "1957480"
  },
  {
    "text": "bypass the white list we just need to use the white list so the white list um",
    "start": "1957480",
    "end": "1964080"
  },
  {
    "text": "may include a lot of words and it varies between the vendors but there is one thing that is pretty much Common Please",
    "start": "1964080",
    "end": "1971840"
  },
  {
    "text": "re-enter if you've been asked to put your pin and then you've been asked to",
    "start": "1971840",
    "end": "1977159"
  },
  {
    "text": "re-enter what is the thing that you need to re-enter your",
    "start": "1977159",
    "end": "1983039"
  },
  {
    "text": "PIN but let's say that um you know the screen may not look right and you",
    "start": "1983039",
    "end": "1989600"
  },
  {
    "text": "know it's not perfect so seral manufacturers actually",
    "start": "1989600",
    "end": "1996840"
  },
  {
    "text": "allow you to inject screens or forms the reason for that is because maybe on",
    "start": "1996840",
    "end": "2002120"
  },
  {
    "text": "retail as Patrick mentioned it's pretty common but in other business types like you know hospitality and and petroleum",
    "start": "2002120",
    "end": "2008480"
  },
  {
    "text": "convenience stores they have their own flows they want to customize it for their",
    "start": "2008480",
    "end": "2014200"
  },
  {
    "text": "customers and um and since they allow that and this a pretty legal stuff that",
    "start": "2014200",
    "end": "2019880"
  },
  {
    "text": "they do there we can just inject our own form so when we inject our own form we",
    "start": "2019880",
    "end": "2026039"
  },
  {
    "text": "actually don't need to inject any text so the enter PIN that you see here on the screen is actually a",
    "start": "2026039",
    "end": "2032840"
  },
  {
    "text": "photo we just need to add a control that gets masked number",
    "start": "2032840",
    "end": "2038200"
  },
  {
    "text": "the one limitation there that the the the pinet manufacturers provide is that",
    "start": "2038200",
    "end": "2043880"
  },
  {
    "text": "in some cases you may be required to sign these forms which may make it a",
    "start": "2043880",
    "end": "2049320"
  },
  {
    "text": "little bit more difficult for the hackers to do that so I suggest that the best thing to do is again demonstrate it and show it",
    "start": "2049320",
    "end": "2056599"
  },
  {
    "text": "how it will work in the real world scenario so as near said some manufacturers require forms or screens",
    "start": "2056599",
    "end": "2064118"
  },
  {
    "text": "or whatever they call them to be signed by the manufacturer now this one uh",
    "start": "2064119",
    "end": "2070000"
  },
  {
    "text": "doesn't actually require that which is why we're able to perform this attack again production code in the",
    "start": "2070000",
    "end": "2076118"
  },
  {
    "text": "field if a attacker is smart about this they'll do the form injection sort of ahead of time",
    "start": "2076119",
    "end": "2083839"
  },
  {
    "text": "like at 1:00 a.m. or something when nobody's in the store nobody's likely be",
    "start": "2083839",
    "end": "2089280"
  },
  {
    "text": "paying attention because all the pin pads actually do display something on the screen when you're doing this it",
    "start": "2089280",
    "end": "2095919"
  },
  {
    "text": "happens very quick so we've slowed it down here we're going to actually pause it so watch the pin pad screen it'll uh",
    "start": "2095919",
    "end": "2105560"
  },
  {
    "text": "the progress bar will be very quick on this once it actually gets going it'll take it a second to",
    "start": "2105560",
    "end": "2112040"
  },
  {
    "text": "go so there it goes we've got it paused after the progress bar completed but if",
    "start": "2112040",
    "end": "2117680"
  },
  {
    "text": "you noticed there was a progress bar that advanced very very quickly once it gets to this section where it says file",
    "start": "2117680",
    "end": "2124320"
  },
  {
    "text": "successfully downloaded a real attacker or real software would immediately",
    "start": "2124320",
    "end": "2129680"
  },
  {
    "text": "transfer that back to the welcome screen which like",
    "start": "2129680",
    "end": "2136079"
  },
  {
    "text": "this now let's try this out using our form yeah all right start transaction",
    "start": "2136079",
    "end": "2143800"
  },
  {
    "text": "let's put a deli item and a grocery item on there this time do a",
    "start": "2143800",
    "end": "2150000"
  },
  {
    "text": "sale now just like before it'll prompt for EMV insert do",
    "start": "2150000",
    "end": "2156000"
  },
  {
    "text": "that got the tra data as usual click yes to amount",
    "start": "2156000",
    "end": "2161599"
  },
  {
    "text": "confirmation now let's type in this pen 4 3 one five where's the five there it",
    "start": "2161599",
    "end": "2168560"
  },
  {
    "text": "is hopefully I typed that right yep now here comes our form now obviously a real",
    "start": "2168560",
    "end": "2176400"
  },
  {
    "text": "attacker wouldn't do something like this it's uh the point is that you can see",
    "start": "2176400",
    "end": "2182000"
  },
  {
    "text": "that this is really a form that or screen or whatever that we injected and",
    "start": "2182000",
    "end": "2187760"
  },
  {
    "text": "we also made the text of the the pin prompt a little bit different so that you can really tell that it's not the",
    "start": "2187760",
    "end": "2195280"
  },
  {
    "text": "same font used in the rest of the system so let's 4",
    "start": "2195280",
    "end": "2201079"
  },
  {
    "text": "315 and as you may expect at this point we've got the pen over here on the Raspberry Pi as well the pin pad has",
    "start": "2201079",
    "end": "2209000"
  },
  {
    "text": "approved the transaction please remove card",
    "start": "2209000",
    "end": "2215560"
  },
  {
    "text": "processing and we're done transaction approved now we've shown you a few",
    "start": "2215560",
    "end": "2222520"
  },
  {
    "text": "different attack vectors here but there's probably more that we can look",
    "start": "2222520",
    "end": "2228160"
  },
  {
    "text": "into right I mean computer security is never actually finished with anything so",
    "start": "2228160",
    "end": "2234280"
  },
  {
    "text": "what else do we have available well one of the more common things that you may",
    "start": "2234280",
    "end": "2241359"
  },
  {
    "text": "have heard of are scammers these are old school I'm not going to spend too much time talking about them but we get",
    "start": "2241359",
    "end": "2247520"
  },
  {
    "text": "reports of them a lot because well we work with these devices a lot some of",
    "start": "2247520",
    "end": "2253400"
  },
  {
    "text": "these are incredibly Advanced at this point like the one on the far right if",
    "start": "2253400",
    "end": "2258920"
  },
  {
    "text": "it was sitting here I would probably not be able to tell the difference between a pin pad with that overlay on it or just",
    "start": "2258920",
    "end": "2266160"
  },
  {
    "text": "a regular pin pad they're pretty Advanced now let's take a look at those",
    "start": "2266160",
    "end": "2273359"
  },
  {
    "text": "sequence or not sequence but Network diagrams we were showing you before this time we've added a diagram talking about",
    "start": "2273359",
    "end": "2280520"
  },
  {
    "text": "the pin pad and like most internet of things or embedded devices people kind",
    "start": "2280520",
    "end": "2286680"
  },
  {
    "text": "of tend to think of a pin PAD as a single thing as this is a nice secure",
    "start": "2286680",
    "end": "2291720"
  },
  {
    "text": "device that's allinone and you it's one thing but it's really a computer like",
    "start": "2291720",
    "end": "2297079"
  },
  {
    "text": "most other things under the scenes it's running some applications it's running OS it's got different Hardware devices",
    "start": "2297079",
    "end": "2304200"
  },
  {
    "text": "stuff like that we've only really been looking at one of those applications that runs on the pin pad there are",
    "start": "2304200",
    "end": "2310319"
  },
  {
    "text": "others on there there's a OS on there probably some sort of Linux variant or maybe a real-time operating system",
    "start": "2310319",
    "end": "2316960"
  },
  {
    "text": "there's also Hardware devices like the secure reading and exchange of data that's basically like a TPM it's used",
    "start": "2316960",
    "end": "2324079"
  },
  {
    "text": "for the crypto operations in there we can probably find more faults in this",
    "start": "2324079",
    "end": "2329680"
  },
  {
    "text": "thing for example we did a form or screen insert into it which it's",
    "start": "2329680",
    "end": "2335280"
  },
  {
    "text": "accepting a Big Blob of data from anybody that wants to give it to it what if there's a buffer overflow in there or",
    "start": "2335280",
    "end": "2341680"
  },
  {
    "text": "something so let's talk about some mitigations of these sort of attacks what do we want to do well so let's SPL",
    "start": "2341680",
    "end": "2349720"
  },
  {
    "start": "2343000",
    "end": "2358000"
  },
  {
    "text": "the mitigations between what a retailer can do or request and what a",
    "start": "2349720",
    "end": "2355960"
  },
  {
    "text": "consumer can do so as for the retailers there is something called pointto Point encryption the idea of Point encryption",
    "start": "2355960",
    "end": "2362960"
  },
  {
    "start": "2358000",
    "end": "2393000"
  },
  {
    "text": "is to use the hardware based encryption that you have on the pin pad to encrypt",
    "start": "2362960",
    "end": "2368640"
  },
  {
    "text": "everything okay not only the pen the whole thing the idea is that uh on the pin",
    "start": "2368640",
    "end": "2377040"
  },
  {
    "text": "pads you can choose whether just to encrypt it using the hardware the regular Hardware or you can use the TPM",
    "start": "2377040",
    "end": "2382079"
  },
  {
    "text": "which is a the thread component preferably today we can ask for the",
    "start": "2382079",
    "end": "2388000"
  },
  {
    "text": "thread enabled functionality and most of the pimp ad vendors will be able to provide that to you um the other thing",
    "start": "2388000",
    "end": "2394720"
  },
  {
    "start": "2393000",
    "end": "2427000"
  },
  {
    "text": "that is important to understand is um with the pin pads you have like um you have",
    "start": "2394720",
    "end": "2402839"
  },
  {
    "text": "encryption well obviously the pin is is encrypted but the idea is that every transaction is encrypted with different",
    "start": "2402839",
    "end": "2410000"
  },
  {
    "text": "key this is something called the docot algorithm so triple D sounds like very",
    "start": "2410000",
    "end": "2415520"
  },
  {
    "text": "old thing but triple d dobot means that every transaction is encrypted using a different key this is something that you",
    "start": "2415520",
    "end": "2422319"
  },
  {
    "text": "just need to verify that the pinpad vendor will be able to provide you",
    "start": "2422319",
    "end": "2428440"
  },
  {
    "text": "one more thing that is important to understand with the point of Point encryption in general is that um we need",
    "start": "2428440",
    "end": "2434040"
  },
  {
    "text": "to make sure that no one can downgrade the firmware so sometimes you can just",
    "start": "2434040",
    "end": "2439640"
  },
  {
    "text": "send a command and upgrade or downgrade the firmware of the pin pad if someone",
    "start": "2439640",
    "end": "2445079"
  },
  {
    "text": "can use the hardware encryption and then downgrade it to software encryption that may be problematic then",
    "start": "2445079",
    "end": "2452839"
  },
  {
    "text": "we may be able to perform the same attacks as we did now but if it's Hardware enabled and it does not allow",
    "start": "2452839",
    "end": "2459440"
  },
  {
    "text": "any downgrades then it may be um secure enough to handle with these",
    "start": "2459440",
    "end": "2465200"
  },
  {
    "text": "attacks um one of the most important things in the point point encryption is to make sure that um if we allow",
    "start": "2465200",
    "end": "2474359"
  },
  {
    "text": "any uh forms or screens to be uploaded or actually downloaded by the pin pad we",
    "start": "2474359",
    "end": "2481720"
  },
  {
    "text": "need to make sure that it is signed it's signed by the manufacturer itself or by the vendor that provides you the",
    "start": "2481720",
    "end": "2487839"
  },
  {
    "text": "integration with the pin pad in that case you need to manage certificate authorities correctly and make sure that",
    "start": "2487839",
    "end": "2493520"
  },
  {
    "text": "no one else can inject that um one of the things that we didn't",
    "start": "2493520",
    "end": "2499280"
  },
  {
    "text": "manage to discuss about in this talk is um the white list that um the pin pads",
    "start": "2499280",
    "end": "2505319"
  },
  {
    "text": "manage so you actually can have exceptions of what is going to be encrypted and what is not going to be encrypted think about it this way like",
    "start": "2505319",
    "end": "2511960"
  },
  {
    "text": "loyalty numbers it's not a credit card number it's sensitive but it's not",
    "start": "2511960",
    "end": "2517359"
  },
  {
    "text": "regulated so in that case you may just say okay I have a bin range that will be excluded and um and in some cases you",
    "start": "2517359",
    "end": "2525760"
  },
  {
    "text": "don't want to um leave it open for attackers just",
    "start": "2525760",
    "end": "2530880"
  },
  {
    "text": "to add the Visa and MasterCard Bean ranges so that won't be encrypted at all",
    "start": "2530880",
    "end": "2536240"
  },
  {
    "text": "as as an exclusion and the last time um we spoke about the offline stuff so we need to",
    "start": "2536240",
    "end": "2542720"
  },
  {
    "start": "2538000",
    "end": "2551000"
  },
  {
    "text": "make sure that even if you don't have the online connectivity you still have the encrypted blob on the payment",
    "start": "2542720",
    "end": "2550960"
  },
  {
    "text": "application so this is for the the customers that have some power to face with a point of interaction",
    "start": "2550960",
    "end": "2557720"
  },
  {
    "start": "2551000",
    "end": "2563000"
  },
  {
    "text": "manufacturers but what if they don't have the point of Point encryption functionality well you can ask them to",
    "start": "2557720",
    "end": "2564760"
  },
  {
    "start": "2563000",
    "end": "2580000"
  },
  {
    "text": "TLS it if they support TLS or sslv3 whatever they support you can just",
    "start": "2564760",
    "end": "2572240"
  },
  {
    "text": "request it or um just work with them to sign all of your requests",
    "start": "2572240",
    "end": "2577960"
  },
  {
    "text": "and then you will be authenticated but from the consumer perspective what you can do as",
    "start": "2577960",
    "end": "2585319"
  },
  {
    "start": "2580000",
    "end": "2605000"
  },
  {
    "text": "individuals in order to avoid this attack except obviously paying with cash so do not ever reenter",
    "start": "2585319",
    "end": "2596240"
  },
  {
    "text": "pins if you see that take your card off and restart the",
    "start": "2596240",
    "end": "2602480"
  },
  {
    "text": "transaction don't do that anymore be cautious of any unusual",
    "start": "2602480",
    "end": "2607720"
  },
  {
    "start": "2605000",
    "end": "2648000"
  },
  {
    "text": "prompts because again the white list is pretty wide you can be asked for social",
    "start": "2607720",
    "end": "2613200"
  },
  {
    "text": "security number address or whatever that they can ask just take a look at it see",
    "start": "2613200",
    "end": "2619119"
  },
  {
    "text": "if that makes sense like cvv2 it may be prompted in some business scenarios but",
    "start": "2619119",
    "end": "2624800"
  },
  {
    "text": "it's not something common and the last thing is try to use",
    "start": "2624800",
    "end": "2630760"
  },
  {
    "text": "and kind of an app payment or for instance I'm paying with my watch I'm",
    "start": "2630760",
    "end": "2636079"
  },
  {
    "text": "I'm actually when I'm going to the grocery store if they support paying with my Apple watch I will go there",
    "start": "2636079",
    "end": "2643280"
  },
  {
    "text": "because I won't be prompted for all of these stuff that we saw right now so just to sum things up it's",
    "start": "2643280",
    "end": "2651000"
  },
  {
    "start": "2648000",
    "end": "2675000"
  },
  {
    "text": "relatively easy to exploit the point of interactions um if you're in the right place again you need to be man in the",
    "start": "2651000",
    "end": "2658240"
  },
  {
    "text": "middle and there are solutions to me to to mitigate this um you know these",
    "start": "2658240",
    "end": "2664200"
  },
  {
    "text": "attacks it just matter of uh requesting the right things from the manufacturer",
    "start": "2664200",
    "end": "2669960"
  },
  {
    "text": "from the pin pen manufacturer and from the vendor that writes the payment application for you and um I think this is pretty much",
    "start": "2669960",
    "end": "2678359"
  },
  {
    "start": "2675000",
    "end": "2988000"
  },
  {
    "text": "what we have to say today thank [Applause]",
    "start": "2678359",
    "end": "2686799"
  },
  {
    "text": "you and that's the time for the questions if you have any uh we've got some microphones there",
    "start": "2687240",
    "end": "2693480"
  },
  {
    "text": "if you don't mind yeah got about five minutes for question so try to make it",
    "start": "2693480",
    "end": "2699920"
  },
  {
    "text": "quick okay hopefully it's on hopefully it's not yeah it's on it's on is it yeah yeah",
    "start": "2699920",
    "end": "2708520"
  },
  {
    "text": "it is so uh if we have a if we have a pin p or a whatever bo uh PCI approved",
    "start": "2708520",
    "end": "2715760"
  },
  {
    "text": "let's say duckport uh sign application sign frameware sign prompts uh secure",
    "start": "2715760",
    "end": "2720880"
  },
  {
    "text": "element whatever we can assume that it's",
    "start": "2720880",
    "end": "2726640"
  },
  {
    "text": "safe well according to your uh scenario your question is let's say that it is U it's",
    "start": "2726640",
    "end": "2732440"
  },
  {
    "text": "tested by PCI and you have all the controls that you think that you you may have um so the that this is actually a",
    "start": "2732440",
    "end": "2741440"
  },
  {
    "text": "PCI pts certified pin pad it is and PCI does not require any encryption of any",
    "start": "2741440",
    "end": "2746880"
  },
  {
    "text": "of the communication on a local area network at the store which is basically where the problem comes in so this pin",
    "start": "2746880",
    "end": "2754079"
  },
  {
    "text": "pad even though it's pts certified by PCI allow you to do whatever prompt you want that's one problem the other",
    "start": "2754079",
    "end": "2760319"
  },
  {
    "text": "problem is a PCI doesn't require you to do encryption or authorization of any communication at the land which is how",
    "start": "2760319",
    "end": "2766680"
  },
  {
    "text": "you do the man in the middle to actually do those prompts and just add another comment this is an EMV solution that run",
    "start": "2766680",
    "end": "2774280"
  },
  {
    "text": "well should run on production yeah and obviously it's not our production software but we just played with the uh",
    "start": "2774280",
    "end": "2781800"
  },
  {
    "text": "you know with the configurations or the the calls that we can do on the pin pad",
    "start": "2781800",
    "end": "2786960"
  },
  {
    "text": "okay so the idea is just to work with the two parties and make sure that they can speak in the right language our",
    "start": "2786960",
    "end": "2794599"
  },
  {
    "text": "Solutions actually having the security in place not the EMV stuff because full EMV solution it doesn't mean that it's",
    "start": "2794599",
    "end": "2800880"
  },
  {
    "text": "encrypted it is full EMV transaction as you can see yeah our solution actually uses the TLs connections or the point to",
    "start": "2800880",
    "end": "2808960"
  },
  {
    "text": "point one of the other to protect against this sort of thing but because PCI doesn't require either of those many",
    "start": "2808960",
    "end": "2817520"
  },
  {
    "text": "solutions don't do the same thing any further questions yes yeah um",
    "start": "2817520",
    "end": "2822800"
  },
  {
    "text": "there for signature verification authentication I mean can can you close speaker to the mic as for uh signature",
    "start": "2822800",
    "end": "2831240"
  },
  {
    "text": "verification um you authentication the point of safe sale terminal itself needs",
    "start": "2831240",
    "end": "2837839"
  },
  {
    "text": "to have some kind of um",
    "start": "2837839",
    "end": "2842920"
  },
  {
    "text": "certificate um store and stuff like that and and if that deployment of",
    "start": "2842920",
    "end": "2849839"
  },
  {
    "text": "certificates is that worked out by PCI or is it still",
    "start": "2849839",
    "end": "2854920"
  },
  {
    "text": "like based on customers whim I mean the",
    "start": "2854920",
    "end": "2860000"
  },
  {
    "text": "um uh retail stores whim whether they can deploy certificates to this otherwise there's no point in having",
    "start": "2860000",
    "end": "2865960"
  },
  {
    "text": "encryption I can still do a man in the midle so I think are you talking about",
    "start": "2865960",
    "end": "2871000"
  },
  {
    "text": "the TLs connections okay so PCI doesn't regulate that at all",
    "start": "2871000",
    "end": "2877440"
  },
  {
    "text": "and depending on which point of interaction it is then some of them when",
    "start": "2877440",
    "end": "2884400"
  },
  {
    "text": "the point of sale vendor talks to the pin pad vendor they can say hey point of",
    "start": "2884400",
    "end": "2889599"
  },
  {
    "text": "sale or pin pad vendor only accept connections or only create connections to this certificate because this is our",
    "start": "2889599",
    "end": "2897040"
  },
  {
    "text": "certificate or they by default come with kind of the standard set of cert trusted",
    "start": "2897040",
    "end": "2903480"
  },
  {
    "text": "root certificates you know the massive list that you might see in Mozilla or whatever so we our",
    "start": "2903480",
    "end": "2910520"
  },
  {
    "text": "recommended approach is the vendor work with the pin pad vendor to say only",
    "start": "2910520",
    "end": "2915960"
  },
  {
    "text": "trust connection to this certificate we've got about 2 minutes one minute left yeah so um yes I was just wondering",
    "start": "2915960",
    "end": "2924920"
  },
  {
    "text": "how easy it is um to do a man in the Middle with USB instead of cereal well the the the question was how easy it is",
    "start": "2924920",
    "end": "2932079"
  },
  {
    "text": "to do man the Middle with USB so the idea is that you don't really need to",
    "start": "2932079",
    "end": "2938119"
  },
  {
    "text": "tap in the middle you can just replace the dll and you're in the in the middle it doesn't matter what type of",
    "start": "2938119",
    "end": "2943680"
  },
  {
    "text": "communication as long as it IO you can be as the man in the middle and most USB",
    "start": "2943680",
    "end": "2948960"
  },
  {
    "text": "pin pads are actually the USB part is just making a Serial port on the",
    "start": "2948960",
    "end": "2955200"
  },
  {
    "text": "computer so it's it's USB but it's just serial Port over USB thank you welcome",
    "start": "2955200",
    "end": "2961480"
  },
  {
    "text": "so for just last question you had yeah are you planning on sharing your finding",
    "start": "2961480",
    "end": "2966920"
  },
  {
    "text": "with the PCI working Council to see if we can get changes to the PCI standards to cover that so Patrick is highly",
    "start": "2966920",
    "end": "2974400"
  },
  {
    "text": "involved in the PCI stuff um but I think we can take it offline later and talk about",
    "start": "2974400",
    "end": "2981160"
  },
  {
    "text": "it thank you very much thank you",
    "start": "2981160",
    "end": "2986280"
  },
  {
    "text": "[Applause]",
    "start": "2986280",
    "end": "2990039"
  }
]