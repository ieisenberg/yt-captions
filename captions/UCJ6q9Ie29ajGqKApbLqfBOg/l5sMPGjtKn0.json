[
  {
    "start": "0",
    "end": "15000"
  },
  {
    "text": "okay at everybody so my name is Philip Logitech and today will you I will give",
    "start": "30",
    "end": "7259"
  },
  {
    "text": "you a presentation about VBA macros and the recent advances in the attack and",
    "start": "7259",
    "end": "12630"
  },
  {
    "text": "different sides so quick disclaimer okay so a few words about myself so I work",
    "start": "12630",
    "end": "19800"
  },
  {
    "start": "15000",
    "end": "89000"
  },
  {
    "text": "for the European Space Agency however the talk I'm going to give today is not related to my day job for almost",
    "start": "19800",
    "end": "28500"
  },
  {
    "text": "20 years I have been developing open source tools for a file passing and malware analysis maybe you know some of",
    "start": "28500",
    "end": "36360"
  },
  {
    "text": "them like le fire or Ella tools and in",
    "start": "36360",
    "end": "41430"
  },
  {
    "text": "fact when I started working my first project was to build a an email security",
    "start": "41430",
    "end": "48420"
  },
  {
    "text": "gateway and that's when I started 20 years ago to fight with VBA macros and",
    "start": "48420",
    "end": "57899"
  },
  {
    "text": "since then it has been a passion for me to look at five formats how you can embed active content in them and how you",
    "start": "57899",
    "end": "64948"
  },
  {
    "text": "can detect malicious documents so yes so",
    "start": "64949",
    "end": "72450"
  },
  {
    "text": "today we'll present you means in 19 years the tools of evolve is a lot and",
    "start": "72450",
    "end": "78299"
  },
  {
    "text": "the attacker attackers also have evolved a lot so today that's why I will present",
    "start": "78299",
    "end": "83460"
  },
  {
    "text": "you some new new trends in this area okay so first I will do a quick overview",
    "start": "83460",
    "end": "91740"
  },
  {
    "start": "89000",
    "end": "128000"
  },
  {
    "text": "of VBA macros and try to explain why it's still an issue in 2019 then I will",
    "start": "91740",
    "end": "98640"
  },
  {
    "text": "show you the analysis tools that I've developed so namely oledb a and viper monkey then we will look at two advanced",
    "start": "98640",
    "end": "107670"
  },
  {
    "text": "techniques that were presented in conferences last year and this year",
    "start": "107670",
    "end": "113930"
  },
  {
    "text": "there will be a stomping and also excel and macros we also look at the detection",
    "start": "113930",
    "end": "121409"
  },
  {
    "text": "and the protection side and finally Susanoo future work okay let's start",
    "start": "121409",
    "end": "129720"
  },
  {
    "start": "128000",
    "end": "271000"
  },
  {
    "text": "with the history of macros I see three main areas in this history",
    "start": "129720",
    "end": "135680"
  },
  {
    "text": "first it started in 1995 with a world",
    "start": "135680",
    "end": "140700"
  },
  {
    "text": "basic and from 95 to 2003 we had a lot of micro video viewers maybe the the",
    "start": "140700",
    "end": "148410"
  },
  {
    "text": "most well-known is Melissa which was in 1999 then from 2004 to 2013 for 10 years",
    "start": "148410",
    "end": "158550"
  },
  {
    "text": "we observed what I call a VBA winter in fact there was almost no VBA macro used",
    "start": "158550",
    "end": "167100"
  },
  {
    "text": "for my wear anymore attackers were preferring to use exploits either in Microsoft Office formats or in",
    "start": "167100",
    "end": "174540"
  },
  {
    "text": "a PDF I think the the main reason for that is that office 2002 2003",
    "start": "174540",
    "end": "182720"
  },
  {
    "text": "macros were disabled by default completely so it means the end users could not run macros and it had an",
    "start": "182720",
    "end": "188910"
  },
  {
    "text": "effect on the malware market so to say then we in 2014 we we have seen a big",
    "start": "188910",
    "end": "197100"
  },
  {
    "text": "comeback from VBA macros mainly used at",
    "start": "197100",
    "end": "202230"
  },
  {
    "text": "the first stage to deliver malware every day even today they are still hundreds",
    "start": "202230",
    "end": "207870"
  },
  {
    "text": "of thousands of phishing emails sent all over the world with a malicious macros to deliver banking Trojans run somewhere",
    "start": "207870",
    "end": "215370"
  },
  {
    "text": "a PT's etc and I think the main reason why we have seen this written from",
    "start": "215370",
    "end": "222030"
  },
  {
    "text": "macros is a big change in Microsoft Office user interface since office 2010",
    "start": "222030",
    "end": "229250"
  },
  {
    "text": "there is a single enabled enable content button that enables allows the end user",
    "start": "229250",
    "end": "236459"
  },
  {
    "text": "to run macros so the user can see the document and then decide if he wants the",
    "start": "236459",
    "end": "242010"
  },
  {
    "text": "macros or not and since then macros have been used a lot to deliver malware",
    "start": "242010",
    "end": "248299"
  },
  {
    "text": "another reason is that since office 2010 there is a sandbox for texting office",
    "start": "248299",
    "end": "254610"
  },
  {
    "text": "against exploits which is called protective view so when you open a document coming from internet or from a removable",
    "start": "254610",
    "end": "262220"
  },
  {
    "text": "device it will first be open in protected view and you need to click enable editing to really open it ok few",
    "start": "262220",
    "end": "273290"
  },
  {
    "start": "271000",
    "end": "340000"
  },
  {
    "text": "examples of macro based campaigns may be the most prolific one is a motet it's a",
    "start": "273290",
    "end": "279590"
  },
  {
    "text": "banking Trojan active since 2014 and everyday it sends there is a botnet",
    "start": "279590",
    "end": "286640"
  },
  {
    "text": "sending hundreds of thousands of phishing emails with macros every day even today",
    "start": "286640",
    "end": "293200"
  },
  {
    "text": "another one is FD code it's run somewhere written in PowerShell the",
    "start": "293200",
    "end": "299780"
  },
  {
    "text": "infection vector is also a macro other examples black energy an Arabic",
    "start": "299780",
    "end": "307040"
  },
  {
    "text": "destroyer black energy it's related to two attacks that happened on Ukrainian",
    "start": "307040",
    "end": "312530"
  },
  {
    "text": "power plants in 2015 and 16 and Olympia",
    "start": "312530",
    "end": "318620"
  },
  {
    "text": "destroyer was the attack on the Winter Olympics in 2018 and in both cases the",
    "start": "318620",
    "end": "324890"
  },
  {
    "text": "intrusion the initial intrusion vector was a macro and yes the list goes on and",
    "start": "324890",
    "end": "331790"
  },
  {
    "text": "on and on there are many many other Mara campaigns since 2014 using VBA macros",
    "start": "331790",
    "end": "337820"
  },
  {
    "text": "and still today so this is the typical macro viewer that you get when you open",
    "start": "337820",
    "end": "344840"
  },
  {
    "start": "340000",
    "end": "351000"
  },
  {
    "text": "a document with a malicious macro trying to push the end user to click",
    "start": "344840",
    "end": "350210"
  },
  {
    "text": "enable content okay once you click on about content what can happen a VB micro",
    "start": "350210",
    "end": "355940"
  },
  {
    "start": "351000",
    "end": "445000"
  },
  {
    "text": "can do almost everything on the system first it can run automatically when you open or close the document it can",
    "start": "355940",
    "end": "362600"
  },
  {
    "text": "download files from the internet it can create files locally on the system it",
    "start": "362600",
    "end": "368690"
  },
  {
    "text": "can execute files or commands it can call any DLL on the system to run any",
    "start": "368690",
    "end": "374300"
  },
  {
    "text": "function it can directly inject shellcode into Microsoft Office or into",
    "start": "374300",
    "end": "380570"
  },
  {
    "text": "other processes it can call any ActiveX subject it can simulate keystrokes like",
    "start": "380570",
    "end": "387680"
  },
  {
    "text": "the end the end user so it can do almost anything an executable file",
    "start": "387680",
    "end": "393080"
  },
  {
    "text": "can do and all this it's it's not using exploit its using native Microsoft",
    "start": "393080",
    "end": "401629"
  },
  {
    "text": "Office features that have been available since 1997 so it's really features of Microsoft",
    "start": "401629",
    "end": "407240"
  },
  {
    "text": "Office it is possibly possible to write complete man we're in a VBA and some",
    "start": "407240",
    "end": "414289"
  },
  {
    "text": "people have done it but in practice VBA macros are very simple they are mostly used to either drop malicious files on a",
    "start": "414289",
    "end": "421400"
  },
  {
    "text": "system or download it from the internet",
    "start": "421400",
    "end": "424930"
  },
  {
    "text": "okay so if you need to only remember one thing is when user clicks enabled",
    "start": "426520",
    "end": "432440"
  },
  {
    "text": "content is exactly as if it was running an executable file so it's extremely",
    "start": "432440",
    "end": "439039"
  },
  {
    "text": "dangerous yet it's not really understood by most end users okay why are we still",
    "start": "439039",
    "end": "448069"
  },
  {
    "start": "445000",
    "end": "516000"
  },
  {
    "text": "talking about macros in 2019 simply because it works we have antivirus anti-spam IDs EDR CGI",
    "start": "448069",
    "end": "456349"
  },
  {
    "text": "big data machine running whatever but it's still easy to write a ten lines VD",
    "start": "456349",
    "end": "461960"
  },
  {
    "text": "macro send it by mail and it will cross all the differences and hit end users and the only line of difference you have",
    "start": "461960",
    "end": "470599"
  },
  {
    "text": "today is the end user with one button or two how does it look like malicious VBA",
    "start": "470599",
    "end": "480860"
  },
  {
    "text": "macros so that's a very simple one which",
    "start": "480860",
    "end": "486099"
  },
  {
    "text": "calls a DLL on the system called URL download file to file so it will not",
    "start": "486699",
    "end": "493639"
  },
  {
    "text": "open automatically then it will download a file from the internet save it a temporary file with the next",
    "start": "493639",
    "end": "503199"
  },
  {
    "text": "extension and then run it so it's extremely easy to write such a macro and",
    "start": "503199",
    "end": "509270"
  },
  {
    "text": "you can change it you can obfuscate it and then send it and it will work but",
    "start": "509270",
    "end": "517370"
  },
  {
    "text": "over the years the attackers have found and developed a number of",
    "start": "517370",
    "end": "524039"
  },
  {
    "text": "techniques for efficient and the ante analysis so here I just gave a list but",
    "start": "524039",
    "end": "529740"
  },
  {
    "text": "we're not going to every detail they can use ActiveX triggers so that's the",
    "start": "529740",
    "end": "536190"
  },
  {
    "text": "method that works in PowerPoint then they can hide data in the document text",
    "start": "536190",
    "end": "542760"
  },
  {
    "text": "itself in the spreadsheet cells in file properties in VBA forms in a document",
    "start": "542760",
    "end": "549029"
  },
  {
    "text": "variables it can also create the the functional calls we've seen also",
    "start": "549029",
    "end": "556320"
  },
  {
    "text": "attackers using some less known formats like publisher mime HTML XML files etc",
    "start": "556320",
    "end": "564330"
  },
  {
    "text": "that can also contain macros and that are less known by people and by anteversion very some genes then macros",
    "start": "564330",
    "end": "572700"
  },
  {
    "text": "can use the boolean I pour a shell that they can also launch VB script a script",
    "start": "572700",
    "end": "577970"
  },
  {
    "text": "geofencing it's a technique used to when you want to target a specific country the macro checks if the Microsoft fist",
    "start": "577970",
    "end": "588089"
  },
  {
    "text": "is a an Italian version for example it will only run in Italy so if your sandbox systems runs in the US you will",
    "start": "588089",
    "end": "595650"
  },
  {
    "text": "not see the macro behavior and macro can",
    "start": "595650",
    "end": "602130"
  },
  {
    "text": "use API callbacks to run shell codes so",
    "start": "602130",
    "end": "607230"
  },
  {
    "start": "607000",
    "end": "715000"
  },
  {
    "text": "here is a an example so here we see that",
    "start": "607230",
    "end": "613770"
  },
  {
    "text": "it calls some DLL Els from the system it",
    "start": "613770",
    "end": "618900"
  },
  {
    "text": "will take the the shell code copy it into a buffer allocate memory in into a",
    "start": "618900",
    "end": "624540"
  },
  {
    "text": "world for example and then run it so quick demonstration to see how simple it",
    "start": "624540",
    "end": "631709"
  },
  {
    "text": "is okay I need to move this",
    "start": "631709",
    "end": "640350"
  },
  {
    "text": "okay so this is a typical document with",
    "start": "647300",
    "end": "652500"
  },
  {
    "text": "a yellow bar with enabled content so before I never content I will just show",
    "start": "652500",
    "end": "658259"
  },
  {
    "text": "that there is a home screen so here you",
    "start": "658259",
    "end": "668190"
  },
  {
    "text": "see the macro that I showed you before so it will take the shell code and a",
    "start": "668190",
    "end": "675079"
  },
  {
    "text": "copy to a memory buffer and run it and",
    "start": "675079",
    "end": "681360"
  },
  {
    "text": "of course character Tech Z is on the other screen okay so you see the the",
    "start": "681360",
    "end": "688860"
  },
  {
    "text": "shell code as as word and it's video check code because you see it crashes",
    "start": "688860",
    "end": "695459"
  },
  {
    "text": "the world okay so this is a very simple",
    "start": "695459",
    "end": "703259"
  },
  {
    "text": "macro and of course for an attacker can just copy and paste change all the",
    "start": "703259",
    "end": "708300"
  },
  {
    "text": "details and it would be a completely new macro that will go past any antivirus engine okay another thing that is not",
    "start": "708300",
    "end": "719880"
  },
  {
    "start": "715000",
    "end": "813000"
  },
  {
    "text": "very well known is that we can use a Microsoft and v encryption until the 5th",
    "start": "719880",
    "end": "725850"
  },
  {
    "text": "2003 file encryption was quite weak and the VBA part was never encrypted so it was an issue it was not an issue for for",
    "start": "725850",
    "end": "733889"
  },
  {
    "text": "analysis tools but since office 2007 the for encryption covers the whole file and",
    "start": "733889",
    "end": "740269"
  },
  {
    "text": "so you cannot look at the code and analyze it without knowing the password",
    "start": "740269",
    "end": "745399"
  },
  {
    "text": "so usually the attackers they would pull they would put the password such as 1 2",
    "start": "745399",
    "end": "751860"
  },
  {
    "text": "3 4 in the email and then the end user just has to type this password and then run the macro there is a special",
    "start": "751860",
    "end": "760230"
  },
  {
    "text": "password that works with Excel it's a very wet switch shop if you encrypt an",
    "start": "760230",
    "end": "766050"
  },
  {
    "text": "excel file with that password it will be completely encrypted so hidden from",
    "start": "766050",
    "end": "771439"
  },
  {
    "text": "analysis tools and when the user opens it it will be transparently decrypted so",
    "start": "771439",
    "end": "779339"
  },
  {
    "text": "no need to type in so it's a trick that has been used by several malware samples to hide the code",
    "start": "779339",
    "end": "787579"
  },
  {
    "text": "recently a few tools have been released",
    "start": "787579",
    "end": "793799"
  },
  {
    "text": "for decryption and I have also integrated this with earlier tools so",
    "start": "793799",
    "end": "799980"
  },
  {
    "text": "it's now automatically used when whenever you analyze a file with a password it will automatically decrypt",
    "start": "799980",
    "end": "806639"
  },
  {
    "text": "it if it knows the password ok let's have a look now at the analysis tools",
    "start": "806639",
    "end": "814220"
  },
  {
    "start": "813000",
    "end": "896000"
  },
  {
    "text": "the first tool we have to analyze macros is Microsoft Office itself it's very",
    "start": "814220",
    "end": "819720"
  },
  {
    "text": "convenient because you can see the code in the VBA editor you can even use its",
    "start": "819720",
    "end": "825119"
  },
  {
    "text": "debugger to run through the macro step-by-step the only thing is you you",
    "start": "825119",
    "end": "831629"
  },
  {
    "text": "want to avoid to infect yourself so you need to go through the code and identify",
    "start": "831629",
    "end": "836910"
  },
  {
    "text": "malicious actions and replace them by something like a message box that's",
    "start": "836910",
    "end": "842809"
  },
  {
    "text": "that's method works very well if your macro is very obfuscated however we've",
    "start": "842809",
    "end": "851489"
  },
  {
    "text": "seen that some efficient stations you need to click enable content before you",
    "start": "851489",
    "end": "857100"
  },
  {
    "text": "see the code so obviously that will be an issue for that method I have not yet",
    "start": "857100",
    "end": "862290"
  },
  {
    "text": "found out how I mean what is the distinction between the office versions",
    "start": "862290",
    "end": "868199"
  },
  {
    "text": "that are allowed to see the code before or not I asked Microsoft but so far I have not gotten the answer another issue",
    "start": "868199",
    "end": "875579"
  },
  {
    "text": "is that if use the shift key when you open a document it will avoid any macro",
    "start": "875579",
    "end": "884040"
  },
  {
    "text": "to start but it doesn't work with every trigger and as soon as you release the",
    "start": "884040",
    "end": "889889"
  },
  {
    "text": "shift key all the triggers can still work so it's a bit dangerous ok so",
    "start": "889889",
    "end": "897319"
  },
  {
    "start": "896000",
    "end": "1000000"
  },
  {
    "text": "that's why I developed a static analysis tool called VBA it's open source",
    "start": "897319",
    "end": "904199"
  },
  {
    "text": "available on github so it's a it's a common main tool to analyze VBA macros and it's also a Python",
    "start": "904199",
    "end": "911340"
  },
  {
    "text": "library that you can integrate into other applications so over time we have",
    "start": "911340",
    "end": "919310"
  },
  {
    "text": "developed with contributors a number of parsers for many formats like Word Excel",
    "start": "919310",
    "end": "925470"
  },
  {
    "text": "PowerPoint to be sure etc so what it does it takes the input file it will",
    "start": "925470",
    "end": "931500"
  },
  {
    "text": "extract the VBA macro source code and decompress it it will apply a set of",
    "start": "931500",
    "end": "936920"
  },
  {
    "text": "simple Delphis questions like exactly small base64 reverse strings etc it also",
    "start": "936920",
    "end": "946470"
  },
  {
    "text": "contains a mini VBA language passer that tries to extract to simplify some",
    "start": "946470",
    "end": "952650"
  },
  {
    "text": "strings that have been obfuscated and then based on the the result it will",
    "start": "952650",
    "end": "958020"
  },
  {
    "text": "look for specific keywords so it will check for auto execution triggers so",
    "start": "958020",
    "end": "963240"
  },
  {
    "text": "like auto fernando cannot open the cannon clothes etc it will try to identify all the suspicious keywords we",
    "start": "963240",
    "end": "970470"
  },
  {
    "text": "know like actions to download files to write files to execute shell to call",
    "start": "970470",
    "end": "976800"
  },
  {
    "text": "dll's etc and it will also try to extract all the potential and Decatur's",
    "start": "976800",
    "end": "982290"
  },
  {
    "text": "of compromise that we can find like urls IP addresses executable file names",
    "start": "982290",
    "end": "989329"
  },
  {
    "text": "recently i had also other detections like VBS thumping and excel for macros",
    "start": "989360",
    "end": "995160"
  },
  {
    "text": "and i will show that to you in the second part of this presentation ok quick demo",
    "start": "995160",
    "end": "1003910"
  },
  {
    "start": "1000000",
    "end": "1083000"
  },
  {
    "text": "to move the screen okay yeah so I showed",
    "start": "1010630",
    "end": "1021100"
  },
  {
    "text": "you the document launching a check a shellcode before so we are going to analyze it",
    "start": "1021100",
    "end": "1028079"
  },
  {
    "text": "it's not easy",
    "start": "1028079",
    "end": "1031470"
  },
  {
    "text": "okay so it shows the code of the macro",
    "start": "1035839",
    "end": "1041558"
  },
  {
    "text": "highlighting and red and and you know the different key words that have been",
    "start": "1041559",
    "end": "1047120"
  },
  {
    "text": "found to be suspicious and then it gives the list of the different things that it",
    "start": "1047120",
    "end": "1052549"
  },
  {
    "text": "has found so here we see document open so it runs when the document opens",
    "start": "1052549",
    "end": "1058190"
  },
  {
    "text": "it runs codes from DLLs and it uses some key words to inject code into another",
    "start": "1058190",
    "end": "1064309"
  },
  {
    "text": "process etc and we even find the name of the executable file difference cut the",
    "start": "1064309",
    "end": "1070369"
  },
  {
    "text": "tag li because it was visible in the hex string of the shell code here so it's",
    "start": "1070369",
    "end": "1078940"
  },
  {
    "text": "quite handy since it's a Python library",
    "start": "1078940",
    "end": "1086929"
  },
  {
    "start": "1083000",
    "end": "1117000"
  },
  {
    "text": "it has been integrated into many projects so if you use online analysis",
    "start": "1086929",
    "end": "1093019"
  },
  {
    "text": "services like hybrid analysis joy sandbox and maybe even a virustotal",
    "start": "1093019",
    "end": "1099700"
  },
  {
    "text": "many of those services actually use or evpi behind the hood it's also",
    "start": "1099700",
    "end": "1105470"
  },
  {
    "text": "integrated in some boxes like cuckoo and Cape and many analysis tools now use",
    "start": "1105470",
    "end": "1113389"
  },
  {
    "text": "also Olivier to extract the macros okay",
    "start": "1113389",
    "end": "1119149"
  },
  {
    "start": "1117000",
    "end": "1169000"
  },
  {
    "text": "but it's not always enough sometimes macros are very very obvious cated so if",
    "start": "1119149",
    "end": "1126769"
  },
  {
    "text": "you look at this code for example it's extremely difficult to understand what it does and because we see a lot of",
    "start": "1126769",
    "end": "1135429"
  },
  {
    "text": "gibberish names it calls a lot of functions and it's very difficult to",
    "start": "1135429",
    "end": "1141740"
  },
  {
    "text": "find that way I mean manually it's almost impossible to do that because you would have to follow hundreds of function calls and",
    "start": "1141740",
    "end": "1149740"
  },
  {
    "text": "the the output of Olivier does not so much so for that case in fact I a few",
    "start": "1149740",
    "end": "1159710"
  },
  {
    "text": "years ago I started to develop five for monkey it's in fact a custom VBA parser",
    "start": "1159710",
    "end": "1167119"
  },
  {
    "text": "and an emulation engine so how it works",
    "start": "1167119",
    "end": "1172820"
  },
  {
    "start": "1169000",
    "end": "1384000"
  },
  {
    "text": "it takes the code of the macro then it friends a passer with a VBA grammar to",
    "start": "1172820",
    "end": "1180200"
  },
  {
    "text": "understand the the meaning of the the VBA code and transform all the other",
    "start": "1180200",
    "end": "1186470"
  },
  {
    "text": "code into a model in Python classes and then it will run a custom emulator that",
    "start": "1186470",
    "end": "1193150"
  },
  {
    "text": "will emulate the VBA library but also the Microsoft Office behavior so each",
    "start": "1193150",
    "end": "1200420"
  },
  {
    "text": "time the macro calls a function of world of Excel we emulated in this Python",
    "start": "1200420",
    "end": "1206720"
  },
  {
    "text": "engine and we trace the code execution and from there we try to extract all the",
    "start": "1206720",
    "end": "1213890"
  },
  {
    "text": "interesting actions when the code tries to download files from the internet to",
    "start": "1213890",
    "end": "1219440"
  },
  {
    "text": "write files to execute a shell or calderas we extract it and we also",
    "start": "1219440",
    "end": "1227240"
  },
  {
    "text": "extract the potential IOC the actual IP addresses etc so let's take the the",
    "start": "1227240",
    "end": "1233390"
  },
  {
    "text": "sample that I showed you before okay",
    "start": "1233390",
    "end": "1241120"
  },
  {
    "text": "so if I run early VBA on that sample you",
    "start": "1244080",
    "end": "1249529"
  },
  {
    "text": "see what I was showing you a lot of complex code and nothing really",
    "start": "1250100",
    "end": "1255560"
  },
  {
    "text": "interesting in the output so let's now run Viper Marquis on the",
    "start": "1255560",
    "end": "1260790"
  },
  {
    "text": "same sample it's it's very slow you will",
    "start": "1260790",
    "end": "1268590"
  },
  {
    "text": "see so now it's first passing the code so you see it's finding a lot of vdf",
    "start": "1268590",
    "end": "1275220"
  },
  {
    "text": "functions each function is only three statements so very very small so now",
    "start": "1275220",
    "end": "1280980"
  },
  {
    "text": "it's converting all this VBA code into Python model so it takes it takes a",
    "start": "1280980",
    "end": "1292230"
  },
  {
    "text": "while we have tried to optimize it but it's a bit difficult so by the way is",
    "start": "1292230",
    "end": "1303300"
  },
  {
    "text": "why I developed this this project a few years ago and in the last two years it's",
    "start": "1303300",
    "end": "1309150"
  },
  {
    "text": "mostly Kirk savory from a Walmart with helping a lot contributing a lot of",
    "start": "1309150",
    "end": "1314700"
  },
  {
    "text": "improvements and it's thanks to him that now it's getting to state that it's",
    "start": "1314700",
    "end": "1321510"
  },
  {
    "text": "really useful okay it has finished passing and now it's simulating the code",
    "start": "1321510",
    "end": "1328110"
  },
  {
    "text": "so you see it's calling all the functions and getting the results and in",
    "start": "1328110",
    "end": "1333300"
  },
  {
    "text": "the end that's what we have found in the code we see that in fact it's executing",
    "start": "1333300",
    "end": "1339570"
  },
  {
    "text": "a command using the Microsoft script control so in fact it's an ActiveX",
    "start": "1339570",
    "end": "1346800"
  },
  {
    "text": "object that can run a G script so JavaScript and here we see the the code",
    "start": "1346800",
    "end": "1352050"
  },
  {
    "text": "of the JavaScript at is going to be execute execute ef3 executed and here",
    "start": "1352050",
    "end": "1357150"
  },
  {
    "text": "for example we see that there is a URL so obviously this this macro that was",
    "start": "1357150",
    "end": "1364020"
  },
  {
    "text": "really effective is a running JavaScript as a second stage to download an",
    "start": "1364020",
    "end": "1369540"
  },
  {
    "text": "executable file and run it on the system so thanks to this emulation engine now",
    "start": "1369540",
    "end": "1375030"
  },
  {
    "text": "we know what the code is actually doing and we can then continue the analysis on this executable file okay so now I'm",
    "start": "1375030",
    "end": "1388750"
  },
  {
    "start": "1384000",
    "end": "1434000"
  },
  {
    "text": "going to talk about two advanced techniques that have been recently",
    "start": "1388750",
    "end": "1397020"
  },
  {
    "text": "reported at conferences and used in the wild so first VBA stomping so VBA macros are",
    "start": "1397650",
    "end": "1406000"
  },
  {
    "text": "stored under several forms within a document of course of course we have the the VBA source code that's the plain",
    "start": "1406000",
    "end": "1413590"
  },
  {
    "text": "text of the VBA macro compressed so it's a start here in the VBA module of",
    "start": "1413590",
    "end": "1419920"
  },
  {
    "text": "Microsoft Office file but we also have another part which is called a peek code",
    "start": "1419920",
    "end": "1425620"
  },
  {
    "text": "here it's a pre passed VBA code that it's actually bytecode ready to be",
    "start": "1425620",
    "end": "1432340"
  },
  {
    "text": "executed by a Microsoft Office and in fact when you open a file containing",
    "start": "1432340",
    "end": "1437350"
  },
  {
    "start": "1434000",
    "end": "1527000"
  },
  {
    "text": "macros Microsoft Office will check this P code if it matches the same version of",
    "start": "1437350",
    "end": "1442890"
  },
  {
    "text": "Office then it will directly render the P code without looking at the VBA source",
    "start": "1442890",
    "end": "1449020"
  },
  {
    "text": "code the issue is that most analysis tools including mine and also on similar",
    "start": "1449020",
    "end": "1456910"
  },
  {
    "text": "engines only check this part not the P code so in theory if you modify the P",
    "start": "1456910",
    "end": "1464500"
  },
  {
    "text": "code know if you modify the VBA source code to look something benign then the",
    "start": "1464500",
    "end": "1470260"
  },
  {
    "text": "the P code will not be seen and I will you go and undetected and that's what was called the VBA stomping so this",
    "start": "1470260",
    "end": "1477460"
  },
  {
    "text": "technique was reported years ago by a doctor in Bonn chef and he released the",
    "start": "1477460",
    "end": "1483460"
  },
  {
    "text": "tool called a picker dump that can extract and disassemble the P code the",
    "start": "1483460",
    "end": "1491470"
  },
  {
    "text": "technique was first demonstrated at Davi cone-like by Kirk savory and it developed some",
    "start": "1491470",
    "end": "1497530"
  },
  {
    "text": "tools to show it but it's only this year in 2019 that",
    "start": "1497530",
    "end": "1502990"
  },
  {
    "text": "Stan Hecht released evil Clippy which made it very very easy to do so it will",
    "start": "1502990",
    "end": "1511950"
  },
  {
    "text": "with this tool you can replace the religious code by what you want and it even provides a web server so that it",
    "start": "1511950",
    "end": "1519160"
  },
  {
    "text": "can deliver the the Pico that matches exactly your Microsoft Office version based on the the one you're running so",
    "start": "1519160",
    "end": "1528190"
  },
  {
    "start": "1527000",
    "end": "1682000"
  },
  {
    "text": "what will keep he does is that it will replace the source code by another",
    "start": "1528190",
    "end": "1534520"
  },
  {
    "text": "source code while leaving the Pequod's intact so it's two quick demo",
    "start": "1534520",
    "end": "1544980"
  },
  {
    "text": "okay so here I have a macro called the",
    "start": "1553440",
    "end": "1558659"
  },
  {
    "text": "VBA code calc so it's the same as the one we've seen before so if I run our VBA on it you will see the code of the",
    "start": "1558659",
    "end": "1570500"
  },
  {
    "text": "macro that runs the shellcode okay so now I'm going to do VBA stomping on it",
    "start": "1570500",
    "end": "1577649"
  },
  {
    "text": "with a bill Clippy so for that I will replace the VBA source code by a code of",
    "start": "1577649",
    "end": "1584549"
  },
  {
    "text": "that is that looks innocuous so I will",
    "start": "1584549",
    "end": "1590789"
  },
  {
    "text": "show you the file no code at VBA that I will use so it's just a macro with the",
    "start": "1590789",
    "end": "1598740"
  },
  {
    "text": "one comments so it does nothing and I will use I will clip it to replace the",
    "start": "1598740",
    "end": "1605580"
  },
  {
    "text": "code by this one",
    "start": "1605580",
    "end": "1608360"
  },
  {
    "text": "okay so now we have a new file called",
    "start": "1612140",
    "end": "1617440"
  },
  {
    "text": "the VBA code I will Clippy the doc so if I analyze it with an or version of my",
    "start": "1617440",
    "end": "1626030"
  },
  {
    "text": "tool you see that it says it sees it",
    "start": "1626030",
    "end": "1633230"
  },
  {
    "text": "doesn't see the macro anymore okay but",
    "start": "1633230",
    "end": "1638360"
  },
  {
    "text": "what happens if I run it",
    "start": "1638360",
    "end": "1642010"
  },
  {
    "text": "so you notice through a macro and if I run it it works",
    "start": "1645790",
    "end": "1651740"
  },
  {
    "text": "so obviously Microsoft Office has run the pea coat that was containing the",
    "start": "1651740",
    "end": "1657169"
  },
  {
    "text": "shell code and not the the VBA source code that I replaced by something that",
    "start": "1657169",
    "end": "1662299"
  },
  {
    "text": "looks benign so it's a very effective technique to hide malicious code okay",
    "start": "1662299",
    "end": "1675760"
  },
  {
    "start": "1682000",
    "end": "1773000"
  },
  {
    "text": "so what I have developed recently and in fact so I developed the technique Lister",
    "start": "1682080",
    "end": "1689280"
  },
  {
    "text": "and I released the new version last night so it's brand new",
    "start": "1689280",
    "end": "1694760"
  },
  {
    "text": "so this so already VBA now we'll actually use a peek at them to",
    "start": "1694760",
    "end": "1701310"
  },
  {
    "text": "disassemble the P code it will extract all the relevant keywords like function",
    "start": "1701310",
    "end": "1706410"
  },
  {
    "text": "names valuable names etc and it will compare those names with a VBA source",
    "start": "1706410",
    "end": "1713460"
  },
  {
    "text": "code and if it doesn't find the same keyword then it's a good sign that the",
    "start": "1713460",
    "end": "1719970"
  },
  {
    "text": "file may have been stomped yes and here",
    "start": "1719970",
    "end": "1725580"
  },
  {
    "text": "it's not so easy because the tricky part is to extract the right keywords because the P code and VB is also the source",
    "start": "1725580",
    "end": "1732240"
  },
  {
    "text": "code Ike are quite different so I'll show you now if I run the latest or a",
    "start": "1732240",
    "end": "1739230"
  },
  {
    "text": "VBA on the fire so you see here maybe",
    "start": "1739230",
    "end": "1746820"
  },
  {
    "text": "there is a new alert saying a VBS tonking was detected and here instead of",
    "start": "1746820",
    "end": "1752520"
  },
  {
    "text": "the VBS source code that we had before we see the the Pico that has been the",
    "start": "1752520",
    "end": "1758420"
  },
  {
    "text": "decompile is assembled okay so now at",
    "start": "1758420",
    "end": "1765390"
  },
  {
    "text": "least we can detect such technique and still analyze the code okay",
    "start": "1765390",
    "end": "1775500"
  },
  {
    "start": "1773000",
    "end": "1907000"
  },
  {
    "text": "second technique that I wanted to show is Excel for macros it's another type of",
    "start": "1775500",
    "end": "1781590"
  },
  {
    "text": "macros that's only run in Excel it's an older engine than VB eight dates back to",
    "start": "1781590",
    "end": "1787310"
  },
  {
    "text": "93 I think it's a completely different syntax and different engine but it has",
    "start": "1787310",
    "end": "1793980"
  },
  {
    "text": "very similar features and risk as a VBA so with Excel form across you can do the",
    "start": "1793980",
    "end": "1799890"
  },
  {
    "text": "same you can call DLL so you can run executable files etc so it can be",
    "start": "1799890",
    "end": "1806820"
  },
  {
    "text": "present in Excel files but also in another old format called silk which is a text file for",
    "start": "1806820",
    "end": "1815049"
  },
  {
    "text": "to exchange data between a spreadsheet the main difference is that when you",
    "start": "1815049",
    "end": "1820749"
  },
  {
    "text": "open a sick file in Excel it's not covered by the protective view so you instead you don't get the yellow bar",
    "start": "1820749",
    "end": "1827769"
  },
  {
    "text": "with enabled editing you directly get enable content button so what I did this",
    "start": "1827769",
    "end": "1837129"
  },
  {
    "text": "year so eg Stevens we in this tool why didn't developed an Excel M parser for",
    "start": "1837129",
    "end": "1844210"
  },
  {
    "text": "Excel for macros and I integrated it into olivier so it's now the also",
    "start": "1844210",
    "end": "1849460"
  },
  {
    "text": "covered and since and in fact yesterday",
    "start": "1849460",
    "end": "1854529"
  },
  {
    "text": "I also developed a silk format passer so now or if you can under both formats",
    "start": "1854529",
    "end": "1860649"
  },
  {
    "text": "so that's brand-new ok so this is an",
    "start": "1860649",
    "end": "1871659"
  },
  {
    "text": "example of a silk file with a shell code so again a shell code that would run a Calcutta taxi so here we can see that it",
    "start": "1871659",
    "end": "1880210"
  },
  {
    "text": "can call dll files or channel 32 right process memory create thread and then",
    "start": "1880210",
    "end": "1886149"
  },
  {
    "text": "here we have the the shell code encoded with these functions and so with the",
    "start": "1886149",
    "end": "1895989"
  },
  {
    "text": "versions that I released yesterday of where Appa this is what you get in the output now you see the code and it will",
    "start": "1895989",
    "end": "1902529"
  },
  {
    "text": "also identify the different suspicious keywords so quick demo",
    "start": "1902529",
    "end": "1911128"
  },
  {
    "start": "1907000",
    "end": "1947000"
  },
  {
    "text": "so here is the the cig file if I open it in Excel Excel shows up on the wrong",
    "start": "1916860",
    "end": "1924960"
  },
  {
    "text": "screen",
    "start": "1924960",
    "end": "1927320"
  },
  {
    "text": "okay here we see nothing we don't see the code if I click enable content yes calc so",
    "start": "1930020",
    "end": "1940640"
  },
  {
    "text": "you see the circle as I run and exhale as a crash drawer so okay so now how",
    "start": "1940640",
    "end": "1951530"
  },
  {
    "start": "1947000",
    "end": "1988000"
  },
  {
    "text": "does it cook with VBA",
    "start": "1951530",
    "end": "1955720"
  },
  {
    "text": "okay",
    "start": "1962880",
    "end": "1965540"
  },
  {
    "text": "so already VBA will pass the thick file find if there are actual macros and find",
    "start": "1968880",
    "end": "1975930"
  },
  {
    "text": "out the different suspicious keywords that need to be analyzed so now you're",
    "start": "1975930",
    "end": "1984120"
  },
  {
    "text": "covered for six hours or so okay do I",
    "start": "1984120",
    "end": "1991110"
  },
  {
    "start": "1988000",
    "end": "2087000"
  },
  {
    "text": "have ten minutes okay so a few words",
    "start": "1991110",
    "end": "1998160"
  },
  {
    "text": "about detection and prevention okay so so far we have seen the analysis side of",
    "start": "1998160",
    "end": "2003380"
  },
  {
    "text": "things but you reads when you already know it's vanishes now how to detect if",
    "start": "2003380",
    "end": "2009050"
  },
  {
    "text": "something is malicious first what if we could detect all these measures macros and block them before they end up in the",
    "start": "2009050",
    "end": "2017090"
  },
  {
    "text": "end-user Inbox in fact antivirus engines are fine for many normal detection but",
    "start": "2017090",
    "end": "2026300"
  },
  {
    "text": "for macros it's really not enough because there are too many new macros every day it's too easy to create new",
    "start": "2026300",
    "end": "2032990"
  },
  {
    "text": "macros to change the code so that it looks different and it's very difficult for antivirus companies to keep up with",
    "start": "2032990",
    "end": "2040010"
  },
  {
    "text": "that when you have thousands of new samples every day it's almost impossible",
    "start": "2040010",
    "end": "2045590"
  },
  {
    "text": "to ever see nature's and when you develop the signature to detect",
    "start": "2045590",
    "end": "2050898"
  },
  {
    "text": "malicious macro by the time it takes a few hours so that your customers get the",
    "start": "2050899",
    "end": "2056658"
  },
  {
    "text": "signature and by that time the attackers have already switched on to a new macro so it's a constant cat and mouse game",
    "start": "2056659",
    "end": "2064158"
  },
  {
    "text": "and antivirus functions are not enough to do that and there are so many samples",
    "start": "2064159",
    "end": "2073340"
  },
  {
    "text": "of meshes macros that if you take some measure samples several months old",
    "start": "2073340",
    "end": "2080060"
  },
  {
    "text": "and run into antivirus engine many of them are not detected so it's really not",
    "start": "2080060",
    "end": "2085638"
  },
  {
    "text": "working so I try to think okay how could",
    "start": "2085639",
    "end": "2091040"
  },
  {
    "start": "2087000",
    "end": "2146000"
  },
  {
    "text": "we do how can we detect measures macros in fact there are few simple",
    "start": "2091040",
    "end": "2096260"
  },
  {
    "text": "observations first malicious macros need to start automatically if they don't start it's not my way so",
    "start": "2096260",
    "end": "2104359"
  },
  {
    "text": "we need to have a keyword like document open that cannot close Auto open in a in a macro second they need to do something",
    "start": "2104359",
    "end": "2111920"
  },
  {
    "text": "to the system they need to drop payload as a file or they need to inject code into another process and finally they",
    "start": "2111920",
    "end": "2119150"
  },
  {
    "text": "need to do something to execute that payload luckily for us most of those",
    "start": "2119150",
    "end": "2124400"
  },
  {
    "text": "actions cannot be affiliated in VBA those are VBA keywords that cannot be affiliated and if you look at most of",
    "start": "2124400",
    "end": "2133250"
  },
  {
    "text": "the normal legitimate macros they do not need to use those features so if we know",
    "start": "2133250",
    "end": "2139850"
  },
  {
    "text": "the right keywords it's possible to detect malicious macros using a small number of them so that's how I developed",
    "start": "2139850",
    "end": "2148450"
  },
  {
    "start": "2146000",
    "end": "2222000"
  },
  {
    "text": "this tool called macro Raptor so first I identify if there are automatic triggers",
    "start": "2148450",
    "end": "2155650"
  },
  {
    "text": "then identify keywords that related to a new write operation on the system and",
    "start": "2155650",
    "end": "2162950"
  },
  {
    "text": "then if there is any keyword that looked like an execution operation and did I",
    "start": "2162950",
    "end": "2169280"
  },
  {
    "text": "grow them is that if there is automatic figure and either write or execute then",
    "start": "2169280",
    "end": "2175369"
  },
  {
    "text": "it's classified as suspicious in",
    "start": "2175369",
    "end": "2181280"
  },
  {
    "text": "practice I tested Microraptor on all the samples I have and I mean all of them so",
    "start": "2181280",
    "end": "2187160"
  },
  {
    "text": "far I've been detected and it worked even from the 99 micro virus like melissa to the latest a motet that i",
    "start": "2187160",
    "end": "2194119"
  },
  {
    "text": "download this morning the thing is that algorithm is very simple it's really",
    "start": "2194119",
    "end": "2200480"
  },
  {
    "text": "focused on detection there will be false positives because you can have legitimate macros that run automatically",
    "start": "2200480",
    "end": "2207740"
  },
  {
    "text": "and that try to write something to disk or to use a create object function call",
    "start": "2207740",
    "end": "2212990"
  },
  {
    "text": "for example but at least it will detect most malicious macros and block a few",
    "start": "2212990",
    "end": "2220160"
  },
  {
    "text": "legitimate ones so quit them all",
    "start": "2220160",
    "end": "2226089"
  },
  {
    "text": "so here I have a number of files in that directory and I will run my just MRAP",
    "start": "2237900",
    "end": "2245160"
  },
  {
    "text": "tour on all of them so you see unlike Viper monkey it's very",
    "start": "2245160",
    "end": "2253200"
  },
  {
    "text": "very fast because it's just checking for a few specific keywords and you see here",
    "start": "2253200",
    "end": "2258510"
  },
  {
    "text": "we have the code of melissa from 99 and we have a fresh sample from imitate from",
    "start": "2258510",
    "end": "2264960"
  },
  {
    "text": "this morning and a few other ones that are quite recent and all of them have",
    "start": "2264960",
    "end": "2271380"
  },
  {
    "text": "been flagged as suspicious on the contrary I have a religious bank macros here document with that macros and those",
    "start": "2271380",
    "end": "2278760"
  },
  {
    "text": "ones are not flagged as suspicious so",
    "start": "2278760",
    "end": "2283830"
  },
  {
    "text": "very very simple very fast also for",
    "start": "2283830",
    "end": "2289560"
  },
  {
    "text": "example here that's a recent example I've seen so which was yeah a few days",
    "start": "2289560",
    "end": "2297240"
  },
  {
    "text": "ago on a virustotal this macro which is obviously malicious when you look at the code was not detected by most antivirus",
    "start": "2297240",
    "end": "2304740"
  },
  {
    "text": "engines from the virus total and yet I mean it's directly flagged suspicious by",
    "start": "2304740",
    "end": "2310200"
  },
  {
    "text": "macro okay microbe tour is nice but what",
    "start": "2310200",
    "end": "2315990"
  },
  {
    "start": "2312000",
    "end": "2359000"
  },
  {
    "text": "we need is to go further we need to implement it to block macros before the end users so I have developed a military",
    "start": "2315990",
    "end": "2326340"
  },
  {
    "text": "script that can be integrated with a San Mays fan mail and postfix into an email",
    "start": "2326340",
    "end": "2331410"
  },
  {
    "text": "server it will detect malicious macros in email attachments and remove them automatically and a similar filter could",
    "start": "2331410",
    "end": "2339390"
  },
  {
    "text": "also be developed for web proxies so it's it's a demonstration it's not",
    "start": "2339390",
    "end": "2345930"
  },
  {
    "text": "production grade but at least it shows that we could easily capture block",
    "start": "2345930",
    "end": "2351510"
  },
  {
    "text": "macros in emails before they reach end-users without relying on antivirus engines there are other detection",
    "start": "2351510",
    "end": "2361740"
  },
  {
    "start": "2359000",
    "end": "2372000"
  },
  {
    "text": "solutions and you can also use a Microsoft GPOs if you want to block on macros coming from in Italia",
    "start": "2361740",
    "end": "2367900"
  },
  {
    "text": "to have an additional layer of protection a quick word about",
    "start": "2367900",
    "end": "2373569"
  },
  {
    "start": "2372000",
    "end": "2424000"
  },
  {
    "text": "application guard Microsoft recently announced that they will change the way",
    "start": "2373569",
    "end": "2379599"
  },
  {
    "text": "microsoft office opens documents they will replace the protected view by",
    "start": "2379599",
    "end": "2386109"
  },
  {
    "text": "application guard which in fact will run Microsoft Office in a container thank",
    "start": "2386109",
    "end": "2391960"
  },
  {
    "text": "you in a container before I mean if it",
    "start": "2391960",
    "end": "2397420"
  },
  {
    "text": "comes from the internet so that's very nice it will be very well me 2020 for my",
    "start": "2397420",
    "end": "2404289"
  },
  {
    "text": "understanding it will not be deployed automatically on all of his versions the",
    "start": "2404289",
    "end": "2409960"
  },
  {
    "text": "thing is apparently in the container when you open the file it will let macros run directly with that enable",
    "start": "2409960",
    "end": "2415390"
  },
  {
    "text": "content button so we have to see if the container is secure enough to contain",
    "start": "2415390",
    "end": "2420640"
  },
  {
    "text": "the macros because they will run okay in",
    "start": "2420640",
    "end": "2427390"
  },
  {
    "start": "2424000",
    "end": "2548000"
  },
  {
    "text": "fact the main issue with VBA macros is that the the VBA engine and the API is",
    "start": "2427390",
    "end": "2433599"
  },
  {
    "text": "way way too powerful it can do anything on your system so I think the only way",
    "start": "2433599",
    "end": "2438730"
  },
  {
    "text": "to tackle this issue because we cannot block all macros",
    "start": "2438730",
    "end": "2443920"
  },
  {
    "text": "many people need macros to do their job so a way to do that would be to look at",
    "start": "2443920",
    "end": "2449890"
  },
  {
    "text": "the API and separate what are the safe features what are the unsafe features for example calling a DLL on the system",
    "start": "2449890",
    "end": "2457270"
  },
  {
    "text": "is really a high security risk and it's normally not used by most legitimate",
    "start": "2457270",
    "end": "2463180"
  },
  {
    "text": "macros so we could identify those unsafe features and",
    "start": "2463180",
    "end": "2469770"
  },
  {
    "text": "disable them for normal end-users and only allow them if you really know what",
    "start": "2471150",
    "end": "2476890"
  },
  {
    "text": "you're doing or if the macro is a digital sign or something like that so that end users could use macros with",
    "start": "2476890",
    "end": "2484210"
  },
  {
    "text": "safe features easily with that risk and unsafe features would be only allowed",
    "start": "2484210",
    "end": "2490210"
  },
  {
    "text": "with an additional and a layer of security in fact it's the same model",
    "start": "2490210",
    "end": "2495400"
  },
  {
    "text": "that has been implemented in Adobe Reader for the JavaScript API if you",
    "start": "2495400",
    "end": "2501250"
  },
  {
    "text": "look at Adobe Reader the JavaScript API allows you to do many things in the PDF",
    "start": "2501250",
    "end": "2507100"
  },
  {
    "text": "document but it's not allowed to touch the system it cannot touch files cannot touch other processes so it's quite safe",
    "start": "2507100",
    "end": "2515200"
  },
  {
    "text": "and nowadays there are very few security",
    "start": "2515200",
    "end": "2520240"
  },
  {
    "text": "issues in PDF there used to be a few years ago but not now in 2019 PDF is",
    "start": "2520240",
    "end": "2525970"
  },
  {
    "text": "much safer than it used to be and I think Microsoft Office could follow the",
    "start": "2525970",
    "end": "2531610"
  },
  {
    "text": "same approach for VBA to to save to to",
    "start": "2531610",
    "end": "2537520"
  },
  {
    "text": "add sorry to fix this issue we have with",
    "start": "2537520",
    "end": "2543370"
  },
  {
    "text": "a VBA macros for 19 years more than 19 years now ok future work so oily tools",
    "start": "2543370",
    "end": "2552610"
  },
  {
    "start": "2548000",
    "end": "3032000"
  },
  {
    "text": "is an open source project and we have many ideas and many things to improve",
    "start": "2552610",
    "end": "2559540"
  },
  {
    "text": "with a contributors first we have developed a number of small tools now it",
    "start": "2559540",
    "end": "2566680"
  },
  {
    "text": "would be time to have a single scanning tool that with a scan for everything not just macros also Viper monkey we need to",
    "start": "2566680",
    "end": "2577090"
  },
  {
    "text": "improve the password to make it faster etc and to migrate to Python 3 and that's not an easy task quickly I would",
    "start": "2577090",
    "end": "2586480"
  },
  {
    "text": "like to thank all the open source contributors because I'm not the only one working on this project so many",
    "start": "2586480",
    "end": "2594310"
  },
  {
    "text": "people have contributed they're very useful parts of these tools so it's open",
    "start": "2594310",
    "end": "2600160"
  },
  {
    "text": "source is really a great way to develop such such tools ok quick summary of the",
    "start": "2600160",
    "end": "2608170"
  },
  {
    "text": "takeaways so first yes when user clicks unable content it's exactly as dangerous",
    "start": "2608170",
    "end": "2613330"
  },
  {
    "text": "as running an unknown executable file so it's a really a security issue VBA",
    "start": "2613330",
    "end": "2619510"
  },
  {
    "text": "macros are old but they are still used a lot to the ROM are aware those days and simply because it works and there are",
    "start": "2619510",
    "end": "2627880"
  },
  {
    "text": "more and more efficient so it's hard for analysts to find out what they do but we",
    "start": "2627880",
    "end": "2633880"
  },
  {
    "text": "are improving at analyst tools and it's great to have open sourced collaborators to do that and may be an area that needs",
    "start": "2633880",
    "end": "2643150"
  },
  {
    "text": "to be improved is to filter macros before they reach end users using email gateways and web proxies ok that's it",
    "start": "2643150",
    "end": "2652780"
  },
  {
    "text": "for my presentation",
    "start": "2652780",
    "end": "2655320"
  },
  {
    "text": "so we have a few minutes for questions",
    "start": "2662910",
    "end": "2667710"
  },
  {
    "text": "no questions yes",
    "start": "2673529",
    "end": "2679020"
  },
  {
    "text": "right so although you were saying that it's possible to basically have code within other parts of the document like",
    "start": "2687840",
    "end": "2694110"
  },
  {
    "text": "sales or part of the documents like other variables so what if the peacoat",
    "start": "2694110",
    "end": "2699150"
  },
  {
    "text": "make reference to these cells and then basically what what what sorry what what",
    "start": "2699150",
    "end": "2711810"
  },
  {
    "text": "you'll be able to detect say BBS stomping because essentially the peacoat it's basically making cause to these",
    "start": "2711810",
    "end": "2718830"
  },
  {
    "text": "these cells so essentially the Pico doesn't contain any malicious functions",
    "start": "2718830",
    "end": "2725370"
  },
  {
    "text": "no in fact the the code itself must be",
    "start": "2725370",
    "end": "2731430"
  },
  {
    "text": "in the VBA module it cannot be in the document or in the forms or extracts in",
    "start": "2731430",
    "end": "2736590"
  },
  {
    "text": "fact what you have in the document or in the forms or in the document variables",
    "start": "2736590",
    "end": "2741950"
  },
  {
    "text": "strings strings that can be extracted by the VBA code and then the obfuscated",
    "start": "2741950",
    "end": "2748560"
  },
  {
    "text": "that's where they hide for example if they need to connect to a URL to to",
    "start": "2748560",
    "end": "2754980"
  },
  {
    "text": "download a payload they will take that URL then they will obfuscate it with different functions and then store that",
    "start": "2754980",
    "end": "2762900"
  },
  {
    "text": "text into the document text in the document body with a small font or in a",
    "start": "2762900",
    "end": "2768600"
  },
  {
    "text": "white character so that you don't see it and the the VBA code will find that data",
    "start": "2768600",
    "end": "2776280"
  },
  {
    "text": "and then unpack it to use it but it's not actual code in the document the code",
    "start": "2776280",
    "end": "2783120"
  },
  {
    "text": "is always in the VBA module so so then",
    "start": "2783120",
    "end": "2789300"
  },
  {
    "text": "it means that whatever when you do VBA stomping you will only hide the code not",
    "start": "2789300",
    "end": "2794720"
  },
  {
    "text": "the hidden data in the rest of the document",
    "start": "2794720",
    "end": "2799790"
  },
  {
    "text": "if",
    "start": "2805240",
    "end": "2808240"
  },
  {
    "text": "thank you for the slight on encryption you mentioned this well with sweatshop hidden feature of Excel yes it Microsoft",
    "start": "2812330",
    "end": "2823160"
  },
  {
    "text": "disclosed what is the story behind that to be honest I don't know I think it's",
    "start": "2823160",
    "end": "2830960"
  },
  {
    "text": "very old it has been there for ages I don't know exactly where it comes from",
    "start": "2830960",
    "end": "2838570"
  },
  {
    "text": "but I think yeah it's you have this in other software for example in Adobe",
    "start": "2838570",
    "end": "2845120"
  },
  {
    "text": "Reader you can encrypt a PDF with an empty password and then it will open transparently on the user without need",
    "start": "2845120",
    "end": "2852470"
  },
  {
    "text": "to type an empty password so we have the same another software thank you",
    "start": "2852470",
    "end": "2861250"
  },
  {
    "text": "thank you for the lovely presentation I have a question if there is malicious",
    "start": "2871830",
    "end": "2878020"
  },
  {
    "text": "leader than VBA in one of the documents can another document having a different",
    "start": "2878020",
    "end": "2883710"
  },
  {
    "text": "VBA or a macro fire the previous one can",
    "start": "2883710",
    "end": "2890530"
  },
  {
    "text": "two documents be linked you mean double vehicle that's a good question",
    "start": "2890530",
    "end": "2899460"
  },
  {
    "text": "well if both macros are running you mean to documents with two macros running at",
    "start": "2899460",
    "end": "2905710"
  },
  {
    "text": "the same time yeah okay well yes of",
    "start": "2905710",
    "end": "2910930"
  },
  {
    "text": "course because these two macros are actually processing on the system so they can use anything on the system to",
    "start": "2910930",
    "end": "2916780"
  },
  {
    "text": "communicate together they can use files they can use TLS to communicate with a",
    "start": "2916780",
    "end": "2922510"
  },
  {
    "text": "memory or the network the question is that the malicious code can actually reside in one but not be triggered by",
    "start": "2922510",
    "end": "2929050"
  },
  {
    "text": "the same same document right oh so you",
    "start": "2929050",
    "end": "2937030"
  },
  {
    "text": "mean one document triggers another one",
    "start": "2937030",
    "end": "2940680"
  },
  {
    "text": "well in fact in any document anyway if you want to run code you need to click enable content so the user would have to",
    "start": "2942900",
    "end": "2950770"
  },
  {
    "text": "open both documents and click on every content on both otherwise the code will not run on the second one so it's it's",
    "start": "2950770",
    "end": "2957130"
  },
  {
    "text": "not automatic I mean no I asked this question is like your tool you can",
    "start": "2957130",
    "end": "2962260"
  },
  {
    "text": "extract the VBA yes and so that that",
    "start": "2962260",
    "end": "2967420"
  },
  {
    "text": "kind of thing can be done by the other document right if it is enabled then in",
    "start": "2967420",
    "end": "2972550"
  },
  {
    "text": "that case it will not really showing as a malicious maybe well so the thing is",
    "start": "2972550",
    "end": "2979390"
  },
  {
    "text": "that when you run the VBA code cannot modify itself or modify another VBA",
    "start": "2979390",
    "end": "2986350"
  },
  {
    "text": "c'mon there is a security parameter in office that prevents that in fact that",
    "start": "2986350",
    "end": "2992680"
  },
  {
    "text": "that was a big issue back in the 90s with the micro virus they were",
    "start": "2992680",
    "end": "2997690"
  },
  {
    "text": "automatically changing themselves and they were infecting other documents that is not possible anymore nowadays",
    "start": "2997690",
    "end": "3005220"
  },
  {
    "text": "microsoft office blocks VBA code can do anything on the system except modify",
    "start": "3005220",
    "end": "3010470"
  },
  {
    "text": "itself so it cannot modify the VDA code in another document directly it's not",
    "start": "3010470",
    "end": "3017069"
  },
  {
    "text": "possible yes maybe last question out of",
    "start": "3017069",
    "end": "3024029"
  },
  {
    "text": "time okay so which we can discuss after the",
    "start": "3024029",
    "end": "3029210"
  },
  {
    "text": "[Applause]",
    "start": "3031110",
    "end": "3033979"
  }
]