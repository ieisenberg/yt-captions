[
  {
    "start": "0",
    "end": "54000"
  },
  {
    "text": "hello everyone I am Matthew snck um and I am here to talk to you today about",
    "start": "359",
    "end": "7279"
  },
  {
    "text": "cellular exploitation on global scale rise and fall the control",
    "start": "7279",
    "end": "14280"
  },
  {
    "text": "protocol so focus of this talk is to you",
    "start": "14280",
    "end": "19680"
  },
  {
    "text": "know analyze the carrier mandated remote control and management functionality",
    "start": "19680",
    "end": "26760"
  },
  {
    "text": "that is built into for now 2 billion cellular devices",
    "start": "26760",
    "end": "32920"
  },
  {
    "text": "um going to talk about the different security issues that found after finding",
    "start": "32920",
    "end": "39239"
  },
  {
    "text": "this little thing and finally demonstrate uh and talk through a few",
    "start": "39239",
    "end": "46360"
  },
  {
    "text": "the different ways that code execution can be obtained using over theair",
    "start": "46360",
    "end": "52960"
  },
  {
    "text": "attacks so a little bit about my background um I am a security a research",
    "start": "52960",
    "end": "59640"
  },
  {
    "start": "54000",
    "end": "54000"
  },
  {
    "text": "science at acuant labs in the applied research division um kind of my actual background",
    "start": "59640",
    "end": "67040"
  },
  {
    "text": "is mobile and embedded you know device security and exploitation uh also focus in like",
    "start": "67040",
    "end": "74799"
  },
  {
    "text": "cellular M1 space and in 2011 worked on the first over theair public demo of a",
    "start": "74799",
    "end": "82240"
  },
  {
    "text": "car hack uh and I would like to thank uh my co-researcher mark Blanche who's not",
    "start": "82240",
    "end": "88520"
  },
  {
    "text": "here today um he greatly helped with route generation Android tracing and a",
    "start": "88520",
    "end": "95000"
  },
  {
    "text": "lot of the fun exploitation parts so how did this research begin um",
    "start": "95000",
    "end": "102479"
  },
  {
    "text": "well kind of doing something that I know very few of you like to do I actually",
    "start": "102479",
    "end": "108439"
  },
  {
    "text": "read a sales manual and in that manual it",
    "start": "108439",
    "end": "114040"
  },
  {
    "text": "said if you have forgotten to enable over theair command console please let",
    "start": "114040",
    "end": "120600"
  },
  {
    "text": "us know and we can enable it for",
    "start": "120600",
    "end": "125680"
  },
  {
    "text": "you to me that immediately stuck out as uh how the hell is that's",
    "start": "125680",
    "end": "132879"
  },
  {
    "text": "happening and unfortunately that led to about a year long Rabbit Hole of",
    "start": "132879",
    "end": "138879"
  },
  {
    "text": "research okay let's get into it so the rise of the control protocol uh overview",
    "start": "138879",
    "end": "144959"
  },
  {
    "text": "of carrier controls little bit about the history um prior",
    "start": "144959",
    "end": "150519"
  },
  {
    "start": "147000",
    "end": "147000"
  },
  {
    "text": "standards so found that these carrier controls uh are more or less mandated by",
    "start": "150519",
    "end": "158560"
  },
  {
    "text": "um what's called the open mobile Alliance it's a standards body that pretty much comes together and makes up",
    "start": "158560",
    "end": "164800"
  },
  {
    "text": "a bunch of different standards from like you know om uh Sim OTA just lots of random",
    "start": "164800",
    "end": "174519"
  },
  {
    "text": "cellular and other stuff um you know this originally seem to have started",
    "start": "174519",
    "end": "181200"
  },
  {
    "text": "with a protocol called omacp uh which is client provisioning",
    "start": "181200",
    "end": "187959"
  },
  {
    "text": "you know it's originally some public research about it by MC labs in 2009 um",
    "start": "187959",
    "end": "194640"
  },
  {
    "text": "it's used mostly in GSM networks so here in Europe you'll see a lot more of that",
    "start": "194640",
    "end": "201200"
  },
  {
    "text": "um then there's also uh Oma um or PA and OMP which is mostly for",
    "start": "201200",
    "end": "209760"
  },
  {
    "text": "CDMA networks these are kind of older Legacy protocols um still partially used",
    "start": "209760",
    "end": "216680"
  },
  {
    "text": "but we'll talk a little bit about that more later now the current standard om device",
    "start": "216680",
    "end": "225879"
  },
  {
    "start": "221000",
    "end": "221000"
  },
  {
    "text": "management up until about a year ago a little more than that I had never heard of this uh yet it's on over two billion",
    "start": "225879",
    "end": "234159"
  },
  {
    "text": "cellular devices um it's amalgamation of the previous protocols I talked about",
    "start": "234159",
    "end": "240040"
  },
  {
    "text": "with some new interesting features uh now carriers themselves are the ones who Define how it's supposed to",
    "start": "240040",
    "end": "246840"
  },
  {
    "text": "work on their device they tell the manufacturer that hey we want this",
    "start": "246840",
    "end": "252040"
  },
  {
    "text": "certain functionality or that uh and what feature sets are used so going",
    "start": "252040",
    "end": "258919"
  },
  {
    "text": "forward technically these feature sets are called management objects uh now each implementation",
    "start": "258919",
    "end": "266080"
  },
  {
    "text": "carrier manufacturer is very different sort",
    "start": "266080",
    "end": "271720"
  },
  {
    "text": "of so let's talk a little bit about the different kind of management objects that are available uh not sure how well",
    "start": "271720",
    "end": "277960"
  },
  {
    "start": "277000",
    "end": "277000"
  },
  {
    "text": "you can see but a quick overview we have things like fumo which is firmware over",
    "start": "277960",
    "end": "284039"
  },
  {
    "text": "there management you know if you have an Android device and you've updated it",
    "start": "284039",
    "end": "289240"
  },
  {
    "text": "chances are it was going over old medm um cono connection management this",
    "start": "289240",
    "end": "295880"
  },
  {
    "text": "is how the carriers reconfigure different uh cellular settings on your device things like APNs band channels",
    "start": "295880",
    "end": "304880"
  },
  {
    "text": "IMS credentials voice over Wi-Fi plenty of different options there",
    "start": "304880",
    "end": "311680"
  },
  {
    "text": "uh now getting into the more interesting ones LMO which is lock and wipe",
    "start": "311680",
    "end": "317360"
  },
  {
    "text": "management uh gives the carriers the ability to remotely lock factory reset",
    "start": "317360",
    "end": "323039"
  },
  {
    "text": "wipe power cycle your phone and more um device man or device capabilities manag",
    "start": "323039",
    "end": "330479"
  },
  {
    "text": "it's a lot like a MDM you know you can enable or disable",
    "start": "330479",
    "end": "336160"
  },
  {
    "text": "the ability to encrypt your device the ability to use your",
    "start": "336160",
    "end": "341240"
  },
  {
    "text": "GPS uh the ability to use Bluetooth turn it on in some cases um Diagnostics",
    "start": "341240",
    "end": "349400"
  },
  {
    "text": "management uh another interesting one find out with the different RF settings",
    "start": "349400",
    "end": "355400"
  },
  {
    "text": "are battery status memory usage running processes list uh and more kind of",
    "start": "355400",
    "end": "363680"
  },
  {
    "text": "reminded me a little bit of Carrier IQ and finally one of my favorites",
    "start": "363680",
    "end": "370120"
  },
  {
    "text": "sco software component management object the ability to install remove activate",
    "start": "370120",
    "end": "378479"
  },
  {
    "text": "and deactivate software applications that means control the",
    "start": "378479",
    "end": "383800"
  },
  {
    "text": "software installed on your phone so I'm going to start off with a",
    "start": "383800",
    "end": "388960"
  },
  {
    "text": "little demo unfortunately because of resolution it's not that easy to",
    "start": "388960",
    "end": "394000"
  },
  {
    "text": "see um not sure how well y all can actually",
    "start": "394000",
    "end": "399680"
  },
  {
    "text": "see it uh but pretty much cuz I can't even see it online um I'll just come over",
    "start": "399680",
    "end": "408319"
  },
  {
    "text": "here these are for what you can see what a carrier would see uh you have",
    "start": "408319",
    "end": "415039"
  },
  {
    "text": "a bunch of different settings of the phone things most of are",
    "start": "415039",
    "end": "420800"
  },
  {
    "text": "controlled um at the bottom you have things like what the local Wii networks",
    "start": "420800",
    "end": "426240"
  },
  {
    "text": "around the phone are to what the browser settings are what your homepage is",
    "start": "426240",
    "end": "431319"
  },
  {
    "text": "things like that this is literally the carrier's view into your cellular",
    "start": "431319",
    "end": "438360"
  },
  {
    "text": "devices there gets to be some interesting ones like these are call",
    "start": "438360",
    "end": "443639"
  },
  {
    "text": "intercept this allows for the dialing of certain numbers to be redirected or what",
    "start": "443639",
    "end": "450479"
  },
  {
    "text": "I like to use it for intent proxies um plenty more that can be",
    "start": "450479",
    "end": "457960"
  },
  {
    "text": "found uh but I think that's probably enough to show you for",
    "start": "457960",
    "end": "463599"
  },
  {
    "text": "now okay so let's go into some actual device and client",
    "start": "468199",
    "end": "475199"
  },
  {
    "text": "information devices with omadm so I originally started looking at this",
    "start": "476599",
    "end": "482560"
  },
  {
    "start": "477000",
    "end": "477000"
  },
  {
    "text": "uh in the US at US carriers um and that's where most of my original",
    "start": "482560",
    "end": "488560"
  },
  {
    "text": "research started but decided to Branch out and look at other carriers pull down",
    "start": "488560",
    "end": "494560"
  },
  {
    "text": "ROMs and network information carriers all around the world and found that in",
    "start": "494560",
    "end": "500879"
  },
  {
    "text": "many cases this is far from just an us issue and in some countries it is much",
    "start": "500879",
    "end": "508360"
  },
  {
    "text": "more prevalent even than the US um so we'll talk about a little bit of the",
    "start": "508360",
    "end": "513479"
  },
  {
    "text": "different platforms iOS currently just a US issue um or us usage on Sprint uh but",
    "start": "513479",
    "end": "524480"
  },
  {
    "text": "that doesn't mean it won't be coming in other platforms carriers are actively deploying this more and more it is new",
    "start": "524480",
    "end": "532120"
  },
  {
    "text": "to many of them and if one company was able to convince",
    "start": "532120",
    "end": "537480"
  },
  {
    "text": "it maybe others will Android Now Android is another story it is very prevalent",
    "start": "537480",
    "end": "545519"
  },
  {
    "text": "across the world on Android Union carrier a lot of them have it um",
    "start": "545519",
    "end": "550839"
  },
  {
    "text": "Blackberry not so much rest of the devices yeah you can find it again very",
    "start": "550839",
    "end": "557920"
  },
  {
    "text": "carrier specific uh so you'll have to look at what kind of device you have what carrier you're",
    "start": "557920",
    "end": "563800"
  },
  {
    "text": "on oh yeah and for me one little fun part is it is now being deployed in",
    "start": "563800",
    "end": "570240"
  },
  {
    "text": "vehicles as a method to update your ECU firmware over the",
    "start": "570240",
    "end": "576920"
  },
  {
    "text": "air okay let's talk a little bit about where the actual client lives um if you're wanting to look for",
    "start": "576920",
    "end": "583720"
  },
  {
    "start": "577000",
    "end": "577000"
  },
  {
    "text": "it so on phones it's located usually within uh the userland OS so you know",
    "start": "583720",
    "end": "592720"
  },
  {
    "text": "within Android itself iOS uh Windows mobile but one nice thing about this",
    "start": "592720",
    "end": "600200"
  },
  {
    "text": "application tends to have very privileged access to the baseband so",
    "start": "600200",
    "end": "606920"
  },
  {
    "text": "talking direct channels communication to the bband A lot of times the data that",
    "start": "606920",
    "end": "614200"
  },
  {
    "text": "coming into your phone will be directed at that level to the omadm client as opposed to going through standard",
    "start": "614200",
    "end": "621320"
  },
  {
    "text": "OS now M1 and iot devices many of them run the actual code",
    "start": "621320",
    "end": "627959"
  },
  {
    "text": "within the baseband itself it's you know kind of a just chip with a",
    "start": "627959",
    "end": "634680"
  },
  {
    "text": "bunch of stuff in it and they'll just stuck the omm client right in there too",
    "start": "634680",
    "end": "640560"
  },
  {
    "text": "other devices uh laptops hotspots things like that I'm sure bunch of yall are",
    "start": "640560",
    "end": "646240"
  },
  {
    "text": "using uh cellular hotspot because you're afraid of the Wi-Fi networks here well good chance that that uh has a very very",
    "start": "646240",
    "end": "654760"
  },
  {
    "text": "heavy implementation of this anyways some of them have it in usual land some and baseband some are mixed uh so you're",
    "start": "654760",
    "end": "662639"
  },
  {
    "text": "going to have to look for yourself okay let's talk a little bit",
    "start": "662639",
    "end": "668480"
  },
  {
    "start": "666000",
    "end": "666000"
  },
  {
    "text": "about the reference toolkit most om device management clients are based on What's called the",
    "start": "668480",
    "end": "675279"
  },
  {
    "text": "synl reference tool kit it's an open source unrestrictive license it was a",
    "start": "675279",
    "end": "682600"
  },
  {
    "text": "mid originally meant as just a proof of concept the code was",
    "start": "682600",
    "end": "687959"
  },
  {
    "text": "released and in like 2004 just to show companies hey this is how you could use",
    "start": "687959",
    "end": "694040"
  },
  {
    "text": "syncml it was not intended based on documentation I've read to actually be",
    "start": "694040",
    "end": "700440"
  },
  {
    "text": "used on production devices but that's not quick the case",
    "start": "700440",
    "end": "706639"
  },
  {
    "text": "now even though it is open source there are different vendors um one client vendor has nearly",
    "start": "706639",
    "end": "717200"
  },
  {
    "text": "complete market dominance redbend",
    "start": "717200",
    "end": "722639"
  },
  {
    "start": "721000",
    "end": "721000"
  },
  {
    "text": "software company I've never heard of before um they have and produce a client",
    "start": "722639",
    "end": "729760"
  },
  {
    "text": "called The V direct mobile om DM Client it is based on the syml",
    "start": "729760",
    "end": "735480"
  },
  {
    "text": "toolkit and they currently have about 70 to 90% market share of the client market",
    "start": "735480",
    "end": "744600"
  },
  {
    "text": "so pretty much 70 to 90% devices are around running the same code",
    "start": "744600",
    "end": "751199"
  },
  {
    "text": "base uh clients so what's provided from redbend are typically provided as binary",
    "start": "751199",
    "end": "759399"
  },
  {
    "text": "blobs that means the oems and manufacturers do not necessarily know",
    "start": "759399",
    "end": "765600"
  },
  {
    "text": "what this code fully does uh that includes baseband",
    "start": "765600",
    "end": "771639"
  },
  {
    "text": "manufacturers there are also two major release versions V4 V5",
    "start": "771639",
    "end": "779279"
  },
  {
    "text": "that we'll we'll talk about a little bit later oh and they're heavily heavily",
    "start": "779279",
    "end": "784360"
  },
  {
    "text": "promoting the use of scomo for automotive ECU updates here's very small somewhat",
    "start": "784360",
    "end": "791959"
  },
  {
    "text": "outdated list of the type of devices redben currently runs on uh you may have seen it before",
    "start": "791959",
    "end": "799480"
  },
  {
    "text": "anyways that's just a sample okay let's dig into this get into",
    "start": "799480",
    "end": "806920"
  },
  {
    "text": "the nitty-gritty going to go over the network design and actual",
    "start": "806920",
    "end": "812839"
  },
  {
    "text": "Communications so here is the network architecture diagram pretty much the uh you",
    "start": "812839",
    "end": "824480"
  },
  {
    "start": "813000",
    "end": "813000"
  },
  {
    "text": "know basic Network style is using a WAP push to from the carrier sent to the",
    "start": "824480",
    "end": "831600"
  },
  {
    "text": "device device receives it um if the carrier chooses to it will notify the",
    "start": "831600",
    "end": "838680"
  },
  {
    "text": "user otherwise they will be silent uh the device will then connect back to",
    "start": "838680",
    "end": "844759"
  },
  {
    "text": "carrier servers receive their updated configs or",
    "start": "844759",
    "end": "850240"
  },
  {
    "text": "use the management or perform any management tasks that were asked uh back",
    "start": "850240",
    "end": "855560"
  },
  {
    "text": "and forth fairly straightforward",
    "start": "855560",
    "end": "861120"
  },
  {
    "text": "somewhat so let's talk a little bit about Security based on the standard",
    "start": "861720",
    "end": "868120"
  },
  {
    "start": "863000",
    "end": "863000"
  },
  {
    "text": "it's as written Mutual authentication is",
    "start": "868120",
    "end": "873880"
  },
  {
    "text": "required um om device management protocol layer uh has two types",
    "start": "873880",
    "end": "881680"
  },
  {
    "text": "technically um there is digest which is pretty much just digest of uh a",
    "start": "881680",
    "end": "890320"
  },
  {
    "text": "client ID and a shared secret then there's a hmac md5 which",
    "start": "890320",
    "end": "898040"
  },
  {
    "text": "is ack mv5 client secret plus a not um",
    "start": "898040",
    "end": "903920"
  },
  {
    "text": "TLS or SSL in a lot of cases um according to standard if the transport",
    "start": "903920",
    "end": "910639"
  },
  {
    "text": "layer does not provide authentication each request must be",
    "start": "910639",
    "end": "917320"
  },
  {
    "text": "encrypted you have a couple different options regarding integrity and Advan more advanced SSL or encryption usage to",
    "start": "917320",
    "end": "925800"
  },
  {
    "text": "me on paper doesn't sound too bad could be",
    "start": "925800",
    "end": "930959"
  },
  {
    "start": "930000",
    "end": "930000"
  },
  {
    "text": "well let's go into a little bit about what some of the initial overthe a payload types are so we have Network",
    "start": "931040",
    "end": "939440"
  },
  {
    "text": "initiated alerts these are very small WAP payloads typically that are used",
    "start": "939440",
    "end": "946240"
  },
  {
    "text": "just to wake up the client carrier sends it and the device phones home we have uh",
    "start": "946240",
    "end": "954720"
  },
  {
    "text": "DM bootstrap and CP bootstrap these are over theair bootstrap payloads",
    "start": "954720",
    "end": "963079"
  },
  {
    "text": "going to talk about this a little more in a couple more slides so I'll give you an example of",
    "start": "963079",
    "end": "969240"
  },
  {
    "text": "what an Nia looks like um as I said earlier they're just used primarily to",
    "start": "969240",
    "end": "975040"
  },
  {
    "text": "wake up the client it's like hey need you to talk to me talk to your server um",
    "start": "975040",
    "end": "981040"
  },
  {
    "text": "it can send be sent over a bunch of different barri types seen it over SMS as well um basic format is shown there",
    "start": "981040",
    "end": "989440"
  },
  {
    "text": "you know we have header trigger body you know trigger and what supposed to be the",
    "start": "989440",
    "end": "994959"
  },
  {
    "text": "digest in there at the end of it there is also the server identifier this",
    "start": "994959",
    "end": "1000440"
  },
  {
    "text": "allows a user or a carrier to ask the client to talk to",
    "start": "1000440",
    "end": "1006319"
  },
  {
    "text": "different servers depending on what's configured now getting into what I find",
    "start": "1006319",
    "end": "1012880"
  },
  {
    "start": "1011000",
    "end": "1011000"
  },
  {
    "text": "more interesting especially in Europe and kind of more globally uh",
    "start": "1012880",
    "end": "1019440"
  },
  {
    "text": "DM bootstrap so this is used for initial device provisioning but can also be used",
    "start": "1019440",
    "end": "1027319"
  },
  {
    "text": "for device reprovision um here is a wbx ml",
    "start": "1027319",
    "end": "1033520"
  },
  {
    "text": "representation which is on the left what would primarily be coming in once you've",
    "start": "1033520",
    "end": "1040360"
  },
  {
    "text": "uh converted it from uh W pdu and you have syn representation to make it a",
    "start": "1040360",
    "end": "1046720"
  },
  {
    "text": "little bit easier TR to understand so what's interesting uh kind of note um",
    "start": "1046720",
    "end": "1054000"
  },
  {
    "text": "this is more much more heavily used on a global scale than it is in the US uh",
    "start": "1054000",
    "end": "1059520"
  },
  {
    "text": "only one care in the US uses it but because of gsm network design out here",
    "start": "1059520",
    "end": "1065320"
  },
  {
    "text": "uh this is used a lot more heavily so let's go into the actual",
    "start": "1065320",
    "end": "1071600"
  },
  {
    "text": "client side analysis so pretty much the client will communicate with",
    "start": "1071600",
    "end": "1079720"
  },
  {
    "start": "1074000",
    "end": "1074000"
  },
  {
    "text": "the server um it will receive WB XML commands that are pretty much just uh",
    "start": "1079720",
    "end": "1088520"
  },
  {
    "text": "binary versions of syncml um the commands are executed against What's called the like DM tree uh those are a",
    "start": "1088520",
    "end": "1096520"
  },
  {
    "text": "couple of the different kind of URI examples you know so different commands",
    "start": "1096520",
    "end": "1102640"
  },
  {
    "text": "though these are the fun ones you can get alert add replace",
    "start": "1102640",
    "end": "1109440"
  },
  {
    "text": "delete copy and exact talk a little bit about what those would mean later but an",
    "start": "1109440",
    "end": "1116840"
  },
  {
    "text": "example like listed is if I wanted to run an exec on the L operations lock",
    "start": "1116840",
    "end": "1123679"
  },
  {
    "text": "that would a effectively lock your device if I wanted to get your CDMA",
    "start": "1123679",
    "end": "1131200"
  },
  {
    "text": "password AJ which is your password for your CDMA network authentication that would provide it to",
    "start": "1131200",
    "end": "1137640"
  },
  {
    "text": "me as well so big graph of the many many layers of",
    "start": "1137640",
    "end": "1145400"
  },
  {
    "start": "1141000",
    "end": "1141000"
  },
  {
    "text": "client side parsing um originally the data will come in over the RF cellular network it's",
    "start": "1145400",
    "end": "1153840"
  },
  {
    "text": "parsed by the bband bband will then pass it up to",
    "start": "1153840",
    "end": "1159240"
  },
  {
    "text": "userland typically over an at or qmi connection uh it'll pass the actual data",
    "start": "1159240",
    "end": "1165840"
  },
  {
    "text": "as well as some metadata um OS user land will then reparse the data",
    "start": "1165840",
    "end": "1174159"
  },
  {
    "text": "so if you're on Android get sent via the real uh it'll parse it see hey I need to",
    "start": "1174159",
    "end": "1181520"
  },
  {
    "text": "pass this data to the DM Client it'll then send intent to the DM Client on iOS",
    "start": "1181520",
    "end": "1187480"
  },
  {
    "text": "you have Comm Center which will parcel this it'll then uh pass it to what's called DM helper from there you have two",
    "start": "1187480",
    "end": "1195559"
  },
  {
    "text": "major types of payloads or package types so the over theair bootstrap that we talked about earlier um or a network",
    "start": "1195559",
    "end": "1203320"
  },
  {
    "text": "initiated alert the bootstrap will after received go directly into the WB XML",
    "start": "1203320",
    "end": "1210240"
  },
  {
    "text": "parser and be able to start changing settings whereas the network initiated",
    "start": "1210240",
    "end": "1215360"
  },
  {
    "text": "alert just tells the device to connect home and it'll then begin What's called",
    "start": "1215360",
    "end": "1221280"
  },
  {
    "text": "the package one process and start Communications with the server and there's a bunch of different",
    "start": "1221280",
    "end": "1228240"
  },
  {
    "text": "layers wbx ML syml and uh multiple dtds under",
    "start": "1228240",
    "end": "1234559"
  },
  {
    "text": "here you know we're talking a total of like eight different parsers in this",
    "start": "1234559",
    "end": "1240640"
  },
  {
    "text": "little client lots of attack",
    "start": "1240640",
    "end": "1245399"
  },
  {
    "text": "surfaces okay talk a little bit about uh cellular testing Hardware I",
    "start": "1246240",
    "end": "1251640"
  },
  {
    "text": "use so I am a huge fan of the Nano BTS",
    "start": "1251640",
    "end": "1257679"
  },
  {
    "start": "1252000",
    "end": "1252000"
  },
  {
    "text": "The Open BS project it's really high quality open-source code um it's hard to",
    "start": "1257679",
    "end": "1265320"
  },
  {
    "text": "beat I have a lot of respect for those guys and they're if you're wanting to do",
    "start": "1265320",
    "end": "1270760"
  },
  {
    "text": "any kind of GPRS testing I definitely recommend taking a look at it um if",
    "start": "1270760",
    "end": "1277400"
  },
  {
    "text": "you're wanting to do WAP or SMS based testing it's built-in s smpp interface",
    "start": "1277400",
    "end": "1282679"
  },
  {
    "text": "awesome to use I also have a usur B210 um have run open BTS on it as well as uh",
    "start": "1282679",
    "end": "1290960"
  },
  {
    "text": "osmo BTS or had some issues with stability though",
    "start": "1290960",
    "end": "1296039"
  },
  {
    "text": "uh balant who will be talking I believe two talks after me uh will probably be",
    "start": "1296039",
    "end": "1302640"
  },
  {
    "text": "able to straighten all of that out um so you should definitely check out his talk on playing with open",
    "start": "1302640",
    "end": "1308240"
  },
  {
    "text": "BTS um now also F to cells F to cells are awesome they typically",
    "start": "1308240",
    "end": "1316600"
  },
  {
    "text": "are better performance than your BTS they're cheaper um but most bts's are",
    "start": "1316600",
    "end": "1324440"
  },
  {
    "text": "2.5g fem cells three anyways here is a little picture of a",
    "start": "1324440",
    "end": "1333120"
  },
  {
    "text": "very small amount of my testing gear this is probably 1/4 of it but you can",
    "start": "1333120",
    "end": "1341640"
  },
  {
    "text": "get an idea of some of the stuff we get to play with",
    "start": "1341640",
    "end": "1347320"
  },
  {
    "text": "so let's let's talk a little bit about identifying the actual control clients",
    "start": "1347320",
    "end": "1352400"
  },
  {
    "text": "so where are these how do I find them how do I look at them now on iOS it's pretty easy just",
    "start": "1352400",
    "end": "1361320"
  },
  {
    "start": "1357000",
    "end": "1357000"
  },
  {
    "text": "profile any service that might be talking to com Center there's not too many of them you can find where it is",
    "start": "1361320",
    "end": "1366960"
  },
  {
    "text": "that way as well as potentially future Services um Blackberry it's a little bit",
    "start": "1366960",
    "end": "1374039"
  },
  {
    "text": "different uh when I first started looking at it what I did was I pulled apart the bar files which pretty much",
    "start": "1374039",
    "end": "1380120"
  },
  {
    "text": "the install and saw what kind of clients were in the actual radio package uh",
    "start": "1380120",
    "end": "1386679"
  },
  {
    "text": "Windows mobile read the docs they got a great website covering all their documentation on this um Android so",
    "start": "1386679",
    "end": "1395600"
  },
  {
    "text": "Android as usual has a huge amount of fragmentation and you're going to have",
    "start": "1395600",
    "end": "1401440"
  },
  {
    "text": "interesting times finding it uh I've seen many different implementations some",
    "start": "1401440",
    "end": "1407600"
  },
  {
    "text": "off fiscated some not uh pretty much you're going to have to start at the beginning just look for",
    "start": "1407600",
    "end": "1413400"
  },
  {
    "text": "anything that can take a WAP uh intent or raw data raw data and uh standard SMS",
    "start": "1413400",
    "end": "1423679"
  },
  {
    "text": "intents also audit anything that's talking to the real um you know you have",
    "start": "1423679",
    "end": "1429200"
  },
  {
    "text": "QC real hook o real hook DM agent for HDC fans out there and secro client SEC",
    "start": "1429200",
    "end": "1437440"
  },
  {
    "text": "client some me all might remember from the synogen mod uh news a while back um",
    "start": "1437440",
    "end": "1444279"
  },
  {
    "text": "dude wasn't 100% wrong just the understanding of how it worked wasn't",
    "start": "1444279",
    "end": "1449679"
  },
  {
    "text": "100% either okay so let's talk about embedded",
    "start": "1449679",
    "end": "1455120"
  },
  {
    "start": "1452000",
    "end": "1452000"
  },
  {
    "text": "device a little bit um so embedded would be any kind of iot or you know whatever",
    "start": "1455120",
    "end": "1463520"
  },
  {
    "text": "type of little device that's not a phone um pretty much you can start with a baseband so into Ida see what you see",
    "start": "1463520",
    "end": "1471159"
  },
  {
    "text": "you know uh it's going to take a lot of time you can then or grip for Strings",
    "start": "1471159",
    "end": "1479200"
  },
  {
    "text": "probably faster just see if you can find anything that is using WAP synl wbx ml",
    "start": "1479200",
    "end": "1486200"
  },
  {
    "text": "quick though not super effective um once you start getting deeper in you can",
    "start": "1486200",
    "end": "1493480"
  },
  {
    "text": "trace any of the uart ports see what kind of communications might be going between bband and application processor",
    "start": "1493480",
    "end": "1501000"
  },
  {
    "text": "if you have to drop it into JTAG uh or my favorite BTS based testing",
    "start": "1501000",
    "end": "1507559"
  },
  {
    "text": "I will just throw any kind of cellular device on my personal networks and start",
    "start": "1507559",
    "end": "1512600"
  },
  {
    "text": "pounding it with different kinds of payloads see how it reacts or just sit and wait and typically they will connect",
    "start": "1512600",
    "end": "1520520"
  },
  {
    "text": "back after a certain amount of time to see hey am I supposed to get an update so you can see it that way",
    "start": "1520520",
    "end": "1528919"
  },
  {
    "text": "okay let's talk a little bit about uh simulating cellular environments so not",
    "start": "1529120",
    "end": "1534600"
  },
  {
    "text": "everyone has access to a BTS going to talk about a couple ways you can play",
    "start": "1534600",
    "end": "1539760"
  },
  {
    "start": "1537000",
    "end": "1537000"
  },
  {
    "text": "around with this stuff without one um pretty much the easiest on like say an Android device or even iOS would be to",
    "start": "1539760",
    "end": "1547720"
  },
  {
    "text": "hook and modify the methods used by the actual applications to determine the",
    "start": "1547720",
    "end": "1552760"
  },
  {
    "text": "cellular state so you can have a device that's off or not off but uh in airplane",
    "start": "1552760",
    "end": "1560000"
  },
  {
    "text": "mode if you hook the right methods it'll think it's connected to an LC Network",
    "start": "1560000",
    "end": "1565799"
  },
  {
    "text": "um what we did is modify the methods on",
    "start": "1565799",
    "end": "1572120"
  },
  {
    "text": "Android as well as custom hooks in the different Oma clients and tell it it was",
    "start": "1572120",
    "end": "1578640"
  },
  {
    "text": "on a cellular network when it was related just on Wi-Fi and did a bunch of testing just over Wi-Fi um can also just",
    "start": "1578640",
    "end": "1586840"
  },
  {
    "text": "programmatically send WAP pushes or any kind of other information locally so no",
    "start": "1586840",
    "end": "1593279"
  },
  {
    "text": "over theair actual testing would be required and makes for much faster",
    "start": "1593279",
    "end": "1598559"
  },
  {
    "text": "fuzzing uh some people will talk about fuzzing SMS and WAP using a BTS uh",
    "start": "1598559",
    "end": "1606279"
  },
  {
    "text": "unfortunately that typically would take months because you get about five SMS a",
    "start": "1606279",
    "end": "1615720"
  },
  {
    "text": "minute so now the fun part Begins the fall of the control",
    "start": "1616559",
    "end": "1623399"
  },
  {
    "text": "protocol let's talk about a little bit the potential attack",
    "start": "1623399",
    "end": "1629480"
  },
  {
    "start": "1629000",
    "end": "1629000"
  },
  {
    "text": "platforms ah so this is a little bit different from the black hat USA slide",
    "start": "1629480",
    "end": "1636039"
  },
  {
    "text": "in the US I am not allowed to test and do not test on any kind of carrier Network all of mine is private um also",
    "start": "1636039",
    "end": "1644600"
  },
  {
    "text": "US carriers heavily filter and prevent any kind of data that could be dangerous",
    "start": "1644600",
    "end": "1650880"
  },
  {
    "text": "from going over their network but that has not been necessarily the case as proven by other",
    "start": "1650880",
    "end": "1657600"
  },
  {
    "text": "researchers in non us networks plenty of",
    "start": "1657600",
    "end": "1662640"
  },
  {
    "text": "research has been done and published on the ability to send WAP push using",
    "start": "1662640",
    "end": "1668200"
  },
  {
    "text": "devices such as device to device WAP push you can also use third-party WAP",
    "start": "1668200",
    "end": "1674640"
  },
  {
    "text": "interfaces and if you like playing with MTM UDP ports work well too so what that",
    "start": "1674640",
    "end": "1681440"
  },
  {
    "text": "means is on a global side of things devices can be a lot more vulnerable",
    "start": "1681440",
    "end": "1688200"
  },
  {
    "text": "because my device can attack yours or my laptop or whatever makes it very easy a",
    "start": "1688200",
    "end": "1695080"
  },
  {
    "text": "lot of the time no proximity needed uh now also what I find",
    "start": "1695080",
    "end": "1701760"
  },
  {
    "text": "interesting is the new generation networks so",
    "start": "1701760",
    "end": "1706840"
  },
  {
    "text": "LTE have very very different network design than",
    "start": "1706840",
    "end": "1712320"
  },
  {
    "text": "previous you know they are pretty much big data networks that are very close to",
    "start": "1712320",
    "end": "1719720"
  },
  {
    "text": "say more the internet as opposed to Cellular style design um that means the",
    "start": "1719720",
    "end": "1727559"
  },
  {
    "text": "attack surface actually could be much easier because we're talking things like basic TCP IP uh sip",
    "start": "1727559",
    "end": "1735760"
  },
  {
    "text": "VoIP anything like that is much more easily understood than some of the",
    "start": "1735760",
    "end": "1741080"
  },
  {
    "text": "lowlevel network protocols required on GPRS or GSM",
    "start": "1741080",
    "end": "1746398"
  },
  {
    "text": "itself okay another potential attack platform Rogue base stations this is",
    "start": "1746559",
    "end": "1752640"
  },
  {
    "start": "1747000",
    "end": "1747000"
  },
  {
    "text": "what I pretty much use at home and RF shielded environment though they can be very",
    "start": "1752640",
    "end": "1760880"
  },
  {
    "text": "effective um my 2.5 g so Edge base station can be used",
    "start": "1760880",
    "end": "1768600"
  },
  {
    "text": "to attack LTE cellular devices including Global phones which support both LTE and",
    "start": "1768600",
    "end": "1776240"
  },
  {
    "text": "CDM or GSM and CDM it's pretty straightforward you jam the devices off",
    "start": "1776240",
    "end": "1782200"
  },
  {
    "text": "of LT 3G get them down to your base station on 2.5 90 something per of devices still",
    "start": "1782200",
    "end": "1790320"
  },
  {
    "text": "will automatically drop down to GSM or GPRS um to improve things you brought",
    "start": "1790320",
    "end": "1798039"
  },
  {
    "text": "broadcast certain neighboring information um these devices get",
    "start": "1798039",
    "end": "1803880"
  },
  {
    "text": "confused and even though they may have come from a CDMA LT network if they",
    "start": "1803880",
    "end": "1809919"
  },
  {
    "text": "support global mode they will chances are drop down to your base station though it wouldn't be stable for very",
    "start": "1809919",
    "end": "1815840"
  },
  {
    "text": "long but enough to do what you need to one little trick I like it's called",
    "start": "1815840",
    "end": "1821720"
  },
  {
    "text": "being good neighbor um use multiple bts's to broadcast cellular network",
    "start": "1821720",
    "end": "1828679"
  },
  {
    "text": "information pretty much instead of using a single BTS become your own carrier and",
    "start": "1828679",
    "end": "1835880"
  },
  {
    "text": "in that I mean lots of bts's propagating the information if it all looks good to the device very high chance of camping",
    "start": "1835880",
    "end": "1843600"
  },
  {
    "text": "and finally you have F to cells they are also extremely effective I play with",
    "start": "1843600",
    "end": "1850880"
  },
  {
    "text": "them less as you are on Carrier back hul but if an attacker were wanting to he",
    "start": "1850880",
    "end": "1858159"
  },
  {
    "text": "could use these um they are typically as I said earlier higher uh Tech um than",
    "start": "1858159",
    "end": "1863760"
  },
  {
    "text": "most of my bts's or most affordable ones such as 3G and you won't have as many",
    "start": "1863760",
    "end": "1869799"
  },
  {
    "text": "camping issues as they really are carrier networks okay going to talk about some",
    "start": "1869799",
    "end": "1877720"
  },
  {
    "text": "of the vulnerabilities so let's talk about authentication",
    "start": "1877720",
    "end": "1884320"
  },
  {
    "start": "1881000",
    "end": "1881000"
  },
  {
    "text": "again originally we said that uh they'll make ADM client uh uses credentials",
    "start": "1884320",
    "end": "1890720"
  },
  {
    "text": "based on a combination of two things well a client ID and a shared secret",
    "start": "1890720",
    "end": "1897120"
  },
  {
    "text": "token and just about every implementation I have looked at the",
    "start": "1897120",
    "end": "1903440"
  },
  {
    "text": "client ID is your IMEI or me ID and the shared secret",
    "start": "1903440",
    "end": "1912519"
  },
  {
    "text": "token is static across all devices of a single carrier that means that your IMI",
    "start": "1912519",
    "end": "1920799"
  },
  {
    "text": "which is broadcast openly over cellular networks I can literally sit and sniff it out and a secret token that is on",
    "start": "1920799",
    "end": "1931200"
  },
  {
    "text": "every device of your carrier such as the contents of the ROM I can now have the",
    "start": "1931200",
    "end": "1937799"
  },
  {
    "text": "credentials for your phone that's it so occasionally you'll find that",
    "start": "1937799",
    "end": "1945799"
  },
  {
    "text": "they're using hmac but it can be downgraded if you need to so",
    "start": "1945799",
    "end": "1951960"
  },
  {
    "text": "unfortunately not much authentication left now the cases of",
    "start": "1951960",
    "end": "1958159"
  },
  {
    "start": "1955000",
    "end": "1955000"
  },
  {
    "text": "SSL so us seems to use SSL more",
    "start": "1958159",
    "end": "1963279"
  },
  {
    "text": "worldwide a little bit less but okay we'll give it the benefit of the doubt",
    "start": "1963279",
    "end": "1969960"
  },
  {
    "text": "again this is primarily on the redb client uh found that the SSL host name",
    "start": "1969960",
    "end": "1976559"
  },
  {
    "text": "verification was hard coded to true that means that any legitimate certificate",
    "start": "1976559",
    "end": "1983159"
  },
  {
    "text": "such as bad hacker.com will be accepted as your carrier",
    "start": "1983159",
    "end": "1990679"
  },
  {
    "text": "server fun stuff there um now on iOS a little bit different um iOS has a little",
    "start": "1991000",
    "end": "1997480"
  },
  {
    "text": "bit better uh SSO controls since they are not running Java uh but if needed",
    "start": "1997480",
    "end": "2003679"
  },
  {
    "text": "all you need to do is provide a carrier mobile configuration popup so if you're man the middling it'll pop",
    "start": "2003679",
    "end": "2010320"
  },
  {
    "text": "up the screen saying update to this carrier setting and you now have a certificate on that device and command",
    "start": "2010320",
    "end": "2015799"
  },
  {
    "text": "in the middle now a little bit more worrying than even that is test servers left in",
    "start": "2015799",
    "end": "2025360"
  },
  {
    "text": "the configuration on production devices large amount of production",
    "start": "2025360",
    "end": "2030480"
  },
  {
    "text": "devices have hardcoded HTTP test servers leading to red",
    "start": "2030480",
    "end": "2036840"
  },
  {
    "text": "bend.com uh live servers there apparently but",
    "start": "2036840",
    "end": "2043799"
  },
  {
    "text": "what these can be used for is downgraded attacks I can send your device a WAP tet",
    "start": "2043799",
    "end": "2049200"
  },
  {
    "text": "to connect to redbend and because it's using HTTP it will then be quite easily man in",
    "start": "2049200",
    "end": "2056118"
  },
  {
    "text": "the middle or it is quite possible that redbin could also send your device though I",
    "start": "2056119",
    "end": "2062520"
  },
  {
    "text": "have no idea about that but pretty much with anyone man in the middling DNS",
    "start": "2062520",
    "end": "2068679"
  },
  {
    "text": "control can do it that example up there which I apologize yall can't see very well is uh an Android",
    "start": "2068679",
    "end": "2078599"
  },
  {
    "text": "4.4.4 device though it was responsibly disclosed many many months ago not sure",
    "start": "2078599",
    "end": "2084480"
  },
  {
    "text": "why it's still there okay let's go into abusing some of",
    "start": "2084480",
    "end": "2090440"
  },
  {
    "text": "the standard functionality Global provisioning and",
    "start": "2090440",
    "end": "2098400"
  },
  {
    "text": "bootstrap so many devices can be reprovisioned",
    "start": "2098400",
    "end": "2105320"
  },
  {
    "text": "with a single WAP push or in certain cases an SMS all that would be needed is",
    "start": "2105320",
    "end": "2113400"
  },
  {
    "text": "that authentication that we talked about a few minutes ago the whole IMEI and shared secret key that we all",
    "start": "2113400",
    "end": "2121880"
  },
  {
    "text": "know that is the only thing protecting many Global devices from being",
    "start": "2121880",
    "end": "2127040"
  },
  {
    "text": "reconfigured uh pretty much at the mo minimum that",
    "start": "2127040",
    "end": "2133800"
  },
  {
    "text": "would give an attacker the ability to easily and persistently have a man- INE",
    "start": "2133800",
    "end": "2140440"
  },
  {
    "text": "middle on your device without a BTS I send your device a new request",
    "start": "2140440",
    "end": "2146800"
  },
  {
    "text": "tell it hey you are now supposed to talk to these proxies and these routes and",
    "start": "2146800",
    "end": "2152240"
  },
  {
    "text": "these APNs and boom your device Now talks to",
    "start": "2152240",
    "end": "2157400"
  },
  {
    "text": "them it will hold them and you know a lot of times it will even carry through",
    "start": "2157400",
    "end": "2164440"
  },
  {
    "text": "factory reset so you could be man inth the-",
    "start": "2164440",
    "end": "2169599"
  },
  {
    "text": "middle and have no idea other fun ones inside out baseband",
    "start": "2169599",
    "end": "2176520"
  },
  {
    "start": "2174000",
    "end": "2174000"
  },
  {
    "text": "attacks so talked a little bit about this earlier but these agents have very",
    "start": "2176520",
    "end": "2183920"
  },
  {
    "text": "privileged access to baseband they literally can read write modify",
    "start": "2183920",
    "end": "2191920"
  },
  {
    "text": "nvram parameters the EF EFS and a bunch of other lowle",
    "start": "2191920",
    "end": "2198680"
  },
  {
    "text": "settings some of them pass data via the EMCC itself so say the carrier partition",
    "start": "2198680",
    "end": "2204920"
  },
  {
    "text": "or persist Um this can be leveraged both ways so radio can write to it or",
    "start": "2204920",
    "end": "2211200"
  },
  {
    "text": "userland can write to it and can be used for privilege escalation from a radio to",
    "start": "2211200",
    "end": "2218400"
  },
  {
    "text": "user land though be very careful playing with these settings you will land up",
    "start": "2218400",
    "end": "2223720"
  },
  {
    "text": "with brick devices I have plenty of them I don't know if I can expense anymore and Google probably won't send",
    "start": "2223720",
    "end": "2231119"
  },
  {
    "text": "me uh any more replacements for my broken devices okay another interesting one",
    "start": "2231119",
    "end": "2239800"
  },
  {
    "start": "2236000",
    "end": "2236000"
  },
  {
    "text": "carrier customizations so what we found in one",
    "start": "2239800",
    "end": "2245440"
  },
  {
    "text": "of the major US carriers is is something called according to their actual code uh",
    "start": "2245440",
    "end": "2253000"
  },
  {
    "text": "chameleon or Carrier branding pretty much it's used for mvnos",
    "start": "2253000",
    "end": "2259520"
  },
  {
    "text": "I you all have a fair amount of those out here uh mobile virtual Network operators so it can perform things like",
    "start": "2259520",
    "end": "2268359"
  },
  {
    "text": "call intercept at first that really freaked me out because that's literally the functionality's name uh",
    "start": "2268359",
    "end": "2277560"
  },
  {
    "text": "not as bad as you'd think it just allows any dial any number you dial to be redirected to an intent that they send",
    "start": "2277560",
    "end": "2285200"
  },
  {
    "text": "so you dial one two three and it now starts whatever",
    "start": "2285200",
    "end": "2291079"
  },
  {
    "text": "application I send um as well as a bunch of other fun",
    "start": "2291079",
    "end": "2298160"
  },
  {
    "text": "customizations that you can read in the list uh later on um things like device",
    "start": "2298160",
    "end": "2304760"
  },
  {
    "text": "self-service another lovely carrier addition um VMS which is a visual voicemail uh",
    "start": "2304760",
    "end": "2312839"
  },
  {
    "text": "APK on us devices and depending on some Global uh that's a very interesting",
    "start": "2312839",
    "end": "2320400"
  },
  {
    "text": "application there's a lot in there I definitely recommend looking at it as well as a bunch of other things that two",
    "start": "2320400",
    "end": "2327400"
  },
  {
    "text": "SL uh two pictures there are just a small list of functionality that can be found by uh dumping out the",
    "start": "2327400",
    "end": "2334079"
  },
  {
    "text": "client so going to do a little demo",
    "start": "2334079",
    "end": "2339079"
  },
  {
    "text": "so in this demo I am going to show",
    "start": "2339839",
    "end": "2345599"
  },
  {
    "text": "uh what is an ni based lock screen bypass it's built-in carrier",
    "start": "2345599",
    "end": "2352000"
  },
  {
    "text": "functionality I am sending two WAP pushes to these devices we have an LG G2",
    "start": "2352000",
    "end": "2357640"
  },
  {
    "text": "and an Android Nexus 5 both stock in there uh let's see if it",
    "start": "2357640",
    "end": "2366079"
  },
  {
    "text": "actually continues running there we go",
    "start": "2366079",
    "end": "2374560"
  },
  {
    "text": "um so pretty much just sitting there they're both connected to my BTS uh I",
    "start": "2375200",
    "end": "2381599"
  },
  {
    "text": "now send a WAP push to both devices wait for it to go over the network again these are GPRS GSM devices",
    "start": "2381599",
    "end": "2389680"
  },
  {
    "text": "and they're pretty slow but boom both lock screens off that was with a single WAP or what",
    "start": "2389680",
    "end": "2398960"
  },
  {
    "text": "would be pretty much an SMS style payload",
    "start": "2398960",
    "end": "2405119"
  },
  {
    "text": "unauthenticated and those were both locked so I hope you really trust your",
    "start": "2405440",
    "end": "2411599"
  },
  {
    "text": "carrier with your lock screens now and you get uh when you see",
    "start": "2411599",
    "end": "2418160"
  },
  {
    "text": "it you depending on the setting for that I am showing a lovely update device",
    "start": "2418160",
    "end": "2423240"
  },
  {
    "text": "error now it's a little bit blurry on this screen so finishing up the built-in",
    "start": "2423240",
    "end": "2430680"
  },
  {
    "start": "2427000",
    "end": "2427000"
  },
  {
    "text": "functionality section there are four major ways I",
    "start": "2430680",
    "end": "2436480"
  },
  {
    "text": "found that someone can achieve code execution on your device with without",
    "start": "2436480",
    "end": "2444200"
  },
  {
    "text": "memory corruption sco software management Made Easy for carriers and",
    "start": "2444200",
    "end": "2450760"
  },
  {
    "text": "attackers chameleon all you have to do is Rebrand the device say hey you're on a new mvn I need you to install new",
    "start": "2450760",
    "end": "2459240"
  },
  {
    "text": "applications um intent proxies so the little call intercept just put an intent",
    "start": "2459240",
    "end": "2467560"
  },
  {
    "text": "in there saying install this file that I push down somewhere else and finally",
    "start": "2467560",
    "end": "2473640"
  },
  {
    "text": "built-in functionality from which is all stemmed for more over the air",
    "start": "2473640",
    "end": "2480200"
  },
  {
    "text": "updates who here runs assigned firmware on their device feel free to raise your",
    "start": "2480200",
    "end": "2485640"
  },
  {
    "text": "hand if you're actually running assigned firmware okay well seems like no one is so that means if you have an omadm client on",
    "start": "2485640",
    "end": "2492520"
  },
  {
    "text": "your device and you're not running signed firmware such as actually from a",
    "start": "2492520",
    "end": "2497880"
  },
  {
    "text": "manufacturer uh no firmware signing means I can just push my own firmware to your device and have it",
    "start": "2497880",
    "end": "2505640"
  },
  {
    "text": "update so unfortunately the modific making your own modifications to devices at the same time protect you or",
    "start": "2505640",
    "end": "2514119"
  },
  {
    "text": "don't and this is also very relevant on embedded devices as there firmware verification is nowhere near what a",
    "start": "2514119",
    "end": "2520440"
  },
  {
    "text": "phone is okay go into what I like to call",
    "start": "2520440",
    "end": "2526280"
  },
  {
    "text": "tactical exploitation let's talk about some of the more in-depth vulnerabilities",
    "start": "2526280",
    "end": "2534359"
  },
  {
    "text": "found okay these are the different types of exploitable vulnerabilities found in",
    "start": "2534359",
    "end": "2541280"
  },
  {
    "text": "many omadm clients when it comes to memory corruption buffer overflows",
    "start": "2541280",
    "end": "2547760"
  },
  {
    "text": "Heap corrupt and integer overflows format string issues arbitrary reads",
    "start": "2547760",
    "end": "2554559"
  },
  {
    "text": "invalid freeze and more and one thing I would like to",
    "start": "2554559",
    "end": "2560960"
  },
  {
    "text": "remind yall many om ADM clients are built on the same code base that",
    "start": "2560960",
    "end": "2568079"
  },
  {
    "text": "means those transfer between devices I'm going to go into a lovely little example",
    "start": "2568079",
    "end": "2576079"
  },
  {
    "start": "2572000",
    "end": "2572000"
  },
  {
    "text": "this is actually probably one of my favorite bugs that",
    "start": "2576079",
    "end": "2581680"
  },
  {
    "text": "saw it is well here um by more or less",
    "start": "2581680",
    "end": "2586880"
  },
  {
    "text": "making a custom wbx SML payload uh modifying one of the um",
    "start": "2586880",
    "end": "2594720"
  },
  {
    "text": "string TBL location so it's pretty much an integer overflow uh you can read",
    "start": "2594720",
    "end": "2601520"
  },
  {
    "text": "backwards in memory it's somewhat seemingly benign",
    "start": "2601520",
    "end": "2606800"
  },
  {
    "text": "but uh think a little bit later you'll understand more what it will do is",
    "start": "2606800",
    "end": "2613880"
  },
  {
    "text": "return the attacker uh controlled amount of memory",
    "start": "2613880",
    "end": "2619400"
  },
  {
    "text": "above or under which it could be read so depending on where you are in your memory allocation but what is also",
    "start": "2619400",
    "end": "2626119"
  },
  {
    "text": "interesting is I can create payloads using this that can read thousands of",
    "start": "2626119",
    "end": "2631319"
  },
  {
    "text": "different locations of memory at one time so if I need to scan through memory for something",
    "start": "2631319",
    "end": "2638000"
  },
  {
    "text": "uh which we talk about later makes it quite easy well other thing I will note",
    "start": "2638000",
    "end": "2644559"
  },
  {
    "text": "is this was on the redb version",
    "start": "2644559",
    "end": "2649640"
  },
  {
    "text": "V4 which is still on many many new devices though A minor change was made",
    "start": "2649640",
    "end": "2657240"
  },
  {
    "text": "on redb V5 not sure why that change is not fully propagated yet though it's",
    "start": "2657240",
    "end": "2663720"
  },
  {
    "text": "been out for I think over a year and a half or more",
    "start": "2663720",
    "end": "2669040"
  },
  {
    "text": "okay so talk a little bit about what we're going to do in over their attacks",
    "start": "2669920",
    "end": "2676040"
  },
  {
    "text": "and how to deal with exploit mitigations so couple of the interesting",
    "start": "2676040",
    "end": "2681839"
  },
  {
    "start": "2680000",
    "end": "2680000"
  },
  {
    "text": "weaknesses I found while working on this is on iOS the malic large memory regions",
    "start": "2681839",
    "end": "2690319"
  },
  {
    "text": "are very deterministic um pretty much you can",
    "start": "2690319",
    "end": "2695520"
  },
  {
    "text": "watch the allocations happen and and know where they will be and that makes",
    "start": "2695520",
    "end": "2701640"
  },
  {
    "text": "for very interesting uh times also bottom picture I don't know how well you can see it again I apologize",
    "start": "2701640",
    "end": "2709319"
  },
  {
    "text": "um an interesting thing on iOS it's compiler if it can't quite understand",
    "start": "2709319",
    "end": "2716160"
  },
  {
    "text": "how the levels of abstraction over a function the builtin uh overflow protections for",
    "start": "2716160",
    "end": "2723720"
  },
  {
    "text": "things like sturat will be negated it will insert a negative one in there and meaning",
    "start": "2723720",
    "end": "2731359"
  },
  {
    "text": "anything can be passed to it so we now have overflow protections",
    "start": "2731359",
    "end": "2736920"
  },
  {
    "text": "gone and help with aslr now on Android something hasn't",
    "start": "2736920",
    "end": "2743160"
  },
  {
    "text": "been talked about very much many of Android applications uh which are",
    "start": "2743160",
    "end": "2749680"
  },
  {
    "text": "spawned by zygote can be brute their stack hookie can be brute forced on average within",
    "start": "2749680",
    "end": "2755480"
  },
  {
    "text": "512 attempts as long as there's no zero at the end or",
    "start": "2755480",
    "end": "2761280"
  },
  {
    "text": "ending TR or trailing zero you can Brute Force this cookie in 512 tries also the",
    "start": "2761280",
    "end": "2768480"
  },
  {
    "text": "aslr on Android is pretty low entropy and could be Pro Force",
    "start": "2768480",
    "end": "2774000"
  },
  {
    "text": "too so I'm going to go into actually chaining vulnerabilities for code",
    "start": "2774599",
    "end": "2782160"
  },
  {
    "text": "execution okay so kind of going through the whole talk we'll start with",
    "start": "2782160",
    "end": "2787760"
  },
  {
    "start": "2783000",
    "end": "2783000"
  },
  {
    "text": "a stateless WAP push send a WAP to the device um it will either come in Via an",
    "start": "2787760",
    "end": "2796359"
  },
  {
    "text": "Nia or a bootstrap uh if you have to you can",
    "start": "2796359",
    "end": "2801720"
  },
  {
    "text": "bypass authentication again using the vulnerability that talked about in authentication which is a broken",
    "start": "2801720",
    "end": "2809359"
  },
  {
    "text": "authentication measure this is not something that's just like oops a mistaken code that says broken off",
    "start": "2809359",
    "end": "2815599"
  },
  {
    "text": "implementation across all clients that I've seen so it's not even just one company uh that's",
    "start": "2815599",
    "end": "2822319"
  },
  {
    "text": "carrier mandated stuff though um now after we've woken up the client it will",
    "start": "2822319",
    "end": "2828440"
  },
  {
    "text": "respond so if by a chance it's using SSL",
    "start": "2828440",
    "end": "2833680"
  },
  {
    "text": "uh just bypass it couple of ways already listed um so now we have actual access",
    "start": "2833680",
    "end": "2839200"
  },
  {
    "text": "to the client I will note that differences in environments can",
    "start": "2839200",
    "end": "2845599"
  },
  {
    "text": "drastically affect affect the stability of exploitation so we're talking you know cellular timing delays multiple",
    "start": "2845599",
    "end": "2852520"
  },
  {
    "text": "threads running memory layouts many many things can affect it or in the case of when I originally",
    "start": "2852520",
    "end": "2859880"
  },
  {
    "text": "tried to present this at black hat USA uh was going to do live demos but on top",
    "start": "2859880",
    "end": "2867079"
  },
  {
    "text": "of some other AV issues uh my BTS got somewhat dsed I asked everyone to turn",
    "start": "2867079",
    "end": "2873079"
  },
  {
    "text": "off their phones yet 70 devices were actively tronic camp on my base station",
    "start": "2873079",
    "end": "2879200"
  },
  {
    "text": "and this was completely locked down base station so you never know with cellular environments what you're going to have",
    "start": "2879200",
    "end": "2884960"
  },
  {
    "text": "to deal with it's not stable not not a fun thing to have to deal with and",
    "start": "2884960",
    "end": "2893040"
  },
  {
    "text": "stability okay so let's go into the nitty-gritty of the actual exploitation",
    "start": "2893040",
    "end": "2899200"
  },
  {
    "start": "2894000",
    "end": "2894000"
  },
  {
    "text": "process start with finding the stack so most stacks on iOS are near the m mic",
    "start": "2899200",
    "end": "2907119"
  },
  {
    "text": "large memory regions and remember what mentioned earlier malic large memory regions are",
    "start": "2907119",
    "end": "2915440"
  },
  {
    "text": "somewhat deterministic so using what we call uh OTA",
    "start": "2915440",
    "end": "2921960"
  },
  {
    "text": "fun we leverage um more or less differ size allocations as well as arbitrary reads",
    "start": "2921960",
    "end": "2929960"
  },
  {
    "text": "and memory Peaks to find out where we are uh and",
    "start": "2929960",
    "end": "2937520"
  },
  {
    "text": "if not we'll just brute force it now on Android it's a little bit different but",
    "start": "2937520",
    "end": "2945160"
  },
  {
    "text": "um overall aslr is pretty weak so don't have too much issues um and right above",
    "start": "2945160",
    "end": "2953240"
  },
  {
    "text": "the stack is a static data file that can",
    "start": "2953240",
    "end": "2958559"
  },
  {
    "text": "be used as a landing pad so if you aim for it it will then help you find where",
    "start": "2958559",
    "end": "2963799"
  },
  {
    "text": "your Target location needs to go now got to find the code section because",
    "start": "2963799",
    "end": "2970200"
  },
  {
    "text": "latest devices have fun memory protections um we found that the omadm",
    "start": "2970200",
    "end": "2977079"
  },
  {
    "text": "client has a bunch of function pointers all over the Heap these function",
    "start": "2977079",
    "end": "2982280"
  },
  {
    "text": "pointers point to part of its state machine but what that gives us is the",
    "start": "2982280",
    "end": "2987480"
  },
  {
    "text": "ability to know exactly where in memory the code",
    "start": "2987480",
    "end": "2992599"
  },
  {
    "text": "is um each allocated node of the tree actually gets its own set of function",
    "start": "2992599",
    "end": "2997880"
  },
  {
    "text": "pointers and using those function pointers we can then uh subtract the",
    "start": "2997880",
    "end": "3003920"
  },
  {
    "text": "offset to get the Base address of your code section you know that's more on iOS",
    "start": "3003920",
    "end": "3009200"
  },
  {
    "text": "but same kind of Concepts apply on Android well what about canaries so",
    "start": "3009200",
    "end": "3016040"
  },
  {
    "start": "3014000",
    "end": "3014000"
  },
  {
    "text": "talked about where we are in memory now what do we do about actual Canary",
    "start": "3016040",
    "end": "3021280"
  },
  {
    "text": "well that's an interesting one they are present on multiple locations and",
    "start": "3021280",
    "end": "3026680"
  },
  {
    "text": "certain Stacks the main thread stack unfortunately is in a high location uh",
    "start": "3026680",
    "end": "3032920"
  },
  {
    "text": "in memory can't be directly uh accessed by the lovely controlled read that was",
    "start": "3032920",
    "end": "3038160"
  },
  {
    "text": "showed you earlier um now the P threads allocates",
    "start": "3038160",
    "end": "3044119"
  },
  {
    "text": "new Stacks directly on the heat these are typ typically on Lower locations in",
    "start": "3044119",
    "end": "3049480"
  },
  {
    "text": "memory which can be read by the arbitrary read accessible stack areas are also at",
    "start": "3049480",
    "end": "3058000"
  },
  {
    "text": "semi determinable semi determinable locations so combination of the",
    "start": "3058000",
    "end": "3064640"
  },
  {
    "text": "arbitrary read deterministic memory layouts and Stat cookies gives us aslr",
    "start": "3064640",
    "end": "3074160"
  },
  {
    "text": "and stack protection bypassed that's on multiple",
    "start": "3074160",
    "end": "3081119"
  },
  {
    "text": "platforms okay well we have aslr in stack now what",
    "start": "3081760",
    "end": "3087359"
  },
  {
    "start": "3083000",
    "end": "3083000"
  },
  {
    "text": "we have to build R so R chains are very time consuming",
    "start": "3087359",
    "end": "3093839"
  },
  {
    "text": "especially on iOS uh we built a tool to automate it",
    "start": "3093839",
    "end": "3099400"
  },
  {
    "text": "for us using multiple layers of abstraction we generate large amount of",
    "start": "3099400",
    "end": "3105000"
  },
  {
    "text": "R chains with what available gadgets are possible or we have um we also pass it the aslr slide",
    "start": "3105000",
    "end": "3113680"
  },
  {
    "text": "location to code section cookies Max of the chain um and it will then create our",
    "start": "3113680",
    "end": "3120760"
  },
  {
    "text": "different payloads and also pivot if we want to um what's lovely is we can store",
    "start": "3120760",
    "end": "3128480"
  },
  {
    "text": "multiple Rob chains in the omadm client itself it has the built-in functionality",
    "start": "3128480",
    "end": "3134839"
  },
  {
    "text": "to read or to store data as base 64 then read it out as raw data into memory so",
    "start": "3134839",
    "end": "3142040"
  },
  {
    "text": "can literally push rck payloads into its config file and read them them back out",
    "start": "3142040",
    "end": "3147119"
  },
  {
    "text": "whenever I need to and once all of them are stored can",
    "start": "3147119",
    "end": "3152160"
  },
  {
    "text": "use just a single small payload that will do a stack pivot and onto any of",
    "start": "3152160",
    "end": "3158160"
  },
  {
    "text": "the ones that we have in there so you want different payloads or multiphases",
    "start": "3158160",
    "end": "3163359"
  },
  {
    "text": "it's all built into the lovely omadm client itself it's a example sorry it's",
    "start": "3163359",
    "end": "3170160"
  },
  {
    "text": "somewhat uh cut out for safety reasons but you know using different call overloads store pivot pointers pretty",
    "start": "3170160",
    "end": "3178760"
  },
  {
    "text": "much you can see the output and the input you know abstracted layers of uh",
    "start": "3178760",
    "end": "3185119"
  },
  {
    "text": "code these are the different function calls we want um hey we want to do an FOP or file rate and then it will check",
    "start": "3185119",
    "end": "3195559"
  },
  {
    "text": "it will go ahead and convert all zeros in the payload to ensure we don't run into termination string issues um make",
    "start": "3195559",
    "end": "3204599"
  },
  {
    "text": "uh basic gadgets par some great and I will say thank you again to Mark he was",
    "start": "3204599",
    "end": "3212400"
  },
  {
    "text": "super uh involved on this this was his baby and he really did an awesome",
    "start": "3212400",
    "end": "3218920"
  },
  {
    "text": "job so let's talk about where code execution",
    "start": "3218920",
    "end": "3224400"
  },
  {
    "start": "3220000",
    "end": "3220000"
  },
  {
    "text": "was obtained this is the list of devices that we currently",
    "start": "3224400",
    "end": "3231880"
  },
  {
    "text": "have code execution on iOS Android BlackBerry",
    "start": "3231880",
    "end": "3237000"
  },
  {
    "text": "multiple cellular hotspots laptops with W MTM and iot",
    "start": "3237000",
    "end": "3243119"
  },
  {
    "text": "basebands this is Live code execution but it's part of our responsible",
    "start": "3243119",
    "end": "3248559"
  },
  {
    "text": "disclosure process uh and in order to protect the public we have to withhold",
    "start": "3248559",
    "end": "3254720"
  },
  {
    "text": "detailed vulnerability information on many phones and other devices",
    "start": "3254720",
    "end": "3259799"
  },
  {
    "text": "unfortunately many patches or many devices have not been patched yet carrier life cycles are very long",
    "start": "3259799",
    "end": "3267960"
  },
  {
    "text": "so as far as I know not one yet okay unfortunately this is kind of",
    "start": "3267960",
    "end": "3274559"
  },
  {
    "text": "hard to see and I apologize uh but we'll see how well it'll",
    "start": "3274559",
    "end": "3281000"
  },
  {
    "text": "go so what I am doing here is I am sending a WAP Nia to an iOS device you",
    "start": "3281000",
    "end": "3288520"
  },
  {
    "text": "can kind of see it there at the bottom um the first section of what's",
    "start": "3288520",
    "end": "3293680"
  },
  {
    "text": "actually going on here sorry I paused it is uh leaking the aslr slide so initial",
    "start": "3293680",
    "end": "3301319"
  },
  {
    "text": "WAP to n WAP ni wake up the client client talks to the server now leak the",
    "start": "3301319",
    "end": "3308119"
  },
  {
    "text": "slide Let It Go and boom what's there is the function",
    "start": "3308119",
    "end": "3316799"
  },
  {
    "text": "pointers talked about earlier so those now gave us locations to the code section under that is the actual aslr",
    "start": "3316799",
    "end": "3325160"
  },
  {
    "text": "offset after this go ahead and crash the actual agent want a clean slate for",
    "start": "3325160",
    "end": "3331760"
  },
  {
    "text": "memory ah crap sorry uh the wrong",
    "start": "3331760",
    "end": "3337599"
  },
  {
    "text": "button so from there restart the agent it's going to take a while so I'm going to speed it",
    "start": "3337599",
    "end": "3343680"
  },
  {
    "text": "up um what's the issue with testing on GPRS very very",
    "start": "3343680",
    "end": "3348760"
  },
  {
    "text": "slow okay so the rest of this um incoming",
    "start": "3348760",
    "end": "3355640"
  },
  {
    "text": "request from there since we already have aslr start searching for the stack cookie",
    "start": "3355640",
    "end": "3361559"
  },
  {
    "text": "using the same arbitrary read as earlier just have to know where they are and we",
    "start": "3361559",
    "end": "3368240"
  },
  {
    "text": "were able to on iOS 71 use a static offset was actually very helpful after",
    "start": "3368240",
    "end": "3374640"
  },
  {
    "text": "that make sure it's actually a cookie not random data um so check the entropy",
    "start": "3374640",
    "end": "3381680"
  },
  {
    "text": "um from there go ahead and create and push the different payloads",
    "start": "3381680",
    "end": "3386799"
  },
  {
    "text": "that we talked about earlier using R generation uh push",
    "start": "3386799",
    "end": "3392960"
  },
  {
    "text": "dib and let it go it's sitting running in",
    "start": "3394960",
    "end": "3400319"
  },
  {
    "text": "the background uh pretty much all of the overflows are happening",
    "start": "3400319",
    "end": "3407000"
  },
  {
    "text": "now takes a little bit uh more or less we have overflow it",
    "start": "3407000",
    "end": "3413240"
  },
  {
    "text": "is then using um the dial of pushed",
    "start": "3413240",
    "end": "3419640"
  },
  {
    "text": "to inject into certain functionality on the device hit right",
    "start": "3419640",
    "end": "3427200"
  },
  {
    "text": "protection and privilege escalate and boom now have",
    "start": "3427200",
    "end": "3433200"
  },
  {
    "text": "root on an un previously un jailbroken",
    "start": "3433200",
    "end": "3438240"
  },
  {
    "text": "iOS device reason I focus on iOS it's the hardest one same technique can be used",
    "start": "3438240",
    "end": "3445720"
  },
  {
    "text": "on every other platform um so yeah we now have a",
    "start": "3445720",
    "end": "3452160"
  },
  {
    "text": "jailbroken iOS device that this same stuff will also work on iOS 8 if someone",
    "start": "3452160",
    "end": "3457960"
  },
  {
    "text": "feels like playing with it uh though I will not be releasing any of the code um so yeah just in case you can see",
    "start": "3457960",
    "end": "3467000"
  },
  {
    "text": "on the bottom restarted springboard and there you go that was all done via",
    "start": "3467000",
    "end": "3474520"
  },
  {
    "text": "GPRS okay so that's pretty much it for my talk uh again this code base is on",
    "start": "3474520",
    "end": "3482640"
  },
  {
    "text": "pretty much all devices at Ron omm vulnerabilities",
    "start": "3482640",
    "end": "3487839"
  },
  {
    "text": "found are crossplatform so I find a buffer overflow on one it",
    "start": "3487839",
    "end": "3494680"
  },
  {
    "text": "affects the other that means that list of vulnerabilities is affecting currently",
    "start": "3494680",
    "end": "3501640"
  },
  {
    "text": "about up to 1.8 or so billion devices and and the code bases are prettyy much",
    "start": "3501640",
    "end": "3508039"
  },
  {
    "text": "the same so Blackberry iOS Android whatever someone looks at this finds bugs they'll get into it too but I guess",
    "start": "3508039",
    "end": "3516240"
  },
  {
    "text": "in the end really why is this there in the first place why do carriers have the",
    "start": "3516240",
    "end": "3521319"
  },
  {
    "text": "ability to install applications on your device who here knew this was already",
    "start": "3521319",
    "end": "3527359"
  },
  {
    "text": "there prior to this talk one",
    "start": "3527359",
    "end": "3533119"
  },
  {
    "text": "person two so two people out of the whole room at black hat knew that",
    "start": "3533119",
    "end": "3538920"
  },
  {
    "text": "built-in functionality to manage and install applications is other function other sensitive information was on our",
    "start": "3538920",
    "end": "3547119"
  },
  {
    "text": "personal devices well I don't know about y'all I",
    "start": "3547119",
    "end": "3552160"
  },
  {
    "text": "don't necessarily like the thought of that I want to know what's happening on my device but that's not for me",
    "start": "3552160",
    "end": "3560240"
  },
  {
    "text": "to uh go into and yeah I just want to say thanks again to pretty much all of",
    "start": "3560240",
    "end": "3567520"
  },
  {
    "text": "acuant labs we've got amazing team over there Ryan Alex Pete just a whole bunch",
    "start": "3567520",
    "end": "3572960"
  },
  {
    "text": "of people the prior researchers um you know MC Labs did a really good work on",
    "start": "3572960",
    "end": "3579160"
  },
  {
    "text": "2011 or 2009 which is actually the first time that the authentication issues were",
    "start": "3579160",
    "end": "3585200"
  },
  {
    "text": "brought up in the omacp clients so I guess we're in what 2014 five years or",
    "start": "3585200",
    "end": "3592119"
  },
  {
    "text": "so now those clients have been publicly known or that was uh authentication",
    "start": "3592119",
    "end": "3597160"
  },
  {
    "text": "issues have been publicly known and not had anything done about uh Nico Goldie and colum Muller",
    "start": "3597160",
    "end": "3605240"
  },
  {
    "text": "Harold Walt uh all the open BC Dino doovi Charlie Miller all of",
    "start": "3605240",
    "end": "3613359"
  },
  {
    "text": "azamas stuff they just completely published gold um",
    "start": "3613359",
    "end": "3619039"
  },
  {
    "text": "Lis Maris J case Kos uh who else Ralph Philip weinman and I do want to note a couple",
    "start": "3619039",
    "end": "3628200"
  },
  {
    "text": "uh the carriers and vendors that during disclosure which was really really painful went the extra Mount",
    "start": "3628200",
    "end": "3635720"
  },
  {
    "text": "qualcom great team over there they always on top of the ball",
    "start": "3635720",
    "end": "3641359"
  },
  {
    "text": "I'm they need to be teaching classes on how to run a disclosure program because they are the best I've seen for this",
    "start": "3641359",
    "end": "3649440"
  },
  {
    "text": "process um uh Apple AT&T black Berry Samsung",
    "start": "3649440",
    "end": "3657480"
  },
  {
    "text": "ryzen those are again other ones that we really appreciate oh yeah one more",
    "start": "3657480",
    "end": "3665839"
  },
  {
    "text": "thing wasn't the only one found there are other control protocols out",
    "start": "3665839",
    "end": "3671440"
  },
  {
    "text": "there and that's it [Applause]",
    "start": "3671440",
    "end": "3685070"
  }
]