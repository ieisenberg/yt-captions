[
  {
    "text": "hello how are you I hope that you're doing very well today we're here to speak about laspas H password managers",
    "start": "240",
    "end": "8120"
  },
  {
    "text": "and just take a look how they work and how can we take advance of",
    "start": "8120",
    "end": "13360"
  },
  {
    "text": "them yep here it is so like in every talk we're going to present ourselves at",
    "start": "16080",
    "end": "21920"
  },
  {
    "text": "the very beginning here Martin Vigo is here with me go thank you I'm a product security",
    "start": "21920",
    "end": "30320"
  },
  {
    "text": "at Salesforce and um this is a picture of me anyone can guess which computer this is 25 years ago that's the hint I'm",
    "start": "30320",
    "end": "37440"
  },
  {
    "text": "going to give you an amstrad CPC 6,28 really cool video games you're too",
    "start": "37440",
    "end": "44840"
  },
  {
    "text": "old yes okay and uh that's me I don't have any",
    "start": "44840",
    "end": "50440"
  },
  {
    "text": "computer there but uh I'm Alberto I work at Salesforce 2 uh we do like all day",
    "start": "50440",
    "end": "57239"
  },
  {
    "text": "research we just started a team kind of project zero but um so yeah definitely we do very",
    "start": "57239",
    "end": "63039"
  },
  {
    "text": "cool things at Salesforce if anyone wants to to join us wants more information we're always hiring so just",
    "start": "63039",
    "end": "68920"
  },
  {
    "text": "come to me and speak with me and we can Ser a Ramen Coke and some information",
    "start": "68920",
    "end": "74000"
  },
  {
    "text": "and uh yeah this is like laspas it's going to be our Target today ER we want",
    "start": "74000",
    "end": "80280"
  },
  {
    "text": "to tell you a little bit why we started like taking a look at laspas I used to work in the red team at at Salesforce",
    "start": "80280",
    "end": "87479"
  },
  {
    "text": "and we were seen in a lot of chance that we compromised that there was like",
    "start": "87479",
    "end": "93280"
  },
  {
    "text": "information there was a lastas like file lastas um yeah both basically last those",
    "start": "93280",
    "end": "98799"
  },
  {
    "text": "files in the systems and we really wanted to get all the information from this the password manager like you we",
    "start": "98799",
    "end": "105159"
  },
  {
    "text": "have to take a notice that um normally when you're doing a a red team exercise",
    "start": "105159",
    "end": "110439"
  },
  {
    "text": "you don't have a lot of time when you are in a compromise machine you just have some minutes you have some a",
    "start": "110439",
    "end": "115920"
  },
  {
    "text": "specific time and every time you spend in a compromis machine is one more time one more minute one more time that",
    "start": "115920",
    "end": "122640"
  },
  {
    "text": "actually detection have to to catch you so it's very important that we we get into amachin we would we need to be fast",
    "start": "122640",
    "end": "130080"
  },
  {
    "text": "as fast as possible to recollect all the information recollect credentials and move on so that's something that we had",
    "start": "130080",
    "end": "136319"
  },
  {
    "text": "in mind and actually I came to to Martin because we have like 10% of our time to do research that sales from we say hey",
    "start": "136319",
    "end": "142400"
  },
  {
    "text": "Martin let's take a look at this because I think it's super interesting from a post exploitation View and so we got a",
    "start": "142400",
    "end": "149560"
  },
  {
    "text": "couple of genant tonics and we started looking at it and this is what we saw",
    "start": "149560",
    "end": "155239"
  },
  {
    "text": "like glp is one of the most popular password managers we can see out there",
    "start": "155239",
    "end": "161280"
  },
  {
    "text": "they have what they call the enterprise Edition so that's very interesting from an attacker perspective because you know",
    "start": "161280",
    "end": "168080"
  },
  {
    "text": "that they're going to it's going to be used in large corporations great Target and the",
    "start": "168080",
    "end": "173680"
  },
  {
    "text": "interesting thing here is that laspas not only stores passwords they stores",
    "start": "173680",
    "end": "179159"
  },
  {
    "text": "SSH ke keys they store credit cards Social Security numbers private notes",
    "start": "179159",
    "end": "185080"
  },
  {
    "text": "I've seen pgp keys in last pass that's great so that's how everything",
    "start": "185080",
    "end": "192720"
  },
  {
    "text": "started so here we have the agenda what we're going to trat we're going what we are going to speak about and the",
    "start": "192720",
    "end": "199200"
  },
  {
    "text": "different like approaches that we're going to get one of them the first one is going to be the pl the plug-in side",
    "start": "199200",
    "end": "205280"
  },
  {
    "text": "the client side the second one we're going to speak about is about",
    "start": "205280",
    "end": "210439"
  },
  {
    "text": "what laspas has what's the information that they collect do they have access to our",
    "start": "210439",
    "end": "216000"
  },
  {
    "text": "passwords and at the end at the end of the talk we will change our our point of",
    "start": "216000",
    "end": "222400"
  },
  {
    "text": "view to like an outsider not being laspas not being in the client just being like someone who is out of those",
    "start": "222400",
    "end": "229159"
  },
  {
    "text": "two different environments so let's start like speaking about what laspas claims what",
    "start": "229159",
    "end": "235920"
  },
  {
    "text": "do they say that they do they have or they they are they have like among other claims they",
    "start": "235920",
    "end": "243519"
  },
  {
    "text": "have five that we think that are very important uh the first one is that they use local and secure",
    "start": "243519",
    "end": "250599"
  },
  {
    "text": "encryption second one is that they securely encrypt the keys that are used",
    "start": "250599",
    "end": "256359"
  },
  {
    "text": "to encrypt and decrypt your Vault where your passwords are third one is that they use Secure Storage in the client",
    "start": "256359",
    "end": "263479"
  },
  {
    "text": "side okay the fourth very important thing is that the creds are wiped from",
    "start": "263479",
    "end": "269720"
  },
  {
    "text": "from memory so those memory based attacks are not going to be useful in",
    "start": "269720",
    "end": "275160"
  },
  {
    "text": "this case and last but not least laspas has no access to your data this is very",
    "start": "275160",
    "end": "281639"
  },
  {
    "text": "important I don't know I don't know if you trust third party applications I'm not very I'm not a trusty guy so I'm not",
    "start": "281639",
    "end": "290080"
  },
  {
    "text": "going to give my passwords to anybody that's going to be they're going to remind in my computer or if I send my",
    "start": "290080",
    "end": "295800"
  },
  {
    "text": "password to somebody else I will send it encrypted and I will never give them the key key to thecate that Vault to the",
    "start": "295800",
    "end": "301639"
  },
  {
    "text": "create the passwords so we will speak about that so to prove all those claims Alaska",
    "start": "301639",
    "end": "310199"
  },
  {
    "text": "have we started with um a script we wrote a script that basically by the way",
    "start": "310199",
    "end": "316800"
  },
  {
    "text": "we are from Spain that's why our accent is so weird broken English mine is",
    "start": "316800",
    "end": "322800"
  },
  {
    "text": "pretty good come on man you know I'm going to tell you something this is not prepared but like he has a a girlfriend",
    "start": "322800",
    "end": "329440"
  },
  {
    "text": "and he's yeah you do you're in Amsterdam but you still have a girlfriend so uh C",
    "start": "329440",
    "end": "334880"
  },
  {
    "text": "always says Martin if you lose your accent your Spanish accent I will definitely leave you that's that's",
    "start": "334880",
    "end": "341240"
  },
  {
    "text": "completely true and she always say like every night like every Saturday or Sunday we go out for some drinks she say",
    "start": "341240",
    "end": "348240"
  },
  {
    "text": "the same anyway let's move back um so yeah like um to verify what uh those",
    "start": "348240",
    "end": "355160"
  },
  {
    "text": "claims that last said we grow this this script that basically just in Che like one line after every function in the",
    "start": "355160",
    "end": "362759"
  },
  {
    "text": "code in the JavaScript code let's it's a minimized JavaScript code what they used",
    "start": "362759",
    "end": "368199"
  },
  {
    "text": "and it was H it g gave us uh the chronological order from like every",
    "start": "368199",
    "end": "373240"
  },
  {
    "text": "function that was called and not only that but the parameters that were like passed to every function that was called",
    "start": "373240",
    "end": "379440"
  },
  {
    "text": "so basically we just like you uh run this script inject those like um those",
    "start": "379440",
    "end": "385240"
  },
  {
    "text": "uh lines to give us the instrumentation and we were able to see like okay when",
    "start": "385240",
    "end": "390400"
  },
  {
    "text": "we log in this is are the functions that that are been called so that like help us to understand all those claims so as",
    "start": "390400",
    "end": "396919"
  },
  {
    "text": "I said the first claim is that they use local and secure encryption and they indeed do that they use as 256 to",
    "start": "396919",
    "end": "403840"
  },
  {
    "text": "encrypt your credentials the thing is that they use CBC and ECB mode as you",
    "start": "403840",
    "end": "409639"
  },
  {
    "text": "may know ECB is not the best the best thing the best practice they use kind of a custom implementation but it's it's",
    "start": "409639",
    "end": "416800"
  },
  {
    "text": "okay and then to encrypt your your key DEC create to DEC create your Vault where all your passwords are they use",
    "start": "416800",
    "end": "423240"
  },
  {
    "text": "pbk df2 they were using 500 rounds now they're using 5,000 rounds by default",
    "start": "423240",
    "end": "429479"
  },
  {
    "text": "you can modify that value but it's actually not very important that you modify it because you can do an au an an",
    "start": "429479",
    "end": "435080"
  },
  {
    "text": "out an authorized query to laspas just sending your username and they will tell",
    "start": "435080",
    "end": "440280"
  },
  {
    "text": "you okay this user has this many rounds okay it's just like something",
    "start": "440280",
    "end": "445759"
  },
  {
    "text": "interesting to say they use secure encryption keys they they use uh yeah",
    "start": "445759",
    "end": "450919"
  },
  {
    "text": "they secure encryption the cas so they use pbkdf2 with the number of iterations",
    "start": "450919",
    "end": "456360"
  },
  {
    "text": "and they use the username as a salt okay they're restricted to 32 bytes the",
    "start": "456360",
    "end": "463440"
  },
  {
    "text": "output they use Secure Storage I mean depending as you see it they secure",
    "start": "463440",
    "end": "470039"
  },
  {
    "text": "supposedly storage the credentials in the client side it depends if you're using the the plug-in version or the",
    "start": "470039",
    "end": "476520"
  },
  {
    "text": "binary version if you're using the plug-in version they uh use sqlite files",
    "start": "476520",
    "end": "482360"
  },
  {
    "text": "or uh that are unencrypted and that are not root needed they use or sqi",
    "start": "482360",
    "end": "488440"
  },
  {
    "text": "databases or files just files depending on the browser Firefox for example they",
    "start": "488440",
    "end": "493599"
  },
  {
    "text": "use files all the time and there's Banner version that they use as like platform and specific secur Storage",
    "start": "493599",
    "end": "500319"
  },
  {
    "text": "storage if you use Mac it's kind of interesting because they use the the keychain to store this information so",
    "start": "500319",
    "end": "506960"
  },
  {
    "text": "that's that's more interesting in the windows version they just use the the the secure API and protect and CRI",
    "start": "506960",
    "end": "514159"
  },
  {
    "text": "protect and and protect API so it's not very useful the other claim that we saw is",
    "start": "514159",
    "end": "520959"
  },
  {
    "text": "that they they wiped H the credentials from memory so as soon as you introduce",
    "start": "520959",
    "end": "526200"
  },
  {
    "text": "your master password okay the master password is the one who is used to login against laspas after doing some some",
    "start": "526200",
    "end": "534320"
  },
  {
    "text": "applying some algorithms but they this is basically the code that they using they we are setting the the variable D",
    "start": "534320",
    "end": "541920"
  },
  {
    "text": "and C password to a bunch of X they doing that in JavaScript so supposedly",
    "start": "541920",
    "end": "548519"
  },
  {
    "text": "the variables with your password will be like overwritten it will see will will be great the thing is that we saw that",
    "start": "548519",
    "end": "554920"
  },
  {
    "text": "the Vault decryption key resides always in memory and you will say okay that's",
    "start": "554920",
    "end": "560839"
  },
  {
    "text": "normal you need to decrypt every time that you're going to like use a specific password for a specific site you need to",
    "start": "560839",
    "end": "567040"
  },
  {
    "text": "decrypt it obviously Alberto the decryption needs to be in memory it needs to be used but here the thing is",
    "start": "567040",
    "end": "573880"
  },
  {
    "text": "that they cryp the whole Vault with all your password at the beginning so in memory we don't only",
    "start": "573880",
    "end": "580680"
  },
  {
    "text": "have the decryption key for the vault where all the password are encrypted but we have the password in clear text that",
    "start": "580680",
    "end": "587760"
  },
  {
    "text": "makes no sense you can pick up one out of two but not like both both things if",
    "start": "587760",
    "end": "593360"
  },
  {
    "text": "you don't want to decrypt your passwords at the beginning and have it in memory perfect you need to have the decryption",
    "start": "593360",
    "end": "598760"
  },
  {
    "text": "key in memory memory but if you decrypt everything at the beginning why do you need the decryption kit",
    "start": "598760",
    "end": "604360"
  },
  {
    "text": "anymore okay and the last one the last claim is",
    "start": "604360",
    "end": "611839"
  },
  {
    "text": "that laspas has no access to your data and that's actually true they don't have access to your unencrypted Vault okay",
    "start": "611839",
    "end": "620399"
  },
  {
    "text": "here what we do is that we encrypt in in the client side we encrypt the Vault",
    "start": "620399",
    "end": "625680"
  },
  {
    "text": "okay and then we send to laspas the encryption key but only with one more round of the pbk",
    "start": "625680",
    "end": "633600"
  },
  {
    "text": "df2 only one more round so we can apply 5,000 rounds but that will be like in",
    "start": "633600",
    "end": "638920"
  },
  {
    "text": "the client side but we when we send the key to LastPass we are only sending one",
    "start": "638920",
    "end": "644519"
  },
  {
    "text": "more round so what enters to the laspas server is only one round of pbkdf2",
    "start": "644519",
    "end": "651320"
  },
  {
    "text": "supposedly I mean they they apply another extra uh 100,000 rounds but what",
    "start": "651320",
    "end": "658040"
  },
  {
    "text": "it gets to their server it's just one more round of pbkdf2",
    "start": "658040",
    "end": "663360"
  },
  {
    "text": "so let's start with the attacks now we more or less understand how laspas work we know what they claim let's try to",
    "start": "664200",
    "end": "671680"
  },
  {
    "text": "figure it out how to jump above it so the first one the first scenario",
    "start": "671680",
    "end": "678000"
  },
  {
    "text": "first environment is attacking the client side let's go for it so uh as you as you know they have",
    "start": "678000",
    "end": "685079"
  },
  {
    "text": "there is like a master password the master password is the one who is derived to then encrypt the Vault with all your credentials so let's attack",
    "start": "685079",
    "end": "693079"
  },
  {
    "text": "when the user checks the remember password let's understand how it works how it's like how your master password",
    "start": "693079",
    "end": "699800"
  },
  {
    "text": "is encrypted in disk and let's let's take advantage of that so the creds are",
    "start": "699800",
    "end": "705399"
  },
  {
    "text": "sto stored locally if you remember your master password need to be stored locally you are not going to send that to lastas of course so depending on the",
    "start": "705399",
    "end": "712760"
  },
  {
    "text": "browsers as I said before it it h the the the credit the master key gets",
    "start": "712760",
    "end": "718320"
  },
  {
    "text": "password gets St or in files in in Firefox in prep. Gs or in the rest of",
    "start": "718320",
    "end": "724519"
  },
  {
    "text": "the the browsers they use like an sqi database and they use ECB or CBC",
    "start": "724519",
    "end": "729839"
  },
  {
    "text": "depending on the version of lastas you're using here we just can see like a like",
    "start": "729839",
    "end": "735199"
  },
  {
    "text": "table with different like uh browsers and ossos and where those files are",
    "start": "735199",
    "end": "740800"
  },
  {
    "text": "store are like present here we can see the Esq database",
    "start": "740800",
    "end": "746800"
  },
  {
    "text": "uh and they they save as you can see there's like username and password the password is encrypted and the username",
    "start": "746800",
    "end": "753680"
  },
  {
    "text": "is clear text and of course you can access to this database without being brw the table exactly table what it is",
    "start": "753680",
    "end": "760600"
  },
  {
    "text": "it's called aspas save logins 2 and in in Firefox I said it's store in",
    "start": "760600",
    "end": "767199"
  },
  {
    "text": "pref prep. Gs with extension. lasas login users and extensions. lasp pass.",
    "start": "767199",
    "end": "774079"
  },
  {
    "text": "login passwords so how it is encrypted we want",
    "start": "774079",
    "end": "779360"
  },
  {
    "text": "to get the master password how it is encrypted basically they using AES",
    "start": "779360",
    "end": "786160"
  },
  {
    "text": "256 they use a random IV that's correct and the key is a sa 256 of your",
    "start": "786160",
    "end": "793880"
  },
  {
    "text": "username of course your username it's in clear text as you could see before so",
    "start": "793880",
    "end": "798920"
  },
  {
    "text": "basically and and the data that we saw that's what we need to the Crypt basically they're storing the key and",
    "start": "798920",
    "end": "805360"
  },
  {
    "text": "they're storing the the encrypted blob just together it's pretty straightforward",
    "start": "805360",
    "end": "812399"
  },
  {
    "text": "just decrypting it and we will get the master password and that's that's it we get the master password we can use it to",
    "start": "812399",
    "end": "818880"
  },
  {
    "text": "access the Vault and access of course all the keys stored in the",
    "start": "818880",
    "end": "823800"
  },
  {
    "text": "vault oh yeah so we we published it Martin did",
    "start": "824639",
    "end": "830720"
  },
  {
    "text": "that's the the the stats of his blog now one visits me now one visit him look at",
    "start": "830720",
    "end": "835880"
  },
  {
    "text": "him nothing absolutely nothing and then we published he published this yeah he",
    "start": "835880",
    "end": "843199"
  },
  {
    "text": "published it and like he got like a lot of visits so that's when we we were supposed to to stop this research it was",
    "start": "843199",
    "end": "849560"
  },
  {
    "text": "a small research only for this specific pentest okay we got it we loot everything we want game over but then we",
    "start": "849560",
    "end": "856600"
  },
  {
    "text": "published it and we saw that people was interested in laspas then is when I'm going to send change this the mic to",
    "start": "856600",
    "end": "864560"
  },
  {
    "text": "Martin we're going to be doing this switching back and forth sorry about the guys all right yeah this was interesting",
    "start": "864560",
    "end": "871959"
  },
  {
    "text": "because we just did that for the pentest right with the 10% of the research we have at Salesforce and uh it was it was",
    "start": "871959",
    "end": "878600"
  },
  {
    "text": "really cool because uh suddenly on netc it was the number one and all that so a",
    "start": "878600",
    "end": "883800"
  },
  {
    "text": "lot of feedback a lot of of a good feedback bad feedback but basically what we got from it is that the community was",
    "start": "883800",
    "end": "890440"
  },
  {
    "text": "very interested in in understanding last pass and uh what else you could do with it so we said okay maybe it's worth just",
    "start": "890440",
    "end": "896600"
  },
  {
    "text": "investing more time on it h look if we there is more threats to it and uh and share it with the",
    "start": "896600",
    "end": "902320"
  },
  {
    "text": "community so uh the first thing obviously I know what you guys are thinking who's going to click remember",
    "start": "902320",
    "end": "907920"
  },
  {
    "text": "password and I asked last pass and a lot of people does because the first thing was just don't just don't offer that",
    "start": "907920",
    "end": "913519"
  },
  {
    "text": "option right and uh yeah actually a lot of people does so um what was a oh yeah",
    "start": "913519",
    "end": "920920"
  },
  {
    "text": "I have it here so the first thing we we did was like okay let's do the classic right let's see what we get with the cookies but it's interesting because in",
    "start": "920920",
    "end": "927440"
  },
  {
    "text": "last P what the cookies are going to get you is basically what laspas has and what laspas has is supposedly not to be",
    "start": "927440",
    "end": "933160"
  },
  {
    "text": "anything that you can use to the cryp The Vault so that was an interesting thing so we actually had to invest a little bit more time to see if we could",
    "start": "933160",
    "end": "939720"
  },
  {
    "text": "do something with the cookies and what it turns out is that the Vault decryption key The Vault decryption key",
    "start": "939720",
    "end": "946120"
  },
  {
    "text": "is the key that is derived from your master password and is used to decrypt The Vault it's going to get a little bit weird but uh yeah so the Vault",
    "start": "946120",
    "end": "952480"
  },
  {
    "text": "decryption key stor in your machine locally and lasp pass has the decryption key so when you send over the cookies",
    "start": "952480",
    "end": "960000"
  },
  {
    "text": "they send you the decryption key you derive well they send you a a a token",
    "start": "960000",
    "end": "965880"
  },
  {
    "text": "let's call it you derive a encryption key doing a shot to 56 and you decrypt your Vault locally and this is why when",
    "start": "965880",
    "end": "972160"
  },
  {
    "text": "you restart your machine and open the browser it automatically locks in again you never enter your credentials if lpas",
    "start": "972160",
    "end": "978600"
  },
  {
    "text": "does don't have them they can they can derive the key but this is how it actually works so and just to get a bigger",
    "start": "978600",
    "end": "985959"
  },
  {
    "text": "overview what I mentioned before you do basically a post request to to login check and uh you will pass your your",
    "start": "985959",
    "end": "992279"
  },
  {
    "text": "your session cookie and it returns this parameter that is the PW deck key and",
    "start": "992279",
    "end": "998199"
  },
  {
    "text": "you do a shat to 56 to it and that will be your decryption key and as we saw before it was in the database encrypted",
    "start": "998199",
    "end": "1004279"
  },
  {
    "text": "key you decrypt it and you got it cool awesome so that cookie got us that",
    "start": "1004279",
    "end": "1010360"
  },
  {
    "text": "so that was that was pretty cool but we still had more challenges right because",
    "start": "1010360",
    "end": "1015519"
  },
  {
    "text": "H what we find is that if you have to factor Authentication H it's not going to work uh so we had to",
    "start": "1015519",
    "end": "1021759"
  },
  {
    "text": "deal with that too so the next step was to understand how two Factor authentication works and this is how it",
    "start": "1021759",
    "end": "1027360"
  },
  {
    "text": "looks like H we never ask how many laspas users are here can you guys raise your hand just to get an idea that will",
    "start": "1027360",
    "end": "1033798"
  },
  {
    "text": "be about five I don't believe that but okay good enough and uh so they support a lot of two Factor authentication",
    "start": "1033799",
    "end": "1040160"
  },
  {
    "text": "methods Google ass UB key TW lot of lots of them so the first thing we did is we",
    "start": "1040160",
    "end": "1045678"
  },
  {
    "text": "looked at the network traffic and uh we didn't any trusted cookie which was pretty interesting so we started to",
    "start": "1045679",
    "end": "1051840"
  },
  {
    "text": "tamper with the parameters and we realize that H the one that we had to remove in order to be prompted for two",
    "start": "1051840",
    "end": "1058400"
  },
  {
    "text": "Factor was uuid so U uid is actually the trusted token so how is the generator we wanted",
    "start": "1058400",
    "end": "1065720"
  },
  {
    "text": "to understand first if maybe we could generate it and they actually some smart they basically reuse the function they",
    "start": "1065720",
    "end": "1071400"
  },
  {
    "text": "have to Generate random passwords the ones that okay generate a random password for me for this website put it",
    "start": "1071400",
    "end": "1077000"
  },
  {
    "text": "on the Vault so they just reuse that so basically The Trusted token is a 32",
    "start": "1077000",
    "end": "1082559"
  },
  {
    "text": "characters it's basically a password and uh it's it's a generated at installation",
    "start": "1082559",
    "end": "1088159"
  },
  {
    "text": "time installation time from the plug-in and uh so where is it stored it's stored in PL Tex for Firefox again",
    "start": "1088159",
    "end": "1095240"
  },
  {
    "text": "it's a edge case it's storing lp. Sid and for the rest of the browsers it's again in a local uh in sorry in this",
    "start": "1095240",
    "end": "1102840"
  },
  {
    "text": "case it's in local storage now the thing is um why are we telling you all this in reality there is some problem with this",
    "start": "1102840",
    "end": "1109320"
  },
  {
    "text": "design right local storage there's no browser that encrypts it and lp. suad is",
    "start": "1109320",
    "end": "1114960"
  },
  {
    "text": "not encrypted either um the same token is used for all the browser users so if",
    "start": "1114960",
    "end": "1120840"
  },
  {
    "text": "you have your corporate account and you have your personal account in last plus something we do um you will have the",
    "start": "1120840",
    "end": "1127880"
  },
  {
    "text": "same trusted token that means that there is a a fixed token till the plug-in is reinstalled and that's had a lot of",
    "start": "1127880",
    "end": "1134720"
  },
  {
    "text": "consequences because even if you unrust that browser say because whatever H you",
    "start": "1134720",
    "end": "1140159"
  },
  {
    "text": "thought it was compromised or whatever H has no real effect because it's still going to be that token that is going to",
    "start": "1140159",
    "end": "1145760"
  },
  {
    "text": "be sent once you you actually activate it again in fact if you generate a new",
    "start": "1145760",
    "end": "1151280"
  },
  {
    "text": "QR code because your tofa was compromised it's still going to be the same that that says actually that is",
    "start": "1151280",
    "end": "1157919"
  },
  {
    "text": "token fixation an attacker could set it for you before you activate it and when they when you when the victim activates",
    "start": "1157919",
    "end": "1163480"
  },
  {
    "text": "it it's going to send the one set by the attacker but that's not really interesting the interesting thing is we can proactive is still the trusted token",
    "start": "1163480",
    "end": "1170720"
  },
  {
    "text": "imagine we compromise a machine we get that token the victim realizes it and",
    "start": "1170720",
    "end": "1175799"
  },
  {
    "text": "says okay you should you should have activated TFA okay I'm going to do that now doesn't matter we already have the",
    "start": "1175799",
    "end": "1180840"
  },
  {
    "text": "token this is the problem of not using trusted cookies and do this this kind of design that they came up with cool so",
    "start": "1180840",
    "end": "1189240"
  },
  {
    "text": "awesome so we got now we know how to get credentials we know how to use the cookies to to the Vault we know how to",
    "start": "1189240",
    "end": "1195159"
  },
  {
    "text": "do a two Factor Authentication but ER we still have the problem that H",
    "start": "1195159",
    "end": "1202200"
  },
  {
    "text": "you can only use the cookies if there is an active session if the user logs out that's that cook is not valid anymore so",
    "start": "1202200",
    "end": "1208840"
  },
  {
    "text": "you can't retrieve the the key to the decryption key to decrypt the vault key",
    "start": "1208840",
    "end": "1214520"
  },
  {
    "text": "that is encrypted in your machine so we wanted basically to find the silver",
    "start": "1214520",
    "end": "1220039"
  },
  {
    "text": "bullet something that will that will allow us to in the client site to be able to decrypt the Vault to get the",
    "start": "1220039",
    "end": "1226200"
  },
  {
    "text": "encryption key at decrypt the Vault no matter if you don't have a active session no matter if you don't have tofa",
    "start": "1226200",
    "end": "1232919"
  },
  {
    "text": "no matter if the the user didn't Still Still The stort the credentials awesome",
    "start": "1232919",
    "end": "1238400"
  },
  {
    "text": "so we we we we saw that right account recovery and the first thing was H how is that even possible because if lpass",
    "start": "1238400",
    "end": "1245120"
  },
  {
    "text": "doesn't have my encryption key I forgot my password I don't have my encryption key how how are you going to recover the",
    "start": "1245120",
    "end": "1251919"
  },
  {
    "text": "Vault so and it's actually as easy as one two three first thing you do you go",
    "start": "1251919",
    "end": "1257000"
  },
  {
    "text": "to lastpass.com recovery and you enter your email and when you do that you will",
    "start": "1257000",
    "end": "1262360"
  },
  {
    "text": "get a unique link that's pretty straightforward basically how everyone does it you click on that link and it",
    "start": "1262360",
    "end": "1267960"
  },
  {
    "text": "redirects you to this really nice page with a big red button that says press to recover we were like okay can't be that",
    "start": "1267960",
    "end": "1274039"
  },
  {
    "text": "easy so we clicked on it and it was that easy suddenly the account was recovered we have full and restricted access to",
    "start": "1274039",
    "end": "1279880"
  },
  {
    "text": "the Vault to our vault and uh we could set a new password but we didn't have to",
    "start": "1279880",
    "end": "1285520"
  },
  {
    "text": "which we thought is funny because why would you recover your account it's because you forgot your password so you",
    "start": "1285520",
    "end": "1290600"
  },
  {
    "text": "should set a new password but yeah that was interesting and we were never ProMed for tofa so we really wanted to",
    "start": "1290600",
    "end": "1296919"
  },
  {
    "text": "understand how this works because I never enter my master password I never do anything like that and I still could",
    "start": "1296919",
    "end": "1302679"
  },
  {
    "text": "have H full access to my Vault and this is how it looks from the moment you click the the the link the unique link",
    "start": "1302679",
    "end": "1310200"
  },
  {
    "text": "on the email uh you basically get this request that returns a 302 the 302 H",
    "start": "1310200",
    "end": "1316400"
  },
  {
    "text": "redirects you to a to a URL contains four parameters that we will talk about later but it's basically time time hash",
    "start": "1316400",
    "end": "1322200"
  },
  {
    "text": "user and username and then we will uh and user and user hash and then H you",
    "start": "1322200",
    "end": "1329320"
  },
  {
    "text": "get to that really nice page with the R button and when you click on it you do a a post request to",
    "start": "1329320",
    "end": "1335640"
  },
  {
    "text": "otp. PHP we saw only one parameter that is hash and that returns at the interesting parameter that is rant key",
    "start": "1335640",
    "end": "1342880"
  },
  {
    "text": "okay so let's dive into it first thing we wanted to see is I don't want to need access to to the victim's email right",
    "start": "1342880",
    "end": "1350039"
  },
  {
    "text": "can I generate that URL the 302 URL so we looked at the parameters turns out",
    "start": "1350039",
    "end": "1355799"
  },
  {
    "text": "time is the time stamp when the recovery was initiated basically when you said put your email and clicked and the time",
    "start": "1355799",
    "end": "1362240"
  },
  {
    "text": "hash is aaed Hash of that time stamp username is self-explanatory and so it's",
    "start": "1362240",
    "end": "1367279"
  },
  {
    "text": "a username hash cool so what was the challenges here so we needed a valid",
    "start": "1367279",
    "end": "1372480"
  },
  {
    "text": "timestamp right uh that was not easy because you actually have to Hash it as",
    "start": "1372480",
    "end": "1378240"
  },
  {
    "text": "well so not only do you have to get the right one but you have to Hash it as well so and for that we needed the",
    "start": "1378240",
    "end": "1385200"
  },
  {
    "text": "salt so so we said okay let's start our own account recovery and reuse our",
    "start": "1385200",
    "end": "1392120"
  },
  {
    "text": "hashes on the victim's URL and it actually worked which tells us a couple",
    "start": "1392120",
    "end": "1397159"
  },
  {
    "text": "things the same salt is used for all users basically I started my own recovery and I I basically took that Tim",
    "start": "1397159",
    "end": "1404720"
  },
  {
    "text": "stamp with that time stamp hash pasted it in the victim's URL and it worked so I already had a valid time stamp which",
    "start": "1404720",
    "end": "1410880"
  },
  {
    "text": "was cool another thing that was interesting is that the link doesn't truly expire the only thing that happens",
    "start": "1410880",
    "end": "1417360"
  },
  {
    "text": "is that the Tim stamp is validated against the time stamp hash but it's it's not that they have server side",
    "start": "1417360",
    "end": "1423799"
  },
  {
    "text": "something like okay it has been more than two hours for this and uh there was no need to start",
    "start": "1423799",
    "end": "1430400"
  },
  {
    "text": "account recovery so there was not like oh soone initiated account recovery we have that on the server side we know about it no if you have a valid link",
    "start": "1430400",
    "end": "1437080"
  },
  {
    "text": "that's all you need but but H we still needed the salt because we had the time",
    "start": "1437080",
    "end": "1442440"
  },
  {
    "text": "stamp we had this time stamp hash we had the username but we couldn't hash the usern name of the victim so that was the",
    "start": "1442440",
    "end": "1449240"
  },
  {
    "text": "problem so basically the secret what we were missing is H the global salt and it's just interesting that salts are not",
    "start": "1449240",
    "end": "1455559"
  },
  {
    "text": "meant to be secret they are only need to be random and secure so we moved on we moved on to the to the query when from",
    "start": "1455559",
    "end": "1462720"
  },
  {
    "text": "when you click from the to the request from when you click um H press to recover and that have one parameter",
    "start": "1462720",
    "end": "1469480"
  },
  {
    "text": "which is H the hash so we looked into it we use the the python script and we saw",
    "start": "1469480",
    "end": "1475320"
  },
  {
    "text": "that it was a deriv a uh the disa onetime password and it turns out in lastas there is two types of onetime",
    "start": "1475320",
    "end": "1481720"
  },
  {
    "text": "password one of them is the one you basically are aware of which is the one you you basically print out and use to",
    "start": "1481720",
    "end": "1488360"
  },
  {
    "text": "logging in an untrusted machine it's only valid for once but then they have the disabled onetime password and from",
    "start": "1488360",
    "end": "1494600"
  },
  {
    "text": "now on we're going to call it the OTP because it's going to get a little confusing okay what is a",
    "start": "1494600",
    "end": "1499799"
  },
  {
    "text": "dop it's used to recover your vault which in reality means for authentication and it's not yet the",
    "start": "1499799",
    "end": "1506520"
  },
  {
    "text": "Vault encryption key of course if not that will be super easy but the most important thing here respect to the",
    "start": "1506520",
    "end": "1512640"
  },
  {
    "text": "other attacks that we that we presented is that it's set there by default so when you install the plug-in you log in",
    "start": "1512640",
    "end": "1519120"
  },
  {
    "text": "it's set there by default locally Okay cool so and where is it store and how",
    "start": "1519120",
    "end": "1525039"
  },
  {
    "text": "again it's in plain Tex in Firefox it's in the shadow 56 of your username undor",
    "start": "1525039",
    "end": "1530600"
  },
  {
    "text": "fffp and in the rest of the browsers again is in a database that no root needed there in clear text awesome so",
    "start": "1530600",
    "end": "1538200"
  },
  {
    "text": "how is actually the request Forge so we looked at the Dom we looked at the JavaScript of when you click the button",
    "start": "1538200",
    "end": "1543960"
  },
  {
    "text": "and basically gets injected by the plugging into the Dom in last pass and",
    "start": "1543960",
    "end": "1549240"
  },
  {
    "text": "uh that's how it's sent when you click the button awesome H so how do we get from the",
    "start": "1549240",
    "end": "1556200"
  },
  {
    "text": "disabled onetime password store locally in your machine in clear text to the vault which is what we really want to",
    "start": "1556200",
    "end": "1562880"
  },
  {
    "text": "know so basically the plug-in ask local storage okay give me H the disabl onetime password that you have then what",
    "start": "1562880",
    "end": "1569840"
  },
  {
    "text": "it does is a shot to 56 of a shot to 56 of the username plus the binary version",
    "start": "1569840",
    "end": "1575640"
  },
  {
    "text": "of the disabled onetime password this is kind of like a Layman's hmac and it uses",
    "start": "1575640",
    "end": "1581399"
  },
  {
    "text": "that toen as an authentication hash so it will send that token together with",
    "start": "1581399",
    "end": "1586919"
  },
  {
    "text": "your username and then you get a valid session and together with the valid session you get another parameter that",
    "start": "1586919",
    "end": "1592600"
  },
  {
    "text": "is called the Rand key and the next request we see is it retrieves all the encrypted Vault from LastPass and you",
    "start": "1592600",
    "end": "1599039"
  },
  {
    "text": "get it locally as well cool so the question here is what is Rand key so now",
    "start": "1599039",
    "end": "1604880"
  },
  {
    "text": "that we got Rand key from LastPass is not yet the The Vault encryption key but it's the Vault encryption key",
    "start": "1604880",
    "end": "1612440"
  },
  {
    "text": "encrypted so how do we decrypt it so it's actually encrypted in as250 6 CBC",
    "start": "1612440",
    "end": "1619640"
  },
  {
    "text": "the IV is random and the key basically the secret to the cryp your vault key",
    "start": "1619640",
    "end": "1624880"
  },
  {
    "text": "that El laspas has is the disabled onetime password so you just do a shot to 56 of that and you can decrypt it so",
    "start": "1624880",
    "end": "1633159"
  },
  {
    "text": "again what is a disabled onetime password it's actually a master password on steroids because you can use it to",
    "start": "1633159",
    "end": "1639960"
  },
  {
    "text": "authenticate you can use it to obtain the vault key encrypt it but you can use",
    "start": "1639960",
    "end": "1645000"
  },
  {
    "text": "it to decrypt it as well and in addition bypasses IP restrictions from the test",
    "start": "1645000",
    "end": "1650159"
  },
  {
    "text": "we did some time ago it bypasses to FAA and it's stored locally by default which",
    "start": "1650159",
    "end": "1655880"
  },
  {
    "text": "is the real cool thing here and uh the Vault we actually turns out we have it",
    "start": "1655880",
    "end": "1661159"
  },
  {
    "text": "locally as well and uh it's basically in this format again in in in Firefox is in",
    "start": "1661159",
    "end": "1667080"
  },
  {
    "text": "a specific file for the rest of the browsers is SQL light and it's basically encoded in Bas 64 the the encrypted volt",
    "start": "1667080",
    "end": "1674279"
  },
  {
    "text": "so that's awesome because now we are able to get a encryption Keys H in all",
    "start": "1674279",
    "end": "1680000"
  },
  {
    "text": "cases no matter if you have active sessions Master passwords whatever it's just there by default and we can use it",
    "start": "1680000",
    "end": "1686159"
  },
  {
    "text": "we know how to retrieve it we know how to derive the encryption key and we know how to decrypt it so basically we're",
    "start": "1686159",
    "end": "1692279"
  },
  {
    "text": " sorry so so that is that is really cool I told you not to swear man",
    "start": "1692279",
    "end": "1698919"
  },
  {
    "text": "so what are the conclusions ER we know how to get the credentials and derive them from the Vault and we know how to",
    "start": "1698919",
    "end": "1705760"
  },
  {
    "text": "use the disabled onetime passwords to obtain and decrypt the vault key and we",
    "start": "1705760",
    "end": "1711200"
  },
  {
    "text": "know where encrypted vault is we understand the format and we know how to decrypt it so we can print all the",
    "start": "1711200",
    "end": "1717039"
  },
  {
    "text": "passwords out so that was really cool awesome and actually I'm going to",
    "start": "1717039",
    "end": "1722360"
  },
  {
    "text": "leave Alberto so we told you a lot of stuff and uh we thought okay if if we",
    "start": "1722360",
    "end": "1727760"
  },
  {
    "text": "have all this we we want to contribute back to the to the community and actually especially to pent testers and",
    "start": "1727760",
    "end": "1734600"
  },
  {
    "text": "uh so we wrote A A meta exploit plug-in a post exploitation mod",
    "start": "1734600",
    "end": "1740360"
  },
  {
    "text": "exploit uh no I got that I'm not going to tell you my password you work for the",
    "start": "1740360",
    "end": "1746080"
  },
  {
    "text": "red te forget about it",
    "start": "1746080",
    "end": "1750039"
  },
  {
    "text": "okay the other way around come on okay so uh we we grow the",
    "start": "1754600",
    "end": "1761799"
  },
  {
    "text": "plugin a post exploitation plugin for metlo so it will be very easy for anybody to use it to when they're doing",
    "start": "1761799",
    "end": "1769039"
  },
  {
    "text": "a pentest they're doing a red team exercise just access to the the credentials using all the techniques we",
    "start": "1769039",
    "end": "1776440"
  },
  {
    "text": "spoke about before to H retrieve the credentials from the from the",
    "start": "1776440",
    "end": "1782440"
  },
  {
    "text": "Vault you want to show the previous slide go back to the slides because we have basically all the features that",
    "start": "1782760",
    "end": "1789919"
  },
  {
    "text": "there yeah you click there click just to have an overview",
    "start": "1789919",
    "end": "1797039"
  },
  {
    "text": "what basically applies all the research we did all what we told you before uh about before and it basically Steals and",
    "start": "1797039",
    "end": "1804440"
  },
  {
    "text": "decrypts the credentials that you have in your Vault it steals the TFA token even if the user doesn't have it",
    "start": "1804440",
    "end": "1810320"
  },
  {
    "text": "activated we proactively steal that tofa token so if the user in the future",
    "start": "1810320",
    "end": "1815919"
  },
  {
    "text": "activated we are in we are still in it steals and arrives the encryption key so",
    "start": "1815919",
    "end": "1822360"
  },
  {
    "text": "you will not only get the actual PL test cred but the decryption key for the vault it the equips The Vault of course",
    "start": "1822360",
    "end": "1829279"
  },
  {
    "text": "imprints prints all the passwords that you have in the vault and it supports all those all those different OS Windows",
    "start": "1829279",
    "end": "1836000"
  },
  {
    "text": "Mac Unix and those for uh for um browsers we are finishing the",
    "start": "1836000",
    "end": "1843399"
  },
  {
    "text": "integration with Internet Explorer to still Internet Explorer uh Vol to and of",
    "start": "1843399",
    "end": "1848679"
  },
  {
    "text": "course we can use it from met exploit and it's multiuser if you if you want to play with it we just h i just push it to",
    "start": "1848679",
    "end": "1854720"
  },
  {
    "text": "my repository we put the URL there there is some to news box it was yesterday night we are with jetl so but it should",
    "start": "1854720",
    "end": "1862480"
  },
  {
    "text": "be good to go to do some tests Yeah so basically this is the victim machine and",
    "start": "1862480",
    "end": "1868519"
  },
  {
    "text": "he this is Donald Trump I don't know if you if you know him but it's a nice guy we live in San Francisco and it's all in",
    "start": "1868519",
    "end": "1876679"
  },
  {
    "text": "it's every every day in the news so uh here we have already some session open I",
    "start": "1876679",
    "end": "1882279"
  },
  {
    "text": "mean we're going to we're not going to get in how you get access to a machine that this is a post exploitation model",
    "start": "1882279",
    "end": "1888000"
  },
  {
    "text": "do something up to you so basically what we have here is",
    "start": "1888000",
    "end": "1893200"
  },
  {
    "text": "that the victim's machine which is Donald Trump's he has two accounts right he has his own personal account but he",
    "start": "1893200",
    "end": "1899159"
  },
  {
    "text": "also has an Enterprise laspas account and in addition he's nice enough to leave let his girlfriend use the machine",
    "start": "1899159",
    "end": "1906679"
  },
  {
    "text": "so there is a second Windows account with the girlfriend's laspas account so",
    "start": "1906679",
    "end": "1912000"
  },
  {
    "text": "basically we have two windows accounts and three laspas accounts one of them is Enterprise okay",
    "start": "1912000",
    "end": "1918559"
  },
  {
    "text": "so basically the only thing we need to set is the session the Met pror session we we want to ruin this module against",
    "start": "1918559",
    "end": "1925120"
  },
  {
    "text": "and just say run it's very very straightforward is that the time where",
    "start": "1925120",
    "end": "1930880"
  },
  {
    "text": "we cross the fingers or yeah more or less I my toes fingers crossed Wi-Fi is",
    "start": "1930880",
    "end": "1936240"
  },
  {
    "text": "not very reliable so if it doesn't work it's not our fault all right so yeah basically it's",
    "start": "1936240",
    "end": "1943399"
  },
  {
    "text": "extracting everything we told you about this is a nice error we like to print H but it should work I was getting this",
    "start": "1943399",
    "end": "1949840"
  },
  {
    "text": "Ser yesterday but it doesn't really do anything bad or I hope so come on three",
    "start": "1949840",
    "end": "1955240"
  },
  {
    "text": "two one boom oh yeah it's going to work there you go awesome",
    "start": "1955240",
    "end": "1962240"
  },
  {
    "text": "okay it's anyway not going to make a difference so okay",
    "start": "1962360",
    "end": "1967960"
  },
  {
    "text": "yeah sorry it's a little messy because of the yeah the size but basically it",
    "start": "1967960",
    "end": "1973120"
  },
  {
    "text": "says what account are you like extracting the the credentials from",
    "start": "1973120",
    "end": "1978399"
  },
  {
    "text": "Yeah so basically you have here right you have the what we give you is basically the windows account as you can",
    "start": "1978399",
    "end": "1983559"
  },
  {
    "text": "see from Donald Trump we give you the username yeah the username and the",
    "start": "1983559",
    "end": "1988840"
  },
  {
    "text": "password here in this case because this is a corporate account he didn't store",
    "start": "1988840",
    "end": "1994080"
  },
  {
    "text": "the master password okay so we couldn't get the master password but we could get",
    "start": "1994080",
    "end": "1999320"
  },
  {
    "text": "the actual tofa and the key the decryption key that is here we have",
    "start": "1999320",
    "end": "2004639"
  },
  {
    "text": "another account we did that so basically because we couldn't from the credentials because he was using an Enterprise",
    "start": "2004639",
    "end": "2010000"
  },
  {
    "text": "account and he was not allowed to store the the master password in this case what we use was the cookie to get it",
    "start": "2010000",
    "end": "2016440"
  },
  {
    "text": "because he had an active session exactly here in this other one we this is a personal account from from Donald",
    "start": "2016440",
    "end": "2023320"
  },
  {
    "text": "Trump and we were we were able to get the the password because he clicked on remember my password so we're decrypted",
    "start": "2023320",
    "end": "2030000"
  },
  {
    "text": "and the same thing as you can see the twoa is the same for both accounts here",
    "start": "2030000",
    "end": "2035080"
  },
  {
    "text": "in the other side is a different uh user that's the girlfriend of uh Donald Trump",
    "start": "2035080",
    "end": "2040240"
  },
  {
    "text": "and we couldn't get the password either but we were able to get tofa and decryption key and here down here this",
    "start": "2040240",
    "end": "2046720"
  },
  {
    "text": "case yeah the decryption key we got it because in this case we use the disabled One turns out she didn't have an active",
    "start": "2046720",
    "end": "2052760"
  },
  {
    "text": "account so our plugin basically it try it iterates first it tries to look for",
    "start": "2052760",
    "end": "2058118"
  },
  {
    "text": "the master password if it's there then nice because everything happens locally if not we try to use a cooking if not we",
    "start": "2058119",
    "end": "2063560"
  },
  {
    "text": "always rely on the disabled onetime password yeah and here you can see for for every user you can we you we can see",
    "start": "2063560",
    "end": "2071000"
  },
  {
    "text": "the actual URL the username and the decrypted password like the same that's",
    "start": "2071000",
    "end": "2077320"
  },
  {
    "text": "username and password is here here okay we can we did that for the personal",
    "start": "2077320",
    "end": "2084320"
  },
  {
    "text": "Trump's account the corporate Trump's account other one was the Trump's baby",
    "start": "2084320",
    "end": "2090638"
  },
  {
    "text": "the girlfriend yeah and here we can see the like all the information for the different",
    "start": "2090639",
    "end": "2096919"
  },
  {
    "text": "accounts so it worked thanks",
    "start": "2096919",
    "end": "2103359"
  },
  {
    "text": "God I told you the Wi-Fi is not reliable and still",
    "start": "2108200",
    "end": "2113359"
  },
  {
    "text": "worked it's it's it was it it is very useful in the in the exercise the red team exercise because as I said normally",
    "start": "2113359",
    "end": "2119839"
  },
  {
    "text": "you don't have a lot of time you can install a you can say Okay Alberto you can install a keog a key logger and just",
    "start": "2119839",
    "end": "2125520"
  },
  {
    "text": "get the password okay you can get maybe one credential two credentials the good thing about this is that you get into the machine you run this plug-in and you",
    "start": "2125520",
    "end": "2132040"
  },
  {
    "text": "get everything right away okay that's something very useful when you're doing a red team exercise because normally the",
    "start": "2132040",
    "end": "2137760"
  },
  {
    "text": "blue team is there looking at you trying to to get to so yeah work awesome I do this yeah okay",
    "start": "2137760",
    "end": "2148119"
  },
  {
    "text": "my turn again so actually let me go back to this one so what we are going to do now is let's move on from the client",
    "start": "2148119",
    "end": "2155400"
  },
  {
    "text": "side attacks okay so now what we want to see see you it's a yeah I don't I don't",
    "start": "2155400",
    "end": "2160760"
  },
  {
    "text": "want you close to me man okay so now we now we moved on from the from the client",
    "start": "2160760",
    "end": "2166880"
  },
  {
    "text": "side we show you ER some different attacks we we we show you the module so now it's time to move on so now we",
    "start": "2166880",
    "end": "2173720"
  },
  {
    "text": "wanted to understand what are the risks if laspas will be the the attacker which",
    "start": "2173720",
    "end": "2179000"
  },
  {
    "text": "is not the case but truth is that ER they had a bridge couple months",
    "start": "2179000",
    "end": "2184760"
  },
  {
    "text": "ago so the attacker can be on laspas side and in addition we also have other",
    "start": "2184760",
    "end": "2190160"
  },
  {
    "text": "things like NSA or whatever that could try to force a laspas to to give some of",
    "start": "2190160",
    "end": "2195680"
  },
  {
    "text": "your data so we really wanted to understand what is it that with the information that is on laspas servers",
    "start": "2195680",
    "end": "2202040"
  },
  {
    "text": "you can do which is in the end the the the goal of this business that they can't do anything and if there are some",
    "start": "2202040",
    "end": "2209880"
  },
  {
    "text": "attacks cool so it's time to get paranoid okay we are laspas so let's get",
    "start": "2209880",
    "end": "2215800"
  },
  {
    "text": "paranoid here and we brought here our our hats this is very important when you want to get professionally paranoid and",
    "start": "2215800",
    "end": "2222599"
  },
  {
    "text": "we got some for you too if you want to we can put them there but this is paranoid mode okay all right",
    "start": "2222599",
    "end": "2231040"
  },
  {
    "text": "awesome okay paranoid mode on we are last pass",
    "start": "2231040",
    "end": "2236440"
  },
  {
    "text": "on last pass servers we are some hackers something like that cool does it look good to me yeah no okay and next okay so",
    "start": "2236440",
    "end": "2245520"
  },
  {
    "text": "the first thing to we wanted to see is like okay let's look at what does lpas see in reality Alberto already mentioned",
    "start": "2245520",
    "end": "2252160"
  },
  {
    "text": "that um in order to derive your your encryption key your vault key from your",
    "start": "2252160",
    "end": "2257280"
  },
  {
    "text": "uh tix credentials they use a pbkdf2 with 5,000 rounds right so you get your",
    "start": "2257280",
    "end": "2262319"
  },
  {
    "text": "encryption key and then what they only do apply an extra R to your encryption",
    "start": "2262319",
    "end": "2267560"
  },
  {
    "text": "key H in order to authenticate so the first thing we realize was there is no really pbkdf2",
    "start": "2267560",
    "end": "2273640"
  },
  {
    "text": "protection it is locally for your uh clear Tech credentials but not for your",
    "start": "2273640",
    "end": "2278760"
  },
  {
    "text": "encryption key against LastPass so this is something to keep in mind so another",
    "start": "2278760",
    "end": "2284839"
  },
  {
    "text": "thing we saw is that the the laspas also has your vault key encrypted in couple",
    "start": "2284839",
    "end": "2289880"
  },
  {
    "text": "different ways one of them we talked about which was the disabled onetime password remember and the the disabled onetime",
    "start": "2289880",
    "end": "2296880"
  },
  {
    "text": "password is 32 character so we are back to 256 bits but if you use the regular H",
    "start": "2296880",
    "end": "2302560"
  },
  {
    "text": "onetime passwords H that's only 16 bytes so it's it's no no big deal but one of",
    "start": "2302560",
    "end": "2308800"
  },
  {
    "text": "the things we found is like first you don't get the pbkdf2 protection for your encryption key and now they have your",
    "start": "2308800",
    "end": "2316000"
  },
  {
    "text": "encryption key encrypted but with a key that is not really 256 bit because it's",
    "start": "2316000",
    "end": "2323040"
  },
  {
    "text": "it uses the username that they already know and there is no pbkdf2 so there is no Brute Force protection so this is",
    "start": "2323040",
    "end": "2329040"
  },
  {
    "text": "something to keep in mind as well paranoid mode on okay again and then we have the encrypted BT which we'll have a",
    "start": "2329040",
    "end": "2336520"
  },
  {
    "text": "look at it okay okay so this is an encrypted Vault and it doesn't look very encrypted from from that picture right",
    "start": "2336520",
    "end": "2343640"
  },
  {
    "text": "we see a lot of more encoding we see some JavaScript and there is some data missing but don't don't worry we're not",
    "start": "2343640",
    "end": "2350240"
  },
  {
    "text": "going to say it's not encrypted because then that's all we will have said H so the encrypted VA actually turns out that",
    "start": "2350240",
    "end": "2356680"
  },
  {
    "text": "your URLs icons and metadata is not really encrypted which which could be fine or not because I don't know if",
    "start": "2356680",
    "end": "2363160"
  },
  {
    "text": "you're the kind of guy that registers in porn sites or some other stuff or or think about it like if you are",
    "start": "2363160",
    "end": "2369359"
  },
  {
    "text": "registered in some forums that are um Politically Incorrect or things like",
    "start": "2369359",
    "end": "2375359"
  },
  {
    "text": "that you know basically you get no privacy because lpas can see your URLs they are encoded not encrypted and",
    "start": "2375359",
    "end": "2380960"
  },
  {
    "text": "another thing we we realized was that when you reset your password imagine on Twitter you want to reset your password",
    "start": "2380960",
    "end": "2386599"
  },
  {
    "text": "usually the way it works is you click on reset your password and you get a unique link on your email you clicked on it you",
    "start": "2386599",
    "end": "2392680"
  },
  {
    "text": "get redirected impromed for new passwords and they and then um basically",
    "start": "2392680",
    "end": "2398160"
  },
  {
    "text": "what you will do you enter your new password lastas DET Texs it and suggest hey you want me to update your password",
    "start": "2398160",
    "end": "2403920"
  },
  {
    "text": "but that URL is taken and now that URL which is the unique URL to reset your password is on laspas side now if the",
    "start": "2403920",
    "end": "2411599"
  },
  {
    "text": "Web Master did not a good job and did not expire that link or the link just never expires uh that is bad because",
    "start": "2411599",
    "end": "2418880"
  },
  {
    "text": "they could reset and when I mean they I don't mean laspas I want to make that clear we work with them they are awesome",
    "start": "2418880",
    "end": "2424280"
  },
  {
    "text": "so when I mean they even though we are talking laspas side I mean hackers that attempt to be there or NSA or well I",
    "start": "2424280",
    "end": "2431079"
  },
  {
    "text": "shouldn't say anything bad about NSA either I guess okay so you know what I mean and uh cool so another thing we",
    "start": "2431079",
    "end": "2437920"
  },
  {
    "text": "found was that actually your your passwords are incuded with ECB remember like your vault is really just it",
    "start": "2437920",
    "end": "2444760"
  },
  {
    "text": "encrypts really the password itself it's not an encrypted chunk of of of something that you can't understand",
    "start": "2444760",
    "end": "2450839"
  },
  {
    "text": "anything it's more metadata with encrypted values so and and this is not the best thing because it will Le some",
    "start": "2450839",
    "end": "2456720"
  },
  {
    "text": "information about password length which actually happens in CBC too but yeah something to point out but especially it",
    "start": "2456720",
    "end": "2462760"
  },
  {
    "text": "will leak the passwords that are identical because of how ECB works and you say well that's not a big deal",
    "start": "2462760",
    "end": "2468480"
  },
  {
    "text": "because they still don't know my password but one of the things we thought is think about all those dumps",
    "start": "2468480",
    "end": "2473520"
  },
  {
    "text": "of passwords that happen because Adobe so 10 million passwords your url is is encoded so they",
    "start": "2473520",
    "end": "2480960"
  },
  {
    "text": "know where you're registered now they could know that you registered in that site that leak the clear text password",
    "start": "2480960",
    "end": "2487400"
  },
  {
    "text": "or that someone decrypted so I go there and I look at your cext password I go to your Vault and I see you registered",
    "start": "2487400",
    "end": "2493520"
  },
  {
    "text": "there and I see your the cipher text of your encrypted password now if I see that same Cipher text in other accounts",
    "start": "2493520",
    "end": "2501319"
  },
  {
    "text": "I know it's the same password and I know where you are registered because I know the URLs so this is why this is not the",
    "start": "2501319",
    "end": "2507319"
  },
  {
    "text": "best thing and then it leaks also information about similar passwords if you have like hello one two3 hello one",
    "start": "2507319",
    "end": "2513400"
  },
  {
    "text": "12 3 4 hello one 12 35 ECB can leak some of that information and this is",
    "start": "2513400",
    "end": "2518640"
  },
  {
    "text": "interesting because this is the encrypted Vault by XML version we were tampering with the apis and suddenly we",
    "start": "2518640",
    "end": "2524240"
  },
  {
    "text": "got this which is not used by any by any plugging or anything but it was cool to see it this way and we were a little bit",
    "start": "2524240",
    "end": "2529960"
  },
  {
    "text": "more paranoid and here comes the cool thing one of the things we saw was sorry you don't see very clear but it's this",
    "start": "2529960",
    "end": "2536000"
  },
  {
    "text": "parameter for every single account that is custom corgs and we said that it has",
    "start": "2536000",
    "end": "2542200"
  },
  {
    "text": "JavaScript again this is the encrypted Vault this is clear text JavaScript on your encrypted Vault so we wonder like",
    "start": "2542200",
    "end": "2549680"
  },
  {
    "text": "okay what what is exactly this for right and it turns out that laspas has a legit",
    "start": "2549680",
    "end": "2555400"
  },
  {
    "text": "reason to have that is he can't always guess H where basically the the input",
    "start": "2555400",
    "end": "2561440"
  },
  {
    "text": "nodes are basically to inject your credentials right I go to facebook.com and it always knows where to put the",
    "start": "2561440",
    "end": "2566839"
  },
  {
    "text": "username and the password but there is a lot of bad web Masters out there or they use Flash or things like that so laspas",
    "start": "2566839",
    "end": "2572880"
  },
  {
    "text": "may have a hard time to try to guess where they are so they inject JavaScript script in your Vault to find those for",
    "start": "2572880",
    "end": "2580319"
  },
  {
    "text": "you and custom GS is the one that has that so but what are we really saying",
    "start": "2580319",
    "end": "2585520"
  },
  {
    "text": "here is that laspas or any attacker compromising their servers can add clear",
    "start": "2585520",
    "end": "2591599"
  },
  {
    "text": "text credentials to your Vault what did I say can add clear text",
    "start": "2591599",
    "end": "2596960"
  },
  {
    "text": "credential no sorry can add a JavaScript payloads to your Vault for every single account and that JavaScript will run in",
    "start": "2596960",
    "end": "2604760"
  },
  {
    "text": "the domain's context for example if they inject a JavaScript to my Facebook account as soon as I get to Facebook",
    "start": "2604760",
    "end": "2611880"
  },
  {
    "text": "that JavaScript will run which again is in clear text in my encrypted Vault and in laspas server's hands and it's also",
    "start": "2611880",
    "end": "2619040"
  },
  {
    "text": "executed on every single page load in that domain not just on the login page",
    "start": "2619040",
    "end": "2624640"
  },
  {
    "text": "so what is actually custom GS for an attacker it's the JavaScript payloads are not encrypted the plug-in does no",
    "start": "2624640",
    "end": "2631480"
  },
  {
    "text": "validation they just to create a script note inject this close the script note",
    "start": "2631480",
    "end": "2636920"
  },
  {
    "text": "that's that's all victim does not notice anything strange you can do payloads and and and nothing's going to happen it",
    "start": "2636920",
    "end": "2642800"
  },
  {
    "text": "just runs in background right it's JavaScript the USS payload executes on every page load as I mentioned before",
    "start": "2642800",
    "end": "2649200"
  },
  {
    "text": "the cool thing is because the URLs again are not encrypted and this is metadata that is not encrypted either just the",
    "start": "2649200",
    "end": "2655040"
  },
  {
    "text": "values someone on laspas can add new accounts to our vault with their GS",
    "start": "2655040",
    "end": "2660920"
  },
  {
    "text": "payload say you want to steal H my my emails and uh and I don't have my emails",
    "start": "2660920",
    "end": "2668000"
  },
  {
    "text": "credentials on laspas because I just know the password so but they could inject a a new account that is Gmail at",
    "start": "2668000",
    "end": "2675119"
  },
  {
    "text": "the payLo it's still going to run so that is something to keep in mind but the best thing of all is that laspas",
    "start": "2675119",
    "end": "2680359"
  },
  {
    "text": "again for legit reasons offers two viables that actually contain the clear text username and password which is LP C",
    "start": "2680359",
    "end": "2687640"
  },
  {
    "text": "user and LP C pass so I don't even have to wait with my payload to come out",
    "start": "2687640",
    "end": "2693280"
  },
  {
    "text": "where okay where is this page going to put the credentials I have to write to wait till he writes them or or oh okay",
    "start": "2693280",
    "end": "2701079"
  },
  {
    "text": "he was already locked in so he's never going to enter it I can just use these two variables and get clear text",
    "start": "2701079",
    "end": "2707319"
  },
  {
    "text": "credentials and we did we basically H did uh we on the network and we acted as",
    "start": "2707319",
    "end": "2713280"
  },
  {
    "text": "if we would be LastPass right and we actually H put a payload just to see if it will work and it will work as you can",
    "start": "2713280",
    "end": "2720040"
  },
  {
    "text": "see here we only alert the clear text passwords but basically what the plugin will do is inject those payloads in the",
    "start": "2720040",
    "end": "2726119"
  },
  {
    "text": "Dom and that's no validation no nothing so we thought okay let's play a game",
    "start": "2726119",
    "end": "2732040"
  },
  {
    "text": "here and so you basically understand the the use case we are NSA versus last pass",
    "start": "2732040",
    "end": "2739240"
  },
  {
    "text": "okay so you want to play NSA or last pass okay I'm going to do NSA okay so I guess I last",
    "start": "2739240",
    "end": "2745800"
  },
  {
    "text": "but we like to put things okay I'm going to be last now",
    "start": "2745800",
    "end": "2752359"
  },
  {
    "text": "okay awesome so we want to make it clear you're very very last us now",
    "start": "2752359",
    "end": "2758559"
  },
  {
    "text": "so I'm NSA here hey Joo I need access to Donald's Trump email sorry man I can't",
    "start": "2758559",
    "end": "2764359"
  },
  {
    "text": "decrypt any B I don't have the encryption Fey come on I know that you can see if he has a Gmail account yes",
    "start": "2764359",
    "end": "2771599"
  },
  {
    "text": "but I just told you I can't encrypt anything anyway wait wait wait we can misuse the the custom GS and we can",
    "start": "2771599",
    "end": "2779000"
  },
  {
    "text": "append this payload that I'm giv to you ah you know I'm not comfortable doing that this is my business sorry yeah you",
    "start": "2779000",
    "end": "2786680"
  },
  {
    "text": "know you don't have any choice I have I am NSA okay cool but we checked and there",
    "start": "2786680",
    "end": "2792559"
  },
  {
    "text": "is no Gmail account there in the vault I'm sorry man I will really do it don't shut down my my business but you know",
    "start": "2792559",
    "end": "2799440"
  },
  {
    "text": "there is no account I'm sorry don't worry I have an option here we can walk around just like inject a new account to",
    "start": "2799440",
    "end": "2805000"
  },
  {
    "text": "the Vault and include this other payload and create this Gmail payload for him",
    "start": "2805000",
    "end": "2810880"
  },
  {
    "text": "that's it oh  all right so I guess we have permission now to take the paranoid hats",
    "start": "2810880",
    "end": "2818000"
  },
  {
    "text": "off right awesome okay cool and I think",
    "start": "2818000",
    "end": "2823599"
  },
  {
    "text": "now yeah awesome this like just at the end so attacks from the outside what",
    "start": "2823599",
    "end": "2829480"
  },
  {
    "text": "happen if we are not in the client we are not in the yeah we are not in the in the server side we are just an outsider",
    "start": "2829480",
    "end": "2836920"
  },
  {
    "text": "so do you remember like Firefox prep. GS you know that people uses this uh when",
    "start": "2836920",
    "end": "2843760"
  },
  {
    "text": "they have some troubl suting they upload all the configuration of his Firefox because they got some adware or",
    "start": "2843760",
    "end": "2849520"
  },
  {
    "text": "something like that and they really want to remove the adware so you just send the configuration including prep GS to",
    "start": "2849520",
    "end": "2855960"
  },
  {
    "text": "the Internet so basically you can just use a Google dor and search for that",
    "start": "2855960",
    "end": "2862359"
  },
  {
    "text": "file that's our very Advanced H hacking techniques Google",
    "start": "2862359",
    "end": "2868760"
  },
  {
    "text": "dos so yeah it's maybe not a good idea if you want to search your encrypted",
    "start": "2868760",
    "end": "2874200"
  },
  {
    "text": "password with your key to the crypted that's basically we found it in forums we found it in in PB and things like",
    "start": "2874200",
    "end": "2882280"
  },
  {
    "text": "that basically some people is uploading their credentials with the key to the cryp them yeah not a good idea don't do",
    "start": "2882280",
    "end": "2888880"
  },
  {
    "text": "that guys and last hardening laspas so we want to be very clear here we have",
    "start": "2888880",
    "end": "2895000"
  },
  {
    "text": "been like back and forward with laspas the team that they have the take care of security is is awesome they did an like",
    "start": "2895000",
    "end": "2901760"
  },
  {
    "text": "tremendous job actually most of the things that we uh sent to them that we report to them were fixed within 72",
    "start": "2901760",
    "end": "2909280"
  },
  {
    "text": "hours and of course there the same issues may happen in other um password",
    "start": "2909280",
    "end": "2915440"
  },
  {
    "text": "managers we are not saying the laspas is is a is a wrong decision actually we use laspas both of us that's why we we use",
    "start": "2915440",
    "end": "2922280"
  },
  {
    "text": "some time on this we care about our passwords and this is a list of uh the",
    "start": "2922280",
    "end": "2928319"
  },
  {
    "text": "the issues that we reported to them and they fixed it now they warning you when you try to store your password your",
    "start": "2928319",
    "end": "2933920"
  },
  {
    "text": "master password H they recover URL can't be forged anymore they change it h recover",
    "start": "2933920",
    "end": "2941359"
  },
  {
    "text": "process needs to be initiated now you remember that we were saying that we were able to bypass the initiation",
    "start": "2941359",
    "end": "2946480"
  },
  {
    "text": "process that's not a thing anymore they roll out recently an SMS uh",
    "start": "2946480",
    "end": "2951799"
  },
  {
    "text": "functionality to recover your account so that's a proper TFA H Firefox does no",
    "start": "2951799",
    "end": "2958079"
  },
  {
    "text": "longer store credits in prep GS oh that was I was sad I was crying the whole day",
    "start": "2958079",
    "end": "2963839"
  },
  {
    "text": "when I realized about it and all users affected by dual dorks with contacted by laspas that's that's kind of that's a",
    "start": "2963839",
    "end": "2971000"
  },
  {
    "text": "good thing and uh there's a lot of more alerts regarding sensitive",
    "start": "2971000",
    "end": "2976720"
  },
  {
    "text": "actions and we have recommendations for you and we have recommendations for laspas these are the recommendations for",
    "start": "2976720",
    "end": "2982280"
  },
  {
    "text": "you download the binary version of the plugin if you can you just do that install the binary version you will you",
    "start": "2982280",
    "end": "2989520"
  },
  {
    "text": "will bypass some of those problems we saw before H do not store your master",
    "start": "2989520",
    "end": "2995599"
  },
  {
    "text": "password please please you say no I don't do that but yeah yeah I've been in I mean I while I",
    "start": "2995599",
    "end": "3004200"
  },
  {
    "text": "was working the redim I've been in hundreds thousands of machines people do",
    "start": "3004200",
    "end": "3009280"
  },
  {
    "text": "store the master password audit your Vault for malicious GS this is kind of complicated but this",
    "start": "3009280",
    "end": "3015400"
  },
  {
    "text": "is up to you don't not use password reminders activate TFA we saw that it's not very useful using tofa but at least",
    "start": "3015400",
    "end": "3023400"
  },
  {
    "text": "we can add some extra layer of security prompt from for master password to",
    "start": "3023400",
    "end": "3028440"
  },
  {
    "text": "reveal password that's like an advanced option that you can activate it and it's",
    "start": "3028440",
    "end": "3033880"
  },
  {
    "text": "painful you can say that it lose the actual way of like the easiness of using",
    "start": "3033880",
    "end": "3039599"
  },
  {
    "text": "laspas but uh you can do that at countries restrictions I'm not going to",
    "start": "3039599",
    "end": "3045319"
  },
  {
    "text": "be in China if somebody like logs in in my laspas account from China that will",
    "start": "3045319",
    "end": "3051160"
  },
  {
    "text": "trigger some alerts you have that option there's that feature to to do this kind of restrictions",
    "start": "3051160",
    "end": "3057440"
  },
  {
    "text": "randomize i' like change the the number of iterations for PB pbk df2 and disable",
    "start": "3057440",
    "end": "3063720"
  },
  {
    "text": "dis alow to Lins and for laspas encrypt the entire vault in one Chun just do",
    "start": "3063720",
    "end": "3070280"
  },
  {
    "text": "that don't do that like weird thing encrypting only some specific chunks",
    "start": "3070280",
    "end": "3075440"
  },
  {
    "text": "within the within the actual Vault don't use ECB anymore that's let's move on use",
    "start": "3075440",
    "end": "3083119"
  },
  {
    "text": "authenticated encryption get rid of custom G yes we saw that that's like a big deal I really",
    "start": "3083119",
    "end": "3089559"
  },
  {
    "text": "don't want anybody to be injecting JS like JavaScript in my dom in any website",
    "start": "3089559",
    "end": "3095079"
  },
  {
    "text": "I visit that's that's not good use pbkdf2 between the client and laspas",
    "start": "3095079",
    "end": "3101160"
  },
  {
    "text": "also instead of using just one more round just do that extra",
    "start": "3101160",
    "end": "3106960"
  },
  {
    "text": "step use search PN in Embrace open sord that would like very useful because we",
    "start": "3106960",
    "end": "3112000"
  },
  {
    "text": "said that it was a JavaScript minimize it's a pain in the ass actually to get through all of it and what do you think",
    "start": "3112000",
    "end": "3119400"
  },
  {
    "text": "about this one Martin they should adopt a retroactive as a law cash rewarded",
    "start": "3119400",
    "end": "3125359"
  },
  {
    "text": "Bounty program I mean t-shirt based programs are okay I have another one will be just pretty cool if they will do",
    "start": "3125359",
    "end": "3132160"
  },
  {
    "text": "that he gets a lot of girls with that teaser actually for sure and this was it uh we are open to",
    "start": "3132160",
    "end": "3139680"
  },
  {
    "text": "any question thank you very much very much for attending [Applause]",
    "start": "3139680",
    "end": "3151599"
  }
]