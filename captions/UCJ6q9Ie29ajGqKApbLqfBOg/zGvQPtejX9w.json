[
  {
    "text": "[Music]",
    "start": "4019",
    "end": "13820"
  },
  {
    "text": "hello everyone and hello people of the future uh my name is kevin perlow and i am the technical intelligence team lead at a",
    "start": "15120",
    "end": "21279"
  },
  {
    "text": "financial institution today i'm going to be discussing a concept uh called financial payment standards",
    "start": "21279",
    "end": "27279"
  },
  {
    "text": "so where i'm going to be discussing two standards here the iso 8583 standard which is for cards",
    "start": "27279",
    "end": "32558"
  },
  {
    "text": "and the extensions for financial services standard which is a you can think of it as an api for",
    "start": "32559",
    "end": "38320"
  },
  {
    "text": "doing uh for interacting with hardware on an atm i'm going to just be discussing how threat actors incorporate these two",
    "start": "38320",
    "end": "44800"
  },
  {
    "text": "standards into two pretty specific malware families uh fast cash for iso 8583 and",
    "start": "44800",
    "end": "50800"
  },
  {
    "text": "injects pure for extensions for financial services and in the context of how these malware",
    "start": "50800",
    "end": "55840"
  },
  {
    "text": "families work and sort of the inner mechanisms of them i'm also going to be discussing the advantages and drawbacks that come with",
    "start": "55840",
    "end": "62559"
  },
  {
    "text": "integrating these payment standards into a malware family so jumping right in the first thing i",
    "start": "62559",
    "end": "68880"
  },
  {
    "text": "want to discuss is isolated 583 iso 8583 as i said as a standard for financial card transactions so any time",
    "start": "68880",
    "end": "76000"
  },
  {
    "text": "that you go to an atm or anytime you go to a point of server or point of sale device out of",
    "start": "76000",
    "end": "81280"
  },
  {
    "text": "grocery store to do say a self checkout all of those are going to create an iso 8583 message and an iso 8583 transaction",
    "start": "81280",
    "end": "89520"
  },
  {
    "text": "and what this is is a standardized set of fields and standard structure of fields for",
    "start": "89520",
    "end": "95360"
  },
  {
    "text": "transmitting the data from your card and from for your transaction over to a payment switch",
    "start": "95360",
    "end": "101200"
  },
  {
    "text": "from that payment switch to a bank and then on back to approve or reject the transaction that's happening",
    "start": "101200",
    "end": "107200"
  },
  {
    "text": "this is the basis of the fast cash malware which is what we're going to talk about in in just a few minutes but",
    "start": "107200",
    "end": "114159"
  },
  {
    "text": "first just an example on the screen this is very literally an iso 8583 message and this is sort of what all the fuss is",
    "start": "114159",
    "end": "120079"
  },
  {
    "text": "about so just breaking this down into a couple of different parts there are three parts to one of these messages there's a",
    "start": "120079",
    "end": "126399"
  },
  {
    "text": "message type identifier which you can think of as sort of a file header or message header and that has",
    "start": "126399",
    "end": "131520"
  },
  {
    "text": "some metadata about what type of message something is there is a bitmap which",
    "start": "131520",
    "end": "136800"
  },
  {
    "text": "will indicate what fields are present in one of these messages and then there's the data elements which",
    "start": "136800",
    "end": "143040"
  },
  {
    "text": "are those fields and so the purpose behind items two and items three there",
    "start": "143040",
    "end": "148720"
  },
  {
    "text": "are that there are over 100 different options such as the primary account number the transaction date and time",
    "start": "148720",
    "end": "154560"
  },
  {
    "text": "and all sorts of other data that can happen or that can be tied to one of these transactions and so you don't necessarily want to",
    "start": "154560",
    "end": "160480"
  },
  {
    "text": "transmit all of these because most transactions don't use all of these fields and the bitmap just",
    "start": "160480",
    "end": "165599"
  },
  {
    "text": "is there to specify which ones are there for the payment switch to look at",
    "start": "165599",
    "end": "171280"
  },
  {
    "text": "i do need to break down the message type identifier just a little bit further there are four parts to this so there is",
    "start": "171280",
    "end": "178239"
  },
  {
    "text": "a version which is the first digit there is a message classification a message",
    "start": "178239",
    "end": "183360"
  },
  {
    "text": "function and then finally the source of the message where do the message originate from the bank or the atm or some other",
    "start": "183360",
    "end": "189120"
  },
  {
    "text": "entity so going into the example message that",
    "start": "189120",
    "end": "194159"
  },
  {
    "text": "we had on the screen before if we break this down into a couple of parts we can see the first four digits",
    "start": "194159",
    "end": "199920"
  },
  {
    "text": "as i mentioned are the message type identifier and so the first digit of those four digits indicates the version and in this",
    "start": "199920",
    "end": "205680"
  },
  {
    "text": "case this is version 1987 of the iso 8583 standard",
    "start": "205680",
    "end": "211120"
  },
  {
    "text": "the second digit here is the classification and this is really important for the fast cash malware that we're going to be talking about the classification",
    "start": "211120",
    "end": "218319"
  },
  {
    "text": "indicates whether or not something is a financial message which in this case it's set to two so it is or whether it's a chargeback or an authorization",
    "start": "218319",
    "end": "225120"
  },
  {
    "text": "the third digit indicates whether something is a request or whether it's a response coming back and then finally as",
    "start": "225120",
    "end": "230239"
  },
  {
    "text": "i mentioned uh the fourth part is the source of the message so breaking this particular example down",
    "start": "230239",
    "end": "236720"
  },
  {
    "text": "and this is just one that i pulled online and made a couple of changes too the first thing we have is the bitmap",
    "start": "236720",
    "end": "242080"
  },
  {
    "text": "and this one specifies a couple of fields that are present so we're gonna look at the first three of the four that are specified",
    "start": "242080",
    "end": "247680"
  },
  {
    "text": "uh field two which is the primary account number field seven which is the point of service entry mode and",
    "start": "247680",
    "end": "254000"
  },
  {
    "text": "excuse me field 7 which is the transaction date and time and field 22 which is the point of service entry mode",
    "start": "254000",
    "end": "259519"
  },
  {
    "text": "um and if you want to decode a bitmap manually that's a bit too time and sense they're time intensive but there are some",
    "start": "259519",
    "end": "266960"
  },
  {
    "text": "options there on the bottom of the screen for you to take a look at on on your own time most people though just run this through a",
    "start": "266960",
    "end": "272560"
  },
  {
    "text": "decoder and they have it tell them hey these are the fields that are in a message so real quick here you can see data",
    "start": "272560",
    "end": "278320"
  },
  {
    "text": "element two or field two and this is the primary account number the first two digits in this specify how",
    "start": "278320",
    "end": "283840"
  },
  {
    "text": "long the primary account number is and in this case the first two digits are 16. so the next 16 digits are this user's",
    "start": "283840",
    "end": "290320"
  },
  {
    "text": "primary account number and this is just again one from an example online it's of course not a real one",
    "start": "290320",
    "end": "295680"
  },
  {
    "text": "here you can see just a time stamp in utc and finally the point of service entry",
    "start": "295680",
    "end": "301520"
  },
  {
    "text": "mode for this transaction and this one's pretty important for when we get to the windows fast cache malware but this point of service entry",
    "start": "301520",
    "end": "308080"
  },
  {
    "text": "mode is set to 0 1 1. the first two digits in this indicate whether something or indicate",
    "start": "308080",
    "end": "313759"
  },
  {
    "text": "how something was entered into the terminal so in this case this is a manual entry meaning someone typed in the data",
    "start": "313759",
    "end": "320080"
  },
  {
    "text": "but if you look at something where the digits are set to nine zero that",
    "start": "320080",
    "end": "325199"
  },
  {
    "text": "would indicate a card swipe and so there are a couple other options in that regard the last digit in this or",
    "start": "325199",
    "end": "330639"
  },
  {
    "text": "the third digit in the point of service entry mode indicates um whether or not a terminal has pin",
    "start": "330639",
    "end": "336880"
  },
  {
    "text": "capabilities and of course most terminals these days do have pin capabilities but this way the",
    "start": "336880",
    "end": "342400"
  },
  {
    "text": "device doesn't send a message back saying hey can you enter your pin when there's no pin to be entered as sort of a safeguard against that so",
    "start": "342400",
    "end": "350160"
  },
  {
    "text": "those are the core principles that we need to know for working with the fast cash malware now what is the fast cash malware if",
    "start": "350160",
    "end": "356800"
  },
  {
    "text": "you're unfamiliar with this malware family this belongs to a very specific subset of north korean threat actors",
    "start": "356800",
    "end": "362880"
  },
  {
    "text": "that also engage in swift heists sometimes people use fast cash to or they use fast cash as a term for that",
    "start": "362880",
    "end": "369680"
  },
  {
    "text": "threat actor i i wouldn't necessarily recommend that and sometimes people use this term lazarus group for just broad north korean activity but",
    "start": "369680",
    "end": "376479"
  },
  {
    "text": "this malware is tied to a very specific set of activity from north korean threat",
    "start": "376479",
    "end": "384479"
  },
  {
    "text": "actors there's a very small cluster of tools and techniques that go along with what they do",
    "start": "384479",
    "end": "390639"
  },
  {
    "text": "so what this malware does is it is injected into a payment switch and",
    "start": "390639",
    "end": "396800"
  },
  {
    "text": "it is intended to either fraudulently approve uh isolated 583 messages from the attackers",
    "start": "396800",
    "end": "403120"
  },
  {
    "text": "sitting at atms and allow them to withdraw money or if the transaction isn't originating",
    "start": "403120",
    "end": "408639"
  },
  {
    "text": "from an attacker it can transparently pass that transaction to and from the bank and no one would ever know that anything",
    "start": "408639",
    "end": "414319"
  },
  {
    "text": "happens that's the general idea behind this malware family and we're going to look into the reverse engineering and how",
    "start": "414319",
    "end": "419520"
  },
  {
    "text": "this integrates with iso 8583 there are three types that have been",
    "start": "419520",
    "end": "424720"
  },
  {
    "text": "at this point all three are actually in public uh in the public domain we're going to look at two of them we're going to look at",
    "start": "424720",
    "end": "430160"
  },
  {
    "text": "the first aax type which was the one that you assert reported back in i believe 2018 and we're going",
    "start": "430160",
    "end": "435199"
  },
  {
    "text": "to look at the windows type which is one that came out i guess you could say came out or was used last year",
    "start": "435199",
    "end": "441360"
  },
  {
    "text": "now all three of these are tailored to the environments that they work in and the reason for that is that there",
    "start": "441360",
    "end": "448400"
  },
  {
    "text": "are slightly different implementations of iso 8583 depending on your own architecture and depending on",
    "start": "448400",
    "end": "455360"
  },
  {
    "text": "uh the payment provider that you use so whether you use uh visa or mastercard",
    "start": "455360",
    "end": "461360"
  },
  {
    "text": "or star or something along those lines there are going to be some different implementations or",
    "start": "461360",
    "end": "466560"
  },
  {
    "text": "interpretations of the standard so jumping right into the reverse engineering for ax type one if you were",
    "start": "466560",
    "end": "473440"
  },
  {
    "text": "to open the us cert report and then you were to open the sample yourself in ida you're going to see uh just a few small",
    "start": "473440",
    "end": "480000"
  },
  {
    "text": "differences one of them is that the strings that i guess you could say should be there won't be there in your sample and so",
    "start": "480000",
    "end": "485840"
  },
  {
    "text": "this first slide here is just to kind of give you some tips on how you can go and collect those strings you've got to probably",
    "start": "485840",
    "end": "491199"
  },
  {
    "text": "write a script for it but i personally i just did it manually you can go into this section of hex uh look at the offset that it specifies",
    "start": "491199",
    "end": "498240"
  },
  {
    "text": "and what you get is just a pointer to the string that you're supposed to be working with so",
    "start": "498240",
    "end": "503360"
  },
  {
    "text": "this one is actually a debugging message and there are a lot of these there are a lot of debugging and logging",
    "start": "503360",
    "end": "508400"
  },
  {
    "text": "messages within this malware to help the threat actors operate because what they're doing is fairly complex but",
    "start": "508400",
    "end": "514399"
  },
  {
    "text": "we don't need to worry too much about that for the purposes of this talk i've got all of the strings labeled what is uh significantly more",
    "start": "514399",
    "end": "521039"
  },
  {
    "text": "interesting is uh the strings and the interaction for how some of the functions that are",
    "start": "521039",
    "end": "526399"
  },
  {
    "text": "built into the malware are called so on this slide you can see a couple of different function calls and these are",
    "start": "526399",
    "end": "531839"
  },
  {
    "text": "prenamed within the malware there is get field string and set field string on this slide there are a few",
    "start": "531839",
    "end": "537600"
  },
  {
    "text": "others like copy field string all of those are related to interacting with an iso 8583",
    "start": "537600",
    "end": "543519"
  },
  {
    "text": "message and so the important reverse engineering concept that you need when you're looking at one of these is to understand",
    "start": "543519",
    "end": "550880"
  },
  {
    "text": "that there is a pattern for how these work so before set field string is called for",
    "start": "550880",
    "end": "556160"
  },
  {
    "text": "example there is a load into register three for a digit and that digit is going to be the field that is",
    "start": "556160",
    "end": "562800"
  },
  {
    "text": "manipulated and above that there's a load into another register for a string and that's actually the",
    "start": "562800",
    "end": "568560"
  },
  {
    "text": "data that's going to go into that field so as long as you know that pattern you can really do the",
    "start": "568560",
    "end": "573920"
  },
  {
    "text": "reverse engineering for all of this and get field string is very similar there's a load for the fields that is",
    "start": "573920",
    "end": "579920"
  },
  {
    "text": "going to be retrieved but in this case since it's not setting any data there's no data load",
    "start": "579920",
    "end": "586720"
  },
  {
    "text": "once you have all of those principles kind of in mind you can go through and map out how this malware works and so",
    "start": "586720",
    "end": "592720"
  },
  {
    "text": "the way you would read this graph here is from left to right and top to bottom so",
    "start": "592720",
    "end": "598480"
  },
  {
    "text": "you can think of this as again this malware is injected into the payments by entering the software in the payment switch rather",
    "start": "598480",
    "end": "604320"
  },
  {
    "text": "and uh a new iso 8583 message comes in and this will intercept that message and",
    "start": "604320",
    "end": "610320"
  },
  {
    "text": "call this function new read from there it will call check sock and check sock we'll call get ip",
    "start": "610320",
    "end": "615600"
  },
  {
    "text": "init address and it will perform a check for a valid ip to make sure that the message is originating from where it's supposed to",
    "start": "615600",
    "end": "621440"
  },
  {
    "text": "be and then it will move on sequentially down the line to check for flags and then read receive and so on and so forth",
    "start": "621440",
    "end": "627600"
  },
  {
    "text": "we're not going to go into every single one of these we're going to go into some of the important ones for this payment standard",
    "start": "627600",
    "end": "634240"
  },
  {
    "text": "so again the first thing here is a check sock function and i have on the left side of the screen the i guess you could call it like the",
    "start": "634240",
    "end": "640399"
  },
  {
    "text": "overhead for the new read function when check sock is called it performs an",
    "start": "640399",
    "end": "645920"
  },
  {
    "text": "ip address whitelisting check it wants to make sure that the transaction is coming from a valid internal ip address there's nothing too",
    "start": "645920",
    "end": "652880"
  },
  {
    "text": "uh too much to worry about there but as we kind of move along and on the left again on the screen you can see how",
    "start": "652880",
    "end": "658240"
  },
  {
    "text": "we're progressing sort of through this code once it does the white listing check",
    "start": "658240",
    "end": "664959"
  },
  {
    "text": "it's going to retrieve a bunch of information from a couple of different fields so the the fields that it's mainly",
    "start": "664959",
    "end": "671440"
  },
  {
    "text": "interested in at first are the message type identifier the primary account number",
    "start": "671440",
    "end": "677120"
  },
  {
    "text": "the processing code and then it also pulls the advice reason code and depending on what data that it sees",
    "start": "677120",
    "end": "682880"
  },
  {
    "text": "there it has two options it can either transparently pass this message on to the bank because",
    "start": "682880",
    "end": "688000"
  },
  {
    "text": "the primary account number didn't line up with a white list that the threat actor set up for example or some of the fields that were supposed",
    "start": "688000",
    "end": "694079"
  },
  {
    "text": "to be there weren't there and if any of those things are the case it will send that on to the bank and",
    "start": "694079",
    "end": "699519"
  },
  {
    "text": "nothing it will be as though nothing ever happens the bank will send a proper response and that response will go back to the atm",
    "start": "699519",
    "end": "704800"
  },
  {
    "text": "on the other hand if it does see data that it's interested in and we'll dive into the mechanics of that a little bit more in the windows one",
    "start": "704800",
    "end": "710959"
  },
  {
    "text": "it can generate one of three types of responses so here there are generate response transaction 1 and",
    "start": "710959",
    "end": "716079"
  },
  {
    "text": "response transaction 2. and there is also a response inquiry and",
    "start": "716079",
    "end": "721120"
  },
  {
    "text": "i'll dive into those in just a second as well but depending on this fraudulent response that it generates and sends",
    "start": "721120",
    "end": "726880"
  },
  {
    "text": "back to the atms it will assuming all of that works it",
    "start": "726880",
    "end": "731920"
  },
  {
    "text": "will log that it's blocked that message and it will send that response back and then",
    "start": "731920",
    "end": "737120"
  },
  {
    "text": "the process will repeat so diving into transaction type 1 and",
    "start": "737120",
    "end": "742639"
  },
  {
    "text": "transaction type 2 is actually very similar to transaction type 1. um the malware will intercept the",
    "start": "742639",
    "end": "748240"
  },
  {
    "text": "icw8583 message it's going to uh again pull those fields that i had mentioned but then it's also going to copy it'll",
    "start": "748240",
    "end": "754720"
  },
  {
    "text": "dive into this and it'll copy a bunch of data from the original iso 8583 message there are some different fields here and",
    "start": "754720",
    "end": "760880"
  },
  {
    "text": "i've got a full list on the next slide all of the data that it copies it's used to construct the message that's going to",
    "start": "760880",
    "end": "766959"
  },
  {
    "text": "go back to these atms and part of that is because the atms probably although we",
    "start": "766959",
    "end": "772240"
  },
  {
    "text": "don't know for sure but we can we can make an assessment that the atms probably expect to receive data",
    "start": "772240",
    "end": "777920"
  },
  {
    "text": "in a certain way again this is all environment specific stuff so we have to make some inferences about what the threat actor is doing",
    "start": "777920",
    "end": "785279"
  },
  {
    "text": "um so with that in mind uh the fields that it's going to copy are the primary account number",
    "start": "785279",
    "end": "791600"
  },
  {
    "text": "processing code and so on and so forth it's there's a there's a long list of these things here um and then for transaction",
    "start": "791600",
    "end": "797200"
  },
  {
    "text": "type 2 it's the same list but minus a couple of track2 fields now",
    "start": "797200",
    "end": "802320"
  },
  {
    "text": "once it does that it reconstructs the message and sends that back it's going to generate a random balance",
    "start": "802320",
    "end": "809600"
  },
  {
    "text": "for a random transaction amount as part of this process and then the atm will allow the threat act to",
    "start": "809600",
    "end": "815360"
  },
  {
    "text": "withdraw to withdraw cash so the other type of uh response that it",
    "start": "815360",
    "end": "820399"
  },
  {
    "text": "can make here is the inquiry response so this is a response to a balance inquiry if you walk up to an atm and you put",
    "start": "820399",
    "end": "826240"
  },
  {
    "text": "your card in and you say hey how much money do i have this is actually the type of transaction that would come back",
    "start": "826240",
    "end": "832079"
  },
  {
    "text": "now i think the threat actors probably set something like this up to allow them to test their malware",
    "start": "832079",
    "end": "837120"
  },
  {
    "text": "i i can't really think of any other reason for doing something like this but it would be very obvious to a threat",
    "start": "837120",
    "end": "842240"
  },
  {
    "text": "actor if this were working properly with a balance inquiry and you'll see why in just a second",
    "start": "842240",
    "end": "847680"
  },
  {
    "text": "so inside of the balance inquiry it copies fields in a very similar way to that transaction amount but there's also",
    "start": "847680",
    "end": "853120"
  },
  {
    "text": "this format string which i have is kind of the multi-colored thing on the top right there so this format string is",
    "start": "853120",
    "end": "858959"
  },
  {
    "text": "very important it's for determining how uh or it's for the structure of information that's going to",
    "start": "858959",
    "end": "865279"
  },
  {
    "text": "go back into field 54 which is the field that handles all of your account balances and so",
    "start": "865279",
    "end": "871120"
  },
  {
    "text": "breaking this format string down just a little bit we have a three or we have two kind of",
    "start": "871120",
    "end": "876399"
  },
  {
    "text": "non-important items and one very important item so the non-important ones here it will say that the amount",
    "start": "876399",
    "end": "884000"
  },
  {
    "text": "type is set to zero one which indicates that the amount going back is something called a ledger balance for the purposes of this malware uh not",
    "start": "884000",
    "end": "891040"
  },
  {
    "text": "not too important we'll see an available balance a little bit later on but the main thing",
    "start": "891040",
    "end": "896399"
  },
  {
    "text": "here is the currency code and so this currency code is set to 356 which is the",
    "start": "896399",
    "end": "901839"
  },
  {
    "text": "indian rupee and what you can infer from something like that is that for whatever reason",
    "start": "901839",
    "end": "907040"
  },
  {
    "text": "the atms on the receiving end of this expect to receive data in that denomination and so you can make some assumptions and",
    "start": "907040",
    "end": "913760"
  },
  {
    "text": "do some open source research and i can't really go into victimology in a talk like this but",
    "start": "913760",
    "end": "919120"
  },
  {
    "text": "um that will it will make it pretty clear as to why this might be the case and why uh or who",
    "start": "919120",
    "end": "925600"
  },
  {
    "text": "this victim probably was so once those are set there's also a randomized amount of currency that that",
    "start": "925600",
    "end": "932320"
  },
  {
    "text": "goes along with this and that gets sent back to the atms as well as a fraudulent balance inquiry response",
    "start": "932320",
    "end": "938480"
  },
  {
    "text": "so putting all of that together we have injected the malware into the software on a payment switch we",
    "start": "938480",
    "end": "944720"
  },
  {
    "text": "have done some uh preliminary checks uh anytime an iso 8583 message comes in to see if it's one",
    "start": "944720",
    "end": "950800"
  },
  {
    "text": "that we're interested in if it is one that we're interested in we've taken some decision points and we've either passed the transaction on",
    "start": "950800",
    "end": "956880"
  },
  {
    "text": "or we have uh blocks the transaction and sent a fraudulent response either a",
    "start": "956880",
    "end": "962399"
  },
  {
    "text": "fraudulent withdrawal or a fraudulent balance inquiry",
    "start": "962399",
    "end": "968079"
  },
  {
    "text": "again i don't have time to go into type 2 of the aax malware but this graph is here in case you want to reverse engineer it on your own time",
    "start": "968079",
    "end": "974160"
  },
  {
    "text": "if you can reverse the first one you can reverse the second one uh the the concepts are the same there",
    "start": "974160",
    "end": "979519"
  },
  {
    "text": "are just some structural differences and this aax type 2 is sort of a bridge to the windows one and",
    "start": "979519",
    "end": "984800"
  },
  {
    "text": "so from a high level perspective you can uh if you were to look at this graph you would see that a lot of the payment logic has been consolidated",
    "start": "984800",
    "end": "992000"
  },
  {
    "text": "and so that's really what we're going to look at for the windows version as well is how they consolidated and sort of",
    "start": "992000",
    "end": "998079"
  },
  {
    "text": "changed this payment logic so within the windows version",
    "start": "998079",
    "end": "1004480"
  },
  {
    "text": "we have one once all of that same stuff happens a whitelist they've added a blacklisting function in",
    "start": "1004480",
    "end": "1010160"
  },
  {
    "text": "but it's done the ipaddress check it's on all of these decision points it is going to go into what i call the",
    "start": "1010160",
    "end": "1015440"
  },
  {
    "text": "generate response parent it's sort of a new function that was added into this malware so the",
    "start": "1015440",
    "end": "1020480"
  },
  {
    "text": "response parent is responsible for taking in some additional data and doing",
    "start": "1020480",
    "end": "1025520"
  },
  {
    "text": "some additional checks before proceeding with whether or not to generate a fraudulent response the response parent has two checks the",
    "start": "1025520",
    "end": "1032640"
  },
  {
    "text": "first check is that it is going to look for field zero the mti and it's going to check whether or not",
    "start": "1032640",
    "end": "1039120"
  },
  {
    "text": "field zero's third and fourth digit are set to zero zero if we think back to our original",
    "start": "1039120",
    "end": "1044480"
  },
  {
    "text": "example we had a financial message that was zero two hundred and that indicated that something was a",
    "start": "1044480",
    "end": "1050000"
  },
  {
    "text": "financial request so here it's looking to see if something was also 0-200 or 0-100 to indicate",
    "start": "1050000",
    "end": "1056960"
  },
  {
    "text": "hey that's also a request as opposed to if it were 0-10 which would indicate that something was",
    "start": "1056960",
    "end": "1063200"
  },
  {
    "text": "a financial response the malware doesn't want to indic or it doesn't want to intercept a financial response because it wants to just pass",
    "start": "1063200",
    "end": "1069039"
  },
  {
    "text": "that back on to the the device that's expecting that response so that's the first check",
    "start": "1069039",
    "end": "1074960"
  },
  {
    "text": "the second check is for the point of service entry mode now the point of service entry mode",
    "start": "1074960",
    "end": "1080640"
  },
  {
    "text": "again if you think back to that example it's how the data was entered into a terminal and here it's checking that the",
    "start": "1080640",
    "end": "1085679"
  },
  {
    "text": "data in the point of service entry mode field starts with a nine which indicates that this was a car transaction rather",
    "start": "1085679",
    "end": "1090880"
  },
  {
    "text": "than manually entering it and that's just an operational expectation from the threat actor that there aren't people here just manually",
    "start": "1090880",
    "end": "1097679"
  },
  {
    "text": "entering in a whole bunch of data so assuming those tracks pass",
    "start": "1097679",
    "end": "1103520"
  },
  {
    "text": "it will jump into a response workflow and this does there's a little",
    "start": "1103520",
    "end": "1109919"
  },
  {
    "text": "bit of redundancy here but this will again grab the mti and then it's going to grab a whole bunch of fields that you can see here on the screen",
    "start": "1109919",
    "end": "1115440"
  },
  {
    "text": "and the first check here is to just see do these fields have data in them and one of these is field three which is used in uh in just a second as well but for the",
    "start": "1115440",
    "end": "1123039"
  },
  {
    "text": "most part that's all this check is uh concerned with initially and if these fields don't have data in them",
    "start": "1123039",
    "end": "1128160"
  },
  {
    "text": "the malware can't uh or doesn't expect to be able to process this properly and so it's going to exit the",
    "start": "1128160",
    "end": "1133200"
  },
  {
    "text": "it's going to exit this workflow now assuming all those checks are met the next set of",
    "start": "1133200",
    "end": "1138559"
  },
  {
    "text": "uh the next set of logic here is for looking at that processing code which is in field three",
    "start": "1138559",
    "end": "1145120"
  },
  {
    "text": "if the processing code starts with a three that's going to indicate that this is a balance inquiry and we'll see a workflow like we looked at before and",
    "start": "1145120",
    "end": "1151520"
  },
  {
    "text": "that we'll look at again if it starts with a zero it's going to indicate that it needs to do",
    "start": "1151520",
    "end": "1156640"
  },
  {
    "text": "a fraudulent transaction response and then finally if it's none of those things it's going to return",
    "start": "1156640",
    "end": "1164400"
  },
  {
    "text": "an invalid pin response to the user so i have here all three options kind of",
    "start": "1164400",
    "end": "1171440"
  },
  {
    "text": "on the screen and this is how they look in ida if you were to screenshot it out and we see",
    "start": "1171440",
    "end": "1176559"
  },
  {
    "text": "that format string show up again i know it's a little bit hard to see on the graphics so i've kind of put it in multi-color again on this next screen",
    "start": "1176559",
    "end": "1183520"
  },
  {
    "text": "but we have as part of our balance inquiry response instead of the indian rupee we have",
    "start": "1183520",
    "end": "1188880"
  },
  {
    "text": "changed the currency to turkey's currency and that's pretty important again",
    "start": "1188880",
    "end": "1193919"
  },
  {
    "text": "uh this would indicate that for whatever reason and most likely it would be tied to victimology that",
    "start": "1193919",
    "end": "1200320"
  },
  {
    "text": "for whatever reason the malware expects or the 18 the malware expects to interact with an atm",
    "start": "1200320",
    "end": "1205360"
  },
  {
    "text": "that in turn expects the currency to be turkeys and so that's a pretty important threat",
    "start": "1205360",
    "end": "1210400"
  },
  {
    "text": "intelligence factoid there that you can pull out of something like this",
    "start": "1210400",
    "end": "1215440"
  },
  {
    "text": "and and it kind of gives you an idea of how this can be a little bit more victim specific than just something that works",
    "start": "1215440",
    "end": "1221280"
  },
  {
    "text": "everywhere uh and again i have the other the other two options here for one of those responses so",
    "start": "1221280",
    "end": "1227039"
  },
  {
    "text": "that essentially is the fast cache malware i'm next i'm going to kind of jump into extensions for financial",
    "start": "1227039",
    "end": "1232159"
  },
  {
    "text": "services but while i do that i would consider these three points as sort of a frame of reference for comparison so",
    "start": "1232159",
    "end": "1238080"
  },
  {
    "text": "the first point is that a lot of things need to go right uh when you're when you're working with malware like",
    "start": "1238080",
    "end": "1243280"
  },
  {
    "text": "this uh it's pretty challenging to interact with all of these devices at that level and so it",
    "start": "1243280",
    "end": "1249360"
  },
  {
    "text": "interacts with all of these protocols and so when you're doing that and a lot can go wrong and that's why the malware",
    "start": "1249360",
    "end": "1254480"
  },
  {
    "text": "has a whole bunch of logging information inside of it to help the threat actors out i think those are the two main things",
    "start": "1254480",
    "end": "1260400"
  },
  {
    "text": "the other thing is that there are some pretty heavy operational requirements that you need to set up you need programmers that can",
    "start": "1260400",
    "end": "1265600"
  },
  {
    "text": "do this and can make these changes on the fly you also need a network of money mules basically people that are there to",
    "start": "1265600",
    "end": "1271600"
  },
  {
    "text": "withdraw the cash from the atms and so if you're a north korean threat actor not the easiest thing to set up and then",
    "start": "1271600",
    "end": "1277600"
  },
  {
    "text": "finally you need access to this network and you need to get pretty far into the network in order to",
    "start": "1277600",
    "end": "1282720"
  },
  {
    "text": "get access to that payment switch and and to you know take a stab at this so it's pretty challenging but it does allow the",
    "start": "1282720",
    "end": "1289280"
  },
  {
    "text": "threat actors to operate uh the atms without putting anything on the atms",
    "start": "1289280",
    "end": "1294320"
  },
  {
    "text": "and and to do these cache ads so with that in mind the next thing i want to talk about is something called",
    "start": "1294320",
    "end": "1299520"
  },
  {
    "text": "extensions for financial services you can think of this as a standardized api for how",
    "start": "1299520",
    "end": "1304880"
  },
  {
    "text": "software vendors are supposed to write their software for interacting with an atm so any atm you go to is able to withdraw",
    "start": "1304880",
    "end": "1310799"
  },
  {
    "text": "cache it's able to you can actually deposit cache there it has all these blinking lights all of",
    "start": "1310799",
    "end": "1316960"
  },
  {
    "text": "those things go into the extensions for financial services",
    "start": "1316960",
    "end": "1322640"
  },
  {
    "text": "standard and we're actually going to be looking at one called jxfs which is java extensions for financial services",
    "start": "1322640",
    "end": "1329280"
  },
  {
    "text": "now we're going to be looking at this in the context of a specific family but if you're interested more in traditional xfs malware",
    "start": "1329280",
    "end": "1335280"
  },
  {
    "text": "there are some links that i have here and there are a couple common api calls none of these actually appear in this",
    "start": "1335280",
    "end": "1340320"
  },
  {
    "text": "particular family but they are ones that you'll see fairly often uh within other atm malware that's out there",
    "start": "1340320",
    "end": "1346240"
  },
  {
    "text": "but we're interested in this malware family called injects pure now i i can't go too much into the incident",
    "start": "1346240",
    "end": "1351520"
  },
  {
    "text": "that in which this malware was used but this is an atm malware family that relies on both xfs and a proprietary atm",
    "start": "1351520",
    "end": "1359200"
  },
  {
    "text": "implementation the reason i want to go into this is less to talk about how the malware dispenses cash because",
    "start": "1359200",
    "end": "1365919"
  },
  {
    "text": "i think that's been kind of done to death in open source and it's not super interesting what i want to talk about instead is",
    "start": "1365919",
    "end": "1372400"
  },
  {
    "text": "what people can do to an atm once they get this level of access and so that's really the context",
    "start": "1372400",
    "end": "1379039"
  },
  {
    "text": "that we're going to be uh looking at this malware kind of the frame of mind we should have uh and we'll see some pretty interesting",
    "start": "1379039",
    "end": "1384640"
  },
  {
    "text": "capabilities there that aren't necessarily built into this malware but could have been so with inject superior the",
    "start": "1384640",
    "end": "1390720"
  },
  {
    "text": "operators can do some pretty traditional or they can perform some pretty traditional actions of course it's atm malware",
    "start": "1390720",
    "end": "1396080"
  },
  {
    "text": "so they can dispense cache they can query device information and that's really used to kind of",
    "start": "1396080",
    "end": "1403200"
  },
  {
    "text": "find out how much cash is in the atm and they can execute arbitrary code all of those things are pretty common to",
    "start": "1403200",
    "end": "1409760"
  },
  {
    "text": "any atm hour family and honestly aside from dispensing cash they're common to any malware family just in general",
    "start": "1409760",
    "end": "1416559"
  },
  {
    "text": "but we're going to focus or we're going to dial in on the cache dispensing function and the xfs components that follow that",
    "start": "1416559",
    "end": "1423760"
  },
  {
    "text": "if you are interested in a full reverse engineering of it it's again it's been kind of done to death in",
    "start": "1423760",
    "end": "1429039"
  },
  {
    "text": "an open source and so here are three uh just references for that the third one we are actually going to reference again and that one's a very good one and",
    "start": "1429039",
    "end": "1436000"
  },
  {
    "text": "so we'll come back to that but the important thing that you need to know about this malware is that the threat actors",
    "start": "1436000",
    "end": "1441279"
  },
  {
    "text": "uh essentially deployed this malware to a bunch of atms and the malware when it runs it creates",
    "start": "1441279",
    "end": "1448400"
  },
  {
    "text": "an http server and that server can accept get and post requests that carry out those commands",
    "start": "1448400",
    "end": "1454159"
  },
  {
    "text": "that i mentioned before and that's really the core concept there are two workflows to kind of get you to this spot",
    "start": "1454159",
    "end": "1460240"
  },
  {
    "text": "if from from the malware's viewpoint the one we're going to be looking at is the one that is just directly responsible",
    "start": "1460240",
    "end": "1465840"
  },
  {
    "text": "for um all of the different commands so we're going to dial in on the suspension commands but the other ones are up there",
    "start": "1465840",
    "end": "1472400"
  },
  {
    "text": "um this sits within the server that's created and i have that here on the screen basically it opens a listener on a high",
    "start": "1472400",
    "end": "1478640"
  },
  {
    "text": "port and just listens for those requests so within this dispensing commands there",
    "start": "1478640",
    "end": "1484400"
  },
  {
    "text": "are two possible branches that the malware can take it can query i call it querying the device",
    "start": "1484400",
    "end": "1490559"
  },
  {
    "text": "information but it's really querying the cassette information and it can dispense cache and so dialing",
    "start": "1490559",
    "end": "1495919"
  },
  {
    "text": "in just on the first one the query we can see a couple of different xfs callouts here so we have",
    "start": "1495919",
    "end": "1502480"
  },
  {
    "text": "get cash unit we have a dispenser call and we have get number of",
    "start": "1502480",
    "end": "1507919"
  },
  {
    "text": "cash units so these are things where if you're looking at the code these are not standard java calls",
    "start": "1507919",
    "end": "1514240"
  },
  {
    "text": "whereas pretty much everything else is uh and they're not standard javascript calls and again pretty much everything else is in that regard as",
    "start": "1514240",
    "end": "1520320"
  },
  {
    "text": "well so these look like they could be xfs implementations so how do we how do we figure that out",
    "start": "1520320",
    "end": "1526720"
  },
  {
    "text": "well if we take get cash unit and we throw it into the magic google box uh you will get this google book",
    "start": "1526720",
    "end": "1531919"
  },
  {
    "text": "uh it's some sort of atm book i think it's in german it's from like 2004 um and you can see here that uh call to",
    "start": "1531919",
    "end": "1539440"
  },
  {
    "text": "get cash unit within this jxfs implementation within this book will return this.cash",
    "start": "1539440",
    "end": "1544480"
  },
  {
    "text": "unit not super illuminating if you're trying to figure out what this is doing but it at least indicates that this is probably",
    "start": "1544480",
    "end": "1551039"
  },
  {
    "text": "we're probably on the right path to determining that this is xfs so the next stop and probably the the",
    "start": "1551039",
    "end": "1557360"
  },
  {
    "text": "better stop once you know about it is to go to the actual documentation and so if you go to the send documentation and you look at book five",
    "start": "1557360",
    "end": "1564799"
  },
  {
    "text": "uh which holds all of the different uh i guess api calls for this malware or",
    "start": "1564799",
    "end": "1571840"
  },
  {
    "text": "sorry for uh xfs if you go in there and you look for get cash unit you will indeed see an",
    "start": "1571840",
    "end": "1576960"
  },
  {
    "text": "entry in the official documentation for get cash unit and this uh with a little bit more research this",
    "start": "1576960",
    "end": "1582720"
  },
  {
    "text": "essentially returns the information about the money that is stored in the atm in different cassettes and",
    "start": "1582720",
    "end": "1589200"
  },
  {
    "text": "there is there are some differences between how this is written out here and how the malware or sorry yeah how the malware uses it",
    "start": "1589200",
    "end": "1595440"
  },
  {
    "text": "and how the proprietary atm software uses it but essentially uh this you could call",
    "start": "1595440",
    "end": "1601919"
  },
  {
    "text": "this an xfs implementation and i would be comfortable saying that the developers for the atm probably just",
    "start": "1601919",
    "end": "1607120"
  },
  {
    "text": "built their implementation on top of uh on top of xfs rather than in place of xfs so that handles one of",
    "start": "1607120",
    "end": "1615120"
  },
  {
    "text": "the api calls but what about get number of cache units i've got to give a huge shout out to frank baldwin who did a presentation",
    "start": "1615120",
    "end": "1621279"
  },
  {
    "text": "last year more specifically on how this malware works and and the context in which it was used",
    "start": "1621279",
    "end": "1626400"
  },
  {
    "text": "but one of the things he discovered was that the uh atm software as part of the incident response",
    "start": "1626400",
    "end": "1631520"
  },
  {
    "text": "was actually uploaded to virustotal so i'm not going to just paste some all of the vendors code um you know all",
    "start": "1631520",
    "end": "1637200"
  },
  {
    "text": "over the place on here but i'm going to show the relevant things so get cash unit sits within this atms",
    "start": "1637200",
    "end": "1643440"
  },
  {
    "text": "code for peripheral under the context of peripheral notes deposit dot get cash unit",
    "start": "1643440",
    "end": "1648960"
  },
  {
    "text": "and the same goes for get number of cash units and what i want to talk about here is",
    "start": "1648960",
    "end": "1654080"
  },
  {
    "text": "less about what these are doing but and more about uh what the threat actors could have done",
    "start": "1654080",
    "end": "1659840"
  },
  {
    "text": "uh so under that peripheral.notes deposit call are a bunch of other fairly mundane",
    "start": "1659840",
    "end": "1665919"
  },
  {
    "text": "calls in terms of interacting with the atm but they would allow the threat actors to to query a lot of these types of a lot",
    "start": "1665919",
    "end": "1672559"
  },
  {
    "text": "of these types of information so most of these aren't super exciting um there's some extra calls for retrieving more information about the",
    "start": "1672559",
    "end": "1678559"
  },
  {
    "text": "cache units if you haven't heard enough about the cache units uh you can get the media status",
    "start": "1678559",
    "end": "1684159"
  },
  {
    "text": "you can get some other settings nothing too groundbreaking but it does give the thread actors a little bit more information",
    "start": "1684159",
    "end": "1689440"
  },
  {
    "text": "so the next step here if you're interested in thread actor capabilities on an atm is to actually",
    "start": "1689440",
    "end": "1695679"
  },
  {
    "text": "back that up as uh like one notch and instead of looking at peripherals.notes deposit",
    "start": "1695679",
    "end": "1701039"
  },
  {
    "text": "you would look on the atm software for just what the peripherals did and again this is something the threat actors had access to",
    "start": "1701039",
    "end": "1707760"
  },
  {
    "text": "so looking at just the peripheral class instead of notes deposit there are some",
    "start": "1707760",
    "end": "1713279"
  },
  {
    "text": "other options you can call peripherals.screen and peripherals.host.systemservice.pinpad",
    "start": "1713279",
    "end": "1719039"
  },
  {
    "text": "and under each of those are some actions that you can take the most important ones i think are this",
    "start": "1719039",
    "end": "1724159"
  },
  {
    "text": "idea of disabling and enabling keys why might a threat actor want to do something like that well",
    "start": "1724159",
    "end": "1730080"
  },
  {
    "text": "if you're trying to coordinate a cash out what you might want to do is maximize",
    "start": "1730080",
    "end": "1735440"
  },
  {
    "text": "the amount of cash that is actually sitting in an atm and if you just let people use the atm all day you might be sending a money mule to an",
    "start": "1735440",
    "end": "1741600"
  },
  {
    "text": "atm to pick out cash or to pick up cash rather and there might be none in there there might not",
    "start": "1741600",
    "end": "1746880"
  },
  {
    "text": "be as much in there as it could be so this creates an option for threat actors to perhaps",
    "start": "1746880",
    "end": "1752080"
  },
  {
    "text": "disable and enable keys on an atm to stop it from functioning the way it's supposed to so that other people try and use it and",
    "start": "1752080",
    "end": "1758000"
  },
  {
    "text": "have to walk away from it um that is sort of a high variance strategy because if you",
    "start": "1758000",
    "end": "1763200"
  },
  {
    "text": "have an atm that's not working you raise the risk that someone's going to go look at it but depending on how you're timing this",
    "start": "1763200",
    "end": "1768960"
  },
  {
    "text": "if you do that say late at night or earlier in the morning those are some options that a threat actor could take if they're willing to kind of roll the",
    "start": "1768960",
    "end": "1774960"
  },
  {
    "text": "dice a little bit on how much money they're taking out there are some other things that i haven't listed here they're a bit more",
    "start": "1774960",
    "end": "1780480"
  },
  {
    "text": "mundane one is you know the blinking blinking lights on an atm you can make those blank all you want but from a",
    "start": "1780480",
    "end": "1787360"
  },
  {
    "text": "security standpoint you know go for it we're more worried about people taking the money out i think",
    "start": "1787360",
    "end": "1793600"
  },
  {
    "text": "but those i think that really speaks to the capabilities that a threat actor has there so kind of just circling back on um",
    "start": "1793600",
    "end": "1802000"
  },
  {
    "text": "or kind of closing the loop on the rest of this we have uh one other part of the dispense",
    "start": "1802000",
    "end": "1807360"
  },
  {
    "text": "function which is just the actual dispensing of cash and so dispense itself is possibly an",
    "start": "1807360",
    "end": "1813919"
  },
  {
    "text": "xfs implementation i can find it in the documentation but it's implemented um",
    "start": "1813919",
    "end": "1819440"
  },
  {
    "text": "significantly differently i think within the proprietary code that that's available so it's a little bit unclear if this one",
    "start": "1819440",
    "end": "1826320"
  },
  {
    "text": "is built on top of xfs or built in place of xfs but again it you know it speaks to the",
    "start": "1826320",
    "end": "1831520"
  },
  {
    "text": "threat actor capabilities when they're interacting with a device like this and so that is really what i wanted to",
    "start": "1831520",
    "end": "1837840"
  },
  {
    "text": "talk about from the extensions for financial services approach so if we think about the fast cash malware and we think about this",
    "start": "1837840",
    "end": "1843440"
  },
  {
    "text": "kind of in the same context in fast cash we were able to send people to an atm and they would",
    "start": "1843440",
    "end": "1850799"
  },
  {
    "text": "you know run a card into it and as long as it's one of the threat actors cards it would fraudulently approve a transaction",
    "start": "1850799",
    "end": "1856640"
  },
  {
    "text": "here we have a threat actor who developed proprietary malware um they were the way this works is they",
    "start": "1856640",
    "end": "1864799"
  },
  {
    "text": "would have sent people to those atms at a specified time to have the cash uh come out of an atm and you know via",
    "start": "1864799",
    "end": "1871760"
  },
  {
    "text": "post request and then they would withdraw that cash themselves and so that's sort of the comparison approach there one of the problems here",
    "start": "1871760",
    "end": "1877919"
  },
  {
    "text": "is there's some increased development time because they had to develop malware specific for this atm",
    "start": "1877919",
    "end": "1884559"
  },
  {
    "text": "and they also had to work with some proprietary implementations when they did that that might not necessarily be documented so that's a little bit challenging and",
    "start": "1884559",
    "end": "1890880"
  },
  {
    "text": "testing's always a little bit challenging um and so those are some of the things that kind of come up there but",
    "start": "1890880",
    "end": "1896080"
  },
  {
    "text": "you know ultimately they did have the opportunity to run an attack like this and so",
    "start": "1896080",
    "end": "1902559"
  },
  {
    "text": "with that i will teleport myself back to the future and back to another room and i'll have just this slide up there",
    "start": "1902559",
    "end": "1908240"
  },
  {
    "text": "if you want to see some concluding thoughts but at this point uh thank you for listening to my talk and i'm happy to take as many questions",
    "start": "1908240",
    "end": "1913519"
  },
  {
    "text": "as i can all right so first of all thank you all",
    "start": "1913519",
    "end": "1919519"
  },
  {
    "text": "uh there are two things i want to just uh mention before i go into a couple of the questions that came up during the talk",
    "start": "1919519",
    "end": "1925600"
  },
  {
    "text": "the first is there is a slight slight error on one of the slides which is data element 60 i have listed as being the advice",
    "start": "1925600",
    "end": "1933120"
  },
  {
    "text": "reason code that is the advice reason code uh for certain payment switches but not all of them that's actually a private",
    "start": "1933120",
    "end": "1938399"
  },
  {
    "text": "reserve field that is corrected than the slides that are uh going to be uploaded the second thing i would mention",
    "start": "1938399",
    "end": "1944080"
  },
  {
    "text": "is that there's white paper that covers a little bit more on ax type 2 and also has some of the",
    "start": "1944080",
    "end": "1950399"
  },
  {
    "text": "some additional context and tooling listed so feel free to check that out when that goes up online tonight",
    "start": "1950399",
    "end": "1956159"
  },
  {
    "text": "there are a couple of questions that came in and we're on about uh 45 second delay here so if you hear",
    "start": "1956159",
    "end": "1962000"
  },
  {
    "text": "me say this and you have a question it means you should type it um one of the questions that came up is",
    "start": "1962000",
    "end": "1967519"
  },
  {
    "text": "can i elaborate on what a payment switch is so that's a great question i probably could have done a little bit of a better job on that a payment switch",
    "start": "1967519",
    "end": "1974320"
  },
  {
    "text": "is a device that sits in between uh all of the payment devices and a bank",
    "start": "1974320",
    "end": "1981360"
  },
  {
    "text": "that needs to approve transactions so um you've got atms and you've got",
    "start": "1981360",
    "end": "1988960"
  },
  {
    "text": "uh your grocery store point of sale devices and this payment switch will process all of the messages coming into those and decide whether or not to",
    "start": "1988960",
    "end": "1995600"
  },
  {
    "text": "forward those onto a bank and then when the bank decides whether or not it wants to approve or disapprove",
    "start": "1995600",
    "end": "2001440"
  },
  {
    "text": "a transaction request it'll send that to the payment switch and the payment switch will send it out it's a way of just processing all of the different",
    "start": "2001440",
    "end": "2007120"
  },
  {
    "text": "types of data that are coming in and so that's why it's so important to the ecosystem so another good question",
    "start": "2007120",
    "end": "2012559"
  },
  {
    "text": "that came up was well should we just change the iso 8583 standard i would never recommend that and it",
    "start": "2012559",
    "end": "2017600"
  },
  {
    "text": "would also be impossible even if i thought that were a good idea um but the iso 8583 standard is the card",
    "start": "2017600",
    "end": "2022960"
  },
  {
    "text": "payment standard for absolutely everything um there are some things that go along with card payments",
    "start": "2022960",
    "end": "2028640"
  },
  {
    "text": "um such as",
    "start": "2028640",
    "end": "2033840"
  },
  {
    "text": "like envy transactions for for example and that was something i thought someone uh might ask and i think this is kind of",
    "start": "2033840",
    "end": "2039360"
  },
  {
    "text": "related to it um there are different ways to do these car transactions that could randomize the",
    "start": "2039360",
    "end": "2044799"
  },
  {
    "text": "data um but ultimately um and and by randomizing it i mean they might make",
    "start": "2044799",
    "end": "2050240"
  },
  {
    "text": "it less predictable for what's supposed to be going back to an atm so those things might make it harder to",
    "start": "2050240",
    "end": "2057040"
  },
  {
    "text": "do these types of attacks but ultimately what's happening here is that the payment switch is compromised",
    "start": "2057040",
    "end": "2062158"
  },
  {
    "text": "and there's nothing wrong at all with the payment standard being used the atms are",
    "start": "2062159",
    "end": "2067440"
  },
  {
    "text": "working the way they're supposed to be in a very real sense they're processing these messages",
    "start": "2067440",
    "end": "2072800"
  },
  {
    "text": "so that rolls into the next thing which was um i think uh cat was the one that asked",
    "start": "2072800",
    "end": "2078320"
  },
  {
    "text": "how do you even detect an attack like this uh the i don't give official recommendations but",
    "start": "2078320",
    "end": "2084560"
  },
  {
    "text": "um i touch on this a little bit in the white paper all of the",
    "start": "2084560",
    "end": "2089599"
  },
  {
    "text": "mechanisms for getting to this point where your payments which is compromised all of those are or almost all of the",
    "start": "2089599",
    "end": "2096398"
  },
  {
    "text": "tooling used by this threat actor the fast cash threat actor specifically involves powershell it involves",
    "start": "2096399",
    "end": "2102400"
  },
  {
    "text": "scheduled tasks or created services and those are all pretty standard things that you can and should be looking for in in your enterprise so if you've got",
    "start": "2102400",
    "end": "2109040"
  },
  {
    "text": "that kind of endpoint detection uh then it just becomes a question of identifying uh those anomalies and",
    "start": "2109040",
    "end": "2115040"
  },
  {
    "text": "and having the right analysts and having those analysts do the right analysis on all of those things so uh by the time",
    "start": "2115040",
    "end": "2122320"
  },
  {
    "text": "it gets to the payment switch and this cash out happens you'll detect it because the money will you know all your atms will be empty all of a sudden",
    "start": "2122320",
    "end": "2128160"
  },
  {
    "text": "um and so you don't the idea is to stop it before it gets to that point it's i'm probably not supposed to say it's too late but it is basically too",
    "start": "2128160",
    "end": "2134480"
  },
  {
    "text": "late at that stage um now um i have another question here",
    "start": "2134480",
    "end": "2139760"
  },
  {
    "text": "from sean which is how does injects pure actually get on to a payment switch for the atm so indrex pure doesn't get onto",
    "start": "2139760",
    "end": "2145359"
  },
  {
    "text": "a payment switch and i think that's good to touch on too um injects pure is a",
    "start": "2145359",
    "end": "2151520"
  },
  {
    "text": "different adversaries uh method this is a latin america adversary i can't really",
    "start": "2151520",
    "end": "2156720"
  },
  {
    "text": "talk about the context for a couple different reasons but um they deployed of the malware",
    "start": "2156720",
    "end": "2161920"
  },
  {
    "text": "um directly onto the atms i don't think i can really",
    "start": "2161920",
    "end": "2168079"
  },
  {
    "text": "disclose how they did that but i can tell you that that's not a novel like a full atm hour",
    "start": "2168079",
    "end": "2173760"
  },
  {
    "text": "deployment is not necessarily a novel technique um so thinking about one that's in open",
    "start": "2173760",
    "end": "2178960"
  },
  {
    "text": "source uh if you can read korean um a couple years ago there was there was one in south korea",
    "start": "2178960",
    "end": "2184560"
  },
  {
    "text": "where there was an issue where they used i think the anti-virus management tool to deploy malware to a",
    "start": "2184560",
    "end": "2191040"
  },
  {
    "text": "bunch of atms so i'm not going to comment on whether or not that's what happened here",
    "start": "2191040",
    "end": "2196240"
  },
  {
    "text": "but that's the type of attack you're looking at to get that there now what that means though and the difference between these two attacks is that",
    "start": "2196240",
    "end": "2202079"
  },
  {
    "text": "someone's got to be there to pick up that cache that's getting automatically dispensed and if you go on twitter you can see some examples of uh where someone wasn't",
    "start": "2202079",
    "end": "2209680"
  },
  {
    "text": "there and cash just got like spat out onto the ground um so i wanted to touch on that and clarify",
    "start": "2209680",
    "end": "2217200"
  },
  {
    "text": "that um i know that question wasn't too late um i think that uh there's one other thing",
    "start": "2217200",
    "end": "2224480"
  },
  {
    "text": "i did want to talk about here which is um you know so we've got all this",
    "start": "2224480",
    "end": "2230000"
  },
  {
    "text": "technical intelligence and i've got kind of a minute or two to touch on this like how does um how does all of this like fit into a",
    "start": "2230000",
    "end": "2236160"
  },
  {
    "text": "threat intelligence picture so it's not enough to just track that uh there are all these",
    "start": "2236160",
    "end": "2243040"
  },
  {
    "text": "technical characteristics of this malware and to understand how it works you certainly need to do that but you also need",
    "start": "2243040",
    "end": "2248640"
  },
  {
    "text": "if you're in this industry to be um doing really good collection with uh",
    "start": "2248640",
    "end": "2254560"
  },
  {
    "text": "other peer financial institutions because this data is rare and these attacks are rare um but they're so impactful so that will",
    "start": "2254560",
    "end": "2262560"
  },
  {
    "text": "help you build an operational picture out of it and it will also help you build a strategic intelligence picture in terms",
    "start": "2262560",
    "end": "2268480"
  },
  {
    "text": "of starting to make business decisions or starting to make security level decisions at a bigger scale",
    "start": "2268480",
    "end": "2273839"
  },
  {
    "text": "um on on these types of topics and with that i think we have uh run through",
    "start": "2273839",
    "end": "2279280"
  },
  {
    "text": "questions and i think we are about out of time so i just want to say thanks again for everyone for tuning into this i know",
    "start": "2279280",
    "end": "2284720"
  },
  {
    "text": "it's tough to sit through a lot of webcasts but it really means a lot to me and i really appreciate it so thank you",
    "start": "2284720",
    "end": "2293200"
  }
]