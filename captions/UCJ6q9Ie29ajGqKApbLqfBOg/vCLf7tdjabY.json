[
  {
    "start": "0",
    "end": "90000"
  },
  {
    "text": "good afternoon welcome to Pangu nine internals in South Seas CDF with tally",
    "start": "0",
    "end": "7020"
  },
  {
    "text": "wan and how shoe before we begin a few brief notes stop by the business hall",
    "start": "7020",
    "end": "13049"
  },
  {
    "text": "located in Bayside a be the black hat Arsenal is on the palm foyer on level",
    "start": "13049",
    "end": "18390"
  },
  {
    "text": "three and of course the Arsenal reception at 1700 hours if you haven't",
    "start": "18390",
    "end": "23670"
  },
  {
    "text": "picked up your merchandise today is your last chance to visit the black cap swag and book store visit the Kali Linux lab",
    "start": "23670",
    "end": "30960"
  },
  {
    "text": "in Mandalay Bay a thanks for putting your phone on vibrate it makes it easier",
    "start": "30960",
    "end": "36809"
  },
  {
    "text": "for the rest of us to ignore the ringing while you wait for your voicemail to pick up and with that we welcome our",
    "start": "36809",
    "end": "42690"
  },
  {
    "text": "speakers thank you thank you very much",
    "start": "42690",
    "end": "52110"
  },
  {
    "text": "for coming to our talk my name is Talia and that they say is how free we are from Tim Pangu so is it in this talk we",
    "start": "52110",
    "end": "59160"
  },
  {
    "text": "are going to introduce the van abilities and exports we used in penguin I which",
    "start": "59160",
    "end": "64320"
  },
  {
    "text": "is the only publicly available g2 for OS 9 and because penguin I had multiple",
    "start": "64320",
    "end": "70619"
  },
  {
    "text": "warrants today let's talk mainly focus on the initial one which is for iOS 9.2",
    "start": "70619",
    "end": "76409"
  },
  {
    "text": "arrow and",
    "start": "76409",
    "end": "79700"
  },
  {
    "text": "okay so this is the outline of the talk and the painting out like quickly goes",
    "start": "89229",
    "end": "94570"
  },
  {
    "start": "90000",
    "end": "155000"
  },
  {
    "text": "through the airways security architecture and remember after our talk there will be a talk from at home which",
    "start": "94570",
    "end": "101740"
  },
  {
    "text": "will discuss more our security so please refer to that talk for more details on",
    "start": "101740",
    "end": "107409"
  },
  {
    "text": "our security and after that I will give a quick overview on Panguna",
    "start": "107409",
    "end": "112810"
  },
  {
    "text": "I will explain how we design the export Ching and after and I will elaborates",
    "start": "112810",
    "end": "119289"
  },
  {
    "text": "the userland vulnerabilities and exploits and the whole will continue to introduce the",
    "start": "119289",
    "end": "125470"
  },
  {
    "text": "coronoid spots especially we will discuss how we patch the kernel in the",
    "start": "125470",
    "end": "130899"
  },
  {
    "text": "existence of PPP as new as kernel patching protection which is hardware",
    "start": "130899",
    "end": "136180"
  },
  {
    "text": "based kernel integrity protection mechanism and the most beautiful part is how to",
    "start": "136180",
    "end": "143880"
  },
  {
    "text": "Panguna achieves the persistent co-signing bypass and we will give the",
    "start": "143880",
    "end": "149590"
  },
  {
    "text": "details of that part and finally we will conclude talk and answer your questions",
    "start": "149590",
    "end": "155459"
  },
  {
    "start": "155000",
    "end": "196000"
  },
  {
    "text": "so a little bit more about us so Kim panko is a security research team based",
    "start": "155459",
    "end": "162220"
  },
  {
    "text": "in Shanghai China the team actually we have like seven members we have very",
    "start": "162220",
    "end": "169600"
  },
  {
    "text": "broad research interest but the team is known for release into practice and we",
    "start": "169600",
    "end": "175150"
  },
  {
    "text": "already did that for four times I think and we regularly present our research",
    "start": "175150",
    "end": "182230"
  },
  {
    "text": "and different conference like black height and sequester and so on and same time we also run a mobile security",
    "start": "182230",
    "end": "188829"
  },
  {
    "text": "conference named mosaic and Shanghai so you can check the website for more",
    "start": "188829",
    "end": "194680"
  },
  {
    "text": "information in general I app who release a bad paper",
    "start": "194680",
    "end": "201760"
  },
  {
    "start": "196000",
    "end": "280000"
  },
  {
    "text": "to explain the iOS security architecture and the by design",
    "start": "201760",
    "end": "207609"
  },
  {
    "text": "I say it's very good it has secured Putin chain and iOS is also known for",
    "start": "207609",
    "end": "213910"
  },
  {
    "text": "the mandatory code signing which means the co only the code signed by Apple or",
    "start": "213910",
    "end": "219340"
  },
  {
    "text": "by the sort of a certificate issued by Apple is able to run on the iOS device and in",
    "start": "219340",
    "end": "227000"
  },
  {
    "text": "terms of sandbox yes it's also very restricted any app you download it from",
    "start": "227000",
    "end": "232640"
  },
  {
    "text": "App Store or if you were a developer you you create your own app it it will run",
    "start": "232640",
    "end": "239810"
  },
  {
    "text": "in the various restricted containers and the box has very limited access to the",
    "start": "239810",
    "end": "245360"
  },
  {
    "text": "system and in terms of exploit mitigation iOS has both hakuna site and",
    "start": "245360",
    "end": "252500"
  },
  {
    "text": "userland address lily raft randomization and also the ninth Cubo not writable",
    "start": "252500",
    "end": "260780"
  },
  {
    "text": "copper pad and in also for on 64-bit",
    "start": "260780",
    "end": "268010"
  },
  {
    "text": "device Apple applies boots the hypervisor technology and securing",
    "start": "268010",
    "end": "275210"
  },
  {
    "text": "cleave processor a separate chip to improve the security now let's see how",
    "start": "275210",
    "end": "283010"
  },
  {
    "start": "280000",
    "end": "338000"
  },
  {
    "text": "it is done Panguna and so just in case",
    "start": "283010",
    "end": "289280"
  },
  {
    "text": "some people here have new idea about what jailbreak means ok so tell me how",
    "start": "289280",
    "end": "295610"
  },
  {
    "text": "is a process to remove some software restrictions by OS I actually we know",
    "start": "295610",
    "end": "302870"
  },
  {
    "text": "there are a lot of security mechanisms we just described like code signing",
    "start": "302870",
    "end": "308380"
  },
  {
    "text": "sandbox and there's no root access to the you can you don't have the root",
    "start": "308380",
    "end": "314660"
  },
  {
    "text": "access to the filesystem and so on so basically jariabek has to rely on kernel",
    "start": "314660",
    "end": "321260"
  },
  {
    "text": "expose to disable all to achieve the goal because many such restrictions",
    "start": "321260",
    "end": "328550"
  },
  {
    "text": "enforced by the kernel so in other words what very important thing for Tobruk is",
    "start": "328550",
    "end": "334880"
  },
  {
    "text": "to do the kernel sports so with with this goal in mind we use this figure to",
    "start": "334880",
    "end": "342740"
  },
  {
    "start": "338000",
    "end": "407000"
  },
  {
    "text": "demonstrate as a trade-off between the difficulty of gaining kind of code",
    "start": "342740",
    "end": "348590"
  },
  {
    "text": "execution privilege versus the amount of the kind of a tank surface again let me",
    "start": "348590",
    "end": "354169"
  },
  {
    "text": "explain the figure a little bit more so let's say you are a developer you",
    "start": "354169",
    "end": "359300"
  },
  {
    "text": "create your own app you run it on the iOS device so your app will run as",
    "start": "359300",
    "end": "364460"
  },
  {
    "text": "mobile in the container sandbox so it's very easy for you to gain the code",
    "start": "364460",
    "end": "370070"
  },
  {
    "text": "execution at mobile but you will also get a very limited kernel attack surface",
    "start": "370070",
    "end": "376729"
  },
  {
    "text": "because if your app runs in containers and box you can only talk with very",
    "start": "376729",
    "end": "382190"
  },
  {
    "text": "limited kernel tensions that means many many abilities are not reachable in the",
    "start": "382190",
    "end": "387500"
  },
  {
    "text": "container and assume if you are able to get good as QT as root and even be able",
    "start": "387500",
    "end": "393530"
  },
  {
    "text": "to like you can specify the entitlement of the program yes you almost scheduled a full colonel attack surface but at the",
    "start": "393530",
    "end": "401930"
  },
  {
    "text": "same time it's very hard to achieve code execution as you'd so for a long time",
    "start": "401930",
    "end": "409150"
  },
  {
    "text": "according to daemon abilities we had we prefer to run our code after sandbox",
    "start": "409150",
    "end": "415850"
  },
  {
    "text": "even at mobile so mobile root is not a big issue so if we are able to run our",
    "start": "415850",
    "end": "421729"
  },
  {
    "text": "code after sandbox we can export what the kernel imitates we had so that the",
    "start": "421729",
    "end": "428780"
  },
  {
    "text": "two those are our preferred so the order",
    "start": "428780",
    "end": "435470"
  },
  {
    "start": "432000",
    "end": "496000"
  },
  {
    "text": "to run code after sandbox our initial ID are in penguin 7 ways if we are able to",
    "start": "435470",
    "end": "441800"
  },
  {
    "text": "set this kind of environment give our variable called diva LD search libraries",
    "start": "441800",
    "end": "447699"
  },
  {
    "text": "somehow we are able to insert our own dynamic library into a system sub",
    "start": "447699",
    "end": "453349"
  },
  {
    "text": "progress if we are able to launch that program this in mark verbal is very",
    "start": "453349",
    "end": "459080"
  },
  {
    "text": "similar to like load preload one on Linux so basically it will tell that an",
    "start": "459080",
    "end": "465199"
  },
  {
    "text": "MK loader so you should load this kind of libraries first before you run the program so in penguin say we use this",
    "start": "465199",
    "end": "473479"
  },
  {
    "text": "trick to inject a library into time DTMB a system process and that library is",
    "start": "473479",
    "end": "481190"
  },
  {
    "text": "signed by a kind of expire license as a result our library joins in the",
    "start": "481190",
    "end": "488460"
  },
  {
    "text": "text of Tandy and continue to explore to the kernel so it's like it seems very",
    "start": "488460",
    "end": "494850"
  },
  {
    "text": "easy right but since as oh Sh Apple made a big change",
    "start": "494850",
    "end": "500490"
  },
  {
    "start": "496000",
    "end": "582000"
  },
  {
    "text": "so to kill this kind of it's exploitation technique actually introduced a new security enforcement",
    "start": "500490",
    "end": "507060"
  },
  {
    "text": "called team ID validation so basically timid east from the dishes idea is this",
    "start": "507060",
    "end": "513959"
  },
  {
    "text": "when you lose a library the kernel will check who created the library there is",
    "start": "513959",
    "end": "520770"
  },
  {
    "text": "the ID information is impounded in the library which is not changeable and the",
    "start": "520770",
    "end": "527520"
  },
  {
    "text": "kernel will check whether the the the ID of the main a suitable match the idea of",
    "start": "527520",
    "end": "534360"
  },
  {
    "text": "the library if when it's cutable it's created by Apple but the library created",
    "start": "534360",
    "end": "540510"
  },
  {
    "text": "from a third party in that case the colonel won't allow the process to load",
    "start": "540510",
    "end": "546089"
  },
  {
    "text": "and library so basically team ID can prevent system services from loading the third-party",
    "start": "546089",
    "end": "552779"
  },
  {
    "text": "libraries and there is some exceptional case when we reverse engineered the apps",
    "start": "552779",
    "end": "559350"
  },
  {
    "text": "I was kernel we find when the kernel applies the team ID validation it checks",
    "start": "559350",
    "end": "565740"
  },
  {
    "text": "a special attachment called comp dot app without probate skip library validation",
    "start": "565740",
    "end": "571500"
  },
  {
    "text": "so by the name you can guess what it used for so if the may excusable has this interment then it's allowed to load any",
    "start": "571500",
    "end": "579029"
  },
  {
    "text": "debris so who has this indictment we grab two thus the entitlement hung iOS",
    "start": "579029",
    "end": "585839"
  },
  {
    "start": "582000",
    "end": "650000"
  },
  {
    "text": "root filesystem and yes we fund there's program called any agent it's a network",
    "start": "585839",
    "end": "592500"
  },
  {
    "text": "extension some something which happens to have this environment so now things",
    "start": "592500",
    "end": "598760"
  },
  {
    "text": "become easier so what we did in Pangu 8 is we Mont",
    "start": "598760",
    "end": "604490"
  },
  {
    "text": "developer disk image into the iOS device so we have the back server the back",
    "start": "604490",
    "end": "611190"
  },
  {
    "text": "sorry it is it designed for developers so you create your program you want to",
    "start": "611190",
    "end": "616740"
  },
  {
    "text": "debug it on the iOS device so you among to the the bug image you then the accelerator",
    "start": "616740",
    "end": "624450"
  },
  {
    "text": "available so what we did is we marked the depart so so when the departure is",
    "start": "624450",
    "end": "629820"
  },
  {
    "text": "available we asked it to launch any agent rather than the program we create",
    "start": "629820",
    "end": "635460"
  },
  {
    "text": "and we at same time we specify the divide insert libraries environment",
    "start": "635460",
    "end": "640980"
  },
  {
    "text": "variable and so we're in the agent launched it lost our library our library",
    "start": "640980",
    "end": "646440"
  },
  {
    "text": "continues to approach the chronometer politics yes we can win the game but",
    "start": "646440",
    "end": "652950"
  },
  {
    "start": "650000",
    "end": "704000"
  },
  {
    "text": "since iOS 8.3 there are more and more restrictions in iOS 8.3 I always starts",
    "start": "652950",
    "end": "662820"
  },
  {
    "text": "to ignore the DAO tmartn verbose if you check the source code of dll do if you",
    "start": "662820",
    "end": "668700"
  },
  {
    "text": "reverse engineered the banner you will see that unless the main excusable has",
    "start": "668700",
    "end": "674280"
  },
  {
    "text": "this special environmental code get Pascal ow it won't use any environment",
    "start": "674280",
    "end": "680640"
  },
  {
    "text": "de Velde in our environment variable so we checked any Aiden's indictment",
    "start": "680640",
    "end": "688730"
  },
  {
    "text": "unfortunately anything doesn't have this entitlement so even even AE editor is",
    "start": "688730",
    "end": "695820"
  },
  {
    "text": "allowed to load up free library we are not able to force it to load hours so it",
    "start": "695820",
    "end": "703320"
  },
  {
    "text": "useless animal and now what's a",
    "start": "703320",
    "end": "709230"
  },
  {
    "start": "704000",
    "end": "740000"
  },
  {
    "text": "challenge for us for penguin 9 so and at the moment the main ability we had",
    "start": "709230",
    "end": "715760"
  },
  {
    "text": "cannot explore cannot be explored both inside the container so we still need to",
    "start": "715760",
    "end": "721170"
  },
  {
    "text": "instant inject a dynamic library into a system service and on the Kunisada we",
    "start": "721170",
    "end": "728730"
  },
  {
    "text": "notice that since iOS 9 there the key block Appa is enabled kernel patching",
    "start": "728730",
    "end": "735900"
  },
  {
    "text": "protection so we need to bypass that now",
    "start": "735900",
    "end": "741720"
  },
  {
    "start": "740000",
    "end": "763000"
  },
  {
    "text": "let's go through the user land part in this part I will introduce two on",
    "start": "741720",
    "end": "747480"
  },
  {
    "text": "abilities one is only to actual file read and write as mobile through",
    "start": "747480",
    "end": "755130"
  },
  {
    "text": "of inter-process communication tenure and the second one is up to recruit",
    "start": "755130",
    "end": "761280"
  },
  {
    "text": "execution after the sandbox so if you guys went to our talk last year at black",
    "start": "761280",
    "end": "768030"
  },
  {
    "text": "hat you mean remember that last year we already talked about the XP security on",
    "start": "768030",
    "end": "774540"
  },
  {
    "text": "iOS XP see is is a new kind of inter",
    "start": "774540",
    "end": "780570"
  },
  {
    "start": "775000",
    "end": "795000"
  },
  {
    "text": "process communication method otherwise it was introduced in 2011 in iOS 5",
    "start": "780570",
    "end": "788450"
  },
  {
    "text": "basically the application can talk with some system services through the ax PC",
    "start": "788450",
    "end": "794010"
  },
  {
    "text": "channel and this piece of code Emma Street how we like a slower on the on",
    "start": "794010",
    "end": "801600"
  },
  {
    "start": "795000",
    "end": "818000"
  },
  {
    "text": "the ice so basically the first API is used to tell the system hey I'm running",
    "start": "801600",
    "end": "807060"
  },
  {
    "text": "this server and this is the name and after that use set up some even handler",
    "start": "807060",
    "end": "813540"
  },
  {
    "text": "at the message handler than UI but you are ready to receive messages and this",
    "start": "813540",
    "end": "819510"
  },
  {
    "text": "is demo for the client side the first you still use the first API with",
    "start": "819510",
    "end": "824940"
  },
  {
    "text": "different parameters you tell the system hey I'm going to talk with this server",
    "start": "824940",
    "end": "830160"
  },
  {
    "text": "please make a connection and then you can build the explicit detection array",
    "start": "830160",
    "end": "836670"
  },
  {
    "text": "this is a format of the message and send it to a server so it's pretty easy and",
    "start": "836670",
    "end": "842330"
  },
  {
    "text": "last year we talked about some vulnerabilities in the explicit service and one of them is this one so we found",
    "start": "842330",
    "end": "851610"
  },
  {
    "text": "an even better EE a set D which is",
    "start": "851610",
    "end": "856730"
  },
  {
    "text": "services called calm a poor persistent UI or translator dot keep it keep her",
    "start": "856730",
    "end": "863760"
  },
  {
    "text": "anyway so this services is related to",
    "start": "863760",
    "end": "868950"
  },
  {
    "text": "the photo and some other things and the",
    "start": "868950",
    "end": "874110"
  },
  {
    "text": "program has a method which is in vocable by any container application so the",
    "start": "874110",
    "end": "879450"
  },
  {
    "text": "method is supposed to move a file or a directory and the specified path to a",
    "start": "879450",
    "end": "886500"
  },
  {
    "text": "new location under the the we're mobile media TCM a so but if",
    "start": "886500",
    "end": "894490"
  },
  {
    "text": "you look at how the file move implement head you will don't laugh okay so",
    "start": "894490",
    "end": "902190"
  },
  {
    "text": "basically from the axe PC message the program retrieves sauce pass and the",
    "start": "902190",
    "end": "908920"
  },
  {
    "text": "tester sub D are and then come for the test dr there is some string operation",
    "start": "908920",
    "end": "916060"
  },
  {
    "text": "is just to put two string together apparently there's new any validation on",
    "start": "916060",
    "end": "922450"
  },
  {
    "text": "the two strings so it's very easy to use dot dot slash trick to traverse the pass",
    "start": "922450",
    "end": "928170"
  },
  {
    "text": "so so far these are a piece of the POC code use this piece of code you are able",
    "start": "928170",
    "end": "934570"
  },
  {
    "text": "to move or read anything you want and so apparently it's very easy to do actual",
    "start": "934570",
    "end": "941410"
  },
  {
    "text": "file read and write you just move some file you want with to your local directory a great edge and you can also",
    "start": "941410",
    "end": "949150"
  },
  {
    "text": "move it back so you can write it and the the even good thing the better thing is",
    "start": "949150",
    "end": "956290"
  },
  {
    "text": "that services itself doesn't have any sandbox limitation so up for our great",
    "start": "956290",
    "end": "966210"
  },
  {
    "text": "directly results in privacy leaks right so if the pro if you downloaded a",
    "start": "966210",
    "end": "971980"
  },
  {
    "text": "malicious application from app store and that that that malicious app uses for it",
    "start": "971980",
    "end": "977740"
  },
  {
    "text": "it can easily get your message we are photo whatever you have in your phone and absolute file writes even worse if",
    "start": "977740",
    "end": "987030"
  },
  {
    "text": "you guys are familiar with this talk my job by Mac dong and you Lucas looks Khan",
    "start": "987030",
    "end": "996010"
  },
  {
    "text": "last year with that talk demonstrate how to transform a actual file right into",
    "start": "996010",
    "end": "1002360"
  },
  {
    "text": "after app installation so basically if you can do up to a file right you can",
    "start": "1002360",
    "end": "1007830"
  },
  {
    "text": "install any app on the phone and you can also replace the system app and do a lot",
    "start": "1007830",
    "end": "1013620"
  },
  {
    "text": "of evil stuff and what they need to emphasize that it's exploitable by any",
    "start": "1013620",
    "end": "1021480"
  },
  {
    "text": "continue vacation so next I will I will talk",
    "start": "1021480",
    "end": "1027000"
  },
  {
    "start": "1023000",
    "end": "1045000"
  },
  {
    "text": "about how we transform that up to file read and write when ability into actual",
    "start": "1027000",
    "end": "1032428"
  },
  {
    "text": "code execution recall that the de velde insert libraries only works for the executables",
    "start": "1032429",
    "end": "1040020"
  },
  {
    "text": "how the get tasks allow entitlement so who has this entitlement and we correct",
    "start": "1040020",
    "end": "1046890"
  },
  {
    "text": "the string on the hours file system unfortunately our iOS 9 new program has",
    "start": "1046890",
    "end": "1054870"
  },
  {
    "text": "this indictment so it's very bad but we find a surprise in the developer disk",
    "start": "1054870",
    "end": "1061919"
  },
  {
    "text": "images in a very old word of that the DDI we found there is program called VP",
    "start": "1061919",
    "end": "1069299"
  },
  {
    "text": "a agent which help how this indictment so now we try to mount the old word of",
    "start": "1069299",
    "end": "1078650"
  },
  {
    "text": "DDI into iOS device so that we have VPN agent available and obtaining we found",
    "start": "1078650",
    "end": "1085860"
  },
  {
    "text": "no the iOS 9 has a working check on the DDI if the DDI developer disk image is",
    "start": "1085860",
    "end": "1093480"
  },
  {
    "text": "too old it refused to mount it we thought maybe we can undo this but leave",
    "start": "1093480",
    "end": "1101040"
  },
  {
    "text": "her after we reverse-engineer the mobile storage monitor program which is responsible for the monkey job we found",
    "start": "1101040",
    "end": "1108120"
  },
  {
    "text": "there is the logic error so in each DVD each developer disc limited there's a",
    "start": "1108120",
    "end": "1115020"
  },
  {
    "text": "file called trust cache which contains sort of hash values of the executable in",
    "start": "1115020",
    "end": "1121590"
  },
  {
    "text": "the developer image so it's used to tell the OS kernel who a who created the",
    "start": "1121590",
    "end": "1129030"
  },
  {
    "text": "program the the programs are created by Apple so that you should run it without triggering any code signature",
    "start": "1129030",
    "end": "1136290"
  },
  {
    "text": "Drillers so what mobile storage monitor did is it load a trust patch first and",
    "start": "1136290",
    "end": "1144000"
  },
  {
    "text": "then apply the word in check so even the old word in DDR cannot be mounted",
    "start": "1144000",
    "end": "1150900"
  },
  {
    "text": "successfully mobile storage monitor already reversed hey the catch into the kernel so we piayed into",
    "start": "1150900",
    "end": "1158540"
  },
  {
    "text": "the OTP read it it's excu it's still you if you had one",
    "start": "1158540",
    "end": "1163970"
  },
  {
    "text": "Nate it wouldn't trigger any could skin easier problem so now we try to debug VP",
    "start": "1163970",
    "end": "1170450"
  },
  {
    "start": "1168000",
    "end": "1216000"
  },
  {
    "text": "raided the trick we used just as as we did last so we might or normal DDI so we",
    "start": "1170450",
    "end": "1176990"
  },
  {
    "text": "enable the debug server and now we use XP see when ability I just introduced we",
    "start": "1176990",
    "end": "1184460"
  },
  {
    "text": "move beeping agent into some place where the debug server has access to but we",
    "start": "1184460",
    "end": "1190610"
  },
  {
    "text": "notice in applied that the fortisandbox so here's the thing so if the executable",
    "start": "1190610",
    "end": "1197420"
  },
  {
    "text": "is under the private of our mobile container it directory by default the",
    "start": "1197420",
    "end": "1203450"
  },
  {
    "text": "kernel will apply the containers and box but if may it's curable it's not in this",
    "start": "1203450",
    "end": "1208940"
  },
  {
    "text": "directory the the kind of doesn't apply that sandbox so since it's easy but you",
    "start": "1208940",
    "end": "1218690"
  },
  {
    "start": "1216000",
    "end": "1238000"
  },
  {
    "text": "may already notice that we pn agent does not have the comma P dot prowl escape",
    "start": "1218690",
    "end": "1224120"
  },
  {
    "text": "library validation entitlement so even now the question is we are able to run within an agent and we can ask it to",
    "start": "1224120",
    "end": "1231620"
  },
  {
    "text": "load our library but we cannot bypass that he might've allocation right so there there are two",
    "start": "1231620",
    "end": "1240830"
  },
  {
    "text": "burners of get tasks allow it's a kind of logic conflict between debugging and",
    "start": "1240830",
    "end": "1248060"
  },
  {
    "text": "curse on you so now assume you you are",
    "start": "1248060",
    "end": "1253670"
  },
  {
    "text": "debugging your own application on iOS you want set up Rick points so how great",
    "start": "1253670",
    "end": "1259580"
  },
  {
    "text": "point works that means you need to change those instruction into some special one and it will trigger double",
    "start": "1259580",
    "end": "1264890"
  },
  {
    "text": "point so that means code-signing doesn't work so why because the server will",
    "start": "1264890",
    "end": "1271640"
  },
  {
    "text": "check the kernel will check if a program has task allow in tournament and the",
    "start": "1271640",
    "end": "1278690"
  },
  {
    "text": "program is being the fact that means it's kind of debugging process and in",
    "start": "1278690",
    "end": "1285350"
  },
  {
    "text": "that case even the code signature in allocation happens the colonel wouldn't kill the program",
    "start": "1285350",
    "end": "1291309"
  },
  {
    "text": "other it will it will allow the program to continue to run so now we have away",
    "start": "1291309",
    "end": "1299679"
  },
  {
    "text": "so what we did is we just reuse the cool signature for a system library in our",
    "start": "1299679",
    "end": "1305479"
  },
  {
    "text": "denim collaborate so that when you lose the library the arrows cannot believe",
    "start": "1305479",
    "end": "1310970"
  },
  {
    "text": "and you are trying to load a system library so Kim ID okay but when the",
    "start": "1310970",
    "end": "1317509"
  },
  {
    "text": "library get executed it'll be a trigger could signature in validation error but",
    "start": "1317509",
    "end": "1324950"
  },
  {
    "text": "the kind of fund okay that now it's being the backed and the process has get",
    "start": "1324950",
    "end": "1330139"
  },
  {
    "text": "tasks allowed in tournament so the kernel would kill the program I know our",
    "start": "1330139",
    "end": "1335629"
  },
  {
    "text": "dynamic library can continue to run and explore to the kernel so put it all",
    "start": "1335629",
    "end": "1341090"
  },
  {
    "text": "together with what we did is we first Monta owed DDI so that we can make VPN idiot the",
    "start": "1341090",
    "end": "1348200"
  },
  {
    "text": "platform Bernie and we also matter correct DDI so that debug server is",
    "start": "1348200",
    "end": "1354229"
  },
  {
    "text": "available on iOS device and we use the explicit even ability to move beeping an",
    "start": "1354229",
    "end": "1360080"
  },
  {
    "text": "agent to someplace where the back server how access and now with the bug this",
    "start": "1360080",
    "end": "1366139"
  },
  {
    "text": "copy of the VPN agent and force it to load our TANF library and the time that",
    "start": "1366139",
    "end": "1372440"
  },
  {
    "text": "the name library is kind of carefully designed so we can bypass co-signing and",
    "start": "1372440",
    "end": "1377690"
  },
  {
    "text": "and Tim might even tician so yeah now how will continue to introduce the",
    "start": "1377690",
    "end": "1384529"
  },
  {
    "text": "kernel part and how per se but she'll the persistent code signing bypass hello",
    "start": "1384529",
    "end": "1394149"
  },
  {
    "text": "thanks X for today and talking about the user end part and introduce the rest",
    "start": "1394149",
    "end": "1400309"
  },
  {
    "text": "part of our jailbreak first of all we will talk about the kind of exploit and",
    "start": "1400309",
    "end": "1405649"
  },
  {
    "text": "the kernel patching in Panguna we will not talk about the details of the",
    "start": "1405649",
    "end": "1412159"
  },
  {
    "text": "patching but we were we were to tell you how to bypass the kpp so to make a",
    "start": "1412159",
    "end": "1422389"
  },
  {
    "text": "jailbreak you have to attack ours colonel because a lot of enforcement actually",
    "start": "1422389",
    "end": "1429259"
  },
  {
    "text": "implemented in the kernel part so you need to patch them out like like the MFI and the sandbox part so you rate the the",
    "start": "1429259",
    "end": "1438950"
  },
  {
    "text": "goal of the Explorer 10 kernel vulnerability is to gain the arbitrator",
    "start": "1438950",
    "end": "1444559"
  },
  {
    "text": "know reading and writing and to achieve this usually we need to defeat and",
    "start": "1444559",
    "end": "1450999"
  },
  {
    "text": "exploit mitigation seeing ours like KS r and s m AP also there's a new challenge",
    "start": "1450999",
    "end": "1459409"
  },
  {
    "text": "in house 9 it's the kernel patch protection apparatus to prevent hackers",
    "start": "1459409",
    "end": "1465379"
  },
  {
    "text": "to patch the kernel man yeah we will see how we resolve this challenge due to",
    "start": "1465379",
    "end": "1473840"
  },
  {
    "text": "actually due to the time of this talk we will not give very details about all the",
    "start": "1473840",
    "end": "1480230"
  },
  {
    "text": "kernel or ingredients used in our jailbreak we will get back we will give a short description of so streak and",
    "start": "1480230",
    "end": "1487279"
  },
  {
    "text": "vulnerabilities so the first one is we use the indie Alice 9.0 jailbreak it's",
    "start": "1487279",
    "end": "1495080"
  },
  {
    "text": "actually and you use after free bobbing IO head family it's it's actually very",
    "start": "1495080",
    "end": "1501289"
  },
  {
    "text": "easy to found a few auditor the sauce of the open it because I'll hit family is",
    "start": "1501289",
    "end": "1507859"
  },
  {
    "text": "open source so but but this part actually is enriched Bo in in container",
    "start": "1507859",
    "end": "1515119"
  },
  {
    "text": "sandbox and that's why I talk about user and part of the of our jailbreak to",
    "start": "1515119",
    "end": "1521710"
  },
  {
    "text": "finally achieve the code execution in a you know less restrict sent box so we",
    "start": "1521710",
    "end": "1530690"
  },
  {
    "text": "could so we could check the kind of explore T in that same in that sandbox and and actually this is a very very",
    "start": "1530690",
    "end": "1538190"
  },
  {
    "text": "powerful bug fu exploded in this in a correct way you can just defeat odd",
    "start": "1538190",
    "end": "1543649"
  },
  {
    "text": "medications just by one Park so we can Pawnee cannot buy one back also we",
    "start": "1543649",
    "end": "1550850"
  },
  {
    "text": "actually just discuss already discussed the details and the way to explore this",
    "start": "1550850",
    "end": "1555889"
  },
  {
    "text": "party the informal conference at rocks car and the POC if you miss the talk you can",
    "start": "1555889",
    "end": "1562940"
  },
  {
    "text": "check and the address here you can download the slide and for details and",
    "start": "1562940",
    "end": "1569830"
  },
  {
    "start": "1569000",
    "end": "1669000"
  },
  {
    "text": "in this year we upgrade our jailbreak to to support he support iOS 9.1 and in",
    "start": "1569830",
    "end": "1578360"
  },
  {
    "text": "this version we use another kind of vulnerability actually this this one is reported to apple pie and beer from",
    "start": "1578360",
    "end": "1586460"
  },
  {
    "text": "Google project zero and after the after the vulnerability is patched he released",
    "start": "1586460",
    "end": "1592610"
  },
  {
    "text": "a pure C code under unco on the Google project zero code code google yeah and",
    "start": "1592610",
    "end": "1600520"
  },
  {
    "text": "actually this is a race condition bargaining I'll register a traitor",
    "start": "1600520",
    "end": "1607100"
  },
  {
    "text": "we notice that this buggy is very dangerous because it's reachable in containers and works that means any",
    "start": "1607100",
    "end": "1613970"
  },
  {
    "text": "application you download from App Store you installed from the web and they are",
    "start": "1613970",
    "end": "1620179"
  },
  {
    "text": "able to exploit this part also this risk condition bug if you find a good way to",
    "start": "1620179",
    "end": "1626510"
  },
  {
    "text": "exploit it it's enough to defeat all the medications you can also prompt the",
    "start": "1626510",
    "end": "1632420"
  },
  {
    "text": "kernel by this one single mark and as we know we talked to the lucky heart as we",
    "start": "1632420",
    "end": "1639740"
  },
  {
    "text": "know his career genius hacker genius hacker and he has his own private",
    "start": "1639740",
    "end": "1645530"
  },
  {
    "text": "jailbreak jailbreak and he explored this part in his private Jerry after after",
    "start": "1645530",
    "end": "1652580"
  },
  {
    "text": "MBA posted POC of this part we have a lock we took a look inside of this bag",
    "start": "1652580",
    "end": "1659240"
  },
  {
    "text": "and do some analysis of this bag and the poster block about it as posted our",
    "start": "1659240",
    "end": "1665650"
  },
  {
    "text": "Pangu blog you can check at this address",
    "start": "1665650",
    "end": "1670210"
  },
  {
    "start": "1669000",
    "end": "1820000"
  },
  {
    "text": "ok so another kind of vulnerability is used in the latest jailbreak we just",
    "start": "1671200",
    "end": "1678260"
  },
  {
    "text": "released like like last week or 10 or 10",
    "start": "1678260",
    "end": "1683390"
  },
  {
    "text": "days ago like ok actually when when I why I'm preparing this slide",
    "start": "1683390",
    "end": "1690119"
  },
  {
    "text": "there's no CB number but surprisingly this morning I pull released I was nine",
    "start": "1690119",
    "end": "1695549"
  },
  {
    "text": "point three point four to just fix this bug and okay so here's the CV number",
    "start": "1695549",
    "end": "1701099"
  },
  {
    "text": "it's 2016 and 46:15 four okay so yeah",
    "start": "1701099",
    "end": "1709409"
  },
  {
    "text": "actually I think the the test team of Apple should sink for a sink black black",
    "start": "1709409",
    "end": "1714629"
  },
  {
    "text": "had to put our talk on the second day so they they have one more day to do the test okay so this bug actually is a heap",
    "start": "1714629",
    "end": "1722999"
  },
  {
    "text": "overflow back in IO mobile from buffer our mobile from buffer is used to like -",
    "start": "1722999",
    "end": "1732319"
  },
  {
    "text": "it's related to the to the display as like rest' awesome-mobile firm buffer",
    "start": "1732319",
    "end": "1739409"
  },
  {
    "text": "for the display so this this this user client actually is accessible in",
    "start": "1739409",
    "end": "1746059"
  },
  {
    "text": "containers and a box I think this is the reason why I Paul was so eager to and",
    "start": "1746059",
    "end": "1752759"
  },
  {
    "text": "released a fix of this part because it's very dangerous and the application can",
    "start": "1752759",
    "end": "1758309"
  },
  {
    "text": "use this bug to exploit your devices also this buggy is a very very good bug",
    "start": "1758309",
    "end": "1765539"
  },
  {
    "text": "if you explore in right way you can just use this single bug to bypass odd",
    "start": "1765539",
    "end": "1770729"
  },
  {
    "text": "medications and totally from the kernel the accurate of why we released",
    "start": "1770729",
    "end": "1777989"
  },
  {
    "text": "jailbreak for hours nine points three point story is mostly because this party is fixed in hours",
    "start": "1777989",
    "end": "1784289"
  },
  {
    "text": "temp attitude so that's interesting that means the Apple internal security team",
    "start": "1784289",
    "end": "1790229"
  },
  {
    "text": "already not already not back and they fix it in the hours 10 but they didn't fix this very serious part in the nine",
    "start": "1790229",
    "end": "1798569"
  },
  {
    "text": "point three point three I don't know why but we push them to do that I think and",
    "start": "1798569",
    "end": "1803609"
  },
  {
    "text": "that makes and devices at the device and more safe okay so also because of the",
    "start": "1803609",
    "end": "1811949"
  },
  {
    "text": "time of this talk I will not get very details and exploits way of this back we",
    "start": "1811949",
    "end": "1817619"
  },
  {
    "text": "will leave this in the future conference like okay so after introduction of the",
    "start": "1817619",
    "end": "1824669"
  },
  {
    "start": "1820000",
    "end": "1967000"
  },
  {
    "text": "kernel vulnerabilities we will talk about the kernel patch especially on how",
    "start": "1824669",
    "end": "1830489"
  },
  {
    "text": "we defeat kpp in house 9 actually at that time the kernel image are all",
    "start": "1830489",
    "end": "1837449"
  },
  {
    "text": "encrypted as we know from the house 10 beta I don't know what but Apple just",
    "start": "1837449",
    "end": "1843359"
  },
  {
    "text": "and don't encrypt their kernel image and more so actually you can reverse the",
    "start": "1843359",
    "end": "1853109"
  },
  {
    "text": "creepy part because the kernel image is not encrypted in our Stan but at the",
    "start": "1853109",
    "end": "1859349"
  },
  {
    "text": "time we released a jailbreak for us I was not we don't have the binary for the",
    "start": "1859349",
    "end": "1866069"
  },
  {
    "text": "qbp so the way we do is to do some black box test to find out to find out the",
    "start": "1866069",
    "end": "1874499"
  },
  {
    "text": "weakness of kbp so as the result of our",
    "start": "1874499",
    "end": "1879869"
  },
  {
    "text": "test we concerned first what does kpp will protect although we realize that",
    "start": "1879869",
    "end": "1888619"
  },
  {
    "text": "all the great memory and read and external memory inside the kernel catch",
    "start": "1888619",
    "end": "1895619"
  },
  {
    "text": "is protected by kpp so if you modify any of this memory and panic will be",
    "start": "1895619",
    "end": "1902249"
  },
  {
    "text": "triggered so that means apple wants to protect all the kernel kernel tax code and all the",
    "start": "1902249",
    "end": "1909869"
  },
  {
    "text": "cost of a ribose also we also we found",
    "start": "1909869",
    "end": "1916349"
  },
  {
    "text": "that the page tables of those protected memory are also protected by kpp that",
    "start": "1916349",
    "end": "1922559"
  },
  {
    "text": "means like you can you cannot like make the protection of the memory FRA execute",
    "start": "1922559",
    "end": "1932549"
  },
  {
    "text": "a WX if you if you make it right bow and the kpv also attracted a panic we also",
    "start": "1932549",
    "end": "1941309"
  },
  {
    "text": "want to know what ask EBP not product that means for this memory so we could modify these memories without trigger",
    "start": "1941309",
    "end": "1948029"
  },
  {
    "text": "the KDP so actually the RW memory read and write memory inside",
    "start": "1948029",
    "end": "1954730"
  },
  {
    "text": "Colonel is not protect protected by TVP also all the heap kernel memory you are",
    "start": "1954730",
    "end": "1962080"
  },
  {
    "text": "located but later is not protected by a key BV okay so we go we go deeper that",
    "start": "1962080",
    "end": "1971860"
  },
  {
    "start": "1967000",
    "end": "2034000"
  },
  {
    "text": "we took for example we took a sandbox extension as an example here we examined",
    "start": "1971860",
    "end": "1980290"
  },
  {
    "text": "the Makah handoff it to see what we could still modify here the outputs of",
    "start": "1980290",
    "end": "1988240"
  },
  {
    "text": "the macro handle we pay attention to the protection flags here the the text",
    "start": "1988240",
    "end": "1995590"
  },
  {
    "text": "segment is obviously protected by kpp because it's marked X but all the data",
    "start": "1995590",
    "end": "2002880"
  },
  {
    "text": "marked as RW is not protected by PPP and among this data segments there is very",
    "start": "2002880",
    "end": "2010290"
  },
  {
    "text": "interesting section called God GOG this is a this actor is marked as a Babel",
    "start": "2010290",
    "end": "2017820"
  },
  {
    "text": "that means you can modify this this area of memory and what what does this used",
    "start": "2017820",
    "end": "2023700"
  },
  {
    "text": "for actually this section is used to store all the stop function or dresses I",
    "start": "2023700",
    "end": "2031260"
  },
  {
    "text": "will talk this later ok so actually for",
    "start": "2031260",
    "end": "2038340"
  },
  {
    "text": "the first jailbreak we released we we tried to patch em fi and the sandbox as",
    "start": "2038340",
    "end": "2045720"
  },
  {
    "text": "we all know the both m fi and the sandbox are actually the mock policy extensions that means and the code Mac",
    "start": "2045720",
    "end": "2052980"
  },
  {
    "text": "policy registered to set up other hooks and they check the checked privilege in",
    "start": "2052980",
    "end": "2059580"
  },
  {
    "text": "the hook functions okay so the other hook function is pointers actually are",
    "start": "2059580",
    "end": "2064590"
  },
  {
    "text": "stored in the our structure called Mac policy configuration and PC operations",
    "start": "2064590",
    "end": "2070500"
  },
  {
    "text": "that there's a long list of function pointers started here so you can guess",
    "start": "2070500",
    "end": "2078419"
  },
  {
    "text": "what before I was 9.2 actually I posted this function pointers in data VSS",
    "start": "2078419",
    "end": "2087179"
  },
  {
    "text": "so it's it's my classroom aw yeah so it's very easy to patch it because if if",
    "start": "2087179",
    "end": "2094950"
  },
  {
    "text": "you want to get rid of the specific hook you can just set the pointers - no - now",
    "start": "2094950",
    "end": "2101400"
  },
  {
    "text": "to get rid of it but Apple realize how we patch this kernel in our jailbreaker",
    "start": "2101400",
    "end": "2108750"
  },
  {
    "text": "and as so you know as 9.2 Apple moved other all this data to the text cast",
    "start": "2108750",
    "end": "2118279"
  },
  {
    "start": "2118000",
    "end": "2196000"
  },
  {
    "text": "okay so another way we could defeat kpp as we mentioned before and the god",
    "start": "2118819",
    "end": "2125599"
  },
  {
    "text": "section actually is inside the data which is marked as a double and we can",
    "start": "2125599",
    "end": "2130799"
  },
  {
    "text": "modify this what what's what's this used for to stop functioning for example the",
    "start": "2130799",
    "end": "2136049"
  },
  {
    "text": "MFI extension needs to know if the system Inc is in debugging mode which need to cut P I Can Has debugger and",
    "start": "2136049",
    "end": "2143400"
  },
  {
    "text": "actually this function is exported by the axial axial extension it's not not",
    "start": "2143400",
    "end": "2149700"
  },
  {
    "text": "it cannot implement itself so in this situation it just called a function are",
    "start": "2149700",
    "end": "2156869"
  },
  {
    "text": "just stored in the stop it actually points to the original address of DP I Can Has debugger but since it's our W so",
    "start": "2156869",
    "end": "2165450"
  },
  {
    "text": "we could easily modify the address of this function that means we could point",
    "start": "2165450",
    "end": "2171420"
  },
  {
    "text": "the P I Can Has the buggah to somewhere else like s return not that enter return",
    "start": "2171420",
    "end": "2178020"
  },
  {
    "text": "zero and Marty return one so Emma for wasting okay so I now has a debugger",
    "start": "2178020",
    "end": "2183839"
  },
  {
    "text": "attached so these are another way to cheat a kpp and actually in the latest",
    "start": "2183839",
    "end": "2189510"
  },
  {
    "text": "jailbreak nine point three point three we use this way to patch the sandbox and MFI okay so final we will talk about",
    "start": "2189510",
    "end": "2200940"
  },
  {
    "text": "another way that we defeat KVD KBB actually is used to prevent a con Apache",
    "start": "2200940",
    "end": "2208170"
  },
  {
    "text": "if this if you want to make this patch persist yeah because through our",
    "start": "2208170",
    "end": "2213690"
  },
  {
    "text": "observed you generate the trigger of the kpp is very random but it's",
    "start": "2213690",
    "end": "2220710"
  },
  {
    "text": "usually triggered when the device is not busy and that is for a second two minutes sometimes they take hours to",
    "start": "2220710",
    "end": "2228180"
  },
  {
    "text": "trigger the panic so that means if you don't need to persist patch like you",
    "start": "2228180",
    "end": "2234990"
  },
  {
    "text": "could just a patch and restore it in a very small time window like just in one",
    "start": "2234990",
    "end": "2240330"
  },
  {
    "text": "second I think it's enough to do a lot of things and that's very very safe okay",
    "start": "2240330",
    "end": "2248700"
  },
  {
    "text": "so after talk about the vulnerabilities and the way to defeat kpp we'll talk last we'll talk about how the penguin",
    "start": "2248700",
    "end": "2257460"
  },
  {
    "text": "algebra can achieve deep resistant usually the persistent is the hardest",
    "start": "2257460",
    "end": "2263880"
  },
  {
    "start": "2260000",
    "end": "2352000"
  },
  {
    "text": "part for for an untethered jailbreak so because there's the the attack service",
    "start": "2263880",
    "end": "2270210"
  },
  {
    "text": "of the president is not very large like other kind of like other attack so we",
    "start": "2270210",
    "end": "2276420"
  },
  {
    "text": "get some we took a look at the attacks herbs here first of all it's the new ID",
    "start": "2276420",
    "end": "2283589"
  },
  {
    "text": "actually in past year breakers most attacks are aimed to tird the other",
    "start": "2283589",
    "end": "2290250"
  },
  {
    "text": "variety is responsible for loading the dynamical libraries so if you can find a",
    "start": "2290250",
    "end": "2297140"
  },
  {
    "text": "vulnerability in this india d you can load the arbitrary dynamic library and",
    "start": "2297140",
    "end": "2306200"
  },
  {
    "text": "after every another attack service is attacked kernel actually the kernel is",
    "start": "2306200",
    "end": "2312540"
  },
  {
    "text": "responsible for loading the main executable file the dynamic linker and",
    "start": "2312540",
    "end": "2317670"
  },
  {
    "text": "also the dividers shared catch so if you could find a vulnerability in this part",
    "start": "2317670",
    "end": "2323730"
  },
  {
    "text": "yeah you are able to do persistent on the iOS device and another interesting",
    "start": "2323730",
    "end": "2330150"
  },
  {
    "text": "attack service actually is used at you we just saw this in the JPEG for house 5",
    "start": "2330150",
    "end": "2336710"
  },
  {
    "text": "there's a fire parsing back in reckon demo but actually this kind of buggy is",
    "start": "2336710",
    "end": "2342150"
  },
  {
    "text": "quite difficult to exploit because at that time there's no SAR and if there's",
    "start": "2342150",
    "end": "2347820"
  },
  {
    "text": "the SR in it it's it will be quite difficult",
    "start": "2347820",
    "end": "2352609"
  },
  {
    "start": "2352000",
    "end": "2445000"
  },
  {
    "text": "so after after taking a glance of all the attacks services we found we found",
    "start": "2353040",
    "end": "2359370"
  },
  {
    "text": "that actually the Duarte shared catch is never attacked before so what we we did",
    "start": "2359370",
    "end": "2366240"
  },
  {
    "text": "was what we did was do the code auditing of this part of code so divided chakra",
    "start": "2366240",
    "end": "2375210"
  },
  {
    "text": "actually is mapped into odd processes ours devices so it's only load was had",
    "start": "2375210",
    "end": "2382620"
  },
  {
    "text": "at first time that you are ID try to load it actually the dyd will call shared",
    "start": "2382620",
    "end": "2389940"
  },
  {
    "text": "reading check and p2 check if the shed caches already mapped it if it's not it",
    "start": "2389940",
    "end": "2395460"
  },
  {
    "text": "will open the catch file and check the hand it would read the handle of the",
    "start": "2395460",
    "end": "2400820"
  },
  {
    "text": "catch fire and to to do some cinco verification of the henna like it's a",
    "start": "2400820",
    "end": "2407310"
  },
  {
    "text": "valid shared cache file and after that it's we generate random slider for the",
    "start": "2407310",
    "end": "2413940"
  },
  {
    "text": "cache and finally it work harder shared a raging map and slide MP to slide a to",
    "start": "2413940",
    "end": "2421200"
  },
  {
    "text": "map shared cache into memory since the idea is open source we could check the",
    "start": "2421200",
    "end": "2427140"
  },
  {
    "text": "source code easily and we'll find that actually the function were trapped in",
    "start": "2427140",
    "end": "2434100"
  },
  {
    "text": "Takano there's a Cisco for 400 a 38 trap into kernel to finally map the shared",
    "start": "2434100",
    "end": "2443130"
  },
  {
    "text": "cache so let's take a look at the structure of shared cache handle this is",
    "start": "2443130",
    "end": "2451440"
  },
  {
    "start": "2445000",
    "end": "2520000"
  },
  {
    "text": "where defining any x cold handler file you can find this at the beginning",
    "start": "2451440",
    "end": "2457830"
  },
  {
    "text": "there's the magic string like the D it's dyd version zero or something like that",
    "start": "2457830",
    "end": "2463380"
  },
  {
    "text": "and after this mapping of set mapping of that offset points to an array of catch mapping",
    "start": "2463380",
    "end": "2472050"
  },
  {
    "text": "information and this structure is used to tell con how to map the file into",
    "start": "2472050",
    "end": "2477960"
  },
  {
    "text": "memory like from fire offset and size and map to which virtual address like",
    "start": "2477960",
    "end": "2483360"
  },
  {
    "text": "that and the image information actually the images offset points to an",
    "start": "2483360",
    "end": "2489240"
  },
  {
    "text": "area of image information an image information basically it's used by the",
    "start": "2489240",
    "end": "2495620"
  },
  {
    "text": "linker that Urd to know actually which",
    "start": "2495620",
    "end": "2500810"
  },
  {
    "text": "which library is mapped at which address so he can find he can located a library",
    "start": "2500810",
    "end": "2509600"
  },
  {
    "text": "otherwise this structure is very simple and if you later you can just use a j2",
    "start": "2509600",
    "end": "2515270"
  },
  {
    "text": "actually supports to decode the handler of the shared cache so let's move to the",
    "start": "2515270",
    "end": "2522630"
  },
  {
    "start": "2520000",
    "end": "2729000"
  },
  {
    "text": "kind of heart the kernel part actually and what what did he is very very simple it's copying",
    "start": "2522630",
    "end": "2528990"
  },
  {
    "text": "other mapping information that's the mapping information we mentioned before and did some very simple check like if",
    "start": "2528990",
    "end": "2537000"
  },
  {
    "text": "it's if it's on root filesystem if it's owned by root and finally it will just",
    "start": "2537000",
    "end": "2543180"
  },
  {
    "text": "map the file into memory according to the mapping informations oh also it will",
    "start": "2543180",
    "end": "2550470"
  },
  {
    "text": "record the first mapping and take its address at the base of the whole shared catch so if we record the process of",
    "start": "2550470",
    "end": "2559470"
  },
  {
    "text": "loading the shared shared cache will find there's no explicit code signature",
    "start": "2559470",
    "end": "2566220"
  },
  {
    "text": "verification of the catch handler yes although the catch can is marked as the",
    "start": "2566220",
    "end": "2571440"
  },
  {
    "text": "arcs but actually it hasn't to be acts because you don't need to execute the",
    "start": "2571440",
    "end": "2576840"
  },
  {
    "text": "coding inside it so here so what what we did what we did is to do is to put a",
    "start": "2576840",
    "end": "2583740"
  },
  {
    "text": "fake handler which marked as marked with the AH is which is read-only okay so",
    "start": "2583740",
    "end": "2590610"
  },
  {
    "text": "after you can chew the kenner you can control the mapping so this is a true snapshot and the first word is the",
    "start": "2590610",
    "end": "2598070"
  },
  {
    "text": "original should catch the mapping information of the original catch and",
    "start": "2598070",
    "end": "2604020"
  },
  {
    "text": "the second way is the one we patch the in Panguna and we notice that the fig",
    "start": "2604020",
    "end": "2610920"
  },
  {
    "text": "hannah actually we at the beginning it points at the end of the of the file",
    "start": "2610920",
    "end": "2616350"
  },
  {
    "text": "actually a pen append infect fake Hana at the end of file which she has no code signature but that's",
    "start": "2616350",
    "end": "2622440"
  },
  {
    "text": "fine because it's read-only memory so kind of thing okay we don't read only memory no signature",
    "start": "2622440",
    "end": "2628620"
  },
  {
    "text": "it work just let it go it's okay and the interesting part is that after",
    "start": "2628620",
    "end": "2635520"
  },
  {
    "text": "control and the mappings we need to find a way to abuse the MF ID to accept other",
    "start": "2635520",
    "end": "2641700"
  },
  {
    "text": "code signatures what what did we do to achieve this actually if you notice here",
    "start": "2641700",
    "end": "2647430"
  },
  {
    "text": "we splitted the last mapping actually into three into three mappings that that",
    "start": "2647430",
    "end": "2655290"
  },
  {
    "text": "enables us to actually the second mappings points to the points 2d also",
    "start": "2655290",
    "end": "2662370"
  },
  {
    "text": "the end of the file we appended the fake date has there that means we could modify I mean any data in the second",
    "start": "2662370",
    "end": "2669240"
  },
  {
    "text": "mapping so what did we modify actually it's just two bytes if we recall how MF",
    "start": "2669240",
    "end": "2678330"
  },
  {
    "text": "ID test if they can accept that called signature or not to actually use the MIS",
    "start": "2678330",
    "end": "2685950"
  },
  {
    "text": "validate signature this function is exported by Lima style AB so since we",
    "start": "2685950",
    "end": "2692640"
  },
  {
    "text": "could since we could modify the read-only memory actually the export",
    "start": "2692640",
    "end": "2698820"
  },
  {
    "text": "table is located in the read-only memory so we just cheat cheat the mist started",
    "start": "2698820",
    "end": "2704960"
  },
  {
    "text": "we could point M is valid the signature to some other function inside the valid",
    "start": "2704960",
    "end": "2711540"
  },
  {
    "text": "we find out this structure sorry we found this instructions it's just a",
    "start": "2711540",
    "end": "2716910"
  },
  {
    "text": "written 0 so after patch after patched the kernel catch the amount valid",
    "start": "2716910",
    "end": "2723720"
  },
  {
    "text": "signature is always written 0 then boom the MF ID is up ok ok so father",
    "start": "2723720",
    "end": "2730980"
  },
  {
    "start": "2729000",
    "end": "2811000"
  },
  {
    "text": "is the conclusion and actually the we",
    "start": "2730980",
    "end": "2735990"
  },
  {
    "text": "released we released 4 jailbreak juice in in past few years and we found out",
    "start": "2735990",
    "end": "2742020"
  },
  {
    "text": "actually it becomes harder and harder to make a new jailbreak because I post security is doing better and better I",
    "start": "2742020",
    "end": "2749490"
  },
  {
    "text": "think in the battle between the jail breaks and the Apple actually forced them to make more secure than we think and we are we",
    "start": "2749490",
    "end": "2757959"
  },
  {
    "text": "are happy to see that Apple released the update of nine point three point four",
    "start": "2757959",
    "end": "2764170"
  },
  {
    "text": "just for one mark that means because in past usually they were not do that quick",
    "start": "2764170",
    "end": "2771099"
  },
  {
    "text": "updates of their OS and and that's why I",
    "start": "2771099",
    "end": "2776499"
  },
  {
    "text": "think why Apple Apple patch this so quickly is because this bug is inside",
    "start": "2776499",
    "end": "2782589"
  },
  {
    "text": "and can be triggered inside the container sandbox so but also the RPC",
    "start": "2782589",
    "end": "2788170"
  },
  {
    "text": "box and the kernel box can explode about by container finish apps impose a huge",
    "start": "2788170",
    "end": "2793509"
  },
  {
    "text": "threat to our security and the apples are taking them really seriously so they want to patch it as soon as possible",
    "start": "2793509",
    "end": "2802019"
  },
  {
    "text": "okay so this is our talk think you are",
    "start": "2802019",
    "end": "2806789"
  },
  {
    "text": "[Applause]",
    "start": "2811270",
    "end": "2813800"
  }
]