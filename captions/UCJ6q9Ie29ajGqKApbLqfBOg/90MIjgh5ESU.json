[
  {
    "text": "uh so i'm andy davis research director of ncc group and we're going to be talking",
    "start": "80",
    "end": "5279"
  },
  {
    "text": "today about usb and more specifically how to extend usb attacks which traditionally have",
    "start": "5279",
    "end": "12240"
  },
  {
    "text": "been local physical access attacks over a network",
    "start": "12240",
    "end": "17680"
  },
  {
    "text": "um as you might see i've got quite an array of equipment here so i'm hoping to do a",
    "start": "17680",
    "end": "23199"
  },
  {
    "text": "number of live demos i hope i haven't kind of overstretched myself here i could have taken videos of the demos",
    "start": "23199",
    "end": "28640"
  },
  {
    "text": "but hey that'll be cheating so hopefully fingers crossed all the demos are going to work",
    "start": "28640",
    "end": "34399"
  },
  {
    "text": "but it involves kind of like moving cameras around and me putting the microphone up and down so we'll we'll see how it goes but",
    "start": "34399",
    "end": "40399"
  },
  {
    "text": "stick with it it'll work okay so um first of all",
    "start": "40399",
    "end": "47120"
  },
  {
    "text": "we're going to talk about what the main problem with usb bugs is and when i say problem this is kind of the the main reaction",
    "start": "47120",
    "end": "54239"
  },
  {
    "text": "i get from people when i demonstrate usb bugs then move on to talk about how i go",
    "start": "54239",
    "end": "60640"
  },
  {
    "text": "about identifying usb bugs i've been looking at them for a number of years come up with a range of different approaches for finding bugs",
    "start": "60640",
    "end": "67280"
  },
  {
    "text": "so i'll go through some of those talk about some of my experiences some of the things that i've found",
    "start": "67280",
    "end": "73119"
  },
  {
    "text": "then demo an r7 bug that was patched and the patch was released the other day",
    "start": "73119",
    "end": "79920"
  },
  {
    "text": "we'll then talk about kind of the first stage of me trying to move away from",
    "start": "79920",
    "end": "85439"
  },
  {
    "text": "physical access with with usb i came up with this kind of concept using bluetooth",
    "start": "85439",
    "end": "91119"
  },
  {
    "text": "it's a bit of a contrived example but you'll kind of see why why i went in that direction and then",
    "start": "91119",
    "end": "96320"
  },
  {
    "text": "we'll do another demo and then finally we'll talk about the uh kind of",
    "start": "96320",
    "end": "101360"
  },
  {
    "text": "full-on remoting of usb attacks hopefully do a demo that works perfectly",
    "start": "101360",
    "end": "107439"
  },
  {
    "text": "uh talk about what the implications are and then what you can do to prevent people mounting these kind of attacks",
    "start": "107439",
    "end": "115840"
  },
  {
    "text": "so the problem with the usb bugs obviously traditionally physical access",
    "start": "116000",
    "end": "122079"
  },
  {
    "text": "is required uh i've found and reported many many usb bugs over the years",
    "start": "122079",
    "end": "127200"
  },
  {
    "text": "and the normal response that you get from vendors is yeah well you know you need physical access you need to be able to",
    "start": "127200",
    "end": "133920"
  },
  {
    "text": "get to the box and plug something in big deal it's going to have code execution implications but you know if",
    "start": "133920",
    "end": "139920"
  },
  {
    "text": "you've got physical access to the box you can do what you like right so vendors some of them aren't really",
    "start": "139920",
    "end": "146400"
  },
  {
    "text": "interested at all others kind of understand what you're trying to get at and local bugs certainly have their",
    "start": "146400",
    "end": "152160"
  },
  {
    "text": "place and i think the thing that people don't tend to realize is how yes you need physical access but",
    "start": "152160",
    "end": "160239"
  },
  {
    "text": "how little time you need to actually perform something malicious using a usb device so",
    "start": "160239",
    "end": "168400"
  },
  {
    "text": "the majority of the bugs that i've found um have been associated with the enumeration phase",
    "start": "168400",
    "end": "174160"
  },
  {
    "text": "so when you plug in any usb device the the host that you're connected to",
    "start": "174160",
    "end": "179440"
  },
  {
    "text": "doesn't know anything about that device and it has to go through this phase called enumeration where it's a kind of a question and",
    "start": "179440",
    "end": "185200"
  },
  {
    "text": "answer session between the host and the device to try and find out what type of device class it is you know",
    "start": "185200",
    "end": "191040"
  },
  {
    "text": "is it a mass storage device is it a printer is it a camera that kind of thing then you know what what speed does it",
    "start": "191040",
    "end": "198000"
  },
  {
    "text": "want to run at um what kind of capabilities does it have and um and also what kind of protocols",
    "start": "198000",
    "end": "205360"
  },
  {
    "text": "does it want to talk once the the driver has been loaded by by the host os and during that whole phase of",
    "start": "205360",
    "end": "211920"
  },
  {
    "text": "communication there's a hell of a lot of data that's exchanged between the host and the device and the device and the",
    "start": "211920",
    "end": "217040"
  },
  {
    "text": "host and therefore um it's quite easy to once you have",
    "start": "217040",
    "end": "222400"
  },
  {
    "text": "developed the kind of fundamental capability of providing usb data from a rogue device back to a host",
    "start": "222400",
    "end": "231040"
  },
  {
    "text": "there's lots of areas where you can provide malformed data that triggers crashes software flaws",
    "start": "231040",
    "end": "237519"
  },
  {
    "text": "many of which are exploitable so that as i'm sure you're all aware",
    "start": "237519",
    "end": "243599"
  },
  {
    "text": "having used usb devices that enumeration phase is a matter of seconds from the point of point plugging in the",
    "start": "243599",
    "end": "249599"
  },
  {
    "text": "device up to when it's working is only a few seconds and it's during that period of time",
    "start": "249599",
    "end": "255439"
  },
  {
    "text": "that if you triggered a software floor in the parsing of that",
    "start": "255439",
    "end": "260560"
  },
  {
    "text": "data which was exploitable to execute arbitrary code you could then execute code purely by",
    "start": "260560",
    "end": "266479"
  },
  {
    "text": "inserting the device so that's the kind of story that i tell the vendors some of them get it some of them don't but it's been a a",
    "start": "266479",
    "end": "273199"
  },
  {
    "text": "long battle so here are a few of the examples of",
    "start": "273199",
    "end": "280639"
  },
  {
    "text": "bugs that i've found over the last few years going back to 2011",
    "start": "280639",
    "end": "285680"
  },
  {
    "text": "one in san solaris all of these by the way resulted would result in potential code",
    "start": "285680",
    "end": "293120"
  },
  {
    "text": "execution by the attacker and i've got to point out that i'm my my kind of field of expertise is",
    "start": "293120",
    "end": "301039"
  },
  {
    "text": "finding bugs not actually writing the exploits to exploit these bugs so you know i'd spend my time writing",
    "start": "301039",
    "end": "307360"
  },
  {
    "text": "fuzzers generating crash test cases for people to then go off and triage and write the exploit code so i'm no",
    "start": "307360",
    "end": "313919"
  },
  {
    "text": "kind of certainly when it comes to kernel level stuff i'm you know not not really an exploit",
    "start": "313919",
    "end": "319680"
  },
  {
    "text": "exploit writer having said that if i provide these crash dump details from my fuzzer",
    "start": "319680",
    "end": "325280"
  },
  {
    "text": "to the um the vendor and the vendor comes back and says yep code execution was possible then somebody",
    "start": "325280",
    "end": "332880"
  },
  {
    "text": "could potentially write code malicious code in a a usb device to",
    "start": "332880",
    "end": "338000"
  },
  {
    "text": "exploit some of these conditions so as you can see you know they're they're all pretty modern operating systems that scientist",
    "start": "338000",
    "end": "344160"
  },
  {
    "text": "one was on solaris 11.",
    "start": "344160",
    "end": "348479"
  },
  {
    "text": "so um i think the reason that we're still finding usb",
    "start": "349360",
    "end": "355600"
  },
  {
    "text": "bugs is it's a relatively new field um as you'll see in the the next couple of slides it's not",
    "start": "355600",
    "end": "361440"
  },
  {
    "text": "something that you can do purely with software you need a hardware component in order to test a usb host it's very different if you're",
    "start": "361440",
    "end": "367919"
  },
  {
    "text": "testing a usb device like a phone or a camera or a printer that kind of thing",
    "start": "367919",
    "end": "373039"
  },
  {
    "text": "you can do that purely from software but in order to pretend to be a usb",
    "start": "373039",
    "end": "378080"
  },
  {
    "text": "device and plug into a host like a server or a laptop that kind of thing",
    "start": "378080",
    "end": "383520"
  },
  {
    "text": "you need a hardware component",
    "start": "383520",
    "end": "386879"
  },
  {
    "text": "so back in 2011 uh i had my first attempt at",
    "start": "388720",
    "end": "397520"
  },
  {
    "text": "creating some hardware to emulate usb devices and used an arduino microcontroller",
    "start": "397520",
    "end": "404400"
  },
  {
    "text": "so the fuzzer that i wrote was very basic in c plus plus for controlling this",
    "start": "404400",
    "end": "409680"
  },
  {
    "text": "microcontroller because the microcontroller wasn't",
    "start": "409680",
    "end": "414720"
  },
  {
    "text": "particularly powerful wasn't particularly fast i was only able to emulate usb low-speed",
    "start": "414720",
    "end": "420960"
  },
  {
    "text": "devices like hid devices so um human interface devices things like",
    "start": "420960",
    "end": "426479"
  },
  {
    "text": "mice uh keyboards that kind of thing and it only allowed for kind of",
    "start": "426479",
    "end": "431759"
  },
  {
    "text": "semi-automated fuzzing um having said that it did find some pretty high profile bugs",
    "start": "431759",
    "end": "437680"
  },
  {
    "text": "and it kind of justified to me and uh to my management that provided me with",
    "start": "437680",
    "end": "443039"
  },
  {
    "text": "the funds that i could continue doing some research in this area and buy some more equipment",
    "start": "443039",
    "end": "448880"
  },
  {
    "text": "so i needed to move on from from this and why something a bit more powerful to allow me to fuzz faster devices",
    "start": "448880",
    "end": "457520"
  },
  {
    "text": "so in 2012 i identified a piece of test equipment which uh it",
    "start": "459039",
    "end": "464720"
  },
  {
    "text": "doesn't look like much it looks like it's a piece of kit that you buy from radio shack but it's actually a pretty powerful box and",
    "start": "464720",
    "end": "470560"
  },
  {
    "text": "it's produced by a company in the uk and what it essentially allows you to do",
    "start": "470560",
    "end": "477440"
  },
  {
    "text": "is capture in a kind of a proxy type fashion usb device between",
    "start": "477440",
    "end": "485520"
  },
  {
    "text": "a usb data between a device and a host so it's kind of like wireshark for usb",
    "start": "485520",
    "end": "491919"
  },
  {
    "text": "in a hardware device but the beauty of it was once you've captured all these packets associated with the interaction",
    "start": "491919",
    "end": "499039"
  },
  {
    "text": "of a usb device and a host it's got its own built-in scripting language that will allow you to",
    "start": "499039",
    "end": "504319"
  },
  {
    "text": "replicate and replay that session that you just captured which is great from a fuzzing",
    "start": "504319",
    "end": "509440"
  },
  {
    "text": "perspective because i was then able to modify that data and write a fuzzer",
    "start": "509440",
    "end": "514959"
  },
  {
    "text": "based around this particular bit of test kit unfortunately the scripting language",
    "start": "514959",
    "end": "520640"
  },
  {
    "text": "itself wasn't powerful enough to write the fuzzer in and unfortunately there was no software",
    "start": "520640",
    "end": "526240"
  },
  {
    "text": "api to control the the test equipment so what i ended up having to do was inject windows events into the um",
    "start": "526240",
    "end": "536399"
  },
  {
    "text": "the the gui software windows gui software that came with it using python and wrapping python around",
    "start": "536399",
    "end": "542080"
  },
  {
    "text": "it and spawning it and modifying the uh the generator file script",
    "start": "542080",
    "end": "549360"
  },
  {
    "text": "every time and getting it to replay it so it's a bit of an ugly hack but it it certainly worked and it found a huge",
    "start": "549360",
    "end": "554399"
  },
  {
    "text": "amount of uh other usb bugs now i have the capability to fuzz faster hosts or emulate faster devices",
    "start": "554399",
    "end": "562880"
  },
  {
    "text": "rather but of course one of the well along with",
    "start": "562880",
    "end": "568000"
  },
  {
    "text": "those limitations that i've talked about another limitation was you actually had to have an example of",
    "start": "568000",
    "end": "573120"
  },
  {
    "text": "each of the devices that you wanted to um to play it's literally a mutation based",
    "start": "573120",
    "end": "579600"
  },
  {
    "text": "uh fuzzer so you know you have the device you plug it in you record a session and then you kind",
    "start": "579600",
    "end": "585839"
  },
  {
    "text": "of mutate it based on how you want what you want to first",
    "start": "585839",
    "end": "591120"
  },
  {
    "text": "so the latest iteration of fuzzing is uh using a board called a face dancer board",
    "start": "591120",
    "end": "596800"
  },
  {
    "text": "this was developed by travis goodspeed in the us and",
    "start": "596800",
    "end": "601920"
  },
  {
    "text": "essentially what it allows you to do is emulate usb devices in python so",
    "start": "601920",
    "end": "610640"
  },
  {
    "text": "as long as you understand uh the details of the different protocols associated",
    "start": "610640",
    "end": "615839"
  },
  {
    "text": "with the different device classes using python code you can virtualize",
    "start": "615839",
    "end": "622000"
  },
  {
    "text": "any different usb device class and send data associated with it so no",
    "start": "622000",
    "end": "627920"
  },
  {
    "text": "longer do you need to do the kind of mutation based fuzzing having captured from a real device you can just",
    "start": "627920",
    "end": "633519"
  },
  {
    "text": "spawn up a um virtualized usb device of your choice and mutate the",
    "start": "633519",
    "end": "641279"
  },
  {
    "text": "data um as you like during the enumeration phase or during the class specific phase so after",
    "start": "641279",
    "end": "647680"
  },
  {
    "text": "enumeration and the host understands what the the device is it understands what language it can talk to",
    "start": "647680",
    "end": "654640"
  },
  {
    "text": "that device so um then you're talking about class specific communication and i've found bugs in that as well so it's",
    "start": "654640",
    "end": "661760"
  },
  {
    "text": "a pretty powerful way of doing it and the the tool that i wrote umap which controls face dancer",
    "start": "661760",
    "end": "667200"
  },
  {
    "text": "is available on github um i released it at blackhat usa last year and um",
    "start": "667200",
    "end": "674959"
  },
  {
    "text": "it's it's something that will develop over time at the moment it's got a reasonable uh list of um",
    "start": "674959",
    "end": "682880"
  },
  {
    "text": "kind of base classes device classes that allows you to kind of",
    "start": "682880",
    "end": "688240"
  },
  {
    "text": "pretend to be those different devices and based on my kind of expertise over the years of",
    "start": "688240",
    "end": "693279"
  },
  {
    "text": "what types of mutations within the enumeration phase and the class specific phase trigger bugs",
    "start": "693279",
    "end": "700320"
  },
  {
    "text": "i've created a whole bunch of test cases that then apply to these different protocols so that's all there and you can download",
    "start": "700320",
    "end": "706160"
  },
  {
    "text": "that and uh and use that so most recently and this",
    "start": "706160",
    "end": "714160"
  },
  {
    "text": "the advisory for this went out last week uh umap identified arbitrary code execution in",
    "start": "714160",
    "end": "720880"
  },
  {
    "text": "ios 7. so it's pretty powerful stuff i mean if uh if somebody actually wrote an exploit",
    "start": "720880",
    "end": "726560"
  },
  {
    "text": "to exploit this particular vulnerability we're talking about tethered jailbreak here so um the fact that these kind of things",
    "start": "726560",
    "end": "733839"
  },
  {
    "text": "are still there and they can be found with you know open source tools",
    "start": "733839",
    "end": "739040"
  },
  {
    "text": "download you up and have a play with it you never know what you might find",
    "start": "739040",
    "end": "744160"
  },
  {
    "text": "uh my ipad i've got here is still running um an older version of ios so basically",
    "start": "744160",
    "end": "750000"
  },
  {
    "text": "any uh version of ios prior to 7.1 is vulnerable to this bug",
    "start": "750000",
    "end": "755120"
  },
  {
    "text": "so i'll do a quick demo showing you what how to use umap and also hopefully",
    "start": "755120",
    "end": "761920"
  },
  {
    "text": "triggering the bug on ipad now because my um resolution was forced",
    "start": "761920",
    "end": "769600"
  },
  {
    "text": "to 102 4x768 everything's going to be a bit squashed on the screen um so",
    "start": "769600",
    "end": "778480"
  },
  {
    "text": "what i've got is where's my face here's my face dancer board",
    "start": "780720",
    "end": "786079"
  },
  {
    "text": "and that's connected one end of that is connected into my laptop here the other end is connected",
    "start": "786079",
    "end": "793680"
  },
  {
    "text": "into let me just bring up this camera",
    "start": "793680",
    "end": "798800"
  },
  {
    "text": "into there so you can see that's a usb connected",
    "start": "798880",
    "end": "804079"
  },
  {
    "text": "into there and let's just point that at the screen there",
    "start": "804079",
    "end": "809760"
  },
  {
    "text": "okay so um first thing to show you with umap um",
    "start": "812839",
    "end": "820079"
  },
  {
    "text": "if you do up minus l it's a bit difficult to see with the okay well you get the idea so basically",
    "start": "820079",
    "end": "827279"
  },
  {
    "text": "what it's showing you here is all the different device classes that it supports so uh within usb the class information",
    "start": "827279",
    "end": "834480"
  },
  {
    "text": "is specified by three different bytes so you've got",
    "start": "834480",
    "end": "839519"
  },
  {
    "text": "the base class the subclass and then the protocol that's used so the each line on here is a different",
    "start": "839519",
    "end": "848000"
  },
  {
    "text": "different type of device so if we take this one for example so the base class",
    "start": "848000",
    "end": "855440"
  },
  {
    "text": "for printer is seven um subclass is one which is the default",
    "start": "855440",
    "end": "860560"
  },
  {
    "text": "and the protocol is bidirectional interface so you can specify that you want to",
    "start": "860560",
    "end": "866399"
  },
  {
    "text": "emulate one of these devices and plug it virtually plug it into the um the ipad",
    "start": "866399",
    "end": "874720"
  },
  {
    "text": "so the first thing that i'll demo actually is if you just do a minus",
    "start": "874720",
    "end": "882480"
  },
  {
    "text": "i it will iterate through all those different device classes that the e-map supports",
    "start": "882480",
    "end": "890160"
  },
  {
    "text": "and just try them so it'll see whether the the host that you're connected to actually understands that device",
    "start": "890160",
    "end": "896000"
  },
  {
    "text": "so if i do a minus i and actually if we keep an eye on the",
    "start": "896000",
    "end": "903360"
  },
  {
    "text": "screen there",
    "start": "903360",
    "end": "906079"
  },
  {
    "text": "d d fingers crossed right okay as you can see it's not super fast it",
    "start": "910079",
    "end": "916079"
  },
  {
    "text": "goes through each one maybe takes about seven to ten seconds per um",
    "start": "916079",
    "end": "922000"
  },
  {
    "text": "device that it's emulating it's going through the whole enumeration phase",
    "start": "922000",
    "end": "927839"
  },
  {
    "text": "ah they can see see messages coming up on the ipad so cannot use this device doesn't",
    "start": "928880",
    "end": "937199"
  },
  {
    "text": "understand this usb device not supported",
    "start": "937199",
    "end": "954240"
  },
  {
    "text": "so when it does eventually find one that is supported which hopefully will be very soon",
    "start": "954240",
    "end": "960639"
  },
  {
    "text": "there we go so you can see it understands hit devices it understands",
    "start": "961759",
    "end": "969360"
  },
  {
    "text": "image devices in fact when it thought we'd plugged in an image device um it",
    "start": "969360",
    "end": "977519"
  },
  {
    "text": "tried to display the um the photos on that image device within the ipad",
    "start": "977519",
    "end": "984480"
  },
  {
    "text": "so it's kind of like a map for usb hence the name umap in this sense from a kind of a",
    "start": "985759",
    "end": "992160"
  },
  {
    "text": "discovery perspective so it's identifying which of these protocols are supported before we actually go ahead and do any fuzzing",
    "start": "992160",
    "end": "1000560"
  },
  {
    "text": "nearly done this is the last one",
    "start": "1005120",
    "end": "1010160"
  },
  {
    "text": "so we can see there that it supports hit devices keyboards mice that kind of thing image",
    "start": "1010160",
    "end": "1015680"
  },
  {
    "text": "devices cameras and mass storage devices so usb sticks memory sticks that kind of thing",
    "start": "1015680",
    "end": "1022880"
  },
  {
    "text": "now the particular bug that um that i discovered in ios 7",
    "start": "1022880",
    "end": "1030959"
  },
  {
    "text": "was actually in class specific information um and applied to my storage device so",
    "start": "1030959",
    "end": "1039839"
  },
  {
    "text": "what i'll do i think i've already still got it in if i do",
    "start": "1040079",
    "end": "1052880"
  },
  {
    "text": "i'll just type it in okay so with you can do like a minus f option which",
    "start": "1052880",
    "end": "1058240"
  },
  {
    "text": "will go through and fuzz through all the different test cases within um the test case file but i know a",
    "start": "1058240",
    "end": "1064400"
  },
  {
    "text": "specific one that triggers this bug so if i",
    "start": "1064400",
    "end": "1071120"
  },
  {
    "text": "choose the device class of mass storage device so zero eight",
    "start": "1071600",
    "end": "1078080"
  },
  {
    "text": "zero six five zero actually this is in the enumeration",
    "start": "1078080",
    "end": "1083520"
  },
  {
    "text": "phase not class specific enumeration phase and i know that it's test case 45.",
    "start": "1083520",
    "end": "1089919"
  },
  {
    "text": "so if i move that across you can keep an eye on the video screen there",
    "start": "1089919",
    "end": "1098240"
  },
  {
    "text": "so if i now send this fingers crossed let me just double check that that that that's okay so it's",
    "start": "1100799",
    "end": "1108480"
  },
  {
    "text": "sending that test case and oh there we go kernel panic",
    "start": "1108480",
    "end": "1113520"
  },
  {
    "text": "so that's just rebooted the ipad in a minute you'll see the apple symbol so it's restarting there",
    "start": "1113520",
    "end": "1119679"
  },
  {
    "text": "um now as demos go it's not particularly exciting but at the end of the day it's showing",
    "start": "1119679",
    "end": "1125919"
  },
  {
    "text": "the fact that purely by sending a rogue communication",
    "start": "1125919",
    "end": "1131919"
  },
  {
    "text": "via usb to uh the the ipad via usb it causes a kernel panic and reboots the",
    "start": "1131919",
    "end": "1138640"
  },
  {
    "text": "device and as i said apple confirmed that this is actually an exploitable vulnerability that would result in",
    "start": "1138640",
    "end": "1145120"
  },
  {
    "text": "arbitrary code execution in the kernel so",
    "start": "1145120",
    "end": "1151840"
  },
  {
    "text": "moving on",
    "start": "1152720",
    "end": "1155280"
  },
  {
    "text": "so excuse me so that's just an example of umap and",
    "start": "1158799",
    "end": "1164240"
  },
  {
    "text": "how i find usb bugs um so the next thing was okay how can i",
    "start": "1164240",
    "end": "1169280"
  },
  {
    "text": "move away from it being some kind of physical access i want i want to be able to do this stuff remotely",
    "start": "1169280",
    "end": "1175039"
  },
  {
    "text": "um and back in 2011 i discovered a a bug in uh all versions",
    "start": "1175039",
    "end": "1182080"
  },
  {
    "text": "of windows in hidpars.cis so when you plug in a hid device um a keyboard for example",
    "start": "1182080",
    "end": "1191360"
  },
  {
    "text": "as part of that communication that happens in the enumeration phase a thing called a hid report descriptor",
    "start": "1191360",
    "end": "1198000"
  },
  {
    "text": "is sent which basically talks about the capabilities of that hit device um you know what kind of keyboard it is",
    "start": "1198000",
    "end": "1204480"
  },
  {
    "text": "how the keys are mapped on that device um you know what what kind what",
    "start": "1204480",
    "end": "1210799"
  },
  {
    "text": "language keyboard it is all kinds of stuff like that and identified if you specified a",
    "start": "1210799",
    "end": "1218400"
  },
  {
    "text": "certain value within a certain field in a head report descriptor it created a logic error that resulted",
    "start": "1218400",
    "end": "1225280"
  },
  {
    "text": "in a null pointedly reference now i sent this to microsoft and they weren't particularly interested and fair",
    "start": "1225280",
    "end": "1231760"
  },
  {
    "text": "enough you know i could plug in a device which will blue screen any windows box but it's an old pointedly reference so it's",
    "start": "1231760",
    "end": "1238559"
  },
  {
    "text": "um not particularly exciting it's not exploitable i can't execute any code i can just blue screen the box",
    "start": "1238559",
    "end": "1244799"
  },
  {
    "text": "you might as well just power the machine off if you can if you've got physical access to it",
    "start": "1244799",
    "end": "1250000"
  },
  {
    "text": "um however oh yeah and there's just a screenshot of",
    "start": "1250000",
    "end": "1256559"
  },
  {
    "text": "a blue screen showing that hit pause dot sys triggers um and it's still still",
    "start": "1256559",
    "end": "1261600"
  },
  {
    "text": "every version of windows is vulnerable to this um so",
    "start": "1261600",
    "end": "1267919"
  },
  {
    "text": "i was thinking what else uses hid report descriptors well bluetooth keyboards do um and i thought",
    "start": "1267919",
    "end": "1274240"
  },
  {
    "text": "well surely microsoft wouldn't have a separate hid parsing routine for bluetooth keyboards",
    "start": "1274240",
    "end": "1281840"
  },
  {
    "text": "and for usb so maybe this bug that i found that was",
    "start": "1281840",
    "end": "1287120"
  },
  {
    "text": "in usb would also be valid for bluetooth um because the the report",
    "start": "1287120",
    "end": "1294320"
  },
  {
    "text": "descriptor has to be parsed in exactly the same way as when you plug in a usb keyboard um so you know i know this",
    "start": "1294320",
    "end": "1301440"
  },
  {
    "text": "isn't usb and this was kind of like i'm describing my thought process to try and move to a",
    "start": "1301440",
    "end": "1307520"
  },
  {
    "text": "remote scenario here so i'm just going to give you an example of this thing that i did next",
    "start": "1307520",
    "end": "1314240"
  },
  {
    "text": "oh yeah and there's a complete aside um so when i demonstrated the some of the usb bugs to",
    "start": "1315280",
    "end": "1321520"
  },
  {
    "text": "one of my clients and they were interested to know you know could i just produce a little simple device that i could keep",
    "start": "1321520",
    "end": "1326559"
  },
  {
    "text": "in my pocket and plug in uh to trigger some of these bugs and i haven't a spare arduino",
    "start": "1326559",
    "end": "1332640"
  },
  {
    "text": "and um various of the bugs that that i created i uh just hard coded into the arduino so",
    "start": "1332640",
    "end": "1339840"
  },
  {
    "text": "i could just kind of wander up and plug this device in um i would have brought it with me but i'm a bit nervous about taking it",
    "start": "1339840",
    "end": "1346080"
  },
  {
    "text": "through airports people might think it does something else",
    "start": "1346080",
    "end": "1351360"
  },
  {
    "text": "especially in the us",
    "start": "1351360",
    "end": "1354240"
  },
  {
    "text": "so okay let's go for a bluetooth demo so what i've got here",
    "start": "1356559",
    "end": "1364880"
  },
  {
    "text": "let's get the video screen back up",
    "start": "1365440",
    "end": "1369360"
  },
  {
    "text": "okay okay so let me just log into this",
    "start": "1372840",
    "end": "1389840"
  },
  {
    "text": "okay okay so what we've got here is um",
    "start": "1414840",
    "end": "1423279"
  },
  {
    "text": "microsoft surface tablet running windows 8.1 latest version totally patched up",
    "start": "1423279",
    "end": "1433200"
  },
  {
    "text": "and what i've got here is a laptop running ubuntu where i am going",
    "start": "1434880",
    "end": "1441279"
  },
  {
    "text": "to emulate a usb emulator bluetooth keyboard",
    "start": "1441279",
    "end": "1446640"
  },
  {
    "text": "and there's a nice little tool called head client that was written by somebody else not me and within there you can specify all the",
    "start": "1446640",
    "end": "1453760"
  },
  {
    "text": "details within the report descriptor so of course i modified that report descriptor to be the malicious one",
    "start": "1453760",
    "end": "1460000"
  },
  {
    "text": "that triggered the bug over usb so if i",
    "start": "1460000",
    "end": "1467519"
  },
  {
    "text": "run the hid client so that's now pretending to be a",
    "start": "1470640",
    "end": "1476240"
  },
  {
    "text": "bluetooth keyboard and now move over to my surface tablet",
    "start": "1476240",
    "end": "1482960"
  },
  {
    "text": "and click add a bluetooth device",
    "start": "1483120",
    "end": "1487840"
  },
  {
    "text": "that's good took a little while okay so there's the keyboard this is my",
    "start": "1499039",
    "end": "1505039"
  },
  {
    "text": "emulated keyboard and i say i want to pair with that okay",
    "start": "1505039",
    "end": "1514240"
  },
  {
    "text": "does the passcode match yes there's the passcode match",
    "start": "1514240",
    "end": "1523600"
  },
  {
    "text": "yes okay oh what's happened it's blue screened",
    "start": "1524159",
    "end": "1530720"
  },
  {
    "text": "now i know what you're all thinking i had to pair with it so you know i had to type in the code on",
    "start": "1530720",
    "end": "1537279"
  },
  {
    "text": "each machine which is why it's a contrived example but it kind of goes to show where i was going with this and the",
    "start": "1537279",
    "end": "1544400"
  },
  {
    "text": "next thing i thought was okay can you send it the legitimate um report",
    "start": "1544400",
    "end": "1549520"
  },
  {
    "text": "descriptor uh the first time when you pair and then once you're paired with it can you swap",
    "start": "1549520",
    "end": "1556240"
  },
  {
    "text": "it for the malicious report descriptor so next time you use the keyboard it blue screens unfortunately it doesn't so that was",
    "start": "1556240",
    "end": "1563360"
  },
  {
    "text": "kind of back to square one but i've managed to move slightly away from from physical access so i just need to",
    "start": "1563360",
    "end": "1570880"
  },
  {
    "text": "reboot this for the next demo",
    "start": "1570880",
    "end": "1585840"
  },
  {
    "text": "um",
    "start": "1596840",
    "end": "1599840"
  },
  {
    "text": "already there",
    "start": "1602240",
    "end": "1613840"
  },
  {
    "text": "okay i'll leave that to uh to reboot",
    "start": "1618720",
    "end": "1627840"
  },
  {
    "text": "okay right so i see you're all totally blown away",
    "start": "1631760",
    "end": "1636799"
  },
  {
    "text": "by that fantastic demo it does get better honest okay",
    "start": "1636799",
    "end": "1643120"
  },
  {
    "text": "so then i thought how how are we going to get this usb remoted there must be a way of doing it and i",
    "start": "1643120",
    "end": "1649600"
  },
  {
    "text": "thought well rdp rdp is the kind of way that everybody remotes into windows machines these days",
    "start": "1649600",
    "end": "1656320"
  },
  {
    "text": "and i remember that you know there was lots of different things lots of different devices and capabilities that",
    "start": "1656320",
    "end": "1662480"
  },
  {
    "text": "you could remote from the client to a server when you connected via rdp",
    "start": "1662480",
    "end": "1668720"
  },
  {
    "text": "and these are known as high-level redirection capabilities it's",
    "start": "1668720",
    "end": "1674799"
  },
  {
    "text": "the kind of legacy capabilities of rdp that have been developed over the years and",
    "start": "1674799",
    "end": "1682240"
  },
  {
    "text": "they've kind of grown organically it's almost like uh microsoft have kind of added the ability to",
    "start": "1682240",
    "end": "1688399"
  },
  {
    "text": "remote your printer and then a user has said oh wouldn't it be great if we could you know remote remote our local drives",
    "start": "1688399",
    "end": "1694880"
  },
  {
    "text": "or remote are smart smart cards that kind of thing so microsoft came up with all these",
    "start": "1694880",
    "end": "1700480"
  },
  {
    "text": "different mechanisms for remoting things over rdp",
    "start": "1700480",
    "end": "1706320"
  },
  {
    "text": "and unfortunately when you try and remote a usb bug",
    "start": "1706799",
    "end": "1711840"
  },
  {
    "text": "it doesn't quite work out so what happens let's say for example um you've got",
    "start": "1711840",
    "end": "1720080"
  },
  {
    "text": "that that particular example with the keyboard doesn't work you can't really remote a keyboard over rdp but i just happen to find",
    "start": "1720080",
    "end": "1726559"
  },
  {
    "text": "another bug within a usb audio device and usb audio",
    "start": "1726559",
    "end": "1731679"
  },
  {
    "text": "remoting is one of those legacy capabilities so i thought wow easy all i do is um i",
    "start": "1731679",
    "end": "1738640"
  },
  {
    "text": "set up my rdp client to um to remote the usb audio",
    "start": "1738640",
    "end": "1743840"
  },
  {
    "text": "connect up trigger the bug and it should work but unfortunately this is what happens",
    "start": "1743840",
    "end": "1749600"
  },
  {
    "text": "so you plug in your rogue device when your rdp session is set up and you blow yourself",
    "start": "1749600",
    "end": "1756399"
  },
  {
    "text": "up and that's because the way it works with",
    "start": "1756399",
    "end": "1763279"
  },
  {
    "text": "high level redirection is it's using the uh the drive the usb driver on the local machine rather than",
    "start": "1763279",
    "end": "1769840"
  },
  {
    "text": "on the server now theoretically if you used",
    "start": "1769840",
    "end": "1775600"
  },
  {
    "text": "um an rdp client that was non-windows based and you used something that i'm going to",
    "start": "1775600",
    "end": "1783440"
  },
  {
    "text": "talk about next there is another way around this from the way that i'm going to describe",
    "start": "1783440",
    "end": "1789679"
  },
  {
    "text": "to you but it's essentially using the same kind of thing but basically with high level usb redirection the kind of conventional way",
    "start": "1789679",
    "end": "1796080"
  },
  {
    "text": "of doing things um you're only ever going to blow up something locally nothing gets sent to the remote machine",
    "start": "1796080",
    "end": "1803120"
  },
  {
    "text": "it's not the remote driver usb driver on the machine that's parsing the data",
    "start": "1803120",
    "end": "1808799"
  },
  {
    "text": "that's being provided when you insert the device into your client",
    "start": "1808799",
    "end": "1814398"
  },
  {
    "text": "and then recently or relatively recently in computing terms last few years remoter",
    "start": "1816080",
    "end": "1823360"
  },
  {
    "text": "fx usb redirection was was added and i thought wow this sounds a bit",
    "start": "1823360",
    "end": "1829360"
  },
  {
    "text": "interesting what's the difference between remote fx usb redirection and high level redirection",
    "start": "1829360",
    "end": "1835200"
  },
  {
    "text": "well remote effects is used for all kinds of things it's not just usb the usb redirection almost seems to",
    "start": "1835200",
    "end": "1841279"
  },
  {
    "text": "be like a side story remote fx is primarily for kind of improving graphics capabilities over rdp",
    "start": "1841279",
    "end": "1849360"
  },
  {
    "text": "sessions doing funky things like that but but yeah there's certainly an element to it which allows you much more",
    "start": "1849360",
    "end": "1855679"
  },
  {
    "text": "control around usb redirection so i thought let's have a look at this",
    "start": "1855679",
    "end": "1864559"
  },
  {
    "text": "and fundamentally this is taken from one of the microsoft",
    "start": "1864559",
    "end": "1870720"
  },
  {
    "text": "msdn websites that talks about the differences between the high-level stuff and the remote effects",
    "start": "1870720",
    "end": "1875919"
  },
  {
    "text": "but fundamentally it's the device driver on the server that's processing the data",
    "start": "1875919",
    "end": "1884320"
  },
  {
    "text": "now you've got to make sure that the bug that you're trying to trigger is in one of the standard device drivers",
    "start": "1884320",
    "end": "1890720"
  },
  {
    "text": "that's going to already be on the server otherwise you're not going to get anywhere so you know it's going to have to be a",
    "start": "1890720",
    "end": "1896159"
  },
  {
    "text": "standard driver but fortunately the one that i'd found was in one of the microsoft standard drivers",
    "start": "1896159",
    "end": "1904398"
  },
  {
    "text": "so as you can see there's a whole bunch of different differences between usb high level redirection",
    "start": "1904960",
    "end": "1911919"
  },
  {
    "text": "and the remote effects stuff now in order to use it",
    "start": "1911919",
    "end": "1919200"
  },
  {
    "text": "if you install rdp on windows server 2012 the remote effects stuff is just there",
    "start": "1919200",
    "end": "1926159"
  },
  {
    "text": "but from a client perspective you need to do a bit of tweaking with your rdp client in order to",
    "start": "1926159",
    "end": "1932159"
  },
  {
    "text": "leverage this functionality so um within group policy",
    "start": "1932159",
    "end": "1938880"
  },
  {
    "text": "settings you need to enable allow rdp redirection of the supported remote",
    "start": "1938880",
    "end": "1945200"
  },
  {
    "text": "effects usb devices for this computer from this computer and then you do a gp update",
    "start": "1945200",
    "end": "1950720"
  },
  {
    "text": "force so that will then tell your rdp client",
    "start": "1950720",
    "end": "1956320"
  },
  {
    "text": "that you're going to be using remote effects when you connect you have",
    "start": "1956320",
    "end": "1961519"
  },
  {
    "text": "to reboot your your client in order for that to take effect",
    "start": "1961519",
    "end": "1967039"
  },
  {
    "text": "and then when you go to your configuration for",
    "start": "1967760",
    "end": "1973440"
  },
  {
    "text": "your client within local resources and more you've now got the ability or you've got",
    "start": "1973440",
    "end": "1980480"
  },
  {
    "text": "a new check box which is other supported remote effects usb devices and any devices that are",
    "start": "1980480",
    "end": "1987200"
  },
  {
    "text": "currently plugged into your client will show up there and you can add a tick box and say i want to",
    "start": "1987200",
    "end": "1993760"
  },
  {
    "text": "remote that device in fact within the kind of more granular rdp client configuration you can specify any",
    "start": "1993760",
    "end": "2002240"
  },
  {
    "text": "usb device by its guide and say i i want to remote this device",
    "start": "2002240",
    "end": "2009440"
  },
  {
    "text": "so it's not based on um specific use case types as it was with high level",
    "start": "2009440",
    "end": "2017200"
  },
  {
    "text": "redirection now it's much more generic and the functionality is there to allow you to",
    "start": "2017200",
    "end": "2022399"
  },
  {
    "text": "remote any usb device using remote effects",
    "start": "2022399",
    "end": "2027200"
  },
  {
    "text": "so now theoretically this is what happens actually more than theoretically because hopefully it'll",
    "start": "2027679",
    "end": "2033679"
  },
  {
    "text": "work in a minute so you've got your idp client and your",
    "start": "2033679",
    "end": "2038720"
  },
  {
    "text": "idp server now one thing that you need to do that took me ages to work out because i kept",
    "start": "2038720",
    "end": "2045600"
  },
  {
    "text": "on having the same scenario as i had before with the high level stuff where i kept blue screening my client is you have to",
    "start": "2045600",
    "end": "2052638"
  },
  {
    "text": "emulate a normal non-rogue device first because",
    "start": "2052639",
    "end": "2057919"
  },
  {
    "text": "what you need to do is kind of capture the session within remote fx and tell the rdp server",
    "start": "2057919",
    "end": "2065679"
  },
  {
    "text": "that you know a valid device of the class that you're going to send a rogue example of in a minute is",
    "start": "2065679",
    "end": "2072800"
  },
  {
    "text": "to be used within that rdp session so you start off by emulating the normal device not the",
    "start": "2072800",
    "end": "2078158"
  },
  {
    "text": "rogue device within your rdp session",
    "start": "2078159",
    "end": "2083440"
  },
  {
    "text": "um so the audio device that gets emulated by umap comes up as a creative headset",
    "start": "2083599",
    "end": "2092158"
  },
  {
    "text": "so you then tick that and say yep that's the one i want to use",
    "start": "2092159",
    "end": "2097200"
  },
  {
    "text": "you then remove that virtually and you virtually insert your",
    "start": "2097359",
    "end": "2102720"
  },
  {
    "text": "rogue device this time the rdp server goes boom",
    "start": "2102720",
    "end": "2109680"
  },
  {
    "text": "okay let's see if we can get it to work",
    "start": "2110560",
    "end": "2117839"
  },
  {
    "text": "okay so what i've got is this laptop here is connected via usb",
    "start": "2189520",
    "end": "2196720"
  },
  {
    "text": "to the face dancer board the face dancer board is then connected to this laptop here",
    "start": "2196720",
    "end": "2205599"
  },
  {
    "text": "this laptop here which has a remote desktop client configured on it",
    "start": "2206079",
    "end": "2213280"
  },
  {
    "text": "this laptop here is connected via a crossover cable to this laptop here",
    "start": "2213280",
    "end": "2221440"
  },
  {
    "text": "this laptop here is running windows server 2012 and that's what we're going to rdp into",
    "start": "2221440",
    "end": "2228880"
  },
  {
    "text": "so the first thing that we need to do",
    "start": "2228880",
    "end": "2234000"
  },
  {
    "text": "is rdp into the server and what i'm going to do is because you need to authenticate with it",
    "start": "2234000",
    "end": "2240320"
  },
  {
    "text": "i'm demonstrating that you can authenticate as the absolute lowest privileged user",
    "start": "2240320",
    "end": "2245359"
  },
  {
    "text": "so i'm going to rdp into the server as the guest user so absolute lowest privilege and then",
    "start": "2245359",
    "end": "2251839"
  },
  {
    "text": "what i'm going to do from here is i will",
    "start": "2251839",
    "end": "2256880"
  },
  {
    "text": "use huemap to say i just want to emulate",
    "start": "2256880",
    "end": "2261920"
  },
  {
    "text": "uh an audio device in its conventional sense so it's not going to do anything it's not going to send any malicious",
    "start": "2261920",
    "end": "2267920"
  },
  {
    "text": "data it's just going to emulate it and then within the client i'll capture that session",
    "start": "2267920",
    "end": "2273200"
  },
  {
    "text": "and take that tick box okay and i'll put the microphone down while i do it so that i get it done without it",
    "start": "2273200",
    "end": "2280160"
  },
  {
    "text": "timing out",
    "start": "2280160",
    "end": "2285838"
  },
  {
    "text": "okay",
    "start": "2296839",
    "end": "2299839"
  },
  {
    "text": "uh okay epic fail i just need to uh",
    "start": "2310839",
    "end": "2317760"
  },
  {
    "text": "revert to snapshot on my windows server",
    "start": "2317760",
    "end": "2327839"
  },
  {
    "text": "a snapshot",
    "start": "2327839",
    "end": "2341440"
  },
  {
    "text": "which will take a few seconds",
    "start": "2341440",
    "end": "2355838"
  },
  {
    "text": "so",
    "start": "2366839",
    "end": "2369839"
  },
  {
    "text": "okay let's try that again",
    "start": "2382720",
    "end": "2397838"
  },
  {
    "text": "yeah it's worked right okay so",
    "start": "2399200",
    "end": "2403920"
  },
  {
    "text": "it's currently logging in so that's now rdp'ed into the windows 2012 server there",
    "start": "2406560",
    "end": "2415359"
  },
  {
    "text": "okay now the next thing i need to do is",
    "start": "2415599",
    "end": "2425839"
  },
  {
    "text": "grab the session associated with the audio device",
    "start": "2427040",
    "end": "2439838"
  },
  {
    "text": "which i've now done",
    "start": "2445599",
    "end": "2453839"
  },
  {
    "text": "okay so there's the 2012 server and i've now",
    "start": "2464000",
    "end": "2471680"
  },
  {
    "text": "grabbed the audio device session for usb between the clients and the",
    "start": "2471839",
    "end": "2477280"
  },
  {
    "text": "server so now if i send the malicious",
    "start": "2477280",
    "end": "2483040"
  },
  {
    "text": "data which remember is connected via the face dancer board to the client",
    "start": "2483040",
    "end": "2489040"
  },
  {
    "text": "it's only ethernet that's connecting the client to this server that you can see up on the screen",
    "start": "2489040",
    "end": "2495838"
  },
  {
    "text": "i can do",
    "start": "2497359",
    "end": "2500078"
  },
  {
    "text": "see four",
    "start": "2502640",
    "end": "2509838"
  },
  {
    "text": "yes",
    "start": "2520839",
    "end": "2523839"
  },
  {
    "text": "okay so this has some pretty serious",
    "start": "2534839",
    "end": "2540560"
  },
  {
    "text": "implications it means that um even if you've just got",
    "start": "2540560",
    "end": "2548400"
  },
  {
    "text": "null pointed dereference bugs if you can use those to remotely blue screen a server on the",
    "start": "2548960",
    "end": "2554240"
  },
  {
    "text": "other side of the world that changes the whole ball game with usb attacks",
    "start": "2554240",
    "end": "2560160"
  },
  {
    "text": "what windows what microsoft have done with windows rdp is they've exposed elements of the",
    "start": "2561839",
    "end": "2568240"
  },
  {
    "text": "kernel over rdp which allow you to do that",
    "start": "2568240",
    "end": "2573520"
  },
  {
    "text": "which is a pretty dangerous thing really",
    "start": "2573520",
    "end": "2579119"
  },
  {
    "text": "and of course this may also apply to other non-windows remoting technologies i've only looked at rdp in detail",
    "start": "2579119",
    "end": "2585119"
  },
  {
    "text": "there's a bunch of other technologies out there that this might potentially affect",
    "start": "2585119",
    "end": "2593838"
  },
  {
    "text": "so how can you reduce the risks you can actually turn the remote fx functionality associated",
    "start": "2593920",
    "end": "2600960"
  },
  {
    "text": "with usb redirection off so if you're not going to use it",
    "start": "2600960",
    "end": "2606560"
  },
  {
    "text": "or you're scared about what you've just seen i'd suggest turning it off",
    "start": "2606560",
    "end": "2611599"
  },
  {
    "text": "if you do actually need it there is quite granular control that you can use to to make sure that",
    "start": "2611599",
    "end": "2618319"
  },
  {
    "text": "only the devices that you want to be used can be remoted via rdp",
    "start": "2618319",
    "end": "2623839"
  },
  {
    "text": "so you know make sure that it's configured correctly if you if you do want to use usb redirection",
    "start": "2623839",
    "end": "2629359"
  },
  {
    "text": "via remote effects but again you know you can disable it on the clients or rather not enable it on",
    "start": "2629359",
    "end": "2635680"
  },
  {
    "text": "the clients because it's not there by default on rdp clients um i'd also suggest minimizing the use",
    "start": "2635680",
    "end": "2642480"
  },
  {
    "text": "of the high level remoting stuff as well i think a lot of people don't realize how much remoting capability there is",
    "start": "2642480",
    "end": "2648560"
  },
  {
    "text": "within rdp and certainly be more cautious",
    "start": "2648560",
    "end": "2654240"
  },
  {
    "text": "about local or in quotes local vulnerabilities and apply all the patches",
    "start": "2654240",
    "end": "2661119"
  },
  {
    "text": "so a few conclusions and um further research so as i've demonstrated",
    "start": "2661119",
    "end": "2667119"
  },
  {
    "text": "physical access is no longer a requirement to trigger usb bugs certainly on windows maybe on other",
    "start": "2667119",
    "end": "2672240"
  },
  {
    "text": "operating systems as well um remote effects has",
    "start": "2672240",
    "end": "2678000"
  },
  {
    "text": "exposed the windows kernel and uh therefore you know these kind of kernel",
    "start": "2678000",
    "end": "2683760"
  },
  {
    "text": "level attacks are now available over the network i need to look at some of the other remoting technologies like citrix for",
    "start": "2683760",
    "end": "2689680"
  },
  {
    "text": "example which may well apply in a similar sense and the internet of things is full of",
    "start": "2689680",
    "end": "2695599"
  },
  {
    "text": "usb possibilities basically i've taken",
    "start": "2695599",
    "end": "2700720"
  },
  {
    "text": "umap and because it's completely host independent you can test any usb",
    "start": "2700720",
    "end": "2707599"
  },
  {
    "text": "host out there anything that's got a usb port on it and a host stack",
    "start": "2707599",
    "end": "2712960"
  },
  {
    "text": "that processes usb devices you can test using new map so i'm sure there are thousands of usb",
    "start": "2712960",
    "end": "2720079"
  },
  {
    "text": "host stack parsing vulnerabilities out there that you could probably find using",
    "start": "2720079",
    "end": "2725200"
  },
  {
    "text": "umap so please download it have a play with it and find some bugs",
    "start": "2725200",
    "end": "2732000"
  },
  {
    "text": "thank you very much",
    "start": "2732000",
    "end": "2734720"
  },
  {
    "text": "does anyone got any questions yep",
    "start": "2740240",
    "end": "2747839"
  },
  {
    "text": "um the question was can you actually inject code it depends on where the actual vulnerability is now",
    "start": "2747839",
    "end": "2755359"
  },
  {
    "text": "some of the some of the trigger points within the usb descriptors that get exchanged",
    "start": "2755359",
    "end": "2762720"
  },
  {
    "text": "at the enumeration phase time are very small however um it depends it's kind of a",
    "start": "2762720",
    "end": "2770400"
  },
  {
    "text": "case-by-case basis really because even in some instance where the trigger point is small",
    "start": "2770400",
    "end": "2775920"
  },
  {
    "text": "there are other descriptors that can be significantly larger so you could potentially put your payload in a different descriptor that would be",
    "start": "2775920",
    "end": "2782720"
  },
  {
    "text": "available in a different memory buffer at the time of exploitation but yeah it is very very much on a",
    "start": "2782720",
    "end": "2789200"
  },
  {
    "text": "case-by-case basis depending on which descriptor the bugs in and what os is parsing it",
    "start": "2789200",
    "end": "2796560"
  },
  {
    "text": "any more yep",
    "start": "2798079",
    "end": "2803838"
  },
  {
    "text": "yeah that's not something i've looked at um i'm sure in a similar sense the um kind of",
    "start": "2814240",
    "end": "2820680"
  },
  {
    "text": "virtualization of the usb stack maybe contains parsing bugs just like",
    "start": "2820680",
    "end": "2825839"
  },
  {
    "text": "you know kind of real um usb stack so yeah certainly another area to look at",
    "start": "2825839",
    "end": "2832960"
  },
  {
    "text": "great okay thanks very much",
    "start": "2837839",
    "end": "2844559"
  }
]