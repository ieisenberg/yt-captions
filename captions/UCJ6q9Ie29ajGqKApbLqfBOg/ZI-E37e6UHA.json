[
  {
    "start": "0",
    "end": "82000"
  },
  {
    "text": "so my name is Ben Surrey I'm the VP of research at Armas and today with me I",
    "start": "30",
    "end": "5670"
  },
  {
    "text": "have a doors Iseman he's a researcher my team Varmus is an agent agent society",
    "start": "5670",
    "end": "12840"
  },
  {
    "text": "security company which is focused on security IRT devices and many many devices in general specifically in",
    "start": "12840",
    "end": "19980"
  },
  {
    "text": "enterprise organizations part of the goal of our company is to better understand the threat landscape that IOT",
    "start": "19980",
    "end": "25500"
  },
  {
    "text": "devices and wireless protocols in general pose on the security of an enterprise network so part of this cause",
    "start": "25500",
    "end": "32300"
  },
  {
    "text": "came and led us to this research and it",
    "start": "32300",
    "end": "37530"
  },
  {
    "text": "started by understanding that there is a recent trend in which Enterprise great access points actually embed in them in",
    "start": "37530",
    "end": "45120"
  },
  {
    "text": "addition a radio chip abby lee able to flow energy chip and this additional",
    "start": "45120",
    "end": "51210"
  },
  {
    "text": "chip is there to have new features for access points but we also naturally",
    "start": "51210",
    "end": "57899"
  },
  {
    "text": "introduces a new threat landscape and opens the possibility of a network",
    "start": "57899",
    "end": "63000"
  },
  {
    "text": "bridge coming from a billy connection and in fact in the process of this",
    "start": "63000",
    "end": "68070"
  },
  {
    "text": "research we thought we found two zero day vulnerabilities affecting TI billy",
    "start": "68070",
    "end": "74040"
  },
  {
    "text": "chips that are used by a Reuben Meraki and Cisco access points and so what is",
    "start": "74040",
    "end": "82320"
  },
  {
    "start": "82000",
    "end": "82000"
  },
  {
    "text": "our agenda for today it's it's quite packed so I hope we've managed to get to",
    "start": "82320",
    "end": "89100"
  },
  {
    "text": "everything but initially I'm gonna talk about Billy in general where is it used",
    "start": "89100",
    "end": "95970"
  },
  {
    "text": "why is it used how is it being adopted in different verticals in the environment and then",
    "start": "95970",
    "end": "103399"
  },
  {
    "text": "specifically on access points why is it used in the access points what are the features that are embedded in access",
    "start": "103399",
    "end": "109860"
  },
  {
    "text": "points for triggering out Billy functionalities then I'm going to talk",
    "start": "109860",
    "end": "116549"
  },
  {
    "text": "about over-the-air firmware upgrades for ble chips so what are the mechanism is for",
    "start": "116549",
    "end": "123360"
  },
  {
    "text": "allow OTA upgrades really chips are they secure",
    "start": "123360",
    "end": "128489"
  },
  {
    "text": "when are they secure and so forth and then ever the two of all about that I mentioned",
    "start": "128489",
    "end": "135290"
  },
  {
    "text": "the first is the probability that affect every Baptists points they're really",
    "start": "135290",
    "end": "140329"
  },
  {
    "text": "shimmer in the beauty chip that using their artist points and then I'm gonna",
    "start": "140329",
    "end": "146959"
  },
  {
    "text": "talk about the second ability which is an ability in TI's Texas interns merely",
    "start": "146959",
    "end": "152329"
  },
  {
    "text": "stack that is used in many of their baby ships and this is an RC vulnerability I",
    "start": "152329",
    "end": "159290"
  },
  {
    "text": "think maybe as far as I know first mobility found in a melee",
    "start": "159290",
    "end": "165739"
  },
  {
    "text": "controller or Bluetooth controller level right so really close to the hardware level and indoor talking extensively",
    "start": "165739",
    "end": "174349"
  },
  {
    "text": "about how we exploited this one ability on a Cisco access point and in general",
    "start": "174349",
    "end": "180799"
  },
  {
    "text": "impact of this on networks and the security of baby",
    "start": "180799",
    "end": "187510"
  },
  {
    "text": "so to begin to begin just a bit about route the floor energy why why is it",
    "start": "188889",
    "end": "195469"
  },
  {
    "start": "189000",
    "end": "189000"
  },
  {
    "text": "used what is the benefits of having bluetooth our energy and different environments different verticals so",
    "start": "195469",
    "end": "202549"
  },
  {
    "text": "brutal or energy is kind of on the cool new kid around the block when you look at a little sparkle in general it's been",
    "start": "202549",
    "end": "209180"
  },
  {
    "text": "around a few years but it's really got adopted very fast by many industries",
    "start": "209180",
    "end": "215620"
  },
  {
    "text": "there are good causes for this it is the the newer version of Bluetooth so it",
    "start": "215620",
    "end": "223189"
  },
  {
    "text": "doesn't have many of old generation generation code that was involved in",
    "start": "223189",
    "end": "229790"
  },
  {
    "text": "bluetooth so it's much cleaner it's also lower energy right so there was a lot of",
    "start": "229790",
    "end": "236479"
  },
  {
    "text": "applications that can benefit from being lower energy and it is being used in many vehicles like I mentioned it's",
    "start": "236479",
    "end": "243229"
  },
  {
    "text": "using a health care devices medical devices in healthcare systems in general",
    "start": "243229",
    "end": "248329"
  },
  {
    "text": "in manufacturing warehouses and facilities in retail and in general IOT",
    "start": "248329",
    "end": "254989"
  },
  {
    "text": "devices that are if you can find throughout officers",
    "start": "254989",
    "end": "260079"
  },
  {
    "start": "260000",
    "end": "260000"
  },
  {
    "text": "but why really is it used in access points what is the use case they're so",
    "start": "260260",
    "end": "265940"
  },
  {
    "text": "access points advantage of already being deployed throughout many organizations",
    "start": "265940",
    "end": "271610"
  },
  {
    "text": "right there are the backbone to serving Wi-Fi to the entire organization so they're already the infrastructure is",
    "start": "271610",
    "end": "279230"
  },
  {
    "text": "already there so any application that you really can benefit from the fact that an access point can be part of that",
    "start": "279230",
    "end": "286100"
  },
  {
    "text": "application since it's already deployed in the organization and in fact there",
    "start": "286100",
    "end": "291350"
  },
  {
    "text": "are many different applications that take in versions of this ability you",
    "start": "291350",
    "end": "296660"
  },
  {
    "text": "have indoor navigation systems for example you want to do navigations inside closed building and so the access",
    "start": "296660",
    "end": "304280"
  },
  {
    "text": "points we send out weekends which can help implement in relegation systems you",
    "start": "304280",
    "end": "310100"
  },
  {
    "text": "can also see the in medical asset tracking applications or other asset",
    "start": "310100",
    "end": "315140"
  },
  {
    "text": "tracking applications where you want to track devices their location and so you",
    "start": "315140",
    "end": "320630"
  },
  {
    "text": "put a beacon on all the devices you want to track and the access points will track these weekends we can also use",
    "start": "320630",
    "end": "328750"
  },
  {
    "text": "belief or a customer tracking or what we also look at this spying on their",
    "start": "328750",
    "end": "334970"
  },
  {
    "text": "customers and in some sense but they this allows them to engage with",
    "start": "334970",
    "end": "340070"
  },
  {
    "text": "customers right and to know some specific person entered the shopping",
    "start": "340070",
    "end": "345380"
  },
  {
    "text": "mall or something and now we can show in a specific advertisement or something and then you have the last use case",
    "start": "345380",
    "end": "351919"
  },
  {
    "text": "that's getting traction also innovation here is the use of smart sensors",
    "start": "351919",
    "end": "357440"
  },
  {
    "text": "maybe in manufacturing but others as well the sensors will send out the read",
    "start": "357440",
    "end": "363260"
  },
  {
    "text": "over ble beacons and access points can serve as gateways to those beacons connecting them to which loud order or",
    "start": "363260",
    "end": "371150"
  },
  {
    "text": "the Internet in general which really when we looked at the vol abilities",
    "start": "371150",
    "end": "376729"
  },
  {
    "text": "found in these devices in these chips and their effect on practice points and",
    "start": "376729",
    "end": "383180"
  },
  {
    "text": "honor networks so that probabilities are",
    "start": "383180",
    "end": "388490"
  },
  {
    "text": "our impact was similar to the Internet's impact once we really sorry Church why really do you need Billy in",
    "start": "388490",
    "end": "395060"
  },
  {
    "text": "access points and like one person wrote in staff dot obviously it is there to",
    "start": "395060",
    "end": "400340"
  },
  {
    "text": "increase the attack surface so as I",
    "start": "400340",
    "end": "405919"
  },
  {
    "start": "404000",
    "end": "404000"
  },
  {
    "text": "mentioned our two vulnerabilities we found and we're going to discuss today Billy stack has different layers and",
    "start": "405919",
    "end": "412820"
  },
  {
    "text": "different functions to in the layers in the eyes tips we're going to talk about most of these are embedded inside the",
    "start": "412820",
    "end": "420789"
  },
  {
    "text": "inside one chip it's a system on chip so it has it embedded all of these layers",
    "start": "420789",
    "end": "426440"
  },
  {
    "text": "inside the chip but it can also be split between a couple of different processors it's much simpler than the classic",
    "start": "426440",
    "end": "433820"
  },
  {
    "text": "Bluetooth it's not so many parts but essentially you have in the controller layer you have a physical layer you have",
    "start": "433820",
    "end": "440300"
  },
  {
    "text": "the link layer that does most of the basic functionalities lowly",
    "start": "440300",
    "end": "445729"
  },
  {
    "text": "functionalities for the protocol I mean in clear we also found one wall ability",
    "start": "445729",
    "end": "452180"
  },
  {
    "text": "as I mentioned that effects Billy stacks in TI chips and this ships are already",
    "start": "452180",
    "end": "458090"
  },
  {
    "text": "also used by Cisco and Iraqis access points so they affect these but we can",
    "start": "458090",
    "end": "463250"
  },
  {
    "text": "also affect other devices right because it's a really stack availability in",
    "start": "463250",
    "end": "468500"
  },
  {
    "text": "these chips any device that uses chips in the voluble state will be affected by",
    "start": "468500",
    "end": "473659"
  },
  {
    "text": "this one ability so it's it has potential to affect many devices when you continue up the stack you have all",
    "start": "473659",
    "end": "480710"
  },
  {
    "text": "these parts that are in the host layer and they are they were function is more",
    "start": "480710",
    "end": "486590"
  },
  {
    "text": "high-level they create creating connections listening for connections you have this specific part is called",
    "start": "486590",
    "end": "494030"
  },
  {
    "text": "GATT which is the most simple way to transform transferred a data over Billy",
    "start": "494030",
    "end": "499820"
  },
  {
    "text": "it's like a REST API if you may like for Billy sorry - lousy really a simple way",
    "start": "499820",
    "end": "506599"
  },
  {
    "text": "to transfer data and on top of that you'd have a specific application and that will obviously change between one",
    "start": "506599",
    "end": "512390"
  },
  {
    "text": "device in another what is its use case of really and in this layer we found the",
    "start": "512390",
    "end": "518060"
  },
  {
    "text": "one ability that effect Aruba which I'm going to talk about you know",
    "start": "518060",
    "end": "523690"
  },
  {
    "start": "525000",
    "end": "525000"
  },
  {
    "text": "so when you look at over there are solutions for few more upgrades in ble",
    "start": "526170",
    "end": "531250"
  },
  {
    "text": "chips so these chips are standalone device right you don't have any other",
    "start": "531250",
    "end": "536980"
  },
  {
    "text": "communication channel other than merely they are not connected to the internet they are standalone you can find them in",
    "start": "536980",
    "end": "543040"
  },
  {
    "text": "IOT devices or even in access points where they're alongside another",
    "start": "543040",
    "end": "548500"
  },
  {
    "text": "processor and so they need to find a way to do firmware upgrades over there over",
    "start": "548500",
    "end": "554380"
  },
  {
    "text": "billing and so we we wanted to see what are the challenges in these solutions there are two major vendors that do ble",
    "start": "554380",
    "end": "562450"
  },
  {
    "text": "chips standalone system of chips Texas Instruments and not extended",
    "start": "562450",
    "end": "568180"
  },
  {
    "text": "conductors there are others but just for the users for this let's consider these",
    "start": "568180",
    "end": "573280"
  },
  {
    "text": "two and they have each separate framework for doing okay upgrades Texas",
    "start": "573280",
    "end": "581050"
  },
  {
    "text": "Instruments has OAD over-the-air download and nordic has the fu device",
    "start": "581050",
    "end": "586390"
  },
  {
    "text": "firmware upgrade so the challenges in securing these solutions these frameworks are obvious right you need to",
    "start": "586390",
    "end": "594550"
  },
  {
    "text": "find a way to transfer the framer over B Lee in a secure manner so it can't be",
    "start": "594550",
    "end": "600340"
  },
  {
    "text": "captured really has encryption but in order to use that encryption the best",
    "start": "600340",
    "end": "605740"
  },
  {
    "text": "way to do so is to create a bond a baby bond which is the equivalent of bluetooth caring and so that's another",
    "start": "605740",
    "end": "614620"
  },
  {
    "text": "challenge you want these connections to be offer a bonded baby connection and then you want to use authentication",
    "start": "614620",
    "end": "620560"
  },
  {
    "text": "that's also connect connected to the fact you have you've done a billabong",
    "start": "620560",
    "end": "626320"
  },
  {
    "text": "trial so is the connection of antiquated can you validate who is doing simply",
    "start": "626320",
    "end": "631990"
  },
  {
    "text": "firmware upgrade and lastly but most importantly you want to validate the integrity of the femurs that has been",
    "start": "631990",
    "end": "637780"
  },
  {
    "text": "uploaded signature or in other means you want to validate the femur is really",
    "start": "637780",
    "end": "643380"
  },
  {
    "text": "trustworthy a lot in practice these frameworks exist for a few years but not",
    "start": "643380",
    "end": "650590"
  },
  {
    "text": "so many the recent versions are more secure but the ones today in market not that secure or not",
    "start": "650590",
    "end": "658300"
  },
  {
    "text": "secure at all the funeral encrypt order of the error gas connections is not as",
    "start": "658300",
    "end": "663790"
  },
  {
    "text": "indicated again this is by a different configuration each application can change this but but by default it's not",
    "start": "663790",
    "end": "671590"
  },
  {
    "text": "authenticated and the ephemeral is not validated or if it is validated it uses a weak replies before signature that can",
    "start": "671590",
    "end": "678250"
  },
  {
    "text": "be abused so when we looked in Aruba at this point we wanted to understand what",
    "start": "678250",
    "end": "685270"
  },
  {
    "start": "681000",
    "end": "681000"
  },
  {
    "text": "is the attack surface here and so the first thing we did is we tried to connect to get when the Aruba is in",
    "start": "685270",
    "end": "692710"
  },
  {
    "text": "weakening mode so and at this point has a different mode when it's using the",
    "start": "692710",
    "end": "699460"
  },
  {
    "text": "beedi functionalities but the most basic one is using a beginning mode it just sends out specific unique identifier",
    "start": "699460",
    "end": "706030"
  },
  {
    "text": "over advertising packets but to our surprise even in that mode the gas was",
    "start": "706030",
    "end": "711790"
  },
  {
    "text": "still open and we can connect to it and see the services that this device",
    "start": "711790",
    "end": "717310"
  },
  {
    "text": "exposes more interesting was the specific unique identifier which is ti0",
    "start": "717310",
    "end": "723070"
  },
  {
    "text": "ID service so it seems there is just may be the ability to upload from you to",
    "start": "723070",
    "end": "728890"
  },
  {
    "text": "this beauty tip over Oh Edie a bit about oh it in general just to",
    "start": "728890",
    "end": "735370"
  },
  {
    "start": "732000",
    "end": "732000"
  },
  {
    "text": "understand the mechanics of it it's pretty simple you have a user there is a",
    "start": "735370",
    "end": "740710"
  },
  {
    "text": "device you want to upload it if you were to create the first thing is initiating",
    "start": "740710",
    "end": "745900"
  },
  {
    "text": "a gas connection and then you can send an immediate identify message simple message with a single header in it and",
    "start": "745900",
    "end": "753400"
  },
  {
    "text": "if that's where is in the correct version or something something pretty simple the device will acknowledge it by",
    "start": "753400",
    "end": "760870"
  },
  {
    "text": "sending image block request which will then follow an image block message sent from the user to the device containing a",
    "start": "760870",
    "end": "767320"
  },
  {
    "text": "chunk of the femur and this will continue this process designing chunks of the femur will be in a loop until all",
    "start": "767320",
    "end": "774280"
  },
  {
    "text": "chunks have been sent at which point the device will reboot into the new femur so very straightforward",
    "start": "774280",
    "end": "780810"
  },
  {
    "text": "so naturally we tried just uploading our femur over already to their will at this point and it didn't really work we",
    "start": "780810",
    "end": "788760"
  },
  {
    "start": "782000",
    "end": "782000"
  },
  {
    "text": "initiated a got connection we sent an image identified but no response as we see so something was customized by",
    "start": "788760",
    "end": "795440"
  },
  {
    "text": "implementation we wanted to find out find out what so the logical next step let's open the stop let's hook up the",
    "start": "795440",
    "end": "802560"
  },
  {
    "start": "799000",
    "end": "799000"
  },
  {
    "text": "debugger and dump the femur and in fact",
    "start": "802560",
    "end": "807990"
  },
  {
    "text": "when looking at this function that does the functionalities in the femur we",
    "start": "807990",
    "end": "813720"
  },
  {
    "text": "noticed there is an additional call to mem compare ago so maybe added like I",
    "start": "813720",
    "end": "819030"
  },
  {
    "text": "mentioned something custom that validates you know it in some sense when",
    "start": "819030",
    "end": "825120"
  },
  {
    "start": "824000",
    "end": "824000"
  },
  {
    "text": "you look at the eyes Oh Edie function this function receives any gap right",
    "start": "825120",
    "end": "831120"
  },
  {
    "text": "request and then dispatches them to specific functions so it's very simple",
    "start": "831120",
    "end": "837780"
  },
  {
    "text": "you compare the unique identifier is being being waiting right now to the",
    "start": "837780",
    "end": "843630"
  },
  {
    "text": "image identifies new D and if it is so you you can call the function that",
    "start": "843630",
    "end": "848970"
  },
  {
    "text": "handles that that message and if if you",
    "start": "848970",
    "end": "854010"
  },
  {
    "text": "find it to be equal to another value for the image block method you can call that",
    "start": "854010",
    "end": "859860"
  },
  {
    "text": "function that handle exact message so it's very straightforward in a robust",
    "start": "859860",
    "end": "865470"
  },
  {
    "text": "implementation like I said we found that there is an additional code here in zooming in on the mem comparison that I",
    "start": "865470",
    "end": "872570"
  },
  {
    "text": "talked about before there is just two more mem compares or three more memo",
    "start": "872570",
    "end": "877950"
  },
  {
    "text": "compares here that validate another unique identifier and if you write a",
    "start": "877950",
    "end": "884610"
  },
  {
    "text": "specific unique identifier of the OED unlock team with a specific value with",
    "start": "884610",
    "end": "891330"
  },
  {
    "text": "OAD cookie then that unlocks a specific global state is already unlocked and if",
    "start": "891330",
    "end": "898350"
  },
  {
    "text": "you do this with another value that unlocks another state and this is some",
    "start": "898350",
    "end": "904500"
  },
  {
    "text": "cell record of the function that we were reverse engineered the early show so obviously every bad added in",
    "start": "904500",
    "end": "911570"
  },
  {
    "text": "character hot or a password to their implementation it is not me out one two three four but it's not a good solution",
    "start": "911570",
    "end": "918889"
  },
  {
    "text": "either way and so really what this is is",
    "start": "918889",
    "end": "925970"
  },
  {
    "text": "the ability to upload famer over be lean on Senate uh no physical connection using this haircut",
    "start": "925970",
    "end": "932930"
  },
  {
    "text": "password and then you can have your own methods code on this ble chip so what",
    "start": "932930",
    "end": "944839"
  },
  {
    "start": "938000",
    "end": "938000"
  },
  {
    "text": "what can an attacker do by gaining access to a really cheap in silent access point right is still initially is",
    "start": "944839",
    "end": "950750"
  },
  {
    "text": "still confined to only being affecting this specific chip continue is what is",
    "start": "950750",
    "end": "958220"
  },
  {
    "text": "the next step for him so at this point design is such that Billy chip has",
    "start": "958220",
    "end": "963889"
  },
  {
    "text": "access to to your interfaces zero York interfaces one of them is used for a",
    "start": "963889",
    "end": "971930"
  },
  {
    "text": "configuration of the ble chip form of the main CPU and from BD packets being",
    "start": "971930",
    "end": "977480"
  },
  {
    "text": "sent back from the Bailey chip to the main CPU so this interface is one avenue for an attacker to look for additional",
    "start": "977480",
    "end": "983600"
  },
  {
    "text": "vulnerabilities to try and target the main CPU of the lattice point but",
    "start": "983600",
    "end": "988730"
  },
  {
    "text": "another one exists here that is actually much simpler every access points can be",
    "start": "988730",
    "end": "994880"
  },
  {
    "text": "configured to allow a user to connect to a console to a terminal console over a",
    "start": "994880",
    "end": "1001720"
  },
  {
    "text": "BD connection so this is the same console you get if you can attack serial cable to a network device but this is",
    "start": "1001720",
    "end": "1008110"
  },
  {
    "text": "offered over BD connection you listed to be useful in some scenarios where they are at this point I needs to be",
    "start": "1008110",
    "end": "1014170"
  },
  {
    "text": "configured you know for network configurations but it's not physically accessible its way up in the ceiling or",
    "start": "1014170",
    "end": "1022300"
  },
  {
    "text": "something so this feature is implemented by the fact that the UART interface between the console and the main CPU is",
    "start": "1022300",
    "end": "1029199"
  },
  {
    "text": "shared with merely chip so the melee chip may be able to use this interface",
    "start": "1029199",
    "end": "1036209"
  },
  {
    "text": "by an attacker and get access to that shell interface and this interface",
    "start": "1036210",
    "end": "1041630"
  },
  {
    "text": "exposes few commands you can configure the network configurations of an access",
    "start": "1041630",
    "end": "1047819"
  },
  {
    "text": "point you can even send packets within the network it can be password protected but it actually can also be not",
    "start": "1047820",
    "end": "1054840"
  },
  {
    "text": "protected it's not them it must and that password can also potentially be good forced so it's not it's not allowed",
    "start": "1054840",
    "end": "1062730"
  },
  {
    "text": "security solution so how would an attack",
    "start": "1062730",
    "end": "1067800"
  },
  {
    "start": "1067000",
    "end": "1067000"
  },
  {
    "text": "with me look like how would it be carried out first like I mentioned you",
    "start": "1067800",
    "end": "1074640"
  },
  {
    "text": "can upload the mer-ka-ba chip using the hardware passwords then the attacker can",
    "start": "1074640",
    "end": "1080310"
  },
  {
    "text": "use the fumer that gives me access to this console connection although this",
    "start": "1080310",
    "end": "1086190"
  },
  {
    "text": "connection is configurable by the main CPU the ble chip is the one that carries",
    "start": "1086190",
    "end": "1091710"
  },
  {
    "text": "out whether it's on or off so once you're on that chip you can make it access that your interface regardless",
    "start": "1091710",
    "end": "1099440"
  },
  {
    "text": "looking at an entire network here or zooming out a bit and at this point will",
    "start": "1099440",
    "end": "1105690"
  },
  {
    "text": "generally have access to multiple segments right I preserve both the corporate network and in the guest network or maybe other segments so",
    "start": "1105690",
    "end": "1113040"
  },
  {
    "text": "gaining access to the main CPU of an access point can potentially lead in @rq",
    "start": "1113040",
    "end": "1118500"
  },
  {
    "text": "is all of these segments if the network is connected to the Internet like many",
    "start": "1118500",
    "end": "1123690"
  },
  {
    "text": "are in fact we can also take advantage of this and create an outbound connection to a C&C server and that at",
    "start": "1123690",
    "end": "1130470"
  },
  {
    "text": "that point he no longer needs to be in the same view of the device that he's attacking it doesn't need to use really",
    "start": "1130470",
    "end": "1136710"
  },
  {
    "text": "he can create a backdoor over that C&C connection and then the attack and continue over the Internet okay so we",
    "start": "1136710",
    "end": "1145260"
  },
  {
    "text": "wanted to to see how an attack like this will work and because we are also",
    "start": "1145260",
    "end": "1153120"
  },
  {
    "text": "engineers and we like the idea of it we decided to take the attack airborne as",
    "start": "1153120",
    "end": "1158310"
  },
  {
    "text": "you'd see in a minute [Music]",
    "start": "1158310",
    "end": "1168980"
  },
  {
    "text": "yeah so our office is in Tel Aviv in a",
    "start": "1168980",
    "end": "1174960"
  },
  {
    "text": "pine floor so we didn't want to see if we can come from the air literally in",
    "start": "1174960",
    "end": "1180990"
  },
  {
    "text": "attack in a row back this point sitting in our office we installed an Ubuntu on",
    "start": "1180990",
    "end": "1187100"
  },
  {
    "text": "an old nex-5 we attached to a drone I'm a hacker for this demonstration in the",
    "start": "1187100",
    "end": "1194340"
  },
  {
    "text": "smartphone is connected with the server connection to a scene server C&C server which the laptop is also connected to so",
    "start": "1194340",
    "end": "1200580"
  },
  {
    "text": "the laptop on the ground controls the smartphone in there so getting to the",
    "start": "1200580",
    "end": "1212930"
  },
  {
    "text": "27th floor was a little challenge and",
    "start": "1212930",
    "end": "1217980"
  },
  {
    "text": "the Maverick didn't really like the added weight but but he managed [Music]",
    "start": "1217980",
    "end": "1229770"
  },
  {
    "text": "[Music] in here on the table is their back this point waiting to be owned okay so once",
    "start": "1232450",
    "end": "1244730"
  },
  {
    "text": "once you're in the drone or the smartphone is nearby you can search for",
    "start": "1244730",
    "end": "1249980"
  },
  {
    "text": "beacons they're about access point using beginning mode right so you can find the MAC address by that you can see use the",
    "start": "1249980",
    "end": "1256909"
  },
  {
    "text": "gut tool to find the obd service and then we wrote this small script that",
    "start": "1256909",
    "end": "1262070"
  },
  {
    "text": "just uses the heart or the password we retrieved from the femur and uploads our own belief system or this is a bit sped",
    "start": "1262070",
    "end": "1269330"
  },
  {
    "text": "up but it takes about a minute to upload a few more so that fumer allows us",
    "start": "1269330",
    "end": "1277070"
  },
  {
    "text": "access unauthenticated to this shell interface so we just use the shell access on the AP and through this Billie",
    "start": "1277070",
    "end": "1284239"
  },
  {
    "text": "connection we can change network configurations you know we use if you",
    "start": "1284239",
    "end": "1289700"
  },
  {
    "text": "can figure out all of these commands and",
    "start": "1289700",
    "end": "1294769"
  },
  {
    "text": "you can also send packets within the network there is a ping command for that an interesting aspect is that the Billie",
    "start": "1294769",
    "end": "1302179"
  },
  {
    "text": "is connected to this console interface even throughout a boot of a reboot of",
    "start": "1302179",
    "end": "1307999"
  },
  {
    "text": "the device so by we're booting the AP through this interface we can access the bootloader shell over this media connection and",
    "start": "1307999",
    "end": "1315379"
  },
  {
    "text": "change boot parameters maybe potentially even upload like an older version of the",
    "start": "1315379",
    "end": "1321019"
  },
  {
    "text": "entire ap or something and I mean as I",
    "start": "1321019",
    "end": "1328639"
  },
  {
    "text": "mentioned if the attacker does achieve code execution on the main CPU he can create an out world connection and then",
    "start": "1328639",
    "end": "1334159"
  },
  {
    "text": "this is the vicinity of the drone is no longer needed",
    "start": "1334159",
    "end": "1339158"
  },
  {
    "text": "[Music]",
    "start": "1340870",
    "end": "1344460"
  },
  {
    "text": "okay yeah so this is one ability the",
    "start": "1349629",
    "end": "1354769"
  },
  {
    "text": "rubberband is significant but we have more to discuss so this second ability",
    "start": "1354769",
    "end": "1359960"
  },
  {
    "text": "as I mentioned is in T is Billy stack and intersect system rocky and access points but potentially other devices and",
    "start": "1359960",
    "end": "1367009"
  },
  {
    "start": "1367000",
    "end": "1367000"
  },
  {
    "text": "this mobility is in the code that parses beacons parses incoming packets in Billy",
    "start": "1367009",
    "end": "1373159"
  },
  {
    "text": "you have different roles a device can be scanner it's kind of role for an advertiser role and it's simple right",
    "start": "1373159",
    "end": "1380899"
  },
  {
    "text": "when one device would send out beacons through what is called advertising packets and the other will listen to",
    "start": "1380899",
    "end": "1386269"
  },
  {
    "text": "these packets and in parse them as they come in and you have three channels for",
    "start": "1386269",
    "end": "1391789"
  },
  {
    "text": "that are fixed channels for advertising packets on Billy and so the advertiser will send these packets on all of these",
    "start": "1391789",
    "end": "1398330"
  },
  {
    "text": "channels and the scanner will hop between these three between the frequencies and listen to these packets a Billy packet is has a structure that",
    "start": "1398330",
    "end": "1407719"
  },
  {
    "start": "1404000",
    "end": "1404000"
  },
  {
    "text": "is pretty straightforward you have a preamble fixed access address and then a PDU that is different between shape this",
    "start": "1407719",
    "end": "1414259"
  },
  {
    "text": "advertising channel or another channel in advertising channel you have two bytes header and then service up to 37",
    "start": "1414259",
    "end": "1422450"
  },
  {
    "text": "bytes of payload this two byte header is built up with different flags but there",
    "start": "1422450",
    "end": "1430129"
  },
  {
    "text": "is one interesting piece here that I want to mention there is a length field in the header and that actually changed",
    "start": "1430129",
    "end": "1438739"
  },
  {
    "text": "the length field changed between Bluetooth for point tool in verses five with the five is now becoming",
    "start": "1438739",
    "end": "1444639"
  },
  {
    "text": "interesting to the market so chips are being designed to use this new protocol",
    "start": "1444639",
    "end": "1450429"
  },
  {
    "text": "and the length field between four point two and will size increased from six bits to a bit and in the order of",
    "start": "1450429",
    "end": "1459109"
  },
  {
    "text": "version in 4.20 an additional two bits in that bite reserved for future use are",
    "start": "1459109",
    "end": "1465979"
  },
  {
    "text": "a few bits and they were also always supposed to be 0 bits so this change in",
    "start": "1465979",
    "end": "1471019"
  },
  {
    "text": "the specification might have in retrospect leave it to the variability that we",
    "start": "1471019",
    "end": "1477200"
  },
  {
    "text": "found we're not sure but but this looks ominous right the fact that the length field has changes as a potential for for",
    "start": "1477200",
    "end": "1485600"
  },
  {
    "text": "bugs looking specifically on the architecture of TI is a really chip it's",
    "start": "1485600",
    "end": "1493340"
  },
  {
    "start": "1487000",
    "end": "1487000"
  },
  {
    "text": "a it's a part of quite an interesting device you have you have two cores you",
    "start": "1493340",
    "end": "1498410"
  },
  {
    "text": "have the main CPU that's running an arm CPU and this one does most of the logic",
    "start": "1498410",
    "end": "1503690"
  },
  {
    "text": "work most of the Billy stack logic and then you have your radio color that also",
    "start": "1503690",
    "end": "1510740"
  },
  {
    "text": "runs it now scene CPU and that one does the more more physical layer stuff and",
    "start": "1510740",
    "end": "1515930"
  },
  {
    "text": "it really the low-level handling of packets and the link layer is actually",
    "start": "1515930",
    "end": "1521030"
  },
  {
    "text": "split between these two cores and they have a shared interface to exchange the",
    "start": "1521030",
    "end": "1526640"
  },
  {
    "text": "packets that are coming in there are also systems where you have an",
    "start": "1526640",
    "end": "1531950"
  },
  {
    "text": "additional CPU like an access point so the application layer will be split between the Billy chip and the external",
    "start": "1531950",
    "end": "1538280"
  },
  {
    "text": "or CPU over some interface other york the face or not or another like many",
    "start": "1538280",
    "end": "1544610"
  },
  {
    "text": "devices and other devices right there there is no inherent security in this",
    "start": "1544610",
    "end": "1550250"
  },
  {
    "text": "chip there is no use of data execution prevention no ASLR and no mmm you",
    "start": "1550250",
    "end": "1555680"
  },
  {
    "text": "so finding availability here still has",
    "start": "1555680",
    "end": "1561590"
  },
  {
    "text": "the challenge of being able to exploit it like any other one Willa T but the chip itself will not stop availability",
    "start": "1561590",
    "end": "1568730"
  },
  {
    "text": "with inherent mitigations okay looking at this function this is the function",
    "start": "1568730",
    "end": "1574700"
  },
  {
    "start": "1571000",
    "end": "1571000"
  },
  {
    "text": "that parses advertising packets as they are coming into the chip when it is",
    "start": "1574700",
    "end": "1580460"
  },
  {
    "text": "scanning for advertising packets and it will do some person of the tacit in some",
    "start": "1580460",
    "end": "1587920"
  },
  {
    "text": "handling of different types of packets and such I mean instantly we see that",
    "start": "1587920",
    "end": "1594110"
  },
  {
    "text": "there are a few problems in this function the first thing is this handling of the length field that I",
    "start": "1594110",
    "end": "1599720"
  },
  {
    "text": "talked about as I mentioned it's supposed to be six bits but this code here takes the entire",
    "start": "1599720",
    "end": "1605090"
  },
  {
    "text": "eight dates from the header and calls it the pack I didn't interact this is the packet",
    "start": "1605090",
    "end": "1610580"
  },
  {
    "text": "length so it doesn't mask out the RFU mix the reserve bits in the second",
    "start": "1610580",
    "end": "1615769"
  },
  {
    "text": "problem here is the third line on that red box where the code will increase six",
    "start": "1615769",
    "end": "1622549"
  },
  {
    "text": "bytes from the packet length so there's a potential here to do an intro and the",
    "start": "1622549",
    "end": "1628820"
  },
  {
    "text": "data length is actually actually a signed integer in this if case and so if",
    "start": "1628820",
    "end": "1635029"
  },
  {
    "text": "it is a small number if it's minus 1 or minus 2 or something it won't be",
    "start": "1635029",
    "end": "1640100"
  },
  {
    "text": "detected as a large packet but even if it is detected the function that is",
    "start": "1640100",
    "end": "1645590"
  },
  {
    "text": "called the hull of sir handler is actually a null function that does nothing so the code will carry on and",
    "start": "1645590",
    "end": "1652659"
  },
  {
    "text": "there is a copy loop at the end of the function using the packet things pass to it it will copy then tack it onto the",
    "start": "1652659",
    "end": "1660950"
  },
  {
    "text": "advertising data pointer so this is many power lines here in the next step for us",
    "start": "1660950",
    "end": "1667820"
  },
  {
    "text": "is let's try and crash it let's send different packets and see what happens you mentioned there are the length field",
    "start": "1667820",
    "end": "1676309"
  },
  {
    "start": "1668000",
    "end": "1668000"
  },
  {
    "text": "which is 6 bits but you also have the RFU bits and all the 8 bits together are considered as the length of a packet so",
    "start": "1676309",
    "end": "1682190"
  },
  {
    "text": "we have a couple of parameters to to play with initial step was let's send",
    "start": "1682190",
    "end": "1687919"
  },
  {
    "text": "the largest package we can in the 8 bits motive in crash so ok something is not as expected right now the next step was",
    "start": "1687919",
    "end": "1695870"
  },
  {
    "text": "write and send a very small packet right maybe we can hit this integer on the flow but this also doesn't crash next",
    "start": "1695870",
    "end": "1703460"
  },
  {
    "text": "thing we thought maybe we can't really touch these bits there are a few bits so let's send the largest package we can",
    "start": "1703460",
    "end": "1709039"
  },
  {
    "text": "within 6 bits if we all also be changing out of bounds but it's also Democrats",
    "start": "1709039",
    "end": "1715419"
  },
  {
    "text": "just or sanity check we decided to send the large packet we can within the",
    "start": "1715419",
    "end": "1721370"
  },
  {
    "text": "specification limit the service 7 by its packet this limit privacy did reach the",
    "start": "1721370",
    "end": "1726620"
  },
  {
    "text": "code that we were looking looking at so we are partially in the right direction and last let's try and turn on one of",
    "start": "1726620",
    "end": "1733460"
  },
  {
    "text": "the RFU bits but keep the packet at SRI 7 bytes so it is a short packet but it",
    "start": "1733460",
    "end": "1739370"
  },
  {
    "text": "may be be perceived by the code as a large packet which will result in corruption and in fact that did pass the device so",
    "start": "1739370",
    "end": "1748790"
  },
  {
    "text": "we understood there is another mechanism here that validates the input other than cut the code we were looking at what is",
    "start": "1748790",
    "end": "1754550"
  },
  {
    "text": "that mechanism as I mentioned the mains appear in the radio core share the links",
    "start": "1754550",
    "end": "1759680"
  },
  {
    "text": "are there both do part of it and when we went back to the manual it was clear",
    "start": "1759680",
    "end": "1765170"
  },
  {
    "text": "that the radio validates packets to be between 6 and 37 bytes but when we look",
    "start": "1765170",
    "end": "1773210"
  },
  {
    "start": "1773000",
    "end": "1773000"
  },
  {
    "text": "at the code from the radio code we see that it looks at the length of the packet as 6 bits as the fine defined in",
    "start": "1773210",
    "end": "1779150"
  },
  {
    "text": "the specification where is the main core looked at the entire 8 bits so this difference leads to this one ability by",
    "start": "1779150",
    "end": "1787970"
  },
  {
    "text": "sending a small packet but turning on one of the are a few bits or both of them it would result in a memory",
    "start": "1787970",
    "end": "1793640"
  },
  {
    "text": "corruption and how we exploited this corruption and on the Cisco access point towards back to talk to you now okay so",
    "start": "1793640",
    "end": "1803330"
  },
  {
    "text": "I'm gonna dive deep into exploiting this vulnerability but before we start exploiting we need that victim so we",
    "start": "1803330",
    "end": "1810230"
  },
  {
    "start": "1807000",
    "end": "1807000"
  },
  {
    "text": "chose this Cisco IP to exploit the tone because it contains the CC 26:40 chip",
    "start": "1810230",
    "end": "1815390"
  },
  {
    "text": "and naturally we opened it up hooked up a debugger and the funeral started nothing standing where the data that is",
    "start": "1815390",
    "end": "1822380"
  },
  {
    "text": "being that is corrupting and what are we exactly corrupting so looking back at",
    "start": "1822380",
    "end": "1827990"
  },
  {
    "text": "the vulnerable function that Ben talked about you can see that the advertising that our variable is coming from the",
    "start": "1827990",
    "end": "1833450"
  },
  {
    "text": "caller function which is advertising packet advertising packet is a global variable that is statically allocated in",
    "start": "1833450",
    "end": "1841310"
  },
  {
    "start": "1837000",
    "end": "1837000"
  },
  {
    "text": "memory which is its inari array that contains the advertising packet that has arrived and it's it's a new fixed",
    "start": "1841310",
    "end": "1849380"
  },
  {
    "text": "address it's been mentioned there are no SLR no def here so it will be allocated at the same address every time and",
    "start": "1849380",
    "end": "1854990"
  },
  {
    "text": "there's a lot of interesting stuff to overflow after it's in the data section so the one that sticks out the most are",
    "start": "1854990",
    "end": "1862400"
  },
  {
    "text": "the these three function pointers which are system critical function pointers",
    "start": "1862400",
    "end": "1868760"
  },
  {
    "text": "the Deaf in what he uses so the first point of the I call dispatcher is this Tim Colgate way every system called the",
    "start": "1868760",
    "end": "1875460"
  },
  {
    "text": "firm makes every mullick goes through there that looks like a really good target for us to control and the other",
    "start": "1875460",
    "end": "1881580"
  },
  {
    "text": "two are the enter and exit critical section function pointer which does exactly that it looks good as well they",
    "start": "1881580",
    "end": "1888779"
  },
  {
    "text": "are called quite often Li but not as much as the dispatcher so we're gonna head for for it so going back to the",
    "start": "1888779",
    "end": "1895590"
  },
  {
    "start": "1895000",
    "end": "1895000"
  },
  {
    "text": "funnel well function you can see the data that the function parses is coming from some data entry key so we needed to",
    "start": "1895590",
    "end": "1902580"
  },
  {
    "text": "do some research and understand what is this data cue and where does this data come from so this data cue is basically",
    "start": "1902580",
    "end": "1909960"
  },
  {
    "text": "four entries of packets that arrives from between the radio current main core",
    "start": "1909960",
    "end": "1915450"
  },
  {
    "text": "it is allocated in a shared ram memory between those cores and it's linked",
    "start": "1915450",
    "end": "1921269"
  },
  {
    "text": "together to form a cyclic list and also they are contiguous in memory so let's",
    "start": "1921269",
    "end": "1926580"
  },
  {
    "text": "go over quickly how would the packet that is being received would look like so the pack the radio core and the main",
    "start": "1926580",
    "end": "1933629"
  },
  {
    "start": "1931000",
    "end": "1931000"
  },
  {
    "text": "core starts off at the start of the this list the radio chorus if the packet from there so it needs to mark the entry as",
    "start": "1933629",
    "end": "1940109"
  },
  {
    "text": "being used goes on and fills the data and then freeze the entries so the main core can now start passing it",
    "start": "1940109",
    "end": "1946499"
  },
  {
    "text": "while the main core is passing it the radio core had received another packet from the air and filled it up in the",
    "start": "1946499",
    "end": "1952499"
  },
  {
    "text": "next entry so the main core can go on and pass it as well this happens in the cyclic motion meaning that when the",
    "start": "1952499",
    "end": "1959309"
  },
  {
    "text": "radio call will hit the fourth entry it will go back to the first entry and so on and so forth okay so now that we",
    "start": "1959309",
    "end": "1966179"
  },
  {
    "text": "understand where the data is coming from let's look at this scenario a normal advertising packet had arrived and then",
    "start": "1966179",
    "end": "1973080"
  },
  {
    "start": "1970000",
    "end": "1970000"
  },
  {
    "text": "the vulnerable function had copied it onto the advertising packet global variable okay so far so good another",
    "start": "1973080",
    "end": "1979080"
  },
  {
    "text": "normal advertising packet had come same here but now a triggering packet",
    "start": "1979080",
    "end": "1984269"
  },
  {
    "text": "had arrived meaning that we have turned on one or two of there are a few bits inside those packet but it's in the",
    "start": "1984269",
    "end": "1990269"
  },
  {
    "text": "legitimate length and now one out of bands copy will be initiated inside this",
    "start": "1990269",
    "end": "1995309"
  },
  {
    "text": "function and we can see that the data that resides inside entry number three will be copied onto the I call pointers",
    "start": "1995309",
    "end": "2002419"
  },
  {
    "text": "that you would like to control okay so this gives us a little bit of hint of where will the data that we want to",
    "start": "2002419",
    "end": "2008640"
  },
  {
    "text": "control will be held if this happens in the second entry then the fourth entry",
    "start": "2008640",
    "end": "2013650"
  },
  {
    "text": "will will be copied onto the I call pointers but what happens if it will trigger from the third or the fourth",
    "start": "2013650",
    "end": "2019890"
  },
  {
    "text": "entry we copied that of one after the data entry queue which we cannot hope to",
    "start": "2019890",
    "end": "2025020"
  },
  {
    "text": "control and this puts this form of exploitation at 50% success rate so now",
    "start": "2025020",
    "end": "2031409"
  },
  {
    "start": "2031000",
    "end": "2031000"
  },
  {
    "text": "that we understand that we would like to control data entries that are not the triggering one we need obviously to",
    "start": "2031409",
    "end": "2036929"
  },
  {
    "text": "spray this data entry queue so I'm gonna go back a little bit about how Billy does is advertising",
    "start": "2036929",
    "end": "2044100"
  },
  {
    "text": "basically there are three advertising channels or frequencies which advertising packets are sent on and the",
    "start": "2044100",
    "end": "2051060"
  },
  {
    "text": "radio car is gonna hop between them looking for advertising packets so basically if you want or the radio code",
    "start": "2051060",
    "end": "2057179"
  },
  {
    "text": "to receive a spray packet every time we're gonna need to be on all three channels also the radio the main core",
    "start": "2057179",
    "end": "2062820"
  },
  {
    "text": "the radio co-head has a packet duplication mechanism that helps it",
    "start": "2062820",
    "end": "2067919"
  },
  {
    "text": "prevent seeing duplicated packets and basically it validates that it hadn't seen this packet from the same sender",
    "start": "2067919",
    "end": "2073830"
  },
  {
    "text": "from the same MAC address so basically we're just gonna randomize every MAC address of the packet and then we will",
    "start": "2073830",
    "end": "2079378"
  },
  {
    "text": "easily circumvent this mechanism so now that we understand how we're gonna spray we're basically just gonna spray packets",
    "start": "2079379",
    "end": "2086638"
  },
  {
    "start": "2084000",
    "end": "2084000"
  },
  {
    "text": "that hold out desired I call values that we would like to put on the I call pointers and then after some time we're",
    "start": "2086639",
    "end": "2093060"
  },
  {
    "text": "gonna trigger the overflow and do it again and again hoping to fall into the right place inside scanning process so",
    "start": "2093060",
    "end": "2099630"
  },
  {
    "text": "our strategy is as follows will trigger the path the open flow from one entry",
    "start": "2099630",
    "end": "2105270"
  },
  {
    "text": "while copying on to the icon pointers and now we need to put meaningful values inside those I call pointers so we could",
    "start": "2105270",
    "end": "2111540"
  },
  {
    "text": "execute code so it's been mentioned we have no def here meaning we can execute data and we know exactly where our",
    "start": "2111540",
    "end": "2117300"
  },
  {
    "text": "overflow packet will be held because it's in advertising packet so let's put this",
    "start": "2117300",
    "end": "2122550"
  },
  {
    "text": "address inside I call dispatcher and then when the next sis call is called we'll just jump on to our packet and",
    "start": "2122550",
    "end": "2128460"
  },
  {
    "text": "execute our packet sounds simple enough but we have a lot of limitations on this",
    "start": "2128460",
    "end": "2133650"
  },
  {
    "start": "2132000",
    "end": "2132000"
  },
  {
    "text": "exploitation first every advertising packet holds 37 bytes maximum of data",
    "start": "2133650",
    "end": "2139740"
  },
  {
    "text": "so we control the trigger packet and we control the spray packet but spray packet has three icon pointers values it",
    "start": "2139740",
    "end": "2146790"
  },
  {
    "text": "needs the whole so we are left with 62 shell called bytes that we can use in",
    "start": "2146790",
    "end": "2153210"
  },
  {
    "text": "our exploitation this is not a lot of bytes to maneuver within but let's talk about the task at hand that we're gonna",
    "start": "2153210",
    "end": "2159750"
  },
  {
    "start": "2158000",
    "end": "2158000"
  },
  {
    "text": "need to do inside those 62 bytes we're going to prevent future over fuel crashes I'm going to talk about it in a",
    "start": "2159750",
    "end": "2165180"
  },
  {
    "text": "bit we're going to install some sort of backdoor because we want to keep communicating with the chip and controlling it and we're gonna need to",
    "start": "2165180",
    "end": "2172020"
  },
  {
    "text": "restore the chip state because we are running from a sis call that runs a",
    "start": "2172020",
    "end": "2177089"
  },
  {
    "text": "packet which the system things were kind of in a weird state and we're going to need to restore its original state so it",
    "start": "2177089",
    "end": "2183570"
  },
  {
    "text": "will keep scanning as usual and we have corrupted a lot of that on our way to the I call point is basically a 109",
    "start": "2183570",
    "end": "2190710"
  },
  {
    "text": "bytes of corrupted data that was written by our overflow until we hit the I call",
    "start": "2190710",
    "end": "2197070"
  },
  {
    "text": "pointers without control values this is more bytes that we corrupt then we can actually control in this exploitation",
    "start": "2197070",
    "end": "2203430"
  },
  {
    "text": "because we have only 62 shellcode bytes meaning that if we will bring all the data with us we basically have on a",
    "start": "2203430",
    "end": "2209940"
  },
  {
    "text": "little bit more than half of the bytes that we need to restore so we're gonna need to find a solution for that and",
    "start": "2209940",
    "end": "2215580"
  },
  {
    "text": "also we're gonna need to return some error value because we don't have enough bytes to actually do the system call",
    "start": "2215580",
    "end": "2221070"
  },
  {
    "text": "that is expected of us because we are running from a 16 call back and then we're gonna need to patch the system",
    "start": "2221070",
    "end": "2227520"
  },
  {
    "text": "call address back the I call this patch it back to its original value so we want and we want to be called every time a",
    "start": "2227520",
    "end": "2234330"
  },
  {
    "text": "system call happened then the system can continue as usual so I looked at it at",
    "start": "2234330",
    "end": "2240030"
  },
  {
    "text": "first I was like oh man it can't be done like logically we don't have enough bytes to do it and I remember talking",
    "start": "2240030",
    "end": "2246480"
  },
  {
    "text": "with Ben about it and saying let's just not exploit this whenever it's it's too much but Ben told me let's take it part",
    "start": "2246480",
    "end": "2252390"
  },
  {
    "text": "by part and so I will take you through part by part of our exploitation so the",
    "start": "2252390",
    "end": "2258000"
  },
  {
    "start": "2257000",
    "end": "2257000"
  },
  {
    "text": "first problem is preventing future overflows what do I mean by that let's imagine a trigger packet had arrived in",
    "start": "2258000",
    "end": "2263550"
  },
  {
    "text": "entry number 2 and we controlled with Osprey an entry number 4 now the overflow will be triggered our",
    "start": "2263550",
    "end": "2269580"
  },
  {
    "text": "code will run and everything is good in the world but what happens if another trigger packet just arrived in",
    "start": "2269580",
    "end": "2274640"
  },
  {
    "text": "entry number three so after a shell code has gotten executed the main code will",
    "start": "2274640",
    "end": "2280580"
  },
  {
    "text": "go on to pass the third entry and then copy uncontrolled data on the I call pointers and basically crush the chip if",
    "start": "2280580",
    "end": "2287120"
  },
  {
    "text": "this is left unfixed we will eventually sometime crush the chip so this is well",
    "start": "2287120",
    "end": "2292610"
  },
  {
    "text": "obviously we need to find a way to fix it so let's assume our triggered packet",
    "start": "2292610",
    "end": "2298010"
  },
  {
    "text": "was from the second entry and now we can we have executed code we do this nifty",
    "start": "2298010",
    "end": "2303650"
  },
  {
    "text": "little trick where we link the same entry that triggered the vulnerability to itself effectively freezing other",
    "start": "2303650",
    "end": "2309830"
  },
  {
    "text": "entries from being touched by the mango or the radio core because now they don't even know they exist and now when the",
    "start": "2309830",
    "end": "2316970"
  },
  {
    "text": "when another packet will come the radio will fill the second entry but the mango will have to wait until it finish",
    "start": "2316970",
    "end": "2323270"
  },
  {
    "text": "because the entry the data entry cue is only one entry long so now when the mango will parse it everything is good",
    "start": "2323270",
    "end": "2329720"
  },
  {
    "text": "but now another trigger packet has come no problem because we're in the same pool state that we used and now the copy",
    "start": "2329720",
    "end": "2336320"
  },
  {
    "text": "will be called again and we'll still won't crush the chip but the execute code again meaning that when we first",
    "start": "2336320",
    "end": "2342620"
  },
  {
    "text": "succeed we will succeed every time after doing this trick this trick costs us about three armed instructions that's",
    "start": "2342620",
    "end": "2349550"
  },
  {
    "text": "not a lot and we are left with 56 shellcode bytes okay so now the hard",
    "start": "2349550",
    "end": "2356300"
  },
  {
    "text": "part we need to restore execution of the chip to its original state I don't have the time to go into everything but I'm",
    "start": "2356300",
    "end": "2363920"
  },
  {
    "start": "2358000",
    "end": "2358000"
  },
  {
    "text": "just gonna talk about after a lot of research we did we found that these variables must be restored for in order",
    "start": "2363920",
    "end": "2369320"
  },
  {
    "text": "for the chip to be in its original state so we wrote some code that does exactly that",
    "start": "2369320",
    "end": "2374600"
  },
  {
    "text": "but I haven't mentioned our overflow will corrupt some gap task related",
    "start": "2374600",
    "end": "2380630"
  },
  {
    "text": "variables there that are 16 bytes long so now after restoring everything we need and we have 17 banks of shellcode",
    "start": "2380630",
    "end": "2387860"
  },
  {
    "text": "left for us to do logic we need to restore sixteen bytes of data which",
    "start": "2387860",
    "end": "2393380"
  },
  {
    "text": "means that even we can do it in zero instructions we'll still have one shellcode bytes for for our logic to do",
    "start": "2393380",
    "end": "2400490"
  },
  {
    "text": "which basically is a half of our arm instruction so our expert just restores",
    "start": "2400490",
    "end": "2405560"
  },
  {
    "text": "execution and does nothing this is obviously bad and we're gonna need to go back to the drawing",
    "start": "2405560",
    "end": "2410900"
  },
  {
    "text": "board and take an 8-second look at this so we did some more research and found",
    "start": "2410900",
    "end": "2417770"
  },
  {
    "start": "2415000",
    "end": "2415000"
  },
  {
    "text": "out that basically if we stop the gab desk from ever running again we can just",
    "start": "2417770",
    "end": "2422839"
  },
  {
    "text": "restore those three variables put a null inside one of the gap test callbacks",
    "start": "2422839",
    "end": "2428270"
  },
  {
    "text": "which make it would make it stop running and then we can just restore those three variables making it not that byte",
    "start": "2428270",
    "end": "2437119"
  },
  {
    "text": "expensive for us to restore those those variables and we could now do we now",
    "start": "2437119",
    "end": "2443810"
  },
  {
    "text": "have 32 shellcode bytes for us to maneuver within it's still not a lot but it's list it's something so now that we",
    "start": "2443810",
    "end": "2451339"
  },
  {
    "text": "have restored the execution we're gonna need to install some form of a backdoor because we have only 32 bytes of",
    "start": "2451339",
    "end": "2457250"
  },
  {
    "start": "2453000",
    "end": "2453000"
  },
  {
    "text": "shellcode left we're gonna need a vector to be really really a lightweight in size efficient and also we would like to",
    "start": "2457250",
    "end": "2463130"
  },
  {
    "text": "put there somewhere it won't cost us a lot of time and instructions to install",
    "start": "2463130",
    "end": "2468650"
  },
  {
    "text": "the hook for our back door so our back door that we come up with will be this",
    "start": "2468650",
    "end": "2473930"
  },
  {
    "text": "better it's only 8 bytes long it will it will sit our shellcode will read rewrite",
    "start": "2473930",
    "end": "2479930"
  },
  {
    "text": "it just above the advertising packet by global variable what it does is basically checks if the first four bytes",
    "start": "2479930",
    "end": "2486740"
  },
  {
    "text": "of the packet that has been received is a magic value in this case PC but because everything is static we can",
    "start": "2486740",
    "end": "2493040"
  },
  {
    "text": "predict PC every time and if it's the magic value it will jump over it and just execute our packet that's great and",
    "start": "2493040",
    "end": "2500440"
  },
  {
    "text": "we need some we need now we need some run time for our back though so remember we control the I call pointers so why",
    "start": "2500440",
    "end": "2507500"
  },
  {
    "text": "not use the other two we'll use the entry critical section to execute our back door it is called many times during",
    "start": "2507500",
    "end": "2513859"
  },
  {
    "text": "one packet parsing making sure our back toe will be called every time a new packet has arrived and we'll use the exit critical section",
    "start": "2513859",
    "end": "2520520"
  },
  {
    "text": "basically because we don't have enough bytes in the end through and in our back door to do the actual enter critical",
    "start": "2520520",
    "end": "2526280"
  },
  {
    "text": "section we'll just put a gadget that does nothing inside the exit critical section and when this mechanism useless",
    "start": "2526280",
    "end": "2531829"
  },
  {
    "text": "but still we get some execution time for back though so let's recap all of our",
    "start": "2531829",
    "end": "2537530"
  },
  {
    "text": "back door first we set up some environment they're reading some",
    "start": "2537530",
    "end": "2543079"
  },
  {
    "start": "2538000",
    "end": "2538000"
  },
  {
    "text": "variables into registers then we're gonna stop the gap tasks from running we're gonna install our back though this",
    "start": "2543079",
    "end": "2548210"
  },
  {
    "text": "is to store instructions because our back door is only eight bytes long then we're gonna link the data entry that has",
    "start": "2548210",
    "end": "2554780"
  },
  {
    "text": "triggered the vulnerability to itself using other entries in making sure we won't crash in the next figure then",
    "start": "2554780",
    "end": "2561050"
  },
  {
    "text": "we're going to restore our corrupted values as I mentioned we need to restore only two variables the time I had in the",
    "start": "2561050",
    "end": "2566060"
  },
  {
    "text": "Bailey dispatch task ID and then we're gonna unhook ourselves from the Cisco and Gateway because we want we don't",
    "start": "2566060",
    "end": "2573200"
  },
  {
    "text": "want to run again and that's it basically we have exploited the CC 2640",
    "start": "2573200",
    "end": "2578270"
  },
  {
    "text": "with only 32 bytes of shellcode that we had in our disposal and now I'm gonna press the stage to vendors gonna talk",
    "start": "2578270",
    "end": "2585290"
  },
  {
    "text": "about the demo thank you",
    "start": "2585290",
    "end": "2588700"
  },
  {
    "text": "[Applause] so as you as you saw it was quite",
    "start": "2590540",
    "end": "2597740"
  },
  {
    "text": "challenging to achieve execution through this small bug but but eventually we did",
    "start": "2597740",
    "end": "2604730"
  },
  {
    "text": "it I don't show a small a short video on how this is exploited so you have again",
    "start": "2604730",
    "end": "2613450"
  },
  {
    "text": "with hacker it controls Raspberry Pi that is going to be too if that device can be used to",
    "start": "2613450",
    "end": "2621770"
  },
  {
    "text": "send baby packets custom packets and this attacks a Cisco at this point on",
    "start": "2621770",
    "end": "2626930"
  },
  {
    "text": "the right we can see the attackers scanning for ble beacons when the attack is finished we will see the targeted",
    "start": "2626930",
    "end": "2634010"
  },
  {
    "text": "device beginning a specific message a specific so on the Left we can see the",
    "start": "2634010",
    "end": "2641060"
  },
  {
    "text": "attack going on we send the spray packets we send the trigger overflow and now once we have a backdoor we upload",
    "start": "2641060",
    "end": "2646849"
  },
  {
    "text": "our specific beacon data onto the device using that regular back door and we tell",
    "start": "2646849",
    "end": "2654440"
  },
  {
    "text": "the chip to start advertising this malicious weekend and you can see on the right the AP is saying it has been owned",
    "start": "2654440",
    "end": "2663260"
  },
  {
    "text": "and an indication of compromise from familiar just from the BJP hands",
    "start": "2663260",
    "end": "2670599"
  },
  {
    "text": "so in that state in any device nearby that scans from Billy weekend's like my",
    "start": "2670599",
    "end": "2676010"
  },
  {
    "text": "smartphone will show that in fact the beacon is saying you're a piece we don't",
    "start": "2676010",
    "end": "2683300"
  },
  {
    "text": "us okay so yes we really at the end I",
    "start": "2683300",
    "end": "2701750"
  },
  {
    "text": "just want to tip to talk about three takeaways I think should be taken from",
    "start": "2701750",
    "end": "2708920"
  },
  {
    "text": "this research first the fact that Billy chips were either chips that are",
    "start": "2708920",
    "end": "2716480"
  },
  {
    "text": "sometimes considered peripheral chips can also be vulnerable to attack right they have CPUs they run code they can be",
    "start": "2716480",
    "end": "2722869"
  },
  {
    "text": "vulnerable if they are vulnerable this can lead to something greater this can",
    "start": "2722869",
    "end": "2728329"
  },
  {
    "text": "lead in an access point environment for example through network breach so you can start for something very small like",
    "start": "2728329",
    "end": "2733790"
  },
  {
    "text": "a Billy chip but this can go on and then target in an entire network and third",
    "start": "2733790",
    "end": "2739910"
  },
  {
    "text": "the fact is that access points in network infrastructure devices in general or practically also unmanaged",
    "start": "2739910",
    "end": "2746240"
  },
  {
    "text": "devices the Billy chip inside the access point is not managed right the access",
    "start": "2746240",
    "end": "2751819"
  },
  {
    "text": "point itself is just a device that service Wi-Fi it doesn't have an agent on it it doesn't have too many too much",
    "start": "2751819",
    "end": "2757640"
  },
  {
    "text": "inherent security so in the global like you zooming out from the bits that we",
    "start": "2757640",
    "end": "2763579"
  },
  {
    "text": "talked about the general picture and obviously this is a smart language that",
    "start": "2763579",
    "end": "2769490"
  },
  {
    "text": "should be looked at we have a white paper that detail is all of what we",
    "start": "2769490",
    "end": "2774859"
  },
  {
    "text": "talked about in detail on our website and all the affected devices and what",
    "start": "2774859",
    "end": "2780200"
  },
  {
    "text": "abilities obviously we disclose your process which I haven't talked about but it's also detailed in this website and I",
    "start": "2780200",
    "end": "2787910"
  },
  {
    "text": "think we have like three minutes for questions if anybody want to ask",
    "start": "2787910",
    "end": "2792818"
  },
  {
    "text": "maybe we were really really clear that's a good sign right thank you very much",
    "start": "2796800",
    "end": "2808790"
  },
  {
    "text": "[Applause]",
    "start": "2808790",
    "end": "2812540"
  }
]