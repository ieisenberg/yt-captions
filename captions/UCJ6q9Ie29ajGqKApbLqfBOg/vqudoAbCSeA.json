[
  {
    "start": "0",
    "end": "82000"
  },
  {
    "text": "so as i said my name is gavin akibly i will be presenting uh this stock owning the routing table",
    "start": "160",
    "end": "6560"
  },
  {
    "text": "uh which i will be presenting a new and powerful routing attack",
    "start": "6560",
    "end": "11759"
  },
  {
    "text": "uh the reason this attack is powerful because it exploits a vulnerability which actually",
    "start": "11759",
    "end": "17600"
  },
  {
    "text": "lies within the standard of the ospf routing protocol",
    "start": "17600",
    "end": "24880"
  },
  {
    "text": "now ospf is one of the common routing protocols around and",
    "start": "25359",
    "end": "31439"
  },
  {
    "text": "since it the vulnerability lies within the standout of the protocol as you will shortly see many router",
    "start": "31439",
    "end": "38399"
  },
  {
    "text": "vendors are indeed affected by this vulnerability um this is actually a second part of our",
    "start": "38399",
    "end": "46320"
  },
  {
    "text": "work or our research on ospf security the first part we presented here at blackhead two years ago",
    "start": "46320",
    "end": "53039"
  },
  {
    "text": "and uh now we push the envelope even further and present an even more a",
    "start": "53039",
    "end": "59199"
  },
  {
    "text": "powerful and simpler attack actually it's so simple as you will shortly see that",
    "start": "59199",
    "end": "65119"
  },
  {
    "text": "an attacker can dos a cisco router using just a single packet",
    "start": "65119",
    "end": "70799"
  },
  {
    "text": "this is a joint walk with either menachem ariel weisel and yoruvarelovic from ben",
    "start": "70799",
    "end": "76799"
  },
  {
    "text": "gurion university",
    "start": "76799",
    "end": "79759"
  },
  {
    "start": "82000",
    "end": "82000"
  },
  {
    "text": "okay just a quick introduction about myself before we start as i said my name is gabby i'm a fellow",
    "start": "82159",
    "end": "88799"
  },
  {
    "text": "at the national lab in israel called the national electronic warfare research and simulation center",
    "start": "88799",
    "end": "95520"
  },
  {
    "text": "we provide high-end research and consulting services i myself am involved in network security i'm also an academic",
    "start": "95520",
    "end": "102960"
  },
  {
    "text": "researcher and lecturer the technion in israel where i teach and research network",
    "start": "102960",
    "end": "108320"
  },
  {
    "text": "security okay so just me let me give you just a",
    "start": "108320",
    "end": "114880"
  },
  {
    "text": "brief overview of what you're about to hear today and the target of many routing attacks",
    "start": "114880",
    "end": "120799"
  },
  {
    "text": "is actually a control or a alter or poison in some way the routing",
    "start": "120799",
    "end": "127680"
  },
  {
    "text": "tables of a remote router without actually having to go through the trouble of",
    "start": "127680",
    "end": "133200"
  },
  {
    "text": "actually owning the router itself and the attack i'm going to present today",
    "start": "133200",
    "end": "138400"
  },
  {
    "text": "does just that and as i said it it is presented on a new it is based on a newly",
    "start": "138400",
    "end": "145599"
  },
  {
    "text": "found vulnerability of the ospf protocol and um",
    "start": "145599",
    "end": "150879"
  },
  {
    "text": "it actually allows to own the routing table um of",
    "start": "150879",
    "end": "156400"
  },
  {
    "text": "other routers within the routing domain while using just a single compromised routing within that domain routing",
    "start": "156400",
    "end": "162959"
  },
  {
    "text": "domain can be for example an isp network an enterprise network",
    "start": "162959",
    "end": "168720"
  },
  {
    "text": "and this means that an attacker only needs to compromise this single router within that domain",
    "start": "168720",
    "end": "175599"
  },
  {
    "text": "in order to compromise all the other route all the other routing tables within that domain",
    "start": "175599",
    "end": "183800"
  },
  {
    "text": "uh so why is this so desirable to compromise or own the routing tables of other routers",
    "start": "184640",
    "end": "191040"
  },
  {
    "text": "uh if you own the routing table of another router you actually can control the path uh a",
    "start": "191040",
    "end": "198159"
  },
  {
    "text": "packet takes through the network and if you can do that you actually can do many nice tricks with it",
    "start": "198159",
    "end": "204640"
  },
  {
    "text": "for example you can induce black holes create network cuts simply partition the",
    "start": "204640",
    "end": "209680"
  },
  {
    "text": "network you can do traffic diversion make the packet go through longer routes",
    "start": "209680",
    "end": "216640"
  },
  {
    "text": "in order to facilitate ease dropping or increase the load on the network and so on and so on",
    "start": "216640",
    "end": "222959"
  },
  {
    "text": "so who is vulnerable to the attack now as i mentioned the the attack exploits",
    "start": "223519",
    "end": "228640"
  },
  {
    "start": "224000",
    "end": "224000"
  },
  {
    "text": "the vulnerability embedded in india in the ospf standout actually in rfc",
    "start": "228640",
    "end": "234159"
  },
  {
    "text": "2328 so this means that potentially many commercial vendors may be vulnerable to",
    "start": "234159",
    "end": "239760"
  },
  {
    "text": "this attack and indeed currently now we know of several router vendors which are affected",
    "start": "239760",
    "end": "246640"
  },
  {
    "text": "here are they in alphabetical order actually this stock is a culmination of",
    "start": "246640",
    "end": "252959"
  },
  {
    "text": "a multi-vendor effort to patch this vulnerability and i would like to thank",
    "start": "252959",
    "end": "258400"
  },
  {
    "text": "the celt cc for their f for their coordination of this effort",
    "start": "258400",
    "end": "264960"
  },
  {
    "text": "actually i haven't personally verified all of the attack on all of these router",
    "start": "264960",
    "end": "270240"
  },
  {
    "text": "vendors but i will focus on the second half of my talk on perhaps the most interesting vendor here which is of",
    "start": "270240",
    "end": "277120"
  },
  {
    "text": "course cisco",
    "start": "277120",
    "end": "282280"
  },
  {
    "text": "so this is the agenda of the talk uh first i will uh",
    "start": "284400",
    "end": "290479"
  },
  {
    "text": "walk you through through some of the fundamentals of ospf and how it works",
    "start": "290479",
    "end": "296800"
  },
  {
    "text": "then i will describe the some of the ospf security strength and and then of course the newly found",
    "start": "296800",
    "end": "302960"
  },
  {
    "text": "vulnerability and attack and as i said that then the attack's effects on a cisco router",
    "start": "302960",
    "end": "311759"
  },
  {
    "text": "okay so let's start with the big picture internet routing and how it works",
    "start": "311759",
    "end": "317280"
  },
  {
    "start": "312000",
    "end": "312000"
  },
  {
    "text": "uh so probably as many of you and already know the networks and routers of the internet",
    "start": "317280",
    "end": "323360"
  },
  {
    "text": "are actually clustered into uh groups which are called autonomous systems",
    "start": "323360",
    "end": "328960"
  },
  {
    "text": "um each autonomous system is administered by a single network operator or maybe a few network",
    "start": "328960",
    "end": "335039"
  },
  {
    "text": "operators and there are some i think 45 000 autonomous systems on the internet today",
    "start": "335039",
    "end": "341919"
  },
  {
    "text": "so this means that actually the routing on the internet works in two levels the higher level",
    "start": "341919",
    "end": "347600"
  },
  {
    "text": "is the inter autonomous system routing which means that",
    "start": "347600",
    "end": "353039"
  },
  {
    "text": "the autonomous systems through which the packet traverses is determined this is done using the bgp",
    "start": "353039",
    "end": "359440"
  },
  {
    "text": "protocol",
    "start": "359440",
    "end": "362000"
  },
  {
    "text": "okay and in the at the lower level uh there is the routing within each autonomous system which of course",
    "start": "364800",
    "end": "370800"
  },
  {
    "text": "determined the path the packet will take uh through each autonomous system and now this is done independently",
    "start": "370800",
    "end": "377680"
  },
  {
    "text": "within each autonomous system and each network operator is free to choose",
    "start": "377680",
    "end": "382880"
  },
  {
    "text": "which routing protocol to do this routing within the autonomous system the most popular choices are",
    "start": "382880",
    "end": "390880"
  },
  {
    "text": "ospf rip and isis and as i said i will be talking about",
    "start": "390880",
    "end": "396000"
  },
  {
    "text": "ospf for this talk",
    "start": "396000",
    "end": "399680"
  },
  {
    "text": "okay so let's review some of the ospf fundamentals so how ospf works ospf",
    "start": "402160",
    "end": "410400"
  },
  {
    "text": "works by having each router advertise a link state meaning that each router advertise",
    "start": "410400",
    "end": "417039"
  },
  {
    "text": "advertises who who are its immediate neighbors to whom it is connected directly to",
    "start": "417039",
    "end": "425280"
  },
  {
    "text": "this advertisement is called the linc state advertisement or lsa for short",
    "start": "425280",
    "end": "430720"
  },
  {
    "text": "and the lsas are actually flooded throughout the autonomous system hub by hope",
    "start": "430720",
    "end": "436720"
  },
  {
    "text": "meaning that each router advertises its lsa to all its immediate neighbors",
    "start": "436720",
    "end": "442400"
  },
  {
    "text": "they advertise it to all their immediate neighbors and so on and so forth until all the",
    "start": "442400",
    "end": "447840"
  },
  {
    "text": "other routers receives this lsa this means that each and every lsa",
    "start": "447840",
    "end": "453440"
  },
  {
    "text": "each and every router receives all the other lsa's routers",
    "start": "453440",
    "end": "459440"
  },
  {
    "text": "and now every router can actually compile its view of the autonomous system topology based on this view",
    "start": "459440",
    "end": "468400"
  },
  {
    "text": "the router can calculate its routing table now let's see an illustration of how it",
    "start": "468400",
    "end": "474400"
  },
  {
    "text": "works let's say this is our autonomous system we have a bunch of routers and networks",
    "start": "474400",
    "end": "479520"
  },
  {
    "start": "475000",
    "end": "475000"
  },
  {
    "text": "connected to each other now let's okay",
    "start": "479520",
    "end": "485039"
  },
  {
    "text": "let's assume now that the r1 advertises its lsa which of course is",
    "start": "485039",
    "end": "490960"
  },
  {
    "text": "distributed or flooded throughout the autonomous system now every router which receives the lsa",
    "start": "490960",
    "end": "498160"
  },
  {
    "text": "keeps keeps it in a special data structure called the lsa database or lsadb",
    "start": "498160",
    "end": "503680"
  },
  {
    "text": "and now every router knows that r1 in this example",
    "start": "503680",
    "end": "509039"
  },
  {
    "text": "is connected on one interface to this local area network and on the other interface to r2",
    "start": "509039",
    "end": "516080"
  },
  {
    "text": "when r2 advertises its lsa then",
    "start": "516479",
    "end": "522080"
  },
  {
    "text": "it is of course again flooded throughout the autonomous system and now everybody not everybody knows that",
    "start": "522080",
    "end": "528240"
  },
  {
    "text": "r2 is connected on one interface to r1 and on the other two interfaces to these two other routers and so on and so forth",
    "start": "528240",
    "end": "535519"
  },
  {
    "text": "and this is how each and every router composes its view of the autonomous system topology and as",
    "start": "535519",
    "end": "541279"
  },
  {
    "text": "i said based on this view the routing table is calculated",
    "start": "541279",
    "end": "546320"
  },
  {
    "text": "now for simplicity reasons i don't mention here uh the notion of areas uh",
    "start": "546320",
    "end": "551360"
  },
  {
    "text": "i assume here that the autonomous system here is composed of just a single area",
    "start": "551360",
    "end": "557600"
  },
  {
    "start": "557000",
    "end": "557000"
  },
  {
    "text": "okay um a few more details about an lsa lsa is",
    "start": "557600",
    "end": "563680"
  },
  {
    "text": "advertised periodically by default every half an hour um every lsa has a sequence number which is",
    "start": "563680",
    "end": "570959"
  },
  {
    "text": "incremented sequence sequentially with every new advertised instance this means",
    "start": "570959",
    "end": "576880"
  },
  {
    "text": "that newer instances of an lsa with higher sequence number will always take",
    "start": "576880",
    "end": "582080"
  },
  {
    "text": "precedence over older instances of the same lsa with lower sequence number",
    "start": "582080",
    "end": "588959"
  },
  {
    "text": "and in addition there are several types of lsas the most important one is router lsa",
    "start": "588959",
    "end": "595920"
  },
  {
    "text": "which actually describes the links of a router and there are several",
    "start": "595920",
    "end": "603760"
  },
  {
    "text": "types of lsa for example network lsa which describes the links of a given network but i will not",
    "start": "603760",
    "end": "611200"
  },
  {
    "text": "consider them for this talk throughout this talk when i say an lsa i mean router lsa",
    "start": "611200",
    "end": "619399"
  },
  {
    "start": "621000",
    "end": "621000"
  },
  {
    "text": "okay and now for the attacker in our research we have assumed that the",
    "start": "621360",
    "end": "627760"
  },
  {
    "text": "attacker is an insider meaning that it has been able to infiltrate",
    "start": "627760",
    "end": "633279"
  },
  {
    "text": "the routing domain the autonomous system and it now it is now controlling just a single router within",
    "start": "633279",
    "end": "641040"
  },
  {
    "text": "the autonomous system uh with an arbitrary location uh it can be not necessarily be a core",
    "start": "641040",
    "end": "647760"
  },
  {
    "text": "router it can be just a remote access router somewhere in the autonomous system",
    "start": "647760",
    "end": "653839"
  },
  {
    "text": "now we needed to assume this because we wanted uh to search for ospf attacks",
    "start": "653839",
    "end": "661440"
  },
  {
    "text": "in order for to search for spf attacks the attacker needs to send ospf messages",
    "start": "661440",
    "end": "666480"
  },
  {
    "text": "to at least one other router within the autonomous system now there are",
    "start": "666480",
    "end": "671839"
  },
  {
    "text": "cases where the attacker can do it from the outside in such cases the",
    "start": "671839",
    "end": "677760"
  },
  {
    "text": "then the attacker doesn't need to take control over a um over the router within the autonomous",
    "start": "677760",
    "end": "683760"
  },
  {
    "text": "system and the goal of the attacker is to significantly control the routing",
    "start": "683760",
    "end": "689920"
  },
  {
    "text": "tables of the other routers within the autonomous system",
    "start": "689920",
    "end": "695120"
  },
  {
    "text": "okay it controls just a single router and now we want wishes to control the routing tables of all the",
    "start": "695120",
    "end": "701519"
  },
  {
    "text": "other routers now let me just",
    "start": "701519",
    "end": "708320"
  },
  {
    "start": "706000",
    "end": "706000"
  },
  {
    "text": "recap for you some of the ospf security strength and why it has been so hard",
    "start": "708320",
    "end": "714079"
  },
  {
    "text": "for or even impossible in the general case for an attacker um to",
    "start": "714079",
    "end": "720639"
  },
  {
    "text": "achieve such a goal so here's an example let's say",
    "start": "720639",
    "end": "726560"
  },
  {
    "text": "we have this autonomous system and we have an attacker that managed to control the control of",
    "start": "726560",
    "end": "731760"
  },
  {
    "text": "one of the routers up there and he now wishes to poison some of the routing tables of some of the rotors",
    "start": "731760",
    "end": "737600"
  },
  {
    "text": "within the autonomous system specifically we will be focusing on the router there on the right",
    "start": "737600",
    "end": "743600"
  },
  {
    "text": "which the attacker now wishes to poison its lsa database",
    "start": "743600",
    "end": "749760"
  },
  {
    "text": "and the router now has a complete and correct view of the of the autonomous",
    "start": "749760",
    "end": "755440"
  },
  {
    "text": "system topology and let's say that the attacker now wishes to",
    "start": "755440",
    "end": "761200"
  },
  {
    "text": "poison the the routing table or poison the lsa database of this router by disconnecting the victim router down",
    "start": "761839",
    "end": "769440"
  },
  {
    "text": "there um so that the the poisoned router will not be able to route to this victim",
    "start": "769440",
    "end": "776240"
  },
  {
    "text": "router let's say it serves some some purpose for the attacker now uh the most",
    "start": "776240",
    "end": "783279"
  },
  {
    "text": "simple way attacker the attacker can achieve this this is by simply sending out a force",
    "start": "783279",
    "end": "790639"
  },
  {
    "text": "lsa on behalf of the attacker excuse me on behalf of the victim",
    "start": "790639",
    "end": "796000"
  },
  {
    "text": "saying that the victim has no links whatsoever and it's not connected to any other router within the autonomous",
    "start": "796000",
    "end": "802959"
  },
  {
    "text": "system this will achieve the goal of the attacker now the first",
    "start": "802959",
    "end": "809440"
  },
  {
    "text": "security strength is that every lsa is flooded throughout the autonomous system",
    "start": "809440",
    "end": "814480"
  },
  {
    "text": "this already you know this means that once the attacker floods",
    "start": "814480",
    "end": "819760"
  },
  {
    "text": "or advertises the lsa the first lsa on behalf of the victim",
    "start": "819760",
    "end": "824959"
  },
  {
    "text": "it will simply be flooded throughout the autonomous system as of itself this is not a security strength but but it does",
    "start": "824959",
    "end": "832639"
  },
  {
    "text": "mean that eventually the victim will receive the first lsa advertised on its behalf",
    "start": "832639",
    "end": "839279"
  },
  {
    "text": "now this poses a problem for the attacker because of the second security strength",
    "start": "839279",
    "end": "845120"
  },
  {
    "text": "which means that uh which is the fightback mechanism and the fightback mechanism is defined",
    "start": "845120",
    "end": "851040"
  },
  {
    "text": "in the ospf standard and it says that once the router receives a force lsa advertised on its",
    "start": "851040",
    "end": "858240"
  },
  {
    "text": "behalf the router will the victim router will immediately send out",
    "start": "858240",
    "end": "864320"
  },
  {
    "text": "a correct lsa with a higher sequence number and this is the fightback lsa which of",
    "start": "864320",
    "end": "870320"
  },
  {
    "text": "course will cancel out the first lsa because it has a higher sequence number",
    "start": "870320",
    "end": "875360"
  },
  {
    "text": "this is the fightback so in this example the victim router will immediately",
    "start": "875360",
    "end": "881839"
  },
  {
    "text": "send out the fightback lsa and this will revert the attack's effect the attack will uh",
    "start": "881839",
    "end": "889279"
  },
  {
    "text": "will have a non-persistent effect on the on the lsa databases of all",
    "start": "889279",
    "end": "895040"
  },
  {
    "text": "of all the other routers um okay so an ad another attack venue the",
    "start": "895040",
    "end": "902480"
  },
  {
    "text": "attacker might wishes to take um is to simply send out",
    "start": "902480",
    "end": "908720"
  },
  {
    "text": "the advertisement the false address advertisement directly to the router wishes to poison",
    "start": "908720",
    "end": "914399"
  },
  {
    "text": "this is done using a simply by unicasting the packet directly to the",
    "start": "914399",
    "end": "919760"
  },
  {
    "text": "to that router now here comes another security strength of ospf which",
    "start": "919760",
    "end": "925360"
  },
  {
    "text": "is lsa authentication which means that every link in the",
    "start": "925360",
    "end": "930560"
  },
  {
    "text": "autonomous system is associated with a secret which is shared among all the",
    "start": "930560",
    "end": "935839"
  },
  {
    "text": "routers all the directly attached router uh directly attached to the to the to",
    "start": "935839",
    "end": "941600"
  },
  {
    "text": "this link and these routers uh use this uh ls you use this secret in",
    "start": "941600",
    "end": "947839"
  },
  {
    "text": "order to authenticate the lsas they share or they exchange among themselves",
    "start": "947839",
    "end": "953360"
  },
  {
    "text": "in our example the attacker knows the secrets of all the links that are",
    "start": "953360",
    "end": "959360"
  },
  {
    "text": "directly attached to it in this example secret x but it doesn't know the other secrets for example secret why",
    "start": "959360",
    "end": "966800"
  },
  {
    "text": "so this means that the router to be poisoned will not be able to authenticate",
    "start": "966800",
    "end": "972399"
  },
  {
    "text": "uh the false lsa advertised by the attacker and it will simply be discarded",
    "start": "972399",
    "end": "981440"
  },
  {
    "text": "okay and actually this means that an attacker",
    "start": "981440",
    "end": "986720"
  },
  {
    "text": "is not able to poison or persistently poison in a general in a general case",
    "start": "986720",
    "end": "992720"
  },
  {
    "text": "um the lsa database of one router by a falsifying the",
    "start": "992720",
    "end": "999199"
  },
  {
    "text": "an lsa of another router of a third router okay because once",
    "start": "999199",
    "end": "1004800"
  },
  {
    "text": "he he does that the third route or the other router will simply fight back making the attacks",
    "start": "1004800",
    "end": "1010320"
  },
  {
    "text": "effect non-persistent okay so the common conception",
    "start": "1010320",
    "end": "1017440"
  },
  {
    "text": "is that an attacker even if it is an insider",
    "start": "1017440",
    "end": "1022800"
  },
  {
    "text": "it simply cannot significantly and persistently poison the routing table of router it",
    "start": "1022800",
    "end": "1029438"
  },
  {
    "text": "does not control um excuse me",
    "start": "1029439",
    "end": "1036520"
  },
  {
    "text": "now this this has been the conception indeed uh up until 2011",
    "start": "1042799",
    "end": "1048640"
  },
  {
    "start": "1043000",
    "end": "1043000"
  },
  {
    "text": "this is when we published our first part of our research and then",
    "start": "1048640",
    "end": "1054400"
  },
  {
    "text": "we presented the first general technique to evade fight back and thereby persistently falsifying lsas",
    "start": "1054400",
    "end": "1062799"
  },
  {
    "text": "advertised on behalf of some other router we call this technique disguise the lsa",
    "start": "1062799",
    "end": "1068960"
  },
  {
    "text": "or we're welcome to check it out on the web and and this technique also relies on on",
    "start": "1068960",
    "end": "1075520"
  },
  {
    "text": "a vulnerability embedded in the ospf standout",
    "start": "1075520",
    "end": "1082400"
  },
  {
    "text": "now in the new attack we also",
    "start": "1082400",
    "end": "1087600"
  },
  {
    "start": "1085000",
    "end": "1085000"
  },
  {
    "text": "also affords the ability to persistently falsify lsas on behalf of some other",
    "start": "1087600",
    "end": "1094160"
  },
  {
    "text": "router it also exploits a vulnerability which is embedded in the",
    "start": "1094160",
    "end": "1100400"
  },
  {
    "text": "ospf standout however it it does offer some added advantages",
    "start": "1100400",
    "end": "1107360"
  },
  {
    "text": "which is uh first it offers a full poisoning meaning that",
    "start": "1107360",
    "end": "1113039"
  },
  {
    "text": "we can now using the new technique we can new attack i'm going to present we can poison 100 of the routers within the",
    "start": "1113039",
    "end": "1120960"
  },
  {
    "text": "autonomous system which and this is including the victim itself meaning",
    "start": "1120960",
    "end": "1126400"
  },
  {
    "text": "the victim itself will now believe the force say the first lsa we",
    "start": "1126400",
    "end": "1132480"
  },
  {
    "text": "will be advertising on its behalf and",
    "start": "1132480",
    "end": "1138160"
  },
  {
    "text": "the previous attack only poisoned just some of the routers within the autonomous system",
    "start": "1138160",
    "end": "1144559"
  },
  {
    "text": "certainly not the victims and the other one is that it's a simplicity as you will shortly see the",
    "start": "1144559",
    "end": "1151760"
  },
  {
    "text": "attack is that simple it's embarrassingly simple and it only requires just a single",
    "start": "1151760",
    "end": "1158400"
  },
  {
    "text": "packet the actual force let's say the attacker will advertise",
    "start": "1158400",
    "end": "1164919"
  },
  {
    "text": "okay so finally let's dive into the details",
    "start": "1165280",
    "end": "1170400"
  },
  {
    "text": "and here's a snapshot of the lsa header which i've taken directly from the rfc",
    "start": "1170480",
    "end": "1176400"
  },
  {
    "text": "and here you can see uh all the fields in there let's say header you we have here the the age of the lsa",
    "start": "1176400",
    "end": "1182880"
  },
  {
    "text": "which is simply the the number of seconds elapsed since its origination",
    "start": "1182880",
    "end": "1189039"
  },
  {
    "text": "uh we have some options and then the the lsa type as i mentioned we will be considering an lsa of one type which is",
    "start": "1189039",
    "end": "1197200"
  },
  {
    "text": "the router lsa and then these two fields link state id and",
    "start": "1197200",
    "end": "1202480"
  },
  {
    "text": "advertising router which i will be discussing shortly and then the sequence number which i've already mentioned",
    "start": "1202480",
    "end": "1210080"
  },
  {
    "text": "and then the check sum of the lsa and the length of the lsa now",
    "start": "1210080",
    "end": "1215360"
  },
  {
    "text": "in section 12.1 in the rfc",
    "start": "1215360",
    "end": "1222240"
  },
  {
    "text": "it says that an lsa is uniquely identified by these two fields advertising router",
    "start": "1222240",
    "end": "1228640"
  },
  {
    "text": "and link state id actually i'm bluffing you a little um",
    "start": "1228640",
    "end": "1234320"
  },
  {
    "text": "the office says that an lsa is identified by three fields these two and the lsa type now since uh",
    "start": "1234320",
    "end": "1243360"
  },
  {
    "text": "we are considering only router lsas i will just ignore the lsa type for simplicity reasons so",
    "start": "1243360",
    "end": "1250880"
  },
  {
    "text": "from our point of view the an lsa is identified by these two fields advertising router and link state id",
    "start": "1250880",
    "end": "1258799"
  },
  {
    "text": "let's see what they are a leak state id actually",
    "start": "1258799",
    "end": "1263840"
  },
  {
    "start": "1261000",
    "end": "1261000"
  },
  {
    "text": "identifies the part of the autonomous system that is being described by the lsa",
    "start": "1263840",
    "end": "1270480"
  },
  {
    "text": "in the case of a router lsa since the lsa describes the links of a given router",
    "start": "1270480",
    "end": "1275679"
  },
  {
    "text": "then the leak state id would be the id of that router the id of the router is simply an ip",
    "start": "1275679",
    "end": "1282159"
  },
  {
    "text": "address of one of its interfaces",
    "start": "1282159",
    "end": "1286080"
  },
  {
    "text": "and the other advertising router field uh identifies uh the router that originated the lsa uh now since uh",
    "start": "1288559",
    "end": "1297840"
  },
  {
    "text": "the lsa of a given router uh is always originated by that by that lsa but",
    "start": "1297840",
    "end": "1304400"
  },
  {
    "text": "excuse me by that router itself no other router will ever originate the uh",
    "start": "1304400",
    "end": "1310480"
  },
  {
    "text": "originate lsa on behalf of some other router so this field shows should also be the id",
    "start": "1310480",
    "end": "1317440"
  },
  {
    "text": "the id of the router now this means that both fields these",
    "start": "1317440",
    "end": "1322799"
  },
  {
    "text": "two fields should have the same exact value the identity of the router",
    "start": "1322799",
    "end": "1330159"
  },
  {
    "text": "of that lsa simple enough however",
    "start": "1330159",
    "end": "1335679"
  },
  {
    "text": "interestingly enough the ospf specification",
    "start": "1335679",
    "end": "1341039"
  },
  {
    "text": "does not specify a check to verify this on lsa reception once the",
    "start": "1341039",
    "end": "1346480"
  },
  {
    "text": "router receives this lsa there is no sanity check that",
    "start": "1346480",
    "end": "1351840"
  },
  {
    "text": "verifies that indeed these two fields are the same so let's see what kind of interesting",
    "start": "1351840",
    "end": "1358799"
  },
  {
    "text": "stuff a router an attacker might be able to do with this piece of information",
    "start": "1358799",
    "end": "1366320"
  },
  {
    "start": "1367000",
    "end": "1367000"
  },
  {
    "text": "so this is the the basic vulnerability which the attack relies on at least the first part of the",
    "start": "1367520",
    "end": "1373840"
  },
  {
    "text": "vulnerability uh so according to the ospf specification section 13.4",
    "start": "1373840",
    "end": "1380480"
  },
  {
    "text": "a router fights back only if it receives a force lsa in which the advertising router is equal",
    "start": "1380480",
    "end": "1386960"
  },
  {
    "text": "to the router's online on a router id meaning that once the router receives a",
    "start": "1386960",
    "end": "1393200"
  },
  {
    "text": "false lsa it will it will fight back only if the",
    "start": "1393200",
    "end": "1398640"
  },
  {
    "text": "advertising router field in that lsa equals to its own id its own router id",
    "start": "1398640",
    "end": "1405760"
  },
  {
    "text": "regardless of of the value of the link state id",
    "start": "1405760",
    "end": "1410960"
  },
  {
    "text": "this means that actually if an attacker sends out the first lsa",
    "start": "1410960",
    "end": "1419039"
  },
  {
    "text": "uh with the following header then they will i know fightback will uh",
    "start": "1419039",
    "end": "1424640"
  },
  {
    "text": "will be triggered meaning that if the header contains the link state id that that's equal to their victim's",
    "start": "1424640",
    "end": "1430720"
  },
  {
    "text": "router id but the advertising router does not equal to the victim's router id",
    "start": "1430720",
    "end": "1437120"
  },
  {
    "text": "then no fightback will be triggered whatsoever and",
    "start": "1437120",
    "end": "1442720"
  },
  {
    "text": "this is despite the fact that this lsa claims to describe the very links of that victim router no",
    "start": "1442720",
    "end": "1450400"
  },
  {
    "text": "fightback will be triggered so actually the basic attack",
    "start": "1450400",
    "end": "1456880"
  },
  {
    "text": "works as follows and this is let's assume that the attacker is up there and he now wishes",
    "start": "1456880",
    "end": "1463039"
  },
  {
    "text": "to send out the first lsc on behalf of some of the victim",
    "start": "1463039",
    "end": "1469360"
  },
  {
    "text": "in the middle there so it will just simply send out the first lsa with the lsa header we just",
    "start": "1469360",
    "end": "1475679"
  },
  {
    "text": "seen and the lsa will just be prop flooded throughout the autonomous system",
    "start": "1475679",
    "end": "1481919"
  },
  {
    "text": "all routers will actually install the first lsa in their database",
    "start": "1481919",
    "end": "1488640"
  },
  {
    "text": "uh this includes now the victim and now no no fightback will be triggered",
    "start": "1488640",
    "end": "1494400"
  },
  {
    "text": "actually again the uh the victim will actually install the first lsa in its own database the lsa",
    "start": "1494400",
    "end": "1501600"
  },
  {
    "text": "will actually advertise on its behalf and not and moreover it will continue to",
    "start": "1501600",
    "end": "1507440"
  },
  {
    "text": "flood this lsa to all of its neighbors",
    "start": "1507440",
    "end": "1512720"
  },
  {
    "text": "and this is how we get the 100 poisoning of all the autonomous system",
    "start": "1513520",
    "end": "1518960"
  },
  {
    "text": "now it's simple enough however it's not that simple",
    "start": "1518960",
    "end": "1524240"
  },
  {
    "text": "we have a problem here remember section 12.1 of the rfc and a",
    "start": "1524240",
    "end": "1530400"
  },
  {
    "text": "an lsa is identified by both fields link state id and advertising router",
    "start": "1530400",
    "end": "1537279"
  },
  {
    "text": "this means that the first lsa we just advertised has a different identifier",
    "start": "1537279",
    "end": "1543200"
  },
  {
    "text": "than the valid lsa the actual correct lsa of the victim router",
    "start": "1543200",
    "end": "1550720"
  },
  {
    "text": "so because they differ in the the advertising field so indeed",
    "start": "1550720",
    "end": "1557200"
  },
  {
    "text": "the attacker managed to send out a force lsa and we did manage to",
    "start": "1557200",
    "end": "1563840"
  },
  {
    "text": "avoid the the fight back but it seems that the attack is futile because actually uh we have managed to falsify",
    "start": "1563840",
    "end": "1572400"
  },
  {
    "text": "an lsa that does not really belong to the victim because they have different different identifiers",
    "start": "1572400",
    "end": "1579600"
  },
  {
    "text": "okay and this is what i just said and now for the second part of the",
    "start": "1581120",
    "end": "1586640"
  },
  {
    "text": "vulnerability um which is actually an ambiguity in the",
    "start": "1586640",
    "end": "1591679"
  },
  {
    "text": "ospf specification in section 16.1",
    "start": "1591679",
    "end": "1596799"
  },
  {
    "text": "according to the standout uh during the routing table calculation when",
    "start": "1596799",
    "end": "1602320"
  },
  {
    "text": "an lsa when the router fetches or looks up lsa in its own lsa databases",
    "start": "1602320",
    "end": "1609039"
  },
  {
    "text": "it's our lsa database the an lsa is looked up",
    "start": "1609039",
    "end": "1614720"
  },
  {
    "text": "based on the vertex id only in this context by the vertex by the",
    "start": "1614720",
    "end": "1620320"
  },
  {
    "text": "vertex id the rfc means the link state id so we actually have here a bit of",
    "start": "1620320",
    "end": "1627600"
  },
  {
    "text": "an ambiguity in the general case um you know on section 12.1",
    "start": "1627600",
    "end": "1634400"
  },
  {
    "text": "uh the rfc said that actually the lsa is identified by both fields",
    "start": "1634400",
    "end": "1640480"
  },
  {
    "text": "link state id and an advertising router however as you can you can see here on section",
    "start": "1640480",
    "end": "1647520"
  },
  {
    "text": "16.1 during the routing table calculation the",
    "start": "1647520",
    "end": "1652640"
  },
  {
    "text": "lsa is identified only uh by the link state id during its",
    "start": "1652640",
    "end": "1658000"
  },
  {
    "text": "lookup in the lsa database so we have an ambiguity here and actually if we just now step back a",
    "start": "1658000",
    "end": "1665679"
  },
  {
    "text": "minute and review what we have after the attack then",
    "start": "1665679",
    "end": "1671039"
  },
  {
    "start": "1668000",
    "end": "1668000"
  },
  {
    "text": "we have after after uh the attacker advertised or flooded the",
    "start": "1671039",
    "end": "1676159"
  },
  {
    "text": "um the force lsa on behalf of the victim we have in",
    "start": "1676159",
    "end": "1682720"
  },
  {
    "text": "every router two lsas having the same exact link state id the first lsa and the valid lsa",
    "start": "1682720",
    "end": "1690480"
  },
  {
    "text": "they have bought the same exact link state id which is equals to the victims on a router id",
    "start": "1690480",
    "end": "1696880"
  },
  {
    "text": "so this gives rise to the following question during the routing table calculation",
    "start": "1696880",
    "end": "1702559"
  },
  {
    "text": "when the lsa of the victim router is fetched which lsa will be fetched the",
    "start": "1702559",
    "end": "1710480"
  },
  {
    "text": "the first lsa or the valid lsa of course if the first lsa",
    "start": "1710480",
    "end": "1716320"
  },
  {
    "text": "will be fetched then we are home free if it's uh if the valid lsa will be fetched so",
    "start": "1716320",
    "end": "1722960"
  },
  {
    "text": "actually that the whole attack is futile of course now the rfc does not give us an answer to this question so the answer",
    "start": "1722960",
    "end": "1730320"
  },
  {
    "text": "is undefined as far as the standard is concerned uh so this is actually an implementation",
    "start": "1730320",
    "end": "1736080"
  },
  {
    "text": "dependent uh answer every implementation",
    "start": "1736080",
    "end": "1741440"
  },
  {
    "text": "might do a might fetch the other the force lsa or the valid let's say",
    "start": "1741440",
    "end": "1746960"
  },
  {
    "text": "now as you as you have seen at the beginning indeed many uh",
    "start": "1746960",
    "end": "1752159"
  },
  {
    "text": "commercial routers indeed fetch the force lsa making the attack effect the the attack successful",
    "start": "1752159",
    "end": "1760399"
  },
  {
    "text": "and indeed we'll now be talking about the the case of the cisco",
    "start": "1760399",
    "end": "1766559"
  },
  {
    "text": "of the cisco router and let's see how the effects went on on a cisco router",
    "start": "1766559",
    "end": "1772960"
  },
  {
    "text": "so in order to validate the attack we use the gns gns3 emulation software which is a",
    "start": "1772960",
    "end": "1778880"
  },
  {
    "text": "software which can which can emulate",
    "start": "1778880",
    "end": "1783600"
  },
  {
    "text": "cisco's ios real production image which is supposed to be run on a router on a",
    "start": "1783919",
    "end": "1789440"
  },
  {
    "text": "pc we use the cisco's ios 1501 m which is almost the latest ios version",
    "start": "1789440",
    "end": "1796640"
  },
  {
    "text": "and we use this cappy for to craft the attack packet",
    "start": "1796640",
    "end": "1802759"
  },
  {
    "start": "1803000",
    "end": "1803000"
  },
  {
    "text": "okay so this is our first finding um once we have advertised a force lsa on",
    "start": "1808080",
    "end": "1815760"
  },
  {
    "text": "behalf of the victim router using a higher sequence number that the",
    "start": "1815760",
    "end": "1821120"
  },
  {
    "text": "sequence number of the valid lsa then not only that the first lsa was indeed",
    "start": "1821120",
    "end": "1828720"
  },
  {
    "text": "installed in the routers on the in the lsa database of all the routers but it",
    "start": "1828720",
    "end": "1833919"
  },
  {
    "text": "actually replaced the valid lsa of",
    "start": "1833919",
    "end": "1839440"
  },
  {
    "text": "of the victim router and this happens in all the routers including the victim itself",
    "start": "1839440",
    "end": "1845360"
  },
  {
    "text": "meaning the victim itself erases its own lsa from its own lsa database",
    "start": "1845360",
    "end": "1851200"
  },
  {
    "text": "and it now replaces replaces it with its with our with the first lsa we",
    "start": "1851200",
    "end": "1857279"
  },
  {
    "text": "advertised on its behalf which was quite interesting here is an example of a",
    "start": "1857279",
    "end": "1865519"
  },
  {
    "text": "a snapshot of an let's say database say from from our experiments",
    "start": "1867039",
    "end": "1873519"
  },
  {
    "text": "so here you can see the lsa database of the victim router",
    "start": "1875279",
    "end": "1880799"
  },
  {
    "text": "here you have the id is 37.3 and here you can see the valid lsa which",
    "start": "1880799",
    "end": "1887200"
  },
  {
    "text": "has a link state id of 37.3 an advertising router of 37.3",
    "start": "1887200",
    "end": "1893519"
  },
  {
    "text": "as it should this is before the attack and after the attack again the link state id of 37.3",
    "start": "1893519",
    "end": "1902000"
  },
  {
    "text": "and here you can see the force lsa which we which have a link state id of",
    "start": "1902000",
    "end": "1907760"
  },
  {
    "text": "37.3 and an advertising router of 27.11 this is",
    "start": "1907760",
    "end": "1913519"
  },
  {
    "text": "some kind of an arbitrary number i've chosen and indeed the lsa database after the",
    "start": "1913519",
    "end": "1921519"
  },
  {
    "text": "attack does not include the valid lsa it was simply replaced",
    "start": "1921519",
    "end": "1928240"
  },
  {
    "text": "okay so indeed the older authors consider the first lsa during the",
    "start": "1930640",
    "end": "1937760"
  },
  {
    "text": "routing table calculation actually they have no choice because the valid lsa is erased",
    "start": "1937760",
    "end": "1943440"
  },
  {
    "text": "and indeed all the routers except the victim itself calculate",
    "start": "1943440",
    "end": "1949760"
  },
  {
    "text": "the new routes in accordance with the new information in the first lsa",
    "start": "1949760",
    "end": "1955600"
  },
  {
    "text": "except the victim the victim had a much more interesting behavior",
    "start": "1955600",
    "end": "1961120"
  },
  {
    "text": "the victims actually erased all its routing table at first glance they it was seen it is",
    "start": "1961120",
    "end": "1968559"
  },
  {
    "text": "it seemed like a just committed suicide following the attack but",
    "start": "1968559",
    "end": "1974080"
  },
  {
    "text": "actually after we looked at it uh we saw that indeed",
    "start": "1974080",
    "end": "1979760"
  },
  {
    "text": "the victim router also takes into consideration during its routing table calculation",
    "start": "1979760",
    "end": "1985279"
  },
  {
    "text": "the force uh of course the forces say it doesn't have the valid lsa",
    "start": "1985279",
    "end": "1990640"
  },
  {
    "text": "and it does calculate the routes correctly but somehow it does not install the routes",
    "start": "1990640",
    "end": "1996880"
  },
  {
    "text": "in its routing table this means that all the ospf route routes",
    "start": "1996880",
    "end": "2003039"
  },
  {
    "text": "are now erased from the routing table and this means that all the routes that are that are based on ospf routes for",
    "start": "2003039",
    "end": "2009519"
  },
  {
    "text": "example some bgp routes are also erased from the from the table so actually this leaves",
    "start": "2009519",
    "end": "2016080"
  },
  {
    "text": "the router the victim router with almost empty a routing table",
    "start": "2016080",
    "end": "2021840"
  },
  {
    "text": "which makes it of course a useless router with an empty a router with an empty routing table it's",
    "start": "2021840",
    "end": "2028399"
  },
  {
    "text": "actually useless so",
    "start": "2028399",
    "end": "2033159"
  },
  {
    "text": "and we find out that this erasure actually was quite persistent",
    "start": "2033519",
    "end": "2039519"
  },
  {
    "text": "um the victims could not simply recover from this erasure",
    "start": "2039519",
    "end": "2045039"
  },
  {
    "text": "spontaneously and it can er the only way",
    "start": "2045039",
    "end": "2050560"
  },
  {
    "text": "the victim could recover is by simply either rebooting the router or reloading",
    "start": "2050560",
    "end": "2056158"
  },
  {
    "text": "the the router or by simply just",
    "start": "2056159",
    "end": "2062078"
  },
  {
    "text": "erasing the ospf configuration and then enable it to enable it once again",
    "start": "2062480",
    "end": "2068320"
  },
  {
    "text": "so this was a very persistent erasure of the routing table and now the nice",
    "start": "2068320",
    "end": "2074079"
  },
  {
    "text": "trick about it is that the attacker itself can now and can actually undo",
    "start": "2074079",
    "end": "2079280"
  },
  {
    "text": "uh the this erasure and actually undo the entire attack effect",
    "start": "2079280",
    "end": "2085599"
  },
  {
    "text": "by simply just sending another false lsa but this time with the correct advertising router",
    "start": "2085599",
    "end": "2092480"
  },
  {
    "text": "id and then it will just trigger fight back by the victim router",
    "start": "2092480",
    "end": "2099040"
  },
  {
    "text": "with a higher sequence number and then this will cancel out the force lsa",
    "start": "2099040",
    "end": "2104880"
  },
  {
    "text": "we sent out previously and everything will be back to normal so this is a actually nice",
    "start": "2104880",
    "end": "2110640"
  },
  {
    "text": "nice feature of this attack where the attacker can just like a on and off switch can uh",
    "start": "2110640",
    "end": "2118560"
  },
  {
    "text": "can actually uh make the attack go away",
    "start": "2118640",
    "end": "2123680"
  },
  {
    "text": "okay so this was the the validation of the the cisco router",
    "start": "2125280",
    "end": "2131839"
  },
  {
    "text": "uh now to recap just uh let me give you some two examples two applica application examples of the attack",
    "start": "2132560",
    "end": "2140320"
  },
  {
    "start": "2133000",
    "end": "2133000"
  },
  {
    "text": "and one example is a black hole let's say the attacker wishes now uh",
    "start": "2140320",
    "end": "2146000"
  },
  {
    "text": "to create a black hole within the autonomous system uh for a specific",
    "start": "2146000",
    "end": "2151599"
  },
  {
    "text": "external destination so he can for example send out a force lsa",
    "start": "2151599",
    "end": "2157680"
  },
  {
    "text": "on behalf of the victim router saying that the victim router now is directly connected to some external uh",
    "start": "2157680",
    "end": "2165920"
  },
  {
    "text": "destination for example the ip range of google.com and this",
    "start": "2165920",
    "end": "2171440"
  },
  {
    "text": "will eventually make all the packets in the autonomous system",
    "start": "2171440",
    "end": "2177200"
  },
  {
    "text": "uh be will be rerouted to the to the victim itself and now since the",
    "start": "2177200",
    "end": "2184560"
  },
  {
    "text": "victim actually has no routing table of course it will become a black hole",
    "start": "2184560",
    "end": "2190720"
  },
  {
    "text": "another example um is a traffic diversion um",
    "start": "2190720",
    "end": "2197119"
  },
  {
    "text": "simply by changing the routes of of the route and the packet tech for",
    "start": "2197119",
    "end": "2203359"
  },
  {
    "text": "example in this scenario we have the green the green path and let's say the",
    "start": "2203359",
    "end": "2208480"
  },
  {
    "text": "attacker wishes to change it and so that the new route will pass",
    "start": "2208480",
    "end": "2214240"
  },
  {
    "text": "through it so in this particular scenario what the attacker can do is just",
    "start": "2214240",
    "end": "2220079"
  },
  {
    "text": "send a force let's say on behalf of the route of the victim router saying that the victim router cannot",
    "start": "2220079",
    "end": "2226560"
  },
  {
    "text": "is not is now disconnected from the network it has no links whatsoever",
    "start": "2226560",
    "end": "2231680"
  },
  {
    "text": "so uh it will just simply advertise it and in this scenario",
    "start": "2231680",
    "end": "2237040"
  },
  {
    "text": "um the new route will actually traverse the attacker and now the attacker can",
    "start": "2237040",
    "end": "2244400"
  },
  {
    "text": "ease drop on the on the traffic or launch men in the middle attack",
    "start": "2244720",
    "end": "2250079"
  },
  {
    "text": "okay and this was just a couple of attacks on",
    "start": "2250079",
    "end": "2255280"
  },
  {
    "text": "attack examples okay so to conclude actually uh",
    "start": "2255599",
    "end": "2262240"
  },
  {
    "text": "what i've presented here is a new attack on ospf a routing protocol um using this attack",
    "start": "2262240",
    "end": "2270000"
  },
  {
    "text": "and if the attacker can compromise just a single router within the autonomous system it actually",
    "start": "2270000",
    "end": "2276480"
  },
  {
    "text": "can compromise all the routing tables within the autonomous system",
    "start": "2276480",
    "end": "2282320"
  },
  {
    "text": "and the main takeaway i wanted to i want you to take from this talk is that",
    "start": "2282320",
    "end": "2287440"
  },
  {
    "text": "the integrity of your routing domain uh depends on the security of the list secure router within your domain",
    "start": "2287440",
    "end": "2294640"
  },
  {
    "text": "and this means that you need to secure your route your uh",
    "start": "2294640",
    "end": "2300079"
  },
  {
    "text": "remote access router in the remote branch as much as you secure your core router",
    "start": "2300079",
    "end": "2306160"
  },
  {
    "text": "in your main branch so uh that's what did this this was my",
    "start": "2306160",
    "end": "2311359"
  },
  {
    "text": "talk um i would be happy to uh to answer any questions you might have",
    "start": "2311359",
    "end": "2318480"
  },
  {
    "text": "yes",
    "start": "2318480",
    "end": "2321480"
  },
  {
    "text": "the secret of the link this there is the lsa authentication",
    "start": "2333359",
    "end": "2338839"
  },
  {
    "text": "okay yes excuse me",
    "start": "2338839",
    "end": "2346240"
  },
  {
    "text": "i'm sorry i'm having trouble there is no ospf authentication anymore",
    "start": "2348240",
    "end": "2356560"
  },
  {
    "text": "ah okay if there is no ospf authentication then actually you can actually probably",
    "start": "2361440",
    "end": "2369359"
  },
  {
    "text": "can do it do this attack from actually outside the autonomous system maybe even send it remotely",
    "start": "2369359",
    "end": "2376720"
  },
  {
    "text": "then you're in deep deep trouble",
    "start": "2376720",
    "end": "2382680"
  },
  {
    "text": "no no there is no there is no reason for that actually uh",
    "start": "2391599",
    "end": "2398400"
  },
  {
    "text": "juniper and cisco uh um i think uh",
    "start": "2398400",
    "end": "2404079"
  },
  {
    "text": "patched this vulnerability by actually looking for this kind of essays",
    "start": "2404079",
    "end": "2409119"
  },
  {
    "text": "okay they actually did a sanity check to verify that indeed the link state id is equal to the",
    "start": "2409119",
    "end": "2414960"
  },
  {
    "text": "advertising router",
    "start": "2414960",
    "end": "2417838"
  },
  {
    "text": "no the there is a very uh very distinct reason why the uh they",
    "start": "2422560",
    "end": "2429040"
  },
  {
    "text": "were in here because of the there are other let's say other types of lsa in which these two fields are not the same",
    "start": "2429040",
    "end": "2436240"
  },
  {
    "text": "for a router let's say these two fields must be the same for other types of lsa they not necessarily be the",
    "start": "2436240",
    "end": "2443440"
  },
  {
    "text": "same okay so thank you very much",
    "start": "2443440",
    "end": "2450040"
  }
]