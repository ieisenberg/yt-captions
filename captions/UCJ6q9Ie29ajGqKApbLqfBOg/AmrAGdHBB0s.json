[
  {
    "text": "okay kyouda afternoon everybody hope you had a good lunch welcome to black welcome to London for those of you that",
    "start": "30",
    "end": "6660"
  },
  {
    "text": "are natives I'm Tim I work at Cisco and I've been",
    "start": "6660",
    "end": "12000"
  },
  {
    "text": "looking at Active Directory and UNIX implementations they're off everyone",
    "start": "12000",
    "end": "18060"
  },
  {
    "text": "always thinks Cisco is just a ruse is this which is company but I think at this day and age we we do all manner of things Active Directory obviously plays",
    "start": "18060",
    "end": "24600"
  },
  {
    "text": "a part in some of those activities say by way of introduction I'm going to a",
    "start": "24600",
    "end": "31199"
  },
  {
    "text": "quick TL DR what the talk is and what the talk isn't in cases anybody that thinks actually this isn't for me I had",
    "start": "31199",
    "end": "36930"
  },
  {
    "text": "run through who I am and then outline what the talk covers say as a tldr ace",
    "start": "36930",
    "end": "42960"
  },
  {
    "text": "is a work in progress I've spent probably the best part of nine months off and on looking at",
    "start": "42960",
    "end": "48989"
  },
  {
    "text": "different aspects of this I'm currently up to three vendors and there are probably more vendors oil to be having a",
    "start": "48989",
    "end": "54780"
  },
  {
    "text": "look at energy of course it's not LDAP it's not Kerberos it's not Active",
    "start": "54780",
    "end": "60629"
  },
  {
    "text": "Directory per se it is however how UNIX Estate's integrate interactive directory",
    "start": "60629",
    "end": "66479"
  },
  {
    "text": "the software that's used and the bug losses that you might reasonably expect to find on such a mistake and it's",
    "start": "66479",
    "end": "74490"
  },
  {
    "text": "really about what happens if your UNIX boxes get compromised everybody always",
    "start": "74490",
    "end": "79979"
  },
  {
    "text": "thinks the Active Directory gets compromised because somebody clicks on a link in an email etc well there are",
    "start": "79979",
    "end": "87630"
  },
  {
    "text": "other ways to compromise in Active Directory and UNIX is one of them yeah we put we put an awful lot of emphasis",
    "start": "87630",
    "end": "92880"
  },
  {
    "text": "on those those big boxes that's it in a data center and we don't always realize",
    "start": "92880",
    "end": "97920"
  },
  {
    "text": "that they have trust relationships that extend potentially far further than the",
    "start": "97920",
    "end": "103049"
  },
  {
    "text": "notice systems themselves so who I am and why I think I'm qualified to talk",
    "start": "103049",
    "end": "108090"
  },
  {
    "text": "about this so I'm Tim I've got a background in telecoms and financial services and I've done the best part of",
    "start": "108090",
    "end": "116159"
  },
  {
    "text": "20 years in various different security roles operational security first and foremost some time as a penetration",
    "start": "116159",
    "end": "122219"
  },
  {
    "text": "tester at the moment I'm doing quite a lot of security engineering and I'd like to fly bugs I like to find bugs the",
    "start": "122219",
    "end": "131550"
  },
  {
    "text": "scale it's no good find that one bug in that one application what I want to do is find Boxster open",
    "start": "131550",
    "end": "139200"
  },
  {
    "text": "up doorways all over all over a network so the plan for this talk today is I'm",
    "start": "139200",
    "end": "144780"
  },
  {
    "text": "gonna run through your background a little bit of the theory of Active Directory for those of you that perhaps haven't looked at it at all I'm gonna",
    "start": "144780",
    "end": "149880"
  },
  {
    "text": "run through some of the estimate changes I've been working on what they look like in terms of practical attacks the",
    "start": "149880",
    "end": "156090"
  },
  {
    "text": "mitigations the response because I think that's a key part and the vendors in",
    "start": "156090",
    "end": "161160"
  },
  {
    "text": "this particular instance have been fantastic couldn't of what couldn't have asked to work with a better bunch of",
    "start": "161160",
    "end": "167060"
  },
  {
    "text": "responders and then finally some conclusions and if you're dead interested at the end of it there is",
    "start": "167060",
    "end": "173220"
  },
  {
    "text": "some bonus material which obviously be in the slides that go out publicly after this talk is concluded so the background over the last 15 years",
    "start": "173220",
    "end": "183570"
  },
  {
    "text": "I've noticed a huge uptick in the amount of ad that is appearing on networks from",
    "start": "183570",
    "end": "189780"
  },
  {
    "text": "a UNIX standpoint when I started 20 years ago the bank we were using Tivoli we were pushing out users to essentially",
    "start": "189780",
    "end": "197220"
  },
  {
    "text": "password files we were hoping that those files synced and when they didn't we were going to try to fit they're trying",
    "start": "197220",
    "end": "202320"
  },
  {
    "text": "to fix those problems these days a lot of systems are ad connected and so what's actually happening is people are",
    "start": "202320",
    "end": "208110"
  },
  {
    "text": "coming in with their normal corporate ID they're logging on to the Windows machine they're doing all of their Windows day-to-day when they drop across",
    "start": "208110",
    "end": "214530"
  },
  {
    "text": "onto the UNIX infrastructure that they possibly might as part of their job they just log it with the same set of credentials and the reason that works is",
    "start": "214530",
    "end": "220799"
  },
  {
    "text": "because of Active Directory so there's a compelling argument that Active Directory makes life easy but the",
    "start": "220799",
    "end": "228060"
  },
  {
    "text": "problem is that with that you have to responsible parties neither of whom",
    "start": "228060",
    "end": "235890"
  },
  {
    "text": "necessarily understand the capabilities the threat landscape of their opposing",
    "start": "235890",
    "end": "242400"
  },
  {
    "text": "party you have your enterprise Athens so your enterprise that means are responsible for the Active Directory forest they're the guys that ultimately",
    "start": "242400",
    "end": "249810"
  },
  {
    "text": "put put users on to us also on to Active Directory domains they're the guys that probably set the policies etc what they",
    "start": "249810",
    "end": "257820"
  },
  {
    "text": "don't do is have a real real hard think about what happens when you deploy acted",
    "start": "257820",
    "end": "263460"
  },
  {
    "text": "or if you onto UNIX and what pass what policies need to be applied there they don't necessarily have a good grasp",
    "start": "263460",
    "end": "269849"
  },
  {
    "text": "of what the limitations of act are active directory on UNIX are from a group policy perspective so what you end",
    "start": "269849",
    "end": "275520"
  },
  {
    "text": "up at is a situation where you might have say for example a SAP infrastructure sacrifice structure has four or five different environments",
    "start": "275520",
    "end": "282270"
  },
  {
    "text": "ranging from dev 3 to production treated er you have maybe 10 15 boxes in each of",
    "start": "282270",
    "end": "289440"
  },
  {
    "text": "those in farms and the view from the business is that the development if I'm",
    "start": "289440",
    "end": "294569"
  },
  {
    "text": "probably not that important it's yeah it's where they do their development work it doesn't contain customer data it doesn't contain business data so that it",
    "start": "294569",
    "end": "301740"
  },
  {
    "text": "doesn't get well-protected but this that's true interactive directory of stay not only do you have the ability if",
    "start": "301740",
    "end": "307050"
  },
  {
    "text": "you compromise that system to go off to other posts as the of the Sacramento structure you also have the ability to",
    "start": "307050",
    "end": "312900"
  },
  {
    "text": "go other after other bits of the enterprise infrastructure as a whole so the trust relationships are really quite",
    "start": "312900",
    "end": "318180"
  },
  {
    "text": "interesting and they're not necessarily hugely well considered so as a case",
    "start": "318180",
    "end": "324360"
  },
  {
    "text": "study this was patient zero if you will say we have a customer that uses vin",
    "start": "324360",
    "end": "329969"
  },
  {
    "text": "teller and if you look at see ve details as a benchmark of what the maturity of",
    "start": "329969",
    "end": "335099"
  },
  {
    "text": "the software is there's no bugs which means presumably it's great there's no no concerns for a runtime",
    "start": "335099",
    "end": "340919"
  },
  {
    "text": "initiative perspective you can just go and deploy that wherever you like but we see it too in places like critical",
    "start": "340919",
    "end": "346889"
  },
  {
    "text": "national infrastructure we see it across the financial services space we see it in lots of different places time and",
    "start": "346889",
    "end": "353219"
  },
  {
    "text": "time again we're running into active directed joined UNIX systems so what",
    "start": "353219",
    "end": "358229"
  },
  {
    "text": "does this actually mean we're expected",
    "start": "358229",
    "end": "364050"
  },
  {
    "text": "to tell the customer when they've got it wrong interestingly turns out cisco use",
    "start": "364050",
    "end": "370259"
  },
  {
    "text": "active directory on unix teeth so i started this conversation and start speaking to our internal teams about I",
    "start": "370259",
    "end": "376199"
  },
  {
    "text": "need to go report this they came back and said actually we've we've got that software to say this is why it's working",
    "start": "376199",
    "end": "384569"
  },
  {
    "text": "progresses because I've been patiently working through our internal stakeholders as well as the the software",
    "start": "384569",
    "end": "390360"
  },
  {
    "text": "vendors etc but hopefully the research is going to be good in the long run for them for you guys in this room for the",
    "start": "390360",
    "end": "398159"
  },
  {
    "text": "industry as a whole because at least we'll start to talk about this problem and what it looks like so the",
    "start": "398159",
    "end": "405060"
  },
  {
    "text": "theory Active Directory Unix doesn't",
    "start": "405060",
    "end": "410340"
  },
  {
    "text": "look a whole lot different from Active Directory or Windows if you imagine SSS",
    "start": "410340",
    "end": "415350"
  },
  {
    "text": "D is your L SAS if you imagine the SSD",
    "start": "415350",
    "end": "420960"
  },
  {
    "text": "talks to Linux VM or last similar to MSG know just because you're taking a photo",
    "start": "420960",
    "end": "428100"
  },
  {
    "text": "it that's a Red Hat slide that's red hat's description or SSS D looks like but essentially in between that you have",
    "start": "428100",
    "end": "435030"
  },
  {
    "text": "Kerberos you have DNS you have LDAP etc",
    "start": "435030",
    "end": "441330"
  },
  {
    "text": "pretty pretty standard the key piece I guess from this slide two takeaways all",
    "start": "441330",
    "end": "446940"
  },
  {
    "text": "of those policies pieces are being applied locally via CD also mount SC Linux etc unlike on a Windows box Active",
    "start": "446940",
    "end": "456930"
  },
  {
    "text": "Directory isn't enforcing any of those policies over the network so that's your first payment would is that actually you",
    "start": "456930",
    "end": "462720"
  },
  {
    "text": "might end up at a situation where you think you've got a great password policy but your password policy is only",
    "start": "462720",
    "end": "468240"
  },
  {
    "text": "applying where it's where it's where it's enforced on your window systems it's not being applied to UNIX systems",
    "start": "468240",
    "end": "474330"
  },
  {
    "text": "you think you've got auditing down pat you think you'll get gathering a right type of telemetry from your network well",
    "start": "474330",
    "end": "479910"
  },
  {
    "text": "there's no guarantees that a Linux box is gathering the appropriate telemetry to tell you and so on spoken around say",
    "start": "479910",
    "end": "487080"
  },
  {
    "text": "attack chains this is a threat model I",
    "start": "487080",
    "end": "496500"
  },
  {
    "text": "put together for Vint Ella so this is a slightly more detailed look up the previous slide different vendor",
    "start": "496500",
    "end": "502170"
  },
  {
    "text": "different different solution but it's the same problems so essentially you have a human user comes in over SSH",
    "start": "502170",
    "end": "507930"
  },
  {
    "text": "comes in over SMB comes in over whatever UNIX authentication service you might",
    "start": "507930",
    "end": "513599"
  },
  {
    "text": "have provide some credentials those credentials get passed into power",
    "start": "513600",
    "end": "519630"
  },
  {
    "text": "Pam is the authentication module that the set of authentication modules that",
    "start": "519630",
    "end": "524700"
  },
  {
    "text": "are used on most modern UNIX systems the will be older systems that don't but for the large part machine pam pam",
    "start": "524700",
    "end": "532660"
  },
  {
    "text": "to explore a UNIX socket servoz D Vaz D being the Alsace equivalent and says got",
    "start": "532660",
    "end": "539319"
  },
  {
    "text": "these credentials am i okay to let this guy in Vaz D can go and talk LDAP and",
    "start": "539319",
    "end": "545829"
  },
  {
    "text": "Kerberos strategies directory to authenticate the user it can also hit a filesystem okay it can look at",
    "start": "545829",
    "end": "551440"
  },
  {
    "text": "configuration files it can look at a sequel database and there lies part of",
    "start": "551440",
    "end": "557500"
  },
  {
    "text": "the problem one the reasons it looks at the sequel database is because of cache credentials something we've had a",
    "start": "557500",
    "end": "562899"
  },
  {
    "text": "Windows for what the most of our lifetime but something that we're",
    "start": "562899",
    "end": "567910"
  },
  {
    "text": "gradually dealing with and mitigating the risks there off say I've talked",
    "start": "567910",
    "end": "574569"
  },
  {
    "text": "about vin teller I've mentioned s SSD other vendors do exist as I said we're",
    "start": "574569",
    "end": "579639"
  },
  {
    "text": "talking to three or four at the moment I haven't looked at their full unconscious",
    "start": "579639",
    "end": "584829"
  },
  {
    "text": "that's probably a blind spot they spent in time but it's one I'd like to have a look at and see what their implementation looks like kind of hoping",
    "start": "584829",
    "end": "590680"
  },
  {
    "text": "that it might be closer to the windows end of the spectrum than a Linux end of the spectrum in terms of maturity but yeah I guess what I look at it will",
    "start": "590680",
    "end": "597639"
  },
  {
    "text": "figure about how so the fundamental traits and I just said Windows more mature off I'm a UNIX guy it nothing",
    "start": "597639",
    "end": "605439"
  },
  {
    "text": "pains me more than to have to say that I I spent the last twenty years working with AIX Lorris hp-ux Dynex Red Hat",
    "start": "605439",
    "end": "612490"
  },
  {
    "text": "pretty much every unix you can possibly imagine I'd be UNIX guy but Windows is a whole heap better UNIX is still stuck in",
    "start": "612490",
    "end": "619779"
  },
  {
    "text": "the 70s you know we're still reliant upon your IDs and G IDs and that's pretty much the extent of most security",
    "start": "619779",
    "end": "626079"
  },
  {
    "text": "boundaries on a on a UNIX box I know there are some exceptions but most of the time you find the customers who",
    "start": "626079",
    "end": "632290"
  },
  {
    "text": "switch them off because it breaks the applications they need to use say by way",
    "start": "632290",
    "end": "639100"
  },
  {
    "text": "of a refresher Windows has restricted a thin road for RDP it has LSA protection it has",
    "start": "639100",
    "end": "646149"
  },
  {
    "text": "protected users it has TPM what does that mean well it means that you can't necessarily authenticate to a Windows",
    "start": "646149",
    "end": "655509"
  },
  {
    "text": "domain join system with credentials unless you're in the right group it means that it's not possible even if",
    "start": "655509",
    "end": "663339"
  },
  {
    "text": "you're privileged to directly interact with the files that contain the cash",
    "start": "663339",
    "end": "668510"
  },
  {
    "text": "credentials or contain the configuration information it means that on in the case of TPM that the credentials the key",
    "start": "668510",
    "end": "674750"
  },
  {
    "text": "secrets that are used to secure the system are kept outside of the main system in a separate offline chip and",
    "start": "674750",
    "end": "683390"
  },
  {
    "text": "then if you get on to Windows 10 else Isis virtualized so elseis isn't even",
    "start": "683390",
    "end": "689090"
  },
  {
    "text": "running in the same virtual machine as the rest of your window a view of your windows estate it is it is literally sitting there in a isolated container",
    "start": "689090",
    "end": "696520"
  },
  {
    "text": "isolated at a hardware level and there is a slimmed-down set of IPC that allows",
    "start": "696520",
    "end": "702590"
  },
  {
    "text": "you to talk to it to do the authentication factors you'd need to do but hopefully reduces the attack surface",
    "start": "702590",
    "end": "709420"
  },
  {
    "text": "say sort of Baron what if I could get",
    "start": "709420",
    "end": "715400"
  },
  {
    "text": "into your UNIX box and breach your domain as I've touched upon UNIX systems",
    "start": "715400",
    "end": "724670"
  },
  {
    "text": "aren't necessarily quite so well secured technical debt is a big problem if you imagine your typical UNIX box it's",
    "start": "724670",
    "end": "731090"
  },
  {
    "text": "probably running something like SAP or it's probably running something like Oracle these are systems that don't like",
    "start": "731090",
    "end": "737480"
  },
  {
    "text": "downtime and the business doesn't like downtime because they're there the",
    "start": "737480",
    "end": "742820"
  },
  {
    "text": "systems that allow you to make your money so you have technical death and of course what happens then is this that",
    "start": "742820",
    "end": "748820"
  },
  {
    "text": "you're allowing people to log in over Active Directory and if we compromised",
    "start": "748820",
    "end": "754730"
  },
  {
    "text": "that and we can extract the credentials then maybe we can use those credentials elsewhere that can be window systems you",
    "start": "754730",
    "end": "761360"
  },
  {
    "text": "know there's nothing to stop me saying actually I've got these credentials for a UNIX box but actually go read your",
    "start": "761360",
    "end": "767060"
  },
  {
    "text": "mail but it can also be other UNIX systems so practical attacks",
    "start": "767060",
    "end": "773710"
  },
  {
    "text": "so I've classed these into four distinct areas there are some attacks that are",
    "start": "773710",
    "end": "779450"
  },
  {
    "text": "possible against read has s SSD implementation there are some attacks that are possible against VIN teller",
    "start": "779450",
    "end": "786370"
  },
  {
    "text": "there are some generic attacks that maybe you guys already know about that affect our life from Kerberos but anyway",
    "start": "786370",
    "end": "792560"
  },
  {
    "text": "lacy to write through them and see what we can do so SSD is maintained by Retta it's open",
    "start": "792560",
    "end": "801240"
  },
  {
    "text": "source and potential attacks there look like stealing hashes from a file system",
    "start": "801240",
    "end": "806270"
  },
  {
    "text": "stealing plaintext from memory yeah the credentials live in the process of SSD",
    "start": "806270",
    "end": "812730"
  },
  {
    "text": "for longer than is necessary so you can literally just potentially dump the memory and grab those to grab the",
    "start": "812730",
    "end": "819030"
  },
  {
    "text": "plaintext values and you can mix with the IPC this becomes more interesting a",
    "start": "819030",
    "end": "824580"
  },
  {
    "text": "couple of slides on but it's worth flagging out now and from a blue team perspective it runs as the route so in",
    "start": "824580",
    "end": "831330"
  },
  {
    "text": "principle you shouldn't better get to it unless you love your user it does have some SELinux integration and it does have some compile time",
    "start": "831330",
    "end": "837960"
  },
  {
    "text": "hardening so it's in this in the scheme of solutions perhaps more mature more",
    "start": "837960",
    "end": "845520"
  },
  {
    "text": "question that in a second because it has a bit of a patchy track record say can",
    "start": "845520",
    "end": "853620"
  },
  {
    "text": "you imagine a state of affairs where you could log onto a Windows box talk to a process and it give you character she's",
    "start": "853620",
    "end": "859650"
  },
  {
    "text": "back well SSD at one stage rather had exactly that problem that wasn't so long",
    "start": "859650",
    "end": "865170"
  },
  {
    "text": "ago that was 2017 I don't think they're any pocs available for the for these",
    "start": "865170",
    "end": "870600"
  },
  {
    "text": "attacks but I think they're probably something I'd like to work on because like I say caching being what patching",
    "start": "870600",
    "end": "875610"
  },
  {
    "text": "is this is the suspicion I have is that will be SSD in the wild where this vulnerability will exist say I've",
    "start": "875610",
    "end": "884010"
  },
  {
    "text": "digress little these are the key artifacts whether you're blue team or",
    "start": "884010",
    "end": "889380"
  },
  {
    "text": "red team these are the key things to worry about so you've got your database at the top you've got your ticket cache",
    "start": "889380",
    "end": "895320"
  },
  {
    "text": "you've got some configuration files you've got unix sockets for the IPC",
    "start": "895320",
    "end": "900500"
  },
  {
    "text": "you've got cached tickets for individual users and then you've got configuration",
    "start": "900500",
    "end": "906120"
  },
  {
    "text": "and the host keys have etc key points from this slide the only thing that's",
    "start": "906120",
    "end": "911700"
  },
  {
    "text": "accessible is a non privileged user is the thing in bold everything else all of",
    "start": "911700",
    "end": "917190"
  },
  {
    "text": "the stuff in italic you need to be root for but that's not dissimilar from the",
    "start": "917190",
    "end": "922560"
  },
  {
    "text": "situation in Windows in a sense that mimic acts requires administrative access so it's it's like for like in",
    "start": "922560",
    "end": "929310"
  },
  {
    "text": "that regard if you've not got root there's not a huge rent you can do caveat being that",
    "start": "929310",
    "end": "936390"
  },
  {
    "text": "as I said SSD has Apache record with IPC the IPC is exposed for it through those",
    "start": "936390",
    "end": "942180"
  },
  {
    "text": "three days sockets contrast SSD with vin",
    "start": "942180",
    "end": "949380"
  },
  {
    "text": "teller its proprietary its multi-platform has some similar classes",
    "start": "949380",
    "end": "954630"
  },
  {
    "text": "of attacks from a blue team perspective it runs as a lower privileged user but",
    "start": "954630",
    "end": "961350"
  },
  {
    "text": "it doesn't drop through so if you got code execution on it you can pivot it back up to view which then potentially",
    "start": "961350",
    "end": "967260"
  },
  {
    "text": "puts you in a situation where you can grab the hashes through code execution it doesn't have compiled time hardening",
    "start": "967260",
    "end": "973649"
  },
  {
    "text": "largely I suspect because being multi-platform the compile time hardening options that are available in",
    "start": "973649",
    "end": "979649"
  },
  {
    "text": "AIX or Solaris are quite different from the compile time options that might be available on Linux and I think they've",
    "start": "979649",
    "end": "985529"
  },
  {
    "text": "probably just gone for lowest common denominator and it has no integration with selinux so there's nothing beyond",
    "start": "985529",
    "end": "993230"
  },
  {
    "text": "UID and GID that's protecting that solution so the artifacts for that look",
    "start": "993230",
    "end": "1002120"
  },
  {
    "text": "like this a little bit more interesting again in bold those are the things you can access as a non-provisional so you",
    "start": "1002120",
    "end": "1009440"
  },
  {
    "text": "can access ad POSIX metadata and configuration files again you can't get to the hashes themselves or the ticket",
    "start": "1009440",
    "end": "1016100"
  },
  {
    "text": "without being a previous user but as I said that's not dissimilar from Windows",
    "start": "1016100",
    "end": "1022779"
  },
  {
    "text": "build up just a really straight because I think people are still using using",
    "start": "1023740",
    "end": "1029000"
  },
  {
    "text": "that outside of Active Directory per se again you can steal hashes you can take plaintext or memory man-in-the-middle is",
    "start": "1029000",
    "end": "1036530"
  },
  {
    "text": "an interesting one how many times have I seen Windows systems that have Active",
    "start": "1036530",
    "end": "1042230"
  },
  {
    "text": "Directory talking over SSL all of the time how many times have I seen UNIX",
    "start": "1042230",
    "end": "1047510"
  },
  {
    "text": "systems or systems in general which are accessible over a web interface for SSL how many times have I seen them",
    "start": "1047510",
    "end": "1054230"
  },
  {
    "text": "correctly configure LDAP to go over SSL about zero and then finally Kerberos so",
    "start": "1054230",
    "end": "1063140"
  },
  {
    "text": "even if you don't alaa back even if you don't have Active Directory Integration you might still have Kerberos it's used for things like",
    "start": "1063140",
    "end": "1069550"
  },
  {
    "text": "NFS etc so the it is out there so that's",
    "start": "1069550",
    "end": "1074980"
  },
  {
    "text": "the kind of things you can do what I wanted to do is get to the place where you can do these things not just",
    "start": "1074980",
    "end": "1080790"
  },
  {
    "text": "pontificate that you can do these things so I figured I'd go away and write some tools and the first tool I write was",
    "start": "1080790",
    "end": "1088510"
  },
  {
    "text": "linear casts as I've already indicated",
    "start": "1088510",
    "end": "1093870"
  },
  {
    "text": "you need to be root to have the ability to use it but I think from an offensive",
    "start": "1093870",
    "end": "1100570"
  },
  {
    "text": "perspective you can see the value that you go from a position of not having any",
    "start": "1100570",
    "end": "1106600"
  },
  {
    "text": "access to the active directory of state potentially to having full access you have the ability to extract her shoes plaintext tickets for me it was worth",
    "start": "1106600",
    "end": "1114280"
  },
  {
    "text": "the investment in time to go and figure out how it works given that it put me in this position",
    "start": "1114280",
    "end": "1119500"
  },
  {
    "text": "with what with our customers with our internal systems long run so stealing",
    "start": "1119500",
    "end": "1126280"
  },
  {
    "text": "hashes if you're running an IDI are on a",
    "start": "1126280",
    "end": "1132310"
  },
  {
    "text": "Windows box the chances are the mimic house will be picked up when you drop it on that's great from a blue team",
    "start": "1132310",
    "end": "1139000"
  },
  {
    "text": "perspective these attacks can all be performed on UNIX using pretty much the",
    "start": "1139000",
    "end": "1144760"
  },
  {
    "text": "standard POSIX command set so find an CP I don't know how as a blue team person",
    "start": "1144760",
    "end": "1150790"
  },
  {
    "text": "you're expected to spot when somebody's doing that maliciously versus using it legitimately but it takes a little bit",
    "start": "1150790",
    "end": "1157660"
  },
  {
    "text": "more you work to actually use them predominantly because of the fact that this work hasn't been done before now",
    "start": "1157660",
    "end": "1165310"
  },
  {
    "text": "when I publish the tools at the end of this presentation it should be dead easy you should be able to go away get access",
    "start": "1165310",
    "end": "1171190"
  },
  {
    "text": "to Roo on a UNIX system and go away and knock yourselves out but hashes so I've",
    "start": "1171190",
    "end": "1178570"
  },
  {
    "text": "looked at the hashes that are stored in both of Intelli and SSD SSD uses a stock",
    "start": "1178570",
    "end": "1186670"
  },
  {
    "text": "sha-512 hunch from crypt so you can literally take your cache database apply",
    "start": "1186670",
    "end": "1194500"
  },
  {
    "text": "a little bit of free processing to get out the that the shot five twelve hatch and parse it into John",
    "start": "1194500",
    "end": "1201760"
  },
  {
    "text": "the Ripper I'm presuming that John the Ripper has an appropriate dictionary",
    "start": "1201760",
    "end": "1206770"
  },
  {
    "text": "that you've configured the appropriate settings to apply parcel policy etc you",
    "start": "1206770",
    "end": "1213190"
  },
  {
    "text": "should be let's just go around cracking those hashes it should be that simple incidentally that's the same way that",
    "start": "1213190",
    "end": "1218800"
  },
  {
    "text": "you can attack Samba if you have Samba on a UNIX box even if it's not Active Directory joined that's using the center",
    "start": "1218800",
    "end": "1226720"
  },
  {
    "text": "since essentially SSD is it's the same storage mechanism of Samba does so there will be an equivalent file for Samba for",
    "start": "1226720",
    "end": "1232540"
  },
  {
    "text": "local users and you can go and dump those two so as SSD Vint Ella a bit more",
    "start": "1232540",
    "end": "1239650"
  },
  {
    "text": "difficult for a start is a sequel like database that's easy once you realize it's a sequel like database but till you",
    "start": "1239650",
    "end": "1246040"
  },
  {
    "text": "do it you're not quite sure what you're looking at it has its own bespoke",
    "start": "1246040",
    "end": "1251560"
  },
  {
    "text": "hashing algorithms but the good news is the vin teller solution all of the",
    "start": "1251560",
    "end": "1256570"
  },
  {
    "text": "symbols that were there on the binary files on the libraries etc so it wasn't too difficult to reverse engineer so vin",
    "start": "1256570",
    "end": "1265270"
  },
  {
    "text": "teller has two formats three from the next release I think he's probably fair",
    "start": "1265270",
    "end": "1271720"
  },
  {
    "text": "to say it has a legacy which I don't think I've actually seen in practice in the wild it has sha-256 using a bespoke",
    "start": "1271720",
    "end": "1279640"
  },
  {
    "text": "implementation the bespoke implementation uses salting as UUID and has some other other characteristics so",
    "start": "1279640",
    "end": "1288220"
  },
  {
    "text": "how hard was it for me to find this information out well from the point where I spotted the function it was less",
    "start": "1288220",
    "end": "1295420"
  },
  {
    "text": "than a day probably a couple of hours and what did it look like little ax went",
    "start": "1295420",
    "end": "1301510"
  },
  {
    "text": "like that so essentially when you log on to a vinta joined Active Directory system your",
    "start": "1301510",
    "end": "1308350"
  },
  {
    "text": "password gets concatenated with a hash UUID and another constant and I sent you",
    "start": "1308350",
    "end": "1315310"
  },
  {
    "text": "gets passed into it into sha-256 and that gets stored in the cache and that",
    "start": "1315310",
    "end": "1320770"
  },
  {
    "text": "becomes your future access to the system I think the reasoning is pretty similar",
    "start": "1320770",
    "end": "1327610"
  },
  {
    "text": "to it on Windows the idea that perhaps your system might become disconnected for therapy for some regard for some reason",
    "start": "1327610",
    "end": "1334210"
  },
  {
    "text": "I can't imagine a situation where that's likely to happen in practice but that's",
    "start": "1334210",
    "end": "1339820"
  },
  {
    "text": "the that's the rationale behind the caching so once you know what it looks",
    "start": "1339820",
    "end": "1346840"
  },
  {
    "text": "like you can go away and you can write John the Ripper rule set to process it",
    "start": "1346840",
    "end": "1352590"
  },
  {
    "text": "this will be up in in the git repo post talk so don't bother about scribbling it",
    "start": "1352590",
    "end": "1357910"
  },
  {
    "text": "down there but essentially it says we have a hash it is a sha-256 it has both",
    "start": "1357910",
    "end": "1364450"
  },
  {
    "text": "a username component actually that's the UUID and it has a salt and combine these",
    "start": "1364450",
    "end": "1372520"
  },
  {
    "text": "things in the following form so constant one UUID constant - plaintext value and",
    "start": "1372520",
    "end": "1380650"
  },
  {
    "text": "then use this as the base for cracking hashes so that's how she's done and",
    "start": "1380650",
    "end": "1388990"
  },
  {
    "text": "dusted but we can also get the plaintext values back with that I mean if you",
    "start": "1388990",
    "end": "1397570"
  },
  {
    "text": "dropped the core file for SSD vin teller or any of these other solutions the",
    "start": "1397570",
    "end": "1404590"
  },
  {
    "text": "chances are the plaintext values or some people's passwords are likely to still be in the in the memory of the system",
    "start": "1404590",
    "end": "1410880"
  },
  {
    "text": "SSD is particularly interesting because the way that it's stored is within a",
    "start": "1410880",
    "end": "1416320"
  },
  {
    "text": "structure and so there's actually a piece of information is stored in a structure directly preceding the hash or",
    "start": "1416320",
    "end": "1422350"
  },
  {
    "text": "the plaintext value I should say such that you can immediately identify where those plaintext values off rather than",
    "start": "1422350",
    "end": "1428860"
  },
  {
    "text": "didn't Ella for example where essentially you strings the core dump and you have to guess what might be a",
    "start": "1428860",
    "end": "1435280"
  },
  {
    "text": "password versus what what might not be but it's dead easy and again from a",
    "start": "1435280",
    "end": "1440710"
  },
  {
    "text": "defense perspective how many people are really looking at wengie core gdb strings have been run on their systems i",
    "start": "1440710",
    "end": "1446050"
  },
  {
    "text": "but i thought i think it's unlikely the last like gonna be the case so that's that's plaintext memory then we have",
    "start": "1446050",
    "end": "1454630"
  },
  {
    "text": "tickets say tickets are the piece of information that means that once you've logged onto her system on running Active",
    "start": "1454630",
    "end": "1460060"
  },
  {
    "text": "Directory you can then log on to other systems without necessarily needing to provide your credentials again",
    "start": "1460060",
    "end": "1465640"
  },
  {
    "text": "and in the case of both vin teller SSD and Kerberos more generally those",
    "start": "1465640",
    "end": "1471160"
  },
  {
    "text": "tickets for a UNIX perspective are stored in slash temp they have permissions that only the issued user",
    "start": "1471160",
    "end": "1477580"
  },
  {
    "text": "should have access to them but they're there if your route in going crabbing we're quite easily and there are tools",
    "start": "1477580",
    "end": "1483970"
  },
  {
    "text": "plant are plenty to leverage that fact s SMB client is likely to be on a UNIX",
    "start": "1483970",
    "end": "1490630"
  },
  {
    "text": "system if its domain joined but that you could take those stays cache files you",
    "start": "1490630",
    "end": "1496090"
  },
  {
    "text": "could run the mystery meerkats on your window system you could load them into wash or shark so you can look up for",
    "start": "1496090",
    "end": "1502270"
  },
  {
    "text": "example the the encrypted traffic between the UNIX system and the domain",
    "start": "1502270",
    "end": "1507460"
  },
  {
    "text": "controller means you therefore have got the ability to start compromising that and allegedly you can also load them",
    "start": "1507460",
    "end": "1515110"
  },
  {
    "text": "into X free RDP I've not had that working and I'm a little bit skeptical because I don't think it should work but",
    "start": "1515110",
    "end": "1521290"
  },
  {
    "text": "there is documentation indicates that it might open source documentation is",
    "start": "1521290",
    "end": "1527080"
  },
  {
    "text": "always somewhat untrustworthy ticket",
    "start": "1527080",
    "end": "1533250"
  },
  {
    "text": "that's how easy it is to miss you somebody's ticket so on the right hand side left hand side from your",
    "start": "1533250",
    "end": "1538809"
  },
  {
    "text": "perspective you have an administrator they have a ticket david TGT a ticket",
    "start": "1538809",
    "end": "1545620"
  },
  {
    "text": "granting ticket for the third party dot example.org domain and on the right hand",
    "start": "1545620",
    "end": "1552970"
  },
  {
    "text": "side I'm copying that ticket to another file that's the bit where you need to be",
    "start": "1552970",
    "end": "1558760"
  },
  {
    "text": "root I then log in to a separate account again the user account I set the appropriate environment",
    "start": "1558760",
    "end": "1565690"
  },
  {
    "text": "variable to point at my copy ticket and now I'm an administrator really is that",
    "start": "1565690",
    "end": "1571660"
  },
  {
    "text": "simple so miracast gets us a few things it gets",
    "start": "1571660",
    "end": "1578919"
  },
  {
    "text": "this the ability to grab cash cashes it gives us the ability to scrape process memory in L it will allow us to locate",
    "start": "1578919",
    "end": "1586270"
  },
  {
    "text": "quickly and efficiently Kerberos tickets and it will grab appropriate Active",
    "start": "1586270",
    "end": "1591700"
  },
  {
    "text": "Directory meta data where available however that's not the end of the",
    "start": "1591700",
    "end": "1596800"
  },
  {
    "text": "release say I wanted to make this as easy as",
    "start": "1596800",
    "end": "1601879"
  },
  {
    "text": "possible for both sides so we have post exploitation modules for Metasploit we have the John the Ripper all set to a",
    "start": "1601879",
    "end": "1607820"
  },
  {
    "text": "lady to go off the vin teller hashes and crack them quite happily we have all dit D policies so there's a chance to feel",
    "start": "1607820",
    "end": "1613610"
  },
  {
    "text": "the blue team if you load these policies into your into your eunuchs estate you might actually spot the bad guys doing stuff and eventually I want to share",
    "start": "1613610",
    "end": "1621440"
  },
  {
    "text": "everything I've been doing all my research all my father's etc I think nothing bugs me more than cases where",
    "start": "1621440",
    "end": "1628820"
  },
  {
    "text": "people do a great talk talking about an awesome bug and then don't share anything and every really learns a huge amount afterwards so I'm going to be",
    "start": "1628820",
    "end": "1635360"
  },
  {
    "text": "sharing everything I possibly can do so it's not up yet but that's where you'll",
    "start": "1635360",
    "end": "1641090"
  },
  {
    "text": "be able to find it and as I said it's it's there to enable both the blue and",
    "start": "1641090",
    "end": "1646999"
  },
  {
    "text": "the red team I don't want to be one of those guys that's playing for one side I'd like to see both sides improve so",
    "start": "1646999",
    "end": "1655820"
  },
  {
    "text": "that's what the structure looks like as I said there's John the Ripper Metasploit or dit deed the data and the",
    "start": "1655820",
    "end": "1662869"
  },
  {
    "text": "songs bit will probably be quite interesting for whatever anybody wants to take this research on and take you further because I think there's probably",
    "start": "1662869",
    "end": "1669740"
  },
  {
    "text": "enough room for another 12 months of research with so many aspects I've been looking at anyway that's the bad news",
    "start": "1669740",
    "end": "1676580"
  },
  {
    "text": "that's hell that's how we can we can breach an Active Directory stay from your unix perspective but no good talk",
    "start": "1676580",
    "end": "1683029"
  },
  {
    "text": "is complete without a discussion about how you actually protect yourself the",
    "start": "1683029",
    "end": "1688429"
  },
  {
    "text": "mitigations both investigations from our operator perspective you know you're the guard is just wonderful for the UNIX",
    "start": "1688429",
    "end": "1694369"
  },
  {
    "text": "estate what do I do but also from the developers perspective I'm writing",
    "start": "1694369",
    "end": "1699649"
  },
  {
    "text": "software to do this kind of thing how could I write it better next time so that this this kind of thing is less it",
    "start": "1699649",
    "end": "1704720"
  },
  {
    "text": "easy to do say it's from a mitigations perspective so this is the things for",
    "start": "1704720",
    "end": "1709759"
  },
  {
    "text": "the operators generic hardening restricting root access always a nice thing to do I think it's",
    "start": "1709759",
    "end": "1718190"
  },
  {
    "text": "rare that we find boxes that are as well secured as we'd like them to be it's not the focus of this talk but I think",
    "start": "1718190",
    "end": "1724190"
  },
  {
    "text": "there's more work to be done there SELinux it's a ask to switch on",
    "start": "1724190",
    "end": "1729500"
  },
  {
    "text": "its ass to get running but we really need to take the time to get here working to get it used on on",
    "start": "1729500",
    "end": "1736040"
  },
  {
    "text": "UNIX infrastructures reading the man pages is a super useful thing say",
    "start": "1736040",
    "end": "1743890"
  },
  {
    "text": "generic hardening the cat cache feature on our UNIX box is on by default really",
    "start": "1743890",
    "end": "1752600"
  },
  {
    "text": "ought not to be there is no good reason why UNIX box is ever going to find",
    "start": "1752600",
    "end": "1758090"
  },
  {
    "text": "itself in a situation where it can't talk to the domain controller hardly hardly likely you're going to take your",
    "start": "1758090",
    "end": "1764150"
  },
  {
    "text": "UNIX box home of the weekend and plug it in on your home network to get a little bit of extra work done uh-hum so turning",
    "start": "1764150",
    "end": "1770060"
  },
  {
    "text": "it off will be a super useful first step we as attackers if we're working for",
    "start": "1770060",
    "end": "1776900"
  },
  {
    "text": "organizations should be pointing this out to the organization's we're working for we should be identifying when we've",
    "start": "1776900",
    "end": "1782960"
  },
  {
    "text": "got an active directory joined UNIX system in the scope of an assessment and we should be flagging it out sort of the",
    "start": "1782960",
    "end": "1789290"
  },
  {
    "text": "they can the organizations could have a bit of a think about it if only it were",
    "start": "1789290",
    "end": "1795290"
  },
  {
    "text": "that simple we should be patching our systems better yeah the resistance that",
    "start": "1795290",
    "end": "1802010"
  },
  {
    "text": "I've seen that I haven't been passionate in two or three years as unacceptable and it's only a matter of time if that's",
    "start": "1802010",
    "end": "1810320"
  },
  {
    "text": "the case for an organization before somebody bad would do something bad to your systems and we should be looking",
    "start": "1810320",
    "end": "1817070"
  },
  {
    "text": "for privilege escalation attacks there in many cases there are dumb and easy",
    "start": "1817070",
    "end": "1822620"
  },
  {
    "text": "ways to get root on large enterprise networks really we ought to be doing a",
    "start": "1822620",
    "end": "1827750"
  },
  {
    "text": "better job of getting rid of those so specifics restricting access to P trace",
    "start": "1827750",
    "end": "1836090"
  },
  {
    "text": "is a super useful thing to do from a generic perspective but in this particular instance any of the attacks that look at the cache memory saw the",
    "start": "1836090",
    "end": "1844700"
  },
  {
    "text": "plain text or the hashes in memory is only possible because we can use gdb",
    "start": "1844700",
    "end": "1850690"
  },
  {
    "text": "disabling the P trace capability using Yammer or selinux I'd suggest should be",
    "start": "1850720",
    "end": "1857390"
  },
  {
    "text": "done at the very least you should have some monitoring in place so you know when it's being used and by whom",
    "start": "1857390",
    "end": "1864820"
  },
  {
    "text": "protecting resources selinux interestingly both Intelli and SSS D",
    "start": "1865299",
    "end": "1872659"
  },
  {
    "text": "have selinux policies in Vint Ellis case it's in a github repo which isn't",
    "start": "1872659",
    "end": "1879799"
  },
  {
    "text": "clearly flagged out to anybody that's deploying it it's somewhere on the Internet in fairness it's in in one",
    "start": "1879799",
    "end": "1886340"
  },
  {
    "text": "identity who owned vin tellers organizational project group but you're",
    "start": "1886340",
    "end": "1892220"
  },
  {
    "text": "unlikely to find it by accident should we say so I guess if you're deploying",
    "start": "1892220",
    "end": "1897679"
  },
  {
    "text": "VIN teller go away and grab that grab those SELinux policies and apply them",
    "start": "1897679",
    "end": "1903669"
  },
  {
    "text": "order thing so most of what I've talked about so far in terms of mitigations has",
    "start": "1904450",
    "end": "1909500"
  },
  {
    "text": "been around how you protect yourself before you get the breach auditing is a",
    "start": "1909500",
    "end": "1917149"
  },
  {
    "text": "must from a prepare yourself for when you do get breached most people on UNIX",
    "start": "1917149",
    "end": "1926750"
  },
  {
    "text": "systems appear to rely upon logging log in and order Singh have slightly different roles responsibilities log in",
    "start": "1926750",
    "end": "1933649"
  },
  {
    "text": "is for developers order thing is for sis happens it's noticeable in the case of",
    "start": "1933649",
    "end": "1940610"
  },
  {
    "text": "Intelli the order thing is developers because if you switch the debug level up high enough you get full packet captures",
    "start": "1940610",
    "end": "1946879"
  },
  {
    "text": "of all of the IPC that's happening just super helpful when you're right the funds but I don't really think most",
    "start": "1946879",
    "end": "1953720"
  },
  {
    "text": "administrators are going to want that information they're probably gonna wanna know when I'm touching the socket when",
    "start": "1953720",
    "end": "1958730"
  },
  {
    "text": "I'm touching the cash caches when I'm reading the configuration files etc so",
    "start": "1958730",
    "end": "1966320"
  },
  {
    "text": "the manual super useful place to look it's in there in plain sight there is an",
    "start": "1966320",
    "end": "1974509"
  },
  {
    "text": "option to control the cached hashes there is an option to determine what",
    "start": "1974509",
    "end": "1980840"
  },
  {
    "text": "encryption level is applied to Kerberos tickets it's all there just nobody's looking at it",
    "start": "1980840",
    "end": "1988210"
  },
  {
    "text": "so this is an interesting one Kerberos is enabled as part of the Intel ahan as",
    "start": "1990290",
    "end": "1995300"
  },
  {
    "text": "part of s SSD in many cases it probably doesn't need to be enabled at all there's no reason necessarily to grant",
    "start": "1995300",
    "end": "2002140"
  },
  {
    "text": "tickets because most the time when you connect to a UNIX box you're on that",
    "start": "2002140",
    "end": "2008140"
  },
  {
    "text": "UNIX box you're unlikely to start Rd peeing through a UNIX system you're unlikely unless there's this particular",
    "start": "2008140",
    "end": "2015940"
  },
  {
    "text": "reason to use SMB to mattracks at other parts of the network so actually you could probably switch off the Kerberos",
    "start": "2015940",
    "end": "2022360"
  },
  {
    "text": "bit entirely which means this if someone breaches your UNIX system they can't take your identity and misuse it",
    "start": "2022360",
    "end": "2028690"
  },
  {
    "text": "anywhere else but they can they can take the hashes but they can't they can't take the Kerberos tickets and use them",
    "start": "2028690",
    "end": "2034740"
  },
  {
    "text": "so go have a look so that's that's an operator's view of the kinds of things",
    "start": "2034740",
    "end": "2040210"
  },
  {
    "text": "you need to be doing in terms of vendors because I think vendors had a little bit",
    "start": "2040210",
    "end": "2047230"
  },
  {
    "text": "of a hard time digesting some of this harden your binaries as I said I've been",
    "start": "2047230",
    "end": "2053110"
  },
  {
    "text": "fighting VIN teller and had some success it's going to be easier to explore it",
    "start": "2053110",
    "end": "2059050"
  },
  {
    "text": "because they aren't hardened because there isn't any a s law because there isn't any additional checking around",
    "start": "2059050",
    "end": "2067210"
  },
  {
    "text": "staff usage permissions drop on",
    "start": "2067210",
    "end": "2076210"
  },
  {
    "text": "necessarily privileges parts of SSD VIN",
    "start": "2076210",
    "end": "2081250"
  },
  {
    "text": "teller necessarily need to run as root other parts probably don't parts of the",
    "start": "2081250",
    "end": "2087730"
  },
  {
    "text": "the artifacts needs to be accessible by normal users past it don't you know that",
    "start": "2087730",
    "end": "2092860"
  },
  {
    "text": "metadata is a great example I don't know that there's a case for a user directly there to access that ad metadata despite",
    "start": "2092860",
    "end": "2100090"
  },
  {
    "text": "the fact is they're in a sequel like database and anybody could go and have a look at it",
    "start": "2100090",
    "end": "2105360"
  },
  {
    "text": "yeah cover that I think say cryptography",
    "start": "2108890",
    "end": "2114109"
  },
  {
    "text": "one of the problems with the solutions that we've looked at so far is that the hashes aren't stored particularly well",
    "start": "2114109",
    "end": "2120329"
  },
  {
    "text": "and actually the antenna Intelli one not one identity have been super useful in",
    "start": "2120329",
    "end": "2126510"
  },
  {
    "text": "terms of working to resolve that but realistically we shouldn't be storing passwords as hashes these days if ever",
    "start": "2126510",
    "end": "2136260"
  },
  {
    "text": "it's perhaps a bet is perhaps a caveat of our statement but you know there's enough good work being done on storing",
    "start": "2136260",
    "end": "2142109"
  },
  {
    "text": "passwords in inappropriate fractions please stop using hashes so I've",
    "start": "2142109",
    "end": "2151140"
  },
  {
    "text": "mentioned of Intelli were pretty awesome and that's just how olson they were so when we started speaking to them",
    "start": "2151140",
    "end": "2157380"
  },
  {
    "text": "back in June their first thought was actually can we give you your our SDK so you can make your fuzzy more effective",
    "start": "2157380",
    "end": "2162990"
  },
  {
    "text": "their second thought was great we'll get rid of the the SHA hashes will move across to be crypt their third thought",
    "start": "2162990",
    "end": "2171270"
  },
  {
    "text": "was oh yes plain plain text in memory yeah we know why that is it's because we have to keep it there in",
    "start": "2171270",
    "end": "2177990"
  },
  {
    "text": "case somebody needs to a password reset as part of the login process and we don't want to ask them for their",
    "start": "2177990",
    "end": "2183029"
  },
  {
    "text": "password again but we'll write a separate clean up thread that will clear down that memory as quickly as possible",
    "start": "2183029",
    "end": "2189029"
  },
  {
    "text": "and they pointed me there see in the next policies it was really nice and",
    "start": "2189029",
    "end": "2196200"
  },
  {
    "text": "refreshing to work with the vendor that was responsive I wish all vendors were like that but in fairness to all of the",
    "start": "2196200",
    "end": "2204240"
  },
  {
    "text": "other vendors we've been we've been talking to around this Active Directory research they've all been pretty good Red Hat being pretty happy to talk to us",
    "start": "2204240",
    "end": "2212460"
  },
  {
    "text": "and some of the other vendors who've had somewhat shorter timelines I think there's a vendor I started talking to",
    "start": "2212460",
    "end": "2218339"
  },
  {
    "text": "you last week they've been good too the",
    "start": "2218339",
    "end": "2224099"
  },
  {
    "text": "takeaway should shouldn't be that the vendors are doing this because they're",
    "start": "2224099",
    "end": "2229260"
  },
  {
    "text": "lazy because they're incapable they're doing it because no but nobody ie their customers is asking for them to be more",
    "start": "2229260",
    "end": "2235680"
  },
  {
    "text": "secure say some conclusions a little bit on",
    "start": "2235680",
    "end": "2245010"
  },
  {
    "text": "what we've learned some next steps because there will be more work that I'm publishing energy costs and there's some",
    "start": "2245010",
    "end": "2251280"
  },
  {
    "text": "Frank's say what have we learned Active Directory on UNIX is just the",
    "start": "2251280",
    "end": "2258510"
  },
  {
    "text": "same as Active Directory on Windows fact it's just the same as Active Directory or Windows around the area of XP hashes",
    "start": "2258510",
    "end": "2268470"
  },
  {
    "text": "passwords not well protected trust relationships are there to be exploited and quite frankly read the manual so my",
    "start": "2268470",
    "end": "2279330"
  },
  {
    "text": "next steps so if you want to keep an eye out for what I'm going to be doing next with this the vin teller IPC",
    "start": "2279330",
    "end": "2284940"
  },
  {
    "text": "implementation i I would like to get a better handle on all of the functionality that has because it seems",
    "start": "2284940",
    "end": "2291540"
  },
  {
    "text": "they have quite a lot I'd love some POCs for some of the SSD",
    "start": "2291540",
    "end": "2296730"
  },
  {
    "text": "things if I can get them myself I will and I will be making available hopefully",
    "start": "2296730",
    "end": "2302850"
  },
  {
    "text": "with my OCS to help the blue team's pick them on their networks continuing to",
    "start": "2302850",
    "end": "2309120"
  },
  {
    "text": "work with the vendors I went into this project thinking it'd be a couple of weeks worth of work it strikes me that",
    "start": "2309120",
    "end": "2316470"
  },
  {
    "text": "there's just plenty more to be done meterpreter Metasploit i wrote some",
    "start": "2316470",
    "end": "2323340"
  },
  {
    "text": "pretty crude post exploitation modules to suit my purpose the UNIX part of",
    "start": "2323340",
    "end": "2330600"
  },
  {
    "text": "meterpreter needs love there are so many awesome things that you can do with UNIX that aren't being done because the",
    "start": "2330600",
    "end": "2337860"
  },
  {
    "text": "functionality doesn't exist I know UNIX isn't as sexy as Windows and OS X but if you've if you've got time",
    "start": "2337860",
    "end": "2344850"
  },
  {
    "text": "you've got interest I'm sure the Metroid guys would appreciate appreciate",
    "start": "2344850",
    "end": "2349970"
  },
  {
    "text": "contributions in that regards so that's just about me done apart from this I",
    "start": "2349970",
    "end": "2356730"
  },
  {
    "text": "think it's always important to acknowledge your peers the people have helped you along the way so in terms of",
    "start": "2356730",
    "end": "2363630"
  },
  {
    "text": "active help Cisco's internal security organization would be wonderful solar designer he's",
    "start": "2363630",
    "end": "2369300"
  },
  {
    "text": "the guy that writes John the Ripper or maintains John the Ripper has been great in terms of helping us",
    "start": "2369300",
    "end": "2374730"
  },
  {
    "text": "with some of the esoteric flags that are necessary to get the hashes to crack",
    "start": "2374730",
    "end": "2380520"
  },
  {
    "text": "I then borrowed ideas this isn't everybody that's ever worked on Active Directory but it's yeah it's a good",
    "start": "2380520",
    "end": "2386190"
  },
  {
    "text": "starting point you should be going on following these guys reading what they have to say and hopefully learning from",
    "start": "2386190",
    "end": "2391380"
  },
  {
    "text": "from the work they're doing I know special thanks the vendors who as",
    "start": "2391380",
    "end": "2398280"
  },
  {
    "text": "I say have been awesome I've never had a situation where vendors come back to me in a century said we'll give you",
    "start": "2398280",
    "end": "2403710"
  },
  {
    "text": "internal source code to help you attack this faster so that's that that's pretty that's pretty cool and we are down there",
    "start": "2403710",
    "end": "2413420"
  },
  {
    "text": "so are there any questions",
    "start": "2413420",
    "end": "2417170"
  },
  {
    "text": "hello one of the most important part of mimikatz and getting the hashes from the system",
    "start": "2422600",
    "end": "2429630"
  },
  {
    "text": "is lateral movement through pass the hash attacks since what you're saying is",
    "start": "2429630",
    "end": "2435270"
  },
  {
    "text": "that all implementations use custom other quotes hashing mechanisms are",
    "start": "2435270",
    "end": "2441720"
  },
  {
    "text": "those kind of lateral movement attacks possible at all so that's a great question so the question was in case you",
    "start": "2441720",
    "end": "2447210"
  },
  {
    "text": "didn't hear was some over half all the hashes in a format that you can use for posture hash right nice that's the bad",
    "start": "2447210",
    "end": "2454500"
  },
  {
    "text": "news the thing that might be sad or might be crappy depending how you look at it you can't take those hashes and use them for",
    "start": "2454500",
    "end": "2459810"
  },
  {
    "text": "pasture hash because they're stored in that custom format so that's probably",
    "start": "2459810",
    "end": "2464820"
  },
  {
    "text": "the one saving grace but yeah I did think about I was would it be nice hi I",
    "start": "2464820",
    "end": "2473130"
  },
  {
    "text": "was wondering if you ever looked into the swap file system of Linux because there's also many information within the",
    "start": "2473130",
    "end": "2480480"
  },
  {
    "text": "swap file system like credentials plain text etc absolutely great question so",
    "start": "2480480",
    "end": "2485760"
  },
  {
    "text": "yeah this sort of swath undoubtedly has more of these secrets I guess the key piece is probably figuring",
    "start": "2485760",
    "end": "2492240"
  },
  {
    "text": "out how to identify what's useful versus not you think about how multi-gigabyte server swap is going to have quite a lot",
    "start": "2492240",
    "end": "2499590"
  },
  {
    "text": "of information in it not necessarily a huge amount of useful information or food for varying values of",
    "start": "2499590",
    "end": "2507180"
  },
  {
    "text": "useful you could certainly go looking for the SSD plain taste values",
    "start": "2507180",
    "end": "2512460"
  },
  {
    "text": "I think VIN teller you would struggle I think probably if I if I be entirely",
    "start": "2512460",
    "end": "2518579"
  },
  {
    "text": "honest the best thing to do will probably be to figure out how the Intel",
    "start": "2518579",
    "end": "2524460"
  },
  {
    "text": "and SSD are actually storing the the data in memory because the best third the understanding you have of how they",
    "start": "2524460",
    "end": "2530069"
  },
  {
    "text": "lay it lay their memory out the better chance you have of retrieving so just a",
    "start": "2530069",
    "end": "2542280"
  },
  {
    "text": "curiosity on your slide you on the SSD private circuit there was here be",
    "start": "2542280",
    "end": "2549390"
  },
  {
    "text": "dragons and then on the security evaluation there was a missing dot so is",
    "start": "2549390",
    "end": "2554790"
  },
  {
    "text": "there something on you discord on that socket or all the missions are",
    "start": "2554790",
    "end": "2560369"
  },
  {
    "text": "intentional actually the forces are actually in the gate rape I've already and one identity have already got access",
    "start": "2560369",
    "end": "2568319"
  },
  {
    "text": "to that information the truth be told I haven't finished this trio of those bugs and indeed",
    "start": "2568319",
    "end": "2575819"
  },
  {
    "text": "because I only started that in the last month or say it to be continued I've not",
    "start": "2575819",
    "end": "2582869"
  },
  {
    "text": "found anything yet which is a smoking gun but the very fact that the UNIX",
    "start": "2582869",
    "end": "2588240"
  },
  {
    "text": "socket is accessible to everyone was a was a red flag in my mind when I started and I haven't done enough to prove that",
    "start": "2588240",
    "end": "2595020"
  },
  {
    "text": "it's not a red flag now but I haven't done enough to prove that it is either if that makes sense",
    "start": "2595020",
    "end": "2602030"
  },
  {
    "text": "thank you",
    "start": "2602960",
    "end": "2606078"
  },
  {
    "text": "oh good perfect",
    "start": "2612650",
    "end": "2617349"
  },
  {
    "text": "[Applause]",
    "start": "2617770",
    "end": "2621900"
  }
]