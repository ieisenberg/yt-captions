[
  {
    "start": "0",
    "end": "62000"
  },
  {
    "text": "[Music]",
    "start": "4250",
    "end": "16800"
  },
  {
    "text": "hi there uh welcome to my talk reverse engineering the tesla battery management system to increase power available",
    "start": "16800",
    "end": "23439"
  },
  {
    "text": "this was a culmination of some research that i did over the last year and was definitely one of the",
    "start": "23439",
    "end": "29039"
  },
  {
    "text": "most complicated reverse engineering things i've ever done but it was also pretty rewarding because",
    "start": "29039",
    "end": "34320"
  },
  {
    "text": "it actually uncovered a real world effect i was able to make a tesla model s",
    "start": "34320",
    "end": "40239"
  },
  {
    "text": "faster in the end and coming from a car guy who's been tuning cars pretty much his entire adult life it was a",
    "start": "40239",
    "end": "48320"
  },
  {
    "text": "fun combination of actually hacking and then you know wrenching on cars to get the",
    "start": "48320",
    "end": "54559"
  },
  {
    "text": "desired effect out of this this work so i hope you enjoy it as much as i enjoyed um",
    "start": "54559",
    "end": "60239"
  },
  {
    "text": "doing the work and the research so a little bit about me uh my name is patrick kylie i'm",
    "start": "60239",
    "end": "65360"
  },
  {
    "start": "62000",
    "end": "83000"
  },
  {
    "text": "principal security consultant at rapid7 member of the penetration testing team i've done previous research in avionics",
    "start": "65360",
    "end": "71920"
  },
  {
    "text": "security um obviously the the tesla i've researched uh some internet chemical transportation platforms also have some",
    "start": "71920",
    "end": "78720"
  },
  {
    "text": "experience in hardware hacking uh can bus etc",
    "start": "78720",
    "end": "84000"
  },
  {
    "start": "83000",
    "end": "177000"
  },
  {
    "text": "so uh some topics that we're going to cover on this is just a little outline uh first the",
    "start": "84000",
    "end": "89920"
  },
  {
    "text": "architecture of the model s and the battery management system the battery management system is the uh first kind of gatekeeper for how fast",
    "start": "89920",
    "end": "97040"
  },
  {
    "text": "the vehicle can go uh the other units are the drive inverters so performance in ludicrous timeline",
    "start": "97040",
    "end": "102399"
  },
  {
    "text": "you'll see why that's important in a minute the hardware changes that actually had to happen to the car",
    "start": "102399",
    "end": "108560"
  },
  {
    "text": "to make it go faster some components that had to be swapped out some data that's actually stored in",
    "start": "108560",
    "end": "114799"
  },
  {
    "text": "toolbox a tesla's diagnostic application and how i was able to extract that data and",
    "start": "114799",
    "end": "119840"
  },
  {
    "text": "use that to figure out the process uh some firmware changes that had to occur",
    "start": "119840",
    "end": "126079"
  },
  {
    "text": "to the car in order to actually uh you know revise the battery management system upgrade the amount of current that it",
    "start": "126079",
    "end": "132560"
  },
  {
    "text": "would allow going through it modification to the shunt the shunt is the um",
    "start": "132560",
    "end": "138000"
  },
  {
    "text": "component in the battery management in the the battery itself that actually measures the amount of current flowing it's a unique",
    "start": "138000",
    "end": "144959"
  },
  {
    "text": "component and it actually had to be modified in order to allow this upgrade to go through",
    "start": "144959",
    "end": "151280"
  },
  {
    "text": "the upgrade process itself what what the actual steps are an expensive bricking i managed to",
    "start": "151280",
    "end": "157920"
  },
  {
    "text": "actually break the car and i had to tow it across state lines uh to in order to finish the process but",
    "start": "157920",
    "end": "164640"
  },
  {
    "text": "in the end i actually learned something cool and i'll share what that was and then some next steps if if someone",
    "start": "164640",
    "end": "170080"
  },
  {
    "text": "wants to help me uh work on this and and take it further i'm continuing to work on this and i would",
    "start": "170080",
    "end": "175120"
  },
  {
    "text": "appreciate any help so uh here's a brief overview of the the",
    "start": "175120",
    "end": "181599"
  },
  {
    "start": "177000",
    "end": "245000"
  },
  {
    "text": "architecture of the model s the kind of the central point that you know when someone's hacking the car that",
    "start": "181599",
    "end": "187200"
  },
  {
    "text": "they connect to is the cid the central nation information display on uh the vehicle",
    "start": "187200",
    "end": "192239"
  },
  {
    "text": "that was the donor car for this research is an nvidia integra base the newer ones are intel based platforms including the",
    "start": "192239",
    "end": "198959"
  },
  {
    "text": "model 3 and the newer ones the gateway which is a security component that actually sits",
    "start": "198959",
    "end": "205519"
  },
  {
    "text": "between the cid and the can but various can buses of the car",
    "start": "205519",
    "end": "210959"
  },
  {
    "text": "and then specifically uh focusing in on a powertrain can bus the powertrain can bus contains the bms contains the drive inverters",
    "start": "210959",
    "end": "218480"
  },
  {
    "text": "charging units and other elements that actually control a power to the powertrain",
    "start": "218480",
    "end": "223920"
  },
  {
    "text": "that it's a standardized can bus so it runs at 500 kilobits a second",
    "start": "223920",
    "end": "229440"
  },
  {
    "text": "uses differential signaling uh two wires uh 11-bit arb ids pretty much like any",
    "start": "229440",
    "end": "236080"
  },
  {
    "text": "other can bus that you would see out there and then that can bus actually supports the uds standard we'll actually see later",
    "start": "236080",
    "end": "242239"
  },
  {
    "text": "why that's important so drilling in on the battery management",
    "start": "242239",
    "end": "247760"
  },
  {
    "start": "245000",
    "end": "380000"
  },
  {
    "text": "system or bms itself this is a picture of the bms that you see over here on the right",
    "start": "247760",
    "end": "254080"
  },
  {
    "text": "the main microprocessor is a tms 320 c2809 it's a",
    "start": "254080",
    "end": "259919"
  },
  {
    "text": "digital analog converter microprocessor made by texas instruments",
    "start": "259919",
    "end": "264960"
  },
  {
    "text": "there's also an altera cpld that's basically a hardware backup for the tms 320 in case there are any software flaws",
    "start": "264960",
    "end": "271520"
  },
  {
    "text": "uh it looks like it was engineered enough such that uh the tms 320 would have a backup in the altera in",
    "start": "271520",
    "end": "278080"
  },
  {
    "text": "case there were any kind of uh software flaws that prevented any hazardous conditions from",
    "start": "278080",
    "end": "283199"
  },
  {
    "text": "existing from the battery uh there's also a current shunt that has an stm8",
    "start": "283199",
    "end": "288479"
  },
  {
    "text": "that measures current coming from the battery and and feeds it directly into the bms board there's a pre-charge",
    "start": "288479",
    "end": "295120"
  },
  {
    "text": "resistor which when the contactors from the bms close and allow current to the",
    "start": "295120",
    "end": "301360"
  },
  {
    "text": "rest of the car the pre-charge resistor acts as a stop gap before both currents before both contactors actually close",
    "start": "301360",
    "end": "309280"
  },
  {
    "text": "and prevent inrush current damage from all that high voltage going into the other components of the vehicle",
    "start": "309280",
    "end": "315120"
  },
  {
    "text": "and then there are b and b boards on each battery pack uh the the 85 90 and 100",
    "start": "315120",
    "end": "322000"
  },
  {
    "text": "uh kilowatt hour battery packs all have 16 of them and those all connect back through a bus into the uh the dms board",
    "start": "322000",
    "end": "330000"
  },
  {
    "text": "they actually have a bleed resistors and they're a very important component and actually maintaining a level state",
    "start": "330000",
    "end": "335600"
  },
  {
    "text": "of charge across the entire battery all the firmware component changes that we actually did to the car occurred in",
    "start": "335600",
    "end": "342080"
  },
  {
    "text": "the tms 320. then there are a few changes to the shine so we'll go over that",
    "start": "342080",
    "end": "347120"
  },
  {
    "text": "this next picture actually shows all the individual components kind of hooked up except for the bmvs i just have one of those we have the pre-charge",
    "start": "347120",
    "end": "354320"
  },
  {
    "text": "resistor the shunt itself two large pieces of copper with another um piece of metal",
    "start": "354320",
    "end": "362160"
  },
  {
    "text": "welded between the two the contactors themselves uh voltage sense wires which",
    "start": "362160",
    "end": "367360"
  },
  {
    "text": "actually connect to the four different uh terminals of the contactor to measure that the contactors are open or closed",
    "start": "367360",
    "end": "372880"
  },
  {
    "text": "and there isn't a short situation going on there and also measures the amount of voltage",
    "start": "372880",
    "end": "377919"
  },
  {
    "text": "currently provided by the battery so a little bit of history on this the",
    "start": "377919",
    "end": "383120"
  },
  {
    "start": "380000",
    "end": "482000"
  },
  {
    "text": "p85d the the subject of this actual research it was announced in october 10th of 2014",
    "start": "383120",
    "end": "390000"
  },
  {
    "text": "but then almost a year later in july of 2015 ludicrous is announced",
    "start": "390000",
    "end": "395440"
  },
  {
    "text": "so the dual motor motor performance vehicle was released before that and that's important",
    "start": "395440",
    "end": "401199"
  },
  {
    "text": "because there was a retrofit available for new vehicles purchased after",
    "start": "401199",
    "end": "406319"
  },
  {
    "text": "ludicrous was announced it was a ten thousand dollar upgrade but uh as a loyalty or or from some",
    "start": "406319",
    "end": "412400"
  },
  {
    "text": "other reason they decide to actually offer for a limited time a five thousand dollar upgrade for existing p85d owners but if you didn't",
    "start": "412400",
    "end": "419120"
  },
  {
    "text": "take advantage of it during that limited time you couldn't take advantage of it later so you couldn't buy a used p85",
    "start": "419120",
    "end": "425680"
  },
  {
    "text": "d today and actually pay tesla to do the upgrade they don't offer that anymore",
    "start": "425680",
    "end": "430880"
  },
  {
    "text": "the hardware part of the upgrade involves new contactors and a pyrofuse those are very important components that actually",
    "start": "430880",
    "end": "437680"
  },
  {
    "text": "allow additional current to flow through the battery and then many of the battery packs that",
    "start": "437680",
    "end": "445199"
  },
  {
    "text": "came in the teslas after that were actually already upgraded with the new components",
    "start": "445199",
    "end": "450639"
  },
  {
    "text": "and they're just ludicrous capable so um what that meant is there was just a configuration change that had to happen",
    "start": "450639",
    "end": "456479"
  },
  {
    "text": "on the car um it was just a software change it wasn't where you actually had to reprogram",
    "start": "456479",
    "end": "463039"
  },
  {
    "text": "firmware you just had to make a single setting change on a single file on the gateway so uh ludicrous cable basically means if you",
    "start": "463039",
    "end": "469360"
  },
  {
    "text": "add performance add-on 1 to the internal dat file that's existing on the gateway",
    "start": "469360",
    "end": "475199"
  },
  {
    "text": "it would enable the car for ludicrous assuming it had the battery pack and everything else capable",
    "start": "475199",
    "end": "482319"
  },
  {
    "start": "482000",
    "end": "522000"
  },
  {
    "text": "so what we did i had a donor vehicle we actually did the upgrade i drove out to california",
    "start": "482720",
    "end": "489199"
  },
  {
    "text": "had the car out there uh because that's where i actually had access to a friend that has a lift there's a",
    "start": "489199",
    "end": "494879"
  },
  {
    "text": "guy but that goes by the name of bitbuster is a bmw hacker um he has a body shop offered use of his",
    "start": "494879",
    "end": "500639"
  },
  {
    "text": "lift he was actually the first guy that was able to retrofit autopilot ii to an autopilot one vehicle i mean he",
    "start": "500639",
    "end": "507440"
  },
  {
    "text": "was actually doing that work while while i was working on this and he was successful he actually was able to add all the cameras and",
    "start": "507440",
    "end": "513518"
  },
  {
    "text": "everything make a an ap1 car ep 2 very cool work but he helped me with this and so thank you bitbuster",
    "start": "513519",
    "end": "519760"
  },
  {
    "text": "so here's the vehicle up on a lift here's a picture of the vehicle with a",
    "start": "519760",
    "end": "525040"
  },
  {
    "text": "pack dropped out of it um so we basically did all the components remove the central",
    "start": "525040",
    "end": "530959"
  },
  {
    "text": "uh bolts and then dropped it onto this giant heavy weight chassis that could support",
    "start": "530959",
    "end": "536720"
  },
  {
    "text": "the entire weight of the vehicle itself remove the side bolts and then raise the car back up so we could do the work",
    "start": "536720",
    "end": "544000"
  },
  {
    "start": "543000",
    "end": "578000"
  },
  {
    "text": "here's a close-up of the where the actual pyrofuse sits the pyrofuse actually sits between",
    "start": "544399",
    "end": "550000"
  },
  {
    "text": "um two sides of the the battery packs so basically",
    "start": "550000",
    "end": "555440"
  },
  {
    "text": "midway through if you if you think of like you know one side as being the the most negative and one sided being the most positive it it's halfway",
    "start": "555440",
    "end": "561600"
  },
  {
    "text": "between those two so between eight of the packs uh is where this fuse sits and we had to go from a conventional",
    "start": "561600",
    "end": "567680"
  },
  {
    "text": "fuse which is what you see in this picture to uh pyrofuse a picture on the right is a picture of",
    "start": "567680",
    "end": "572720"
  },
  {
    "text": "the contactor bay with the old contactors removed and then in the next slide you can actually see a",
    "start": "572720",
    "end": "578880"
  },
  {
    "start": "578000",
    "end": "595000"
  },
  {
    "text": "close-up of the new contactor's end and a close-up of the current shunt you can see that the current shunt",
    "start": "578880",
    "end": "584880"
  },
  {
    "text": "exists right between the contactors and then the rest of the battery and that's what actually measures the amount of",
    "start": "584880",
    "end": "590640"
  },
  {
    "text": "current going through it so those are the hardware changes uh what about the firmware",
    "start": "590640",
    "end": "596480"
  },
  {
    "start": "595000",
    "end": "674000"
  },
  {
    "text": "uh for this we need to dig into some python so tesla makes a diagnostic tool called cool toolbox it runs on windows",
    "start": "596480",
    "end": "603440"
  },
  {
    "text": "but it's mostly written in python so it's an executable that's written in python and it uses all these uh which you see",
    "start": "603440",
    "end": "608800"
  },
  {
    "text": "our scramble files in in my little screenshot here um these scramble files are encrypted",
    "start": "608800",
    "end": "614320"
  },
  {
    "text": "and then they're actually compiled and then encrypted but to reverse that we had to decrypt them and then decompile them",
    "start": "614320",
    "end": "621120"
  },
  {
    "text": "and uh these files are contained as individual plugins that when a technician is actually using",
    "start": "621120",
    "end": "629040"
  },
  {
    "text": "toolbox these files are are decrypted on the fly even if they don't have a connection to there so basically what",
    "start": "629040",
    "end": "635519"
  },
  {
    "text": "uh it tells us is that everything that we need to decrypt those files you can actually",
    "start": "635519",
    "end": "640959"
  },
  {
    "text": "get from a laptop that's actually running the software so uh",
    "start": "640959",
    "end": "646720"
  },
  {
    "text": "someone else not me actually figured out how to to do that decryption shared that information with me and then",
    "start": "646720",
    "end": "652880"
  },
  {
    "text": "i started to dig through these scramble files to to find out uh what we could find out for the process",
    "start": "652880",
    "end": "658959"
  },
  {
    "text": "so once you decrypt them you can actually just use uncompiled six it's a standard python module and it'll give us",
    "start": "658959",
    "end": "664079"
  },
  {
    "text": "the source code and then uh what's really cool is the the source code actually had all the",
    "start": "664079",
    "end": "670160"
  },
  {
    "text": "comments left in place so a next few slides are gonna show some of the data we're able to get so",
    "start": "670160",
    "end": "675600"
  },
  {
    "start": "674000",
    "end": "689000"
  },
  {
    "text": "this is a little header of one of the files that was uh uncompiled and you can actually see it has uh all",
    "start": "675600",
    "end": "682320"
  },
  {
    "text": "the information about who wrote it uh information on it and then you know",
    "start": "682320",
    "end": "687600"
  },
  {
    "text": "just regular python source code uh helpful comments so here's one specific to ludicrous uh",
    "start": "687600",
    "end": "694480"
  },
  {
    "start": "689000",
    "end": "705000"
  },
  {
    "text": "it tells us that you know some of the things that it actually has to have and some of the things that it's actually",
    "start": "694480",
    "end": "700399"
  },
  {
    "text": "checking so comments like these actually helped point us in the correct direction",
    "start": "700399",
    "end": "705440"
  },
  {
    "start": "705000",
    "end": "915000"
  },
  {
    "text": "and then we actually had a lot of data structures so if you see these qt resource data qt resource name and qt",
    "start": "705440",
    "end": "712399"
  },
  {
    "text": "resource structure that's all binary data i wrote a really really ugly python",
    "start": "712399",
    "end": "719600"
  },
  {
    "text": "extraction file to iterate through every single python module and extract it if those",
    "start": "719839",
    "end": "725360"
  },
  {
    "text": "variables were there and then we just ran bandwalk against it once benwalk was ran we got all sorts of very",
    "start": "725360",
    "end": "732800"
  },
  {
    "text": "useful things that were uh critical to actually figuring out this process",
    "start": "732800",
    "end": "738079"
  },
  {
    "text": "so once we did that and we got that we were able to these are some other artifacts that we actually found",
    "start": "738079",
    "end": "743120"
  },
  {
    "text": "inside the files i figured out that the pd5d that was our loner vehicle had a",
    "start": "743120",
    "end": "748320"
  },
  {
    "text": "battery pack hardware idea 57 and here are the steps that actually identify how to change that",
    "start": "748320",
    "end": "754959"
  },
  {
    "text": "battery pack id from 57 to 70. it specifically identifies three hex files that are tms 320",
    "start": "754959",
    "end": "763040"
  },
  {
    "text": "hex files that are loaded via uds onto the bms to actually",
    "start": "763040",
    "end": "769519"
  },
  {
    "text": "perform the upgrade and the first one was the updater file so basically that one's",
    "start": "769519",
    "end": "775839"
  },
  {
    "text": "needed for shunt calibration which we'll get to in a minute and then the next one is actually an application updater file that allows you",
    "start": "775839",
    "end": "782320"
  },
  {
    "text": "to update the bootloader so um the second file after the the shunt calibration is done",
    "start": "782320",
    "end": "788720"
  },
  {
    "text": "is a necessary one that's used to allow the bootloader to be updated and",
    "start": "788720",
    "end": "794160"
  },
  {
    "text": "then when the bootloader is updated um it also updates the battery pack id which",
    "start": "794160",
    "end": "799600"
  },
  {
    "text": "has all the configuration values to allow the pack to operate at ludicrous speed",
    "start": "799600",
    "end": "806720"
  },
  {
    "text": "so uh all the instructions and the files needed for the upgrade",
    "start": "807440",
    "end": "812480"
  },
  {
    "text": "process are actually stored in those toolbox files both in the source code and in",
    "start": "812480",
    "end": "818240"
  },
  {
    "text": "the uh various extracted files that we're able to get out of it",
    "start": "818240",
    "end": "823839"
  },
  {
    "text": "so um what we also had in those firmware upgrade files were dbc",
    "start": "824399",
    "end": "829680"
  },
  {
    "text": "files uh dbc files are used in canvas i'll illustrate that in just a little bit um odx files that actually defined how",
    "start": "829680",
    "end": "836880"
  },
  {
    "text": "to calibrate the shunt grant security access to the module over uds",
    "start": "836880",
    "end": "842160"
  },
  {
    "text": "and upgrade the firmware um all of that data was actually stored in these uh basic python source code so",
    "start": "842160",
    "end": "847760"
  },
  {
    "text": "even if i couldn't run toolbox because i had access to the source code now it was decompiled",
    "start": "847760",
    "end": "853279"
  },
  {
    "text": "i could actually figure out this process and use a third-party software to make it happen there were also some",
    "start": "853279",
    "end": "861040"
  },
  {
    "text": "files that stored some interesting calibration data you can see that the the image of the",
    "start": "861040",
    "end": "866480"
  },
  {
    "text": "screenshot says dot pixel so this is the dbc file for a specific version of the model s",
    "start": "866480",
    "end": "874079"
  },
  {
    "text": "it's the the dbc file that once you actually extract it out of the pickle file it's just a straight dbc file you",
    "start": "874079",
    "end": "879120"
  },
  {
    "text": "can import it into files that can actually read dbc but there was also a pickle file that",
    "start": "879120",
    "end": "885839"
  },
  {
    "text": "stored a shunt calibration data that turned out to be critical so what that actually did is that pickle",
    "start": "885839",
    "end": "893120"
  },
  {
    "text": "file had the serial number of every single ludicrous capable shunt across the",
    "start": "893120",
    "end": "900079"
  },
  {
    "text": "entire inventory of model s vehicles so um that",
    "start": "900079",
    "end": "907199"
  },
  {
    "text": "pickle file actually turned out to be critical when we uh had to figure out how to upgrade the specific vehicle i'll",
    "start": "907199",
    "end": "912720"
  },
  {
    "text": "show that in a bit as well so uh just a little background on canon",
    "start": "912720",
    "end": "918160"
  },
  {
    "text": "uds because it'll uh be critical to understand the next steps of the process",
    "start": "918160",
    "end": "924160"
  },
  {
    "text": "so uh sitting on top of the can network stack there's this protocol called uds which is a unified diagnostic services",
    "start": "924160",
    "end": "930000"
  },
  {
    "text": "this this protocol can be used to uh uh help technician diagnose problems you",
    "start": "930000",
    "end": "935279"
  },
  {
    "text": "know reads uh evaluation sensors in addition it can be used to update firmware i can networks use a descriptor file",
    "start": "935279",
    "end": "941600"
  },
  {
    "text": "called a dbc i think that means database can i've never actually seen a definition that defines what it",
    "start": "941600",
    "end": "947199"
  },
  {
    "text": "actually is but then for uds for the diagnostics there are files called odx",
    "start": "947199",
    "end": "954079"
  },
  {
    "text": "or gmd i think gm is general motors diagnostics uh odx not quite sure again what that one means",
    "start": "954079",
    "end": "960800"
  },
  {
    "text": "but those are stored kind of more of a um xml style as you kind of see over here on the right and",
    "start": "960800",
    "end": "966480"
  },
  {
    "text": "then the odx routine that you actually see a little snippet of here is the one specifically that covers",
    "start": "966480",
    "end": "972720"
  },
  {
    "text": "the calibration of the shunt and you can see in the uh source code that there are values for",
    "start": "972720",
    "end": "980320"
  },
  {
    "text": "the hardware id of the cgi one cau one so those are two values that are actually updated there are other values",
    "start": "980320",
    "end": "986639"
  },
  {
    "text": "for uh crc and the actual serial number um and then what i actually did is i",
    "start": "986639",
    "end": "992800"
  },
  {
    "text": "used a commercial tool called vehicle spy we had a license for that for work we imported the dbc files into",
    "start": "992800",
    "end": "1000480"
  },
  {
    "text": "that and then also the odx files and we're actually able to run everything from vehicle spy that's a tool made by",
    "start": "1000480",
    "end": "1007120"
  },
  {
    "text": "interpret control systems and then the other thing that we actually found out from the",
    "start": "1007120",
    "end": "1012320"
  },
  {
    "text": "dbc file is that the arb ids 7 e2 7 echo 2 and 202 from the bms",
    "start": "1012320",
    "end": "1019519"
  },
  {
    "text": "actually identify the max current available from that particular battery",
    "start": "1019519",
    "end": "1024558"
  },
  {
    "text": "pack and then uh the next three 232 266 and 2e5 from",
    "start": "1024559",
    "end": "1030000"
  },
  {
    "text": "the bms and the drive inverters uh actually identify the amount of max power and watts those",
    "start": "1030000",
    "end": "1035038"
  },
  {
    "text": "values vary and they vary based on the state of charge of the uh the vehicle uh temperature of the of the",
    "start": "1035039",
    "end": "1042079"
  },
  {
    "text": "battery pack and possibly even the uh the drive inverters themselves and then it also varies based on power recently",
    "start": "1042079",
    "end": "1048079"
  },
  {
    "text": "used tesla uses a thing called a leaky bucket theory which basically means if you have used a lot of power recently it's",
    "start": "1048079",
    "end": "1054880"
  },
  {
    "text": "going to limit the amount of power you can have until it has a chance for that kind of bucket to refill",
    "start": "1054880",
    "end": "1060559"
  },
  {
    "text": "that's that's kind of the concept behind that so if you've been hooning it for quite a bit the car is going to back off the amount",
    "start": "1060559",
    "end": "1067039"
  },
  {
    "text": "of max power that you can have right now so you can't run max power continuously but what a dbc file does this is a",
    "start": "1067039",
    "end": "1073679"
  },
  {
    "start": "1072000",
    "end": "1119000"
  },
  {
    "text": "screenshot from vehicle spy it you can see all you can",
    "start": "1073679",
    "end": "1078960"
  },
  {
    "text": "see are the can arb ids and a bunch of data bytes and data you'd actually have to reverse all engineer reverse engineer",
    "start": "1078960",
    "end": "1085360"
  },
  {
    "text": "what each of these individual signals means but with a dbc file it looks just like this so now we actually have",
    "start": "1085360",
    "end": "1092960"
  },
  {
    "text": "all of the signals identified and broken out so now we have bms power available this",
    "start": "1092960",
    "end": "1100240"
  },
  {
    "text": "is actually a screenshot from when the uh vehicle is not engaged so it's just a limited amount 18 kilowatts that are",
    "start": "1100240",
    "end": "1106320"
  },
  {
    "text": "available on rbid 232 once you actually put the vehicle into drive or",
    "start": "1106320",
    "end": "1111440"
  },
  {
    "text": "even in park that goes way up base again based on the temperature and state of charge",
    "start": "1111440",
    "end": "1117679"
  },
  {
    "text": "and then also we took those odx routines that we extracted out of toolbox and imported those into vehicle spy",
    "start": "1117919",
    "end": "1125280"
  },
  {
    "start": "1119000",
    "end": "1190000"
  },
  {
    "text": "you could use other open source odx tools to do this just vehicle spy was easy i had access to it so",
    "start": "1125280",
    "end": "1131280"
  },
  {
    "text": "we used it for this upgrade and you can see that first one what we actually have a",
    "start": "1131280",
    "end": "1136400"
  },
  {
    "text": "security access so we're able to extract the security access routine from odx",
    "start": "1136400",
    "end": "1143280"
  },
  {
    "text": "which actually uses a static seed and key that's something that was previously disclosed",
    "start": "1143280",
    "end": "1148320"
  },
  {
    "text": "in another talk on tesla but then uh we also have the odx routines for shunt calibration um",
    "start": "1148320",
    "end": "1155600"
  },
  {
    "text": "so for reading the data out of the shunt and then rewriting it all of that was in those odx retains",
    "start": "1155600",
    "end": "1160720"
  },
  {
    "text": "we're able to just import those into vehicle spy and recalibrate the shine and you can actually see a valid value",
    "start": "1160720",
    "end": "1167200"
  },
  {
    "text": "for a valid shunt in this uh in this screenshot serial number uh was and the way it",
    "start": "1167200",
    "end": "1173520"
  },
  {
    "text": "works is that actually looks up in that pickle file looks up the serial number and then looks up what the new cau1 cgi1",
    "start": "1173520",
    "end": "1181120"
  },
  {
    "text": "and crc value should be and then writes those to the shunt that's how the shunt calibration is actually done",
    "start": "1181120",
    "end": "1188480"
  },
  {
    "start": "1190000",
    "end": "1330000"
  },
  {
    "text": "so uh it turns out that that wasn't everything that was needed to be done by the shunt and thankfully i actually",
    "start": "1191520",
    "end": "1197039"
  },
  {
    "text": "decided to be safe and and do all of this research on a test bench first um i was able to",
    "start": "1197039",
    "end": "1203360"
  },
  {
    "text": "actually get a shunt that was ludicrous capable uh that but that wasn't actually done in",
    "start": "1203360",
    "end": "1208559"
  },
  {
    "text": "the research in the uh the upgrade it was just one that was separately provided as part of an upgrade kit that was actually able",
    "start": "1208559",
    "end": "1214640"
  },
  {
    "text": "to find on the secondary market but what i i figured out is that the shun actually needed a hardware",
    "start": "1214640",
    "end": "1220000"
  },
  {
    "text": "modification in addition to uh all these uh recalibration things that we had to do to it",
    "start": "1220000",
    "end": "1225280"
  },
  {
    "text": "there was a single wire excuse me",
    "start": "1225280",
    "end": "1229919"
  },
  {
    "text": "that connected the shunt to the cpld if you remember earlier i",
    "start": "1230960",
    "end": "1237280"
  },
  {
    "text": "was talking about how the cpld is a backup to the bms um and i assume",
    "start": "1237280",
    "end": "1243120"
  },
  {
    "text": "this is some type of like emergency signal that the shunt would use to tell the the",
    "start": "1243120",
    "end": "1248960"
  },
  {
    "text": "cpld to do something based on whatever was going on but basically uh after",
    "start": "1248960",
    "end": "1255200"
  },
  {
    "text": "i on the test bench after i did the firmware upgrade and upgraded a bms from 57 to 70 if i had the shunt plugged in",
    "start": "1255200",
    "end": "1264240"
  },
  {
    "text": "it would generate an alert an active alert that actually uh identified that there was a current",
    "start": "1264240",
    "end": "1269600"
  },
  {
    "text": "sense error so what i did is uh i actually made a",
    "start": "1269600",
    "end": "1274799"
  },
  {
    "text": "breakout board i i separated all the wires from the the shine going into the bms and then just ran a logic analyzer on them um started",
    "start": "1274799",
    "end": "1282080"
  },
  {
    "text": "playing around and i figured out that if this one wire was disconnected",
    "start": "1282080",
    "end": "1288400"
  },
  {
    "text": "the error actually went away so what that's actually meant is that um when the battery pack was",
    "start": "1288400",
    "end": "1295360"
  },
  {
    "text": "opened up this shine actually had to have this wire disconnected uh from the shunt itself otherwise it",
    "start": "1295360",
    "end": "1301520"
  },
  {
    "text": "would generate an error and it also meant that the entire process had to be done all at one time so",
    "start": "1301520",
    "end": "1307440"
  },
  {
    "text": "once the battery pack was dropped and the wire removed from the shunt um",
    "start": "1307440",
    "end": "1313360"
  },
  {
    "text": "it would generate an active alert if the firmware was not upgraded so it meant that we had to do the the hardware",
    "start": "1313360",
    "end": "1319440"
  },
  {
    "text": "modification and the firmware modification all at the same place all while i was out there in california during",
    "start": "1319440",
    "end": "1324799"
  },
  {
    "text": "their work and it's what led to the next um very difficult steps of the process",
    "start": "1324799",
    "end": "1333039"
  },
  {
    "start": "1330000",
    "end": "1411000"
  },
  {
    "text": "so um here's the actual process itself so i had access to the garage and left in southern california",
    "start": "1333039",
    "end": "1340080"
  },
  {
    "text": "i drove there to do the upgrade we had to make sure that the the vehicle had a very low state of charge",
    "start": "1340080",
    "end": "1346320"
  },
  {
    "text": "for safety reasons we had to drop the pack had to get some what are called lineman's gloves which",
    "start": "1346320",
    "end": "1351440"
  },
  {
    "text": "are involved in doing high voltage work i do all the hardware stuff replace the contactors replace the fuse modify the",
    "start": "1351440",
    "end": "1357440"
  },
  {
    "text": "shunt and then reinstall the pack that was very tricky um i didn't want to have a rich rebuilds moment where i",
    "start": "1357440",
    "end": "1363360"
  },
  {
    "text": "uh put the pack back in and had it start leaking and then i had to go and like drown on my own",
    "start": "1363360",
    "end": "1368799"
  },
  {
    "text": "tears about how much i actually broke a very expensive vehicle so i used a bore scope um very carefully",
    "start": "1368799",
    "end": "1376080"
  },
  {
    "text": "lowered the vehicle on the lift made sure that uh all the various connectors were lined",
    "start": "1376080",
    "end": "1381120"
  },
  {
    "text": "back up and then uh put the battery pack back in the car and it connected back up um and then uh",
    "start": "1381120",
    "end": "1388400"
  },
  {
    "text": "updated the internal dot dat added the lucrez command change the pack id and then had to redeploy the firmware",
    "start": "1388400",
    "end": "1395120"
  },
  {
    "text": "which is basically just reinstalling the same firmware that's already on the car uh to tell it the rest of the components",
    "start": "1395120",
    "end": "1401360"
  },
  {
    "text": "of the car that actually had a new pack id so then the next step was just drive away and enjoy uh",
    "start": "1401360",
    "end": "1406400"
  },
  {
    "text": "ridic the ridiculous amount of torque right nope that's not what happened so uh we used",
    "start": "1406400",
    "end": "1412559"
  },
  {
    "start": "1411000",
    "end": "1461000"
  },
  {
    "text": "known techniques that we've used before tried to redeploy the firmware tried to upgrade tried putting new",
    "start": "1412559",
    "end": "1418960"
  },
  {
    "text": "software on it everything we tried for about a day and a half failed so now i was stuck with a very",
    "start": "1418960",
    "end": "1424640"
  },
  {
    "text": "very expensive brick we couldn't even get it out of the garage because the parking brake was",
    "start": "1424640",
    "end": "1430080"
  },
  {
    "text": "engaged had to figure out how to do that too so finally i decided to punt i i called",
    "start": "1430080",
    "end": "1436480"
  },
  {
    "text": "um found a towing referral service online",
    "start": "1436480",
    "end": "1441919"
  },
  {
    "text": "and had the vehicle towed from rancho cucamonga to my home in las vegas so i could",
    "start": "1441919",
    "end": "1447200"
  },
  {
    "text": "continue to work on it um talk about a stressful weekend uh but it only cost uh",
    "start": "1447200",
    "end": "1452400"
  },
  {
    "text": "360 dollars or 3.600 so not great not terrible you know it turns out it",
    "start": "1452400",
    "end": "1458960"
  },
  {
    "text": "was actually worth it because what i did is i learned something cool the gateway uses a file",
    "start": "1458960",
    "end": "1466720"
  },
  {
    "text": "called firmware.rc during the upgrade or during a redeploy",
    "start": "1466720",
    "end": "1471840"
  },
  {
    "text": "this file is generated and basically what it does is it looks in a index file for the firmware that's",
    "start": "1471840",
    "end": "1479919"
  },
  {
    "text": "on the vehicle and then it generates a number of crc values for the various components you can see in",
    "start": "1479919",
    "end": "1485919"
  },
  {
    "text": "this image you have the gateway having its own crc value the bms having its own crc value",
    "start": "1485919",
    "end": "1492559"
  },
  {
    "text": "and the bms when the software is changed the crc value changed and that is what prevented the vehicle",
    "start": "1492559",
    "end": "1499440"
  },
  {
    "text": "from engaging the contractors and being able to drive so um i saw a single reference",
    "start": "1499440",
    "end": "1505520"
  },
  {
    "text": "done i think by the 10 cent guys where they actually talked about firmware.rc when they were doing some reverse engineering the gateway",
    "start": "1505520",
    "end": "1511200"
  },
  {
    "text": "and then i also saw the firmware.rc file mentioned in the error logs that i gathered when i was trying to do",
    "start": "1511200",
    "end": "1517440"
  },
  {
    "text": "the uh the software redeploy myself so uh i went onto my bench unit before",
    "start": "1517440",
    "end": "1523840"
  },
  {
    "text": "the car was actually towed out to me and actually requested that file from the gateway uh gw transfer",
    "start": "1523840",
    "end": "1529640"
  },
  {
    "text": "firmware.rc and then looked at it and sure enough here's this file with all these various",
    "start": "1529640",
    "end": "1535279"
  },
  {
    "text": "crc values and then a new crc value at the end so what i tried to do is i did the",
    "start": "1535279",
    "end": "1541120"
  },
  {
    "text": "firmware upgrade on the bench one more time um i was always having errors on this because you know it was",
    "start": "1541120",
    "end": "1546400"
  },
  {
    "text": "just it was the bench and i didn't really think more of it beyond that but i actually looked up the correct crc",
    "start": "1546400",
    "end": "1553039"
  },
  {
    "text": "value from the bms it also happens that it's broadcasting that across the can bus so i could have grabbed it from that as well but instead i grabbed",
    "start": "1553039",
    "end": "1559440"
  },
  {
    "text": "it from the index file put that value in it made sure that that firmware was actually what was running on the bms",
    "start": "1559440",
    "end": "1565600"
  },
  {
    "text": "and then i had to recalculate the um the file crc at the very end so what i",
    "start": "1565600",
    "end": "1572480"
  },
  {
    "text": "figured out with the help of uh some people online who are uh actually very grateful to",
    "start": "1572480",
    "end": "1578480"
  },
  {
    "text": "that that's actually a jam crc so if you take the entire file um figure out the jam crc value for it",
    "start": "1578480",
    "end": "1586000"
  },
  {
    "text": "minus what you see in this picture is line 12 but it's much further in the file because i've trimmed it down for clarity",
    "start": "1586000",
    "end": "1591360"
  },
  {
    "text": "um and then add that single line file crt with the additional value at the end",
    "start": "1591360",
    "end": "1596400"
  },
  {
    "text": "uh the gate will accept that crc value and the car was able to wake up so after i got the car back um pulled the file from the gateway",
    "start": "1596400",
    "end": "1603440"
  },
  {
    "text": "did the recalculation calculated the new crc value and uh as soon as i pushed it back to the",
    "start": "1603440",
    "end": "1609279"
  },
  {
    "text": "gateway and rebooted everything the car woke up so that was actually kind of the the cool thing that came out of the failure",
    "start": "1609279",
    "end": "1615679"
  },
  {
    "text": "and the bricking of the vehicles i i figured out how this uh former rc file actually worked and",
    "start": "1615679",
    "end": "1621760"
  },
  {
    "text": "then with that someone should be able to actually deploy whatever firmware across the vehicle they want deploy their custom firmware",
    "start": "1621760",
    "end": "1628720"
  },
  {
    "text": "or do something else that's pretty cool that wasn't intentionally designed of course if you do this wrong you could cause",
    "start": "1628720",
    "end": "1634640"
  },
  {
    "text": "some pretty bad things so i don't recommend actually doing this unless you're really careful but it was actually a pretty cool thing",
    "start": "1634640",
    "end": "1641039"
  },
  {
    "text": "that we figured out so here's my kind of uh poc slide",
    "start": "1641039",
    "end": "1646399"
  },
  {
    "start": "1644000",
    "end": "1707000"
  },
  {
    "text": "this is a canvas these are the static values that i talked about earlier before the upgrade it would have a max",
    "start": "1646399",
    "end": "1654080"
  },
  {
    "text": "current of 1305. after the upgrade it was a 15 16.",
    "start": "1654080",
    "end": "1659600"
  },
  {
    "text": "and then uh there's there's actually a separate cr value under can id 202 that's actually",
    "start": "1659600",
    "end": "1665279"
  },
  {
    "text": "reduced a little bit i don't know why if someone from tesla actually wants to share that with me",
    "start": "1665279",
    "end": "1671039"
  },
  {
    "text": "and they tell me i got to keep it secret i'd be happy with that or if they tell me i can talk about it that's fine too",
    "start": "1671039",
    "end": "1676240"
  },
  {
    "text": "but i would really like to know why the the actual max discharge current value is less than what's actually being put",
    "start": "1676240",
    "end": "1683679"
  },
  {
    "text": "out by the the 72 can bus id value of 1516.",
    "start": "1683679",
    "end": "1689520"
  },
  {
    "text": "why that discrepancy is there is there some type of attenuation or some type of derating",
    "start": "1689520",
    "end": "1695440"
  },
  {
    "text": "that's going on it doesn't actually look like there's any d rating going on because it doesn't say there's a d rating active but",
    "start": "1695440",
    "end": "1701520"
  },
  {
    "text": "it could be that that just can't id is not being used uh so beyond this uh where can we take",
    "start": "1701520",
    "end": "1708480"
  },
  {
    "start": "1707000",
    "end": "1796000"
  },
  {
    "text": "this further so we've actually managed to ludicrous a p85d",
    "start": "1708480",
    "end": "1713760"
  },
  {
    "text": "um it turns out the tms-320 is actually supporting ida pro i've",
    "start": "1713760",
    "end": "1719360"
  },
  {
    "text": "actually done a little bit of research on that using the firmware i've found some interesting things um",
    "start": "1719360",
    "end": "1727039"
  },
  {
    "text": "so uh there are those arb ids already we talked about seven echo two and two or two that define the max current",
    "start": "1727039",
    "end": "1732799"
  },
  {
    "text": "um it seems that we should be able to increase speed beyond ludicrous but i can't say that actors actually",
    "start": "1732799",
    "end": "1738559"
  },
  {
    "text": "recommend anyone doing this unless they're really really careful because uh these limits are put in place",
    "start": "1738559",
    "end": "1744720"
  },
  {
    "text": "for a reason uh but just like anything with any uh vehicle there are limits and then there are",
    "start": "1744720",
    "end": "1750720"
  },
  {
    "text": "limits that are dangerous to push yourself past but",
    "start": "1750720",
    "end": "1756080"
  },
  {
    "text": "um it's possible that someone could actually figure out and someone could work with me and actually",
    "start": "1756080",
    "end": "1761440"
  },
  {
    "text": "figure out how to go past ludicrous because it seems reasonable that if we have access to all the firmware",
    "start": "1761440",
    "end": "1766960"
  },
  {
    "text": "uh we should be able to bump up these these limits past what it would uh be able to go and then",
    "start": "1766960",
    "end": "1772159"
  },
  {
    "text": "actually find out where the limits of the vehicle are um so uh hit me up if you'd like to",
    "start": "1772159",
    "end": "1777440"
  },
  {
    "text": "assist uh my information's easily out there you can find me on linkedin",
    "start": "1777440",
    "end": "1782640"
  },
  {
    "text": "the other big thing that i'm really curious about are what are those shunt parameters cau one cgi one",
    "start": "1782640",
    "end": "1789600"
  },
  {
    "text": "i noticed that before the ludicrous upgrade they were different but after they were in that pickle file they were",
    "start": "1789600",
    "end": "1795039"
  },
  {
    "text": "all the same and then just some references uh you know",
    "start": "1795039",
    "end": "1800320"
  },
  {
    "start": "1796000",
    "end": "1819000"
  },
  {
    "text": "obviously spaceball movies the various announcements from tesla a definition of my current chance if",
    "start": "1800320",
    "end": "1805520"
  },
  {
    "text": "you'd like to go out there and actually figure out how one of those works and and how they use a known resistance value to calculate amperage",
    "start": "1805520",
    "end": "1812000"
  },
  {
    "text": "uh datasheet in the tms320 and then of course interrupting control systems the maker of the software that i use to",
    "start": "1812000",
    "end": "1817679"
  },
  {
    "text": "actually do the upgrade thank you",
    "start": "1817679",
    "end": "1823840"
  },
  {
    "start": "1819000",
    "end": "1985000"
  },
  {
    "text": "okay so going over some of the questions um yeah resistor tolerance isn't",
    "start": "1827440",
    "end": "1834559"
  },
  {
    "text": "something i i checked i assume that since all the shunt resistors are actually stored",
    "start": "1834559",
    "end": "1840240"
  },
  {
    "text": "with values in a table those probably have to be pretty accurate but it's something i can look",
    "start": "1840240",
    "end": "1846080"
  },
  {
    "text": "into over there firmware updates the way those processes work",
    "start": "1846080",
    "end": "1853279"
  },
  {
    "text": "that's this is a question from michael bowman um",
    "start": "1853279",
    "end": "1858000"
  },
  {
    "text": "the over the firmware updates actually completely rewrite that file uh so no they wouldn't it should be",
    "start": "1858880",
    "end": "1866640"
  },
  {
    "text": "um just fine what because what i've actually done over the air firmware updates on the donor vehicle",
    "start": "1866640",
    "end": "1873279"
  },
  {
    "text": "it actually completely rewrites the file so it would probably fail if there's",
    "start": "1873279",
    "end": "1878640"
  },
  {
    "text": "something in the config that it doesn't like in fact that's what i did",
    "start": "1878640",
    "end": "1883518"
  },
  {
    "text": "so no it shouldn't cause the crc to fail it should just completely rewrite that file",
    "start": "1884799",
    "end": "1891039"
  },
  {
    "text": "to answer i'm going to try and get these in order uh so i didn't actually try anything",
    "start": "1891039",
    "end": "1898399"
  },
  {
    "text": "with reverse gear i would have to actually put it in reverse and actually look at current limits for that so no i haven't actually",
    "start": "1898399",
    "end": "1904799"
  },
  {
    "text": "done any of that the model 3 long range all-wheel drive stuff i haven't done any model 3",
    "start": "1904799",
    "end": "1911279"
  },
  {
    "text": "research so i couldn't ask you that although i have seen a lot of the um the research that basically said it's",
    "start": "1911279",
    "end": "1917039"
  },
  {
    "text": "the same vehicle but the model 3 has a completely different way of actually controlling the config on it and it's",
    "start": "1917039",
    "end": "1924080"
  },
  {
    "text": "again it's not something i've researched at all i did work with tesla on the the subject",
    "start": "1924080",
    "end": "1929360"
  },
  {
    "text": "of this talk and they were actually very supportive of it all so all the slides uh went through them we",
    "start": "1929360",
    "end": "1934720"
  },
  {
    "text": "had some meetings and they were very supportive of me actually doing this reverse engineering",
    "start": "1934720",
    "end": "1941120"
  },
  {
    "text": "um matt's question does tesla apply specific access measures on the canvas",
    "start": "1941120",
    "end": "1946159"
  },
  {
    "text": "to frustrate these type of approaches not that i've seen it looks like all of the effort right now that tesla",
    "start": "1946159",
    "end": "1952399"
  },
  {
    "text": "is doing is actually on the the main mcu so they're actually doing been doing a lot of firmware",
    "start": "1952399",
    "end": "1957519"
  },
  {
    "text": "updates to actually frustrate people getting access to the mcu itself the can bus still uses the",
    "start": "1957519",
    "end": "1963039"
  },
  {
    "text": "same static seat and key and if you want specific details on that check out the car hacking village talk but basically um",
    "start": "1963039",
    "end": "1970240"
  },
  {
    "text": "the the seat and key are static on every single tesla module that i've tested up to the most recent ones",
    "start": "1970240",
    "end": "1976000"
  },
  {
    "text": "so that would be the the biggest access measure that they could do on that to frustrate this to kind of work",
    "start": "1976000",
    "end": "1983760"
  },
  {
    "text": "right now the only ecu that i focused on is the bms so um there's not really any other ecu",
    "start": "1984559",
    "end": "1992960"
  },
  {
    "text": "that i'm confident i can modify the firmware for uh the other recovery procedure was",
    "start": "1992960",
    "end": "1998640"
  },
  {
    "text": "basically not to make the config change that actually caused the firmware flash the the firmware redeploy failure in the",
    "start": "1998640",
    "end": "2004960"
  },
  {
    "text": "first place uh alan that's a great question about the the parking brake so uh if you open up the trunk of the",
    "start": "2004960",
    "end": "2011679"
  },
  {
    "text": "vehicle i actually had some pictures of this it just for time i didn't really get into it too much",
    "start": "2011679",
    "end": "2018559"
  },
  {
    "text": "the way we got the car out of the the garage was we looked at where the module was i had",
    "start": "2019039",
    "end": "2025440"
  },
  {
    "text": "access to all the um the wiring diagram so we knew that the module for the electronic parking brake",
    "start": "2025440",
    "end": "2030720"
  },
  {
    "text": "was in the rear of the vehicle behind kind of the side panel in the uh in the trunk so basically you pull off",
    "start": "2030720",
    "end": "2036559"
  },
  {
    "text": "that little uh i don't know what to call it kind of like a fibrous material covering the uh between",
    "start": "2036559",
    "end": "2041840"
  },
  {
    "text": "the metal skin of the vehicle and the uh the edge and you have actually access to where the parking brake module is",
    "start": "2041840",
    "end": "2048240"
  },
  {
    "text": "so what we did is we actually disconnected the leads going down to the actual electronic parking brakes themselves and applied 12 volts to those",
    "start": "2048240",
    "end": "2056320"
  },
  {
    "text": "uh with the correct polarity i had access to a wiring diagram so we can actually see the um the wire colors and that actually",
    "start": "2056320",
    "end": "2063200"
  },
  {
    "text": "unwound the parking brakes enough so that we could freely push the vehicle",
    "start": "2063200",
    "end": "2068320"
  },
  {
    "text": "um newer intel stuff i've only i know some people that are actually hacking on",
    "start": "2069280",
    "end": "2074320"
  },
  {
    "start": "2070000",
    "end": "2106000"
  },
  {
    "text": "it but all my work has been on the nvidia so i haven't done any stuff on the newer intel ones but the newer vehicles actually all",
    "start": "2074320",
    "end": "2080800"
  },
  {
    "text": "are um you know p100ds and they actually have the batteries upgraded",
    "start": "2080800",
    "end": "2086000"
  },
  {
    "text": "automatically i know some people have done some stuff on the intel units",
    "start": "2086000",
    "end": "2091440"
  },
  {
    "text": "but they use a different emmc and it's really completely new hardware there was some cool stuff",
    "start": "2091440",
    "end": "2098320"
  },
  {
    "text": "some people did on the gateway but i think tesla closed those uh avenues off",
    "start": "2098320",
    "end": "2104800"
  },
  {
    "start": "2106000",
    "end": "2168000"
  },
  {
    "text": "the only authentication i saw on the firmware itself was the crc value but the overall firmware is signed",
    "start": "2106560",
    "end": "2115280"
  },
  {
    "text": "so when the overall firmware is loaded onto a vehicle there's a long signature check that occurs",
    "start": "2115280",
    "end": "2121760"
  },
  {
    "text": "um lexier question the work could be used to increase mileage so",
    "start": "2121760",
    "end": "2128400"
  },
  {
    "text": "range on the vehicle that's that's a really tricky one because a lot of that's based on resistance i i don't think any of the",
    "start": "2128400",
    "end": "2134880"
  },
  {
    "text": "work i could do to actually increase that other than basically preventing people from stomping on their vehicles so um",
    "start": "2134880",
    "end": "2144000"
  },
  {
    "text": "i again i didn't try any of the uds stuff because the car was because the the contactors",
    "start": "2144000",
    "end": "2149599"
  },
  {
    "text": "were forced being closed i was having trouble even maintaining enough 12 volts to even um do anything at all so i",
    "start": "2149599",
    "end": "2157920"
  },
  {
    "text": "figured the best bet was to actually physically attach to the parking brake",
    "start": "2157920",
    "end": "2163040"
  },
  {
    "text": "modules and unwind them uh william reading i don't quite",
    "start": "2163040",
    "end": "2169280"
  },
  {
    "start": "2168000",
    "end": "2456000"
  },
  {
    "text": "understand your question if you could clarify that a little bit what keys are you referring to um keys for all these things stored so",
    "start": "2169280",
    "end": "2175119"
  },
  {
    "text": "what keys do you mean by that but i'm not quite sure what you mean by that and i think that brings us up to date on the questions",
    "start": "2175119",
    "end": "2181920"
  },
  {
    "text": "oh now we have a question one so uh i think we've covered all of this",
    "start": "2181920",
    "end": "2190960"
  },
  {
    "text": "yeah i think that covers everything in the main chat",
    "start": "2193599",
    "end": "2198320"
  },
  {
    "text": "uh oh okay so uh how do we obtain the signing keys so um that was actually based on some",
    "start": "2198720",
    "end": "2204960"
  },
  {
    "text": "research some other people did i'm not going to comment any further on that because uh they've asked that i i keep their um their facts",
    "start": "2204960",
    "end": "2213040"
  },
  {
    "text": "kind of to themselves um they showed me how to do it but then they asked me not to comment on it but basically if you",
    "start": "2213040",
    "end": "2218560"
  },
  {
    "text": "think about like this you have a technician's laptop that laptop has these encrypted",
    "start": "2218560",
    "end": "2225680"
  },
  {
    "text": "python modules on it yet that laptop is designed to operate entirely independently",
    "start": "2225680",
    "end": "2230880"
  },
  {
    "text": "of being connected to the internet so um whoever's logged into that laptop",
    "start": "2230880",
    "end": "2237359"
  },
  {
    "text": "needs to be able to run toolbox completely independently so therefore it would only logically assume that somewhere on that",
    "start": "2237359",
    "end": "2245359"
  },
  {
    "text": "machine where the keys were the uh the encryption keys for actually uh decrypting all of those",
    "start": "2245359",
    "end": "2250800"
  },
  {
    "text": "modules and that's about all i can say on that",
    "start": "2250800",
    "end": "2257520"
  },
  {
    "text": "but pretty much everything uses standard python library so if you're a python guru it's probably",
    "start": "2257520",
    "end": "2262560"
  },
  {
    "text": "not going to be that difficult for you",
    "start": "2262560",
    "end": "2265760"
  },
  {
    "text": "let's see if we have any other questions got a couple more minutes",
    "start": "2269680",
    "end": "2285838"
  },
  {
    "text": "so any more questions",
    "start": "2293680",
    "end": "2299838"
  },
  {
    "text": "all right thank you jerry for the feedback i appreciate that",
    "start": "2312800",
    "end": "2318480"
  },
  {
    "text": "um so the config itself if you can remember",
    "start": "2323040",
    "end": "2329839"
  },
  {
    "text": "the beginning of the talk there's um a talk where we talk about the file",
    "start": "2329839",
    "end": "2334960"
  },
  {
    "text": "internal dot dat um that internal dot dat file the",
    "start": "2334960",
    "end": "2340400"
  },
  {
    "text": "contents of that get sent up to tesla on a regular basis so i'm assuming if",
    "start": "2340400",
    "end": "2346400"
  },
  {
    "text": "there's some diffing going on on their end uh if anyone tampers with their internal debt file they would know right away",
    "start": "2346400",
    "end": "2355680"
  },
  {
    "text": "yes so um there's actually been quite a bit of reverse engineering work done to do all",
    "start": "2355680",
    "end": "2361680"
  },
  {
    "text": "sorts of stuff like adding the um the heated rear seats adding the heated steering wheel",
    "start": "2361680",
    "end": "2367839"
  },
  {
    "text": "adding dual chargers adding uh heated washer knobs washer nozzles to vehicles didn't",
    "start": "2367839",
    "end": "2373839"
  },
  {
    "text": "otherwise have that the guy that loaned me his garage actually figured out how to reverse",
    "start": "2373839",
    "end": "2380880"
  },
  {
    "text": "engineer the entire autopilot 2 system so that he could basically shoehorn autopilot 2 into an autopilot",
    "start": "2380880",
    "end": "2387200"
  },
  {
    "text": "one vehicle for those of you aren't aware autopilot 2 uses eight cameras autopilot one is",
    "start": "2387200",
    "end": "2392320"
  },
  {
    "text": "one autopilot two was created by tesla autopilot one was the mobilize system so it's a completely different system",
    "start": "2392320",
    "end": "2398800"
  },
  {
    "text": "he even had to replace the steering rack replace the brake modules",
    "start": "2398800",
    "end": "2406000"
  },
  {
    "text": "as well as add all of the cameras including in the the b pillar where there wasn't really a hole for it he",
    "start": "2406000",
    "end": "2411280"
  },
  {
    "text": "actually had to cut the hole for the detailer but considering he owned a body shop that was relatively easy work for him he actually",
    "start": "2411280",
    "end": "2417599"
  },
  {
    "text": "got a functioning autopilot ii system running in a vehicle that was originally configured with autopilot one",
    "start": "2417599",
    "end": "2425839"
  },
  {
    "text": "so the other there aren't really any other tesla ecu's that i've focused on i'm just aware that several of the other",
    "start": "2427440",
    "end": "2433839"
  },
  {
    "text": "ecu's actually have the tms 320 so those techniques could be very similar",
    "start": "2433839",
    "end": "2439838"
  },
  {
    "text": "so i think that's about it again check out the car hacking village talk or the defcon talk later this week there's no charge for",
    "start": "2444880",
    "end": "2451520"
  },
  {
    "text": "either of those and hopefully love some other q a",
    "start": "2451520",
    "end": "2458160"
  }
]