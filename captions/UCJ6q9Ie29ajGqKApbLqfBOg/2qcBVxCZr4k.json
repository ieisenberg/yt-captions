[
  {
    "start": "0",
    "end": "12000"
  },
  {
    "text": "okay good afternoon everybody my name is Eric Evan chick and you are in open-sourcing automotive diagnostics",
    "start": "0",
    "end": "6529"
  },
  {
    "text": "hopefully that's where you want to be for the next hour so but should be fun just a little quick intro to me and what",
    "start": "6529",
    "end": "15269"
  },
  {
    "start": "12000",
    "end": "58000"
  },
  {
    "text": "I do spent the last few years kind of hacking cars for a living I guess run a",
    "start": "15269",
    "end": "21029"
  },
  {
    "text": "little company up in Canada called link layer labs that develops the open-source hardware tools one being a canvas to USB",
    "start": "21029",
    "end": "27150"
  },
  {
    "text": "tool that's quite relevant to this talk some of the stuff not very relevant as a",
    "start": "27150",
    "end": "32250"
  },
  {
    "text": "very recently I am actually a research consultant with a treadeth partners we",
    "start": "32250",
    "end": "37590"
  },
  {
    "text": "do what kinds of security consulting and research for folks with a big focus on",
    "start": "37590",
    "end": "43110"
  },
  {
    "text": "mobile and embedded and also automotive stuff and I also write for the blog",
    "start": "43110",
    "end": "48899"
  },
  {
    "text": "hackaday which I just have to give a shameless plug to hackaday if you're not familiar with hackaday hackaday come",
    "start": "48899",
    "end": "54989"
  },
  {
    "text": "check it out we got lots of cool hardware hack but a quick outline of it we're going to do today we'll do a",
    "start": "54989",
    "end": "60899"
  },
  {
    "start": "58000",
    "end": "89000"
  },
  {
    "text": "little overview of in vehicle networks for those of you that are not terribly familiar with them I like to ask is",
    "start": "60899",
    "end": "66390"
  },
  {
    "text": "there any automotive industry folks in here don't be shy we have one one automotive okay hopefully it won't be",
    "start": "66390",
    "end": "73500"
  },
  {
    "text": "bored but we'll do like a little overview of what's actually in the car nowadays and then we'll talk with Diagnostics main theme and then we'll go",
    "start": "73500",
    "end": "80909"
  },
  {
    "text": "over the tools we'll do a little tool release of what I've been working on and why I'm here more or less we'll demo",
    "start": "80909",
    "end": "86369"
  },
  {
    "text": "that a bit and do some conclusions but let's start with a disclaimer you can",
    "start": "86369",
    "end": "92460"
  },
  {
    "start": "89000",
    "end": "132000"
  },
  {
    "text": "brick ie render useless a car via Diagnostics it",
    "start": "92460",
    "end": "97860"
  },
  {
    "text": "is doable you can erase firmware it would not work out well your engine will",
    "start": "97860",
    "end": "103500"
  },
  {
    "text": "not start if it has no code you can also modify these systems via Diagnostics and",
    "start": "103500",
    "end": "109320"
  },
  {
    "text": "they are safety critical systems so you need to be cognizant of that and some",
    "start": "109320",
    "end": "114570"
  },
  {
    "text": "diagnostic actions things like maybe changing VIN numbers or odometer values might be illegal where you live and that",
    "start": "114570",
    "end": "123329"
  },
  {
    "text": "would be bad for you to do those so this is a very proceed at your own risk know what you're getting into the stuff",
    "start": "123329",
    "end": "130110"
  },
  {
    "text": "can be dangerous in vehicle networks so it's important to",
    "start": "130110",
    "end": "135159"
  },
  {
    "start": "132000",
    "end": "221000"
  },
  {
    "text": "understand the actual systems that we're looking at and they're starting to get very complex so an automotive network",
    "start": "135159",
    "end": "141280"
  },
  {
    "text": "consists of a bunch of electronic control units or ECU's that's just what the industry calls them these are all",
    "start": "141280",
    "end": "147489"
  },
  {
    "text": "discrete computers typically they have a microcontroller inside of them some more hardware they're running software to do",
    "start": "147489",
    "end": "154540"
  },
  {
    "text": "everything from make your engine fire to make your doors unlock to deploy your",
    "start": "154540",
    "end": "159819"
  },
  {
    "text": "airbags it's just a huge amount of software and systems it's probably the",
    "start": "159819",
    "end": "165250"
  },
  {
    "text": "most complex distributed system that you would own and a modern car game can have",
    "start": "165250",
    "end": "171579"
  },
  {
    "text": "up to a hundred of these in like a high-end vehicle which is you know a lot of a lot of computers and a lot of code",
    "start": "171579",
    "end": "177370"
  },
  {
    "text": "and typically they're all connected via this thing called can bus or controller area network I'll refer to it as can",
    "start": "177370",
    "end": "184540"
  },
  {
    "text": "from now on this is a late 80s standard that came into place as it's just a nice",
    "start": "184540",
    "end": "191139"
  },
  {
    "text": "way to let controllers talk to each other it's really cheap to implement compared to some other things it's quite",
    "start": "191139",
    "end": "197139"
  },
  {
    "text": "reliable and it works quite nicely it has some problems with security but it works quite nicely in general and yeah",
    "start": "197139",
    "end": "204250"
  },
  {
    "text": "modern car might look like that with all these different units floating around inside of it and they can all be on",
    "start": "204250",
    "end": "209590"
  },
  {
    "text": "different can buses and then those buses might be bridged by different ECU's that act as gateways you get like a very",
    "start": "209590",
    "end": "216340"
  },
  {
    "text": "complex network inside every single vehicle the communication types in these",
    "start": "216340",
    "end": "222729"
  },
  {
    "start": "221000",
    "end": "417000"
  },
  {
    "text": "networks there's really two that you can break it down into you have the operational communications and this is",
    "start": "222729",
    "end": "228579"
  },
  {
    "text": "what's happening usually the second you open the door or like hit the unlock button on your fob or even on modern",
    "start": "228579",
    "end": "235329"
  },
  {
    "text": "vehicles when you actually approach the car it might start and what's happening",
    "start": "235329",
    "end": "240340"
  },
  {
    "text": "here is this is just communications between all these controllers that they all know about what's going on what the",
    "start": "240340",
    "end": "245709"
  },
  {
    "text": "state is sensor values commands to lock and unlock things things of that nature",
    "start": "245709",
    "end": "253090"
  },
  {
    "text": "and this is all happening to run periodic broadcast messages so a message",
    "start": "253090",
    "end": "260199"
  },
  {
    "text": "might be a 10 millisecond broadcast every 10 milliseconds that sent out",
    "start": "260199",
    "end": "265380"
  },
  {
    "text": "and everyone on the bus can look at it and decide whether they want to actually use that data and they're all statically",
    "start": "265380",
    "end": "271980"
  },
  {
    "text": "defined so in one message like byte six will always be the same thing one",
    "start": "271980",
    "end": "278190"
  },
  {
    "text": "example when you start the car you might take the key turn it from off to accessory and one byte might change from",
    "start": "278190",
    "end": "285030"
  },
  {
    "text": "zero to one and then whenever you go to run from accessory that might be one to two then switch to cranked and now it's",
    "start": "285030",
    "end": "292650"
  },
  {
    "text": "switching from two to three and that's the scheme that at least one company uses to encode that data but that can",
    "start": "292650",
    "end": "299430"
  },
  {
    "text": "vary because there's tons of sensors and inputs going on so there's you know a lot of this happening that's the",
    "start": "299430",
    "end": "304800"
  },
  {
    "text": "operational stuff Diagnostics this is used at specific times and not normally",
    "start": "304800",
    "end": "310620"
  },
  {
    "text": "this only happens whenever you are intending it to happen and it allows very special interactions with these",
    "start": "310620",
    "end": "317040"
  },
  {
    "text": "controllers but it acts as a client-server protocol so rather than this periodic broadcast thing you actually have to make a",
    "start": "317040",
    "end": "323400"
  },
  {
    "text": "request and then you get a response back so looks more like HTTP or something you",
    "start": "323400",
    "end": "328980"
  },
  {
    "text": "actually ask for data and on the server comes back and says here is your data operational stuff again it's broadcast",
    "start": "328980",
    "end": "335790"
  },
  {
    "text": "but from a security side you know it's really easy to attack we've seen a bunch of this in the past this is one example",
    "start": "335790",
    "end": "342450"
  },
  {
    "text": "from way back in 2010 which I think is the first stuff that was publicly released on this where you'll see",
    "start": "342450",
    "end": "348660"
  },
  {
    "text": "they've got the thing going 140 miles per hour but it's Lee Park so that's",
    "start": "348660",
    "end": "353940"
  },
  {
    "text": "clearly not real what they're doing there is sending fake data on the canvas with the vehicle speed they figured out",
    "start": "353940",
    "end": "360690"
  },
  {
    "text": "what bytes they need to send for that and the dash actually thinks the vehicles going much faster than it actually is they also added some fun",
    "start": "360690",
    "end": "368160"
  },
  {
    "text": "text on the display as well so it's pretty easy to attack because there's not much security on this and it's",
    "start": "368160",
    "end": "374630"
  },
  {
    "text": "extremely easy to do a denial of service on like you just need to send a message with a low ID number say zero really",
    "start": "374630",
    "end": "382380"
  },
  {
    "text": "quickly and based on how the arbitration works on canvas you will just shut the whole thing down and nothing can",
    "start": "382380",
    "end": "388620"
  },
  {
    "text": "communicate and it all freaks out and all your check engine lights come on and then you need to service your vehicle ask me how I know but yeah there's no",
    "start": "388620",
    "end": "396540"
  },
  {
    "text": "persistence with this attack you have to plug something in and then send a frame and then you know this happens but once you unplug that device",
    "start": "396540",
    "end": "404340"
  },
  {
    "text": "you know it's done it can't have any more fun so you can either like implant",
    "start": "404340",
    "end": "410220"
  },
  {
    "text": "a device in there to do this or you could maybe take over an existing controller in the vehicle that's why we",
    "start": "410220",
    "end": "417690"
  },
  {
    "start": "417000",
    "end": "503000"
  },
  {
    "text": "get two Diagnostics diagnostics is used mostly for this part of the life cycle so manufacturing when",
    "start": "417690",
    "end": "424470"
  },
  {
    "text": "the vehicle is actually set up it might be used update and program firmware or to set up other features can be used for",
    "start": "424470",
    "end": "430530"
  },
  {
    "text": "servicing to readout fault codes and to run test routines can be used for end-of-life so probably the best example",
    "start": "430530",
    "end": "437250"
  },
  {
    "text": "of this is there's a whole standard on end-of-life deployment of airbags you actually use Diagnostics to tell the car",
    "start": "437250",
    "end": "443610"
  },
  {
    "text": "to blow its airbags so that you can dispose of the car airbags are like little rocket engines and you don't want",
    "start": "443610",
    "end": "449850"
  },
  {
    "text": "to crush those because it could be dangerous and for forensics so most vehicles nowaday is actually a black box inside",
    "start": "449850",
    "end": "456210"
  },
  {
    "text": "it's recording data all the time if you crash the car then there will be some data potentially stored in there and you",
    "start": "456210",
    "end": "463110"
  },
  {
    "text": "would access that data via the Diagnostics interfaces so it allows a wide wide range of features a ton of",
    "start": "463110",
    "end": "469380"
  },
  {
    "text": "stuff but it requires specialized tools and typically the way this works you take your specialized tool like the tech",
    "start": "469380",
    "end": "475380"
  },
  {
    "text": "to 4gm you plug that into the OBD port under the dash it has all the connections you need to get on the right",
    "start": "475380",
    "end": "481470"
  },
  {
    "text": "buses and then you start pushing buttons on the tool and the tool knows how to do this communication so you just push the",
    "start": "481470",
    "end": "488580"
  },
  {
    "text": "button for you now reset this to zero this sensor or whatever and it takes",
    "start": "488580",
    "end": "494729"
  },
  {
    "text": "care of the rest and tells you okay or failed and that's it and if you're a technician that's as far as you need to",
    "start": "494729",
    "end": "499979"
  },
  {
    "text": "know you just use the tool and you're good but obviously we're going to go a little further so automotive diagnostics",
    "start": "499979",
    "end": "506610"
  },
  {
    "start": "503000",
    "end": "597000"
  },
  {
    "text": "I think it's a really cool topic because it probably presents the largest attack surface for the in vehicle Network again",
    "start": "506610",
    "end": "513750"
  },
  {
    "text": "there's that operational data you can send that all the time but this is like actual protocols client-server stuff",
    "start": "513750",
    "end": "520500"
  },
  {
    "text": "there's a lot more that can be done here and there are a lot of standards like many many standards I wish we could talk",
    "start": "520500",
    "end": "528450"
  },
  {
    "text": "about all of them that we can't J 1979 is so refer to the obd2 standard and this",
    "start": "528450",
    "end": "535140"
  },
  {
    "text": "is used for mostly emissions purposes as standardized originally as obd by the",
    "start": "535140",
    "end": "540779"
  },
  {
    "text": "California Air Resources Board for the explicit purpose of doing smog testing on vehicles now it's used for a couple",
    "start": "540779",
    "end": "547860"
  },
  {
    "text": "other things you can buy really cheap tools for it J 1850 is a really ancient",
    "start": "547860",
    "end": "553010"
  },
  {
    "text": "protocol used up to about 2006 and some American vehicles ISO 9 141 which is",
    "start": "553010",
    "end": "559860"
  },
  {
    "text": "Kaline or keyword protocol 2000 that's used for still some Diagnostics but less",
    "start": "559860",
    "end": "566100"
  },
  {
    "text": "and less and then there's sort of the big one will focus on which is iso 1 for 2 to 9 for unified diagnostic services",
    "start": "566100",
    "end": "573720"
  },
  {
    "text": "or for short UDS is what I'll refer to it for now from now on and that's basically present in any",
    "start": "573720",
    "end": "580830"
  },
  {
    "text": "vehicle made nowadays that you'll see it's just become the most common and popular way of doing Diagnostics and",
    "start": "580830",
    "end": "587040"
  },
  {
    "text": "there's many more like there's a whole standard just for like the size and shape of the connectors and things like",
    "start": "587040",
    "end": "592200"
  },
  {
    "text": "that automotive industry loves its standards but they don't always like following them exactly speaking of",
    "start": "592200",
    "end": "599580"
  },
  {
    "start": "597000",
    "end": "632000"
  },
  {
    "text": "standards the OSI model is just a useful reference tool I'm going to be using as we build up these picture of this so",
    "start": "599580",
    "end": "606770"
  },
  {
    "text": "many of you have probably seen this general idea the very bottom we have the actual physical stuff that's happening",
    "start": "606770",
    "end": "613680"
  },
  {
    "text": "on a wire on a piece of glass you know ones and zeros and then this works up through a number of things to get us to",
    "start": "613680",
    "end": "620700"
  },
  {
    "text": "an actual application protocol think HTTP or FTP where you know as a programmer you're actually interacting",
    "start": "620700",
    "end": "626760"
  },
  {
    "text": "with that more to build an application and we're going to kind of put all the pieces in to figure out how this works",
    "start": "626760",
    "end": "632400"
  },
  {
    "start": "632000",
    "end": "730000"
  },
  {
    "text": "the very bottom we have can and I explained this sort of briefly before but basic idea of can you bunch of",
    "start": "632400",
    "end": "640500"
  },
  {
    "text": "controllers these are your ECU's each one of the node on the network then you have a bus and so you have a collection",
    "start": "640500",
    "end": "646350"
  },
  {
    "text": "of these controllers and they're all just connected to the same wires this is not a star network this is not a switch",
    "start": "646350",
    "end": "653790"
  },
  {
    "text": "network even it is literally imagine two wires and then you have ECU's just",
    "start": "653790",
    "end": "658860"
  },
  {
    "text": "connected 2 ohm as they go through it's really cheap to do this this way you don't need to run a bunch of cable you",
    "start": "658860",
    "end": "664620"
  },
  {
    "text": "can design nice wiring harnesses but obviously it leads to some of the security problems we were discussing",
    "start": "664620",
    "end": "670350"
  },
  {
    "text": "before like denial of services a frame is the protocol data unit we're interested in has an ID a type a data",
    "start": "670350",
    "end": "679140"
  },
  {
    "text": "length code and some data we really only care about the ID and the data for today so the ID is a number for standard can",
    "start": "679140",
    "end": "686820"
  },
  {
    "text": "frames just between 0 and 7f hex and that tells us what this frame means then",
    "start": "686820",
    "end": "694290"
  },
  {
    "text": "you have the data which is just up to 8 bytes of data in this case some dead",
    "start": "694290",
    "end": "699510"
  },
  {
    "text": "beefs and that's your actual payload there was a problem with this",
    "start": "699510",
    "end": "704550"
  },
  {
    "text": "you only have a byte and if you've ever tried to update firmware eight bytes at a time you know that's not a good idea",
    "start": "704550",
    "end": "710580"
  },
  {
    "text": "will be very slow so we'll have to fix that but we'll get there can actually",
    "start": "710580",
    "end": "716700"
  },
  {
    "text": "takes up just the bottom of the stack so it's dealing with the ones and zeros the symbols on the actual plus and it also",
    "start": "716700",
    "end": "721920"
  },
  {
    "text": "deals with the dressing and arbitration so you know chunk that in at the bottom can it's got an ISO number if you want",
    "start": "721920",
    "end": "727920"
  },
  {
    "text": "to actually read the whole standard but then we get to ISO TP which is what this",
    "start": "727920",
    "end": "734040"
  },
  {
    "start": "730000",
    "end": "799000"
  },
  {
    "text": "is usually called it's got a few different names and here's the problem how do we encode a 17 character VIN if",
    "start": "734040",
    "end": "739740"
  },
  {
    "text": "we only have 8 bytes you can't and how do you send firmware like several K of",
    "start": "739740",
    "end": "746010"
  },
  {
    "text": "firmware or even Meg's of firmware well that's even worse so we need to combine these frames into a longer the longer",
    "start": "746010",
    "end": "753150"
  },
  {
    "text": "thing and this is what is OTP does it allows up to 4095 bytes at a time so you",
    "start": "753150",
    "end": "761070"
  },
  {
    "text": "can send a single request of up to 4,000 95 bytes you will get back a response up to 4,000 95 bytes and it also the flow",
    "start": "761070",
    "end": "769350"
  },
  {
    "text": "control mechanism built-in this allows you to do things like request only",
    "start": "769350",
    "end": "774510"
  },
  {
    "text": "certain size of the blocks or request a separation time of a certain amount which is nice if you have limited memory",
    "start": "774510",
    "end": "780120"
  },
  {
    "text": "or limited processing power and automotive controllers almost always have limited memory limited processing",
    "start": "780120",
    "end": "786209"
  },
  {
    "text": "powers that's handy it's also called 10 TP sometimes it's iso 15 765 if you care",
    "start": "786209",
    "end": "792959"
  },
  {
    "text": "about the standard numbers but you see I just use to go from frames to blocks that are up to four thousand ninety five",
    "start": "792959",
    "end": "798570"
  },
  {
    "text": "bytes so we can sit our model on top of can and then we get",
    "start": "798570",
    "end": "804070"
  },
  {
    "start": "799000",
    "end": "809000"
  },
  {
    "text": "to the applet up to the application layer and there's a few different things that can happen here but we'll look at",
    "start": "804070",
    "end": "809920"
  },
  {
    "start": "809000",
    "end": "888000"
  },
  {
    "text": "two obd2 is present in basically every vehicle made since 1996 definitely any",
    "start": "809920",
    "end": "817300"
  },
  {
    "text": "vehicles in specially 96 that sold in the US and there's actually three different protocols the physical",
    "start": "817300",
    "end": "823330"
  },
  {
    "text": "protocols you can do obd over i'm only going to talk about the can one today because we don't have time but the way",
    "start": "823330",
    "end": "829630"
  },
  {
    "text": "that this works is you can read some parameters these are called pigs or parameter ids this is things like you",
    "start": "829630",
    "end": "837250"
  },
  {
    "text": "know vehicle speed engine RPM o to sensor temperature so on and so forth",
    "start": "837250",
    "end": "843210"
  },
  {
    "text": "these are mostly meant for the purposes of doing smog testing remember so the",
    "start": "843210",
    "end": "849040"
  },
  {
    "text": "data you get is a little bit limited it was mostly meant for that purpose you can also clear some codes using this",
    "start": "849040",
    "end": "855460"
  },
  {
    "text": "which is handy if your check engine light goes on you can turn it up and you get a full list of pigs honestly",
    "start": "855460",
    "end": "861940"
  },
  {
    "text": "wikipedia has the greatest resource for this you get every single one and all the modes it's all there",
    "start": "861940",
    "end": "867850"
  },
  {
    "text": "and if you want to do this on the cheap you buy one of these cheapo bluetooth dongles with a fixed password of one two",
    "start": "867850",
    "end": "874000"
  },
  {
    "text": "three four as we talk more about the things that you can do over the exact same port you will understand why you",
    "start": "874000",
    "end": "880690"
  },
  {
    "text": "probably don't want to leave that plugged into your car because yeah you want to trust whoever's connected to",
    "start": "880690",
    "end": "887080"
  },
  {
    "text": "that device but the basic way obd2 works you have a session looks like this you",
    "start": "887080",
    "end": "892900"
  },
  {
    "start": "888000",
    "end": "947000"
  },
  {
    "text": "make a request you send some bytes you send a mode byte which is what actual",
    "start": "892900",
    "end": "899010"
  },
  {
    "text": "part of the standard you want to use there's you know request a pin",
    "start": "899010",
    "end": "904330"
  },
  {
    "text": "there's request an extended pid' there's another set of them there's a clear fault codes one there's also one to",
    "start": "904330",
    "end": "910540"
  },
  {
    "text": "request trouble codes so you can actually cross problems you'll get back a response it's the mode + o x40 to tell",
    "start": "910540",
    "end": "916720"
  },
  {
    "text": "you this response you get the pig that you requested which is just an echo and then you get your data and that's about",
    "start": "916720",
    "end": "923470"
  },
  {
    "text": "it so you look at that big list you see all the things you can request you can get some data to your car it's not that",
    "start": "923470",
    "end": "929740"
  },
  {
    "text": "exciting for a security person though because all of this is just giving some data and the only real action you",
    "start": "929740",
    "end": "936079"
  },
  {
    "text": "can take is clear fault codes there is a feature in there actually that lets you run like test routines but I've never",
    "start": "936079",
    "end": "942769"
  },
  {
    "text": "seen anyone implemented so not that excited so let's get to the exciting one",
    "start": "942769",
    "end": "947980"
  },
  {
    "start": "947000",
    "end": "1098000"
  },
  {
    "text": "unified diagnostic services which is also called UDS this is the",
    "start": "947980",
    "end": "953300"
  },
  {
    "text": "client-server protocol that's used for Diagnostics in basically all cars today the client in this case is a scan tool",
    "start": "953300",
    "end": "960620"
  },
  {
    "text": "which by that I mean the thing you are plugging into the ovd port and the",
    "start": "960620",
    "end": "965689"
  },
  {
    "text": "server in this case is the ECU which is the actual controller in the vehicle it",
    "start": "965689",
    "end": "970699"
  },
  {
    "text": "defines four functional units containing a total of 25 services and we will go through them and kind of just highlight",
    "start": "970699",
    "end": "977149"
  },
  {
    "text": "the fun ones and it's also available from the ISO folks as a PDF you do have",
    "start": "977149",
    "end": "982430"
  },
  {
    "text": "to shell out 198 Swiss francs for a PDF document which kind of sucks but the",
    "start": "982430",
    "end": "988069"
  },
  {
    "text": "worst part of that is that you just get a PDF and you can't execute this PDF it doesn't really do anything for you other",
    "start": "988069",
    "end": "994639"
  },
  {
    "text": "than tell you the standard so kind of stuck and this is a problem that you see",
    "start": "994639",
    "end": "1001029"
  },
  {
    "text": "in you've seen in the automotive industry a lot which is if you're on tools that make it easy to like do this",
    "start": "1001029",
    "end": "1006880"
  },
  {
    "text": "no one really takes a look at it and then a lot of the security is just obscurity it's just no one's going to",
    "start": "1006880",
    "end": "1012850"
  },
  {
    "text": "look there so we don't do do a great job of security or just never even came up in a meeting you know no one ever",
    "start": "1012850",
    "end": "1018310"
  },
  {
    "text": "thought that it was a big deal so as we are able to release more tools and open source some of this stuff on one hand it",
    "start": "1018310",
    "end": "1024428"
  },
  {
    "text": "means that more people can just do the diagnostic functions that are useful but on the other it means that security",
    "start": "1024429",
    "end": "1030699"
  },
  {
    "text": "folks like yourselves can actually start playing with these systems and adding them in kind of more detailed way so",
    "start": "1030699",
    "end": "1037538"
  },
  {
    "text": "that's kind of my goal is to free this information I can't just publish the PDF which is why I wrote an implementation",
    "start": "1037539",
    "end": "1043900"
  },
  {
    "text": "so a UDF session looks a lot like an O VD session the only difference is instead of a mode we called a service ID",
    "start": "1043900",
    "end": "1050740"
  },
  {
    "text": "this is one of the 25 services and then depending on what service each one has its own parameters this again depends on",
    "start": "1050740",
    "end": "1058240"
  },
  {
    "text": "which service it is they can be variable length you have to look at the PDF to get that information the response that",
    "start": "1058240",
    "end": "1064000"
  },
  {
    "text": "comes back is your service ID plus 40 and then the response parameters which again depend on exactly what",
    "start": "1064000",
    "end": "1070149"
  },
  {
    "text": "service it is and you know how to decode that based on the standard it's again pretty simple to do the hardest part is",
    "start": "1070149",
    "end": "1076809"
  },
  {
    "text": "actually knowing what these parameters are and the only other thing that can happen here actually is you can get a",
    "start": "1076809",
    "end": "1082090"
  },
  {
    "text": "negative response so if the controller decides it doesn't like you you know you requested something it can't do or you",
    "start": "1082090",
    "end": "1088179"
  },
  {
    "text": "don't have the right security mount or whatever it is it will come back and say negative response go away so that's",
    "start": "1088179",
    "end": "1094480"
  },
  {
    "text": "that's UDS you know you send a request to get a response pretty simple and that's it's again at the top we have",
    "start": "1094480",
    "end": "1100690"
  },
  {
    "text": "obd2 or unified diagnostic services at the top of the picture is OTP which lets",
    "start": "1100690",
    "end": "1106659"
  },
  {
    "text": "us chain frames and the blocks and at the bottom we have the actual frames that are the physical representation on",
    "start": "1106659",
    "end": "1112059"
  },
  {
    "text": "the bus so there's all of our pieces but now we're going to dive into UDS because",
    "start": "1112059",
    "end": "1117429"
  },
  {
    "text": "I said it has 25 services it's important to actually take a look at what they are this is the first functional unit and I",
    "start": "1117429",
    "end": "1125559"
  },
  {
    "text": "am going to try to make this as exciting as possible while having a big list on the screen basically I'm going to go",
    "start": "1125559",
    "end": "1132669"
  },
  {
    "text": "through why these are actually interesting to security folks will start with diagnostic session control this one",
    "start": "1132669",
    "end": "1139090"
  },
  {
    "text": "is really just a prerequisite for many things so often you'll have to move a controller into a diagnostic session or",
    "start": "1139090",
    "end": "1146289"
  },
  {
    "text": "a programming session or something like that which just puts it in a special mode where it might disable certain features because it knows you're going",
    "start": "1146289",
    "end": "1152889"
  },
  {
    "text": "to perform Diagnostics it's also used sometimes to access the bootloader when you're programming ECU reset lets you",
    "start": "1152889",
    "end": "1159580"
  },
  {
    "text": "reset the ECU pretty simple there are a few types of this you can do a hard reset or soft reset it's kind of fun to",
    "start": "1159580",
    "end": "1166119"
  },
  {
    "text": "do this well like things are running you know what you're doing because you can make lots of lights blink and stuff",
    "start": "1166119",
    "end": "1171600"
  },
  {
    "text": "security access is really the security feature that's used to secure all this it deserves its own discussion which it",
    "start": "1171600",
    "end": "1178269"
  },
  {
    "text": "will get momentarily we'll skip over that for now communication control allows you to enable and disable",
    "start": "1178269",
    "end": "1183309"
  },
  {
    "text": "communication from an ECU this is useful if you're actually an OEM who's",
    "start": "1183309",
    "end": "1188889"
  },
  {
    "text": "designing the tool because you want to update firmware on a canvas you want to have as much bandwidth as possible to do",
    "start": "1188889",
    "end": "1194379"
  },
  {
    "text": "the update as fast as you possibly can this means you don't want anyone else talking while you're trying to do your firmware update so you can tell let's",
    "start": "1194379",
    "end": "1201770"
  },
  {
    "text": "everyone else in the bus please be quiet I am about to do a firmware update and that operational data will go away now",
    "start": "1201770",
    "end": "1209380"
  },
  {
    "text": "this is potentially useful to an attacker because if you can make that operational data stop from one",
    "start": "1209380",
    "end": "1215000"
  },
  {
    "text": "controller you can inject your own frames you can do this anyway like in the demo we showed before by you know",
    "start": "1215000",
    "end": "1221180"
  },
  {
    "text": "really spamming frames onto the bus but sometimes you'll end up with issues where you know you won't quite overrun",
    "start": "1221180",
    "end": "1227450"
  },
  {
    "text": "the buffer correctly or whatever and you'll get blips where it will receive a valid frame and it will you know reset a",
    "start": "1227450",
    "end": "1233030"
  },
  {
    "text": "state doing this you're actually able to make a controller completely stop talking it also gets around problems",
    "start": "1233030",
    "end": "1239030"
  },
  {
    "text": "like a sequential counter in the can frame where you can't easily inject so",
    "start": "1239030",
    "end": "1244550"
  },
  {
    "text": "communication control is kind of interesting for that tester present just tells you you have a tester there and",
    "start": "1244550",
    "end": "1249590"
  },
  {
    "text": "stops it from timing out access timing parameter is used for some timing settings but honestly I've never really",
    "start": "1249590",
    "end": "1255170"
  },
  {
    "text": "needed to deal with secure data transmission I've never seen anyone use this but it's a kind of nice idea",
    "start": "1255170",
    "end": "1261560"
  },
  {
    "text": "basically it just is its own service and it's like if you want to implement your own secure transfer you can do that this",
    "start": "1261560",
    "end": "1270110"
  },
  {
    "text": "is just a way to transmit a whole block at once and it just doesn't frame anything at all",
    "start": "1270110",
    "end": "1275590"
  },
  {
    "text": "control DPC settings lets you enable and disable whether a ECU is going to set",
    "start": "1275590",
    "end": "1281990"
  },
  {
    "text": "trouble codes this is interesting it's useful whenever you're doing testing",
    "start": "1281990",
    "end": "1287510"
  },
  {
    "text": "where you're going to say do that firmware update you're going to make all the controller stop talking that's going to set a bunch of fault codes because",
    "start": "1287510",
    "end": "1293660"
  },
  {
    "text": "those controllers are expecting those messages so what this does is it says okay don't worry there's no problems right",
    "start": "1293660",
    "end": "1300350"
  },
  {
    "text": "now we're just doing a firmware update don't expect I mean any failures could be interesting though if you're doing an",
    "start": "1300350",
    "end": "1305690"
  },
  {
    "text": "emissions test and you don't want any failure codes to come up because you can just disable them being set and the",
    "start": "1305690",
    "end": "1311300"
  },
  {
    "text": "check engine light won't come on till the car is actually reset response on",
    "start": "1311300",
    "end": "1316340"
  },
  {
    "text": "event this is something allows you to set up some special events and then when they occur get a response back it's not",
    "start": "1316340",
    "end": "1323000"
  },
  {
    "text": "I've never seen it used in practice in a tools I've used and link control lets",
    "start": "1323000",
    "end": "1328970"
  },
  {
    "text": "you change the baud rate and that's kind of not interesting unless you want to do",
    "start": "1328970",
    "end": "1334610"
  },
  {
    "text": "a denial of service attack and potentially you can change the bit rate that something's came to getting on and crash the whole bus but that's just",
    "start": "1334610",
    "end": "1341480"
  },
  {
    "text": "sort of fun this is all just the stuff that makes diagnostic worse it's like the foundation of being able to set up",
    "start": "1341480",
    "end": "1347360"
  },
  {
    "text": "your sessions and do that sort of thing the next parts are actually the more useful bits and read data by identifiers",
    "start": "1347360",
    "end": "1355250"
  },
  {
    "start": "1352000",
    "end": "1512000"
  },
  {
    "text": "and write data by identifiers if there's two services you should be interested in those are probably them there's a",
    "start": "1355250",
    "end": "1360860"
  },
  {
    "text": "database of these data identifiers in the vehicle are in the ECU and they all",
    "start": "1360860",
    "end": "1366889"
  },
  {
    "text": "just have a number that's assigned to them and that has a usually a specific",
    "start": "1366889",
    "end": "1372259"
  },
  {
    "text": "representation based on either the OEM that made the car or the whoever made",
    "start": "1372259",
    "end": "1377629"
  },
  {
    "text": "that actual controller in some cases can define them and what those are contain",
    "start": "1377629",
    "end": "1382850"
  },
  {
    "text": "is just some arbitrary data you don't really know what's in them but you can read and write them and if you use a",
    "start": "1382850",
    "end": "1389330"
  },
  {
    "text": "real diagnostic tool to let's say you know read the odometer out of a car it",
    "start": "1389330",
    "end": "1395509"
  },
  {
    "text": "will do a read data by identifier for that data identifier and we'll pull the data out and decode it show it to you so",
    "start": "1395509",
    "end": "1401629"
  },
  {
    "text": "what's nice about this is if you can figure out how these tools work you can do your own implementation to mimic that",
    "start": "1401629",
    "end": "1407809"
  },
  {
    "text": "functionality and do it yourself right dative identifier is even more cool",
    "start": "1407809",
    "end": "1413480"
  },
  {
    "text": "because it lets you change things things like VIN numbers and odometer values this is usually secured for good reason",
    "start": "1413480",
    "end": "1421129"
  },
  {
    "text": "but it is there and often the way that parameters and calibrations get changed",
    "start": "1421129",
    "end": "1427240"
  },
  {
    "text": "there's also read and write memory by address and yeah that should just sound",
    "start": "1427240",
    "end": "1432799"
  },
  {
    "text": "concerning immediately because being able to access arbitrary memory addresses is is not going to be very",
    "start": "1432799",
    "end": "1439009"
  },
  {
    "text": "safe this is hopefully not enabled in production I have seen at least read",
    "start": "1439009",
    "end": "1444049"
  },
  {
    "text": "memory buy address enabled on controllers I am a little scared to try writing all sorts of memory by address",
    "start": "1444049",
    "end": "1450769"
  },
  {
    "text": "because you see if the service is enabled but you know you can cause some really bad things to happen if you just",
    "start": "1450769",
    "end": "1456259"
  },
  {
    "text": "over write ran the memory in your airbag controller you might blow the airbags that is a thing that could happen so",
    "start": "1456259",
    "end": "1463179"
  },
  {
    "text": "those ones are scary and hopefully aren't enabled read a scaling date of",
    "start": "1463179",
    "end": "1468500"
  },
  {
    "text": "identifiers just gives you some information about how these data identifiers are converted to engineering",
    "start": "1468500",
    "end": "1473690"
  },
  {
    "text": "units and read data by periodic identifiers let's you say please send me some data on some some periods so you",
    "start": "1473690",
    "end": "1481070"
  },
  {
    "text": "can say I want this you know every 10 seconds give me the current value of vehicle speed we'll send it back last",
    "start": "1481070",
    "end": "1488060"
  },
  {
    "text": "one there is dynamically defined data identifier there's a lot of these that one allows you to actually set up your",
    "start": "1488060",
    "end": "1493550"
  },
  {
    "text": "own special data identifiers and give it like a memory address range that you want it to read which is potentially you",
    "start": "1493550",
    "end": "1499160"
  },
  {
    "text": "know they if they've disabled read memory by address but haven't disabled that one that's potentially a way to get",
    "start": "1499160",
    "end": "1504950"
  },
  {
    "text": "in so these are quite interesting because you get access to a bunch of parameters both reading and writing for",
    "start": "1504950",
    "end": "1513560"
  },
  {
    "start": "1512000",
    "end": "1577000"
  },
  {
    "text": "data trouble codes this is useful if you're trying to fix a vehicle you get the stored data functional unit or and",
    "start": "1513560",
    "end": "1518900"
  },
  {
    "text": "what this does is clears fault codes and reads fault codes obd can do this as",
    "start": "1518900",
    "end": "1524180"
  },
  {
    "text": "well this is a bit more detailed in the fault codes you get out of it so you do",
    "start": "1524180",
    "end": "1529850"
  },
  {
    "text": "need to know a bit about the system to actually know what these mean but you can read and clear them if you're fixing",
    "start": "1529850",
    "end": "1535310"
  },
  {
    "text": "your car it's interesting if you're trying to hack a car maybe less so we",
    "start": "1535310",
    "end": "1540470"
  },
  {
    "text": "have input output control functional unit this one really should be disabled in production it just allows you",
    "start": "1540470",
    "end": "1547610"
  },
  {
    "text": "arbitrary control over pins of the device so you can actually say you know",
    "start": "1547610",
    "end": "1552800"
  },
  {
    "text": "I want pin six to go high now and it will let you do that very useful when",
    "start": "1552800",
    "end": "1558320"
  },
  {
    "text": "you're trying to test it of ice but a little scary whenever you're actually trying to you know use it you wouldn't",
    "start": "1558320",
    "end": "1564710"
  },
  {
    "text": "want someone to arbitrarily be able to just change the GPIO levels on a engine controller or an airbag unit or anything",
    "start": "1564710",
    "end": "1571190"
  },
  {
    "text": "that would be not good so this this should be disabled but it's at least something to look for and scan for",
    "start": "1571190",
    "end": "1577420"
  },
  {
    "text": "routine control is another very interesting one it gets its own one functional unit remote activation of",
    "start": "1577420",
    "end": "1582590"
  },
  {
    "text": "routine and this just lets you run arbitrary routines you know there's a 16",
    "start": "1582590",
    "end": "1588260"
  },
  {
    "text": "bit routine identifier you pick a number and you say go and it does something and",
    "start": "1588260",
    "end": "1594220"
  },
  {
    "text": "it's used for example one place if it's used a lot as in programming ECU's",
    "start": "1594220",
    "end": "1599990"
  },
  {
    "text": "there's a routine a standard routine for erasing flash so this will erase the",
    "start": "1599990",
    "end": "1605260"
  },
  {
    "text": "flash memory I was talking about bricking cars earlier if you do that you will end up probably with a you know",
    "start": "1605260",
    "end": "1611950"
  },
  {
    "text": "engine controller or whatever that doesn't work it usually uses secured function so you are less likely to do it",
    "start": "1611950",
    "end": "1617890"
  },
  {
    "text": "by accident but you know if you just run a bunch of routines that could happen the other place that this is used is in",
    "start": "1617890",
    "end": "1623500"
  },
  {
    "text": "servicing and testing probably one of the best-known examples if you remember back in 2015 there was the car hacking",
    "start": "1623500",
    "end": "1631570"
  },
  {
    "text": "thing that they were able to totally take over the vehicle and then they also did things like apply brakes",
    "start": "1631570",
    "end": "1637360"
  },
  {
    "text": "I believe the applying brakes work that was a actual attack that's done by",
    "start": "1637360",
    "end": "1643140"
  },
  {
    "text": "Miller and valasek that was done via using a routine control the reason for",
    "start": "1643140",
    "end": "1649929"
  },
  {
    "text": "this is if you're a mechanic and you need to believe the brakes on a car don't know if anyone here has done that but you have to get your buddy to sit in",
    "start": "1649929",
    "end": "1657760"
  },
  {
    "text": "the driver's seat and push on the brake pedal while you turn the little you know things on the brake caliper and should",
    "start": "1657760",
    "end": "1664390"
  },
  {
    "text": "shoots out fluid and air and then do that till they're somewhere in the system so there's actually a routine you",
    "start": "1664390",
    "end": "1669580"
  },
  {
    "text": "can run that just applies brake pressure for you and that way you don't need your buddy to sit in the car the only problem",
    "start": "1669580",
    "end": "1675220"
  },
  {
    "text": "with that is if you activate that on the road then applies the brakes and that could be a problem there's usually",
    "start": "1675220",
    "end": "1681160"
  },
  {
    "text": "restrictions on when these can be activated and things like that but then you can get around those by forging data",
    "start": "1681160",
    "end": "1686530"
  },
  {
    "text": "so these are really concerning if you have access to a vehicle's network routines are probably your best way to",
    "start": "1686530",
    "end": "1692500"
  },
  {
    "text": "just cause bad things to happen and again there's a ton of these some of",
    "start": "1692500",
    "end": "1697840"
  },
  {
    "text": "them are defined by the OEM some will be defined by the pure supplier and I've",
    "start": "1697840",
    "end": "1703179"
  },
  {
    "text": "seen some cases where there's some that no one really knows what they do and that's a real problem with this",
    "start": "1703179",
    "end": "1708520"
  },
  {
    "text": "diagnostic stuff is things can get left into firmware the last one we're almost",
    "start": "1708520",
    "end": "1713799"
  },
  {
    "start": "1712000",
    "end": "1757000"
  },
  {
    "text": "on big lists is the upload download functional unit and this is just how you write firmware or read firmware you",
    "start": "1713799",
    "end": "1720340"
  },
  {
    "text": "request a download or an upload depending on if you're reading or writing you use this transfer data service to just shoot blocks of data",
    "start": "1720340",
    "end": "1726610"
  },
  {
    "text": "into the controller and then once you're done you request a transfer exit usually the actual update process is a bit more",
    "start": "1726610",
    "end": "1733120"
  },
  {
    "text": "involved you have to change States and we're buuut to get to the bootloader and then you do this transfer data thing transfer",
    "start": "1733120",
    "end": "1740059"
  },
  {
    "text": "some data over you might have to read back some verification and like write something to say you updated the version",
    "start": "1740059",
    "end": "1745669"
  },
  {
    "text": "you know it's a little bit more involved you're less likely to be able to guess the exact process but if you have an",
    "start": "1745669",
    "end": "1751789"
  },
  {
    "text": "official tool that can do a firmware update you can reverse engineer the process pretty easily so let's talk",
    "start": "1751789",
    "end": "1758330"
  },
  {
    "start": "1757000",
    "end": "1864000"
  },
  {
    "text": "about security access because this is a security conference after all and that's the only service with the words of JP in",
    "start": "1758330",
    "end": "1763880"
  },
  {
    "text": "it and it's what's used to secure anything that could be bad and this",
    "start": "1763880",
    "end": "1769940"
  },
  {
    "text": "comes from a standard that's existed for quite a while so what they want to do is make sure that a random person couldn't",
    "start": "1769940",
    "end": "1775820"
  },
  {
    "text": "plug in and just be able to run these services it's a challenge response",
    "start": "1775820",
    "end": "1781159"
  },
  {
    "text": "mechanism with some weird terminology so the way it works you request a feed from",
    "start": "1781159",
    "end": "1787039"
  },
  {
    "text": "the ECU and this is meant to be a random number or not just something random it",
    "start": "1787039",
    "end": "1792590"
  },
  {
    "text": "responds with that random number you then send a key and this is the one place we're like that is not the right",
    "start": "1792590",
    "end": "1799429"
  },
  {
    "text": "word that should be a response that you gets called a key you send the key back",
    "start": "1799429",
    "end": "1805820"
  },
  {
    "text": "and then what the ECU will do is compare the thing you sent it with what it calculated based on the random number",
    "start": "1805820",
    "end": "1812149"
  },
  {
    "text": "and some magical algorithm and then if it was good you set the right thing it",
    "start": "1812149",
    "end": "1817850"
  },
  {
    "text": "will say cool LM unlock now if it was bad it will give you a negative response saying you've got the key wrong try",
    "start": "1817850",
    "end": "1823549"
  },
  {
    "text": "again and that's exactly really how all this ends up working it's just you know",
    "start": "1823549",
    "end": "1829850"
  },
  {
    "text": "request response unlock done once it's unlocked it stays unlocked until you",
    "start": "1829850",
    "end": "1835220"
  },
  {
    "text": "typically until you reset it so you can use a tool that can unlock this and then",
    "start": "1835220",
    "end": "1840230"
  },
  {
    "text": "unplug it halfway through it doing it thing and the ECU stays unlocked also",
    "start": "1840230",
    "end": "1845450"
  },
  {
    "text": "there's no like integrity for anything you're sending back and forth during this session they may have implemented",
    "start": "1845450",
    "end": "1851570"
  },
  {
    "text": "that somewhere along the line maybe the firmware is signed and their bootloader check so signature but the actual",
    "start": "1851570",
    "end": "1858200"
  },
  {
    "text": "protocol doesn't implement anything like that so you know once it's unlocked you're in so there's a few issues with",
    "start": "1858200",
    "end": "1864530"
  },
  {
    "text": "this the confusing terminology is one that I think the led to some problems a challenge",
    "start": "1864530",
    "end": "1870729"
  },
  {
    "text": "response right the actual secret sauce that you do on the challenge to make the",
    "start": "1870729",
    "end": "1876429"
  },
  {
    "text": "response that they call the algorithm you know we've normally tell the",
    "start": "1876429",
    "end": "1882249"
  },
  {
    "text": "algorithm something like a es let's say or something like RSA would be the algorithm and then we use a key as the",
    "start": "1882249",
    "end": "1889359"
  },
  {
    "text": "secret bit to put into the algorithm to actually make that happen in a way that you know is secret but they decided to",
    "start": "1889359",
    "end": "1896440"
  },
  {
    "text": "make the algorithm the secret part and this is kind of textbook security by obscurity stuff so the terminology might",
    "start": "1896440",
    "end": "1904269"
  },
  {
    "text": "have been one thing that led to some bad algorithms there's other challenges there but the algorithms are typically",
    "start": "1904269",
    "end": "1909459"
  },
  {
    "text": "bad we'll get into a couple of them in a moment but they're typically very simple so you'll either often have a very",
    "start": "1909459",
    "end": "1916989"
  },
  {
    "text": "simple algorithm that uses a random number or you'll have a static feed so",
    "start": "1916989",
    "end": "1922119"
  },
  {
    "text": "this is an ECU that just always sends you the same random number it is a",
    "start": "1922119",
    "end": "1927579"
  },
  {
    "text": "random number in the sense that every ECU will send a different one so if you",
    "start": "1927579",
    "end": "1932649"
  },
  {
    "text": "have you know 100 cars all those engine controllers and those hundred cars will send a different number but if you take",
    "start": "1932649",
    "end": "1939969"
  },
  {
    "text": "one car it's always the same number this is a problem for two reasons well the",
    "start": "1939969",
    "end": "1946119"
  },
  {
    "text": "real problem is you can brute force it like pretty quickly this was done again back in 2010 they showed you could brute",
    "start": "1946119",
    "end": "1951369"
  },
  {
    "text": "force this in a matter of days and once you have it you have it you're in the",
    "start": "1951369",
    "end": "1957209"
  },
  {
    "text": "next one would be a small key space usually this is 16 bits 2 bytes that's a",
    "start": "1957209",
    "end": "1963729"
  },
  {
    "text": "small key space there's probably a reason which it got to that and go to",
    "start": "1963729",
    "end": "1968769"
  },
  {
    "text": "there but there's two problems of key space one is you can brute force it really quickly obviously the second one",
    "start": "1968769",
    "end": "1974440"
  },
  {
    "text": "is if you have a valid tool that can generate the key response you can",
    "start": "1974440",
    "end": "1980919"
  },
  {
    "text": "actually brute force the entire key space out of that tool so what you do is you pretend to be a car you plug this",
    "start": "1980919",
    "end": "1988419"
  },
  {
    "text": "tool in and you say alright give me the response for seed zero give me the response for seed 1 and you",
    "start": "1988419",
    "end": "1993549"
  },
  {
    "text": "just go all the way up to ffff a lot of these tools work offline they don't have any connection to back-end so what you",
    "start": "1993549",
    "end": "1999849"
  },
  {
    "text": "end up doing is just creating a map you know sixty-five thousand three hundred sixty-five values to a different",
    "start": "1999849",
    "end": "2005230"
  },
  {
    "text": "set and now you have the whole key space and you're done you're in and that's",
    "start": "2005230",
    "end": "2012160"
  },
  {
    "text": "clearly going to be an issue you know if someone can do that there forever has the algorithm and you have",
    "start": "2012160",
    "end": "2019420"
  },
  {
    "text": "an example of that then there's a lack of privilege separation the spec allows you to have multiple security access",
    "start": "2019420",
    "end": "2025780"
  },
  {
    "text": "levels and the idea here is maybe one is for programming and one is for Diagnostics that a service technician",
    "start": "2025780",
    "end": "2030850"
  },
  {
    "text": "does and one is for end-of-life deployment often the only one that's separate is that end-of-life deployment",
    "start": "2030850",
    "end": "2037240"
  },
  {
    "text": "and that's only because a standard specifies that it has to be a separate level everything else they just use kind",
    "start": "2037240",
    "end": "2042610"
  },
  {
    "text": "of level one and once you're in you get everything that's not necessarily across the board but the general case I've seen",
    "start": "2042610",
    "end": "2049300"
  },
  {
    "text": "is there's only one security access level so no separation of privilege once you have a controller unlocked you can",
    "start": "2049300",
    "end": "2056020"
  },
  {
    "text": "do most of the things I think a lot of these issues actually stem from the standard and this is actually a",
    "start": "2056020",
    "end": "2063220"
  },
  {
    "start": "2057000",
    "end": "2175000"
  },
  {
    "text": "screenshot of the PDF we'll call it fair use if anyone from the ISO is here and",
    "start": "2063220",
    "end": "2069100"
  },
  {
    "text": "you know it's telling you you have a request feed you're requesting oh one you get the function seven Keizo two",
    "start": "2069100",
    "end": "2075220"
  },
  {
    "text": "they give an example with a 2-byte feed and then they give an example calling it",
    "start": "2075220",
    "end": "2080740"
  },
  {
    "text": "the key of the server that comes back and it says it is a two compliments of the seed values so the actual secret",
    "start": "2080740",
    "end": "2085870"
  },
  {
    "text": "part here is just that you take the two's complement that is the top secret",
    "start": "2085870",
    "end": "2091240"
  },
  {
    "text": "T that's just obscurity that's all it is but that has found its way not maybe not",
    "start": "2091240",
    "end": "2097270"
  },
  {
    "text": "that exact algorithm but that kind of thing has found its way into a lot of vehicles and this is really an example",
    "start": "2097270",
    "end": "2102880"
  },
  {
    "text": "of just kind of the spec maybe just giving an example as just a simple here's how it could work and people",
    "start": "2102880",
    "end": "2109090"
  },
  {
    "text": "going out it's implement that this is a real algorithm I have seen on a real ECU",
    "start": "2109090",
    "end": "2114520"
  },
  {
    "text": "that is in probably millions of vehicles I won't say which ones but you get the",
    "start": "2114520",
    "end": "2121030"
  },
  {
    "text": "you know key zero the first byte you just take elects 45 and subtract the",
    "start": "2121030",
    "end": "2126850"
  },
  {
    "text": "seed from seed value from it this wraps so if you get to zero you go back to F F and just you know unsigned subtraction",
    "start": "2126850",
    "end": "2133390"
  },
  {
    "text": "and then G byte one take what radius of practice I can bite that's it and that's how it is for all",
    "start": "2133390",
    "end": "2139390"
  },
  {
    "text": "of those parts around the world there's a lot of different needs to use and a lot of them will modify these numbers",
    "start": "2139390",
    "end": "2145360"
  },
  {
    "text": "which is why I'm not terribly concerned with telling you these specific ones but that's the kind of algorithm it just",
    "start": "2145360",
    "end": "2151120"
  },
  {
    "text": "takes some bytes subtract some numbers and you get the key so yeah there's a",
    "start": "2151120",
    "end": "2157660"
  },
  {
    "text": "lot of issues with security access and there's a lot of features you get the biggest problem here is these are out",
    "start": "2157660",
    "end": "2163720"
  },
  {
    "text": "there there's millions these on the road so those are going away you can't really change this and hopefully we get smarter",
    "start": "2163720",
    "end": "2170440"
  },
  {
    "text": "in the future about how we do the security access thing despite you know challenges that are out there let's talk",
    "start": "2170440",
    "end": "2177070"
  },
  {
    "start": "2175000",
    "end": "2274000"
  },
  {
    "text": "about tools I really like tools some folks are more into releasing exploits I",
    "start": "2177070",
    "end": "2183040"
  },
  {
    "text": "think with automotive there's so much that we haven't touched just because the",
    "start": "2183040",
    "end": "2188290"
  },
  {
    "text": "tools are kind of hard and out of reach that you know it's not really an exploit in some cases it's like you just find a",
    "start": "2188290",
    "end": "2195070"
  },
  {
    "text": "service that's sitting there it's like hacking back in the 90s whenever you would just find broken things lying",
    "start": "2195070",
    "end": "2201340"
  },
  {
    "text": "around nothing we still still see that but the tools for doing this a real scan",
    "start": "2201340",
    "end": "2207580"
  },
  {
    "text": "tool there's two types there's one that cost you a lot of money and has all the manufacturers special codes in it like",
    "start": "2207580",
    "end": "2213820"
  },
  {
    "text": "the GM tech 2 or a snap-on Solus ultra whatever then there's a cheap option",
    "start": "2213820",
    "end": "2220390"
  },
  {
    "text": "these usually only do obd but a lot of them can do UDS if you know what you're",
    "start": "2220390",
    "end": "2227470"
  },
  {
    "text": "doing the elm327 tools for example those just implement is OTP basically with some",
    "start": "2227470",
    "end": "2235510"
  },
  {
    "text": "problems but more or less they're just doing the first can level is OTP if you know what data you need to send to it to",
    "start": "2235510",
    "end": "2242410"
  },
  {
    "text": "do a read data by identifiers it will receive the data back and give it to you the biggest issue running through there",
    "start": "2242410",
    "end": "2249580"
  },
  {
    "text": "is that they have very limited buffers so you'll end up just filling up the buffer and getting crap back also those",
    "start": "2249580",
    "end": "2256330"
  },
  {
    "text": "tools tend to be a pain just with the Bluetooth serial link is not great USB",
    "start": "2256330",
    "end": "2262270"
  },
  {
    "text": "to can adapters these bunch of these out there I made one I presented here a few years ago called cam tack that's open",
    "start": "2262270",
    "end": "2268580"
  },
  {
    "text": "this does can but you still need is ATP's don't need UTS you know how do you get that and this is the tool that I've",
    "start": "2268580",
    "end": "2275900"
  },
  {
    "start": "2274000",
    "end": "2316000"
  },
  {
    "text": "been working on which is pivot it's a Python vehicle interface toolkit because",
    "start": "2275900",
    "end": "2281119"
  },
  {
    "text": "I like acronyms that sound like words and it does can is OTP and now Juliet",
    "start": "2281119",
    "end": "2287480"
  },
  {
    "text": "so this is a Python module that you can use to actually talk to these",
    "start": "2287480",
    "end": "2293599"
  },
  {
    "text": "controllers and you can also use it to do some other things with log files if you don't happen to have a car beside you like I don't right now",
    "start": "2293599",
    "end": "2300740"
  },
  {
    "text": "it's open source it's on github there's a link at the end of this and it's",
    "start": "2300740",
    "end": "2305840"
  },
  {
    "text": "available now and you can have some fun with it so let's do a demo and I'm just going to do some examples and then more",
    "start": "2305840",
    "end": "2312680"
  },
  {
    "text": "of a practical demo so the examples will start off with just doing some stuff and",
    "start": "2312680",
    "end": "2318349"
  },
  {
    "start": "2316000",
    "end": "2415000"
  },
  {
    "text": "ipython so if you are used ipython one of those many Python folks here ipython",
    "start": "2318349",
    "end": "2324530"
  },
  {
    "text": "is a very nice interactive repple for Python got tab-completion makes your",
    "start": "2324530",
    "end": "2330500"
  },
  {
    "text": "life easy once you set up an interface which there's a few lines to actually you know set the thing up and tell us",
    "start": "2330500",
    "end": "2336770"
  },
  {
    "text": "write IDs and the right bit right in a lot junk but once you have this is UDS if' for UDS interface eg DSi f dot",
    "start": "2336770",
    "end": "2344180"
  },
  {
    "text": "request the service in this case we're going to do a read data by identifier and we're going to a request and we want",
    "start": "2344180",
    "end": "2351050"
  },
  {
    "text": "data identify our f-18 C which is the standard one for ECU serial number just",
    "start": "2351050",
    "end": "2356119"
  },
  {
    "text": "happens to be and what we'll get back is actually a Python dictionary that has",
    "start": "2356119",
    "end": "2362390"
  },
  {
    "text": "the response parameters so we get the data identifier back and that's actually coming back from the server and then we",
    "start": "2362390",
    "end": "2368780"
  },
  {
    "text": "also get a data record which is some serial number that we got back it's pretty simple but in other cases there",
    "start": "2368780",
    "end": "2376070"
  },
  {
    "text": "are cables that are in this standard and I really didn't want people have to buy the PDF so I have you know implemented",
    "start": "2376070",
    "end": "2382580"
  },
  {
    "text": "some of these tables for example if you're doing a Nissen you reset there's a bunch of different types so you can do the request and then you can do reset",
    "start": "2382580",
    "end": "2389420"
  },
  {
    "text": "type dot hard reset is very nice that tab completion for this because I can just go through and go you know ECU",
    "start": "2389420",
    "end": "2395450"
  },
  {
    "text": "reset reset type dot tab and then the whole list of them comes up and you select one hit enter you're good and",
    "start": "2395450",
    "end": "2401150"
  },
  {
    "text": "then we get a response back for set type one which is hard reset and we're done this would be more exciting if we had a",
    "start": "2401150",
    "end": "2407330"
  },
  {
    "text": "car to play with but you know that works whenever you're you're connected to a vehicle and you have something to",
    "start": "2407330",
    "end": "2412940"
  },
  {
    "text": "actually send you valid responses back next up we have decoding let's say you",
    "start": "2412940",
    "end": "2421430"
  },
  {
    "start": "2415000",
    "end": "2463000"
  },
  {
    "text": "have a log file so how do you get one of these let's say you take a valid tool",
    "start": "2421430",
    "end": "2427450"
  },
  {
    "text": "real OAM tool you plug it into the OBD port but you plug it in through a obd",
    "start": "2427450",
    "end": "2433250"
  },
  {
    "text": "splitter which you can get for a dollar and then on the other side of that splitter you put your own tool and you",
    "start": "2433250",
    "end": "2439790"
  },
  {
    "text": "run let's say can dump on linux to create a log file you'll get something like this you filter it by ID to get rid",
    "start": "2439790",
    "end": "2446450"
  },
  {
    "text": "of the other junk and you know this is a diagnostic session that's happening so",
    "start": "2446450",
    "end": "2452630"
  },
  {
    "text": "what do we have here we have a timestamp we have the interface which is kn0 we have a can ID and we have some data",
    "start": "2452630",
    "end": "2458599"
  },
  {
    "text": "and standard log file type thing so now",
    "start": "2458599",
    "end": "2463880"
  },
  {
    "start": "2463000",
    "end": "2607000"
  },
  {
    "text": "we want to code it so we have the Norns these is OTP guides which are used for",
    "start": "2463880",
    "end": "2469280"
  },
  {
    "text": "the actual like flow control and things like that we have a service ID and then plus 40 or the response ones when you",
    "start": "2469280",
    "end": "2476330"
  },
  {
    "text": "have data which is in black you may get negative response codes in red and this is really hard to do by hand and as much",
    "start": "2476330",
    "end": "2482839"
  },
  {
    "text": "fun as it is to like you know look like a cool movie style hacker and watch the frames fly by and be like it's a",
    "start": "2482839",
    "end": "2489470"
  },
  {
    "text": "diagnostic session control or whatever you want you want a tool to do this you don't want to try to do this yourself so",
    "start": "2489470",
    "end": "2496849"
  },
  {
    "text": "one nice thing about having an open-source implementation of UDS is we can take log files and you jam them in",
    "start": "2496849",
    "end": "2501950"
  },
  {
    "text": "and it can spit out Python objects and then we can pretty print those and we're",
    "start": "2501950",
    "end": "2506990"
  },
  {
    "text": "done so this is sort of a proof of concept right now I would like to expand this into a bigger tool but what that",
    "start": "2506990",
    "end": "2514670"
  },
  {
    "text": "would actually come out ads with something like this which is a little nicer to look at so you have a request",
    "start": "2514670",
    "end": "2520010"
  },
  {
    "text": "so there's a diagnostic session control request we want diagnostic session type three which I believe is extended",
    "start": "2520010",
    "end": "2526130"
  },
  {
    "text": "diagnostic session it gives back a response and it actually comes back with this parameter record I have no idea",
    "start": "2526130",
    "end": "2531560"
  },
  {
    "text": "what that means for this but this was reading airbag data so brings that back this particular tool",
    "start": "2531560",
    "end": "2536870"
  },
  {
    "text": "does the exact same request again for some reason then we have a read it of",
    "start": "2536870",
    "end": "2541970"
  },
  {
    "text": "identifier we get request this thing we get back oh five one three of bytes and",
    "start": "2541970",
    "end": "2547130"
  },
  {
    "text": "then you know we request a different one we get back this which looks very sq like and it turns out to be that string",
    "start": "2547130",
    "end": "2554150"
  },
  {
    "text": "which is the part number of this particular you see you this is not the",
    "start": "2554150",
    "end": "2559220"
  },
  {
    "text": "part number that the security key thing I showed you is four by the way just in",
    "start": "2559220",
    "end": "2564290"
  },
  {
    "text": "case anyone wants to try that and then you know it reads more data and revives this goes on for a long time the actual",
    "start": "2564290",
    "end": "2569750"
  },
  {
    "text": "process but now we can nicely look at it and look at this as a dump again proof of concept right now next step for this",
    "start": "2569750",
    "end": "2577220"
  },
  {
    "text": "kind of tool would be to actually make it more like for example bin walk no people use bin walk on a regular basis",
    "start": "2577220",
    "end": "2583700"
  },
  {
    "text": "here let's you extract various types of data from binary files I like something",
    "start": "2583700",
    "end": "2588920"
  },
  {
    "text": "very similar for UDS where let's say you have a whole firmware update trace you just run it and it will actually spit",
    "start": "2588920",
    "end": "2595850"
  },
  {
    "text": "out a binary file of the firmware that was sent because that would be quite useful",
    "start": "2595850",
    "end": "2601460"
  },
  {
    "text": "so yeah that's quick example I will try to run one more for you just just to",
    "start": "2601460",
    "end": "2607370"
  },
  {
    "start": "2607000",
    "end": "2711000"
  },
  {
    "text": "prove that like this is actually a thing that works if I can't mess over cool so",
    "start": "2607370",
    "end": "2613300"
  },
  {
    "text": "what we can do so example I showed you is this and we just run this UDS log",
    "start": "2613300",
    "end": "2618470"
  },
  {
    "text": "decode demo dot txt is literally the stuff I showed on the screen and there",
    "start": "2618470",
    "end": "2625190"
  },
  {
    "text": "we can we keep cat demo yeah these are the frames were looking at but then we",
    "start": "2625190",
    "end": "2631520"
  },
  {
    "text": "can run this and take second then yeah kicks out this so what would you rather",
    "start": "2631520",
    "end": "2637970"
  },
  {
    "text": "look at that or that I looked at a lot of the top one and I'm very happy to be",
    "start": "2637970",
    "end": "2643430"
  },
  {
    "text": "looking at the bottom one now but just so it wasn't it contrived demo we can also do a different car you know",
    "start": "2643430",
    "end": "2650840"
  },
  {
    "text": "probably little hard to see but the last two parameters there so it's the last one it was sixty zero and before that",
    "start": "2650840",
    "end": "2656090"
  },
  {
    "text": "was five one see that's the request and response IDs so we can run this this is",
    "start": "2656090",
    "end": "2661700"
  },
  {
    "text": "from an Audi a4 crash data recorder and broop this one's actually pretty pretty",
    "start": "2661700",
    "end": "2667430"
  },
  {
    "text": "or for a crash data recorder session and when you scroll back we see some interesting things here it's doing a",
    "start": "2667430",
    "end": "2673520"
  },
  {
    "text": "routine control and sometimes it does a routine control and actually gets a negative response as a request out of",
    "start": "2673520",
    "end": "2679910"
  },
  {
    "text": "range and what that likely is is this particular vehicle you might be asking for airbag data for airbags that are not",
    "start": "2679910",
    "end": "2686809"
  },
  {
    "text": "installed on this model probably what it is but you have to does some of that Reno's and redid identifiers goes all",
    "start": "2686809",
    "end": "2693710"
  },
  {
    "text": "the way through and that with all the data that they're pulling out from that",
    "start": "2693710",
    "end": "2698900"
  },
  {
    "text": "there's some fancy software that generates a nice report that is all the actual crash data that's located in the vehicle so yeah we can run that through",
    "start": "2698900",
    "end": "2706700"
  },
  {
    "text": "on on different examples and you also should be able to do this live so if you",
    "start": "2706700",
    "end": "2712309"
  },
  {
    "start": "2711000",
    "end": "2941000"
  },
  {
    "text": "actually have a vehicle and you have a scan tool you can plug in a wise splitter and you can push the like you",
    "start": "2712309",
    "end": "2718700"
  },
  {
    "text": "know reset steering angle sensor button and then you'll see exactly what it's sending to do that which is kind of nice",
    "start": "2718700",
    "end": "2724880"
  },
  {
    "text": "because you just get real-time feedback so few conclusions here first off",
    "start": "2724880",
    "end": "2731390"
  },
  {
    "text": "challenges the folks in the automotive industry like are aware of a lot of this",
    "start": "2731390",
    "end": "2736520"
  },
  {
    "text": "stuff and they're trying their best to fix it given the constraints of real life so I don't like to stand up here",
    "start": "2736520",
    "end": "2743390"
  },
  {
    "text": "and be like they're doing the automotive companies are terrible like they're trying but it's the reality is it takes",
    "start": "2743390",
    "end": "2750290"
  },
  {
    "text": "time and it takes money and effort and you know you got a guttering prophesy",
    "start": "2750290",
    "end": "2755329"
  },
  {
    "text": "mass so right to repair is actually a big challenge for them and they kind of blessing for any security person it's",
    "start": "2755329",
    "end": "2762530"
  },
  {
    "text": "really funny if you talk to people in the automotive industry they hate right to repair and if you talk to anyone at",
    "start": "2762530",
    "end": "2767750"
  },
  {
    "text": "DEFCON car hacking village they love it what right to repair means is that the OEMs that make cars they need to",
    "start": "2767750",
    "end": "2774950"
  },
  {
    "text": "actually provide at least in the States all the information that they would give to a dealership to anyone who is willing",
    "start": "2774950",
    "end": "2780589"
  },
  {
    "text": "to pay a subscription for you to them this means that you or I could actually sign up and get a real diagnostic tool",
    "start": "2780589",
    "end": "2787549"
  },
  {
    "text": "that can change firmware in a lot of cases and do stuff like that so that's clearly an issue you can't put the",
    "start": "2787549",
    "end": "2794059"
  },
  {
    "text": "secrets in your tool if you have to give your tool to anyone who's showing up with a few thousand dollars",
    "start": "2794059",
    "end": "2799740"
  },
  {
    "text": "it also gives us some future proofing here because we know that they can't implement anything so bulletproof that",
    "start": "2799740",
    "end": "2807030"
  },
  {
    "text": "we won't even be able to you know interact with the systems there's limited hardware resources in these some",
    "start": "2807030",
    "end": "2813150"
  },
  {
    "text": "of these still have 8-bit microcontrollers running some limited functions and it's hard to do lots of fancy crypto on that you are not going",
    "start": "2813150",
    "end": "2820860"
  },
  {
    "text": "to convince anyone in automotive to spend a bunch more money to make you",
    "start": "2820860",
    "end": "2825869"
  },
  {
    "text": "know a door controller that controls the window more secure you you won't there's not a good value proposition for it you",
    "start": "2825869",
    "end": "2832650"
  },
  {
    "text": "might be able to get a couple security elements in the vehicle but even that is pretty new and that's kind of limitation",
    "start": "2832650",
    "end": "2839840"
  },
  {
    "text": "the cost is the other side automata is very cost rather than again you're not",
    "start": "2839840",
    "end": "2845340"
  },
  {
    "text": "going to get yourself a special East ik for security in every controller it just",
    "start": "2845340",
    "end": "2850590"
  },
  {
    "text": "ain't going to happen you have to deal with the fact that you're trying to get a car out that drives and security is",
    "start": "2850590",
    "end": "2856740"
  },
  {
    "text": "not necessarily the primary concern where there's this problem of who do you trust",
    "start": "2856740",
    "end": "2862050"
  },
  {
    "text": "and the OEMs would like you to trust them they would like to keep the keys and then dole them out the problem is",
    "start": "2862050",
    "end": "2870000"
  },
  {
    "text": "they then sort of have to trust all of their dealers because their dealers have access to do this on any vehicle and by",
    "start": "2870000",
    "end": "2876390"
  },
  {
    "text": "extension of rightful repair they have to trust anyone who's willing to show up with a few thousand dollars and give a subscription so that model maybe doesn't",
    "start": "2876390",
    "end": "2882359"
  },
  {
    "text": "work so well a model that I would like to see is a movement to actually",
    "start": "2882359",
    "end": "2888600"
  },
  {
    "text": "trusting the owners so I give you a key that unlocks your car if I also give you",
    "start": "2888600",
    "end": "2893940"
  },
  {
    "text": "a keys that unlock the Diagnostics on your car then you know you can do terrible things to your own vehicle and",
    "start": "2893940",
    "end": "2900300"
  },
  {
    "text": "that's your problem but if you go into someone's dealership they won't be able",
    "start": "2900300",
    "end": "2905490"
  },
  {
    "text": "to do anything unless you give them that key now there's a ton of practical problems with implementing that and",
    "start": "2905490",
    "end": "2910680"
  },
  {
    "text": "people lose some our cards and all that but that is a model that I would really like to see in my kind of hopeful",
    "start": "2910680",
    "end": "2916430"
  },
  {
    "text": "thinking about the future of this and then there's legacy again you have a lot of cars on the road they implement some",
    "start": "2916430",
    "end": "2922710"
  },
  {
    "text": "bad protocols they will be on the road for the next ten years you just have to live with that there's millions of",
    "start": "2922710",
    "end": "2927720"
  },
  {
    "text": "diagnostic tools out there you're not going to convince every garage to buy a brand new one tomorrow",
    "start": "2927720",
    "end": "2932820"
  },
  {
    "text": "you just can't get around some of those problems a lot of money has been put into building out these systems and",
    "start": "2932820",
    "end": "2938250"
  },
  {
    "text": "networks and you can't just change them right away but there is some future here one would be internet based Diagnostics",
    "start": "2938250",
    "end": "2945840"
  },
  {
    "start": "2941000",
    "end": "3037000"
  },
  {
    "text": "which is also called DL IP Diagnostics over IP there's a new standard it's not",
    "start": "2945840",
    "end": "2951150"
  },
  {
    "text": "really in any cars or at least widespread yet but it's coming because we're seeing automotive Ethernet become",
    "start": "2951150",
    "end": "2956910"
  },
  {
    "text": "a thing that's right so IP in your vehicle and someone wants",
    "start": "2956910",
    "end": "2961940"
  },
  {
    "text": "explained to me when I mentioned this that IP has never made anything more",
    "start": "2961940",
    "end": "2967170"
  },
  {
    "text": "secure I don't know if I entirely agree with that but it's kind of true I mean usually when people start putting all",
    "start": "2967170",
    "end": "2973680"
  },
  {
    "text": "sorts of network services up the holes appear so this will be interesting to look at of course there is better",
    "start": "2973680",
    "end": "2980700"
  },
  {
    "text": "security access stuff coming in and I have had people from engineer up to see",
    "start": "2980700",
    "end": "2985710"
  },
  {
    "text": "so at various companies tell me that they are developing new things they have",
    "start": "2985710",
    "end": "2990720"
  },
  {
    "text": "yet to actually tell me what those views so I will reserve judgment until we get to see what they've done but they are",
    "start": "2990720",
    "end": "2997020"
  },
  {
    "text": "trying to address that problem again they have the challenge of you need to trust a lot of people so it's hard to do",
    "start": "2997020",
    "end": "3003860"
  },
  {
    "text": "that right and then you know future work on this kind of tool now that I have this UDS implementation I want like all",
    "start": "3003860",
    "end": "3011090"
  },
  {
    "text": "sorts just like I want a fuzzer and I want a scanner and I want like this tool to walk through logs and pull stuff at",
    "start": "3011090",
    "end": "3017180"
  },
  {
    "text": "and I just I think it's it's fun stuff it makes us more accessible hopefully we",
    "start": "3017180",
    "end": "3023330"
  },
  {
    "text": "will get to play around with it a lot at the DEF CON car hacking village this year which I'm stoked for but if you",
    "start": "3023330",
    "end": "3029090"
  },
  {
    "text": "have any ideas in terms of you know what kind of tools would be good for you what problems you're having happy to chat",
    "start": "3029090",
    "end": "3036140"
  },
  {
    "text": "about that kind of stuff anyway just to finish off here give some thanks thanks",
    "start": "3036140",
    "end": "3041420"
  },
  {
    "text": "for the black hat folks for having me out here for the third year in a row it's been fun every time so I'm glad to",
    "start": "3041420",
    "end": "3047180"
  },
  {
    "text": "be back and of course thank you to all of you who took some time to hopefully learn a thing or two about cars",
    "start": "3047180",
    "end": "3052340"
  },
  {
    "text": "hopefully it was interesting but I'm happy to chat more we have about ten minutes now and also if you can find me",
    "start": "3052340",
    "end": "3059660"
  },
  {
    "text": "in the hallway lots information there github you can install it from pip you email me there you can Twitter me there",
    "start": "3059660",
    "end": "3065920"
  },
  {
    "text": "more information with link layer is there and the treadeth information is on that one so thanks and any questions oh",
    "start": "3065920",
    "end": "3074790"
  },
  {
    "text": "oh yeah so the question was questions",
    "start": "3078450",
    "end": "3114970"
  },
  {
    "text": "like where does this come up in practice being a threat in cars yeah so one",
    "start": "3114970",
    "end": "3120099"
  },
  {
    "text": "example was of course the brakes thing so being able to do a routine control for the brakes another is simply",
    "start": "3120099",
    "end": "3125650"
  },
  {
    "text": "changing firmware there are I'd say the majority of cars on the road today have no firmware signing so if you can do",
    "start": "3125650",
    "end": "3132369"
  },
  {
    "text": "that process you can get code execution on an engine and then you have like an",
    "start": "3132369",
    "end": "3138280"
  },
  {
    "text": "implant basically you also can modify things actually pulling that off would",
    "start": "3138280",
    "end": "3144520"
  },
  {
    "text": "be probably pretty hard because you would need to know we reverse engineer the actual firmware which has a kind of stuff compiled into it and figure out",
    "start": "3144520",
    "end": "3151569"
  },
  {
    "text": "how to insert your own code but it is it is possible the other side of this comes into fraud things like odometers that",
    "start": "3151569",
    "end": "3159940"
  },
  {
    "text": "can be reset VIN numbers that can be changed or even in the case of the data",
    "start": "3159940",
    "end": "3165910"
  },
  {
    "text": "identifiers for diagnostic data for sorry for crash data potentially you",
    "start": "3165910",
    "end": "3171940"
  },
  {
    "text": "know you crash a car and the insurance company decides they want to send a forensic person out you could change",
    "start": "3171940",
    "end": "3177910"
  },
  {
    "text": "that data so there are some some real threats there but in terms of attack surface if you want to establish any",
    "start": "3177910",
    "end": "3184450"
  },
  {
    "text": "sort of persistence in the vehicle this is going to be the only way to do it on the canvas as opposed unless you're",
    "start": "3184450",
    "end": "3191349"
  },
  {
    "text": "taking over something like an infotainment unit so there's about a bit of a lower level but it also is the controllers that really affect safety",
    "start": "3191349",
    "end": "3198430"
  },
  {
    "text": "critical items and to be honest I don't know that every",
    "start": "3198430",
    "end": "3204140"
  },
  {
    "text": "single om knows the full set of diagnostic features that is present in",
    "start": "3204140",
    "end": "3209990"
  },
  {
    "text": "their controllers suppliers leave some in things get left on it's it's like any",
    "start": "3209990",
    "end": "3215690"
  },
  {
    "text": "other network service it can be configured wrong and then suddenly",
    "start": "3215690",
    "end": "3220910"
  },
  {
    "text": "there's holes that appear so so the",
    "start": "3220910",
    "end": "3234260"
  },
  {
    "text": "thought there is how can i connect to the OBD port externally some vehicles have known physical flaws that you can",
    "start": "3234260",
    "end": "3240350"
  },
  {
    "text": "get on the canvas externally maybe not quite the OBD port but some can bus and will be controllers there if",
    "start": "3240350",
    "end": "3247550"
  },
  {
    "text": "you can't do that you're probably going to be breaking into the car or cutting a hole in the window but then of course",
    "start": "3247550",
    "end": "3254660"
  },
  {
    "text": "you have to look at the whole range of attacks on things like infotainment systems tire pressure monitoring systems",
    "start": "3254660",
    "end": "3260210"
  },
  {
    "text": "that have wireless interfaces because if you can get code exact on one of those then suddenly you had your own",
    "start": "3260210",
    "end": "3265730"
  },
  {
    "text": "diagnostic tool in the car that can do all this stuff so this might be like kind of a privilege escalation to",
    "start": "3265730",
    "end": "3270800"
  },
  {
    "text": "compare it to normal IT where you go from being able to run code in a bit of a sandbox that can just maybe send",
    "start": "3270800",
    "end": "3276440"
  },
  {
    "text": "receive cam frames to actually being able to run routine diagnostic routines on a controller yep well",
    "start": "3276440",
    "end": "3287710"
  },
  {
    "text": "yeah so to find the key the seed key",
    "start": "3296070",
    "end": "3301690"
  },
  {
    "text": "algorithm I showed you they're pretty simple I actually had the valid tool",
    "start": "3301690",
    "end": "3306760"
  },
  {
    "text": "that I borrowed from somebody that was able to generate those and then I just drew a bunch of seeds at it and I",
    "start": "3306760",
    "end": "3313990"
  },
  {
    "text": "thought I was actually going to have to like you know do every single one until I had about three of them and will",
    "start": "3313990",
    "end": "3320859"
  },
  {
    "text": "realize that there was maybe a little bit of a pattern because I was doing them incrementally and of course the",
    "start": "3320859",
    "end": "3326200"
  },
  {
    "text": "seed value is going up incrementally and I was like this is sorry see we're not there in committee the key when it's incrementally I was like this is not",
    "start": "3326200",
    "end": "3331930"
  },
  {
    "text": "right and yeah turns out that's that's what they use there may be some that are",
    "start": "3331930",
    "end": "3337359"
  },
  {
    "text": "more complicated that might use things like the serial number to encode that but once you have the ability to pretend",
    "start": "3337359",
    "end": "3344650"
  },
  {
    "text": "to be a car you can forge any of that so you can fuzz the entire key space of",
    "start": "3344650",
    "end": "3351220"
  },
  {
    "text": "whatever it's possibly using to generate that and get all those values out yes",
    "start": "3351220",
    "end": "3358950"
  },
  {
    "text": "okay so the question was with security access is it only sent to that ECU that you're unlocking or is it sent to a",
    "start": "3366940",
    "end": "3373880"
  },
  {
    "text": "gateway that unlocks and lets you access past it so it's by the standard it's",
    "start": "3373880",
    "end": "3379910"
  },
  {
    "text": "actually unlocking the ECU you're talking to it's putting it into a special state where security is you know turned off or you have you have security",
    "start": "3379910",
    "end": "3387230"
  },
  {
    "text": "access in actual practice though there are sometimes gateways that exist where",
    "start": "3387230",
    "end": "3393350"
  },
  {
    "text": "for example you'll send a can frame an and it will first hit a gateway which",
    "start": "3393350",
    "end": "3398540"
  },
  {
    "text": "then is going to take that and determine what canvas it should be sent on maybe this is does two nice things one that",
    "start": "3398540",
    "end": "3405350"
  },
  {
    "text": "lets you you know actually have multiple canvases that only need one ovd port and secondly if you plug in like some",
    "start": "3405350",
    "end": "3412700"
  },
  {
    "text": "sketchy dongle and it crashes the canvas while you're driving it's only going to",
    "start": "3412700",
    "end": "3420050"
  },
  {
    "text": "take out the part of the canvas that's between the OBD port and that gateway everything else will be safe and that's",
    "start": "3420050",
    "end": "3425960"
  },
  {
    "text": "kind of important because you know things like power steering will turn off if you crash that bus",
    "start": "3425960",
    "end": "3432380"
  },
  {
    "text": "so Volkswagen for example has a system where the OBD port goes into a",
    "start": "3432380",
    "end": "3439280"
  },
  {
    "text": "controller and the only thing that's on that bus is the OBD port and this controller and everything else is",
    "start": "3439280",
    "end": "3445400"
  },
  {
    "text": "gateway but that typically doesn't have so much to do with security access as it does just with you know steps physically",
    "start": "3445400",
    "end": "3451460"
  },
  {
    "text": "separating buses yes",
    "start": "3451460",
    "end": "3456970"
  },
  {
    "text": "yeah yes so the question was you know",
    "start": "3463819",
    "end": "3471869"
  },
  {
    "text": "there's Wireshark or something like that let you record this and I would really liked it to show up in y-your share because Wireshark is great and you can",
    "start": "3471869",
    "end": "3478859"
  },
  {
    "text": "just click things and actually Wireshark does have support for can on Linux only but with socket can you can actually you",
    "start": "3478859",
    "end": "3486630"
  },
  {
    "text": "know just like any other network interface you double clicked and 0 and you're getting cane frames works quite",
    "start": "3486630",
    "end": "3492749"
  },
  {
    "text": "nice there the reason that I didn't write this as like a Lua plugin for Wireshark is because that would only",
    "start": "3492749",
    "end": "3498779"
  },
  {
    "text": "really work for receiving a Wireshark doesn't work so well for transmitting stuff that wasn't quite enough for me I",
    "start": "3498779",
    "end": "3506400"
  },
  {
    "text": "wanted to transmit but it probably wouldn't be that hard now that I have",
    "start": "3506400",
    "end": "3512130"
  },
  {
    "text": "you know everything broken out into bits selection all that and all the tables",
    "start": "3512130",
    "end": "3517589"
  },
  {
    "text": "and everything it probably wouldn't be that hard to port - something like Lua and then be able to decode it and actually get that display and Wireshark",
    "start": "3517589",
    "end": "3523799"
  },
  {
    "text": "because I'd much rather do that than write my own GUI because writing cross-platform dewey's is not fun so",
    "start": "3523799",
    "end": "3530839"
  },
  {
    "text": "cool I have one minute you'll ask questions we're good all right thank you",
    "start": "3530839",
    "end": "3538829"
  },
  {
    "text": "all very much for taking time and being so attentive I'll be around and feel free chat about cars Thanks",
    "start": "3538829",
    "end": "3545520"
  },
  {
    "text": "[Applause]",
    "start": "3545520",
    "end": "3549320"
  }
]