[
  {
    "text": "before we get into the technical details we're going to start off with a story two months ago someone identified a giup",
    "start": "2159",
    "end": "8800"
  },
  {
    "text": "actions misconfiguration in a public repository owned by one of the largest domestic chip manufacturers in the",
    "start": "8800",
    "end": "14839"
  },
  {
    "text": "United States anyone with a giup account could have exploited it simply by creating a poll request the",
    "start": "14839",
    "end": "21000"
  },
  {
    "text": "vulnerability allowed them to escalate to Enterprise admin privileges over that company's GitHub Enterprise Cloud tenant",
    "start": "21000",
    "end": "27480"
  },
  {
    "text": "this provided access to some of that company's most sensitive intellectual property they had the Privileges to make",
    "start": "27480",
    "end": "33480"
  },
  {
    "text": "every single repository public or even delete their GitHub organizations entirely which would trigger an",
    "start": "33480",
    "end": "38920"
  },
  {
    "text": "immediate loss of over 120,000 repositories thankfully it was not an AP",
    "start": "38920",
    "end": "44160"
  },
  {
    "text": "it was me and I disclosed the vulnerability to the company and they were able to fix",
    "start": "44160",
    "end": "50199"
  },
  {
    "text": "it before we get started we read online that as long as we have a disclaimer nobody is allowed to sue us so here we",
    "start": "50559",
    "end": "56920"
  },
  {
    "text": "go all vulnerabilities mentioned during this talk have been mediated the views and opinions expressed are solely our",
    "start": "56920",
    "end": "62600"
  },
  {
    "text": "own and this content is not endorsed by nor does it represent the views of our employers all right should be good to go",
    "start": "62600",
    "end": "68320"
  },
  {
    "text": "Adnan go ahead and introduce yourself all right my name is Adnan Khan for my day job I work as a security engineer",
    "start": "68320",
    "end": "74479"
  },
  {
    "text": "but on the side I'm a security researcher and a bug Bounty Hunter and I live in the wonderful city of Baltimore",
    "start": "74479",
    "end": "79799"
  },
  {
    "text": "Maryland my name is John stawinsky I'm a red team security engineer I also perform cicd research uh in a past life",
    "start": "79799",
    "end": "86759"
  },
  {
    "text": "I was a Collegiate wrestler and I work remote and get to move around a lot and see some cool",
    "start": "86759",
    "end": "92079"
  },
  {
    "text": "places let's start by talking about why we're here we are here because we use a systemic vulnerability class to hack a",
    "start": "92079",
    "end": "100159"
  },
  {
    "text": "lot of organizations including but not limited to the ones you see on screen",
    "start": "100159",
    "end": "105240"
  },
  {
    "text": "and most of these organizations we had enough access to cause a full-scale supply chain attack similar to solar",
    "start": "105240",
    "end": "112320"
  },
  {
    "text": "winds everybody has heard of solar winds and and we all know that supply chain attacks are on the rise but what not",
    "start": "112320",
    "end": "118640"
  },
  {
    "text": "everyone knows is that attackers are starting to focus on a new entry point for these supply chain",
    "start": "118640",
    "end": "124280"
  },
  {
    "text": "attacks namely public GitHub repositories based on our experience public GitHub repos are one of the",
    "start": "124280",
    "end": "131800"
  },
  {
    "text": "quickest and easiest ways for an attacker to launch a full scale supply chain attack all right John we all know",
    "start": "131800",
    "end": "138599"
  },
  {
    "text": "that sometimes news outlets can be a bit dramatic is this issue really that bad yes it is what we're going to show",
    "start": "138599",
    "end": "145360"
  },
  {
    "text": "you today is there's a systemic lack of awareness around self-hosted cicd agent security in the world's most advanced",
    "start": "145360",
    "end": "152400"
  },
  {
    "text": "technological organizations and it's exposing them to critical supply chain attacks through three case studies",
    "start": "152400",
    "end": "158840"
  },
  {
    "text": "covering exploits that we conducted through our research we're going to show you how the Tech Community doesn't know",
    "start": "158840",
    "end": "165080"
  },
  {
    "text": "enough about these attacks some of the these attacks are very easy to pull off and some of these attacks could even",
    "start": "165080",
    "end": "171080"
  },
  {
    "text": "change the economic balance of power in the world so how do we start here well it it",
    "start": "171080",
    "end": "179599"
  },
  {
    "text": "ALS started back in August of 2022 when myself and",
    "start": "179599",
    "end": "185280"
  },
  {
    "text": "colleagues uh at my former employer on a red team got access to one of the the client networks after obtaining a GitHub",
    "start": "185280",
    "end": "192280"
  },
  {
    "text": "token and using a self-hosted runner that we were able to take advantage to of to get back into the network that led",
    "start": "192280",
    "end": "197799"
  },
  {
    "text": "to a talk at shukan called Phantom of the pipeline and the associated release",
    "start": "197799",
    "end": "202879"
  },
  {
    "text": "of a the first version of the tool gate for automating selfed Runner",
    "start": "202879",
    "end": "209280"
  },
  {
    "text": "discovery around the time that Adnan Mason Davis and matchi were developing G I joined",
    "start": "209280",
    "end": "215080"
  },
  {
    "text": "them on the red team and got was my entry to cic security so I started using gate to discover and exploit get up",
    "start": "215080",
    "end": "222120"
  },
  {
    "text": "actions vulnerabilities mostly on these internal red team engagements uh and then we we were just seeing it so much",
    "start": "222120",
    "end": "228280"
  },
  {
    "text": "that we started looking into it more and more and we Dove deeper into get up actions post exploitation and then Adan",
    "start": "228280",
    "end": "234319"
  },
  {
    "text": "had an idea that took it to the next level there was a little asterisk at the end of the schmon presid presentation",
    "start": "234319",
    "end": "240360"
  },
  {
    "text": "that kind of mentioned if you were to fix a typo on a public repository and then modify the workflow file in your",
    "start": "240360",
    "end": "247040"
  },
  {
    "text": "fork and create a poll request you could get access to that celled Runner attached to it and uh persist on it for",
    "start": "247040",
    "end": "253640"
  },
  {
    "text": "further attacks this led to a vulnerability",
    "start": "253640",
    "end": "258840"
  },
  {
    "text": "disclosure for to the GitHub actions Runner images repository that was accepted as a critical report and could",
    "start": "258840",
    "end": "265560"
  },
  {
    "text": "have allowed an attacker to conduct a supply chain attack on almost every every GitHub customer that uses hosted",
    "start": "265560",
    "end": "272320"
  },
  {
    "text": "Runner images we decided to start searching the internet for more of these",
    "start": "272320",
    "end": "277560"
  },
  {
    "text": "misconfigurations and uh we we ended up realizing that they were kind of everywhere so we teamed up and kind of",
    "start": "277560",
    "end": "284400"
  },
  {
    "text": "went on a vulnerability research campaign on the side and we ended up finding these misconfigurations that",
    "start": "284400",
    "end": "289919"
  },
  {
    "text": "could lead to supply chain attacks in public repositories all over the board right before we go into the interesting",
    "start": "289919",
    "end": "296000"
  },
  {
    "text": "information about the attacks I want to make sure everyone understands how different typ of GitHub Runners first you have GitHub hosted Runners these are",
    "start": "296000",
    "end": "302560"
  },
  {
    "text": "built by GitHub updated frequently and as of writing cover a wide variety of",
    "start": "302560",
    "end": "307759"
  },
  {
    "text": "operating systems and architectures the key point with these GitHub hosted Runners is that they are always ephemeral when the workflow concludes",
    "start": "307759",
    "end": "314600"
  },
  {
    "text": "the runner is torn down self-hosted Runners on the flip side are dangerous that's why we have",
    "start": "314600",
    "end": "321720"
  },
  {
    "text": "the skull there self-hosted Runners are not managed by GitHub they're managed by end users they run the actions Runner",
    "start": "321720",
    "end": "327199"
  },
  {
    "text": "agent that's how they actually execute GitHub actions workflows and security is solely the responsibility of the end",
    "start": "327199",
    "end": "332960"
  },
  {
    "text": "user and anyone who's done offensive security knows that end users are inherently insecure the path of least",
    "start": "332960",
    "end": "339400"
  },
  {
    "text": "resistance so the the area we focused a lot on during our research the most insecure configuration is a non-al",
    "start": "339400",
    "end": "346000"
  },
  {
    "text": "self-hosted runner so ephemeral self-hosted Runners spin up and down for every workflow using a fresh container",
    "start": "346000",
    "end": "351720"
  },
  {
    "text": "or VM or whatever and non-al self-hosted Runners live and they execute multiple workflows during their lifetime this is",
    "start": "351720",
    "end": "357639"
  },
  {
    "text": "what we focused on during our research GitHub does warn their users about",
    "start": "357639",
    "end": "362960"
  },
  {
    "text": "attaching selfhosted Runners to public repositories but the documentation is kind of hidden so on the next slide I'm",
    "start": "362960",
    "end": "368720"
  },
  {
    "text": "going to show you what it looks like to register a self-hosted runner and attach it to your repository um and and looking",
    "start": "368720",
    "end": "374240"
  },
  {
    "text": "for documentation as we go so I have my black hat as cool repository I'm going",
    "start": "374240",
    "end": "380840"
  },
  {
    "text": "to Runners and then I'm looking at their documentation before I actually do anything so I click on this link I",
    "start": "380840",
    "end": "386919"
  },
  {
    "text": "search through these other links I don't see anything about security click on this other link and we get a lot of info on self-hosted Runners uh it talks about",
    "start": "386919",
    "end": "394240"
  },
  {
    "text": "requirements for self-hosted runn machines usage limits security not yet uh architecture still no security API",
    "start": "394240",
    "end": "402400"
  },
  {
    "text": "endpoints that the runners use um and then down here near the bottom it talks about self-hosted Runner security so",
    "start": "402400",
    "end": "408440"
  },
  {
    "text": "GitHub says they recommend you only use self-hosted Runners with private repositories they also have other documentation out there explaining this",
    "start": "408440",
    "end": "414520"
  },
  {
    "text": "in more detail but the point we want to get across here is it's not obvious this the warnings should be very much in your",
    "start": "414520",
    "end": "421160"
  },
  {
    "text": "face because of the risks that they can expose an organization to uh and so if if some Dev is just going and attaching",
    "start": "421160",
    "end": "427400"
  },
  {
    "text": "a self Runner to a repo they're probably not going to stumble across this",
    "start": "427400",
    "end": "433039"
  },
  {
    "text": "information when we teamed up the first step was identifying selfhosted Runners on public repost at scale and to do that",
    "start": "433039",
    "end": "440240"
  },
  {
    "text": "we used workflow run log analysis so this slide captures some metrics taken",
    "start": "440240",
    "end": "447199"
  },
  {
    "text": "back in the beginning of July on how many public repositories right now use either ephemeral or non-ephemeral self-",
    "start": "447199",
    "end": "453400"
  },
  {
    "text": "holed Runners so this number has gone down a bit since we first started our",
    "start": "453400",
    "end": "459080"
  },
  {
    "text": "research this is due in part to GitHub releasing a broader assortment of hosted Runners such as Mac M1 Runners were",
    "start": "459080",
    "end": "465479"
  },
  {
    "text": "previously organizations had to have a cellid runner if they wanted to run integration test on say an M1",
    "start": "465479",
    "end": "471319"
  },
  {
    "text": "Mac for non-al runners there are some excuse me for ephemeral Runners there",
    "start": "471319",
    "end": "477759"
  },
  {
    "text": "are some Al interesting attack bats like kubernetes and Cloud privilege escalations techniques that could apply that also could lead to compromise so",
    "start": "477759",
    "end": "485240"
  },
  {
    "text": "it's not all safe just attaching these Runners well let's talk about workflow",
    "start": "485240",
    "end": "490840"
  },
  {
    "text": "run log analysis every giup actions workflow has a build log this contains a",
    "start": "490840",
    "end": "497080"
  },
  {
    "text": "lot of output on what happens in the build and a lot of contextual information that might not be present when you're just looking at the log in",
    "start": "497080",
    "end": "503520"
  },
  {
    "text": "the user interface when a GitHub repository has a self hostage Runner",
    "start": "503520",
    "end": "509039"
  },
  {
    "text": "there's addition information that someone can gain from that workflow so if an attacker wants to conduct an",
    "start": "509039",
    "end": "515240"
  },
  {
    "text": "attack against public repository by looking at the Run log they can learn about how it's configured and have",
    "start": "515240",
    "end": "521599"
  },
  {
    "text": "everything they need to plan and attack before they conduct a single malicious action and it's important to remember here anyone with a GitHub account is",
    "start": "521599",
    "end": "528320"
  },
  {
    "text": "able to download the Run log from a public repository using the API or the web",
    "start": "528320",
    "end": "534440"
  },
  {
    "text": "interface here's a sample workflow log taken from a Google owned Repository",
    "start": "534440",
    "end": "539720"
  },
  {
    "text": "this one is not vulnerable anymore however I'm going to walk through the interesting information that you can learn from this run log first you can",
    "start": "539720",
    "end": "547720"
  },
  {
    "text": "look at the labels that are attached to that that associated with that selfhosted Runner using this someone can",
    "start": "547720",
    "end": "554600"
  },
  {
    "text": "figure out some of the context that Runner is used in additionally you'll be",
    "start": "554600",
    "end": "559839"
  },
  {
    "text": "able to learn whether the runner is attached to the organization level which can have some interesting privilege",
    "start": "559839",
    "end": "565000"
  },
  {
    "text": "escalation techniques and lateral movement paths if someone if there's sh sharing between public and private",
    "start": "565000",
    "end": "571839"
  },
  {
    "text": "repositories for that self-hosted Runner group you can also learn then if it's at the repository level finally you can",
    "start": "571839",
    "end": "577959"
  },
  {
    "text": "learn about the the machine name and the actual name of the runner group all just by looking at the workflow run lock next",
    "start": "577959",
    "end": "584720"
  },
  {
    "text": "you can learn about the get up token permissions used by subsequent workflows that run on that Runner so if someone",
    "start": "584720",
    "end": "590800"
  },
  {
    "text": "gets on the runner from a fork which only has a which this has a readon token and the next one has a right token while",
    "start": "590800",
    "end": "596440"
  },
  {
    "text": "they can get access to a right token by persisting next using a somewhat clever heris",
    "start": "596440",
    "end": "603440"
  },
  {
    "text": "someone can determine whether the selfhosted runner is ephemeral or non-ephemeral by looking at the output",
    "start": "603440",
    "end": "608680"
  },
  {
    "text": "of the actions checkout reusable action if there's a step that says cleaning the repository that means that it's cleaning",
    "start": "608680",
    "end": "615360"
  },
  {
    "text": "out the previous checkout which almost always means it's a non-al runner and",
    "start": "615360",
    "end": "620600"
  },
  {
    "text": "finally by using contextual information in the Run log you can determine if it's",
    "start": "620600",
    "end": "625760"
  },
  {
    "text": "running on an x84 or arm 64 architecture and that can inform the payload you'll end up",
    "start": "625760",
    "end": "631959"
  },
  {
    "text": "using all right all right John Let's teach every let's show everyone how we can hack hack Planet yeah so a lot of",
    "start": "631959",
    "end": "640639"
  },
  {
    "text": "ORS we using selfhosted Runners on public repos we've established that but why does using selfed Runners expose",
    "start": "640639",
    "end": "646839"
  },
  {
    "text": "these orgs to compromise there's a few reasons the first is that people tend to use default settings no matter how",
    "start": "646839",
    "end": "653800"
  },
  {
    "text": "insecure and in the case of public get up repos some of their default settings are pretty insecure the second is that",
    "start": "653800",
    "end": "659519"
  },
  {
    "text": "becoming a contributor is not a security boundary so all contributor means is you've submitted a PR and it's gotten",
    "start": "659519",
    "end": "665040"
  },
  {
    "text": "merged that is not an actual security boundary third one is that anyone even",
    "start": "665040",
    "end": "670600"
  },
  {
    "text": "us even you can fix typo all right so what is this vulnerability this vulnerability",
    "start": "670600",
    "end": "676760"
  },
  {
    "text": "presents itself in the worst form when three things that when by themselves could be considered best practices come",
    "start": "676760",
    "end": "683880"
  },
  {
    "text": "together first you have the default workflow approval requirement for public GI up repositories workflows that run on",
    "start": "683880",
    "end": "690240"
  },
  {
    "text": "the pull request trigger do not require approval to run if the user is a previous contributor this simply means",
    "start": "690240",
    "end": "696160"
  },
  {
    "text": "that if they've had a pull request approved and merged it could be as small as a single character typo",
    "start": "696160",
    "end": "701880"
  },
  {
    "text": "fix that next the repository has to have access",
    "start": "701880",
    "end": "708720"
  },
  {
    "text": "to a non-al self- holed Runner this means that the runner is not destroyed after the conclusion of the workflow",
    "start": "708720",
    "end": "714800"
  },
  {
    "text": "this is what creates the opportunity for interbuild interaction so when you have this someone who can who creates a fork",
    "start": "714800",
    "end": "721440"
  },
  {
    "text": "PR can modify the workflow file in their fork and then run arbitrary code on that Runner the final step here is that",
    "start": "721440",
    "end": "728560"
  },
  {
    "text": "subsequent workflows that also use the self folage Runner have either an over permissive get up token or use G up",
    "start": "728560",
    "end": "735480"
  },
  {
    "text": "actions workflow secrets that have access to other resources where you can",
    "start": "735480",
    "end": "742000"
  },
  {
    "text": "move laterally too when all of these things come",
    "start": "742000",
    "end": "747120"
  },
  {
    "text": "together you can have a major incident that will ruin your day we brok in uh our common attack fast",
    "start": "747120",
    "end": "754079"
  },
  {
    "text": "down into three steps for you guys Step One is become a contributor step two is",
    "start": "754079",
    "end": "759160"
  },
  {
    "text": "persist on the runner so we'll install our runon runner C2 on their self-hosted get up Runners and then step three",
    "start": "759160",
    "end": "766480"
  },
  {
    "text": "following these nice diagrams is capturing secrets and moving laterally this is the most important step it's",
    "start": "766480",
    "end": "772519"
  },
  {
    "text": "where we spent most of our most of our time during our research this is how you take trivial Runner rce and turn it into",
    "start": "772519",
    "end": "778760"
  },
  {
    "text": "a compl compl supply chain compromise we mentioned this earlier but we are going to cover three case studies",
    "start": "778760",
    "end": "785800"
  },
  {
    "text": "during this talk they're each real live exploits and during these case studies we're going to use each one of them to",
    "start": "785800",
    "end": "793320"
  },
  {
    "text": "illustrate a unique point about self-hosted Runner security and how an attacker can abuse them the first case study we're going to",
    "start": "793320",
    "end": "800800"
  },
  {
    "text": "show that The Tech Community is uninformed in these attacks that can have critical widespread impact for the",
    "start": "800800",
    "end": "808160"
  },
  {
    "text": "first case study I'm going to talk about the vulnerability I submitted to GitHub on hacking GitHub through actions this",
    "start": "808160",
    "end": "814680"
  },
  {
    "text": "targeted the github's action Runner images repository which holds the code used to build get up hosted Runners this",
    "start": "814680",
    "end": "820800"
  },
  {
    "text": "is the attack that started everything the first step here was to become a contributor this involved",
    "start": "820800",
    "end": "826760"
  },
  {
    "text": "fixing a typo shortly after the pull request was approved by the maintainers and merged",
    "start": "826760",
    "end": "834399"
  },
  {
    "text": "in doesn't get much easier than that to cross a security boundary",
    "start": "834399",
    "end": "840199"
  },
  {
    "text": "after establishing contributor status The Next Step was planning the attack the repository used work nightly",
    "start": "840199",
    "end": "846480"
  },
  {
    "text": "workflows for continuous integration this had a get up token with all the right access these integration tests ran",
    "start": "846480",
    "end": "853320"
  },
  {
    "text": "on non-al self holed Runners and by observing how the work workflows ran on",
    "start": "853320",
    "end": "859639"
  },
  {
    "text": "the build logs it was possible to determine that these images were saved off to either ventry or Azure and the",
    "start": "859639",
    "end": "866440"
  },
  {
    "text": "workflow had secrets to both so it was clear what I could get out of",
    "start": "866440",
    "end": "871800"
  },
  {
    "text": "this the mission here started to come together so I'd",
    "start": "871800",
    "end": "877440"
  },
  {
    "text": "have one shot to pull it off because if I wasn't able to get access I probably wouldn't be able to prove impact",
    "start": "877440",
    "end": "883800"
  },
  {
    "text": "properly with this there was a window of time between implanting the runner and",
    "start": "883800",
    "end": "890600"
  },
  {
    "text": "being able to access the gith up token from that subsequent workflow in order to clean up my the evidence of the the",
    "start": "890600",
    "end": "896639"
  },
  {
    "text": "implantation so I there was there was an element of timing that was quite critical here the initial implementation",
    "start": "896639",
    "end": "904000"
  },
  {
    "text": "had to be right before that scheduled run so as soon as I got access I could get that token and then clean up after",
    "start": "904000",
    "end": "909880"
  },
  {
    "text": "myself so go time was set it was Friday July 21st 2023 and let me tell you I was",
    "start": "909880",
    "end": "916519"
  },
  {
    "text": "extremely nervous clicking that great draft pull request button right there so the payload that I used for",
    "start": "916519",
    "end": "924920"
  },
  {
    "text": "this was a modified liner. yaml file the first thing you can see here is that I",
    "start": "924920",
    "end": "930000"
  },
  {
    "text": "modified it to run with as a matrix job so I essentially have it run six payloads three on one Runner class three",
    "start": "930000",
    "end": "937639"
  },
  {
    "text": "on another so because I wanted to make sure that when that subsequent workflow ran I had I was on the runner it was",
    "start": "937639",
    "end": "943600"
  },
  {
    "text": "running on the next step was modifying a script",
    "start": "943600",
    "end": "949920"
  },
  {
    "text": "that was checked out from the the repository that called out to a second",
    "start": "949920",
    "end": "955399"
  },
  {
    "text": "stage payload in in a Guist so just called it and and piped to The Bash to",
    "start": "955399",
    "end": "961000"
  },
  {
    "text": "get arbitrary executions in a way that I could clean up after running it this is",
    "start": "961000",
    "end": "966240"
  },
  {
    "text": "the payload that it pulled down it's a bash script that installs a runner on Runner so the first thing it does is it",
    "start": "966240",
    "end": "973319"
  },
  {
    "text": "pulls it decodes a hardcoded access token which it uses to pull down a",
    "start": "973319",
    "end": "978480"
  },
  {
    "text": "selfer run a registration token next it ex extracts it it downloads the actions",
    "start": "978480",
    "end": "985399"
  },
  {
    "text": "Runner binary from GitHub and extracts it finally it configures it to connect",
    "start": "985399",
    "end": "991399"
  },
  {
    "text": "to a command and control repository and then runs it it's important to not here",
    "start": "991399",
    "end": "996920"
  },
  {
    "text": "the runner tracking ID when that environment variable is set to zero it informs the GitHub actions Runner to not",
    "start": "996920",
    "end": "1003120"
  },
  {
    "text": "reap orphan processes at the conclusion of the workflow so when the initial",
    "start": "1003120",
    "end": "1008399"
  },
  {
    "text": "implantation workflow concludes my persistence mechanism lives",
    "start": "1008399",
    "end": "1014279"
  },
  {
    "text": "on so here you can see the subsequent workflows are running and my",
    "start": "1014959",
    "end": "1020079"
  },
  {
    "text": "implantation workflow right below it so what does persisting on this",
    "start": "1020079",
    "end": "1026240"
  },
  {
    "text": "selfers Runner provide well with a GitHub token that has actions right it's possible to delete the workflow run Logs",
    "start": "1026240",
    "end": "1032438"
  },
  {
    "text": "with the GitHub API with access to unredacted scripts on",
    "start": "1032439",
    "end": "1038240"
  },
  {
    "text": "the file system that can provide access to secrets and internal network access",
    "start": "1038240",
    "end": "1043640"
  },
  {
    "text": "provides lateral movement opportunities with a get up token that has Conta right access it's possible to",
    "start": "1043640",
    "end": "1050559"
  },
  {
    "text": "issue a dispatch event to trigger other workflows which leads to pipeline privilege escalation and finally this is like that",
    "start": "1050559",
    "end": "1058440"
  },
  {
    "text": "solar wind style interacting with ongoing builds can lead to General Supply Chain",
    "start": "1058440",
    "end": "1064039"
  },
  {
    "text": "compromise after it I I saw the runners check into my C2 repository if anyone's",
    "start": "1064039",
    "end": "1070960"
  },
  {
    "text": "familiar with C2 this almost looks like a C2 panel right so this is our own get up repository and it's all of our",
    "start": "1070960",
    "end": "1076360"
  },
  {
    "text": "self-hosted Runners just checking in and what's great about this is you can just make a little webshell workflow and then",
    "start": "1076360",
    "end": "1082320"
  },
  {
    "text": "you can use the workflow dispatch to execute commands directly on your self-hosted Runners uh and it operates",
    "start": "1082320",
    "end": "1089080"
  },
  {
    "text": "just like a webshell so it's a great way to gain and use code execution so I was",
    "start": "1089080",
    "end": "1094440"
  },
  {
    "text": "able to use the GI up token here with the that actions right access to uh",
    "start": "1094440",
    "end": "1100320"
  },
  {
    "text": "clear the test workflows at this point it's like the attack never happened if you're looking",
    "start": "1100320",
    "end": "1105600"
  },
  {
    "text": "at the Repository with internal network access",
    "start": "1105600",
    "end": "1114280"
  },
  {
    "text": "lateral sorry so with with the webshell it's possible to exfiltrate secrets so",
    "start": "1114760",
    "end": "1121600"
  },
  {
    "text": "one one of the more simple ways is simply to take that script that's on the runner's file system basic C4 encode it",
    "start": "1121600",
    "end": "1126760"
  },
  {
    "text": "and print it to the Run log of the private repository and if there's larger files that you want to exaltate you can",
    "start": "1126760",
    "end": "1133320"
  },
  {
    "text": "use the actions checkout excuse me the actions upload artifact reusable art",
    "start": "1133320",
    "end": "1139240"
  },
  {
    "text": "reasonable action to pull off larger files of multiple that could be multiple gigabytes in size and",
    "start": "1139240",
    "end": "1145760"
  },
  {
    "text": "finally for for more complex cases such as if the subsequent workflow only runs",
    "start": "1145760",
    "end": "1151080"
  },
  {
    "text": "say once a month you can place a a script in the git hooks directory of the",
    "start": "1151080",
    "end": "1156280"
  },
  {
    "text": "original checkout repos repository and that'll trigger payload execution upon",
    "start": "1156280",
    "end": "1161960"
  },
  {
    "text": "the next workflow run with access to the internal Network you can move laterally",
    "start": "1161960",
    "end": "1167200"
  },
  {
    "text": "here in this case the I had secrets to Venter as the administrator so if I",
    "start": "1167200",
    "end": "1174120"
  },
  {
    "text": "had set up a traffic tunnel it's likely that I would have been able to log in as admin another potential impact is build",
    "start": "1174120",
    "end": "1180679"
  },
  {
    "text": "tampering so when a legitimate build starts the runner that we now control Texs checks out code and then what you",
    "start": "1180679",
    "end": "1187760"
  },
  {
    "text": "can do is you can just swap build scripts during runtime so you can add your own malicious code to this build script and what will happen is any",
    "start": "1187760",
    "end": "1193880"
  },
  {
    "text": "artifacts produced from that build will now be poisoned they'll have your own malicious code and anyone who downlo loads these artifacts or uses them will",
    "start": "1193880",
    "end": "1200280"
  },
  {
    "text": "be executing your own code so I want to talk about pipeline privilege escalation here so this is one",
    "start": "1200280",
    "end": "1207440"
  },
  {
    "text": "way someone could have gotten code into the main branch of the repository there's another workflow in",
    "start": "1207440",
    "end": "1212840"
  },
  {
    "text": "this repository that ran on repository dispatch that just requires that contents write permission to",
    "start": "1212840",
    "end": "1219000"
  },
  {
    "text": "trigger next you can see this repository uses input from that dispatch event",
    "start": "1219000",
    "end": "1224039"
  },
  {
    "text": "within a run step this means if someone simply altered the dispatch phas load to contain Shell Code then they can get",
    "start": "1224039",
    "end": "1231559"
  },
  {
    "text": "arbitrary code execution in that workflow and finally you can see that that workflow uses a secret that is most",
    "start": "1231559",
    "end": "1238480"
  },
  {
    "text": "likely a GitHub access token belonging to a GitHub employee because that's how it's used in the workflow to approve en",
    "start": "1238480",
    "end": "1244000"
  },
  {
    "text": "merged po request so attacker gain access to that they can approve and merge their own pull requests into the",
    "start": "1244000",
    "end": "1249600"
  },
  {
    "text": "main branch of this repository so what is the final impact here with the supply chain compromise so",
    "start": "1249600",
    "end": "1256720"
  },
  {
    "text": "if an attacker can modify code in the main Branch then all they have to do is wait until the next production release",
    "start": "1256720",
    "end": "1263280"
  },
  {
    "text": "of the runner image to be able to attack get UPS customers that use actions in",
    "start": "1263280",
    "end": "1268480"
  },
  {
    "text": "this case the they had a very Rapid Release Cadence so an attacker would only have",
    "start": "1268480",
    "end": "1274320"
  },
  {
    "text": "to have their play load hide in plane sight for not a very long time and if they if successful they would be able to",
    "start": "1274320",
    "end": "1279799"
  },
  {
    "text": "conduct a supply chain attack that impacts virtually every G up customer that uses",
    "start": "1279799",
    "end": "1285840"
  },
  {
    "text": "actions so let's recap what happens simply by becoming a contributor it was possible to conduct a series of",
    "start": "1285840",
    "end": "1291960"
  },
  {
    "text": "operations to get Secrets move laterally and potentially even conduct an attack",
    "start": "1291960",
    "end": "1298960"
  },
  {
    "text": "that impacts every single GitHub customer so let let's move on to case",
    "start": "1298960",
    "end": "1304360"
  },
  {
    "text": "study to John Let's can you show how easy these attacks can be yeah so that",
    "start": "1304360",
    "end": "1310480"
  },
  {
    "text": "last attack it required fairly Advanced cicd knowledge to exploit right so it's it's not something that the",
    "start": "1310480",
    "end": "1315880"
  },
  {
    "text": "opportunistic attacker could uh could do in an average day this next case study",
    "start": "1315880",
    "end": "1321159"
  },
  {
    "text": "is extremely easy so we're going to talk about how we breach Microsoft's perimeter by abusing GitHub actions",
    "start": "1321159",
    "end": "1326440"
  },
  {
    "text": "misconfigurations in Microsoft deep speed to breach Microsoft's perimeter back when we executed this attack you",
    "start": "1326440",
    "end": "1332360"
  },
  {
    "text": "didn't need to do any sort of social engineering no picking up the phone you didn't need to exploit a web application",
    "start": "1332360",
    "end": "1338400"
  },
  {
    "text": "vulnerability all you had to do was fix a typo and by fix a typo we mean become",
    "start": "1338400",
    "end": "1343559"
  },
  {
    "text": "a contributor before we get into this attack we want to touch on a trend that we've seen in IML so a lot of our",
    "start": "1343559",
    "end": "1349760"
  },
  {
    "text": "targets have happened to be AIML repositories and there's a few reasons for this the first is these repositories",
    "start": "1349760",
    "end": "1356320"
  },
  {
    "text": "need a lot of compute requirements for their their builds and their tests and so getto hostal Runners they don't have",
    "start": "1356320",
    "end": "1361720"
  },
  {
    "text": "massive compute requirements so these AIML repos are just taking selfless Runners to do the job for them another",
    "start": "1361720",
    "end": "1368080"
  },
  {
    "text": "thing we we've all seen is Engineers working on AI projects they are under a lot of pressure it's it's a race right",
    "start": "1368080",
    "end": "1374640"
  },
  {
    "text": "now and so they're moving as fast as they possibly can and what we see is that developers are taking shortcuts at",
    "start": "1374640",
    "end": "1381559"
  },
  {
    "text": "the expense of security Microsoft deep speed for anyone who's not familiar it's an open-source",
    "start": "1381559",
    "end": "1387400"
  },
  {
    "text": "deep learning optimization Library if you don't know what that means don't worry I also don't know what it means",
    "start": "1387400",
    "end": "1393200"
  },
  {
    "text": "and it's completely irrelevant for this attack what is relevant is deep speed is very popular and if you look closely at",
    "start": "1393200",
    "end": "1399600"
  },
  {
    "text": "this workflow file you can see that the repository surprise surprise uses self-hosted Runners so as soon as we saw",
    "start": "1399600",
    "end": "1406159"
  },
  {
    "text": "this repo is using self-hosted runners Adan and I did what every good hacker should do we picked up the phone and we",
    "start": "1406159",
    "end": "1412600"
  },
  {
    "text": "called the grammar police the grammar police me and Adnan showed up and we ran",
    "start": "1412600",
    "end": "1417640"
  },
  {
    "text": "their markdown files through grammarly and we found this tricky typo here and so we removed thethe and submitted a",
    "start": "1417640",
    "end": "1425440"
  },
  {
    "text": "poll request and then a week later it was merged so again actually finding a typo that is totally irrelevant the",
    "start": "1425440",
    "end": "1431760"
  },
  {
    "text": "reason we do this is because it's the easiest way to become a contributor without you know making a substantial",
    "start": "1431760",
    "end": "1437880"
  },
  {
    "text": "development effort so we fix a typo then we're contributor and now if they're using default workflow approval requirements we can execute code on",
    "start": "1437880",
    "end": "1444600"
  },
  {
    "text": "their self-hosted Runners our payload for deep speed was a lot simpler so we",
    "start": "1444600",
    "end": "1449760"
  },
  {
    "text": "were we were looking through the workl logs and there wasn't too much opportunity for post exploitation so the",
    "start": "1449760",
    "end": "1455279"
  },
  {
    "text": "GitHub tokens privileges were pretty restricted there weren't a ton of GitHub secrets so rather than fullon install",
    "start": "1455279",
    "end": "1460600"
  },
  {
    "text": "our runner on Runner C2 we just wanted to execute a few shell commands and see what we were working with so this was",
    "start": "1460600",
    "end": "1466200"
  },
  {
    "text": "our our workflow and our Fork and we specified it to run on their self-hosted Runners and we just executed who am I",
    "start": "1466200",
    "end": "1473039"
  },
  {
    "text": "PWD and LS so again very simple anyone in this room could have gone and done",
    "start": "1473039",
    "end": "1478799"
  },
  {
    "text": "this and the command output was pretty surprising so if anyone's familiar with",
    "start": "1478799",
    "end": "1483880"
  },
  {
    "text": "active directory this output showed that the self-hosted runner was actually joined to Microsoft's Redmond domain uh",
    "start": "1483880",
    "end": "1490320"
  },
  {
    "text": "as far as I know Redmond is one of Microsoft's largest and oldest domains I think it was created in in 1999 and",
    "start": "1490320",
    "end": "1497159"
  },
  {
    "text": "what's worse is is we now code execution in the context of a senior developer working at Microsoft so this was",
    "start": "1497159",
    "end": "1503960"
  },
  {
    "text": "definitely a surprise when we looked at the build output and like we've worked on a red team together what what do you",
    "start": "1503960",
    "end": "1510120"
  },
  {
    "text": "think someone could do with a a foothold with the Privileges of a senior developer oh I'm sure there's a lot to unpack there but I I'm almost certain",
    "start": "1510120",
    "end": "1516880"
  },
  {
    "text": "that there's some people in this room that could do some terrible things with that access the the whole point of this case",
    "start": "1516880",
    "end": "1522679"
  },
  {
    "text": "study again is this wasn't a way to to cause a supply chain attack so the the impact of these attacks can vary based",
    "start": "1522679",
    "end": "1528600"
  },
  {
    "text": "on uh based on how everything's set up but it was really easy to use these misconfigurations to breach Microsoft's",
    "start": "1528600",
    "end": "1535360"
  },
  {
    "text": "perimeter in some cases to exploit selfhosted Runners you need Advanced cicd knowledge but in other cases all",
    "start": "1535360",
    "end": "1542000"
  },
  {
    "text": "you need is a typo fix and a few shell commands all right now we're going to",
    "start": "1542000",
    "end": "1547240"
  },
  {
    "text": "take take a quick step back here and quickly demo gate x a tool that actually automates the entire cell F Runner",
    "start": "1547240",
    "end": "1553840"
  },
  {
    "text": "takeover process provided you can just fix a typo so let's show a quick video of it it's also available on GitHub",
    "start": "1553840",
    "end": "1560120"
  },
  {
    "text": "right now so here I'm enumerating a repository and I've learned that it has a nonf s Fage Runner now I'm just going",
    "start": "1560120",
    "end": "1566240"
  },
  {
    "text": "to go ahead and fix the typo so I create a pull request here with a typo",
    "start": "1566240",
    "end": "1573440"
  },
  {
    "text": "fix that go [Music] through and after making the pull",
    "start": "1573440",
    "end": "1579159"
  },
  {
    "text": "request I'm just going to jump ahead to it getting merged so now it's merged in and my user is a contributor so after",
    "start": "1579159",
    "end": "1585600"
  },
  {
    "text": "having the pull request merged in I'm going to go ahead and just delete the fork because got X will make a new Fork",
    "start": "1585600",
    "end": "1590840"
  },
  {
    "text": "as part of the uh implantation payload so go ahead and delete the fork real quick and now switch over to using",
    "start": "1590840",
    "end": "1598000"
  },
  {
    "text": "got X so I run it what it does is it sets up",
    "start": "1598000",
    "end": "1603799"
  },
  {
    "text": "the payload and the g file to deliver it and then it's going to ask for",
    "start": "1603799",
    "end": "1608840"
  },
  {
    "text": "confirmation just want to make sure user actually wants to go through with an overt attack so after confirming the",
    "start": "1608840",
    "end": "1614960"
  },
  {
    "text": "attack goo X creates a draft pull request to deliver the payload and here",
    "start": "1614960",
    "end": "1621840"
  },
  {
    "text": "it's going through because the approval is not required because the default settings are in place so now it's going to pull for that Runner connecting back",
    "start": "1621840",
    "end": "1628799"
  },
  {
    "text": "and as soon as it connects it's going to drop to a shell-like prompt and I'm just",
    "start": "1628799",
    "end": "1633919"
  },
  {
    "text": "going to run you name- a so after I run this what's happening in the back end is",
    "start": "1633919",
    "end": "1640039"
  },
  {
    "text": "that GX is issuing a workflow dispatch event to the command and control repository to execute code on that",
    "start": "1640039",
    "end": "1647200"
  },
  {
    "text": "selfhosted Runner so there it calls back and that's the results so you can do a lot more with it",
    "start": "1647200",
    "end": "1654120"
  },
  {
    "text": "more features well documented online yeah gotx really would would save everyone a lot of time where where we",
    "start": "1654120",
    "end": "1660679"
  },
  {
    "text": "spent manually typing all the all of our payloads in Gotto X automates all that okay final case study this has not been",
    "start": "1660679",
    "end": "1668039"
  },
  {
    "text": "released in public before I personally wasn't involved in this attack so I'll take a step back and I will let Anan",
    "start": "1668039",
    "end": "1673760"
  },
  {
    "text": "walk you through case study number three all right so well the the case study",
    "start": "1673760",
    "end": "1679600"
  },
  {
    "text": "number three maps to that story that I started off with before how these attacks could potentially change the economic balance of b b balance of power",
    "start": "1679600",
    "end": "1686519"
  },
  {
    "text": "in the world if thread actors were to gain extremely sensitive intellectual property of a chip major chip",
    "start": "1686519",
    "end": "1692200"
  },
  {
    "text": "manufacturer third case study and talk about how I was able to get inside Intel",
    "start": "1692200",
    "end": "1697799"
  },
  {
    "text": "through a pull request and a couple of other extra steps so before we go into the technical details of this case study",
    "start": "1697799",
    "end": "1703840"
  },
  {
    "text": "I want to talk about how GitHub features Intel within their Enterprise customer sucess access story page GitHub quotes",
    "start": "1703840",
    "end": "1710360"
  },
  {
    "text": "the lead of Intel's on Source team as stating that when they moved their codebase to GitHub they broke down",
    "start": "1710360",
    "end": "1716399"
  },
  {
    "text": "barriers unfortunately as you're probably going to see here some of those barriers ended up being",
    "start": "1716399",
    "end": "1723240"
  },
  {
    "text": "security unlike the previous case studies this didn't start off with a typo fix this started off with a phone",
    "start": "1723240",
    "end": "1730039"
  },
  {
    "text": "request vulnerability in a small repository called AI containers within Intel's open source get up organization",
    "start": "1730039",
    "end": "1736960"
  },
  {
    "text": "there's a lot to that vulnerability and we're not going to cover it here uh but you don't really need to understand it",
    "start": "1736960",
    "end": "1742320"
  },
  {
    "text": "to see what happens next the key thing here is that the it allowed someone to",
    "start": "1742320",
    "end": "1748600"
  },
  {
    "text": "run arbitrary code in the context of a privileged workflow which is how this starts off so it checks out code and",
    "start": "1748600",
    "end": "1755880"
  },
  {
    "text": "then it runs it from the fork how does it run it well in this",
    "start": "1755880",
    "end": "1762200"
  },
  {
    "text": "case the workflow calls the talk module of python which uses the talks that I",
    "start": "1762200",
    "end": "1768200"
  },
  {
    "text": "file so an attacker could simply either modify the talks of that ini file or modify one of the unit tests called by",
    "start": "1768200",
    "end": "1773720"
  },
  {
    "text": "that file to gain arbitrary code execution the workflow also used a",
    "start": "1773720",
    "end": "1779279"
  },
  {
    "text": "secret called action token within the same job this means that someone after getting arbitrary code execution could",
    "start": "1779279",
    "end": "1785880"
  },
  {
    "text": "get access to that token that action token turned out to be a get up personal access token owned by an Intel",
    "start": "1785880",
    "end": "1791600"
  },
  {
    "text": "employee now if you see this picture looks familiar to you it's because it's the same picture from before it's",
    "start": "1791600",
    "end": "1797559"
  },
  {
    "text": "another case case of vulnerabilities arising within the general AIML",
    "start": "1797559",
    "end": "1802720"
  },
  {
    "text": "space so the first situation here is that there was an over Le scoped access",
    "start": "1802720",
    "end": "1808399"
  },
  {
    "text": "token attached to that repository as an action secret next there was another",
    "start": "1808399",
    "end": "1814880"
  },
  {
    "text": "non-ephemeral selfhosted Runner attached to the Republic repository that wasn't the one running the fork P across",
    "start": "1814880",
    "end": "1820519"
  },
  {
    "text": "workflows but combined with the token it was possible to get access to it and finally it's very likely that the",
    "start": "1820519",
    "end": "1826679"
  },
  {
    "text": "changes to the workflows that introduced his vulnerability in the first place didn't really go through security",
    "start": "1826679",
    "end": "1833919"
  },
  {
    "text": "reviews so what could a single poll request do well by creating a a poll",
    "start": "1834320",
    "end": "1839440"
  },
  {
    "text": "request an attacker can get access to that action token now the paths from this kind of Branch off on one hand you",
    "start": "1839440",
    "end": "1845720"
  },
  {
    "text": "have access to that non-formal self fuled Runner because an attacker can create a fork pull request and then use",
    "start": "1845720",
    "end": "1851480"
  },
  {
    "text": "that token to approve the pole request so that bypassing the entire typo fix step and also that's at that point it",
    "start": "1851480",
    "end": "1857559"
  },
  {
    "text": "doesn't matter what the approval requirements are next that token also was saml SSO authorized",
    "start": "1857559",
    "end": "1864559"
  },
  {
    "text": "and as such had access to Intel's internal organizations so when those two things came together it allows",
    "start": "1864559",
    "end": "1871320"
  },
  {
    "text": "enumerating those internal organizations because the non-al self fuled Runner",
    "start": "1871320",
    "end": "1877799"
  },
  {
    "text": "also egressed from Intel's North Corporate North America corporate proxy which allowed getting past the IP allow",
    "start": "1877799",
    "end": "1883679"
  },
  {
    "text": "listing restriction that Intel had for their inner Source repository all of this allowed searching for internal misconfigurations and on in the bottom",
    "start": "1883679",
    "end": "1891279"
  },
  {
    "text": "of the slide you can see running gate X on Intel inner source with that token from their self assed",
    "start": "1891279",
    "end": "1898480"
  },
  {
    "text": "Runner all right all of this isn't great but it's one employee and the runners in the",
    "start": "1898480",
    "end": "1904000"
  },
  {
    "text": "DMZ shouldn't be a lot more of this right well there was an internal",
    "start": "1904000",
    "end": "1911159"
  },
  {
    "text": "misconfiguration within a repository called inventory which was used for a couple things in cicd infrastructure",
    "start": "1911159",
    "end": "1917159"
  },
  {
    "text": "Automation and just automating devops processes don't want to go too into it too much but the key thing here was that",
    "start": "1917159",
    "end": "1924559"
  },
  {
    "text": "every Intel blue badge employee had right access to this",
    "start": "1924559",
    "end": "1929799"
  },
  {
    "text": "repository and this and in GitHub actions if you have right access to a repository you have access to all the",
    "start": "1930799",
    "end": "1937880"
  },
  {
    "text": "secrets that's just how GitHub actions Secrets work to mitigate this this repository had a rule set that prevented",
    "start": "1937880",
    "end": "1945080"
  },
  {
    "text": "creating any new new branches uh and modifying files on them so it would",
    "start": "1945080",
    "end": "1950360"
  },
  {
    "text": "prevent someone with right access from actually modifying worklow to get Secrets however there was a an exception",
    "start": "1950360",
    "end": "1956120"
  },
  {
    "text": "to this rule set which was that any branches matching the pattern gh- read",
    "start": "1956120",
    "end": "1961559"
  },
  {
    "text": "only- Q SL anything anything would would not be subject to that rule so if they",
    "start": "1961559",
    "end": "1967279"
  },
  {
    "text": "you could just created a branch matching that pattern you can get access to Secrets One of the interesting secrets",
    "start": "1967279",
    "end": "1972480"
  },
  {
    "text": "on this repository was a config of token this was used in a another automation",
    "start": "1972480",
    "end": "1978000"
  },
  {
    "text": "workflow but the operation it performed suggested that it was likely to be an",
    "start": "1978000",
    "end": "1984080"
  },
  {
    "text": "organization admin turns out it was so this bot token belonged to the GitHub on",
    "start": "1984080",
    "end": "1992360"
  },
  {
    "text": "Source user under that Intel's Enterprise standard and was an Enterprise admin of",
    "start": "1992360",
    "end": "1999639"
  },
  {
    "text": "Intel's organizations and as such an organization admin to all of them so it",
    "start": "1999639",
    "end": "2005320"
  },
  {
    "text": "was possible here to run G to enumerate Intel's Intel restricted organization",
    "start": "2005320",
    "end": "2011720"
  },
  {
    "text": "which hold holds more of their highly sensitive intellectual property uh and",
    "start": "2011720",
    "end": "2017399"
  },
  {
    "text": "and is more restricted from the general Intel employee population this access was",
    "start": "2017399",
    "end": "2025320"
  },
  {
    "text": "unprecedented because the bot user was an org admin simply the Intel restricted",
    "start": "2025320",
    "end": "2031080"
  },
  {
    "text": "it had admin access to all 16,000 plus repositories with within",
    "start": "2031080",
    "end": "2037159"
  },
  {
    "text": "that organization a lot of this a lot of the repositories within that organization were were",
    "start": "2037159",
    "end": "2044960"
  },
  {
    "text": "highly sensitive Intel top secret code or source code under strict ndas with third",
    "start": "2044960",
    "end": "2050839"
  },
  {
    "text": "parties this access also would have allowed someone to make all of the",
    "start": "2050839",
    "end": "2057280"
  },
  {
    "text": "repositories within Intel restricted public and then everyone could access",
    "start": "2057280",
    "end": "2062358"
  },
  {
    "text": "them or if someone just wanted to cause damage they could issue a single delete API call and just delete the",
    "start": "2062359",
    "end": "2068320"
  },
  {
    "text": "organization this would cause a Cascade of effects with all the repositories",
    "start": "2068320",
    "end": "2073560"
  },
  {
    "text": "being lost yes it's likely that with the help of GitHub support they could be restored but the loss of Integrations",
    "start": "2073560",
    "end": "2078878"
  },
  {
    "text": "and loss of developer productivity would cost a lot of money some of this source code that it",
    "start": "2078879",
    "end": "2085960"
  },
  {
    "text": "had access to was highly sensitive here this is a repository holding the intellectual property uh and Chip",
    "start": "2085960",
    "end": "2092480"
  },
  {
    "text": "designs for Intel's upcoming Royal core x86 uh architecture so this is is",
    "start": "2092480",
    "end": "2097839"
  },
  {
    "text": "definitely not something you'd want to get in the hands of an unauthorized actor I want to take a step back and",
    "start": "2097839",
    "end": "2104640"
  },
  {
    "text": "talk about personal access tokens and access control in general this really isn't an isolated case with one employee",
    "start": "2104640",
    "end": "2110680"
  },
  {
    "text": "over provisioning a token because of the access to the organizations I was able to get some interesting metrics so 32%",
    "start": "2110680",
    "end": "2118800"
  },
  {
    "text": "of the active personal access tokens to Intel restricted Intel in Source had 10",
    "start": "2118800",
    "end": "2124240"
  },
  {
    "text": "or more Scopes checked 79% of the didn't even have an expiration date at",
    "start": "2124240",
    "end": "2130119"
  },
  {
    "text": "all so they would be valid until that employee leaves and finally when enumerating organizations with a tool",
    "start": "2130119",
    "end": "2136880"
  },
  {
    "text": "like got X that just mostly issues get requests this generates zero audit log events with the exception of",
    "start": "2136880",
    "end": "2143760"
  },
  {
    "text": "organizations that might use github's rest event logging beta but developing detections off of that is extremely",
    "start": "2143760",
    "end": "2152640"
  },
  {
    "text": "difficult zooming out for a second the three case studies we showed today they're just a small example of our",
    "start": "2153359",
    "end": "2159200"
  },
  {
    "text": "overall research honestly we could have swapped in any number of case studies to to show any number of unique points we",
    "start": "2159200",
    "end": "2164839"
  },
  {
    "text": "chose these because they illustrate stuff that we wanted to convey to everyone here um but at the end of our eight months of research we' submitted",
    "start": "2164839",
    "end": "2171720"
  },
  {
    "text": "over 20 reports to Major players in the AIML blockchain and tech industry as we started releasing our",
    "start": "2171720",
    "end": "2178880"
  },
  {
    "text": "research we were pleasantly surprised with the community's reaction so directors of of prominent organizations out there were reaching out to us to",
    "start": "2178880",
    "end": "2185040"
  },
  {
    "text": "continue the conversation and they showed us that these do care about improving their cicd attack surface they",
    "start": "2185040",
    "end": "2190720"
  },
  {
    "text": "just didn't always know how and so we're going to spend the last few minutes today showing everyone how you can protect your organization from",
    "start": "2190720",
    "end": "2198640"
  },
  {
    "text": "risk so one of the easiest things you can do for public repositories that use self LED Runners is to Simply use the",
    "start": "2198880",
    "end": "2205000"
  },
  {
    "text": "more restrictive approval setting another thing you should always do is use manage Emeral Runners whenever",
    "start": "2205000",
    "end": "2211560"
  },
  {
    "text": "possible remember self-hosted Runners are dangerous when using G access tokens try",
    "start": "2211560",
    "end": "2217319"
  },
  {
    "text": "to use fine grain tokens wherever possible limit GitHub token permissions",
    "start": "2217319",
    "end": "2223280"
  },
  {
    "text": "they should only have read access unless absolutely necessary when using sensitive",
    "start": "2223280",
    "end": "2230119"
  },
  {
    "text": "production deployment secrets for workflows try to use them under deployment environments instead of just",
    "start": "2230119",
    "end": "2235680"
  },
  {
    "text": "general action Secrets your mom was wrong okay sharing is not always caring please don't share",
    "start": "2235680",
    "end": "2242680"
  },
  {
    "text": "Runners between public and private repos because that's just lateral movement waiting to happen when it comes of self",
    "start": "2242680",
    "end": "2247880"
  },
  {
    "text": "holed Runners try not to mix continuous integration and continuous delivery and finally only as a defense and depth",
    "start": "2247880",
    "end": "2254280"
  },
  {
    "text": "measure install EDR on selfhosted Runners to catch some more opportunistic attackers so a pro another problem here",
    "start": "2254280",
    "end": "2261800"
  },
  {
    "text": "is no one solution is a Band-Aid if a repository has the more restrictive",
    "start": "2261800",
    "end": "2267079"
  },
  {
    "text": "setting an attacker could resort to social engineering or weight tool a developer has phon request vulnerability",
    "start": "2267079",
    "end": "2274000"
  },
  {
    "text": "such as what happened with Intel and that could end up with the same result next self Runners on public repositories",
    "start": "2274000",
    "end": "2281640"
  },
  {
    "text": "are really the tip of the iceberg a lot lot of larger Enterprises that use GitHub use cellos Runner fleets which",
    "start": "2281640",
    "end": "2287880"
  },
  {
    "text": "have equally bad privilege escalation lateral movement fats and a lot of those are just one fish away finally it's",
    "start": "2287880",
    "end": "2296240"
  },
  {
    "text": "important to drive developers to default defin grain tokens there are three things we want",
    "start": "2296240",
    "end": "2303160"
  },
  {
    "text": "every single person here to take away from this talk day and everyone watching online so if you've been zoning out focus up pay attention for this last",
    "start": "2303160",
    "end": "2309400"
  },
  {
    "text": "Slide the first one is that there is a systemic lack of awareness around selfed cic agent security in the world's most",
    "start": "2309400",
    "end": "2316319"
  },
  {
    "text": "advanced Tech organizations we've said it before but it's worth repeating the the number two is that attackers are",
    "start": "2316319",
    "end": "2322680"
  },
  {
    "text": "starting to focus on public GitHub repositories to launch these supply chain attacks and so your public repo",
    "start": "2322680",
    "end": "2328040"
  },
  {
    "text": "should be scrutinized just as much as any any externally facing server asset in your organization and the third point",
    "start": "2328040",
    "end": "2335400"
  },
  {
    "text": "is I always like to say ignorance is breach so a lot of times it's the attack pass you don't know about that gets you this is why we're here today we want to",
    "start": "2335400",
    "end": "2341480"
  },
  {
    "text": "start raising awareness around these issues and so devs Defenders Architects execs everyone needs to learn about",
    "start": "2341480",
    "end": "2348079"
  },
  {
    "text": "these issues so that they can look at their own systems from the perspective of an attacker identify the weak points",
    "start": "2348079",
    "end": "2353520"
  },
  {
    "text": "and then protect their orgs from the next supply chain attack if you want to start that learning process this week we",
    "start": "2353520",
    "end": "2359599"
  },
  {
    "text": "are presenting at Defcon on Saturday our talk Grand Theft actions will be more",
    "start": "2359599",
    "end": "2364960"
  },
  {
    "text": "in- depth so ra rather than today where we use a lot of case studies we're going to focus on one case study we didn't talk about today it's one of our most",
    "start": "2364960",
    "end": "2371480"
  },
  {
    "text": "complex most impactful attacks to dive deep into the technical ttps that allow you to take trivial Runner rce and turn",
    "start": "2371480",
    "end": "2377760"
  },
  {
    "text": "them into these supply chain compromises so this will be a great part two to this talk for anyone interested come see us",
    "start": "2377760",
    "end": "2383359"
  },
  {
    "text": "at Defcon if you want to learn more there's a lot of people we want to thank a lot of people were involved in this process but we want to start off by",
    "start": "2383359",
    "end": "2389920"
  },
  {
    "text": "thanking all of the bug Bounty triage teams especially the ones who took these issues seriously uh implemented quick",
    "start": "2389920",
    "end": "2395480"
  },
  {
    "text": "remediations and protected the or organizations right and we'd like to thank everyone who came out here to",
    "start": "2395480",
    "end": "2400920"
  },
  {
    "text": "watch the talk in person and whoever else is tuning in online and obviously we all of this wouldn't be if it wasn't",
    "start": "2400920",
    "end": "2407560"
  },
  {
    "text": "for black the blackhead organizers for running such an amazing event here in Las Vegas obviously we we don't have",
    "start": "2407560",
    "end": "2414079"
  },
  {
    "text": "time for questions but we'll both be at the uh breakout room to to chat more thank you very much thank you",
    "start": "2414079",
    "end": "2423040"
  }
]