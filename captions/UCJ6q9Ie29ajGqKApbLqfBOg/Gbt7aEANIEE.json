[
  {
    "text": "okay hello blackheads thank you all for coming to my talk so I am matiu I'm a professor at",
    "start": "2159",
    "end": "9639"
  },
  {
    "text": "K Len in Belgium though I have to say I'm a hacker at heart I like to keep",
    "start": "9639",
    "end": "14799"
  },
  {
    "text": "things uh practical um and try to break things in practice as well and today I'm",
    "start": "14799",
    "end": "20760"
  },
  {
    "text": "going to talk a bit about the security of VPN clients on in particular um how",
    "start": "20760",
    "end": "26160"
  },
  {
    "text": "they do not always properly Route traffic this work was done in collaboration with some of my colleagues",
    "start": "26160",
    "end": "33120"
  },
  {
    "text": "from New York University both at their campus in New York and also their campus",
    "start": "33120",
    "end": "38360"
  },
  {
    "text": "in Abu Dhabi so to give a bit of a teaser of uh what I will be talking uh",
    "start": "38360",
    "end": "44600"
  },
  {
    "text": "about in the next 40 minutes basically we're going to try to trick a VPN client",
    "start": "44600",
    "end": "50879"
  },
  {
    "text": "into leaking traffic outside of the encrypted VPN tunnel and we're going to do that by manipulating what I call the",
    "start": "50879",
    "end": "58399"
  },
  {
    "text": "routing table um and I will also explain exactly how a routing table works and",
    "start": "58399",
    "end": "65280"
  },
  {
    "text": "our attacks will also be independent of the cryptographic protocol being used",
    "start": "65280",
    "end": "70880"
  },
  {
    "text": "and yeah as a small teaser we basically tested a lot of different VPN clients on multiple operating systems and in 2/3 of",
    "start": "70880",
    "end": "79280"
  },
  {
    "text": "the cases at least one of our attacks worked and perhaps most interesting is",
    "start": "79280",
    "end": "84920"
  },
  {
    "text": "that every VPN that we tested was vulnerable on at least one operating",
    "start": "84920",
    "end": "90000"
  },
  {
    "text": "system and especially iOS was not that secure and I'll explain",
    "start": "90000",
    "end": "96079"
  },
  {
    "text": "why so really in my opinion or in our opinion this highlights a design issue",
    "start": "96079",
    "end": "101759"
  },
  {
    "text": "really in how some VPN clients were constructed and yeah let's now dig into",
    "start": "101759",
    "end": "107320"
  },
  {
    "text": "the details about this research so first and for all why might",
    "start": "107320",
    "end": "112600"
  },
  {
    "text": "you be using a VPN well probably a lot of people will be using a VPN to watch",
    "start": "112600",
    "end": "118039"
  },
  {
    "text": "movies in a different country but today we're going to assume the VPN is actually used to protect your",
    "start": "118039",
    "end": "125560"
  },
  {
    "text": "traffic because in practice if you are traveling for example or if you're here",
    "start": "125560",
    "end": "130800"
  },
  {
    "text": "at a conference like blackhead it could be that you do not trust the Wi-Fi network or that you may also not trust",
    "start": "130800",
    "end": "137760"
  },
  {
    "text": "your ISP or your ISP after that they might monitor your traffic uh they might",
    "start": "137760",
    "end": "144480"
  },
  {
    "text": "um try to manipulate your DNS requests or they might try to block things",
    "start": "144480",
    "end": "151680"
  },
  {
    "text": "and even if you would trust your own Wi-Fi access point on your isps in the",
    "start": "151680",
    "end": "158760"
  },
  {
    "text": "last couple of years there have also been several attacks that were demonstrated against Wi-Fi like crack on",
    "start": "158760",
    "end": "165280"
  },
  {
    "text": "frag attacks that would then still allow an adversary that is within radio range",
    "start": "165280",
    "end": "170760"
  },
  {
    "text": "to try to monitor or intercept your traffic and you might be thinking that",
    "start": "170760",
    "end": "176360"
  },
  {
    "text": "yeah but we have https these days so do we really still need a VPN and a VPN can",
    "start": "176360",
    "end": "182680"
  },
  {
    "text": "still provide quite some benefit in practice because if you don't use a VPN",
    "start": "182680",
    "end": "188680"
  },
  {
    "text": "someone that is in one of these positions along your network path can try to monitor the IP addresses you are",
    "start": "188680",
    "end": "195000"
  },
  {
    "text": "visiting and quite a lot of time if you know the IP address being contacted you",
    "start": "195000",
    "end": "200159"
  },
  {
    "text": "also know which website you are visiting a lot of times plain Tex DNS is still",
    "start": "200159",
    "end": "205640"
  },
  {
    "text": "used that can be also used to fingerprint your traffic on find out what your doing and even if you are using https in",
    "start": "205640",
    "end": "213760"
  },
  {
    "text": "the TLs handshake there is this thing called server name indication basically",
    "start": "213760",
    "end": "219159"
  },
  {
    "text": "when you initiate a TLS handshake at the very beginning it will send in plain text the domain you are connecting to so",
    "start": "219159",
    "end": "226959"
  },
  {
    "text": "there are still some privacy risks when using TLS on https and on top of that",
    "start": "226959",
    "end": "233439"
  },
  {
    "text": "https is also not a perfect solution we have seen attacks against it in the past",
    "start": "233439",
    "end": "239239"
  },
  {
    "text": "including including talks at blackhead where for example some clients did not properly verify the certificate meaning",
    "start": "239239",
    "end": "245480"
  },
  {
    "text": "you could intercept it things like SSL strip will have a lower success rate",
    "start": "245480",
    "end": "251760"
  },
  {
    "text": "these days because uh more websites are using https spinning but I will show a",
    "start": "251760",
    "end": "256959"
  },
  {
    "text": "demo today where it is still possible against one website to basically strip away https on yes sometimes you have",
    "start": "256959",
    "end": "264520"
  },
  {
    "text": "academic attacks as well so if you did not update your client you may still be vulnerable so so htps definitely is a",
    "start": "264520",
    "end": "271080"
  },
  {
    "text": "very good solution but it's also not perfect and to have an extra layer of",
    "start": "271080",
    "end": "277160"
  },
  {
    "text": "protection it then becomes useful to use a VPN because then you can defend",
    "start": "277160",
    "end": "282479"
  },
  {
    "text": "against all these possible uh untrusted hops along the",
    "start": "282479",
    "end": "287520"
  },
  {
    "text": "network on our research goal of today is then okay we have a VPN client it's",
    "start": "287520",
    "end": "293280"
  },
  {
    "text": "configured to send encrypted to send all the traffic through this uh VPN tunnel",
    "start": "293280",
    "end": "299080"
  },
  {
    "text": "but can we somehow trick the client into sending traffic outside of that VPN tunnel and of course the answer is going",
    "start": "299080",
    "end": "306199"
  },
  {
    "text": "to be yes so then the question is how were we able to do that on to explain",
    "start": "306199",
    "end": "312720"
  },
  {
    "text": "our texts I'm first going to explain how an ordinary or at least the most common",
    "start": "312720",
    "end": "318880"
  },
  {
    "text": "VPN client will configure the routing table of the operating system and here",
    "start": "318880",
    "end": "324639"
  },
  {
    "text": "you see the full output of a Linux machine when it is connected to a VPN tunnel now we don't need to know all the",
    "start": "324639",
    "end": "332039"
  },
  {
    "text": "details of the output here we can actually simplify these three lines a little bit so let me explain the",
    "start": "332039",
    "end": "338600"
  },
  {
    "text": "simplification here basically let's assume that you are connected to your VPN server then you will have on this is",
    "start": "338600",
    "end": "347360"
  },
  {
    "text": "for the most common VPN clients you can have VPN clients that act uh or are",
    "start": "347360",
    "end": "352800"
  },
  {
    "text": "configured a bit differently but this is a very common case that we observed in practice so you first have your main",
    "start": "352800",
    "end": "359680"
  },
  {
    "text": "routing rule where you basically say by default all the traffic has to be sent",
    "start": "359680",
    "end": "365199"
  },
  {
    "text": "through the virtual ton zero network interface on this stun zero network",
    "start": "365199",
    "end": "370800"
  },
  {
    "text": "interface basically represents the encrypted VPN tunnel so by default",
    "start": "370800",
    "end": "375840"
  },
  {
    "text": "everything will be sent through the VPN tunnel and that of course makes sense however there are two common",
    "start": "375840",
    "end": "383840"
  },
  {
    "text": "exceptions that are added to this routing table the first one is that if you are trying to an ex is an IP address",
    "start": "383840",
    "end": "391520"
  },
  {
    "text": "within range of the local network then quite some VPN clients will",
    "start": "391520",
    "end": "397160"
  },
  {
    "text": "allow you to directly access the local network without sending that traffic through the VPN tunnel there can be good",
    "start": "397160",
    "end": "404199"
  },
  {
    "text": "reasons to do that because this allows you to still use your local network printer while you are connected to the",
    "start": "404199",
    "end": "410160"
  },
  {
    "text": "VPN it may still allow you to share your screen over the local network as well um",
    "start": "410160",
    "end": "415919"
  },
  {
    "text": "but yeah that's a common rule if you try to access a local device in your your local network that is not sent through",
    "start": "415919",
    "end": "421520"
  },
  {
    "text": "the VPN tunnel and we will call this the local net routing",
    "start": "421520",
    "end": "426720"
  },
  {
    "text": "exception a second common exception is basically to prevent routing loops",
    "start": "426720",
    "end": "433599"
  },
  {
    "text": "and this this rule basically says if you are sending traffic to the IP address of",
    "start": "433599",
    "end": "439759"
  },
  {
    "text": "the VPN server itself then there is no need to again send that through the VPN",
    "start": "439759",
    "end": "445400"
  },
  {
    "text": "tunnel because otherwise you might get a routing Loop where you encrypt your pack you have the resulting encrypted VPN",
    "start": "445400",
    "end": "451960"
  },
  {
    "text": "packet and you don't want to again have that sent through the tunnel because yeah then the packet would never reach",
    "start": "451960",
    "end": "457000"
  },
  {
    "text": "the destination so you have this rule here at the bottom where 22 2222 is the IP",
    "start": "457000",
    "end": "463759"
  },
  {
    "text": "address of the VPN server on the IDE is that if you're sending packets to the VPN server yeah then you don't have to",
    "start": "463759",
    "end": "470560"
  },
  {
    "text": "again send them through the encrypted tunnel because those packets are already going to the VPN",
    "start": "470560",
    "end": "476560"
  },
  {
    "text": "server so that's the first part of the background that's important the second thing that is important on that we will",
    "start": "476560",
    "end": "483360"
  },
  {
    "text": "assume today is that once the VPN client has established a connection it will",
    "start": "483360",
    "end": "488960"
  },
  {
    "text": "also configure a secure DNS server and why is that important well because by",
    "start": "488960",
    "end": "495560"
  },
  {
    "text": "default if you didn't explicitly change the configuration of your uh network of",
    "start": "495560",
    "end": "501479"
  },
  {
    "text": "yeah of your operating system then by default if you connect for example to a wireless network it will be the local",
    "start": "501479",
    "end": "508919"
  },
  {
    "text": "network that will tell you which DNS server you have to use and that also means that if",
    "start": "508919",
    "end": "515200"
  },
  {
    "text": "you're connected to a malicious Wi-Fi network it is actually the Wi-Fi network that will tell you oh hey you can use my",
    "start": "515200",
    "end": "521719"
  },
  {
    "text": "DNS server so by default you should not trust the DNS server that is automatically assigned and we will",
    "start": "521719",
    "end": "528440"
  },
  {
    "text": "assume that the VPN client once the VPN client has connected will configure a",
    "start": "528440",
    "end": "533480"
  },
  {
    "text": "secure DNS server and we will also assume that all the DNS requests are are",
    "start": "533480",
    "end": "539360"
  },
  {
    "text": "sent over this encrypted on authenticated DNS tunnel now that does mean that before",
    "start": "539360",
    "end": "546240"
  },
  {
    "text": "the client has established the VPN tunnel before that it will have to use",
    "start": "546240",
    "end": "551880"
  },
  {
    "text": "this insecure uh DNS server set by the client at least that will be one of our",
    "start": "551880",
    "end": "557680"
  },
  {
    "text": "assumption in the second attack that I will explain and for the rest we also",
    "start": "557680",
    "end": "563079"
  },
  {
    "text": "assume that the VPN client is uh secure against all other attacks that are currently known",
    "start": "563079",
    "end": "570040"
  },
  {
    "text": "so how does our first attack now work well let me illustrate this using the",
    "start": "570040",
    "end": "575560"
  },
  {
    "text": "following diagram so we have the victim here on the left which can for example",
    "start": "575560",
    "end": "581079"
  },
  {
    "text": "be a smartphone we have the VPN server that the victim will eventually connect to",
    "start": "581079",
    "end": "586959"
  },
  {
    "text": "here I have represented that by the server at IP address 2222 and the goal of the attacker will",
    "start": "586959",
    "end": "594800"
  },
  {
    "text": "be to intercept traffic to the website target.com and yeah maybe a fun remark",
    "start": "594800",
    "end": "601360"
  },
  {
    "text": "while I was making this research I actually picked Target as a neutral name of a website it is only afterward once I",
    "start": "601360",
    "end": "608040"
  },
  {
    "text": "released the work that the target.com store from the US emailed me saying hey please don't use our domain name in your",
    "start": "608040",
    "end": "615200"
  },
  {
    "text": "examples uh unfortunately I already used them but yeah just a small note but yeah",
    "start": "615200",
    "end": "621320"
  },
  {
    "text": "the goal will be to intercept traffic to the example website target.com which we will just assume is",
    "start": "621320",
    "end": "627880"
  },
  {
    "text": "now operating at I address 1 2 3 4 and what will be our threat model well",
    "start": "627880",
    "end": "635600"
  },
  {
    "text": "we assume in this case that the attacker is within range of the victim on that the attacker for example creates a",
    "start": "635600",
    "end": "642079"
  },
  {
    "text": "malicious Wi-Fi network so in practice you can imagine that uh the adversary is",
    "start": "642079",
    "end": "648120"
  },
  {
    "text": "sitting at the Starbucks cafe and he has his own copy of the open Starbucks",
    "start": "648120",
    "end": "654360"
  },
  {
    "text": "Network or you can actually do the same th thing here at blackhead",
    "start": "654360",
    "end": "659560"
  },
  {
    "text": "the SSID of blackhead Here is known the password is also known so I as an",
    "start": "659560",
    "end": "664720"
  },
  {
    "text": "attacker can simply set up my own copy of the WPA2 or even wpa3 Network and",
    "start": "664720",
    "end": "671360"
  },
  {
    "text": "then I would be able to intercept your traffic so that basically means if you're connected to the Wi-Fi network",
    "start": "671360",
    "end": "677399"
  },
  {
    "text": "here AR you're using a VPN um you might want to double check that these attacks",
    "start": "677399",
    "end": "682440"
  },
  {
    "text": "do not apply to you so okay that's our threat model we assume the victim is connected to the",
    "start": "682440",
    "end": "688440"
  },
  {
    "text": "malicious Wi-Fi network and what will this adversary then do what will we do",
    "start": "688440",
    "end": "694320"
  },
  {
    "text": "as a malicious Wi-Fi network well we will say that the local network is using",
    "start": "694320",
    "end": "700720"
  },
  {
    "text": "IP addresses in the range 1 two 3 and then from zero to to",
    "start": "700720",
    "end": "706240"
  },
  {
    "text": "155 and as you may notice that will mean that the target.com server which has IP",
    "start": "706240",
    "end": "713240"
  },
  {
    "text": "address 1 2 3 4 will basically fall within that local network so the trick",
    "start": "713240",
    "end": "719160"
  },
  {
    "text": "will here will be to assign public IP addresses to a local",
    "start": "719160",
    "end": "724399"
  },
  {
    "text": "network and if the client is connecting the client doesn't care the client just thinks okay I have a local network it is",
    "start": "724399",
    "end": "730680"
  },
  {
    "text": "using this IP address whatever the client will simply say Okay",
    "start": "730680",
    "end": "736839"
  },
  {
    "text": "I want to create a VPN tunnel uh with my VPN server everything will work just",
    "start": "736839",
    "end": "742399"
  },
  {
    "text": "fine the client will then configure a trusted DNS server and finally it will",
    "start": "742399",
    "end": "748160"
  },
  {
    "text": "configure its routing table to send all traffic through the encrypted VPN tunnel",
    "start": "748160",
    "end": "753720"
  },
  {
    "text": "and I guess you can already see where this is going so let's make some space",
    "start": "753720",
    "end": "760040"
  },
  {
    "text": "here we can see now that by default all traffic is sent over the encrypted VPN",
    "start": "760040",
    "end": "765360"
  },
  {
    "text": "tunnel so over this virtual ton zero interface accept traffic towards IP",
    "start": "765360",
    "end": "771760"
  },
  {
    "text": "addresses within the local network that is sent directly over e eth0 so over",
    "start": "771760",
    "end": "778240"
  },
  {
    "text": "your actual ual network connection without going through the VPN tunnel so",
    "start": "778240",
    "end": "783800"
  },
  {
    "text": "what does that mean well if I now visit any random website that traffic will go through the",
    "start": "783800",
    "end": "789760"
  },
  {
    "text": "VPN tunnel if but if I now visit target.com the victim will use its",
    "start": "789760",
    "end": "795120"
  },
  {
    "text": "secure DNS server to look up the IP address Associated to target.com it will learn okay that IP",
    "start": "795120",
    "end": "801920"
  },
  {
    "text": "address is one 2 3 4 and then the client will realize oh wait 1 2 3 4 that IP",
    "start": "801920",
    "end": "807600"
  },
  {
    "text": "address is in my noal Network I can actually just send it directly without",
    "start": "807600",
    "end": "812639"
  },
  {
    "text": "going through the VPN tunnel and basically that is the attack you can now intercept traffic of the victim and if",
    "start": "812639",
    "end": "820000"
  },
  {
    "text": "you want you can also configure the local network to be larger so in this case I advertised uh sl24 subnet but if",
    "start": "820000",
    "end": "828360"
  },
  {
    "text": "you want you can make that subnet bigger and then intercept more",
    "start": "828360",
    "end": "833399"
  },
  {
    "text": "traffic you may now be wondering okay this is actually a fairly straightforward attack did this really working in practice and we did close to",
    "start": "833399",
    "end": "842040"
  },
  {
    "text": "200 experiments uh together with my colleagues and just to zoom in a little bit uh about what we did so if you want",
    "start": "842040",
    "end": "849560"
  },
  {
    "text": "you can view this complete overview in our paper but basically what we did is",
    "start": "849560",
    "end": "854600"
  },
  {
    "text": "we tested several operating systems so we tested Windows Mac OS Android iOS uh",
    "start": "854600",
    "end": "860560"
  },
  {
    "text": "Linux and so on we then tested various uh VPN clients",
    "start": "860560",
    "end": "866959"
  },
  {
    "text": "so we tested both free clients on uh Android and iOS we also tested paid",
    "start": "866959",
    "end": "873720"
  },
  {
    "text": "clients and we also tested some built-in clients of uh Android and Windows and so",
    "start": "873720",
    "end": "879480"
  },
  {
    "text": "on itself and yeah the attack worked against a lot of uh",
    "start": "879480",
    "end": "886320"
  },
  {
    "text": "implementations there are sometimes a few special cases where you need to apply a variant of the attack and I will",
    "start": "886320",
    "end": "892279"
  },
  {
    "text": "come back to that in a bit but if we look at the summary of the results we basically have the following",
    "start": "892279",
    "end": "899480"
  },
  {
    "text": "overview and what we can see here at the bottom is that basically every single",
    "start": "899480",
    "end": "906000"
  },
  {
    "text": "VPN app on iOS was vulnerable to the attack and this is very surprising and I",
    "start": "906000",
    "end": "913680"
  },
  {
    "text": "will explain a bit later why this is the case Mac OS was not much better there",
    "start": "913680",
    "end": "920560"
  },
  {
    "text": "were a few vpns that prevented this attack uh and then finally and this is",
    "start": "920560",
    "end": "926360"
  },
  {
    "text": "quite notable Android was uh here the best situation against Android",
    "start": "926360",
    "end": "932720"
  },
  {
    "text": "about 20% of the VPN apps were vulnerable in their default configuration at least so on one hand",
    "start": "932720",
    "end": "939800"
  },
  {
    "text": "Android is doing a lot better on the other hand 20% is still a large",
    "start": "939800",
    "end": "945160"
  },
  {
    "text": "number on the reason why Android is doing better in our opinion it likely is",
    "start": "945160",
    "end": "951720"
  },
  {
    "text": "because Android has a more stable API to configure a VPN server uh sorry a VPN",
    "start": "951720",
    "end": "959199"
  },
  {
    "text": "client meaning on Android it's easier for programs to basically securely configure your VPN connection an Android",
    "start": "959199",
    "end": "966920"
  },
  {
    "text": "you really explicitly need to uh call an API function to allow local network",
    "start": "966920",
    "end": "973079"
  },
  {
    "text": "access and if you don't do that local network access will by default be blocked and we think that is a case why",
    "start": "973079",
    "end": "979680"
  },
  {
    "text": "Android is more secure now before I go into a bit more detail about um this attack let me show",
    "start": "979680",
    "end": "988639"
  },
  {
    "text": "a quick demo of that Tech so the idea here will be that we are going to set up",
    "start": "988639",
    "end": "995199"
  },
  {
    "text": "a malicious Wi-Fi network and we're then going to intercept the traffic in this case to the website of NYU and on top of",
    "start": "995199",
    "end": "1003480"
  },
  {
    "text": "that we're also going to remove the https protection of the NYU website as well because NYU was not really a",
    "start": "1003480",
    "end": "1010240"
  },
  {
    "text": "securely configured website so the first thing that we do as",
    "start": "1010240",
    "end": "1015480"
  },
  {
    "text": "an attacker is that we create a malicious Wi-Fi network Network here I called it test Network and in this case",
    "start": "1015480",
    "end": "1022240"
  },
  {
    "text": "I'm going to say okay I want to intercept traffic to nyu.edu so the tool",
    "start": "1022240",
    "end": "1027319"
  },
  {
    "text": "will then assure that a local network is created on that the IP address of nyu.edu will fall within that local",
    "start": "1027319",
    "end": "1035880"
  },
  {
    "text": "network as a victim we can then connect to this wi-fi network the victim can",
    "start": "1035880",
    "end": "1041760"
  },
  {
    "text": "then also enable the VPN and everything will work properly so the client can",
    "start": "1041760",
    "end": "1048720"
  },
  {
    "text": "successfully connect on interet access will also work",
    "start": "1048720",
    "end": "1054400"
  },
  {
    "text": "so this is the website of our University it loads properly but if I then visit",
    "start": "1054400",
    "end": "1059520"
  },
  {
    "text": "nyu.edu then you will first and for all notice if you watch very carefully that it was",
    "start": "1059520",
    "end": "1066679"
  },
  {
    "text": "not using https and that means if I now log in the adversary will have actually",
    "start": "1066679",
    "end": "1072919"
  },
  {
    "text": "intercepted the traffic so let me briefly pause this here you can now see",
    "start": "1072919",
    "end": "1078400"
  },
  {
    "text": "the traffic that was leaked outside the VPN tunnel when the user was trying to log in on top of that the attacker was",
    "start": "1078400",
    "end": "1087080"
  },
  {
    "text": "running uh SSL strip on basically the very first HTTP request that is sent",
    "start": "1087080",
    "end": "1093720"
  },
  {
    "text": "when you visit nyu.edu is sent over plain text HTTP on at that point",
    "start": "1093720",
    "end": "1099600"
  },
  {
    "text": "attacker can just pretend okay the NYU website just doesn't support https just",
    "start": "1099600",
    "end": "1104640"
  },
  {
    "text": "keep using plain text HTTP and that was also how the add adversary was then able to intercept the HTTP traffic as well so",
    "start": "1104640",
    "end": "1112480"
  },
  {
    "text": "basically the NYU uh website was insecurely configured and if we now look",
    "start": "1112480",
    "end": "1118600"
  },
  {
    "text": "at the details we can indeed then see that uh the username and password of the",
    "start": "1118600",
    "end": "1124360"
  },
  {
    "text": "victim was intercepted now that being said most browsers these days will give a warning",
    "start": "1124360",
    "end": "1131159"
  },
  {
    "text": "if you're not using htps it will explicitly say you're using an insecure",
    "start": "1131159",
    "end": "1136400"
  },
  {
    "text": "uh connection but even when https is being used you will still be able to see",
    "start": "1136400",
    "end": "1142880"
  },
  {
    "text": "as an adversary which websites are being visited so in this case I can for",
    "start": "1142880",
    "end": "1147919"
  },
  {
    "text": "example display this server name indication that is sent in plain text in the TLs handshake and if I then visit",
    "start": "1147919",
    "end": "1155360"
  },
  {
    "text": "the website that you don't want me to know that you're visiting I can actually just look in wire shark and then I will",
    "start": "1155360",
    "end": "1163480"
  },
  {
    "text": "actually be able to see the domain name you're visiting even though you're using htps so here for example I am showing",
    "start": "1163480",
    "end": "1170400"
  },
  {
    "text": "here all the server name indications that are sent in plain text um while you",
    "start": "1170400",
    "end": "1176720"
  },
  {
    "text": "are using the VPN so basically to recap our attack here tricked the victim into",
    "start": "1176720",
    "end": "1182919"
  },
  {
    "text": "sending traffic outside the encrypted VPN tunnel and even if you use https you can clearly see in wire shark it's quite",
    "start": "1182919",
    "end": "1190039"
  },
  {
    "text": "easy to get the domain names being",
    "start": "1190039",
    "end": "1194279"
  },
  {
    "text": "contacted so as I mentioned there were a few special cases where the default",
    "start": "1197240",
    "end": "1202640"
  },
  {
    "text": "attack didn't immediate didn't immediately apply again some clients we noticed that they do not allow traffic",
    "start": "1202640",
    "end": "1210080"
  },
  {
    "text": "to the local network instead what they did is they blocked all traffic to the",
    "start": "1210080",
    "end": "1215559"
  },
  {
    "text": "network to the local network on the way they did this is that they basically blocked traffic to all",
    "start": "1215559",
    "end": "1222400"
  },
  {
    "text": "the IP addresses that were part of the local network but this can be a problem if your local network is using public IP",
    "start": "1222400",
    "end": "1228840"
  },
  {
    "text": "addresses because then the VPN VPN client was blocking traffic to these public IP addresses that the local",
    "start": "1228840",
    "end": "1235679"
  },
  {
    "text": "network happened to use so in this case as an attacker you can for example use",
    "start": "1235679",
    "end": "1241679"
  },
  {
    "text": "uh public range of IP addresses for your local network that cor for example",
    "start": "1241679",
    "end": "1248320"
  },
  {
    "text": "corresponds to uh the update servers of Microsoft and then when you are",
    "start": "1248320",
    "end": "1253360"
  },
  {
    "text": "connected to the VPN the VPN would basically block traffic to the update server",
    "start": "1253360",
    "end": "1260120"
  },
  {
    "text": "servers a second possibility or that we a second strange behavior that we",
    "start": "1260200",
    "end": "1265280"
  },
  {
    "text": "basically noticed in practice is that a small selection of VPN clients they",
    "start": "1265280",
    "end": "1271000"
  },
  {
    "text": "configured their own DNS server on that DNS server was not returning the real IP",
    "start": "1271000",
    "end": "1276279"
  },
  {
    "text": "addresses Associated to a domain that was actually returning so-called special",
    "start": "1276279",
    "end": "1281600"
  },
  {
    "text": "use IP addresses and these are IP addresses that are normally not routed over the Internet so it was spoofing DNS",
    "start": "1281600",
    "end": "1289559"
  },
  {
    "text": "uh responses however internet connection still worked fine so it seemed as if the",
    "start": "1289559",
    "end": "1295320"
  },
  {
    "text": "VPN server was uh rerouting the traffic to these special use IP addresses to the",
    "start": "1295320",
    "end": "1300720"
  },
  {
    "text": "actual real IP address and we're not completely sure why this is done maybe this was a some",
    "start": "1300720",
    "end": "1307760"
  },
  {
    "text": "kind of counter measure that if traffic got leaked that that leaked traffic will use special used IP addresses so that it",
    "start": "1307760",
    "end": "1314840"
  },
  {
    "text": "doesn't get routed over the internet but basically the thing I want to mention here that even with the special behavior",
    "start": "1314840",
    "end": "1321000"
  },
  {
    "text": "our attack still worked because we can then advertise these special use IP",
    "start": "1321000",
    "end": "1326760"
  },
  {
    "text": "addresses in the local network and then yeah the attack still worked fine the other thing that I know now",
    "start": "1326760",
    "end": "1333720"
  },
  {
    "text": "want to discuss is the iOS case so you saw in the previous overview that",
    "start": "1333720",
    "end": "1339120"
  },
  {
    "text": "basically every VPN was vulnerable on iOS and why was that the case well iOS",
    "start": "1339120",
    "end": "1348520"
  },
  {
    "text": "in older versions by default allowed access to the local network on from IOS",
    "start": "1348520",
    "end": "1356000"
  },
  {
    "text": "14 there is a parameter that you can use to basically force all traffic over the",
    "start": "1356000",
    "end": "1362720"
  },
  {
    "text": "VPN tunnel and this is this parameter include all networks and if you set that",
    "start": "1362720",
    "end": "1369279"
  },
  {
    "text": "parameter and then also set the parameter exclude local networks to false in that case the VPN client will",
    "start": "1369279",
    "end": "1376480"
  },
  {
    "text": "not be vulnerable because then all traffic even traffic to IP addresses",
    "start": "1376480",
    "end": "1382320"
  },
  {
    "text": "within the local network will be sent over the encrypted VPN tunnel however during the disclosure we",
    "start": "1382320",
    "end": "1389279"
  },
  {
    "text": "saw a lot of um VPN companies say yes we were we were aware of these parameters",
    "start": "1389279",
    "end": "1395799"
  },
  {
    "text": "but we found that using them at least on older iOS version versions causes the",
    "start": "1395799",
    "end": "1401120"
  },
  {
    "text": "VPN clients to be unreliable and this is why VPN vendors were very hesitant to",
    "start": "1401120",
    "end": "1406679"
  },
  {
    "text": "enable these API uh this API functionality now I want to give a bit",
    "start": "1406679",
    "end": "1412880"
  },
  {
    "text": "of extra context here it was actually already a bit known that iOS was quite insecure with their VPN clients because",
    "start": "1412880",
    "end": "1420240"
  },
  {
    "text": "there were already previous attacks that showed that VPN on iOS can sometimes leak traffic so in a sense it shouldn't",
    "start": "1420240",
    "end": "1428039"
  },
  {
    "text": "be surprising that uh iOS at least with regards to their vpns uh is insecure",
    "start": "1428039",
    "end": "1433440"
  },
  {
    "text": "with our attack as well what was also very interesting is",
    "start": "1433440",
    "end": "1439080"
  },
  {
    "text": "that after our disclosure we became aware of a uh a little known blog post",
    "start": "1439080",
    "end": "1446320"
  },
  {
    "text": "by Andrew a that basically he basically wrote a guide on how you can securely",
    "start": "1446320",
    "end": "1452200"
  },
  {
    "text": "configure your VPN client when you're attending defcom and what was interesting is that he was actually",
    "start": "1452200",
    "end": "1458400"
  },
  {
    "text": "hinting at the attack we just discovered today and if you would you follow his advice you would actually be immune",
    "start": "1458400",
    "end": "1464919"
  },
  {
    "text": "against the attack that we just discovered unfortunately this guide didn't uh receive a lot of attention",
    "start": "1464919",
    "end": "1473720"
  },
  {
    "text": "um and even though the attack was uh suggested there was unfortunately not",
    "start": "1473720",
    "end": "1478799"
  },
  {
    "text": "yet an extensive evaluation of the attack and basically this work was not picked up and we as a community uh",
    "start": "1478799",
    "end": "1485039"
  },
  {
    "text": "missed it on forgot about this but yeah the interesting thing is that we were actually warned about this attack um but",
    "start": "1485039",
    "end": "1492480"
  },
  {
    "text": "unfortunately as we saw a lot of VPN clients are vulnerable and even if we would use this this guide then there",
    "start": "1492480",
    "end": "1499080"
  },
  {
    "text": "might be a risk that you would be vulnerable to our second attack on that second attack is called the server IP",
    "start": "1499080",
    "end": "1506000"
  },
  {
    "text": "attacks and how does the second attack work well we again have the same threat",
    "start": "1506000",
    "end": "1511200"
  },
  {
    "text": "model so we have our VPN server for Simplicity we're again going to assume that the adversary is a malicious Wi-Fi",
    "start": "1511200",
    "end": "1518679"
  },
  {
    "text": "network and what will the adversary now do well we will first and for all assume",
    "start": "1518679",
    "end": "1526120"
  },
  {
    "text": "that the victim will use plain text DNS to look up the IP address",
    "start": "1526120",
    "end": "1531399"
  },
  {
    "text": "of their VPN server so in this case you can have yeah the client will send a DNS request for vpn.com for example and then",
    "start": "1531399",
    "end": "1539679"
  },
  {
    "text": "we as a malicious access point can spoof the resulting DNS response we can",
    "start": "1539679",
    "end": "1545399"
  },
  {
    "text": "basically pretend oh your VPN server yeah it's actually at IP address 1234",
    "start": "1545399",
    "end": "1551000"
  },
  {
    "text": "instead of the real IP address [Music] 2222 on the VPN client won't notice that",
    "start": "1551000",
    "end": "1558080"
  },
  {
    "text": "because at this point it has not yet established a secure VPN tunnel so at this point it's still using the DNS",
    "start": "1558080",
    "end": "1565120"
  },
  {
    "text": "server that is provided by the malicious Wi-Fi network and it will now try to create a",
    "start": "1565120",
    "end": "1571080"
  },
  {
    "text": "VPN tunnel the client will try to connect with this spoofed IP address 1 12",
    "start": "1571080",
    "end": "1577320"
  },
  {
    "text": "34 but we as an adversary can then redirect that traffic to the real VPN server on this is basically the same as",
    "start": "1577320",
    "end": "1585120"
  },
  {
    "text": "converting private IP addresses in a local network to the public IP address of uh your that you were assigned by the",
    "start": "1585120",
    "end": "1591240"
  },
  {
    "text": "ISP so basically the client won't notice that you're rewriting this IP address of",
    "start": "1591240",
    "end": "1597080"
  },
  {
    "text": "the package to the real IP address on the client will successfully establish the VPN tunnel it will then configure a",
    "start": "1597080",
    "end": "1604320"
  },
  {
    "text": "securely untrusted DNS server but in a sense by then the damage is done because",
    "start": "1604320",
    "end": "1609679"
  },
  {
    "text": "it will still use the ip1 1234 for the VPN server and it will now use the",
    "start": "1609679",
    "end": "1615880"
  },
  {
    "text": "following routing table and here you can see the problem by",
    "start": "1615880",
    "end": "1621840"
  },
  {
    "text": "default the VPN client will now send everything over t zero which represents the encrypted VPN tunnel accept traffic",
    "start": "1621840",
    "end": "1630279"
  },
  {
    "text": "to the VPN server itself that is sent directly to the VPN server the",
    "start": "1630279",
    "end": "1635679"
  },
  {
    "text": "Assumption was that we don't need to encrypt that traffic again but yeah we were now able to spoof that IP address 1",
    "start": "1635679",
    "end": "1642520"
  },
  {
    "text": "2 3 4 so basically as an adversary we now control that rule in the routing",
    "start": "1642520",
    "end": "1648720"
  },
  {
    "text": "table and what does that mean in practice well if the victim now visits a random",
    "start": "1648720",
    "end": "1654559"
  },
  {
    "text": "website then that will be sent over the encrypted the uh VPN tunnel but if we",
    "start": "1654559",
    "end": "1660080"
  },
  {
    "text": "now visit the website target.com the client will use its uh secure untrusted DNS server to look up",
    "start": "1660080",
    "end": "1667320"
  },
  {
    "text": "the IP address of target.com it will get 1 2 3 4 as a",
    "start": "1667320",
    "end": "1672480"
  },
  {
    "text": "result and when the victim then tries to contact the IP address 1234 it will look",
    "start": "1672480",
    "end": "1678080"
  },
  {
    "text": "at its routing table and it will see oh if I want to contact the IP address 1 2 34 I don't need to send that over to and",
    "start": "1678080",
    "end": "1685279"
  },
  {
    "text": "crypted VPN tunnel I can just directly send that traffic meaning we as an",
    "start": "1685279",
    "end": "1690320"
  },
  {
    "text": "adversary can then intercept the traffic so we again tested uh quite a",
    "start": "1690320",
    "end": "1697840"
  },
  {
    "text": "lot of VPN clients and our finding was that in this case most iOS on Android",
    "start": "1697840",
    "end": "1704399"
  },
  {
    "text": "VPN clients were in fact secure and this is because they typically",
    "start": "1704399",
    "end": "1709559"
  },
  {
    "text": "either hardcoded the IP address of the VPN server into their app or they used https or uh DNS over TLS uh to securely",
    "start": "1709559",
    "end": "1719080"
  },
  {
    "text": "get the IP address of the VPN server however for many built-in uh VPN",
    "start": "1719080",
    "end": "1725399"
  },
  {
    "text": "clients of for example Windows Mac OS on Linux this attack was successful because",
    "start": "1725399",
    "end": "1731760"
  },
  {
    "text": "by default these built-in VPN clients indeed used plain text DNS to get the",
    "start": "1731760",
    "end": "1737399"
  },
  {
    "text": "the IP address of the VPN server and also the Legacy uh built-in VPN client",
    "start": "1737399",
    "end": "1743120"
  },
  {
    "text": "of Android 11 on Lower was also vulnerable but the newer built-in VPN of",
    "start": "1743120",
    "end": "1750200"
  },
  {
    "text": "Android 12 on the buff is not vulnerable against this attack now one limitation of this attack",
    "start": "1750200",
    "end": "1757960"
  },
  {
    "text": "is that you're only able to intercept traffic towards a single IP address and then you may be wondering yeah is that",
    "start": "1757960",
    "end": "1764760"
  },
  {
    "text": "useful at all because you then need to know in advance which website or server a user is",
    "start": "1764760",
    "end": "1771200"
  },
  {
    "text": "communicating with and we basically have a little trick to make our attack more impactful",
    "start": "1771200",
    "end": "1779200"
  },
  {
    "text": "what you can do with intercepting traffic towards a single IP address is to use that to then intercept basically",
    "start": "1779200",
    "end": "1785519"
  },
  {
    "text": "all the DNS traffic of the victim so even though you can only intercept the",
    "start": "1785519",
    "end": "1791039"
  },
  {
    "text": "traffic towards one single IP address you can use that to then intercept DNS",
    "start": "1791039",
    "end": "1796399"
  },
  {
    "text": "traffic and if the victim is then using PL Tex DNS you can then basically intercept the",
    "start": "1796399",
    "end": "1802399"
  },
  {
    "text": "pl Tex DNS on spoof your DNS responses and then you can basically intercept",
    "start": "1802399",
    "end": "1807559"
  },
  {
    "text": "most traffic if you want or alternatively you can just repeat the attack uh with different IP address",
    "start": "1807559",
    "end": "1814799"
  },
  {
    "text": "addresses by making the VPN by making the victim reconnect so I will again show a demo of",
    "start": "1814799",
    "end": "1822640"
  },
  {
    "text": "this and in this demo what I'm going to do here is I'm going to intercept",
    "start": "1822640",
    "end": "1828279"
  },
  {
    "text": "traffic towards a single IP address on the goal of the attack in this case is to on one hand leak traffic towards that",
    "start": "1828279",
    "end": "1835640"
  },
  {
    "text": "IP address but to then also block that IP address basically we assume that the",
    "start": "1835640",
    "end": "1841440"
  },
  {
    "text": "victim is using some kind of security camera in their home and even though the",
    "start": "1841440",
    "end": "1846799"
  },
  {
    "text": "victim is using the VPN on their smartphone we want to block the traffic",
    "start": "1846799",
    "end": "1851840"
  },
  {
    "text": "to the web server to the Cloud Server of that security camera so that the user will not re receive any warnings if",
    "start": "1851840",
    "end": "1858799"
  },
  {
    "text": "motion was detected so let's start this demo so we again first create our Wi-Fi",
    "start": "1858799",
    "end": "1866840"
  },
  {
    "text": "network here so in this case we assume that we know that the victim is using",
    "start": "1866840",
    "end": "1872519"
  },
  {
    "text": "for example uh VPN server at K.B so we're going to spoof the DNS uh of this",
    "start": "1872519",
    "end": "1879559"
  },
  {
    "text": "domain and instead of turning the real IP address we're going to return the following IP address here so 52 on so on",
    "start": "1879559",
    "end": "1887240"
  },
  {
    "text": "on this IP address represents the IP address of the cloud service uh of the",
    "start": "1887240",
    "end": "1892679"
  },
  {
    "text": "security camera so let's continue the",
    "start": "1892679",
    "end": "1898279"
  },
  {
    "text": "video so the script will now create this wi-fi network we can then assume that in this",
    "start": "1898480",
    "end": "1905279"
  },
  {
    "text": "case yeah as an example I simply assumed that the victim is using Android it will",
    "start": "1905279",
    "end": "1911039"
  },
  {
    "text": "connect to the Wi-Fi network the victim even though it's now",
    "start": "1911039",
    "end": "1917399"
  },
  {
    "text": "connecting to the wrong IP address the VPN connection will be successfully",
    "start": "1917399",
    "end": "1922880"
  },
  {
    "text": "established and it will seem as if internet is working properly so I can",
    "start": "1922880",
    "end": "1927960"
  },
  {
    "text": "for example visit Google I can visit the website of our research group it seems",
    "start": "1927960",
    "end": "1934159"
  },
  {
    "text": "that all of the internet is working reliably so the user will probably think okay my security camera is also working",
    "start": "1934159",
    "end": "1942080"
  },
  {
    "text": "but if I now walk past the security camera you will see that Android does not dis display a warning because even",
    "start": "1942080",
    "end": "1949559"
  },
  {
    "text": "though all other traffic seems to work reliably because I can visit websites",
    "start": "1949559",
    "end": "1956960"
  },
  {
    "text": "the connection to our cloud provider of the security camera is blocked on this",
    "start": "1956960",
    "end": "1962600"
  },
  {
    "text": "only after the victim now switches to a different Wi-Fi network where the attack",
    "start": "1962600",
    "end": "1968120"
  },
  {
    "text": "is no longer ongoing that the user will then be able to establish a connection with the Cloud Server again and only",
    "start": "1968120",
    "end": "1974880"
  },
  {
    "text": "then will we get the warning here that motion was detected so this shows that uh traffic",
    "start": "1974880",
    "end": "1982679"
  },
  {
    "text": "was indeed leaked outside the VPN tunnel and in this case instead of monitoring",
    "start": "1982679",
    "end": "1987840"
  },
  {
    "text": "that traffic we just blocked",
    "start": "1987840",
    "end": "1991200"
  },
  {
    "text": "it and this is um important to realize in practice because I think previously a",
    "start": "1993240",
    "end": "1998440"
  },
  {
    "text": "lot of people assumed that yeah if you're connected to the VPN client to the VPN server then all traffic will go",
    "start": "1998440",
    "end": "2004240"
  },
  {
    "text": "through the VPN server so surely all my apps work but with this app you can now selectively with this attack you can now",
    "start": "2004240",
    "end": "2011080"
  },
  {
    "text": "selectively leak but then also block",
    "start": "2011080",
    "end": "2015720"
  },
  {
    "text": "traffic okay so how can we now defend against this attack well the first thing you can do to block the first attack is",
    "start": "2017760",
    "end": "2024720"
  },
  {
    "text": "to just disable local network access that's one option or you can do it more fine grained you can decide to disable",
    "start": "2024720",
    "end": "2032159"
  },
  {
    "text": "access to the local network if that local network is using public IP addresses",
    "start": "2032159",
    "end": "2038760"
  },
  {
    "text": "to defend against the second attack the server IP attack ideally the VPN client is implemented in such a way so that all",
    "start": "2038760",
    "end": "2046960"
  },
  {
    "text": "traffic is sent over the encrypted VPN connection except packets generated by the VPN process itself so instead of",
    "start": "2046960",
    "end": "2054839"
  },
  {
    "text": "relying on the destination IP address you want to rely on do your filtering",
    "start": "2054839",
    "end": "2059919"
  },
  {
    "text": "based on the process that generated the traffic on on Linux you can use policy based routing for this",
    "start": "2059919",
    "end": "2068040"
  },
  {
    "text": "if fixing the VPN client in this manner is hard one uh",
    "start": "2068040",
    "end": "2073720"
  },
  {
    "text": "more temporarily but still reliable solution is to basically make the VPN",
    "start": "2073720",
    "end": "2079200"
  },
  {
    "text": "client use a secure DNS so DNS over TLS for example uh to get the VPN server's",
    "start": "2079200",
    "end": "2085000"
  },
  {
    "text": "IP address or just to hardcode the IP address of the VPN server that would also stop the attack we had in",
    "start": "2085000",
    "end": "2094200"
  },
  {
    "text": "mind so with that I come to the conclusion we basically found two",
    "start": "2094200",
    "end": "2099280"
  },
  {
    "text": "widespread what we consider design flaws in VPN clients in hindsight the attack",
    "start": "2099280",
    "end": "2105560"
  },
  {
    "text": "is not that difficult but surprisingly a large percentage of the tested clients was vulnerable and we believe this is",
    "start": "2105560",
    "end": "2112920"
  },
  {
    "text": "caused by a bad integration of the VPN client into the operating system because we never broke the VPN protocol itself",
    "start": "2112920",
    "end": "2120160"
  },
  {
    "text": "we never broke any crypto or anything so the defense is then to more carefully configure the routing tables and I think",
    "start": "2120160",
    "end": "2127440"
  },
  {
    "text": "what would also help is if the OS would provide a API to make it very easy to configure your VPN client because that",
    "start": "2127440",
    "end": "2134839"
  },
  {
    "text": "is what Android provided and we noticed that Android was much more secure so with that I thank you for your",
    "start": "2134839",
    "end": "2141800"
  },
  {
    "text": "attention and if you have any questions please",
    "start": "2141800",
    "end": "2146040"
  },
  {
    "text": "ask can I okay uh I have one question because we're playing a little bit with uh fake BTS and and snatching the GSM uh",
    "start": "2150800",
    "end": "2159599"
  },
  {
    "text": "GSM connection uh did you try it also on the uh on the mobile networks because uh",
    "start": "2159599",
    "end": "2166599"
  },
  {
    "text": "I saw it as a prerequisite was a man in the middle uh attack on the Wi-Fi which is relatively easy uh on the mobile",
    "start": "2166599",
    "end": "2173599"
  },
  {
    "text": "networks is slightly different I can imagine modifying it using the uh Virtual Router on the open BTS and using",
    "start": "2173599",
    "end": "2181319"
  },
  {
    "text": "routing tables there but did you try anything like that because that might be much much more dangerous so we did not",
    "start": "2181319",
    "end": "2187599"
  },
  {
    "text": "try this ourself um I think it might be interesting to test",
    "start": "2187599",
    "end": "2192680"
  },
  {
    "text": "and I'm I'm not that much of an expert at cellular networks so it depends on",
    "start": "2192680",
    "end": "2198200"
  },
  {
    "text": "how exactly it assigns IP addresses um but I think there might be a chance that",
    "start": "2198200",
    "end": "2203440"
  },
  {
    "text": "some variant of attack might also apply against a cellular network um it would be in interesting to to just test I",
    "start": "2203440",
    "end": "2210160"
  },
  {
    "text": "think you need to install the Virtual Router on the on open BTS or the fake BTS because otherwise you assigned the",
    "start": "2210160",
    "end": "2215960"
  },
  {
    "text": "IP addresses by the by the mobile provider but yeah I think as long as you have a small um so for the first attack",
    "start": "2215960",
    "end": "2222319"
  },
  {
    "text": "the local network attack I think there it depends if yeah the the client has actually assigned some kind of small",
    "start": "2222319",
    "end": "2228000"
  },
  {
    "text": "local network I don't know that on the other hand the second attack the server IP attack um I'm my hunch is high that",
    "start": "2228000",
    "end": "2235520"
  },
  {
    "text": "you can then spoof DNS replies so the second attack should actually work I think yeah",
    "start": "2235520",
    "end": "2242720"
  },
  {
    "text": "thanks any other questions",
    "start": "2243119",
    "end": "2248280"
  },
  {
    "text": "no if not if you still have questions you can also come to me after the talk I'll be here still for a minute or two",
    "start": "2248280",
    "end": "2255160"
  },
  {
    "text": "so thank you again for your attention",
    "start": "2255160",
    "end": "2262880"
  }
]