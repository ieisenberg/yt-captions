[
  {
    "text": "all right guys welcome I hope everybody had a good lunch nice delicious hearty",
    "start": "440",
    "end": "6640"
  },
  {
    "text": "lunch um all right so this is uh attacking proximity card access systems or using dpace to open doors um my name",
    "start": "6640",
    "end": "14719"
  },
  {
    "text": "is Brad hi how you doing I'm not an alcoholic uh except last",
    "start": "14719",
    "end": "21279"
  },
  {
    "text": "night um so I work for foundstone it's a good lead in right uh I I work for",
    "start": "21279",
    "end": "26880"
  },
  {
    "text": "foundstone as part of their open security research project and so basically that lets me like most of you",
    "start": "26880",
    "end": "32680"
  },
  {
    "text": "guys play around with cool stuff and tell other people about it and so as part of that we use that to enhance our",
    "start": "32680",
    "end": "38360"
  },
  {
    "text": "internal methodologies and all that kind of good stuff um so that's what I'm going to talk about today one of the projects that I I took on a little while",
    "start": "38360",
    "end": "44480"
  },
  {
    "text": "ago and basically um I I started looking at you know RFID systems and uh and was",
    "start": "44480",
    "end": "51360"
  },
  {
    "text": "kind of intrigued by like how RFID worked and all that stuff and um Adam Lorry is a super uh smart guy and he",
    "start": "51360",
    "end": "57800"
  },
  {
    "text": "kind of inspired me a little bit to look at a lot of that stuff so it was cool but then I realized there's this whole system behind it it's not just the",
    "start": "57800",
    "end": "63640"
  },
  {
    "text": "reader and the card um and so uh I started to look at those systems as well",
    "start": "63640",
    "end": "69040"
  },
  {
    "text": "um and that's kind of and this talk is kind of the result of all that looking I'll show you you know um how things",
    "start": "69040",
    "end": "74680"
  },
  {
    "text": "look like uh between the card and the reader and then ultimately um all of this other stuff that exists behind it",
    "start": "74680",
    "end": "81920"
  },
  {
    "text": "um so a lot of people were wondering like what is this dpace thing man does anybody know that reference does anybody",
    "start": "81920",
    "end": "87200"
  },
  {
    "text": "know this book yeah a couple all right cool um so yeah dpace is a reference to",
    "start": "87200",
    "end": "92600"
  },
  {
    "text": "this book by Daniel Suarez um I don't get money for that although that is really big so maybe I should um it's uh",
    "start": "92600",
    "end": "99759"
  },
  {
    "text": "a book called uh Damon and it's like it's really awesome like techno like",
    "start": "99759",
    "end": "104840"
  },
  {
    "text": "cyber Punk Thriller buzzword catchy drama thing um that's happening and it's",
    "start": "104840",
    "end": "111280"
  },
  {
    "text": "a it's a really cool book actually so part of the book what they do is um all of these people that are involved in",
    "start": "111280",
    "end": "117240"
  },
  {
    "text": "this Damon network uh all get like cool uh pair of sunglasses and they see this",
    "start": "117240",
    "end": "124079"
  },
  {
    "text": "kind of alternate reality it's almost like Google Glass to a certain extent right so you get to see this augmented",
    "start": "124079",
    "end": "129160"
  },
  {
    "text": "reality around you except um in front of you you see more information about",
    "start": "129160",
    "end": "134360"
  },
  {
    "text": "what's around and uh as you build points in this world you get to control things",
    "start": "134360",
    "end": "140200"
  },
  {
    "text": "in that augmented space so it's gets really cool like you like control things move things around it's like uh kind of fun but then if you become like this",
    "start": "140200",
    "end": "147560"
  },
  {
    "text": "super powerful force um you can control things in the space that control things",
    "start": "147560",
    "end": "153640"
  },
  {
    "text": "in real life so like there's this badass guy Loki and he controls like this swarm",
    "start": "153640",
    "end": "160319"
  },
  {
    "text": "of like killer motorcycle robots and so like he's just like ah kill and then",
    "start": "160319",
    "end": "165360"
  },
  {
    "text": "like he kills a bunch of people it's great so uh but I really yeah exact",
    "start": "165360",
    "end": "171480"
  },
  {
    "text": "yes they might actually make a movie of this and I'm sure they'll do do no justice but um but I like that idea",
    "start": "171480",
    "end": "177280"
  },
  {
    "text": "right like not killing people I don't want to kill anyone I promise um but I like the idea of being able",
    "start": "177280",
    "end": "183159"
  },
  {
    "text": "like the Internet isn't real you know it's like that thing over there that I spend a lot of time on but when that can",
    "start": "183159",
    "end": "190959"
  },
  {
    "text": "interface with the real world and change things in the real world well that starts getting really cool and really",
    "start": "190959",
    "end": "197000"
  },
  {
    "text": "fun so whenever I can do that I like to do it um and so this talk is we're we're opening doors literally opening physical",
    "start": "197000",
    "end": "204040"
  },
  {
    "text": "doors over the network and so I like to think of it like that's my own dpace like except doesn't look as cool lot",
    "start": "204040",
    "end": "211319"
  },
  {
    "text": "more text um all right so this is what the architecture looks like um it's",
    "start": "211319",
    "end": "216400"
  },
  {
    "text": "really simplified uh you're probably familiar starting from right to left um with kind of the really small user with",
    "start": "216400",
    "end": "222239"
  },
  {
    "text": "the gigantic card um he talks to uh a reader and that happens over RFID right",
    "start": "222239",
    "end": "228920"
  },
  {
    "text": "and so uh then that reader takes that value that it's taken from the card and",
    "start": "228920",
    "end": "234319"
  },
  {
    "text": "formats it for this wean protocol that it then transmits to this controller and now the controll holds all of this data",
    "start": "234319",
    "end": "242120"
  },
  {
    "text": "um it basically uh doesn't know who the small user is he knows what the card",
    "start": "242120",
    "end": "247239"
  },
  {
    "text": "value is and so knows what that number is and then Associates that with doors and times to access those doors and all",
    "start": "247239",
    "end": "254000"
  },
  {
    "text": "that kind of good stuff um and he gets that data from the back end so the back end is what like you know your security",
    "start": "254000",
    "end": "260799"
  },
  {
    "text": "guards uh or like office managers or whomever um who provision the cards who say you know Brad gets this card uh",
    "start": "260799",
    "end": "268199"
  },
  {
    "text": "that's what they update and then the back end pushes data to the controller so the controller can can um allow the",
    "start": "268199",
    "end": "273759"
  },
  {
    "text": "doors to open and allow take data from readers and all that kind of good stuff um the controller can operate without",
    "start": "273759",
    "end": "280560"
  },
  {
    "text": "the backend so if there's ever a network failure or anything like that the controller can still operate and everything's okay um it even has you",
    "start": "280560",
    "end": "286080"
  },
  {
    "text": "know kind of a reserved power supply if bad things happen like power goes out and that kind of stuff um but it depends",
    "start": "286080",
    "end": "292160"
  },
  {
    "text": "on the controller uh all right so I decided to uh you know when I started playing around with this I was like you",
    "start": "292160",
    "end": "297600"
  },
  {
    "text": "know obviously you need to you know you need to recreate the environment so you get a real idea of it so I created this thing",
    "start": "297600",
    "end": "304400"
  },
  {
    "text": "um yeah uh so this is uh a fancy piece of plexiglass with two readers on it um",
    "start": "304400",
    "end": "311800"
  },
  {
    "text": "a controller and then an Arduino and so the two readers uh feed into the",
    "start": "311800",
    "end": "317360"
  },
  {
    "text": "controller uh into its reader portions but the Arduino uh it does some other functionality we'll talk about in a",
    "start": "317360",
    "end": "322759"
  },
  {
    "text": "second um but it mainly deals with the door opening so like I didn't want to buy like a big set of doors right and",
    "start": "322759",
    "end": "329800"
  },
  {
    "text": "like open okay the door is open yes you know like that would suck um so instead I hooked it up to this like clever",
    "start": "329800",
    "end": "335160"
  },
  {
    "text": "little light and so every time a door opens the light goes off and then it's like jackpot yay like that's fun um so I",
    "start": "335160",
    "end": "342479"
  },
  {
    "text": "was doing that and that was cool uh and so yeah so that's the whole setup um so",
    "start": "342479",
    "end": "348720"
  },
  {
    "text": "I got here on on like Tuesday or so and um I was a little jet lag but uh this",
    "start": "348720",
    "end": "354880"
  },
  {
    "text": "this setup is can can be kind of temperamental so I was a little worried about it so I wanted to make sure I checked it right after I got off the plane uh and so I did I connected",
    "start": "354880",
    "end": "362639"
  },
  {
    "text": "everything hooked up the power supply everything was going good um and then I went to go plug it in and I'm like oh",
    "start": "362639",
    "end": "367720"
  },
  {
    "text": "wait a second this doesn't compute um I'm American this doesn't work what's happening you know circle into square",
    "start": "367720",
    "end": "373639"
  },
  {
    "text": "what's you know and so that wasn't working uh so I was like oh wait I know what I have to do I have to use a power",
    "start": "373639",
    "end": "379479"
  },
  {
    "text": "adapter one of these these things so is we see where this is headed so I'm like",
    "start": "379479",
    "end": "386199"
  },
  {
    "text": "yeah look northern Europe it works okay cool uh so I took it put it in and then",
    "start": "386199",
    "end": "391759"
  },
  {
    "text": "oh my God major issues uh so this lovely",
    "start": "391759",
    "end": "397000"
  },
  {
    "text": "uh demo driven presentation is going to be much less demo driven um because I",
    "start": "397000",
    "end": "402400"
  },
  {
    "text": "made the quintessential stupid American abroad uh mistake of uh plugging in the",
    "start": "402400",
    "end": "409199"
  },
  {
    "text": "wrong power supply into this uh and basically fried out my my vertex controller um so that sucks a lot um but",
    "start": "409199",
    "end": "416479"
  },
  {
    "text": "it's not completely horrible because I have another one right oh that's good uh but it's in New York uh so I called up",
    "start": "416479",
    "end": "422479"
  },
  {
    "text": "my so I called up my my colleague in New York I'm like hey man ship this to me because remember this was Tuesday so there's time you know FedEx that kind of",
    "start": "422479",
    "end": "428680"
  },
  {
    "text": "stuff overnight um so I'm like you know ship this to me as soon as you can he's like no problem dude I'll have it to you next day should be there Thursday",
    "start": "428680",
    "end": "435120"
  },
  {
    "text": "morning I'm like all right awesome Thursday morning comes around go to the front desk all happy Hey where's my controller they look at me like what no",
    "start": "435120",
    "end": "441800"
  },
  {
    "text": "no backage what are you talking about man I'm like oh no this is the problem so I go online and look at FedEx's",
    "start": "441800",
    "end": "448120"
  },
  {
    "text": "website and uh FedEx says it is delayed beyond our",
    "start": "448120",
    "end": "453280"
  },
  {
    "text": "control uh in France uh so yeah so uh yeah the demo driven presentation again",
    "start": "453280",
    "end": "458960"
  },
  {
    "text": "will not be so demo driven but uh I hope you'll still learn some stuff without the flashiness and the lights not going",
    "start": "458960",
    "end": "465199"
  },
  {
    "text": "off um that makes it really fun and I'm kind of bummed out that I wasn't able to do that but hopefully it'll still be",
    "start": "465199",
    "end": "470639"
  },
  {
    "text": "good interesting for you guys all right back on topic uh so the card to reader interface um so yeah so you have this",
    "start": "470639",
    "end": "478120"
  },
  {
    "text": "card and the card talks to the reader and the card uh not all cards are",
    "start": "478120",
    "end": "483479"
  },
  {
    "text": "created equal right so just because it's Square uh and white doesn't necessarily mean it's the all they're all the same",
    "start": "483479",
    "end": "488680"
  },
  {
    "text": "cards so they operate over different frequencies so if you're familiar with RFID at all you know about 125 khz and",
    "start": "488680",
    "end": "495280"
  },
  {
    "text": "13.56 uh megahertz um so it's usually one of the two um there could be other",
    "start": "495280",
    "end": "500639"
  },
  {
    "text": "ones but usually it's one of those two um and uh there's also varying levels to security so some some cards have no",
    "start": "500639",
    "end": "508319"
  },
  {
    "text": "security uh and some cards have some security and so the security what I'm talking about is how the data is stored",
    "start": "508319",
    "end": "515399"
  },
  {
    "text": "on the card so that any user can't just or any person can't just read data off the card and then also when the data is",
    "start": "515399",
    "end": "521959"
  },
  {
    "text": "communicated how it's protected so can the card authenticate itself to the reader um is that data you know",
    "start": "521959",
    "end": "528399"
  },
  {
    "text": "vulnerable in transit what's the deal with all of that um and so that's the the security level there um so we'll",
    "start": "528399",
    "end": "534200"
  },
  {
    "text": "look at two hid procs and iclass we'll briefly look at iclass so the procs",
    "start": "534200",
    "end": "539519"
  },
  {
    "text": "cards are like the first ones um like one of the first ones they're the most popular they're the most widely uh",
    "start": "539519",
    "end": "545959"
  },
  {
    "text": "deployed and um the most widely kind of exploited and looked at um just to give",
    "start": "545959",
    "end": "551160"
  },
  {
    "text": "you a brief overview about it uh the the card itself just contains a number um",
    "start": "551160",
    "end": "557000"
  },
  {
    "text": "it's this uh 26-bit uh using the 26-bit card format it's 26 bytes or bits and um",
    "start": "557000",
    "end": "564440"
  },
  {
    "text": "the first and the last is the parody bits and then in between the the card value here is separated into two sub uh",
    "start": "564440",
    "end": "572680"
  },
  {
    "text": "values one is this facility ID or site code and then the other is the card number so the idea behind this is that a",
    "start": "572680",
    "end": "580120"
  },
  {
    "text": "company would buy one of you know set the system up and maybe they would uh",
    "start": "580120",
    "end": "585200"
  },
  {
    "text": "all have the same uh site code right so company y has site code 10 and then all",
    "start": "585200",
    "end": "591320"
  },
  {
    "text": "of their users would be assigned a card number between 0 and 65535 okay pretty simple um maybe if company uh you know",
    "start": "591320",
    "end": "599040"
  },
  {
    "text": "why uh has another Branch a larger Branch they'll assign a different facility code to that one um so that they can have",
    "start": "599040",
    "end": "605839"
  },
  {
    "text": "their own facility code uh and then in the back end the back end doesn't care about facil codes it just know wants to",
    "start": "605839",
    "end": "610959"
  },
  {
    "text": "know all right what numbers are assigned to you and then this is how it all works right it's pretty simple uh pretty uh",
    "start": "610959",
    "end": "616880"
  },
  {
    "text": "basic um the only issue is is that the facility codes only go to 0 to",
    "start": "616880",
    "end": "622560"
  },
  {
    "text": "255 and I'm pretty sure there's 50 more than 255 uh companies in the world like I",
    "start": "622560",
    "end": "629519"
  },
  {
    "text": "could be off by that number but I'm pretty pretty sure there is so the issue",
    "start": "629519",
    "end": "634720"
  },
  {
    "text": "happens is that there could be more than one company with the same facility code",
    "start": "634720",
    "end": "640079"
  },
  {
    "text": "right and the people who pick who gets the facility code is uh is arbitrary",
    "start": "640079",
    "end": "646320"
  },
  {
    "text": "it's whoever setting up the system and they if they previously uh the company pre previously has one of these deployed",
    "start": "646320",
    "end": "651880"
  },
  {
    "text": "maybe they'll follow what's a pre-existing but if like Bob's security company uh comes into a you know uh an",
    "start": "651880",
    "end": "659320"
  },
  {
    "text": "Office Park and decides to set up set these systems up um Bob could love the number 10 and could just so happen to",
    "start": "659320",
    "end": "665320"
  },
  {
    "text": "sign everybody the like 10 facility code you know and so and and that can happen",
    "start": "665320",
    "end": "671480"
  },
  {
    "text": "like naturally too like maybe um you know I live and work in New York City there's a lot of companies there I'm",
    "start": "671480",
    "end": "676680"
  },
  {
    "text": "sure there's companies that share the same things um so then you have to also get the same card number which could be",
    "start": "676680",
    "end": "682240"
  },
  {
    "text": "a little bit more complicated between zero and 655 35 is or three 35 is pretty",
    "start": "682240",
    "end": "687480"
  },
  {
    "text": "big um but still possible so I guess the the the important thing to recognize here is that there could be two",
    "start": "687480",
    "end": "694800"
  },
  {
    "text": "completely unrelated people completely you know from two completely different companies that just so happen to have",
    "start": "694800",
    "end": "701440"
  },
  {
    "text": "the exact same card numbers and can basically go into each other's companies",
    "start": "701440",
    "end": "706720"
  },
  {
    "text": "and become that person from a physical access control system right um so that's like a a scary thought um the chances",
    "start": "706720",
    "end": "713320"
  },
  {
    "text": "are probably pretty slim uh but um but we'll we'll look at that specific",
    "start": "713320",
    "end": "718560"
  },
  {
    "text": "behavior to to talk about some attacks um so hid is and I I talk a lot about",
    "start": "718560",
    "end": "723920"
  },
  {
    "text": "hid and I don't mean to pick on them they're just like the big you know they're the big Pie in the Sky uh company they have um they do a lot of",
    "start": "723920",
    "end": "731240"
  },
  {
    "text": "this stuff there are a lot of other companies that implement the same uh formats and do the same things but Hig",
    "start": "731240",
    "end": "737320"
  },
  {
    "text": "is just hid is just gigantic you know um so uh hid offers some Alternatives so",
    "start": "737320",
    "end": "743120"
  },
  {
    "text": "they have their 35 bit 3 and 37 bit um controlled formats so what that means is",
    "start": "743120",
    "end": "750519"
  },
  {
    "text": "is they control all the numbers Bob doesn't get to pick the facility code anymore they they pick it and then you",
    "start": "750519",
    "end": "756279"
  },
  {
    "text": "know uh presumably they pick a sec you know one that's unique to every organization right um and so they pick",
    "start": "756279",
    "end": "763120"
  },
  {
    "text": "uh they assign them properly and make sure there's no overlap or anything like that um but still it's a big problem and",
    "start": "763120",
    "end": "768639"
  },
  {
    "text": "a lot of people use these systems one of uh one of our customers we were running a test uh for one of our customers and",
    "start": "768639",
    "end": "773920"
  },
  {
    "text": "we're doing some of these attacks and um the customer's like well what do I do like you know all right you were able to",
    "start": "773920",
    "end": "780160"
  },
  {
    "text": "break into our building you know what do I do and we're like uh well you kind of have to replace your system man like you",
    "start": "780160",
    "end": "785199"
  },
  {
    "text": "know I I don't know um and so he's like he's like oh well that's unfortunate",
    "start": "785199",
    "end": "791079"
  },
  {
    "text": "because we just put this system in place like two months ago so these systems are",
    "start": "791079",
    "end": "796320"
  },
  {
    "text": "definitely still being deployed and that sucks um so uh hopefully you raise some",
    "start": "796320",
    "end": "802160"
  },
  {
    "text": "awareness and people won't deploy them they'll they'll move to some of the newer ones all right so let's talk about",
    "start": "802160",
    "end": "807560"
  },
  {
    "text": "cloning these things so cloning these things is a pretty uh widely known thing on how to do um basically it uses",
    "start": "807560",
    "end": "813760"
  },
  {
    "text": "something called The prox Mark 3i how many people have seen a prox Mark II or heard of one yeah some okay uh so uh",
    "start": "813760",
    "end": "820399"
  },
  {
    "text": "this is the prox Mark I it'll cost you about 300 bucks um it's open uh Open Source Hardware uh so um so you can get",
    "start": "820399",
    "end": "828240"
  },
  {
    "text": "all the schematics and build one yourself if you want um it runs on op Source firmware which means you can",
    "start": "828240",
    "end": "834959"
  },
  {
    "text": "modify it in any way that you want and do basically whatever you want with it um it operates on 13 it operates on both",
    "start": "834959",
    "end": "841839"
  },
  {
    "text": "of the RFID bands that we're going to be talking about um and has a lot of cool functionality so by default if you buy",
    "start": "841839",
    "end": "847920"
  },
  {
    "text": "this thing for 300 bucks uh you get this little thing and then you can buy an antenna um and it comes with firmware",
    "start": "847920",
    "end": "855440"
  },
  {
    "text": "that will allow you to clone these these cards like right out of the box right um so it's pretty simple all you have to do",
    "start": "855440",
    "end": "860680"
  },
  {
    "text": "is press a button and then uh this is be another demo portion so I'd press a button read a card and then play it back",
    "start": "860680",
    "end": "867519"
  },
  {
    "text": "to the reader um and you kind of to get a little close in re in like in like practical situations you kind of have to",
    "start": "867519",
    "end": "873079"
  },
  {
    "text": "like almost touch someone's butt a little bit so it's a little awkward but still you can skim you can you know you",
    "start": "873079",
    "end": "878480"
  },
  {
    "text": "can skim the card out of their pocket and then play it back to the reader and then you are that person right it's like",
    "start": "878480",
    "end": "884000"
  },
  {
    "text": "copying the keys to their front door uh that that equivalent um so it's pretty straightforward and then you can also do",
    "start": "884000",
    "end": "889480"
  },
  {
    "text": "things via the command line those are the commands down there um so as I started to look at these types of car",
    "start": "889480",
    "end": "895759"
  },
  {
    "text": "values I started to realize well the only thing that makes these card values",
    "start": "895759",
    "end": "901000"
  },
  {
    "text": "like at all difficult to figure out is um the site ID right like that's",
    "start": "901000",
    "end": "906839"
  },
  {
    "text": "facility code is kind of difficult so if I figured that out I'd have a pretty good idea of you know what card values are active um but then I realized well",
    "start": "906839",
    "end": "912880"
  },
  {
    "text": "there's that big 0o to 65535 range of card values and to guess all those would",
    "start": "912880",
    "end": "918360"
  },
  {
    "text": "be kind of difficult um so I started to think I was like all right well how do you order these cards so I I went online",
    "start": "918360",
    "end": "925040"
  },
  {
    "text": "and looked at um places to order them from and the way you order is you provide your facility code you provide a",
    "start": "925040",
    "end": "932000"
  },
  {
    "text": "starting number and you provide a quantity uh and the the lowest quantity",
    "start": "932000",
    "end": "937639"
  },
  {
    "text": "that you can buy is 100 well so that means all of the numbers are sequ all",
    "start": "937639",
    "end": "943759"
  },
  {
    "text": "the cards are sequentially numbered right if I provide a starting value and a quantity they're not going to give me like like starting value 100 and then",
    "start": "943759",
    "end": "951319"
  },
  {
    "text": "300 they're going to give me 100 1001 1002 1003 100 4 1005 and so if I know",
    "start": "951319",
    "end": "958560"
  },
  {
    "text": "any one valid card value so this could be a disabled badge a lost badge a",
    "start": "958560",
    "end": "965120"
  },
  {
    "text": "temporary badge a badge you just read off somebody else if I know one valid card value badge I can guess other valid",
    "start": "965120",
    "end": "973480"
  },
  {
    "text": "card value Badges and so um so if it's a disabled badge well I could then guess another",
    "start": "973480",
    "end": "981120"
  },
  {
    "text": "badge that's enabled just by sequentially iterating through the number so just trying different",
    "start": "981120",
    "end": "987279"
  },
  {
    "text": "different values um but if it's a if it's a c that has maybe front door privilege but not data center privilege",
    "start": "987279",
    "end": "994680"
  },
  {
    "text": "well then I can just go up to the data center and try that value and start trying other values and incrementing them or decrementing them to get access",
    "start": "994680",
    "end": "1001319"
  },
  {
    "text": "and guess a valid value for the data center so you can do privilege escalation really easily with this stuff",
    "start": "1001319",
    "end": "1008639"
  },
  {
    "text": "um in practice it takes um like seconds to find another valid card value because",
    "start": "1008639",
    "end": "1013839"
  },
  {
    "text": "again they're sequentially numbered so you just basically like you know if you have a disabled card you go up wait a second it SS maybe twice at most and",
    "start": "1013839",
    "end": "1020920"
  },
  {
    "text": "then you hear the door unlock and you're like all right access granted cool I went um with data centers it can be a",
    "start": "1020920",
    "end": "1026760"
  },
  {
    "text": "little bit more difficult in higher privilege areas because uh you know a a less amount of people have those uh",
    "start": "1026760",
    "end": "1033798"
  },
  {
    "text": "those privileges so takes a little bit more guessing but usually under a minute you'll guess it um it's a little bit odd",
    "start": "1033799",
    "end": "1039839"
  },
  {
    "text": "like I I if I would to show you guys the demo um you hear like beep beep beep beep beep beep and then eventually like",
    "start": "1039839",
    "end": "1046760"
  },
  {
    "text": "the door just opens and you're just like all right cool and then you walk in and you have access so it's kind of a fun",
    "start": "1046760",
    "end": "1052559"
  },
  {
    "text": "it's kind of a fun thing but it's a little it's a little attention drawing because there's this you're just standing there and the the door just",
    "start": "1052559",
    "end": "1057919"
  },
  {
    "text": "keeps beeping um we had uh one of our guys was on site and So like um",
    "start": "1057919",
    "end": "1064760"
  },
  {
    "text": "sometimes it could take a little so it took him like in this particular instance he told me it took about five minutes and so after the first minute he",
    "start": "1064760",
    "end": "1070679"
  },
  {
    "text": "was kind of getting tired of holding the the antenna up there so he took a thumbtack and thumbtacked it into the",
    "start": "1070679",
    "end": "1077280"
  },
  {
    "text": "wall to hang the antenna over the reader like this and then just kind of stood there like just waiting and he said",
    "start": "1077280",
    "end": "1084080"
  },
  {
    "text": "people like walked past him he just give him a wave smile they just keep walking no like I mean how obvious can you",
    "start": "1084080",
    "end": "1091880"
  },
  {
    "text": "get you have a thing over the reader it's beeping the guys's like I don't know",
    "start": "1091880",
    "end": "1097440"
  },
  {
    "text": "so but like that it's that you know that's the kind of ridiculous this that happens so this this is pretty pretty",
    "start": "1097440",
    "end": "1103200"
  },
  {
    "text": "devastating I mean if you think about it you can as long as you have one value you can do it no knowledge brute forcing takes is much more difficult um because",
    "start": "1103200",
    "end": "1110679"
  },
  {
    "text": "you have to guess usually what you do is you guess in big chunks so like for facility code one uh you try like you",
    "start": "1110679",
    "end": "1117799"
  },
  {
    "text": "know um a number between maybe one and 500 and then 500 to a th000 1,00 to 1500",
    "start": "1117799",
    "end": "1123600"
  },
  {
    "text": "and each guess it takes about uh a second so I mean to Guess that the Brute",
    "start": "1123600",
    "end": "1130880"
  },
  {
    "text": "Force entire key space would take like I don't know like three years and I'm sure like after the first year somebody's",
    "start": "1130880",
    "end": "1136159"
  },
  {
    "text": "going to notice you there so I mean you you got to be careful but um but still I",
    "start": "1136159",
    "end": "1141440"
  },
  {
    "text": "mean it's it you know you could still do some intelligent brute forcing to help out a little bit in that but it's it's",
    "start": "1141440",
    "end": "1146960"
  },
  {
    "text": "kind of hard um this is something I I thought was kind of interesting so I was ordering all these parts on eBay and now",
    "start": "1146960",
    "end": "1152679"
  },
  {
    "text": "keep in mind you know if I know your facility code and if I know your your card number range like I equ I have the",
    "start": "1152679",
    "end": "1159320"
  },
  {
    "text": "equivalent of the keys to your house right so this guy and it's just it's just lack of knowledge right people just",
    "start": "1159320",
    "end": "1164760"
  },
  {
    "text": "don't really understand it so this guy like puts them up online and he's like hey man I accidentally ordered some",
    "start": "1164760",
    "end": "1169919"
  },
  {
    "text": "duplicates so here are the excess and then like the facility code and the range is on the bottom just like what",
    "start": "1169919",
    "end": "1176960"
  },
  {
    "text": "are you talking what are you doing man it's not a good idea so like if you if you could figure out where this seller",
    "start": "1176960",
    "end": "1182320"
  },
  {
    "text": "is actually from you can basically go there to his building and use those same excess cards and then just try to read",
    "start": "1182320",
    "end": "1188640"
  },
  {
    "text": "one at a time to see which one was available unless maybe you know he ordered instead of ordering like 200",
    "start": "1188640",
    "end": "1194720"
  },
  {
    "text": "order 500 and these are the 500 that aren't used that could be it too but either way you know at least I know a number in the",
    "start": "1194720",
    "end": "1200720"
  },
  {
    "text": "range that I can guess at right stupid all right uh so all right let's",
    "start": "1200720",
    "end": "1206919"
  },
  {
    "text": "talk about iclass cards so iclass cards um so we talked about the pro the the",
    "start": "1206919",
    "end": "1212280"
  },
  {
    "text": "prox cards and the prox cards have that value on them and no security meaning that anybody can query it and anybody",
    "start": "1212280",
    "end": "1218720"
  },
  {
    "text": "can imitate it really simple um I class is a little different in that it still stores that value but it like you know",
    "start": "1218720",
    "end": "1225880"
  },
  {
    "text": "puts that value in a safe you know and protects it so it has a full it's a full-on smart card um contact list smart",
    "start": "1225880",
    "end": "1233640"
  },
  {
    "text": "card in there and um it it there's two types of iclass cards there's high",
    "start": "1233640",
    "end": "1239799"
  },
  {
    "text": "security and standard security so for Standard Security every hid reader every",
    "start": "1239799",
    "end": "1247440"
  },
  {
    "text": "hid iclass reader and every hid iclass card has the same key so if you get access to that key",
    "start": "1247440",
    "end": "1255200"
  },
  {
    "text": "it's like you know gold mine right it's you you now have you're now at the almost the same level as you would the pro the the pro cards okay um if the if",
    "start": "1255200",
    "end": "1264640"
  },
  {
    "text": "for the high security you define your own key so that makes it a little bit more difficult you still have to gain",
    "start": "1264640",
    "end": "1269720"
  },
  {
    "text": "access to the Keys um but and you know once you get the keys it's good but it's much more difficult to get the keys",
    "start": "1269720",
    "end": "1275880"
  },
  {
    "text": "because with Standard Security I can buy any hid iclass reader and pull the keys",
    "start": "1275880",
    "end": "1280919"
  },
  {
    "text": "off of it um for uh high security I need to get your iclass reader uh and pull",
    "start": "1280919",
    "end": "1287559"
  },
  {
    "text": "the keys off there so how do you pull the keys off of it um well so up in the upper left um Milos and Henrik gave an",
    "start": "1287559",
    "end": "1294600"
  },
  {
    "text": "awesome talk uh at uh a couple of ccc's ago and um what they did was like",
    "start": "1294600",
    "end": "1301679"
  },
  {
    "text": "awesome stuff right like they pulled apart the the reader and then they like",
    "start": "1301679",
    "end": "1307480"
  },
  {
    "text": "like uh did the thing where you like cut off parts of the Chip And then like look at the gates on the chip to determine",
    "start": "1307480",
    "end": "1313520"
  },
  {
    "text": "how things work like what absolutely awesome stuff but what",
    "start": "1313520",
    "end": "1319159"
  },
  {
    "text": "they did was they they determined so like let's say this is the memory of the card of the of the microcontroller that",
    "start": "1319159",
    "end": "1327159"
  },
  {
    "text": "exists in the reader okay so the memory of the microcontroller exists in the reader what they found is is if you",
    "start": "1327159",
    "end": "1332960"
  },
  {
    "text": "overwrite the first portion of it right you you have the ability to Del um to remove certain values right so if you um",
    "start": "1332960",
    "end": "1342240"
  },
  {
    "text": "uh kind of delete the first uh portion or the first chunk of the firmware code",
    "start": "1342240",
    "end": "1347559"
  },
  {
    "text": "and replace it with dumper code you can replace it and then dump the rest and then you get another reader and then",
    "start": "1347559",
    "end": "1354520"
  },
  {
    "text": "overwrite the last values of it and replace that with dumper code and then once it boots up you can get the whole",
    "start": "1354520",
    "end": "1360400"
  },
  {
    "text": "image and then with the whole firmware image you can pull out and extract the keys all right it's pretty good attack",
    "start": "1360400",
    "end": "1367640"
  },
  {
    "text": "works pretty awesomely um the problem with it is I have to like destroy two readers right um I have to like delete",
    "start": "1367640",
    "end": "1374320"
  },
  {
    "text": "stuff on the reader and like I could potentially totally you know uh uh make the reader unusable and so there's some",
    "start": "1374320",
    "end": "1380760"
  },
  {
    "text": "problems with that and that's a little bit concerned so this dude from pcl.com uh what he did was is he discovered that",
    "start": "1380760",
    "end": "1388880"
  },
  {
    "text": "you can actually get access to the memory of the reader so you don't actually have to overwrite the the",
    "start": "1388880",
    "end": "1395360"
  },
  {
    "text": "firmware itself but you can get access to the memory that the firmware uses um and so with some instructions you can",
    "start": "1395360",
    "end": "1403320"
  },
  {
    "text": "pull that pull the keys out of memory after it reads a card uh so the problem",
    "start": "1403320",
    "end": "1409440"
  },
  {
    "text": "with that was though that he although his white paper was pretty detailed um he like implemented it in his own",
    "start": "1409440",
    "end": "1415919"
  },
  {
    "text": "Hardware device and then didn't release the like schematics of it and so like you know it it's kind there's still like",
    "start": "1415919",
    "end": "1421679"
  },
  {
    "text": "an a big entry or barrier to entry if you want to replicate this work um so",
    "start": "1421679",
    "end": "1427000"
  },
  {
    "text": "what I did was I use this FTD ftdi TTL 232r which M lotion Henri used and",
    "start": "1427000",
    "end": "1434240"
  },
  {
    "text": "implemented the attack that the prox cl.com uses so now now you can use this",
    "start": "1434240",
    "end": "1440440"
  },
  {
    "text": "cable with like uh an Android phone you can use the cable with a PC um and literally walk up to one of these the",
    "start": "1440440",
    "end": "1447039"
  },
  {
    "text": "one of these readers unscrew it get access to the back the program interface on the back plug it in press a button",
    "start": "1447039",
    "end": "1453120"
  },
  {
    "text": "and 60 seconds later you have the memory dump which has all the keys and all that stuff in it too um so now it's like the",
    "start": "1453120",
    "end": "1459200"
  },
  {
    "text": "tack is much more you know kind of refined to a certain extent and much more easier to implement um all right so let's look at",
    "start": "1459200",
    "end": "1466640"
  },
  {
    "text": "the next interface so from the to the controller uh all right so um so now we",
    "start": "1466640",
    "end": "1473480"
  },
  {
    "text": "we're done with all of the RFID stuff right uh all of the RFID stuff the security there that exists this is after",
    "start": "1473480",
    "end": "1479480"
  },
  {
    "text": "the RFID uh portion um now we're all on the wean interface so the important",
    "start": "1479480",
    "end": "1484840"
  },
  {
    "text": "thing to realize here is that between the reader and the controller um is all",
    "start": "1484840",
    "end": "1490080"
  },
  {
    "text": "this standard protocol and all cards output from the reader the same thing so",
    "start": "1490080",
    "end": "1496360"
  },
  {
    "text": "it doesn't matter about the security um it's all the same data that's being trans transferred from the wire from the",
    "start": "1496360",
    "end": "1501799"
  },
  {
    "text": "reader to the controller um so let's look at that Pro protocol it can also be rs232 as I'm pointing out in the bottom",
    "start": "1501799",
    "end": "1507840"
  },
  {
    "text": "but um it really depends on the setup but most often it's the weekend um all right so this is a logic",
    "start": "1507840",
    "end": "1513919"
  },
  {
    "text": "this is the output from a logic analyzer okay um wean is really really simple it has two two lines a data zero and a data",
    "start": "1513919",
    "end": "1521640"
  },
  {
    "text": "one they're both always high whenever it wants to extend to zero it drops data",
    "start": "1521640",
    "end": "1527080"
  },
  {
    "text": "zero whenever it wants to send a one it drops data one okay so really really",
    "start": "1527080",
    "end": "1532399"
  },
  {
    "text": "simple I I decoded everything in the middle here for you so you can see like this is what it looks like in binary um",
    "start": "1532399",
    "end": "1538000"
  },
  {
    "text": "and then I converted it to hex and then you can see what's ultimately the site the cyod and the card number that's",
    "start": "1538000",
    "end": "1543360"
  },
  {
    "text": "printed on the bottom of the um that's printed on the bottom of the card right so to implement this protocol is super",
    "start": "1543360",
    "end": "1549360"
  },
  {
    "text": "easy right I mean you're just draw you have a high two high lines you just drop them whenever you want to send anything",
    "start": "1549360",
    "end": "1554760"
  },
  {
    "text": "um the the kind of annoying part about it is though is it's not super elegant uh you have to uh pop off the cover so",
    "start": "1554760",
    "end": "1562640"
  },
  {
    "text": "uh you have to do that and then unscrew uh two screws and then you have access",
    "start": "1562640",
    "end": "1567880"
  },
  {
    "text": "to the cable in the back and then you have to kind of pull apart to get access to the actual wire um so it's not super",
    "start": "1567880",
    "end": "1573679"
  },
  {
    "text": "elegant but once you have access it gets uh it gets super easy oh sorry some",
    "start": "1573679",
    "end": "1580520"
  },
  {
    "text": "nudie pcks I didn't mean no uh all right so this is so what I did was I",
    "start": "1580520",
    "end": "1585919"
  },
  {
    "text": "implemented this whole thing in an Arduino now um a little while ago uh somebody gave a talk at Defcon and um I",
    "start": "1585919",
    "end": "1593480"
  },
  {
    "text": "I added this to the slides because I want to give that guy shouts uh he created something called the gecko which um which is uh basically like a",
    "start": "1593480",
    "end": "1600840"
  },
  {
    "text": "man-in-the-middle almost a hardware device for these things uh I implemented kind of the same thing with some more",
    "start": "1600840",
    "end": "1605880"
  },
  {
    "text": "features um but he again he didn't release any of the schematics and stuff or I couldn't find them so like if you",
    "start": "1605880",
    "end": "1611600"
  },
  {
    "text": "guys ever do research stuff please like you know release schematics like show people how to do stuff because otherwise",
    "start": "1611600",
    "end": "1618000"
  },
  {
    "text": "you know you know they have to learn on their own and that just sucks you know on um so I released all schematics for",
    "start": "1618000",
    "end": "1623399"
  },
  {
    "text": "all this stuff but it's just an Arduino you know it's you can look at a picture um so what what what this does is does a",
    "start": "1623399",
    "end": "1629159"
  },
  {
    "text": "couple things um one it does it's a skimmer right so uh it sits in line between the reader so if you want to you",
    "start": "1629159",
    "end": "1635760"
  },
  {
    "text": "can put it in line between the reader and the controller and then it will take anything that it reads in from the reader and then just replay it back to",
    "start": "1635760",
    "end": "1642559"
  },
  {
    "text": "the the controller um so if you wanted to you can put like you know a storage device on here and then just have it log",
    "start": "1642559",
    "end": "1648720"
  },
  {
    "text": "everything so if you're an attacker maybe you go there at night um put one of these in place embed it into the wall",
    "start": "1648720",
    "end": "1655279"
  },
  {
    "text": "close up the reader uh come back the next night and get all the card values that were that were sent over the wire",
    "start": "1655279",
    "end": "1661120"
  },
  {
    "text": "um what you could also do is put like a Bluetooth or a wireless uh adapter into",
    "start": "1661120",
    "end": "1666320"
  },
  {
    "text": "this thing so then this way you don't have to actually like go into the wall ever again you can just always check out",
    "start": "1666320",
    "end": "1671799"
  },
  {
    "text": "um you know what's getting skimmed from the device and get is getting all these card values um so that's always good too",
    "start": "1671799",
    "end": "1677960"
  },
  {
    "text": "um the other thing it does is it emulates too so um if you I sort of want",
    "start": "1677960",
    "end": "1683320"
  },
  {
    "text": "to see if I can show this but with all my demo luck I just I just feel like everything's going to explode it's",
    "start": "1683320",
    "end": "1689519"
  },
  {
    "text": "saying door unlocked yeah that's that's right there's no doors um all right so this is the Arduino output I'm gonna see",
    "start": "1689519",
    "end": "1695480"
  },
  {
    "text": "if this works this is a iclass card I have an iclass reader hooked up to it um and so I'm just going to try to read it",
    "start": "1695480",
    "end": "1701640"
  },
  {
    "text": "oh good so so this is kind of what you see um from the Arduino it just says I received the input from REO this is the",
    "start": "1701640",
    "end": "1707799"
  },
  {
    "text": "the B representation hex the site code and the card number um so it has all",
    "start": "1707799",
    "end": "1713720"
  },
  {
    "text": "that stuff uh but what you can also do is again imagine if you had like a wireless module set uh attached to this",
    "start": "1713720",
    "end": "1720080"
  },
  {
    "text": "thing you can just kind of take the the the value and then just paste it in um",
    "start": "1720080",
    "end": "1725679"
  },
  {
    "text": "and it should yeah uh well it's saying invalid",
    "start": "1725679",
    "end": "1731679"
  },
  {
    "text": "input length of course uh because everything else breaks um but uh what you could just paste it in there and",
    "start": "1731679",
    "end": "1738480"
  },
  {
    "text": "it'll automatically send that value uh to the to the uh to the controller so at this point you don't even you know you",
    "start": "1738480",
    "end": "1745320"
  },
  {
    "text": "don't even need the card right all you need is the card value and you can play",
    "start": "1745320",
    "end": "1750519"
  },
  {
    "text": "it directly to the controller and the controller thinks it was read from the reader so if I had a wireless interface",
    "start": "1750519",
    "end": "1756600"
  },
  {
    "text": "I just walk up to the door just say uh you know Brad's card presco on my phone",
    "start": "1756600",
    "end": "1761799"
  },
  {
    "text": "and then it opens the door that kind of thing um so that could that's pretty devastating that's pretty fun to do too",
    "start": "1761799",
    "end": "1768200"
  },
  {
    "text": "um the other thing you can do is a fuzzer so I also implemented a fuzzer on on Arduino um a wgan has not too many uh",
    "start": "1768200",
    "end": "1774320"
  },
  {
    "text": "test cases right I mean you just lower data one low data zero lower both long strings that kind of stuff um so I",
    "start": "1774320",
    "end": "1780159"
  },
  {
    "text": "implemented that with a bunch of test cases so if you wanted to fuzz the controller's interface you could do that as well um also wand is used for um or",
    "start": "1780159",
    "end": "1788679"
  },
  {
    "text": "wean uh it's used for uh like magnetic stripe cards uh it's used in some",
    "start": "1788679",
    "end": "1794279"
  },
  {
    "text": "Biometrics um so you can use this Arduino interface to to fuzz all of those and to mess around with all of",
    "start": "1794279",
    "end": "1800240"
  },
  {
    "text": "those different um you know types of readers essentially like whether it be a magnetic stripe or a thumbprint or",
    "start": "1800240",
    "end": "1806159"
  },
  {
    "text": "something like that um and then also uh you know might as well do a brute forcer too uh so I also implemented brute",
    "start": "1806159",
    "end": "1812799"
  },
  {
    "text": "forcer that brought it up from one ID a second to five IDs a second um the",
    "start": "1812799",
    "end": "1817840"
  },
  {
    "text": "limitation there is there has to be certain spacing between the IDS in order for it to Brute Force otherwise uh the",
    "start": "1817840",
    "end": "1824919"
  },
  {
    "text": "controller interprets it as one long string right um so you have to have some spacing in between it so I can do five",
    "start": "1824919",
    "end": "1830919"
  },
  {
    "text": "IDs a second which is a little faster you can do some no- knowledge root forcing but again it may not be super fast but if you're you know if you can",
    "start": "1830919",
    "end": "1837919"
  },
  {
    "text": "have it run for a while maybe overnight maybe you get something better uh and this again can all be run via PC iPhone",
    "start": "1837919",
    "end": "1845120"
  },
  {
    "text": "or Android uh so you can have everything very mobile very easily accessible um all right so let's talk",
    "start": "1845120",
    "end": "1852039"
  },
  {
    "text": "about targeting that controller uh that we were talking about um so uh the the",
    "start": "1852039",
    "end": "1857519"
  },
  {
    "text": "control is um uh oh oh yeah yeah so let's talk about the targeting controller so the",
    "start": "1857519",
    "end": "1862960"
  },
  {
    "text": "controller takes the data in from the um takes the data in from uh the reader and",
    "start": "1862960",
    "end": "1869279"
  },
  {
    "text": "then formats it for the database uh for the back end so remember that we're going to look at the vertex controller",
    "start": "1869279",
    "end": "1875720"
  },
  {
    "text": "this specific one for hid um it's the v2000 uh this controller is kind of used",
    "start": "1875720",
    "end": "1880880"
  },
  {
    "text": "in a couple of different places it's sometimes rebranded and all that kind of good stuff um again I'm just picking on",
    "start": "1880880",
    "end": "1886480"
  },
  {
    "text": "hid because they're popular um nothing specifically against them um so all right so these things are usually",
    "start": "1886480",
    "end": "1891919"
  },
  {
    "text": "deployed in a building uh environment which you know with a bunch of them",
    "start": "1891919",
    "end": "1897159"
  },
  {
    "text": "deployed all throughout the building AC and they're hooked onto the network um so they have this discovery protocol",
    "start": "1897159",
    "end": "1902519"
  },
  {
    "text": "that's in place it's a super simple UDP um uh based Discovery protocol uh and um",
    "start": "1902519",
    "end": "1909720"
  },
  {
    "text": "you know it's all plain text it's like uh semicolon delimited like really easy to reimplement so I implemented a a",
    "start": "1909720",
    "end": "1916240"
  },
  {
    "text": "quick Discovery tool in Python so that if you're on one of these networks you can run this tool and get like you know",
    "start": "1916240",
    "end": "1921639"
  },
  {
    "text": "the version information what IP addresses and discover you know what your targets would be um if you were to",
    "start": "1921639",
    "end": "1927320"
  },
  {
    "text": "get onto one of these networks and start to mess around with it uh all right so uh let's talk about",
    "start": "1927320",
    "end": "1932960"
  },
  {
    "text": "hacking this controller a little bit um so when I when I got it I'm like all right well you know uh there's probably",
    "start": "1932960",
    "end": "1938799"
  },
  {
    "text": "going to be some sort of nice remote exploit in this thing um or you know something else I can do um but let me",
    "start": "1938799",
    "end": "1944519"
  },
  {
    "text": "just first look at you know how this thing is put together and you know how it's supposed to be managed so I went",
    "start": "1944519",
    "end": "1949840"
  },
  {
    "text": "through the controller and so all right to to log into it to the to the UI I had",
    "start": "1949840",
    "end": "1954960"
  },
  {
    "text": "to you know log in with the username admin password blank so I was like all right cool um log into the web UI and it",
    "start": "1954960",
    "end": "1961360"
  },
  {
    "text": "ask me to change my password so fair enough uh so I changed my password and then I did a quick port scan of it and",
    "start": "1961360",
    "end": "1966519"
  },
  {
    "text": "noticed tet's open so I was like all right well let's see what happens when you connect tnet um so I connected to telnet trying to use that admin uh",
    "start": "1966519",
    "end": "1974120"
  },
  {
    "text": "username and password that I I set via the the web UI and and I was able to get access to it so I was like all right",
    "start": "1974120",
    "end": "1980159"
  },
  {
    "text": "this is great um so you know I was able to get kind of and discovered it's all running Linux you know it's a embedded",
    "start": "1980159",
    "end": "1986399"
  },
  {
    "text": "Linux system and um not too bad right it's a access board or whatever uh so I",
    "start": "1986399",
    "end": "1991519"
  },
  {
    "text": "catted out the password file and discovered that there's this root account there and so like I'm looking back through the manual like wait",
    "start": "1991519",
    "end": "1997600"
  },
  {
    "text": "where's this root account mentioned anywhere like I don't I don't see this any like what's going on with this thing so I didn't I couldn't find anywhere um",
    "start": "1997600",
    "end": "2004320"
  },
  {
    "text": "so I was like all right well Fair might as well try to crack the password it's just looking at me so I looked at it and",
    "start": "2004320",
    "end": "2010080"
  },
  {
    "text": "sure sure enough three seconds later uh the password cracks and it's the password of",
    "start": "2010080",
    "end": "2015519"
  },
  {
    "text": "pass right so I was like all right you know well that sucks for them that was",
    "start": "2015519",
    "end": "2020559"
  },
  {
    "text": "obviously pretty dumb uh you know bad job um but I was like you know this is not that devastating of a finding",
    "start": "2020559",
    "end": "2027039"
  },
  {
    "text": "because people can just change the password I mean it is undocumented at all but you can still kind of change it",
    "start": "2027039",
    "end": "2032240"
  },
  {
    "text": "if you knew so much about it so whatever well what I later discovered is that a",
    "start": "2032240",
    "end": "2037320"
  },
  {
    "text": "lot of the backend systems that are that manage these controllers have this",
    "start": "2037320",
    "end": "2043480"
  },
  {
    "text": "account hardcoded into their application binary so if you change this password",
    "start": "2043480",
    "end": "2049560"
  },
  {
    "text": "you would literally break all of your backend systems so that sucks man like you know",
    "start": "2049560",
    "end": "2056839"
  },
  {
    "text": "you can't change it anywhere it's like all and the password is passed you know like horrible um so that sucks uh but I",
    "start": "2056839",
    "end": "2064480"
  },
  {
    "text": "was like all right cool well you know that's a a pretty persistent way to to get access to the system um you know I",
    "start": "2064480",
    "end": "2070200"
  },
  {
    "text": "could find there there there are definitely exploits that are available in it but those could be patched over time maybe they'll change this and then",
    "start": "2070200",
    "end": "2075960"
  },
  {
    "text": "you know allow you to set the password in the in the back end I don't know but I wanted to start looking at the at the",
    "start": "2075960",
    "end": "2081040"
  },
  {
    "text": "system itself um so I started to mess around with it and I realized that um",
    "start": "2081040",
    "end": "2086560"
  },
  {
    "text": "what I what I tried to do the very first thing I tried to do is I I read a card value and then um and then went to the",
    "start": "2086560",
    "end": "2092638"
  },
  {
    "text": "back end and and the door opened and then I unplugged the network cable and read the card value again because I wanted to see how dependent on the back",
    "start": "2092639",
    "end": "2098839"
  },
  {
    "text": "end the controller was and sure enough the door opened again which immediately indicates all right there must be some sort of local cache on there on on this",
    "start": "2098839",
    "end": "2105960"
  },
  {
    "text": "controller that I can play around with so I started to dig through all the files that exist on it and found these",
    "start": "2105960",
    "end": "2111320"
  },
  {
    "text": "two files the access DB and the ident DB so both of these files are just",
    "start": "2111320",
    "end": "2116440"
  },
  {
    "text": "basically big binary Blobs of data that contain all of the um all of the cards",
    "start": "2116440",
    "end": "2123119"
  },
  {
    "text": "card values and their access restrictions so you know Brad's card value 12 three is allowed to access this",
    "start": "2123119",
    "end": "2130160"
  },
  {
    "text": "door at this time um and that kind of stuff so uh you know that was pretty good so I was like all right fair enough",
    "start": "2130160",
    "end": "2136119"
  },
  {
    "text": "you know you have all that information in there so I wrote a quick tool to pars that data out of it because again it's not encrypted nothing special about just",
    "start": "2136119",
    "end": "2142760"
  },
  {
    "text": "a big binary blob so I just and once you look at it and understand some of the values it's really easy to pick apart",
    "start": "2142760",
    "end": "2148079"
  },
  {
    "text": "like how it's all delimitated and how it's structured um so I wrote this this easy tool to to parse everything but",
    "start": "2148079",
    "end": "2153680"
  },
  {
    "text": "then I was thinking like wait a second what am I doing parsing this wait this is a local cash I can inject into it",
    "start": "2153680",
    "end": "2160440"
  },
  {
    "text": "right so what happens if I'm an attacker and I have a card value like I have my own card that maybe works at my company",
    "start": "2160440",
    "end": "2166880"
  },
  {
    "text": "you know or just a card I found on the street that has nothing to do with this company well I can take that value off",
    "start": "2166880",
    "end": "2172480"
  },
  {
    "text": "of that card and then inject it into this this cache and the door opens so it's that's",
    "start": "2172480",
    "end": "2181079"
  },
  {
    "text": "awesome right at that point because now you know I can just walk up and you know through dpace right like wow card value",
    "start": "2181079",
    "end": "2188800"
  },
  {
    "text": "inject enter and then uh you know stuff happens um so that was that was pretty",
    "start": "2188800",
    "end": "2194079"
  },
  {
    "text": "fun to fun to discover but the problem with that was that um was that in the",
    "start": "2194079",
    "end": "2199240"
  },
  {
    "text": "backend logs it says uh user access granted to Door blah blah blah user",
    "start": "2199240",
    "end": "2205560"
  },
  {
    "text": "equals and then just nothing right so there's still like a log entry it doesn't the backend doesn't know like uh",
    "start": "2205560",
    "end": "2212960"
  },
  {
    "text": "I guess the backend doesn't know like since it doesn't have that card number in its own database it doesn't you know",
    "start": "2212960",
    "end": "2218680"
  },
  {
    "text": "can't look it up and so can't populate that value but there's still like a log entry so I was like",
    "start": "2218680",
    "end": "2225760"
  },
  {
    "text": "go yeah for sure yeah so the way the back end works is so the question was does injecting work if the back end is",
    "start": "2226839",
    "end": "2233040"
  },
  {
    "text": "live and uh the answer is yes because the the backend pushes data to the",
    "start": "2233040",
    "end": "2238240"
  },
  {
    "text": "controllers to this uh uh you know cache or database whatever you want to say um",
    "start": "2238240",
    "end": "2243960"
  },
  {
    "text": "it pushes that uh so uh once it pushes it I mean there's theoretically like",
    "start": "2243960",
    "end": "2249960"
  },
  {
    "text": "over time it can do a refresh where it deletes everything and then pushes up a new value um but still it it definitely",
    "start": "2249960",
    "end": "2255760"
  },
  {
    "text": "definitely does work too um so you can totally inject values into this database and open any door that you want like I",
    "start": "2255760",
    "end": "2261119"
  },
  {
    "text": "injected a value gave it full access to both doors was able to do everything um so opening doors part one good uh so I",
    "start": "2261119",
    "end": "2268480"
  },
  {
    "text": "was talking to the guys at work you know and I'm like yo check this out I just injected this card value I'm super cool like me and uh they were like they're",
    "start": "2268480",
    "end": "2276000"
  },
  {
    "text": "like no that's that's lame man look there's a there's a log entry uh that's just not cool enough sorry we will not",
    "start": "2276000",
    "end": "2281839"
  },
  {
    "text": "be your friends um so I said all right fine can I buy you more beer and uh they",
    "start": "2281839",
    "end": "2287079"
  },
  {
    "text": "said no so what I did instead was is I started to look at um how the system",
    "start": "2287079",
    "end": "2292319"
  },
  {
    "text": "actually opened doors itself right um and realized that so each uh basically",
    "start": "2292319",
    "end": "2298680"
  },
  {
    "text": "each of these outputs to the doors um that I have hooked up to the Arduino uh basically uh are all controlled by a",
    "start": "2298680",
    "end": "2306240"
  },
  {
    "text": "Serial interface intern so if you send the right command to the serial interface it triggers the unlock",
    "start": "2306240",
    "end": "2312560"
  },
  {
    "text": "mechanism um so I did like a whole bunch of kind of Serial debugging to determine this and figured out like oh man there's",
    "start": "2312560",
    "end": "2319160"
  },
  {
    "text": "this there's this like generic test utility that comes on the platform um",
    "start": "2319160",
    "end": "2324359"
  },
  {
    "text": "called hardware test serial and you can send arbitrary commands to its serial interfaces like yes so uh with one",
    "start": "2324359",
    "end": "2333119"
  },
  {
    "text": "Pleasant command you can execute this command and the door just opens and it's it's just like uh Magic you feel good",
    "start": "2333119",
    "end": "2339359"
  },
  {
    "text": "the light goes off when it works and everything every everyone's happy so I really felt good about that that was all",
    "start": "2339359",
    "end": "2345119"
  },
  {
    "text": "the like you know again more dpace no logs whatsoever at this point um so doors just open right um yeah pretty",
    "start": "2345119",
    "end": "2352960"
  },
  {
    "text": "nice and then the last part was I was like all right well this web UI like you know I have this root account it's I",
    "start": "2352960",
    "end": "2359520"
  },
  {
    "text": "hardcoded what else can I do with it well I could also log into the web UI with it um and the web UI also offers",
    "start": "2359520",
    "end": "2365720"
  },
  {
    "text": "some functionality uh and I determined like you can basically open a door via a get request so if you have this username",
    "start": "2365720",
    "end": "2372960"
  },
  {
    "text": "password you set like I saw wrote a quick python script to run a get request I could have done it in a curl like",
    "start": "2372960",
    "end": "2378319"
  },
  {
    "text": "literally like a oneline curl thing um and uh you know press go and Do's open",
    "start": "2378319",
    "end": "2383839"
  },
  {
    "text": "it's just like uh great more door opening so there's like a lot of ways once you get access to one of these",
    "start": "2383839",
    "end": "2389000"
  },
  {
    "text": "boxes you can trigger that door to open like all types of different ways and just make that light always stay on it's",
    "start": "2389000",
    "end": "2394839"
  },
  {
    "text": "nice um the other cool things about the web VI um and I haven't did the proper amount",
    "start": "2394839",
    "end": "2400160"
  },
  {
    "text": "of Serial debuging to determine this but like with the web UI I can make a door stay open like not only can I just open",
    "start": "2400160",
    "end": "2406760"
  },
  {
    "text": "it I can just say always stay open and what's even more scary is I can make a door stay",
    "start": "2406760",
    "end": "2412880"
  },
  {
    "text": "closed which is really scary um but yeah so you can also make doors press the",
    "start": "2412880",
    "end": "2418599"
  },
  {
    "text": "button door open or closed and then everyone's locked in oh no um I was actually really worried about that it",
    "start": "2418599",
    "end": "2424319"
  },
  {
    "text": "turns out if you pull like a fire alarm I think they fall open um so if there usually there's like an",
    "start": "2424319",
    "end": "2429400"
  },
  {
    "text": "emergency exit button or like a fire alarm things that makes them them open no matter what uh so I'm happy about",
    "start": "2429400",
    "end": "2435960"
  },
  {
    "text": "that um all right so the last part is the back end um so let's look about like",
    "start": "2435960",
    "end": "2442760"
  },
  {
    "text": "you know what what we can do if um so we're done with that controller uh we're done with the readers let's look at if",
    "start": "2442760",
    "end": "2448280"
  },
  {
    "text": "we target the back end specifically what sort of information is there uh all",
    "start": "2448280",
    "end": "2453560"
  },
  {
    "text": "right so the back end that we're targeting is called Web brick um it's a popular one uh I I kind of",
    "start": "2453560",
    "end": "2461319"
  },
  {
    "text": "picked it only because um it was they had a free a free downloadable trial so",
    "start": "2461319",
    "end": "2466920"
  },
  {
    "text": "I was like all right I'll you know use that um and I threw it inside of a VM uh",
    "start": "2466920",
    "end": "2472079"
  },
  {
    "text": "it runs it's a runs in Windows um I think the preferred operating system is Windows 2003 um and uh by default",
    "start": "2472079",
    "end": "2480000"
  },
  {
    "text": "installs with sa with no password so if you've ever done an internal penetration test ever in your life you know that",
    "start": "2480000",
    "end": "2485800"
  },
  {
    "text": "that's available everywhere um so they contribute to that um the installation is unnecessarily bulky and annoying like",
    "start": "2485800",
    "end": "2494000"
  },
  {
    "text": "it it contains like 500 setup.exe and you have to like click each one in succession and it's it sucks like it's",
    "start": "2494000",
    "end": "2501240"
  },
  {
    "text": "the worst application ever um and and then like oh man it was it was hard they",
    "start": "2501240",
    "end": "2506760"
  },
  {
    "text": "they they give you like this login to get the free trial they give you a login to this FTP site so you have to call up",
    "start": "2506760",
    "end": "2513520"
  },
  {
    "text": "there's customer service and get like you know I want a free trial like all right cool here's the username password to the FTP site but the FTP site doesn't",
    "start": "2513520",
    "end": "2521839"
  },
  {
    "text": "just provide like the downloadable software it also is like what their texts use while they're on site so they",
    "start": "2521839",
    "end": "2528680"
  },
  {
    "text": "upload like all types of like client information to this FTP site and so you can get like I was there was like a ton",
    "start": "2528680",
    "end": "2534960"
  },
  {
    "text": "of different universities where I just pulled like their entire you can see like every card number value",
    "start": "2534960",
    "end": "2541520"
  },
  {
    "text": "everything like just totally like so I told them about it and they never responded of course but later on they removed it but was just like like come",
    "start": "2541520",
    "end": "2548240"
  },
  {
    "text": "on man really like what's happening here um anyway so so the the web bricks um",
    "start": "2548240",
    "end": "2555319"
  },
  {
    "text": "the back end has two major parts it's a web UI um and that's where kind of all of your system uh you know the uh",
    "start": "2555319",
    "end": "2562240"
  },
  {
    "text": "security people and uh you know everybody who manages the system logs in through they can associate my pretty",
    "start": "2562240",
    "end": "2568119"
  },
  {
    "text": "picture with my card value uh and do all that stuff on that back end and then the controller again just gets pushed that",
    "start": "2568119",
    "end": "2574640"
  },
  {
    "text": "data um and it doesn't get my picture the controller doesn't care about how pretty I am um all it cares about is the",
    "start": "2574640",
    "end": "2580359"
  },
  {
    "text": "number that's I'm associated with uh and then there's also this over TCP 470",
    "start": "2580359",
    "end": "2586240"
  },
  {
    "text": "there's also the interface to the controller and so it implements its own protocol um the protocol is plain text",
    "start": "2586240",
    "end": "2592400"
  },
  {
    "text": "by default uh there are ways to encrypt it um but it's like you know you really have to like try to do this it's like",
    "start": "2592400",
    "end": "2598559"
  },
  {
    "text": "not something like just click this button and everything's secure uh you have to like do stuff um so that kind of",
    "start": "2598559",
    "end": "2603760"
  },
  {
    "text": "sucks but the the the the pl Tex protocol is really easy to decipher it's a proprietary protocol but again it's",
    "start": "2603760",
    "end": "2610040"
  },
  {
    "text": "super simple it's all uh you know semicolon delimited um and uh you know",
    "start": "2610040",
    "end": "2615280"
  },
  {
    "text": "without saying anything very specific uh if you play with some of those values",
    "start": "2615280",
    "end": "2620440"
  },
  {
    "text": "there are definitely like stack overflows up the wazu uh in the the software and it's just horrible like",
    "start": "2620440",
    "end": "2627640"
  },
  {
    "text": "yeah it's bad um if you're able to sniff that communication if you're able to get",
    "start": "2627640",
    "end": "2633520"
  },
  {
    "text": "on that same segment you can see because it's plain text you can see all the card values are going back and forth so if you trying to get card values again you",
    "start": "2633520",
    "end": "2640119"
  },
  {
    "text": "can just pull those out um you can actually inject into that stream uh if you're in the a good spot on the network",
    "start": "2640119",
    "end": "2647040"
  },
  {
    "text": "as well um and that was shown in Defcon 17 uh with this open sesame. py",
    "start": "2647040",
    "end": "2652319"
  },
  {
    "text": "basically they used um on a different back end it wasn't web bricks it was a different one um they used uh T TCP",
    "start": "2652319",
    "end": "2659480"
  },
  {
    "text": "sequence number uh prediction to inject data into the stream and then do things like open doors and that kind of",
    "start": "2659480",
    "end": "2665400"
  },
  {
    "text": "stuff uh the web U is absolutely full with like Sequel and all like the you know web stuff it's all over the place",
    "start": "2665400",
    "end": "2672960"
  },
  {
    "text": "you know Anonymous loves it um but the really fun stuff is uh kind of the more",
    "start": "2672960",
    "end": "2678440"
  },
  {
    "text": "serious exploits that exist in there and um I I still haven't heard back from those guys about it so I'm not going to",
    "start": "2678440",
    "end": "2684680"
  },
  {
    "text": "disclose any of them even though it's been like over six months um but uh but",
    "start": "2684680",
    "end": "2690280"
  },
  {
    "text": "I I have released all of these uh peach fuzzer xmls so like I I kind of I know",
    "start": "2690280",
    "end": "2695800"
  },
  {
    "text": "people don't like Peach um but I like to use it to do data modeling so if I'm trying to reverse a protocol and and",
    "start": "2695800",
    "end": "2701440"
  },
  {
    "text": "figure out how things are put together I use Peach to in its nice friendly XML format to make all of that data",
    "start": "2701440",
    "end": "2707200"
  },
  {
    "text": "structure and see what it all looks like and then the added side is then I can use that XML to start fuzzing the the",
    "start": "2707200",
    "end": "2713240"
  },
  {
    "text": "network protocols and stuff um so I I published all of the um fuzzer xmls uh",
    "start": "2713240",
    "end": "2720160"
  },
  {
    "text": "so um you know if you were so inclined to just basically run Peach with that XML against one of those things uh you'd",
    "start": "2720160",
    "end": "2726480"
  },
  {
    "text": "find a of fun stuff um and then I also uh also did the the xmls for the",
    "start": "2726480",
    "end": "2732559"
  },
  {
    "text": "discovery process so if you wanted to fuzz the controller and maybe find stuff there um you can use those xmls um and",
    "start": "2732559",
    "end": "2739520"
  },
  {
    "text": "then you can look for things beyond that uh all right so that's the presentation usually take a little bit",
    "start": "2739520",
    "end": "2745160"
  },
  {
    "text": "longer because we we would have this amazing light show um but hopefully it",
    "start": "2745160",
    "end": "2750480"
  },
  {
    "text": "was in your mind's eye every time I said door open uh any questions",
    "start": "2750480",
    "end": "2758920"
  },
  {
    "text": "guys oh sorry",
    "start": "2758960",
    "end": "2762480"
  },
  {
    "text": "one in so I haven't looked at the myair",
    "start": "2764960",
    "end": "2770760"
  },
  {
    "text": "cards um and I I think like uh hid uses like the dezire my fair CL cards or",
    "start": "2770760",
    "end": "2777960"
  },
  {
    "text": "whatever um I've looked at my fair cards in a different uh just for academic like my own purposes but not in these systems",
    "start": "2777960",
    "end": "2784319"
  },
  {
    "text": "um but my guess would be because of how every everything is dependent on the card values um the myair card would",
    "start": "2784319",
    "end": "2791599"
  },
  {
    "text": "actually have the same value that it's still being sent so it's still you know from the reader to the card there's",
    "start": "2791599",
    "end": "2797440"
  },
  {
    "text": "security but after the reader it's all the same so you can you know use those same Yan tools to mess around with stuff",
    "start": "2797440",
    "end": "2804319"
  },
  {
    "text": "uh sorry you had a question here",
    "start": "2804319",
    "end": "2807520"
  },
  {
    "text": "yeah oh yeah that's a good idea like am I owned like people ask that question a lot so if you take out your card uh some",
    "start": "2809839",
    "end": "2816160"
  },
  {
    "text": "of the cards may have um it really depends on the card but uh there's the",
    "start": "2816160",
    "end": "2821200"
  },
  {
    "text": "traditional hid clam shell cards um which are they're they're kind of like",
    "start": "2821200",
    "end": "2827960"
  },
  {
    "text": "you can see like a line around them and then on the back they kind of have like an almost a oval back shape to them then",
    "start": "2827960",
    "end": "2833280"
  },
  {
    "text": "usually in the back is imprinted something um and usually they they'll either say like proar 2 on them and",
    "start": "2833280",
    "end": "2839520"
  },
  {
    "text": "they're written like kind of right on the top uh the proxar 2 they'll usually say on them um or they may say nothing",
    "start": "2839520",
    "end": "2845160"
  },
  {
    "text": "it really depends on that um for the iclass cards they always uh at least every iclass card that I've seen it says",
    "start": "2845160",
    "end": "2850960"
  },
  {
    "text": "iclass on it so if you just look on the back it'll say hid iclass um I I have",
    "start": "2850960",
    "end": "2856240"
  },
  {
    "text": "equipment here to determine if it's a low frequency or high frequency card but it doesn't really uh help you out too much um yeah cool any other questions in",
    "start": "2856240",
    "end": "2864119"
  },
  {
    "text": "the back yeah what are the recommendations",
    "start": "2864119",
    "end": "2870000"
  },
  {
    "text": "for a secure environment um well the there's certain there's certain",
    "start": "2870000",
    "end": "2875640"
  },
  {
    "text": "mitigating controls you can put in in place for some of this stuff so I've had a client actually this is a this is a a",
    "start": "2875640",
    "end": "2880839"
  },
  {
    "text": "pretty interesting story um so we were onsite at a client and we were um we uh",
    "start": "2880839",
    "end": "2886720"
  },
  {
    "text": "we were doing a physical test for them and we were trying to Brute Force the card values right uh and they just fired",
    "start": "2886720",
    "end": "2893520"
  },
  {
    "text": "this like crazy guy employee and they were really worried that this guy was going to try to get back in the building",
    "start": "2893520",
    "end": "2900119"
  },
  {
    "text": "um so we were brute forcing these values and just so happened to hit his car",
    "start": "2900119",
    "end": "2907200"
  },
  {
    "text": "value so they get an alert and like I I don't know I didn't know you can do this",
    "start": "2907200",
    "end": "2912760"
  },
  {
    "text": "but apparently you can set up these systems to alert on when certain cards come up so they got an alert that this",
    "start": "2912760",
    "end": "2917880"
  },
  {
    "text": "guy Not only was in the building already but trying to access the data center so they came running at us like full force",
    "start": "2917880",
    "end": "2925200"
  },
  {
    "text": "and like no like you know they just like came running out we gave them like the you know like we're okay like talk to",
    "start": "2925200",
    "end": "2931680"
  },
  {
    "text": "your boss we're nice and uh that got out of it um but so the the kind of response",
    "start": "2931680",
    "end": "2937400"
  },
  {
    "text": "to the question is is you know you can have good mitigating supplemental controls so that if you see like",
    "start": "2937400",
    "end": "2943079"
  },
  {
    "text": "anything where you know a reader maybe is going offline uh indicating that maybe somebody's trying to dump the keys",
    "start": "2943079",
    "end": "2948400"
  },
  {
    "text": "out of the iclass cards um I haven't looked at some of the newer cards so I don't know if they're they're better uh",
    "start": "2948400",
    "end": "2954559"
  },
  {
    "text": "but these cards are are what they are in the presentation um or you can set up these alerts that say you know if you",
    "start": "2954559",
    "end": "2960040"
  },
  {
    "text": "see like 15 tries in a row uh you know maybe raise an alarm like I don't know",
    "start": "2960040",
    "end": "2966119"
  },
  {
    "text": "if you can put that logic in there but uh potentially you can send like SNMP alerts or something and monor that um",
    "start": "2966119",
    "end": "2973000"
  },
  {
    "text": "another thing somebody told me which I totally do not believe but I feel like I always have to say it because he could not he might be telling the truth is",
    "start": "2973000",
    "end": "2980119"
  },
  {
    "text": "that he said in his system he put it up he said it up so that um if you brute",
    "start": "2980119",
    "end": "2985400"
  },
  {
    "text": "force too many times it locks out every Brute Force card so like to me that's like an",
    "start": "2985400",
    "end": "2992359"
  },
  {
    "text": "immediate Doss right like I mean now I can just like like block everybody out of the building like really easily so",
    "start": "2992359",
    "end": "2998920"
  },
  {
    "text": "like I don't you know whatever you might be able to do that if you wanted to too um I hope he doesn't see this",
    "start": "2998920",
    "end": "3005880"
  },
  {
    "text": "ever uh any other questions cool guys if you have any other questions feel free to send me an",
    "start": "3005880",
    "end": "3011720"
  },
  {
    "text": "email check out the GitHub and blog. opencity research is the blog that I uh kind of do with",
    "start": "3011720",
    "end": "3018359"
  },
  {
    "text": "thanks",
    "start": "3022359",
    "end": "3025359"
  }
]