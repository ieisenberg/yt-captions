[
  {
    "text": "um hello everybody finally I'm here Amsterdam the",
    "start": "880",
    "end": "7080"
  },
  {
    "text": "best place to give a talk so yeah the title of the talk is Lights Off the",
    "start": "7080",
    "end": "12559"
  },
  {
    "text": "Darkness of the smart meters at the beginning it was a talk only to speak about how to modify or how and how to",
    "start": "12559",
    "end": "19320"
  },
  {
    "text": "play with Hardware how to do all the dumping of the firware reversing the",
    "start": "19320",
    "end": "24560"
  },
  {
    "text": "firmware connecting to all the devices all the microchips the microprocessor",
    "start": "24560",
    "end": "30119"
  },
  {
    "text": "and everything but we needed of course we needed like a sample a hardware a",
    "start": "30119",
    "end": "35879"
  },
  {
    "text": "piece of Hardware to play with to do something with them so we just chose we",
    "start": "35879",
    "end": "41680"
  },
  {
    "text": "randomly chose randomly completely randomly this uh Smart",
    "start": "41680",
    "end": "46879"
  },
  {
    "text": "Meters H we are from Spain that's why our accent is so hot for the American",
    "start": "46879",
    "end": "52440"
  },
  {
    "text": "girls and uh can you raise the volume please or maybe this one",
    "start": "52440",
    "end": "58440"
  },
  {
    "text": "is no okay anyway so um as you can imagine um",
    "start": "58440",
    "end": "66080"
  },
  {
    "text": "in Spain we are installing some smart meters and maybe the smart meter we are speaking about is from Spain or maybe",
    "start": "66080",
    "end": "73280"
  },
  {
    "text": "it's not so let's start with the presentation",
    "start": "73280",
    "end": "78520"
  },
  {
    "text": "like in all the talks this is the boring part he is kavier he's my partner we",
    "start": "78520",
    "end": "83720"
  },
  {
    "text": "have been doing some other research about car hacking actually those devices that you can see over there in that",
    "start": "83720",
    "end": "89600"
  },
  {
    "text": "picture here are devices that we extracted from the cars and we started playing with them and he's a hardware",
    "start": "89600",
    "end": "96200"
  },
  {
    "text": "guy he's like kind of different than me I'm more in the software like everybody",
    "start": "96200",
    "end": "101360"
  },
  {
    "text": "but he's one of these Geeks guys who works with hardware and it's always with the dirty hands and with toys arounds",
    "start": "101360",
    "end": "108520"
  },
  {
    "text": "and he's from the south of Spain cadth if you have not been in cadth in the south of Spain you should go definitely",
    "start": "108520",
    "end": "115479"
  },
  {
    "text": "there's like super good food and super funny people",
    "start": "115479",
    "end": "120600"
  },
  {
    "text": "and that's me I'm the one on the left I'm not the old one that's my grandpa",
    "start": "120600",
    "end": "128440"
  },
  {
    "text": "but uh yeah I'm Alberto I work in software in the software part I do red",
    "start": "128440",
    "end": "135040"
  },
  {
    "text": "teaming do pen testing for a big company in the Bay Area and it's really fun",
    "start": "135040",
    "end": "140519"
  },
  {
    "text": "doing red teaming actually is really really fun that's more or less the",
    "start": "140519",
    "end": "145800"
  },
  {
    "text": "introduction about us and we we are really really excited to be here to be",
    "start": "145800",
    "end": "153599"
  },
  {
    "text": "in black hat to be in Amsterdam and I'm going to explain you why why is that we are so excited to be here first of all",
    "start": "153599",
    "end": "161400"
  },
  {
    "text": "is that we feel like home we are from Spain and we were here like some hundred of years ago so we",
    "start": "161400",
    "end": "168840"
  },
  {
    "text": "feel like coming back again to the place where we started like with our Wars and",
    "start": "168840",
    "end": "174879"
  },
  {
    "text": "everything being like what Spanish was once upon a time so I think that",
    "start": "174879",
    "end": "181080"
  },
  {
    "text": "everybody knows this painting from Basque Las Lanas",
    "start": "181080",
    "end": "186920"
  },
  {
    "text": "anyway and that's not something happened yep okay another",
    "start": "186920",
    "end": "194400"
  },
  {
    "text": "thing that why we like being here is because they have the best coffee ever I",
    "start": "194400",
    "end": "200400"
  },
  {
    "text": "know about the Colombia but n actually it's not the best in Colombia and or like South America you can see this kind",
    "start": "200400",
    "end": "207200"
  },
  {
    "text": "of coffee shops they sell coffee they're awesome they're really really cool so",
    "start": "207200",
    "end": "212239"
  },
  {
    "text": "that's the other reason why we are so excited to be here and the other reason the last reason why we are so excited",
    "start": "212239",
    "end": "218000"
  },
  {
    "text": "because you know the World Cup I know don't say anything about spending the World Cup this year or last year no this",
    "start": "218000",
    "end": "224879"
  },
  {
    "text": "year actually um but we saw in the in the World Cup we saw watching soccer",
    "start": "224879",
    "end": "231920"
  },
  {
    "text": "that the best fans are here too definitely so that's why we are so",
    "start": "231920",
    "end": "238000"
  },
  {
    "text": "excited and we appreciate so much fla to give us the opportunity to be here speaking in front of all of",
    "start": "238000",
    "end": "243920"
  },
  {
    "text": "you thank you so let's start with the main topic",
    "start": "243920",
    "end": "249159"
  },
  {
    "text": "of the of the of the talk so what are we speaking about what is the target of",
    "start": "249159",
    "end": "254640"
  },
  {
    "text": "This research so the target it's Hardware as I said at the beginning it's",
    "start": "254640",
    "end": "261280"
  },
  {
    "text": "Hardware we want to show how important is like do proper Security in Hardware",
    "start": "261280",
    "end": "266520"
  },
  {
    "text": "devices it's not everything about websites and the fac Ms and all these",
    "start": "266520",
    "end": "273759"
  },
  {
    "text": "things that are in the news every day people is for is forgetting about all these Hardware devices now maybe with",
    "start": "273759",
    "end": "280880"
  },
  {
    "text": "the scata systems things are getting better but people is really not paying attention to the security of those",
    "start": "280880",
    "end": "287759"
  },
  {
    "text": "Hardware devices that's why we wanted to do something so actually failing to do",
    "start": "287759",
    "end": "293800"
  },
  {
    "text": "this kind of security is not only going to give you some problems with manipulation of data or stealing data",
    "start": "293800",
    "end": "301080"
  },
  {
    "text": "maybe there is something else that you can do if you modify these Hardware devices and the thing that it was like",
    "start": "301080",
    "end": "308080"
  },
  {
    "text": "very scary for jair and for for me is that these devices are mandatory like",
    "start": "308080",
    "end": "313199"
  },
  {
    "text": "for for sucessfully being installed in your homes that's it you can say no I",
    "start": "313199",
    "end": "319080"
  },
  {
    "text": "don't want this device and that was something that was pretty scary for us like oh you're",
    "start": "319080",
    "end": "326039"
  },
  {
    "text": "handling all the the electricity from my place from my home with this device and there",
    "start": "326039",
    "end": "333319"
  },
  {
    "text": "is no option to say no I still want a guy to come to my place and take notice",
    "start": "333319",
    "end": "338919"
  },
  {
    "text": "of I mean take a note with the how how much electricity did did I spend that",
    "start": "338919",
    "end": "344560"
  },
  {
    "text": "was kind of ugly for us so we started",
    "start": "344560",
    "end": "349600"
  },
  {
    "text": "looking in these devices and actually ah I don't know why the quality",
    "start": "349600",
    "end": "356840"
  },
  {
    "text": "is not good anyway it says we took took this thing from a data seat right it was a data seat from a micro micr processor",
    "start": "356840",
    "end": "364840"
  },
  {
    "text": "or something microcontroller sorry and it says there are dishonest and possibly",
    "start": "364840",
    "end": "370560"
  },
  {
    "text": "illegal methods used to bridge blah blah blah blah blah code protection",
    "start": "370560",
    "end": "375840"
  },
  {
    "text": "dishonest really um so it's saying oh if somebody",
    "start": "375840",
    "end": "381199"
  },
  {
    "text": "takes a look of to these devices if somebody wants to know how these devices work this people that people is",
    "start": "381199",
    "end": "387680"
  },
  {
    "text": "dishonest and I saw how I'm completely dishonest but I saw him yeah okay so the thing that we said",
    "start": "387680",
    "end": "395120"
  },
  {
    "text": "no no I don't believe in this so let's take a look at it so first the",
    "start": "395120",
    "end": "401919"
  },
  {
    "text": "the first thing we we we did is like okay how these devices are connected one to each other how is the the",
    "start": "401919",
    "end": "409319"
  },
  {
    "text": "communication between the devices and the the company who is retrieving the",
    "start": "409319",
    "end": "414680"
  },
  {
    "text": "information from uh our like the span of our I mean how many how much electricity",
    "start": "414680",
    "end": "421319"
  },
  {
    "text": "did we spend so we saw that there are like two micro processor one who is like",
    "start": "421319",
    "end": "426720"
  },
  {
    "text": "a microcontroller where who is like taking care of the power line communication the PLC there is one guy",
    "start": "426720",
    "end": "434160"
  },
  {
    "text": "who is taking care of the PLC communication so you he receives data and he sends that data to the other guy",
    "start": "434160",
    "end": "441400"
  },
  {
    "text": "who is an arm H microcontroller and you can access remotely using PLC that's the way how",
    "start": "441400",
    "end": "448240"
  },
  {
    "text": "PLC works or you can use an optical Port that these devices have on the on the",
    "start": "448240",
    "end": "453759"
  },
  {
    "text": "front we have a couple of devices here and all the tools we used we will s we will s them to you we're going to be in",
    "start": "453759",
    "end": "460720"
  },
  {
    "text": "in Arsenal later so you can just approach us and take a look and do whatever you want with them and those",
    "start": "460720",
    "end": "467720"
  },
  {
    "text": "devices can be used as an entry point to the network you have one of these devices",
    "start": "467720",
    "end": "472919"
  },
  {
    "text": "you are in the network oh nice perfect and the thing is that any meter does",
    "start": "472919",
    "end": "479560"
  },
  {
    "text": "very important any any meter can be hooked up into any node so the things how how this things work is like there",
    "start": "479560",
    "end": "486280"
  },
  {
    "text": "like there's like a bunch of meters and all these meters are connected to a node and that node is connected to the",
    "start": "486280",
    "end": "492159"
  },
  {
    "text": "centrals to the command and control where the guys are like billing you okay",
    "start": "492159",
    "end": "497479"
  },
  {
    "text": "so it's the the registration is automatic you just plag the device it",
    "start": "497479",
    "end": "503199"
  },
  {
    "text": "works that was interesting for us too how these devices are being like registered have been registered in the",
    "start": "503199",
    "end": "510000"
  },
  {
    "text": "in the network you can act as ad relay that's super funny we will speak about it",
    "start": "510000",
    "end": "516159"
  },
  {
    "text": "later and meters can receive remote remote commands that's something super",
    "start": "516159",
    "end": "521880"
  },
  {
    "text": "interesting for us that's what we wanted to to check if that commands are being",
    "start": "521880",
    "end": "527720"
  },
  {
    "text": "like checked the integrity and the everything you know actually this is how it works there",
    "start": "527720",
    "end": "535040"
  },
  {
    "text": "are some meters that you have in your home those meters are connected to node",
    "start": "535040",
    "end": "540480"
  },
  {
    "text": "and that node is connected by GSM or Wi-Fi or whatever to the Head",
    "start": "540480",
    "end": "546240"
  },
  {
    "text": "headquarters or the command control as I call them as I call it and they use a",
    "start": "546240",
    "end": "552519"
  },
  {
    "text": "management interface and they play cards and everything and they build you that's more or less how these devices work and",
    "start": "552519",
    "end": "560880"
  },
  {
    "text": "something about the the relay that I said before like this any meter can be hooked up no they can act as relay",
    "start": "560880",
    "end": "569720"
  },
  {
    "text": "for up to eight levels that's what happen so it's not necessary that the",
    "start": "569720",
    "end": "575600"
  },
  {
    "text": "that the node is directly connected to your device there must be other device",
    "start": "575600",
    "end": "581120"
  },
  {
    "text": "in the middle of your smart meter and the node because they will act as a",
    "start": "581120",
    "end": "588040"
  },
  {
    "text": "relay they will broadcast whatever you want for you hey I'm not seeing the node",
    "start": "588040",
    "end": "593399"
  },
  {
    "text": "can you give this packet to the note yeah of course I will so that's how these things are connected each other",
    "start": "593399",
    "end": "601320"
  },
  {
    "text": "other and security yeah that's the fun part the communications are secur by AES",
    "start": "601360",
    "end": "610240"
  },
  {
    "text": "that's it it's AES let's move that's that's it if a I'm sorry if AES is there",
    "start": "610240",
    "end": "616640"
  },
  {
    "text": "everything is secure everybody knows it's encrypted AES is used by the governments and it's super secure so B",
    "start": "616640",
    "end": "624440"
  },
  {
    "text": "perfect nailed it no that's not everything okay do you want to",
    "start": "624440",
    "end": "630640"
  },
  {
    "text": "change yeah I want to talk too man so yeah basically as alverto was saying um",
    "start": "630640",
    "end": "637279"
  },
  {
    "text": "the communications are secured just by as 1228 which means the payload and it",
    "start": "637279",
    "end": "642760"
  },
  {
    "text": "contents every command everything it just has uh this layer encryption nothing else otherwise it's",
    "start": "642760",
    "end": "648639"
  },
  {
    "text": "plain the optical Port itself is secured just by a simple challenge which we will",
    "start": "648639",
    "end": "654120"
  },
  {
    "text": "see how difficult is to retrieve uh there is a due to low stuff",
    "start": "654120",
    "end": "661000"
  },
  {
    "text": "there is some specific um frequency not so a specific modulation",
    "start": "661000",
    "end": "666680"
  },
  {
    "text": "but the frequency that is only used for electric companies um so it should not",
    "start": "666680",
    "end": "672480"
  },
  {
    "text": "be so straightforward to be able to sniff data or to interact at all with",
    "start": "672480",
    "end": "679920"
  },
  {
    "text": "it and yeah there's some tamper stuff uh",
    "start": "679920",
    "end": "685959"
  },
  {
    "text": "we will show a closeup later or maybe we we will see it on the PC uh the device has a battery uh for the",
    "start": "685959",
    "end": "693240"
  },
  {
    "text": "main controller and there's a switch in the PCB which is actually checking when you have open the bottom uh cover which",
    "start": "693240",
    "end": "700440"
  },
  {
    "text": "is the one that has uh the wires so once you open that uh an alarm is set and you",
    "start": "700440",
    "end": "706760"
  },
  {
    "text": "will see in the display an indicator saying that you had temper",
    "start": "706760",
    "end": "711839"
  },
  {
    "text": "it so basically it looks nice but if you don't secure your Hardware",
    "start": "711839",
    "end": "720399"
  },
  {
    "text": "so yeah temper detection uh we can see on the left let's try to zoom it",
    "start": "721720",
    "end": "729600"
  },
  {
    "text": "in yeah here is like the bottom where the arrow point is just like",
    "start": "729600",
    "end": "736120"
  },
  {
    "text": "um no it's a switch a pressure switch so it's uh actually normally pushed once",
    "start": "736120",
    "end": "742560"
  },
  {
    "text": "you take the cover out it will go out so it will be released and then you will get this nice triangle",
    "start": "742560",
    "end": "749320"
  },
  {
    "text": "which can only be removed by Service uh blah",
    "start": "749320",
    "end": "754560"
  },
  {
    "text": "blah and there's even uh further alarms uh against manipulation and stuff",
    "start": "756040",
    "end": "763360"
  },
  {
    "text": "basically when you want to do some hot wiring whatever so the meter is detecting that the current is going",
    "start": "763360",
    "end": "770639"
  },
  {
    "text": "backwards uh or there's a short or there some alteration we'll say it will get",
    "start": "770639",
    "end": "776480"
  },
  {
    "text": "into an state that is called alarm and it will be it well yeah it should be",
    "start": "776480",
    "end": "783440"
  },
  {
    "text": "impossible to uh recover from that unless you have the service tools",
    "start": "783440",
    "end": "791040"
  },
  {
    "text": "whatever and yeah this is really important so this is a PCB with super",
    "start": "791040",
    "end": "797240"
  },
  {
    "text": "nice quality uh okay so I'll try to focus the",
    "start": "797240",
    "end": "803160"
  },
  {
    "text": "yellow spot if you can see it like in the middle of the screen is actually the PLC mod and which is handling also the",
    "start": "803160",
    "end": "808760"
  },
  {
    "text": "encryption and all the communications with external World P",
    "start": "808760",
    "end": "814240"
  },
  {
    "text": "PLC and um the infed port is rooted to there to its left the blue dot is the",
    "start": "814240",
    "end": "822199"
  },
  {
    "text": "PLC flash which holds the firware for the flash PLC has no internal uh memory",
    "start": "822199",
    "end": "828480"
  },
  {
    "text": "so if you want to load code or anything it should be stored in external memory",
    "start": "828480",
    "end": "833639"
  },
  {
    "text": "cool do you say something way with that so we are saying that P PLC is the one",
    "start": "833639",
    "end": "838680"
  },
  {
    "text": "who take takes cares of the encryption okay everything that you receives comes",
    "start": "838680",
    "end": "844480"
  },
  {
    "text": "to the arrives to the PLC that's the the the yellow one and it doesn't have an",
    "start": "844480",
    "end": "849959"
  },
  {
    "text": "internal memory and it's the one who take carees of the cryption so where is the where's the",
    "start": "849959",
    "end": "857399"
  },
  {
    "text": "key okay the key went for a coffee it will be back",
    "start": "858440",
    "end": "864680"
  },
  {
    "text": "so and let's Zoom again in right so whoa",
    "start": "864680",
    "end": "870680"
  },
  {
    "text": "down there with the Red Dot is the main uh microcontroller it's an STM",
    "start": "870680",
    "end": "877000"
  },
  {
    "text": "32f uh basically an AR 7 core so pretty standard yeah and and the",
    "start": "877000",
    "end": "884639"
  },
  {
    "text": "bottom right corner with a white tis spt how do you paint here man yeah hello can",
    "start": "884639",
    "end": "892360"
  },
  {
    "text": "you like Mark the yeah this guy okay yeah like in the somehow Circle",
    "start": "892360",
    "end": "898360"
  },
  {
    "text": "that's the AO uh where there are two things well actually three things store in there the",
    "start": "898360",
    "end": "905240"
  },
  {
    "text": "first one is like partial finger updates so some code is run of the external IO",
    "start": "905240",
    "end": "911399"
  },
  {
    "text": "cool uh we store there the reports also for the power consumption stuff blah",
    "start": "911399",
    "end": "916680"
  },
  {
    "text": "blah and some configuration that is taken into account uh during Boot and to",
    "start": "916680",
    "end": "922000"
  },
  {
    "text": "the left of the fancy Circle there's like a square rectangle",
    "start": "922000",
    "end": "927399"
  },
  {
    "text": "connector one second yeah this guy over here I'm going to try to do it better oh yeah oh yeah yeah so",
    "start": "927399",
    "end": "935680"
  },
  {
    "text": "that guy is the deac connector which is like perfectly hidden no one would guess",
    "start": "935680",
    "end": "942279"
  },
  {
    "text": "and so that's an overview I mean like when it comes to security that's like",
    "start": "942279",
    "end": "948079"
  },
  {
    "text": "the most important uh those are the most important",
    "start": "948079",
    "end": "953199"
  },
  {
    "text": "components so yeah microcontroller as we were talking it's I said course 7 okay",
    "start": "953199",
    "end": "959839"
  },
  {
    "text": "an N3 yeah I don't even know the stuff so it's an STM 32f 101 it has 255 kiloby",
    "start": "959839",
    "end": "966240"
  },
  {
    "text": "of flash they only use like half of it so okay cool it runs on 3.3 and it has",
    "start": "966240",
    "end": "973399"
  },
  {
    "text": "like several stuff as we've seen on the PCB and yeah uh even though there was a",
    "start": "973399",
    "end": "978680"
  },
  {
    "text": "debu connector when you try to use jtac it seems not to work I mean that's something wrong with it maybe my device",
    "start": "978680",
    "end": "984880"
  },
  {
    "text": "maybe something but yay s swd is enabled",
    "start": "984880",
    "end": "990360"
  },
  {
    "text": "so Bingo yeah AWD normally people know about JTAG and is the most like common",
    "start": "990360",
    "end": "997319"
  },
  {
    "text": "debugging connection protocol used to debug this kind of uh of Hardware but S swd I didn't know about it before I",
    "start": "997319",
    "end": "1003959"
  },
  {
    "text": "started doing these things to be honest but H we saw that it was enabled and you",
    "start": "1003959",
    "end": "1009360"
  },
  {
    "text": "can do everything you can do the same that with JTAG but you only need two wires so it's like oh great so thank you",
    "start": "1009360",
    "end": "1018959"
  },
  {
    "text": "very much for that so here as you can see actually you need two wires but you",
    "start": "1018959",
    "end": "1024720"
  },
  {
    "text": "need a vcc2 and you need ground at the end so and cl and reset yeah reset too",
    "start": "1024720",
    "end": "1031160"
  },
  {
    "text": "so at the end it's like five wires you need five wires to be connected to this uh the ports that are like enabled there",
    "start": "1031160",
    "end": "1038480"
  },
  {
    "text": "to do the bugging and that's it so it's super easy yeah and actually can you go back",
    "start": "1038480",
    "end": "1045880"
  },
  {
    "text": "yep one second uh the battery we were talking about for that detects the tamper even when the thing is offline",
    "start": "1045880",
    "end": "1051320"
  },
  {
    "text": "it's the white roundish stuff there so yeah it's easy to spot as well yeah so",
    "start": "1051320",
    "end": "1058600"
  },
  {
    "text": "yeah okay there is no JT JT is disabled everything's like oh awesome these guys did an awesome job no s WG is s WD is",
    "start": "1058600",
    "end": "1066919"
  },
  {
    "text": "there perfect so thank you very much I don't need to connect like four wires",
    "start": "1066919",
    "end": "1071960"
  },
  {
    "text": "now it's only two awesome so okay I'll keep on with this",
    "start": "1071960",
    "end": "1077760"
  },
  {
    "text": "yep uh so yeah yeah the PLC as we were talking earlier the PLC just one moment like just to clarify there the main",
    "start": "1077760",
    "end": "1084480"
  },
  {
    "text": "things are there are two microcontrollers one of them is the PLC that acts like a router like a modem",
    "start": "1084480",
    "end": "1090760"
  },
  {
    "text": "just get the information decrypt it and send it to the MCU that's like the",
    "start": "1090760",
    "end": "1095799"
  },
  {
    "text": "things that you have to to have very clear two microcontrollers PLC who gets the information and acts as a modem and",
    "start": "1095799",
    "end": "1103320"
  },
  {
    "text": "the the MCU that is the one is the arm microcontroller is the one that have the",
    "start": "1103320",
    "end": "1108520"
  },
  {
    "text": "code itself the firware that is useful sorry for it yeah",
    "start": "1108520",
    "end": "1114200"
  },
  {
    "text": "so yeah the 7581 actually if you try to Google for it it's it doesn't exist",
    "start": "1114200",
    "end": "1121960"
  },
  {
    "text": "officially it's an ASC so custom made and yeah so special and different we",
    "start": "1121960",
    "end": "1128440"
  },
  {
    "text": "will see and it's based on 85 8051 processor architecture whose",
    "start": "1128440",
    "end": "1135200"
  },
  {
    "text": "assembly is like really awesome like I like it a lot sarcasm and it has a",
    "start": "1135200",
    "end": "1141280"
  },
  {
    "text": "built-in AES 128 engine which is the one used for crypto so it's Hardware",
    "start": "1141280",
    "end": "1147200"
  },
  {
    "text": "accelerated yeah as we were saying earlier it has no internal programmable memory so it lows we called it custom",
    "start": "1147200",
    "end": "1155679"
  },
  {
    "text": "somehow it went from external flash it's an an actually an SPI Flash and somewhat",
    "start": "1155679",
    "end": "1163400"
  },
  {
    "text": "it's starting at of 1,000 for some reason then it's using the uart for the",
    "start": "1163400",
    "end": "1170640"
  },
  {
    "text": "optical Port it has some uh level shifter uh to prevent uh isolation and",
    "start": "1170640",
    "end": "1177039"
  },
  {
    "text": "stuff like that and between the microcontroller the MCU the armm and the",
    "start": "1177039",
    "end": "1183400"
  },
  {
    "text": "PLC the communication is handled by i2c uh it uses like some uh two inputs",
    "start": "1183400",
    "end": "1190679"
  },
  {
    "text": "just uh for the art B rate so it's hardw configur and it runs on a lot of voltages which is a lot of",
    "start": "1190679",
    "end": "1197320"
  },
  {
    "text": "fun so here dou be picture yeah it's pretty clear so this is just a zoom from the",
    "start": "1197320",
    "end": "1204400"
  },
  {
    "text": "previous shot the yellow is the PLC and the Flash is right next to it so yeah",
    "start": "1204400",
    "end": "1209799"
  },
  {
    "text": "it's actually pretty hard to get the code it took us like two months to be able to theol of The Flash",
    "start": "1209799",
    "end": "1217880"
  },
  {
    "text": "no so yeah again we saw there was wow super zo we",
    "start": "1217880",
    "end": "1225120"
  },
  {
    "text": "saw there was like uh a Flash and external SP flash we look at the pin out this is the",
    "start": "1225120",
    "end": "1231760"
  },
  {
    "text": "official data sheet stuff yeah I see txrx on the top left so uart is there",
    "start": "1231760",
    "end": "1239000"
  },
  {
    "text": "okay sure for the optical Port but where's the",
    "start": "1239000",
    "end": "1244400"
  },
  {
    "text": "SPI I mean yeah I lock of reserved reserved reserved it's like the wine",
    "start": "1244400",
    "end": "1250360"
  },
  {
    "text": "it's all reserved and stuff and not connected not connected sure but no SPI so yeah it's it's it's a",
    "start": "1250360",
    "end": "1258799"
  },
  {
    "text": "AIC is especially made for them yeah we will see that is not true yeah",
    "start": "1258799",
    "end": "1266440"
  },
  {
    "text": "so yeah like you know all the components now we show you all the components The",
    "start": "1266440",
    "end": "1271919"
  },
  {
    "text": "Flash the EO the the microcontrollers everything so let's dump everything",
    "start": "1271919",
    "end": "1278720"
  },
  {
    "text": "let's check what's inside all those components now we know that the PLC is",
    "start": "1278720",
    "end": "1283919"
  },
  {
    "text": "connected with the MCU that the PLC have a flash memory that there is an EO memory over there that we don't know yet",
    "start": "1283919",
    "end": "1290799"
  },
  {
    "text": "who is using that memory from the eom so let's dump everything let's dump the MCU",
    "start": "1290799",
    "end": "1296640"
  },
  {
    "text": "we can do it we have the S swd to do it the protocol we spoke about before",
    "start": "1296640",
    "end": "1301679"
  },
  {
    "text": "perfect let's use it EO you just have to dump it you don't need anything special",
    "start": "1301679",
    "end": "1308360"
  },
  {
    "text": "and the Flash is the same okay the PLC flash that's the other thing that ja was",
    "start": "1308360",
    "end": "1314120"
  },
  {
    "text": "saying like Okay there is a flash who is used by the PLC but there's no connection between them according to the",
    "start": "1314120",
    "end": "1320279"
  },
  {
    "text": "pin out what what's that okay and the rest like yeah the PLC the important",
    "start": "1320279",
    "end": "1326679"
  },
  {
    "text": "thing here the PLC is like the modem it's like a modem is the gateway to access to the rest of the",
    "start": "1326679",
    "end": "1332039"
  },
  {
    "text": "components and that means if the PLC it's only acting as a router as a mod as",
    "start": "1332039",
    "end": "1338559"
  },
  {
    "text": "a like taking the information decrypting it taking the packets decrypting it and sending it to the MCU who is the one who",
    "start": "1338559",
    "end": "1345159"
  },
  {
    "text": "have all the frameware all the important things the MCU",
    "start": "1345159",
    "end": "1350279"
  },
  {
    "text": " the PLC I mean I I I don't give a  about it so PLC is just handling",
    "start": "1350279",
    "end": "1356760"
  },
  {
    "text": "encryption so bad sorry for my French so uh PLC is just handling the encryption",
    "start": "1356760",
    "end": "1362400"
  },
  {
    "text": "it's encryption encrypting and decrypting that's it super dumb H",
    "start": "1362400",
    "end": "1368559"
  },
  {
    "text": "microcontroller so and the key is the same for all the units that's very important does somebody know who AES is",
    "start": "1368559",
    "end": "1376799"
  },
  {
    "text": "symmetric asymmetric yeah you all know symmetric encryption",
    "start": "1376799",
    "end": "1382400"
  },
  {
    "text": "so they are using symmetric encryption and this key is the same in all the",
    "start": "1382400",
    "end": "1389159"
  },
  {
    "text": "meters can somebody join the the dots that's bad he yes yes super secure top",
    "start": "1389159",
    "end": "1396200"
  },
  {
    "text": "secret documents of the CIA are stored using AES of course but the secret key I",
    "start": "1396200",
    "end": "1402799"
  },
  {
    "text": "mean nobody have the secret key only buo or the president of whatever no so",
    "start": "1402799",
    "end": "1407840"
  },
  {
    "text": "anybody anybody here can have the key that's the thing all the customers all",
    "start": "1407840",
    "end": "1414240"
  },
  {
    "text": "the persons in whatever country these smart meters are installed they have the",
    "start": "1414240",
    "end": "1419760"
  },
  {
    "text": "key to encrypt and decrypt all the communications everything so yes what's",
    "start": "1419760",
    "end": "1426000"
  },
  {
    "text": "the point of having as nothing and another thing we are still",
    "start": "1426000",
    "end": "1431279"
  },
  {
    "text": "researching about is a optical Port because if you do something weird you",
    "start": "1431279",
    "end": "1436640"
  },
  {
    "text": "can call to the company saying hey my smart meter is not working can you send somebody to fix it and to figure it out",
    "start": "1436640",
    "end": "1442279"
  },
  {
    "text": "what is going going on here and a technical a technician come to your house and connect a like um a optical",
    "start": "1442279",
    "end": "1450080"
  },
  {
    "text": "Port optical receiver and sender from to your device and they do something we are",
    "start": "1450080",
    "end": "1456159"
  },
  {
    "text": "still researching on that because the optical Port is very very expensive how much was it well actually besides being",
    "start": "1456159",
    "end": "1462960"
  },
  {
    "text": "expensive I mean the debuger for the at51 jte but as I said earlier we really",
    "start": "1462960",
    "end": "1468600"
  },
  {
    "text": "love 051 assembler so but how much was the I don't remember but I 400 bucks or",
    "start": "1468600",
    "end": "1475080"
  },
  {
    "text": "something like that I mean you have to to know these devices you can buy those devices for â‚¬300 each if you want to",
    "start": "1475080",
    "end": "1483720"
  },
  {
    "text": "create a network you at least need two not that's not a network or anything",
    "start": "1483720",
    "end": "1489520"
  },
  {
    "text": "and uh we burn a lot of those devices because yeah they are super isolated so",
    "start": "1489520",
    "end": "1497240"
  },
  {
    "text": "um we are actually researching about this optical Port communication but we",
    "start": "1497240",
    "end": "1502960"
  },
  {
    "text": "are connecting directly into the MCU and we are sending packets through H using",
    "start": "1502960",
    "end": "1509240"
  },
  {
    "text": "i2c because the MCU and the PLC are connecting using I uh ic2 it i2c sorry",
    "start": "1509240",
    "end": "1516840"
  },
  {
    "text": "so we are connecting directly and sending the same packets that the actual PLC will receive so at the end we are",
    "start": "1516840",
    "end": "1524279"
  },
  {
    "text": "doing this kind of trick to avoid paying like the 400 bucks it cost the the optical Port cost so that means that the",
    "start": "1524279",
    "end": "1532559"
  },
  {
    "text": "big price in the MCU that's super clear and uh okay let's dump it how can we",
    "start": "1532559",
    "end": "1539200"
  },
  {
    "text": "dump the frameware on the of the MCU okay let's use like the common programs",
    "start": "1539200",
    "end": "1544960"
  },
  {
    "text": "that you can use in you can uh search you can find in Internet St Link in this",
    "start": "1544960",
    "end": "1550039"
  },
  {
    "text": "case and let's do it okay I want to the back the code that's what everybody wants to do because just doing the um",
    "start": "1550039",
    "end": "1557279"
  },
  {
    "text": "doing the um dumping the firmware yeah dumping the firmware it's super easy",
    "start": "1557279",
    "end": "1562799"
  },
  {
    "text": "it's like two clicks at the end once you know of course how you need to do it and after that you can use Ida and GDB and",
    "start": "1562799",
    "end": "1569240"
  },
  {
    "text": "you can deag the code you can go through the code is a arm and it's kind of",
    "start": "1569240",
    "end": "1574600"
  },
  {
    "text": "easy and uh flash contents contents are not checked for integrity or",
    "start": "1574600",
    "end": "1579679"
  },
  {
    "text": "manipulation and the problem with this devices I was saying that before is that",
    "start": "1579679",
    "end": "1584840"
  },
  {
    "text": "they are not isolated and yeah you forget about isolation if you",
    "start": "1584840",
    "end": "1591840"
  },
  {
    "text": "are like so happy you want to deag the stuff and you say like yeah what's isolation",
    "start": "1591840",
    "end": "1597480"
  },
  {
    "text": "then let's Zoom it yeah that that's actually on the top",
    "start": "1597480",
    "end": "1603559"
  },
  {
    "text": "of the armm that's not a shadow I mean that's what's left of those",
    "start": "1603559",
    "end": "1608600"
  },
  {
    "text": "pins and okay and yeah this made someone really",
    "start": "1608600",
    "end": "1615200"
  },
  {
    "text": "happy the logic analyzer also yeah that's not not coffee I mean that's",
    "start": "1615200",
    "end": "1621200"
  },
  {
    "text": "something else so yeah uh obviously the meter and",
    "start": "1621200",
    "end": "1629960"
  },
  {
    "text": "some equipment got destroyed um we wanted to keep up with the research so",
    "start": "1629960",
    "end": "1637120"
  },
  {
    "text": "by then we didn't have uh more smart meters around so what we decided was to",
    "start": "1637120",
    "end": "1643600"
  },
  {
    "text": "make our own system I mean we had the dumps and it should not be so complex to",
    "start": "1643600",
    "end": "1648919"
  },
  {
    "text": "make it so what we did we got uh from",
    "start": "1648919",
    "end": "1654000"
  },
  {
    "text": "some really well-known chap uh selling place uh this development board for STM",
    "start": "1654000",
    "end": "1662279"
  },
  {
    "text": "and we swapped the microcontroller for the one that is actually being used in",
    "start": "1662279",
    "end": "1667600"
  },
  {
    "text": "the in the meter and we uploaded the flameware to",
    "start": "1667600",
    "end": "1672559"
  },
  {
    "text": "it so we hooked up the LCD also I mean",
    "start": "1673159",
    "end": "1678519"
  },
  {
    "text": "we have this device here we will be showing it later at arsenal we uploaded the code so yeah it was actually working",
    "start": "1678519",
    "end": "1686200"
  },
  {
    "text": "so we had a base system there we could keep on debugging the",
    "start": "1686200",
    "end": "1692080"
  },
  {
    "text": "code and yeah here it got like more funny with",
    "start": "1692120",
    "end": "1698480"
  },
  {
    "text": "more wires it was still not as crazy as it got but it's something and we were",
    "start": "1698480",
    "end": "1704279"
  },
  {
    "text": "emulating using Arduino uh specifically the the PLC modem because we were having",
    "start": "1704279",
    "end": "1710360"
  },
  {
    "text": "some trouble with it and U I don't know the name for the IC the one that is",
    "start": "1710360",
    "end": "1715840"
  },
  {
    "text": "really making the metering the measurements in the electricity so basically SPI and i2c emulation done",
    "start": "1715840",
    "end": "1723279"
  },
  {
    "text": "here on the system and that's the board with the screen and everything and on the right there's a level shifter with a",
    "start": "1723279",
    "end": "1729320"
  },
  {
    "text": "lot of resistors yeah and another thing that",
    "start": "1729320",
    "end": "1736840"
  },
  {
    "text": "was funny uh uh at the beginning uh I mean it was like 1 hour or two but it",
    "start": "1736840",
    "end": "1742679"
  },
  {
    "text": "really made me mad for 1 hour or two when I was first looking at this uh I",
    "start": "1742679",
    "end": "1748720"
  },
  {
    "text": "noticed that the thing kept getting reset after I launched the I got",
    "start": "1748720",
    "end": "1754960"
  },
  {
    "text": "attached to the device so I was like what's going on so yeah basically it was a Wast so we",
    "start": "1754960",
    "end": "1763399"
  },
  {
    "text": "had to shut it down and yeah okay so the problem here is we had",
    "start": "1763399",
    "end": "1771279"
  },
  {
    "text": "prepared the Demos in my laptop and I don't have a HDMI to VGA but anyway",
    "start": "1771279",
    "end": "1778559"
  },
  {
    "text": "we're going to do both uh both demos demos we're going to do it in the in the",
    "start": "1778559",
    "end": "1783720"
  },
  {
    "text": "Arsenal it's just after the talk or after the the break I think we're going to be doing like both demos one of them",
    "start": "1783720",
    "end": "1789919"
  },
  {
    "text": "is disa the the watch doog dumping the fiware ER attaching to with AA to the to",
    "start": "1789919",
    "end": "1797279"
  },
  {
    "text": "the back this the the the code and disabling the the watch do that's the first demo that we are going to do and",
    "start": "1797279",
    "end": "1804240"
  },
  {
    "text": "we are super happy to show you after after a while in the in Arsenal yeah my",
    "start": "1804240",
    "end": "1811039"
  },
  {
    "text": "laptop was not ready for the demo sadly and the superum again we can imagine",
    "start": "1811039",
    "end": "1817679"
  },
  {
    "text": "there's something there I mean like uh basically the what we wanted to show",
    "start": "1817679",
    "end": "1822880"
  },
  {
    "text": "here is um once you get the damp uh pretty straightforward",
    "start": "1822880",
    "end": "1828600"
  },
  {
    "text": "you get some aski strings which are somewhat interesting so I mean it's not that",
    "start": "1828600",
    "end": "1838158"
  },
  {
    "text": "difficult and yeah this is important so a little bit about uh this is just some",
    "start": "1838399",
    "end": "1843559"
  },
  {
    "text": "reversing I mean it's basic stuff but we thought it would be good to show it so",
    "start": "1843559",
    "end": "1848919"
  },
  {
    "text": "basically not basic for me uh so basically let this is part of",
    "start": "1848919",
    "end": "1854320"
  },
  {
    "text": "the data sheet we say we have already our code dumped and we load the Ona and we know because we Trace down the pins",
    "start": "1854320",
    "end": "1861480"
  },
  {
    "text": "that the communication between the microcontroller and the PLC is being done by i2c in this case by i2c 2 which",
    "start": "1861480",
    "end": "1870080"
  },
  {
    "text": "is the second port for i2c i2c one is reserved for the EO so we want to check",
    "start": "1870080",
    "end": "1876240"
  },
  {
    "text": "what's going on we go to the data sheet and we check for the offsets those are memory offsets and we can check it's",
    "start": "1876240",
    "end": "1883159"
  },
  {
    "text": "like 4,580 so remember that number",
    "start": "1883159",
    "end": "1889919"
  },
  {
    "text": "then I'll actually go one ahead okay I'll show this yeah sure then we saw",
    "start": "1890840",
    "end": "1897440"
  },
  {
    "text": "that there was a range it was not just a single value then within that range you can I see imagine also or trust us on",
    "start": "1897440",
    "end": "1904799"
  },
  {
    "text": "this like there are a few bytes and each bite is a register basically uh",
    "start": "1904799",
    "end": "1909960"
  },
  {
    "text": "depending on the offset that is added like we said the Base address was",
    "start": "1909960",
    "end": "1916399"
  },
  {
    "text": "4,580 if it would be like",
    "start": "1916399",
    "end": "1920880"
  },
  {
    "text": "5,810 actually 10 then it would be the ITC data register which we should be",
    "start": "1922120",
    "end": "1927720"
  },
  {
    "text": "able to see here so where the data that is uh incoming or outgoing is stored in this",
    "start": "1927720",
    "end": "1933639"
  },
  {
    "text": "case so yeah we saw that on the data sheet now let's see how we use that yeah",
    "start": "1933639",
    "end": "1939720"
  },
  {
    "text": "it's very very important to use the data sheet everything is there you don't need to be like fighting against the code and",
    "start": "1939720",
    "end": "1946360"
  },
  {
    "text": "debagging the same thing every time until you realize where the actual packets that are being forwarded from",
    "start": "1946360",
    "end": "1953480"
  },
  {
    "text": "the appc are coming from just go to the data sheet you know that those both both devices are connecting using that",
    "start": "1953480",
    "end": "1959639"
  },
  {
    "text": "protocol let's check exactly what memory address what memory range the the code",
    "start": "1959639",
    "end": "1965200"
  },
  {
    "text": "is used is using to access to that that that uh that packet and that's it so",
    "start": "1965200",
    "end": "1970760"
  },
  {
    "text": "yeah it's very very very important using the data SE reading the data SE one time and another time and another time and at",
    "start": "1970760",
    "end": "1977600"
  },
  {
    "text": "the end and everything makes sense so yeah in this case we're going to show we already know what it does we call it PLC",
    "start": "1977600",
    "end": "1984799"
  },
  {
    "text": "Handler so if we see uh here in the square box uh well not square but",
    "start": "1984799",
    "end": "1991840"
  },
  {
    "text": "rectangular it's loading the offset from the i2c into R9 which is a register",
    "start": "1991840",
    "end": "1997039"
  },
  {
    "text": "basically it's loading the offset for it which means it might be using it later yeah that's the address that we saw",
    "start": "1997039",
    "end": "2002960"
  },
  {
    "text": "before in the data SE then remember that the offset was stored in uh R9 we see",
    "start": "2002960",
    "end": "2010760"
  },
  {
    "text": "it's moving uh c0 which in this case we already told you is the address for the",
    "start": "2010760",
    "end": "2016440"
  },
  {
    "text": "i2c peripheral which is the PLC so it's moving the the address for",
    "start": "2016440",
    "end": "2022000"
  },
  {
    "text": "it into R1 it's coping R9 which is the address for the uh i2c peripheral to r z",
    "start": "2022000",
    "end": "2028440"
  },
  {
    "text": "and then it's Branch into another sub which we already know is i2c right and yeah then you can see well you",
    "start": "2028440",
    "end": "2037799"
  },
  {
    "text": "can imagine that to the right the orange one is 10 which we could see in the data sheet that was the data register so",
    "start": "2037799",
    "end": "2045360"
  },
  {
    "text": "basically in coming outco and it's a story in uh of set 10 of R zero which was it",
    "start": "2045360",
    "end": "2052679"
  },
  {
    "text": "Toc blah blah blah into R1 which is the offset for the peripheral so basically this is like send",
    "start": "2052679",
    "end": "2058520"
  },
  {
    "text": "c0 like all the stuff of that so that's uh an example just on how do you check",
    "start": "2058520",
    "end": "2065520"
  },
  {
    "text": "in code or find where the communication is happening or where something is happening if we want for example to",
    "start": "2065520",
    "end": "2072638"
  },
  {
    "text": "check like how is the light being turned off then obviously what would be the first step let's see how the data is",
    "start": "2072639",
    "end": "2079599"
  },
  {
    "text": "being handled by the PLC then we know that the relay is uh connected to a PIN",
    "start": "2079599",
    "end": "2086560"
  },
  {
    "text": "to a transistor to whatever um which we can look in the data sheet for the offset then we will",
    "start": "2086560",
    "end": "2093118"
  },
  {
    "text": "see like what other have inside there would go uh to that pin and then we can know what data is expected just to close",
    "start": "2093119",
    "end": "2101240"
  },
  {
    "text": "this down so yeah to clarify more the things for me that I'm a software guy not not a",
    "start": "2101240",
    "end": "2108400"
  },
  {
    "text": "hardware Guy this is like the typical break point that you place in receive or send in the AP in the apis reer send you",
    "start": "2108400",
    "end": "2116640"
  },
  {
    "text": "need to you know when you're debugging some or you're reversing some uh binary that's the typical thing that you need",
    "start": "2116640",
    "end": "2122720"
  },
  {
    "text": "to set that those two break points to know exactly where is the data that I'm receiving where's the data that I'm",
    "start": "2122720",
    "end": "2128920"
  },
  {
    "text": "sending okay so here is the same it's more complicated because you need to go to data seat to know exactly what memory",
    "start": "2128920",
    "end": "2134680"
  },
  {
    "text": "address is using blah blah blah blah blah but this actually very similar to placing the the break points in those",
    "start": "2134680",
    "end": "2141240"
  },
  {
    "text": "two apis the common apis that everybody knows yeah so at this time that we will",
    "start": "2141240",
    "end": "2148079"
  },
  {
    "text": "be able to do this demo so uh let me check yeah we should change",
    "start": "2148079",
    "end": "2153400"
  },
  {
    "text": "this so",
    "start": "2153400",
    "end": "2156599"
  },
  {
    "text": "he's telling me to tell you a joke but I'm super bad telling jokes so I'm going to",
    "start": "2159160",
    "end": "2164880"
  },
  {
    "text": "pass so yeah here we have two um smart MERS one of them was prepared to do the",
    "start": "2164880",
    "end": "2171240"
  },
  {
    "text": "first demo and the other one was prepared to do the second one can can you just uh active yeah put yeah perfect",
    "start": "2171240",
    "end": "2177960"
  },
  {
    "text": "yeah my right arm yeah you can s them like a little",
    "start": "2177960",
    "end": "2185920"
  },
  {
    "text": "bit basally uh yeah I can see there thanks so basically this is the the",
    "start": "2185920",
    "end": "2193000"
  },
  {
    "text": "meter we're going to use in the demo don't kick the camera I know you don't like it but so yeah I mean we have here",
    "start": "2193000",
    "end": "2201079"
  },
  {
    "text": "externally soldered aom like yeah like here's the the",
    "start": "2201079",
    "end": "2208560"
  },
  {
    "text": "external the apro itself solder is for ISO fuse we will see now how and these",
    "start": "2208560",
    "end": "2213640"
  },
  {
    "text": "wires other ones are just for the debugger so yeah",
    "start": "2213640",
    "end": "2219280"
  },
  {
    "text": "so let's see if we don't burn anything or anyone let's PL this",
    "start": "2219280",
    "end": "2225560"
  },
  {
    "text": "here yeah now don't touch it so boom let's see can we move the",
    "start": "2227880",
    "end": "2234160"
  },
  {
    "text": "camera no okay one second okay so we can see as we can see",
    "start": "2234160",
    "end": "2241960"
  },
  {
    "text": "it is an alarm State as we were saying we can turn it off it will turn off",
    "start": "2241960",
    "end": "2248640"
  },
  {
    "text": "takes a while yeah you turn it on alarm I mean like man nothing to be done here",
    "start": "2248640",
    "end": "2254280"
  },
  {
    "text": "like yeah you you played with this",
    "start": "2254280",
    "end": "2258720"
  },
  {
    "text": "so yeah we're going to do something on this",
    "start": "2269359",
    "end": "2274078"
  },
  {
    "text": "laptop yeah he just he just removed the EO memory and he's connecting the apro",
    "start": "2274640",
    "end": "2279839"
  },
  {
    "text": "memory to the to this uh programmer to dump",
    "start": "2279839",
    "end": "2284960"
  },
  {
    "text": "the all the code in AIM yeah",
    "start": "2284960",
    "end": "2289800"
  },
  {
    "text": "whatever do you need me to handle this so now this device it's completely",
    "start": "2290240",
    "end": "2297920"
  },
  {
    "text": "locked it's blocked you can't do anything with it because it knows that you have been playing with it it's like",
    "start": "2297920",
    "end": "2304520"
  },
  {
    "text": "some kind of security that they Implement so you can be like you can't keep playing with the device until you",
    "start": "2304520",
    "end": "2311200"
  },
  {
    "text": "unlock it actually according to the manufacturer you can't only you can only",
    "start": "2311200",
    "end": "2316280"
  },
  {
    "text": "unlock this device if you call the you know the support service or something",
    "start": "2316280",
    "end": "2321480"
  },
  {
    "text": "yeah where are the support service yeah",
    "start": "2321480",
    "end": "2328680"
  },
  {
    "text": "oh okay nobody see anything",
    "start": "2330760",
    "end": "2336160"
  },
  {
    "text": "okay there was nothing important",
    "start": "2343200",
    "end": "2347200"
  },
  {
    "text": "there so we saw the thing was in our arm so I guess we would expect like",
    "start": "2353720",
    "end": "2361200"
  },
  {
    "text": "yeah we need to do a lot of stuff to calculate something is the Aon it's going to be secure should not be easy to",
    "start": "2361200",
    "end": "2369760"
  },
  {
    "text": "modify yeah I I like zeros yeah let's place a couple of zeros",
    "start": "2369760",
    "end": "2376160"
  },
  {
    "text": "there yeah we all love zeros it will work I think just zeros okay let's",
    "start": "2376160",
    "end": "2384119"
  },
  {
    "text": "program we just modify that place in the aom and just fill it with",
    "start": "2385200",
    "end": "2391520"
  },
  {
    "text": "zeros randomly yeah I mean like yeah zeros",
    "start": "2391520",
    "end": "2397960"
  },
  {
    "text": "there should be a check zom yeah Yoo so that's what everybody thinks",
    "start": "2397960",
    "end": "2403400"
  },
  {
    "text": "if you modify something in the in some address in the EO there must be some Tex Zoom some CRC something to check if uh",
    "start": "2403400",
    "end": "2411839"
  },
  {
    "text": "whatever thing was modified or not so",
    "start": "2411839",
    "end": "2417280"
  },
  {
    "text": "now okay yeah okay so",
    "start": "2417280",
    "end": "2422760"
  },
  {
    "text": "second let's see like boom not yet yeah oh don't show",
    "start": "2422760",
    "end": "2430359"
  },
  {
    "text": "that oh oh and now yeah no no show it closer",
    "start": "2430359",
    "end": "2437000"
  },
  {
    "text": "so no yeah he's so scared okay the thing is it's working",
    "start": "2437000",
    "end": "2443520"
  },
  {
    "text": "again I mean like if you can see it second it this yeah yeah there's no longer an",
    "start": "2443520",
    "end": "2451520"
  },
  {
    "text": "alarm with zeros yeah so we can still play with it we don't need to spend another 300 to buy another one that's",
    "start": "2451520",
    "end": "2459000"
  },
  {
    "text": "like my grandma I remember the first time I I bought my grandma a phone a cell phone and she said I son you need",
    "start": "2459000",
    "end": "2466119"
  },
  {
    "text": "to buy me another one the battery run off I I run out of battery like no you can charge it so there like something",
    "start": "2466119",
    "end": "2471839"
  },
  {
    "text": "similar here at the beginning we were thinking about buying another one but then we said okay let's take a look if",
    "start": "2471839",
    "end": "2477000"
  },
  {
    "text": "you got the point uh basically uh changing the ID is very",
    "start": "2477000",
    "end": "2483640"
  },
  {
    "text": "difficult understand",
    "start": "2483839",
    "end": "2487839"
  },
  {
    "text": "yeah he wants to see my folders my private stuff no I really don't",
    "start": "2489359",
    "end": "2496920"
  },
  {
    "text": "okay okay so yeah the eom which is basically what we were doing right now",
    "start": "2496920",
    "end": "2503480"
  },
  {
    "text": "it's an i2c apro uh we was saying uh it can be read obviously with a standard",
    "start": "2503480",
    "end": "2509160"
  },
  {
    "text": "tools I mean it's an aom it holds like non-critical information like a keys Mac",
    "start": "2509160",
    "end": "2514960"
  },
  {
    "text": "configuration status arm I mean yeah all the thing that no one would like to",
    "start": "2514960",
    "end": "2520520"
  },
  {
    "text": "see even the fer updates and yeah there's at some",
    "start": "2520520",
    "end": "2528319"
  },
  {
    "text": "critical uh blocks uh which are not like the key and stuff the there there's some",
    "start": "2528319",
    "end": "2535079"
  },
  {
    "text": "sort of digest which is also very difficult to reverse zo in I mean like if you check",
    "start": "2535079",
    "end": "2541720"
  },
  {
    "text": "the block uh on the small square there the digest it's for every 128 uh bytes",
    "start": "2541720",
    "end": "2548440"
  },
  {
    "text": "which took a while to count but yeah basically that's it I",
    "start": "2548440",
    "end": "2555640"
  },
  {
    "text": "mean not not too difficult to reverse and then the PLC external flash we",
    "start": "2555640",
    "end": "2561240"
  },
  {
    "text": "talked about it earlier so that should be fast I mean just the SPI flash it holds the PLC mod and",
    "start": "2561240",
    "end": "2567599"
  },
  {
    "text": "firware and yeah the PCB so yeah we will show it later",
    "start": "2567599",
    "end": "2574200"
  },
  {
    "text": "closeup and anyway you should have seen it already like when we were showing the PCB there's no BGA which",
    "start": "2574200",
    "end": "2580839"
  },
  {
    "text": "anyway contrary to well okay yeah I should explain what's PGA just in case so ba means B grid array we are used to",
    "start": "2580839",
    "end": "2589040"
  },
  {
    "text": "IIs that have pins ba does not have pins as themselves they just have like uh on",
    "start": "2589040",
    "end": "2594520"
  },
  {
    "text": "the bottom an array of balls so you unless you dis older you are not able to",
    "start": "2594520",
    "end": "2601960"
  },
  {
    "text": "trace the pins and obviously you are not able to attach to the pins unless you use some specialized Hardware so it's",
    "start": "2601960",
    "end": "2609200"
  },
  {
    "text": "not a straight away like using pins so there are no BGA components on board which means everything is like P and",
    "start": "2609200",
    "end": "2615160"
  },
  {
    "text": "cool and so fast to attach to it and uh the PCB itself has two",
    "start": "2615160",
    "end": "2622119"
  },
  {
    "text": "layers which means that you can use this trick let's",
    "start": "2622119",
    "end": "2629119"
  },
  {
    "text": "see well can you put the camera for a second please",
    "start": "2630800",
    "end": "2637599"
  },
  {
    "text": "the I don't know if you can see the I don't know if you can see that the you can trace the the roots on the PCB",
    "start": "2644160",
    "end": "2652800"
  },
  {
    "text": "easily I mean with light so that helps you can can't see it in the camera but",
    "start": "2652800",
    "end": "2659200"
  },
  {
    "text": "yeah you can see it like in life if you want to take it later so basically it's easy to trace",
    "start": "2659200",
    "end": "2664800"
  },
  {
    "text": "the PCB also I mean like so far nothing has been too",
    "start": "2664800",
    "end": "2670160"
  },
  {
    "text": "difficult and yeah as we were saying earlier there's an external flash on the",
    "start": "2670160",
    "end": "2676000"
  },
  {
    "text": "PLC modem but we saw there was no SPI",
    "start": "2676000",
    "end": "2681200"
  },
  {
    "text": "interface I mean yeah I'm not going to show it again all around but yeah we saw it I mean",
    "start": "2681200",
    "end": "2686960"
  },
  {
    "text": "that's a pin out but if you look a little bit more on the",
    "start": "2686960",
    "end": "2695280"
  },
  {
    "text": "internet judia don't see SPI I mean it's to the right where it says M25 which stands for the model of the",
    "start": "2695480",
    "end": "2703000"
  },
  {
    "text": "flash but you see like the dark pinouts you see like some missile up there so",
    "start": "2703000",
    "end": "2709119"
  },
  {
    "text": "yeah SPI i2c I mean like yeah now it makes more sense so it's not so special",
    "start": "2709119",
    "end": "2716359"
  },
  {
    "text": "not such an",
    "start": "2716359",
    "end": "2719119"
  },
  {
    "text": "AIC so yeah and now that we know how everything works more or less let's take",
    "start": "2721520",
    "end": "2727520"
  },
  {
    "text": "another look in the in the data set because who doesn't like a",
    "start": "2727520",
    "end": "2733040"
  },
  {
    "text": "sniffers you can enable sniffer mode yeah by writing any code and just",
    "start": "2733280",
    "end": "2741319"
  },
  {
    "text": "reading all the packets that you're receiving no I just enable the sniffer mode and that's it awesome thank you",
    "start": "2741319",
    "end": "2746920"
  },
  {
    "text": "very much that was actually sorry uh what this means is like I can use a",
    "start": "2746920",
    "end": "2754200"
  },
  {
    "text": "power meter to sniff the data in the net net work I mean I can use the the",
    "start": "2754200",
    "end": "2759400"
  },
  {
    "text": "hardware itself it's ready I just need to send a a flag a configuration bite to the PLC and it becomes a sniffer so not",
    "start": "2759400",
    "end": "2768200"
  },
  {
    "text": "not really any major changes or magic just a bite actually I don't know why",
    "start": "2768200",
    "end": "2774160"
  },
  {
    "text": "they will need this it's fun man yeah I know and there's another thing that you can read in the in the data set the",
    "start": "2774160",
    "end": "2784079"
  },
  {
    "text": "key this is like super secur you know like keys of course is a common and of",
    "start": "2784079",
    "end": "2791400"
  },
  {
    "text": "course as it common insecurity you're free to retrieve the a key anytime I",
    "start": "2791400",
    "end": "2796520"
  },
  {
    "text": "mean just in case you lose it you should be able to retrieve it for safety so and that's the key who is in",
    "start": "2796520",
    "end": "2803359"
  },
  {
    "text": "all the devices and it's symmetric encryption so I don't know about",
    "start": "2803359",
    "end": "2810880"
  },
  {
    "text": "this so yeah if we don't know if we don't use this way to recover the key we",
    "start": "2810880",
    "end": "2817599"
  },
  {
    "text": "still can as we did just attach the Lo The Logical analyzer between the EO and",
    "start": "2817599",
    "end": "2823720"
  },
  {
    "text": "uh the MCU and that's it we will see where is the",
    "start": "2823720",
    "end": "2828880"
  },
  {
    "text": "key yeah actually one wayte like Alberto is saying since the key is stored in the AO and it's just right straightforward",
    "start": "2828880",
    "end": "2835880"
  },
  {
    "text": "the other way which tends to this data that we are seeing is a log of the communication between the PLC and the",
    "start": "2835880",
    "end": "2842079"
  },
  {
    "text": "microcontroller on the startup where all the setup parameters have been sent so obviously since we have a lot of storage",
    "start": "2842079",
    "end": "2848480"
  },
  {
    "text": "in the PLC internal memory I mean zero you need to get everything there so yeah",
    "start": "2848480",
    "end": "2853599"
  },
  {
    "text": "startup is like the best moment to get hold of all the data mhm was kind of",
    "start": "2853599",
    "end": "2859319"
  },
  {
    "text": "easy actually just start it and wait for the MCU to send the AES key to the PLC",
    "start": "2859319",
    "end": "2866400"
  },
  {
    "text": "to encrypt and decrypt of the data that's the first thing it needs to do because if not it doesn't have the key so another thing you can retrieve is the",
    "start": "2866400",
    "end": "2875000"
  },
  {
    "text": "Mac the identifier of the of the device so that's another interesting thing",
    "start": "2875000",
    "end": "2880440"
  },
  {
    "text": "because now you can change you can after that you can search for those uh those",
    "start": "2880440",
    "end": "2886640"
  },
  {
    "text": "bites in the aom dump and you can modify that so now you are somewhere else someone else so that's interesting being",
    "start": "2886640",
    "end": "2893520"
  },
  {
    "text": "another one in the network yeah and actually the we didn't mention it but I just remember H you can change all the",
    "start": "2893520",
    "end": "2900200"
  },
  {
    "text": "data in the air from the optical ports which means like uh basically you can",
    "start": "2900200",
    "end": "2905240"
  },
  {
    "text": "like just approach um meter and from the outside and change the data on the from",
    "start": "2905240",
    "end": "2910680"
  },
  {
    "text": "the ID and all that stuff so what happened",
    "start": "2910680",
    "end": "2916880"
  },
  {
    "text": "here as AES key can be extracted you can",
    "start": "2916880",
    "end": "2922200"
  },
  {
    "text": "do it so PLC the PLC the one who is",
    "start": "2922200",
    "end": "2929480"
  },
  {
    "text": "handling the communications can be hooked to a different custom external host or a",
    "start": "2929480",
    "end": "2936000"
  },
  {
    "text": "firware up date what happen if we force some kind of firmware update we have the",
    "start": "2936000",
    "end": "2941680"
  },
  {
    "text": "key we have as that's the way that it's checking that the packet is a correct",
    "start": "2941680",
    "end": "2947319"
  },
  {
    "text": "packet or not we can do it so act um like turning on the sniffer",
    "start": "2947319",
    "end": "2955799"
  },
  {
    "text": "mode and just see what kind of traffic we are receiving is check what payloads",
    "start": "2955799",
    "end": "2962920"
  },
  {
    "text": "are being received categorize all the payloads know what commands we can use",
    "start": "2962920",
    "end": "2969040"
  },
  {
    "text": "or not another thing to do it is fasing it we did something about did we did some fasing but anyway this is easier",
    "start": "2969040",
    "end": "2977240"
  },
  {
    "text": "why fast a device if you can just be listening to it listening the payloads that the device",
    "start": "2977240",
    "end": "2983680"
  },
  {
    "text": "accept so yeah as jaier said it's not a custom ASC at all it's just the normal",
    "start": "2983680",
    "end": "2991480"
  },
  {
    "text": "one they said it's costume because it's more fancy but it's not",
    "start": "2991480",
    "end": "2997200"
  },
  {
    "text": "and uh yeah what happen if you want to because these devices are made so the",
    "start": "2997200",
    "end": "3002880"
  },
  {
    "text": "command and control the electricity the the vendor the manufacturer the electricity company can send you a",
    "start": "3002880",
    "end": "3009400"
  },
  {
    "text": "command to say hey you didn't pay the bill I'm going to turn turn your lights off that's how it works that's why they",
    "start": "3009400",
    "end": "3016799"
  },
  {
    "text": "are implanting these devices because they don't need any longer any guide to go there and physically turn off your",
    "start": "3016799",
    "end": "3023160"
  },
  {
    "text": "your electricity uh now they can do it remotely so one of",
    "start": "3023160",
    "end": "3028599"
  },
  {
    "text": "the packet one of the commands must be turn turn off this specific smart meter",
    "start": "3028599",
    "end": "3034760"
  },
  {
    "text": "don't give don't give him more like electricity so what happen if we know",
    "start": "3034760",
    "end": "3041280"
  },
  {
    "text": "which is that payload to turn off a device we can turn off any device we",
    "start": "3041280",
    "end": "3048400"
  },
  {
    "text": "have the AES key that and that key is exactly the same in all the devices we",
    "start": "3048400",
    "end": "3054200"
  },
  {
    "text": "thought that this key was different for for each uh node what for each node yeah",
    "start": "3054200",
    "end": "3061559"
  },
  {
    "text": "for each node for each like all the devices are connected to node so we thought okay maybe this key is uh",
    "start": "3061559",
    "end": "3069079"
  },
  {
    "text": "different for each node for each like bunch of smart meters but no so we can",
    "start": "3069079",
    "end": "3076280"
  },
  {
    "text": "do these kind of things we can do so we we thought okay what can a smart meter",
    "start": "3076280",
    "end": "3081880"
  },
  {
    "text": "do reply to consumption stats request so the not will say hey give me how much",
    "start": "3081880",
    "end": "3088359"
  },
  {
    "text": "did you spend this month this month and you will say hey this is what I spent",
    "start": "3088359",
    "end": "3093440"
  },
  {
    "text": "this is how many how much electricity I used okay that's what a smart miror can do remote enable or disable power supply",
    "start": "3093440",
    "end": "3101720"
  },
  {
    "text": "that's a function of the smart meter be used as a Gateway into the network you are already into the network once you",
    "start": "3101720",
    "end": "3108160"
  },
  {
    "text": "just pluging into the power line that's it you can update his own firmware",
    "start": "3108160",
    "end": "3114000"
  },
  {
    "text": "that's very scary up dating the firmware you can do that and you have a a unique",
    "start": "3114000",
    "end": "3120920"
  },
  {
    "text": "ID in the network th those things are like the normal things that the smart meter can do so what can we do we can",
    "start": "3120920",
    "end": "3129400"
  },
  {
    "text": "reply with fake consumption stats I don't want to pay my",
    "start": "3129400",
    "end": "3135440"
  },
  {
    "text": "bills so okay I just spent like two cents during this month of electricity",
    "start": "3135440",
    "end": "3142359"
  },
  {
    "text": "that's it yep we can heavily enable able or disable the power",
    "start": "3142359",
    "end": "3148799"
  },
  {
    "text": "supply I don't like my neighbor he's an  so it's fun right I didn't do it",
    "start": "3148799",
    "end": "3158680"
  },
  {
    "text": "but you can do it you can enable or disable because at the end is the same",
    "start": "3158680",
    "end": "3163880"
  },
  {
    "text": "commands that a normal smart miror can do you can get access into a network you are already in the network once you have",
    "start": "3163880",
    "end": "3170079"
  },
  {
    "text": "a smart meter you can force a fancy costume finware update",
    "start": "3170079",
    "end": "3177280"
  },
  {
    "text": "Custom Custom is the other one okay so you know what I",
    "start": "3177280",
    "end": "3183160"
  },
  {
    "text": "mean and of course you can spoof another meter ID and now you can be another one",
    "start": "3183160",
    "end": "3189880"
  },
  {
    "text": "so that's another interesting thing and of course you can do whatever you want So at the",
    "start": "3189880",
    "end": "3196319"
  },
  {
    "text": "end maybe these kind of things can happen so that's why you really need to",
    "start": "3196319",
    "end": "3204839"
  },
  {
    "text": "take care of the security of like these Hardware devices because at the end there's not only information there",
    "start": "3204839",
    "end": "3211000"
  },
  {
    "text": "is not only databases there are not only passwords what can be stolen like in the normal software life here's something",
    "start": "3211000",
    "end": "3219880"
  },
  {
    "text": "else and that's it thank you everybody for being here today listening to us to",
    "start": "3219880",
    "end": "3226599"
  },
  {
    "text": "our family and friends they're always there where we need them and thank you to all those who wants to understand how",
    "start": "3226599",
    "end": "3233160"
  },
  {
    "text": "and why things works thank you very much you have to speak now yeah now I have to",
    "start": "3233160",
    "end": "3238440"
  },
  {
    "text": "speak Yoo so basically just a little add to what Alberto was saying like let's imagine the Esq was really secured it",
    "start": "3238440",
    "end": "3245720"
  },
  {
    "text": "was not like senta and stuff still we are in control of the AES encryption",
    "start": "3245720",
    "end": "3252599"
  },
  {
    "text": "Hardware because we will be sending I mean we got the plane data and plane data is been sent to the PLC modem we",
    "start": "3252599",
    "end": "3259760"
  },
  {
    "text": "don't even need to know the key I mean we can just like get one Hardware unit",
    "start": "3259760",
    "end": "3265799"
  },
  {
    "text": "and just uh take out the microcontroller the armm or put custom f on it and make",
    "start": "3265799",
    "end": "3271799"
  },
  {
    "text": "it do make the PLC the encryp with encryption do the job for us you don't need the key so it it's not just that",
    "start": "3271799",
    "end": "3279720"
  },
  {
    "text": "the key is sent and stored un safely but just how the security is handled that's",
    "start": "3279720",
    "end": "3285079"
  },
  {
    "text": "one point another Point regarding the finger update like if we can trigger",
    "start": "3285079",
    "end": "3290559"
  },
  {
    "text": "finger updates which is not difficult we can create a warm that will shut down the",
    "start": "3290559",
    "end": "3298280"
  },
  {
    "text": "electricity and send the update to others so we can create like a long-term",
    "start": "3298280",
    "end": "3305040"
  },
  {
    "text": "blackout not difficult that would be like the most uh scary attack to say it",
    "start": "3305040",
    "end": "3312359"
  },
  {
    "text": "somehow and that's possible so that's just all I wanted to",
    "start": "3312359",
    "end": "3319319"
  },
  {
    "text": "add so as a was saying like thank all of you for being here today to our family",
    "start": "3319319",
    "end": "3324920"
  },
  {
    "text": "and our friends and to everyone who likes to understand why and how things works so thank you very",
    "start": "3324920",
    "end": "3332079"
  },
  {
    "text": "much thank you",
    "start": "3332079",
    "end": "3336280"
  }
]