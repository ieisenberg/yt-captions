[
  {
    "start": "0",
    "end": "50000"
  },
  {
    "text": "hello thank you for coming first of all",
    "start": "4960",
    "end": "8639"
  },
  {
    "text": "uh my name is Nick this is Andrew from",
    "start": "8639",
    "end": "10800"
  },
  {
    "text": "cystic and narf industries we're here to",
    "start": "10800",
    "end": "13200"
  },
  {
    "text": "give our talk orchestrate this uh",
    "start": "13200",
    "end": "15040"
  },
  {
    "text": "kubernetes rot",
    "start": "15040",
    "end": "16320"
  },
  {
    "text": "kit and it wouldn't have been possible",
    "start": "16320",
    "end": "18320"
  },
  {
    "text": "without the help of our contractor",
    "start": "18320",
    "end": "19880"
  },
  {
    "text": "intern in the back heroa so look at him",
    "start": "19880",
    "end": "22080"
  },
  {
    "text": "please make him feel s",
    "start": "22080",
    "end": "24560"
  },
  {
    "text": "conscious and uh we'll get started I've",
    "start": "24560",
    "end": "27800"
  },
  {
    "text": "been going around asking the room uh",
    "start": "27800",
    "end": "29400"
  },
  {
    "text": "what brought you here kubernetes or the",
    "start": "29400",
    "end": "31160"
  },
  {
    "text": "root kid or both so we'll do a little",
    "start": "31160",
    "end": "32758"
  },
  {
    "text": "poll so if the answer is kubernetes hand",
    "start": "32759",
    "end": "34840"
  },
  {
    "text": "up",
    "start": "34840",
    "end": "36280"
  },
  {
    "text": "quick about half the room now root",
    "start": "36280",
    "end": "40680"
  },
  {
    "text": "kit less than half the room and if you",
    "start": "40680",
    "end": "43360"
  },
  {
    "text": "know both and like both raise a hand",
    "start": "43360",
    "end": "46760"
  },
  {
    "text": "please okay more than I thought",
    "start": "46760",
    "end": "50399"
  },
  {
    "start": "50000",
    "end": "60000"
  },
  {
    "text": "cool uh just to get into it we'll do",
    "start": "50399",
    "end": "52840"
  },
  {
    "text": "some background and then we'll talk",
    "start": "52840",
    "end": "54359"
  },
  {
    "text": "about the cube kit itself and we'll go",
    "start": "54359",
    "end": "56840"
  },
  {
    "text": "into ways to fix things at the very end",
    "start": "56840",
    "end": "58559"
  },
  {
    "text": "and do Q&A at the endend",
    "start": "58559",
    "end": "61000"
  },
  {
    "start": "60000",
    "end": "143000"
  },
  {
    "text": "so in 30 seconds in casee you don't know",
    "start": "61000",
    "end": "63000"
  },
  {
    "text": "what a root KCK can do is it hides",
    "start": "63000",
    "end": "65158"
  },
  {
    "text": "things right there's a good quote from",
    "start": "65159",
    "end": "67280"
  },
  {
    "text": "the guy on the bottom of the",
    "start": "67280",
    "end": "68880"
  },
  {
    "text": "screen with a root kit you're just",
    "start": "68880",
    "end": "70680"
  },
  {
    "text": "putting a bit where it doesn't go or",
    "start": "70680",
    "end": "72360"
  },
  {
    "text": "taking away one where it should be right",
    "start": "72360",
    "end": "74439"
  },
  {
    "text": "so that's the main goal stealth and of",
    "start": "74439",
    "end": "78080"
  },
  {
    "text": "course when you do have roote access you",
    "start": "78080",
    "end": "80280"
  },
  {
    "text": "want to maintain persistence so that's a",
    "start": "80280",
    "end": "81759"
  },
  {
    "text": "common feature that they all have that a",
    "start": "81759",
    "end": "83720"
  },
  {
    "text": "lot of them do",
    "start": "83720",
    "end": "85079"
  },
  {
    "text": "have and for the higher level ones the",
    "start": "85079",
    "end": "87920"
  },
  {
    "text": "more sophisticated ones you also use",
    "start": "87920",
    "end": "89560"
  },
  {
    "text": "them to maintain Commander control right",
    "start": "89560",
    "end": "92799"
  },
  {
    "text": "and the uh sky is the limit on as to",
    "start": "92799",
    "end": "94799"
  },
  {
    "text": "what you can do once you are root so",
    "start": "94799",
    "end": "97280"
  },
  {
    "text": "that's why the bullet points say",
    "start": "97280",
    "end": "98479"
  },
  {
    "text": "basically anything else right your",
    "start": "98479",
    "end": "100000"
  },
  {
    "text": "imagination is as far as you can go it",
    "start": "100000",
    "end": "102799"
  },
  {
    "text": "does require privilege so that's why",
    "start": "102799",
    "end": "104119"
  },
  {
    "text": "there is the word root in it you need to",
    "start": "104119",
    "end": "106079"
  },
  {
    "text": "be root to run rot kit and you can have",
    "start": "106079",
    "end": "109079"
  },
  {
    "text": "a chal module which is the most common",
    "start": "109079",
    "end": "110960"
  },
  {
    "text": "form but as you'll see later you can",
    "start": "110960",
    "end": "113200"
  },
  {
    "text": "also have unit user space",
    "start": "113200",
    "end": "115280"
  },
  {
    "text": "components and the Common Thread between",
    "start": "115280",
    "end": "118479"
  },
  {
    "text": "the two you know user land or Cal mode",
    "start": "118479",
    "end": "120600"
  },
  {
    "text": "is that you do have root privilege in",
    "start": "120600",
    "end": "121759"
  },
  {
    "text": "both",
    "start": "121759",
    "end": "123159"
  },
  {
    "text": "cases um in the chart we have a little",
    "start": "123159",
    "end": "125360"
  },
  {
    "text": "example uh a very common root kit",
    "start": "125360",
    "end": "127399"
  },
  {
    "text": "diamorphine which you probably a lot of",
    "start": "127399",
    "end": "128879"
  },
  {
    "text": "you have seen is a straight up Kel",
    "start": "128879",
    "end": "131080"
  },
  {
    "text": "module that hides processes and an",
    "start": "131080",
    "end": "133560"
  },
  {
    "text": "example of a user mode rootkit that that",
    "start": "133560",
    "end": "136040"
  },
  {
    "text": "does the same thing is Li process Hider",
    "start": "136040",
    "end": "138959"
  },
  {
    "text": "which you use via LV preload to",
    "start": "138959",
    "end": "141800"
  },
  {
    "text": "basically perform the same",
    "start": "141800",
    "end": "143480"
  },
  {
    "start": "143000",
    "end": "206000"
  },
  {
    "text": "function so a little intro to kubernetes",
    "start": "143480",
    "end": "146720"
  },
  {
    "text": "just in case a lot of you guys already",
    "start": "146720",
    "end": "148239"
  },
  {
    "text": "know know what it is from the hands but",
    "start": "148239",
    "end": "150640"
  },
  {
    "text": "um basically we want to orchestrate",
    "start": "150640",
    "end": "152200"
  },
  {
    "text": "containers using some sort of runtime uh",
    "start": "152200",
    "end": "154840"
  },
  {
    "text": "so container D cryo in this case we'll",
    "start": "154840",
    "end": "156959"
  },
  {
    "text": "show a bit of Docker fun later on um",
    "start": "156959",
    "end": "160360"
  },
  {
    "text": "give it some ml that describes your",
    "start": "160360",
    "end": "161920"
  },
  {
    "text": "services and it should orchestrate and",
    "start": "161920",
    "end": "164360"
  },
  {
    "text": "manage everything for you um something",
    "start": "164360",
    "end": "166720"
  },
  {
    "text": "that might come up uh a bit for those",
    "start": "166720",
    "end": "168840"
  },
  {
    "text": "that know kubernetes um when we talk",
    "start": "168840",
    "end": "170879"
  },
  {
    "text": "about Nam spaces in this talk we're",
    "start": "170879",
    "end": "172879"
  },
  {
    "text": "probably going to usually be talking",
    "start": "172879",
    "end": "174120"
  },
  {
    "text": "about kernel name spaces not kubernetes",
    "start": "174120",
    "end": "176440"
  },
  {
    "text": "Nam spaces which are ways to uh organize",
    "start": "176440",
    "end": "179200"
  },
  {
    "text": "your pods and",
    "start": "179200",
    "end": "180680"
  },
  {
    "text": "services um there's a little diagram",
    "start": "180680",
    "end": "183640"
  },
  {
    "text": "here that kind of shows control plane",
    "start": "183640",
    "end": "186000"
  },
  {
    "text": "and the data plane with the master nodes",
    "start": "186000",
    "end": "188440"
  },
  {
    "text": "organizing things and being the control",
    "start": "188440",
    "end": "190000"
  },
  {
    "text": "plane um there's not the point of the",
    "start": "190000",
    "end": "192519"
  },
  {
    "text": "diagram is not to show all the services",
    "start": "192519",
    "end": "194879"
  },
  {
    "text": "it's to show like hey there's a lot of",
    "start": "194879",
    "end": "195959"
  },
  {
    "text": "things talking back and forth um and a",
    "start": "195959",
    "end": "198560"
  },
  {
    "text": "lot of communication both between the M",
    "start": "198560",
    "end": "200799"
  },
  {
    "text": "Masters and the control plane and the",
    "start": "200799",
    "end": "202799"
  },
  {
    "text": "data plane",
    "start": "202799",
    "end": "205360"
  },
  {
    "start": "206000",
    "end": "252000"
  },
  {
    "text": "nodes so our root kit is named Cube kit",
    "start": "206120",
    "end": "209239"
  },
  {
    "text": "very creative ly named and there's a",
    "start": "209239",
    "end": "210920"
  },
  {
    "text": "little mascot a Argonaut in reference to",
    "start": "210920",
    "end": "213560"
  },
  {
    "text": "kubernetes as well and our goal with",
    "start": "213560",
    "end": "216360"
  },
  {
    "text": "making this was to push that like line",
    "start": "216360",
    "end": "218840"
  },
  {
    "text": "of separate separation between the red",
    "start": "218840",
    "end": "220400"
  },
  {
    "text": "team and The Blue Team closer to the",
    "start": "220400",
    "end": "222280"
  },
  {
    "text": "blue team side right because at cig we",
    "start": "222280",
    "end": "225360"
  },
  {
    "text": "do operate honey pots for both",
    "start": "225360",
    "end": "226599"
  },
  {
    "text": "kubernetes and Docker and the attacks",
    "start": "226599",
    "end": "229439"
  },
  {
    "text": "that we get are pretty lame straight up",
    "start": "229439",
    "end": "231319"
  },
  {
    "text": "they're just lame you know people run",
    "start": "231319",
    "end": "233040"
  },
  {
    "text": "shell scripts and they might mine some",
    "start": "233040",
    "end": "234439"
  },
  {
    "text": "crypto but there's not a lot of cool",
    "start": "234439",
    "end": "236120"
  },
  {
    "text": "stuff happening and so the goal here was",
    "start": "236120",
    "end": "239079"
  },
  {
    "text": "to show that hey it is possible to write",
    "start": "239079",
    "end": "241040"
  },
  {
    "text": "a root kit that targets these platforms",
    "start": "241040",
    "end": "243799"
  },
  {
    "text": "and is actually useful but at the same",
    "start": "243799",
    "end": "245840"
  },
  {
    "text": "time we're not trying to you know make",
    "start": "245840",
    "end": "247879"
  },
  {
    "text": "it faster for the next hospital to get",
    "start": "247879",
    "end": "249720"
  },
  {
    "text": "ransomware right so it's not fully",
    "start": "249720",
    "end": "251680"
  },
  {
    "text": "fanged it's more of a pro proof of",
    "start": "251680",
    "end": "253599"
  },
  {
    "start": "252000",
    "end": "287000"
  },
  {
    "text": "concept than anything else and so given",
    "start": "253599",
    "end": "255840"
  },
  {
    "text": "that we do have these portable container",
    "start": "255840",
    "end": "257199"
  },
  {
    "text": "run times and that let you deploy and",
    "start": "257199",
    "end": "260440"
  },
  {
    "text": "run payloads also known as containers",
    "start": "260440",
    "end": "262199"
  },
  {
    "text": "right Cube kit is able to hide these",
    "start": "262199",
    "end": "264680"
  },
  {
    "text": "malicious",
    "start": "264680",
    "end": "266040"
  },
  {
    "text": "containers from the platform and we have",
    "start": "266040",
    "end": "268720"
  },
  {
    "text": "two different modes at Andrew kind of",
    "start": "268720",
    "end": "270160"
  },
  {
    "text": "hinted at for two different kubernetes",
    "start": "270160",
    "end": "271919"
  },
  {
    "text": "planes the control plane and the data",
    "start": "271919",
    "end": "273919"
  },
  {
    "text": "plane and we got a little support Matrix",
    "start": "273919",
    "end": "276560"
  },
  {
    "text": "you'll notice it's very thin because",
    "start": "276560",
    "end": "279000"
  },
  {
    "text": "there are some changes between various",
    "start": "279000",
    "end": "280400"
  },
  {
    "text": "kubernetes versions so it does work on",
    "start": "280400",
    "end": "282400"
  },
  {
    "text": "those ones but they do require a little",
    "start": "282400",
    "end": "283639"
  },
  {
    "text": "bit of tweaking so alab box does what",
    "start": "283639",
    "end": "285759"
  },
  {
    "text": "you",
    "start": "285759",
    "end": "287120"
  },
  {
    "start": "287000",
    "end": "352000"
  },
  {
    "text": "get so let's talk about a little bit",
    "start": "287120",
    "end": "289120"
  },
  {
    "text": "about the API so Cube kit itself is",
    "start": "289120",
    "end": "291160"
  },
  {
    "text": "organized around an API you can see an",
    "start": "291160",
    "end": "293039"
  },
  {
    "text": "example here for Docker d uh setting a",
    "start": "293039",
    "end": "295720"
  },
  {
    "text": "break point uh basically you can say",
    "start": "295720",
    "end": "299000"
  },
  {
    "text": "where you want to pause the program",
    "start": "299000",
    "end": "301000"
  },
  {
    "text": "that's running uh and where you want how",
    "start": "301000",
    "end": "302840"
  },
  {
    "text": "you want to edit your memory and then",
    "start": "302840",
    "end": "304120"
  },
  {
    "text": "resume execution of the service itself",
    "start": "304120",
    "end": "306759"
  },
  {
    "text": "in this case that's Docker um if you",
    "start": "306759",
    "end": "309479"
  },
  {
    "text": "don't have the offset so kubernetes",
    "start": "309479",
    "end": "312080"
  },
  {
    "text": "ships strip binaries that don't have",
    "start": "312080",
    "end": "314080"
  },
  {
    "text": "symbols um you can also set an offset or",
    "start": "314080",
    "end": "317240"
  },
  {
    "text": "you can resolve uh your",
    "start": "317240",
    "end": "319360"
  },
  {
    "text": "symbols uh and additionally we uh",
    "start": "319360",
    "end": "322840"
  },
  {
    "text": "support hiding a lot of fun different",
    "start": "322840",
    "end": "324440"
  },
  {
    "text": "things so files the kernel module itself",
    "start": "324440",
    "end": "327479"
  },
  {
    "text": "so this would be Cub kit. KO and any",
    "start": "327479",
    "end": "330120"
  },
  {
    "text": "sort of processes we'll see later on",
    "start": "330120",
    "end": "331639"
  },
  {
    "text": "with the kubernetes uh control plane",
    "start": "331639",
    "end": "333680"
  },
  {
    "text": "flavor that we're hiding a user space",
    "start": "333680",
    "end": "335360"
  },
  {
    "text": "component um as well as supporting",
    "start": "335360",
    "end": "337840"
  },
  {
    "text": "removing the r kit itself during runtime",
    "start": "337840",
    "end": "340800"
  },
  {
    "text": "so say you have some sort of forensics",
    "start": "340800",
    "end": "342639"
  },
  {
    "text": "that you're detecting uh somebody",
    "start": "342639",
    "end": "344160"
  },
  {
    "text": "looking at the platform you can cleanly",
    "start": "344160",
    "end": "345880"
  },
  {
    "text": "remove Cube kit itself and have the",
    "start": "345880",
    "end": "348479"
  },
  {
    "text": "server still be",
    "start": "348479",
    "end": "351360"
  },
  {
    "start": "352000",
    "end": "448000"
  },
  {
    "text": "running so about the docker mode the",
    "start": "352080",
    "end": "354479"
  },
  {
    "text": "docker targeting platform of of the cube",
    "start": "354479",
    "end": "357360"
  },
  {
    "text": "kit uh why do we do this to to Target",
    "start": "357360",
    "end": "360160"
  },
  {
    "text": "Docker a Docker is very common even to",
    "start": "360160",
    "end": "363479"
  },
  {
    "text": "still to this day you know like as of",
    "start": "363479",
    "end": "365680"
  },
  {
    "text": "last night there's 1,000 publicly",
    "start": "365680",
    "end": "367199"
  },
  {
    "text": "exposed Docker API endpoints that you",
    "start": "367199",
    "end": "368960"
  },
  {
    "text": "can just run containers on so they're",
    "start": "368960",
    "end": "372479"
  },
  {
    "text": "probably all honey pots yeah but you",
    "start": "372479",
    "end": "374199"
  },
  {
    "text": "know some of them might be",
    "start": "374199",
    "end": "376360"
  },
  {
    "text": "legit Docker is very easy for devs to",
    "start": "376360",
    "end": "378720"
  },
  {
    "text": "use they're already familiar with it um",
    "start": "378720",
    "end": "380680"
  },
  {
    "text": "I I'm pretty confident most of you",
    "start": "380680",
    "end": "382400"
  },
  {
    "text": "touched it if not use it",
    "start": "382400",
    "end": "384840"
  },
  {
    "text": "daily and in that sense it's because the",
    "start": "384840",
    "end": "387720"
  },
  {
    "text": "workflow is familiar uh you know it",
    "start": "387720",
    "end": "389639"
  },
  {
    "text": "wouldn't be that hard for a red teamer",
    "start": "389639",
    "end": "391440"
  },
  {
    "text": "to write up a bad container and stick it",
    "start": "391440",
    "end": "393720"
  },
  {
    "text": "in Docker and hide it with Cube",
    "start": "393720",
    "end": "396680"
  },
  {
    "text": "kit and so what does the cube kit",
    "start": "396680",
    "end": "399160"
  },
  {
    "text": "actually do in terms of Docker it hides",
    "start": "399160",
    "end": "401160"
  },
  {
    "text": "the entire container from the management",
    "start": "401160",
    "end": "402840"
  },
  {
    "text": "layer and that includes not just the",
    "start": "402840",
    "end": "405240"
  },
  {
    "text": "existence of the container but the",
    "start": "405240",
    "end": "406479"
  },
  {
    "text": "processes",
    "start": "406479",
    "end": "408560"
  },
  {
    "text": "within and how is that done via the",
    "start": "408560",
    "end": "411720"
  },
  {
    "text": "break pointing on the previous slide um",
    "start": "411720",
    "end": "414160"
  },
  {
    "text": "there was a few different ways to do",
    "start": "414160",
    "end": "415879"
  },
  {
    "text": "this and things that people already do",
    "start": "415879",
    "end": "418479"
  },
  {
    "text": "currently do but they didn't meet our",
    "start": "418479",
    "end": "420360"
  },
  {
    "text": "use case so just real quick um you could",
    "start": "420360",
    "end": "422319"
  },
  {
    "text": "use P Trace to kind of debug a process",
    "start": "422319",
    "end": "424160"
  },
  {
    "text": "and mess with stuff in real time but",
    "start": "424160",
    "end": "427080"
  },
  {
    "text": "that was kind of slow for us and you can",
    "start": "427080",
    "end": "429039"
  },
  {
    "text": "also use f trce for hooking kernel",
    "start": "429039",
    "end": "431360"
  },
  {
    "text": "functions but the problem with f trce",
    "start": "431360",
    "end": "433479"
  },
  {
    "text": "was that it will happen you know it",
    "start": "433479",
    "end": "434879"
  },
  {
    "text": "copies the function into a separate",
    "start": "434879",
    "end": "436080"
  },
  {
    "text": "layer of memory and then evaluates it at",
    "start": "436080",
    "end": "438440"
  },
  {
    "text": "the same time as as your hook and so we",
    "start": "438440",
    "end": "440639"
  },
  {
    "text": "wanted to be sure that our container was",
    "start": "440639",
    "end": "443160"
  },
  {
    "text": "getting hidden before it returned the",
    "start": "443160",
    "end": "444599"
  },
  {
    "text": "function right so we wrote Our Own break",
    "start": "444599",
    "end": "446000"
  },
  {
    "text": "pointing U",
    "start": "446000",
    "end": "448319"
  },
  {
    "start": "448000",
    "end": "511000"
  },
  {
    "text": "software yeah and so the uh for the",
    "start": "448319",
    "end": "451440"
  },
  {
    "text": "kubernetes flavor um so we're targeting",
    "start": "451440",
    "end": "453240"
  },
  {
    "text": "the control planes uh internally each",
    "start": "453240",
    "end": "455720"
  },
  {
    "text": "one has an API server where the API",
    "start": "455720",
    "end": "457479"
  },
  {
    "text": "server will uh manage watching all the",
    "start": "457479",
    "end": "460520"
  },
  {
    "text": "containers and will synchronize",
    "start": "460520",
    "end": "461800"
  },
  {
    "text": "container lists that are running on pods",
    "start": "461800",
    "end": "464159"
  },
  {
    "text": "um and share those between each other um",
    "start": "464159",
    "end": "466199"
  },
  {
    "text": "we want to hide the contain our pods not",
    "start": "466199",
    "end": "468840"
  },
  {
    "text": "just on one node from Cube cuddle we",
    "start": "468840",
    "end": "471159"
  },
  {
    "text": "also want to hide it from all API",
    "start": "471159",
    "end": "473479"
  },
  {
    "text": "requests that other uh control nodes",
    "start": "473479",
    "end": "475919"
  },
  {
    "text": "don't have an idea of what the container",
    "start": "475919",
    "end": "477879"
  },
  {
    "text": "is that's running or are malicious",
    "start": "477879",
    "end": "479720"
  },
  {
    "text": "payload um we also have of course a user",
    "start": "479720",
    "end": "482599"
  },
  {
    "text": "space app that modifies the Json",
    "start": "482599",
    "end": "484960"
  },
  {
    "text": "responses so we're hooking into um the",
    "start": "484960",
    "end": "487479"
  },
  {
    "text": "prls uh response sending uh function",
    "start": "487479",
    "end": "491440"
  },
  {
    "text": "within kubernetes uh and so the effect",
    "start": "491440",
    "end": "494360"
  },
  {
    "text": "of this is that we are uh the control",
    "start": "494360",
    "end": "497639"
  },
  {
    "text": "plane will deploy our payloads and then",
    "start": "497639",
    "end": "500639"
  },
  {
    "text": "it will actually lose any sort of",
    "start": "500639",
    "end": "502440"
  },
  {
    "text": "recogition after it's already",
    "start": "502440",
    "end": "503800"
  },
  {
    "text": "orchestrated and load Balan a malici",
    "start": "503800",
    "end": "506720"
  },
  {
    "text": "malicious pay payload or pod",
    "start": "506720",
    "end": "510800"
  },
  {
    "text": "um yeah so a little demo of this working",
    "start": "510800",
    "end": "514120"
  },
  {
    "start": "511000",
    "end": "645000"
  },
  {
    "text": "let's see if uh everything works out",
    "start": "514120",
    "end": "516880"
  },
  {
    "text": "pre-recorded video um so we're going to",
    "start": "516880",
    "end": "520518"
  },
  {
    "text": "start with Cube cuddle get pods um",
    "start": "520519",
    "end": "522159"
  },
  {
    "text": "you'll note that there's two pods",
    "start": "522159",
    "end": "523479"
  },
  {
    "text": "running hopefully it's visible um",
    "start": "523479",
    "end": "525519"
  },
  {
    "text": "there's another pod and then there's a",
    "start": "525519",
    "end": "527279"
  },
  {
    "text": "debug",
    "start": "527279",
    "end": "528440"
  },
  {
    "text": "pod um the debug pod is what we'll be",
    "start": "528440",
    "end": "530560"
  },
  {
    "text": "hiding",
    "start": "530560",
    "end": "532480"
  },
  {
    "text": "um so everything is hidden behind our",
    "start": "532480",
    "end": "535480"
  },
  {
    "text": "Cube kit environmental variable and so",
    "start": "535480",
    "end": "537560"
  },
  {
    "text": "what we'll do is we'll go ahead and",
    "start": "537560",
    "end": "538560"
  },
  {
    "text": "start that Jon on user space app and",
    "start": "538560",
    "end": "540360"
  },
  {
    "text": "insert the Cub kit. KO kernel",
    "start": "540360",
    "end": "542920"
  },
  {
    "text": "module um and note that you can't really",
    "start": "542920",
    "end": "545240"
  },
  {
    "text": "interact with the Cub kit unless you",
    "start": "545240",
    "end": "546760"
  },
  {
    "text": "have that variable set so that's just",
    "start": "546760",
    "end": "548399"
  },
  {
    "text": "how we choose to hide it um so now after",
    "start": "548399",
    "end": "550640"
  },
  {
    "text": "we've inserted that we run Cube cuddle",
    "start": "550640",
    "end": "552120"
  },
  {
    "text": "get pods again um and we see that",
    "start": "552120",
    "end": "555120"
  },
  {
    "text": "there's no longer any sort of debug pod",
    "start": "555120",
    "end": "557800"
  },
  {
    "text": "visible and internally as there are",
    "start": "557800",
    "end": "560040"
  },
  {
    "text": "watch points being set within different",
    "start": "560040",
    "end": "561560"
  },
  {
    "text": "Dam it will also be removed from those",
    "start": "561560",
    "end": "563839"
  },
  {
    "text": "as",
    "start": "563839",
    "end": "564920"
  },
  {
    "text": "well so run it twice just to make sure",
    "start": "564920",
    "end": "567279"
  },
  {
    "text": "it's stable and then let's uh check to",
    "start": "567279",
    "end": "570160"
  },
  {
    "text": "see if there's any process because we",
    "start": "570160",
    "end": "571600"
  },
  {
    "text": "started up that user space Json Handler",
    "start": "571600",
    "end": "573800"
  },
  {
    "text": "so checking PS all we get is the GP",
    "start": "573800",
    "end": "576360"
  },
  {
    "text": "response that's not actually um the",
    "start": "576360",
    "end": "578839"
  },
  {
    "text": "process running when we set the cube kit",
    "start": "578839",
    "end": "580880"
  },
  {
    "text": "secret we can now see our hidden process",
    "start": "580880",
    "end": "583720"
  },
  {
    "text": "um the Json handler. out in the first",
    "start": "583720",
    "end": "587240"
  },
  {
    "text": "line uh so this Json Handler we have it",
    "start": "587240",
    "end": "589959"
  },
  {
    "text": "in the local in the local working",
    "start": "589959",
    "end": "592079"
  },
  {
    "text": "directory um but we also want to make",
    "start": "592079",
    "end": "594200"
  },
  {
    "text": "sure that we're hiding it on the dis so",
    "start": "594200",
    "end": "596200"
  },
  {
    "text": "if we try to lsla it it there is no Json",
    "start": "596200",
    "end": "599760"
  },
  {
    "text": "Handler to out when cuit is running uh",
    "start": "599760",
    "end": "602279"
  },
  {
    "text": "but if we set the secret it unhides the",
    "start": "602279",
    "end": "606079"
  },
  {
    "text": "file so we also make a virtual device to",
    "start": "606120",
    "end": "609399"
  },
  {
    "text": "enable logging or can be use for other",
    "start": "609399",
    "end": "611000"
  },
  {
    "text": "things within the API uh when we try to",
    "start": "611000",
    "end": "614160"
  },
  {
    "text": "check check for that device it's hidden",
    "start": "614160",
    "end": "616279"
  },
  {
    "text": "until uh it's also hidden until we set",
    "start": "616279",
    "end": "618720"
  },
  {
    "text": "that",
    "start": "618720",
    "end": "620879"
  },
  {
    "text": "key and finally we want to check to see",
    "start": "621279",
    "end": "623800"
  },
  {
    "text": "hey does lsod see any the uh Cube kit",
    "start": "623800",
    "end": "628120"
  },
  {
    "text": "itself uh by default it doesn't uh but",
    "start": "628120",
    "end": "631600"
  },
  {
    "text": "when we set that key all of a sudden",
    "start": "631600",
    "end": "632920"
  },
  {
    "text": "it's unhidden um note that the liip kod",
    "start": "632920",
    "end": "635360"
  },
  {
    "text": "thing is extraneous for now it goes to",
    "start": "635360",
    "end": "637079"
  },
  {
    "text": "standard out so if you have or a",
    "start": "637079",
    "end": "638320"
  },
  {
    "text": "standard error so if you're gring for",
    "start": "638320",
    "end": "639920"
  },
  {
    "text": "anything for any sort of reason um that",
    "start": "639920",
    "end": "642360"
  },
  {
    "text": "won't be an",
    "start": "642360",
    "end": "644800"
  },
  {
    "start": "645000",
    "end": "670000"
  },
  {
    "text": "issue so now let's go ahead and unload",
    "start": "651399",
    "end": "653639"
  },
  {
    "text": "the the the root kit itself uh we do",
    "start": "653639",
    "end": "656000"
  },
  {
    "text": "this by removing that slev Cube kit from",
    "start": "656000",
    "end": "658120"
  },
  {
    "text": "earlier um and now we can run Cube C get",
    "start": "658120",
    "end": "660680"
  },
  {
    "text": "pods again and now we can see that the",
    "start": "660680",
    "end": "662120"
  },
  {
    "text": "debug pod is visible again and the",
    "start": "662120",
    "end": "664639"
  },
  {
    "text": "system is still running and",
    "start": "664639",
    "end": "667680"
  },
  {
    "text": "stable",
    "start": "667839",
    "end": "670040"
  },
  {
    "start": "670000",
    "end": "740000"
  },
  {
    "text": "cool so as far as detecting and",
    "start": "670040",
    "end": "672480"
  },
  {
    "text": "preventing this kind of attack there's",
    "start": "672480",
    "end": "674880"
  },
  {
    "text": "quite a few best practices for CIS",
    "start": "674880",
    "end": "676639"
  },
  {
    "text": "admins to take advantage of um this it's",
    "start": "676639",
    "end": "679760"
  },
  {
    "text": "not amazing but there are some security",
    "start": "679760",
    "end": "681480"
  },
  {
    "text": "features in kubernetes that are super",
    "start": "681480",
    "end": "682760"
  },
  {
    "text": "useful for this so the biggest and most",
    "start": "682760",
    "end": "685079"
  },
  {
    "text": "important one is to not let things run",
    "start": "685079",
    "end": "686959"
  },
  {
    "text": "as privileged because that just means",
    "start": "686959",
    "end": "688360"
  },
  {
    "text": "that there's no boundary between the",
    "start": "688360",
    "end": "689639"
  },
  {
    "text": "container and the host right um so that",
    "start": "689639",
    "end": "692120"
  },
  {
    "text": "is the easiest way to get rot kitted is",
    "start": "692120",
    "end": "693399"
  },
  {
    "text": "to run it as privileged and run a",
    "start": "693399",
    "end": "694560"
  },
  {
    "text": "vulnerability at the same time however",
    "start": "694560",
    "end": "697079"
  },
  {
    "text": "if you're doing the right things the",
    "start": "697079",
    "end": "698320"
  },
  {
    "text": "right way and things aren't running",
    "start": "698320",
    "end": "699839"
  },
  {
    "text": "privileged there's things like uh SE",
    "start": "699839",
    "end": "701920"
  },
  {
    "text": "Linux for kubernetes and there's",
    "start": "701920",
    "end": "703920"
  },
  {
    "text": "also",
    "start": "703920",
    "end": "705440"
  },
  {
    "text": "a Access Control lists that you can set",
    "start": "705440",
    "end": "707920"
  },
  {
    "text": "to further you know SC scale down what a",
    "start": "707920",
    "end": "710720"
  },
  {
    "text": "container is actually able to",
    "start": "710720",
    "end": "712760"
  },
  {
    "text": "do and how would you detect something",
    "start": "712760",
    "end": "714760"
  },
  {
    "text": "like this um if you're looking for an",
    "start": "714760",
    "end": "717120"
  },
  {
    "text": "open source solution there's things like",
    "start": "717120",
    "end": "719160"
  },
  {
    "text": "Falco um Aqua has a tool called Tracy I",
    "start": "719160",
    "end": "722360"
  },
  {
    "text": "believe that let you basically write",
    "start": "722360",
    "end": "724880"
  },
  {
    "text": "custom rules for system call events and",
    "start": "724880",
    "end": "727480"
  },
  {
    "text": "take response actions right and so what",
    "start": "727480",
    "end": "729680"
  },
  {
    "text": "you would do is look write a rule that",
    "start": "729680",
    "end": "731120"
  },
  {
    "text": "detects the loading of a crial module",
    "start": "731120",
    "end": "732680"
  },
  {
    "text": "which you can probably pretty safely",
    "start": "732680",
    "end": "734040"
  },
  {
    "text": "assume is across the board bad and take",
    "start": "734040",
    "end": "738560"
  },
  {
    "text": "a response based on that rule fires and",
    "start": "738560",
    "end": "741000"
  },
  {
    "start": "740000",
    "end": "799000"
  },
  {
    "text": "so an example like out of the box setup",
    "start": "741000",
    "end": "742880"
  },
  {
    "text": "that you could do in one afternoon is",
    "start": "742880",
    "end": "744560"
  },
  {
    "text": "install Falco install Falco sidekick",
    "start": "744560",
    "end": "746839"
  },
  {
    "text": "which is the thing that does the",
    "start": "746839",
    "end": "748000"
  },
  {
    "text": "response actions and then write that",
    "start": "748000",
    "end": "749639"
  },
  {
    "text": "rule real quick it's probably like four",
    "start": "749639",
    "end": "750920"
  },
  {
    "text": "or five lines of yl and test it out you",
    "start": "750920",
    "end": "754480"
  },
  {
    "text": "could have Falco fire the rule event",
    "start": "754480",
    "end": "756560"
  },
  {
    "text": "Falco side sees the r event and kills",
    "start": "756560",
    "end": "758440"
  },
  {
    "text": "the container kills the Pod kills the",
    "start": "758440",
    "end": "759720"
  },
  {
    "text": "host whatever you want to",
    "start": "759720",
    "end": "762480"
  },
  {
    "text": "do um and here's why we think this is",
    "start": "762720",
    "end": "765720"
  },
  {
    "text": "important it kind of goes kind of goes",
    "start": "765720",
    "end": "768199"
  },
  {
    "text": "with why we did this kubernetes is not",
    "start": "768199",
    "end": "771160"
  },
  {
    "text": "going anywhere they just put it on like",
    "start": "771160",
    "end": "772639"
  },
  {
    "text": "the F16 or F35 or something like that so",
    "start": "772639",
    "end": "776160"
  },
  {
    "text": "it's here to",
    "start": "776160",
    "end": "777720"
  },
  {
    "text": "stay um and as far as cloud and",
    "start": "777720",
    "end": "780240"
  },
  {
    "text": "container tools for both offense and",
    "start": "780240",
    "end": "782120"
  },
  {
    "text": "defense it's still a very fresh industry",
    "start": "782120",
    "end": "784519"
  },
  {
    "text": "even though the products are maturing um",
    "start": "784519",
    "end": "787519"
  },
  {
    "text": "the fact that there isn't a root kit",
    "start": "787519",
    "end": "789440"
  },
  {
    "text": "that's publicly known that does this",
    "start": "789440",
    "end": "790800"
  },
  {
    "text": "kind of thing it's kind of evidence of",
    "start": "790800",
    "end": "792399"
  },
  {
    "text": "that so that was another reason why we",
    "start": "792399",
    "end": "794000"
  },
  {
    "text": "did it and you know assuming that you do",
    "start": "794000",
    "end": "796560"
  },
  {
    "text": "work for your company's blue team you",
    "start": "796560",
    "end": "799440"
  },
  {
    "text": "might just save your cso's job by",
    "start": "799440",
    "end": "801680"
  },
  {
    "text": "catching a root kit like this before it",
    "start": "801680",
    "end": "803800"
  },
  {
    "text": "you know before they take all your data",
    "start": "803800",
    "end": "804959"
  },
  {
    "text": "before they Ransom you before whatever",
    "start": "804959",
    "end": "806320"
  },
  {
    "text": "happens because we all know that CEO is",
    "start": "806320",
    "end": "809240"
  },
  {
    "text": "just there to get",
    "start": "809240",
    "end": "811680"
  },
  {
    "text": "fired and if you do have any questions",
    "start": "811880",
    "end": "814040"
  },
  {
    "text": "there's a mic here and a mic",
    "start": "814040",
    "end": "817760"
  },
  {
    "text": "there and surveys say that it takes on",
    "start": "817760",
    "end": "820320"
  },
  {
    "text": "average 20 seconds before anyone stands",
    "start": "820320",
    "end": "821839"
  },
  {
    "text": "up so I'll give you some time to think",
    "start": "821839",
    "end": "823320"
  },
  {
    "text": "of good",
    "start": "823320",
    "end": "824440"
  },
  {
    "text": "questions and if you guys want the code",
    "start": "824440",
    "end": "826519"
  },
  {
    "text": "there's a good Hub link um it should be",
    "start": "826519",
    "end": "828199"
  },
  {
    "text": "live it is",
    "start": "828199",
    "end": "831600"
  },
  {
    "text": "live see a lot of photos",
    "start": "836600",
    "end": "839759"
  },
  {
    "text": "cool play around with it this a pretty",
    "start": "839759",
    "end": "842160"
  },
  {
    "text": "simple",
    "start": "842160",
    "end": "844399"
  },
  {
    "text": "API all right looks like no questions",
    "start": "847560",
    "end": "849839"
  },
  {
    "text": "after 20 seconds so we'll wrap it here",
    "start": "849839",
    "end": "852079"
  },
  {
    "text": "thank you",
    "start": "852079",
    "end": "853060"
  },
  {
    "text": "[Applause]",
    "start": "853060",
    "end": "856470"
  },
  {
    "text": "everyone",
    "start": "857360",
    "end": "860360"
  }
]