[
  {
    "start": "0",
    "end": "25000"
  },
  {
    "text": "hello guys welcome back to our presentation thanks for joining us at",
    "start": "2340",
    "end": "8639"
  },
  {
    "text": "right after the lunch break I'm Chachi Wu from Amber group today",
    "start": "8639",
    "end": "14099"
  },
  {
    "text": "um in our presentation I'm we're going to show you our recent research about how we first the NTFS implementation in",
    "start": "14099",
    "end": "22199"
  },
  {
    "text": "the Linux kernel so um and here's my agenda today we'll",
    "start": "22199",
    "end": "28859"
  },
  {
    "start": "25000",
    "end": "165000"
  },
  {
    "text": "start from a brief introduction about who we are and then the motivation of doing this research and also some basic",
    "start": "28859",
    "end": "36899"
  },
  {
    "text": "idea about biosystem Linux versus an Indian fs and all the challenges of",
    "start": "36899",
    "end": "43260"
  },
  {
    "text": "filing a new file system especially in Linux kernel and how we deal with those",
    "start": "43260",
    "end": "49460"
  },
  {
    "text": "challenges with our paper of fuzzer and we'll wrap up the presentation with a",
    "start": "49460",
    "end": "55800"
  },
  {
    "text": "evaluation and takeaways but actually before we introduce ourselves I'll",
    "start": "55800",
    "end": "63239"
  },
  {
    "text": "doing something interesting I'll start from a live version demo",
    "start": "63239",
    "end": "70320"
  },
  {
    "text": "so let me switch to my terminal",
    "start": "70320",
    "end": "77000"
  },
  {
    "text": "sorry I need to my mouse is not working oh right here",
    "start": "81960",
    "end": "88619"
  },
  {
    "text": "okay okay so right here you can see the peppera",
    "start": "88619",
    "end": "95900"
  },
  {
    "text": "fuzzer and you can check we already open",
    "start": "95900",
    "end": "100920"
  },
  {
    "text": "source it so you can go to our GitHub repo to reproduce all what happens here",
    "start": "100920",
    "end": "108240"
  },
  {
    "text": "at home so yeah we have a script to run the fuzzer so it will start fuzzing and this",
    "start": "108240",
    "end": "116640"
  },
  {
    "text": "browser is set up with Linux 6.0 which has the um",
    "start": "116640",
    "end": "122340"
  },
  {
    "text": "Linux 6.0 in the so-called Linux kernel Library inside so you see the AFL",
    "start": "122340",
    "end": "130440"
  },
  {
    "text": "um other screen right here is actually generally",
    "start": "130440",
    "end": "135959"
  },
  {
    "text": "um file system image and all the system codes available operations and try to",
    "start": "135959",
    "end": "141660"
  },
  {
    "text": "get the kernel crash and you will see some numbers on your right hand side the",
    "start": "141660",
    "end": "147480"
  },
  {
    "text": "top corner and yeah that that's that's how we evaluate if it works so we hope",
    "start": "147480",
    "end": "153900"
  },
  {
    "text": "um by the end of this talk we can find something interesting so let's switch back to the presentation slides really",
    "start": "153900",
    "end": "162480"
  },
  {
    "text": "quick so after the agenda let me brief introduce ourselves and chachu and the",
    "start": "162480",
    "end": "169620"
  },
  {
    "start": "165000",
    "end": "238000"
  },
  {
    "text": "gentleman sitting there is Edward Lowe we both work for Amber group and doing",
    "start": "169620",
    "end": "175080"
  },
  {
    "text": "circular research here but actually Edinburgh group is a crypto company so it's kind of weird why we're doing",
    "start": "175080",
    "end": "181440"
  },
  {
    "text": "research about in this corner because um maybe you know that um the blockchain",
    "start": "181440",
    "end": "189180"
  },
  {
    "text": "has the blockchain crime P2P Network and actually over 90 percent of blockchain",
    "start": "189180",
    "end": "194580"
  },
  {
    "text": "cries running over Linux so so we try to secure the whole software stack of",
    "start": "194580",
    "end": "200760"
  },
  {
    "text": "virtual infrastructure that's maybe the reason and also I lead the webpage",
    "start": "200760",
    "end": "206640"
  },
  {
    "text": "security TN at Amber and the web 3 were is actually moving really fast so you",
    "start": "206640",
    "end": "213120"
  },
  {
    "text": "won't surprise that we have like millions of dollars spin hack every week so it happens in the web 3 world so so",
    "start": "213120",
    "end": "221700"
  },
  {
    "text": "yeah so we also work with University",
    "start": "221700",
    "end": "225799"
  },
  {
    "text": "research on The Cutting Edge technology like this one to you know try to move",
    "start": "227000",
    "end": "233099"
  },
  {
    "text": "faster than the back actors so that's what we do in at Amber group",
    "start": "233099",
    "end": "239459"
  },
  {
    "start": "238000",
    "end": "361000"
  },
  {
    "text": "so about the motivation actually this slide reminds me that um in my",
    "start": "239459",
    "end": "247099"
  },
  {
    "text": "previous uh one decade security research career I I have I I was lucky to",
    "start": "247099",
    "end": "254459"
  },
  {
    "text": "um dive into Android in 2013 and switch to blockchain mainly each Syrian and",
    "start": "254459",
    "end": "261780"
  },
  {
    "text": "smart computer things in 2017. so in in that two moment I have",
    "start": "261780",
    "end": "267720"
  },
  {
    "text": "the chance to find a lot of interesting findings if you um yeah a previous work for for people 360",
    "start": "267720",
    "end": "275400"
  },
  {
    "text": "and we submit like hundreds bucks to Google and also I co-founded the",
    "start": "275400",
    "end": "280979"
  },
  {
    "text": "security friend and we did find lots of smart contract bugs so anti-fx3 is",
    "start": "280979",
    "end": "286620"
  },
  {
    "text": "actually something um that hit our mind and Joshua in our radar because anti-app to",
    "start": "286620",
    "end": "295380"
  },
  {
    "text": "fs3 is actually the first fully functioned NTFS third party",
    "start": "295380",
    "end": "300720"
  },
  {
    "text": "implementation in the Linux kernel so in the past three day case we actually have",
    "start": "300720",
    "end": "306840"
  },
  {
    "text": "multiple different implementation of NTFS in this kernel but none of them is",
    "start": "306840",
    "end": "312740"
  },
  {
    "text": "fully function and so I mean it's",
    "start": "312740",
    "end": "317840"
  },
  {
    "text": "complicated enough to to have some bugs I we know that we will find something",
    "start": "317840",
    "end": "323580"
  },
  {
    "text": "and also um the the other thing is that um fuzzing first in operating system or we",
    "start": "323580",
    "end": "331380"
  },
  {
    "text": "say thousands kernel is not a easy task and also um file system have some more more",
    "start": "331380",
    "end": "338940"
  },
  {
    "text": "factors of that surfaces like they have the file system image and they have the",
    "start": "338940",
    "end": "345060"
  },
  {
    "text": "format if you just randomly generate system codes file operations with this",
    "start": "345060",
    "end": "351539"
  },
  {
    "text": "color or some other OS fuzzer actually you cannot efficiently first the the",
    "start": "351539",
    "end": "358320"
  },
  {
    "text": "file system so yeah that's the motivation and a little bit background about until",
    "start": "358320",
    "end": "364560"
  },
  {
    "start": "361000",
    "end": "413000"
  },
  {
    "text": "this I think I took most of them already so NTFS was um the first release of",
    "start": "364560",
    "end": "371280"
  },
  {
    "text": "India versus night what was released with Windows NT 3.1 in 1993 30 years ago and the lab 3 Day case",
    "start": "371280",
    "end": "380460"
  },
  {
    "text": "we have the ring only NTFS inflation in Learners also the ntf 3G which is using",
    "start": "380460",
    "end": "387479"
  },
  {
    "text": "the user mode fuse versus system to help Linux users to mount a NTFS image or",
    "start": "387479",
    "end": "394080"
  },
  {
    "text": "drive and yeah just um the end of 2021 two",
    "start": "394080",
    "end": "399660"
  },
  {
    "text": "years ago less than two years ago we finally get the nts3 actually we",
    "start": "399660",
    "end": "404759"
  },
  {
    "text": "identified we found that and the other three was upstream and we think it's really a good Target for security",
    "start": "404759",
    "end": "410100"
  },
  {
    "text": "research so yeah that's why so I I'll go through a little bit on",
    "start": "410100",
    "end": "417600"
  },
  {
    "start": "413000",
    "end": "625000"
  },
  {
    "text": "background about file system and the test service because when you try to First something you need to find the the",
    "start": "417600",
    "end": "424319"
  },
  {
    "text": "attack surface and how you can generate inputs to metric system pressure and",
    "start": "424319",
    "end": "431220"
  },
  {
    "text": "burn and then you can if you luckily can reproduce that crash and you may find",
    "start": "431220",
    "end": "436680"
  },
  {
    "text": "some zero days so when a user access a file in the file system the first thing",
    "start": "436680",
    "end": "443520"
  },
  {
    "text": "is that he he or she needs to mount the file certain drive for example Auntie",
    "start": "443520",
    "end": "450539"
  },
  {
    "text": "adverts drive for image so that's the very first thing you need to do is the",
    "start": "450539",
    "end": "456300"
  },
  {
    "text": "amount the mount system code and then he can at one point it can open the file",
    "start": "456300",
    "end": "462300"
  },
  {
    "text": "rewrite the file so so there are actually two attack surface the first",
    "start": "462300",
    "end": "467340"
  },
  {
    "text": "one is Mount when you mount a file system a tech actor can actually create a mail",
    "start": "467340",
    "end": "474479"
  },
  {
    "text": "phone images like the the operating system the file system monk Handler will",
    "start": "474479",
    "end": "481020"
  },
  {
    "text": "parse those data and if if that data has some like offset or memory printer or some",
    "start": "481020",
    "end": "489240"
  },
  {
    "text": "calculation you may have the chance to use a craft a mailphone image to crash",
    "start": "489240",
    "end": "495000"
  },
  {
    "text": "the system and also all the files operation um has lots of different",
    "start": "495000",
    "end": "501379"
  },
  {
    "text": "combination of parameters so that's the two vectors that a attacker or secondary",
    "start": "501379",
    "end": "509099"
  },
  {
    "text": "researcher can attack the system the file system so so how how",
    "start": "509099",
    "end": "514260"
  },
  {
    "text": "um so then as as we know that these two attack vectors then we need to choose a",
    "start": "514260",
    "end": "520560"
  },
  {
    "text": "weapon to both generate the mail from image or whatever image to Casual",
    "start": "520560",
    "end": "526500"
  },
  {
    "text": "assistant and also you need to generate all the system code to randomly generate all the parameters",
    "start": "526500",
    "end": "534720"
  },
  {
    "text": "to crash it so but but actually when you when we say that um when we try to start",
    "start": "534720",
    "end": "541800"
  },
  {
    "text": "something with the format AFL would be the maybe the best choice or all the",
    "start": "541800",
    "end": "547440"
  },
  {
    "text": "other derived from AFL and we when we're talking about system code um since coder must be the one but",
    "start": "547440",
    "end": "555180"
  },
  {
    "text": "actually we don't have a perfect one to combine both of them and the other factor is that we need a efficient",
    "start": "555180",
    "end": "562680"
  },
  {
    "text": "um efficient software or mechanism to efficiently run",
    "start": "562680",
    "end": "568380"
  },
  {
    "text": "the Target because when you first in the OS there's a so-called agent issue like",
    "start": "568380",
    "end": "574140"
  },
  {
    "text": "when you put up the operating system then you mount different like 10",
    "start": "574140",
    "end": "579839"
  },
  {
    "text": "different version image and perform lots of fasting operations and finally the",
    "start": "579839",
    "end": "585540"
  },
  {
    "text": "last maybe the right session code the um in in the end crash the system but you",
    "start": "585540",
    "end": "591959"
  },
  {
    "text": "don't know exactly what happens in that 10 different image and all the",
    "start": "591959",
    "end": "598040"
  },
  {
    "text": "fascism approach in the middle so when we when we first the open system or the",
    "start": "598040",
    "end": "604380"
  },
  {
    "text": "system inside the application we always need a fresh OS instance so you can use",
    "start": "604380",
    "end": "610500"
  },
  {
    "text": "real machine to do that but you need to buy a lot of machine and you can also use VN to spam lots of different OS",
    "start": "610500",
    "end": "618000"
  },
  {
    "text": "instance but that will cause you um concern a lot of memory so we need something in between so actually",
    "start": "618000",
    "end": "626640"
  },
  {
    "start": "625000",
    "end": "725000"
  },
  {
    "text": "um we found one further framework it it is perfectly matched all the",
    "start": "626640",
    "end": "632339"
  },
  {
    "text": "requirements which is Janus published by um JoJo Tech SS lab",
    "start": "632339",
    "end": "638760"
  },
  {
    "text": "um in attribute SMP 2019 so Jonas could be a candidate for buzzing or Target",
    "start": "638760",
    "end": "646860"
  },
  {
    "text": "they only have that three but we soon realized that um it actually required us",
    "start": "646860",
    "end": "652260"
  },
  {
    "text": "to um um re rewrite a new password",
    "start": "652260",
    "end": "657779"
  },
  {
    "text": "so let's say before the NTFS and also the um I said um the the lib OS based",
    "start": "657779",
    "end": "666000"
  },
  {
    "text": "kernel scooter the um in general they use the so-called Aoki or Linux kernel",
    "start": "666000",
    "end": "672420"
  },
  {
    "text": "library to do that but we found that the aoko was not not maintained anymore so",
    "start": "672420",
    "end": "679920"
  },
  {
    "text": "we we need to you know Port that aoko to the latest things currently and also the",
    "start": "679920",
    "end": "686220"
  },
  {
    "text": "other thing is that we also need case and M something similar to help us to catch all the memory issue as early as",
    "start": "686220",
    "end": "694500"
  },
  {
    "text": "possible so so yeah we we based on the idea and some framework about genus we",
    "start": "694500",
    "end": "702600"
  },
  {
    "text": "we built our own one and yeah I think",
    "start": "702600",
    "end": "708240"
  },
  {
    "text": "then I'll hand over to Edward and he will explain all the um how we deal with",
    "start": "708240",
    "end": "713339"
  },
  {
    "text": "those challenges and all the technical details",
    "start": "713339",
    "end": "717620"
  },
  {
    "text": "um okay um my colleague just explained all the motivations about why we choose ndfs",
    "start": "725220",
    "end": "732560"
  },
  {
    "text": "give a brief introduction to Linux file system the possible tech services and",
    "start": "732560",
    "end": "738899"
  },
  {
    "text": "available choices for file system policy um I'll continue to walk you through the",
    "start": "738899",
    "end": "744480"
  },
  {
    "text": "details of our approach the implementation how we resolve the challenges and some case reviews in the",
    "start": "744480",
    "end": "751740"
  },
  {
    "text": "end but first I want to check out further status because you know people always",
    "start": "751740",
    "end": "757500"
  },
  {
    "text": "say talk is cheap we need to prove that our father is really working so",
    "start": "757500",
    "end": "765060"
  },
  {
    "text": "finger crossed",
    "start": "766639",
    "end": "770000"
  },
  {
    "text": "the other thing we found something",
    "start": "775560",
    "end": "778880"
  },
  {
    "text": "point so let me switch to",
    "start": "780660",
    "end": "786800"
  },
  {
    "text": "oh yeah okay okay this is that",
    "start": "787940",
    "end": "794639"
  },
  {
    "text": "we've got two crashes already um so I think I just prove it it's",
    "start": "794639",
    "end": "802740"
  },
  {
    "text": "working it's effective ah it's efficient it got two crashes in uh 11 minutes so",
    "start": "802740",
    "end": "810000"
  },
  {
    "text": "that's pretty amazing for father um but actually here's a tricky part",
    "start": "810000",
    "end": "817139"
  },
  {
    "text": "getting crashes doesn't mean it's 100 reproducible sometimes they are really hard to try it",
    "start": "817139",
    "end": "823800"
  },
  {
    "text": "to find root cause and sometimes they are just first law but we'll try to try these issues um",
    "start": "823800",
    "end": "830820"
  },
  {
    "text": "after q a if we have time okay so let's get back to our topic",
    "start": "830820",
    "end": "837860"
  },
  {
    "text": "okay",
    "start": "847920",
    "end": "850459"
  },
  {
    "text": "okay um so what's all the challenges to uh file system body",
    "start": "855720",
    "end": "861540"
  },
  {
    "text": "the first challenge is that first system or large but only major",
    "start": "861540",
    "end": "867839"
  },
  {
    "text": "data matters and if we want to extract this metadata to um from the image we need to write",
    "start": "867839",
    "end": "876600"
  },
  {
    "text": "the empty parser because H5 system has its own design so there's",
    "start": "876600",
    "end": "883980"
  },
  {
    "text": "no General solution um okay so um",
    "start": "883980",
    "end": "890880"
  },
  {
    "text": "sorry I got two um yeah",
    "start": "890880",
    "end": "896120"
  },
  {
    "text": "sorry let me okay um so yes we need to develop specific",
    "start": "897959",
    "end": "905639"
  },
  {
    "text": "password for the first season and check sums um they are banned to fathers",
    "start": "905639",
    "end": "911300"
  },
  {
    "text": "if we can if each if the first season has its own mechanism or checksum for for its",
    "start": "911300",
    "end": "919579"
  },
  {
    "text": "metadata we need to recalculate and fill in these values after the mutation",
    "start": "919579",
    "end": "926779"
  },
  {
    "text": "otherwise the fascism will reject to mount the",
    "start": "926779",
    "end": "932160"
  },
  {
    "text": "image okay",
    "start": "932160",
    "end": "937380"
  },
  {
    "start": "937000",
    "end": "999000"
  },
  {
    "text": "yeah so uh here's the brief introduction to the",
    "start": "937380",
    "end": "942540"
  },
  {
    "text": "image antivirus image format the first sector is code partition boost",
    "start": "942540",
    "end": "948000"
  },
  {
    "text": "sector which holds blue deformation and some important fields for example buys per sector indicates",
    "start": "948000",
    "end": "955440"
  },
  {
    "text": "number of bytes per disk sector and sector per cluster is the number of sectors in a cluster",
    "start": "955440",
    "end": "963600"
  },
  {
    "text": "and we have Mt which is a master file table",
    "start": "963600",
    "end": "969620"
  },
  {
    "text": "antivirus stores all the information in the MFD table",
    "start": "969620",
    "end": "975620"
  },
  {
    "text": "the first entry is the mft itself and the second entry is empty mirror",
    "start": "975620",
    "end": "982500"
  },
  {
    "text": "which holds the duplicate of the first row entries of mmt",
    "start": "982500",
    "end": "988579"
  },
  {
    "text": "okay sorry and the last is huge data we don't care about this data where fasting or",
    "start": "988680",
    "end": "995040"
  },
  {
    "text": "volume so um antivirus 3 has some send checks",
    "start": "995040",
    "end": "1003440"
  },
  {
    "start": "999000",
    "end": "1053000"
  },
  {
    "text": "other than the check sums uh the oemid immersed equals to um",
    "start": "1003440",
    "end": "1010459"
  },
  {
    "text": "it must equals to uh DFS and four spaces it will return arrow and serve the money",
    "start": "1010459",
    "end": "1016459"
  },
  {
    "text": "if not wait and uh",
    "start": "1016459",
    "end": "1022040"
  },
  {
    "text": "uh also the sector size it should be larger than um 500 terabytes and there",
    "start": "1022040",
    "end": "1029000"
  },
  {
    "text": "must be above two and their customers and the cost of size it must be above two",
    "start": "1029000",
    "end": "1035600"
  },
  {
    "text": "um if any of these standard check fails the the first is an antiversary driver",
    "start": "1035600",
    "end": "1040640"
  },
  {
    "text": "will reject and fail the mounting process",
    "start": "1040640",
    "end": "1046540"
  },
  {
    "text": "sorry okay",
    "start": "1047480",
    "end": "1052480"
  },
  {
    "start": "1053000",
    "end": "1097000"
  },
  {
    "text": "okay um so as we mentioned before the allocation unit ndfs is cluster",
    "start": "1053720",
    "end": "1059120"
  },
  {
    "text": "which is a collection of sectors um antivirus applies magnetism code fixed up to protect the Integrity",
    "start": "1059120",
    "end": "1067120"
  },
  {
    "text": "of the intersector of the metadata so that you will be able to detect erupted",
    "start": "1067120",
    "end": "1075380"
  },
  {
    "text": "corrupt gravity sectors in a classroom but not only that metadata applies this",
    "start": "1075380",
    "end": "1081200"
  },
  {
    "text": "protection only the important ones so like the fire records in mft or",
    "start": "1081200",
    "end": "1090020"
  },
  {
    "text": "directory records or other directories uh regularly in directories",
    "start": "1090020",
    "end": "1097000"
  },
  {
    "text": "okay so how is fixed up working assuming now we are writing to a file record in the mft",
    "start": "1097460",
    "end": "1103520"
  },
  {
    "text": "the header of the firework contains the update sequence number and in a rip",
    "start": "1103520",
    "end": "1108799"
  },
  {
    "text": "offer for each sector of the record before writing the reviews and is",
    "start": "1108799",
    "end": "1115100"
  },
  {
    "text": "incremented by one so one two three four two one two three five",
    "start": "1115100",
    "end": "1121780"
  },
  {
    "text": "then it will copy the last two buys of each sector into the update update",
    "start": "1121880",
    "end": "1127640"
  },
  {
    "text": "sequence array",
    "start": "1127640",
    "end": "1130360"
  },
  {
    "text": "um Okay so two distribution array and",
    "start": "1132860",
    "end": "1139280"
  },
  {
    "text": "and you write the newest and the new SN to the end of each sector",
    "start": "1139280",
    "end": "1146259"
  },
  {
    "text": "okay um so and then as it written back to the disk",
    "start": "1149299",
    "end": "1156200"
  },
  {
    "start": "1155000",
    "end": "1202000"
  },
  {
    "text": "and here's the cartoon button code for the fix up logic before writing fix up",
    "start": "1156200",
    "end": "1161600"
  },
  {
    "text": "is the turn used in the implementation it is the synonym for usn",
    "start": "1161600",
    "end": "1167059"
  },
  {
    "text": "the fix up of set and the size of the fixed array are retrieved from record header",
    "start": "1167059",
    "end": "1172520"
  },
  {
    "text": "and some Sandy checks applied here and in the middle you can see that the",
    "start": "1172520",
    "end": "1180140"
  },
  {
    "text": "fix up is incremented by one and you wrap that back down to one if it resists",
    "start": "1180140",
    "end": "1187539"
  },
  {
    "text": "and we have a loop here that will put the fix up to the uh",
    "start": "1188840",
    "end": "1195679"
  },
  {
    "text": "the the sectors of the array",
    "start": "1195679",
    "end": "1200860"
  },
  {
    "text": "on Country the reading flow expects the key the opposite of writing after reading the contents front disk",
    "start": "1203000",
    "end": "1210200"
  },
  {
    "text": "and DFS will first check the usn against each Dash two bytes of the sectors in a",
    "start": "1210200",
    "end": "1215539"
  },
  {
    "text": "record the value should o be less than as the writing flow described before",
    "start": "1215539",
    "end": "1222860"
  },
  {
    "text": "or it may indicate the best sectors or these Corruptions",
    "start": "1222860",
    "end": "1228860"
  },
  {
    "text": "and if you will check this past the end Davis will copy the corresponding fix up back to the last two bytes of the",
    "start": "1228860",
    "end": "1235640"
  },
  {
    "text": "sectors here okay",
    "start": "1235640",
    "end": "1241760"
  },
  {
    "start": "1241000",
    "end": "1267000"
  },
  {
    "text": "um here's the schedule for reading um same as writing the fix up of set and size are retrieved from record header",
    "start": "1241760",
    "end": "1248720"
  },
  {
    "text": "I'm applying the send standard check and at the end the loop is responsible",
    "start": "1248720",
    "end": "1254240"
  },
  {
    "text": "responsible for checking where the usn and the last device of current sectors match if not it won't break a loop but",
    "start": "1254240",
    "end": "1261980"
  },
  {
    "text": "it will return an error code in the end um okay",
    "start": "1261980",
    "end": "1268460"
  },
  {
    "start": "1267000",
    "end": "1331000"
  },
  {
    "text": "so uh we've already expressed the challenges for image of using and so how",
    "start": "1268460",
    "end": "1274280"
  },
  {
    "text": "this purple sub leads challenges first it only extracts metadata from the",
    "start": "1274280",
    "end": "1280580"
  },
  {
    "text": "image and feed it to the mutator which could save lots of time because only in",
    "start": "1280580",
    "end": "1286880"
  },
  {
    "text": "metadata is mutated and no user data involved and second the image process within",
    "start": "1286880",
    "end": "1293960"
  },
  {
    "text": "legit values after limitation for example it will replace the uh you will",
    "start": "1293960",
    "end": "1300320"
  },
  {
    "text": "replace the OEM ID make sure it equals NTFS and for spaces and the sector size",
    "start": "1300320",
    "end": "1308000"
  },
  {
    "text": "um it will rep down to the nearest part two so say if the mutation I have the",
    "start": "1308000",
    "end": "1313159"
  },
  {
    "text": "mutation we have 1050 it will replace with 1024",
    "start": "1313159",
    "end": "1319539"
  },
  {
    "text": "and combined with the adjusted metadata with user data we have an image that can",
    "start": "1320200",
    "end": "1326780"
  },
  {
    "text": "be successfully mounted by our executor",
    "start": "1326780",
    "end": "1331600"
  },
  {
    "start": "1331000",
    "end": "1443000"
  },
  {
    "text": "okay another attack Vector is the fire operation which brings you another Trend to fast",
    "start": "1332240",
    "end": "1337760"
  },
  {
    "text": "system plastic and effective other need to know what system codes to generate there must be",
    "start": "1337760",
    "end": "1344299"
  },
  {
    "text": "operation related how to mutate the parameters of list generated season codes",
    "start": "1344299",
    "end": "1350539"
  },
  {
    "text": "if the father is mutating the parameter for Bridge season code the first",
    "start": "1350539",
    "end": "1356659"
  },
  {
    "text": "parameter must be a verified descriptor and as the R2 the second parameter is",
    "start": "1356659",
    "end": "1362659"
  },
  {
    "text": "the buffer and third is the power size um randomly are simply randomly",
    "start": "1362659",
    "end": "1368419"
  },
  {
    "text": "generating parameters to the system is mainly because um you just get lost very code return or",
    "start": "1368419",
    "end": "1376039"
  },
  {
    "text": "get your uh executor terminated by some exceptions",
    "start": "1376039",
    "end": "1382159"
  },
  {
    "text": "and how to make the further context Square how to link lists are generated system",
    "start": "1382159",
    "end": "1388640"
  },
  {
    "text": "codes the further should maintain the contacts okay across each system code",
    "start": "1388640",
    "end": "1396080"
  },
  {
    "text": "here's example so if the father uh generate a new open system code if the",
    "start": "1396080",
    "end": "1403220"
  },
  {
    "text": "pass exists Euler mode or flag is permitted and it will get a valid affect",
    "start": "1403220",
    "end": "1410059"
  },
  {
    "text": "the return and the the different shoe should be kept in",
    "start": "1410059",
    "end": "1416600"
  },
  {
    "text": "the the program's context so if the father wants to mutate the system code",
    "start": "1416600",
    "end": "1424059"
  },
  {
    "text": "which takes a file descriptor for parameter for example read write or",
    "start": "1424059",
    "end": "1430460"
  },
  {
    "text": "close or any other cycle that takes file distributor",
    "start": "1430460",
    "end": "1436120"
  },
  {
    "text": "get the valid participrator from the context",
    "start": "1437559",
    "end": "1442720"
  },
  {
    "start": "1443000",
    "end": "1500000"
  },
  {
    "text": "okay the front graph shows the flow of system conversing in popular the seed program is derived by a set of",
    "start": "1443659",
    "end": "1450860"
  },
  {
    "text": "tools which are also part of the popular fossil you can check Remy for detailed",
    "start": "1450860",
    "end": "1456260"
  },
  {
    "text": "instructions the C program itself is a serialized format and condensed variables system",
    "start": "1456260",
    "end": "1462020"
  },
  {
    "text": "codes and for object the first phase is mutate pabola will",
    "start": "1462020",
    "end": "1468860"
  },
  {
    "text": "choose randomly choose system codes from the C programs context and mutate its",
    "start": "1468860",
    "end": "1475340"
  },
  {
    "text": "parameter accordingly and if layers know interesting outcome",
    "start": "1475340",
    "end": "1481220"
  },
  {
    "text": "it will switch to phase two generally it will generate a new system codes and",
    "start": "1481220",
    "end": "1488120"
  },
  {
    "text": "update the context accordingly so if there's a new file open open for new",
    "start": "1488120",
    "end": "1494299"
  },
  {
    "text": "file descriptor it will keep it in context",
    "start": "1494299",
    "end": "1499299"
  },
  {
    "start": "1500000",
    "end": "1575000"
  },
  {
    "text": "okay now we've already served two challenges and the system converting the last",
    "start": "1500720",
    "end": "1508700"
  },
  {
    "text": "consideration is how to run the test case how to choose your executor",
    "start": "1508700",
    "end": "1514820"
  },
  {
    "text": "um here's purely are the comparisons between a real device and virtual machine",
    "start": "1514820",
    "end": "1519919"
  },
  {
    "text": "the real machine is faster than virtual machine outlets for sure but the virtual machine has better",
    "start": "1519919",
    "end": "1526400"
  },
  {
    "text": "scalability you can you can scale or just by around more VM instances if the",
    "start": "1526400",
    "end": "1533960"
  },
  {
    "text": "memory is allowed but on the other hand if you want to scale the real a real",
    "start": "1533960",
    "end": "1539779"
  },
  {
    "text": "device you must buy more devices oh so um the virtual machine is easier",
    "start": "1539779",
    "end": "1546080"
  },
  {
    "text": "to match you can manage them by um some Scripts",
    "start": "1546080",
    "end": "1552140"
  },
  {
    "text": "um or by some scripts but if you want to manage the real machine you may need",
    "start": "1552140",
    "end": "1558980"
  },
  {
    "text": "some some devices for example uh debug board debug board or some are real Hardware",
    "start": "1558980",
    "end": "1566299"
  },
  {
    "text": "devices the real machine is risky because you",
    "start": "1566299",
    "end": "1571460"
  },
  {
    "text": "may break your device okay so instead of using real machine or",
    "start": "1571460",
    "end": "1578900"
  },
  {
    "start": "1575000",
    "end": "1665000"
  },
  {
    "text": "virtual machine popular utilizes sleep OS executor asgenes leak secureral links with Linux kernel",
    "start": "1578900",
    "end": "1586159"
  },
  {
    "text": "as a library loyal KL which is a project to compile Linux kernel code into an",
    "start": "1586159",
    "end": "1591260"
  },
  {
    "text": "object file that can be directly linked by applications so uh basically the scooter is a usable",
    "start": "1591260",
    "end": "1599000"
  },
  {
    "text": "application with kernel functionalities so our executor is fast as fast as a",
    "start": "1599000",
    "end": "1606559"
  },
  {
    "text": "username program and it is managed and it is scale and",
    "start": "1606559",
    "end": "1611779"
  },
  {
    "text": "more importantly it's easy to reproduce because not like the uh real machine or virtual",
    "start": "1611779",
    "end": "1619340"
  },
  {
    "text": "machine they had unstable or aging kernel but it also has some deficiencies so for",
    "start": "1619340",
    "end": "1627620"
  },
  {
    "text": "example lkl itself is implemented as an architecture",
    "start": "1627620",
    "end": "1632720"
  },
  {
    "text": "and it has some limitations in current implementation it's it has no mmu so our",
    "start": "1632720",
    "end": "1641179"
  },
  {
    "text": "new virtual memory support and it is an uniprocessor architecture",
    "start": "1641179",
    "end": "1646220"
  },
  {
    "text": "also um it is it is not in the main line and it is also sometimes inactive",
    "start": "1646220",
    "end": "1653000"
  },
  {
    "text": "sometimes so if you need the latest kernel you may need to do the kernel",
    "start": "1653000",
    "end": "1658340"
  },
  {
    "text": "upgrading yourself yeah okay",
    "start": "1658340",
    "end": "1663620"
  },
  {
    "text": "um so uh this diagram here shows the whole workflow of popular",
    "start": "1663620",
    "end": "1669740"
  },
  {
    "start": "1665000",
    "end": "1741000"
  },
  {
    "text": "uh first combining the acid image and C program I will get the initial purpose",
    "start": "1669740",
    "end": "1675980"
  },
  {
    "text": "the image reposit will extract meta from this image and then pass it to the image mutator and we'll fix the key fill",
    "start": "1675980",
    "end": "1683299"
  },
  {
    "text": "values after our mutation and finally replace the elastic balls of some",
    "start": "1683299",
    "end": "1688880"
  },
  {
    "text": "sectors in a cluster with correct fix up fixed up values",
    "start": "1688880",
    "end": "1694400"
  },
  {
    "text": "and then we'll pass it to the Excel the executor so we can successfully mount it",
    "start": "1694400",
    "end": "1700159"
  },
  {
    "text": "as a remounted image and start our fuzzing to our Mount flow",
    "start": "1700159",
    "end": "1707799"
  },
  {
    "text": "and if there's no new coverage or any new crash case it move it will move to",
    "start": "1707799",
    "end": "1715460"
  },
  {
    "text": "second phase which is by system for assistance the first step is to mutate existing",
    "start": "1715460",
    "end": "1723860"
  },
  {
    "text": "vaccine curves parameters and if there's no new uh purpose no no new coverage or",
    "start": "1723860",
    "end": "1731179"
  },
  {
    "text": "Crush case you move to uh second the second phase of the first fire operation",
    "start": "1731179",
    "end": "1736940"
  },
  {
    "text": "policy to generate new facets and codes",
    "start": "1736940",
    "end": "1741639"
  },
  {
    "start": "1741000",
    "end": "1843000"
  },
  {
    "text": "okay um so far we've already covered the design and workflow over our approach",
    "start": "1742159",
    "end": "1748220"
  },
  {
    "text": "but actually when we knew that anniversary was going to merge into my life we choose the most promising",
    "start": "1748220",
    "end": "1755419"
  },
  {
    "text": "solution back then on this famous this color um we rented for months with a customize",
    "start": "1755419",
    "end": "1761899"
  },
  {
    "text": "this land description that contains for operation related settings only but no",
    "start": "1761899",
    "end": "1767659"
  },
  {
    "text": "interesting outcome and we did some race and we fight genus",
    "start": "1767659",
    "end": "1774980"
  },
  {
    "text": "but uh so as we already explained we are still missing uh the image parser the",
    "start": "1774980",
    "end": "1781460"
  },
  {
    "text": "DFS image passer and and the upgrading we need to upgrade uh the labor OS the",
    "start": "1781460",
    "end": "1788600"
  },
  {
    "text": "lkl to the latest kernel and some functionality for example the",
    "start": "1788600",
    "end": "1794179"
  },
  {
    "text": "case and Patch integration okay um",
    "start": "1794179",
    "end": "1800980"
  },
  {
    "text": "yeah okay so in the end we identify 12 questions or 12 issues um",
    "start": "1801140",
    "end": "1808159"
  },
  {
    "text": "actually is currently 14 issues the maintenance just replied me a couple days ago and as listed in the table",
    "start": "1808159",
    "end": "1816080"
  },
  {
    "text": "we'll have uh these issues we categorize these issues into two types the green",
    "start": "1816080",
    "end": "1823100"
  },
  {
    "text": "one is type 1 which can be triggered by a mounting image and uh purple color is",
    "start": "1823100",
    "end": "1832159"
  },
  {
    "text": "Type 2 which can be triggered by a mounting the image and with some for",
    "start": "1832159",
    "end": "1837380"
  },
  {
    "text": "operations we'll review these issues on one for each kind",
    "start": "1837380",
    "end": "1842919"
  },
  {
    "text": "okay so this is a type 1 issue which can be triggered by mounting the mutated image",
    "start": "1843799",
    "end": "1849679"
  },
  {
    "text": "we have already seen PBS An important metadata located at the first sector of",
    "start": "1849679",
    "end": "1855260"
  },
  {
    "text": "the ndis volume and there's a critical field called MFD entry an empty entry",
    "start": "1855260",
    "end": "1860720"
  },
  {
    "text": "size in PBS which specifies the size of an MFD entry",
    "start": "1860720",
    "end": "1866360"
  },
  {
    "text": "um if the the value is positive which denotes the number of cluster of MLT",
    "start": "1866360",
    "end": "1873440"
  },
  {
    "text": "entry so if it's one it means one cluster you can we can get the real size",
    "start": "1873440",
    "end": "1879380"
  },
  {
    "text": "by multiplying the bytes per sector and sectors cluster",
    "start": "1879380",
    "end": "1884799"
  },
  {
    "text": "a negative value denotes the number of bytes of MFD entry which uh in which",
    "start": "1884799",
    "end": "1891860"
  },
  {
    "text": "case uh if we have a F6 which is -10 for a short for a side byte value",
    "start": "1891860",
    "end": "1899179"
  },
  {
    "text": "then we'll have the real real values to to 2 to the power of 10. so which is",
    "start": "1899179",
    "end": "1906500"
  },
  {
    "text": "1024 okay so here's the step stack address",
    "start": "1906500",
    "end": "1913340"
  },
  {
    "start": "1909000",
    "end": "1947000"
  },
  {
    "text": "and on the left side is the back trace of this issue we can tell that it is MBD",
    "start": "1913340",
    "end": "1920059"
  },
  {
    "text": "from first line the backrest shows the kernel crash we're mounting the image",
    "start": "1920059",
    "end": "1926779"
  },
  {
    "text": "okay and the right diagram tells the details of the antivirus image mounting",
    "start": "1926779",
    "end": "1932059"
  },
  {
    "text": "we can maybe back to the stack backrest um the mount flow or start from the mail",
    "start": "1932059",
    "end": "1938659"
  },
  {
    "text": "system code and all the way to some the advices implementation for example and",
    "start": "1938659",
    "end": "1945020"
  },
  {
    "text": "the best via super okay so what is the root cause of lambd",
    "start": "1945020",
    "end": "1951919"
  },
  {
    "start": "1947000",
    "end": "2025000"
  },
  {
    "text": "issue anti-restrial super will call and DMS in different boots which is a function for",
    "start": "1951919",
    "end": "1958820"
  },
  {
    "text": "PBS passing and it will calculate the MFD regular size by the formula we express",
    "start": "1958820",
    "end": "1966100"
  },
  {
    "text": "before then it will get regular bits by the block size bits function",
    "start": "1966100",
    "end": "1973700"
  },
  {
    "text": "but uh however it has an an assumption it assumes that the size is always",
    "start": "1973700",
    "end": "1981679"
  },
  {
    "text": "always larger than 256 so you can see the initial value written value is a and",
    "start": "1981679",
    "end": "1987500"
  },
  {
    "text": "we have a so it will it will increase it by what",
    "start": "1987500",
    "end": "1992779"
  },
  {
    "text": "so the smallest written value is 9.",
    "start": "1992779",
    "end": "1997360"
  },
  {
    "text": "okay so but if we have a record size which is a f a then it's uh minus a in",
    "start": "1998840",
    "end": "2006700"
  },
  {
    "text": "uh in uh for our sign side byte value then we all have the real value is 2 to",
    "start": "2006700",
    "end": "2013779"
  },
  {
    "text": "the power of a which is two by six but the record base is nine so we have",
    "start": "2013779",
    "end": "2020019"
  },
  {
    "text": "mismatch here which will lead to MBD issue",
    "start": "2020019",
    "end": "2024840"
  },
  {
    "start": "2025000",
    "end": "2038000"
  },
  {
    "text": "and here's the patch it's pretty straightforward we just add a check that the record size is equal or larger than",
    "start": "2025840",
    "end": "2032919"
  },
  {
    "text": "our sector size to support the assumption",
    "start": "2032919",
    "end": "2037620"
  },
  {
    "text": "okay here's an example of type 2 issue with CBO sign we have already introduced",
    "start": "2038559",
    "end": "2044980"
  },
  {
    "text": "MFD earlier so our table that stores all information or files or directories of",
    "start": "2044980",
    "end": "2050080"
  },
  {
    "text": "antivirus volume um the upper right diagram represents a simplified diametery MFD entry format it",
    "start": "2050080",
    "end": "2057220"
  },
  {
    "text": "just starts with a record header and and attribute array",
    "start": "2057220",
    "end": "2062618"
  },
  {
    "text": "and with the uh with the the first field is the",
    "start": "2062619",
    "end": "2068260"
  },
  {
    "text": "attribute attribute type and the second is the size and the Third Field is the",
    "start": "2068260",
    "end": "2075520"
  },
  {
    "text": "non-version which indicates whether this attribute is resident or non-resident a",
    "start": "2075520",
    "end": "2081878"
  },
  {
    "text": "resident attribute means its data can fit into the mft entry",
    "start": "2081879",
    "end": "2087419"
  },
  {
    "text": "okay so let's take a look at the backrest of the kernel crash it is the slab outer bound right so it's possible",
    "start": "2087580",
    "end": "2095440"
  },
  {
    "text": "to exploit this vulnerability we can tell that the root cause is somewhere when user code set X at ZX",
    "start": "2095440",
    "end": "2103839"
  },
  {
    "text": "attribute system code um all the way to and I create attribute list then trigger the case and the quad",
    "start": "2103839",
    "end": "2112119"
  },
  {
    "text": "copying memory content so the image must has been already successfully mounted",
    "start": "2112119",
    "end": "2120000"
  },
  {
    "text": "okay the rest is the casing report which tells us that the address belongs to the",
    "start": "2121359",
    "end": "2127900"
  },
  {
    "text": "1K size buffer now we know the root cause probably lies",
    "start": "2127900",
    "end": "2135099"
  },
  {
    "start": "2131000",
    "end": "2216000"
  },
  {
    "text": "in the non-created attribute list so our investigations that's right there",
    "start": "2135099",
    "end": "2141579"
  },
  {
    "text": "um first it allocates one case size buffer for attribute list entry and remember the case and Report tell this",
    "start": "2141579",
    "end": "2148359"
  },
  {
    "text": "the uh at the ground right address balancing having high size then there's a full loop to enumerate",
    "start": "2148359",
    "end": "2155500"
  },
  {
    "text": "the attribute by calling uh mi in our attributes um",
    "start": "2155500",
    "end": "2161260"
  },
  {
    "text": "and it has some checks uh send the checks for the size of the attributes",
    "start": "2161260",
    "end": "2166480"
  },
  {
    "text": "for the non-resident attribute check the size and the offset make sure it won't",
    "start": "2166480",
    "end": "2172839"
  },
  {
    "text": "cause any Autobahn right and they will turn it immediately if the check is passed",
    "start": "2172839",
    "end": "2179020"
  },
  {
    "text": "however up it means the sand check for our attribute and lens and offset",
    "start": "2179020",
    "end": "2185400"
  },
  {
    "text": "as the non-resident sdn non-resident attribute at a button",
    "start": "2185400",
    "end": "2190839"
  },
  {
    "text": "you can see that track invest for the resident attributes",
    "start": "2190839",
    "end": "2196660"
  },
  {
    "text": "so if a malicious attacker crafted",
    "start": "2196660",
    "end": "2202480"
  },
  {
    "text": "um intentionally curved this attributes with malicious attribute demo lens",
    "start": "2202480",
    "end": "2208060"
  },
  {
    "text": "it could lead to other one right which can be used or exploited by experienced",
    "start": "2208060",
    "end": "2214420"
  },
  {
    "text": "attacker and yes patch we just add the missing",
    "start": "2214420",
    "end": "2220420"
  },
  {
    "text": "part for attribute name lens and I'm set for the resident attribute",
    "start": "2220420",
    "end": "2225900"
  },
  {
    "start": "2226000",
    "end": "2293000"
  },
  {
    "text": "okay um we've elaborated the architecture and fasting flow of Apollo",
    "start": "2226780",
    "end": "2232839"
  },
  {
    "text": "um so we've approved that it's an effective and efficient for the currently targeting antibes but easy to",
    "start": "2232839",
    "end": "2239260"
  },
  {
    "text": "extend to autofile system we also review some of the issues identified by people are one for each",
    "start": "2239260",
    "end": "2245500"
  },
  {
    "text": "kind and here's our conclusion um complicated systems is always about a",
    "start": "2245500",
    "end": "2253180"
  },
  {
    "text": "good Target for our security researchers because more complicated well the higher",
    "start": "2253180",
    "end": "2260020"
  },
  {
    "text": "possibility there's a vulnerability in the system that's for sure second on fire system maintenance should",
    "start": "2260020",
    "end": "2266619"
  },
  {
    "text": "pay more attention to the metadata on the metadata Integrity I will be seeing",
    "start": "2266619",
    "end": "2272020"
  },
  {
    "text": "several cases that uh caused by by the trusting the metadata",
    "start": "2272020",
    "end": "2278140"
  },
  {
    "text": "Retreat from the image unless users should be cautious on",
    "start": "2278140",
    "end": "2283240"
  },
  {
    "text": "mounting mounting disk image if you have concern is sandbox or VM if",
    "start": "2283240",
    "end": "2291160"
  },
  {
    "text": "you don't trust the source okay um I think that's all for our",
    "start": "2291160",
    "end": "2297339"
  },
  {
    "start": "2293000",
    "end": "2311000"
  },
  {
    "text": "advantages oh yeah we don't have time so I'm sorry about that so if you have more questions",
    "start": "2297339",
    "end": "2303700"
  },
  {
    "text": "we we can talk offline thank you thank you thank you",
    "start": "2303700",
    "end": "2310800"
  }
]