[
  {
    "start": "0",
    "end": "105000"
  },
  {
    "text": "uh without further Ado I'd like to introduce two colleagues of mine and and dear friends they're going to talk about something really awesome file cry the",
    "start": "160",
    "end": "6600"
  },
  {
    "text": "new age of xxc so please get a warm Round of Applause for shaon ju and Sergey garati thank you so",
    "start": "6600",
    "end": "14880"
  },
  {
    "text": "much hello everybody uh we hope not to bore you and on the last talk so we'll",
    "start": "17800",
    "end": "25320"
  },
  {
    "text": "uh show you some zero days we'll show you some uh cool demos",
    "start": "25320",
    "end": "30599"
  },
  {
    "text": "uh and uh but first let me introduce myself uh Sero a security engineer at",
    "start": "30599",
    "end": "36399"
  },
  {
    "text": "Salesforce uh I work on mobile and web apps uh and my colleague yeah my name is",
    "start": "36399",
    "end": "43280"
  },
  {
    "text": "Shan and both Angelo suran and I and bunch of colleagues are sitting here we're all working for Salesforce and my",
    "start": "43280",
    "end": "49520"
  },
  {
    "text": "research interests are web application security browser security and bunch of other random stuff so uh we'll make it",
    "start": "49520",
    "end": "56559"
  },
  {
    "text": "interesting we know we're the only talk that stands between you and parties but we're going to make it",
    "start": "56559",
    "end": "63160"
  },
  {
    "text": "as interesting as possible so stay tuned all",
    "start": "63160",
    "end": "68400"
  },
  {
    "text": "right so what are we talking about we're talking about XML right so XML is an",
    "start": "68400",
    "end": "75439"
  },
  {
    "text": "interesting uh animal it has a you know a bunch of cool features uh it allows",
    "start": "75439",
    "end": "80720"
  },
  {
    "text": "you to embed the dock type and when you embed the doct type you can specify an entity a general or parameter entity and",
    "start": "80720",
    "end": "87920"
  },
  {
    "text": "entity essentially is just a symbolic link symbolic link to a file or some data",
    "start": "87920",
    "end": "93880"
  },
  {
    "text": "anything that can be stored outside of the current document and I really like this quote w3c put together that all",
    "start": "93880",
    "end": "101280"
  },
  {
    "text": "external entities are well formed by definition let's look into that so",
    "start": "101280",
    "end": "108119"
  },
  {
    "text": "here's a typical xxc 101 uh this was taken from the black hat of last uh last year talk and essentially this is an",
    "start": "108119",
    "end": "115520"
  },
  {
    "text": "example of how to do uh XML external entity expansion that's what the xsc",
    "start": "115520",
    "end": "120640"
  },
  {
    "text": "stands for so let's take a look uh we have an entity called xsc and it",
    "start": "120640",
    "end": "127439"
  },
  {
    "text": "basically leans to Etsy password and when XML parser looks at this it tries",
    "start": "127439",
    "end": "133120"
  },
  {
    "text": "to resolve and go and tries to fetch the uh you know Etsy password and see what's",
    "start": "133120",
    "end": "138640"
  },
  {
    "text": "inside of it and of course there's no XML there so something will happen all",
    "start": "138640",
    "end": "145280"
  },
  {
    "text": "right so this is not a new problem uh we've talked uh you know there's The Talk this morning there was about xxc",
    "start": "145280",
    "end": "152000"
  },
  {
    "text": "and there are a bunch of talks from last year so not really a new thing but why are we still here you know what what's",
    "start": "152000",
    "end": "158800"
  },
  {
    "text": "this talk about so we're going to talk about you know the problem that not only",
    "start": "158800",
    "end": "164280"
  },
  {
    "text": "your applications that you use XML parses and you fix them but also the",
    "start": "164280",
    "end": "170080"
  },
  {
    "text": "applications that you run on and the applications like browsers that you use",
    "start": "170080",
    "end": "175879"
  },
  {
    "text": "to look at your web apps are also problematic and vulnerable",
    "start": "175879",
    "end": "181239"
  },
  {
    "start": "180000",
    "end": "399000"
  },
  {
    "text": "all right so with this I'm not going to like drag too long I'm just going to show you so let's see I was working on a",
    "start": "181239",
    "end": "189239"
  },
  {
    "text": "you know simple web app that does nothing but pretty much takes a file an",
    "start": "189239",
    "end": "194680"
  },
  {
    "text": "XML file you upload it and it does a pretty print okay so let's say I take a simple",
    "start": "194680",
    "end": "202799"
  },
  {
    "text": "file I upload it and you know this is a work in progress just a demo so then I decided Well hey you know",
    "start": "202799",
    "end": "210640"
  },
  {
    "text": "xmls are problematic maybe I should look into defending against external entities so I used the uh the XML from",
    "start": "210640",
    "end": "220159"
  },
  {
    "text": "last year's black hat talk and I just uploaded it and boom what do you",
    "start": "220159",
    "end": "225799"
  },
  {
    "text": "see it's my Etsy password okay this is not good all right so I decided Well let",
    "start": "225799",
    "end": "232400"
  },
  {
    "text": "let's go fix it in a code let's go uh look at my basically XML um parsing",
    "start": "232400",
    "end": "240200"
  },
  {
    "text": "and where I create the uh the factory you see I'm just creating a factory so",
    "start": "240200",
    "end": "245519"
  },
  {
    "text": "let's just uh make sure that you know we secure it okay so how do I secure this thing so I was like oh hey I remember",
    "start": "245519",
    "end": "253200"
  },
  {
    "text": "that oasp had some recommendations and when we look at the Java section okay you have document",
    "start": "253200",
    "end": "258959"
  },
  {
    "text": "Builder Factory you have xerses oh okay XML input Factory the one that I'm using",
    "start": "258959",
    "end": "264120"
  },
  {
    "text": "it says turn DTD off well that's not what I need I really need to actually to make it work cuz I",
    "start": "264120",
    "end": "271039"
  },
  {
    "text": "don't wanted to throw an exception when I use DTD so I kept looking and so we",
    "start": "271039",
    "end": "276280"
  },
  {
    "text": "basically found a way to turn off external entities",
    "start": "276280",
    "end": "281759"
  },
  {
    "text": "specifically all right so let's try this we'll going to turn off external",
    "start": "281759",
    "end": "287600"
  },
  {
    "text": "entities save",
    "start": "287600",
    "end": "293560"
  },
  {
    "text": "stop restart the server okay",
    "start": "293560",
    "end": "301560"
  },
  {
    "text": "we're still up or",
    "start": "302639",
    "end": "309280"
  },
  {
    "text": "so all right and upload the same Factory and see what",
    "start": "309520",
    "end": "317120"
  },
  {
    "text": "happens what's the problem uh looks like my Etsy password is still result even",
    "start": "317160",
    "end": "325560"
  },
  {
    "text": "after I said the jdk please don't touch my files and don't touch any external",
    "start": "325560",
    "end": "330800"
  },
  {
    "text": "entities it still resolved it so this looks like a problem you know and you know Java is telling you how to do it",
    "start": "330800",
    "end": "337520"
  },
  {
    "text": "but it's not working so we kept looking we decided Well hey there's another feature in XML parsers called uh",
    "start": "337520",
    "end": "345039"
  },
  {
    "text": "resolvers and you can pass in your own resolver so let's try to do this too so",
    "start": "345039",
    "end": "350600"
  },
  {
    "text": "we have a uh factory set the XML resolver and create",
    "start": "350600",
    "end": "357240"
  },
  {
    "text": "a new XML resolver and this",
    "start": "357240",
    "end": "362240"
  },
  {
    "text": "basically creates a uh every time that uh XML is asking us to resolve some it",
    "start": "362680",
    "end": "368520"
  },
  {
    "text": "just returns null okay so this should totally work right you know XML is not supposed to resolve like I'm turn",
    "start": "368520",
    "end": "374880"
  },
  {
    "text": "returning it to no let's try",
    "start": "374880",
    "end": "379800"
  },
  {
    "text": "again coming back",
    "start": "381000",
    "end": "385960"
  },
  {
    "text": "refresh try again upload still the same",
    "start": "387080",
    "end": "393639"
  },
  {
    "text": "problem so what's going on looks like we have an",
    "start": "393639",
    "end": "402000"
  },
  {
    "start": "399000",
    "end": "437000"
  },
  {
    "text": "XML parser that has a feature is supporting external entities and I went",
    "start": "402000",
    "end": "408039"
  },
  {
    "text": "to look in the documentation and it's default values actually unspecified that was",
    "start": "408039",
    "end": "413800"
  },
  {
    "text": "interesting so with the unspecified one I decided to well you know if you set",
    "start": "413800",
    "end": "419240"
  },
  {
    "text": "the the proper um feature to false this should really not work but as you just",
    "start": "419240",
    "end": "425240"
  },
  {
    "text": "saw it it doesn't work uh for the malicious case where you have external",
    "start": "425240",
    "end": "430759"
  },
  {
    "text": "entity that expands inside another entity and makes a throw an exception but for normal files it worked so this",
    "start": "430759",
    "end": "438639"
  },
  {
    "text": "made me really weary of uh working with XML in Java you know especially if you",
    "start": "438639",
    "end": "444080"
  },
  {
    "text": "taken into account that you said Java don't resolve and it resolves so what is",
    "start": "444080",
    "end": "449120"
  },
  {
    "text": "the effect soap API",
    "start": "449120",
    "end": "454520"
  },
  {
    "text": "saml SSO XML RPC all of those use XML that",
    "start": "454520",
    "end": "461560"
  },
  {
    "text": "you can pass dock type that you can pass external entities and even if you're set",
    "start": "461560",
    "end": "467319"
  },
  {
    "text": "on your server you know in jdk hey do not resolve external entities still",
    "start": "467319",
    "end": "474400"
  },
  {
    "text": "works so we we of course thought well this is a problem so we contct Oracle",
    "start": "474479",
    "end": "480360"
  },
  {
    "start": "475000",
    "end": "493000"
  },
  {
    "text": "and Oracle said yeah this is a zero day uh we're going to fix it and so uh",
    "start": "480360",
    "end": "485680"
  },
  {
    "text": "essentially like all of the uh uh uh GDK was affected like every single",
    "start": "485680",
    "end": "492720"
  },
  {
    "text": "version this is cool so resolvers I thought well passing now you know should",
    "start": "492720",
    "end": "499280"
  },
  {
    "start": "493000",
    "end": "515000"
  },
  {
    "text": "have been really fixing the problem but turns out that the eclipse autogenerated stop is not super helpful what you",
    "start": "499280",
    "end": "505759"
  },
  {
    "text": "really should do and is slightly counterintuitive you need to return a completely new input source that would",
    "start": "505759",
    "end": "513159"
  },
  {
    "text": "actually fix it all right so now you have a web",
    "start": "513159",
    "end": "519000"
  },
  {
    "text": "server running an old um version of java I know a relatively old uh 7even update",
    "start": "519000",
    "end": "525560"
  },
  {
    "text": "65 it's not really that old so if you have this service running and what you",
    "start": "525560",
    "end": "532399"
  },
  {
    "text": "can do you can steal some data but how do you get it you can get it using a",
    "start": "532399",
    "end": "538600"
  },
  {
    "text": "couple of ways you can use the uh uh XML printing of the errors that uh I showed",
    "start": "538600",
    "end": "544320"
  },
  {
    "text": "to you or actually you can use the uh DNS out of bound uh that was uh talked",
    "start": "544320",
    "end": "550600"
  },
  {
    "text": "about in black hat 2013 but DNS has kind of uh quite a few disadvantages there's",
    "start": "550600",
    "end": "557839"
  },
  {
    "text": "a limit on the size there's some characters that it can support so we decided we're going to just focus on the",
    "start": "557839",
    "end": "564240"
  },
  {
    "text": "uh exceptions okay so if you look at the exception that is created if you try to",
    "start": "564240",
    "end": "570440"
  },
  {
    "start": "565000",
    "end": "587000"
  },
  {
    "text": "uh resolve a file by an XML that doesn't really exist like Etsy passwords what",
    "start": "570440",
    "end": "576720"
  },
  {
    "text": "happens is that underneath it's a nested exception that tells you that hey I just",
    "start": "576720",
    "end": "582160"
  },
  {
    "text": "couldn't understand what's what what what is the thing that you're trying to look at okay so that means that we",
    "start": "582160",
    "end": "589800"
  },
  {
    "start": "587000",
    "end": "603000"
  },
  {
    "text": "really need to do is just cause exceptions and if we're trying to read like like file system you know like Etsy",
    "start": "589800",
    "end": "596120"
  },
  {
    "text": "content then you can just pass you know jar SL Etsy and that's it you you get to",
    "start": "596120",
    "end": "602160"
  },
  {
    "text": "read it so when you got to that point you're essentially looking at the",
    "start": "602160",
    "end": "607200"
  },
  {
    "start": "603000",
    "end": "628000"
  },
  {
    "text": "contents of the file system that is exposed to the user as an",
    "start": "607200",
    "end": "612959"
  },
  {
    "text": "exception so you call a samle you know API or or like soap API and you get back",
    "start": "612959",
    "end": "619440"
  },
  {
    "text": "an exception and it gives you the content of the servers um file system that's pretty",
    "start": "619440",
    "end": "625399"
  },
  {
    "text": "cool all right so this is how it looks all right so I thought this was interesting when with",
    "start": "625399",
    "end": "631519"
  },
  {
    "start": "628000",
    "end": "673000"
  },
  {
    "text": "aasp that covers only three types of parsers stacks um and it covers the sax",
    "start": "631519",
    "end": "639360"
  },
  {
    "text": "parsers and two types of xerses the recommendations don't cover a whole lot",
    "start": "639360",
    "end": "645079"
  },
  {
    "text": "more jdk parsers on top of that you also have",
    "start": "645079",
    "end": "650320"
  },
  {
    "text": "popular parsers that are available out there and mind you those parsers are actually using um you know those you",
    "start": "650320",
    "end": "657320"
  },
  {
    "text": "know let's say Apache an open sample they use XML parser underneath the hood",
    "start": "657320",
    "end": "662760"
  },
  {
    "text": "but they don't expose any way to configure it so then you're using these features",
    "start": "662760",
    "end": "669240"
  },
  {
    "text": "and you can secure them at all all right so what do we have left",
    "start": "669240",
    "end": "676680"
  },
  {
    "start": "673000",
    "end": "707000"
  },
  {
    "text": "you know you know at this point where we have some features that you can turn off and so you have to just at least try to",
    "start": "676680",
    "end": "683600"
  },
  {
    "text": "fix whatever code you own so with that you're trying to say what what what can",
    "start": "683600",
    "end": "688839"
  },
  {
    "text": "we we do we can disable external entities like you saw me try and you can",
    "start": "688839",
    "end": "694160"
  },
  {
    "text": "disable DTD support all together like a wasp recommends but that may not be what you want because you may need uh DTD so",
    "start": "694160",
    "end": "701480"
  },
  {
    "text": "then you can actually um try to turn off also duck type",
    "start": "701480",
    "end": "707079"
  },
  {
    "start": "707000",
    "end": "768000"
  },
  {
    "text": "fetching but the problem is not the mitigations the problem is the parsers",
    "start": "707320",
    "end": "712839"
  },
  {
    "text": "themselves one parser is not like the other there are a bunch of parsers that you can turn the uh uh features off and",
    "start": "712839",
    "end": "721320"
  },
  {
    "text": "that's cool and if they work they work and you can also try to set in resolver",
    "start": "721320",
    "end": "727160"
  },
  {
    "text": "like I did and failed and there are quite some some parel like that but there is one parel",
    "start": "727160",
    "end": "733959"
  },
  {
    "text": "that I like in particularly on Marshal doesn't support any",
    "start": "733959",
    "end": "739040"
  },
  {
    "text": "features so you can't set anything whatsoever so if you use it anywhere",
    "start": "739040",
    "end": "744440"
  },
  {
    "text": "you're pretty much using it at your own risk in order to fix on marshaler you",
    "start": "744440",
    "end": "750079"
  },
  {
    "text": "actually have to create yet another parser to parse your document and then",
    "start": "750079",
    "end": "757440"
  },
  {
    "text": "you have to turn off of course all the like external entity fetching and then you create a document you p uh pass the",
    "start": "757440",
    "end": "764399"
  },
  {
    "text": "document to a a marshal if everything fails you just",
    "start": "764399",
    "end": "771000"
  },
  {
    "start": "768000",
    "end": "795000"
  },
  {
    "text": "have to pick an XML parser that has a way to turn off protocol and disable",
    "start": "771000",
    "end": "777279"
  },
  {
    "text": "protocols all together so by using the set property XML constant access",
    "start": "777279",
    "end": "782760"
  },
  {
    "text": "external DTD and setting it to empty stream that means you're uh limiting the",
    "start": "782760",
    "end": "788079"
  },
  {
    "text": "white list of allowed protocols like HTTP FTP and there's a link of how to do it",
    "start": "788079",
    "end": "795760"
  },
  {
    "text": "but this is all cool we talked about a lot of you know server apps and using",
    "start": "795760",
    "end": "801360"
  },
  {
    "text": "XML you know not many apps use that we we kind of need a bigger",
    "start": "801360",
    "end": "807639"
  },
  {
    "text": "Target so with that I'm going to pass to my colleague shiron all right thanks",
    "start": "807760",
    "end": "814680"
  },
  {
    "text": "Sergey so uh if you can switch to my uh screen okay here we go thank",
    "start": "814680",
    "end": "820760"
  },
  {
    "text": "you okay like Serge said uh the the drava parts are complicated and they all",
    "start": "820760",
    "end": "827279"
  },
  {
    "text": "have different ways that that might work to support disable different things and we need a bigger Target and let me give",
    "start": "827279",
    "end": "833759"
  },
  {
    "text": "you another PCH of Steve bomber so what are we targeting",
    "start": "833759",
    "end": "839440"
  },
  {
    "start": "836000",
    "end": "880000"
  },
  {
    "text": "uh we talk about accesses but we talk about in the context of web applications we thought about the way as to explo it",
    "start": "839440",
    "end": "846639"
  },
  {
    "text": "as a using malous XML to attack a server in order to get the content of the",
    "start": "846639",
    "end": "851720"
  },
  {
    "text": "server out so say in the scenario you want to attack a server that works but",
    "start": "851720",
    "end": "856800"
  },
  {
    "text": "what about other cases what about you want to attack an individual user we want to attack billions of billions of",
    "start": "856800",
    "end": "862360"
  },
  {
    "text": "users we want to make the biggest impact to different vulnerable products and we",
    "start": "862360",
    "end": "868199"
  },
  {
    "text": "try to think about what are the products that are used by billions of billions of users that are parsing",
    "start": "868199",
    "end": "874560"
  },
  {
    "text": "xmls and the answer is not that complicated it's",
    "start": "874560",
    "end": "880360"
  },
  {
    "start": "880000",
    "end": "943000"
  },
  {
    "text": "browsers so we didn't go directly into exporting browsers we look into the history of browser based accesses if you",
    "start": "880360",
    "end": "887600"
  },
  {
    "text": "took at take a look at the screen uh chroma Firefox chroma Safari uh they",
    "start": "887600",
    "end": "893079"
  },
  {
    "text": "were vulnerable in before 2012 because they were using the vulnerable version of LAX too but that",
    "start": "893079",
    "end": "899720"
  },
  {
    "text": "was fixed on 2012 and and they're F afterwards same same same thing to",
    "start": "899720",
    "end": "904959"
  },
  {
    "text": "Firefox uh also used a different library but also fixed in the same year you can see the cve actually is pretty much Clos",
    "start": "904959",
    "end": "911680"
  },
  {
    "text": "so they're actually reporting on the same time IE on the other hand is a different Beast they actually fixed",
    "start": "911680",
    "end": "920360"
  },
  {
    "text": "fixed the parser in 2006 but their fig",
    "start": "920360",
    "end": "925600"
  },
  {
    "text": "is to coming up with a new parser without fixing the original one so the new parts is called V6 or version 6 and",
    "start": "925600",
    "end": "934480"
  },
  {
    "text": "the original version three is still vulnerable so our question is whether we can trigger the vulnerability somewhere",
    "start": "934480",
    "end": "941560"
  },
  {
    "text": "in version three so we checked out and version 3 is Lely linked with I6 so we figure ah",
    "start": "941560",
    "end": "949199"
  },
  {
    "start": "943000",
    "end": "966000"
  },
  {
    "text": "nobody's using I6 well we hope nobody's using I6 iwi have bigger problems and",
    "start": "949199",
    "end": "955199"
  },
  {
    "text": "how can we how can we explore the issue while we using new version of IES right",
    "start": "955199",
    "end": "960680"
  },
  {
    "text": "cuz we don't want just targeting I6 that's like treating targeting a dis disabled but we want to go with newer",
    "start": "960680",
    "end": "969000"
  },
  {
    "start": "966000",
    "end": "1031000"
  },
  {
    "text": "version like i1 where people are actually using so quirks mode I think",
    "start": "969000",
    "end": "974639"
  },
  {
    "text": "maybe a lot of you already heard of this corks mode is an interesting feature in IE that you can let the browser to run",
    "start": "974639",
    "end": "981600"
  },
  {
    "text": "in the older versions of the IE to maintain compatibility say you have a new website and uh it you have an old",
    "start": "981600",
    "end": "989120"
  },
  {
    "text": "website is not working with i1 or I 10 you wanted to work with ie7 I8 or even",
    "start": "989120",
    "end": "994240"
  },
  {
    "text": "I6 so IE give you this convenient feature to roll your browser back to 10",
    "start": "994240",
    "end": "1000199"
  },
  {
    "text": "years ago with the security of 10 years ago as well so you can attack her can",
    "start": "1000199",
    "end": "1007360"
  },
  {
    "text": "conveniently set the HTML page the M HTML page with a metax say going to Rand",
    "start": "1007360",
    "end": "1014199"
  },
  {
    "text": "content I6 or with other types of uh things like H through http response or",
    "start": "1014199",
    "end": "1019480"
  },
  {
    "text": "through a dock type many ways to can set the uh course mode but the point takeaway is that you can enforce IE to",
    "start": "1019480",
    "end": "1025720"
  },
  {
    "text": "force it to run in the mode that's was only used like 10 years ago the",
    "start": "1025720",
    "end": "1031360"
  },
  {
    "start": "1031000",
    "end": "1060000"
  },
  {
    "text": "vulnerable mode and we'll see the proof here you see through U process Explorer",
    "start": "1031360",
    "end": "1037959"
  },
  {
    "text": "uh msxml 3.0 right here uh on the screen it's link to i11 this is the most this",
    "start": "1037959",
    "end": "1045319"
  },
  {
    "text": "was the most recent version of i11 before they fixed it so that was interesting so obviously the",
    "start": "1045319",
    "end": "1052919"
  },
  {
    "text": "vulnerable version of MML 3 was linked to IE so there must be a way to exploit",
    "start": "1052919",
    "end": "1059280"
  },
  {
    "text": "it and before we go into the way uh very quick oneone how to parse XML in",
    "start": "1059280",
    "end": "1064640"
  },
  {
    "start": "1060000",
    "end": "1074000"
  },
  {
    "text": "JavaScript in ie6 it just created active a object and loaded in other browsers or",
    "start": "1064640",
    "end": "1070480"
  },
  {
    "text": "other version of IE you use a standard of Tom D parser so how do we exploit the",
    "start": "1070480",
    "end": "1077320"
  },
  {
    "start": "1074000",
    "end": "1096000"
  },
  {
    "text": "vulnerable version of M M XML 3 in the newer version of IE and our goal is to",
    "start": "1077320",
    "end": "1083080"
  },
  {
    "text": "do two things to break same orig policy completely where you can read content across domains and to exil trate data on",
    "start": "1083080",
    "end": "1091200"
  },
  {
    "text": "the disk and these are the two goals we want to achieve with xsc so very simple payload here's the",
    "start": "1091200",
    "end": "1098679"
  },
  {
    "start": "1096000",
    "end": "1124000"
  },
  {
    "text": "first trial we wanted to we were doing although it didn't work but kind of lead the way of the second one so if you see",
    "start": "1098679",
    "end": "1105200"
  },
  {
    "text": "the the one victim.com markting rat that's the we said we're going to act treate so very simple just point a",
    "start": "1105200",
    "end": "1112280"
  },
  {
    "text": "external entity to victim victim.com and a load the content of that page into",
    "start": "1112280",
    "end": "1118200"
  },
  {
    "text": "your into your mous page so let's see whether that works and why it didn't",
    "start": "1118200",
    "end": "1123600"
  },
  {
    "text": "works so I have a page right here uh let me zoom in it's basically",
    "start": "1123600",
    "end": "1129240"
  },
  {
    "start": "1124000",
    "end": "1215000"
  },
  {
    "text": "the same the same XML and we're just trying to exrate the data from",
    "start": "1129240",
    "end": "1134840"
  },
  {
    "text": "google.com while we are on attacker domain domain.com right so we're trying",
    "start": "1134840",
    "end": "1140440"
  },
  {
    "text": "to exrate data across different domains if if this succeed we break the same origin policy so whatever we exrate is",
    "start": "1140440",
    "end": "1148039"
  },
  {
    "text": "going to be in the box right here so we click pars pars",
    "start": "1148039",
    "end": "1154720"
  },
  {
    "text": "XML nothing happens so that was weird it's supposed to work right cuz msxml 3",
    "start": "1154720",
    "end": "1160120"
  },
  {
    "text": "was used to part this uh XML and should be vulnerable to access C but why it",
    "start": "1160120",
    "end": "1165919"
  },
  {
    "text": "didn't happen so let's try that again with the console open see whether it's an exception throw or anything Parts",
    "start": "1165919",
    "end": "1172440"
  },
  {
    "text": "again access is denied and it's denied on the line where we are trying to parse",
    "start": "1172440",
    "end": "1178559"
  },
  {
    "text": "the library using the load XML so that's interesting because we thought it should succeed because it's using the",
    "start": "1178559",
    "end": "1184039"
  },
  {
    "text": "vulnerable Library so why it didn't work let me show you another example of",
    "start": "1184039",
    "end": "1189200"
  },
  {
    "text": "exactly why it did not work this is the EXA exact same example",
    "start": "1189200",
    "end": "1196039"
  },
  {
    "text": "with the loot or the the target pointing to a document on the same origin so",
    "start": "1196039",
    "end": "1202200"
  },
  {
    "text": "remember we are on the origin of attacker.com we're also trying to exfiltrate the data on attacker.com",
    "start": "1202200",
    "end": "1208360"
  },
  {
    "text": "so once the CLI Compares we got a file out so you can probably already guess",
    "start": "1208360",
    "end": "1214280"
  },
  {
    "text": "what is going on the thing that's going on is same policy is blocking",
    "start": "1214280",
    "end": "1221200"
  },
  {
    "start": "1215000",
    "end": "1269000"
  },
  {
    "text": "us so uh how do we bypass same or policies well I already gave you a hint",
    "start": "1221200",
    "end": "1227039"
  },
  {
    "text": "although that's not the way we uh we uh work for us but we look at the cves in the past of how same foes bypassing IE",
    "start": "1227039",
    "end": "1235200"
  },
  {
    "text": "in Firefox in Chrome uh in different uh different engin of render of um of",
    "start": "1235200",
    "end": "1241000"
  },
  {
    "text": "rousers and SVG is one of them uh set time out is one of them time of check",
    "start": "1241000",
    "end": "1246280"
  },
  {
    "text": "time of use and the other one is redirects so I Market in red you",
    "start": "1246280",
    "end": "1251360"
  },
  {
    "text": "probably already know this works for us so how it works is basically is trying to go go to retrieve",
    "start": "1251360",
    "end": "1259080"
  },
  {
    "text": "content to the Target website but instead of going there directly we go to a redirector on the same origin to",
    "start": "1259080",
    "end": "1266159"
  },
  {
    "text": "redirect to the second origin so if you take a look at example here the only",
    "start": "1266159",
    "end": "1272000"
  },
  {
    "start": "1269000",
    "end": "1351000"
  },
  {
    "text": "thing that has changed is the website instead of going to victim.com directly",
    "start": "1272000",
    "end": "1277640"
  },
  {
    "text": "it's going to attacker.com with a redirector assuming the page is hosted also on attacker.com and yes we own that",
    "start": "1277640",
    "end": "1285120"
  },
  {
    "text": "domain so let's take a look at how we can actually use the example to exploit",
    "start": "1285120",
    "end": "1292080"
  },
  {
    "text": "things so we're going to show you two demos one is to read a secret Google doc",
    "start": "1292080",
    "end": "1298440"
  },
  {
    "text": "document um of a victim the outer wants to read arbitrary disc content of the",
    "start": "1298440",
    "end": "1303760"
  },
  {
    "text": "victim both of them do not need user interaction only thing user needs to do is to click on the link and he",
    "start": "1303760",
    "end": "1310200"
  },
  {
    "text": "compromised let's see how that is done so let me paint you a story let's",
    "start": "1310200",
    "end": "1317640"
  },
  {
    "text": "say the uh victim is a boss or manager in a company and he has a secret dock on",
    "start": "1317640",
    "end": "1323320"
  },
  {
    "text": "the Google Drive um showing the salaries of different employees Underneath Him",
    "start": "1323320",
    "end": "1328840"
  },
  {
    "text": "and the attacker uh on the left hand side in Chrome is a employee that's",
    "start": "1328840",
    "end": "1334440"
  },
  {
    "text": "trying to uh access the document if you can see that the access is",
    "start": "1334440",
    "end": "1339960"
  },
  {
    "text": "denied right so theer's goal is to act treat this document through just a link",
    "start": "1339960",
    "end": "1346840"
  },
  {
    "text": "so let's see how can do that and remember the victim is an ie so now the boss checks his email and",
    "start": "1346840",
    "end": "1355159"
  },
  {
    "start": "1351000",
    "end": "1363000"
  },
  {
    "text": "he got an email in the morning or in the afternoon says click me pretty good the boss like to click on links so just",
    "start": "1355159",
    "end": "1362200"
  },
  {
    "text": "clicking on the link go there everything's all right nothing can go wrong what can go wrong right and let's",
    "start": "1362200",
    "end": "1368559"
  },
  {
    "text": "refresh the page on the attacker site every single thing in your",
    "start": "1368559",
    "end": "1376600"
  },
  {
    "text": "document and I explain thank",
    "start": "1376600",
    "end": "1382400"
  },
  {
    "text": "you I explain how it happens in a slow motion afterwards but this is the first",
    "start": "1382400",
    "end": "1388080"
  },
  {
    "text": "demo just to exfiltrate content with a link click okay second demo same thing",
    "start": "1388080",
    "end": "1395880"
  },
  {
    "text": "uh the boss also have a habit of keeping um his username password all of a secret",
    "start": "1395880",
    "end": "1402159"
  },
  {
    "start": "1400000",
    "end": "1445000"
  },
  {
    "text": "information in a file txt file so that they can remember it he doesn't use last pass password manager whatever he",
    "start": "1402159",
    "end": "1408440"
  },
  {
    "text": "doesn't trust us this is pretty scure just put it in the txt file on its own drive and we're our goal is to get that",
    "start": "1408440",
    "end": "1416559"
  },
  {
    "text": "file just with a link click so remember the content a bunch of username password",
    "start": "1416559",
    "end": "1422240"
  },
  {
    "text": "of course those are not real you can try don't work but you see those are the",
    "start": "1422240",
    "end": "1428480"
  },
  {
    "text": "thing we're trying to exrate okay same thing the boss we come in the morning",
    "start": "1428480",
    "end": "1434720"
  },
  {
    "text": "and go to check his email got another link without realizing he was paed yesterday he clicked on the second link",
    "start": "1434720",
    "end": "1442480"
  },
  {
    "text": "and we'll see what happens afterwards this still going to Google nothing happens I don't think anything",
    "start": "1442480",
    "end": "1448159"
  },
  {
    "text": "happened but on the attacker side when he reloads the",
    "start": "1448159",
    "end": "1454240"
  },
  {
    "text": "page every single thing in that file is",
    "start": "1454559",
    "end": "1460399"
  },
  {
    "text": "exfiltrated so both of the tag was leveraging ecstasy and I will demo how",
    "start": "1463919",
    "end": "1470039"
  },
  {
    "text": "just one of them worked in a slow motion and if you go back to the page so this",
    "start": "1470039",
    "end": "1475679"
  },
  {
    "text": "is was basically just a just the page without all the fancy redirects and uh",
    "start": "1475679",
    "end": "1480720"
  },
  {
    "text": "flash going to go uh redirect to google.com everything just a stack page",
    "start": "1480720",
    "end": "1485799"
  },
  {
    "text": "and remember what attacker needs is just one thing the URL of the document say",
    "start": "1485799",
    "end": "1492480"
  },
  {
    "text": "the attacker knows the URL of the document and uh let's say the URL is",
    "start": "1492480",
    "end": "1498039"
  },
  {
    "text": "right here this is the Euro remember this is only a slow motion",
    "start": "1498039",
    "end": "1503799"
  },
  {
    "text": "and all of this can be just done automatically the the attacker doesn't have to ask users to type in a link or",
    "start": "1503799",
    "end": "1509000"
  },
  {
    "text": "anything just St in slow motion so now you have attacker has the link and the",
    "start": "1509000",
    "end": "1514399"
  },
  {
    "text": "victim collection of view and everything is still in Cross",
    "start": "1514399",
    "end": "1520360"
  },
  {
    "text": "domain if you take a look at the inspect element of the page there's only one",
    "start": "1520360",
    "end": "1526559"
  },
  {
    "text": "interesting line you want to look at actually two lines a lied",
    "start": "1526559",
    "end": "1533039"
  },
  {
    "text": "here first line created XML parer second line part XML done your opponent and",
    "start": "1533039",
    "end": "1540840"
  },
  {
    "text": "after that you just want to get the um get a Content out and the content is actually exfiltrated through a parse",
    "start": "1540840",
    "end": "1546000"
  },
  {
    "text": "error and explain what is a parse error and why we're not using just XML Dom later on but it's not that's not an",
    "start": "1546000",
    "end": "1552399"
  },
  {
    "text": "important detail so the important thing is that after just parsing the malicious",
    "start": "1552399",
    "end": "1557679"
  },
  {
    "text": "XML we can just successfully exfiltrate the external entities pointed by the XML",
    "start": "1557679",
    "end": "1563720"
  },
  {
    "text": "and send it to the Tacker CNC server and let's go back to the",
    "start": "1563720",
    "end": "1571440"
  },
  {
    "text": "slid so after seeing the demo uh we of course reported vulner reality to Microsoft and they fix it in the library",
    "start": "1573200",
    "end": "1580440"
  },
  {
    "text": "msxml 3.0 actually fix it not getting a V7 out actually fixing",
    "start": "1580440",
    "end": "1585919"
  },
  {
    "text": "V3 uh so but if you think about it it wasn't IE that was vulnerable IE",
    "start": "1585919",
    "end": "1591240"
  },
  {
    "text": "actually was trying to protect it from being vulnerable the library itself was",
    "start": "1591240",
    "end": "1596360"
  },
  {
    "text": "the vulnerable one and if you think about what are the other softwares or other Frameworks or",
    "start": "1596360",
    "end": "1603880"
  },
  {
    "text": "dlls or binaries exe that are using msxml 3.0 or link to it they were",
    "start": "1603880",
    "end": "1610399"
  },
  {
    "text": "vulnerable to or if they didn't have to patch they're still vulnerable but they definitely were vulnerable too and just",
    "start": "1610399",
    "end": "1615960"
  },
  {
    "text": "to give a hint of uh the scale of the problem Ms msxml 3 was introduced in",
    "start": "1615960",
    "end": "1622440"
  },
  {
    "text": "2001 exactly 15 years ago so I don't think it's a complicated exploit I'm",
    "start": "1622440",
    "end": "1628720"
  },
  {
    "text": "suspecting it's probably ready to be exploited in the wild but that's just a Bart guess if you take a look at what",
    "start": "1628720",
    "end": "1635600"
  },
  {
    "text": "are linked to msxml 3 directly we found just 46 binaries xmls out of the box",
    "start": "1635600",
    "end": "1643200"
  },
  {
    "text": "that are linked to msxml those are just linked directly in directly there are",
    "start": "1643200",
    "end": "1649159"
  },
  {
    "text": "187 binaries and DLS that are linked towards with msxml 3.0 and those are",
    "start": "1649159",
    "end": "1656200"
  },
  {
    "text": "those are just the libraries and XML and the binaries that are available by default on Windows God knows how many",
    "start": "1656200",
    "end": "1662559"
  },
  {
    "text": "third party libraries are link to msxml 3.0 that are still vulnerable so uh it's",
    "start": "1662559",
    "end": "1668679"
  },
  {
    "text": "a pretty big impact problem uh but good that Microsoft fix it and released a",
    "start": "1668679",
    "end": "1674000"
  },
  {
    "start": "1671000",
    "end": "1720000"
  },
  {
    "text": "Paton a pro so there are a few limitations about it about teack um one",
    "start": "1674000",
    "end": "1680120"
  },
  {
    "text": "is whenever you're trying to aate the content you uh the XML parts are assuming the external entity you're",
    "start": "1680120",
    "end": "1685760"
  },
  {
    "text": "trying to ex treat does not contain some special characters or only conform to",
    "start": "1685760",
    "end": "1690960"
  },
  {
    "text": "the XML uh grammars or rules and special characters would contain open close tax",
    "start": "1690960",
    "end": "1697320"
  },
  {
    "text": "percentage signs n bit or stff like that so what mean means in the web context that a lot of HML pages are not",
    "start": "1697320",
    "end": "1704360"
  },
  {
    "text": "vulnerable because they contain uh the open close tax or HTML tax anything but",
    "start": "1704360",
    "end": "1710200"
  },
  {
    "text": "wait a second I just show you I can actually you the Google Docs right because that's just HTML page definitely contains a bunch of um um tax that has",
    "start": "1710200",
    "end": "1718600"
  },
  {
    "text": "open close tax everything the first few hundred bites are not vulnerable are vulnerable",
    "start": "1718600",
    "end": "1723960"
  },
  {
    "start": "1720000",
    "end": "1748000"
  },
  {
    "text": "because they will come out of as a parse era so even though the page contains",
    "start": "1723960",
    "end": "1730640"
  },
  {
    "text": "open close taxs they trigger an error the parts error contains first 300 byes",
    "start": "1730640",
    "end": "1736200"
  },
  {
    "text": "which is enough to actually the Google Google do contents Google do name and a lot of websites content I think maybe",
    "start": "1736200",
    "end": "1743480"
  },
  {
    "text": "box was also vulnerable not box itself but the browser who's using box and Json",
    "start": "1743480",
    "end": "1749600"
  },
  {
    "text": "Pats are vulnerable because they do not mostly most of them do not contain open close tax they just contain the brazes",
    "start": "1749600",
    "end": "1756279"
  },
  {
    "text": "and stuff like that those are valid characters in XML and binary files are",
    "start": "1756279",
    "end": "1761760"
  },
  {
    "text": "usually not vulnerable because they usually contain no bites so things like registry files or or uh Outlook backup",
    "start": "1761760",
    "end": "1768760"
  },
  {
    "text": "files um or or even the browser cookie files those are uh binary files SQL like",
    "start": "1768760",
    "end": "1775600"
  },
  {
    "start": "1770000",
    "end": "1791000"
  },
  {
    "text": "databases something like that those are not uh vulnerable and interesting thing about I cookie files IE cookie files are",
    "start": "1775600",
    "end": "1782679"
  },
  {
    "text": "just plain text files however there's nice property that are there that we're not able to exploit the file name are",
    "start": "1782679",
    "end": "1789919"
  },
  {
    "text": "not guessable and in our attack we're not able to at least yet to enumerate",
    "start": "1789919",
    "end": "1795960"
  },
  {
    "start": "1791000",
    "end": "1808000"
  },
  {
    "text": "files on the file system only if you know the file name and path we can get a file out you can still enumerate manual",
    "start": "1795960",
    "end": "1802760"
  },
  {
    "text": "like brw forcing but there's no way you can just get direct listing automatically through xsy so because IE",
    "start": "1802760",
    "end": "1810399"
  },
  {
    "start": "1808000",
    "end": "1827000"
  },
  {
    "text": "randomized the file name of the cookie files we couldn't able to weren't able to actually treat the cookie files of IE",
    "start": "1810399",
    "end": "1816399"
  },
  {
    "text": "but other files that you know have deterministic path or file name you where you know the file you're going to ACC you have a targeted file you can",
    "start": "1816399",
    "end": "1823679"
  },
  {
    "text": "definitely leverage your vulnerability to completely extracted and it only the attack only works on IE",
    "start": "1823679",
    "end": "1830799"
  },
  {
    "start": "1827000",
    "end": "1840000"
  },
  {
    "text": "uh Windows 7 the below but all IE versions are vulnerable so Windows 8 and",
    "start": "1830799",
    "end": "1836440"
  },
  {
    "text": "up are not vulnerable at all but come on who's using Windows 8 and up so uh as a defenses update to the",
    "start": "1836440",
    "end": "1844799"
  },
  {
    "start": "1840000",
    "end": "1856000"
  },
  {
    "text": "most recent version of i11 or actually update the Sy apply the system security update because update to a library and",
    "start": "1844799",
    "end": "1852679"
  },
  {
    "text": "also use Windows 8 and up I guess so so",
    "start": "1852679",
    "end": "1858799"
  },
  {
    "start": "1856000",
    "end": "1906000"
  },
  {
    "text": "conclusions uh we have shown you the OD days in both Java and iie and it's a big",
    "start": "1858799",
    "end": "1864360"
  },
  {
    "text": "problem we we think it should deserve more more attention especially like Ser mentioned uh services like soap uh API",
    "start": "1864360",
    "end": "1872480"
  },
  {
    "text": "uh SEMO single sign on um and a lot of those are XML parsing and if you don't",
    "start": "1872480",
    "end": "1877639"
  },
  {
    "text": "deal with XML seriously they're going to ruin your servers your users your products and art language and product",
    "start": "1877639",
    "end": "1884799"
  },
  {
    "text": "could potentially be vulnerable too we didn't have the time to investigate into rubies or python or uh all the fancy new",
    "start": "1884799",
    "end": "1892440"
  },
  {
    "text": "languages so they might as well be vulnerable but we don't know and we also recommend XML parsers for the new",
    "start": "1892440",
    "end": "1899600"
  },
  {
    "text": "libraries to be secured by default with those dangerous functions and functionalities turned",
    "start": "1899600",
    "end": "1905880"
  },
  {
    "text": "off so we also want to say special thank you to a bunch of our colleagues uh especially Horas and Jonathan who spent",
    "start": "1905880",
    "end": "1912679"
  },
  {
    "start": "1906000",
    "end": "1924000"
  },
  {
    "text": "a lot of time on the uh research as well they did a killer talk yesterday on breaking SMB so if you didn't have a",
    "start": "1912679",
    "end": "1919200"
  },
  {
    "text": "chance to check it out check it out on their on the website they should have the um slice ready so that is all of the",
    "start": "1919200",
    "end": "1927159"
  },
  {
    "start": "1924000",
    "end": "2005000"
  },
  {
    "text": "content and want to thank you for your",
    "start": "1927159",
    "end": "1931080"
  },
  {
    "text": "attention and and please leave feedback if you enjoy the talk and we we love to hear your feedback and any questions",
    "start": "1936399",
    "end": "1943559"
  },
  {
    "text": "raise your hand or come talk to us afterwards uh your is all welcome thank",
    "start": "1943559",
    "end": "1950279"
  },
  {
    "text": "you there's a question oh yeah go ahead does this work there we go yeah it",
    "start": "1950279",
    "end": "1957960"
  },
  {
    "text": "worked hey great job guys um I just wondered on the msxml stuff if you had",
    "start": "1957960",
    "end": "1963480"
  },
  {
    "text": "tried the C dat wrapping trick or the out of band URL tricks in order to get",
    "start": "1963480",
    "end": "1968519"
  },
  {
    "text": "at um HTML special characters instead of using the exceptions good question good question so we tried both C that rapping",
    "start": "1968519",
    "end": "1975240"
  },
  {
    "text": "and also empar EX and uh what's the other one uh like the",
    "start": "1975240",
    "end": "1980880"
  },
  {
    "text": "the out of band attacks that where you embed the data in the that's yeah yeah we we try that too none of them",
    "start": "1980880",
    "end": "1986600"
  },
  {
    "text": "unfortunately none of them worked so yeah good question all right cool thank you",
    "start": "1986600",
    "end": "1993398"
  },
  {
    "text": "yeah anyone",
    "start": "1994320",
    "end": "1997679"
  },
  {
    "text": "else thank you all great thank you",
    "start": "2000120",
    "end": "2007919"
  }
]