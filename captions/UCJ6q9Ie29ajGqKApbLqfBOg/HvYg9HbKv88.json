[
  {
    "start": "0",
    "end": "96000"
  },
  {
    "text": "hello everyone and uh welcome to my talk uh final briefing of the day so uh hopefully everyone's still awake H",
    "start": "4640",
    "end": "11599"
  },
  {
    "text": "because we have some pretty exciting things uh I'll be sharing uh details about my research into a new attack",
    "start": "11599",
    "end": "18439"
  },
  {
    "text": "surface that affects active directory environments so we will be talking about some ad features some DNS and DHCP",
    "start": "18439",
    "end": "25240"
  },
  {
    "text": "features and we will understand how attackers can abuse those to do H some pretty interesting",
    "start": "25240",
    "end": "31640"
  },
  {
    "text": "things so the attack service that we're going to talk about today H has been",
    "start": "31640",
    "end": "36680"
  },
  {
    "text": "previously almost Untouched by the security community and is largely unknown and we will do a deep dive into",
    "start": "36680",
    "end": "44000"
  },
  {
    "text": "it today and understand exactly how it works we will be covering a series of",
    "start": "44000",
    "end": "49199"
  },
  {
    "text": "attacks that affects Microsoft DNS servers um and which enables unauthenticated attackers so attackers",
    "start": "49199",
    "end": "55760"
  },
  {
    "text": "without any credentials the only thing that they need is access to the network uh the attacks enable them to override",
    "start": "55760",
    "end": "62199"
  },
  {
    "text": "DNS records after talking about the attacks we will be covering some mitigations uh",
    "start": "62199",
    "end": "67640"
  },
  {
    "text": "to them to understand how Defenders can protect themselves against these H",
    "start": "67640",
    "end": "74479"
  },
  {
    "text": "risks um so a brief introduction my name is or David I'm a security researcher at",
    "start": "74479",
    "end": "80200"
  },
  {
    "text": "Akamai and my background is in red teaming and fret hunting and today I cover a wide variety of research Topics",
    "start": "80200",
    "end": "87040"
  },
  {
    "text": "in the Akamai security research team and this is this is my first time at blackhead so hopefully this goes well",
    "start": "87040",
    "end": "93840"
  },
  {
    "text": "and with that let's get started before I get into the research itself I want to talk a little bit about",
    "start": "93840",
    "end": "100520"
  },
  {
    "start": "96000",
    "end": "391000"
  },
  {
    "text": "the motivation behind it or why we chose to Target DNS so historically DNS has",
    "start": "100520",
    "end": "106280"
  },
  {
    "text": "being abused by attackers in a variety of different ways so we had for example DNS spoofing where attackers will H H",
    "start": "106280",
    "end": "114439"
  },
  {
    "text": "modify DNS records in order to redirect the communication of their victims we have DNS tunneling where attackers will",
    "start": "114439",
    "end": "121280"
  },
  {
    "text": "communicate over DNS in order to remain hidden and bypass firewalls we even have",
    "start": "121280",
    "end": "126680"
  },
  {
    "text": "DNS being used to amplify Doos attacks and I can go on and on but the point is",
    "start": "126680",
    "end": "131760"
  },
  {
    "text": "that DNS is everywhere it has a lot of features and attackers abuse them all",
    "start": "131760",
    "end": "137239"
  },
  {
    "text": "the time um and because of that I wanted to Target a specific DNS feature H that",
    "start": "137239",
    "end": "142920"
  },
  {
    "text": "I found interesting and I H and that did not receive a lot of attention before H",
    "start": "142920",
    "end": "149160"
  },
  {
    "text": "before that and that is DNS in active directory so what is that it turns out",
    "start": "149160",
    "end": "156160"
  },
  {
    "text": "that every active directory domain requires what is called an active directory integrated DNS zone or ADI DNS",
    "start": "156160",
    "end": "163280"
  },
  {
    "text": "Zone this is a DNS Zone that is used as part of the operation and management h",
    "start": "163280",
    "end": "168599"
  },
  {
    "text": "of the active directory domain among other things as we can see here it will also host all of the a DNS records for",
    "start": "168599",
    "end": "176599"
  },
  {
    "text": "the machines in the domain so here our domain have uh two machines DC 2022 and",
    "start": "176599",
    "end": "182120"
  },
  {
    "text": "dcp1 and we can see that both of them will have their uh DNS records now an",
    "start": "182120",
    "end": "187480"
  },
  {
    "text": "interesting point regarding those records H is that we do not need to manually create them H but rather",
    "start": "187480",
    "end": "194080"
  },
  {
    "text": "whenever we add a new machine to The Domain a DNS record would be added automatically this is implemented by",
    "start": "194080",
    "end": "200879"
  },
  {
    "text": "using a DNS feature called DNS Dynamic update what this feature H does is it",
    "start": "200879",
    "end": "206319"
  },
  {
    "text": "enables uh Network clients DNS clients to H update or create DNS records on the",
    "start": "206319",
    "end": "212879"
  },
  {
    "text": "server so in this example we can see a machine is sending a dynamic update to",
    "start": "212879",
    "end": "218040"
  },
  {
    "text": "the server to create a DNS record for the name pc. aa. test and we can see the",
    "start": "218040",
    "end": "223959"
  },
  {
    "text": "type and we can see the IP address upon receiving this request the DNS server will create the appropriate DNS record",
    "start": "223959",
    "end": "231239"
  },
  {
    "text": "and by using this feature Windows machines will create their own DNS records upon joining the domain and they",
    "start": "231239",
    "end": "236879"
  },
  {
    "text": "will also update them whenever their IP address changes uh now this can obviously be a",
    "start": "236879",
    "end": "244680"
  },
  {
    "text": "security risk because if anyone in the network can just access the DNS server",
    "start": "244680",
    "end": "249799"
  },
  {
    "text": "and create or modify DNS records H attackers are going to H be able to",
    "start": "249799",
    "end": "254959"
  },
  {
    "text": "break a lot of things H so we obviously want to avoid that and because of that we have an additional configuration",
    "start": "254959",
    "end": "261680"
  },
  {
    "text": "which is enabled by default on Microsoft DNS called secure Dynamic updates with",
    "start": "261680",
    "end": "267040"
  },
  {
    "text": "secure Dynamic updates we take the dynamic update uh the same Dynamic update process that we had before but",
    "start": "267040",
    "end": "273639"
  },
  {
    "text": "this time we're adding a layer of care Bros authentication so this is pretty cool if you're a keros nerd H we",
    "start": "273639",
    "end": "279680"
  },
  {
    "text": "actually send the keros ticket inside the DNS message that we send to the DNS",
    "start": "279680",
    "end": "284880"
  },
  {
    "text": "to the DNS server and the server will first validate the ticket it will authenticate the user and only then will",
    "start": "284880",
    "end": "291199"
  },
  {
    "text": "it parse the update request so this uh prevents just random clients in the",
    "start": "291199",
    "end": "296840"
  },
  {
    "text": "network that are not part of the domain from accessing the ADI DNS Zone and there's another interesting",
    "start": "296840",
    "end": "304000"
  },
  {
    "text": "thing about secur Dynamic updates and that is authorization so the second",
    "start": "304000",
    "end": "309039"
  },
  {
    "text": "thing that we want to make sure is that different clients in the network in the domain that are authenticated are not",
    "start": "309039",
    "end": "314960"
  },
  {
    "text": "able to override each other's records so what we have is that uh every DNS record",
    "start": "314960",
    "end": "320919"
  },
  {
    "text": "has its own ACL so um a list of different objects in the domain and",
    "start": "320919",
    "end": "326919"
  },
  {
    "text": "their permissions over the DNS record um and by default what we have is that",
    "start": "326919",
    "end": "332600"
  },
  {
    "text": "whenever a machine creates its own DNS record by sending a dynamic update it",
    "start": "332600",
    "end": "338199"
  },
  {
    "text": "will be granted ownership and permissions over the record so in the ACL that we see here we're looking at a",
    "start": "338199",
    "end": "345560"
  },
  {
    "text": "machine that is called PC the DNS record is called PC and we can see that the PC machine account uh has right permissions",
    "start": "345560",
    "end": "353759"
  },
  {
    "text": "over the record and again the idea is that another machine will not have permissions in order to modify This",
    "start": "353759",
    "end": "359160"
  },
  {
    "text": "Record another interesting note regarding secure Dynamic updates uh which will",
    "start": "359160",
    "end": "364680"
  },
  {
    "text": "come in handy later uh has to do with non-existing names so let's say that we",
    "start": "364680",
    "end": "370160"
  },
  {
    "text": "have a DNS name that is not already reg registered in the domain and we have a new machine that just joined the network",
    "start": "370160",
    "end": "377120"
  },
  {
    "text": "and it wants to create a DNS record for itself so in this case if the name doesn't exist every authenticated user",
    "start": "377120",
    "end": "384240"
  },
  {
    "text": "in the domain can create a its own DNS record so for a name that doesn't",
    "start": "384240",
    "end": "391560"
  },
  {
    "start": "391000",
    "end": "452000"
  },
  {
    "text": "exist H so this is DNS Dynamic updates and while looking at this feature we",
    "start": "391599",
    "end": "397039"
  },
  {
    "text": "came across an interesting DHCP feature um a quick recap DHCP is a network",
    "start": "397039",
    "end": "403000"
  },
  {
    "text": "protocol that enables Network clients to H join new networks and and receive",
    "start": "403000",
    "end": "408759"
  },
  {
    "text": "configuration so let's say I'm a network client I just joined a new network I",
    "start": "408759",
    "end": "413800"
  },
  {
    "text": "need to know certain things in order to be able to participate in network so first of all and most importantly I need",
    "start": "413800",
    "end": "419960"
  },
  {
    "text": "to know what IP address I can be using and it needs to be also unique to my machine and I need to know stuff like",
    "start": "419960",
    "end": "427000"
  },
  {
    "text": "what is the address of the router what is the address of the DNS server and all sorts of other networking configuration",
    "start": "427000",
    "end": "433680"
  },
  {
    "text": "what I can do is I can reach out to a DHCP server H which is a server that is aware of the network um and the DHCP",
    "start": "433680",
    "end": "441639"
  },
  {
    "text": "server will provide me the necessary configuration so an IP address uh would",
    "start": "441639",
    "end": "446879"
  },
  {
    "text": "be given to me that is unique to me H because because the DHCP server manages the addresses in the network and also",
    "start": "446879",
    "end": "453639"
  },
  {
    "start": "452000",
    "end": "653000"
  },
  {
    "text": "any any other additional configuration that I might need so this is DHCP and",
    "start": "453639",
    "end": "459479"
  },
  {
    "text": "now we'll be talking about DHCP DNS Dynamic updates so this is a DHCP",
    "start": "459479",
    "end": "464560"
  },
  {
    "text": "feature that enables the DHCP client to inform the DHCP server of its DNS name",
    "start": "464560",
    "end": "472360"
  },
  {
    "text": "or its fqdn and have the DHCP server create a DNS record for it so the idea",
    "start": "472360",
    "end": "478840"
  },
  {
    "text": "is that the CP server has just given a new IP address to this new host in the network and we want other clients in the",
    "start": "478840",
    "end": "485919"
  },
  {
    "text": "network to be able to access it so the DHCP server creates a DNS record let's",
    "start": "485919",
    "end": "491000"
  },
  {
    "text": "see how this process will look like so our PC contacts the DHCP server requests",
    "start": "491000",
    "end": "497000"
  },
  {
    "text": "an IP address while specifying its fqdn the DHCP server will give the client an",
    "start": "497000",
    "end": "503400"
  },
  {
    "text": "IP address and after doing that it will send a DNS update request to the DNS",
    "start": "503400",
    "end": "508520"
  },
  {
    "text": "server this is exactly the same DNS update request that we have previously discussed but this time instead of the",
    "start": "508520",
    "end": "514839"
  },
  {
    "text": "client sending the update the DHCP server is the one that sends it and as for the uh data we can see that a DNS",
    "start": "514839",
    "end": "522440"
  },
  {
    "text": "record will be created for the fqdn that was specified by the client and the IP",
    "start": "522440",
    "end": "528160"
  },
  {
    "text": "address that was given to the client by the DHCP server let's take a look at a quick demo",
    "start": "528160",
    "end": "535080"
  },
  {
    "text": "of how this looks like",
    "start": "535080",
    "end": "541440"
  },
  {
    "text": "so here we have a a DNS server oh you're not seeing",
    "start": "542480",
    "end": "548839"
  },
  {
    "text": "this some technical problems are always nice okay we got",
    "start": "555680",
    "end": "561320"
  },
  {
    "text": "it so here we have a DNS server which is also a DHCP server we can see that we",
    "start": "561320",
    "end": "567760"
  },
  {
    "text": "currently have only two DNS records inside our DNS",
    "start": "567760",
    "end": "572880"
  },
  {
    "text": "Zone and we now go to our DHCP console and here we can see that we have no DHCP",
    "start": "572880",
    "end": "579399"
  },
  {
    "text": "clients we now go to our second machine which is an a Cali Linux machine and",
    "start": "579399",
    "end": "585600"
  },
  {
    "text": "importantly H it is not authenticated to The Domain in any way so we do not have any credentials at this point H we're",
    "start": "585600",
    "end": "592800"
  },
  {
    "text": "going to be using a tool called DH client it's a Linux utility that enables us to send DHCP messages while",
    "start": "592800",
    "end": "599760"
  },
  {
    "text": "specifying custom parameters so we will be editing the configuration here and I",
    "start": "599760",
    "end": "605240"
  },
  {
    "text": "previously added the H fqdn option to the DHCP message to include the fqdn",
    "start": "605240",
    "end": "612120"
  },
  {
    "text": "cali. aa. test I'm also requesting a specific IP address this is something",
    "start": "612120",
    "end": "618040"
  },
  {
    "text": "that I can do I'm requesting an IP address ending with the uh with 66 so now we run DH client and we",
    "start": "618040",
    "end": "626720"
  },
  {
    "text": "contact the DHCP server and we h have just leased a new IP address we can see",
    "start": "626720",
    "end": "632160"
  },
  {
    "text": "that if we run if config we see that we got the IP address that we requested and if we now go to our ghcp",
    "start": "632160",
    "end": "639040"
  },
  {
    "text": "server we can verify that our list was successful and in the DNS",
    "start": "639040",
    "end": "644279"
  },
  {
    "text": "server we will see that we have successfully created the DNS record for the IP address that we",
    "start": "644279",
    "end": "651279"
  },
  {
    "start": "653000",
    "end": "740000"
  },
  {
    "text": "requested now let's understand a couple of interesting points regarding what we just saw so first of all this entire",
    "start": "653399",
    "end": "661440"
  },
  {
    "text": "process as I said before is entirely unauthenticated and if you recall I have",
    "start": "661440",
    "end": "666519"
  },
  {
    "text": "previously stated that when secure Dynamic updates are enabled which is the default you need to be authenticated to",
    "start": "666519",
    "end": "672040"
  },
  {
    "text": "The Domain in order to create DNS records but what we've just saw here is that we simply requested an IP address",
    "start": "672040",
    "end": "679160"
  },
  {
    "text": "from the DHCP server which is an action that any client in the network can do without authentication and what happened",
    "start": "679160",
    "end": "685160"
  },
  {
    "text": "was that the DHCP server did the authentication instead of us the DHCP server authenticated to the DNS server",
    "start": "685160",
    "end": "691639"
  },
  {
    "text": "and created the DNS record and we essentially bypassed this need for authentication the second interesting",
    "start": "691639",
    "end": "698040"
  },
  {
    "text": "point is that this feature H while it is not very commonly used today is enabled",
    "start": "698040",
    "end": "703880"
  },
  {
    "text": "by default on Microsoft DHCP and finally Microsoft DHCP is a very very popular",
    "start": "703880",
    "end": "710839"
  },
  {
    "text": "DHCP server H we knew that going into this research but we wanted to check exactly how so we used one of aami's",
    "start": "710839",
    "end": "718240"
  },
  {
    "text": "products called Artic or segmentation to map a DHCP communication across",
    "start": "718240",
    "end": "723959"
  },
  {
    "text": "thousands of networks that we Monitor and we were able to see that in 40% of the networks Microsoft DHCP was being",
    "start": "723959",
    "end": "731639"
  },
  {
    "text": "used so this attack is going to affect at this point it's not an attack it's an attack surface this attack surface is",
    "start": "731639",
    "end": "738120"
  },
  {
    "text": "going to affect a lot of organizations but what can we actually do with it so how can we turn this",
    "start": "738120",
    "end": "744120"
  },
  {
    "start": "740000",
    "end": "831000"
  },
  {
    "text": "attack surface into an attack so we know that we have the ability to create the",
    "start": "744120",
    "end": "749240"
  },
  {
    "text": "NS records without any authentication uh so sounds nice but H how can we actually",
    "start": "749240",
    "end": "755519"
  },
  {
    "text": "abuse this so to understand that I first want to take a look at two previous attacks that involve name resolution",
    "start": "755519",
    "end": "761920"
  },
  {
    "text": "lmnr spoofing and AD DNS spoofing with LMR spoofing we will have",
    "start": "761920",
    "end": "767720"
  },
  {
    "text": "our victim here attempting to connect to another machine in the network in this case called pc. aa. test H it needs to",
    "start": "767720",
    "end": "775839"
  },
  {
    "text": "know the IP address so it reaches out to the DNS server in our case the DNS server does not have",
    "start": "775839",
    "end": "781560"
  },
  {
    "text": "a record and so the victim will need to try something else what it will do is that it will send an LR multicast so",
    "start": "781560",
    "end": "788839"
  },
  {
    "text": "it's it will send a message to everyone else in the network and will ask them if they know what is the IP address of the",
    "start": "788839",
    "end": "795519"
  },
  {
    "text": "machine pc. aa. test now our very malicious attacker which sits inside the",
    "start": "795519",
    "end": "801600"
  },
  {
    "text": "same local network H will simply hear this request and respond to it saying",
    "start": "801600",
    "end": "806839"
  },
  {
    "text": "yes I am pc. aa. test here's my IP address and because lmnr is a very bad",
    "start": "806839",
    "end": "813160"
  },
  {
    "text": "protocol and it will not verify the response in any way H the victim will simply connect to the attacker without",
    "start": "813160",
    "end": "819760"
  },
  {
    "text": "asking any questions uh the classic way to abuse this uh this attack would be to",
    "start": "819760",
    "end": "825199"
  },
  {
    "text": "get the victim to authenticate to us via ntlm and then perform an nlm relay attack so lmnr spoofing has a one",
    "start": "825199",
    "end": "834920"
  },
  {
    "text": "interesting upside and one interesting downside so the upside is that it will not require any authentication we simply",
    "start": "834920",
    "end": "841920"
  },
  {
    "text": "need to be present in the network listen to LMR traffic and respond to it the",
    "start": "841920",
    "end": "847360"
  },
  {
    "text": "downside is that it will only work against targets that are in the same local network as us H this is because in",
    "start": "847360",
    "end": "854040"
  },
  {
    "text": "order to spoof the uh the responses to the ELR queries we need to be able to hear them so if there's another machine",
    "start": "854040",
    "end": "860920"
  },
  {
    "text": "in another Network in another subnet that attempts to resolve a name by using LMR we will simply not hear this query",
    "start": "860920",
    "end": "868160"
  },
  {
    "text": "and will not be able to spoof it the second attack H that I want to",
    "start": "868160",
    "end": "873759"
  },
  {
    "text": "discuss is called ADI DNS spoofing now here we're going to be abusing a fact that we previously mentioned and that is",
    "start": "873759",
    "end": "881360"
  },
  {
    "text": "that um for any DNS name that is currently not on the DNS server so",
    "start": "881360",
    "end": "887120"
  },
  {
    "text": "non-existing names any authenticated user can register their name for themselves so this time our attacker",
    "start": "887120",
    "end": "894920"
  },
  {
    "text": "will have some sort of weak domain credentials that they will be able to use use we will start exactly the same",
    "start": "894920",
    "end": "901560"
  },
  {
    "text": "way we will have a fatal name resolution leading to an LMR multicast but this time our attacker instead of responding",
    "start": "901560",
    "end": "908600"
  },
  {
    "text": "directly to the victim will go to the DNS server send the DNS update which is possible because they have some sort of",
    "start": "908600",
    "end": "915079"
  },
  {
    "text": "we credentials and will create a DNS record for the name that they want to spoof and their IP address now what we",
    "start": "915079",
    "end": "922839"
  },
  {
    "text": "have is that whenever any machine in the entire domain attempts to resolve this",
    "start": "922839",
    "end": "928000"
  },
  {
    "text": "name they will directed to our attacker machine so H unlike before we are no",
    "start": "928000",
    "end": "934360"
  },
  {
    "text": "longer limited to the H to the same uh two Targets in our same network and we",
    "start": "934360",
    "end": "939800"
  },
  {
    "text": "can Target every machine in the domain so this is the upside H but the downside",
    "start": "939800",
    "end": "945040"
  },
  {
    "text": "is that the attack does require authentication H because we need credentials to access the ADI DNS Zone H",
    "start": "945040",
    "end": "951959"
  },
  {
    "text": "so essentially it's a mirror image of the previous attack so with that in mind I now want",
    "start": "951959",
    "end": "957959"
  },
  {
    "start": "955000",
    "end": "1024000"
  },
  {
    "text": "to introduce a R new approach and that I call DD spoofing or DHCP DNS spoofing",
    "start": "957959",
    "end": "964160"
  },
  {
    "text": "and let's understand how it works so now we add the DHCP server into the mix we",
    "start": "964160",
    "end": "970759"
  },
  {
    "text": "start again exactly the same way but this time unlike with ADI DNS poofing we",
    "start": "970759",
    "end": "977079"
  },
  {
    "text": "cannot go to the DNS server because we don't have credentials instead what our attacker",
    "start": "977079",
    "end": "982720"
  },
  {
    "text": "can do is simply go to the DHCP server request an IP address while specifying",
    "start": "982720",
    "end": "988160"
  },
  {
    "text": "the fqdn that we are that we want to spoof and then as we know the dhtp server will create a DNS record for the",
    "start": "988160",
    "end": "996160"
  },
  {
    "text": "attacker so we get the same result as before where we are able to Target every",
    "start": "996160",
    "end": "1002199"
  },
  {
    "text": "um every client in the entire domain because our spoofing happens on the DNS server H but also we don't need any",
    "start": "1002199",
    "end": "1009319"
  },
  {
    "text": "credentials because we are simply leasing an IP address from the DHCP server now this attack is pretty cool H",
    "start": "1009319",
    "end": "1017240"
  },
  {
    "text": "and it could be useful in the hand of a capable attacker but we thought that we might be able to do something even",
    "start": "1017240",
    "end": "1023640"
  },
  {
    "text": "cooler so up until now the only thing that we did was create DNS records for",
    "start": "1023640",
    "end": "1029558"
  },
  {
    "text": "non-existing names what we wanted to try to do was to Target existing DNS records",
    "start": "1029559",
    "end": "1035678"
  },
  {
    "text": "of active machines and attempt to modify their IP addresses so to understand uh",
    "start": "1035679",
    "end": "1042360"
  },
  {
    "text": "if it might be possible we first wanted to understand what is supposed to mitigate this from happening so we",
    "start": "1042360",
    "end": "1048319"
  },
  {
    "text": "conducted little experiment we uh took an existing DNS record uh in this case the record for",
    "start": "1048319",
    "end": "1055360"
  },
  {
    "text": "the PC machine and we requested the same fqn from the DHCP server now what we",
    "start": "1055360",
    "end": "1062440"
  },
  {
    "text": "observed next was a pretty interesting Behavior the DHCP server will not verify the fud that we give it so it will not",
    "start": "1062440",
    "end": "1069200"
  },
  {
    "text": "check to see if there's already a DNS record for this name but instead it will immediately send a DNS update for any",
    "start": "1069200",
    "end": "1076679"
  },
  {
    "text": "fqn that we give it what we we saw next was that unfortunately or fortunately",
    "start": "1076679",
    "end": "1082320"
  },
  {
    "text": "depends or on your perspective the DNS server will refuse this update now this",
    "start": "1082320",
    "end": "1087679"
  },
  {
    "text": "happens because of the ACLS that we previously mentioned uh if we look at the DNS record of the PC machine we will",
    "start": "1087679",
    "end": "1095159"
  },
  {
    "text": "note that it is owned by the machine account of the PC and that is because the PC created its own record previously",
    "start": "1095159",
    "end": "1102679"
  },
  {
    "text": "H whereas when the DHCP server performs the update it will use its own machine",
    "start": "1102679",
    "end": "1107720"
  },
  {
    "text": "account to authenticate and because this machine account is not authorized to modify this record the",
    "start": "1107720",
    "end": "1113400"
  },
  {
    "text": "update fails so we now know two interesting and important things we know",
    "start": "1113400",
    "end": "1119720"
  },
  {
    "text": "that the DHCP server will send a DNS update for any name that we give it and",
    "start": "1119720",
    "end": "1124799"
  },
  {
    "text": "that the only thing that stops overrides from happening are the ACLS so if we're",
    "start": "1124799",
    "end": "1130440"
  },
  {
    "text": "going to find a way to overwrite records the problem would need to be in the ACLS so I would now like to um explain",
    "start": "1130440",
    "end": "1139039"
  },
  {
    "text": "to you about two types of ACLS that we might encounter H that have to do with two types of DNS records so these are",
    "start": "1139039",
    "end": "1146760"
  },
  {
    "start": "1142000",
    "end": "1243000"
  },
  {
    "text": "not actual Microsoft official terms but rather they are terms that I use to better explain this concept so don't",
    "start": "1146760",
    "end": "1153080"
  },
  {
    "text": "don't go and Google those um the first one is called client records these are",
    "start": "1153080",
    "end": "1158919"
  },
  {
    "text": "records that were created directly by Windows hosts without any dhtp server",
    "start": "1158919",
    "end": "1164600"
  },
  {
    "text": "involved um the second type is is called managed records these are records that",
    "start": "1164600",
    "end": "1169919"
  },
  {
    "text": "were created by a DHCP server on behalf of another client so they are therefore",
    "start": "1169919",
    "end": "1175840"
  },
  {
    "text": "managed by the DHCP server the main difference between these two types of Records regarding the ACLS will be the",
    "start": "1175840",
    "end": "1182880"
  },
  {
    "text": "record ownership so let's take a let's take a look here we have pc1 and PC2 pc1",
    "start": "1182880",
    "end": "1189760"
  },
  {
    "text": "will create a DNS record through the DHCP server now we will note that the machine that performs the updates is the",
    "start": "1189760",
    "end": "1197039"
  },
  {
    "text": "DHCP server and because of that the owner of the record will be the DHCP",
    "start": "1197039",
    "end": "1202280"
  },
  {
    "text": "server machine account whereas with PC2 because the machine sends its update",
    "start": "1202280",
    "end": "1207760"
  },
  {
    "text": "directly H the machine itself will be the owner so this is the difference uh",
    "start": "1207760",
    "end": "1213280"
  },
  {
    "text": "between these two types of Records the client and manage records and now that we understand that we can go into DD",
    "start": "1213280",
    "end": "1220039"
  },
  {
    "text": "override and DHCP DNS override the attack where an unauthenticated attacker",
    "start": "1220039",
    "end": "1226080"
  },
  {
    "text": "H the only requirement is access to the dhtp server will be able to overwrite DNS records inside the domain we've",
    "start": "1226080",
    "end": "1233440"
  },
  {
    "text": "identified three distinct cases where this is possible and we will now go over them from the least severe problem to",
    "start": "1233440",
    "end": "1239440"
  },
  {
    "text": "the very very very severe problem at the end the first attack H we call manage",
    "start": "1239440",
    "end": "1246159"
  },
  {
    "start": "1243000",
    "end": "1313000"
  },
  {
    "text": "record override so and manage records records that were created by the DHCP server let's go over some facts that we",
    "start": "1246159",
    "end": "1253400"
  },
  {
    "text": "know by now we know that the dhtp server doesn't verify the FN that we give it so",
    "start": "1253400",
    "end": "1258960"
  },
  {
    "text": "even if the fud is already registered the DNS server will send an update we",
    "start": "1258960",
    "end": "1265159"
  },
  {
    "text": "know that the D dhtp server owns its own manage records because well it created",
    "start": "1265159",
    "end": "1270520"
  },
  {
    "text": "them and we also know that the DHCP server will use its own machine account when performing updates now if we",
    "start": "1270520",
    "end": "1277520"
  },
  {
    "text": "combine all of these facts we get to the conclusion that we can make the DHCP server any of the DHCP any of the DNS",
    "start": "1277520",
    "end": "1284559"
  },
  {
    "text": "records that it previously created so this time we again have the M DNS record",
    "start": "1284559",
    "end": "1290600"
  },
  {
    "text": "for the PC machine but we can see that it was created by the DHCP server now",
    "start": "1290600",
    "end": "1295960"
  },
  {
    "text": "again we can request this fqdn from the DHCP server we know that the DHCP server will immediately send an update request",
    "start": "1295960",
    "end": "1302679"
  },
  {
    "text": "but this time because the machine account is authorized to perform the update the O the override would would",
    "start": "1302679",
    "end": "1308400"
  },
  {
    "text": "succeed and we can now control the IP address of this machine so this is",
    "start": "1308400",
    "end": "1313760"
  },
  {
    "start": "1313000",
    "end": "1372000"
  },
  {
    "text": "manage record overwrite and as for its impact well it turns out that it is pretty limited now it's not because the",
    "start": "1313760",
    "end": "1321400"
  },
  {
    "text": "attack would not work well it will work against every uh manage record that you will find but the problem is that they",
    "start": "1321400",
    "end": "1328480"
  },
  {
    "text": "are pretty hard to find uh by default modern Windows machines do not rely on",
    "start": "1328480",
    "end": "1334080"
  },
  {
    "text": "the DHCP server to create their own DNS records but rather they will use DNS",
    "start": "1334080",
    "end": "1339360"
  },
  {
    "text": "updates themselves um so they will have their client records um but in any case",
    "start": "1339360",
    "end": "1346039"
  },
  {
    "text": "where we might find them H we can override them so for example if we have non Windows clients and that do not",
    "start": "1346039",
    "end": "1352400"
  },
  {
    "text": "authenticate to The Domain and still use the DHCP server really really really old windows",
    "start": "1352400",
    "end": "1358520"
  },
  {
    "text": "machines that do not support the uh update or simply clients that disable the feature for some reason H the point",
    "start": "1358520",
    "end": "1365240"
  },
  {
    "text": "is if you manage to find a manag records congrats you can overwrite it but this",
    "start": "1365240",
    "end": "1370880"
  },
  {
    "text": "is still not cool enough what we want to do is to Target the uh normal Windows",
    "start": "1370880",
    "end": "1376799"
  },
  {
    "start": "1372000",
    "end": "1422000"
  },
  {
    "text": "the normal Windows machines in the domain we want to Target client records now the",
    "start": "1376799",
    "end": "1381880"
  },
  {
    "text": "problem with these is that each individual client record is owned by its own client and we as attackers are",
    "start": "1381880",
    "end": "1389120"
  },
  {
    "text": "limited to the machine account of the DHCP server when we perform updates so",
    "start": "1389120",
    "end": "1394159"
  },
  {
    "text": "we have a little problem here we try to think about uh certain edge cases or",
    "start": "1394159",
    "end": "1399880"
  },
  {
    "text": "interesting cases where we might be able to do something and eventually one thing came to",
    "start": "1399880",
    "end": "1405320"
  },
  {
    "text": "mind what about the DHCP server itself well the DHCP server is also a",
    "start": "1405320",
    "end": "1412320"
  },
  {
    "text": "normal Windows client and as every other windows client does it will create its",
    "start": "1412320",
    "end": "1418240"
  },
  {
    "text": "own DNS record see where I'm going with this we call this attack DHCP self",
    "start": "1418240",
    "end": "1424960"
  },
  {
    "start": "1422000",
    "end": "1505000"
  },
  {
    "text": "override so let's again go over some facts that we know the DCP Server",
    "start": "1424960",
    "end": "1430080"
  },
  {
    "text": "doesn't verify the requested fqdn even if it's its own",
    "start": "1430080",
    "end": "1435520"
  },
  {
    "text": "fqdn the DHCP server owns its own own DNS record because it created it and the",
    "start": "1435520",
    "end": "1442200"
  },
  {
    "text": "DCP server will use its machine account when performing updates combine these and we get to the conclusion that we can",
    "start": "1442200",
    "end": "1448120"
  },
  {
    "text": "make the DHCP server overwrite its own DNS record so it will look exactly the",
    "start": "1448120",
    "end": "1453559"
  },
  {
    "text": "same as before we have the DHCP server a record which is owned by the machine account and essentially we're coming to",
    "start": "1453559",
    "end": "1460400"
  },
  {
    "text": "the server and saying hello my name is your name please create a DNS record for",
    "start": "1460400",
    "end": "1465559"
  },
  {
    "text": "me and the dhtp server happily does that while inadvertedly overwriting its own",
    "start": "1465559",
    "end": "1470760"
  },
  {
    "text": "DNS record so with this attack what we can do is we can modify the IP address",
    "start": "1470760",
    "end": "1477760"
  },
  {
    "text": "of the DHCP server and for example make it point to our machine H which means",
    "start": "1477760",
    "end": "1483120"
  },
  {
    "text": "that we can intercept any communication that was destined for the DHCP server so if there's additional interesting",
    "start": "1483120",
    "end": "1489880"
  },
  {
    "text": "Services installed on the DHCP server we might get lucky um but while thinking",
    "start": "1489880",
    "end": "1495880"
  },
  {
    "text": "about additional services that might be coupled with DHCP servers H one thing",
    "start": "1495880",
    "end": "1502320"
  },
  {
    "text": "that came to mind was domain controllers so H domain controllers can",
    "start": "1502320",
    "end": "1507960"
  },
  {
    "start": "1505000",
    "end": "1602000"
  },
  {
    "text": "also have DHCP server installed on them and as it turns out the attack will work exactly the same way even if the DHCP",
    "start": "1507960",
    "end": "1515159"
  },
  {
    "text": "server is installed in domain controller and will be able to overwrite the DNS record of the DC and and this is",
    "start": "1515159",
    "end": "1522080"
  },
  {
    "text": "obviously a very significant capability because there's a lot of critical information going through the DC and but",
    "start": "1522080",
    "end": "1528919"
  },
  {
    "text": "as it turns out this is not even the most severe problem here so if we take a",
    "start": "1528919",
    "end": "1534120"
  },
  {
    "text": "look at any DNS record in the zone and go to the very very bottom of the ACL",
    "start": "1534120",
    "end": "1540080"
  },
  {
    "text": "the last line we will see the Enterprise domain controllers Group which is a group that consists of all of the",
    "start": "1540080",
    "end": "1546600"
  },
  {
    "text": "machine accounts of the uh domain controllers in the domain we will note that this group will have right",
    "start": "1546600",
    "end": "1553200"
  },
  {
    "text": "permissions over any DNS record in the domain now we know that when we perform",
    "start": "1553200",
    "end": "1561520"
  },
  {
    "text": "DNS updates through the DHCP server we are using the machine account of the DHCP server and if this machine account",
    "start": "1561520",
    "end": "1568399"
  },
  {
    "text": "is a domain controller we get to the conclusion that we can overwrite any DNS",
    "start": "1568399",
    "end": "1574039"
  },
  {
    "text": "record so H this variation I call the DC arbitrary override and it works exactly",
    "start": "1574039",
    "end": "1580200"
  },
  {
    "text": "the same way we have the DHCP server which is also a DC and now we can",
    "start": "1580200",
    "end": "1585320"
  },
  {
    "text": "specify any fqn that we want the the record should be owned by any machine account because we have this superpow",
    "start": "1585320",
    "end": "1592080"
  },
  {
    "text": "the DC machine account that performs the update we will be able to override any DNS record in the domain again without",
    "start": "1592080",
    "end": "1599559"
  },
  {
    "text": "any authentication required let's see a quick demo for this",
    "start": "1599559",
    "end": "1606398"
  },
  {
    "start": "1602000",
    "end": "1791000"
  },
  {
    "text": "attack so the attack that we're going to be uh performing we are going to be",
    "start": "1609520",
    "end": "1614799"
  },
  {
    "text": "abusing uh this DD override capability to per perform an nlm relay attack what",
    "start": "1614799",
    "end": "1620240"
  },
  {
    "text": "we're going to be trying to do is to get other clients in the network to authenticate to our attacker machine and",
    "start": "1620240",
    "end": "1627120"
  },
  {
    "text": "then use NM relay to relay the authentication attempt to another machine so we're going to be targeting",
    "start": "1627120",
    "end": "1634240"
  },
  {
    "text": "the DNS record of this file server here the idea is that it is a file server in",
    "start": "1634240",
    "end": "1640720"
  },
  {
    "text": "the network and a lot of clients are going to be attempting to connect to it and authenticate to it so what we want",
    "start": "1640720",
    "end": "1647200"
  },
  {
    "text": "to do is to check change the IP address of this record to our machine this if we take a look at the",
    "start": "1647200",
    "end": "1653640"
  },
  {
    "text": "record we will note that it is a normal client record we can see that it is H owned by the machine account of the",
    "start": "1653640",
    "end": "1659960"
  },
  {
    "text": "server the second machine that we have here called wi SRV is just a normal Windows machine that we're going to be",
    "start": "1659960",
    "end": "1666080"
  },
  {
    "text": "targeting with nlm",
    "start": "1666080",
    "end": "1669640"
  },
  {
    "text": "relay now we go to our unauthenticated attacker machine and we start by by",
    "start": "1671720",
    "end": "1677519"
  },
  {
    "text": "running and TM relay while targeting H wi SRV the machine that we previously H",
    "start": "1677519",
    "end": "1683200"
  },
  {
    "text": "saw and now the only thing that's left for us to do is to wait for any machine in the domain to authenticate to us now",
    "start": "1683200",
    "end": "1689760"
  },
  {
    "text": "we don't want to wait so we'll give them some help and we will use again D age",
    "start": "1689760",
    "end": "1695120"
  },
  {
    "text": "client the same utility that we used before but this time instead of cali.",
    "start": "1695120",
    "end": "1700279"
  },
  {
    "text": "aa. test we will provide the fqdn fil server. aa. test we will again be",
    "start": "1700279",
    "end": "1706159"
  },
  {
    "text": "requesting the IP address ending with with 66 and now H we run DH Client First to",
    "start": "1706159",
    "end": "1713080"
  },
  {
    "text": "release our previous configuration we run it again and that's it that's the only",
    "start": "1713080",
    "end": "1719840"
  },
  {
    "text": "thing that we need to do from the attacker perspective if we go back to our server we will see on the DHCP console",
    "start": "1719840",
    "end": "1727880"
  },
  {
    "text": "we can verify our list was successful and if we now hit Refresh on our DNS",
    "start": "1727880",
    "end": "1733360"
  },
  {
    "text": "server we will see that we were able to overwrite the IP address of the DNS record again I know I said it a lot but",
    "start": "1733360",
    "end": "1740480"
  },
  {
    "text": "without any authentication uh and why is this possible I think I forgot to mention in",
    "start": "1740480",
    "end": "1747440"
  },
  {
    "text": "this case the server is also a domain controller and if we take a look at the last line in the ACL that I've",
    "start": "1747440",
    "end": "1753159"
  },
  {
    "text": "previously discussed with you and we will note that the DC has permissions to modify the record now the only thing",
    "start": "1753159",
    "end": "1759960"
  },
  {
    "text": "that's left for us to do is to wait for any client to attempt to authenticate to the file server and to connect to it",
    "start": "1759960",
    "end": "1767120"
  },
  {
    "text": "well it looks like we failed but if we go uh to our attacker machine we will",
    "start": "1767120",
    "end": "1772240"
  },
  {
    "text": "see that we uh that ANTM relay was able to intercept this authentication attempt",
    "start": "1772240",
    "end": "1777799"
  },
  {
    "text": "to relay it to our attacker to our Target machine and to execute code on it and dumping its hashes in this",
    "start": "1777799",
    "end": "1785759"
  },
  {
    "text": "example now let's understand the potential impact of this attack and uh",
    "start": "1788360",
    "end": "1795919"
  },
  {
    "start": "1791000",
    "end": "1847000"
  },
  {
    "text": "so first of all uh okay okay I I'll say it one last time I promise this attack",
    "start": "1795919",
    "end": "1801320"
  },
  {
    "text": "Works without any authentication we're able to H Bridge into the domain and",
    "start": "1801320",
    "end": "1806840"
  },
  {
    "text": "pretty reliably H probably going to be able to use this to escalate privileges it will work with a default",
    "start": "1806840",
    "end": "1814039"
  },
  {
    "text": "configuration so nothing needs to be changed if we have a DHCP server installed on a DC this will work now you",
    "start": "1814039",
    "end": "1821600"
  },
  {
    "text": "might be asking yourself why would anyone install a dhp server on a DC um",
    "start": "1821600",
    "end": "1827360"
  },
  {
    "text": "well it turns out that it is a very very common thing We examined our data again",
    "start": "1827360",
    "end": "1833440"
  },
  {
    "text": "and we were able to see that in 57% of the cases where Microsoft dtp was being used we were able to see at least one",
    "start": "1833440",
    "end": "1840880"
  },
  {
    "text": "server installed on a Dom main controller so again H this is going to be relevant in a lot of",
    "start": "1840880",
    "end": "1847240"
  },
  {
    "start": "1847000",
    "end": "1900000"
  },
  {
    "text": "environments as for what can we do with this what can we do with this U arbitrary DNS override capability so we",
    "start": "1847240",
    "end": "1855000"
  },
  {
    "text": "can use it as we've just seen to relay a authentication uh we can use it to",
    "start": "1855000",
    "end": "1860919"
  },
  {
    "text": "capture sensitive information if we target specific servers that communicate in in Secure manner we can even do some",
    "start": "1860919",
    "end": "1868440"
  },
  {
    "text": "creative things like block access to other servers in the network by modifying their DNS server their DNS",
    "start": "1868440",
    "end": "1875200"
  },
  {
    "text": "records and really the sky is the limit here H there's a lot of capabilities and",
    "start": "1875200",
    "end": "1880799"
  },
  {
    "text": "things that an attacker can do with this capability now I've just talked about",
    "start": "1880799",
    "end": "1887639"
  },
  {
    "text": "some pretty depressing things if you're a defender or pretty exciting things if you're an attacker so I want to try to",
    "start": "1887639",
    "end": "1893919"
  },
  {
    "text": "give some hope to The Defenders here H by covering some of the mitigations that do exist for these",
    "start": "1893919",
    "end": "1900519"
  },
  {
    "start": "1900000",
    "end": "1932000"
  },
  {
    "text": "problems the first mitigation is called name protection name protection is a DHCP feature that is meant to prevent",
    "start": "1900519",
    "end": "1908200"
  },
  {
    "text": "different DHCP clients from overwriting each other's DNS records so if you",
    "start": "1908200",
    "end": "1913559"
  },
  {
    "text": "recall we have previously said that if one DHCP client requests a name from the DNS server from the DHCP server there's",
    "start": "1913559",
    "end": "1921559"
  },
  {
    "text": "nothing to stop another DHCP client from requesting the same name and have the DCP server overwrite it this is the",
    "start": "1921559",
    "end": "1928240"
  },
  {
    "text": "manage record overwrite attack that we previously described so what name",
    "start": "1928240",
    "end": "1933639"
  },
  {
    "text": "protection does in order to prevent this attack is that it will associate each",
    "start": "1933639",
    "end": "1939080"
  },
  {
    "text": "managed record with the original client that created it and now if I attempt to",
    "start": "1939080",
    "end": "1944120"
  },
  {
    "text": "overwrite a a DNS record that is owned by another client the DNS Ser the DHCP",
    "start": "1944120",
    "end": "1950120"
  },
  {
    "text": "server will not let me do that this is implemented by using a special DNS record of type DH",
    "start": "1950120",
    "end": "1958000"
  },
  {
    "text": "CID um we can see that uh when the when name protection is enabled along the",
    "start": "1958000",
    "end": "1963120"
  },
  {
    "text": "normal a DNS record we will have this dhci value which is a base 64 value and",
    "start": "1963120",
    "end": "1969519"
  },
  {
    "text": "this is a unique um identifier that is calculated per DHCP client so it's like",
    "start": "1969519",
    "end": "1976639"
  },
  {
    "text": "a fingerprint and every DHCP client should have a different DHC a",
    "start": "1976639",
    "end": "1982039"
  },
  {
    "text": "value so the attack the the mitigation Works uh by uh verifying this value so",
    "start": "1982039",
    "end": "1989559"
  },
  {
    "text": "in this case we have the PC record H which is protected by name protection and we can see that we have a DHC value",
    "start": "1989559",
    "end": "1997200"
  },
  {
    "text": "here and which was calculated for the original client that created the record now if our attacker attempts to",
    "start": "1997200",
    "end": "2004639"
  },
  {
    "text": "request the same name the DHCP server will first um calculate the attacker's DHC value",
    "start": "2004639",
    "end": "2011919"
  },
  {
    "text": "and append it to the DNS update request now as we can see because the attacker",
    "start": "2011919",
    "end": "2017120"
  },
  {
    "text": "machine is different from the original client that created the record uh the",
    "start": "2017120",
    "end": "2022519"
  },
  {
    "text": "DNS server will refuse the update because the DHC values does not",
    "start": "2022519",
    "end": "2028760"
  },
  {
    "text": "match so this is how name protection is implemented I've kind of described it in a high level H ER I I will publish today",
    "start": "2028760",
    "end": "2037159"
  },
  {
    "start": "2029000",
    "end": "2123000"
  },
  {
    "text": "a blog post that will contain a lot more information about this process um but",
    "start": "2037159",
    "end": "2042559"
  },
  {
    "text": "let's let's talk about some caveats to this feature so first it is only meant to protect managed records and the",
    "start": "2042559",
    "end": "2049919"
  },
  {
    "text": "entire mitigation is not relevant where when we're talking about client records so for example it will not stop the DC",
    "start": "2049919",
    "end": "2055800"
  },
  {
    "text": "override attack that we've H previously Des described and the second point which is",
    "start": "2055800",
    "end": "2061280"
  },
  {
    "text": "kind of depressing it turns out that it could be bypassed pretty easily again I didn't have time to go into it and to",
    "start": "2061280",
    "end": "2067720"
  },
  {
    "text": "today h but there's a pretty easy way to bypass uh this feature H so you cannot",
    "start": "2067720",
    "end": "2073760"
  },
  {
    "text": "rely on it to stop H Dem manage record override attack the second mitigation is much",
    "start": "2073760",
    "end": "2080839"
  },
  {
    "text": "simpler and much better H and it is called DNS credential DNS credential",
    "start": "2080839",
    "end": "2086200"
  },
  {
    "text": "enables us to specify an alternative user to be used by the DHCP server when",
    "start": "2086200",
    "end": "2092200"
  },
  {
    "text": "it performs its DNS updates so if you recall a lot of the problems that we had",
    "start": "2092200",
    "end": "2098000"
  },
  {
    "text": "before were due to the fact that the machine account of the DHCP server was too strong so what we can do is we can",
    "start": "2098000",
    "end": "2105359"
  },
  {
    "text": "use DNS credential to configure a weak domain user to be used for these updates",
    "start": "2105359",
    "end": "2110520"
  },
  {
    "text": "and then we prevent all h both the uh self overright and the DC overright",
    "start": "2110520",
    "end": "2116400"
  },
  {
    "text": "attacks that we've previously described H because the server will not have the strong credentials as",
    "start": "2116400",
    "end": "2123200"
  },
  {
    "start": "2123000",
    "end": "2238000"
  },
  {
    "text": "before the caveat for this uh feature H so it's it's not like a magic solution",
    "start": "2123200",
    "end": "2129280"
  },
  {
    "text": "you have to use a weak user if you use a domain admin for example you will still be able to overwrite any DNS record and",
    "start": "2129280",
    "end": "2136119"
  },
  {
    "text": "so I would not recommend that um and it is only meant to protect client records",
    "start": "2136119",
    "end": "2141880"
  },
  {
    "text": "it will not prevent attacks on DNS records that were created by the DHCP server and that is because the DHCP",
    "start": "2141880",
    "end": "2148480"
  },
  {
    "text": "server will still use the same DNS credential when it creates the DNS record and when it attempts to overwrite",
    "start": "2148480",
    "end": "2154200"
  },
  {
    "text": "it so it will not stop attacks against manage records",
    "start": "2154200",
    "end": "2159240"
  },
  {
    "text": "so um I will now like to summarize all of the attacks and the mitigations that we've talked about",
    "start": "2159240",
    "end": "2164720"
  },
  {
    "text": "today so DHCP DNS spoofing the attack where we will register non-existing DNS",
    "start": "2164720",
    "end": "2171440"
  },
  {
    "text": "records um in order to fool other clients to authenticate to our machine",
    "start": "2171440",
    "end": "2176720"
  },
  {
    "text": "this attack cannot really be mitigated that is because at the heart of the DHCP DNS Dynamic update feature is the fact",
    "start": "2176720",
    "end": "2184720"
  },
  {
    "text": "that unauthenticated clients can create DNS records so the only way to mitigate this attack",
    "start": "2184720",
    "end": "2190160"
  },
  {
    "text": "would be to disable the feature as for manage record override",
    "start": "2190160",
    "end": "2195440"
  },
  {
    "text": "and the attack where we will overwrite records that were created by the DHCP server H again it cannot really be",
    "start": "2195440",
    "end": "2202839"
  },
  {
    "text": "mitigated so name protection is supposed to uh stop this attack but it could be",
    "start": "2202839",
    "end": "2208400"
  },
  {
    "text": "bypassed so the only reliable way to avoid this attack is avoid manage",
    "start": "2208400",
    "end": "2213680"
  },
  {
    "text": "records uh so if you require them in one of the weird scenarios that I've described before so non- Windows",
    "start": "2213680",
    "end": "2220560"
  },
  {
    "text": "machines or stuff like that you should be using static DNS records instead as for the self override and the",
    "start": "2220560",
    "end": "2228119"
  },
  {
    "text": "DC override attacks H they are pretty easy to mitigate simply configure a weak",
    "start": "2228119",
    "end": "2233440"
  },
  {
    "text": "DNS credential for all of your DHCP servers and you should be good we've disclosed all this",
    "start": "2233440",
    "end": "2240119"
  },
  {
    "start": "2238000",
    "end": "2388000"
  },
  {
    "text": "information and all the attacks that we've just described to you today to Microsoft and their response was that",
    "start": "2240119",
    "end": "2246560"
  },
  {
    "text": "this is cool and uh everything uh is as expected Microsoft claims that uh all of",
    "start": "2246560",
    "end": "2252480"
  },
  {
    "text": "these uh things that we've just described are either by Design or not severe enough to receive a fix we tend",
    "start": "2252480",
    "end": "2259760"
  },
  {
    "text": "to disagree uh we believe that the attacks that we've described today could",
    "start": "2259760",
    "end": "2265200"
  },
  {
    "text": "affect a lot of organizations and they can enable attackers to do some pretty nasty things H and so we will be trying",
    "start": "2265200",
    "end": "2273000"
  },
  {
    "text": "to do our best to help uh both to protect networks and to raise awareness",
    "start": "2273000",
    "end": "2278280"
  },
  {
    "text": "for this problem and we will be doing that by releasing two tools so the first tool will be released today alongside",
    "start": "2278280",
    "end": "2284440"
  },
  {
    "text": "our blog post and it is called invoke DHCP checkup it's a partial tool that you can run it will scan your active",
    "start": "2284440",
    "end": "2290440"
  },
  {
    "text": "directory environment identify DHCP servers and and will identify any risky",
    "start": "2290440",
    "end": "2295480"
  },
  {
    "text": "configurations Now spoiler alert by default you are vulnerable H so if",
    "start": "2295480",
    "end": "2301200"
  },
  {
    "text": "you're using Microsoft DHCP it's probably a good idea to run this tool um it will be published later today as I",
    "start": "2301200",
    "end": "2307960"
  },
  {
    "text": "said before H the second tool that we plan to release in the future is called DD spoof",
    "start": "2307960",
    "end": "2314400"
  },
  {
    "text": "it is going to be a tool that will enable performing DHCP DNS attacks and",
    "start": "2314400",
    "end": "2319599"
  },
  {
    "text": "we hope that it can help uh security teams to check their networks for this",
    "start": "2319599",
    "end": "2325839"
  },
  {
    "text": "for these types of attacks so the key takeaways that I",
    "start": "2325839",
    "end": "2331800"
  },
  {
    "text": "would like you to take from this uh session uh dcpns Dynamic updates provide",
    "start": "2331800",
    "end": "2337160"
  },
  {
    "text": "a very significant and very interesting attack surface H so keep an eye on it h",
    "start": "2337160",
    "end": "2343319"
  },
  {
    "text": "you probably should not be using it so if you don't need it h please disable it",
    "start": "2343319",
    "end": "2349800"
  },
  {
    "text": "um but if you do need it there's some cases where it might be useful H try to avoid the risky configuration that we've",
    "start": "2349800",
    "end": "2356400"
  },
  {
    "text": "talked about H today before I finish H I would just like to say uh that we are going to",
    "start": "2356400",
    "end": "2363839"
  },
  {
    "text": "publish a lot of more details today I didn't have time to cover everything today so uh the blog would be published",
    "start": "2363839",
    "end": "2372400"
  },
  {
    "text": "soon on akamai's blog you can also find it on my Twitter um and that's it thank",
    "start": "2372400",
    "end": "2380119"
  },
  {
    "text": "you very much I will be available for questions here later thank you very [Applause]",
    "start": "2380119",
    "end": "2386440"
  },
  {
    "text": "[Music] much",
    "start": "2386440",
    "end": "2391000"
  }
]