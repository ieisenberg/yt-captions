[
  {
    "text": "welcome to black hat Windows 2K security held February 14th through the 15th 2001",
    "start": "18039",
    "end": "23800"
  },
  {
    "text": "in Las Vegas Nevada the following videotape was recorded live at the conference and produced by the sound of",
    "start": "23800",
    "end": "29560"
  },
  {
    "text": "knowledge Incorporated this is videotape number one technical track host-based intrusion",
    "start": "29560",
    "end": "36399"
  },
  {
    "text": "detection using w2k auditing",
    "start": "36399",
    "end": "40920"
  },
  {
    "text": "features is going to be Macy beron he is Chief technical officer of secure Labs",
    "start": "43399",
    "end": "48640"
  },
  {
    "text": "located in near Columbus Ohio one of my favorite States that's where my wife comes from so that' be an automatic",
    "start": "48640",
    "end": "55920"
  },
  {
    "text": "anyway uh his topic today is going to be homebased intrusion Det ction using Windows 2000 uh existing technology Macy",
    "start": "55920",
    "end": "67519"
  },
  {
    "text": "can everybody hear me okay",
    "start": "93439",
    "end": "101438"
  },
  {
    "text": "U my name is Macy beron and I'm the chief technology officer for secure labs",
    "start": "102119",
    "end": "107840"
  },
  {
    "text": "and secure Labs is an information security consulting company located in Ohio it's been in existence since",
    "start": "107840",
    "end": "114759"
  },
  {
    "text": "1998 and we primarily do uh security strategy project management management",
    "start": "114759",
    "end": "121000"
  },
  {
    "text": "consulting type things for small to mediumsized companies typically companies that are",
    "start": "121000",
    "end": "127079"
  },
  {
    "text": "under a billion dollar um the niche market that we've that we",
    "start": "127079",
    "end": "133239"
  },
  {
    "text": "found is really in the manufacturing industry my background is in uh Information Systems I've been in the",
    "start": "133239",
    "end": "139400"
  },
  {
    "text": "business for about 12 years um come up through the ranks from operations to programming my backgrounds",
    "start": "139400",
    "end": "145840"
  },
  {
    "text": "and applications and in The Last 5 Years security and Network",
    "start": "145840",
    "end": "151360"
  },
  {
    "text": "management want to thank uh Jeff Moss and and the black cat people for having",
    "start": "151360",
    "end": "156680"
  },
  {
    "text": "me out to Vegas I don't think there's a better place to have a security conference uh although I play Blackjack",
    "start": "156680",
    "end": "163840"
  },
  {
    "text": "and I've lost a little bit of money so I have to make up for that before I leave",
    "start": "163840",
    "end": "169480"
  },
  {
    "text": "we're going to talk about Windows 2000 auditing today and uh specifically as it",
    "start": "169480",
    "end": "174560"
  },
  {
    "text": "relates to intrusion detection um it's a uh it's a low cost",
    "start": "174560",
    "end": "180360"
  },
  {
    "text": "or no cost integrated way to get started with host Bas intrusion detection and uh",
    "start": "180360",
    "end": "186680"
  },
  {
    "text": "there's some fundamental points that I want to uh to make sure we get across in the",
    "start": "186680",
    "end": "193200"
  },
  {
    "text": "short 90 minute session that we have so let me get the presentation up here",
    "start": "193200",
    "end": "200680"
  },
  {
    "text": "going to talk first about the overview of what we're going to talk about",
    "start": "217319",
    "end": "222519"
  },
  {
    "text": "briefly we're going to talk about what is auditing and effective auditing move on to auditing strategy",
    "start": "222920",
    "end": "229760"
  },
  {
    "text": "and intrusion detection strategy we're not going to talk significantly about um intrusion detection but I do have a few",
    "start": "229760",
    "end": "236360"
  },
  {
    "text": "slides that talk about um what intrusion detection is and and as it relates to",
    "start": "236360",
    "end": "243640"
  },
  {
    "text": "Windows 2000 going to talk about auditing functionality in the event",
    "start": "243640",
    "end": "251000"
  },
  {
    "text": "logs audit policy and group policy types of",
    "start": "251519",
    "end": "257519"
  },
  {
    "text": "auditing utilities and tools that come basically with uh Windows 2000 or the",
    "start": "257519",
    "end": "263400"
  },
  {
    "text": "resource kit what to look for in the audit logs",
    "start": "263400",
    "end": "269840"
  },
  {
    "text": "and uh we'll take some questions at the end if you feel compelled to ask questions during the the session that's",
    "start": "270120",
    "end": "275800"
  },
  {
    "text": "great um I don't know everything there is to know about Windows 2000 security",
    "start": "275800",
    "end": "280919"
  },
  {
    "text": "um we may um we may find people in the audience that that uh have to help",
    "start": "280919",
    "end": "286600"
  },
  {
    "text": "answer some of the questions but we'll do our best briefly let's talk about some of",
    "start": "286600",
    "end": "292560"
  },
  {
    "text": "the features that uh Windows 2000 has uh has given us from a security",
    "start": "292560",
    "end": "300039"
  },
  {
    "text": "perspective just to overview we have active directory and active directory is",
    "start": "300039",
    "end": "305360"
  },
  {
    "text": "the core of the flexibility and scalability of the security features in Windows 2000 for that matter for all the",
    "start": "305360",
    "end": "312479"
  },
  {
    "text": "subsystems in 2000 it's a way to uh centrally manage and simplify all the",
    "start": "312479",
    "end": "318960"
  },
  {
    "text": "administrative uh uh tasks that need to be done in Windows 2000 we have Kerberos uh which has",
    "start": "318960",
    "end": "327120"
  },
  {
    "text": "replaced NT landman as the default Authentication protocol U within or across",
    "start": "327120",
    "end": "333280"
  },
  {
    "text": "domains um N Land man still exists there's backwards compatibility to",
    "start": "333280",
    "end": "338400"
  },
  {
    "text": "Windows NT uh but uh to do curb roach you have to have obviously two machines that are",
    "start": "338400",
    "end": "344000"
  },
  {
    "text": "Windows 2000 the encrypting file system pretty straightforward the ability to encrypt",
    "start": "344000",
    "end": "350240"
  },
  {
    "text": "your your data on your disc public key certificate manager um",
    "start": "350240",
    "end": "355919"
  },
  {
    "text": "Windows 2000 bases most of its security infrastructure on public keys and uh",
    "start": "355919",
    "end": "362120"
  },
  {
    "text": "it's it's makes significant use of certificates",
    "start": "362120",
    "end": "367360"
  },
  {
    "text": "for most of the security features that's a whole that's a whole other day or two worth of",
    "start": "367360",
    "end": "374120"
  },
  {
    "text": "discussion IP SEC um very simply the encryption of Ip packets over over",
    "start": "374120",
    "end": "380400"
  },
  {
    "text": "ethernet um again there's a session that's going to last all day today from another uh",
    "start": "380400",
    "end": "386680"
  },
  {
    "text": "speaker enhanced VPN technology um not much to say there enhanced access",
    "start": "386680",
    "end": "393919"
  },
  {
    "text": "control and enhanced auditing subsystem and that's what we're going to talk about",
    "start": "393919",
    "end": "399280"
  },
  {
    "text": "today there's a couple points that I want you to uh leave the session with",
    "start": "399280",
    "end": "404759"
  },
  {
    "text": "today and uh they're not necessarily related to the auditing subsystem but uh",
    "start": "404759",
    "end": "410479"
  },
  {
    "text": "the concepts are apply uh we we must understand what",
    "start": "410479",
    "end": "416120"
  },
  {
    "text": "happens on our systems we must understand the activity that that uh that goes on on our systems and one way",
    "start": "416120",
    "end": "422759"
  },
  {
    "text": "to do that is is through auditing uh I've been in a lot of companies where uh they don't even do",
    "start": "422759",
    "end": "429879"
  },
  {
    "text": "backups right the IT people don't back their data up I think auditing is a similar sin in it um you must you must",
    "start": "429879",
    "end": "438080"
  },
  {
    "text": "do auditing you must understand what your security policies are and uh understand what what's going on on your",
    "start": "438080",
    "end": "445759"
  },
  {
    "text": "systems the second thing that I want you to to go away with today today is uh we",
    "start": "445759",
    "end": "451120"
  },
  {
    "text": "need to make we need to make our uh decisions based on factual information and what I mean by that is",
    "start": "451120",
    "end": "457840"
  },
  {
    "text": "that I think generally there's a trend out there in the industry at least the companies that I've been to where",
    "start": "457840",
    "end": "463280"
  },
  {
    "text": "decisions get made and uh the information that the decision is based on is inaccurate or",
    "start": "463280",
    "end": "469560"
  },
  {
    "text": "incorrect I think that uh I could tell story after story about uh situations",
    "start": "469560",
    "end": "475720"
  },
  {
    "text": "where we've trying to make decisions on security issues or performance issues or what have you and we find out that",
    "start": "475720",
    "end": "481800"
  },
  {
    "text": "decisions that we made early on uh the information was not not",
    "start": "481800",
    "end": "487560"
  },
  {
    "text": "factual the third thing we walk away from hopefully is uh an understanding that the auditing subsystem in Windows",
    "start": "487560",
    "end": "494440"
  },
  {
    "text": "2000 can be used as a fundamental host Bas intrusion detection",
    "start": "494440",
    "end": "499759"
  },
  {
    "text": "system okay what is",
    "start": "499759",
    "end": "506720"
  },
  {
    "text": "auditing auditing tracks the activity of users and processes by recording selected types of events in the logs of",
    "start": "506720",
    "end": "512800"
  },
  {
    "text": "a server or workstation uh very simply put it tracks activity",
    "start": "512800",
    "end": "519039"
  },
  {
    "text": "okay uh we'll provide information required to spot attempted attacks to investigate what happened when an",
    "start": "519039",
    "end": "524880"
  },
  {
    "text": "incident occurred and to possibly provide evidence in support of an",
    "start": "524880",
    "end": "530480"
  },
  {
    "text": "investigation okay without auditing what can we expect we can expect that finding",
    "start": "532240",
    "end": "538519"
  },
  {
    "text": "security problems can be be difficult if not impossible if we don't understand the activity uh that's that's happening",
    "start": "538519",
    "end": "544560"
  },
  {
    "text": "on our systems on our servers uh we can't possibly understand if if there's a security",
    "start": "544560",
    "end": "551399"
  },
  {
    "text": "problem you cannot fix it if you don't know about it once again back to the one",
    "start": "551399",
    "end": "557760"
  },
  {
    "text": "of the three things that we need to leave here today with if you have to understand what's going on you have to have factual information and uh that",
    "start": "557760",
    "end": "566399"
  },
  {
    "text": "that that'll help you solve the problems that you have without auditing the system will remain",
    "start": "566399",
    "end": "572440"
  },
  {
    "text": "open or vulnerable to attack",
    "start": "572440",
    "end": "577959"
  },
  {
    "text": "forward what is an event we talked about auditing is the ability to track events",
    "start": "580120",
    "end": "585800"
  },
  {
    "text": "what is an event an event is any significant",
    "start": "585800",
    "end": "591079"
  },
  {
    "text": "occurrence in a system that requires notification example would be uh service",
    "start": "591079",
    "end": "596600"
  },
  {
    "text": "didn't start a driver didn't load Maybe information related to uh applications",
    "start": "596600",
    "end": "601760"
  },
  {
    "text": "loaded on the system whether it's virus scanning information or or just general",
    "start": "601760",
    "end": "607440"
  },
  {
    "text": "applications another example will be log on failures and uh that that relates",
    "start": "607440",
    "end": "612480"
  },
  {
    "text": "more to intrusion detection and and what we're going to be talking about",
    "start": "612480",
    "end": "617360"
  },
  {
    "text": "today real briefly again just a few overview slides here to get you in the mood what is intrusion detection the",
    "start": "619440",
    "end": "626480"
  },
  {
    "text": "ability to detect inappropriate incorrect or anomalous activity uh sounds very similar to what",
    "start": "626480",
    "end": "632200"
  },
  {
    "text": "auditing is right uh they are very similar we're tracking events and",
    "start": "632200",
    "end": "637760"
  },
  {
    "text": "auditing we're tracking um intrusions with intrusion detection but they're both basically looking at the activity",
    "start": "637760",
    "end": "645000"
  },
  {
    "text": "of the systems I found that Sans Institute is a",
    "start": "645000",
    "end": "650480"
  },
  {
    "text": "very good source for information on intrusion detection they got some great facts out there and a lot of information",
    "start": "650480",
    "end": "655880"
  },
  {
    "text": "thought I'd include the URL for you if you didn't already know about it",
    "start": "655880",
    "end": "661240"
  },
  {
    "text": "there's two types of uh intrusion detection first is host Bas intrusion detection which involves loading",
    "start": "664240",
    "end": "670880"
  },
  {
    "text": "software on the systems to be monitored a lot of time use uh agents software",
    "start": "670880",
    "end": "676160"
  },
  {
    "text": "agents pushed out to the servers and uses the log files to uh to do intrusion",
    "start": "676160",
    "end": "681519"
  },
  {
    "text": "detection we're going to be talking about host based intrusion detection with the subsystem so um we'll focus on",
    "start": "681519",
    "end": "689120"
  },
  {
    "text": "that that network-based intrusion detection monitors actual Network traffic or the packets Windows 2000 has",
    "start": "689120",
    "end": "696920"
  },
  {
    "text": "no uh methods of doing network based intrusion detection at this point in",
    "start": "696920",
    "end": "702600"
  },
  {
    "text": "time so once again the uh the auditing",
    "start": "702600",
    "end": "707680"
  },
  {
    "text": "subsystem can be thought of as a fundamental intrusion detection",
    "start": "707680",
    "end": "714240"
  },
  {
    "text": "system now these three blocks are very simple but it's it's a point that needs to be made uh an effective security",
    "start": "717279",
    "end": "724560"
  },
  {
    "text": "management strategy relies on the relationship between the infrastructure of your",
    "start": "724560",
    "end": "730680"
  },
  {
    "text": "systems and the security policy that exists the requirements of the security policy okay the security policy and",
    "start": "730680",
    "end": "738399"
  },
  {
    "text": "Associated controls must meet the overall objectives defined in the security policy and and in the business",
    "start": "738399",
    "end": "745160"
  },
  {
    "text": "plan for that matter okay without proper execution of",
    "start": "745160",
    "end": "750240"
  },
  {
    "text": "the security policy we've got nothing again without basing your decisions on factual information uh you won't be able",
    "start": "750240",
    "end": "757519"
  },
  {
    "text": "to implement a proper Security Management",
    "start": "757519",
    "end": "762160"
  },
  {
    "text": "strategy couple more overview slides here and then we'll be into some of the guts of",
    "start": "765279",
    "end": "771240"
  },
  {
    "text": "this uh this this diagram I was I ran across I think it's a Microsoft picture",
    "start": "771240",
    "end": "777519"
  },
  {
    "text": "actually but uh it depicts uh some uh the way the complexity of the",
    "start": "777519",
    "end": "786000"
  },
  {
    "text": "networks these days we have corporate networks that share private networks we have corporate networks with",
    "start": "786000",
    "end": "792680"
  },
  {
    "text": "web servers that are located at an ISP we have uh dialup we have corporate",
    "start": "792680",
    "end": "798440"
  },
  {
    "text": "networks with permanent connections to the internet we have we have the",
    "start": "798440",
    "end": "804600"
  },
  {
    "text": "uh we have the responsibility to secure this information these are just some of the entry points",
    "start": "804600",
    "end": "811360"
  },
  {
    "text": "that could exist into a network so how do we secure all that how do we audit information on all these",
    "start": "811360",
    "end": "819120"
  },
  {
    "text": "systems this is another Microsoft picture I hope they don't get upset with",
    "start": "821959",
    "end": "827040"
  },
  {
    "text": "me but basically uh this is real good high level stuff to to understand how we",
    "start": "827040",
    "end": "832160"
  },
  {
    "text": "come about to an a audit policy and a security strategy we need to take a look at our networks and we need to break",
    "start": "832160",
    "end": "838440"
  },
  {
    "text": "them up in the both physical and logical uh building blocks uh the reason we do that is",
    "start": "838440",
    "end": "845160"
  },
  {
    "text": "because each of these building blocks um potentially might have a separate security policy a separate audit policy",
    "start": "845160",
    "end": "854120"
  },
  {
    "text": "um a web server is different than an email server and it's different than an internal database server so I think it's",
    "start": "854120",
    "end": "861480"
  },
  {
    "text": "important to get in the frame of mind that we have to really decide how we're going to uh put our security PL",
    "start": "861480",
    "end": "871040"
  },
  {
    "text": "together using the building blocks um we have to take a look at in this",
    "start": "871480",
    "end": "878000"
  },
  {
    "text": "case we're looking at The Logical building block called administrative Authority and uh the only purpose for",
    "start": "878000",
    "end": "884199"
  },
  {
    "text": "this slide excuse me is to uh is to show that each of these areas these physical",
    "start": "884199",
    "end": "890880"
  },
  {
    "text": "and logical areas could have different strategies associated with",
    "start": "890880",
    "end": "897000"
  },
  {
    "text": "them okay let's talk about auditing",
    "start": "897000",
    "end": "904519"
  },
  {
    "text": "strategy why do we audit anybody know why we",
    "start": "904720",
    "end": "911040"
  },
  {
    "text": "audit money we just talked about it briefly we audit to uh understand system activity",
    "start": "911160",
    "end": "919959"
  },
  {
    "text": "we audit for security reasons we audit for intrusion detection reasons and there's a whole host of other reasons",
    "start": "919959",
    "end": "925120"
  },
  {
    "text": "that we do auditing you have to get yourself in the frame of mind that U Windows 2000 is",
    "start": "925120",
    "end": "931399"
  },
  {
    "text": "very complicated and the security subsystem is very complicated as well and uh you can't just go in and say I'm",
    "start": "931399",
    "end": "938319"
  },
  {
    "text": "going to turn auditing on right you have to understand why you're auditing what we're",
    "start": "938319",
    "end": "944160"
  },
  {
    "text": "doing do you need different policies for different systems uh we just spoke about this a little bit uh the different",
    "start": "944160",
    "end": "950839"
  },
  {
    "text": "building blocks different parts of your network May indeed need uh different",
    "start": "950839",
    "end": "956920"
  },
  {
    "text": "different policies you have firewalls you have email servers file servers print servers that type of thing they're",
    "start": "956920",
    "end": "963440"
  },
  {
    "text": "certainly going to need uh different policies for each systems who's responsible for log",
    "start": "963440",
    "end": "970639"
  },
  {
    "text": "collection and Analysis I who it is in most company I most companies that I've been in it's",
    "start": "970639",
    "end": "977440"
  },
  {
    "text": "the overworked administrator that tries to do this and never actually really gets it done right should it be somebody other",
    "start": "977440",
    "end": "984680"
  },
  {
    "text": "than the administrators",
    "start": "984680",
    "end": "987959"
  },
  {
    "text": "who should have access to the audit logs once again I can tell you what the general rule is but uh I'm not sure that",
    "start": "990279",
    "end": "997040"
  },
  {
    "text": "it's accurate the administrators typically have access to the audit logs and that's it but who who audits the",
    "start": "997040",
    "end": "1003399"
  },
  {
    "text": "administrator",
    "start": "1003399",
    "end": "1006040"
  },
  {
    "text": "activity is the loss of some audit information acceptable what do you guys think",
    "start": "1008880",
    "end": "1016639"
  },
  {
    "text": "what's that depends depends on",
    "start": "1022519",
    "end": "1027600"
  },
  {
    "text": "what okay anybody else yeah I think it depends on how it was lost if your data",
    "start": "1036799",
    "end": "1042079"
  },
  {
    "text": "collection service fail that's one thing but if someone went in there manually deleted logs then that's something",
    "start": "1042079",
    "end": "1048120"
  },
  {
    "text": "concerned about right anybody else generally speaking I would say this",
    "start": "1048120",
    "end": "1054640"
  },
  {
    "text": "is of course my opinion but uh uh it I I think it's unacceptable that we lose",
    "start": "1054640",
    "end": "1060080"
  },
  {
    "text": "information right I my background is in manufacturing and transactions and purchase orders and invoicing and that",
    "start": "1060080",
    "end": "1066400"
  },
  {
    "text": "type of thing and I don't know anybody that's happy when you lose invoices or you lose purchase orders our data as",
    "start": "1066400",
    "end": "1072679"
  },
  {
    "text": "Security Professionals is just as important to us if it's worth auditing",
    "start": "1072679",
    "end": "1077720"
  },
  {
    "text": "it's worth making sure that we we have all the the information uh saved and secured there",
    "start": "1077720",
    "end": "1084400"
  },
  {
    "text": "are times when certain systems that uh are low impact that we might not care",
    "start": "1084400",
    "end": "1089840"
  },
  {
    "text": "about the audit logs but again if it's worth auditing we should take good care of the",
    "start": "1089840",
    "end": "1096480"
  },
  {
    "text": "data who reviews the logs and how long should you keep them similar questions as before you know typically it's the",
    "start": "1097240",
    "end": "1103840"
  },
  {
    "text": "administrator who reviews them typically there is little or no policy place on",
    "start": "1103840",
    "end": "1109240"
  },
  {
    "text": "how long to keep the logs and I think we have to change all that what is the escalation procedure",
    "start": "1109240",
    "end": "1115600"
  },
  {
    "text": "should an intrusion be detected how many people have policies in place to review",
    "start": "1115600",
    "end": "1121559"
  },
  {
    "text": "the audit logs and know exactly your escalation procedure should an intrusion be detected raise your",
    "start": "1121559",
    "end": "1127960"
  },
  {
    "text": "hand one right two okay just a few of you I",
    "start": "1127960",
    "end": "1135280"
  },
  {
    "text": "think it's something that we need to work on as as security people and get some plans in place out there to",
    "start": "1135280",
    "end": "1140880"
  },
  {
    "text": "understand our activity on our systems does a discovery of certain events require immediate",
    "start": "1140880",
    "end": "1147159"
  },
  {
    "text": "action uh let's say there is an intrusion that's that's being detected",
    "start": "1147159",
    "end": "1152200"
  },
  {
    "text": "uh what happens next who do you call do audit logs need to be collected",
    "start": "1152200",
    "end": "1159240"
  },
  {
    "text": "and analyzed centrally I think today with the amount",
    "start": "1159240",
    "end": "1164799"
  },
  {
    "text": "of servers that exist in companies and and they're so spread out and they might even exist across Geographic locations",
    "start": "1164799",
    "end": "1172919"
  },
  {
    "text": "it's a must to collect the logs and have them analyzed centrally same concept as before if the data is important enough",
    "start": "1172919",
    "end": "1179120"
  },
  {
    "text": "to analyze and and audit it should be collected and looked at in in",
    "start": "1179120",
    "end": "1185440"
  },
  {
    "text": "total will the logs be used for legal action this could be another seminar and of itself um don't pretend to know",
    "start": "1186280",
    "end": "1192960"
  },
  {
    "text": "anything about the forensic side of this whole thing but uh if you need to prepare legal",
    "start": "1192960",
    "end": "1198960"
  },
  {
    "text": "um recourse with your audit logs then there's a little bit more work to do",
    "start": "1198960",
    "end": "1204120"
  },
  {
    "text": "than than just managing uh your average audit",
    "start": "1204120",
    "end": "1210440"
  },
  {
    "text": "logs effective",
    "start": "1211559",
    "end": "1215000"
  },
  {
    "text": "auditing auditing means different things to different people we've tried to identify what it means to us here today",
    "start": "1217559",
    "end": "1223159"
  },
  {
    "text": "it means connect collecting activity and uh logging users and processes and that",
    "start": "1223159",
    "end": "1229840"
  },
  {
    "text": "type of thing but uh there's really three areas that pretty much sum up",
    "start": "1229840",
    "end": "1235799"
  },
  {
    "text": "auditing and how to be effective at auditing first is vulnerability",
    "start": "1235799",
    "end": "1240840"
  },
  {
    "text": "management checking current configuration against a defined Baseline typically we do this to continually",
    "start": "1240840",
    "end": "1247039"
  },
  {
    "text": "improve the Baseline and to ensure best practices uh we have to understand what",
    "start": "1247039",
    "end": "1253200"
  },
  {
    "text": "our systems are vulnerable to second item is threat management",
    "start": "1253200",
    "end": "1258640"
  },
  {
    "text": "which is real-time detection of a threat or intrusion this allows for proactive steps to be taken to protect systems or",
    "start": "1258640",
    "end": "1266120"
  },
  {
    "text": "to protect specifically against a threat at hand the third thing is collection and",
    "start": "1266120",
    "end": "1273080"
  },
  {
    "text": "Analysis ability to reveal information related to use and abuse threat management and",
    "start": "1273080",
    "end": "1279360"
  },
  {
    "text": "vulnerability management together provide a method to both identify the threat and confirm its",
    "start": "1279360",
    "end": "1284440"
  },
  {
    "text": "vulnerability with uh vulnerability management and threat management together right say it one more time we",
    "start": "1284440",
    "end": "1291440"
  },
  {
    "text": "can understand how secure our systems are and prove uh a",
    "start": "1291440",
    "end": "1299039"
  },
  {
    "text": "vulnerability uh based on a specific threat any",
    "start": "1299039",
    "end": "1304240"
  },
  {
    "text": "threat is more serious if you know that your systems are vulnerable to that",
    "start": "1304240",
    "end": "1309640"
  },
  {
    "text": "threat right collection and Analysis uh",
    "start": "1309640",
    "end": "1315440"
  },
  {
    "text": "again got to do it you got to do it centrally I think and uh there's some",
    "start": "1315440",
    "end": "1321000"
  },
  {
    "text": "more information further in the presentation about how we do",
    "start": "1321000",
    "end": "1325600"
  },
  {
    "text": "that is there such a thing as too much auditing certainly certainly is there's",
    "start": "1327159",
    "end": "1333200"
  },
  {
    "text": "a direct correlation between the amount of auditing that happens on a system and how much uh it impacts performance on",
    "start": "1333200",
    "end": "1339080"
  },
  {
    "text": "the system it will eat the CPU uh a server Windows 2000 has the",
    "start": "1339080",
    "end": "1346720"
  },
  {
    "text": "ability to log an enormous amount of information information from an auditing perspective and another that's another",
    "start": "1346720",
    "end": "1352120"
  },
  {
    "text": "reason basically to uh understand what you're auditing too much auditing could",
    "start": "1352120",
    "end": "1357520"
  },
  {
    "text": "also hide significant events have you ever plowed through audit logs and you know got a headache after the first 30",
    "start": "1357520",
    "end": "1364039"
  },
  {
    "text": "minutes of looking at them because it's just stuff that just doesn't matter um definitely could hide",
    "start": "1364039",
    "end": "1370919"
  },
  {
    "text": "significant events if you have too much auditing turned on the first rule to remember in auditing is",
    "start": "1370919",
    "end": "1377240"
  },
  {
    "text": "restraint right you can't audit everything I think the General Security person wants to know about everything",
    "start": "1377240",
    "end": "1383120"
  },
  {
    "text": "and wants to log everything and we're going to log access to uh or log uh",
    "start": "1383120",
    "end": "1388600"
  },
  {
    "text": "successful events and failure events and we get crazy and we we end up with uh",
    "start": "1388600",
    "end": "1394679"
  },
  {
    "text": "with too much auditing too little auditing obviously",
    "start": "1394679",
    "end": "1400000"
  },
  {
    "text": "has the reverse effect uh it's not",
    "start": "1400000",
    "end": "1404760"
  },
  {
    "text": "effective if you don't log the record you can't track it and therefore you can't make decisions based on it and",
    "start": "1405039",
    "end": "1410520"
  },
  {
    "text": "we've got nothing so obviously the goal here is to get somewhere in the middle where we know what we're auditing we",
    "start": "1410520",
    "end": "1416240"
  },
  {
    "text": "know what we're looking for without having too much uh information that's",
    "start": "1416240",
    "end": "1421960"
  },
  {
    "text": "meaningless you want to keep it simple you know you heard of that keep it simple stupid uh very",
    "start": "1422200",
    "end": "1428679"
  },
  {
    "text": "effective in uh in auditing when you need to look through those logs to find something to detect an intrusion or to",
    "start": "1428679",
    "end": "1435520"
  },
  {
    "text": "maybe see uh what an attack has done to your system systems R trace it you're going to be thankful that you used",
    "start": "1435520",
    "end": "1441360"
  },
  {
    "text": "restraint when you came up with your audit policy okay Windows 2000 audit logs",
    "start": "1441360",
    "end": "1450799"
  },
  {
    "text": "um this is some just general information again there's three audit logs that exist on a Windows 2000 machine the",
    "start": "1450799",
    "end": "1458039"
  },
  {
    "text": "application log the system log and the security log these are just separate files that hold information related to",
    "start": "1458039",
    "end": "1465080"
  },
  {
    "text": "these three topics on domain controllers in Windows",
    "start": "1465080",
    "end": "1470279"
  },
  {
    "text": "2000 we have three additional logs directory service log file replication",
    "start": "1470279",
    "end": "1475880"
  },
  {
    "text": "and the DNS server log",
    "start": "1475880",
    "end": "1483000"
  },
  {
    "text": "okay excuse me inside the uh the logs we have uh categories first category is an",
    "start": "1483120",
    "end": "1491039"
  },
  {
    "text": "error an error can be lots of different things but generally speaking it's some type of loss of functionality data or",
    "start": "1491039",
    "end": "1498399"
  },
  {
    "text": "service failure something isn't working right on your computer an error can be in any of the",
    "start": "1498399",
    "end": "1504720"
  },
  {
    "text": "logs um the next is a warning which is a recoverable event not immediately urgent",
    "start": "1504720",
    "end": "1511880"
  },
  {
    "text": "but still something that needs to be taken into consideration third is information which",
    "start": "1511880",
    "end": "1519919"
  },
  {
    "text": "could be a successful operation uh could just be information regarding",
    "start": "1519919",
    "end": "1526120"
  },
  {
    "text": "U uh something that an applications doing successful load of a driver or",
    "start": "1526120",
    "end": "1531640"
  },
  {
    "text": "service maybe and then um most importantly to the topic of intrusion detection is a",
    "start": "1531640",
    "end": "1538360"
  },
  {
    "text": "successful audit and a failure audit okay so those are the five types of categories that exist inside the audit",
    "start": "1538360",
    "end": "1547080"
  },
  {
    "text": "logs audit log properties uh we got these six logs and",
    "start": "1549600",
    "end": "1555240"
  },
  {
    "text": "we have to have some way to manage them we're going to talk a little bit more about group policy in a little bit here",
    "start": "1555240",
    "end": "1561240"
  },
  {
    "text": "but Group Policy is new to Windows 2000 it allows you to centrally man manage",
    "start": "1561240",
    "end": "1567760"
  },
  {
    "text": "um configuration settings basically is the is the best way to say it it there",
    "start": "1567760",
    "end": "1573360"
  },
  {
    "text": "are lots of different Group Policy objects one of them is is used in",
    "start": "1573360",
    "end": "1579600"
  },
  {
    "text": "security group policiy is the recommended method to set audit log properties when I talk about audit log",
    "start": "1580000",
    "end": "1585240"
  },
  {
    "text": "properties I'm talking about um how long to keep the audit logs and whether or",
    "start": "1585240",
    "end": "1590360"
  },
  {
    "text": "not to overwrite them or not and how big the audit logs are in terms of size only",
    "start": "1590360",
    "end": "1596679"
  },
  {
    "text": "the application system and security log settings can be set via Group",
    "start": "1596679",
    "end": "1601720"
  },
  {
    "text": "Policy okay so the three domain controller specific logs cannot be uh",
    "start": "1601720",
    "end": "1608880"
  },
  {
    "text": "set some of the settings in in the log property that just mentioned uh they include override events as needed",
    "start": "1608880",
    "end": "1615760"
  },
  {
    "text": "override events older than x number of days and did not override events or",
    "start": "1615760",
    "end": "1621320"
  },
  {
    "text": "clear the log manually I guess continuing on",
    "start": "1621320",
    "end": "1626840"
  },
  {
    "text": "here uh generally speaking you should never automatically overwrite the audit",
    "start": "1626840",
    "end": "1632279"
  },
  {
    "text": "logs right goes back to the information or the point about um is is a loss of",
    "start": "1632279",
    "end": "1638960"
  },
  {
    "text": "audit information acceptable and the answer to that we said was no so we have to make some de decisions as we set the",
    "start": "1638960",
    "end": "1645960"
  },
  {
    "text": "auto log properties for these logs if the uh if the logs fill up let's talk",
    "start": "1645960",
    "end": "1652440"
  },
  {
    "text": "specifically about the security log if the security log fills up the system will stop auditing so you have control",
    "start": "1652440",
    "end": "1659159"
  },
  {
    "text": "over the size of the security log but at the same time you know you want to be reasonable about how big you fed it and",
    "start": "1659159",
    "end": "1665159"
  },
  {
    "text": "how much information you log to it so there's a couple decisions to make uh is it acceptable to have the system just",
    "start": "1665159",
    "end": "1671600"
  },
  {
    "text": "stop auditing again the answer to that is probably no we we want to make sure that",
    "start": "1671600",
    "end": "1677600"
  },
  {
    "text": "we capture all the information possible there is a way inside Windows",
    "start": "1677600",
    "end": "1683320"
  },
  {
    "text": "2000 to actually make the uh server stop operation to actually blue screen it's a",
    "start": "1683320",
    "end": "1688799"
  },
  {
    "text": "registry setting called crash on audit fail um this is only recommended in",
    "start": "1688799",
    "end": "1694640"
  },
  {
    "text": "extreme situations but you can actually have the Machine Stop so that uh all",
    "start": "1694640",
    "end": "1700200"
  },
  {
    "text": "activity halts so that you don't miss any information in the auts couple problems with this is that",
    "start": "1700200",
    "end": "1706159"
  },
  {
    "text": "it could result in a denial of service to the to the machine um it's it's",
    "start": "1706159",
    "end": "1712360"
  },
  {
    "text": "unforgiving I've seen it happen before just in test just in testing and it took a while to figure out how to get it back",
    "start": "1712360",
    "end": "1718480"
  },
  {
    "text": "up and running there's uh registry values that need to be reset an administrator has to sign on to the",
    "start": "1718480",
    "end": "1724840"
  },
  {
    "text": "machine and back up and clear the audit logs reset the registry value and we can go on but again only to be used in",
    "start": "1724840",
    "end": "1732159"
  },
  {
    "text": "extreme situations the proper way to uh set these properties are to set the log big",
    "start": "1732159",
    "end": "1738159"
  },
  {
    "text": "enough for uh um a day's worth or a week's worth of activity that's going to",
    "start": "1738159",
    "end": "1744760"
  },
  {
    "text": "be specific to each installation but um and then back the logs up on a regular",
    "start": "1744760",
    "end": "1751640"
  },
  {
    "text": "basis so you might set the audit logs up to use uh 5 or 10 megabytes and you know",
    "start": "1751640",
    "end": "1758760"
  },
  {
    "text": "that on a daily basis you don't even touch that so you back the audit logs up daily or weekly to compensate for the",
    "start": "1758760",
    "end": "1766159"
  },
  {
    "text": "the size okay Microsoft has recommendations on",
    "start": "1766159",
    "end": "1772159"
  },
  {
    "text": "audit log size I don't know if anybody's noticed but they have recommendations on a lot of",
    "start": "1772159",
    "end": "1778039"
  },
  {
    "text": "things um this is some pretty good information here to to go by generally",
    "start": "1778039",
    "end": "1783440"
  },
  {
    "text": "they say on a domain controller uh related to the security Log 5 to 10 megabytes is is the acceptable range now",
    "start": "1783440",
    "end": "1791240"
  },
  {
    "text": "these numbers are are just a guide because obviously it it depends on the activity on your system if you got one",
    "start": "1791240",
    "end": "1797159"
  },
  {
    "text": "user connected to your your domain controller you you're going to you're going to be okay with 5 to 10",
    "start": "1797159",
    "end": "1803760"
  },
  {
    "text": "Meg uh file and print server on the security log 2 to four database server 2",
    "start": "1803760",
    "end": "1809200"
  },
  {
    "text": "to four web server 2 to four on a Raz boox um they're talking 5 to 10 megabyte",
    "start": "1809200",
    "end": "1814799"
  },
  {
    "text": "does anybody know why why would it be 5 to 10",
    "start": "1814799",
    "end": "1823480"
  },
  {
    "text": "like yeah yeah basically your as boox is an entry point into your Network it needs to be um needs to be audited",
    "start": "1824279",
    "end": "1832679"
  },
  {
    "text": "effectively and they're they're basically saying that let's make the security log bigger there to to protect",
    "start": "1832679",
    "end": "1838519"
  },
  {
    "text": "ourselves you can see that on the system and application logs they recommend one to two megabyte uh depending on or IR",
    "start": "1838519",
    "end": "1846840"
  },
  {
    "text": "regardless of the server type that we have here yeah I mean these see kind of small in terms of",
    "start": "1846840",
    "end": "1853399"
  },
  {
    "text": "resources know's",
    "start": "1853399",
    "end": "1857399"
  },
  {
    "text": "the yeah it's a good question um these are just numbers to get started with uh it",
    "start": "1860159",
    "end": "1866760"
  },
  {
    "text": "takes a lot of logging information to fill up 10 megabytes right and again it's it's specific to your installation",
    "start": "1866760",
    "end": "1873760"
  },
  {
    "text": "if many users you have you got 10,000 users on your network and they're all authenticating to one domain controller",
    "start": "1873760",
    "end": "1880399"
  },
  {
    "text": "or a couple domain controllers and that number might not be big enough but um",
    "start": "1880399",
    "end": "1885600"
  },
  {
    "text": "just you know when you put up your first Windows 20 th000 server these are good numbers to start",
    "start": "1885600",
    "end": "1891760"
  },
  {
    "text": "with",
    "start": "1893240",
    "end": "1896240"
  },
  {
    "text": "Sy right right yeah we'll talk a little bit more about that in the end but that comes back to auditing what you need to",
    "start": "1901840",
    "end": "1907519"
  },
  {
    "text": "audit specifically okay the Event",
    "start": "1907519",
    "end": "1915320"
  },
  {
    "text": "Viewer uh this is a Microsoft management console snap-in that allows you to to review these these",
    "start": "1915320",
    "end": "1922200"
  },
  {
    "text": "logs um allows you to do exporting And archiving of the logs as well you can",
    "start": "1922200",
    "end": "1927840"
  },
  {
    "text": "apply filters to the view uh of the audit log allows you to configure the audit",
    "start": "1927840",
    "end": "1934559"
  },
  {
    "text": "log properties and you can save off and look at later uh event logs EVT format",
    "start": "1934559",
    "end": "1941919"
  },
  {
    "text": "is is the native event log format so uh The Event Viewer can open up logs that",
    "start": "1941919",
    "end": "1947399"
  },
  {
    "text": "you our from from before let's go ahe and take a look just",
    "start": "1947399",
    "end": "1953159"
  },
  {
    "text": "briefly at the Event",
    "start": "1953159",
    "end": "1956159"
  },
  {
    "text": "Viewer you can see it's an MMC snap in uh the logs are listed here on the left",
    "start": "1964360",
    "end": "1971120"
  },
  {
    "text": "hand side the six logs we talked about and this I am running Windows 2000 server here so there's the additional",
    "start": "1971120",
    "end": "1977440"
  },
  {
    "text": "three log logs um related to a domain controller as",
    "start": "1977440",
    "end": "1982720"
  },
  {
    "text": "well on the right hand side is is the audit log information you can see the type that we talked about error",
    "start": "1982720",
    "end": "1989080"
  },
  {
    "text": "information warning uh success and failure audits we have the date that the event",
    "start": "1989080",
    "end": "1995720"
  },
  {
    "text": "occurred the time the event occurred the source is um is basically the software",
    "start": "1995720",
    "end": "2003320"
  },
  {
    "text": "that loged the event it could be an internal Windows subsystem it could be a a separate piece of",
    "start": "2003320",
    "end": "2010440"
  },
  {
    "text": "software um it's just a way to classify the event category is a secondary level",
    "start": "2010440",
    "end": "2016960"
  },
  {
    "text": "of of classification um it's kind of it's not real meaningful inside the application",
    "start": "2016960",
    "end": "2022600"
  },
  {
    "text": "long but if we look at the security log real quick here you can see that the category is is a little more meaningful",
    "start": "2022600",
    "end": "2029000"
  },
  {
    "text": "log off log log on log off um event records privilege use records detailed",
    "start": "2029000",
    "end": "2034679"
  },
  {
    "text": "tracking records so again helps you further break down the uh the categories",
    "start": "2034679",
    "end": "2041240"
  },
  {
    "text": "of the event we have uh the event ID and uh that's probably one of the",
    "start": "2041240",
    "end": "2048520"
  },
  {
    "text": "most important pieces of information in in here that is uh that gets us back to",
    "start": "2048520",
    "end": "2053638"
  },
  {
    "text": "the description of the event and what the event really means we have the user and the computer",
    "start": "2053639",
    "end": "2059919"
  },
  {
    "text": "that the event happened on or or happened to as well we can double click",
    "start": "2059919",
    "end": "2066638"
  },
  {
    "text": "any of these events and bring up the uh",
    "start": "2066639",
    "end": "2071839"
  },
  {
    "text": "description this happens to be an IP SEC event and the reason I know that is because uh one of the ways to filter IP",
    "start": "2071839",
    "end": "2079720"
  },
  {
    "text": "SEC events is to look for this Oakley source which",
    "start": "2079720",
    "end": "2085919"
  },
  {
    "text": "uh I'm not sure exactly where where that came from somebody else might know but",
    "start": "2085919",
    "end": "2091638"
  },
  {
    "text": "uh we can look at the description here what's going on with this event event 54 2 the",
    "start": "2091639",
    "end": "2098839"
  },
  {
    "text": "IP security policy for oakle specified an encryption algorithm and is invalid due to export",
    "start": "2098839",
    "end": "2105480"
  },
  {
    "text": "cryptography Rec constrictions I'm not sure exactly what that really means we can",
    "start": "2105480",
    "end": "2112320"
  },
  {
    "text": "uh we can however roll through and filter out all the other Oakley events",
    "start": "2112320",
    "end": "2119079"
  },
  {
    "text": "let's do that real quick The Event Viewer here go to",
    "start": "2119079",
    "end": "2126640"
  },
  {
    "text": "properties",
    "start": "2126640",
    "end": "2129640"
  },
  {
    "text": "filter we can see all the events related to IP secc uh they're all 542 I would",
    "start": "2139359",
    "end": "2145839"
  },
  {
    "text": "anticipate that they're all exactly the same message that that I need to deal",
    "start": "2145839",
    "end": "2152240"
  },
  {
    "text": "with yeah pretty much all the same information so the filtering option is",
    "start": "2152240",
    "end": "2157839"
  },
  {
    "text": "uh pretty cool if you're drilling down into um the audit logs to to look for something specific otherwise uh we can",
    "start": "2157839",
    "end": "2165119"
  },
  {
    "text": "remove the filter and look at the entire log and chronological sequence we go back to properties go to",
    "start": "2165119",
    "end": "2172280"
  },
  {
    "text": "the filter Tab and restore defaults on the filter that'll take us back to looking at everything just to point out",
    "start": "2172280",
    "end": "2179200"
  },
  {
    "text": "a couple ways that you can filter we can look Just for information uh all events",
    "start": "2179200",
    "end": "2184680"
  },
  {
    "text": "we can look for warnings errors success or failure the CATE that we talked about before can pretty much filter on any of",
    "start": "2184680",
    "end": "2191520"
  },
  {
    "text": "the fields in the event log okay back to the general tab here",
    "start": "2191520",
    "end": "2198359"
  },
  {
    "text": "under audit log properties you can see that we have information about the audit log how big it is that type of thing uh",
    "start": "2198359",
    "end": "2204839"
  },
  {
    "text": "down here I have these audit Logs set at two Meg right now uh and I have them set",
    "start": "2204839",
    "end": "2210359"
  },
  {
    "text": "as override events as needed and I said generally speaking it's not the right thing to do and that's true uh but just",
    "start": "2210359",
    "end": "2217839"
  },
  {
    "text": "on this on this particular box for for the presentation I wanted to make sure that uh I didn't stop auditing and",
    "start": "2217839",
    "end": "2224680"
  },
  {
    "text": "collected enough audit information to to show during the presentation so I've lefted it override events as needed it's",
    "start": "2224680",
    "end": "2230839"
  },
  {
    "text": "not a production server uh so this is the simplest way to leave",
    "start": "2230839",
    "end": "2237400"
  },
  {
    "text": "it under the action menu we can export the uh the log if we do a save log file as it",
    "start": "2243319",
    "end": "2251599"
  },
  {
    "text": "will export this log file into either a EVT format comma delimited or Tab",
    "start": "2251599",
    "end": "2260200"
  },
  {
    "text": "delimited and again EVT is the Windows 2000 uh Native mode and it's the",
    "start": "2260200",
    "end": "2267560"
  },
  {
    "text": "recommended mode to Arch archive event logs however if you're going to take",
    "start": "2267560",
    "end": "2273160"
  },
  {
    "text": "this data to a centralized database such as a SQL server or something like that we could uh pump it out as a tab delimit",
    "start": "2273160",
    "end": "2281160"
  },
  {
    "text": "or common delimited file and import it into a SQL box for centralized management of that",
    "start": "2281160",
    "end": "2289200"
  },
  {
    "text": "data uh obviously from the action menu as well you could um clear the event",
    "start": "2289760",
    "end": "2297480"
  },
  {
    "text": "log and uh you can export the event log and export of the event log is similar",
    "start": "2297480",
    "end": "2303640"
  },
  {
    "text": "it's going to export uh basically U the information you see on the right hand",
    "start": "2303640",
    "end": "2309040"
  },
  {
    "text": "side and it will take into consideration the filters so you can ex you can uh export specific",
    "start": "2309040",
    "end": "2315960"
  },
  {
    "text": "events based on the filter properties any questions about the Event",
    "start": "2315960",
    "end": "2323119"
  },
  {
    "text": "Viewer yes",
    "start": "2325359",
    "end": "2329359"
  },
  {
    "text": "yeah yeah the question was does Microsoft still do Tech notes or or have more information related to these events",
    "start": "2340359",
    "end": "2348200"
  },
  {
    "text": "um there's a couple resources available to you that we'll talk about at the end the the resource kit has a help file and",
    "start": "2348200",
    "end": "2355200"
  },
  {
    "text": "there's actually an access database as well that I'll show you that has some further information as far as technotes",
    "start": "2355200",
    "end": "2361520"
  },
  {
    "text": "are you talking like on techet or msdn or something like that yeah yeah",
    "start": "2361520",
    "end": "2369359"
  },
  {
    "text": "yeah I know the knowledge base has um has information on specific events and I don't know if it has every event there's",
    "start": "2371240",
    "end": "2377560"
  },
  {
    "text": "there's thousands of them",
    "start": "2377560",
    "end": "2381319"
  },
  {
    "text": "but right yeah does anybody know that still",
    "start": "2385920",
    "end": "2393040"
  },
  {
    "text": "exists under 2000 Microsoft site do they have techn notes on every event anybody",
    "start": "2393040",
    "end": "2399440"
  },
  {
    "text": "know okay",
    "start": "2399440",
    "end": "2405960"
  },
  {
    "text": "yeah okay so the question is your your organization storing a lot of of information a lot of audit log",
    "start": "2423079",
    "end": "2429760"
  },
  {
    "text": "information and",
    "start": "2429760",
    "end": "2435160"
  },
  {
    "text": "terabytes right yeah it's pure it's pure dis space you know uh W that is that is a huge",
    "start": "2442200",
    "end": "2449680"
  },
  {
    "text": "amount of Auto data I've never even heard of that before it's amazing so how long do you",
    "start": "2449680",
    "end": "2454839"
  },
  {
    "text": "keep three years three years yeah wow wow it's just pure disc space",
    "start": "2454839",
    "end": "2462160"
  },
  {
    "text": "really at that point any other questions on the Event",
    "start": "2462160",
    "end": "2469280"
  },
  {
    "text": "Viewer okay back to the presentation",
    "start": "2470400",
    "end": "2474799"
  },
  {
    "text": "here event log",
    "start": "2478520",
    "end": "2482240"
  },
  {
    "text": "security access to the event logs is controlled to prevent authorized modification or",
    "start": "2483800",
    "end": "2490000"
  },
  {
    "text": "viewing there's four types of accounts that are used uh in relation to the",
    "start": "2490000",
    "end": "2495359"
  },
  {
    "text": "audit subsystem first is a local system account it's a specialized account that",
    "start": "2495359",
    "end": "2500520"
  },
  {
    "text": "that allows logging to the security log the administrator account which we're all familiar with server operator and",
    "start": "2500520",
    "end": "2507440"
  },
  {
    "text": "the everyone account um specifically for each log",
    "start": "2507440",
    "end": "2515400"
  },
  {
    "text": "this is the application log you can see the the permissions here the local system can read right and clear as well",
    "start": "2515400",
    "end": "2521000"
  },
  {
    "text": "as the administrator and server operator and everyone can read and write this is the general log that you would use um if",
    "start": "2521000",
    "end": "2528480"
  },
  {
    "text": "you were a developer that you were going to use the uh Windows 2000",
    "start": "2528480",
    "end": "2533520"
  },
  {
    "text": "auditing um in your application you would write to the application log this is where General application messages",
    "start": "2533520",
    "end": "2540319"
  },
  {
    "text": "will go the security log um you can see that the local system account is the only",
    "start": "2540319",
    "end": "2547200"
  },
  {
    "text": "account that can write to the security log the administrator has read and clear",
    "start": "2547200",
    "end": "2553160"
  },
  {
    "text": "and uh everyone has nothing the system log uh read WR and",
    "start": "2553160",
    "end": "2560920"
  },
  {
    "text": "clear for a local system and an administrator server operator can read and clear everyone can read just general",
    "start": "2560920",
    "end": "2567720"
  },
  {
    "text": "information there for you um I already mentioned this but only",
    "start": "2567720",
    "end": "2574400"
  },
  {
    "text": "the local system account can write to the security log on domain",
    "start": "2574400",
    "end": "2579920"
  },
  {
    "text": "controllers these permissions extend to the additional three",
    "start": "2579920",
    "end": "2584839"
  },
  {
    "text": "logs administrators can only manage the security log if they have the proper",
    "start": "2586839",
    "end": "2593280"
  },
  {
    "text": "Privileges and there are registry keys this is just one example there are a few other registry keys that can be set to",
    "start": "2594280",
    "end": "2600240"
  },
  {
    "text": "further prevent uh access to the security logs restrict G guest access",
    "start": "2600240",
    "end": "2606280"
  },
  {
    "text": "set to a one will prevent everyone from looking at some of the law at the",
    "start": "2606280",
    "end": "2612839"
  },
  {
    "text": "system that's a policy setting okay okay thanks didn't know",
    "start": "2612839",
    "end": "2621960"
  },
  {
    "text": "that configuring audit policy it's really a two-stage process",
    "start": "2623640",
    "end": "2630480"
  },
  {
    "text": "um real straightforward we need to define the high level audit policy what events are we going to audit are we",
    "start": "2630480",
    "end": "2636880"
  },
  {
    "text": "going audit log on events log off events account management events uh are we",
    "start": "2636880",
    "end": "2643040"
  },
  {
    "text": "looking to to just monitor for specific file access or what have you the second",
    "start": "2643040",
    "end": "2649000"
  },
  {
    "text": "piece of this is what objects are we going to capture these events on so",
    "start": "2649000",
    "end": "2654480"
  },
  {
    "text": "again goes back to understanding what what your security policy states and uh",
    "start": "2654480",
    "end": "2660599"
  },
  {
    "text": "implementing it what's important to audit no audit policy is turned on by",
    "start": "2660599",
    "end": "2667599"
  },
  {
    "text": "default in Windows 2000 you must enable it",
    "start": "2667599",
    "end": "2672880"
  },
  {
    "text": "uh when you",
    "start": "2672880",
    "end": "2676200"
  },
  {
    "text": "install the event categories that you can uh audit for include audit account",
    "start": "2679559",
    "end": "2685839"
  },
  {
    "text": "log on events this will record the success or failure of a user to authenticate to the local computer these",
    "start": "2685839",
    "end": "2692000"
  },
  {
    "text": "are important there's a new account uh there's a new account category which is",
    "start": "2692000",
    "end": "2698040"
  },
  {
    "text": "event account excuse me audit account management uh this audits creation",
    "start": "2698040",
    "end": "2703760"
  },
  {
    "text": "modification or deletion of user accounts so this would be an an event that you would monitor if you were",
    "start": "2703760",
    "end": "2709839"
  },
  {
    "text": "looking at or monitoring the",
    "start": "2709839",
    "end": "2713800"
  },
  {
    "text": "administrator we have audit directory service access administrators can can",
    "start": "2717760",
    "end": "2723000"
  },
  {
    "text": "monitor uh the active directory basically on Windows 2000 using this event category it's only available on",
    "start": "2723000",
    "end": "2729000"
  },
  {
    "text": "domain controllers audit log on events recorded success or failure of a user to",
    "start": "2729000",
    "end": "2735200"
  },
  {
    "text": "interactively log on to the local computer audit object access records the",
    "start": "2735200",
    "end": "2741400"
  },
  {
    "text": "successful or failed attempts to access a specific object such as a directory file or printers this this is the area",
    "start": "2741400",
    "end": "2749040"
  },
  {
    "text": "that can get really um can really chew CPU up if you're if you're going to",
    "start": "2749040",
    "end": "2754119"
  },
  {
    "text": "start to do object auditing on a lot of f and directories that type of thing it's going to fill the audit logs",
    "start": "2754119",
    "end": "2761760"
  },
  {
    "text": "up audit policy change uh again another great uh category to to monitor the",
    "start": "2763040",
    "end": "2771319"
  },
  {
    "text": "administrator activity this records any successful or failed attempts to make high level changes to security",
    "start": "2771319",
    "end": "2777800"
  },
  {
    "text": "policy including privilege assignments and audit policy",
    "start": "2777800",
    "end": "2783000"
  },
  {
    "text": "changes audit privilege use records all successful and failed attempts to use a",
    "start": "2783000",
    "end": "2789880"
  },
  {
    "text": "privilege audit process tracking again another category that can fill up the audit logs but uh this is some good",
    "start": "2791960",
    "end": "2798760"
  },
  {
    "text": "information depending on what you're looking for provide detailed tracking information for events such as process",
    "start": "2798760",
    "end": "2805200"
  },
  {
    "text": "activation handle dupes indirect object access and exits from processes if you",
    "start": "2805200",
    "end": "2810240"
  },
  {
    "text": "think about how this information could be useful we could write a uh",
    "start": "2810240",
    "end": "2816960"
  },
  {
    "text": "a report let's say we're collecting our data in SQL Server we could write a report to show from the audit logs all",
    "start": "2816960",
    "end": "2824119"
  },
  {
    "text": "the users and what processes what jobs they ran on a system for any given time period so we could see in detail by",
    "start": "2824119",
    "end": "2832000"
  },
  {
    "text": "user what jobs were ran on our systems audit system events records any",
    "start": "2832000",
    "end": "2839640"
  },
  {
    "text": "events that affect the security of the whole system so there's not much that we we will miss here in Windows 2000 if we",
    "start": "2839640",
    "end": "2846359"
  },
  {
    "text": "want to apply apply these",
    "start": "2846359",
    "end": "2851680"
  },
  {
    "text": "categories um well we can go look at the system log",
    "start": "2864920",
    "end": "2874640"
  },
  {
    "text": "and have a look the question was uh some examples of events that would be logged",
    "start": "2878480",
    "end": "2883520"
  },
  {
    "text": "under the",
    "start": "2883520",
    "end": "2886040"
  },
  {
    "text": "system we can start at the top here we have some",
    "start": "2890760",
    "end": "2897520"
  },
  {
    "text": "DHCP events we have a warning for Windows uh",
    "start": "2897520",
    "end": "2902960"
  },
  {
    "text": "the time service was not able to find a domain controller",
    "start": "2902960",
    "end": "2908000"
  },
  {
    "text": "the host cannot be an ACS uh active directory stuff here SNMP information",
    "start": "2908520",
    "end": "2914800"
  },
  {
    "text": "DHCP server wins errors wins",
    "start": "2914800",
    "end": "2919800"
  },
  {
    "text": "information the browser is forced so elections on the",
    "start": "2919960",
    "end": "2925040"
  },
  {
    "text": "browser uh perfect example is really start up and shut down events",
    "start": "2928119",
    "end": "2935079"
  },
  {
    "text": "right so that that brings up one point that's interesting about all this um when whenever I go into places you look",
    "start": "2935079",
    "end": "2941640"
  },
  {
    "text": "at my uh my system log here right and it's",
    "start": "2941640",
    "end": "2946839"
  },
  {
    "text": "filled with errors and warnings okay um I I have taken I have done no put forth",
    "start": "2946839",
    "end": "2953760"
  },
  {
    "text": "no effort to clean up the DHCP errors and the winds errors and stuff on this this machine I realized at the last",
    "start": "2953760",
    "end": "2960000"
  },
  {
    "text": "moment that I needed to have Windows uh server loaded on here so I've not cleaned up any of these errors but if",
    "start": "2960000",
    "end": "2966240"
  },
  {
    "text": "this box was in production this would this would be a terrible looking log filled with errors and warnings like",
    "start": "2966240",
    "end": "2971880"
  },
  {
    "text": "this um it's it should be part of anybody any administrator's duties that",
    "start": "2971880",
    "end": "2977920"
  },
  {
    "text": "when they install Windows 2000 to make sure that there's no errors that exist in any of the",
    "start": "2977920",
    "end": "2983640"
  },
  {
    "text": "logs to be able to implement and configure audit policy settings you must have the following privileges generate",
    "start": "2992160",
    "end": "2998680"
  },
  {
    "text": "security audits allows the process to make entries to the security log and uh managing auditing and",
    "start": "2998680",
    "end": "3006359"
  },
  {
    "text": "security log which allows the user to specify object access auditing",
    "start": "3006359",
    "end": "3012319"
  },
  {
    "text": "options okay let's talk Group Policy a little",
    "start": "3012319",
    "end": "3019599"
  },
  {
    "text": "bit here allow centralized management of Windows 2000 computers",
    "start": "3019599",
    "end": "3027000"
  },
  {
    "text": "um domain Group Policy will override local policy there is a hierarchy that exists in group policy and we'll talk",
    "start": "3027000",
    "end": "3033880"
  },
  {
    "text": "about that in a second group policy objects are a collection of configuration settings",
    "start": "3033880",
    "end": "3040520"
  },
  {
    "text": "consisting of computer configuration and user configuration the computer configuration",
    "start": "3040520",
    "end": "3046280"
  },
  {
    "text": "is applied with when the system Boots the user configuration is applied at the",
    "start": "3046280",
    "end": "3051680"
  },
  {
    "text": "time the user logs on okay and and Windows 2000 reapplies",
    "start": "3051680",
    "end": "3058280"
  },
  {
    "text": "these group policies at specified intervals so we can set um a global",
    "start": "3058280",
    "end": "3064200"
  },
  {
    "text": "security policy and by using Group Policy push that out to multiple servers and workstations uh it's it's was",
    "start": "3064200",
    "end": "3071880"
  },
  {
    "text": "definitely a downfall Windows NT and they've they've made up for that in",
    "start": "3071880",
    "end": "3077119"
  },
  {
    "text": "Windows 2000 doain controller not being able to",
    "start": "3077119",
    "end": "3087480"
  },
  {
    "text": "grou policy how that enduration those policies those policies",
    "start": "3087480",
    "end": "3095720"
  },
  {
    "text": "should change uh you referring to a few slides back when we talked about Group Policy was Group Policy cannot push",
    "start": "3095720",
    "end": "3103280"
  },
  {
    "text": "audit log properties down to those three other other servers they can Group Policy still applies in many other ways",
    "start": "3103280",
    "end": "3110240"
  },
  {
    "text": "to uh two domain controllers but it can't push the size of the audit logs",
    "start": "3110240",
    "end": "3115520"
  },
  {
    "text": "and that type of things to domain controllers the hierarchy of Group",
    "start": "3115520",
    "end": "3120960"
  },
  {
    "text": "Policy uh is the local computer Group Policy is applied first then site linked",
    "start": "3120960",
    "end": "3127480"
  },
  {
    "text": "policy then domain linked policy then organizational linked policy um active",
    "start": "3127480",
    "end": "3133760"
  },
  {
    "text": "directory is very complex don't if any any of you figure that out yet or not but uh Group Policy is um you really",
    "start": "3133760",
    "end": "3142280"
  },
  {
    "text": "have to plan this out and you really have to think through it because these settings can overlay each other right so",
    "start": "3142280",
    "end": "3148839"
  },
  {
    "text": "you might think you have a certain group policy in effect but based on configuration at these different levels",
    "start": "3148839",
    "end": "3154160"
  },
  {
    "text": "you might find that your effective setting is not what you believe it to be okay so it's all it's all in",
    "start": "3154160",
    "end": "3163799"
  },
  {
    "text": "Planning Group Policy object settings can conflict the last applied Group Policy",
    "start": "3164079",
    "end": "3170839"
  },
  {
    "text": "wins okay settings can be set to not configure this is one Saving Grace I I",
    "start": "3170839",
    "end": "3178440"
  },
  {
    "text": "believe in this whole thing U if a setting inside a group policy object is",
    "start": "3178440",
    "end": "3183880"
  },
  {
    "text": "set to not configured it will not overlay the previously apply Group",
    "start": "3183880",
    "end": "3188920"
  },
  {
    "text": "Policy okay this could be a whole session as",
    "start": "3188920",
    "end": "3194839"
  },
  {
    "text": "well just on Group Policy it's pretty",
    "start": "3194839",
    "end": "3199599"
  },
  {
    "text": "complex configuring object auditing so now we're talking about you know it's",
    "start": "3202119",
    "end": "3207640"
  },
  {
    "text": "the the specific files and objects that we can audit each object has a security descriptor associated with it um it",
    "start": "3207640",
    "end": "3215599"
  },
  {
    "text": "details the groups or users that can access the object and the types of access granted to the groups and users",
    "start": "3215599",
    "end": "3222040"
  },
  {
    "text": "this is called the discretionary Access Control list just again some information",
    "start": "3222040",
    "end": "3227119"
  },
  {
    "text": "about how the object maintains its its security each security descriptor also",
    "start": "3227119",
    "end": "3233400"
  },
  {
    "text": "contains auditing information called the system Access Control list okay so between these two Access Control list",
    "start": "3233400",
    "end": "3240200"
  },
  {
    "text": "auditing and security information is kept on every",
    "start": "3240200",
    "end": "3245440"
  },
  {
    "text": "object to enable auditing auditing on a file or folder it must be an NTFS",
    "start": "3251839",
    "end": "3257040"
  },
  {
    "text": "formatted file system must specify the files or folders",
    "start": "3257040",
    "end": "3262760"
  },
  {
    "text": "to audit must specif the action that will trigger the audit so in other words you",
    "start": "3262760",
    "end": "3269440"
  },
  {
    "text": "know uh are we going to log an audit record if the user reads the file or",
    "start": "3269440",
    "end": "3275040"
  },
  {
    "text": "displays its properties or there's there's a half a dozen well actually there's probably a dozen or more uh",
    "start": "3275040",
    "end": "3281000"
  },
  {
    "text": "events that will trigger an audit record on a file or folder we'll look at them here in a",
    "start": "3281000",
    "end": "3286319"
  },
  {
    "text": "minute must be logged on as a member of the administrator group to enable auditing",
    "start": "3286319",
    "end": "3292920"
  },
  {
    "text": "types of folder access I'm not going to read these to you but we'll display them here you have them in your book as well",
    "start": "3297359",
    "end": "3303400"
  },
  {
    "text": "these are the different types of events that can be logged file access very similar types of",
    "start": "3303400",
    "end": "3314040"
  },
  {
    "text": "events okay let's go and set",
    "start": "3323520",
    "end": "3328319"
  },
  {
    "text": "some auditing on an object here I have a file in my documents",
    "start": "3329640",
    "end": "3336400"
  },
  {
    "text": "called a password list and basically the way you enable auditing on the file is you rightclick",
    "start": "3336400",
    "end": "3344520"
  },
  {
    "text": "properties go to the security tab click",
    "start": "3344520",
    "end": "3351480"
  },
  {
    "text": "Advanced and then you'll see the auditing tab and we can",
    "start": "3351480",
    "end": "3358880"
  },
  {
    "text": "add who we want to audit related to this object let's just say we want to audit",
    "start": "3359319",
    "end": "3365039"
  },
  {
    "text": "administrator activity here are the different types of",
    "start": "3365039",
    "end": "3370599"
  },
  {
    "text": "access that we can monitor for Traverse folder and execute file list folder read",
    "start": "3370599",
    "end": "3376039"
  },
  {
    "text": "data again I won't read them all to you but there's an extensive list of",
    "start": "3376039",
    "end": "3381839"
  },
  {
    "text": "uh of types of access we can monitor for yes do the object auditing properties stay",
    "start": "3381839",
    "end": "3389440"
  },
  {
    "text": "the same between the different flavors of window professional server I believe so",
    "start": "3389440",
    "end": "3397119"
  },
  {
    "text": "yes so normally we would uh monitor for the",
    "start": "3397960",
    "end": "3403079"
  },
  {
    "text": "failed um event but there's times when we would want to see the successful",
    "start": "3403079",
    "end": "3408240"
  },
  {
    "text": "events as well so I'm going to just enable successful events here real quick",
    "start": "3408240",
    "end": "3415799"
  },
  {
    "text": "want to do all of",
    "start": "3418720",
    "end": "3421559"
  },
  {
    "text": "them right so we'll say okay you can see that now we have",
    "start": "3427200",
    "end": "3432799"
  },
  {
    "text": "uh the administrator set up in auditing so only only the administrator",
    "start": "3432799",
    "end": "3440440"
  },
  {
    "text": "will be audited here I mean there's a there's a fine level of granularity here that the Windows 2000 provides you can",
    "start": "3440440",
    "end": "3447760"
  },
  {
    "text": "uh audit specific users differently differently for specific",
    "start": "3447760",
    "end": "3453558"
  },
  {
    "text": "objects okay so now at this point whatever I do",
    "start": "3459880",
    "end": "3465119"
  },
  {
    "text": "to this file whether I open",
    "start": "3465119",
    "end": "3470880"
  },
  {
    "text": "it check it's",
    "start": "3474799",
    "end": "3478440"
  },
  {
    "text": "Properties or rename",
    "start": "3481799",
    "end": "3485480"
  },
  {
    "text": "it that information will be logged in the Event Viewer in the security",
    "start": "3487760",
    "end": "3495480"
  },
  {
    "text": "log should be anyway",
    "start": "3495480",
    "end": "3499920"
  },
  {
    "text": "so you see these events here related to that object",
    "start": "3508760",
    "end": "3515520"
  },
  {
    "text": "access okay now the thing to point out here is I did a couple things to that file",
    "start": "3515520",
    "end": "3520599"
  },
  {
    "text": "right look at the amount of object access events that got logged based on",
    "start": "3520599",
    "end": "3528240"
  },
  {
    "text": "that 560 5 62s um mean different things but you can see",
    "start": "3528839",
    "end": "3537520"
  },
  {
    "text": "that you know all I wanted to know was I opened the file read the file so the",
    "start": "3537520",
    "end": "3544200"
  },
  {
    "text": "amount of object the amount of um of the actions that I I checked all",
    "start": "3544200",
    "end": "3549839"
  },
  {
    "text": "those check boxes right that caused all these all this these pieces of information to be logged in the audit",
    "start": "3549839",
    "end": "3555880"
  },
  {
    "text": "log here so you really have to understand specifically what you're looking for you're going to be weeding through hundreds and hundreds of Records",
    "start": "3555880",
    "end": "3562799"
  },
  {
    "text": "maybe thousands of Records related to object access",
    "start": "3562799",
    "end": "3568038"
  },
  {
    "text": "yes yeah the event will still be the question was Will filtering um eliminate some of these",
    "start": "3572640",
    "end": "3579680"
  },
  {
    "text": "events it won't eliminate them being logged but it is a way for you to sort through them yeah absolutely you could",
    "start": "3579680",
    "end": "3585799"
  },
  {
    "text": "do that but um in an effort to to not log information that we don't really need the better you understand it the",
    "start": "3585799",
    "end": "3592839"
  },
  {
    "text": "better off you're going to be when you when you select the things that do need to be",
    "start": "3592839",
    "end": "3598599"
  },
  {
    "text": "loged",
    "start": "3599839",
    "end": "3602839"
  },
  {
    "text": "okay we've been",
    "start": "3613520",
    "end": "3617039"
  },
  {
    "text": "here this is what we just performed setting up auditing on a file or folder um um I won't read it to you again just",
    "start": "3620960",
    "end": "3628079"
  },
  {
    "text": "the steps uh to set up a to set up",
    "start": "3628079",
    "end": "3633160"
  },
  {
    "text": "auditing some other things that you can audit with the Windows 2000 subsystem auditing subsystem we're not going to",
    "start": "3634079",
    "end": "3639960"
  },
  {
    "text": "talk about these in great detail but you can audit printers you can audit the print from a printer the management of",
    "start": "3639960",
    "end": "3647240"
  },
  {
    "text": "the printer the management of the documents read permissions change permissions and",
    "start": "3647240",
    "end": "3652280"
  },
  {
    "text": "take ownership so um there there may be reason I I don't know how valid it is to",
    "start": "3652280",
    "end": "3659440"
  },
  {
    "text": "audit every time somebody prints to a printer but uh you can do that if you want",
    "start": "3659440",
    "end": "3666400"
  },
  {
    "text": "to you can audit the registry and there's uh as you see there there's a there's a decent list of the things that",
    "start": "3666400",
    "end": "3672920"
  },
  {
    "text": "you can audit in the registry this this again could be another session we talk",
    "start": "3672920",
    "end": "3678960"
  },
  {
    "text": "about the registry but uh the information's there if you need to do that auditing of",
    "start": "3678960",
    "end": "3686799"
  },
  {
    "text": "DHCP uh in the uh DHCP server log it's",
    "start": "3686799",
    "end": "3693039"
  },
  {
    "text": "it's enhanced in Windows 2000 allows you to specify the directory path of the DHCP logs I think in NT you couldn't",
    "start": "3693039",
    "end": "3700119"
  },
  {
    "text": "really specify the name of the file or or at least not the path you could specify the maximum size restriction and",
    "start": "3700119",
    "end": "3706039"
  },
  {
    "text": "megabyte for all the audit logs managed by the DHCP service can specify an interval for rights to the AIT log",
    "start": "3706039",
    "end": "3712760"
  },
  {
    "text": "before checking dis space um I'm not sure but it would seem that the DHCP",
    "start": "3712760",
    "end": "3718359"
  },
  {
    "text": "auditing subsystem was written by somebody different than the rest of the the auditing subsystems there's a whole",
    "start": "3718359",
    "end": "3724319"
  },
  {
    "text": "set of rules here that are different which I I can only explain by that but",
    "start": "3724319",
    "end": "3729799"
  },
  {
    "text": "uh specify minimum dis requirements to continue DHCP auditing and disable or enable auditing for",
    "start": "3729799",
    "end": "3736960"
  },
  {
    "text": "DHCP auditing of message cues uh again this just real high level stuff you you",
    "start": "3737559",
    "end": "3744559"
  },
  {
    "text": "can can audit message cues for a single message Q object um one important piece of",
    "start": "3744559",
    "end": "3750440"
  },
  {
    "text": "information to understand about message cues is audit message cues are only created when the queue is accessed not",
    "start": "3750440",
    "end": "3756880"
  },
  {
    "text": "each time a message is received or sent I don't know much about message cues but",
    "start": "3756880",
    "end": "3762720"
  },
  {
    "text": "uh you can audit them if you like auditing IPC uh again just very",
    "start": "3762720",
    "end": "3770240"
  },
  {
    "text": "limited information on on this right now in the in the audit logs you can filter",
    "start": "3770240",
    "end": "3775440"
  },
  {
    "text": "on o that we did at the beginning of the session here um and I guess you want to go to the IP",
    "start": "3775440",
    "end": "3782960"
  },
  {
    "text": "SEC class that's in progress right now this afternoon if you want to know more about that the Windows 2000 resource kit has",
    "start": "3782960",
    "end": "3790119"
  },
  {
    "text": "some really good utilities to manage the AIT logs just real quickly uh error and",
    "start": "3790119",
    "end": "3795680"
  },
  {
    "text": "event message help file that's out there I want to show that to",
    "start": "3795680",
    "end": "3800720"
  },
  {
    "text": "you it was like finding some Diamonds in the Rough when I found this",
    "start": "3800720",
    "end": "3807760"
  },
  {
    "text": "basically has information about all the errors and all the event IDs",
    "start": "3808559",
    "end": "3814599"
  },
  {
    "text": "inside uh Windows 2000 for example if we wanted to look at event",
    "start": "3814599",
    "end": "3819960"
  },
  {
    "text": "538 which happens to be a log off event uh we can we can search for it in the",
    "start": "3819960",
    "end": "3826400"
  },
  {
    "text": "help file user log off tells you the names of the fields that are in there",
    "start": "3826400",
    "end": "3831559"
  },
  {
    "text": "and the event type now the information is somewhat limited but you can at least get a handle on what what generally is",
    "start": "3831559",
    "end": "3838480"
  },
  {
    "text": "going on if we wanted to search for an event ID of 528 which is a log",
    "start": "3838480",
    "end": "3844319"
  },
  {
    "text": "on we can do that as well successful log on so the event",
    "start": "3844319",
    "end": "3851799"
  },
  {
    "text": "record indicates that a new log on has occurred there's lots of uh information",
    "start": "3851799",
    "end": "3857440"
  },
  {
    "text": "in here um not just on event IDs but different error messages and things so it's real",
    "start": "3857440",
    "end": "3862920"
  },
  {
    "text": "good a real good tool when the windows resource",
    "start": "3862920",
    "end": "3867720"
  },
  {
    "text": "kit there's a log log event. exe utility that allows you to add entries to the to",
    "start": "3872200",
    "end": "3878599"
  },
  {
    "text": "the uh event log cyber safe log analyst I'm going to",
    "start": "3878599",
    "end": "3883880"
  },
  {
    "text": "demo this to you here in a second this is a new tool I believe with Windows 2000 allows you to do event log analysis",
    "start": "3883880",
    "end": "3890640"
  },
  {
    "text": "and Reporting Windows 2000 events. MDB this is an access data base that list",
    "start": "3890640",
    "end": "3896559"
  },
  {
    "text": "all the uh events for the system security and application logs very",
    "start": "3896559",
    "end": "3901960"
  },
  {
    "text": "comprehensive list in an access database so you can do whatever you need to do with it audit PA is a command line utility",
    "start": "3901960",
    "end": "3910279"
  },
  {
    "text": "allow you to set audit and change audit",
    "start": "3910279",
    "end": "3914119"
  },
  {
    "text": "policy elog dump event log dump is an event log query tool you guys can play",
    "start": "3915359",
    "end": "3920960"
  },
  {
    "text": "around with these things in your spare time dump event log uh is is another just event log dump utility but it does",
    "start": "3920960",
    "end": "3928319"
  },
  {
    "text": "have filter capabilities up time. exe as an event",
    "start": "3928319",
    "end": "3934359"
  },
  {
    "text": "long utility determined availability reliability and current up time U this is a great example of the things that",
    "start": "3934359",
    "end": "3941240"
  },
  {
    "text": "the the the idea that I try to get across in this session which is you've got to understand the activity of your",
    "start": "3941240",
    "end": "3947520"
  },
  {
    "text": "system you if you collect your audit data and it's the right data and you store it centrally you then have really",
    "start": "3947520",
    "end": "3954319"
  },
  {
    "text": "a data warehouse of of of your system activities it's it's uh unbelievable the",
    "start": "3954319",
    "end": "3959960"
  },
  {
    "text": "things that you can do with it this uptime tool and the Cyber safe analyst tool is is a couple real good examples",
    "start": "3959960",
    "end": "3966319"
  },
  {
    "text": "of the types of things you can do with it and I'll just show you here in a second I'll show you now the next slide",
    "start": "3966319",
    "end": "3973680"
  },
  {
    "text": "here the uptime tool is uh is kind of neat it's just a",
    "start": "3973680",
    "end": "3980880"
  },
  {
    "text": "very simple utility on the resource kit with a there's some parameters I'll",
    "start": "3980880",
    "end": "3986160"
  },
  {
    "text": "display the parameters here for you just a few parameters um the most relevant",
    "start": "3986160",
    "end": "3991240"
  },
  {
    "text": "parameter is a SLS parameter and it shows you um all the",
    "start": "3991240",
    "end": "3998000"
  },
  {
    "text": "times that the system was started up and shut down okay calculates at the bottom",
    "start": "3998000",
    "end": "4003119"
  },
  {
    "text": "that the system availability has been 93.8 941 per. total up time 37 days",
    "start": "4003119",
    "end": "4009559"
  },
  {
    "text": "total downtime two days 14 reboots uh it's real good information it's a",
    "start": "4009559",
    "end": "4014680"
  },
  {
    "text": "classic example of of you know specifically going in and if you're a",
    "start": "4014680",
    "end": "4020119"
  },
  {
    "text": "data warehousing person specifically going in and Mining certain pieces of information out of the data warehouse",
    "start": "4020119",
    "end": "4026440"
  },
  {
    "text": "right we can pick um startups and shutdowns we could pick logons and log offs we could pick um other correlations",
    "start": "4026440",
    "end": "4034799"
  },
  {
    "text": "that might be important from an intrusion detection perspective and you can write utilities or query based on",
    "start": "4034799",
    "end": "4040880"
  },
  {
    "text": "certain events that's a real good example of uh",
    "start": "4040880",
    "end": "4046039"
  },
  {
    "text": "of use of the event logs the other tool that's pretty neat is uh cyber safe log",
    "start": "4046039",
    "end": "4054039"
  },
  {
    "text": "analyst and again just to further substantiate some of the neat things you can do here they've done a real nice job",
    "start": "4054039",
    "end": "4059520"
  },
  {
    "text": "with this utility allows you to take",
    "start": "4059520",
    "end": "4065599"
  },
  {
    "text": "um take the current event log and cut the live local event log",
    "start": "4066200",
    "end": "4072079"
  },
  {
    "text": "here basically on the property so we're going to pull in the event log as it stands right now there it",
    "start": "4072079",
    "end": "4078799"
  },
  {
    "text": "is and we're going to analyze it basically adds it to the tree over",
    "start": "4078799",
    "end": "4083960"
  },
  {
    "text": "here under analyze logs which you can see I've had a few over the last month or so and then we can run reports and",
    "start": "4083960",
    "end": "4092160"
  },
  {
    "text": "the reports are um activity by Target activity by user summaries virus",
    "start": "4092160",
    "end": "4097640"
  },
  {
    "text": "activity log on summary reports type of thing um let's just pop open a couple of",
    "start": "4097640",
    "end": "4103000"
  },
  {
    "text": "these activity by user there's only two users that have have",
    "start": "4103000",
    "end": "4109400"
  },
  {
    "text": "used this machine so the administrator and the system so we'll preview this report",
    "start": "4109400",
    "end": "4116560"
  },
  {
    "text": "here oh actually I was playing around last night I got my name and test and guest as well so you can see here",
    "start": "4116640",
    "end": "4123758"
  },
  {
    "text": "that um it tries to summarize the users and",
    "start": "4123759",
    "end": "4129159"
  },
  {
    "text": "and the the amount of times that the the event the event records were found and",
    "start": "4129159",
    "end": "4135560"
  },
  {
    "text": "talks about the types of events that are in here the audit log has been cleared four times audit policy changes once",
    "start": "4135560",
    "end": "4142159"
  },
  {
    "text": "authentication package added domain change uh next",
    "start": "4142159",
    "end": "4147719"
  },
  {
    "text": "page you can see here's our access to the password file right",
    "start": "4147719",
    "end": "4154159"
  },
  {
    "text": "here uh General browsing failed failed log on",
    "start": "4154159",
    "end": "4160520"
  },
  {
    "text": "account so basically you're in here taking this this event log information and turning it into something other than",
    "start": "4162759",
    "end": "4168719"
  },
  {
    "text": "just a big list of uh events that are not correlated in any",
    "start": "4168719",
    "end": "4174199"
  },
  {
    "text": "way several reports in here that are of use uh it's pretty good pretty good",
    "start": "4174199",
    "end": "4181120"
  },
  {
    "text": "tool okay another tool that comes with uh the resource kit is I think it's the",
    "start": "4188359",
    "end": "4194000"
  },
  {
    "text": "resource kit maybe it's maybe it's Windows 2000 itself is the security configuration and",
    "start": "4194000",
    "end": "4200159"
  },
  {
    "text": "analysis tool uh this talks about um the ability to mass set or mass",
    "start": "4200159",
    "end": "4207719"
  },
  {
    "text": "update uh security policy as well and it it'll actually perform the vulnerability",
    "start": "4207719",
    "end": "4214199"
  },
  {
    "text": "assessment that we talked about before and it help you establish a baseline for for your for your system so",
    "start": "4214199",
    "end": "4221000"
  },
  {
    "text": "that you can determine if things change over time um I thought I'd show that to you",
    "start": "4221000",
    "end": "4226920"
  },
  {
    "text": "as well instead of going over the picture",
    "start": "4226920",
    "end": "4231159"
  },
  {
    "text": "there it's a snap in as well",
    "start": "4233600",
    "end": "4238640"
  },
  {
    "text": "there we go okay so that's the group policy",
    "start": "4271600",
    "end": "4279159"
  },
  {
    "text": "object down here at the bottom is the security configuration and analysis tool",
    "start": "4279159",
    "end": "4284440"
  },
  {
    "text": "and basically what you can do here is um there's templates that exist out there",
    "start": "4284440",
    "end": "4289480"
  },
  {
    "text": "that you can you can draw a baseline to your existing configuration based on a",
    "start": "4289480",
    "end": "4294520"
  },
  {
    "text": "template so let's try this once we'll U open a database I've got one out here called",
    "start": "4294520",
    "end": "4301400"
  },
  {
    "text": "Baseline so I'll open it and then I'll",
    "start": "4301400",
    "end": "4307000"
  },
  {
    "text": "import a template and let's go for a secure",
    "start": "4307000",
    "end": "4312040"
  },
  {
    "text": "domain controller you can see there's several out here that are defaults I'm going to go for a secure domain",
    "start": "4312040",
    "end": "4318679"
  },
  {
    "text": "controller we'll Implement that and then we'll say analyze the",
    "start": "4318679",
    "end": "4327480"
  },
  {
    "text": "computer and basically it's going through and taking what Microsoft says is a is a configuration for a secure",
    "start": "4328199",
    "end": "4333920"
  },
  {
    "text": "domain controller and it's going to set a baseline to where my system's at today and it's a pretty pretty decent",
    "start": "4333920",
    "end": "4340880"
  },
  {
    "text": "utility to get an idea what Microsoft recommends compared to where you are just give it a second",
    "start": "4340880",
    "end": "4349760"
  },
  {
    "text": "here",
    "start": "4361199",
    "end": "4364199"
  },
  {
    "text": "okay here's a good example under audit policy um Microsoft says that account",
    "start": "4367440",
    "end": "4375840"
  },
  {
    "text": "audit account log on events should only be set at failure I have them set at success and",
    "start": "4375840",
    "end": "4381120"
  },
  {
    "text": "failure uh account management success and failure I have them both set properly so",
    "start": "4381120",
    "end": "4386880"
  },
  {
    "text": "you see the Red X over here tells you the areas that my my configuration",
    "start": "4386880",
    "end": "4392120"
  },
  {
    "text": "doesn't meet the recommended template configuration and you can do this for all areas of the system from privileges",
    "start": "4392120",
    "end": "4399159"
  },
  {
    "text": "to um other local policies okay it's a pretty neat tool it",
    "start": "4399159",
    "end": "4404440"
  },
  {
    "text": "does some other stuff stuff to uh you might find it",
    "start": "4404440",
    "end": "4410000"
  },
  {
    "text": "useful",
    "start": "4411639",
    "end": "4414639"
  },
  {
    "text": "okay managing the logs um you can use the Event Viewer to export the current",
    "start": "4417960",
    "end": "4423239"
  },
  {
    "text": "view we talked about that it will use the current filter settings if you archive a log in log",
    "start": "4423239",
    "end": "4431040"
  },
  {
    "text": "format you can reopen In the Event Viewer we talked about that um one thing that you need to know if you're going to",
    "start": "4431040",
    "end": "4437120"
  },
  {
    "text": "to uh use the EVT file format and you're going to manage the log centrally on",
    "start": "4437120",
    "end": "4443320"
  },
  {
    "text": "another machine the same applications or the same support files have to exist on the machine that you're going to monitor",
    "start": "4443320",
    "end": "4449400"
  },
  {
    "text": "on what happens is the vent ID is stored as a number inside the file and the",
    "start": "4449400",
    "end": "4455360"
  },
  {
    "text": "description is stored in the support files so any applications that are on the server where the information was",
    "start": "4455360",
    "end": "4461280"
  },
  {
    "text": "logged need to be installed on the machine that you're going to send manage the logs on um there is a way Microsoft",
    "start": "4461280",
    "end": "4469040"
  },
  {
    "text": "has a tech Noe on it that documents how to find the support files in the",
    "start": "4469040",
    "end": "4475120"
  },
  {
    "text": "registry by application by event log to allow you to copy those files over to",
    "start": "4475120",
    "end": "4481400"
  },
  {
    "text": "the central machine that you're going to do the management on so it's something to be aware of when you archive a log file the",
    "start": "4481400",
    "end": "4488639"
  },
  {
    "text": "entire log is saved regardless of the filtering options the sword order is not retained when the logs are saved",
    "start": "4488639",
    "end": "4497000"
  },
  {
    "text": "we talked about common deliv and uh tab delimited archiving has no effect on the",
    "start": "4497040",
    "end": "4503199"
  },
  {
    "text": "current contents of the logs here's some tools um that that I",
    "start": "4503199",
    "end": "4509320"
  },
  {
    "text": "found out there that will do log monitoring I've used just one or two of",
    "start": "4509320",
    "end": "4515000"
  },
  {
    "text": "these rippl Tech log cter I'm the most familiar with it's a pretty decent utility to centrally manage the the uh",
    "start": "4515000",
    "end": "4521920"
  },
  {
    "text": "event logs and it does all the dirty work for you that's in your book for you event log",
    "start": "4521920",
    "end": "4528760"
  },
  {
    "text": "targeted uh quickly the event log cleared at random uh is a problem",
    "start": "4528760",
    "end": "4534080"
  },
  {
    "text": "generally speaking one way to to uh to handle this situation is we you don't",
    "start": "4534080",
    "end": "4540400"
  },
  {
    "text": "want to just see random uh entries in there that the event log was cleared it's suspicious we want to take a look",
    "start": "4540400",
    "end": "4546719"
  },
  {
    "text": "at having a paper log by each server and anytime that an administrator clears the",
    "start": "4546719",
    "end": "4552639"
  },
  {
    "text": "event log they should write an entry on the on the paper log as well so that you",
    "start": "4552639",
    "end": "4558360"
  },
  {
    "text": "can correlate clears with uh with somebody actually being at the console as opposed to somebody clearing the",
    "start": "4558360",
    "end": "4565080"
  },
  {
    "text": "event log trying to hide something event log flooding is a problem there's utilities out there that that are meant",
    "start": "4565080",
    "end": "4572280"
  },
  {
    "text": "as denial service attacks against the event log uh used to overwhelm the",
    "start": "4572280",
    "end": "4577679"
  },
  {
    "text": "administrator sophisticated hackers can write to the security log as well",
    "start": "4577679",
    "end": "4585040"
  },
  {
    "text": "monitoring the security logs must monitor users that have admin rights I made reference to this a couple times",
    "start": "4585360",
    "end": "4591040"
  },
  {
    "text": "using the uh account management and some of the other event categories uh somebody needs to watch the",
    "start": "4591040",
    "end": "4597000"
  },
  {
    "text": "administrators as well what to look for in the uh in the",
    "start": "4597000",
    "end": "4604040"
  },
  {
    "text": "audit logs from an intrusion detection perspective uh to watch for tampering and and policy",
    "start": "4604040",
    "end": "4610040"
  },
  {
    "text": "changes uh restarts or event ID 512 shutdowns auto policy changes 612 time",
    "start": "4610040",
    "end": "4617560"
  },
  {
    "text": "changes 577 the correlation that needs to happen when you analyze the log is is going to",
    "start": "4617560",
    "end": "4623320"
  },
  {
    "text": "be up to you know the individual user there's there's U lots of specific",
    "start": "4623320",
    "end": "4628560"
  },
  {
    "text": "things that you could look for um with restarts and shutdowns and time changes you know the the hacker could could",
    "start": "4628560",
    "end": "4635360"
  },
  {
    "text": "attempt a time change to uh cover up events in the event",
    "start": "4635360",
    "end": "4641000"
  },
  {
    "text": "log policies should exist to manage the audit logs we talked about this a little",
    "start": "4641000",
    "end": "4646239"
  },
  {
    "text": "bit look for the clear of the man of the audit log which is event 517 proper policy should make this event",
    "start": "4646239",
    "end": "4653199"
  },
  {
    "text": "rare it should not be normal policy to clear the event log just anytime anybody feels like it log on and log off",
    "start": "4653199",
    "end": "4660679"
  },
  {
    "text": "successfully um 528 and 540 Windows 2000 added to 540 NT used to 28 540 is a",
    "start": "4660679",
    "end": "4669400"
  },
  {
    "text": "network log on now and they've they've separated it uh I won't read the different types",
    "start": "4669400",
    "end": "4676880"
  },
  {
    "text": "to you but on the event record there are there is a type code that specifies what",
    "start": "4676880",
    "end": "4682159"
  },
  {
    "text": "type of a log on it was log off uses event ID 538 so you can run queries over",
    "start": "4682159",
    "end": "4688199"
  },
  {
    "text": "your data warehouse over your centralized uh audit logs to look for log on log offs there's one small",
    "start": "4688199",
    "end": "4696040"
  },
  {
    "text": "problem with that is that Windows 2000 suffers from the same bug that NT did",
    "start": "4696040",
    "end": "4701080"
  },
  {
    "text": "that 538 events are not always logged and that seems to be a problem",
    "start": "4701080",
    "end": "4706159"
  },
  {
    "text": "just with interactive logons at this point in",
    "start": "4706159",
    "end": "4710079"
  },
  {
    "text": "time utilities last slide if it shows a",
    "start": "4712120",
    "end": "4717400"
  },
  {
    "text": "manual clear or a manual clear only if it's",
    "start": "4717400",
    "end": "4721920"
  },
  {
    "text": "done I don't know don't know the answer to that for sure I'm not sure if there's",
    "start": "4724880",
    "end": "4729960"
  },
  {
    "text": "just one event for a log clear or there might be multiples or multiple types I'm not sure",
    "start": "4729960",
    "end": "4736719"
  },
  {
    "text": "log on and log off unsuccessfully um each of those events represents their",
    "start": "4737920",
    "end": "4743199"
  },
  {
    "text": "description uh so there's many of them most common is a 529 unknown username or",
    "start": "4743199",
    "end": "4748600"
  },
  {
    "text": "bad password disabled accounts accounts locked out log on outside the time frame",
    "start": "4748600",
    "end": "4756199"
  },
  {
    "text": "Etc uh event ID 534 is insufficient rights perform an action 537 is a",
    "start": "4756199",
    "end": "4763120"
  },
  {
    "text": "general failure unexpected errors occurred during log one the point to make here is that we can watch for",
    "start": "4763120",
    "end": "4768920"
  },
  {
    "text": "intrusions in the event logs by monitoring event IDs 529 537 and",
    "start": "4768920",
    "end": "4774080"
  },
  {
    "text": "539 that's not meant to be an inclusive list but generally speaking um we can we",
    "start": "4774080",
    "end": "4781000"
  },
  {
    "text": "can do some analysis based on those event",
    "start": "4781000",
    "end": "4784920"
  },
  {
    "text": "IDs uh I skipped over the slide on the SQL Server just we're running out of time here just was going to show uh",
    "start": "4786280",
    "end": "4794800"
  },
  {
    "text": "we do centralized management if all else fails we'll take a quote from William",
    "start": "4794800",
    "end": "4801560"
  },
  {
    "text": "Shakespeare and if you wrong us shall we not Revenge any questions",
    "start": "4801560",
    "end": "4809520"
  },
  {
    "text": "yes yeah the question the question is the question is is there are there utilities that will go through the log",
    "start": "4822920",
    "end": "4829080"
  },
  {
    "text": "and email you uh uh based on specific events or what have you right uh there",
    "start": "4829080",
    "end": "4835840"
  },
  {
    "text": "are third party utilities that will do that the list that I brought up there some of those utilities can perform",
    "start": "4835840",
    "end": "4841480"
  },
  {
    "text": "emailing and and that type of thing but nothing that comes with 2,000 that I'm aware of so it's a third party",
    "start": "4841480",
    "end": "4846960"
  },
  {
    "text": "application that you have to buy any other",
    "start": "4846960",
    "end": "4853159"
  },
  {
    "text": "questions yeah",
    "start": "4853440",
    "end": "4856639"
  },
  {
    "text": "yes you can export the uh the audit logs and print you're you're G to end up",
    "start": "4865880",
    "end": "4875080"
  },
  {
    "text": "yeah yeah I don't think you can still print them I think you have to export them as a common delimited or something",
    "start": "4876440",
    "end": "4882320"
  },
  {
    "text": "like that to print them yeah on each of the individual tabs",
    "start": "4882320",
    "end": "4887679"
  },
  {
    "text": "now that indidual you're to the okay did",
    "start": "4887679",
    "end": "4892880"
  },
  {
    "text": "you did you hear that he's saying that there's a there's a way to to copy the contents of an",
    "start": "4892880",
    "end": "4899719"
  },
  {
    "text": "event log record to the clipboard and then print",
    "start": "4899719",
    "end": "4903760"
  },
  {
    "text": "it yes",
    "start": "4907080",
    "end": "4911080"
  },
  {
    "text": "yes yeah you can the the level of auditing is is down to the user and specific event on there so you could you",
    "start": "4919280",
    "end": "4926159"
  },
  {
    "text": "could certainly do",
    "start": "4926159",
    "end": "4928920"
  },
  {
    "text": "that oh I see what you're",
    "start": "4933080",
    "end": "4936719"
  },
  {
    "text": "saying you could do that you could do that by group you'd have to I think You' have to set up a",
    "start": "4939000",
    "end": "4945280"
  },
  {
    "text": "group then you would no you would you would do it the",
    "start": "4945280",
    "end": "4951120"
  },
  {
    "text": "other way you would include the groups that you want to audit yeah any other questions yes sir I was",
    "start": "4951120",
    "end": "4958159"
  },
  {
    "text": "just going to make a comment that the um there is in the with 32 a there's this event that fires every time the event is",
    "start": "4958159",
    "end": "4965719"
  },
  {
    "text": "put in event it turns out so it means they have these hooks in there people",
    "start": "4965719",
    "end": "4970880"
  },
  {
    "text": "can pieces of code it turns out that's why some people can",
    "start": "4970880",
    "end": "4976239"
  },
  {
    "text": "easily write these utilities actually I see so each time you can put this little",
    "start": "4976239",
    "end": "4981520"
  },
  {
    "text": "function that",
    "start": "4981520",
    "end": "4984239"
  },
  {
    "text": "weits I see very good very good yes",
    "start": "4986960",
    "end": "4995040"
  },
  {
    "text": "yeah so the question is um can you select machines to monitor based on IP",
    "start": "5008199",
    "end": "5013600"
  },
  {
    "text": "address um some of the the third party utilities can do that for example I'm familiar with log cter log cter uses net",
    "start": "5013600",
    "end": "5020880"
  },
  {
    "text": "bios and brings up IP address ranges and a list of computers to audit and you can manage them that way certainly but it's",
    "start": "5020880",
    "end": "5027880"
  },
  {
    "text": "probably looking at a third party application to do that anybody else yes do you know the",
    "start": "5027880",
    "end": "5037239"
  },
  {
    "text": "lity I believe that that event that utility was there under four",
    "start": "5038000",
    "end": "5043639"
  },
  {
    "text": "yes anybody else thank you it's been",
    "start": "5043639",
    "end": "5051639"
  },
  {
    "text": "fun e",
    "start": "5063320",
    "end": "5067360"
  }
]