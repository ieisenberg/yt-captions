[
  {
    "text": "hello everyone stocket the most infamous cyber",
    "start": "1839",
    "end": "8000"
  },
  {
    "text": "physical system attack is nearly 15 years old and still",
    "start": "8000",
    "end": "13480"
  },
  {
    "text": "relevant in this talk we present a comprehensive reconstruction of the",
    "start": "13480",
    "end": "19640"
  },
  {
    "text": "stocks net attacks impact on the latest version of seens S7 plcs these plcs use",
    "start": "19640",
    "end": "27640"
  },
  {
    "text": "TLS 1.34 security communication notably our attack relies",
    "start": "27640",
    "end": "34160"
  },
  {
    "text": "on our ability to retrieve the private key from an S7 1500 PLC using a protocal",
    "start": "34160",
    "end": "43879"
  },
  {
    "text": "feature provided by seens plc's are the core of the Cyber",
    "start": "43879",
    "end": "51680"
  },
  {
    "text": "physical system and as we speak they are evolving they are increasingly being",
    "start": "51680",
    "end": "58000"
  },
  {
    "text": "connected to external Networks to get the benefits of the cloud like U machine",
    "start": "58000",
    "end": "63600"
  },
  {
    "text": "learning models and digital twins as a result the traditional models and",
    "start": "63600",
    "end": "71400"
  },
  {
    "text": "architectures we all know are changing and the attack surface",
    "start": "71400",
    "end": "78719"
  },
  {
    "text": "increases my name is Alon Danner I'm a security researcher at the techon and at",
    "start": "79920",
    "end": "86720"
  },
  {
    "text": "no code security and this is a joint work with Professor Ellie bam Dr Sarah ban and",
    "start": "86720",
    "end": "93799"
  },
  {
    "text": "three of our students Ron fental or Carro and nadav adir who will be",
    "start": "93799",
    "end": "99640"
  },
  {
    "text": "presenting here with me uh we're all from the faculty of computer science from the techan hi guys I'm nadav I'm a",
    "start": "99640",
    "end": "109079"
  },
  {
    "text": "student from tno University software engineering student and I've worked on this project during my last year of",
    "start": "109079",
    "end": "116520"
  },
  {
    "text": "studies this is our fourth re search on the security of Sean plcs published at",
    "start": "116520",
    "end": "124960"
  },
  {
    "text": "the blackhead conference and our studies are even one of the reasons for seens to",
    "start": "124960",
    "end": "131959"
  },
  {
    "text": "uh switch to TLS 1.3 so the PLC or programmable logic",
    "start": "131959",
    "end": "140440"
  },
  {
    "text": "controller forms a bridge between the cyber world and the physical world and",
    "start": "140440",
    "end": "146480"
  },
  {
    "text": "the control program dictates the behavior of the physical industrial",
    "start": "146480",
    "end": "152560"
  },
  {
    "text": "process now to spice things up throughout the talk we use the Avengers",
    "start": "152560",
    "end": "159200"
  },
  {
    "text": "as our actors so our asset owner is Nick",
    "start": "159200",
    "end": "165200"
  },
  {
    "text": "Fury Captain America is our operator for his great performance in the",
    "start": "165200",
    "end": "172599"
  },
  {
    "text": "battlefield and Iron Man is our engineer for his technical",
    "start": "172599",
    "end": "178640"
  },
  {
    "text": "skills now now in seens world we have uh the HMI software called wicc that allows",
    "start": "178640",
    "end": "186920"
  },
  {
    "text": "the operator to monitor the PLC the engineering station a software",
    "start": "186920",
    "end": "194080"
  },
  {
    "text": "called Step seven allows the engineer to program the PLC and both of these software modules",
    "start": "194080",
    "end": "202360"
  },
  {
    "text": "are packaged into a single software called Tia",
    "start": "202360",
    "end": "207480"
  },
  {
    "text": "portal and Tia commun communicates with the PLC using seens S7",
    "start": "207480",
    "end": "216080"
  },
  {
    "text": "protocol now we must have an attacker and this is obviously",
    "start": "216080",
    "end": "224920"
  },
  {
    "text": "tanos so today we'll focus on uh the S7 protocol S7 is a client server protocol",
    "start": "226360",
    "end": "233159"
  },
  {
    "text": "where the client is the Tia and the server is the PLC and it allows the",
    "start": "233159",
    "end": "238400"
  },
  {
    "text": "client to send requests or commands to uh the PLC like loading a new control",
    "start": "238400",
    "end": "246079"
  },
  {
    "text": "program or reading some PLC variable now in the current latest",
    "start": "246079",
    "end": "252360"
  },
  {
    "text": "version of the protocol um CS use TLS 1.3 for secure",
    "start": "252360",
    "end": "261799"
  },
  {
    "text": "communication but S7 did not always use TLS in fact it started as an unencrypted",
    "start": "263040",
    "end": "270560"
  },
  {
    "text": "protocol without any cryptography in 2010 the stocks net worm",
    "start": "270560",
    "end": "279600"
  },
  {
    "text": "was discovered and drove seens to integrate proprietary cryptographic",
    "start": "279600",
    "end": "285039"
  },
  {
    "text": "protection to their protocol in 2019 our team from the",
    "start": "285039",
    "end": "291680"
  },
  {
    "text": "techon published a work called Rogue 7 uh also in blackhead USA where we",
    "start": "291680",
    "end": "298960"
  },
  {
    "text": "exploited the lack of client authentication and hardcoded group key",
    "start": "298960",
    "end": "304800"
  },
  {
    "text": "shared between plc's to implement what we called a",
    "start": "304800",
    "end": "309960"
  },
  {
    "text": "rogue engineering station attack or a rogue client now what's the end of every",
    "start": "309960",
    "end": "317400"
  },
  {
    "text": "hard-coded secret well it is being exposed and",
    "start": "317400",
    "end": "324039"
  },
  {
    "text": "three years later uh researchers from Clarity exposed it",
    "start": "324039",
    "end": "330639"
  },
  {
    "text": "so after the protocol was found to be vulnerable to attacks uh Seamans decided to integrate",
    "start": "330639",
    "end": "336560"
  },
  {
    "text": "TLS and this is where we are today so our goal is to check if the new",
    "start": "336560",
    "end": "345680"
  },
  {
    "text": "version of the protocol with TLS is really more secure compared to the previous version so we want to see if it",
    "start": "345680",
    "end": "353400"
  },
  {
    "text": "prevent previous attacks or maybe is it possible that it opens the",
    "start": "353400",
    "end": "361120"
  },
  {
    "text": "system to new attacks we'll",
    "start": "361120",
    "end": "367479"
  },
  {
    "text": "see so throughout the talk we introduce six attacks against S7 and there are six",
    "start": "368080",
    "end": "376120"
  },
  {
    "text": "Infinity Stones so each stone represents an attack and the goal of Thanos is to",
    "start": "376120",
    "end": "383800"
  },
  {
    "text": "collect all six infinity stone in order to gain unlimited power and control over",
    "start": "383800",
    "end": "391840"
  },
  {
    "text": "the Cyber physical system so here's our outline we'll start with some background and then we move to",
    "start": "391840",
    "end": "399199"
  },
  {
    "text": "our attack path where we look into the TLs encryption next we'll see an attack",
    "start": "399199",
    "end": "405880"
  },
  {
    "text": "against the key initialization and then we'll show how an attacker can retrieve",
    "start": "405880",
    "end": "412960"
  },
  {
    "text": "the PLC private key over the network after that we'll see uh how we",
    "start": "412960",
    "end": "420039"
  },
  {
    "text": "can use this key to launch a stealth man in the metal attack and we'll finish",
    "start": "420039",
    "end": "427360"
  },
  {
    "text": "with summary and mitigations",
    "start": "427360",
    "end": "434440"
  },
  {
    "text": "so so Simmons uses public keys to authenticate uh the",
    "start": "435800",
    "end": "442639"
  },
  {
    "text": "PLC in the previous version all plcs share the exact same um private key now",
    "start": "442639",
    "end": "449560"
  },
  {
    "text": "now in the current version plcs have unique Keys the PLC arrives with an initial",
    "start": "449560",
    "end": "457120"
  },
  {
    "text": "private and public key pair and to bind the identity of the PC to its",
    "start": "457120",
    "end": "466039"
  },
  {
    "text": "key we use Simons uses uh self sign certificates and the PLC created by",
    "start": "466039",
    "end": "473360"
  },
  {
    "text": "signing uh its public key with its private key now",
    "start": "473360",
    "end": "479960"
  },
  {
    "text": "in the first connection with the Tia the PLC sends its self-signed certificate",
    "start": "479960",
    "end": "487919"
  },
  {
    "text": "and since it's the first time that Tia sees the certificate it alerts the user",
    "start": "487919",
    "end": "495560"
  },
  {
    "text": "and asks him whether to trust uh the certificate once the user approves Tia",
    "start": "495560",
    "end": "501639"
  },
  {
    "text": "pins the certificate to the identity of the PLC and tia validates that the same",
    "start": "501639",
    "end": "510479"
  },
  {
    "text": "certificate is used on each connection with the PLC so if Thanos decides to",
    "start": "510479",
    "end": "516360"
  },
  {
    "text": "send his certificate uh to the Tia as plc2 for example uh the user gets the",
    "start": "516360",
    "end": "523440"
  },
  {
    "text": "painting alert and hopefully does not approve so if the customer for various",
    "start": "523440",
    "end": "531480"
  },
  {
    "text": "reasons uh chooses not to trust the initial key uh that the PLC has you can",
    "start": "531480",
    "end": "537920"
  },
  {
    "text": "use a second way where Tia generates the private and public keeper for the PLC",
    "start": "537920",
    "end": "544760"
  },
  {
    "text": "and the certificate then the Tia sends or Provisions the uh keys and certificates",
    "start": "544760",
    "end": "552720"
  },
  {
    "text": "to the plcs and tia can also optionally acts as the certificate Authority",
    "start": "552720",
    "end": "559040"
  },
  {
    "text": "here now the initial provisioning is secured by uh the initial keys and",
    "start": "559040",
    "end": "564079"
  },
  {
    "text": "sement requires that it must be done in a secure environment and the asset owner",
    "start": "564079",
    "end": "569480"
  },
  {
    "text": "is the responsible uh to replace the initial Keys now compared to the first",
    "start": "569480",
    "end": "576440"
  },
  {
    "text": "option where you only need to hit trust in a message box provisioning Keys is",
    "start": "576440",
    "end": "583120"
  },
  {
    "text": "much much more operationally complex Now by a show of hand who here",
    "start": "583120",
    "end": "589240"
  },
  {
    "text": "thinks he can do this provisioning without making any",
    "start": "589240",
    "end": "595200"
  },
  {
    "text": "mistakes wow didn't expect that absolutely no one",
    "start": "595760",
    "end": "602480"
  },
  {
    "text": "okay so the provisioning process occurs in a request called Hardware",
    "start": "602480",
    "end": "607600"
  },
  {
    "text": "configuration download and the configuration is basically the settings of the PLC so it includes uh its network",
    "start": "607600",
    "end": "613880"
  },
  {
    "text": "configuration for example as well as the keys and the certificate now let's see how we can",
    "start": "613880",
    "end": "620839"
  },
  {
    "text": "look into the TLs encryption so those of you who are familiar with PLC reversing",
    "start": "620839",
    "end": "627560"
  },
  {
    "text": "probably know the SF wire shark plug-in that parses the S7 messages but the",
    "start": "627560",
    "end": "633640"
  },
  {
    "text": "plug-in does not work on encrypted traffic so to parse the S7 uh par the",
    "start": "633640",
    "end": "639760"
  },
  {
    "text": "messages we developed our own proxy and this is our infrastructure uh for our research and",
    "start": "639760",
    "end": "647240"
  },
  {
    "text": "for the rest of our taex just as the glove of",
    "start": "647240",
    "end": "652320"
  },
  {
    "text": "tanos so our code receives a tless encrypted",
    "start": "652320",
    "end": "657440"
  },
  {
    "text": "message the crypts and maybe modifies it then re-encrypts it before sending it to",
    "start": "657440",
    "end": "664760"
  },
  {
    "text": "the PLC and this applies for messages from the PLC to the ti as",
    "start": "664760",
    "end": "670600"
  },
  {
    "text": "well so we use our code to implement a packet sfer 4 S7 that creates a pickup",
    "start": "670600",
    "end": "678079"
  },
  {
    "text": "file and out of the S7 messages and allows us to investigate the",
    "start": "678079",
    "end": "684440"
  },
  {
    "text": "protocol uh using the existing wire shark plugging and it's an open source",
    "start": "684440",
    "end": "690760"
  },
  {
    "text": "so you can check it out so now nadav our Avengers expert",
    "start": "690760",
    "end": "699440"
  },
  {
    "text": "will show us how to retrieve the private key from the",
    "start": "699440",
    "end": "704279"
  },
  {
    "text": "PLC uh lessen they're good movies okay so thank you thank you",
    "start": "704760",
    "end": "710079"
  },
  {
    "text": "alone um before we get to our first attack let's first focus on this initial",
    "start": "710079",
    "end": "716079"
  },
  {
    "text": "key provisioning uh our first attack will leverage this provisioning to steal the",
    "start": "716079",
    "end": "721480"
  },
  {
    "text": "plc's private key while it's being transmitted to the",
    "start": "721480",
    "end": "726519"
  },
  {
    "text": "PLC by performing this provisioning the engineer meant to upgrade the system security much like Iron Man meant to",
    "start": "726519",
    "end": "734199"
  },
  {
    "text": "upgrade Earth Security when creating Ultron and in a bit we'll see how that turned",
    "start": "734199",
    "end": "740760"
  },
  {
    "text": "out so let's have a look under the hood on this configuration download first the T initiates a TLS 1.",
    "start": "740760",
    "end": "749279"
  },
  {
    "text": "three handshake with the PLC in response the PLC sends its initial",
    "start": "749279",
    "end": "754839"
  },
  {
    "text": "certificate then after the handshake has completed the ti will send the new",
    "start": "754839",
    "end": "760000"
  },
  {
    "text": "configuration containing the new certificate and and private key but it's",
    "start": "760000",
    "end": "765600"
  },
  {
    "text": "encrypted then the PLC will decrypt the private key and use it on the next",
    "start": "765600",
    "end": "772319"
  },
  {
    "text": "session okay so using our TLS decryption tool we found this packet you're seeing",
    "start": "772760",
    "end": "778120"
  },
  {
    "text": "right now in wihar this packet is sent from the Tia to the PLC and contains a lot of data but most",
    "start": "778120",
    "end": "784880"
  },
  {
    "text": "importantly it contains the private key after doing some reverse engineering we",
    "start": "784880",
    "end": "790079"
  },
  {
    "text": "discovered that in addition to the TLs encryption the private key is encrypted again using some standard algorithms and",
    "start": "790079",
    "end": "797279"
  },
  {
    "text": "a sequence of affirm Ral Keys these are temporary Keys meaning that any attacker with a",
    "start": "797279",
    "end": "804279"
  },
  {
    "text": "te's decryption tool and Ambitions to steal the private key will still have some work cut out for",
    "start": "804279",
    "end": "811519"
  },
  {
    "text": "them okay let's break down the encryption process so Iron Man our",
    "start": "811639",
    "end": "816800"
  },
  {
    "text": "engineer asks Jarvis his virtual assistant to encrypt the private key",
    "start": "816800",
    "end": "821880"
  },
  {
    "text": "which he wishes to provision to the PLC but he asks Jarvis to make it as unintelligibly complex as possible",
    "start": "821880",
    "end": "829160"
  },
  {
    "text": "Darvis responds that luckily there's no need to make an effort he'll just used T Portal's existing",
    "start": "829160",
    "end": "836079"
  },
  {
    "text": "mechanism okay now we're switching to our man's heads of the Play Jarvis opens Tia portal for",
    "start": "836079",
    "end": "843839"
  },
  {
    "text": "him then the Tia takes the new certificate and private key which Iron Man wishes to provision to the",
    "start": "843839",
    "end": "851360"
  },
  {
    "text": "PLC generates a random passphrase and uses this pass phrase to encrypt the private",
    "start": "851399",
    "end": "858440"
  },
  {
    "text": "key okay we're not done yet next the Tia",
    "start": "858600",
    "end": "863639"
  },
  {
    "text": "generates a random RSA key pair and uses this key pair to encrypt the passphrase",
    "start": "863639",
    "end": "871000"
  },
  {
    "text": "okay then the T generate it takes a user defined password hashes it generates a",
    "start": "871000",
    "end": "877160"
  },
  {
    "text": "random salt from both of them deres a key uses this key to encrypt the affirmable private",
    "start": "877160",
    "end": "883639"
  },
  {
    "text": "key takes all of this data and sends it to the PLC on the configuration",
    "start": "883639",
    "end": "889399"
  },
  {
    "text": "download that was exhausting okay so as you can see by IR man's heads up display meter this is a",
    "start": "889399",
    "end": "895759"
  },
  {
    "text": "confusion meter he's pretty confused right now and so are we but all you really need to remember is",
    "start": "895759",
    "end": "901920"
  },
  {
    "text": "that the security of the encryption of the private key all relies on this one password a user defined",
    "start": "901920",
    "end": "908519"
  },
  {
    "text": "password oh and by the way this password is a no string by",
    "start": "908519",
    "end": "914480"
  },
  {
    "text": "default yeah if if if the user does not define a password it just automat",
    "start": "914480",
    "end": "921240"
  },
  {
    "text": "automatically send sets it to a no string okay so when the engineer creates",
    "start": "921240",
    "end": "927320"
  },
  {
    "text": "a new tier project he has promp by this window that asks him if he wants to set up a password it's not mandatory",
    "start": "927320",
    "end": "934880"
  },
  {
    "text": "though if he does set up a password he is uh enforced with a complexity policy",
    "start": "934880",
    "end": "939959"
  },
  {
    "text": "to prevent dictionary attacks okay after the user configure",
    "start": "939959",
    "end": "945399"
  },
  {
    "text": "this password he must share it with the PLC H hopefully securely um well this password is sent",
    "start": "945399",
    "end": "952440"
  },
  {
    "text": "to the PLC on the first configuration download without any additional encryption meaning that any attacker",
    "start": "952440",
    "end": "959959"
  },
  {
    "text": "with a TLS decryption tool can decrypt the TLs and see the password as plain",
    "start": "959959",
    "end": "967279"
  },
  {
    "text": "text and can steal it okay so now that we've learned all of",
    "start": "967480",
    "end": "972800"
  },
  {
    "text": "this we can piece together our first possible attack in this attack the attacker can decrypt and modify all",
    "start": "972800",
    "end": "978720"
  },
  {
    "text": "Communications between the Tia and the PLC uh first the attacker will act as a",
    "start": "978720",
    "end": "985079"
  },
  {
    "text": "man in the middle and intercept the password and private key while they're being transmitted to the PLC he will",
    "start": "985079",
    "end": "991079"
  },
  {
    "text": "take this password and decrypt with it the private key and save it then he will let all other packets pass",
    "start": "991079",
    "end": "997880"
  },
  {
    "text": "through and uh this all happens uh without any",
    "start": "997880",
    "end": "1003319"
  },
  {
    "text": "suspicions this is because um on the first connection no certificate is",
    "start": "1003319",
    "end": "1008480"
  },
  {
    "text": "pinned yet so the Tia must trust the thanos's certificate um this attack is a brand",
    "start": "1008480",
    "end": "1016160"
  },
  {
    "text": "new attack since never before did the Tia transmit a private key to the",
    "start": "1016160",
    "end": "1021360"
  },
  {
    "text": "PLC okay we saw a very powerful attack right now but it's not perfect since not",
    "start": "1021639",
    "end": "1026880"
  },
  {
    "text": "always will the attacker be present when the key is provisioned to the P to the PLC so we must find the attacker must",
    "start": "1026880",
    "end": "1033678"
  },
  {
    "text": "find another opportunity in this part we present an attack with the ability to retrieve the private key directly from",
    "start": "1033679",
    "end": "1039438"
  },
  {
    "text": "the PLC deployed on the production floor but first we need to look at this",
    "start": "1039439",
    "end": "1045720"
  },
  {
    "text": "F at this other attack first this attack is the road Cent attack it allows the attacker to manipulate the operation of",
    "start": "1045720",
    "end": "1052720"
  },
  {
    "text": "the PLC we all we did is we implemented a simple Pon script using op SSL that",
    "start": "1052720",
    "end": "1059520"
  },
  {
    "text": "impersonates IL legitimate Tia since client authentication is not enforced the PC will accept this",
    "start": "1059520",
    "end": "1066840"
  },
  {
    "text": "connection by our impersonation and do is the attacker commands the attacker",
    "start": "1066840",
    "end": "1071880"
  },
  {
    "text": "Comm can command the PC to start or stop or change its",
    "start": "1071880",
    "end": "1077120"
  },
  {
    "text": "configuration okay now we can use this row client attack for our big attack um",
    "start": "1077120",
    "end": "1083600"
  },
  {
    "text": "with this attack the attacker can decrypt and modify all the nwork traffic but at any time even if the user never h",
    "start": "1083600",
    "end": "1091120"
  },
  {
    "text": "generated new keys for the PLC or if the attacker missed the initial key provisioning process alt",
    "start": "1091120",
    "end": "1096919"
  },
  {
    "text": "together okay here's what the attacker does the attacker uses the rad client to send an upload configuration request to",
    "start": "1096919",
    "end": "1103360"
  },
  {
    "text": "the PLC then the PLC responds by sending its configuration that miraculously contains",
    "start": "1103360",
    "end": "1110320"
  },
  {
    "text": "the private key theer should have just asked for a million bucks instead um the attacker takes the",
    "start": "1110320",
    "end": "1117440"
  },
  {
    "text": "password or just a no string if it's not defined and decrypts the private key",
    "start": "1117440",
    "end": "1123039"
  },
  {
    "text": "once the attacker has the private key in his position he can use it to decrypt all the plc's network traffic at any",
    "start": "1123039",
    "end": "1131000"
  },
  {
    "text": "time okay we've seen multiple attacks let's look at the difference between",
    "start": "1131080",
    "end": "1136400"
  },
  {
    "text": "attack number one and attack number three which both steal the plc's private key well compared to attack number one",
    "start": "1136400",
    "end": "1142880"
  },
  {
    "text": "attack three can be performed at any time it doesn't have to be in the initial provisioning uh Attack 3 only needs",
    "start": "1142880",
    "end": "1149480"
  },
  {
    "text": "network access to the PLC opposed to the initial key provisioning attack which needs to be needs access both to the PLC",
    "start": "1149480",
    "end": "1155880"
  },
  {
    "text": "and the Tia since it acts as a man in the middle uh both attacks can be performed when the user has not defined a password",
    "start": "1155880",
    "end": "1162520"
  },
  {
    "text": "since in that case it is a n string and if the user has defined a password well",
    "start": "1162520",
    "end": "1167640"
  },
  {
    "text": "attack number three needs to get it either via a leak or attack number one which seals the",
    "start": "1167640",
    "end": "1174440"
  },
  {
    "text": "password okay great now we'll move to our next attacks on to you",
    "start": "1175080",
    "end": "1181799"
  },
  {
    "text": "alone thank you n so now we have in hand two independent",
    "start": "1181919",
    "end": "1188880"
  },
  {
    "text": "ways to fetch the private key of the PLC now let let's move on to our stealth",
    "start": "1188880",
    "end": "1195120"
  },
  {
    "text": "man in the middle and we split this part to three attacks",
    "start": "1195120",
    "end": "1200640"
  },
  {
    "text": "going back a little bit let's see how our Rogue client can inject a malicious",
    "start": "1201400",
    "end": "1208039"
  },
  {
    "text": "control program to the PLC so during the program",
    "start": "1208039",
    "end": "1214159"
  },
  {
    "text": "transmission the program passes in an encrypted form from the Tia to the PLC",
    "start": "1214159",
    "end": "1220679"
  },
  {
    "text": "and what we'll see here is a highly simplified AB abstraction we removed here layers of",
    "start": "1220679",
    "end": "1227080"
  },
  {
    "text": "obscurity so to increase the program Tia generates a random seed and uses it to",
    "start": "1227080",
    "end": "1233679"
  },
  {
    "text": "derive an a key for the program encryption then Tia takes the seed and",
    "start": "1233679",
    "end": "1241520"
  },
  {
    "text": "encrypts it under a hardcoded key that is shared between PLC",
    "start": "1241520",
    "end": "1248640"
  },
  {
    "text": "models during transmission Tia takes the encrypted seed and the encrypted program",
    "start": "1248640",
    "end": "1257159"
  },
  {
    "text": "and sends them both to the PLC and this scheme is vulnerable to",
    "start": "1257159",
    "end": "1263360"
  },
  {
    "text": "replay attack as since a program sent to",
    "start": "1263360",
    "end": "1269080"
  },
  {
    "text": "one PLC will be accepted by a different PLC so in attack number four the",
    "start": "1269080",
    "end": "1277080"
  },
  {
    "text": "attacker creates a malicious control program in his own lab with his own",
    "start": "1277080",
    "end": "1284000"
  },
  {
    "text": "PLC and then he can use a rogue client to load it to any PLC in the world",
    "start": "1284000",
    "end": "1291760"
  },
  {
    "text": "whether it is in new New York Tokyo or even new",
    "start": "1291760",
    "end": "1297279"
  },
  {
    "text": "Asgard and it exploits the fact that the program is independent of the",
    "start": "1297279",
    "end": "1302520"
  },
  {
    "text": "destination PLC uh due to the shared keys and even the protocol itself tells",
    "start": "1302520",
    "end": "1310919"
  },
  {
    "text": "you it is a bad idea and this is a real",
    "start": "1310919",
    "end": "1316120"
  },
  {
    "text": "magic from the program encryption in the",
    "start": "1316120",
    "end": "1320520"
  },
  {
    "text": "protocol so now our the victim PLC runs a malicious control program let's see",
    "start": "1321480",
    "end": "1328200"
  },
  {
    "text": "now how an attacker can hide it so attack number four is Rogue PLC in",
    "start": "1328200",
    "end": "1334679"
  },
  {
    "text": "this attack the attacker impersonates the PLC and tricks the Tia into thinking",
    "start": "1334679",
    "end": "1341720"
  },
  {
    "text": "it is the legitimate PLC now this allows the attacker to f",
    "start": "1341720",
    "end": "1348559"
  },
  {
    "text": "fake status messages sent to the Tia now since the",
    "start": "1348559",
    "end": "1355480"
  },
  {
    "text": "attacker uses the actual keys and certificate of the real PLC in the NJ",
    "start": "1355480",
    "end": "1364080"
  },
  {
    "text": "Tia does not show the warning message because it sees the certificate",
    "start": "1364080",
    "end": "1369400"
  },
  {
    "text": "it expected it expect to see so this is how the attacker bypasses the",
    "start": "1369400",
    "end": "1375159"
  },
  {
    "text": "certificate pinning mechanism and Rogue PLC is a new attack that was",
    "start": "1375159",
    "end": "1382200"
  },
  {
    "text": "not applicable on the previous protocol",
    "start": "1382200",
    "end": "1387120"
  },
  {
    "text": "version so here is our sixth and final attack this attack the attacker",
    "start": "1389039",
    "end": "1396600"
  },
  {
    "text": "recreates the impact of stocks net on the latest version of",
    "start": "1396600",
    "end": "1402480"
  },
  {
    "text": "S7 so the PLC already runs a malicious control program and the attack causes",
    "start": "1402480",
    "end": "1409240"
  },
  {
    "text": "damage to production now at the same",
    "start": "1409240",
    "end": "1414400"
  },
  {
    "text": "time when the operators ask the PLC what on Earth is going on",
    "start": "1414400",
    "end": "1422000"
  },
  {
    "text": "here the attacker a man in the middle manipulates the PLC responses to present",
    "start": "1422000",
    "end": "1429960"
  },
  {
    "text": "a false but legitimate state of the process the Tia presents to the",
    "start": "1429960",
    "end": "1437159"
  },
  {
    "text": "users so what's going on here this means that on one side the attacker deceives",
    "start": "1437159",
    "end": "1445000"
  },
  {
    "text": "The Operators but on the other side the attacker creates complete chaos in",
    "start": "1445000",
    "end": "1453200"
  },
  {
    "text": "production now we see here a full man in the midle attack where the attacker",
    "start": "1453200",
    "end": "1459720"
  },
  {
    "text": "receives an encrypted TLS message decrypts and modifies it then",
    "start": "1459720",
    "end": "1466679"
  },
  {
    "text": "re-encrypts it before for foring it to its",
    "start": "1466679",
    "end": "1472240"
  },
  {
    "text": "destination as before there is no warning message on the Tia and the",
    "start": "1472480",
    "end": "1479600"
  },
  {
    "text": "attacker can change anything inside the S7",
    "start": "1479600",
    "end": "1485919"
  },
  {
    "text": "messages so here's a summary of our attacks all our new attacks exploit the",
    "start": "1486279",
    "end": "1493600"
  },
  {
    "text": "fact that seams protocol transmits private Keys over the network",
    "start": "1493600",
    "end": "1499360"
  },
  {
    "text": "and their protection is not as strong as one might",
    "start": "1499360",
    "end": "1505520"
  },
  {
    "text": "think so given that we have four neotex",
    "start": "1505520",
    "end": "1510640"
  },
  {
    "text": "it is clear that the security of the S7 protocol is essentially not improved and",
    "start": "1510640",
    "end": "1520360"
  },
  {
    "text": "even degraded so now let's see our demo",
    "start": "1520360",
    "end": "1528398"
  },
  {
    "text": "thank you so let's get to the moment you've all been waiting for a",
    "start": "1529080",
    "end": "1536000"
  },
  {
    "text": "demonstration so what you're seeing before you right now are three Windows",
    "start": "1536000",
    "end": "1541039"
  },
  {
    "text": "the first is the engineer Iron Man's window he has the Tia portal open the",
    "start": "1541039",
    "end": "1546880"
  },
  {
    "text": "next is Thanos our attacker his window is on our propriatary attack tool named",
    "start": "1546880",
    "end": "1553559"
  },
  {
    "text": "spark or sematic proxy attack using retriev key and the final window is our",
    "start": "1553559",
    "end": "1559919"
  },
  {
    "text": "PLC cam showing the PLC status on the production floor um as you can see an Ironman",
    "start": "1559919",
    "end": "1566520"
  },
  {
    "text": "figurine sits at top it since Iron Man's code is currently inside the PC okay let's start so first off our man",
    "start": "1566520",
    "end": "1575320"
  },
  {
    "text": "tries to start the PLC no attack is being done yet so he speaks directly with the",
    "start": "1575320",
    "end": "1582080"
  },
  {
    "text": "PLC and he has started the PLC code and his code turns on One Singular lead as",
    "start": "1582080",
    "end": "1587600"
  },
  {
    "text": "you can see an LED now Thanos wants to attack this PLC",
    "start": "1587600",
    "end": "1592960"
  },
  {
    "text": "he wants to inject his own code into the PLC so he will use our Ro client attack",
    "start": "1592960",
    "end": "1598200"
  },
  {
    "text": "to issue to do a program download request with his own down own code now we're seeing the packet flying",
    "start": "1598200",
    "end": "1606279"
  },
  {
    "text": "from F's window to the PC this is a t impersonation attack",
    "start": "1606279",
    "end": "1613880"
  },
  {
    "text": "and I hope there remember you wow okay so Thanos has completely",
    "start": "1616679",
    "end": "1623840"
  },
  {
    "text": "changed the code demo over we can go home okay not really so Iron Man in his",
    "start": "1623840",
    "end": "1629720"
  },
  {
    "text": "TI portal can monitor the PC's activity it's what he's doing right now he is",
    "start": "1629720",
    "end": "1634840"
  },
  {
    "text": "going to the uh watch table hitting the button monitor all and seeing the current PC status this is quite",
    "start": "1634840",
    "end": "1642440"
  },
  {
    "text": "suspicious he's expecting to see One LED on and he's seeing all of these led turning on and and he will he will see",
    "start": "1642440",
    "end": "1650080"
  },
  {
    "text": "this and be suspicious so Thanos has to do something cleverer he needs to do a",
    "start": "1650080",
    "end": "1655799"
  },
  {
    "text": "man in the middle attack so right now Thanos is starting his man INE middle",
    "start": "1655799",
    "end": "1660960"
  },
  {
    "text": "attack and all packets that our man will transmit to the PLC will flow through",
    "start": "1660960",
    "end": "1667480"
  },
  {
    "text": "him this is a simple man in the middle",
    "start": "1668039",
    "end": "1673398"
  },
  {
    "text": "great now the man in the middle is up and running now when iron man tries to start",
    "start": "1678640",
    "end": "1683840"
  },
  {
    "text": "the PLC all the packets will throw flow through Fels but wait this warning is",
    "start": "1683840",
    "end": "1690720"
  },
  {
    "text": "issued in the Tia portal this is quite suspicious suspicious it tells Iron Man",
    "start": "1690720",
    "end": "1696559"
  },
  {
    "text": "that the certificate he just received in the tless handshake is not the plcs rather it's an attackers certificate so",
    "start": "1696559",
    "end": "1704440"
  },
  {
    "text": "a smart engineer like Iron Man will promptly abort this connection",
    "start": "1704440",
    "end": "1710120"
  },
  {
    "text": "aborted okay Thanos needs to get even better he needs to use our PLC private",
    "start": "1712440",
    "end": "1719080"
  },
  {
    "text": "key retrieval attack he will use our road client again to extract the key",
    "start": "1719080",
    "end": "1725360"
  },
  {
    "text": "directly from the PLC by a um transmitting an upload",
    "start": "1725360",
    "end": "1730399"
  },
  {
    "text": "configuration request as we saw earlier again this is a tear",
    "start": "1730399",
    "end": "1736080"
  },
  {
    "text": "impersonation no client authentication is in forc so",
    "start": "1736080",
    "end": "1741519"
  },
  {
    "text": "he can do this he gets the configuration and decrypts it using an N string since it's",
    "start": "1741519",
    "end": "1747399"
  },
  {
    "text": "by default a n string and here before you you can see the plc's current certificate and private key this is",
    "start": "1747399",
    "end": "1755720"
  },
  {
    "text": "decrypted so now he will be using this in the next",
    "start": "1755720",
    "end": "1761000"
  },
  {
    "text": "connection so now when iron man tries to stop the PLC Thanos uses the correct certificate and no warning is it",
    "start": "1761799",
    "end": "1769080"
  },
  {
    "text": "issued you could not live with your own failure wow okay no warning this is us",
    "start": "1769080",
    "end": "1776279"
  },
  {
    "text": "we added this window so uh now what happens when Iron Man monitors the py",
    "start": "1776279",
    "end": "1782519"
  },
  {
    "text": "activity so again IR man hits go online goes to the watch table window but this",
    "start": "1782519",
    "end": "1789519"
  },
  {
    "text": "time Thanos meddles with the packets that the PC televises and changes",
    "start": "1789519",
    "end": "1794960"
  },
  {
    "text": "changes changes its status to a forged status a status that Iron Man is expecting to see One Singular",
    "start": "1794960",
    "end": "1802960"
  },
  {
    "text": "LED now Iron Man is hitting monitor all and you can see the differences",
    "start": "1802960",
    "end": "1808480"
  },
  {
    "text": "between what's reality can be whatever I want yeah real reality really can be",
    "start": "1808480",
    "end": "1813519"
  },
  {
    "text": "whatever you wants it's a difference is PLC Thanos code tortal Forge",
    "start": "1813519",
    "end": "1821799"
  },
  {
    "text": "status awesome so now let's get to our second demonstration and this",
    "start": "1822000",
    "end": "1828120"
  },
  {
    "text": "demonstration we will show you how thanel can steal the password while it's being provisioned so now our man opens a",
    "start": "1828120",
    "end": "1835679"
  },
  {
    "text": "new tier project and this time he will set up the password instead of it being a no",
    "start": "1835679",
    "end": "1841398"
  },
  {
    "text": "string he needs to answer he needs to enter it",
    "start": "1843279",
    "end": "1847919"
  },
  {
    "text": "twice great now he will go forward with creating the project we are fast forward",
    "start": "1850320",
    "end": "1856480"
  },
  {
    "text": "this fast forwarding this process",
    "start": "1856480",
    "end": "1859919"
  },
  {
    "text": "and now he's entering his certificate manager in the T portal which shows us the new certificate that has been",
    "start": "1862000",
    "end": "1867760"
  },
  {
    "text": "generated with the private key encrypted by the by the password now our man is trying to",
    "start": "1867760",
    "end": "1874600"
  },
  {
    "text": "download the configuration Thanos has not attacked anything yet so this is regular transmission from from the Tia",
    "start": "1874600",
    "end": "1881120"
  },
  {
    "text": "to the PLC and we're showing you this because we want to show you that he still he gets this warning this warning there's",
    "start": "1881120",
    "end": "1888360"
  },
  {
    "text": "no attack being made right now so this warning is totally regular and it happens since no certificate is penned",
    "start": "1888360",
    "end": "1893639"
  },
  {
    "text": "yet Iron Man must trust this if he wants to provision his own",
    "start": "1893639",
    "end": "1898679"
  },
  {
    "text": "password so now we have activated thanos's man in the middle and this time",
    "start": "1898679",
    "end": "1905600"
  },
  {
    "text": "when Iron Man downloads his configuration it flows through Iron Man through thanos's man in the middle",
    "start": "1905600",
    "end": "1913880"
  },
  {
    "text": "now what happens is before uh Iron Man Provisions the the password he needs to",
    "start": "1918960",
    "end": "1924360"
  },
  {
    "text": "enter it one last time okay yeah so what you're seeing now",
    "start": "1924360",
    "end": "1930799"
  },
  {
    "text": "is the same warning we saw before so it won't be suspicious exact same warning when there's no attack being made",
    "start": "1930799",
    "end": "1936799"
  },
  {
    "text": "right so again a man in the middle same warning not suspicious now armman will",
    "start": "1936799",
    "end": "1942320"
  },
  {
    "text": "enter his password one less time before provisioning it",
    "start": "1942320",
    "end": "1947600"
  },
  {
    "text": "there it is he's typing it in in this T",
    "start": "1950720",
    "end": "1958000"
  },
  {
    "text": "portal and sending it to the PLC now AOS is intercepting these",
    "start": "1958960",
    "end": "1966000"
  },
  {
    "text": "packets um decrypting the TLs and will steal the",
    "start": "1966000",
    "end": "1972440"
  },
  {
    "text": "password if we go to thanos's logs from his attack tool we can search for the",
    "start": "1972440",
    "end": "1978720"
  },
  {
    "text": "extraction of the the password and we can see our man password is I love you",
    "start": "1978720",
    "end": "1984919"
  },
  {
    "text": "3000 awesome so we just saw two powerful attacks in the demonstration that Thanos can do with a",
    "start": "1988960",
    "end": "1996399"
  },
  {
    "text": "snap of his finger on you",
    "start": "1996399",
    "end": "2000559"
  },
  {
    "text": "alone thank you so as the demo clearly shows using",
    "start": "2001720",
    "end": "2009600"
  },
  {
    "text": "the combination of the six attacks Thanos can completely take over any",
    "start": "2009600",
    "end": "2016720"
  },
  {
    "text": "cyber physical system while hiding its malicious",
    "start": "2016720",
    "end": "2021840"
  },
  {
    "text": "activity so next let's see how we can mitigate these attacks and this is kind",
    "start": "2021840",
    "end": "2027639"
  },
  {
    "text": "of a good news bad news situation the good news is that all",
    "start": "2027639",
    "end": "2032799"
  },
  {
    "text": "these attacks can be mitigated using semen mechanisms",
    "start": "2032799",
    "end": "2038440"
  },
  {
    "text": "all you have to do is to use passwords so you'll need to set the PC",
    "start": "2038440",
    "end": "2046000"
  },
  {
    "text": "configuration password you'll need to set the CPU access protection password that",
    "start": "2046000",
    "end": "2052919"
  },
  {
    "text": "restricts access to certain privileged operations on the",
    "start": "2052919",
    "end": "2058398"
  },
  {
    "text": "PLC if you want to use the TA as the certificate Authority you'll also Define",
    "start": "2058399",
    "end": "2065839"
  },
  {
    "text": "a password for user in the Tia and if you want to protect your",
    "start": "2065839",
    "end": "2072638"
  },
  {
    "text": "control program oh you'll use knoow protection",
    "start": "2072639",
    "end": "2081319"
  },
  {
    "text": "password and all passwords must be strong passwords must be unique per",
    "start": "2081520",
    "end": "2090720"
  },
  {
    "text": "PLC and this is the bad news large organizations typically have",
    "start": "2091200",
    "end": "2097760"
  },
  {
    "text": "many users stations and plc's managing this amount of password",
    "start": "2097760",
    "end": "2106320"
  },
  {
    "text": "probably a nightmare and this is a pain in Nick fur's",
    "start": "2106320",
    "end": "2112480"
  },
  {
    "text": "asset so the typical solution is uh to",
    "start": "2112480",
    "end": "2118079"
  },
  {
    "text": "either totally disable passwords or to define the same password",
    "start": "2118079",
    "end": "2124839"
  },
  {
    "text": "for all plc's which is also bad now it's not enough to configure the",
    "start": "2124839",
    "end": "2131880"
  },
  {
    "text": "passwords even if you did now you have to protect them you'll need to protect",
    "start": "2131880",
    "end": "2137040"
  },
  {
    "text": "them from leakages and you'll need to protect them from password Steelers out in the wild and you also need to protect",
    "start": "2137040",
    "end": "2145480"
  },
  {
    "text": "them from Post-its now we also like to uh point",
    "start": "2145480",
    "end": "2153079"
  },
  {
    "text": "out that certificates signed by trusted certific ific",
    "start": "2153079",
    "end": "2158720"
  },
  {
    "text": "Authority won't help you if the private key is",
    "start": "2158720",
    "end": "2165838"
  },
  {
    "text": "exposed so we disclosed our findings to seens and seens is aware that uh when",
    "start": "2167160",
    "end": "2173880"
  },
  {
    "text": "the configuration password is not set extracting the private key of the PLC is",
    "start": "2173880",
    "end": "2179760"
  },
  {
    "text": "possible Simmons recommend uh the customers to",
    "start": "2179760",
    "end": "2185359"
  },
  {
    "text": "first uh perform the initial provisioning in a secure and hardened",
    "start": "2185359",
    "end": "2192079"
  },
  {
    "text": "and isolated environment and you remember that we",
    "start": "2192079",
    "end": "2198400"
  },
  {
    "text": "don't need to catch the initial provisioning to attack the system",
    "start": "2198400",
    "end": "2203599"
  },
  {
    "text": "right and second seems recommends to use passwords passwords and",
    "start": "2203599",
    "end": "2210359"
  },
  {
    "text": "password so when the world goes to the direction of password L we see here the",
    "start": "2210359",
    "end": "2217599"
  },
  {
    "text": "opposite direction and basically the burden of security is rolled to the",
    "start": "2217599",
    "end": "2223400"
  },
  {
    "text": "customers like a hot potato now if we talk about the protocol",
    "start": "2223400",
    "end": "2230720"
  },
  {
    "text": "design there are four things we can do first the protocol must provide Mutual",
    "start": "2230720",
    "end": "2236839"
  },
  {
    "text": "authentication this means that the client authenticates the server and the server authenticates the client TLS this",
    "start": "2236839",
    "end": "2243599"
  },
  {
    "text": "could be achieved uh by uh client certificates",
    "start": "2243599",
    "end": "2249240"
  },
  {
    "text": "second the PLC must never send out its private key it's simply too valuable and",
    "start": "2249240",
    "end": "2256480"
  },
  {
    "text": "without it we don't have security third self-signed certificates",
    "start": "2256480",
    "end": "2262839"
  },
  {
    "text": "should be avoided for initialization it is more secure to use vendor",
    "start": "2262839",
    "end": "2269160"
  },
  {
    "text": "certificates in fact some PC models already use them our PLC model does not",
    "start": "2269160",
    "end": "2277079"
  },
  {
    "text": "use them though and last but not least um it is a",
    "start": "2277079",
    "end": "2282800"
  },
  {
    "text": "bad practice to send a key uh with its Cipher text it is more secure to use key",
    "start": "2282800",
    "end": "2290000"
  },
  {
    "text": "exchange protocol and we saw two examples for it in the program encryption and in the",
    "start": "2290000",
    "end": "2297319"
  },
  {
    "text": "initialization uh where the private key is sent along with uh the password that",
    "start": "2297319",
    "end": "2303480"
  },
  {
    "text": "protect it now we offer a new scalable",
    "start": "2303480",
    "end": "2311880"
  },
  {
    "text": "authentication and authorization protocol with many advantages that does not require uh to manage this amount of",
    "start": "2311880",
    "end": "2320640"
  },
  {
    "text": "uh different passwords and you should have a look at our paper uh the details are in the",
    "start": "2320640",
    "end": "2331560"
  },
  {
    "text": "slide so we like to end with a",
    "start": "2333319",
    "end": "2338800"
  },
  {
    "text": "message so whether you choose to use TLS",
    "start": "2338800",
    "end": "2344079"
  },
  {
    "text": "or IPC or certificate authorities demand secure",
    "start": "2344079",
    "end": "2350040"
  },
  {
    "text": "products demand secure products you are the asset owner and you",
    "start": "2350040",
    "end": "2356359"
  },
  {
    "text": "are responsible that nothing explodes on your",
    "start": "2356359",
    "end": "2361960"
  },
  {
    "text": "site thank you very much guys for joining us I hope you enjoyed it and",
    "start": "2361960",
    "end": "2367400"
  },
  {
    "text": "we'll stick around for uh uh some Q&A in their rap room thank you",
    "start": "2367400",
    "end": "2372730"
  },
  {
    "text": "[Applause]",
    "start": "2372730",
    "end": "2377989"
  }
]