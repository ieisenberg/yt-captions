[
  {
    "text": "[Music]",
    "start": "1740",
    "end": "3720"
  },
  {
    "text": "foreign",
    "start": "3720",
    "end": "6720"
  },
  {
    "text": "[Music]",
    "start": "9270",
    "end": "12330"
  },
  {
    "text": "about the windows common log file system",
    "start": "20359",
    "end": "24180"
  },
  {
    "text": "our topic name is the next generation of",
    "start": "24180",
    "end": "27060"
  },
  {
    "text": "Windows exploitation attacking the",
    "start": "27060",
    "end": "29519"
  },
  {
    "text": "common log file system",
    "start": "29519",
    "end": "32480"
  },
  {
    "text": "recording in progress",
    "start": "34559",
    "end": "38059"
  },
  {
    "text": "this is our self-introduction we are",
    "start": "38940",
    "end": "42239"
  },
  {
    "text": "security researchers from qihu",
    "start": "42239",
    "end": "44219"
  },
  {
    "text": "vulnerability Research Institute and",
    "start": "44219",
    "end": "46739"
  },
  {
    "text": "here is our Twitter",
    "start": "46739",
    "end": "48480"
  },
  {
    "text": "we are currently main focused on the",
    "start": "48480",
    "end": "50640"
  },
  {
    "text": "Windows platform bar County",
    "start": "50640",
    "end": "54079"
  },
  {
    "text": "here is our agenda I will introduce some",
    "start": "59399",
    "end": "62579"
  },
  {
    "text": "background knowledge about common log",
    "start": "62579",
    "end": "64920"
  },
  {
    "text": "file system then I will share how we",
    "start": "64920",
    "end": "67740"
  },
  {
    "text": "fast these targets and I will pick two",
    "start": "67740",
    "end": "70140"
  },
  {
    "text": "classic cases for vulnerability analyze",
    "start": "70140",
    "end": "75020"
  },
  {
    "text": "will show you how we used a new method",
    "start": "75020",
    "end": "78360"
  },
  {
    "text": "to exploit the TFO cup vulnerability",
    "start": "78360",
    "end": "82880"
  },
  {
    "text": "first what is common log file system",
    "start": "86820",
    "end": "89420"
  },
  {
    "text": "this content is expired from msdn",
    "start": "89420",
    "end": "93600"
  },
  {
    "text": "the common log file system is a new",
    "start": "93600",
    "end": "95700"
  },
  {
    "text": "locking mechanism introduced by Windows",
    "start": "95700",
    "end": "98280"
  },
  {
    "text": "Vista which is responsible for providing",
    "start": "98280",
    "end": "101280"
  },
  {
    "text": "a high performance Universal log file",
    "start": "101280",
    "end": "103860"
  },
  {
    "text": "subsystem that dedicate his silent",
    "start": "103860",
    "end": "106439"
  },
  {
    "text": "applications can use",
    "start": "106439",
    "end": "107939"
  },
  {
    "text": "multiple silence can share to optimize",
    "start": "107939",
    "end": "110340"
  },
  {
    "text": "log axis",
    "start": "110340",
    "end": "111780"
  },
  {
    "text": "any user mode application that needs",
    "start": "111780",
    "end": "114420"
  },
  {
    "text": "login or recovery support can use common",
    "start": "114420",
    "end": "116700"
  },
  {
    "text": "log file system",
    "start": "116700",
    "end": "119600"
  },
  {
    "text": "we can create or open a log file with",
    "start": "123240",
    "end": "126180"
  },
  {
    "text": "the create log file function",
    "start": "126180",
    "end": "128459"
  },
  {
    "text": "the log can be dedicated or multiplexed",
    "start": "128459",
    "end": "131459"
  },
  {
    "text": "and that depends on the log file name",
    "start": "131459",
    "end": "135000"
  },
  {
    "text": "you can use the closed handle function",
    "start": "135000",
    "end": "137640"
  },
  {
    "text": "to close the log",
    "start": "137640",
    "end": "140220"
  },
  {
    "text": "we can get the function of the Operation",
    "start": "140220",
    "end": "142860"
  },
  {
    "text": "Log by curing msdn or we can get the",
    "start": "142860",
    "end": "146640"
  },
  {
    "text": "optical by reversing the clfs system",
    "start": "146640",
    "end": "149340"
  },
  {
    "text": "driver",
    "start": "149340",
    "end": "151640"
  },
  {
    "text": "before starting our research we checked",
    "start": "156599",
    "end": "159180"
  },
  {
    "text": "out some great resources from Alice",
    "start": "159180",
    "end": "161280"
  },
  {
    "text": "Eunice could collab and Cisco tellers",
    "start": "161280",
    "end": "165180"
  },
  {
    "text": "their research can give us a faster",
    "start": "165180",
    "end": "167280"
  },
  {
    "text": "understanding of this new attack surface",
    "start": "167280",
    "end": "171360"
  },
  {
    "text": "foreign",
    "start": "171360",
    "end": "174080"
  },
  {
    "text": "research we can summarize the following",
    "start": "177440",
    "end": "180239"
  },
  {
    "text": "two attack surface",
    "start": "180239",
    "end": "181980"
  },
  {
    "text": "first is log file parsing vulnerability",
    "start": "181980",
    "end": "184500"
  },
  {
    "text": "in clf system driver and second is error",
    "start": "184500",
    "end": "188940"
  },
  {
    "text": "handling of vial code vulnerability in",
    "start": "188940",
    "end": "190680"
  },
  {
    "text": "clfs system driver",
    "start": "190680",
    "end": "194239"
  },
  {
    "text": "so we did research on the blf file",
    "start": "198599",
    "end": "201480"
  },
  {
    "text": "format",
    "start": "201480",
    "end": "202680"
  },
  {
    "text": "this is a structure of a base log file",
    "start": "202680",
    "end": "205620"
  },
  {
    "text": "and we can find the location of the",
    "start": "205620",
    "end": "208140"
  },
  {
    "text": "structure in the pretty blf file",
    "start": "208140",
    "end": "212360"
  },
  {
    "text": "after analyzing the file format we",
    "start": "218580",
    "end": "220860"
  },
  {
    "text": "consider how to pass it the desired idea",
    "start": "220860",
    "end": "223799"
  },
  {
    "text": "of our files is very simple just create",
    "start": "223799",
    "end": "226620"
  },
  {
    "text": "a log random log file data by structure",
    "start": "226620",
    "end": "229560"
  },
  {
    "text": "and the parts log file data",
    "start": "229560",
    "end": "233540"
  },
  {
    "text": "first we need to create a log which can",
    "start": "237420",
    "end": "240420"
  },
  {
    "text": "be achieved through the create log file",
    "start": "240420",
    "end": "242459"
  },
  {
    "text": "function mentioned earlier",
    "start": "242459",
    "end": "244500"
  },
  {
    "text": "and log files are divided into dedicated",
    "start": "244500",
    "end": "247319"
  },
  {
    "text": "log file and Multiplex the log file",
    "start": "247319",
    "end": "251040"
  },
  {
    "text": "there are also some functions for",
    "start": "251040",
    "end": "253080"
  },
  {
    "text": "container operations in the log",
    "start": "253080",
    "end": "255299"
  },
  {
    "text": "so we can also choose whether to add a",
    "start": "255299",
    "end": "257820"
  },
  {
    "text": "container or not",
    "start": "257820",
    "end": "260660"
  },
  {
    "text": "by reverse the coeff system driver we",
    "start": "266940",
    "end": "270240"
  },
  {
    "text": "can find that there is a CRC check",
    "start": "270240",
    "end": "272400"
  },
  {
    "text": "whenever the blf file is parsed",
    "start": "272400",
    "end": "275820"
  },
  {
    "text": "the following is a studio code",
    "start": "275820",
    "end": "278880"
  },
  {
    "text": "so we need to bypass this check before",
    "start": "278880",
    "end": "281400"
  },
  {
    "text": "random file data",
    "start": "281400",
    "end": "285199"
  },
  {
    "text": "reverse the comfs system driver we can",
    "start": "293880",
    "end": "297600"
  },
  {
    "text": "find that some functions starting with",
    "start": "297600",
    "end": "299820"
  },
  {
    "text": "gate and acquire will read data from the",
    "start": "299820",
    "end": "303180"
  },
  {
    "text": "blf file such as get baselog record get",
    "start": "303180",
    "end": "307139"
  },
  {
    "text": "control record acquirement data block",
    "start": "307139",
    "end": "309740"
  },
  {
    "text": "acquired Trace content",
    "start": "309740",
    "end": "312240"
  },
  {
    "text": "and so on so when mailing randomized",
    "start": "312240",
    "end": "315540"
  },
  {
    "text": "this structure when fighting",
    "start": "315540",
    "end": "318800"
  },
  {
    "text": "this structure is reversed by in Ida",
    "start": "322380",
    "end": "327680"
  },
  {
    "text": "after random log file data we need to",
    "start": "331800",
    "end": "334320"
  },
  {
    "text": "call some functions to parse the log",
    "start": "334320",
    "end": "337400"
  },
  {
    "text": "we can know from msdn that there are the",
    "start": "337400",
    "end": "341699"
  },
  {
    "text": "following types of functions",
    "start": "341699",
    "end": "344100"
  },
  {
    "text": "long storage record chance reservation",
    "start": "344100",
    "end": "347699"
  },
  {
    "text": "log achieve and restore there are also",
    "start": "347699",
    "end": "351300"
  },
  {
    "text": "some types of operation functions can be",
    "start": "351300",
    "end": "354120"
  },
  {
    "text": "found in msdn or reverse inclfa system",
    "start": "354120",
    "end": "357840"
  },
  {
    "text": "driver",
    "start": "357840",
    "end": "358979"
  },
  {
    "text": "so I don't list them all here",
    "start": "358979",
    "end": "361560"
  },
  {
    "text": "in summary our firstly our father",
    "start": "361560",
    "end": "364800"
  },
  {
    "text": "created a blf file of a random type",
    "start": "364800",
    "end": "367979"
  },
  {
    "text": "secondly randomize the blf file in the",
    "start": "367979",
    "end": "371900"
  },
  {
    "text": "content according to the structure we",
    "start": "371900",
    "end": "374880"
  },
  {
    "text": "mentioned earlier",
    "start": "374880",
    "end": "376380"
  },
  {
    "text": "the way bypass the CRC check and finally",
    "start": "376380",
    "end": "379919"
  },
  {
    "text": "call some functions to read the file",
    "start": "379919",
    "end": "382500"
  },
  {
    "text": "content for operation",
    "start": "382500",
    "end": "385819"
  },
  {
    "text": "after fasting for a while we got some",
    "start": "392220",
    "end": "394740"
  },
  {
    "text": "crashes",
    "start": "394740",
    "end": "396300"
  },
  {
    "text": "I will analyze two of them",
    "start": "396300",
    "end": "399300"
  },
  {
    "text": "the first vulnerability is related to",
    "start": "399300",
    "end": "401819"
  },
  {
    "text": "the clfs control record structure which",
    "start": "401819",
    "end": "405360"
  },
  {
    "text": "is located at the bla file offset 0x70",
    "start": "405360",
    "end": "410939"
  },
  {
    "text": "we can find the three Fields e extension",
    "start": "411000",
    "end": "414000"
  },
  {
    "text": "State I extension block and I flash",
    "start": "414000",
    "end": "416520"
  },
  {
    "text": "block according to the offset in the",
    "start": "416520",
    "end": "418979"
  },
  {
    "text": "clfs control record structure",
    "start": "418979",
    "end": "423539"
  },
  {
    "text": "this Rift fields are marked in the Red",
    "start": "423539",
    "end": "426240"
  },
  {
    "text": "Blocks here",
    "start": "426240",
    "end": "428400"
  },
  {
    "text": "each extension State Fields identifies",
    "start": "428400",
    "end": "430620"
  },
  {
    "text": "the current extension State for the file",
    "start": "430620",
    "end": "433620"
  },
  {
    "text": "in this case we see it's true which",
    "start": "433620",
    "end": "436500"
  },
  {
    "text": "means clfs extend State flash block",
    "start": "436500",
    "end": "440819"
  },
  {
    "text": "setting Institute is for the program to",
    "start": "440819",
    "end": "443639"
  },
  {
    "text": "reach the vulnerable function shift",
    "start": "443639",
    "end": "445860"
  },
  {
    "text": "Manta data block described",
    "start": "445860",
    "end": "449538"
  },
  {
    "text": "I extension block field identifies the",
    "start": "449699",
    "end": "452340"
  },
  {
    "text": "index of the block being extended in",
    "start": "452340",
    "end": "455400"
  },
  {
    "text": "this case we say 824",
    "start": "455400",
    "end": "458759"
  },
  {
    "text": "I flash block fails identifies the block",
    "start": "458759",
    "end": "461460"
  },
  {
    "text": "being flashed",
    "start": "461460",
    "end": "463139"
  },
  {
    "text": "in this case we say it's 3.",
    "start": "463139",
    "end": "467419"
  },
  {
    "text": "the root cause of the vulnerability is",
    "start": "471620",
    "end": "474660"
  },
  {
    "text": "that when the shift metadata block",
    "start": "474660",
    "end": "476819"
  },
  {
    "text": "descriptor function Parts the blf file",
    "start": "476819",
    "end": "480300"
  },
  {
    "text": "the eye extension block and I flash",
    "start": "480300",
    "end": "482580"
  },
  {
    "text": "block fields are not well checked",
    "start": "482580",
    "end": "484759"
  },
  {
    "text": "resulting in a specially constructed blf",
    "start": "484759",
    "end": "487979"
  },
  {
    "text": "file that can lead to an out-of-bound",
    "start": "487979",
    "end": "490259"
  },
  {
    "text": "vulnerability",
    "start": "490259",
    "end": "492060"
  },
  {
    "text": "and you can see a Autobox variability",
    "start": "492060",
    "end": "494520"
  },
  {
    "text": "will occur here when I flash block is",
    "start": "494520",
    "end": "497340"
  },
  {
    "text": "used as index",
    "start": "497340",
    "end": "500479"
  },
  {
    "text": "which submit this vulnerability to msrc",
    "start": "501720",
    "end": "504539"
  },
  {
    "text": "and obtain cve 2022-21916",
    "start": "504539",
    "end": "507930"
  },
  {
    "text": "[Music]",
    "start": "507930",
    "end": "511110"
  },
  {
    "text": "the second vulnerability appears in the",
    "start": "524520",
    "end": "527540"
  },
  {
    "text": "clfs log FCB physical overflow reversal",
    "start": "527540",
    "end": "531420"
  },
  {
    "text": "function",
    "start": "531420",
    "end": "532440"
  },
  {
    "text": "this function is mainly related to the",
    "start": "532440",
    "end": "535380"
  },
  {
    "text": "owner page operation",
    "start": "535380",
    "end": "537600"
  },
  {
    "text": "the cclfa space file High Watermark",
    "start": "537600",
    "end": "540720"
  },
  {
    "text": "sanitizing function",
    "start": "540720",
    "end": "543360"
  },
  {
    "text": "obtains the silent ID in the BLM file",
    "start": "543360",
    "end": "546300"
  },
  {
    "text": "and the silent ID is obtained by",
    "start": "546300",
    "end": "548820"
  },
  {
    "text": "subtracting one from the same next item",
    "start": "548820",
    "end": "551220"
  },
  {
    "text": "fields in the clf space record header",
    "start": "551220",
    "end": "554220"
  },
  {
    "text": "structure",
    "start": "554220",
    "end": "555180"
  },
  {
    "text": "we can still modify it in the bof file",
    "start": "555180",
    "end": "559200"
  },
  {
    "text": "when it is modified to a special value",
    "start": "559200",
    "end": "561560"
  },
  {
    "text": "it will be used as a wrong index",
    "start": "561560",
    "end": "564540"
  },
  {
    "text": "resulting in an autobus vulnerability",
    "start": "564540",
    "end": "568740"
  },
  {
    "text": "the picture here is the same next silent",
    "start": "568740",
    "end": "571680"
  },
  {
    "text": "we found in the file",
    "start": "571680",
    "end": "574640"
  },
  {
    "text": "an overflow occurs when the silent ID is",
    "start": "581580",
    "end": "584040"
  },
  {
    "text": "greater than 0x70.",
    "start": "584040",
    "end": "587940"
  },
  {
    "text": "in summary this is a pro overflow",
    "start": "598560",
    "end": "601380"
  },
  {
    "text": "vulnerability with a page Pro size of",
    "start": "601380",
    "end": "604040"
  },
  {
    "text": "0x1000 which writes clfs Als in value",
    "start": "604040",
    "end": "608720"
  },
  {
    "text": "and the old owner page data to the head",
    "start": "608720",
    "end": "611820"
  },
  {
    "text": "of the next pool",
    "start": "611820",
    "end": "613560"
  },
  {
    "text": "next my colleague Ling zhangi will",
    "start": "613560",
    "end": "615959"
  },
  {
    "text": "introduce how we use new method to",
    "start": "615959",
    "end": "618360"
  },
  {
    "text": "exploit this vulnerability",
    "start": "618360",
    "end": "621500"
  },
  {
    "text": "hello everyone my name is Lee Shawnee",
    "start": "633480",
    "end": "636240"
  },
  {
    "text": "last let me introduce our Universal",
    "start": "636240",
    "end": "639240"
  },
  {
    "text": "message for the Windows page the pro",
    "start": "639240",
    "end": "641339"
  },
  {
    "text": "overflow exploitation",
    "start": "641339",
    "end": "644160"
  },
  {
    "text": "uh currently low and windows patch the",
    "start": "644160",
    "end": "647040"
  },
  {
    "text": "pro overflow exploitation methods are as",
    "start": "647040",
    "end": "649740"
  },
  {
    "text": "followed",
    "start": "649740",
    "end": "650760"
  },
  {
    "text": "one is the wnf by overflow crafting the",
    "start": "650760",
    "end": "654720"
  },
  {
    "text": "status of WF limits the structure we can",
    "start": "654720",
    "end": "659579"
  },
  {
    "text": "we can achieve logo or restricted",
    "start": "659579",
    "end": "662100"
  },
  {
    "text": "actually address really on Direct",
    "start": "662100",
    "end": "664860"
  },
  {
    "text": "the other is the link name the password",
    "start": "664860",
    "end": "667740"
  },
  {
    "text": "by overflow corrupting the link point of",
    "start": "667740",
    "end": "671700"
  },
  {
    "text": "paper attribute structure we can only",
    "start": "671700",
    "end": "674820"
  },
  {
    "text": "achieve level of arbitrary",
    "start": "674820",
    "end": "677399"
  },
  {
    "text": "address reader",
    "start": "677399",
    "end": "680720"
  },
  {
    "text": "you know exploit the teaching of the wnf",
    "start": "681959",
    "end": "685260"
  },
  {
    "text": "had some limitations",
    "start": "685260",
    "end": "687839"
  },
  {
    "text": "the set of the WF let me instance is",
    "start": "687839",
    "end": "691740"
  },
  {
    "text": "zero X C 0 or 0x detail",
    "start": "691740",
    "end": "697140"
  },
  {
    "text": "this vulnerability is a probability with",
    "start": "697140",
    "end": "701399"
  },
  {
    "text": "the product with the appendix process of",
    "start": "701399",
    "end": "705980"
  },
  {
    "text": "0x1000 so we cannot allocated the WF let",
    "start": "705980",
    "end": "711000"
  },
  {
    "text": "me test structure with a set of 0x1000",
    "start": "711000",
    "end": "715260"
  },
  {
    "text": "[Music]",
    "start": "715260",
    "end": "717240"
  },
  {
    "text": "so we can only we can only overflow the",
    "start": "717240",
    "end": "720899"
  },
  {
    "text": "WF data data structure of the set 0x",
    "start": "720899",
    "end": "724740"
  },
  {
    "text": "1000",
    "start": "724740",
    "end": "726600"
  },
  {
    "text": "by overflowing the allocate yourself",
    "start": "726600",
    "end": "730459"
  },
  {
    "text": "allocate yourself of the download house",
    "start": "730459",
    "end": "733740"
  },
  {
    "text": "data data structure we can reach an auto",
    "start": "733740",
    "end": "738440"
  },
  {
    "text": "bounce rate in the maximum range of",
    "start": "738480",
    "end": "741720"
  },
  {
    "text": "0x",
    "start": "741720",
    "end": "743640"
  },
  {
    "text": "1000 set",
    "start": "743640",
    "end": "745920"
  },
  {
    "text": "right",
    "start": "745920",
    "end": "748920"
  },
  {
    "text": "so we also need to find a",
    "start": "751140",
    "end": "754820"
  },
  {
    "text": "0x1000 set patch the pro structure and",
    "start": "754820",
    "end": "758700"
  },
  {
    "text": "then overflow some of its fields to",
    "start": "758700",
    "end": "761640"
  },
  {
    "text": "achieve a goal of the arbitrary address",
    "start": "761640",
    "end": "763680"
  },
  {
    "text": "right",
    "start": "763680",
    "end": "766100"
  },
  {
    "text": "I found a good exploiter",
    "start": "767660",
    "end": "771720"
  },
  {
    "text": "structure in the windows AR PC",
    "start": "771720",
    "end": "775920"
  },
  {
    "text": "by overflow corrupting the handles",
    "start": "775920",
    "end": "780980"
  },
  {
    "text": "on the table structure foreign",
    "start": "780980",
    "end": "786240"
  },
  {
    "text": "table structure",
    "start": "794779",
    "end": "797820"
  },
  {
    "text": "a result lab can be created by coin",
    "start": "797820",
    "end": "801500"
  },
  {
    "text": "ntlpc Creator resource resolve function",
    "start": "801500",
    "end": "805200"
  },
  {
    "text": "whenever a blob is created the erpc and",
    "start": "805200",
    "end": "809220"
  },
  {
    "text": "the 100 tables and entry function well",
    "start": "809220",
    "end": "811820"
  },
  {
    "text": "be coded to register address or the",
    "start": "811820",
    "end": "815040"
  },
  {
    "text": "created block to the 100th of the hand",
    "start": "815040",
    "end": "817440"
  },
  {
    "text": "table",
    "start": "817440",
    "end": "818940"
  },
  {
    "text": "the most important part of erpc kind of",
    "start": "818940",
    "end": "822480"
  },
  {
    "text": "table structure is the 100 fields",
    "start": "822480",
    "end": "826760"
  },
  {
    "text": "when the arpc port is created",
    "start": "830459",
    "end": "834360"
  },
  {
    "text": "the arpc initial line to the 100 table",
    "start": "834360",
    "end": "837800"
  },
  {
    "text": "function is according to initial at the",
    "start": "837800",
    "end": "840660"
  },
  {
    "text": "final table",
    "start": "840660",
    "end": "842279"
  },
  {
    "text": "the hand is the applied poor with the",
    "start": "842279",
    "end": "845700"
  },
  {
    "text": "initial size of",
    "start": "845700",
    "end": "847560"
  },
  {
    "text": "0x80",
    "start": "847560",
    "end": "850139"
  },
  {
    "text": "which Stories the address of The Blob",
    "start": "850139",
    "end": "853260"
  },
  {
    "text": "structure",
    "start": "853260",
    "end": "854399"
  },
  {
    "text": "has more problems are created the set of",
    "start": "854399",
    "end": "858000"
  },
  {
    "text": "100 doubles",
    "start": "858000",
    "end": "860760"
  },
  {
    "text": "and the set of 100 is where is available",
    "start": "860760",
    "end": "866899"
  },
  {
    "text": "by overflow corrupting the klpc",
    "start": "871260",
    "end": "876060"
  },
  {
    "text": "results",
    "start": "876060",
    "end": "877160"
  },
  {
    "text": "point of the 100th structure we can",
    "start": "877160",
    "end": "881100"
  },
  {
    "text": "construct a fake resolved lab",
    "start": "881100",
    "end": "885680"
  },
  {
    "text": "under the kalpc results structure",
    "start": "886019",
    "end": "889139"
  },
  {
    "text": "storage the",
    "start": "889139",
    "end": "892160"
  },
  {
    "text": "stories or messaging",
    "start": "892680",
    "end": "896760"
  },
  {
    "text": "so we can continue to Constructor uh",
    "start": "897120",
    "end": "900660"
  },
  {
    "text": "fake area PC messages structure",
    "start": "900660",
    "end": "905040"
  },
  {
    "text": "and uh when you call collect NTA offices",
    "start": "905040",
    "end": "909360"
  },
  {
    "text": "and wait and receive report function to",
    "start": "909360",
    "end": "912240"
  },
  {
    "text": "send a message",
    "start": "912240",
    "end": "914160"
  },
  {
    "text": "it will address the data passages",
    "start": "914160",
    "end": "917880"
  },
  {
    "text": "in better use to address pointed to",
    "start": "917880",
    "end": "921660"
  },
  {
    "text": "better exchanging buffer in the klpc",
    "start": "921660",
    "end": "924839"
  },
  {
    "text": "messages structure",
    "start": "924839",
    "end": "926699"
  },
  {
    "text": "we can use it to achieve arbitrary",
    "start": "926699",
    "end": "929699"
  },
  {
    "text": "address rate that",
    "start": "929699",
    "end": "932579"
  },
  {
    "text": "and when you call anterior pieces and",
    "start": "932579",
    "end": "936300"
  },
  {
    "text": "with a referral point",
    "start": "936300",
    "end": "938160"
  },
  {
    "text": "water function to receive a message",
    "start": "938160",
    "end": "941880"
  },
  {
    "text": "it will read the data at the address",
    "start": "941880",
    "end": "944220"
  },
  {
    "text": "point in the barrier extension buffer in",
    "start": "944220",
    "end": "947579"
  },
  {
    "text": "the clear PC message structure we can",
    "start": "947579",
    "end": "950040"
  },
  {
    "text": "use it to achieve arbitrary object rate",
    "start": "950040",
    "end": "955579"
  },
  {
    "text": "under the whole process of achieving the",
    "start": "958199",
    "end": "961740"
  },
  {
    "text": "goal of arbitrary address delete and",
    "start": "961740",
    "end": "964079"
  },
  {
    "text": "address it as follows",
    "start": "964079",
    "end": "967320"
  },
  {
    "text": "first by overflow crafting the kmpc",
    "start": "967320",
    "end": "972000"
  },
  {
    "text": "results",
    "start": "972000",
    "end": "973760"
  },
  {
    "text": "point of the Android structure we can",
    "start": "973760",
    "end": "977160"
  },
  {
    "text": "construct our fake result block",
    "start": "977160",
    "end": "981720"
  },
  {
    "text": "the klpc results structure",
    "start": "981720",
    "end": "985380"
  },
  {
    "text": "stories or dress or a message",
    "start": "985380",
    "end": "988320"
  },
  {
    "text": "so we can continue to construct of",
    "start": "988320",
    "end": "991320"
  },
  {
    "text": "physical erpc",
    "start": "991320",
    "end": "993540"
  },
  {
    "text": "message structure",
    "start": "993540",
    "end": "996000"
  },
  {
    "text": "and again we can achieve a goal of",
    "start": "996000",
    "end": "999320"
  },
  {
    "text": "arbitrary address read and write so uh",
    "start": "999320",
    "end": "1003500"
  },
  {
    "text": "extension buffer field under the",
    "start": "1003500",
    "end": "1006139"
  },
  {
    "text": "extension buffers set field in the key",
    "start": "1006139",
    "end": "1009079"
  },
  {
    "text": "of his image",
    "start": "1009079",
    "end": "1010579"
  },
  {
    "text": "this structure",
    "start": "1010579",
    "end": "1013339"
  },
  {
    "text": "and the last my colleague will continue",
    "start": "1013339",
    "end": "1017420"
  },
  {
    "text": "to",
    "start": "1017420",
    "end": "1018800"
  },
  {
    "text": "introduce how to exploit this",
    "start": "1018800",
    "end": "1021440"
  },
  {
    "text": "vulnerability",
    "start": "1021440",
    "end": "1024160"
  },
  {
    "text": "uh color area let me introduce how to",
    "start": "1033559",
    "end": "1037699"
  },
  {
    "text": "combat wnf under our PC",
    "start": "1037699",
    "end": "1040400"
  },
  {
    "text": "and finally I should have laser",
    "start": "1040400",
    "end": "1042678"
  },
  {
    "text": "escalation",
    "start": "1042679",
    "end": "1044120"
  },
  {
    "text": "first of all we can call the anti-update",
    "start": "1044120",
    "end": "1046520"
  },
  {
    "text": "wnf state",
    "start": "1046520",
    "end": "1048199"
  },
  {
    "text": "to spray a lot of",
    "start": "1048199",
    "end": "1051520"
  },
  {
    "text": "0x1000.wx structures",
    "start": "1051520",
    "end": "1053919"
  },
  {
    "text": "and then make sure they are land in",
    "start": "1053919",
    "end": "1057740"
  },
  {
    "text": "memory",
    "start": "1057740",
    "end": "1060039"
  },
  {
    "text": "then we need to call the NT delete WF",
    "start": "1062120",
    "end": "1065960"
  },
  {
    "text": "state name function creating a lot of",
    "start": "1065960",
    "end": "1069020"
  },
  {
    "text": "memory holes",
    "start": "1069020",
    "end": "1072520"
  },
  {
    "text": "in the third step we need to create the",
    "start": "1075919",
    "end": "1078559"
  },
  {
    "text": "owner page",
    "start": "1078559",
    "end": "1079820"
  },
  {
    "text": "which is the vulnerable pool block",
    "start": "1079820",
    "end": "1083059"
  },
  {
    "text": "we only need to call create log file",
    "start": "1083059",
    "end": "1086419"
  },
  {
    "text": "but if you will dedicated brf file it",
    "start": "1086419",
    "end": "1090740"
  },
  {
    "text": "will not call the Overflow referral",
    "start": "1090740",
    "end": "1093380"
  },
  {
    "text": "you need to create a spatial bra here I",
    "start": "1093380",
    "end": "1097820"
  },
  {
    "text": "will briefly set is to create or",
    "start": "1097820",
    "end": "1100700"
  },
  {
    "text": "Multiplex the log file",
    "start": "1100700",
    "end": "1102980"
  },
  {
    "text": "then you need to write a lot of recalls",
    "start": "1102980",
    "end": "1107120"
  },
  {
    "text": "to the container",
    "start": "1107120",
    "end": "1110419"
  },
  {
    "text": "when the lens of the button content",
    "start": "1110419",
    "end": "1112880"
  },
  {
    "text": "access",
    "start": "1112880",
    "end": "1114380"
  },
  {
    "text": "0x75000.",
    "start": "1114380",
    "end": "1117380"
  },
  {
    "text": "uh it will automatically generate a",
    "start": "1118580",
    "end": "1121280"
  },
  {
    "text": "honor page",
    "start": "1121280",
    "end": "1122720"
  },
  {
    "text": "next you open the brf through create log",
    "start": "1122720",
    "end": "1127280"
  },
  {
    "text": "file",
    "start": "1127280",
    "end": "1128360"
  },
  {
    "text": "and it will cause the Overflow referral",
    "start": "1128360",
    "end": "1133000"
  },
  {
    "text": "uh okay back to the exfoliation part",
    "start": "1133220",
    "end": "1138559"
  },
  {
    "text": "when the Overflow referral is called",
    "start": "1138559",
    "end": "1141080"
  },
  {
    "text": "the function will do a out of bus byte",
    "start": "1141080",
    "end": "1144200"
  },
  {
    "text": "to the owner owner page pool",
    "start": "1144200",
    "end": "1147919"
  },
  {
    "text": "which will workflow the WF",
    "start": "1147919",
    "end": "1152120"
  },
  {
    "text": "as can be saved from the picture on the",
    "start": "1152120",
    "end": "1154520"
  },
  {
    "text": "on the right",
    "start": "1154520",
    "end": "1155900"
  },
  {
    "text": "before the Overflow of WF the value of",
    "start": "1155900",
    "end": "1158900"
  },
  {
    "text": "Dublin f is normal",
    "start": "1158900",
    "end": "1160760"
  },
  {
    "text": "after overflow the allocated side of WF",
    "start": "1160760",
    "end": "1164419"
  },
  {
    "text": "is overflowed to",
    "start": "1164419",
    "end": "1166179"
  },
  {
    "text": "0x4 I5",
    "start": "1166179",
    "end": "1169580"
  },
  {
    "text": "and the header is overflowed to zero",
    "start": "1169580",
    "end": "1173960"
  },
  {
    "text": "but this does not affect the normal work",
    "start": "1173960",
    "end": "1176900"
  },
  {
    "text": "of WF",
    "start": "1176900",
    "end": "1179799"
  },
  {
    "text": "then we need to create handles",
    "start": "1181640",
    "end": "1184940"
  },
  {
    "text": "where accurate handles",
    "start": "1184940",
    "end": "1186980"
  },
  {
    "text": "because the block side of WF is 0x1000",
    "start": "1186980",
    "end": "1192679"
  },
  {
    "text": "and it's out of bounds right side the",
    "start": "1192679",
    "end": "1195620"
  },
  {
    "text": "limit is also 0x 1000",
    "start": "1195620",
    "end": "1198559"
  },
  {
    "text": "not counting the direct turn header",
    "start": "1198559",
    "end": "1201500"
  },
  {
    "text": "structure at the beginning of the WF",
    "start": "1201500",
    "end": "1204020"
  },
  {
    "text": "structure it will start waiting from the",
    "start": "1204020",
    "end": "1207320"
  },
  {
    "text": "offside of 0x20",
    "start": "1207320",
    "end": "1210380"
  },
  {
    "text": "so we can only write the next block",
    "start": "1210380",
    "end": "1214179"
  },
  {
    "text": "interprets of lengths Direction",
    "start": "1214179",
    "end": "1218240"
  },
  {
    "text": "foreign",
    "start": "1218240",
    "end": "1219620"
  },
  {
    "text": "so we need a point to access in the",
    "start": "1219620",
    "end": "1224360"
  },
  {
    "text": "first 16 beds of the structure of the",
    "start": "1224360",
    "end": "1228320"
  },
  {
    "text": "next block",
    "start": "1228320",
    "end": "1230240"
  },
  {
    "text": "so that we can automate the pointer",
    "start": "1230240",
    "end": "1233360"
  },
  {
    "text": "through WF to a chill actually read and",
    "start": "1233360",
    "end": "1237200"
  },
  {
    "text": "write",
    "start": "1237200",
    "end": "1238880"
  },
  {
    "text": "so we found the structure of handles",
    "start": "1238880",
    "end": "1242240"
  },
  {
    "text": "all numbers of this structure are",
    "start": "1242240",
    "end": "1244580"
  },
  {
    "text": "Pointers",
    "start": "1244580",
    "end": "1246740"
  },
  {
    "text": "you can see the picture",
    "start": "1246740",
    "end": "1249020"
  },
  {
    "text": "uh the size of the pool is controllable",
    "start": "1249020",
    "end": "1253220"
  },
  {
    "text": "so we allocate handles of size 0x1000 to",
    "start": "1253220",
    "end": "1259460"
  },
  {
    "text": "the whole of WF",
    "start": "1259460",
    "end": "1263260"
  },
  {
    "text": "we call anti-update WF State date to",
    "start": "1265520",
    "end": "1269900"
  },
  {
    "text": "overflow the WF block",
    "start": "1269900",
    "end": "1272539"
  },
  {
    "text": "you can see the position marked by the",
    "start": "1272539",
    "end": "1275059"
  },
  {
    "text": "blue box",
    "start": "1275059",
    "end": "1276140"
  },
  {
    "text": "we always the first point remember of",
    "start": "1276140",
    "end": "1279200"
  },
  {
    "text": "handles with the user modes addressed",
    "start": "1279200",
    "end": "1283340"
  },
  {
    "text": "which is the air PC result structure we",
    "start": "1283340",
    "end": "1287480"
  },
  {
    "text": "fixed in user mode",
    "start": "1287480",
    "end": "1290740"
  },
  {
    "text": "here is an introduction to the air PC",
    "start": "1293419",
    "end": "1296720"
  },
  {
    "text": "structures",
    "start": "1296720",
    "end": "1298460"
  },
  {
    "text": "under key code",
    "start": "1298460",
    "end": "1300860"
  },
  {
    "text": "we can see that the structure of RPG",
    "start": "1300860",
    "end": "1303799"
  },
  {
    "text": "Reserve is very simple",
    "start": "1303799",
    "end": "1307039"
  },
  {
    "text": "we need to fix a message structure at",
    "start": "1307039",
    "end": "1310640"
  },
  {
    "text": "offsite 0x18",
    "start": "1310640",
    "end": "1314179"
  },
  {
    "text": "with overflow handles",
    "start": "1314179",
    "end": "1316580"
  },
  {
    "text": "called ntrp seasoned with resale port",
    "start": "1316580",
    "end": "1320539"
  },
  {
    "text": "then or fake address will be referenced",
    "start": "1320539",
    "end": "1324940"
  },
  {
    "text": "in the Erp the lookup message function",
    "start": "1324940",
    "end": "1329840"
  },
  {
    "text": "which",
    "start": "1329840",
    "end": "1331039"
  },
  {
    "text": "will find a big address in handle table",
    "start": "1331039",
    "end": "1335240"
  },
  {
    "text": "through message ID",
    "start": "1335240",
    "end": "1338799"
  },
  {
    "text": "then the RPC reference blocked by handle",
    "start": "1340580",
    "end": "1345020"
  },
  {
    "text": "function will return",
    "start": "1345020",
    "end": "1347000"
  },
  {
    "text": "fake Reserve structure",
    "start": "1347000",
    "end": "1349340"
  },
  {
    "text": "whose message number is also the",
    "start": "1349340",
    "end": "1351860"
  },
  {
    "text": "structure we fixed in user mode",
    "start": "1351860",
    "end": "1356620"
  },
  {
    "text": "here is an introduction to the key part",
    "start": "1360620",
    "end": "1363919"
  },
  {
    "text": "of",
    "start": "1363919",
    "end": "1365539"
  },
  {
    "text": "faking the LPS in method structure",
    "start": "1365539",
    "end": "1369260"
  },
  {
    "text": "we need to match the token address to",
    "start": "1369260",
    "end": "1371720"
  },
  {
    "text": "the 0x0 offset of the structure",
    "start": "1371720",
    "end": "1375860"
  },
  {
    "text": "so the extension buffer actually posts",
    "start": "1375860",
    "end": "1379100"
  },
  {
    "text": "the token address",
    "start": "1379100",
    "end": "1381200"
  },
  {
    "text": "how to leak the token address we can",
    "start": "1381200",
    "end": "1383960"
  },
  {
    "text": "call NT query system information",
    "start": "1383960",
    "end": "1387380"
  },
  {
    "text": "which is already a open technology so I",
    "start": "1387380",
    "end": "1391640"
  },
  {
    "text": "won't go into details",
    "start": "1391640",
    "end": "1394960"
  },
  {
    "text": "finally we can call NT Erp system with",
    "start": "1396980",
    "end": "1401600"
  },
  {
    "text": "result code to write the message content",
    "start": "1401600",
    "end": "1404960"
  },
  {
    "text": "to the Erp support",
    "start": "1404960",
    "end": "1408500"
  },
  {
    "text": "and eventually it will go to error PC",
    "start": "1408500",
    "end": "1411559"
  },
  {
    "text": "capture message data save",
    "start": "1411559",
    "end": "1414140"
  },
  {
    "text": "and the advanced content that a user can",
    "start": "1414140",
    "end": "1417860"
  },
  {
    "text": "control into the extension buffer point",
    "start": "1417860",
    "end": "1421760"
  },
  {
    "text": "which points to the Token address as you",
    "start": "1421760",
    "end": "1425179"
  },
  {
    "text": "can see in the red picture",
    "start": "1425179",
    "end": "1427880"
  },
  {
    "text": "the Privileges of the token has been",
    "start": "1427880",
    "end": "1430640"
  },
  {
    "text": "automated to",
    "start": "1430640",
    "end": "1433120"
  },
  {
    "text": "160x I5",
    "start": "1433120",
    "end": "1436960"
  },
  {
    "text": "finally we achieved elevation of",
    "start": "1439880",
    "end": "1442700"
  },
  {
    "text": "privilege",
    "start": "1442700",
    "end": "1443960"
  },
  {
    "text": "using proc exp to build the permissions",
    "start": "1443960",
    "end": "1447620"
  },
  {
    "text": "of the XP process",
    "start": "1447620",
    "end": "1452419"
  },
  {
    "text": "we have obtained the C debug privilege",
    "start": "1452419",
    "end": "1455780"
  },
  {
    "text": "permissions a permission and then we",
    "start": "1455780",
    "end": "1459200"
  },
  {
    "text": "inject",
    "start": "1459200",
    "end": "1460580"
  },
  {
    "text": "show code into the open logon process",
    "start": "1460580",
    "end": "1464600"
  },
  {
    "text": "and finally open a CMD process with",
    "start": "1464600",
    "end": "1468980"
  },
  {
    "text": "system permissions",
    "start": "1468980",
    "end": "1471940"
  },
  {
    "text": "here is the demo video we recorded",
    "start": "1472580",
    "end": "1477039"
  },
  {
    "text": "foreign",
    "start": "1484280",
    "end": "1486880"
  },
  {
    "text": "we will talk about why this structure",
    "start": "1513760",
    "end": "1517159"
  },
  {
    "text": "are Universal",
    "start": "1517159",
    "end": "1519679"
  },
  {
    "text": "we have involved three structures in",
    "start": "1519679",
    "end": "1522679"
  },
  {
    "text": "turtle",
    "start": "1522679",
    "end": "1523580"
  },
  {
    "text": "namely WF handles and message",
    "start": "1523580",
    "end": "1528500"
  },
  {
    "text": "they all have one feature",
    "start": "1528500",
    "end": "1531200"
  },
  {
    "text": "that is",
    "start": "1531200",
    "end": "1532580"
  },
  {
    "text": "they can be controlled inside",
    "start": "1532580",
    "end": "1536299"
  },
  {
    "text": "after our test they can be adapted to",
    "start": "1536299",
    "end": "1539419"
  },
  {
    "text": "the matching range is the minimal 0x 30",
    "start": "1539419",
    "end": "1544100"
  },
  {
    "text": "and the maximum 0x",
    "start": "1544100",
    "end": "1547159"
  },
  {
    "text": "11 000 or more",
    "start": "1547159",
    "end": "1551000"
  },
  {
    "text": "under this Ray structure can be used",
    "start": "1551000",
    "end": "1553460"
  },
  {
    "text": "along origin combination",
    "start": "1553460",
    "end": "1556940"
  },
  {
    "text": "according to our tests all three",
    "start": "1556940",
    "end": "1559640"
  },
  {
    "text": "structures are available in settings",
    "start": "1559640",
    "end": "1563919"
  },
  {
    "text": "0x32 Terex 1000",
    "start": "1563919",
    "end": "1567260"
  },
  {
    "text": "handles and message can be used over",
    "start": "1567260",
    "end": "1570220"
  },
  {
    "text": "greater than 0x1000.",
    "start": "1570220",
    "end": "1574460"
  },
  {
    "text": "greater than 0x 11000 can be used",
    "start": "1577179",
    "end": "1581000"
  },
  {
    "text": "handles",
    "start": "1581000",
    "end": "1583900"
  },
  {
    "text": "the three structures are described in",
    "start": "1587360",
    "end": "1590840"
  },
  {
    "text": "detail below",
    "start": "1590840",
    "end": "1592700"
  },
  {
    "text": "first introduce WF it says range from",
    "start": "1592700",
    "end": "1597020"
  },
  {
    "text": "the 0x30 to 0x1000",
    "start": "1597020",
    "end": "1600679"
  },
  {
    "text": "and it has a limit of one's Terrace 1000",
    "start": "1600679",
    "end": "1604580"
  },
  {
    "text": "for a lot of bounds right rights",
    "start": "1604580",
    "end": "1608860"
  },
  {
    "text": "but this is enough to adapt to a large",
    "start": "1608860",
    "end": "1612260"
  },
  {
    "text": "number of poor flow vulnerabilities",
    "start": "1612260",
    "end": "1616240"
  },
  {
    "text": "we only need to modify the size of the",
    "start": "1616240",
    "end": "1619700"
  },
  {
    "text": "allocated sides of the WF structure",
    "start": "1619700",
    "end": "1624140"
  },
  {
    "text": "throat overflow or for poor flow or out",
    "start": "1624140",
    "end": "1628940"
  },
  {
    "text": "of Bounce light to use WF to perform out",
    "start": "1628940",
    "end": "1632840"
  },
  {
    "text": "of Bounce light",
    "start": "1632840",
    "end": "1634760"
  },
  {
    "text": "and modify the data side",
    "start": "1634760",
    "end": "1637159"
  },
  {
    "text": "to achieve Autobots read",
    "start": "1637159",
    "end": "1641440"
  },
  {
    "text": "then the handle structure matches the",
    "start": "1644480",
    "end": "1647659"
  },
  {
    "text": "range 0x",
    "start": "1647659",
    "end": "1649580"
  },
  {
    "text": "Knight to wherever a lot",
    "start": "1649580",
    "end": "1652940"
  },
  {
    "text": "there is a rule for handles that is the",
    "start": "1652940",
    "end": "1657620"
  },
  {
    "text": "size is still x 80 at the beginning",
    "start": "1657620",
    "end": "1661460"
  },
  {
    "text": "plus the poor header is 0x90 then",
    "start": "1661460",
    "end": "1665419"
  },
  {
    "text": "directs 80 multiplied by 2 equals 0x",
    "start": "1665419",
    "end": "1669559"
  },
  {
    "text": "100.",
    "start": "1669559",
    "end": "1671419"
  },
  {
    "text": "10 multiplied by 2 and so on",
    "start": "1671419",
    "end": "1676480"
  },
  {
    "text": "therefore it is necessary to observe",
    "start": "1676580",
    "end": "1679820"
  },
  {
    "text": "whether to use the block size match when",
    "start": "1679820",
    "end": "1682940"
  },
  {
    "text": "adapting",
    "start": "1682940",
    "end": "1685480"
  },
  {
    "text": "the yields of handles is very flexible",
    "start": "1685760",
    "end": "1689900"
  },
  {
    "text": "even if you write a invalid value to the",
    "start": "1689900",
    "end": "1693679"
  },
  {
    "text": "handles there is a still chance to use",
    "start": "1693679",
    "end": "1697220"
  },
  {
    "text": "it successfully",
    "start": "1697220",
    "end": "1699860"
  },
  {
    "text": "because",
    "start": "1699860",
    "end": "1701539"
  },
  {
    "text": "you can call the virtual logic to map",
    "start": "1701539",
    "end": "1704900"
  },
  {
    "text": "this involid value to a user mode",
    "start": "1704900",
    "end": "1707960"
  },
  {
    "text": "address",
    "start": "1707960",
    "end": "1709880"
  },
  {
    "text": "and then you can fix your PC result",
    "start": "1709880",
    "end": "1715900"
  },
  {
    "text": "at this step use it was basically",
    "start": "1716240",
    "end": "1719419"
  },
  {
    "text": "successful",
    "start": "1719419",
    "end": "1722080"
  },
  {
    "text": "the last is the message structure it",
    "start": "1726320",
    "end": "1729200"
  },
  {
    "text": "matches in the range 0x",
    "start": "1729200",
    "end": "1731799"
  },
  {
    "text": "160 to 0x 11",
    "start": "1731799",
    "end": "1735200"
  },
  {
    "text": "000 we can OverWatch the extension",
    "start": "1735200",
    "end": "1737720"
  },
  {
    "text": "buffer of the message into a token or",
    "start": "1737720",
    "end": "1740600"
  },
  {
    "text": "other address through the Overflow or",
    "start": "1740600",
    "end": "1743120"
  },
  {
    "text": "auto advance lighting and the third call",
    "start": "1743120",
    "end": "1745820"
  },
  {
    "text": "the anti-air position rate Reserve",
    "start": "1745820",
    "end": "1748159"
  },
  {
    "text": "function to over to that to a new",
    "start": "1748159",
    "end": "1751820"
  },
  {
    "text": "address",
    "start": "1751820",
    "end": "1754059"
  },
  {
    "text": "Fair passing vulnerability similar to",
    "start": "1754100",
    "end": "1756320"
  },
  {
    "text": "CRF is still a good attack surface to",
    "start": "1756320",
    "end": "1758840"
  },
  {
    "text": "this day evil evolving medications on",
    "start": "1758840",
    "end": "1762320"
  },
  {
    "text": "Windows making explorers harder and",
    "start": "1762320",
    "end": "1764659"
  },
  {
    "text": "harder",
    "start": "1764659",
    "end": "1766940"
  },
  {
    "text": "here are the links to our references",
    "start": "1766940",
    "end": "1769460"
  },
  {
    "text": "thank you for zero contributions",
    "start": "1769460",
    "end": "1771980"
  },
  {
    "text": "contributions",
    "start": "1771980",
    "end": "1774880"
  },
  {
    "text": "[Music]",
    "start": "1775410",
    "end": "1778479"
  },
  {
    "text": "[Music]",
    "start": "1782320",
    "end": "1785409"
  }
]