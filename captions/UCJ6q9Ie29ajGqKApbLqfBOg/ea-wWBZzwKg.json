[
  {
    "text": "test test you can hear me it's all",
    "start": "34920",
    "end": "38440"
  },
  {
    "text": "good so here is sneaky blackhead huh big old",
    "start": "58480",
    "end": "64478"
  },
  {
    "text": "sneaky blackhead we're all sneaky blackheads around here and this this is your target",
    "start": "64479",
    "end": "70400"
  },
  {
    "text": "Network this is the sort of thing you're after did a bit of reconnaissance we got a pretty standard",
    "start": "70400",
    "end": "76680"
  },
  {
    "text": "kind of segmented Network infrastructure a couple of firewalls one internet facing one facing the internal network",
    "start": "76680",
    "end": "82400"
  },
  {
    "text": "uh we got a service segment with a couple of interesting boxes one of which happens to be our Target database",
    "start": "82400",
    "end": "87560"
  },
  {
    "text": "server we got a DMZ segment m server uh and interestingly enough on the desktop",
    "start": "87560",
    "end": "92920"
  },
  {
    "text": "land H there's the admin so we want to get through those F",
    "start": "92920",
    "end": "98479"
  },
  {
    "text": "walls into that database server now F said no no one's going to let that database server talk out to the public",
    "start": "98479",
    "end": "104360"
  },
  {
    "text": "internet maybe a few Windows updates something nasty like that in this case it happens to running a sensible operating system like",
    "start": "104360",
    "end": "110880"
  },
  {
    "text": "Linux so how are we going to get there well the plan looks something like this",
    "start": "110880",
    "end": "117880"
  },
  {
    "text": "hm maybe the admin's the way way to do it male headers say he runs Pine that's",
    "start": "117880",
    "end": "123399"
  },
  {
    "text": "all the goodness of WPD in a male client I happen to use pine by the way sorry uh",
    "start": "123399",
    "end": "129119"
  },
  {
    "text": "male signature has got one of those autogenerated Sig things tells us what kernel is running what sort of Linux it",
    "start": "129119",
    "end": "134360"
  },
  {
    "text": "is this case DB and sge mhm sensible 2422 slightly old Kel could come in",
    "start": "134360",
    "end": "141280"
  },
  {
    "text": "handy and the web blog seem to suggest outbound https isn't filtered H because",
    "start": "141280",
    "end": "148879"
  },
  {
    "text": "we can see the connections coming from their ning router instead of their proxy server so that sounds good yeah outbound",
    "start": "148879",
    "end": "154560"
  },
  {
    "text": "connection on Port 443 TCP mhm so this is the plan we take my zero",
    "start": "154560",
    "end": "162800"
  },
  {
    "text": "day Pine sploit which we can deliver as an email message via SNP we punch it on through to the mail server we wait for",
    "start": "162800",
    "end": "168480"
  },
  {
    "text": "the admin to pick up his mail we spy his Pine all good b a connect back Shell Code out to our net cat listening out on",
    "start": "168480",
    "end": "175480"
  },
  {
    "text": "the public internet somewhere back into his box root K it up good and proper",
    "start": "175480",
    "end": "180640"
  },
  {
    "text": "and then we'll sit around we'll wait for him to log into the database server we'll sniff his password and off we go",
    "start": "180640",
    "end": "186200"
  },
  {
    "text": "sounds like a pretty good plan to me I I reckon that'll work so let's give it a",
    "start": "186200",
    "end": "193920"
  },
  {
    "text": "try far my uh pretty leap Pine zero day nice innocuous male yeah he probably",
    "start": "193920",
    "end": "200680"
  },
  {
    "text": "opened that you know he's he's always up for opportunities that guy and out on the internet yeah fire that net cat",
    "start": "200680",
    "end": "207120"
  },
  {
    "text": "listener on Port 1337 TCP as you do and oh look at that root shell admin",
    "start": "207120",
    "end": "213120"
  },
  {
    "text": "shell on his box as you can see we got uad admin that's pretty good it's not",
    "start": "213120",
    "end": "218680"
  },
  {
    "text": "root but you know it'll do for now H but where'd that Pine go psax pip the grip o",
    "start": "218680",
    "end": "225879"
  },
  {
    "text": "no Pine must have killed it and you know he's probably going to notice that",
    "start": "225879",
    "end": "231400"
  },
  {
    "text": "that wasn't wasn't quite going according to plan oh dear oh well let's get that ret",
    "start": "231400",
    "end": "236760"
  },
  {
    "text": "in real fast and uh maybe we'll get away with it godamn godamn Linux Colonel of the month",
    "start": "236760",
    "end": "243120"
  },
  {
    "text": "club members man look at that ran two for 22 for ages and now he's running some crazy 26 thing root kit like that",
    "start": "243120",
    "end": "249959"
  },
  {
    "text": "beautiful Colonel Mo root kit I built it's not going to work God damn and he's",
    "start": "249959",
    "end": "255159"
  },
  {
    "text": "got to be got to be wondering where that Pine went huh oh and we're not very stealthy look",
    "start": "255159",
    "end": "260600"
  },
  {
    "text": "at us gz hax.com that wasn't a very good choice for vanity reverse was it he's probably going to probably going to spot",
    "start": "260600",
    "end": "266880"
  },
  {
    "text": "us H oh yeah there we go look New Shell oh dear he's going to start",
    "start": "266880",
    "end": "273960"
  },
  {
    "text": "looking right about now if you're a sensible man if you're a resourceful hacker you know you f it's time to cut",
    "start": "275639",
    "end": "282039"
  },
  {
    "text": "your losses you know when when the game is up and yeah it's just it's just time to",
    "start": "282039",
    "end": "287320"
  },
  {
    "text": "drop carrier and run CU you're busted you're screwed up you drop core with you sploit oh",
    "start": "287320",
    "end": "294680"
  },
  {
    "text": "dear and we haven't even got root yet how disappointing but h",
    "start": "294680",
    "end": "300120"
  },
  {
    "text": "what was that a second ago ooh SSH root at ns1 Target H hang on",
    "start": "300120",
    "end": "308199"
  },
  {
    "text": "a sec back in I Network D you remember there was a name server in that segment where this where the database server was",
    "start": "308199",
    "end": "314320"
  },
  {
    "text": "hm once you get the same layer to segment and that's a root shell too once we're on the same layer to segment we got root no problems there right H",
    "start": "314320",
    "end": "322639"
  },
  {
    "text": "godamn if only we had root right now that would be really good but so close man so close",
    "start": "322639",
    "end": "330000"
  },
  {
    "text": "just having that root shell right there in your face taunting you taunting you but you got to drop carrier right",
    "start": "330000",
    "end": "335800"
  },
  {
    "text": "you don't want to end up like our good friend Mr Kevin mnik so plus plus plus ADH not get the hell out of there but",
    "start": "335800",
    "end": "342639"
  },
  {
    "text": "man so close right that I was sitting there right looking at that ssh in in in the PS output and",
    "start": "342639",
    "end": "349639"
  },
  {
    "text": "it just taunted me and it's like if only right if only there was a way to get to the other end of that SSH session right",
    "start": "349639",
    "end": "354840"
  },
  {
    "text": "now not when I sniff the password not you know after I've Chen the SSH binary",
    "start": "354840",
    "end": "359960"
  },
  {
    "text": "to log stuff no right now logged in there's a running sa session I want that only there were way to do",
    "start": "359960",
    "end": "366880"
  },
  {
    "text": "it well as you can probably guess there is uh you can't read the small print",
    "start": "366880",
    "end": "373759"
  },
  {
    "text": "I'll explain it in a second but uh you get the general gist we got a neck cat listing down the bottom there we run some little magic happy stuff which",
    "start": "373759",
    "end": "379960"
  },
  {
    "text": "you'll see in a bit and oh look at that you got yourself pound terrible for",
    "start": "379960",
    "end": "387319"
  },
  {
    "text": "you so yeah uh my name is Adam uh also Metal Storm as you can see from the the",
    "start": "387680",
    "end": "393240"
  },
  {
    "text": "pretty logo uh I'm from New Zealand I'm the one of the token foreigners uh for those of you not familiar New Zealand's",
    "start": "393240",
    "end": "399199"
  },
  {
    "text": "a very small island in the South Pacific about that big as you can see on Google Maps put an arrow there for your reference it's primarily populated by",
    "start": "399199",
    "end": "405880"
  },
  {
    "text": "sheep so we don't have a lot of uh of Information Security Professionals uh there's a few Hobbits",
    "start": "405880",
    "end": "411680"
  },
  {
    "text": "apparently uh yeah that whole lot of the Rings thing kind of said everyone everyone's like do you have hairy feet",
    "start": "411680",
    "end": "416879"
  },
  {
    "text": "man it's like just leave me alone I'm not a hobbit all right I work uh for a Linux systems",
    "start": "416879",
    "end": "423560"
  },
  {
    "text": "integrator uh we actually I don't do a lot of security uh professionally so I'm I'm actually here in kind of a an",
    "start": "423560",
    "end": "429319"
  },
  {
    "text": "amateur uh Spare Time sort of capacity but I've been a corporate horse security consultant for a while got got a bit",
    "start": "429319",
    "end": "435240"
  },
  {
    "text": "tired I've been a network monkey you know all sorts of stuff I I'll tell you crazy ISP stories you know from the out",
    "start": "435240",
    "end": "440479"
  },
  {
    "text": "in the edge of the world we have to build satellite links out of pieces of string but it teaches a good networking",
    "start": "440479",
    "end": "447360"
  },
  {
    "text": "skills which will come in handy so",
    "start": "447360",
    "end": "452479"
  },
  {
    "text": "yeah what the just happened well you saw a pretty standard intrusion",
    "start": "452479",
    "end": "458120"
  },
  {
    "text": "right boring old Network I thought I had a really pretty good plan of how I was going to get in",
    "start": "458120",
    "end": "463840"
  },
  {
    "text": "right the motor Randy that we were using is we're going to attack the servers via the",
    "start": "463840",
    "end": "470680"
  },
  {
    "text": "administrators now those of you who uh who run Linux desktops are probably fairly few in far between I'm I'm one of",
    "start": "470680",
    "end": "476840"
  },
  {
    "text": "them but uh in general right desk environments are significantly more complex uh than your average server",
    "start": "476840",
    "end": "483720"
  },
  {
    "text": "environment and these days if you're looking for bugs you're looking for interesting things they're always you know lots of string passing lots of you",
    "start": "483720",
    "end": "489159"
  },
  {
    "text": "know mime handling all those sort of things where stuff goes horribly wrong most of that's on the desktop you know all that yeah like a little paper clip",
    "start": "489159",
    "end": "495560"
  },
  {
    "text": "guy right all that all that kind of candy that rots your brain it's like intellectual candy floss or whatever",
    "start": "495560",
    "end": "501080"
  },
  {
    "text": "what do you call it over here uh cotton candy",
    "start": "501080",
    "end": "505960"
  },
  {
    "text": "yeah but in this case things went wrong and yeah you could you could drop",
    "start": "506759",
    "end": "513680"
  },
  {
    "text": "carrot and run well or you could spare a little adaptability do something a little different and that's that's what",
    "start": "513680",
    "end": "520279"
  },
  {
    "text": "I like to think this is it's a little little different so post intrusion if you're a",
    "start": "520279",
    "end": "527120"
  },
  {
    "text": "hacker what are your goals well usually you need to escalate privileges you need to get root on the",
    "start": "527120",
    "end": "532600"
  },
  {
    "text": "local machine from there you're in a very good position to consolidate yourself you know get your root kit in",
    "start": "532600",
    "end": "538200"
  },
  {
    "text": "place you know tro and everything up the was Zoo uh and you know really once you're in position there then usually",
    "start": "538200",
    "end": "543920"
  },
  {
    "text": "you're on your way somewhere right you've got to Target very rarely you do you know there someone gives you a root shell on where you want to go right I mean it's not you know it's not 993",
    "start": "543920",
    "end": "551320"
  },
  {
    "text": "anymore so often you're on your way to somewhere else so you sit around you do some reconnaissance you sniff some",
    "start": "551320",
    "end": "556640"
  },
  {
    "text": "packets you know you crack some passwords and and you carry on now sometimes I like to do things a",
    "start": "556640",
    "end": "564160"
  },
  {
    "text": "little differently like I think more like a gorilla right you haven't got a lot of time you move in you hit fast and",
    "start": "564160",
    "end": "569240"
  },
  {
    "text": "you get the hell out of there very very quickly and maybe maybe you don't need to do all those other things but we",
    "start": "569240",
    "end": "574399"
  },
  {
    "text": "we'll see but yeah displaying adaptability I think is is a pretty pretty you know important thing here um it's you know",
    "start": "574399",
    "end": "581480"
  },
  {
    "text": "things things very rarely ever go to plan often your reconnaissance isn't accurate you know you don't have all the information that you need up",
    "start": "581480",
    "end": "587800"
  },
  {
    "text": "front so yeah you display a bit of adaptability um and hopefully that's one of the uh the differences between you",
    "start": "587800",
    "end": "593720"
  },
  {
    "text": "know us hairy hackers and uh you know the people with ties who you pay to uh test your Networks",
    "start": "593720",
    "end": "601120"
  },
  {
    "text": "now cross host privilege escalation that's uh it's a term I made up probably someone else got a better word for",
    "start": "601720",
    "end": "608600"
  },
  {
    "text": "it local root maybe it's a distraction you know root on on another box is probably just as good as root on this",
    "start": "608600",
    "end": "614560"
  },
  {
    "text": "box and I was sitting there thinking about that root shell you know that SSH with a root shell on the other end and I thought you know I don't care about root",
    "start": "614560",
    "end": "620880"
  },
  {
    "text": "on this guy's workstation screw him right I want root on that name server you know local vulnerabilities",
    "start": "620880",
    "end": "627040"
  },
  {
    "text": "it's it's very easy to exploit sometimes you know you you feel like you have to it's kind of the routine you get into you have to rootkit the box it's all",
    "start": "627040",
    "end": "632959"
  },
  {
    "text": "very tedious you know 9 to5 punch in punch out rootkit and it's easy right it's",
    "start": "632959",
    "end": "639040"
  },
  {
    "text": "satisfying it's good it feels good you find a local privilege escalation vulnerability and some sew binary you know and it feels good you're",
    "start": "639040",
    "end": "645720"
  },
  {
    "text": "doing your job but yeah that's easy but what if there was something even",
    "start": "645720",
    "end": "653279"
  },
  {
    "text": "easier ah trust relationships you remember these from like you know 198 83",
    "start": "654519",
    "end": "660440"
  },
  {
    "text": "back when everybody trusted everybody you know we're all no one locks their houses and you",
    "start": "660440",
    "end": "665600"
  },
  {
    "text": "know it's kind of old school you you remember our host I'm sure Kevin mitnik",
    "start": "665600",
    "end": "671040"
  },
  {
    "text": "remembers these things and back when you ports below 1024 this magically gave you root right I mean these are the good old",
    "start": "671040",
    "end": "676800"
  },
  {
    "text": "these are the things that really give you that warm you know Nostalgia feeling you know you just want to eat your mom's Apple",
    "start": "676800",
    "end": "682639"
  },
  {
    "text": "P apple crumble in New Zealand but you and then and that sort of thing like",
    "start": "682639",
    "end": "688240"
  },
  {
    "text": "exporting flash read right to the world right I mean that's we he we a bunch of lad Unix hippies right you know share",
    "start": "688240",
    "end": "693399"
  },
  {
    "text": "the love around it's what uh our good friend Mr storman would say but that",
    "start": "693399",
    "end": "699560"
  },
  {
    "text": "stuff seemed kind of good right you could have a beer you could you could get some rud it was nice and easy you didn't have to think so much all this you know kind of disassembly and stuff",
    "start": "699560",
    "end": "705560"
  },
  {
    "text": "are very difficult I I I like trust relationship they're good they feel",
    "start": "705560",
    "end": "710680"
  },
  {
    "text": "good it's weird we that we even call that hacking right I mean you see the the old movies of of simple Nomad",
    "start": "710680",
    "end": "717560"
  },
  {
    "text": "getting rot by mounting stuff right that's uh those were the good old",
    "start": "717560",
    "end": "723160"
  },
  {
    "text": "e one of the things I really like about trust relationships is that that instant gratification thing I like instant",
    "start": "723560",
    "end": "729000"
  },
  {
    "text": "gratification I like just you know you see root you get roote right that's fun that's good instant gratification that's",
    "start": "729000",
    "end": "734519"
  },
  {
    "text": "that's my sort of exploit right so I decided to break trusts into",
    "start": "734519",
    "end": "742440"
  },
  {
    "text": "two CES uh what I'm calling non-transient trust obviously this talk is called trust transient so there obviously a transient trust so non",
    "start": "742440",
    "end": "748920"
  },
  {
    "text": "transient trust which is that's your traditional sort of trusts right that's your your our hosts it's things like SSH trust",
    "start": "748920",
    "end": "756440"
  },
  {
    "text": "essentially it's it's a a stored authentication credential either on the client side like an SSH trust with your",
    "start": "756440",
    "end": "762040"
  },
  {
    "text": "private key or on the server side in the case of something like our hosts or or things that trust ports below 1024 or",
    "start": "762040",
    "end": "767920"
  },
  {
    "text": "trust ident response or whatever it's uh what Bruce schne might call one factor or uh if you were",
    "start": "767920",
    "end": "776360"
  },
  {
    "text": "here it's uh authentication uh in some cases based on on the properties of the",
    "start": "776360",
    "end": "782000"
  },
  {
    "text": "connection the The Source address the IP the uh the port number that sort of",
    "start": "782000",
    "end": "788320"
  },
  {
    "text": "thing and then we have the the other half of trust which I've called transient trust their trust",
    "start": "789440",
    "end": "794959"
  },
  {
    "text": "relationships that change over time so during authentication a trust relationship that",
    "start": "794959",
    "end": "801600"
  },
  {
    "text": "exist only for a period of time so and change over time um really during the",
    "start": "801600",
    "end": "807320"
  },
  {
    "text": "authentication process there's something sort of you know strong authentication uh you know pki or whatever but after",
    "start": "807320",
    "end": "813600"
  },
  {
    "text": "we've completed that authentication phase we have essentially a trust relationship for the duration of that",
    "start": "813600",
    "end": "819320"
  },
  {
    "text": "connection and unless you're going to personally by hand authenticate every single packet right then you have to",
    "start": "819320",
    "end": "825720"
  },
  {
    "text": "accept that there's some degree of trust in every open",
    "start": "825720",
    "end": "830079"
  },
  {
    "text": "connection so let's look at some uh some metrics by which we going to evaluate uh",
    "start": "834680",
    "end": "840320"
  },
  {
    "text": "methods for exporting trust relationships uh I just I've just kind of picked a couple um in this case I'm going to rate",
    "start": "840320",
    "end": "847240"
  },
  {
    "text": "them from 1 to 10 uh for ease of use you know how how straightforward it is how understandable how little work you have",
    "start": "847240",
    "end": "852480"
  },
  {
    "text": "to do uh how stealthy it is you how sneaky you can be how much effort you have to go to hide uh what you're",
    "start": "852480",
    "end": "858759"
  },
  {
    "text": "doing when how how close to just right the hell now can you go ahead and do this uh and finally just a general idea",
    "start": "858759",
    "end": "867160"
  },
  {
    "text": "of how feasible it is how often you going to run into a scenario where you can use this particular type of attack um and for the purposes of this",
    "start": "867160",
    "end": "873959"
  },
  {
    "text": "exercise we're going to assume that we've just acquired a non-root shell uh on a box like we did in the",
    "start": "873959",
    "end": "880880"
  },
  {
    "text": "example so the first and probably the best way right is we exploit a classic",
    "start": "883440",
    "end": "889240"
  },
  {
    "text": "nontransient trust like you know an our host or something so we can pretend to be client",
    "start": "889240",
    "end": "895600"
  },
  {
    "text": "a so that the server trusts us now that's pretty easy right I mean you don't get much easier than that uh it's",
    "start": "895600",
    "end": "902399"
  },
  {
    "text": "stealthy me the user doesn't know that you know about his trust relationship the only thing that that is secret about a trust relationship is that it",
    "start": "902399",
    "end": "908759"
  },
  {
    "text": "exists when yeah right now that's all good uh feasible yeah I'd like there'll",
    "start": "908759",
    "end": "914800"
  },
  {
    "text": "be trust relationships everywhere that would be good right like s rout at you know gov. NZ and it would let me in that",
    "start": "914800",
    "end": "919839"
  },
  {
    "text": "would be sweet but no not very feasible because you know people have finally kind of understood that exporting SL",
    "start": "919839",
    "end": "926399"
  },
  {
    "text": "read write by NFS to the entire world is you know not not so",
    "start": "926399",
    "end": "931720"
  },
  {
    "text": "desirable ah pretty Universal technique everyone uh everyone's done this at some point I'm sure key logging so during",
    "start": "932399",
    "end": "939880"
  },
  {
    "text": "authentication um and this is kind of a a more of a attack on transient trust because during authentication we steal",
    "start": "939880",
    "end": "945560"
  },
  {
    "text": "the credentials and then later on we use them so yeah we impersonate user a using",
    "start": "945560",
    "end": "950839"
  },
  {
    "text": "the stolen credentials yeah pretty straightforward nice and easy you know everyone understands how to do it there's all manner of ways you can key",
    "start": "950839",
    "end": "956160"
  },
  {
    "text": "log things you know you can have key loggers right out by the hardware you can have you know you can tro in the S",
    "start": "956160",
    "end": "961759"
  },
  {
    "text": "to dump the password it's all sorts of stuff you can do and well well understood stuff stealthy yeah sure done",
    "start": "961759",
    "end": "967319"
  },
  {
    "text": "right pretty good I'm sure you've all seen that uh that hoax about the Dell keyboard with the built-in key logger that dumps the packets over the ethernet",
    "start": "967319",
    "end": "974560"
  },
  {
    "text": "yeah uh when now downside is you have to wait until the user goes to authenticate and that and that in our case right",
    "start": "974560",
    "end": "980680"
  },
  {
    "text": "where we we've busted him we're about to get busted ourselves um and we don't have time to tro in the binary and wait",
    "start": "980680",
    "end": "985720"
  },
  {
    "text": "for the guy to log in again so not so good on the win front but overall feasibility pretty damn good if you can",
    "start": "985720",
    "end": "992160"
  },
  {
    "text": "get roote or you can get into a position where you can sniff the key struges you know you can talk to his ex server or",
    "start": "992160",
    "end": "997360"
  },
  {
    "text": "something then yeah it's it's a pretty good attack pretty good allrounder man in the- Middle technique",
    "start": "997360",
    "end": "1003399"
  },
  {
    "text": "right you got an open running post authentication connection you should be able to just go ahead and steal that puppy right pretty classic technique",
    "start": "1003399",
    "end": "1009959"
  },
  {
    "text": "against uh against tnet so in this case yeah we impersonate",
    "start": "1009959",
    "end": "1015680"
  },
  {
    "text": "the server to the client and the client to the server we sit in the middle we pass the packets back on board and then later on we can uh either monitor the",
    "start": "1015680",
    "end": "1023520"
  },
  {
    "text": "session uh or we can go ahead and take it over not so easy I mean uh if you can",
    "start": "1023520",
    "end": "1030959"
  },
  {
    "text": "see the packets yeah it's all good um if you know if you've got route and you you can you can sniff the packets you can put the interface in promiscuous mode",
    "start": "1030959",
    "end": "1036918"
  },
  {
    "text": "yeah you can see the sequence numbers you're doing well stealthy not so good I mean you can often hijack the connection",
    "start": "1036919",
    "end": "1042438"
  },
  {
    "text": "in the middle um without the user knowing but if you want to actually inject something you're going to bust their connection uh when hm it's kind of",
    "start": "1042439",
    "end": "1050799"
  },
  {
    "text": "difficult because these days you don't see many clear text protocols there a lot of SSH which you're going to have to hijack right at the beginning um you're",
    "start": "1050799",
    "end": "1057000"
  },
  {
    "text": "using you know man in the middle like Doug song's man in the middle SSH hijacker which pretty cool um but yeah",
    "start": "1057000",
    "end": "1064120"
  },
  {
    "text": "so with connections with encryption strong authentication yeah it's kind of a problem overall feasibility still okay",
    "start": "1064120",
    "end": "1070240"
  },
  {
    "text": "but uh H it's not as good as key login the classic TCP hijack that's uh",
    "start": "1070240",
    "end": "1079520"
  },
  {
    "text": "quite similar uh you've been used successfully in the past Kevin mitnik of course deployed against shimamura quite",
    "start": "1079520",
    "end": "1085960"
  },
  {
    "text": "a you know classic attack it's not so straightforward these days people have decent random number generators on their uh tcv",
    "start": "1085960",
    "end": "1093760"
  },
  {
    "text": "sequences yeah and uh it's not so stealthy you know you're",
    "start": "1093760",
    "end": "1099480"
  },
  {
    "text": "going to bust a connection someone's going to notice unless they're not at their desk when when is good right this is one",
    "start": "1099480",
    "end": "1105280"
  },
  {
    "text": "of the reasons I like this right you can take a running connection uh and you can go ahead and you can you can go ahead and hijack it anytime you like that's",
    "start": "1105280",
    "end": "1111840"
  },
  {
    "text": "good as long as it's running uh but overall feasibility these days uh with you know proper authentication and",
    "start": "1111840",
    "end": "1118760"
  },
  {
    "text": "encryption uh it's uh it's not as common as it used to be it's a good party trick against the the occasional tell net but",
    "start": "1118760",
    "end": "1125799"
  },
  {
    "text": "overall yeah not so hot uhuh but this one this one is kind of interesting how",
    "start": "1125799",
    "end": "1133480"
  },
  {
    "text": "about after we've authenticated we've got that running connection we go ahead and we take go over the client software",
    "start": "1133480",
    "end": "1139640"
  },
  {
    "text": "which already has the socket we don't have to worry about any jiggery pokery with sequence numbers we just go ahead and take the socket away from the",
    "start": "1139640",
    "end": "1144679"
  },
  {
    "text": "application and use it for our own purposes it's already authenticated at the other end there's already that transient trust relationship between the",
    "start": "1144679",
    "end": "1151200"
  },
  {
    "text": "client and the server that sounds pretty good huh surprisingly enough it's actually quite",
    "start": "1151200",
    "end": "1157720"
  },
  {
    "text": "easy I gave it an eight out of 10 for e that's pretty good stealthy yes you do it right which hopefully I do yeah it's",
    "start": "1157720",
    "end": "1165679"
  },
  {
    "text": "pretty stealthy H when very close to right now that's good and",
    "start": "1165679",
    "end": "1171960"
  },
  {
    "text": "overall feasibility yeah you see a lot I mean like I know my desktop right I probably got 20 30 s connections open",
    "start": "1171960",
    "end": "1177039"
  },
  {
    "text": "all over the goddamn place you root my box well there there's a whole lot of root shells for you so yeah I think overall feasibility",
    "start": "1177039",
    "end": "1183760"
  },
  {
    "text": "pretty damn good H now this this exploiting the",
    "start": "1183760",
    "end": "1189159"
  },
  {
    "text": "application thing right it's it's a slightly different UMO to your to your normal attack right because really what",
    "start": "1189159",
    "end": "1196280"
  },
  {
    "text": "you want to maximize your chances is you want as many users logged in as possible running as many applications as possible",
    "start": "1196280",
    "end": "1202600"
  },
  {
    "text": "because you're going to sneak down those connections so it's different in that we want to attack right we want to do it during peak time right when everybody's",
    "start": "1202600",
    "end": "1209240"
  },
  {
    "text": "sitting at their desk we want to sneak in there and just take their shells away from them right when they're using them",
    "start": "1209240",
    "end": "1214960"
  },
  {
    "text": "which is yeah it's it's it's daylight robbery right you know no no more sneaking around just get in there take their",
    "start": "1214960",
    "end": "1221240"
  },
  {
    "text": "shells but if you can do it without the noticing then even better",
    "start": "1221240",
    "end": "1226280"
  },
  {
    "text": "right and and the downside for me I guess is it's it's not even really that technically challenging sorry",
    "start": "1226280",
    "end": "1233559"
  },
  {
    "text": "um it's really you know it's it's just a it's just a bugging right it's it's creative reapplication of the of the",
    "start": "1233880",
    "end": "1240240"
  },
  {
    "text": "same tricks that virus Riders and reverse Engineers have been using for a while which you'll",
    "start": "1240240",
    "end": "1246240"
  },
  {
    "text": "see so I prepared a graph uh which clearly demonstrates my technique is",
    "start": "1247280",
    "end": "1252360"
  },
  {
    "text": "wildly good but okay seriously I plotted the",
    "start": "1252360",
    "end": "1257760"
  },
  {
    "text": "values on the graph and it says that exploiting applications you know transient trust hijacking is is almost",
    "start": "1257760",
    "end": "1263919"
  },
  {
    "text": "as good as real trust relationships which which suggests I'm probably going to enjoy",
    "start": "1263919",
    "end": "1269039"
  },
  {
    "text": "it isn't it a pretty graph so I present to you my SSH",
    "start": "1269039",
    "end": "1278360"
  },
  {
    "text": "Jacko it's a uh it's a little python script which when you point it at a",
    "start": "1278360",
    "end": "1283679"
  },
  {
    "text": "running SSH process gives you a shell out the other end just like that we're going to go through a few details",
    "start": "1283679",
    "end": "1290320"
  },
  {
    "text": "how it works um some some kind of nitty-gritty bits and pieces um how we",
    "start": "1290320",
    "end": "1295400"
  },
  {
    "text": "Implement anti forensic technique uh whilst we're doing it uh a little bit of mitigation not not too much don't worry",
    "start": "1295400",
    "end": "1301919"
  },
  {
    "text": "um and yeah the usual you know what what else are we are we going to do with",
    "start": "1301919",
    "end": "1307039"
  },
  {
    "text": "it now hopefully everyone here is familiar with SSH the SSH protocol",
    "start": "1307960",
    "end": "1313679"
  },
  {
    "text": "um it's uh it's quite an interesting protocol in that it's essentially a I guess you could consider a transport",
    "start": "1313679",
    "end": "1319520"
  },
  {
    "text": "layer multiplexing protocol you can run multiple sessions across a single SSH",
    "start": "1319520",
    "end": "1324559"
  },
  {
    "text": "session um and it will allow you to you know push shells around push TCP sockets around U you know push arbitary data",
    "start": "1324559",
    "end": "1331080"
  },
  {
    "text": "around pipe it in and out and it does this by using what they call a virtual Channel infrastructure over the top of",
    "start": "1331080",
    "end": "1336720"
  },
  {
    "text": "their SSH connection so uh what we're going to do is you know because our goal is to take",
    "start": "1336720",
    "end": "1343039"
  },
  {
    "text": "that SSH connection get ourselves an SSH connection without interrupting the legitimate user",
    "start": "1343039",
    "end": "1349320"
  },
  {
    "text": "and this virtual Channel stuff is going to help us uh make it pretty seamless so what we're going to do is",
    "start": "1349320",
    "end": "1356120"
  },
  {
    "text": "we're going to take the features provided by the SSH protocol and we're going to reuse them for a little bit of",
    "start": "1356120",
    "end": "1362080"
  },
  {
    "text": "evil what we're going to do is we're going to take a socket on one end and we're just going to glue it to a shell",
    "start": "1362080",
    "end": "1367200"
  },
  {
    "text": "on the other end and plug a hacker in and he's all good so using python uh and uh gbmi",
    "start": "1367200",
    "end": "1376799"
  },
  {
    "text": "which is the G debuggers programmatic interface uh we just go ahead and attach to a running SSH",
    "start": "1376799",
    "end": "1384278"
  },
  {
    "text": "client and then we have a good rumage around we do some you know kind of patent signature scanning uh and we find",
    "start": "1384840",
    "end": "1390679"
  },
  {
    "text": "the code that's responsible for setting up the virtual channels um and then yeah we we just go ahead and",
    "start": "1390679",
    "end": "1397640"
  },
  {
    "text": "patch that M to uh instead of talking to a local user out his uh his pseud t uh",
    "start": "1397640",
    "end": "1404919"
  },
  {
    "text": "we'll just go ahead and uh and glue that to a socket which is connected to",
    "start": "1404919",
    "end": "1409880"
  },
  {
    "text": "us and then we'll go ahead and ask for a shell on the other end so we patch up the",
    "start": "1410320",
    "end": "1419640"
  },
  {
    "text": "code and then yeah we just we just go ahead and ask it to run it for us thanks thanks very much that'll be",
    "start": "1422159",
    "end": "1427840"
  },
  {
    "text": "nice and it does and then little bit of clean up and",
    "start": "1427840",
    "end": "1436440"
  },
  {
    "text": "continues as if nothing happened except that yeah shell just popped out our net cat terrible for you good for",
    "start": "1436440",
    "end": "1444080"
  },
  {
    "text": "me H I'd like to think this is the sort of stuff that your mother warns you about right how a how has a sneaky",
    "start": "1447120",
    "end": "1453840"
  },
  {
    "text": "buggers right sneaky we don't just you we don't just install L4 anymore right",
    "start": "1453840",
    "end": "1459279"
  },
  {
    "text": "bounce IC proxies around right I mean that's it's all kind of P",
    "start": "1459279",
    "end": "1465000"
  },
  {
    "text": "right like to display a little bit of",
    "start": "1466799",
    "end": "1471760"
  },
  {
    "text": "creativity sort of thing that an expensive pentester might do if you you know if if you spent your money",
    "start": "1472080",
    "end": "1478559"
  },
  {
    "text": "wisely so I me essentially what we're doing right is just automated debugging right and of course you give a human a",
    "start": "1480559",
    "end": "1486200"
  },
  {
    "text": "debugger you plug them into a process of course we're going to do sneaky stuff right but what we're really aiming to do is we want to automate it we want",
    "start": "1486200",
    "end": "1493200"
  },
  {
    "text": "something that has the on the next slide it says yes the the the sneakiness of a human and the",
    "start": "1493200",
    "end": "1499360"
  },
  {
    "text": "reliability and the portability and the speed of a script so we're going to use GDB which",
    "start": "1499360",
    "end": "1507360"
  },
  {
    "text": "is uh the most excellent canoe de buger uh we're going to use GDB gdbm which is the machine interface uh which is it's",
    "start": "1507360",
    "end": "1515559"
  },
  {
    "text": "not great but it works uh and I'm going to use Python Python's a great kind of crossplatform",
    "start": "1515559",
    "end": "1521279"
  },
  {
    "text": "scripting language uh I like it has an interactive shell it's good for you know prototyping a code nice and fast so",
    "start": "1521279",
    "end": "1528240"
  },
  {
    "text": "we're going to glue those all together um and use it as an automated debugging toolkit now it's um what we're actually",
    "start": "1528240",
    "end": "1534480"
  },
  {
    "text": "doing to the SSH client with this it's uh it's it's less like debugging that you you normally would use a debugger",
    "start": "1534480",
    "end": "1540440"
  },
  {
    "text": "for and kind of you know more like reverse engineering on the Fly uh you know programmatically um bit of binary",
    "start": "1540440",
    "end": "1547559"
  },
  {
    "text": "analysis mixed in um and yeah a little bit of kind of virus technique there's not many Unix viruses but uh those that",
    "start": "1547559",
    "end": "1553159"
  },
  {
    "text": "are quite instructional right so we're going to",
    "start": "1553159",
    "end": "1558399"
  },
  {
    "text": "look through a little bit of the uh of the nitty-gritty of how it works um a little bit about the python gdmi",
    "start": "1558399",
    "end": "1564159"
  },
  {
    "text": "interface um how are we going to find a safe place to stop the execution of the program finding the stuff that we have",
    "start": "1564159",
    "end": "1570480"
  },
  {
    "text": "to have to mess with generating the evil code that we're going to wedge in there actually wedging it in and running it",
    "start": "1570480",
    "end": "1577200"
  },
  {
    "text": "um and you know we're I'm discussing it obviously specifically with reference to my SSH Jacker but this uh this sort of",
    "start": "1577200",
    "end": "1583399"
  },
  {
    "text": "technique is quite generically applicable as you'll see so yes as I explained uh GDB is a",
    "start": "1583399",
    "end": "1589679"
  },
  {
    "text": "new debugger um I implemented a python binding for it uh just to make my life",
    "start": "1589679",
    "end": "1594960"
  },
  {
    "text": "easier it's it's included on your CD I guess if you want to have a play with it uh it's very pretty basic it has the all",
    "start": "1594960",
    "end": "1601279"
  },
  {
    "text": "the functionality you'd need for for writing an SSH Jacker obviously uh but not a hell of a lot else but you know it does the important things you can you",
    "start": "1601279",
    "end": "1607240"
  },
  {
    "text": "can read and write memory you can change registers you can mess around with",
    "start": "1607240",
    "end": "1612279"
  },
  {
    "text": "stuff now what we're going to do right we're going to stop the saay process and go ahead and mess with it now we can't",
    "start": "1613720",
    "end": "1620240"
  },
  {
    "text": "do this just really nearly anywhere I mean SSH is normally it's a single threaded process right there's no locking there's no nothing there's lots",
    "start": "1620240",
    "end": "1625679"
  },
  {
    "text": "of globals uh so we have to be quite careful about what we do um and one of the interesting things is we have to",
    "start": "1625679",
    "end": "1631399"
  },
  {
    "text": "find a safe place where we're going to stop execution go ahead and run our alternate code path return and have it",
    "start": "1631399",
    "end": "1638120"
  },
  {
    "text": "continue running safely so you know you have to rumage through the uh the source code a bit and and find somewhere that looks quite likely and obviously what",
    "start": "1638120",
    "end": "1644960"
  },
  {
    "text": "you're looking for is I guess the the least deviation uh from the normal functioning of the program in this case",
    "start": "1644960",
    "end": "1651039"
  },
  {
    "text": "I had a had a rumage around the mainline uh you may be if familiar with SSH if you uh open up uh the command shell",
    "start": "1651039",
    "end": "1656799"
  },
  {
    "text": "inside SSH you hit the the escape sequence and C gives you a command shell you can open up uh New Port",
    "start": "1656799",
    "end": "1662720"
  },
  {
    "text": "forwards obviously that has to be able to set up virtual channels because those things run over their things over their",
    "start": "1662720",
    "end": "1667760"
  },
  {
    "text": "over a virtual channels so I fig that's probably a pretty good place to have a look figure out how it works where can I",
    "start": "1667760",
    "end": "1673200"
  },
  {
    "text": "safely create virtual channels and funny enough yet right there in the main line it sits in that select most of the time that sounds like",
    "start": "1673200",
    "end": "1680679"
  },
  {
    "text": "a like a pretty good place so what we're going to do is we're going to attach our debuger to the process just stop it",
    "start": "1680679",
    "end": "1686559"
  },
  {
    "text": "where the hell it is rumage around and see if we can't find that safe place and then we're going to drop a break point there just like",
    "start": "1686559",
    "end": "1694919"
  },
  {
    "text": "that but where the hell is Select we don't have any debug symbols unless you built your own SSH and you",
    "start": "1696120",
    "end": "1702480"
  },
  {
    "text": "know that's obviously not going to run on someone else's production box so yeah we don't have any debug symbols they have hell are we going to find select",
    "start": "1702480",
    "end": "1708760"
  },
  {
    "text": "well anyone who's done any sort of reverse engineering binary analysis you know is familiar with this sort of",
    "start": "1708760",
    "end": "1714360"
  },
  {
    "text": "technique pretty standard sort of stuff right we work backwards from where we can find select which happens to be",
    "start": "1714360",
    "end": "1719480"
  },
  {
    "text": "where it's imported from liy into the address space of our of our binary and memory so we rumage around we find it uh",
    "start": "1719480",
    "end": "1726519"
  },
  {
    "text": "in libc and then we walk backwards uh through the global offset",
    "start": "1726519",
    "end": "1732039"
  },
  {
    "text": "table and the procedure linkage table uh and eventually we find calls in the main",
    "start": "1732039",
    "end": "1737600"
  },
  {
    "text": "line to the PLT entry for select now in this case uh it was actually quite lucky there's one call to",
    "start": "1737600",
    "end": "1743640"
  },
  {
    "text": "select in the whole godamn binary um so I didn't even have to bother putting a breakpoint in the main line uh I just",
    "start": "1743640",
    "end": "1748880"
  },
  {
    "text": "went ahead and put it in the PLT it jumps through the PLT on the way um so yeah we just drop a break point in there",
    "start": "1748880",
    "end": "1755240"
  },
  {
    "text": "pretty good so we found select that's good now next interesting thing we have",
    "start": "1755240",
    "end": "1760799"
  },
  {
    "text": "to find uh is where that virtual Channel setup code is that we're going to go ahead and Patch uh in this case it's a",
    "start": "1760799",
    "end": "1766840"
  },
  {
    "text": "function called SSH session 2 open it's for the protocol version two um you have",
    "start": "1766840",
    "end": "1771919"
  },
  {
    "text": "to find that still no debug symbols of course um fortunately for us there's a fairly unique error message in there uh",
    "start": "1771919",
    "end": "1777960"
  },
  {
    "text": "in this case the Duke fails uh and it winges about it with and fortunately that's the only place that that that",
    "start": "1777960",
    "end": "1783399"
  },
  {
    "text": "string is used anywhere in the binary so in this case we find the uh the data section read only data section",
    "start": "1783399",
    "end": "1789960"
  },
  {
    "text": "of the of the elf binary and memory we rumage around we find that string and then we wander through the code segment",
    "start": "1789960",
    "end": "1796279"
  },
  {
    "text": "uh until we find reference refences to that string and at that point we we know we're at a roughly sensible offset uh",
    "start": "1796279",
    "end": "1801840"
  },
  {
    "text": "inside that function that we're looking for is to say session to open now the actual Evil Code itself",
    "start": "1801840",
    "end": "1809120"
  },
  {
    "text": "what's it going to do well we're going to replace the first half of the virtual Channel setup",
    "start": "1809120",
    "end": "1816039"
  },
  {
    "text": "code we're going to uh save the registers um before we execute obviously so we don't uh interrupt the smooth",
    "start": "1816039",
    "end": "1822559"
  },
  {
    "text": "execution of the program and we're going to restore them afterwards um entally what we're going",
    "start": "1822559",
    "end": "1827919"
  },
  {
    "text": "to do is we're going to inject some shell coat and that's going to you know pretty standard sort of boring shell coat it's going to run socket it's going to run connect um once we've got that uh",
    "start": "1827919",
    "end": "1835799"
  },
  {
    "text": "that socket connected we're going to uh put it in place of where SSH would normally expect",
    "start": "1835799",
    "end": "1841120"
  },
  {
    "text": "to find a local file handle to your TTY uh when you normally request a shell so we're just going to glue that puppy",
    "start": "1841120",
    "end": "1846640"
  },
  {
    "text": "together right that's the do of Unix right this whole files and sockets being the same thing that's good I like",
    "start": "1846640",
    "end": "1852200"
  },
  {
    "text": "that and then when it's finished yet we we're going to leave everything just as we found it stack un mangled you know",
    "start": "1852200",
    "end": "1857720"
  },
  {
    "text": "nice and clean uh and the uh the Shell Code that I'm using uh it uses lip eals",
    "start": "1857720",
    "end": "1863360"
  },
  {
    "text": "uh for no no really good reason I could have just use kernel calls but I fig I had ly there I might as well use",
    "start": "1863360",
    "end": "1870200"
  },
  {
    "text": "it now this may sound a little funny right I'm overwriting half a function you might have thought it would be easier to just go ahead and bring my own",
    "start": "1871799",
    "end": "1878519"
  },
  {
    "text": "function that that does everything I need and yes that would have been probably easier in retrospect but it's",
    "start": "1878519",
    "end": "1885120"
  },
  {
    "text": "not uh it's not quite smooth as it seems SSH is a uh is a nasty nasty thing they",
    "start": "1885120",
    "end": "1891000"
  },
  {
    "text": "use a lot of kind of that that data driven metaphor so there's lots of big Global arrays of function pointers you",
    "start": "1891000",
    "end": "1896720"
  },
  {
    "text": "have to mangle with and then everything's asynchronous and you have to you know stick callbacks here and there it's it's really quite messy and",
    "start": "1896720",
    "end": "1902919"
  },
  {
    "text": "what I was trying to avoid is having to link anything by hand at runtime with no symbol information uh that's that's a",
    "start": "1902919",
    "end": "1908360"
  },
  {
    "text": "pretty tedious process so I thought I can just take a function that does most of what I want chop off the top bit",
    "start": "1908360",
    "end": "1914600"
  },
  {
    "text": "which doesn't have anything that needs linking in it uh and just glue my stuff on the top that'll save me a whole bunch of B and it",
    "start": "1914600",
    "end": "1921960"
  },
  {
    "text": "did the downside of that um is that yeah you have to handcraft it for each SSH",
    "start": "1922080",
    "end": "1927279"
  },
  {
    "text": "binary that's ah yeah that's pretty sucky uh because we don't have enough information to write this uh until",
    "start": "1927279",
    "end": "1934480"
  },
  {
    "text": "runtime so uh yeah we'll just go ahead and generate bits and pieces we um we have some Shell Code it has some holes",
    "start": "1934480",
    "end": "1940799"
  },
  {
    "text": "in it we collect some data because we have a hold the bugger available we can disassemble the damn thing if we need to to find out what information we need to",
    "start": "1940799",
    "end": "1947159"
  },
  {
    "text": "right correct Shell Code on the flight um so yeah that's what we",
    "start": "1947159",
    "end": "1951919"
  },
  {
    "text": "do so we find that unique error message we work backwards until we find the",
    "start": "1955760",
    "end": "1961240"
  },
  {
    "text": "beginning of the function uh and we collect a little bit of data we you know collect some things about the stack size",
    "start": "1961240",
    "end": "1966480"
  },
  {
    "text": "um and we patch in a few bits and pieces that we've discovered along the way the PLT entries for uh socket and",
    "start": "1966480",
    "end": "1974000"
  },
  {
    "text": "connect uh and we go ahead and we and we patch them in uh also of course the the script accepts command line parameters",
    "start": "1974000",
    "end": "1979960"
  },
  {
    "text": "so it's user friendly we have to patch those into the Shell Code",
    "start": "1979960",
    "end": "1984440"
  },
  {
    "text": "too and finally it's time to actually go ahead and and wedge this evil code right into SSH so yeah we take a copy of the",
    "start": "1985919",
    "end": "1993200"
  },
  {
    "text": "instruction pointer so we know where we were we back up the code we're about to",
    "start": "1993200",
    "end": "1998240"
  },
  {
    "text": "overwrite and we just go ahead and wedge you on in on top of the function and the",
    "start": "1998240",
    "end": "2003360"
  },
  {
    "text": "idea is we get it just right so the top half and the bottom half you know the register States just so halfway through",
    "start": "2003360",
    "end": "2008840"
  },
  {
    "text": "the execution so we can hand off to the other half of the function uh with all the other difficult bits that I didn't want to",
    "start": "2008840",
    "end": "2014600"
  },
  {
    "text": "link and then we set a break point at the end so that we can uh catch the end of the successful execution of our",
    "start": "2014600",
    "end": "2022720"
  },
  {
    "text": "code so we go ahead and we run it and yeah a bunch of a bunch of output happens uh but the important thing is at",
    "start": "2023919",
    "end": "2030360"
  },
  {
    "text": "the bottom we got ourselves a nck hat Lister and oh look out pops our shell",
    "start": "2030360",
    "end": "2035880"
  },
  {
    "text": "and the guy that little clipart dude right he's playing H the wus as you do right and the oneus still going to kill",
    "start": "2035880",
    "end": "2041279"
  },
  {
    "text": "him his session's very much alive and well and",
    "start": "2041279",
    "end": "2046278"
  },
  {
    "text": "living now interesting question how about SCP you're just copying a far",
    "start": "2048399",
    "end": "2054200"
  },
  {
    "text": "around there's there's no shells involved what what about piping stuff over SSH how many use our sync over SSH",
    "start": "2054200",
    "end": "2060000"
  },
  {
    "text": "or CVS over SSH how many people have SSH embedded in in backup processes and stuff that shuns things around the",
    "start": "2060000",
    "end": "2066118"
  },
  {
    "text": "network you think that just you know data in one side data out the other it's just a pipe right that's all H actually no you can",
    "start": "2066119",
    "end": "2073560"
  },
  {
    "text": "do this on a running ACP no dear a few a few little difficult bits",
    "start": "2073560",
    "end": "2080599"
  },
  {
    "text": "um there's some client clientside checks uh on whether or not we're supposed to be running a remote shell of course we",
    "start": "2080599",
    "end": "2086240"
  },
  {
    "text": "completely control the client so those checks are are just kind of you know",
    "start": "2086240",
    "end": "2091240"
  },
  {
    "text": "humorous so a little for we have to figure out if we're running a remote command",
    "start": "2093119",
    "end": "2098280"
  },
  {
    "text": "um one of the things uh I did to try and avoid having to find the bits of memory that tell me where whether I'm running a",
    "start": "2098280",
    "end": "2104280"
  },
  {
    "text": "ro command or it's much easier just to repaz arv I found the piece of code that uh does the argument passing and we just",
    "start": "2104280",
    "end": "2110119"
  },
  {
    "text": "run that so yeah we read the argument strings we figure out whether we're running a remote command and we take a few little extra extra steps just to",
    "start": "2110119",
    "end": "2117359"
  },
  {
    "text": "make sure uh downside uh SCP connection doesn't get allocated the TTI by the service ey so you get a pretty rough",
    "start": "2117359",
    "end": "2123800"
  },
  {
    "text": "looking shell but it's a root shell right any root shell is a good root shell even if it doesn't have a",
    "start": "2123800",
    "end": "2129119"
  },
  {
    "text": "TDY and the the other thing is uh we are I'm using some uh using a signal to wake",
    "start": "2129200",
    "end": "2134440"
  },
  {
    "text": "up the process after I finished debugging it and we didn't have any signals uh registered any signal handles",
    "start": "2134440",
    "end": "2139760"
  },
  {
    "text": "registered in the case where we're just doing SCP or remote execution um so I",
    "start": "2139760",
    "end": "2145240"
  },
  {
    "text": "just went ahead and installed a signal Handler I mean hey we got a debugger right we can run arbitary code on the Fly why not makes it uh nice and",
    "start": "2145240",
    "end": "2153119"
  },
  {
    "text": "smooth so perhaps perhaps you'd like to go home and Jack yourself",
    "start": "2153119",
    "end": "2158680"
  },
  {
    "text": "well how did you go about that well it's it's it's straightforward what I did and",
    "start": "2158680",
    "end": "2163880"
  },
  {
    "text": "and I guess it's probably the I hope the easiest way uh is just go ahead and and",
    "start": "2163880",
    "end": "2168920"
  },
  {
    "text": "write yourself some hijack code you want to know if it's possible to take the the protocol that you're using uh and and",
    "start": "2168920",
    "end": "2174760"
  },
  {
    "text": "make it do something interesting in this case give me a Shell so I wrote some code that I hooked up to like a magic key press in the SSH client that would",
    "start": "2174760",
    "end": "2181240"
  },
  {
    "text": "spawn me another shell to make sure that there's no problem on the serice side with having you know 2 3 four five six",
    "start": "2181240",
    "end": "2186440"
  },
  {
    "text": "command shells running for a single s session because it's not something that normally happens and it turns out that",
    "start": "2186440",
    "end": "2191960"
  },
  {
    "text": "it worked so at that point I knew I knew it was",
    "start": "2191960",
    "end": "2196800"
  },
  {
    "text": "possible and then yeah it was quite good the uh the compiler generated a bunch of code for me and that was quite a good",
    "start": "2198760",
    "end": "2204400"
  },
  {
    "text": "pointer to writing my shell code nice and easy none of this you know hard work or anything just let the",
    "start": "2204400",
    "end": "2209960"
  },
  {
    "text": "compiler do it right and then I went ahead and implemented uh hijacking for a binary",
    "start": "2209960",
    "end": "2216480"
  },
  {
    "text": "that had had debug symbol so I didn't have to worry about all the signature scanning and stuff right that's a relatively well understood problem it's",
    "start": "2216480",
    "end": "2221760"
  },
  {
    "text": "tedious but you can do it so yeah I I did it with a you know I built SSH with all the debugging symbols available made",
    "start": "2221760",
    "end": "2227640"
  },
  {
    "text": "it nice and easy and once I once I proved that it worked like that it's uh",
    "start": "2227640",
    "end": "2233079"
  },
  {
    "text": "after to the tedious bits which is you to build a list of all the symbols you need and in the case of SSH it was it's",
    "start": "2233079",
    "end": "2239240"
  },
  {
    "text": "pretty nasty they have a whole bunch of just Global crap and pointers everywhere it's so yeah it's it's a bit of a mess",
    "start": "2239240",
    "end": "2247040"
  },
  {
    "text": "so yeah you got to you got to make a whole big list of symbols and then for every single symbol you have to go ahead and come up with a strategy to find them",
    "start": "2247040",
    "end": "2253480"
  },
  {
    "text": "all U tedious but but eventually you know kind of fun and then yeah write some cunning",
    "start": "2253480",
    "end": "2260280"
  },
  {
    "text": "code to do so Jack your friends to front and profit um and then if you're really nice you know a little spin round div",
    "start": "2260280",
    "end": "2266640"
  },
  {
    "text": "Vision one you with the the Hollywood OS and and stuff you know so that you can sell it to Security Consultants or",
    "start": "2266640",
    "end": "2274240"
  },
  {
    "text": "something so yeah think about think about all the things that you you use SSH for right it it gets it really gets",
    "start": "2275160",
    "end": "2281560"
  },
  {
    "text": "around right it's uh I know it's all over my net workor I mean it's such a it's such a useful thing you know it's",
    "start": "2281560",
    "end": "2287359"
  },
  {
    "text": "quite ubiquitous one of the things uh someone",
    "start": "2287359",
    "end": "2292599"
  },
  {
    "text": "asked me at some point was uh you can uh in the middle of your SSH connection uh you can smack the escape sequence and",
    "start": "2292599",
    "end": "2298680"
  },
  {
    "text": "ask it for a list of the virtual channels running over your over your session uh does this the hijack",
    "start": "2298680",
    "end": "2304200"
  },
  {
    "text": "connections show up in that channel in that list of channels yes unfortunately it does of course it's all client side you want to go patch the",
    "start": "2304200",
    "end": "2310040"
  },
  {
    "text": "code to remove it from the list feel free uh of course you can still spot the file descript is open against your SSH",
    "start": "2310040",
    "end": "2315560"
  },
  {
    "text": "process if you're going look look in proc or wherever um but Ian how many of you wander around looking at the proc entries for your SSH clients while",
    "start": "2315560",
    "end": "2321760"
  },
  {
    "text": "you're using them and no I don't and yeah what happens when you log out um I jack your",
    "start": "2321760",
    "end": "2328520"
  },
  {
    "text": "s connection you log out of yours well if you've ever left a port for uh open",
    "start": "2328520",
    "end": "2333599"
  },
  {
    "text": "over your SSH and then you log out of the actual shell bit and your port for is still open and running you'll notice your s connection just seems to stop the",
    "start": "2333599",
    "end": "2339960"
  },
  {
    "text": "shell just waits for the uh for that extra virtual channel to time up same thing happens here uh so basically you",
    "start": "2339960",
    "end": "2346119"
  },
  {
    "text": "can take a very short running process say a nightly SCP backup push sneak a shell across it and that connection will",
    "start": "2346119",
    "end": "2352520"
  },
  {
    "text": "stay alive as long as you want Even after the SCP is done it's pretty",
    "start": "2352520",
    "end": "2358000"
  },
  {
    "text": "useful so how does it work well I how how compatible is it um yeah requires a",
    "start": "2361000",
    "end": "2366599"
  },
  {
    "text": "relatively recent python two 22 and up I it ought to work with 21 there's no good reason why not um but I haven't got any",
    "start": "2366599",
    "end": "2372400"
  },
  {
    "text": "python that old knocking around at the moment uh yeah and it's it's just stuffed to the brim uh with i32 kind of",
    "start": "2372400",
    "end": "2381119"
  },
  {
    "text": "specific thinking uh unfortunately I'm I'm an Intel kind of guy terribly sorry about all your kind of powerpc users",
    "start": "2381119",
    "end": "2386800"
  },
  {
    "text": "you'll all be Intel users soon yeah it should work with pretty",
    "start": "2386800",
    "end": "2392440"
  },
  {
    "text": "much anything open SSH 33 anything um I've tried it on on a few distributions",
    "start": "2392440",
    "end": "2398880"
  },
  {
    "text": "stock Dem inside redhead Enterprise 3 redhead 9 works on slackware the I work",
    "start": "2398880",
    "end": "2404119"
  },
  {
    "text": "with a guy who used to work with suser on the amd64 GCC and I don't know what they did to their compiler but it",
    "start": "2404119",
    "end": "2410480"
  },
  {
    "text": "generates code that's just just nuts right it doesn't even work um so yeah it's pretty broken on Susa at the moment",
    "start": "2410480",
    "end": "2416520"
  },
  {
    "text": "so all you Susu users have to wait for me to get a little sneaky but yeah so it does work it works",
    "start": "2416520",
    "end": "2422160"
  },
  {
    "text": "out of the box um and you know the the stuff that paes the dis assembly of the existing binary to figure out the bits",
    "start": "2422160",
    "end": "2428440"
  },
  {
    "text": "and pieces that works reasonably well now a little brief tangent if you",
    "start": "2428440",
    "end": "2436119"
  },
  {
    "text": "if you'll indulge me um into anti forensic technique now this this uh this",
    "start": "2436119",
    "end": "2441640"
  },
  {
    "text": "um emmo of of moving fast of of getting in there taking the user shells whilst",
    "start": "2441640",
    "end": "2447359"
  },
  {
    "text": "they're using them and just you know not stopping to to root kit up the local box right that's kind of risky right that",
    "start": "2447359",
    "end": "2453640"
  },
  {
    "text": "that that level of you know just just going and doing your thing and and hoping that no one notices you because you're so fast you know yeah you do have",
    "start": "2453640",
    "end": "2460040"
  },
  {
    "text": "to still take a few precautions and I guess you know I take it take it for granted when I'm doing things that",
    "start": "2460040",
    "end": "2465400"
  },
  {
    "text": "probably I shouldn't that I don't want to get caught or sued or anything um so yeah",
    "start": "2465400",
    "end": "2471560"
  },
  {
    "text": "any forensic technique now I think the grug is is talking at this blackhe hat I think he's doing his anti forensic talk",
    "start": "2471560",
    "end": "2477560"
  },
  {
    "text": "that he did last year at ruxcon uh go and see it I mean it's it's really very very interesting if you're into doing",
    "start": "2477560",
    "end": "2484000"
  },
  {
    "text": "forensic analysis or defeating forensic analysis it's you know I'm just going to touch on a couple of little bits and pieces go and see us talk it's",
    "start": "2484000",
    "end": "2491880"
  },
  {
    "text": "good so yeah we're going to look at uh how anti forensic technique and then specifically how we apply it or how I",
    "start": "2491880",
    "end": "2498880"
  },
  {
    "text": "applied it in implementing the SSH Jacker and how well we're doing so what are the bits that are that",
    "start": "2498880",
    "end": "2505839"
  },
  {
    "text": "are relevant to us well the really the best thing right is is don't don't leave anything on the disc right don't don't",
    "start": "2505839",
    "end": "2511440"
  },
  {
    "text": "touch it right we're going to use an interpreted scripting language so we're already in a pretty good position there",
    "start": "2511440",
    "end": "2517520"
  },
  {
    "text": "we're going to try and keep everything in memory because if everything's in memory right there's no trip wire to spot you there's no no evidence on dis",
    "start": "2517520",
    "end": "2523440"
  },
  {
    "text": "for people to you know go around and read the sectors after you deleted it and then we're going to try and use",
    "start": "2523440",
    "end": "2529760"
  },
  {
    "text": "only locally available tools and interpreters um that way we don't have to bring any of our own wild zero day",
    "start": "2529760",
    "end": "2535560"
  },
  {
    "text": "and Magic tall is called zero day. tar.gz that we download from you know hack.com Big Damn giveaway we don't want",
    "start": "2535560",
    "end": "2542359"
  },
  {
    "text": "them to be able to use their ideas to reconstruct our tall full of goodness or whatever so yeah if we use a a local interpreter",
    "start": "2542359",
    "end": "2548960"
  },
  {
    "text": "T in complete interpreter right they they don't know what we did they know we did something but you know if they've",
    "start": "2548960",
    "end": "2554400"
  },
  {
    "text": "got as far as figuring out they got themselves hacked they probably figured that we did something right so go ahead",
    "start": "2554400",
    "end": "2559520"
  },
  {
    "text": "and use your local interpreter and if you're really good you just write your tools as you need",
    "start": "2559520",
    "end": "2564880"
  },
  {
    "text": "them on the spot right if you get into a box it's got Pearl suck well you write your write your tools on the spot in P",
    "start": "2564880",
    "end": "2570760"
  },
  {
    "text": "you need a port scanner go ahead and write one in Python in bash if you have to right it's much better than than bringing your own you",
    "start": "2570760",
    "end": "2577520"
  },
  {
    "text": "know nmap binary around they can figure out where you compiled it and ah jeez and then the other thing to avoid",
    "start": "2577520",
    "end": "2584400"
  },
  {
    "text": "is is new network connections you don't want any Telltale reverse shells connecting out like we did earlier on",
    "start": "2584400",
    "end": "2589960"
  },
  {
    "text": "outbound 443 bad idea we want to avoid making new network connections so wherever possible we want",
    "start": "2589960",
    "end": "2596040"
  },
  {
    "text": "to reuse our existing connections um or if we have to we hide and plan sight you know stick things inside DNS packets or",
    "start": "2596040",
    "end": "2601559"
  },
  {
    "text": "whatever sort of you know sneakiness Dan kaminsky's up to these days",
    "start": "2601559",
    "end": "2607760"
  },
  {
    "text": "so how do we do it I mean how does the my SSH Jacker how does it look uh",
    "start": "2607760",
    "end": "2612920"
  },
  {
    "text": "compared to those those techniques well not too bad we we do use general purpose",
    "start": "2612920",
    "end": "2618440"
  },
  {
    "text": "tools we use Python you know we're quite happy with whatever version of Python's knocking around we only use standard python libraries that's that's good we",
    "start": "2618440",
    "end": "2624640"
  },
  {
    "text": "use GDB it's not guaranteed to be installed anywhere I admit um hopefully you don't do a lot of debugging on your production servers but bear in mind this",
    "start": "2624640",
    "end": "2631280"
  },
  {
    "text": "attack is primarily targeted towards desktop machines and even if you you know you get somewhere you find there is no GDB",
    "start": "2631280",
    "end": "2637520"
  },
  {
    "text": "well you probably could install it right have get install GDB that's pretty straightforward you know RPM and I mean what is what is",
    "start": "2637520",
    "end": "2643920"
  },
  {
    "text": "installing a standard package that that exists in everyone's distribution going to tell them when they do their forensic analysis well you know maybe you're a",
    "start": "2643920",
    "end": "2649920"
  },
  {
    "text": "good sisin maybe you like installing things I don't know SSH it's already encrypted that's",
    "start": "2649920",
    "end": "2655680"
  },
  {
    "text": "good so our SSH connections uh that if we you know we're running across there's no uh no worry about the IDS sniffing",
    "start": "2655680",
    "end": "2663520"
  },
  {
    "text": "that and figuring out what our our shell was up to and yeah we're sneaking down in the existing SSH connection so that's pretty",
    "start": "2663520",
    "end": "2669400"
  },
  {
    "text": "good you know no IDs is going to spot extra stuff flying around but yeah where do I suck well",
    "start": "2669400",
    "end": "2676760"
  },
  {
    "text": "we've still got some python code lying around the disc right at the moment I can copy across my python script far it",
    "start": "2676760",
    "end": "2682079"
  },
  {
    "text": "up and run it but yeah that touches dis that's not so good uh and then of course there's the uh the connect back from the",
    "start": "2682079",
    "end": "2689280"
  },
  {
    "text": "the socket Shell Code that we inject um that's a whole new connection for them to spot and even worse it's in the clear",
    "start": "2689280",
    "end": "2696839"
  },
  {
    "text": "that's not so good so yeah we need we need to try a little bit harder one quite obvious thing is if you came in",
    "start": "2696839",
    "end": "2702079"
  },
  {
    "text": "Via SSH and you want to get a TCP connection back well hey that's what SSH does right it shovels TCP connections around inside encrypted Tunnels for you",
    "start": "2702079",
    "end": "2708839"
  },
  {
    "text": "that's great so if you're in a position to do that excellent solved that",
    "start": "2708839",
    "end": "2715359"
  },
  {
    "text": "problem how about loading python directly into memory so we don't have to leave our scripts lying around this with",
    "start": "2715559",
    "end": "2721000"
  },
  {
    "text": "all the comments and email me if it doesn't work kind of thing so yeah let's just go ahead and",
    "start": "2721000",
    "end": "2727400"
  },
  {
    "text": "fire ourselves up a python interpreter well we ask it to read from standard in and just go ahead and execute whatever it finds that's good and then maybe on",
    "start": "2727400",
    "end": "2734960"
  },
  {
    "text": "the client side we want to uh build a little you know little encoder that takes an arbitrary python",
    "start": "2734960",
    "end": "2740720"
  },
  {
    "text": "script compiles it takes the bike code compresses it up you know base 64s it to",
    "start": "2740720",
    "end": "2745800"
  },
  {
    "text": "get across whatever shells you had to bounce through to get there um and then write something on the other end that'll unpack it and run it that that would be",
    "start": "2745800",
    "end": "2752040"
  },
  {
    "text": "pretty cool yeah well that that's kind of know what it did uh so I wrote a thing called",
    "start": "2752040",
    "end": "2758520"
  },
  {
    "text": "MAF load it's the metal Storm's anti forensic loader loader I guess uh yeah",
    "start": "2758520",
    "end": "2764079"
  },
  {
    "text": "there was meant to be other things as well I only got the loader done in time so yeah I wrote a script nice and",
    "start": "2764079",
    "end": "2769599"
  },
  {
    "text": "easy you run it on your local client uh it generates encoded python uh bite code",
    "start": "2769599",
    "end": "2775200"
  },
  {
    "text": "on standard out that's everything we talked about previously and so if you if you're a",
    "start": "2775200",
    "end": "2781119"
  },
  {
    "text": "clever hacker uh or if you're me you might use screens screens are for those who who are not familiar with it with",
    "start": "2781119",
    "end": "2786559"
  },
  {
    "text": "hopefully there no one um it's a effectively a terminal multiplexer you can have multiple uh running terminal",
    "start": "2786559",
    "end": "2793160"
  },
  {
    "text": "sessions attached to your one terminal window one of the things uh that it does do that's really cool uh is it has a",
    "start": "2793160",
    "end": "2798440"
  },
  {
    "text": "function that allows you to execute a local script uh and then send the output of that local script to your running",
    "start": "2798440",
    "end": "2803960"
  },
  {
    "text": "shell to your running uh terminal like you type the input in so in this case I go control a bang bang bang bang bang",
    "start": "2803960",
    "end": "2810520"
  },
  {
    "text": "bang math load and then pass it the the script I want to run and the command line arguments and it goes ahead starts",
    "start": "2810520",
    "end": "2818200"
  },
  {
    "text": "a python interpreter on on the remote end encodes it locally sends it across runs it just like I was there except",
    "start": "2818200",
    "end": "2823480"
  },
  {
    "text": "nothing touch dis and that should work for pretty much any any you know python script uh if you have uh dependencies",
    "start": "2823480",
    "end": "2829480"
  },
  {
    "text": "you need extra python uh libraries you require you can just go ahead and Supply those on the command line as",
    "start": "2829480",
    "end": "2836640"
  },
  {
    "text": "well yeah it's so easy right you see the shell on the remote end you you smack control a and it runs it on the other",
    "start": "2837680",
    "end": "2843960"
  },
  {
    "text": "end it's great right you don't have to think about where you're running the code you know it's like like the days when someone first invented a sscore proxy right it's really",
    "start": "2843960",
    "end": "2852359"
  },
  {
    "text": "cool so what else could we do um at the moment it just patches patches the",
    "start": "2853520",
    "end": "2859680"
  },
  {
    "text": "existing Shell Code um it would be much cooler if it actually went ahead and assembled it on the fly with most Dev or",
    "start": "2859680",
    "end": "2864760"
  },
  {
    "text": "something I don't think I don't know if Dave atle's here or what but yeah you could do it some documentation dude that's uh that's not so good a pure",
    "start": "2864760",
    "end": "2872839"
  },
  {
    "text": "python debugger that would be really cool um just go ahead use P trce remove the dependency on GDB that would make it",
    "start": "2872839",
    "end": "2878960"
  },
  {
    "text": "kind of easier to deploy yeah and of course the the i32 thing there's no reason it can't work uh",
    "start": "2878960",
    "end": "2885760"
  },
  {
    "text": "on any other platform but H this is the interesting thing what other",
    "start": "2885760",
    "end": "2892079"
  },
  {
    "text": "protocols have virtual Channel infrastructure well the two that come to mind that you're going to see on client",
    "start": "2892079",
    "end": "2897880"
  },
  {
    "text": "devices MSRP uh and Citrix both of which support quite a similar sort of idea to",
    "start": "2897880",
    "end": "2903960"
  },
  {
    "text": "SSH virtual channels for shoveling things like audio redirection around and drive mappings and comport mappings and",
    "start": "2903960",
    "end": "2909800"
  },
  {
    "text": "and all that other stuff that you paid good money for in your uh in your Thin Client",
    "start": "2909800",
    "end": "2915000"
  },
  {
    "text": "protocols and of course uh all manner of of domain specific sneakiness right once you got a A programmatic debugging",
    "start": "2915000",
    "end": "2921040"
  },
  {
    "text": "toolkit uh you begin to see all sorts of you know things you can hit with that hammer um all manner of sneaky",
    "start": "2921040",
    "end": "2929039"
  },
  {
    "text": "things now being as it is that I'm from the antipodes you know and I'm not very fashionable uh so I'm not sure if if",
    "start": "2931240",
    "end": "2938240"
  },
  {
    "text": "blaming Theo for everything is still kind of the the you know the thing to do around here unfortunately if it is",
    "start": "2938240",
    "end": "2943960"
  },
  {
    "text": "terribly sorry it's not actually Theo's fault it's uh it's technically a feature",
    "start": "2943960",
    "end": "2949599"
  },
  {
    "text": "uh the S protocol specification I was quite surprised actually the S protocol specification says multiple shells down",
    "start": "2949599",
    "end": "2955040"
  },
  {
    "text": "in s connection is just fine in fact I think it's even a requirement of the spec um the normal s clients you and I",
    "start": "2955040",
    "end": "2962359"
  },
  {
    "text": "use don't do it I don't see why not probably be quite useful really",
    "start": "2962359",
    "end": "2967520"
  },
  {
    "text": "if we could get shells from the server back to the client because you got to remember an SSH because of this whole virtual Channel thing the SSH client on",
    "start": "2967520",
    "end": "2973920"
  },
  {
    "text": "the server are almost identical pieces of code they they have much of the same functionality and there's no reason that",
    "start": "2973920",
    "end": "2980960"
  },
  {
    "text": "the shell couldn't go ahead and send a packet the server couldn't send a packet to the client saying how about you give me a Shell um unfortunately yeah they",
    "start": "2980960",
    "end": "2988280"
  },
  {
    "text": "thought of that there's a piece of cod which checks for it uh it would be quite a sneaky back door if you wanted to uh to patch the client to allow server",
    "start": "2988280",
    "end": "2994960"
  },
  {
    "text": "shells back backwards um then if you owned a big shell host you could kind of spread out from there um and also uh",
    "start": "2994960",
    "end": "3003000"
  },
  {
    "text": "unsolicited server to client port forwarding that would be pretty cool s client connects to your malicious server",
    "start": "3003000",
    "end": "3008400"
  },
  {
    "text": "you open up a port forward backwards uh unfortunately once again there's code to think about that now of course I've only",
    "start": "3008400",
    "end": "3014480"
  },
  {
    "text": "looked at open SSH uh if you have other SSH implementations that are are less",
    "start": "3014480",
    "end": "3019599"
  },
  {
    "text": "trustworthy perhaps you might want to have a look and just make sure that uh they don't go ahead and Implement that like I mean everyone uses putty on",
    "start": "3019599",
    "end": "3025480"
  },
  {
    "text": "Windows right who knows what that does probably should read that sometime but yeah open Sage is cool this",
    "start": "3025480",
    "end": "3032559"
  },
  {
    "text": "is entirely not their fault uh if you get your sh connections Jack then don't go crying to Theo come and abuse me",
    "start": "3032559",
    "end": "3037799"
  },
  {
    "text": "instead please I don't want Theo to get mad at me and Flame",
    "start": "3037799",
    "end": "3042400"
  },
  {
    "text": "me so mitigation technique like the respon sorry the responsible bit of the talk begins here right first thing you",
    "start": "3042839",
    "end": "3048720"
  },
  {
    "text": "do just just don't get rooted that would be really good right that you mitigate a whole bunch of stuff right",
    "start": "3048720",
    "end": "3053880"
  },
  {
    "text": "there a couple ideas are you could patch the kernel to restrict P Trace to rout I",
    "start": "3053880",
    "end": "3059119"
  },
  {
    "text": "me on a on most machines you you don't really want your users debugging stuff it's not a great solution uh there's",
    "start": "3059119",
    "end": "3064880"
  },
  {
    "text": "existing patches out there to do that um I saw it suggested uh as a kind of a",
    "start": "3064880",
    "end": "3070520"
  },
  {
    "text": "loadable kernel module users a workaround against one of the kernel PR escalation sploits that use pet trce um",
    "start": "3070520",
    "end": "3076799"
  },
  {
    "text": "you could do that it's ugly um funnily enough the uh there's a program called SSH agent uh which is responsible for",
    "start": "3076799",
    "end": "3083920"
  },
  {
    "text": "handing out your keys to people without you asking or something um anyway they kind of thought about this for SS agent",
    "start": "3083920",
    "end": "3090440"
  },
  {
    "text": "and in in the installs I've seen often you'll find it uh it's it's set G um on",
    "start": "3090440",
    "end": "3096440"
  },
  {
    "text": "Linux at least you can't pet race attach uh to a process that set G or set ID um",
    "start": "3096440",
    "end": "3102559"
  },
  {
    "text": "so in this case yeah this this attack wouldn't work as non-root against SSH agent and you could you could set the G",
    "start": "3102559",
    "end": "3109079"
  },
  {
    "text": "bit on your SSH client now of course that comes with a whole bunch of other responsibilities like making sure you can't leverage the fact that it's set G",
    "start": "3109079",
    "end": "3115960"
  },
  {
    "text": "uh to mess with other people's SSH clients uh so I'd probably be kind of careful before I did that um one of the",
    "start": "3115960",
    "end": "3122839"
  },
  {
    "text": "most important things you can do um is where this is is a really powerful attack is where we have automated SSH",
    "start": "3122839",
    "end": "3128640"
  },
  {
    "text": "where we have uh trusts between hosts using SSH key authentication um if you",
    "start": "3128640",
    "end": "3136119"
  },
  {
    "text": "read the SSH Man pages um for the authorized hosts file you'll find there's a whole bunch of directives you",
    "start": "3136119",
    "end": "3141720"
  },
  {
    "text": "can use uh to limit what a key can be used for you limit uh what whether port",
    "start": "3141720",
    "end": "3147280"
  },
  {
    "text": "forwarding is allowed whether X forwarding is allowed uh where Port forwards can connect to what commands it",
    "start": "3147280",
    "end": "3152319"
  },
  {
    "text": "can run locally right that's very very useful if I find a trust relationship between two boxes and the key on the",
    "start": "3152319",
    "end": "3157920"
  },
  {
    "text": "server side it says this is only valid for executing you know user games hunt",
    "start": "3157920",
    "end": "3163119"
  },
  {
    "text": "the wus right then I can't get a shell out of that it's only going to give me more more games of wus right and I can play that at",
    "start": "3163119",
    "end": "3169119"
  },
  {
    "text": "home so that's that's a a really good thing and of course my personal favorite mitigation technique right is Steve",
    "start": "3169119",
    "end": "3175319"
  },
  {
    "text": "Gibson right he's got it all sorted out that raw sockets thing right raw sockets wildly evil we SE to buggers let's just",
    "start": "3175319",
    "end": "3181040"
  },
  {
    "text": "go ahead and get Microsoft to take the buggers out of their operating systems and I'll Rite an email to Richard storman and tell him I want him to you",
    "start": "3181040",
    "end": "3186559"
  },
  {
    "text": "know rmrf his GDB tree that that' be pretty",
    "start": "3186559",
    "end": "3192720"
  },
  {
    "text": "good so yeah why why do you care well well probably probably you",
    "start": "3193760",
    "end": "3199440"
  },
  {
    "text": "don't right it's it's it's nothing you didn't already know right I mean I get a debugger I can see a process I can to it",
    "start": "3199440",
    "end": "3205559"
  },
  {
    "text": "I can make it do sneaky stuff whoopy do yeah and if you get rooted by your",
    "start": "3205559",
    "end": "3211040"
  },
  {
    "text": "screen this is this is nothing wildly wildly different the only thing I think is is really interesting is attacking",
    "start": "3211040",
    "end": "3218160"
  },
  {
    "text": "server systems through client systems right we see that in the windows world all the time but that's the way you do it you send someone an Outlook you know",
    "start": "3218160",
    "end": "3224400"
  },
  {
    "text": "click on my dancing bears or whatever uh and you run it and then from there you can go ahead and root the service so",
    "start": "3224400",
    "end": "3230440"
  },
  {
    "text": "that's a you know that's a pretty standard technique it applies applicably um on on Linux desktops as well um and",
    "start": "3230440",
    "end": "3238119"
  },
  {
    "text": "of course yeah the really interesting one would be similar attacks against um against IC and against MSRP and I've",
    "start": "3238119",
    "end": "3244680"
  },
  {
    "text": "I've talked to a few Windows bunnies about this and there's a couple of people kind of playing with this idea um for Citrix so you might see something",
    "start": "3244680",
    "end": "3251440"
  },
  {
    "text": "interesting relatively soon hackers May me do it it's not my",
    "start": "3251440",
    "end": "3257839"
  },
  {
    "text": "fault right I I was brainwashed I went to roxon I saw some some good talks and",
    "start": "3257839",
    "end": "3262920"
  },
  {
    "text": "yeah it was uh I became evil it was terrible yeah and the grug if you if you get to",
    "start": "3262920",
    "end": "3269000"
  },
  {
    "text": "go and see his talk please do uh there's a guy called Shan CL Australian guy he wrote this uh this co- co-resident elf",
    "start": "3269000",
    "end": "3276559"
  },
  {
    "text": "encryptor thing we's got two processes that both debug each other and then kind of page memory in and out of each other and decrypt it on the flight it's it's",
    "start": "3276559",
    "end": "3283400"
  },
  {
    "text": "just insane I have no idea how he wrote it and stay Stayed sane um if you ever",
    "start": "3283400",
    "end": "3288440"
  },
  {
    "text": "want to try doing Cooper protection in the Linux environment or you want to prevent your Linux binaries from being reverse engineered go try out Shiva it's",
    "start": "3288440",
    "end": "3294520"
  },
  {
    "text": "it's it's just nuts right I mean uh it was it was pretty cool I was sitting in the audience going man that this a crazy",
    "start": "3294520",
    "end": "3302000"
  },
  {
    "text": " right there and and Sylvio um it's another Australian guy uh you know real",
    "start": "3302000",
    "end": "3308400"
  },
  {
    "text": "Godfather in the in the virus scene he had a few good ideas um and then yeah",
    "start": "3308400",
    "end": "3314000"
  },
  {
    "text": "there there's not much of a security scene in New Zealand um I suppose I have to at least say hi to some of them you",
    "start": "3314000",
    "end": "3319760"
  },
  {
    "text": "know hi mom um so yeah NZ I NZ 2600 um Southern Lights who uh New Zealand's",
    "start": "3319760",
    "end": "3325799"
  },
  {
    "text": "only kind of hacker crew for a while there went very stealthy got yeah de and he was a guy called GBU gave me a",
    "start": "3325799",
    "end": "3333440"
  },
  {
    "text": "copy of chair work in Bellin many years ago uh which was the start of my career as a as a good evil",
    "start": "3333440",
    "end": "3340160"
  },
  {
    "text": "person right I yeah the the demo time right everybody everybody loves to see the",
    "start": "3340160",
    "end": "3345280"
  },
  {
    "text": "demo assuming we've got time may we how's the symbols for the time all good",
    "start": "3345280",
    "end": "3350760"
  },
  {
    "text": "it's all good right you have to excuse me because",
    "start": "3350760",
    "end": "3356400"
  },
  {
    "text": "I can't see it on my screen at the same time so this may be a little little furry oh",
    "start": "3356400",
    "end": "3363119"
  },
  {
    "text": "jeez actually I'll just set it up I I'll flip back in a",
    "start": "3367079",
    "end": "3373078"
  },
  {
    "text": "second yeah we are way ahead of here got a big old neet cat right here",
    "start": "3376839",
    "end": "3386920"
  },
  {
    "text": "do",
    "start": "3414039",
    "end": "3416880"
  },
  {
    "text": "all right so in the uh lower left hand corner I just SS to Local Host as root",
    "start": "3434319",
    "end": "3440440"
  },
  {
    "text": "so from using me uh to rout on my local machine I'm running top you know something",
    "start": "3440440",
    "end": "3446160"
  },
  {
    "text": "interactive uh top we have a nice uh nice net cap listing on Port 1337 quite",
    "start": "3446160",
    "end": "3452960"
  },
  {
    "text": "appropriate uh and on the right hand side down about where the hell's my",
    "start": "3452960",
    "end": "3459599"
  },
  {
    "text": "mouse now there it is goddamn Mouse",
    "start": "3460280",
    "end": "3465440"
  },
  {
    "text": "focus and over there we have the SS Jacker I plugged in the process ID of the SSH",
    "start": "3465440",
    "end": "3471839"
  },
  {
    "text": "client and you just keep an eye on that neck cat up the top there",
    "start": "3471839",
    "end": "3476798"
  },
  {
    "text": "and if you're cunning you'll know that the top will still be running at the",
    "start": "3479520",
    "end": "3484038"
  },
  {
    "text": "end demo curse huh did I forget to smack enter up there",
    "start": "3488680",
    "end": "3495000"
  },
  {
    "text": "die jeez let's try that again one of the great things about this is you can open up as many virtual channels as you like",
    "start": "3495000",
    "end": "3500680"
  },
  {
    "text": "so you want a dozen shells at the other end it's all good where's that pisky",
    "start": "3500680",
    "end": "3508400"
  },
  {
    "text": "Mouse oh look a ro chill how",
    "start": "3515039",
    "end": "3519799"
  },
  {
    "text": "nice so yeah that's the uh that's the money shot right there everybody loves that",
    "start": "3523200",
    "end": "3531559"
  },
  {
    "text": "huh where's that open Office",
    "start": "3531920",
    "end": "3536720"
  },
  {
    "text": "and finally yeah if you want to spam me that's my that's my email address and yeah questions uh I'm sure",
    "start": "3543400",
    "end": "3550960"
  },
  {
    "text": "this is all you know just a party trip with a debugger guys so hopefully you got a few questions to kind of shred me up a",
    "start": "3550960",
    "end": "3557839"
  },
  {
    "text": "bit",
    "start": "3563640",
    "end": "3566640"
  },
  {
    "text": "sorry um the connections from the client to your netcat listener yes you can see",
    "start": "3572119",
    "end": "3577799"
  },
  {
    "text": "those uh so obviously you want to keep it as quick as possible um if you were cunning and you came in across SSH you",
    "start": "3577799",
    "end": "3583280"
  },
  {
    "text": "could uh run them locally across Local Host uh port for them back to your wherever you're coming from at least",
    "start": "3583280",
    "end": "3588680"
  },
  {
    "text": "then you know they wouldn't be going past an IDs somewhere but yes they do show up in your local net stat if you",
    "start": "3588680",
    "end": "3593720"
  },
  {
    "text": "happen to be root I mean obviously you can only pet trce attach the processes that are the same user ID as you um or",
    "start": "3593720",
    "end": "3600319"
  },
  {
    "text": "if you're root you can attach to anybody if you're root then yeah you could also hook up your root kit to Trojan uh Trojan the output of n that all the",
    "start": "3600319",
    "end": "3606559"
  },
  {
    "text": "usual techniques for hiding a connection but yeah it does it does show up",
    "start": "3606559",
    "end": "3611920"
  },
  {
    "text": "unfortunately that's all good thank you very much",
    "start": "3617920",
    "end": "3626559"
  },
  {
    "text": "e",
    "start": "3683440",
    "end": "3686440"
  },
  {
    "text": "e",
    "start": "3713440",
    "end": "3716440"
  },
  {
    "text": "e",
    "start": "3743359",
    "end": "3746359"
  },
  {
    "text": "e",
    "start": "3773359",
    "end": "3776359"
  },
  {
    "text": "e",
    "start": "3833279",
    "end": "3836279"
  },
  {
    "text": "e",
    "start": "3863200",
    "end": "3866200"
  },
  {
    "text": "e",
    "start": "3923079",
    "end": "3926079"
  },
  {
    "text": "e",
    "start": "3953079",
    "end": "3956079"
  },
  {
    "text": "e",
    "start": "3983000",
    "end": "3986000"
  },
  {
    "text": "e",
    "start": "4013000",
    "end": "4016000"
  },
  {
    "text": "e",
    "start": "4042920",
    "end": "4045920"
  },
  {
    "text": "e",
    "start": "4072920",
    "end": "4075920"
  },
  {
    "text": "e",
    "start": "4102839",
    "end": "4105838"
  },
  {
    "text": "e",
    "start": "4132799",
    "end": "4135798"
  },
  {
    "text": "e",
    "start": "4162719",
    "end": "4165719"
  },
  {
    "text": "e",
    "start": "4192719",
    "end": "4195719"
  },
  {
    "text": "e",
    "start": "4222640",
    "end": "4225640"
  },
  {
    "text": "e",
    "start": "4252640",
    "end": "4255640"
  },
  {
    "text": "e",
    "start": "4282560",
    "end": "4285560"
  },
  {
    "text": "e",
    "start": "4312560",
    "end": "4315560"
  },
  {
    "text": "e",
    "start": "4342480",
    "end": "4345480"
  },
  {
    "text": "e",
    "start": "4372440",
    "end": "4375440"
  },
  {
    "text": "e",
    "start": "4402360",
    "end": "4405360"
  },
  {
    "text": "e",
    "start": "4432360",
    "end": "4435360"
  },
  {
    "text": "e",
    "start": "4462280",
    "end": "4465280"
  },
  {
    "text": "e",
    "start": "4522199",
    "end": "4525199"
  },
  {
    "text": "e",
    "start": "4552199",
    "end": "4555199"
  }
]