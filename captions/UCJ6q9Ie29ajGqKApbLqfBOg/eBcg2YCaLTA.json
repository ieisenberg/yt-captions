[
  {
    "start": "0",
    "end": "180000"
  },
  {
    "text": "uh good morning everybody there is still people coming in",
    "start": "80",
    "end": "6200"
  },
  {
    "text": "still I suggest we get",
    "start": "6200",
    "end": "11519"
  },
  {
    "text": "started Welcome to our talk on idps evasion in the age of IPv6 my name is",
    "start": "11519",
    "end": "18320"
  },
  {
    "text": "eno over there is antoniio and this is Rafael Antonius and I some while ago we",
    "start": "18320",
    "end": "24000"
  },
  {
    "text": "started building a lab for testing IPv6 Security in various",
    "start": "24000",
    "end": "31759"
  },
  {
    "text": "ways at some point Rafael joined us to WR to see this uh on the exact topic and we made",
    "start": "31759",
    "end": "40160"
  },
  {
    "text": "some what we think quite interesting observation when it comes to uh certain",
    "start": "40160",
    "end": "45200"
  },
  {
    "text": "elements of IPv6 namely the extension headers and how they interact with",
    "start": "45200",
    "end": "51399"
  },
  {
    "text": "current security models uh especially when it comes to idps and um detection",
    "start": "51399",
    "end": "58559"
  },
  {
    "text": "techniques which can be as we will show s wied uh the agenda of our talk is quite",
    "start": "58559",
    "end": "64478"
  },
  {
    "text": "simple uh we will give some introduction on what those extensions headers are how",
    "start": "64479",
    "end": "70040"
  },
  {
    "text": "they work how they interact with fragmentation or we will give some",
    "start": "70040",
    "end": "76479"
  },
  {
    "text": "overview of the lab we built and of course we will have some results and some nice",
    "start": "76479",
    "end": "83040"
  },
  {
    "text": "demos we assume that most of you are to some degree familiar with IPv6 we",
    "start": "83040",
    "end": "89320"
  },
  {
    "text": "further as assume that uh you aware that IPv6 is there right now it's not uh no longer",
    "start": "89320",
    "end": "98040"
  },
  {
    "text": "like oh this will happen at someday if at all these are the numbers from",
    "start": "98040",
    "end": "104040"
  },
  {
    "text": "Belgium the nice neighboring country uh in Belgium we have right now",
    "start": "104040",
    "end": "112119"
  },
  {
    "text": "about 27% of users IPv6 enabled so 27% of people uh can use IPv6 when accessing",
    "start": "112119",
    "end": "120960"
  },
  {
    "text": "uh the internet and this means uh this has been a part which was delayed for",
    "start": "120960",
    "end": "126680"
  },
  {
    "text": "many years there was a number of say content or Services already IPv6 enabled",
    "start": "126680",
    "end": "132239"
  },
  {
    "text": "there was a number of carriers transporting it but so far there was a lack of users which has been cured in",
    "start": "132239",
    "end": "139560"
  },
  {
    "text": "the say last 6 to 12 months to some degree even Greece where Antonio lives",
    "start": "139560",
    "end": "145519"
  },
  {
    "text": "uh three months ago there was just 1% of IPv6 users and then we win one one of that jump to 5% so IPv6 is there IPv6 is",
    "start": "145519",
    "end": "154720"
  },
  {
    "text": "there even if you think in your environment you don't have it as probably some of you are aware Windows",
    "start": "154720",
    "end": "161040"
  },
  {
    "text": "comes with iv6 by default enabled many other operating systems do the same in interim so you should expect IPv6 to be",
    "start": "161040",
    "end": "168640"
  },
  {
    "text": "present um either within your organization or at least um to some degree like",
    "start": "168640",
    "end": "176080"
  },
  {
    "text": "coming from the internet uh to your premises",
    "start": "176080",
    "end": "181760"
  },
  {
    "start": "180000",
    "end": "480000"
  },
  {
    "text": "so uh talking about um IPv6 some of you",
    "start": "182040",
    "end": "188480"
  },
  {
    "text": "might think well it's just um ipv4 with longer address space actually it isn't",
    "start": "188480",
    "end": "194640"
  },
  {
    "text": "it's fundamentally different in the way it works in the way it works on the network",
    "start": "194640",
    "end": "200280"
  },
  {
    "text": "layer and one of the main differences is a concept called extension headers which",
    "start": "200280",
    "end": "206560"
  },
  {
    "text": "have been within IPv6 from the very beginning there is the main RFC uh",
    "start": "206560",
    "end": "213519"
  },
  {
    "text": "2460 which kind of marked the beginning of IPv6 specification there were earlier",
    "start": "213519",
    "end": "218879"
  },
  {
    "text": "ones were 2460 is the main one and that one has a huge section on these",
    "start": "218879",
    "end": "224480"
  },
  {
    "text": "extensions set us and how they walk and to give you a quick intro on that an",
    "start": "224480",
    "end": "230519"
  },
  {
    "text": "IPv6 datagram can be thought like a like a German train uh trains in other",
    "start": "230519",
    "end": "236079"
  },
  {
    "text": "countries too obviously but um with wagons and then the number of wagons might not be clear when",
    "start": "236079",
    "end": "243239"
  },
  {
    "text": "the uh train leaves the leaves the station it might have Chang them once",
    "start": "243239",
    "end": "248799"
  },
  {
    "text": "the train arrived somewhere uh so it's composed of let's",
    "start": "248799",
    "end": "254200"
  },
  {
    "text": "say elements and these elements actually from a technical",
    "start": "254200",
    "end": "259440"
  },
  {
    "text": "perspective are headers which are inserted after what is in IPv6 par",
    "start": "259440",
    "end": "265320"
  },
  {
    "text": "called the main header like in most Network protocols as a header the mean difference or a big difference",
    "start": "265320",
    "end": "272280"
  },
  {
    "text": "now being after this one additional headers for specific purposes can be",
    "start": "272280",
    "end": "278639"
  },
  {
    "text": "inserted which right now there is",
    "start": "278639",
    "end": "283680"
  },
  {
    "text": "even say 18 years after the initial specification of IPv6 there was not much",
    "start": "283680",
    "end": "289560"
  },
  {
    "text": "practical use of these extension headers in actual Play services or network",
    "start": "289560",
    "end": "296080"
  },
  {
    "text": "protocols uh but given they have been there from the be beginning given they have been there in the initial",
    "start": "296080",
    "end": "302199"
  },
  {
    "text": "specification every stack is assumed to support those and every middle box as",
    "start": "302199",
    "end": "308320"
  },
  {
    "text": "it's called in ip6 language stuff like firewalls idps uh proxies all these",
    "start": "308320",
    "end": "314759"
  },
  {
    "text": "elements have to support them whereas supporting",
    "start": "314759",
    "end": "320600"
  },
  {
    "text": "means uh first of all there is a number of say well-known extension headers",
    "start": "320600",
    "end": "327280"
  },
  {
    "text": "that's the one which can be seen here uh some of those will uh be covered in more",
    "start": "327280",
    "end": "332400"
  },
  {
    "text": "detail later uh next to that there might be new extension",
    "start": "332400",
    "end": "337600"
  },
  {
    "text": "headers and the RSC 2460 recommends a certain order of these",
    "start": "337600",
    "end": "345720"
  },
  {
    "text": "uh extension headers once they are in a packet and there was a recommendation",
    "start": "345720",
    "end": "351039"
  },
  {
    "text": "that except for one that is the uh destination options header they should occur mostly once",
    "start": "351039",
    "end": "361479"
  },
  {
    "text": "but it does not specify or recommend or whatever what happens if those recommendations are not",
    "start": "361880",
    "end": "369160"
  },
  {
    "text": "followed and some of you might know in the internet there is a old principle on",
    "start": "369160",
    "end": "376160"
  },
  {
    "text": "Old Law the robustness principle or postals law which we are big fans of in",
    "start": "376160",
    "end": "381720"
  },
  {
    "text": "many aspects both when it comes to networking and when it comes to real life this robustness principle",
    "start": "381720",
    "end": "388560"
  },
  {
    "text": "essentially says um be conservative in what you send once you compose a packet",
    "start": "388560",
    "end": "394280"
  },
  {
    "text": "follow the specifications but be liberal in what you accept once somebody else",
    "start": "394280",
    "end": "399360"
  },
  {
    "text": "sends you a packet well um allow some flexibility",
    "start": "399360",
    "end": "404880"
  },
  {
    "text": "there as long as you have an idea what this packet is about process",
    "start": "404880",
    "end": "410639"
  },
  {
    "text": "it uh and this robustness principle might play a certain role in",
    "start": "410639",
    "end": "418000"
  },
  {
    "text": "when it comes to our findings there is an RFC specifying how to say",
    "start": "418000",
    "end": "424240"
  },
  {
    "text": "handle unknown extension headers and that one essentially says uh",
    "start": "424240",
    "end": "430240"
  },
  {
    "text": "well um an intermediary node should forward packets with um",
    "start": "430240",
    "end": "436759"
  },
  {
    "text": "extension headers and in case this intermediary note does not",
    "start": "436759",
    "end": "442560"
  },
  {
    "text": "recognize an extension header uh it is still um uh expected to process it",
    "start": "442560",
    "end": "450199"
  },
  {
    "text": "so the overall attitude towards extension heads is well they can be",
    "start": "450199",
    "end": "456879"
  },
  {
    "text": "there and once you encounter them try to process try to understand but in",
    "start": "456879",
    "end": "465000"
  },
  {
    "text": "general do not discard anything of that do your best when it comes to",
    "start": "465000",
    "end": "470280"
  },
  {
    "text": "understanding and processing the potential contents of the of the",
    "start": "470280",
    "end": "476159"
  },
  {
    "text": "headers so all this um cause uh three",
    "start": "478319",
    "end": "484800"
  },
  {
    "start": "480000",
    "end": "845000"
  },
  {
    "text": "problems problem number one there are too many things that you can vary for instance you can vary the type you can",
    "start": "484800",
    "end": "492680"
  },
  {
    "text": "have destination options header a h byop header a fragment header and so on so on there are about nine exens headers up to",
    "start": "492680",
    "end": "499479"
  },
  {
    "text": "now secondly you can vary the size of them some of them have fixed size about",
    "start": "499479",
    "end": "506479"
  },
  {
    "text": "uh 16 bytes but some of them can be as long get 2,000 bytes or even",
    "start": "506479",
    "end": "511880"
  },
  {
    "text": "more you can also vary the order you can have the hob by hope the destination options the fragment header or you can",
    "start": "511880",
    "end": "518399"
  },
  {
    "text": "have destination options and then the fragment header and so on so on you can play with all these",
    "start": "518399",
    "end": "524440"
  },
  {
    "text": "things you can also vary the number that each header occurs in each chain for",
    "start": "524440",
    "end": "530640"
  },
  {
    "text": "instance you can have one destination options header you can have two three one routing header two three and so on",
    "start": "530640",
    "end": "537399"
  },
  {
    "text": "officially okay there is a recommendation that there should be just one for each one of them except from",
    "start": "537399",
    "end": "542880"
  },
  {
    "text": "destination options header which should be just twice but it's just a recommendation it has been shown that",
    "start": "542880",
    "end": "549399"
  },
  {
    "text": "most operating systems accept exens headers in any number of occurrences in",
    "start": "549399",
    "end": "556200"
  },
  {
    "text": "the6 uh header chain and moreover finally you can vary",
    "start": "556200",
    "end": "561519"
  },
  {
    "text": "the fields in there some of them like destination options header and the h a h hope header have some options this are",
    "start": "561519",
    "end": "569399"
  },
  {
    "text": "the so in the format of type length value so they can significantly vary from header to header to sum up this is",
    "start": "569399",
    "end": "577320"
  },
  {
    "text": "a kind the P6 uh chain is something like a function uh which has too many variables",
    "start": "577320",
    "end": "583440"
  },
  {
    "text": "so you can vary too many things and varing so many things you never know",
    "start": "583440",
    "end": "588519"
  },
  {
    "text": "what the final outcome will be problem number two fragmentation",
    "start": "588519",
    "end": "593839"
  },
  {
    "text": "fragmentation was quite simple I4 we had just the main header the I4 header and",
    "start": "593839",
    "end": "599519"
  },
  {
    "text": "then layer four here is slightly more complicated because we have the UNF fragmentable",
    "start": "599519",
    "end": "606040"
  },
  {
    "text": "part and the fragmentable part can consist of the IPv6 main header plus",
    "start": "606040",
    "end": "612600"
  },
  {
    "text": "some of the excess headers the ones that must be processed and root to",
    "start": "612600",
    "end": "618839"
  },
  {
    "text": "destination and we also have an fragmentable part the fragmentable part consists of the rest of the headers that",
    "start": "618839",
    "end": "625360"
  },
  {
    "text": "should be processed just from the end note Plus of course the layer for header",
    "start": "625360",
    "end": "631040"
  },
  {
    "text": "plus the final payload so when we fragment this initial iv6 datagram the",
    "start": "631040",
    "end": "638160"
  },
  {
    "text": "UNF fragmentable part remains constant but I remind you that it can have one or more exens headers then we add the",
    "start": "638160",
    "end": "644880"
  },
  {
    "text": "fragment header which um takes place in order to perform the fragmentation and",
    "start": "644880",
    "end": "652000"
  },
  {
    "text": "finally we have the fragments of the fragmentable",
    "start": "652000",
    "end": "656800"
  },
  {
    "text": "part the third problem is how this exens headers are changed let's take an",
    "start": "657040",
    "end": "662279"
  },
  {
    "text": "example here we have a main header the IPv6 main header we have a rting header",
    "start": "662279",
    "end": "668880"
  },
  {
    "text": "destination option header and TCP header plus payload each ex header has a value has a",
    "start": "668880",
    "end": "674600"
  },
  {
    "text": "protocol value we all know that the protocol value of 5 4 is four or 5 6 is",
    "start": "674600",
    "end": "679880"
  },
  {
    "text": "41 so for instance the rooting header has a protocol value of 43 the",
    "start": "679880",
    "end": "685639"
  },
  {
    "text": "destination option header has a protocol value of 6 TCP has a protocol value of six well",
    "start": "685639",
    "end": "691760"
  },
  {
    "text": "known from the ip4 era so each header both the main one and",
    "start": "691760",
    "end": "697639"
  },
  {
    "text": "the extension headers one have a field called Next header value field and this",
    "start": "697639",
    "end": "703200"
  },
  {
    "text": "field points to the next header in our example IPv6 header has an X header",
    "start": "703200",
    "end": "709320"
  },
  {
    "text": "value equals to 43 because it points here to the rotin",
    "start": "709320",
    "end": "714399"
  },
  {
    "text": "header the rooting EXT header has a next header value equals to 60 which points destination options header and so",
    "start": "714399",
    "end": "721399"
  },
  {
    "text": "on this is how they are chained it's a kind of a pointer concept so far so good",
    "start": "721399",
    "end": "728079"
  },
  {
    "text": "no big deal I mean that it's pretty easy so what's the problem with this the",
    "start": "728079",
    "end": "733399"
  },
  {
    "text": "problem comes when all this chains are fragmented let's take it again an",
    "start": "733399",
    "end": "739240"
  },
  {
    "text": "example let's assume that the fragmentable part in the is the one dis Rel on the",
    "start": "739240",
    "end": "744800"
  },
  {
    "text": "slide I have a destination of header which points correctly to the TCP header",
    "start": "744800",
    "end": "750480"
  },
  {
    "text": "whose protocol value is six and then I have the TCP payload and let's fragment this one into",
    "start": "750480",
    "end": "757600"
  },
  {
    "text": "fragments let's assume that part one is just the destination of to header and",
    "start": "757600",
    "end": "764320"
  },
  {
    "text": "part two of the fragmentable part is the TCP header plus the payload now I have a",
    "start": "764320",
    "end": "769440"
  },
  {
    "text": "question what should be this next header value of the fragment header in the first",
    "start": "769440",
    "end": "775639"
  },
  {
    "text": "fragment I remind you that the next header value the value of destination options is 60 and the TCP is 6 so what",
    "start": "775639",
    "end": "783279"
  },
  {
    "text": "should we here any suggestions excuse me 60 60 correct 60",
    "start": "783279",
    "end": "791560"
  },
  {
    "text": "absolutely y so the fragment header points to the destination header now the second fragment I have here the TCP",
    "start": "791560",
    "end": "799360"
  },
  {
    "text": "header what this next header value should be the thisp header has a protocol value of",
    "start": "799360",
    "end": "806800"
  },
  {
    "text": "six is it",
    "start": "807760",
    "end": "811160"
  },
  {
    "text": "obvious one might think that it should be six but actually but actually it's 60",
    "start": "812920",
    "end": "818839"
  },
  {
    "text": "although at first we may assume that it should be six because this m points to TCP header actually should be 60 because",
    "start": "818839",
    "end": "826040"
  },
  {
    "text": "the fragment header should always point to the first extension header of the fragmentable part and who's going to",
    "start": "826040",
    "end": "832920"
  },
  {
    "text": "point to the TCP header the destination options one this is a a really Minor Detail but but as we will show later we",
    "start": "832920",
    "end": "840279"
  },
  {
    "text": "will explore this detail in order to evade a high-end commercial idps",
    "start": "840279",
    "end": "846000"
  },
  {
    "start": "845000",
    "end": "1215000"
  },
  {
    "text": "device so overall uh it's a kind of mess there is",
    "start": "846000",
    "end": "851360"
  },
  {
    "text": "a huge variation of different parts of a potential",
    "start": "851360",
    "end": "857600"
  },
  {
    "text": "packet or when it comes uh to the size to the order of things contained there",
    "start": "857600",
    "end": "863800"
  },
  {
    "text": "of the options within the headers and all this",
    "start": "863800",
    "end": "869440"
  },
  {
    "text": "which then again as some of you might already figure poses problems to",
    "start": "869440",
    "end": "876040"
  },
  {
    "text": "security enforcement modules which are supposed to act on identifying stuff and",
    "start": "876040",
    "end": "882480"
  },
  {
    "text": "identifying like boundaries within packets and contents uh once you throw",
    "start": "882480",
    "end": "888279"
  },
  {
    "text": "in a a huge cloudy Mass into such a device that this might cause all types",
    "start": "888279",
    "end": "894199"
  },
  {
    "text": "of problems especially because all these things can combine",
    "start": "894199",
    "end": "899320"
  },
  {
    "text": "in any potential way there is just very few restrictions like there should there",
    "start": "899320",
    "end": "906120"
  },
  {
    "text": "can only one uh hop by hop header that is a certain type and that one has to follow the main header immediately but",
    "start": "906120",
    "end": "913480"
  },
  {
    "text": "besides that there was pretty much no restrictions on how to order combine uh",
    "start": "913480",
    "end": "919040"
  },
  {
    "text": "fragment all the stuff which clearly shows some of you",
    "start": "919040",
    "end": "924199"
  },
  {
    "text": "might be familiar with the Lang initiative and within lck one of the",
    "start": "924199",
    "end": "930079"
  },
  {
    "text": "most basic rules is whenever you pass something write a",
    "start": "930079",
    "end": "936000"
  },
  {
    "text": "grammar before uh like uh paing which clearly hasn't happened in the IPv6",
    "start": "936000",
    "end": "942639"
  },
  {
    "text": "space which then again uh causes problems too much freedom and",
    "start": "942639",
    "end": "949839"
  },
  {
    "text": "flexibility which is inversly proportional to security and uh can lead to let's say a",
    "start": "949839",
    "end": "957680"
  },
  {
    "text": "certain chaos to get um more practical what could actually go wrong now figure that right",
    "start": "957680",
    "end": "965839"
  },
  {
    "text": "now in most environments security enforcement like to decide if uh a packet is a good",
    "start": "965839",
    "end": "972600"
  },
  {
    "text": "or a bad one or it should go this direction or another another one or be no another routed whatever this decision",
    "start": "972600",
    "end": "980839"
  },
  {
    "text": "is uh taken upon identifying packet",
    "start": "980839",
    "end": "986519"
  },
  {
    "text": "content and uh well then the question comes up what if we try to circum wind this",
    "start": "986519",
    "end": "993319"
  },
  {
    "text": "identification what if we try to confuse security enforcement modules of different types actually we had a we did",
    "start": "993319",
    "end": "999680"
  },
  {
    "text": "a number of uh firewall tests as well but the most interesting ones were the idps ones um and uh in theory this type",
    "start": "999680",
    "end": "1010360"
  },
  {
    "text": "of problems has been discussed for many years but this was just Theory uh nowadays antoniio wrote a nice tool",
    "start": "1010360",
    "end": "1019199"
  },
  {
    "text": "which is freely available called KRON and KRON can as you will see later on",
    "start": "1019199",
    "end": "1024720"
  },
  {
    "text": "Implement all these techniques uh by simple command line uh switches easy to",
    "start": "1024720",
    "end": "1031520"
  },
  {
    "text": "use uh easy to create packets which have all these combinations in various ways",
    "start": "1031520",
    "end": "1038160"
  },
  {
    "text": "and it can even uh be used as a proxy so you throw in some um whatever type of",
    "start": "1038160",
    "end": "1044480"
  },
  {
    "text": "attack or uh scanning traffic um like run NEOS run it through Kon and uh outc",
    "start": "1044480",
    "end": "1051440"
  },
  {
    "text": "comes from Kon uh all the all the traffic and heavily I wouldn't say off",
    "start": "1051440",
    "end": "1057120"
  },
  {
    "text": "fiscated but uh prepared way actually we built um as I said we buil a lab this",
    "start": "1057120",
    "end": "1064559"
  },
  {
    "text": "lab consisted um of four idps Solutions uh two open source ones snort",
    "start": "1064559",
    "end": "1071280"
  },
  {
    "text": "and suata uh two commercial ones uh this is uh the Tipping Point we use this is the sourcefire device both are",
    "start": "1071280",
    "end": "1079120"
  },
  {
    "text": "uh medium siiz Enterprise devices I mean it's not the biggest devices you might",
    "start": "1079120",
    "end": "1084760"
  },
  {
    "text": "find in corporate environments uh still on the other hand this is not Soho stuff",
    "start": "1084760",
    "end": "1090120"
  },
  {
    "text": "this is stuff that you can expect uh can you reasonably expect to sit in say",
    "start": "1090120",
    "end": "1095520"
  },
  {
    "text": "medium-sized organizations or even large organizations and serving as protecting",
    "start": "1095520",
    "end": "1101799"
  },
  {
    "text": "entities or entities identifying and trying to to",
    "start": "1101799",
    "end": "1107559"
  },
  {
    "text": "block the bad Network traffic overall so far we have found 12",
    "start": "1107559",
    "end": "1113440"
  },
  {
    "text": "different evasion techniques all of them were reported to",
    "start": "1113440",
    "end": "1120039"
  },
  {
    "text": "the respective windows and all of them were were new at the time of uh us finding",
    "start": "1120039",
    "end": "1127159"
  },
  {
    "text": "them uh they were reported some of them were patched some of P them were patched",
    "start": "1127159",
    "end": "1133080"
  },
  {
    "text": "very quickly some of them were patched um with a certain delay uh but actually in the case as you",
    "start": "1133080",
    "end": "1141039"
  },
  {
    "text": "will see later in the case of snot and safire there was a well say interesting",
    "start": "1141039",
    "end": "1148240"
  },
  {
    "text": "way how they acted uh upon this they had a kind of uh well uh we don't have time",
    "start": "1148240",
    "end": "1154200"
  },
  {
    "text": "to take care of this uh go through customer support attitude which is particularly interesting as some of you",
    "start": "1154200",
    "end": "1160360"
  },
  {
    "text": "might know we have been given a number of blackhead talks before especially",
    "start": "1160360",
    "end": "1165400"
  },
  {
    "text": "covering Cisco stuff and breaking Cisco stuff and disclosing vulnerabilities in Cisco stuff at the time there was you",
    "start": "1165400",
    "end": "1172200"
  },
  {
    "text": "always good communication I even recall black at 2010 when Antonio first gave",
    "start": "1172200",
    "end": "1179280"
  },
  {
    "text": "his talk it was 2011 okay um Antonio first showed the",
    "start": "1179280",
    "end": "1186400"
  },
  {
    "text": "results of him analyzing the operating system behavior when it comes to fragment and extension head us and I uh",
    "start": "1186400",
    "end": "1194640"
  },
  {
    "text": "and another guy gave a talk on Cisco voice of Ip and there we had even a guy from Cisco P sitting in the room gaus",
    "start": "1194640",
    "end": "1202480"
  },
  {
    "text": "and discussing the stuff with us nowadays it seems times have changed uh in that space anyhow let's have a closer",
    "start": "1202480",
    "end": "1209880"
  },
  {
    "text": "look at the actual stuff you have been probably been waiting for yeah let's",
    "start": "1209880",
    "end": "1216480"
  },
  {
    "start": "1215000",
    "end": "1655000"
  },
  {
    "text": "begin with suata uh suata as you know it's an open source project it uh has",
    "start": "1216480",
    "end": "1223360"
  },
  {
    "text": "been funded by the US Homeland Security um dur our tests we tried we",
    "start": "1223360",
    "end": "1229840"
  },
  {
    "text": "tested several versions We started with version 2.0.1 each time we found the",
    "start": "1229840",
    "end": "1235360"
  },
  {
    "text": "vulnerability I used to report it to the developers they used to patch it and so",
    "start": "1235360",
    "end": "1240520"
  },
  {
    "text": "then we test the next version 2.0.2 we wait it again 2.0.3 waited",
    "start": "1240520",
    "end": "1246000"
  },
  {
    "text": "again and uh so up to now have found at least I would say six different evasion",
    "start": "1246000",
    "end": "1251640"
  },
  {
    "text": "techniques and we're going to demonstrate the latest one against",
    "start": "1251640",
    "end": "1257120"
  },
  {
    "text": "2.0.3 this is how the evasion looks like we are going to use two fragments",
    "start": "1257120",
    "end": "1264720"
  },
  {
    "text": "first of all uh for our purpose surata is has been stalled in a virtual environment and uh it is in a passive",
    "start": "1264720",
    "end": "1271640"
  },
  {
    "text": "mode uh meaning that uh it capses the traffic it triggers alert but it doesn't block",
    "start": "1271640",
    "end": "1276679"
  },
  {
    "text": "it um we use of course two parts and",
    "start": "1276679",
    "end": "1281760"
  },
  {
    "text": "fragmentable part and the fragmentable one the UNF fragmentable part consists of a type zing header and of course the",
    "start": "1281760",
    "end": "1289200"
  },
  {
    "text": "main header and the fragmentable part just from the destination of s header and layer four in the first fragment we",
    "start": "1289200",
    "end": "1295799"
  },
  {
    "text": "include the destination options header and the second the letter for header but",
    "start": "1295799",
    "end": "1300919"
  },
  {
    "text": "time for some action now okay um now uh we will demonstrate",
    "start": "1300919",
    "end": "1308039"
  },
  {
    "text": "this um I will just send the simple ping command uh ping request uh with shyon to",
    "start": "1308039",
    "end": "1314679"
  },
  {
    "text": "our Target um to see um here in our lock",
    "start": "1314679",
    "end": "1320799"
  },
  {
    "text": "oh sorry um our simple um alert is showing",
    "start": "1320799",
    "end": "1326559"
  },
  {
    "text": "up in IPv6 s request is sent in W Shar we see a our request and our reply so",
    "start": "1326559",
    "end": "1333520"
  },
  {
    "text": "now let's reset this thing and now I send our founded combination",
    "start": "1333520",
    "end": "1343200"
  },
  {
    "text": "we see in wire shark um it is fragmented first fragment and",
    "start": "1343200",
    "end": "1349960"
  },
  {
    "text": "the complete uh message so here we have our routing header our fragment and in",
    "start": "1351760",
    "end": "1359120"
  },
  {
    "text": "the next fragment we see in the first fragment just the destination option header and in the second fragment the",
    "start": "1359120",
    "end": "1365480"
  },
  {
    "text": "icmp and payload and as we see in Z rata nothing no alert is",
    "start": "1365480",
    "end": "1373520"
  },
  {
    "text": "showing up so the packet gets through but uh so recard doesn't uh notice anything as",
    "start": "1373520",
    "end": "1380799"
  },
  {
    "text": "it's not able to pass these uh the S combination of fragmentation and",
    "start": "1380799",
    "end": "1386039"
  },
  {
    "text": "extension head us in a correct way the goal here we wanted to simulate let's say kind of exploit so for this",
    "start": "1386039",
    "end": "1393320"
  },
  {
    "text": "purpose here we used a simple IPv6 request we enable a rule that detects",
    "start": "1393320",
    "end": "1398799"
  },
  {
    "text": "simple pink this was a goal to send a simple pink without being",
    "start": "1398799",
    "end": "1405158"
  },
  {
    "text": "detected okay um as we said we reported all the problems and uh we were essed actually",
    "start": "1406880",
    "end": "1413880"
  },
  {
    "text": "by the speed that uh suata developers patched all of them uh it didn't take",
    "start": "1413880",
    "end": "1420279"
  },
  {
    "text": "them more than a week in order to patch it and release a new tool this is the latest one now",
    "start": "1420279",
    "end": "1427600"
  },
  {
    "text": "2.0.4 uh which has fixed all the probabilities that have discovered and reported to the suata",
    "start": "1427600",
    "end": "1435600"
  },
  {
    "text": "developers okay uh now we're going to talk probably for the most sophisticated",
    "start": "1435600",
    "end": "1441000"
  },
  {
    "text": "of the attacks this is used against Tipping Point um again we have two different",
    "start": "1441000",
    "end": "1447919"
  },
  {
    "text": "cases here uh this is the first case uh we found it back in March of 2014 let's assume that we have this",
    "start": "1447919",
    "end": "1454840"
  },
  {
    "text": "fragmentable part uh we have a destination of header DCP and the payload and this is how we managed to",
    "start": "1454840",
    "end": "1463799"
  },
  {
    "text": "wait tipic point at the very first time if you recall this next CER value from",
    "start": "1463799",
    "end": "1469520"
  },
  {
    "text": "the production should be 60 we found out that when this one is six and the f one 60 theic point does",
    "start": "1469520",
    "end": "1477919"
  },
  {
    "text": "not trigger any alert T Point does not block our package so this was a way to",
    "start": "1477919",
    "end": "1483480"
  },
  {
    "text": "evade tipic point this was back in March we reported this problem to the vendor",
    "start": "1483480",
    "end": "1488760"
  },
  {
    "text": "they fixed it after three times if I recall correctly but again we had the",
    "start": "1488760",
    "end": "1495559"
  },
  {
    "text": "second one before proceeding the second one let's see how this technique works and what's the difference here between",
    "start": "1495559",
    "end": "1502760"
  },
  {
    "text": "six and 60 okay this is a war output of the",
    "start": "1502760",
    "end": "1508919"
  },
  {
    "text": "predescribed technique the yellow area here is",
    "start": "1508919",
    "end": "1514159"
  },
  {
    "text": "actually the TCP packet the TCP header plus the payload in our example it's a kind of xss",
    "start": "1514159",
    "end": "1522120"
  },
  {
    "text": "attack the red one is the destination of header if you see here the yellow circle",
    "start": "1524440",
    "end": "1532799"
  },
  {
    "text": "it's the number 50 number 50 is the hexadecimal of number 80 which is the",
    "start": "1532799",
    "end": "1538799"
  },
  {
    "text": "HTTP port in our example we try to evade TCP and actually to launch a kind of EX",
    "start": "1538799",
    "end": "1546200"
  },
  {
    "text": "attack the problem is that due to the nexer value of six both wires are can",
    "start": "1546200",
    "end": "1551960"
  },
  {
    "text": "typic Point assume that the TCP header instead of starting here it starts over",
    "start": "1551960",
    "end": "1558080"
  },
  {
    "text": "here so uh instead of looking for the TCP Port here which is 80 it tries to",
    "start": "1558080",
    "end": "1565000"
  },
  {
    "text": "find it somewhere here which is 0 1 0 0 but 0 1 0 0 is you know in he decimal",
    "start": "1565000",
    "end": "1571440"
  },
  {
    "text": "it's 256 in decimal so it believes that the packet is going to this port in 256",
    "start": "1571440",
    "end": "1578840"
  },
  {
    "text": "and not Port 80 so the signature is not",
    "start": "1578840",
    "end": "1584398"
  },
  {
    "text": "triggered as I said we report the problem the V don't reacted okay not that fast but it patched the",
    "start": "1584600",
    "end": "1591080"
  },
  {
    "text": "problem but again I found another way this is the old technique that I",
    "start": "1591080",
    "end": "1597440"
  },
  {
    "text": "described first fragment second fragment and when it was patched we said",
    "start": "1597440",
    "end": "1603159"
  },
  {
    "text": "okay let's try it again we laun exactly the same technique and we notice that the first",
    "start": "1603159",
    "end": "1609440"
  },
  {
    "text": "fragment passes through the device while the second one is blocked",
    "start": "1609440",
    "end": "1615760"
  },
  {
    "text": "now what you would do in in our case You observe that the patched one allows the",
    "start": "1615760",
    "end": "1621679"
  },
  {
    "text": "first fragment and the second one is blocked any suggest those any hacker mindset what could you",
    "start": "1621679",
    "end": "1629799"
  },
  {
    "text": "do if uh you know that something gets through and something is blocked sometimes things are more simple",
    "start": "1629799",
    "end": "1637120"
  },
  {
    "text": "than I expect it is quite simple actually you can just send the second",
    "start": "1637120",
    "end": "1643080"
  },
  {
    "text": "fragment once more so the first time it is blocked but the second time it passes",
    "start": "1643080",
    "end": "1649080"
  },
  {
    "text": "through yeah okay we have a nice demo here again time some for",
    "start": "1649080",
    "end": "1656159"
  },
  {
    "start": "1655000",
    "end": "1855000"
  },
  {
    "text": "Action uh to show that demo I will use wire shock on",
    "start": "1656159",
    "end": "1662039"
  },
  {
    "text": "my uh side it uh should be running um",
    "start": "1662039",
    "end": "1667640"
  },
  {
    "text": "well let we're going to sew both the attacker machine and the",
    "start": "1667640",
    "end": "1673600"
  },
  {
    "text": "Defenders machine you are going to see that the attackers uh send three packets",
    "start": "1673600",
    "end": "1679399"
  },
  {
    "text": "three fragments the one is blocked and the the target received just the two of",
    "start": "1679399",
    "end": "1685039"
  },
  {
    "text": "them which are more than enough to trigger a response so okay so um now I will first",
    "start": "1685039",
    "end": "1693559"
  },
  {
    "text": "send just uh simple packet again to see um what has happened and we see in my y",
    "start": "1693559",
    "end": "1700640"
  },
  {
    "text": "shark the request is sended and um here I have the lock uh of",
    "start": "1700640",
    "end": "1706519"
  },
  {
    "text": "the Tipping Point and here we see okay one package is blocked so it just just simply blocked my packet and I don't see",
    "start": "1706519",
    "end": "1713480"
  },
  {
    "text": "anything there's nothing nothing comes in here at uh let's assume this is the uh destination system where the packet",
    "start": "1713480",
    "end": "1721640"
  },
  {
    "text": "where the traffic is destined to yeah so now I will send um our F combination so",
    "start": "1721640",
    "end": "1728919"
  },
  {
    "text": "you see here first fragment second fragment while shark reassembled it",
    "start": "1728919",
    "end": "1734000"
  },
  {
    "text": "since now and here we see the SEC third fragment which is simply the second one",
    "start": "1734000",
    "end": "1739039"
  },
  {
    "text": "again and if we look in the lock and I refers the lock we see okay he blocks",
    "start": "1739039",
    "end": "1745279"
  },
  {
    "text": "one and but if we now switch to our Target and even though we see it in my w",
    "start": "1745279",
    "end": "1751919"
  },
  {
    "text": "Shar we gotten reset back well the reset is sent because there was nothing",
    "start": "1751919",
    "end": "1757720"
  },
  {
    "text": "listening on on the targets machine on Port 80 uh the main point",
    "start": "1757720",
    "end": "1762919"
  },
  {
    "text": "being uh now with the second uh try something got through uh which can be",
    "start": "1762919",
    "end": "1769960"
  },
  {
    "text": "seen here actually it's uh two pickets arriving on the destination",
    "start": "1769960",
    "end": "1775360"
  },
  {
    "text": "system uh which is uh sitting behind the Tipping Point which is protected by the Tipping Point still something gets",
    "start": "1775360",
    "end": "1782159"
  },
  {
    "text": "through uh well in the end of the day I sent back a reset but the interesting parts are the first two ones um again",
    "start": "1782159",
    "end": "1789440"
  },
  {
    "text": "note he sent out three uh here it's only two showing up it's like an well um mmax",
    "start": "1789440",
    "end": "1797039"
  },
  {
    "text": "3 Thunder Dome uh it's a variation not two go in one gets out uh but three go",
    "start": "1797039",
    "end": "1804320"
  },
  {
    "text": "in and two gets out uh and you can see here again here",
    "start": "1804320",
    "end": "1809679"
  },
  {
    "text": "is um a fragmentation header here is destination options um and uh it's split",
    "start": "1809679",
    "end": "1817360"
  },
  {
    "text": "into two fragments which uh contain even the the",
    "start": "1817360",
    "end": "1823240"
  },
  {
    "text": "payload you can see down there which was sent um just to indicate any type of",
    "start": "1823240",
    "end": "1829120"
  },
  {
    "text": "payload gets through even though this packet uh should have been",
    "start": "1829120",
    "end": "1834360"
  },
  {
    "text": "blocked by The Tipping Point device and uh actually without",
    "start": "1834360",
    "end": "1840559"
  },
  {
    "text": "those say fiddling around with the packet it was blocked it was it's just the same packet as in the first try but",
    "start": "1840559",
    "end": "1848159"
  },
  {
    "text": "now it's crafted in a certain",
    "start": "1848159",
    "end": "1852960"
  },
  {
    "text": "way okay so uh let's come to Cisco and Source fire",
    "start": "1855760",
    "end": "1863600"
  },
  {
    "text": "and snort I will hand over to again but uh",
    "start": "1863600",
    "end": "1868679"
  },
  {
    "text": "before doing so just to mention that could expect that um these two IDPA systems would have a quite similar",
    "start": "1868679",
    "end": "1874440"
  },
  {
    "text": "Behavior because as we all know sire is based on sth so we wouldn't expect any differences but we found out that some",
    "start": "1874440",
    "end": "1880720"
  },
  {
    "text": "zero days working against sord fire didn't work against Nord yeah thanks I I'll head back uh give back to you in a",
    "start": "1880720",
    "end": "1888559"
  },
  {
    "text": "second the main uh point is here uh given I was kind of supervising the lab",
    "start": "1888559",
    "end": "1896120"
  },
  {
    "text": "I was involved in EV Communication in all these cases and um as I said we uh already in",
    "start": "1896120",
    "end": "1904240"
  },
  {
    "text": "June we contacted SN developers sent peaps we didn't get any response we reported uh into s",
    "start": "1904240",
    "end": "1911559"
  },
  {
    "text": "sourcefire in September uh actually into different people give when we are involved in",
    "start": "1911559",
    "end": "1918200"
  },
  {
    "text": "customers customer projects including sourire we uh have uh and uh we had at",
    "start": "1918200",
    "end": "1925600"
  },
  {
    "text": "the time and still have uh certain channels into um into Source fire and uh that",
    "start": "1925600",
    "end": "1935000"
  },
  {
    "text": "was a quite disappointing experience they got back to us like oh wait uh what",
    "start": "1935000",
    "end": "1940720"
  },
  {
    "text": "is this um uh don't waste our time why are you contacting us",
    "start": "1940720",
    "end": "1947840"
  },
  {
    "text": "and um actually they s suggested going through customer support so clearly at",
    "start": "1947840",
    "end": "1953799"
  },
  {
    "text": "least those person we were talking to did not realize what this was about",
    "start": "1953799",
    "end": "1960360"
  },
  {
    "text": "which was uh surprising to say the least I mean we understand that after the acquisition of sire by by Cisco there's",
    "start": "1960360",
    "end": "1967720"
  },
  {
    "text": "all types of rears and things going on and people might be busy but this again was uh",
    "start": "1967720",
    "end": "1975360"
  },
  {
    "text": "interesting uh so with which um well if uh responsible or as they say nowadays",
    "start": "1975360",
    "end": "1981480"
  },
  {
    "text": "coordinated disclosure fails uh what is left for the researcher go with full disclosure which is exactly what we are",
    "start": "1981480",
    "end": "1988519"
  },
  {
    "text": "doing here and right now okay uh let's describe our live",
    "start": "1988519",
    "end": "1996200"
  },
  {
    "text": "demos first of all we're going to test Source fire uh it's the latest one it's the",
    "start": "1996200",
    "end": "2001519"
  },
  {
    "text": "device up here uh this is the model the version and the build",
    "start": "2001519",
    "end": "2008440"
  },
  {
    "text": "uh we must mention here that both snort and Source Fire have some IPv6 rule in",
    "start": "2008440",
    "end": "2014679"
  },
  {
    "text": "decoders PR processor rule that uh are not enabled by default without enable enabling them uh",
    "start": "2014679",
    "end": "2021679"
  },
  {
    "text": "evasion is even more easier it's really easy to evade it so we try to make it",
    "start": "2021679",
    "end": "2027279"
  },
  {
    "text": "more difficult for us we try to uh let's say enable all the rules related to f",
    "start": "2027279",
    "end": "2033279"
  },
  {
    "text": "pv6 as long as of course they don't trigger any false alarm because there are a couple of them that they trigger",
    "start": "2033279",
    "end": "2038320"
  },
  {
    "text": "false alarm even in full legitimate traffic so enable all these rules you can see the signature ID is here uh",
    "start": "2038320",
    "end": "2046480"
  },
  {
    "text": "which actually do a pretty good job but still as you will show there are ways to",
    "start": "2046480",
    "end": "2052358"
  },
  {
    "text": "evade it so talking about Source fire first this is one example how Source",
    "start": "2052359",
    "end": "2058079"
  },
  {
    "text": "fire can be evaded again we have two fragments our favorite combination in the fragmentable part",
    "start": "2058079",
    "end": "2065358"
  },
  {
    "text": "except from the main header of course we use three destination options header in the fragmentable part we have",
    "start": "2065359",
    "end": "2072320"
  },
  {
    "text": "just one destination options header in the first fragment and another one in the second fragment plus of course the",
    "start": "2072320",
    "end": "2078398"
  },
  {
    "text": "layer for header so now Rafael is going to demonstrate how this combination can be",
    "start": "2078399",
    "end": "2083800"
  },
  {
    "text": "used to evade Source fire um we're going to send these two fragments and we're",
    "start": "2083800",
    "end": "2089839"
  },
  {
    "text": "going to show that uh the target receives the two fragments and responds",
    "start": "2089839",
    "end": "2095560"
  },
  {
    "text": "uh to them okay um now same procedure as as um",
    "start": "2095560",
    "end": "2104240"
  },
  {
    "text": "before I would just just send a simple in this time again ping request and we",
    "start": "2104240",
    "end": "2110079"
  },
  {
    "text": "see it show up uh in my y shark and if you refresh the lock of the source fire",
    "start": "2110079",
    "end": "2117119"
  },
  {
    "text": "we see even here it is shown up in our lock and is",
    "start": "2117119",
    "end": "2122359"
  },
  {
    "text": "blocked so I now will clear the block again um",
    "start": "2122359",
    "end": "2128020"
  },
  {
    "text": "[Music] yes yes and now I will send our combination",
    "start": "2128020",
    "end": "2136119"
  },
  {
    "text": "we see here two fragments ping request got",
    "start": "2136119",
    "end": "2141960"
  },
  {
    "text": "through and we should normally see take a look at uh uh",
    "start": "2141960",
    "end": "2150160"
  },
  {
    "text": "the uh Target system I mean it didn't show that before nothing got through but you saw it in",
    "start": "2150160",
    "end": "2156599"
  },
  {
    "text": "the um the alert being triggered uh and now uh this is the",
    "start": "2156599",
    "end": "2165280"
  },
  {
    "text": "final destination of the packets again we see there something um",
    "start": "2165280",
    "end": "2170480"
  },
  {
    "text": "getting through the icmp packet which should have been",
    "start": "2170480",
    "end": "2175960"
  },
  {
    "text": "blocked uh I um just uh had should have triggered",
    "start": "2175960",
    "end": "2182280"
  },
  {
    "text": "something uh get through I reply on that one and looking a bit closer um can be",
    "start": "2182280",
    "end": "2190680"
  },
  {
    "text": "seen there is again as Antonio laid out there was a number of destination",
    "start": "2190680",
    "end": "2196599"
  },
  {
    "text": "headers which shouldn't be there say if it was some production traffic there is a fragmentation header",
    "start": "2196599",
    "end": "2203480"
  },
  {
    "text": "and uh this um gets uh W Shak has some some some difficulties in",
    "start": "2203480",
    "end": "2211280"
  },
  {
    "text": "correctly say not passing but understanding or interpreting the",
    "start": "2211280",
    "end": "2217680"
  },
  {
    "text": "packet but uh as you can see it's it gets reassembled on the final point and",
    "start": "2217680",
    "end": "2223839"
  },
  {
    "text": "is processed um normally without triggering",
    "start": "2223839",
    "end": "2229400"
  },
  {
    "start": "2230000",
    "end": "2385000"
  },
  {
    "text": "anything just a note here that both Tipping Point and Source fire are in line so not only they should trigger an",
    "start": "2230960",
    "end": "2237680"
  },
  {
    "text": "alert but they should completely block the traffic the reason that you see the traffic at the Target is more than",
    "start": "2237680",
    "end": "2243960"
  },
  {
    "text": "enough uh to show that uh Source fire in this case and the big point before had",
    "start": "2243960",
    "end": "2249160"
  },
  {
    "text": "been evaded okay this was about Source fire surprisingly enough this technique",
    "start": "2249160",
    "end": "2254280"
  },
  {
    "text": "does not working as snort I suppose because sourcefire is based on",
    "start": "2254280",
    "end": "2259400"
  },
  {
    "text": "2.9.6 version of snort and the latest snort version is 2.9.6",
    "start": "2259400",
    "end": "2265160"
  },
  {
    "text": "point2 um so we Tred to find something for snort",
    "start": "2265160",
    "end": "2271240"
  },
  {
    "text": "to uh we use the latest version the one that I mentioned 2.9.6 point2 to again",
    "start": "2271680",
    "end": "2277200"
  },
  {
    "text": "enabled all the pv6 related rules that do not trigger any kind of false alarm",
    "start": "2277200",
    "end": "2283040"
  },
  {
    "text": "and try to evade it uh snort is has been installed in a virtual machine in Rafa's",
    "start": "2283040",
    "end": "2289040"
  },
  {
    "text": "laptop uh it is configured in passive mode so we will show the alerts over",
    "start": "2289040",
    "end": "2294880"
  },
  {
    "text": "there and this is how the technique actually works um here um the interesting thing",
    "start": "2294880",
    "end": "2303319"
  },
  {
    "text": "is that actually this combination can be more or less fully legitimate packet in",
    "start": "2303319",
    "end": "2308920"
  },
  {
    "text": "the previous example had three destination options header in the UNF",
    "start": "2308920",
    "end": "2314200"
  },
  {
    "text": "fragmentable part which should not be the case according to the RFC there should not much but should be just one",
    "start": "2314200",
    "end": "2321599"
  },
  {
    "text": "destination of the fragmentable part and we used three a kind of violation or we",
    "start": "2321599",
    "end": "2328480"
  },
  {
    "text": "didn't follow let's say the recommendation here we use an almost fully legitimate packet we have a hope H",
    "start": "2328480",
    "end": "2336800"
  },
  {
    "text": "header following directly the main header as it must does we have a rooting header we",
    "start": "2336800",
    "end": "2344720"
  },
  {
    "text": "use type three because type zero has been debated and thankfully snort",
    "start": "2344720",
    "end": "2350280"
  },
  {
    "text": "triggers an alert for that so we use type three and a destination options header",
    "start": "2350280",
    "end": "2356200"
  },
  {
    "text": "all of them in the fragmentable part then we have our fragment header and then use another one the options header",
    "start": "2356200",
    "end": "2363520"
  },
  {
    "text": "in the unag in the fragmentable part layer for and the",
    "start": "2363520",
    "end": "2368560"
  },
  {
    "text": "payload I would like to remind you that having a destination head in the fragmentable part and another in the fragmentable part is fully legitimate",
    "start": "2368560",
    "end": "2375240"
  },
  {
    "text": "according to RFC so this could be a fully legitimate ip6 packet in the real",
    "start": "2375240",
    "end": "2380280"
  },
  {
    "text": "world and this combination can be used to evade snort okay Rafael you're there um yeah",
    "start": "2380280",
    "end": "2388920"
  },
  {
    "text": "same again we'll just send a simple just a simple ping request see my echo reply",
    "start": "2388920",
    "end": "2395160"
  },
  {
    "text": "we see the in our lock above um now clear the lock a little bit so you see",
    "start": "2395160",
    "end": "2401280"
  },
  {
    "text": "that there's nothing showing up and",
    "start": "2401280",
    "end": "2405920"
  },
  {
    "text": "now I will send our founded combination uh you see here again",
    "start": "2407440",
    "end": "2414319"
  },
  {
    "text": "fragment one fragment two our reply and nothing appears in the lock and if you",
    "start": "2414319",
    "end": "2420240"
  },
  {
    "text": "looking at our sended packet we will see here our hopup hop header our routing",
    "start": "2420240",
    "end": "2427640"
  },
  {
    "text": "header type three our destination option header and then we come to the fragmentation",
    "start": "2427640",
    "end": "2433880"
  },
  {
    "text": "fragmentation um part one this just the destination option header and the",
    "start": "2433880",
    "end": "2439200"
  },
  {
    "text": "fragmentation part two is again the icmp uh V6 and um the payload so as you see",
    "start": "2439200",
    "end": "2448040"
  },
  {
    "text": "nothing in the lock reply got back so it's fully processed by the by the",
    "start": "2448040",
    "end": "2453960"
  },
  {
    "text": "final uh final point of the packets which is the which is the main message um uh just by adding",
    "start": "2453960",
    "end": "2462160"
  },
  {
    "text": "headers in a certain combination you get through uh to the final uh Final",
    "start": "2462160",
    "end": "2468520"
  },
  {
    "text": "Destination and given postals principle be liberal in what you accept uh pretty",
    "start": "2468520",
    "end": "2474640"
  },
  {
    "text": "much all operating systems will happily process those packets and act upon of",
    "start": "2474640",
    "end": "2481040"
  },
  {
    "text": "them as if they if they were sent without any um",
    "start": "2481040",
    "end": "2486960"
  },
  {
    "start": "2485000",
    "end": "2640000"
  },
  {
    "text": "does so obviously this brings up the question what could be done against this",
    "start": "2486960",
    "end": "2492480"
  },
  {
    "text": "stuff if you run idps systems you should expect or you certainly expect uh they",
    "start": "2492480",
    "end": "2500119"
  },
  {
    "text": "detect well known bad stuff which they clearly as we have",
    "start": "2500119",
    "end": "2505720"
  },
  {
    "text": "shown don't once crafted packets are sent what could be done and this we",
    "start": "2505720",
    "end": "2512480"
  },
  {
    "text": "would like to differentiate between different parties in what in the overall",
    "start": "2512480",
    "end": "2519078"
  },
  {
    "text": "process given we deal with IPv6 a",
    "start": "2519599",
    "end": "2525240"
  },
  {
    "text": "lot we are aware there is um actually there's hundreds of rfc's covering IPv6",
    "start": "2525240",
    "end": "2532079"
  },
  {
    "text": "and some way some of them even contradicting each other some of them",
    "start": "2532079",
    "end": "2537280"
  },
  {
    "text": "issued by interested parties or based on certain politics going on in ITF space",
    "start": "2537280",
    "end": "2545200"
  },
  {
    "text": "still when it comes to the main elements there's a huge degree of",
    "start": "2545200",
    "end": "2551200"
  },
  {
    "text": "ambiguity reading rfc's and then implementing Stacks upon or based on",
    "start": "2551200",
    "end": "2557079"
  },
  {
    "text": "these rfc's uh is a difficult task for a developer as the rfc's and even the main",
    "start": "2557079",
    "end": "2563200"
  },
  {
    "text": "ones are not always very clear so there must be from we think um and again we",
    "start": "2563200",
    "end": "2568800"
  },
  {
    "text": "are aware of the way ITF work and works and we are uh big fans of the robustness",
    "start": "2568800",
    "end": "2577160"
  },
  {
    "text": "principle in general uh still there is not enough as we think guidance or clear",
    "start": "2577160",
    "end": "2585280"
  },
  {
    "text": "guidance when it comes how to process and how to actually uh build and act",
    "start": "2585280",
    "end": "2591880"
  },
  {
    "text": "upon packets second when it comes to Windows we had the impression that say",
    "start": "2591880",
    "end": "2599720"
  },
  {
    "text": "quality assurance or security quality assurance so there is room for improvement in window space when it",
    "start": "2599720",
    "end": "2605839"
  },
  {
    "text": "comes to IPv6 tools are available Kon can be",
    "start": "2605839",
    "end": "2611119"
  },
  {
    "text": "downloaded um we sent a number of peaps actually we got from from some of the um",
    "start": "2611119",
    "end": "2618680"
  },
  {
    "text": "especially in zata space we got very positive response like thanks for the peaps and thanks for the tools so we can",
    "start": "2618680",
    "end": "2625160"
  },
  {
    "text": "test all this on our own Kine Kon has been released in the first version like",
    "start": "2625160",
    "end": "2630200"
  },
  {
    "text": "nine months ago or so uh so it's not uh like it's a tool which is uh coming from",
    "start": "2630200",
    "end": "2638520"
  },
  {
    "text": "nowhere security quality assurance in window space could be improved when it",
    "start": "2638520",
    "end": "2644400"
  },
  {
    "start": "2640000",
    "end": "3110000"
  },
  {
    "text": "comes to say you organizations assuming that many of you are not involved in",
    "start": "2644400",
    "end": "2651520"
  },
  {
    "text": "window space but in like user space to some degree in corporations or agencies using these",
    "start": "2651520",
    "end": "2661280"
  },
  {
    "text": "devices uh it should be noted there is a quite new RFC",
    "start": "2661280",
    "end": "2667319"
  },
  {
    "text": "7112 which specifies that an intermediary system like an idps like a firewall or",
    "start": "2667319",
    "end": "2675599"
  },
  {
    "text": "um as they call it in RFC space any type of middle",
    "start": "2675599",
    "end": "2681000"
  },
  {
    "text": "box is potentially allowed to discard packets once the full header chain is",
    "start": "2681160",
    "end": "2689119"
  },
  {
    "text": "not included in the first fragment which is a good thing as header chain being",
    "start": "2689119",
    "end": "2695640"
  },
  {
    "text": "for fragmented or being split into several fragments we don't see any cases and we",
    "start": "2695640",
    "end": "2702599"
  },
  {
    "text": "do a lot of IPv6 work we just we don't see any cases where this should ever happen in production traffic so allowing",
    "start": "2702599",
    "end": "2709079"
  },
  {
    "text": "middle boxes to you may throw this away if you can't recognize the full header",
    "start": "2709079",
    "end": "2715200"
  },
  {
    "text": "chain within the first fragment is a good idea still uh some of our attacks",
    "start": "2715200",
    "end": "2720599"
  },
  {
    "text": "would would have worked um nevertheless like the Tipping Point one that would",
    "start": "2720599",
    "end": "2725760"
  },
  {
    "text": "have worked even if that device acted",
    "start": "2725760",
    "end": "2730839"
  },
  {
    "text": "like the RC71 12 kind of allows this is a deviation from the old Mantra like",
    "start": "2730839",
    "end": "2737960"
  },
  {
    "text": "everything uh in extension header space must be U fully processed and uh",
    "start": "2737960",
    "end": "2744119"
  },
  {
    "text": "regardless if it's fragmented or not uh secondly when it comes to configuring",
    "start": "2744119",
    "end": "2750520"
  },
  {
    "text": "security devices there is two potential approaches the first you might uh say",
    "start": "2750520",
    "end": "2758760"
  },
  {
    "text": "configure filtering devices in a way that they drop all extension Setters which are not needed which immediately",
    "start": "2758760",
    "end": "2765280"
  },
  {
    "text": "brings up the question what are those uh it's pretty much all of them",
    "start": "2765280",
    "end": "2771200"
  },
  {
    "text": "except for maybe in case you expect fragmented traffic which shouldn't happen but there are Corner cases with",
    "start": "2771200",
    "end": "2778480"
  },
  {
    "text": "um Tunnel traffic or DNS SEC where fragmented packet may actually show up",
    "start": "2778480",
    "end": "2785920"
  },
  {
    "text": "so uh uh what we think we are not fully",
    "start": "2785920",
    "end": "2791079"
  },
  {
    "text": "we have different opinion here um Antonio and I uh at least I think you should um it's it's fairly safe to drop",
    "start": "2791079",
    "end": "2798720"
  },
  {
    "text": "pretty much anything all extension headers uh except for maybe fragment header in case",
    "start": "2798720",
    "end": "2806720"
  },
  {
    "text": "there's fragmented traffic and obviously authentication and ESP and crypting",
    "start": "2806720",
    "end": "2811839"
  },
  {
    "text": "security payload the headers which are needed for IPC so running VPN traffic",
    "start": "2811839",
    "end": "2818240"
  },
  {
    "text": "through a filtering device then you would need those extension headers uh but I'm a uh I usually",
    "start": "2818240",
    "end": "2826319"
  },
  {
    "text": "recommend going with a very strict way drop all this crap uh at the at the borders uh or at",
    "start": "2826319",
    "end": "2834480"
  },
  {
    "text": "least in case uh you want an idps to fully function the way you that you",
    "start": "2834480",
    "end": "2840960"
  },
  {
    "text": "expect that uh the traffic has to be sanitized or scrub before it enters the idps",
    "start": "2840960",
    "end": "2846240"
  },
  {
    "text": "as uh I do not expect um that the uh the problems or the types of problems that",
    "start": "2846240",
    "end": "2852920"
  },
  {
    "text": "we have seen uh can be cured in the short term like it's um okay they can be patched and then once again uh say",
    "start": "2852920",
    "end": "2860839"
  },
  {
    "text": "several weeks later or in some cases just Days Later Rafael",
    "start": "2860839",
    "end": "2867760"
  },
  {
    "text": "or antoniio or somebody else using Kon finds new techniques I think this is a",
    "start": "2867760",
    "end": "2875200"
  },
  {
    "text": "kind of UN solvable problem for idps so if idps should function properly",
    "start": "2875200",
    "end": "2881839"
  },
  {
    "text": "sanitize the traffic before uh going into it if you ask okay what is um what is the actual practice out there you",
    "start": "2881839",
    "end": "2889040"
  },
  {
    "text": "might look at this default behavior of checkpoint for example is uh they by",
    "start": "2889040",
    "end": "2895119"
  },
  {
    "text": "default checkpoint drops all extension headers which does not include authentication ESP the ones for IP sake",
    "start": "2895119",
    "end": "2902200"
  },
  {
    "text": "but all others are dropped by default by checkpoint I I think this is a good stance I mean it's obviously against say",
    "start": "2902200",
    "end": "2909599"
  },
  {
    "text": "um the spirit of the rfc's uh allowing for flexibility in checkpoint",
    "start": "2909599",
    "end": "2916920"
  },
  {
    "text": "space you can only modify this Behavior like allowing them by editing uh table.",
    "start": "2916920",
    "end": "2922960"
  },
  {
    "text": "def which um those of you who are aware with checkpoint operations um this is probably not the step one likes to",
    "start": "2922960",
    "end": "2930599"
  },
  {
    "text": "perform in in in production environments and there is no way of enabling",
    "start": "2930599",
    "end": "2935720"
  },
  {
    "text": "extension headers in a guy or something it's just they are blocked and the say",
    "start": "2935720",
    "end": "2942240"
  },
  {
    "text": "typical administrator has no uh ways of enabling them that's probably I think",
    "start": "2942240",
    "end": "2947760"
  },
  {
    "text": "this is by by by decision by Design decision um so it can be avoided like uh",
    "start": "2947760",
    "end": "2955480"
  },
  {
    "text": "people calling out oh your firewall does it block anything could you please enable it this just can't happen as long",
    "start": "2955480",
    "end": "2962119"
  },
  {
    "text": "as you don't touch table Dev so they have a very strict filtering approach",
    "start": "2962119",
    "end": "2967240"
  },
  {
    "text": "which I think is a good idea uh the second um as I said uh if an",
    "start": "2967240",
    "end": "2974359"
  },
  {
    "text": "idps should function properly traffic must be uh somewhat scrubed or sanitized",
    "start": "2974359",
    "end": "2980480"
  },
  {
    "text": "before entering it um so it can uh be processed uh",
    "start": "2980480",
    "end": "2987400"
  },
  {
    "text": "correctly do you want to add anything from your perspective regarding dropping accession",
    "start": "2987400",
    "end": "2993839"
  },
  {
    "text": "headers okay it could be safe policy for the time being but um ex headers are",
    "start": "2993839",
    "end": "2999359"
  },
  {
    "text": "here to provide some additional functionality that may require it for example there are cases that hope I hope",
    "start": "2999359",
    "end": "3005760"
  },
  {
    "text": "header is used in the local link for the rout alert option this can be the case even in the in the core networks so",
    "start": "3005760",
    "end": "3014040"
  },
  {
    "text": "there are some exceptions IPC is another one and um according to",
    "start": "3014040",
    "end": "3020079"
  },
  {
    "text": "7112 in the ip6 case you also allowed to have the layer for header in the second",
    "start": "3020079",
    "end": "3027359"
  },
  {
    "text": "fragment so it's not that an easy let's say approach of course if we don't use",
    "start": "3027359",
    "end": "3032680"
  },
  {
    "text": "them drop them that's pretty straightforward for me uh but if you're",
    "start": "3032680",
    "end": "3038000"
  },
  {
    "text": "going to need something then the problem starts to be kind of complicated yeah in general I think drop them all and uh I",
    "start": "3038000",
    "end": "3045520"
  },
  {
    "text": "even think um in ITF space um extension headers should be",
    "start": "3045520",
    "end": "3051160"
  },
  {
    "text": "deprecated at some point of time which shouldn't be too distant in the future",
    "start": "3051160",
    "end": "3057240"
  },
  {
    "text": "uh besides all the technical say info we provided uh we would like to uh remind",
    "start": "3057240",
    "end": "3065240"
  },
  {
    "text": "and encourage all of you that uh both from a security researchers perspective",
    "start": "3065240",
    "end": "3071040"
  },
  {
    "text": "IPv6 is a quite interesting protocol there's many gray areas there's many rfc's and uh subprotocols and stuff",
    "start": "3071040",
    "end": "3079640"
  },
  {
    "text": "nobody has looked on so far and um when it comes like to to",
    "start": "3079640",
    "end": "3086520"
  },
  {
    "text": "practical implementation given we said it's there it will be it will haunt you in the next 5 10 20",
    "start": "3086520",
    "end": "3093839"
  },
  {
    "text": "years building a lab finding out how actual devices uh behave how operating",
    "start": "3093839",
    "end": "3100839"
  },
  {
    "text": "systems behave is from what we think a crucial step in any uh type of well",
    "start": "3100839",
    "end": "3107000"
  },
  {
    "text": "planned and prepared IPv6 deployment that's that thanks for",
    "start": "3107000",
    "end": "3112760"
  },
  {
    "start": "3110000",
    "end": "3472000"
  },
  {
    "text": "listening um enjoy blackhead second",
    "start": "3112760",
    "end": "3118000"
  },
  {
    "text": "day um we we should have uh like 10 minutes for questions just a small note there is a white paper uh uh it will be",
    "start": "3122640",
    "end": "3130640"
  },
  {
    "text": "published in the black website um there is an appendix there uh in appendix B uh",
    "start": "3130640",
    "end": "3136200"
  },
  {
    "text": "there you can find all the command lines that we used in order to evade these devices here you can easily download",
    "start": "3136200",
    "end": "3143559"
  },
  {
    "text": "Chiron and reproduce uh this Cas is in your environment if you",
    "start": "3143559",
    "end": "3149040"
  },
  {
    "text": "wish any questions we have a like plan for well yeah 5 to 10 minutes if there",
    "start": "3149040",
    "end": "3155400"
  },
  {
    "text": "is uh uh questions let us know said that most operating system",
    "start": "3155400",
    "end": "3163799"
  },
  {
    "text": "actually process this can moref yeah um the question was if uh",
    "start": "3163799",
    "end": "3171000"
  },
  {
    "text": "regarding the statement that most operating systems process such crafted",
    "start": "3171000",
    "end": "3176520"
  },
  {
    "text": "packets if it can be more specific yes we can um actually first of all it",
    "start": "3176520",
    "end": "3181760"
  },
  {
    "text": "depends on the combination who have found out that different combinations Tri trigger responses from different",
    "start": "3181760",
    "end": "3187119"
  },
  {
    "text": "operating systems so we cannot say just it is just Linux or just free BSD or open BSD but um there was a paper um",
    "start": "3187119",
    "end": "3195960"
  },
  {
    "text": "published in 2012 in black hat Abu Dhabi where there is a nice table there that",
    "start": "3195960",
    "end": "3202319"
  },
  {
    "text": "summarize the result there was another presentation at rouers conference that was in 2013 in March of 2013 which",
    "start": "3202319",
    "end": "3210400"
  },
  {
    "text": "Updates this result uh so if you download this stocks you will find a pretty good summary uh I'm sorry that I cannot give",
    "start": "3210400",
    "end": "3218440"
  },
  {
    "text": "a clear answer right now because it exactly depends on the case we examin there are more than 10 different cases",
    "start": "3218440",
    "end": "3224119"
  },
  {
    "text": "and we found out that in some cases for example open BSD responded and some other windows responded uh so it depends",
    "start": "3224119",
    "end": "3231000"
  },
  {
    "text": "on the combination actually but in general I think one could be state that the most robust implementation is free",
    "start": "3231000",
    "end": "3237119"
  },
  {
    "text": "BSD free BSD exactly 3E BSD was the most robust one uh which did not um so most robust",
    "start": "3237119",
    "end": "3244720"
  },
  {
    "text": "one means um uh means that uh it doesn't accept uh too many combinations",
    "start": "3244720",
    "end": "3252599"
  },
  {
    "text": "obviously bad combinations headers that do not follow the recommendation but Antonio has done a lot of research in",
    "start": "3252599",
    "end": "3258960"
  },
  {
    "text": "that um space and he has detailed results like these are the test cases and these are the responses of",
    "start": "3258960",
    "end": "3266000"
  },
  {
    "text": "like 10 different we had 3bc open BC many windows versions Linux pels even ma",
    "start": "3266000",
    "end": "3274160"
  },
  {
    "text": "OS X which resembles very much the FreeBSD 8 if I record correctly so it can be found it just depends on the",
    "start": "3274160",
    "end": "3280119"
  },
  {
    "text": "actual case and to be honest when we do our tests and to try to find to find an",
    "start": "3280119",
    "end": "3287400"
  },
  {
    "text": "evasion Technique we also try to find out which operating system responds to them because you want to find the",
    "start": "3287400",
    "end": "3292839"
  },
  {
    "text": "invasion technique that works in most of them if if possible any more",
    "start": "3292839",
    "end": "3300160"
  },
  {
    "text": "questions uh I did not get a question sorry for that um not a",
    "start": "3302760",
    "end": "3310319"
  },
  {
    "text": "problem thanks in your test in in your testing did you find any vendors that did this handle this correctly does ipv",
    "start": "3310319",
    "end": "3317440"
  },
  {
    "text": "extensions uh no um that is uh that is",
    "start": "3317440",
    "end": "3322640"
  },
  {
    "text": "that was a very good and interesting question the question was if um I mean you certainly heard it if we found any positive examples like we just pointed",
    "start": "3322640",
    "end": "3330280"
  },
  {
    "text": "out the say negative ones um this were this were the four that we actually tested so in in each of them we found",
    "start": "3330280",
    "end": "3338119"
  },
  {
    "text": "issues and as I as I stated um I personally think this is a kind of unsolvable problem as there's too many",
    "start": "3338119",
    "end": "3345799"
  },
  {
    "text": "variations which with like look at a certain offset of a packet and do so",
    "start": "3345799",
    "end": "3351000"
  },
  {
    "text": "maybe even Hardware like in ASX um this can't work once you have that cloudy space of uh combinations I believe it's",
    "start": "3351000",
    "end": "3358240"
  },
  {
    "text": "a problem of Mast against suit if you are more strict if you have M there this",
    "start": "3358240",
    "end": "3364559"
  },
  {
    "text": "m first this must second so on then it may be solved yeah at at at some time",
    "start": "3364559",
    "end": "3370200"
  },
  {
    "text": "right now um we we don't have any positive samples regarding firewalls by the way uh if you wonder about the",
    "start": "3370200",
    "end": "3375880"
  },
  {
    "text": "firewalls uh we didn't mention about anything about the firewalls although there are some comments on the paper uh",
    "start": "3375880",
    "end": "3382480"
  },
  {
    "text": "it's not the fact that firewalls are better than DPS devices it's actually because fars by default usually use a",
    "start": "3382480",
    "end": "3390039"
  },
  {
    "text": "default deny rule uh this is what it saves let's say them if you change the rule and you use",
    "start": "3390039",
    "end": "3397720"
  },
  {
    "text": "a default allow try to block black to Blacklist some traffic then they face the same problems so it's the kind of",
    "start": "3397720",
    "end": "3405319"
  },
  {
    "text": "the different philosophy that we use in the firewalls that saves the",
    "start": "3405319",
    "end": "3410839"
  },
  {
    "text": "situation there's another question over there",
    "start": "3411200",
    "end": "3416880"
  },
  {
    "text": "uh right now um there is no such devices but it might be that actually a very good",
    "start": "3419599",
    "end": "3425559"
  },
  {
    "text": "question uh given we uh mentioned the that architectural approach um if you",
    "start": "3425559",
    "end": "3431160"
  },
  {
    "text": "want an idps to function properly scrub the traffic before it enters the idps",
    "start": "3431160",
    "end": "3436799"
  },
  {
    "text": "this brings up the question the gentleman asked uh is there any any devices which can perform the scrubbing",
    "start": "3436799",
    "end": "3443200"
  },
  {
    "text": "uh right now there is none that we are aware of uh we would expect that at some",
    "start": "3443200",
    "end": "3448400"
  },
  {
    "text": "point um uh like um types certain types of",
    "start": "3448400",
    "end": "3453720"
  },
  {
    "text": "middle boxes might be able to perform this task uh to allow for further um um",
    "start": "3453720",
    "end": "3459799"
  },
  {
    "text": "reasonable processing but right now",
    "start": "3459799",
    "end": "3464119"
  },
  {
    "text": "no thanks again and have a good",
    "start": "3465480",
    "end": "3470359"
  },
  {
    "text": "day",
    "start": "3471640",
    "end": "3474640"
  }
]