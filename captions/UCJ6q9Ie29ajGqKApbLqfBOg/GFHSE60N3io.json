[
  {
    "start": "0",
    "end": "39000"
  },
  {
    "text": "[Music]",
    "start": "3820",
    "end": "13639"
  },
  {
    "text": "hello everyone welcome to my presentation today my topic is related to the apple",
    "start": "14719",
    "end": "20720"
  },
  {
    "text": "wi-fi subsystem the title is dive into apple",
    "start": "20720",
    "end": "26760"
  },
  {
    "text": "io80211 family version 2. my name is wang",
    "start": "26760",
    "end": "32320"
  },
  {
    "text": "from dd research america i can be reached through this email address",
    "start": "32320",
    "end": "39039"
  },
  {
    "start": "39000",
    "end": "379000"
  },
  {
    "text": "in the first part of the presentation we will focus on the architecture of the subsystem",
    "start": "39520",
    "end": "47200"
  },
  {
    "text": "io80211 family is a very old kernel component",
    "start": "49960",
    "end": "55280"
  },
  {
    "text": "but things has changed since last year apple refactored the architecture of the",
    "start": "55280",
    "end": "62480"
  },
  {
    "text": "wi-fi client drivers and renamed the new generation design to version 2.",
    "start": "62480",
    "end": "69920"
  },
  {
    "text": "so our questions follow why does apple need to refactor the code",
    "start": "69920",
    "end": "75439"
  },
  {
    "text": "what are the new changes and what is the impact of these changes for us",
    "start": "75439",
    "end": "82240"
  },
  {
    "text": "we may pay more attention to security impact i will try to answer these questions i",
    "start": "82240",
    "end": "88880"
  },
  {
    "text": "hope this presentation will help you better understand the architecture and the security challenges",
    "start": "88880",
    "end": "94479"
  },
  {
    "text": "of the apple wi-fi subsystem",
    "start": "94479",
    "end": "100240"
  },
  {
    "text": "if we call the previous generation as version one we will see that version one",
    "start": "100240",
    "end": "107360"
  },
  {
    "text": "and version two as family drivers play a very important role in apple's",
    "start": "107360",
    "end": "113840"
  },
  {
    "text": "communication model they are responsible for managing almost",
    "start": "113840",
    "end": "119200"
  },
  {
    "text": "all wi-fi communication functions here are some specific examples for example we need to",
    "start": "119200",
    "end": "126880"
  },
  {
    "text": "set up and the manager ssid channel antenna rate something like that",
    "start": "126880",
    "end": "135120"
  },
  {
    "text": "with these basic concepts in mind let's examine the subsystem from a",
    "start": "136560",
    "end": "142239"
  },
  {
    "text": "higher perspective the above management features are common to the two generations of",
    "start": "142239",
    "end": "149920"
  },
  {
    "text": "design but soon we will find some differences here i list some typical modules of",
    "start": "149920",
    "end": "157680"
  },
  {
    "text": "version 1 error from user mode to kernel mode for daemon we have airpod",
    "start": "157680",
    "end": "165599"
  },
  {
    "text": "after entering the kernel we have the version one family kernel extensions and plug-in",
    "start": "165599",
    "end": "172160"
  },
  {
    "text": "drivers in short version one is mainly designed to support",
    "start": "172160",
    "end": "178159"
  },
  {
    "text": "apple airpod and related equipment we can also find this from the name of",
    "start": "178159",
    "end": "185280"
  },
  {
    "text": "plugin drivers like like airport",
    "start": "185280",
    "end": "190800"
  },
  {
    "text": "broadcom however with the development of mobile",
    "start": "190800",
    "end": "197840"
  },
  {
    "text": "devices we can see that the the design concepts of the wi-fi subsystem has",
    "start": "197840",
    "end": "205760"
  },
  {
    "text": "changed io80211 family version 2 is mainly designed for communication and",
    "start": "205760",
    "end": "213440"
  },
  {
    "text": "the data sharing between the new generation mobile-based apple devices",
    "start": "213440",
    "end": "219840"
  },
  {
    "text": "and airpods no longer appears in the name of the kernel extensions",
    "start": "219840",
    "end": "226400"
  },
  {
    "text": "it's all removed here are two examples we can see that",
    "start": "226400",
    "end": "233599"
  },
  {
    "text": "the new subsystem is better spotted such as skywalk reverse engineering",
    "start": "233599",
    "end": "240080"
  },
  {
    "text": "shows that many functions integrate at least the three branches",
    "start": "240080",
    "end": "246000"
  },
  {
    "text": "which lead to different subsystem and the skywalk is a one that was",
    "start": "246000",
    "end": "252319"
  },
  {
    "text": "recently introduced for new features sidecar was recently introduced",
    "start": "252319",
    "end": "259280"
  },
  {
    "text": "as well two conclusions here number one family",
    "start": "259280",
    "end": "266080"
  },
  {
    "text": "version 2 is a brand new design for the mobile era number two",
    "start": "266080",
    "end": "273520"
  },
  {
    "text": "family version 2 and w lan core integrated the original airpod broadcom",
    "start": "273520",
    "end": "279600"
  },
  {
    "text": "drivers with more features and better logic",
    "start": "279600",
    "end": "285040"
  },
  {
    "text": "one more thing is that please also keep in mind new features always mean new attack",
    "start": "285440",
    "end": "291600"
  },
  {
    "text": "services [Music] if we want to further understand the",
    "start": "291600",
    "end": "298960"
  },
  {
    "text": "wi-fi subsystem where should we start my approach is that i follow the two",
    "start": "298960",
    "end": "306000"
  },
  {
    "text": "articles by jonathan these two articles try to build",
    "start": "306000",
    "end": "311280"
  },
  {
    "text": "an wi-fi compatible framework from scratch",
    "start": "311280",
    "end": "316560"
  },
  {
    "text": "through this project we can quickly become familiar with the user mode of the entire wi-fi",
    "start": "316560",
    "end": "323280"
  },
  {
    "text": "subsystem and the interface of the kernel layer",
    "start": "323280",
    "end": "328400"
  },
  {
    "text": "personally i have learned a lot from the compatible framework project",
    "start": "328400",
    "end": "335360"
  },
  {
    "text": "seeing this you might see that i'm familiar with this matter because we did",
    "start": "336560",
    "end": "343520"
  },
  {
    "text": "many similar projects on windows platform for example in order to combat",
    "start": "343520",
    "end": "351440"
  },
  {
    "text": "root kits and kernel online hook we have tried such solutions in file system and the night",
    "start": "351440",
    "end": "358000"
  },
  {
    "text": "work related functions yes you're right but before we start i would",
    "start": "358000",
    "end": "365600"
  },
  {
    "text": "recommend it reading uh the following projects like intel wi-fi for mac os",
    "start": "365600",
    "end": "372960"
  },
  {
    "text": "and udu wifi",
    "start": "372960",
    "end": "380400"
  },
  {
    "start": "379000",
    "end": "668000"
  },
  {
    "text": "in the next section we will focus on attack surface and the security",
    "start": "380400",
    "end": "386319"
  },
  {
    "text": "assessment first of all we should consider all",
    "start": "386319",
    "end": "392400"
  },
  {
    "text": "inputs are potentially dangerous or we can call it zero trust for kernel",
    "start": "392400",
    "end": "400639"
  },
  {
    "text": "the attack surface can be divided into at least two categories from remote",
    "start": "400639",
    "end": "407280"
  },
  {
    "text": "and local firmware to operating system kernel and from daemon and framework",
    "start": "407280",
    "end": "414000"
  },
  {
    "text": "to operating system kernel the third category belongs to some exceptions so i listed",
    "start": "414000",
    "end": "422319"
  },
  {
    "text": "it as all all other handlers and the puzzles",
    "start": "422319",
    "end": "428240"
  },
  {
    "text": "for the category from remote and firmware to kernel i have two examples the first one is",
    "start": "429919",
    "end": "437039"
  },
  {
    "text": "from the research of google project zero gail biniami discovered a large number",
    "start": "437039",
    "end": "444400"
  },
  {
    "text": "of vulnerabilities caused by handle event packet",
    "start": "444400",
    "end": "449599"
  },
  {
    "text": "this function can be reached remotely the second example is handle firmware",
    "start": "449599",
    "end": "456479"
  },
  {
    "text": "trap this function handles requests and events from the firmware they are all",
    "start": "456479",
    "end": "464000"
  },
  {
    "text": "excellent attack surfaces",
    "start": "464000",
    "end": "467280"
  },
  {
    "text": "for the other direction from user mode to kernel as early as 2007",
    "start": "469039",
    "end": "476639"
  },
  {
    "text": "magazine only informed had an article about the set scan request",
    "start": "476639",
    "end": "482479"
  },
  {
    "text": "vulnerability which is well worth reading in addition we also have examples for",
    "start": "482479",
    "end": "490960"
  },
  {
    "text": "airport broadcom and ic the two links below are from zdi",
    "start": "490960",
    "end": "498479"
  },
  {
    "text": "for the third category it covers a wide range for example awdl particle",
    "start": "501280",
    "end": "509360"
  },
  {
    "text": "skywalk and the routing handle data packet these are the attack",
    "start": "509360",
    "end": "515919"
  },
  {
    "text": "surfaces that i discovered during daily debugging behind them are often very complex",
    "start": "515919",
    "end": "523680"
  },
  {
    "text": "designs two years ago i wrote a",
    "start": "523680",
    "end": "531360"
  },
  {
    "text": "kernel extension called chemo in addition to monitoring features came",
    "start": "531360",
    "end": "538399"
  },
  {
    "text": "on has an inline hook engine which can hook almost any function kernel function you want",
    "start": "538399",
    "end": "545760"
  },
  {
    "text": "the source code can be found on github and last year i practiced mac os ipc and xpc",
    "start": "545760",
    "end": "553279"
  },
  {
    "text": "communication monitoring based on this project here is a link to black hat arsenal",
    "start": "553279",
    "end": "560839"
  },
  {
    "text": "2019 and in order to learn more about the",
    "start": "560839",
    "end": "567760"
  },
  {
    "text": "attack surfaces of the wi-fi subsystem i wrote several sniffers based on came on so",
    "start": "567760",
    "end": "574959"
  },
  {
    "text": "that's why i introduced the came on to you this picture is one of them",
    "start": "574959",
    "end": "580000"
  },
  {
    "text": "it can intercept all get and set requests sent to the wi-fi",
    "start": "580000",
    "end": "586320"
  },
  {
    "text": "family drivers but because kimono has pre and post callback capabilities",
    "start": "586320",
    "end": "593600"
  },
  {
    "text": "i can pass the input parameters and other useful information in the pre-callback handler as we can",
    "start": "593600",
    "end": "601360"
  },
  {
    "text": "see i can capture process name type user buffer and the lens",
    "start": "601360",
    "end": "608959"
  },
  {
    "text": "use a buffer lens i can also modify retain data of the target function in",
    "start": "608959",
    "end": "616079"
  },
  {
    "text": "the post callback handler like the compatible framework project",
    "start": "616079",
    "end": "622880"
  },
  {
    "text": "this sniffers helping me a lot",
    "start": "622880",
    "end": "627200"
  },
  {
    "text": "so let's make a summary since i have chemo in hand i can perform code",
    "start": "628720",
    "end": "635440"
  },
  {
    "text": "coverage analysis on the closed source drivers i implement",
    "start": "635440",
    "end": "640560"
  },
  {
    "text": "several sniffers i can convert them to passive father",
    "start": "640560",
    "end": "646320"
  },
  {
    "text": "for example i can do bit flipping of input parameters easily i have compatible frameworks",
    "start": "646320",
    "end": "654720"
  },
  {
    "text": "so i can also convert them to active fuzzers in practice i found that",
    "start": "654720",
    "end": "660959"
  },
  {
    "text": "combining the two fuzzing methods often has better results",
    "start": "660959",
    "end": "666720"
  },
  {
    "start": "668000",
    "end": "930000"
  },
  {
    "text": "okay in the next section we will discuss the latest vulnerability",
    "start": "668640",
    "end": "674560"
  },
  {
    "text": "cases that i found this year",
    "start": "674560",
    "end": "679040"
  },
  {
    "text": "so far i have reported a total of 18 vulnerabilities of the wi-fi",
    "start": "682399",
    "end": "688800"
  },
  {
    "text": "subsystem to apple security and four of them were repaired repelled",
    "start": "688800",
    "end": "693920"
  },
  {
    "text": "at the end of may the types of vulnerabilities covered",
    "start": "693920",
    "end": "701440"
  },
  {
    "text": "hipaa floor hip data ob access kernel information disclosure",
    "start": "701440",
    "end": "709440"
  },
  {
    "text": "stackable floor without cookie protection arbitrary kernel memory right and the integral floor",
    "start": "709440",
    "end": "717519"
  },
  {
    "text": "it can be said that i have been dealing with all kind of stranger panics",
    "start": "717519",
    "end": "724560"
  },
  {
    "text": "in the past few months",
    "start": "724560",
    "end": "727680"
  },
  {
    "text": "i can classify this vulnerability from another perspective uh like number",
    "start": "729760",
    "end": "736240"
  },
  {
    "text": "one vulnerabilities affecting olin version two and the vulnerabilities",
    "start": "736240",
    "end": "744320"
  },
  {
    "text": "affecting both version 1 and version 2 and the number 3 vulnerabilities",
    "start": "744320",
    "end": "750320"
  },
  {
    "text": "affecting odin version 1.",
    "start": "750320",
    "end": "754079"
  },
  {
    "text": "further if we deeply analysis the first category",
    "start": "756839",
    "end": "762560"
  },
  {
    "text": "vulnerabilities affecting olin family in version two we can find",
    "start": "762560",
    "end": "767839"
  },
  {
    "text": "that it can be disassembled as 1.1 introduced link to v2",
    "start": "767839",
    "end": "775279"
  },
  {
    "text": "when porting existing rerun features and 1.2 introducing to way to when",
    "start": "775279",
    "end": "782720"
  },
  {
    "text": "implementing new features we will discuss them one by one",
    "start": "782720",
    "end": "788399"
  },
  {
    "text": "but let's start with cbe 2020 9834",
    "start": "789200",
    "end": "794320"
  },
  {
    "text": "it belongs to category 1.1 generally speaking when i run fuzzer",
    "start": "794320",
    "end": "802240"
  },
  {
    "text": "for the first time usually nothing happens",
    "start": "802240",
    "end": "807440"
  },
  {
    "text": "i i need to spend a lot of effort to find out what is the reason for",
    "start": "807440",
    "end": "814160"
  },
  {
    "text": "not having panics maybe the target is really robust or maybe the",
    "start": "814160",
    "end": "820560"
  },
  {
    "text": "code coverage rate of my father is too low but this time this time was different",
    "start": "820560",
    "end": "828000"
  },
  {
    "text": "i got a panic report at the same time i rang the fuzzer and after an hour",
    "start": "828000",
    "end": "834959"
  },
  {
    "text": "there were too many reports to handle i have four cases here um",
    "start": "834959",
    "end": "842959"
  },
  {
    "text": "so to to save time let me escape the case one case two because they are",
    "start": "842959",
    "end": "850079"
  },
  {
    "text": "uh or non-point d reference issue in case three the last panning clog",
    "start": "850079",
    "end": "857519"
  },
  {
    "text": "seems pretty good it's called stack is clear and the instruction that caused",
    "start": "857519",
    "end": "864240"
  },
  {
    "text": "the crash seems uh full of hope",
    "start": "864240",
    "end": "869199"
  },
  {
    "text": "seems we can control the rex register",
    "start": "869279",
    "end": "873600"
  },
  {
    "text": "then i started to tailor my fuzzer i narrowed down",
    "start": "874560",
    "end": "881839"
  },
  {
    "text": "the scope step by step until i found the routing set scan request",
    "start": "881839",
    "end": "889839"
  },
  {
    "text": "in the output of the adder hex three on the right we can see that on lies 34 and 35",
    "start": "889839",
    "end": "900240"
  },
  {
    "text": "the input from user mode should not be greater than 9d4 this is a very large",
    "start": "900240",
    "end": "907120"
  },
  {
    "text": "input structure to understand the root cause of the problem we need to figure out the",
    "start": "907120",
    "end": "913199"
  },
  {
    "text": "detail of the structure so one challenge i faced at the time was whether",
    "start": "913199",
    "end": "921199"
  },
  {
    "text": "this input structure could be clarified through uh like remove remote engineering",
    "start": "921199",
    "end": "928800"
  },
  {
    "text": "soon i found a method reverse engineering is feasible",
    "start": "929759",
    "end": "936160"
  },
  {
    "start": "930000",
    "end": "1192000"
  },
  {
    "text": "i found debugging information including set scan request here in which",
    "start": "936160",
    "end": "943199"
  },
  {
    "text": "a lot of readable strings were submitted to the function cc log string for example",
    "start": "943199",
    "end": "950959"
  },
  {
    "text": "on the right side we can see that uh the offset 34",
    "start": "950959",
    "end": "960079"
  },
  {
    "text": "of the input structure should be a member called scan type",
    "start": "960079",
    "end": "967279"
  },
  {
    "text": "and the 44 should be a member called number of channels so so we can have a",
    "start": "967279",
    "end": "974480"
  },
  {
    "text": "table we can make a table",
    "start": "974480",
    "end": "979279"
  },
  {
    "text": "as the program continue to execute we will continue we will come to a",
    "start": "980639",
    "end": "986720"
  },
  {
    "text": "routine called field scan parameters this function is responsible for",
    "start": "986720",
    "end": "993519"
  },
  {
    "text": "extracting external parameters and feeding the input into an internal structure",
    "start": "993519",
    "end": "1002160"
  },
  {
    "text": "the data structure on the left is positive by callers and we can treat it as",
    "start": "1002160",
    "end": "1009440"
  },
  {
    "text": "untrusted or tinted data the data structure on the right is the",
    "start": "1009440",
    "end": "1015440"
  },
  {
    "text": "internal data structure of field scan parameter which is merge",
    "start": "1015440",
    "end": "1020800"
  },
  {
    "text": "external inputs",
    "start": "1020800",
    "end": "1025839"
  },
  {
    "text": "i audited each member's scoping process one by one until i saw",
    "start": "1026000",
    "end": "1032880"
  },
  {
    "text": "the code on the right i found a fatal arrow",
    "start": "1032880",
    "end": "1038480"
  },
  {
    "text": "on the first of the line of the picture which is 179 of the era hex record",
    "start": "1038480",
    "end": "1046720"
  },
  {
    "text": "here the program extracts data from the",
    "start": "1046720",
    "end": "1053120"
  },
  {
    "text": "44 offset of the input buffer combining the previous knowledge we know",
    "start": "1053120",
    "end": "1059120"
  },
  {
    "text": "that the private symbol of this member is number of channels",
    "start": "1059120",
    "end": "1067280"
  },
  {
    "text": "then the value of number of channels will be stored at the offset 3c",
    "start": "1067280",
    "end": "1074240"
  },
  {
    "text": "okay 3c of the internal structure the k point is the do well loop",
    "start": "1074240",
    "end": "1083440"
  },
  {
    "text": "that starts at 185 the loop starts at zero and",
    "start": "1083679",
    "end": "1090400"
  },
  {
    "text": "accumulates until it equals number of channels here so",
    "start": "1090400",
    "end": "1097039"
  },
  {
    "text": "is there an upper limit for number of channels unfortunately i",
    "start": "1097039",
    "end": "1103440"
  },
  {
    "text": "don't see such logic in the code in other words the",
    "start": "1103440",
    "end": "1109840"
  },
  {
    "text": "external input number of channels determines the number of execution of",
    "start": "1109840",
    "end": "1115840"
  },
  {
    "text": "the dual loop which can be zero or can be",
    "start": "1115840",
    "end": "1120960"
  },
  {
    "text": "hundred thousand but you know henry thousand is absolutely unacceptable it's hipaa floor",
    "start": "1120960",
    "end": "1129200"
  },
  {
    "text": "and by the way there is an interesting fact is in english code on",
    "start": "1129200",
    "end": "1136559"
  },
  {
    "text": "line 188 we can see that when the code reads data from the input",
    "start": "1136559",
    "end": "1142320"
  },
  {
    "text": "buffer it will escape c bytes each time this detail is actually very important",
    "start": "1142320",
    "end": "1150799"
  },
  {
    "text": "when writing exploit code we need to set the memory layout according to this feature",
    "start": "1150799",
    "end": "1158720"
  },
  {
    "text": "after having all these analysis we finally got a sense of this hippo floor",
    "start": "1160640",
    "end": "1166799"
  },
  {
    "text": "vulnerability in the input buffer on the left if we lay out the memory like this",
    "start": "1166799",
    "end": "1173440"
  },
  {
    "text": "we will have full right capability to the target internal structure",
    "start": "1173440",
    "end": "1179440"
  },
  {
    "text": "and because number of channels can be fully manipulated so we can precisely",
    "start": "1179440",
    "end": "1185919"
  },
  {
    "text": "control the number of bytes overflowed",
    "start": "1185919",
    "end": "1192960"
  },
  {
    "start": "1192000",
    "end": "1323000"
  },
  {
    "text": "okay let me summarize the root cause of cve 2020 9834 the vulnerable function lacks the",
    "start": "1192960",
    "end": "1201280"
  },
  {
    "text": "necessary checks for number of channels in the input parameter input structure which leads to",
    "start": "1201280",
    "end": "1208720"
  },
  {
    "text": "auto bound operations autobahn's operation has two place places source",
    "start": "1208720",
    "end": "1215600"
  },
  {
    "text": "and the destination buffer for source buffer this means autobahn access and for destination",
    "start": "1215600",
    "end": "1222000"
  },
  {
    "text": "buffer this means people were right the quality of this",
    "start": "1222000",
    "end": "1227360"
  },
  {
    "text": "vulnerability is pretty good because the right primitive is relatively complete",
    "start": "1227360",
    "end": "1233200"
  },
  {
    "text": "and for vulnerability with incomplete right permittive please refer to my previous write up",
    "start": "1233200",
    "end": "1241440"
  },
  {
    "text": "so at this point we can write the analysis report and even",
    "start": "1243760",
    "end": "1250080"
  },
  {
    "text": "exploit code but there are still some unanswered questions uh such as",
    "start": "1250080",
    "end": "1257039"
  },
  {
    "text": "why does the right committee read from the inputs average z bytes and what is the",
    "start": "1257039",
    "end": "1263840"
  },
  {
    "text": "remaining meaning of the remaining fields in the input structure",
    "start": "1263840",
    "end": "1269120"
  },
  {
    "text": "uh usually if i i have a new task coming i will leave a",
    "start": "1269120",
    "end": "1275600"
  },
  {
    "text": "to-do list here and maybe i will not touch it for years but this year is really special working",
    "start": "1275600",
    "end": "1283120"
  },
  {
    "text": "at home is boring to me so i found this",
    "start": "1283120",
    "end": "1288799"
  },
  {
    "text": "the apple sdk from mac os x 10.1 to mac os 10.15",
    "start": "1288880",
    "end": "1297039"
  },
  {
    "text": "it is interesting that the sdk header files of the wi-fi subsystem appeared briefly on",
    "start": "1297039",
    "end": "1304080"
  },
  {
    "text": "the ten point four five and six things uh 10.7 these files",
    "start": "1304080",
    "end": "1312400"
  },
  {
    "text": "have been removed uh so we have a very small window to pick at what the",
    "start": "1312400",
    "end": "1318880"
  },
  {
    "text": "six file contains",
    "start": "1318880",
    "end": "1322080"
  },
  {
    "start": "1323000",
    "end": "1553000"
  },
  {
    "text": "and next i found that i found that there are some projects that did contain",
    "start": "1323919",
    "end": "1330960"
  },
  {
    "text": "more recent apple wi-fi sdk header files like high sierra or even katrina",
    "start": "1330960",
    "end": "1339520"
  },
  {
    "text": "so why is apple's sdk code leaked um not really",
    "start": "1339520",
    "end": "1347200"
  },
  {
    "text": "after comparison i found that the code was not from apple",
    "start": "1347200",
    "end": "1352640"
  },
  {
    "text": "they are more like the communities reverse knowledge sharing",
    "start": "1352640",
    "end": "1358240"
  },
  {
    "text": "in order to write compatible frameworks and better spot network devices they reversed",
    "start": "1358240",
    "end": "1366320"
  },
  {
    "text": "a large number of kernel drivers uh for example the interfaces here",
    "start": "1366320",
    "end": "1373520"
  },
  {
    "text": "are all from reverse engineering of family kernel extensions",
    "start": "1373520",
    "end": "1379919"
  },
  {
    "text": "well maybe i can also contribute to the community this is the 18 interface added by",
    "start": "1380000",
    "end": "1388400"
  },
  {
    "text": "mac os bixer this interface represents the latest changes in the",
    "start": "1388400",
    "end": "1394240"
  },
  {
    "text": "platform so together we can make the community community a better place",
    "start": "1394240",
    "end": "1403840"
  },
  {
    "text": "without further ado let's go back to the vulnerability with the support of the apple sdk we can",
    "start": "1404320",
    "end": "1411840"
  },
  {
    "text": "get all the necessary information including unknown fields",
    "start": "1411840",
    "end": "1417679"
  },
  {
    "text": "the previews on the question was uh can also answered the reason for reading every c",
    "start": "1417679",
    "end": "1424640"
  },
  {
    "text": "bytes is because there is a substruct array in the definition of scanned data",
    "start": "1424640",
    "end": "1432960"
  },
  {
    "text": "and the wonderful routing olin wants to copy the channel member",
    "start": "1432960",
    "end": "1439279"
  },
  {
    "text": "channel members in addition we can see that here here is the definition called",
    "start": "1439279",
    "end": "1446960"
  },
  {
    "text": "max channels which is 64 inside so the the wonderbar code does",
    "start": "1446960",
    "end": "1454480"
  },
  {
    "text": "not follow the requirements here",
    "start": "1454480",
    "end": "1459840"
  },
  {
    "text": "i think you may have a similar questions as i did a few months ago why",
    "start": "1460640",
    "end": "1466960"
  },
  {
    "text": "why can such an obvious vulnerability survive to 2020",
    "start": "1466960",
    "end": "1473840"
  },
  {
    "text": "the answer is that this vulnerability was introduced into v2 when porting the existing feature of v1",
    "start": "1475840",
    "end": "1483360"
  },
  {
    "text": "and there is no problem with v1 related function we can see in the picture on the right",
    "start": "1483360",
    "end": "1492080"
  },
  {
    "text": "there is a limit on the size of the array on mac os mojave but for unknown readings io8",
    "start": "1492080",
    "end": "1500799"
  },
  {
    "text": "family version 2 removed the binary check so this is a brand new vulnerability",
    "start": "1500799",
    "end": "1508400"
  },
  {
    "text": "introduced by developers a more a more interesting fact is that",
    "start": "1508400",
    "end": "1515760"
  },
  {
    "text": "this is not the first time that the set scan request function is vulnerable",
    "start": "1515760",
    "end": "1521200"
  },
  {
    "text": "if you have uh read the the article osx",
    "start": "1521200",
    "end": "1528880"
  },
  {
    "text": "kernel mode exploitation in a weekend before you will find this function was",
    "start": "1528880",
    "end": "1535120"
  },
  {
    "text": "attacked 13 years ago so if other had a time machine",
    "start": "1535120",
    "end": "1541760"
  },
  {
    "text": "at that time i would suggest flying to 2020. this year is so special",
    "start": "1541760",
    "end": "1550000"
  },
  {
    "text": "he will be surprised okay the next case is also interesting",
    "start": "1550000",
    "end": "1556720"
  },
  {
    "text": "it belongs to the category 1.2 um i have three pictures here",
    "start": "1556720",
    "end": "1564799"
  },
  {
    "text": "the first picture mingling says um the driver",
    "start": "1564799",
    "end": "1571520"
  },
  {
    "text": "allocates over 200 bytes to a buffer called the trapping four",
    "start": "1571520",
    "end": "1579279"
  },
  {
    "text": "but please note that there is no initialization at this stage in the second picture",
    "start": "1579279",
    "end": "1587120"
  },
  {
    "text": "on the right we finally see the initialization process of this buffer a routine named",
    "start": "1587120",
    "end": "1595279"
  },
  {
    "text": "handle firmware trap will fill in the trap infor with information returned by the",
    "start": "1595279",
    "end": "1602080"
  },
  {
    "text": "phone well the third picture actually sends this information to the caller",
    "start": "1602080",
    "end": "1610320"
  },
  {
    "text": "in short we have three functions and the three steps allocation initialization and the",
    "start": "1610320",
    "end": "1618400"
  },
  {
    "text": "extraction so my question is can you sport the hidden vulnerability",
    "start": "1618400",
    "end": "1624960"
  },
  {
    "text": "among them yeah i know uh boring question",
    "start": "1624960",
    "end": "1633360"
  },
  {
    "text": "let me speed up i only have 40 minutes um this scopes make an assumption",
    "start": "1633360",
    "end": "1641120"
  },
  {
    "text": "the expected execution order is step one two and then three",
    "start": "1641120",
    "end": "1648080"
  },
  {
    "text": "so my question can actually be changed to is it possible to extract the",
    "start": "1648080",
    "end": "1654480"
  },
  {
    "text": "information before it is initialized",
    "start": "1654480",
    "end": "1659440"
  },
  {
    "text": "the answer is yes it is possible the leaked heap data can",
    "start": "1660320",
    "end": "1667440"
  },
  {
    "text": "execute 200 bytes including kernel data function pointers",
    "start": "1667440",
    "end": "1674159"
  },
  {
    "text": "and we can see a large number of kernel objects linked on the right",
    "start": "1674159",
    "end": "1682559"
  },
  {
    "text": "um we need to beat uh kasra when writing exploit code",
    "start": "1682559",
    "end": "1689679"
  },
  {
    "text": "i also tried it in the figure we can see that the destination",
    "start": "1689679",
    "end": "1697279"
  },
  {
    "text": "is the buffer to be returned to the user mode and the source is trapping for",
    "start": "1697279",
    "end": "1704880"
  },
  {
    "text": "buffer and at here the base address of the trapping per",
    "start": "1704880",
    "end": "1710559"
  },
  {
    "text": "buffer has been leaked through hip finishing you can see here",
    "start": "1710559",
    "end": "1716159"
  },
  {
    "text": "this address this data is actually the the base address of trapping for",
    "start": "1716159",
    "end": "1723039"
  },
  {
    "text": "buffer so and then kasr will be",
    "start": "1723039",
    "end": "1728720"
  },
  {
    "text": "will become meaningless",
    "start": "1728720",
    "end": "1732799"
  },
  {
    "text": "okay i have a demo of this one reability please let me play the video",
    "start": "1734960",
    "end": "1742799"
  },
  {
    "text": "okay um the operating system is unpatched it's a",
    "start": "1749120",
    "end": "1755679"
  },
  {
    "text": "it's a older version and let me run the exploit",
    "start": "1755679",
    "end": "1762000"
  },
  {
    "text": "yeah we can see a large number of kernel functions function pointers",
    "start": "1764880",
    "end": "1770240"
  },
  {
    "text": "leaked they are all kernel objects",
    "start": "1770240",
    "end": "1781840"
  },
  {
    "start": "1783000",
    "end": "1828000"
  },
  {
    "text": "okay um the following two vulnerabilities belongs belong to the second category um",
    "start": "1784080",
    "end": "1791440"
  },
  {
    "text": "let me make the the long story short i found this problem both",
    "start": "1791440",
    "end": "1798559"
  },
  {
    "text": "on old and new family drivers the root cause is still related to",
    "start": "1798559",
    "end": "1805039"
  },
  {
    "text": "improved validation these are the panic logs of the two",
    "start": "1805039",
    "end": "1812000"
  },
  {
    "text": "versions we can see when i passing for example database",
    "start": "1812000",
    "end": "1820000"
  },
  {
    "text": "the function set scanning state will read out of bounds",
    "start": "1820000",
    "end": "1828080"
  },
  {
    "start": "1828000",
    "end": "1883000"
  },
  {
    "text": "this vulnerability can be used to detect hip data or memory layout",
    "start": "1830000",
    "end": "1837360"
  },
  {
    "text": "but i i have to see its quality cannot be compared with the",
    "start": "1837360",
    "end": "1843440"
  },
  {
    "text": "previous one okay the third category is vulnerability",
    "start": "1843440",
    "end": "1849760"
  },
  {
    "text": "affecting only one in other words version 2",
    "start": "1849760",
    "end": "1855039"
  },
  {
    "text": "fixes wonderful functions unfortunately these important",
    "start": "1855039",
    "end": "1860640"
  },
  {
    "text": "improvements have not been synchronized with other system platforms",
    "start": "1860640",
    "end": "1865679"
  },
  {
    "text": "so we can use them to attack targets like the latest mac os mojave and the macos high",
    "start": "1865679",
    "end": "1872000"
  },
  {
    "text": "sierra apple plans to address this case",
    "start": "1872000",
    "end": "1878320"
  },
  {
    "text": "in a future security update",
    "start": "1878320",
    "end": "1883440"
  },
  {
    "start": "1883000",
    "end": "1916000"
  },
  {
    "text": "in addition to the above vulnerabilities i i have at least a dozen new zero days",
    "start": "1887440",
    "end": "1894080"
  },
  {
    "text": "waiting to be fixed um but i cannot share their details this time uh maybe in the",
    "start": "1894080",
    "end": "1901360"
  },
  {
    "text": "future i will share this interesting and powerful vulnerabilities with you through",
    "start": "1901360",
    "end": "1907200"
  },
  {
    "text": "blog um let's work together to protect the endpoint security of apple",
    "start": "1907200",
    "end": "1913519"
  },
  {
    "text": "platforms thanks um i mentioned uh i",
    "start": "1913519",
    "end": "1921679"
  },
  {
    "start": "1916000",
    "end": "2017000"
  },
  {
    "text": "implemented several wi-fi fuzzers so let's say how it works on",
    "start": "1921679",
    "end": "1928559"
  },
  {
    "text": "mac os bixer please let me play the video",
    "start": "1928559",
    "end": "1937039"
  },
  {
    "text": "okay yes this video",
    "start": "1946840",
    "end": "1953679"
  },
  {
    "text": "this is a target machine and the os is the latest macos fixer",
    "start": "1957519",
    "end": "1965120"
  },
  {
    "text": "we can say the the build number is uh 430b",
    "start": "1965120",
    "end": "1971519"
  },
  {
    "text": "is the latest one and let me run my fuzzer",
    "start": "1971519",
    "end": "1979279"
  },
  {
    "text": "yes okay after a few seconds the system",
    "start": "1979279",
    "end": "1985840"
  },
  {
    "text": "crashed um this is the this is the target machine and on the",
    "start": "1985840",
    "end": "1993840"
  },
  {
    "text": "left set is the rdb remote debugger you can see uh the current instruction",
    "start": "1993840",
    "end": "2000720"
  },
  {
    "text": "shows that this is a panic",
    "start": "2000720",
    "end": "2005840"
  },
  {
    "text": "okay",
    "start": "2006399",
    "end": "2008640"
  },
  {
    "start": "2017000",
    "end": "2091000"
  },
  {
    "text": "okay yeah another interesting uh question is",
    "start": "2017279",
    "end": "2023760"
  },
  {
    "text": "does uh do this vulnerabilities uh affect ios",
    "start": "2023760",
    "end": "2030559"
  },
  {
    "text": "um the answer is yes again um we just need to add an",
    "start": "2030559",
    "end": "2036880"
  },
  {
    "text": "entitlement to the poc",
    "start": "2036880",
    "end": "2041600"
  },
  {
    "text": "like com.apple dot wlan authentication dot authentication",
    "start": "2042960",
    "end": "2050878"
  },
  {
    "text": "and then for cve 2020 9834 we can get such a panic",
    "start": "2051200",
    "end": "2059839"
  },
  {
    "text": "on ios the version number is iphone os 13 view number is 1750",
    "start": "2059839",
    "end": "2070398"
  },
  {
    "text": "it's a hip override vulnerability",
    "start": "2070480",
    "end": "2075838"
  },
  {
    "text": "okay let's move to the last section of today's presentation",
    "start": "2081919",
    "end": "2089838"
  },
  {
    "start": "2091000",
    "end": "2149000"
  },
  {
    "text": "takeaways the first point is related to the",
    "start": "2092560",
    "end": "2099040"
  },
  {
    "text": "architecture of the wi-fi subsystem family version 2",
    "start": "2099040",
    "end": "2104160"
  },
  {
    "text": "and the wlan core integrates the original airpods broadcom",
    "start": "2104160",
    "end": "2110240"
  },
  {
    "text": "drivers with more features and more reasonable logic the second i want to say is",
    "start": "2110240",
    "end": "2118720"
  },
  {
    "text": "new features always mean new attack services and number three the apple sdk",
    "start": "2118720",
    "end": "2126880"
  },
  {
    "text": "helped me a lot for me combining reverse engineering and the apple sdk means a better life",
    "start": "2126880",
    "end": "2136720"
  },
  {
    "text": "the last one we reviewed several brand new",
    "start": "2136720",
    "end": "2141760"
  },
  {
    "text": "kernel vulnerabilities and in the future we will have some more interesting cases",
    "start": "2141760",
    "end": "2149520"
  },
  {
    "start": "2149000",
    "end": "2393000"
  },
  {
    "text": "time's up thank you very much thank you for your time",
    "start": "2150800",
    "end": "2155680"
  },
  {
    "text": "thanks um hi uh hello everyone welcome to",
    "start": "2156839",
    "end": "2162320"
  },
  {
    "text": "my presentation um uh yes we have one question is about my",
    "start": "2162320",
    "end": "2170320"
  },
  {
    "text": "uh buzzing method",
    "start": "2170320",
    "end": "2174880"
  },
  {
    "text": "okay yes my fuzzing method can consist of three parts",
    "start": "2175680",
    "end": "2182560"
  },
  {
    "text": "the first one is i wrote my own i o",
    "start": "2182560",
    "end": "2188720"
  },
  {
    "text": "apple h0211 compatible framework according to the method of jonathan this",
    "start": "2188720",
    "end": "2195359"
  },
  {
    "text": "project can be transformed into an active facet",
    "start": "2195359",
    "end": "2201599"
  },
  {
    "text": "and i implement a wi-fi request receiver based on chemo",
    "start": "2201599",
    "end": "2209200"
  },
  {
    "text": "so this project can either be transformed to a passive budget for example i can do",
    "start": "2209200",
    "end": "2215200"
  },
  {
    "text": "bit flipping for the whole subsystem and",
    "start": "2215200",
    "end": "2220720"
  },
  {
    "text": "i also implement a simple code coverage analysis tool based on",
    "start": "2220720",
    "end": "2226400"
  },
  {
    "text": "chemos in a hook engine so right now the current version is",
    "start": "2226400",
    "end": "2231839"
  },
  {
    "text": "still very basic uh the current version works at the function level and supports about the henries of i o",
    "start": "2231839",
    "end": "2239920"
  },
  {
    "text": "control handlers and abnormal exit branches",
    "start": "2239920",
    "end": "2246160"
  },
  {
    "text": "but this this version already helped me find the kernel vulnerabilities so",
    "start": "2246160",
    "end": "2254000"
  },
  {
    "text": "yes i i combined [Music]",
    "start": "2255040",
    "end": "2261359"
  },
  {
    "text": "two different ways together and i have a a simple code coverage",
    "start": "2261359",
    "end": "2268880"
  },
  {
    "text": "analysis solution yes that's my method",
    "start": "2268880",
    "end": "2285839"
  },
  {
    "text": "okay um okay just uh",
    "start": "2293280",
    "end": "2298890"
  },
  {
    "text": "[Music] another thing i want to mention is that",
    "start": "2298890",
    "end": "2306240"
  },
  {
    "text": "uh um in this slides i",
    "start": "2306240",
    "end": "2312480"
  },
  {
    "text": "i have three series um cbe 2020 9832 is related to",
    "start": "2312480",
    "end": "2320880"
  },
  {
    "text": "kernel extension um io wi-fi family version 2 and",
    "start": "2320880",
    "end": "2328400"
  },
  {
    "text": "the cv number 9833 is related to the underlying plug-in drivers",
    "start": "2328400",
    "end": "2337040"
  },
  {
    "text": "the apple bcmw bus interface pcie and the the cv number 9834 is related to",
    "start": "2337520",
    "end": "2346560"
  },
  {
    "text": "the function of apple bcm wn",
    "start": "2346560",
    "end": "2351599"
  },
  {
    "text": "w lan core so in other words the entire kernel cost",
    "start": "2351599",
    "end": "2357119"
  },
  {
    "text": "stack of i o wi-fi version 2 has been",
    "start": "2357119",
    "end": "2363119"
  },
  {
    "text": "found to have problems so so so to me i think there's",
    "start": "2363119",
    "end": "2370240"
  },
  {
    "text": "still room for improvement",
    "start": "2370240",
    "end": "2374320"
  },
  {
    "text": "yes that that's it um thank you",
    "start": "2380839",
    "end": "2388960"
  },
  {
    "text": "for your questions um and thanks for watching",
    "start": "2388960",
    "end": "2394960"
  }
]