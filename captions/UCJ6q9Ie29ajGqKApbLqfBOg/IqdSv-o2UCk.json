[
  {
    "start": "0",
    "end": "51000"
  },
  {
    "text": "hi everyone thank you for coming to black hat 2015 a couple quick announcements there",
    "start": "160",
    "end": "7439"
  },
  {
    "text": "will be a reception tonight in the business Hall at 5:30 p.m. the business Hall is located in Shoreline a room uh",
    "start": "7439",
    "end": "15679"
  },
  {
    "text": "second item is the pony Awards will take place tonight in the manderlay bay b c",
    "start": "15679",
    "end": "21160"
  },
  {
    "text": "and d now at 6:30 so if you heard earlier that it was 6 that has changed",
    "start": "21160",
    "end": "26320"
  },
  {
    "text": "to 6:30ish and that said you are in uh",
    "start": "26320",
    "end": "31880"
  },
  {
    "text": "Lagoon k for the session fais encryption realities of Secure Storage on mobile",
    "start": "31880",
    "end": "38640"
  },
  {
    "text": "devices with Daniel Meyer and Drew Suarez uh if everyone could please make",
    "start": "38640",
    "end": "45079"
  },
  {
    "text": "sure you silence your cell phone and enjoy the session thank",
    "start": "45079",
    "end": "51039"
  },
  {
    "text": "you hey good afternoon thank you everybody for coming to our talk about forisk encryption and the realities on",
    "start": "51039",
    "end": "56559"
  },
  {
    "text": "Secure Storage and mobile devices I'm Daniel um I'm a princip security consultant with NCC group formerly m",
    "start": "56559",
    "end": "63199"
  },
  {
    "text": "security um we are a security consultancy and we also do software software um escro and domain Services",
    "start": "63199",
    "end": "70360"
  },
  {
    "text": "among like a number of other services um our headquarters are in the UK but we have a bunch of offices around the US um",
    "start": "70360",
    "end": "77840"
  },
  {
    "text": "I'm more of an iOS kind of guy so the sections will be I will be talking about will be more on iOS I've developed this",
    "start": "77840",
    "end": "83400"
  },
  {
    "text": "um pen testing tool called idb maybe some of you have heard of it uh I'm Drew Warz um also a security",
    "start": "83400",
    "end": "89920"
  },
  {
    "text": "consultant with the NCC group I'm also a member of the open source wing of the S engine mod project um helping bring up",
    "start": "89920",
    "end": "96960"
  },
  {
    "text": "new devices and also writing the building and exploit documentation for the wiki for",
    "start": "96960",
    "end": "102960"
  },
  {
    "text": "them right before we get started a brief outline here introduction will be um giving some background on what are the",
    "start": "102960",
    "end": "109000"
  },
  {
    "start": "103000",
    "end": "135000"
  },
  {
    "text": "challenges in mobile devices compared to like traditional client service settings to secure data then we will talk in",
    "start": "109000",
    "end": "114119"
  },
  {
    "text": "depth about which mechanisms iOS provides for that and then do a similar thing for Android and talk about the challenges there with which are more",
    "start": "114119",
    "end": "120320"
  },
  {
    "text": "particular and show you also um a new teack in a way we have come up with to bypass full dis encryption um on on some",
    "start": "120320",
    "end": "127000"
  },
  {
    "text": "Android devices and then we will summarize this and try to give an Outlook what we see where the challenges are in the industry and what we would",
    "start": "127000",
    "end": "133239"
  },
  {
    "text": "like like to happen in the future so what makes mobile special so if you have a traditional client server",
    "start": "133239",
    "end": "139480"
  },
  {
    "start": "135000",
    "end": "164000"
  },
  {
    "text": "setting all the data is stored on a server and you can enforce tight controls on it you can have your have users logging in and you have",
    "start": "139480",
    "end": "145519"
  },
  {
    "text": "authentication and things like that but if you have a mobile device it turns out that most users are not using the device",
    "start": "145519",
    "end": "151239"
  },
  {
    "text": "via or accessing data via the Safari or any kind of embedded browser what they actually do is they use mostly apps on",
    "start": "151239",
    "end": "157319"
  },
  {
    "text": "the device and those apps um are storing data locally on the device and it's much harder to access or to secure that data",
    "start": "157319",
    "end": "164400"
  },
  {
    "start": "164000",
    "end": "179000"
  },
  {
    "text": "rather and why is that a problem well if you look at these statistics here in the US in 2013 alone there were 1.4 million",
    "start": "164400",
    "end": "171080"
  },
  {
    "text": "phones lost and 3.1 million phones stolen so there is definitely a need to secure this data which is stored on the",
    "start": "171080",
    "end": "176959"
  },
  {
    "text": "device to protect it in these kind of circumstances but at the same time we need data on the",
    "start": "176959",
    "end": "182680"
  },
  {
    "start": "179000",
    "end": "196000"
  },
  {
    "text": "device we cannot just prevent users from storing something there so we have this AC accessibility problem of having data",
    "start": "182680",
    "end": "189319"
  },
  {
    "text": "on the device and needing to protect it and this can be data or it can be usernames and passwords or any kind of other credentials on the",
    "start": "189319",
    "end": "195879"
  },
  {
    "text": "device and then on top of all that we have to reconcile those two concepts while still making it usable so if you",
    "start": "195879",
    "end": "202920"
  },
  {
    "start": "196000",
    "end": "215000"
  },
  {
    "text": "build a secure system where nobody can get to the data or users are hindered by it they will either not use it or will just try to bypass all the controls and",
    "start": "202920",
    "end": "209920"
  },
  {
    "text": "they will think whatever we imposing on them is just as random as what's on this comic",
    "start": "209920",
    "end": "215840"
  },
  {
    "start": "215000",
    "end": "228000"
  },
  {
    "text": "here all right thanks so I think it goes without saying there's no such thing as absolute security but it helps to look",
    "start": "215840",
    "end": "221959"
  },
  {
    "text": "at who you're concerned about with the data on your device and and what data you want to",
    "start": "221959",
    "end": "227680"
  },
  {
    "text": "protect so there's things like remote attackers somebody who is trying to remotely access your device um the",
    "start": "227680",
    "end": "234560"
  },
  {
    "start": "233000",
    "end": "243000"
  },
  {
    "text": "coffee shop attacker which is somebody who sets up in Rogue AP in a in a public place trying to get connections or",
    "start": "234560",
    "end": "240799"
  },
  {
    "text": "perhaps they've hacked a public Wi-Fi there's your casual Thief who really doesn't care too much about the data on",
    "start": "240799",
    "end": "246959"
  },
  {
    "start": "243000",
    "end": "250000"
  },
  {
    "text": "your device they just want to flip the hardware and make a quick Buck then there's the more targeted attacks um",
    "start": "246959",
    "end": "253079"
  },
  {
    "start": "250000",
    "end": "264000"
  },
  {
    "text": "somebody who's specifically coming directly for you for what a particular reason and then we have um nation states",
    "start": "253079",
    "end": "259759"
  },
  {
    "text": "who have a lot more time money and resources to dedicate to something like that so if we plot those out on a graph",
    "start": "259759",
    "end": "266520"
  },
  {
    "start": "264000",
    "end": "287000"
  },
  {
    "text": "of the sophistication of the attack and the effort involved we can kind of place",
    "start": "266520",
    "end": "272280"
  },
  {
    "text": "the things we just talked about with um you know the Casual Thief being very unsophisticated and and requiring very",
    "start": "272280",
    "end": "277880"
  },
  {
    "text": "little effort to snatch something from you all the way up to the nation state which would require more sophistication",
    "start": "277880",
    "end": "284080"
  },
  {
    "text": "more effort on their part so Daniel's gonna talk a little bit about mobile",
    "start": "284080",
    "end": "289320"
  },
  {
    "start": "287000",
    "end": "296000"
  },
  {
    "text": "data security actually I'm going to hand that over to Daniel right so mobile data",
    "start": "289320",
    "end": "296039"
  },
  {
    "start": "296000",
    "end": "336000"
  },
  {
    "text": "security one word first because this is kind of what always comes up with people think about mobile devices full disc",
    "start": "296039",
    "end": "301880"
  },
  {
    "text": "encryption everybody says oh yeah Android has full disc encryption iOS has so our data is secure on there um so the",
    "start": "301880",
    "end": "307520"
  },
  {
    "text": "one thing to keep in mind it encrypts and decrypts data transparently for you whenever the device is turned on so you",
    "start": "307520",
    "end": "312759"
  },
  {
    "text": "don't get any protection when the device is actually running so the only way to protect it would be to have the device",
    "start": "312759",
    "end": "318240"
  },
  {
    "text": "turned off all the times and while there may be scenarios where you purposefully turn your device off to protect it at that point this may not be sufficient",
    "start": "318240",
    "end": "325680"
  },
  {
    "text": "you need more F gr control in the way that we want to have our devices on and still be able to protect data so we need",
    "start": "325680",
    "end": "331479"
  },
  {
    "text": "some more F grain control to control access better than device on and device off and with that let's look at um what",
    "start": "331479",
    "end": "338600"
  },
  {
    "start": "336000",
    "end": "433000"
  },
  {
    "text": "kind of facilities iOS has for that so the first distinct Advantage it has um",
    "start": "338600",
    "end": "344600"
  },
  {
    "text": "over Android as well as to some extent Microsoft is that they produce the",
    "start": "344600",
    "end": "349639"
  },
  {
    "text": "hardware and the software so they can build Hardware features and have good software support for them and they can build Hardware support for certain",
    "start": "349639",
    "end": "355479"
  },
  {
    "text": "software features and that allows them to start um Security on the device",
    "start": "355479",
    "end": "360919"
  },
  {
    "text": "really from the boot so we have a ROM which has a CA in there and we can verify that the boot loader the kernel",
    "start": "360919",
    "end": "367039"
  },
  {
    "text": "and everything following there is actually signed by that by that CA and we know that it's trusted and hasn't",
    "start": "367039",
    "end": "373080"
  },
  {
    "text": "been modified by an attacker then moreover once you look at the operating system itself all updates have sent by",
    "start": "373080",
    "end": "378599"
  },
  {
    "text": "Apple as well so if you install a new um update for iOS you have the guarantee",
    "start": "378599",
    "end": "384000"
  },
  {
    "text": "that it's an authentic product and it would not run otherwise on the device similarly there's um no down",
    "start": "384000",
    "end": "389599"
  },
  {
    "text": "right allowed this um whatever reason it may have why this is um implemented but the the good thing is that if you have a",
    "start": "389599",
    "end": "395800"
  },
  {
    "text": "security patch through an update you cannot revert from that so you cannot get less protected basically than the latest",
    "start": "395800",
    "end": "401240"
  },
  {
    "text": "release and lastly we have app signing which is dealing with anything running on the on the operating system and all",
    "start": "401240",
    "end": "407319"
  },
  {
    "text": "apps have to be signed by by Apple when you download from the App Store it is signed by some certificate signed by",
    "start": "407319",
    "end": "412960"
  },
  {
    "text": "Apple and that actually goes all the way down to the code level so if you run code every code piece is checked when",
    "start": "412960",
    "end": "418879"
  },
  {
    "text": "it's being executed and then finally if you jailbreak your device which is um fairly common to the",
    "start": "418879",
    "end": "424120"
  },
  {
    "text": "research community at least you lose a lot of these protections so from a securing yourself standpoint it's not",
    "start": "424120",
    "end": "429639"
  },
  {
    "text": "really recommendable to to break your device and we'll talk about that in a bit so let's talk about how we Implement",
    "start": "429639",
    "end": "435560"
  },
  {
    "start": "433000",
    "end": "480000"
  },
  {
    "text": "encryption using using this um platform the first thing is in order to protect something on the device if somebody",
    "start": "435560",
    "end": "441479"
  },
  {
    "text": "steals it from you we have to have something which is not on the device because if somebody gets it they can just read anything off the device and if",
    "start": "441479",
    "end": "447720"
  },
  {
    "text": "there would be an encryption key which we're using they could just read the encryption key and decrypt any data so that is where the device passcode comes",
    "start": "447720",
    "end": "453960"
  },
  {
    "text": "in so whenever you type in your passcode on an iOS device it will use pbkdf2 to derive a encryption key from that and",
    "start": "453960",
    "end": "460319"
  },
  {
    "text": "use that to wrap data which you choose to protect under this class and then the key is being vied every time you lock",
    "start": "460319",
    "end": "465840"
  },
  {
    "text": "the device so while the device is locked this data is not accessible but the problem is that a lot of Studies have shown users are really bad at choosing",
    "start": "465840",
    "end": "472360"
  },
  {
    "text": "strong passcodes because it hinders the usability and M does copy the data off the device and then perform an off",
    "start": "472360",
    "end": "478400"
  },
  {
    "text": "offline root Force attack so for that to prevent that we um would need to have some sort of tie into the",
    "start": "478400",
    "end": "483879"
  },
  {
    "start": "480000",
    "end": "513000"
  },
  {
    "text": "hardware or some Hardware root of trust so on iOS um devices we have the secure Enclave which is holding the encryption",
    "start": "483879",
    "end": "490360"
  },
  {
    "text": "keys inside of it and we can only ask it to perform a decryption operation for us giving additional passcode information",
    "start": "490360",
    "end": "497120"
  },
  {
    "text": "but we cannot read that key of the device so if somebody were to Brute Force something they will never get that piece of the key so they would need to",
    "start": "497120",
    "end": "503560"
  },
  {
    "text": "run that attack on the device which is much slower so we can enforce Brute Force controls and we can also wipe data",
    "start": "503560",
    "end": "509000"
  },
  {
    "text": "from the device if there's um too many failed attempts so let's see how this um",
    "start": "509000",
    "end": "514760"
  },
  {
    "start": "513000",
    "end": "567000"
  },
  {
    "text": "incorporates into the general structure on how data or files are encrypted on iOS so this graph starts off here in the",
    "start": "514760",
    "end": "520760"
  },
  {
    "text": "lower right you see um the file which is protected and every file has a file key which is um associated with it and it's",
    "start": "520760",
    "end": "526320"
  },
  {
    "text": "just St it on the file system and then we tie this into the hardware by having the hardware key from which we with",
    "start": "526320",
    "end": "531959"
  },
  {
    "text": "which we protect the so- called file system key which then protects the file key so with that we basically tie this",
    "start": "531959",
    "end": "538200"
  },
  {
    "text": "file to the device so any decryption operation with that file has to happen on the device but the problem is if you steal the device or get physical access",
    "start": "538200",
    "end": "544920"
  },
  {
    "text": "to it you can still simply perform that operation on the device in order to prevent that we then have the passcode",
    "start": "544920",
    "end": "551120"
  },
  {
    "text": "as I already mentioned and the passcode is used to derive another key and then that key is combined with the hardware",
    "start": "551120",
    "end": "556720"
  },
  {
    "text": "key in some manner to derive so-called class Keys which I will talk about in a second and then those together with the file system key are used to wrap that",
    "start": "556720",
    "end": "563160"
  },
  {
    "text": "file key which you see in the lower rate you may wonder why we even need the file system key in that case um the good",
    "start": "563160",
    "end": "569120"
  },
  {
    "start": "567000",
    "end": "579000"
  },
  {
    "text": "thing about this is if you want to remotely wipe your device or you want to delete the data on it you can just",
    "start": "569120",
    "end": "574200"
  },
  {
    "text": "delete that key and no data on the file system will be accessible anymore so let's look at the class Keys",
    "start": "574200",
    "end": "581200"
  },
  {
    "start": "579000",
    "end": "627000"
  },
  {
    "text": "the goal for the for this whole mechanism was to have more fine gr control over your over your data so if",
    "start": "581200",
    "end": "586600"
  },
  {
    "text": "we split these up we have ns5 protection none which is only tied into the",
    "start": "586600",
    "end": "592680"
  },
  {
    "text": "hardware key and then we have the other two which are also tied into the passcode so if you use the one which is",
    "start": "592680",
    "end": "599000"
  },
  {
    "text": "called NS file protection complete until first user authentication files will be protected until from the time you turn",
    "start": "599000",
    "end": "605399"
  },
  {
    "text": "on your device until the first the first time the user unlocks the device and then it will be accessible from then on",
    "start": "605399",
    "end": "610560"
  },
  {
    "text": "forth that's very similar to how full disc encryption on Android or Linux works the other one um the protection",
    "start": "610560",
    "end": "616600"
  },
  {
    "text": "class complete ties in fully with a passcode and the key will be wiped whenever you lock the device so that kind of sums up the the",
    "start": "616600",
    "end": "623480"
  },
  {
    "text": "brief overview of like the different functionality you have available to protect files in iOS the other facility",
    "start": "623480",
    "end": "629000"
  },
  {
    "start": "627000",
    "end": "710000"
  },
  {
    "text": "which is there is IR the iros keychain and that's internally it's just a SQL light database which livs on the file",
    "start": "629000",
    "end": "634959"
  },
  {
    "text": "system and in there we have different entries which are protected using different keys so you have each entry in",
    "start": "634959",
    "end": "641600"
  },
  {
    "text": "the in the sqlite database protected using a key which gives you the different guarantees we already talked about it's very similar the main",
    "start": "641600",
    "end": "647800"
  },
  {
    "text": "criticism I have for this is that if you uninstall an application it will not delete the data there's not even a way",
    "start": "647800",
    "end": "653720"
  },
  {
    "text": "to hook the uninstalled process and Lead data so you may uninstall an application which stored something sensitive in",
    "start": "653720",
    "end": "659079"
  },
  {
    "text": "their and a year later somebody can get your phone and the data will still be in the",
    "start": "659079",
    "end": "664120"
  },
  {
    "text": "keychain so as I mentioned the keychain protections are very similar to the ones we talked about for the file system we",
    "start": "664360",
    "end": "670800"
  },
  {
    "text": "have the n n class which is equivalent to keychain accessible always then we have after first unlock which is the",
    "start": "670800",
    "end": "676720"
  },
  {
    "text": "same as I talked about before and then when unlocked the only thing which is different is since iOS 8 there is a new",
    "start": "676720",
    "end": "683839"
  },
  {
    "text": "Option here which is called when passcode set and the common problem which came up is that if you don't control your devices like have an MDM",
    "start": "683839",
    "end": "689839"
  },
  {
    "text": "solution in in corporation you cannot enforce that users have passcode set on the device so if you store data in the",
    "start": "689839",
    "end": "695399"
  },
  {
    "text": "keychain they may actually not be protected properly because the user didn't choose to have a passcode so this if you store data with",
    "start": "695399",
    "end": "701720"
  },
  {
    "text": "when passcode set it will actually only store the data if there is a passcode on the device and it will remove the data",
    "start": "701720",
    "end": "707120"
  },
  {
    "text": "when the user removes the passcode and protects that so you might wonder why we need all",
    "start": "707120",
    "end": "712200"
  },
  {
    "start": "710000",
    "end": "719000"
  },
  {
    "text": "these different classes and this comes back to having this granular control over your data and protecting it for the",
    "start": "712200",
    "end": "718480"
  },
  {
    "text": "right circumstances so there's some data which just needs to be accessible always you want to turn your phone on and you want to be able to",
    "start": "718480",
    "end": "724560"
  },
  {
    "start": "719000",
    "end": "730000"
  },
  {
    "text": "re phone calls you want to be able to receive messages so all keys and data which is related to that needs to be always accessible to the device but",
    "start": "724560",
    "end": "731519"
  },
  {
    "start": "730000",
    "end": "758000"
  },
  {
    "text": "there are other other things like Wireless credentials email credentials and it's acceptable for you to First unlock your device at least once before",
    "start": "731519",
    "end": "738160"
  },
  {
    "text": "you can use those services so we can protect those more and have the user at least type in the passcode once in order",
    "start": "738160",
    "end": "743320"
  },
  {
    "text": "to use them and then finally things like Safari passwords or backup credentials",
    "start": "743320",
    "end": "748360"
  },
  {
    "text": "you will not need when the device is locked because you will not use Safari when the device is locked so you can protect them with a even stronger",
    "start": "748360",
    "end": "754000"
  },
  {
    "text": "protection class and have them only accessible when the device is unlocked so following this line about",
    "start": "754000",
    "end": "761480"
  },
  {
    "start": "758000",
    "end": "809000"
  },
  {
    "text": "usability one important thing is that if you always need to unlock your device in order to to use it you have to type in",
    "start": "761480",
    "end": "767040"
  },
  {
    "text": "the passcode so the touch ID is a feature which was introduced in iOS and I think it has been in the beginning",
    "start": "767040",
    "end": "772079"
  },
  {
    "text": "pretty much misunderstood or misinterpreted because the big news was oh it can be bypassed that's true but",
    "start": "772079",
    "end": "777519"
  },
  {
    "text": "who would how many of you are actually concerned somebody going to a bar and lifting your fingerprint to access your",
    "start": "777519",
    "end": "782560"
  },
  {
    "text": "particular data versus somebody being able to mass compromise people so there's like this trade of between which",
    "start": "782560",
    "end": "787880"
  },
  {
    "text": "attacker you're trying trying to protect against and touch protects against um",
    "start": "787880",
    "end": "793600"
  },
  {
    "text": "protects the passcode basically so you type in the passcode the very first time you start the device it's stored in the in the secure enclave and then it will",
    "start": "793600",
    "end": "800000"
  },
  {
    "text": "only be released whenever the touch ID receives a well fingerprint and then um",
    "start": "800000",
    "end": "805079"
  },
  {
    "text": "the encryption is still based on the passcode itself and besides device unlock it also is",
    "start": "805079",
    "end": "811720"
  },
  {
    "start": "809000",
    "end": "871000"
  },
  {
    "text": "tied into two mechanisms which are exposed to the to the developers the first one is user presence with the keychain and that basically takes the",
    "start": "811720",
    "end": "818720"
  },
  {
    "text": "granular control one step further it's not only when the device is unlocked is that data accessible but it's accessible",
    "start": "818720",
    "end": "823839"
  },
  {
    "text": "whenever you it's protected until you actually try to read it so you try to read a keychain item and you will get a",
    "start": "823839",
    "end": "829440"
  },
  {
    "text": "dialogue popping up say please FP your finger or enter your passcode very similarly local",
    "start": "829440",
    "end": "834519"
  },
  {
    "text": "authentication but this is an OS level API it's not tied into encryption for the keychain and it basically just",
    "start": "834519",
    "end": "840560"
  },
  {
    "text": "allows your application to ask the operating system to say hey is the right person there and if so it will allow you",
    "start": "840560",
    "end": "845759"
  },
  {
    "text": "to will allow the user to um well it will prompt the user and",
    "start": "845759",
    "end": "851920"
  },
  {
    "text": "you've put your fingerprint on it and it will tell the application yes the user was there but if you jbre the device and",
    "start": "851920",
    "end": "858000"
  },
  {
    "text": "you get control over the operating system you can just modify those API calls and can just tell any application",
    "start": "858000",
    "end": "863320"
  },
  {
    "text": "yeah the user was there so the control over with the keychain is significantly stronger than just having an OS level",
    "start": "863320",
    "end": "869120"
  },
  {
    "text": "API for that so with that what does it leave us with security threats for for iOS so the",
    "start": "869120",
    "end": "876040"
  },
  {
    "start": "871000",
    "end": "920000"
  },
  {
    "text": "good thing is that since the stack is pretty pretty protected overall um you need to bypass so some of the existing",
    "start": "876040",
    "end": "882480"
  },
  {
    "text": "controls in order to gain significant access to the device so if you jailbreak a device and you find a flaw which",
    "start": "882480",
    "end": "887880"
  },
  {
    "text": "allows you to bypass signature checking and and jailbreak it you can get access to everything which is not protected",
    "start": "887880",
    "end": "893440"
  },
  {
    "text": "under the passcode because if you the passcode if you don't know that you cannot derive the encryption key for that and you cannot gain gain access to",
    "start": "893440",
    "end": "899759"
  },
  {
    "text": "that data um other things which may be a threat are just malicious applications which are asking for a lot of",
    "start": "899759",
    "end": "905360"
  },
  {
    "text": "permissions and trying to access more of your data than they really should be and then um evil m style attacks which we",
    "start": "905360",
    "end": "911320"
  },
  {
    "text": "will be talking about um in a bit in more detail and they're tying into jailbreaking and modifying some parts of the operating system and we will talk",
    "start": "911320",
    "end": "917920"
  },
  {
    "text": "about that in more detail after the Android section and with that I'm going to hand it off to Drew to talk about how",
    "start": "917920",
    "end": "923480"
  },
  {
    "text": "Android compares to this all right thanks Daniel so let's look at how Android uh approaches these challenges",
    "start": "923480",
    "end": "929680"
  },
  {
    "text": "that we just saw in iOS so this is a helpful graph to see the evolution of the introduction of new",
    "start": "929680",
    "end": "936399"
  },
  {
    "text": "security features into Android and we can see as time has gone on we've gotten more and more advanced things I've",
    "start": "936399",
    "end": "941920"
  },
  {
    "text": "highlighted the ones in blue that pertain specifically to Secure Storage but left the others for um for you to",
    "start": "941920",
    "end": "947319"
  },
  {
    "text": "look at later as well so the ones specific to the to secured data storage",
    "start": "947319",
    "end": "953440"
  },
  {
    "text": "that I find interesting are dmverity uh which is relatively new it was introduced in in Android 4.4 and this",
    "start": "953440",
    "end": "960920"
  },
  {
    "text": "protects the system partition by taking a Shawan hash of each block and then building a tree on that such that if you",
    "start": "960920",
    "end": "967199"
  },
  {
    "text": "need to modify the system partition such that you want like a persistent route it's going to realize that it's broken",
    "start": "967199",
    "end": "973519"
  },
  {
    "text": "at that point and give you a nasty warning when you boot um there's also the trusted execution environment",
    "start": "973519",
    "end": "979639"
  },
  {
    "text": "signing of the key encryption key which I will talk about in more detail later as well as Force encrypt um so Force",
    "start": "979639",
    "end": "985720"
  },
  {
    "text": "encrypt was launched with Android 5.0 in the attempt to enable full dis encryption out of the box um because up",
    "start": "985720",
    "end": "992600"
  },
  {
    "text": "until that point this was a user electable feature so you had to go through a bunch of settings menus and",
    "start": "992600",
    "end": "997880"
  },
  {
    "text": "say Yes I want to encrypt my device and go through like like a half hour uh painful reboot process to enable that",
    "start": "997880",
    "end": "1005240"
  },
  {
    "text": "unfortunately uh one could speculate that Google's OEM Partners weren't quite ready for that so they quietly removed",
    "start": "1005240",
    "end": "1012240"
  },
  {
    "text": "that requirement for lollipop um so really the only devices that launched with Force encrypt were Google's own",
    "start": "1012240",
    "end": "1018560"
  },
  {
    "text": "Nexus line so if we look at the adoption of",
    "start": "1018560",
    "end": "1023600"
  },
  {
    "start": "1020000",
    "end": "1040000"
  },
  {
    "text": "Android as a platform it's pretty easy to see and you know everyone's heard of the fragmentation problem in Android a",
    "start": "1023600",
    "end": "1029839"
  },
  {
    "text": "lot of users are on an older version of the platform at this point the majority of the users um are not using the latest",
    "start": "1029839",
    "end": "1035839"
  },
  {
    "text": "possible version so it's interesting to compare that back to iOS and see that",
    "start": "1035839",
    "end": "1042160"
  },
  {
    "text": "the majority of users are on the latest version and thus have the latest security features available to them so",
    "start": "1042160",
    "end": "1049520"
  },
  {
    "text": "why is this so important um to the ecosystem it has a very large effect on application developers who want to make",
    "start": "1049520",
    "end": "1056600"
  },
  {
    "start": "1050000",
    "end": "1126000"
  },
  {
    "text": "their application run on all versions of the platform but can't guarantee that they have access to the security apis",
    "start": "1056600",
    "end": "1063080"
  },
  {
    "text": "and the features that the newer versions have provided so there's a there's a Code complexity problem in that you need",
    "start": "1063080",
    "end": "1068720"
  },
  {
    "text": "to make decisions based on what version that your application's running on and as we mentioned access to the most",
    "start": "1068720",
    "end": "1075000"
  },
  {
    "text": "secure features is not always available for everyone um and that brings us to like the interesting problem of the OTA",
    "start": "1075000",
    "end": "1082080"
  },
  {
    "text": "process for Android and this is a very complex problem that I'm summarizing very quickly for you but um Google tends",
    "start": "1082080",
    "end": "1088520"
  },
  {
    "text": "to provide these things pretty quickly in in AOSP and the Android open source project but it takes a while for those",
    "start": "1088520",
    "end": "1094960"
  },
  {
    "text": "actually to get out to the end user because oems like to customize Android",
    "start": "1094960",
    "end": "1100360"
  },
  {
    "text": "and have their own brand and so they add on all these new features so when these things come out it goes to the OEM level",
    "start": "1100360",
    "end": "1106600"
  },
  {
    "text": "they make their changes and then another of complexity is that the carriers are involved in this as well so the carriers",
    "start": "1106600",
    "end": "1112600"
  },
  {
    "text": "need to certify the builds they want to add in you know the cool nasar app I guess or whatever to to the ROM so this",
    "start": "1112600",
    "end": "1120080"
  },
  {
    "text": "this makes things slower um in terms of like users actually receiving timely updates to their",
    "start": "1120080",
    "end": "1126159"
  },
  {
    "text": "device so we're going to briefly talk about how the Android encryption system works this is a simplified version and",
    "start": "1126159",
    "end": "1132159"
  },
  {
    "text": "and also of note this is the Google specific version oems tend to make modifications to this but that's sort of",
    "start": "1132159",
    "end": "1138039"
  },
  {
    "text": "outside the scope of what we're going to talk about here so a device encryption key is uh",
    "start": "1138039",
    "end": "1144039"
  },
  {
    "start": "1140000",
    "end": "1177000"
  },
  {
    "text": "generated randomly when you elect to enable uh full full dis encryption this is based on the DM Crypt um the device",
    "start": "1144039",
    "end": "1152039"
  },
  {
    "text": "mapper portion of the Linux kernel it uses AES 128 in CBC mode along with an",
    "start": "1152039",
    "end": "1158080"
  },
  {
    "text": "ESS I shot 256 for each of these sectors and then you encrypt the volume in this",
    "start": "1158080",
    "end": "1164919"
  },
  {
    "text": "fashion um but since this is not drive from the user passcode we need some way",
    "start": "1164919",
    "end": "1170559"
  },
  {
    "text": "to have a passcode on top of that such that if you want to change your passcode you don't have to reencrypt your volume",
    "start": "1170559",
    "end": "1176400"
  },
  {
    "text": "so this problem is solved with What's called the key encryption key and an initialization vector and so the key",
    "start": "1176400",
    "end": "1182520"
  },
  {
    "start": "1177000",
    "end": "1192000"
  },
  {
    "text": "encryption key is derived from a user Supply passcode this wraps the device encryption key and then that is stored",
    "start": "1182520",
    "end": "1189120"
  },
  {
    "text": "encrypted in the crypto footer which I'll get more into later so we can see here the lock screen this can be a pin",
    "start": "1189120",
    "end": "1196120"
  },
  {
    "start": "1192000",
    "end": "1234000"
  },
  {
    "text": "pattern or passcode um in Android 4.3 and below this was handled",
    "start": "1196120",
    "end": "1201280"
  },
  {
    "text": "by pbkdf2 after and including the KitKat release Android 4.4 Google switch to scrypt in",
    "start": "1201280",
    "end": "1208400"
  },
  {
    "text": "an attempt to reduce the uh The Brute Force attacks on the PIN codes and then finally in lollipop uh",
    "start": "1208400",
    "end": "1216440"
  },
  {
    "text": "Google introduced a new feature that allows you to sign the password key with",
    "start": "1216440",
    "end": "1221679"
  },
  {
    "text": "something from The Trusted execution environment that cannot be removed um such that if you want to do some sort of",
    "start": "1221679",
    "end": "1227640"
  },
  {
    "text": "attack on this you're going to need to use the device now and this is this was brand new for for",
    "start": "1227640",
    "end": "1233760"
  },
  {
    "text": "5.0 so referring back to the crypto footer it's it's worth noting that Android's full dis encryption actually",
    "start": "1233760",
    "end": "1240360"
  },
  {
    "start": "1234000",
    "end": "1306000"
  },
  {
    "text": "only protects one partition of the entire flash device and that's the user data partition uh this is where all user",
    "start": "1240360",
    "end": "1246440"
  },
  {
    "text": "settings are stored any any thing you download is is is stored there um the",
    "start": "1246440",
    "end": "1252080"
  },
  {
    "text": "crypto footer which I referred to earlier is usually carved out of this user data partition it's uh 16 kilobytes",
    "start": "1252080",
    "end": "1257520"
  },
  {
    "text": "at the very end of it more modern devices um we're starting to see that there's a dedicated partition",
    "start": "1257520",
    "end": "1263200"
  },
  {
    "text": "for for crypto metadata and as I mentioned the master key or the device key is stored ENC as encrypted by the",
    "start": "1263200",
    "end": "1269960"
  },
  {
    "text": "key encryption key here um if you're familiar with Lux at all it's it's a very similar idea except it has one",
    "start": "1269960",
    "end": "1276320"
  },
  {
    "text": "significant difference in that it it only has one key slot so you're only able to have one key stored um there's a",
    "start": "1276320",
    "end": "1283960"
  },
  {
    "text": "lot of projects that uh require you know heavy customization of of the ROM you're",
    "start": "1283960",
    "end": "1289320"
  },
  {
    "text": "running but that allow you to have a very strong boot decryption password and then also have like a passcode that's a",
    "start": "1289320",
    "end": "1295640"
  },
  {
    "text": "little bit more reasonable so that you you can have the very complex one and the and the more userfriendly one as",
    "start": "1295640",
    "end": "1301320"
  },
  {
    "text": "well but again this is not standard and requires modification to the",
    "start": "1301320",
    "end": "1306480"
  },
  {
    "start": "1306000",
    "end": "1515000"
  },
  {
    "text": "platform so a word on how Android handles credential storage um the system credential store will will hold things",
    "start": "1306480",
    "end": "1312799"
  },
  {
    "text": "like VPN Keys Wi-Fi um asymmetric Keys either from applications or you know",
    "start": "1312799",
    "end": "1318240"
  },
  {
    "text": "your keys if you want um these are encrypted by a key that is derived from the user's",
    "start": "1318240",
    "end": "1324840"
  },
  {
    "text": "passcode and this can be Hardware backed um which is a a new security feature",
    "start": "1324840",
    "end": "1330200"
  },
  {
    "text": "that a lot of devices are shipping with these days that actually lets you store the keys in in Hardware backing such",
    "start": "1330200",
    "end": "1336039"
  },
  {
    "text": "that they can't be removed from the device um so this this adds additional security um for obvious reasons there",
    "start": "1336039",
    "end": "1343000"
  },
  {
    "text": "but there are some issues with the key store um namely the fact that developers can't really rely on the fact that",
    "start": "1343000",
    "end": "1348760"
  },
  {
    "text": "somebody has a hardware back key store so there there are apis available that you can test to see if the system you're",
    "start": "1348760",
    "end": "1354520"
  },
  {
    "text": "running on has one but again it's inconsistent um and there have been a number of issues um that have actually",
    "start": "1354520",
    "end": "1360480"
  },
  {
    "text": "been fixed in lollipop and 5.0 relating to changing the user's password will",
    "start": "1360480",
    "end": "1365720"
  },
  {
    "text": "actually obliterate keys from the key store and sort of erratic Behavior so this is actually luckily improving with",
    "start": "1365720",
    "end": "1371960"
  },
  {
    "text": "M it's it's well documented now there's there's different conditions and um you",
    "start": "1371960",
    "end": "1377679"
  },
  {
    "text": "know we don't have the bug of changing passcodes blowing away key so it's it's an effort to make things more developer",
    "start": "1377679",
    "end": "1386480"
  },
  {
    "text": "friendly so let's talk about Google and their OEM Partners here um the biggest",
    "start": "1386480",
    "end": "1391840"
  },
  {
    "text": "issue here is the wild inconsistency and how many people make Android devices um one of the great things about Android is",
    "start": "1391840",
    "end": "1398640"
  },
  {
    "text": "that you can run on a very budget device or the current Flagship and everything in between so it's it's a very",
    "start": "1398640",
    "end": "1404600"
  },
  {
    "text": "accessible platform but with that comes the downsides that you don't have all of the security guarantees across the",
    "start": "1404600",
    "end": "1411640"
  },
  {
    "text": "devices um so there's things like bootloader security is is wildly different um Hardware back crypto",
    "start": "1411640",
    "end": "1418320"
  },
  {
    "text": "storage we just talked about the availability of a trusted execution environment or a trust Zone component",
    "start": "1418320",
    "end": "1424559"
  },
  {
    "text": "and even the boot image type varies by device so it it's a very complex",
    "start": "1424559",
    "end": "1429600"
  },
  {
    "text": "system and with different oems as I said comes different security precautions or protections I should say so a lot of",
    "start": "1429600",
    "end": "1436640"
  },
  {
    "text": "devices have an emmc right protection layer so even if you are able to root the the main system you're not able to",
    "start": "1436640",
    "end": "1443720"
  },
  {
    "text": "overwrite certain partitions because it'll just discard them at that level um we also have things like the boot image",
    "start": "1443720",
    "end": "1451400"
  },
  {
    "text": "signature verification so a lot of devices will verify that the the boot image is signed properly but a lot of",
    "start": "1451400",
    "end": "1457720"
  },
  {
    "text": "them also won't as we'll see coming up and then there's also the different types of boot loaders so there's locked",
    "start": "1457720",
    "end": "1463840"
  },
  {
    "text": "such that that's it um you're not able to modify that in any way there's locked",
    "start": "1463840",
    "end": "1468919"
  },
  {
    "text": "but unlockable which is becoming more more common from things like uh Sony HTC and the Nexus line obviously and this",
    "start": "1468919",
    "end": "1475960"
  },
  {
    "text": "will allow you to get a a token um either from the developer program or in the case of Nexus just enable the option",
    "start": "1475960",
    "end": "1483200"
  },
  {
    "text": "and then use fast boot to unlock your device and these will responsibly erase the user data partition like you would",
    "start": "1483200",
    "end": "1489279"
  },
  {
    "text": "expect so it's a difficult problem to solve because it's challenging for Google to enforce standards um on their",
    "start": "1489279",
    "end": "1496399"
  },
  {
    "text": "OEM partners because they want to have their own devices they want to do things their own way and as Daniel mentioned",
    "start": "1496399",
    "end": "1503320"
  },
  {
    "text": "earlier apple has a distinct Advantage here because they control the entire stack from the hardware to the software",
    "start": "1503320",
    "end": "1508559"
  },
  {
    "text": "so they can make this work a lot more cohesively um than than Google",
    "start": "1508559",
    "end": "1514960"
  },
  {
    "text": "can so let's talk about the importance of boot security um which is a central",
    "start": "1514960",
    "end": "1520159"
  },
  {
    "start": "1515000",
    "end": "1577000"
  },
  {
    "text": "point of our discussion here so on the the top left there we have the boot loader which we've marked in green is",
    "start": "1520159",
    "end": "1525840"
  },
  {
    "text": "being secure because there's multiple layers of signing that happen as the different boot loaders hand off to each",
    "start": "1525840",
    "end": "1531039"
  },
  {
    "text": "other if the signing is broken you're pretty much not going to get a boot so we consider that to be well rounded and",
    "start": "1531039",
    "end": "1538480"
  },
  {
    "text": "then all the way at the bottom we have the user data partition as Illustrated um the user has elected to turn on f",
    "start": "1538480",
    "end": "1544360"
  },
  {
    "text": "disk encryption they're protected at this layer but in the middle we have two possible vulnerable places um one with",
    "start": "1544360",
    "end": "1551039"
  },
  {
    "text": "the kernel itself as I mentioned if there's a lack of boot um signing verification you can in a lot of cases",
    "start": "1551039",
    "end": "1557880"
  },
  {
    "text": "over this with something that you control and similarly the system partition which is where the main",
    "start": "1557880",
    "end": "1563120"
  },
  {
    "text": "operating system lives is not encrypted so in in cases where there's no dmverity",
    "start": "1563120",
    "end": "1568200"
  },
  {
    "text": "which is really not shipping on any devices at this moment you can modify the system and make changes at that",
    "start": "1568200",
    "end": "1575399"
  },
  {
    "text": "level so I want to show a few examples of that let's talk first about download mode um or Odin mode this is a Samsung",
    "start": "1575399",
    "end": "1583399"
  },
  {
    "start": "1577000",
    "end": "1645000"
  },
  {
    "text": "specific bootloader interface that ships on all of their devices it's",
    "start": "1583399",
    "end": "1588760"
  },
  {
    "text": "uh internally Samsung uses a tool called Odin to interact with this and it allows you to arbitrarily write images to the",
    "start": "1588760",
    "end": "1596320"
  },
  {
    "text": "different partitions on the flash and if you're interested in this I would I would definitely recommend Heim doll um",
    "start": "1596320",
    "end": "1602399"
  },
  {
    "text": "this is a written by a guy called Ben doble from Australia and he's sort of reversed how Odin worked and made a",
    "start": "1602399",
    "end": "1608240"
  },
  {
    "text": "crossplatform open source version of this tool that you can use but based on what I said it's clear that this is",
    "start": "1608240",
    "end": "1614559"
  },
  {
    "text": "overly permissive a user should not be able to arbitrarily overwrite certain parts of their device with with user",
    "start": "1614559",
    "end": "1620559"
  },
  {
    "text": "controlled content and most of the devices they ship are um have this issue",
    "start": "1620559",
    "end": "1625760"
  },
  {
    "text": "so outside of a few very select us carrier models um most notably on",
    "start": "1625760",
    "end": "1631159"
  },
  {
    "text": "Verizon or now on AT&T as well which do check this the image signatures uh all",
    "start": "1631159",
    "end": "1637720"
  },
  {
    "text": "of the international devices and all the other ones um have the ability to be interfaced with in download",
    "start": "1637720",
    "end": "1644520"
  },
  {
    "start": "1645000",
    "end": "1702000"
  },
  {
    "text": "mode little kernel is a boot loader found on many Qualcomm devices but even",
    "start": "1645600",
    "end": "1651000"
  },
  {
    "text": "something that has open auditing has issues uh so there's a couple cbes related to this that would allow us to",
    "start": "1651000",
    "end": "1657559"
  },
  {
    "text": "bypass image verification this first one uh they forgot to actually check the signature in a build that came out so",
    "start": "1657559",
    "end": "1664279"
  },
  {
    "text": "there's quite a few devices that let you just fast boot boot your own image directly and then from there you can do",
    "start": "1664279",
    "end": "1670240"
  },
  {
    "text": "all sorts of fun things um the next one is a little bit more complex but you can forge signatures and this uses RSA cube",
    "start": "1670240",
    "end": "1677320"
  },
  {
    "text": "root attack I would definitely recommend reading that cve for the details on that one it's a little complex and the last",
    "start": "1677320",
    "end": "1684559"
  },
  {
    "text": "one is is relatively new um when when updates are flashed with fast boot for system it's typically a sparse bundle",
    "start": "1684559",
    "end": "1691000"
  },
  {
    "text": "they did not check the end of the bounds of where that sparse bundle ended so people figured out it was possible to",
    "start": "1691000",
    "end": "1696600"
  },
  {
    "text": "write past that boundary and and uh potentially overwrite different parts of the internal",
    "start": "1696600",
    "end": "1702120"
  },
  {
    "start": "1702000",
    "end": "1765000"
  },
  {
    "text": "memory and lastly laugh uh which is properly titled because this is a hilarious back door that's found on a",
    "start": "1702120",
    "end": "1708640"
  },
  {
    "text": "lot of LG devices um you put it into a special mode similar to Samsung's",
    "start": "1708640",
    "end": "1714480"
  },
  {
    "text": "download mode and then you use a a binary called send command and it takes one argument and that is the comport of",
    "start": "1714480",
    "end": "1721360"
  },
  {
    "text": "the of what your device is plugged into and once you issue that command you are dropped into a root shell and from there",
    "start": "1721360",
    "end": "1727960"
  },
  {
    "text": "you can do all sorts of interesting things as well the unfortunate thing is that LG",
    "start": "1727960",
    "end": "1733399"
  },
  {
    "text": "realized that this is probably not a great idea and they tried to fix it but their fixes rather in complete and so",
    "start": "1733399",
    "end": "1739840"
  },
  {
    "text": "they decided to protect individual partitions um like block P1 P2 P3 but",
    "start": "1739840",
    "end": "1746240"
  },
  {
    "text": "block zero the root of that is not protected so you can use DD and seek and",
    "start": "1746240",
    "end": "1751279"
  },
  {
    "text": "some clever offsets and actually overwrite the same partitions you were able to before so users are able to",
    "start": "1751279",
    "end": "1757799"
  },
  {
    "text": "impact the boot image here as well and this was actually shipped on the Nexus 5 as",
    "start": "1757799",
    "end": "1765120"
  },
  {
    "start": "1765000",
    "end": "1826000"
  },
  {
    "text": "well so let's revisit the idea that Daniel brought up earlier that full dis encryption protects when the device is",
    "start": "1765120",
    "end": "1771440"
  },
  {
    "text": "turned off um we are going to demonstrate that that's not always true",
    "start": "1771440",
    "end": "1777440"
  },
  {
    "text": "and in typical infosec fashion in the last few years uh there's needs to be a cutesy logo and and title for this so",
    "start": "1777440",
    "end": "1784559"
  },
  {
    "text": "we're calling our PC Rosie the uh evil Android evil made and in this scenario we are",
    "start": "1784559",
    "end": "1791679"
  },
  {
    "text": "exploiting permissive boot loaders so we flash a custom boot image that we've back doored",
    "start": "1791679",
    "end": "1798519"
  },
  {
    "text": "and this can happen in under two minutes including multiple reboots we give this device back to the user they log in with",
    "start": "1798519",
    "end": "1806440"
  },
  {
    "text": "their encryption code and this becomes active we have profit here so you can do",
    "start": "1806440",
    "end": "1812440"
  },
  {
    "text": "things like hook kernel cryptographic functions and grab the encryption key that way you can exfiltrate data",
    "start": "1812440",
    "end": "1818159"
  },
  {
    "text": "straight off the device which we chose to do and you or you know shells anything you want you have kernel level",
    "start": "1818159",
    "end": "1824799"
  },
  {
    "text": "access at this point so we're going to talk a little bit about how we test it and devis this this idea so the first",
    "start": "1824799",
    "end": "1832000"
  },
  {
    "text": "step is to put your device into its permissive bootloader State then we use",
    "start": "1832000",
    "end": "1837360"
  },
  {
    "text": "the tool we referenced earlier to flash our own um custom recovery image and",
    "start": "1837360",
    "end": "1842880"
  },
  {
    "text": "that's sort of outside the scope of this but I've done a lot of Prior research on recovery so I I recommend if you're",
    "start": "1842880",
    "end": "1848080"
  },
  {
    "text": "interested in in what that is you you can reference that and learn on your own but basically a custom recovery provides",
    "start": "1848080",
    "end": "1854840"
  },
  {
    "text": "a nice test harness it's uh it gives you a root shell you have access to all the unencrypted partitions as root so you",
    "start": "1854840",
    "end": "1861240"
  },
  {
    "text": "can mount file systems and make changes that way but it it also is a very handy platform for backing up essential",
    "start": "1861240",
    "end": "1866840"
  },
  {
    "text": "firmware and also for flashing your own firmware and getting to a place where if you write something that doesn't boot",
    "start": "1866840",
    "end": "1873240"
  },
  {
    "text": "you can come back to recovery fix it and then you're good to go so I'm going to hand it over to Daniel to talk a little",
    "start": "1873240",
    "end": "1879320"
  },
  {
    "text": "bit about the next section so we made our own um kernel first of all to get it back doored",
    "start": "1879320",
    "end": "1886000"
  },
  {
    "start": "1881000",
    "end": "1911000"
  },
  {
    "text": "luckily um all kernels which you get for Android devices from the OM are open source because the license requires them",
    "start": "1886000",
    "end": "1891799"
  },
  {
    "text": "to make them open source so you can just go to any om and you can download this conal source code and then we added a",
    "start": "1891799",
    "end": "1898159"
  },
  {
    "text": "Col colel module which was our back door which is just opening up a UDP connection to a Ser we control and x",
    "start": "1898159",
    "end": "1903919"
  },
  {
    "text": "filtrates a file from the device and obviously we added this to menu config so that you can conveniently add our",
    "start": "1903919",
    "end": "1909519"
  },
  {
    "text": "back door here and then for testing purposes um all you need to do is you compile the",
    "start": "1909519",
    "end": "1915200"
  },
  {
    "text": "kernel you create a boot image which just takes a second or so and then we can boot into recovery and Flash the um",
    "start": "1915200",
    "end": "1921399"
  },
  {
    "text": "boot image on the device reboot and try it out and if it doesn't work we just you know rinse and repeat until we had",
    "start": "1921399",
    "end": "1927080"
  },
  {
    "text": "our final version which was the boot image which is back doored and we knew was working properly and then we don't",
    "start": "1927080",
    "end": "1932559"
  },
  {
    "text": "need all these steps which we just talked about and we show you in the next video um what it takes to actually then",
    "start": "1932559",
    "end": "1937840"
  },
  {
    "text": "just attack a device and how much or how little access you need all right so here we're starting",
    "start": "1937840",
    "end": "1944639"
  },
  {
    "start": "1941000",
    "end": "2080000"
  },
  {
    "text": "with the it's playing now okay here we're starting with the device on uh",
    "start": "1944639",
    "end": "1949799"
  },
  {
    "text": "this is not a requirement as you'll see coming up but just for demonstration sake we're turning the device off at",
    "start": "1949799",
    "end": "1957000"
  },
  {
    "text": "this point we're going to start a counter for when the device is off and because the the interesting scenario here is that you think you're protected",
    "start": "1957000",
    "end": "1962919"
  },
  {
    "text": "when this is off so we're going to boot into our permissive boot loader accept the warning that custom operating",
    "start": "1962919",
    "end": "1968760"
  },
  {
    "text": "systems can cause problems obviously um we're going to connect the device via USB and then Daniel is going to flash",
    "start": "1968760",
    "end": "1975519"
  },
  {
    "text": "our back door kernel to the device and you'll notice very very quickly how fast this runs and in just about under 23",
    "start": "1975519",
    "end": "1983120"
  },
  {
    "text": "seconds that's it the back door is active now the phone is booting it's",
    "start": "1983120",
    "end": "1988320"
  },
  {
    "text": "active and Daniel will talk about what happens next when this boots up here",
    "start": "1988320",
    "end": "1993519"
  },
  {
    "text": "right so in our scenario here the device basically was off and we just put it back where it was and the user just",
    "start": "1993519",
    "end": "1999279"
  },
  {
    "text": "picks it up again and starts using it so the next time the user boots it up they will just get the regular password screen where they need to enter their",
    "start": "1999279",
    "end": "2005679"
  },
  {
    "text": "passcode so this is where we at right now and in the meantime on the right side you see the the console we have open",
    "start": "2005679",
    "end": "2011639"
  },
  {
    "text": "running on our server which is does a random um digital ocean droplet somewhere on the internet listening via",
    "start": "2011639",
    "end": "2017519"
  },
  {
    "text": "net cut just keeping it simple and once the user unlocks it and the device takes a while to process we will see that we",
    "start": "2017519",
    "end": "2023760"
  },
  {
    "text": "can receive the data there yeah when you use your own kernel",
    "start": "2023760",
    "end": "2030080"
  },
  {
    "text": "you lose a lot of the hardware acceleration so it takes a little while for the the decryption process to happen",
    "start": "2030080",
    "end": "2037600"
  },
  {
    "text": "so as soon as the unlock happens the data gets stumped over",
    "start": "2039320",
    "end": "2044840"
  },
  {
    "text": "there and then um we can verify that we actually got the right file it's a we've got the account SQL light database from",
    "start": "2045080",
    "end": "2051000"
  },
  {
    "text": "the device because it has at least some sensitive data in it and it's actually not readable by the regular User it's",
    "start": "2051000",
    "end": "2056878"
  },
  {
    "text": "protected so um we can open it we can make some queries in there and see what we have and then um this the last part",
    "start": "2056879",
    "end": "2064000"
  },
  {
    "text": "here just adbs into the ADB shell on the device and trying to act access that file directly and you can see that",
    "start": "2064000",
    "end": "2070240"
  },
  {
    "text": "there's access denied so a regular user even on the device couldn't get it so that kind of proves that we're running",
    "start": "2070240",
    "end": "2075398"
  },
  {
    "text": "with something which is like kernel level",
    "start": "2075399",
    "end": "2079359"
  },
  {
    "text": "access so this is um as Drew already illustrated by giving the three examples of the three examples of the different",
    "start": "2086240",
    "end": "2093320"
  },
  {
    "text": "bootloaders which have been vulnerable in the past this is possible on a number of om devices and but it's not really a",
    "start": "2093320",
    "end": "2098680"
  },
  {
    "text": "new problem this is known that you can do this for a while and people use it for all kind of purposes and it's also not new that you can do backdooring",
    "start": "2098680",
    "end": "2105200"
  },
  {
    "text": "kernels and evil M attacks and things like that but we feel like it's important to point out that there is",
    "start": "2105200",
    "end": "2110359"
  },
  {
    "text": "actually a security implication of having permissive boot loaders and that if you rely on full disc encryption and you you don't fully protect the stack",
    "start": "2110359",
    "end": "2117480"
  },
  {
    "text": "along the way then you basically lose that guarantee which you're hoping full disc encryption can give you granted this requires physical access but it is",
    "start": "2117480",
    "end": "2123920"
  },
  {
    "text": "still still a flaw because people assume when it's off it's secure and then lastly we should talk about",
    "start": "2123920",
    "end": "2130520"
  },
  {
    "text": "that um Google also actually has provided mechanisms to prevent this so if there is facilities there which have",
    "start": "2130520",
    "end": "2136680"
  },
  {
    "text": "signature verification along the way there is the DM Varity support in principle so we can protect those things properly it's just not implemented",
    "start": "2136680",
    "end": "2143359"
  },
  {
    "text": "widely yet and hopefully this will give people some some uh idea that there may be",
    "start": "2143359",
    "end": "2150079"
  },
  {
    "text": "actually need for doing so in the future so for iOS the last Point here is um",
    "start": "2150079",
    "end": "2155359"
  },
  {
    "text": "this exploited a boot loader which is just permissive I default if you're able to jailbreak an iOS device you can do",
    "start": "2155359",
    "end": "2160440"
  },
  {
    "text": "obviously similar things you can back door an application and you can just obtain any data or you can just back door the colel and you can exploit rate",
    "start": "2160440",
    "end": "2166079"
  },
  {
    "text": "data that way so this is not particularly an Android thing but this the attack is just particularly simple",
    "start": "2166079",
    "end": "2172000"
  },
  {
    "text": "for these kind of devices all right thanks Daniel so this",
    "start": "2172000",
    "end": "2177160"
  },
  {
    "start": "2173000",
    "end": "2297000"
  },
  {
    "text": "is the slide we've dubbed to Drew soap boox um so I'm an Android Enthusiast",
    "start": "2177160",
    "end": "2183240"
  },
  {
    "text": "I've been doing custom Android for a while thanks um worked on a lot of",
    "start": "2183240",
    "end": "2188280"
  },
  {
    "text": "devices and and the platform's great and it's open and you can create custom things that are useful for you but these",
    "start": "2188280",
    "end": "2195200"
  },
  {
    "text": "things should be secured by default out of the box you should have security guarantees and so it would be really",
    "start": "2195200",
    "end": "2201200"
  },
  {
    "text": "helpful if oems picked up on that and started to secure these things by default and in the example we just",
    "start": "2201200",
    "end": "2207319"
  },
  {
    "text": "showed just verifying the boot image is not not going to solve the problem because you're just locking somebody out",
    "start": "2207319",
    "end": "2212880"
  },
  {
    "text": "of the device that they purchased and want to do legitimate modifications to",
    "start": "2212880",
    "end": "2217920"
  },
  {
    "text": "and so we get into a scenario where more dangerous exploits have to be designed in order to gain that access back if",
    "start": "2217920",
    "end": "2223680"
  },
  {
    "text": "you're just going to lock the door behind you which brings us into um responsible boet unlocks this is already",
    "start": "2223680",
    "end": "2230720"
  },
  {
    "text": "happening on a lot of oems unfortunately some carriers block this entirely uh like Verizon and you know this will",
    "start": "2230720",
    "end": "2239000"
  },
  {
    "text": "responsibly erase the user data so if somebody comes across your device and wants to unlock it they're going to blow",
    "start": "2239000",
    "end": "2244720"
  },
  {
    "text": "away what they're after right if they're if they're have an evil mindset so having this responsible unlock is is a",
    "start": "2244720",
    "end": "2251599"
  },
  {
    "text": "good solution um make the user agree to some conditions and then blow the data away and I think we also want to see",
    "start": "2251599",
    "end": "2258680"
  },
  {
    "text": "some very clearly documented guidelines of what's protected because every device seems to have like totally different",
    "start": "2258680",
    "end": "2264839"
  },
  {
    "text": "random things that they're protecting there's no consistency and lastly consistency among Google's o and",
    "start": "2264839",
    "end": "2271480"
  },
  {
    "text": "partners would really help the ecosystem here let's decide on one cohesive bootloader Solution that's audited by",
    "start": "2271480",
    "end": "2278079"
  },
  {
    "text": "all parties that isn't private and closed off and only looked at by a few people and I think we can solve a lot of",
    "start": "2278079",
    "end": "2284359"
  },
  {
    "text": "these issues that we just showed in our demo here I'm going to hand it back to Daniel to talk about some alternatives to the",
    "start": "2284359",
    "end": "2290760"
  },
  {
    "text": "platform security yes this kind of wraps up the device specific",
    "start": "2290760",
    "end": "2296880"
  },
  {
    "text": "discussion but what do you do if you don't have a passcode set on a device and you can't enforce that you probably",
    "start": "2296880",
    "end": "2302000"
  },
  {
    "start": "2297000",
    "end": "2355000"
  },
  {
    "text": "heard there's a lot of um app container Solutions out there such as good or mobile iron things like that",
    "start": "2302000",
    "end": "2308160"
  },
  {
    "text": "and um they basically implement the same thing we already discussed in this talk they just do it on an app level so they're going to have a lock screen and",
    "start": "2308160",
    "end": "2314520"
  },
  {
    "text": "that lock screen um will use to derive a passcode and then all data in the app's container will be encrypted with that",
    "start": "2314520",
    "end": "2320240"
  },
  {
    "text": "data and then you can wipe the key when you background the app and you basically build the same mechanism as we've seen",
    "start": "2320240",
    "end": "2325280"
  },
  {
    "text": "before the one downside here or the two downsides are is that uh crypto is hard and a lot of things can go wrong and",
    "start": "2325280",
    "end": "2331280"
  },
  {
    "text": "probably most developers should not try to implement things on like with basic Primitives and crypto but use libraries",
    "start": "2331280",
    "end": "2336440"
  },
  {
    "text": "for that and try to to keep it on a on a more abstract level and then the second thing is that these these kind of",
    "start": "2336440",
    "end": "2341480"
  },
  {
    "text": "mechanisms are not Hardware backed so if you get somebody's app sand boox and they don't have a strong passcode or",
    "start": "2341480",
    "end": "2346880"
  },
  {
    "text": "something which is easy to guess you can still run BR brute force or guessing attacks offline um compared to the the",
    "start": "2346880",
    "end": "2353160"
  },
  {
    "text": "system protections and then something else to think about is um do we need to have",
    "start": "2353160",
    "end": "2359800"
  },
  {
    "start": "2355000",
    "end": "2393000"
  },
  {
    "text": "data on the device and that kind of goes into the usability discussion in here um does data need to be on the device can",
    "start": "2359800",
    "end": "2365560"
  },
  {
    "text": "we just leave it on a server and we get it access on demand but then what do we do do we authenticate the user every",
    "start": "2365560",
    "end": "2372000"
  },
  {
    "text": "time you need to access the data or do we have to store a long lift token to access the data and then we're kind of",
    "start": "2372000",
    "end": "2377800"
  },
  {
    "text": "circling back to having to store that token somewhere so this this may or may not solve the problem depending on what",
    "start": "2377800",
    "end": "2383480"
  },
  {
    "text": "your usability requirements are for your particular application and how paranoid you are about the data you're trying to",
    "start": "2383480",
    "end": "2389319"
  },
  {
    "text": "protect so where does this leave us with all what we have talked about well for",
    "start": "2389319",
    "end": "2394680"
  },
  {
    "text": "users we've seen that the passcode is actually really control and and all the Secure Storage techniques so setting a",
    "start": "2394680",
    "end": "2400680"
  },
  {
    "text": "secure passcode is really something we should be encouraged and using something like touch ID or anything which makes it",
    "start": "2400680",
    "end": "2406240"
  },
  {
    "text": "easier for users to have a strong passcode but maintain usability is definitely something which you'd like to",
    "start": "2406240",
    "end": "2411599"
  },
  {
    "text": "see also IOS and Android both added new security features and patching security",
    "start": "2411599",
    "end": "2417000"
  },
  {
    "text": "vulnerability with each release so it would be good to update to a new software version as much as possible but",
    "start": "2417000",
    "end": "2423040"
  },
  {
    "text": "we have seen that this is challenging in particular for for Android devices and even iOS devices is lose support after a",
    "start": "2423040",
    "end": "2428520"
  },
  {
    "text": "while and then for iOS at least um there's a remote vipe and vipe support if you type in the passcode a number of",
    "start": "2428520",
    "end": "2434359"
  },
  {
    "text": "times wrong or you lose your phone you can wipe the device so that would be something um secur security conscious user could could",
    "start": "2434359",
    "end": "2441000"
  },
  {
    "start": "2441000",
    "end": "2550000"
  },
  {
    "text": "enable and for the Android side um I think we've seen there's the need to choose your device wisely I think you",
    "start": "2441000",
    "end": "2447680"
  },
  {
    "text": "need to do a little bit of research and what you're buying to see what security precautions exist and how timely the",
    "start": "2447680",
    "end": "2453560"
  },
  {
    "text": "updates are like if you're going to get something that doesn't get updated for two years you're going to have problems",
    "start": "2453560",
    "end": "2458839"
  },
  {
    "text": "um and also encrypt your user data partition um this is still a electable thing that you have to have to do and",
    "start": "2458839",
    "end": "2465839"
  },
  {
    "text": "even though we just sort of showed a demo how that's not always going to help you it is at least another barrier to entry uh for someone who's after your",
    "start": "2465839",
    "end": "2473440"
  },
  {
    "text": "data and in terms of best practices for developers um you know as Daniel",
    "start": "2473440",
    "end": "2479280"
  },
  {
    "text": "mentioned determine if you actually have to store the statea locally if it's convenient and to cash it but there's",
    "start": "2479280",
    "end": "2485079"
  },
  {
    "text": "security tradeoffs like maybe think about that before before making those decisions and on Android um it's",
    "start": "2485079",
    "end": "2491880"
  },
  {
    "text": "particularly hard to rely on the platform Security in a lot of cases because as I mentioned you don't always",
    "start": "2491880",
    "end": "2497000"
  },
  {
    "text": "have access to all the latest stuff in the in the version you're running and some something of a discussion point",
    "start": "2497000",
    "end": "2502520"
  },
  {
    "text": "that I know any application developers want to chat with us afterwards is like how do you guys handle supporting older",
    "start": "2502520",
    "end": "2508839"
  },
  {
    "text": "versions of Android from a usability and security platform so we'd love to hear how how people are doing this out there",
    "start": "2508839",
    "end": "2515680"
  },
  {
    "text": "um yeah yeah on the iOS side um you want to definitely use some of the protection classes which are involving the passcode",
    "start": "2515680",
    "end": "2522680"
  },
  {
    "text": "which we've seen for file system and for keychain encryption and then if there's a user doesn't have a passcode set which",
    "start": "2522680",
    "end": "2528359"
  },
  {
    "text": "he can test using the keychain when passcode set operations and things like that either you can refuse to store the",
    "start": "2528359",
    "end": "2533839"
  },
  {
    "text": "passcode um or not the passcode but to to to store the sensitive data on the device and just have it have the user",
    "start": "2533839",
    "end": "2539960"
  },
  {
    "text": "log in every time or you can warn them that it's less secure so there's there's alternative",
    "start": "2539960",
    "end": "2545200"
  },
  {
    "text": "there so that's the brief Outlook after talking about this um the the main thing we see here is",
    "start": "2545200",
    "end": "2554160"
  },
  {
    "start": "2550000",
    "end": "2596000"
  },
  {
    "text": "usability and so users for users we need something",
    "start": "2554160",
    "end": "2560960"
  },
  {
    "text": "which goes beyond passcodes we cannot really expect them to have a very long passcode and type it like 100 times",
    "start": "2560960",
    "end": "2566119"
  },
  {
    "text": "every day into their device that's not not a solution which is really acceptable and Biometrics go somewhere in the right direction with like",
    "start": "2566119",
    "end": "2572040"
  },
  {
    "text": "fingerprints and things like that but there's a lot of lot of room to grow in that space and to to um to develop those",
    "start": "2572040",
    "end": "2579040"
  },
  {
    "text": "and then for developers we really would like to see consistency in the platform that we don't have um so many different",
    "start": "2579040",
    "end": "2585040"
  },
  {
    "text": "versions and everything is not not clearly documented and we need to figure out same defaults that we don't have to",
    "start": "2585040",
    "end": "2590599"
  },
  {
    "text": "guess on what is happening in the background and that accidentally something gets deleted like we've seen in the key store in the",
    "start": "2590599",
    "end": "2596599"
  },
  {
    "start": "2596000",
    "end": "2641000"
  },
  {
    "text": "past so the the takeaways um that we'd like if nothing else for you to remember",
    "start": "2596599",
    "end": "2601800"
  },
  {
    "text": "from our discussion here is that security controls should be balanced with the sensitivity of the data and the",
    "start": "2601800",
    "end": "2608480"
  },
  {
    "text": "threat model in question um so protecting your Candy Crush score versus your company's Financial records are two",
    "start": "2608480",
    "end": "2615000"
  },
  {
    "text": "different problems and requir different solutions um secondly protect data until",
    "start": "2615000",
    "end": "2621119"
  },
  {
    "text": "access is actually needed um this is something we'd like to see you know keep things locked until you absolutely need",
    "start": "2621119",
    "end": "2627800"
  },
  {
    "text": "it so that it's just not fully open once you once you boot the device and lastly I think our demo demonstrated that",
    "start": "2627800",
    "end": "2634559"
  },
  {
    "text": "Secure Storage relies on the entire stack being secured and if that is not true things like Rosie are",
    "start": "2634559",
    "end": "2642079"
  },
  {
    "start": "2641000",
    "end": "2659000"
  },
  {
    "text": "possible so some references for you to to look at later there's a lot of good information out there and thanks",
    "start": "2642079",
    "end": "2648079"
  },
  {
    "text": "everyone very much and any questions we'd like to field [Applause]",
    "start": "2648079",
    "end": "2661199"
  }
]