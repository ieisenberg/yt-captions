[
  {
    "text": "hi everyone my name is kao yang director of av engine dev team from",
    "start": "240",
    "end": "5759"
  },
  {
    "text": "fortinet canada today i'm going to talk about some apt attacks happen on the",
    "start": "5759",
    "end": "12000"
  },
  {
    "text": "south korea and there are 80 slides in this presentation",
    "start": "12000",
    "end": "18800"
  },
  {
    "text": "80 yes so please bear with me until we get the fun part right",
    "start": "18800",
    "end": "25679"
  },
  {
    "text": "so here is the agenda so we start from the the march 20th attack from last year and then go through based",
    "start": "27359",
    "end": "33360"
  },
  {
    "text": "on the characteristics we found the operation toy one mission mission and in star eco xp",
    "start": "33360",
    "end": "38480"
  },
  {
    "text": "those four operations we might be heard of right but the last two flame and flame 2. anyone heard of it",
    "start": "38480",
    "end": "45840"
  },
  {
    "text": "except for the flame from kaspersky anyone",
    "start": "45840",
    "end": "50718"
  },
  {
    "text": "great so let's get started from the evapotec",
    "start": "51760",
    "end": "60079"
  },
  {
    "text": "so here is the impact huge impact there are two parts from the bank",
    "start": "60079",
    "end": "66159"
  },
  {
    "text": "financial institutions and the media you can see that 5000 employee computers",
    "start": "66159",
    "end": "73600"
  },
  {
    "text": "57 branches 6 db servers the impact is huge",
    "start": "73600",
    "end": "80799"
  },
  {
    "text": "so what kind of things do those damage here is a viper case one the case one is",
    "start": "81439",
    "end": "89280"
  },
  {
    "text": "the internal use the number so it doesn't mean anything okay so the dropper compile at it's a compile",
    "start": "89280",
    "end": "98159"
  },
  {
    "text": "time is our the orange font and uh it's dropped four files",
    "start": "98159",
    "end": "103680"
  },
  {
    "text": "agent base.exe economy.exe pr1.10 arg.exe so there are two kinds of",
    "start": "103680",
    "end": "111439"
  },
  {
    "text": "wipers the first one is for the windows the other one is for the linux unix",
    "start": "111439",
    "end": "118240"
  },
  {
    "text": "so let's get started from the windows one okay so first it's gonna check a file",
    "start": "118240",
    "end": "126640"
  },
  {
    "text": "mapping object it doesn't exist and then you create",
    "start": "126640",
    "end": "131840"
  },
  {
    "text": "and then try to kill two security",
    "start": "131840",
    "end": "137360"
  },
  {
    "text": "process from the anterior software and then",
    "start": "137520",
    "end": "142640"
  },
  {
    "text": "weapon umbr it's pretty simple and straightforward",
    "start": "142640",
    "end": "148560"
  },
  {
    "text": "remember simple straightforward",
    "start": "148560",
    "end": "156640"
  },
  {
    "text": "here's the other operation system wipers four different kinds except the last one",
    "start": "156640",
    "end": "163840"
  },
  {
    "text": "for the general linux they're just delete all the important directories on",
    "start": "163840",
    "end": "169519"
  },
  {
    "text": "your system the other three are trying to write zeros on your mbr so it's just destroy your",
    "start": "169519",
    "end": "177440"
  },
  {
    "text": "hard drive and we found this is not the only case",
    "start": "177440",
    "end": "184720"
  },
  {
    "text": "here is another one it's a little bit complex than the first",
    "start": "184720",
    "end": "191040"
  },
  {
    "text": "one it has the injector so it's just inject the wiper into",
    "start": "191040",
    "end": "196080"
  },
  {
    "text": "your running process",
    "start": "196080",
    "end": "199840"
  },
  {
    "text": "this one is different it has a time bomb it's preset to march 20th 3 pm",
    "start": "203599",
    "end": "212720"
  },
  {
    "text": "and the next is the file mapping object and the result still simple and",
    "start": "212720",
    "end": "222000"
  },
  {
    "text": "straightforward here is another case",
    "start": "224840",
    "end": "231360"
  },
  {
    "text": "file mapping object and then kill process and it also has a time bomb there",
    "start": "231519",
    "end": "240640"
  },
  {
    "text": "march 20th 2 p.m you can see on the left",
    "start": "240640",
    "end": "247360"
  },
  {
    "text": "2013 march 20th 2 p.m",
    "start": "247439",
    "end": "252959"
  },
  {
    "text": "and then still write the strings to ibr",
    "start": "253120",
    "end": "257760"
  },
  {
    "text": "it's pretty quick right okay here we may have some questions raised how those swipers",
    "start": "260000",
    "end": "268400"
  },
  {
    "text": "got to the computers because the wiper is simple and straightforward",
    "start": "268400",
    "end": "274240"
  },
  {
    "text": "it doesn't have any warm function or self replicating functions that helping",
    "start": "274240",
    "end": "279680"
  },
  {
    "text": "help yourself to spread within the internet right so there must be something missed",
    "start": "279680",
    "end": "288720"
  },
  {
    "text": "here and here i found this it all makes sense",
    "start": "293759",
    "end": "298880"
  },
  {
    "text": "it's a weber spreader so the dropper compiled a day before the attack",
    "start": "298880",
    "end": "306960"
  },
  {
    "text": "and it it dropped two files two zip files update.zip and vms 1014.zip",
    "start": "307520",
    "end": "316800"
  },
  {
    "text": "the vms line uh sorry iit.iii file is actually the",
    "start": "317520",
    "end": "323919"
  },
  {
    "text": "viralboat security management system configuration file it's",
    "start": "323919",
    "end": "328960"
  },
  {
    "text": "update configuration file the other one other download.exe file is actually the",
    "start": "328960",
    "end": "336880"
  },
  {
    "text": "bipolar case three exactly match",
    "start": "336880",
    "end": "342478"
  },
  {
    "text": "so let's brief introduce to the security security management system it has a central server and its",
    "start": "346000",
    "end": "353120"
  },
  {
    "text": "management manages so many clients i mean from the damage like 5000",
    "start": "353120",
    "end": "360639"
  },
  {
    "text": "employee computers so the update will push from the central",
    "start": "360639",
    "end": "366479"
  },
  {
    "text": "server to all the clients",
    "start": "366479",
    "end": "370000"
  },
  {
    "text": "here is the content of this configuration file there are some important values there",
    "start": "375680",
    "end": "382240"
  },
  {
    "text": "the first is the file version it's easy to understand this file version",
    "start": "382240",
    "end": "389360"
  },
  {
    "text": "and the real file name this file is actually zipped in the archive",
    "start": "389360",
    "end": "394639"
  },
  {
    "text": "which is vms 1001.zip so this executable file is",
    "start": "394639",
    "end": "402160"
  },
  {
    "text": "zipped in this file down file size means the zip file size",
    "start": "402160",
    "end": "410880"
  },
  {
    "text": "okay and the update date",
    "start": "410880",
    "end": "415840"
  },
  {
    "text": "the file directories means when the client received the update update z file it will extract the update",
    "start": "418240",
    "end": "424560"
  },
  {
    "text": "file into this directory it's actually stored the actual directory in the request",
    "start": "424560",
    "end": "429840"
  },
  {
    "text": "entries",
    "start": "429840",
    "end": "432240"
  },
  {
    "text": "here we got two configuration files the left hand is of normal ones actually",
    "start": "435680",
    "end": "441360"
  },
  {
    "text": "the religious one the right hand is normal one so we can see the difference i highlighted in the red",
    "start": "441360",
    "end": "448400"
  },
  {
    "text": "the abnormal ones are actually modified the real file size down file size and",
    "start": "448960",
    "end": "454960"
  },
  {
    "text": "update date only the three compared to the normal one",
    "start": "454960",
    "end": "460560"
  },
  {
    "text": "so why did it do this because it it must match the zip file",
    "start": "460560",
    "end": "467599"
  },
  {
    "text": "it dropped so you can see the date matched 2010 october 14th",
    "start": "467599",
    "end": "479840"
  },
  {
    "text": "and the file size two file size real file size and down file size",
    "start": "481680",
    "end": "486960"
  },
  {
    "text": "indicate into a default attribute is the compressed file",
    "start": "486960",
    "end": "492400"
  },
  {
    "text": "size and decompress file size so basically uh so it's a theory",
    "start": "492400",
    "end": "499440"
  },
  {
    "text": "basically it will try to replace those two files exist on your",
    "start": "499440",
    "end": "504560"
  },
  {
    "text": "central server and then when the update happened they'll push these two into all the clients",
    "start": "504560",
    "end": "511520"
  },
  {
    "text": "so let's see how they do it here first up key bunch of uh process",
    "start": "511840",
    "end": "518479"
  },
  {
    "text": "belongs to the euro security management systems",
    "start": "518479",
    "end": "524959"
  },
  {
    "text": "and then replace the key data of the central server with hahaha so this key uh this key value is",
    "start": "528399",
    "end": "535680"
  },
  {
    "text": "actually store the url the central server get update from",
    "start": "535680",
    "end": "541200"
  },
  {
    "text": "so it's replaced with this strings that means just disable the central server to get update from the remote website so",
    "start": "541200",
    "end": "548560"
  },
  {
    "text": "if the central server can get update that means all the clients can get up update all right",
    "start": "548560",
    "end": "555600"
  },
  {
    "text": "and then delete two files it exists on this management system",
    "start": "556480",
    "end": "561519"
  },
  {
    "text": "security management system update.zip and vms 1014.zip",
    "start": "561519",
    "end": "567680"
  },
  {
    "text": "exactly the two files dropped by the dropper",
    "start": "567680",
    "end": "573439"
  },
  {
    "text": "and then drop the files into specific directory",
    "start": "575839",
    "end": "583440"
  },
  {
    "text": "again to specific directory",
    "start": "583440",
    "end": "590880"
  },
  {
    "text": "but the binary reversing engineering is just told me a theory right we don't really",
    "start": "590880",
    "end": "598000"
  },
  {
    "text": "know whether it really works so i did a test",
    "start": "598000",
    "end": "603120"
  },
  {
    "text": "i build up the central server and then install a client and then running the malicious file on",
    "start": "603600",
    "end": "609519"
  },
  {
    "text": "the central server side and then launch the update from the client side you can see that the update is still",
    "start": "609519",
    "end": "616640"
  },
  {
    "text": "still going on the background and this sub configuration file",
    "start": "616640",
    "end": "622160"
  },
  {
    "text": "you can see it's already been replaced it's pushed from the central server to",
    "start": "622160",
    "end": "628959"
  },
  {
    "text": "decline see oth down.exe is actually a viper",
    "start": "628959",
    "end": "636240"
  },
  {
    "text": "so let's see the viper here okay deviper got",
    "start": "637519",
    "end": "644240"
  },
  {
    "text": "into your computers all the computers managed managed by this security management",
    "start": "644240",
    "end": "649839"
  },
  {
    "text": "system",
    "start": "649839",
    "end": "652240"
  },
  {
    "text": "and here here is actually a normal executable file used by this security",
    "start": "656880",
    "end": "664160"
  },
  {
    "text": "management system it's a normal one it's not replaced yet",
    "start": "664160",
    "end": "670560"
  },
  {
    "text": "because the update is still ongoing when the update finished",
    "start": "670560",
    "end": "677680"
  },
  {
    "text": "the normal application is replaced by the wiper for now",
    "start": "677680",
    "end": "687200"
  },
  {
    "text": "it doesn't trigger to run this but the series to replace the normal",
    "start": "687600",
    "end": "694000"
  },
  {
    "text": "application used by this security management system of course this security management",
    "start": "694000",
    "end": "700079"
  },
  {
    "text": "system will occasionally run this file and actually i just wait five minutes and",
    "start": "700079",
    "end": "706720"
  },
  {
    "text": "then check the mbr great when i found this i was like",
    "start": "706720",
    "end": "716040"
  },
  {
    "text": "wtf",
    "start": "716040",
    "end": "719040"
  },
  {
    "text": "so if you think this is the only wiper spreader are wrong",
    "start": "723519",
    "end": "731839"
  },
  {
    "text": "here here is another wiper spreader actually unfortunately i",
    "start": "733519",
    "end": "740320"
  },
  {
    "text": "didn't got dropper maybe it actually don't have a dropper it's",
    "start": "740320",
    "end": "747360"
  },
  {
    "text": "two files mp setup right mp setup.iii and container.exe",
    "start": "747360",
    "end": "753680"
  },
  {
    "text": "the mp setup of the ii is the update conflict file for nlab policy center",
    "start": "753680",
    "end": "762320"
  },
  {
    "text": "the container that you see is actually the wiper case one exactly match",
    "start": "762320",
    "end": "769680"
  },
  {
    "text": "but there is no connections right so let's see the content",
    "start": "770399",
    "end": "776240"
  },
  {
    "text": "so it's got connected so i guess the same theory happened",
    "start": "777279",
    "end": "786079"
  },
  {
    "text": "i didn't test it because i didn't have the dropper",
    "start": "786079",
    "end": "790720"
  },
  {
    "text": "so let's take a look of the security management system they used",
    "start": "795279",
    "end": "801839"
  },
  {
    "text": "it starts to make sense right so what do we learn from this",
    "start": "808639",
    "end": "816959"
  },
  {
    "text": "for the security management system we should have uh protect or we should protect our own",
    "start": "818880",
    "end": "825040"
  },
  {
    "text": "process process ikea won't happen right",
    "start": "825040",
    "end": "830399"
  },
  {
    "text": "and implement at least a little bit strong verification during your update",
    "start": "830399",
    "end": "838240"
  },
  {
    "text": "sorry so for the companies or organizations",
    "start": "838639",
    "end": "845440"
  },
  {
    "text": "it seems we shouldn't stick on a single security management system",
    "start": "846079",
    "end": "852800"
  },
  {
    "text": "because it's a weak point this actually shows us how they turn our",
    "start": "853519",
    "end": "859680"
  },
  {
    "text": "shields into their spears",
    "start": "859680",
    "end": "864160"
  },
  {
    "text": "right",
    "start": "868839",
    "end": "871839"
  },
  {
    "text": "here so there are still some questions confusing because as the last one is",
    "start": "876399",
    "end": "884160"
  },
  {
    "text": "the same how those wiper spreaders got into on onto computers",
    "start": "884160",
    "end": "891279"
  },
  {
    "text": "right and another thing is actually there are three wiper cases i",
    "start": "891279",
    "end": "896560"
  },
  {
    "text": "showed before but i do i just find two cases match the wipers rather they're",
    "start": "896560",
    "end": "903279"
  },
  {
    "text": "still missing one so is there any other mower download",
    "start": "903279",
    "end": "909040"
  },
  {
    "text": "this one",
    "start": "909040",
    "end": "913839"
  },
  {
    "text": "and the weapon spreader is actually dropped the files into",
    "start": "914880",
    "end": "921040"
  },
  {
    "text": "specific directory what if i install the security management system into another directory the vapor doesn't",
    "start": "921040",
    "end": "928399"
  },
  {
    "text": "work right it won't work never work it's three questions",
    "start": "928399",
    "end": "941839"
  },
  {
    "text": "so before we trying to uh find more related samples firstly we need to see the",
    "start": "942800",
    "end": "949600"
  },
  {
    "text": "characteristics in those wipers and wiper spreaders right",
    "start": "949600",
    "end": "955839"
  },
  {
    "text": "the common parts no packer it may have upx but nowadays who treat",
    "start": "956800",
    "end": "963199"
  },
  {
    "text": "ups as a packer second film mapping object",
    "start": "963199",
    "end": "969920"
  },
  {
    "text": "sir time bomb three important things",
    "start": "969920",
    "end": "976560"
  },
  {
    "text": "and operation toy",
    "start": "977279",
    "end": "982560"
  },
  {
    "text": "no packer similar file mapping object time bar it is http protocol",
    "start": "982560",
    "end": "989040"
  },
  {
    "text": "there is no irc http protocol share similar payload because there are",
    "start": "989040",
    "end": "995839"
  },
  {
    "text": "not only one choice case so for example there are six cases there",
    "start": "995839",
    "end": "1000880"
  },
  {
    "text": "share similar payload and have pdb file pass that's the toy name came from",
    "start": "1000880",
    "end": "1011839"
  },
  {
    "text": "try case one start from a downloader and then a dropper based on",
    "start": "1015759",
    "end": "1023839"
  },
  {
    "text": "opening system you drop different files",
    "start": "1023839",
    "end": "1028240"
  },
  {
    "text": "basically either drop d2 payload or java injector or",
    "start": "1029039",
    "end": "1036160"
  },
  {
    "text": "or privilege escalator",
    "start": "1036160",
    "end": "1039839"
  },
  {
    "text": "here is another one based on different operating systems or",
    "start": "1046480",
    "end": "1052480"
  },
  {
    "text": "32-bit or 64-bit different files",
    "start": "1052480",
    "end": "1057200"
  },
  {
    "text": "so when you check the compile date it's one month before one at least one month before the attack",
    "start": "1061760",
    "end": "1070080"
  },
  {
    "text": "so let's see the payload file mapping object",
    "start": "1070559",
    "end": "1076080"
  },
  {
    "text": "and then query the three request free entries to calculate the id using the http request",
    "start": "1076080",
    "end": "1084160"
  },
  {
    "text": "there also string is encrypted so i just showed the decryptive one",
    "start": "1084160",
    "end": "1090799"
  },
  {
    "text": "time bomb i think it's nothing to explain here",
    "start": "1090960",
    "end": "1096400"
  },
  {
    "text": "communication part request patents",
    "start": "1102320",
    "end": "1108240"
  },
  {
    "text": "no equal zero id calculated by the derivative entry queries and sn is random number sc is equal to",
    "start": "1108240",
    "end": "1115760"
  },
  {
    "text": "md5 sum plus two id and two percent numbers",
    "start": "1115760",
    "end": "1120480"
  },
  {
    "text": "and it will write server response to this temp file try to remember this file name",
    "start": "1120799",
    "end": "1127760"
  },
  {
    "text": "decrypt the file using rc4 algorithm and the key",
    "start": "1128240",
    "end": "1132799"
  },
  {
    "text": "still simple",
    "start": "1133679",
    "end": "1137840"
  },
  {
    "text": "here's comments wake up easy to understand wake up the children",
    "start": "1139120",
    "end": "1144960"
  },
  {
    "text": "interval said in total that the children connected the cnc servers",
    "start": "1144960",
    "end": "1150400"
  },
  {
    "text": "and download exe c download the file and execute it",
    "start": "1150400",
    "end": "1156799"
  },
  {
    "text": "map fs this one is interesting it will try to write all the file",
    "start": "1157760",
    "end": "1163760"
  },
  {
    "text": "information into one single file and the store on your local hard drive",
    "start": "1163760",
    "end": "1169120"
  },
  {
    "text": "and then might use the upload command to upload this",
    "start": "1169120",
    "end": "1174159"
  },
  {
    "text": "this may be the answers to that questions i raised before",
    "start": "1175280",
    "end": "1182000"
  },
  {
    "text": "maybe the computer just got destroyed and then downloaded other viper not spread it by the wiper sweater",
    "start": "1182799",
    "end": "1190720"
  },
  {
    "text": "and how they know you install the security management system into that directory",
    "start": "1190720",
    "end": "1196400"
  },
  {
    "text": "mypfs they got all your false information fileplus they knew it",
    "start": "1196400",
    "end": "1207840"
  },
  {
    "text": "the last part is a pdb file pass i highlighted the two commands upload",
    "start": "1214640",
    "end": "1221120"
  },
  {
    "text": "and map fs save me lots of time",
    "start": "1221120",
    "end": "1227039"
  },
  {
    "text": "here characteristics file mapping object time bomb sub4 is actually the string",
    "start": "1230159",
    "end": "1236799"
  },
  {
    "text": "increasing algorithm calculate id is decorate these three",
    "start": "1236799",
    "end": "1241840"
  },
  {
    "text": "reduce ranges to calculate id using http request and http request patents",
    "start": "1241840",
    "end": "1248320"
  },
  {
    "text": "and rc4 encryption decryption algorithm using the communication",
    "start": "1248320",
    "end": "1255039"
  },
  {
    "text": "here is an interesting case toy case 7. you may notice the compile",
    "start": "1257039",
    "end": "1264400"
  },
  {
    "text": "date is actually after the wiper attack",
    "start": "1264400",
    "end": "1269919"
  },
  {
    "text": "three days after do we have we received any report that after",
    "start": "1269919",
    "end": "1276320"
  },
  {
    "text": "the march 20th there are other organizations so institutions got their hard drive",
    "start": "1276320",
    "end": "1285600"
  },
  {
    "text": "destroyed no right",
    "start": "1288840",
    "end": "1294000"
  },
  {
    "text": "so let's see how it works",
    "start": "1295120",
    "end": "1300799"
  },
  {
    "text": "find mapping object but it's the pattern changed global slash",
    "start": "1301200",
    "end": "1308240"
  },
  {
    "text": "resource share and it's the same thing calculate id by",
    "start": "1308640",
    "end": "1314320"
  },
  {
    "text": "calling these three register entries",
    "start": "1314320",
    "end": "1319840"
  },
  {
    "text": "here is quite different with other choice cases the http request pattern is different",
    "start": "1319919",
    "end": "1326559"
  },
  {
    "text": "and the rest of the response to another file to create a file using rsu",
    "start": "1326559",
    "end": "1334720"
  },
  {
    "text": "using udp protocol to get url list another list and use http portal to get",
    "start": "1334799",
    "end": "1341679"
  },
  {
    "text": "more files and then wipe your mbr and vbrv is",
    "start": "1341679",
    "end": "1347600"
  },
  {
    "text": "zero there's no strings zero and the compiled is three days",
    "start": "1347600",
    "end": "1354640"
  },
  {
    "text": "after the attack march 20th",
    "start": "1354640",
    "end": "1361840"
  },
  {
    "text": "here is another question is like if some organizations or institutions",
    "start": "1366480",
    "end": "1373120"
  },
  {
    "text": "got their hard drive after the viper attack they should report it",
    "start": "1373120",
    "end": "1380158"
  },
  {
    "text": "or they can't report so what kind of organizational institutions can report those kind of",
    "start": "1382880",
    "end": "1390320"
  },
  {
    "text": "attack",
    "start": "1390320",
    "end": "1392720"
  },
  {
    "text": "i'll show i'll share my opinions at last at the end of the presentation for this question",
    "start": "1395919",
    "end": "1403200"
  },
  {
    "text": "here 2k7 pillow characteristics file mapping object",
    "start": "1403200",
    "end": "1410399"
  },
  {
    "text": "the string encryption is using xor we see 4 spy calculate the id same with other choice",
    "start": "1410880",
    "end": "1417919"
  },
  {
    "text": "cases a tcp protocol and a udp protocol",
    "start": "1417919",
    "end": "1423039"
  },
  {
    "text": "and using rsa key one you can remember key one it's a it's just like a tag",
    "start": "1423039",
    "end": "1430080"
  },
  {
    "text": "key one so is that",
    "start": "1430080",
    "end": "1436480"
  },
  {
    "text": "all operation mission share similar things",
    "start": "1436480",
    "end": "1444080"
  },
  {
    "text": "notepacker similar file mapping object timebomb http protocol and irc channel",
    "start": "1444080",
    "end": "1451520"
  },
  {
    "text": "the last line is the pdb the part of the ptp file pass where the name came from",
    "start": "1452240",
    "end": "1459840"
  },
  {
    "text": "here's mission case",
    "start": "1460960",
    "end": "1464080"
  },
  {
    "text": "yeah the dropper dropper and lab update kit so you can see the",
    "start": "1467039",
    "end": "1474080"
  },
  {
    "text": "compile update 2002",
    "start": "1474080",
    "end": "1479679"
  },
  {
    "text": "interesting do we still remember the wiper spreader",
    "start": "1481200",
    "end": "1486640"
  },
  {
    "text": "for the y robot security management system they",
    "start": "1486640",
    "end": "1491679"
  },
  {
    "text": "modify the compile date to match the update file",
    "start": "1491679",
    "end": "1498400"
  },
  {
    "text": "so here is the same",
    "start": "1498400",
    "end": "1501840"
  },
  {
    "text": "the actual payload is unlab update.exe based on 32-bit 64-bit drop different things but",
    "start": "1504960",
    "end": "1514159"
  },
  {
    "text": "actual function is similar file mapping object using global",
    "start": "1514159",
    "end": "1521200"
  },
  {
    "text": "resource share the same not same similar to detroit k7",
    "start": "1521200",
    "end": "1529200"
  },
  {
    "text": "i have different operation name calculate the id using http request",
    "start": "1529200",
    "end": "1536799"
  },
  {
    "text": "communication similar let's just image equal to one and",
    "start": "1536799",
    "end": "1544400"
  },
  {
    "text": "write server response to a random temp file decrypting file using modified base64",
    "start": "1544400",
    "end": "1550480"
  },
  {
    "text": "and rsa the protocol is http and rc channel",
    "start": "1550480",
    "end": "1556640"
  },
  {
    "text": "the commands except the http commands their irc functions there so they can change the",
    "start": "1556640",
    "end": "1562320"
  },
  {
    "text": "nickname they can join irc actually the command is using integer",
    "start": "1562320",
    "end": "1567440"
  },
  {
    "text": "from 1000 and the function is similar to the toy case map fs",
    "start": "1567440",
    "end": "1573120"
  },
  {
    "text": "upload download report",
    "start": "1573120",
    "end": "1584080"
  },
  {
    "text": "characteristics there are two red parts new in this mission operation mission",
    "start": "1584080",
    "end": "1591440"
  },
  {
    "text": "except the file mapping object calculate id http oracle they are using",
    "start": "1591440",
    "end": "1596880"
  },
  {
    "text": "irc channel base64 and the rsa key changed to key2",
    "start": "1596880",
    "end": "1602400"
  },
  {
    "text": "okay and the string encryption use xt",
    "start": "1602400",
    "end": "1607279"
  },
  {
    "text": "it's still not the end operation one mission similar is the mission no packer",
    "start": "1611520",
    "end": "1618559"
  },
  {
    "text": "similar file mapping object timeline http protocol irc channel similar payload",
    "start": "1618559",
    "end": "1626640"
  },
  {
    "text": "here's the part of pdb file power as the name came from and it has a version number 2.1",
    "start": "1626640",
    "end": "1641840"
  },
  {
    "text": "this chopper is similar is the uh the toy cases actually do nothing too nothing new",
    "start": "1643440",
    "end": "1650880"
  },
  {
    "text": "and this one more straightforward there's no uh injector or privileged escalator",
    "start": "1652799",
    "end": "1659039"
  },
  {
    "text": "it's just based on uh 32-bit or 64 this is 4-bit drop the actual payload this one is much",
    "start": "1659039",
    "end": "1666159"
  },
  {
    "text": "more complicated not only 32-bit or 6 to compare 32-bit",
    "start": "1666159",
    "end": "1671279"
  },
  {
    "text": "64-bit they also get the version number specific version number",
    "start": "1671279",
    "end": "1676720"
  },
  {
    "text": "one mission payload communications patterns similar to the choice case",
    "start": "1680320",
    "end": "1685360"
  },
  {
    "text": "and that id here they start with two strings and then calculate",
    "start": "1685360",
    "end": "1692480"
  },
  {
    "text": "after that whether either it's calculated by quarry the three registry entries",
    "start": "1692480",
    "end": "1699760"
  },
  {
    "text": "or your mac address so here you may read some other vendors report if they",
    "start": "1699760",
    "end": "1706240"
  },
  {
    "text": "put those ids in their report they're",
    "start": "1706240",
    "end": "1711440"
  },
  {
    "text": "actually the mac address after that so you may tell whether they analyze the malware in the",
    "start": "1711440",
    "end": "1717840"
  },
  {
    "text": "virtual machine or real machine and then write the server response to",
    "start": "1717840",
    "end": "1725039"
  },
  {
    "text": "this file name the same as the troy case",
    "start": "1725039",
    "end": "1730399"
  },
  {
    "text": "decrypt the file using bix64 and rsa using http protocol and irc channel",
    "start": "1730399",
    "end": "1736320"
  },
  {
    "text": "there are 28 commands too many comments but the function they're saying upload download report",
    "start": "1736320",
    "end": "1744480"
  },
  {
    "text": "map fast",
    "start": "1744480",
    "end": "1747200"
  },
  {
    "text": "here one mission payload characteristics file mapping object the new is the map",
    "start": "1750399",
    "end": "1756399"
  },
  {
    "text": "fs that's a string",
    "start": "1756399",
    "end": "1762640"
  },
  {
    "text": "string is actually a z password before they just collect the data and",
    "start": "1762640",
    "end": "1769520"
  },
  {
    "text": "then send to the remote server without any compression or encryption this time they compress it and then send",
    "start": "1769520",
    "end": "1778840"
  },
  {
    "text": "it and here is the new one the base64 and rsa key 0. remember try to remember this key",
    "start": "1778840",
    "end": "1786720"
  },
  {
    "text": "0 using in one mission",
    "start": "1786720",
    "end": "1790320"
  },
  {
    "text": "here's another operation in star share similar things this is the first",
    "start": "1792000",
    "end": "1797520"
  },
  {
    "text": "time we found bsdell.pdb this is important",
    "start": "1797520",
    "end": "1802640"
  },
  {
    "text": "based on this we can find more things version number 2.1",
    "start": "1802640",
    "end": "1809840"
  },
  {
    "text": "same as one mission",
    "start": "1811279",
    "end": "1814320"
  },
  {
    "text": "also sing this one mission",
    "start": "1817600",
    "end": "1823840"
  },
  {
    "text": "and based on those characteristics we find another operation equal xp",
    "start": "1826640",
    "end": "1831919"
  },
  {
    "text": "there has much more similarities no packer similar film mapping object time bomb hd",
    "start": "1831919",
    "end": "1839120"
  },
  {
    "text": "protocol and rfc channel version 2.0",
    "start": "1839120",
    "end": "1845120"
  },
  {
    "text": "so we can clearly see its development path since it has a version number 2.1 2.0",
    "start": "1846880",
    "end": "1855200"
  },
  {
    "text": "2.0 2.1 2.1",
    "start": "1855200",
    "end": "1859039"
  },
  {
    "text": "here similar to the n-star to the uh to the one mission mission",
    "start": "1861279",
    "end": "1869760"
  },
  {
    "text": "characteristics almost the same so here",
    "start": "1870159",
    "end": "1878320"
  },
  {
    "text": "detroit case is actually not happening on 2013 the prototype is actually on 2009",
    "start": "1878320",
    "end": "1885279"
  },
  {
    "text": "the core payload and it connected all the operations ecoxp 2010 and start 2011.",
    "start": "1885279",
    "end": "1895120"
  },
  {
    "text": "sorry mission 2013 one mission 2012.",
    "start": "1895120",
    "end": "1901519"
  },
  {
    "text": "here i just want one when i get those i just can't believe",
    "start": "1902640",
    "end": "1908000"
  },
  {
    "text": "it's the end because it's from to 2013",
    "start": "1908000",
    "end": "1913679"
  },
  {
    "text": "all the way back to 2011 2010. i just can't believe it",
    "start": "1913679",
    "end": "1920240"
  },
  {
    "text": "it's the end so before we uh",
    "start": "1920240",
    "end": "1925360"
  },
  {
    "text": "trying to find more samples we still need to find the characteristics all those operations",
    "start": "1925360",
    "end": "1932840"
  },
  {
    "text": "have file mapping object through encryption",
    "start": "1932840",
    "end": "1941600"
  },
  {
    "text": "calculate the id using http request http request patterns the patents may",
    "start": "1941600",
    "end": "1948399"
  },
  {
    "text": "change but hd protocol base64 rsa encryption",
    "start": "1948399",
    "end": "1954000"
  },
  {
    "text": "irc channel map fs and then a zip password",
    "start": "1954000",
    "end": "1963840"
  },
  {
    "text": "how we found this operation flame the version 1.0 is compiled on 2007",
    "start": "1968720",
    "end": "1975919"
  },
  {
    "text": "march 7th this is the very first version of all those operations",
    "start": "1975919",
    "end": "1982720"
  },
  {
    "text": "very first one it is hd protocol",
    "start": "1982720",
    "end": "1987919"
  },
  {
    "text": "and one the detroit got the data from the server side they just",
    "start": "1987919",
    "end": "1994880"
  },
  {
    "text": "unzip it so the communication protocol is using http and then zip files",
    "start": "1994880",
    "end": "2000320"
  },
  {
    "text": "crossing around and this has architecture that has plugins so it has root key",
    "start": "2000320",
    "end": "2008159"
  },
  {
    "text": "usb dumper map fs keylogger email stealer",
    "start": "2008159",
    "end": "2019840"
  },
  {
    "text": "and operation flame 2.0 version from 1.1 to 5.6",
    "start": "2024559",
    "end": "2032080"
  },
  {
    "text": "during the year 2008 it's actually start from pure irc",
    "start": "2032080",
    "end": "2039039"
  },
  {
    "text": "channel there's no http portal in it pure irc and then",
    "start": "2039039",
    "end": "2045120"
  },
  {
    "text": "at the late development they're shipped from irc to a combination of http portal and irc channel",
    "start": "2045120",
    "end": "2052800"
  },
  {
    "text": "let's also reflect that in the other operations http or arc channel",
    "start": "2052800",
    "end": "2060878"
  },
  {
    "text": "and interesting strings army class navy logicom and and d-drop",
    "start": "2060879",
    "end": "2067520"
  },
  {
    "text": "still remember the rsa key 0 using the other operations right",
    "start": "2067520",
    "end": "2074000"
  },
  {
    "text": "the strings is interesting it's actually told us",
    "start": "2074000",
    "end": "2081200"
  },
  {
    "text": "their targets also use those strings as the irc channel",
    "start": "2081200",
    "end": "2086720"
  },
  {
    "text": "name they will join those rc channel and then send information through those crc",
    "start": "2086720",
    "end": "2092240"
  },
  {
    "text": "so the army class let's see the army class represent to",
    "start": "2092240",
    "end": "2097839"
  },
  {
    "text": "the korean military academy so the navy logic comes in military parts and a supplier",
    "start": "2097839",
    "end": "2104960"
  },
  {
    "text": "mnd job ministry of national defense",
    "start": "2104960",
    "end": "2111280"
  },
  {
    "text": "you think it's those are all the targets",
    "start": "2114000",
    "end": "2119520"
  },
  {
    "text": "no in the later phase development target",
    "start": "2119520",
    "end": "2125680"
  },
  {
    "text": "change a little bit military engineering department korean military academy",
    "start": "2125680",
    "end": "2132480"
  },
  {
    "text": "rok u.s combined force so when the target is clear",
    "start": "2132480",
    "end": "2140480"
  },
  {
    "text": "the next questions will be what other purpose",
    "start": "2140480",
    "end": "2146640"
  },
  {
    "text": "still sensitive documents disable your system how they steal your sensitive documents",
    "start": "2152079",
    "end": "2158240"
  },
  {
    "text": "because the operation flame or protein frame 2.0 has the ability to upload the files",
    "start": "2158240",
    "end": "2166640"
  },
  {
    "text": "similar to the toy case you still remember the map fs you got it will write all your file informations",
    "start": "2167040",
    "end": "2175680"
  },
  {
    "text": "into one single file and then send to the cnc server side they will just try to search things search some",
    "start": "2175680",
    "end": "2182720"
  },
  {
    "text": "sensitive sensitive documents and then trying to specifically put their pos there and",
    "start": "2182720",
    "end": "2189520"
  },
  {
    "text": "then upload the file from your computer to the remote site",
    "start": "2189520",
    "end": "2196000"
  },
  {
    "text": "you can't hide anything from the map fs",
    "start": "2196000",
    "end": "2201839"
  },
  {
    "text": "another interesting thing is actually in the late of its development it tried to identify",
    "start": "2203920",
    "end": "2211760"
  },
  {
    "text": "whether the effective system is ar system",
    "start": "2211760",
    "end": "2217920"
  },
  {
    "text": "so here what is a ar system it's action required system",
    "start": "2218880",
    "end": "2225599"
  },
  {
    "text": "it management manage all your digital assets and also your digital ids",
    "start": "2225599",
    "end": "2234480"
  },
  {
    "text": "so they are not only interested in your digital things for example the digital id",
    "start": "2235040",
    "end": "2244000"
  },
  {
    "text": "you may you may enter your facility using a access card actually they're",
    "start": "2244000",
    "end": "2252000"
  },
  {
    "text": "targeting those in those systems so use your imagination but for now i'll",
    "start": "2252000",
    "end": "2258880"
  },
  {
    "text": "use mine one way put the raw id into the system",
    "start": "2258880",
    "end": "2265760"
  },
  {
    "text": "and then grant your access card so that's that's that means you can enter the facility",
    "start": "2265760",
    "end": "2272960"
  },
  {
    "text": "physically so your target is not only interested in",
    "start": "2272960",
    "end": "2279119"
  },
  {
    "text": "your digital document but also interesting entering your facility",
    "start": "2279119",
    "end": "2285680"
  },
  {
    "text": "another way is to grant the access to someone already in this facility",
    "start": "2285680",
    "end": "2293359"
  },
  {
    "text": "if you have a success card you may don't have a right to enter for example server room right they maybe",
    "start": "2293359",
    "end": "2300800"
  },
  {
    "text": "give that person in the facility that right to enter the server room or enter some office because not all the",
    "start": "2300800",
    "end": "2308880"
  },
  {
    "text": "documents are digital",
    "start": "2308880",
    "end": "2313839"
  },
  {
    "text": "here i found so many uh pdb file paths through all the core",
    "start": "2324839",
    "end": "2330079"
  },
  {
    "text": "payload bs dial so we can first see the red part",
    "start": "2330079",
    "end": "2337040"
  },
  {
    "text": "it's all written in korea and then translate into english is the right part backdoor",
    "start": "2337119",
    "end": "2346000"
  },
  {
    "text": "work plan and when we see the green part 14",
    "start": "2346000",
    "end": "2353520"
  },
  {
    "text": "15 17 18 it's a long way development path and the yellow yellow part",
    "start": "2353520",
    "end": "2360400"
  },
  {
    "text": "it might be the computer name or the real person's name or nickname",
    "start": "2360400",
    "end": "2369839"
  },
  {
    "text": "now i'm happy really happy here",
    "start": "2373760",
    "end": "2381359"
  },
  {
    "text": "here is the the that parts of all the core functions core uh payload bs.dll",
    "start": "2381359",
    "end": "2389200"
  },
  {
    "text": "it started from 2007 alone to 2013 and we found interesting things like in",
    "start": "2389200",
    "end": "2395040"
  },
  {
    "text": "2008 there are a branch there and then one branch to",
    "start": "2395040",
    "end": "2400480"
  },
  {
    "text": "continue to development the flame one and another branch to flame two and then they suddenly decided",
    "start": "2400480",
    "end": "2407200"
  },
  {
    "text": "to merge two branch into one and then 2009",
    "start": "2407200",
    "end": "2412400"
  },
  {
    "text": "because the space is limited i have to combine some similar payload into one",
    "start": "2417520",
    "end": "2425200"
  },
  {
    "text": "one block like the bs bs case f 12 11",
    "start": "2425200",
    "end": "2431920"
  },
  {
    "text": "at the end of the year 2009 and here i highlight the the operation",
    "start": "2431920",
    "end": "2438400"
  },
  {
    "text": "name there are one for each year frame one frame two choice case",
    "start": "2438400",
    "end": "2448400"
  },
  {
    "text": "then ego xp and star one mission and a 2013 toy case",
    "start": "2448560",
    "end": "2467839"
  },
  {
    "text": "yep i think that's all",
    "start": "2473520",
    "end": "2476880"
  },
  {
    "text": "any questions oh by the way this is my business card",
    "start": "2479119",
    "end": "2485760"
  },
  {
    "text": "any questions",
    "start": "2485920",
    "end": "2495838"
  },
  {
    "text": "no sir what",
    "start": "2500319",
    "end": "2506000"
  },
  {
    "text": "the old investigation hotline because uh because i'm a part of my job is",
    "start": "2507280",
    "end": "2514079"
  },
  {
    "text": "dedicated to the engine development so i have a limited time to going going",
    "start": "2514079",
    "end": "2520160"
  },
  {
    "text": "deep into this research actually is start from last year march 20 years",
    "start": "2520160",
    "end": "2525920"
  },
  {
    "text": "until one or two months ago before i submit the proposal to the black hat",
    "start": "2525920",
    "end": "2533440"
  },
  {
    "text": "it's a long way and then because the reason i going so deep because i",
    "start": "2534000",
    "end": "2540960"
  },
  {
    "text": "also i ask myself so many questions so i can continue to find something",
    "start": "2540960",
    "end": "2547680"
  },
  {
    "text": "interesting and then share with you guys",
    "start": "2547680",
    "end": "2551838"
  },
  {
    "text": "anyone yes",
    "start": "2553520",
    "end": "2557520"
  },
  {
    "text": "actually uh you might you may read of other when there's reports say the",
    "start": "2562560",
    "end": "2568640"
  },
  {
    "text": "heck teams or anonymous team behind this but i wouldn't say anything about",
    "start": "2568640",
    "end": "2573680"
  },
  {
    "text": "who's behind this because i don't have solid evidence to show",
    "start": "2573680",
    "end": "2579920"
  },
  {
    "text": "who's behind this because it's a paradox right you you just like i it's like ask",
    "start": "2579920",
    "end": "2586480"
  },
  {
    "text": "anonymous who you are",
    "start": "2586480",
    "end": "2593838"
  },
  {
    "text": "anyone",
    "start": "2594079",
    "end": "2596480"
  },
  {
    "text": "you know what okay thank you guys",
    "start": "2602079",
    "end": "2607839"
  }
]